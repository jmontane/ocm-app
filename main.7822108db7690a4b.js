(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{4244:(_n,Ke,k)=>{"use strict";k.d(Ke,{N0:()=>p,Ar:()=>Q});var d=k(6738),c=k(6895),V=k(1709),a=k(5254),O=k(529);const A=new d.OlP("JWT_OPTIONS");let p=(()=>{class Z{constructor(G=null){this.tokenGetter=G&&G.tokenGetter||function(){}}urlBase64Decode(G){let te=G.replace(/-/g,"+").replace(/_/g,"/");switch(te.length%4){case 0:break;case 2:te+="==";break;case 3:te+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(te)}b64decode(G){let ye="";if((G=String(G).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let Ee,je,me=0,rt=0;je=G.charAt(rt++);~je&&(Ee=me%4?64*Ee+je:je,me++%4)?ye+=String.fromCharCode(255&Ee>>(-2*me&6)):0)je="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(je);return ye}b64DecodeUnicode(G){return decodeURIComponent(Array.prototype.map.call(this.b64decode(G),te=>"%"+("00"+te.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(G=this.tokenGetter()){if(!G||""===G)return null;const te=G.split(".");if(3!==te.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const ye=this.urlBase64Decode(te[1]);if(!ye)throw new Error("Cannot decode the token.");return JSON.parse(ye)}getTokenExpirationDate(G=this.tokenGetter()){let te;if(te=this.decodeToken(G),!te||!te.hasOwnProperty("exp"))return null;const ye=new Date(0);return ye.setUTCSeconds(te.exp),ye}isTokenExpired(G=this.tokenGetter(),te){if(!G||""===G)return!0;const ye=this.getTokenExpirationDate(G);return te=te||0,null!==ye&&!(ye.valueOf()>(new Date).valueOf()+1e3*te)}getAuthScheme(G,te){return"function"==typeof G?G(te):G}}return Z.\u0275fac=function(G){return new(G||Z)(d.LFG(A))},Z.\u0275prov=d.Yz7({token:Z,factory:Z.\u0275fac}),Z})(),L=(()=>{class Z{constructor(G,te,ye){this.jwtHelper=te,this.document=ye,this.standardPorts=["80","443"],this.tokenGetter=G.tokenGetter,this.headerName=G.headerName||"Authorization",this.authScheme=G.authScheme||""===G.authScheme?G.authScheme:"Bearer ",this.allowedDomains=G.allowedDomains||[],this.disallowedRoutes=G.disallowedRoutes||[],this.throwNoTokenError=G.throwNoTokenError||!1,this.skipWhenExpired=G.skipWhenExpired}isAllowedDomain(G){const te=new URL(G.url,this.document.location.origin);if(te.host===this.document.location.host)return!0;const ye=`${te.hostname}${te.port&&!this.standardPorts.includes(te.port)?":"+te.port:""}`;return this.allowedDomains.findIndex(me=>"string"==typeof me?me===ye:me instanceof RegExp&&me.test(ye))>-1}isDisallowedRoute(G){const te=new URL(G.url,this.document.location.origin);return this.disallowedRoutes.findIndex(ye=>{if("string"==typeof ye){const me=new URL(ye,this.document.location.origin);return me.hostname===te.hostname&&me.pathname===te.pathname}return ye instanceof RegExp&&ye.test(G.url)})>-1}handleInterception(G,te,ye){const me=this.jwtHelper.getAuthScheme(this.authScheme,te);let Ee=!1;if(!G&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");return this.skipWhenExpired&&(Ee=!G||this.jwtHelper.isTokenExpired(G)),G&&Ee&&this.skipWhenExpired?te=te.clone():G&&(te=te.clone({setHeaders:{[this.headerName]:`${me}${G}`}})),ye.handle(te)}intercept(G,te){if(!this.isAllowedDomain(G)||this.isDisallowedRoute(G))return te.handle(G);const ye=this.tokenGetter(G);return ye instanceof Promise?(0,a.D)(ye).pipe((0,V.zg)(me=>this.handleInterception(me,G,te))):this.handleInterception(ye,G,te)}}return Z.\u0275fac=function(G){return new(G||Z)(d.LFG(A),d.LFG(p),d.LFG(c.K0))},Z.\u0275prov=d.Yz7({token:Z,factory:Z.\u0275fac}),Z})(),Q=(()=>{class Z{constructor(G){if(G)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(G){return{ngModule:Z,providers:[{provide:O.TP,useClass:L,multi:!0},G.jwtOptionsProvider||{provide:A,useValue:G.config},p]}}}return Z.\u0275fac=function(G){return new(G||Z)(d.LFG(Z,12))},Z.\u0275mod=d.oAB({type:Z}),Z.\u0275inj=d.cJS({}),Z})()},7423:(_n,Ke,k)=>{"use strict";k.d(Ke,{Uw:()=>je,fo:()=>ye});var d=k(6099);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global&&global;var L=(()=>{return(Ae=L||(L={})).Unimplemented="UNIMPLEMENTED",Ae.Unavailable="UNAVAILABLE",L;var Ae})();class Q extends Error{constructor(Ze,Ve){super(Ze),this.message=Ze,this.code=Ve}}const z=Ae=>{var Ze,Ve,He,Ne,xt;const Je=Ae.CapacitorCustomPlatform||null,ct=Ae.Capacitor||{},wt=ct.Plugins=ct.Plugins||{},Tt=Ae.CapacitorPlatforms,gt=(null===(Ze=null==Tt?void 0:Tt.currentPlatform)||void 0===Ze?void 0:Ze.getPlatform)||(()=>null!==Je?Je.name:(Ae=>{var Ze,Ve;return(null==Ae?void 0:Ae.androidBridge)?"android":(null===(Ve=null===(Ze=null==Ae?void 0:Ae.webkit)||void 0===Ze?void 0:Ze.messageHandlers)||void 0===Ve?void 0:Ve.bridge)?"ios":"web"})(Ae)),Ht=(null===(Ve=null==Tt?void 0:Tt.currentPlatform)||void 0===Ve?void 0:Ve.isNativePlatform)||(()=>"web"!==gt()),Ft=(null===(He=null==Tt?void 0:Tt.currentPlatform)||void 0===He?void 0:He.isPluginAvailable)||(Bn=>{const ln=Jn.get(Bn);return!(!(null==ln?void 0:ln.platforms.has(gt()))&&!Gt(Bn))}),Gt=(null===(Ne=null==Tt?void 0:Tt.currentPlatform)||void 0===Ne?void 0:Ne.getPluginHeader)||(Bn=>{var ln;return null===(ln=ct.PluginHeaders)||void 0===ln?void 0:ln.find(Et=>Et.name===Bn)}),Jn=new Map,di=(null===(xt=null==Tt?void 0:Tt.currentPlatform)||void 0===xt?void 0:xt.registerPlugin)||((Bn,ln={})=>{const Et=Jn.get(Bn);if(Et)return console.warn(`Capacitor plugin "${Bn}" already registered. Cannot register plugins twice.`),Et.proxy;const Kt=gt(),Hn=Gt(Bn);let In;const ti=function(){var Si=(0,d.Z)(function*(){return!In&&Kt in ln?In=In="function"==typeof ln[Kt]?yield ln[Kt]():ln[Kt]:null!==Je&&!In&&"web"in ln&&(In=In="function"==typeof ln.web?yield ln.web():ln.web),In});return function(){return Si.apply(this,arguments)}}(),ir=Si=>{let ki;const Qt=(...et)=>{const de=ti().then(Pe=>{const ft=((Si,ki)=>{var Qt,et;if(!Hn){if(Si)return null===(et=Si[ki])||void 0===et?void 0:et.bind(Si);throw new Q(`"${Bn}" plugin is not implemented on ${Kt}`,L.Unimplemented)}{const de=null==Hn?void 0:Hn.methods.find(Pe=>ki===Pe.name);if(de)return"promise"===de.rtype?Pe=>ct.nativePromise(Bn,ki.toString(),Pe):(Pe,ft)=>ct.nativeCallback(Bn,ki.toString(),Pe,ft);if(Si)return null===(Qt=Si[ki])||void 0===Qt?void 0:Qt.bind(Si)}})(Pe,Si);if(ft){const Be=ft(...et);return ki=null==Be?void 0:Be.remove,Be}throw new Q(`"${Bn}.${Si}()" is not implemented on ${Kt}`,L.Unimplemented)});return"addListener"===Si&&(de.remove=(0,d.Z)(function*(){return ki()})),de};return Qt.toString=()=>`${Si.toString()}() { [capacitor code] }`,Object.defineProperty(Qt,"name",{value:Si,writable:!1,configurable:!1}),Qt},_r=ir("addListener"),er=ir("removeListener"),Ri=(Si,ki)=>{const Qt=_r({eventName:Si},ki),et=function(){var Pe=(0,d.Z)(function*(){const ft=yield Qt;er({eventName:Si,callbackId:ft},ki)});return function(){return Pe.apply(this,arguments)}}(),de=new Promise(Pe=>Qt.then(()=>Pe({remove:et})));return de.remove=(0,d.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield et()}),de},mr=new Proxy({},{get(Si,ki){switch(ki){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Hn?Ri:_r;case"removeListener":return er;default:return ir(ki)}}});return wt[Bn]=mr,Jn.set(Bn,{name:Bn,proxy:mr,platforms:new Set([...Object.keys(ln),...Hn?[Kt]:[]])}),mr});return ct.convertFileSrc||(ct.convertFileSrc=Bn=>Bn),ct.getPlatform=gt,ct.handleError=Bn=>Ae.console.error(Bn),ct.isNativePlatform=Ht,ct.isPluginAvailable=Ft,ct.pluginMethodNoop=(Bn,ln,Et)=>Promise.reject(`${Et} does not have an implementation of "${ln}".`),ct.registerPlugin=di,ct.Exception=Q,ct.DEBUG=!!ct.DEBUG,ct.isLoggingEnabled=!!ct.isLoggingEnabled,ct.platform=ct.getPlatform(),ct.isNative=ct.isNativePlatform(),ct},te=(Ae=>Ae.Capacitor=z(Ae))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),ye=te.registerPlugin;class je{constructor(Ze){this.listeners={},this.windowListeners={},Ze&&(console.warn(`Capacitor WebPlugin "${Ze.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=Ze)}addListener(Ze,Ve){var He=this;this.listeners[Ze]||(this.listeners[Ze]=[]),this.listeners[Ze].push(Ve);const xt=this.windowListeners[Ze];xt&&!xt.registered&&this.addWindowListener(xt);const Je=function(){var wt=(0,d.Z)(function*(){return He.removeListener(Ze,Ve)});return function(){return wt.apply(this,arguments)}}(),ct=Promise.resolve({remove:Je});return Object.defineProperty(ct,"remove",{value:(wt=(0,d.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield Je()}),function(){return wt.apply(this,arguments)})}),ct;var wt}removeAllListeners(){var Ze=this;return(0,d.Z)(function*(){Ze.listeners={};for(const Ve in Ze.windowListeners)Ze.removeWindowListener(Ze.windowListeners[Ve]);Ze.windowListeners={}})()}notifyListeners(Ze,Ve){const He=this.listeners[Ze];He&&He.forEach(Ne=>Ne(Ve))}hasListeners(Ze){return!!this.listeners[Ze].length}registerWindowListener(Ze,Ve){this.windowListeners[Ve]={registered:!1,windowEventName:Ze,pluginEventName:Ve,handler:He=>{this.notifyListeners(Ve,He)}}}unimplemented(Ze="not implemented"){return new te.Exception(Ze,L.Unimplemented)}unavailable(Ze="not available"){return new te.Exception(Ze,L.Unavailable)}removeListener(Ze,Ve){var He=this;return(0,d.Z)(function*(){const Ne=He.listeners[Ze];if(!Ne)return;const xt=Ne.indexOf(Ve);He.listeners[Ze].splice(xt,1),He.listeners[Ze].length||He.removeWindowListener(He.windowListeners[Ze])})()}addWindowListener(Ze){window.addEventListener(Ze.windowEventName,Ze.handler),Ze.registered=!0}removeWindowListener(Ze){!Ze||(window.removeEventListener(Ze.windowEventName,Ze.handler),Ze.registered=!1)}}},9064:(_n,Ke,k)=>{"use strict";k.d(Ke,{BX:()=>oa,Br:()=>Rn,w:()=>Gr,dr:()=>kt,BJ:()=>tt,oU:()=>Zt,cs:()=>es,yp:()=>sn,YG:()=>Wn,Sm:()=>ai,PM:()=>Kn,FN:()=>ui,Zi:()=>Qi,wI:()=>Bi,W2:()=>Gi,IJ:()=>hi,W4:()=>Cr,zq:()=>xr,fr:()=>qr,jY:()=>Ao,Gu:()=>Oi,gu:()=>yo,pK:()=>Sr,Ie:()=>Pr,Q$:()=>zt,q_:()=>rn,yh:()=>un,z0:()=>dn,fG:()=>An,zc:()=>qn,uN:()=>qi,I_:()=>pr,nJ:()=>Lo,Wo:()=>mo,jP:()=>ri,Nd:()=>wo,VI:()=>at,cJ:()=>nt,GO:()=>ke,t9:()=>At,n0:()=>en,PQ:()=>ie,jI:()=>ue,g2:()=>ht,Bs:()=>fn,wd:()=>Dn,ho:()=>yn,sr:()=>oi,Pc:()=>To,r4:()=>Ds,HT:()=>Dr,IN:()=>_a,SH:()=>ee,X1:()=>Pi,as:()=>eo,t4:()=>Er,YI:()=>zs,QI:()=>Xi,j9:()=>ur,yF:()=>hs});var d=k(6738),c=k(4006);function p(D,W,E,Y){var kn,Te=arguments.length,Pt=Te<3?W:null===Y?Y=Object.getOwnPropertyDescriptor(W,E):Y;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Pt=Reflect.decorate(D,W,E,Y);else for(var Qn=D.length-1;Qn>=0;Qn--)(kn=D[Qn])&&(Pt=(Te<3?kn(Pt):Te>3?kn(W,E,Pt):kn(W,E))||Pt);return Te>3&&Pt&&Object.defineProperty(W,E,Pt),Pt}function Z(D,W,E,Y){return new(E||(E=Promise))(function(Pt,kn){function Qn(br){try{wi(Y.next(br))}catch(Vr){kn(Vr)}}function Yi(br){try{wi(Y.throw(br))}catch(Vr){kn(Vr)}}function wi(br){br.done?Pt(br.value):function Te(Pt){return Pt instanceof E?Pt:new E(function(kn){kn(Pt)})}(br.value).then(Qn,Yi)}wi((Y=Y.apply(D,W||[])).next())})}var Ct=k(3753),gt=k(8929),Lt=k(591),Ht=k(3334),Gt=(k(939),k(773),k(1363),k(7639)),Jt=k(6499),an=k(2098),si=(k(7313),k(1686)),Bn=(k(2733),k(9533));k(2335),k(2993),k(410),k(5893),k(7788),k(9955);var mr=k(3489);class ki{constructor(W,E){this.compare=W,this.keySelector=E}call(W,E){return E.subscribe(new Qt(W,this.compare,this.keySelector))}}class Qt extends mr.L{constructor(W,E,Y){super(W),this.keySelector=Y,this.hasKey=!1,"function"==typeof E&&(this.compare=E)}compare(W,E){return W===E}_next(W){let E;try{const{keySelector:Te}=this;E=Te?Te(W):W}catch(Te){return this.destination.error(Te)}let Y=!1;if(this.hasKey)try{const{compare:Te}=this;Y=Te(this.key,E)}catch(Te){return this.destination.error(Te)}else this.hasKey=!0;Y||(this.key=E,this.destination.next(W))}}var et=k(2198),de=k(7545),Pe=k(6895);const Be=Gt.i,Ie=["*"],Ei=D=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(D):"function"==typeof requestAnimationFrame?requestAnimationFrame(D):setTimeout(D);let xi=(()=>{class D{constructor(E,Y){this.injector=E,this.el=Y,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(E){this.el.nativeElement.value=this.lastValue=E??"",vr(this.el)}handleChangeEvent(E,Y){E===this.el.nativeElement&&(Y!==this.lastValue&&(this.lastValue=Y,this.onChange(Y)),vr(this.el))}_handleBlurEvent(E){E===this.el.nativeElement&&(this.onTouched(),vr(this.el))}registerOnChange(E){this.onChange=E}registerOnTouched(E){this.onTouched=E}setDisabledState(E){this.el.nativeElement.disabled=E}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let E;try{E=this.injector.get(c.a5)}catch{}if(!E)return;E.statusChanges&&(this.statusChanges=E.statusChanges.subscribe(()=>vr(this.el)));const Y=E.control;Y&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Pt=>{if(void 0!==Y[Pt]){const kn=Y[Pt].bind(Y);Y[Pt]=(...Qn)=>{kn(...Qn),vr(this.el)}}})}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.zs3),d.Y36(d.SBq))},D.\u0275dir=d.lG2({type:D,hostBindings:function(E,Y){1&E&&d.NdJ("ionBlur",function(Pt){return Y._handleBlurEvent(Pt.target)})}}),D})();const vr=D=>{Ei(()=>{const W=D.nativeElement,E=ji(W);Ir(W,E);const Y=W.closest("ion-item");Y&&Ir(Y,E)})},ji=D=>{const W=D.classList,E=[];for(let Y=0;Y<W.length;Y++){const Te=W.item(Y);null!==Te&&$i(Te,"ng-")&&E.push(`ion-${Te.substr(3)}`)}return E},Ir=(D,W)=>{const E=D.classList;["ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"].forEach(Y=>E.remove(Y)),W.forEach(Y=>E.add(Y))},$i=(D,W)=>D.substr(0,W.length)===W;let Gr=(()=>{class D extends xi{constructor(E,Y){super(E,Y)}writeValue(E){this.el.nativeElement.checked=this.lastValue=E??!1,vr(this.el)}_handleIonChange(E){this.handleChangeEvent(E,E.checked)}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.zs3),d.Y36(d.SBq))},D.\u0275dir=d.lG2({type:D,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(E,Y){1&E&&d.NdJ("ionChange",function(Pt){return Y._handleIonChange(Pt.target)})},features:[d._Bn([{provide:c.JU,useExisting:D,multi:!0}]),d.qOj]}),D})(),eo=(()=>{class D extends xi{constructor(E,Y){super(E,Y)}_handleIonChange(E){this.handleChangeEvent(E,E.value)}registerOnChange(E){super.registerOnChange(Y=>{E(""===Y?null:parseFloat(Y))})}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.zs3),d.Y36(d.SBq))},D.\u0275dir=d.lG2({type:D,selectors:[["ion-input","type","number"]],hostBindings:function(E,Y){1&E&&d.NdJ("ionChange",function(Pt){return Y._handleIonChange(Pt.target)})},features:[d._Bn([{provide:c.JU,useExisting:D,multi:!0}]),d.qOj]}),D})(),Xi=(()=>{class D extends xi{constructor(E,Y){super(E,Y)}_handleChangeEvent(E){this.handleChangeEvent(E,E.value)}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.zs3),d.Y36(d.SBq))},D.\u0275dir=d.lG2({type:D,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(E,Y){1&E&&d.NdJ("ionChange",function(Pt){return Y._handleChangeEvent(Pt.target)})},features:[d._Bn([{provide:c.JU,useExisting:D,multi:!0}]),d.qOj]}),D})(),ur=(()=>{class D extends xi{constructor(E,Y){super(E,Y)}_handleInputEvent(E){this.handleChangeEvent(E,E.value)}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.zs3),d.Y36(d.SBq))},D.\u0275dir=d.lG2({type:D,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(E,Y){1&E&&d.NdJ("ionChange",function(Pt){return Y._handleInputEvent(Pt.target)})},features:[d._Bn([{provide:c.JU,useExisting:D,multi:!0}]),d.qOj]}),D})();const re=(D,W)=>{const E=D.prototype;W.forEach(Y=>{Object.defineProperty(E,Y,{get(){return this.el[Y]},set(Te){this.z.runOutsideAngular(()=>this.el[Y]=Te)}})})},K=(D,W)=>{const E=D.prototype;W.forEach(Y=>{E[Y]=function(){const Te=arguments;return this.z.runOutsideAngular(()=>this.el[Y].apply(this.el,Te))}})},F=(D,W,E)=>{E.forEach(Y=>D[Y]=(0,Ct.R)(W,Y))};function _e(D){return function(E){const{defineCustomElementFn:Y,inputs:Te,methods:Pt}=D;return void 0!==Y&&Y(),Te&&re(E,Te),Pt&&K(E,Pt),E}}let kt=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-app"]],ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0})],D),D})(),tt=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-avatar"]],ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0})],D),D})(),Zt=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],D),D})(),sn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-badge"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","mode"]})],D),D})(),Wn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionFocus","ionBlur"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["buttonType","color","disabled","download","expand","fill","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],D),D})(),ai=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["collapse"]})],D),D})(),Kn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],D),D})(),ui=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["mode"]})],D),D})(),Qi=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","mode","translucent"]})],D),D})(),Bi=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],D),D})(),Gi=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],D),D})(),hi=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-fab"]],inputs:{activated:"activated",edge:"edge",horizontal:"horizontal",vertical:"vertical"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["activated","edge","horizontal","vertical"],methods:["close"]})],D),D})(),Cr=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionFocus","ionBlur"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-fab-button"]],inputs:{activated:"activated",closeIcon:"closeIcon",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",show:"show",size:"size",target:"target",translucent:"translucent",type:"type"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["activated","closeIcon","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","show","size","target","translucent","type"]})],D),D})(),xr=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-fab-list"]],inputs:{activated:"activated",side:"side"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["activated","side"]})],D),D})(),qr=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["collapse","mode","translucent"]})],D),D})(),Ao=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-grid"]],inputs:{fixed:"fixed"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["fixed"]})],D),D})(),Oi=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["collapse","mode","translucent"]})],D),D})(),yo=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],D),D})(),Sr=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","debounce","disabled","enterkeyhint","inputmode","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],D),D})(),Pr=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["button","color","counter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],D),D})(),zt=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","mode","position"]})],D),D})(),rn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],D),D})(),un=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-list-header"]],inputs:{color:"color",lines:"lines",mode:"mode"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","lines","mode"]})],D),D})(),dn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],D),D})(),An=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["autoHide","color","disabled","menu","mode","type"]})],D),D})(),qn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-menu-toggle"]],inputs:{autoHide:"autoHide",menu:"menu"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["autoHide","menu"]})],D),D})(),qi=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-note"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","mode"]})],D),D})(),pr=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionChange","ionFocus","ionBlur"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-range"]],inputs:{color:"color",debounce:"debounce",disabled:"disabled",dualKnobs:"dualKnobs",max:"max",min:"min",mode:"mode",name:"name",pin:"pin",pinFormatter:"pinFormatter",snaps:"snaps",step:"step",ticks:"ticks",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","debounce","disabled","dualKnobs","max","min","mode","name","pin","pinFormatter","snaps","step","ticks","value"]})],D),D})(),Lo=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionRefresh","ionPull","ionStart"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-refresher"]],inputs:{closeDuration:"closeDuration",disabled:"disabled",pullFactor:"pullFactor",pullMax:"pullMax",pullMin:"pullMin",snapbackDuration:"snapbackDuration"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["closeDuration","disabled","pullFactor","pullMax","pullMin","snapbackDuration"],methods:["complete","cancel","getProgress"]})],D),D})(),mo=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-refresher-content"]],inputs:{pullingIcon:"pullingIcon",pullingText:"pullingText",refreshingSpinner:"refreshingSpinner",refreshingText:"refreshingText"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["pullingIcon","pullingText","refreshingSpinner","refreshingText"]})],D),D})(),wo=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-row"]],ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0})],D),D})(),at=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionInput","ionChange","ionCancel","ionClear","ionBlur","ionFocus"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-searchbar"]],inputs:{animated:"animated",autocomplete:"autocomplete",autocorrect:"autocorrect",cancelButtonIcon:"cancelButtonIcon",cancelButtonText:"cancelButtonText",clearIcon:"clearIcon",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",mode:"mode",placeholder:"placeholder",searchIcon:"searchIcon",showCancelButton:"showCancelButton",showClearButton:"showClearButton",spellcheck:"spellcheck",type:"type",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","clearIcon","color","debounce","disabled","enterkeyhint","inputmode","mode","placeholder","searchIcon","showCancelButton","showClearButton","spellcheck","type","value"],methods:["setFocus","getInputElement"]})],D),D})(),nt=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionChange"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],D),D})(),ke=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["disabled","layout","mode","type","value"]})],D),D})(),At=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionChange","ionCancel","ionFocus","ionBlur"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-select"]],inputs:{cancelText:"cancelText",compareWith:"compareWith",disabled:"disabled",interface:"interface",interfaceOptions:"interfaceOptions",mode:"mode",multiple:"multiple",name:"name",okText:"okText",placeholder:"placeholder",selectedText:"selectedText",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["cancelText","compareWith","disabled","interface","interfaceOptions","mode","multiple","name","okText","placeholder","selectedText","value"],methods:["open"]})],D),D})(),en=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-select-option"]],inputs:{disabled:"disabled",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["disabled","value"]})],D),D})(),ie=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-spinner"]],inputs:{color:"color",duration:"duration",name:"name",paused:"paused"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","duration","name","paused"]})],D),D})(),ue=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionSplitPaneVisible"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-split-pane"]],inputs:{contentId:"contentId",disabled:"disabled",when:"when"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["contentId","disabled","when"]})],D),D})(),ht=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionChange","ionInput","ionBlur","ionFocus"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-textarea"]],inputs:{autoGrow:"autoGrow",autocapitalize:"autocapitalize",autofocus:"autofocus",clearOnEdit:"clearOnEdit",color:"color",cols:"cols",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",maxlength:"maxlength",minlength:"minlength",mode:"mode",name:"name",placeholder:"placeholder",readonly:"readonly",required:"required",rows:"rows",spellcheck:"spellcheck",value:"value",wrap:"wrap"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["autoGrow","autocapitalize","autofocus","clearOnEdit","color","cols","debounce","disabled","enterkeyhint","inputmode","maxlength","minlength","mode","name","placeholder","readonly","required","rows","spellcheck","value","wrap"],methods:["setFocus","getInputElement"]})],D),D})(),fn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-thumbnail"]],ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0})],D),D})(),Dn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","size"]})],D),D})(),yn=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement,F(this,this.el,["ionChange","ionFocus","ionBlur"])}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",mode:"mode",name:"name",value:"value"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["checked","color","disabled","mode","name","value"]})],D),D})(),oi=(()=>{let D=class{constructor(E,Y,Te){this.z=Te,E.detach(),this.el=Y.nativeElement}};return D.\u0275fac=function(E){return new(E||D)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},D.\u0275cmp=d.Xpm({type:D,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Ie,decls:1,vars:0,template:function(E,Y){1&E&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),D=p([_e({defineCustomElementFn:void 0,inputs:["color","mode"]})],D),D})();class Pi{constructor(W={}){this.data=W}get(W){return this.data[W]}}let Mi=(()=>{class D{constructor(E,Y){this.zone=E,this.appRef=Y}create(E,Y,Te){return new bi(E,Y,Te,this.appRef,this.zone)}}return D.\u0275fac=function(E){return new(E||D)(d.LFG(d.R0b),d.LFG(d.z2F))},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac}),D})();class bi{constructor(W,E,Y,Te,Pt){this.resolver=W,this.injector=E,this.location=Y,this.appRef=Te,this.zone=Pt,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(W,E,Y,Te){return this.zone.run(()=>new Promise(Pt=>{Pt(gr(this.zone,this.resolver,this.injector,this.location,this.appRef,this.elRefMap,this.elEventsMap,W,E,Y,Te))}))}removeViewFromDom(W,E){return this.zone.run(()=>new Promise(Y=>{const Te=this.elRefMap.get(E);if(Te){Te.destroy(),this.elRefMap.delete(E);const Pt=this.elEventsMap.get(E);Pt&&(Pt(),this.elEventsMap.delete(E))}Y()}))}}const gr=(D,W,E,Y,Te,Pt,kn,Qn,Yi,wi,br)=>{const Vr=W.resolveComponentFactory(Yi),ro=d.zs3.create({providers:nr(wi),parent:E}),Fo=Y?Y.createComponent(Vr,Y.length,ro):Vr.create(ro),ss=Fo.instance,ps=Fo.location.nativeElement;if(wi&&Object.assign(ss,wi),br)for(const Il of br)ps.classList.add(Il);const al=Ci(D,ss,ps);return Qn.appendChild(ps),Y||Te.attachView(Fo.hostView),Fo.changeDetectorRef.reattach(),Pt.set(ps,Fo),kn.set(ps,al),ps},Di=[an.L,an.a,an.b,an.c,an.d],Ci=(D,W,E)=>D.run(()=>{const Y=Di.filter(Te=>"function"==typeof W[Te]).map(Te=>{const Pt=kn=>W[Te](kn.detail);return E.addEventListener(Te,Pt),()=>E.removeEventListener(Te,Pt)});return()=>Y.forEach(Te=>Te())}),dr=new d.OlP("NavParamsToken"),nr=D=>[{provide:dr,useValue:D},{provide:Pi,useFactory:io,deps:[dr]}],io=D=>new Pi(D),Hr=(D,W)=>((D=D.filter(E=>E.stackId!==W.stackId)).push(W),D),se=(D,W)=>{const E=D.createUrlTree(["."],{relativeTo:W});return D.serializeUrl(E)},ae=(D,W)=>{if(!D)return;const E=ze(W);for(let Y=0;Y<E.length;Y++){if(Y>=D.length)return E[Y];if(E[Y]!==D[Y])return}},ze=D=>D.split("/").map(W=>W.trim()).filter(W=>""!==W),St=D=>{D&&(D.ref.destroy(),D.unlistenEvents())};class tn{constructor(W,E,Y,Te,Pt,kn){this.containerEl=E,this.router=Y,this.navCtrl=Te,this.zone=Pt,this.location=kn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==W?ze(W):void 0}createView(W,E){var Y;const Te=se(this.router,E),Pt=null===(Y=null==W?void 0:W.location)||void 0===Y?void 0:Y.nativeElement,kn=Ci(this.zone,W.instance,Pt);return{id:this.nextId++,stackId:ae(this.tabsPrefix,Te),unlistenEvents:kn,element:Pt,ref:W,url:Te}}getExistingView(W){const E=se(this.router,W),Y=this.views.find(Te=>Te.url===E);return Y&&Y.ref.changeDetectorRef.reattach(),Y}setActive(W){var E,Y;const Te=this.navCtrl.consumeTransition();let{direction:Pt,animation:kn,animationBuilder:Qn}=Te;const Yi=this.activeView,wi=((D,W)=>!W||D.stackId!==W.stackId)(W,Yi);wi&&(Pt="back",kn=void 0);const br=this.views.slice();let Vr;const ro=this.router;ro.getCurrentNavigation?Vr=ro.getCurrentNavigation():(null===(E=ro.navigations)||void 0===E?void 0:E.value)&&(Vr=ro.navigations.value),(null===(Y=null==Vr?void 0:Vr.extras)||void 0===Y?void 0:Y.replaceUrl)&&this.views.length>0&&this.views.splice(-1,1);const Fo=this.views.includes(W),ss=this.insertView(W,Pt);Fo||W.ref.changeDetectorRef.detectChanges();const ps=W.animationBuilder;return void 0===Qn&&"back"===Pt&&!wi&&void 0!==ps&&(Qn=ps),Yi&&(Yi.animationBuilder=Qn),this.zone.runOutsideAngular(()=>this.wait(()=>(Yi&&Yi.ref.changeDetectorRef.detach(),W.ref.changeDetectorRef.reattach(),this.transition(W,Yi,kn,this.canGoBack(1),!1,Qn).then(()=>Ln(W,ss,br,this.location)).then(()=>({enteringView:W,direction:Pt,animation:kn,tabSwitch:wi})))))}canGoBack(W,E=this.getActiveStackId()){return this.getStack(E).length>W}pop(W,E=this.getActiveStackId()){return this.zone.run(()=>{var Y,Te;const Pt=this.getStack(E);if(Pt.length<=W)return Promise.resolve(!1);const kn=Pt[Pt.length-W-1];let Qn=kn.url;const Yi=kn.savedData;if(Yi){const br=Yi.get("primary");(null===(Te=null===(Y=null==br?void 0:br.route)||void 0===Y?void 0:Y._routerState)||void 0===Te?void 0:Te.snapshot.url)&&(Qn=br.route._routerState.snapshot.url)}const{animationBuilder:wi}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Qn,Object.assign(Object.assign({},kn.savedExtras),{animation:wi})).then(()=>!0)})}startBackTransition(){const W=this.activeView;if(W){const E=this.getStack(W.stackId),Y=E[E.length-2],Te=Y.animationBuilder;return this.wait(()=>this.transition(Y,W,"back",this.canGoBack(2),!0,Te))}return Promise.resolve()}endBackTransition(W){W?(this.skipTransition=!0,this.pop(1)):this.activeView&&Yn(this.activeView,this.views,this.views,this.location)}getLastUrl(W){const E=this.getStack(W);return E.length>0?E[E.length-1]:void 0}getRootUrl(W){const E=this.getStack(W);return E.length>0?E[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(St),this.activeView=void 0,this.views=[]}getStack(W){return this.views.filter(E=>E.stackId===W)}insertView(W,E){return this.activeView=W,this.views=((D,W,E)=>"root"===E?Hr(D,W):"forward"===E?((D,W)=>(D.indexOf(W)>=0?D=D.filter(Y=>Y.stackId!==W.stackId||Y.id<=W.id):D.push(W),D))(D,W):((D,W)=>D.indexOf(W)>=0?D.filter(Y=>Y.stackId!==W.stackId||Y.id<=W.id):Hr(D,W))(D,W))(this.views,W,E),this.views.slice()}transition(W,E,Y,Te,Pt,kn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(E===W)return Promise.resolve(!1);const Qn=W?W.element:void 0,Yi=E?E.element:void 0,wi=this.containerEl;return Qn&&Qn!==Yi&&(Qn.classList.add("ion-page"),Qn.classList.add("ion-page-invisible"),Qn.parentElement!==wi&&wi.appendChild(Qn),wi.commit)?wi.commit(Qn,Yi,{deepWait:!0,duration:void 0===Y?0:void 0,direction:Y,showGoBack:Te,progressAnimation:Pt,animationBuilder:kn}):Promise.resolve(!1)}wait(W){return Z(this,void 0,void 0,function*(){void 0!==this.runningTask&&(yield this.runningTask,this.runningTask=void 0);const E=this.runningTask=W();return E.finally(()=>this.runningTask=void 0),E})}}const Ln=(D,W,E,Y)=>"function"==typeof requestAnimationFrame?new Promise(Te=>{requestAnimationFrame(()=>{Yn(D,W,E,Y),Te()})}):Promise.resolve(),Yn=(D,W,E,Y)=>{E.filter(Te=>!W.includes(Te)).forEach(St),W.forEach(Te=>{const kn=Y.path().split("?")[0].split("#")[0];if(Te!==D&&Te.url!==kn){const Qn=Te.element;Qn.setAttribute("aria-hidden","true"),Qn.classList.add("ion-page-hidden"),Te.ref.changeDetectorRef.detach()}})};let Mr=(()=>{class D{get(E,Y){const Te=Zi();return Te?Te.get(E,Y):null}getBoolean(E,Y){const Te=Zi();return!!Te&&Te.getBoolean(E,Y)}getNumber(E,Y){const Te=Zi();return Te?Te.getNumber(E,Y):0}}return D.\u0275fac=function(E){return new(E||D)},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();const Fr=new d.OlP("USERCONFIG"),Zi=()=>{if("undefined"!=typeof window){const D=window.Ionic;if(null==D?void 0:D.config)return D.config}return null};let Er=(()=>{class D{constructor(E,Y){this.doc=E,this.backButton=new gt.xQ,this.keyboardDidShow=new gt.xQ,this.keyboardDidHide=new gt.xQ,this.pause=new gt.xQ,this.resume=new gt.xQ,this.resize=new gt.xQ,Y.run(()=>{var Te;let Pt;this.win=E.defaultView,this.backButton.subscribeWithPriority=function(kn,Qn){return this.subscribe(Yi=>Yi.register(kn,wi=>Y.run(()=>Qn(wi))))},le(this.pause,E,"pause"),le(this.resume,E,"resume"),le(this.backButton,E,"ionBackButton"),le(this.resize,this.win,"resize"),le(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),le(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(kn=>{Pt=kn}),(null===(Te=this.win)||void 0===Te?void 0:Te.cordova)?E.addEventListener("deviceready",()=>{Pt("cordova")},{once:!0}):Pt("dom")})}is(E){return(0,Gt.a)(this.win,E)}platforms(){return(0,Gt.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(E){return vo(this.win.location.href,E)}isLandscape(){return!this.isPortrait()}isPortrait(){var E,Y;return null===(Y=(E=this.win).matchMedia)||void 0===Y?void 0:Y.call(E,"(orientation: portrait)").matches}testUserAgent(E){const Y=this.win.navigator;return!!((null==Y?void 0:Y.userAgent)&&Y.userAgent.indexOf(E)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return D.\u0275fac=function(E){return new(E||D)(d.LFG(Pe.K0),d.LFG(d.R0b))},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();const vo=(D,W)=>{W=W.replace(/[[]/,"\\[").replace(/[\]]/,"\\]");const Y=new RegExp("[\\?&]"+W+"=([^&#]*)").exec(D);return Y?decodeURIComponent(Y[1].replace(/\+/g," ")):null},le=(D,W,E)=>{W&&W.addEventListener(E,Y=>{D.next(null!=Y?Y.detail:void 0)})};let ee=(()=>{class D{constructor(E,Y,Te,Pt){this.location=Y,this.serializer=Te,this.router=Pt,this.direction=Ue,this.animated=pn,this.guessDirection="forward",this.lastNavId=-1,Pt&&Pt.events.subscribe(kn=>{if(kn instanceof Ht.OD){const Qn=kn.restoredState?kn.restoredState.navigationId:kn.id;this.guessDirection=Qn<this.lastNavId?"back":"forward",this.guessAnimation=kn.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?kn.id:Qn}}),E.backButton.subscribeWithPriority(0,kn=>{this.pop(),kn()})}navigateForward(E,Y={}){return this.setDirection("forward",Y.animated,Y.animationDirection,Y.animation),this.navigate(E,Y)}navigateBack(E,Y={}){return this.setDirection("back",Y.animated,Y.animationDirection,Y.animation),this.navigate(E,Y)}navigateRoot(E,Y={}){return this.setDirection("root",Y.animated,Y.animationDirection,Y.animation),this.navigate(E,Y)}back(E={animated:!0,animationDirection:"back"}){return this.setDirection("back",E.animated,E.animationDirection,E.animation),this.location.back()}pop(){return Z(this,void 0,void 0,function*(){let E=this.topOutlet;for(;E&&!(yield E.pop());)E=E.parentOutlet})}setDirection(E,Y,Te,Pt){this.direction=E,this.animated=ne(E,Y,Te),this.animationBuilder=Pt}setTopOutlet(E){this.topOutlet=E}consumeTransition(){let Y,E="root";const Te=this.animationBuilder;return"auto"===this.direction?(E=this.guessDirection,Y=this.guessAnimation):(Y=this.animated,E=this.direction),this.direction=Ue,this.animated=pn,this.animationBuilder=void 0,{direction:E,animation:Y,animationBuilder:Te}}navigate(E,Y){if(Array.isArray(E))return this.router.navigate(E,Y);{const Te=this.serializer.parse(E.toString());return void 0!==Y.queryParams&&(Te.queryParams=Object.assign({},Y.queryParams)),void 0!==Y.fragment&&(Te.fragment=Y.fragment),this.router.navigateByUrl(Te,Y)}}}return D.\u0275fac=function(E){return new(E||D)(d.LFG(Er),d.LFG(Pe.Ye),d.LFG(Ht.Hx),d.LFG(Ht.F0,8))},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();const ne=(D,W,E)=>{if(!1!==W){if(void 0!==E)return E;if("forward"===D||"back"===D)return D;if("root"===D&&!0===W)return"forward"}},Ue="auto",pn=void 0;let ri=(()=>{class D{constructor(E,Y,Te,Pt,kn,Qn,Yi,wi,br,Vr,ro,Fo,ss){this.parentContexts=E,this.location=Y,this.resolver=Te,this.config=Qn,this.navCtrl=Yi,this.parentOutlet=ss,this.activated=null,this.activatedView=null,this._activatedRoute=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new Lt.X(null),this.stackEvents=new d.vpe,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.nativeEl=br.nativeElement,this.name=Pt||Ht.eC,this.tabsPrefix="true"===kn?se(Vr,Fo):void 0,this.stackCtrl=new tn(this.tabsPrefix,this.nativeEl,Vr,Yi,ro,wi),E.onChildOutletCreated(this.name,this)}set animation(E){this.nativeEl.animation=E}set animated(E){this.nativeEl.animated=E}set swipeGesture(E){this._swipeGesture=E,this.nativeEl.swipeHandler=E?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:Y=>this.stackCtrl.endBackTransition(Y)}:void 0}ngOnDestroy(){this.stackCtrl.destroy()}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){if(!this.activated){const E=this.getContext();(null==E?void 0:E.route)&&this.activateWith(E.route,E.resolver||null)}new Promise(E=>(0,Jt.c)(this.nativeEl,E)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(E,Y){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const Y=this.getContext();this.activatedView.savedData=new Map(Y.children.contexts);const Te=this.activatedView.savedData.get("primary");if(Te&&Y.route&&(Te.route=Object.assign({},Y.route)),this.activatedView.savedExtras={},Y.route){const Pt=Y.route.snapshot;this.activatedView.savedExtras.queryParams=Pt.queryParams,this.activatedView.savedExtras.fragment=Pt.fragment}}const E=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(E)}}activateWith(E,Y){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=E;let Te,Pt=this.stackCtrl.getExistingView(E);if(Pt){Te=this.activated=Pt.ref;const kn=Pt.savedData;kn&&(this.getContext().children.contexts=kn),this.updateActivatedRouteProxy(Te.instance,E)}else{const Yi=(Y=Y||this.resolver).resolveComponentFactory(E._futureSnapshot.routeConfig.component),wi=this.parentContexts.getOrCreateContext(this.name).children,br=new Lt.X(null),Vr=this.createActivatedRouteProxy(br,E),ro=new Yr(Vr,wi,this.location.injector);Te=this.activated=this.location.createComponent(Yi,this.location.length,ro),br.next(Te.instance),Pt=this.stackCtrl.createView(this.activated,E),this.proxyMap.set(Te.instance,Vr),this.currentActivatedRoute$.next({component:Te.instance,activatedRoute:E})}this.activatedView=Pt,this.stackCtrl.setActive(Pt).then(kn=>{this.navCtrl.setTopOutlet(this),this.activateEvents.emit(Te.instance),this.stackEvents.emit(kn)})}canGoBack(E=1,Y){return this.stackCtrl.canGoBack(E,Y)}pop(E=1,Y){return this.stackCtrl.pop(E,Y)}getLastUrl(E){const Y=this.stackCtrl.getLastUrl(E);return Y?Y.url:void 0}getLastRouteView(E){return this.stackCtrl.getLastUrl(E)}getRootView(E){return this.stackCtrl.getRootUrl(E)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(E,Y){const Te=new Ht.gz;return Te._futureSnapshot=Y._futureSnapshot,Te._routerState=Y._routerState,Te.snapshot=Y.snapshot,Te.outlet=Y.outlet,Te.component=Y.component,Te._paramMap=this.proxyObservable(E,"paramMap"),Te._queryParamMap=this.proxyObservable(E,"queryParamMap"),Te.url=this.proxyObservable(E,"url"),Te.params=this.proxyObservable(E,"params"),Te.queryParams=this.proxyObservable(E,"queryParams"),Te.fragment=this.proxyObservable(E,"fragment"),Te.data=this.proxyObservable(E,"data"),Te}proxyObservable(E,Y){return E.pipe((0,et.h)(Te=>!!Te),(0,de.w)(Te=>this.currentActivatedRoute$.pipe((0,et.h)(Pt=>null!==Pt&&Pt.component===Te),(0,de.w)(Pt=>Pt&&Pt.activatedRoute[Y]),function Si(D,W){return E=>E.lift(new ki(D,W))}())))}updateActivatedRouteProxy(E,Y){const Te=this.proxyMap.get(E);if(!Te)throw new Error("Could not find activated route proxy for view");Te._futureSnapshot=Y._futureSnapshot,Te._routerState=Y._routerState,Te.snapshot=Y.snapshot,Te.outlet=Y.outlet,Te.component=Y.component,this.currentActivatedRoute$.next({component:E,activatedRoute:Y})}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(Ht.y6),d.Y36(d.s_b),d.Y36(d._Vd),d.$8M("name"),d.$8M("tabs"),d.Y36(Mr),d.Y36(ee),d.Y36(Pe.Ye),d.Y36(d.SBq),d.Y36(Ht.F0),d.Y36(d.R0b),d.Y36(Ht.gz),d.Y36(D,12))},D.\u0275dir=d.lG2({type:D,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",swipeGesture:"swipeGesture"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),D})();class Yr{constructor(W,E,Y){this.route=W,this.childContexts=E,this.parent=Y}get(W,E){return W===Ht.gz?this.route:W===Ht.y6?this.childContexts:this.parent.get(W,E)}}let es=(()=>{class D{constructor(E,Y,Te){this.routerOutlet=E,this.navCtrl=Y,this.config=Te}onClick(E){var Y;const Te=this.defaultHref||this.config.get("backButtonDefaultHref");(null===(Y=this.routerOutlet)||void 0===Y?void 0:Y.canGoBack())?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),E.preventDefault()):null!=Te&&(this.navCtrl.navigateBack(Te,{animation:this.routerAnimation}),E.preventDefault())}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(ri,8),d.Y36(ee),d.Y36(Mr))},D.\u0275dir=d.lG2({type:D,selectors:[["ion-back-button"]],hostBindings:function(E,Y){1&E&&d.NdJ("click",function(Pt){return Y.onClick(Pt)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),D})(),zs=(()=>{class D{constructor(E,Y,Te,Pt,kn){this.locationStrategy=E,this.navCtrl=Y,this.elementRef=Te,this.router=Pt,this.routerLink=kn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}updateTargetUrlAndHref(){var E;if(null===(E=this.routerLink)||void 0===E?void 0:E.urlTree){const Y=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=Y}}onClick(E){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),E.preventDefault()}}return D.\u0275fac=function(E){return new(E||D)(d.Y36(Pe.S$),d.Y36(ee),d.Y36(d.SBq),d.Y36(Ht.F0),d.Y36(Ht.rH,8))},D.\u0275dir=d.lG2({type:D,selectors:[["","routerLink",""]],hostBindings:function(E,Y){1&E&&d.NdJ("click",function(Pt){return Y.onClick(Pt)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[d.TTD]}),D})();class Es{constructor(W){this.ctrl=W}create(W){return this.ctrl.create(W||{})}dismiss(W,E,Y){return this.ctrl.dismiss(W,E,Y)}getTop(){return this.ctrl.getTop()}}let oa=(()=>{class D extends Es{constructor(){super(si.b)}}return D.\u0275fac=function(E){return new(E||D)},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})(),Rn=(()=>{class D extends Es{constructor(){super(si.a)}}return D.\u0275fac=function(E){return new(E||D)},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})(),Dr=(()=>{class D extends Es{constructor(){super(si.l)}}return D.\u0275fac=function(E){return new(E||D)},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})(),_a=(()=>{class D extends Es{constructor(E,Y,Te){super(si.m),this.angularDelegate=E,this.resolver=Y,this.injector=Te}create(E){return super.create(Object.assign(Object.assign({},E),{delegate:this.angularDelegate.create(this.resolver,this.injector)}))}}return D.\u0275fac=function(E){return new(E||D)(d.LFG(Mi),d.LFG(d._Vd),d.LFG(d.zs3))},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac}),D})(),Gs=(()=>{class D extends Es{constructor(E,Y,Te){super(si.c),this.angularDelegate=E,this.resolver=Y,this.injector=Te}create(E){return super.create(Object.assign(Object.assign({},E),{delegate:this.angularDelegate.create(this.resolver,this.injector)}))}}return D.\u0275fac=function(E){return new(E||D)(d.LFG(Mi),d.LFG(d._Vd),d.LFG(d.zs3))},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac}),D})(),hs=(()=>{class D extends Es{constructor(){super(si.t)}}return D.\u0275fac=function(E){return new(E||D)},D.\u0275prov=d.Yz7({token:D,factory:D.\u0275fac,providedIn:"root"}),D})();class Ds{shouldDetach(W){return!1}shouldAttach(W){return!1}store(W,E){}retrieve(W){return null}shouldReuseRoute(W,E){if(W.routeConfig!==E.routeConfig)return!1;const Y=W.params,Te=E.params,Pt=Object.keys(Y),kn=Object.keys(Te);if(Pt.length!==kn.length)return!1;for(const Qn of Pt)if(Te[Qn]!==Y[Qn])return!1;return!0}}const qs=(D,W,E)=>()=>{if(W.defaultView&&"undefined"!=typeof window){(D=>{const W=window,E=W.Ionic;E&&E.config&&"Object"!==E.config.constructor.name||(W.Ionic=W.Ionic||{},W.Ionic.config=Object.assign(Object.assign({},W.Ionic.config),D))})(Object.assign(Object.assign({},D),{_zoneGate:Pt=>E.run(Pt)}));const Te="__zone_symbol__addEventListener"in W.body?"__zone_symbol__addEventListener":"addEventListener";return function ft(){var D=[];if("undefined"!=typeof window){var W=window;(!W.customElements||W.Element&&(!W.Element.prototype.closest||!W.Element.prototype.matches||!W.Element.prototype.remove||!W.Element.prototype.getRootNode))&&D.push(k.e(6748).then(k.t.bind(k,723,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||W.NodeList&&!W.NodeList.prototype.forEach||!W.fetch||!function(){try{var Y=new URL("b","http://a");return Y.pathname="c%20d","http://a/c%20d"===Y.href&&Y.searchParams}catch{return!1}}()||"undefined"==typeof WeakMap)&&D.push(k.e(2214).then(k.t.bind(k,4144,23)))}return Promise.all(D)}().then(()=>((D,W)=>"undefined"==typeof window?Promise.resolve():(0,Bn.p)().then(()=>(Be(),(0,Bn.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[1],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[4],"layout":[1],"type":[1],"value":[1],"checked":[32]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1025],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[33,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"swipeToClose":[4,"swipe-to-close"],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-slide_2",[[0,"ion-slide"],[36,"ion-slides",{"options":[8],"pager":[4],"scrollbar":[4],"update":[64],"updateAutoHeight":[64],"slideTo":[64],"slideNext":[64],"slidePrev":[64],"getActiveIndex":[64],"getPreviousIndex":[64],"length":[64],"isEnd":[64],"isBeginning":[64],"startAutoplay":[64],"stopAutoplay":[64],"lockSwipeToNext":[64],"lockSwipeToPrev":[64],"lockSwipes":[64],"getSwiper":[64]}]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-input",[[34,"ion-input",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"inputmode":[1],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"disabled":[4],"value":[1026],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-textarea",[[34,"ion-textarea",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[1028,"clear-on-edit"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[4,"auto-grow"],"value":[1025],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"activated":[32]}]]],["ion-virtual-scroll",[[0,"ion-virtual-scroll",{"approxItemHeight":[2,"approx-item-height"],"approxHeaderHeight":[2,"approx-header-height"],"approxFooterHeight":[2,"approx-footer-height"],"headerFn":[16],"footerFn":[16],"items":[16],"itemHeight":[16],"headerHeight":[16],"footerHeight":[16],"renderItem":[16],"renderHeader":[16],"renderFooter":[16],"nodeRender":[16],"domRender":[16],"totalHeight":[32],"positionForItem":[64],"checkRange":[64],"checkEnd":[64]},[[9,"resize","onResize"]]]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64]}]]],["ion-picker-internal",[[33,"ion-picker-internal"]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8]}]]],["ion-select_3",[[33,"ion-select",{"disabled":[4],"cancelText":[1,"cancel-text"],"okText":[1,"ok-text"],"placeholder":[1],"name":[1],"selectedText":[1,"selected-text"],"multiple":[4],"interface":[1],"interfaceOptions":[8,"interface-options"],"compareWith":[1,"compare-with"],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]},[[0,"ionChange","onSelect"]]]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionChange","handleIonChange"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isPresented":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32],"ariaLabel":[32]}]]]]'),W))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:Ei,jmp:Pt=>E.runOutsideAngular(Pt),ael(Pt,kn,Qn,Yi){Pt[Te](kn,Qn,Yi)},rel(Pt,kn,Qn,Yi){Pt.removeEventListener(kn,Qn,Yi)}}))}};let To=(()=>{class D{static forRoot(E){return{ngModule:D,providers:[{provide:Fr,useValue:E},{provide:d.ip1,useFactory:qs,multi:!0,deps:[Fr,Pe.K0,d.R0b]}]}}}return D.\u0275fac=function(E){return new(E||D)},D.\u0275mod=d.oAB({type:D}),D.\u0275inj=d.cJS({providers:[Mi,_a,Gs],imports:[[Pe.ez]]}),D})()},5508:(_n,Ke,k)=>{"use strict";k.d(Ke,{c:()=>me});var d=k(6499);let c;const a=Ee=>Ee.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),O=Ee=>{if(void 0===c){const rt=void 0!==Ee.style.webkitAnimationName;c=void 0===Ee.style.animationName&&rt?"-webkit-":""}return c},A=(Ee,je,rt)=>{const Ae=je.startsWith("animation")?O(Ee):"";Ee.style.setProperty(Ae+je,rt)},p=(Ee,je)=>{const rt=je.startsWith("animation")?O(Ee):"";Ee.style.removeProperty(rt+je)},Z=[],ye=(Ee=[],je)=>{if(void 0!==je){const rt=Array.isArray(je)?je:[je];return[...Ee,...rt]}return Ee},me=Ee=>{let je,rt,Ae,Ze,Ve,He,wt,Wt,Gt,Jt,an,Bn,ln,Ne=[],xt=[],Je=[],ct=!1,Tt={},Ct=[],gt=[],Lt={},Ht=0,Vn=!1,Ft=!1,Jn=!0,si=!1,di=!0;const Et=Ee,Kt=[],Hn=[],In=[],ti=[],mi=[],ir=[],_r=[],er=[],Ri=[],mr=[],Si="function"==typeof AnimationEffect||"function"==typeof window.AnimationEffect,ki="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Si,et=()=>mr,Be=(Me,st)=>((st&&st.oneTimeCallback?Hn:Kt).push({c:Me,o:st}),ln),xe=()=>{if(ki)mr.forEach(Me=>{Me.cancel()}),mr.length=0;else{const Me=In.slice();(0,d.r)(()=>{Me.forEach(st=>{p(st,"animation-name"),p(st,"animation-duration"),p(st,"animation-timing-function"),p(st,"animation-iteration-count"),p(st,"animation-delay"),p(st,"animation-play-state"),p(st,"animation-fill-mode"),p(st,"animation-direction")})})}},Ie=()=>{mi.forEach(Me=>{Me&&Me.parentNode&&Me.parentNode.removeChild(Me)}),mi.length=0},eo=()=>void 0!==Ve?Ve:wt?wt.getFill():"both",zr=()=>void 0!==Gt?Gt:void 0!==He?He:wt?wt.getDirection():"normal",Xi=()=>Vn?"linear":void 0!==Ae?Ae:wt?wt.getEasing():"linear",ur=()=>Ft?0:void 0!==Jt?Jt:void 0!==rt?rt:wt?wt.getDuration():0,re=()=>void 0!==Ze?Ze:wt?wt.getIterations():1,K=()=>void 0!==an?an:void 0!==je?je:wt?wt.getDelay():0,Kn=()=>{0!==Ht&&(Ht--,0===Ht&&((()=>{Ao(),er.forEach(rn=>rn()),Ri.forEach(rn=>rn());const Me=Jn?1:0,st=Ct,Rt=gt,zt=Lt;In.forEach(rn=>{const un=rn.classList;st.forEach(dn=>un.add(dn)),Rt.forEach(dn=>un.remove(dn));for(const dn in zt)zt.hasOwnProperty(dn)&&A(rn,dn,zt[dn])}),Kt.forEach(rn=>rn.c(Me,ln)),Hn.forEach(rn=>rn.c(Me,ln)),Hn.length=0,di=!0,Jn&&(si=!0),Jn=!0})(),wt&&wt.animationFinish()))},ui=(Me=!0)=>{Ie();const st=(Ee=>(Ee.forEach(je=>{for(const rt in je)if(je.hasOwnProperty(rt)){const Ae=je[rt];if("easing"===rt)je["animation-timing-function"]=Ae,delete je[rt];else{const Ze=a(rt);Ze!==rt&&(je[Ze]=Ae,delete je[rt])}}}),Ee))(Ne);In.forEach(Rt=>{if(st.length>0){const zt=((Ee=[])=>Ee.map(je=>{const rt=je.offset,Ae=[];for(const Ze in je)je.hasOwnProperty(Ze)&&"offset"!==Ze&&Ae.push(`${Ze}: ${je[Ze]};`);return`${100*rt}% { ${Ae.join(" ")} }`}).join(" "))(st);Bn=void 0!==Ee?Ee:(Ee=>{let je=Z.indexOf(Ee);return je<0&&(je=Z.push(Ee)-1),`ion-animation-${je}`})(zt);const rn=((Ee,je,rt)=>{const Ae=(Ee=>{const je=Ee.getRootNode();return je.head||je})(rt),Ze=O(rt),Ve=Ae.querySelector("#"+Ee);if(Ve)return Ve;const He=(rt.ownerDocument||document).createElement("style");return He.id=Ee,He.textContent=`@${Ze}keyframes ${Ee} { ${je} } @${Ze}keyframes ${Ee}-alt { ${je} }`,Ae.appendChild(He),He})(Bn,zt,Rt);mi.push(rn),A(Rt,"animation-duration",`${ur()}ms`),A(Rt,"animation-timing-function",Xi()),A(Rt,"animation-delay",`${K()}ms`),A(Rt,"animation-fill-mode",eo()),A(Rt,"animation-direction",zr());const un=re()===1/0?"infinite":re().toString();A(Rt,"animation-iteration-count",un),A(Rt,"animation-play-state","paused"),Me&&A(Rt,"animation-name",`${rn.id}-alt`),(0,d.r)(()=>{A(Rt,"animation-name",rn.id||null)})}})},Hi=(Me=!0)=>{(()=>{ir.forEach(zt=>zt()),_r.forEach(zt=>zt());const Me=xt,st=Je,Rt=Tt;In.forEach(zt=>{const rn=zt.classList;Me.forEach(un=>rn.add(un)),st.forEach(un=>rn.remove(un));for(const un in Rt)Rt.hasOwnProperty(un)&&A(zt,un,Rt[un])})})(),Ne.length>0&&(ki?(In.forEach(Me=>{const st=Me.animate(Ne,{id:Et,delay:K(),duration:ur(),easing:Xi(),iterations:re(),fill:eo(),direction:zr()});st.pause(),mr.push(st)}),mr.length>0&&(mr[0].onfinish=()=>{Kn()})):ui(Me)),ct=!0},vi=Me=>{if(Me=Math.min(Math.max(Me,0),.9999),ki)mr.forEach(st=>{st.currentTime=st.effect.getComputedTiming().delay+ur()*Me,st.pause()});else{const st=`-${ur()*Me}ms`;In.forEach(Rt=>{Ne.length>0&&(A(Rt,"animation-delay",st),A(Rt,"animation-play-state","paused"))})}},Pn=Me=>{mr.forEach(st=>{st.effect.updateTiming({delay:K(),duration:ur(),easing:Xi(),iterations:re(),fill:eo(),direction:zr()})}),void 0!==Me&&vi(Me)},Ai=(Me=!0,st)=>{(0,d.r)(()=>{In.forEach(Rt=>{A(Rt,"animation-name",Bn||null),A(Rt,"animation-duration",`${ur()}ms`),A(Rt,"animation-timing-function",Xi()),A(Rt,"animation-delay",void 0!==st?`-${st*ur()}ms`:`${K()}ms`),A(Rt,"animation-fill-mode",eo()||null),A(Rt,"animation-direction",zr()||null);const zt=re()===1/0?"infinite":re().toString();A(Rt,"animation-iteration-count",zt),Me&&A(Rt,"animation-name",`${Bn}-alt`),(0,d.r)(()=>{A(Rt,"animation-name",Bn||null)})})})},Bi=(Me=!1,st=!0,Rt)=>(Me&&ti.forEach(zt=>{zt.update(Me,st,Rt)}),ki?Pn(Rt):Ai(st,Rt),ln),Cr=()=>{ct&&(ki?mr.forEach(Me=>{Me.pause()}):In.forEach(Me=>{A(Me,"animation-play-state","paused")}))},qr=()=>{Wt=void 0,Kn()},Ao=()=>{Wt&&clearTimeout(Wt)},Lr=Me=>new Promise(st=>{Me&&Me.sync&&(Ft=!0,Be(()=>Ft=!1,{oneTimeCallback:!0})),ct||Hi(),si&&(ki?(vi(0),Pn()):Ai(),si=!1),di&&(Ht=ti.length+1,di=!1),Be(()=>st(),{oneTimeCallback:!0}),ti.forEach(Rt=>{Rt.play()}),ki?(mr.forEach(Me=>{Me.play()}),(0===Ne.length||0===In.length)&&Kn()):(()=>{if(Ao(),(0,d.r)(()=>{In.forEach(Me=>{Ne.length>0&&A(Me,"animation-play-state","running")})}),0===Ne.length||0===In.length)Kn();else{const Me=K()||0,st=ur()||0,Rt=re()||1;isFinite(Rt)&&(Wt=setTimeout(qr,Me+st*Rt+100)),((Ee,je)=>{let rt;const Ae={passive:!0},Ve=He=>{Ee===He.target&&(rt&&rt(),Ao(),(0,d.r)(()=>{In.forEach(Me=>{p(Me,"animation-duration"),p(Me,"animation-delay"),p(Me,"animation-play-state")}),(0,d.r)(Kn)}))};Ee&&(Ee.addEventListener("webkitAnimationEnd",Ve,Ae),Ee.addEventListener("animationend",Ve,Ae),rt=()=>{Ee.removeEventListener("webkitAnimationEnd",Ve,Ae),Ee.removeEventListener("animationend",Ve,Ae)})})(In[0])}})()}),Pr=(Me,st)=>{const Rt=Ne[0];return void 0===Rt||void 0!==Rt.offset&&0!==Rt.offset?Ne=[{offset:0,[Me]:st},...Ne]:Rt[Me]=st,ln};return ln={parentAnimation:wt,elements:In,childAnimations:ti,id:Et,animationFinish:Kn,from:Pr,to:(Me,st)=>{const Rt=Ne[Ne.length-1];return void 0===Rt||void 0!==Rt.offset&&1!==Rt.offset?Ne=[...Ne,{offset:1,[Me]:st}]:Rt[Me]=st,ln},fromTo:(Me,st,Rt)=>Pr(Me,st).to(Me,Rt),parent:Me=>(wt=Me,ln),play:Lr,pause:()=>(ti.forEach(Me=>{Me.pause()}),Cr(),ln),stop:()=>{ti.forEach(Me=>{Me.stop()}),ct&&(xe(),ct=!1),Vn=!1,Ft=!1,di=!0,Gt=void 0,Jt=void 0,an=void 0,Ht=0,si=!1,Jn=!0},destroy:Me=>(ti.forEach(st=>{st.destroy(Me)}),(Me=>{xe(),Me&&Ie()})(Me),In.length=0,ti.length=0,Ne.length=0,Kt.length=0,Hn.length=0,ct=!1,di=!0,ln),keyframes:Me=>{const st=Ne!==Me;return Ne=Me,st&&(Me=>{ki?et().forEach(st=>{if(st.effect.setKeyframes)st.effect.setKeyframes(Me);else{const Rt=new KeyframeEffect(st.effect.target,Me,st.effect.getTiming());st.effect=Rt}}):ui()})(Ne),ln},addAnimation:Me=>{if(null!=Me)if(Array.isArray(Me))for(const st of Me)st.parent(ln),ti.push(st);else Me.parent(ln),ti.push(Me);return ln},addElement:Me=>{if(null!=Me)if(1===Me.nodeType)In.push(Me);else if(Me.length>=0)for(let st=0;st<Me.length;st++)In.push(Me[st]);else console.error("Invalid addElement value");return ln},update:Bi,fill:Me=>(Ve=Me,Bi(!0),ln),direction:Me=>(He=Me,Bi(!0),ln),iterations:Me=>(Ze=Me,Bi(!0),ln),duration:Me=>(!ki&&0===Me&&(Me=1),rt=Me,Bi(!0),ln),easing:Me=>(Ae=Me,Bi(!0),ln),delay:Me=>(je=Me,Bi(!0),ln),getWebAnimations:et,getKeyframes:()=>Ne,getFill:eo,getDirection:zr,getDelay:K,getIterations:re,getEasing:Xi,getDuration:ur,afterAddRead:Me=>(er.push(Me),ln),afterAddWrite:Me=>(Ri.push(Me),ln),afterClearStyles:(Me=[])=>{for(const st of Me)Lt[st]="";return ln},afterStyles:(Me={})=>(Lt=Me,ln),afterRemoveClass:Me=>(gt=ye(gt,Me),ln),afterAddClass:Me=>(Ct=ye(Ct,Me),ln),beforeAddRead:Me=>(ir.push(Me),ln),beforeAddWrite:Me=>(_r.push(Me),ln),beforeClearStyles:(Me=[])=>{for(const st of Me)Tt[st]="";return ln},beforeStyles:(Me={})=>(Tt=Me,ln),beforeRemoveClass:Me=>(Je=ye(Je,Me),ln),beforeAddClass:Me=>(xt=ye(xt,Me),ln),onFinish:Be,progressStart:(Me=!1,st)=>(ti.forEach(Rt=>{Rt.progressStart(Me,st)}),Cr(),Vn=Me,ct||Hi(),Bi(!1,!0,st),ln),progressStep:Me=>(ti.forEach(st=>{st.progressStep(Me)}),vi(Me),ln),progressEnd:(Me,st,Rt)=>(Vn=!1,ti.forEach(zt=>{zt.progressEnd(Me,st,Rt)}),void 0!==Rt&&(Jt=Rt),si=!1,Jn=!0,0===Me?(Gt="reverse"===zr()?"normal":"reverse","reverse"===Gt&&(Jn=!1),ki?(Bi(),vi(1-st)):(an=(1-st)*ur()*-1,Bi(!1,!1))):1===Me&&(ki?(Bi(),vi(st)):(an=st*ur()*-1,Bi(!1,!1))),void 0!==Me&&(Be(()=>{Jt=void 0,Gt=void 0,an=void 0},{oneTimeCallback:!0}),wt||Lr()),ln)}}},2993:(_n,Ke,k)=>{"use strict";k.d(Ke,{B:()=>A});var d=k(9533),c=k(7639),V=k(2733);let A=class{constructor(p){(0,d.r)(this,p),this.ionBackdropTap=(0,d.e)(this,"ionBackdropTap",7),this.blocker=V.G.createBlocker({disableScroll:!0}),this.visible=!0,this.tappable=!0,this.stopPropagation=!0}connectedCallback(){this.stopPropagation&&this.blocker.block()}disconnectedCallback(){this.blocker.unblock()}onMouseDown(p){this.emitTap(p)}emitTap(p){this.stopPropagation&&(p.preventDefault(),p.stopPropagation()),this.tappable&&this.ionBackdropTap.emit()}render(){const p=(0,c.b)(this);return(0,d.h)(d.H,{tabindex:"-1","aria-hidden":"true",class:{[p]:!0,"backdrop-hide":!this.visible,"backdrop-no-tappable":!this.tappable}})}};A.style={ios:":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}",md:":host{left:0;right:0;top:0;bottom:0;display:block;position:absolute;-webkit-transform:translateZ(0);transform:translateZ(0);contain:strict;cursor:pointer;opacity:0.01;-ms-touch-action:none;touch-action:none;z-index:2}:host(.backdrop-hide){background:transparent}:host(.backdrop-no-tappable){cursor:auto}:host{background-color:var(--ion-backdrop-color, #000)}"}},7438:(_n,Ke,k)=>{"use strict";k.d(Ke,{g:()=>d});const d=(A,p,L,Q,Z)=>V(A[1],p[1],L[1],Q[1],Z).map(z=>c(A[0],p[0],L[0],Q[0],z)),c=(A,p,L,Q,Z)=>Z*(3*p*Math.pow(Z-1,2)+Z*(-3*L*Z+3*L+Q*Z))-A*Math.pow(Z-1,3),V=(A,p,L,Q,Z)=>O((Q-=Z)-3*(L-=Z)+3*(p-=Z)-(A-=Z),3*L-6*p+3*A,3*p-3*A,A).filter(G=>G>=0&&G<=1),O=(A,p,L,Q)=>{if(0===A)return((A,p,L)=>{const Q=p*p-4*A*L;return Q<0?[]:[(-p+Math.sqrt(Q))/(2*A),(-p-Math.sqrt(Q))/(2*A)]})(p,L,Q);const Z=(3*(L/=A)-(p/=A)*p)/3,z=(2*p*p*p-9*p*L+27*(Q/=A))/27;if(0===Z)return[Math.pow(-z,1/3)];if(0===z)return[Math.sqrt(-Z),-Math.sqrt(-Z)];const G=Math.pow(z/2,2)+Math.pow(Z/3,3);if(0===G)return[Math.pow(z/2,.5)-p/3];if(G>0)return[Math.pow(-z/2+Math.sqrt(G),1/3)-Math.pow(z/2+Math.sqrt(G),1/3)-p/3];const te=Math.sqrt(Math.pow(-Z/3,3)),ye=Math.acos(-z/(2*Math.sqrt(Math.pow(-Z/3,3)))),me=2*Math.pow(te,1/3);return[me*Math.cos(ye/3)-p/3,me*Math.cos((ye+2*Math.PI)/3)-p/3,me*Math.cos((ye+4*Math.PI)/3)-p/3]}},940:(_n,Ke,k)=>{"use strict";k.d(Ke,{C:()=>O,a:()=>V,d:()=>a});var d=k(6099),c=k(6499);const V=function(){var A=(0,d.Z)(function*(p,L,Q,Z,z,G){if(p)return p.attachViewToDom(L,Q,z,Z);if(!(G||"string"==typeof Q||Q instanceof HTMLElement))throw new Error("framework delegate is missing");const te="string"==typeof Q?L.ownerDocument&&L.ownerDocument.createElement(Q):Q;return Z&&Z.forEach(ye=>te.classList.add(ye)),z&&Object.assign(te,z),L.appendChild(te),yield new Promise(ye=>(0,c.c)(te,ye)),te});return function(L,Q,Z,z,G,te){return A.apply(this,arguments)}}(),a=(A,p)=>{if(p){if(A)return A.removeViewFromDom(p.parentElement,p);p.remove()}return Promise.resolve()},O=()=>{let A,p;return{attachViewToDom:function(){var Z=(0,d.Z)(function*(z,G,te={},ye=[]){if(A=z,G){const Ee="string"==typeof G?A.ownerDocument&&A.ownerDocument.createElement(G):G;ye.forEach(je=>Ee.classList.add(je)),Object.assign(Ee,te),A.appendChild(Ee),yield new Promise(je=>(0,c.c)(Ee,je))}const me=document.querySelector("ion-app")||document.body;return p=document.createComment("ionic teleport"),A.parentNode.insertBefore(p,A),me.appendChild(A),A});return function(G,te){return Z.apply(this,arguments)}}(),removeViewFromDom:()=>(A&&p&&(p.parentNode.insertBefore(A,p),p.remove()),Promise.resolve())}}},2733:(_n,Ke,k)=>{"use strict";k.d(Ke,{G:()=>O});class c{constructor(p,L,Q,Z,z){this.id=L,this.name=Q,this.disableScroll=z,this.priority=1e6*Z+L,this.ctrl=p}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const p=this.ctrl.capture(this.name,this.id,this.priority);return p&&this.disableScroll&&this.ctrl.disableScroll(this.id),p}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class V{constructor(p,L,Q,Z){this.id=L,this.disable=Q,this.disableScroll=Z,this.ctrl=p}block(){if(this.ctrl){if(this.disable)for(const p of this.disable)this.ctrl.disableGesture(p,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const p of this.disable)this.ctrl.enableGesture(p,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const a="backdrop-no-scroll",O=new class d{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(p){return new c(this,this.newID(),p.name,p.priority||0,!!p.disableScroll)}createBlocker(p={}){return new V(this,this.newID(),p.disable,!!p.disableScroll)}start(p,L,Q){return this.canStart(p)?(this.requestedStart.set(L,Q),!0):(this.requestedStart.delete(L),!1)}capture(p,L,Q){if(!this.start(p,L,Q))return!1;const Z=this.requestedStart;let z=-1e4;if(Z.forEach(G=>{z=Math.max(z,G)}),z===Q){this.capturedId=L,Z.clear();const G=new CustomEvent("ionGestureCaptured",{detail:{gestureName:p}});return document.dispatchEvent(G),!0}return Z.delete(L),!1}release(p){this.requestedStart.delete(p),this.capturedId===p&&(this.capturedId=void 0)}disableGesture(p,L){let Q=this.disabledGestures.get(p);void 0===Q&&(Q=new Set,this.disabledGestures.set(p,Q)),Q.add(L)}enableGesture(p,L){const Q=this.disabledGestures.get(p);void 0!==Q&&Q.delete(L)}disableScroll(p){this.disabledScroll.add(p),1===this.disabledScroll.size&&document.body.classList.add(a)}enableScroll(p){this.disabledScroll.delete(p),0===this.disabledScroll.size&&document.body.classList.remove(a)}canStart(p){return!(void 0!==this.capturedId||this.isDisabled(p))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(p){const L=this.disabledGestures.get(p);return!!(L&&L.size>0)}newID(){return this.gestureId++,this.gestureId}}},2335:(_n,Ke,k)=>{"use strict";k.d(Ke,{a:()=>V,b:()=>a,c:()=>c,d:()=>A,h:()=>O});const d={getEngine(){const p=window;return p.TapticEngine||p.Capacitor&&p.Capacitor.isPluginAvailable("Haptics")&&p.Capacitor.Plugins.Haptics},available(){return!!this.getEngine()},isCordova:()=>!!window.TapticEngine,isCapacitor:()=>!!window.Capacitor,impact(p){const L=this.getEngine();if(!L)return;const Q=this.isCapacitor()?p.style.toUpperCase():p.style;L.impact({style:Q})},notification(p){const L=this.getEngine();if(!L)return;const Q=this.isCapacitor()?p.style.toUpperCase():p.style;L.notification({style:Q})},selection(){this.impact({style:"light"})},selectionStart(){const p=this.getEngine();!p||(this.isCapacitor()?p.selectionStart():p.gestureSelectionStart())},selectionChanged(){const p=this.getEngine();!p||(this.isCapacitor()?p.selectionChanged():p.gestureSelectionChanged())},selectionEnd(){const p=this.getEngine();!p||(this.isCapacitor()?p.selectionEnd():p.gestureSelectionEnd())}},c=()=>{d.selection()},V=()=>{d.selectionStart()},a=()=>{d.selectionChanged()},O=()=>{d.selectionEnd()},A=p=>{d.impact(p)}},527:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{MENU_BACK_BUTTON_PRIORITY:()=>O,OVERLAY_BACK_BUTTON_PRIORITY:()=>a,blockHardwareBackButton:()=>c,startHardwareBackButton:()=>V});var d=k(6099);const c=()=>{document.addEventListener("backbutton",()=>{})},V=()=>{const A=document;let p=!1;A.addEventListener("backbutton",()=>{if(p)return;let L=0,Q=[];const Z=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(te,ye){Q.push({priority:te,handler:ye,id:L++})}}});A.dispatchEvent(Z);const z=function(){var te=(0,d.Z)(function*(ye){try{if(ye&&ye.handler){const me=ye.handler(G);null!=me&&(yield me)}}catch(me){console.error(me)}});return function(me){return te.apply(this,arguments)}}(),G=()=>{if(Q.length>0){let te={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};Q.forEach(ye=>{ye.priority>=te.priority&&(te=ye)}),p=!0,Q=Q.filter(ye=>ye.id!==te.id),z(te).then(()=>p=!1)}};G()})},a=100,O=99},6499:(_n,Ke,k)=>{"use strict";k.d(Ke,{a:()=>O,b:()=>A,c:()=>V,d:()=>ye,e:()=>G,f:()=>z,g:()=>p,h:()=>te,i:()=>a,j:()=>Ae,k:()=>Z,l:()=>Q,m:()=>me,n:()=>rt,o:()=>Ze,p:()=>je,q:()=>Ee,r:()=>L,t:()=>d});const d=(Ve,He=0)=>new Promise(Ne=>{c(Ve,He,Ne)}),c=(Ve,He=0,Ne)=>{let xt,Je;const ct={passive:!0},Tt=()=>{xt&&xt()},Ct=gt=>{(void 0===gt||Ve===gt.target)&&(Tt(),Ne(gt))};return Ve&&(Ve.addEventListener("webkitTransitionEnd",Ct,ct),Ve.addEventListener("transitionend",Ct,ct),Je=setTimeout(Ct,He+500),xt=()=>{Je&&(clearTimeout(Je),Je=void 0),Ve.removeEventListener("webkitTransitionEnd",Ct,ct),Ve.removeEventListener("transitionend",Ct,ct)}),Tt},V=(Ve,He)=>{Ve.componentOnReady?Ve.componentOnReady().then(Ne=>He(Ne)):L(()=>He(Ve))},a=(Ve,He=[])=>{const Ne={};return He.forEach(xt=>{Ve.hasAttribute(xt)&&(null!==Ve.getAttribute(xt)&&(Ne[xt]=Ve.getAttribute(xt)),Ve.removeAttribute(xt))}),Ne},O=(Ve,He,Ne,xt)=>{if("undefined"!=typeof window){const Je=window,ct=Je&&Je.Ionic&&Je.Ionic.config;if(ct){const wt=ct.get("_ael");if(wt)return wt(Ve,He,Ne,xt);if(ct._ael)return ct._ael(Ve,He,Ne,xt)}}return Ve.addEventListener(He,Ne,xt)},A=(Ve,He,Ne,xt)=>{if("undefined"!=typeof window){const Je=window,ct=Je&&Je.Ionic&&Je.Ionic.config;if(ct){const wt=ct.get("_rel");if(wt)return wt(Ve,He,Ne,xt);if(ct._rel)return ct._rel(Ve,He,Ne,xt)}}return Ve.removeEventListener(He,Ne,xt)},p=(Ve,He=Ve)=>Ve.shadowRoot||He,L=Ve=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Ve):"function"==typeof requestAnimationFrame?requestAnimationFrame(Ve):setTimeout(Ve),Q=Ve=>!!Ve.shadowRoot&&!!Ve.attachShadow,Z=Ve=>{const He=Ve.closest("ion-item");return He?He.querySelector("ion-label"):null},z=Ve=>{if(Ve.focus(),Ve.classList.contains("ion-focusable")){const He=Ve.closest("ion-app");He&&He.setFocus([Ve])}},G=(Ve,He)=>{let Ne;const xt=Ve.getAttribute("aria-labelledby"),Je=Ve.id;let ct=null!==xt&&""!==xt.trim()?xt:He+"-lbl",wt=null!==xt&&""!==xt.trim()?document.getElementById(xt):Z(Ve);return wt?(null===xt&&(wt.id=ct),Ne=wt.textContent,wt.setAttribute("aria-hidden","true")):""!==Je.trim()&&(wt=document.querySelector(`label[for="${Je}"]`),wt&&(""!==wt.id?ct=wt.id:wt.id=ct=`${Je}-lbl`,Ne=wt.textContent)),{label:wt,labelId:ct,labelText:Ne}},te=(Ve,He,Ne,xt,Je)=>{if(Ve||Q(He)){let ct=He.querySelector("input.aux-input");ct||(ct=He.ownerDocument.createElement("input"),ct.type="hidden",ct.classList.add("aux-input"),He.appendChild(ct)),ct.disabled=Je,ct.name=Ne,ct.value=xt||""}},ye=(Ve,He,Ne)=>Math.max(Ve,Math.min(He,Ne)),me=(Ve,He)=>{if(!Ve){const Ne="ASSERT: "+He;throw console.error(Ne),new Error(Ne)}},Ee=Ve=>Ve.timeStamp||Date.now(),je=Ve=>{if(Ve){const He=Ve.changedTouches;if(He&&He.length>0){const Ne=He[0];return{x:Ne.clientX,y:Ne.clientY}}if(void 0!==Ve.pageX)return{x:Ve.pageX,y:Ve.pageY}}return{x:0,y:0}},rt=Ve=>{const He="rtl"===document.dir;switch(Ve){case"start":return He;case"end":return!He;default:throw new Error(`"${Ve}" is not a valid value for [side]. Use "start" or "end" instead.`)}},Ae=(Ve,He)=>{const Ne=Ve._original||Ve;return{_original:Ve,emit:Ze(Ne.emit.bind(Ne),He)}},Ze=(Ve,He=0)=>{let Ne;return(...xt)=>{clearTimeout(Ne),Ne=setTimeout(Ve,He,...xt)}}},9533:(_n,Ke,k)=>{"use strict";k.d(Ke,{B:()=>Pr,H:()=>mi,a:()=>si,b:()=>ui,c:()=>Sr,e:()=>ji,f:()=>Lr,g:()=>di,h:()=>In,i:()=>vr,j:()=>re,k:()=>Qi,p:()=>Ee,r:()=>Pn,s:()=>ye});var d=k(6099);let V,a,O,A=!1,p=!1,L=!1,Q=!1,Z=!1;const z="undefined"!=typeof window?window:{},G=z.document||{head:{}},te={$flags$:0,$resourcesUrl$:"",jmp:Se=>Se(),raf:Se=>requestAnimationFrame(Se),ael:(Se,Xe,Me,st)=>Se.addEventListener(Xe,Me,st),rel:(Se,Xe,Me,st)=>Se.removeEventListener(Xe,Me,st),ce:(Se,Xe)=>new CustomEvent(Se,Xe)},ye=Se=>{Object.assign(te,Se)},Ee=Se=>Promise.resolve(Se),je=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replace}catch{}return!1})(),rt=(Se,Xe,Me,st)=>{Me&&Me.map(([Rt,zt,rn])=>{const un=Ze(Se,Rt),dn=Ae(Xe,rn),An=Ve(Rt);te.ael(un,zt,dn,An),(Xe.$rmListeners$=Xe.$rmListeners$||[]).push(()=>te.rel(un,zt,dn,An))})},Ae=(Se,Xe)=>Me=>{try{256&Se.$flags$?Se.$lazyInstance$[Xe](Me):(Se.$queuedListeners$=Se.$queuedListeners$||[]).push([Xe,Me])}catch(st){Gi(st)}},Ze=(Se,Xe)=>4&Xe?G:8&Xe?z:16&Xe?G.body:Se,Ve=Se=>0!=(2&Se),ct="s-id",wt="sty-id",gt="http://www.w3.org/1999/xlink",Vn=new WeakMap,Ft=(Se,Xe,Me)=>{let st=Cr.get(Se);je&&Me?(st=st||new CSSStyleSheet,st.replace(Xe)):st=Xe,Cr.set(Se,st)},Wt=(Se,Xe,Me,st)=>{let Rt=Jt(Xe,Me),zt=Cr.get(Rt);if(Se=11===Se.nodeType?Se:G,zt)if("string"==typeof zt){let un,rn=Vn.get(Se=Se.head||Se);rn||Vn.set(Se,rn=new Set),rn.has(Rt)||(Se.host&&(un=Se.querySelector(`[${wt}="${Rt}"]`))?un.innerHTML=zt:(un=G.createElement("style"),un.innerHTML=zt,Se.insertBefore(un,Se.querySelector("link"))),rn&&rn.add(Rt))}else Se.adoptedStyleSheets.includes(zt)||(Se.adoptedStyleSheets=[...Se.adoptedStyleSheets,zt]);return Rt},Jt=(Se,Xe)=>"sc-"+(Xe&&32&Se.$flags$?Se.$tagName$+"-"+Xe:Se.$tagName$),an=Se=>Se.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),si=Se=>xr.push(Se),di=Se=>vi(Se).$modeName$,Bn={},Hn=Se=>"object"==(Se=typeof Se)||"function"===Se,In=(Se,Xe,...Me)=>{let st=null,Rt=null,zt=null,rn=!1,un=!1,dn=[];const An=Bt=>{for(let hn=0;hn<Bt.length;hn++)st=Bt[hn],Array.isArray(st)?An(st):null!=st&&"boolean"!=typeof st&&((rn="function"!=typeof Se&&!Hn(st))&&(st=String(st)),rn&&un?dn[dn.length-1].$text$+=st:dn.push(rn?ti(null,st):st),un=rn)};if(An(Me),Xe){Xe.key&&(Rt=Xe.key),Xe.name&&(zt=Xe.name);{const Bt=Xe.className||Xe.class;Bt&&(Xe.class="object"!=typeof Bt?Bt:Object.keys(Bt).filter(hn=>Bt[hn]).join(" "))}}if("function"==typeof Se)return Se(null===Xe?{}:Xe,dn,_r);const qn=ti(Se,null);return qn.$attrs$=Xe,dn.length>0&&(qn.$children$=dn),qn.$key$=Rt,qn.$name$=zt,qn},ti=(Se,Xe)=>({$flags$:0,$tag$:Se,$text$:Xe,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),mi={},_r={forEach:(Se,Xe)=>Se.map(er).forEach(Xe),map:(Se,Xe)=>Se.map(er).map(Xe).map(Ri)},er=Se=>({vattrs:Se.$attrs$,vchildren:Se.$children$,vkey:Se.$key$,vname:Se.$name$,vtag:Se.$tag$,vtext:Se.$text$}),Ri=Se=>{if("function"==typeof Se.vtag){const Me=Object.assign({},Se.vattrs);return Se.vkey&&(Me.key=Se.vkey),Se.vname&&(Me.name=Se.vname),In(Se.vtag,Me,...Se.vchildren||[])}const Xe=ti(Se.vtag,Se.vtext);return Xe.$attrs$=Se.vattrs,Xe.$children$=Se.vchildren,Xe.$key$=Se.vkey,Xe.$name$=Se.vname,Xe},mr=(Se,Xe,Me,st,Rt,zt)=>{if(Me!==st){let rn=Bi(Se,Xe),un=Xe.toLowerCase();if("class"===Xe){const dn=Se.classList,An=ki(Me),qn=ki(st);dn.remove(...An.filter(Bt=>Bt&&!qn.includes(Bt))),dn.add(...qn.filter(Bt=>Bt&&!An.includes(Bt)))}else if("style"===Xe){for(const dn in Me)(!st||null==st[dn])&&(dn.includes("-")?Se.style.removeProperty(dn):Se.style[dn]="");for(const dn in st)(!Me||st[dn]!==Me[dn])&&(dn.includes("-")?Se.style.setProperty(dn,st[dn]):Se.style[dn]=st[dn])}else if("key"!==Xe)if("ref"===Xe)st&&st(Se);else if(rn||"o"!==Xe[0]||"n"!==Xe[1]){const dn=Hn(st);if((rn||dn&&null!==st)&&!Rt)try{if(Se.tagName.includes("-"))Se[Xe]=st;else{let qn=st??"";"list"===Xe?rn=!1:(null==Me||Se[Xe]!=qn)&&(Se[Xe]=qn)}}catch{}let An=!1;un!==(un=un.replace(/^xlink\:?/,""))&&(Xe=un,An=!0),null==st||!1===st?(!1!==st||""===Se.getAttribute(Xe))&&(An?Se.removeAttributeNS(gt,Xe):Se.removeAttribute(Xe)):(!rn||4&zt||Rt)&&!dn&&(st=!0===st?"":st,An?Se.setAttributeNS(gt,Xe,st):Se.setAttribute(Xe,st))}else Xe="-"===Xe[2]?Xe.slice(3):Bi(z,un)?un.slice(2):un[2]+Xe.slice(3),Me&&te.rel(Se,Xe,Me,!1),st&&te.ael(Se,Xe,st,!1)}},Si=/\s/,ki=Se=>Se?Se.split(Si):[],Qt=(Se,Xe,Me,st)=>{const Rt=11===Xe.$elm$.nodeType&&Xe.$elm$.host?Xe.$elm$.host:Xe.$elm$,zt=Se&&Se.$attrs$||Bn,rn=Xe.$attrs$||Bn;for(st in zt)st in rn||mr(Rt,st,zt[st],void 0,Me,Xe.$flags$);for(st in rn)mr(Rt,st,zt[st],rn[st],Me,Xe.$flags$)},et=(Se,Xe,Me,st)=>{let rn,un,dn,Rt=Xe.$children$[Me],zt=0;if(A||(L=!0,"slot"===Rt.$tag$&&(V&&st.classList.add(V+"-s"),Rt.$flags$|=Rt.$children$?2:1)),null!==Rt.$text$)rn=Rt.$elm$=G.createTextNode(Rt.$text$);else if(1&Rt.$flags$)rn=Rt.$elm$=G.createTextNode("");else{if(Q||(Q="svg"===Rt.$tag$),rn=Rt.$elm$=G.createElementNS(Q?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&Rt.$flags$?"slot-fb":Rt.$tag$),Q&&"foreignObject"===Rt.$tag$&&(Q=!1),Qt(null,Rt,Q),(Se=>null!=Se)(V)&&rn["s-si"]!==V&&rn.classList.add(rn["s-si"]=V),Rt.$children$)for(zt=0;zt<Rt.$children$.length;++zt)un=et(Se,Rt,zt,rn),un&&rn.appendChild(un);"svg"===Rt.$tag$?Q=!1:"foreignObject"===rn.tagName&&(Q=!0)}return rn["s-hn"]=O,3&Rt.$flags$&&(rn["s-sr"]=!0,rn["s-cr"]=a,rn["s-sn"]=Rt.$name$||"",dn=Se&&Se.$children$&&Se.$children$[Me],dn&&dn.$tag$===Rt.$tag$&&Se.$elm$&&de(Se.$elm$,!1)),rn},de=(Se,Xe)=>{te.$flags$|=1;const Me=Se.childNodes;for(let st=Me.length-1;st>=0;st--){const Rt=Me[st];Rt["s-hn"]!==O&&Rt["s-ol"]&&(Ie(Rt).insertBefore(Rt,xe(Rt)),Rt["s-ol"].remove(),Rt["s-ol"]=void 0,L=!0),Xe&&de(Rt,Xe)}te.$flags$&=-2},Pe=(Se,Xe,Me,st,Rt,zt)=>{let un,rn=Se["s-cr"]&&Se["s-cr"].parentNode||Se;for(rn.shadowRoot&&rn.tagName===O&&(rn=rn.shadowRoot);Rt<=zt;++Rt)st[Rt]&&(un=et(null,Me,Rt,Se),un&&(st[Rt].$elm$=un,rn.insertBefore(un,xe(Xe))))},ft=(Se,Xe,Me,st,Rt)=>{for(;Xe<=Me;++Xe)(st=Se[Xe])&&(Rt=st.$elm$,Ei(st),p=!0,Rt["s-ol"]?Rt["s-ol"].remove():de(Rt,!0),Rt.remove())},$t=(Se,Xe)=>Se.$tag$===Xe.$tag$&&("slot"===Se.$tag$?Se.$name$===Xe.$name$:Se.$key$===Xe.$key$),xe=Se=>Se&&Se["s-ol"]||Se,Ie=Se=>(Se["s-ol"]?Se["s-ol"]:Se).parentNode,Ut=(Se,Xe)=>{const Me=Xe.$elm$=Se.$elm$,st=Se.$children$,Rt=Xe.$children$,zt=Xe.$tag$,rn=Xe.$text$;let un;null===rn?(Q="svg"===zt||"foreignObject"!==zt&&Q,"slot"===zt||Qt(Se,Xe,Q),null!==st&&null!==Rt?((Se,Xe,Me,st)=>{let no,rr,Rt=0,zt=0,rn=0,un=0,dn=Xe.length-1,An=Xe[0],qn=Xe[dn],Bt=st.length-1,hn=st[0],qi=st[Bt];for(;Rt<=dn&&zt<=Bt;)if(null==An)An=Xe[++Rt];else if(null==qn)qn=Xe[--dn];else if(null==hn)hn=st[++zt];else if(null==qi)qi=st[--Bt];else if($t(An,hn))Ut(An,hn),An=Xe[++Rt],hn=st[++zt];else if($t(qn,qi))Ut(qn,qi),qn=Xe[--dn],qi=st[--Bt];else if($t(An,qi))("slot"===An.$tag$||"slot"===qi.$tag$)&&de(An.$elm$.parentNode,!1),Ut(An,qi),Se.insertBefore(An.$elm$,qn.$elm$.nextSibling),An=Xe[++Rt],qi=st[--Bt];else if($t(qn,hn))("slot"===An.$tag$||"slot"===qi.$tag$)&&de(qn.$elm$.parentNode,!1),Ut(qn,hn),Se.insertBefore(qn.$elm$,An.$elm$),qn=Xe[--dn],hn=st[++zt];else{for(rn=-1,un=Rt;un<=dn;++un)if(Xe[un]&&null!==Xe[un].$key$&&Xe[un].$key$===hn.$key$){rn=un;break}rn>=0?(rr=Xe[rn],rr.$tag$!==hn.$tag$?no=et(Xe&&Xe[zt],Me,rn,Se):(Ut(rr,hn),Xe[rn]=void 0,no=rr.$elm$),hn=st[++zt]):(no=et(Xe&&Xe[zt],Me,zt,Se),hn=st[++zt]),no&&Ie(An.$elm$).insertBefore(no,xe(An.$elm$))}Rt>dn?Pe(Se,null==st[Bt+1]?null:st[Bt+1].$elm$,Me,st,zt,Bt):zt>Bt&&ft(Xe,Rt,dn)})(Me,st,Xe,Rt):null!==Rt?(null!==Se.$text$&&(Me.textContent=""),Pe(Me,null,Xe,Rt,0,Rt.length-1)):null!==st&&ft(st,0,st.length-1),Q&&"svg"===zt&&(Q=!1)):(un=Me["s-cr"])?un.parentNode.textContent=rn:Se.$text$!==rn&&(Me.data=rn)},nn=Se=>{let Me,st,Rt,zt,rn,un,Xe=Se.childNodes;for(st=0,Rt=Xe.length;st<Rt;st++)if(Me=Xe[st],1===Me.nodeType){if(Me["s-sr"])for(rn=Me["s-sn"],Me.hidden=!1,zt=0;zt<Rt;zt++)if(un=Xe[zt].nodeType,Xe[zt]["s-hn"]!==Me["s-hn"]||""!==rn){if(1===un&&rn===Xe[zt].getAttribute("slot")){Me.hidden=!0;break}}else if(1===un||3===un&&""!==Xe[zt].textContent.trim()){Me.hidden=!0;break}nn(Me)}},ni=[],cr=Se=>{let Xe,Me,st,Rt,zt,rn,un=0,dn=Se.childNodes,An=dn.length;for(;un<An;un++){if(Xe=dn[un],Xe["s-sr"]&&(Me=Xe["s-cr"])&&Me.parentNode)for(st=Me.parentNode.childNodes,Rt=Xe["s-sn"],rn=st.length-1;rn>=0;rn--)Me=st[rn],!Me["s-cn"]&&!Me["s-nr"]&&Me["s-hn"]!==Xe["s-hn"]&&(Li(Me,Rt)?(zt=ni.find(qn=>qn.$nodeToRelocate$===Me),p=!0,Me["s-sn"]=Me["s-sn"]||Rt,zt?zt.$slotRefNode$=Xe:ni.push({$slotRefNode$:Xe,$nodeToRelocate$:Me}),Me["s-sr"]&&ni.map(qn=>{Li(qn.$nodeToRelocate$,Me["s-sn"])&&(zt=ni.find(Bt=>Bt.$nodeToRelocate$===Me),zt&&!qn.$slotRefNode$&&(qn.$slotRefNode$=zt.$slotRefNode$))})):ni.some(qn=>qn.$nodeToRelocate$===Me)||ni.push({$nodeToRelocate$:Me}));1===Xe.nodeType&&cr(Xe)}},Li=(Se,Xe)=>1===Se.nodeType?null===Se.getAttribute("slot")&&""===Xe||Se.getAttribute("slot")===Xe:Se["s-sn"]===Xe||""===Xe,Ei=Se=>{Se.$attrs$&&Se.$attrs$.ref&&Se.$attrs$.ref(null),Se.$children$&&Se.$children$.map(Ei)},vr=Se=>vi(Se).$hostElement$,ji=(Se,Xe,Me)=>{const st=vr(Se);return{emit:Rt=>Ir(st,Xe,{bubbles:!!(4&Me),composed:!!(2&Me),cancelable:!!(1&Me),detail:Rt})}},Ir=(Se,Xe,Me)=>{const st=te.ce(Xe,Me);return Se.dispatchEvent(st),st},$i=(Se,Xe)=>{Xe&&!Se.$onRenderResolve$&&Xe["s-p"]&&Xe["s-p"].push(new Promise(Me=>Se.$onRenderResolve$=Me))},Gr=(Se,Xe)=>{if(Se.$flags$|=16,!(4&Se.$flags$))return $i(Se,Se.$ancestorComponent$),Sr(()=>eo(Se,Xe));Se.$flags$|=512},eo=(Se,Xe)=>{const st=Se.$lazyInstance$;let Rt;return Xe&&(Se.$flags$|=256,Se.$queuedListeners$&&(Se.$queuedListeners$.map(([zt,rn])=>F(st,zt,rn)),Se.$queuedListeners$=null),Rt=F(st,"componentWillLoad")),Rt=fe(Rt,()=>F(st,"componentWillRender")),fe(Rt,()=>zr(Se,st,Xe))},zr=function(){var Se=(0,d.Z)(function*(Xe,Me,st){const Rt=Xe.$hostElement$,rn=Rt["s-rc"];st&&(Se=>{const Xe=Se.$cmpMeta$,Me=Se.$hostElement$,st=Xe.$flags$,zt=Wt(Me.shadowRoot?Me.shadowRoot:Me.getRootNode(),Xe,Se.$modeName$);10&st&&(Me["s-sc"]=zt,Me.classList.add(zt+"-h"),2&st&&Me.classList.add(zt+"-s"))})(Xe);Xi(Xe,Me),rn&&(rn.map(dn=>dn()),Rt["s-rc"]=void 0);{const dn=Rt["s-p"],An=()=>ur(Xe);0===dn.length?An():(Promise.all(dn).then(An),Xe.$flags$|=4,dn.length=0)}});return function(Me,st,Rt){return Se.apply(this,arguments)}}(),Xi=(Se,Xe,Me)=>{try{Xe=Xe.render&&Xe.render(),Se.$flags$&=-17,Se.$flags$|=2,((Se,Xe)=>{const Me=Se.$hostElement$,st=Se.$cmpMeta$,Rt=Se.$vnode$||ti(null,null),zt=(Se=>Se&&Se.$tag$===mi)(Xe)?Xe:In(null,null,Xe);if(O=Me.tagName,st.$attrsToReflect$&&(zt.$attrs$=zt.$attrs$||{},st.$attrsToReflect$.map(([rn,un])=>zt.$attrs$[un]=Me[rn])),zt.$tag$=null,zt.$flags$|=4,Se.$vnode$=zt,zt.$elm$=Rt.$elm$=Me.shadowRoot||Me,V=Me["s-sc"],a=Me["s-cr"],A=0!=(1&st.$flags$),p=!1,Ut(Rt,zt),te.$flags$|=1,L){cr(zt.$elm$);let rn,un,dn,An,qn,Bt,hn=0;for(;hn<ni.length;hn++)rn=ni[hn],un=rn.$nodeToRelocate$,un["s-ol"]||(dn=G.createTextNode(""),dn["s-nr"]=un,un.parentNode.insertBefore(un["s-ol"]=dn,un));for(hn=0;hn<ni.length;hn++)if(rn=ni[hn],un=rn.$nodeToRelocate$,rn.$slotRefNode$){for(An=rn.$slotRefNode$.parentNode,qn=rn.$slotRefNode$.nextSibling,dn=un["s-ol"];dn=dn.previousSibling;)if(Bt=dn["s-nr"],Bt&&Bt["s-sn"]===un["s-sn"]&&An===Bt.parentNode&&(Bt=Bt.nextSibling,!Bt||!Bt["s-nr"])){qn=Bt;break}(!qn&&An!==un.parentNode||un.nextSibling!==qn)&&un!==qn&&(!un["s-hn"]&&un["s-ol"]&&(un["s-hn"]=un["s-ol"].parentNode.nodeName),An.insertBefore(un,qn))}else 1===un.nodeType&&(un.hidden=!0)}p&&nn(zt.$elm$),te.$flags$&=-2,ni.length=0})(Se,Xe)}catch(st){Gi(st,Se.$hostElement$)}return null},ur=Se=>{const Me=Se.$hostElement$,Rt=Se.$lazyInstance$,zt=Se.$ancestorComponent$;64&Se.$flags$?F(Rt,"componentDidUpdate"):(Se.$flags$|=64,_e(Me),F(Rt,"componentDidLoad"),Se.$onReadyResolve$(Me),zt||K()),Se.$onInstanceResolve$(Me),Se.$onRenderResolve$&&(Se.$onRenderResolve$(),Se.$onRenderResolve$=void 0),512&Se.$flags$&&uo(()=>Gr(Se,!1)),Se.$flags$&=-517},re=Se=>{{const Xe=vi(Se),Me=Xe.$hostElement$.isConnected;return Me&&2==(18&Xe.$flags$)&&Gr(Xe,!1),Me}},K=Se=>{_e(G.documentElement),uo(()=>Ir(z,"appload",{detail:{namespace:"ionic"}}))},F=(Se,Xe,Me)=>{if(Se&&Se[Xe])try{return Se[Xe](Me)}catch(st){Gi(st)}},fe=(Se,Xe)=>Se&&Se.then?Se.then(Xe):Xe(),_e=Se=>Se.classList.add("hydrated"),vt=(Se,Xe,Me,st,Rt,zt,rn)=>{let un,dn,An,qn;if(1===zt.nodeType){for(un=zt.getAttribute("c-id"),un&&(dn=un.split("."),(dn[0]===rn||"0"===dn[0])&&(An={$flags$:0,$hostId$:dn[0],$nodeId$:dn[1],$depth$:dn[2],$index$:dn[3],$tag$:zt.tagName.toLowerCase(),$elm$:zt,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},Xe.push(An),zt.removeAttribute("c-id"),Se.$children$||(Se.$children$=[]),Se.$children$[An.$index$]=An,Se=An,st&&"0"===An.$depth$&&(st[An.$index$]=An.$elm$))),qn=zt.childNodes.length-1;qn>=0;qn--)vt(Se,Xe,Me,st,Rt,zt.childNodes[qn],rn);if(zt.shadowRoot)for(qn=zt.shadowRoot.childNodes.length-1;qn>=0;qn--)vt(Se,Xe,Me,st,Rt,zt.shadowRoot.childNodes[qn],rn)}else if(8===zt.nodeType)dn=zt.nodeValue.split("."),(dn[1]===rn||"0"===dn[1])&&(un=dn[0],An={$flags$:0,$hostId$:dn[1],$nodeId$:dn[2],$depth$:dn[3],$index$:dn[4],$elm$:zt,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===un?(An.$elm$=zt.nextSibling,An.$elm$&&3===An.$elm$.nodeType&&(An.$text$=An.$elm$.textContent,Xe.push(An),zt.remove(),Se.$children$||(Se.$children$=[]),Se.$children$[An.$index$]=An,st&&"0"===An.$depth$&&(st[An.$index$]=An.$elm$))):An.$hostId$===rn&&("s"===un?(An.$tag$="slot",zt["s-sn"]=dn[5]?An.$name$=dn[5]:"",zt["s-sr"]=!0,st&&(An.$elm$=G.createElement(An.$tag$),An.$name$&&An.$elm$.setAttribute("name",An.$name$),zt.parentNode.insertBefore(An.$elm$,zt),zt.remove(),"0"===An.$depth$&&(st[An.$index$]=An.$elm$)),Me.push(An),Se.$children$||(Se.$children$=[]),Se.$children$[An.$index$]=An):"r"===un&&(st?zt.remove():(Rt["s-cr"]=zt,zt["s-cn"]=!0))));else if(Se&&"style"===Se.$tag$){const Bt=ti(null,zt.textContent);Bt.$elm$=zt,Bt.$index$="0",Se.$children$=[Bt]}},kt=(Se,Xe)=>{if(1===Se.nodeType){let Me=0;for(;Me<Se.childNodes.length;Me++)kt(Se.childNodes[Me],Xe);if(Se.shadowRoot)for(Me=0;Me<Se.shadowRoot.childNodes.length;Me++)kt(Se.shadowRoot.childNodes[Me],Xe)}else if(8===Se.nodeType){const Me=Se.nodeValue.split(".");"o"===Me[0]&&(Xe.set(Me[1]+"."+Me[2],Se),Se.nodeValue="",Se["s-en"]=Me[3])}},sn=(Se,Xe,Me)=>{if(Xe.$members$){Se.watchers&&(Xe.$watchers$=Se.watchers);const st=Object.entries(Xe.$members$),Rt=Se.prototype;if(st.map(([zt,[rn]])=>{31&rn||2&Me&&32&rn?Object.defineProperty(Rt,zt,{get(){return((Se,Xe)=>vi(this).$instanceValues$.get(Xe))(0,zt)},set(un){((Se,Xe,Me,st)=>{const Rt=vi(Se),zt=Rt.$hostElement$,rn=Rt.$instanceValues$.get(Xe),un=Rt.$flags$,dn=Rt.$lazyInstance$;if(Me=((Se,Xe)=>null==Se||Hn(Se)?Se:4&Xe?"false"!==Se&&(""===Se||!!Se):2&Xe?parseFloat(Se):1&Xe?String(Se):Se)(Me,st.$members$[Xe][0]),(!(8&un)||void 0===rn)&&Me!==rn&&(Rt.$instanceValues$.set(Xe,Me),dn)){if(st.$watchers$&&128&un){const An=st.$watchers$[Xe];An&&An.map(qn=>{try{dn[qn](Me,rn,Xe)}catch(Bt){Gi(Bt,zt)}})}2==(18&un)&&Gr(Rt,!1)}})(this,zt,un,Xe)},configurable:!0,enumerable:!0}):1&Me&&64&rn&&Object.defineProperty(Rt,zt,{value(...un){const dn=vi(this);return dn.$onInstancePromise$.then(()=>dn.$lazyInstance$[zt](...un))}})}),1&Me){const zt=new Map;Rt.attributeChangedCallback=function(rn,un,dn){te.jmp(()=>{const An=zt.get(rn);if(this.hasOwnProperty(An))dn=this[An],delete this[An];else if(Rt.hasOwnProperty(An)&&"number"==typeof this[An]&&this[An]==dn)return;this[An]=(null!==dn||"boolean"!=typeof this[An])&&dn})},Se.observedAttributes=st.filter(([rn,un])=>15&un[0]).map(([rn,un])=>{const dn=un[1]||rn;return zt.set(dn,rn),512&un[0]&&Xe.$attrsToReflect$.push([rn,dn]),dn})}}return Se},gn=function(){var Se=(0,d.Z)(function*(Xe,Me,st,Rt,zt){if(0==(32&Me.$flags$)){{if(Me.$flags$|=32,(zt=hi(st)).then){const An=()=>{};zt=yield zt,An()}zt.isProxied||(st.$watchers$=zt.watchers,sn(zt,st,2),zt.isProxied=!0);const dn=()=>{};Me.$flags$|=8;try{new zt(Me)}catch(An){Gi(An)}Me.$flags$&=-9,Me.$flags$|=128,dn(),Nn(Me.$lazyInstance$)}if(zt.style){let dn=zt.style;"string"!=typeof dn&&(dn=dn[Me.$modeName$=(Se=>xr.map(Xe=>Xe(Se)).find(Xe=>!!Xe))(Xe)]);const An=Jt(st,Me.$modeName$);if(!Cr.has(An)){const qn=()=>{};Ft(An,dn,!!(1&st.$flags$)),qn()}}}const rn=Me.$ancestorComponent$,un=()=>Gr(Me,!0);rn&&rn["s-rc"]?rn["s-rc"].push(un):un()});return function(Me,st,Rt,zt,rn){return Se.apply(this,arguments)}}(),Nn=Se=>{F(Se,"connectedCallback")},ai=Se=>{const Xe=Se["s-cr"]=G.createComment("");Xe["s-cn"]=!0,Se.insertBefore(Xe,Se.firstChild)},ui=(Se,Xe={})=>{const st=[],Rt=Xe.exclude||[],zt=z.customElements,rn=G.head,un=rn.querySelector("meta[charset]"),dn=G.createElement("style"),An=[],qn=G.querySelectorAll(`[${wt}]`);let Bt,hn=!0,qi=0;for(Object.assign(te,Xe),te.$resourcesUrl$=new URL(Xe.resourcesUrl||"./",G.baseURI).href,te.$flags$|=2;qi<qn.length;qi++)Ft(qn[qi].getAttribute(wt),an(qn[qi].innerHTML),!0);Se.map(no=>{no[1].map(rr=>{const Br={$flags$:rr[0],$tagName$:rr[1],$members$:rr[2],$listeners$:rr[3]};Br.$members$=rr[2],Br.$listeners$=rr[3],Br.$attrsToReflect$=[],Br.$watchers$={};const pr=Br.$tagName$,Lo=class extends HTMLElement{constructor(mo){super(mo),Ai(mo=this,Br),1&Br.$flags$&&mo.attachShadow({mode:"open",delegatesFocus:!!(16&Br.$flags$)})}connectedCallback(){Bt&&(clearTimeout(Bt),Bt=null),hn?An.push(this):te.jmp(()=>(Se=>{if(0==(1&te.$flags$)){const Xe=vi(Se),Me=Xe.$cmpMeta$,st=()=>{};if(1&Xe.$flags$)rt(Se,Xe,Me.$listeners$),Nn(Xe.$lazyInstance$);else{let Rt;if(Xe.$flags$|=1,Rt=Se.getAttribute(ct),Rt){if(1&Me.$flags$){const zt=Wt(Se.shadowRoot,Me,Se.getAttribute("s-mode"));Se.classList.remove(zt+"-h",zt+"-s")}((Se,Xe,Me,st)=>{const zt=Se.shadowRoot,rn=[],dn=zt?[]:null,An=st.$vnode$=ti(Xe,null);te.$orgLocNodes$||kt(G.body,te.$orgLocNodes$=new Map),Se[ct]=Me,Se.removeAttribute(ct),vt(An,rn,[],dn,Se,Se,Me),rn.map(qn=>{const Bt=qn.$hostId$+"."+qn.$nodeId$,hn=te.$orgLocNodes$.get(Bt),qi=qn.$elm$;hn&&""===hn["s-en"]&&hn.parentNode.insertBefore(qi,hn.nextSibling),zt||(qi["s-hn"]=Xe,hn&&(qi["s-ol"]=hn,qi["s-ol"]["s-nr"]=qi)),te.$orgLocNodes$.delete(Bt)}),zt&&dn.map(qn=>{qn&&zt.appendChild(qn)})})(Se,Me.$tagName$,Rt,Xe)}Rt||12&Me.$flags$&&ai(Se);{let zt=Se;for(;zt=zt.parentNode||zt.host;)if(1===zt.nodeType&&zt.hasAttribute("s-id")&&zt["s-p"]||zt["s-p"]){$i(Xe,Xe.$ancestorComponent$=zt);break}}Me.$members$&&Object.entries(Me.$members$).map(([zt,[rn]])=>{if(31&rn&&Se.hasOwnProperty(zt)){const un=Se[zt];delete Se[zt],Se[zt]=un}}),uo(()=>gn(Se,Xe,Me))}st()}})(this))}disconnectedCallback(){te.jmp(()=>(Se=>{if(0==(1&te.$flags$)){const Xe=vi(this),Me=Xe.$lazyInstance$;Xe.$rmListeners$&&(Xe.$rmListeners$.map(st=>st()),Xe.$rmListeners$=void 0),F(Me,"disconnectedCallback")}})())}componentOnReady(){return vi(this).$onReadyPromise$}};Br.$lazyBundleId$=no[0],!Rt.includes(pr)&&!zt.get(pr)&&(st.push(pr),zt.define(pr,sn(Lo,Br,1)))})}),dn.innerHTML=st+"{visibility:hidden}.hydrated{visibility:inherit}",dn.setAttribute("data-styles",""),rn.insertBefore(dn,un?un.nextSibling:rn.firstChild),hn=!1,An.length?An.map(no=>no.connectedCallback()):te.jmp(()=>Bt=setTimeout(K,30))},Qi=Se=>{const Xe=new URL(Se,te.$resourcesUrl$);return Xe.origin!==z.location.origin?Xe.href:Xe.pathname},Hi=new WeakMap,vi=Se=>Hi.get(Se),Pn=(Se,Xe)=>Hi.set(Xe.$lazyInstance$=Se,Xe),Ai=(Se,Xe)=>{const Me={$flags$:0,$hostElement$:Se,$cmpMeta$:Xe,$instanceValues$:new Map};return Me.$onInstancePromise$=new Promise(st=>Me.$onInstanceResolve$=st),Me.$onReadyPromise$=new Promise(st=>Me.$onReadyResolve$=st),Se["s-p"]=[],Se["s-rc"]=[],rt(Se,Me,Xe.$listeners$),Hi.set(Se,Me)},Bi=(Se,Xe)=>Xe in Se,Gi=(Se,Xe)=>(0,console.error)(Se,Xe),Ar=new Map,hi=(Se,Xe,Me)=>{const st=Se.$tagName$.replace(/-/g,"_"),Rt=Se.$lazyBundleId$,zt=Ar.get(Rt);return zt?zt[st]:k(863)(`./${Rt}.entry.js`).then(rn=>(Ar.set(Rt,rn),rn[st]),Gi)},Cr=new Map,xr=[],qr=[],Ao=[],Oi=(Se,Xe)=>Me=>{Se.push(Me),Z||(Z=!0,Xe&&4&te.$flags$?uo(to):te.raf(to))},yo=Se=>{for(let Xe=0;Xe<Se.length;Xe++)try{Se[Xe](performance.now())}catch(Me){Gi(Me)}Se.length=0},to=()=>{yo(qr),yo(Ao),(Z=qr.length>0)&&te.raf(to)},uo=Se=>Ee().then(Se),Lr=Oi(qr,!1),Sr=Oi(Ao,!0),Pr={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1}},1363:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{GESTURE_CONTROLLER:()=>d.G,createGesture:()=>Q});var d=k(2733);const c=(te,ye,me,Ee)=>{const je=V(te)?{capture:!!Ee.capture,passive:!!Ee.passive}:!!Ee.capture;let rt,Ae;return te.__zone_symbol__addEventListener?(rt="__zone_symbol__addEventListener",Ae="__zone_symbol__removeEventListener"):(rt="addEventListener",Ae="removeEventListener"),te[rt](ye,me,je),()=>{te[Ae](ye,me,je)}},V=te=>{if(void 0===a)try{const ye=Object.defineProperty({},"passive",{get:()=>{a=!0}});te.addEventListener("optsTest",()=>{},ye)}catch{a=!1}return!!a};let a;const p=te=>te instanceof Document?te:te.ownerDocument,Q=te=>{let ye=!1,me=!1,Ee=!0,je=!1;const rt=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},te),Ae=rt.canStart,Ze=rt.onWillStart,Ve=rt.onStart,He=rt.onEnd,Ne=rt.notCaptured,xt=rt.onMove,Je=rt.threshold,ct=rt.passive,wt=rt.blurOnStart,Tt={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},Ct=((te,ye,me)=>{const Ee=me*(Math.PI/180),je="x"===te,rt=Math.cos(Ee),Ae=ye*ye;let Ze=0,Ve=0,He=!1,Ne=0;return{start(xt,Je){Ze=xt,Ve=Je,Ne=0,He=!0},detect(xt,Je){if(!He)return!1;const ct=xt-Ze,wt=Je-Ve,Tt=ct*ct+wt*wt;if(Tt<Ae)return!1;const Ct=Math.sqrt(Tt),gt=(je?ct:wt)/Ct;return Ne=gt>rt?1:gt<-rt?-1:0,He=!1,!0},isGesture:()=>0!==Ne,getDirection:()=>Ne}})(rt.direction,rt.threshold,rt.maxAngle),gt=d.G.createGesture({name:te.gestureName,priority:te.gesturePriority,disableScroll:te.disableScroll}),Vn=()=>{!ye||(je=!1,xt&&xt(Tt))},Ft=()=>!(gt&&!gt.capture()||(ye=!0,Ee=!1,Tt.startX=Tt.currentX,Tt.startY=Tt.currentY,Tt.startTime=Tt.currentTime,Ze?Ze(Tt).then(Gt):Gt(),0)),Gt=()=>{wt&&(()=>{if("undefined"!=typeof document){const di=document.activeElement;null!==di&&di.blur&&di.blur()}})(),Ve&&Ve(Tt),Ee=!0},Jt=()=>{ye=!1,me=!1,je=!1,Ee=!0,gt.release()},an=di=>{const Bn=ye,ln=Ee;if(Jt(),ln){if(Z(Tt,di),Bn)return void(He&&He(Tt));Ne&&Ne(Tt)}},Jn=((te,ye,me,Ee,je)=>{let rt,Ae,Ze,Ve,He,Ne,xt,Je=0;const ct=Wt=>{Je=Date.now()+2e3,ye(Wt)&&(!Ae&&me&&(Ae=c(te,"touchmove",me,je)),Ze||(Ze=c(Wt.target,"touchend",Tt,je)),Ve||(Ve=c(Wt.target,"touchcancel",Tt,je)))},wt=Wt=>{Je>Date.now()||!ye(Wt)||(!Ne&&me&&(Ne=c(p(te),"mousemove",me,je)),xt||(xt=c(p(te),"mouseup",Ct,je)))},Tt=Wt=>{gt(),Ee&&Ee(Wt)},Ct=Wt=>{Lt(),Ee&&Ee(Wt)},gt=()=>{Ae&&Ae(),Ze&&Ze(),Ve&&Ve(),Ae=Ze=Ve=void 0},Lt=()=>{Ne&&Ne(),xt&&xt(),Ne=xt=void 0},Ht=()=>{gt(),Lt()},Vn=(Wt=!0)=>{Wt?(rt||(rt=c(te,"touchstart",ct,je)),He||(He=c(te,"mousedown",wt,je))):(rt&&rt(),He&&He(),rt=He=void 0,Ht())};return{enable:Vn,stop:Ht,destroy:()=>{Vn(!1),Ee=me=ye=void 0}}})(rt.el,di=>{const Bn=G(di);return!(me||!Ee||(z(di,Tt),Tt.startX=Tt.currentX,Tt.startY=Tt.currentY,Tt.startTime=Tt.currentTime=Bn,Tt.velocityX=Tt.velocityY=Tt.deltaX=Tt.deltaY=0,Tt.event=di,Ae&&!1===Ae(Tt))||(gt.release(),!gt.start()))&&(me=!0,0===Je?Ft():(Ct.start(Tt.startX,Tt.startY),!0))},di=>{ye?!je&&Ee&&(je=!0,Z(Tt,di),requestAnimationFrame(Vn)):(Z(Tt,di),Ct.detect(Tt.currentX,Tt.currentY)&&(!Ct.isGesture()||!Ft())&&si())},an,{capture:!1,passive:ct}),si=()=>{Jt(),Jn.stop(),Ne&&Ne(Tt)};return{enable(di=!0){di||(ye&&an(void 0),Jt()),Jn.enable(di)},destroy(){gt.destroy(),Jn.destroy()}}},Z=(te,ye)=>{if(!ye)return;const me=te.currentX,Ee=te.currentY,je=te.currentTime;z(ye,te);const rt=te.currentX,Ae=te.currentY,Ve=(te.currentTime=G(ye))-je;if(Ve>0&&Ve<100){const Ne=(Ae-Ee)/Ve;te.velocityX=(rt-me)/Ve*.7+.3*te.velocityX,te.velocityY=.7*Ne+.3*te.velocityY}te.deltaX=rt-te.startX,te.deltaY=Ae-te.startY,te.event=ye},z=(te,ye)=>{let me=0,Ee=0;if(te){const je=te.changedTouches;if(je&&je.length>0){const rt=je[0];me=rt.clientX,Ee=rt.clientY}else void 0!==te.pageX&&(me=te.pageX,Ee=te.pageY)}ye.currentX=me,ye.currentY=Ee},G=te=>te.timeStamp||Date.now()},7313:(_n,Ke,k)=>{"use strict";k.d(Ke,{m:()=>z});var d=k(6099),c=k(527),V=k(6499),a=k(7639),O=k(5508);const A=G=>(0,O.c)().duration(G?400:300),p=G=>{let te,ye;const me=G.width+8,Ee=(0,O.c)(),je=(0,O.c)();G.isEndSide?(te=me+"px",ye="0px"):(te=-me+"px",ye="0px"),Ee.addElement(G.menuInnerEl).fromTo("transform",`translateX(${te})`,`translateX(${ye})`);const Ae="ios"===(0,a.b)(G),Ze=Ae?.2:.25;return je.addElement(G.backdropEl).fromTo("opacity",.01,Ze),A(Ae).addAnimation([Ee,je])},L=G=>{let te,ye;const me=(0,a.b)(G),Ee=G.width;G.isEndSide?(te=-Ee+"px",ye=Ee+"px"):(te=Ee+"px",ye=-Ee+"px");const je=(0,O.c)().addElement(G.menuInnerEl).fromTo("transform",`translateX(${ye})`,"translateX(0px)"),rt=(0,O.c)().addElement(G.contentEl).fromTo("transform","translateX(0px)",`translateX(${te})`),Ae=(0,O.c)().addElement(G.backdropEl).fromTo("opacity",.01,.32);return A("ios"===me).addAnimation([je,rt,Ae])},Q=G=>{const te=(0,a.b)(G),ye=G.width*(G.isEndSide?-1:1)+"px",me=(0,O.c)().addElement(G.contentEl).fromTo("transform","translateX(0px)",`translateX(${ye})`);return A("ios"===te).addAnimation(me)},z=(()=>{const G=new Map,te=[],ye=function(){var Gt=(0,d.Z)(function*(Jt){const an=yield Ve(Jt);return!!an&&an.open()});return function(an){return Gt.apply(this,arguments)}}(),me=function(){var Gt=(0,d.Z)(function*(Jt){const an=yield void 0!==Jt?Ve(Jt):He();return void 0!==an&&an.close()});return function(an){return Gt.apply(this,arguments)}}(),Ee=function(){var Gt=(0,d.Z)(function*(Jt){const an=yield Ve(Jt);return!!an&&an.toggle()});return function(an){return Gt.apply(this,arguments)}}(),je=function(){var Gt=(0,d.Z)(function*(Jt,an){const Jn=yield Ve(an);return Jn&&(Jn.disabled=!Jt),Jn});return function(an,Jn){return Gt.apply(this,arguments)}}(),rt=function(){var Gt=(0,d.Z)(function*(Jt,an){const Jn=yield Ve(an);return Jn&&(Jn.swipeGesture=Jt),Jn});return function(an,Jn){return Gt.apply(this,arguments)}}(),Ae=function(){var Gt=(0,d.Z)(function*(Jt){if(null!=Jt){const an=yield Ve(Jt);return void 0!==an&&an.isOpen()}return void 0!==(yield He())});return function(an){return Gt.apply(this,arguments)}}(),Ze=function(){var Gt=(0,d.Z)(function*(Jt){const an=yield Ve(Jt);return!!an&&!an.disabled});return function(an){return Gt.apply(this,arguments)}}(),Ve=function(){var Gt=(0,d.Z)(function*(Jt){return yield Wt(),"start"===Jt||"end"===Jt?Ft(si=>si.side===Jt&&!si.disabled)||Ft(si=>si.side===Jt):null!=Jt?Ft(Jn=>Jn.menuId===Jt):Ft(Jn=>!Jn.disabled)||(te.length>0?te[0].el:void 0)});return function(an){return Gt.apply(this,arguments)}}(),He=function(){var Gt=(0,d.Z)(function*(){return yield Wt(),Lt()});return function(){return Gt.apply(this,arguments)}}(),Ne=function(){var Gt=(0,d.Z)(function*(){return yield Wt(),Ht()});return function(){return Gt.apply(this,arguments)}}(),xt=function(){var Gt=(0,d.Z)(function*(){return yield Wt(),Vn()});return function(){return Gt.apply(this,arguments)}}(),Je=(Gt,Jt)=>{G.set(Gt,Jt)},Tt=Gt=>{const Jt=Gt.side;te.filter(an=>an.side===Jt&&an!==Gt).forEach(an=>an.disabled=!0)},Ct=function(){var Gt=(0,d.Z)(function*(Jt,an,Jn){if(Vn())return!1;if(an){const si=yield He();si&&Jt.el!==si&&(yield si.setOpen(!1,!1))}return Jt._setOpen(an,Jn)});return function(an,Jn,si){return Gt.apply(this,arguments)}}(),Lt=()=>Ft(Gt=>Gt._isOpen),Ht=()=>te.map(Gt=>Gt.el),Vn=()=>te.some(Gt=>Gt.isAnimating),Ft=Gt=>{const Jt=te.find(Gt);if(void 0!==Jt)return Jt.el},Wt=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(Gt=>new Promise(Jt=>(0,V.c)(Gt,Jt))));return Je("reveal",Q),Je("push",L),Je("overlay",p),"undefined"!=typeof document&&document.addEventListener("ionBackButton",Gt=>{const Jt=Lt();Jt&&Gt.detail.register(c.MENU_BACK_BUTTON_PRIORITY,()=>Jt.close())}),{registerAnimation:Je,get:Ve,getMenus:Ne,getOpen:He,isEnabled:Ze,swipeGesture:rt,isAnimating:xt,isOpen:Ae,enable:je,toggle:Ee,close:me,open:ye,_getOpenSync:Lt,_createAnimation:(Gt,Jt)=>{const an=G.get(Gt);if(!an)throw new Error("animation not registered");return an(Jt)},_register:Gt=>{te.indexOf(Gt)<0&&(Gt.disabled||Tt(Gt),te.push(Gt))},_unregister:Gt=>{const Jt=te.indexOf(Gt);Jt>-1&&te.splice(Jt,1)},_setOpen:Ct,_setActiveMenu:Tt}})()},6665:(_n,Ke,k)=>{"use strict";k.d(Ke,{s:()=>d});const d=L=>{try{if(L instanceof class p{constructor(Q){this.value=Q}})return L.value;if(!a()||"string"!=typeof L||""===L)return L;const Q=document.createDocumentFragment(),Z=document.createElement("div");Q.appendChild(Z),Z.innerHTML=L,A.forEach(ye=>{const me=Q.querySelectorAll(ye);for(let Ee=me.length-1;Ee>=0;Ee--){const je=me[Ee];je.parentNode?je.parentNode.removeChild(je):Q.removeChild(je);const rt=V(je);for(let Ae=0;Ae<rt.length;Ae++)c(rt[Ae])}});const z=V(Q);for(let ye=0;ye<z.length;ye++)c(z[ye]);const G=document.createElement("div");G.appendChild(Q);const te=G.querySelector("div");return null!==te?te.innerHTML:G.innerHTML}catch(Q){return console.error(Q),""}},c=L=>{if(L.nodeType&&1!==L.nodeType)return;for(let Z=L.attributes.length-1;Z>=0;Z--){const z=L.attributes.item(Z),G=z.name;if(!O.includes(G.toLowerCase())){L.removeAttribute(G);continue}const te=z.value;null!=te&&te.toLowerCase().includes("javascript:")&&L.removeAttribute(G)}const Q=V(L);for(let Z=0;Z<Q.length;Z++)c(Q[Z])},V=L=>null!=L.children?L.children:L.childNodes,a=()=>{const L=window,Q=L&&L.Ionic&&L.Ionic.config;return!Q||(Q.get?Q.get("sanitizerEnabled",!0):!0===Q.sanitizerEnabled||void 0===Q.sanitizerEnabled)},O=["class","id","href","src","name","slot"],A=["script","style","iframe","meta","link","object","embed"]},2098:(_n,Ke,k)=>{"use strict";k.d(Ke,{L:()=>a,a:()=>O,b:()=>A,c:()=>p,d:()=>L,e:()=>Je,g:()=>Tt,l:()=>Ne,s:()=>ct,t:()=>z});var d=k(6099),c=k(9533),V=k(6499);const a="ionViewWillEnter",O="ionViewDidEnter",A="ionViewWillLeave",p="ionViewDidLeave",L="ionViewWillUnload",z=Ct=>new Promise((gt,Lt)=>{(0,c.c)(()=>{G(Ct),te(Ct).then(Ht=>{Ht.animation&&Ht.animation.destroy(),ye(Ct),gt(Ht)},Ht=>{ye(Ct),Lt(Ht)})})}),G=Ct=>{const gt=Ct.enteringEl,Lt=Ct.leavingEl;wt(gt,Lt,Ct.direction),Ct.showGoBack?gt.classList.add("can-go-back"):gt.classList.remove("can-go-back"),ct(gt,!1),gt.style.setProperty("pointer-events","none"),Lt&&(ct(Lt,!1),Lt.style.setProperty("pointer-events","none"))},te=function(){var Ct=(0,d.Z)(function*(gt){const Lt=yield me(gt);return Lt&&c.B.isBrowser?Ee(Lt,gt):je(gt)});return function(Lt){return Ct.apply(this,arguments)}}(),ye=Ct=>{const gt=Ct.enteringEl,Lt=Ct.leavingEl;gt.classList.remove("ion-page-invisible"),gt.style.removeProperty("pointer-events"),void 0!==Lt&&(Lt.classList.remove("ion-page-invisible"),Lt.style.removeProperty("pointer-events"))},me=function(){var Ct=(0,d.Z)(function*(gt){return gt.leavingEl&&gt.animated&&0!==gt.duration?gt.animationBuilder?gt.animationBuilder:"ios"===gt.mode?(yield Promise.resolve().then(k.bind(k,939))).iosTransitionAnimation:(yield Promise.resolve().then(k.bind(k,773))).mdTransitionAnimation:void 0});return function(Lt){return Ct.apply(this,arguments)}}(),Ee=function(){var Ct=(0,d.Z)(function*(gt,Lt){yield rt(Lt,!0);const Ht=gt(Lt.baseEl,Lt);Ve(Lt.enteringEl,Lt.leavingEl);const Vn=yield Ze(Ht,Lt);return Lt.progressCallback&&Lt.progressCallback(void 0),Vn&&He(Lt.enteringEl,Lt.leavingEl),{hasCompleted:Vn,animation:Ht}});return function(Lt,Ht){return Ct.apply(this,arguments)}}(),je=function(){var Ct=(0,d.Z)(function*(gt){const Lt=gt.enteringEl,Ht=gt.leavingEl;return yield rt(gt,!1),Ve(Lt,Ht),He(Lt,Ht),{hasCompleted:!0}});return function(Lt){return Ct.apply(this,arguments)}}(),rt=function(){var Ct=(0,d.Z)(function*(gt,Lt){const Vn=(void 0!==gt.deepWait?gt.deepWait:Lt)?[Je(gt.enteringEl),Je(gt.leavingEl)]:[xt(gt.enteringEl),xt(gt.leavingEl)];yield Promise.all(Vn),yield Ae(gt.viewIsReady,gt.enteringEl)});return function(Lt,Ht){return Ct.apply(this,arguments)}}(),Ae=function(){var Ct=(0,d.Z)(function*(gt,Lt){gt&&(yield gt(Lt))});return function(Lt,Ht){return Ct.apply(this,arguments)}}(),Ze=(Ct,gt)=>{const Lt=gt.progressCallback,Ht=new Promise(Vn=>{Ct.onFinish(Ft=>Vn(1===Ft))});return Lt?(Ct.progressStart(!0),Lt(Ct)):Ct.play(),Ht},Ve=(Ct,gt)=>{Ne(gt,A),Ne(Ct,a)},He=(Ct,gt)=>{Ne(Ct,O),Ne(gt,p)},Ne=(Ct,gt)=>{if(Ct){const Lt=new CustomEvent(gt,{bubbles:!1,cancelable:!1});Ct.dispatchEvent(Lt)}},xt=Ct=>Ct?new Promise(gt=>(0,V.c)(Ct,gt)):Promise.resolve(),Je=function(){var Ct=(0,d.Z)(function*(gt){const Lt=gt;if(Lt){if(null!=Lt.componentOnReady){if(null!=(yield Lt.componentOnReady()))return}else if(null!=Lt.__registerHost)return void(yield new Promise(Vn=>(0,V.r)(Vn)));yield Promise.all(Array.from(Lt.children).map(Je))}});return function(Lt){return Ct.apply(this,arguments)}}(),ct=(Ct,gt)=>{gt?(Ct.setAttribute("aria-hidden","true"),Ct.classList.add("ion-page-hidden")):(Ct.hidden=!1,Ct.removeAttribute("aria-hidden"),Ct.classList.remove("ion-page-hidden"))},wt=(Ct,gt,Lt)=>{void 0!==Ct&&(Ct.style.zIndex="back"===Lt?"99":"101"),void 0!==gt&&(gt.style.zIndex="100")},Tt=Ct=>Ct.classList.contains("ion-page")?Ct:Ct.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||Ct},7639:(_n,Ke,k)=>{"use strict";k.d(Ke,{a:()=>z,b:()=>Vn,c:()=>V,g:()=>Z,i:()=>Ft});var d=k(9533);class c{constructor(){this.m=new Map}reset(Gt){this.m=new Map(Object.entries(Gt))}get(Gt,Jt){const an=this.m.get(Gt);return void 0!==an?an:Jt}getBoolean(Gt,Jt=!1){const an=this.m.get(Gt);return void 0===an?Jt:"string"==typeof an?"true"===an:!!an}getNumber(Gt,Jt){const an=parseFloat(this.m.get(Gt));return isNaN(an)?void 0!==Jt?Jt:NaN:an}set(Gt,Jt){this.m.set(Gt,Jt)}}const V=new c,L="ionic:",Q="ionic-persist-config",Z=Wt=>G(Wt),z=(Wt,Gt)=>("string"==typeof Wt&&(Gt=Wt,Wt=void 0),Z(Wt).includes(Gt)),G=(Wt=window)=>{if(void 0===Wt)return[];Wt.Ionic=Wt.Ionic||{};let Gt=Wt.Ionic.platforms;return null==Gt&&(Gt=Wt.Ionic.platforms=te(Wt),Gt.forEach(Jt=>Wt.document.documentElement.classList.add(`plt-${Jt}`))),Gt},te=Wt=>{const Gt=V.get("platform");return Object.keys(Lt).filter(Jt=>{const an=Gt&&Gt[Jt];return"function"==typeof an?an(Wt):Lt[Jt](Wt)})},me=Wt=>!!(Ct(Wt,/iPad/i)||Ct(Wt,/Macintosh/i)&&He(Wt)),rt=Wt=>Ct(Wt,/android|sink/i),He=Wt=>gt(Wt,"(any-pointer:coarse)"),xt=Wt=>Je(Wt)||ct(Wt),Je=Wt=>!!(Wt.cordova||Wt.phonegap||Wt.PhoneGap),ct=Wt=>{const Gt=Wt.Capacitor;return!(!Gt||!Gt.isNative)},Ct=(Wt,Gt)=>Gt.test(Wt.navigator.userAgent),gt=(Wt,Gt)=>Wt.matchMedia&&Wt.matchMedia(Gt).matches,Lt={ipad:me,iphone:Wt=>Ct(Wt,/iPhone/i),ios:Wt=>Ct(Wt,/iPhone|iPod/i)||me(Wt),android:rt,phablet:Wt=>{const Gt=Wt.innerWidth,Jt=Wt.innerHeight,an=Math.min(Gt,Jt),Jn=Math.max(Gt,Jt);return an>390&&an<520&&Jn>620&&Jn<800},tablet:Wt=>{const Gt=Wt.innerWidth,Jt=Wt.innerHeight,an=Math.min(Gt,Jt),Jn=Math.max(Gt,Jt);return me(Wt)||(Wt=>rt(Wt)&&!Ct(Wt,/mobile/i))(Wt)||an>460&&an<820&&Jn>780&&Jn<1400},cordova:Je,capacitor:ct,electron:Wt=>Ct(Wt,/electron/i),pwa:Wt=>!!(Wt.matchMedia&&Wt.matchMedia("(display-mode: standalone)").matches||Wt.navigator.standalone),mobile:He,mobileweb:Wt=>He(Wt)&&!xt(Wt),desktop:Wt=>!He(Wt),hybrid:xt};let Ht;const Vn=Wt=>Wt&&(0,d.g)(Wt)||Ht,Ft=(Wt={})=>{if("undefined"==typeof window)return;const Gt=window.document,Jt=window,an=Jt.Ionic=Jt.Ionic||{},Jn={};Wt._ael&&(Jn.ael=Wt._ael),Wt._rel&&(Jn.rel=Wt._rel),Wt._ce&&(Jn.ce=Wt._ce),(0,d.s)(Jn);const si=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(Wt=>{try{const Gt=Wt.sessionStorage.getItem(Q);return null!==Gt?JSON.parse(Gt):{}}catch{return{}}})(Jt)),{persistConfig:!1}),an.config),(Wt=>{const Gt={};return Wt.location.search.slice(1).split("&").map(Jt=>Jt.split("=")).map(([Jt,an])=>[decodeURIComponent(Jt),decodeURIComponent(an)]).filter(([Jt])=>((Wt,Gt)=>Wt.substr(0,Gt.length)===Gt)(Jt,L)).map(([Jt,an])=>[Jt.slice(L.length),an]).forEach(([Jt,an])=>{Gt[Jt]=an}),Gt})(Jt)),Wt);V.reset(si),V.getBoolean("persistConfig")&&((Wt,Gt)=>{try{Wt.sessionStorage.setItem(Q,JSON.stringify(Gt))}catch{return}})(Jt,si),G(Jt),an.config=V,an.mode=Ht=V.get("mode",Gt.documentElement.getAttribute("mode")||(z(Jt,"ios")?"ios":"md")),V.set("mode",Ht),Gt.documentElement.setAttribute("mode",Ht),Gt.documentElement.classList.add(Ht),V.getBoolean("_testing")&&V.set("animated",!1);const di=ln=>ln.tagName&&ln.tagName.startsWith("ION-"),Bn=ln=>["ios","md"].includes(ln);(0,d.a)(ln=>{for(;ln;){const Et=ln.mode||ln.getAttribute("mode");if(Et){if(Bn(Et))return Et;di(ln)&&console.warn('Invalid ionic mode: "'+Et+'", expected: "ios" or "md"')}ln=ln.parentElement}return Ht})}},939:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{iosTransitionAnimation:()=>G,shadow:()=>A});var d=k(5508),c=k(2098);k(9533);const O=te=>document.querySelector(`${te}.ion-cloned-element`),A=te=>te.shadowRoot||te,p=te=>{const ye="ION-TABS"===te.tagName?te:te.querySelector("ion-tabs"),me="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=ye){const Ee=ye.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=Ee?Ee.querySelector(me):null}return te.querySelector(me)},L=(te,ye)=>{const me="ION-TABS"===te.tagName?te:te.querySelector("ion-tabs");let Ee=[];if(null!=me){const je=me.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=je&&(Ee=je.querySelectorAll("ion-buttons"))}else Ee=te.querySelectorAll("ion-buttons");for(const je of Ee){const rt=je.closest("ion-header"),Ae=rt&&!rt.classList.contains("header-collapse-condense-inactive"),Ze=je.querySelector("ion-back-button"),Ve=je.classList.contains("buttons-collapse"),He="start"===je.slot||""===je.slot;if(null!==Ze&&He&&(Ve&&Ae&&ye||!Ve))return Ze}return null},Z=(te,ye,me,Ee,je,rt)=>{const Ae=ye?`calc(100% - ${rt.right+4}px)`:rt.left-4+"px",Ze=ye?"7px":"-7px",Ve=ye?"-4px":"4px",He=ye?"-4px":"4px",Ne=ye?"right":"left",xt=ye?"left":"right",wt=me?[{offset:0,opacity:1,transform:`translate3d(${Ve}, ${rt.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Ze}, ${je.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${Ze}, ${je.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${Ve}, ${rt.top-46}px, 0) scale(1)`}],gt=me?[{offset:0,opacity:1,transform:`translate3d(${He}, ${rt.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${He}, ${rt.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${He}, ${rt.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${He}, ${rt.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${He}, ${rt.top-46}px, 0) scale(1)`}],Lt=(0,d.c)(),Ht=(0,d.c)(),Vn=O("ion-back-button"),Ft=A(Vn).querySelector(".button-text"),Wt=A(Vn).querySelector("ion-icon");Vn.text=Ee.text,Vn.mode=Ee.mode,Vn.icon=Ee.icon,Vn.color=Ee.color,Vn.disabled=Ee.disabled,Vn.style.setProperty("display","block"),Vn.style.setProperty("position","fixed"),Ht.addElement(Wt),Lt.addElement(Ft),Lt.beforeStyles({"transform-origin":`${Ne} center`}).beforeAddWrite(()=>{Ee.style.setProperty("display","none"),Vn.style.setProperty(Ne,Ae)}).afterAddWrite(()=>{Ee.style.setProperty("display",""),Vn.style.setProperty("display","none"),Vn.style.removeProperty(Ne)}).keyframes(wt),Ht.beforeStyles({"transform-origin":`${xt} center`}).keyframes(gt),te.addAnimation([Lt,Ht])},z=(te,ye,me,Ee,je,rt)=>{const Ae=ye?`calc(100% - ${je.right}px)`:`${je.left}px`,Ze=ye?"-18px":"18px",Ve=ye?"right":"left",xt=me?[{offset:0,opacity:0,transform:`translate3d(${Ze}, ${rt.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${je.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${je.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Ze}, ${rt.top-4}px, 0) scale(0.5)`}],Je=O("ion-title"),ct=(0,d.c)();Je.innerText=Ee.innerText,Je.size=Ee.size,Je.color=Ee.color,ct.addElement(Je),ct.beforeStyles({"transform-origin":`${Ve} center`,height:"46px",display:"",position:"relative",[Ve]:Ae}).beforeAddWrite(()=>{Ee.style.setProperty("display","none")}).afterAddWrite(()=>{Ee.style.setProperty("display",""),Je.style.setProperty("display","none")}).keyframes(xt),te.addAnimation(ct)},G=(te,ye)=>{try{const me="cubic-bezier(0.32,0.72,0,1)",Ee="opacity",je="transform",rt="0%",Ae=.8,Ze="rtl"===te.ownerDocument.dir,Ve=Ze?"-99.5%":"99.5%",He=Ze?"33%":"-33%",Ne=ye.enteringEl,xt=ye.leavingEl,Je="back"===ye.direction,ct=Ne.querySelector(":scope > ion-content"),wt=Ne.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),Tt=Ne.querySelectorAll(":scope > ion-header > ion-toolbar"),Ct=(0,d.c)(),gt=(0,d.c)();if(Ct.addElement(Ne).duration(ye.duration||540).easing(ye.easing||me).fill("both").beforeRemoveClass("ion-page-invisible"),xt&&te){const Ft=(0,d.c)();Ft.addElement(te),Ct.addAnimation(Ft)}if(ct||0!==Tt.length||0!==wt.length?(gt.addElement(ct),gt.addElement(wt)):gt.addElement(Ne.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ct.addAnimation(gt),Je?gt.beforeClearStyles([Ee]).fromTo("transform",`translateX(${He})`,`translateX(${rt})`).fromTo(Ee,Ae,1):gt.beforeClearStyles([Ee]).fromTo("transform",`translateX(${Ve})`,`translateX(${rt})`),ct){const Ft=A(ct).querySelector(".transition-effect");if(Ft){const Wt=Ft.querySelector(".transition-cover"),Gt=Ft.querySelector(".transition-shadow"),Jt=(0,d.c)(),an=(0,d.c)(),Jn=(0,d.c)();Jt.addElement(Ft).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),an.addElement(Wt).beforeClearStyles([Ee]).fromTo(Ee,0,.1),Jn.addElement(Gt).beforeClearStyles([Ee]).fromTo(Ee,.03,.7),Jt.addAnimation([an,Jn]),gt.addAnimation([Jt])}}const Lt=Ne.querySelector("ion-header.header-collapse-condense"),{forward:Ht,backward:Vn}=((te,ye,me,Ee,je)=>{const rt=L(Ee,me),Ae=p(je),Ze=p(Ee),Ve=L(je,me),He=null!==rt&&null!==Ae&&!me,Ne=null!==Ze&&null!==Ve&&me;if(He){const xt=Ae.getBoundingClientRect(),Je=rt.getBoundingClientRect();z(te,ye,me,Ae,xt,Je),Z(te,ye,me,rt,xt,Je)}else if(Ne){const xt=Ze.getBoundingClientRect(),Je=Ve.getBoundingClientRect();z(te,ye,me,Ze,xt,Je),Z(te,ye,me,Ve,xt,Je)}return{forward:He,backward:Ne}})(Ct,Ze,Je,Ne,xt);if(Tt.forEach(Ft=>{const Wt=(0,d.c)();Wt.addElement(Ft),Ct.addAnimation(Wt);const Gt=(0,d.c)();Gt.addElement(Ft.querySelector("ion-title"));const Jt=(0,d.c)(),an=Array.from(Ft.querySelectorAll("ion-buttons,[menuToggle]")),Jn=Ft.closest("ion-header"),si=Jn&&Jn.classList.contains("header-collapse-condense-inactive");let di;di=an.filter(Je?Hn=>{const In=Hn.classList.contains("buttons-collapse");return In&&!si||!In}:Hn=>!Hn.classList.contains("buttons-collapse")),Jt.addElement(di);const Bn=(0,d.c)();Bn.addElement(Ft.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const ln=(0,d.c)();ln.addElement(A(Ft).querySelector(".toolbar-background"));const Et=(0,d.c)(),Kt=Ft.querySelector("ion-back-button");if(Kt&&Et.addElement(Kt),Wt.addAnimation([Gt,Jt,Bn,ln,Et]),Jt.fromTo(Ee,.01,1),Bn.fromTo(Ee,.01,1),Je)si||Gt.fromTo("transform",`translateX(${He})`,`translateX(${rt})`).fromTo(Ee,.01,1),Bn.fromTo("transform",`translateX(${He})`,`translateX(${rt})`),Et.fromTo(Ee,.01,1);else if(Lt||Gt.fromTo("transform",`translateX(${Ve})`,`translateX(${rt})`).fromTo(Ee,.01,1),Bn.fromTo("transform",`translateX(${Ve})`,`translateX(${rt})`),ln.beforeClearStyles([Ee,"transform"]),(null==Jn?void 0:Jn.translucent)?ln.fromTo("transform",Ze?"translateX(-100%)":"translateX(100%)","translateX(0px)"):ln.fromTo(Ee,.01,"var(--opacity)"),Ht||Et.fromTo(Ee,.01,1),Kt&&!Ht){const In=(0,d.c)();In.addElement(A(Kt).querySelector(".button-text")).fromTo("transform",Ze?"translateX(-100px)":"translateX(100px)","translateX(0px)"),Wt.addAnimation(In)}}),xt){const Ft=(0,d.c)(),Wt=xt.querySelector(":scope > ion-content"),Gt=xt.querySelectorAll(":scope > ion-header > ion-toolbar"),Jt=xt.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(Wt||0!==Gt.length||0!==Jt.length?(Ft.addElement(Wt),Ft.addElement(Jt)):Ft.addElement(xt.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ct.addAnimation(Ft),Je){Ft.beforeClearStyles([Ee]).fromTo("transform",`translateX(${rt})`,Ze?"translateX(-100%)":"translateX(100%)");const an=(0,c.g)(xt);Ct.afterAddWrite(()=>{"normal"===Ct.getDirection()&&an.style.setProperty("display","none")})}else Ft.fromTo("transform",`translateX(${rt})`,`translateX(${He})`).fromTo(Ee,1,Ae);if(Wt){const an=A(Wt).querySelector(".transition-effect");if(an){const Jn=an.querySelector(".transition-cover"),si=an.querySelector(".transition-shadow"),di=(0,d.c)(),Bn=(0,d.c)(),ln=(0,d.c)();di.addElement(an).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Bn.addElement(Jn).beforeClearStyles([Ee]).fromTo(Ee,.1,0),ln.addElement(si).beforeClearStyles([Ee]).fromTo(Ee,.7,.03),di.addAnimation([Bn,ln]),Ft.addAnimation([di])}}Gt.forEach(an=>{const Jn=(0,d.c)();Jn.addElement(an);const si=(0,d.c)();si.addElement(an.querySelector("ion-title"));const di=(0,d.c)(),Bn=an.querySelectorAll("ion-buttons,[menuToggle]"),ln=an.closest("ion-header"),Et=ln&&ln.classList.contains("header-collapse-condense-inactive"),Kt=Array.from(Bn).filter(_r=>{const er=_r.classList.contains("buttons-collapse");return er&&!Et||!er});di.addElement(Kt);const Hn=(0,d.c)(),In=an.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");In.length>0&&Hn.addElement(In);const ti=(0,d.c)();ti.addElement(A(an).querySelector(".toolbar-background"));const mi=(0,d.c)(),ir=an.querySelector("ion-back-button");if(ir&&mi.addElement(ir),Jn.addAnimation([si,di,Hn,mi,ti]),Ct.addAnimation(Jn),mi.fromTo(Ee,.99,0),di.fromTo(Ee,.99,0),Hn.fromTo(Ee,.99,0),Je){if(Et||si.fromTo("transform",`translateX(${rt})`,Ze?"translateX(-100%)":"translateX(100%)").fromTo(Ee,.99,0),Hn.fromTo("transform",`translateX(${rt})`,Ze?"translateX(-100%)":"translateX(100%)"),ti.beforeClearStyles([Ee,"transform"]),(null==ln?void 0:ln.translucent)?ti.fromTo("transform","translateX(0px)",Ze?"translateX(-100%)":"translateX(100%)"):ti.fromTo(Ee,"var(--opacity)",0),ir&&!Vn){const er=(0,d.c)();er.addElement(A(ir).querySelector(".button-text")).fromTo("transform",`translateX(${rt})`,`translateX(${(Ze?-124:124)+"px"})`),Jn.addAnimation(er)}}else Et||si.fromTo("transform",`translateX(${rt})`,`translateX(${He})`).fromTo(Ee,.99,0).afterClearStyles([je,Ee]),Hn.fromTo("transform",`translateX(${rt})`,`translateX(${He})`).afterClearStyles([je,Ee]),mi.afterClearStyles([Ee]),si.afterClearStyles([Ee]),di.afterClearStyles([Ee])})}return Ct}catch(me){throw me}}},410:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{KEYBOARD_DID_CLOSE:()=>c,KEYBOARD_DID_OPEN:()=>d,copyVisualViewport:()=>rt,keyboardDidClose:()=>ye,keyboardDidOpen:()=>G,keyboardDidResize:()=>te,resetKeyboardAssist:()=>p,setKeyboardClose:()=>z,setKeyboardOpen:()=>Z,startKeyboardAssist:()=>L,trackViewportChanges:()=>je});const d="ionKeyboardDidShow",c="ionKeyboardDidHide";let a={},O={},A=!1;const p=()=>{a={},O={},A=!1},L=Ae=>{Q(Ae),Ae.visualViewport&&(O=rt(Ae.visualViewport),Ae.visualViewport.onresize=()=>{je(Ae),G()||te(Ae)?Z(Ae):ye(Ae)&&z(Ae)})},Q=Ae=>{Ae.addEventListener("keyboardDidShow",Ze=>Z(Ae,Ze)),Ae.addEventListener("keyboardDidHide",()=>z(Ae))},Z=(Ae,Ze)=>{me(Ae,Ze),A=!0},z=Ae=>{Ee(Ae),A=!1},G=()=>!A&&a.width===O.width&&(a.height-O.height)*O.scale>150,te=Ae=>A&&!ye(Ae),ye=Ae=>A&&O.height===Ae.innerHeight,me=(Ae,Ze)=>{const He=new CustomEvent(d,{detail:{keyboardHeight:Ze?Ze.keyboardHeight:Ae.innerHeight-O.height}});Ae.dispatchEvent(He)},Ee=Ae=>{const Ze=new CustomEvent(c);Ae.dispatchEvent(Ze)},je=Ae=>{a=Object.assign({},O),O=rt(Ae.visualViewport)},rt=Ae=>({width:Math.round(Ae.width),height:Math.round(Ae.height),offsetTop:Ae.offsetTop,offsetLeft:Ae.offsetLeft,pageTop:Ae.pageTop,pageLeft:Ae.pageLeft,scale:Ae.scale})},773:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{mdTransitionAnimation:()=>a});var d=k(5508),c=k(2098);k(9533);const a=(O,A)=>{const Q="back"===A.direction,z=A.leavingEl,G=(0,c.g)(A.enteringEl),te=G.querySelector("ion-toolbar"),ye=(0,d.c)();if(ye.addElement(G).fill("both").beforeRemoveClass("ion-page-invisible"),Q?ye.duration(A.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):ye.duration(A.duration||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),te){const me=(0,d.c)();me.addElement(te),ye.addAnimation(me)}if(z&&Q){ye.duration(A.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const me=(0,d.c)();me.addElement((0,c.g)(z)).onFinish(Ee=>{1===Ee&&me.elements.length>0&&me.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),ye.addAnimation(me)}return ye}},1686:(_n,Ke,k)=>{"use strict";k.d(Ke,{A:()=>Je,L:()=>Bn,M:()=>Pe,P:()=>Gi,T:()=>to,a:()=>Se,b:()=>Xe,c:()=>zt,d:()=>Vn,e:()=>ji,f:()=>Ie,g:()=>mo,l:()=>Me,m:()=>st,s:()=>fi,t:()=>rn});var d=k(6099),c=k(9533),V=k(7639),a=k(2335),O=k(1363),A=k(6665),p=k(7300),L=k(5508),Q=k(2993),Z=k(940),z=k(6499),G=k(410),te=k(2098),ye=k(7438),me=k(5893),Ee=k(7788),je=k(527);const rt=(ie,ue)=>{let we,Oe;const Dt=(Dn,yn,oi)=>{if("undefined"==typeof document)return;const Pi=document.elementFromPoint(Dn,yn);Pi&&ue(Pi)?Pi!==we&&(fn(),ht(Pi,oi)):fn()},ht=(Dn,yn)=>{we=Dn,Oe||(Oe=we);const oi=we;(0,c.c)(()=>oi.classList.add("ion-activated")),yn()},fn=(Dn=!1)=>{if(!we)return;const yn=we;(0,c.c)(()=>yn.classList.remove("ion-activated")),Dn&&Oe!==we&&we.click(),we=void 0};return(0,O.createGesture)({el:ie,gestureName:"buttonActiveDrag",threshold:0,onStart:Dn=>Dt(Dn.currentX,Dn.currentY,a.a),onMove:Dn=>Dt(Dn.currentX,Dn.currentY,a.b),onEnd:()=>{fn(!0),(0,a.h)(),Oe=void 0}})},Ae=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Oe.addElement(ie.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(100%)","translateY(0%)"),ue.addElement(ie).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([we,Oe])},Ze=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),Oe.addElement(ie.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(0%)","translateY(100%)"),ue.addElement(ie).easing("cubic-bezier(.36,.66,.04,1)").duration(450).addAnimation([we,Oe])},Ve=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Oe.addElement(ie.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(100%)","translateY(0%)"),ue.addElement(ie).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([we,Oe])},He=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),Oe.addElement(ie.querySelector(".action-sheet-wrapper")).fromTo("transform","translateY(0%)","translateY(100%)"),ue.addElement(ie).easing("cubic-bezier(.36,.66,.04,1)").duration(450).addAnimation([we,Oe])};let Je=class{constructor(ie){(0,c.r)(this,ie),this.didPresent=(0,c.e)(this,"ionActionSheetDidPresent",7),this.willPresent=(0,c.e)(this,"ionActionSheetWillPresent",7),this.willDismiss=(0,c.e)(this,"ionActionSheetWillDismiss",7),this.didDismiss=(0,c.e)(this,"ionActionSheetDidDismiss",7),this.presented=!1,this.keyboardClose=!0,this.buttons=[],this.backdropDismiss=!0,this.translucent=!1,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,Ur)},this.dispatchCancelHandler=ue=>{if(en(ue.detail.role)){const Oe=this.getButtons().find(Dt=>"cancel"===Dt.role);this.callButtonHandler(Oe)}}}present(){return Wi(this,"actionSheetEnter",Ae,Ve)}connectedCallback(){un(this.el)}dismiss(ie,ue){return wo(this,ie,ue,"actionSheetLeave",Ze,He)}onDidDismiss(){return ke(this.el,"ionActionSheetDidDismiss")}onWillDismiss(){return ke(this.el,"ionActionSheetWillDismiss")}buttonClick(ie){var ue=this;return(0,d.Z)(function*(){const we=ie.role;return en(we)?ue.dismiss(ie.data,we):(yield ue.callButtonHandler(ie))?ue.dismiss(ie.data,ie.role):Promise.resolve()})()}callButtonHandler(ie){return(0,d.Z)(function*(){return!(ie&&!1===(yield fi(ie.handler)))})()}getButtons(){return this.buttons.map(ie=>"string"==typeof ie?{text:ie}:ie)}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}componentDidLoad(){const{groupEl:ie,wrapperEl:ue}=this;this.gesture||"md"===(0,V.b)(this)||!ue||!ie||(0,c.f)(()=>{ie.scrollHeight>ie.clientHeight||(this.gesture=rt(ue,Oe=>Oe.classList.contains("action-sheet-button")),this.gesture.enable(!0))})}render(){const{htmlAttributes:ie}=this,ue=(0,V.b)(this),we=this.getButtons(),Oe=we.find(ht=>"cancel"===ht.role),Dt=we.filter(ht=>"cancel"!==ht.role);return(0,c.h)(c.H,Object.assign({role:"dialog","aria-modal":"true",tabindex:"-1"},ie,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign(Object.assign({[ue]:!0},(0,p.g)(this.cssClass)),{"overlay-hidden":!0,"action-sheet-translucent":this.translucent}),onIonActionSheetWillDismiss:this.dispatchCancelHandler,onIonBackdropTap:this.onBackdropTap}),(0,c.h)("ion-backdrop",{tappable:this.backdropDismiss}),(0,c.h)("div",{tabindex:"0"}),(0,c.h)("div",{class:"action-sheet-wrapper ion-overlay-wrapper",role:"dialog",ref:ht=>this.wrapperEl=ht},(0,c.h)("div",{class:"action-sheet-container"},(0,c.h)("div",{class:"action-sheet-group",ref:ht=>this.groupEl=ht},void 0!==this.header&&(0,c.h)("div",{class:{"action-sheet-title":!0,"action-sheet-has-sub-title":void 0!==this.subHeader}},this.header,this.subHeader&&(0,c.h)("div",{class:"action-sheet-sub-title"},this.subHeader)),Dt.map(ht=>(0,c.h)("button",{type:"button",id:ht.id,class:ct(ht),onClick:()=>this.buttonClick(ht)},(0,c.h)("span",{class:"action-sheet-button-inner"},ht.icon&&(0,c.h)("ion-icon",{icon:ht.icon,lazy:!1,class:"action-sheet-icon"}),ht.text),"md"===ue&&(0,c.h)("ion-ripple-effect",null)))),Oe&&(0,c.h)("div",{class:"action-sheet-group action-sheet-group-cancel"},(0,c.h)("button",{type:"button",class:ct(Oe),onClick:()=>this.buttonClick(Oe)},(0,c.h)("span",{class:"action-sheet-button-inner"},Oe.icon&&(0,c.h)("ion-icon",{icon:Oe.icon,lazy:!1,class:"action-sheet-icon"}),Oe.text),"md"===ue&&(0,c.h)("ion-ripple-effect",null))))),(0,c.h)("div",{tabindex:"0"}))}get el(){return(0,c.i)(this)}};const ct=ie=>Object.assign({"action-sheet-button":!0,"ion-activatable":!0,"ion-focusable":!0,[`action-sheet-${ie.role}`]:void 0!==ie.role},(0,p.g)(ie.cssClass));Je.style={ios:'.sc-ion-action-sheet-ios-h{--color:initial;--button-color-activated:var(--button-color);--button-color-focused:var(--button-color);--button-color-hover:var(--button-color);--button-color-selected:var(--button-color);--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--height:100%;--max-height:calc(100% - (var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:block;position:fixed;outline:none;font-family:var(--ion-font-family, inherit);-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-action-sheet-ios-h{display:none}.action-sheet-wrapper.sc-ion-action-sheet-ios{left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:var(--ion-safe-area-top, 0);margin-bottom:var(--ion-safe-area-bottom, 0);-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:block;position:absolute;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);z-index:10;pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-wrapper.sc-ion-action-sheet-ios{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.action-sheet-button.sc-ion-action-sheet-ios{display:block;position:relative;width:100%;border:0;outline:none;background:var(--button-background);color:var(--button-color);font-family:inherit;overflow:hidden}.action-sheet-button-inner.sc-ion-action-sheet-ios{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;pointer-events:none;width:100%;height:100%;z-index:1}.action-sheet-container.sc-ion-action-sheet-ios{display:-ms-flexbox;display:flex;-ms-flex-flow:column;flex-flow:column;-ms-flex-pack:end;justify-content:flex-end;height:100%;max-height:100%}.action-sheet-group.sc-ion-action-sheet-ios{-ms-flex-negative:2;flex-shrink:2;overscroll-behavior-y:contain;overflow-y:auto;-webkit-overflow-scrolling:touch;pointer-events:all;background:var(--background)}.action-sheet-group.sc-ion-action-sheet-ios::-webkit-scrollbar{display:none}.action-sheet-group-cancel.sc-ion-action-sheet-ios{-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.action-sheet-button.sc-ion-action-sheet-ios::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.action-sheet-selected.sc-ion-action-sheet-ios{color:var(--button-color-selected)}.action-sheet-selected.sc-ion-action-sheet-ios::after{background:var(--button-background-selected);opacity:var(--button-background-selected-opacity)}.action-sheet-button.ion-activated.sc-ion-action-sheet-ios{color:var(--button-color-activated)}.action-sheet-button.ion-activated.sc-ion-action-sheet-ios::after{background:var(--button-background-activated);opacity:var(--button-background-activated-opacity)}.action-sheet-button.ion-focused.sc-ion-action-sheet-ios{color:var(--button-color-focused)}.action-sheet-button.ion-focused.sc-ion-action-sheet-ios::after{background:var(--button-background-focused);opacity:var(--button-background-focused-opacity)}@media (any-hover: hover){.action-sheet-button.sc-ion-action-sheet-ios:hover{color:var(--button-color-hover)}.action-sheet-button.sc-ion-action-sheet-ios:hover::after{background:var(--button-background-hover);opacity:var(--button-background-hover-opacity)}}.sc-ion-action-sheet-ios-h{--background:var(--ion-overlay-background-color, var(--ion-color-step-100, #f9f9f9));--backdrop-opacity:var(--ion-backdrop-opacity, 0.4);--button-background:linear-gradient(0deg, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08), rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08) 50%, transparent 50%) bottom/100% 1px no-repeat transparent;--button-background-activated:var(--ion-text-color, #000);--button-background-activated-opacity:.08;--button-background-hover:currentColor;--button-background-hover-opacity:.04;--button-background-focused:currentColor;--button-background-focused-opacity:.12;--button-background-selected:var(--ion-color-step-150, var(--ion-background-color, #fff));--button-background-selected-opacity:1;--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-400, #999999);text-align:center}.action-sheet-container.sc-ion-action-sheet-ios{padding-left:8px;padding-right:8px;padding-top:0;padding-bottom:0}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-container.sc-ion-action-sheet-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.action-sheet-group.sc-ion-action-sheet-ios{border-radius:13px;margin-bottom:8px}.action-sheet-group.sc-ion-action-sheet-ios:first-child{margin-top:10px}.action-sheet-group.sc-ion-action-sheet-ios:last-child{margin-bottom:10px}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-group.sc-ion-action-sheet-ios{background-color:transparent;-webkit-backdrop-filter:saturate(280%) blur(20px);backdrop-filter:saturate(280%) blur(20px)}.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-title.sc-ion-action-sheet-ios,.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-button.sc-ion-action-sheet-ios{background-color:transparent;background-image:-webkit-gradient(linear, left bottom, left top, from(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)), to(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8))), -webkit-gradient(linear, left bottom, left top, from(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4)), color-stop(50%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4)), color-stop(50%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)));background-image:linear-gradient(0deg, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8), rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 100%), linear-gradient(0deg, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4), rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.4) 50%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 50%);background-repeat:no-repeat;background-position:top, bottom;background-size:100% calc(100% - 1px), 100% 1px;-webkit-backdrop-filter:saturate(120%);backdrop-filter:saturate(120%)}.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-button.ion-activated.sc-ion-action-sheet-ios{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.7);background-image:none}.action-sheet-translucent.sc-ion-action-sheet-ios-h .action-sheet-cancel.sc-ion-action-sheet-ios{background:var(--button-background-selected)}}.action-sheet-title.sc-ion-action-sheet-ios{background:-webkit-gradient(linear, left bottom, left top, from(rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08)), color-stop(50%, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08)), color-stop(50%, transparent)) bottom/100% 1px no-repeat transparent;background:linear-gradient(0deg, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08), rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.08) 50%, transparent 50%) bottom/100% 1px no-repeat transparent}.action-sheet-title.sc-ion-action-sheet-ios{padding-left:10px;padding-right:10px;padding-top:14px;padding-bottom:13px;color:var(--color, var(--ion-color-step-400, #999999));font-size:13px;font-weight:400;text-align:center}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-title.sc-ion-action-sheet-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:10px;padding-inline-start:10px;-webkit-padding-end:10px;padding-inline-end:10px}}.action-sheet-title.action-sheet-has-sub-title.sc-ion-action-sheet-ios{font-weight:600}.action-sheet-sub-title.sc-ion-action-sheet-ios{padding-left:0;padding-right:0;padding-top:6px;padding-bottom:0;font-size:13px;font-weight:400}.action-sheet-button.sc-ion-action-sheet-ios{padding-left:18px;padding-right:18px;padding-top:18px;padding-bottom:18px;height:56px;font-size:20px;contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-button.sc-ion-action-sheet-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:18px;padding-inline-start:18px;-webkit-padding-end:18px;padding-inline-end:18px}}.action-sheet-button.sc-ion-action-sheet-ios .action-sheet-icon.sc-ion-action-sheet-ios{margin-right:0.3em;font-size:28px;pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-button.sc-ion-action-sheet-ios .action-sheet-icon.sc-ion-action-sheet-ios{margin-right:unset;-webkit-margin-end:0.3em;margin-inline-end:0.3em}}.action-sheet-button.sc-ion-action-sheet-ios:last-child{background-image:none}.action-sheet-selected.sc-ion-action-sheet-ios{font-weight:bold}.action-sheet-cancel.sc-ion-action-sheet-ios{font-weight:600}.action-sheet-cancel.sc-ion-action-sheet-ios::after{background:var(--button-background-selected);opacity:var(--button-background-selected-opacity)}.action-sheet-destructive.sc-ion-action-sheet-ios,.action-sheet-destructive.ion-activated.sc-ion-action-sheet-ios,.action-sheet-destructive.ion-focused.sc-ion-action-sheet-ios{color:var(--ion-color-danger, #eb445a)}@media (any-hover: hover){.action-sheet-destructive.sc-ion-action-sheet-ios:hover{color:var(--ion-color-danger, #eb445a)}}',md:'.sc-ion-action-sheet-md-h{--color:initial;--button-color-activated:var(--button-color);--button-color-focused:var(--button-color);--button-color-hover:var(--button-color);--button-color-selected:var(--button-color);--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--height:100%;--max-height:calc(100% - (var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:block;position:fixed;outline:none;font-family:var(--ion-font-family, inherit);-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-action-sheet-md-h{display:none}.action-sheet-wrapper.sc-ion-action-sheet-md{left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:var(--ion-safe-area-top, 0);margin-bottom:var(--ion-safe-area-bottom, 0);-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:block;position:absolute;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);z-index:10;pointer-events:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-wrapper.sc-ion-action-sheet-md{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.action-sheet-button.sc-ion-action-sheet-md{display:block;position:relative;width:100%;border:0;outline:none;background:var(--button-background);color:var(--button-color);font-family:inherit;overflow:hidden}.action-sheet-button-inner.sc-ion-action-sheet-md{display:-ms-flexbox;display:flex;position:relative;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;pointer-events:none;width:100%;height:100%;z-index:1}.action-sheet-container.sc-ion-action-sheet-md{display:-ms-flexbox;display:flex;-ms-flex-flow:column;flex-flow:column;-ms-flex-pack:end;justify-content:flex-end;height:100%;max-height:100%}.action-sheet-group.sc-ion-action-sheet-md{-ms-flex-negative:2;flex-shrink:2;overscroll-behavior-y:contain;overflow-y:auto;-webkit-overflow-scrolling:touch;pointer-events:all;background:var(--background)}.action-sheet-group.sc-ion-action-sheet-md::-webkit-scrollbar{display:none}.action-sheet-group-cancel.sc-ion-action-sheet-md{-ms-flex-negative:0;flex-shrink:0;overflow:hidden}.action-sheet-button.sc-ion-action-sheet-md::after{left:0;right:0;top:0;bottom:0;position:absolute;content:"";opacity:0}.action-sheet-selected.sc-ion-action-sheet-md{color:var(--button-color-selected)}.action-sheet-selected.sc-ion-action-sheet-md::after{background:var(--button-background-selected);opacity:var(--button-background-selected-opacity)}.action-sheet-button.ion-activated.sc-ion-action-sheet-md{color:var(--button-color-activated)}.action-sheet-button.ion-activated.sc-ion-action-sheet-md::after{background:var(--button-background-activated);opacity:var(--button-background-activated-opacity)}.action-sheet-button.ion-focused.sc-ion-action-sheet-md{color:var(--button-color-focused)}.action-sheet-button.ion-focused.sc-ion-action-sheet-md::after{background:var(--button-background-focused);opacity:var(--button-background-focused-opacity)}@media (any-hover: hover){.action-sheet-button.sc-ion-action-sheet-md:hover{color:var(--button-color-hover)}.action-sheet-button.sc-ion-action-sheet-md:hover::after{background:var(--button-background-hover);opacity:var(--button-background-hover-opacity)}}.sc-ion-action-sheet-md-h{--background:var(--ion-overlay-background-color, var(--ion-background-color, #fff));--backdrop-opacity:var(--ion-backdrop-opacity, 0.32);--button-background:transparent;--button-background-selected:currentColor;--button-background-selected-opacity:0;--button-background-activated:transparent;--button-background-activated-opacity:0;--button-background-hover:currentColor;--button-background-hover-opacity:.04;--button-background-focused:currentColor;--button-background-focused-opacity:.12;--button-color:var(--ion-color-step-850, #262626);--color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54)}.action-sheet-title.sc-ion-action-sheet-md{padding-left:16px;padding-right:16px;padding-top:20px;padding-bottom:17px;min-height:60px;color:var(--color, rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.54));font-size:16px;text-align:start}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-title.sc-ion-action-sheet-md{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.action-sheet-sub-title.sc-ion-action-sheet-md{padding-left:0;padding-right:0;padding-top:16px;padding-bottom:0;font-size:14px}.action-sheet-group.sc-ion-action-sheet-md:first-child{padding-top:0}.action-sheet-group.sc-ion-action-sheet-md:last-child{padding-bottom:0}.action-sheet-button.sc-ion-action-sheet-md{padding-left:16px;padding-right:16px;padding-top:0;padding-bottom:0;position:relative;height:52px;font-size:16px;text-align:start;contain:strict;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-button.sc-ion-action-sheet-md{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.action-sheet-icon.sc-ion-action-sheet-md{padding-bottom:4px;margin-left:0;margin-right:32px;margin-top:0;margin-bottom:0;color:var(--color);font-size:24px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.action-sheet-icon.sc-ion-action-sheet-md{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:32px;margin-inline-end:32px}}.action-sheet-button-inner.sc-ion-action-sheet-md{-ms-flex-pack:start;justify-content:flex-start}.action-sheet-selected.sc-ion-action-sheet-md{font-weight:bold}'};const wt=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Oe.addElement(ie.querySelector(".alert-wrapper")).keyframes([{offset:0,opacity:"0.01",transform:"scale(1.1)"},{offset:1,opacity:"1",transform:"scale(1)"}]),ue.addElement(ie).easing("ease-in-out").duration(200).addAnimation([we,Oe])},Tt=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),Oe.addElement(ie.querySelector(".alert-wrapper")).keyframes([{offset:0,opacity:.99,transform:"scale(1)"},{offset:1,opacity:0,transform:"scale(0.9)"}]),ue.addElement(ie).easing("ease-in-out").duration(200).addAnimation([we,Oe])},Ct=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Oe.addElement(ie.querySelector(".alert-wrapper")).keyframes([{offset:0,opacity:"0.01",transform:"scale(0.9)"},{offset:1,opacity:"1",transform:"scale(1)"}]),ue.addElement(ie).easing("ease-in-out").duration(150).addAnimation([we,Oe])},gt=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),Oe.addElement(ie.querySelector(".alert-wrapper")).fromTo("opacity",.99,0),ue.addElement(ie).easing("ease-in-out").duration(150).addAnimation([we,Oe])};let Vn=class{constructor(ie){(0,c.r)(this,ie),this.didPresent=(0,c.e)(this,"ionAlertDidPresent",7),this.willPresent=(0,c.e)(this,"ionAlertWillPresent",7),this.willDismiss=(0,c.e)(this,"ionAlertWillDismiss",7),this.didDismiss=(0,c.e)(this,"ionAlertDidDismiss",7),this.processedInputs=[],this.processedButtons=[],this.presented=!1,this.keyboardClose=!0,this.buttons=[],this.inputs=[],this.backdropDismiss=!0,this.translucent=!1,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,Ur)},this.dispatchCancelHandler=ue=>{if(en(ue.detail.role)){const Oe=this.processedButtons.find(Dt=>"cancel"===Dt.role);this.callButtonHandler(Oe)}}}onKeydown(ie){if(!new Set(this.processedInputs.map(fn=>fn.type)).has("radio")||ie.target&&!this.el.contains(ie.target)||ie.target.classList.contains("alert-button"))return;const we=this.el.querySelectorAll(".alert-radio"),Oe=Array.from(we).filter(fn=>!fn.disabled),Dt=Oe.findIndex(fn=>fn.id===ie.target.id);let ht;if(["ArrowDown","ArrowRight"].includes(ie.code)&&(ht=Dt===Oe.length-1?Oe[0]:Oe[Dt+1]),["ArrowUp","ArrowLeft"].includes(ie.code)&&(ht=0===Dt?Oe[Oe.length-1]:Oe[Dt-1]),ht&&Oe.includes(ht)){const fn=this.processedInputs.find(Dn=>Dn.id===(null==ht?void 0:ht.id));fn&&(this.rbClick(fn),ht.focus())}}buttonsChanged(){this.processedButtons=this.buttons.map(ue=>"string"==typeof ue?{text:ue,role:"cancel"===ue.toLowerCase()?"cancel":void 0}:ue)}inputsChanged(){const ie=this.inputs,ue=ie.find(ht=>!ht.disabled),Oe=ie.find(ht=>ht.checked&&!ht.disabled)||ue,Dt=new Set(ie.map(ht=>ht.type));Dt.has("checkbox")&&Dt.has("radio")&&console.warn(`Alert cannot mix input types: ${Array.from(Dt.values()).join("/")}. Please see alert docs for more info.`),this.inputType=Dt.values().next().value,this.processedInputs=ie.map((ht,fn)=>({type:ht.type||"text",name:ht.name||`${fn}`,placeholder:ht.placeholder||"",value:ht.value,label:ht.label,checked:!!ht.checked,disabled:!!ht.disabled,id:ht.id||`alert-input-${this.overlayIndex}-${fn}`,handler:ht.handler,min:ht.min,max:ht.max,cssClass:ht.cssClass||"",attributes:ht.attributes||{},tabindex:"radio"===ht.type&&ht!==Oe?-1:0}))}connectedCallback(){un(this.el)}componentWillLoad(){this.inputsChanged(),this.buttonsChanged()}disconnectedCallback(){this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}componentDidLoad(){this.gesture||"md"===(0,V.b)(this)||!this.wrapperEl||(this.gesture=rt(this.wrapperEl,ie=>ie.classList.contains("alert-button")),this.gesture.enable(!0))}present(){return Wi(this,"alertEnter",wt,Ct)}dismiss(ie,ue){return wo(this,ie,ue,"alertLeave",Tt,gt)}onDidDismiss(){return ke(this.el,"ionAlertDidDismiss")}onWillDismiss(){return ke(this.el,"ionAlertWillDismiss")}rbClick(ie){for(const ue of this.processedInputs)ue.checked=ue===ie,ue.tabindex=ue===ie?0:-1;this.activeId=ie.id,fi(ie.handler,ie),(0,c.j)(this)}cbClick(ie){ie.checked=!ie.checked,fi(ie.handler,ie),(0,c.j)(this)}buttonClick(ie){const ue=ie.role,we=this.getValues();if(en(ue))return this.dismiss({values:we},ue);const Oe=this.callButtonHandler(ie,we);return!1!==Oe?this.dismiss(Object.assign({values:we},Oe),ie.role):Promise.resolve(!1)}callButtonHandler(ie,ue){if(ie&&ie.handler){const we=fi(ie.handler,ue);if(!1===we)return!1;if("object"==typeof we)return we}return{}}getValues(){if(0===this.processedInputs.length)return;if("radio"===this.inputType){const ue=this.processedInputs.find(we=>!!we.checked);return ue?ue.value:void 0}if("checkbox"===this.inputType)return this.processedInputs.filter(ue=>ue.checked).map(ue=>ue.value);const ie={};return this.processedInputs.forEach(ue=>{ie[ue.name]=ue.value||""}),ie}renderAlertInputs(){switch(this.inputType){case"checkbox":return this.renderCheckbox();case"radio":return this.renderRadio();default:return this.renderInput()}}renderCheckbox(){const ie=this.processedInputs,ue=(0,V.b)(this);return 0===ie.length?null:(0,c.h)("div",{class:"alert-checkbox-group"},ie.map(we=>(0,c.h)("button",{type:"button",onClick:()=>this.cbClick(we),"aria-checked":`${we.checked}`,id:we.id,disabled:we.disabled,tabIndex:we.tabindex,role:"checkbox",class:Object.assign(Object.assign({},(0,p.g)(we.cssClass)),{"alert-tappable":!0,"alert-checkbox":!0,"alert-checkbox-button":!0,"ion-focusable":!0,"alert-checkbox-button-disabled":we.disabled||!1})},(0,c.h)("div",{class:"alert-button-inner"},(0,c.h)("div",{class:"alert-checkbox-icon"},(0,c.h)("div",{class:"alert-checkbox-inner"})),(0,c.h)("div",{class:"alert-checkbox-label"},we.label)),"md"===ue&&(0,c.h)("ion-ripple-effect",null))))}renderRadio(){const ie=this.processedInputs;return 0===ie.length?null:(0,c.h)("div",{class:"alert-radio-group",role:"radiogroup","aria-activedescendant":this.activeId},ie.map(ue=>(0,c.h)("button",{type:"button",onClick:()=>this.rbClick(ue),"aria-checked":`${ue.checked}`,disabled:ue.disabled,id:ue.id,tabIndex:ue.tabindex,class:Object.assign(Object.assign({},(0,p.g)(ue.cssClass)),{"alert-radio-button":!0,"alert-tappable":!0,"alert-radio":!0,"ion-focusable":!0,"alert-radio-button-disabled":ue.disabled||!1}),role:"radio"},(0,c.h)("div",{class:"alert-button-inner"},(0,c.h)("div",{class:"alert-radio-icon"},(0,c.h)("div",{class:"alert-radio-inner"})),(0,c.h)("div",{class:"alert-radio-label"},ue.label)))))}renderInput(){const ie=this.processedInputs;return 0===ie.length?null:(0,c.h)("div",{class:"alert-input-group"},ie.map(ue=>{var we,Oe,Dt,ht;return(0,c.h)("div",{class:"alert-input-wrapper"},"textarea"===ue.type?(0,c.h)("textarea",Object.assign({placeholder:ue.placeholder,value:ue.value,id:ue.id,tabIndex:ue.tabindex},ue.attributes,{disabled:null!==(Oe=null===(we=ue.attributes)||void 0===we?void 0:we.disabled)&&void 0!==Oe?Oe:ue.disabled,class:Ft(ue),onInput:fn=>{var Dn;ue.value=fn.target.value,(null===(Dn=ue.attributes)||void 0===Dn?void 0:Dn.onInput)&&ue.attributes.onInput(fn)}})):(0,c.h)("input",Object.assign({placeholder:ue.placeholder,type:ue.type,min:ue.min,max:ue.max,value:ue.value,id:ue.id,tabIndex:ue.tabindex},ue.attributes,{disabled:null!==(ht=null===(Dt=ue.attributes)||void 0===Dt?void 0:Dt.disabled)&&void 0!==ht?ht:ue.disabled,class:Ft(ue),onInput:fn=>{var Dn;ue.value=fn.target.value,(null===(Dn=ue.attributes)||void 0===Dn?void 0:Dn.onInput)&&ue.attributes.onInput(fn)}})))}))}renderAlertButtons(){const ie=this.processedButtons,ue=(0,V.b)(this);return(0,c.h)("div",{class:{"alert-button-group":!0,"alert-button-group-vertical":ie.length>2}},ie.map(Oe=>(0,c.h)("button",{type:"button",id:Oe.id,class:Wt(Oe),tabIndex:0,onClick:()=>this.buttonClick(Oe)},(0,c.h)("span",{class:"alert-button-inner"},Oe.text),"md"===ue&&(0,c.h)("ion-ripple-effect",null))))}render(){const{overlayIndex:ie,header:ue,subHeader:we,htmlAttributes:Oe}=this,Dt=(0,V.b)(this),ht=`alert-${ie}-hdr`,fn=`alert-${ie}-sub-hdr`,Dn=`alert-${ie}-msg`;return(0,c.h)(c.H,Object.assign({role:this.inputs.length>0||this.buttons.length>0?"alertdialog":"alert","aria-modal":"true",tabindex:"-1"},Oe,{style:{zIndex:`${2e4+ie}`},class:Object.assign(Object.assign({},(0,p.g)(this.cssClass)),{[Dt]:!0,"overlay-hidden":!0,"alert-translucent":this.translucent}),onIonAlertWillDismiss:this.dispatchCancelHandler,onIonBackdropTap:this.onBackdropTap}),(0,c.h)("ion-backdrop",{tappable:this.backdropDismiss}),(0,c.h)("div",{tabindex:"0"}),(0,c.h)("div",{class:"alert-wrapper ion-overlay-wrapper",ref:oi=>this.wrapperEl=oi},(0,c.h)("div",{class:"alert-head"},ue&&(0,c.h)("h2",{id:ht,class:"alert-title"},ue),we&&(0,c.h)("h2",{id:fn,class:"alert-sub-title"},we)),(0,c.h)("div",{id:Dn,class:"alert-message",innerHTML:(0,A.s)(this.message)}),this.renderAlertInputs(),this.renderAlertButtons()),(0,c.h)("div",{tabindex:"0"}))}get el(){return(0,c.i)(this)}static get watchers(){return{buttons:["buttonsChanged"],inputs:["inputsChanged"]}}};const Ft=ie=>{var ue,we,Oe;return Object.assign(Object.assign({"alert-input":!0,"alert-input-disabled":(null!==(we=null===(ue=ie.attributes)||void 0===ue?void 0:ue.disabled)&&void 0!==we?we:ie.disabled)||!1},(0,p.g)(ie.cssClass)),(0,p.g)(ie.attributes?null===(Oe=ie.attributes.class)||void 0===Oe?void 0:Oe.toString():""))},Wt=ie=>Object.assign({"alert-button":!0,"ion-focusable":!0,"ion-activatable":!0,[`alert-button-role-${ie.role}`]:void 0!==ie.role},(0,p.g)(ie.cssClass));Vn.style={ios:".sc-ion-alert-ios-h{--min-width:250px;--width:auto;--min-height:auto;--height:auto;--max-height:90%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-alert-ios-h{display:none}.alert-top.sc-ion-alert-ios-h{padding-top:50px;-ms-flex-align:start;align-items:flex-start}.alert-wrapper.sc-ion-alert-ios{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:content;opacity:0;z-index:10}.alert-title.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}.alert-sub-title.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-weight:normal}.alert-message.sc-ion-alert-ios{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-overflow-scrolling:touch;overflow-y:auto;overscroll-behavior-y:contain}.alert-checkbox-group.sc-ion-alert-ios::-webkit-scrollbar,.alert-radio-group.sc-ion-alert-ios::-webkit-scrollbar,.alert-message.sc-ion-alert-ios::-webkit-scrollbar{display:none}.alert-input.sc-ion-alert-ios{padding-left:0;padding-right:0;padding-top:10px;padding-bottom:10px;width:100%;border:0;background:inherit;font:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.alert-button-group.sc-ion-alert-ios{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;width:100%}.alert-button-group-vertical.sc-ion-alert-ios{-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.alert-button.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;border:0;font-size:14px;line-height:20px;z-index:0}.alert-button.ion-focused.sc-ion-alert-ios,.alert-tappable.ion-focused.sc-ion-alert-ios{background:var(--ion-color-step-100, #e6e6e6)}.alert-button-inner.sc-ion-alert-ios{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.alert-input-disabled.sc-ion-alert-ios,.alert-checkbox-button-disabled.sc-ion-alert-ios .alert-button-inner.sc-ion-alert-ios,.alert-radio-button-disabled.sc-ion-alert-ios .alert-button-inner.sc-ion-alert-ios{cursor:default;opacity:0.5;pointer-events:none}.alert-tappable.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;width:100%;border:0;background:transparent;font-size:inherit;line-height:initial;text-align:start;-webkit-appearance:none;-moz-appearance:none;appearance:none;contain:strict}.alert-button.sc-ion-alert-ios,.alert-checkbox.sc-ion-alert-ios,.alert-input.sc-ion-alert-ios,.alert-radio.sc-ion-alert-ios{outline:none}.alert-radio-icon.sc-ion-alert-ios,.alert-checkbox-icon.sc-ion-alert-ios,.alert-checkbox-inner.sc-ion-alert-ios{-webkit-box-sizing:border-box;box-sizing:border-box}textarea.alert-input.sc-ion-alert-ios{min-height:37px;resize:none}.sc-ion-alert-ios-h{--background:var(--ion-overlay-background-color, var(--ion-color-step-100, #f9f9f9));--max-width:270px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.3);font-size:14px}.alert-wrapper.sc-ion-alert-ios{border-radius:13px;-webkit-box-shadow:none;box-shadow:none;overflow:hidden}.alert-button.sc-ion-alert-ios .alert-button-inner.sc-ion-alert-ios{pointer-events:none}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.alert-translucent.sc-ion-alert-ios-h .alert-wrapper.sc-ion-alert-ios{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.9);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}.alert-head.sc-ion-alert-ios{padding-left:16px;padding-right:16px;padding-top:12px;padding-bottom:7px;text-align:center}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-head.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.alert-title.sc-ion-alert-ios{margin-top:8px;color:var(--ion-text-color, #000);font-size:17px;font-weight:600}.alert-sub-title.sc-ion-alert-ios{color:var(--ion-color-step-600, #666666);font-size:14px}.alert-message.sc-ion-alert-ios,.alert-input-group.sc-ion-alert-ios{padding-left:16px;padding-right:16px;padding-top:0;padding-bottom:21px;color:var(--ion-text-color, #000);font-size:13px;text-align:center}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-message.sc-ion-alert-ios,.alert-input-group.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.alert-message.sc-ion-alert-ios{max-height:240px}.alert-message.sc-ion-alert-ios:empty{padding-left:0;padding-right:0;padding-top:0;padding-bottom:12px}.alert-input.sc-ion-alert-ios{border-radius:4px;margin-top:10px;padding-left:6px;padding-right:6px;padding-top:6px;padding-bottom:6px;border:0.55px solid var(--ion-color-step-250, #bfbfbf);background-color:var(--ion-background-color, #fff);-webkit-appearance:none;-moz-appearance:none;appearance:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-input.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:6px;padding-inline-start:6px;-webkit-padding-end:6px;padding-inline-end:6px}}.alert-input.sc-ion-alert-ios::-webkit-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::-moz-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios:-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-ios::-ms-clear{display:none}.alert-radio-group.sc-ion-alert-ios,.alert-checkbox-group.sc-ion-alert-ios{-ms-scroll-chaining:none;overscroll-behavior:contain;max-height:240px;border-top:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2);overflow-y:auto;-webkit-overflow-scrolling:touch}.alert-tappable.sc-ion-alert-ios{height:44px}.alert-radio-label.sc-ion-alert-ios{padding-left:13px;padding-right:13px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;-ms-flex-order:0;order:0;color:var(--ion-text-color, #000);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-radio-label.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:13px;padding-inline-start:13px;-webkit-padding-end:13px;padding-inline-end:13px}}[aria-checked=true].sc-ion-alert-ios .alert-radio-label.sc-ion-alert-ios{color:var(--ion-color-primary, #3880ff)}.alert-radio-icon.sc-ion-alert-ios{position:relative;-ms-flex-order:1;order:1;min-width:30px}[aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios{left:7px;top:-7px;position:absolute;width:6px;height:12px;-webkit-transform:rotate(45deg);transform:rotate(45deg);border-width:2px;border-top-width:0;border-left-width:0;border-style:solid;border-color:var(--ion-color-primary, #3880ff)}[dir=rtl].sc-ion-alert-ios [aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios,[dir=rtl].sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios,[dir=rtl] .sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-radio-inner.sc-ion-alert-ios{left:unset;right:unset;right:7px}.alert-checkbox-label.sc-ion-alert-ios{padding-left:13px;padding-right:13px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;color:var(--ion-text-color, #000);text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-checkbox-label.sc-ion-alert-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:13px;padding-inline-start:13px;-webkit-padding-end:13px;padding-inline-end:13px}}.alert-checkbox-icon.sc-ion-alert-ios{border-radius:50%;margin-left:16px;margin-right:6px;margin-top:10px;margin-bottom:10px;position:relative;width:24px;height:24px;border-width:1px;border-style:solid;border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));background-color:var(--ion-item-background, var(--ion-background-color, #fff));contain:strict}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-checkbox-icon.sc-ion-alert-ios{margin-left:unset;margin-right:unset;-webkit-margin-start:16px;margin-inline-start:16px;-webkit-margin-end:6px;margin-inline-end:6px}}[aria-checked=true].sc-ion-alert-ios .alert-checkbox-icon.sc-ion-alert-ios{border-color:var(--ion-color-primary, #3880ff);background-color:var(--ion-color-primary, #3880ff)}[aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios{left:9px;top:4px;position:absolute;width:5px;height:12px;-webkit-transform:rotate(45deg);transform:rotate(45deg);border-width:1px;border-top-width:0;border-left-width:0;border-style:solid;border-color:var(--ion-background-color, #fff)}[dir=rtl].sc-ion-alert-ios [aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios,[dir=rtl].sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios,[dir=rtl] .sc-ion-alert-ios-h [aria-checked=true].sc-ion-alert-ios .alert-checkbox-inner.sc-ion-alert-ios{left:unset;right:unset;right:9px}.alert-button-group.sc-ion-alert-ios{margin-right:-0.55px;-ms-flex-wrap:wrap;flex-wrap:wrap}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button-group.sc-ion-alert-ios{margin-right:unset;-webkit-margin-end:-0.55px;margin-inline-end:-0.55px}}.alert-button.sc-ion-alert-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;border-radius:0;-ms-flex:1 1 auto;flex:1 1 auto;min-width:50%;height:44px;border-top:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2);border-right:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2);background-color:transparent;color:var(--ion-color-primary, #3880ff);font-size:17px;overflow:hidden}[dir=rtl].sc-ion-alert-ios .alert-button.sc-ion-alert-ios:first-child,[dir=rtl].sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:first-child,[dir=rtl] .sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:first-child{border-right:0}.alert-button.sc-ion-alert-ios:last-child{border-right:0;font-weight:bold}[dir=rtl].sc-ion-alert-ios .alert-button.sc-ion-alert-ios:last-child,[dir=rtl].sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:last-child,[dir=rtl] .sc-ion-alert-ios-h .alert-button.sc-ion-alert-ios:last-child{border-right:0.55px solid rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.2)}.alert-button.ion-activated.sc-ion-alert-ios{background-color:rgba(var(--ion-text-color-rgb, 0, 0, 0), 0.1)}.alert-button-role-destructive.sc-ion-alert-ios,.alert-button-role-destructive.ion-activated.sc-ion-alert-ios,.alert-button-role-destructive.ion-focused.sc-ion-alert-ios{color:var(--ion-color-danger, #eb445a)}",md:".sc-ion-alert-md-h{--min-width:250px;--width:auto;--min-height:auto;--height:auto;--max-height:90%;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-alert-md-h{display:none}.alert-top.sc-ion-alert-md-h{padding-top:50px;-ms-flex-align:start;align-items:flex-start}.alert-wrapper.sc-ion-alert-md{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);contain:content;opacity:0;z-index:10}.alert-title.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}.alert-sub-title.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;font-weight:normal}.alert-message.sc-ion-alert-md{-webkit-box-sizing:border-box;box-sizing:border-box;-webkit-overflow-scrolling:touch;overflow-y:auto;overscroll-behavior-y:contain}.alert-checkbox-group.sc-ion-alert-md::-webkit-scrollbar,.alert-radio-group.sc-ion-alert-md::-webkit-scrollbar,.alert-message.sc-ion-alert-md::-webkit-scrollbar{display:none}.alert-input.sc-ion-alert-md{padding-left:0;padding-right:0;padding-top:10px;padding-bottom:10px;width:100%;border:0;background:inherit;font:inherit;-webkit-box-sizing:border-box;box-sizing:border-box}.alert-button-group.sc-ion-alert-md{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;width:100%}.alert-button-group-vertical.sc-ion-alert-md{-ms-flex-direction:column;flex-direction:column;-ms-flex-wrap:nowrap;flex-wrap:nowrap}.alert-button.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;display:block;border:0;font-size:14px;line-height:20px;z-index:0}.alert-button.ion-focused.sc-ion-alert-md,.alert-tappable.ion-focused.sc-ion-alert-md{background:var(--ion-color-step-100, #e6e6e6)}.alert-button-inner.sc-ion-alert-md{display:-ms-flexbox;display:flex;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-ms-flex-negative:0;flex-shrink:0;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;width:100%;height:100%}.alert-input-disabled.sc-ion-alert-md,.alert-checkbox-button-disabled.sc-ion-alert-md .alert-button-inner.sc-ion-alert-md,.alert-radio-button-disabled.sc-ion-alert-md .alert-button-inner.sc-ion-alert-md{cursor:default;opacity:0.5;pointer-events:none}.alert-tappable.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;display:-ms-flexbox;display:flex;width:100%;border:0;background:transparent;font-size:inherit;line-height:initial;text-align:start;-webkit-appearance:none;-moz-appearance:none;appearance:none;contain:strict}.alert-button.sc-ion-alert-md,.alert-checkbox.sc-ion-alert-md,.alert-input.sc-ion-alert-md,.alert-radio.sc-ion-alert-md{outline:none}.alert-radio-icon.sc-ion-alert-md,.alert-checkbox-icon.sc-ion-alert-md,.alert-checkbox-inner.sc-ion-alert-md{-webkit-box-sizing:border-box;box-sizing:border-box}textarea.alert-input.sc-ion-alert-md{min-height:37px;resize:none}.sc-ion-alert-md-h{--background:var(--ion-overlay-background-color, var(--ion-background-color, #fff));--max-width:280px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.32);font-size:14px}.alert-wrapper.sc-ion-alert-md{border-radius:4px;-webkit-box-shadow:0 11px 15px -7px rgba(0, 0, 0, 0.2), 0 24px 38px 3px rgba(0, 0, 0, 0.14), 0 9px 46px 8px rgba(0, 0, 0, 0.12);box-shadow:0 11px 15px -7px rgba(0, 0, 0, 0.2), 0 24px 38px 3px rgba(0, 0, 0, 0.14), 0 9px 46px 8px rgba(0, 0, 0, 0.12)}.alert-head.sc-ion-alert-md{padding-left:23px;padding-right:23px;padding-top:20px;padding-bottom:15px;text-align:start}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-head.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:23px;padding-inline-start:23px;-webkit-padding-end:23px;padding-inline-end:23px}}.alert-title.sc-ion-alert-md{color:var(--ion-text-color, #000);font-size:20px;font-weight:500}.alert-sub-title.sc-ion-alert-md{color:var(--ion-text-color, #000);font-size:16px}.alert-message.sc-ion-alert-md,.alert-input-group.sc-ion-alert-md{padding-left:24px;padding-right:24px;padding-top:20px;padding-bottom:20px;color:var(--ion-color-step-550, #737373)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-message.sc-ion-alert-md,.alert-input-group.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:24px;padding-inline-start:24px;-webkit-padding-end:24px;padding-inline-end:24px}}.alert-message.sc-ion-alert-md{max-height:266px;font-size:16px}.alert-message.sc-ion-alert-md:empty{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0}.alert-head.sc-ion-alert-md+.alert-message.sc-ion-alert-md{padding-top:0}.alert-input.sc-ion-alert-md{margin-left:0;margin-right:0;margin-top:5px;margin-bottom:5px;border-bottom:1px solid var(--ion-color-step-150, #d9d9d9);color:var(--ion-text-color, #000)}.alert-input.sc-ion-alert-md::-webkit-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::-moz-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md:-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::-ms-input-placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::placeholder{color:var(--ion-placeholder-color, var(--ion-color-step-400, #999999));font-family:inherit;font-weight:inherit}.alert-input.sc-ion-alert-md::-ms-clear{display:none}.alert-input.sc-ion-alert-md:focus{margin-bottom:4px;border-bottom:2px solid var(--ion-color-primary, #3880ff)}.alert-radio-group.sc-ion-alert-md,.alert-checkbox-group.sc-ion-alert-md{position:relative;max-height:266px;border-top:1px solid var(--ion-color-step-150, #d9d9d9);border-bottom:1px solid var(--ion-color-step-150, #d9d9d9);overflow:auto}.alert-tappable.sc-ion-alert-md{position:relative;height:48px;overflow:hidden}.alert-radio-label.sc-ion-alert-md{padding-left:52px;padding-right:26px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;color:var(--ion-color-step-850, #262626);font-size:16px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-radio-label.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:52px;padding-inline-start:52px;-webkit-padding-end:26px;padding-inline-end:26px}}.alert-radio-icon.sc-ion-alert-md{left:26px;top:0;border-radius:50%;display:block;position:relative;width:20px;height:20px;border-width:2px;border-style:solid;border-color:var(--ion-color-step-550, #737373)}[dir=rtl].sc-ion-alert-md .alert-radio-icon.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h .alert-radio-icon.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h .alert-radio-icon.sc-ion-alert-md{left:unset;right:unset;right:26px}.alert-radio-inner.sc-ion-alert-md{left:3px;top:3px;border-radius:50%;position:absolute;width:10px;height:10px;-webkit-transform:scale3d(0, 0, 0);transform:scale3d(0, 0, 0);-webkit-transition:-webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:-webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:transform 280ms cubic-bezier(0.4, 0, 0.2, 1);transition:transform 280ms cubic-bezier(0.4, 0, 0.2, 1), -webkit-transform 280ms cubic-bezier(0.4, 0, 0.2, 1);background-color:var(--ion-color-primary, #3880ff)}[dir=rtl].sc-ion-alert-md .alert-radio-inner.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h .alert-radio-inner.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h .alert-radio-inner.sc-ion-alert-md{left:unset;right:unset;right:3px}[aria-checked=true].sc-ion-alert-md .alert-radio-label.sc-ion-alert-md{color:var(--ion-color-step-850, #262626)}[aria-checked=true].sc-ion-alert-md .alert-radio-icon.sc-ion-alert-md{border-color:var(--ion-color-primary, #3880ff)}[aria-checked=true].sc-ion-alert-md .alert-radio-inner.sc-ion-alert-md{-webkit-transform:scale3d(1, 1, 1);transform:scale3d(1, 1, 1)}.alert-checkbox-label.sc-ion-alert-md{padding-left:53px;padding-right:26px;padding-top:13px;padding-bottom:13px;-ms-flex:1;flex:1;color:var(--ion-color-step-850, #262626);font-size:16px;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-checkbox-label.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:53px;padding-inline-start:53px;-webkit-padding-end:26px;padding-inline-end:26px}}.alert-checkbox-icon.sc-ion-alert-md{left:26px;top:0;border-radius:2px;position:relative;width:16px;height:16px;border-width:2px;border-style:solid;border-color:var(--ion-color-step-550, #737373);contain:strict}[dir=rtl].sc-ion-alert-md .alert-checkbox-icon.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h .alert-checkbox-icon.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h .alert-checkbox-icon.sc-ion-alert-md{left:unset;right:unset;right:26px}[aria-checked=true].sc-ion-alert-md .alert-checkbox-icon.sc-ion-alert-md{border-color:var(--ion-color-primary, #3880ff);background-color:var(--ion-color-primary, #3880ff)}[aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md{left:3px;top:0;position:absolute;width:6px;height:10px;-webkit-transform:rotate(45deg);transform:rotate(45deg);border-width:2px;border-top-width:0;border-left-width:0;border-style:solid;border-color:var(--ion-color-primary-contrast, #fff)}[dir=rtl].sc-ion-alert-md [aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md,[dir=rtl].sc-ion-alert-md-h [aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md,[dir=rtl] .sc-ion-alert-md-h [aria-checked=true].sc-ion-alert-md .alert-checkbox-inner.sc-ion-alert-md{left:unset;right:unset;right:3px}.alert-button-group.sc-ion-alert-md{padding-left:8px;padding-right:8px;padding-top:8px;padding-bottom:8px;-webkit-box-sizing:border-box;box-sizing:border-box;-ms-flex-wrap:wrap-reverse;flex-wrap:wrap-reverse;-ms-flex-pack:end;justify-content:flex-end}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button-group.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.alert-button.sc-ion-alert-md{border-radius:2px;margin-left:0;margin-right:8px;margin-top:0;margin-bottom:0;padding-left:10px;padding-right:10px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;color:var(--ion-color-primary, #3880ff);font-weight:500;text-align:end;text-transform:uppercase;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button.sc-ion-alert-md{margin-left:unset;margin-right:unset;-webkit-margin-start:0;margin-inline-start:0;-webkit-margin-end:8px;margin-inline-end:8px}}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.alert-button.sc-ion-alert-md{padding-left:unset;padding-right:unset;-webkit-padding-start:10px;padding-inline-start:10px;-webkit-padding-end:10px;padding-inline-end:10px}}.alert-button-inner.sc-ion-alert-md{-ms-flex-pack:end;justify-content:flex-end}"};const Gt=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Oe.addElement(ie.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.01,transform:"scale(1.1)"},{offset:1,opacity:1,transform:"scale(1)"}]),ue.addElement(ie).easing("ease-in-out").duration(200).addAnimation([we,Oe])},Jt=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),Oe.addElement(ie.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.99,transform:"scale(1)"},{offset:1,opacity:0,transform:"scale(0.9)"}]),ue.addElement(ie).easing("ease-in-out").duration(200).addAnimation([we,Oe])},an=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Oe.addElement(ie.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.01,transform:"scale(1.1)"},{offset:1,opacity:1,transform:"scale(1)"}]),ue.addElement(ie).easing("ease-in-out").duration(200).addAnimation([we,Oe])},Jn=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),Oe.addElement(ie.querySelector(".loading-wrapper")).keyframes([{offset:0,opacity:.99,transform:"scale(1)"},{offset:1,opacity:0,transform:"scale(0.9)"}]),ue.addElement(ie).easing("ease-in-out").duration(200).addAnimation([we,Oe])};let Bn=class{constructor(ie){(0,c.r)(this,ie),this.didPresent=(0,c.e)(this,"ionLoadingDidPresent",7),this.willPresent=(0,c.e)(this,"ionLoadingWillPresent",7),this.willDismiss=(0,c.e)(this,"ionLoadingWillDismiss",7),this.didDismiss=(0,c.e)(this,"ionLoadingDidDismiss",7),this.presented=!1,this.keyboardClose=!0,this.duration=0,this.backdropDismiss=!1,this.showBackdrop=!0,this.translucent=!1,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,Ur)}}connectedCallback(){un(this.el)}componentWillLoad(){if(void 0===this.spinner){const ie=(0,V.b)(this);this.spinner=V.c.get("loadingSpinner",V.c.get("spinner","ios"===ie?"lines":"crescent"))}}present(){var ie=this;return(0,d.Z)(function*(){yield Wi(ie,"loadingEnter",Gt,an,void 0),ie.duration>0&&(ie.durationTimeout=setTimeout(()=>ie.dismiss(),ie.duration+10))})()}dismiss(ie,ue){return this.durationTimeout&&clearTimeout(this.durationTimeout),wo(this,ie,ue,"loadingLeave",Jt,Jn)}onDidDismiss(){return ke(this.el,"ionLoadingDidDismiss")}onWillDismiss(){return ke(this.el,"ionLoadingWillDismiss")}render(){const{message:ie,spinner:ue,htmlAttributes:we}=this,Oe=(0,V.b)(this);return(0,c.h)(c.H,Object.assign({tabindex:"-1"},we,{style:{zIndex:`${4e4+this.overlayIndex}`},onIonBackdropTap:this.onBackdropTap,class:Object.assign(Object.assign({},(0,p.g)(this.cssClass)),{[Oe]:!0,"overlay-hidden":!0,"loading-translucent":this.translucent})}),(0,c.h)("ion-backdrop",{visible:this.showBackdrop,tappable:this.backdropDismiss}),(0,c.h)("div",{tabindex:"0"}),(0,c.h)("div",{class:"loading-wrapper ion-overlay-wrapper",role:"dialog"},ue&&(0,c.h)("div",{class:"loading-spinner"},(0,c.h)("ion-spinner",{name:ue,"aria-hidden":"true"})),ie&&(0,c.h)("div",{class:"loading-content",innerHTML:(0,A.s)(ie)})),(0,c.h)("div",{tabindex:"0"}))}get el(){return(0,c.i)(this)}};Bn.style={ios:".sc-ion-loading-ios-h{--min-width:auto;--width:auto;--min-height:auto;--height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-loading-ios-h{display:none}.loading-wrapper.sc-ion-loading-ios{display:-ms-flexbox;display:flex;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);opacity:0;z-index:10}.spinner-lines.sc-ion-loading-ios,.spinner-lines-small.sc-ion-loading-ios,.spinner-bubbles.sc-ion-loading-ios,.spinner-circles.sc-ion-loading-ios,.spinner-crescent.sc-ion-loading-ios,.spinner-dots.sc-ion-loading-ios{color:var(--spinner-color)}.sc-ion-loading-ios-h{--background:var(--ion-overlay-background-color, var(--ion-color-step-100, #f9f9f9));--max-width:270px;--max-height:90%;--spinner-color:var(--ion-color-step-600, #666666);--backdrop-opacity:var(--ion-backdrop-opacity, 0.3);color:var(--ion-text-color, #000);font-size:14px}.loading-wrapper.sc-ion-loading-ios{border-radius:8px;padding-left:34px;padding-right:34px;padding-top:24px;padding-bottom:24px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-wrapper.sc-ion-loading-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:34px;padding-inline-start:34px;-webkit-padding-end:34px;padding-inline-end:34px}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){.loading-translucent.sc-ion-loading-ios-h .loading-wrapper.sc-ion-loading-ios{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}.loading-content.sc-ion-loading-ios{font-weight:bold}.loading-spinner.sc-ion-loading-ios+.loading-content.sc-ion-loading-ios{margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-spinner.sc-ion-loading-ios+.loading-content.sc-ion-loading-ios{margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}",md:".sc-ion-loading-md-h{--min-width:auto;--width:auto;--min-height:auto;--height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;font-family:var(--ion-font-family, inherit);contain:strict;-ms-touch-action:none;touch-action:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}.overlay-hidden.sc-ion-loading-md-h{display:none}.loading-wrapper.sc-ion-loading-md{display:-ms-flexbox;display:flex;-ms-flex-align:inherit;align-items:inherit;-ms-flex-pack:inherit;justify-content:inherit;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);opacity:0;z-index:10}.spinner-lines.sc-ion-loading-md,.spinner-lines-small.sc-ion-loading-md,.spinner-bubbles.sc-ion-loading-md,.spinner-circles.sc-ion-loading-md,.spinner-crescent.sc-ion-loading-md,.spinner-dots.sc-ion-loading-md{color:var(--spinner-color)}.sc-ion-loading-md-h{--background:var(--ion-color-step-50, #f2f2f2);--max-width:280px;--max-height:90%;--spinner-color:var(--ion-color-primary, #3880ff);--backdrop-opacity:var(--ion-backdrop-opacity, 0.32);color:var(--ion-color-step-850, #262626);font-size:14px}.loading-wrapper.sc-ion-loading-md{border-radius:2px;padding-left:24px;padding-right:24px;padding-top:24px;padding-bottom:24px;-webkit-box-shadow:0 16px 20px rgba(0, 0, 0, 0.4);box-shadow:0 16px 20px rgba(0, 0, 0, 0.4)}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-wrapper.sc-ion-loading-md{padding-left:unset;padding-right:unset;-webkit-padding-start:24px;padding-inline-start:24px;-webkit-padding-end:24px;padding-inline-end:24px}}.loading-spinner.sc-ion-loading-md+.loading-content.sc-ion-loading-md{margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.loading-spinner.sc-ion-loading-md+.loading-content.sc-ion-loading-md{margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}"};const Hn=(ie,ue)=>{const we=1/(1-ue);return ie*we+-ue*we},In=ie=>{const{currentBreakpoint:ue,backdropBreakpoint:we}=ie,Dt=void 0===we||we<ue?`calc(var(--backdrop-opacity) * ${ue})`:"0",ht=(0,L.c)("backdropAnimation").fromTo("opacity",0,Dt);return{wrapperAnimation:(0,L.c)("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:"translateY(100%)"},{offset:1,opacity:1,transform:`translateY(${100-100*ue}%)`}]),backdropAnimation:ht}},ti=ie=>{const{currentBreakpoint:ue,backdropBreakpoint:we}=ie,Oe=`calc(var(--backdrop-opacity) * ${Hn(ue,we)})`,Dt=[{offset:0,opacity:Oe},{offset:1,opacity:0}],ht=[{offset:0,opacity:Oe},{offset:we,opacity:0},{offset:1,opacity:0}],fn=(0,L.c)("backdropAnimation").keyframes(0!==we?ht:Dt);return{wrapperAnimation:(0,L.c)("wrapperAnimation").keyframes([{offset:0,opacity:1,transform:`translateY(${100-100*ue}%)`},{offset:1,opacity:1,transform:"translateY(100%)"}]),backdropAnimation:fn}},ir=(ie,ue)=>{const{presentingEl:we,currentBreakpoint:Oe}=ue,Dt=(0,z.g)(ie),{wrapperAnimation:ht,backdropAnimation:fn}=void 0!==Oe?In(ue):{backdropAnimation:(0,L.c)().fromTo("opacity",.01,"var(--backdrop-opacity)"),wrapperAnimation:(0,L.c)().fromTo("transform","translateY(100vh)","translateY(0vh)")};fn.addElement(Dt.querySelector("ion-backdrop")).beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),ht.addElement(Dt.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const Dn=(0,L.c)("entering-base").addElement(ie).easing("cubic-bezier(0.32,0.72,0,1)").duration(500).addAnimation(ht);if(we){const yn=window.innerWidth<768,oi="ION-MODAL"===we.tagName&&void 0!==we.presentingElement,Pi=(0,z.g)(we),Mi=(0,L.c)().beforeStyles({transform:"translateY(0)","transform-origin":"top center",overflow:"hidden"}),bi=document.body;if(yn){const gr=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",dr=`translateY(${oi?"-10px":gr}) scale(0.93)`;Mi.afterStyles({transform:dr}).beforeAddWrite(()=>bi.style.setProperty("background-color","black")).addElement(we).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"},{offset:1,filter:"contrast(0.85)",transform:dr,borderRadius:"10px 10px 0 0"}]),Dn.addAnimation(Mi)}else if(Dn.addAnimation(fn),oi){const Di=`translateY(-10px) scale(${oi?.93:1})`;Mi.afterStyles({transform:Di}).addElement(Pi.querySelector(".modal-wrapper")).keyframes([{offset:0,filter:"contrast(1)",transform:"translateY(0) scale(1)"},{offset:1,filter:"contrast(0.85)",transform:Di}]);const Ci=(0,L.c)().afterStyles({transform:Di}).addElement(Pi.querySelector(".modal-shadow")).keyframes([{offset:0,opacity:"1",transform:"translateY(0) scale(1)"},{offset:1,opacity:"0",transform:Di}]);Dn.addAnimation([Mi,Ci])}else ht.fromTo("opacity","0","1")}else Dn.addAnimation(fn);return Dn},er=(ie,ue,we=500)=>{const{presentingEl:Oe,currentBreakpoint:Dt}=ue,ht=(0,z.g)(ie),{wrapperAnimation:fn,backdropAnimation:Dn}=void 0!==Dt?ti(ue):{backdropAnimation:(0,L.c)().fromTo("opacity","var(--backdrop-opacity)",0),wrapperAnimation:(0,L.c)().fromTo("transform","translateY(0vh)","translateY(100vh)")};Dn.addElement(ht.querySelector("ion-backdrop")),fn.addElement(ht.querySelectorAll(".modal-wrapper, .modal-shadow")).beforeStyles({opacity:1});const yn=(0,L.c)("leaving-base").addElement(ie).easing("cubic-bezier(0.32,0.72,0,1)").duration(we).addAnimation(fn);if(Oe){const oi=window.innerWidth<768,Pi="ION-MODAL"===Oe.tagName&&void 0!==Oe.presentingElement,Mi=(0,z.g)(Oe),bi=(0,L.c)().beforeClearStyles(["transform"]).afterClearStyles(["transform"]).onFinish(Di=>{1===Di&&(Oe.style.setProperty("overflow",""),Array.from(gr.querySelectorAll("ion-modal")).filter(dr=>void 0!==dr.presentingElement).length<=1&&gr.style.setProperty("background-color",""))}),gr=document.body;if(oi){const Di=CSS.supports("width","max(0px, 1px)")?"max(30px, var(--ion-safe-area-top))":"30px",nr=`translateY(${Pi?"-10px":Di}) scale(0.93)`;bi.addElement(Oe).keyframes([{offset:0,filter:"contrast(0.85)",transform:nr,borderRadius:"10px 10px 0 0"},{offset:1,filter:"contrast(1)",transform:"translateY(0px) scale(1)",borderRadius:"0px"}]),yn.addAnimation(bi)}else if(yn.addAnimation(Dn),Pi){const Ci=`translateY(-10px) scale(${Pi?.93:1})`;bi.addElement(Mi.querySelector(".modal-wrapper")).afterStyles({transform:"translate3d(0, 0, 0)"}).keyframes([{offset:0,filter:"contrast(0.85)",transform:Ci},{offset:1,filter:"contrast(1)",transform:"translateY(0) scale(1)"}]);const dr=(0,L.c)().addElement(Mi.querySelector(".modal-shadow")).afterStyles({transform:"translateY(0) scale(1)"}).keyframes([{offset:0,opacity:"0",transform:Ci},{offset:1,opacity:"1",transform:"translateY(0) scale(1)"}]);yn.addAnimation([bi,dr])}else fn.fromTo("opacity","1","0")}else yn.addAnimation(Dn);return yn},mr=(ie,ue)=>{const{currentBreakpoint:we}=ue,Oe=(0,z.g)(ie),{wrapperAnimation:Dt,backdropAnimation:ht}=void 0!==we?In(ue):{backdropAnimation:(0,L.c)().fromTo("opacity",.01,"var(--backdrop-opacity)"),wrapperAnimation:(0,L.c)().keyframes([{offset:0,opacity:.01,transform:"translateY(40px)"},{offset:1,opacity:1,transform:"translateY(0px)"}])};return ht.addElement(Oe.querySelector("ion-backdrop")).beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Dt.addElement(Oe.querySelector(".modal-wrapper")),(0,L.c)().addElement(ie).easing("cubic-bezier(0.36,0.66,0.04,1)").duration(280).addAnimation([ht,Dt])},ki=(ie,ue)=>{const{currentBreakpoint:we}=ue,Oe=(0,z.g)(ie),{wrapperAnimation:Dt,backdropAnimation:ht}=void 0!==we?ti(ue):{backdropAnimation:(0,L.c)().fromTo("opacity","var(--backdrop-opacity)",0),wrapperAnimation:(0,L.c)().keyframes([{offset:0,opacity:.99,transform:"translateY(0px)"},{offset:1,opacity:0,transform:"translateY(40px)"}])};return ht.addElement(Oe.querySelector("ion-backdrop")),Dt.addElement(Oe.querySelector(".modal-wrapper")),(0,L.c)().easing("cubic-bezier(0.47,0,0.745,0.715)").duration(200).addAnimation([ht,Dt])};let Pe=class{constructor(ie){(0,c.r)(this,ie),this.didPresent=(0,c.e)(this,"ionModalDidPresent",7),this.willPresent=(0,c.e)(this,"ionModalWillPresent",7),this.willDismiss=(0,c.e)(this,"ionModalWillDismiss",7),this.didDismiss=(0,c.e)(this,"ionModalDidDismiss",7),this.didPresentShorthand=(0,c.e)(this,"didPresent",7),this.willPresentShorthand=(0,c.e)(this,"willPresent",7),this.willDismissShorthand=(0,c.e)(this,"willDismiss",7),this.didDismissShorthand=(0,c.e)(this,"didDismiss",7),this.modalIndex=Be++,this.coreDelegate=(0,Z.C)(),this.isSheetModal=!1,this.inline=!1,this.gestureAnimationDismissing=!1,this.presented=!1,this.hasController=!1,this.keyboardClose=!0,this.backdropBreakpoint=0,this.backdropDismiss=!0,this.showBackdrop=!0,this.animated=!0,this.swipeToClose=!1,this.isOpen=!1,this.configureTriggerInteraction=()=>{const{trigger:ue,el:we,destroyTriggerInteraction:Oe}=this;Oe&&Oe();const Dt=void 0!==ue?document.getElementById(ue):null;Dt&&(this.destroyTriggerInteraction=((fn,Dn)=>{const yn=()=>{Dn.present()};return fn.addEventListener("click",yn),()=>{fn.removeEventListener("click",yn)}})(Dt,we))},this.onBackdropTap=()=>{this.dismiss(void 0,Ur)},this.onDismiss=ue=>{ue.stopPropagation(),ue.preventDefault(),this.dismiss()},this.onLifecycle=ue=>{const we=this.usersElement,Oe=ft[ue.type];if(we&&Oe){const Dt=new CustomEvent(Oe,{bubbles:!1,cancelable:!1,detail:ue.detail});we.dispatchEvent(Dt)}}}onIsOpenChange(ie,ue){!0===ie&&!1===ue?this.present():!1===ie&&!0===ue&&this.dismiss()}onTriggerChange(){this.configureTriggerInteraction()}swipeToCloseChanged(ie){this.gesture?this.gesture.enable(ie):ie&&this.initSwipeToClose()}connectedCallback(){un(this.el)}componentWillLoad(){const{breakpoints:ie,initialBreakpoint:ue}=this;this.modalId=this.el.hasAttribute("id")?this.el.getAttribute("id"):`ion-modal-${this.modalIndex}`,this.isSheetModal=void 0!==ie&&void 0!==ue,void 0!==ie&&void 0!==ue&&!ie.includes(ue)&&console.warn("[Ionic Warning]: Your breakpoints array must include the initialBreakpoint value.")}componentDidLoad(){!0===this.isOpen&&(0,z.r)(()=>this.present()),this.configureTriggerInteraction()}getDelegate(ie=!1){if(this.workingDelegate&&!ie)return{delegate:this.workingDelegate,inline:this.inline};const we=this.inline=null!==this.el.parentNode&&!this.hasController;return{inline:we,delegate:this.workingDelegate=we?this.delegate||this.coreDelegate:this.delegate}}present(){var ie=this;return(0,d.Z)(function*(){if(ie.presented)return;void 0!==ie.currentTransition&&(yield ie.currentTransition);const ue=Object.assign(Object.assign({},ie.componentProps),{modal:ie.el}),{inline:we,delegate:Oe}=ie.getDelegate(!0);ie.usersElement=yield(0,Z.a)(Oe,ie.el,ie.component,["ion-page"],ue,we),yield(0,te.e)(ie.usersElement),(0,c.c)(()=>ie.el.classList.add("show-modal")),ie.currentTransition=Wi(ie,"modalEnter",ir,mr,{presentingEl:ie.presentingElement,currentBreakpoint:ie.initialBreakpoint,backdropBreakpoint:ie.backdropBreakpoint}),yield ie.currentTransition,ie.isSheetModal?ie.initSheetGesture():ie.swipeToClose&&ie.initSwipeToClose(),"undefined"!=typeof window&&(ie.keyboardOpenCallback=()=>{ie.gesture&&(ie.gesture.enable(!1),(0,z.r)(()=>{ie.gesture&&ie.gesture.enable(!0)}))},window.addEventListener(G.KEYBOARD_DID_OPEN,ie.keyboardOpenCallback)),ie.currentTransition=void 0})()}initSwipeToClose(){var ie=this;if("ios"!==(0,V.b)(this))return;const ue=this.leaveAnimation||V.c.get("modalLeave",er),we=this.animation=ue(this.el,{presentingEl:this.presentingElement});this.gesture=((ie,ue,we)=>{const Oe=ie.offsetHeight;let Dt=!1;const oi=(0,O.createGesture)({el:ie,gestureName:"modalSwipeToClose",gesturePriority:40,direction:"y",threshold:10,canStart:Pi=>{const Mi=Pi.event.target;return null===Mi||!Mi.closest||null===Mi.closest("ion-content, ion-footer")},onStart:()=>{ue.progressStart(!0,Dt?1:0)},onMove:Pi=>{const Mi=(0,z.d)(1e-4,Pi.deltaY/Oe,.9999);ue.progressStep(Mi)},onEnd:Pi=>{const Mi=Pi.velocityY,bi=(0,z.d)(1e-4,Pi.deltaY/Oe,.9999),Di=(Pi.deltaY+1e3*Mi)/Oe>=.5;let Ci=Di?-.001:.001;Di?(ue.easing("cubic-bezier(0.32, 0.72, 0, 1)"),Ci+=(0,ye.g)([0,0],[.32,.72],[0,1],[1,1],bi)[0]):(ue.easing("cubic-bezier(1, 0, 0.68, 0.28)"),Ci+=(0,ye.g)([0,0],[1,0],[.68,.28],[1,1],bi)[0]);const dr=((ie,ue)=>(0,z.d)(400,ie/Math.abs(1.1*ue),500))(Di?bi*Oe:(1-bi)*Oe,Mi);Dt=Di,oi.enable(!1),ue.onFinish(()=>{Di||oi.enable(!0)}).progressEnd(Di?1:0,Ci,dr),Di&&we()}});return oi})(this.el,we,()=>{this.gestureAnimationDismissing=!0,this.animation.onFinish((0,d.Z)(function*(){yield ie.dismiss(void 0,"gesture"),ie.gestureAnimationDismissing=!1}))}),this.gesture.enable(!0)}initSheetGesture(){var ue,ie=this;const{wrapperEl:we,initialBreakpoint:Oe,backdropBreakpoint:Dt}=this;if(!we||void 0===Oe)return;const ht=this.enterAnimation||V.c.get("modalEnter",ir),fn=this.animation=ht(this.el,{presentingEl:this.presentingElement,currentBreakpoint:Oe,backdropBreakpoint:Dt});fn.progressStart(!0,1);const Dn=(null===(ue=this.breakpoints)||void 0===ue?void 0:ue.sort((yn,oi)=>yn-oi))||[];this.gesture=((ie,ue,we,Oe,Dt,ht,fn=[],Dn,yn)=>{const Mi={WRAPPER_KEYFRAMES:[{offset:0,transform:"translateY(0%)"},{offset:1,transform:"translateY(100%)"}],BACKDROP_KEYFRAMES:0!==Dt?[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1-Dt,opacity:0},{offset:1,opacity:0}]:[{offset:0,opacity:"var(--backdrop-opacity)"},{offset:1,opacity:.01}]},bi=ie.querySelector("ion-content"),gr=we.clientHeight;let Di=Oe,Ci=0;const dr=ht.childAnimations.find(Ce=>"wrapperAnimation"===Ce.id),nr=ht.childAnimations.find(Ce=>"backdropAnimation"===Ce.id),io=fn[fn.length-1];dr&&nr&&(dr.keyframes([...Mi.WRAPPER_KEYFRAMES]),nr.keyframes([...Mi.BACKDROP_KEYFRAMES]),ht.progressStart(!0,1-Di),ue.style.setProperty("pointer-events",Di>Dt?"auto":"none")),bi&&Di!==io&&(bi.scrollY=!1);const se=(0,O.createGesture)({el:we,gestureName:"modalSheet",gesturePriority:40,direction:"y",threshold:10,canStart:Ce=>{const ae=Ce.event.target.closest("ion-content");return!(1===Di&&ae)},onStart:()=>{bi&&(bi.scrollY=!1),(0,z.r)(()=>{ie.focus()}),ht.progressStart(!0,1-Di)},onMove:Ce=>{Ci=(0,z.d)(1e-4,1-Di+Ce.deltaY/gr,.9999),ht.progressStep(Ci)},onEnd:Ce=>{const St=Di-(Ce.deltaY+100*Ce.velocityY)/gr,tn=fn.reduce((Yn,Mr)=>Math.abs(Mr-St)<Math.abs(Yn-St)?Mr:Yn),Ln=0!==tn;Di=0,dr&&nr&&(dr.keyframes([{offset:0,transform:`translateY(${100*Ci}%)`},{offset:1,transform:`translateY(${100*(1-tn)}%)`}]),nr.keyframes([{offset:0,opacity:`calc(var(--backdrop-opacity) * ${Hn(1-Ci,Dt)})`},{offset:1,opacity:`calc(var(--backdrop-opacity) * ${Hn(tn,Dt)})`}]),ht.progressStep(0)),se.enable(!1),ht.onFinish(()=>{Ln&&(dr&&nr?(0,z.r)(()=>{dr.keyframes([...Mi.WRAPPER_KEYFRAMES]),nr.keyframes([...Mi.BACKDROP_KEYFRAMES]),ht.progressStart(!0,1-tn),Di=tn,yn(Di),bi&&Di===fn[fn.length-1]&&(bi.scrollY=!0),ue.style.setProperty("pointer-events",Di>Dt?"auto":"none"),se.enable(!0)}):se.enable(!0))},{oneTimeCallback:!0}).progressEnd(1,0,500),Ln||Dn()}});return se})(this.el,this.backdropEl,we,Oe,Dt,fn,Dn,()=>{this.gestureAnimationDismissing=!0,this.animation.onFinish((0,d.Z)(function*(){yield ie.dismiss(void 0,"gesture"),ie.gestureAnimationDismissing=!1}))},yn=>{this.currentBreakpoint=yn}),this.gesture.enable(!0)}dismiss(ie,ue){var we=this;return(0,d.Z)(function*(){if(we.gestureAnimationDismissing&&"gesture"!==ue)return!1;"undefined"!=typeof window&&we.keyboardOpenCallback&&window.removeEventListener(G.KEYBOARD_DID_OPEN,we.keyboardOpenCallback),void 0!==we.currentTransition&&(yield we.currentTransition);const Oe=Sr.get(we)||[];we.currentTransition=wo(we,ie,ue,"modalLeave",er,ki,{presentingEl:we.presentingElement,currentBreakpoint:we.currentBreakpoint||we.initialBreakpoint,backdropBreakpoint:we.backdropBreakpoint});const Dt=yield we.currentTransition;if(Dt){const{delegate:ht}=we.getDelegate();yield(0,Z.d)(ht,we.usersElement),we.animation&&we.animation.destroy(),we.gesture&&we.gesture.destroy(),Oe.forEach(fn=>fn.destroy())}return we.currentTransition=void 0,we.animation=void 0,Dt})()}onDidDismiss(){return ke(this.el,"ionModalDidDismiss")}onWillDismiss(){return ke(this.el,"ionModalWillDismiss")}render(){const{handle:ie,isSheetModal:ue,presentingElement:we,htmlAttributes:Oe}=this,Dt=!1!==ie&&ue,ht=(0,V.b)(this),{presented:fn,modalId:Dn}=this,yn=void 0!==we&&"ios"===ht;return(0,c.h)(c.H,Object.assign({"no-router":!0,"aria-modal":"true",tabindex:"-1"},Oe,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[ht]:!0,"modal-default":!yn&&!ue,"modal-card":yn,"modal-sheet":ue,"overlay-hidden":!0,"modal-interactive":fn},(0,p.g)(this.cssClass)),id:Dn,onIonBackdropTap:this.onBackdropTap,onIonDismiss:this.onDismiss,onIonModalDidPresent:this.onLifecycle,onIonModalWillPresent:this.onLifecycle,onIonModalWillDismiss:this.onLifecycle,onIonModalDidDismiss:this.onLifecycle}),(0,c.h)("ion-backdrop",{ref:oi=>this.backdropEl=oi,visible:this.showBackdrop,tappable:this.backdropDismiss,part:"backdrop"}),"ios"===ht&&(0,c.h)("div",{class:"modal-shadow"}),(0,c.h)("div",{role:"dialog",class:"modal-wrapper ion-overlay-wrapper",part:"content",ref:oi=>this.wrapperEl=oi},Dt&&(0,c.h)("div",{class:"modal-handle",part:"handle"}),(0,c.h)("slot",null)))}get el(){return(0,c.i)(this)}static get watchers(){return{isOpen:["onIsOpenChange"],trigger:["onTriggerChange"],swipeToClose:["swipeToCloseChanged"]}}};const ft={ionModalDidPresent:"ionViewDidEnter",ionModalWillPresent:"ionViewWillEnter",ionModalWillDismiss:"ionViewWillLeave",ionModalDidDismiss:"ionViewDidLeave"};let Be=0;Pe.style={ios:":host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;contain:strict;pointer-events:none}:host(.modal-interactive) .modal-wrapper,:host(.modal-interactive) ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;margin-left:auto;margin-right:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);background:var(--ion-color-step-350, #c0c0be);z-index:11}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.modal-handle{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.4)}:host(.modal-card),:host(.modal-sheet){--border-radius:10px}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:10px}}.modal-wrapper{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0)}@media screen and (max-width: 767px){@supports (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - max(30px, var(--ion-safe-area-top)) - 10px)}}@supports not (width: max(0px, 1px)){:host(.modal-card){--height:calc(100% - 40px)}}:host(.modal-card) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-card) .modal-wrapper,:host-context([dir=rtl]).modal-card .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host(.modal-card){--backdrop-opacity:0;--width:100%;-ms-flex-align:end;align-items:flex-end}:host(.modal-card) .modal-shadow{display:none}:host(.modal-card) ion-backdrop{pointer-events:none}}@media screen and (min-width: 768px){:host(.modal-card){--width:calc(100% - 120px);--height:calc(100% - (120px + var(--ion-safe-area-top) + var(--ion-safe-area-bottom)));--max-width:720px;--max-height:1000px;--backdrop-opacity:0;--box-shadow:0px 0px 30px 10px rgba(0, 0, 0, 0.1);-webkit-transition:all 0.5s ease-in-out;transition:all 0.5s ease-in-out}:host(.modal-card) .modal-wrapper{-webkit-box-shadow:none;box-shadow:none}:host(.modal-card) .modal-shadow{-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}}:host(.modal-sheet) .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}:host-context([dir=rtl]):host(.modal-sheet) .modal-wrapper,:host-context([dir=rtl]).modal-sheet .modal-wrapper{border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-bottom-right-radius:0;border-bottom-left-radius:0}",md:":host{--width:100%;--min-width:auto;--max-width:auto;--height:100%;--min-height:auto;--max-height:auto;--overflow:hidden;--border-radius:0;--border-width:0;--border-style:none;--border-color:transparent;--background:var(--ion-background-color, #fff);--box-shadow:none;--backdrop-opacity:0;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:absolute;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;contain:strict;pointer-events:none}:host(.modal-interactive) .modal-wrapper,:host(.modal-interactive) ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.modal-wrapper,.modal-shadow{border-radius:var(--border-radius);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:var(--overflow);z-index:10}.modal-shadow{position:absolute;background:transparent}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--width:600px;--height:500px;--ion-safe-area-top:0px;--ion-safe-area-bottom:0px;--ion-safe-area-right:0px;--ion-safe-area-left:0px}}@media only screen and (min-width: 768px) and (min-height: 768px){:host{--width:600px;--height:600px}}.modal-handle{left:0px;right:0px;top:5px;border-radius:8px;margin-left:auto;margin-right:auto;position:absolute;width:36px;height:5px;-webkit-transform:translateZ(0);transform:translateZ(0);background:var(--ion-color-step-350, #c0c0be);z-index:11}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.modal-handle{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}:host(.modal-sheet){--height:calc(100% - (var(--ion-safe-area-top) + 10px))}:host(.modal-sheet) .modal-wrapper,:host(.modal-sheet) .modal-shadow{position:absolute;bottom:0}:host{--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}@media only screen and (min-width: 768px) and (min-height: 600px){:host{--border-radius:2px;--box-shadow:0 28px 48px rgba(0, 0, 0, 0.4)}}.modal-wrapper{-webkit-transform:translate3d(0,  40px,  0);transform:translate3d(0,  40px,  0);opacity:0.01}"};let Ie=class{constructor(ie){(0,c.r)(this,ie),this.ionPickerColChange=(0,c.e)(this,"ionPickerColChange",7),this.optHeight=0,this.rotateFactor=0,this.scaleFactor=1,this.velocity=0,this.y=0,this.noAnimate=!0}colChanged(){this.refresh()}connectedCallback(){var ie=this;return(0,d.Z)(function*(){let ue=0,we=.81;"ios"===(0,V.b)(ie)&&(ue=-.46,we=1),ie.rotateFactor=ue,ie.scaleFactor=we,ie.gesture=(yield Promise.resolve().then(k.bind(k,1363))).createGesture({el:ie.el,gestureName:"picker-swipe",gesturePriority:100,threshold:0,passive:!1,onStart:Dt=>ie.onStart(Dt),onMove:Dt=>ie.onMove(Dt),onEnd:Dt=>ie.onEnd(Dt)}),ie.gesture.enable(),ie.tmrId=setTimeout(()=>{ie.noAnimate=!1,ie.refresh(!0)},250)})()}componentDidLoad(){const ie=this.optsEl;ie&&(this.optHeight=ie.firstElementChild?ie.firstElementChild.clientHeight:0),this.refresh()}disconnectedCallback(){cancelAnimationFrame(this.rafId),clearTimeout(this.tmrId),this.gesture&&(this.gesture.destroy(),this.gesture=void 0)}emitColChange(){this.ionPickerColChange.emit(this.col)}setSelected(ie,ue){const we=ie>-1?-ie*this.optHeight:0;this.velocity=0,cancelAnimationFrame(this.rafId),this.update(we,ue,!0),this.emitColChange()}update(ie,ue,we){if(!this.optsEl)return;let Oe=0,Dt=0;const{col:ht,rotateFactor:fn}=this,Dn=ht.selectedIndex=this.indexForY(-ie),yn=0===ue?"":ue+"ms",oi=`scale(${this.scaleFactor})`,Pi=this.optsEl.children;for(let Mi=0;Mi<Pi.length;Mi++){const bi=Pi[Mi],gr=ht.options[Mi],Di=Mi*this.optHeight+ie;let Ci="";if(0!==fn){const nr=Di*fn;Math.abs(nr)<=90?(Oe=0,Dt=90,Ci=`rotateX(${nr}deg) `):Oe=-9999}else Dt=0,Oe=Di;const dr=Dn===Mi;Ci+=`translate3d(0px,${Oe}px,${Dt}px) `,1!==this.scaleFactor&&!dr&&(Ci+=oi),this.noAnimate?(gr.duration=0,bi.style.transitionDuration=""):ue!==gr.duration&&(gr.duration=ue,bi.style.transitionDuration=yn),Ci!==gr.transform&&(gr.transform=Ci,bi.style.transform=Ci),dr!==gr.selected&&(gr.selected=dr,dr?bi.classList.add(Ut):bi.classList.remove(Ut))}this.col.prevSelected=Dn,we&&(this.y=ie),this.lastIndex!==Dn&&((0,a.b)(),this.lastIndex=Dn)}decelerate(){if(0!==this.velocity){this.velocity*=nn,this.velocity=this.velocity>0?Math.max(this.velocity,1):Math.min(this.velocity,-1);let ie=this.y+this.velocity;ie>this.minY?(ie=this.minY,this.velocity=0):ie<this.maxY&&(ie=this.maxY,this.velocity=0),this.update(ie,0,!0),Math.round(ie)%this.optHeight!=0||Math.abs(this.velocity)>1?this.rafId=requestAnimationFrame(()=>this.decelerate()):(this.velocity=0,this.emitColChange(),(0,a.h)())}else if(this.y%this.optHeight!=0){const ie=Math.abs(this.y%this.optHeight);this.velocity=ie>this.optHeight/2?1:-1,this.decelerate()}}indexForY(ie){return Math.min(Math.max(Math.abs(Math.round(ie/this.optHeight)),0),this.col.options.length-1)}onStart(ie){ie.event.cancelable&&ie.event.preventDefault(),ie.event.stopPropagation(),(0,a.a)(),cancelAnimationFrame(this.rafId);const ue=this.col.options;let we=ue.length-1,Oe=0;for(let Dt=0;Dt<ue.length;Dt++)ue[Dt].disabled||(we=Math.min(we,Dt),Oe=Math.max(Oe,Dt));this.minY=-we*this.optHeight,this.maxY=-Oe*this.optHeight}onMove(ie){ie.event.cancelable&&ie.event.preventDefault(),ie.event.stopPropagation();let ue=this.y+ie.deltaY;ue>this.minY?(ue=Math.pow(ue,.8),this.bounceFrom=ue):ue<this.maxY?(ue+=Math.pow(this.maxY-ue,.9),this.bounceFrom=ue):this.bounceFrom=0,this.update(ue,0,!1)}onEnd(ie){if(this.bounceFrom>0)return this.update(this.minY,100,!0),void this.emitColChange();if(this.bounceFrom<0)return this.update(this.maxY,100,!0),void this.emitColChange();if(this.velocity=(0,z.d)(-ni,23*ie.velocityY,ni),0===this.velocity&&0===ie.deltaY){const ue=ie.event.target.closest(".picker-opt");ue&&ue.hasAttribute("opt-index")&&this.setSelected(parseInt(ue.getAttribute("opt-index"),10),cr)}else{if(this.y+=ie.deltaY,Math.abs(ie.velocityY)<.05){const ue=ie.deltaY>0,we=Math.abs(this.y)%this.optHeight/this.optHeight;ue&&we>.5?this.velocity=-1*Math.abs(this.velocity):!ue&&we<=.5&&(this.velocity=Math.abs(this.velocity))}this.decelerate()}}refresh(ie){let ue=this.col.options.length-1,we=0;const Oe=this.col.options;for(let ht=0;ht<Oe.length;ht++)Oe[ht].disabled||(ue=Math.min(ue,ht),we=Math.max(we,ht));if(0!==this.velocity)return;const Dt=(0,z.d)(ue,this.col.selectedIndex||0,we);if(this.col.prevSelected!==Dt||ie){const ht=Dt*this.optHeight*-1;this.velocity=0,this.update(ht,cr,!0)}}render(){const ie=this.col,we=(0,V.b)(this);return(0,c.h)(c.H,{class:{[we]:!0,"picker-col":!0,"picker-opts-left":"left"===this.col.align,"picker-opts-right":"right"===this.col.align},style:{"max-width":this.col.columnWidth}},ie.prefix&&(0,c.h)("div",{class:"picker-prefix",style:{width:ie.prefixWidth}},ie.prefix),(0,c.h)("div",{class:"picker-opts",style:{maxWidth:ie.optionsWidth},ref:Oe=>this.optsEl=Oe},ie.options.map((Oe,Dt)=>(0,c.h)("button",{type:"button",class:{"picker-opt":!0,"picker-opt-disabled":!!Oe.disabled},"opt-index":Dt},Oe.text))),ie.suffix&&(0,c.h)("div",{class:"picker-suffix",style:{width:ie.suffixWidth}},ie.suffix))}get el(){return(0,c.i)(this)}static get watchers(){return{col:["colChanged"]}}};const Ut="picker-opt-selected",nn=.97,ni=90,cr=150;Ie.style={ios:".picker-col{display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-box-sizing:content-box;box-sizing:content-box;contain:content}.picker-opts{position:relative;-ms-flex:1;flex:1;max-width:100%}.picker-opt{left:0;top:0;display:block;position:absolute;width:100%;border:0;text-align:center;text-overflow:ellipsis;white-space:nowrap;contain:strict;overflow:hidden;will-change:transform}[dir=rtl] .picker-opt,:host-context([dir=rtl]) .picker-opt{left:unset;right:unset;right:0}.picker-opt.picker-opt-disabled{pointer-events:none}.picker-opt-disabled{opacity:0}.picker-opts-left{-ms-flex-pack:start;justify-content:flex-start}.picker-opts-right{-ms-flex-pack:end;justify-content:flex-end}.picker-opt:active,.picker-opt:focus{outline:none}.picker-prefix{position:relative;-ms-flex:1;flex:1;text-align:end;white-space:nowrap}.picker-suffix{position:relative;-ms-flex:1;flex:1;text-align:start;white-space:nowrap}.picker-col{padding-left:4px;padding-right:4px;padding-top:0;padding-bottom:0;-webkit-transform-style:preserve-3d;transform-style:preserve-3d}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-col{padding-left:unset;padding-right:unset;-webkit-padding-start:4px;padding-inline-start:4px;-webkit-padding-end:4px;padding-inline-end:4px}}.picker-prefix,.picker-suffix,.picker-opts{top:77px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;color:inherit;font-size:20px;line-height:42px;pointer-events:none}.picker-opt{padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;-webkit-transform-origin:center center;transform-origin:center center;height:46px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;background:transparent;color:inherit;font-size:20px;line-height:42px;-webkit-backface-visibility:hidden;backface-visibility:hidden;pointer-events:auto}[dir=rtl] .picker-opt,:host-context([dir=rtl]) .picker-opt{-webkit-transform-origin:calc(100% - center) center;transform-origin:calc(100% - center) center}",md:".picker-col{display:-ms-flexbox;display:flex;position:relative;-ms-flex:1;flex:1;-ms-flex-pack:center;justify-content:center;height:100%;-webkit-box-sizing:content-box;box-sizing:content-box;contain:content}.picker-opts{position:relative;-ms-flex:1;flex:1;max-width:100%}.picker-opt{left:0;top:0;display:block;position:absolute;width:100%;border:0;text-align:center;text-overflow:ellipsis;white-space:nowrap;contain:strict;overflow:hidden;will-change:transform}[dir=rtl] .picker-opt,:host-context([dir=rtl]) .picker-opt{left:unset;right:unset;right:0}.picker-opt.picker-opt-disabled{pointer-events:none}.picker-opt-disabled{opacity:0}.picker-opts-left{-ms-flex-pack:start;justify-content:flex-start}.picker-opts-right{-ms-flex-pack:end;justify-content:flex-end}.picker-opt:active,.picker-opt:focus{outline:none}.picker-prefix{position:relative;-ms-flex:1;flex:1;text-align:end;white-space:nowrap}.picker-suffix{position:relative;-ms-flex:1;flex:1;text-align:start;white-space:nowrap}.picker-col{padding-left:8px;padding-right:8px;padding-top:0;padding-bottom:0;-webkit-transform-style:preserve-3d;transform-style:preserve-3d}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-col{padding-left:unset;padding-right:unset;-webkit-padding-start:8px;padding-inline-start:8px;-webkit-padding-end:8px;padding-inline-end:8px}}.picker-prefix,.picker-suffix,.picker-opts{top:77px;-webkit-transform-style:preserve-3d;transform-style:preserve-3d;color:inherit;font-size:22px;line-height:42px;pointer-events:none}.picker-opt{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:0;padding-right:0;padding-top:0;padding-bottom:0;height:43px;-webkit-transition-timing-function:ease-out;transition-timing-function:ease-out;background:transparent;color:inherit;font-size:22px;line-height:42px;-webkit-backface-visibility:hidden;backface-visibility:hidden;pointer-events:auto}.picker-prefix,.picker-suffix,.picker-opt.picker-opt-selected{color:var(--ion-color-primary, #3880ff)}"};const Li=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),Oe.addElement(ie.querySelector(".picker-wrapper")).fromTo("transform","translateY(100%)","translateY(0%)"),ue.addElement(ie).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([we,Oe])},Ei=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Oe=(0,L.c)();return we.addElement(ie.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",.01),Oe.addElement(ie.querySelector(".picker-wrapper")).fromTo("transform","translateY(0%)","translateY(100%)"),ue.addElement(ie).easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation([we,Oe])};let ji=class{constructor(ie){(0,c.r)(this,ie),this.didPresent=(0,c.e)(this,"ionPickerDidPresent",7),this.willPresent=(0,c.e)(this,"ionPickerWillPresent",7),this.willDismiss=(0,c.e)(this,"ionPickerWillDismiss",7),this.didDismiss=(0,c.e)(this,"ionPickerDidDismiss",7),this.presented=!1,this.keyboardClose=!0,this.buttons=[],this.columns=[],this.duration=0,this.showBackdrop=!0,this.backdropDismiss=!0,this.animated=!0,this.onBackdropTap=()=>{this.dismiss(void 0,Ur)},this.dispatchCancelHandler=ue=>{if(en(ue.detail.role)){const Oe=this.buttons.find(Dt=>"cancel"===Dt.role);this.callButtonHandler(Oe)}}}connectedCallback(){un(this.el)}present(){var ie=this;return(0,d.Z)(function*(){yield Wi(ie,"pickerEnter",Li,Li,void 0),ie.duration>0&&(ie.durationTimeout=setTimeout(()=>ie.dismiss(),ie.duration))})()}dismiss(ie,ue){return this.durationTimeout&&clearTimeout(this.durationTimeout),wo(this,ie,ue,"pickerLeave",Ei,Ei)}onDidDismiss(){return ke(this.el,"ionPickerDidDismiss")}onWillDismiss(){return ke(this.el,"ionPickerWillDismiss")}getColumn(ie){return Promise.resolve(this.columns.find(ue=>ue.name===ie))}buttonClick(ie){var ue=this;return(0,d.Z)(function*(){const we=ie.role;return en(we)?ue.dismiss(void 0,we):(yield ue.callButtonHandler(ie))?ue.dismiss(ue.getSelected(),ie.role):Promise.resolve()})()}callButtonHandler(ie){var ue=this;return(0,d.Z)(function*(){return!(ie&&!1===(yield fi(ie.handler,ue.getSelected())))})()}getSelected(){const ie={};return this.columns.forEach((ue,we)=>{const Oe=void 0!==ue.selectedIndex?ue.options[ue.selectedIndex]:void 0;ie[ue.name]={text:Oe?Oe.text:void 0,value:Oe?Oe.value:void 0,columnIndex:we}}),ie}render(){const{htmlAttributes:ie}=this,ue=(0,V.b)(this);return(0,c.h)(c.H,Object.assign({"aria-modal":"true",tabindex:"-1"},ie,{style:{zIndex:`${2e4+this.overlayIndex}`},class:Object.assign({[ue]:!0,[`picker-${ue}`]:!0,"overlay-hidden":!0},(0,p.g)(this.cssClass)),onIonBackdropTap:this.onBackdropTap,onIonPickerWillDismiss:this.dispatchCancelHandler}),(0,c.h)("ion-backdrop",{visible:this.showBackdrop,tappable:this.backdropDismiss}),(0,c.h)("div",{tabindex:"0"}),(0,c.h)("div",{class:"picker-wrapper ion-overlay-wrapper",role:"dialog"},(0,c.h)("div",{class:"picker-toolbar"},this.buttons.map(we=>(0,c.h)("div",{class:Ir(we)},(0,c.h)("button",{type:"button",onClick:()=>this.buttonClick(we),class:$i(we)},we.text)))),(0,c.h)("div",{class:"picker-columns"},(0,c.h)("div",{class:"picker-above-highlight"}),this.presented&&this.columns.map(we=>(0,c.h)("ion-picker-column",{col:we})),(0,c.h)("div",{class:"picker-below-highlight"}))),(0,c.h)("div",{tabindex:"0"}))}get el(){return(0,c.i)(this)}};const Ir=ie=>({[`picker-toolbar-${ie.role}`]:void 0!==ie.role,"picker-toolbar-button":!0}),$i=ie=>Object.assign({"picker-button":!0,"ion-activatable":!0},(0,p.g)(ie.cssClass));ji.style={ios:".sc-ion-picker-ios-h{--border-radius:0;--border-style:solid;--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--max-height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;font-family:var(--ion-font-family, inherit);contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}[dir=rtl].sc-ion-picker-ios-h,[dir=rtl] .sc-ion-picker-ios-h{left:unset;right:unset;right:0}.overlay-hidden.sc-ion-picker-ios-h{display:none}.picker-wrapper.sc-ion-picker-ios{border-radius:var(--border-radius);left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);contain:strict;overflow:hidden;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-wrapper.sc-ion-picker-ios{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.picker-toolbar.sc-ion-picker-ios{width:100%;background:transparent;contain:strict;z-index:1}.picker-button.sc-ion-picker-ios{border:0;font-family:inherit}.picker-button.sc-ion-picker-ios:active,.picker-button.sc-ion-picker-ios:focus{outline:none}.picker-columns.sc-ion-picker-ios{display:-ms-flexbox;display:flex;position:relative;-ms-flex-pack:center;justify-content:center;margin-bottom:var(--ion-safe-area-bottom, 0);contain:strict;direction:ltr;overflow:hidden}.picker-above-highlight.sc-ion-picker-ios,.picker-below-highlight.sc-ion-picker-ios{display:none;pointer-events:none}.sc-ion-picker-ios-h{--background:var(--ion-background-color, #fff);--border-width:1px 0 0;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-250, #c8c7cc)));--height:260px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.26);color:var(--ion-item-color, var(--ion-text-color, #000))}.picker-toolbar.sc-ion-picker-ios{display:-ms-flexbox;display:flex;height:44px;border-bottom:0.55px solid var(--border-color)}.picker-toolbar-button.sc-ion-picker-ios{-ms-flex:1;flex:1;text-align:end}.picker-toolbar-button.sc-ion-picker-ios:last-child .picker-button.sc-ion-picker-ios{font-weight:600}.picker-toolbar-button.sc-ion-picker-ios:first-child{font-weight:normal;text-align:start}.picker-button.sc-ion-picker-ios,.picker-button.ion-activated.sc-ion-picker-ios{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:1em;padding-right:1em;padding-top:0;padding-bottom:0;height:44px;background:transparent;color:var(--ion-color-primary, #3880ff);font-size:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-button.sc-ion-picker-ios,.picker-button.ion-activated.sc-ion-picker-ios{padding-left:unset;padding-right:unset;-webkit-padding-start:1em;padding-inline-start:1em;-webkit-padding-end:1em;padding-inline-end:1em}}.picker-columns.sc-ion-picker-ios{height:215px;-webkit-perspective:1000px;perspective:1000px}.picker-above-highlight.sc-ion-picker-ios{left:0;top:0;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);display:block;position:absolute;width:100%;height:81px;border-bottom:1px solid var(--border-color);background:-webkit-gradient(linear, left top, left bottom, color-stop(20%, var(--background, var(--ion-background-color, #fff))), to(rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8)));background:linear-gradient(to bottom, var(--background, var(--ion-background-color, #fff)) 20%, rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8) 100%);z-index:10}[dir=rtl].sc-ion-picker-ios .picker-above-highlight.sc-ion-picker-ios,[dir=rtl].sc-ion-picker-ios-h .picker-above-highlight.sc-ion-picker-ios,[dir=rtl] .sc-ion-picker-ios-h .picker-above-highlight.sc-ion-picker-ios{left:unset;right:unset;right:0}.picker-below-highlight.sc-ion-picker-ios{left:0;top:115px;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);display:block;position:absolute;width:100%;height:119px;border-top:1px solid var(--border-color);background:-webkit-gradient(linear, left bottom, left top, color-stop(30%, var(--background, var(--ion-background-color, #fff))), to(rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8)));background:linear-gradient(to top, var(--background, var(--ion-background-color, #fff)) 30%, rgba(var(--background-rgb, var(--ion-background-color-rgb, 255, 255, 255)), 0.8) 100%);z-index:11}[dir=rtl].sc-ion-picker-ios .picker-below-highlight.sc-ion-picker-ios,[dir=rtl].sc-ion-picker-ios-h .picker-below-highlight.sc-ion-picker-ios,[dir=rtl] .sc-ion-picker-ios-h .picker-below-highlight.sc-ion-picker-ios{left:unset;right:unset;right:0}",md:".sc-ion-picker-md-h{--border-radius:0;--border-style:solid;--min-width:auto;--width:100%;--max-width:500px;--min-height:auto;--max-height:auto;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;left:0;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;font-family:var(--ion-font-family, inherit);contain:strict;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;z-index:1001}[dir=rtl].sc-ion-picker-md-h,[dir=rtl] .sc-ion-picker-md-h{left:unset;right:unset;right:0}.overlay-hidden.sc-ion-picker-md-h{display:none}.picker-wrapper.sc-ion-picker-md{border-radius:var(--border-radius);left:0;right:0;bottom:0;margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);contain:strict;overflow:hidden;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-wrapper.sc-ion-picker-md{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.picker-toolbar.sc-ion-picker-md{width:100%;background:transparent;contain:strict;z-index:1}.picker-button.sc-ion-picker-md{border:0;font-family:inherit}.picker-button.sc-ion-picker-md:active,.picker-button.sc-ion-picker-md:focus{outline:none}.picker-columns.sc-ion-picker-md{display:-ms-flexbox;display:flex;position:relative;-ms-flex-pack:center;justify-content:center;margin-bottom:var(--ion-safe-area-bottom, 0);contain:strict;direction:ltr;overflow:hidden}.picker-above-highlight.sc-ion-picker-md,.picker-below-highlight.sc-ion-picker-md{display:none;pointer-events:none}.sc-ion-picker-md-h{--background:var(--ion-background-color, #fff);--border-width:0.55px 0 0;--border-color:var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));--height:260px;--backdrop-opacity:var(--ion-backdrop-opacity, 0.26);color:var(--ion-item-color, var(--ion-text-color, #000))}.picker-toolbar.sc-ion-picker-md{display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end;height:44px}.picker-button.sc-ion-picker-md,.picker-button.ion-activated.sc-ion-picker-md{margin-left:0;margin-right:0;margin-top:0;margin-bottom:0;padding-left:1.1em;padding-right:1.1em;padding-top:0;padding-bottom:0;height:44px;background:transparent;color:var(--ion-color-primary, #3880ff);font-size:14px;font-weight:500;text-transform:uppercase;-webkit-box-shadow:none;box-shadow:none}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.picker-button.sc-ion-picker-md,.picker-button.ion-activated.sc-ion-picker-md{padding-left:unset;padding-right:unset;-webkit-padding-start:1.1em;padding-inline-start:1.1em;-webkit-padding-end:1.1em;padding-inline-end:1.1em}}.picker-columns.sc-ion-picker-md{height:216px;-webkit-perspective:1800px;perspective:1800px}.picker-above-highlight.sc-ion-picker-md{left:0;top:0;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);position:absolute;width:100%;height:81px;border-bottom:1px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));background:-webkit-gradient(linear, left top, left bottom, color-stop(20%, var(--ion-background-color, #fff)), to(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)));background:linear-gradient(to bottom, var(--ion-background-color, #fff) 20%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 100%);z-index:10}[dir=rtl].sc-ion-picker-md .picker-above-highlight.sc-ion-picker-md,[dir=rtl].sc-ion-picker-md-h .picker-above-highlight.sc-ion-picker-md,[dir=rtl] .sc-ion-picker-md-h .picker-above-highlight.sc-ion-picker-md{left:unset;right:unset;right:0}.picker-below-highlight.sc-ion-picker-md{left:0;top:115px;-webkit-transform:translate3d(0,  0,  90px);transform:translate3d(0,  0,  90px);position:absolute;width:100%;height:119px;border-top:1px solid var(--ion-item-border-color, var(--ion-border-color, var(--ion-color-step-150, rgba(0, 0, 0, 0.13))));background:-webkit-gradient(linear, left bottom, left top, color-stop(30%, var(--ion-background-color, #fff)), to(rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8)));background:linear-gradient(to top, var(--ion-background-color, #fff) 30%, rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8) 100%);z-index:11}[dir=rtl].sc-ion-picker-md .picker-below-highlight.sc-ion-picker-md,[dir=rtl].sc-ion-picker-md-h .picker-below-highlight.sc-ion-picker-md,[dir=rtl] .sc-ion-picker-md-h .picker-below-highlight.sc-ion-picker-md{left:unset;right:unset;right:0}"};const eo=(ie,ue,we)=>{const Oe=ue.getBoundingClientRect(),Dt=Oe.height;let ht=Oe.width;return"cover"===ie&&we&&(ht=we.getBoundingClientRect().width),{contentWidth:ht,contentHeight:Dt}},Xi=(ie,ue,we)=>{let Oe=[];switch(ue){case"hover":let Dt;Oe=[{eventName:"mouseenter",callback:(ht=(0,d.Z)(function*(fn){fn.stopPropagation(),Dt&&clearTimeout(Dt),Dt=setTimeout(()=>{(0,z.r)(()=>{we.presentFromTrigger(fn),Dt=void 0})},100)}),function(Dn){return ht.apply(this,arguments)})},{eventName:"mouseleave",callback:ht=>{Dt&&clearTimeout(Dt);const fn=ht.relatedTarget;!fn||fn.closest("ion-popover")!==we&&we.dismiss(void 0,void 0,!1)}},{eventName:"click",callback:ht=>ht.stopPropagation()},{eventName:"ionPopoverActivateTrigger",callback:ht=>we.presentFromTrigger(ht,!0)}];break;case"context-menu":Oe=[{eventName:"contextmenu",callback:ht=>{ht.preventDefault(),we.presentFromTrigger(ht)}},{eventName:"click",callback:ht=>ht.stopPropagation()},{eventName:"ionPopoverActivateTrigger",callback:ht=>we.presentFromTrigger(ht,!0)}];break;default:Oe=[{eventName:"click",callback:ht=>we.presentFromTrigger(ht)},{eventName:"ionPopoverActivateTrigger",callback:ht=>we.presentFromTrigger(ht,!0)}]}var ht;return Oe.forEach(({eventName:Dt,callback:ht})=>ie.addEventListener(Dt,ht)),ie.setAttribute("data-ion-popover-trigger","true"),()=>{Oe.forEach(({eventName:Dt,callback:ht})=>ie.removeEventListener(Dt,ht)),ie.removeAttribute("data-ion-popover-trigger")}},ur=(ie,ue)=>ue&&"ION-ITEM"===ue.tagName?ie.findIndex(we=>we===ue):-1,F=ie=>{const we=(0,z.g)(ie).querySelector("button");we&&(0,z.r)(()=>we.focus())},_e=ie=>{const ue=function(){var we=(0,d.Z)(function*(Oe){const Dt=document.activeElement;let ht=[];try{ht=Array.from(ie.querySelectorAll("ion-item:not(ion-popover ion-popover *):not([disabled])"))}catch{}switch(Oe.key){case"ArrowLeft":(yield ie.getParentPopover())&&ie.dismiss(void 0,void 0,!1);break;case"ArrowDown":Oe.preventDefault();const Dn=((ie,ue)=>ie[ur(ie,ue)+1])(ht,Dt);void 0!==Dn&&F(Dn);break;case"ArrowUp":Oe.preventDefault();const yn=((ie,ue)=>ie[ur(ie,ue)-1])(ht,Dt);void 0!==yn&&F(yn);break;case"Home":Oe.preventDefault();const oi=ht[0];void 0!==oi&&F(oi);break;case"End":Oe.preventDefault();const Pi=ht[ht.length-1];void 0!==Pi&&F(Pi);break;case"ArrowRight":case" ":case"Enter":if(Dt&&(ie=>ie.hasAttribute("data-ion-popover-trigger"))(Dt)){const Mi=new CustomEvent("ionPopoverActivateTrigger");Dt.dispatchEvent(Mi)}}});return function(Dt){return we.apply(this,arguments)}}();return ie.addEventListener("keydown",ue),()=>ie.removeEventListener("keydown",ue)},Qe=(ie,ue,we,Oe,Dt,ht,fn,Dn,yn,oi,Pi)=>{var Mi;let bi={top:0,left:0,width:0,height:0};if("event"===ht){if(!Pi)return yn;bi={top:Pi.clientY,left:Pi.clientX,width:1,height:1}}else{const Wr=Pi,se=oi||(null===(Mi=null==Wr?void 0:Wr.detail)||void 0===Mi?void 0:Mi.ionShadowTarget)||(null==Wr?void 0:Wr.target);if(!se)return yn;const Ce=se.getBoundingClientRect();bi={top:Ce.top,left:Ce.left,width:Ce.width,height:Ce.height}}const gr=on(fn,bi,ue,we,Oe,Dt,ie),Di=sn(Dn,fn,bi,ue,we),Ci=gr.top+Di.top,dr=gr.left+Di.left,{arrowTop:nr,arrowLeft:io}=Zt(fn,Oe,Dt,Ci,dr,ue,we,ie),{originX:ho,originY:Hr}=vt(fn,Dn,ie);return{top:Ci,left:dr,referenceCoordinates:bi,arrowTop:nr,arrowLeft:io,originX:ho,originY:Hr}},vt=(ie,ue,we)=>{switch(ie){case"top":return{originX:kt(ue),originY:"bottom"};case"bottom":return{originX:kt(ue),originY:"top"};case"left":return{originX:"right",originY:tt(ue)};case"right":return{originX:"left",originY:tt(ue)};case"start":return{originX:we?"left":"right",originY:tt(ue)};case"end":return{originX:we?"right":"left",originY:tt(ue)}}},kt=ie=>{switch(ie){case"start":return"left";case"center":return"center";case"end":return"right"}},tt=ie=>{switch(ie){case"start":return"top";case"center":return"center";case"end":return"bottom"}},Zt=(ie,ue,we,Oe,Dt,ht,fn,Dn)=>{const yn={arrowTop:Oe+fn/2-ue/2,arrowLeft:Dt+ht-ue/2},oi={arrowTop:Oe+fn/2-ue/2,arrowLeft:Dt-1.5*ue};switch(ie){case"top":return{arrowTop:Oe+fn,arrowLeft:Dt+ht/2-ue/2};case"bottom":return{arrowTop:Oe-we,arrowLeft:Dt+ht/2-ue/2};case"left":return yn;case"right":return oi;case"start":return Dn?oi:yn;case"end":return Dn?yn:oi;default:return{arrowTop:0,arrowLeft:0}}},on=(ie,ue,we,Oe,Dt,ht,fn)=>{const Dn={top:ue.top,left:ue.left-we-Dt},yn={top:ue.top,left:ue.left+ue.width+Dt};switch(ie){case"top":return{top:ue.top-Oe-ht,left:ue.left};case"right":return yn;case"bottom":return{top:ue.top+ue.height+ht,left:ue.left};case"left":return Dn;case"start":return fn?yn:Dn;case"end":return fn?Dn:yn}},sn=(ie,ue,we,Oe,Dt)=>{switch(ie){case"center":return Nn(ue,we,Oe,Dt);case"end":return gn(ue,we,Oe,Dt);default:return{top:0,left:0}}},gn=(ie,ue,we,Oe)=>{switch(ie){case"start":case"end":case"left":case"right":return{top:-(Oe-ue.height),left:0};default:return{top:0,left:-(we-ue.width)}}},Nn=(ie,ue,we,Oe)=>{switch(ie){case"start":case"end":case"left":case"right":return{top:-(Oe/2-ue.height/2),left:0};default:return{top:0,left:-(we/2-ue.width/2)}}},Wn=(ie,ue,we,Oe,Dt,ht,fn,Dn,yn,oi,Pi,Mi,bi=0,gr=0,Di=0)=>{let ho,Ci=bi,nr=we,io=ue,Hr=oi,go=Pi,Wr=!1,se=!1;const Ce=Mi?Mi.top+Mi.height:ht/2-Dn/2,ae=Mi?Mi.height:0;let ze=!1;return nr<Oe+yn?(nr=Oe,Wr=!0,Hr="left"):fn+Oe+nr+yn>Dt&&(se=!0,nr=Dt-fn-Oe,Hr="right"),Ce+ae+Dn>ht&&("top"===ie||"bottom"===ie)&&(Ce-Dn>0?(io=Ce-Dn-ae-(Di-1),Ci=io+Dn,go="bottom",ze=!0):ho=Oe),{top:io,left:nr,bottom:ho,originX:Hr,originY:go,checkSafeAreaLeft:Wr,checkSafeAreaRight:se,arrowTop:Ci,arrowLeft:gr,addPopoverBottomClass:ze}},ui=(ie,ue)=>{var we;const{event:Oe,size:Dt,trigger:ht,reference:fn,side:Dn,align:yn}=ue,oi=ie.ownerDocument,Pi="rtl"===oi.dir,Mi=oi.defaultView.innerWidth,bi=oi.defaultView.innerHeight,gr=(0,z.g)(ie),Di=gr.querySelector(".popover-content"),Ci=gr.querySelector(".popover-arrow"),dr=ht||(null===(we=null==Oe?void 0:Oe.detail)||void 0===we?void 0:we.ionShadowTarget)||(null==Oe?void 0:Oe.target),{contentWidth:nr,contentHeight:io}=eo(Dt,Di,dr),{arrowWidth:ho,arrowHeight:Hr}=(ie=>{if(!ie)return{arrowWidth:0,arrowHeight:0};const{width:ue,height:we}=ie.getBoundingClientRect();return{arrowWidth:ue,arrowHeight:we}})(Ci),Wr=Qe(Pi,nr,io,ho,Hr,fn,Dn,yn,{top:bi/2-io/2,left:Mi/2-nr/2,originX:Pi?"right":"left",originY:"top"},ht,Oe),se="cover"===Dt?0:5,Ce="cover"===Dt?0:25,{originX:ae,originY:ze,top:St,left:tn,bottom:Ln,checkSafeAreaLeft:Yn,checkSafeAreaRight:Mr,arrowTop:Fr,arrowLeft:Zi,addPopoverBottomClass:Er}=Wn(Dn,Wr.top,Wr.left,se,Mi,bi,nr,io,Ce,Wr.originX,Wr.originY,Wr.referenceCoordinates,Wr.arrowTop,Wr.arrowLeft,Hr),vo=(0,L.c)(),le=(0,L.c)(),ee=(0,L.c)();return le.addElement(gr.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),ee.addElement(gr.querySelector(".popover-wrapper")).fromTo("opacity",.01,1),vo.easing("ease").duration(100).beforeAddWrite(()=>{"cover"===Dt&&ie.style.setProperty("--width",`${nr}px`),Er&&ie.classList.add("popover-bottom"),void 0!==Ln&&Di.style.setProperty("bottom",`${Ln}px`);let pn=`${tn}px`;Yn&&(pn=`${tn}px + var(--ion-safe-area-left, 0)`),Mr&&(pn=`${tn}px - var(--ion-safe-area-right, 0)`),Di.style.setProperty("top",`calc(${St}px + var(--offset-y, 0))`),Di.style.setProperty("left",`calc(${pn} + var(--offset-x, 0))`),Di.style.setProperty("transform-origin",`${ze} ${ae}`),null!==Ci&&(((ie,ue=!1,we,Oe)=>!(!we&&!Oe||"top"!==ie&&"bottom"!==ie&&ue))(Dn,Wr.top!==St||Wr.left!==tn,Oe,ht)?(Ci.style.setProperty("top",`calc(${Fr}px + var(--offset-y, 0))`),Ci.style.setProperty("left",`calc(${Zi}px + var(--offset-x, 0))`)):Ci.style.setProperty("display","none"))}).addAnimation([le,ee])},Qi=ie=>{const ue=(0,z.g)(ie),we=ue.querySelector(".popover-content"),Oe=ue.querySelector(".popover-arrow"),Dt=(0,L.c)(),ht=(0,L.c)(),fn=(0,L.c)();return ht.addElement(ue.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),fn.addElement(ue.querySelector(".popover-wrapper")).fromTo("opacity",.99,0),Dt.easing("ease").afterAddWrite(()=>{ie.style.removeProperty("--width"),ie.classList.remove("popover-bottom"),we.style.removeProperty("top"),we.style.removeProperty("left"),we.style.removeProperty("bottom"),we.style.removeProperty("transform-origin"),Oe&&(Oe.style.removeProperty("top"),Oe.style.removeProperty("left"),Oe.style.removeProperty("display"))}).duration(300).addAnimation([ht,fn])},vi=(ie,ue)=>{var we;const{event:Oe,size:Dt,trigger:ht,reference:fn,side:Dn,align:yn}=ue,oi=ie.ownerDocument,Pi="rtl"===oi.dir,Mi=oi.defaultView.innerWidth,bi=oi.defaultView.innerHeight,gr=(0,z.g)(ie),Di=gr.querySelector(".popover-content"),Ci=ht||(null===(we=null==Oe?void 0:Oe.detail)||void 0===we?void 0:we.ionShadowTarget)||(null==Oe?void 0:Oe.target),{contentWidth:dr,contentHeight:nr}=eo(Dt,Di,Ci),ho=Qe(Pi,dr,nr,0,0,fn,Dn,yn,{top:bi/2-nr/2,left:Mi/2-dr/2,originX:Pi?"right":"left",originY:"top"},ht,Oe),Hr="cover"===Dt?0:12,{originX:go,originY:Wr,top:se,left:Ce,bottom:ae}=Wn(Dn,ho.top,ho.left,Hr,Mi,bi,dr,nr,0,ho.originX,ho.originY,ho.referenceCoordinates),ze=(0,L.c)(),St=(0,L.c)(),tn=(0,L.c)(),Ln=(0,L.c)(),Yn=(0,L.c)();return St.addElement(gr.querySelector("ion-backdrop")).fromTo("opacity",.01,"var(--backdrop-opacity)").beforeStyles({"pointer-events":"none"}).afterClearStyles(["pointer-events"]),tn.addElement(gr.querySelector(".popover-wrapper")).duration(150).fromTo("opacity",.01,1),Ln.addElement(Di).beforeStyles({top:`calc(${se}px + var(--offset-y, 0px))`,left:`calc(${Ce}px + var(--offset-x, 0px))`,"transform-origin":`${Wr} ${go}`}).beforeAddWrite(()=>{void 0!==ae&&Di.style.setProperty("bottom",`${ae}px`)}).fromTo("transform","scale(0.8)","scale(1)"),Yn.addElement(gr.querySelector(".popover-viewport")).fromTo("opacity",.01,1),ze.easing("cubic-bezier(0.36,0.66,0.04,1)").duration(300).beforeAddWrite(()=>{"cover"===Dt&&ie.style.setProperty("--width",`${dr}px`),"bottom"===Wr&&ie.classList.add("popover-bottom")}).addAnimation([St,tn,Ln,Yn])},Pn=ie=>{const ue=(0,z.g)(ie),we=ue.querySelector(".popover-content"),Oe=(0,L.c)(),Dt=(0,L.c)(),ht=(0,L.c)();return Dt.addElement(ue.querySelector("ion-backdrop")).fromTo("opacity","var(--backdrop-opacity)",0),ht.addElement(ue.querySelector(".popover-wrapper")).fromTo("opacity",.99,0),Oe.easing("ease").afterAddWrite(()=>{ie.style.removeProperty("--width"),ie.classList.remove("popover-bottom"),we.style.removeProperty("top"),we.style.removeProperty("left"),we.style.removeProperty("bottom"),we.style.removeProperty("transform-origin")}).duration(150).addAnimation([Dt,ht])};let Gi=class{constructor(ie){(0,c.r)(this,ie),this.didPresent=(0,c.e)(this,"ionPopoverDidPresent",7),this.willPresent=(0,c.e)(this,"ionPopoverWillPresent",7),this.willDismiss=(0,c.e)(this,"ionPopoverWillDismiss",7),this.didDismiss=(0,c.e)(this,"ionPopoverDidDismiss",7),this.didPresentShorthand=(0,c.e)(this,"didPresent",7),this.willPresentShorthand=(0,c.e)(this,"willPresent",7),this.willDismissShorthand=(0,c.e)(this,"willDismiss",7),this.didDismissShorthand=(0,c.e)(this,"didDismiss",7),this.parentPopover=null,this.popoverIndex=hi++,this.coreDelegate=(0,Z.C)(),this.inline=!1,this.focusDescendantOnPresent=!1,this.presented=!1,this.hasController=!1,this.keyboardClose=!0,this.backdropDismiss=!0,this.showBackdrop=!0,this.translucent=!1,this.animated=!0,this.triggerAction="click",this.size="auto",this.dismissOnSelect=!1,this.reference="trigger",this.side="bottom",this.alignment="start",this.arrow=!0,this.isOpen=!1,this.keyboardEvents=!1,this.onDismiss=ue=>{ue.stopPropagation(),ue.preventDefault(),this.dismiss()},this.onBackdropTap=()=>{this.dismiss(void 0,Ur)},this.onLifecycle=ue=>{const we=this.usersElement,Oe=Ar[ue.type];if(we&&Oe){const Dt=new CustomEvent(Oe,{bubbles:!1,cancelable:!1,detail:ue.detail});we.dispatchEvent(Dt)}},this.configureTriggerInteraction=()=>{const{trigger:ue,triggerAction:we,el:Oe,destroyTriggerInteraction:Dt}=this;Dt&&Dt();const ht=this.triggerEl=void 0!==ue?document.getElementById(ue):null;!ht||(this.destroyTriggerInteraction=Xi(ht,we,Oe))},this.configureKeyboardInteraction=()=>{const{destroyKeyboardInteraction:ue,el:we}=this;ue&&ue(),this.destroyKeyboardInteraction=_e(we)},this.configureDismissInteraction=()=>{const{destroyDismissInteraction:ue,parentPopover:we,triggerAction:Oe,triggerEl:Dt,el:ht}=this;!we||!Dt||(ue&&ue(),this.destroyDismissInteraction=((ie,ue,we,Oe)=>{let Dt=[];const fn=(0,z.g)(Oe).querySelector(".popover-content");return Dt="hover"===ue?[{eventName:"mouseenter",callback:Dn=>{document.elementFromPoint(Dn.clientX,Dn.clientY)!==ie&&we.dismiss(void 0,void 0,!1)}}]:[{eventName:"click",callback:Dn=>{Dn.target.closest("[data-ion-popover-trigger]")!==ie?we.dismiss(void 0,void 0,!1):Dn.stopPropagation()}}],Dt.forEach(({eventName:Dn,callback:yn})=>fn.addEventListener(Dn,yn)),()=>{Dt.forEach(({eventName:Dn,callback:yn})=>fn.removeEventListener(Dn,yn))}})(Dt,Oe,ht,we))}}onTriggerChange(){this.configureTriggerInteraction()}onIsOpenChange(ie,ue){!0===ie&&!1===ue?this.present():!1===ie&&!0===ue&&this.dismiss()}connectedCallback(){un(this.el)}componentWillLoad(){this.popoverId=this.el.hasAttribute("id")?this.el.getAttribute("id"):`ion-popover-${this.popoverIndex}`,this.parentPopover=this.el.closest(`ion-popover:not(#${this.popoverId})`)}componentDidLoad(){const{parentPopover:ie,isOpen:ue}=this;!0===ue&&(0,z.r)(()=>this.present()),ie&&(0,z.a)(ie,"ionPopoverWillDismiss",()=>{this.dismiss(void 0,void 0,!1)}),this.configureTriggerInteraction()}presentFromTrigger(ie,ue=!1){var we=this;return(0,d.Z)(function*(){we.focusDescendantOnPresent=ue,yield we.present(ie),we.focusDescendantOnPresent=!1})()}getDelegate(ie=!1){if(this.workingDelegate&&!ie)return{delegate:this.workingDelegate,inline:this.inline};const we=this.inline=null!==this.el.parentNode&&!this.hasController;return{inline:we,delegate:this.workingDelegate=we?this.delegate||this.coreDelegate:this.delegate}}present(ie){var ue=this;return(0,d.Z)(function*(){if(ue.presented)return;void 0!==ue.currentTransition&&(yield ue.currentTransition);const we=Object.assign(Object.assign({},ue.componentProps),{popover:ue.el}),{inline:Oe,delegate:Dt}=ue.getDelegate(!0);ue.usersElement=yield(0,Z.a)(Dt,ue.el,ue.component,["popover-viewport"],we,Oe),yield(0,te.e)(ue.usersElement),ue.keyboardEvents||ue.configureKeyboardInteraction(),ue.configureDismissInteraction(),ue.currentTransition=Wi(ue,"popoverEnter",ui,vi,{event:ie||ue.event,size:ue.size,trigger:ue.triggerEl,reference:ue.reference,side:ue.side,align:ue.alignment}),yield ue.currentTransition,ue.currentTransition=void 0,ue.focusDescendantOnPresent&&hn(ue.el,ue.el)})()}dismiss(ie,ue,we=!0){var Oe=this;return(0,d.Z)(function*(){void 0!==Oe.currentTransition&&(yield Oe.currentTransition);const{destroyKeyboardInteraction:Dt,destroyDismissInteraction:ht}=Oe;we&&Oe.parentPopover&&Oe.parentPopover.dismiss(ie,ue,we),Oe.currentTransition=wo(Oe,ie,ue,"popoverLeave",Qi,Pn,Oe.event);const fn=yield Oe.currentTransition;if(fn){Dt&&(Dt(),Oe.destroyKeyboardInteraction=void 0),ht&&(ht(),Oe.destroyDismissInteraction=void 0);const{delegate:Dn}=Oe.getDelegate();yield(0,Z.d)(Dn,Oe.usersElement)}return Oe.currentTransition=void 0,fn})()}getParentPopover(){var ie=this;return(0,d.Z)(function*(){return ie.parentPopover})()}onDidDismiss(){return ke(this.el,"ionPopoverDidDismiss")}onWillDismiss(){return ke(this.el,"ionPopoverWillDismiss")}render(){const ie=(0,V.b)(this),{onLifecycle:ue,popoverId:we,parentPopover:Oe,dismissOnSelect:Dt,presented:ht,side:fn,arrow:Dn,htmlAttributes:yn}=this,oi=(0,V.a)("desktop"),Pi=Dn&&!Oe&&!oi;return(0,c.h)(c.H,Object.assign({"aria-modal":"true","no-router":!0,tabindex:"-1"},yn,{style:{zIndex:`${2e4+this.overlayIndex}`},id:we,class:Object.assign(Object.assign({},(0,p.g)(this.cssClass)),{[ie]:!0,"popover-translucent":this.translucent,"overlay-hidden":!0,"popover-interactive":ht,"popover-desktop":oi,[`popover-side-${fn}`]:!0,"popover-nested":!!Oe}),onIonPopoverDidPresent:ue,onIonPopoverWillPresent:ue,onIonPopoverWillDismiss:ue,onIonPopoverDidDismiss:ue,onIonDismiss:this.onDismiss,onIonBackdropTap:this.onBackdropTap}),!Oe&&(0,c.h)("ion-backdrop",{tappable:this.backdropDismiss,visible:this.showBackdrop,part:"backdrop"}),(0,c.h)("div",{class:"popover-wrapper ion-overlay-wrapper",onClick:Dt?()=>this.dismiss():void 0},Pi&&(0,c.h)("div",{class:"popover-arrow",part:"arrow"}),(0,c.h)("div",{class:"popover-content",part:"content"},(0,c.h)("slot",null))))}get el(){return(0,c.i)(this)}static get watchers(){return{trigger:["onTriggerChange"],triggerAction:["onTriggerChange"],isOpen:["onIsOpenChange"]}}};const Ar={ionPopoverDidPresent:"ionViewDidEnter",ionPopoverWillPresent:"ionViewWillEnter",ionPopoverWillDismiss:"ionViewWillLeave",ionPopoverDidDismiss:"ionViewDidLeave"};let hi=0;Gi.style={ios:':host{--background:var(--ion-background-color, #fff);--min-width:0;--min-height:0;--max-width:auto;--height:auto;--offset-x:0px;--offset-y:0px;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);z-index:1001;pointer-events:none}:host(.popover-interactive) .popover-content,:host(.popover-interactive) ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.popover-wrapper{opacity:0;z-index:10}.popover-content{display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:auto;z-index:10}.popover-viewport{--ion-safe-area-top:0px;--ion-safe-area-right:0px;--ion-safe-area-bottom:0px;--ion-safe-area-left:0px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow:hidden}:host(.popover-nested.popover-side-left){--offset-x:5px}:host(.popover-nested.popover-side-right){--offset-x:-5px}:host(.popover-nested.popover-side-start){--offset-x:5px}:host-context([dir=rtl]):host(.popover-nested.popover-side-start),:host-context([dir=rtl]).popover-nested.popover-side-start{--offset-x:-5px}:host(.popover-nested.popover-side-end){--offset-x:-5px}:host-context([dir=rtl]):host(.popover-nested.popover-side-end),:host-context([dir=rtl]).popover-nested.popover-side-end{--offset-x:5px}:host{--width:200px;--max-height:90%;--box-shadow:none;--backdrop-opacity:var(--ion-backdrop-opacity, 0.08)}:host(.popover-desktop){--box-shadow:0px 4px 16px 0px rgba(0, 0, 0, 0.12)}.popover-content{border-radius:10px}:host(.popover-desktop) .popover-content{border:0.5px solid var(--ion-color-step-100, #e6e6e6)}.popover-arrow{display:block;position:absolute;width:20px;height:10px;overflow:hidden}.popover-arrow::after{left:3px;top:3px;border-radius:3px;position:absolute;width:14px;height:14px;-webkit-transform:rotate(45deg);transform:rotate(45deg);background:var(--background);content:"";z-index:10}[dir=rtl] .popover-arrow::after,:host-context([dir=rtl]) .popover-arrow::after{left:unset;right:unset;right:3px}:host(.popover-bottom) .popover-arrow{top:auto;bottom:-10px}:host(.popover-bottom) .popover-arrow::after{top:-6px}:host(.popover-side-left) .popover-arrow{-webkit-transform:rotate(90deg);transform:rotate(90deg)}:host(.popover-side-right) .popover-arrow{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}:host(.popover-side-top) .popover-arrow{-webkit-transform:rotate(180deg);transform:rotate(180deg)}:host(.popover-side-start) .popover-arrow{-webkit-transform:rotate(90deg);transform:rotate(90deg)}:host-context([dir=rtl]):host(.popover-side-start) .popover-arrow,:host-context([dir=rtl]).popover-side-start .popover-arrow{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}:host(.popover-side-end) .popover-arrow{-webkit-transform:rotate(-90deg);transform:rotate(-90deg)}:host-context([dir=rtl]):host(.popover-side-end) .popover-arrow,:host-context([dir=rtl]).popover-side-end .popover-arrow{-webkit-transform:rotate(90deg);transform:rotate(90deg)}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.popover-translucent) .popover-content,:host(.popover-translucent) .popover-arrow::after{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}',md:":host{--background:var(--ion-background-color, #fff);--min-width:0;--min-height:0;--max-width:auto;--height:auto;--offset-x:0px;--offset-y:0px;left:0;right:0;top:0;bottom:0;display:-ms-flexbox;display:flex;position:fixed;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center;outline:none;color:var(--ion-text-color, #000);z-index:1001;pointer-events:none}:host(.popover-interactive) .popover-content,:host(.popover-interactive) ion-backdrop{pointer-events:auto}:host(.overlay-hidden){display:none}.popover-wrapper{opacity:0;z-index:10}.popover-content{display:-ms-flexbox;display:flex;position:absolute;-ms-flex-direction:column;flex-direction:column;width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow);overflow:auto;z-index:10}.popover-viewport{--ion-safe-area-top:0px;--ion-safe-area-right:0px;--ion-safe-area-bottom:0px;--ion-safe-area-left:0px;display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;overflow:hidden}:host(.popover-nested.popover-side-left){--offset-x:5px}:host(.popover-nested.popover-side-right){--offset-x:-5px}:host(.popover-nested.popover-side-start){--offset-x:5px}:host-context([dir=rtl]):host(.popover-nested.popover-side-start),:host-context([dir=rtl]).popover-nested.popover-side-start{--offset-x:-5px}:host(.popover-nested.popover-side-end){--offset-x:-5px}:host-context([dir=rtl]):host(.popover-nested.popover-side-end),:host-context([dir=rtl]).popover-nested.popover-side-end{--offset-x:5px}:host{--width:250px;--max-height:90%;--box-shadow:0 5px 5px -3px rgba(0, 0, 0, 0.2), 0 8px 10px 1px rgba(0, 0, 0, 0.14), 0 3px 14px 2px rgba(0, 0, 0, 0.12);--backdrop-opacity:var(--ion-backdrop-opacity, 0.32)}.popover-content{border-radius:4px;-webkit-transform-origin:left top;transform-origin:left top}[dir=rtl] .popover-content,:host-context([dir=rtl]) .popover-content{-webkit-transform-origin:right top;transform-origin:right top}.popover-viewport{-webkit-transition-delay:100ms;transition-delay:100ms}"};const Cr=(ie,ue)=>{const we=(0,L.c)(),Oe=(0,L.c)(),ht=(0,z.g)(ie).querySelector(".toast-wrapper");switch(Oe.addElement(ht),ue){case"top":Oe.fromTo("transform","translateY(-100%)","translateY(calc(10px + var(--ion-safe-area-top, 0px)))");break;case"middle":const yn=Math.floor(ie.clientHeight/2-ht.clientHeight/2);ht.style.top=`${yn}px`,Oe.fromTo("opacity",.01,1);break;default:Oe.fromTo("transform","translateY(100%)","translateY(calc(-10px - var(--ion-safe-area-bottom, 0px)))")}return we.easing("cubic-bezier(.155,1.105,.295,1.12)").duration(400).addAnimation(Oe)},xr=(ie,ue)=>{const we=(0,L.c)(),Oe=(0,L.c)(),ht=(0,z.g)(ie).querySelector(".toast-wrapper");switch(Oe.addElement(ht),ue){case"top":Oe.fromTo("transform","translateY(calc(10px + var(--ion-safe-area-top, 0px)))","translateY(-100%)");break;case"middle":Oe.fromTo("opacity",.99,0);break;default:Oe.fromTo("transform","translateY(calc(-10px - var(--ion-safe-area-bottom, 0px)))","translateY(100%)")}return we.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(Oe)},qr=(ie,ue)=>{const we=(0,L.c)(),Oe=(0,L.c)(),ht=(0,z.g)(ie).querySelector(".toast-wrapper");switch(Oe.addElement(ht),ue){case"top":ht.style.top="calc(8px + var(--ion-safe-area-top, 0px))",Oe.fromTo("opacity",.01,1);break;case"middle":const yn=Math.floor(ie.clientHeight/2-ht.clientHeight/2);ht.style.top=`${yn}px`,Oe.fromTo("opacity",.01,1);break;default:ht.style.bottom="calc(8px + var(--ion-safe-area-bottom, 0px))",Oe.fromTo("opacity",.01,1)}return we.easing("cubic-bezier(.36,.66,.04,1)").duration(400).addAnimation(Oe)},Ao=ie=>{const ue=(0,L.c)(),we=(0,L.c)(),Dt=(0,z.g)(ie).querySelector(".toast-wrapper");return we.addElement(Dt).fromTo("opacity",.99,0),ue.easing("cubic-bezier(.36,.66,.04,1)").duration(300).addAnimation(we)};let to=class{constructor(ie){(0,c.r)(this,ie),this.didPresent=(0,c.e)(this,"ionToastDidPresent",7),this.willPresent=(0,c.e)(this,"ionToastWillPresent",7),this.willDismiss=(0,c.e)(this,"ionToastWillDismiss",7),this.didDismiss=(0,c.e)(this,"ionToastDidDismiss",7),this.presented=!1,this.duration=0,this.keyboardClose=!1,this.position="bottom",this.translucent=!1,this.animated=!0,this.dispatchCancelHandler=ue=>{if(en(ue.detail.role)){const Oe=this.getButtons().find(Dt=>"cancel"===Dt.role);this.callButtonHandler(Oe)}}}connectedCallback(){un(this.el,{trapKeyboardFocus:!1})}present(){var ie=this;return(0,d.Z)(function*(){yield Wi(ie,"toastEnter",Cr,qr,ie.position),ie.duration>0&&(ie.durationTimeout=setTimeout(()=>ie.dismiss(void 0,"timeout"),ie.duration))})()}dismiss(ie,ue){return this.durationTimeout&&clearTimeout(this.durationTimeout),wo(this,ie,ue,"toastLeave",xr,Ao,this.position)}onDidDismiss(){return ke(this.el,"ionToastDidDismiss")}onWillDismiss(){return ke(this.el,"ionToastWillDismiss")}getButtons(){return this.buttons?this.buttons.map(ue=>"string"==typeof ue?{text:ue}:ue):[]}buttonClick(ie){var ue=this;return(0,d.Z)(function*(){const we=ie.role;return en(we)||(yield ue.callButtonHandler(ie))?ue.dismiss(void 0,we):Promise.resolve()})()}callButtonHandler(ie){return(0,d.Z)(function*(){if(ie&&ie.handler)try{if(!1===(yield fi(ie.handler)))return!1}catch(ue){console.error(ue)}return!0})()}renderButtons(ie,ue){if(0===ie.length)return;const we=(0,V.b)(this);return(0,c.h)("div",{class:{"toast-button-group":!0,[`toast-button-group-${ue}`]:!0}},ie.map(Dt=>(0,c.h)("button",{type:"button",class:uo(Dt),tabIndex:0,onClick:()=>this.buttonClick(Dt),part:"button"},(0,c.h)("div",{class:"toast-button-inner"},Dt.icon&&(0,c.h)("ion-icon",{icon:Dt.icon,slot:void 0===Dt.text?"icon-only":void 0,class:"toast-button-icon"}),Dt.text),"md"===we&&(0,c.h)("ion-ripple-effect",{type:void 0!==Dt.icon&&void 0===Dt.text?"unbounded":"bounded"}))))}render(){const ie=this.getButtons(),ue=ie.filter(fn=>"start"===fn.side),we=ie.filter(fn=>"start"!==fn.side),Oe=(0,V.b)(this),Dt={"toast-wrapper":!0,[`toast-${this.position}`]:!0};return(0,c.h)(c.H,Object.assign({role:ie.length>0?"dialog":"status",tabindex:"-1"},this.htmlAttributes,{style:{zIndex:`${6e4+this.overlayIndex}`},class:(0,p.c)(this.color,Object.assign(Object.assign({[Oe]:!0},(0,p.g)(this.cssClass)),{"overlay-hidden":!0,"toast-translucent":this.translucent})),onIonToastWillDismiss:this.dispatchCancelHandler}),(0,c.h)("div",{class:Dt},(0,c.h)("div",{class:"toast-container",part:"container"},this.renderButtons(ue,"start"),void 0!==this.icon&&(0,c.h)("ion-icon",{class:"toast-icon",part:"icon",icon:this.icon,lazy:!1,"aria-hidden":"true"}),(0,c.h)("div",{class:"toast-content"},void 0!==this.header&&(0,c.h)("div",{class:"toast-header",part:"header"},this.header),void 0!==this.message&&(0,c.h)("div",{class:"toast-message",part:"message",innerHTML:(0,A.s)(this.message)})),this.renderButtons(we,"end"))))}get el(){return(0,c.i)(this)}};const uo=ie=>Object.assign({"toast-button":!0,"toast-button-icon-only":void 0!==ie.icon&&void 0===ie.text,[`toast-button-${ie.role}`]:void 0!==ie.role,"ion-focusable":!0,"ion-activatable":!0},(0,p.g)(ie.cssClass));to.style={ios:":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;left:0;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host-context([dir=rtl]){left:unset;right:unset;right:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);left:var(--start);right:var(--end);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}[dir=rtl] .toast-wrapper,:host-context([dir=rtl]) .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;pointer-events:auto;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-icon{margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-50, #f2f2f2);--border-radius:14px;--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-850, #262626);--max-width:700px;--start:10px;--end:10px;font-size:14px}.toast-wrapper{margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-wrapper{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}@supports ((-webkit-backdrop-filter: blur(0)) or (backdrop-filter: blur(0))){:host(.toast-translucent) .toast-wrapper{background:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.8);-webkit-backdrop-filter:saturate(180%) blur(20px);backdrop-filter:saturate(180%) blur(20px)}}.toast-wrapper.toast-top{-webkit-transform:translate3d(0,  -100%,  0);transform:translate3d(0,  -100%,  0);top:0}.toast-wrapper.toast-middle{opacity:0.01}.toast-wrapper.toast-bottom{-webkit-transform:translate3d(0,  100%,  0);transform:translate3d(0,  100%,  0);bottom:0}.toast-content{padding-left:15px;padding-right:15px;padding-top:15px;padding-bottom:15px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-content{padding-left:unset;padding-right:unset;-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px}}.toast-header{margin-bottom:2px;font-weight:500}.toast-button{padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;height:44px;-webkit-transition:background-color, opacity 100ms linear;transition:background-color, opacity 100ms linear;border:0;background-color:transparent;font-family:var(--ion-font-family);font-size:17px;font-weight:500;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button{padding-left:unset;padding-right:unset;-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px}}.toast-button.ion-activated{opacity:0.4}@media (any-hover: hover){.toast-button:hover{opacity:0.6}}",md:":host{--border-width:0;--border-style:none;--border-color:initial;--box-shadow:none;--min-width:auto;--width:auto;--min-height:auto;--height:auto;--max-height:auto;--white-space:normal;left:0;top:0;display:block;position:absolute;width:100%;height:100%;outline:none;color:var(--color);font-family:var(--ion-font-family, inherit);contain:strict;z-index:1001;pointer-events:none}:host-context([dir=rtl]){left:unset;right:unset;right:0}:host(.overlay-hidden){display:none}:host(.ion-color){--button-color:inherit;color:var(--ion-color-contrast)}:host(.ion-color) .toast-button-cancel{color:inherit}:host(.ion-color) .toast-wrapper{background:var(--ion-color-base)}.toast-wrapper{border-radius:var(--border-radius);left:var(--start);right:var(--end);width:var(--width);min-width:var(--min-width);max-width:var(--max-width);height:var(--height);min-height:var(--min-height);max-height:var(--max-height);border-width:var(--border-width);border-style:var(--border-style);border-color:var(--border-color);background:var(--background);-webkit-box-shadow:var(--box-shadow);box-shadow:var(--box-shadow)}[dir=rtl] .toast-wrapper,:host-context([dir=rtl]) .toast-wrapper{left:unset;right:unset;left:var(--end);right:var(--start)}.toast-container{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;pointer-events:auto;height:inherit;min-height:inherit;max-height:inherit;contain:content}.toast-content{display:-ms-flexbox;display:flex;-ms-flex:1;flex:1;-ms-flex-direction:column;flex-direction:column;-ms-flex-pack:center;justify-content:center}.toast-icon{margin-left:16px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-icon{margin-left:unset;-webkit-margin-start:16px;margin-inline-start:16px}}.toast-message{-ms-flex:1;flex:1;white-space:var(--white-space)}.toast-button-group{display:-ms-flexbox;display:flex}.toast-button{border:0;outline:none;color:var(--button-color);z-index:0}.toast-icon,.toast-button-icon{font-size:1.4em}.toast-button-inner{display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}@media (any-hover: hover){.toast-button:hover{cursor:pointer}}:host{--background:var(--ion-color-step-800, #333333);--border-radius:4px;--box-shadow:0 3px 5px -1px rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.14), 0 1px 18px 0 rgba(0, 0, 0, 0.12);--button-color:var(--ion-color-primary, #3880ff);--color:var(--ion-color-step-50, #f2f2f2);--max-width:700px;--start:8px;--end:8px;font-size:14px}.toast-wrapper{margin-left:auto;margin-right:auto;margin-top:auto;margin-bottom:auto;display:block;position:absolute;opacity:0.01;z-index:10}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-wrapper{margin-left:unset;margin-right:unset;-webkit-margin-start:auto;margin-inline-start:auto;-webkit-margin-end:auto;margin-inline-end:auto}}.toast-content{padding-left:16px;padding-right:16px;padding-top:14px;padding-bottom:14px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-content{padding-left:unset;padding-right:unset;-webkit-padding-start:16px;padding-inline-start:16px;-webkit-padding-end:16px;padding-inline-end:16px}}.toast-header{margin-bottom:2px;font-weight:500;line-height:20px}.toast-message{line-height:20px}.toast-button-group-start{margin-left:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button-group-start{margin-left:unset;-webkit-margin-start:8px;margin-inline-start:8px}}.toast-button-group-end{margin-right:8px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button-group-end{margin-right:unset;-webkit-margin-end:8px;margin-inline-end:8px}}.toast-button{padding-left:15px;padding-right:15px;padding-top:10px;padding-bottom:10px;position:relative;background-color:transparent;font-family:var(--ion-font-family);font-size:14px;font-weight:500;letter-spacing:0.84px;text-transform:uppercase;overflow:hidden}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button{padding-left:unset;padding-right:unset;-webkit-padding-start:15px;padding-inline-start:15px;-webkit-padding-end:15px;padding-inline-end:15px}}.toast-button-cancel{color:var(--ion-color-step-100, #e6e6e6)}.toast-button-icon-only{border-radius:50%;padding-left:9px;padding-right:9px;padding-top:9px;padding-bottom:9px;width:36px;height:36px}@supports ((-webkit-margin-start: 0) or (margin-inline-start: 0)) or (-webkit-margin-start: 0){.toast-button-icon-only{padding-left:unset;padding-right:unset;-webkit-padding-start:9px;padding-inline-start:9px;-webkit-padding-end:9px;padding-inline-end:9px}}@media (any-hover: hover){.toast-button:hover{background-color:rgba(var(--ion-color-primary-rgb, 56, 128, 255), 0.08)}.toast-button-cancel:hover{background-color:rgba(var(--ion-background-color-rgb, 255, 255, 255), 0.08)}}"};let Lr=0;const Sr=new WeakMap,Pr=(ie,ue,we)=>({create:Oe=>An(ie,Oe,ue,we),dismiss:(Oe,Dt,ht)=>pr(document,Oe,Dt,ie,ht),getTop:()=>(0,d.Z)(function*(){return mo(document,ie)})()}),Se=Pr("ion-alert",Vn,[{tagName:"ion-backdrop",customElement:Q.B}]),Xe=Pr("ion-action-sheet",Je,[{tagName:"ion-backdrop",customElement:Q.B},{tagName:"ion-ripple-effect",customElement:me.R}]),Me=Pr("ion-loading",Bn,[{tagName:"ion-backdrop",customElement:Q.B},{tagName:"ion-spinner",customElement:Ee.S}]),st=Pr("ion-modal",Pe,[{tagName:"ion-backdrop",customElement:Q.B}]),zt=Pr("ion-popover",Gi,[{tagName:"ion-backdrop",customElement:Q.B}]),rn=Pr("ion-toast",to,[{tagName:"ion-ripple-effect",customElement:me.R}]),un=(ie,ue={trapKeyboardFocus:!0})=>{"undefined"!=typeof document&&Br(document,ue);const we=Lr++;ie.overlayIndex=we,ie.hasAttribute("id")||(ie.id=`ion-overlay-${we}`)},An=(ie,ue,we,Oe)=>"undefined"!=typeof window&&void 0!==window.customElements?((ie,ue,we)=>{const{customElements:Oe}=window;if(Oe.get(ie)||Oe.define(ie,ue),we)for(const Dt of we)Oe.get(Dt.tagName)||Oe.define(Dt.tagName,Dt.customElement);return Oe.whenDefined(ie)})(ie,we,Oe).then(()=>{const Dt=document.createElement(ie);return Dt.classList.add("overlay-hidden"),Object.assign(Dt,Object.assign(Object.assign({},ue),{hasController:!0})),at(document).appendChild(Dt),new Promise(ht=>(0,z.c)(Dt,ht))}):Promise.resolve(),qn='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .ion-focusable:not([tabindex^="-"])',Bt="input:not([type=hidden]), textarea, button, select",hn=(ie,ue)=>{let we=ie.querySelector(qn);const Oe=we&&we.shadowRoot;Oe&&(we=Oe.querySelector(Bt)||we),we?(0,z.f)(we):ue.focus()},no=(ie,ue)=>{const we=Array.from(ie.querySelectorAll(qn));let Oe=we.length>0?we[we.length-1]:null;const Dt=Oe&&Oe.shadowRoot;Dt&&(Oe=Dt.querySelector(Bt)||Oe),Oe?Oe.focus():ue.focus()},Br=(ie,ue)=>{0===Lr&&(Lr=1,ue.trapKeyboardFocus&&ie.addEventListener("focus",we=>{we.target&&"ION-MENU"===we.target.tagName||((ie,ue)=>{const we=mo(ue),Oe=ie.target;we&&Oe&&(we.shadowRoot?(()=>{if(we.contains(Oe))we.lastFocus=Oe;else{const fn=we.lastFocus;hn(we,we),fn===ue.activeElement&&no(we,we),we.lastFocus=ue.activeElement}})():(()=>{if(we===Oe)we.lastFocus=void 0;else{const fn=(0,z.g)(we);if(!fn.contains(Oe))return;const Dn=fn.querySelector(".ion-overlay-wrapper");if(!Dn)return;if(Dn.contains(Oe))we.lastFocus=Oe;else{const yn=we.lastFocus;hn(Dn,we),yn===ue.activeElement&&no(Dn,we),we.lastFocus=ue.activeElement}}})())})(we,ie)},!0),ie.addEventListener("ionBackButton",we=>{const Oe=mo(ie);Oe&&Oe.backdropDismiss&&we.detail.register(je.OVERLAY_BACK_BUTTON_PRIORITY,()=>Oe.dismiss(void 0,Ur))}),ie.addEventListener("keyup",we=>{if("Escape"===we.key){const Oe=mo(ie);Oe&&Oe.backdropDismiss&&Oe.dismiss(void 0,Ur)}}))},pr=(ie,ue,we,Oe,Dt)=>{const ht=mo(ie,Oe,Dt);return ht?ht.dismiss(ue,we):Promise.reject("overlay does not exist")},mo=(ie,ue,we)=>{const Oe=((ie,ue)=>(void 0===ue&&(ue="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(ie.querySelectorAll(ue)).filter(we=>we.overlayIndex>0)))(ie,ue).filter(Dt=>!(ie=>ie.classList.contains("overlay-hidden"))(Dt));return void 0===we?Oe[Oe.length-1]:Oe.find(Dt=>Dt.id===we)},jn=(ie=!1)=>{const we=at(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");!we||(ie?we.setAttribute("aria-hidden","true"):we.removeAttribute("aria-hidden"))},Wi=function(){var ie=(0,d.Z)(function*(ue,we,Oe,Dt,ht){var fn,Dn;if(ue.presented)return;jn(!0),ue.presented=!0,ue.willPresent.emit(),null===(fn=ue.willPresentShorthand)||void 0===fn||fn.emit();const yn=(0,V.b)(ue),oi=ue.enterAnimation?ue.enterAnimation:V.c.get(we,"ios"===yn?Oe:Dt);(yield nt(ue,oi,ue.el,ht))&&(ue.didPresent.emit(),null===(Dn=ue.didPresentShorthand)||void 0===Dn||Dn.emit()),"ION-TOAST"!==ue.el.tagName&&Ui(ue.el),ue.keyboardClose&&ue.el.focus()});return function(we,Oe,Dt,ht,fn){return ie.apply(this,arguments)}}(),Ui=function(){var ie=(0,d.Z)(function*(ue){let we=document.activeElement;if(!we)return;const Oe=we&&we.shadowRoot;Oe&&(we=Oe.querySelector(Bt)||we),yield ue.onDidDismiss(),we.focus()});return function(we){return ie.apply(this,arguments)}}(),wo=function(){var ie=(0,d.Z)(function*(ue,we,Oe,Dt,ht,fn,Dn){var yn,oi;if(!ue.presented)return!1;jn(!1),ue.presented=!1;try{ue.el.style.setProperty("pointer-events","none"),ue.willDismiss.emit({data:we,role:Oe}),null===(yn=ue.willDismissShorthand)||void 0===yn||yn.emit({data:we,role:Oe});const Pi=(0,V.b)(ue),Mi=ue.leaveAnimation?ue.leaveAnimation:V.c.get(Dt,"ios"===Pi?ht:fn);"gesture"!==Oe&&(yield nt(ue,Mi,ue.el,Dn)),ue.didDismiss.emit({data:we,role:Oe}),null===(oi=ue.didDismissShorthand)||void 0===oi||oi.emit({data:we,role:Oe}),Sr.delete(ue),ue.el.classList.add("overlay-hidden")}catch(Pi){console.error(Pi)}return ue.el.remove(),!0});return function(we,Oe,Dt,ht,fn,Dn,yn){return ie.apply(this,arguments)}}(),at=ie=>ie.querySelector("ion-app")||ie.body,nt=function(){var ie=(0,d.Z)(function*(ue,we,Oe,Dt){Oe.classList.remove("overlay-hidden");const fn=we(ue.el,Dt);(!ue.animated||!V.c.getBoolean("animated",!0))&&fn.duration(0),ue.keyboardClose&&fn.beforeAddWrite(()=>{const yn=Oe.ownerDocument.activeElement;yn&&yn.matches("input,ion-input, ion-textarea")&&yn.blur()});const Dn=Sr.get(ue)||[];return Sr.set(ue,[...Dn,fn]),yield fn.play(),!0});return function(we,Oe,Dt,ht){return ie.apply(this,arguments)}}(),ke=(ie,ue)=>{let we;const Oe=new Promise(Dt=>we=Dt);return At(ie,ue,Dt=>{we(Dt.detail)}),Oe},At=(ie,ue,we)=>{const Oe=Dt=>{(0,z.b)(ie,ue,Oe),we(Dt)};(0,z.a)(ie,ue,Oe)},en=ie=>"cancel"===ie||ie===Ur,pi=ie=>ie(),fi=(ie,ue)=>{if("function"==typeof ie)return V.c.get("_zoneGate",pi)(()=>{try{return ie(ue)}catch(Oe){throw Oe}})},Ur="backdrop"},5893:(_n,Ke,k)=>{"use strict";k.d(Ke,{R:()=>O});var d=k(6099),c=k(9533),V=k(7639);let O=class{constructor(Q){(0,c.r)(this,Q),this.type="bounded"}addRipple(Q,Z){var z=this;return(0,d.Z)(function*(){return new Promise(G=>{(0,c.f)(()=>{const te=z.el.getBoundingClientRect(),ye=te.width,me=te.height,Ee=Math.sqrt(ye*ye+me*me),je=Math.max(me,ye),rt=z.unbounded?je:Ee+p,Ae=Math.floor(je*L),Ze=rt/Ae;let Ve=Q-te.left,He=Z-te.top;z.unbounded&&(Ve=.5*ye,He=.5*me);const Ne=Ve-.5*Ae,xt=He-.5*Ae,Je=.5*ye-Ve,ct=.5*me-He;(0,c.c)(()=>{const wt=document.createElement("div");wt.classList.add("ripple-effect");const Tt=wt.style;Tt.top=xt+"px",Tt.left=Ne+"px",Tt.width=Tt.height=Ae+"px",Tt.setProperty("--final-scale",`${Ze}`),Tt.setProperty("--translate-end",`${Je}px, ${ct}px`),(z.el.shadowRoot||z.el).appendChild(wt),setTimeout(()=>{G(()=>{A(wt)})},325)})})})})()}get unbounded(){return"unbounded"===this.type}render(){const Q=(0,V.b)(this);return(0,c.h)(c.H,{role:"presentation",class:{[Q]:!0,unbounded:this.unbounded}})}get el(){return(0,c.i)(this)}};const A=Q=>{Q.classList.add("fade-out"),setTimeout(()=>{Q.remove()},200)},p=10,L=.5;O.style=":host{left:0;right:0;top:0;bottom:0;position:absolute;contain:strict;pointer-events:none}:host(.unbounded){contain:layout size style}.ripple-effect{border-radius:50%;position:absolute;background-color:currentColor;color:inherit;contain:strict;opacity:0;-webkit-animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;animation:225ms rippleAnimation forwards, 75ms fadeInAnimation forwards;will-change:transform, opacity;pointer-events:none}.fade-out{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1));-webkit-animation:150ms fadeOutAnimation forwards;animation:150ms fadeOutAnimation forwards}@-webkit-keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@keyframes rippleAnimation{from{-webkit-animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);animation-timing-function:cubic-bezier(0.4, 0, 0.2, 1);-webkit-transform:scale(1);transform:scale(1)}to{-webkit-transform:translate(var(--translate-end)) scale(var(--final-scale, 1));transform:translate(var(--translate-end)) scale(var(--final-scale, 1))}}@-webkit-keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@keyframes fadeInAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0}to{opacity:0.16}}@-webkit-keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}@keyframes fadeOutAnimation{from{-webkit-animation-timing-function:linear;animation-timing-function:linear;opacity:0.16}to{opacity:0}}"},7788:(_n,Ke,k)=>{"use strict";k.d(Ke,{S:()=>A});var d=k(9533),c=k(7639),V=k(7300),a=k(9955);let A=class{constructor(Q){(0,d.r)(this,Q),this.paused=!1}getName(){const Q=this.name||c.c.get("spinner"),Z=(0,c.b)(this);return Q||("ios"===Z?"lines":"circular")}render(){const Q=this,Z=(0,c.b)(Q),z=Q.getName(),G=a.S[z]||a.S.lines,te="number"==typeof Q.duration&&Q.duration>10?Q.duration:G.dur,ye=[];if(void 0!==G.circles)for(let me=0;me<G.circles;me++)ye.push(p(G,te,me,G.circles));else if(void 0!==G.lines)for(let me=0;me<G.lines;me++)ye.push(L(G,te,me,G.lines));return(0,d.h)(d.H,{class:(0,V.c)(Q.color,{[Z]:!0,[`spinner-${z}`]:!0,"spinner-paused":Q.paused||c.c.getBoolean("_testing")}),role:"progressbar",style:G.elmDuration?{animationDuration:te+"ms"}:{}},ye)}};const p=(Q,Z,z,G)=>{const te=Q.fn(Z,z,G);return te.style["animation-duration"]=Z+"ms",(0,d.h)("svg",{viewBox:te.viewBox||"0 0 64 64",style:te.style},(0,d.h)("circle",{transform:te.transform||"translate(32,32)",cx:te.cx,cy:te.cy,r:te.r,style:Q.elmDuration?{animationDuration:Z+"ms"}:{}}))},L=(Q,Z,z,G)=>{const te=Q.fn(Z,z,G);return te.style["animation-duration"]=Z+"ms",(0,d.h)("svg",{viewBox:te.viewBox||"0 0 64 64",style:te.style},(0,d.h)("line",{transform:"translate(32,32)",y1:te.y1,y2:te.y2}))};A.style=":host{display:inline-block;position:relative;width:28px;height:28px;color:var(--color);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}:host(.ion-color){color:var(--ion-color-base)}svg{left:0;top:0;-webkit-transform-origin:center;transform-origin:center;position:absolute;width:100%;height:100%;-webkit-transform:translateZ(0);transform:translateZ(0)}[dir=rtl] svg,:host-context([dir=rtl]) svg{left:unset;right:unset;right:0}[dir=rtl] svg,:host-context([dir=rtl]) svg{-webkit-transform-origin:calc(100% - center);transform-origin:calc(100% - center)}:host(.spinner-lines) line,:host(.spinner-lines-small) line{stroke-width:7px}:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-width:4px}:host(.spinner-lines) line,:host(.spinner-lines-small) line,:host(.spinner-lines-sharp) line,:host(.spinner-lines-sharp-small) line{stroke-linecap:round;stroke:currentColor}:host(.spinner-lines) svg,:host(.spinner-lines-small) svg,:host(.spinner-lines-sharp) svg,:host(.spinner-lines-sharp-small) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite}:host(.spinner-bubbles) svg{-webkit-animation:spinner-scale-out 1s linear infinite;animation:spinner-scale-out 1s linear infinite;fill:currentColor}:host(.spinner-circles) svg{-webkit-animation:spinner-fade-out 1s linear infinite;animation:spinner-fade-out 1s linear infinite;fill:currentColor}:host(.spinner-crescent) circle{fill:transparent;stroke-width:4px;stroke-dasharray:128px;stroke-dashoffset:82px;stroke:currentColor}:host(.spinner-crescent) svg{-webkit-animation:spinner-rotate 1s linear infinite;animation:spinner-rotate 1s linear infinite}:host(.spinner-dots) circle{stroke-width:0;fill:currentColor}:host(.spinner-dots) svg{-webkit-animation:spinner-dots 1s linear infinite;animation:spinner-dots 1s linear infinite}:host(.spinner-circular) svg{-webkit-animation:spinner-circular linear infinite;animation:spinner-circular linear infinite}:host(.spinner-circular) circle{-webkit-animation:spinner-circular-inner ease-in-out infinite;animation:spinner-circular-inner ease-in-out infinite;stroke:currentColor;stroke-dasharray:80px, 200px;stroke-dashoffset:0px;stroke-width:5.6;fill:none}:host(.spinner-paused),:host(.spinner-paused) svg,:host(.spinner-paused) circle{-webkit-animation-play-state:paused;animation-play-state:paused}@-webkit-keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@keyframes spinner-fade-out{0%{opacity:1}100%{opacity:0}}@-webkit-keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@keyframes spinner-scale-out{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1)}100%{-webkit-transform:scale(0, 0);transform:scale(0, 0)}}@-webkit-keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-rotate{0%{-webkit-transform:rotate(0deg);transform:rotate(0deg)}100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@keyframes spinner-dots{0%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}50%{-webkit-transform:scale(0.4, 0.4);transform:scale(0.4, 0.4);opacity:0.3}100%{-webkit-transform:scale(1, 1);transform:scale(1, 1);opacity:0.9}}@-webkit-keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@keyframes spinner-circular{100%{-webkit-transform:rotate(360deg);transform:rotate(360deg)}}@-webkit-keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}@keyframes spinner-circular-inner{0%{stroke-dasharray:1px, 200px;stroke-dashoffset:0px}50%{stroke-dasharray:100px, 200px;stroke-dashoffset:-15px}100%{stroke-dasharray:100px, 200px;stroke-dashoffset:-125px}}"},9955:(_n,Ke,k)=>{"use strict";k.d(Ke,{S:()=>c});const c={bubbles:{dur:1e3,circles:9,fn:(V,a,O)=>{const A=V*a/O-V+"ms",p=2*Math.PI*a/O;return{r:5,style:{top:9*Math.sin(p)+"px",left:9*Math.cos(p)+"px","animation-delay":A}}}},circles:{dur:1e3,circles:8,fn:(V,a,O)=>{const A=a/O,p=V*A-V+"ms",L=2*Math.PI*A;return{r:5,style:{top:9*Math.sin(L)+"px",left:9*Math.cos(L)+"px","animation-delay":p}}}},circular:{dur:1400,elmDuration:!0,circles:1,fn:()=>({r:20,cx:48,cy:48,fill:"none",viewBox:"24 24 48 48",transform:"translate(0,0)",style:{}})},crescent:{dur:750,circles:1,fn:()=>({r:26,style:{}})},dots:{dur:750,circles:3,fn:(V,a)=>({r:6,style:{left:9-9*a+"px","animation-delay":-110*a+"ms"}})},lines:{dur:1e3,lines:8,fn:(V,a,O)=>({y1:14,y2:26,style:{transform:`rotate(${360/O*a+(a<O/2?180:-180)}deg)`,"animation-delay":V*a/O-V+"ms"}})},"lines-small":{dur:1e3,lines:8,fn:(V,a,O)=>({y1:12,y2:20,style:{transform:`rotate(${360/O*a+(a<O/2?180:-180)}deg)`,"animation-delay":V*a/O-V+"ms"}})},"lines-sharp":{dur:1e3,lines:12,fn:(V,a,O)=>({y1:17,y2:29,style:{transform:`rotate(${30*a+(a<6?180:-180)}deg)`,"animation-delay":V*a/O-V+"ms"}})},"lines-sharp-small":{dur:1e3,lines:12,fn:(V,a,O)=>({y1:12,y2:20,style:{transform:`rotate(${30*a+(a<6?180:-180)}deg)`,"animation-delay":V*a/O-V+"ms"}})}}},7300:(_n,Ke,k)=>{"use strict";k.d(Ke,{c:()=>V,g:()=>O,h:()=>c,o:()=>p});var d=k(6099);const c=(L,Q)=>null!==Q.closest(L),V=(L,Q)=>"string"==typeof L&&L.length>0?Object.assign({"ion-color":!0,[`ion-color-${L}`]:!0},Q):Q,O=L=>{const Q={};return(L=>void 0!==L?(Array.isArray(L)?L:L.split(" ")).filter(Z=>null!=Z).map(Z=>Z.trim()).filter(Z=>""!==Z):[])(L).forEach(Z=>Q[Z]=!0),Q},A=/^[a-z][a-z0-9+\-.]*:/,p=function(){var L=(0,d.Z)(function*(Q,Z,z,G){if(null!=Q&&"#"!==Q[0]&&!A.test(Q)){const te=document.querySelector("ion-router");if(te)return null!=Z&&Z.preventDefault(),te.push(Q,z,G)}return!1});return function(Z,z,G,te){return L.apply(this,arguments)}}()},1099:(_n,Ke,k)=>{"use strict";k.d(Ke,{B:()=>G});var d=k(6738),c=k(6579),V=k(9064),a=k(6895);function O(te,ye){if(1&te&&(d.TgZ(0,"ion-badge",7),d._uU(1),d.qZA()),2&te){const me=d.oxw().$implicit;d.xp6(1),d.hij("",me.Quantity," x")}}function A(te,ye){if(1&te&&(d.TgZ(0,"strong"),d._uU(1),d.qZA()),2&te){const me=d.oxw().$implicit;d.xp6(1),d.hij("",me.PowerKW," kW ")}}function p(te,ye){if(1&te&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&te){const me=d.oxw().$implicit;d.xp6(1),d.hij("",null==me.CurrentType?null:me.CurrentType.Title," ")}}function L(te,ye){if(1&te&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&te){const me=d.oxw().$implicit;d.xp6(1),d.hij("",me.Amps,"A ")}}function Q(te,ye){if(1&te&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&te){const me=d.oxw().$implicit;d.xp6(1),d.hij("",me.Voltage,"V ")}}function Z(te,ye){if(1&te){const me=d.EpF();d.TgZ(0,"ion-col"),d.TgZ(1,"ion-button",8),d.NdJ("click",function(){d.CHM(me);const je=d.oxw().$implicit;return d.oxw().editConnection(je)}),d._UZ(2,"ion-icon",9),d.qZA(),d._UZ(3,"br"),d.TgZ(4,"ion-button",10),d.NdJ("click",function(){d.CHM(me);const je=d.oxw().$implicit;return d.oxw().deleteConnection(je)}),d._UZ(5,"ion-icon",11),d.qZA(),d.qZA()}}function z(te,ye){if(1&te&&(d.TgZ(0,"ion-row"),d.TgZ(1,"ion-col"),d.TgZ(2,"ion-row"),d.TgZ(3,"ion-col",1),d._UZ(4,"img",2),d.YNc(5,O,2,1,"ion-badge",3),d.TgZ(6,"div",4),d._uU(7),d.qZA(),d.qZA(),d.TgZ(8,"ion-col"),d.TgZ(9,"ion-row"),d.TgZ(10,"ion-col"),d.TgZ(11,"ion-note"),d.TgZ(12,"div"),d.TgZ(13,"strong",5),d._uU(14),d.qZA(),d.qZA(),d.YNc(15,A,2,1,"strong",6),d.YNc(16,p,2,1,"div",6),d.qZA(),d.TgZ(17,"ion-note"),d.YNc(18,L,2,1,"span",6),d.YNc(19,Q,2,1,"span",6),d.qZA(),d.qZA(),d.qZA(),d.TgZ(20,"ion-row"),d.TgZ(21,"ion-col",4),d._uU(22),d.qZA(),d.TgZ(23,"ion-col",4),d._uU(24),d.qZA(),d.qZA(),d.qZA(),d.YNc(25,Z,6,0,"ion-col",6),d.qZA(),d.qZA(),d.qZA()),2&te){const me=ye.$implicit,Ee=d.oxw();d.xp6(4),d.Q6J("src",Ee.getConnectorTypeIcon(me.ConnectionTypeID),d.LSH),d.xp6(1),d.Q6J("ngIf",me.Quantity),d.xp6(2),d.Oqu(null==me.StatusType?null:me.StatusType.Title),d.xp6(6),d.s9C("title",null==me.ConnectionType?null:me.ConnectionType.FormalName),d.xp6(1),d.hij("",null==me.ConnectionType?null:me.ConnectionType.Title," "),d.xp6(1),d.Q6J("ngIf",me.PowerKW),d.xp6(1),d.Q6J("ngIf",me.CurrentTypeID),d.xp6(2),d.Q6J("ngIf",me.Amps),d.xp6(1),d.Q6J("ngIf",me.Voltage),d.xp6(3),d.Oqu(me.Reference),d.xp6(2),d.Oqu(me.Comments),d.xp6(1),d.Q6J("ngIf",Ee.enableEdit)}}let G=(()=>{class te{constructor(){this.enableEdit=!1,this.onEdit=new d.vpe,this.onDelete=new d.vpe}ngOnInit(){}editConnection(me){this.onEdit.emit(me)}deleteConnection(me){this.onDelete.emit(me)}getConnectorTypeIcon(me){return c.c.getIconForConnector(me)}}return te.\u0275fac=function(me){return new(me||te)},te.\u0275cmp=d.Xpm({type:te,selectors:[["app-equipment-details"]],inputs:{item:"item",enableEdit:"enableEdit"},outputs:{onEdit:"onEdit",onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["size","3"],[2,"max-width","64px",3,"src"],["color","primary",4,"ngIf"],[1,"info"],[3,"title"],[4,"ngIf"],["color","primary"],["size","small","color","secondary",3,"click"],["name","create","slot","icon-only"],["size","small","color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(me,Ee){1&me&&(d.TgZ(0,"ion-grid"),d.YNc(1,z,26,12,"ion-row",0),d.qZA()),2&me&&(d.xp6(1),d.Q6J("ngForOf",Ee.item.Connections))},directives:[V.jY,a.sg,V.Nd,V.wI,a.O5,V.yp,V.uN,V.YG,V.gu],styles:[""]}),te})()},2428:(_n,Ke,k)=>{"use strict";k.d(Ke,{v:()=>G});var d=k(6099),c=k(7689),V=k(6738),a=k(553),O=k(9064),A=k(529),p=k(6260),L=k(6895);function Q(te,ye){1&te&&(V.TgZ(0,"div"),V._UZ(1,"ion-spinner"),V.qZA())}function Z(te,ye){if(1&te){const me=V.EpF();V.TgZ(0,"ion-item",5),V.NdJ("click",function(){const rt=V.CHM(me).$implicit;return V.oxw(2).placeSelected(rt)}),V.TgZ(1,"ion-avatar",6),V._UZ(2,"ion-icon",7),V.qZA(),V.TgZ(3,"ion-label"),V.TgZ(4,"p"),V._uU(5),V.qZA(),V.qZA(),V.qZA()}if(2&te){const me=ye.$implicit;V.xp6(5),V.Oqu(me.Address)}}function z(te,ye){if(1&te&&(V.TgZ(0,"div",1),V.YNc(1,Q,2,0,"div",2),V.TgZ(2,"ion-list"),V.YNc(3,Z,6,1,"ion-item",3),V.TgZ(4,"ion-item"),V.TgZ(5,"p",4),V._uU(6),V.qZA(),V.qZA(),V.qZA(),V.qZA()),2&te){const me=V.oxw();V.xp6(1),V.Q6J("ngIf",me.searchInProgress),V.xp6(2),V.Q6J("ngForOf",me.placeList),V.xp6(3),V.hij(" ",me.placeAttribution," ")}}let G=(()=>{class te{constructor(me,Ee,je,rt,Ae){this.logging=me,this.changeDetector=Ee,this.platform=je,this.http=rt,this.events=Ae,this.searchInProgress=!1,this.placeSearchActive=!1,this.placeAttribution="",this.placeChanged=new V.vpe,this.searchKeyword="",this.searchInProgress=!1,this.mapService=new a.k(Ae,me,rt)}ngOnInit(){var me=this;return(0,d.Z)(function*(){yield me.platform.ready(),me.mapService.initAPI()})()}onSearchFocus(){this.placeSearchFocused=!0}onSearchBlur(){this.placeSearchFocused=!1}onSearchCancel(){}getPlacesAutoComplete(me,Ee){var je=this;return(0,d.Z)(function*(){je.placeSearchType=Ee;let rt=me.target.value;if(rt&&rt.length>3){je.logging.log("Starting place lookup for:"+rt),je.placeSearchActive=!0,je.searchInProgress=!0,je.searchInProgress=!1,je.placeSearchActive=!0;try{je.placeList=yield je.mapService.placeSearch(rt),je.placeList&&je.placeList.length>0&&(je.placeAttribution=je.placeList[0].Attribution)}catch{}je.searchInProgress=!1,je.placeSearchActive=!0}else je.searchInProgress=!1,je.placeSearchActive=!1})()}placeSelected(me){this.logging.log("Looking up place details:"+me.Title+"::"+me.ReferenceID),this.selectedPlace=me,this.placeChanged.emit(me),this.placeSearchActive=!1}}return te.\u0275fac=function(me){return new(me||te)(V.Y36(c.z),V.Y36(V.sBO),V.Y36(O.t4),V.Y36(A.eN),V.Y36(p.z))},te.\u0275cmp=V.Xpm({type:te,selectors:[["place-search"]],inputs:{searchKeyword:"searchKeyword"},outputs:{selectedPlace:"selectedPlace",placeChanged:"placeChanged"},decls:1,vars:1,consts:[["class","place-search",4,"ngIf"],[1,"place-search"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"place-attribution"],[3,"click"],["item-left",""],["name","locate"]],template:function(me,Ee){1&me&&V.YNc(0,z,7,3,"div",0),2&me&&V.Q6J("ngIf",Ee.placeSearchActive)},directives:[L.O5,O.PQ,O.q_,L.sg,O.Ie,O.BJ,O.gu,O.Q$],styles:[".place-search[_ngcontent-%COMP%]{position:absolute;z-index:1000}.place-attribution[_ngcontent-%COMP%]{font-size:9px;color:#dcdcdc;max-width:100%}"]}),te})()},6585:(_n,Ke,k)=>{"use strict";k.d(Ke,{o:()=>L});var d=k(6738),c=k(6579),V=k(9064),a=k(6895);function O(Q,Z){if(1&Q){const z=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(z);const te=d.oxw().$implicit;return d.oxw().onCopyCommand(te)}),d._uU(1,"Copy"),d.qZA()}}function A(Q,Z){if(1&Q){const z=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(z);const te=d.oxw().$implicit;return d.oxw().onEditCommand(te)}),d._uU(1,"Edit"),d.qZA()}}function p(Q,Z){if(1&Q&&(d.TgZ(0,"ion-item",1),d.TgZ(1,"ion-grid"),d.TgZ(2,"ion-row"),d.TgZ(3,"ion-col"),d._uU(4),d.qZA(),d.qZA(),d.TgZ(5,"ion-row"),d.TgZ(6,"ion-col",2),d.TgZ(7,"p"),d._UZ(8,"img",3),d.qZA(),d.TgZ(9,"ion-note"),d._uU(10),d.qZA(),d.YNc(11,O,2,0,"ion-button",4),d.YNc(12,A,2,0,"ion-button",4),d.qZA(),d.TgZ(13,"ion-col"),d.TgZ(14,"ion-row"),d.TgZ(15,"ion-col"),d.TgZ(16,"p"),d._uU(17),d.qZA(),d.TgZ(18,"ion-note"),d._uU(19),d.qZA(),d.qZA(),d.qZA(),d.TgZ(20,"ion-row"),d.TgZ(21,"ion-col"),d._uU(22),d.qZA(),d.TgZ(23,"ion-col"),d._uU(24),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&Q){const z=Z.$implicit,G=d.oxw();d.xp6(4),d.hij(" ",z.AddressInfo.Title," "),d.xp6(4),d.Q6J("src",G.getIconForPOI(z),d.LSH),d.xp6(2),d.hij(" ",G.getFormattedDistance(z)," "),d.xp6(1),d.Q6J("ngIf",G.enableCopyOption),d.xp6(1),d.Q6J("ngIf",G.enableEditOption),d.xp6(5),d.hij(" ",G.getFormattedAddress(z)," "),d.xp6(2),d.hij(" ",G.getFormattedConnectorList(z)," "),d.xp6(3),d.hij(" ",null==z.UsageType?null:z.UsageType.Title," "),d.xp6(2),d.hij(" ",null==z.OperatorInfo?null:z.OperatorInfo.Title," ")}}let L=(()=>{class Q{constructor(){this.enableCopyOption=!1,this.enableEditOption=!1,this.poiList=[],this.onCopy=new d.vpe,this.onEdit=new d.vpe}ngOnInit(){}onCopyCommand(z){this.onCopy.emit(z)}onEditCommand(z){this.onEdit.emit(z)}getFormattedAddress(z){let G="";return G+=z.AddressInfo.Title!=z.AddressInfo.AddressLine1?z.AddressInfo.Title:z.AddressInfo.Town,G}getFormattedConnectorList(z){if(!z.Connections)return;let G=[];for(let te of z.Connections)null!=te.ConnectionType&&(G.find(ye=>ye==te.ConnectionType.Title)||G.push(te.ConnectionType.Title));return G.join(", ")}getIconForPOI(z){return c.c.getIconForPOI(z)}getFormattedDistance(z){return c.c.getFormattedDistance(z)}}return Q.\u0275fac=function(z){return new(z||Q)},Q.\u0275cmp=d.Xpm({type:Q,selectors:[["app-poi-list"]],inputs:{enableCopyOption:"enableCopyOption",enableEditOption:"enableEditOption",poiList:"poiList"},outputs:{onCopy:"onCopy",onEdit:"onEdit"},decls:2,vars:1,consts:[["style","max-width:400px;",4,"ngFor","ngForOf"],[2,"max-width","400px"],["size","3"],[2,"width","24px",3,"src"],["size","small",3,"click",4,"ngIf"],["size","small",3,"click"]],template:function(z,G){1&z&&(d.TgZ(0,"ion-list"),d.YNc(1,p,25,9,"ion-item",0),d.qZA()),2&z&&(d.xp6(1),d.Q6J("ngForOf",G.poiList))},directives:[V.q_,a.sg,V.Ie,V.jY,V.Nd,V.wI,V.uN,a.O5,V.YG],styles:[""]}),Q})()},8936:(_n,Ke,k)=>{"use strict";k.d(Ke,{e:()=>A});var d=k(6895),c=k(9064),V=k(4006),a=k(9397),O=k(6738);let A=(()=>{class p{}return p.\u0275fac=function(Q){return new(Q||p)},p.\u0275mod=O.oAB({type:p}),p.\u0275inj=O.cJS({providers:[d.JJ],imports:[[d.ez,c.Pc,V.u5,a.aw]]}),p})()},2951:(_n,Ke,k)=>{"use strict";k.d(Ke,{X:()=>c});var d=k(2340);class c{constructor(){this.baseURL="https://map.openchargemap.io",this.loginProviderRedirectBaseURL="https://openchargemap.org/site/loginprovider/?_mode=silent&_forceLogin=true&_redirectURL=",this.loginProviderRedirectURL=this.loginProviderRedirectBaseURL+this.baseURL,this.enableLiveMapQuerying=!0,this.googleMapsAPIKey=d.N.googleMapsKey,this.enableStaticMaps=d.N.enableStaticMaps}}},6579:(_n,Ke,k)=>{"use strict";k.d(Ke,{c:()=>c});var d=k(2340);let c=(()=>{class V{static isFeatureEnabled(O){return!!d.N.enabledFeatures.find(A=>A===O)}static getClientHeight(){const O=document.body,A=document.documentElement;return Math.max(O.scrollHeight,O.offsetHeight,A.clientHeight,A.scrollHeight,A.offsetHeight)}static getClientWidth(){const O=document.body,A=document.documentElement;return Math.max(O.scrollWidth,O.offsetWidth,A.clientWidth,A.scrollWidth,A.offsetWidth)}static getMaxLevelOfPOI(O){let A=0;if(null!=O.Connections)for(let p=0;p<O.Connections.length;p++)null!=O.Connections[p].Level&&O.Connections[p].Level.ID>A&&(A=O.Connections[p].Level.ID);return 4===A&&(A=2),A>4&&(A=3),A}static getIconForPOI(O){let p="assets/images/icons/map/level"+V.getMaxLevelOfPOI(O);return null!=O.UsageType&&O.UsageType.Title.indexOf("Private")>-1?p+="_private":p+=null!=O.StatusType&&!0!==O.StatusType.IsOperational?"_nonoperational":"_operational",p+="_icon.png",p}static getColorForPOI(O){const A=V.getMaxLevelOfPOI(O);let p="#c0c0c0";return null!=O.UsageType&&O.UsageType.Title.indexOf("Private")>-1?p="#FF0000":null!=O.StatusType&&!0!==O.StatusType.IsOperational?p="#a0a0a0":2==A?p="#72EB0D":3==A&&(p="#EB800D"),p}static getIconForConnector(O){let A="assets/images/icons/connectors/";return A+=1===O?"Type1_J1772.svg":2===O?"Chademo_type4.svg":25===O?"Type2_socket.svg":32===O?"Type1_CCS.svg":33===O?"Type2_CCS.svg":1036===O?"Type2_tethered.svg":28===O?"schuko.svg":"Unknown.svg",A}static getFormattedDistance(O){return O&&O.AddressInfo&&O.AddressInfo.Distance?O.AddressInfo.Distance.toFixed(1)+" "+(1===O.AddressInfo.DistanceUnit?"km":"miles"):""}static fixJSONDate(O){if(null==O)return null;if(0==O.indexOf("/")){let p=/Date\(([^)]+)\)/.exec(O);O=new Date(parseFloat(p[1]))}else O=new Date(O);return O}static formatMapLinkFromPosition(O,A,p,L,Q){return'<a href="https://maps.google.com/maps?saddr='+A+","+p+"&daddr="+O.AddressInfo.Latitude+","+O.AddressInfo.Longitude+'">Map ('+Math.ceil(L)+" "+Q+")</a>"}static formatSystemWebLink(O,A){return"<a href='#' onclick=\"window.open('"+O+"', '_system');return false;\">"+A+"</a>"}static formatMapLink(O,A,p){return p?device&&"WinCE"==device.platform?this.formatSystemWebLink("maps:"+O.AddressInfo.Latitude+","+O.AddressInfo.Longitude,A):device&&"iOS"===device.platform?this.formatSystemWebLink("https://maps.apple.com/?q="+O.AddressInfo.Latitude+","+O.AddressInfo.Longitude,A):this.formatSystemWebLink("https://maps.google.com/maps?q="+O.AddressInfo.Latitude+","+O.AddressInfo.Longitude,A):'<a target="_blank"  href="https://maps.google.com/maps?q='+O.AddressInfo.Latitude+","+O.AddressInfo.Longitude+'">'+A+"</a>"}static formatURL(O,A=null){return null==O||""==O?"":(-1==O.indexOf("http")&&(O="https://"+O),'<a target="_blank" href="'+O+'">'+(A??O)+"</a>")}static formatString(O){return null==O?"":O.toString()}static formatTextField(O,A=null,p=!1,L=!1,Q=null){if(null==O||""==O||null==O)return"";let Z=(null!=A?"<strong class='ocm-label' "+(null!=Q?"data-localize='"+Q+"' ":"")+">"+A+"</strong>: ":"")+(p?"<br/>":"")+O.toString().replace("\n","<br/>")+"<br/>";return 1==L&&(Z="<p>"+Z+"</p>"),Z}static formatEmailAddress(O){return null!=O&&null!=O&&""!=O?"<i class='fa fa-envelope fa-fw'></i> <a href=\"mailto:"+O+'">'+O+"</a><br/>":""}static formatPhone(O,A=null){return null!=O&&null!=O&&""!=O?(null==A?A="<i class='fa fa-phone fa-fw '></i> ":A+=": ",A+'<a href="tel:'+O+'">'+O+"</a><br/>"):""}static formatPOIDetails(O,A){let L=new Date;null==A&&(A=!1);let Q=this.formatPOIAddress(O,!1),Z="";Z+=this.formatPhone(O.AddressInfo.ContactTelephone1),Z+=this.formatPhone(O.AddressInfo.ContactTelephone2),Z+=this.formatEmailAddress(O.AddressInfo.ContactEmail);let z="";if(null!=O.AddressInfo.Distance){let je="https://maps.google.com/maps?saddr=&daddr="+O.AddressInfo.Latitude+","+O.AddressInfo.Longitude;z+="<strong id='addr_distance'><span data-localize='details.approxDistance'>Distance</span>: "+O.AddressInfo.Distance.toFixed(1)+" "+(2==O.AddressInfo.DistanceUnit?"Miles":"KM")+"</strong>",z+="<p>"+this.formatSystemWebLink(je,"Get Directions")+"</p>"}if(null!=O.AddressInfo.RelatedURL&&""!=O.AddressInfo.RelatedURL){let je=O.AddressInfo.RelatedURL;je=je.replace(/.*?:\/\//g,""),je.length>40&&(je=je.substr(0,40)+".."),Z+="<i class='fa fa-fw fa-external-link'></i>  "+this.formatSystemWebLink(O.AddressInfo.RelatedURL,"<span data-localize='details.addressRelatedURL'>"+je+"</span>")}Z+="</p>";const G=this.formatTextField(O.GeneralComments,null,!1,!0)+this.formatTextField(O.AddressInfo.AccessComments,"Access",!0,!0,"details.accessComments");let te="";null!=O.NumberOfPoints&&(te+=this.formatTextField(O.NumberOfPoints,"Bays",!1,!0,"details.numberOfPoints")),null!=O.UsageType&&(te+=this.formatTextField(O.UsageType.Title,"Usage",!1,!0,"details.usageType")),null!=O.UsageCost&&(te+=this.formatTextField(O.UsageCost,"Usage Cost",!1,!0,"details.usageCost")),null!=O.OperatorInfo&&1!=O.OperatorInfo.ID&&(te+=this.formatTextField(O.OperatorInfo.Title,"Operator",!1,!0,"details.operatorTitle"),null!=O.OperatorInfo.WebsiteURL&&(te+=this.formatTextField(this.formatURL(O.OperatorInfo.WebsiteURL),"Operator Website",!0,!0,"details.operatorWebsite")));let ye="";if(null!=O.StatusType&&(ye+=this.formatTextField(O.StatusType.Title,"Status",!1,!0,"details.operationalStatus"),null!=O.DateLastStatusUpdate&&(ye+=this.formatTextField(Math.round((L-this.fixJSONDate(O.DateLastStatusUpdate))/864e5)+" days ago","Last Updated",!1,!0,"details.lastUpdated"))),null!=O.Connections&&O.Connections.length>0){ye+="<table class='table table-striped'>",ye+="<tr><th data-localize='details.equipment.connectionType'>Connection</th><th data-localize='details.equipment.powerLevel'>Power Level</th><th data-localize='details.operationalStatus'>Status</th></tr>";for(let je=0;je<O.Connections.length;je++){let rt=O.Connections[je];""==rt.Amps&&(rt.Amps=null),""==rt.Voltage&&(rt.Voltage=null),""==rt.Quantity&&(rt.Quantity=null),""==rt.PowerKW&&(rt.PowerKW=null),ye+="<tr><td>"+(null!=rt.ConnectionType?rt.ConnectionType.Title:"")+"</td><td>"+(null!=rt.Level?"<strong>"+rt.Level.Title+"</strong><br/>":"")+(null!=rt.Amps?this.formatString(rt.Amps)+"A/ ":"")+(null!=rt.Voltage?this.formatString(rt.Voltage)+"V/ ":"")+(null!=rt.PowerKW?this.formatString(rt.PowerKW)+"kW <br/>":"")+(null!=rt.CurrentType?rt.CurrentType.Title:"")+"<br/>"+(null!=rt.Quantity?this.formatString(rt.Quantity):"1")+" Present</td><td>"+(null!=rt.StatusType?rt.StatusType.Title:"-")+"</td></tr>"}ye+="</table>"}let me="";return me+=this.formatTextField("<a target='_blank' href='https://openchargemap.org/site/poi/details/"+O.ID+"'>OCM-"+O.ID+"</a>","OpenChargeMap Ref",!1,!0,"details.refNumber"),null!=O.DataProvider&&(me+=this.formatTextField(O.DataProvider.Title,"Data Provider",!1,!0,"details.dataProviderTitle"),null!=O.DataProvider.WebsiteURL&&(me+=this.formatTextField(this.formatURL(O.DataProvider.WebsiteURL),"Website",!1,!0,"details.dataProviderWebsite")),me+=this.formatTextField(O.AddressInfo.Latitude,"Latitude",!1,!0,null),me+=this.formatTextField(O.AddressInfo.Longitude,"Longitude",!1,!0,null)),{address:Q,drivingInfo:z,contactInfo:Z,additionalInfo:G+te+ye,advancedInfo:me}}static debounce(O,A,p){let L;return function(){let Q=this,Z=arguments,z=function(){L=null,p||O.apply(Q,Z)},G=p&&!L;clearTimeout(L),L=setTimeout(z,A),G&&O.apply(Q,Z)}}static getRandomInt(O){return Math.floor(Math.random()*Math.floor(O))}}return V.formatPOIAddress=function(a,O=!0){let A="";return A=O?""+this.formatTextField(a.AddressInfo.AddressLine1)+this.formatTextField(a.AddressInfo.AddressLine2)+this.formatTextField(a.AddressInfo.Town)+this.formatTextField(a.AddressInfo.StateOrProvince)+this.formatTextField(a.AddressInfo.Postcode)+(null!=a.AddressInfo.Country?this.formatTextField(a.AddressInfo.Country.Title):""):this.formatStringArray([a.AddressInfo.AddressLine1,a.AddressInfo.AddressLine2,a.AddressInfo.Town,a.AddressInfo.StateOrProvince,a.AddressInfo.Postcode,null!=a.AddressInfo.Country?a.AddressInfo.Country.Title:""]),A},V.formatStringArray=function(a,O=", "){if(null==a)return"";let A="";for(let p=0;p<a.length;p++)null!=a[p]&&""!=a[p].trim()&&(A+=p==a.length-1?a[p]:a[p]+O);return A},V})()},4120:(_n,Ke,k)=>{"use strict";k.d(Ke,{wC:()=>d,jR:()=>c,LL:()=>V});class d{constructor(O=null,A=null){this.latitude=O,this.longitude=A}}class c{constructor(O=null,A=null){this.coords=new d,this.coords.latitude=O,this.coords.longitude=A}static fromPosition(O){return new c(O.coords.latitude,O.coords.longitude)}}class V{constructor(O,A){this.northEast=O,this.southWest=A}}},129:(_n,Ke,k)=>{"use strict";k.d(Ke,{Qp:()=>V,fw:()=>A,JJ:()=>L,eN:()=>p,vw:()=>O,kA:()=>a});class d{constructor(Z,z){this.itemType=Z,this.itemId=d.getNewItemId(),this.version=1,this.schemaVersion=z,this.syncTimeStamp=d.getNewSyncTimeStamp()}static getNewSyncTimeStamp(){return Date.now().toString()}static getNewItemId(){return"_syncitem_"+Date.now().toString()}}class c{constructor(Z,z){this._sync=new d(Z,z)}}class V extends c{}class a extends c{constructor(){super("waypoint",1)}}class O extends c{constructor(){super("journey_stage",1),this.WayPoints=[]}}class A extends c{constructor(){super("journey",1),this.ID=""+Date.now(),this.Stages=[]}}class p{}class L{}},2206:(_n,Ke,k)=>{"use strict";k.d(Ke,{b:()=>d});class d{constructor(){this.poiIdList=null,this.countryCode=null,this.latitude=null,this.longitude=null,this.locationTitle=null,this.distance=null,this.distanceUnit=null,this.connectionTypeIdList=null,this.operatorIdList=null,this.levelIdList=null,this.countryIdList=null,this.usageTypeIdList=null,this.statusTypeIdList=null,this.minPowerKW=null,this.maxPowerKW=null,this.submissionStatusTypeIdList=null,this.maxResults=500,this.additionalParams=null,this.includeComments=!1,this.compact=!0,this.enableCaching=!0,this.levelOfDetail=1,this.polyline=null,this.boundingbox=null}}},4209:(_n,Ke,k)=>{"use strict";k.d(Ke,{n:()=>d});class d{}},7627:(_n,Ke,k)=>{"use strict";k.d(Ke,{U:()=>d,N:()=>c});const d=650;class c{constructor(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MaxPowerKW=null,this.MinPowerKW=null,this.HasActiveFilters=!1,this.FilterOptionsByCountryId=null,this.UseDistanceInKM=!0,this.MapType="ROADMAP",this.EnableAdvancedEditorFeatures=!1}LoadSettings(){}SaveSettings(){}ClearActiveFilters(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MinPowerKW=null,this.MaxPowerKW=null}CheckForActiveFilters(){return this.HasActiveFilters=this.OperatorList.length>0||this.ConnectionTypeList.length>0||this.CountryList.length>0||this.UsageTypeList.length>0||this.StatusTypeList.length>0||this.MinPowerKW>0||this.MaxPowerKW>0||null!=this.MaxPowerKW&&this.MaxPowerKW<d,this.HasActiveFilters}}},8649:(_n,Ke,k)=>{"use strict";k.d(Ke,{q:()=>d});var d=(()=>{return(c=d||(d={}))[c.POI=0]="POI",c[c.Comment=1]="Comment",c[c.Media=2]="Media",d;var c})()},534:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{AboutPageModule:()=>Z});var d=k(6895),c=k(4006),V=k(9064),a=k(3334),O=k(388),A=k(6738);const p=[{path:"",component:O.t}];let L=(()=>{class z{}return z.\u0275fac=function(te){return new(te||z)},z.\u0275mod=A.oAB({type:z}),z.\u0275inj=A.cJS({imports:[[a.Bz.forChild(p)],a.Bz]}),z})();var Q=k(9397);let Z=(()=>{class z{}return z.\u0275fac=function(te){return new(te||z)},z.\u0275mod=A.oAB({type:z}),z.\u0275inj=A.cJS({imports:[[d.ez,c.u5,V.Pc,Q.aw,L]]}),z})()},388:(_n,Ke,k)=>{"use strict";k.d(Ke,{t:()=>O});var d=k(2340),c=k(6738),V=k(9064),a=k(9397);let O=(()=>{class A{constructor(L){this.modalController=L}get appVersion(){return d.N.version}get apiUrl(){return d.N.apiBase}ngOnInit(){}close(){this.modalController.dismiss()}}return A.\u0275fac=function(L){return new(L||A)(c.Y36(V.IN))},A.\u0275cmp=c.Xpm({type:A,selectors:[["app-about"]],decls:49,vars:5,consts:[[1,"ion-padding"],["size","2"],["src","assets/images/icons/branding/AppIcon_128x128.png",2,"padding-top","2em"],["href","https://openchargemap.org"],["href","https://community.openchargemap.org"],["href","https://github.com/openchargemap/ocm-system/issues"],["href","https://webprofusion.com"],["href","https://opencollective.com/openchargemap"],["slot","end"],[3,"click"],["name","close","slot","start"]],template:function(L,Q){1&L&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title"),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(5,"ion-content",0),c.TgZ(6,"ion-grid"),c.TgZ(7,"ion-row"),c.TgZ(8,"ion-col",1),c._UZ(9,"img",2),c.qZA(),c.TgZ(10,"ion-col"),c.TgZ(11,"h1"),c._uU(12,"Open Charge Map"),c.qZA(),c.TgZ(13,"h2"),c._uU(14,"The global public registry of Electric Vehicle charging locations"),c.qZA(),c.TgZ(15,"p"),c._uU(16,"Web: "),c.TgZ(17,"a",3),c._uU(18,"https://openchargemap.org"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(19,"p"),c._uU(20,"Community Discussions: "),c.TgZ(21,"a",4),c._uU(22,"https://community.openchargemap.org"),c.qZA(),c.qZA(),c.TgZ(23,"p"),c._uU(24,"App or System Bugs and feature suggestions: "),c.TgZ(25,"a",5),c._uU(26,"GitHub"),c.qZA(),c.qZA(),c.TgZ(27,"p"),c._uU(28,"App development by Webprofusion Pty Ltd ("),c.TgZ(29,"a",6),c._uU(30,"https://webprofusion.com"),c.qZA(),c._uU(31,")"),c.qZA(),c.TgZ(32,"h3"),c._uU(33,"Funding"),c.qZA(),c.TgZ(34,"p"),c._uU(35,"Our software is developed and hosted by volunteers, our data is crowdsourced by you. To help further development please encourage your organisation to sponsor us: "),c.TgZ(36,"a",7),c._uU(37,"Open Collective"),c.qZA(),c.qZA(),c.TgZ(38,"ion-note"),c.TgZ(39,"p"),c._uU(40),c.qZA(),c.TgZ(41,"p"),c._uU(42),c.qZA(),c.qZA(),c.qZA(),c.TgZ(43,"ion-footer"),c.TgZ(44,"ion-toolbar"),c.TgZ(45,"ion-buttons",8),c.TgZ(46,"ion-button",9),c.NdJ("click",function(){return Q.close()}),c._UZ(47,"ion-icon",10),c._uU(48," Close "),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&L&&(c.xp6(3),c.Oqu(c.lcZ(4,3,"ocm.general.about")),c.xp6(37),c.hij("App Version: ",Q.appVersion,""),c.xp6(2),c.hij("API: ",Q.apiUrl,""))},directives:[V.Gu,V.sr,V.wd,V.W2,V.jY,V.Nd,V.wI,V.uN,V.fr,V.Sm,V.YG,V.gu],pipes:[a.X$],styles:[""]}),A})()},5476:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{JourneysModule:()=>Q});var d=k(9741),c=k(8936),V=k(9397),a=k(6895),O=k(4006),A=k(9064),p=k(3334),L=k(6738);let Q=(()=>{class Z{}return Z.\u0275fac=function(G){return new(G||Z)},Z.\u0275mod=L.oAB({type:Z}),Z.\u0275inj=L.cJS({imports:[[a.ez,O.u5,A.Pc,V.aw,c.e,p.Bz.forChild([{path:"",component:d.g}])]]}),Z})()},9741:(_n,Ke,k)=>{"use strict";k.d(Ke,{g:()=>Ze});var d=k(3912),c=k(7814),V=k(3855),a=k(4120),O=k(3399),A=k(6738),p=k(9064),L=k(6895);function Q(Ve,He){1&Ve&&(A.TgZ(0,"p"),A._uU(1," You have no journeys yet. Start by browsing to a charging location, then add it as Favourite to start a new Journey. "),A.qZA())}function Z(Ve,He){if(1&Ve&&(A.TgZ(0,"p"),A._uU(1),A.qZA()),2&Ve){const Ne=A.oxw(2).$implicit;A.xp6(1),A.hij(" ",Ne.Poi.AddressInfo.AddressLine1,"")}}function z(Ve,He){if(1&Ve&&(A.TgZ(0,"p"),A._uU(1),A.qZA()),2&Ve){const Ne=A.oxw(2).$implicit;A.xp6(1),A.hij(" ",Ne.Poi.AddressInfo.AddressLine2,"")}}function G(Ve,He){if(1&Ve&&(A.TgZ(0,"p"),A._uU(1),A.qZA()),2&Ve){const Ne=A.oxw(2).$implicit;A.xp6(1),A.hij(" ",Ne.Poi.AddressInfo.Town,"")}}function te(Ve,He){if(1&Ve&&(A.TgZ(0,"p"),A._uU(1),A.qZA()),2&Ve){const Ne=A.oxw(2).$implicit;A.xp6(1),A.hij(" ",Ne.Poi.AddressInfo.StateOrProvince,"")}}function ye(Ve,He){if(1&Ve&&(A.TgZ(0,"p"),A._uU(1),A.qZA()),2&Ve){const Ne=A.oxw(2).$implicit;A.xp6(1),A.hij(" ",Ne.Poi.AddressInfo.Postcode,"")}}function me(Ve,He){if(1&Ve){const Ne=A.EpF();A.TgZ(0,"div"),A.TgZ(1,"div",18),A.NdJ("click",function(){A.CHM(Ne);const Je=A.oxw().$implicit;return A.oxw(4).viewPOIDetails(Je.Poi)}),A.YNc(2,Z,2,1,"p",4),A.YNc(3,z,2,1,"p",4),A.YNc(4,G,2,1,"p",4),A.YNc(5,te,2,1,"p",4),A.YNc(6,ye,2,1,"p",4),A.qZA(),A.TgZ(7,"ion-button",19),A.NdJ("click",function(){A.CHM(Ne);const Je=A.oxw().$implicit;return A.oxw(4).launchNavigation(Je.Poi)}),A._UZ(8,"ion-icon",20),A._uU(9," Navigate "),A.qZA(),A.qZA()}if(2&Ve){const Ne=A.oxw().$implicit;A.xp6(2),A.Q6J("ngIf",Ne.Poi.AddressInfo.AddressLine1),A.xp6(1),A.Q6J("ngIf",Ne.Poi.AddressInfo.AddressLine2),A.xp6(1),A.Q6J("ngIf",Ne.Poi.AddressInfo.Town),A.xp6(1),A.Q6J("ngIf",Ne.Poi.AddressInfo.StateOrProvince),A.xp6(1),A.Q6J("ngIf",Ne.Poi.AddressInfo.Postcode)}}function Ee(Ve,He){if(1&Ve&&(A.TgZ(0,"div",17),A.YNc(1,me,10,5,"div",4),A.qZA()),2&Ve){const Ne=He.$implicit;A.xp6(1),A.Q6J("ngIf",Ne.Poi)}}function je(Ve,He){if(1&Ve&&(A.TgZ(0,"ion-item"),A.TgZ(1,"h2"),A._uU(2),A.qZA(),A.TgZ(3,"ion-thumbnail",0),A._UZ(4,"ion-icon",15),A.qZA(),A.TgZ(5,"p"),A._uU(6),A.qZA(),A.YNc(7,Ee,2,1,"div",16),A.qZA()),2&Ve){const Ne=He.$implicit;A.xp6(2),A.Oqu(Ne.Title),A.xp6(4),A.Oqu(Ne.Notes),A.xp6(1),A.Q6J("ngForOf",Ne.PoiList)}}function rt(Ve,He){if(1&Ve&&(A.TgZ(0,"ion-list"),A.TgZ(1,"ion-list-header",11),A._uU(2),A._UZ(3,"ion-icon",12),A._uU(4," -- "),A._UZ(5,"ion-icon",13),A._uU(6," -- "),A._UZ(7,"ion-icon",14),A._uU(8," -- "),A.qZA(),A.YNc(9,je,8,3,"ion-item",5),A.qZA()),2&Ve){const Ne=He.$implicit;A.xp6(2),A.hij(" ",Ne.Title," "),A.xp6(7),A.Q6J("ngForOf",Ne.WayPoints)}}function Ae(Ve,He){if(1&Ve){const Ne=A.EpF();A.TgZ(0,"ion-card"),A.TgZ(1,"ion-card-content"),A.TgZ(2,"ion-toolbar",8),A.TgZ(3,"ion-title"),A._uU(4),A.qZA(),A.TgZ(5,"ion-buttons",9),A.TgZ(6,"ion-button",1),A.NdJ("click",function(){const ct=A.CHM(Ne).$implicit;return A.oxw().deleteJourney(ct.ID)}),A._UZ(7,"ion-icon",10),A.qZA(),A.qZA(),A.qZA(),A.TgZ(8,"p"),A._uU(9),A.qZA(),A.YNc(10,rt,10,2,"ion-list",5),A.qZA(),A.qZA()}if(2&Ve){const Ne=He.$implicit;A.xp6(4),A.hij(" ",Ne.Title,""),A.xp6(5),A.Oqu(Ne.Notes),A.xp6(1),A.Q6J("ngForOf",Ne.Stages)}}let Ze=(()=>{class Ve{constructor(Ne,xt,Je,ct,wt){this.appManager=Ne,this.journeyManager=xt,this.api=Je,this.modalController=ct,this.alertController=wt}dismiss(){this.modalController.dismiss()}discoverImages(){this.journeyManager.journeys.forEach(Ne=>{Ne.Stages.forEach(xt=>{xt.WayPoints.forEach(Je=>{null!=Je.PoiList&&Je.PoiList.forEach(ct=>{ct.Poi&&this.api.getPanoramioLocationPhotos(new a.wC(ct.Poi.AddressInfo.Latitude,ct.Poi.AddressInfo.Longitude)).then(wt=>{ct.Photos=wt})})})})})}getJson(Ne){return JSON.stringify(Ne,null,4)}viewPOIDetails(Ne){this.modalController.create({component:O.H,componentProps:{item:Ne}}).then(xt=>xt.present())}get staticMapSize(){return"60x60"}getStaticMapURL(Ne){return"https://maps.googleapis.com/maps/api/staticmap?center="+Ne.AddressInfo.Latitude+","+Ne.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+Ne.AddressInfo.Latitude+","+Ne.AddressInfo.Longitude}deleteJourney(Ne){this.alertController.create({header:"Delete this Journey?",message:"Are you sure you want to delete this Journey?",buttons:[{text:"No",handler:()=>{}},{text:"Delete",handler:()=>{this.journeyManager.deleteJourney(Ne)}}]}).then(xt=>xt.present())}launchNavigation(Ne){let xt="https://maps.google.com/?q="+Ne.AddressInfo.Latitude+","+Ne.AddressInfo.Longitude;this.appManager.platform.is("ios")&&(xt="https://maps.apple.com?q="+Ne.AddressInfo.Latitude+","+Ne.AddressInfo.Longitude),window.open(xt,"_system")}}return Ve.\u0275fac=function(Ne){return new(Ne||Ve)(A.Y36(V.c),A.Y36(d.i),A.Y36(c.l),A.Y36(p.IN),A.Y36(p.Br))},Ve.\u0275cmp=A.Xpm({type:Ve,selectors:[["ng-component"]],decls:18,vars:2,consts:[["slot","start"],[3,"click"],[1,"journeys-page"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","end"],["name","close","slot","start"],["primary",""],["slot","primary"],["name","close","slot","icon-only"],[2,"font-size","1.5rem"],["name","car"],["name","time"],["name","flash"],["name","caret-down",2,"font-size","4rem"],["style","text-align:right;width:100%;",4,"ngFor","ngForOf"],[2,"text-align","right","width","100%"],["tappable","",3,"click"],["clear","","item-right","",3,"click"],["name","navigate","slot","start"]],template:function(Ne,xt){1&Ne&&(A.TgZ(0,"ion-header"),A.TgZ(1,"ion-toolbar"),A.TgZ(2,"ion-buttons",0),A.TgZ(3,"ion-back-button",1),A.NdJ("click",function(){return xt.dismiss()}),A.qZA(),A.qZA(),A.TgZ(4,"ion-title"),A._uU(5," Journeys "),A.qZA(),A.qZA(),A.qZA(),A.TgZ(6,"ion-content",2),A.TgZ(7,"div",3),A.TgZ(8,"p"),A._uU(9," You can create and plan journeys to group your favourite charging routes together. "),A.qZA(),A.YNc(10,Q,2,0,"p",4),A.qZA(),A.YNc(11,Ae,11,3,"ion-card",5),A.qZA(),A.TgZ(12,"ion-footer"),A.TgZ(13,"ion-toolbar"),A.TgZ(14,"ion-buttons",6),A.TgZ(15,"ion-button",1),A.NdJ("click",function(){return xt.dismiss()}),A._UZ(16,"ion-icon",7),A._uU(17," Close "),A.qZA(),A.qZA(),A.qZA(),A.qZA()),2&Ne&&(A.xp6(10),A.Q6J("ngIf",null==xt.journeyManager.journeys||0==xt.journeyManager.journeys.length),A.xp6(1),A.Q6J("ngForOf",xt.journeyManager.journeys))},directives:[p.Gu,p.sr,p.Sm,p.oU,p.cs,p.wd,p.W2,L.O5,L.sg,p.PM,p.FN,p.YG,p.gu,p.q_,p.yh,p.Ie,p.Bs,p.fr],encapsulation:2}),Ve})()},5005:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{LayerEditorPageModule:()=>Z});var d=k(6895),c=k(4006),V=k(9064),a=k(3334),O=k(6588),A=k(6738);const p=[{path:"",component:O.A}];let L=(()=>{class z{}return z.\u0275fac=function(te){return new(te||z)},z.\u0275mod=A.oAB({type:z}),z.\u0275inj=A.cJS({imports:[[a.Bz.forChild(p)],a.Bz]}),z})();var Q=k(8936);let Z=(()=>{class z{}return z.\u0275fac=function(te){return new(te||z)},z.\u0275mod=A.oAB({type:z}),z.\u0275inj=A.cJS({imports:[[d.ez,c.u5,V.Pc,L,Q.e]]}),z})()},6588:(_n,Ke,k)=>{"use strict";k.d(Ke,{A:()=>L});var d=k(6099),c=k(6799),V=k(6738),a=k(9064),O=k(6895),A=k(6585);function p(Q,Z){if(1&Q&&(V.TgZ(0,"div"),V._uU(1),V._UZ(2,"app-poi-list",10),V.qZA()),2&Q){const z=V.oxw();V.xp6(1),V.hij(" Items Parsed: ",z.fileData.length," "),V.xp6(1),V.Q6J("poiList",z.fileData)}}let L=(()=>{class Q{constructor(z,G){this.modalController=z,this.refData=G}ngOnInit(){}previewFile(){var z=this;return(0,d.Z)(function*(){yield z.loadFile(!1)})()}cancel(){var z=this;return(0,d.Z)(function*(){yield z.modalController.dismiss(z.fileData)})()}loadFile(z=!0){var G=this;return(0,d.Z)(function*(){const te=new FileReader;te.onload=()=>{let me=JSON.parse(te.result);for(let Ee of me)Ee.ID="imp_"+Ee.ID;G.fileData=G.refData.hydrateCompactPOIList(me),z&&G.modalController.dismiss(G.fileData)},te.onerror=()=>{},te.readAsText(document.getElementById("file-upload").files[0])})()}add(){var z=this;return(0,d.Z)(function*(){z.modalController.dismiss(z.fileData)})()}}return Q.\u0275fac=function(z){return new(z||Q)(V.Y36(a.IN),V.Y36(c.W))},Q.\u0275cmp=V.Xpm({type:Q,selectors:[["app-layer-editor"]],decls:27,vars:1,consts:[[1,"ion-padding"],[1,"upload"],["name","file","aria-label","file","slot","start"],["type","file","required","","id","file-upload",3,"change"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","checkmark-circle-outline","slot","end"],[3,"poiList"]],template:function(z,G){1&z&&(V.TgZ(0,"ion-header"),V.TgZ(1,"ion-toolbar"),V.TgZ(2,"ion-title"),V._uU(3," Edit Layer "),V.qZA(),V.qZA(),V.qZA(),V.TgZ(4,"ion-content",0),V.TgZ(5,"p"),V._uU(6,"POI layers are used to preview data from other Open Data sources. "),V.qZA(),V.TgZ(7,"p"),V._uU(8,"Select a POI layer JSON file: "),V.qZA(),V.TgZ(9,"div"),V.TgZ(10,"label",1),V.TgZ(11,"ion-button"),V._UZ(12,"ion-icon",2),V.TgZ(13,"ion-label"),V._uU(14,"Choose File.."),V.qZA(),V.qZA(),V.TgZ(15,"input",3),V.NdJ("change",function(){return G.previewFile()}),V.qZA(),V.qZA(),V.qZA(),V.YNc(16,p,3,2,"div",4),V.qZA(),V.TgZ(17,"ion-footer"),V.TgZ(18,"ion-toolbar"),V.TgZ(19,"ion-buttons",5),V.TgZ(20,"ion-button",6),V.NdJ("click",function(){return G.cancel()}),V._UZ(21,"ion-icon",7),V._uU(22," Cancel "),V.qZA(),V.qZA(),V.TgZ(23,"ion-buttons",8),V.TgZ(24,"ion-button",6),V.NdJ("click",function(){return G.add()}),V._uU(25," Add "),V._UZ(26,"ion-icon",9),V.qZA(),V.qZA(),V.qZA(),V.qZA()),2&z&&(V.xp6(16),V.Q6J("ngIf",G.fileData&&G.fileData.length>0))},directives:[a.Gu,a.sr,a.wd,a.W2,a.YG,a.gu,a.Q$,O.O5,A.o,a.fr,a.Sm],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),Q})()},3399:(_n,Ke,k)=>{"use strict";k.d(Ke,{H:()=>ur});var d=k(3855),c=k(6738),V=k(9064),a=k(6099),O=k(3912),A=k(129),p=k(4006),L=k(6895);function Q(re,K){if(1&re&&(c.TgZ(0,"ion-select-option",13),c._uU(1),c.qZA()),2&re){const F=K.$implicit;c.Q6J("value",F.ID),c.xp6(1),c.Oqu(F.Title)}}function Z(re,K){if(1&re&&(c.TgZ(0,"ion-select-option",16),c._uU(1),c.qZA()),2&re){const F=K.$implicit;c.Q6J("value",K.index),c.xp6(1),c.Oqu(F.Title)}}function z(re,K){if(1&re){const F=c.EpF();c.TgZ(0,"ion-item"),c.TgZ(1,"ion-label",2),c._uU(2,"Journey Stage"),c.qZA(),c.TgZ(3,"ion-select",3),c.NdJ("ngModelChange",function(_e){return c.CHM(F),c.oxw().selectedStageIndex=_e}),c.TgZ(4,"ion-select-option",14),c._uU(5,"Create a Journey Stage"),c.qZA(),c.YNc(6,Z,2,2,"ion-select-option",15),c.qZA(),c.qZA()}if(2&re){const F=c.oxw();c.xp6(3),c.Q6J("ngModel",F.selectedStageIndex),c.xp6(3),c.Q6J("ngForOf",F.journeyManager.getJourneyStages(F.selectedJourneyID))}}function G(re,K){if(1&re){const F=c.EpF();c.TgZ(0,"ion-item"),c.TgZ(1,"ion-label",2),c._uU(2,"New Journey Name"),c.qZA(),c.TgZ(3,"ion-input",7),c.NdJ("ngModelChange",function(_e){return c.CHM(F),c.oxw().newJourneyName=_e}),c.qZA(),c.qZA()}if(2&re){const F=c.oxw();c.xp6(3),c.Q6J("ngModel",F.newJourneyName)}}let te=(()=>{class re{constructor(F,fe,_e,Qe){this.appManager=F,this.navParams=fe,this.journeyManager=_e,this.modalController=Qe,this.poi=this.navParams.get("poi"),this.waypoint=new A.kA,this.waypoint.Title=this.poi.AddressInfo.Title,this.waypoint.PoiIDs=[this.poi.ID],this.waypoint.PoiList=[];const vt=new A.Qp("charging",1);vt.Poi=this.poi,vt.PoiID=this.poi.ID,this.waypoint.PoiList.push(vt),this.newJourneyName="Trip to "+this.poi.AddressInfo.Title}cancel(){this.modalController.dismiss()}add(){if(null!=this.selectedJourneyID&&""!==this.selectedJourneyID)this.journeyManager.addJourneyWaypoint(this.selectedJourneyID,this.selectedStageIndex,this.waypoint);else{const F=new A.fw;F.ID=Date.now().toString(),""===this.newJourneyName&&(this.newJourneyName="New Journey"),F.Title=this.newJourneyName,this.journeyManager.addJourney(F,this.waypoint)}this.journeyManager.saveJourneys(),this.modalController.dismiss()}}return re.\u0275fac=function(F){return new(F||re)(c.Y36(d.c),c.Y36(V.X1),c.Y36(O.i),c.Y36(V.IN))},re.\u0275cmp=c.Xpm({type:re,selectors:[["ng-component"]],decls:39,vars:8,consts:[[1,"journeys-page","ion-padding"],[1,"banner"],["position","stacked"],[3,"ngModel","ngModelChange"],["value","","checked",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","add","slot","end"],[3,"value"],["value",""],["checked","",3,"value",4,"ngFor","ngForOf"],["checked","",3,"value"]],template:function(F,fe){1&F&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title"),c._uU(3," Edit Favourite "),c.qZA(),c.qZA(),c.qZA(),c.TgZ(4,"ion-content",0),c.TgZ(5,"div",1),c.TgZ(6,"h1"),c._uU(7),c.qZA(),c.TgZ(8,"p"),c._uU(9),c.qZA(),c.qZA(),c.TgZ(10,"p"),c._uU(11," Add Charging Location as a Journey Waypoint "),c.qZA(),c.TgZ(12,"ion-item"),c.TgZ(13,"ion-label",2),c._uU(14,"Add to a Journey"),c.qZA(),c.TgZ(15,"ion-select",3),c.NdJ("ngModelChange",function(Qe){return fe.selectedJourneyID=Qe}),c.TgZ(16,"ion-select-option",4),c._uU(17,"Create a New Journey"),c.qZA(),c.YNc(18,Q,2,2,"ion-select-option",5),c.qZA(),c.qZA(),c.YNc(19,z,7,2,"ion-item",6),c.YNc(20,G,4,1,"ion-item",6),c.TgZ(21,"ion-item"),c.TgZ(22,"ion-label",2),c._uU(23,"Name for this step of your journey"),c.qZA(),c.TgZ(24,"ion-input",7),c.NdJ("ngModelChange",function(Qe){return fe.waypoint.Title=Qe}),c.qZA(),c.qZA(),c.TgZ(25,"ion-item"),c.TgZ(26,"ion-label",2),c._uU(27,"Other Notes"),c.qZA(),c.TgZ(28,"ion-textarea",3),c.NdJ("ngModelChange",function(Qe){return fe.waypoint.Notes=Qe}),c.qZA(),c.qZA(),c.qZA(),c.TgZ(29,"ion-footer"),c.TgZ(30,"ion-toolbar"),c.TgZ(31,"ion-buttons",8),c.TgZ(32,"ion-button",9),c.NdJ("click",function(){return fe.cancel()}),c._UZ(33,"ion-icon",10),c._uU(34," Cancel "),c.qZA(),c.qZA(),c.TgZ(35,"ion-buttons",11),c.TgZ(36,"ion-button",9),c.NdJ("click",function(){return fe.add()}),c._uU(37," Add "),c._UZ(38,"ion-icon",12),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&F&&(c.xp6(7),c.Oqu(fe.poi.AddressInfo.Title),c.xp6(2),c.Oqu(fe.poi.AddressInfo.AddressLine1),c.xp6(6),c.Q6J("ngModel",fe.selectedJourneyID),c.xp6(3),c.Q6J("ngForOf",fe.journeyManager.journeys),c.xp6(1),c.Q6J("ngIf",fe.selectedJourneyID),c.xp6(1),c.Q6J("ngIf",!fe.selectedJourneyID),c.xp6(4),c.Q6J("ngModel",fe.waypoint.Title),c.xp6(4),c.Q6J("ngModel",fe.waypoint.Notes))},directives:[V.Gu,V.sr,V.wd,V.W2,V.Ie,V.Q$,V.t9,V.QI,p.JJ,p.On,V.n0,L.sg,L.O5,V.pK,V.j9,V.g2,V.fr,V.Sm,V.YG,V.gu],encapsulation:2}),re})();var ye=k(7689);function me(re,K){if(1&re){const F=c.EpF();c.TgZ(0,"ion-card"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title",14),c._uU(3,"Preview"),c.qZA(),c.TgZ(4,"ion-buttons",15),c.TgZ(5,"ion-button",4),c.NdJ("click",function(){return c.CHM(F),c.oxw().rotateImage()}),c._UZ(6,"ion-icon",16),c.TgZ(7,"ion-label"),c._uU(8,"Rotate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(9,"ion-card-content"),c.TgZ(10,"ion-list"),c.TgZ(11,"ion-item"),c.TgZ(12,"ion-label",17),c._uU(13,"Comment"),c.qZA(),c.TgZ(14,"ion-input",18),c.NdJ("ngModelChange",function(_e){return c.CHM(F),c.oxw().comment=_e}),c.qZA(),c.qZA(),c.qZA(),c._UZ(15,"img",19),c.qZA(),c.qZA()}if(2&re){const F=c.oxw();c.xp6(14),c.Q6J("ngModel",F.comment)}}let Ee=(()=>{class re{constructor(F,fe,_e,Qe,vt){this.navParams=F,this.appManager=fe,this.nav=_e,this.modalController=Qe,this.logging=vt,this.processingQuality=.8,this.targetWidth=1024,this.targetHeight=800,this.mode=fe.platformMode,this.chargePointId=this.navParams.get("id"),this.poi=this.navParams.get("poi"),this.comment=""}processNativeImageSource(F){let fe=F;const _e=document.getElementById("img-upload-canvas"),Qe=_e.getContext("2d"),vt=new Image;vt.onload=()=>{this.logging.log("img load:"+vt.width),_e.width=vt.width,_e.height=vt.height,Qe.fillStyle="rgb(0,0,0)",Qe.fillRect(0,0,_e.width,_e.height),Qe.drawImage(vt,0,0,_e.width,_e.height),this.imgData=_e.toDataURL("image/png"),this.processImage()},vt.src=fe}loadCameraOrLibraryImage(F=!1){this.logging.log("PWA mode: fetching image");const fe=new FileReader;fe.onload=()=>{this.imgData=fe.result,this.processImage()},fe.onerror=()=>{},fe.readAsDataURL(document.getElementById("img-upload-media").files[0])}isBrowserMode(){return this.appManager.isPlatform("desktop")||this.appManager.isPlatform("hybrid")}processImage(){if(null!=this.imgData){const fe=document.getElementById("img-upload-canvas"),_e=fe.getContext("2d"),Qe=new Image;Qe.onload=()=>{fe.width=Qe.width,fe.height=Qe.height,_e.fillStyle="rgb(0,0,0)",_e.fillRect(0,0,fe.width,fe.height),_e.drawImage(Qe,0,0,fe.width,fe.height),this.refreshImageFromCanvas()},Qe.src=this.imgData}else this.logging.log("processImage: nothing to process.")}refreshImageFromCanvas(){const F=document.getElementById("img-upload-canvas");this.imgData=F.toDataURL("image/jpeg",.8),document.getElementById("preview").src=this.imgData}rotateImage(){const F=document.getElementById("img-upload-canvas");let fe=new Image;fe.src=F.toDataURL(),fe.onload=()=>{let _e=F.height,Qe=F.width;F.width=_e,F.height=Qe,_e=F.height,Qe=F.width;const vt=F.getContext("2d");vt.save(),vt.translate(Qe,_e/Qe),vt.rotate(Math.PI/2),vt.drawImage(fe,0,0),vt.restore(),fe=null,this.refreshImageFromCanvas()}}performUpload(){var F=this;return(0,a.Z)(function*(){if(!F.imgData)return void(yield F.appManager.showToastNotification("Select an image to upload."));const fe={chargePointID:F.chargePointId,comment:F.comment,imageDataBase64:F.imgData};yield F.appManager.showLoadingProgress("Uploading photo..");try{yield F.appManager.submitMediaItem(fe),F.appManager.dismissLoadingProgress().then(()=>{F.appManager.showToastNotification("Upload completed"),F.modalController.dismiss()}),F.appManager.analytics.appEvent("MediaUpload","Completed")}catch{yield F.appManager.dismissLoadingProgress(),yield F.appManager.showToastNotification("Upload failed, please try again."),F.appManager.analytics.appEvent("MediaUpload","Failed")}})()}cancel(){var F=this;return(0,a.Z)(function*(){yield F.modalController.dismiss()})()}}return re.\u0275fac=function(F){return new(F||re)(c.Y36(V.X1),c.Y36(d.c),c.Y36(V.SH),c.Y36(V.IN),c.Y36(ye.z))},re.\u0275cmp=c.Xpm({type:re,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"media-upload"],[1,"ion-padding"],[1,"banner"],[1,"upload"],[3,"click"],["name","camera","aria-label","camera","slot","start"],["type","file","required","","id","img-upload-media",3,"change"],["inputFile",""],["id","img-upload-canvas",2,"display","none","width","500","height","500","border","1px solid red"],[4,"ngIf"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],["slot","start"],["slot","end"],["name","refresh","slot","start"],["position","floating"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["id","preview",2,"max-width","500px"]],template:function(F,fe){if(1&F){const _e=c.EpF();c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title"),c._uU(3," Share Photo "),c.qZA(),c.qZA(),c.qZA(),c.TgZ(4,"ion-content",0),c.TgZ(5,"div",1),c.TgZ(6,"div",2),c.TgZ(7,"h1"),c._uU(8),c.qZA(),c.TgZ(9,"p"),c._uU(10),c.qZA(),c.qZA(),c.TgZ(11,"p"),c._uU(12,"You can upload a photo from your device or take a new photo: "),c.qZA(),c.TgZ(13,"div",3),c.TgZ(14,"ion-button",4),c.NdJ("click",function(){return c.CHM(_e),c.MAs(19).click()}),c._UZ(15,"ion-icon",5),c.TgZ(16,"ion-label"),c._uU(17,"Choose Photo.."),c.qZA(),c.qZA(),c.TgZ(18,"input",6,7),c.NdJ("change",function(){return fe.loadCameraOrLibraryImage()}),c.qZA(),c.qZA(),c._UZ(20,"canvas",8),c.YNc(21,me,16,1,"ion-card",9),c.qZA(),c.qZA(),c.TgZ(22,"ion-footer"),c.TgZ(23,"ion-toolbar"),c.TgZ(24,"ion-buttons",10),c.TgZ(25,"ion-button",4),c.NdJ("click",function(){return fe.cancel()}),c._UZ(26,"ion-icon",11),c._uU(27," Cancel "),c.qZA(),c.qZA(),c.TgZ(28,"ion-buttons",12),c.TgZ(29,"ion-button",4),c.NdJ("click",function(){return fe.performUpload()}),c._uU(30," Upload "),c._UZ(31,"ion-icon",13),c.qZA(),c.qZA(),c.qZA(),c.qZA()}2&F&&(c.xp6(8),c.Oqu(fe.poi.AddressInfo.Title),c.xp6(2),c.Oqu(fe.poi.AddressInfo.AddressLine1),c.xp6(11),c.Q6J("ngIf",null!=fe.imgData))},directives:[V.Gu,V.sr,V.wd,V.W2,V.YG,V.gu,V.Q$,L.O5,V.PM,V.Sm,V.FN,V.q_,V.Ie,V.pK,V.j9,p.JJ,p.On,V.fr],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),re})();var je=k(3334);function rt(re,K){if(1&re&&(c.TgZ(0,"ion-select-option",19),c._uU(1),c.qZA()),2&re){const F=K.$implicit;c.Q6J("value",F.ID),c.xp6(1),c.Oqu(F.Title)}}function Ae(re,K){if(1&re&&(c.TgZ(0,"ion-select-option",19),c._uU(1),c.qZA()),2&re){const F=K.$implicit;c.Q6J("value",F.ID),c.xp6(1),c.Oqu(F.Title)}}let Ze=(()=>{class re{constructor(F,fe,_e,Qe,vt,kt,tt,Zt){this.navParams=F,this.appManager=fe,this.nav=_e,this.zone=Qe,this.loadingController=vt,this.modalController=kt,this.logging=tt,this.router=Zt,this.commentModel={ChargePointID:this.navParams.get("id"),Comment:"",CheckinStatusTypeID:10,CommentTypeID:10,Rating:null},this.poi=this.navParams.get("poi"),this.commentTypes=fe.referenceDataManager.getCommentTypes(!0,!0),this.checkinTypes=fe.referenceDataManager.getCheckinStatusTypes(!0,!0)}onPageWillEnter(){}cancel(){this.modalController.dismiss()}add(){var F=this;return(0,a.Z)(function*(){const fe=yield F.loadingController.create({message:"Sending .."});yield fe.present(),(yield F.appManager.submitComment(F.commentModel).catch(Qe=>{F.appManager.showToastNotification("There was a problem submitting your comment."),F.loadingController.dismiss(),F.appManager.analytics.appEvent("Comment","Failed")}))&&(F.logging.log("Comment submitted"),yield fe.dismiss(),yield F.modalController.dismiss(),F.appManager.analytics.appEvent("Comment","Submitted"))})()}}return re.\u0275fac=function(F){return new(F||re)(c.Y36(V.X1),c.Y36(d.c),c.Y36(V.SH),c.Y36(c.R0b),c.Y36(V.HT),c.Y36(V.IN),c.Y36(ye.z),c.Y36(je.F0))},re.\u0275cmp=c.Xpm({type:re,selectors:[["ng-component"]],decls:53,vars:8,consts:[["color","primary"],[1,"comment-page","ion-padding"],[1,"banner"],[1,"ion-padding"],["position","stacked"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["value","5"],["value","4"],["value","3"],["value","2"],["value","1"],["value",""],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],[3,"value"]],template:function(F,fe){1&F&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar",0),c.TgZ(2,"ion-title"),c._uU(3," Add Comment "),c.qZA(),c.qZA(),c.qZA(),c.TgZ(4,"ion-content",1),c.TgZ(5,"div",2),c.TgZ(6,"h1"),c._uU(7),c.qZA(),c.TgZ(8,"p"),c._uU(9),c.qZA(),c.qZA(),c.TgZ(10,"p",3),c._uU(11,"Recent Check-ins are a big help to other drivers when planning their journey. Tell everyone what you thought about this charging location. "),c.qZA(),c.TgZ(12,"ion-list"),c.TgZ(13,"ion-item"),c.TgZ(14,"ion-label",4),c._uU(15,"Comment Type"),c.qZA(),c.TgZ(16,"ion-select",5),c.NdJ("ngModelChange",function(Qe){return fe.commentModel.CommentTypeID=Qe}),c.YNc(17,rt,2,2,"ion-select-option",6),c.qZA(),c.qZA(),c.TgZ(18,"ion-item"),c.TgZ(19,"ion-label",4),c._uU(20,"What Did You Think?"),c.qZA(),c.TgZ(21,"ion-input",7),c.NdJ("ngModelChange",function(Qe){return fe.commentModel.Comment=Qe}),c.qZA(),c.qZA(),c.TgZ(22,"ion-item"),c.TgZ(23,"ion-label",4),c._uU(24,"Did You Successfully Charge?"),c.qZA(),c.TgZ(25,"ion-select",5),c.NdJ("ngModelChange",function(Qe){return fe.commentModel.CheckinStatusTypeID=Qe}),c.YNc(26,Ae,2,2,"ion-select-option",6),c.qZA(),c.qZA(),c.TgZ(27,"ion-item"),c.TgZ(28,"ion-label",4),c._uU(29,"Your Rating"),c.qZA(),c.TgZ(30,"ion-select",5),c.NdJ("ngModelChange",function(Qe){return fe.commentModel.Rating=Qe}),c.TgZ(31,"ion-select-option",8),c._uU(32,"5 - Excellent"),c.qZA(),c.TgZ(33,"ion-select-option",9),c._uU(34,"4 - Good"),c.qZA(),c.TgZ(35,"ion-select-option",10),c._uU(36,"3 - Average"),c.qZA(),c.TgZ(37,"ion-select-option",11),c._uU(38,"2 - Not Good"),c.qZA(),c.TgZ(39,"ion-select-option",12),c._uU(40,"1 - Bad"),c.qZA(),c.TgZ(41,"ion-select-option",13),c._uU(42,"Not Rated"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(43,"ion-footer"),c.TgZ(44,"ion-toolbar"),c.TgZ(45,"ion-buttons",14),c.TgZ(46,"ion-button",15),c.NdJ("click",function(){return fe.cancel()}),c._UZ(47,"ion-icon",16),c._uU(48," Cancel "),c.qZA(),c.qZA(),c.TgZ(49,"ion-buttons",17),c.TgZ(50,"ion-button",15),c.NdJ("click",function(){return fe.add()}),c._uU(51," Submit "),c._UZ(52,"ion-icon",18),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&F&&(c.xp6(7),c.Oqu(fe.poi.AddressInfo.Title),c.xp6(2),c.Oqu(fe.poi.AddressInfo.AddressLine1),c.xp6(7),c.Q6J("ngModel",fe.commentModel.CommentTypeID),c.xp6(1),c.Q6J("ngForOf",fe.commentTypes),c.xp6(4),c.Q6J("ngModel",fe.commentModel.Comment),c.xp6(4),c.Q6J("ngModel",fe.commentModel.CheckinStatusTypeID),c.xp6(1),c.Q6J("ngForOf",fe.checkinTypes),c.xp6(4),c.Q6J("ngModel",fe.commentModel.Rating))},directives:[V.Gu,V.sr,V.wd,V.W2,V.q_,V.Ie,V.Q$,V.t9,V.QI,p.JJ,p.On,L.sg,V.n0,V.pK,V.j9,V.fr,V.Sm,V.YG,V.gu],encapsulation:2}),re})();var Ve=k(2951),He=k(9698),Ne=k(9492),xt=k(4508),Je=k(6579),ct=k(9397),wt=k(1099);function Tt(re,K){if(1&re&&(c.TgZ(0,"div"),c.TgZ(1,"small"),c._uU(2),c.qZA(),c.qZA()),2&re){const F=c.oxw(2);c.xp6(2),c.Oqu(F.connectionSummary)}}function Ct(re,K){if(1&re&&(c.TgZ(0,"div"),c.TgZ(1,"small"),c._uU(2),c.qZA(),c.qZA()),2&re){const F=c.oxw(2);c.xp6(2),c.Oqu(F.poi.OperatorInfo.Title)}}function gt(re,K){if(1&re){const F=c.EpF();c.ynx(0),c.TgZ(1,"ion-button",28),c.NdJ("click",function(){return c.CHM(F),c.oxw(2).addFavourite()}),c._UZ(2,"ion-icon",29),c.TgZ(3,"ion-label"),c._uU(4,"Favourite"),c.qZA(),c.qZA(),c.TgZ(5,"ion-button",13),c.NdJ("click",function(){return c.CHM(F),c.oxw(2).edit()}),c._UZ(6,"ion-icon",30),c.TgZ(7,"ion-label"),c._uU(8,"Edit"),c.qZA(),c.qZA(),c.BQk()}}function Lt(re,K){if(1&re){const F=c.EpF();c.ynx(0),c.TgZ(1,"ion-button",31),c.NdJ("click",function(){return c.CHM(F),c.oxw(2).launchNavigation()}),c._UZ(2,"ion-icon",32),c.TgZ(3,"ion-label"),c._uU(4,"Navigate"),c.qZA(),c.qZA(),c.BQk()}}function Ht(re,K){if(1&re){const F=c.EpF();c.ynx(0),c.TgZ(1,"ion-button",33),c.NdJ("click",function(){return c.CHM(F),c.oxw(2).addComment()}),c._UZ(2,"ion-icon",34),c.TgZ(3,"ion-label"),c._uU(4,"Add Comment"),c.qZA(),c.qZA(),c.BQk()}}function Vn(re,K){if(1&re){const F=c.EpF();c.ynx(0),c.TgZ(1,"ion-button",35),c.NdJ("click",function(){return c.CHM(F),c.oxw(2).addMedia()}),c._UZ(2,"ion-icon",36),c.TgZ(3,"ion-label"),c._uU(4," Add Photo"),c.qZA(),c.qZA(),c.BQk()}}function Ft(re,K){if(1&re&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&re){const F=c.oxw(4);c.xp6(1),c.hij(" ",F.poi.AddressInfo.AddressLine1,"")}}function Wt(re,K){if(1&re&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&re){const F=c.oxw(4);c.xp6(1),c.hij(" ",F.poi.AddressInfo.AddressLine2,"")}}function Gt(re,K){if(1&re&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&re){const F=c.oxw(4);c.xp6(1),c.hij(" ",F.poi.AddressInfo.Town,"")}}function Jt(re,K){if(1&re&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&re){const F=c.oxw(4);c.xp6(1),c.hij(" ",F.poi.AddressInfo.StateOrProvince,"")}}function an(re,K){if(1&re&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&re){const F=c.oxw(4);c.xp6(1),c.hij(" ",F.poi.AddressInfo.Postcode,"")}}function Jn(re,K){if(1&re&&(c.TgZ(0,"div"),c._uU(1),c.qZA()),2&re){const F=c.oxw(4);c.xp6(1),c.hij(" ",F.poi.AddressInfo.Country.Title,"")}}function si(re,K){if(1&re&&(c.TgZ(0,"p"),c._uU(1),c.qZA()),2&re){const F=c.oxw(4);c.xp6(1),c.hij(" ",F.poi.AddressInfo.AccessComments," ")}}function di(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"ion-icon",48),c.TgZ(2,"span",45),c._uU(3),c.qZA(),c.qZA()),2&re){const F=c.oxw(4);c.xp6(3),c.Oqu(F.poi.AddressInfo.ContactTelephone1)}}function Bn(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"ion-icon",48),c.TgZ(2,"span",45),c._uU(3),c.qZA(),c.qZA()),2&re){const F=c.oxw(4);c.xp6(3),c.Oqu(F.poi.AddressInfo.ContactTelephone2)}}function ln(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"ion-icon",49),c.TgZ(2,"span",45),c._uU(3),c.qZA(),c.qZA()),2&re){const F=c.oxw(4);c.xp6(3),c.Oqu(F.poi.AddressInfo.ContactEmail)}}function Et(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"ion-icon",50),c.TgZ(2,"span",45),c.TgZ(3,"a",51),c._uU(4),c.qZA(),c.qZA(),c.qZA()),2&re){const F=c.oxw(4);c.xp6(3),c.s9C("href",F.poi.AddressInfo.RelatedURL,c.LSH),c.xp6(1),c.Oqu(F.poi.AddressInfo.RelatedURL)}}function Kt(re,K){if(1&re&&(c.TgZ(0,"ion-card"),c.TgZ(1,"ion-card-header"),c._UZ(2,"ion-icon",43),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.TgZ(5,"ion-card-content"),c.TgZ(6,"ion-grid"),c.TgZ(7,"ion-row"),c.TgZ(8,"ion-col"),c.TgZ(9,"ion-label",44),c._uU(10),c.ALo(11,"translate"),c.qZA(),c.TgZ(12,"div",45),c.YNc(13,Ft,2,1,"div",0),c.YNc(14,Wt,2,1,"div",0),c.YNc(15,Gt,2,1,"div",0),c.YNc(16,Jt,2,1,"div",0),c.YNc(17,an,2,1,"div",0),c.YNc(18,Jn,2,1,"div",0),c.qZA(),c.qZA(),c.TgZ(19,"ion-col"),c.YNc(20,si,2,1,"p",0),c.YNc(21,di,4,1,"p",0),c.YNc(22,Bn,4,1,"p",0),c.YNc(23,ln,4,1,"p",0),c.YNc(24,Et,5,2,"p",0),c.qZA(),c.qZA(),c.TgZ(25,"ion-row"),c.TgZ(26,"ion-col"),c._UZ(27,"ion-icon",46),c.TgZ(28,"ion-label",47),c._uU(29),c.ALo(30,"number"),c.ALo(31,"number"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(3),c.hij(" ",c.lcZ(4,15,"ocm.details.location.sectionTitle")," "),c.xp6(7),c.hij(" ",c.lcZ(11,17,"ocm.details.location.address"),""),c.xp6(3),c.Q6J("ngIf",F.poi.AddressInfo.AddressLine1),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.AddressLine2),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.Town),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.StateOrProvince),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.Postcode),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.Country),c.xp6(2),c.Q6J("ngIf",F.poi.AddressInfo.AccessComments),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.ContactTelephone1),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.ContactTelephone2),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.ContactEmail),c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo.RelatedURL),c.xp6(5),c.AsE(" ",c.xi3(30,19,F.poi.AddressInfo.Latitude,"1.1-13")," , ",c.xi3(31,22,F.poi.AddressInfo.Longitude,"1.1-13")," ")}}function Hn(re,K){if(1&re&&(c.TgZ(0,"p"),c.TgZ(1,"span",44),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"span",45),c._uU(5),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(2),c.hij("",c.lcZ(3,2,"ocm.details.numberOfPoints"),":"),c.xp6(3),c.Oqu(F.poi.NumberOfPoints)}}function In(re,K){if(1&re&&(c.TgZ(0,"p"),c.TgZ(1,"span",44),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"span",45),c._uU(5),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(2),c.hij("",c.lcZ(3,2,"ocm.details.operationalStatus"),":"),c.xp6(3),c.hij(" ",F.poi.StatusType.Title," ")}}function ti(re,K){if(1&re&&(c.TgZ(0,"p"),c.TgZ(1,"span",44),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"span",45),c._uU(5),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(2),c.hij("",c.lcZ(3,2,"ocm.details.usageType"),":"),c.xp6(3),c.Oqu(F.poi.UsageType.Title)}}function mi(re,K){if(1&re&&(c.TgZ(0,"p"),c.TgZ(1,"span",44),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"span",45),c._uU(5),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(2),c.hij("",c.lcZ(3,2,"ocm.details.usageCost"),":"),c.xp6(3),c.hij(" ",F.poi.UsageCost,"")}}function ir(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"br"),c._uU(2),c.ALo(3,"translate"),c._UZ(4,"br"),c.TgZ(5,"span",45),c._uU(6),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(2),c.hij("",c.lcZ(3,2,"ocm.details.generalComments"),": "),c.xp6(4),c.Oqu(F.poi.GeneralComments)}}function _r(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"ion-icon",54),c._uU(2),c.qZA()),2&re){const F=c.oxw(4);c.xp6(2),c.hij(" ",F.poi.OperatorInfo.WebsiteURL," ")}}function er(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"ion-icon",49),c._uU(2),c.qZA()),2&re){const F=c.oxw(4);c.xp6(2),c.hij(" ",F.poi.OperatorInfo.ContactEmail," ")}}function Ri(re,K){if(1&re&&(c.TgZ(0,"p"),c._UZ(1,"ion-icon",49),c._uU(2),c.qZA()),2&re){const F=c.oxw(4);c.xp6(2),c.hij(" ",F.poi.OperatorInfo.FaultReportEmail," ")}}function mr(re,K){if(1&re&&(c.TgZ(0,"ion-card"),c.TgZ(1,"ion-card-header"),c._UZ(2,"ion-icon",52),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.TgZ(5,"ion-card-content"),c.TgZ(6,"div",45),c.TgZ(7,"p",53),c._uU(8),c.qZA(),c.YNc(9,_r,3,1,"p",0),c.YNc(10,er,3,1,"p",0),c.YNc(11,Ri,3,1,"p",0),c.qZA(),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(3),c.hij(" ",c.lcZ(4,5,"ocm.details.operator.sectionTitle")," "),c.xp6(5),c.hij(" ",F.poi.OperatorInfo.Title," "),c.xp6(1),c.Q6J("ngIf",F.poi.OperatorInfo.WebsiteURL),c.xp6(1),c.Q6J("ngIf",null!=F.poi.OperatorInfo.ContactEmail),c.xp6(1),c.Q6J("ngIf",null!=F.poi.OperatorInfo.FaultReportEmail&&F.poi.OperatorInfo.FaultReportEmail!=F.poi.OperatorInfo.ContactEmail)}}function Si(re,K){if(1&re){const F=c.EpF();c.TgZ(0,"a",56),c.NdJ("click",function(){c.CHM(F);const _e=c.oxw(4);return _e.launchURL(_e.poi.DataProvider.WebsiteURL)}),c._uU(1),c.qZA()}if(2&re){const F=c.oxw(4);c.xp6(1),c.Oqu(F.poi.DataProvider.WebsiteURL)}}function ki(re,K){if(1&re&&(c.TgZ(0,"div",45),c.TgZ(1,"h3"),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.TgZ(4,"p"),c._uU(5),c.qZA(),c.YNc(6,Si,2,1,"a",55),c.TgZ(7,"p"),c._uU(8),c.qZA(),c.qZA()),2&re){const F=c.oxw(3);c.xp6(2),c.hij(" ",c.lcZ(3,4,"ocm.details.dataProvider.sectionTitle")," "),c.xp6(3),c.Oqu(null==F.poi.DataProvider?null:F.poi.DataProvider.Title),c.xp6(1),c.Q6J("ngIf",F.poi.DataProvider.WebsiteURL),c.xp6(2),c.Oqu(null==F.poi.DataProvider?null:F.poi.DataProvider.License)}}function Qt(re,K){if(1&re&&(c.TgZ(0,"div",37),c.YNc(1,Kt,32,25,"ion-card",0),c.TgZ(2,"ion-card"),c.TgZ(3,"ion-card-header"),c._UZ(4,"ion-icon",38),c._uU(5),c.ALo(6,"translate"),c.qZA(),c.TgZ(7,"ion-card-content"),c.YNc(8,Hn,6,4,"p",0),c._UZ(9,"app-equipment-details",39),c.qZA(),c.qZA(),c.TgZ(10,"ion-card"),c.TgZ(11,"ion-card-header"),c._UZ(12,"ion-icon",40),c._uU(13," Usage Restrictions "),c.qZA(),c.TgZ(14,"ion-card-content"),c.YNc(15,In,6,4,"p",0),c.YNc(16,ti,6,4,"p",0),c.YNc(17,mi,6,4,"p",0),c.YNc(18,ir,7,4,"p",0),c.qZA(),c.qZA(),c.YNc(19,mr,12,7,"ion-card",0),c.TgZ(20,"ion-card"),c.TgZ(21,"ion-card-header"),c._UZ(22,"ion-icon",41),c._uU(23),c.ALo(24,"translate"),c.qZA(),c.TgZ(25,"ion-card-content"),c.YNc(26,ki,9,6,"div",42),c.qZA(),c.qZA(),c.qZA()),2&re){const F=c.oxw(2);c.xp6(1),c.Q6J("ngIf",F.poi.AddressInfo),c.xp6(4),c.hij(" ",c.lcZ(6,11,"ocm.details.equipment.sectionTitle")," "),c.xp6(3),c.Q6J("ngIf",null!=F.poi.NumberOfPoints),c.xp6(1),c.Q6J("item",F.poi),c.xp6(6),c.Q6J("ngIf",null!=F.poi.StatusType),c.xp6(1),c.Q6J("ngIf",null!=F.poi.UsageType),c.xp6(1),c.Q6J("ngIf",null!=F.poi.UsageCost),c.xp6(1),c.Q6J("ngIf",null!=F.poi.GeneralComments),c.xp6(1),c.Q6J("ngIf",F.poi.OperatorInfo),c.xp6(4),c.hij(" ",c.lcZ(24,13,"ocm.details.advancedDetails")," "),c.xp6(3),c.Q6J("ngIf",F.poi.DataProvider)}}function et(re,K){if(1&re&&c._UZ(0,"img",60),2&re){const F=c.oxw().$implicit;c.s9C("src",null==F.User?null:F.User.ProfileImageURL,c.LSH)}}function de(re,K){if(1&re&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&re){const F=c.oxw().$implicit;c.xp6(1),c.Oqu(F.User.Username)}}function Pe(re,K){if(1&re&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&re){const F=c.oxw().$implicit;c.xp6(1),c.Oqu(F.Username)}}function ft(re,K){if(1&re&&(c.TgZ(0,"p",45),c._uU(1),c.qZA()),2&re){const F=c.oxw().$implicit;c.xp6(1),c.hij(" ",null==F.CommentType?null:F.CommentType.Title," ")}}function Be(re,K){if(1&re&&(c.TgZ(0,"p"),c.TgZ(1,"span",44),c._uU(2,"Rating:"),c.qZA(),c.TgZ(3,"span",45),c._uU(4),c.qZA(),c.qZA()),2&re){const F=c.oxw().$implicit;c.xp6(4),c.hij("",F.Rating," out of 5")}}function $t(re,K){1&re&&(c.ynx(0),c._UZ(1,"ion-icon",61),c.BQk())}function xe(re,K){1&re&&(c.ynx(0),c._UZ(1,"ion-icon",62),c.BQk())}function Ie(re,K){if(1&re&&(c.TgZ(0,"p"),c.YNc(1,$t,2,0,"ng-container",0),c.YNc(2,xe,2,0,"ng-container",0),c._uU(3),c.qZA()),2&re){const F=c.oxw().$implicit;c.xp6(1),c.Q6J("ngIf",!0===F.CheckinStatusType.IsPositive),c.xp6(1),c.Q6J("ngIf",!1===F.CheckinStatusType.IsPositive),c.xp6(1),c.hij(" ",F.CheckinStatusType.Title," ")}}function Ut(re,K){if(1&re&&(c.TgZ(0,"ion-card"),c.TgZ(1,"ion-item"),c.TgZ(2,"ion-avatar",19),c.YNc(3,et,1,1,"img",59),c.qZA(),c.TgZ(4,"ion-label"),c.YNc(5,de,2,1,"span",0),c.YNc(6,Pe,2,1,"span",0),c.qZA(),c.TgZ(7,"ion-label",20),c._uU(8),c.ALo(9,"date"),c.qZA(),c.qZA(),c.TgZ(10,"ion-card-content"),c.TgZ(11,"p"),c._uU(12),c.qZA(),c.YNc(13,ft,2,1,"p",42),c.YNc(14,Be,5,1,"p",0),c.YNc(15,Ie,4,3,"p",0),c.qZA(),c.qZA()),2&re){const F=K.$implicit;c.xp6(3),c.Q6J("ngIf",F.User&&F.User.ProfileImageURL),c.xp6(2),c.Q6J("ngIf",F.User),c.xp6(1),c.Q6J("ngIf",!F.User),c.xp6(2),c.hij(" ",c.lcZ(9,8,F.DateCreated)," "),c.xp6(4),c.Oqu(F.Comment),c.xp6(1),c.Q6J("ngIf",10!=F.CommentTypeID),c.xp6(1),c.Q6J("ngIf",F.Rating),c.xp6(1),c.Q6J("ngIf",F.CheckinStatusType)}}function nn(re,K){if(1&re&&(c.ynx(0),c.YNc(1,Ut,16,10,"ion-card",58),c.BQk()),2&re){const F=c.oxw(3);c.xp6(1),c.Q6J("ngForOf",F.poi.UserComments)}}function ni(re,K){1&re&&(c.TgZ(0,"p",21),c._uU(1),c.ALo(2,"translate"),c.qZA()),2&re&&(c.xp6(1),c.hij(" ",c.lcZ(2,1,"ocm.details.commentsAndRatings.zeroComments")," "))}function cr(re,K){if(1&re&&(c.TgZ(0,"div"),c.YNc(1,nn,2,1,"ng-container",0),c.YNc(2,ni,3,3,"p",57),c.qZA()),2&re){const F=c.oxw(2);c.xp6(1),c.Q6J("ngIf",1==F.poi._hasComments),c.xp6(1),c.Q6J("ngIf",0==F.poi._hasComments)}}function Li(re,K){if(1&re&&c._UZ(0,"img",60),2&re){const F=c.oxw().$implicit;c.s9C("src",null==F.User?null:F.User.ProfileImageURL,c.LSH)}}function Ei(re,K){if(1&re&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&re){const F=c.oxw().$implicit;c.xp6(1),c.Oqu(F.User.Username)}}function xi(re,K){if(1&re&&(c.TgZ(0,"span"),c._uU(1),c.qZA()),2&re){const F=c.oxw().$implicit;c.xp6(1),c.Oqu(F.Username)}}function vr(re,K){if(1&re&&(c.TgZ(0,"ion-card"),c._UZ(1,"img",60),c.TgZ(2,"ion-item"),c.TgZ(3,"ion-avatar",19),c.YNc(4,Li,1,1,"img",59),c.qZA(),c.TgZ(5,"ion-label"),c.YNc(6,Ei,2,1,"span",0),c.YNc(7,xi,2,1,"span",0),c.qZA(),c.TgZ(8,"ion-label",20),c._uU(9),c.ALo(10,"date"),c.qZA(),c.qZA(),c.TgZ(11,"ion-card-content"),c.TgZ(12,"p"),c._uU(13),c.qZA(),c.qZA(),c.qZA()),2&re){const F=K.$implicit;c.xp6(1),c.s9C("src",F.ItemMediumURL,c.LSH),c.xp6(3),c.Q6J("ngIf",F.User&&F.User.ProfileImageURL),c.xp6(2),c.Q6J("ngIf",F.User),c.xp6(1),c.Q6J("ngIf",!F.User),c.xp6(2),c.hij(" ",c.lcZ(10,6,F.DateCreated)," "),c.xp6(4),c.Oqu(F.Comment)}}function ji(re,K){if(1&re&&(c.TgZ(0,"div"),c.YNc(1,vr,14,8,"ion-card",58),c.qZA()),2&re){const F=c.oxw(3);c.xp6(1),c.Q6J("ngForOf",F.poi.MediaItems)}}function Ir(re,K){1&re&&(c.TgZ(0,"div",21),c.TgZ(1,"p",63),c._uU(2),c.ALo(3,"translate"),c.qZA(),c.qZA()),2&re&&(c.xp6(2),c.hij(" ",c.lcZ(3,1,"ocm.details.mediaItems.addPrompt"),""))}function $i(re,K){if(1&re&&(c.TgZ(0,"div"),c.YNc(1,ji,2,1,"div",0),c.YNc(2,Ir,4,3,"div",57),c.qZA()),2&re){const F=c.oxw(2);c.xp6(1),c.Q6J("ngIf",F.poi._hasPhotos),c.xp6(1),c.Q6J("ngIf",!F.poi._hasPhotos)}}function Gr(re,K){if(1&re&&(c.TgZ(0,"p",64),c._uU(1),c.qZA()),2&re){const F=c.oxw(2);c.xp6(1),c.hij(" ",F.json,"")}}function eo(re,K){if(1&re){const F=c.EpF();c.TgZ(0,"div"),c.TgZ(1,"div",1),c.TgZ(2,"div",2),c.TgZ(3,"h2"),c._uU(4),c.qZA(),c.TgZ(5,"div"),c.TgZ(6,"small"),c._uU(7),c.qZA(),c.qZA(),c.YNc(8,Tt,3,1,"div",0),c.YNc(9,Ct,3,1,"div",0),c.TgZ(10,"ion-badge",3),c._uU(11),c.ALo(12,"number"),c.qZA(),c.qZA(),c.TgZ(13,"ion-fab",4),c.TgZ(14,"ion-fab-button"),c._UZ(15,"ion-icon",5),c.qZA(),c.TgZ(16,"ion-fab-list",6),c.TgZ(17,"ion-fab-button",7),c.NdJ("click",function(){return c.CHM(F),c.oxw().addComment()}),c._UZ(18,"ion-icon",8),c.qZA(),c.TgZ(19,"ion-fab-button",9),c.NdJ("click",function(){return c.CHM(F),c.oxw().addMedia()}),c._UZ(20,"ion-icon",10),c.qZA(),c.TgZ(21,"ion-fab-button",11),c.NdJ("click",function(){return c.CHM(F),c.oxw().addFavourite()}),c._UZ(22,"ion-icon",12),c.qZA(),c.TgZ(23,"ion-fab-button",13),c.NdJ("click",function(){return c.CHM(F),c.oxw().edit()}),c._UZ(24,"ion-icon",14),c.qZA(),c.TgZ(25,"ion-fab-button",15),c.NdJ("click",function(){return c.CHM(F),c.oxw().refresh()}),c._UZ(26,"ion-icon",16),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(27,"ion-refresher",17),c.NdJ("ionRefresh",function(_e){return c.CHM(F),c.oxw().refresh(_e)}),c._UZ(28,"ion-refresher-content",18),c.qZA(),c.TgZ(29,"ion-toolbar"),c.TgZ(30,"ion-buttons",19),c.YNc(31,gt,9,0,"ng-container",0),c.qZA(),c.TgZ(32,"ion-buttons",20),c.YNc(33,Lt,5,0,"ng-container",0),c.YNc(34,Ht,5,0,"ng-container",0),c.YNc(35,Vn,5,0,"ng-container",0),c.qZA(),c.qZA(),c.TgZ(36,"div",21),c.TgZ(37,"ion-segment",22),c.NdJ("ngModelChange",function(_e){return c.CHM(F),c.oxw().selectedTab=_e}),c.TgZ(38,"ion-segment-button",23),c.TgZ(39,"ion-label"),c._uU(40," Details "),c.qZA(),c.qZA(),c.TgZ(41,"ion-segment-button",24),c.TgZ(42,"ion-label"),c._uU(43),c.qZA(),c.qZA(),c.TgZ(44,"ion-segment-button",25),c.TgZ(45,"ion-label"),c._uU(46),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(47,Qt,27,15,"div",26),c.YNc(48,cr,3,2,"div",0),c.YNc(49,$i,3,2,"div",0),c.YNc(50,Gr,2,1,"p",27),c.qZA()}if(2&re){const F=c.oxw();c.xp6(1),c.Udp("background-image",F.backdropImage?"url("+F.backdropImage+")":""),c.xp6(3),c.hij(" ",F.poi.AddressInfo.Title," "),c.xp6(3),c.hij("OCM-",F.poi.ID,""),c.xp6(1),c.Q6J("ngIf",F.connectionSummary),c.xp6(1),c.Q6J("ngIf",F.poi.OperatorInfo),c.xp6(2),c.Oqu(c.xi3(12,18,F.avgRating,"1.1-1")),c.xp6(20),c.Q6J("ngIf","location"==F.selectedTab),c.xp6(2),c.Q6J("ngIf","location"==F.selectedTab),c.xp6(1),c.Q6J("ngIf","comments"==F.selectedTab),c.xp6(1),c.Q6J("ngIf","media"==F.selectedTab),c.xp6(2),c.Q6J("ngModel",F.selectedTab),c.xp6(6),c.hij("Comments (",F.poi.UserComments?F.poi.UserComments.length:0,")"),c.xp6(3),c.hij(" Photos (",F.poi.MediaItems?F.poi.MediaItems.length:0,")"),c.xp6(1),c.Q6J("ngIf","location"==F.selectedTab),c.xp6(1),c.Q6J("ngIf","comments"==F.selectedTab),c.xp6(1),c.Q6J("ngIf","media"==F.selectedTab),c.xp6(1),c.Q6J("ngIf",1==F.appManager.isDebugMode)}}function zr(re,K){1&re&&(c.TgZ(0,"div"),c.TgZ(1,"h2"),c._uU(2,"POI Not Found"),c.qZA(),c.TgZ(3,"p"),c._uU(4,"The POI details could not be loaded."),c.qZA(),c.qZA())}let Xi=(()=>{class re{constructor(F,fe,_e,Qe,vt,kt,tt,Zt){this.appManager=F,this.nav=fe,this.translate=_e,this.logging=Qe,this.modalController=vt,this.actionSheetController=kt,this.poiManager=tt,this.router=Zt,this.hasNavBar=!1}ngOnChanges(F){if(this.logging.log("In ngOnChanges of POI Details"),null!=this.poi&&null!=this.poi.AddressInfo){if(this.selectedTab="location",null!=this.poi.MediaItems&&this.poi.MediaItems.length>0){this.poi._hasPhotos=!0;for(let fe of this.poi.MediaItems)fe.ItemMediumURL=fe.ItemThumbnailURL.replace(".thmb.",".medi.");this.backdropImage=this.poi.MediaItems[this.poi.MediaItems.length-1].ItemThumbnailURL.replace(".thmb.",".medi.")}else this.poi._hasPhotos=!1,this.backdropImage=null;if(null!=this.poi.UserComments&&this.poi.UserComments.length>0){this.poi._hasComments=!0;try{let fe=this.poi.UserComments.filter(_e=>_e.Rating>0);if(fe.length>0){let _e=0;for(let Qe of fe)_e+=Qe.Rating;this.avgRating=_e/fe.length}else this.avgRating=null}catch{}}else this.poi._hasComments=!1;if(this.poi.Connections&&this.poi.Connections.length>0){let fe="";for(let _e of this.poi.Connections)-1==fe.indexOf(_e.ConnectionType.Title)&&(fe+=(""!=fe?", ":"")+_e.ConnectionType.Title);this.connectionSummary=fe}}}ngOnInit(){this.logging.log("In ngInit of POI Details")}get staticMapURL(){return"https://maps.googleapis.com/maps/api/staticmap?key="+(new Ve.X).googleMapsAPIKey+"&center="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude}get staticMapSize(){return 0===this.appManager.clientWidth?"240x100":this.appManager.clientWidth>=800?"640x100":this.appManager.clientWidth>=400?"400x100":"240x100"}continueAddComment(){var F=this;return(0,a.Z)(function*(){const fe=yield F.modalController.create({component:Ze,componentProps:{id:F.poi.ID,poi:F.poi}});setTimeout(()=>{F.refresh()},1e3),yield fe.present()})()}addComment(){var F=this;return(0,a.Z)(function*(){if(F.appManager.isUserAuthenticated(!0))yield F.continueAddComment();else{const fe=yield F.modalController.create({component:Ne.F});fe.onDidDismiss().then((0,a.Z)(function*(){F.appManager.isUserAuthenticated(!0)&&(yield F.continueAddComment())})),yield fe.present()}})()}continueAddMedia(){var F=this;return(0,a.Z)(function*(){const fe=yield F.modalController.create({component:Ee,componentProps:{id:F.poi.ID,poi:F.poi}});fe.onDidDismiss().then(()=>{setTimeout(()=>{F.refresh()},1e3)}),yield fe.present()})()}addMedia(){var F=this;return(0,a.Z)(function*(){if(F.appManager.isUserAuthenticated(!0))yield F.continueAddMedia();else{const fe=yield F.modalController.create({component:Ne.F});fe.onDidDismiss().then((0,a.Z)(function*(){F.appManager.isUserAuthenticated(!0)&&(yield F.continueAddMedia())})),yield fe.present()}})()}addFavourite(){var F=this;return(0,a.Z)(function*(){yield(yield F.actionSheetController.create({header:"Add Favourite",buttons:[{text:"Add to Journey",handler:()=>{F.modalController.create({component:te,componentProps:{poi:F.poi}}).then(_e=>_e.present())}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}launchNavigation(){this.appManager.isPlatform("ios")?this.appManager.launchWebPage("https://maps.apple.com/?ll="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude):this.appManager.launchWebPage("https://maps.google.com/?q="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude)}launchURL(F){this.appManager.launchWebPage(F)}continueEdit(){var F=this;return(0,a.Z)(function*(){const fe=yield F.modalController.create({component:xt.Y,componentProps:{id:F.poi.ID}});return fe.onDidDismiss().then(_e=>{F.refresh()}),yield fe.present()})()}edit(){var F=this;return(0,a.Z)(function*(){if(Je.c.isFeatureEnabled("EDIT_POI"))if(F.appManager.isUserAuthenticated(!0))yield F.continueEdit();else{const fe=yield F.modalController.create({component:Ne.F});fe.onDidDismiss().then((0,a.Z)(function*(){F.appManager.isUserAuthenticated(!0)&&(yield F.continueEdit())})),yield fe.present()}else F.appManager.launchOCMWebPage("/poi/edit/"+F.poi.ID)})()}refresh(F=null){this.poi&&this.poiManager.getPOIById(this.poi.ID,!0,!0).then(fe=>{fe&&(this.poi=fe,this.ngOnChanges(null)),F&&F.target.complete()})}}return re.\u0275fac=function(F){return new(F||re)(c.Y36(d.c),c.Y36(V.SH),c.Y36(ct.sK),c.Y36(ye.z),c.Y36(V.IN),c.Y36(V.BX),c.Y36(He.R),c.Y36(je.F0))},re.\u0275cmp=c.Xpm({type:re,selectors:[["poi-details"]],inputs:{poi:"poi"},features:[c.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"banner"],[1,"banner-content"],["color","primary","title","Average User Rating"],["vertical","top","horizontal","end","slot","fixed"],["name","add"],["side","bottom"],["title","Add a comment or charging check-in",3,"click"],["name","chatbubbles"],["title","Add a Photo",3,"click"],["name","camera"],["title","Add to Favourites",3,"click"],["name","star"],["title","Submit an Edit",3,"click"],["name","create"],["title","Refresh",3,"click"],["name","refresh"],["slot","fixed",3,"ionRefresh"],["pullingIcon","caret-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["slot","start"],["slot","end"],[1,"ion-padding"],[3,"ngModel","ngModelChange"],["value","location","selected",""],["value","comments"],["value","media"],["class","address-details",4,"ngIf"],["style","white-space: pre-wrap;",4,"ngIf"],["size","small","title","Add to Favourites",3,"click"],["name","star","slot","start"],["name","create","slot","start"],[3,"click"],["name","navigate","slot","start"],["size","small","title","Add a comment or charging check-in",3,"click"],["name","chatbubbles","slot","start"],["size","small","title","Add a Photo",3,"click"],["name","camera","slot","start"],[1,"address-details"],["name","battery-charging"],[3,"item"],["name","book"],["name","information-circle"],["class","details",4,"ngIf"],["name","map"],[1,"label"],[1,"details"],["name","pin"],[1,"details-minor"],["name","call"],["name","mail"],["name","globe"],["target","_system",3,"href"],["name","help-circle"],[1,"ion-padding-left"],["name","link"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["class","ion-padding",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"src",4,"ngIf"],[3,"src"],["name","checkmark-circle","color","success",2,"font-size","2em"],["name","close-circle","color","danger"],[1,"subtle"],[2,"white-space","pre-wrap"]],template:function(F,fe){1&F&&(c.YNc(0,eo,51,21,"div",0),c.YNc(1,zr,5,0,"div",0)),2&F&&(c.Q6J("ngIf",null!=fe.poi&&null!=fe.poi.AddressInfo),c.xp6(1),c.Q6J("ngIf",null==fe.poi||null==fe.poi.AddressInfo))},directives:[L.O5,V.yp,V.IJ,V.W4,V.gu,V.zq,V.nJ,V.Wo,V.sr,V.Sm,V.YG,V.Q$,V.cJ,V.QI,p.JJ,p.On,V.GO,V.PM,V.Zi,V.FN,V.jY,V.Nd,V.wI,wt.B,L.sg,V.Ie,V.BJ],pipes:[L.JJ,ct.X$,L.uU],styles:[".banner[_ngcontent-%COMP%]{background-color:#4f712f;color:#ffffffec;padding:1em;text-shadow:#000 1px 1px 1px;min-height:180px;background-size:cover}.banner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.banner-content[_ngcontent-%COMP%]{padding-right:48px}h3[_ngcontent-%COMP%]{font-weight:700}.label[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:12px}.details[_ngcontent-%COMP%]{color:#707d61;margin-left:1em;font-size:12px}.details-minor[_ngcontent-%COMP%]{color:#707d61;font-size:12px}p[_ngcontent-%COMP%]{display:block;padding:4px}ion-card-header[_ngcontent-%COMP%]{font-weight:700;padding-bottom:0}ion-card-content[_ngcontent-%COMP%]{padding-top:4px}"]}),re})(),ur=(()=>{class re{constructor(F,fe,_e){this.modalController=F,this.navParams=fe,this.appManager=_e,this.hasNavbar=!1,this.poi=this.navParams.get("item"),this.appManager.analytics.viewEvent("POIDetails")}close(){this.modalController.dismiss()}}return re.\u0275fac=function(F){return new(F||re)(c.Y36(V.IN),c.Y36(V.X1),c.Y36(d.c))},re.\u0275cmp=c.Xpm({type:re,selectors:[["ng-component"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],[1,"poi-details"],[3,"poi"]],template:function(F,fe){1&F&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar",0),c.TgZ(2,"ion-title"),c._uU(3),c.TgZ(4,"small"),c._uU(5),c.qZA(),c.qZA(),c.TgZ(6,"ion-buttons",1),c.TgZ(7,"ion-button",2),c.NdJ("click",function(){return fe.close()}),c._UZ(8,"ion-icon",3),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.TgZ(9,"ion-content",4),c._UZ(10,"poi-details",5),c.qZA()),2&F&&(c.xp6(3),c.hij(" ",fe.poi.AddressInfo.Title," "),c.xp6(2),c.hij("OCM-",fe.poi.ID,""),c.xp6(5),c.Q6J("poi",fe.poi))},directives:[V.Gu,V.sr,V.wd,V.Sm,V.YG,V.gu,V.W2,Xi],styles:['.left-col[_ngcontent-%COMP%]{float:left;width:50%;overflow:auto}.right-col[_ngcontent-%COMP%]{float:right;width:50%;overflow:auto}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both;overflow:auto}.row[_ngcontent-%COMP%]{margin-bottom:1em}.subtle[_ngcontent-%COMP%]{color:silver}@media screen and (max-width: 768px){.left-col[_ngcontent-%COMP%]{float:none;width:100%}.right-col[_ngcontent-%COMP%]{margin-top:1em;float:none;width:100%}}.address-details[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;width:auto}ion-label[_ngcontent-%COMP%]{overflow:inherit}ion-title[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{color:#ffffffbf}']}),re})()},1948:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{PoiEditorPageModule:()=>Z});var d=k(6895),c=k(4006),V=k(3334),a=k(9064),O=k(4508),A=k(9397),p=k(8936),L=k(6738);const Q=[{path:"",component:O.Y}];let Z=(()=>{class z{}return z.\u0275fac=function(te){return new(te||z)},z.\u0275mod=L.oAB({type:z}),z.\u0275inj=L.cJS({imports:[[d.ez,c.u5,a.Pc,A.aw,p.e,V.Bz.forChild(Q)]]}),z})()},4508:(_n,Ke,k)=>{"use strict";k.d(Ke,{Y:()=>ft});var d=k(6099),c=k(3855),V=k(2206),a=k(6579),O=k(9698),A=k(4781),p=k(6738),L=k(4120),Q=k(5906),Z=k(553),z=k(7689),G=k(6260),te=k(529),ye=k(6895),me=k(9064);function Ee(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"ion-note"),p.TgZ(2,"p"),p._uU(3," The closest address to this position is: "),p.qZA(),p.TgZ(4,"p"),p.TgZ(5,"strong"),p._uU(6),p.qZA(),p._UZ(7,"br"),p._uU(8),p._UZ(9,"br"),p.TgZ(10,"ion-button",3),p.NdJ("click",function(){return p.CHM(xe),p.oxw().useAddressSelection()}),p._uU(11,"Use this address below "),p._UZ(12,"ion-icon",4),p.qZA(),p.qZA(),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw();p.xp6(6),p.Oqu(xe.suggestedAddress.AddressLine1),p.xp6(2),p.HOy(" ",xe.suggestedAddress.AddressLine2," ",xe.suggestedAddress.Town," ",xe.suggestedAddress.StateOrProvince," ",xe.suggestedAddress.Postcode," ")}}let je=(()=>{class Be{constructor(xe,Ie,Ut,nn,ni){this.mapping=xe,this.events=Ie,this.logging=Ut,this.http=nn,this.appManager=ni,this.latitudeChange=new p.vpe,this.longitudeChange=new p.vpe,this.suggestedAddress=null,this.suggestedAddressChange=new p.vpe,this.onUseSuggestedAddress=new p.vpe,this.suggestedAddressAttribution=null,this.suggestedAddressAttributionChange=new p.vpe,this.isMapInitialised=!1}ngOnInit(){this.mapService=new Z.k(this.events,this.logging,this.http),this.mapService.initAPI(),this.mapOptions=new Q._,this.mapOptions.mapType=this.appManager.searchSettings.MapType,this.mapOptions.onMapMoveCompleted=()=>{let xe;xe=this.mapService.getMapCenter(),xe.subscribe(Ie=>{Ie&&(this.latitude=Ie.coords.latitude,this.longitude=Ie.coords.longitude,this.latitudeChange.emit(this.latitude),this.longitudeChange.emit(this.longitude),this.getAddressForCurrentLatLng())})}}ngAfterContentInit(){this.focusMap()}ngOnDestroy(){this.mapService.disposeMap()}focusMap(){0==this.isMapInitialised&&this.mapService&&0!=this.latitude&&0!=this.longitude&&(this.isMapInitialised=!0,this.mapService.initMap("editor-map",this.mapOptions,null),this.mapService.setMapCenter(new L.jR(this.latitude,this.longitude)),this.originalMarkerPos=new L.wC(this.latitude,this.longitude))}ngOnChanges(xe){this.focusMap()}getAddressForCurrentLatLng(){var xe=this;return(0,d.Z)(function*(){xe.latitude&&xe.longitude&&xe.appManager.api.fetchReverseGeocodeResult(xe.latitude,xe.longitude).then(Ie=>{Ie.AddressInfo&&(xe.suggestedAddress=Ie.AddressInfo)})})()}useAddressSelection(){this.onUseSuggestedAddress.emit({suggestedAddress:this.suggestedAddress,attribution:this.suggestedAddressAttribution}),this.suggestedAddress=null,this.suggestedAddressAttribution=null}}return Be.\u0275fac=function(xe){return new(xe||Be)(p.Y36(A.v),p.Y36(G.z),p.Y36(z.z),p.Y36(te.eN),p.Y36(c.c))},Be.\u0275cmp=p.Xpm({type:Be,selectors:[["app-poi-location-editor"]],inputs:{latitude:"latitude",longitude:"longitude"},outputs:{latitudeChange:"latitudeChange",longitudeChange:"longitudeChange",suggestedAddressChange:"suggestedAddressChange",onUseSuggestedAddress:"onUseSuggestedAddress",suggestedAddressAttributionChange:"suggestedAddressAttributionChange"},features:[p.TTD],decls:4,vars:1,consts:[[1,"instruction"],["id","editor-map"],[4,"ngIf"],["size","small",3,"click"],["slot","end","name","copy"]],template:function(xe,Ie){1&xe&&(p.TgZ(0,"p",0),p._uU(1,"Drag the map to center the marker on the charging location:"),p.qZA(),p._UZ(2,"div",1),p.YNc(3,Ee,13,5,"ng-container",2)),2&xe&&(p.xp6(3),p.Q6J("ngIf",Ie.suggestedAddress))},directives:[ye.O5,me.uN,me.YG,me.gu],styles:["#editor-map[_ngcontent-%COMP%]{border:1px solid gainsboro;background-color:gray;width:100%;height:128px}"]}),Be})();var rt=k(6799),Ae=k(4006);function Ze(Be,$t){if(1&Be&&(p.TgZ(0,"ion-select-option",14),p._uU(1),p.qZA()),2&Be){const xe=$t.$implicit;p.Q6J("value",xe.ID),p.xp6(1),p.Oqu(xe.Title)}}function Ve(Be,$t){if(1&Be&&(p.TgZ(0,"ion-select-option",14),p._uU(1),p.qZA()),2&Be){const xe=$t.$implicit;p.Q6J("value",xe.ID),p.xp6(1),p.Oqu(xe.Title)}}function He(Be,$t){if(1&Be&&(p.TgZ(0,"ion-select-option",14),p._uU(1),p.qZA()),2&Be){const xe=$t.$implicit;p.Q6J("value",xe.ID),p.xp6(1),p.Oqu(xe.Title)}}let Ne=(()=>{class Be{constructor(xe,Ie){this.modalController=xe,this.referenceDataManager=Ie,this.useFilteredConnectionTypes=!0,this.useFilteredOperators=!0}get isAddMode(){return!(null!=this.conn&&this.conn.ID>0)}get connectionTypes(){return this.referenceDataManager.getConnectionTypes(this.useFilteredConnectionTypes)}get currentTypes(){return this.referenceDataManager.getOutputCurrentTypes()}get statusTypes(){return this.referenceDataManager.getStatusTypes().filter(xe=>1==xe.IsUserSelectable)}ngOnInit(){}save(){this.modalController.dismiss({item:this.conn})}cancel(){this.modalController.dismiss()}}return Be.\u0275fac=function(xe){return new(xe||Be)(p.Y36(me.IN),p.Y36(rt.W))},Be.\u0275cmp=p.Xpm({type:Be,selectors:[["app-poi-equipment-editor"]],decls:60,vars:13,consts:[[1,"ion-padding"],["position","floating"],[3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange"],["type","text","placeholder","(optional) other comments",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["slot","start"],[3,"click"],["name","close","slot","start"],["slot","end"],["color","success",3,"click"],["name","send","slot","end"],[3,"value"]],template:function(xe,Ie){1&xe&&(p.TgZ(0,"ion-header"),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-title"),p._uU(3),p.qZA(),p.qZA(),p.qZA(),p.TgZ(4,"ion-content",0),p.TgZ(5,"p"),p._uU(6,"Please provide as much information as you can about the equipment. If you don't know then leave the field blank. At a minimum you should include the Connection Type and approximate Power kW (max)."),p.qZA(),p.TgZ(7,"ion-item"),p.TgZ(8,"ion-label",1),p._uU(9,"Connection Type"),p.qZA(),p.TgZ(10,"ion-select",2),p.NdJ("ngModelChange",function(nn){return Ie.conn.ConnectionTypeID=nn}),p.TgZ(11,"ion-select-option",3),p._uU(12,"Unknown"),p.qZA(),p.YNc(13,Ze,2,2,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(14,"ion-item"),p.TgZ(15,"ion-label",1),p._uU(16,"Supply Type"),p.qZA(),p.TgZ(17,"ion-select",2),p.NdJ("ngModelChange",function(nn){return Ie.conn.CurrentTypeID=nn}),p.TgZ(18,"ion-select-option",3),p._uU(19,"Unknown"),p.qZA(),p.YNc(20,Ve,2,2,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(21,"ion-item"),p.TgZ(22,"ion-label",1),p._uU(23,"Power (kW)"),p.qZA(),p.TgZ(24,"ion-input",5),p.NdJ("ngModelChange",function(nn){return Ie.conn.PowerKW=nn}),p.qZA(),p.qZA(),p.TgZ(25,"ion-item"),p.TgZ(26,"ion-label",1),p._uU(27,"Amps"),p.qZA(),p.TgZ(28,"ion-input",5),p.NdJ("ngModelChange",function(nn){return Ie.conn.Amps=nn}),p.qZA(),p.qZA(),p.TgZ(29,"ion-item"),p.TgZ(30,"ion-label",1),p._uU(31,"Voltage"),p.qZA(),p.TgZ(32,"ion-input",5),p.NdJ("ngModelChange",function(nn){return Ie.conn.Voltage=nn}),p.qZA(),p.qZA(),p.TgZ(33,"ion-item"),p.TgZ(34,"ion-label",1),p._uU(35,"Status"),p.qZA(),p.TgZ(36,"ion-select",2),p.NdJ("ngModelChange",function(nn){return Ie.conn.StatusTypeID=nn}),p.YNc(37,He,2,2,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(38,"ion-item"),p.TgZ(39,"ion-label",1),p._uU(40,"Quantity Available"),p.qZA(),p.TgZ(41,"ion-input",5),p.NdJ("ngModelChange",function(nn){return Ie.conn.Quantity=nn}),p.qZA(),p.qZA(),p.TgZ(42,"ion-item"),p.TgZ(43,"ion-label",1),p._uU(44,"Comment"),p.qZA(),p.TgZ(45,"ion-input",6),p.NdJ("ngModelChange",function(nn){return Ie.conn.Comments=nn}),p.qZA(),p.qZA(),p.TgZ(46,"ion-item"),p.TgZ(47,"ion-label",1),p._uU(48,"Operators Reference"),p.qZA(),p.TgZ(49,"ion-input",7),p.NdJ("ngModelChange",function(nn){return Ie.conn.Reference=nn}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(50,"ion-footer"),p.TgZ(51,"ion-toolbar"),p.TgZ(52,"ion-buttons",8),p.TgZ(53,"ion-button",9),p.NdJ("click",function(){return Ie.cancel()}),p._UZ(54,"ion-icon",10),p._uU(55," Cancel "),p.qZA(),p.qZA(),p.TgZ(56,"ion-buttons",11),p.TgZ(57,"ion-button",12),p.NdJ("click",function(){return Ie.save()}),p._uU(58," OK "),p._UZ(59,"ion-icon",13),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&xe&&(p.xp6(3),p.Oqu(Ie.isAddMode?"Add Equipment":"Edit Equipment"),p.xp6(7),p.Q6J("ngModel",Ie.conn.ConnectionTypeID),p.xp6(3),p.Q6J("ngForOf",Ie.connectionTypes),p.xp6(4),p.Q6J("ngModel",Ie.conn.CurrentTypeID),p.xp6(3),p.Q6J("ngForOf",Ie.currentTypes),p.xp6(4),p.Q6J("ngModel",Ie.conn.PowerKW),p.xp6(4),p.Q6J("ngModel",Ie.conn.Amps),p.xp6(4),p.Q6J("ngModel",Ie.conn.Voltage),p.xp6(4),p.Q6J("ngModel",Ie.conn.StatusTypeID),p.xp6(1),p.Q6J("ngForOf",Ie.statusTypes),p.xp6(4),p.Q6J("ngModel",Ie.conn.Quantity),p.xp6(4),p.Q6J("ngModel",Ie.conn.Comments),p.xp6(4),p.Q6J("ngModel",Ie.conn.Reference))},directives:[me.Gu,me.sr,me.wd,me.W2,me.Ie,me.Q$,me.t9,me.QI,Ae.JJ,Ae.On,me.n0,ye.sg,me.pK,me.as,me.j9,me.fr,me.Sm,me.YG,me.gu],styles:[""]}),Be})();var xt=(()=>{return(Be=xt||(xt={}))[Be.Unknown=0]="Unknown",Be[Be.CurrentlyAvailable=10]="CurrentlyAvailable",Be[Be.CurrentlyInUse=20]="CurrentlyInUse",Be[Be.TemporarilyUnavailable=30]="TemporarilyUnavailable",Be[Be.Operational=50]="Operational",Be[Be.PartlyOperational=75]="PartlyOperational",Be[Be.NotOperational=100]="NotOperational",Be[Be.PlannedForFutureDate=150]="PlannedForFutureDate",Be[Be.RemovedDecomissioned=200]="RemovedDecomissioned",xt;var Be})(),Je=(()=>{return(Be=Je||(Je={}))[Be.UnknownOperator=1]="UnknownOperator",Be[Be.SiteOwner=45]="SiteOwner",Je;var Be})(),Tt=k(6585);function Ct(Be,$t){if(1&Be&&(p.TgZ(0,"ion-select-option",5),p._uU(1),p.qZA()),2&Be){const xe=$t.$implicit;p.Q6J("value",xe.ID),p.xp6(1),p.Oqu(xe.Title)}}function gt(Be,$t){1&Be&&(p.TgZ(0,"ion-select-option",6),p._uU(1,"Other..."),p.qZA())}function Lt(Be,$t){if(1&Be){const xe=p.EpF();p.TgZ(0,"ion-item"),p.TgZ(1,"ion-label",1),p._uU(2,"Network Operator"),p.qZA(),p.TgZ(3,"ion-select",2),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().operatorId=Ut})("ionChange",function(){return p.CHM(xe),p.oxw().onOperatorChange()}),p.YNc(4,Ct,2,2,"ion-select-option",3),p.YNc(5,gt,2,0,"ion-select-option",4),p.qZA(),p.qZA()}if(2&Be){const xe=p.oxw();p.xp6(3),p.Q6J("ngModel",xe.operatorId),p.xp6(1),p.Q6J("ngForOf",xe.operators),p.xp6(1),p.Q6J("ngIf",xe.useFilteredOperators)}}function Ht(Be,$t){if(1&Be){const xe=p.EpF();p.TgZ(0,"ion-item"),p.TgZ(1,"ion-label"),p._uU(2,"Network Operator"),p.qZA(),p.TgZ(3,"ion-searchbar",7),p.NdJ("ionCancel",function(){return p.CHM(xe),p.oxw().cancelOperatorLookup()})("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().operatorSearchKeyword=Ut})("ionChange",function(Ut){return p.CHM(xe),p.oxw().searchOperators(Ut)}),p.qZA(),p.qZA()}if(2&Be){const xe=p.oxw();p.xp6(3),p.Q6J("ngModel",xe.operatorSearchKeyword)}}function Vn(Be,$t){if(1&Be){const xe=p.EpF();p.TgZ(0,"ion-item",9),p.NdJ("click",function(){const nn=p.CHM(xe).$implicit;return p.oxw(2).onOperatorChange(nn)}),p.TgZ(1,"ion-avatar",10),p._UZ(2,"ion-icon",11),p.qZA(),p.TgZ(3,"ion-label"),p.TgZ(4,"p"),p._uU(5),p.qZA(),p.TgZ(6,"p"),p._uU(7),p.qZA(),p.qZA(),p.qZA()}if(2&Be){const xe=$t.$implicit;p.xp6(5),p.Oqu(xe.Title),p.xp6(2),p.Oqu(xe.WebsiteURL)}}function Ft(Be,$t){if(1&Be&&(p.ynx(0),p.TgZ(1,"ion-list"),p.YNc(2,Vn,8,2,"ion-item",8),p.qZA(),p.BQk()),2&Be){const xe=p.oxw();p.xp6(2),p.Q6J("ngForOf",xe.operatorSearchResults)}}function Wt(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"ion-item"),p.TgZ(2,"ion-avatar",10),p._UZ(3,"ion-icon",12),p.qZA(),p.TgZ(4,"ion-label"),p.TgZ(5,"p"),p._uU(6),p.qZA(),p.TgZ(7,"p"),p._uU(8),p.qZA(),p.TgZ(9,"ion-button",9),p.NdJ("click",function(){return p.CHM(xe),p.oxw().selectedOperator=null}),p._uU(10,"Change"),p.qZA(),p.qZA(),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw();p.xp6(6),p.Oqu(xe.selectedOperator.Title),p.xp6(2),p.Oqu(xe.selectedOperator.WebsiteURL)}}let Gt=(()=>{class Be{constructor(xe){this.referenceDataManager=xe,this.operatorId=null,this.useFilteredOperators=null,this.operatorChanged=new p.vpe,this.operatorCache=[],this.operatorSearchResults=[],this.operatorSearchKeyword="",this.selectedOperator=null}get operators(){return this.referenceDataManager.getNetworkOperators(this.useFilteredOperators)}ngOnInit(){this.operatorCache=this.referenceDataManager.getNetworkOperators(!1),null!=this.operatorId&&(this.selectedOperator=this.operatorCache.find(xe=>xe.ID==this.operatorId))}searchOperators(){this.operatorSearchResults=[],0!=this.operatorSearchKeyword.length&&(this.operatorSearchResults=this.operatorCache?this.operatorCache.filter(xe=>xe.Title.toLowerCase().startsWith(this.operatorSearchKeyword.toLowerCase())||xe.Title.toLowerCase().startsWith("("+this.operatorSearchKeyword.toLowerCase())).slice(0,10):[])}onOperatorChange(xe=null){var Ie=this;return(0,d.Z)(function*(){null==xe&&Ie.operatorId&&(xe=Ie.operatorCache.find(Ut=>Ut.ID==Ie.operatorId)),null!=xe&&(Ie.operatorSearchResults=[],Ie.selectedOperator=xe,Ie.operatorId=xe.ID),Ie.operatorId?Ie.operatorChanged.emit(Ie.selectedOperator):Ie.useFilteredOperators=!1})()}cancelOperatorLookup(){this.selectedOperator=null}}return Be.\u0275fac=function(xe){return new(xe||Be)(p.Y36(rt.W))},Be.\u0275cmp=p.Xpm({type:Be,selectors:[["app-operator-lookup"]],inputs:{operatorId:"operatorId",useFilteredOperators:"useFilteredOperators"},outputs:{operatorChanged:"operatorChanged"},decls:4,vars:4,consts:[[4,"ngIf"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value"],["value",""],["placeholder","Search by network name (in any country)","showCancelButton","focus","autocomplete","on",3,"ngModel","ionCancel","ngModelChange","ionChange"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["item-left",""],["name","card"],["name","locate"]],template:function(xe,Ie){1&xe&&(p.YNc(0,Lt,6,3,"ion-item",0),p.YNc(1,Ht,4,1,"ion-item",0),p.YNc(2,Ft,3,1,"ng-container",0),p.YNc(3,Wt,11,2,"ng-container",0)),2&xe&&(p.Q6J("ngIf",Ie.useFilteredOperators&&!Ie.selectedOperator),p.xp6(1),p.Q6J("ngIf",!Ie.useFilteredOperators&&!Ie.selectedOperator),p.xp6(1),p.Q6J("ngIf",Ie.operatorSearchResults.length>0),p.xp6(1),p.Q6J("ngIf",null!=Ie.selectedOperator))},directives:[ye.O5,me.Ie,me.Q$,me.t9,me.QI,Ae.JJ,Ae.On,ye.sg,me.n0,me.VI,me.j9,me.q_,me.BJ,me.gu,me.YG],styles:[""]}),Be})();var Jt=k(1099);function an(Be,$t){1&Be&&p._UZ(0,"ion-icon",13)}function Jn(Be,$t){1&Be&&p._UZ(0,"ion-icon",13)}function si(Be,$t){1&Be&&p._UZ(0,"ion-icon",13)}function di(Be,$t){if(1&Be&&(p.TgZ(0,"ion-select-option",27),p._uU(1),p.qZA()),2&Be){const xe=$t.$implicit;p.Q6J("value",xe.ID),p.xp6(1),p.Oqu(xe.Title)}}function Bn(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"app-poi-location-editor",14,15),p.NdJ("latitudeChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.Latitude=Ut})("longitudeChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.Longitude=Ut})("onUseSuggestedAddress",function(Ut){return p.CHM(xe),p.oxw(2).useSuggestedAddress(Ut)}),p.qZA(),p.TgZ(3,"ion-list"),p.TgZ(4,"ion-item"),p.TgZ(5,"ion-label",16),p._uU(6,"Location Name"),p.qZA(),p.TgZ(7,"ion-input",17),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.Title=Ut}),p.qZA(),p.qZA(),p.TgZ(8,"ion-item"),p.TgZ(9,"ion-label",16),p._uU(10,"Address Line 1"),p.qZA(),p.TgZ(11,"ion-input",18),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.AddressLine1=Ut}),p.qZA(),p.qZA(),p.TgZ(12,"ion-item"),p.TgZ(13,"ion-label",16),p._uU(14,"Address Line 2"),p.qZA(),p.TgZ(15,"ion-input",19),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.AddressLine2=Ut}),p.qZA(),p.qZA(),p.TgZ(16,"ion-item"),p.TgZ(17,"ion-label",16),p._uU(18,"Town"),p.qZA(),p.TgZ(19,"ion-input",20),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.Town=Ut}),p.qZA(),p.qZA(),p.TgZ(20,"ion-item"),p.TgZ(21,"ion-label",16),p._uU(22,"State or Province"),p.qZA(),p.TgZ(23,"ion-input",21),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.StateOrProvince=Ut}),p.qZA(),p.qZA(),p.TgZ(24,"ion-item"),p.TgZ(25,"ion-label",16),p._uU(26,"Postal Code"),p.qZA(),p.TgZ(27,"ion-input",22),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.Postcode=Ut}),p.qZA(),p.qZA(),p.TgZ(28,"ion-item"),p.TgZ(29,"ion-label",16),p._uU(30,"Country"),p.qZA(),p.TgZ(31,"ion-select",23),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.CountryID=Ut})("ionChange",function(){return p.CHM(xe),p.oxw(2).onCountryChange()}),p.YNc(32,di,2,2,"ion-select-option",24),p.qZA(),p.qZA(),p.TgZ(33,"ion-item"),p.TgZ(34,"ion-label",16),p._uU(35,"Latitude"),p.qZA(),p.TgZ(36,"ion-input",25),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.Latitude=Ut}),p.qZA(),p.qZA(),p.TgZ(37,"ion-item"),p.TgZ(38,"ion-label",16),p._uU(39,"Longitude"),p.qZA(),p.TgZ(40,"ion-input",26),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.AddressInfo.Longitude=Ut}),p.qZA(),p.qZA(),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw(2);p.xp6(1),p.Q6J("latitude",xe.item.AddressInfo.Latitude)("longitude",xe.item.AddressInfo.Longitude),p.xp6(6),p.Q6J("ngModel",xe.item.AddressInfo.Title),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.AddressLine1),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.AddressLine2),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.Town),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.StateOrProvince),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.Postcode),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.CountryID),p.xp6(1),p.Q6J("ngForOf",xe.countries),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.Latitude),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.Longitude)}}function ln(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"h3"),p._uU(2,"Locations Nearby"),p.qZA(),p.TgZ(3,"p"),p.TgZ(4,"strong"),p._uU(5,"The following locations already exist nearby."),p.qZA(),p.qZA(),p.TgZ(6,"div",28),p.TgZ(7,"p"),p._uU(8,"Ensure you are not adding a duplicate site unless it is for different equipment from another network operator."),p.qZA(),p.TgZ(9,"p"),p._uU(10,"You can edit any of these listings if required instead:"),p.qZA(),p.qZA(),p.TgZ(11,"app-poi-list",29),p.NdJ("onEdit",function(Ut){return p.CHM(xe),p.oxw(2).editPOI(Ut)}),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw(2);p.xp6(11),p.Q6J("poiList",xe.nearbySites)("enableEditOption",!0)}}function Et(Be,$t){if(1&Be&&(p.ynx(0),p.YNc(1,Bn,41,12,"ng-container",9),p.YNc(2,ln,12,2,"ng-container",9),p.BQk()),2&Be){const xe=p.oxw();p.xp6(1),p.Q6J("ngIf","location"==xe.step),p.xp6(1),p.Q6J("ngIf","poi-nearby"==xe.step)}}function Kt(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"p"),p._uU(2,"Copied the equipment configuration from:"),p.qZA(),p.TgZ(3,"ion-item"),p.TgZ(4,"ion-label"),p._uU(5),p._UZ(6,"br"),p._uU(7),p._UZ(8,"br"),p._uU(9),p._UZ(10,"br"),p._uU(11),p._UZ(12,"br"),p._uU(13),p.qZA(),p.TgZ(14,"ion-button",31),p.NdJ("click",function(){return p.CHM(xe),p.oxw(5).changeTemplatePOI()}),p._uU(15,"Change.."),p.qZA(),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw(5);p.xp6(5),p.hij(" ",xe.selectedTemplatePOI.AddressInfo.Title," "),p.xp6(2),p.hij(" ",xe.selectedTemplatePOI.AddressInfo.AddressLine1," "),p.xp6(2),p.hij(" ",null==xe.selectedTemplatePOI.Connections[0].ConnectionType?null:xe.selectedTemplatePOI.Connections[0].ConnectionType.Title," "),p.xp6(2),p.hij(" ",xe.selectedTemplatePOI.Connections[0].PowerKW," "),p.xp6(2),p.hij(" ",xe.selectedTemplatePOI.DateCreated," ")}}function Hn(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"h4"),p._uU(2,"Similar Sites"),p.qZA(),p.TgZ(3,"app-poi-list",32),p.NdJ("onCopy",function(Ut){return p.CHM(xe),p.oxw(6).useTemplatePOI(Ut)}),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw(6);p.xp6(3),p.Q6J("enableCopyOption",!0)("poiList",xe.templateSites)}}function In(Be,$t){1&Be&&(p.ynx(0),p.TgZ(1,"p"),p._uU(2," There are no suggested sites to copy for this network operator. "),p.qZA(),p.BQk())}function ti(Be,$t){if(1&Be&&(p.ynx(0),p.YNc(1,Hn,4,2,"ng-container",9),p.YNc(2,In,3,0,"ng-container",9),p.BQk()),2&Be){const xe=p.oxw(5);p.xp6(1),p.Q6J("ngIf",xe.templateSites.length>0),p.xp6(1),p.Q6J("ngIf",0==xe.templateSites.length)}}function mi(Be,$t){if(1&Be&&(p.ynx(0),p.YNc(1,Kt,16,5,"ng-container",9),p.YNc(2,ti,3,2,"ng-container",9),p.BQk()),2&Be){const xe=p.oxw(4);p.xp6(1),p.Q6J("ngIf",xe.selectedTemplatePOI),p.xp6(1),p.Q6J("ngIf",!xe.selectedTemplatePOI)}}function ir(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"p",28),p._uU(2,"You can copy the equipment settings from other sites operated by the same network operator or choose 'Next' to skip this step: "),p.qZA(),p.TgZ(3,"app-operator-lookup",30),p.NdJ("operatorChanged",function(Ut){return p.CHM(xe),p.oxw(3).onOperatorChange(Ut)}),p.qZA(),p.YNc(4,mi,3,2,"ng-container",9),p.BQk()}if(2&Be){const xe=p.oxw(3);p.xp6(3),p.Q6J("operatorId",xe.item.OperatorID),p.xp6(1),p.Q6J("ngIf",xe.item.AddressInfo.CountryID&&xe.item.OperatorID)}}function _r(Be,$t){if(1&Be&&(p.ynx(0),p.YNc(1,ir,5,2,"ng-container",9),p.BQk()),2&Be){const xe=p.oxw(2);p.xp6(1),p.Q6J("ngIf",!xe.skipPOICopy)}}function er(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.TgZ(1,"app-operator-lookup",33),p.NdJ("operatorChanged",function(Ut){return p.CHM(xe),p.oxw(2).onOperatorChange(Ut)}),p.qZA(),p.TgZ(2,"ion-item"),p.TgZ(3,"ion-label",16),p._uU(4,"Number of Stations or Parking Bays"),p.qZA(),p.TgZ(5,"ion-input",21),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw(2).item.NumberOfPoints=Ut}),p.qZA(),p.qZA(),p.TgZ(6,"h4"),p._uU(7,"Equipment"),p.qZA(),p.TgZ(8,"ion-button",34),p.NdJ("click",function(){return p.CHM(xe),p.oxw(2).addConnection()}),p._UZ(9,"ion-icon",35),p.qZA(),p.TgZ(10,"app-equipment-details",36),p.NdJ("onEdit",function(Ut){return p.CHM(xe),p.oxw(2).editConnection(Ut)})("onDelete",function(Ut){return p.CHM(xe),p.oxw(2).deleteConnection(Ut)}),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw(2);p.xp6(1),p.Q6J("operatorId",xe.item.OperatorID)("useFilteredOperators",!1),p.xp6(4),p.Q6J("ngModel",xe.item.NumberOfPoints),p.xp6(5),p.Q6J("item",xe.item)("enableEdit",!0)}}function Ri(Be,$t){if(1&Be&&(p.ynx(0),p.YNc(1,_r,2,1,"ng-container",9),p.YNc(2,er,11,5,"ng-container",9),p.BQk()),2&Be){const xe=p.oxw();p.xp6(1),p.Q6J("ngIf","copy-equipment"==xe.step),p.xp6(1),p.Q6J("ngIf","edit-equipment"==xe.step)}}function mr(Be,$t){if(1&Be&&(p.TgZ(0,"p",43),p.TgZ(1,"strong"),p._uU(2,"Your changes cannot be saved until the following issues are resolved:"),p.qZA(),p.TgZ(3,"ion-label",44),p._uU(4),p.qZA(),p.qZA()),2&Be){const xe=p.oxw(2);p.xp6(4),p.hij(" ",xe.validationMsg,"")}}function Si(Be,$t){if(1&Be&&(p.TgZ(0,"ion-select-option",27),p._uU(1),p.qZA()),2&Be){const xe=$t.$implicit;p.Q6J("value",xe.ID),p.xp6(1),p.Oqu(xe.Title)}}function ki(Be,$t){if(1&Be&&(p.TgZ(0,"ion-select-option",27),p._uU(1),p.qZA()),2&Be){const xe=$t.$implicit;p.Q6J("value",xe.ID),p.xp6(1),p.Oqu(xe.Title)}}function Qt(Be,$t){if(1&Be){const xe=p.EpF();p.ynx(0),p.YNc(1,mr,5,1,"p",37),p.TgZ(2,"p"),p._uU(3,"Please provide any other facts related to this site. Additional comments (your charging experiences etc) can be added as check-in comments once the site is listed."),p.qZA(),p.TgZ(4,"ion-item"),p.TgZ(5,"ion-label",16),p._uU(6,"Operational Status (All Equipment))"),p.qZA(),p.TgZ(7,"ion-select",38),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.StatusTypeID=Ut}),p.YNc(8,Si,2,2,"ion-select-option",24),p.qZA(),p.qZA(),p.TgZ(9,"ion-item"),p.TgZ(10,"ion-label",16),p._uU(11,"Usage Type"),p.qZA(),p.TgZ(12,"ion-select",38),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.UsageTypeID=Ut}),p.YNc(13,ki,2,2,"ion-select-option",24),p.qZA(),p.qZA(),p.TgZ(14,"ion-item"),p.TgZ(15,"ion-label",16),p._uU(16,"Usage Cost"),p.qZA(),p.TgZ(17,"ion-input",21),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.UsageCost=Ut}),p.qZA(),p.qZA(),p.TgZ(18,"ion-item"),p.TgZ(19,"ion-label",16),p._uU(20,"General Comments"),p.qZA(),p.TgZ(21,"ion-input",39),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.GeneralComments=Ut}),p.qZA(),p.qZA(),p.TgZ(22,"ion-item"),p.TgZ(23,"ion-label",16),p._uU(24,"Main Telephone Number "),p.qZA(),p.TgZ(25,"ion-input",40),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.AddressInfo.ContactTelephone1=Ut}),p.qZA(),p.qZA(),p.TgZ(26,"ion-item"),p.TgZ(27,"ion-label",16),p._uU(28,"Other Telephone Number "),p.qZA(),p.TgZ(29,"ion-input",40),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.AddressInfo.ContactTelephone2=Ut}),p.qZA(),p.qZA(),p.TgZ(30,"ion-item"),p.TgZ(31,"ion-label",16),p._uU(32,"Access Comments"),p.qZA(),p.TgZ(33,"ion-input",41),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.AddressInfo.AccessComments=Ut}),p.qZA(),p.qZA(),p.TgZ(34,"ion-item"),p.TgZ(35,"ion-label",16),p._uU(36,"Related Website"),p.qZA(),p.TgZ(37,"ion-input",42),p.NdJ("ngModelChange",function(Ut){return p.CHM(xe),p.oxw().item.AddressInfo.RelatedURL=Ut}),p.qZA(),p.qZA(),p.BQk()}if(2&Be){const xe=p.oxw();p.xp6(1),p.Q6J("ngIf",xe.validationMsg),p.xp6(6),p.Q6J("ngModel",xe.item.StatusTypeID),p.xp6(1),p.Q6J("ngForOf",xe.statusTypes),p.xp6(4),p.Q6J("ngModel",xe.item.UsageTypeID),p.xp6(1),p.Q6J("ngForOf",xe.usageTypes),p.xp6(4),p.Q6J("ngModel",xe.item.UsageCost),p.xp6(4),p.Q6J("ngModel",xe.item.GeneralComments),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.ContactTelephone1),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.ContactTelephone2),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.AccessComments),p.xp6(4),p.Q6J("ngModel",xe.item.AddressInfo.RelatedURL)}}function et(Be,$t){if(1&Be){const xe=p.EpF();p.TgZ(0,"ion-button",1),p.NdJ("click",function(){return p.CHM(xe),p.oxw().previous()}),p._uU(1," Previous "),p._UZ(2,"ion-icon",45),p.qZA()}}function de(Be,$t){if(1&Be){const xe=p.EpF();p.TgZ(0,"ion-button",1),p.NdJ("click",function(){return p.CHM(xe),p.oxw().next()}),p._uU(1," Next "),p._UZ(2,"ion-icon",46),p.qZA()}}function Pe(Be,$t){if(1&Be){const xe=p.EpF();p.TgZ(0,"ion-button",47),p.NdJ("click",function(){return p.CHM(xe),p.oxw().save()}),p._uU(1," Submit "),p._UZ(2,"ion-icon",48),p.qZA()}}let ft=(()=>{class Be{constructor(xe,Ie,Ut,nn,ni,cr){this.appManager=xe,this.modalController=Ie,this.poiManager=Ut,this.mapping=nn,this.loadingController=ni,this.alertController=cr,this.useFilteredConnectionTypes=!0,this.templateSites=[],this.nearbySites=[],this.selectedTemplatePOI=null,this.suggestedAddress=null,this.suggestedAddressAttribution=null,this.isNonDuplicateConfirmed=!1,this.skipPOICopy=!1,this.validationMsg=null,this.initNewItem()}get countries(){return this.appManager.referenceDataManager.getCountries()}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes()}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes().filter(xe=>1==xe.IsUserSelectable)}get isAddMode(){return this.item.ID<=0}initNewItem(){this.item={ID:-1,DataProviderID:1,DataProvidersReference:null,OperatorsReference:null,OperatorID:1,UsageCost:null,UsageTypeID:4,NumberOfPoints:1,GeneralComments:null,DatePlanned:null,StatusTypeID:50,SubmissionStatusTypeID:null,Connections:[],MetadataValues:[],AddressInfo:{ID:-1,CountryID:18,Title:"",AddressLine1:"",Latitude:0,Longitude:0}},this.step="location",this.selectedTab="location"}get isReadyToSubmit(){return this.validate().isValid&&"info"==this.step}ngOnInit(){}presentLoadingUI(){var xe=this;return(0,d.Z)(function*(){xe.loading=yield xe.loadingController.create({message:"Please Wait.."}),yield xe.loading.present()})()}dismissLoadingUI(){var xe=this;return(0,d.Z)(function*(){xe.loading&&(yield xe.loading.dismiss())})()}ionViewDidEnter(){if(null!=this.id)this.editExistingPOI(this.id);else{let xe=localStorage.getItem("_editor-operatorid");xe&&(this.item.OperatorID=parseInt(xe,10)),this.startPos?(this.item.AddressInfo.Latitude=this.startPos.latitude,this.item.AddressInfo.Longitude=this.startPos.longitude):this.mapping&&this.mapping.getMapCenter().subscribe(Ie=>{Ie&&(this.item.AddressInfo.Latitude=Ie.coords.latitude,this.item.AddressInfo.Longitude=Ie.coords.longitude)})}this.refreshFilteredReferenceData()}previous(){var xe=this;return(0,d.Z)(function*(){switch(xe.step){case"info":xe.step="edit-equipment";break;case"edit-equipment":xe.step=xe.isAddMode?"copy-equipment":"location";break;case"copy-equipment":case"poi-nearby":xe.step="location"}yield xe.initCurrentStep(!1)})()}next(){var xe=this;return(0,d.Z)(function*(){if("poi-nearby"==xe.step&&xe.nearbySites.length>0&&!xe.isNonDuplicateConfirmed)return void(yield xe.alertController.create({header:"Confirm",message:"Please confirm you are not adding a duplicate site.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:nn=>{}},{text:"Confirm",handler:()=>{xe.isNonDuplicateConfirmed=!0,xe.next()}}]})).present();const Ie=xe.validate(xe.step);if(Ie.isValid){switch(xe.step){case"location":xe.step=xe.isAddMode?"poi-nearby":"edit-equipment";break;case"poi-nearby":xe.step=xe.isAddMode?"copy-equipment":"edit-equipment";break;case"copy-equipment":xe.step="edit-equipment";break;case"edit-equipment":xe.step="info"}yield xe.initCurrentStep(!0)}else(yield xe.alertController.create({message:Ie.msg})).present()})()}initCurrentStep(xe){var Ie=this;return(0,d.Z)(function*(){"poi-nearby"==Ie.step?(Ie.selectedTab="location",0==(yield Ie.refreshNearbySites())&&(xe?yield Ie.next():yield Ie.previous())):"location"==Ie.step?Ie.selectedTab="location":"copy-equipment"==Ie.step?(Ie.selectedTab="equipment",yield Ie.refreshTemplateSites()):"edit-equipment"==Ie.step?Ie.selectedTab="equipment":"info"==Ie.step&&(Ie.selectedTab="info")})()}onCountryChange(){var xe=this;return(0,d.Z)(function*(){xe.refreshFilteredReferenceData()})()}onOperatorChange(xe=null){var Ie=this;return(0,d.Z)(function*(){null!=xe&&Ie.item.OperatorID!=xe.ID&&(Ie.item.OperatorID=xe.ID,localStorage.setItem("_editor-operatorid",Ie.item.OperatorID.toString()),yield Ie.refreshTemplateSites())})()}useSuggestedAddress(xe=null){xe&&(this.suggestedAddress=xe.suggestedAddress,this.suggestedAddressAttribution=xe.suggestedAddressAttribution),Object.assign(this.item.AddressInfo,this.suggestedAddress),this.suggestedAddressAttribution&&(this.item.MetadataValues.find(Ie=>4==Ie.MetadataFieldID)||this.item.MetadataValues.push({ID:-1,MetadataFieldID:4,ItemValue:this.suggestedAddressAttribution,MetadataFieldOptionID:null,MetadataFieldOption:null}))}editConnection(xe){var Ie=this;return(0,d.Z)(function*(){const Ut=Ie.item.Connections.find(cr=>cr.ID==xe.ID),nn=Object.assign({},Ut),ni=yield Ie.modalController.create({component:Ne,componentProps:{conn:nn}});return ni.onWillDismiss().then(cr=>{cr&&cr.data&&cr.data.item&&Ie.updateConnection(cr.data.item)}),yield ni.present()})()}deleteConnection(xe){var Ie=this;return(0,d.Z)(function*(){const Ut=Ie.item.Connections.find(ni=>ni.ID==xe.ID);(yield Ie.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this connection information?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Yes",handler:()=>{Ie.item.Connections=Ie.item.Connections.filter(ni=>ni.ID!=Ut.ID),Ie.appManager.referenceDataManager.hydrateCompactPOI(Ie.item,!0)}}]})).present()})()}addConnection(){var xe=this;return(0,d.Z)(function*(){const Ie={ID:-a.c.getRandomInt(1e4),ConnectionTypeID:null,StatusTypeID:50,PowerKW:null,Quantity:1},Ut=yield xe.modalController.create({component:Ne,componentProps:{conn:Ie}});return Ut.onWillDismiss().then(nn=>{nn&&nn.data&&nn.data.item&&xe.updateConnection(nn.data.item)}),yield Ut.present()})()}refreshFilteredReferenceData(){this.appManager.referenceDataManager.refreshFilteredReferenceData(this.appManager.api,{CountryIds:[this.item.AddressInfo.CountryID]})}updateConnection(xe){if(xe){let Ie=this.item.Connections.find(Ut=>Ut.ID==xe.ID);Ie?Object.assign(Ie,xe):this.item.Connections.push(xe)}this.appManager.referenceDataManager.hydrateCompactPOI(this.item,!0)}validate(xe="all"){let Ie=null;return("all"==xe||"location"==xe)&&((!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(Ie="Location is required"),""==this.item.AddressInfo.Title&&(Ie="A location title is required"),this.item.AddressInfo.CountryID||(Ie="A country selection is required"),(!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(Ie="A location latitude and longitude is required")),("all"==xe||"poi-nearby"==xe)&&this.nearbySites.length>0&&!this.isNonDuplicateConfirmed&&(Ie="Please confirm that the site is not a duplicate"),("all"==xe||"equipment"==xe)&&(this.item.OperatorID||(Ie="Please confirm the charging network or equipment operator."),0==this.item.Connections.length&&(Ie="Equipment information is required")),Ie?(this.validationMsg=Ie,{isValid:!1,msg:Ie}):(this.validationMsg=null,{isValid:!0,msg:null})}save(){var xe=this;return(0,d.Z)(function*(){let Ie=xe.validate();if(Ie.isValid){yield xe.presentLoadingUI();try{yield xe.appManager.submitPOI(xe.item),yield xe.dismissLoadingUI(),xe.appManager.showToastNotification("You submission will be reviewed (if required) and published shortly."),xe.modalController.dismiss()}catch(Ut){yield xe.dismissLoadingUI(),Ut.error&&alert("Sorry, your submission could not be completed at this time. Please try again later.")}}else alert(Ie.msg)})()}cancel(){var xe=this;return(0,d.Z)(function*(){xe.modalController.dismiss()})()}refreshTemplateSites(){var xe=this;return(0,d.Z)(function*(){if(xe.item.AddressInfo.CountryID&&xe.item.OperatorID){yield xe.presentLoadingUI(),xe.templateSites=[];let Ie=new V.b;Ie.countryIdList=[xe.item.AddressInfo.CountryID],Ie.minPowerKW=1,Ie.operatorIdList=[xe.item.OperatorID],Ie.maxResults=10;let Ut=yield xe.poiManager.fetchPOIList(Ie);Ut.sort((nn,ni)=>new Date(nn.DateCreated).getTime()-new Date(ni.DateCreated).getTime()),xe.templateSites=Ut,xe.dismissLoadingUI()}})()}refreshNearbySites(){var xe=this;return(0,d.Z)(function*(){if(xe.item.AddressInfo.Latitude&&xe.item.AddressInfo.Longitude){yield xe.presentLoadingUI(),xe.nearbySites=[];let Ie=new V.b;Ie.latitude=xe.item.AddressInfo.Latitude,Ie.longitude=xe.item.AddressInfo.Longitude,Ie.distance=5,Ie.distanceUnit="km",Ie.maxResults=10;let Ut=yield xe.poiManager.fetchPOIList(Ie);return Ut.sort((nn,ni)=>nn.Distance-ni.Distance),xe.nearbySites=Ut,xe.dismissLoadingUI(),Ut.length}return 0})()}confirmNonDuplicate(){this.isNonDuplicateConfirmed=!0,this.next()}changeTemplatePOI(){this.selectedTemplatePOI=null}editPOI(xe){this.editExistingPOI(xe.ID)}editExistingPOI(xe){var Ie=this;return(0,d.Z)(function*(){Ie.skipPOICopy=!0,Ie.isNonDuplicateConfirmed=!0,yield Ie.presentLoadingUI(),Ie.poiManager.getPOIById(xe,!0,!0).then(Ut=>{Ie.item=Object.assign({},Ut),null==Ie.item.OperatorID&&(Ie.item.OperatorID=Je.UnknownOperator),Ie.refreshFilteredReferenceData(),Ie.dismissLoadingUI()})})()}useTemplatePOI(xe){this.selectedTemplatePOI=xe,Object.assign(this.item.Connections,xe.Connections);for(let Ie of this.item.Connections)Ie.ID=-a.c.getRandomInt(1e4),Ie.Reference=null,Ie.Comments=null,Ie.StatusTypeID=xt.Operational;this.item.UsageCost=xe.UsageCost,this.item.UsageTypeID=xe.UsageTypeID,this.appManager.referenceDataManager.hydrateCompactPOI(this.item)}skipCopyingPOI(){this.skipPOICopy=!0}}return Be.\u0275fac=function(xe){return new(xe||Be)(p.Y36(c.c),p.Y36(me.IN),p.Y36(O.R),p.Y36(A.v),p.Y36(me.HT),p.Y36(me.Br))},Be.\u0275cmp=p.Xpm({type:Be,selectors:[["app-poi-editor"]],viewQuery:function(xe,Ie){if(1&xe&&p.Gf(je,5),2&xe){let Ut;p.iGM(Ut=p.CRH())&&(Ie.editorMap=Ut.first)}},decls:33,vars:14,consts:[["slot","end"],[3,"click"],["name","close","slot","start"],[1,"ion-padding"],[3,"ngModel"],["value","location","layout","icon-start",3,"disabled"],["name","caret-forward",4,"ngIf"],["value","equipment","layout","icon-start",3,"disabled"],["value","info","layout","icon-start",3,"disabled"],[4,"ngIf"],["slot","start"],[3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],["name","caret-forward"],[3,"latitude","longitude","latitudeChange","longitudeChange","onUseSuggestedAddress"],["editorMap",""],["position","floating"],["type","text","autocapitalize","words","placeholder","A title for this location",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","The nearest street address",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Town or City",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional Postal Code",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["type","number","placeholder","Latitude (if entering manually)",3,"ngModel","ngModelChange"],["type","number","placeholder","Longitude (if entering manually)",3,"ngModel","ngModelChange"],[3,"value"],[1,"instruction"],[3,"poiList","enableEditOption","onEdit"],[3,"operatorId","operatorChanged"],["slot","start","size","small",3,"click"],[3,"enableCopyOption","poiList","onCopy"],[3,"operatorId","useFilteredOperators","operatorChanged"],["size","small",3,"click"],["name","add","slot","icon-only"],[3,"item","enableEdit","onEdit","onDelete"],["color","warning",4,"ngIf"],[3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences",3,"ngModel","ngModelChange"],["type","tel","placeholder","",3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences","placeholder","Instructions for access or tips for finding charging location",3,"ngModel","ngModelChange"],["type","url","placeholder","Website related to this site",3,"ngModel","ngModelChange"],["color","warning"],["color","danger"],["name","caret-back","slot","start"],["name","caret-forward","slot","end"],["color","success",3,"click"],["name","send","slot","end"]],template:function(xe,Ie){1&xe&&(p.TgZ(0,"ion-header"),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-title"),p._uU(3),p.qZA(),p.TgZ(4,"ion-buttons",0),p.TgZ(5,"ion-button",1),p.NdJ("click",function(){return Ie.cancel()}),p._UZ(6,"ion-icon",2),p._uU(7," Cancel "),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(8,"ion-content",3),p.ynx(9),p.TgZ(10,"ion-segment",4),p.TgZ(11,"ion-segment-button",5),p.YNc(12,an,1,0,"ion-icon",6),p.TgZ(13,"ion-label"),p._uU(14,"Location"),p.qZA(),p.qZA(),p.TgZ(15,"ion-segment-button",7),p.YNc(16,Jn,1,0,"ion-icon",6),p.TgZ(17,"ion-label"),p._uU(18,"Equipment"),p.qZA(),p.qZA(),p.TgZ(19,"ion-segment-button",8),p.YNc(20,si,1,0,"ion-icon",6),p.TgZ(21,"ion-label"),p._uU(22,"Info"),p.qZA(),p.qZA(),p.qZA(),p.YNc(23,Et,3,2,"ng-container",9),p.YNc(24,Ri,3,2,"ng-container",9),p.YNc(25,Qt,38,11,"ng-container",9),p.BQk(),p.qZA(),p.TgZ(26,"ion-footer"),p.TgZ(27,"ion-toolbar"),p.TgZ(28,"ion-buttons",10),p.YNc(29,et,3,0,"ion-button",11),p.qZA(),p.TgZ(30,"ion-buttons",0),p.YNc(31,de,3,0,"ion-button",11),p.YNc(32,Pe,3,0,"ion-button",12),p.qZA(),p.qZA(),p.qZA()),2&xe&&(p.xp6(3),p.Oqu(Ie.isAddMode?"Add Location":"Edit Location"),p.xp6(7),p.Q6J("ngModel",Ie.selectedTab),p.xp6(1),p.Q6J("disabled",!0),p.xp6(1),p.Q6J("ngIf","location"==Ie.selectedTab),p.xp6(3),p.Q6J("disabled",!0),p.xp6(1),p.Q6J("ngIf","equipment"==Ie.selectedTab),p.xp6(3),p.Q6J("disabled",!0),p.xp6(1),p.Q6J("ngIf","info"==Ie.selectedTab),p.xp6(3),p.Q6J("ngIf","location"==Ie.selectedTab),p.xp6(1),p.Q6J("ngIf","equipment"==Ie.selectedTab),p.xp6(1),p.Q6J("ngIf","info"==Ie.selectedTab),p.xp6(4),p.Q6J("ngIf","location"!=Ie.step),p.xp6(2),p.Q6J("ngIf",!Ie.isReadyToSubmit&&"info"!=Ie.step),p.xp6(1),p.Q6J("ngIf",Ie.isReadyToSubmit))},directives:[me.Gu,me.sr,me.wd,me.Sm,me.YG,me.gu,me.W2,me.cJ,me.QI,Ae.JJ,Ae.On,me.GO,ye.O5,me.Q$,je,me.q_,me.Ie,me.pK,me.j9,me.t9,ye.sg,me.n0,me.as,Tt.o,Gt,Jt.B,me.fr],styles:['ul.breadcrumb[_ngcontent-%COMP%]{display:inline-flex;margin:0;padding:0}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;margin-right:6px;color:var(--ion-color-light-shade);font-size:10px}ul.breadcrumb[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:var(--ion-color-dark-shade)}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:">";padding-right:4px}']}),Be})()},6763:(_n,Ke,k)=>{"use strict";k.d(Ke,{u:()=>xt});var d=k(6738),c=k(9064),V=k(4120),a=k(3912),O=k(7689),A=k(129),p=k(529);let L=(()=>{class Je{constructor(wt,Tt){this.http=wt,this.journeyManager=Tt}getDirections(wt,Tt){return new Promise((Ct,gt)=>{(new google.maps.DirectionsService).route({origin:wt,destination:Tt,travelMode:google.maps.TravelMode.DRIVING},(Ht,Vn)=>{Vn===google.maps.DirectionsStatus.OK?Ct(Ht):gt(Vn)})})}analyseRoutes(wt,Tt){const Ct=new Array;return wt.routes.forEach(gt=>{const Lt=new A.JJ;Lt.Title=""+Ct.length+1,Lt.JourneyRouteLegs=new Array,Lt.TotalDistanceKM=0,Lt.TotalDurationMinutes=0,Lt.TotalEnergykWh=0,gt.legs.forEach(Ht=>{const Vn=Ht.duration.value,Ft=Ht.distance.value/1e3,Wt=this.journeyManager.calculateEnergyConsumptionkWh(Ft,0,null,Tt),Gt=new A.eN;Gt.DistanceKM=Ft,Gt.DurationMinutes=Vn/60,Gt.EnergyConsumptionkWh=Wt,Lt.JourneyRouteLegs.push(Gt),Lt.TotalDistanceKM+=Gt.DistanceKM,Lt.TotalDurationMinutes+=Gt.DurationMinutes,Lt.TotalEnergykWh=Gt.EnergyConsumptionkWh}),Ct.push(Lt)}),Ct}}return Je.\u0275fac=function(wt){return new(wt||Je)(d.LFG(p.eN),d.LFG(a.i))},Je.\u0275prov=d.Yz7({token:Je,factory:Je.\u0275fac,providedIn:"root"}),Je})();var Q=k(4781),Z=k(6895),z=k(4006),G=k(2428);function te(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-searchbar",13),d.NdJ("ngModelChange",function(Ct){return d.CHM(wt),d.oxw().routeStart=Ct})("ionInput",function(Ct){return d.CHM(wt),d.oxw(),d.MAs(18).getPlacesAutoComplete(Ct,"routeStart")})("ionCancel",function(Ct){return d.CHM(wt),d.oxw().onPlaceSearchCancel(Ct)}),d.qZA(),d.qZA()}if(2&Je){const wt=d.oxw();d.xp6(2),d.Q6J("ngModel",wt.routeStart)("debounce",500)}}function ye(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){return d.CHM(wt),d.oxw().clearRouteStart()}),d._UZ(1,"ion-icon",12),d.TgZ(2,"h2"),d._uU(3),d.qZA(),d.qZA()}if(2&Je){d.oxw();const wt=d.MAs(18);d.xp6(3),d.Oqu(null==wt.selectedPlace?null:wt.selectedPlace.name)}}function me(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",15),d.TgZ(2,"ion-searchbar",16),d.NdJ("ngModelChange",function(Ct){return d.CHM(wt),d.oxw().routeDestination=Ct})("ionInput",function(Ct){return d.CHM(wt),d.oxw(),d.MAs(20).getPlacesAutoComplete(Ct,"routeDestination")})("ionCancel",function(Ct){return d.CHM(wt),d.oxw().onPlaceSearchCancel(Ct)}),d.qZA(),d.qZA()}if(2&Je){const wt=d.oxw();d.xp6(2),d.Q6J("ngModel",wt.routeDestination)("debounce",500)}}function Ee(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){return d.CHM(wt),d.oxw().clearRouteDestination()}),d._UZ(1,"ion-icon",15),d.TgZ(2,"h2"),d._uU(3),d.qZA(),d.qZA()}if(2&Je){d.oxw();const wt=d.MAs(20);d.xp6(3),d.Oqu(null==wt.selectedPlace?null:wt.selectedPlace.name)}}function je(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){return d.CHM(wt),d.oxw().clearRoute()}),d._UZ(1,"ion-icon",17),d._uU(2," Clear Route "),d.qZA()}}function rt(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){return d.CHM(wt),d.oxw().showSettings()}),d._uU(1," Show Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function Ae(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){return d.CHM(wt),d.oxw().hideSettings()}),d._uU(1," Hide Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function Ze(Je,ct){1&Je&&(d.TgZ(0,"p",19),d._UZ(1,"ion-spinner",19),d._uU(2," Calculating Route.. "),d.qZA())}function Ve(Je,ct){if(1&Je&&(d.TgZ(0,"ion-list"),d.TgZ(1,"ion-list-header"),d._uU(2),d.ALo(3,"number"),d.ALo(4,"number"),d.qZA(),d.qZA()),2&Je){const wt=d.oxw();d.xp6(2),d.lnq(" Total Distance ",d.xi3(3,3,wt.selectedJourneyRoute.TotalDistanceKM,"1.0-2")," km, ",wt.formatDuration(wt.selectedJourneyRoute.TotalDurationMinutes),", ",d.xi3(4,6,wt.selectedJourneyRoute.TotalEnergykWh,"1.0-2")," kWh ")}}function He(Je,ct){if(1&Je){const wt=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"ion-list"),d.TgZ(2,"ion-list-header"),d._UZ(3,"ion-icon",20),d._uU(4," Route Settings "),d.qZA(),d.TgZ(5,"ion-item"),d.TgZ(6,"ion-label",21),d._uU(7),d.qZA(),d.TgZ(8,"ion-range",22),d.NdJ("ngModelChange",function(Ct){return d.CHM(wt),d.oxw().routeSearchDistance=Ct}),d._UZ(9,"ion-icon",23),d._UZ(10,"ion-icon",24),d.qZA(),d.qZA(),d.TgZ(11,"ion-item"),d.TgZ(12,"ion-label",21),d._uU(13,"Energy Efficiency (kWh Per km)"),d.qZA(),d.TgZ(14,"ion-input",25),d.NdJ("ngModelChange",function(Ct){return d.CHM(wt),d.oxw().kWhPerKM=Ct}),d.qZA(),d.qZA(),d.qZA(),d.qZA()}if(2&Je){const wt=d.oxw();d.xp6(7),d.hij("Search Distance (",wt.routeSearchDistance,")"),d.xp6(1),d.Q6J("ngModel",wt.routeSearchDistance),d.xp6(6),d.Q6J("ngModel",wt.kWhPerKM)}}let Ne=(()=>{class Je{constructor(wt,Tt,Ct,gt,Lt,Ht){this.mapping=wt,this.logging=Tt,this.directions=Ct,this.journeyManager=gt,this.changeDetector=Lt,this.numberPipe=Ht,this.routeSearchDistance=5,this.routeCalcInProgress=!1,this.advancedSettingsMode=!1,this.routeStart="",this.routeDestination="",this.kWhPerKM=.212}get isRouteSet(){return null!=this.routeStartPlace&&null!=this.routeDestinationPlace}showSettings(){this.advancedSettingsMode=!0}hideSettings(){this.advancedSettingsMode=!1}routeStartSelected(wt){this.routeStartPlace=wt,this.calculateRoute(),this.changeDetector.detectChanges()}routeDestinationSelected(wt){this.routeDestinationPlace=wt,this.calculateRoute(),this.changeDetector.detectChanges()}clearRouteStart(){this.routeStartPlace=null,this.changeDetector.detectChanges()}clearRouteDestination(){this.routeDestinationPlace=null,this.changeDetector.detectChanges()}clearRoute(){this.routeStartPlace=null,this.routeDestinationPlace=null,this.journeyManager.setRoutePolyline(null),this.mapping.clearPolyline()}formatDuration(wt){if(wt<=60)return this.numberPipe.transform(wt,"1.0-2")+" mins";{const Tt=Math.round(wt/60),Ct=Math.floor(wt-60*Tt);return Tt+" hours "+(Ct>0?Ct+" mins":"")}}calculateRoute(){null!=this.routeStartPlace&&null!=this.routeDestinationPlace&&(this.logging.log("Fetching route directions.."),this.routeCalcInProgress=!0,this.directions.getDirections(this.routeStartPlace.Location.latitude+","+this.routeStartPlace.Location.longitude,this.routeDestinationPlace.Location.latitude+","+this.routeDestinationPlace.Location.longitude).then(wt=>{if(null!=wt.routes&&wt.routes.length>0){this.logging.log("Got route directions, analysing.."),this.routePolyline=wt.routes[0].overview_polyline;const Tt=wt.routes[0].bounds.getSouthWest(),Ct=wt.routes[0].bounds.getNorthEast(),gt=new V.wC(Ct.lat(),Ct.lng()),Lt=new V.wC(Tt.lat(),Tt.lng()),Ht=new V.LL(gt,Lt);this.journeyRoutes=this.directions.analyseRoutes(wt,this.kWhPerKM),this.journeyRoutes.length>0&&(this.selectedJourneyRoute=this.journeyRoutes[0]),this.journeyManager.setRoutePolyline(this.routePolyline),this.mapping.renderPolyline(this.routePolyline),this.mapping.moveToMapBounds(Ht)}else this.logging.log("No route returned..");this.routeCalcInProgress=!1}))}}return Je.\u0275fac=function(wt){return new(wt||Je)(d.Y36(Q.v),d.Y36(O.z),d.Y36(L),d.Y36(a.i),d.Y36(d.sBO),d.Y36(Z.JJ))},Je.\u0275cmp=d.Xpm({type:Je,selectors:[["route-planner"]],decls:24,vars:10,consts:[[1,"route"],[1,"route-places"],["name","map","slot","start"],[4,"ngIf"],[3,"click",4,"ngIf"],["primary",""],["slot","secondary"],["slot","primary"],[3,"placeChanged"],["placeSearchRouteStart",""],["placeSearchRouteDestination",""],["class","ion-padding",4,"ngIf"],["name","ionic","item-left",""],["placeholder","Starting Point",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],[3,"click"],["name","pin","item-left",""],["placeholder","Destination",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],["name","close","slot","start"],["name","cog","slot","end"],[1,"ion-padding"],["name","cog"],["position","stacked"],["min","1","max","200","step","5","snaps","true","pin","true","light","",3,"ngModel","ngModelChange"],["slot","start","small","","name","map"],["slot","end","large","","name","map"],["type","number","min","0.1","max","1",3,"ngModel","ngModelChange"]],template:function(wt,Tt){1&wt&&(d.TgZ(0,"div",0),d.TgZ(1,"div",1),d.TgZ(2,"ion-list"),d.TgZ(3,"ion-list-header"),d._UZ(4,"ion-icon",2),d.TgZ(5,"ion-label"),d._uU(6,"Plan Your Journey"),d.qZA(),d.qZA(),d.YNc(7,te,3,2,"ion-item",3),d.YNc(8,ye,4,1,"ion-item",4),d.YNc(9,me,3,2,"ion-item",3),d.YNc(10,Ee,4,1,"ion-item",4),d.qZA(),d.TgZ(11,"ion-toolbar",5),d.TgZ(12,"ion-buttons",6),d.YNc(13,je,3,0,"ion-button",4),d.qZA(),d.TgZ(14,"ion-buttons",7),d.YNc(15,rt,3,0,"ion-button",4),d.YNc(16,Ae,3,0,"ion-button",4),d.qZA(),d.qZA(),d.qZA(),d.TgZ(17,"place-search",8,9),d.NdJ("placeChanged",function(gt){return Tt.routeStartSelected(gt)}),d.qZA(),d.TgZ(19,"place-search",8,10),d.NdJ("placeChanged",function(gt){return Tt.routeDestinationSelected(gt)}),d.qZA(),d.YNc(21,Ze,3,0,"p",11),d.YNc(22,Ve,5,9,"ion-list",3),d.YNc(23,He,15,3,"div",3),d.qZA()),2&wt&&(d.xp6(7),d.Q6J("ngIf",null==Tt.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null!=Tt.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null==Tt.routeDestinationPlace),d.xp6(1),d.Q6J("ngIf",null!=Tt.routeDestinationPlace),d.xp6(3),d.Q6J("ngIf",Tt.isRouteSet),d.xp6(2),d.Q6J("ngIf",!Tt.advancedSettingsMode),d.xp6(1),d.Q6J("ngIf",Tt.advancedSettingsMode),d.xp6(5),d.Q6J("ngIf",Tt.routeCalcInProgress),d.xp6(1),d.Q6J("ngIf",null!=Tt.selectedJourneyRoute),d.xp6(1),d.Q6J("ngIf",Tt.advancedSettingsMode))},directives:[c.q_,c.yh,c.gu,c.Q$,Z.O5,c.Ie,c.VI,c.j9,z.JJ,z.On,c.sr,c.Sm,c.YG,G.v,c.PQ,c.I_,c.QI,c.pK,c.as],pipes:[Z.JJ],encapsulation:2}),Je})(),xt=(()=>{class Je{constructor(wt){this.modalController=wt,this.hasNavbar=!1}close(){this.modalController.dismiss()}}return Je.\u0275fac=function(wt){return new(wt||Je)(d.Y36(c.IN))},Je.\u0275cmp=d.Xpm({type:Je,selectors:[["ng-component"]],decls:10,vars:0,consts:[["slot","end"],[3,"click"],["name","close","slot","end"],[1,"route-planner","ion-padding"]],template:function(wt,Tt){1&wt&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3," Route Planner "),d.qZA(),d.TgZ(4,"ion-buttons",0),d.TgZ(5,"ion-button",1),d.NdJ("click",function(){return Tt.close()}),d._UZ(6,"ion-icon",2),d._uU(7," Close "),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(8,"ion-content",3),d._UZ(9,"route-planner"),d.qZA())},directives:[c.Gu,c.sr,c.wd,c.Sm,c.YG,c.gu,c.W2,Ne],encapsulation:2}),Je})()},9671:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{SearchPageModule:()=>di});var d=k(8936),c=k(9397),V=k(6895),a=k(4006),O=k(9064),A=k(3334),p=k(6099),L=k(2340),Q=k(2951),Z=k(6314),z=k(6763),G=k(3399),te=k(4120),ye=k(2206),me=k(6579),Ee=k(7689),je=k(3912),rt=k(4781),Ae=k(9698),Ze=k(3855),Ve=k(2428),He=k(3753),Ne=k(3489),xt=k(6686);const wt=new(k(2268).v)(xt.o);class Ct{constructor(ln,Et){this.dueTime=ln,this.scheduler=Et}call(ln,Et){return Et.subscribe(new gt(ln,this.dueTime,this.scheduler))}}class gt extends Ne.L{constructor(ln,Et,Kt){super(ln),this.dueTime=Et,this.scheduler=Kt,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(ln){this.clearDebounce(),this.lastValue=ln,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(Lt,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:ln}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(ln)}}clearDebounce(){const ln=this.debouncedSubscription;null!==ln&&(this.remove(ln),ln.unsubscribe(),this.debouncedSubscription=null)}}function Lt(Bn){Bn.debouncedNext()}const Vn=(0,k(7423).fo)("Geolocation",{web:()=>k.e(4561).then(k.bind(k,4561)).then(Bn=>new Bn.GeolocationWeb)});var Ft=k(6738),Wt=k(6260);function Gt(Bn,ln){1&Bn&&Ft._UZ(0,"ion-icon",13)}function Jt(Bn,ln){1&Bn&&Ft._UZ(0,"ion-spinner")}function an(Bn,ln){if(1&Bn){const Et=Ft.EpF();Ft.TgZ(0,"ion-button",3),Ft.NdJ("click",function(){return Ft.CHM(Et),Ft.oxw().openSideView()}),Ft._UZ(1,"ion-icon",14),Ft.qZA()}}function Jn(Bn,ln){1&Bn&&(Ft.ynx(0),Ft.TgZ(1,"div",15),Ft.TgZ(2,"p"),Ft._uU(3,"There was a problem communicating with Open Charge Map. Please check your data connection."),Ft.qZA(),Ft.qZA(),Ft.BQk())}let si=(()=>{class Bn{constructor(Et,Kt,Hn,In,ti,mi,ir,_r,er,Ri,mr,Si){this.appManager=Et,this.nav=Kt,this.events=Hn,this.translate=In,this.platform=ti,this.poiManager=mi,this.mapping=ir,this.journeyManager=_r,this.zone=er,this.modalController=Ri,this.alertController=mr,this.logging=Si,this.mapDisplayed=!1,this.initialResultsShown=!1,this.searchOnDemand=!1,this.poiViewMode="modal",this.sideViewAvailable=!1,this.routePlanningMode=!0,this.searchKeyword="",this.appConfig=new Q.X,this.defaultMapZoom=15,this.defaultStartPos=new te.wC(37.415328,-122.076575),this._watchId=null,this.mapCanvasID="map-canvas",this.mapping.setMapType(Et.searchSettings.MapType),this.mapping.setMapAPI(L.N.defaultMapProvider),(0,He.R)(window,"resize").pipe(function Tt(Bn,ln=wt){return Et=>Et.lift(new Ct(Bn,ln))}(500)).subscribe(Qt=>{let et={width:me.c.getClientHeight(),height:me.c.getClientWidth()};this.events.publish("ocm:window:resized",[et])})}ionViewDidEnter(){this.logging.log("Entered search page.",Ee.i.VERBOSE),this.mapping.focusMap(),this.mapping.updateMapSize()}ionViewWillLeave(){this.logging.log("Leaving search page.",Ee.i.VERBOSE),this.mapping.unfocusMap()}getPreferredMapHeight(Et){return null==Et&&(Et=me.c.getClientHeight()),Et-56}enforceMapHeight(Et){this.logging.log("Would resize map:"+Et.width+" "+Et.height,Ee.i.VERBOSE),this.checkViewportMode();const Kt=this.getPreferredMapHeight(Et[0]);document.getElementById(this.mapCanvasID).offsetHeight!==Kt&&(document.getElementById(this.mapCanvasID).style.height=Kt+"px"),this.mapping&&(this.logging.log("Map height:"+Kt,Ee.i.VERBOSE),this.mapping.updateMapSize())}checkViewportMode(){}initialiseMapping(){var Et=this;return(0,p.Z)(function*(){yield Et.platform.ready(),Et.debouncedRefreshMapResults=me.c.debounce(Et.refreshMapResults,1e3,!1),Et.events.subscribe("ocm:mapping:ready",(0,p.Z)(function*(){if(Et.logging.log("init map: mapping ready"),Et.mapping&&Et.mapping.updateMapSize(),!Et.initialResultsShown)if(Et.appManager.searchSettings.StartSearchPosition)Et.searchOnDemand=!0,Et.mapping.updateMapCentrePos(Et.appManager.searchSettings.StartSearchPosition.latitude,Et.appManager.searchSettings.StartSearchPosition.longitude,!0,Et.defaultMapZoom);else{let Kt=localStorage.getItem("_locationEnabled");1==Et.appManager.isEmbeddedMode&&"true"!=Kt?yield(yield Et.alertController.create({header:"Search using your location?",message:"Select OK to continue.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:(In=(0,p.Z)(function*(ti){yield Et.useFallbackPosition()}),function(mi){return In.apply(this,arguments)})},{text:"OK",handler:function(){var In=(0,p.Z)(function*(){yield Et.locateUser()});return function(){return In.apply(this,arguments)}}()}]})).present():(yield Et.locateUser(),Et.mapping&&Et.mapping.updateMapSize())}var In})),Et.events.subscribe("ocm:mapping:zoom",()=>{Et.debouncedRefreshMapResults()}),Et.events.subscribe("ocm:mapping:dragend",()=>{Et.debouncedRefreshMapResults()}),Et.events.subscribe("ocm:poiList:updated",Kt=>{Et.showPOIListOnMap(Kt)}),Et.events.subscribe("ocm:poiList:cleared",()=>{Et.mapping.clearMarkers(),setTimeout(()=>{Et.debouncedRefreshMapResults()},500)}),Et.events.subscribe("ocm:window:resized",Kt=>{null!=Kt&&Kt.length>0&&Et.enforceMapHeight(Kt[0])}),Et.events.subscribe("ocm:poi:selected",Kt=>{if(Kt.poi)Et.viewPOIDetails(Kt,Kt.poi);else{let Hn=Et.getPOIByID(Kt.poiId);Et.viewPOIDetails(Kt,Hn)}}),Et.checkViewportMode(),Et.mapping.initMap(Et.mapCanvasID)})()}ngAfterViewInit(){var Et=this;return(0,p.Z)(function*(){yield Et.initialiseMapping()})()}ngOnInit(){var Et=this;return(0,p.Z)(function*(){Et.logging.log("Refreshing reference data ..",Ee.i.VERBOSE),(yield Et.appManager.referenceDataManager.refreshReferenceData(Et.appManager.api))||(Et.appManager.isOffline=!0)})()}showPOIListOnMap(Et){const Kt=this.getPreferredMapHeight(null);this.mapping.refreshMapView(Kt,this.poiManager.poiList,null),this.mapDisplayed||(this.mapDisplayed=!0)}getIconForPOI(Et){return me.c.getIconForPOI(Et)}getPOIByID(Et){const Kt=this.poiManager.poiList;for(let Hn=0;Hn<Kt.length;Hn++)if(Kt[Hn].ID===Et)return Kt[Hn];return null}refreshMapResults(){var Et=this;return(0,p.Z)(function*(){if(!Et.searchOnDemand)return void Et.logging.log("Skipping refresh, search on demand disabled..",Ee.i.VERBOSE);Et.logging.log("Refreshing Results..",Ee.i.VERBOSE);const Kt=new ye.b;let Hn=null;if(Et.appManager.searchSettings.StartSearchPosition&&(Hn=new te.jR(Et.appManager.searchSettings.StartSearchPosition.latitude,Et.appManager.searchSettings.StartSearchPosition.longitude),Et.appManager.searchSettings.StartSearchPosition=null),Hn&&0==Hn.coords.latitude&&0==Hn.coords.longitude)return void Et.logging.log("Map center is zero. No query will be performed",Ee.i.WARNING);if(null!=Hn)Kt.latitude=Hn.coords.latitude,Kt.longitude=Hn.coords.longitude,Kt.distance=25,Kt.boundingbox=null,Et.appManager.searchSettings.LastSearchPosition=new te.wC(Hn.coords.latitude,Hn.coords.longitude);else{Kt.latitude=null,Kt.longitude=null;let ti=yield Et.mapping.getMapBounds().toPromise();Kt.boundingbox="("+ti[0].latitude+","+ti[0].longitude+"),("+ti[1].latitude+","+ti[1].longitude+")",Et.logging.log(JSON.stringify(ti),Ee.i.VERBOSE)}Kt.includeComments=!0,Kt.enableCaching=!0,null!=Et.appManager.searchSettings&&(null!=Et.appManager.searchSettings.ConnectionTypeList&&(Kt.connectionTypeIdList=Et.appManager.searchSettings.ConnectionTypeList),null!=Et.appManager.searchSettings.UsageTypeList&&(Kt.usageTypeIdList=Et.appManager.searchSettings.UsageTypeList),null!=Et.appManager.searchSettings.StatusTypeList&&(Kt.statusTypeIdList=Et.appManager.searchSettings.StatusTypeList),null!=Et.appManager.searchSettings.OperatorList&&(Kt.operatorIdList=Et.appManager.searchSettings.OperatorList),null!=Et.appManager.searchSettings.MinPowerKW&&Et.appManager.searchSettings.MinPowerKW>0&&(Kt.minPowerKW=Et.appManager.searchSettings.MinPowerKW),null!=Et.appManager.searchSettings.MaxPowerKW&&Et.appManager.searchSettings.MaxPowerKW>0&&(Kt.maxPowerKW=Et.appManager.searchSettings.MaxPowerKW),null!=Et.journeyManager.getRoutePolyline()&&(Kt.polyline=Et.journeyManager.getRoutePolyline(),Kt.boundingbox=null,Kt.levelOfDetail=null,Kt.latitude=null,Kt.longitude=null)),Et.appManager.isRequestInProgress=!0;let In=yield Et.poiManager.refreshPOIList(Kt);Et.appManager.isRequestInProgress=!1,Et.initialResultsShown=!0,In>=Kt.maxResults&&Et.appManager.showToastNotification("A maximum of "+In+" results are returned per search. Zoom in for details.")})()}viewPOIDetails(Et,Kt){this.logging.log("Viewing/fetching ["+this.poiViewMode+"] POI Details "+Et.poiId),null!=Kt?(this.mapping.unfocusMap(),this.modalController.create({component:G.H,componentProps:{item:Kt}}).then(Hn=>{Hn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),Hn.present()})):this.poiManager.getPOIById(Et.poiId,!0).then(Hn=>{this.logging.log("Got POI Details "+Hn.ID),"modal"===this.poiViewMode&&(this.searchOnDemand=!1,this.modalController.create({component:G.H,componentProps:{item:Hn}}).then(In=>{In.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),In.present()}),this.mapping.unfocusMap()),"side"===this.poiViewMode&&(this.selectedPOI=Hn)},Hn=>{this.appManager.showToastNotification("POI Details not available")})}closePOIDetails(){this.selectedPOI=null}openRoutePlannerModal(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:z.u}).then(Et=>{Et.onDidDismiss().then(Kt=>{this.logging.log("Dismissing Route Planner Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),Et.present()})}openSearchOptions(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:Z.N}).then(Et=>{Et.onDidDismiss().then(Kt=>{this.mapping.focusMap(),this.searchOnDemand=!0}),Et.present()})}openSideView(){this.poiViewMode="side",this.mapping.updateMapSize()}closeSideView(){this.poiViewMode="modal",this.mapping.updateMapSize()}planRoute(){this.routePlanningMode=!0}search(Et){this.placeSearchMapPOI.getPlacesAutoComplete(Et,"poiSearch")}useFallbackPosition(){let Et=this.defaultStartPos;null!=this.appManager.searchSettings.LastSearchPosition&&(Et=this.appManager.searchSettings.LastSearchPosition),this.appManager.searchSettings.StartSearchPosition=Et,this.appManager.searchSettings.LastSearchPosition=null,this.searchOnDemand=!0,this.mapping.updateMapCentrePos(Et.latitude,Et.longitude,!0,this.defaultMapZoom)}getPosition(Et={}){var Kt=this;return(0,p.Z)(function*(){return new Promise((Hn,In)=>{Kt._watchId=Vn.watchPosition(Et,(ti,mi)=>{Vn.clearWatch({id:Kt._watchId}),mi?In(mi):Hn(ti)})})})()}locateUser(){var Et=this;return(0,p.Z)(function*(){Et.useFallbackPosition();try{Et.logging.log("Attempting to locate user..");const Kt=yield Et.getPosition({timeout:1e4});if(!Kt)throw"Failed to get user location.";return Et.logging.log("Got user location."),Et.appManager.searchSettings.StartSearchPosition=new te.wC(Kt.coords.latitude,Kt.coords.longitude),Et.searchOnDemand=!0,Et.mapping.updateMapCentrePos(Kt.coords.latitude,Kt.coords.longitude,!0,Et.defaultMapZoom),localStorage.setItem("_locationEnabled","true"),!0}catch(Kt){return Et.logging.log("Failed to get user location. Searching using default or last position."+Kt),Et.appManager.showToastNotification("Your location could not be determined."),Et.useFallbackPosition(),!1}})()}placeSelected(Et){this.searchKeyword=Et.Address,this.logging.log("Got place details:"+Et.Address),this.mapping.focusMap(),this.mapping.updateMapCentrePos(Et.Location.latitude,Et.Location.longitude,!0),this.debouncedRefreshMapResults()}}return Bn.\u0275fac=function(Et){return new(Et||Bn)(Ft.Y36(Ze.c),Ft.Y36(O.SH),Ft.Y36(Wt.z),Ft.Y36(c.sK),Ft.Y36(O.t4),Ft.Y36(Ae.R),Ft.Y36(rt.v),Ft.Y36(je.i),Ft.Y36(Ft.R0b),Ft.Y36(O.IN),Ft.Y36(O.Br),Ft.Y36(Ee.z))},Bn.\u0275cmp=Ft.Xpm({type:Bn,selectors:[["ng-component"]],viewQuery:function(Et,Kt){if(1&Et&&Ft.Gf(Ve.v,7),2&Et){let Hn;Ft.iGM(Hn=Ft.CRH())&&(Kt.placeSearchMapPOI=Hn.first)}},decls:18,vars:10,consts:[["slot","start"],["autocapitalize","on","autocomplete","on",3,"ngModel","placeholder","debounce","ngModelChange","ionInput"],["slot","end"],[3,"click"],["name","locate","slot","start",4,"ngIf"],[4,"ngIf"],[3,"color","click"],["name","options","slot","end"],[3,"click",4,"ngIf"],[1,"search-page"],[3,"placeChanged"],["placeSearchMapPOI",""],["id","map-canvas",2,"height","100%","width","100%","min-height","300px"],["name","locate","slot","start"],["name","car","title","Route","slot","end"],[2,"position","absolute"]],template:function(Et,Kt){1&Et&&(Ft.TgZ(0,"ion-header"),Ft.TgZ(1,"ion-toolbar"),Ft.TgZ(2,"ion-buttons",0),Ft._UZ(3,"ion-menu-button"),Ft.qZA(),Ft.TgZ(4,"ion-searchbar",1),Ft.NdJ("ngModelChange",function(In){return Kt.searchKeyword=In})("ionInput",function(In){return Kt.search(In)}),Ft.ALo(5,"translate"),Ft.qZA(),Ft.TgZ(6,"ion-buttons",2),Ft.TgZ(7,"ion-button",3),Ft.NdJ("click",function(){return Kt.locateUser()}),Ft.YNc(8,Gt,1,0,"ion-icon",4),Ft.YNc(9,Jt,1,0,"ion-spinner",5),Ft.qZA(),Ft.TgZ(10,"ion-button",6),Ft.NdJ("click",function(){return Kt.openSearchOptions()}),Ft._UZ(11,"ion-icon",7),Ft.qZA(),Ft.YNc(12,an,2,0,"ion-button",8),Ft.qZA(),Ft.qZA(),Ft.qZA(),Ft.TgZ(13,"ion-content",9),Ft.TgZ(14,"place-search",10,11),Ft.NdJ("placeChanged",function(In){return Kt.placeSelected(In)}),Ft.qZA(),Ft.YNc(16,Jn,4,0,"ng-container",5),Ft._UZ(17,"div",12),Ft.qZA()),2&Et&&(Ft.xp6(4),Ft.Q6J("ngModel",Kt.searchKeyword)("placeholder",Ft.lcZ(5,8,"ocm.search.performSearch"))("debounce",500),Ft.xp6(4),Ft.Q6J("ngIf",!Kt.appManager.isRequestInProgress),Ft.xp6(1),Ft.Q6J("ngIf",Kt.appManager.isRequestInProgress),Ft.xp6(1),Ft.Q6J("color",Kt.appManager.searchSettings.HasActiveFilters?"danger":"default"),Ft.xp6(2),Ft.Q6J("ngIf",1==Kt.sideViewAvailable&&"modal"==Kt.poiViewMode),Ft.xp6(4),Ft.Q6J("ngIf",Kt.appManager.isOffline))},directives:[O.Gu,O.sr,O.Sm,O.fG,O.VI,O.j9,a.JJ,a.On,O.YG,V.O5,O.gu,O.PQ,O.W2,Ve.v],pipes:[c.X$],styles:[".search-page[_ngcontent-%COMP%]   #map-canvas[_ngcontent-%COMP%]{width:100%;height:98%}.search-page[_ngcontent-%COMP%]   #place-search[_ngcontent-%COMP%]{min-height:300px;background-color:#f0f0f0;position:absolute;z-index:100;width:100%}.search-page[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{flex:.4}.search-page[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0}.search-page[_ngcontent-%COMP%]   scroll-content[_ngcontent-%COMP%]{overflow-y:hidden}.search-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{padding-left:2em}.search-page[_ngcontent-%COMP%]   .sideview[_ngcontent-%COMP%]{background:#eeeeee;background:linear-gradient(to bottom,#eeeeee 0%,white 100%)}"]}),Bn})(),di=(()=>{class Bn{}return Bn.\u0275fac=function(Et){return new(Et||Bn)},Bn.\u0275mod=Ft.oAB({type:Bn}),Bn.\u0275inj=Ft.cJS({imports:[[V.ez,a.u5,O.Pc,c.aw,d.e,A.Bz.forChild([{path:"",component:si}])]]}),Bn})()},6314:(_n,Ke,k)=>{"use strict";k.d(Ke,{N:()=>He});var d=k(6099),c=k(9698),V=k(3855),a=k(7627),O=k(6579),A=k(4781),p=k(6738),L=k(9064),Q=k(6260),Z=k(6895),z=k(4006),G=k(9397);let te=(()=>{class Ne extends G.X${constructor(Je,ct){super(Je,ct)}transform(Je,...ct){let wt=super.transform(Je,...ct);return wt==Je?null!=ct&&ct[0].default?ct[0].default:ct[0].Title?ct[0].Title:wt:wt}}return Ne.\u0275fac=function(Je){return new(Je||Ne)(p.Y36(G.sK,16),p.Y36(p.sBO,16))},Ne.\u0275pipe=p.Yjl({name:"nullableTranslate",type:Ne,pure:!0}),Ne.\u0275prov=p.Yz7({token:Ne,factory:Ne.\u0275fac}),Ne})();function ye(Ne,xt){if(1&Ne){const Je=p.EpF();p.TgZ(0,"p",21),p._UZ(1,"ion-icon",22),p._uU(2," One or more filters are currently being applied. "),p.TgZ(3,"ion-button",23),p.NdJ("click",function(){return p.CHM(Je),p.oxw().clearFilters()}),p._UZ(4,"ion-icon",24),p.TgZ(5,"ion-label"),p._uU(6,"Clear"),p.qZA(),p.qZA(),p.qZA()}}function me(Ne,xt){if(1&Ne&&(p.TgZ(0,"ion-select-option",26),p._uU(1),p.qZA()),2&Ne){const Je=xt.$implicit;p.Q6J("value",Je.ID),p.xp6(1),p.Oqu(Je.Title)}}function Ee(Ne,xt){if(1&Ne){const Je=p.EpF();p.TgZ(0,"ion-item"),p.TgZ(1,"ion-label"),p._uU(2),p.ALo(3,"translate"),p.qZA(),p.TgZ(4,"ion-select",14),p.NdJ("ngModelChange",function(wt){return p.CHM(Je),p.oxw().searchSettings.FilterOptionsByCountryId=wt})("ionChange",function(){return p.CHM(Je),p.oxw().onCountryChange()}),p.TgZ(5,"ion-select",25),p._uU(6,"(All Countries)"),p.qZA(),p.YNc(7,me,2,2,"ion-select-option",4),p.qZA(),p.qZA()}if(2&Ne){const Je=p.oxw();p.xp6(2),p.Oqu(p.lcZ(3,3,"ocm.search.countries")),p.xp6(2),p.Q6J("ngModel",Je.searchSettings.FilterOptionsByCountryId),p.xp6(3),p.Q6J("ngForOf",Je.countries)}}function je(Ne,xt){if(1&Ne&&(p.TgZ(0,"ion-select-option",26),p._uU(1),p.ALo(2,"nullableTranslate"),p.qZA()),2&Ne){const Je=xt.$implicit;p.Q6J("value",Je.ID),p.xp6(1),p.Oqu(p.xi3(2,2,"ocm.reference.operatorInfo.value_"+Je.ID,Je))}}function rt(Ne,xt){if(1&Ne&&(p.TgZ(0,"ion-select-option",26),p._uU(1),p.ALo(2,"nullableTranslate"),p.qZA()),2&Ne){const Je=xt.$implicit;p.Q6J("value",Je.ID),p.xp6(1),p.Oqu(p.xi3(2,2,"ocm.reference.usageType.value_"+Je.ID,Je))}}function Ae(Ne,xt){if(1&Ne&&(p.TgZ(0,"ion-select-option",26),p._uU(1),p.ALo(2,"nullableTranslate"),p.qZA()),2&Ne){const Je=xt.$implicit;p.Q6J("value",Je.ID),p.xp6(1),p.Oqu(p.xi3(2,2,"ocm.reference.statusType.value_"+Je.ID,Je))}}function Ze(Ne,xt){if(1&Ne&&(p.TgZ(0,"ion-select-option",26),p._uU(1),p.ALo(2,"nullableTranslate"),p.qZA()),2&Ne){const Je=xt.$implicit;p.Q6J("value",Je.ID),p.xp6(1),p.Oqu(p.xi3(2,2,"ocm.reference.connectionType.value_"+Je.ID,Je))}}function Ve(Ne,xt){if(1&Ne&&(p.TgZ(0,"ion-select-option",26),p._uU(1),p.qZA()),2&Ne){const Je=xt.$implicit;p.Q6J("value",Je.code),p.xp6(1),p.Oqu(Je.title)}}let He=(()=>{class Ne{constructor(Je,ct,wt,Tt,Ct){this.appManager=Je,this.poiManager=ct,this.mapping=wt,this.modalController=Tt,this.events=Ct,this.maxPower=a.U,this.powerRange={lower:0,upper:this.maxPower},this._languages=[],this.searchSettings=Je.searchSettings}ngOnInit(){var Je=this;return(0,d.Z)(function*(){null!=Je.searchSettings.MinPowerKW&&(Je.powerRange.lower=Je.searchSettings.MinPowerKW),null!=Je.searchSettings.MaxPowerKW&&(Je.powerRange.upper=Je.searchSettings.MaxPowerKW),0==Je.powerRange.upper&&(Je.powerRange.upper=Je.maxPower),Je.appManager.analytics.viewEvent("Settings"),Je.useFilteredOptions&&(yield Je.onCountryChange())})()}get useFilteredOptions(){return this.searchSettings.FilterOptionsByCountryId>0}clearFilters(){this.searchSettings.ClearActiveFilters(),this.powerRange={lower:0,upper:this.maxPower},this.searchSettings.CheckForActiveFilters()}get operators(){return this.appManager.referenceDataManager.getNetworkOperators(this.useFilteredOptions)}get connectionTypes(){return this.appManager.referenceDataManager.getConnectionTypes(this.useFilteredOptions)}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes(this.useFilteredOptions)}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes(this.useFilteredOptions)}get countries(){return this.appManager.referenceDataManager.getCountries(this.useFilteredOptions)}get isCountryFilterFeatureEnabled(){return O.c.isFeatureEnabled("FILTER_OPTIONS_BY_COUNTRY")}get languages(){return this._languages.length>0||(this._languages=this.appManager.getLanguages()),this._languages}ionViewWillLeave(){null!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language),this.searchSettings.MinPowerKW=this.powerRange.lower,this.searchSettings.MaxPowerKW=this.powerRange.upper,1==this.searchSettings.MinPowerKW&&(this.searchSettings.MinPowerKW=null),this.searchSettings.MaxPowerKW==this.maxPower&&(this.searchSettings.MaxPowerKW=null),this.appManager.searchSettings=this.searchSettings,this.appManager.saveSearchSettings(),this.events.publish("ocm:poiList:cleared")}onLanguageChange(){null!=this.searchSettings.Language&&""!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language)}onCountryChange(){var Je=this;return(0,d.Z)(function*(){Je.appManager.referenceDataManager.refreshFilteredReferenceData(Je.appManager.api,{CountryIds:[Je.searchSettings.FilterOptionsByCountryId]})})()}onMapTypeChange(){var Je=this;return(0,d.Z)(function*(){Je.mapping.setMapType(Je.searchSettings.MapType)})()}close(){this.modalController.dismiss()}}return Ne.\u0275fac=function(Je){return new(Je||Ne)(p.Y36(V.c),p.Y36(c.R),p.Y36(A.v),p.Y36(L.IN),p.Y36(Q.z))},Ne.\u0275cmp=p.Xpm({type:Ne,selectors:[["ng-component"]],decls:77,vars:38,consts:[[1,"settings-page","ion-padding"],["danger","",4,"ngIf"],[4,"ngIf"],["multiple","true","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["lines","none"],["dualKnobs","true","min","0","max","650","pin","true",3,"ngModel","ngModelChange"],["slot","start","size","small","name","flash"],["slot","end","name","flash"],["slot","start",2,"padding-top","0"],["type","number","min","0",2,"width","3em","border","none",3,"ngModel","max","ngModelChange"],["slot","end",2,"padding-top","0"],["type","number",2,"width","3em","border","none",3,"ngModel","max","min","ngModelChange"],["multiple","false",3,"ngModel","ngModelChange","ionChange"],["multiple","false","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange","ionChange"],["value","ROADMAP"],["value","SATELLITE"],[3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","close","slot","start"],["danger",""],["name","alert"],["size","small","color","light",3,"click"],["slot","start","name","close"],["value",""],[3,"value"]],template:function(Je,ct){1&Je&&(p.TgZ(0,"ion-header"),p.TgZ(1,"ion-toolbar"),p.TgZ(2,"ion-title"),p._uU(3),p.ALo(4,"translate"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(5,"ion-content",0),p.TgZ(6,"h2"),p._uU(7,"Search Filters"),p.qZA(),p.TgZ(8,"p"),p._uU(9,"Note: Filters will remove usable charging locations from your search results if we do not have complete data (i.e Operator or Power Levels)."),p.qZA(),p.YNc(10,ye,7,0,"p",1),p.TgZ(11,"ion-list"),p.YNc(12,Ee,8,5,"ion-item",2),p.TgZ(13,"ion-item"),p.TgZ(14,"ion-label"),p._uU(15),p.ALo(16,"translate"),p.qZA(),p.TgZ(17,"ion-select",3),p.NdJ("ngModelChange",function(Tt){return ct.searchSettings.OperatorList=Tt}),p.YNc(18,je,3,5,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(19,"ion-item"),p.TgZ(20,"ion-label"),p._uU(21),p.ALo(22,"translate"),p.qZA(),p.TgZ(23,"ion-select",3),p.NdJ("ngModelChange",function(Tt){return ct.searchSettings.UsageTypeList=Tt}),p.YNc(24,rt,3,5,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(25,"ion-item"),p.TgZ(26,"ion-label"),p._uU(27),p.ALo(28,"translate"),p.qZA(),p.TgZ(29,"ion-select",3),p.NdJ("ngModelChange",function(Tt){return ct.searchSettings.StatusTypeList=Tt}),p.YNc(30,Ae,3,5,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(31,"ion-item"),p.TgZ(32,"ion-label"),p._uU(33),p.ALo(34,"translate"),p.qZA(),p.TgZ(35,"ion-select",3),p.NdJ("ngModelChange",function(Tt){return ct.searchSettings.ConnectionTypeList=Tt}),p.YNc(36,Ze,3,5,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(37,"ion-item",5),p.TgZ(38,"ion-range",6),p.NdJ("ngModelChange",function(Tt){return ct.powerRange=Tt}),p.TgZ(39,"ion-icon",7),p._uU(40,"0"),p.qZA(),p._UZ(41,"ion-icon",8),p.qZA(),p.qZA(),p.TgZ(42,"ion-item",5),p.TgZ(43,"ion-note",9),p._uU(44,"Min. Power (kW)"),p._UZ(45,"br"),p.TgZ(46,"input",10),p.NdJ("ngModelChange",function(Tt){return ct.powerRange.lower=Tt}),p.qZA(),p.qZA(),p.TgZ(47,"ion-note",11),p._uU(48,"Max. Power (kW)"),p._UZ(49,"br"),p.TgZ(50,"input",12),p.NdJ("ngModelChange",function(Tt){return ct.powerRange.upper=Tt}),p.qZA(),p.qZA(),p.qZA(),p.qZA(),p.TgZ(51,"h2"),p._uU(52," General Settings "),p.qZA(),p.TgZ(53,"ion-item"),p.TgZ(54,"ion-label"),p._uU(55,"Language"),p.qZA(),p.TgZ(56,"ion-select",13),p.NdJ("ngModelChange",function(Tt){return ct.searchSettings.Language=Tt})("ionChange",function(){return ct.onLanguageChange()}),p.YNc(57,Ve,2,2,"ion-select-option",4),p.qZA(),p.qZA(),p.TgZ(58,"ion-item"),p.TgZ(59,"ion-label"),p._uU(60),p.ALo(61,"translate"),p.qZA(),p.TgZ(62,"ion-select",14),p.NdJ("ngModelChange",function(Tt){return ct.searchSettings.MapType=Tt})("ionChange",function(){return ct.onMapTypeChange()}),p.TgZ(63,"ion-select-option",15),p._uU(64,"Road Map"),p.qZA(),p.TgZ(65,"ion-select-option",16),p._uU(66,"Satellite"),p.qZA(),p.qZA(),p.qZA(),p.TgZ(67,"ion-item"),p.TgZ(68,"ion-label"),p._uU(69,"Enable Advanced Editor Options"),p.qZA(),p.TgZ(70,"ion-toggle",17),p.NdJ("ngModelChange",function(Tt){return ct.searchSettings.EnableAdvancedEditorFeatures=Tt}),p.qZA(),p.qZA(),p.qZA(),p.TgZ(71,"ion-footer"),p.TgZ(72,"ion-toolbar"),p.TgZ(73,"ion-buttons",18),p.TgZ(74,"ion-button",19),p.NdJ("click",function(){return ct.close()}),p._UZ(75,"ion-icon",20),p._uU(76," Close "),p.qZA(),p.qZA(),p.qZA(),p.qZA()),2&Je&&(p.xp6(3),p.hij(" ",p.lcZ(4,26,"ocm.general.settings")," "),p.xp6(7),p.Q6J("ngIf",1==ct.searchSettings.HasActiveFilters),p.xp6(2),p.Q6J("ngIf",ct.isCountryFilterFeatureEnabled),p.xp6(3),p.Oqu(p.lcZ(16,28,"ocm.search.networkOperators")),p.xp6(2),p.Q6J("ngModel",ct.searchSettings.OperatorList),p.xp6(1),p.Q6J("ngForOf",ct.operators),p.xp6(3),p.Oqu(p.lcZ(22,30,"ocm.search.usageTypes")),p.xp6(2),p.Q6J("ngModel",ct.searchSettings.UsageTypeList),p.xp6(1),p.Q6J("ngForOf",ct.usageTypes),p.xp6(3),p.Oqu(p.lcZ(28,32,"ocm.search.operationalStatusTypes")),p.xp6(2),p.Q6J("ngModel",ct.searchSettings.StatusTypeList),p.xp6(1),p.Q6J("ngForOf",ct.statusTypes),p.xp6(3),p.Oqu(p.lcZ(34,34,"ocm.search.connectionTypes")),p.xp6(2),p.Q6J("ngModel",ct.searchSettings.ConnectionTypeList),p.xp6(1),p.Q6J("ngForOf",ct.connectionTypes),p.xp6(2),p.Q6J("ngModel",ct.powerRange),p.xp6(8),p.Q6J("ngModel",ct.powerRange.lower)("max",ct.powerRange.upper),p.xp6(4),p.Q6J("ngModel",ct.powerRange.upper)("max",ct.maxPower)("min",ct.powerRange.lower),p.xp6(6),p.Q6J("ngModel",ct.searchSettings.Language),p.xp6(1),p.Q6J("ngForOf",ct.languages),p.xp6(3),p.Oqu(p.lcZ(61,36,"ocm.details.location.map")),p.xp6(2),p.Q6J("ngModel",ct.searchSettings.MapType),p.xp6(8),p.Q6J("ngModel",ct.searchSettings.EnableAdvancedEditorFeatures))},directives:[L.Gu,L.sr,L.wd,L.W2,Z.O5,L.gu,L.YG,L.Q$,L.q_,L.Ie,L.t9,L.QI,z.JJ,z.On,Z.sg,L.n0,L.I_,L.uN,z.qQ,z.wV,z.Fd,z.Fj,L.ho,L.w,L.fr,L.Sm],pipes:[G.X$,te],encapsulation:2}),Ne})()},6779:(_n,Ke,k)=>{"use strict";k.r(Ke),k.d(Ke,{SignInModule:()=>Q});var d=k(9492),c=k(8936),V=k(9397),a=k(6895),O=k(4006),A=k(9064),p=k(3334),L=k(6738);let Q=(()=>{class Z{}return Z.\u0275fac=function(G){return new(G||Z)},Z.\u0275mod=L.oAB({type:Z}),Z.\u0275inj=L.cJS({imports:[[a.ez,O.u5,A.Pc,V.aw,c.e,p.Bz.forChild([{path:"",component:d.F}])]]}),Z})()},9492:(_n,Ke,k)=>{"use strict";k.d(Ke,{F:()=>Z});var d=k(6099),c=k(7689),V=k(3855),a=k(6738),O=k(9064),A=k(9397),p=k(3334),L=k(6895),Q=k(4006);let Z=(()=>{class z{constructor(te,ye,me,Ee,je,rt,Ae,Ze){this.appManager=te,this.modalController=ye,this.translate=me,this.alertController=Ee,this.loadingController=je,this.logging=rt,this.router=Ae,this.location=Ze,this.email=""}cancelSignIn(){this.modalController.dismiss()}performSignIn(){var te=this;return(0,d.Z)(function*(){const ye=yield te.loadingController.create({message:"Signing In.."});yield ye.present();let me=!1;try{yield te.appManager.api.performSignIn(te.email,te.password),ye.dismiss(),localStorage.setItem("authResponse",JSON.stringify(te.appManager.api.authResponse)),te.appManager.isUserAuthenticated(!0),te.modalController.dismiss(),te.appManager.analytics.appEvent("Profile","SignedIn")}catch(Ee){me=!0,ye.dismiss(),yield(yield te.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),te.logging.log("Error logging in:"+Ee)}})()}}return z.\u0275fac=function(te){return new(te||z)(a.Y36(V.c),a.Y36(O.IN),a.Y36(A.sK),a.Y36(O.Br),a.Y36(O.HT),a.Y36(c.z),a.Y36(p.F0),a.Y36(L.Ye))},z.\u0275cmp=a.Xpm({type:z,selectors:[["ng-component"]],decls:37,vars:8,consts:[[1,"signin-page","ion-padding"],["item-left",""],["src","assets/images/icons/branding/AppIcon_128x128.png"],[1,"ion-padding"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"],[3,"click"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["type","submit","color","primary",3,"click"],["name","log-in","slot","start"]],template:function(te,ye){1&te&&(a.TgZ(0,"ion-header"),a.TgZ(1,"ion-toolbar"),a.TgZ(2,"ion-title"),a._uU(3),a.ALo(4,"translate"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(5,"ion-content",0),a.TgZ(6,"ion-avatar",1),a._UZ(7,"img",2),a.qZA(),a.TgZ(8,"p",3),a._uU(9," Sign in using your Open Charge Map account. "),a.qZA(),a.TgZ(10,"ion-list"),a.TgZ(11,"ion-item"),a.TgZ(12,"ion-label",4),a._uU(13,"Email"),a.qZA(),a.TgZ(14,"ion-input",5),a.NdJ("ngModelChange",function(Ee){return ye.email=Ee}),a.qZA(),a.qZA(),a.TgZ(15,"ion-item"),a.TgZ(16,"ion-label",4),a._uU(17,"Password"),a.qZA(),a.TgZ(18,"ion-input",6),a.NdJ("ngModelChange",function(Ee){return ye.password=Ee}),a.qZA(),a.qZA(),a.qZA(),a.TgZ(19,"p"),a._uU(20,"or "),a.TgZ(21,"a",7),a.NdJ("click",function(){return ye.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/register")}),a._uU(22,"Register as New User"),a.qZA(),a._uU(23," or "),a.TgZ(24,"a",7),a.NdJ("click",function(){return ye.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/passwordreset")}),a._uU(25,"Reset your password"),a.qZA(),a.qZA(),a.qZA(),a.TgZ(26,"ion-footer"),a.TgZ(27,"ion-toolbar"),a.TgZ(28,"ion-buttons",8),a.TgZ(29,"ion-button",7),a.NdJ("click",function(){return ye.cancelSignIn()}),a._UZ(30,"ion-icon",9),a._uU(31," Cancel"),a.qZA(),a.qZA(),a.TgZ(32,"ion-buttons",10),a.TgZ(33,"ion-button",11),a.NdJ("click",function(){return ye.performSignIn()}),a._UZ(34,"ion-icon",12),a._uU(35),a.ALo(36,"translate"),a.qZA(),a.qZA(),a.qZA(),a.qZA()),2&te&&(a.xp6(3),a.hij(" ",a.lcZ(4,4,"ocm.general.signIn")," "),a.xp6(11),a.Q6J("ngModel",ye.email),a.xp6(4),a.Q6J("ngModel",ye.password),a.xp6(17),a.hij(" ",a.lcZ(36,6,"ocm.general.signIn"),""))},directives:[O.Gu,O.sr,O.wd,O.W2,O.BJ,O.q_,O.Ie,O.Q$,O.pK,O.j9,Q.JJ,Q.On,O.fr,O.Sm,O.YG,O.gu],pipes:[A.X$],encapsulation:2}),z})()},7814:(_n,Ke,k)=>{"use strict";k.d(Ke,{l:()=>L});var d=k(6099),c=k(7689),V=k(6799),a=k(8649),O=k(529),A=k(2340),p=k(6738);let L=(()=>{class Q{constructor(z,G,te){this.http=z,this.refData=G,this.logging=te,this.serviceBase="https://api.openchargemap.io",this.serviceBaseURL=this.serviceBase+"/v3",this.hasAuthorizationError=!1,this.ATTRIBUTION_METADATAFIELDID=4,this.clientName="ocm.api.default",this.allowMirror=!1,this.lastPOIApiCallURL="",this.serviceBaseURL=A.N.apiBase+"/v3"}getNumberListString(z){let G="";for(let te=0;te<z.length;te++)G+=z[te],te<z.length&&(G+=",");return G}fetchPOIListByParam(z){var G=this;return(0,d.Z)(function*(){const te=G.serviceBaseURL+"/poi/?client="+G.clientName+(G.allowMirror?" &allowmirror=true":"")+"&verbose=false&output=json";z.compact=!0;let ye="";null!=z.countryCode&&(ye+="&countrycode="+z.countryCode),null!=z.latitude&&(ye+="&latitude="+z.latitude),null!=z.longitude&&(ye+="&longitude="+z.longitude),null!=z.distance&&(ye+="&distance="+z.distance),null!=z.distanceUnit&&(ye+="&distanceunit="+z.distanceUnit),null!=z.includeComments&&(ye+="&includecomments="+z.includeComments),null!=z.maxResults&&(ye+="&maxresults="+z.maxResults),null!=z.countryIdList&&(ye+="&countryid="+G.getNumberListString(z.countryIdList)),null!=z.levelIdList&&(ye+="&levelid="+G.getNumberListString(z.levelIdList)),null!=z.connectionTypeIdList&&z.connectionTypeIdList.length>0&&(ye+="&connectiontypeid="+G.getNumberListString(z.connectionTypeIdList)),null!=z.operatorIdList&&z.operatorIdList.length>0&&(ye+="&operatorid="+G.getNumberListString(z.operatorIdList)),null!=z.usageTypeIdList&&z.usageTypeIdList.length>0&&(ye+="&usagetypeid="+G.getNumberListString(z.usageTypeIdList)),null!=z.statusTypeIdList&&z.statusTypeIdList.length>0&&(ye+="&statustypeid="+G.getNumberListString(z.statusTypeIdList)),null!=z.locationTitle&&(ye+="&locationtitle="+z.locationTitle),null!=z.minPowerKW&&z.minPowerKW>0&&(ye+="&minpowerkw="+z.minPowerKW),null!=z.maxPowerKW&&z.maxPowerKW>0&&(ye+="&maxpowerkw="+z.maxPowerKW),null!=z.submissionStatusTypeIdList&&(ye+="&submissionstatustypeid="+G.getNumberListString(z.submissionStatusTypeIdList)),null!=z.poiIdList&&z.poiIdList.length>0&&(ye+="&chargepointid="+G.getNumberListString(z.poiIdList)),0==z.enableCaching&&(ye+="&enablecaching=false"),null!=z.compact&&(ye+="&compact="+z.compact),z.levelOfDetail>1&&(ye+="&levelofdetail="+z.levelOfDetail),null!=z.polyline&&(ye+="&polyline="+z.polyline),null!=z.boundingbox&&(ye+="&boundingbox="+z.boundingbox),null!=z.additionalParams&&(ye+="&"+z.additionalParams);const me=te+ye;if(G.lastPOIApiCallURL===me&&0!=z.enableCaching)return G.logging.log("Skipped API call due to same query being repeated."),[];G.lastPOIApiCallURL=me,G.logging.log("API Call:"+me,c.i.VERBOSE);try{let Ee=yield G.http.get(me,G.getHttpRequestOptions()).toPromise();return G.refData.hydrateCompactPOIList(Ee)}catch(Ee){const je=Ee.message||"Could not fetch POI list from server.";throw G.logging.log("API Client: "+JSON.stringify(Ee),c.i.ERROR),je}})()}getHttpRequestOptions(z=!0){let G=new O.WM;return z&&(G=G.append("Content-Type","application/json")),this.authResponse&&this.authResponse.Data&&this.authResponse.Data.access_token&&(G=G.append("Authorization","Bearer "+this.authResponse.Data.access_token)),G=G.append("X-API-Key",A.N.apiKey),{headers:G}}fetchCoreReferenceData(z){let G=this.serviceBaseURL+"/referencedata/?client="+this.clientName+"&output=json"+(this.allowMirror?"&allowmirror=true":"")+"&verbose=false&compact=true";return null!=z&&null!=z.CountryIds&&(G+="&countryid="+this.getNumberListString(z.CountryIds)),this.logging.log("API Call:"+G,c.i.VERBOSE),this.http.get(G,this.getHttpRequestOptions())}performSignIn(z,G){return this.http.post(this.serviceBaseURL+"/profile/authenticate/",JSON.stringify({emailaddress:z,password:G}),this.getHttpRequestOptions()).toPromise().then(me=>(this.authResponse=me,this.authResponse))}performSubmission(z,G){return z===a.q.POI?this.submitPOI(G):z===a.q.Comment?this.submitUserComment(G):z===a.q.Media?this.submitMediaItem(G):void 0}submitUserComment(z){const G=JSON.stringify(z);return this.logging.log("[api] Submitting user comment"),this.http.post(this.serviceBaseURL+"/comment/",G,this.getHttpRequestOptions()).toPromise()}submitMediaItem(z){const G=JSON.stringify(z);return this.http.post(this.serviceBaseURL+"/mediaitem/",G,this.getHttpRequestOptions()).toPromise()}submitPOI(z){const G=JSON.stringify(z);return this.http.post(this.serviceBaseURL+"/poi/",G,this.getHttpRequestOptions()).toPromise()}getPanoramioLocationPhotos(z){return new Promise(G=>{const te=.001,ye="https://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=2&minx="+(z.longitude-te)+"&miny="+(z.latitude-te)+"&maxx="+(z.longitude+te)+"maxy="+(z.latitude+te)+"&size=medium&mapfilter=true&callback=?";return console.log(ye),this.http.get(ye).toPromise()})}fetchReverseGeocodeResult(z,G){return this.http.get(this.serviceBaseURL+"/geocode/?client="+this.clientName+"&output=json&camelcase=false&latitude="+z+"&longitude="+G,this.getHttpRequestOptions()).toPromise()}isLocalStorageAvailable(){return void 0!==window.localStorage}setCachedDataObject(z,G){this.isLocalStorageAvailable()&&(void 0===G&&(G=null),null===G?localStorage.removeItem(z):localStorage.setItem(z,JSON.stringify(G)))}getCachedDataObject(z){if(this.isLocalStorageAvailable()){const G=localStorage.getItem(z);if(null!=G&&G.length>0)return JSON.parse(G)}return null}}return Q.\u0275fac=function(z){return new(z||Q)(p.LFG(O.eN),p.LFG(V.W),p.LFG(c.z))},Q.\u0275prov=p.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q})()},56:(_n,Ke,k)=>{"use strict";k.d(Ke,{c:()=>O});var d=k(6099),c=k(7689),V=k(6738),a=k(9064);let O=(()=>{class A{constructor(L,Q){this.logger=L,this.platform=Q,this.isCordova=!1,this.ga=null,this.isCordova=!(!Q.is("cordova")&&!Q.is("capacitor"))}init(L){var Q=this;return(0,d.Z)(function*(){Q.isCordova&&Q.ga?yield Q.ga.startTrackerWithId(L):Q.logger.log("Could not initialise analytics")})()}setAppVersion(L){var Q=this;return(0,d.Z)(function*(){if(Q.isCordova&&Q.ga)return Q.ga.setAppVersion(L);Q.logger.log(L)})()}appEvent(L,Q){var Z=this;return(0,d.Z)(function*(){if(Z.isCordova&&Z.ga)return Z.ga.trackEvent(L,Q);Z.logger.log(Q)})()}viewEvent(L){var Q=this;return(0,d.Z)(function*(){if(Q.isCordova&&Q.ga)return Q.ga.trackView(L);Q.logger.log(L)})()}}return A.\u0275fac=function(L){return new(L||A)(V.LFG(c.z),V.LFG(a.t4))},A.\u0275prov=V.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},3855:(_n,Ke,k)=>{"use strict";k.d(Ke,{c:()=>Ae});var d=k(6099),c=k(7689),V=k(7814),a=k(7627),O=k(4120),A=k(8649),p=k(6799),L=k(3912),Q=k(56),Z=k(2340),z=k(6738),G=k(529),te=k(6260);class ye{constructor(Ve,He){this.SubmissionType=Ve,this.Data=He,this.DateQueued=new Date,this.IsSubmitted=!1,this.IsInProgress=!1,this.IsCancelled=!1,this.IsFailure=!1,this.Attempts=0,this.ID=new Date+"_"+100*Math.random()}}let me=(()=>{class Ze{constructor(He){this.events=He,this.isQueueProcessing=!1}setAppManager(He){this.appManager=He}add(He,Ne){let xt=this.getQueueItems();xt.push(new ye(He,Ne)),this.saveQueueItems(xt)}update(He){let Ne=this.getQueueItems(),xt=new Array;return Ne.forEach(Je=>{xt.push(Je.ID==He.ID?He:Je)}),xt}processNextQueueItem(){let He=this.getNextQueueItem();null!=He&&null!=this.appManager&&this.appManager.api.performSubmission(He.SubmissionType,He.Data).then(()=>{He.IsSubmitted=!0,He.Attempts++,this.update(He),this.clear()})}getNextQueueItem(){let He=this.getQueueItems(),Ne=null;return He.forEach(xt=>{null==Ne&&!xt.IsCancelled&&!xt.IsInProgress&&!xt.IsSubmitted&&(Ne=xt)}),Ne}hasPendingItems(){let He=!1;return this.getQueueItems().forEach(xt=>{!xt.IsFailure&&!xt.IsCancelled&&!xt.IsSubmitted&&(He=!0)}),He}isCompleted(){let He=this.getQueueItems(),Ne=!0;return He.forEach(xt=>{(xt.IsInProgress||xt.IsFailure)&&(Ne=!1)}),Ne}clear(He=!1){let Ne=this.getQueueItems(),xt=new Array;He||Ne.forEach(Je=>{(Je.IsInProgress||Je.IsFailure)&&xt.push(Je)}),this.saveQueueItems(xt)}saveQueueItems(He){localStorage.setItem("submissionQueue",JSON.stringify(He))}getQueueItems(){let He=localStorage.getItem("submissionQueue");return null!=He?JSON.parse(He):new Array}}return Ze.\u0275fac=function(He){return new(He||Ze)(z.LFG(te.z))},Ze.\u0275prov=z.Yz7({token:Ze,factory:Ze.\u0275fac,providedIn:"root"}),Ze})();var Ee=k(9064),je=k(9397),rt=k(4244);let Ae=(()=>{class Ze{constructor(He,Ne,xt,Je,ct,wt,Tt,Ct,gt,Lt,Ht,Vn,Ft){this.http=He,this.events=Ne,this.api=xt,this.submissionQueue=Je,this.platform=ct,this.referenceDataManager=wt,this.journeyManager=Tt,this.translateService=Ct,this.toastController=gt,this.loadingController=Lt,this.jwtHelper=Ht,this.logging=Vn,this.analytics=Ft,this.isRequestInProgress=!1,this.title="Open Charge Map",this._isUserAuthenticated=null,this.isEmbeddedMode=!1,this.isOffline=!1,this.api.clientName="ocm.app.ionic."+Z.N.version,this.isDebugMode=!1,this.enableSubmissionQueue=!1,this.submissionQueue.setAppManager(this),this.platformMode=ct.is("cordova")?"cordova":"web",this.initAppManager(),this.searchSettings=new a.N,this.loadSearchSettings(),this.applyURLQueryStringOptions(),this.searchSettings.CheckForActiveFilters(),this.journeyManager.loadJourneys()}loadSearchSettings(){if(null!=localStorage.getItem("searchSettings")){this.searchSettings=new a.N;try{let He=JSON.parse(localStorage.getItem("searchSettings"));Object.assign(this.searchSettings,He)}catch{}}}savePushRegistration(He){localStorage.setItem("_pushToken",He.toString())}getPushRegistration(){localStorage.getItem("_pushToken")}getQueryVariable(He){let xt=window.location.search.substring(1).split("&");for(let Je=0;Je<xt.length;Je++){let ct=xt[Je].split("=");if(decodeURIComponent(ct[0])==He)return ct[1].split(",").map(Ct=>decodeURIComponent(Ct))}return null}applyURLQueryStringOptions(){if(this.getQueryVariable("mode")&&"embedded"==this.getQueryVariable("mode")[0]&&(this.isEmbeddedMode=!0),this.getQueryVariable("operatorid")){let He=this.getQueryVariable("operatorid");for(let Ne of He)this.searchSettings.OperatorList.unshift(parseInt(Ne,10))}if(this.getQueryVariable("latitude")&&this.getQueryVariable("longitude")){let He=this.getQueryVariable("latitude")[0],Ne=this.getQueryVariable("longitude")[0];this.searchSettings.StartSearchPosition=new O.wC(parseFloat(He),parseFloat(Ne))}this.getQueryVariable("title")&&(this.title=this.getQueryVariable("title")[0]),this.getQueryVariable("languagecode")&&this.setLanguage(this.getQueryVariable("languagecode")[0])}saveSearchSettings(){this.searchSettings.CheckForActiveFilters(),localStorage.setItem("searchSettings",JSON.stringify(this.searchSettings))}getLanguages(){return[{code:"ar",title:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 / Arabic"},{code:"bg",title:"Bulgarian / \u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",title:"Czech / \u010ce\u0161tina"},{code:"de",title:"German / Deutsch"},{code:"el",title:"Greek / \u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ae"},{code:"en",title:"English"},{code:"es",title:"Spanish / Espa\xf1ol"},{code:"et",title:"Estonian / Eesti"},{code:"fi",title:"Finnish / Suomi"},{code:"fr",title:"French / Fran\xe7ais"},{code:"fy",title:"West Frisian / Frysk"},{code:"hu",title:"Hungarian / Magyar"},{code:"it",title:"Italian / Italiano"},{code:"ja",title:"Japanese / \u65e5\u672c\u8a9e"},{code:"lt",title:"Lithuanian / Lietuvi\u0173"},{code:"nl",title:"Dutch / Nederlands"},{code:"pt",title:"Portuguese / portugu\xeas"},{code:"ru",title:"Russian / P\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sk",title:"Slovak / Sloven\u010dina"},{code:"tr",title:"Turkish / T\xfcrk\xe7e"},{code:"zh",title:"Chinese / \u4e2d\u56fd\u7684"}]}setLanguage(He){(null==He||""==He)&&(He="en"),this.logging.log("Changing language: "+He),this.translateService.use(He)}initAppManager(){this.initAuthFromStorage(),this.isUserAuthenticated(!0)&&this.enableSubmissionQueue&&null!=this.submissionQueue&&this.submissionQueue.hasPendingItems()&&this.submissionQueue.processNextQueueItem()}initAuthFromStorage(){let He=localStorage.getItem("authResponse");if(null!=He){let Ne=JSON.parse(He);null!=Ne.Data&&null!=Ne.Data.access_token&&(this.jwtHelper.decodeToken(Ne.Data.access_token),this.jwtHelper.isTokenExpired(Ne.Data.access_token)?localStorage.removeItem("authResponse"):(this.api.authResponse=Ne,this.logging.log("User has valid auth token in local storage",c.i.VERBOSE)))}}isUserAuthenticated(He=!1){return!1===He&&null!=this._isUserAuthenticated||(this._isUserAuthenticated=!1,null!=this.api.authResponse&&(this.jwtHelper.isTokenExpired(this.api.authResponse.Data.access_token)||(this._isUserAuthenticated=!0))),this._isUserAuthenticated}getCurrentAuthToken(){return null!=this.api.authResponse?this.api.authResponse.Data.access_token:null}getUserProfile(){return null!=this.api.authResponse?this.api.authResponse.Data.UserProfile:null}signOutCurrentUser(){localStorage.removeItem("authResponse"),this.api.authResponse=null,this._isUserAuthenticated=!1}submitComment(He){if(!this.enableSubmissionQueue)return this.api.performSubmission(A.q.Comment,He);this.submissionQueue.add(A.q.Comment,He),this.submissionQueue.processNextQueueItem()}submitMediaItem(He){if(!this.enableSubmissionQueue)return this.api.performSubmission(A.q.Media,He);this.submissionQueue.add(A.q.Media,He),this.submissionQueue.processNextQueueItem()}submitPOI(He){if(!this.enableSubmissionQueue)return this.api.performSubmission(A.q.POI,He);this.submissionQueue.add(A.q.POI,He),this.submissionQueue.processNextQueueItem()}showToastNotification(He){var Ne=this;return(0,d.Z)(function*(){yield(yield Ne.toastController.create({message:He,duration:3e3})).present()})()}showLoadingProgress(He){var Ne=this;return(0,d.Z)(function*(){yield(yield Ne.loadingController.create({message:He})).present()})()}dismissLoadingProgress(){var He=this;return(0,d.Z)(function*(){return He.loadingController.dismiss()})()}launchOCMWebPage(He){this.isUserAuthenticated(!0)&&(-1===He.indexOf("?")&&(He+="?"),He+="&auth="+this.getCurrentAuthToken()),He="https://openchargemap.org/site"+He,window.open(He,"_system")}launchWebPage(He){window.open(He,"_system")}isPlatform(He){return this.platform.is(He)}}return Ze.\u0275fac=function(He){return new(He||Ze)(z.LFG(G.eN),z.LFG(te.z),z.LFG(V.l),z.LFG(me),z.LFG(Ee.t4),z.LFG(p.W),z.LFG(L.i),z.LFG(je.sK),z.LFG(Ee.yF),z.LFG(Ee.HT),z.LFG(rt.N0),z.LFG(c.z),z.LFG(Q.c))},Ze.\u0275prov=z.Yz7({token:Ze,factory:Ze.\u0275fac,providedIn:"root"}),Ze})()},6260:(_n,Ke,k)=>{"use strict";k.d(Ke,{z:()=>c});var d=k(6738);let c=(()=>{class V{constructor(){this.c=new Map}subscribe(O,...A){let p=this.c.get(O);p||this.c.set(O,p=[]),p.push(...A)}unsubscribe(O,A){if(!A)return this.c.delete(O);const p=this.c.get(O);if(!p)return!1;const L=p.indexOf(A);return!(L<0||(p.splice(L,1),0===p.length&&this.c.delete(O),0))}publish(O,...A){const p=this.c.get(O);return p?p.map(L=>{try{return L(...A)}catch(Q){return console.error(Q),null}}):null}}return V.\u0275fac=function(O){return new(O||V)},V.\u0275prov=d.Yz7({token:V,factory:V.\u0275fac,providedIn:"root"}),V})()},3912:(_n,Ke,k)=>{"use strict";k.d(Ke,{i:()=>L});var d=k(7689),c=k(7814),V=k(9698),a=k(2206),O=k(129),A=k(4120),p=k(6738);let L=(()=>{class Q{constructor(z,G,te){this.api=z,this.poiManager=G,this.logging=te,this.journeys=[],this.favourites=[]}loadJourneys(){let z=localStorage.getItem("journeys");if(null!=z&&(this.journeys=JSON.parse(z)),null!=this.journeys)for(let G of this.journeys)this.fetchAllJourneyPOIDetails(G)}fetchAllJourneyPOIDetails(z){this.logging.log("Journeys - fetching poi details for Journey "+z.Title);let G=new a.b;G.poiIdList=[];for(let te of z.Stages)for(let ye of te.WayPoints)for(let me of ye.PoiIDs)G.poiIdList.push(me);this.api.fetchPOIListByParam(G).then(te=>{for(let ye of te)this.updateStoredPOI(ye)})}updateStoredPOI(z){if(this.journeys.forEach(G=>{G.Stages.forEach(te=>{te.WayPoints.forEach(ye=>{ye.PoiIDs.forEach(me=>{if(me==z.ID)if(null==ye.PoiList){ye.PoiList=[];let Ee=new O.Qp("charging",1);Ee.Poi=z,Ee.PoiID=z.ID,ye.PoiList.push(Ee)}else for(let Ee of ye.PoiList)Ee.PoiID==z.ID&&(Ee.Poi=z)})})})}),null!=this.favourites)for(let G of this.favourites)"charging"==G.Type&&G.PoiID==z.ID&&(G.Poi=z)}saveJourneys(){let z=JSON.parse(JSON.stringify(this.journeys));for(let te of z)for(const ye of te.Stages)for(let me of ye.WayPoints)for(let Ee of me.PoiList)Ee.Poi=null,Ee.Photos=null;const G=JSON.stringify(z);localStorage.setItem("journeys",G)}addJourney(z,G){let te=new O.vw;te.Title="Stage 1",null!=G&&te.WayPoints.push(G),z.Stages.push(te),this.journeys.push(z)}deleteJourney(z){this.journeys=this.journeys.filter(G=>G.ID!=z),this.saveJourneys()}getJourney(z){let G=this.journeys.filter(te=>te.ID==z);return G.length>0?G[0]:null}getJourneyStages(z){return this.getJourney(z).Stages}addJourneyWaypoint(z,G,te){let ye=this.getJourney(z);if(null==G){let me=new O.vw;me.Title="Stage "+(ye.Stages.length+1),me.WayPoints.push(te),ye.Stages.push(me)}else{let me=ye.Stages[G];null==me.WayPoints&&(me.WayPoints=[]),me.WayPoints.push(te)}}addJourneyStage(z,G){return this.getJourney(z).Stages.push(G)-1}setupTestJourneys(){this.journeys=[];let z=new O.fw;z.Title="New York to Brooklyn",z.Notes="A little jaunt to Brooklyn",z.Stages=[];let G=new O.vw,te=new O.kA;te.Notes="Starting point",te.Position=new A.wC(40,1.2),te.Title="Start",G.WayPoints.push(te);let ye=new O.kA;ye.Notes="Middle point",ye.Position=new A.wC(40,1.33),ye.Title="Middle",G.WayPoints.push(ye);let me=new O.kA;me.Notes="End point",me.Position=new A.wC(40,1.33),me.Title="End",G.WayPoints.push(me),z.Stages.push(G),this.journeys.push(z);let Ee=new O.fw;Ee.Title="Aberdeen to London",Ee.Notes="Roadtrip",Ee.Stages=[],this.journeys.push(Ee)}calculateEnergyConsumptionkWh(z,G,te=0,ye){return z*ye}setRoutePolyline(z){this.routePolyline=z}getRoutePolyline(){return this.routePolyline}}return Q.\u0275fac=function(z){return new(z||Q)(p.LFG(c.l),p.LFG(V.R),p.LFG(d.z))},Q.\u0275prov=p.Yz7({token:Q,factory:Q.\u0275fac,providedIn:"root"}),Q})()},7689:(_n,Ke,k)=>{"use strict";k.d(Ke,{i:()=>V,z:()=>a});var d=k(2340),c=k(6738),V=(()=>{return(O=V||(V={}))[O.VERBOSE=0]="VERBOSE",O[O.INFO=1]="INFO",O[O.WARNING=2]="WARNING",O[O.ERROR=3]="ERROR",V;var O})();let a=(()=>{class O{constructor(){this.logLevel=V.VERBOSE,d.N.production&&(this.logLevel=V.INFO)}log(p,L=V.VERBOSE){console&&console.log&&L>=this.logLevel&&console.log("["+V[L]+"] {"+(new Date).toLocaleTimeString()+"} "+p)}}return O.\u0275fac=function(p){return new(p||O)},O.\u0275prov=c.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},9698:(_n,Ke,k)=>{"use strict";k.d(Ke,{R:()=>p});var d=k(6099),c=k(7689),V=k(7814),a=k(56),O=k(6738),A=k(6260);let p=(()=>{class L{constructor(Z,z,G,te){this.api=Z,this.events=z,this.logging=G,this.analytics=te,this.isRequestInProgress=!1}refreshPOIList(Z){var z=this;return(0,d.Z)(function*(){try{return z.poiList=yield z.fetchPOIList(Z),z.events.publish("ocm:poiList:updated"),z.analytics.appEvent("Search","Fetched Results"),z.poiList.length}catch{return 0}})()}fetchPOIList(Z){var z=this;return(0,d.Z)(function*(){z.isRequestInProgress=!0;try{let G=yield z.api.fetchPOIListByParam(Z);return z.isRequestInProgress=!1,G&&G.length&&z.logging.log("fetched POI list ["+G.length+"]"),G}catch{return z.isRequestInProgress=!1,[]}})()}clearResults(){this.poiList=[],this.events.publish("ocm:poiList:cleared"),this.logging.log("clearing results after settings change",c.i.VERBOSE)}getPOIById(Z,z=!1,G=!1){var te=this;return(0,d.Z)(function*(){if(!G&&null!=te.poiList){const Ee=te.poiList.find(je=>je.ID==Z);if(Ee)return Ee}const ye={poiIdList:[Z],enableCaching:!G,includeComments:!0},me=yield te.api.fetchPOIListByParam(ye);return me&&me.length>0?(te.poiList&&me[0].ID==Z&&(te.poiList=te.poiList.filter(Ee=>Ee.ID!=Z),te.poiList.push(me[0]),te.logging.log("POI refreshed in cache "+Z)),me[0]):null})()}}return L.\u0275fac=function(Z){return new(Z||L)(O.LFG(V.l),O.LFG(A.z),O.LFG(c.z),O.LFG(a.c))},L.\u0275prov=O.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})()},6799:(_n,Ke,k)=>{"use strict";k.d(Ke,{W:()=>O});var d=k(6099),c=k(7689),V=k(6738),a=k(529);let O=(()=>{class A{constructor(L,Q){this.http=L,this.logging=Q,this.loadCachedRefData()}refreshReferenceData(L){var Q=this;return(0,d.Z)(function*(){try{const Z=yield L.fetchCoreReferenceData(null).toPromise();return Q.setCoreReferenceData(Z),Q.setFilteredReferenceData(Z),Q.logging.log("Got refreshed core ref data.",c.i.VERBOSE),Q.sortCoreReferenceData(),Q.cacheCurrentRefData(),!0}catch(Z){return Q.logging.log("Error fetching core ref data:"+Z),!1}})()}refreshFilteredReferenceData(L,Q){L.fetchCoreReferenceData(Q).subscribe(Z=>{this.setFilteredReferenceData(Z),this.sortCoreReferenceData(),this.logging.log("Got refreshed filtered reference data.",c.i.VERBOSE)},Z=>{this.logging.log("Error fetching filtered reference data:"+Z)})}setCoreReferenceData(L){this.referenceData=L}setFilteredReferenceData(L){this.filteredReferenceData=L}referenceDataLoaded(){return null!=this.referenceData}getCountries(L=!1){return 1==L?this.filteredReferenceData.Countries:this.referenceData.Countries}getCountryByID(L){return this.getRefDataByID(this.referenceData.Countries,L)}getConnectionTypes(L=!1){return 1==L?this.filteredReferenceData.ConnectionTypes:this.referenceData.ConnectionTypes}getConnectionTypeByID(L){return this.getRefDataByID(this.referenceData.ConnectionTypes,L)}getUsageTypes(L=!1){return 1==L?this.filteredReferenceData.UsageTypes:this.referenceData.UsageTypes.filter(Q=>Q.ID>0)}getUsageTypeByID(L){return this.getRefDataByID(this.referenceData.UsageTypes,L)}getStatusTypes(L=!1){return 1==L?this.filteredReferenceData.StatusTypes:this.referenceData.StatusTypes.filter(Q=>Q.ID>0)}getStatusTypeByID(L){return this.getRefDataByID(this.referenceData.StatusTypes,L)}getNetworkOperators(L=!1){return 1==L?this.filteredReferenceData.Operators:this.referenceData.Operators}getNetworkOperatorByID(L){return this.getRefDataByID(this.referenceData.Operators,L)}getDataProviders(L=!1){return 1==L?this.filteredReferenceData.DataProviders:this.referenceData.DataProviders}getDataProviderByID(L){return this.getRefDataByID(this.referenceData.DataProviders,L)}getCheckinStatusTypes(L=!1,Q=!0){let Z=null;return Z=1==L?this.filteredReferenceData.CheckinStatusTypes:this.referenceData.CheckinStatusTypes,Q&&(Z=Z.filter(z=>!1===z.IsAutomatedCheckin)),Z}getCheckinStatusTypeByID(L){return this.getRefDataByID(this.referenceData.CheckinStatusTypes,L)}getCommentTypes(L=!1,Q=!0){let Z;return Z=1==L?this.filteredReferenceData.UserCommentTypes:this.referenceData.UserCommentTypes,Q&&(Z=Z.filter(z=>100!==z.ID&&110!==z.ID)),Z}getCommentTypeByID(L){return this.getRefDataByID(this.referenceData.UserCommentTypes,L)}getSubmissionStatusTypes(L=!1){return 1==L?this.filteredReferenceData.SubmissionStatusTypes:this.referenceData.SubmissionStatusTypes}getSubmissionStatusTypesByID(L){return this.getRefDataByID(this.referenceData.SubmissionStatusTypes,L)}getChargingLevelTypes(L=!1){return 1==L?this.filteredReferenceData.ChargerTypes:this.referenceData.ChargerTypes}getChargingLevelTypeByID(L){return this.getRefDataByID(this.referenceData.ChargerTypes,L)}getOutputCurrentTypes(L=!1){return L?this.referenceData.CurrentTypes:this.filteredReferenceData.CurrentTypes}getOutputCurrentTypeByID(L){return this.getRefDataByID(this.referenceData.CurrentTypes,L)}loadCachedRefData(){const L=localStorage.getItem("referenceData");if(null==L)this.http.get("./assets/data/CoreReferenceData.json").subscribe(Q=>{this.logging.log("Using bundled reference data as cached ref data."),this.setCoreReferenceData(Q),this.setFilteredReferenceData(Q)});else{let Q=JSON.parse(L);this.setCoreReferenceData(Q)}this.setFilteredReferenceData(this.referenceData)}cacheCurrentRefData(){null!=this.referenceData&&(this.referenceData.CacheDate=new Date,localStorage.setItem("referenceData",JSON.stringify(this.referenceData)))}getRefDataByID(L,Q){if(""!==Q&&(Q=parseInt(Q,10)),null!=L)for(let Z=0;Z<L.length;Z++)if(L[Z].ID===Q)return L[Z];return null}sortCoreReferenceData(){this.sortReferenceData(this.referenceData.ConnectionTypes),this.sortReferenceData(this.referenceData.Countries),this.sortReferenceData(this.referenceData.Operators),this.sortReferenceData(this.referenceData.DataProviders),this.sortReferenceData(this.referenceData.UsageTypes),this.sortReferenceData(this.referenceData.StatusTypes),this.sortReferenceData(this.referenceData.CheckinStatusTypes),this.sortReferenceData(this.referenceData.SubmissionStatusTypes),this.filteredReferenceData&&(this.sortReferenceData(this.filteredReferenceData.ConnectionTypes),this.sortReferenceData(this.filteredReferenceData.Operators))}sortReferenceData(L){L.sort(this.sortListByTitle)}sortListByTitle(L,Q){return L.Title<Q.Title?-1:L.Title>Q.Title?1:0}getMetadataValueByMetadataFieldID(L,Q){if(""!==Q&&(Q=parseInt(Q,10)),null!=L)for(let Z=0;Z<L.length;Z++)if(L[Z].ID===Q)return L[Z];return null}hydrateCompactPOI(L,Q=!1){const Z=this;if(null!=L.DataProviderID&&(Q||null==L.DataProvider)&&(L.DataProvider=Z.getDataProviderByID(L.DataProviderID)),null!=L.OperatorID&&(Q||null==L.OperatorInfo)&&(L.OperatorInfo=Z.getNetworkOperatorByID(L.OperatorID)),null!=L.UsageTypeID&&(Q||null==L.UsageType)&&(L.UsageType=Z.getUsageTypeByID(L.UsageTypeID)),null!=L.AddressInfo.CountryID&&(Q||null==L.AddressInfo.Country)&&(L.AddressInfo.Country=Z.getCountryByID(L.AddressInfo.CountryID)),null!=L.StatusTypeID&&(Q||null==L.StatusType)&&(L.StatusType=Z.getStatusTypeByID(L.StatusTypeID)),null!=L.SubmissionStatusTypeID&&(Q||null==L.SubmissionStatusType)&&(L.SubmissionStatusType=Z.getSubmissionStatusTypesByID(L.SubmissionStatusTypeID)),null!=L.Connections)for(let z=0;z<L.Connections.length;z++){const G=L.Connections[z];null!=G.ConnectionTypeID&&(Q||null==G.ConnectionType)&&(G.ConnectionType=Z.getConnectionTypeByID(G.ConnectionTypeID)),null!=G.LevelID&&(Q||null==G.Level)&&(G.Level=Z.getChargingLevelTypeByID(G.LevelID)),null!=G.CurrentTypeID&&(Q||null==G.CurrentType)&&(G.CurrentType=Z.getOutputCurrentTypeByID(G.CurrentTypeID)),null!=G.StatusTypeID&&(Q||null==G.StatusType)&&(G.StatusType=Z.getStatusTypeByID(G.StatusTypeID)),L.Connections[z]=G}if(null!=L.UserComments)for(let z=0;z<L.UserComments.length;z++){const G=L.UserComments[z];null!=G.CommentTypeID&&(Q||null==G.CommentType)&&(G.CommentType=Z.getCommentTypeByID(G.CommentTypeID)),null!=G.CheckinStatusTypeID&&(Q||null==G.CheckinStatusType)&&(G.CheckinStatusType=Z.getCheckinStatusTypeByID(G.CheckinStatusTypeID)),L.UserComments[z]=G}return L}hydrateCompactPOIList(L){for(let Q=0;Q<L.length;Q++)L[Q]=this.hydrateCompactPOI(L[Q]);return L}}return A.\u0275fac=function(L){return new(L||A)(V.LFG(a.eN),V.LFG(c.z))},A.\u0275prov=V.Yz7({token:A,factory:A.\u0275fac,providedIn:"root"}),A})()},4781:(_n,Ke,k)=>{"use strict";k.d(Ke,{v:()=>je});var d=k(553),c=k(5906),V=k(6579),a=k(7689),O=k(6099),A=k(2916),p=k(2210),L=k(4120),Q=k(2340),Z=k(4209);class z{constructor(Ae,Ze){this.events=Ae,this.logging=Ze,this.events=Ae,this.mapAPIType=c.b.MAPKIT_JS,this.mapReady=!1,this.markerList=new p.Xy,this.mapkitUtils=new G}initAPI(){mapkit&&mapkit.init({authorizationCallback:function(Ae){Ae(Q.N.mapKitToken)}})}disposeMap(){}initMap(Ae,Ze,Ve){this.mapCanvasID=Ae;let He=!0;if(He="undefined"!=typeof mapkit,!He)return this.logging.log("Call to initMap before API is ready:"+c.b[this.mapAPIType],a.i.ERROR),this.mapReady=!1,!1;this.initAPI(),null==this.map&&(document.getElementById(Ae),this.map=new mapkit.Map(Ae),this.map.annotationForCluster=function(xt){"poi"===xt.clusteringIdentifier&&(xt.title="Charging Location",xt.subtitle=xt.memberAnnotations.reduce((Je,ct)=>Je+ct.population,0))},this.mapReady=!0,mapkit.addEventListener("configuration-change",xt=>{this.events.publish("ocm:mapping:ready")}),this.map.addEventListener("scroll-end",xt=>{this.events.publish("ocm:mapping:dragend")}),this.map.addEventListener("zoom-end",xt=>{this.events.publish("ocm:mapping:zoom")}))}clearMarkers(){null!=this.markerList&&this.markerList.forEach((Ae,Ze)=>{try{this.map.removeAnnotation(Ze)}catch{}}),this.markerList=new p.Xy}showPOIListOnMap(Ae,Ze){let xt=0,ct=0==this.markerList.size();if(null!=Ae){let Tt=[];for(let Ct=0;Ct<Ae.length;Ct++)if(null!=Ae[Ct].AddressInfo&&null!=Ae[Ct].AddressInfo.Latitude&&null!=Ae[Ct].AddressInfo.Longitude){let gt=Ae[Ct],Lt=!0;if(null!=this.markerList&&this.markerList.containsKey(gt.ID)&&(Lt=!1),Lt){let Ht=null;Ht=V.c.getIconForPOI(gt);let Gt="OCM-"+gt.ID+": "+gt.AddressInfo.Title+":";null!=gt.UsageType&&(Gt+=" "+gt.UsageType.Title),null!=gt.StatusType&&(Gt+=" "+gt.StatusType.Title);const Jt=new mapkit.Coordinate(gt.AddressInfo.Latitude,gt.AddressInfo.Longitude);let an=new mapkit.ImageAnnotation(Jt,{title:Gt,size:{width:34,height:50},url:{1:Ht},clusteringIdentifier:"poi"});an.poi=gt,an.addEventListener("select",Jn=>{const si=Jn.target.poi;this.events.publish("ocm:poi:selected",{poi:si,poiId:si.ID})}),this.markerList.setValue(gt.ID,an),Tt.push(an),xt++}}Tt.length>0&&(this.map.addAnnotations(Tt),ct&&this.map.showItems(Tt,{animate:!0,padding:new mapkit.Padding(60,25,60,25)})),this.logging.log(xt+" new map markers added out of a total "+this.markerList.size())}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapKit: refreshMapLayout",a.i.VERBOSE)},200)}setMapCenter(Ae,Ze){this.map&&(this.map.setCenterAnimated(new mapkit.Coordinate(Ae.coords.latitude,Ae.coords.longitude),!1),Ze&&this.setMapZoom(Ze))}getMapCenter(){return new A.y(Ze=>{if(null!=this.map){let Ve=this.map.center;null!=Ve&&(Ze.next(new L.jR(Ve.latitude,Ve.longitude)),Ze.complete())}})}setMapZoom(Ae){const Ze=Math.min(Ae,28),Ve=this.mapkitUtils.deltaFromZoomLevel(this.map,this.map.center,Math.round(Ze)),He=new mapkit.CoordinateSpan(111*Ve.latitudeDelta,111*Ve.longitudeDelta),Ne=new mapkit.CoordinateRegion(this.map.center,He);this.map.setRegionAnimated(Ne)}getMapZoom(){return new A.y(Ze=>{this.logging.log("MapKit: getMapZoom not supported",a.i.VERBOSE),Ze.next(this.map._impl.zoomLevel),Ze.complete()})}setMapType(Ae){this.logging.log("MapKit: skipped setting Map Type :"+Ae)}getMapBounds(){return new A.y(Ze=>{let Ve=new Array,He=this.map.region.toBoundingRegion();Ve.push(new L.wC(He.southLatitude,He.westLongitude)),Ve.push(new L.wC(He.northLatitude,He.eastLongitude)),Ze.next(Ve),Ze.complete()})}moveToMapBounds(Ae){this.logging.log("MapKit: map bounds not implemented")}renderMap(Ae,Ze,Ve){return document.getElementById(this.mapCanvasID).style.height=Ze+"px",this.mapReady&&this.showPOIListOnMap(Ae,Ve),!0}renderPolyline(Ae){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(Ae){return(0,O.Z)(function*(){let Ze=new mapkit.Search({getsUserLocation:!0});return new Promise(function(){var Ve=(0,O.Z)(function*(He,Ne){let xt=[];Ze.search(Ae,function(){var Je=(0,O.Z)(function*(ct,wt){ct&&Ne(ct),xt=[],wt.places.map(Tt=>{let Ct=new Z.n;Ct.Title=Tt.name,Ct.Address=Tt.formattedAddress,Ct.Type="place",Ct.Location=new L.wC(Tt.coordinate.latitude,Tt.coordinate.longitude),xt.push(Ct)}),He(xt)});return function(ct,wt){return Je.apply(this,arguments)}}())});return function(He,Ne){return Ve.apply(this,arguments)}}())})()}addPOILayer(Ae){this.logging.log("Add POI Layer not implemented in this provider.")}}class G{constructor(){this.mercatorRadius=85445659.44705395,this.mercatorOffset=268435456}longitudeToPixelSpaceX(Ae){return Math.round(this.mercatorOffset+this.mercatorRadius*Ae*Math.PI/180)}latitudeToPixelSpaceY(Ae){return Math.round(this.mercatorOffset-this.mercatorRadius*Math.log((1+Math.sin(Ae*Math.PI/180))/(1-Math.sin(Ae*Math.PI/180)))/2)}pixelSpaceXToLongitude(Ae){return(Math.round(Ae)-this.mercatorOffset)/this.mercatorRadius*180/Math.PI}pixelSpaceYToLatitude(Ae){return 180*(Math.PI/2-2*Math.atan(Math.exp((Math.round(Ae)-this.mercatorOffset)/this.mercatorRadius)))/Math.PI}deltaFromZoomLevel(Ae,Ze,Ve){let He=this.longitudeToPixelSpaceX(Ze.longitude),Ne=this.latitudeToPixelSpaceY(Ze.latitude),Je=Math.pow(2,20-Ve),ct=Ae.visibleMapRect.size,wt=ct.width*Je,Tt=ct.height*Je,Ct=He-wt/2,gt=Ne-Tt/2,Lt=this.pixelSpaceXToLongitude(Ct),Vn=this.pixelSpaceXToLongitude(Ct+wt)-Lt,Ft=this.pixelSpaceYToLatitude(gt);return{latitudeDelta:-1*(this.pixelSpaceYToLatitude(gt+Tt)-Ft),longitudeDelta:Vn}}}var te=k(6738),ye=k(6260),me=k(529);let Ee=(()=>{class rt extends d.k{constructor(Ze,Ve,He){super(Ze,Ve,He),this.mapAPIType=c.b.MAPTILER,this.mapTileSet="https://maps.tilehosting.com/styles/streets/style.json?key=Gs9z7krALe3CGI60d5cL"}initAPI(){}}return rt.\u0275fac=function(Ze){return new(Ze||rt)(te.LFG(ye.z),te.LFG(a.z),te.LFG(me.eN))},rt.\u0275prov=te.Yz7({token:rt,factory:rt.\u0275fac}),rt})(),je=(()=>{class rt{constructor(Ze,Ve,He){this.logging=Ve,this.http=He,this.isFocused=!1,this.events=Ze,this.mapOptions=new c._,this.mapAPIReady=!1,this.mapsInitialised=!1,this.setMapAPI(this.mapOptions.mapAPI);let Ne=this;this.debouncedMapPositionUpdate=V.c.debounce(()=>{this.logging.log("signaling map position change:"),Ne.mapProvider.mapReady&&Ne.getMapCenter().subscribe(xt=>{null!=xt?(this.logging.log("Map centre/zoom changed, updating search position:"+xt),this.updateMapCentrePos(xt.coords.latitude,xt.coords.longitude,!1)):this.logging.log("Map centre/zoom changed - map not ready to change centre pos:")})},300,!1)}setParentAppContext(Ze){this.parentAppContext=Ze}setMapAPI(Ze){this.mapOptions.mapAPI=Ze,this.mapOptions.mapAPI==c.b.MAPBOX&&(this.mapProvider=new d.k(this.events,this.logging,this.http)),this.mapOptions.mapAPI==c.b.MAPKIT_JS&&(this.mapProvider=new z(this.events,this.logging)),this.mapOptions.mapAPI==c.b.MAPTILER&&(this.mapProvider=new Ee(this.events,this.logging,this.http))}isMapReady(){return null!=this.mapProvider&&this.mapProvider.mapReady}externalAPILoaded(Ze){this.mapAPIReady=!0,this.logging.log("Mapping API Loaded: "+c.b[Ze])}initMap(Ze){if(!this.isMapReady())if(null!=this.mapProvider)this.mapsInitialised&&this.logging.log("initMap: Map provider already initialised"),this.logging.log("Mapping Manager: Init "+c.b[this.mapProvider.mapAPIType]),this.mapProvider.initMap(Ze,this.mapOptions,this);else{if(this.mapsInitialised)return void this.logging.log("initMap: map already initialised");this.logging.log("initMap: "+this.mapOptions.mapAPI)}}mapManipulationPerformed(Ze){this.logging.log("map manipulated:"+Ze),("drag"==Ze||"zoom"==Ze)&&this.debouncedMapPositionUpdate()}updateMapSize(){this.mapProvider&&this.mapProvider.refreshMapLayout()}updateMapCentrePos(Ze,Ve,He,Ne){He&&null!=this.mapProvider&&this.mapProvider.setMapCenter(new L.jR(Ze,Ve),Ne),this.mapOptions.mapCentre=new L.jR(Ze,Ve)}moveToMapBounds(Ze){this.mapProvider.moveToMapBounds(Ze)}refreshMapView(Ze,Ve,He){return null!=this.mapProvider?(this.logging.log("Mapping Manager: renderMap "+c.b[this.mapProvider.mapAPIType]),this.isMapReady()?this.mapProvider.renderMap(Ve,Ze,this.parentAppContext):this.logging.log("refreshMapView: map provider not initialised..")):this.logging.log("Unsupported Map API: refreshMapView",a.i.ERROR),!0}setMapType(Ze){this.mapOptions.mapType!=Ze&&(this.mapOptions.mapType=Ze,this.isMapReady()&&null!=this.mapProvider?(this.logging.log("Changing map type:"+Ze),this.mapProvider.setMapType(Ze)):this.logging.log("Map type set, maps not initialised yet."))}unfocusMap(){this.logging.log("[mapping] Unfocus Map."),this.isFocused=!1,this.mapProvider.unfocusMap()}focusMap(){this.logging.log("[mapping] Focus Map."),this.isFocused=!0,this.mapProvider.focusMap()}getMapBounds(){return this.mapProvider.getMapBounds()}getMapZoom(){return this.mapProvider.getMapZoom()}setMapZoom(Ze){this.mapProvider.setMapZoom(Ze)}getMapCenter(){return this.mapProvider.getMapCenter()}showPOIOnStaticMap(Ze,Ve,He=!1,Ne=!1,xt=200,Je=200){let ct=document.getElementById(Ze);if(null!=ct){let Tt=Ve.AddressInfo.Latitude,Ct=Ve.AddressInfo.Longitude;xt>640&&(xt=640),Je>640&&(Je=640);let gt=xt,Lt=Je,Ht="https://maps.googleapis.com/maps/api/staticmap?center="+Tt+","+Ct+"&zoom=14&size="+gt+"x"+Lt+"&maptype=roadmap&markers=color:blue%7Clabel:A%7C"+Tt+","+Ct+"&sensor=false",Vn="";Vn+=1==He?"<div>"+V.c.formatMapLink(Ve,'<div><img width="'+gt+'" height="'+Lt+'" src="'+Ht+'" /></div>',Ne)+"</div>":'<div><img width="'+gt+'" height="'+Lt+'" src="'+Ht+'" /></div>',ct.innerHTML=Vn}}renderPolyline(Ze){this.mapProvider.renderPolyline(Ze)}clearPolyline(){this.mapProvider.clearPolyline()}clearMarkers(){this.logging.log("mapping: clearing markers"),this.mapProvider.clearMarkers()}addPOILayer(Ze){this.mapProvider.addPOILayer(Ze)}}return rt.\u0275fac=function(Ze){return new(Ze||rt)(te.LFG(ye.z),te.LFG(a.z),te.LFG(me.eN))},rt.\u0275prov=te.Yz7({token:rt,factory:rt.\u0275fac,providedIn:"root"}),rt})()},5906:(_n,Ke,k)=>{"use strict";k.d(Ke,{b:()=>c,_:()=>V});var d=k(2340),c=(()=>{return(a=c||(c={}))[a.GOOGLE_WEB=1]="GOOGLE_WEB",a[a.GOOGLE_NATIVE=2]="GOOGLE_NATIVE",a[a.LEAFLET=3]="LEAFLET",a[a.MAPBOX=4]="MAPBOX",a[a.MAPKIT_JS=5]="MAPKIT_JS",a[a.MAPTILER=6]="MAPTILER",c;var a})();class V{constructor(){this.enableClustering=!1,this.resultBatchID=-1,this.useMarkerIcons=!0,this.useMarkerAnimation=!0,this.enableTrackingMapCentre=!1,this.enableSearchByWatchingLocation=!1,this.mapCentre=null,this.mapAPI=d.N.defaultMapProvider,this.mapType="ROADMAP",this.searchDistanceKM=1e5,this.mapMoveQueryRefreshMS=300,this.enableSearchRadiusIndicator=!1,this.minZoomLevel=2}}},553:(_n,Ke,k)=>{"use strict";k.d(Ke,{k:()=>Ee});var d=k(6099),c=k(6579),V=k(5906),a=k(2916),O=k(2210),A=k(4120),p=k(7689),L=k(9898),Z=k(2340),z=k(4209),G=k(6738),te=k(6260),ye=k(529);let Ee=(()=>{class je{constructor(Ae,Ze,Ve){this.events=Ae,this.logging=Ze,this.http=Ve,this._isMapAnimating=!1,this.events=Ae,this.mapAPIType=V.b.MAPBOX,this.mapReady=!1,this.markerList=new O.Xy}initAPI(){L&&(L.accessToken=Z.N.mapBoxToken)}disposeMap(){this.map&&(this.logging.log("Disposing map",p.i.INFO),this.map.remove())}getCurrentMapTileSet(Ae){return"SATELLITE"==Ae?"mapbox://styles/mapbox/satellite-streets-v11?optimize=true":"mapbox://styles/mapbox/streets-v11?optimize=true"}flyAroundPoint(Ae){if(this._isMapAnimating){this.map.rotateTo(Ae/100%360,{duration:0});const Ze=this;requestAnimationFrame(function(Ve){Ze.flyAroundPoint(Ve)})}}initMap(Ae,Ze,Ve){this.mapCanvasID=Ae;let He=!0;if(He=void 0!==L,!He)return this.logging.log("Call to initMap before API is ready:"+V.b[this.mapAPIType],p.i.ERROR),this.mapReady=!1,!1;if(null==this.map){let ct=function(Tt){return Tt*(2-Tt)};document.getElementById(Ae),this.initAPI(),this.map=new L.Map({container:Ae,style:this.getCurrentMapTileSet(Ze.mapType),zoom:15,attributionControl:!1}),this.map.addControl(new L.AttributionControl({compact:!0,customAttribution:["Open Charge Map Contributors"]})),this.map.addControl(new L.NavigationControl),this.mapReady=!0,this.map.getCanvas().focus();let xt=100,Je=25;this.map.getCanvas().addEventListener("keydown",Tt=>{Tt.preventDefault(),38===Tt.which?this.map.panBy([0,-xt],{easing:ct}):40===Tt.which?this.map.panBy([0,xt],{easing:ct}):37===Tt.which?this.map.easeTo({bearing:this.map.getBearing()-Je,easing:ct}):39===Tt.which?this.map.easeTo({bearing:this.map.getBearing()+Je,easing:ct}):32===Tt.which&&(this._isMapAnimating?this._isMapAnimating=!1:(this._isMapAnimating=!0,this.flyAroundPoint(0)))},!0),this.map.on("load",()=>{this.events.publish("ocm:mapping:ready")});let wt=c.c.debounce(()=>{this.getMapCenter().subscribe(Tt=>{this.searchMarker.setLngLat(new L.LngLat(Tt.coords.longitude,Tt.coords.latitude))})},500,!1);this.map.on("move",()=>{this.searchMarker&&wt()}),this.map.on("moveend",()=>{this.events.publish("ocm:mapping:dragend"),Ze.onMapMoveCompleted&&Ze.onMapMoveCompleted()}),this.map.on("zoomend",()=>{this.events.publish("ocm:mapping:zoom")})}}clearMarkers(){null!=this.markerList&&this.markerList.forEach((Ae,Ze)=>{try{Ze.remove()}catch{}}),this.markerList=new O.Xy}showPOIListOnMap(Ae,Ze,Ve=!0){let Ne=this.map,xt=new L.LngLatBounds,Je=0;if(Ne.getZoom(),null!=Ae){for(let gt=0;gt<Ae.length;gt++)if(null!=Ae[gt].AddressInfo&&null!=Ae[gt].AddressInfo.Latitude&&null!=Ae[gt].AddressInfo.Longitude){let Lt=Ae[gt],Ht=!0;if(null!=this.markerList&&this.markerList.containsKey(Lt.ID)){Ht=!1;let Vn=this.markerList.getValue(Lt.ID);Vn&&Vn.poi&&Vn.poi.DateLastStatusUpdate!=Lt.DateLastStatusUpdate&&(Vn.remove(),Ht=!0)}if(Ht){let Vn=null,Ft=null;Ve?(Vn=document.createElement("img"),Vn.src=c.c.getIconForPOI(Lt),Vn.width=34,Vn.height=50):(Vn=null,Ft=c.c.getColorForPOI(Lt));let Gt=(Ve?"OCM-":"EXT-")+Lt.ID+": "+Lt.AddressInfo.Title+":";null!=Lt.UsageType&&(Gt+=" "+Lt.UsageType.Title),null!=Lt.StatusType&&(Gt+=" "+Lt.StatusType.Title);let Jt=new L.Marker({element:Vn,color:Ft}).setLngLat([Lt.AddressInfo.Longitude,Lt.AddressInfo.Latitude]).addTo(Ne);Jt.poi=Lt;let an=Jt.getElement();an.poi=Lt,an.addEventListener("click",Jn=>{const si=Jn.currentTarget.poi;this.events.publish("ocm:poi:selected",{poiId:si.ID,poi:si})}),xt.extend(Jt.getLngLat()),this.markerList.setValue(Lt.ID,Jt),Je++}}this.logging.log(Je+" new map markers added out of a total "+this.markerList.size())}if(null!=Ae&&Ae.length>0)if(null==Ze||Ze.appConfig.enableLiveMapQuerying)null==Ne.getCenter()&&Ne.setCenter(xt.getCenter());else{this.logging.log("Fitting to marker bounds:"+xt),Ne.setCenter(xt.getCenter()),this.logging.log("zoom before fit bounds:"+Ne.getZoom()),Ne.fitBounds(xt);let Ct=Ne.getZoom();Ne.setZoom(Ct<6?6:Ct)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapBoxGL: refreshMapLayout",p.i.VERBOSE),this.map.resize()},200)}setMapCenter(Ae){this.mapReady&&(this.map.setCenter(new L.LngLat(Ae.coords.longitude,Ae.coords.latitude)),this.searchMarker||(this.searchMarker=new L.Marker({color:"#99ccff",anchor:"top"}).setLngLat(new L.LngLat(Ae.coords.longitude,Ae.coords.latitude)).addTo(this.map),this.searchMarker.getElement().addEventListener("click",()=>{let Ze=this.searchMarker.getLngLat();this.events.publish("ocm:mapping:addpoi",new A.wC(Ze.lat,Ze.lng))})))}getMapCenter(){return new a.y(Ze=>{if(null!=this.map){let Ve=this.map.getCenter();null!=Ve&&(Ze.next(new A.jR(Ve.lat,Ve.lng)),Ze.complete())}})}setMapZoom(Ae){this.map.setZoom(Ae)}getMapZoom(){return new a.y(Ze=>{let Ve=this.map.getZoom();Ze.next(Ve),Ze.complete()})}setMapType(Ae){this.map.setStyle(this.getCurrentMapTileSet(Ae))}getMapBounds(){return new a.y(Ze=>{let Ve=new Array,He=this.map.getBounds();Ve.push(new A.wC(He.getSouthWest().lat,He.getSouthWest().lng)),Ve.push(new A.wC(He.getNorthEast().lat,He.getNorthEast().lng)),Ze.next(Ve),Ze.complete()})}moveToMapBounds(Ae){this.map.fitBounds(new L.LngLatBounds(new L.LngLat(Ae.southWest.longitude,Ae.southWest.latitude),new L.LngLat(Ae.northEast.longitude,Ae.northEast.latitude)))}renderMap(Ae,Ze,Ve){return document.getElementById(this.mapCanvasID).style.height=Ze+"px",this.mapReady&&this.showPOIListOnMap(Ae,Ve),!0}renderPolyline(Ae){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(Ae,Ze,Ve){var He=this;return(0,d.Z)(function*(){let Ne=`https://api.mapbox.com/geocoding/v5/mapbox.places/${Ae||Ve+","+Ze}.json?access_token=${Z.N.mapBoxToken}`;return new Promise(function(){var xt=(0,d.Z)(function*(Je,ct){He.http.get(Ne).toPromise().then(wt=>{let Tt=[];Tt=[],wt.features&&wt.features.map(Ct=>{let gt=new z.n;gt.Title=Ct.place_name,gt.Address=Ct.place_name,gt.Type="place",gt.Location=new A.wC(Ct.center[1],Ct.center[0]),gt.Attribution=wt.attribution,Tt.push(gt)}),Je(Tt)})});return function(Je,ct){return xt.apply(this,arguments)}}())})()}addPOILayer(Ae){this.logging.log("Add POI Layer not implemented in this provider."),this.showPOIListOnMap(Ae,null,!1)}}return je.\u0275fac=function(Ae){return new(Ae||je)(G.LFG(te.z),G.LFG(p.z),G.LFG(ye.eN))},je.\u0275prov=G.Yz7({token:je,factory:je.\u0275fac}),je})()},2340:(_n,Ke,k)=>{"use strict";k.d(Ke,{N:()=>d});const d={name:"prod",version:"8.1.1",production:!0,analyticsId:"",googleMapsKey:"",mapBoxToken:"pk.eyJ1Ijoid2VicHJvZnVzaW9uIiwiYSI6ImNrdHZlc2N5dTI5Zjcydm8zYWFwc2JnbTMifQ.M7b5SOzbPcg_8XAHCOeP0w",mapKitToken:"",enableStaticMaps:!1,defaultMapProvider:4,apiBase:"https://api.openchargemap.io",apiKey:"9bb03e5b-0fb2-4916-9b2b-26c6bd27a56a",enabledFeatures:["MAP","ADD_COMMENT","ADD_PHOTO","FAVOURITES","FILTER_OPTIONS_BY_COUNTRY","ADD_POI","EDIT_POI","LAYERS"]}},552:(_n,Ke,k)=>{"use strict";var d=k(6895),c=k(6738);class V extends d.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class a extends V{static makeCurrent(){(0,d.HT)(new a)}onAndCancel(nt,ke,At){return nt.addEventListener(ke,At,!1),()=>{nt.removeEventListener(ke,At,!1)}}dispatchEvent(nt,ke){nt.dispatchEvent(ke)}remove(nt){nt.parentNode&&nt.parentNode.removeChild(nt)}createElement(nt,ke){return(ke=ke||this.getDefaultDocument()).createElement(nt)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(nt){return nt.nodeType===Node.ELEMENT_NODE}isShadowRoot(nt){return nt instanceof DocumentFragment}getGlobalEventTarget(nt,ke){return"window"===ke?window:"document"===ke?nt:"body"===ke?nt.body:null}getBaseHref(nt){const ke=function A(){return O=O||document.querySelector("base"),O?O.getAttribute("href"):null}();return null==ke?null:function L(at){p=p||document.createElement("a"),p.setAttribute("href",at);const nt=p.pathname;return"/"===nt.charAt(0)?nt:`/${nt}`}(ke)}resetBaseElement(){O=null}getUserAgent(){return window.navigator.userAgent}getCookie(nt){return(0,d.Mx)(document.cookie,nt)}}let p,O=null;const Q=new c.OlP("TRANSITION_ID"),z=[{provide:c.ip1,useFactory:function Z(at,nt,ke){return()=>{ke.get(c.CZH).donePromise.then(()=>{const At=(0,d.q)(),en=nt.querySelectorAll(`style[ng-transition="${at}"]`);for(let pi=0;pi<en.length;pi++)At.remove(en[pi])})}},deps:[Q,d.K0,c.zs3],multi:!0}];class G{static init(){(0,c.VLi)(new G)}addToWindow(nt){c.dqk.getAngularTestability=(At,en=!0)=>{const pi=nt.findTestabilityInTree(At,en);if(null==pi)throw new Error("Could not find testability for element.");return pi},c.dqk.getAllAngularTestabilities=()=>nt.getAllTestabilities(),c.dqk.getAllAngularRootElements=()=>nt.getAllRootElements(),c.dqk.frameworkStabilizers||(c.dqk.frameworkStabilizers=[]),c.dqk.frameworkStabilizers.push(At=>{const en=c.dqk.getAllAngularTestabilities();let pi=en.length,fi=!1;const Ur=function(ie){fi=fi||ie,pi--,0==pi&&At(fi)};en.forEach(function(ie){ie.whenStable(Ur)})})}findTestabilityInTree(nt,ke,At){return null==ke?null:nt.getTestability(ke)??(At?(0,d.q)().isShadowRoot(ke)?this.findTestabilityInTree(nt,ke.host,!0):this.findTestabilityInTree(nt,ke.parentElement,!0):null)}}let te=(()=>{class at{build(){return new XMLHttpRequest}}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275prov=c.Yz7({token:at,factory:at.\u0275fac}),at})();const ye=new c.OlP("EventManagerPlugins");let me=(()=>{class at{constructor(ke,At){this._zone=At,this._eventNameToPlugin=new Map,ke.forEach(en=>en.manager=this),this._plugins=ke.slice().reverse()}addEventListener(ke,At,en){return this._findPluginFor(At).addEventListener(ke,At,en)}addGlobalEventListener(ke,At,en){return this._findPluginFor(At).addGlobalEventListener(ke,At,en)}getZone(){return this._zone}_findPluginFor(ke){const At=this._eventNameToPlugin.get(ke);if(At)return At;const en=this._plugins;for(let pi=0;pi<en.length;pi++){const fi=en[pi];if(fi.supports(ke))return this._eventNameToPlugin.set(ke,fi),fi}throw new Error(`No event manager plugin found for event ${ke}`)}}return at.\u0275fac=function(ke){return new(ke||at)(c.LFG(ye),c.LFG(c.R0b))},at.\u0275prov=c.Yz7({token:at,factory:at.\u0275fac}),at})();class Ee{constructor(nt){this._doc=nt}addGlobalEventListener(nt,ke,At){const en=(0,d.q)().getGlobalEventTarget(this._doc,nt);if(!en)throw new Error(`Unsupported event target ${en} for event ${ke}`);return this.addEventListener(en,ke,At)}}let je=(()=>{class at{constructor(){this._stylesSet=new Set}addStyles(ke){const At=new Set;ke.forEach(en=>{this._stylesSet.has(en)||(this._stylesSet.add(en),At.add(en))}),this.onStylesAdded(At)}onStylesAdded(ke){}getAllStyles(){return Array.from(this._stylesSet)}}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275prov=c.Yz7({token:at,factory:at.\u0275fac}),at})(),rt=(()=>{class at extends je{constructor(ke){super(),this._doc=ke,this._hostNodes=new Map,this._hostNodes.set(ke.head,[])}_addStylesToHost(ke,At,en){ke.forEach(pi=>{const fi=this._doc.createElement("style");fi.textContent=pi,en.push(At.appendChild(fi))})}addHost(ke){const At=[];this._addStylesToHost(this._stylesSet,ke,At),this._hostNodes.set(ke,At)}removeHost(ke){const At=this._hostNodes.get(ke);At&&At.forEach(Ae),this._hostNodes.delete(ke)}onStylesAdded(ke){this._hostNodes.forEach((At,en)=>{this._addStylesToHost(ke,en,At)})}ngOnDestroy(){this._hostNodes.forEach(ke=>ke.forEach(Ae))}}return at.\u0275fac=function(ke){return new(ke||at)(c.LFG(d.K0))},at.\u0275prov=c.Yz7({token:at,factory:at.\u0275fac}),at})();function Ae(at){(0,d.q)().remove(at)}const Ze={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Ve=/%COMP%/g;function Tt(at,nt,ke){for(let At=0;At<nt.length;At++){let en=nt[At];Array.isArray(en)?Tt(at,en,ke):(en=en.replace(Ve,at),ke.push(en))}return ke}function Ct(at){return nt=>{if("__ngUnwrap__"===nt)return at;!1===at(nt)&&(nt.preventDefault(),nt.returnValue=!1)}}let Lt=(()=>{class at{constructor(ke,At,en){this.eventManager=ke,this.sharedStylesHost=At,this.appId=en,this.rendererByCompId=new Map,this.defaultRenderer=new Ht(ke)}createRenderer(ke,At){if(!ke||!At)return this.defaultRenderer;switch(At.encapsulation){case c.ifc.Emulated:{let en=this.rendererByCompId.get(At.id);return en||(en=new Wt(this.eventManager,this.sharedStylesHost,At,this.appId),this.rendererByCompId.set(At.id,en)),en.applyToHost(ke),en}case 1:case c.ifc.ShadowDom:return new Gt(this.eventManager,this.sharedStylesHost,ke,At);default:if(!this.rendererByCompId.has(At.id)){const en=Tt(At.id,At.styles,[]);this.sharedStylesHost.addStyles(en),this.rendererByCompId.set(At.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return at.\u0275fac=function(ke){return new(ke||at)(c.LFG(me),c.LFG(rt),c.LFG(c.AFp))},at.\u0275prov=c.Yz7({token:at,factory:at.\u0275fac}),at})();class Ht{constructor(nt){this.eventManager=nt,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(nt,ke){return ke?document.createElementNS(Ze[ke]||ke,nt):document.createElement(nt)}createComment(nt){return document.createComment(nt)}createText(nt){return document.createTextNode(nt)}appendChild(nt,ke){nt.appendChild(ke)}insertBefore(nt,ke,At){nt&&nt.insertBefore(ke,At)}removeChild(nt,ke){nt&&nt.removeChild(ke)}selectRootElement(nt,ke){let At="string"==typeof nt?document.querySelector(nt):nt;if(!At)throw new Error(`The selector "${nt}" did not match any elements`);return ke||(At.textContent=""),At}parentNode(nt){return nt.parentNode}nextSibling(nt){return nt.nextSibling}setAttribute(nt,ke,At,en){if(en){ke=en+":"+ke;const pi=Ze[en];pi?nt.setAttributeNS(pi,ke,At):nt.setAttribute(ke,At)}else nt.setAttribute(ke,At)}removeAttribute(nt,ke,At){if(At){const en=Ze[At];en?nt.removeAttributeNS(en,ke):nt.removeAttribute(`${At}:${ke}`)}else nt.removeAttribute(ke)}addClass(nt,ke){nt.classList.add(ke)}removeClass(nt,ke){nt.classList.remove(ke)}setStyle(nt,ke,At,en){en&(c.JOm.DashCase|c.JOm.Important)?nt.style.setProperty(ke,At,en&c.JOm.Important?"important":""):nt.style[ke]=At}removeStyle(nt,ke,At){At&c.JOm.DashCase?nt.style.removeProperty(ke):nt.style[ke]=""}setProperty(nt,ke,At){nt[ke]=At}setValue(nt,ke){nt.nodeValue=ke}listen(nt,ke,At){return"string"==typeof nt?this.eventManager.addGlobalEventListener(nt,ke,Ct(At)):this.eventManager.addEventListener(nt,ke,Ct(At))}}class Wt extends Ht{constructor(nt,ke,At,en){super(nt),this.component=At;const pi=Tt(en+"-"+At.id,At.styles,[]);ke.addStyles(pi),this.contentAttr=function ct(at){return"_ngcontent-%COMP%".replace(Ve,at)}(en+"-"+At.id),this.hostAttr=function wt(at){return"_nghost-%COMP%".replace(Ve,at)}(en+"-"+At.id)}applyToHost(nt){super.setAttribute(nt,this.hostAttr,"")}createElement(nt,ke){const At=super.createElement(nt,ke);return super.setAttribute(At,this.contentAttr,""),At}}class Gt extends Ht{constructor(nt,ke,At,en){super(nt),this.sharedStylesHost=ke,this.hostEl=At,this.shadowRoot=At.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const pi=Tt(en.id,en.styles,[]);for(let fi=0;fi<pi.length;fi++){const Ur=document.createElement("style");Ur.textContent=pi[fi],this.shadowRoot.appendChild(Ur)}}nodeOrShadowRoot(nt){return nt===this.hostEl?this.shadowRoot:nt}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(nt,ke){return super.appendChild(this.nodeOrShadowRoot(nt),ke)}insertBefore(nt,ke,At){return super.insertBefore(this.nodeOrShadowRoot(nt),ke,At)}removeChild(nt,ke){return super.removeChild(this.nodeOrShadowRoot(nt),ke)}parentNode(nt){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(nt)))}}let Jt=(()=>{class at extends Ee{constructor(ke){super(ke)}supports(ke){return!0}addEventListener(ke,At,en){return ke.addEventListener(At,en,!1),()=>this.removeEventListener(ke,At,en)}removeEventListener(ke,At,en){return ke.removeEventListener(At,en)}}return at.\u0275fac=function(ke){return new(ke||at)(c.LFG(d.K0))},at.\u0275prov=c.Yz7({token:at,factory:at.\u0275fac}),at})();const an=["alt","control","meta","shift"],si={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},di={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},Bn={alt:at=>at.altKey,control:at=>at.ctrlKey,meta:at=>at.metaKey,shift:at=>at.shiftKey};let ln=(()=>{class at extends Ee{constructor(ke){super(ke)}supports(ke){return null!=at.parseEventName(ke)}addEventListener(ke,At,en){const pi=at.parseEventName(At),fi=at.eventCallback(pi.fullKey,en,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,d.q)().onAndCancel(ke,pi.domEventName,fi))}static parseEventName(ke){const At=ke.toLowerCase().split("."),en=At.shift();if(0===At.length||"keydown"!==en&&"keyup"!==en)return null;const pi=at._normalizeKey(At.pop());let fi="";if(an.forEach(ie=>{const ue=At.indexOf(ie);ue>-1&&(At.splice(ue,1),fi+=ie+".")}),fi+=pi,0!=At.length||0===pi.length)return null;const Ur={};return Ur.domEventName=en,Ur.fullKey=fi,Ur}static getEventFullKey(ke){let At="",en=function Et(at){let nt=at.key;if(null==nt){if(nt=at.keyIdentifier,null==nt)return"Unidentified";nt.startsWith("U+")&&(nt=String.fromCharCode(parseInt(nt.substring(2),16)),3===at.location&&di.hasOwnProperty(nt)&&(nt=di[nt]))}return si[nt]||nt}(ke);return en=en.toLowerCase()," "===en?en="space":"."===en&&(en="dot"),an.forEach(pi=>{pi!=en&&Bn[pi](ke)&&(At+=pi+".")}),At+=en,At}static eventCallback(ke,At,en){return pi=>{at.getEventFullKey(pi)===ke&&en.runGuarded(()=>At(pi))}}static _normalizeKey(ke){return"esc"===ke?"escape":ke}}return at.\u0275fac=function(ke){return new(ke||at)(c.LFG(d.K0))},at.\u0275prov=c.Yz7({token:at,factory:at.\u0275fac}),at})();const mi=(0,c.eFA)(c._c5,"browser",[{provide:c.Lbi,useValue:d.bD},{provide:c.g9A,useValue:function Kt(){a.makeCurrent(),G.init()},multi:!0},{provide:d.K0,useFactory:function In(){return(0,c.RDi)(document),document},deps:[]}]),ir=[{provide:c.zSh,useValue:"root"},{provide:c.qLn,useFactory:function Hn(){return new c.qLn},deps:[]},{provide:ye,useClass:Jt,multi:!0,deps:[d.K0,c.R0b,c.Lbi]},{provide:ye,useClass:ln,multi:!0,deps:[d.K0]},{provide:Lt,useClass:Lt,deps:[me,rt,c.AFp]},{provide:c.FYo,useExisting:Lt},{provide:je,useExisting:rt},{provide:rt,useClass:rt,deps:[d.K0]},{provide:c.dDg,useClass:c.dDg,deps:[c.R0b]},{provide:me,useClass:me,deps:[ye,c.R0b]},{provide:d.JF,useClass:te,deps:[]}];let _r=(()=>{class at{constructor(ke){if(ke)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(ke){return{ngModule:at,providers:[{provide:c.AFp,useValue:ke.appId},{provide:Q,useExisting:c.AFp},z]}}}return at.\u0275fac=function(ke){return new(ke||at)(c.LFG(at,12))},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({providers:ir,imports:[d.ez,c.hGG]}),at})();"undefined"!=typeof window&&window;var Qe=k(8936),vt=k(9397),kt=k(4006),tt=k(9064);let Zt=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({imports:[[d.ez,kt.u5,tt.Pc,vt.aw,Qe.e]]}),at})(),on=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({imports:[[d.ez,kt.u5,tt.Pc,vt.aw,Qe.e]]}),at})(),sn=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({imports:[[d.ez,kt.u5,tt.Pc,vt.aw,Qe.e]]}),at})();var gn=k(9671),Nn=k(529),Wn=k(3334),ai=k(4244);class Kn{constructor(nt,ke="/assets/i18n/",At=".json"){this.http=nt,this.prefix=ke,this.suffix=At}getTranslation(nt){return this.http.get(`${this.prefix}${nt}${this.suffix}`)}}var ui=k(6099),Qi=k(4781),Hi=k(6763),vi=k(9492),Pn=k(9741),Ai=k(3855);function Bi(at,nt){if(1&at){const ke=c.EpF();c.TgZ(0,"div"),c._uU(1," You are not signed in. "),c.TgZ(2,"button",5),c.NdJ("click",function(){return c.CHM(ke),c.oxw().showSignInModal()}),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.qZA()}2&at&&(c.xp6(3),c.Oqu(c.lcZ(4,1,"ocm.general.signIn")))}function Gi(at,nt){if(1&at&&(c.TgZ(0,"div"),c.TgZ(1,"ion-card"),c.TgZ(2,"ion-item"),c.TgZ(3,"ion-avatar",6),c._UZ(4,"img",7),c.qZA(),c.TgZ(5,"h2"),c._uU(6),c.qZA(),c.qZA(),c.TgZ(7,"ion-card-content"),c.TgZ(8,"p"),c._uU(9),c.qZA(),c.TgZ(10,"p"),c._uU(11),c.qZA(),c.qZA(),c.TgZ(12,"ion-item"),c.TgZ(13,"ion-note",8),c._UZ(14,"ion-icon",9),c._uU(15),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&at){const ke=c.oxw();c.xp6(4),c.s9C("src",ke.userProfile.ProfileImageURL,c.LSH),c.xp6(2),c.Oqu(ke.userProfile.Username),c.xp6(3),c.hij(" ",ke.userProfile.Profile,""),c.xp6(2),c.hij(" Date Joined: ",ke.userProfile.DateCreated," "),c.xp6(4),c.hij(" ",ke.userProfile.ReputationPoints," Contributor Points ")}}let Ar=(()=>{class at{constructor(ke,At,en,pi){this.appManager=ke,this.nav=At,this.translate=en,this.modalController=pi}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),null!=this.userProfile&&this.appManager.isUserAuthenticated(!0)?this.refreshProfileView():this.showSignInModal(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:vi.F,componentProps:{Profile:this.userProfile}}).then(ke=>{ke.onDidDismiss().then(()=>{this.refreshProfileView()}),ke.present()})}close(){this.modalController.dismiss()}}return at.\u0275fac=function(ke){return new(ke||at)(c.Y36(Ai.c),c.Y36(tt.SH),c.Y36(vt.sK),c.Y36(tt.IN))},at.\u0275cmp=c.Xpm({type:at,selectors:[["ng-component"]],decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(ke,At){1&ke&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-title"),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.qZA(),c.qZA(),c.TgZ(5,"ion-content",0),c.YNc(6,Bi,5,3,"div",1),c.YNc(7,Gi,16,5,"div",1),c.qZA(),c.TgZ(8,"ion-footer"),c.TgZ(9,"ion-toolbar"),c.TgZ(10,"ion-buttons",2),c.TgZ(11,"ion-button",3),c.NdJ("click",function(){return At.close()}),c._UZ(12,"ion-icon",4),c._uU(13," Close "),c.qZA(),c.qZA(),c.qZA(),c.qZA()),2&ke&&(c.xp6(3),c.hij(" ",c.lcZ(4,3,"ocm.navigation.profile.sectionTitle")," "),c.xp6(3),c.Q6J("ngIf",null==At.userProfile),c.xp6(1),c.Q6J("ngIf",null!=At.userProfile))},directives:[tt.Gu,tt.sr,tt.wd,tt.W2,d.O5,tt.PM,tt.Ie,tt.BJ,tt.FN,tt.uN,tt.gu,tt.fr,tt.Sm,tt.YG],pipes:[vt.X$],encapsulation:2}),at})();var hi=k(7689),Cr=k(2340),xr=k(4508),qr=k(56),Ao=k(6579),Oi=k(388),yo=k(6588),to=k(7423);const uo=(0,to.fo)("PushNotifications",{}),Lr=(0,to.fo)("StatusBar"),Sr=(0,to.fo)("SplashScreen",{web:()=>k.e(2680).then(k.bind(k,2680)).then(at=>new at.SplashScreenWeb)}),Pr=(0,to.fo)("App",{web:()=>k.e(4477).then(k.bind(k,4477)).then(at=>new at.AppWeb)});var Se=k(6260);function Xe(at,nt){if(1&at){const ke=c.EpF();c.TgZ(0,"ion-item",9),c.NdJ("click",function(){return c.CHM(ke),c.oxw().openRoutePlannerModal()}),c._UZ(1,"ion-icon",12),c.TgZ(2,"ion-label"),c._uU(3," Route Planner "),c.qZA(),c.qZA()}}function Me(at,nt){if(1&at){const ke=c.EpF();c.TgZ(0,"ion-item",9),c.NdJ("click",function(){return c.CHM(ke),c.oxw().add()}),c._UZ(1,"ion-icon",13),c.TgZ(2,"ion-label"),c._uU(3),c.ALo(4,"translate"),c.qZA(),c.qZA()}2&at&&(c.xp6(3),c.hij(" ",c.lcZ(4,1,"ocm.general.addLocation")," "))}function st(at,nt){if(1&at){const ke=c.EpF();c.TgZ(0,"ion-item",9),c.NdJ("click",function(){return c.CHM(ke),c.oxw().journeys()}),c._UZ(1,"ion-icon",12),c.TgZ(2,"ion-label"),c._uU(3," Journeys "),c.qZA(),c.qZA()}}function Rt(at,nt){if(1&at){const ke=c.EpF();c.TgZ(0,"ion-item",9),c.NdJ("click",function(){return c.CHM(ke),c.oxw().addLayer()}),c._UZ(1,"ion-icon",14),c.TgZ(2,"ion-label"),c._uU(3," Add Layer "),c.qZA(),c.qZA()}}function zt(at,nt){if(1&at){const ke=c.EpF();c.ynx(0),c.TgZ(1,"ion-item",9),c.NdJ("click",function(){return c.CHM(ke),c.oxw().signIn()}),c._UZ(2,"ion-icon",15),c.TgZ(3,"ion-label"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.BQk()}2&at&&(c.xp6(4),c.hij(" ",c.lcZ(5,1,"ocm.general.signIn")," "))}function rn(at,nt){if(1&at){const ke=c.EpF();c.ynx(0),c.TgZ(1,"ion-item",9),c.NdJ("click",function(){return c.CHM(ke),c.oxw().profile()}),c._UZ(2,"ion-icon",15),c.TgZ(3,"ion-label"),c._uU(4),c.ALo(5,"translate"),c.qZA(),c.qZA(),c.TgZ(6,"ion-item",9),c.NdJ("click",function(){return c.CHM(ke),c.oxw().signOut()}),c._UZ(7,"ion-icon",16),c.TgZ(8,"ion-label"),c._uU(9),c.ALo(10,"translate"),c._UZ(11,"br"),c.TgZ(12,"small",17),c._uU(13),c.qZA(),c.qZA(),c.qZA(),c.BQk()}if(2&at){const ke=c.oxw();c.xp6(4),c.hij(" ",c.lcZ(5,3,"ocm.navigation.profile.sectionTitle")," "),c.xp6(5),c.hij(" ",c.lcZ(10,5,"ocm.general.signOut")," "),c.xp6(4),c.hij(" ",ke.getUserName(),"")}}const un=function(){return["/search"]};let dn=(()=>{class at{constructor(ke,At,en,pi,fi,Ur,ie,ue){this.platform=ke,this.translate=At,this.mapping=en,this.modalController=pi,this.appManager=fi,this.logger=Ur,this.analytics=ie,this.events=ue,this.logger.log("Environment: "+Cr.N.name),this.initializeApp(),this.enabledFeatures=Cr.N.enabledFeatures,1!=fi.searchSettings.EnableAdvancedEditorFeatures&&(this.enabledFeatures=this.enabledFeatures.filter(we=>"LAYERS"!=we))}configurePushNotifications(){uo.register(),uo.addListener("registration",ke=>{this.logger.log("Push registration success, token: "+ke.value),this.appManager.savePushRegistration(ke.value)}),uo.addListener("registrationError",ke=>{this.logger.log("Error on registration: "+JSON.stringify(ke))}),uo.addListener("pushNotificationReceived",ke=>{this.logger.log("Push received: "+JSON.stringify(ke),hi.i.INFO)}),uo.addListener("pushNotificationActionPerformed",ke=>{this.logger.log("Push action performed: "+JSON.stringify(ke))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let ke=this.appManager.getUserProfile();return ke?ke.EmailAddress?ke.EmailAddress:ke.Username:"Not Signed In"}initializeApp(){var ke=this;this.platform.ready().then(()=>{this.platform.is("capacitor")&&(Lr.show(),Sr.hide()),this.translate.addLangs(this.appManager.getLanguages().map(At=>At.code)),this.translate.setDefaultLang("en"),null!=this.appManager.searchSettings.Language?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(At=>{}),this.analytics.init(Cr.N.analyticsId).then(()=>{this.analytics.setAppVersion(Cr.N.version),this.analytics.appEvent("Startup","App Loaded")}).catch(At=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",function(){var At=(0,ui.Z)(function*(en){Ao.c.isFeatureEnabled("ADD_POI")&&ke.add(en)});return function(en){return At.apply(this,arguments)}}()),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return(0,ui.Z)(function*(){Pr.addListener("appUrlOpen",At=>{alert("App (re)opened with URL: "+At.url)});let ke=yield Pr.getLaunchUrl();ke&&ke.url&&alert("App opened with URL: "+ke.url)})()}openRoutePlannerModal(){var ke=this;return(0,ui.Z)(function*(){ke.mapping.unfocusMap();const At=yield ke.modalController.create({component:Hi.u});At.onDidDismiss().then(en=>{ke.mapping.focusMap()}),yield At.present()})()}continueAdd(ke){var At=this;return(0,ui.Z)(function*(){const en=yield At.modalController.create({component:xr.Y,componentProps:{startPos:ke}});en.onDidDismiss().then(pi=>{At.mapping.focusMap()}),yield en.present()})()}add(ke){var At=this;return(0,ui.Z)(function*(){if(At.mapping.unfocusMap(),!At.appManager.isUserAuthenticated(!0)){const en=yield At.modalController.create({component:vi.F});return en.onDidDismiss().then(function(){var pi=(0,ui.Z)(function*(fi){At.mapping.focusMap(),At.appManager.isUserAuthenticated(!0)&&(yield At.continueAdd(ke))});return function(fi){return pi.apply(this,arguments)}}()),yield en.present()}yield At.continueAdd(ke)})()}signIn(){var ke=this;return(0,ui.Z)(function*(){ke.mapping.unfocusMap();const At=yield ke.modalController.create({component:vi.F});return At.onDidDismiss().then(en=>{ke.mapping.focusMap(),ke.appManager.isUserAuthenticated(!0)}),yield At.present()})()}signOut(){var ke=this;return(0,ui.Z)(function*(){ke.appManager.signOutCurrentUser()})()}profile(){var ke=this;return(0,ui.Z)(function*(){ke.mapping.unfocusMap();const At=yield ke.modalController.create({component:Ar});At.onDidDismiss().then(en=>{ke.mapping.focusMap()}),yield At.present()})()}journeys(){var ke=this;return(0,ui.Z)(function*(){ke.mapping.unfocusMap();const At=yield ke.modalController.create({component:Pn.g});At.onDidDismiss().then(en=>{ke.mapping.focusMap()}),yield At.present()})()}addLayer(){var ke=this;return(0,ui.Z)(function*(){const At=yield ke.modalController.create({component:yo.A});yield At.present();const{data:en}=yield At.onWillDismiss();en&&ke.mapping.addPOILayer(en)})()}about(){var ke=this;return(0,ui.Z)(function*(){ke.mapping.unfocusMap();const At=yield ke.modalController.create({component:Oi.t});At.onDidDismiss().then(en=>{ke.mapping.focusMap()}),yield At.present()})()}}return at.\u0275fac=function(ke){return new(ke||at)(c.Y36(tt.t4),c.Y36(vt.sK),c.Y36(Qi.v),c.Y36(tt.IN),c.Y36(Ai.c),c.Y36(hi.z),c.Y36(qr.c),c.Y36(Se.z))},at.\u0275cmp=c.Xpm({type:at,selectors:[["app-root"]],decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(ke,At){1&ke&&(c.TgZ(0,"ion-app"),c.TgZ(1,"ion-split-pane",0),c.TgZ(2,"ion-menu",1),c.TgZ(3,"ion-header"),c.TgZ(4,"ion-toolbar"),c.TgZ(5,"ion-thumbnail",2),c._UZ(6,"img",3),c.qZA(),c.TgZ(7,"ion-title"),c._uU(8),c.qZA(),c.qZA(),c.qZA(),c.TgZ(9,"ion-content"),c.TgZ(10,"ion-list"),c.TgZ(11,"ion-menu-toggle",4),c.TgZ(12,"ion-item",5),c._UZ(13,"ion-icon",6),c.TgZ(14,"ion-label"),c._uU(15),c.ALo(16,"translate"),c.qZA(),c.qZA(),c.YNc(17,Xe,4,0,"ion-item",7),c.YNc(18,Me,5,3,"ion-item",7),c.YNc(19,st,4,0,"ion-item",7),c.YNc(20,Rt,4,0,"ion-item",7),c.YNc(21,zt,6,3,"ng-container",8),c.YNc(22,rn,14,7,"ng-container",8),c.TgZ(23,"ion-item",9),c.NdJ("click",function(){return At.about()}),c._UZ(24,"ion-icon",10),c.TgZ(25,"ion-label"),c._uU(26),c.ALo(27,"translate"),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c._UZ(28,"ion-router-outlet",11),c.qZA(),c.qZA()),2&ke&&(c.xp6(1),c.Q6J("disabled",!0),c.xp6(7),c.Oqu(At.appManager.title),c.xp6(4),c.Q6J("routerDirection","root")("routerLink",c.DdM(16,un)),c.xp6(3),c.hij(" ",c.lcZ(16,12,"ocm.search.sectionTitle")," "),c.xp6(2),c.Q6J("ngIf",At.enabledFeatures.includes("ROUTE_PLANNER")),c.xp6(1),c.Q6J("ngIf",At.enabledFeatures.includes("ADD_POI")),c.xp6(1),c.Q6J("ngIf",At.enabledFeatures.includes("FAVOURITES")),c.xp6(1),c.Q6J("ngIf",At.enabledFeatures.includes("LAYERS")),c.xp6(1),c.Q6J("ngIf",!At.isUserAuthenticated()),c.xp6(1),c.Q6J("ngIf",At.isUserAuthenticated()),c.xp6(4),c.hij(" ",c.lcZ(27,14,"ocm.general.about")," "))},directives:[tt.dr,tt.jI,tt.z0,tt.Gu,tt.sr,tt.Bs,tt.wd,tt.W2,tt.q_,tt.zc,tt.Ie,tt.YI,Wn.rH,tt.gu,tt.Q$,d.O5,tt.jP],pipes:[vt.X$],encapsulation:2}),at})();const An=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>Promise.resolve().then(k.bind(k,9671)).then(at=>at.SearchPageModule)},{path:"journeys",loadChildren:()=>Promise.resolve().then(k.bind(k,5476)).then(at=>at.JourneysModule)},{path:"signin",loadChildren:()=>Promise.resolve().then(k.bind(k,6779)).then(at=>at.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>Promise.resolve().then(k.bind(k,1948)).then(at=>at.PoiEditorPageModule)},{path:"about",loadChildren:()=>Promise.resolve().then(k.bind(k,534)).then(at=>at.AboutPageModule)},{path:"layer-editor",loadChildren:()=>Promise.resolve().then(k.bind(k,5005)).then(at=>at.LayerEditorPageModule)}];let qn=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({imports:[[Wn.Bz.forRoot(An,{useHash:!0})],Wn.Bz]}),at})(),Bt=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({imports:[[d.ez,kt.u5,tt.Pc,vt.aw,Qe.e]]}),at})();var hn=k(6779);let qi=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({imports:[[d.ez,kt.u5,tt.Pc,vt.aw,Qe.e,Wn.Bz.forChild([{path:"",component:Ar}])]]}),at})();var no=k(6314);let rr=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at}),at.\u0275inj=c.cJS({imports:[[d.ez,kt.u5,tt.Pc,vt.aw,Qe.e,Wn.Bz.forChild([{path:"",component:no.N}])]]}),at})();var Br=k(5476),pr=k(1948),Lo=k(534),mo=k(5005);function jn(){return localStorage.getItem("access_token")}function Wi(at){return new Kn(at,"/assets/i18n/",".json")}let wo=(()=>{class at{}return at.\u0275fac=function(ke){return new(ke||at)},at.\u0275mod=c.oAB({type:at,bootstrap:[dn]}),at.\u0275inj=c.cJS({providers:[{provide:Wn.wN,useClass:tt.r4}],imports:[[_r,Nn.JF,vt.aw.forRoot({loader:{provide:vt.Zw,useFactory:Wi,deps:[Nn.eN]}}),tt.Pc.forRoot(),qn,ai.Ar.forRoot({config:{tokenGetter:jn}}),gn.SearchPageModule,Bt,Br.JourneysModule,hn.SignInModule,sn,Zt,on,pr.PoiEditorPageModule,qi,rr,Lo.AboutPageModule,mo.LayerEditorPageModule]]}),at})();Cr.N.production&&(0,c.G48)(),mi().bootstrapModule(wo).catch(at=>console.log(at))},9898:function(_n){_n.exports=function(){"use strict";var Ke,k,d;function c(a,O){if(Ke)if(k){var A="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Ke+")(sharedChunk); ("+k+")(sharedChunk); self.onerror = null;",p={};Ke(p),d=O(p),"undefined"!=typeof window&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([A],{type:"text/javascript"})))}else k=O;else Ke=O}return c(0,function(a){var O="2.7.0",A=p;function p(t,e,i,s){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=s,this.p2x=i,this.p2y=s}p.prototype.sampleCurveX=function(t){return((this.ax*t+this.bx)*t+this.cx)*t},p.prototype.sampleCurveY=function(t){return((this.ay*t+this.by)*t+this.cy)*t},p.prototype.sampleCurveDerivativeX=function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},p.prototype.solveCurveX=function(t,e){var i,s,h,m,y;for(void 0===e&&(e=1e-6),h=t,y=0;y<8;y++){if(m=this.sampleCurveX(h)-t,Math.abs(m)<e)return h;var b=this.sampleCurveDerivativeX(h);if(Math.abs(b)<1e-6)break;h-=m/b}if((h=t)<(i=0))return i;if(h>(s=1))return s;for(;i<s;){if(m=this.sampleCurveX(h),Math.abs(m-t)<e)return h;t>m?i=h:s=h,h=.5*(s-i)+i}return h},p.prototype.solve=function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))};var L=Q;function Q(t,e){this.x=t,this.y=e}Q.prototype={clone:function(){return new Q(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),s=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=s,this},_rotateAround:function(t,e){var i=Math.cos(t),s=Math.sin(t),h=e.y+s*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-s*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Q.convert=function(t){return t instanceof Q?t:Array.isArray(t)?new Q(t[0],t[1]):t};var Z="undefined"!=typeof self?self:{},z=1e-6,G="undefined"!=typeof Float32Array?Float32Array:Array;function te(){var t=new G(9);return G!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function ye(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function me(t,e,i){var s=e[0],h=e[1],m=e[2],y=e[3],b=e[4],C=e[5],M=e[6],N=e[7],j=e[8],H=e[9],pe=e[10],be=e[11],Le=e[12],qe=e[13],it=e[14],yt=e[15],Mt=i[0],Nt=i[1],Vt=i[2],jt=i[3];return t[0]=Mt*s+Nt*b+Vt*j+jt*Le,t[1]=Mt*h+Nt*C+Vt*H+jt*qe,t[2]=Mt*m+Nt*M+Vt*pe+jt*it,t[3]=Mt*y+Nt*N+Vt*be+jt*yt,t[4]=(Mt=i[4])*s+(Nt=i[5])*b+(Vt=i[6])*j+(jt=i[7])*Le,t[5]=Mt*h+Nt*C+Vt*H+jt*qe,t[6]=Mt*m+Nt*M+Vt*pe+jt*it,t[7]=Mt*y+Nt*N+Vt*be+jt*yt,t[8]=(Mt=i[8])*s+(Nt=i[9])*b+(Vt=i[10])*j+(jt=i[11])*Le,t[9]=Mt*h+Nt*C+Vt*H+jt*qe,t[10]=Mt*m+Nt*M+Vt*pe+jt*it,t[11]=Mt*y+Nt*N+Vt*be+jt*yt,t[12]=(Mt=i[12])*s+(Nt=i[13])*b+(Vt=i[14])*j+(jt=i[15])*Le,t[13]=Mt*h+Nt*C+Vt*H+jt*qe,t[14]=Mt*m+Nt*M+Vt*pe+jt*it,t[15]=Mt*y+Nt*N+Vt*be+jt*yt,t}function Ee(t,e,i){var s,h,m,y,b,C,M,N,j,H,pe,be,Le=i[0],qe=i[1],it=i[2];return e===t?(t[12]=e[0]*Le+e[4]*qe+e[8]*it+e[12],t[13]=e[1]*Le+e[5]*qe+e[9]*it+e[13],t[14]=e[2]*Le+e[6]*qe+e[10]*it+e[14],t[15]=e[3]*Le+e[7]*qe+e[11]*it+e[15]):(h=e[1],m=e[2],y=e[3],b=e[4],C=e[5],M=e[6],N=e[7],j=e[8],H=e[9],pe=e[10],be=e[11],t[0]=s=e[0],t[1]=h,t[2]=m,t[3]=y,t[4]=b,t[5]=C,t[6]=M,t[7]=N,t[8]=j,t[9]=H,t[10]=pe,t[11]=be,t[12]=s*Le+b*qe+j*it+e[12],t[13]=h*Le+C*qe+H*it+e[13],t[14]=m*Le+M*qe+pe*it+e[14],t[15]=y*Le+N*qe+be*it+e[15]),t}function je(t,e,i){var s=i[0],h=i[1],m=i[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*h,t[5]=e[5]*h,t[6]=e[6]*h,t[7]=e[7]*h,t[8]=e[8]*m,t[9]=e[9]*m,t[10]=e[10]*m,t[11]=e[11]*m,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function rt(t,e,i){var s=Math.sin(i),h=Math.cos(i),m=e[4],y=e[5],b=e[6],C=e[7],M=e[8],N=e[9],j=e[10],H=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=m*h+M*s,t[5]=y*h+N*s,t[6]=b*h+j*s,t[7]=C*h+H*s,t[8]=M*h-m*s,t[9]=N*h-y*s,t[10]=j*h-b*s,t[11]=H*h-C*s,t}function Ae(t,e,i){var s=Math.sin(i),h=Math.cos(i),m=e[0],y=e[1],b=e[2],C=e[3],M=e[8],N=e[9],j=e[10],H=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=m*h-M*s,t[1]=y*h-N*s,t[2]=b*h-j*s,t[3]=C*h-H*s,t[8]=m*s+M*h,t[9]=y*s+N*h,t[10]=b*s+j*h,t[11]=C*s+H*h,t}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var Ze=me;function Ve(){var t=new G(3);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function He(t){var e=new G(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ne(t){return Math.hypot(t[0],t[1],t[2])}function xt(t,e,i){var s=new G(3);return s[0]=t,s[1]=e,s[2]=i,s}function Je(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function ct(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function wt(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function Tt(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function Ct(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function gt(t,e,i,s){return t[0]=e[0]+i[0]*s,t[1]=e[1]+i[1]*s,t[2]=e[2]+i[2]*s,t}function Lt(t,e){var i=e[0],s=e[1],h=e[2],m=i*i+s*s+h*h;return m>0&&(m=1/Math.sqrt(m)),t[0]=e[0]*m,t[1]=e[1]*m,t[2]=e[2]*m,t}function Ht(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Vn(t,e,i){var s=e[0],h=e[1],m=e[2],y=i[0],b=i[1],C=i[2];return t[0]=h*C-m*b,t[1]=m*y-s*C,t[2]=s*b-h*y,t}function Ft(t,e,i){var s=e[0],h=e[1],m=e[2],y=i[3]*s+i[7]*h+i[11]*m+i[15];return t[0]=(i[0]*s+i[4]*h+i[8]*m+i[12])/(y=y||1),t[1]=(i[1]*s+i[5]*h+i[9]*m+i[13])/y,t[2]=(i[2]*s+i[6]*h+i[10]*m+i[14])/y,t}function Wt(t,e,i){var s=i[0],h=i[1],m=i[2],y=e[0],b=e[1],C=e[2],M=h*C-m*b,N=m*y-s*C,j=s*b-h*y,H=h*j-m*N,pe=m*M-s*j,be=s*N-h*M,Le=2*i[3];return N*=Le,j*=Le,pe*=2,be*=2,t[0]=y+(M*=Le)+(H*=2),t[1]=b+N+pe,t[2]=C+j+be,t}var Gt,t,Jt=ct,an=wt,Jn=Ne;function si(t,e,i){var s=e[0],h=e[1],m=e[2],y=e[3];return t[0]=i[0]*s+i[4]*h+i[8]*m+i[12]*y,t[1]=i[1]*s+i[5]*h+i[9]*m+i[13]*y,t[2]=i[2]*s+i[6]*h+i[10]*m+i[14]*y,t[3]=i[3]*s+i[7]*h+i[11]*m+i[15]*y,t}function di(){var t=new G(4);return G!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Bn(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function ln(t,e,i){i*=.5;var s=e[0],h=e[1],m=e[2],y=e[3],b=Math.sin(i),C=Math.cos(i);return t[0]=s*C+y*b,t[1]=h*C+m*b,t[2]=m*C-h*b,t[3]=y*C-s*b,t}function Et(t,e){return t[0]===e[0]&&t[1]===e[1]}Ve(),Gt=new G(4),G!=Float32Array&&(Gt[0]=0,Gt[1]=0,Gt[2]=0,Gt[3]=0),Ve(),xt(1,0,0),xt(0,1,0),di(),di(),te(),t=new G(2),G!=Float32Array&&(t[0]=0,t[1]=0);const Kt=Math.PI/180,Hn=180/Math.PI;function In(t){return t*Kt}function ti(t){return t*Hn}const mi=[[0,0],[1,0],[1,1],[0,1]];function ir(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}function _r(t,e,i,s){const h=new A(t,e,i,s);return function(m){return h.solve(m)}}const er=_r(.25,.1,.25,1);function Ri(t,e,i){return Math.min(i,Math.max(e,t))}function mr(t,e,i){return(i=Ri((i-t)/(e-t),0,1))*i*(3-2*i)}function Si(t,e,i){const s=i-e,h=((t-e)%s+s)%s+e;return h===e?i:h}function ki(t,e,i){if(!t.length)return i(null,[]);let s=t.length;const h=new Array(t.length);let m=null;t.forEach((y,b)=>{e(y,(C,M)=>{C&&(m=C),h[b]=M,0==--s&&i(m,h)})})}function Qt(t){const e=[];for(const i in t)e.push(t[i]);return e}function et(t,...e){for(const i of e)for(const s in i)t[s]=i[s];return t}let de=1;function Pe(){return de++}function ft(){return function t(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Be(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function $t(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function xe(t,e){t.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function Ie(t,e){return-1!==t.indexOf(e,t.length-e.length)}function Ut(t,e,i){const s={};for(const h in t)s[h]=e.call(i||this,t[h],h,t);return s}function nn(t,e,i){const s={};for(const h in t)e.call(i||this,t[h],h,t)&&(s[h]=t[h]);return s}function ni(t){return Array.isArray(t)?t.map(ni):"object"==typeof t&&t?Ut(t,ni):t}const cr={};function Li(t){cr[t]||("undefined"!=typeof console&&console.warn(t),cr[t]=!0)}function Ei(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function xi(t){let e=0;for(let i,s,h=0,m=t.length,y=m-1;h<m;y=h++)i=t[h],s=t[y],e+=(s.x-i.x)*(i.y+s.y);return e}function vr(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function ji(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,s,h,m)=>{const y=h||m;return e[s]=!y||y.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Ir,$i,Gr,eo=null;function zr(t){if(null==eo){const e=t.navigator?t.navigator.userAgent:null;eo=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return eo}function Xi(t){try{const e=Z[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const ur={now:()=>void 0!==Gr?Gr:Z.performance.now(),setNow(t){Gr=t},restoreNow(){Gr=void 0},frame(t){const e=Z.requestAnimationFrame(t);return{cancel:()=>Z.cancelAnimationFrame(e)}},getImageData(t,e=0){const i=Z.document.createElement("canvas"),s=i.getContext("2d");if(!s)throw new Error("failed to create canvas 2d context");return i.width=t.width,i.height=t.height,s.drawImage(t,0,0,t.width,t.height),s.getImageData(-e,-e,t.width+2*e,t.height+2*e)},resolveURL:t=>(Ir||(Ir=Z.document.createElement("a")),Ir.href=t,Ir.href),get devicePixelRatio(){return Z.devicePixelRatio},get prefersReducedMotion(){return!!Z.matchMedia&&(null==$i&&($i=Z.matchMedia("(prefers-reduced-motion: reduce)")),$i.matches)}};let re;const K={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==re){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{re=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch{re=t}}return re},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},F={supported:!1,testSupport:function(t){!Qe&&_e&&(vt?kt(t):fe=t)}};let fe,_e,Qe=!1,vt=!1;function kt(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,_e),t.isContextLost())return;F.supported=!0}catch{}t.deleteTexture(e),Qe=!0}Z.document&&(_e=Z.document.createElement("img"),_e.onload=function(){fe&&kt(fe),fe=null,vt=!0},_e.onerror=function(){Qe=!0,fe=null},_e.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const tt="01",Zt="NO_ACCESS_TOKEN";function on(t){return 0===t.indexOf("mapbox:")}function sn(t){return K.API_URL_REGEX.test(t)}const gn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Nn(t){const e=t.match(gn);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Wn(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function ai(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Z.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Kn{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=ai(K.ACCESS_TOKEN);let s="";return s=i&&i.u?Z.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(h,m)=>String.fromCharCode(Number("0x"+m)))):K.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=Xi("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const h=Z.localStorage.getItem(i);h&&(this.eventData=JSON.parse(h));const m=Z.localStorage.getItem(s);m&&(this.anonId=m)}catch{Li("Unable to read from LocalStorage")}}saveEventData(){const e=Xi("localStorage"),i=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{Z.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&Z.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{Li("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,s,h){if(!K.EVENTS_URL)return;const m=Nn(K.EVENTS_URL);m.params.push(`access_token=${h||K.ACCESS_TOKEN||""}`);const y={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:O,skuId:tt,userId:this.anonId},b=i?et(y,i):y,C={url:Wn(m),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};this.pendingRequest=Pr(C,M=>{this.pendingRequest=null,s(M),this.saveEventData(),this.processRequests(h)})}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const ui=new class extends Kn{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){K.EVENTS_URL&&K.ACCESS_TOKEN&&Array.isArray(t)&&t.some(i=>on(i)||sn(i))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=ai(K.ACCESS_TOKEN),i=e?e.u:K.ACCESS_TOKEN;let s=i!==this.eventData.tokenU;$t(this.anonId)||(this.anonId=ft(),s=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const m=new Date(this.eventData.lastSuccess),y=new Date(h),b=(h-this.eventData.lastSuccess)/864e5;s=s||b>=1||b<-1||m.getDate()!==y.getDate()}else s=!0;if(!s)return this.processRequests();this.postEvent(h,{"enabled.telemetry":!1},m=>{m||(this.eventData.lastSuccess=h,this.eventData.tokenU=i)},t)}},Qi=ui.postTurnstileEvent.bind(ui),Hi=new class extends Kn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,i,s){this.skuToken=e,this.errorCb=s,K.EVENTS_URL&&(i||K.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(Zt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),$t(this.anonId)||(this.anonId=ft()),this.postEvent(i,{skuToken:this.skuToken},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t))}},vi=Hi.postMapLoadEvent.bind(Hi),Pn=new class extends Kn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,i,s){if(!K.API_URL||!K.SESSION_PATH)return;const h=Nn(K.API_URL+K.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${s||K.ACCESS_TOKEN||""}`);const m={url:Wn(h),headers:{"Content-Type":"text/plain"}};this.pendingRequest=Se(m,y=>{this.pendingRequest=null,i(y),this.saveEventData(),this.processRequests(s)})}getSessionAPI(t,e,i,s){this.skuToken=e,this.errorCb=s,K.SESSION_PATH&&K.API_URL&&(i||K.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(Zt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t)}},Ai=Pn.getSessionAPI.bind(Pn),Bi=new Set,Gi="mapbox-tiles";let Ar,hi,Cr=500,xr=50;function qr(){Z.caches&&!Ar&&(Ar=Z.caches.open(Gi))}function Ao(t){const e=t.indexOf("?");return e<0?t:t.slice(0,e)}let Oi=1/0;const yo={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(yo);class to extends Error{constructor(e,i,s){401===i&&sn(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const uo=vr()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Z.location.protocol?Z.parent:Z).location.href,Lr=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(uo())&&!/^\w+:/.test(i))){if(Z.fetch&&Z.Request&&Z.AbortController&&Z.Request.prototype.hasOwnProperty("signal"))return function(s,h){const m=new Z.AbortController,y=new Z.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:uo(),signal:m.signal});let b=!1,C=!1;const M=(N=y.url).indexOf("sku=")>0&&sn(N);var N;"json"===s.type&&y.headers.set("Accept","application/json");const j=(pe,be,Le)=>{if(C)return;if(pe&&"SecurityError"!==pe.message&&Li(pe),be&&Le)return H(be);const qe=Date.now();Z.fetch(y).then(it=>{if(it.ok){const yt=M?it.clone():null;return H(it,yt,qe)}return h(new to(it.statusText,it.status,s.url))}).catch(it=>{20!==it.code&&h(new Error(it.message))})},H=(pe,be,Le)=>{("arrayBuffer"===s.type?pe.arrayBuffer():"json"===s.type?pe.json():pe.text()).then(qe=>{C||(be&&Le&&function(it,yt,Mt){if(qr(),!Ar)return;const Nt={status:yt.status,statusText:yt.statusText,headers:new Z.Headers};yt.headers.forEach((jt,wn)=>Nt.headers.set(wn,jt));const Vt=ji(yt.headers.get("Cache-Control")||"");Vt["no-store"]||(Vt["max-age"]&&Nt.headers.set("Expires",new Date(Mt+1e3*Vt["max-age"]).toUTCString()),new Date(Nt.headers.get("Expires")).getTime()-Mt<42e4||function(jt,wn){if(void 0===hi)try{new Response(new ReadableStream),hi=!0}catch{hi=!1}hi?wn(jt.body):jt.blob().then(wn)}(yt,jt=>{const wn=new Z.Response(jt,Nt);qr(),Ar&&Ar.then(vn=>vn.put(Ao(it.url),wn)).catch(vn=>Li(vn.message))}))}(y,be,Le),b=!0,h(null,qe,pe.headers.get("Cache-Control"),pe.headers.get("Expires")))}).catch(qe=>{C||h(new Error(qe.message))})};return M?function(pe,be){if(qr(),!Ar)return be(null);const Le=Ao(pe.url);Ar.then(qe=>{qe.match(Le).then(it=>{const yt=function(Mt){if(!Mt)return!1;const Nt=new Date(Mt.headers.get("Expires")||0),Vt=ji(Mt.headers.get("Cache-Control")||"");return Nt>Date.now()&&!Vt["no-cache"]}(it);qe.delete(Le),yt&&qe.put(Le,it.clone()),be(null,it,yt)}).catch(be)}).catch(be)}(y,j):j(null,null),{cancel:()=>{C=!0,b||m.abort()}}}(t,e);if(vr()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(s,h){const m=new Z.XMLHttpRequest;m.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(m.responseType="arraybuffer");for(const y in s.headers)m.setRequestHeader(y,s.headers[y]);return"json"===s.type&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials="include"===s.credentials,m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||0===m.status)&&null!==m.response){let y=m.response;if("json"===s.type)try{y=JSON.parse(m.response)}catch(b){return h(b)}h(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else h(new to(m.statusText,m.status,s.url))},m.send(s.body),{cancel:()=>m.abort()}}(t,e)},Sr=function(t,e){return Lr(et(t,{type:"arrayBuffer"}),e)},Pr=function(t,e){return Lr(et(t,{method:"POST"}),e)},Se=function(t,e){return Lr(et(t,{method:"GET"}),e)};function Xe(t){const e=Z.document.createElement("a");return e.href=t,e.protocol===Z.document.location.protocol&&e.host===Z.document.location.host}const Me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let st,Rt;st=[],Rt=0;const zt=function(t,e){if(F.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),Rt>=K.MAX_PARALLEL_IMAGE_REQUESTS){const m={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return st.push(m),m}Rt++;let i=!1;const s=()=>{if(!i)for(i=!0,Rt--;st.length&&Rt<K.MAX_PARALLEL_IMAGE_REQUESTS;){const m=st.shift(),{requestParameters:y,callback:b,cancelled:C}=m;C||(m.cancel=zt(y,b).cancel)}},h=Sr(t,(m,y,b,C)=>{s(),m?e(m):y&&(Z.createImageBitmap?function(M,N){const j=new Z.Blob([new Uint8Array(M)],{type:"image/png"});Z.createImageBitmap(j).then(H=>{N(null,H)}).catch(H=>{N(new Error(`Could not load image because of ${H.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(y,(M,N)=>e(M,N,b,C)):function(M,N){const j=new Z.Image,H=Z.URL;j.onload=()=>{N(null,j),H.revokeObjectURL(j.src),j.onload=null,Z.requestAnimationFrame(()=>{j.src=Me})},j.onerror=()=>N(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const pe=new Z.Blob([new Uint8Array(M)],{type:"image/png"});j.src=M.byteLength?H.createObjectURL(pe):Me}(y,(M,N)=>e(M,N,b,C)))});return{cancel:()=>{h.cancel(),s()}}};function rn(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function un(t,e,i){if(i&&i[t]){const s=i[t].indexOf(e);-1!==s&&i[t].splice(s,1)}}class dn{constructor(e,i={}){et(this,i),this.type=e}}class An extends dn{constructor(e,i={}){super("error",et({error:e},i))}}class qn{on(e,i){return this._listeners=this._listeners||{},rn(e,i,this._listeners),this}off(e,i){return un(e,i,this._listeners),un(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},rn(e,i,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,i){"string"==typeof e&&(e=new dn(e,i||{}));const s=e.type;if(this.listens(s)){e.target=this;const h=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const b of h)b.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const b of m)un(s,b,this._oneTimeListeners),b.call(this,e);const y=this._eventedParent;y&&(et(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof An&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var Bt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":0.1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":true,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"cross-faded"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"cross-faded":{"type":"property-type"},"cross-faded-data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');class hn{constructor(e,i,s,h){this.message=(e?`${e}: `:"")+s,h&&(this.identifier=h),null!=i&&i.__line__&&(this.line=i.__line__)}}function qi(t){const e=t.value;return e?[new hn(t.key,e,"constants have been deprecated as of v8")]:[]}function no(t,...e){for(const i of e)for(const s in i)t[s]=i[s];return t}function rr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Br(t){if(Array.isArray(t))return t.map(Br);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=Br(t[i]);return e}return rr(t)}class pr extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}class Lo{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[s,h]of i)this.bindings[s]=h}concat(e){return new Lo(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const mo={kind:"null"},jn={kind:"number"},Wi={kind:"string"},Ui={kind:"boolean"},wo={kind:"color"},at={kind:"object"},nt={kind:"value"},ke={kind:"collator"},At={kind:"formatted"},en={kind:"resolvedImage"};function pi(t,e){return{kind:"array",itemType:t,N:e}}function fi(t){if("array"===t.kind){const e=fi(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const Ur=[mo,jn,Wi,Ui,wo,At,at,pi(nt),en];function ie(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!ie(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const i of Ur)if(!ie(i,e))return null}return`Expected ${fi(t)} but found ${fi(e)} instead.`}function ue(t,e){return e.some(i=>i.kind===t.kind)}function we(t,e){return e.some(i=>"null"===i?null===t:"array"===i?Array.isArray(t):"object"===i?t&&!Array.isArray(t)&&"object"==typeof t:i===typeof t)}function Oe(t){var e={exports:{}};return t(e,e.exports),e.exports}var Dt=Oe(function(t,e){var i={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function s(b){return(b=Math.round(b))<0?0:b>255?255:b}function h(b){return s("%"===b[b.length-1]?parseFloat(b)/100*255:parseInt(b))}function m(b){return(C="%"===b[b.length-1]?parseFloat(b)/100:parseFloat(b))<0?0:C>1?1:C;var C}function y(b,C,M){return M<0?M+=1:M>1&&(M-=1),6*M<1?b+(C-b)*M*6:2*M<1?C:3*M<2?b+(C-b)*(2/3-M)*6:b}try{e.parseCSSColor=function(b){var C,M=b.replace(/ /g,"").toLowerCase();if(M in i)return i[M].slice();if("#"===M[0])return 4===M.length?(C=parseInt(M.substr(1),16))>=0&&C<=4095?[(3840&C)>>4|(3840&C)>>8,240&C|(240&C)>>4,15&C|(15&C)<<4,1]:null:7===M.length&&(C=parseInt(M.substr(1),16))>=0&&C<=16777215?[(16711680&C)>>16,(65280&C)>>8,255&C,1]:null;var N=M.indexOf("("),j=M.indexOf(")");if(-1!==N&&j+1===M.length){var H=M.substr(0,N),pe=M.substr(N+1,j-(N+1)).split(","),be=1;switch(H){case"rgba":if(4!==pe.length)return null;be=m(pe.pop());case"rgb":return 3!==pe.length?null:[h(pe[0]),h(pe[1]),h(pe[2]),be];case"hsla":if(4!==pe.length)return null;be=m(pe.pop());case"hsl":if(3!==pe.length)return null;var Le=(parseFloat(pe[0])%360+360)%360/360,qe=m(pe[1]),it=m(pe[2]),yt=it<=.5?it*(qe+1):it+qe-it*qe,Mt=2*it-yt;return[s(255*y(Mt,yt,Le+1/3)),s(255*y(Mt,yt,Le)),s(255*y(Mt,yt,Le-1/3)),be];default:return null}}return null}}catch{}});class ht{constructor(e,i,s,h=1){this.r=e,this.g=i,this.b=s,this.a=h}static parse(e){if(!e)return;if(e instanceof ht)return e;if("string"!=typeof e)return;const i=Dt.parseCSSColor(e);return i?new ht(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,s,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(s)},${h})`}toArray(){const{r:e,g:i,b:s,a:h}=this;return 0===h?[0,0,0,0]:[255*e/h,255*i/h,255*s/h,h]}}ht.black=new ht(0,0,0,1),ht.white=new ht(1,1,1,1),ht.transparent=new ht(0,0,0,0),ht.red=new ht(1,0,0,1),ht.blue=new ht(0,0,1,1);class fn{constructor(e,i,s){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Dn{constructor(e,i,s,h,m){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=s,this.fontStack=h,this.textColor=m}}class yn{constructor(e){this.sections=e}static fromString(e){return new yn([new Dn(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof yn?e:yn.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const s={};i.fontStack&&(s["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(s["font-scale"]=i.scale),i.textColor&&(s["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(s)}return e}}class oi{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new oi({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Pi(t,e,i,s){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[t,e,i,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[t,e,i,s]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Mi(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof ht||t instanceof fn||t instanceof yn||t instanceof oi)return!0;if(Array.isArray(t)){for(const e of t)if(!Mi(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!Mi(t[e]))return!1;return!0}return!1}function bi(t){if(null===t)return mo;if("string"==typeof t)return Wi;if("boolean"==typeof t)return Ui;if("number"==typeof t)return jn;if(t instanceof ht)return wo;if(t instanceof fn)return ke;if(t instanceof yn)return At;if(t instanceof oi)return en;if(Array.isArray(t)){const e=t.length;let i;for(const s of t){const h=bi(s);if(i){if(i===h)continue;i=nt;break}i=h}return pi(i||nt,e)}return at}function gr(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof ht||t instanceof yn||t instanceof oi?t.toString():JSON.stringify(t)}class Di{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(2!==e.length)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Mi(e[1]))return i.error("invalid value");const s=e[1];let h=bi(s);const m=i.expectedType;return"array"!==h.kind||0!==h.N||!m||"array"!==m.kind||"number"==typeof m.N&&0!==m.N||(h=m),new Di(h,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof ht?["rgba"].concat(this.value.toArray()):this.value instanceof yn?this.value.serialize():this.value}}class Ci{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const dr={string:Wi,number:jn,boolean:Ui,object:at};class nr{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let s,h=1;const m=e[0];if("array"===m){let b,C;if(e.length>2){const M=e[1];if("string"!=typeof M||!(M in dr)||"object"===M)return i.error('The item type argument of "array" must be one of string, number, boolean',1);b=dr[M],h++}else b=nt;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);C=e[2],h++}s=pi(b,C)}else s=dr[m];const y=[];for(;h<e.length;h++){const b=i.parse(e[h],h,nt);if(!b)return null;y.push(b)}return new nr(s,y)}evaluate(e){for(let i=0;i<this.args.length;i++){const s=this.args[i].evaluate(e);if(!ie(this.type,bi(s)))return s;if(i===this.args.length-1)throw new Ci(`Expected value to be of type ${fi(this.type)}, but found ${fi(bi(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){i.push(s.kind);const h=e.N;("number"==typeof h||this.args.length>1)&&i.push(h)}}return i.concat(this.args.map(s=>s.serialize()))}}class io{constructor(e){this.type=At,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return i.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=e.length-1;++y){const b=e[y];if(m&&"object"==typeof b&&!Array.isArray(b)){m=!1;let C=null;if(b["font-scale"]&&(C=i.parse(b["font-scale"],1,jn),!C))return null;let M=null;if(b["text-font"]&&(M=i.parse(b["text-font"],1,pi(Wi)),!M))return null;let N=null;if(b["text-color"]&&(N=i.parse(b["text-color"],1,wo),!N))return null;const j=h[h.length-1];j.scale=C,j.font=M,j.textColor=N}else{const C=i.parse(e[y],1,nt);if(!C)return null;const M=C.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:C,scale:null,font:null,textColor:null})}}return new io(h)}evaluate(e){return new yn(this.sections.map(i=>{const s=i.content.evaluate(e);return bi(s)===en?new Dn("",s,null,null,null):new Dn(gr(s),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const s={};i.scale&&(s["font-scale"]=i.scale.serialize()),i.font&&(s["text-font"]=i.font.serialize()),i.textColor&&(s["text-color"]=i.textColor.serialize()),e.push(s)}return e}}class ho{constructor(e){this.type=en,this.input=e}static parse(e,i){if(2!==e.length)return i.error("Expected two arguments.");const s=i.parse(e[1],1,Wi);return s?new ho(s):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),s=oi.fromString(i);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(i)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Hr={"to-boolean":Ui,"to-color":wo,"to-number":jn,"to-string":Wi};class go{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return i.error("Expected one argument.");const h=Hr[s],m=[];for(let y=1;y<e.length;y++){const b=i.parse(e[y],y,nt);if(!b)return null;m.push(b)}return new go(h,m)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let i,s;for(const h of this.args){if(i=h.evaluate(e),s=null,i instanceof ht)return i;if("string"==typeof i){const m=e.parseColor(i);if(m)return m}else if(Array.isArray(i)&&(s=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:Pi(i[0],i[1],i[2],i[3]),!s))return new ht(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Ci(s||`Could not parse color from value '${"string"==typeof i?i:String(JSON.stringify(i))}'`)}if("number"===this.type.kind){let i=null;for(const s of this.args){if(i=s.evaluate(e),null===i)return 0;const h=Number(i);if(!isNaN(h))return h}throw new Ci(`Could not convert ${JSON.stringify(i)} to number.`)}return"formatted"===this.type.kind?yn.fromString(gr(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?oi.fromString(gr(this.args[0].evaluate(e))):gr(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new io([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ho(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}const Wr=["Unknown","Point","LineString","Polygon"];class se{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Wr[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const e=this.featureDistanceData.center,i=this.featureDistanceData.scale,{x:s,y:h}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*i-e[0])+this.featureDistanceData.bearing[1]*(h*i-e[1])}return 0}parseColor(e){let i=this._parseColorCache[e];return i||(i=this._parseColorCache[e]=ht.parse(e)),i}}class Ce{constructor(e,i,s,h){this.name=e,this.type=i,this._evaluate=s,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const s=e[0],h=Ce.definitions[s];if(!h)return i.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,b=y.filter(([M])=>!Array.isArray(M)||M.length===e.length-1);let C=null;for(const[M,N]of b){C=new Ps(i.registry,i.path,null,i.scope);const j=[];let H=!1;for(let pe=1;pe<e.length;pe++){const be=e[pe],Le=Array.isArray(M)?M[pe-1]:M.type,qe=C.parse(be,1+j.length,Le);if(!qe){H=!0;break}j.push(qe)}if(!H)if(Array.isArray(M)&&M.length!==j.length)C.error(`Expected ${M.length} arguments, but found ${j.length} instead.`);else{for(let pe=0;pe<j.length;pe++){const be=Array.isArray(M)?M[pe]:M.type,Le=j[pe];C.concat(pe+1).checkSubtype(be,Le.type)}if(0===C.errors.length)return new Ce(s,m,N,j)}}if(1===b.length)i.errors.push(...C.errors);else{const M=(b.length?b:y).map(([j])=>{return H=j,Array.isArray(H)?`(${H.map(fi).join(", ")})`:`(${fi(H.type)}...)`;var H}).join(" | "),N=[];for(let j=1;j<e.length;j++){const H=i.parse(e[j],1+N.length);if(!H)return null;N.push(fi(H.type))}i.error(`Expected arguments of type ${M}, but found (${N.join(", ")}) instead.`)}return null}static register(e,i){Ce.definitions=i;for(const s in i)e[s]=Ce}}class ae{constructor(e,i,s){this.type=ke,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(2!==e.length)return i.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return i.error("Collator options argument must be an object.");const h=i.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,Ui);if(!h)return null;const m=i.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,Ui);if(!m)return null;let y=null;return s.locale&&(y=i.parse(s.locale,1,Wi),!y)?null:new ae(h,m,y)}evaluate(e){return new fn(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const ze=8192;function St(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function tn(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function Ln(t,e){const i=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(i*h*ze),Math.round(s*h*ze)]}function Yn(t,e,i){const s=t[0]-e[0],h=t[1]-e[1],m=t[0]-i[0],y=t[1]-i[1];return s*y-m*h==0&&s*m<=0&&h*y<=0}function Mr(t,e){let i=!1;for(let y=0,b=e.length;y<b;y++){const C=e[y];for(let M=0,N=C.length;M<N-1;M++){if(Yn(t,C[M],C[M+1]))return!1;(h=C[M])[1]>(s=t)[1]!=(m=C[M+1])[1]>s[1]&&s[0]<(m[0]-h[0])*(s[1]-h[1])/(m[1]-h[1])+h[0]&&(i=!i)}}var s,h,m;return i}function Fr(t,e){for(let i=0;i<e.length;i++)if(Mr(t,e[i]))return!0;return!1}function Zi(t,e,i,s){const h=s[0]-i[0],m=s[1]-i[1],y=(t[0]-i[0])*m-h*(t[1]-i[1]),b=(e[0]-i[0])*m-h*(e[1]-i[1]);return y>0&&b<0||y<0&&b>0}function Er(t,e,i){for(const M of i)for(let N=0;N<M.length-1;++N)if((b=[(y=M[N+1])[0]-(m=M[N])[0],y[1]-m[1]])[0]*(C=[(h=e)[0]-(s=t)[0],h[1]-s[1]])[1]-b[1]*C[0]!=0&&Zi(s,h,m,y)&&Zi(m,y,s,h))return!0;var s,h,m,y,b,C;return!1}function vo(t,e){for(let i=0;i<t.length;++i)if(!Mr(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Er(t[i],t[i+1],e))return!1;return!0}function le(t,e){for(let i=0;i<e.length;i++)if(vo(t,e[i]))return!0;return!1}function ee(t,e,i){const s=[];for(let h=0;h<t.length;h++){const m=[];for(let y=0;y<t[h].length;y++){const b=Ln(t[h][y],i);St(e,b),m.push(b)}s.push(m)}return s}function ne(t,e,i){const s=[];for(let h=0;h<t.length;h++){const m=ee(t[h],e,i);s.push(m)}return s}function Ue(t,e,i,s){if(t[0]<i[0]||t[0]>i[2]){const h=.5*s;let m=t[0]-i[0]>h?-s:i[0]-t[0]>h?s:0;0===m&&(m=t[0]-i[2]>h?-s:i[2]-t[0]>h?s:0),t[0]+=m}St(e,t)}function pn(t,e,i,s){const h=Math.pow(2,s.z)*ze,m=[s.x*ze,s.y*ze],y=[];for(const b of t)for(const C of b){const M=[C.x+m[0],C.y+m[1]];Ue(M,e,i,h),y.push(M)}return y}function ri(t,e,i,s){const h=Math.pow(2,s.z)*ze,m=[s.x*ze,s.y*ze],y=[];for(const C of t){const M=[];for(const N of C){const j=[N.x+m[0],N.y+m[1]];St(e,j),M.push(j)}y.push(M)}if(e[2]-e[0]<=h/2){(b=e)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const C of y)for(const M of C)Ue(M,e,i,h)}var b;return y}class Yr{constructor(e,i){this.type=Ui,this.geojson=e,this.geometries=i}static parse(e,i){if(2!==e.length)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Mi(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let h=0;h<s.features.length;++h){const m=s.features[h].geometry.type;if("Polygon"===m||"MultiPolygon"===m)return new Yr(s,s.features[h].geometry)}else if("Feature"===s.type){const h=s.geometry.type;if("Polygon"===h||"MultiPolygon"===h)return new Yr(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new Yr(s,s)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(i,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if("Polygon"===s.type){const b=ee(s.coordinates,m,y),C=pn(i.geometry(),h,m,y);if(!tn(h,m))return!1;for(const M of C)if(!Mr(M,b))return!1}if("MultiPolygon"===s.type){const b=ne(s.coordinates,m,y),C=pn(i.geometry(),h,m,y);if(!tn(h,m))return!1;for(const M of C)if(!Fr(M,b))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(i,s){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=i.canonicalID();if("Polygon"===s.type){const b=ee(s.coordinates,m,y),C=ri(i.geometry(),h,m,y);if(!tn(h,m))return!1;for(const M of C)if(!vo(M,b))return!1}if("MultiPolygon"===s.type){const b=ne(s.coordinates,m,y),C=ri(i.geometry(),h,m,y);if(!tn(h,m))return!1;for(const M of C)if(!le(M,b))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function Jr(t){if(t instanceof Ce&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Yr)return!1;let e=!0;return t.eachChild(i=>{e&&!Jr(i)&&(e=!1)}),e}function es(t){if(t instanceof Ce&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(i=>{e&&!es(i)&&(e=!1)}),e}function jo(t,e){if(t instanceof Ce&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild(s=>{i&&!jo(s,e)&&(i=!1)}),i}class zs{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(2!==e.length||"string"!=typeof e[1])return i.error("'var' expression requires exactly one string literal argument.");const s=e[1];return i.scope.has(s)?new zs(s,i.scope.get(s)):i.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class Ps{constructor(e,i=[],s,h=new Lo,m=[]){this.registry=e,this.path=i,this.key=i.map(y=>`[${y}]`).join(""),this.scope=h,this.errors=m,this.expectedType=s}parse(e,i,s,h,m={}){return i?this.concat(i,s,h)._parse(e,m):this._parse(e,m)}_parse(e,i){function s(h,m,y){return"assert"===y?new nr(m,[h]):"coerce"===y?new go(m,[h]):h}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if("string"!=typeof h)return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const b=this.expectedType,C=y.type;if("string"!==b.kind&&"number"!==b.kind&&"boolean"!==b.kind&&"object"!==b.kind&&"array"!==b.kind||"value"!==C.kind)if("color"!==b.kind&&"formatted"!==b.kind&&"resolvedImage"!==b.kind||"value"!==C.kind&&"string"!==C.kind){if(this.checkSubtype(b,C))return null}else y=s(y,b,i.typeAnnotation||"coerce");else y=s(y,b,i.typeAnnotation||"assert")}if(!(y instanceof Di)&&"resolvedImage"!==y.type.kind&&tr(y)){const b=new se;try{y=new Di(y.type,y.evaluate(b))}catch(C){return this.error(C.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,s){const h="number"==typeof e?this.path.concat(e):this.path,m=s?this.scope.concat(s):this.scope;return new Ps(this.registry,h,i||null,m,this.errors)}error(e,...i){const s=`${this.key}${i.map(h=>`[${h}]`).join("")}`;this.errors.push(new pr(s,e))}checkSubtype(e,i){const s=ie(e,i);return s&&this.error(s),s}}function tr(t){if(t instanceof zs)return tr(t.boundExpression);if(t instanceof Ce&&"error"===t.name||t instanceof ae||t instanceof Yr)return!1;const e=t instanceof go||t instanceof nr;let i=!0;return t.eachChild(s=>{i=e?i&&tr(s):i&&s instanceof Di}),!!i&&Jr(t)&&jo(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function Pa(t,e){const i=t.length-1;let s,h,m=0,y=i,b=0;for(;m<=y;)if(b=Math.floor((m+y)/2),s=t[b],h=t[b+1],s<=e){if(b===i||e<h)return b;m=b+1}else{if(!(s>e))throw new Ci("Input is not a number.");y=b-1}return 0}class ka{constructor(e,i,s){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[h,m]of s)this.labels.push(h),this.outputs.push(m)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const s=i.parse(e[1],1,jn);if(!s)return null;const h=[];let m=null;i.expectedType&&"value"!==i.expectedType.kind&&(m=i.expectedType);for(let y=1;y<e.length;y+=2){const b=1===y?-1/0:e[y],C=e[y+1],M=y,N=y+1;if("number"!=typeof b)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(h.length&&h[h.length-1][0]>=b)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const j=i.parse(C,N,m);if(!j)return null;m=m||j.type,h.push([b,j])}return new ka(m,s,h)}evaluate(e){const i=this.labels,s=this.outputs;if(1===i.length)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return s[0].evaluate(e);const m=i.length;return h>=i[m-1]?s[m-1].evaluate(e):s[Pa(i,h)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}function Zr(t,e,i){return t*(1-i)+e*i}var ra=Object.freeze({__proto__:null,number:Zr,color:function(t,e,i){return new ht(Zr(t.r,e.r,i),Zr(t.g,e.g,i),Zr(t.b,e.b,i),Zr(t.a,e.a,i))},array:function(t,e,i){return t.map((s,h)=>Zr(s,e[h],i))}});const oa=4/29,Rn=6/29,Dr=3*Rn*Rn,Xl=Math.PI/180,Zo=180/Math.PI;function _a(t){return t>.008856451679035631?Math.pow(t,1/3):t/Dr+oa}function Gs(t){return t>Rn?t*t*t:Dr*(t-oa)}function hs(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ya(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Oa(t){const e=ya(t.r),i=ya(t.g),s=ya(t.b),h=_a((.4124564*e+.3575761*i+.1804375*s)/.95047),m=_a((.2126729*e+.7151522*i+.072175*s)/1);return{l:116*m-16,a:500*(h-m),b:200*(m-_a((.0193339*e+.119192*i+.9503041*s)/1.08883)),alpha:t.a}}function Wc(t){let e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*Gs(e),i=.95047*Gs(i),s=1.08883*Gs(s),new ht(hs(3.2404542*i-1.5371385*e-.4985314*s),hs(-.969266*i+1.8760108*e+.041556*s),hs(.0556434*i-.2040259*e+1.0572252*s),t.alpha)}function bc(t,e,i){const s=e-t;return t+i*(s>180||s<-180?s-360*Math.round(s/360):s)}const Ds={forward:Oa,reverse:Wc,interpolate:function(t,e,i){return{l:Zr(t.l,e.l,i),a:Zr(t.a,e.a,i),b:Zr(t.b,e.b,i),alpha:Zr(t.alpha,e.alpha,i)}}},qs={forward:function(t){const{l:e,a:i,b:s}=Oa(t),h=Math.atan2(s,i)*Zo;return{h:h<0?h+360:h,c:Math.sqrt(i*i+s*s),l:e,alpha:t.a}},reverse:function(t){const e=t.h*Xl,i=t.c;return Wc({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:bc(t.h,e.h,i),c:Zr(t.c,e.c,i),l:Zr(t.l,e.l,i),alpha:Zr(t.alpha,e.alpha,i)}}};var ts=Object.freeze({__proto__:null,lab:Ds,hcl:qs});class To{constructor(e,i,s,h,m){this.type=e,this.operator=i,this.interpolation=s,this.input=h,this.labels=[],this.outputs=[];for(const[y,b]of m)this.labels.push(y),this.outputs.push(b)}static interpolationFactor(e,i,s,h){let m=0;if("exponential"===e.name)m=D(i,e.base,s,h);else if("linear"===e.name)m=D(i,1,s,h);else if("cubic-bezier"===e.name){const y=e.controlPoints;m=new A(y[0],y[1],y[2],y[3]).solve(D(i,1,s,h))}return m}static parse(e,i){let[s,h,m,...y]=e;if(!Array.isArray(h)||0===h.length)return i.error("Expected an interpolation type expression.",1);if("linear"===h[0])h={name:"linear"};else if("exponential"===h[0]){const M=h[1];if("number"!=typeof M)return i.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:M}}else{if("cubic-bezier"!==h[0])return i.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const M=h.slice(1);if(4!==M.length||M.some(N=>"number"!=typeof N||N<0||N>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:M}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(m=i.parse(m,2,jn),!m)return null;const b=[];let C=null;"interpolate-hcl"===s||"interpolate-lab"===s?C=wo:i.expectedType&&"value"!==i.expectedType.kind&&(C=i.expectedType);for(let M=0;M<y.length;M+=2){const N=y[M],j=y[M+1],H=M+3,pe=M+4;if("number"!=typeof N)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',H);if(b.length&&b[b.length-1][0]>=N)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',H);const be=i.parse(j,pe,C);if(!be)return null;C=C||be.type,b.push([N,be])}return"number"===C.kind||"color"===C.kind||"array"===C.kind&&"number"===C.itemType.kind&&"number"==typeof C.N?new To(C,s,h,m,b):i.error(`Type ${fi(C)} is not interpolatable.`)}evaluate(e){const i=this.labels,s=this.outputs;if(1===i.length)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=i[0])return s[0].evaluate(e);const m=i.length;if(h>=i[m-1])return s[m-1].evaluate(e);const y=Pa(i,h),b=To.interpolationFactor(this.interpolation,h,i[y],i[y+1]),C=s[y].evaluate(e),M=s[y+1].evaluate(e);return"interpolate"===this.operator?ra[this.type.kind.toLowerCase()](C,M,b):"interpolate-hcl"===this.operator?qs.reverse(qs.interpolate(qs.forward(C),qs.forward(M),b)):Ds.reverse(Ds.interpolate(Ds.forward(C),Ds.forward(M),b))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)i.push(this.labels[s],this.outputs[s].serialize());return i}}function D(t,e,i,s){const h=s-i,m=t-i;return 0===h?0:1===e?m/h:(Math.pow(e,m)-1)/(Math.pow(e,h)-1)}class W{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let s=null;const h=i.expectedType;h&&"value"!==h.kind&&(s=h);const m=[];for(const b of e.slice(1)){const C=i.parse(b,1+m.length,s,void 0,{typeAnnotation:"omit"});if(!C)return null;s=s||C.type,m.push(C)}const y=h&&m.some(b=>ie(h,b.type));return new W(y?nt:s,m)}evaluate(e){let i,s=null,h=0;for(const m of this.args){if(h++,s=m.evaluate(e),s&&s instanceof oi&&!s.available&&(i||(i=s),s=null,h===this.args.length))return i;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class E{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if("string"!=typeof y)return i.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return i.error("Variable names must contain only alphanumeric characters or '_'.",m);const b=i.parse(e[m+1],m+1);if(!b)return null;s.push([y,b])}const h=i.parse(e[e.length-1],e.length-1,i.expectedType,s);return h?new E(s,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,s]of this.bindings)e.push(i,s.serialize());return e.push(this.result.serialize()),e}}class Y{constructor(e,i,s){this.type=e,this.index=i,this.input=s}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,jn),h=i.parse(e[2],2,pi(i.expectedType||nt));return s&&h?new Y(h.type.itemType,s,h):null}evaluate(e){const i=this.index.evaluate(e),s=this.input.evaluate(e);if(i<0)throw new Ci(`Array index out of bounds: ${i} < 0.`);if(i>=s.length)throw new Ci(`Array index out of bounds: ${i} > ${s.length-1}.`);if(i!==Math.floor(i))throw new Ci(`Array index must be an integer, but found ${i} instead.`);return s[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Te{constructor(e,i){this.type=Ui,this.needle=e,this.haystack=i}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,nt),h=i.parse(e[2],2,nt);return s&&h?ue(s.type,[Ui,Wi,jn,mo,nt])?new Te(s,h):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(s.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!s)return!1;if(!we(i,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${fi(bi(i))} instead.`);if(!we(s,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${fi(bi(s))} instead.`);return s.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class Pt{constructor(e,i,s){this.type=jn,this.needle=e,this.haystack=i,this.fromIndex=s}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,nt),h=i.parse(e[2],2,nt);if(!s||!h)return null;if(!ue(s.type,[Ui,Wi,jn,mo,nt]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${fi(s.type)} instead`);if(4===e.length){const m=i.parse(e[3],3,jn);return m?new Pt(s,h,m):null}return new Pt(s,h)}evaluate(e){const i=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!we(i,["boolean","string","number","null"]))throw new Ci(`Expected first argument to be of type boolean, string, number or null, but found ${fi(bi(i))} instead.`);if(!we(s,["string","array"]))throw new Ci(`Expected second argument to be of type array or string, but found ${fi(bi(s))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return s.indexOf(i,h)}return s.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class kn{constructor(e,i,s,h,m,y){this.inputType=e,this.type=i,this.input=s,this.cases=h,this.outputs=m,this.otherwise=y}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let s,h;i.expectedType&&"value"!==i.expectedType.kind&&(h=i.expectedType);const m={},y=[];for(let M=2;M<e.length-1;M+=2){let N=e[M];const j=e[M+1];Array.isArray(N)||(N=[N]);const H=i.concat(M);if(0===N.length)return H.error("Expected at least one branch label.");for(const be of N){if("number"!=typeof be&&"string"!=typeof be)return H.error("Branch labels must be numbers or strings.");if("number"==typeof be&&Math.abs(be)>Number.MAX_SAFE_INTEGER)return H.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof be&&Math.floor(be)!==be)return H.error("Numeric branch labels must be integer values.");if(s){if(H.checkSubtype(s,bi(be)))return null}else s=bi(be);if(void 0!==m[String(be)])return H.error("Branch labels must be unique.");m[String(be)]=y.length}const pe=i.parse(j,M,h);if(!pe)return null;h=h||pe.type,y.push(pe)}const b=i.parse(e[1],1,nt);if(!b)return null;const C=i.parse(e[e.length-1],e.length-1,h);return C?"value"!==b.type.kind&&i.concat(1).checkSubtype(s,b.type)?null:new kn(s,h,b,m,y,C):null}evaluate(e){const i=this.input.evaluate(e);return(bi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),s=[],h={};for(const y of i){const b=h[this.cases[y]];void 0===b?(h[this.cases[y]]=s.length,s.push([this.cases[y],[y]])):s[b][1].push(y)}const m=y=>"number"===this.inputType.kind?Number(y):y;for(const[y,b]of s)e.push(1===b.length?m(b[0]):b.map(m)),e.push(this.outputs[y].serialize());return e.push(this.otherwise.serialize()),e}}class Qn{constructor(e,i,s){this.type=e,this.branches=i,this.otherwise=s}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let s;i.expectedType&&"value"!==i.expectedType.kind&&(s=i.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const b=i.parse(e[y],y,Ui);if(!b)return null;const C=i.parse(e[y+1],y+1,s);if(!C)return null;h.push([b,C]),s=s||C.type}const m=i.parse(e[e.length-1],e.length-1,s);return m?new Qn(s,h,m):null}evaluate(e){for(const[i,s]of this.branches)if(i.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,s]of this.branches)e(i),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}class Yi{constructor(e,i,s,h){this.type=e,this.input=i,this.beginIndex=s,this.endIndex=h}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=i.parse(e[1],1,nt),h=i.parse(e[2],2,jn);if(!s||!h)return null;if(!ue(s.type,[pi(nt),Wi,nt]))return i.error(`Expected first argument to be of type array or string, but found ${fi(s.type)} instead`);if(4===e.length){const m=i.parse(e[3],3,jn);return m?new Yi(s.type,s,h,m):null}return new Yi(s.type,s,h)}evaluate(e){const i=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!we(i,["string","array"]))throw new Ci(`Expected first argument to be of type array or string, but found ${fi(bi(i))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return i.slice(s,h)}return i.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function wi(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function br(t,e,i,s){return 0===s.compare(e,i)}function Vr(t,e,i){const s="=="!==t&&"!="!==t;return class D0{constructor(m,y,b){this.type=Ui,this.lhs=m,this.rhs=y,this.collator=b,this.hasUntypedArgument="value"===m.type.kind||"value"===y.type.kind}static parse(m,y){if(3!==m.length&&4!==m.length)return y.error("Expected two or three arguments.");const b=m[0];let C=y.parse(m[1],1,nt);if(!C)return null;if(!wi(b,C.type))return y.concat(1).error(`"${b}" comparisons are not supported for type '${fi(C.type)}'.`);let M=y.parse(m[2],2,nt);if(!M)return null;if(!wi(b,M.type))return y.concat(2).error(`"${b}" comparisons are not supported for type '${fi(M.type)}'.`);if(C.type.kind!==M.type.kind&&"value"!==C.type.kind&&"value"!==M.type.kind)return y.error(`Cannot compare types '${fi(C.type)}' and '${fi(M.type)}'.`);s&&("value"===C.type.kind&&"value"!==M.type.kind?C=new nr(M.type,[C]):"value"!==C.type.kind&&"value"===M.type.kind&&(M=new nr(C.type,[M])));let N=null;if(4===m.length){if("string"!==C.type.kind&&"string"!==M.type.kind&&"value"!==C.type.kind&&"value"!==M.type.kind)return y.error("Cannot use collator to compare non-string types.");if(N=y.parse(m[3],3,ke),!N)return null}return new D0(C,M,N)}evaluate(m){const y=this.lhs.evaluate(m),b=this.rhs.evaluate(m);if(s&&this.hasUntypedArgument){const C=bi(y),M=bi(b);if(C.kind!==M.kind||"string"!==C.kind&&"number"!==C.kind)throw new Ci(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${C.kind}, ${M.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const C=bi(y),M=bi(b);if("string"!==C.kind||"string"!==M.kind)return e(m,y,b)}return this.collator?i(m,y,b,this.collator.evaluate(m)):e(m,y,b)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}serialize(){const m=[t];return this.eachChild(y=>{m.push(y.serialize())}),m}}}const ro=Vr("==",function(t,e,i){return e===i},br),Fo=Vr("!=",function(t,e,i){return e!==i},function(t,e,i,s){return!br(0,e,i,s)}),ss=Vr("<",function(t,e,i){return e<i},function(t,e,i,s){return s.compare(e,i)<0}),ps=Vr(">",function(t,e,i){return e>i},function(t,e,i,s){return s.compare(e,i)>0}),al=Vr("<=",function(t,e,i){return e<=i},function(t,e,i,s){return s.compare(e,i)<=0}),Il=Vr(">=",function(t,e,i){return e>=i},function(t,e,i,s){return s.compare(e,i)>=0});class Ra{constructor(e,i,s,h,m){this.type=Wi,this.number=e,this.locale=i,this.currency=s,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(e,i){if(3!==e.length)return i.error("Expected two arguments.");const s=i.parse(e[1],1,jn);if(!s)return null;const h=e[2];if("object"!=typeof h||Array.isArray(h))return i.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=i.parse(h.locale,1,Wi),!m))return null;let y=null;if(h.currency&&(y=i.parse(h.currency,1,Wi),!y))return null;let b=null;if(h["min-fraction-digits"]&&(b=i.parse(h["min-fraction-digits"],1,jn),!b))return null;let C=null;return h["max-fraction-digits"]&&(C=i.parse(h["max-fraction-digits"],1,jn),!C)?null:new Ra(s,m,y,b,C)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ql{constructor(e){this.type=jn,this.input=e}static parse(e,i){if(2!==e.length)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=i.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?i.error(`Expected argument of type string or array, but found ${fi(s.type)} instead.`):new Ql(s):null}evaluate(e){const i=this.input.evaluate(e);if("string"==typeof i||Array.isArray(i))return i.length;throw new Ci(`Expected value to be of type string or array, but found ${fi(bi(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const ks={"==":ro,"!=":Fo,">":ps,"<":ss,">=":Il,"<=":al,array:nr,at:Y,boolean:nr,case:Qn,coalesce:W,collator:ae,format:io,image:ho,in:Te,"index-of":Pt,interpolate:To,"interpolate-hcl":To,"interpolate-lab":To,length:Ql,let:E,literal:Di,match:kn,number:nr,"number-format":Ra,object:nr,slice:Yi,step:ka,string:nr,"to-boolean":go,"to-color":go,"to-number":go,"to-string":go,var:zs,within:Yr};function as(t,[e,i,s,h]){e=e.evaluate(t),i=i.evaluate(t),s=s.evaluate(t);const m=h?h.evaluate(t):1,y=Pi(e,i,s,m);if(y)throw new Ci(y);return new ht(e/255*m,i/255*m,s/255*m,m)}function Us(t,e){return t in e}function Co(t,e){const i=e[t];return void 0===i?null:i}function sa(t){return{type:t}}function wc(t){return{result:"success",value:t}}function aa(t){return{result:"error",value:t}}function ll(t){return"data-driven"===t["property-type"]||"cross-faded-data-driven"===t["property-type"]}function Yc(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Tc(t){return!!t.expression&&t.expression.interpolated}function kr(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function La(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function la(t){return t}function va(t,e){const i="color"===e.type,s=t.stops&&"object"==typeof t.stops[0][0],h=s||!(s||void 0!==t.property),m=t.type||(Tc(e)?"exponential":"interval");if(i&&((t=no({},t)).stops&&(t.stops=t.stops.map(M=>[M[0],ht.parse(M[1])])),t.default=ht.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!ts[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let y,b,C;if("exponential"===m)y=Fa;else if("interval"===m)y=Hs;else if("categorical"===m){y=ec,b=Object.create(null);for(const M of t.stops)b[M[0]]=M[1];C=typeof t.stops[0][0]}else{if("identity"!==m)throw new Error(`Unknown function type "${m}"`);y=Au}if(s){const M={},N=[];for(let pe=0;pe<t.stops.length;pe++){const be=t.stops[pe],Le=be[0].zoom;void 0===M[Le]&&(M[Le]={zoom:Le,type:t.type,property:t.property,default:t.default,stops:[]},N.push(Le)),M[Le].stops.push([be[0].value,be[1]])}const j=[];for(const pe of N)j.push([M[pe].zoom,va(M[pe],e)]);const H={name:"linear"};return{kind:"composite",interpolationType:H,interpolationFactor:To.interpolationFactor.bind(void 0,H),zoomStops:j.map(pe=>pe[0]),evaluate:({zoom:pe},be)=>Fa({stops:j,base:t.base},e,pe).evaluate(pe,be)}}if(h){const M="exponential"===m?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:To.interpolationFactor.bind(void 0,M),zoomStops:t.stops.map(N=>N[0]),evaluate:({zoom:N})=>y(t,e,N,b,C)}}return{kind:"source",evaluate(M,N){const j=N&&N.properties?N.properties[t.property]:void 0;return void 0===j?Ho(t.default,e.default):y(t,e,j,b,C)}}}function Ho(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function ec(t,e,i,s,h){return Ho(typeof i===h?s[i]:void 0,t.default,e.default)}function Hs(t,e,i){if("number"!==kr(i))return Ho(t.default,e.default);const s=t.stops.length;if(1===s||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[s-1][0])return t.stops[s-1][1];const h=Pa(t.stops.map(m=>m[0]),i);return t.stops[h][1]}function Fa(t,e,i){const s=void 0!==t.base?t.base:1;if("number"!==kr(i))return Ho(t.default,e.default);const h=t.stops.length;if(1===h||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[h-1][0])return t.stops[h-1][1];const m=Pa(t.stops.map(N=>N[0]),i),y=function(N,j,H,pe){const be=pe-H,Le=N-H;return 0===be?0:1===j?Le/be:(Math.pow(j,Le)-1)/(Math.pow(j,be)-1)}(i,s,t.stops[m][0],t.stops[m+1][0]),b=t.stops[m][1],C=t.stops[m+1][1];let M=ra[e.type]||la;if(t.colorSpace&&"rgb"!==t.colorSpace){const N=ts[t.colorSpace];M=(j,H)=>N.reverse(N.interpolate(N.forward(j),N.forward(H),y))}return"function"==typeof b.evaluate?{evaluate(...N){const j=b.evaluate.apply(void 0,N),H=C.evaluate.apply(void 0,N);if(void 0!==j&&void 0!==H)return M(j,H,y)}}:M(b,C,y)}function Au(t,e,i){return"color"===e.type?i=ht.parse(i):"formatted"===e.type?i=yn.fromString(i.toString()):"resolvedImage"===e.type?i=oi.fromString(i.toString()):kr(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),Ho(i,t.default,e.default)}Ce.register(ks,{error:[{kind:"error"},[Wi],(t,[e])=>{throw new Ci(e.evaluate(t))}],typeof:[Wi,[nt],(t,[e])=>fi(bi(e.evaluate(t)))],"to-rgba":[pi(jn,4),[wo],(t,[e])=>e.evaluate(t).toArray()],rgb:[wo,[jn,jn,jn],as],rgba:[wo,[jn,jn,jn,jn],as],has:{type:Ui,overloads:[[[Wi],(t,[e])=>Us(e.evaluate(t),t.properties())],[[Wi,at],(t,[e,i])=>Us(e.evaluate(t),i.evaluate(t))]]},get:{type:nt,overloads:[[[Wi],(t,[e])=>Co(e.evaluate(t),t.properties())],[[Wi,at],(t,[e,i])=>Co(e.evaluate(t),i.evaluate(t))]]},"feature-state":[nt,[Wi],(t,[e])=>Co(e.evaluate(t),t.featureState||{})],properties:[at,[],t=>t.properties()],"geometry-type":[Wi,[],t=>t.geometryType()],id:[nt,[],t=>t.id()],zoom:[jn,[],t=>t.globals.zoom],pitch:[jn,[],t=>t.globals.pitch||0],"distance-from-center":[jn,[],t=>t.distanceFromCenter()],"heatmap-density":[jn,[],t=>t.globals.heatmapDensity||0],"line-progress":[jn,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[jn,[],t=>t.globals.skyRadialProgress||0],accumulated:[nt,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[jn,sa(jn),(t,e)=>{let i=0;for(const s of e)i+=s.evaluate(t);return i}],"*":[jn,sa(jn),(t,e)=>{let i=1;for(const s of e)i*=s.evaluate(t);return i}],"-":{type:jn,overloads:[[[jn,jn],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[jn],(t,[e])=>-e.evaluate(t)]]},"/":[jn,[jn,jn],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[jn,[jn,jn],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[jn,[],()=>Math.LN2],pi:[jn,[],()=>Math.PI],e:[jn,[],()=>Math.E],"^":[jn,[jn,jn],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[jn,[jn],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[jn,[jn],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[jn,[jn],(t,[e])=>Math.log(e.evaluate(t))],log2:[jn,[jn],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[jn,[jn],(t,[e])=>Math.sin(e.evaluate(t))],cos:[jn,[jn],(t,[e])=>Math.cos(e.evaluate(t))],tan:[jn,[jn],(t,[e])=>Math.tan(e.evaluate(t))],asin:[jn,[jn],(t,[e])=>Math.asin(e.evaluate(t))],acos:[jn,[jn],(t,[e])=>Math.acos(e.evaluate(t))],atan:[jn,[jn],(t,[e])=>Math.atan(e.evaluate(t))],min:[jn,sa(jn),(t,e)=>Math.min(...e.map(i=>i.evaluate(t)))],max:[jn,sa(jn),(t,e)=>Math.max(...e.map(i=>i.evaluate(t)))],abs:[jn,[jn],(t,[e])=>Math.abs(e.evaluate(t))],round:[jn,[jn],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[jn,[jn],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[jn,[jn],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[Ui,[Wi,nt],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[Ui,[nt],(t,[e])=>t.id()===e.value],"filter-type-==":[Ui,[Wi],(t,[e])=>t.geometryType()===e.value],"filter-<":[Ui,[Wi,nt],(t,[e,i])=>{const s=t.properties()[e.value],h=i.value;return typeof s==typeof h&&s<h}],"filter-id-<":[Ui,[nt],(t,[e])=>{const i=t.id(),s=e.value;return typeof i==typeof s&&i<s}],"filter->":[Ui,[Wi,nt],(t,[e,i])=>{const s=t.properties()[e.value],h=i.value;return typeof s==typeof h&&s>h}],"filter-id->":[Ui,[nt],(t,[e])=>{const i=t.id(),s=e.value;return typeof i==typeof s&&i>s}],"filter-<=":[Ui,[Wi,nt],(t,[e,i])=>{const s=t.properties()[e.value],h=i.value;return typeof s==typeof h&&s<=h}],"filter-id-<=":[Ui,[nt],(t,[e])=>{const i=t.id(),s=e.value;return typeof i==typeof s&&i<=s}],"filter->=":[Ui,[Wi,nt],(t,[e,i])=>{const s=t.properties()[e.value],h=i.value;return typeof s==typeof h&&s>=h}],"filter-id->=":[Ui,[nt],(t,[e])=>{const i=t.id(),s=e.value;return typeof i==typeof s&&i>=s}],"filter-has":[Ui,[nt],(t,[e])=>e.value in t.properties()],"filter-has-id":[Ui,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[Ui,[pi(Wi)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[Ui,[pi(nt)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[Ui,[Wi,pi(nt)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[Ui,[Wi,pi(nt)],(t,[e,i])=>function(s,h,m,y){for(;m<=y;){const b=m+y>>1;if(h[b]===s)return!0;h[b]>s?y=b-1:m=b+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:Ui,overloads:[[[Ui,Ui],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[sa(Ui),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:Ui,overloads:[[[Ui,Ui],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[sa(Ui),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[Ui,[Ui],(t,[e])=>!e.evaluate(t)],"is-supported-script":[Ui,[Wi],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[Wi,[Wi],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Wi,[Wi],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Wi,sa(nt),(t,e)=>e.map(i=>gr(i.evaluate(t))).join("")],"resolved-locale":[Wi,[ke],(t,[e])=>e.evaluate(t).resolvedLocale()]});class Cc{constructor(e,i){var s;this.expression=e,this._warningHistory={},this._evaluator=new se,this._defaultValue=i?"color"===(s=i).type&&La(s.default)?new ht(0,0,0,0):"color"===s.type?ht.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=i&&"enum"===i.type?i.values:null}evaluateWithoutErrorHandling(e,i,s,h,m,y,b,C){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=s,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=C||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,s,h,m,y,b,C){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=s||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=C||null;try{const M=this.expression.evaluate(this._evaluator);if(null==M||"number"==typeof M&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new Ci(`Expected value to be one of ${Object.keys(this._enumValues).map(N=>JSON.stringify(N)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,"undefined"!=typeof console&&console.warn(M.message)),this._defaultValue}}}function Ws(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in ks}function Ba(t,e){const i=new Ps(ks,[],e?function(h){const m={color:wo,string:Wi,number:jn,enum:Wi,boolean:Ui,formatted:At,resolvedImage:en};return"array"===h.type?pi(m[h.value]||nt,h.length):m[h.type]}(e):void 0),s=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?wc(new Cc(s,e)):aa(i.errors)}class cl{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent="constant"!==e&&!es(i.expression)}evaluateWithoutErrorHandling(e,i,s,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,h,m,y)}evaluate(e,i,s,h,m,y){return this._styleExpression.evaluate(e,i,s,h,m,y)}}class Ec{constructor(e,i,s,h){this.kind=e,this.zoomStops=s,this._styleExpression=i,this.isStateDependent="camera"!==e&&!es(i.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,i,s,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,i,s,h,m,y)}evaluate(e,i,s,h,m,y){return this._styleExpression.evaluate(e,i,s,h,m,y)}interpolationFactor(e,i,s){return this.interpolationType?To.interpolationFactor(this.interpolationType,e,i,s):0}}function Mu(t,e){if("error"===(t=Ba(t,e)).result)return t;const i=t.value.expression,s=Jr(i);if(!s&&!ll(e))return aa([new pr("","data expressions not supported")]);const h=jo(i,["zoom","pitch","distance-from-center"]);if(!h&&!Yc(e))return aa([new pr("","zoom expressions not supported")]);const m=Na(i);return m||h?m instanceof pr?aa([m]):m instanceof To&&!Tc(e)?aa([new pr("",'"interpolate" expressions cannot be used with this property')]):wc(m?new Ec(s?"camera":"composite",t.value,m.labels,m instanceof To?m.interpolation:void 0):new cl(s?"constant":"source",t.value)):aa([new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Wo{constructor(e,i){this._parameters=e,this._specification=i,no(this,va(this._parameters,this._specification))}static deserialize(e){return new Wo(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Na(t){let e=null;if(t instanceof E)e=Na(t.result);else if(t instanceof W){for(const i of t.args)if(e=Na(i),e)break}else(t instanceof ka||t instanceof To)&&t.input instanceof Ce&&"zoom"===t.input.name&&(e=t);return e instanceof pr||t.eachChild(i=>{const s=Na(i);s instanceof pr?e=s:!e&&s?e=new pr("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new pr("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function ls(t){const e=t.key,i=t.value,s=t.valueSpec||{},h=t.objectElementValidators||{},m=t.style,y=t.styleSpec;let b=[];const C=kr(i);if("object"!==C)return[new hn(e,i,`object expected, ${C} found`)];for(const M in i){const N=M.split(".")[0],j=s[N]||s["*"];let H;if(h[N])H=h[N];else if(s[N])H=X;else if(h["*"])H=h["*"];else{if(!s["*"]){b.push(new hn(e,i[M],`unknown property "${M}"`));continue}H=X}b=b.concat(H({key:(e&&`${e}.`)+M,value:i[M],valueSpec:j,style:m,styleSpec:y,object:i,objectKey:M},i))}for(const M in s)h[M]||s[M].required&&void 0===s[M].default&&void 0===i[M]&&b.push(new hn(e,i,`missing required property "${M}"`));return b}function xa(t){const e=t.value,i=t.valueSpec,s=t.style,h=t.styleSpec,m=t.key,y=t.arrayElementValidator||X;if("array"!==kr(e))return[new hn(m,e,`array expected, ${kr(e)} found`)];if(i.length&&e.length!==i.length)return[new hn(m,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new hn(m,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let b={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum};h.$version<7&&(b.function=i.function),"object"===kr(i.value)&&(b=i.value);let C=[];for(let M=0;M<e.length;M++)C=C.concat(y({array:e,arrayIndex:M,value:e[M],valueSpec:b,style:s,styleSpec:h,key:`${m}[${M}]`}));return C}function za(t){const e=t.key,i=t.value,s=t.valueSpec;let h=kr(i);if("number"===h&&i!=i&&(h="NaN"),"number"!==h)return[new hn(e,i,`number expected, ${h} found`)];if("minimum"in s){let m=s.minimum;if("array"===kr(s.minimum)&&(m=s.minimum[t.arrayIndex]),i<m)return[new hn(e,i,`${i} is less than the minimum value ${m}`)]}if("maximum"in s){let m=s.maximum;if("array"===kr(s.maximum)&&(m=s.maximum[t.arrayIndex]),i>m)return[new hn(e,i,`${i} is greater than the maximum value ${m}`)]}return[]}function Ys(t){const e=t.valueSpec,i=rr(t.value.type);let s,h,m,y={};const b="categorical"!==i&&void 0===t.value.property,C=!b,M="array"===kr(t.value.stops)&&"array"===kr(t.value.stops[0])&&"object"===kr(t.value.stops[0][0]),N=ls({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(pe){if("identity"===i)return[new hn(pe.key,pe.value,'identity function may not have a "stops" property')];let be=[];const Le=pe.value;return be=be.concat(xa({key:pe.key,value:Le,valueSpec:pe.valueSpec,style:pe.style,styleSpec:pe.styleSpec,arrayElementValidator:j})),"array"===kr(Le)&&0===Le.length&&be.push(new hn(pe.key,Le,"array must have at least one stop")),be},default:function(pe){return X({key:pe.key,value:pe.value,valueSpec:e,style:pe.style,styleSpec:pe.styleSpec})}}});return"identity"===i&&b&&N.push(new hn(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||N.push(new hn(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!Tc(t.valueSpec)&&N.push(new hn(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(C&&!ll(t.valueSpec)?N.push(new hn(t.key,t.value,"property functions not supported")):b&&!Yc(t.valueSpec)&&N.push(new hn(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!M||void 0!==t.value.property||N.push(new hn(t.key,t.value,'"property" property is required')),N;function j(pe){let be=[];const Le=pe.value,qe=pe.key;if("array"!==kr(Le))return[new hn(qe,Le,`array expected, ${kr(Le)} found`)];if(2!==Le.length)return[new hn(qe,Le,`array length 2 expected, length ${Le.length} found`)];if(M){if("object"!==kr(Le[0]))return[new hn(qe,Le,`object expected, ${kr(Le[0])} found`)];if(void 0===Le[0].zoom)return[new hn(qe,Le,"object stop key must have zoom")];if(void 0===Le[0].value)return[new hn(qe,Le,"object stop key must have value")];if(m&&m>rr(Le[0].zoom))return[new hn(qe,Le[0].zoom,"stop zoom values must appear in ascending order")];rr(Le[0].zoom)!==m&&(m=rr(Le[0].zoom),h=void 0,y={}),be=be.concat(ls({key:`${qe}[0]`,value:Le[0],valueSpec:{zoom:{}},style:pe.style,styleSpec:pe.styleSpec,objectElementValidators:{zoom:za,value:H}}))}else be=be.concat(H({key:`${qe}[0]`,value:Le[0],valueSpec:{},style:pe.style,styleSpec:pe.styleSpec},Le));return Ws(Br(Le[1]))?be.concat([new hn(`${qe}[1]`,Le[1],"expressions are not allowed in function stops.")]):be.concat(X({key:`${qe}[1]`,value:Le[1],valueSpec:e,style:pe.style,styleSpec:pe.styleSpec}))}function H(pe,be){const Le=kr(pe.value),qe=rr(pe.value),it=null!==pe.value?pe.value:be;if(s){if(Le!==s)return[new hn(pe.key,it,`${Le} stop domain type must match previous stop domain type ${s}`)]}else s=Le;if("number"!==Le&&"string"!==Le&&"boolean"!==Le)return[new hn(pe.key,it,"stop domain value must be a number, string, or boolean")];if("number"!==Le&&"categorical"!==i){let yt=`number expected, ${Le} found`;return ll(e)&&void 0===i&&(yt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new hn(pe.key,it,yt)]}return"categorical"!==i||"number"!==Le||isFinite(qe)&&Math.floor(qe)===qe?"categorical"!==i&&"number"===Le&&void 0!==h&&qe<h?[new hn(pe.key,it,"stop domain values must appear in ascending order")]:(h=qe,"categorical"===i&&qe in y?[new hn(pe.key,it,"stop domain values must be unique")]:(y[qe]=!0,[])):[new hn(pe.key,it,`integer expected, found ${qe}`)]}}function Js(t){const e=("property"===t.expressionContext?Mu:Ba)(Br(t.value),t.valueSpec);if("error"===e.result)return e.value.map(s=>new hn(`${t.key}${s.key}`,t.value,s.message));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new hn(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!es(i))return[new hn(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return ba(i,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!jo(i,["zoom","feature-state"]))return[new hn(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Jr(i))return[new hn(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ba(t,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);for(const h of e.valueSpec.expression.parameters)i.delete(h);if(0===i.size)return[];const s=[];return t instanceof Ce&&i.has(t.name)?[new hn(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(h=>{s.push(...ba(h,e))}),s)}function Al(t){const e=t.key,i=t.value,s=t.valueSpec,h=[];return Array.isArray(s.values)?-1===s.values.indexOf(rr(i))&&h.push(new hn(e,i,`expected one of [${s.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(s.values).indexOf(rr(i))&&h.push(new hn(e,i,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(i)} found`)),h}function ca(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!ca(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function Ua(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};ca(t)||(t=Ca(t));const i=t;let s=!0;try{s=function(M){if(!ul(M))return M;let N=Br(M);return Dc(N),N=wa(N),N}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(i,null,2)}\n        `)}const h=Bt[`filter_${e}`],m=Ba(s,h);let y=null;if("error"===m.result)throw new Error(m.value.map(M=>`${M.key}: ${M.message}`).join(", "));y=(M,N,j)=>m.value.evaluate(M,N,{},j);let b=null,C=null;if(s!==i){const M=Ba(i,h);if("error"===M.result)throw new Error(M.value.map(N=>`${N.key}: ${N.message}`).join(", "));b=(N,j,H,pe,be)=>M.value.evaluate(N,j,{},H,void 0,void 0,pe,be),C=!Jr(M.value.expression)}return y=y,{filter:y,dynamicFilter:b||void 0,needGeometry:Ic(s),needFeature:!!C}}function wa(t){if(!Array.isArray(t))return t;const e=function(i){if(Ta.has(i[0]))for(let s=1;s<i.length;s++)if(ul(i[s]))return!0;return i}(t);return!0===e?e:e.map(i=>wa(i))}function Dc(t){let e=!1;const i=[];if("case"===t[0]){for(let s=1;s<t.length-1;s+=2)e=e||ul(t[s]),i.push(t[s+1]);i.push(t[t.length-1])}else if("match"===t[0]){e=e||ul(t[1]);for(let s=2;s<t.length-1;s+=2)i.push(t[s+1]);i.push(t[t.length-1])}else if("step"===t[0]){e=e||ul(t[1]);for(let s=1;s<t.length-1;s+=2)i.push(t[s+1])}e&&(t.length=0,t.push("any",...i));for(let s=1;s<t.length;s++)Dc(t[s])}function ul(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let i=1;i<t.length;i++)if(ul(t[i]))return!0;return!1}const Ta=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Jc(t,e){return t<e?-1:t>e?1:0}function Ic(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(Ic(t[e]))return!0;return!1}function Ca(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Ml(t[1],t[2],"=="):"!="===e?Za(Ml(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Ml(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(Ca))):"all"===e?["all"].concat(t.slice(1).map(Ca)):"none"===e?["all"].concat(t.slice(1).map(Ca).map(Za)):"in"===e?tc(t[1],t.slice(2)):"!in"===e?Za(tc(t[1],t.slice(2))):"has"===e?Sl(t[1]):"!has"===e?Za(Sl(t[1])):"within"!==e||t;var i}function Ml(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function tc(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",t,["literal",e.sort(Jc)]]:["filter-in-small",t,["literal",e]]}}function Sl(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Za(t){return["!",t]}function nc(t){if(ca(Br(t.value))){const e=Br(t.layerType);return Js(no({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${e||"fill"}`]}))}return Ac(t)}function Ac(t){const e=t.value,i=t.key;if("array"!==kr(e))return[new hn(i,e,`array expected, ${kr(e)} found`)];const s=t.styleSpec;let h,m=[];if(e.length<1)return[new hn(i,e,"filter array must have at least 1 element")];switch(m=m.concat(Al({key:`${i}[0]`,value:e[0],valueSpec:s.filter_operator,style:t.style,styleSpec:t.styleSpec})),rr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===rr(e[1])&&m.push(new hn(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&m.push(new hn(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=kr(e[1]),"string"!==h&&m.push(new hn(`${i}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=kr(e[y]),"$type"===rr(e[1])?m=m.concat(Al({key:`${i}[${y}]`,value:e[y],valueSpec:s.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==h&&"number"!==h&&"boolean"!==h&&m.push(new hn(`${i}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(Ac({key:`${i}[${y}]`,value:e[y],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":h=kr(e[1]),2!==e.length?m.push(new hn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==h&&m.push(new hn(`${i}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=kr(e[1]),2!==e.length?m.push(new hn(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==h&&m.push(new hn(`${i}[1]`,e[1],`object expected, ${h} found`))}return m}function dl(t,e){const i=t.key,s=t.style,h=t.styleSpec,m=t.value,y=t.objectKey,b=h[`${e}_${t.layerType}`];if(!b)return[];const C=y.match(/^(.*)-transition$/);if("paint"===e&&C&&b[C[1]]&&b[C[1]].transition)return X({key:i,value:m,valueSpec:h.transition,style:s,styleSpec:h});const M=t.valueSpec||b[y];if(!M)return[new hn(i,m,`unknown property "${y}"`)];let N;if("string"===kr(m)&&ll(M)&&!M.tokens&&(N=/^{([^}]+)}$/.exec(m)))return[new hn(i,m,`"${y}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(N[1])} }\`.`)];const j=[];return"symbol"===t.layerType&&("text-field"===y&&s&&!s.glyphs&&j.push(new hn(i,m,'use of "text-field" requires a style "glyphs" property')),"text-font"===y&&La(Br(m))&&"identity"===rr(m.type)&&j.push(new hn(i,m,'"text-font" does not support identity functions'))),j.concat(X({key:t.key,value:m,valueSpec:M,style:s,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:y}))}function Mc(t){return dl(t,"paint")}function Pl(t){return dl(t,"layout")}function kl(t){let e=[];const i=t.value,s=t.key,h=t.style,m=t.styleSpec;i.type||i.ref||e.push(new hn(s,i,'either "type" or "ref" is required'));let y=rr(i.type);const b=rr(i.ref);if(i.id){const C=rr(i.id);for(let M=0;M<t.arrayIndex;M++){const N=h.layers[M];rr(N.id)===C&&e.push(new hn(s,i.id,`duplicate layer id "${i.id}", previously used at line ${N.id.__line__}`))}}if("ref"in i){let C;["type","source","source-layer","filter","layout"].forEach(M=>{M in i&&e.push(new hn(s,i[M],`"${M}" is prohibited for ref layers`))}),h.layers.forEach(M=>{rr(M.id)===b&&(C=M)}),C?C.ref?e.push(new hn(s,i.ref,"ref cannot reference another ref layer")):y=rr(C.type):e.push(new hn(s,i.ref,`ref layer "${b}" not found`))}else if("background"!==y&&"sky"!==y)if(i.source){const C=h.sources&&h.sources[i.source],M=C&&rr(C.type);C?"vector"===M&&"raster"===y?e.push(new hn(s,i.source,`layer "${i.id}" requires a raster source`)):"raster"===M&&"raster"!==y?e.push(new hn(s,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==M||i["source-layer"]?"raster-dem"===M&&"hillshade"!==y?e.push(new hn(s,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==y||!i.paint||!i.paint["line-gradient"]||"geojson"===M&&C.lineMetrics||e.push(new hn(s,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new hn(s,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new hn(s,i.source,`source "${i.source}" not found`))}else e.push(new hn(s,i,'missing required property "source"'));return e=e.concat(ls({key:s,value:i,valueSpec:m.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>X({key:`${s}.type`,value:i.type,valueSpec:m.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"}),filter:C=>nc(no({layerType:y},C)),layout:C=>ls({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":M=>Pl(no({layerType:y},M))}}),paint:C=>ls({layer:i,key:C.key,value:C.value,style:C.style,styleSpec:C.styleSpec,objectElementValidators:{"*":M=>Mc(no({layerType:y},M))}})}})),e}function hl(t){const e=t.value,i=t.key,s=kr(e);return"string"!==s?[new hn(i,e,`string expected, ${s} found`)]:[]}const Va={promoteId:function({key:t,value:e}){if("string"===kr(e))return hl({key:t,value:e});{const i=[];for(const s in e)i.push(...hl({key:`${t}.${s}`,value:e[s]}));return i}}};function pl(t){const e=t.value,i=t.key,s=t.styleSpec,h=t.style;if(!e.type)return[new hn(i,e,'"type" is required')];const m=rr(e.type);let y;switch(m){case"vector":case"raster":case"raster-dem":return y=ls({key:i,value:e,valueSpec:s[`source_${m.replace("-","_")}`],style:t.style,styleSpec:s,objectElementValidators:Va}),y;case"geojson":if(y=ls({key:i,value:e,valueSpec:s.source_geojson,style:h,styleSpec:s,objectElementValidators:Va}),e.cluster)for(const b in e.clusterProperties){const[C,M]=e.clusterProperties[b],N="string"==typeof C?[C,["accumulated"],["get",b]]:C;y.push(...Js({key:`${i}.${b}.map`,value:M,expressionContext:"cluster-map"})),y.push(...Js({key:`${i}.${b}.reduce`,value:N,expressionContext:"cluster-reduce"}))}return y;case"video":return ls({key:i,value:e,valueSpec:s.source_video,style:h,styleSpec:s});case"image":return ls({key:i,value:e,valueSpec:s.source_image,style:h,styleSpec:s});case"canvas":return[new hn(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Al({key:`${i}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,styleSpec:s})}}function Kc(t){const e=t.value,i=t.styleSpec,s=i.light,h=t.style;let m=[];const y=kr(e);if(void 0===e)return m;if("object"!==y)return m=m.concat([new hn("light",e,`object expected, ${y} found`)]),m;for(const b in e){const C=b.match(/^(.*)-transition$/);m=m.concat(C&&s[C[1]]&&s[C[1]].transition?X({key:b,value:e[b],valueSpec:i.transition,style:h,styleSpec:i}):s[b]?X({key:b,value:e[b],valueSpec:s[b],style:h,styleSpec:i}):[new hn(b,e[b],`unknown property "${b}"`)])}return m}function $(t){const e=t.value,i=t.key,s=t.style,h=t.styleSpec,m=h.terrain;let y=[];const b=kr(e);if(void 0===e)return y;if("object"!==b)return y=y.concat([new hn("terrain",e,`object expected, ${b} found`)]),y;for(const C in e){const M=C.match(/^(.*)-transition$/);y=y.concat(M&&m[M[1]]&&m[M[1]].transition?X({key:C,value:e[C],valueSpec:h.transition,style:s,styleSpec:h}):m[C]?X({key:C,value:e[C],valueSpec:m[C],style:s,styleSpec:h}):[new hn(C,e[C],`unknown property "${C}"`)])}if(e.source){const C=s.sources&&s.sources[e.source],M=C&&rr(C.type);C?"raster-dem"!==M&&y.push(new hn(i,e.source,`terrain cannot be used with a source of type ${M}, it only be used with a "raster-dem" source type`)):y.push(new hn(i,e.source,`source "${e.source}" not found`))}else y.push(new hn(i,e,'terrain is missing required property "source"'));return y}function R(t){const e=t.value,i=t.style,s=t.styleSpec,h=s.fog;let m=[];const y=kr(e);if(void 0===e)return m;if("object"!==y)return m=m.concat([new hn("fog",e,`object expected, ${y} found`)]),m;for(const b in e){const C=b.match(/^(.*)-transition$/);m=m.concat(C&&h[C[1]]&&h[C[1]].transition?X({key:b,value:e[b],valueSpec:s.transition,style:i,styleSpec:s}):h[b]?X({key:b,value:e[b],valueSpec:h[b],style:i,styleSpec:s}):[new hn(b,e[b],`unknown property "${b}"`)])}return m}const P={"*":()=>[],array:xa,boolean:function(t){const e=t.value,i=t.key,s=kr(e);return"boolean"!==s?[new hn(i,e,`boolean expected, ${s} found`)]:[]},number:za,color:function(t){const e=t.key,i=t.value,s=kr(i);return"string"!==s?[new hn(e,i,`color expected, ${s} found`)]:null===Dt.parseCSSColor(i)?[new hn(e,i,`color expected, "${i}" found`)]:[]},constants:qi,enum:Al,filter:nc,function:Ys,layer:kl,object:ls,source:pl,light:Kc,terrain:$,fog:R,string:hl,formatted:function(t){return 0===hl(t).length?[]:Js(t)},resolvedImage:function(t){return 0===hl(t).length?[]:Js(t)},projection:function(t){const e=t.value,i=t.styleSpec,s=i.projection,h=t.style;let m=[];const y=kr(e);if("object"===y)for(const b in e)m=m.concat(X({key:b,value:e[b],valueSpec:s[b],style:h,styleSpec:i}));else"string"!==y&&(m=m.concat([new hn("projection",e,`object or string expected, ${y} found`)]));return m}};function X(t){const e=t.value,i=t.valueSpec,s=t.styleSpec;return i.expression&&La(rr(e))?Ys(t):i.expression&&Ws(Br(e))?Js(t):i.type&&P[i.type]?P[i.type](t):ls(no({},t,{valueSpec:i.type?s[i.type]:i}))}function he(t){const e=t.value,i=t.key,s=hl(t);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new hn(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new hn(i,e,'"glyphs" url must include a "{range}" token'))),s}function Fe(t,e=Bt){let i=[];return i=i.concat(X({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:he,"*":()=>[]}})),t.constants&&(i=i.concat(qi({key:"constants",value:t.constants,style:t,styleSpec:e}))),pt(i)}function pt(t){return[].concat(t).sort((e,i)=>e.line-i.line)}function It(t){return function(...e){return pt(t.apply(this,e))}}Fe.source=It(pl),Fe.light=It(Kc),Fe.terrain=It($),Fe.fog=It(R),Fe.layer=It(kl),Fe.filter=It(nc),Fe.paintProperty=It(Mc),Fe.layoutProperty=It(Pl);const Tn=Fe,Ii=Tn.light,ao=Tn.fog,Ji=Tn.paintProperty,Do=Tn.layoutProperty;function lo(t,e){let i=!1;if(e&&e.length)for(const s of e)t.fire(new An(new Error(s.message))),i=!0;return i}var Kr=No;function No(t,e,i){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var h=new Int32Array(this.arrayBuffer);t=h[0],this.d=(e=h[1])+2*(i=h[2]);for(var m=0;m<this.d*this.d;m++){var y=h[3+m],b=h[3+m+1];s.push(y===b?null:h.subarray(y,b))}var C=h[3+s.length+1];this.keys=h.subarray(h[3+s.length],C),this.bboxes=h.subarray(C),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var M=0;M<this.d*this.d;M++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var N=i/e*t;this.min=-N,this.max=t+N}No.prototype.insert=function(t,e,i,s,h){this._forEachCell(e,i,s,h,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(s),this.bboxes.push(h)},No.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},No.prototype._insertCell=function(t,e,i,s,h,m){this.cells[h].push(m)},No.prototype.query=function(t,e,i,s,h){var m=this.min,y=this.max;if(t<=m&&e<=m&&y<=i&&y<=s&&!h)return Array.prototype.slice.call(this.keys);var b=[];return this._forEachCell(t,e,i,s,this._queryCell,b,{},h),b},No.prototype._queryCell=function(t,e,i,s,h,m,y,b){var C=this.cells[h];if(null!==C)for(var M=this.keys,N=this.bboxes,j=0;j<C.length;j++){var H=C[j];if(void 0===y[H]){var pe=4*H;(b?b(N[pe+0],N[pe+1],N[pe+2],N[pe+3]):t<=N[pe+2]&&e<=N[pe+3]&&i>=N[pe+0]&&s>=N[pe+1])?(y[H]=!0,m.push(M[H])):y[H]=!1}}},No.prototype._forEachCell=function(t,e,i,s,h,m,y,b){for(var C=this._convertToCellCoord(t),M=this._convertToCellCoord(e),N=this._convertToCellCoord(i),j=this._convertToCellCoord(s),H=C;H<=N;H++)for(var pe=M;pe<=j;pe++){var be=this.d*pe+H;if((!b||b(this._convertFromCellCoord(H),this._convertFromCellCoord(pe),this._convertFromCellCoord(H+1),this._convertFromCellCoord(pe+1)))&&h.call(this,t,e,i,s,be,m,y,b))return}},No.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},No.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},No.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,i=0,s=0;s<this.cells.length;s++)i+=this.cells[s].length;var h=new Int32Array(e+i+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var m=e,y=0;y<t.length;y++){var b=t[y];h[3+y]=m,h.set(b,m),m+=b.length}return h[3+t.length]=m,h.set(this.keys,m),h[3+t.length+1]=m+=this.keys.length,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer};const{ImageData:ys,ImageBitmap:Os}=Z,$a={};function li(t,e,i={}){Object.defineProperty(e,"_classRegistryKey",{value:t,writeable:!1}),$a[t]={klass:e,omit:i.omit||[],shallow:i.shallow||[]}}li("Object",Object),Kr.serialize=function(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},Kr.deserialize=function(t){return new Kr(t.buffer)},li("Grid",Kr),li("Color",ht),li("Error",Error),li("ResolvedImage",oi),li("StylePropertyFunction",Wo),li("StyleExpression",Cc,{omit:["_evaluator"]}),li("ZoomDependentExpression",Ec),li("ZoomConstantExpression",cl),li("CompoundExpression",Ce,{omit:["_evaluate"]});for(const t in ks)ks[t]._classRegistryKey||li(`Expression_${t}`,ks[t]);function Ol(t){return t&&"undefined"!=typeof ArrayBuffer&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function _h(t){return Os&&t instanceof Os}function ja(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ol(t)||_h(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof ys)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const s of t)i.push(ja(s,e));return i}if("object"==typeof t){const i=t.constructor,s=i._classRegistryKey;if(!s)throw new Error("can't serialize object of unregistered class");const h=i.serialize?i.serialize(t,e):{};if(!i.serialize){for(const m in t){if(!t.hasOwnProperty(m)||$a[s].omit.indexOf(m)>=0)continue;const y=t[m];h[m]=$a[s].shallow.indexOf(m)>=0?y:ja(y,e)}t instanceof Error&&(h.message=t.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(h.$name=s),h}throw new Error("can't serialize object of type "+typeof t)}function Rl(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ol(t)||_h(t)||ArrayBuffer.isView(t)||t instanceof ys)return t;if(Array.isArray(t))return t.map(Rl);if("object"==typeof t){const e=t.$name||"Object",{klass:i}=$a[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const s=Object.create(i.prototype);for(const h of Object.keys(t)){if("$name"===h)continue;const m=t[h];s[h]=$a[e].shallow.indexOf(h)>=0?m:Rl(m)}return s}throw new Error("can't deserialize object of type "+typeof t)}class g{constructor(){this.first=!0}update(e,i){const s=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=s,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=s,!0):(this.lastFloorZoom>s?(this.lastIntegerZoom=s+1,this.lastIntegerZoomTime=i):this.lastFloorZoom<s&&(this.lastIntegerZoom=s,this.lastIntegerZoomTime=i),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=s,!0))}}const n=t=>t>=1536&&t<=1791,u=t=>t>=1872&&t<=1919,_=t=>t>=2208&&t<=2303,x=t=>t>=11904&&t<=12031,T=t=>t>=12032&&t<=12255,I=t=>t>=12272&&t<=12287,B=t=>t>=12288&&t<=12351,J=t=>t>=12352&&t<=12447,oe=t=>t>=12448&&t<=12543,ce=t=>t>=12544&&t<=12591,ge=t=>t>=12704&&t<=12735,Re=t=>t>=12736&&t<=12783,We=t=>t>=12784&&t<=12799,$e=t=>t>=12800&&t<=13055,Ye=t=>t>=13056&&t<=13311,mt=t=>t>=13312&&t<=19903,Ge=t=>t>=19968&&t<=40959,dt=t=>t>=40960&&t<=42127,_t=t=>t>=42128&&t<=42191,lt=t=>t>=44032&&t<=55215,ut=t=>t>=63744&&t<=64255,bt=t=>t>=64336&&t<=65023,qt=t=>t>=65040&&t<=65055,cn=t=>t>=65072&&t<=65103,Gn=t=>t>=65104&&t<=65135,On=t=>t>=65136&&t<=65279,Sn=t=>t>=65280&&t<=65519;function mn(t){for(const e of t)if(bn(e.charCodeAt(0)))return!0;return!1}function Xt(t){for(const e of t)if(!Cn(e.charCodeAt(0)))return!1;return!0}function Cn(t){return!(n(t)||u(t)||_(t)||bt(t)||On(t))}function bn(t){return!(746!==t&&747!==t&&(t<4352||!(ge(t)||ce(t)||cn(t)&&!(t>=65097&&t<=65103)||ut(t)||Ye(t)||x(t)||Re(t)||!(!B(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||mt(t)||Ge(t)||$e(t)||(e=t,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(t)||(e=>e>=55216&&e<=55295)(t)||(e=>e>=4352&&e<=4607)(t)||lt(t)||J(t)||I(t)||(e=>e>=12688&&e<=12703)(t)||T(t)||We(t)||oe(t)&&12540!==t||!(!Sn(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!Gn(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(e=>e>=5120&&e<=5759)(t)||(e=>e>=6320&&e<=6399)(t)||qt(t)||(e=>e>=19904&&e<=19967)(t)||dt(t)||_t(t))));var e}function Ti(t){return!(bn(t)||(e=t,(i=e)>=128&&i<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(i=>i>=8192&&i<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(i=>i>=8448&&i<=8527)(e)||(i=>i>=8528&&i<=8591)(e)||(i=>i>=8960&&i<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(i=>i>=9216&&i<=9279)(e)&&9251!==e||(i=>i>=9280&&i<=9311)(e)||(i=>i>=9312&&i<=9471)(e)||(i=>i>=9632&&i<=9727)(e)||(i=>i>=9728&&i<=9983)(e)&&!(e>=9754&&e<=9759)||(i=>i>=11008&&i<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||B(e)||oe(e)||(i=>i>=57344&&i<=63743)(e)||cn(e)||Gn(e)||Sn(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,i}function Vi(t){return t>=1424&&t<=2303||bt(t)||On(t)}function wr(t,e){return!(!e&&Vi(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(i=t,i>=6016&&i<=6143));var i}function $n(t){for(const e of t)if(Vi(e.charCodeAt(0)))return!0;return!1}const Fi="deferred",ar="loading",Xr="loaded";let xo=null,or="unavailable",Ki=null;const Mo=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(or="error"),xo&&xo(t)};function ns(){vs.fire(new dn("pluginStateChange",{pluginStatus:or,pluginURL:Ki}))}const vs=new qn,xs=function(){return or},ua=function(){if(or!==Fi||!Ki)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");or=ar,ns(),Ki&&Sr({url:Ki},t=>{t?Mo(t):(or=Xr,ns())})},$r={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>or===Xr||null!=$r.applyArabicShaping,isLoading:()=>or===ar,setState(t){or=t.pluginStatus,Ki=t.pluginURL},isParsed:()=>null!=$r.applyArabicShaping&&null!=$r.processBidirectionalText&&null!=$r.processStyledBidirectionalText,getPluginURL:()=>Ki};class lr{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.zoomHistory=i.zoomHistory,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.zoomHistory=new g,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,s){for(const h of i)if(!wr(h.charCodeAt(0),s))return!1;return!0}(e,$r.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,i=e-Math.floor(e),s=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:i+(1-i)*s}:{fromScale:.5,toScale:1,t:1-(1-s)*i}}}class Tr{constructor(e,i){this.property=e,this.value=i,this.expression=function(s,h){if(La(s))return new Wo(s,h);if(Ws(s)){const m=Mu(s,h);if("error"===m.result)throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=s;return"string"==typeof s&&"color"===h.type&&(m=ht.parse(s)),{kind:"constant",evaluate:()=>m}}}(void 0===i?e.specification.default:i,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,i,s){return this.property.possiblyEvaluate(this,e,i,s)}}class Eo{constructor(e){this.property=e,this.value=new Tr(e,void 0)}transitioned(e,i){return new po(this.property,this.value,i,et({},e.transition,this.transition),e.now)}untransitioned(){return new po(this.property,this.value,null,{},0)}}class Rs{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return ni(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Eo(this._values[e].property)),this._values[e].value=new Tr(this._values[e].property,null===i?void 0:ni(i))}getTransition(e){return ni(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new Eo(this._values[e].property)),this._values[e].transition=ni(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);void 0!==s&&(e[i]=s);const h=this.getTransition(i);void 0!==h&&(e[`${i}-transition`]=h)}return e}transitioned(e,i){const s=new Zs(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].transitioned(e,i._values[h]);return s}untransitioned(){const e=new Zs(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class po{constructor(e,i,s,h,m){const y=h.delay||0,b=h.duration||0;m=m||0,this.property=e,this.value=i,this.begin=m+y,this.end=this.begin+b,e.specification.transition&&(h.delay||h.duration)&&(this.prior=s)}possiblyEvaluate(e,i,s){const h=e.now||0,m=this.value.possiblyEvaluate(e,i,s),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(e,i,s);{const b=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,i,s),m,ir(b))}}return m}}class Zs{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,s){const h=new Ea(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,i,s);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class ic{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return ni(this._values[e].value)}setValue(e,i){this._values[e]=new Tr(this._values[e].property,null===i?void 0:ni(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const s=this.getValue(i);void 0!==s&&(e[i]=s)}return e}possiblyEvaluate(e,i,s){const h=new Ea(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,i,s);return h}}class bs{constructor(e,i,s){this.property=e,this.value=i,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,i,s,h){return this.property.evaluate(this.value,this.parameters,e,i,s,h)}}class Ea{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class _i{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,s){const h=ra[this.specification.type];return h?h(e,i,s):e}}class Ni{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,s,h){return new bs(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(i,null,{},s,h)}:e.expression,i)}interpolate(e,i,s){if("constant"!==e.value.kind||"constant"!==i.value.kind)return e;if(void 0===e.value.value||void 0===i.value.value)return new bs(this,{kind:"constant",value:void 0},e.parameters);const h=ra[this.specification.type];return h?new bs(this,{kind:"constant",value:h(e.value.value,i.value.value,s)},e.parameters):e}evaluate(e,i,s,h,m,y){return"constant"===e.kind?e.value:e.evaluate(i,s,h,m,y)}}class cs extends Ni{possiblyEvaluate(e,i,s,h){if(void 0===e.value)return new bs(this,{kind:"constant",value:void 0},i);if("constant"===e.expression.kind){const m=e.expression.evaluate(i,null,{},s,h),y="resolvedImage"===e.property.specification.type&&"string"!=typeof m?m.name:m,b=this._calculate(y,y,y,i);return new bs(this,{kind:"constant",value:b},i)}if("camera"===e.expression.kind){const m=this._calculate(e.expression.evaluate({zoom:i.zoom-1}),e.expression.evaluate({zoom:i.zoom}),e.expression.evaluate({zoom:i.zoom+1}),i);return new bs(this,{kind:"constant",value:m},i)}return new bs(this,e.expression,i)}evaluate(e,i,s,h,m,y){if("source"===e.kind){const b=e.evaluate(i,s,h,m,y);return this._calculate(b,b,b,i)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(i.zoom)-1},s,h),e.evaluate({zoom:Math.floor(i.zoom)},s,h),e.evaluate({zoom:Math.floor(i.zoom)+1},s,h),i):e.value}_calculate(e,i,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i,other:s}:{from:s,to:i,other:e}}interpolate(e){return e}}class Ks{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,h){if(void 0!==e.value){if("constant"===e.expression.kind){const m=e.expression.evaluate(i,null,{},s,h);return this._calculate(m,m,m,i)}return this._calculate(e.expression.evaluate(new lr(Math.floor(i.zoom-1),i)),e.expression.evaluate(new lr(Math.floor(i.zoom),i)),e.expression.evaluate(new lr(Math.floor(i.zoom+1),i)),i)}}_calculate(e,i,s,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:i}:{from:s,to:i}}interpolate(e){return e}}class Xs{constructor(e){this.specification=e}possiblyEvaluate(e,i,s,h){return!!e.expression.evaluate(i,null,{},s,h)}interpolate(){return!1}}class fs{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const i in e){const s=e[i];s.specification.overridable&&this.overridableProperties.push(i);const h=this.defaultPropertyValues[i]=new Tr(s,void 0),m=this.defaultTransitionablePropertyValues[i]=new Eo(s);this.defaultTransitioningPropertyValues[i]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[i]=h.possiblyEvaluate({})}}}function $m(t,e){return 256*(t=Ri(Math.floor(t),0,255))+Ri(Math.floor(e),0,255)}li("DataDrivenProperty",Ni),li("DataConstantProperty",_i),li("CrossFadedDataDrivenProperty",cs),li("CrossFadedProperty",Ks),li("ColorRampProperty",Xs);const tf={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Su{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Yo{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Bo(t,e=1){let i=0,s=0;return{members:t.map(h=>{const m=tf[h.type].BYTES_PER_ELEMENT,y=i=nf(i,Math.max(e,m)),b=h.components||1;return s=Math.max(s,m),i+=m*b,{name:h.name,type:h.type,components:b,offset:y}}),size:nf(i,Math.max(s,e)),alignment:e}}function nf(t,e){return Math.ceil(t/e)*e}class Xc extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const h=2*e;return this.int16[h+0]=i,this.int16[h+1]=s,e}}Xc.prototype.bytesPerElement=4,li("StructArrayLayout2i4",Xc);class Ll extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,s,h)}emplace(e,i,s,h,m){const y=4*e;return this.int16[y+0]=i,this.int16[y+1]=s,this.int16[y+2]=h,this.int16[y+3]=m,e}}Ll.prototype.bytesPerElement=8,li("StructArrayLayout4i8",Ll);class Pu extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,s,h,m,y,b)}emplace(e,i,s,h,m,y,b,C){const M=6*e,N=12*e,j=3*e;return this.int16[M+0]=i,this.int16[M+1]=s,this.uint8[N+4]=h,this.uint8[N+5]=m,this.uint8[N+6]=y,this.uint8[N+7]=b,this.float32[j+2]=C,e}}Pu.prototype.bytesPerElement=12,li("StructArrayLayout2i4ub1f12",Pu);class Ga extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const m=3*e;return this.float32[m+0]=i,this.float32[m+1]=s,this.float32[m+2]=h,e}}Ga.prototype.bytesPerElement=12,li("StructArrayLayout3f12",Ga);class rc extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b,C,M,N){const j=this.length;return this.resize(j+1),this.emplace(j,e,i,s,h,m,y,b,C,M,N)}emplace(e,i,s,h,m,y,b,C,M,N,j){const H=10*e;return this.uint16[H+0]=i,this.uint16[H+1]=s,this.uint16[H+2]=h,this.uint16[H+3]=m,this.uint16[H+4]=y,this.uint16[H+5]=b,this.uint16[H+6]=C,this.uint16[H+7]=M,this.uint16[H+8]=N,this.uint16[H+9]=j,e}}rc.prototype.bytesPerElement=20,li("StructArrayLayout10ui20",rc);class ud extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b,C){const M=this.length;return this.resize(M+1),this.emplace(M,e,i,s,h,m,y,b,C)}emplace(e,i,s,h,m,y,b,C,M){const N=8*e;return this.uint16[N+0]=i,this.uint16[N+1]=s,this.uint16[N+2]=h,this.uint16[N+3]=m,this.uint16[N+4]=y,this.uint16[N+5]=b,this.uint16[N+6]=C,this.uint16[N+7]=M,e}}ud.prototype.bytesPerElement=16,li("StructArrayLayout8ui16",ud);class rf extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe){const it=this.length;return this.resize(it+1),this.emplace(it,e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe)}emplace(e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe,it){const yt=16*e;return this.int16[yt+0]=i,this.int16[yt+1]=s,this.int16[yt+2]=h,this.int16[yt+3]=m,this.uint16[yt+4]=y,this.uint16[yt+5]=b,this.uint16[yt+6]=C,this.uint16[yt+7]=M,this.int16[yt+8]=N,this.int16[yt+9]=j,this.int16[yt+10]=H,this.int16[yt+11]=pe,this.int16[yt+12]=be,this.int16[yt+13]=Le,this.int16[yt+14]=qe,this.int16[yt+15]=it,e}}rf.prototype.bytesPerElement=32,li("StructArrayLayout4i4ui4i4i32",rf);class Qc extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}Qc.prototype.bytesPerElement=4,li("StructArrayLayout1ul4",Qc);class ku extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b,C,M,N,j,H,pe){const be=this.length;return this.resize(be+1),this.emplace(be,e,i,s,h,m,y,b,C,M,N,j,H,pe)}emplace(e,i,s,h,m,y,b,C,M,N,j,H,pe,be){const Le=20*e,qe=10*e;return this.int16[Le+0]=i,this.int16[Le+1]=s,this.int16[Le+2]=h,this.int16[Le+3]=m,this.int16[Le+4]=y,this.float32[qe+3]=b,this.float32[qe+4]=C,this.float32[qe+5]=M,this.float32[qe+6]=N,this.int16[Le+14]=j,this.uint32[qe+8]=H,this.uint16[Le+18]=pe,this.uint16[Le+19]=be,e}}ku.prototype.bytesPerElement=40,li("StructArrayLayout5i4f1i1ul2ui40",ku);class Ou extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,s,h,m,y,b)}emplace(e,i,s,h,m,y,b,C){const M=8*e;return this.int16[M+0]=i,this.int16[M+1]=s,this.int16[M+2]=h,this.int16[M+4]=m,this.int16[M+5]=y,this.int16[M+6]=b,this.int16[M+7]=C,e}}Ou.prototype.bytesPerElement=16,li("StructArrayLayout3i2i2i16",Ou);class dd extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,i,s,h,m)}emplace(e,i,s,h,m,y){const b=4*e,C=8*e;return this.float32[b+0]=i,this.float32[b+1]=s,this.float32[b+2]=h,this.int16[C+6]=m,this.int16[C+7]=y,e}}dd.prototype.bytesPerElement=16,li("StructArrayLayout2f1f2i16",dd);class hd extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,s,h)}emplace(e,i,s,h,m){const y=12*e,b=3*e;return this.uint8[y+0]=i,this.uint8[y+1]=s,this.float32[b+1]=h,this.float32[b+2]=m,e}}hd.prototype.bytesPerElement=12,li("StructArrayLayout2ub2f12",hd);class Qs extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const m=3*e;return this.uint16[m+0]=i,this.uint16[m+1]=s,this.uint16[m+2]=h,e}}Qs.prototype.bytesPerElement=6,li("StructArrayLayout3ui6",Qs);class yh extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe,it,yt,Mt,Nt,Vt){const jt=this.length;return this.resize(jt+1),this.emplace(jt,e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe,it,yt,Mt,Nt,Vt)}emplace(e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe,it,yt,Mt,Nt,Vt,jt){const wn=30*e,vn=15*e,Xn=60*e;return this.int16[wn+0]=i,this.int16[wn+1]=s,this.int16[wn+2]=h,this.float32[vn+2]=m,this.float32[vn+3]=y,this.uint16[wn+8]=b,this.uint16[wn+9]=C,this.uint32[vn+5]=M,this.uint32[vn+6]=N,this.uint32[vn+7]=j,this.uint16[wn+16]=H,this.uint16[wn+17]=pe,this.uint16[wn+18]=be,this.float32[vn+10]=Le,this.float32[vn+11]=qe,this.uint8[Xn+48]=it,this.uint8[Xn+49]=yt,this.uint8[Xn+50]=Mt,this.uint32[vn+13]=Nt,this.int16[wn+28]=Vt,this.uint8[Xn+58]=jt,e}}yh.prototype.bytesPerElement=60,li("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",yh);class vh extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe,it,yt,Mt,Nt,Vt,jt,wn,vn,Xn,Un,xn,Zn,ei,En){const ci=this.length;return this.resize(ci+1),this.emplace(ci,e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe,it,yt,Mt,Nt,Vt,jt,wn,vn,Xn,Un,xn,Zn,ei,En)}emplace(e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe,it,yt,Mt,Nt,Vt,jt,wn,vn,Xn,Un,xn,Zn,ei,En,ci){const yi=38*e,Nr=19*e;return this.int16[yi+0]=i,this.int16[yi+1]=s,this.int16[yi+2]=h,this.float32[Nr+2]=m,this.float32[Nr+3]=y,this.int16[yi+8]=b,this.int16[yi+9]=C,this.int16[yi+10]=M,this.int16[yi+11]=N,this.int16[yi+12]=j,this.int16[yi+13]=H,this.uint16[yi+14]=pe,this.uint16[yi+15]=be,this.uint16[yi+16]=Le,this.uint16[yi+17]=qe,this.uint16[yi+18]=it,this.uint16[yi+19]=yt,this.uint16[yi+20]=Mt,this.uint16[yi+21]=Nt,this.uint16[yi+22]=Vt,this.uint16[yi+23]=jt,this.uint16[yi+24]=wn,this.uint16[yi+25]=vn,this.uint16[yi+26]=Xn,this.uint16[yi+27]=Un,this.uint16[yi+28]=xn,this.uint32[Nr+15]=Zn,this.float32[Nr+16]=ei,this.float32[Nr+17]=En,this.float32[Nr+18]=ci,e}}vh.prototype.bytesPerElement=76,li("StructArrayLayout3i2f6i15ui1ul3f76",vh);class pd extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}pd.prototype.bytesPerElement=4,li("StructArrayLayout1f4",pd);class xh extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,i,s)}emplace(e,i,s,h){const m=3*e;return this.int16[m+0]=i,this.int16[m+1]=s,this.int16[m+2]=h,e}}xh.prototype.bytesPerElement=6,li("StructArrayLayout3i6",xh);class Ru extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h,m,y,b){const C=this.length;return this.resize(C+1),this.emplace(C,e,i,s,h,m,y,b)}emplace(e,i,s,h,m,y,b,C){const M=7*e;return this.float32[M+0]=i,this.float32[M+1]=s,this.float32[M+2]=h,this.float32[M+3]=m,this.float32[M+4]=y,this.float32[M+5]=b,this.float32[M+6]=C,e}}Ru.prototype.bytesPerElement=28,li("StructArrayLayout7f28",Ru);class fl extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,s,h)}emplace(e,i,s,h,m){const y=6*e;return this.uint32[3*e+0]=i,this.uint16[y+2]=s,this.uint16[y+3]=h,this.uint16[y+4]=m,e}}fl.prototype.bytesPerElement=12,li("StructArrayLayout1ul3ui12",fl);class Da extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const h=2*e;return this.uint16[h+0]=i,this.uint16[h+1]=s,e}}Da.prototype.bytesPerElement=4,li("StructArrayLayout2ui4",Da);class fd extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}fd.prototype.bytesPerElement=2,li("StructArrayLayout1ui2",fd);class bh extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const s=this.length;return this.resize(s+1),this.emplace(s,e,i)}emplace(e,i,s){const h=2*e;return this.float32[h+0]=i,this.float32[h+1]=s,e}}bh.prototype.bytesPerElement=8,li("StructArrayLayout2f8",bh);class of extends Yo{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,s,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,i,s,h)}emplace(e,i,s,h,m){const y=4*e;return this.float32[y+0]=i,this.float32[y+1]=s,this.float32[y+2]=h,this.float32[y+3]=m,e}}of.prototype.bytesPerElement=16,li("StructArrayLayout4f16",of);class jm extends Su{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}jm.prototype.size=40;class sf extends ku{get(e){return new jm(this,e)}}li("CollisionBoxArray",sf);class Gm extends Su{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Gm.prototype.size=60;class wh extends yh{get(e){return new Gm(this,e)}}li("PlacedSymbolArray",wh);class af extends Su{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}af.prototype.size=76;class lf extends vh{get(e){return new af(this,e)}}li("SymbolInstanceArray",lf);class cf extends pd{getoffsetX(e){return this.float32[1*e+0]}}li("GlyphOffsetArray",cf);class uf extends xh{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}li("SymbolLineVertexArray",uf);class qm extends Su{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}qm.prototype.size=12;class df extends fl{get(e){return new qm(this,e)}}li("FeatureIndexArray",df);class Lu extends Su{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Lu.prototype.size=4;class Th extends Da{get(e){return new Lu(this,e)}}li("FillExtrusionCentroidArray",Th);const ml=Bo([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Fu=Bo([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Ch=Oe(function(t){t.exports=function(e,i){var s,h,m,y,b,C,M,N;for(h=e.length-(s=3&e.length),m=i,b=3432918353,C=461845907,N=0;N<h;)M=255&e.charCodeAt(N)|(255&e.charCodeAt(++N))<<8|(255&e.charCodeAt(++N))<<16|(255&e.charCodeAt(++N))<<24,++N,m=27492+(65535&(y=5*(65535&(m=(m^=M=(65535&(M=(M=(65535&M)*b+(((M>>>16)*b&65535)<<16)&4294967295)<<15|M>>>17))*C+(((M>>>16)*C&65535)<<16)&4294967295)<<13|m>>>19))+((5*(m>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(M=0,s){case 3:M^=(255&e.charCodeAt(N+2))<<16;case 2:M^=(255&e.charCodeAt(N+1))<<8;case 1:m^=M=(65535&(M=(M=(65535&(M^=255&e.charCodeAt(N)))*b+(((M>>>16)*b&65535)<<16)&4294967295)<<15|M>>>17))*C+(((M>>>16)*C&65535)<<16)&4294967295}return m^=e.length,m=2246822507*(65535&(m^=m>>>16))+((2246822507*(m>>>16)&65535)<<16)&4294967295,m=3266489909*(65535&(m^=m>>>13))+((3266489909*(m>>>16)&65535)<<16)&4294967295,(m^=m>>>16)>>>0}}),hf=Oe(function(t){t.exports=function(e,i){for(var s,h=e.length,m=i^h,y=0;h>=4;)s=1540483477*(65535&(s=255&e.charCodeAt(y)|(255&e.charCodeAt(++y))<<8|(255&e.charCodeAt(++y))<<16|(255&e.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),m=1540483477*(65535&m)+((1540483477*(m>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),h-=4,++y;switch(h){case 3:m^=(255&e.charCodeAt(y+2))<<16;case 2:m^=(255&e.charCodeAt(y+1))<<8;case 1:m=1540483477*(65535&(m^=255&e.charCodeAt(y)))+((1540483477*(m>>>16)&65535)<<16)}return m=1540483477*(65535&(m^=m>>>13))+((1540483477*(m>>>16)&65535)<<16),(m^=m>>>15)>>>0}}),eu=Ch,Z_=hf;eu.murmur3=Ch,eu.murmur2=Z_;class Eh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,s,h){this.ids.push(Hm(e)),this.positions.push(i,s,h)}getPositions(e){const i=Hm(e);let s=0,h=this.ids.length-1;for(;s<h;){const y=s+h>>1;this.ids[y]>=i?h=y:s=y+1}const m=[];for(;this.ids[s]===i;)m.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return m}static serialize(e,i){const s=new Float64Array(e.ids),h=new Uint32Array(e.positions);return Bu(s,h,0,s.length-1),i&&i.push(s.buffer,h.buffer),{ids:s,positions:h}}static deserialize(e){const i=new Eh;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function Hm(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:eu(String(t))}function Bu(t,e,i,s){for(;i<s;){const h=t[i+s>>1];let m=i-1,y=s+1;for(;;){do{m++}while(t[m]<h);do{y--}while(t[y]>h);if(m>=y)break;tu(t,m,y),tu(e,3*m,3*y),tu(e,3*m+1,3*y+1),tu(e,3*m+2,3*y+2)}y-i<s-y?(Bu(t,e,i,y),i=y+1):(Bu(t,e,y+1,s),s=y)}}function tu(t,e,i){const s=t[e];t[e]=t[i],t[i]=s}li("FeaturePositionMap",Eh);class qa{constructor(e,i){this.gl=e.gl,this.location=i}}class Dh extends qa{constructor(e,i){super(e,i),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Wm extends qa{constructor(e,i){super(e,i),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Ih extends qa{constructor(e,i){super(e,i),this.current=ht.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Ym=new Float32Array(16),Jm=new Float32Array(9),Km=new Float32Array(4);function Ah(t){return[$m(255*t.r,255*t.g),$m(255*t.b,255*t.a)]}class nu{constructor(e,i,s){this.value=e,this.uniformNames=i.map(h=>`u_${h}`),this.type=s}setUniform(e,i,s){e.set(s.constantOr(this.value))}getBinding(e,i,s){return"color"===this.type?new Ih(e,i):new Dh(e,i)}}class Fl{constructor(e,i){this.uniformNames=i.map(s=>`u_${s}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,i){this.pixelRatioFrom=i.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=i.tl.concat(i.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,i,s,h){const m="u_pattern_to"===h||"u_dash_to"===h?this.patternTo:"u_pattern_from"===h||"u_dash_from"===h?this.patternFrom:"u_pixel_ratio_to"===h?this.pixelRatioTo:"u_pixel_ratio_from"===h?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,i,s){return"u_pattern_from"===s||"u_pattern_to"===s||"u_dash_from"===s||"u_dash_to"===s?new Wm(e,i):new Dh(e,i)}}class Bl{constructor(e,i,s,h){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=i.map(m=>({name:`a_${m}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,i,s,h,m,y){const b=this.paintVertexArray.length,C=this.expression.evaluate(new lr(0),i,{},m,h,y);this.paintVertexArray.resize(e),this._setPaintValue(b,e,C)}updatePaintArray(e,i,s,h,m){const y=this.expression.evaluate({zoom:0},s,h,void 0,m);this._setPaintValue(e,i,y)}_setPaintValue(e,i,s){if("color"===this.type){const h=Ah(s);for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=e;h<i;h++)this.paintVertexArray.emplace(h,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class da{constructor(e,i,s,h,m,y){this.expression=e,this.uniformNames=i.map(b=>`u_${b}_t`),this.type=s,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=i.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,i,s,h,m,y){const b=this.expression.evaluate(new lr(this.zoom),i,{},m,h,y),C=this.expression.evaluate(new lr(this.zoom+1),i,{},m,h,y),M=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(M,e,b,C)}updatePaintArray(e,i,s,h,m){const y=this.expression.evaluate({zoom:this.zoom},s,h,void 0,m),b=this.expression.evaluate({zoom:this.zoom+1},s,h,void 0,m);this._setPaintValue(e,i,y,b)}_setPaintValue(e,i,s,h){if("color"===this.type){const m=Ah(s),y=Ah(h);for(let b=e;b<i;b++)this.paintVertexArray.emplace(b,m[0],m[1],y[0],y[1])}else{for(let m=e;m<i;m++)this.paintVertexArray.emplace(m,s,h);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i){const s=this.useIntegerZoom?Math.floor(i.zoom):i.zoom,h=Ri(this.expression.interpolationFactor(s,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,i,s){return new Dh(e,i)}}class oc{constructor(e,i,s,h,m,y,b){this.expression=e,this.type=s,this.useIntegerZoom=h,this.zoom=m,this.layerId=b,this.paintVertexAttributes=("array"===s?Fu:ml).members;for(let C=0;C<i.length;++C);this.zoomInPaintVertexArray=new y,this.zoomOutPaintVertexArray=new y}populatePaintArray(e,i,s){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,i.patterns&&i.patterns[this.layerId],s)}updatePaintArray(e,i,s,h,m,y){this._setPaintValues(e,i,s.patterns&&s.patterns[this.layerId],y)}_setPaintValues(e,i,s,h){if(!h||!s)return;const{min:m,mid:y,max:b}=s,C=h[m],M=h[y],N=h[b];if(C&&M&&N)for(let j=e;j<i;j++)this._setPaintValue(this.zoomInPaintVertexArray,j,M,C),this._setPaintValue(this.zoomOutPaintVertexArray,j,M,N)}_setPaintValue(e,i,s,h){e.emplace(i,s.tl[0],s.tl[1],s.br[0],s.br[1],h.tl[0],h.tl[1],h.br[0],h.br[1],s.pixelRatio,h.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Po{constructor(e,i,s=(()=>!0)){this.binders={},this._buffers=[];const h=[];for(const m in e.paint._values){if(!s(m))continue;const y=e.paint.get(m);if(!(y instanceof bs&&ll(y.property.specification)))continue;const b=Mh(m,e.type),C=y.value,M=y.property.specification.type,N=y.property.useIntegerZoom,j=y.property.specification["property-type"],H="cross-faded"===j||"cross-faded-data-driven"===j,pe="line-dasharray"===String(m)&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==C.kind||pe)if("source"===C.kind||pe||H){const be=ff(m,M,"source");this.binders[m]=H?new oc(C,b,M,N,i,be,e.id):new Bl(C,b,M,be),h.push(`/a_${m}`)}else{const be=ff(m,M,"composite");this.binders[m]=new da(C,b,M,N,i,be),h.push(`/z_${m}`)}else this.binders[m]=H?new Fl(C.value,b):new nu(C.value,b,M),h.push(`/u_${m}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof Bl||i instanceof da?i.maxValue:0}populatePaintArrays(e,i,s,h,m,y){for(const b in this.binders){const C=this.binders[b];(C instanceof Bl||C instanceof da||C instanceof oc)&&C.populatePaintArray(e,i,s,h,m,y)}}setConstantPatternPositions(e,i){for(const s in this.binders){const h=this.binders[s];h instanceof Fl&&h.setConstantPatternPositions(e,i)}}updatePaintArrays(e,i,s,h,m,y){let b=!1;for(const C in e){const M=i.getPositions(C);for(const N of M){const j=s.feature(N.index);for(const H in this.binders){const pe=this.binders[H];if((pe instanceof Bl||pe instanceof da||pe instanceof oc)&&!0===pe.expression.isStateDependent){const be=h.paint.get(H);pe.expression=be.value,pe.updatePaintArray(N.start,N.end,j,e[C],m,y),b=!0}}}}return b}defines(){const e=[];for(const i in this.binders){const s=this.binders[i];(s instanceof nu||s instanceof Fl)&&e.push(...s.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof Bl||s instanceof da||s instanceof oc)for(let h=0;h<s.paintVertexAttributes.length;h++)e.push(s.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const s=this.binders[i];if(s instanceof nu||s instanceof Fl||s instanceof da)for(const h of s.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,i){const s=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof nu||m instanceof Fl||m instanceof da)for(const y of m.uniformNames)if(i[y]){const b=m.getBinding(e,i[y],y);s.push({name:y,property:h,binding:b})}}return s}setUniforms(e,i,s,h){for(const{name:m,property:y,binding:b}of i)this.binders[y].setUniform(b,h,s.get(y),m)}updatePaintBuffers(e){this._buffers=[];for(const i in this.binders){const s=this.binders[i];if(e&&s instanceof oc){const h=2===e.fromScale?s.zoomInPaintVertexBuffer:s.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(s instanceof Bl||s instanceof da)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(e){for(const i in this.binders){const s=this.binders[i];(s instanceof Bl||s instanceof da||s instanceof oc)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof Bl||i instanceof da||i instanceof oc)&&i.destroy()}}}class Sc{constructor(e,i,s=(()=>!0)){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new Po(h,i,s);this.needsUpload=!1,this._featureMap=new Eh,this._bufferOffset=0}populatePaintArrays(e,i,s,h,m,y,b){for(const C in this.programConfigurations)this.programConfigurations[C].populatePaintArrays(e,i,h,m,y,b);void 0!==i.id&&this._featureMap.add(i.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,s,h,m){for(const y of s)this.needsUpload=this.programConfigurations[y.id].updatePaintArrays(e,this._featureMap,i,y,h,m)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Xm={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Mh(t,e){return Xm[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const pf={"line-pattern":{source:rc,composite:rc},"fill-pattern":{source:rc,composite:rc},"fill-extrusion-pattern":{source:rc,composite:rc},"line-dasharray":{source:ud,composite:ud}},Qm={color:{source:bh,composite:of},number:{source:pd,composite:bh}};function ff(t,e,i){const s=pf[t];return s&&s[i]||Qm[e][i]}li("ConstantBinder",nu),li("CrossFadedConstantBinder",Fl),li("SourceExpressionBinder",Bl),li("CrossFadedCompositeBinder",oc),li("CompositeExpressionBinder",da),li("ProgramConfiguration",Po,{omit:["_buffers"]}),li("ProgramConfigurationSet",Sc);const md="-transition";class Ha extends qn{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new ic(i.layout)),i.paint)){this._transitionablePaint=new Rs(i.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Ea(i.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,s={}){null!=i&&this._validate(Do,`layers.${this.id}.layout.${e}`,e,i,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return Ie(e,md)?this._transitionablePaint.getTransition(e.slice(0,-md.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,s={}){if(null!=i&&this._validate(Ji,`layers.${this.id}.paint.${e}`,e,i,s))return!1;if(Ie(e,md))return this._transitionablePaint.setTransition(e.slice(0,-md.length),i||void 0),!1;{const h=this._transitionablePaint._values[e],m="cross-faded-data-driven"===h.property.specification["property-type"],y=h.value.isDataDriven(),b=h.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const C=this._transitionablePaint._values[e].value;return C.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(e,b,C)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),nn(e,(i,s)=>!(void 0===i||"layout"===s&&!Object.keys(i).length||"paint"===s&&!Object.keys(i).length))}_validate(e,i,s,h,m={}){return(!m||!1!==m.validate)&&lo(this,e.call(Tn,{key:i,layerType:this.type,objectKey:s,value:h,styleSpec:Bt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof bs&&ll(i.property.specification)&&("source"===i.value.kind||"composite"===i.value.kind)&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Ua(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const eg=Bo([{name:"a_pos",components:2,type:"Int16"}],4),{members:V_}=eg;class Jo{constructor(e=[]){this.segments=e}prepareSegment(e,i,s,h){let m=this.segments[this.segments.length-1];return e>Jo.MAX_VERTEX_ARRAY_LENGTH&&Li(`Max vertices per segment is ${Jo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>Jo.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:i.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==h&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,s,h){return new Jo([{vertexOffset:e,primitiveOffset:i,vertexLength:s,primitiveLength:h,vaos:{},sortKey:0}])}}Jo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,li("SegmentVector",Jo);var yr=8192;class is{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof _o?new _o(e.lng,e.lat):_o.convert(e),this}setSouthWest(e){return this._sw=e instanceof _o?new _o(e.lng,e.lat):_o.convert(e),this}extend(e){const i=this._sw,s=this._ne;let h,m;if(e instanceof _o)h=e,m=e;else{if(!(e instanceof is))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(is.convert(e)):this.extend(_o.convert(e)):this;if(h=e._sw,m=e._ne,!h||!m)return this}return i||s?(i.lng=Math.min(h.lng,i.lng),i.lat=Math.min(h.lat,i.lat),s.lng=Math.max(m.lng,s.lng),s.lat=Math.max(m.lat,s.lat)):(this._sw=new _o(h.lng,h.lat),this._ne=new _o(m.lng,m.lat)),this}getCenter(){return new _o((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new _o(this.getWest(),this.getNorth())}getSouthEast(){return new _o(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:s}=_o.convert(e);let h=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&h}static convert(e){return!e||e instanceof is?e:new is(e)}}const gd=6371008.8;class _o{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new _o(Si(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,s=this.lat*i,h=e.lat*i,m=Math.sin(s)*Math.sin(h)+Math.cos(s)*Math.cos(h)*Math.cos((e.lng-this.lng)*i);return gd*Math.acos(Math.min(m,1))}toBounds(e=0){const i=360*e/40075017,s=i/Math.cos(Math.PI/180*this.lat);return new is(new _o(this.lng-s,this.lat-i),new _o(this.lng+s,this.lat+i))}static convert(e){if(e instanceof _o)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new _o(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new _o(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Sh=2*Math.PI*gd;function Is(t){return Sh*Math.cos(t*Math.PI/180)}function gl(t){return(180+t)/360}function sc(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Wa(t,e){return t/Is(e)}function Nl(t){return 360*t-180}function ha(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function mf(t,e){return t*Is(ha(e))}const Ya=85.051129;class _d{constructor(e,i,s=0){this.x=+e,this.y=+i,this.z=+s}static fromLngLat(e,i=0){const s=_o.convert(e);return new _d(gl(s.lng),sc(s.lat),Wa(i,s.lat))}toLngLat(){return new _o(Nl(this.x),ha(this.y))}toAltitude(){return mf(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Sh*(e=ha(this.y),1/Math.cos(e*Math.PI/180));var e}}function yd(t,e,i,s,h,m,y,b,C){const M=(e+s)/2,N=(i+h)/2,j=new L(M,N);b(j),function(H,pe,be,Le,qe,it){const yt=be-qe,Mt=Le-it;return Math.abs((Le-pe)*yt-(be-H)*Mt)/Math.hypot(yt,Mt)}(j.x,j.y,m.x,m.y,y.x,y.y)>=C?(yd(t,e,i,M,N,m,j,b,C),yd(t,M,N,s,h,j,y,b,C)):t.push(y)}function tg(t,e,i){const s=[];let h,m,y;for(const b of t){const{x:C,y:M}=b;e(b),y?yd(s,h,m,C,M,y,b,e,i):s.push(b),h=C,m=M,y=b}return s}const Ph=Math.pow(2,14)-1,vd=-Ph-1;function ng(t,e){const i=Math.round(t.x*e),s=Math.round(t.y*e);return t.x=Ri(i,vd,Ph),t.y=Ri(s,vd,Ph),(i<t.x||i>t.x+1||s<t.y||s>t.y+1)&&Li("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function zl(t,e,i){const s=t.loadGeometry(),h=t.extent,m=yr/h;if(e&&i&&i.projection.isReprojectedInTileSpace){const y=1<<e.z,{scale:b,x:C,y:M,projection:N}=i,j=H=>{const pe=Nl((e.x+H.x/h)/y),be=ha((e.y+H.y/h)/y),Le=N.project(pe,be);H.x=(Le.x*b-C)*h,H.y=(Le.y*b-M)*h};for(let H=0;H<s.length;H++)if(1!==t.type)s[H]=tg(s[H],j,1);else{const pe=[];for(const be of s[H])be.x<0||be.x>=h||be.y<0||be.y>=h||(j(be),pe.push(be));s[H]=pe}}for(const y of s)for(const b of y)ng(b,m);return s}function Ul(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?zl(t):[]}}function xd(t,e,i,s,h){t.emplaceBack(2*e+(s+1)/2,2*i+(h+1)/2)}class kh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Xc,this.indexArray=new Qs,this.segments=new Jo,this.programConfigurations=new Sc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s,h){const m=this.layers[0],y=[];let b=null;"circle"===m.type&&(b=m.layout.get("circle-sort-key"));for(const{feature:C,id:M,index:N,sourceLayerIndex:j}of e){const H=this.layers[0]._featureFilter.needGeometry,pe=Ul(C,H);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),pe,s))continue;const be=b?b.evaluate(pe,{},s):void 0,Le={id:M,properties:C.properties,type:C.type,sourceLayerIndex:j,index:N,geometry:H?pe.geometry:zl(C,s,h),patterns:{},sortKey:be};y.push(Le)}b&&y.sort((C,M)=>C.sortKey-M.sortKey);for(const C of y){const{geometry:M,index:N,sourceLayerIndex:j}=C,H=e[N].feature;this.addFeature(C,M,N,i.availableImages,s),i.featureIndex.insert(H,M,N,j,this.index)}}update(e,i,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,V_),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,s,h,m){for(const y of i)for(const b of y){const C=b.x,M=b.y;if(C<0||C>=yr||M<0||M>=yr)continue;const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),j=N.vertexLength;xd(this.layoutVertexArray,C,M,-1,-1),xd(this.layoutVertexArray,C,M,1,-1),xd(this.layoutVertexArray,C,M,1,1),xd(this.layoutVertexArray,C,M,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+3,j+2),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},h,m)}}function iu(t,e){for(let i=0;i<t.length;i++)if(ru(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(ru(t,e[i]))return!0;return!!Oh(t,e)}function ig(t,e,i){return!!ru(t,e)||!!bd(e,t,i)}function gf(t,e){if(1===t.length)return yf(e,t[0]);for(let i=0;i<e.length;i++){const s=e[i];for(let h=0;h<s.length;h++)if(ru(t,s[h]))return!0}for(let i=0;i<t.length;i++)if(yf(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Oh(t,e[i]))return!0;return!1}function rg(t,e,i){if(t.length>1){if(Oh(t,e))return!0;for(let s=0;s<e.length;s++)if(bd(e[s],t,i))return!0}for(let s=0;s<t.length;s++)if(bd(t[s],e,i))return!0;return!1}function Oh(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const s=t[i],h=t[i+1];for(let m=0;m<e.length-1;m++)if(og(s,h,e[m],e[m+1]))return!0}return!1}function og(t,e,i,s){return Ei(t,i,s)!==Ei(e,i,s)&&Ei(t,e,i)!==Ei(t,e,s)}function bd(t,e,i){const s=i*i;if(1===e.length)return t.distSqr(e[0])<s;for(let h=1;h<e.length;h++)if(_f(t,e[h-1],e[h])<s)return!0;return!1}function _f(t,e,i){const s=e.distSqr(i);if(0===s)return t.distSqr(e);const h=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/s;return t.distSqr(h<0?e:h>1?i:i.sub(e)._mult(h)._add(e))}function yf(t,e){let i,s,h,m=!1;for(let y=0;y<t.length;y++){i=t[y];for(let b=0,C=i.length-1;b<i.length;C=b++)s=i[b],h=i[C],s.y>e.y!=h.y>e.y&&e.x<(h.x-s.x)*(e.y-s.y)/(h.y-s.y)+s.x&&(m=!m)}return m}function ru(t,e){let i=!1;for(let s=0,h=t.length-1;s<t.length;h=s++){const m=t[s],y=t[h];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(i=!i)}return i}function vf(t,e,i,s,h){for(const y of t)if(e<=y.x&&i<=y.y&&s>=y.x&&h>=y.y)return!0;const m=[new L(e,i),new L(e,h),new L(s,h),new L(s,i)];if(t.length>2)for(const y of m)if(ru(t,y))return!0;for(let y=0;y<t.length-1;y++)if(xf(t[y],t[y+1],m))return!0;return!1}function xf(t,e,i){const s=i[0],h=i[2];if(t.x<s.x&&e.x<s.x||t.x>h.x&&e.x>h.x||t.y<s.y&&e.y<s.y||t.y>h.y&&e.y>h.y)return!1;const m=Ei(t,e,i[0]);return m!==Ei(t,e,i[1])||m!==Ei(t,e,i[2])||m!==Ei(t,e,i[3])}function ou(t,e,i){const s=e.paint.get(t).value;return"constant"===s.kind?s.value:i.programConfigurations.get(e.id).getMaxValue(t)}function wd(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function bf(t,e,i,s,h){if(!e[0]&&!e[1])return t;const m=L.convert(e)._mult(h);"viewport"===i&&m._rotate(-s);const y=[];for(let b=0;b<t.length;b++)y.push(t[b].sub(m));return y}function Pc(t,e,i,s){const h=L.convert(t)._mult(s);return"viewport"===e&&h._rotate(-i),h}li("CircleBucket",kh,{omit:["layers"]});const _l=new fs({"circle-sort-key":new Ni(Bt.layout_circle["circle-sort-key"])});var $_={paint:new fs({"circle-radius":new Ni(Bt.paint_circle["circle-radius"]),"circle-color":new Ni(Bt.paint_circle["circle-color"]),"circle-blur":new Ni(Bt.paint_circle["circle-blur"]),"circle-opacity":new Ni(Bt.paint_circle["circle-opacity"]),"circle-translate":new _i(Bt.paint_circle["circle-translate"]),"circle-translate-anchor":new _i(Bt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new _i(Bt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new _i(Bt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Ni(Bt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Ni(Bt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Ni(Bt.paint_circle["circle-stroke-opacity"])}),layout:_l};class wf{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,s,h){const m=Math.pow(2,s),y=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(C=>{const M=si([],C,e),N=1/M[3]/i*m;return(j=M)[0]=(H=M)[0]*(pe=[N,N,h?1/M[3]:N,N])[0],j[1]=H[1]*pe[1],j[2]=H[2]*pe[2],j[3]=H[3]*pe[3],j;var j,H,pe}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(C=>{const M=Lt([],Vn([],Jt([],y[C[0]],y[C[1]]),Jt([],y[C[2]],y[C[1]]))),N=-Ht(M,y[C[1]]);return M.concat(N)});return new wf(y,b)}}class Ia{constructor(e,i){this.min=e,this.max=i,this.center=Ct([],Je([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],s=He(this.min),h=He(this.max);for(let m=0;m<i.length;m++)s[m]=i[m]?this.min[m]:this.center[m],h[m]=i[m]?this.center[m]:this.max[m];return h[2]=this.max[2],new Ia(s,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let s=!0;for(let h=0;h<e.planes.length;h++){const m=e.planes[h];let y=0;for(let b=0;b<i.length;b++)y+=Ht(m,i[b])+m[3]>=0;if(0===y)return 0;y!==i.length&&(s=!1)}if(s)return 2;for(let h=0;h<3;h++){let m=Number.MAX_VALUE,y=-Number.MAX_VALUE;for(let b=0;b<e.points.length;b++){const C=e.points[b][h]-this.min[h];m=Math.min(m,C),y=Math.max(y,C)}if(y<0||m>this.max[h]-this.min[h])return 0}return 1}}function sg(t,e,i,s,h,m,y,b,C){if(m&&t.queryGeometry.isAboveHorizon)return!1;m&&(C*=t.pixelToTileUnitsFactor);for(const M of e)for(const N of M){const j=N.add(b),H=h&&i.elevation?i.elevation.exaggeration()*h.getElevationAt(j.x,j.y,!0):0,pe=m?j:yl(j,H,s),be=m?t.tilespaceRays.map(qe=>ag(qe,H)):t.queryGeometry.screenGeometry,Le=si([],[N.x,N.y,H,1],s);if(!y&&m?C*=Le[3]/i.cameraToCenterDistance:y&&!m&&(C*=i.cameraToCenterDistance/Le[3]),ig(be,pe,C))return!0}return!1}function yl(t,e,i){const s=si([],[t.x,t.y,e,1],i);return new L(s[0]/s[3],s[1]/s[3])}const Td=xt(0,0,0),Rh=xt(0,0,1);function ag(t,e){const i=Ve();return Td[2]=e,t.intersectsPlane(Td,Rh,i),new L(i[0],i[1])}class Lh extends kh{}function kc(t,{width:e,height:i},s,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*i*s)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*i*s);return t.width=e,t.height=i,t.data=h,t}function Fh(t,{width:e,height:i},s){if(e===t.width&&i===t.height)return;const h=kc({},{width:e,height:i},s);Cd(t,h,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,e),height:Math.min(t.height,i)},s),t.width=e,t.height=i,t.data=h.data}function Cd(t,e,i,s,h,m){if(0===h.width||0===h.height)return e;if(h.width>t.width||h.height>t.height||i.x>t.width-h.width||i.y>t.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||s.x>e.width-h.width||s.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=t.data,b=e.data;for(let C=0;C<h.height;C++){const M=((i.y+C)*t.width+i.x)*m,N=((s.y+C)*e.width+s.x)*m;for(let j=0;j<h.width*m;j++)b[N+j]=y[M+j]}return e}li("HeatmapBucket",Lh,{omit:["layers"]});class vl{constructor(e,i){kc(this,e,1,i)}resize(e){Fh(this,e,1)}clone(){return new vl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,h,m){Cd(e,i,s,h,m,1)}}class Vs{constructor(e,i){kc(this,e,4,i)}resize(e){Fh(this,e,4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Vs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,s,h,m){Cd(e,i,s,h,m,4)}}li("AlphaImage",vl),li("RGBAImage",Vs);var Tf={paint:new fs({"heatmap-radius":new Ni(Bt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Ni(Bt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new _i(Bt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Xs(Bt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new _i(Bt.paint_heatmap["heatmap-opacity"])})};function Cf(t){const e={},i=t.resolution||256,s=t.clips?t.clips.length:1,h=t.image||new Vs({width:i,height:s}),m=(y,b,C)=>{e[t.evaluationKey]=C;const M=t.expression.evaluate(e);h.data[y+b+0]=Math.floor(255*M.r/M.a),h.data[y+b+1]=Math.floor(255*M.g/M.a),h.data[y+b+2]=Math.floor(255*M.b/M.a),h.data[y+b+3]=Math.floor(255*M.a)};if(t.clips)for(let y=0,b=0;y<s;++y,b+=4*i)for(let C=0,M=0;C<i;C++,M+=4){const N=C/(i-1),{start:j,end:H}=t.clips[y];m(b,M,j*(1-N)+H*N)}else for(let y=0,b=0;y<i;y++,b+=4)m(0,b,y/(i-1));return h}var su={paint:new fs({"hillshade-illumination-direction":new _i(Bt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new _i(Bt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new _i(Bt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new _i(Bt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new _i(Bt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new _i(Bt.paint_hillshade["hillshade-accent-color"])})};const Bh=Bo([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ef}=Bh;var Ed=Dd,Nh=Dd;function Dd(t,e,i){i=i||2;var s,h,m,y,b,C,M,N=e&&e.length,j=N?e[0]*i:t.length,H=Df(t,0,j,i,!0),pe=[];if(!H||H.next===H.prev)return pe;if(N&&(H=function(Le,qe,it,yt){var Mt,Nt,Vt,jt=[];for(Mt=0,Nt=qe.length;Mt<Nt;Mt++)(Vt=Df(Le,qe[Mt]*yt,Mt<Nt-1?qe[Mt+1]*yt:Le.length,yt,!1))===Vt.next&&(Vt.steiner=!0),jt.push(Mf(Vt));for(jt.sort(Af),Mt=0;Mt<jt.length;Mt++)it=ac(it=Uh(jt[Mt],it),it.next);return it}(t,e,H,i)),t.length>80*i){s=m=t[0],h=y=t[1];for(var be=i;be<j;be+=i)(b=t[be])<s&&(s=b),(C=t[be+1])<h&&(h=C),b>m&&(m=b),C>y&&(y=C);M=0!==(M=Math.max(m-s,y-h))?1/M:0}return Nu(H,pe,i,s,h,M),pe}function Df(t,e,i,s,h){var m,y;if(h===lu(t,e,i,s)>0)for(m=e;m<i;m+=s)y=$h(m,t[m],t[m+1],y);else for(m=i-s;m>=e;m-=s)y=$h(m,t[m],t[m+1],y);return y&&zu(y,y.next)&&(Fc(y),y=y.next),y}function ac(t,e){if(!t)return t;e||(e=t);var i,s=t;do{if(i=!1,s.steiner||!zu(s,s.next)&&0!==Vo(s.prev,s,s.next))s=s.next;else{if(Fc(s),(s=e=s.prev)===s.next)break;i=!0}}while(i||s!==e);return e}function Nu(t,e,i,s,h,m,y){if(t){!y&&m&&function(N,j,H,pe){var be=N;do{null===be.z&&(be.z=Zh(be.x,be.y,j,H,pe)),be.prevZ=be.prev,be.nextZ=be.next,be=be.next}while(be!==N);be.prevZ.nextZ=null,be.prevZ=null,function(Le){var qe,it,yt,Mt,Nt,Vt,jt,wn,vn=1;do{for(it=Le,Le=null,Nt=null,Vt=0;it;){for(Vt++,yt=it,jt=0,qe=0;qe<vn&&(jt++,yt=yt.nextZ);qe++);for(wn=vn;jt>0||wn>0&&yt;)0!==jt&&(0===wn||!yt||it.z<=yt.z)?(Mt=it,it=it.nextZ,jt--):(Mt=yt,yt=yt.nextZ,wn--),Nt?Nt.nextZ=Mt:Le=Mt,Mt.prevZ=Nt,Nt=Mt;it=yt}Nt.nextZ=null,vn*=2}while(Vt>1)}(be)}(t,s,h,m);for(var b,C,M=t;t.prev!==t.next;)if(b=t.prev,C=t.next,m?cg(t,s,h,m):lg(t))e.push(b.i/i),e.push(t.i/i),e.push(C.i/i),Fc(t),t=C.next,M=C.next;else if((t=C)===M){y?1===y?Nu(t=If(ac(t),e,i),e,i,s,h,m,2):2===y&&zh(t,e,i,s,h,m):Nu(ac(t),e,i,s,h,m,1);break}}}function lg(t){var e=t.prev,i=t,s=t.next;if(Vo(e,i,s)>=0)return!1;for(var h=t.next.next;h!==t.prev;){if(Oc(e.x,e.y,i.x,i.y,s.x,s.y,h.x,h.y)&&Vo(h.prev,h,h.next)>=0)return!1;h=h.next}return!0}function cg(t,e,i,s){var h=t.prev,m=t,y=t.next;if(Vo(h,m,y)>=0)return!1;for(var b=h.x>m.x?h.x>y.x?h.x:y.x:m.x>y.x?m.x:y.x,C=h.y>m.y?h.y>y.y?h.y:y.y:m.y>y.y?m.y:y.y,M=Zh(h.x<m.x?h.x<y.x?h.x:y.x:m.x<y.x?m.x:y.x,h.y<m.y?h.y<y.y?h.y:y.y:m.y<y.y?m.y:y.y,e,i,s),N=Zh(b,C,e,i,s),j=t.prevZ,H=t.nextZ;j&&j.z>=M&&H&&H.z<=N;){if(j!==t.prev&&j!==t.next&&Oc(h.x,h.y,m.x,m.y,y.x,y.y,j.x,j.y)&&Vo(j.prev,j,j.next)>=0||(j=j.prevZ,H!==t.prev&&H!==t.next&&Oc(h.x,h.y,m.x,m.y,y.x,y.y,H.x,H.y)&&Vo(H.prev,H,H.next)>=0))return!1;H=H.nextZ}for(;j&&j.z>=M;){if(j!==t.prev&&j!==t.next&&Oc(h.x,h.y,m.x,m.y,y.x,y.y,j.x,j.y)&&Vo(j.prev,j,j.next)>=0)return!1;j=j.prevZ}for(;H&&H.z<=N;){if(H!==t.prev&&H!==t.next&&Oc(h.x,h.y,m.x,m.y,y.x,y.y,H.x,H.y)&&Vo(H.prev,H,H.next)>=0)return!1;H=H.nextZ}return!0}function If(t,e,i){var s=t;do{var h=s.prev,m=s.next.next;!zu(h,m)&&Sf(h,s,s.next,m)&&au(h,m)&&au(m,h)&&(e.push(h.i/i),e.push(s.i/i),e.push(m.i/i),Fc(s),Fc(s.next),s=t=m),s=s.next}while(s!==t);return ac(s)}function zh(t,e,i,s,h,m){var y=t;do{for(var b=y.next.next;b!==y.prev;){if(y.i!==b.i&&Rc(y,b)){var C=Vh(y,b);return y=ac(y,y.next),C=ac(C,C.next),Nu(y,e,i,s,h,m),void Nu(C,e,i,s,h,m)}b=b.next}y=y.next}while(y!==t)}function Af(t,e){return t.x-e.x}function Uh(t,e){var i=function(m,y){var b,C=y,M=m.x,N=m.y,j=-1/0;do{if(N<=C.y&&N>=C.next.y&&C.next.y!==C.y){var H=C.x+(N-C.y)*(C.next.x-C.x)/(C.next.y-C.y);if(H<=M&&H>j){if(j=H,H===M){if(N===C.y)return C;if(N===C.next.y)return C.next}b=C.x<C.next.x?C:C.next}}C=C.next}while(C!==y);if(!b)return null;if(M===j)return b;var pe,be=b,Le=b.x,qe=b.y,it=1/0;C=b;do{M>=C.x&&C.x>=Le&&M!==C.x&&Oc(N<qe?M:j,N,Le,qe,N<qe?j:M,N,C.x,C.y)&&(pe=Math.abs(N-C.y)/(M-C.x),au(C,m)&&(pe<it||pe===it&&(C.x>b.x||C.x===b.x&&ug(b,C)))&&(b=C,it=pe)),C=C.next}while(C!==be);return b}(t,e);if(!i)return e;var s=Vh(i,t),h=ac(i,i.next);return ac(s,s.next),e===i?h:e}function ug(t,e){return Vo(t.prev,t,e.prev)<0&&Vo(e.next,t,t.next)<0}function Zh(t,e,i,s,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*h)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-s)*h)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Mf(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Oc(t,e,i,s,h,m,y,b){return(h-y)*(e-b)-(t-y)*(m-b)>=0&&(t-y)*(s-b)-(i-y)*(e-b)>=0&&(i-y)*(m-b)-(h-y)*(s-b)>=0}function Rc(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,s){var h=i;do{if(h.i!==i.i&&h.next.i!==i.i&&h.i!==s.i&&h.next.i!==s.i&&Sf(h,h.next,i,s))return!0;h=h.next}while(h!==i);return!1}(t,e)&&(au(t,e)&&au(e,t)&&function(i,s){var h=i,m=!1,y=(i.x+s.x)/2,b=(i.y+s.y)/2;do{h.y>b!=h.next.y>b&&h.next.y!==h.y&&y<(h.next.x-h.x)*(b-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next}while(h!==i);return m}(t,e)&&(Vo(t.prev,t,e.prev)||Vo(t,e.prev,e))||zu(t,e)&&Vo(t.prev,t,t.next)>0&&Vo(e.prev,e,e.next)>0)}function Vo(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function zu(t,e){return t.x===e.x&&t.y===e.y}function Sf(t,e,i,s){var h=Id(Vo(t,e,i)),m=Id(Vo(t,e,s)),y=Id(Vo(i,s,t)),b=Id(Vo(i,s,e));return h!==m&&y!==b||!(0!==h||!Lc(t,i,e))||!(0!==m||!Lc(t,s,e))||!(0!==y||!Lc(i,t,s))||!(0!==b||!Lc(i,e,s))}function Lc(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function Id(t){return t>0?1:t<0?-1:0}function au(t,e){return Vo(t.prev,t,t.next)<0?Vo(t,e,t.next)>=0&&Vo(t,t.prev,e)>=0:Vo(t,e,t.prev)<0||Vo(t,t.next,e)<0}function Vh(t,e){var i=new Ad(t.i,t.x,t.y),s=new Ad(e.i,e.x,e.y),h=t.next,m=e.prev;return t.next=e,e.prev=t,i.next=h,h.prev=i,s.next=i,i.prev=s,m.next=s,s.prev=m,s}function $h(t,e,i,s){var h=new Ad(t,e,i);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function Fc(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Ad(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lu(t,e,i,s){for(var h=0,m=e,y=i-s;m<i;m+=s)h+=(t[y]-t[m])*(t[m+1]+t[y+1]),y=m;return h}function Md(t,e,i,s,h){jh(t,e,i||0,s||t.length-1,h||Pf)}function jh(t,e,i,s,h){for(;s>i;){if(s-i>600){var m=s-i+1,y=e-i+1,b=Math.log(m),C=.5*Math.exp(2*b/3),M=.5*Math.sqrt(b*C*(m-C)/m)*(y-m/2<0?-1:1);jh(t,e,Math.max(i,Math.floor(e-y*C/m+M)),Math.min(s,Math.floor(e+(m-y)*C/m+M)),h)}var N=t[e],j=i,H=s;for(Bc(t,i,e),h(t[s],N)>0&&Bc(t,i,s);j<H;){for(Bc(t,j,H),j++,H--;h(t[j],N)<0;)j++;for(;h(t[H],N)>0;)H--}0===h(t[i],N)?Bc(t,i,H):Bc(t,++H,s),H<=e&&(i=H+1),e<=H&&(s=H-1)}}function Bc(t,e,i){var s=t[e];t[e]=t[i],t[i]=s}function Pf(t,e){return t<e?-1:t>e?1:0}function Uu(t,e){const i=t.length;if(i<=1)return[t];const s=[];let h,m;for(let y=0;y<i;y++){const b=xi(t[y]);0!==b&&(t[y].area=Math.abs(b),void 0===m&&(m=b<0),m===b<0?(h&&s.push(h),h=[t[y]]):h.push(t[y]))}if(h&&s.push(h),e>1)for(let y=0;y<s.length;y++)s[y].length<=e||(Md(s[y],e,1,s[y].length-1,Zu),s[y]=s[y].slice(0,e));return s}function Zu(t,e){return e.area-t.area}function Gh(t,e,i){const s=i.patternDependencies;let h=!1;for(const m of e){const y=m.paint.get(`${t}-pattern`);y.isConstant()||(h=!0);const b=y.constantOr(null);b&&(h=!0,s[b.to]=!0,s[b.from]=!0)}return h}function Sd(t,e,i,s,h){const m=h.patternDependencies;for(const y of e){const b=y.paint.get(`${t}-pattern`).value;if("constant"!==b.kind){let C=b.evaluate({zoom:s-1},i,{},h.availableImages),M=b.evaluate({zoom:s},i,{},h.availableImages),N=b.evaluate({zoom:s+1},i,{},h.availableImages);C=C&&C.name?C.name:C,M=M&&M.name?M.name:M,N=N&&N.name?N.name:N,m[C]=!0,m[M]=!0,m[N]=!0,i.patterns[y.id]={min:C,mid:M,max:N}}}return i}Dd.deviation=function(t,e,i,s){var h=e&&e.length,m=Math.abs(lu(t,0,h?e[0]*i:t.length,i));if(h)for(var y=0,b=e.length;y<b;y++)m-=Math.abs(lu(t,e[y]*i,y<b-1?e[y+1]*i:t.length,i));var C=0;for(y=0;y<s.length;y+=3){var M=s[y]*i,N=s[y+1]*i,j=s[y+2]*i;C+=Math.abs((t[M]-t[j])*(t[N+1]-t[M+1])-(t[M]-t[N])*(t[j+1]-t[M+1]))}return 0===m&&0===C?0:Math.abs((C-m)/m)},Dd.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},s=0,h=0;h<t.length;h++){for(var m=0;m<t[h].length;m++)for(var y=0;y<e;y++)i.vertices.push(t[h][m][y]);h>0&&i.holes.push(s+=t[h-1].length)}return i},Ed.default=Nh;class Pd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Xc,this.indexArray=new Qs,this.indexArray2=new Da,this.programConfigurations=new Sc(e.layers,e.zoom),this.segments=new Jo,this.segments2=new Jo,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s,h){this.hasPattern=Gh("fill",this.layers,i);const m=this.layers[0].layout.get("fill-sort-key"),y=[];for(const{feature:b,id:C,index:M,sourceLayerIndex:N}of e){const j=this.layers[0]._featureFilter.needGeometry,H=Ul(b,j);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),H,s))continue;const pe=m?m.evaluate(H,{},s,i.availableImages):void 0,be={id:C,properties:b.properties,type:b.type,sourceLayerIndex:N,index:M,geometry:j?H.geometry:zl(b,s,h),patterns:{},sortKey:pe};y.push(be)}m&&y.sort((b,C)=>b.sortKey-C.sortKey);for(const b of y){const{geometry:C,index:M,sourceLayerIndex:N}=b;if(this.hasPattern){const j=Sd("fill",this.layers,b,this.zoom,i);this.patternFeatures.push(j)}else this.addFeature(b,C,M,s,{},i.availableImages);i.featureIndex.insert(e[M].feature,C,M,N,this.index)}}update(e,i,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,h)}addFeatures(e,i,s,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ef),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,s,h,m,y=[]){for(const b of Uu(i,500)){let C=0;for(const be of b)C+=be.length;const M=this.segments.prepareSegment(C,this.layoutVertexArray,this.indexArray),N=M.vertexLength,j=[],H=[];for(const be of b){if(0===be.length)continue;be!==b[0]&&H.push(j.length/2);const Le=this.segments2.prepareSegment(be.length,this.layoutVertexArray,this.indexArray2),qe=Le.vertexLength;this.layoutVertexArray.emplaceBack(be[0].x,be[0].y),this.indexArray2.emplaceBack(qe+be.length-1,qe),j.push(be[0].x),j.push(be[0].y);for(let it=1;it<be.length;it++)this.layoutVertexArray.emplaceBack(be[it].x,be[it].y),this.indexArray2.emplaceBack(qe+it-1,qe+it),j.push(be[it].x),j.push(be[it].y);Le.vertexLength+=be.length,Le.primitiveLength+=be.length}const pe=Ed(j,H);for(let be=0;be<pe.length;be+=3)this.indexArray.emplaceBack(N+pe[be],N+pe[be+1],N+pe[be+2]);M.vertexLength+=C,M.primitiveLength+=pe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,m,y,h)}}li("FillBucket",Pd,{omit:["layers","patternFeatures"]});const dg=new fs({"fill-sort-key":new Ni(Bt.layout_fill["fill-sort-key"])});var kf={paint:new fs({"fill-antialias":new _i(Bt.paint_fill["fill-antialias"]),"fill-opacity":new Ni(Bt.paint_fill["fill-opacity"]),"fill-color":new Ni(Bt.paint_fill["fill-color"]),"fill-outline-color":new Ni(Bt.paint_fill["fill-outline-color"]),"fill-translate":new _i(Bt.paint_fill["fill-translate"]),"fill-translate-anchor":new _i(Bt.paint_fill["fill-translate-anchor"]),"fill-pattern":new cs(Bt.paint_fill["fill-pattern"])}),layout:dg};const qh=Bo([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Of=Bo([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:j_}=qh;var Hh=cu;function cu(t,e,i,s,h){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=h,t.readFields(Rf,this,e)}function Rf(t,e,i){1==t?e.id=i.readVarint():2==t?function(s,h){for(var m=s.readVarint()+s.pos;s.pos<m;){var y=h._keys[s.readVarint()],b=h._values[s.readVarint()];h.properties[y]=b}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function hg(t){for(var e,i,s=0,h=0,m=t.length,y=m-1;h<m;y=h++)s+=((i=t[y]).x-(e=t[h]).x)*(e.y+i.y);return s}cu.types=["Unknown","Point","LineString","Polygon"],cu.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,s=1,h=0,m=0,y=0,b=[];t.pos<i;){if(h<=0){var C=t.readVarint();s=7&C,h=C>>3}if(h--,1===s||2===s)m+=t.readSVarint(),y+=t.readSVarint(),1===s&&(e&&b.push(e),e=[]),e.push(new L(m,y));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&b.push(e),b},cu.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,s=0,h=0,m=0,y=1/0,b=-1/0,C=1/0,M=-1/0;t.pos<e;){if(s<=0){var N=t.readVarint();i=7&N,s=N>>3}if(s--,1===i||2===i)(h+=t.readSVarint())<y&&(y=h),h>b&&(b=h),(m+=t.readSVarint())<C&&(C=m),m>M&&(M=m);else if(7!==i)throw new Error("unknown command "+i)}return[y,C,b,M]},cu.prototype.toGeoJSON=function(t,e,i){var s,h,m=this.extent*Math.pow(2,i),y=this.extent*t,b=this.extent*e,C=this.loadGeometry(),M=cu.types[this.type];function N(pe){for(var be=0;be<pe.length;be++){var Le=pe[be];pe[be]=[360*(Le.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(Le.y+b)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var j=[];for(s=0;s<C.length;s++)j[s]=C[s][0];N(C=j);break;case 2:for(s=0;s<C.length;s++)N(C[s]);break;case 3:for(C=function(pe){var be=pe.length;if(be<=1)return[pe];for(var Le,qe,it=[],yt=0;yt<be;yt++){var Mt=hg(pe[yt]);0!==Mt&&(void 0===qe&&(qe=Mt<0),qe===Mt<0?(Le&&it.push(Le),Le=[pe[yt]]):Le.push(pe[yt]))}return Le&&it.push(Le),it}(C),s=0;s<C.length;s++)for(h=0;h<C[s].length;h++)N(C[s][h])}1===C.length?C=C[0]:M="Multi"+M;var H={type:"Feature",geometry:{type:M,coordinates:C},properties:this.properties};return"id"in this&&(H.id=this.id),H};var Lf=Aa;function Aa(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(pg,this,e),this.length=this._features.length}function pg(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(s){for(var h=null,m=s.readVarint()+s.pos;s.pos<m;){var y=s.readVarint()>>3;h=1===y?s.readString():2===y?s.readFloat():3===y?s.readDouble():4===y?s.readVarint64():5===y?s.readVarint():6===y?s.readSVarint():7===y?s.readBoolean():null}return h}(i))}function Ff(t,e,i){if(3===t){var s=new Lf(i,i.readVarint()+i.pos);s.length&&(e[s.name]=s)}}Aa.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Hh(this._pbf,e,this.extent,this._keys,this._values)};var Nc={VectorTile:function(t,e){this.layers=t.readFields(Ff,{},e)},VectorTileFeature:Hh,VectorTileLayer:Lf};const fg=Nc.VectorTileFeature.types,mg=Math.pow(2,13);function Vu(t,e,i,s,h,m,y,b){t.emplaceBack((e<<1)+y,(i<<1)+m,(Math.floor(s*mg)<<1)+h,Math.round(b))}class Wh{constructor(){this.acc=new L(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new L(e.x,e.y),this.max=new L(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);let s=!!this.borders;const h=this.min,m=this.max;e.x<h.x?(h.x=e.x,s=!0):e.x>m.x&&(m.x=e.x,s=!0),e.y<h.y?(h.y=e.y,s=!0):e.y>m.y&&(m.y=e.y,s=!0),((0===e.x||e.x===yr)&&e.x===i.x)!=((0===e.y||e.y===yr)&&e.y===i.y)&&this.processBorderOverlap(e,i),s&&this.checkBorderIntersection(e,i)}checkBorderIntersection(e,i){i.x<0!=e.x<0&&this.addBorderIntersection(0,Zr(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>yr!=e.x>yr&&this.addBorderIntersection(1,Zr(i.y,e.y,(yr-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Zr(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>yr!=e.y>yr&&this.addBorderIntersection(3,Zr(i.x,e.x,(yr-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];i<s[0]&&(s[0]=i),i>s[1]&&(s[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,i.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,i.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((i,s)=>i+s.edges,0);return 0!==e?this.acc.div(e)._round():new L(0,0)}span(){return new L(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class Yh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ll,this.centroidVertexArray=new Th,this.indexArray=new Qs,this.programConfigurations=new Sc(e.layers,e.zoom),this.segments=new Jo,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,s,h){this.features=[],this.hasPattern=Gh("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(m){const y=Math.exp(Math.PI*(1-m.y/(1<<m.z)*2));return 80150034*y/(y*y+1)/yr/(1<<m.z)}(s);for(const{feature:m,id:y,index:b,sourceLayerIndex:C}of e){const M=this.layers[0]._featureFilter.needGeometry,N=Ul(m,M);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),N,s))continue;const j={id:y,sourceLayerIndex:C,index:b,geometry:M?N.geometry:zl(m,s,h),properties:m.properties,type:m.type,patterns:{}},H=this.layoutVertexArray.length;this.hasPattern?this.features.push(Sd("fill-extrusion",this.layers,j,this.zoom,i)):this.addFeature(j,j.geometry,b,s,{},i.availableImages),i.featureIndex.insert(m,j.geometry,b,C,this.index,H)}this.sortBorders()}addFeatures(e,i,s,h){for(const m of this.features){const{geometry:y}=m;this.addFeature(m,y,m.index,i,s,h)}this.sortBorders()}update(e,i,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,j_),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Of.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,s,h,m,y){const b=this.enableTerrain?new Wh:null;for(const M of Uu(i,500)){let N=0,j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===M.length||(C=M[0]).every(qe=>qe.x<=0)||C.every(qe=>qe.x>=yr)||C.every(qe=>qe.y<=0)||C.every(qe=>qe.y>=yr))continue;for(let qe=0;qe<M.length;qe++){const it=M[qe];if(0===it.length)continue;N+=it.length;let yt=0;b&&b.startRing(it[0]);for(let Mt=0;Mt<it.length;Mt++){const Nt=it[Mt];if(Mt>=1){const Vt=it[Mt-1];if(!gg(Nt,Vt)){b&&b.append(Nt,Vt),j.vertexLength+4>Jo.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const jt=Nt.sub(Vt)._perp(),wn=jt.x/(Math.abs(jt.x)+Math.abs(jt.y)),vn=jt.y>0?1:0,Xn=Vt.dist(Nt);yt+Xn>32768&&(yt=0),Vu(this.layoutVertexArray,Nt.x,Nt.y,wn,vn,0,0,yt),Vu(this.layoutVertexArray,Nt.x,Nt.y,wn,vn,0,1,yt),yt+=Xn,Vu(this.layoutVertexArray,Vt.x,Vt.y,wn,vn,0,0,yt),Vu(this.layoutVertexArray,Vt.x,Vt.y,wn,vn,0,1,yt);const Un=j.vertexLength;this.indexArray.emplaceBack(Un,Un+2,Un+1),this.indexArray.emplaceBack(Un+1,Un+2,Un+3),j.vertexLength+=4,j.primitiveLength+=2}}}}if(j.vertexLength+N>Jo.MAX_VERTEX_ARRAY_LENGTH&&(j=this.segments.prepareSegment(N,this.layoutVertexArray,this.indexArray)),"Polygon"!==fg[e.type])continue;const H=[],pe=[],be=j.vertexLength;for(let qe=0;qe<M.length;qe++){const it=M[qe];if(0!==it.length){it!==M[0]&&pe.push(H.length/2);for(let yt=0;yt<it.length;yt++){const Mt=it[yt];Vu(this.layoutVertexArray,Mt.x,Mt.y,0,0,1,1,0),H.push(Mt.x),H.push(Mt.y),b&&b.currentPolyCount.top++}}}const Le=Ed(H,pe);for(let qe=0;qe<Le.length;qe+=3)this.indexArray.emplaceBack(be+Le[qe],be+Le[qe+2],be+Le[qe+1]);j.primitiveLength+=Le.length/3,j.vertexLength+=N}var C;if(b&&b.polyCount.length>0){if(b.borders){b.vertexArrayOffset=this.centroidVertexArray.length;const M=b.borders,N=this.featuresOnBorder.push(b)-1;for(let j=0;j<4;j++)M[j][0]!==Number.MAX_VALUE&&this.borders[j].push(N)}this.encodeCentroid(b.borders?void 0:b.centroid(),b)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,m,y,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,s)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,i,s=!0){let h,m;if(e)if(0!==e.y){const b=i.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(b.x/10)),m=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(b.y/10))}else h=Math.ceil(7*(e.x+450)),m=0;else h=0,m=+s;let y=s?this.centroidVertexArray.length:i.vertexArrayOffset;for(const b of i.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*b.edges+b.top);for(let C=0;C<2*b.edges;C++)this.centroidVertexArray.emplace(y++,0,m),this.centroidVertexArray.emplace(y++,h,m);for(let C=0;C<b.top;C++)this.centroidVertexArray.emplace(y++,h,m)}}}function gg(t,e){return t.x===e.x&&(t.x<0||t.x>yr)||t.y===e.y&&(t.y<0||t.y>yr)}li("FillExtrusionBucket",Yh,{omit:["layers","features"]}),li("PartMetadata",Wh);var _g={paint:new fs({"fill-extrusion-opacity":new _i(Bt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Ni(Bt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new _i(Bt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new _i(Bt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cs(Bt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Ni(Bt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Ni(Bt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new _i(Bt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function fr(t,e){return t.x*e.x+t.y*e.y}function Jh(t,e){if(1===t.length){let i=0;const s=e[i++];let h;for(;!h||s.equals(h);)if(h=e[i++],!h)return 1/0;for(;i<e.length;i++){const m=e[i],y=t[0],b=h.sub(s),C=m.sub(s),M=y.sub(s),N=fr(b,b),j=fr(b,C),H=fr(C,C),pe=fr(M,b),be=fr(M,C),Le=N*H-j*j,qe=(H*pe-j*be)/Le,it=(N*be-j*pe)/Le,yt=s.z*(1-qe-it)+h.z*qe+m.z*it;if(isFinite(yt))return yt}return 1/0}{let i=1/0;for(const s of e)i=Math.min(i,s.z);return i}}function Kh(t){const e=new L(t[0],t[1]);return e.z=t[2],e}function Bf(t,e,i,s,h,m,y,b){const C=y*h.getElevationAt(t,e,!0,!0),M=0!==m[0],N=M?0===m[1]?y*(m[0]/7-450):y*function(j,H,pe){const be=Math.floor(H[0]/8),Le=Math.floor(H[1]/8),qe=10*(H[0]-8*be),it=10*(H[1]-8*Le),yt=j.getElevationAt(be,Le,!0,!0),Mt=j.getMeterToDEM(pe),Nt=Math.floor(.5*(qe*Mt-1)),Vt=Math.floor(.5*(it*Mt-1)),jt=j.tileCoordToPixel(be,Le),wn=2*Nt+1,vn=2*Vt+1,Xn=(bo=wn,Or=vn,[(ci=j).getElevationAtPixel(yi=jt.x-Nt,Nr=jt.y-Vt,!0),ci.getElevationAtPixel(yi+Or,Nr,!0),ci.getElevationAtPixel(yi,Nr+Or,!0),ci.getElevationAtPixel(yi+bo,Nr+Or,!0)]),Un=Math.abs(Xn[0]-Xn[1]),xn=Math.abs(Xn[2]-Xn[3]),Zn=Math.abs(Xn[0]-Xn[2])+Math.abs(Xn[1]-Xn[3]),ei=Math.min(.25,.5*Mt*(Un+xn)/wn),En=Math.min(.25,.5*Mt*Zn/vn);var ci,yi,Nr,bo,Or;return yt+Math.max(ei*qe,En*it)}(h,m,b):C;return{base:C+(0===i)?-1:i,top:M?Math.max(N+s,C+i+2):C+s}}const kd=Bo([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Ja}=kd,Nf=Bo([{name:"a_packed",components:3,type:"Float32"}]),{members:yg}=Nf,Xh=Nc.VectorTileFeature.types,Zl=Math.cos(Math.PI/180*37.5);class uu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new Pu,this.layoutVertexArray2=new Ga,this.indexArray=new Qs,this.programConfigurations=new Sc(e.layers,e.zoom),this.segments=new Jo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,s,h){this.hasPattern=Gh("line",this.layers,i);const m=this.layers[0].layout.get("line-sort-key"),y=[];for(const{feature:N,id:j,index:H,sourceLayerIndex:pe}of e){const be=this.layers[0]._featureFilter.needGeometry,Le=Ul(N,be);if(!this.layers[0]._featureFilter.filter(new lr(this.zoom),Le,s))continue;const qe=m?m.evaluate(Le,{},s):void 0,it={id:j,properties:N.properties,type:N.type,sourceLayerIndex:pe,index:H,geometry:be?Le.geometry:zl(N,s,h),patterns:{},sortKey:qe};y.push(it)}m&&y.sort((N,j)=>N.sortKey-j.sortKey);const{lineAtlas:b,featureIndex:C}=i,M=this.addConstantDashes(b);for(const N of y){const{geometry:j,index:H,sourceLayerIndex:pe}=N;if(M&&this.addFeatureDashes(N,b),this.hasPattern){const be=Sd("line",this.layers,N,this.zoom,i);this.patternFeatures.push(be)}else this.addFeature(N,j,H,s,b.positions,i.availableImages);C.insert(e[H].feature,j,H,pe,this.index)}}addConstantDashes(e){let i=!1;for(const s of this.layers){const h=s.paint.get("line-dasharray").value,m=s.layout.get("line-cap").value;if("constant"!==h.kind||"constant"!==m.kind)i=!0;else{const y=m.value,b=h.value;if(!b)continue;e.addDash(b.from,y),e.addDash(b.to,y),b.other&&e.addDash(b.other,y)}}return i}addFeatureDashes(e,i){const s=this.zoom;for(const h of this.layers){const m=h.paint.get("line-dasharray").value,y=h.layout.get("line-cap").value;if("constant"===m.kind&&"constant"===y.kind)continue;let b,C,M,N,j,H;if("constant"===m.kind){const qe=m.value;if(!qe)continue;b=qe.other||qe.to,C=qe.to,M=qe.from}else b=m.evaluate({zoom:s-1},e),C=m.evaluate({zoom:s},e),M=m.evaluate({zoom:s+1},e);"constant"===y.kind?N=j=H=y.value:(N=y.evaluate({zoom:s-1},e),j=y.evaluate({zoom:s},e),H=y.evaluate({zoom:s+1},e)),i.addDash(b,N),i.addDash(C,j),i.addDash(M,H);const pe=i.getKey(b,N),be=i.getKey(C,j),Le=i.getKey(M,H);e.patterns[h.id]={min:pe,mid:be,max:Le}}}update(e,i,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,s,h)}addFeatures(e,i,s,h){for(const m of this.patternFeatures)this.addFeature(m,m.geometry,m.index,i,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,yg)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ja),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,s,h,m,y){const b=this.layers[0].layout,C=b.get("line-join").evaluate(e,{}),M=b.get("line-cap").evaluate(e,{}),N=b.get("line-miter-limit"),j=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const H of i)this.addLine(H,e,C,M,N,j);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,m,y,h)}addLine(e,i,s,h,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let it=0;it<e.length-1;it++)this.totalDistance+=e[it].dist(e[it+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b="Polygon"===Xh[i.type];let C=e.length;for(;C>=2&&e[C-1].equals(e[C-2]);)C--;let M=0;for(;M<C-1&&e[M].equals(e[M+1]);)M++;if(C<(b?3:2))return;"bevel"===s&&(m=1.05);const N=this.overscaling<=16?122880/(512*this.overscaling):0,j=this.segments.prepareSegment(10*C,this.layoutVertexArray,this.indexArray);let H,pe,be,Le,qe;this.e1=this.e2=-1,b&&(H=e[C-2],qe=e[M].sub(H)._unit()._perp());for(let it=M;it<C;it++){if(be=it===C-1?b?e[M+1]:void 0:e[it+1],be&&e[it].equals(be))continue;qe&&(Le=qe),H&&(pe=H),H=e[it],qe=be?be.sub(H)._unit()._perp():Le,Le=Le||qe;let yt=Le.add(qe);0===yt.x&&0===yt.y||yt._unit();const Mt=Le.x*qe.x+Le.y*qe.y,Nt=yt.x*qe.x+yt.y*qe.y,Vt=0!==Nt?1/Nt:1/0,jt=2*Math.sqrt(2-2*Nt),wn=Nt<Zl&&pe&&be,vn=Le.x*qe.y-Le.y*qe.x>0;if(wn&&it>M){const xn=H.dist(pe);if(xn>2*N){const Zn=H.sub(H.sub(pe)._mult(N/xn)._round());this.updateDistance(pe,Zn),this.addCurrentVertex(Zn,Le,0,0,j),pe=Zn}}const Xn=pe&&be;let Un=Xn?s:b?"butt":h;if(Xn&&"round"===Un&&(Vt<y?Un="miter":Vt<=2&&(Un="fakeround")),"miter"===Un&&Vt>m&&(Un="bevel"),"bevel"===Un&&(Vt>2&&(Un="flipbevel"),Vt<m&&(Un="miter")),pe&&this.updateDistance(pe,H),"miter"===Un)yt._mult(Vt),this.addCurrentVertex(H,yt,0,0,j);else if("flipbevel"===Un){if(Vt>100)yt=qe.mult(-1);else{const xn=Vt*Le.add(qe).mag()/Le.sub(qe).mag();yt._perp()._mult(xn*(vn?-1:1))}this.addCurrentVertex(H,yt,0,0,j),this.addCurrentVertex(H,yt.mult(-1),0,0,j)}else if("bevel"===Un||"fakeround"===Un){const xn=-Math.sqrt(Vt*Vt-1),Zn=vn?xn:0,ei=vn?0:xn;if(pe&&this.addCurrentVertex(H,Le,Zn,ei,j),"fakeround"===Un){const En=Math.round(180*jt/Math.PI/20);for(let ci=1;ci<En;ci++){let yi=ci/En;if(.5!==yi){const bo=yi-.5;yi+=yi*bo*(yi-1)*((1.0904+Mt*(Mt*(3.55645-1.43519*Mt)-3.2452))*bo*bo+(.848013+Mt*(.215638*Mt-1.06021)))}const Nr=qe.sub(Le)._mult(yi)._add(Le)._unit()._mult(vn?-1:1);this.addHalfVertex(H,Nr.x,Nr.y,!1,vn,0,j)}}be&&this.addCurrentVertex(H,qe,-Zn,-ei,j)}else if("butt"===Un)this.addCurrentVertex(H,yt,0,0,j);else if("square"===Un){const xn=pe?1:-1;pe||this.addCurrentVertex(H,yt,xn,xn,j),this.addCurrentVertex(H,yt,0,0,j),pe&&this.addCurrentVertex(H,yt,xn,xn,j)}else"round"===Un&&(pe&&(this.addCurrentVertex(H,Le,0,0,j),this.addCurrentVertex(H,Le,1,1,j,!0)),be&&(this.addCurrentVertex(H,qe,-1,-1,j,!0),this.addCurrentVertex(H,qe,0,0,j)));if(wn&&it<C-1){const xn=H.dist(be);if(xn>2*N){const Zn=H.add(be.sub(H)._mult(N/xn)._round());this.updateDistance(H,Zn),this.addCurrentVertex(Zn,qe,0,0,j),H=Zn}}}}addCurrentVertex(e,i,s,h,m,y=!1){const b=i.y*h-i.x,C=-i.y-i.x*h;this.addHalfVertex(e,i.x+i.y*s,i.y-i.x*s,y,!1,s,m),this.addHalfVertex(e,b,C,y,!0,-h,m)}addHalfVertex({x:e,y:i},s,h,m,y,b,C){this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(i<<1)+(y?1:0),Math.round(63*s)+128,Math.round(63*h)+128,1+(0===b?0:b<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const M=C.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),C.primitiveLength++),y?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}li("LineBucket",uu,{omit:["layers","patternFeatures"]});const zf=new fs({"line-cap":new Ni(Bt.layout_line["line-cap"]),"line-join":new Ni(Bt.layout_line["line-join"]),"line-miter-limit":new _i(Bt.layout_line["line-miter-limit"]),"line-round-limit":new _i(Bt.layout_line["line-round-limit"]),"line-sort-key":new Ni(Bt.layout_line["line-sort-key"])});var Od={paint:new fs({"line-opacity":new Ni(Bt.paint_line["line-opacity"]),"line-color":new Ni(Bt.paint_line["line-color"]),"line-translate":new _i(Bt.paint_line["line-translate"]),"line-translate-anchor":new _i(Bt.paint_line["line-translate-anchor"]),"line-width":new Ni(Bt.paint_line["line-width"]),"line-gap-width":new Ni(Bt.paint_line["line-gap-width"]),"line-offset":new Ni(Bt.paint_line["line-offset"]),"line-blur":new Ni(Bt.paint_line["line-blur"]),"line-dasharray":new cs(Bt.paint_line["line-dasharray"]),"line-pattern":new cs(Bt.paint_line["line-pattern"]),"line-gradient":new Xs(Bt.paint_line["line-gradient"])}),layout:zf};const vg=new class extends Ni{possiblyEvaluate(t,e){return e=new lr(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,s){return e=et({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,s)}}(Od.paint.properties["line-width"].specification);function Qh(t,e){return e>0?e+2*t:t}vg.useIntegerZoom=!0;const G_=Bo([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),Rd=Bo([{name:"a_projected_pos",components:3,type:"Float32"}],4);Bo([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ld=Bo([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),ep=Bo([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Bo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Fd=Bo([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),tp=Bo([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Bo([{name:"triangle",components:3,type:"Uint16"}]),Bo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Bo([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Bo([{type:"Float32",name:"offsetX"}]),Bo([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const xl=128;function np(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new lr(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:h}=i;let m=0;for(;m<s.length&&s[m]<=t;)m++;m=Math.max(0,m-1);let y=m;for(;y<s.length&&s[y]<t+1;)y++;y=Math.min(s.length-1,y);const b=s[m],C=s[y];return"composite"===i.kind?{kind:"composite",minZoom:b,maxZoom:C,interpolationType:h}:{kind:"camera",minZoom:b,maxZoom:C,minSize:i.evaluate(new lr(b)),maxSize:i.evaluate(new lr(C)),interpolationType:h}}}function Bd(t,{uSize:e,uSizeT:i},{lowerSize:s,upperSize:h}){return"source"===t.kind?s/xl:"composite"===t.kind?Zr(s/xl,h/xl,i):e}function du(t,e){let i=0,s=0;if("constant"===t.kind)s=t.layoutSize;else if("source"!==t.kind){const{interpolationType:h,minZoom:m,maxZoom:y}=t,b=h?Ri(To.interpolationFactor(h,e,m,y),0,1):0;"camera"===t.kind?s=Zr(t.minSize,t.maxSize,b):i=b}return{uSizeT:i,uSize:s}}var Uf=Object.freeze({__proto__:null,getSizeData:np,evaluateSizeForFeature:Bd,evaluateSizeForZoom:du,SIZE_PACK_FACTOR:xl});function q_(t,e,i){return t.sections.forEach(s=>{s.text=function(h,m,y){const b=m.layout.get("text-transform").evaluate(y,{});return"uppercase"===b?h=h.toLocaleUpperCase():"lowercase"===b&&(h=h.toLocaleLowerCase()),$r.applyArabicShaping&&(h=$r.applyArabicShaping(h)),h}(s.text,e,i)}),t}const $u={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function H_(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function Zf(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var ip=function(t,e,i,s,h){var m,y,b=8*h-s-1,C=(1<<b)-1,M=C>>1,N=-7,j=i?h-1:0,H=i?-1:1,pe=t[e+j];for(j+=H,m=pe&(1<<-N)-1,pe>>=-N,N+=b;N>0;m=256*m+t[e+j],j+=H,N-=8);for(y=m&(1<<-N)-1,m>>=-N,N+=s;N>0;y=256*y+t[e+j],j+=H,N-=8);if(0===m)m=1-M;else{if(m===C)return y?NaN:1/0*(pe?-1:1);y+=Math.pow(2,s),m-=M}return(pe?-1:1)*y*Math.pow(2,m-s)},Vf=function(t,e,i,s,h,m){var y,b,C,M=8*m-h-1,N=(1<<M)-1,j=N>>1,H=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,pe=s?0:m-1,be=s?1:-1,Le=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(b=isNaN(e)?1:0,y=N):(y=Math.floor(Math.log(e)/Math.LN2),e*(C=Math.pow(2,-y))<1&&(y--,C*=2),(e+=y+j>=1?H/C:H*Math.pow(2,1-j))*C>=2&&(y++,C/=2),y+j>=N?(b=0,y=N):y+j>=1?(b=(e*C-1)*Math.pow(2,h),y+=j):(b=e*Math.pow(2,j-1)*Math.pow(2,h),y=0));h>=8;t[i+pe]=255&b,pe+=be,b/=256,h-=8);for(y=y<<h|b,M+=h;M>0;t[i+pe]=255&y,pe+=be,y/=256,M-=8);t[i+pe-be]|=128*Le},zc=Io;function Io(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Io.Varint=0,Io.Fixed64=1,Io.Bytes=2,Io.Fixed32=5;var $f=4294967296,xg=1/$f,bg="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function lc(t){return t.type===Io.Bytes?t.readVarint()+t.pos:t.pos+1}function wg(t,e,i){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(s);for(var h=i.pos-1;h>=t;h--)i.buf[h+s]=i.buf[h]}function W_(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function Y_(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function J_(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function cc(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function rp(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function Tg(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function jf(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function op(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function Gf(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function hu(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function pu(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function Vl(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function qf(t,e,i){e.glyphs=[],1===t&&i.readMessage(Cg,e)}function Cg(t,e,i){if(3===t){const{id:s,bitmap:h,width:m,height:y,left:b,top:C,advance:M}=i.readMessage(sp,{});e.glyphs.push({id:s,bitmap:new vl({width:m+6,height:y+6},h),metrics:{width:m,height:y,left:b,top:C,advance:M}})}else 4===t?e.ascender=i.readSVarint():5===t&&(e.descender=i.readSVarint())}function sp(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}function ap(t){let e=0,i=0;for(const y of t)e+=y.w*y.h,i=Math.max(i,y.w);t.sort((y,b)=>b.h-y.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let h=0,m=0;for(const y of t)for(let b=s.length-1;b>=0;b--){const C=s[b];if(!(y.w>C.w||y.h>C.h)){if(y.x=C.x,y.y=C.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===C.w&&y.h===C.h){const M=s.pop();b<s.length&&(s[b]=M)}else y.h===C.h?(C.x+=y.w,C.w-=y.w):y.w===C.w?(C.y+=y.h,C.h-=y.h):(s.push({x:C.x+y.w,y:C.y,w:C.w-y.w,h:y.h}),C.y+=y.h,C.h-=y.h);break}}return{w:h,h:m,fill:e/(h*m)||0}}Io.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var s=this.readVarint(),h=s>>3,m=this.pos;this.type=7&s,t(h,e,this),this.pos===m&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=hu(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=Vl(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=hu(this.buf,this.pos)+hu(this.buf,this.pos+4)*$f;return this.pos+=8,t},readSFixed64:function(){var t=hu(this.buf,this.pos)+Vl(this.buf,this.pos+4)*$f;return this.pos+=8,t},readFloat:function(){var t=ip(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ip(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,s=this.buf;return e=127&(i=s[this.pos++]),i<128?e:(e|=(127&(i=s[this.pos++]))<<7,i<128?e:(e|=(127&(i=s[this.pos++]))<<14,i<128?e:(e|=(127&(i=s[this.pos++]))<<21,i<128?e:function(h,m,y){var b,C,M=y.buf;if(b=(112&(C=M[y.pos++]))>>4,C<128||(b|=(127&(C=M[y.pos++]))<<3,C<128)||(b|=(127&(C=M[y.pos++]))<<10,C<128)||(b|=(127&(C=M[y.pos++]))<<17,C<128)||(b|=(127&(C=M[y.pos++]))<<24,C<128)||(b|=(1&(C=M[y.pos++]))<<31,C<128))return function ju(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(h,b,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&bg?bg.decode(this.buf.subarray(e,t)):function(i,s,h){for(var m="",y=s;y<h;){var b,C,M,N=i[y],j=null,H=N>239?4:N>223?3:N>191?2:1;if(y+H>h)break;1===H?N<128&&(j=N):2===H?128==(192&(b=i[y+1]))&&(j=(31&N)<<6|63&b)<=127&&(j=null):3===H?(C=i[y+2],128==(192&(b=i[y+1]))&&128==(192&C)&&((j=(15&N)<<12|(63&b)<<6|63&C)<=2047||j>=55296&&j<=57343)&&(j=null)):4===H&&(C=i[y+2],M=i[y+3],128==(192&(b=i[y+1]))&&128==(192&C)&&128==(192&M)&&((j=(15&N)<<18|(63&b)<<12|(63&C)<<6|63&M)<=65535||j>=1114112)&&(j=null)),null===j?(j=65533,H=1):j>65535&&(j-=65536,m+=String.fromCharCode(j>>>10&1023|55296),j=56320|1023&j),m+=String.fromCharCode(j),y+=H}return m}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Io.Bytes)return t.push(this.readVarint(e));var i=lc(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Io.Bytes)return t.push(this.readSVarint());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Io.Bytes)return t.push(this.readBoolean());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Io.Bytes)return t.push(this.readFloat());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Io.Bytes)return t.push(this.readDouble());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Io.Bytes)return t.push(this.readFixed32());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Io.Bytes)return t.push(this.readSFixed32());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Io.Bytes)return t.push(this.readFixed64());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Io.Bytes)return t.push(this.readSFixed64());var e=lc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Io.Varint)for(;this.buf[this.pos++]>127;);else if(e===Io.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Io.Fixed32)this.pos+=4;else{if(e!==Io.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),pu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),pu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),pu(this.buf,-1&t,this.pos),pu(this.buf,Math.floor(t*xg),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),pu(this.buf,-1&t,this.pos),pu(this.buf,Math.floor(t*xg),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var s,h,m,b;if(e>=0?(s=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,h=h+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),m=s,(b=i).buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,m>>>=7,b.buf[b.pos++]=127&m|128,b.buf[b.pos]=127&(m>>>=7),function(m,y){var b=(7&m)<<4;y.buf[y.pos++]|=b|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(h,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,h,m){for(var y,b,C=0;C<h.length;C++){if((y=h.charCodeAt(C))>55295&&y<57344){if(!b){y>56319||C+1===h.length?(s[m++]=239,s[m++]=191,s[m++]=189):b=y;continue}if(y<56320){s[m++]=239,s[m++]=191,s[m++]=189,b=y;continue}y=b-55296<<10|y-56320|65536,b=null}else b&&(s[m++]=239,s[m++]=191,s[m++]=189,b=null);y<128?s[m++]=y:(y<2048?s[m++]=y>>6|192:(y<65536?s[m++]=y>>12|224:(s[m++]=y>>18|240,s[m++]=y>>12&63|128),s[m++]=y>>6&63|128),s[m++]=63&y|128)}return m}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&wg(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),Vf(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Vf(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var s=this.pos-i;s>=128&&wg(i,s,this),this.pos=i-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,i){this.writeTag(t,Io.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,W_,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,Y_,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,rp,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,J_,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,cc,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,Tg,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,jf,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,op,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,Gf,e)},writeBytesField:function(t,e){this.writeTag(t,Io.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Io.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Io.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Io.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Io.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Io.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Io.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Io.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Io.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Io.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class Nd{constructor(e,{pixelRatio:i,version:s,stretchX:h,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=h,this.stretchY=m,this.content=y,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class Hf{constructor(e,i){const s={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,s,m),this.addImages(i,h,m);const{w:y,h:b}=ap(m),C=new Vs({width:y||1,height:b||1});for(const M in e){const N=e[M],j=s[M].paddedRect;Vs.copy(N.data,C,{x:0,y:0},{x:j.x+1,y:j.y+1},N.data)}for(const M in i){const N=i[M],j=h[M].paddedRect,H=j.x+1,pe=j.y+1,be=N.data.width,Le=N.data.height;Vs.copy(N.data,C,{x:0,y:0},{x:H,y:pe},N.data),Vs.copy(N.data,C,{x:0,y:Le-1},{x:H,y:pe-1},{width:be,height:1}),Vs.copy(N.data,C,{x:0,y:0},{x:H,y:pe+Le},{width:be,height:1}),Vs.copy(N.data,C,{x:be-1,y:0},{x:H-1,y:pe},{width:1,height:Le}),Vs.copy(N.data,C,{x:0,y:0},{x:H+be,y:pe},{width:1,height:Le})}this.image=C,this.iconPositions=s,this.patternPositions=h}addImages(e,i,s){for(const h in e){const m=e[h],y={x:0,y:0,w:m.data.width+2,h:m.data.height+2};s.push(y),i[h]=new Nd(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,i){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),i),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),i)}patchUpdatedImage(e,i,s){if(!e||!i||e.version===i.version)return;e.version=i.version;const[h,m]=e.tl;s.update(i.data,void 0,{x:h,y:m})}}li("ImagePosition",Nd),li("ImageAtlas",Hf);const pa={horizontal:1,vertical:2,horizontalOnly:3};class $l{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const s=new $l;return s.scale=e||1,s.fontStack=i,s}static forImage(e){const i=new $l;return i.imageName=e,i}}class Ka{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const s=new Ka;for(let h=0;h<e.sections.length;h++){const m=e.sections[h];m.image?s.addImageSection(m):s.addTextSection(m,i)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,s){let h="";for(let m=0;m<i.length;m++){const y=i.charCodeAt(m+1)||null,b=i.charCodeAt(m-1)||null;h+=!s&&(y&&Ti(y)&&!$u[i[m+1]]||b&&Ti(b)&&!$u[i[m-1]])||!$u[i[m]]?i[m]:$u[i[m]]}return h}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&jl[this.text.charCodeAt(s)];s++)e++;let i=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&jl[this.text.charCodeAt(s)];s--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const s=new Ka;return s.text=this.text.substring(e,i),s.sectionIndex=this.sectionIndex.slice(e,i),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push($l.forText(e.scale,e.fontStack||i));const s=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(s)}addImageSection(e){const i=e.image?e.image.name:"";if(0===i.length)return void Li("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push($l.forImage(i)),this.sectionIndex.push(this.sections.length-1)):Li("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Gu(t,e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le){const qe=Ka.fromFeature(t,h);let it;j===pa.vertical&&qe.verticalizePunctuation(H);const{processBidirectionalText:yt,processStyledBidirectionalText:Mt}=$r;if(yt&&1===qe.sections.length){it=[];const jt=yt(qe.toString(),Hu(qe,M,m,e,s,pe,be));for(const wn of jt){const vn=new Ka;vn.text=wn,vn.sections=qe.sections;for(let Xn=0;Xn<wn.length;Xn++)vn.sectionIndex.push(0);it.push(vn)}}else if(Mt){it=[];const jt=Mt(qe.text,qe.sectionIndex,Hu(qe,M,m,e,s,pe,be));for(const wn of jt){const vn=new Ka;vn.text=wn[0],vn.sectionIndex=wn[1],vn.sections=qe.sections,it.push(vn)}}else it=function(jt,wn){const vn=[],Xn=jt.text;let Un=0;for(const xn of wn)vn.push(jt.substring(Un,xn)),Un=xn;return Un<Xn.length&&vn.push(jt.substring(Un,Xn.length)),vn}(qe,Hu(qe,M,m,e,s,pe,be));const Nt=[],Vt={positionedLines:Nt,text:qe.toString(),top:N[1],bottom:N[1],left:N[0],right:N[0],writingMode:j,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(jt,wn,vn,Xn,Un,xn,Zn,ei,En,ci,yi,Nr){let bo=0,Or=0,jr=0;const Fn="right"===ei?1:"left"===ei?0:.5;let oo=!1;for(const so of Un){const Rr=so.getSections();for(const ko of Rr){if(ko.imageName)continue;const Uo=wn[ko.fontStack];if(Uo&&(oo=void 0!==Uo.ascender&&void 0!==Uo.descender,!oo))break}if(!oo)break}let Qr=0;for(const so of Un){so.trim();const Rr=so.getMaxScale(),ko=24*(Rr-1),Uo={positionedGlyphs:[],lineOffset:0};jt.positionedLines[Qr]=Uo;const qo=Uo.positionedGlyphs;let $o=0;if(!so.length()){Or+=xn,++Qr;continue}let Ts=0,na=0;for(let So=0;So<so.length();So++){const Xo=so.getSection(So),ia=so.getSectionIndex(So),gs=so.getCharCode(So);let fo=Xo.scale,Qo=null,Oo=null,Ns=null,rs=24,_s=0;const Cs=!(En===pa.horizontal||!yi&&!bn(gs)||yi&&(jl[gs]||(Go=gs,n(Go)||u(Go)||_(Go)||bt(Go)||On(Go))));if(Xo.imageName){const Ms=Xn[Xo.imageName];if(!Ms)continue;Ns=Xo.imageName,jt.iconsInText=jt.iconsInText||!0,Oo=Ms.paddedRect;const os=Ms.displaySize;fo=24*fo/Nr,Qo={width:os[0],height:os[1],left:1,top:-3,advance:Cs?os[1]:os[0],localGlyph:!1},_s=oo?-Qo.height*fo:24*Rr-17-os[1]*fo,rs=Qo.advance;const ma=(Cs?os[0]:os[1])*fo-24*Rr;ma>0&&ma>$o&&($o=ma)}else{const Ms=vn[Xo.fontStack];if(!Ms)continue;Ms[gs]&&(Oo=Ms[gs]);const os=wn[Xo.fontStack];if(!os)continue;const ma=os.glyphs[gs];if(!ma)continue;if(Qo=ma.metrics,rs=8203!==gs?24:0,oo){const qc=void 0!==os.ascender?Math.abs(os.ascender):0,Du=void 0!==os.descender?Math.abs(os.descender):0,Hc=(qc+Du)*fo;Ts<Hc&&(Ts=Hc,na=(qc-Du)/2*fo),_s=-qc*fo}else _s=24*(Rr-fo)-17}Cs?(jt.verticalizable=!0,qo.push({glyph:gs,imageName:Ns,x:bo,y:Or+_s,vertical:Cs,scale:fo,localGlyph:Qo.localGlyph,fontStack:Xo.fontStack,sectionIndex:ia,metrics:Qo,rect:Oo}),bo+=rs*fo+ci):(qo.push({glyph:gs,imageName:Ns,x:bo,y:Or+_s,vertical:Cs,scale:fo,localGlyph:Qo.localGlyph,fontStack:Xo.fontStack,sectionIndex:ia,metrics:Qo,rect:Oo}),bo+=Qo.advance*fo+ci)}0!==qo.length&&(jr=Math.max(bo-ci,jr),oo?Wu(qo,Fn,$o,na,xn*Rr/2):Wu(qo,Fn,$o,0,xn/2)),bo=0;const ms=xn*Rr+$o;Uo.lineOffset=Math.max($o,ko),Or+=ms,++Qr}var Go;const zo=Or,{horizontalAlign:us,verticalAlign:ws}=Ud(Zn);(function(so,Rr,ko,Uo,qo,$o){const Ts=(Rr-ko)*qo,na=-$o*Uo;for(const ms of so)for(const So of ms.positionedGlyphs)So.x+=Ts,So.y+=na})(jt.positionedLines,Fn,us,ws,jr,zo),jt.top+=-ws*zo,jt.bottom=jt.top+zo,jt.left+=-us*jr,jt.right=jt.left+jr,jt.hasBaseline=oo}(Vt,e,i,s,it,y,b,C,j,M,H,Le),!function(jt){for(const wn of jt)if(0!==wn.positionedGlyphs.length)return!1;return!0}(Nt)&&Vt}const jl={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},qu={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Uc(t,e,i,s,h,m){if(e.imageName){const y=s[e.imageName];return y?y.displaySize[0]*e.scale*24/m+h:0}{const y=i[e.fontStack],b=y&&y.glyphs[t];return b?b.metrics.advance*e.scale+h:0}}function Wf(t,e,i,s){const h=Math.pow(t-e,2);return s?t<e?h/2:2*h:h+Math.abs(i)*i}function Yf(t,e,i){let s=0;return 10===t&&(s-=1e4),i&&(s+=150),40!==t&&65288!==t||(s+=50),41!==e&&65289!==e||(s+=50),s}function lp(t,e,i,s,h,m){let y=null,b=Wf(e,i,h,m);for(const C of s){const M=Wf(e-C.x,i,h,m)+C.badness;M<=b&&(y=C,b=M)}return{index:t,x:e,priorBreak:y,badness:b}}function zd(t){return t?zd(t.priorBreak).concat(t.index):[]}function Hu(t,e,i,s,h,m,y){if("point"!==m)return[];if(!t)return[];const b=[],C=function(H,pe,be,Le,qe,it){let yt=0;for(let Mt=0;Mt<H.length();Mt++){const Nt=H.getSection(Mt);yt+=Uc(H.getCharCode(Mt),Nt,Le,qe,pe,it)}return yt/Math.max(1,Math.ceil(yt/be))}(t,e,i,s,h,y),M=t.text.indexOf("\u200b")>=0;let N=0;for(let H=0;H<t.length();H++){const pe=t.getSection(H),be=t.getCharCode(H);if(jl[be]||(N+=Uc(be,pe,s,h,e,y)),H<t.length()-1){const Le=!((j=be)<11904||!(ge(j)||ce(j)||cn(j)||ut(j)||Ye(j)||x(j)||Re(j)||B(j)||mt(j)||Ge(j)||$e(j)||Sn(j)||J(j)||I(j)||T(j)||We(j)||oe(j)||qt(j)||_t(j)||dt(j)));(qu[be]||Le||pe.imageName)&&b.push(lp(H+1,N,C,b,Yf(be,t.getCharCode(H+1),Le&&M),!1))}}var j;return zd(lp(t.length(),N,C,b,0,!0))}function Ud(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function Wu(t,e,i,s,h){if(!(e||i||s||h))return;const m=t.length-1,y=t[m],b=(y.x+y.metrics.advance*y.scale)*e;for(let C=0;C<=m;C++)t[C].x-=b,t[C].y+=i+s+h}function Eg(t,e,i){const{horizontalAlign:s,verticalAlign:h}=Ud(i),m=e[0]-t.displaySize[0]*s,y=e[1]-t.displaySize[1]*h;return{image:t,top:y,bottom:y+t.displaySize[1],left:m,right:m+t.displaySize[0]}}function cp(t,e,i,s,h,m){const y=t.image;let b;if(y.content){const qe=y.content,it=y.pixelRatio||1;b=[qe[0]/it,qe[1]/it,y.displaySize[0]-qe[2]/it,y.displaySize[1]-qe[3]/it]}const C=e.left*m,M=e.right*m;let N,j,H,pe;"width"===i||"both"===i?(pe=h[0]+C-s[3],j=h[0]+M+s[1]):(pe=h[0]+(C+M-y.displaySize[0])/2,j=pe+y.displaySize[0]);const be=e.top*m,Le=e.bottom*m;return"height"===i||"both"===i?(N=h[1]+be-s[0],H=h[1]+Le+s[2]):(N=h[1]+(be+Le-y.displaySize[1])/2,H=N+y.displaySize[1]),{image:y,top:N,right:j,bottom:H,left:pe,collisionPadding:b}}class uc extends L{constructor(e,i,s,h,m){super(e,i),this.angle=h,this.z=s,void 0!==m&&(this.segment=m)}clone(){return new uc(this.x,this.y,this.z,this.angle,this.segment)}}function up(t,e,i,s,h){if(void 0===e.segment)return!0;let m=e,y=e.segment+1,b=0;for(;b>-i/2;){if(y--,y<0)return!1;b-=t[y].dist(m),m=t[y]}b+=t[y].dist(t[y+1]),y++;const C=[];let M=0;for(;b<i/2;){const N=t[y],j=t[y+1];if(!j)return!1;let H=t[y-1].angleTo(N)-N.angleTo(j);for(H=Math.abs((H+3*Math.PI)%(2*Math.PI)-Math.PI),C.push({distance:b,angleDelta:H}),M+=H;b-C[0].distance>s;)M-=C.shift().angleDelta;if(M>h)return!1;y++,b+=N.dist(j)}return!0}function dp(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function Jf(t,e,i){return t?.6*e*i:0}function hp(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function Dg(t,e,i,s,h,m){const y=Jf(i,h,m),b=hp(i,s)*m;let C=0;const M=dp(t)/2;for(let N=0;N<t.length-1;N++){const j=t[N],H=t[N+1],pe=j.dist(H);if(C+pe>M){const be=(M-C)/pe,Le=Zr(j.x,H.x,be),qe=Zr(j.y,H.y,be),it=new uc(Le,qe,0,H.angleTo(j),N);return!y||up(t,it,b,y,e)?it:void 0}C+=pe}}function Ig(t,e,i,s,h,m,y,b,C){const M=Jf(s,m,y),N=hp(s,h),j=N*y,H=0===t[0].x||t[0].x===C||0===t[0].y||t[0].y===C;return e-j<e/4&&(e=j+e/4),ea(t,H?e/2*b%e:(N/2+2*m)*y*b%e,e,M,i,j,H,!1,C)}function ea(t,e,i,s,h,m,y,b,C){const M=m/2,N=dp(t);let j=0,H=e-i,pe=[];for(let be=0;be<t.length-1;be++){const Le=t[be],qe=t[be+1],it=Le.dist(qe),yt=qe.angleTo(Le);for(;H+i<j+it;){H+=i;const Mt=(H-j)/it,Nt=Zr(Le.x,qe.x,Mt),Vt=Zr(Le.y,qe.y,Mt);if(Nt>=0&&Nt<C&&Vt>=0&&Vt<C&&H-M>=0&&H+M<=N){const jt=new uc(Nt,Vt,0,yt,be);jt._round(),s&&!up(t,jt,m,s,h)||pe.push(jt)}}j+=it}return b||pe.length||y||(pe=ea(t,j/2,i,s,h,m,y,!0,C)),pe}function Kf(t,e,i,s,h){const m=[];for(let y=0;y<t.length;y++){const b=t[y];let C;for(let M=0;M<b.length-1;M++){let N=b[M],j=b[M+1];N.x<e&&j.x<e||(N.x<e?N=new L(e,N.y+(e-N.x)/(j.x-N.x)*(j.y-N.y))._round():j.x<e&&(j=new L(e,N.y+(e-N.x)/(j.x-N.x)*(j.y-N.y))._round()),N.y<i&&j.y<i||(N.y<i?N=new L(N.x+(i-N.y)/(j.y-N.y)*(j.x-N.x),i)._round():j.y<i&&(j=new L(N.x+(i-N.y)/(j.y-N.y)*(j.x-N.x),i)._round()),N.x>=s&&j.x>=s||(N.x>=s?N=new L(s,N.y+(s-N.x)/(j.x-N.x)*(j.y-N.y))._round():j.x>=s&&(j=new L(s,N.y+(s-N.x)/(j.x-N.x)*(j.y-N.y))._round()),N.y>=h&&j.y>=h||(N.y>=h?N=new L(N.x+(h-N.y)/(j.y-N.y)*(j.x-N.x),h)._round():j.y>=h&&(j=new L(N.x+(h-N.y)/(j.y-N.y)*(j.x-N.x),h)._round()),C&&N.equals(C[C.length-1])||(C=[N],m.push(C)),C.push(j)))))}}return m}li("Anchor",uc);const Yu=1e20;function Ag(t,e,i,s,h,m,y,b,C){for(let M=e;M<e+s;M++)Mg(t,i*m+M,m,h,y,b,C);for(let M=i;M<i+h;M++)Mg(t,M*m+e,1,s,y,b,C)}function Mg(t,e,i,s,h,m,y){m[0]=0,y[0]=-Yu,y[1]=Yu,h[0]=t[e];for(let b=1,C=0,M=0;b<s;b++){h[b]=t[e+b*i];const N=b*b;do{const j=m[C];M=(h[b]-h[j]+N-j*j)/(b-j)/2}while(M<=y[C]&&--C>-1);C++,m[C]=b,y[C]=M,y[C+1]=Yu}for(let b=0,C=0;b<s;b++){for(;y[C+1]<b;)C++;const M=m[C],N=b-M;t[e+b*i]=h[M]+N*N}}const Zd={none:0,ideographs:1,all:2};class Ju{constructor(e,i,s){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const s=[];for(const h in e)for(const m of e[h])s.push({stack:h,id:m});ki(s,({stack:h,id:m},y)=>{let b=this.entries[h];b||(b=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let C=b.glyphs[m];if(void 0!==C)return void y(null,{stack:h,id:m,glyph:C});if(C=this._tinySDF(b,h,m),C)return b.glyphs[m]=C,void y(null,{stack:h,id:m,glyph:C});const M=Math.floor(m/256);if(256*M>65535)return void y(new Error("glyphs > 65535 not supported"));if(b.ranges[M])return void y(null,{stack:h,id:m,glyph:C});let N=b.requests[M];N||(N=b.requests[M]=[],Ju.loadGlyphRange(h,M,this.url,this.requestManager,(j,H)=>{if(H){b.ascender=H.ascender,b.descender=H.descender;for(const pe in H.glyphs)this._doesCharSupportLocalGlyph(+pe)||(b.glyphs[+pe]=H.glyphs[+pe]);b.ranges[M]=!0}for(const pe of N)pe(j,H);delete b.requests[M]})),N.push((j,H)=>{j?y(j):H&&y(null,{stack:h,id:m,glyph:H.glyphs[m]||null})})},(h,m)=>{if(h)i(h);else if(m){const y={};for(const{stack:b,id:C,glyph:M}of m)void 0===y[b]&&(y[b]={}),void 0===y[b].glyphs&&(y[b].glyphs={}),y[b].glyphs[C]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},y[b].ascender=this.entries[b].ascender,y[b].descender=this.entries[b].descender;i(null,y)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Zd.none&&(this.localGlyphMode===Zd.all?!!this.localFontFamily:!!this.localFontFamily&&(Ge(e)||lt(e)||J(e)||oe(e))||B(e))}_tinySDF(e,i,s){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(s))return;let m=e.tinySDF;if(!m){let Le="400";/bold/i.test(i)?Le="900":/medium/i.test(i)?Le="500":/light/i.test(i)&&(Le="200"),m=e.tinySDF=new Ju.TinySDF({fontFamily:h,fontWeight:Le,fontSize:48,buffer:6,radius:16}),m.fontWeight=Le}if(this.localGlyphs[m.fontWeight][s])return this.localGlyphs[m.fontWeight][s];const y=String.fromCharCode(s),{data:b,width:C,height:M,glyphWidth:N,glyphHeight:j,glyphLeft:H,glyphTop:pe,glyphAdvance:be}=m.draw(y);return this.localGlyphs[m.fontWeight][s]={id:s,bitmap:new vl({width:C,height:M},b),metrics:{width:N/2,height:j/2,left:H/2,top:pe/2-27,advance:be/2,localGlyph:!0}}}}function Xf(t,e,i,s){const h=[],m=t.image,y=m.pixelRatio,b=m.paddedRect.w-2,C=m.paddedRect.h-2,M=t.right-t.left,N=t.bottom-t.top,j=m.stretchX||[[0,b]],H=m.stretchY||[[0,C]],pe=(xn,Zn)=>xn+Zn[1]-Zn[0],be=j.reduce(pe,0),Le=H.reduce(pe,0),qe=b-be,it=C-Le;let yt=0,Mt=be,Nt=0,Vt=Le,jt=0,wn=qe,vn=0,Xn=it;if(m.content&&s){const xn=m.content;yt=fu(j,0,xn[0]),Nt=fu(H,0,xn[1]),Mt=fu(j,xn[0],xn[2]),Vt=fu(H,xn[1],xn[3]),jt=xn[0]-yt,vn=xn[1]-Nt,wn=xn[2]-xn[0]-Mt,Xn=xn[3]-xn[1]-Vt}const Un=(xn,Zn,ei,En)=>{const ci=Vd(xn.stretch-yt,Mt,M,t.left),yi=$d(xn.fixed-jt,wn,xn.stretch,be),Nr=Vd(Zn.stretch-Nt,Vt,N,t.top),bo=$d(Zn.fixed-vn,Xn,Zn.stretch,Le),Or=Vd(ei.stretch-yt,Mt,M,t.left),jr=$d(ei.fixed-jt,wn,ei.stretch,be),Fn=Vd(En.stretch-Nt,Vt,N,t.top),oo=$d(En.fixed-vn,Xn,En.stretch,Le),Qr=new L(ci,Nr),Go=new L(Or,Nr),zo=new L(Or,Fn),us=new L(ci,Fn),ws=new L(yi/y,bo/y),so=new L(jr/y,oo/y),Rr=e*Math.PI/180;if(Rr){const qo=Math.sin(Rr),$o=Math.cos(Rr),Ts=[$o,-qo,qo,$o];Qr._matMult(Ts),Go._matMult(Ts),us._matMult(Ts),zo._matMult(Ts)}const ko=xn.stretch+xn.fixed,Uo=Zn.stretch+Zn.fixed;return{tl:Qr,tr:Go,bl:us,br:zo,tex:{x:m.paddedRect.x+1+ko,y:m.paddedRect.y+1+Uo,w:ei.stretch+ei.fixed-ko,h:En.stretch+En.fixed-Uo},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:ws,pixelOffsetBR:so,minFontScaleX:wn/y/M,minFontScaleY:Xn/y/N,isSDF:i}};if(s&&(m.stretchX||m.stretchY)){const xn=pp(j,qe,be),Zn=pp(H,it,Le);for(let ei=0;ei<xn.length-1;ei++){const En=xn[ei],ci=xn[ei+1];for(let yi=0;yi<Zn.length-1;yi++)h.push(Un(En,Zn[yi],ci,Zn[yi+1]))}}else h.push(Un({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:C+1}));return h}function fu(t,e,i){let s=0;for(const h of t)s+=Math.max(e,Math.min(i,h[1]))-Math.max(e,Math.min(i,h[0]));return s}function pp(t,e,i){const s=[{fixed:-1,stretch:0}];for(const[h,m]of t){const y=s[s.length-1];s.push({fixed:h-y.stretch,stretch:y.stretch}),s.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return s.push({fixed:e+1,stretch:i}),s}function Vd(t,e,i,s){return t/e*i+s}function $d(t,e,i,s){return t-e*i/s}function Sg(t,e,i,s){const h=e+t.positionedLines[s].lineOffset;return 0===s?i+h/2:i+(h+(e+t.positionedLines[s-1].lineOffset))/2}Ju.loadGlyphRange=function(t,e,i,s,h){const m=256*e,y=m+255,b=s.transformRequest(s.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",`${m}-${y}`),yo.Glyphs);Sr(b,(C,M)=>{if(C)h(C);else if(M){const N={},j=new zc(M).readFields(qf,{});for(const H of j.glyphs)N[H.id]=H;h(null,{glyphs:N,ascender:j.ascender,descender:j.descender})}})},Ju.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:s=.25,fontFamily:h="sans-serif",fontWeight:m="normal",fontStyle:y="normal"}){this.buffer=e,this.cutoff=s,this.radius=i;const b=this.size=t+4*e,C=this._createCanvas(b),M=this.ctx=C.getContext("2d",{willReadFrequently:!0});M.font=`${y} ${m} ${t}px ${h}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:s,actualBoundingBoxLeft:h,actualBoundingBoxRight:m}=this.ctx.measureText(t),y=Math.floor(i),b=Math.min(this.size-this.buffer,Math.ceil(m-h)),C=Math.min(this.size-this.buffer,Math.ceil(i)+Math.ceil(s)),M=b+2*this.buffer,N=C+2*this.buffer,j=M*N,H=new Uint8ClampedArray(j),pe={data:H,width:M,height:N,glyphWidth:b,glyphHeight:C,glyphTop:y,glyphLeft:0,glyphAdvance:e};if(0===b||0===C)return pe;const{ctx:be,buffer:Le,gridInner:qe,gridOuter:it}=this;be.clearRect(Le,Le,b,C),be.fillText(t,Le,Le+y+1);const yt=be.getImageData(Le,Le,b,C);it.fill(Yu,0,j),qe.fill(0,0,j);for(let Mt=0;Mt<C;Mt++)for(let Nt=0;Nt<b;Nt++){const Vt=yt.data[4*(Mt*b+Nt)+3]/255;if(0===Vt)continue;const jt=(Mt+Le)*M+Nt+Le;if(1===Vt)it[jt]=0,qe[jt]=Yu;else{const wn=.5-Vt;it[jt]=wn>0?wn*wn:0,qe[jt]=wn<0?wn*wn:0}}Ag(it,0,0,M,N,M,this.f,this.v,this.z),Ag(qe,Le,Le,b,C,M,this.f,this.v,this.z);for(let Mt=0;Mt<j;Mt++){const Nt=Math.sqrt(it[Mt])-Math.sqrt(qe[Mt]);H[Mt]=Math.round(255-255*(Nt/this.radius+this.cutoff))}return pe}};class Qf{constructor(e=[],i=Pg){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:s}=this,h=i[e];for(;e>0;){const m=e-1>>1,y=i[m];if(s(h,y)>=0)break;i[e]=y,e=m}i[e]=h}_down(e){const{data:i,compare:s}=this,h=this.length>>1,m=i[e];for(;e<h;){let y=1+(e<<1),b=i[y];const C=y+1;if(C<this.length&&s(i[C],b)<0&&(y=C,b=i[C]),s(b,m)>=0)break;i[e]=b,e=y}i[e]=m}}function Pg(t,e){return t<e?-1:t>e?1:0}function em(t,e=1,i=!1){let s=1/0,h=1/0,m=-1/0,y=-1/0;const b=t[0];for(let pe=0;pe<b.length;pe++){const be=b[pe];(!pe||be.x<s)&&(s=be.x),(!pe||be.y<h)&&(h=be.y),(!pe||be.x>m)&&(m=be.x),(!pe||be.y>y)&&(y=be.y)}const C=Math.min(m-s,y-h);let M=C/2;const N=new Qf([],kg);if(0===C)return new L(s,h);for(let pe=s;pe<m;pe+=C)for(let be=h;be<y;be+=C)N.push(new mu(pe+M,be+M,M,t));let j=function(pe){let be=0,Le=0,qe=0;const it=pe[0];for(let yt=0,Mt=it.length,Nt=Mt-1;yt<Mt;Nt=yt++){const Vt=it[yt],jt=it[Nt],wn=Vt.x*jt.y-jt.x*Vt.y;Le+=(Vt.x+jt.x)*wn,qe+=(Vt.y+jt.y)*wn,be+=3*wn}return new mu(Le/be,qe/be,0,pe)}(t),H=N.length;for(;N.length;){const pe=N.pop();(pe.d>j.d||!j.d)&&(j=pe,i&&console.log("found best %d after %d probes",Math.round(1e4*pe.d)/1e4,H)),pe.max-j.d<=e||(M=pe.h/2,N.push(new mu(pe.p.x-M,pe.p.y-M,M,t)),N.push(new mu(pe.p.x+M,pe.p.y-M,M,t)),N.push(new mu(pe.p.x-M,pe.p.y+M,M,t)),N.push(new mu(pe.p.x+M,pe.p.y+M,M,t)),H+=4)}return i&&(console.log(`num probes: ${H}`),console.log(`best distance: ${j.d}`)),j.p}function kg(t,e){return e.max-t.max}function mu(t,e,i,s){this.p=new L(t,e),this.h=i,this.d=function(h,m){let y=!1,b=1/0;for(let C=0;C<m.length;C++){const M=m[C];for(let N=0,j=M.length,H=j-1;N<j;H=N++){const pe=M[N],be=M[H];pe.y>h.y!=be.y>h.y&&h.x<(be.x-pe.x)*(h.y-pe.y)/(be.y-pe.y)+pe.x&&(y=!y),b=Math.min(b,_f(h,pe,be))}}return(y?1:-1)*Math.sqrt(b)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const jd=Number.POSITIVE_INFINITY,tm=Math.sqrt(2);function nm(t,e){return e[1]!==jd?function(i,s,h){let m=0,y=0;switch(s=Math.abs(s),h=Math.abs(h),i){case"top-right":case"top-left":case"top":y=h-7;break;case"bottom-right":case"bottom-left":case"bottom":y=7-h}switch(i){case"top-right":case"bottom-right":case"right":m=-s;break;case"top-left":case"bottom-left":case"left":m=s}return[m,y]}(t,e[0],e[1]):function(i,s){let h=0,m=0;s<0&&(s=0);const y=s/tm;switch(i){case"top-right":case"top-left":m=y-7;break;case"bottom-right":case"bottom-left":m=7-y;break;case"bottom":m=7-s;break;case"top":m=s-7}switch(i){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=s;break;case"right":h=-s}return[h,m]}(t,e[0])}function bl(t,e,i,s,h,m,y,b,C,M){t.createArrays(),t.tilePixelRatio=yr/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const N=t.layers[0].layout,j=t.layers[0]._unevaluatedLayout._values,H={};if("composite"===t.textSizeData.kind){const{minZoom:Le,maxZoom:qe}=t.textSizeData;H.compositeTextSizes=[j["text-size"].possiblyEvaluate(new lr(Le),b),j["text-size"].possiblyEvaluate(new lr(qe),b)]}if("composite"===t.iconSizeData.kind){const{minZoom:Le,maxZoom:qe}=t.iconSizeData;H.compositeIconSizes=[j["icon-size"].possiblyEvaluate(new lr(Le),b),j["icon-size"].possiblyEvaluate(new lr(qe),b)]}H.layoutTextSize=j["text-size"].possiblyEvaluate(new lr(C+1),b),H.layoutIconSize=j["icon-size"].possiblyEvaluate(new lr(C+1),b),H.textMaxSize=j["text-size"].possiblyEvaluate(new lr(18),b);const pe="map"===N.get("text-rotation-alignment")&&"point"!==N.get("symbol-placement"),be=N.get("text-size");for(const Le of t.features){const qe=N.get("text-font").evaluate(Le,{},b).join(","),it=be.evaluate(Le,{},b),yt=H.layoutTextSize.evaluate(Le,{},b),Mt=(H.layoutIconSize.evaluate(Le,{},b),{horizontal:{},vertical:void 0}),Nt=Le.text;let Vt,jt=[0,0];if(Nt){const Xn=Nt.toString(),Un=24*N.get("text-letter-spacing").evaluate(Le,{},b),xn=24*N.get("text-line-height").evaluate(Le,{},b),Zn=Xt(Xn)?Un:0,ei=N.get("text-anchor").evaluate(Le,{},b),En=N.get("text-variable-anchor");if(!En){const jr=N.get("text-radial-offset").evaluate(Le,{},b);jt=jr?nm(ei,[24*jr,jd]):N.get("text-offset").evaluate(Le,{},b).map(Fn=>24*Fn)}let ci=pe?"center":N.get("text-justify").evaluate(Le,{},b);const yi=N.get("symbol-placement"),Nr="point"===yi,bo="point"===yi?24*N.get("text-max-width").evaluate(Le,{},b):0,Or=jr=>{t.allowVerticalPlacement&&mn(Xn)&&(Mt.vertical=Gu(Nt,e,i,h,qe,bo,xn,ei,jr,Zn,jt,pa.vertical,!0,yi,yt,it))};if(!pe&&En){const jr="auto"===ci?En.map(oo=>Ku(oo)):[ci];let Fn=!1;for(let oo=0;oo<jr.length;oo++){const Qr=jr[oo];if(!Mt.horizontal[Qr])if(Fn)Mt.horizontal[Qr]=Mt.horizontal[0];else{const Go=Gu(Nt,e,i,h,qe,bo,xn,"center",Qr,Zn,jt,pa.horizontal,!1,yi,yt,it);Go&&(Mt.horizontal[Qr]=Go,Fn=1===Go.positionedLines.length)}}Or("left")}else{if("auto"===ci&&(ci=Ku(ei)),Nr||N.get("text-writing-mode").indexOf("horizontal")>=0||!mn(Xn)){const jr=Gu(Nt,e,i,h,qe,bo,xn,ei,ci,Zn,jt,pa.horizontal,!1,yi,yt,it);jr&&(Mt.horizontal[ci]=jr)}Or("point"===yi?"left":ci)}}let wn=!1;if(Le.icon&&Le.icon.name){const Xn=s[Le.icon.name];Xn&&(Vt=Eg(h[Le.icon.name],N.get("icon-offset").evaluate(Le,{},b),N.get("icon-anchor").evaluate(Le,{},b)),wn=Xn.sdf,void 0===t.sdfIcons?t.sdfIcons=Xn.sdf:t.sdfIcons!==Xn.sdf&&Li("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Xn.pixelRatio!==t.pixelRatio||0!==N.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const vn=fp(Mt.horizontal)||Mt.vertical;t.iconsInText||(t.iconsInText=!!vn&&vn.iconsInText),(vn||Vt)&&Og(t,Le,Mt,Vt,s,H,yt,0,jt,wn,y,b,M)}m&&t.generateCollisionDebugBuffers(C,t.collisionBoxArray)}function Ku(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Og(t,e,i,s,h,m,y,b,C,M,N,j,H){let pe=m.textMaxSize.evaluate(e,{},j);void 0===pe&&(pe=y);const be=t.layers[0].layout,Le=be.get("icon-offset").evaluate(e,{},j),qe=fp(i.horizontal)||i.vertical,it=y/24,yt=t.tilePixelRatio*pe/24,Mt=t.tilePixelRatio*be.get("symbol-spacing"),Nt=be.get("text-padding")*t.tilePixelRatio,Vt=be.get("icon-padding")*t.tilePixelRatio,jt=In(be.get("text-max-angle")),wn="map"===be.get("text-rotation-alignment")&&"point"!==be.get("symbol-placement"),vn="map"===be.get("icon-rotation-alignment")&&"point"!==be.get("symbol-placement"),Xn=be.get("symbol-placement"),Un=Mt/2,xn=be.get("icon-text-fit");let Zn;s&&"none"!==xn&&(t.allowVerticalPlacement&&i.vertical&&(Zn=cp(s,i.vertical,xn,be.get("icon-text-fit-padding"),Le,it)),qe&&(s=cp(s,qe,xn,be.get("icon-text-fit-padding"),Le,it)));const ei=(En,ci,yi)=>{if(ci.x<0||ci.x>=yr||ci.y<0||ci.y>=yr)return;const{x:Nr,y:bo,z:Or}=H.projectTilePoint(ci.x,ci.y,yi),jr=new uc(Nr,bo,Or,0,void 0);!function(Fn,oo,Qr,Go,zo,us,ws,so,Rr,ko,Uo,qo,$o,Ts,na,ms,So,Xo,ia,gs,fo,Qo,Oo,Ns,rs){const _s=Fn.addToLineVertexArray(oo,Go);let Cs,Ms,os,ma,qc,Du,Hc,Bp=0,Cm=0,Np=0,zp=0,od=-1,oh=-1;const El={};let Up=eu(""),sh=0,sd=0;if(void 0===Rr._unevaluatedLayout.getValue("text-radial-offset")?[sh,sd]=Rr.layout.get("text-offset").evaluate(fo,{},rs).map($s=>24*$s):(sh=24*Rr.layout.get("text-radial-offset").evaluate(fo,{},rs),sd=jd),Fn.allowVerticalPlacement&&zo.vertical){const $s=zo.vertical;if(na)Du=mp($s),so&&(Hc=mp(so));else{const js=Rr.layout.get("text-rotate").evaluate(fo,{},rs)+90;os=Gd(ko,Qr,oo,Uo,qo,$o,$s,Ts,js,ms),so&&(ma=Gd(ko,Qr,oo,Uo,qo,$o,so,Xo,js))}}if(us){const $s=Rr.layout.get("icon-rotate").evaluate(fo,{},rs),js="none"!==Rr.layout.get("icon-text-fit"),Iu=Xf(us,$s,Oo,js),lh=so?Xf(so,$s,Oo,js):void 0;Ms=Gd(ko,Qr,oo,Uo,qo,$o,us,Xo,$s),Bp=4*Iu.length;const Zp=Fn.iconSizeData;let _c=null;"source"===Zp.kind?(_c=[xl*Rr.layout.get("icon-size").evaluate(fo,{},rs)],_c[0]>dc&&Li(`${Fn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Zp.kind&&(_c=[xl*Qo.compositeIconSizes[0].evaluate(fo,{},rs),xl*Qo.compositeIconSizes[1].evaluate(fo,{},rs)],(_c[0]>dc||_c[1]>dc)&&Li(`${Fn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Fn.addSymbols(Fn.icon,Iu,_c,gs,ia,fo,!1,Qr,oo,_s.lineStartIndex,_s.lineLength,-1,Ns,rs),od=Fn.icon.placedSymbolArray.length-1,lh&&(Cm=4*lh.length,Fn.addSymbols(Fn.icon,lh,_c,gs,ia,fo,pa.vertical,Qr,oo,_s.lineStartIndex,_s.lineLength,-1,Ns,rs),oh=Fn.icon.placedSymbolArray.length-1)}for(const $s in zo.horizontal){const js=zo.horizontal[$s];Cs||(Up=eu(js.text),na?qc=mp(js):Cs=Gd(ko,Qr,oo,Uo,qo,$o,js,Ts,Rr.layout.get("text-rotate").evaluate(fo,{},rs),ms));const Iu=1===js.positionedLines.length;if(Np+=Rg(Fn,Qr,oo,js,ws,Rr,na,fo,ms,_s,zo.vertical?pa.horizontal:pa.horizontalOnly,Iu?Object.keys(zo.horizontal):[$s],El,od,Qo,Ns,rs),Iu)break}zo.vertical&&(zp+=Rg(Fn,Qr,oo,zo.vertical,ws,Rr,na,fo,ms,_s,pa.vertical,["vertical"],El,oh,Qo,Ns,rs));let Dl=-1;const ah=($s,js)=>$s?Math.max($s,js):js;Dl=ah(qc,Dl),Dl=ah(Du,Dl),Dl=ah(Hc,Dl);const Em=Dl>-1?1:0;Fn.glyphOffsetArray.length>=wl.MAX_GLYPHS&&Li("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==fo.sortKey&&Fn.addToSortKeyRanges(Fn.symbolInstances.length,fo.sortKey),Fn.symbolInstances.emplaceBack(Qr.x,Qr.y,Qr.z,oo.x,oo.y,El.right>=0?El.right:-1,El.center>=0?El.center:-1,El.left>=0?El.left:-1,El.vertical>=0?El.vertical:-1,od,oh,Up,void 0!==Cs?Cs:Fn.collisionBoxArray.length,void 0!==Cs?Cs+1:Fn.collisionBoxArray.length,void 0!==os?os:Fn.collisionBoxArray.length,void 0!==os?os+1:Fn.collisionBoxArray.length,void 0!==Ms?Ms:Fn.collisionBoxArray.length,void 0!==Ms?Ms+1:Fn.collisionBoxArray.length,ma||Fn.collisionBoxArray.length,ma?ma+1:Fn.collisionBoxArray.length,Uo,Np,zp,Bp,Cm,Em,0,sh,sd,Dl)}(t,ci,jr,En,i,s,h,Zn,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Nt,wn,C,0,Vt,vn,Le,e,m,M,N,j)};if("line"===Xn)for(const En of Kf(e.geometry,0,0,yr,yr)){const ci=Ig(En,Mt,jt,i.vertical||qe,s,24,yt,t.overscaling,yr);for(const yi of ci){const Nr=qe;Nr&&Lg(t,Nr.text,Un,yi)||ei(En,yi,j)}}else if("line-center"===Xn){for(const En of e.geometry)if(En.length>1){const ci=Dg(En,jt,i.vertical||qe,s,24,yt);ci&&ei(En,ci,j)}}else if("Polygon"===e.type)for(const En of Uu(e.geometry,0)){const ci=em(En,16);ei(En[0],new uc(ci.x,ci.y,0,0,void 0),j)}else if("LineString"===e.type)for(const En of e.geometry)ei(En,new uc(En[0].x,En[0].y,0,0,void 0),j);else if("Point"===e.type)for(const En of e.geometry)for(const ci of En)ei([ci],new uc(ci.x,ci.y,0,0,void 0),j)}const dc=32640;function Rg(t,e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le,qe){const it=function(Nt,Vt,jt,wn,vn,Xn,Un,xn){const Zn=[];if(0===Vt.positionedLines.length)return Zn;const ei=wn.layout.get("text-rotate").evaluate(Xn,{})*Math.PI/180,En=function(Or){const jr=Or[0],Fn=Or[1],oo=jr*Fn;return oo>0?[jr,-Fn]:oo<0?[-jr,Fn]:0===jr?[Fn,jr]:[Fn,-jr]}(jt);let ci=Math.abs(Vt.top-Vt.bottom);for(const Or of Vt.positionedLines)ci-=Or.lineOffset;const yi=Vt.positionedLines.length,Nr=ci/yi;let bo=Vt.top-jt[1];for(let Or=0;Or<yi;++Or){const jr=Vt.positionedLines[Or];bo=Sg(Vt,Nr,bo,Or);for(const Fn of jr.positionedGlyphs){if(!Fn.rect)continue;const oo=Fn.rect||{};let Qr=4,Go=!0,zo=1,us=0;if(Fn.imageName){const Oo=Un[Fn.imageName];if(!Oo)continue;if(Oo.sdf){Li("SDF images are not supported in formatted text and will be ignored.");continue}Go=!1,zo=Oo.pixelRatio,Qr=1/zo}const ws=(vn||xn)&&Fn.vertical,so=Fn.metrics.advance*Fn.scale/2,Rr=Fn.metrics,ko=Fn.rect;if(null===ko)continue;xn&&Vt.verticalizable&&(us=Fn.imageName?so-Fn.metrics.width*Fn.scale/2:0);const Uo=vn?[Fn.x+so,Fn.y]:[0,0];let qo=[0,0],$o=[0,0],Ts=!1;vn||(ws?($o=[Fn.x+so+En[0],Fn.y+En[1]-us],Ts=!0):qo=[Fn.x+so+jt[0],Fn.y+jt[1]-us]);const na=ko.w*Fn.scale/(zo*(Fn.localGlyph?2:1)),ms=ko.h*Fn.scale/(zo*(Fn.localGlyph?2:1));let So,Xo,ia,gs;if(ws){const Oo=Fn.y-bo,Ns=new L(-so,so-Oo),rs=-Math.PI/2,_s=new L(...$o);So=new L(-so+qo[0],qo[1]),So._rotateAround(rs,Ns)._add(_s),So.x+=-Oo+so,So.y-=(Rr.left-Qr)*Fn.scale;const Cs=Fn.imageName?Rr.advance*Fn.scale:24*Fn.scale,Ms=String.fromCharCode(Fn.glyph);H_(Ms)?So.x+=(1-Qr)*Fn.scale:Zf(Ms)?So.x+=Cs-Rr.height*Fn.scale+(-Qr-1)*Fn.scale:So.x+=Fn.imageName||Rr.width+2*Qr===ko.w&&Rr.height+2*Qr===ko.h?(Cs-ms)/2:(Cs-(Rr.height+2*Qr)*Fn.scale)/2,Xo=new L(So.x,So.y-na),ia=new L(So.x+ms,So.y),gs=new L(So.x+ms,So.y-na)}else{const Oo=(Rr.left-Qr)*Fn.scale-so+qo[0],Ns=(-Rr.top-Qr)*Fn.scale+qo[1],rs=Oo+na,_s=Ns+ms;So=new L(Oo,Ns),Xo=new L(rs,Ns),ia=new L(Oo,_s),gs=new L(rs,_s)}if(ei){let Oo;Oo=vn?new L(0,0):Ts?new L(En[0],En[1]):new L(jt[0],jt[1]),So._rotateAround(ei,Oo),Xo._rotateAround(ei,Oo),ia._rotateAround(ei,Oo),gs._rotateAround(ei,Oo)}const fo=new L(0,0),Qo=new L(0,0);Zn.push({tl:So,tr:Xo,bl:ia,br:gs,tex:oo,writingMode:Vt.writingMode,glyphOffset:Uo,sectionIndex:Fn.sectionIndex,isSDF:Go,pixelOffsetTL:fo,pixelOffsetBR:Qo,minFontScaleX:0,minFontScaleY:0})}}return Zn}(0,s,C,m,y,b,h,t.allowVerticalPlacement),yt=t.textSizeData;let Mt=null;"source"===yt.kind?(Mt=[xl*m.layout.get("text-size").evaluate(b,{},qe)],Mt[0]>dc&&Li(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===yt.kind&&(Mt=[xl*be.compositeTextSizes[0].evaluate(b,{},qe),xl*be.compositeTextSizes[1].evaluate(b,{},qe)],(Mt[0]>dc||Mt[1]>dc)&&Li(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,it,Mt,C,y,b,N,e,i,M.lineStartIndex,M.lineLength,pe,Le,qe);for(const Nt of j)H[Nt]=t.text.placedSymbolArray.length-1;return 4*it.length}function fp(t){for(const e in t)return t[e];return null}function Gd(t,e,i,s,h,m,y,b,C,M){let N=y.top,j=y.bottom,H=y.left,pe=y.right;const be=y.collisionPadding;if(be&&(H-=be[0],N-=be[1],pe+=be[2],j+=be[3]),C){const Le=new L(H,N),qe=new L(pe,N),it=new L(H,j),yt=new L(pe,j),Mt=In(C);let Nt=new L(0,0);M&&(Nt=new L(M[0],M[1])),Le._rotateAround(Mt,Nt),qe._rotateAround(Mt,Nt),it._rotateAround(Mt,Nt),yt._rotateAround(Mt,Nt),H=Math.min(Le.x,qe.x,it.x,yt.x),pe=Math.max(Le.x,qe.x,it.x,yt.x),N=Math.min(Le.y,qe.y,it.y,yt.y),j=Math.max(Le.y,qe.y,it.y,yt.y)}return t.emplaceBack(e.x,e.y,e.z,i.x,i.y,H,N,pe,j,b,s,h,m),t.length-1}function mp(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Lg(t,e,i,s){const h=t.compareText;if(e in h){const m=h[e];for(let y=m.length-1;y>=0;y--)if(s.dist(m[y])<i)return!0}else h[e]=[];return h[e].push(s),!1}const gp=Nc.VectorTileFeature.types,Fg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function qd(t,e,i,s,h,m,y,b,C,M,N,j,H,pe,be,Le){const qe=N?Math.min(dc,Math.round(N[0])):0,it=N?Math.min(dc,Math.round(N[1])):0;t.emplaceBack(e,i,Math.round(32*y),Math.round(32*b),C,M,(qe<<1)+(j?1:0),it,16*H,16*pe,256*be,256*Le,s,h,m,0)}function gu(t,e,i){t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i),t.emplaceBack(e.x,e.y,i)}function _p(t){for(const e of t.sections)if($n(e.text))return!0;return!1}class yp{constructor(e){this.layoutVertexArray=new rf,this.indexArray=new Qs,this.programConfigurations=e,this.segments=new Jo,this.dynamicLayoutVertexArray=new Ga,this.opacityVertexArray=new Qc,this.placedSymbolArray=new wh}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,i,s,h){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,G_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Rd.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Fg,!0),this.opacityVertexBuffer.itemSize=1),(s||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}li("SymbolBuffers",yp);class Xu{constructor(e,i,s){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new s,this.segments=new Jo,this.collisionVertexArray=new hd,this.collisionVertexArrayExt=new Ga}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ld.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,ep.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}li("CollisionBuffers",Xu);class wl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ye([]),this.placementViewportMatrix=ye([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=np(this.zoom,i["text-size"]),this.iconSizeData=np(this.zoom,i["icon-size"]);const s=this.layers[0].layout,h=s.get("symbol-sort-key"),m=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==m&&void 0!==h.constantOr(1),this.sortFeaturesByY=("viewport-y"===m||"auto"===m&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(y=>pa[y]),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new yp(new Sc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new yp(new Sc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new cf,this.lineVertexArray=new uf,this.symbolInstances=new lf}calculateGlyphDependencies(e,i,s,h,m){for(let y=0;y<e.length;y++)if(i[e.charCodeAt(y)]=!0,h&&m){const b=$u[e.charAt(y)];b&&(i[b.charCodeAt(0)]=!0)}}populate(e,i,s,h){const m=this.layers[0],y=m.layout,b=y.get("text-font"),C=y.get("text-field"),M=y.get("icon-image"),N=("constant"!==C.value.kind||C.value.value instanceof yn&&!C.value.value.isEmpty()||C.value.value.toString().length>0)&&("constant"!==b.value.kind||b.value.value.length>0),j="constant"!==M.value.kind||!!M.value.value||Object.keys(M.parameters).length>0,H=y.get("symbol-sort-key");if(this.features=[],!N&&!j)return;const pe=i.iconDependencies,be=i.glyphDependencies,Le=i.availableImages,qe=new lr(this.zoom);for(const{feature:it,id:yt,index:Mt,sourceLayerIndex:Nt}of e){const Vt=m._featureFilter.needGeometry,jt=Ul(it,Vt);if(!m._featureFilter.filter(qe,jt,s))continue;let wn,vn;if(Vt||(jt.geometry=zl(it,s,h)),N){const Un=m.getValueAndResolveTokens("text-field",jt,s,Le),xn=yn.factory(Un);_p(xn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===xs()||this.hasRTLText&&$r.isParsed())&&(wn=q_(xn,m,jt))}if(j){const Un=m.getValueAndResolveTokens("icon-image",jt,s,Le);vn=Un instanceof oi?Un:oi.fromString(Un)}if(!wn&&!vn)continue;const Xn=this.sortFeaturesByKey?H.evaluate(jt,{},s):void 0;if(this.features.push({id:yt,text:wn,icon:vn,index:Mt,sourceLayerIndex:Nt,geometry:jt.geometry,properties:it.properties,type:gp[it.type],sortKey:Xn}),vn&&(pe[vn.name]=!0),wn){const Un=b.evaluate(jt,{},s).join(","),xn="map"===y.get("text-rotation-alignment")&&"point"!==y.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(pa.vertical)>=0;for(const Zn of wn.sections)if(Zn.image)pe[Zn.image.name]=!0;else{const ei=mn(wn.toString()),En=Zn.fontStack||Un,ci=be[En]=be[En]||{};this.calculateGlyphDependencies(Zn.text,ci,xn,this.allowVerticalPlacement,ei)}}}"line"===y.get("symbol-placement")&&(this.features=function(it){const yt={},Mt={},Nt=[];let Vt=0;function jt(Un){Nt.push(it[Un]),Vt++}function wn(Un,xn,Zn){const ei=Mt[Un];return delete Mt[Un],Mt[xn]=ei,Nt[ei].geometry[0].pop(),Nt[ei].geometry[0]=Nt[ei].geometry[0].concat(Zn[0]),ei}function vn(Un,xn,Zn){const ei=yt[xn];return delete yt[xn],yt[Un]=ei,Nt[ei].geometry[0].shift(),Nt[ei].geometry[0]=Zn[0].concat(Nt[ei].geometry[0]),ei}function Xn(Un,xn,Zn){const ei=Zn?xn[0][xn[0].length-1]:xn[0][0];return`${Un}:${ei.x}:${ei.y}`}for(let Un=0;Un<it.length;Un++){const xn=it[Un],Zn=xn.geometry,ei=xn.text?xn.text.toString():null;if(!ei){jt(Un);continue}const En=Xn(ei,Zn),ci=Xn(ei,Zn,!0);if(En in Mt&&ci in yt&&Mt[En]!==yt[ci]){const yi=vn(En,ci,Zn),Nr=wn(En,ci,Nt[yi].geometry);delete yt[En],delete Mt[ci],Mt[Xn(ei,Nt[Nr].geometry,!0)]=Nr,Nt[yi].geometry=null}else En in Mt?wn(En,ci,Zn):ci in yt?vn(En,ci,Zn):(jt(Un),yt[En]=Vt-1,Mt[ci]=Vt-1)}return Nt.filter(Un=>Un.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((it,yt)=>it.sortKey-yt.sortKey)}update(e,i,s,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,s,h),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,s,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const s=this.lineVertexArray.length;if(void 0!==e.segment){let h=e.dist(i[e.segment+1]),m=e.dist(i[e.segment]);const y={};for(let b=e.segment+1;b<i.length;b++)y[b]={x:i[b].x,y:i[b].y,tileUnitDistanceFromAnchor:h},b<i.length-1&&(h+=i[b+1].dist(i[b]));for(let b=e.segment||0;b>=0;b--)y[b]={x:i[b].x,y:i[b].y,tileUnitDistanceFromAnchor:m},b>0&&(m+=i[b-1].dist(i[b]));for(let b=0;b<i.length;b++){const C=y[b];this.lineVertexArray.emplaceBack(C.x,C.y,C.tileUnitDistanceFromAnchor)}}return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,i,s,h,m,y,b,C,M,N,j,H,pe,be){const Le=e.indexArray,qe=e.layoutVertexArray,it=e.segments.prepareSegment(4*i.length,qe,Le,this.canOverlap?y.sortKey:void 0),yt=this.glyphOffsetArray.length,Mt=it.vertexLength,Nt=this.allowVerticalPlacement&&b===pa.vertical?Math.PI/2:0,Vt=y.text&&y.text.sections;for(let jt=0;jt<i.length;jt++){const{tl:wn,tr:vn,bl:Xn,br:Un,tex:xn,pixelOffsetTL:Zn,pixelOffsetBR:ei,minFontScaleX:En,minFontScaleY:ci,glyphOffset:yi,isSDF:Nr,sectionIndex:bo}=i[jt],Or=it.vertexLength,jr=yi[1];qd(qe,C.x,C.y,C.z,M.x,M.y,wn.x,jr+wn.y,xn.x,xn.y,s,Nr,Zn.x,Zn.y,En,ci),qd(qe,C.x,C.y,C.z,M.x,M.y,vn.x,jr+vn.y,xn.x+xn.w,xn.y,s,Nr,ei.x,Zn.y,En,ci),qd(qe,C.x,C.y,C.z,M.x,M.y,Xn.x,jr+Xn.y,xn.x,xn.y+xn.h,s,Nr,Zn.x,ei.y,En,ci),qd(qe,C.x,C.y,C.z,M.x,M.y,Un.x,jr+Un.y,xn.x+xn.w,xn.y+xn.h,s,Nr,ei.x,ei.y,En,ci),gu(e.dynamicLayoutVertexArray,C,Nt),Le.emplaceBack(Or,Or+1,Or+2),Le.emplaceBack(Or+1,Or+2,Or+3),it.vertexLength+=4,it.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(yi[0]),jt!==i.length-1&&bo===i[jt+1].sectionIndex||e.programConfigurations.populatePaintArrays(qe.length,y,y.index,{},pe,be,Vt&&Vt[bo])}e.placedSymbolArray.emplaceBack(C.x,C.y,C.z,M.x,M.y,yt,this.glyphOffsetArray.length-yt,Mt,N,j,M.segment,s?s[0]:0,s?s[1]:0,h[0],h[1],b,0,!1,0,H,0)}_commitLayoutVertex(e,i,s,h,m,y,b){e.emplaceBack(i,s,h,m,y,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(e,i,s,h,m,y,b){const C=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),M=C.vertexLength,N=b.tileAnchorX,j=b.tileAnchorY;for(let pe=0;pe<4;pe++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,h,m,y,N,j,new L(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,h,m,y,N,j,new L(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,h,m,y,N,j,new L(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,h,m,y,N,j,new L(e.x1,e.y2)),C.vertexLength+=4;const H=s.indexArray;H.emplaceBack(M,M+1),H.emplaceBack(M+1,M+2),H.emplaceBack(M+2,M+3),H.emplaceBack(M+3,M),C.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,s,h,m,y){for(let b=h;b<m;b++){const C=s.get(b),M=this.getSymbolInstanceTextSize(e,y,i,b);this._addCollisionDebugVertices(C,M,this.textCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,y)}}_addIconDebugCollisionBoxes(e,i,s,h,m,y){for(let b=h;b<m;b++){const C=s.get(b),M=this.getSymbolInstanceIconSize(e,i,b);this._addCollisionDebugVertices(C,M,this.iconCollisionBox,C.projectedAnchorX,C.projectedAnchorY,C.projectedAnchorZ,y)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Xu(Ou,Fd.members,Da),this.iconCollisionBox=new Xu(Ou,Fd.members,Da);const s=du(this.iconSizeData,e),h=du(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._addTextDebugCollisionBoxes(h,e,i,y.textBoxStartIndex,y.textBoxEndIndex,y),this._addTextDebugCollisionBoxes(h,e,i,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._addIconDebugCollisionBoxes(s,e,i,y.iconBoxStartIndex,y.iconBoxEndIndex,y),this._addIconDebugCollisionBoxes(s,e,i,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex,y)}}getSymbolInstanceTextSize(e,i,s,h){const m=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:h),y=Bd(this.textSizeData,e,m)/24;return this.tilePixelRatio*y}getSymbolInstanceIconSize(e,i,s){const h=this.icon.placedSymbolArray.get(s),m=Bd(this.iconSizeData,e,h);return this.tilePixelRatio*m}_commitDebugCollisionVertexUpdate(e,i,s){e.emplaceBack(i,-s,-s),e.emplaceBack(i,s,-s),e.emplaceBack(i,s,s),e.emplaceBack(i,-s,s)}_updateTextDebugCollisionBoxes(e,i,s,h,m,y){for(let b=h;b<m;b++){const C=s.get(b),M=this.getSymbolInstanceTextSize(e,y,i,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,C.padding)}}_updateIconDebugCollisionBoxes(e,i,s,h,m){for(let y=h;y<m;y++){const b=s.get(y),C=this.getSymbolInstanceIconSize(e,i,y);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,C,b.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=du(this.iconSizeData,e),h=du(this.textSizeData,e);for(let m=0;m<this.symbolInstances.length;m++){const y=this.symbolInstances.get(m);this._updateTextDebugCollisionBoxes(h,e,i,y.textBoxStartIndex,y.textBoxEndIndex,y),this._updateTextDebugCollisionBoxes(h,e,i,y.verticalTextBoxStartIndex,y.verticalTextBoxEndIndex,y),this._updateIconDebugCollisionBoxes(s,e,i,y.iconBoxStartIndex,y.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(s,e,i,y.verticalIconBoxStartIndex,y.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,s,h,m,y,b,C,M){const N={};for(let j=i;j<s;j++){const H=e.get(j);N.textBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,padding:H.padding,projectedAnchorX:H.projectedAnchorX,projectedAnchorY:H.projectedAnchorY,projectedAnchorZ:H.projectedAnchorZ,tileAnchorX:H.tileAnchorX,tileAnchorY:H.tileAnchorY},N.textFeatureIndex=H.featureIndex;break}for(let j=h;j<m;j++){const H=e.get(j);N.verticalTextBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,padding:H.padding,projectedAnchorX:H.projectedAnchorX,projectedAnchorY:H.projectedAnchorY,projectedAnchorZ:H.projectedAnchorZ,tileAnchorX:H.tileAnchorX,tileAnchorY:H.tileAnchorY},N.verticalTextFeatureIndex=H.featureIndex;break}for(let j=y;j<b;j++){const H=e.get(j);N.iconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,padding:H.padding,projectedAnchorX:H.projectedAnchorX,projectedAnchorY:H.projectedAnchorY,projectedAnchorZ:H.projectedAnchorZ,tileAnchorX:H.tileAnchorX,tileAnchorY:H.tileAnchorY},N.iconFeatureIndex=H.featureIndex;break}for(let j=C;j<M;j++){const H=e.get(j);N.verticalIconBox={x1:H.x1,y1:H.y1,x2:H.x2,y2:H.y2,padding:H.padding,projectedAnchorX:H.projectedAnchorX,projectedAnchorY:H.projectedAnchorY,projectedAnchorZ:H.projectedAnchorZ,tileAnchorX:H.tileAnchorX,tileAnchorY:H.tileAnchorY},N.verticalIconFeatureIndex=H.featureIndex;break}return N}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const s=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const s=e.placedSymbolArray.get(i),h=s.vertexStartIndex+4*s.numGlyphs;for(let m=s.vertexStartIndex;m<h;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const i=Math.sin(e),s=Math.cos(e),h=[],m=[],y=[];for(let b=0;b<this.symbolInstances.length;++b){y.push(b);const C=this.symbolInstances.get(b);h.push(0|Math.round(i*C.tileAnchorX+s*C.tileAnchorY)),m.push(C.featureIndex)}return y.sort((b,C)=>h[b]-h[C]||m[C]-m[b]),y}addToSortKeyRanges(e,i){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===i?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const s=this.symbolInstances.get(i);this.featureSortOrder.push(s.featureIndex),[s.rightJustifiedTextSymbolIndex,s.centerJustifiedTextSymbolIndex,s.leftJustifiedTextSymbolIndex].forEach((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),s.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,s.verticalPlacedTextSymbolIndex),s.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.placedIconSymbolIndex),s.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,s.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}li("SymbolBucket",wl,{omit:["layers","collisionBoxArray","features","compareText"]}),wl.MAX_GLYPHS=65535,wl.addDynamicAttributes=gu;const im=new fs({"symbol-placement":new _i(Bt.layout_symbol["symbol-placement"]),"symbol-spacing":new _i(Bt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new _i(Bt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Ni(Bt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new _i(Bt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new _i(Bt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new _i(Bt.layout_symbol["icon-ignore-placement"]),"icon-optional":new _i(Bt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new _i(Bt.layout_symbol["icon-rotation-alignment"]),"icon-size":new Ni(Bt.layout_symbol["icon-size"]),"icon-text-fit":new _i(Bt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new _i(Bt.layout_symbol["icon-text-fit-padding"]),"icon-image":new Ni(Bt.layout_symbol["icon-image"]),"icon-rotate":new Ni(Bt.layout_symbol["icon-rotate"]),"icon-padding":new _i(Bt.layout_symbol["icon-padding"]),"icon-keep-upright":new _i(Bt.layout_symbol["icon-keep-upright"]),"icon-offset":new Ni(Bt.layout_symbol["icon-offset"]),"icon-anchor":new Ni(Bt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new _i(Bt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new _i(Bt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new _i(Bt.layout_symbol["text-rotation-alignment"]),"text-field":new Ni(Bt.layout_symbol["text-field"]),"text-font":new Ni(Bt.layout_symbol["text-font"]),"text-size":new Ni(Bt.layout_symbol["text-size"]),"text-max-width":new Ni(Bt.layout_symbol["text-max-width"]),"text-line-height":new Ni(Bt.layout_symbol["text-line-height"]),"text-letter-spacing":new Ni(Bt.layout_symbol["text-letter-spacing"]),"text-justify":new Ni(Bt.layout_symbol["text-justify"]),"text-radial-offset":new Ni(Bt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new _i(Bt.layout_symbol["text-variable-anchor"]),"text-anchor":new Ni(Bt.layout_symbol["text-anchor"]),"text-max-angle":new _i(Bt.layout_symbol["text-max-angle"]),"text-writing-mode":new _i(Bt.layout_symbol["text-writing-mode"]),"text-rotate":new Ni(Bt.layout_symbol["text-rotate"]),"text-padding":new _i(Bt.layout_symbol["text-padding"]),"text-keep-upright":new _i(Bt.layout_symbol["text-keep-upright"]),"text-transform":new Ni(Bt.layout_symbol["text-transform"]),"text-offset":new Ni(Bt.layout_symbol["text-offset"]),"text-allow-overlap":new _i(Bt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new _i(Bt.layout_symbol["text-ignore-placement"]),"text-optional":new _i(Bt.layout_symbol["text-optional"])});var vp={paint:new fs({"icon-opacity":new Ni(Bt.paint_symbol["icon-opacity"]),"icon-color":new Ni(Bt.paint_symbol["icon-color"]),"icon-halo-color":new Ni(Bt.paint_symbol["icon-halo-color"]),"icon-halo-width":new Ni(Bt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Ni(Bt.paint_symbol["icon-halo-blur"]),"icon-translate":new _i(Bt.paint_symbol["icon-translate"]),"icon-translate-anchor":new _i(Bt.paint_symbol["icon-translate-anchor"]),"text-opacity":new Ni(Bt.paint_symbol["text-opacity"]),"text-color":new Ni(Bt.paint_symbol["text-color"],{runtimeType:wo,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new Ni(Bt.paint_symbol["text-halo-color"]),"text-halo-width":new Ni(Bt.paint_symbol["text-halo-width"]),"text-halo-blur":new Ni(Bt.paint_symbol["text-halo-blur"]),"text-translate":new _i(Bt.paint_symbol["text-translate"]),"text-translate-anchor":new _i(Bt.paint_symbol["text-translate-anchor"])}),layout:im};class rm{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:mo,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}li("FormatSectionOverride",rm,{omit:["defaultValue"]});class _u extends Ha{constructor(e){super(e,vp)}recalculate(e,i){super.recalculate(e,i),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const h=[];for(const m of s)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,s,h){const m=this.layout.get(e).evaluate(i,{},s,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Ws(y.value)||!m?m:(b=i.properties,m.replace(/{([^{}]+)}/g,(M,N)=>N in b?String(b[N]):""));var b}createBucket(e){return new wl(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of vp.paint.overridableProperties){if(!_u.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),s=new rm(i),h=new Cc(s,i.property.specification);let m=null;m="constant"===i.value.kind||"source"===i.value.kind?new cl("source",h):new Ec("composite",h,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new bs(i.property,m,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,s){return!(!this.layout||i.isDataDriven()||s.isDataDriven())&&_u.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const s=e.get("text-field"),h=vp.paint.properties[i];let m=!1;const y=b=>{for(const C of b)if(h.overrides&&h.overrides.hasOverride(C))return void(m=!0)};if("constant"===s.value.kind&&s.value.value instanceof yn)y(s.value.value.sections);else if("source"===s.value.kind){const b=M=>{m||(M instanceof Di&&bi(M.value)===At?y(M.value.sections):M instanceof io?y(M.sections):M.eachChild(b))},C=s.value;C._styleExpression&&b(C._styleExpression.expression)}return m}getProgramConfiguration(e){return new Po(this,e)}}var K_={paint:new fs({"background-color":new _i(Bt.paint_background["background-color"]),"background-pattern":new Ks(Bt.paint_background["background-pattern"]),"background-opacity":new _i(Bt.paint_background["background-opacity"])})},Bg={paint:new fs({"raster-opacity":new _i(Bt.paint_raster["raster-opacity"]),"raster-hue-rotate":new _i(Bt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new _i(Bt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new _i(Bt.paint_raster["raster-brightness-max"]),"raster-saturation":new _i(Bt.paint_raster["raster-saturation"]),"raster-contrast":new _i(Bt.paint_raster["raster-contrast"]),"raster-resampling":new _i(Bt.paint_raster["raster-resampling"]),"raster-fade-duration":new _i(Bt.paint_raster["raster-fade-duration"])})};class om extends Ha{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var sm={paint:new fs({"sky-type":new _i(Bt.paint_sky["sky-type"]),"sky-atmosphere-sun":new _i(Bt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new _i(Bt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new _i(Bt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new _i(Bt.paint_sky["sky-gradient-radius"]),"sky-gradient":new Xs(Bt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new _i(Bt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new _i(Bt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new _i(Bt.paint_sky["sky-opacity"])})};function Hd(t,e,i){const s=xt(0,0,1),h=Bn(di());return function(m,y,b){b*=.5;var C=y[0],M=y[1],N=y[2],j=y[3],H=Math.sin(b),pe=Math.cos(b);m[0]=C*pe-N*H,m[1]=M*pe+j*H,m[2]=N*pe+C*H,m[3]=j*pe-M*H}(h,h,i?-In(t)+Math.PI:In(t)),ln(h,h,-In(e)),Wt(s,s,h),Lt(s,s)}const am={circle:class extends Ha{constructor(t){super(t,$_)}createBucket(t){return new kh(t)}queryRadius(t){const e=t;return ou("circle-radius",this,e)+ou("circle-stroke-width",this,e)+wd(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,s,h,m,y,b){const C=Pc(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return sg(t,s,m,y,b,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),C,M)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Po(this,t)}},heatmap:class extends Ha{createBucket(t){return new Lh(t)}constructor(t){super(t,Tf),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Cf({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return ou("heatmap-radius",this,t)}queryIntersectsFeature(t,e,i,s,h,m,y,b){const C=this.paint.get("heatmap-radius").evaluate(e,i);return sg(t,s,m,y,b,!0,!0,new L(0,0),C)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Po(this,t)}},hillshade:class extends Ha{constructor(t){super(t,su)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(t){return new Po(this,t)}},fill:class extends Ha{constructor(t){super(t,kf)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(t){return new Po(this,t)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Pd(t)}queryRadius(){return wd(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,s,h,m){return!t.queryGeometry.isAboveHorizon&&gf(bf(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends Ha{constructor(t){super(t,_g)}createBucket(t){return new Yh(t)}queryRadius(){return wd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Po(this,t)}queryIntersectsFeature(t,e,i,s,h,m,y,b,C){const M=Pc(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),N=this.paint.get("fill-extrusion-height").evaluate(e,i),j=this.paint.get("fill-extrusion-base").evaluate(e,i),H=[0,0],pe=b&&m.elevation,be=m.elevation?m.elevation.exaggeration():1;if(pe){const it=t.tile.getBucket(this).centroidVertexArray,yt=C+1;if(yt<it.length){const Mt=it.get(yt);H[0]=Mt.a_centroid_pos0,H[1]=Mt.a_centroid_pos1}}if(0===H[0]&&1===H[1])return!1;const Le=(it=s,yt=j,Mt=N,Nt=M,Vt=y,(jt=pe?b:null)?function(Un,xn,Zn,ei,En,ci,yi,Nr,bo){const Or=[],jr=[],Fn=[0,0,0,1];for(const oo of Un){const Qr=[],Go=[];for(const zo of oo){const us=zo.x+ei.x,ws=zo.y+ei.y,so=Bf(us,ws,xn,Zn,ci,yi,Nr,bo);Fn[0]=us,Fn[1]=ws,Fn[2]=so.base,Fn[3]=1,si(Fn,Fn,En),Fn[3]=Math.max(Fn[3],1e-5);const Rr=Kh([Fn[0]/Fn[3],Fn[1]/Fn[3],Fn[2]/Fn[3]]);Fn[0]=us,Fn[1]=ws,Fn[2]=so.top,Fn[3]=1,si(Fn,Fn,En),Fn[3]=Math.max(Fn[3],1e-5);const ko=Kh([Fn[0]/Fn[3],Fn[1]/Fn[3],Fn[2]/Fn[3]]);Qr.push(Rr),Go.push(ko)}Or.push(Qr),jr.push(Go)}return[Or,jr]}(it,yt,Mt,Nt,Vt,jt,H,be,m.center.lat):function(Un,xn,Zn,ei,En){const ci=[],yi=[],Nr=En[8]*xn,bo=En[9]*xn,Or=En[10]*xn,jr=En[11]*xn,Fn=En[8]*Zn,oo=En[9]*Zn,Qr=En[10]*Zn,Go=En[11]*Zn;for(const zo of Un){const us=[],ws=[];for(const so of zo){const Rr=so.x+ei.x,ko=so.y+ei.y,Uo=En[0]*Rr+En[4]*ko+En[12],qo=En[1]*Rr+En[5]*ko+En[13],$o=En[2]*Rr+En[6]*ko+En[14],Ts=En[3]*Rr+En[7]*ko+En[15],na=Uo+Nr,ms=qo+bo,So=$o+Or,Xo=Math.max(Ts+jr,1e-5),ia=Uo+Fn,gs=qo+oo,fo=$o+Qr,Qo=Math.max(Ts+Go,1e-5),Oo=new L(na/Xo,ms/Xo);Oo.z=So/Xo,us.push(Oo);const Ns=new L(ia/Qo,gs/Qo);Ns.z=fo/Qo,ws.push(Ns)}ci.push(us),yi.push(ws)}return[ci,yi]}(it,yt,Mt,Nt,Vt)),qe=t.queryGeometry;var it,yt,Mt,Nt,Vt,jt;return function(it,yt,Mt){let Nt=1/0;gf(Mt,yt)&&(Nt=Jh(Mt,yt[0]));for(let Vt=0;Vt<yt.length;Vt++){const jt=yt[Vt],wn=it[Vt];for(let vn=0;vn<jt.length-1;vn++){const Xn=jt[vn],Un=[Xn,jt[vn+1],wn[vn+1],wn[vn],Xn];iu(Mt,Un)&&(Nt=Math.min(Nt,Jh(Mt,Un)))}}return Nt!==1/0&&Nt}(Le[0],Le[1],qe.isPointQuery()?qe.screenBounds:qe.screenGeometry)}},line:class extends Ha{constructor(t){super(t,Od),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ka,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=vg.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new uu(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Po(this,t)}queryRadius(t){const e=t,i=Qh(ou("line-width",this,e),ou("line-gap-width",this,e)),s=ou("line-offset",this,e);return i/2+Math.abs(s)+wd(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,s,h,m){if(t.queryGeometry.isAboveHorizon)return!1;const y=bf(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),m.angle,t.pixelToTileUnitsFactor),b=t.pixelToTileUnitsFactor/2*Qh(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),C=this.paint.get("line-offset").evaluate(e,i);return C&&(s=function(M,N){const j=[],H=new L(0,0);for(let pe=0;pe<M.length;pe++){const be=M[pe],Le=[];for(let qe=0;qe<be.length;qe++){const it=be[qe-1],yt=be[qe],Mt=be[qe+1],Nt=0===qe?H:yt.sub(it)._unit()._perp(),Vt=qe===be.length-1?H:Mt.sub(yt)._unit()._perp(),jt=Nt._add(Vt)._unit();jt._mult(1/(jt.x*Vt.x+jt.y*Vt.y)),Le.push(jt._mult(N)._add(yt))}j.push(Le)}return j}(s,C*t.pixelToTileUnitsFactor)),function(M,N,j){for(let H=0;H<N.length;H++){const pe=N[H];if(M.length>=3)for(let be=0;be<pe.length;be++)if(ru(M,pe[be]))return!0;if(rg(M,pe,j))return!0}return!1}(y,s,b)}isTileClipped(){return!0}},symbol:_u,background:class extends Ha{constructor(t){super(t,K_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Ha{constructor(t){super(t,Bg)}getProgramIds(){return["raster"]}},sky:class extends Ha{constructor(t){super(t,sm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Cf({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(t,e){const i=this.paint.get("sky-type");if("atmosphere"===i){const s=this.paint.get("sky-atmosphere-sun"),h=!s,m=t.style.light,y=m.properties.get("position");return h&&"viewport"===m.properties.get("anchor")&&Li("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?Hd(y.azimuthal,90-y.polar,e):Hd(s[0],90-s[1],e)}if("gradient"===i){const s=this.paint.get("sky-gradient-center");return Hd(s[0],90-s[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}},{HTMLImageElement:xp,HTMLCanvasElement:Tl,HTMLVideoElement:Qu,ImageData:lm,ImageBitmap:Wd}=Z;class bp{constructor(e,i,s,h){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(i,h)}update(e,i,s){const{width:h,height:m}=e,{context:y}=this,{gl:b}=y;if(b.bindTexture(b.TEXTURE_2D,this.texture),y.pixelStoreUnpackFlipY.set(!1),y.pixelStoreUnpack.set(1),y.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!i||!1!==i.premultiply)),s||this.size&&this.size[0]===h&&this.size[1]===m){const{x:C,y:M}=s||{x:0,y:0};e instanceof xp||e instanceof Tl||e instanceof Qu||e instanceof lm||Wd&&e instanceof Wd?b.texSubImage2D(b.TEXTURE_2D,0,C,M,b.RGBA,b.UNSIGNED_BYTE,e):b.texSubImage2D(b.TEXTURE_2D,0,C,M,h,m,b.RGBA,b.UNSIGNED_BYTE,e.data)}else this.size=[h,m],e instanceof xp||e instanceof Tl||e instanceof Qu||e instanceof lm||Wd&&e instanceof Wd?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,e):b.texImage2D(b.TEXTURE_2D,0,this.format,h,m,0,this.format,b.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(e,i){const{context:s}=this,{gl:h}=s;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,i),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class ed{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new vl({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const s=this.getKey(e,i);return this.positions[s]}trim(){const e=this.width,i=this.height=Be(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,s){const h=[];let m=e.length%2==1?-e[e.length-1]*s:0,y=e[0]*s,b=!0;h.push({left:m,right:y,isDash:b,zeroLength:0===e[0]});let C=e[0];for(let M=1;M<e.length;M++){b=!b;const N=e[M];m=C*s,C+=N,y=C*s,h.push({left:m,right:y,isDash:b,zeroLength:0===N})}return h}addRoundDash(e,i,s){const h=i/2;for(let m=-s;m<=s;m++){const y=this.width*(this.nextRow+s+m);let b=0,C=e[b];for(let M=0;M<this.width;M++){M/C.right>1&&(C=e[++b]);const N=Math.abs(M-C.left),j=Math.abs(M-C.right),H=Math.min(N,j);let pe;const be=m/s*(h+1);if(C.isDash){const Le=h-Math.abs(be);pe=Math.sqrt(H*H+Le*Le)}else pe=h-Math.sqrt(H*H+be*be);this.image.data[y+M]=Math.max(0,Math.min(255,pe+128))}}}addRegularDash(e,i){for(let C=e.length-1;C>=0;--C){const M=e[C],N=e[C+1];M.zeroLength?e.splice(C,1):N&&N.isDash===M.isDash&&(N.left=M.left,e.splice(C,1))}const s=e[0],h=e[e.length-1];s.isDash===h.isDash&&(s.left=h.left-this.width,h.right=s.right+this.width);const m=this.width*this.nextRow;let y=0,b=e[y];for(let C=0;C<this.width;C++){C/b.right>1&&(b=e[++y]);const M=Math.abs(C-b.left),N=Math.abs(C-b.right),j=Math.min(M,N);this.image.data[m+C]=Math.max(0,Math.min(255,(b.isDash?j:-j)+i+128))}}addDash(e,i){const s=this.getKey(e,i);if(this.positions[s])return this.positions[s];const h="round"===i,m=h?7:0,y=2*m+1;if(this.nextRow+y>this.height)return Li("LineAtlas out of space"),null;0===e.length&&e.push(1);let b=0;for(let N=0;N<e.length;N++)e[N]<0&&(Li("Negative value is found in line dasharray, replacing values with 0"),e[N]=0),b+=e[N];if(0!==b){const N=this.width/b,j=this.getDashRanges(e,this.width,N);h?this.addRoundDash(j,N,m):this.addRegularDash(j,"square"===i?.5*N:0)}const C=this.nextRow+m;this.nextRow+=y;const M={tl:[C,m],br:[b,0]};return this.positions[s]=M,M}}li("LineAtlas",ed);class cm{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const wp=Z.performance;function yu(t){const e=t?t.url.toString():void 0;return wp.getEntriesByName(e)}class Ng{constructor(){this.tasks={},this.taskQueue=[],xe(["process"],this),this.invoker=new cm(this.process),this.nextId=0}add(e,i){const s=this.nextId++,h=function({type:m,isSymbolTile:y,zoom:b}){return b=b||0,"message"===m?0:"maybePrepare"!==m||y?"parseTile"!==m||y?"parseTile"===m&&y?300-b:"maybePrepare"===m&&y?400-b:500:200-b:100-b}(i);if(0===h){vr();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:i,priority:h,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){vr();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let h=0;h<this.taskQueue.length;h++){const m=this.tasks[this.taskQueue[h]];m.priority<i&&(i=m.priority,e=h)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}function Yd(t,e,i){var s=2*Math.PI*6378137/256/Math.pow(2,i);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class td{constructor(e,i,s){this.z=e,this.x=i,this.y=s,this.key=nd(0,e,e,i,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const s=(y=this.y,b=this.z,C=Yd(256*(m=this.x),256*(y=Math.pow(2,b)-y-1),b),M=Yd(256*(m+1),256*(y+1),b),C[0]+","+C[1]+","+M[0]+","+M[1]),h=function(m,y,b){let C,M="";for(let N=m;N>0;N--)C=1<<N-1,M+=(y&C?1:0)+(b&C?2:0);return M}(this.z,this.x,this.y);var m,y,b,C,M;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Jd{constructor(e,i){this.wrap=e,this.canonical=i,this.key=nd(e,i.z,i.z,i.x,i.y)}}class Ls{constructor(e,i,s,h,m){this.overscaledZ=e,this.wrap=i,this.canonical=new td(s,+h,+m),this.key=0===i&&e===s?this.canonical.key:nd(i,e,s,h,m)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Ls(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ls(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return nd(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return nd(this.wrap*+i,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Ls(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,s=2*this.canonical.x,h=2*this.canonical.y;return[new Ls(i,this.wrap,i,s,h),new Ls(i,this.wrap,i,s+1,h),new Ls(i,this.wrap,i,s,h+1),new Ls(i,this.wrap,i,s+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ls(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ls(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Jd(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function nd(t,e,i,s,h){const m=1<<Math.min(i,22);let y=m*(h%m)+s%m;return t&&i<22&&(y+=m*m*((t<0?-2*t-1:2*t)%(1<<2*(22-i)))),16*(32*y+i)+(e-i)}li("CanonicalTileID",td),li("OverscaledTileID",Ls,{omit:["projMatrix"]});class hc{constructor(e,i,s){this.func=e,this.mask=i,this.range=s}}hc.ReadOnly=!1,hc.ReadWrite=!0,hc.disabled=new hc(519,hc.ReadOnly,[0,1]);class Cp{constructor(e,i,s,h,m,y){this.test=e,this.ref=i,this.mask=s,this.fail=h,this.depthFail=m,this.pass=y}}Cp.disabled=new Cp({func:519,mask:0},0,0,7680,7680,7680);class Xa{constructor(e,i,s){this.blendFunction=e,this.blendColor=i,this.mask=s}}Xa.Replace=[1,0],Xa.disabled=new Xa(Xa.Replace,ht.transparent,[!1,!1,!1,!1]),Xa.unblended=new Xa(Xa.Replace,ht.transparent,[!0,!0,!0,!0]),Xa.alphaBlended=new Xa([1,771],ht.transparent,[!0,!0,!0,!0]);class Qa{constructor(e,i,s){this.enable=e,this.mode=i,this.frontFace=s}}Qa.disabled=new Qa(!1,1029,2305),Qa.backCCW=new Qa(!0,1029,2305),Qa.backCW=new Qa(!0,1029,2304),Qa.frontCW=new Qa(!0,1028,2304),Qa.frontCCW=new Qa(!0,1028,2305);class um{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const s=e[i];this._stringToNumber[s]=i,this._numberToString[i]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class Zc{constructor(e,i,s,h,m){this.type="Feature",this._vectorTileFeature=e,e._z=i,e._x=s,e._y=h,this.properties=e.properties,this.id=m}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const i in this)"_geometry"!==i&&"_vectorTileFeature"!==i&&(e[i]=this[i]);return e}}class zg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,s){const h=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},et(this.stateChanges[e][h],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const m in this.state[e])m!==h&&(this.deletedStates[e][m]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][h]){this.deletedStates[e][h]={};for(const m in this.state[e][h])s[m]||(this.deletedStates[e][h][m]=null)}else for(const m in s)this.deletedStates[e]&&this.deletedStates[e][h]&&null===this.deletedStates[e][h][m]&&delete this.deletedStates[e][h][m]}removeFeatureState(e,i,s){if(null===this.deletedStates[e])return;const h=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==i)null!==this.deletedStates[e][h]&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][s]=null);else if(void 0!==i)if(this.stateChanges[e]&&this.stateChanges[e][h])for(s in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][s]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,i){const s=String(i),h=et({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const m=this.deletedStates[e][i];if(null===m)return{};for(const y in m)delete h[y]}return h}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const s={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const m={};for(const y in this.stateChanges[h])this.state[h][y]||(this.state[h][y]={}),et(this.state[h][y],this.stateChanges[h][y]),m[y]=this.state[h][y];s[h]=m}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const m={};if(null===this.deletedStates[h])for(const y in this.state[h])m[y]={},this.state[h][y]={};else for(const y in this.deletedStates[h]){if(null===this.deletedStates[h][y])this.state[h][y]={};else for(const b of Object.keys(this.deletedStates[h][y]))delete this.state[h][y][b];m[y]=this.state[h][y]}s[h]=s[h]||{},et(s[h],m)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const h in e)e[h].setFeatureState(s,i)}}class dm{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const s=this.toIdx(e,i);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function hm(t,e,i,s){let h=0,m=Number.MAX_VALUE;for(let y=0;y<3;y++)if(Math.abs(s[y])<1e-15){if(i[y]<t[y]||i[y]>e[y])return null}else{const b=1/s[y];let C=(t[y]-i[y])*b,M=(e[y]-i[y])*b;if(C>M){const N=C;C=M,M=N}if(C>h&&(h=C),M<m&&(m=M),h>m)return null}return h}function pm(t,e,i,s,h,m,y,b,C,M,N){const j=s-t,H=h-e,pe=m-i,be=y-t,Le=b-e,qe=C-i,it=N[1]*qe-N[2]*Le,yt=N[2]*be-N[0]*qe,Mt=N[0]*Le-N[1]*be,Nt=j*it+H*yt+pe*Mt;if(Math.abs(Nt)<1e-15)return null;const Vt=1/Nt,jt=M[0]-t,wn=M[1]-e,vn=M[2]-i,Xn=(jt*it+wn*yt+vn*Mt)*Vt;if(Xn<0||Xn>1)return null;const Un=wn*pe-vn*H,xn=vn*j-jt*pe,Zn=jt*H-wn*j,ei=(N[0]*Un+N[1]*xn+N[2]*Zn)*Vt;return ei<0||Xn+ei>1?null:(be*Un+Le*xn+qe*Zn)*Vt}function fa(t,e,i){return(t-e)/(i-e)}function Xd(t,e,i,s,h,m,y,b,C){const M=1<<i,N=m-s,j=y-h,H=(t+1)/M*N+s,pe=(e+0)/M*j+h,be=(e+1)/M*j+h;b[0]=(t+0)/M*N+s,b[1]=pe,C[0]=H,C[1]=be}class Ep{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(m){const y=Math.ceil(Math.log2(m.dim/8)),b=[];let C=Math.ceil(Math.pow(2,y));const M=1/C,N=(pe,be,Le,qe,it)=>{const yt=qe?1:0,Mt=(pe+1)*Le-yt,Nt=be*Le,Vt=(be+1)*Le-yt;it[0]=pe*Le,it[1]=Nt,it[2]=Mt,it[3]=Vt};let j=new dm(C);const H=[];for(let pe=0;pe<C*C;pe++){N(pe%C,Math.floor(pe/C),M,!1,H);const be=Gl(H[0],H[1],m),Le=Gl(H[2],H[1],m),qe=Gl(H[2],H[3],m),it=Gl(H[0],H[3],m);j.minimums.push(Math.min(be,Le,qe,it)),j.maximums.push(Math.max(be,Le,qe,it)),j.leaves.push(1)}for(b.push(j),C/=2;C>=1;C/=2){const pe=b[b.length-1];j=new dm(C);for(let be=0;be<C*C;be++){N(be%C,Math.floor(be/C),2,!0,H);const Le=pe.getElevation(H[0],H[1]),qe=pe.getElevation(H[2],H[1]),it=pe.getElevation(H[2],H[3]),yt=pe.getElevation(H[0],H[3]),Mt=pe.isLeaf(H[0],H[1]),Nt=pe.isLeaf(H[2],H[1]),Vt=pe.isLeaf(H[2],H[3]),jt=pe.isLeaf(H[0],H[3]),wn=Math.min(Le.min,qe.min,it.min,yt.min),vn=Math.max(Le.max,qe.max,it.max,yt.max),Xn=Mt&&Nt&&Vt&&jt;j.maximums.push(vn),j.minimums.push(wn),j.leaves.push(vn-wn<=5&&Xn?1:0)}b.push(j)}return b}(this.dem),s=i.length-1,h=i[s];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(i,0,0,s,0)}raycastRoot(e,i,s,h,m,y,b=1){return hm([e,i,-100],[s,h,this.maximums[0]*b],m,y)}raycast(e,i,s,h,m,y,b=1){if(!this.nodeCount)return null;const C=this.raycastRoot(e,i,s,h,m,y,b);if(null==C)return null;const M=[],N=[],j=[],H=[],pe=[{idx:0,t:C,nodex:0,nodey:0,depth:0}];for(;pe.length>0;){const{idx:be,t:Le,nodex:qe,nodey:it,depth:yt}=pe.pop();if(this.leaves[be]){Xd(qe,it,yt,e,i,s,h,j,H);const Nt=1<<yt,Vt=(qe+0)/Nt,jt=(qe+1)/Nt,wn=(it+0)/Nt,vn=(it+1)/Nt,Xn=Gl(Vt,wn,this.dem)*b,Un=Gl(jt,wn,this.dem)*b,xn=Gl(jt,vn,this.dem)*b,Zn=Gl(Vt,vn,this.dem)*b,ei=pm(j[0],j[1],Xn,H[0],j[1],Un,H[0],H[1],xn,m,y),En=pm(H[0],H[1],xn,j[0],H[1],Zn,j[0],j[1],Xn,m,y),ci=Math.min(null!==ei?ei:Number.MAX_VALUE,null!==En?En:Number.MAX_VALUE);if(ci!==Number.MAX_VALUE)return ci;{const yi=gt([],m,y,Le);if(Dp(Xn,Un,Zn,xn,fa(yi[0],j[0],H[0]),fa(yi[1],j[1],H[1]))>=yi[2])return Le}continue}let Mt=0;for(let Nt=0;Nt<this._siblingOffset.length;Nt++){Xd((qe<<1)+this._siblingOffset[Nt][0],(it<<1)+this._siblingOffset[Nt][1],yt+1,e,i,s,h,j,H),j[2]=-100,H[2]=this.maximums[this.childOffsets[be]+Nt]*b;const Vt=hm(j,H,m,y);if(null!=Vt){const jt=Vt;M[Nt]=jt;let wn=!1;for(let vn=0;vn<Mt&&!wn;vn++)jt>=M[N[vn]]&&(N.splice(vn,0,Nt),wn=!0);wn||(N[Mt]=Nt),Mt++}}for(let Nt=0;Nt<Mt;Nt++){const Vt=N[Nt];pe.push({idx:this.childOffsets[be]+Vt,t:M[Vt],nodex:(qe<<1)+this._siblingOffset[Vt][0],nodey:(it<<1)+this._siblingOffset[Vt][1],depth:yt+1})}}return null}_addNode(e,i,s){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,s,h,m){if(1===e[h].isLeaf(i,s))return;this.childOffsets[m]||(this.childOffsets[m]=this.nodeCount);const y=h-1,b=e[y];let C,M=0;for(let N=0;N<this._siblingOffset.length;N++){const j=2*i+this._siblingOffset[N][0],H=2*s+this._siblingOffset[N][1],pe=b.getElevation(j,H),be=b.isLeaf(j,H),Le=this._addNode(pe.min,pe.max,be);be&&(M|=1<<N),C||(C=Le)}for(let N=0;N<this._siblingOffset.length;N++)M&1<<N||this._construct(e,2*i+this._siblingOffset[N][0],2*s+this._siblingOffset[N][1],y,C+N)}}function Dp(t,e,i,s,h,m){return Zr(Zr(t,i,m),Zr(e,s,m),h)}function Gl(t,e,i){const s=i.dim,h=Ri(t*s-.5,0,s-1),m=Ri(e*s-.5,0,s-1),y=Math.floor(h),b=Math.floor(m),C=Math.min(y+1,s-1),M=Math.min(b+1,s-1);return Dp(i.get(y,b),i.get(C,b),i.get(y,M),i.get(C,M),h-y,m-b)}const Ip={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Qd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,s,h=!1,m=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return Li(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const y=this.dim=i.height-2;if(this.data=new Uint32Array(i.data.buffer),this.encoding=s||"mapbox",this.borderReady=h,!h){for(let b=0;b<y;b++)this.data[this._idx(-1,b)]=this.data[this._idx(0,b)],this.data[this._idx(y,b)]=this.data[this._idx(y-1,b)],this.data[this._idx(b,-1)]=this.data[this._idx(b,0)],this.data[this._idx(b,y)]=this.data[this._idx(b,y-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(y,-1)]=this.data[this._idx(y-1,0)],this.data[this._idx(-1,y)]=this.data[this._idx(0,y-1)],this.data[this._idx(y,y)]=this.data[this._idx(y-1,y-1)],m&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Ep(this)}get(e,i,s=!1){const h=new Uint8Array(this.data.buffer);s&&(e=Ri(e,-1,this.dim),i=Ri(i,-1,this.dim));const m=4*this._idx(e,i);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(h[m],h[m+1],h[m+2])}static getUnpackVector(e){return Ip[e]}get unpackVector(){return Ip[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}_unpackMapbox(e,i,s){return(256*e*256+256*i+s)/10-1e4}_unpackTerrarium(e,i,s){return 256*e+i+s/256-32768}static pack(e,i){const s=[0,0,0,0],h=Qd.getUnpackVector(i);let m=Math.floor((e+h[3])/h[2]);return s[2]=m%256,m=Math.floor(m/256),s[1]=m%256,m=Math.floor(m/256),s[0]=m,s}getPixels(){return new Vs({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,i,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=i*this.dim,m=i*this.dim+this.dim,y=s*this.dim,b=s*this.dim+this.dim;switch(i){case-1:h=m-1;break;case 1:m=h+1}switch(s){case-1:y=b-1;break;case 1:b=y+1}const C=-i*this.dim,M=-s*this.dim;for(let N=y;N<b;N++)for(let j=h;j<m;j++)this.data[this._idx(j,N)]=e.data[this._idx(j+C,N+M)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}li("DEMData",Qd),li("DemMinMaxQuadTree",Ep,{omit:["dem"]});class Ug{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,s){const h=e.wrapped().key;void 0===this.data[h]&&(this.data[h]=[]);const m={value:i,timeout:void 0};if(void 0!==s&&(m.timeout=setTimeout(()=>{this.remove(e,m)},s)),this.data[h].push(m),this.order.push(h),this.order.length>this.max){const y=this._getAndRemoveByKey(this.order[0]);y&&this.onRemove(y)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const s=e.wrapped().key,h=void 0===i?0:this.data[s].indexOf(i),m=this.data[s][h];return this.data[s].splice(h,1),m.timeout&&clearTimeout(m.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(m.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const s in this.data)for(const h of this.data[s])e(h.value)||i.push(h);for(const s of i)this.remove(s.value.tileID,s)}}class Vc extends qn{constructor(e,i,s){super(),this.id=e,this._onlySymbols=s,i.on("data",h=>{"source"===h.dataType&&"metadata"===h.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===h.dataType&&"content"===h.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new Ug(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=null,this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new zg}onAdd(e){this.map=e,this._minTileCacheSize=e?e._minTileCacheSize:null,this._maxTileCacheSize=e?e._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const s=this._tiles[i];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return Qt(this._tiles).map(e=>e.tileID).sort(fm).map(e=>e.key)}getRenderableIds(e){const i=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&i.push(this._tiles[s]);return e?i.sort((s,h)=>{const m=s.tileID,y=h.tileID,b=new L(m.canonical.x,m.canonical.y)._rotate(this.transform.angle),C=new L(y.canonical.x,y.canonical.y)._rotate(this.transform.angle);return m.overscaledZ-y.overscaledZ||C.y-b.y||C.x-b.x}).map(s=>s.tileID.key):i.map(s=>s.tileID).sort(fm).map(s=>s.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=i),this._loadTile(s,this._tileLoaded.bind(this,s,e,i)))}_tileLoaded(e,i,s,h){if(h)if(e.state="errored",404!==h.status)this._source.fire(new An(h,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const m=this.map.painter.terrain;this.update(this.transform,m.getScaledDemTileSize(),!0),m.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=ur.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new dn("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let h=0;h<i.length;h++){const m=i[h];if(e.neighboringTiles&&e.neighboringTiles[m]){const y=this.getTileByID(m);s(e,y),s(y,e)}}function s(h,m){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let y=m.tileID.canonical.x-h.tileID.canonical.x;const b=m.tileID.canonical.y-h.tileID.canonical.y,C=Math.pow(2,h.tileID.canonical.z),M=m.tileID.key;0===y&&0===b||Math.abs(b)>1||(Math.abs(y)>1&&(1===Math.abs(y+C)?y+=C:1===Math.abs(y-C)&&(y-=C)),m.dem&&h.dem&&(h.dem.backfillBorder(m.dem,y,b),h.neighboringTiles&&h.neighboringTiles[M]&&(h.neighboringTiles[M].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,s,h){for(const m in this._tiles){let y=this._tiles[m];if(h[m]||!y.hasData()||y.tileID.overscaledZ<=i||y.tileID.overscaledZ>s)continue;let b=y.tileID;for(;y&&y.tileID.overscaledZ>i+1;){const M=y.tileID.scaledTo(y.tileID.overscaledZ-1);y=this._tiles[M.key],y&&y.hasData()&&(b=M)}let C=b;for(;C.overscaledZ>i;)if(C=C.scaledTo(C.overscaledZ-1),e[C.key]){h[b.key]=b;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=i?s:null}for(let s=e.overscaledZ-1;s>=i;s--){const h=e.scaledTo(s),m=this._getLoadedTile(h);if(m)return m}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const s=Math.ceil(e.width/i)+1,h=Math.ceil(e.height/i)+1,m=Math.floor(s*h*5),y="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,m):m,b="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,y):y;this._cache.setMaxSize(b)}handleWrapJump(e){const i=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,i){const s={};for(const h in this._tiles){const m=this._tiles[h];m.tileID=m.tileID.unwrapTo(m.tileID.wrap+i),s[m.tileID.key]=m}this._tiles=s;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,i,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let h;this.updateCacheSize(e,i),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new Ls(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)):(h=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(b=>this._source.hasTile(b)))):h=[];const m=this._updateRetainedTiles(h);if(Ap(this._source.type)&&0!==h.length){const b={},C={},M=Object.keys(m);for(const j of M){const H=m[j],pe=this._tiles[j];if(!pe||pe.fadeEndTime&&pe.fadeEndTime<=ur.now())continue;const be=this.findLoadedParent(H,Math.max(H.overscaledZ-Vc.maxOverzooming,this._source.minzoom));be&&(this._addTile(be.tileID),b[be.tileID.key]=be.tileID),C[j]=H}const N=h[h.length-1].overscaledZ;for(const j in this._tiles){const H=this._tiles[j];if(m[j]||!H.hasData())continue;let pe=H.tileID;for(;pe.overscaledZ>N;){pe=pe.scaledTo(pe.overscaledZ-1);const be=this._tiles[pe.key];if(be&&be.hasData()&&C[pe.key]){m[j]=H.tileID;break}}}for(const j in b)m[j]||(this._coveredTiles[j]=!0,m[j]=b[j])}for(const b in m)this._tiles[b].clearFadeHold();const y=function(b,C){const M=[];for(const N in b)N in C||M.push(N);return M}(this._tiles,m);for(const b of y){const C=this._tiles[b];C.hasSymbolBuckets&&!C.holdingForFade()?C.setHoldDuration(this.map._fadeDuration):C.hasSymbolBuckets&&!C.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(0===e.length)return i;const s={},h=e.reduce((M,N)=>Math.min(M,N.overscaledZ),1/0),m=e[0].overscaledZ,y=Math.max(m-Vc.maxOverzooming,this._source.minzoom),b=Math.max(m+Vc.maxUnderzooming,this._source.minzoom),C={};for(const M of e){const N=this._addTile(M);i[M.key]=M,N.hasData()||h<this._source.maxzoom&&(C[M.key]=M)}this._retainLoadedChildren(C,h,b,i);for(const M of e){let N=this._tiles[M.key];if(N.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const H=M.children(this._source.maxzoom)[0],pe=this.getTile(H);if(pe&&pe.hasData()){i[H.key]=H;continue}}else{const H=M.children(this._source.maxzoom);if(i[H[0].key]&&i[H[1].key]&&i[H[2].key]&&i[H[3].key])continue}let j=N.wasRequested();for(let H=M.overscaledZ-1;H>=y;--H){const pe=M.scaledTo(H);if(s[pe.key]||(s[pe.key]=!0,N=this.getTile(pe),!N&&j&&(N=this._addTile(pe)),N&&(i[pe.key]=pe,j=N.wasRequested(),N.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let s,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){s=this._loadedParentTiles[h.key];break}i.push(h.key);const m=h.scaledTo(h.overscaledZ-1);if(s=this._getLoadedTile(m),s)break;h=m}for(const m of i)this._loadedParentTiles[m]=s}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const s=Boolean(i);if(!s){const h=this.map?this.map.painter:null,m="raster"===this._source.type||"raster-dem"===this._source.type;i=new eh(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,m),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,s||this._source.fire(new dn("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=i.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&"reloading"!==i.state?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset()}tilesIn(e,i,s){const h=[],m=this.transform;if(!m)return h;for(const y in this._tiles){const b=this._tiles[y];if(s&&b.clearQueryDebugViz(),b.holdingForFade())continue;const C=e.containsTile(b,m,i);C&&h.push(C)}return h}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of i)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Ap(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=ur.now())return!0}return!1}setFeatureState(e,i,s){this._state.updateState(e=e||"_geojsonTileLayer",i,s)}removeFeatureState(e,i,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,s)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,s){const h=this._tiles[e];h&&h.setDependencies(i,s)}reloadTilesForDependencies(e,i){for(const s in this._tiles)this._tiles[s].hasDependency(e,i)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,i))}_preloadTiles(e,i){const s=new Map,h=Array.isArray(e)?e:[e],m=this.map.painter.terrain,y=this.usedForTerrain&&m?m.getScaledDemTileSize():this._source.tileSize;for(const M of h){const N=M.coveringTiles({tileSize:y,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const j of N)s.set(j.key,j);this.usedForTerrain&&M.updateElevation(!1)}const b=Array.from(s.values()),C="raster"===this._source.type||"raster-dem"===this._source.type;ki(b,(M,N)=>{const j=new eh(M,this._source.tileSize*M.overscaleFactor(),this.transform.tileZoom,this.map.painter,C);this._loadTile(j,H=>{"raster-dem"===this._source.type&&j.dem&&this._backfillDEM(j),N(H,j)})},i)}}function fm(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||s-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Ap(t){return"raster"===t||"image"===t||"video"===t}Vc.maxOverzooming=10,Vc.maxUnderzooming=3;class Mp{constructor(e,i,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=s}static create(e,i,s){const h=s||e.findDEMTileFor(i);if(!h||!h.dem)return;const m=h.dem,y=h.tileID,b=1<<i.canonical.z-y.canonical.z;return new Mp(h,h.tileSize/yr/b,[(i.canonical.x/b-y.canonical.x)*m.dim,(i.canonical.y/b-y.canonical.y)*m.dim])}tileCoordToPixel(e,i){const s=i*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),m=Math.floor(s);return new L(h,m)}getElevationAt(e,i,s,h){const m=e*this._scale+this._offset[0],y=i*this._scale+this._offset[1],b=Math.floor(m),C=Math.floor(y),M=this._dem;return h=!!h,s?Zr(Zr(M.get(b,C,h),M.get(b,C+1,h),y-C),Zr(M.get(b+1,C,h),M.get(b+1,C+1,h),y-C),m-b):M.get(b,C,h)}getElevationAtPixel(e,i,s){return this._dem.get(e,i,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Wa(1,e)*this._dem.stride}}class Sp{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Kr(yr,16,0),this.featureIndexArray=new df,this.promoteId=i}insert(e,i,s,h,m,y=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,h,m,y);const C=this.grid;for(let M=0;M<i.length;M++){const N=i[M],j=[1/0,1/0,-1/0,-1/0];for(let H=0;H<N.length;H++){const pe=N[H];j[0]=Math.min(j[0],pe.x),j[1]=Math.min(j[1],pe.y),j[2]=Math.max(j[2],pe.x),j[3]=Math.max(j[3],pe.y)}j[0]<yr&&j[1]<yr&&j[2]>=0&&j[3]>=0&&C.insert(b,j[0],j[1],j[2],j[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Nc.VectorTile(new zc(this.rawTileData)).layers,this.sourceLayerCoder=new um(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,s,h){this.loadVTLayers();const m=e.params||{},y=Ua(m.filter),b=e.tileResult,C=e.transform,M=b.bufferedTilespaceBounds,N=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(be,Le,qe,it)=>vf(b.bufferedTilespaceGeometry,be,Le,qe,it));N.sort(Zg);let j=null;C.elevation&&N.length>0&&(j=Mp.create(C.elevation,this.tileID));const H={};let pe;for(let be=0;be<N.length;be++){const Le=N[be];if(Le===pe)continue;pe=Le;const qe=this.featureIndexArray.get(Le);let it=null;this.loadMatchingFeature(H,qe,y,m.layers,m.availableImages,i,s,h,(yt,Mt,Nt,Vt=0)=>(it||(it=zl(yt,this.tileID.canonical,e.tileTransform)),Mt.queryIntersectsFeature(b,yt,Nt,it,this.z,e.transform,e.pixelPosMatrix,j,Vt)))}return H}loadMatchingFeature(e,i,s,h,m,y,b,C,M){const{featureIndex:N,bucketIndex:j,sourceLayerIndex:H,layoutVertexArrayOffset:pe}=i,be=this.bucketLayerIDs[j];if(h&&!function(yt,Mt){for(let Nt=0;Nt<yt.length;Nt++)if(Mt.indexOf(yt[Nt])>=0)return!0;return!1}(h,be))return;const Le=this.sourceLayerCoder.decode(H),qe=this.vtLayers[Le].feature(N);if(s.needGeometry){const yt=Ul(qe,!0);if(!s.filter(new lr(this.tileID.overscaledZ),yt,this.tileID.canonical))return}else if(!s.filter(new lr(this.tileID.overscaledZ),qe))return;const it=this.getId(qe,Le);for(let yt=0;yt<be.length;yt++){const Mt=be[yt];if(h&&h.indexOf(Mt)<0)continue;const Nt=y[Mt];if(!Nt)continue;let Vt={};void 0!==it&&C&&(Vt=C.getState(Nt.sourceLayer||"_geojsonTileLayer",it));const jt=et({},b[Mt]);jt.paint=mm(jt.paint,Nt.paint,qe,Vt,m),jt.layout=mm(jt.layout,Nt.layout,qe,Vt,m);const wn=!M||M(qe,Nt,Vt,pe);if(!wn)continue;const vn=new Zc(qe,this.z,this.x,this.y,it);vn.layer=jt;let Xn=e[Mt];void 0===Xn&&(Xn=e[Mt]=[]),Xn.push({featureIndex:N,feature:vn,intersectionZ:wn})}}lookupSymbolFeatures(e,i,s,h,m,y,b,C){const M={};this.loadVTLayers();const N=Ua(m);for(const j of e)this.loadMatchingFeature(M,{bucketIndex:s,sourceLayerIndex:h,featureIndex:j,layoutVertexArrayOffset:0},N,y,b,C,i);return M}loadFeature(e){const{featureIndex:i,sourceLayerIndex:s}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(s),m=this.vtFeatures[h];if(m[i])return m[i];const y=this.vtLayers[h].feature(i);return m[i]=y,y}hasLayer(e){for(const i of this.bucketLayerIDs)for(const s of i)if(e===s)return!0;return!1}getId(e,i){let s=e.id;return this.promoteId&&(s=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[i]],"boolean"==typeof s&&(s=Number(s))),s}}function mm(t,e,i,s,h){return Ut(t,(m,y)=>{const b=e instanceof Ea?e.get(y):null;return b&&b.evaluate?b.evaluate(i,s,h):b})}function Zg(t,e){return e-t}li("FeatureIndex",Sp,{omit:["rawTileData","sourceLayerCoder"]});var X_=Bo([{name:"a_pos",type:"Int16",components:2}]);const fc=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,i=0,s=0,h=0,m=0,y=0,b=0;for(1&e?h=m=y=32:i=s=b=32;(e>>=1)>1;){const M=i+h>>1,N=s+m>>1;1&e?(h=i,m=s,i=y,s=b):(i=h,s=m,h=y,m=b),y=M,b=N}const C=4*t;fc[C+0]=i,fc[C+1]=s,fc[C+2]=h,fc[C+3]=m}const tl=new Uint16Array(2178),ql=new Uint8Array(1089),Pp=new Uint16Array(1089);function Sa(t){return 0===t?-.03125:32===t?.03125:0}var gm=Bo([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Vg={type:2,extent:yr,loadGeometry:()=>[[new L(0,0),new L(8193,0),new L(8193,8193),new L(0,8193),new L(0,0)]]};class eh{constructor(e,i,s,h,m){this.tileID=e,this.uid=Pe(),this.uses=0,this.tileSize=i,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=m,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<ur.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=xu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,m){const y={};if(!m)return y;for(const b of h){const C=b.layerIds.map(M=>m.getLayer(M)).filter(Boolean);if(0!==C.length){b.layers=C,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(M=>C.filter(N=>N.id===M)[0]));for(const M of C)y[M.id]=b}}return y}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const m=this.buckets[h];if(m instanceof wl){if(this.hasSymbolBuckets=!0,!s)break;m.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const m=this.buckets[h];if(m instanceof wl&&m.hasRTLText){this.hasRTLText=!0,$r.isLoading()||$r.isLoaded()||"deferred"!==xs()||ua();break}}this.queryPadding=0;for(const h in this.buckets){const m=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(h).queryRadius(m))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new sf}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugIndexBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this.globeGridBuffer&&(this.globeGridBuffer.destroy(),this.globeGridBuffer=null),this.globePoleBuffer&&(this.globePoleBuffer.destroy(),this.globePoleBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const h=this.buckets[s];h.uploadPending()&&h.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new bp(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new bp(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new bp(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,s,h,m,y,b,C){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:b,transform:y,params:m,tileTransform:this.tileTransform},e,i,s):{}}querySourceFeatures(e,i){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const h=s.loadVTLayers(),m=i?i.sourceLayer:"",y=h._geojsonTileLayer||h[m];if(!y)return;const b=Ua(i&&i.filter),{z:C,x:M,y:N}=this.tileID.canonical,j={z:C,x:M,y:N};for(let H=0;H<y.length;H++){const pe=y.feature(H);if(b.needGeometry){const qe=Ul(pe,!0);if(!b.filter(new lr(this.tileID.overscaledZ),qe,this.tileID.canonical))continue}else if(!b.filter(new lr(this.tileID.overscaledZ),pe))continue;const be=s.getId(pe,m),Le=new Zc(pe,C,M,N,be);Le.tile=j,e.push(Le)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const s=ji(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let h=!1;if(this.expirationTime>s)h=!1;else if(i)if(this.expirationTime<i)h=!0;else{const m=this.expirationTime-i;m?this.expirationTime=s+Math.max(m,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!i)return;const s=this.latestFeatureIndex.loadVTLayers(),h=i.style.listImages();for(const m in this.buckets){if(!i.style.hasLayer(m))continue;const y=this.buckets[m],b=y.layers[0].sourceLayer||"_geojsonTileLayer",C=s[b],M=e[b];if(!C||!M||0===Object.keys(M).length)continue;if(y.update(M,C,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),y instanceof uu||y instanceof Pd){const j=i.style._getSourceCache(y.layers[0].source);i._terrain&&i._terrain.enabled&&j&&y.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(j.id,this.tileID)}const N=i&&i.style&&i.style.getLayer(m);N&&(this.queryPadding=Math.max(this.queryPadding,N.queryRadius(y)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<ur.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=ur.now()+e}setDependencies(e,i){const s={};for(const h of i)s[h]=!0;this.dependencies[e]=s}hasDependency(e,i){for(const s of e){const h=this.dependencies[s];if(h)for(const m of i)if(h[m])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||"mercator"===i.name||this._tileDebugBuffer)return;const s=zl(Vg,this.tileID.canonical,this.tileTransform)[0],h=new Xc,m=new fd;for(let y=0;y<s.length;y++){const{x:b,y:C}=s[y];h.emplaceBack(b,C),m.emplaceBack(y)}m.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(m),this._tileDebugBuffer=e.createVertexBuffer(h,gm.members),this._tileDebugSegments=Jo.simpleSegment(0,0,h.length,m.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||"mercator"===i.name)return;const s=zl(Vg,this.tileID.canonical,this.tileTransform)[0];let h,m;if(this.isRaster){const y=function(b,C){const M=xu(b,C),N=Math.pow(2,b.z);for(let qe=0;qe<33;qe++)for(let it=0;it<33;it++){const yt=Nl((b.x+(it+Sa(it))/32)/N),Mt=ha((b.y+(qe+Sa(qe))/32)/N),Nt=C.project(yt,Mt),Vt=33*qe+it;tl[2*Vt+0]=Math.round((Nt.x*M.scale-M.x)*yr),tl[2*Vt+1]=Math.round((Nt.y*M.scale-M.y)*yr)}ql.fill(0),Pp.fill(0);for(let qe=2045;qe>=0;qe--){const it=4*qe,yt=fc[it+0],Mt=fc[it+1],Nt=fc[it+2],Vt=fc[it+3],jt=yt+Nt>>1,wn=Mt+Vt>>1,vn=jt+wn-Mt,Xn=wn+yt-jt,Un=33*Mt+yt,xn=33*Vt+Nt,Zn=33*wn+jt,ei=Math.hypot((tl[2*Un+0]+tl[2*xn+0])/2-tl[2*Zn+0],(tl[2*Un+1]+tl[2*xn+1])/2-tl[2*Zn+1])>=16;if(ql[Zn]=ql[Zn]||(ei?1:0),qe<1022){const En=33*(Mt+Xn>>1)+(yt+vn>>1),ci=33*(Vt+Xn>>1)+(Nt+vn>>1);ql[Zn]=ql[Zn]||ql[En]||ql[ci]}}const j=new Ll,H=new Qs;let pe=0;function be(qe,it){const yt=33*it+qe;return 0===Pp[yt]&&(j.emplaceBack(tl[2*yt+0],tl[2*yt+1],qe*yr/32,it*yr/32),Pp[yt]=++pe),Pp[yt]-1}function Le(qe,it,yt,Mt,Nt,Vt){const jt=qe+yt>>1,wn=it+Mt>>1;if(Math.abs(qe-Nt)+Math.abs(it-Vt)>1&&ql[33*wn+jt])Le(Nt,Vt,qe,it,jt,wn),Le(yt,Mt,Nt,Vt,jt,wn);else{const vn=be(qe,it),Xn=be(yt,Mt),Un=be(Nt,Vt);H.emplaceBack(vn,Xn,Un)}}return Le(0,0,32,32,32,0),Le(32,32,0,0,0,32),{vertices:j,indices:H}}(this.tileID.canonical,i);h=y.vertices,m=y.indices}else{h=new Ll,m=new Qs;for(const{x:b,y:C}of s)h.emplaceBack(b,C,0,0);const y=Ed(h.int16,void 0,4);for(let b=0;b<y.length;b+=3)m.emplaceBack(y[b],y[b+1],y[b+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,gm.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(m),this._tileBoundsSegments=Jo.simpleSegment(0,0,h.length,m.length)}}const _m=Bo([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_merc_pos",components:2},{type:"Float32",name:"a_uv",components:2}]),ym=Bo([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:vm}=_m;function vu(t,e){const i=t.fovAboveCenter,s=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,h=(t._camera.position[2]*t.worldSize-s)/Math.cos(t._pitch),m=Math.sin(i)*h/Math.sin(Math.max(Math.PI/2-t._pitch-i,.01)),y=Math.sin(t._pitch)*m+h;return Math.min(1.01*y,h*(1/t._horizonShift))}const th=yr/Math.PI/2,Fs=-th,ta=th,kp=[new Ia([Fs,Fs,Fs],[ta,ta,ta]),new Ia([Fs,Fs,Fs],[0,0,ta]),new Ia([0,Fs,Fs],[ta,0,ta]),new Ia([Fs,0,Fs],[0,ta,ta]),new Ia([0,0,Fs],[ta,ta,ta])];function nh(t){if(t.z<=1)return kp[t.z+2*t.y+t.x];const[e,i]=xm(t),s=[ih(e[0],e[1]),ih(e[0],i[1]),ih(i[0],e[1]),ih(i[0],i[1])],h=[ta,ta,ta],m=[Fs,Fs,Fs];for(const y of s)h[0]=Math.min(h[0],y[0]),h[1]=Math.min(h[1],y[1]),h[2]=Math.min(h[2],y[2]),m[0]=Math.max(m[0],y[0]),m[1]=Math.max(m[1],y[1]),m[2]=Math.max(m[2],y[2]);return new Ia(h,m)}function xm(t){const e=Math.pow(2,t.z),i=t.x/e,s=(t.x+1)/e,h=(t.y+1)/e;return[[ha(t.y/e),Nl(i)],[ha(h),Nl(s)]]}function Op(t,e,i,s){return i=In(i),s||(s=th),[t*Math.sin(i)*s,-e*s,t*Math.cos(i)*s]}function ih(t,e,i){return Op(Math.cos(In(t)),Math.sin(In(t)),e,i)}function bm(t){return 16383/Math.max(...Jt([],t.max,t.min))}function wm(t){const e=ye(new Float64Array(16)),i=1/bm(t);return Ee(e,e,t.min),je(e,e,[i,i,i]),e}function id(t,e,i){const s=e/(2*Math.PI),h=function(y){const b=yr/(2*Math.PI);return y/(2*Math.PI)/b}(e);if(!i){const y=Ri(t.center.lat,-85.051129,Ya);i=[gl(t.center.lng)*e,sc(y)*e]}const m=ye(new Float64Array(16));return Ee(m,m,[i[0],i[1],-s]),je(m,m,[h,h,h]),rt(m,m,In(-t._center.lat)),Ae(m,m,In(-t._center.lng)),m}class mc{constructor(e){const i=this._createGridIndices();this.gridIndexBuffer=e.createIndexBuffer(i,!0),this.gridSegments=Jo.simpleSegment(0,0,4225,8192);const s=this._createPoleTriangleIndices();this.poleIndexBuffer=e.createIndexBuffer(s,!0),this.poleSegments=Jo.simpleSegment(0,0,66,64);const h=new Ru;h.emplaceBack(-1,1,1,0,0,0,0),h.emplaceBack(1,1,1,0,0,1,0),h.emplaceBack(1,-1,1,0,0,1,1),h.emplaceBack(-1,-1,1,0,0,0,1);const m=new Qs;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.atmosphereVertexBuffer=e.createVertexBuffer(h,ym.members),this.atmosphereIndexBuffer=e.createIndexBuffer(m),this.atmosphereSegments=Jo.simpleSegment(0,0,4,2)}destroy(){this.poleIndexBuffer.destroy(),this.gridIndexBuffer.destroy(),this.poleSegments.destroy(),this.gridSegments.destroy(),this.atmosphereVertexBuffer.destroy(),this.atmosphereIndexBuffer.destroy(),this.atmosphereSegments.destroy(),this.wireframeIndexBuffer&&(this.wireframeIndexBuffer.destroy(),this.wireframeSegments.destroy())}static createPoleTriangleVertices(e,i,s){const h=new Ru,m=i/Math.PI/2;h.emplaceBack(0,-m,0,0,0,.5,s?0:1);const y=360/e,b=Math.cos(In(85)),C=Math.sin(In(85));for(let N=0;N<=64;N++){const j=N/64,H=Op(b,C,0*(1-(M=j))+y*M,m);h.emplaceBack(H[0],H[1],H[2],0,0,j,s?0:1)}var M;return h}_createPoleTriangleIndices(){const e=new Qs;for(let i=0;i<=64;i++)e.emplaceBack(0,i+1,i+2);return e}static createGridVertices(e){const i=Math.pow(2,e.z),s=(C,M,N)=>C*(1-N)+M*N,[h,m]=xm(e),y=new Ru,b=function(C){const M=ye(new Float64Array(16)),N=bm(C);var j,H;return je(M,M,[N,N,N]),Ee(M,M,((j=[])[0]=-(H=C.min)[0],j[1]=-H[1],j[2]=-H[2],j)),M}(nh(e));y.reserve(4096);for(let C=0;C<65;C++){const M=s(h[0],m[0],C/64),N=sc(M),j=N*i-e.y,H=Math.sin(In(M)),pe=Math.cos(In(M));for(let be=0;be<65;be++){const Le=be/64,qe=s(h[1],m[1],Le),it=Op(pe,H,qe);Ft(it,it,b);const yt=gl(qe);y.emplaceBack(it[0],it[1],it[2],yt,N,Le,j)}}return y}_createGridIndices(){const e=new Qs,i=(s,h)=>{const m=65*h+s;e.emplaceBack(m+1,m,m+65),e.emplaceBack(m+65,m+65+1,m+1)};for(let s=0;s<64;s++)for(let h=0;h<64;h++)i(h,s);return e}getWirefameBuffer(e){if(!this.wireframeSegments){const i=this._createWireframeGrid();this.wireframeIndexBuffer=e.createIndexBuffer(i),this.wireframeSegments=Jo.simpleSegment(0,0,4096,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}_createWireframeGrid(){const e=new Da,i=(s,h)=>{const m=65*h+s;e.emplaceBack(m,m+1),e.emplaceBack(m,m+65),e.emplaceBack(m,m+65+1)};for(let s=0;s<64;s++)for(let h=0;h<64;h++)i(h,s);return e}}function xu(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const i=Math.pow(2,-t.z),s=t.x*i,h=(t.x+1)*i,m=t.y*i,y=(t.y+1)*i,b=Nl(s),C=Nl(h),M=ha(m),N=ha(y),j=e.project(b,M),H=e.project(C,M),pe=e.project(C,N),be=e.project(b,N);let Le=Math.min(j.x,H.x,pe.x,be.x),qe=Math.min(j.y,H.y,pe.y,be.y),it=Math.max(j.x,H.x,pe.x,be.x),yt=Math.max(j.y,H.y,pe.y,be.y);const Mt=i/16;function Nt(jt,wn,vn,Xn,Un,xn){const Zn=(vn+Un)/2,ei=(Xn+xn)/2,En=e.project(Nl(Zn),ha(ei)),ci=Math.max(0,Le-En.x,qe-En.y,En.x-it,En.y-yt);Le=Math.min(Le,En.x),it=Math.max(it,En.x),qe=Math.min(qe,En.y),yt=Math.max(yt,En.y),ci>Mt&&(Nt(jt,En,vn,Xn,Zn,ei),Nt(En,wn,Zn,ei,Un,xn))}Nt(j,H,s,m,h,m),Nt(H,pe,h,m,h,y),Nt(pe,be,h,y,s,y),Nt(be,j,s,y,s,m),Le-=Mt,qe-=Mt,it+=Mt,yt+=Mt;const Vt=1/Math.max(it-Le,yt-qe);return{scale:Vt,x:Le*Vt,y:qe*Vt,x2:it*Vt,y2:yt*Vt,projection:e}}class bu{constructor(e){const i={},s=[];for(const b in e){const C=e[b],M=i[b]={};for(const N in C.glyphs){const j=C.glyphs[+N];if(!j||0===j.bitmap.width||0===j.bitmap.height)continue;const H=j.metrics.localGlyph?2:1,pe={x:0,y:0,w:j.bitmap.width+2*H,h:j.bitmap.height+2*H};s.push(pe),M[N]=pe}}const{w:h,h:m}=ap(s),y=new vl({width:h||1,height:m||1});for(const b in e){const C=e[b];for(const M in C.glyphs){const N=C.glyphs[+M];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const j=i[b][M],H=N.metrics.localGlyph?2:1;vl.copy(N.bitmap,y,{x:0,y:0},{x:j.x+H,y:j.y+H},N.bitmap)}}this.image=y,this.positions=i}}li("GlyphAtlas",bu);class $g{constructor(e){this.tileID=new Ls(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=xu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,s,h,m){this.status="parsing",this.data=e,this.collisionBoxArray=new sf;const y=new um(Object.keys(e.layers).sort()),b=new Sp(this.tileID,this.promoteId);b.bucketLayerIDs=[];const C={},M=new ed(256,256),N={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:s},j=i.familiesBySource[this.source];for(const Vt in j){const jt=e.layers[Vt];if(!jt)continue;let wn=!1,vn=!1;for(const xn of j[Vt])"symbol"===xn[0].type?wn=!0:vn=!0;if(!0===this.isSymbolTile&&!wn||!1===this.isSymbolTile&&!vn)continue;1===jt.version&&Li(`Vector tile source "${this.source}" layer "${Vt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xn=y.encode(Vt),Un=[];for(let xn=0;xn<jt.length;xn++){const Zn=jt.feature(xn),ei=b.getId(Zn,Vt);Un.push({feature:Zn,id:ei,index:xn,sourceLayerIndex:Xn})}for(const xn of j[Vt]){const Zn=xn[0];void 0!==this.isSymbolTile&&"symbol"===Zn.type!==this.isSymbolTile||Zn.minzoom&&this.zoom<Math.floor(Zn.minzoom)||Zn.maxzoom&&this.zoom>=Zn.maxzoom||"none"!==Zn.visibility&&(Rp(xn,this.zoom,s),(C[Zn.id]=Zn.createBucket({index:b.bucketLayerIDs.length,layers:xn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xn,sourceID:this.source,enableTerrain:this.enableTerrain,availableImages:s})).populate(Un,N,this.tileID.canonical,this.tileTransform),b.bucketLayerIDs.push(xn.map(ei=>ei.id)))}}let H,pe,be,Le;M.trim();const qe={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},it=Ut(N.glyphDependencies,Vt=>Object.keys(Vt).map(Number));Object.keys(it).length?h.send("getGlyphs",{uid:this.uid,stacks:it},(Vt,jt)=>{H||(H=Vt,pe=jt,Nt.call(this))},void 0,!1,qe):pe={};const yt=Object.keys(N.iconDependencies);yt.length?h.send("getImages",{icons:yt,source:this.source,tileID:this.tileID,type:"icons"},(Vt,jt)=>{H||(H=Vt,be=jt,Nt.call(this))},void 0,!1,qe):be={};const Mt=Object.keys(N.patternDependencies);function Nt(){if(H)return m(H);if(pe&&be&&Le){const Vt=new bu(pe),jt=new Hf(be,Le);for(const wn in C){const vn=C[wn];vn instanceof wl?(Rp(vn.layers,this.zoom,s),bl(vn,pe,Vt.positions,be,jt.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection),vn.projection=this.projection.name):vn.hasPattern&&(vn instanceof uu||vn instanceof Pd||vn instanceof Yh)&&(Rp(vn.layers,this.zoom,s),vn.addFeatures(N,this.tileID.canonical,jt.patternPositions,s))}this.status="done",m(null,{buckets:Qt(C).filter(wn=>!wn.isEmpty()),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Vt.image,lineAtlas:M,imageAtlas:jt,glyphMap:this.returnDependencies?pe:null,iconMap:this.returnDependencies?be:null,glyphPositions:this.returnDependencies?Vt.positions:null})}}Mt.length?h.send("getImages",{icons:Mt,source:this.source,tileID:this.tileID,type:"patterns"},(Vt,jt)=>{H||(H=Vt,Le=jt,Nt.call(this))},void 0,!1,qe):Le={},Nt.call(this)}}function Rp(t,e,i){const s=new lr(e);for(const h of t)h.recalculate(s,i)}class rh{constructor(e){this.entries={},this.scheduler=e}request(e,i,s,h){const m=this.entries[e]=this.entries[e]||{callbacks:[]};if(m.result){const[y,b]=m.result;return this.scheduler?this.scheduler.add(()=>{h(y,b)},i):h(y,b),()=>{}}return m.callbacks.push(h),m.cancel||(m.cancel=s((y,b)=>{m.result=[y,b];for(const C of m.callbacks)this.scheduler?this.scheduler.add(()=>{C(y,b)},i):C(y,b);setTimeout(()=>delete this.entries[e],3e3)})),()=>{m.result||(m.callbacks=m.callbacks.filter(y=>y!==h),m.callbacks.length||(m.cancel(),delete this.entries[e]))}}}function nl(t,e,i){const s=JSON.stringify(t.request);return t.data&&(this.deduped.entries[s]={result:[null,t.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},h=>{const m=Sr(t.request,(y,b,C,M)=>{y?h(y):b&&h(null,{vectorTile:i?void 0:new Nc.VectorTile(new zc(b)),rawData:b,cacheControl:C,expires:M})});return()=>{m.cancel(),h()}},e)}const rd=ye(new Float64Array(16));class Ko{constructor(e,i){this._tr=e,this._worldSize=i}createInversionMatrix(){return rd}createTileMatrix(e){let i,s,h;const m=e.canonical,y=ye(new Float64Array(16)),b=this._tr.projection;if(b.isReprojectedInTileSpace){const C=xu(m,b);i=1,s=C.x+e.wrap*C.scale,h=C.y,je(y,y,[i/C.scale,i/C.scale,this._tr.pixelsPerMeter/this._worldSize])}else i=this._worldSize/this._tr.zoomScale(m.z),s=(m.x+Math.pow(2,m.z)*e.wrap)*i,h=m.y*i;return Ee(y,y,[s,h,0]),je(y,y,[i/yr,i/yr,1]),y}pointCoordinate(e,i,s){const h=this._tr.horizonLineFromTop(!1),m=new L(e,Math.max(h,i));return this._tr.rayIntersectionCoordinate(this._tr.pointRayIntersection(m,s))}upVector(){return[0,0,1]}upVectorScale(){return 1}}var $c={name:"albers",range:[4,7],center:[-96,37.5],parallels:[29.5,45.5],zAxisUnit:"meters",conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&Et(this.parallels,this.constants.parallels))return;const t=Math.sin(In(this.parallels[0])),e=(t+Math.sin(In(this.parallels[1])))/2,i=1+t*(2*e-t),s=Math.sqrt(i)/e;this.constants={n:e,c:i,r0:s,parallels:this.parallels}},project(t,e){this.initializeConstants();const i=In(t-this.center[0]),s=In(e),{n:h,c:m,r0:y}=this.constants,b=Math.sqrt(m-2*h*Math.sin(s))/h;return{x:b*Math.sin(i*h),y:b*Math.cos(i*h)-y,z:0}},unproject(t,e){this.initializeConstants();const{n:i,c:s,r0:h}=this.constants,m=h+e;let y=Math.atan2(t,Math.abs(m))*Math.sign(m);m*i<0&&(y-=Math.PI*Math.sign(t)*Math.sign(m));const b=In(this.center[0])*i;y=Si(y,-Math.PI-b,Math.PI-b);const C=ti(y/i)+this.center[0],M=Math.asin(Ri((s-(t*t+m*m)*i*i)/(2*i),-1,1)),N=Ri(ti(M),-85.051129,Ya);return new _o(C,N)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>Wa(1,t)*e,farthestPixelDistance(t){return vu(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Ko(t,e)};const gc=1.340264,Bs=-.081106,jc=893e-6,Cl=.003796,Hl=Math.sqrt(3)/2;var wu={name:"equalEarth",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(t,e){e=e/180*Math.PI,t=t/180*Math.PI;const i=Math.asin(Hl*Math.sin(e)),s=i*i,h=s*s*s;return{x:.5*(t*Math.cos(i)/(Hl*(gc+3*Bs*s+h*(7*jc+9*Cl*s)))/Math.PI+.5),y:1-.5*(i*(gc+Bs*s+h*(jc+Cl*s))/Math.PI+1),z:0}},unproject(t,e){t=(2*t-.5)*Math.PI;let i=e=(2*(1-e)-1)*Math.PI,s=i*i,h=s*s*s;for(let M,N,j,H=0;H<12&&(N=i*(gc+Bs*s+h*(jc+Cl*s))-e,j=gc+3*Bs*s+h*(7*jc+9*Cl*s),M=N/j,i=Ri(i-M,-Math.PI/3,Math.PI/3),s=i*i,h=s*s*s,!(Math.abs(M)<1e-12));++H);const m=Hl*t*(gc+3*Bs*s+h*(7*jc+9*Cl*s))/Math.cos(i),y=Math.asin(Math.sin(i)/Hl),b=Ri(180*m/Math.PI,-180,180),C=Ri(180*y/Math.PI,-85.051129,Ya);return new _o(b,C)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>Wa(1,t)*e,farthestPixelDistance(t){return vu(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Ko(t,e)},Tu={name:"equirectangular",supportsWorldCopies:!0,center:[0,0],range:[3.5,7],zAxisUnit:"meters",wrap:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project:(t,e)=>({x:.5+t/360,y:.5-e/360,z:0}),unproject(t,e){const i=360*(t-.5),s=Ri(360*(.5-e),-85.051129,Ya);return new _o(i,s)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>Wa(1,t)*e,farthestPixelDistance(t){return vu(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Ko(t,e)};const il=Math.PI/2;function Wl(t){return Math.tan((il+t)/2)}var Cu={name:"lambertConformalConic",range:[3.5,7],zAxisUnit:"meters",center:[0,30],parallels:[30,30],conic:!0,isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],initializeConstants(){if(this.constants&&Et(this.parallels,this.constants.parallels))return;const t=In(this.parallels[0]),e=In(this.parallels[1]),i=Math.cos(t),s=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(Wl(e)/Wl(t)),h=i*Math.pow(Wl(t),s)/s;this.constants={n:s,f:h,parallels:this.parallels}},project(t,e){this.initializeConstants(),e=In(e),t=In(t-this.center[0]);const i=1e-6,{n:s,f:h}=this.constants;h>0?e<-il+i&&(e=-il+i):e>il-i&&(e=il-i);const m=h/Math.pow(Wl(e),s),y=m*Math.sin(s*t),b=h-m*Math.cos(s*t);return{x:.5*(y/Math.PI+.5),y:1-.5*(b/Math.PI+.5),z:0}},unproject(t,e){this.initializeConstants(),t=(2*t-.5)*Math.PI,e=(2*(1-e)-.5)*Math.PI;const{n:i,f:s}=this.constants,h=s-e,m=Math.sign(h),y=Math.sign(i)*Math.sqrt(t*t+h*h);let b=Math.atan2(t,Math.abs(h))*m;h*i<0&&(b-=Math.PI*Math.sign(t)*m);const C=Ri(ti(b/i)+this.center[0],-180,180),M=Ri(ti(2*Math.atan(Math.pow(s/y,1/i))-il),-85.051129,Ya);return new _o(C,M)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>Wa(1,t)*e,farthestPixelDistance(t){return vu(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Ko(t,e)},Eu={name:"mercator",wrap:!0,requiresDraping:!1,supportsWorldCopies:!0,supportsTerrain:!0,supportsFog:!0,supportsFreeCamera:!0,zAxisUnit:"meters",center:[0,0],project:(t,e)=>({x:gl(t),y:sc(e),z:0}),unproject(t,e){const i=Nl(t),s=ha(e);return new _o(i,s)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>Wa(1,t)*e,farthestPixelDistance(t){return vu(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Ko(t,e)};const Gc=In(Ya);var Tm={name:"naturalEarth",center:[0,0],range:[3.5,7],isReprojectedInTileSpace:!0,zAxisUnit:"meters",unsupportedLayers:["custom"],project(t,e){const i=(e=In(e))*e,s=i*i;return{x:.5*((t=In(t))*(.8707-.131979*i+s*(s*(.003971*i-.001529*s)-.013791))/Math.PI+.5),y:1-.5*(e*(1.007226+i*(.015085+s*(.028874*i-.044475-.005916*s)))/Math.PI+1),z:0}},unproject(t,e){t=(2*t-.5)*Math.PI;let i=e=(2*(1-e)-1)*Math.PI,s=25,h=0,m=i*i;do{m=i*i;const C=m*m;h=(i*(1.007226+m*(.015085+C*(.028874*m-.044475-.005916*C)))-e)/(1.007226+m*(.045255+C*(.259866*m-.311325-.005916*11*C))),i=Ri(i-h,-Gc,Gc)}while(Math.abs(h)>1e-6&&--s>0);m=i*i;const y=Ri(ti(t/(.8707+m*(m*(m*m*m*(.003971-.001529*m)-.013791)-.131979))),-180,180),b=ti(i);return new _o(y,b)},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>Wa(1,t)*e,farthestPixelDistance(t){return vu(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Ko(t,e)};const Lp=In(Ya),Fp={albers:$c,equalEarth:wu,equirectangular:Tu,lambertConformalConic:Cu,mercator:Eu,naturalEarth:Tm,winkelTripel:{name:"winkelTripel",center:[0,0],range:[3.5,7],zAxisUnit:"meters",isReprojectedInTileSpace:!0,unsupportedLayers:["custom"],project(t,e){e=In(e),t=In(t);const i=Math.cos(e),s=2/Math.PI,h=Math.acos(i*Math.cos(t/2)),m=Math.sin(h)/h,y=.5*(t*s+2*i*Math.sin(t/2)/m)||0,b=.5*(e+Math.sin(e)/m)||0;return{x:.5*(y/Math.PI+.5),y:1-.5*(b/Math.PI+1),z:0}},unproject(t,e){let i=t=(2*t-.5)*Math.PI,s=e=(2*(1-e)-1)*Math.PI,h=25;const m=1e-6;let y=0,b=0;do{const C=Math.cos(s),M=Math.sin(s),N=2*M*C,j=M*M,H=C*C,pe=Math.cos(i/2),be=Math.sin(i/2),Le=2*pe*be,qe=be*be,it=1-H*pe*pe,yt=it?1/it:0,Mt=it?Math.acos(C*pe)*Math.sqrt(1/it):0,Nt=.5*(2*Mt*C*be+2*i/Math.PI)-t,Vt=.5*(Mt*M+s)-e,jt=.5*yt*(H*qe+Mt*C*pe*j)+1/Math.PI,wn=yt*(Le*N/4-Mt*M*be),vn=.125*yt*(N*be-Mt*M*H*Le),Xn=.5*yt*(j*pe+Mt*qe*C)+.5,Un=wn*vn-Xn*jt;y=(Vt*wn-Nt*Xn)/Un,b=(Nt*vn-Vt*jt)/Un,i=Ri(i-y,-Math.PI,Math.PI),s=Ri(s-b,-Lp,Lp)}while((Math.abs(y)>m||Math.abs(b)>m)&&--h>0);return new _o(ti(i),ti(s))},projectTilePoint:(t,e)=>({x:t,y:e,z:0}),locationPoint:(t,e)=>t._coordinatePoint(t.locationCoordinate(e),!1),pixelsPerMeter:(t,e)=>Wa(1,t)*e,farthestPixelDistance(t){return vu(t,this.pixelsPerMeter(t.center.lat,t.worldSize))},createTileTransform:(t,e)=>new Ko(t,e)}};a.ARRAY_TYPE=G,a.AUTH_ERR_MSG=Zt,a.Aabb=Ia,a.Actor=class{constructor(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},xe(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=vr()?t:Z,this.scheduler=new Ng}send(t,e,i,s,h=!1,m){const y=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=m,this.callbacks[y]=i);const b=zr(this.globalScope)?void 0:[];return this.target.postMessage({id:y,type:t,hasCallback:!!i,targetMapId:s,mustQueue:h,sourceMapId:this.mapId,data:ja(e,b)},b),{cancel:()=>{i&&delete this.callbacks[y],this.target.postMessage({id:y,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(t){const e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[i];delete this.cancelCallbacks[i],s&&s.cancel()}else if(e.mustQueue||vr()){const s=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),s&&s.metadata||{type:"message"})}else this.processTask(i,e)}processTask(t,e){if("<response>"===e.type){const i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(Rl(e.error)):i(null,Rl(e.data)))}else{const i=zr(this.globalScope)?void 0:[],s=e.hasCallback?(m,y)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:m?ja(m):null,data:ja(y,i)},i)}:m=>{},h=Rl(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,s);else if(this.parent.getWorkerSource){const m=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,m[0],h.source)[m[1]](h,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=td,a.Color=ht,a.ColorMode=Xa,a.CullFaceMode=Qa,a.DEMData=Qd,a.DataConstantProperty=_i,a.DedupedRequest=rh,a.DepthMode=hc,a.EXTENT=yr,a.Elevation=class{getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,i=!0){null==e&&(e=null);const s=this._source();if(!s||t.y<0||t.y>1)return e;const h=s.getSource().maxzoom,m=1<<h,y=Math.floor(t.x),b=t.x-y,C=new Ls(h,y,h,Math.floor(b*m),Math.floor(t.y*m)),M=this.findDEMTileFor(C);if(!M||!M.dem)return e;const N=M.dem,j=1<<M.tileID.canonical.z,H=(b*j-M.tileID.canonical.x)*N.dim,pe=(t.y*j-M.tileID.canonical.y)*N.dim,be=Math.floor(H),Le=Math.floor(pe);return(i?this.exaggeration():1)*Zr(Zr(N.get(be,Le),N.get(be,Le+1),pe-Le),Zr(N.get(be+1,Le),N.get(be+1,Le+1),pe-Le),H-be)}getAtTileOffset(t,e,i){const s=1<<t.canonical.z;return this.getAtPointOrZero(new _d(t.wrap+(t.canonical.x+e/yr)/s,(t.canonical.y+i/yr)/s))}getAtTileOffsetFunc(t,e){return i=>{const s=this.getAtTileOffset(t,i.x,i.y),h=e.upVector(t.canonical,i.x,i.y);return Ct(h,h,s*e.upVectorScale(t.canonical)),h}}getForTilePoints(t,e,i,s){const h=Mp.create(this,t,s);return!!h&&(e.forEach(m=>{m[2]=this.exaggeration()*h.getElevationAt(m[0],m[1],i)}),!0)}getMinMaxForTile(t){const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const i=e.dem.tree,s=e.tileID,h=1<<t.canonical.z-s.canonical.z;let m=t.canonical.x/h-s.canonical.x,y=t.canonical.y/h-s.canonical.y,b=0;for(let C=0;C<t.canonical.z-s.canonical.z&&!i.leaves[b];C++){m*=2,y*=2;const M=2*Math.floor(y)+Math.floor(m);b=i.childOffsets[b]+M,m%=1,y%=1}return{min:this.exaggeration()*i.minimums[b],max:this.exaggeration()*i.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=An,a.EvaluationParameters=lr,a.Event=dn,a.Evented=qn,a.Frustum=wf,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GlobeSharedBuffers=mc,a.GlyphManager=Ju,a.ImagePosition=Nd,a.LineAtlas=ed,a.LngLat=_o,a.LngLatBounds=is,a.LocalGlyphMode=Zd,a.MAX_MERCATOR_LATITUDE=Ya,a.MercatorCoordinate=_d,a.ONE_EM=24,a.OverscaledTileID=Ls,a.Properties=fs,a.RGBAImage=Vs,a.Ray=class{constructor(t,e){this.pos=t,this.dir=e}intersectsPlane(t,e,i){const s=Ht(e,this.dir);if(Math.abs(s)<1e-6)return!1;const h=((t[0]-this.pos[0])*e[0]+(t[1]-this.pos[1])*e[1]+(t[2]-this.pos[2])*e[2])/s;return i[0]=this.pos[0]+this.dir[0]*h,i[1]=this.pos[1]+this.dir[1]*h,i[2]=this.pos[2]+this.dir[2]*h,!0}closestPointOnSphere(t,e,i){if(be=(H=this.pos)[0],Le=H[1],qe=H[2],it=(pe=t)[0],yt=pe[1],Mt=pe[2],Math.abs(be-it)<=z*Math.max(1,Math.abs(be),Math.abs(it))&&Math.abs(Le-yt)<=z*Math.max(1,Math.abs(Le),Math.abs(yt))&&Math.abs(qe-Mt)<=z*Math.max(1,Math.abs(qe),Math.abs(Mt))||0===e)return i[0]=i[1]=i[2]=0,!1;var H,pe,be,Le,qe,it,yt,Mt;const[s,h,m]=this.dir,y=this.pos[0]-t[0],b=this.pos[1]-t[1],C=this.pos[2]-t[2],M=s*s+h*h+m*m,N=2*(y*s+b*h+C*m),j=N*N-4*M*(y*y+b*b+C*C-e*e);if(j<0){const H=Math.max(-N/2,0),pe=y+s*H,be=b+h*H,Le=C+m*H,qe=Math.hypot(pe,be,Le);return i[0]=pe*e/qe,i[1]=be*e/qe,i[2]=Le*e/qe,!1}{const H=(-N-Math.sqrt(j))/(2*M);if(H<0){const pe=Math.hypot(y,b,C);return i[0]=y*e/pe,i[1]=b*e/pe,i[2]=C*e/pe,!1}return i[0]=y+s*H,i[1]=b+h*H,i[2]=C+m*H,!0}}},a.RequestManager=class{constructor(t,e,i){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",tt,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!on(t))return t;const i=Nn(t);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!on(t))return t;const i=Nn(t);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(t,e){if(!on(t))return t;const i=Nn(t);return i.path=`/v4/${i.authority}.json`,i.params.push("secure"),this._makeAPIURL(i,this._customAccessToken||e)}normalizeSpriteURL(t,e,i,s){const h=Nn(t);return on(t)?(h.path=`/styles/v1${h.path}/sprite${e}${i}`,this._makeAPIURL(h,this._customAccessToken||s)):(h.path+=`${e}${i}`,Wn(h))}normalizeTileURL(t,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!on(t))return t;const s=Nn(t);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&"raster"!==s.authority&&512===i?"@2x":""}${F.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${K.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${K.TILE_URL_VERSION}${s.path}`);const h=this._customAccessToken||function(m){for(const y of m){const b=y.match(/^access_token=(.*)$/);if(b)return b[1]}return null}(s.params)||K.ACCESS_TOKEN;return K.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,h)}canonicalizeTileURL(t,e){const i=Nn(t);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return t;let s="mapbox://";i.path.match(/^\/raster\/v1\//)?s+=`raster/${i.path.replace(`/${K.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${i.path.replace(`/${K.TILE_URL_VERSION}/`,"")}`;let h=i.params;return e&&(h=h.filter(m=>!m.match(/^access_token=/))),h.length&&(s+=`?${h.join("&")}`),s}canonicalizeTileset(t,e){const i=!!e&&on(e),s=[];for(const h of t.tiles||[])sn(h)?s.push(this.canonicalizeTileURL(h,i)):s.push(h);return s}_makeAPIURL(t,e){const i="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",s=Nn(K.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,"http"===t.protocol){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if("/"!==s.path&&(t.path=`${s.path}${t.path}`),!K.REQUIRE_ACCESS_TOKEN)return Wn(t);if(e=e||K.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return t.params=t.params.filter(h=>-1===h.indexOf("access_token")),t.params.push(`access_token=${e||""}`),Wn(t)}},a.ResourceType=yo,a.SegmentVector=Jo,a.SourceCache=Vc,a.StencilMode=Cp,a.StructArrayLayout1ui2=fd,a.StructArrayLayout2f1f2i16=dd,a.StructArrayLayout2i4=Xc,a.StructArrayLayout2ui4=Da,a.StructArrayLayout3f12=Ga,a.StructArrayLayout3ui6=Qs,a.StructArrayLayout4i8=Ll,a.Texture=bp,a.Tile=eh,a.Transitionable=Rs,a.Uniform1f=Dh,a.Uniform1i=class extends qa{constructor(t,e){super(t,e),this.current=0}set(t){this.current!==t&&(this.current=t,this.gl.uniform1i(this.location,t))}},a.Uniform2f=class extends qa{constructor(t,e){super(t,e),this.current=[0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]||(this.current=t,this.gl.uniform2f(this.location,t[0],t[1]))}},a.Uniform3f=class extends qa{constructor(t,e){super(t,e),this.current=[0,0,0]}set(t){t[0]===this.current[0]&&t[1]===this.current[1]&&t[2]===this.current[2]||(this.current=t,this.gl.uniform3f(this.location,t[0],t[1],t[2]))}},a.Uniform4f=Wm,a.UniformColor=Ih,a.UniformMatrix2f=class extends qa{constructor(t,e){super(t,e),this.current=Km}set(t){for(let e=0;e<4;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix2fv(this.location,!1,t);break}}},a.UniformMatrix3f=class extends qa{constructor(t,e){super(t,e),this.current=Jm}set(t){for(let e=0;e<9;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix3fv(this.location,!1,t);break}}},a.UniformMatrix4f=class extends qa{constructor(t,e){super(t,e),this.current=Ym}set(t){if(t[12]!==this.current[12]||t[0]!==this.current[0])return this.current=t,void this.gl.uniformMatrix4fv(this.location,!1,t);for(let e=1;e<16;e++)if(t[e]!==this.current[e]){this.current=t,this.gl.uniformMatrix4fv(this.location,!1,t);break}}},a.UnwrappedTileID=Jd,a.ValidationError=hn,a.VectorTileWorkerSource=class extends qn{constructor(t,e,i,s,h){super(),this.actor=t,this.layerIndex=e,this.availableImages=i,this.loadVectorData=h||nl,this.loading={},this.loaded={},this.deduped=new rh(t.scheduler),this.isSpriteLoaded=s,this.scheduler=t.scheduler}loadTile(t,e){const i=t.uid,s=t&&t.request,h=s&&s.collectResourceTiming,m=this.loading[i]=new $g(t);m.abort=this.loadVectorData(t,(y,b)=>{const C=!this.loading[i];if(delete this.loading[i],C||y||!b)return m.status="done",C||(this.loaded[i]=m),e(y);const M=b.rawData,N={};b.expires&&(N.expires=b.expires),b.cacheControl&&(N.cacheControl=b.cacheControl),m.vectorTile=b.vectorTile||new Nc.VectorTile(new zc(M));const j=()=>{m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,(H,pe)=>{if(H||!pe)return e(H);const be={};if(h){const Le=yu(s);Le.length>0&&(be.resourceTiming=JSON.parse(JSON.stringify(Le)))}e(null,et({rawTileData:M.slice(0)},pe,N,be))})};this.isSpriteLoaded?j():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(j,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):j()}),this.loaded=this.loaded||{},this.loaded[i]=m})}reloadTile(t,e){const i=this.loaded,s=t.uid,h=this;if(i&&i[s]){const m=i[s];m.showCollisionBoxes=t.showCollisionBoxes,m.enableTerrain=!!t.enableTerrain,m.projection=t.projection;const y=(b,C)=>{const M=m.reloadCallback;M&&(delete m.reloadCallback,m.parse(m.vectorTile,h.layerIndex,this.availableImages,h.actor,M)),e(b,C)};"parsing"===m.status?m.reloadCallback=y:"done"===m.status&&(m.vectorTile?m.parse(m.vectorTile,this.layerIndex,this.availableImages,this.actor,y):y())}}abortTile(t,e){const i=t.uid,s=this.loading[i];s&&(s.abort&&s.abort(),delete this.loading[i]),e()}removeTile(t,e){const i=this.loaded,s=t.uid;i&&i[s]&&delete i[s],e()}},a.WritingMode=pa,a.ZoomHistory=g,a.add=Je,a.addDynamicAttributes=gu,a.adjoint=function(t,e){var i=e[0],s=e[1],h=e[2],m=e[3],y=e[4],b=e[5],C=e[6],M=e[7],N=e[8];return t[0]=y*N-b*M,t[1]=h*M-s*N,t[2]=s*b-h*y,t[3]=b*C-m*N,t[4]=i*N-h*C,t[5]=h*m-i*b,t[6]=m*M-y*C,t[7]=s*C-i*M,t[8]=i*y-s*m,t},a.asyncAll=ki,a.bezier=_r,a.bindAll=xe,a.boundsAttributes=gm,a.bufferConvexPolygon=function(t,e){const i=[];for(let s=0;s<t.length;s++){const h=Si(s-1,-1,t.length-1),m=Si(s+1,-1,t.length-1),y=t[s],b=t[m],C=t[h].sub(y).unit(),M=b.sub(y).unit(),N=M.angleWithSep(C.x,C.y),j=C.add(M).unit().mult(-1*e/Math.sin(N/2));i.push(y.add(j))}return i},a.cacheEntryPossiblyAdded=function(t){Oi++,Oi>xr&&(t.getActor().send("enforceCacheSizeLimit",Cr),Oi=0)},a.calculateGlobeMatrix=id,a.calculateGlobeMercatorMatrix=function(t){const e=t.worldSize,i=Ri(t.center.lat,-85.051129,Ya),s=new L(gl(t.center.lng)*e,sc(i)*e),h=Wa(1,t.center.lat)*e,m=t.pixelsPerMeter,y=e/(h/t.pixelsPerMeter),b=ye(new Float64Array(16));return Ee(b,b,[s.x,s.y,0]),je(b,b,[y,y,m]),b},a.clamp=Ri,a.clearTileCache=function(t){const e=Z.caches.delete(Gi);t&&e.catch(t).then(()=>t())},a.clipLine=Kf,a.clone=function(t){var e=new G(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.clone$1=ni,a.collisionCircleLayout=tp,a.config=K,a.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},a.create=function(){var t=new G(16);return G!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},a.create$1=te,a.createExpression=Ba,a.createLayout=Bo,a.createStyleLayer=function(t){return"custom"===t.type?new om(t):new am[t.type](t)},a.cross=Vn,a.degToRad=In,a.div=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},a.dot=Ht,a.ease=er,a.easeCubicInOut=ir,a.emitValidationErrors=lo,a.endsWith=Ie,a.enforceCacheSizeLimit=function(t){qr(),Ar&&Ar.then(e=>{e.keys().then(i=>{for(let s=0;s<i.length-t;s++)e.delete(i[s])})})},a.evaluateSizeForFeature=Bd,a.evaluateSizeForZoom=du,a.evaluateVariableOffset=nm,a.evented=vs,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.exported=ur,a.exported$1=F,a.extend=et,a.extend$1=no,a.filterObject=nn,a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.fromQuat=function(t,e){var i=e[0],s=e[1],h=e[2],m=e[3],y=i+i,b=s+s,C=h+h,M=i*y,N=s*y,j=s*b,H=h*y,pe=h*b,be=h*C,Le=m*y,qe=m*b,it=m*C;return t[0]=1-j-be,t[1]=N+it,t[2]=H-qe,t[3]=0,t[4]=N-it,t[5]=1-M-be,t[6]=pe+Le,t[7]=0,t[8]=H+qe,t[9]=pe-Le,t[10]=1-M-j,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e){var i=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=i,t[2]=0,t[3]=-i,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return mi[e]},a.getAABBPointSquareDist=function(t,e,i){let s=0;for(let h=0;h<2;++h){const m=i?i[h]:0;t[h]>m&&(s+=(t[h]-m)*(t[h]-m)),e[h]<m&&(s+=(m-e[h])*(m-e[h]))}return s},a.getAnchorAlignment=Ud,a.getAnchorJustification=Ku,a.getBounds=function(t){let e=1/0,i=1/0,s=-1/0,h=-1/0;for(const m of t)e=Math.min(e,m.x),i=Math.min(i,m.y),s=Math.max(s,m.x),h=Math.max(h,m.y);return{min:new L(e,i),max:new L(s,h)}},a.getColumn=function(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]},a.getImage=zt,a.getJSON=function(t,e){return Lr(et(t,{type:"json"}),e)},a.getMapSessionAPI=Ai,a.getPerformanceMeasurement=yu,a.getProjection=function(t){const e=Fp[t.name];if(!e)throw new Error(`Invalid projection name: ${t.name}`);return e.conic?function(i,s){if(s.parallels&&Math.abs(s.parallels[0]+s.parallels[1])<.01){let h=function(m){const y=Math.max(.01,Math.cos(In(m))),b=1/(2*Math.max(Math.PI*y,1/y));return{wrap:!0,supportsWorldCopies:!0,unsupportedLayers:["custom"],project(C,M){const N=In(C)*y,j=Math.sin(In(M))/y;return{x:N*b+.5,y:-j*b+.5,z:0}},unproject(C,M){const N=-(M-.5)/b,j=Ri(ti((C-.5)/b)/y,-180,180),H=Math.asin(Ri(N*y,-1,1)),pe=Ri(ti(H),-85.051129,Ya);return new _o(j,pe)}}}(s.parallels[0]);if("lambertConformalConic"===s.name){const{project:m,unproject:y}=Fp.mercator;h={wrap:!0,supportsWorldCopies:!0,project:m,unproject:y}}return et({},i,s,h)}return et({},i,s)}(e,t):e},a.getRTLTextPluginStatus=xs,a.getReferrer=uo,a.getTilePoint=function(t,{x:e,y:i},s=0){return new L(((e-s)*t.scale-t.x)*yr,(i*t.scale-t.y)*yr)},a.getTileVec3=function(t,e,i=0){return xt(((e.x-i)*t.scale-t.x)*yr,(e.y*t.scale-t.y)*yr,mf(e.z,e.y))},a.getVideo=function(t,e){const i=Z.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let s=0;s<t.length;s++){const h=Z.document.createElement("source");Xe(t[s])||(i.crossOrigin="Anonymous"),h.src=t[s],i.appendChild(h)}return{cancel:()=>{}}},a.globeBuffersForTileMesh=function(t,e,i,s){const h=t.context,m=t.transform;let y=e.globeGridBuffer,b=e.globePoleBuffer;if(!y){const C=mc.createGridVertices(i.canonical);y=e.globeGridBuffer=h.createVertexBuffer(C,vm,!1)}if(!b){const C=mc.createPoleTriangleVertices(s,m.tileSize*s,0===i.canonical.y);b=e.globePoleBuffer=h.createVertexBuffer(C,vm,!1)}return[y,b]},a.globeDenormalizeECEF=wm,a.globeMatrixForTile=function(t,e){const i=wm(nh(t)),s=((h=new Float64Array(16))[0]=(m=e)[0],h[1]=m[1],h[2]=m[2],h[3]=m[3],h[4]=m[4],h[5]=m[5],h[6]=m[6],h[7]=m[7],h[8]=m[8],h[9]=m[9],h[10]=m[10],h[11]=m[11],h[12]=m[12],h[13]=m[13],h[14]=m[14],h[15]=m[15],h);var h,m;return Ze(s,s,i),s},a.globePoleMatrixForTile=function(t,e,i){const s=ye(new Float64Array(16)),h=Math.pow(2,t.z),m=(t.x-h/2)/h*Math.PI*2,y=i.point,b=i.worldSize/(i.tileSize*h);return Ee(s,s,[y.x,y.y,-i.worldSize/Math.PI/2]),je(s,s,[b,b,b]),rt(s,s,In(-i._center.lat)),Ae(s,s,In(-i._center.lng)),Ae(s,s,m),e&&je(s,s,[1,-1,1]),s},a.globeTileBounds=nh,a.globeToMercatorTransition=function(t){return mr(5,6,t)},a.identity=ye,a.identity$1=Bn,a.invert=function(t,e){var i=e[0],s=e[1],h=e[2],m=e[3],y=e[4],b=e[5],C=e[6],M=e[7],N=e[8],j=e[9],H=e[10],pe=e[11],be=e[12],Le=e[13],qe=e[14],it=e[15],yt=i*b-s*y,Mt=i*C-h*y,Nt=i*M-m*y,Vt=s*C-h*b,jt=s*M-m*b,wn=h*M-m*C,vn=N*Le-j*be,Xn=N*qe-H*be,Un=N*it-pe*be,xn=j*qe-H*Le,Zn=j*it-pe*Le,ei=H*it-pe*qe,En=yt*ei-Mt*Zn+Nt*xn+Vt*Un-jt*Xn+wn*vn;return En?(t[0]=(b*ei-C*Zn+M*xn)*(En=1/En),t[1]=(h*Zn-s*ei-m*xn)*En,t[2]=(Le*wn-qe*jt+it*Vt)*En,t[3]=(H*jt-j*wn-pe*Vt)*En,t[4]=(C*Un-y*ei-M*Xn)*En,t[5]=(i*ei-h*Un+m*Xn)*En,t[6]=(qe*Nt-be*wn-it*Mt)*En,t[7]=(N*wn-H*Nt+pe*Mt)*En,t[8]=(y*Zn-b*Un+M*vn)*En,t[9]=(s*Un-i*Zn-m*vn)*En,t[10]=(be*jt-Le*Nt+it*yt)*En,t[11]=(j*Nt-N*jt-pe*yt)*En,t[12]=(b*Xn-y*xn-C*vn)*En,t[13]=(i*xn-s*Xn+h*vn)*En,t[14]=(Le*Mt-be*Vt-qe*yt)*En,t[15]=(N*Vt-j*Mt+H*yt)*En,t):null},a.isMapAuthenticated=function(t){return Bi.has(t)},a.isMapboxURL=on,a.latFromMercatorY=ha,a.len=Jn,a.length=Ne,a.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},a.loadVectorTile=nl,a.makeRequest=Lr,a.mercatorXfromLng=gl,a.mercatorYfromLat=sc,a.mercatorZfromAltitude=Wa,a.mul=Ze,a.mul$1=an,a.multiply=function(t,e,i){var s=e[0],h=e[1],m=e[2],y=e[3],b=e[4],C=e[5],M=e[6],N=e[7],j=e[8],H=i[0],pe=i[1],be=i[2],Le=i[3],qe=i[4],it=i[5],yt=i[6],Mt=i[7],Nt=i[8];return t[0]=H*s+pe*y+be*M,t[1]=H*h+pe*b+be*N,t[2]=H*m+pe*C+be*j,t[3]=Le*s+qe*y+it*M,t[4]=Le*h+qe*b+it*N,t[5]=Le*m+qe*C+it*j,t[6]=yt*s+Mt*y+Nt*M,t[7]=yt*h+Mt*b+Nt*N,t[8]=yt*m+Mt*C+Nt*j,t},a.multiply$1=me,a.multiply$2=wt,a.nextPowerOfTwo=Be,a.normalize=Lt,a.normalize$1=function(t,e){var i=e[0],s=e[1],h=e[2],m=e[3],y=i*i+s*s+h*h+m*m;return y>0&&(y=1/Math.sqrt(y)),t[0]=i*y,t[1]=s*y,t[2]=h*y,t[3]=m*y,t},a.number=Zr,a.ortho=function(t,e,i,s,h,m,y){var b=1/(e-i),C=1/(s-h),M=1/(m-y);return t[0]=-2*b,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*C,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*M,t[11]=0,t[12]=(e+i)*b,t[13]=(h+s)*C,t[14]=(y+m)*M,t[15]=1,t},a.pbf=zc,a.perspective=function(t,e,i,s,h){var m,y=1/Math.tan(e/2);return t[0]=y/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=y,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=h&&h!==1/0?(t[10]=(h+s)*(m=1/(s-h)),t[14]=2*h*s*m):(t[10]=-1,t[14]=-2*s),t},a.pick=function(t,e){const i={};for(let s=0;s<e.length;s++){const h=e[s];h in t&&(i[h]=t[h])}return i},a.plugin=$r,a.pointGeometry=L,a.polygonIntersectsBox=vf,a.polygonIntersectsPolygon=iu,a.polygonizeBounds=function(t,e,i=0,s=!0){const h=new L(i,i),m=t.sub(h),y=e.add(h),b=[m,new L(y.x,m.y),y,new L(m.x,y.y)];return s&&b.push(m),b},a.posAttributes=X_,a.postMapLoadEvent=vi,a.postTurnstileEvent=Qi,a.potpack=ap,a.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},a.radToDeg=ti,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(t){return t({pluginStatus:or,pluginURL:Ki}),vs.on("pluginStateChange",t),t},a.removeAuthState=function(t){Bi.delete(t)},a.renderColorRamp=Cf,a.rotateX=rt,a.rotateX$1=ln,a.rotateY=Ae,a.rotateZ=function(t,e,i){var s=Math.sin(i),h=Math.cos(i),m=e[0],y=e[1],b=e[2],C=e[3],M=e[4],N=e[5],j=e[6],H=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=m*h+M*s,t[1]=y*h+N*s,t[2]=b*h+j*s,t[3]=C*h+H*s,t[4]=M*h-m*s,t[5]=N*h-y*s,t[6]=j*h-b*s,t[7]=H*h-C*s,t},a.rotateZ$1=function(t,e,i){i*=.5;var s=e[0],h=e[1],m=e[2],y=e[3],b=Math.sin(i),C=Math.cos(i);return t[0]=s*C+h*b,t[1]=h*C-s*b,t[2]=m*C+y*b,t[3]=y*C-m*b,t},a.scale=je,a.scale$1=function(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t},a.scale$2=Ct,a.scaleAndAdd=gt,a.setCacheLimits=function(t,e){Cr=t,xr=e},a.setColumn=function(t,e,i){t[4*e+0]=i[0],t[4*e+1]=i[1],t[4*e+2]=i[2],t[4*e+3]=i[3]},a.setRTLTextPlugin=function(t,e,i=!1){if(or===Fi||or===ar||or===Xr)throw new Error("setRTLTextPlugin cannot be called multiple times.");Ki=ur.resolveURL(t),or=Fi,xo=e,ns(),i||ua()},a.smoothstep=mr,a.spec=Bt,a.storeAuthState=function(t,e){e?Bi.add(t):Bi.delete(t)},a.sub=Jt,a.subtract=ct,a.symbolSize=Uf,a.tileAABB=function(t,e,i,s,h,m,y,b,C){if("globe"===C.name){const pe=nh(new Jd(m,new td(i,s,h)).canonical).getCorners(),be=Number.MAX_VALUE,Le=[-be,-be,-be],qe=[be,be,be],it=id(t,e);for(let yt=0;yt<pe.length;yt++)Ft(pe[yt],pe[yt],it),N=qe,j=pe[yt],(M=qe)[0]=Math.min(N[0],j[0]),M[1]=Math.min(N[1],j[1]),M[2]=Math.min(N[2],j[2]),Tt(Le,Le,pe[yt]);return new Ia(qe,Le)}var M,N,j;const H=xu({z:i,x:s,y:h},C);return new Ia([(m+H.x/H.scale)*e,e*(H.y/H.scale),y],[(m+H.x2/H.scale)*e,e*(H.y2/H.scale),b])},a.tileTransform=xu,a.transformMat3=function(t,e,i){var s=e[0],h=e[1],m=e[2];return t[0]=s*i[0]+h*i[3]+m*i[6],t[1]=s*i[1]+h*i[4]+m*i[7],t[2]=s*i[2]+h*i[5]+m*i[8],t},a.transformMat4=Ft,a.transformMat4$1=si,a.transformQuat=Wt,a.translate=Ee,a.transpose=function(t,e){if(t===e){var i=e[1],s=e[2],h=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=s,t[7]=h}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.triggerPluginCompletionEvent=Mo,a.uniqueId=Pe,a.validateCustomStyleLayer=function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFog=ao,a.validateLight=Ii,a.validateStyle=Tn,a.values=Qt,a.vectorTile=Nc,a.version=O,a.warnOnce=Li,a.window=Z,a.wrap=Si}),c(0,function(a){function O(re){const K=typeof re;if("number"===K||"boolean"===K||"string"===K||null==re)return JSON.stringify(re);if(Array.isArray(re)){let _e="[";for(const Qe of re)_e+=`${O(Qe)},`;return`${_e}]`}const F=Object.keys(re).sort();let fe="{";for(let _e=0;_e<F.length;_e++)fe+=`${JSON.stringify(F[_e])}:${O(re[F[_e]])},`;return`${fe}}`}function A(re){let K="";for(const F of a.refProperties)K+=`/${O(re[F])}`;return K}class p{constructor(K){this.keyCache={},K&&this.replace(K)}replace(K){this._layerConfigs={},this._layers={},this.update(K,[])}update(K,F){for(const _e of K)this._layerConfigs[_e.id]=_e,(this._layers[_e.id]=a.createStyleLayer(_e)).compileFilter(),this.keyCache[_e.id]&&delete this.keyCache[_e.id];for(const _e of F)delete this.keyCache[_e],delete this._layerConfigs[_e],delete this._layers[_e];this.familiesBySource={};const fe=function(_e,Qe){const vt={};for(let tt=0;tt<_e.length;tt++){const Zt=Qe&&Qe[_e[tt].id]||A(_e[tt]);Qe&&(Qe[_e[tt].id]=Zt);let on=vt[Zt];on||(on=vt[Zt]=[]),on.push(_e[tt])}const kt=[];for(const tt in vt)kt.push(vt[tt]);return kt}(a.values(this._layerConfigs),this.keyCache);for(const _e of fe){const Qe=_e.map(sn=>this._layers[sn.id]),vt=Qe[0];if("none"===vt.visibility)continue;const kt=vt.source||"";let tt=this.familiesBySource[kt];tt||(tt=this.familiesBySource[kt]={});const Zt=vt.sourceLayer||"_geojsonTileLayer";let on=tt[Zt];on||(on=tt[Zt]=[]),on.push(Qe)}}}const{ImageBitmap:L}=a.window;class Q{loadTile(K,F){const{uid:fe,encoding:_e,rawImageData:Qe,padding:vt,buildQuadTree:kt}=K,tt=L&&Qe instanceof L?this.getImageData(Qe,vt):Qe;F(null,new a.DEMData(fe,tt,_e,vt<1,kt))}getImageData(K,F){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(K.width,K.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=K.width,this.offscreenCanvas.height=K.height,this.offscreenCanvasContext.drawImage(K,0,0,K.width,K.height);const fe=this.offscreenCanvasContext.getImageData(-F,-F,K.width+2*F,K.height+2*F);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new a.RGBAImage({width:fe.width,height:fe.height},fe.data)}}var Z=function re(K,F){var fe,_e=K&&K.type;if("FeatureCollection"===_e)for(fe=0;fe<K.features.length;fe++)re(K.features[fe],F);else if("GeometryCollection"===_e)for(fe=0;fe<K.geometries.length;fe++)re(K.geometries[fe],F);else if("Feature"===_e)re(K.geometry,F);else if("Polygon"===_e)z(K.coordinates,F);else if("MultiPolygon"===_e)for(fe=0;fe<K.coordinates.length;fe++)z(K.coordinates[fe],F);return K};function z(re,K){if(0!==re.length){G(re[0],K);for(var F=1;F<re.length;F++)G(re[F],!K)}}function G(re,K){for(var F=0,fe=0,_e=0,Qe=re.length,vt=Qe-1;_e<Qe;vt=_e++){var kt=(re[_e][0]-re[vt][0])*(re[vt][1]+re[_e][1]),tt=F+kt;fe+=Math.abs(F)>=Math.abs(kt)?F-tt+kt:kt-tt+F,F=tt}F+fe>=0!=!!K&&re.reverse()}const te=a.vectorTile.VectorTileFeature.prototype.toGeoJSON;class ye{constructor(K){this._feature=K,this.extent=a.EXTENT,this.type=K.type,this.properties=K.tags,"id"in K&&!isNaN(K.id)&&(this.id=parseInt(K.id,10))}loadGeometry(){if(1===this._feature.type){const K=[];for(const F of this._feature.geometry)K.push([new a.pointGeometry(F[0],F[1])]);return K}{const K=[];for(const F of this._feature.geometry){const fe=[];for(const _e of F)fe.push(new a.pointGeometry(_e[0],_e[1]));K.push(fe)}return K}}toGeoJSON(K,F,fe){return te.call(this,K,F,fe)}}class me{constructor(K){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=K.length,this._features=K}feature(K){return new ye(this._features[K])}}var Ee=a.vectorTile.VectorTileFeature,je=rt;function rt(re,K){this.options=K||{},this.features=re,this.length=re.length}function Ae(re,K){this.id="number"==typeof re.id?re.id:void 0,this.type=re.type,this.rawGeometry=1===re.type?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=K||4096}rt.prototype.feature=function(re){return new Ae(this.features[re],this.options.extent)},Ae.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var K=0;K<re.length;K++){for(var F=re[K],fe=[],_e=0;_e<F.length;_e++)fe.push(new a.pointGeometry(F[_e][0],F[_e][1]));this.geometry.push(fe)}return this.geometry},Ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,K=1/0,F=-1/0,fe=1/0,_e=-1/0,Qe=0;Qe<re.length;Qe++)for(var vt=re[Qe],kt=0;kt<vt.length;kt++){var tt=vt[kt];K=Math.min(K,tt.x),F=Math.max(F,tt.x),fe=Math.min(fe,tt.y),_e=Math.max(_e,tt.y)}return[K,fe,F,_e]},Ae.prototype.toGeoJSON=Ee.prototype.toGeoJSON;var Ze=He,Ve=je;function He(re){var K=new a.pbf;return function(F,fe){for(var _e in F.layers)fe.writeMessage(3,Ne,F.layers[_e])}(re,K),K.finish()}function Ne(re,K){var F;K.writeVarintField(15,re.version||1),K.writeStringField(1,re.name||""),K.writeVarintField(5,re.extent||4096);var fe={keys:[],values:[],keycache:{},valuecache:{}};for(F=0;F<re.length;F++)fe.feature=re.feature(F),K.writeMessage(2,xt,fe);var _e=fe.keys;for(F=0;F<_e.length;F++)K.writeStringField(3,_e[F]);var Qe=fe.values;for(F=0;F<Qe.length;F++)K.writeMessage(4,Ct,Qe[F])}function xt(re,K){var F=re.feature;void 0!==F.id&&K.writeVarintField(1,F.id),K.writeMessage(2,Je,re),K.writeVarintField(3,F.type),K.writeMessage(4,Tt,F)}function Je(re,K){var F=re.feature,fe=re.keys,_e=re.values,Qe=re.keycache,vt=re.valuecache;for(var kt in F.properties){var tt=F.properties[kt],Zt=Qe[kt];if(null!==tt){void 0===Zt&&(fe.push(kt),Qe[kt]=Zt=fe.length-1),K.writeVarint(Zt);var on=typeof tt;"string"!==on&&"boolean"!==on&&"number"!==on&&(tt=JSON.stringify(tt));var sn=on+":"+tt,gn=vt[sn];void 0===gn&&(_e.push(tt),vt[sn]=gn=_e.length-1),K.writeVarint(gn)}}}function ct(re,K){return(K<<3)+(7&re)}function wt(re){return re<<1^re>>31}function Tt(re,K){for(var F=re.loadGeometry(),fe=re.type,_e=0,Qe=0,vt=F.length,kt=0;kt<vt;kt++){var tt=F[kt],Zt=1;1===fe&&(Zt=tt.length),K.writeVarint(ct(1,Zt));for(var on=3===fe?tt.length-1:tt.length,sn=0;sn<on;sn++){1===sn&&1!==fe&&K.writeVarint(ct(2,on-1));var gn=tt[sn].x-_e,Nn=tt[sn].y-Qe;K.writeVarint(wt(gn)),K.writeVarint(wt(Nn)),_e+=gn,Qe+=Nn}3===fe&&K.writeVarint(ct(7,1))}}function Ct(re,K){var F=typeof re;"string"===F?K.writeStringField(1,re):"boolean"===F?K.writeBooleanField(7,re):"number"===F&&(re%1!=0?K.writeDoubleField(3,re):re<0?K.writeSVarintField(6,re):K.writeVarintField(5,re))}function gt(re,K,F,fe,_e,Qe){if(_e-fe<=F)return;const vt=fe+_e>>1;Lt(re,K,vt,fe,_e,Qe%2),gt(re,K,F,fe,vt-1,Qe+1),gt(re,K,F,vt+1,_e,Qe+1)}function Lt(re,K,F,fe,_e,Qe){for(;_e>fe;){if(_e-fe>600){const Zt=_e-fe+1,on=F-fe+1,sn=Math.log(Zt),gn=.5*Math.exp(2*sn/3),Nn=.5*Math.sqrt(sn*gn*(Zt-gn)/Zt)*(on-Zt/2<0?-1:1);Lt(re,K,F,Math.max(fe,Math.floor(F-on*gn/Zt+Nn)),Math.min(_e,Math.floor(F+(Zt-on)*gn/Zt+Nn)),Qe)}const vt=K[2*F+Qe];let kt=fe,tt=_e;for(Ht(re,K,fe,F),K[2*_e+Qe]>vt&&Ht(re,K,fe,_e);kt<tt;){for(Ht(re,K,kt,tt),kt++,tt--;K[2*kt+Qe]<vt;)kt++;for(;K[2*tt+Qe]>vt;)tt--}K[2*fe+Qe]===vt?Ht(re,K,fe,tt):(tt++,Ht(re,K,tt,_e)),tt<=F&&(fe=tt+1),F<=tt&&(_e=tt-1)}}function Ht(re,K,F,fe){Vn(re,F,fe),Vn(K,2*F,2*fe),Vn(K,2*F+1,2*fe+1)}function Vn(re,K,F){const fe=re[K];re[K]=re[F],re[F]=fe}function Ft(re,K,F,fe){const _e=re-F,Qe=K-fe;return _e*_e+Qe*Qe}Ze.fromVectorTileJs=He,Ze.fromGeojsonVt=function(re,K){K=K||{};var F={};for(var fe in re)F[fe]=new je(re[fe].features,K),F[fe].name=fe,F[fe].version=K.version,F[fe].extent=K.extent;return He({layers:F})},Ze.GeoJSONWrapper=Ve;const Wt=re=>re[0],Gt=re=>re[1];class Jt{constructor(K,F=Wt,fe=Gt,_e=64,Qe=Float64Array){this.nodeSize=_e,this.points=K;const vt=K.length<65536?Uint16Array:Uint32Array,kt=this.ids=new vt(K.length),tt=this.coords=new Qe(2*K.length);for(let Zt=0;Zt<K.length;Zt++)kt[Zt]=Zt,tt[2*Zt]=F(K[Zt]),tt[2*Zt+1]=fe(K[Zt]);gt(kt,tt,_e,0,kt.length-1,0)}range(K,F,fe,_e){return function(Qe,vt,kt,tt,Zt,on,sn){const gn=[0,Qe.length-1,0],Nn=[];let Wn,ai;for(;gn.length;){const Kn=gn.pop(),ui=gn.pop(),Qi=gn.pop();if(ui-Qi<=sn){for(let Pn=Qi;Pn<=ui;Pn++)Wn=vt[2*Pn],ai=vt[2*Pn+1],Wn>=kt&&Wn<=Zt&&ai>=tt&&ai<=on&&Nn.push(Qe[Pn]);continue}const Hi=Math.floor((Qi+ui)/2);Wn=vt[2*Hi],ai=vt[2*Hi+1],Wn>=kt&&Wn<=Zt&&ai>=tt&&ai<=on&&Nn.push(Qe[Hi]);const vi=(Kn+1)%2;(0===Kn?kt<=Wn:tt<=ai)&&(gn.push(Qi),gn.push(Hi-1),gn.push(vi)),(0===Kn?Zt>=Wn:on>=ai)&&(gn.push(Hi+1),gn.push(ui),gn.push(vi))}return Nn}(this.ids,this.coords,K,F,fe,_e,this.nodeSize)}within(K,F,fe){return function(_e,Qe,vt,kt,tt,Zt){const on=[0,_e.length-1,0],sn=[],gn=tt*tt;for(;on.length;){const Nn=on.pop(),Wn=on.pop(),ai=on.pop();if(Wn-ai<=Zt){for(let vi=ai;vi<=Wn;vi++)Ft(Qe[2*vi],Qe[2*vi+1],vt,kt)<=gn&&sn.push(_e[vi]);continue}const Kn=Math.floor((ai+Wn)/2),ui=Qe[2*Kn],Qi=Qe[2*Kn+1];Ft(ui,Qi,vt,kt)<=gn&&sn.push(_e[Kn]);const Hi=(Nn+1)%2;(0===Nn?vt-tt<=ui:kt-tt<=Qi)&&(on.push(ai),on.push(Kn-1),on.push(Hi)),(0===Nn?vt+tt>=ui:kt+tt>=Qi)&&(on.push(Kn+1),on.push(Wn),on.push(Hi))}return sn}(this.ids,this.coords,K,F,fe,this.nodeSize)}}const an={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},Jn=Math.fround||(si=new Float32Array(1),re=>(si[0]=+re,si[0]));var si;class di{constructor(K){this.options=mi(Object.create(an),K),this.trees=new Array(this.options.maxZoom+1)}load(K){const{log:F,minZoom:fe,maxZoom:_e,nodeSize:Qe}=this.options;F&&console.time("total time");const vt=`prepare ${K.length} points`;F&&console.time(vt),this.points=K;let kt=[];for(let tt=0;tt<K.length;tt++)K[tt].geometry&&kt.push(ln(K[tt],tt));this.trees[_e+1]=new Jt(kt,ir,_r,Qe,Float32Array),F&&console.timeEnd(vt);for(let tt=_e;tt>=fe;tt--){const Zt=+Date.now();kt=this._cluster(kt,tt),this.trees[tt]=new Jt(kt,ir,_r,Qe,Float32Array),F&&console.log("z%d: %d clusters in %dms",tt,kt.length,+Date.now()-Zt)}return F&&console.timeEnd("total time"),this}getClusters(K,F){let fe=((K[0]+180)%360+360)%360-180;const _e=Math.max(-90,Math.min(90,K[1]));let Qe=180===K[2]?180:((K[2]+180)%360+360)%360-180;const vt=Math.max(-90,Math.min(90,K[3]));if(K[2]-K[0]>=360)fe=-180,Qe=180;else if(fe>Qe){const on=this.getClusters([fe,_e,180,vt],F),sn=this.getClusters([-180,_e,Qe,vt],F);return on.concat(sn)}const kt=this.trees[this._limitZoom(F)],tt=kt.range(Hn(fe),In(vt),Hn(Qe),In(_e)),Zt=[];for(const on of tt){const sn=kt.points[on];Zt.push(sn.numPoints?Et(sn):this.points[sn.index])}return Zt}getChildren(K){const F=this._getOriginId(K),fe=this._getOriginZoom(K),_e="No cluster with the specified id.",Qe=this.trees[fe];if(!Qe)throw new Error(_e);const vt=Qe.points[F];if(!vt)throw new Error(_e);const kt=this.options.radius/(this.options.extent*Math.pow(2,fe-1)),tt=Qe.within(vt.x,vt.y,kt),Zt=[];for(const on of tt){const sn=Qe.points[on];sn.parentId===K&&Zt.push(sn.numPoints?Et(sn):this.points[sn.index])}if(0===Zt.length)throw new Error(_e);return Zt}getLeaves(K,F,fe){const _e=[];return this._appendLeaves(_e,K,F=F||10,fe=fe||0,0),_e}getTile(K,F,fe){const _e=this.trees[this._limitZoom(K)],Qe=Math.pow(2,K),{extent:vt,radius:kt}=this.options,tt=kt/vt,Zt=(fe-tt)/Qe,on=(fe+1+tt)/Qe,sn={features:[]};return this._addTileFeatures(_e.range((F-tt)/Qe,Zt,(F+1+tt)/Qe,on),_e.points,F,fe,Qe,sn),0===F&&this._addTileFeatures(_e.range(1-tt/Qe,Zt,1,on),_e.points,Qe,fe,Qe,sn),F===Qe-1&&this._addTileFeatures(_e.range(0,Zt,tt/Qe,on),_e.points,-1,fe,Qe,sn),sn.features.length?sn:null}getClusterExpansionZoom(K){let F=this._getOriginZoom(K)-1;for(;F<=this.options.maxZoom;){const fe=this.getChildren(K);if(F++,1!==fe.length)break;K=fe[0].properties.cluster_id}return F}_appendLeaves(K,F,fe,_e,Qe){const vt=this.getChildren(F);for(const kt of vt){const tt=kt.properties;if(tt&&tt.cluster?Qe+tt.point_count<=_e?Qe+=tt.point_count:Qe=this._appendLeaves(K,tt.cluster_id,fe,_e,Qe):Qe<_e?Qe++:K.push(kt),K.length===fe)break}return Qe}_addTileFeatures(K,F,fe,_e,Qe,vt){for(const kt of K){const tt=F[kt],Zt=tt.numPoints;let on,sn,gn;if(Zt)on=Kt(tt),sn=tt.x,gn=tt.y;else{const ai=this.points[tt.index];on=ai.properties,sn=Hn(ai.geometry.coordinates[0]),gn=In(ai.geometry.coordinates[1])}const Nn={type:1,geometry:[[Math.round(this.options.extent*(sn*Qe-fe)),Math.round(this.options.extent*(gn*Qe-_e))]],tags:on};let Wn;Zt?Wn=tt.id:this.options.generateId?Wn=tt.index:this.points[tt.index].id&&(Wn=this.points[tt.index].id),void 0!==Wn&&(Nn.id=Wn),vt.features.push(Nn)}}_limitZoom(K){return Math.max(this.options.minZoom,Math.min(+K,this.options.maxZoom+1))}_cluster(K,F){const fe=[],{radius:_e,extent:Qe,reduce:vt,minPoints:kt}=this.options,tt=_e/(Qe*Math.pow(2,F));for(let Zt=0;Zt<K.length;Zt++){const on=K[Zt];if(on.zoom<=F)continue;on.zoom=F;const sn=this.trees[F+1],gn=sn.within(on.x,on.y,tt),Nn=on.numPoints||1;let Wn=Nn;for(const ai of gn){const Kn=sn.points[ai];Kn.zoom>F&&(Wn+=Kn.numPoints||1)}if(Wn>Nn&&Wn>=kt){let ai=on.x*Nn,Kn=on.y*Nn,ui=vt&&Nn>1?this._map(on,!0):null;const Qi=(Zt<<5)+(F+1)+this.points.length;for(const Hi of gn){const vi=sn.points[Hi];if(vi.zoom<=F)continue;vi.zoom=F;const Pn=vi.numPoints||1;ai+=vi.x*Pn,Kn+=vi.y*Pn,vi.parentId=Qi,vt&&(ui||(ui=this._map(on,!0)),vt(ui,this._map(vi)))}on.parentId=Qi,fe.push(Bn(ai/Wn,Kn/Wn,Qi,Wn,ui))}else if(fe.push(on),Wn>1)for(const ai of gn){const Kn=sn.points[ai];Kn.zoom<=F||(Kn.zoom=F,fe.push(Kn))}}return fe}_getOriginId(K){return K-this.points.length>>5}_getOriginZoom(K){return(K-this.points.length)%32}_map(K,F){if(K.numPoints)return F?mi({},K.properties):K.properties;const fe=this.points[K.index].properties,_e=this.options.map(fe);return F&&_e===fe?mi({},_e):_e}}function Bn(re,K,F,fe,_e){return{x:Jn(re),y:Jn(K),zoom:1/0,id:F,parentId:-1,numPoints:fe,properties:_e}}function ln(re,K){const[F,fe]=re.geometry.coordinates;return{x:Jn(Hn(F)),y:Jn(In(fe)),zoom:1/0,index:K,parentId:-1}}function Et(re){return{type:"Feature",id:re.id,properties:Kt(re),geometry:{type:"Point",coordinates:[(K=re.x,360*(K-.5)),ti(re.y)]}};var K}function Kt(re){const K=re.numPoints,F=K>=1e4?`${Math.round(K/1e3)}k`:K>=1e3?Math.round(K/100)/10+"k":K;return mi(mi({},re.properties),{cluster:!0,cluster_id:re.id,point_count:K,point_count_abbreviated:F})}function Hn(re){return re/360+.5}function In(re){const K=Math.sin(re*Math.PI/180),F=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return F<0?0:F>1?1:F}function ti(re){const K=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(K))/Math.PI-90}function mi(re,K){for(const F in K)re[F]=K[F];return re}function ir(re){return re.x}function _r(re){return re.y}function er(re,K,F,fe){for(var _e,Qe=fe,vt=F-K>>1,kt=F-K,tt=re[K],Zt=re[K+1],on=re[F],sn=re[F+1],gn=K+3;gn<F;gn+=3){var Nn=Ri(re[gn],re[gn+1],tt,Zt,on,sn);if(Nn>Qe)_e=gn,Qe=Nn;else if(Nn===Qe){var Wn=Math.abs(gn-vt);Wn<kt&&(_e=gn,kt=Wn)}}Qe>fe&&(_e-K>3&&er(re,K,_e,fe),re[_e+2]=Qe,F-_e>3&&er(re,_e,F,fe))}function Ri(re,K,F,fe,_e,Qe){var vt=_e-F,kt=Qe-fe;if(0!==vt||0!==kt){var tt=((re-F)*vt+(K-fe)*kt)/(vt*vt+kt*kt);tt>1?(F=_e,fe=Qe):tt>0&&(F+=vt*tt,fe+=kt*tt)}return(vt=re-F)*vt+(kt=K-fe)*kt}function mr(re,K,F,fe){var _e={id:void 0===re?null:re,type:K,geometry:F,tags:fe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Qe){var vt=Qe.geometry,kt=Qe.type;if("Point"===kt||"MultiPoint"===kt||"LineString"===kt)Si(Qe,vt);else if("Polygon"===kt||"MultiLineString"===kt)for(var tt=0;tt<vt.length;tt++)Si(Qe,vt[tt]);else if("MultiPolygon"===kt)for(tt=0;tt<vt.length;tt++)for(var Zt=0;Zt<vt[tt].length;Zt++)Si(Qe,vt[tt][Zt])}(_e),_e}function Si(re,K){for(var F=0;F<K.length;F+=3)re.minX=Math.min(re.minX,K[F]),re.minY=Math.min(re.minY,K[F+1]),re.maxX=Math.max(re.maxX,K[F]),re.maxY=Math.max(re.maxY,K[F+1])}function ki(re,K,F,fe){if(K.geometry){var _e=K.geometry.coordinates,Qe=K.geometry.type,vt=Math.pow(F.tolerance/((1<<F.maxZoom)*F.extent),2),kt=[],tt=K.id;if(F.promoteId?tt=K.properties[F.promoteId]:F.generateId&&(tt=fe||0),"Point"===Qe)Qt(_e,kt);else if("MultiPoint"===Qe)for(var Zt=0;Zt<_e.length;Zt++)Qt(_e[Zt],kt);else if("LineString"===Qe)et(_e,kt,vt,!1);else if("MultiLineString"===Qe){if(F.lineMetrics){for(Zt=0;Zt<_e.length;Zt++)et(_e[Zt],kt=[],vt,!1),re.push(mr(tt,"LineString",kt,K.properties));return}de(_e,kt,vt,!1)}else if("Polygon"===Qe)de(_e,kt,vt,!0);else{if("MultiPolygon"!==Qe){if("GeometryCollection"===Qe){for(Zt=0;Zt<K.geometry.geometries.length;Zt++)ki(re,{id:tt,geometry:K.geometry.geometries[Zt],properties:K.properties},F,fe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Zt=0;Zt<_e.length;Zt++){var on=[];de(_e[Zt],on,vt,!0),kt.push(on)}}re.push(mr(tt,Qe,kt,K.properties))}}function Qt(re,K){K.push(Pe(re[0])),K.push(ft(re[1])),K.push(0)}function et(re,K,F,fe){for(var _e,Qe,vt=0,kt=0;kt<re.length;kt++){var tt=Pe(re[kt][0]),Zt=ft(re[kt][1]);K.push(tt),K.push(Zt),K.push(0),kt>0&&(vt+=fe?(_e*Zt-tt*Qe)/2:Math.sqrt(Math.pow(tt-_e,2)+Math.pow(Zt-Qe,2))),_e=tt,Qe=Zt}var on=K.length-3;K[2]=1,er(K,0,on,F),K[on+2]=1,K.size=Math.abs(vt),K.start=0,K.end=K.size}function de(re,K,F,fe){for(var _e=0;_e<re.length;_e++){var Qe=[];et(re[_e],Qe,F,fe),K.push(Qe)}}function Pe(re){return re/360+.5}function ft(re){var K=Math.sin(re*Math.PI/180),F=.5-.25*Math.log((1+K)/(1-K))/Math.PI;return F<0?0:F>1?1:F}function Be(re,K,F,fe,_e,Qe,vt,kt){if(fe/=K,Qe>=(F/=K)&&vt<fe)return re;if(vt<F||Qe>=fe)return null;for(var tt=[],Zt=0;Zt<re.length;Zt++){var on=re[Zt],sn=on.geometry,gn=on.type,Nn=0===_e?on.minX:on.minY,Wn=0===_e?on.maxX:on.maxY;if(Nn>=F&&Wn<fe)tt.push(on);else if(!(Wn<F||Nn>=fe)){var ai=[];if("Point"===gn||"MultiPoint"===gn)$t(sn,ai,F,fe,_e);else if("LineString"===gn)xe(sn,ai,F,fe,_e,!1,kt.lineMetrics);else if("MultiLineString"===gn)Ut(sn,ai,F,fe,_e,!1);else if("Polygon"===gn)Ut(sn,ai,F,fe,_e,!0);else if("MultiPolygon"===gn)for(var Kn=0;Kn<sn.length;Kn++){var ui=[];Ut(sn[Kn],ui,F,fe,_e,!0),ui.length&&ai.push(ui)}if(ai.length){if(kt.lineMetrics&&"LineString"===gn){for(Kn=0;Kn<ai.length;Kn++)tt.push(mr(on.id,gn,ai[Kn],on.tags));continue}"LineString"!==gn&&"MultiLineString"!==gn||(1===ai.length?(gn="LineString",ai=ai[0]):gn="MultiLineString"),"Point"!==gn&&"MultiPoint"!==gn||(gn=3===ai.length?"Point":"MultiPoint"),tt.push(mr(on.id,gn,ai,on.tags))}}}return tt.length?tt:null}function $t(re,K,F,fe,_e){for(var Qe=0;Qe<re.length;Qe+=3){var vt=re[Qe+_e];vt>=F&&vt<=fe&&(K.push(re[Qe]),K.push(re[Qe+1]),K.push(re[Qe+2]))}}function xe(re,K,F,fe,_e,Qe,vt){for(var kt,tt,Zt=Ie(re),on=0===_e?ni:cr,sn=re.start,gn=0;gn<re.length-3;gn+=3){var Nn=re[gn],Wn=re[gn+1],ai=re[gn+2],Kn=re[gn+3],ui=re[gn+4],Qi=0===_e?Nn:Wn,Hi=0===_e?Kn:ui,vi=!1;vt&&(kt=Math.sqrt(Math.pow(Nn-Kn,2)+Math.pow(Wn-ui,2))),Qi<F?Hi>F&&(tt=on(Zt,Nn,Wn,Kn,ui,F),vt&&(Zt.start=sn+kt*tt)):Qi>fe?Hi<fe&&(tt=on(Zt,Nn,Wn,Kn,ui,fe),vt&&(Zt.start=sn+kt*tt)):nn(Zt,Nn,Wn,ai),Hi<F&&Qi>=F&&(tt=on(Zt,Nn,Wn,Kn,ui,F),vi=!0),Hi>fe&&Qi<=fe&&(tt=on(Zt,Nn,Wn,Kn,ui,fe),vi=!0),!Qe&&vi&&(vt&&(Zt.end=sn+kt*tt),K.push(Zt),Zt=Ie(re)),vt&&(sn+=kt)}var Pn=re.length-3;Nn=re[Pn],Wn=re[Pn+1],ai=re[Pn+2],(Qi=0===_e?Nn:Wn)>=F&&Qi<=fe&&nn(Zt,Nn,Wn,ai),Pn=Zt.length-3,Qe&&Pn>=3&&(Zt[Pn]!==Zt[0]||Zt[Pn+1]!==Zt[1])&&nn(Zt,Zt[0],Zt[1],Zt[2]),Zt.length&&K.push(Zt)}function Ie(re){var K=[];return K.size=re.size,K.start=re.start,K.end=re.end,K}function Ut(re,K,F,fe,_e,Qe){for(var vt=0;vt<re.length;vt++)xe(re[vt],K,F,fe,_e,Qe,!1)}function nn(re,K,F,fe){re.push(K),re.push(F),re.push(fe)}function ni(re,K,F,fe,_e,Qe){var vt=(Qe-K)/(fe-K);return re.push(Qe),re.push(F+(_e-F)*vt),re.push(1),vt}function cr(re,K,F,fe,_e,Qe){var vt=(Qe-F)/(_e-F);return re.push(K+(fe-K)*vt),re.push(Qe),re.push(1),vt}function Li(re,K){for(var F=[],fe=0;fe<re.length;fe++){var _e,Qe=re[fe],vt=Qe.type;if("Point"===vt||"MultiPoint"===vt||"LineString"===vt)_e=Ei(Qe.geometry,K);else if("MultiLineString"===vt||"Polygon"===vt){_e=[];for(var kt=0;kt<Qe.geometry.length;kt++)_e.push(Ei(Qe.geometry[kt],K))}else if("MultiPolygon"===vt)for(_e=[],kt=0;kt<Qe.geometry.length;kt++){for(var tt=[],Zt=0;Zt<Qe.geometry[kt].length;Zt++)tt.push(Ei(Qe.geometry[kt][Zt],K));_e.push(tt)}F.push(mr(Qe.id,vt,_e,Qe.tags))}return F}function Ei(re,K){var F=[];F.size=re.size,void 0!==re.start&&(F.start=re.start,F.end=re.end);for(var fe=0;fe<re.length;fe+=3)F.push(re[fe]+K,re[fe+1],re[fe+2]);return F}function xi(re,K){if(re.transformed)return re;var F,fe,_e,Qe=1<<re.z,vt=re.x,kt=re.y;for(F=0;F<re.features.length;F++){var tt=re.features[F],Zt=tt.geometry,on=tt.type;if(tt.geometry=[],1===on)for(fe=0;fe<Zt.length;fe+=2)tt.geometry.push(vr(Zt[fe],Zt[fe+1],K,Qe,vt,kt));else for(fe=0;fe<Zt.length;fe++){var sn=[];for(_e=0;_e<Zt[fe].length;_e+=2)sn.push(vr(Zt[fe][_e],Zt[fe][_e+1],K,Qe,vt,kt));tt.geometry.push(sn)}}return re.transformed=!0,re}function vr(re,K,F,fe,_e,Qe){return[Math.round(F*(re*fe-_e)),Math.round(F*(K*fe-Qe))]}function ji(re,K,F,fe,_e){for(var Qe=K===_e.maxZoom?0:_e.tolerance/((1<<K)*_e.extent),vt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:F,y:fe,z:K,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},kt=0;kt<re.length;kt++){vt.numFeatures++,Ir(vt,re[kt],Qe,_e);var tt=re[kt].minX,Zt=re[kt].minY,on=re[kt].maxX,sn=re[kt].maxY;tt<vt.minX&&(vt.minX=tt),Zt<vt.minY&&(vt.minY=Zt),on>vt.maxX&&(vt.maxX=on),sn>vt.maxY&&(vt.maxY=sn)}return vt}function Ir(re,K,F,fe){var _e=K.geometry,Qe=K.type,vt=[];if("Point"===Qe||"MultiPoint"===Qe)for(var kt=0;kt<_e.length;kt+=3)vt.push(_e[kt]),vt.push(_e[kt+1]),re.numPoints++,re.numSimplified++;else if("LineString"===Qe)$i(vt,_e,re,F,!1,!1);else if("MultiLineString"===Qe||"Polygon"===Qe)for(kt=0;kt<_e.length;kt++)$i(vt,_e[kt],re,F,"Polygon"===Qe,0===kt);else if("MultiPolygon"===Qe)for(var tt=0;tt<_e.length;tt++){var Zt=_e[tt];for(kt=0;kt<Zt.length;kt++)$i(vt,Zt[kt],re,F,!0,0===kt)}if(vt.length){var on=K.tags||null;if("LineString"===Qe&&fe.lineMetrics){for(var sn in on={},K.tags)on[sn]=K.tags[sn];on.mapbox_clip_start=_e.start/_e.size,on.mapbox_clip_end=_e.end/_e.size}var gn={geometry:vt,type:"Polygon"===Qe||"MultiPolygon"===Qe?3:"LineString"===Qe||"MultiLineString"===Qe?2:1,tags:on};null!==K.id&&(gn.id=K.id),re.features.push(gn)}}function $i(re,K,F,fe,_e,Qe){var vt=fe*fe;if(fe>0&&K.size<(_e?vt:fe))F.numPoints+=K.length/3;else{for(var kt=[],tt=0;tt<K.length;tt+=3)(0===fe||K[tt+2]>vt)&&(F.numSimplified++,kt.push(K[tt]),kt.push(K[tt+1])),F.numPoints++;_e&&function(Zt,on){for(var sn=0,gn=0,Nn=Zt.length,Wn=Nn-2;gn<Nn;Wn=gn,gn+=2)sn+=(Zt[gn]-Zt[Wn])*(Zt[gn+1]+Zt[Wn+1]);if(sn>0===on)for(gn=0,Nn=Zt.length;gn<Nn/2;gn+=2){var ai=Zt[gn],Kn=Zt[gn+1];Zt[gn]=Zt[Nn-2-gn],Zt[gn+1]=Zt[Nn-1-gn],Zt[Nn-2-gn]=ai,Zt[Nn-1-gn]=Kn}}(kt,Qe),re.push(kt)}}function Gr(re,K){var F=(K=this.options=function(_e,Qe){for(var vt in Qe)_e[vt]=Qe[vt];return _e}(Object.create(this.options),K)).debug;if(F&&console.time("preprocess data"),K.maxZoom<0||K.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(K.promoteId&&K.generateId)throw new Error("promoteId and generateId cannot be used together.");var _e,Qe,vt,kt,tt,Zt,fe=function(_e,Qe){var vt=[];if("FeatureCollection"===_e.type)for(var kt=0;kt<_e.features.length;kt++)ki(vt,_e.features[kt],Qe,kt);else ki(vt,"Feature"===_e.type?_e:{geometry:_e},Qe);return vt}(re,K);this.tiles={},this.tileCoords=[],F&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",K.indexMaxZoom,K.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(_e=fe,Qe=K,vt=Qe.buffer/Qe.extent,kt=_e,tt=Be(_e,1,-1-vt,vt,0,-1,2,Qe),Zt=Be(_e,1,1-vt,2+vt,0,-1,2,Qe),(tt||Zt)&&(kt=Be(_e,1,-vt,1+vt,0,-1,2,Qe)||[],tt&&(kt=Li(tt,1).concat(kt)),Zt&&(kt=kt.concat(Li(Zt,-1)))),fe=kt).length&&this.splitTile(fe,0,0,0),F&&(fe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function eo(re,K,F){return 32*((1<<re)*F+K)+re}function zr(re,K){const F=re.tileID.canonical;if(!this._geoJSONIndex)return K(null,null);const fe=this._geoJSONIndex.getTile(F.z,F.x,F.y);if(!fe)return K(null,null);const _e=new me(fe.features);let Qe=Ze(_e);0===Qe.byteOffset&&Qe.byteLength===Qe.buffer.byteLength||(Qe=new Uint8Array(Qe)),K(null,{vectorTile:_e,rawData:Qe.buffer})}Gr.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Gr.prototype.splitTile=function(re,K,F,fe,_e,Qe,vt){for(var kt=[re,K,F,fe],tt=this.options,Zt=tt.debug;kt.length;){fe=kt.pop(),F=kt.pop(),K=kt.pop(),re=kt.pop();var on=1<<K,sn=eo(K,F,fe),gn=this.tiles[sn];if(!gn&&(Zt>1&&console.time("creation"),gn=this.tiles[sn]=ji(re,K,F,fe,tt),this.tileCoords.push({z:K,x:F,y:fe}),Zt)){Zt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",K,F,fe,gn.numFeatures,gn.numPoints,gn.numSimplified),console.timeEnd("creation"));var Nn="z"+K;this.stats[Nn]=(this.stats[Nn]||0)+1,this.total++}if(gn.source=re,_e){if(K===tt.maxZoom||K===_e)continue;var Wn=1<<_e-K;if(F!==Math.floor(Qe/Wn)||fe!==Math.floor(vt/Wn))continue}else if(K===tt.indexMaxZoom||gn.numPoints<=tt.indexMaxPoints)continue;if(gn.source=null,0!==re.length){Zt>1&&console.time("clipping");var ai,Kn,ui,Qi,Hi,vi,Pn=.5*tt.buffer/tt.extent,Ai=.5-Pn,Bi=.5+Pn,Gi=1+Pn;ai=Kn=ui=Qi=null,Hi=Be(re,on,F-Pn,F+Bi,0,gn.minX,gn.maxX,tt),vi=Be(re,on,F+Ai,F+Gi,0,gn.minX,gn.maxX,tt),re=null,Hi&&(ai=Be(Hi,on,fe-Pn,fe+Bi,1,gn.minY,gn.maxY,tt),Kn=Be(Hi,on,fe+Ai,fe+Gi,1,gn.minY,gn.maxY,tt),Hi=null),vi&&(ui=Be(vi,on,fe-Pn,fe+Bi,1,gn.minY,gn.maxY,tt),Qi=Be(vi,on,fe+Ai,fe+Gi,1,gn.minY,gn.maxY,tt),vi=null),Zt>1&&console.timeEnd("clipping"),kt.push(ai||[],K+1,2*F,2*fe),kt.push(Kn||[],K+1,2*F,2*fe+1),kt.push(ui||[],K+1,2*F+1,2*fe),kt.push(Qi||[],K+1,2*F+1,2*fe+1)}}},Gr.prototype.getTile=function(re,K,F){var fe=this.options,_e=fe.extent,Qe=fe.debug;if(re<0||re>24)return null;var vt=1<<re,kt=eo(re,K=(K%vt+vt)%vt,F);if(this.tiles[kt])return xi(this.tiles[kt],_e);Qe>1&&console.log("drilling down to z%d-%d-%d",re,K,F);for(var tt,Zt=re,on=K,sn=F;!tt&&Zt>0;)Zt--,on=Math.floor(on/2),sn=Math.floor(sn/2),tt=this.tiles[eo(Zt,on,sn)];return tt&&tt.source?(Qe>1&&console.log("found parent tile z%d-%d-%d",Zt,on,sn),Qe>1&&console.time("drilling down"),this.splitTile(tt.source,Zt,on,sn,re,K,F),Qe>1&&console.timeEnd("drilling down"),this.tiles[kt]?xi(this.tiles[kt],_e):null):null};class Xi extends a.VectorTileWorkerSource{constructor(K,F,fe,_e,Qe){super(K,F,fe,_e,zr),Qe&&(this.loadGeoJSON=Qe)}loadData(K,F){const fe=K&&K.request,_e=fe&&fe.collectResourceTiming;this.loadGeoJSON(K,(Qe,vt)=>{if(Qe||!vt)return F(Qe);if("object"!=typeof vt)return F(new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`));{Z(vt,!0);try{if(K.filter){const tt=a.createExpression(K.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===tt.result)throw new Error(tt.value.map(on=>`${on.key}: ${on.message}`).join(", "));const Zt=vt.features.filter(on=>tt.value.evaluate({zoom:0},on));vt={type:"FeatureCollection",features:Zt}}this._geoJSONIndex=K.cluster?new di(function({superclusterOptions:tt,clusterProperties:Zt}){if(!Zt||!tt)return tt;const on={},sn={},gn={accumulated:null,zoom:0},Nn={properties:null},Wn=Object.keys(Zt);for(const ai of Wn){const[Kn,ui]=Zt[ai],Qi=a.createExpression(ui),Hi=a.createExpression("string"==typeof Kn?[Kn,["accumulated"],["get",ai]]:Kn);on[ai]=Qi.value,sn[ai]=Hi.value}return tt.map=ai=>{Nn.properties=ai;const Kn={};for(const ui of Wn)Kn[ui]=on[ui].evaluate(gn,Nn);return Kn},tt.reduce=(ai,Kn)=>{Nn.properties=Kn;for(const ui of Wn)gn.accumulated=ai[ui],ai[ui]=sn[ui].evaluate(gn,Nn)},tt}(K)).load(vt.features):new Gr(tt=vt,K.geojsonVtOptions)}catch(tt){return F(tt)}this.loaded={};const kt={};if(_e){const tt=a.getPerformanceMeasurement(fe);tt&&(kt.resourceTiming={},kt.resourceTiming[K.source]=JSON.parse(JSON.stringify(tt)))}F(null,kt)}var tt})}reloadTile(K,F){const fe=this.loaded;return fe&&fe[K.uid]?super.reloadTile(K,F):this.loadTile(K,F)}loadGeoJSON(K,F){if(K.request)a.getJSON(K.request,F);else{if("string"!=typeof K.data)return F(new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`));try{return F(null,JSON.parse(K.data))}catch{return F(new Error(`Input data given to '${K.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(K,F){try{F(null,this._geoJSONIndex.getClusterExpansionZoom(K.clusterId))}catch(fe){F(fe)}}getClusterChildren(K,F){try{F(null,this._geoJSONIndex.getChildren(K.clusterId))}catch(fe){F(fe)}}getClusterLeaves(K,F){try{F(null,this._geoJSONIndex.getLeaves(K.clusterId,K.limit,K.offset))}catch(fe){F(fe)}}}class ur{constructor(K){this.self=K,this.actor=new a.Actor(K,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:Xi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(F,fe)=>{if(this.workerSourceTypes[F])throw new Error(`Worker source with name "${F}" already registered.`);this.workerSourceTypes[F]=fe},this.self.registerRTLTextPlugin=F=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=F.applyArabicShaping,a.plugin.processBidirectionalText=F.processBidirectionalText,a.plugin.processStyledBidirectionalText=F.processStyledBidirectionalText}}clearCaches(K,F,fe){delete this.layerIndexes[K],delete this.availableImages[K],delete this.workerSources[K],delete this.demWorkerSources[K],fe()}checkIfReady(K,F,fe){fe()}setReferrer(K,F){this.referrer=F}spriteLoaded(K,F){this.isSpriteLoaded[K]=F;for(const fe in this.workerSources[K]){const _e=this.workerSources[K][fe];for(const Qe in _e)_e[Qe]instanceof a.VectorTileWorkerSource&&(_e[Qe].isSpriteLoaded=F,_e[Qe].fire(new a.Event("isSpriteLoaded")))}}setImages(K,F,fe){this.availableImages[K]=F;for(const _e in this.workerSources[K]){const Qe=this.workerSources[K][_e];for(const vt in Qe)Qe[vt].availableImages=F}fe()}enableTerrain(K,F,fe){this.terrain=F,fe()}setProjection(K,F){this.projections[K]=a.getProjection(F)}setLayers(K,F,fe){this.getLayerIndex(K).replace(F),fe()}updateLayers(K,F,fe){this.getLayerIndex(K).update(F.layers,F.removedIds),fe()}loadTile(K,F,fe){const _e=this.enableTerrain?a.extend({enableTerrain:this.terrain},F):F;_e.projection=this.projections[K]||this.defaultProjection,this.getWorkerSource(K,F.type,F.source).loadTile(_e,fe)}loadDEMTile(K,F,fe){const _e=this.enableTerrain?a.extend({buildQuadTree:this.terrain},F):F;this.getDEMWorkerSource(K,F.source).loadTile(_e,fe)}reloadTile(K,F,fe){const _e=this.enableTerrain?a.extend({enableTerrain:this.terrain},F):F;_e.projection=this.projections[K]||this.defaultProjection,this.getWorkerSource(K,F.type,F.source).reloadTile(_e,fe)}abortTile(K,F,fe){this.getWorkerSource(K,F.type,F.source).abortTile(F,fe)}removeTile(K,F,fe){this.getWorkerSource(K,F.type,F.source).removeTile(F,fe)}removeSource(K,F,fe){if(!this.workerSources[K]||!this.workerSources[K][F.type]||!this.workerSources[K][F.type][F.source])return;const _e=this.workerSources[K][F.type][F.source];delete this.workerSources[K][F.type][F.source],void 0!==_e.removeSource?_e.removeSource(F,fe):fe()}loadWorkerSource(K,F,fe){try{this.self.importScripts(F.url),fe()}catch(_e){fe(_e.toString())}}syncRTLPluginState(K,F,fe){try{a.plugin.setState(F);const _e=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&null!=_e){this.self.importScripts(_e);const Qe=a.plugin.isParsed();fe(Qe?void 0:new Error(`RTL Text Plugin failed to import scripts from ${_e}`),Qe)}}catch(_e){fe(_e.toString())}}getAvailableImages(K){let F=this.availableImages[K];return F||(F=[]),F}getLayerIndex(K){let F=this.layerIndexes[K];return F||(F=this.layerIndexes[K]=new p),F}getWorkerSource(K,F,fe){return this.workerSources[K]||(this.workerSources[K]={}),this.workerSources[K][F]||(this.workerSources[K][F]={}),this.workerSources[K][F][fe]||(this.workerSources[K][F][fe]=new this.workerSourceTypes[F]({send:(_e,Qe,vt,kt,tt,Zt)=>{this.actor.send(_e,Qe,vt,K,tt,Zt)},scheduler:this.actor.scheduler},this.getLayerIndex(K),this.getAvailableImages(K),this.isSpriteLoaded[K])),this.workerSources[K][F][fe]}getDEMWorkerSource(K,F){return this.demWorkerSources[K]||(this.demWorkerSources[K]={}),this.demWorkerSources[K][F]||(this.demWorkerSources[K][F]=new Q),this.demWorkerSources[K][F]}enforceCacheSizeLimit(K,F){a.enforceCacheSizeLimit(F)}getWorkerPerformanceMetrics(K,F,fe){fe(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new ur(self)),ur}),c(0,function(a){var O=A;function A(g){return n=g,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,x,T=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(T);try{x=new Worker(I),_=!0}catch{_=!1}return x&&x.terminate(),URL.revokeObjectURL(I),_}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var _=document.createElement("canvas");_.width=_.height=1;var x=_.getContext("2d");if(!x)return!1;var T=x.getImageData(0,0,1,1);return T&&T.width===_.width}()||(void 0===p[u=n&&n.failIfMajorPerformanceCaveat]&&(p[u]=function(_){var x,I,B,J,T=(I=_,B=document.createElement("canvas"),(J=Object.create(A.webGLContextAttributes)).failIfMajorPerformanceCaveat=I,B.getContext("webgl",J)||B.getContext("experimental-webgl",J));if(!T)return!1;try{x=T.createShader(T.VERTEX_SHADER)}catch{return!1}return!(!x||T.isContextLost())&&(T.shaderSource(x,"void main() {}"),T.compileShader(x),!0===T.getShaderParameter(x,T.COMPILE_STATUS))}(u)),!p[u]||document.documentMode));var n,u}var p={};function L(g,n){var u=n[0],_=n[1],x=n[2],T=n[3],I=u*T-x*_;return I?(g[0]=T*(I=1/I),g[1]=-_*I,g[2]=-x*I,g[3]=u*I,g):null}function Q(g,n){if(Array.isArray(g)){if(!Array.isArray(n)||g.length!==n.length)return!1;for(let u=0;u<g.length;u++)if(!Q(g[u],n[u]))return!1;return!0}if("object"==typeof g&&null!==g&&null!==n){if("object"!=typeof n||Object.keys(g).length!==Object.keys(n).length)return!1;for(const u in g)if(!Q(g[u],n[u]))return!1;return!0}return g===n}A.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const Z={create:function(g,n,u){const _=a.window.document.createElement(g);return void 0!==n&&(_.className=n),u&&u.appendChild(_),_},createSVG:function(g,n,u){const _=a.window.document.createElementNS("http://www.w3.org/2000/svg",g);for(const x of Object.keys(n))_.setAttributeNS(null,x,n[x]);return u&&u.appendChild(_),_}},z=a.window.document&&a.window.document.documentElement.style,G=z&&void 0!==z.userSelect?"userSelect":"WebkitUserSelect";let te;Z.disableDrag=function(){z&&G&&(te=z[G],z[G]="none")},Z.enableDrag=function(){z&&G&&(z[G]=te)};const ye=function(g){g.preventDefault(),g.stopPropagation(),a.window.removeEventListener("click",ye,!0)};function me(g,n,u){const _=g.offsetWidth===n.width?1:g.offsetWidth/n.width;return new a.pointGeometry((u.clientX-n.left)*_,(u.clientY-n.top)*_)}function Ee(g){const{userImage:n}=g;return!!(n&&n.render&&n.render())&&(g.data.replace(new Uint8Array(n.data.buffer)),!0)}Z.suppressClick=function(){a.window.addEventListener("click",ye,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",ye,!0)},0)},Z.mousePos=function(g,n){const u=g.getBoundingClientRect();return me(g,u,n)},Z.touchPos=function(g,n){const u=g.getBoundingClientRect(),_=[];for(let x=0;x<n.length;x++)_.push(me(g,u,n[x]));return _},Z.mouseButton=function(g){return void 0!==a.window.InstallTrigger&&2===g.button&&g.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button};class je extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:u,callback:_}of this.requestors)this._notify(u,_);this.requestors=[]}}getImage(n){return this.images[n]}addImage(n,u){this._validate(n,u)&&(this.images[n]=u)}_validate(n,u){let _=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),_=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),_=!1),this._validateContent(u.content,u)||(this.fire(new a.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),_=!1),_}_validateStretch(n,u){if(!n)return!0;let _=0;for(const x of n){if(x[0]<_||x[1]<x[0]||u<x[1])return!1;_=x[1]}return!0}_validateContent(n,u){return!(n&&(4!==n.length||n[0]<0||u.data.width<n[0]||n[1]<0||u.data.height<n[1]||n[2]<0||u.data.width<n[2]||n[3]<0||u.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,u){u.version=this.images[n].version+1,this.images[n]=u,this.updatedImages[n]=!0}removeImage(n){const u=this.images[n];delete this.images[n],delete this.patterns[n],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,u){let _=!0;if(!this.isLoaded())for(const x of n)this.images[x]||(_=!1);this.isLoaded()||_?this._notify(n,u):this.requestors.push({ids:n,callback:u})}_notify(n,u){const _={};for(const x of n){this.images[x]||this.fire(new a.Event("styleimagemissing",{id:x}));const T=this.images[x];T?_[x]={data:T.data.clone(),pixelRatio:T.pixelRatio,sdf:T.sdf,version:T.version,stretchX:T.stretchX,stretchY:T.stretchY,content:T.content,hasRenderCallback:Boolean(T.userImage&&T.userImage.render)}:a.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,_)}getPixelSize(){const{width:n,height:u}=this.atlasImage;return{width:n,height:u}}getPattern(n){const u=this.patterns[n],_=this.getImage(n);if(!_)return null;if(u&&u.position.version===_.version)return u.position;if(u)u.position.version=_.version;else{const x={w:_.data.width+2,h:_.data.height+2,x:0,y:0},T=new a.ImagePosition(x,_);this.patterns[n]={bin:x,position:T}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const u=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(n,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const T in this.patterns)n.push(this.patterns[T].bin);const{w:u,h:_}=a.potpack(n),x=this.atlasImage;x.resize({width:u||1,height:_||1});for(const T in this.patterns){const{bin:I}=this.patterns[T],B=I.x+1,J=I.y+1,oe=this.images[T].data,ce=oe.width,ge=oe.height;a.RGBAImage.copy(oe,x,{x:0,y:0},{x:B,y:J},{width:ce,height:ge}),a.RGBAImage.copy(oe,x,{x:0,y:ge-1},{x:B,y:J-1},{width:ce,height:1}),a.RGBAImage.copy(oe,x,{x:0,y:0},{x:B,y:J+ge},{width:ce,height:1}),a.RGBAImage.copy(oe,x,{x:ce-1,y:0},{x:B-1,y:J},{width:1,height:ge}),a.RGBAImage.copy(oe,x,{x:0,y:0},{x:B+ce,y:J},{width:1,height:ge})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const u of n){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const _=this.images[u];Ee(_)&&this.updateImage(u,_)}}}const rt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(g,n){return function([u,_,x]){const T=a.degToRad(_+90),I=a.degToRad(x);return{x:u*Math.cos(T)*Math.sin(I),y:u*Math.sin(T)*Math.sin(I),z:u*Math.cos(I),azimuthal:_,polar:x}}(g.expression.evaluate(n))}interpolate(g,n,u){return{x:a.number(g.x,n.x,u),y:a.number(g.y,n.y,u),z:a.number(g.z,n.z,u),azimuthal:a.number(g.azimuthal,n.azimuthal,u),polar:a.number(g.polar,n.polar,u)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),Ae="-transition";class Ze extends a.Evented{constructor(n){super(),this._transitionable=new a.Transitionable(rt),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,u={}){if(!this._validate(a.validateLight,n,u))for(const _ in n){const x=n[_];a.endsWith(_,Ae)?this._transitionable.setTransition(_.slice(0,-Ae.length),x):this._transitionable.setValue(_,x)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,_){return(!_||!1!==_.validate)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Ve=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),He="-transition";class Ne extends a.Evented{constructor(n,u){super(),this._transitionable=new a.Transitionable(Ve),this.set(n),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=u}get(){return this._transitionable.serialize()}set(n){for(const u in n){const _=n[u];a.endsWith(u,He)?this._transitionable.setTransition(u.slice(0,-He.length),_):this._transitionable.setValue(u,_)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}}function xt(g,n,u,_){const x=a.smoothstep(45,65,u),[T,I]=Je(g,_),B=a.length(n);let J=1-Math.min(1,Math.exp((B-T)/(I-T)*-6));return J*=J*J,J=Math.min(1,1.00747*J),J*x*g.alpha}function Je(g,n){const u=.5/Math.tan(.5*n);return[g.range[0]+u,g.range[1]+u]}const ct=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"])}),wt="-transition";class Tt extends a.Evented{constructor(n,u){super(),this._transitionable=new a.Transitionable(ct),this.set(n),this._transitioning=this._transitionable.untransitioned(),this._transform=u}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,u={}){if(!this._validate(a.validateFog,n,u))for(const _ in n){const x=n[_];a.endsWith(_,wt)?this._transitionable.setTransition(_.slice(0,-wt.length),x):this._transitionable.setValue(_,x)}}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const u=this.properties&&this.properties.get("color")||1;return a.smoothstep(45,65,n)*u.a}getOpacityAtLatLng(n,u){return this._transform.projection.supportsFog?function(_,x,T){const I=a.MercatorCoordinate.fromLngLat(x),B=T.elevation?T.elevation.getAtPointOrZero(I):0,J=[I.x,I.y,B];return a.transformMat4(J,J,T.mercatorFogMatrix),xt(_,J,T.pitch,T._fov)}(this.state,n,u):0}getFovAdjustedRange(n){return this._transform.projection.supportsFog?Je(this.state,n):[0,1]}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,u,_){return(!_||!1!==_.validate)&&a.emitValidationErrors(this,n.call(a.validateStyle,a.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class Ct{constructor(n,u){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const _=this.workerPool.acquire(this.id);for(let x=0;x<_.length;x++){const T=new Ct.Actor(_[x],u,this.id);T.name=`Worker ${x}`,this.actors.push(T)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,u,_){a.asyncAll(this.actors,(x,T)=>{x.send(n,u,T)},_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function gt(g,n,u){return n*(a.EXTENT/(g.tileSize*Math.pow(2,u-g.tileID.overscaledZ)))}Ct.Actor=a.Actor;class Lt{constructor(n,u,_){this.context=n;const x=n.gl;this.buffer=x.createBuffer(),this.dynamicDraw=Boolean(_),this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ht={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Vn{constructor(n,u,_,x){this.length=u.length,this.attributes=_,this.itemSize=u.bytesPerElement,this.dynamicDraw=x,this.context=n;const T=n.gl;this.buffer=T.createBuffer(),n.bindVertexBuffer.set(this.buffer),T.bufferData(T.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,u){for(let _=0;_<this.attributes.length;_++){const x=u.attributes[this.attributes[_].name];void 0!==x&&n.enableVertexAttribArray(x)}}setVertexAttribPointers(n,u,_){for(let x=0;x<this.attributes.length;x++){const T=this.attributes[x],I=u.attributes[T.name];void 0!==I&&n.vertexAttribPointer(I,T.components,n[Ht[T.type]],!1,this.itemSize,T.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Ft{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Wt extends Ft{getDefault(){return a.Color.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class Gt extends Ft{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Jt extends Ft{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class an extends Ft{getDefault(){return[!0,!0,!0,!0]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Jn extends Ft{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class si extends Ft{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class di extends Ft{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const u=this.current;(n.func!==u.func||n.ref!==u.ref||n.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class Bn extends Ft{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class ln extends Ft{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=n,this.dirty=!1}}class Et extends Ft{getDefault(){return[0,1]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Kt extends Ft{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=n,this.dirty=!1}}class Hn extends Ft{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class In extends Ft{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.BLEND):u.disable(u.BLEND),this.current=n,this.dirty=!1}}class ti extends Ft{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class mi extends Ft{getDefault(){return a.Color.transparent}set(n){const u=this.current;(n.r!==u.r||n.g!==u.g||n.b!==u.b||n.a!==u.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ir extends Ft{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class _r extends Ft{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;n?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=n,this.dirty=!1}}class er extends Ft{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Ri extends Ft{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}class mr extends Ft{getDefault(){return null}set(n){(n!==this.current||this.dirty)&&(this.gl.useProgram(n),this.current=n,this.dirty=!1)}}class Si extends Ft{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class ki extends Ft{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const u=this.current;(n[0]!==u[0]||n[1]!==u[1]||n[2]!==u[2]||n[3]!==u[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class Qt extends Ft{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class et extends Ft{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class de extends Ft{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Pe extends Ft{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ft extends Ft{getDefault(){return null}set(n){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class Be extends Ft{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class $t extends Ft{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class xe extends Ft{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class Ie extends Ft{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Ut extends Ft{constructor(n,u){super(n),this.context=n,this.parent=u}getDefault(){return null}}class nn extends Ut{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class ni extends Ut{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class cr extends ni{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Li{constructor(n,u,_,x){this.context=n,this.width=u,this.height=_;const T=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new nn(n,T),x&&(this.depthAttachment=new ni(n,T))}destroy(){const n=this.context.gl,u=this.colorAttachment.get();if(u&&n.deleteTexture(u),this.depthAttachment){const _=this.depthAttachment.get();_&&n.deleteRenderbuffer(_)}n.deleteFramebuffer(this.framebuffer)}}class Ei{constructor(n){this.gl=n,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new Wt(this),this.clearDepth=new Gt(this),this.clearStencil=new Jt(this),this.colorMask=new an(this),this.depthMask=new Jn(this),this.stencilMask=new si(this),this.stencilFunc=new di(this),this.stencilOp=new Bn(this),this.stencilTest=new ln(this),this.depthRange=new Et(this),this.depthTest=new Kt(this),this.depthFunc=new Hn(this),this.blend=new In(this),this.blendFunc=new ti(this),this.blendColor=new mi(this),this.blendEquation=new ir(this),this.cullFace=new _r(this),this.cullFaceSide=new er(this),this.frontFace=new Ri(this),this.program=new mr(this),this.activeTexture=new Si(this),this.viewport=new ki(this),this.bindFramebuffer=new Qt(this),this.bindRenderbuffer=new et(this),this.bindTexture=new de(this),this.bindVertexBuffer=new Pe(this),this.bindElementBuffer=new ft(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new Be(this),this.pixelStoreUnpack=new $t(this),this.pixelStoreUnpackPremultiplyAlpha=new xe(this),this.pixelStoreUnpackFlipY=new Ie(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=n.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(n.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,u){return new Lt(this,n,u)}createVertexBuffer(n,u,_){return new Vn(this,n,u,_)}createRenderbuffer(n,u,_){const x=this.gl,T=x.createRenderbuffer();return this.bindRenderbuffer.set(T),x.renderbufferStorage(x.RENDERBUFFER,n,u,_),this.bindRenderbuffer.set(null),T}createFramebuffer(n,u,_){return new Li(this,n,u,_)}clear({color:n,depth:u,stencil:_}){const x=this.gl;let T=0;n&&(T|=x.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(T|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==_&&(T|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),x.clear(T)}setCullFace(n){!1===n.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){Q(n.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class xi{constructor(n,u,_,x){this.screenBounds=n,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(T=>x.pointCoordinate3D(T)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(n,u){let _,x;if(n instanceof a.pointGeometry||"number"==typeof n[0]){const T=a.pointGeometry.convert(n);_=[a.pointGeometry.convert(n)],x=u.isPointAboveHorizon(T)}else{const T=a.pointGeometry.convert(n[0]),I=a.pointGeometry.convert(n[1]);_=[T,I],x=a.polygonizeBounds(T,I).every(B=>u.isPointAboveHorizon(B))}return new xi(_,u.getCameraPoint(),x,u)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(n){return a.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const u=this.screenBounds[0],_=1===this.screenBounds.length?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],x=a.polygonizeBounds(u,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<_.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?x[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(x[3]=this.cameraPoint)),a.bufferConvexPolygon(x,n)}containsTile(n,u,_){const x=n.queryPadding+1,T=n.tileID.wrap,I=_?this._bufferedCameraMercator(x,u).map($e=>a.getTilePoint(n.tileTransform,$e,T)):this._bufferedScreenMercator(x,u).map($e=>a.getTilePoint(n.tileTransform,$e,T)),B=this.screenGeometryMercator.map($e=>a.getTileVec3(n.tileTransform,$e,T)),J=B.map($e=>new a.pointGeometry($e[0],$e[1])),oe=u.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),ce=a.getTileVec3(n.tileTransform,oe,T),ge=B.map($e=>{const Ye=a.sub($e,$e,ce);return a.normalize(Ye,Ye),new a.Ray(ce,Ye)}),Re=gt(n,1,u.zoom);if(a.polygonIntersectsBox(I,0,0,a.EXTENT,a.EXTENT))return{queryGeometry:this,tilespaceGeometry:J,tilespaceRays:ge,bufferedTilespaceGeometry:I,bufferedTilespaceBounds:(We=a.getBounds(I),We.min.x=a.clamp(We.min.x,0,a.EXTENT),We.min.y=a.clamp(We.min.y,0,a.EXTENT),We.max.x=a.clamp(We.max.x,0,a.EXTENT),We.max.y=a.clamp(We.max.y,0,a.EXTENT),We),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:Re};var We}_bufferedScreenMercator(n,u){const _=vr(n);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{const x=this.bufferedScreenGeometry(n).map(T=>u.pointCoordinate3D(T));return this._screenRaycastCache[_]=x,x}}_bufferedCameraMercator(n,u){const _=vr(n);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{const x=this.bufferedCameraGeometry(n).map(T=>u.pointCoordinate3D(T));return this._cameraRaycastCache[_]=x,x}}}function vr(g){return 100*g|0}function ji(g,n,u){const _=function(x,T){if(x)return u(x);if(T){const I=a.pick(a.extend(T,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);T.vector_layers&&(I.vectorLayers=T.vector_layers,I.vectorLayerIds=I.vectorLayers.map(B=>B.id)),I.tiles=n.canonicalizeTileset(I,g.url),u(null,I)}};return g.url?a.getJSON(n.transformRequest(n.normalizeSourceURL(g.url),a.ResourceType.Source),_):a.exported.frame(()=>_(null,g))}class Ir{constructor(n,u,_){this.bounds=a.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=u||0,this.maxzoom=_||24}validateBounds(n){return Array.isArray(n)&&4===n.length?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const u=Math.pow(2,n.z),_=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*u),x=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*u),T=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*u),I=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*u);return n.x>=_&&n.x<T&&n.y>=x&&n.y<I}}class $i extends a.Evented{constructor(n,u,_,x){super(),this.id=n,this.dispatcher=_,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},u),a.extend(this,a.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ji(this._options,this.map._requestManager,(n,u)=>{this._tileJSONRequest=null,this._loaded=!0,n?this.fire(new a.ErrorEvent(n)):u&&(a.extend(this,u),u.bounds&&(this.tileBounds=new Ir(u.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(u.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,u){const _=a.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);n.request=a.getImage(this.map._requestManager.transformRequest(x,a.ResourceType.Tile),(T,I,B,J)=>{if(delete n.request,n.aborted)n.state="unloaded",u(null);else if(T)n.state="errored",u(T);else if(I){this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:B,expires:J});const oe=this.map.painter.context,ce=oe.gl;n.texture=this.map.painter.getTileTexture(I.width),n.texture?n.texture.update(I,{useMipmap:!0}):(n.texture=new a.Texture(oe,I,ce.RGBA,{useMipmap:!0}),n.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE),oe.extTextureFilterAnisotropic&&ce.texParameterf(ce.TEXTURE_2D,oe.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,oe.extTextureFilterAnisotropicMax)),n.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),u(null)}})}abortTile(n,u){n.request&&(n.request.cancel(),delete n.request),u()}unloadTile(n,u){n.texture&&this.map.painter.saveTileTexture(n.texture),u()}hasTransition(){return!1}}let Gr;function eo(g,n,u,_,x,T,I,B){const J=[g,u,x,n,_,T,1,1,1],oe=[I,B,1],ce=a.adjoint([],J),[ge,Re,We]=a.transformMat3(oe,oe,a.transpose(ce,ce));return a.multiply(J,[ge,0,0,0,Re,0,0,0,We],J)}class zr extends a.Evented{constructor(n,u,_,x){super(),this.id=n,this.dispatcher=_,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=u}load(n,u){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(_,x)=>{this._loaded=!0,_?this.fire(new a.ErrorEvent(_)):x&&(this.image=a.exported.getImageData(x),this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),u&&u(),this._finishLoading())})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this.options.url=n.url,this.load(n.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}setCoordinates(n){this.coordinates=n,delete this._boundsArray;const u=n.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(_){let x=1/0,T=1/0,I=-1/0,B=-1/0;for(const ge of _)x=Math.min(x,ge.x),T=Math.min(T,ge.y),I=Math.max(I,ge.x),B=Math.max(B,ge.y);const J=Math.max(I-x,B-T),oe=Math.max(0,Math.floor(-Math.log(J)/Math.LN2)),ce=Math.pow(2,oe);return new a.CanonicalTileID(oe,Math.floor((x+I)/2*ce),Math.floor((T+B)/2*ce))}(u),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){delete this._boundsArray}_makeBoundsArray(){const n=a.tileTransform(this.tileID,this.map.transform.projection),[u,_,x,T]=this.coordinates.map(I=>{const B=n.projection.project(I[0],I[1]);return a.getTilePoint(n,B)._round()});return this.perspectiveTransform=function(I,B,J,oe,ce,ge,Re,We,$e,Ye){const mt=eo(0,0,I,0,0,B,I,B),Ge=eo(J,oe,ce,ge,Re,We,$e,Ye);return a.multiply(Ge,a.adjoint(mt,mt),Ge),[Ge[6]/Ge[8]*I/a.EXTENT,Ge[7]/Ge[8]*B/a.EXTENT]}(this.width,this.height,u.x,u.y,_.x,_.y,T.x,T.y,x.x,x.y),this._boundsArray=new a.StructArrayLayout4i8,this._boundsArray.emplaceBack(u.x,u.y,0,0),this._boundsArray.emplaceBack(_.x,_.y,a.EXTENT,0),this._boundsArray.emplaceBack(T.x,T.y,0,a.EXTENT),this._boundsArray.emplaceBack(x.x,x.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const n=this.map.painter.context,u=n.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new a.Texture(n,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));for(const _ in this.tiles){const x=this.tiles[_];"loaded"!==x.state&&(x.state="loaded",x.texture=this.texture)}}loadTile(n,u){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},u(null)):(n.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Xi={vector:class extends a.Evented{constructor(g,n,u,_){if(super(),this.id=g,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(n,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},n),this._collectResourceTiming=n.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(_),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=ji(this._options,this.map._requestManager,(g,n)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new a.ErrorEvent(g)):n&&(a.extend(this,n),n.bounds&&(this.tileBounds=new Ir(n.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(n.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}onAdd(g){this.map=g,this.load()}setSourceProperty(g){this._tileJSONRequest&&this._tileJSONRequest.cancel(),g();const n=this.map.style._getSourceCaches(this.id);for(const u of n)u.clearTiles();this.load()}setTiles(g){return this.setSourceProperty(()=>{this._options.tiles=g}),this}setUrl(g){return this.setSourceProperty(()=>{this.url=g,this._options.url=g}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return a.extend({},this._options)}loadTile(g,n){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),_={request:this.map._requestManager.transformRequest(u,a.ResourceType.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:g.isSymbolTile};if(_.request.collectResourceTiming=this._collectResourceTiming,g.actor&&"expired"!==g.state)"loading"===g.state?g.reloadCallback=n:g.request=g.actor.send("reloadTile",_,x.bind(this));else if(g.actor=this._tileWorkers[u]=this._tileWorkers[u]||this.dispatcher.getActor(),this.dispatcher.ready)g.request=g.actor.send("loadTile",_,x.bind(this),void 0,!0);else{const T=a.loadVectorTile.call({deduped:this._deduped},_,(I,B)=>{I||!B?x.call(this,I):(_.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},g.actor&&g.actor.send("loadTile",_,x.bind(this),void 0,!0))},!0);g.request={cancel:T}}function x(T,I){return delete g.request,g.aborted?n(null):T&&404!==T.status?n(T):(I&&I.resourceTiming&&(g.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&g.setExpiryData(I),g.loadVectorData(I,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),n(null),void(g.reloadCallback&&(this.loadTile(g,g.reloadCallback),g.reloadCallback=null)))}}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.actor&&g.actor.send("abortTile",{uid:g.uid,type:this.type,source:this.id})}unloadTile(g){g.unloadVectorData(),g.actor&&g.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:$i,"raster-dem":class extends $i{constructor(g,n,u,_){super(g,n,u,_),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(g,n){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(x,T){x&&(g.state="errored",n(x)),T&&(g.dem=T,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",n(null))}g.request=a.getImage(this.map._requestManager.transformRequest(u,a.ResourceType.Tile),function(x,T,I,B){if(delete g.request,g.aborted)g.state="unloaded",n(null);else if(x)g.state="errored",n(x);else if(T){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:I,expires:B});const J=a.window.ImageBitmap&&T instanceof a.window.ImageBitmap&&(null==Gr&&(Gr=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.window.createImageBitmap),Gr),oe=1-(T.width-a.prevPowerOfTwo(T.width))/2;oe<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const ce=J?T:a.exported.getImageData(T,oe),ge={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:ce,encoding:this.encoding,padding:oe};g.actor&&"expired"!==g.state||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",ge,_.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(g){const n=g.canonical,u=Math.pow(2,n.z),_=(n.x-1+u)%u,x=0===n.x?g.wrap-1:g.wrap,T=(n.x+1+u)%u,I=n.x+1===u?g.wrap+1:g.wrap,B={};return B[new a.OverscaledTileID(g.overscaledZ,x,n.z,_,n.y).key]={backfilled:!1},B[new a.OverscaledTileID(g.overscaledZ,I,n.z,T,n.y).key]={backfilled:!1},n.y>0&&(B[new a.OverscaledTileID(g.overscaledZ,x,n.z,_,n.y-1).key]={backfilled:!1},B[new a.OverscaledTileID(g.overscaledZ,g.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},B[new a.OverscaledTileID(g.overscaledZ,I,n.z,T,n.y-1).key]={backfilled:!1}),n.y+1<u&&(B[new a.OverscaledTileID(g.overscaledZ,x,n.z,_,n.y+1).key]={backfilled:!1},B[new a.OverscaledTileID(g.overscaledZ,g.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},B[new a.OverscaledTileID(g.overscaledZ,I,n.z,T,n.y+1).key]={backfilled:!1}),B}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends a.Evented{constructor(g,n,u,_){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(_),this._data=n.data,this._options=a.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const x=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*x,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*x,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:a.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*x,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},n),this}getClusterChildren(g,n){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},n),this}getClusterLeaves(g,n,u,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:n,offset:u},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=a.extend({},this.workerOptions),n=this._data;"string"==typeof n?(g.request=this.map._requestManager.transformRequest(a.exported.resolveURL(n),a.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,(u,_)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new a.ErrorEvent(u));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(x.resourceTiming=_.resourceTiming[this.id]),this.fire(new a.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,n){const u=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(u,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(_,x)=>(delete g.request,g.unloadVectorData(),g.aborted?n(null):_?n(_):(g.loadVectorData(x,this.map.painter,"reloadTile"===u),n(null))),void 0,"loadTile"===u)}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends zr{constructor(g,n,u,_){super(g,n,u,_),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const n of g.urls)this.urls.push(this.map._requestManager.transformRequest(n,a.ResourceType.Source).url);a.getVideo(this.urls,(n,u)=>{this._loaded=!0,n?this.fire(new a.ErrorEvent(n)):u&&(this.video=u,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const n=this.video.seekable;g<n.start(0)||g>n.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const g=this.map.painter.context,n=g.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(g,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2));for(const u in this.tiles){const _=this.tiles[u];"loaded"!==_.state&&(_.state="loaded",_.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:zr,canvas:class extends zr{constructor(g,n,u,_){super(g,n,u,_),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(T=>"number"!=typeof T))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const n=this.map.painter.context,u=n.gl;this._boundsArray||this._makeBoundsArray(),this.boundsBuffer||(this.boundsBuffer=n.createVertexBuffer(this._boundsArray,a.boundsAttributes.members)),this.boundsSegments||(this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(n,this.canvas,u.RGBA,{premultiply:!0});for(const _ in this.tiles){const x=this.tiles[_];"loaded"!==x.state&&(x.state="loaded",x.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}}},ur=function(g,n,u,_){const x=new Xi[n.type](g,n,u,_);if(x.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${x.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],x),x};function re(g,n){const u=a.identity([]);return a.scale(u,u,[.5*g.width,.5*-g.height,1]),a.translate(u,u,[1,-1,0]),a.multiply$1(u,u,g.calculateProjMatrix(n.toUnwrapped()))}function K(g,n,u,_,x,T,I,B=!1){const J=g.tilesIn(_,I,B);J.sort(fe);const oe=[];for(const ge of J)oe.push({wrappedTileID:ge.tile.tileID.wrapped().key,queryResults:ge.tile.queryRenderedFeatures(n,u,g._state,ge,x,T,re(g.transform,ge.tile.tileID),B)});const ce=function(ge){const Re={},We={};for(const $e of ge){const Ye=$e.queryResults,mt=$e.wrappedTileID,Ge=We[mt]=We[mt]||{};for(const dt in Ye){const _t=Ye[dt],lt=Ge[dt]=Ge[dt]||{},ut=Re[dt]=Re[dt]||[];for(const bt of _t)lt[bt.featureIndex]||(lt[bt.featureIndex]=!0,ut.push(bt))}}return Re}(oe);for(const ge in ce)ce[ge].forEach(Re=>{const We=Re.feature,$e=g.getFeatureState(We.layer["source-layer"],We.id);We.source=We.layer.source,We.layer["source-layer"]&&(We.sourceLayer=We.layer["source-layer"]),We.state=$e});return ce}function F(g,n){const u=g.getRenderableIds().map(T=>g.getTileByID(T)),_=[],x={};for(let T=0;T<u.length;T++){const I=u[T],B=I.tileID.canonical.key;x[B]||(x[B]=!0,I.querySourceFeatures(_,n))}return _}function fe(g,n){const u=g.tileID,_=n.tileID;return u.overscaledZ-_.overscaledZ||u.canonical.y-_.canonical.y||u.wrap-_.wrap||u.canonical.x-_.canonical.x}function _e(){return null!=Rl.workerClass?new Rl.workerClass:new a.window.Worker(Rl.workerUrl)}const Qe="mapboxgl_preloaded_worker_pool";class vt{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<vt.workerCount;)this.workers.push(new _e);return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Qe]}numActive(){return Object.keys(this.active).length}}let kt;function tt(){return kt||(kt=new vt),kt}function Zt(g,n){const u={};for(const _ in g)"ref"!==_&&(u[_]=g[_]);return a.refProperties.forEach(_=>{_ in n&&(u[_]=n[_])}),u}function on(g){g=g.slice();const n=Object.create(null);for(let u=0;u<g.length;u++)n[g[u].id]=g[u];for(let u=0;u<g.length;u++)"ref"in g[u]&&(g[u]=Zt(g[u],n[g[u].ref]));return g}vt.workerCount=2;const sn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function gn(g,n,u){u.push({command:sn.addSource,args:[g,n[g]]})}function Nn(g,n,u){n.push({command:sn.removeSource,args:[g]}),u[g]=!0}function Wn(g,n,u,_){Nn(g,u,_),gn(g,n,u)}function ai(g,n,u){let _;for(_ in g[u])if(g[u].hasOwnProperty(_)&&"data"!==_&&!Q(g[u][_],n[u][_]))return!1;for(_ in n[u])if(n[u].hasOwnProperty(_)&&"data"!==_&&!Q(g[u][_],n[u][_]))return!1;return!0}function Kn(g,n,u,_,x,T){let I;for(I in n=n||{},g=g||{})g.hasOwnProperty(I)&&(Q(g[I],n[I])||u.push({command:T,args:[_,I,n[I],x]}));for(I in n)n.hasOwnProperty(I)&&!g.hasOwnProperty(I)&&(Q(g[I],n[I])||u.push({command:T,args:[_,I,n[I],x]}))}function ui(g){return g.id}function Qi(g,n){return g[n.id]=n,g}class Hi{constructor(n,u){this.reset(n,u)}reset(n,u){this.points=n||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(1===this.points.length)return this.points[0];n=a.clamp(n,0,1);let u=1,_=this._distances[u];const x=n*this.paddedLength+this.padding;for(;_<x&&u<this._distances.length;)_=this._distances[++u];const T=u-1,I=this._distances[T],B=_-I,J=B>0?(x-I)/B:0;return this.points[T].mult(1-J).add(this.points[u].mult(J))}}class vi{constructor(n,u,_){const x=this.boxCells=[],T=this.circleCells=[];this.xCellCount=Math.ceil(n/_),this.yCellCount=Math.ceil(u/_);for(let I=0;I<this.xCellCount*this.yCellCount;I++)x.push([]),T.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=u,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,u,_,x,T){this._forEachCell(u,_,x,T,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(u),this.bboxes.push(_),this.bboxes.push(x),this.bboxes.push(T)}insertCircle(n,u,_,x){this._forEachCell(u-x,_-x,u+x,_+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(u),this.circles.push(_),this.circles.push(x)}_insertBoxCell(n,u,_,x,T,I){this.boxCells[T].push(I)}_insertCircleCell(n,u,_,x,T,I){this.circleCells[T].push(I)}_query(n,u,_,x,T,I){if(_<0||n>this.width||x<0||u>this.height)return!T&&[];const B=[];if(n<=0&&u<=0&&this.width<=_&&this.height<=x){if(T)return!0;for(let J=0;J<this.boxKeys.length;J++)B.push({key:this.boxKeys[J],x1:this.bboxes[4*J],y1:this.bboxes[4*J+1],x2:this.bboxes[4*J+2],y2:this.bboxes[4*J+3]});for(let J=0;J<this.circleKeys.length;J++){const oe=this.circles[3*J],ce=this.circles[3*J+1],ge=this.circles[3*J+2];B.push({key:this.circleKeys[J],x1:oe-ge,y1:ce-ge,x2:oe+ge,y2:ce+ge})}return I?B.filter(I):B}return this._forEachCell(n,u,_,x,this._queryCell,B,{hitTest:T,seenUids:{box:{},circle:{}}},I),T?B.length>0:B}_queryCircle(n,u,_,x,T){const I=n-_,B=n+_,J=u-_,oe=u+_;if(B<0||I>this.width||oe<0||J>this.height)return!x&&[];const ce=[];return this._forEachCell(I,J,B,oe,this._queryCellCircle,ce,{hitTest:x,circle:{x:n,y:u,radius:_},seenUids:{box:{},circle:{}}},T),x?ce.length>0:ce}query(n,u,_,x,T){return this._query(n,u,_,x,!1,T)}hitTest(n,u,_,x,T){return this._query(n,u,_,x,!0,T)}hitTestCircle(n,u,_,x){return this._queryCircle(n,u,_,!0,x)}_queryCell(n,u,_,x,T,I,B,J){const oe=B.seenUids,ce=this.boxCells[T];if(null!==ce){const Re=this.bboxes;for(const We of ce)if(!oe.box[We]){oe.box[We]=!0;const $e=4*We;if(n<=Re[$e+2]&&u<=Re[$e+3]&&_>=Re[$e+0]&&x>=Re[$e+1]&&(!J||J(this.boxKeys[We]))){if(B.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[We],x1:Re[$e],y1:Re[$e+1],x2:Re[$e+2],y2:Re[$e+3]})}}}const ge=this.circleCells[T];if(null!==ge){const Re=this.circles;for(const We of ge)if(!oe.circle[We]){oe.circle[We]=!0;const $e=3*We;if(this._circleAndRectCollide(Re[$e],Re[$e+1],Re[$e+2],n,u,_,x)&&(!J||J(this.circleKeys[We]))){if(B.hitTest)return I.push(!0),!0;{const Ye=Re[$e],mt=Re[$e+1],Ge=Re[$e+2];I.push({key:this.circleKeys[We],x1:Ye-Ge,y1:mt-Ge,x2:Ye+Ge,y2:mt+Ge})}}}}}_queryCellCircle(n,u,_,x,T,I,B,J){const oe=B.circle,ce=B.seenUids,ge=this.boxCells[T];if(null!==ge){const We=this.bboxes;for(const $e of ge)if(!ce.box[$e]){ce.box[$e]=!0;const Ye=4*$e;if(this._circleAndRectCollide(oe.x,oe.y,oe.radius,We[Ye+0],We[Ye+1],We[Ye+2],We[Ye+3])&&(!J||J(this.boxKeys[$e])))return I.push(!0),!0}}const Re=this.circleCells[T];if(null!==Re){const We=this.circles;for(const $e of Re)if(!ce.circle[$e]){ce.circle[$e]=!0;const Ye=3*$e;if(this._circlesCollide(We[Ye],We[Ye+1],We[Ye+2],oe.x,oe.y,oe.radius)&&(!J||J(this.circleKeys[$e])))return I.push(!0),!0}}}_forEachCell(n,u,_,x,T,I,B,J){const oe=this._convertToXCellCoord(n),ce=this._convertToYCellCoord(u),ge=this._convertToXCellCoord(_),Re=this._convertToYCellCoord(x);for(let We=oe;We<=ge;We++)for(let $e=ce;$e<=Re;$e++)if(T.call(this,n,u,_,x,this.xCellCount*$e+We,I,B,J))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,u,_,x,T,I){const B=x-n,J=T-u,oe=_+I;return oe*oe>B*B+J*J}_circleAndRectCollide(n,u,_,x,T,I,B){const J=(I-x)/2,oe=Math.abs(n-(x+J));if(oe>J+_)return!1;const ce=(B-T)/2,ge=Math.abs(u-(T+ce));if(ge>ce+_)return!1;if(oe<=J||ge<=ce)return!0;const Re=oe-J,We=ge-ce;return Re*Re+We*We<=_*_}}const Pn=Math.tan(85*Math.PI/180);function Ai(g,n,u,_,x,T){let I=a.create();if(u){if("globe"===x.projection.name)I=a.calculateGlobeMatrix(x,x.worldSize/x._projectionScaler,[0,0]),a.multiply$1(I,I,a.globeDenormalizeECEF(a.globeTileBounds(n)));else{const B=L([],T);I[0]=B[0],I[1]=B[1],I[4]=B[2],I[5]=B[3]}_||a.rotateZ(I,I,x.angle)}else a.multiply$1(I,x.labelPlaneMatrix,g);return I}function Bi(g,n,u,_,x,T){if(u){if("globe"===x.projection.name){const I=Ai(g,n,u,_,x,T);return a.invert(I,I),a.multiply$1(I,g,I),I}{const I=a.clone(g),B=a.identity([]);return B[0]=T[0],B[1]=T[1],B[4]=T[2],B[5]=T[3],a.multiply$1(I,I,B),_||a.rotateZ(I,I,-x.angle),I}}return x.glCoordMatrix}function Gi(g,n,u=0){const _=[g.x,g.y,u,1];u?a.transformMat4$1(_,_,n):Sr(_,_,n);const x=_[3];return{point:new a.pointGeometry(_[0]/x,_[1]/x),signedDistanceFromCamera:x}}function Ar(g,n){return Math.min(.5+g/n*.5,1.5)}function hi(g,n){const u=g[0]/g[3],_=g[1]/g[3];return u>=-n[0]&&u<=n[0]&&_>=-n[1]&&_<=n[1]}function Cr(g,n,u,_,x,T,I,B,J,oe){const ce=u.transform,ge=_?g.textSizeData:g.iconSizeData,Re=a.evaluateSizeForZoom(ge,u.transform.zoom),We=[256/u.width*2+1,256/u.height*2+1],$e=_?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;$e.clear();const Ye=g.lineVertexArray,mt=_?g.text.placedSymbolArray:g.icon.placedSymbolArray,Ge=u.transform.width/u.transform.height;let dt=!1;for(let _t=0;_t<mt.length;_t++){const lt=mt.get(_t);if(lt.writingMode!==a.WritingMode.vertical||dt||0!==_t&&mt.get(_t-1).writingMode===a.WritingMode.horizontal||(dt=!0),lt.hidden||lt.writingMode===a.WritingMode.vertical&&!dt){Lr(lt.numGlyphs,$e);continue}dt=!1;const ut=new a.pointGeometry(lt.tileAnchorX,lt.tileAnchorY),bt=J?J(ut):[0,0,0],qt=ce.projection.projectTilePoint(ut.x,ut.y,oe.canonical),cn=[qt.x+bt[0],qt.y+bt[1],qt.z+bt[2]],Gn=[...cn,1];if(a.transformMat4$1(Gn,Gn,n),!hi(Gn,We)){Lr(lt.numGlyphs,$e);continue}const On=Ar(u.transform.cameraToCenterDistance,Gn[3]),Sn=a.evaluateSizeForFeature(ge,Re,lt),mn=I?Sn/On:Sn*On,Xt=Gi(new a.pointGeometry(cn[0],cn[1]),x,cn[2]);if(Xt.signedDistanceFromCamera<=0){Lr(lt.numGlyphs,$e);continue}let Cn={};const bn=I?null:J,Ti=Ao(lt,mn,!1,B,n,x,T,g.glyphOffsetArray,Ye,$e,Xt.point,ut,Cn,Ge,bn,ce.projection,oe);dt=Ti.useVertical,bn&&Ti.needsFlipping&&(Cn={}),(Ti.notEnoughRoom||dt||Ti.needsFlipping&&Ao(lt,mn,!0,B,n,x,T,g.glyphOffsetArray,Ye,$e,Xt.point,ut,Cn,Ge,bn,ce.projection,oe).notEnoughRoom)&&Lr(lt.numGlyphs,$e)}_?g.text.dynamicLayoutVertexBuffer.updateData($e):g.icon.dynamicLayoutVertexBuffer.updateData($e)}function xr(g,n,u,_,x,T,I,B,J,oe,ce,ge,Re,We,$e){const Ye=B.glyphStartIndex+B.numGlyphs,mt=B.lineStartIndex,Ge=B.lineStartIndex+B.lineLength,dt=n.getoffsetX(B.glyphStartIndex),_t=n.getoffsetX(Ye-1),lt=to(g*dt,u,_,x,T,I,B.segment,mt,Ge,J,oe,ce,ge,Re,!0,We,$e);if(!lt)return null;const ut=to(g*_t,u,_,x,T,I,B.segment,mt,Ge,J,oe,ce,ge,Re,!0,We,$e);return ut?{first:lt,last:ut}:null}function qr(g,n,u,_){return g.writingMode===a.WritingMode.horizontal&&Math.abs(u.y-n.y)>Math.abs(u.x-n.x)*_?{useVertical:!0}:g.writingMode===a.WritingMode.vertical?n.y<u.y?{needsFlipping:!0}:null:0!==g.flipState&&function(x,T,I){const B=(T.x-x.x)*I;return 0===B||Math.abs((T.y-x.y)/B)>Pn}(n,u,_)?1===g.flipState?{needsFlipping:!0}:null:n.x>u.x?{needsFlipping:!0}:null}function Ao(g,n,u,_,x,T,I,B,J,oe,ce,ge,Re,We,$e,Ye,mt){const Ge=n/24,dt=g.lineOffsetX*Ge,_t=g.lineOffsetY*Ge;let lt;if(g.numGlyphs>1){const ut=g.glyphStartIndex+g.numGlyphs,bt=g.lineStartIndex,qt=g.lineStartIndex+g.lineLength,cn=xr(Ge,B,dt,_t,u,ce,ge,g,J,T,Re,$e,!1,Ye,mt);if(!cn)return{notEnoughRoom:!0};const Gn=Gi(cn.first.point,I).point,On=Gi(cn.last.point,I).point;if(_&&!u){const Sn=qr(g,Gn,On,We);if(g.flipState=Sn&&Sn.needsFlipping?1:2,Sn)return Sn}lt=[cn.first];for(let Sn=g.glyphStartIndex+1;Sn<ut-1;Sn++)lt.push(to(Ge*B.getoffsetX(Sn),dt,_t,u,ce,ge,g.segment,bt,qt,J,T,Re,$e,!1,!1,Ye,mt));lt.push(cn.last)}else{if(_&&!u){const bt=Gi(ge,x).point,qt=g.lineStartIndex+g.segment+1,cn=new a.pointGeometry(J.getx(qt),J.gety(qt)),Gn=Gi(cn,x),On=qr(g,bt,Gn.signedDistanceFromCamera>0?Gn.point:yo(ge,cn,bt,1,x,void 0,Ye,mt.canonical),We);if(g.flipState=On&&On.needsFlipping?1:2,On)return On}const ut=to(Ge*B.getoffsetX(g.glyphStartIndex),dt,_t,u,ce,ge,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,J,T,Re,$e,!1,!1,Ye,mt);if(!ut)return{notEnoughRoom:!0};lt=[ut]}for(const ut of lt)a.addDynamicAttributes(oe,ut.point,ut.angle);return{}}function Oi(g,n,u,_,x){const T=_.projectTilePoint(g.x,g.y,n);if(!x)return Gi(T,u,T.z);const I=x(g);return Gi(new a.pointGeometry(T.x+I[0],T.y+I[1]),u,T.z+I[2])}function yo(g,n,u,_,x,T,I,B){const J=Oi(g.add(g.sub(n)._unit()),B,x,I,T).point,oe=u.sub(J);return u.add(oe._mult(_/oe.mag()))}function to(g,n,u,_,x,T,I,B,J,oe,ce,ge,Re,We,$e,Ye,mt){const Ge=_?g-n:g+n;let dt=Ge>0?1:-1,_t=0;_&&(dt*=-1,_t=Math.PI),dt<0&&(_t+=Math.PI);let lt=dt>0?B+I:B+I+1,ut=x,bt=x,qt=0,cn=0;const Gn=Math.abs(Ge),On=[],Sn=[];let mn=T;const Xt=()=>{const $n=lt-dt;return 0===qt?T:new a.pointGeometry(oe.getx($n),oe.gety($n))},Cn=()=>yo(Xt(),mn,bt,Gn-qt+1,ce,Re,Ye,mt.canonical);for(;qt+cn<=Gn;){if(lt+=dt,lt<B||lt>=J)return null;if(bt=ut,On.push(ut),We&&Sn.push(mn||Xt()),ut=ge[lt],void 0===ut){mn=new a.pointGeometry(oe.getx(lt),oe.gety(lt));const $n=Oi(mn,mt.canonical,ce,Ye,Re);ut=$n.signedDistanceFromCamera>0?ge[lt]=$n.point:Cn()}else mn=null;qt+=cn,cn=bt.dist(ut)}$e&&Re&&(mn=mn||new a.pointGeometry(oe.getx(lt),oe.gety(lt)),ge[lt]=ut=void 0===ge[lt]?ut:Cn(),cn=bt.dist(ut));const bn=(Gn-qt)/cn,Ti=ut.sub(bt),Vi=Ti.mult(bn)._add(bt);u&&Vi._add(Ti._unit()._perp()._mult(u*dt));const wr=_t+Math.atan2(ut.y-bt.y,ut.x-bt.x);return On.push(Vi),We&&(mn=mn||new a.pointGeometry(oe.getx(lt),oe.gety(lt)),Sn.push(function($n,Fi,ar){const Xr=1-ar;return new a.pointGeometry($n.x*Xr+Fi.x*ar,$n.y*Xr+Fi.y*ar)}(Sn.length>0?Sn[Sn.length-1]:mn,mn,bn))),{point:Vi,angle:wr,path:On,tilePath:Sn}}const uo=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Lr(g,n){for(let u=0;u<g;u++){const _=n.length;n.resize(_+4),n.float32.set(uo,3*_)}}function Sr(g,n,u){const _=n[0],x=n[1];return g[0]=u[0]*_+u[4]*x+u[12],g[1]=u[1]*_+u[5]*x+u[13],g[3]=u[3]*_+u[7]*x+u[15],g}const Pr=100;class Se{constructor(n,u,_=new vi(n.width+200,n.height+200,25),x=new vi(n.width+200,n.height+200,25)){this.transform=n,this.grid=_,this.ignoredGrid=x,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+Pr,this.screenBottomBoundary=n.height+Pr,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=u}placeCollisionBox(n,u,_,x,T,I,B){let J=u.projectedAnchorX,oe=u.projectedAnchorY,ce=u.projectedAnchorZ;const ge=u.elevation,Re=u.tileID;if(ge&&Re){const lt=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),ut=lt.upVector(Re.canonical,u.tileAnchorX,u.tileAnchorY),bt=lt.upVectorScale(Re.canonical);J+=ut[0]*ge*bt,oe+=ut[1]*ge*bt,ce+=ut[2]*ge*bt}const We=this.projectAndGetPerspectiveRatio(I,J,oe,ce,u.tileID),$e=T*We.perspectiveRatio,Ye=(u.x1*n+_.x-u.padding)*$e+We.point.x,mt=(u.y1*n+_.y-u.padding)*$e+We.point.y,Ge=(u.x2*n+_.x+u.padding)*$e+We.point.x,dt=(u.y2*n+_.y+u.padding)*$e+We.point.y,_t=We.perspectiveRatio<=.55||We.aboveHorizon;return!this.isInsideGrid(Ye,mt,Ge,dt)||!x&&this.grid.hitTest(Ye,mt,Ge,dt,B)||_t?{box:[],offscreen:!1}:{box:[Ye,mt,Ge,dt],offscreen:this.isOffscreen(Ye,mt,Ge,dt)}}placeCollisionCircles(n,u,_,x,T,I,B,J,oe,ce,ge,Re,We,$e){const Ye=[],mt=this.transform.elevation,Ge=this.transform.projection.createTileTransform(this.transform,this.transform.worldSize),dt=mt?mt.getAtTileOffsetFunc($e,Ge):bn=>[0,0,0],_t=new a.pointGeometry(u.tileAnchorX,u.tileAnchorY),lt=this.transform.projection.projectTilePoint(u.tileAnchorX,u.tileAnchorY,$e.canonical),ut=dt(_t),bt=[lt.x+ut[0],lt.y+ut[1],lt.z+ut[2]],qt=this.projectAndGetPerspectiveRatio(I,bt[0],bt[1],bt[2],$e),{perspectiveRatio:cn}=qt,Gn=(ce?T/cn:T*cn)/a.ONE_EM,On=Gi(new a.pointGeometry(bt[0],bt[1]),B,bt[2]).point,Sn=qt.signedDistanceFromCamera>0?xr(Gn,x,u.lineOffsetX*Gn,u.lineOffsetY*Gn,!1,On,_t,u,_,B,{},mt&&!ce?dt:null,ce&&!!mt,this.transform.projection,$e):null;let mn=!1,Xt=!1,Cn=!0;if(Sn&&!qt.aboveHorizon){const bn=.5*Re*cn+We,Ti=new a.pointGeometry(-100,-100),Vi=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),wr=new Hi,$n=Sn.first,Fi=Sn.last;let ar=[];for(let or=$n.path.length-1;or>=1;or--)ar.push($n.path[or]);for(let or=1;or<Fi.path.length;or++)ar.push(Fi.path[or]);const Xr=2.5*bn;if(J){const or=ar.map(mt?(Ki,Mo)=>{const ns=dt(Mo<$n.path.length-1?$n.tilePath[$n.path.length-1-Mo]:Fi.tilePath[Mo-$n.path.length+2]);return Gi(Ki,J,ns[2])}:Ki=>Gi(Ki,J));ar=or.some(Ki=>Ki.signedDistanceFromCamera<=0)?[]:or.map(Ki=>Ki.point)}let xo=[];if(ar.length>0){const or=ar[0].clone(),Ki=ar[0].clone();for(let Mo=1;Mo<ar.length;Mo++)or.x=Math.min(or.x,ar[Mo].x),or.y=Math.min(or.y,ar[Mo].y),Ki.x=Math.max(Ki.x,ar[Mo].x),Ki.y=Math.max(Ki.y,ar[Mo].y);xo=or.x>=Ti.x&&Ki.x<=Vi.x&&or.y>=Ti.y&&Ki.y<=Vi.y?[ar]:Ki.x<Ti.x||or.x>Vi.x||Ki.y<Ti.y||or.y>Vi.y?[]:a.clipLine([ar],Ti.x,Ti.y,Vi.x,Vi.y)}for(const or of xo){wr.reset(or,.25*bn);let Ki=0;Ki=wr.length<=.5*bn?1:Math.ceil(wr.paddedLength/Xr)+1;for(let Mo=0;Mo<Ki;Mo++){const ns=Mo/Math.max(Ki-1,1),vs=wr.lerp(ns),xs=vs.x+Pr,ua=vs.y+Pr;Ye.push(xs,ua,bn,0);const $r=xs-bn,lr=ua-bn,Tr=xs+bn,Eo=ua+bn;if(Cn=Cn&&this.isOffscreen($r,lr,Tr,Eo),Xt=Xt||this.isInsideGrid($r,lr,Tr,Eo),!n&&this.grid.hitTestCircle(xs,ua,bn,ge)&&(mn=!0,!oe))return{circles:[],offscreen:!1,collisionDetected:mn}}}}return{circles:!oe&&mn||!Xt?[]:Ye,offscreen:Cn,collisionDetected:mn}}queryRenderedSymbols(n){if(0===n.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let _=1/0,x=1/0,T=-1/0,I=-1/0;for(const ce of n){const ge=new a.pointGeometry(ce.x+Pr,ce.y+Pr);_=Math.min(_,ge.x),x=Math.min(x,ge.y),T=Math.max(T,ge.x),I=Math.max(I,ge.y),u.push(ge)}const B=this.grid.query(_,x,T,I).concat(this.ignoredGrid.query(_,x,T,I)),J={},oe={};for(const ce of B){const ge=ce.key;if(void 0===J[ge.bucketInstanceId]&&(J[ge.bucketInstanceId]={}),J[ge.bucketInstanceId][ge.featureIndex])continue;const Re=[new a.pointGeometry(ce.x1,ce.y1),new a.pointGeometry(ce.x2,ce.y1),new a.pointGeometry(ce.x2,ce.y2),new a.pointGeometry(ce.x1,ce.y2)];a.polygonIntersectsPolygon(u,Re)&&(J[ge.bucketInstanceId][ge.featureIndex]=!0,void 0===oe[ge.bucketInstanceId]&&(oe[ge.bucketInstanceId]=[]),oe[ge.bucketInstanceId].push(ge.featureIndex))}return oe}insertCollisionBox(n,u,_,x,T){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:x,collisionGroupID:T},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,u,_,x,T){const I=u?this.ignoredGrid:this.grid,B={bucketInstanceId:_,featureIndex:x,collisionGroupID:T};for(let J=0;J<n.length;J+=4)I.insertCircle(B,n[J],n[J+1],n[J+2])}projectAndGetPerspectiveRatio(n,u,_,x,T){const I=[u,_,x||0,1];let B=!1;if(x||this.transform.pitch>0){a.transformMat4$1(I,I,n);let J=!1;this.fogState&&T&&(J=function(oe,ce,ge,Re,We,$e){const Ye=$e.calculateFogTileMatrix(We),mt=[ce,ge,Re];return a.transformMat4(mt,mt,Ye),xt(oe,mt,$e.pitch,$e._fov)}(this.fogState,u,_,x||0,T.toUnwrapped(),this.transform)>.9),B=I[2]>I[3]||J}else Sr(I,I,n);return{point:new a.pointGeometry((I[0]/I[3]+1)/2*this.transform.width+Pr,(-I[1]/I[3]+1)/2*this.transform.height+Pr),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/I[3]*.5,1.5),signedDistanceFromCamera:I[3],aboveHorizon:B}}isOffscreen(n,u,_,x){return _<Pr||n>=this.screenRightBoundary||x<Pr||u>this.screenBottomBoundary}isInsideGrid(n,u,_,x){return _>=0&&n<this.gridRightBoundary&&x>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const n=a.identity([]);return a.translate(n,n,[-100,-100,0]),n}}class Xe{constructor(n,u,_,x){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?u:-u))):x&&_?1:0,this.placed=_}isHidden(){return 0===this.opacity&&!this.placed}}class Me{constructor(n,u,_,x,T,I=!1){this.text=new Xe(n?n.text:null,u,_,T),this.icon=new Xe(n?n.icon:null,u,x,T),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class st{constructor(n,u,_,x=!1){this.text=n,this.icon=u,this.skipFade=_,this.clipped=x}}class Rt{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class zt{constructor(n,u,_,x,T){this.bucketInstanceId=n,this.featureIndex=u,this.sourceLayerIndex=_,this.bucketIndex=x,this.tileID=T}}class rn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const u=++this.maxGroupID;this.collisionGroups[n]={ID:u,predicate:_=>_.collisionGroupID===u}}return this.collisionGroups[n]}}function un(g,n,u,_,x){const{horizontalAlign:T,verticalAlign:I}=a.getAnchorAlignment(g),B=-(T-.5)*n,J=-(I-.5)*u,oe=a.evaluateVariableOffset(g,_);return new a.pointGeometry(B+oe[0]*x,J+oe[1]*x)}function dn(g,n,u,_,x){const T=new a.pointGeometry(g,n);return u&&T._rotate(_?x:-x),T}class An{constructor(n,u,_,x,T){this.transform=n.clone(),this.collisionIndex=new Se(this.transform,T),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new rn(_),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,u,_,x){const T=_.getBucket(u),I=_.latestFeatureIndex;if(!T||!I||u.id!==T.layerIds[0])return;const B=T.layers[0].layout,J=_.collisionBoxArray,oe=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),ce=_.tileSize/a.EXTENT,ge=_.tileID.toUnwrapped(),Re=this.transform.calculateProjMatrix(ge),We="map"===B.get("text-pitch-alignment"),$e="map"===B.get("text-rotation-alignment");u.compileFilter();const Ye=u.dynamicFilter(),mt=u.dynamicFilterNeedsFeature(),Ge=this.transform.calculatePixelsToTileUnitsMatrix(_),dt=Ai(Re,_.tileID.canonical,We,$e,this.transform,Ge);let _t=null;if(We){const bt=Bi(Re,_.tileID.canonical,We,$e,this.transform,Ge);_t=a.multiply$1([],this.transform.labelPlaneMatrix,bt)}let lt=null;Ye&&_.latestFeatureIndex&&(lt={unwrappedTileID:ge,dynamicFilter:Ye,dynamicFilterNeedsFeature:mt,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[T.bucketInstanceId]=new zt(T.bucketInstanceId,I,T.sourceLayerIndex,T.index,_.tileID);const ut={bucket:T,layout:B,posMatrix:Re,textLabelPlaneMatrix:dt,labelToScreenMatrix:_t,clippingData:lt,scale:oe,textPixelRatio:ce,holdingForFade:_.holdingForFade(),collisionBoxArray:J,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(T.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(T.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(T.sourceID)};if(x)for(const bt of T.sortKeyRanges){const{sortKey:qt,symbolInstanceStart:cn,symbolInstanceEnd:Gn}=bt;n.push({sortKey:qt,symbolInstanceStart:cn,symbolInstanceEnd:Gn,parameters:ut})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:T.symbolInstances.length,parameters:ut})}attemptAnchorPlacement(n,u,_,x,T,I,B,J,oe,ce,ge,Re,We,$e,Ye,mt,Ge,dt){const _t=[Re.textOffset0,Re.textOffset1],lt=un(n,_,x,_t,T),ut=this.collisionIndex.placeCollisionBox(T,u,dn(lt.x,lt.y,I,B,this.transform.angle),ge,J,oe,ce.predicate);if((!mt||0!==this.collisionIndex.placeCollisionBox($e.getSymbolInstanceIconSize(dt,this.transform.zoom,We),mt,dn(lt.x,lt.y,I,B,this.transform.angle),ge,J,oe,ce.predicate).box.length)&&ut.box.length>0){let bt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Re.crossTileID]&&this.prevPlacement.placements[Re.crossTileID]&&this.prevPlacement.placements[Re.crossTileID].text&&(bt=this.prevPlacement.variableOffsets[Re.crossTileID].anchor),this.variableOffsets[Re.crossTileID]={textOffset:_t,width:_,height:x,anchor:n,textScale:T,prevAnchor:bt},this.markUsedJustification($e,n,Re,Ye),$e.allowVerticalPlacement&&(this.markUsedOrientation($e,Ye,Re),this.placedOrientations[Re.crossTileID]=Ye),{shift:lt,placedGlyphBoxes:ut}}}placeLayerBucketPart(n,u,_,x){const{bucket:T,layout:I,posMatrix:B,textLabelPlaneMatrix:J,labelToScreenMatrix:oe,clippingData:ce,textPixelRatio:ge,holdingForFade:Re,collisionBoxArray:We,partiallyEvaluatedTextSize:$e,partiallyEvaluatedIconSize:Ye,collisionGroup:mt}=n.parameters,Ge=I.get("text-optional"),dt=I.get("icon-optional"),_t=I.get("text-allow-overlap"),lt=I.get("icon-allow-overlap"),ut="map"===I.get("text-rotation-alignment"),bt="map"===I.get("text-pitch-alignment"),qt="none"!==I.get("icon-text-fit"),cn="viewport-y"===I.get("symbol-z-order"),Gn=_t&&(lt||!T.hasIconData()||dt),On=lt&&(_t||!T.hasTextData()||Ge);!T.collisionArrays&&We&&T.deserializeCollisionBoxes(We),_&&x&&T.updateCollisionDebugBuffers(this.transform.zoom,We);const Sn=(mn,Xt,Cn)=>{if(ce){const $r={zoom:this.transform.zoom,pitch:this.transform.pitch};let lr=null;if(ce.dynamicFilterNeedsFeature){const Tr=this.retainedQueryData[T.bucketInstanceId];lr=ce.featureIndex.loadFeature({featureIndex:mn.featureIndex,bucketIndex:Tr.bucketIndex,sourceLayerIndex:Tr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,ce.dynamicFilter)($r,lr,this.retainedQueryData[T.bucketInstanceId].tileID.canonical,new a.pointGeometry(mn.tileAnchorX,mn.tileAnchorY),this.transform.calculateDistanceTileData(ce.unwrappedTileID)))return this.placements[mn.crossTileID]=new st(!1,!1,!1,!0),void(u[mn.crossTileID]=!0)}if(u[mn.crossTileID])return;if(Re)return void(this.placements[mn.crossTileID]=new st(!1,!1,!1));let bn=!1,Ti=!1,Vi=!0,wr=null,$n={box:null,offscreen:null},Fi={box:null,offscreen:null},ar=null,Xr=null,xo=null,or=0,Ki=0,Mo=0;Cn.textFeatureIndex?or=Cn.textFeatureIndex:mn.useRuntimeCollisionCircles&&(or=mn.featureIndex),Cn.verticalTextFeatureIndex&&(Ki=Cn.verticalTextFeatureIndex);const ns=$r=>{$r.tileID=this.retainedQueryData[T.bucketInstanceId].tileID,(this.transform.elevation||$r.elevation)&&($r.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[T.bucketInstanceId].tileID,$r.tileAnchorX,$r.tileAnchorY):0)},vs=Cn.textBox;if(vs){ns(vs);const $r=Tr=>{let Eo=a.WritingMode.horizontal;if(T.allowVerticalPlacement&&!Tr&&this.prevPlacement){const Rs=this.prevPlacement.placedOrientations[mn.crossTileID];Rs&&(this.placedOrientations[mn.crossTileID]=Rs,Eo=Rs,this.markUsedOrientation(T,Eo,mn))}return Eo},lr=(Tr,Eo)=>{if(T.allowVerticalPlacement&&mn.numVerticalGlyphVertices>0&&Cn.verticalTextBox){for(const Rs of T.writingModes)if(Rs===a.WritingMode.vertical?($n=Eo(),Fi=$n):$n=Tr(),$n&&$n.box&&$n.box.length)break}else $n=Tr()};if(I.get("text-variable-anchor")){let Tr=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[mn.crossTileID]){const po=this.prevPlacement.variableOffsets[mn.crossTileID];Tr.indexOf(po.anchor)>0&&(Tr=Tr.filter(Zs=>Zs!==po.anchor),Tr.unshift(po.anchor))}const Eo=(po,Zs,ic)=>{const bs=T.getSymbolInstanceTextSize($e,mn,this.transform.zoom,Xt),Ea=(po.x2-po.x1)*bs+2*po.padding,_i=(po.y2-po.y1)*bs+2*po.padding,Ni=qt&&!lt?Zs:null;Ni&&ns(Ni);let cs={box:[],offscreen:!1};const Ks=_t?2*Tr.length:Tr.length;for(let Xs=0;Xs<Ks;++Xs){const fs=this.attemptAnchorPlacement(Tr[Xs%Tr.length],po,Ea,_i,bs,ut,bt,ge,B,mt,Xs>=Tr.length,mn,Xt,T,ic,Ni,$e,Ye);if(fs&&(cs=fs.placedGlyphBoxes,cs&&cs.box&&cs.box.length)){bn=!0,wr=fs.shift;break}}return cs};lr(()=>Eo(vs,Cn.iconBox,a.WritingMode.horizontal),()=>{const po=Cn.verticalTextBox;return po&&ns(po),T.allowVerticalPlacement&&!($n&&$n.box&&$n.box.length)&&mn.numVerticalGlyphVertices>0&&po?Eo(po,Cn.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null}}),$n&&(bn=$n.box,Vi=$n.offscreen);const Rs=$r($n&&$n.box);if(!bn&&this.prevPlacement){const po=this.prevPlacement.variableOffsets[mn.crossTileID];po&&(this.variableOffsets[mn.crossTileID]=po,this.markUsedJustification(T,po.anchor,mn,Rs))}}else{const Tr=(Eo,Rs)=>{const po=T.getSymbolInstanceTextSize($e,mn,this.transform.zoom,Xt),Zs=this.collisionIndex.placeCollisionBox(po,Eo,new a.pointGeometry(0,0),_t,ge,B,mt.predicate);return Zs&&Zs.box&&Zs.box.length&&(this.markUsedOrientation(T,Rs,mn),this.placedOrientations[mn.crossTileID]=Rs),Zs};lr(()=>Tr(vs,a.WritingMode.horizontal),()=>{const Eo=Cn.verticalTextBox;return T.allowVerticalPlacement&&mn.numVerticalGlyphVertices>0&&Eo?(ns(Eo),Tr(Eo,a.WritingMode.vertical)):{box:null,offscreen:null}}),$r($n&&$n.box&&$n.box.length)}}if(ar=$n,bn=ar&&ar.box&&ar.box.length>0,Vi=ar&&ar.offscreen,mn.useRuntimeCollisionCircles){const $r=T.text.placedSymbolArray.get(mn.centerJustifiedTextSymbolIndex>=0?mn.centerJustifiedTextSymbolIndex:mn.verticalPlacedTextSymbolIndex),lr=a.evaluateSizeForFeature(T.textSizeData,$e,$r),Tr=I.get("text-padding");Xr=this.collisionIndex.placeCollisionCircles(_t,$r,T.lineVertexArray,T.glyphOffsetArray,lr,B,J,oe,_,bt,mt.predicate,mn.collisionCircleDiameter*lr/a.ONE_EM,Tr,this.retainedQueryData[T.bucketInstanceId].tileID),bn=_t||Xr.circles.length>0&&!Xr.collisionDetected,Vi=Vi&&Xr.offscreen}if(Cn.iconFeatureIndex&&(Mo=Cn.iconFeatureIndex),Cn.iconBox){const $r=lr=>{ns(lr);const Tr=qt&&wr?dn(wr.x,wr.y,ut,bt,this.transform.angle):new a.pointGeometry(0,0),Eo=T.getSymbolInstanceIconSize(Ye,this.transform.zoom,Xt);return this.collisionIndex.placeCollisionBox(Eo,lr,Tr,lt,ge,B,mt.predicate)};Fi&&Fi.box&&Fi.box.length&&Cn.verticalIconBox?(xo=$r(Cn.verticalIconBox),Ti=xo.box.length>0):(xo=$r(Cn.iconBox),Ti=xo.box.length>0),Vi=Vi&&xo.offscreen}const xs=Ge||0===mn.numHorizontalGlyphVertices&&0===mn.numVerticalGlyphVertices,ua=dt||0===mn.numIconVertices;if(xs||ua?ua?xs||(Ti=Ti&&bn):bn=Ti&&bn:Ti=bn=Ti&&bn,bn&&ar&&ar.box&&this.collisionIndex.insertCollisionBox(ar.box,I.get("text-ignore-placement"),T.bucketInstanceId,Fi&&Fi.box&&Ki?Ki:or,mt.ID),Ti&&xo&&this.collisionIndex.insertCollisionBox(xo.box,I.get("icon-ignore-placement"),T.bucketInstanceId,Mo,mt.ID),Xr&&(bn&&this.collisionIndex.insertCollisionCircles(Xr.circles,I.get("text-ignore-placement"),T.bucketInstanceId,or,mt.ID),_)){const $r=T.bucketInstanceId;let lr=this.collisionCircleArrays[$r];void 0===lr&&(lr=this.collisionCircleArrays[$r]=new Rt);for(let Tr=0;Tr<Xr.circles.length;Tr+=4)lr.circles.push(Xr.circles[Tr+0]),lr.circles.push(Xr.circles[Tr+1]),lr.circles.push(Xr.circles[Tr+2]),lr.circles.push(Xr.collisionDetected?1:0)}this.placements[mn.crossTileID]=new st(bn||Gn,Ti||On,Vi||T.justReloaded),u[mn.crossTileID]=!0};if(cn){const mn=T.getSortedSymbolIndexes(this.transform.angle);for(let Xt=mn.length-1;Xt>=0;--Xt){const Cn=mn[Xt];Sn(T.symbolInstances.get(Cn),Cn,T.collisionArrays[Cn])}}else for(let mn=n.symbolInstanceStart;mn<n.symbolInstanceEnd;mn++)Sn(T.symbolInstances.get(mn),mn,T.collisionArrays[mn]);if(_&&T.bucketInstanceId in this.collisionCircleArrays){const mn=this.collisionCircleArrays[T.bucketInstanceId];a.invert(mn.invProjMatrix,B),mn.viewportMatrix=this.collisionIndex.getViewportMatrix()}T.justReloaded=!1}markUsedJustification(n,u,_,x){let T;T=x===a.WritingMode.vertical?_.verticalPlacedTextSymbolIndex:{left:_.leftJustifiedTextSymbolIndex,center:_.centerJustifiedTextSymbolIndex,right:_.rightJustifiedTextSymbolIndex}[a.getAnchorJustification(u)];const I=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex,_.verticalPlacedTextSymbolIndex];for(const B of I)B>=0&&(n.text.placedSymbolArray.get(B).crossTileID=T>=0&&B!==T?0:_.crossTileID)}markUsedOrientation(n,u,_){const x=u===a.WritingMode.horizontal||u===a.WritingMode.horizontalOnly?u:0,T=u===a.WritingMode.vertical?u:0,I=[_.leftJustifiedTextSymbolIndex,_.centerJustifiedTextSymbolIndex,_.rightJustifiedTextSymbolIndex];for(const B of I)n.text.placedSymbolArray.get(B).placedOrientation=x;_.verticalPlacedTextSymbolIndex&&(n.text.placedSymbolArray.get(_.verticalPlacedTextSymbolIndex).placedOrientation=T)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let _=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const x=u?u.symbolFadeChange(n):1,T=u?u.opacities:{},I=u?u.variableOffsets:{},B=u?u.placedOrientations:{};for(const J in this.placements){const oe=this.placements[J],ce=T[J];ce?(this.opacities[J]=new Me(ce,x,oe.text,oe.icon,null,oe.clipped),_=_||oe.text!==ce.text.placed||oe.icon!==ce.icon.placed):(this.opacities[J]=new Me(null,x,oe.text,oe.icon,oe.skipFade,oe.clipped),_=_||oe.text||oe.icon)}for(const J in T){const oe=T[J];if(!this.opacities[J]){const ce=new Me(oe,x,!1,!1);ce.isHidden()||(this.opacities[J]=ce,_=_||oe.text.placed||oe.icon.placed)}}for(const J in I)this.variableOffsets[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.variableOffsets[J]=I[J]);for(const J in B)this.placedOrientations[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.placedOrientations[J]=B[J]);_?this.lastPlacementChangeTime=n:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:n)}updateLayerOpacities(n,u){const _={};for(const x of u){const T=x.getBucket(n);T&&x.latestFeatureIndex&&n.id===T.layerIds[0]&&this.updateBucketOpacities(T,_,x.collisionBoxArray)}}updateBucketOpacities(n,u,_){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const x=n.layers[0].layout,T=!!n.layers[0].dynamicFilter(),I=new Me(null,0,!1,!1,!0),B=x.get("text-allow-overlap"),J=x.get("icon-allow-overlap"),oe=x.get("text-variable-anchor"),ce="map"===x.get("text-rotation-alignment"),ge="map"===x.get("text-pitch-alignment"),Re="none"!==x.get("icon-text-fit"),We=new Me(null,0,B&&(J||!n.hasIconData()||x.get("icon-optional")),J&&(B||!n.hasTextData()||x.get("text-optional")),!0);!n.collisionArrays&&_&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(_);const $e=(mt,Ge,dt)=>{for(let _t=0;_t<Ge/4;_t++)mt.opacityVertexArray.emplaceBack(dt)};let Ye=0;for(let mt=0;mt<n.symbolInstances.length;mt++){const Ge=n.symbolInstances.get(mt),{numHorizontalGlyphVertices:dt,numVerticalGlyphVertices:_t,crossTileID:lt}=Ge;let ut=this.opacities[lt];u[lt]?ut=I:ut||(ut=We,this.opacities[lt]=ut),u[lt]=!0;const bt=dt>0||_t>0,qt=Ge.numIconVertices>0,cn=this.placedOrientations[Ge.crossTileID],Gn=cn===a.WritingMode.vertical,On=cn===a.WritingMode.horizontal||cn===a.WritingMode.horizontalOnly;if(!bt&&!qt||ut.isHidden()||Ye++,bt){const Sn=Lo(ut.text);$e(n.text,dt,Gn?mo:Sn),$e(n.text,_t,On?mo:Sn);const mn=ut.text.isHidden();[Ge.rightJustifiedTextSymbolIndex,Ge.centerJustifiedTextSymbolIndex,Ge.leftJustifiedTextSymbolIndex].forEach(bn=>{bn>=0&&(n.text.placedSymbolArray.get(bn).hidden=mn||Gn?1:0)}),Ge.verticalPlacedTextSymbolIndex>=0&&(n.text.placedSymbolArray.get(Ge.verticalPlacedTextSymbolIndex).hidden=mn||On?1:0);const Xt=this.variableOffsets[Ge.crossTileID];Xt&&this.markUsedJustification(n,Xt.anchor,Ge,cn);const Cn=this.placedOrientations[Ge.crossTileID];Cn&&(this.markUsedJustification(n,"left",Ge,Cn),this.markUsedOrientation(n,Cn,Ge))}if(qt){const Sn=Lo(ut.icon);Ge.placedIconSymbolIndex>=0&&($e(n.icon,Ge.numIconVertices,Gn?mo:Sn),n.icon.placedSymbolArray.get(Ge.placedIconSymbolIndex).hidden=ut.icon.isHidden()),Ge.verticalPlacedIconSymbolIndex>=0&&($e(n.icon,Ge.numVerticalIconVertices,On?mo:Sn),n.icon.placedSymbolArray.get(Ge.verticalPlacedIconSymbolIndex).hidden=ut.icon.isHidden())}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Sn=n.collisionArrays[mt];if(Sn){let mn=new a.pointGeometry(0,0),Xt=!0;if(Sn.textBox||Sn.verticalTextBox){if(oe){const bn=this.variableOffsets[lt];bn?(mn=un(bn.anchor,bn.width,bn.height,bn.textOffset,bn.textScale),ce&&mn._rotate(ge?this.transform.angle:-this.transform.angle)):Xt=!1}T&&(Xt=!ut.clipped),Sn.textBox&&qn(n.textCollisionBox.collisionVertexArray,ut.text.placed,!Xt||Gn,mn.x,mn.y),Sn.verticalTextBox&&qn(n.textCollisionBox.collisionVertexArray,ut.text.placed,!Xt||On,mn.x,mn.y)}const Cn=Xt&&Boolean(!On&&Sn.verticalIconBox);Sn.iconBox&&qn(n.iconCollisionBox.collisionVertexArray,ut.icon.placed,Cn,Re?mn.x:0,Re?mn.y:0),Sn.verticalIconBox&&qn(n.iconCollisionBox.collisionVertexArray,ut.icon.placed,!Cn,Re?mn.x:0,Re?mn.y:0)}}}if(n.fullyClipped=0===Ye,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const mt=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=mt.invProjMatrix,n.placementViewportMatrix=mt.viewportMatrix,n.collisionCircleArray=mt.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return 0===this.fadeDuration?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,u){const _=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*_>n}setStale(){this.stale=!0}}function qn(g,n,u,_,x){g.emplaceBack(n?1:0,u?1:0,_||0,x||0),g.emplaceBack(n?1:0,u?1:0,_||0,x||0),g.emplaceBack(n?1:0,u?1:0,_||0,x||0),g.emplaceBack(n?1:0,u?1:0,_||0,x||0)}const Bt=Math.pow(2,25),hn=Math.pow(2,24),qi=Math.pow(2,17),no=Math.pow(2,16),rr=Math.pow(2,9),Br=Math.pow(2,8),pr=Math.pow(2,1);function Lo(g){if(0===g.opacity&&!g.placed)return 0;if(1===g.opacity&&g.placed)return 4294967295;const n=g.placed?1:0,u=Math.floor(127*g.opacity);return u*Bt+n*hn+u*qi+n*no+u*rr+n*Br+u*pr+n}const mo=0;class jn{constructor(n){this._sortAcrossTiles="viewport-y"!==n.layout.get("symbol-z-order")&&void 0!==n.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(n,u,_,x,T){const I=this._bucketParts;for(;this._currentTileIndex<n.length;)if(u.getBucketParts(I,x,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,T())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((B,J)=>B.sortKey-J.sortKey));this._currentPartIndex<I.length;){const B=I[this._currentPartIndex];if(u.placeLayerBucketPart(B,this._seenCrossTileIDs,_,0===B.symbolInstanceStart),this._currentPartIndex++,T())return!0}return!1}}class Wi{constructor(n,u,_,x,T,I,B,J){this.placement=new An(n,T,I,B,J),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(n,u,_){const x=a.exported.now(),T=()=>{const I=a.exported.now()-x;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=u[n[this._currentPlacementIndex]],B=this.placement.collisionIndex.transform.zoom;if("symbol"===I.type&&(!I.minzoom||I.minzoom<=B)&&(!I.maxzoom||I.maxzoom>B)){if(this._inProgressLayer||(this._inProgressLayer=new jn(I)),this._inProgressLayer.continuePlacement(_[I.source],this.placement,this._showCollisionBoxes,I,T))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const Ui=512/a.EXTENT/2;class wo{constructor(n,u,_){this.tileID=n,this.indexedSymbolInstances={},this.bucketInstanceId=_;for(let x=0;x<u.length;x++){const T=u.get(x),I=T.key;this.indexedSymbolInstances[I]||(this.indexedSymbolInstances[I]=[]),this.indexedSymbolInstances[I].push({crossTileID:T.crossTileID,coord:this.getScaledCoordinates(T,n)})}}getScaledCoordinates(n,u){const _=Ui/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*a.EXTENT+n.tileAnchorX)*_),y:Math.floor((u.canonical.y*a.EXTENT+n.tileAnchorY)*_)}}findMatches(n,u,_){const x=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let T=0;T<n.length;T++){const I=n.get(T);if(I.crossTileID)continue;const B=this.indexedSymbolInstances[I.key];if(!B)continue;const J=this.getScaledCoordinates(I,u);for(const oe of B)if(Math.abs(oe.coord.x-J.x)<=x&&Math.abs(oe.coord.y-J.y)<=x&&!_[oe.crossTileID]){_[oe.crossTileID]=!0,I.crossTileID=oe.crossTileID;break}}}}class at{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class nt{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const u=Math.round((n-this.lng)/360);if(0!==u)for(const _ in this.indexes){const x=this.indexes[_],T={};for(const I in x){const B=x[I];B.tileID=B.tileID.unwrapTo(B.tileID.wrap+u),T[B.tileID.key]=B}this.indexes[_]=T}this.lng=n}addBucket(n,u,_){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let T=0;T<u.symbolInstances.length;T++)u.symbolInstances.get(T).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]={});const x=this.usedCrossTileIDs[n.overscaledZ];for(const T in this.indexes){const I=this.indexes[T];if(Number(T)>n.overscaledZ)for(const B in I){const J=I[B];J.tileID.isChildOf(n)&&J.findMatches(u.symbolInstances,n,x)}else{const B=I[n.scaledTo(Number(T)).key];B&&B.findMatches(u.symbolInstances,n,x)}}for(let T=0;T<u.symbolInstances.length;T++){const I=u.symbolInstances.get(T);I.crossTileID||(I.crossTileID=_.generate(),x[I.crossTileID]=!0)}return void 0===this.indexes[n.overscaledZ]&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new wo(n,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(n,u){for(const _ in u.indexedSymbolInstances)for(const x of u.indexedSymbolInstances[_])delete this.usedCrossTileIDs[n][x.crossTileID]}removeStaleBuckets(n){let u=!1;for(const _ in this.indexes){const x=this.indexes[_];for(const T in x)n[x[T].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,x[T]),delete x[T],u=!0)}return u}}class ke{constructor(){this.layerIndexes={},this.crossTileIDs=new at,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,u,_,x){let T=this.layerIndexes[n.id];void 0===T&&(T=this.layerIndexes[n.id]=new nt);let I=!1;const B={};"globe"!==x.name&&T.handleWrapJump(_);for(const J of u){const oe=J.getBucket(n);oe&&n.id===oe.layerIds[0]&&(oe.bucketInstanceId||(oe.bucketInstanceId=++this.maxBucketInstanceId),T.addBucket(J.tileID,oe,this.crossTileIDs)&&(I=!0),B[oe.bucketInstanceId]=!0)}return T.removeStaleBuckets(B)&&(I=!0),I}pruneUnusedLayers(n){const u={};n.forEach(_=>{u[_]=!0});for(const _ in this.layerIndexes)u[_]||delete this.layerIndexes[_]}}const At=(g,n)=>a.emitValidationErrors(g,n&&n.filter(u=>"source.canvas"!==u.identifier)),en=a.pick(sn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),pi=a.pick(sn,["setCenter","setZoom","setBearing","setPitch"]),fi=function(){const g={},n=a.spec.$version;for(const u in a.spec.$root){const _=a.spec.$root[u];if(_.required){let x=null;x="version"===u?n:"array"===_.type?[]:{},null!=x&&(g[u]=x)}}return g}(),Ur={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ie extends a.Evented{constructor(n,u={}){super(),this.map=n,this.dispatcher=new Ct(tt(),this),this.imageManager=new je,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(n._requestManager,u.localFontFamily?a.LocalGlyphMode.all:u.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.lineAtlas=new a.LineAtlas(256,512),this.crossTileSymbolIndex=new ke,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new a.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const _=this;this._rtlTextPluginCallback=ie.registerForPluginStateChange(x=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(T,I)=>{if(a.triggerPluginCompletionEvent(T),I&&I.every(B=>B))for(const B in _._sourceCaches){const J=_._sourceCaches[B],oe=J.getSource().type;"vector"!==oe&&"geojson"!==oe||J.reload()}})}),this.on("data",x=>{if("source"!==x.dataType||"metadata"!==x.sourceDataType)return;const T=this.getSource(x.sourceId);if(T&&T.vectorLayerIds)for(const I in this._layers){const B=this._layers[I];B.source===T.id&&this._validateLayer(B)}})}loadURL(n,u={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const _="boolean"==typeof u.validate?u.validate:!a.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,u.accessToken);const x=this.map._requestManager.transformRequest(n,a.ResourceType.Style);this._request=a.getJSON(x,(T,I)=>{this._request=null,T?this.fire(new a.ErrorEvent(T)):I&&this._load(I,_)})}loadJSON(n,u={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(n,!1!==u.validate)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(fi,!1)}_updateLayerCount(n,u){const _=u?1:-1;n.is3D()&&(this._num3DLayers+=_),"circle"===n.type&&(this._numCircleLayers+=_),"symbol"===n.type&&(this._numSymbolLayers+=_)}_load(n,u){if(u&&At(this,a.validateStyle(n)))return;this._loaded=!0,this.stylesheet=n,this.updateProjection();for(const x in n.sources)this.addSource(x,n.sources[x],{validate:!1});this._changed=!1,n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(n.glyphs);const _=on(this.stylesheet.layers);this._order=_.map(x=>x.id),this._layers={},this._serializedLayers={};for(let x of _)x=a.createStyleLayer(x),x.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=x,this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Ze(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return this.terrain&&0===this.terrain.drapeRenderMode}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this.updateProjection()}updateProjection(){const n=this.map.transform.projection,u=this.map.transform.setProjection(this.map._runtimeProjection||(this.stylesheet?this.stylesheet.projection:void 0)),_=this.map.transform.projection;if(this._loaded&&(_.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null)),this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),u){if(_.isReprojectedInTileSpace||n.isReprojectedInTileSpace){this.map.painter.clearBackgroundTiles();for(const x in this._sourceCaches)this._sourceCaches[x].clearTiles()}else this._forceSymbolLayerUpdate();this.map._update(!0)}}_loadSprite(n){this._spriteRequest=function(u,_,x){let T,I,B;const J=a.exported.devicePixelRatio>1?"@2x":"";let oe=a.getJSON(_.transformRequest(_.normalizeSpriteURL(u,J,".json"),a.ResourceType.SpriteJSON),(Re,We)=>{oe=null,B||(B=Re,T=We,ge())}),ce=a.getImage(_.transformRequest(_.normalizeSpriteURL(u,J,".png"),a.ResourceType.SpriteImage),(Re,We)=>{ce=null,B||(B=Re,I=We,ge())});function ge(){if(B)x(B);else if(T&&I){const Re=a.exported.getImageData(I),We={};for(const $e in T){const{width:Ye,height:mt,x:Ge,y:dt,sdf:_t,pixelRatio:lt,stretchX:ut,stretchY:bt,content:qt}=T[$e],cn=new a.RGBAImage({width:Ye,height:mt});a.RGBAImage.copy(Re,cn,{x:Ge,y:dt},{x:0,y:0},{width:Ye,height:mt}),We[$e]={data:cn,pixelRatio:lt,sdf:_t,stretchX:ut,stretchY:bt,content:qt}}x(null,We)}}return{cancel(){oe&&(oe.cancel(),oe=null),ce&&(ce.cancel(),ce=null)}}}(n,this.map._requestManager,(u,_)=>{if(this._spriteRequest=null,u)this.fire(new a.ErrorEvent(u));else if(_)for(const x in _)this.imageManager.addImage(x,_[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(n){const u=this.getSource(n.source);if(!u)return;const _=n.sourceLayer;_&&("geojson"===u.type||u.vectorLayerIds&&-1===u.vectorLayerIds.indexOf(_))&&this.fire(new a.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${u.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const u=[];for(const _ of n){const x=this._layers[_];"custom"!==x.type&&u.push(x.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(n){return!!this.terrain&&Ur[n.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(n){if(!this._loaded)return;const u=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),T=Object.keys(this._removedLayers);(x.length||T.length)&&this._updateWorkerLayers(x,T);for(const I in this._updatedSources){const B=this._updatedSources[I];"reload"===B?this._reloadSource(I):"clear"===B&&this._clearSource(I)}this._updateTilesForChangedImages();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(n);this.light.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._resetUpdates()}const _={};for(const x in this._sourceCaches){const T=this._sourceCaches[x];_[x]=T.used,T.used=!1}for(const x of this._order){const T=this._layers[x];if(T.recalculate(n,this._availableImages),!T.isHidden(n.zoom)){const B=this._getLayerSourceCache(T);B&&(B.used=!0)}const I=this.map.painter;if(I){const B=T.getProgramIds();if(!B)continue;const J=T.getProgramConfiguration(n.zoom);for(const oe of B)I.useProgram(oe,J)}}for(const x in _){const T=this._sourceCaches[x];_[x]!==T.used&&T.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:T.getSource().id}))}this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),At(this,a.validateStyle(n)))return!1;(n=a.clone$1(n)).layers=on(n.layers);const u=function(x,T){if(!x)return[{command:sn.setStyle,args:[T]}];let I=[];try{if(!Q(x.version,T.version))return[{command:sn.setStyle,args:[T]}];Q(x.center,T.center)||I.push({command:sn.setCenter,args:[T.center]}),Q(x.zoom,T.zoom)||I.push({command:sn.setZoom,args:[T.zoom]}),Q(x.bearing,T.bearing)||I.push({command:sn.setBearing,args:[T.bearing]}),Q(x.pitch,T.pitch)||I.push({command:sn.setPitch,args:[T.pitch]}),Q(x.sprite,T.sprite)||I.push({command:sn.setSprite,args:[T.sprite]}),Q(x.glyphs,T.glyphs)||I.push({command:sn.setGlyphs,args:[T.glyphs]}),Q(x.transition,T.transition)||I.push({command:sn.setTransition,args:[T.transition]}),Q(x.light,T.light)||I.push({command:sn.setLight,args:[T.light]}),Q(x.fog,T.fog)||I.push({command:sn.setFog,args:[T.fog]}),Q(x.projection,T.projection)||I.push({command:sn.setProjection,args:[T.projection]});const B={},J=[];!function(ge,Re,We,$e){let Ye;for(Ye in Re=Re||{},ge=ge||{})ge.hasOwnProperty(Ye)&&(Re.hasOwnProperty(Ye)||Nn(Ye,We,$e));for(Ye in Re)Re.hasOwnProperty(Ye)&&(ge.hasOwnProperty(Ye)?Q(ge[Ye],Re[Ye])||("geojson"===ge[Ye].type&&"geojson"===Re[Ye].type&&ai(ge,Re,Ye)?We.push({command:sn.setGeoJSONSourceData,args:[Ye,Re[Ye].data]}):Wn(Ye,Re,We,$e)):gn(Ye,Re,We))}(x.sources,T.sources,J,B);const oe=[];x.layers&&x.layers.forEach(ge=>{B[ge.source]?I.push({command:sn.removeLayer,args:[ge.id]}):oe.push(ge)});let ce=x.terrain;ce&&B[ce.source]&&(I.push({command:sn.setTerrain,args:[void 0]}),ce=void 0),I=I.concat(J),Q(ce,T.terrain)||I.push({command:sn.setTerrain,args:[T.terrain]}),function(ge,Re,We){Re=Re||[];const $e=(ge=ge||[]).map(ui),Ye=Re.map(ui),mt=ge.reduce(Qi,{}),Ge=Re.reduce(Qi,{}),dt=$e.slice(),_t=Object.create(null);let lt,ut,bt,qt,cn,Gn,On;for(lt=0,ut=0;lt<$e.length;lt++)bt=$e[lt],Ge.hasOwnProperty(bt)?ut++:(We.push({command:sn.removeLayer,args:[bt]}),dt.splice(dt.indexOf(bt,ut),1));for(lt=0,ut=0;lt<Ye.length;lt++)bt=Ye[Ye.length-1-lt],dt[dt.length-1-lt]!==bt&&(mt.hasOwnProperty(bt)?(We.push({command:sn.removeLayer,args:[bt]}),dt.splice(dt.lastIndexOf(bt,dt.length-ut),1)):ut++,Gn=dt[dt.length-lt],We.push({command:sn.addLayer,args:[Ge[bt],Gn]}),dt.splice(dt.length-lt,0,bt),_t[bt]=!0);for(lt=0;lt<Ye.length;lt++)if(bt=Ye[lt],qt=mt[bt],cn=Ge[bt],!_t[bt]&&!Q(qt,cn))if(Q(qt.source,cn.source)&&Q(qt["source-layer"],cn["source-layer"])&&Q(qt.type,cn.type)){for(On in Kn(qt.layout,cn.layout,We,bt,null,sn.setLayoutProperty),Kn(qt.paint,cn.paint,We,bt,null,sn.setPaintProperty),Q(qt.filter,cn.filter)||We.push({command:sn.setFilter,args:[bt,cn.filter]}),Q(qt.minzoom,cn.minzoom)&&Q(qt.maxzoom,cn.maxzoom)||We.push({command:sn.setLayerZoomRange,args:[bt,cn.minzoom,cn.maxzoom]}),qt)qt.hasOwnProperty(On)&&"layout"!==On&&"paint"!==On&&"filter"!==On&&"metadata"!==On&&"minzoom"!==On&&"maxzoom"!==On&&(0===On.indexOf("paint.")?Kn(qt[On],cn[On],We,bt,On.slice(6),sn.setPaintProperty):Q(qt[On],cn[On])||We.push({command:sn.setLayerProperty,args:[bt,On,cn[On]]}));for(On in cn)cn.hasOwnProperty(On)&&!qt.hasOwnProperty(On)&&"layout"!==On&&"paint"!==On&&"filter"!==On&&"metadata"!==On&&"minzoom"!==On&&"maxzoom"!==On&&(0===On.indexOf("paint.")?Kn(qt[On],cn[On],We,bt,On.slice(6),sn.setPaintProperty):Q(qt[On],cn[On])||We.push({command:sn.setLayerProperty,args:[bt,On,cn[On]]}))}else We.push({command:sn.removeLayer,args:[bt]}),Gn=dt[dt.lastIndexOf(bt)+1],We.push({command:sn.addLayer,args:[cn,Gn]})}(oe,T.layers,I)}catch(B){console.warn("Unable to compute style diff:",B),I=[{command:sn.setStyle,args:[T]}]}return I}(this.serialize(),n).filter(x=>!(x.command in pi));if(0===u.length)return!1;const _=u.filter(x=>!(x.command in en));if(_.length>0)throw new Error(`Unimplemented: ${_.map(x=>x.command).join(", ")}.`);return u.forEach(x=>{"setTransition"!==x.command&&this[x.command].apply(this,x.args)}),this.stylesheet=n,this.updateProjection(),!0}addImage(n,u){if(this.getImage(n))return this.fire(new a.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(n,u),this._afterImageUpdated(n)}updateImage(n,u){this.imageManager.updateImage(n,u)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){if(!this.getImage(n))return this.fire(new a.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(n),this._afterImageUpdated(n)}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(n,u,_={}){if(this._checkLoaded(),void 0!==this.getSource(n))throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(a.validateStyle.source,`sources.${n}`,u,null,_))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const x=ur(n,u,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:x.serialize(),sourceId:n}));const T=I=>{const B=(I?"symbol:":"other:")+n,J=this._sourceCaches[B]=new a.SourceCache(B,x,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[n]=J,J.style=this,J.onAdd(this.map)};T(!1),"vector"!==u.type&&"geojson"!==u.type||T(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(n){this._checkLoaded();const u=this.getSource(n);if(void 0===u)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===n)return this.fire(new a.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===n)return this.fire(new a.ErrorEvent(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(n);for(const x of _)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(n,u){this._checkLoaded(),this.getSource(n).setData(u),this._changed=!0}getSource(n){const u=this._getSourceCache(n);return u&&u.getSource()}addLayer(n,u,_={}){this._checkLoaded();const x=n.id;if(this.getLayer(x))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let T;if("custom"===n.type){if(At(this,a.validateCustomStyleLayer(n)))return;T=a.createStyleLayer(n)}else{if("object"==typeof n.source&&(this.addSource(x,n.source),n=a.clone$1(n),n=a.extend(n,{source:x})),this._validate(a.validateStyle.layer,`layers.${x}`,n,{arrayIndex:-1},_))return;T=a.createStyleLayer(n),this._validateLayer(T),T.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[T.id]=T.serialize(),this._updateLayerCount(T,!0)}const I=u?this._order.indexOf(u):this._order.length;if(u&&-1===I)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(I,0,x),this._layerOrderChanged=!0,this._layers[x]=T;const B=this._getLayerSourceCache(T);if(this._removedLayers[x]&&T.source&&B&&"custom"!==T.type){const J=this._removedLayers[x];delete this._removedLayers[x],J.type!==T.type?this._updatedSources[T.source]="clear":(this._updatedSources[T.source]="reload",B.pause())}this._updateLayer(T),T.onAdd&&T.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(n,u){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===u)return;const _=this._order.indexOf(n);this._order.splice(_,1);const x=u?this._order.indexOf(u):this._order.length;u&&-1===x?this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(x,0,n),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(n){this._checkLoaded();const u=this._layers[n];if(!u)return void this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const _=this._order.indexOf(n);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=u,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}hasLayerType(n){for(const u in this._layers)if(this._layers[u].type===n)return!0;return!1}setLayerZoomRange(n,u,_){this._checkLoaded();const x=this.getLayer(n);x?x.minzoom===u&&x.maxzoom===_||(null!=u&&(x.minzoom=u),null!=_&&(x.maxzoom=_),this._updateLayer(x)):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(n,u,_={}){this._checkLoaded();const x=this.getLayer(n);if(x){if(!Q(x.filter,u))return null==u?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(a.validateStyle.filter,`layers.${x.id}.filter`,u,{layerType:x.type},_)||(x.filter=a.clone$1(u),this._updateLayer(x)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be filtered.`)))}getFilter(n){return a.clone$1(this.getLayer(n).filter)}setLayoutProperty(n,u,_,x={}){this._checkLoaded();const T=this.getLayer(n);T?Q(T.getLayoutProperty(u),_)||(T.setLayoutProperty(u,_,x),this._updateLayer(T)):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(n,u){const _=this.getLayer(n);if(_)return _.getLayoutProperty(u);this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style.`)))}setPaintProperty(n,u,_,x={}){this._checkLoaded();const T=this.getLayer(n);T?Q(T.getPaintProperty(u),_)||(T.setPaintProperty(u,_,x)&&this._updateLayer(T),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(n,u){return this.getLayer(n).getPaintProperty(u)}setFeatureState(n,u){this._checkLoaded();const _=n.source,x=n.sourceLayer,T=this.getSource(_);if(void 0===T)return void this.fire(new a.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const I=T.type;if("geojson"===I&&x)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===I&&!x)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===n.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const B=this._getSourceCaches(_);for(const J of B)J.setFeatureState(x,n.id,u)}removeFeatureState(n,u){this._checkLoaded();const _=n.source,x=this.getSource(_);if(void 0===x)return void this.fire(new a.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const T=x.type,I="vector"===T?n.sourceLayer:void 0;if("vector"===T&&!I)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&"string"!=typeof n.id&&"number"!=typeof n.id)return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const B=this._getSourceCaches(_);for(const J of B)J.removeFeatureState(I,n.id,u)}getFeatureState(n){this._checkLoaded();const u=n.source,_=n.sourceLayer,x=this.getSource(u);if(void 0!==x){if("vector"!==x.type||_)return void 0===n.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(_,n.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n={};for(const u in this._sourceCaches){const _=this._sourceCaches[u].getSource();n[_.id]||(n[_.id]=_.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:n,layers:this._serializeLayers(this._order)},u=>void 0!==u)}_updateLayer(n){this._updatedLayers[n.id]=!0;const u=this._getLayerSourceCache(n);n.source&&!this._updatedSources[n.source]&&u&&"raster"!==u.getSource().type&&(this._updatedSources[n.source]="reload",u.pause()),this._changed=!0,n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const u=I=>"fill-extrusion"===this._layers[I].type,_={},x=[];for(let I=this._order.length-1;I>=0;I--){const B=this._order[I];if(u(B)){_[B]=I;for(const J of n){const oe=J[B];if(oe)for(const ce of oe)x.push(ce)}}}x.sort((I,B)=>B.intersectionZ-I.intersectionZ);const T=[];for(let I=this._order.length-1;I>=0;I--){const B=this._order[I];if(u(B))for(let J=x.length-1;J>=0;J--){const oe=x[J].feature;if(_[oe.layer.id]<I)break;T.push(oe),x.pop()}else for(const J of n){const oe=J[B];if(oe)for(const ce of oe)T.push(ce.feature)}}return T}queryRenderedFeatures(n,u,_){u&&u.filter&&this._validate(a.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);const x={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const J of u.layers){const oe=this._layers[J];if(!oe)return this.fire(new a.ErrorEvent(new Error(`The layer '${J}' does not exist in the map's style and cannot be queried for features.`))),[];x[oe.source]=!0}}const T=[];u.availableImages=this._availableImages;const I=u&&u.layers?u.layers.some(J=>{const oe=this.getLayer(J);return oe&&oe.is3D()}):this.has3DLayers(),B=xi.createFromScreenPoints(n,_);for(const J in this._sourceCaches){const oe=this._sourceCaches[J].getSource().id;u.layers&&!x[oe]||T.push(K(this._sourceCaches[J],this._layers,this._serializedLayers,B,u,_,I,!!this.map._showQueryGeometry))}return this.placement&&T.push(function(J,oe,ce,ge,Re,We,$e){const Ye={},mt=We.queryRenderedSymbols(ge),Ge=[];for(const dt of Object.keys(mt).map(Number))Ge.push($e[dt]);Ge.sort(fe);for(const dt of Ge){const _t=dt.featureIndex.lookupSymbolFeatures(mt[dt.bucketInstanceId],oe,dt.bucketIndex,dt.sourceLayerIndex,Re.filter,Re.layers,Re.availableImages,J);for(const lt in _t){const ut=Ye[lt]=Ye[lt]||[],bt=_t[lt];bt.sort((qt,cn)=>{const Gn=dt.featureSortOrder;if(Gn){const On=Gn.indexOf(qt.featureIndex);return Gn.indexOf(cn.featureIndex)-On}return cn.featureIndex-qt.featureIndex});for(const qt of bt)ut.push(qt)}}for(const dt in Ye)Ye[dt].forEach(_t=>{const lt=_t.feature,ut=ce(J[dt]).getFeatureState(lt.layer["source-layer"],lt.id);lt.source=lt.layer.source,lt.layer["source-layer"]&&(lt.sourceLayer=lt.layer["source-layer"]),lt.state=ut});return Ye}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),B.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(T)}querySourceFeatures(n,u){u&&u.filter&&this._validate(a.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);const _=this._getSourceCaches(n);let x=[];for(const T of _)x=x.concat(F(T,u));return x}addSourceType(n,u,_){return ie.getSourceType(n)?_(new Error(`A source type called "${n}" already exists.`)):(ie.setSourceType(n,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:u.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(n,u={}){this._checkLoaded();const _=this.light.getLight();let x=!1;for(const I in n)if(!Q(n[I],_[I])){x=!0;break}if(!x)return;const T={now:a.exported.now(),transition:a.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(n,u),this.light.updateTransitions(T)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n,u=1){if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===u){if("object"==typeof n.source){const _="terrain-dem-src";this.addSource(_,n.source),n=a.clone$1(n),n=a.extend(n,{source:_})}if(this._validate(a.validateStyle.terrain,"terrain",n))return}if(!this.terrain||this.terrain&&u!==this.terrain.drapeRenderMode)this._createTerrain(n,u);else{const _=this.terrain,x=_.get();for(const T in n)if(!Q(n[T],x[T])){_.set(n),this.stylesheet.terrain=n;const I={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};_.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const u=this.fog=new Tt(n,this.map.transform);this.stylesheet.fog=n;const _={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(_)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,_=u.get();for(const x in n)if(!Q(n[x],_[x])){u.set(n),this.stylesheet.fog=n;const T={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(T);break}}else this._createFog(n);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const n=this._order.filter(_=>this.isLayerDraped(this._layers[_])),u=this._order.filter(_=>!this.isLayerDraped(this._layers[_]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...u)}_createTerrain(n,u){const _=this.terrain=new Ne(n,u);this.stylesheet.terrain=n,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const x={now:a.exported.now(),transition:a.extend({duration:0},this.stylesheet.transition)};_.updateTransitions(x)}_force3DLayerUpdate(){for(const n in this._layers){const u=this._layers[n];"fill-extrusion"===u.type&&this._updateLayer(u)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const u=this._layers[n];"symbol"===u.type&&this._updateLayer(u)}}_validate(n,u,_,x,T={}){return(!T||!1!==T.validate)&&At(this,n.call(a.validateStyle,a.extend({key:u,style:this.serialize(),value:_,styleSpec:a.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this._sourceCaches)this._sourceCaches[n].clearTiles(),this._sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){const u=this._getSourceCaches(n);for(const _ of u)_.clearTiles()}_reloadSource(n){const u=this._getSourceCaches(n);for(const _ of u)_.resume(),_.reload()}_updateSources(n){for(const u in this._sourceCaches)this._sourceCaches[u].update(n)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const u=this._sourceCaches[n];u.resume(),u.reload()}}_updatePlacement(n,u,_,x,T=!1){let I=!1,B=!1;const J={};for(const oe of this._order){const ce=this._layers[oe];if("symbol"!==ce.type)continue;if(!J[ce.source]){const Re=this._getLayerSourceCache(ce);if(!Re)continue;J[ce.source]=Re.getRenderableIds(!0).map(We=>Re.getTileByID(We)).sort((We,$e)=>$e.tileID.overscaledZ-We.tileID.overscaledZ||(We.tileID.isLessThan($e.tileID)?-1:1))}const ge=this.crossTileSymbolIndex.addLayer(ce,J[ce.source],n.center.lng,n.projection);I=I||ge}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),T=T||this._layerOrderChanged||0===_,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(T||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),n.zoom))&&(this.pauseablePlacement=new Wi(n,this._order,T,u,_,x,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,J),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),B=!0),I&&this.pauseablePlacement.placement.setStale()),B||I)for(const oe of this._order){const ce=this._layers[oe];"symbol"===ce.type&&this.placement.updateLayerOpacities(ce,J[ce.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,u,_){this.imageManager.getImages(u.icons,_),this._updateTilesForChangedImages();const x=T=>{T&&T.setDependencies(u.tileID.key,u.type,u.icons)};x(this._otherSourceCaches[u.source]),x(this._symbolSourceCaches[u.source])}getGlyphs(n,u,_){this.glyphManager.getGlyphs(u.stacks,_)}getResource(n,u,_){return a.makeRequest(u,_)}_getSourceCache(n){return this._otherSourceCaches[n]}_getLayerSourceCache(n){return"symbol"===n.type?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}_getSourceCaches(n){const u=[];return this._otherSourceCaches[n]&&u.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&u.push(this._symbolSourceCaches[n]),u}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ie.getSourceType=function(g){return Xi[g]},ie.setSourceType=function(g,n){Xi[g]=n},ie.registerForPluginStateChange=a.registerForPluginStateChange;var ue="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",we="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Oe={},Dt={};Oe=yn("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",!0),Dt=yn("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const ht=yn("\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {\n#if defined(PROJECTION_GLOBE_VIEW) && !defined(PROJECTED_POS_ON_VIEWPORT)\nreturn mix(globe,mercator,t);\n#else\nreturn globe;\n#endif\n}\n#ifdef PROJECTION_GLOBE_VIEW\nmat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),fn=ue;var Dn={background:yn("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:yn("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:yn("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nvec2 scaled_extrude=extrude*a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=scaled_extrude.x*surface_vectors[0]+scaled_extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);vec4 world_center=vec4(pos,1);\n#else \nmat3 surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\n#if defined(SCALE_WITH_MAP) && defined(PROJECTION_GLOBE_VIEW)\nview_scale*=a_scale;\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:yn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yn("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;attribute float a_scale;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);\n#ifdef PROJECTION_GLOBE_VIEW\nextrude*=a_scale;vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\nvec3 pos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:yn("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:yn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:yn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:yn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:yn("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:yn("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:yn("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:yn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:yn("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(pos.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:yn("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:yn("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yn("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:yn("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:yn("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:yn("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:yn("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:yn("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:yn("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec3 mercator_pos=mercator_tile_position(u_inv_rot_matrix,tileAnchor,u_tile_id,u_merc_center);vec3 world_pos=mix_globe_mercator(vec3(a_pos,anchorZ)+h,mercator_pos,u_zoom_transition);vec4 projectedPoint=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec3 proj_pos=mix_globe_mercator(vec3(a_projected_pos.xy,anchorZ),mercator_pos,u_zoom_transition);\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(proj_pos.xyz+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:yn("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:yn("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:yn("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",we),skyboxGradient:yn("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",we),skyboxCapture:yn("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:yn("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {gl_FragColor=texture2D(u_image0,v_pos0);\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;attribute vec3 a_globe_pos;attribute vec2 a_merc_pos;attribute vec2 a_uv;varying vec2 v_pos0;const float wireframeOffset=1e3;void main() {v_pos0=a_uv;vec2 uv=a_uv*EXTENT;vec4 up_vector=vec4(elevationVector(uv),1.0);float height=elevation(uv);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nvec4 globe=u_globe_matrix*vec4(a_globe_pos+up_vector.xyz*height,1.0);vec4 mercator=vec4(0.0);if (u_zoom_transition > 0.0) {mercator=vec4(a_merc_pos,height,1.0);mercator.xy-=u_merc_center;mercator.x=wrap(mercator.x,-0.5,0.5);mercator=u_merc_matrix*mercator;}vec3 position=mix(globe.xyz,mercator.xyz,u_zoom_transition);gl_Position=u_proj_matrix*vec4(position,1.0);}"),globeAtmosphere:yn("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform highp float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {highp vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}","attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}")};function yn(g,n,u){const _=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,T=n.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),I=g.match(x),B=n.match(x),J=ue.match(x);let oe=B?B.concat(I):I;u||(Oe.staticUniforms&&(oe=Oe.staticUniforms.concat(oe)),Dt.staticUniforms&&(oe=Dt.staticUniforms.concat(oe))),oe&&(oe=oe.concat(J));const ce={};return{fragmentSource:g=g.replace(_,(ge,Re,We,$e,Ye)=>(ce[Ye]=!0,"define"===Re?`\n#ifndef HAS_UNIFORM_u_${Ye}\nvarying ${We} ${$e} ${Ye};\n#else\nuniform ${We} ${$e} u_${Ye};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${Ye}\n    ${We} ${$e} ${Ye} = u_${Ye};\n#endif\n`)),vertexSource:n=n.replace(_,(ge,Re,We,$e,Ye)=>{const mt="float"===$e?"vec2":"vec4",Ge=Ye.match(/color/)?"color":mt;return ce[Ye]?"define"===Re?`\n#ifndef HAS_UNIFORM_u_${Ye}\nuniform lowp float u_${Ye}_t;\nattribute ${We} ${mt} a_${Ye};\nvarying ${We} ${$e} ${Ye};\n#else\nuniform ${We} ${$e} u_${Ye};\n#endif\n`:"vec4"===Ge?`\n#ifndef HAS_UNIFORM_u_${Ye}\n    ${Ye} = a_${Ye};\n#else\n    ${We} ${$e} ${Ye} = u_${Ye};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Ye}\n    ${Ye} = unpack_mix_${Ge}(a_${Ye}, u_${Ye}_t);\n#else\n    ${We} ${$e} ${Ye} = u_${Ye};\n#endif\n`:"define"===Re?`\n#ifndef HAS_UNIFORM_u_${Ye}\nuniform lowp float u_${Ye}_t;\nattribute ${We} ${mt} a_${Ye};\n#else\nuniform ${We} ${$e} u_${Ye};\n#endif\n`:"vec4"===Ge?`\n#ifndef HAS_UNIFORM_u_${Ye}\n    ${We} ${$e} ${Ye} = a_${Ye};\n#else\n    ${We} ${$e} ${Ye} = u_${Ye};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${Ye}\n    ${We} ${$e} ${Ye} = unpack_mix_${Ge}(a_${Ye}, u_${Ye}_t);\n#else\n    ${We} ${$e} ${Ye} = u_${Ye};\n#endif\n`}),staticAttributes:T,staticUniforms:oe}}class oi{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(n,u,_,x,T,I,B,J){this.context=n;let oe=this.boundPaintVertexBuffers.length!==x.length;for(let ce=0;!oe&&ce<x.length;ce++)this.boundPaintVertexBuffers[ce]!==x[ce]&&(oe=!0);n.extVertexArrayObject&&this.vao&&this.boundProgram===u&&this.boundLayoutVertexBuffer===_&&!oe&&this.boundIndexBuffer===T&&this.boundVertexOffset===I&&this.boundDynamicVertexBuffer===B&&this.boundDynamicVertexBuffer2===J?(n.bindVertexArrayOES.set(this.vao),B&&B.bind(),T&&T.dynamicDraw&&T.bind(),J&&J.bind()):this.freshBind(u,_,x,T,I,B,J)}freshBind(n,u,_,x,T,I,B){let J;const oe=n.numAttributes,ce=this.context,ge=ce.gl;if(ce.extVertexArrayObject)this.vao&&this.destroy(),this.vao=ce.extVertexArrayObject.createVertexArrayOES(),ce.bindVertexArrayOES.set(this.vao),J=0,this.boundProgram=n,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=x,this.boundVertexOffset=T,this.boundDynamicVertexBuffer=I,this.boundDynamicVertexBuffer2=B;else{J=ce.currentNumAttributes||0;for(let Re=oe;Re<J;Re++)ge.disableVertexAttribArray(Re)}u.enableAttributes(ge,n);for(const Re of _)Re.enableAttributes(ge,n);I&&I.enableAttributes(ge,n),B&&B.enableAttributes(ge,n),u.bind(),u.setVertexAttribPointers(ge,n,T);for(const Re of _)Re.bind(),Re.setVertexAttribPointers(ge,n,T);I&&(I.bind(),I.setVertexAttribPointers(ge,n,T)),x&&x.bind(),B&&(B.bind(),B.setVertexAttribPointers(ge,n,T)),ce.currentNumAttributes=oe}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Pi(g,n){const u=Math.pow(2,n.canonical.z),_=n.canonical.y;return[new a.MercatorCoordinate(0,_/u).toLngLat().lat,new a.MercatorCoordinate(0,(_+1)/u).toLngLat().lat]}function Mi(g,n,u,_,x,T,I){const B=g.context,J=B.gl,oe=u.fbo;if(!oe)return;g.prepareDrawTile(n);const ce=g.useProgram("hillshade");B.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,oe.colorAttachment.get());const ge=((Ye,mt,Ge,dt)=>{const _t=Ge.paint.get("hillshade-shadow-color"),lt=Ge.paint.get("hillshade-highlight-color"),ut=Ge.paint.get("hillshade-accent-color");let bt=Ge.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ge.paint.get("hillshade-illumination-anchor")&&(bt-=Ye.transform.angle);const qt=!Ye.options.moving;return{u_matrix:dt||Ye.transform.calculateProjMatrix(mt.tileID.toUnwrapped(),qt),u_image:0,u_latrange:Pi(0,mt.tileID),u_light:[Ge.paint.get("hillshade-exaggeration"),bt],u_shadow:_t,u_highlight:lt,u_accent:ut}})(g,u,_,g.terrain?n.projMatrix:null);g.prepareDrawProgram(B,ce,n.toUnwrapped());const{tileBoundsBuffer:Re,tileBoundsIndexBuffer:We,tileBoundsSegments:$e}=g.getTileBoundsBuffers(u);ce.draw(B,J.TRIANGLES,x,T,I,a.CullFaceMode.disabled,ge,_.id,Re,We,$e)}function bi(g,n,u){if(!n.needsDEMTextureUpload)return;const _=g.context,x=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||g.getTileTexture(u.stride);const T=u.getPixels();n.demTexture?n.demTexture.update(T,{premultiply:!1}):n.demTexture=new a.Texture(_,T,x.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function gr(g,n,u,_,x,T){const I=g.context,B=I.gl;if(!n.dem)return;const J=n.dem;if(I.activeTexture.set(B.TEXTURE1),bi(g,n,J),!n.demTexture)return;n.demTexture.bind(B.NEAREST,B.CLAMP_TO_EDGE);const oe=J.dim;I.activeTexture.set(B.TEXTURE0);let ce=n.fbo;if(!ce){const $e=new a.Texture(I,{width:oe,height:oe,data:null},B.RGBA);$e.bind(B.LINEAR,B.CLAMP_TO_EDGE),ce=n.fbo=I.createFramebuffer(oe,oe,!0),ce.colorAttachment.set($e.texture)}I.bindFramebuffer.set(ce.framebuffer),I.viewport.set([0,0,oe,oe]);const{tileBoundsBuffer:ge,tileBoundsIndexBuffer:Re,tileBoundsSegments:We}=g.getMercatorTileBoundsBuffers();g.useProgram("hillshadePrepare").draw(I,B.TRIANGLES,_,x,T,a.CullFaceMode.disabled,(($e,Ye)=>{const mt=Ye.stride,Ge=a.create();return a.ortho(Ge,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Ge,Ge,[0,-a.EXTENT,0]),{u_matrix:Ge,u_image:1,u_dimension:[mt,mt],u_zoom:$e.overscaledZ,u_unpack:Ye.unpackVector}})(n.tileID,J),u.id,ge,Re,We),n.needsHillshadePrepare=!1}const Di=(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_image0:new a.Uniform1i(g,n.u_image0),u_skirt_height:new a.Uniform1f(g,n.u_skirt_height)}),Ci=(g,n)=>({u_matrix:g,u_image0:0,u_skirt_height:n}),dr=(g,n,u,_,x)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:n,u_merc_matrix:u,u_zoom_transition:_,u_merc_center:x,u_image0:0});function nr(g,n){return null!=g&&null!=n&&!(!g.hasData()||!n.hasData())&&null!=g.demTexture&&null!=n.demTexture&&g.tileID.key!==n.tileID.key}const io=new class{constructor(){this.operations={}}newMorphing(g,n,u,_,x){if(g in this.operations){const T=this.operations[g];T.to.tileID.key!==u.tileID.key&&(T.queued=u)}else this.operations[g]={startTime:_,phase:0,duration:x,from:n,to:u,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const n=this.operations[g];return{from:n.from,to:n.to,phase:n.phase}}update(g){for(const n in this.operations){const u=this.operations[n];for(u.phase=(g-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,g)){delete this.operations[n];break}}}_nextOp(g,n){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=n,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},ho={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Hr(g,n){const u=1<<g.z;return!n&&(0===g.x||g.x===u-1)||0===g.y||g.y===u-1}const go=g=>({u_matrix:g});function Wr(g,n,u,_,x){if(x>0){const T=a.exported.now(),I=(T-g.timeAdded)/x,B=n?(T-n.timeAdded)/x:-1,J=u.getSource(),oe=_.coveringZoomLevel({tileSize:J.tileSize,roundZoom:J.roundZoom}),ce=!n||Math.abs(n.tileID.overscaledZ-oe)>Math.abs(g.tileID.overscaledZ-oe),ge=ce&&g.refreshedUponExpiration?1:a.clamp(ce?I:1-B,0,1);return g.refreshedUponExpiration&&I>=1&&(g.refreshedUponExpiration=!1),n?{opacity:1,mix:1-ge}:{opacity:ge,mix:0}}return{opacity:1,mix:0}}class se extends a.SourceCache{constructor(n){const u={type:"raster-dem",maxzoom:n.transform.maxZoom},_=new Ct(tt(),null),x=ur("mock-dem",u,_,n.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,u){n.state="loaded",u(null)}}class Ce extends a.SourceCache{constructor(n){const u=ur("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new Ct(tt(),null),n.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,u,_){if(n.freezeTileCoverage)return;this.transform=n;const x=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((T,I)=>{if(T[I.key]="",!this._tiles[I.key]){const B=new a.Tile(I,this._source.tileSize*I.overscaleFactor(),n.tileZoom);B.state="loaded",this._tiles[I.key]=B}return T},{});for(const T in this._tiles)T in x||(this.freeFBO(T),this._tiles[T].unloadVectorData(),delete this._tiles[T])}freeFBO(n){const u=this.proxyCachedFBO[n];if(void 0!==u){const _=Object.values(u);this.renderCachePool.push(..._),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class ae extends a.OverscaledTileID{constructor(n,u,_){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=u,this.projMatrix=_}}class ze extends a.Elevation{constructor(n,u){super(),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,x,T]=function(J){const oe=new a.StructArrayLayout4i8,ce=new a.StructArrayLayout3ui6;oe.reserve(17161),ce.reserve(33800);const Re=a.EXTENT/128,We=a.EXTENT+Re/2,$e=We+Re;for(let mt=-Re;mt<$e;mt+=Re)for(let Ge=-Re;Ge<$e;Ge+=Re){const dt=Ge<0||Ge>We||mt<0||mt>We?24575:0,_t=a.clamp(Math.round(Ge),0,a.EXTENT),lt=a.clamp(Math.round(mt),0,a.EXTENT);oe.emplaceBack(_t+dt,lt,_t,lt)}const Ye=(mt,Ge)=>{const dt=131*Ge+mt;ce.emplaceBack(dt+1,dt,dt+131),ce.emplaceBack(dt+131,dt+131+1,dt+1)};for(let mt=1;mt<129;mt++)for(let Ge=1;Ge<129;Ge++)Ye(Ge,mt);return[0,129].forEach(mt=>{for(let Ge=0;Ge<130;Ge++)Ye(Ge,mt),Ye(mt,Ge)}),[oe,ce,32768]}(),I=n.context;this.gridBuffer=I.createVertexBuffer(_,a.boundsAttributes.members),this.gridIndexBuffer=I.createIndexBuffer(x),this.gridSegments=a.SegmentVector.simpleSegment(0,0,_.length,x.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,_.length,T),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ce(u.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,0,a.EXTENT,0,a.EXTENT,0,1);const B=I.gl;this._overlapStencilMode=new a.StencilMode({func:B.GEQUAL,mask:255},0,255,B.KEEP,B.KEEP,B.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new se(u.map)}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),n.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=n,this._checkRenderCacheEfficiency()}update(n,u,_){if(n&&n.terrain){this._style!==n&&(this.style=n),this.enabled=!0;const x=n.terrain.properties;this.sourceCache=0===n.terrain.drapeRenderMode?this._mockSourceCache:n._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const T=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const I=this.getScaledDemTileSize();this.sourceCache.update(u,I,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,T(),this._initializing=!0),T(),u.updateElevation(!_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const n=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==n.efficiency&&a.warnOnce(`Terrain render cache efficiency is not optimal (${n.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${n.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(n){n.coord&&"source"===n.dataType?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):"style"===n.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._sourceCaches)this._style._sourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=0===_._centerAltitude&&-1===this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(_.center),-1),this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=u.getIds().map(J=>{const oe=u.getTileByID(J).tileID;return oe.projMatrix=_.calculateProjMatrix(oe.toUnwrapped()),oe});(function(J,oe){const ce=oe.transform.pointCoordinate(oe.transform.getCameraPoint()),ge=new a.pointGeometry(ce.x,ce.y);J.sort((Re,We)=>{if(We.overscaledZ-Re.overscaledZ)return We.overscaledZ-Re.overscaledZ;const $e=new a.pointGeometry(Re.canonical.x+(1<<Re.canonical.z)*Re.wrap,Re.canonical.y),Ye=new a.pointGeometry(We.canonical.x+(1<<We.canonical.z)*We.wrap,We.canonical.y),mt=ge.mult(1<<Re.canonical.z);return mt.x-=.5,mt.y-=.5,mt.distSqr($e)-mt.distSqr(Ye)})})(x,this.painter),this._previousZoom=_.zoom;const T=this.proxyToSource||{};this.proxyToSource={},x.forEach(J=>{this.proxyToSource[J.key]={}}),this.terrainTileForTile={};const I=this._style._sourceCaches;for(const J in I){const oe=I[J];if(!oe.used||(oe!==this.sourceCache&&this.resetTileLookupCache(oe.id),this._setupProxiedCoordsForOrtho(oe,n[J],T),oe.usedForTerrain))continue;const ce=n[J];oe.getSource().reparseOverscaled&&this._assignTerrainTiles(ce)}this.proxiedCoords[u.id]=x.map(J=>new ae(J,J.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(T),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const B={};this._visibleDemTiles=[];for(const J of this.proxyCoords){const oe=this.terrainTileForTile[J.key];if(!oe)continue;const ce=oe.tileID.key;ce in B||(this._visibleDemTiles.push(oe),B[ce]=ce)}}_assignTerrainTiles(n){this._initializing||n.forEach(u=>{if(this.terrainTileForTile[u.key])return;const _=this._findTileCoveringTileID(u,this.sourceCache);_&&(this.terrainTileForTile[u.key]=_)})}_prepareDEMTextures(){const n=this.painter.context,u=n.gl;for(const _ in this.terrainTileForTile){const x=this.terrainTileForTile[_],T=x.dem;!T||x.demTexture&&!x.needsDEMTextureUpload||(n.activeTexture.set(u.TEXTURE1),bi(this.painter,x,T))}}_prepareDemTileUniforms(n,u,_,x){if(!u||null==u.demTexture)return!1;const T=n.tileID.canonical,I=Math.pow(2,u.tileID.canonical.z-T.z),B=x||"";return _[`u_dem_tl${B}`]=[T.x*I%1,T.y*I%1],_[`u_dem_scale${B}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const n=this.painter.context,u=n.gl;if(!this._emptyDepthBufferTexture){const _={width:1,height:1,data:new Uint8Array([255,255,255,255])};this._emptyDepthBufferTexture=new a.Texture(n,_,u.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let n=0;const u=this._visibleDemTiles.reduce((_,x)=>{if(!x.dem)return _;const T=x.dem.tree.minimums[0];return T>0&&n++,_+T},0);return n?u/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,u=n.gl;n.activeTexture.set(u.TEXTURE2);const _=this._getLoadedAreaMinimum(),x={width:1,height:1,data:new Uint8Array(a.DEMData.pack(_,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let T=this._emptyDEMTexture;return T?T.update(x,{premultiply:!1}):T=this._emptyDEMTexture=new a.Texture(n,x,u.RGBA,{premultiply:!1}),T}setupElevationDraw(n,u,_){const x=this.painter.context,T=x.gl,I=(B=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(B),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var B;I.u_dem_size=this.sourceCache.getSource().tileSize,I.u_exaggeration=this.exaggeration();const J=this.painter.transform,oe=J.projection.createTileTransform(J,J.worldSize),ce=n.tileID.canonical;I.u_tile_tl_up=oe.upVector(ce,0,0),I.u_tile_tr_up=oe.upVector(ce,a.EXTENT,0),I.u_tile_br_up=oe.upVector(ce,a.EXTENT,a.EXTENT),I.u_tile_bl_up=oe.upVector(ce,0,a.EXTENT),I.u_tile_up_scale=oe.upVectorScale(ce);let ge=null,Re=null,We=1;if(_&&_.morphing&&this._useVertexMorphing){const $e=_.morphing.srcDemTile,Ye=_.morphing.dstDemTile;We=_.morphing.phase,$e&&Ye&&(this._prepareDemTileUniforms(n,$e,I,"_prev")&&(Re=$e),this._prepareDemTileUniforms(n,Ye,I)&&(ge=Ye))}if(Re&&ge?(x.activeTexture.set(T.TEXTURE2),ge.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),x.activeTexture.set(T.TEXTURE4),Re.demTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE,T.NEAREST),I.u_dem_lerp=We):(ge=this.terrainTileForTile[n.tileID.key],x.activeTexture.set(T.TEXTURE2),(this._prepareDemTileUniforms(n,ge,I)?ge.demTexture:this.emptyDEMTexture).bind(T.NEAREST,T.CLAMP_TO_EDGE)),x.activeTexture.set(T.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),I.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]):(this.emptyDepthBufferTexture.bind(T.NEAREST,T.CLAMP_TO_EDGE),I.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&ge){const $e=(1<<ge.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=$e}_&&_.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),u.setTerrainUniformValues(x,I)}renderToBackBuffer(n){const u=this.painter,_=this.painter.context;0!==n.length&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,u.width,u.height]),this.renderingToTexture=!1,function(x,T,I,B,J){if("globe"===x.transform.projection.name)!function(oe,ce,ge,Re,We){const $e=oe.context,Ye=$e.gl;let mt,Ge;const dt=oe.options.showTerrainWireframe?2:0,_t=(Sn,mn)=>{if(Ge===Sn)return;const Xt=[];mn&&Xt.push(ho[dt]),Xt.push(ho[Sn]),Xt.push("PROJECTION_GLOBE_VIEW"),mt=oe.useProgram("globeRaster",null,Xt),Ge=Sn},lt=oe.colorModeForRenderPass(),ut=new a.DepthMode(Ye.LEQUAL,a.DepthMode.ReadWrite,oe.depthRangeFor3D);io.update(We);const bt=oe.transform,qt=a.calculateGlobeMatrix(bt,bt.worldSize),cn=a.calculateGlobeMercatorMatrix(bt),Gn=[a.mercatorXfromLng(bt.center.lng),a.mercatorYfromLat(bt.center.lat)],On=oe.globeSharedBuffers;(dt?[!1,!0]:[!1]).forEach(Sn=>{Ge=-1;const mn=Sn?Ye.LINES:Ye.TRIANGLES;for(const Xt of Re){const Cn=ge.getTile(Xt),bn=Math.pow(2,Xt.canonical.z),[Ti,Vi]=a.globeBuffersForTileMesh(oe,Cn,Xt,bn),wr=a.StencilMode.disabled,$n=ce.prevTerrainTileForTile[Xt.key],Fi=ce.terrainTileForTile[Xt.key];nr($n,Fi)&&io.newMorphing(Xt.key,$n,Fi,We,250),$e.activeTexture.set(Ye.TEXTURE0),Cn.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE);const ar=io.getMorphValuesForProxy(Xt.key),Xr=ar?1:0,xo={};ar&&a.extend$1(xo,{morphing:{srcDemTile:ar.from,dstDemTile:ar.to,phase:a.easeCubicInOut(ar.phase)}});const or=a.globeMatrixForTile(Xt.canonical,qt),Ki=dr(bt.projMatrix,or,cn,a.globeToMercatorTransition(bt.zoom),Gn);if(_t(Xr,Sn),ce.setupElevationDraw(Cn,mt,xo),oe.prepareDrawProgram($e,mt,Xt.toUnwrapped()),On){const[Mo,ns]=Sn?On.getWirefameBuffer(oe.context):[On.gridIndexBuffer,On.gridSegments];mt.draw($e,mn,ut,wr,lt,a.CullFaceMode.backCCW,Ki,"globe_raster",Ti,Mo,ns)}if(!Sn){const Mo=[0===Xt.canonical.y?a.globePoleMatrixForTile(Xt.canonical,!1,bt):null,Xt.canonical.y===bn-1?a.globePoleMatrixForTile(Xt.canonical,!0,bt):null];for(const ns of Mo){if(!ns)continue;const vs=dr(bt.projMatrix,ns,ns,0,Gn);On&&mt.draw($e,mn,ut,wr,lt,a.CullFaceMode.disabled,vs,"globe_pole_raster",Vi,On.poleIndexBuffer,On.poleSegments)}}}})}(x,T,I,B,J);else{const oe=x.context,ce=oe.gl;let ge,Re;const We=x.options.showTerrainWireframe?2:0,$e=(_t,lt)=>{if(Re===_t)return;const ut=[ho[_t]];lt&&ut.push(ho[We]),ge=x.useProgram("terrainRaster",null,ut),Re=_t},Ye=x.colorModeForRenderPass(),mt=new a.DepthMode(ce.LEQUAL,a.DepthMode.ReadWrite,x.depthRangeFor3D);io.update(J);const Ge=x.transform,dt=6*Math.pow(1.5,22-Ge.zoom)*T.exaggeration();(We?[!1,!0]:[!1]).forEach(_t=>{Re=-1;const lt=_t?ce.LINES:ce.TRIANGLES,[ut,bt]=_t?T.getWirefameBuffer():[T.gridIndexBuffer,T.gridSegments];for(const qt of B){const cn=I.getTile(qt),Gn=a.StencilMode.disabled,On=T.prevTerrainTileForTile[qt.key],Sn=T.terrainTileForTile[qt.key];nr(On,Sn)&&io.newMorphing(qt.key,On,Sn,J,250),oe.activeTexture.set(ce.TEXTURE0),cn.texture.bind(ce.LINEAR,ce.CLAMP_TO_EDGE,ce.LINEAR_MIPMAP_NEAREST);const mn=io.getMorphValuesForProxy(qt.key),Xt=mn?1:0;let Cn;mn&&(Cn={morphing:{srcDemTile:mn.from,dstDemTile:mn.to,phase:a.easeCubicInOut(mn.phase)}});const bn=Ci(qt.projMatrix,Hr(qt.canonical,Ge.renderWorldCopies)?dt/10:dt);$e(Xt,_t),T.setupElevationDraw(cn,ge,Cn),x.prepareDrawProgram(oe,ge,qt.toUnwrapped()),ge.draw(oe,lt,mt,Gn,Ye,a.CullFaceMode.backCCW,bn,"terrain_raster",T.gridBuffer,ut,bt)}})}}(u,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,n.splice(0,n.length))}renderBatch(n){if(0===this._drapedRenderBatches.length)return n+1;this.renderingToTexture=!0;const u=this.painter,_=this.painter.context,x=this.proxySourceCache,T=this.proxiedCoords[x.id],I=this._drapedRenderBatches.shift(),B=[],J=u.style.order;let oe=0;for(const ce of T){const ge=x.getTileByID(ce.proxyTileKey),Re=x.proxyCachedFBO[ce.key]?x.proxyCachedFBO[ce.key][n]:void 0,We=void 0!==Re?x.renderCache[Re]:this.pool[oe++],$e=void 0!==Re;if(ge.texture=We.tex,$e&&!We.dirty){B.push(ge.tileID);continue}let Ye;_.bindFramebuffer.set(We.fb.framebuffer),this.renderedToTile=!1,We.dirty&&(_.clear({color:a.Color.transparent,stencil:0}),We.dirty=!1);for(let mt=I.start;mt<=I.end;++mt){const Ge=u.style._layers[J[mt]];if(Ge.isHidden(u.transform.zoom))continue;const dt=u.style._getLayerSourceCache(Ge),_t=dt?this.proxyToSource[ce.key][dt.id]:[ce];if(!_t)continue;const lt=_t;_.viewport.set([0,0,We.fb.width,We.fb.height]),Ye!==(dt?dt.id:null)&&(this._setupStencil(We,_t,Ge,dt),Ye=dt?dt.id:null),u.renderLayer(u,dt,Ge,lt)}this.renderedToTile?(We.dirty=!0,B.push(ge.tileID)):$e||--oe,5===oe&&(oe=0,this.renderToBackBuffer(B))}return this.renderToBackBuffer(B),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,u.width,u.height]),I.end+1}postRender(){}renderCacheEfficiency(n){const u=n.order.length;if(0===u)return{efficiency:100};let _,x=0,T=0,I=!1;for(let B=0;B<u;++B){const J=n._layers[n.order[B]];this._style.isLayerDraped(J)?(I&&++x,++T):I||(I=!0,_=J.id)}return 0===T?{efficiency:100}:{efficiency:100*(1-x/T),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{n=Math.min(n,u.dem.tree.minimums[0])}),0===n?n:(n-30)*this._exaggeration}raycast(n,u,_){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(T=>T.dem).map(T=>{const I=T.tileID,B=Math.pow(2,I.overscaledZ),{x:J,y:oe}=I.canonical,ce=J/B,ge=(J+1)/B,Re=oe/B,We=(oe+1)/B;return{minx:ce,miny:Re,maxx:ge,maxy:We,t:T.dem.tree.raycastRoot(ce,Re,ge,We,n,u,_),tile:T}});x.sort((T,I)=>(null!==T.t?T.t:Number.MAX_VALUE)-(null!==I.t?I.t:Number.MAX_VALUE));for(const T of x){if(null==T.t)return null;const I=T.tile.dem.tree.raycast(T.minx,T.miny,T.maxx,T.maxy,n,u,_);if(null!=I)return I}return null}_createFBO(){const n=this.painter.context,u=n.gl,_=this.drapeBufferSize;n.activeTexture.set(u.TEXTURE0);const x=new a.Texture(n,{width:_[0],height:_[1],data:null},u.RGBA);x.bind(u.LINEAR,u.CLAMP_TO_EDGE);const T=n.createFramebuffer(_[0],_[1],!1);return T.colorAttachment.set(x.texture),T.depthAttachment=new cr(n,T.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,T.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):T.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&!n.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:T,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const u=this._style._layers[n],_=u.isHidden(this.painter.transform.zoom),x=u.getCrossfadeParameters(),T=!!x&&1!==x.t,I=u.hasTransition();return"custom"!==u.type&&!_&&(T||I)})}_clearRasterFadeFromRenderCache(){let n=!1;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u]._source instanceof $i){n=!0;break}if(n)for(let u=0;u<this._style.order.length;++u){const _=this._style._layers[this._style.order[u]],x=_.isHidden(this.painter.transform.zoom),T=this._style._getLayerSourceCache(_);if("raster"!==_.type||x||!T)continue;const I=_.paint.get("raster-fade-duration");for(const B of this.proxyCoords){const J=this.proxyToSource[B.key][T.id];if(J)for(const oe of J){const ce=Wr(T.getTile(oe),T.findLoadedParent(oe,0),T,this.painter.transform,I);(1!==ce.opacity||0!==ce.mix)&&this._clearRenderCacheForTile(T.id,oe)}}}}_setupDrapedRenderBatches(){const n=this._style.order,u=n.length;if(0===u)return;const _=[];let x,T=0,I=this._style._layers[n[T]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++T<u;)I=this._style._layers[n[T]];for(;T<u;++T){const B=this._style._layers[n[T]];B.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(B)?void 0===x&&(x=T):void 0!==x&&(_.push({start:x,end:T-1}),x=void 0))}void 0!==x&&_.push({start:x,end:T-1}),this._drapedRenderBatches=_}_setupRenderCache(n){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const I=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let B=0;B<I.length;++B){const J=Object.values(I[B]);u.renderCachePool.push(...J)}}return}this._clearRasterFadeFromRenderCache();const _=this.proxyCoords,x=this._tilesDirty;for(let I=_.length-1;I>=0;I--){const B=_[I];if(u.getTileByID(B.key),void 0!==u.proxyCachedFBO[B.key]){const J=n[B.key],oe=this.proxyToSource[B.key];let ce=0;for(const ge in oe){const Re=oe[ge],We=J[ge];if(!We||We.length!==Re.length||Re.some(($e,Ye)=>$e!==We[Ye]||x[ge]&&x[ge].hasOwnProperty($e.key))){ce=-1;break}++ce}for(const ge in u.proxyCachedFBO[B.key])u.renderCache[u.proxyCachedFBO[B.key][ge]].dirty=ce<0||ce!==Object.values(J).length}}const T=[...this._drapedRenderBatches];T.sort((I,B)=>B.end-B.start-(I.end-I.start));for(const I of T)for(const B of _){if(u.proxyCachedFBO[B.key])continue;let J=u.renderCachePool.pop();void 0===J&&u.renderCache.length<50&&(J=u.renderCache.length,u.renderCache.push(this._createFBO())),void 0!==J&&(u.proxyCachedFBO[B.key]={},u.proxyCachedFBO[B.key][I.start]=J,u.renderCache[J].dirty=!0)}this._tilesDirty={}}_setupStencil(n,u,_,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const T=this.painter.context,I=T.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let B;if(_.isTileClipped())B=u.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);B=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+B>255&&(T.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=B,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(n,u){const _=this.painter,x=this.painter.context,T=x.gl;_._tileClippingMaskIDs={},x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const I=_.useProgram("clippingMask");for(const B of n){const J=_._tileClippingMaskIDs[B.key]=--u;I.draw(x,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},J,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,go(B.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(n){const u=this.painter.transform;if(n.x<0||n.x>u.width||n.y<0||n.y>u.height)return null;const _=[n.x,n.y,1,1];a.transformMat4$1(_,_,u.pixelMatrixInverse),a.scale$1(_,_,1/_[3]),_[0]/=u.worldSize,_[1]/=u.worldSize;const x=u._camera.position,T=a.mercatorZfromAltitude(1,u.center.lat),I=[x[0],x[1],x[2]/T,0],B=a.subtract([],_.slice(0,3),I);a.normalize(B,B);const J=this.raycast(I,B,this._exaggeration);return null!==J&&J?(a.scaleAndAdd(I,I,B,J),I[3]=I[2],I[2]*=T,I):null}drawDepth(){const n=this.painter,u=n.context,_=this.proxySourceCache,x=Math.ceil(n.width),T=Math.ceil(n.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===T||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const I=u.gl,B=u.createFramebuffer(x,T,!0);u.activeTexture.set(I.TEXTURE0);const J=new a.Texture(u,{width:x,height:T,data:null},I.RGBA);J.bind(I.NEAREST,I.CLAMP_TO_EDGE),B.colorAttachment.set(J.texture);const oe=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,x,T);B.depthAttachment.set(oe),this._depthFBO=B,this._depthTexture=J}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,x,T]),function(I,B,J,oe){if("globe"===I.transform.projection.name)return;const ce=I.context,ge=ce.gl;ce.clear({depth:1});const Re=I.useProgram("terrainDepth"),We=new a.DepthMode(ge.LESS,a.DepthMode.ReadWrite,I.depthRangeFor3D);for(const $e of oe){const Ye=J.getTile($e),mt=Ci($e.projMatrix,0);B.setupElevationDraw(Ye,Re),Re.draw(ce,ge.TRIANGLES,We,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,mt,"terrain_depth",B.gridBuffer,B.gridIndexBuffer,B.gridNoSkirtSegments)}}(n,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(n,u,_){if(n.getSource()instanceof zr)return this._setupProxiedCoordsForImageSource(n,u,_);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const x=this.proxiedCoords[n.id]=[],T=this.proxyCoords;for(let B=0;B<T.length;B++){const J=T[B],oe=this._findTileCoveringTileID(J,n);if(oe){const ce=this._createProxiedId(J,oe,_[J.key]&&_[J.key][n.id]);x.push(ce),this.proxyToSource[J.key][n.id]=[ce]}}let I=!1;for(let B=0;B<u.length;B++){const J=n.getTile(u[B]);if(!J||!J.hasData())continue;const oe=this._findTileCoveringTileID(J.tileID,this.proxySourceCache);if(oe&&oe.tileID.canonical.z!==J.tileID.canonical.z){const ce=this.proxyToSource[oe.tileID.key][n.id],ge=this._createProxiedId(oe.tileID,J,_[oe.tileID.key]&&_[oe.tileID.key][n.id]);ce?ce.splice(ce.length-1,0,ge):this.proxyToSource[oe.tileID.key][n.id]=[ge],x.push(ge),I=!0}}this._sourceTilesOverlap[n.id]=I}_setupProxiedCoordsForImageSource(n,u,_){if(!n.getSource().loaded())return;const x=this.proxiedCoords[n.id]=[],T=this.proxyCoords,I=n.getSource(),B=new a.pointGeometry(I.tileID.x,I.tileID.y)._div(1<<I.tileID.z),J=I.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((ce,ge)=>(ce.min.x=Math.min(ce.min.x,ge.x-B.x),ce.min.y=Math.min(ce.min.y,ge.y-B.y),ce.max.x=Math.max(ce.max.x,ge.x-B.x),ce.max.y=Math.max(ce.max.y,ge.y-B.y),ce),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),oe=(ce,ge)=>{const Re=ce.wrap+ce.canonical.x/(1<<ce.canonical.z),We=ce.canonical.y/(1<<ce.canonical.z),$e=a.EXTENT/(1<<ce.canonical.z),Ye=ge.wrap+ge.canonical.x/(1<<ge.canonical.z),mt=ge.canonical.y/(1<<ge.canonical.z);return Re+$e<Ye+J.min.x||Re>Ye+J.max.x||We+$e<mt+J.min.y||We>mt+J.max.y};for(let ce=0;ce<T.length;ce++){const ge=T[ce];for(let Re=0;Re<u.length;Re++){const We=n.getTile(u[Re]);if(!We||!We.hasData()||oe(ge,We.tileID))continue;const $e=this._createProxiedId(ge,We,_[ge.key]&&_[ge.key][n.id]),Ye=this.proxyToSource[ge.key][n.id];Ye?Ye.push($e):this.proxyToSource[ge.key][n.id]=[$e],x.push($e)}}}_createProxiedId(n,u,_){let x=this.orthoMatrix;if(_){const T=_.find(I=>I.key===u.tileID.key);if(T)return T}if(u.tileID.key!==n.key){const T=n.canonical.z-u.tileID.canonical.z;let I,B,J;x=a.create();const oe=u.tileID.wrap-n.wrap<<n.overscaledZ;T>0?(I=a.EXTENT>>T,B=I*((u.tileID.canonical.x<<T)-n.canonical.x+oe),J=I*((u.tileID.canonical.y<<T)-n.canonical.y)):(I=a.EXTENT<<-T,B=a.EXTENT*(u.tileID.canonical.x-(n.canonical.x+oe<<-T)),J=a.EXTENT*(u.tileID.canonical.y-(n.canonical.y<<-T))),a.ortho(x,0,I,0,I,0,1),a.translate(x,x,[B,J,0])}return new ae(u.tileID,n.key,x)}_findTileCoveringTileID(n,u){let _=u.getTile(n);if(_&&_.hasData())return _;const x=this._findCoveringTileCache[u.id],T=x[n.key];if(_=T?u.getTileByID(T):null,_&&_.hasData()||null===T)return _;let I=_?_.tileID:n,B=I.overscaledZ;const J=u.getSource().minzoom,oe=[];if(!T){const ge=u.getSource().maxzoom;if(n.canonical.z>=ge){const Re=n.canonical.z-ge;u.getSource().reparseOverscaled?(B=Math.max(n.canonical.z+2,u.transform.tileZoom),I=new a.OverscaledTileID(B,n.wrap,ge,n.canonical.x>>Re,n.canonical.y>>Re)):0!==Re&&(B=ge,I=new a.OverscaledTileID(B,n.wrap,ge,n.canonical.x>>Re,n.canonical.y>>Re))}I.key!==n.key&&(oe.push(I.key),_=u.getTile(I))}const ce=ge=>{oe.forEach(Re=>{x[Re]=ge}),oe.length=0};for(B-=1;B>=J&&(!_||!_.hasData());B--){_&&ce(_.tileID.key);const ge=I.calculateScaledKey(B);if(_=u.getTileByID(ge),_&&_.hasData())break;const Re=x[ge];if(null===Re)break;void 0===Re?oe.push(ge):_=u.getTileByID(Re)}return ce(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(n){this.renderedToTile=!0}_clearRenderCacheForTile(n,u){let _=this._tilesDirty[n];_||(_=this._tilesDirty[n]={}),_[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const n=function(u){let _,x,T;const I=new a.StructArrayLayout2ui4,B=131;for(x=1;x<129;x++){for(_=1;_<129;_++)T=x*B+_,I.emplaceBack(T,T+1),I.emplaceBack(T,T+B),I.emplaceBack(T+1,T+B),128===x&&I.emplaceBack(T+B,T+B+1);I.emplaceBack(T+1,T+1+B)}return I}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(n),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function St(g){const n=[];for(let u=0;u<g.length;u++){if(null===g[u])continue;const _=g[u].split(" ");n.push(_.pop())}return n}class tn{static cacheKey(n,u,_){let x=`${n}${_?_.cacheKey:""}`;for(const T of u)x+=`/${T}`;return x}constructor(n,u,_,x,T,I){const B=n.gl;this.program=B.createProgram();const J=St(_.staticAttributes),oe=x?x.getBinderAttributes():[],ce=J.concat(oe),ge=_.staticUniforms?St(_.staticUniforms):[],Re=x?x.getBinderUniforms():[],We=ge.concat(Re),$e=[];for(const ut of We)$e.indexOf(ut)<0&&$e.push(ut);let Ye=x?x.defines():[];Ye=Ye.concat(I.map(ut=>`#define ${ut}`));const mt=Ye.concat("\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",fn,ht.fragmentSource,Dt.fragmentSource,_.fragmentSource).join("\n"),Ge=Ye.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",fn,ht.vertexSource,Dt.vertexSource,Oe.vertexSource,_.vertexSource).join("\n"),dt=B.createShader(B.FRAGMENT_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);B.shaderSource(dt,mt),B.compileShader(dt),B.attachShader(this.program,dt);const _t=B.createShader(B.VERTEX_SHADER);if(B.isContextLost())return void(this.failedToCreate=!0);B.shaderSource(_t,Ge),B.compileShader(_t),B.attachShader(this.program,_t),this.attributes={};const lt={};this.numAttributes=ce.length;for(let ut=0;ut<this.numAttributes;ut++)ce[ut]&&(B.bindAttribLocation(this.program,ut,ce[ut]),this.attributes[ce[ut]]=ut);B.linkProgram(this.program),B.deleteShader(_t),B.deleteShader(dt);for(let ut=0;ut<$e.length;ut++){const bt=$e[ut];if(bt&&!lt[bt]){const qt=B.getUniformLocation(this.program,bt);qt&&(lt[bt]=qt)}}var ut,bt;this.fixedUniforms=T(n,lt),this.binderUniforms=x?x.getUniforms(n,lt):[],-1!==I.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new a.Uniform1i(ut=n,(bt=lt).u_dem),u_dem_prev:new a.Uniform1i(ut,bt.u_dem_prev),u_dem_unpack:new a.Uniform4f(ut,bt.u_dem_unpack),u_dem_tl:new a.Uniform2f(ut,bt.u_dem_tl),u_dem_scale:new a.Uniform1f(ut,bt.u_dem_scale),u_dem_tl_prev:new a.Uniform2f(ut,bt.u_dem_tl_prev),u_dem_scale_prev:new a.Uniform1f(ut,bt.u_dem_scale_prev),u_dem_size:new a.Uniform1f(ut,bt.u_dem_size),u_dem_lerp:new a.Uniform1f(ut,bt.u_dem_lerp),u_exaggeration:new a.Uniform1f(ut,bt.u_exaggeration),u_depth:new a.Uniform1i(ut,bt.u_depth),u_depth_size_inv:new a.Uniform2f(ut,bt.u_depth_size_inv),u_meter_to_dem:new a.Uniform1f(ut,bt.u_meter_to_dem),u_label_plane_matrix_inv:new a.UniformMatrix4f(ut,bt.u_label_plane_matrix_inv),u_tile_tl_up:new a.Uniform3f(ut,bt.u_tile_tl_up),u_tile_tr_up:new a.Uniform3f(ut,bt.u_tile_tr_up),u_tile_br_up:new a.Uniform3f(ut,bt.u_tile_br_up),u_tile_bl_up:new a.Uniform3f(ut,bt.u_tile_bl_up),u_tile_up_scale:new a.Uniform1f(ut,bt.u_tile_up_scale)}),-1!==I.indexOf("FOG")&&(this.fogUniforms=((ut,bt)=>({u_fog_matrix:new a.UniformMatrix4f(ut,bt.u_fog_matrix),u_fog_range:new a.Uniform2f(ut,bt.u_fog_range),u_fog_color:new a.Uniform4f(ut,bt.u_fog_color),u_fog_horizon_blend:new a.Uniform1f(ut,bt.u_fog_horizon_blend),u_fog_temporal_offset:new a.Uniform1f(ut,bt.u_fog_temporal_offset)}))(n,lt))}setTerrainUniformValues(n,u){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)_[x].set(u[x])}}setFogUniformValues(n,u){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const x in u)_[x].location&&_[x].set(u[x])}}draw(n,u,_,x,T,I,B,J,oe,ce,ge,Re,We,$e,Ye,mt){const Ge=n.gl;if(this.failedToCreate)return;n.program.set(this.program),n.setDepthMode(_),n.setStencilMode(x),n.setColorMode(T),n.setCullFace(I);for(const _t of Object.keys(this.fixedUniforms))this.fixedUniforms[_t].set(B[_t]);$e&&$e.setUniforms(n,this.binderUniforms,Re,{zoom:We});const dt={[Ge.LINES]:2,[Ge.TRIANGLES]:3,[Ge.LINE_STRIP]:1}[u];for(const _t of ge.get()){const lt=_t.vaos||(_t.vaos={});(lt[J]||(lt[J]=new oi)).bind(n,this,oe,$e?$e.getPaintVertexBuffers():[],ce,_t.vertexOffset,Ye,mt),Ge.drawElements(u,_t.primitiveLength*dt,Ge.UNSIGNED_SHORT,_t.primitiveOffset*dt*2)}}}function Ln(g,n,u){const _=1/gt(u,1,n.transform.tileZoom),x=Math.pow(2,u.tileID.overscaledZ),T=u.tileSize*Math.pow(2,n.transform.tileZoom)/x,I=T*(u.tileID.canonical.x+u.tileID.wrap*x),B=T*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[_,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[I>>16,B>>16],u_pixel_coord_lower:[65535&I,65535&B]}}const Yn=(g,n,u,_)=>{const x=n.style.light,T=x.properties.get("position"),I=[T.x,T.y,T.z],B=a.create$1();"viewport"===x.properties.get("anchor")&&(a.fromRotation(B,-n.transform.angle),a.transformMat3(I,I,B));const J=x.properties.get("color");return{u_matrix:g,u_lightpos:I,u_lightintensity:x.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+u,u_opacity:_}},Mr=(g,n,u,_,x,T,I)=>a.extend(Yn(g,n,u,_),Ln(T,n,I),{u_height_factor:-Math.pow(2,x.overscaledZ)/I.tileSize/8}),Fr=g=>({u_matrix:g}),Zi=(g,n,u,_)=>a.extend(Fr(g),Ln(u,n,_)),Er=(g,n)=>({u_matrix:g,u_world:n}),vo=(g,n,u,_,x)=>a.extend(Zi(g,n,u,_),{u_world:x}),le=(g,n,u,_)=>{const x=g.transform;let T;return T="map"===_.paint.get("circle-pitch-alignment")?x.calculatePixelsToTileUnitsMatrix(u):new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]),{u_camera_to_center_distance:x.cameraToCenterDistance,u_matrix:g.translatePosMatrix(n.projMatrix,u,_.paint.get("circle-translate"),_.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:T}},ee=g=>{const n=[];return"map"===g.paint.get("circle-pitch-alignment")&&n.push("PITCH_WITH_MAP"),"map"===g.paint.get("circle-pitch-scale")&&n.push("SCALE_WITH_MAP"),n},ne=(g,n,u)=>{const _=a.EXTENT/u.tileSize;return{u_matrix:g,u_camera_to_center_distance:n.cameraToCenterDistance,u_extrude_scale:[n.pixelsToGLUnits[0]/_,n.pixelsToGLUnits[1]/_]}},Ue=(g,n,u=1)=>({u_matrix:g,u_color:n,u_overlay:0,u_overlay_scale:u}),pn=(g,n,u,_)=>({u_matrix:g,u_extrude_scale:gt(n,1,u),u_intensity:_}),ri=(g,n,u,_,x,T)=>{const I=g.transform,B=I.calculatePixelsToTileUnitsMatrix(n),J={u_matrix:es(g,n,u,x),u_pixels_to_tile_units:B,u_device_pixel_ratio:a.exported.devicePixelRatio,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0,u_alpha_discard_threshold:0};if(jo(u)){const oe=Jr(n,g.transform);J.u_texsize=n.lineAtlasTexture.size,J.u_scale=[oe,_.fromScale,_.toScale],J.u_mix=_.t}return J},Yr=(g,n,u,_,x)=>{const T=g.transform,I=Jr(n,T);return{u_matrix:es(g,n,u,x),u_texsize:n.imageAtlasTexture.size,u_pixels_to_tile_units:T.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:a.exported.devicePixelRatio,u_image:0,u_scale:[I,_.fromScale,_.toScale],u_fade:_.t,u_units_to_pixels:[1/T.pixelsToGLUnits[0],1/T.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Jr(g,n){return 1/gt(g,1,n.tileZoom)}function es(g,n,u,_){return g.translatePosMatrix(_||n.tileID.projMatrix,n,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}function jo(g){const n=g.paint.get("line-dasharray").value;return n.value||"constant"!==n.kind}const zs=(g,n,u,_,x,T)=>{return{u_matrix:g,u_tl_parent:n,u_scale_parent:u,u_fade_t:_.mix,u_opacity:_.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(B=x.paint.get("raster-saturation"),B>0?1-1/(1.001-B):-B),u_contrast_factor:(I=x.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:Ps(x.paint.get("raster-hue-rotate")),u_perspective_transform:T};var I,B};function Ps(g){g*=Math.PI/180;const n=Math.sin(g),u=Math.cos(g);return[(2*u+1)/3,(-Math.sqrt(3)*n-u+1)/3,(Math.sqrt(3)*n-u+1)/3]}const tr=(g,n,u,_,x,T,I,B,J,oe,ce,ge,Re,We)=>{const $e=x.transform;return{u_is_size_zoom_constant:+("constant"===g||"source"===g),u_is_size_feature_constant:+("constant"===g||"camera"===g),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:$e.cameraToCenterDistance,u_pitch:$e.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:$e.width/$e.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:T,u_label_plane_matrix:I,u_coord_matrix:B,u_is_text:+J,u_pitch_with_map:+_,u_texsize:oe,u_tile_id:ce,u_zoom_transition:ge,u_inv_rot_matrix:Re,u_merc_center:We,u_texture:0}},Pa=(g,n,u,_,x,T,I,B,J,oe,ce,ge,Re,We,$e)=>{const{cameraToCenterDistance:Ye,_pitch:mt}=x.transform;return a.extend(tr(g,n,u,_,x,T,I,B,J,oe,ge,Re,We,$e),{u_gamma_scale:_?Ye*Math.cos(x.terrain?0:mt):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+ce})},ka=(g,n,u,_,x,T,I,B,J,oe,ce,ge,Re,We)=>a.extend(Pa(g,n,u,_,x,T,I,B,!0,J,!0,ce,ge,Re,We),{u_texsize_icon:oe,u_texture_icon:1}),Zr=(g,n,u)=>({u_matrix:g,u_opacity:n,u_color:u}),ra=(g,n,u,_,x,T)=>a.extend(function(I,B,J,oe){const ce=J.imageManager.getPattern(I.from.toString()),ge=J.imageManager.getPattern(I.to.toString()),{width:Re,height:We}=J.imageManager.getPixelSize(),$e=Math.pow(2,oe.tileID.overscaledZ),Ye=oe.tileSize*Math.pow(2,J.transform.tileZoom)/$e,mt=Ye*(oe.tileID.canonical.x+oe.tileID.wrap*$e),Ge=Ye*oe.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:ce.tl,u_pattern_br_a:ce.br,u_pattern_tl_b:ge.tl,u_pattern_br_b:ge.br,u_texsize:[Re,We],u_mix:B.t,u_pattern_size_a:ce.displaySize,u_pattern_size_b:ge.displaySize,u_scale_a:B.fromScale,u_scale_b:B.toScale,u_tile_units_to_pixels:1/gt(oe,1,J.transform.tileZoom),u_pixel_coord_upper:[mt>>16,Ge>>16],u_pixel_coord_lower:[65535&mt,65535&Ge]}}(_,T,u,x),{u_matrix:g,u_opacity:n}),sl={fillExtrusion:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_lightpos:new a.Uniform3f(g,n.u_lightpos),u_lightintensity:new a.Uniform1f(g,n.u_lightintensity),u_lightcolor:new a.Uniform3f(g,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(g,n.u_vertical_gradient),u_opacity:new a.Uniform1f(g,n.u_opacity)}),fillExtrusionPattern:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_lightpos:new a.Uniform3f(g,n.u_lightpos),u_lightintensity:new a.Uniform1f(g,n.u_lightintensity),u_lightcolor:new a.Uniform3f(g,n.u_lightcolor),u_vertical_gradient:new a.Uniform1f(g,n.u_vertical_gradient),u_height_factor:new a.Uniform1f(g,n.u_height_factor),u_image:new a.Uniform1i(g,n.u_image),u_texsize:new a.Uniform2f(g,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(g,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(g,n.u_scale),u_fade:new a.Uniform1f(g,n.u_fade),u_opacity:new a.Uniform1f(g,n.u_opacity)}),fill:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix)}),fillPattern:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_image:new a.Uniform1i(g,n.u_image),u_texsize:new a.Uniform2f(g,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(g,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(g,n.u_scale),u_fade:new a.Uniform1f(g,n.u_fade)}),fillOutline:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_world:new a.Uniform2f(g,n.u_world)}),fillOutlinePattern:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_world:new a.Uniform2f(g,n.u_world),u_image:new a.Uniform1i(g,n.u_image),u_texsize:new a.Uniform2f(g,n.u_texsize),u_pixel_coord_upper:new a.Uniform2f(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(g,n.u_pixel_coord_lower),u_scale:new a.Uniform3f(g,n.u_scale),u_fade:new a.Uniform1f(g,n.u_fade)}),circle:(g,n)=>({u_camera_to_center_distance:new a.Uniform1f(g,n.u_camera_to_center_distance),u_extrude_scale:new a.UniformMatrix2f(g,n.u_extrude_scale),u_device_pixel_ratio:new a.Uniform1f(g,n.u_device_pixel_ratio),u_matrix:new a.UniformMatrix4f(g,n.u_matrix)}),collisionBox:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_camera_to_center_distance:new a.Uniform1f(g,n.u_camera_to_center_distance),u_extrude_scale:new a.Uniform2f(g,n.u_extrude_scale)}),collisionCircle:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_inv_matrix:new a.UniformMatrix4f(g,n.u_inv_matrix),u_camera_to_center_distance:new a.Uniform1f(g,n.u_camera_to_center_distance),u_viewport_size:new a.Uniform2f(g,n.u_viewport_size)}),debug:(g,n)=>({u_color:new a.UniformColor(g,n.u_color),u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_overlay:new a.Uniform1i(g,n.u_overlay),u_overlay_scale:new a.Uniform1f(g,n.u_overlay_scale)}),clippingMask:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix)}),heatmap:(g,n)=>({u_extrude_scale:new a.Uniform1f(g,n.u_extrude_scale),u_intensity:new a.Uniform1f(g,n.u_intensity),u_matrix:new a.UniformMatrix4f(g,n.u_matrix)}),heatmapTexture:(g,n)=>({u_image:new a.Uniform1i(g,n.u_image),u_color_ramp:new a.Uniform1i(g,n.u_color_ramp),u_opacity:new a.Uniform1f(g,n.u_opacity)}),hillshade:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_image:new a.Uniform1i(g,n.u_image),u_latrange:new a.Uniform2f(g,n.u_latrange),u_light:new a.Uniform2f(g,n.u_light),u_shadow:new a.UniformColor(g,n.u_shadow),u_highlight:new a.UniformColor(g,n.u_highlight),u_accent:new a.UniformColor(g,n.u_accent)}),hillshadePrepare:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_image:new a.Uniform1i(g,n.u_image),u_dimension:new a.Uniform2f(g,n.u_dimension),u_zoom:new a.Uniform1f(g,n.u_zoom),u_unpack:new a.Uniform4f(g,n.u_unpack)}),line:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_pixels_to_tile_units:new a.UniformMatrix2f(g,n.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(g,n.u_device_pixel_ratio),u_units_to_pixels:new a.Uniform2f(g,n.u_units_to_pixels),u_dash_image:new a.Uniform1i(g,n.u_dash_image),u_gradient_image:new a.Uniform1i(g,n.u_gradient_image),u_image_height:new a.Uniform1f(g,n.u_image_height),u_texsize:new a.Uniform2f(g,n.u_texsize),u_scale:new a.Uniform3f(g,n.u_scale),u_mix:new a.Uniform1f(g,n.u_mix),u_alpha_discard_threshold:new a.Uniform1f(g,n.u_alpha_discard_threshold)}),linePattern:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_texsize:new a.Uniform2f(g,n.u_texsize),u_pixels_to_tile_units:new a.UniformMatrix2f(g,n.u_pixels_to_tile_units),u_device_pixel_ratio:new a.Uniform1f(g,n.u_device_pixel_ratio),u_image:new a.Uniform1i(g,n.u_image),u_units_to_pixels:new a.Uniform2f(g,n.u_units_to_pixels),u_scale:new a.Uniform3f(g,n.u_scale),u_fade:new a.Uniform1f(g,n.u_fade),u_alpha_discard_threshold:new a.Uniform1f(g,n.u_alpha_discard_threshold)}),raster:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_tl_parent:new a.Uniform2f(g,n.u_tl_parent),u_scale_parent:new a.Uniform1f(g,n.u_scale_parent),u_fade_t:new a.Uniform1f(g,n.u_fade_t),u_opacity:new a.Uniform1f(g,n.u_opacity),u_image0:new a.Uniform1i(g,n.u_image0),u_image1:new a.Uniform1i(g,n.u_image1),u_brightness_low:new a.Uniform1f(g,n.u_brightness_low),u_brightness_high:new a.Uniform1f(g,n.u_brightness_high),u_saturation_factor:new a.Uniform1f(g,n.u_saturation_factor),u_contrast_factor:new a.Uniform1f(g,n.u_contrast_factor),u_spin_weights:new a.Uniform3f(g,n.u_spin_weights),u_perspective_transform:new a.Uniform2f(g,n.u_perspective_transform)}),symbolIcon:(g,n)=>({u_is_size_zoom_constant:new a.Uniform1i(g,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(g,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(g,n.u_size_t),u_size:new a.Uniform1f(g,n.u_size),u_camera_to_center_distance:new a.Uniform1f(g,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(g,n.u_pitch),u_rotate_symbol:new a.Uniform1i(g,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(g,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(g,n.u_fade_change),u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(g,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(g,n.u_coord_matrix),u_is_text:new a.Uniform1i(g,n.u_is_text),u_pitch_with_map:new a.Uniform1i(g,n.u_pitch_with_map),u_texsize:new a.Uniform2f(g,n.u_texsize),u_tile_id:new a.Uniform3f(g,n.u_tile_id),u_zoom_transition:new a.Uniform1f(g,n.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(g,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(g,n.u_merc_center),u_texture:new a.Uniform1i(g,n.u_texture)}),symbolSDF:(g,n)=>({u_is_size_zoom_constant:new a.Uniform1i(g,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(g,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(g,n.u_size_t),u_size:new a.Uniform1f(g,n.u_size),u_camera_to_center_distance:new a.Uniform1f(g,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(g,n.u_pitch),u_rotate_symbol:new a.Uniform1i(g,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(g,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(g,n.u_fade_change),u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(g,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(g,n.u_coord_matrix),u_is_text:new a.Uniform1i(g,n.u_is_text),u_pitch_with_map:new a.Uniform1i(g,n.u_pitch_with_map),u_texsize:new a.Uniform2f(g,n.u_texsize),u_texture:new a.Uniform1i(g,n.u_texture),u_gamma_scale:new a.Uniform1f(g,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(g,n.u_device_pixel_ratio),u_tile_id:new a.Uniform3f(g,n.u_tile_id),u_zoom_transition:new a.Uniform1f(g,n.u_zoom_transition),u_inv_rot_matrix:new a.UniformMatrix4f(g,n.u_inv_rot_matrix),u_merc_center:new a.Uniform2f(g,n.u_merc_center),u_is_halo:new a.Uniform1i(g,n.u_is_halo)}),symbolTextAndIcon:(g,n)=>({u_is_size_zoom_constant:new a.Uniform1i(g,n.u_is_size_zoom_constant),u_is_size_feature_constant:new a.Uniform1i(g,n.u_is_size_feature_constant),u_size_t:new a.Uniform1f(g,n.u_size_t),u_size:new a.Uniform1f(g,n.u_size),u_camera_to_center_distance:new a.Uniform1f(g,n.u_camera_to_center_distance),u_pitch:new a.Uniform1f(g,n.u_pitch),u_rotate_symbol:new a.Uniform1i(g,n.u_rotate_symbol),u_aspect_ratio:new a.Uniform1f(g,n.u_aspect_ratio),u_fade_change:new a.Uniform1f(g,n.u_fade_change),u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_label_plane_matrix:new a.UniformMatrix4f(g,n.u_label_plane_matrix),u_coord_matrix:new a.UniformMatrix4f(g,n.u_coord_matrix),u_is_text:new a.Uniform1i(g,n.u_is_text),u_pitch_with_map:new a.Uniform1i(g,n.u_pitch_with_map),u_texsize:new a.Uniform2f(g,n.u_texsize),u_texsize_icon:new a.Uniform2f(g,n.u_texsize_icon),u_texture:new a.Uniform1i(g,n.u_texture),u_texture_icon:new a.Uniform1i(g,n.u_texture_icon),u_gamma_scale:new a.Uniform1f(g,n.u_gamma_scale),u_device_pixel_ratio:new a.Uniform1f(g,n.u_device_pixel_ratio),u_is_halo:new a.Uniform1i(g,n.u_is_halo)}),background:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_opacity:new a.Uniform1f(g,n.u_opacity),u_color:new a.UniformColor(g,n.u_color)}),backgroundPattern:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_opacity:new a.Uniform1f(g,n.u_opacity),u_image:new a.Uniform1i(g,n.u_image),u_pattern_tl_a:new a.Uniform2f(g,n.u_pattern_tl_a),u_pattern_br_a:new a.Uniform2f(g,n.u_pattern_br_a),u_pattern_tl_b:new a.Uniform2f(g,n.u_pattern_tl_b),u_pattern_br_b:new a.Uniform2f(g,n.u_pattern_br_b),u_texsize:new a.Uniform2f(g,n.u_texsize),u_mix:new a.Uniform1f(g,n.u_mix),u_pattern_size_a:new a.Uniform2f(g,n.u_pattern_size_a),u_pattern_size_b:new a.Uniform2f(g,n.u_pattern_size_b),u_scale_a:new a.Uniform1f(g,n.u_scale_a),u_scale_b:new a.Uniform1f(g,n.u_scale_b),u_pixel_coord_upper:new a.Uniform2f(g,n.u_pixel_coord_upper),u_pixel_coord_lower:new a.Uniform2f(g,n.u_pixel_coord_lower),u_tile_units_to_pixels:new a.Uniform1f(g,n.u_tile_units_to_pixels)}),terrainRaster:Di,terrainDepth:Di,skybox:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_sun_direction:new a.Uniform3f(g,n.u_sun_direction),u_cubemap:new a.Uniform1i(g,n.u_cubemap),u_opacity:new a.Uniform1f(g,n.u_opacity),u_temporal_offset:new a.Uniform1f(g,n.u_temporal_offset)}),skyboxGradient:(g,n)=>({u_matrix:new a.UniformMatrix4f(g,n.u_matrix),u_color_ramp:new a.Uniform1i(g,n.u_color_ramp),u_center_direction:new a.Uniform3f(g,n.u_center_direction),u_radius:new a.Uniform1f(g,n.u_radius),u_opacity:new a.Uniform1f(g,n.u_opacity),u_temporal_offset:new a.Uniform1f(g,n.u_temporal_offset)}),skyboxCapture:(g,n)=>({u_matrix_3f:new a.UniformMatrix3f(g,n.u_matrix_3f),u_sun_direction:new a.Uniform3f(g,n.u_sun_direction),u_sun_intensity:new a.Uniform1f(g,n.u_sun_intensity),u_color_tint_r:new a.Uniform4f(g,n.u_color_tint_r),u_color_tint_m:new a.Uniform4f(g,n.u_color_tint_m),u_luminance:new a.Uniform1f(g,n.u_luminance)}),globeRaster:(g,n)=>({u_proj_matrix:new a.UniformMatrix4f(g,n.u_proj_matrix),u_globe_matrix:new a.UniformMatrix4f(g,n.u_globe_matrix),u_merc_matrix:new a.UniformMatrix4f(g,n.u_merc_matrix),u_zoom_transition:new a.Uniform1f(g,n.u_zoom_transition),u_merc_center:new a.Uniform2f(g,n.u_merc_center),u_image0:new a.Uniform1i(g,n.u_image0)}),globeAtmosphere:(g,n)=>({u_center:new a.Uniform2f(g,n.u_center),u_radius:new a.Uniform1f(g,n.u_radius),u_screen_size:new a.Uniform2f(g,n.u_screen_size),u_pixel_ratio:new a.Uniform1f(g,n.u_pixel_ratio),u_opacity:new a.Uniform1f(g,n.u_opacity),u_fadeout_range:new a.Uniform1f(g,n.u_fadeout_range),u_start_color:new a.Uniform3f(g,n.u_start_color),u_end_color:new a.Uniform3f(g,n.u_end_color)})};let Es;function oa(g,n,u,_,x,T,I){const B=g.context,J=B.gl,oe=g.useProgram("collisionBox"),ce=[];let ge=0,Re=0;for(let _t=0;_t<_.length;_t++){const lt=_[_t],ut=n.getTile(lt),bt=ut.getBucket(u);if(!bt)continue;let qt=lt.projMatrix;0===x[0]&&0===x[1]||(qt=g.translatePosMatrix(lt.projMatrix,ut,x,T));const cn=I?bt.textCollisionBox:bt.iconCollisionBox,Gn=bt.collisionCircleArray;if(Gn.length>0){const On=a.create(),Sn=qt;a.mul(On,bt.placementInvProjMatrix,g.transform.glCoordMatrix),a.mul(On,On,bt.placementViewportMatrix),ce.push({circleArray:Gn,circleOffset:Re,transform:Sn,invTransform:On}),ge+=Gn.length/4,Re=ge}cn&&(g.terrain&&g.terrain.setupElevationDraw(ut,oe),oe.draw(B,J.LINES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,ne(qt,g.transform,ut),u.id,cn.layoutVertexBuffer,cn.indexBuffer,cn.segments,null,g.transform.zoom,null,cn.collisionVertexBuffer,cn.collisionVertexBufferExt))}if(!I||!ce.length)return;const We=g.useProgram("collisionCircle"),$e=new a.StructArrayLayout2f1f2i16;$e.resize(4*ge),$e._trim();let Ye=0;for(const _t of ce)for(let lt=0;lt<_t.circleArray.length/4;lt++){const ut=4*lt,bt=_t.circleArray[ut+0],qt=_t.circleArray[ut+1],cn=_t.circleArray[ut+2],Gn=_t.circleArray[ut+3];$e.emplace(Ye++,bt,qt,cn,Gn,0),$e.emplace(Ye++,bt,qt,cn,Gn,1),$e.emplace(Ye++,bt,qt,cn,Gn,2),$e.emplace(Ye++,bt,qt,cn,Gn,3)}(!Es||Es.length<2*ge)&&(Es=function(_t){const lt=2*_t,ut=new a.StructArrayLayout3ui6;ut.resize(lt),ut._trim();for(let bt=0;bt<lt;bt++){const qt=6*bt;ut.uint16[qt+0]=4*bt+0,ut.uint16[qt+1]=4*bt+1,ut.uint16[qt+2]=4*bt+2,ut.uint16[qt+3]=4*bt+2,ut.uint16[qt+4]=4*bt+3,ut.uint16[qt+5]=4*bt+0}return ut}(ge));const mt=B.createIndexBuffer(Es,!0),Ge=B.createVertexBuffer($e,a.collisionCircleLayout.members,!0);for(const _t of ce){const lt={u_matrix:_t.transform,u_inv_matrix:_t.invTransform,u_camera_to_center_distance:(dt=g.transform).cameraToCenterDistance,u_viewport_size:[dt.width,dt.height]};We.draw(B,J.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,lt,u.id,Ge,mt,a.SegmentVector.simpleSegment(0,2*_t.circleOffset,_t.circleArray.length,_t.circleArray.length/2),null,g.transform.zoom,null,null,null)}var dt;Ge.destroy(),mt.destroy()}const Rn=a.identity(new Float32Array(16));function Dr(g,n,u,_,x,T){const{horizontalAlign:I,verticalAlign:B}=a.getAnchorAlignment(g),J=-(I-.5)*n,oe=-(B-.5)*u,ce=a.evaluateVariableOffset(g,_);return new a.pointGeometry((J/x+ce[0])*T,(oe/x+ce[1])*T)}function Xl(g,n,u,_,x,T,I,B,J,oe,ce,ge){const Re=g.text.placedSymbolArray,We=g.text.dynamicLayoutVertexArray,$e=g.icon.dynamicLayoutVertexArray,Ye={},mt=B.projMatrix,Ge=T.elevation,dt=Ge?Ge.getAtTileOffsetFunc(B,ge):_t=>[0,0,0];We.clear();for(let _t=0;_t<Re.length;_t++){const lt=Re.get(_t),ut=g.allowVerticalPlacement&&!lt.placedOrientation,bt=lt.hidden||!lt.crossTileID||ut?null:_[lt.crossTileID];if(bt){const qt=new a.pointGeometry(lt.tileAnchorX,lt.tileAnchorY),cn=dt(qt),Gn=Gi(qt,u?mt:I,cn[2]),On=Ar(T.cameraToCenterDistance,Gn.signedDistanceFromCamera);let Sn=x.evaluateSizeForFeature(g.textSizeData,oe,lt)*On/a.ONE_EM;u&&(Sn*=g.tilePixelRatio/J);const{width:mn,height:Xt,anchor:Cn,textOffset:bn,textScale:Ti}=bt,Vi=Dr(Cn,mn,Xt,bn,Ti,Sn),wr=u?Gi(qt.add(Vi),I,cn[2]).point:Gn.point.add(n?Vi.rotate(-T.angle):Vi),$n=g.allowVerticalPlacement&&lt.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let Fi=0;Fi<lt.numGlyphs;Fi++)a.addDynamicAttributes(We,wr,$n);ce&&lt.associatedIconIndex>=0&&(Ye[lt.associatedIconIndex]={shiftedAnchor:wr,angle:$n})}else Lr(lt.numGlyphs,We)}if(ce){$e.clear();const _t=g.icon.placedSymbolArray;for(let lt=0;lt<_t.length;lt++){const ut=_t.get(lt);if(ut.hidden)Lr(ut.numGlyphs,$e);else{const bt=Ye[lt];if(bt)for(let qt=0;qt<ut.numGlyphs;qt++)a.addDynamicAttributes($e,bt.shiftedAnchor,bt.angle);else Lr(ut.numGlyphs,$e)}}g.icon.dynamicLayoutVertexBuffer.updateData($e)}g.text.dynamicLayoutVertexBuffer.updateData(We)}function Zo(g,n,u){return u.iconsInText&&n?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function _a(g,n,u,_,x,T,I,B,J,oe,ce,ge){const Re=g.context,We=Re.gl,$e=g.transform,Ye=$e.projection.createTileTransform($e,$e.worldSize),mt="map"===B,Ge="map"===J,dt=mt&&"point"!==u.layout.get("symbol-placement"),_t=mt&&!Ge&&!dt,lt=void 0!==u.layout.get("symbol-sort-key").constantOr(1);let ut=!1;const bt=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),qt=[a.mercatorXfromLng($e.center.lng),a.mercatorYfromLat($e.center.lat)],cn=u.layout.get("text-variable-anchor"),Gn="globe"===$e.projection.name,On=Gn?a.globeToMercatorTransition($e.zoom):0,Sn=[],mn=[];g.terrain&&Ge&&mn.push("PITCH_WITH_MAP_TERRAIN"),Gn&&mn.push("PROJECTION_GLOBE_VIEW"),dt&&mn.push("PROJECTED_POS_ON_VIEWPORT");for(const Xt of _){const Cn=n.getTile(Xt),bn=Cn.getBucket(u);if(!bn||bn.projection!==$e.projection.name)continue;const Ti=x?bn.text:bn.icon;if(!Ti||bn.fullyClipped||!Ti.segments.get().length)continue;const Vi=Ti.programConfigurations.get(u.id),wr=x||bn.sdfIcons,$n=x?bn.textSizeData:bn.iconSizeData,Fi=Ge||0!==$e.pitch,ar=g.useProgram(Zo(wr,x,bn),Vi,mn),Xr=a.evaluateSizeForZoom($n,$e.zoom),xo=[Xt.canonical.x,Xt.canonical.y,1<<Xt.canonical.z];let or,Ki,Mo,ns,vs=[0,0],xs=null;if(x){if(Ki=Cn.glyphAtlasTexture,Mo=We.LINEAR,or=Cn.glyphAtlasTexture.size,bn.iconsInText){vs=Cn.imageAtlasTexture.size,xs=Cn.imageAtlasTexture;const cs="composite"===$n.kind||"camera"===$n.kind;ns=Fi||g.options.rotating||g.options.zooming||cs?We.LINEAR:We.NEAREST}}else{const cs=1!==u.layout.get("icon-size").constantOr(0)||bn.iconsNeedLinear;Ki=Cn.imageAtlasTexture,Mo=wr||g.options.rotating||g.options.zooming||cs||Fi?We.LINEAR:We.NEAREST,or=Cn.imageAtlasTexture.size}const ua=g.transform.calculatePixelsToTileUnitsMatrix(Cn),$r=Ai(Xt.projMatrix,Cn.tileID.canonical,Ge,mt,g.transform,ua),lr=g.terrain&&Ge&&dt?a.invert(new Float32Array(16),$r):Rn,Tr=Bi(Xt.projMatrix,Cn.tileID.canonical,Ge,mt,g.transform,ua),Eo=cn&&bn.hasTextData(),Rs="none"!==u.layout.get("icon-text-fit")&&Eo&&bn.hasIconData();if(dt){const cs=$e.elevation,Ks=cs?cs.getAtTileOffsetFunc(Xt,Ye):Xs=>[0,0,0];Cr(bn,Xt.projMatrix,g,x,$r,Tr,Ge,oe,Ks,Xt)}const po=g.translatePosMatrix(Xt.projMatrix,Cn,T,I),Zs=dt||x&&cn||Rs?Rn:$r,ic=g.translatePosMatrix(Tr,Cn,T,I,!0),bs=wr&&0!==u.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1);let Ea;const _i=Ye.createInversionMatrix(Xt.toUnwrapped());Ea=wr?bn.iconsInText?ka($n.kind,Xr,_t,Ge,g,po,Zs,ic,or,vs,xo,On,_i,qt):Pa($n.kind,Xr,_t,Ge,g,po,Zs,ic,x,or,!0,xo,On,_i,qt):tr($n.kind,Xr,_t,Ge,g,po,Zs,ic,x,or,xo,On,_i,qt);const Ni={program:ar,buffers:Ti,uniformValues:Ea,atlasTexture:Ki,atlasTextureIcon:xs,atlasInterpolation:Mo,atlasInterpolationIcon:ns,isSDF:wr,hasHalo:bs,tile:Cn,labelPlaneMatrixInv:lr};if(lt&&bn.canOverlap){ut=!0;const cs=Ti.segments.get();for(const Ks of cs)Sn.push({segments:new a.SegmentVector([Ks]),sortKey:Ks.sortKey,state:Ni})}else Sn.push({segments:Ti.segments,sortKey:0,state:Ni})}ut&&Sn.sort((Xt,Cn)=>Xt.sortKey-Cn.sortKey);for(const Xt of Sn){const Cn=Xt.state;if(g.terrain&&g.terrain.setupElevationDraw(Cn.tile,Cn.program,{useDepthForOcclusion:!Gn,labelPlaneMatrixInv:Cn.labelPlaneMatrixInv}),Re.activeTexture.set(We.TEXTURE0),Cn.atlasTexture.bind(Cn.atlasInterpolation,We.CLAMP_TO_EDGE),Cn.atlasTextureIcon&&(Re.activeTexture.set(We.TEXTURE1),Cn.atlasTextureIcon&&Cn.atlasTextureIcon.bind(Cn.atlasInterpolationIcon,We.CLAMP_TO_EDGE)),Cn.isSDF){const bn=Cn.uniformValues;Cn.hasHalo&&(bn.u_is_halo=1,Gs(Cn.buffers,Xt.segments,u,g,Cn.program,bt,ce,ge,bn)),bn.u_is_halo=0}Gs(Cn.buffers,Xt.segments,u,g,Cn.program,bt,ce,ge,Cn.uniformValues)}}function Gs(g,n,u,_,x,T,I,B,J){const oe=_.context;x.draw(oe,oe.gl.TRIANGLES,T,I,B,a.CullFaceMode.disabled,J,u.id,g.layoutVertexBuffer,g.indexBuffer,n,u.paint,_.transform.zoom,g.programConfigurations.get(u.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function hs(g,n,u,_,x,T,I){const B=g.context.gl,J=u.paint.get("fill-pattern"),oe=J&&J.constantOr(1),ce=u.getCrossfadeParameters();let ge,Re,We,$e,Ye;I?(Re=oe&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",ge=B.LINES):(Re=oe?"fillPattern":"fill",ge=B.TRIANGLES);for(const mt of _){const Ge=n.getTile(mt);if(oe&&!Ge.patternsLoaded())continue;const dt=Ge.getBucket(u);if(!dt)continue;g.prepareDrawTile(mt);const _t=dt.programConfigurations.get(u.id),lt=g.useProgram(Re,_t);oe&&(g.context.activeTexture.set(B.TEXTURE0),Ge.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),_t.updatePaintBuffers(ce));const ut=J.constantOr(null);if(ut&&Ge.imageAtlas){const qt=Ge.imageAtlas,cn=qt.patternPositions[ut.to.toString()],Gn=qt.patternPositions[ut.from.toString()];cn&&Gn&&_t.setConstantPatternPositions(cn,Gn)}const bt=g.translatePosMatrix(mt.projMatrix,Ge,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(I){$e=dt.indexBuffer2,Ye=dt.segments2;const qt=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[B.drawingBufferWidth,B.drawingBufferHeight];We="fillOutlinePattern"===Re&&oe?vo(bt,g,ce,Ge,qt):Er(bt,qt)}else $e=dt.indexBuffer,Ye=dt.segments,We=oe?Zi(bt,g,ce,Ge):Fr(bt);g.prepareDrawProgram(g.context,lt,mt.toUnwrapped()),lt.draw(g.context,ge,x,g.stencilModeForClipping(mt),T,a.CullFaceMode.disabled,We,u.id,dt.layoutVertexBuffer,$e,Ye,u.paint,g.transform.zoom,_t)}}function ya(g,n,u,_,x,T,I){const B=g.context,J=B.gl,oe=u.paint.get("fill-extrusion-pattern"),ce=oe.constantOr(1),ge=u.getCrossfadeParameters(),Re=u.paint.get("fill-extrusion-opacity");for(const We of _){const $e=n.getTile(We),Ye=$e.getBucket(u);if(!Ye)continue;const mt=Ye.programConfigurations.get(u.id),Ge=g.useProgram(ce?"fillExtrusionPattern":"fillExtrusion",mt);if(g.terrain){const bt=g.terrain;if(!Ye.enableTerrain)continue;if(bt.setupElevationDraw($e,Ge,{useMeterToDem:!0}),Oa(B,n,We,Ye,u,bt),!Ye.centroidVertexBuffer){const qt=Ge.attributes.a_centroid_pos;void 0!==qt&&J.vertexAttrib2f(qt,0,0)}}ce&&(g.context.activeTexture.set(J.TEXTURE0),$e.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),mt.updatePaintBuffers(ge));const dt=oe.constantOr(null);if(dt&&$e.imageAtlas){const bt=$e.imageAtlas,qt=bt.patternPositions[dt.to.toString()],cn=bt.patternPositions[dt.from.toString()];qt&&cn&&mt.setConstantPatternPositions(qt,cn)}const _t=g.translatePosMatrix(We.projMatrix,$e,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),lt=u.paint.get("fill-extrusion-vertical-gradient"),ut=ce?Mr(_t,g,lt,Re,We,ge,$e):Yn(_t,g,lt,Re);g.prepareDrawProgram(B,Ge,We.toUnwrapped()),Ge.draw(B,B.gl.TRIANGLES,x,T,I,a.CullFaceMode.backCCW,ut,u.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,u.paint,g.transform.zoom,mt,g.terrain?Ye.centroidVertexBuffer:null)}}function Oa(g,n,u,_,x,T){const I=[Ge=>{let dt=Ge.canonical.x-1,_t=Ge.wrap;return dt<0&&(dt=(1<<Ge.canonical.z)-1,_t--),new a.OverscaledTileID(Ge.overscaledZ,_t,Ge.canonical.z,dt,Ge.canonical.y)},Ge=>{let dt=Ge.canonical.x+1,_t=Ge.wrap;return dt===1<<Ge.canonical.z&&(dt=0,_t++),new a.OverscaledTileID(Ge.overscaledZ,_t,Ge.canonical.z,dt,Ge.canonical.y)},Ge=>new a.OverscaledTileID(Ge.overscaledZ,Ge.wrap,Ge.canonical.z,Ge.canonical.x,(0===Ge.canonical.y?1<<Ge.canonical.z:Ge.canonical.y)-1),Ge=>new a.OverscaledTileID(Ge.overscaledZ,Ge.wrap,Ge.canonical.z,Ge.canonical.x,Ge.canonical.y===(1<<Ge.canonical.z)-1?0:Ge.canonical.y+1)],B=Ge=>{const dt=n.getSource().maxzoom,_t=qt=>{const cn=n.getTileByID(qt);if(cn&&cn.hasData())return cn.getBucket(x)};let lt,ut,bt;return(Ge.overscaledZ===Ge.canonical.z||Ge.overscaledZ>=dt)&&(lt=_t(Ge.key)),Ge.overscaledZ>=dt&&(ut=_t(Ge.calculateScaledKey(Ge.overscaledZ+1))),Ge.overscaledZ>dt&&(bt=_t(Ge.calculateScaledKey(Ge.overscaledZ-1))),lt||ut||bt},J=[0,0,0],oe=(Ge,dt)=>(J[0]=Math.min(Ge.min.y,dt.min.y),J[1]=Math.max(Ge.max.y,dt.max.y),J[2]=a.EXTENT-dt.min.x>Ge.max.x?dt.min.x-a.EXTENT:Ge.max.x,J),ce=(Ge,dt)=>(J[0]=Math.min(Ge.min.x,dt.min.x),J[1]=Math.max(Ge.max.x,dt.max.x),J[2]=a.EXTENT-dt.min.y>Ge.max.y?dt.min.y-a.EXTENT:Ge.max.y,J),ge=[(Ge,dt)=>oe(Ge,dt),(Ge,dt)=>oe(dt,Ge),(Ge,dt)=>ce(Ge,dt),(Ge,dt)=>ce(dt,Ge)],Re=new a.pointGeometry(0,0);let We,$e,Ye;const mt=(Ge,dt,_t,lt,ut)=>{const bt=[[lt?_t:Ge,lt?Ge:_t,0],[lt?_t:dt,lt?dt:_t,0]],qt=ut<0?a.EXTENT+ut:ut,cn=[lt?qt:(Ge+dt)/2,lt?(Ge+dt)/2:qt,0];return 0===_t&&ut<0||0!==_t&&ut>0?T.getForTilePoints(Ye,[cn],!0,$e):bt.push(cn),T.getForTilePoints(u,bt,!0,We),Math.max(bt[0][2],bt[1][2],cn[2])/T.exaggeration()};for(let Ge=0;Ge<4;Ge++){const dt=_.borders[Ge];if(0===dt.length&&(_.borderDone[Ge]=!0),_.borderDone[Ge])continue;const _t=Ye=I[Ge](u),lt=B(_t);if(!(lt&&lt.enableTerrain&&($e=T.findDEMTileFor(_t),$e&&$e.dem)))continue;if(!We){const cn=T.findDEMTileFor(u);if(!cn||!cn.dem)return;We=cn}const ut=(Ge<2?1:5)-Ge,bt=lt.borders[ut];let qt=0;for(let cn=0;cn<dt.length;cn++){const Gn=_.featuresOnBorder[dt[cn]],On=Gn.borders[Ge];let Sn;for(;qt<bt.length&&(Sn=lt.featuresOnBorder[bt[qt]],!(Sn.borders[ut][1]>On[0]+3));)lt.borderDone[ut]||lt.encodeCentroid(void 0,Sn,!1),qt++;if(Sn&&qt<bt.length){const mn=qt;let Xt=0;for(;!(Sn.borders[ut][0]>On[1]-3)&&(Xt++,++qt!==bt.length);)Sn=lt.featuresOnBorder[bt[qt]];if(Sn=lt.featuresOnBorder[bt[mn]],Gn.intersectsCount()>1||Sn.intersectsCount()>1||1!==Xt){1!==Xt&&(qt=mn),_.encodeCentroid(void 0,Gn,!1),lt.borderDone[ut]||lt.encodeCentroid(void 0,Sn,!1);continue}const Cn=ge[Ge](Gn,Sn),bn=Ge%2?a.EXTENT-1:0;Re.x=mt(Cn[0],Math.min(a.EXTENT-1,Cn[1]),bn,Ge<2,Cn[2]),Re.y=0,_.encodeCentroid(Re,Gn,!1),lt.borderDone[ut]||lt.encodeCentroid(Re,Sn,!1)}else _.encodeCentroid(void 0,Gn,!1)}_.borderDone[Ge]=_.needsCentroidUpdate=!0,lt.borderDone[ut]||(lt.borderDone[ut]=lt.needsCentroidUpdate=!0)}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&0!==_.centroidVertexArray.length)&&_.uploadCentroid(g)}const Wc=new a.Color(1,0,0,1),bc=new a.Color(0,1,0,1),Ds=new a.Color(0,0,1,1),qs=new a.Color(1,0,1,1),ts=new a.Color(0,1,1,1);function To(g,n,u,_){W(g,0,n+u/2,g.transform.width,u,_)}function D(g,n,u,_){W(g,n-u/2,0,u,g.transform.height,_)}function W(g,n,u,_,x,T){const I=g.context,B=I.gl;B.enable(B.SCISSOR_TEST),B.scissor(n*a.exported.devicePixelRatio,u*a.exported.devicePixelRatio,_*a.exported.devicePixelRatio,x*a.exported.devicePixelRatio),I.clear({color:T}),B.disable(B.SCISSOR_TEST)}function E(g,n,u){const _=g.context,x=_.gl,T=u.projMatrix,I=g.useProgram("debug"),B=n.getTileByID(u.key);g.terrain&&g.terrain.setupElevationDraw(B,I);const J=a.DepthMode.disabled,oe=a.StencilMode.disabled,ce=g.colorModeForRenderPass();_.activeTexture.set(x.TEXTURE0),g.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),B._makeDebugTileBoundsBuffers(g.context,g.transform.projection);const Re=B._tileDebugBuffer||g.debugBuffer,We=B._tileDebugIndexBuffer||g.debugIndexBuffer,$e=B._tileDebugSegments||g.debugSegments;I.draw(_,x.LINE_STRIP,J,oe,ce,a.CullFaceMode.disabled,Ue(T,a.Color.red),"$debug",Re,We,$e);const Ye=B.latestRawTileData,mt=Math.floor((Ye&&Ye.byteLength||0)/1024),Ge=n.getTile(u).tileSize,dt=512/Math.min(Ge,512)*(u.overscaledZ/g.transform.zoom)*.5;let _t=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(_t+=` => ${u.overscaledZ}`),function(lt,ut){lt.initDebugOverlayCanvas();const bt=lt.debugOverlayCanvas,qt=lt.context.gl,cn=lt.debugOverlayCanvas.getContext("2d");cn.clearRect(0,0,bt.width,bt.height),cn.shadowColor="white",cn.shadowBlur=2,cn.lineWidth=1.5,cn.strokeStyle="white",cn.textBaseline="top",cn.font="bold 36px Open Sans, sans-serif",cn.fillText(ut,5,5),cn.strokeText(ut,5,5),lt.debugOverlayTexture.update(bt),lt.debugOverlayTexture.bind(qt.LINEAR,qt.CLAMP_TO_EDGE)}(g,`${_t} ${mt}kb`),I.draw(_,x.TRIANGLES,J,oe,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,Ue(T,a.Color.transparent,dt),"$debug",g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments)}const Y=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Te}=Y;function Pt(g,n,u,_){g.emplaceBack(n,u,_)}class kn{constructor(n){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,Pt(this.vertexArray,-1,-1,1),Pt(this.vertexArray,1,-1,1),Pt(this.vertexArray,-1,1,1),Pt(this.vertexArray,1,1,1),Pt(this.vertexArray,-1,-1,-1),Pt(this.vertexArray,1,-1,-1),Pt(this.vertexArray,-1,1,-1),Pt(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,Te),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function Qn(g,n,u,_,x,T){const I=g.gl,B=n.paint.get("sky-atmosphere-color"),J=n.paint.get("sky-atmosphere-halo-color"),oe=n.paint.get("sky-atmosphere-sun-intensity"),ce={u_matrix_3f:a.fromMat4([],_),u_sun_direction:x,u_sun_intensity:oe,u_color_tint_r:[($e=B).r,$e.g,$e.b,$e.a],u_color_tint_m:[(Ye=J).r,Ye.g,Ye.b,Ye.a],u_luminance:5e-5};var $e,Ye;I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+T,n.skyboxTexture,0),u.draw(g,I.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,ce,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const Yi={symbol:function(g,n,u,_,x){if("translucent"!==g.renderPass)return;const T=a.StencilMode.disabled,I=g.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(B,J,oe,ce,ge,Re,We){const $e=J.transform,Ye="map"===ge,mt="map"===Re,Ge=$e.projection.createTileTransform($e,$e.worldSize);for(const dt of B){const _t=ce.getTile(dt),lt=_t.getBucket(oe);if(!lt||lt.projection!==$e.projection.name||!lt.text||!lt.text.segments.get().length)continue;const ut=a.evaluateSizeForZoom(lt.textSizeData,$e.zoom),bt=J.transform.calculatePixelsToTileUnitsMatrix(_t),qt=Ai(dt.projMatrix,_t.tileID.canonical,mt,Ye,J.transform,bt),cn="none"!==oe.layout.get("icon-text-fit")&&lt.hasIconData();if(ut){const Gn=Math.pow(2,$e.zoom-_t.tileID.overscaledZ);Xl(lt,Ye,mt,We,a.symbolSize,$e,qt,dt,Gn,ut,cn,Ge)}}}(_,g,u,n,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),x),0!==u.paint.get("icon-opacity").constantOr(1)&&_a(g,n,u,_,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),T,I),0!==u.paint.get("text-opacity").constantOr(1)&&_a(g,n,u,_,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),T,I),n.map.showCollisionBoxes&&(oa(g,n,u,_,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),oa(g,n,u,_,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(g,n,u,_){if("translucent"!==g.renderPass)return;const x=u.paint.get("circle-opacity"),T=u.paint.get("circle-stroke-width"),I=u.paint.get("circle-stroke-opacity"),B=void 0!==u.layout.get("circle-sort-key").constantOr(1);if(0===x.constantOr(1)&&(0===T.constantOr(1)||0===I.constantOr(1)))return;const J=g.context,oe=J.gl,ce=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),ge=a.StencilMode.disabled,Re=g.colorModeForRenderPass(),We=[];for(let Ye=0;Ye<_.length;Ye++){const mt=_[Ye],Ge=n.getTile(mt),dt=Ge.getBucket(u);if(!dt)continue;const _t=dt.programConfigurations.get(u.id),lt=ee(u),ut={programConfiguration:_t,program:g.useProgram("circle",_t,lt),layoutVertexBuffer:dt.layoutVertexBuffer,indexBuffer:dt.indexBuffer,uniformValues:le(g,mt,Ge,u),tile:Ge};if(B){const bt=dt.segments.get();for(const qt of bt)We.push({segments:new a.SegmentVector([qt]),sortKey:qt.sortKey,state:ut})}else We.push({segments:dt.segments,sortKey:0,state:ut})}B&&We.sort((Ye,mt)=>Ye.sortKey-mt.sortKey);const $e={useDepthForOcclusion:"globe"!==g.transform.projection.name};for(const Ye of We){const{programConfiguration:mt,program:Ge,layoutVertexBuffer:dt,indexBuffer:_t,uniformValues:lt,tile:ut}=Ye.state,bt=Ye.segments;g.terrain&&g.terrain.setupElevationDraw(ut,Ge,$e),g.prepareDrawProgram(J,Ge,ut.tileID.toUnwrapped()),Ge.draw(J,oe.TRIANGLES,ce,ge,Re,a.CullFaceMode.disabled,lt,u.id,dt,_t,bt,u.paint,g.transform.zoom,mt)}},heatmap:function(g,n,u,_){if(0!==u.paint.get("heatmap-opacity"))if("offscreen"===g.renderPass){const x=g.context,T=x.gl,I=a.StencilMode.disabled,B=new a.ColorMode([T.ONE,T.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(J,oe,ce){const ge=J.gl;J.activeTexture.set(ge.TEXTURE1),J.viewport.set([0,0,oe.width/4,oe.height/4]);let Re=ce.heatmapFbo;if(Re)ge.bindTexture(ge.TEXTURE_2D,Re.colorAttachment.get()),J.bindFramebuffer.set(Re.framebuffer);else{const We=ge.createTexture();ge.bindTexture(ge.TEXTURE_2D,We),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_WRAP_S,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_WRAP_T,ge.CLAMP_TO_EDGE),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_MIN_FILTER,ge.LINEAR),ge.texParameteri(ge.TEXTURE_2D,ge.TEXTURE_MAG_FILTER,ge.LINEAR),Re=ce.heatmapFbo=J.createFramebuffer(oe.width/4,oe.height/4,!1),function($e,Ye,mt,Ge){const dt=$e.gl;dt.texImage2D(dt.TEXTURE_2D,0,dt.RGBA,Ye.width/4,Ye.height/4,0,dt.RGBA,$e.extRenderToTextureHalfFloat?$e.extTextureHalfFloat.HALF_FLOAT_OES:dt.UNSIGNED_BYTE,null),Ge.colorAttachment.set(mt)}(J,oe,We,Re)}})(x,g,u),x.clear({color:a.Color.transparent});for(let J=0;J<_.length;J++){const oe=_[J];if(n.hasRenderableParent(oe))continue;const ce=n.getTile(oe),ge=ce.getBucket(u);if(!ge)continue;const Re=ge.programConfigurations.get(u.id),We=g.useProgram("heatmap",Re),{zoom:$e}=g.transform;g.terrain&&g.terrain.setupElevationDraw(ce,We),g.prepareDrawProgram(x,We,oe.toUnwrapped()),We.draw(x,T.TRIANGLES,a.DepthMode.disabled,I,B,a.CullFaceMode.disabled,pn(oe.projMatrix,ce,$e,u.paint.get("heatmap-intensity")),u.id,ge.layoutVertexBuffer,ge.indexBuffer,ge.segments,u.paint,g.transform.zoom,Re)}x.viewport.set([0,0,g.width,g.height])}else"translucent"===g.renderPass&&(g.context.setColorMode(g.colorModeForRenderPass()),function(x,T){const I=x.context,B=I.gl,J=T.heatmapFbo;if(!J)return;I.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,J.colorAttachment.get()),I.activeTexture.set(B.TEXTURE1);let oe=T.colorRampTexture;oe||(oe=T.colorRampTexture=new a.Texture(I,T.colorRamp,B.RGBA)),oe.bind(B.LINEAR,B.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(I,B.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,x.colorModeForRenderPass(),a.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:T.paint.get("heatmap-opacity")},T.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,T.paint,x.transform.zoom)}(g,u))},line:function(g,n,u,_){if("translucent"!==g.renderPass)return;const x=u.paint.get("line-opacity"),T=u.paint.get("line-width");if(0===x.constantOr(1)||0===T.constantOr(1))return;const I=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),B=g.colorModeForRenderPass(),J=u.paint.get("line-dasharray"),oe=J.constantOr(1),ce=u.layout.get("line-cap"),ge=u.paint.get("line-pattern"),Re=ge.constantOr(1),We=u.paint.get("line-gradient"),$e=u.getCrossfadeParameters(),Ye=Re?"linePattern":"line",mt=g.context,Ge=mt.gl,dt=(lt=>{const ut=[];jo(lt)&&ut.push("RENDER_LINE_DASH"),lt.paint.get("line-gradient")&&ut.push("RENDER_LINE_GRADIENT");const bt=lt.paint.get("line-pattern").constantOr(1),qt=1!==lt.paint.get("line-opacity").constantOr(1);return!bt&&qt&&ut.push("RENDER_LINE_ALPHA_DISCARD"),ut})(u);let _t=dt.includes("RENDER_LINE_ALPHA_DISCARD");g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(_t=!1);for(const lt of _){const ut=n.getTile(lt);if(Re&&!ut.patternsLoaded())continue;const bt=ut.getBucket(u);if(!bt)continue;g.prepareDrawTile(lt);const qt=bt.programConfigurations.get(u.id),cn=g.useProgram(Ye,qt,dt),Gn=ge.constantOr(null);if(Gn&&ut.imageAtlas){const bn=ut.imageAtlas,Ti=bn.patternPositions[Gn.to.toString()],Vi=bn.patternPositions[Gn.from.toString()];Ti&&Vi&&qt.setConstantPatternPositions(Ti,Vi)}const On=J.constantOr(null),Sn=ce.constantOr(null);if(!Re&&On&&Sn&&ut.lineAtlas){const bn=ut.lineAtlas,Ti=bn.getDash(On.to,Sn),Vi=bn.getDash(On.from,Sn);Ti&&Vi&&qt.setConstantPatternPositions(Ti,Vi)}const mn=g.terrain?lt.projMatrix:null,Xt=Re?Yr(g,ut,u,$e,mn):ri(g,ut,u,$e,mn,bt.lineClipsArray.length);if(We){const bn=bt.gradients[u.id];let Ti=bn.texture;if(u.gradientVersion!==bn.version){let Vi=256;if(u.stepInterpolant){const wr=n.getSource().maxzoom,$n=lt.canonical.z===wr?Math.ceil(1<<g.transform.maxZoom-lt.canonical.z):1;Vi=a.clamp(a.nextPowerOfTwo(bt.maxLineLength/a.EXTENT*1024*$n),256,mt.maxTextureSize)}bn.gradient=a.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:Vi,image:bn.gradient||void 0,clips:bt.lineClipsArray}),bn.texture?bn.texture.update(bn.gradient):bn.texture=new a.Texture(mt,bn.gradient,Ge.RGBA),bn.version=u.gradientVersion,Ti=bn.texture}mt.activeTexture.set(Ge.TEXTURE1),Ti.bind(u.stepInterpolant?Ge.NEAREST:Ge.LINEAR,Ge.CLAMP_TO_EDGE)}oe&&(mt.activeTexture.set(Ge.TEXTURE0),ut.lineAtlasTexture.bind(Ge.LINEAR,Ge.REPEAT),qt.updatePaintBuffers($e)),Re&&(mt.activeTexture.set(Ge.TEXTURE0),ut.imageAtlasTexture.bind(Ge.LINEAR,Ge.CLAMP_TO_EDGE),qt.updatePaintBuffers($e)),g.prepareDrawProgram(mt,cn,lt.toUnwrapped());const Cn=bn=>{cn.draw(mt,Ge.TRIANGLES,I,bn,B,a.CullFaceMode.disabled,Xt,u.id,bt.layoutVertexBuffer,bt.indexBuffer,bt.segments,u.paint,g.transform.zoom,qt,bt.layoutVertexBuffer2)};if(_t){const bn=g.stencilModeForClipping(lt).ref;0===bn&&g.terrain&&mt.clear({stencil:0});const Ti={func:Ge.EQUAL,mask:255};Xt.u_alpha_discard_threshold=.8,Cn(new a.StencilMode(Ti,bn,255,Ge.KEEP,Ge.KEEP,Ge.INVERT)),Xt.u_alpha_discard_threshold=0,Cn(new a.StencilMode(Ti,bn,255,Ge.KEEP,Ge.KEEP,Ge.KEEP))}else Cn(g.stencilModeForClipping(lt))}_t&&(g.resetStencilClippingMasks(),g.terrain&&mt.clear({stencil:0}))},fill:function(g,n,u,_){const x=u.paint.get("fill-color"),T=u.paint.get("fill-opacity");if(0===T.constantOr(1))return;const I=g.colorModeForRenderPass(),B=u.paint.get("fill-pattern"),J=g.opaquePassEnabledForLayer()&&!B.constantOr(1)&&1===x.constantOr(a.Color.transparent).a&&1===T.constantOr(0)?"opaque":"translucent";if(g.renderPass===J){const oe=g.depthModeForSublayer(1,"opaque"===g.renderPass?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);hs(g,n,u,_,oe,I,!1)}if("translucent"===g.renderPass&&u.paint.get("fill-antialias")){const oe=g.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);hs(g,n,u,_,oe,I,!0)}},"fill-extrusion":function(g,n,u,_){const x=u.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===g.renderPass){const T=new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D);if(1!==x||u.paint.get("fill-extrusion-pattern").constantOr(1))ya(g,n,u,_,T,a.StencilMode.disabled,a.ColorMode.disabled),ya(g,n,u,_,T,g.stencilModeFor3D(),g.colorModeForRenderPass()),g.resetStencilClippingMasks();else{const I=g.colorModeForRenderPass();ya(g,n,u,_,T,a.StencilMode.disabled,I)}}},hillshade:function(g,n,u,_){if("offscreen"!==g.renderPass&&"translucent"!==g.renderPass)return;const x=g.context,T=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),I=g.colorModeForRenderPass(),B=g.terrain&&g.terrain.renderingToTexture,[J,oe]="translucent"!==g.renderPass||B?[{},_]:g.stencilConfigForOverlap(_);for(const ce of oe){const ge=n.getTile(ce);if(ge.needsHillshadePrepare&&"offscreen"===g.renderPass)gr(g,ge,u,T,a.StencilMode.disabled,I);else if("translucent"===g.renderPass){const Re=B&&g.terrain?g.terrain.stencilModeForRTTOverlap(ce):J[ce.overscaledZ];Mi(g,ce,ge,u,T,Re,I)}}x.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,n,u,_,x,T){if("translucent"!==g.renderPass||0===u.paint.get("raster-opacity")||!_.length)return;const I=g.context,B=I.gl,J=n.getSource(),oe=g.useProgram("raster"),ce=g.colorModeForRenderPass(),ge=g.terrain&&g.terrain.renderingToTexture,[Re,We]=J instanceof zr||ge?[{},_]:g.stencilConfigForOverlap(_),$e=We[We.length-1].overscaledZ,Ye=!g.options.moving;for(const mt of We){const Ge=ge?a.DepthMode.disabled:g.depthModeForSublayer(mt.overscaledZ-$e,1===u.paint.get("raster-opacity")?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,B.LESS),dt=mt.toUnwrapped(),_t=n.getTile(mt);if(ge&&(!_t||!_t.hasData()))continue;const lt=ge?mt.projMatrix:g.transform.calculateProjMatrix(dt,Ye),ut=g.terrain&&ge?g.terrain.stencilModeForRTTOverlap(mt):Re[mt.overscaledZ],bt=T?0:u.paint.get("raster-fade-duration");_t.registerFadeDuration(bt);const qt=n.findLoadedParent(mt,0),cn=Wr(_t,qt,n,g.transform,bt);let Gn,On;g.terrain&&g.terrain.prepareDrawTile(mt);const Sn="nearest"===u.paint.get("raster-resampling")?B.NEAREST:B.LINEAR;I.activeTexture.set(B.TEXTURE0),_t.texture.bind(Sn,B.CLAMP_TO_EDGE),I.activeTexture.set(B.TEXTURE1),qt?(qt.texture.bind(Sn,B.CLAMP_TO_EDGE),Gn=Math.pow(2,qt.tileID.overscaledZ-_t.tileID.overscaledZ),On=[_t.tileID.canonical.x*Gn%1,_t.tileID.canonical.y*Gn%1]):_t.texture.bind(Sn,B.CLAMP_TO_EDGE);const mn=zs(lt,On||[0,0],Gn||1,cn,u,J instanceof zr?J.perspectiveTransform:[0,0]);if(g.prepareDrawProgram(I,oe,dt),J instanceof zr)oe.draw(I,B.TRIANGLES,Ge,a.StencilMode.disabled,ce,a.CullFaceMode.disabled,mn,u.id,J.boundsBuffer,g.quadTriangleIndexBuffer,J.boundsSegments);else{const{tileBoundsBuffer:Xt,tileBoundsIndexBuffer:Cn,tileBoundsSegments:bn}=g.getTileBoundsBuffers(_t);oe.draw(I,B.TRIANGLES,Ge,ut,ce,a.CullFaceMode.disabled,mn,u.id,Xt,Cn,bn)}}g.resetStencilClippingMasks()},background:function(g,n,u,_){const x=u.paint.get("background-color"),T=u.paint.get("background-opacity");if(0===T)return;const I=g.context,B=I.gl,J=g.transform,oe=J.tileSize,ce=u.paint.get("background-pattern");if(g.isPatternMissing(ce))return;const ge=!ce&&1===x.a&&1===T&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==ge)return;const Re=a.StencilMode.disabled,We=g.depthModeForSublayer(0,"opaque"===ge?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),$e=g.colorModeForRenderPass(),Ye=g.useProgram(ce?"backgroundPattern":"background");let mt,Ge=_;Ge||(mt=g.getBackgroundTiles(),Ge=Object.values(mt).map(_t=>_t.tileID)),ce&&(I.activeTexture.set(B.TEXTURE0),g.imageManager.bind(g.context));const dt=u.getCrossfadeParameters();for(const _t of Ge){const lt=_t.toUnwrapped(),ut=_?_t.projMatrix:g.transform.calculateProjMatrix(lt);g.prepareDrawTile(_t);const bt=n?n.getTile(_t):mt?mt[_t.key]:new a.Tile(_t,oe,J.zoom,g),qt=ce?ra(ut,T,g,ce,{tileID:_t,tileSize:oe},dt):Zr(ut,T,x);g.prepareDrawProgram(I,Ye,lt);const{tileBoundsBuffer:cn,tileBoundsIndexBuffer:Gn,tileBoundsSegments:On}=g.getTileBoundsBuffers(bt);Ye.draw(I,B.TRIANGLES,We,Re,$e,a.CullFaceMode.disabled,qt,u.id,cn,Gn,On)}},sky:function(g,n,u){const _=g.transform,x="mercator"===_.projection.name||"globe"===_.projection.name?1:a.smoothstep(7,8,_.zoom),T=u.paint.get("sky-opacity")*x;if(0===T)return;const I=g.context,B=u.paint.get("sky-type"),J=new a.DepthMode(I.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),oe=g.frameCounter/1e3%1;"atmosphere"===B?"offscreen"===g.renderPass?u.needsSkyboxCapture(g)&&(function(ce,ge,Re,We){const $e=ce.context,Ye=$e.gl;let mt=ge.skyboxFbo;if(!mt){mt=ge.skyboxFbo=$e.createFramebuffer(32,32,!1),ge.skyboxGeometry=new kn($e),ge.skyboxTexture=$e.gl.createTexture(),Ye.bindTexture(Ye.TEXTURE_CUBE_MAP,ge.skyboxTexture),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_S,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_T,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MIN_FILTER,Ye.LINEAR),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MAG_FILTER,Ye.LINEAR);for(let lt=0;lt<6;++lt)Ye.texImage2D(Ye.TEXTURE_CUBE_MAP_POSITIVE_X+lt,0,Ye.RGBA,32,32,0,Ye.RGBA,Ye.UNSIGNED_BYTE,null)}$e.bindFramebuffer.set(mt.framebuffer),$e.viewport.set([0,0,32,32]);const Ge=ge.getCenter(ce,!0),dt=ce.useProgram("skyboxCapture"),_t=new Float64Array(16);a.identity(_t),a.rotateY(_t,_t,.5*-Math.PI),Qn($e,ge,dt,_t,Ge,0),a.identity(_t),a.rotateY(_t,_t,.5*Math.PI),Qn($e,ge,dt,_t,Ge,1),a.identity(_t),a.rotateX(_t,_t,.5*-Math.PI),Qn($e,ge,dt,_t,Ge,2),a.identity(_t),a.rotateX(_t,_t,.5*Math.PI),Qn($e,ge,dt,_t,Ge,3),a.identity(_t),Qn($e,ge,dt,_t,Ge,4),a.identity(_t),a.rotateY(_t,_t,Math.PI),Qn($e,ge,dt,_t,Ge,5),$e.viewport.set([0,0,ce.width,ce.height])}(g,u),u.markSkyboxValid(g)):"sky"===g.renderPass&&function(ce,ge,Re,We,$e){const Ye=ce.context,mt=Ye.gl,Ge=ce.transform,dt=ce.useProgram("skybox");Ye.activeTexture.set(mt.TEXTURE0),mt.bindTexture(mt.TEXTURE_CUBE_MAP,ge.skyboxTexture);const _t={u_matrix:Ge.skyboxMatrix,u_sun_direction:ge.getCenter(ce,!1),u_cubemap:0,u_opacity:We,u_temporal_offset:$e};ce.prepareDrawProgram(Ye,dt),dt.draw(Ye,mt.TRIANGLES,Re,a.StencilMode.disabled,ce.colorModeForRenderPass(),a.CullFaceMode.backCW,_t,"skybox",ge.skyboxGeometry.vertexBuffer,ge.skyboxGeometry.indexBuffer,ge.skyboxGeometry.segment)}(g,u,J,T,oe):"gradient"===B&&"sky"===g.renderPass&&function(ce,ge,Re,We,$e){const Ye=ce.context,mt=Ye.gl,Ge=ce.transform,dt=ce.useProgram("skyboxGradient");ge.skyboxGeometry||(ge.skyboxGeometry=new kn(Ye)),Ye.activeTexture.set(mt.TEXTURE0);let _t=ge.colorRampTexture;_t||(_t=ge.colorRampTexture=new a.Texture(Ye,ge.colorRamp,mt.RGBA)),_t.bind(mt.LINEAR,mt.CLAMP_TO_EDGE);const lt=(ut=Ge.skyboxMatrix,bt=ge.getCenter(ce,!1),qt=ge.paint.get("sky-gradient-radius"),cn=We,Gn=$e,{u_matrix:ut,u_color_ramp:0,u_center_direction:bt,u_radius:a.degToRad(qt),u_opacity:cn,u_temporal_offset:Gn});var ut,bt,qt,cn,Gn;ce.prepareDrawProgram(Ye,dt),dt.draw(Ye,mt.TRIANGLES,Re,a.StencilMode.disabled,ce.colorModeForRenderPass(),a.CullFaceMode.backCW,lt,"skyboxGradient",ge.skyboxGeometry.vertexBuffer,ge.skyboxGeometry.indexBuffer,ge.skyboxGeometry.segment)}(g,u,J,T,oe)},debug:function(g,n,u){for(let _=0;_<u.length;_++)E(g,n,u[_])},custom:function(g,n,u){const _=g.context,x=u.implementation;if(g.transform.projection.unsupportedLayers&&g.transform.projection.unsupportedLayers.includes("custom"))a.warnOnce("Custom layers are not yet supported with non-mercator projections. Use mercator to enable custom layers.");else if("offscreen"===g.renderPass){const T=x.prerender;T&&(g.setCustomLayerDefaults(),_.setColorMode(g.colorModeForRenderPass()),T.call(x,_.gl,g.transform.customLayerMatrix()),_.setDirty(),g.setBaseState())}else if("translucent"===g.renderPass){g.setCustomLayerDefaults(),_.setColorMode(g.colorModeForRenderPass()),_.setStencilMode(a.StencilMode.disabled);const T="3d"===x.renderingMode?new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,a.DepthMode.ReadOnly);_.setDepthMode(T),x.render(_.gl,g.transform.customLayerMatrix()),_.setDirty(),g.setBaseState(),_.bindFramebuffer.set(null)}}};class wi{constructor(n,u){this.context=new Ei(n),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new ke,this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(n,u){const _=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ze(this,n));const x=this._terrain;this.transform.elevation=_?x:null,x.update(n,this.transform,u)}_updateFog(n){const u=n.fog;if(!u||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,x]=u.getFovAdjustedRange(this.transform._fov);if(_>x)return void(this.transform.fogCullDistSq=null);const T=_+.78*(x-_);this.transform.fogCullDistSq=T*T}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(n,u){if(this.width=n*a.exported.devicePixelRatio,this.height=u*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const n=this.context,u=new a.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(a.EXTENT,0),u.emplaceBack(0,a.EXTENT),u.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(u,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const _=new a.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(a.EXTENT,0),_.emplaceBack(0,a.EXTENT),_.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=n.createVertexBuffer(_,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const x=new a.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(x,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const T=new a.StructArrayLayout4i8;T.emplaceBack(0,0,0,0),T.emplaceBack(a.EXTENT,0,a.EXTENT,0),T.emplaceBack(0,a.EXTENT,0,a.EXTENT),T.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=n.createVertexBuffer(T,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const I=new a.StructArrayLayout3ui6;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(I);const B=new a.StructArrayLayout1ui2;for(const oe of[0,1,3,2,0])B.emplaceBack(oe);this.debugIndexBuffer=n.createIndexBuffer(B),this.emptyTexture=new a.Texture(n,{width:1,height:1,data:new Uint8Array([0,0,0,0])},n.gl.RGBA),this.identityMat=a.create();const J=this.context.gl;this.stencilClearMode=new a.StencilMode({func:J.ALWAYS,mask:0},0,255,J.ZERO,J.ZERO,J.ZERO),this.loadTimeStamps.push(a.window.performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context,u=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(n,u.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,go(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,u,_){if(!u||this.currentStencilSource===u.id||!n.isTileClipped()||!_||0===_.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let B=!1;for(const J of _)if(void 0===this._tileClippingMaskIDs[J.key]){B=!0;break}if(!B)return}this.currentStencilSource=u.id;const x=this.context,T=x.gl;this.nextStencilID+_.length>256&&this.clearStencil(),x.setColorMode(a.ColorMode.disabled),x.setDepthMode(a.DepthMode.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const B of _){const J=u.getTile(B),oe=this._tileClippingMaskIDs[B.key]=this.nextStencilID++,{tileBoundsBuffer:ce,tileBoundsIndexBuffer:ge,tileBoundsSegments:Re}=this.getTileBoundsBuffers(J);I.draw(x,T.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:T.ALWAYS,mask:0},oe,255,T.KEEP,T.KEEP,T.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,go(B.projMatrix),"$clipping",ce,ge,Re)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,u=this.context.gl;return new a.StencilMode({func:u.NOTEQUAL,mask:255},n,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const u=this.context.gl;return new a.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(n){const u=this.context.gl,_=n.sort((I,B)=>B.overscaledZ-I.overscaledZ),x=_[_.length-1].overscaledZ,T=_[0].overscaledZ-x+1;if(T>1){this.currentStencilSource=void 0,this.nextStencilID+T>256&&this.clearStencil();const I={};for(let B=0;B<T;B++)I[B+x]=new a.StencilMode({func:u.GEQUAL,mask:255},B+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=T,[I,_]}return[{[x]:a.StencilMode.disabled},_]}colorModeForRenderPass(){const n=this.context.gl;if(this._showOverdrawInspector){const u=1/8;return new a.ColorMode([n.CONSTANT_COLOR,n.ONE],new a.Color(u,u,u,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(n,u,_){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new a.DepthMode(_||this.context.gl.LEQUAL,u,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,u){this.style=n,this.options=u,this.lineAtlas=n.lineAtlas,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const _=this.style.order,x=this.style._sourceCaches;for(const oe in x){const ce=x[oe];ce.used&&ce.prepare(this.context)}const T={},I={},B={};for(const oe in x){const ce=x[oe];T[oe]=ce.getVisibleCoordinates(),I[oe]=T[oe].slice().reverse(),B[oe]=ce.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let oe=0;oe<_.length;oe++)if(this.style._layers[_[oe]].is3D()){this.opaquePassCutoff=oe;break}if(this.terrain&&(this.terrain.updateTileBinding(B),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const oe of _){const ce=this.style._layers[oe],ge=n._getLayerSourceCache(ce);if(!ce.hasOffscreenPass()||ce.isHidden(this.transform.zoom))continue;const Re=ge?I[ge.id]:void 0;("custom"===ce.type||ce.isSky()||Re&&Re.length)&&this.renderLayer(this,ge,ce,Re)}this.depthRangeFor3D=[0,1-(n.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let J=a.Color.transparent;if(this.style.fog&&this.style.fog.getOpacity(this.transform.pitch)&&(J=this.style.fog.properties.get("color")),this.context.clear({color:u.showOverdrawInspector?a.Color.black:J,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const oe=this.style._layers[_[this.currentLayer]],ce=n._getLayerSourceCache(oe);if(oe.isSky())continue;const ge=ce?I[ce.id]:void 0;this._renderTileClippingMasks(oe,ce,ge),this.renderLayer(this,ce,oe,ge)}if(this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const oe=this.style._layers[_[this.currentLayer]],ce=n._getLayerSourceCache(oe);oe.isSky()&&this.renderLayer(this,ce,oe,ce?I[ce.id]:void 0)}for("globe"===this.transform.projection.name&&function(oe){const ce=oe.context,ge=ce.gl,Re=oe.transform,We=new a.DepthMode(ge.LEQUAL,a.DepthMode.ReadOnly,[0,1]),$e=oe.useProgram("globeAtmosphere"),Ye=Re._camera.getWorldToCamera(Re.worldSize,1),mt=Re._camera.getCameraToClipPerspective(Re._fov,Re.width/Re.height,Re._nearZ,Re._farZ),Ge=a.mul([],Ye,a.calculateGlobeMatrix(Re,Re.worldSize)),dt=a.mul([],Re.labelPlaneMatrix,mt),_t=a.transformMat4([],[0,0,0],Ge),lt=a.add([],_t,[Re.worldSize/Math.PI/2,0,0]),ut=a.transformMat4([],_t,dt),bt=a.transformMat4([],lt,dt),qt=a.length(a.sub([],bt,ut)),cn=1-a.globeToMercatorTransition(Re.zoom),Gn={u_center:ut,u_radius:qt,u_screen_size:[Re.width,Re.height],u_pixel_ratio:a.exported.devicePixelRatio,u_opacity:cn,u_fadeout_range:2,u_start_color:[1,1,1],u_end_color:[.0118,.7451,.9882]};oe.prepareDrawProgram(ce,$e);const On=oe.globeSharedBuffers;On&&$e.draw(ce,ge.TRIANGLES,We,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,Gn,"skybox",On.atmosphereVertexBuffer,On.atmosphereIndexBuffer,On.atmosphereSegments)}(this),this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const oe=this.style._layers[_[this.currentLayer]],ce=n._getLayerSourceCache(oe);if(oe.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(oe)){if(oe.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ge=ce?("symbol"===oe.type?B:I)[ce.id]:void 0;this._renderTileClippingMasks(oe,ce,ce?T[ce.id]:void 0),this.renderLayer(this,ce,oe,ge),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let oe=null;a.values(this.style._layers).forEach(ce=>{const ge=n._getLayerSourceCache(ce);ge&&!ce.isHidden(this.transform.zoom)&&(!oe||oe.getSource().maxzoom<ge.getSource().maxzoom)&&(oe=ge)}),oe&&this.options.showTileBoundaries&&Yi.debug(this,oe,oe.getVisibleCoordinates())}this.options.showPadding&&function(oe){const ce=oe.transform.padding;To(oe,oe.transform.height-(ce.top||0),3,Wc),To(oe,ce.bottom||0,3,bc),D(oe,ce.left||0,3,Ds),D(oe,oe.transform.width-(ce.right||0),3,qs);const ge=oe.transform.centerPoint;var Re,We,$e,Ye;W(Re=oe,(We=ge.x)-1,($e=oe.transform.height-ge.y)-10,2,20,Ye=ts),W(Re,We-10,$e-1,20,2,Ye)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(n,u,_,x){_.isHidden(this.transform.zoom)||("background"===_.type||"sky"===_.type||"custom"===_.type||x&&x.length)&&(this.id=_.id,this.gpuTimingStart(_),n.transform.projection.unsupportedLayers&&n.transform.projection.unsupportedLayers.includes(_.type)||Yi[_.type](n,u,_,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let _=this.gpuTimers[n.id];_||(_=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),_.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,_.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}queryGpuTimers(n){const u={};for(const _ in n){const x=n[_],T=this.context.extTimerQuery,I=T.getQueryObjectEXT(x.query,T.QUERY_RESULT_EXT)/1e6;T.deleteQueryEXT(x.query),u[_]=I}return u}translatePosMatrix(n,u,_,x,T){if(!_[0]&&!_[1])return n;const I=T?"map"===x?this.transform.angle:0:"viewport"===x?-this.transform.angle:0;if(I){const oe=Math.sin(I),ce=Math.cos(I);_=[_[0]*ce-_[1]*oe,_[0]*oe+_[1]*ce]}const B=[T?_[0]:gt(u,_[0],this.transform.zoom),T?_[1]:gt(u,_[1],this.transform.zoom),0],J=new Float32Array(16);return a.translate(J,n,B),J}saveTileTexture(n){const u=this._tileTextures[n.size[0]];u?u.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const u=this._tileTextures[n];return u&&u.length>0?u.pop():null}isPatternMissing(n){if(!n)return!1;if(!n.from||!n.to)return!0;const u=this.imageManager.getPattern(n.from.toString()),_=this.imageManager.getPattern(n.to.toString());return!u||!_}currentGlobalDefines(){const n=this.terrain&&this.terrain.renderingToTexture,u=this.style&&this.style.fog,_=[];return this.terrain&&!this.terrain.renderingToTexture&&_.push("TERRAIN"),u&&!n&&0!==u.getOpacity(this.transform.pitch)&&_.push("FOG"),n&&_.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&_.push("OVERDRAW_INSPECTOR"),_}useProgram(n,u,_){this.cache=this.cache||{};const x=_||[],T=this.currentGlobalDefines().concat(x),I=tn.cacheKey(n,T,u);return this.cache[I]||(this.cache[I]=new tn(this.context,n,Dn[n],u,sl[n],T)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(n){this.terrain&&this.terrain.prepareDrawTile(n)}prepareDrawProgram(n,u,_){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const T=x.getOpacity(this.transform.pitch);0!==T&&u.setFogUniformValues(n,((I,B,J,oe)=>{const ce=B.properties.get("color"),ge=I.frameCounter/1e3%1,Re=[ce.r/ce.a,ce.g/ce.a,ce.b/ce.a,oe];return{u_fog_matrix:J?I.transform.calculateFogTileMatrix(J):I.identityMat,u_fog_range:B.getFovAdjustedRange(I.transform._fov),u_fog_color:Re,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:ge}})(this,x,_,T))}}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const n=this.context.gl,u=n.createTexture();return n.bindTexture(n.TEXTURE_2D,u),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&0!==n.getOpacity(this.transform.pitch)}getBackgroundTiles(){const n=this._backgroundTiles,u=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const x of _)u[x.key]=n[x.key]||new a.Tile(x,512,this.transform.tileZoom,this);return u}clearBackgroundTiles(){this._backgroundTiles={}}}class br{constructor(n=0,u=0,_=0,x=0){if(isNaN(n)||n<0||isNaN(u)||u<0||isNaN(_)||_<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=u,this.left=_,this.right=x}interpolate(n,u,_){return null!=u.top&&null!=n.top&&(this.top=a.number(n.top,u.top,_)),null!=u.bottom&&null!=n.bottom&&(this.bottom=a.number(n.bottom,u.bottom,_)),null!=u.left&&null!=n.left&&(this.left=a.number(n.left,u.left,_)),null!=u.right&&null!=n.right&&(this.right=a.number(n.right,u.right,_)),this}getCenter(n,u){const _=a.clamp((this.left+n-this.right)/2,0,n),x=a.clamp((this.top+u-this.bottom)/2,0,u);return new a.pointGeometry(_,x)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new br(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Vr(g,n){const u=a.getColumn(g,3);a.fromQuat(g,n),a.setColumn(g,3,u)}function ro(g,n){a.setColumn(g,3,[n[0],n[1],n[2],1])}function Fo(g,n){const u=a.identity$1([]);return a.rotateZ$1(u,u,-n),a.rotateX$1(u,u,-g),u}function ss(g,n){const u=[g[0],g[1],0],_=[n[0],n[1],0];if(a.length(u)>=1e-15){const I=a.normalize([],u);a.scale$2(_,I,a.dot(_,I)),n[0]=_[0],n[1]=_[1]}const x=a.cross([],n,g);if(a.len(x)<1e-15)return null;const T=Math.atan2(-x[1],x[0]);return Fo(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),T)}class ps{constructor(n,u){this.position=n,this.orientation=u}get position(){return this._position}set position(n){this._position=this._renderWorldCopies?function(u){if(!u)return;const _=Array.isArray(u)?new a.MercatorCoordinate(u[0],u[1],u[2]):u;return _.x=a.wrap(_.x,0,1),_}(n):n}lookAtPoint(n,u){if(this.orientation=null,!this.position)return;const _=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(n)):0,x=this.position,T=a.MercatorCoordinate.fromLngLat(n,_),I=[T.x-x.x,T.y-x.y,T.z-x.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=ss(I,u)}setPitchBearing(n,u){this.orientation=Fo(a.degToRad(n),a.degToRad(-u))}}class al{constructor(n,u){this._transform=a.identity([]),this._orientation=a.identity$1([]),u&&(this._orientation=u,Vr(this._transform,this._orientation)),n&&ro(this._transform,n)}get mercatorPosition(){const n=this.position;return new a.MercatorCoordinate(n[0],n[1],n[2])}get position(){const n=a.getColumn(this._transform,3);return[n[0],n[1],n[2]]}set position(n){ro(this._transform,n)}get orientation(){return this._orientation}set orientation(n){this._orientation=n,Vr(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,u){this._orientation=Fo(n,u),Vr(this._transform,this._orientation)}forward(){const n=a.getColumn(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=a.getColumn(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=a.getColumn(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,u){const _=new Float64Array(16);return a.invert(_,this.getWorldToCamera(n,u)),_}getWorldToCameraPosition(n,u,_){const x=this.position;a.scale$2(x,x,-n);const T=new Float64Array(16);return a.fromScaling(T,[_,_,_]),a.translate(T,T,x),T[10]*=u,T}getWorldToCamera(n,u){const _=new Float64Array(16),x=new Float64Array(4),T=this.position;return a.conjugate(x,this._orientation),a.scale$2(T,T,-n),a.fromQuat(_,x),a.translate(_,_,T),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=u,_[9]*=u,_[10]*=u,_[11]*=u,_}getCameraToClipPerspective(n,u,_,x){const T=new Float64Array(16);return a.perspective(T,n,u,_,x),T}getDistanceToElevation(n){const u=0===n?0:a.mercatorZfromAltitude(n,this.position[1]),_=this.forward();return(u-this.position[2])/_[2]}clone(){return new al([...this.position],[...this.orientation])}}function Il(g,n){const u=Ql(g),_=function(T,I,B,J,oe){const ce=new a.LngLat(B.lng-180*ks,B.lat),ge=new a.LngLat(B.lng+180*ks,B.lat),Re=T.project(ce.lng,ce.lat),We=T.project(ge.lng,ge.lat),$e=-Math.atan2(We.y-Re.y,We.x-Re.x),Ye=a.MercatorCoordinate.fromLngLat(B);Ye.y=a.clamp(Ye.y,-.999975,.999975);const mt=Ye.toLngLat(),Ge=T.project(mt.lng,mt.lat),dt=a.MercatorCoordinate.fromLngLat(mt);dt.x+=ks;const _t=dt.toLngLat(),lt=T.project(_t.lng,_t.lat),ut=Us(lt.x-Ge.x,lt.y-Ge.y,$e),bt=a.MercatorCoordinate.fromLngLat(mt);bt.y+=ks;const qt=bt.toLngLat(),cn=T.project(qt.lng,qt.lat),Gn=Us(cn.x-Ge.x,cn.y-Ge.y,$e),On=Math.abs(ut.x)/Math.abs(Gn.y),Sn=a.identity([]);a.rotateZ(Sn,Sn,-$e*(1-(oe?0:J)));const mn=a.identity([]);return a.scale(mn,mn,[1,1-(1-On)*J,1]),mn[4]=-Gn.x/Gn.y*J,a.rotateZ(mn,mn,$e),a.multiply$1(mn,Sn,mn),mn}(g.projection,0,g.center,u,n),x=Ra(g);return a.scale(_,_,[x,x,1]),_}function Ra(g){const n=g.projection,u=Ql(g),_=as(n,g.center),x=as(n,a.LngLat.convert(n.center));return Math.pow(2,_*u+(1-u)*x)}function Ql(g){const n=g.projection.range;if(!n)return 0;const u=Math.max(g.width,g.height),_=Math.log(u/1024)/Math.LN2;return a.smoothstep(n[0]+_,n[1]+_,g.zoom)}const ks=1/4e4;function as(g,n){const u=a.clamp(n.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),_=new a.LngLat(n.lng-180*ks,u),x=new a.LngLat(n.lng+180*ks,u),T=g.project(_.lng,u),I=g.project(x.lng,u),B=a.MercatorCoordinate.fromLngLat(_),J=a.MercatorCoordinate.fromLngLat(x),oe=I.x-T.x,ce=I.y-T.y,ge=J.x-B.x,Re=J.y-B.y,We=Math.sqrt((ge*ge+Re*Re)/(oe*oe+ce*ce));return Math.log(We)/Math.LN2}function Us(g,n,u){const _=Math.cos(u),x=Math.sin(u);return{x:g*_-n*x,y:g*x+n*_}}class Co{constructor(n,u,_,x,T){this.tileSize=512,this._renderWorldCopies=void 0===T||T,this._minZoom=n||0,this._maxZoom=u||22,this._minPitch=_??0,this._maxPitch=x??60,this.setProjection(),this.setMaxBounds(),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new br,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new al,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._projectionScaler=1,this._horizonShift=.1}clone(){const n=new Co(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return n.setProjection(this.getProjection()),n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n.tileSize=this.tileSize,n.setMaxBounds(this.getMaxBounds()),n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._cameraZoom=this._cameraZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,n?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(n){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),n&&this._constrainCameraAltitude(),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(n){null==n&&(n={name:"mercator"}),this.projectionOptions=n;const u=this.projection?this.getProjection():void 0;return this.projection=a.getProjection(n),!Q(u,this.getProjection())&&(this._calcMatrices(),!0)}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(n){void 0===n?n=!0:null===n&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.cameraWorldSize)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const u=-n*Math.PI/180;var _,x,T,I,B,J,oe,ce,ge,Re;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(_=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),x=this.rotationMatrix,I=this.angle,B=(T=this.rotationMatrix)[0],J=T[1],oe=T[2],ce=T[3],ge=Math.sin(I),Re=Math.cos(I),x[0]=B*Re+oe*ge,x[1]=J*Re+ce*ge,x[2]=B*-ge+oe*Re,x[3]=J*-ge+ce*Re)}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const u=a.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=n/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(n){const u=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const n=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center),-1);return-1===n?(this._cameraZoom=null,!1):(this._centerAltitude=n,!0)}_updateCameraOnTerrain(){this._cameraZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize)}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let x=0,T=0;for(let I=0;I<u.length;I++){const B=new a.pointGeometry(u[I][0]*this.width,_+u[I][1]*(this.height-_)),J=n.pointCoordinate(B);if(!J)continue;const oe=1/Math.hypot(J[0]-this._camera.position[0],J[1]-this._camera.position[1]);x+=J[3]*oe,T+=oe}return 0===T?NaN:x/T}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const n=this._cameraZoom,u=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*u,x=this._mercatorZfromZoom(n),T=this._mercatorZfromZoom(this._maxZoom),I=Math.max(x-_,T);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let _;_=n.z<this._camera.position[2]?[u.x,u.y,u.z]:[n.x,n.y,n.z];const x=a.length(a.sub([],this._camera.position,_));return a.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let u=!1;if(n.orientation&&!a.exactEquals(n.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(n.orientation)),n.position){const _=[n.position.x,n.position.y,n.position.z];a.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,u=new ps;return u.position=new a.MercatorCoordinate(n[0],n[1],n[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this.renderWorldCopies,u}_setCameraOrientation(n){if(!a.length$1(n))return!1;a.normalize$1(n,n);const u=a.transformQuat([],[0,0,-1],n),_=a.transformQuat([],[0,-1,0],n);if(_[2]<0)return!1;const x=ss(u,_);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(n){const u=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;n[2]=a.clamp(n[2],x/_,x/u),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,u,_){this._unmodified=!1,this._edgeInsets.interpolate(n,u,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const u=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(n){const u=[new a.UnwrappedTileID(0,n)];if(this.renderWorldCopies){const _=this.pointCoordinate(new a.pointGeometry(0,0)),x=this.pointCoordinate(new a.pointGeometry(this.width,0)),T=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),I=this.pointCoordinate(new a.pointGeometry(0,this.height)),B=Math.floor(Math.min(_.x,x.x,T.x,I.x)),J=Math.floor(Math.max(_.x,x.x,T.x,I.x)),oe=1;for(let ce=B-oe;ce<=J+oe;ce++)0!==ce&&u.push(new a.UnwrappedTileID(ce,n))}return u}coveringTiles(n){let u=this.coveringZoomLevel(n);const _=u,x=this.elevation&&!n.isTerrainDEM,T="mercator"===this.projection.name;if(void 0!==n.minzoom&&u<n.minzoom)return[];void 0!==n.maxzoom&&u>n.maxzoom&&(u=n.maxzoom);const I=this.locationCoordinate(this.center),B=1<<u,J=[B*I.x,B*I.y,0],oe=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u,"globe"!==this.projection.name),ce=this.pointCoordinate(this.getCameraPoint()),ge=B*a.mercatorZfromAltitude(1,this.center.lat),Re=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),We=[B*ce.x,B*ce.y,Re],$e=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),Ye=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?u:0,mt=n.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,Ge=n.isTerrainDEM?-mt:this._elevation?this._elevation.getMinElevationBelowMSL():0,dt=this.projection.isReprojectedInTileSpace?Ra(this):1,_t=Xt=>{const Cn=1/4e4,bn=new a.MercatorCoordinate(Xt.x+Cn,Xt.y,Xt.z),Ti=new a.MercatorCoordinate(Xt.x,Xt.y+Cn,Xt.z),Vi=Xt.toLngLat(),wr=bn.toLngLat(),$n=Ti.toLngLat(),Fi=this.locationCoordinate(Vi),ar=this.locationCoordinate(wr),Xr=this.locationCoordinate($n),xo=Math.hypot(ar.x-Fi.x,ar.y-Fi.y),or=Math.hypot(Xr.x-Fi.x,Xr.y-Fi.y);return Math.sqrt(xo*or)*dt/Cn},lt=Xt=>{const Cn=mt,bn=Ge;return{aabb:a.tileAABB(this,B,0,0,0,Xt,bn,Cn,this.projection),zoom:0,x:0,y:0,minZ:bn,maxZ:Cn,wrap:Xt,fullyVisible:!1}},ut=[];let bt=[];const qt=u,cn=n.reparseOverscaled?_:u,Gn=Xt=>Xt*Xt,On=Gn((Re-this._centerAltitude)*ge),Sn=Xt=>{if(!this._elevation||!Xt.tileID||!T)return;const Cn=this._elevation.getMinMaxForTile(Xt.tileID),bn=Xt.aabb;Cn?(bn.min[2]=Cn.min,bn.max[2]=Cn.max,bn.center[2]=(bn.min[2]+bn.max[2])/2):(Xt.shouldSplit=mn(Xt),Xt.shouldSplit||(bn.min[2]=bn.max[2]=bn.center[2]=this._centerAltitude))},mn=Xt=>{if(Xt.zoom<Ye)return!0;if(Xt.zoom===qt)return!1;if(null!=Xt.shouldSplit)return Xt.shouldSplit;const Cn=Xt.aabb.distanceX(We),bn=Xt.aabb.distanceY(We);let Ti=On;x&&(Ti=Gn(Xt.aabb.distanceZ(We)*ge));let Vi=1;if(this.projection.isReprojectedInTileSpace&&_<=5){const $n=Math.pow(2,Xt.zoom),Fi=_t(new a.MercatorCoordinate((Xt.x+.5)/$n,(Xt.y+.5)/$n));Vi=Fi>.85?1:Fi}const wr=Cn*Cn+bn*bn+Ti;return wr<Gn((1<<qt-Xt.zoom)*$e*Vi*(($n,Fi)=>{if(Fi*Gn(.707)<$n)return 1;const ar=Math.sqrt(Fi/$n);return ar/(1.4144271570014144+(Math.pow(1.1,ar-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Ti,On),wr))};if(this.renderWorldCopies)for(let Xt=1;Xt<=3;Xt++)ut.push(lt(-Xt)),ut.push(lt(Xt));for(ut.push(lt(0));ut.length>0;){const Xt=ut.pop(),Cn=Xt.x,bn=Xt.y;let Ti=Xt.fullyVisible;if(!Ti){const Vi=Xt.aabb.intersects(oe);if(0===Vi)continue;Ti=2===Vi}if(Xt.zoom!==qt&&mn(Xt))for(let Vi=0;Vi<4;Vi++){const wr=(Cn<<1)+Vi%2,$n=(bn<<1)+(Vi>>1),Fi={aabb:T?Xt.aabb.quadrant(Vi):a.tileAABB(this,B,Xt.zoom+1,wr,$n,Xt.wrap,Xt.minZ,Xt.maxZ,this.projection),zoom:Xt.zoom+1,x:wr,y:$n,wrap:Xt.wrap,fullyVisible:Ti,tileID:void 0,shouldSplit:void 0,minZ:Xt.minZ,maxZ:Xt.maxZ};x&&(Fi.tileID=new a.OverscaledTileID(Xt.zoom+1===qt?cn:Xt.zoom+1,Xt.wrap,Xt.zoom+1,wr,$n),Sn(Fi)),ut.push(Fi)}else{const Vi=Xt.zoom===qt?cn:Xt.zoom;if(n.minzoom&&n.minzoom>Vi)continue;const wr=J[0]-(.5+Cn+(Xt.wrap<<Xt.zoom))*(1<<u-Xt.zoom),$n=J[1]-.5-bn,Fi=Xt.tileID?Xt.tileID:new a.OverscaledTileID(Vi,Xt.wrap,Xt.zoom,Cn,bn);bt.push({tileID:Fi,distanceSq:wr*wr+$n*$n})}}if(this.fogCullDistSq){const Xt=this.fogCullDistSq,Cn=this.horizonLineFromTop();bt=bt.filter(bn=>{const Ti=[0,0,0,1],Vi=[a.EXTENT,a.EXTENT,0,1],wr=this.calculateFogTileMatrix(bn.tileID.toUnwrapped());a.transformMat4$1(Ti,Ti,wr),a.transformMat4$1(Vi,Vi,wr);const $n=a.getAABBPointSquareDist(Ti,Vi);if(0===$n)return!0;let Fi=!1;const ar=this._elevation;if(ar&&$n>Xt&&0!==Cn){const Xr=this.calculateProjMatrix(bn.tileID.toUnwrapped());let xo;n.isTerrainDEM||(xo=ar.getMinMaxForTile(bn.tileID)),xo||(xo={min:Ge,max:mt});const or=a.furthestTileCorner(this.rotation),Ki=[or[0]*a.EXTENT,or[1]*a.EXTENT,xo.max];a.transformMat4(Ki,Ki,Xr),Fi=(1-Ki[1])*this.height*.5<Cn}return $n<Xt||Fi})}return bt.sort((Xt,Cn)=>Xt.distanceSq-Cn.distanceSq).map(Xt=>Xt.tileID)}resize(n,u){this.width=n,this.height=u,this.pixelsToGLUnits=[2/n,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const u=a.clamp(n.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),_=this.projection.project(n.lng,u);return new a.pointGeometry(_.x*this.worldSize,_.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}setLocationAtPoint(n,u){const _=this.pointCoordinate(u),x=this.pointCoordinate(this.centerPoint),T=this.locationCoordinate(n);this.setLocation(new a.MercatorCoordinate(T.x-(_.x-x.x),T.y-(_.y-x.y)))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this._coordinatePoint(this.locationCoordinate(n),!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,u){const _=u?a.mercatorZfromAltitude(u,n.lat):void 0,x=this.projection.project(n.lng,n.lat);return new a.MercatorCoordinate(x.x,x.y,_)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,u){const _=u??this._centerAltitude,x=[n.x,n.y,0,1],T=[n.x,n.y,1,1];a.transformMat4$1(x,x,this.pixelMatrixInverse),a.transformMat4$1(T,T,this.pixelMatrixInverse);const I=T[3];a.scale$1(x,x,1/x[3]),a.scale$1(T,T,1/I);const B=x[2],J=T[2];return{p0:x,p1:T,t:B===J?0:(_-B)/(J-B)}}screenPointToMercatorRay(n){const u=[n.x,n.y,0,1],_=[n.x,n.y,1,1];return a.transformMat4$1(u,u,this.pixelMatrixInverse),a.transformMat4$1(_,_,this.pixelMatrixInverse),a.scale$1(u,u,1/u[3]),a.scale$1(_,_,1/_[3]),u[2]=a.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,_[2]=a.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,a.scale$1(u,u,1/this.worldSize),a.scale$1(_,_,1/this.worldSize),new a.Ray([u[0],u[1],u[2]],a.normalize([],a.sub([],_,u)))}rayIntersectionCoordinate(n){const{p0:u,p1:_,t:x}=n,T=a.mercatorZfromAltitude(u[2],this._center.lat),I=a.mercatorZfromAltitude(_[2],this._center.lat);return new a.MercatorCoordinate(a.number(u[0],_[0],x)/this.worldSize,a.number(u[1],_[1],x)/this.worldSize,a.number(T,I,x))}pointCoordinate(n,u=this._centerAltitude){return this.projection.createTileTransform(this,this.worldSize).pointCoordinate(n.x,n.y,u)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);const u=this.elevation;let _=this.elevation.pointCoordinate(n);if(_)return new a.MercatorCoordinate(_[0],_[1],_[2]);let x=0,T=this.horizonLineFromTop();if(n.y>T)return this.pointCoordinate(n);const I=.02*T,B=n.clone();for(let J=0;J<10&&T-x>I;J++){B.y=a.number(x,T,.66);const oe=u.pointCoordinate(B);oe?(T=B.y,_=oe):x=B.y}return _?new a.MercatorCoordinate(_[0],_[1],_[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){if(this.elevation)return!this.elevation.pointCoordinate(n);{const u=this.horizonLineFromTop();return n.y<u}}_coordinatePoint(n,u){const _=u&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,x=[n.x*this.worldSize,n.y*this.worldSize,_+n.toAltitude(),1];return a.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new a.pointGeometry(x[0]/x[3],x[1]/x[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(n,u){const _=new a.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),x=new a.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),T=new a.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),I=new a.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let B=this.pointCoordinate(_,n),J=this.pointCoordinate(x,n);const oe=this.pointCoordinate(T,u),ce=this.pointCoordinate(I,u),ge=(Re,We)=>(We.y-Re.y)/(We.x-Re.x);return B.y>1&&J.y>=0?B=new a.MercatorCoordinate((1-ce.y)/ge(ce,B)+ce.x,1):B.y<0&&J.y<=1&&(B=new a.MercatorCoordinate(-ce.y/ge(ce,B)+ce.x,0)),J.y>1&&B.y>=0?J=new a.MercatorCoordinate((1-oe.y)/ge(oe,J)+oe.x,1):J.y<0&&B.y<=1&&(J=new a.MercatorCoordinate(-oe.y/ge(oe,J)+oe.x,0)),(new a.LngLatBounds).extend(this.coordinateLocation(B)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(oe))}_getBounds3D(){const n=this.elevation;if(!n.visibleDemTiles.length)return this._getBounds(0,0);const u=n.visibleDemTiles.reduce((_,x)=>{if(x.dem){const T=x.dem.tree;_.min=Math.min(_.min,T.minimums[0]),_.max=Math.max(_.max,T.maximums[0])}return _},{min:Number.MAX_VALUE,max:0});return this._getBounds(u.min*n.exaggeration(),u.max*n.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(n=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-u*(1-this._horizonShift);return n?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,u){return this.projection.createTileTransform(this,u).createTileMatrix(n)}calculateDistanceTileData(n){const u=n.key,_=this._distanceTileDataCache;if(_[u])return _[u];const x=n.canonical,T=1/this.height,I=this.cameraWorldSize/this.zoomScale(x.z),B=(x.x+Math.pow(2,x.z)*n.wrap)*I,J=x.y*I,oe=this.point,ce=this.angle,ge=Math.sin(-ce),Re=-Math.cos(-ce);return _[u]={bearing:[ge,Re],center:[(oe.x-B)*T,(oe.y-J)*T],scale:I/a.EXTENT*T},_[u]}calculateFogTileMatrix(n){const u=n.key,_=this._fogTileMatrixCache;if(_[u])return _[u];const x=this.calculatePosMatrix(n,this.cameraWorldSize);return a.multiply$1(x,this.worldToFogMatrix,x),_[u]=new Float32Array(x),_[u]}calculateProjMatrix(n,u=!1){const _=n.key,x=u?this._alignedProjMatrixCache:this._projMatrixCache;if(x[_])return x[_];const T=this.calculatePosMatrix(n,this.worldSize);return a.multiply$1(T,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:u?this.alignedProjMatrix:this.projMatrix,T),x[_]=new Float32Array(T),x[_]}calculatePixelsToTileUnitsMatrix(n){const u=n.tileID.key,_=this._pixelsToTileUnitsCache;if(_[u])return _[u];const x=function(T,I){const{scale:B}=T.tileTransform,J=B*a.EXTENT/(T.tileSize*Math.pow(2,I.zoom-T.tileID.overscaledZ+T.tileID.canonical.z));return oe=new Float32Array(4),Re=(ce=I.inverseAdjustmentMatrix)[1],We=ce[2],$e=ce[3],mt=(ge=[J,J])[1],oe[0]=ce[0]*(Ye=ge[0]),oe[1]=Re*Ye,oe[2]=We*mt,oe[3]=$e*mt,oe;var oe,ce,ge,Re,We,$e,Ye,mt}(n,this);return _[u]=x,_[u]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const n=this._elevation;this._updateCameraState();const u=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(u),x=this._camera.forward(),T=a.mercatorZfromAltitude(1,this._center.lat);_[2]/=T,x[2]/=T,a.normalize(x,x);const I=n.raycast(_,x,n.exaggeration());if(I){const B=a.scaleAndAdd([],_,x,I),J=new a.MercatorCoordinate(B[0],B[1],a.mercatorZfromAltitude(B[2],a.latFromMercatorY(B[1]))),oe=(J.z+a.length([J.x-_[0],J.y-_[1],J.z-_[2]*T]))*this._projectionScaler;this._cameraZoom=this._zoomFromMercatorZ(oe),this._centerAltitude=J.toAltitude(),this._center=this.coordinateLocation(J),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const n=this._elevation;this._updateCameraState();const u=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(u),x=n.getAtPointOrZero(new a.MercatorCoordinate(..._)),T=this._minimumHeightOverTerrain()*Math.cos(a.degToRad(this._maxPitch)),I=this._camera.position[2]-this.pixelsPerMeter/this.worldSize*x;if(I<T){const B=this.locationCoordinate(this._center,this._centerAltitude),J=[B.x-_[0],B.y-_[1],B.z-_[2]],oe=a.length(J);J[2]-=(T-I)/this._projectionScaler;const ce=a.length(J);if(0===ce)return;a.scale$2(J,J,oe/ce*this._projectionScaler),this._camera.position=[B.x-J[0],B.y-J[1],B.z*this._projectionScaler-J[2]],this._camera.orientation=ss(J,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;if(this._constraining=!0,this.projection.isReprojectedInTileSpace){const ge=this.center;return ge.lat=a.clamp(ge.lat,this.minLat,this.maxLat),!this.maxBounds&&this.renderWorldCopies||(ge.lng=a.clamp(ge.lng,this.minLng,this.maxLng)),this.center=ge,void(this._constraining=!1)}const n=this._unmodified,{x:u,y:_}=this.point;let x=0,T=u,I=_;const B=this.width/2,J=this.height/2,oe=this.worldMinY*this.scale,ce=this.worldMaxY*this.scale;if(_-J<oe&&(I=oe+J),_+J>ce&&(I=ce-J),ce-oe<this.height&&(x=Math.max(x,this.height/(ce-oe)),I=(ce+oe)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const ge=this.worldMinX*this.scale,Re=this.worldMaxX*this.scale,We=this.worldSize/2-(ge+Re)/2;T=(u+We+this.worldSize)%this.worldSize-We,T-B<ge&&(T=ge+B),T+B>Re&&(T=Re-B),Re-ge<this.width&&(x=Math.max(x,this.width/(Re-ge)),T=(Re+ge)/2)}T===u&&I===_||(this.center=this.unproject(new a.pointGeometry(T,I))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCameraAltitude(),this._unmodified=n,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this._fov/2,u=this.centerOffset,_=this.pixelsPerMeter;this._projectionScaler=_/(a.mercatorZfromAltitude(1,this.center.lat)*this.worldSize),this.cameraToCenterDistance=.5/Math.tan(n)*this.height*this._projectionScaler,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?_:1),T=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);T[8]=2*-u.x/this.width,T[9]=2*u.y/this.height;let I=a.mul([],T,x);if(this.projection.isReprojectedInTileSpace){const lt=this.locationCoordinate(this.center),ut=a.identity([]);a.translate(ut,ut,[lt.x*this.worldSize,lt.y*this.worldSize,0]),a.multiply$1(ut,ut,Il(this)),a.translate(ut,ut,[-lt.x*this.worldSize,-lt.y*this.worldSize,0]),a.multiply$1(I,I,ut),this.inverseAdjustmentMatrix=function(bt){const qt=Il(bt,!0);return L([],[qt[0],qt[1],qt[4],qt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],I,[this.worldSize,this.worldSize,this.worldSize/_,1]),this.projMatrix=I,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const B=new Float32Array(16);a.identity(B),a.scale(B,B,[1,-1,1]),a.rotateX(B,B,this._pitch),a.rotateZ(B,B,this.angle);const J=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),oe=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;J[8]=2*-u.x/this.width,J[9]=2*(u.y+oe)/this.height,this.skyboxMatrix=a.multiply$1(B,J,B);const ce=this.point,ge=ce.x,Re=ce.y,We=this.width%2/2,$e=this.height%2/2,Ye=Math.cos(this.angle),mt=Math.sin(this.angle),Ge=ge-Math.round(ge)+Ye*We+mt*$e,dt=Re-Math.round(Re)+Ye*$e+mt*We,_t=new Float64Array(I);if(a.translate(_t,_t,[Ge>.5?Ge-1:Ge,dt>.5?dt-1:dt,0]),this.alignedProjMatrix=_t,I=a.create(),a.scale(I,I,[this.width/2,-this.height/2,1]),a.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=a.create(),a.scale(I,I,[1,-1,1]),a.translate(I,I,[-1,-1,0]),a.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=a.multiply$1(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=a.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");this.pixelMatrixInverse=I,this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSize,u=this.cameraPixelsPerMeter,_=this._camera.position,x=1/this.height,T=[n,n,u];a.scale$2(T,T,x),a.scale$2(_,_,-1),a.multiply$2(_,_,T);const I=a.create();a.translate(I,I,_),a.scale(I,I,T),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,u,x)}_computeCameraPosition(n){const u=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),x=this.point,T=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)*u-n/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-_[0]*T,x.y/this.worldSize-_[1]*T,n/this.worldSize*this._centerAltitude-_[2]*T]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=n[2];let x=1;_>0&&(x=Math.min((u-this._camera.position[2])/_,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,n,x),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,u=this._camera.forward(),{pitch:_,bearing:x}=this._camera.getPitchBearing(),T=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._projectionScaler,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),B=Math.max((n[2]-T)/Math.cos(_),I),J=this._zoomFromMercatorZ(B);a.scaleAndAdd(n,n,u,B),this._pitch=a.clamp(_,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(x,-Math.PI,Math.PI),this._setZoom(a.clamp(J,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=this.coordinateLocation(new a.MercatorCoordinate(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator to enable terrain."),1))}anyCornerOffEdge(n,u){const _=Math.min(n.x,u.x),x=Math.max(n.x,u.x),T=Math.min(n.y,u.y),I=Math.max(n.y,u.y);if(T<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const B=[new a.pointGeometry(_,T),new a.pointGeometry(x,I),new a.pointGeometry(_,I),new a.pointGeometry(x,T)],J=this.renderWorldCopies?-3:0,oe=this.renderWorldCopies?4:1;for(const ce of B){const ge=this.pointRayIntersection(ce);if(ge.t<0)return!0;const Re=this.rayIntersectionCoordinate(ge);if(Re.x<J||Re.y<0||Re.x>oe||Re.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(n,u){const _=a.length(a.sub([],this._camera.position,n)),x=this._zoomFromMercatorZ(_)+u;return _-this._mercatorZfromZoom(x)}getCameraPoint(){const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,n))}}function sa(g,n){let u=!1,_=null;const x=()=>{_=null,u&&(g(),_=setTimeout(x,n),u=!1)};return()=>(u=!0,_||x(),_)}class wc{constructor(n){this._hashName=n&&encodeURIComponent(n),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=sa(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,a.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return a.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(n){const u=this._map.getCenter(),_=Math.round(100*this._map.getZoom())/100,x=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),T=Math.pow(10,x),I=Math.round(u.lng*T)/T,B=Math.round(u.lat*T)/T,J=this._map.getBearing(),oe=this._map.getPitch();let ce="";if(ce+=n?`/${I}/${B}/${_}`:`${_}/${B}/${I}`,(J||oe)&&(ce+="/"+Math.round(10*J)/10),oe&&(ce+=`/${Math.round(oe)}`),this._hashName){const ge=this._hashName;let Re=!1;const We=a.window.location.hash.slice(1).split("&").map($e=>{const Ye=$e.split("=")[0];return Ye===ge?(Re=!0,`${Ye}=${ce}`):$e}).filter($e=>$e);return Re||We.push(`${ge}=${ce}`),`#${We.join("&")}`}return`#${ce}`}_getCurrentHash(){const n=a.window.location.hash.replace("#","");if(this._hashName){let u;return n.split("&").map(_=>_.split("=")).forEach(_=>{_[0]===this._hashName&&(u=_)}),(u&&u[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._getCurrentHash();if(n.length>=3&&!n.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(n[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+n[2],+n[1]],zoom:+n[0],bearing:u,pitch:+(n[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,n)}}const aa={linearity:.3,easing:a.bezier(0,0,.3,1)},ll=a.extend({deceleration:2500,maxSpeed:1400},aa),Yc=a.extend({deceleration:20,maxSpeed:1400},aa),Tc=a.extend({deceleration:1e3,maxSpeed:360},aa),kr=a.extend({deceleration:1e3,maxSpeed:90},aa);class La{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,u=a.exported.now();for(;n.length>0&&u-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:T}of this._inertiaBuffer)u.zoom+=T.zoomDelta||0,u.bearing+=T.bearingDelta||0,u.pitch+=T.pitchDelta||0,T.panDelta&&u.pan._add(T.panDelta),T.around&&(u.around=T.around),T.pinchAround&&(u.pinchAround=T.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(u.pan.mag()){const T=va(u.pan.mag(),_,a.extend({},ll,n||{}));x.offset=u.pan.mult(T.amount/u.pan.mag()),x.center=this._map.transform.center,la(x,T)}if(u.zoom){const T=va(u.zoom,_,Yc);x.zoom=this._map.transform.zoom+T.amount,la(x,T)}if(u.bearing){const T=va(u.bearing,_,Tc);x.bearing=this._map.transform.bearing+a.clamp(T.amount,-179,179),la(x,T)}if(u.pitch){const T=va(u.pitch,_,kr);x.pitch=this._map.transform.pitch+T.amount,la(x,T)}if(x.zoom||x.bearing){const T=void 0===u.pinchAround?u.around:u.pinchAround;x.around=T?this._map.unproject(T):this._map.getCenter()}return this.clear(),a.extend(x,{noMoveStart:!0})}}function la(g,n){(!g.duration||g.duration<n.duration)&&(g.duration=n.duration,g.easing=n.easing)}function va(g,n,u){const{maxSpeed:_,linearity:x,deceleration:T}=u,I=a.clamp(g*x/(n/1e3),-_,_),B=Math.abs(I)/(T*x);return{easing:u.easing,duration:1e3*B,amount:I*(B/2)}}class Ho extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,_,x={}){const T=Z.mousePos(u.getCanvasContainer(),_),I=u.unproject(T);super(n,a.extend({point:T,lngLat:I,originalEvent:_},x)),this._defaultPrevented=!1,this.target=u}}class ec extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,_){const x="touchend"===n?_.changedTouches:_.touches,T=Z.touchPos(u.getCanvasContainer(),x),I=T.map(J=>u.unproject(J)),B=T.reduce((J,oe,ce,ge)=>J.add(oe.div(ge.length)),new a.pointGeometry(0,0));super(n,{points:T,point:B,lngLats:I,lngLat:u.unproject(B),originalEvent:_}),this._defaultPrevented=!1}}class Hs extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,u,_){super(n,{originalEvent:_}),this._defaultPrevented=!1}}class Fa{constructor(n,u){this._map=n,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(n){return this._firePreventable(new Hs(n.type,this._map,n))}mousedown(n,u){return this._mousedownPos=u,this._firePreventable(new Ho(n.type,this._map,n))}mouseup(n){this._map.fire(new Ho(n.type,this._map,n))}preclick(n){const u=a.extend({},n);u.type="preclick",this._map.fire(new Ho(u.type,this._map,u))}click(n,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(n),this._map.fire(new Ho(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new Ho(n.type,this._map,n))}mouseover(n){this._map.fire(new Ho(n.type,this._map,n))}mouseout(n){this._map.fire(new Ho(n.type,this._map,n))}touchstart(n){return this._firePreventable(new ec(n.type,this._map,n))}touchmove(n){this._map.fire(new ec(n.type,this._map,n))}touchend(n){this._map.fire(new ec(n.type,this._map,n))}touchcancel(n){this._map.fire(new ec(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Au{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(n){this._map.fire(new Ho(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ho("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Ho(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Cc{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,u){this.isEnabled()&&n.shiftKey&&0===n.button&&(Z.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(n,u){if(!this._active)return;const _=u;if(this._lastPos.equals(_)||!this._box&&_.dist(this._startPos)<this._clickTolerance)return;const x=this._startPos;this._lastPos=_,this._box||(this._box=Z.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const T=Math.min(x.x,_.x),I=Math.max(x.x,_.x),B=Math.min(x.y,_.y),J=Math.max(x.y,_.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${T}px,${B}px)`,this._box.style.width=I-T+"px",this._box.style.height=J-B+"px")})}mouseupWindow(n,u){if(!this._active||0!==n.button)return;const _=this._startPos,x=u;if(this.reset(),Z.suppressClick(),_.x!==x.x||_.y!==x.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:T=>T.fitScreenCoordinates(_,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}keydown(n){this._active&&27===n.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Z.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(n,u){return this._map.fire(new a.Event(n,{originalEvent:u}))}}function Ws(g,n){const u={};for(let _=0;_<g.length;_++)u[g[_].identifier]=n[_];return u}class Ba{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(n,u,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=n.timeStamp),_.length===this.numTouches&&(this.centroid=function(x){const T=new a.pointGeometry(0,0);for(const I of x)T._add(I);return T.div(x.length)}(u),this.touches=Ws(_,u)))}touchmove(n,u,_){if(this.aborted||!this.centroid)return;const x=Ws(_,u);for(const T in this.touches){const I=this.touches[T],B=x[T];(!B||B.dist(I)>30)&&(this.aborted=!0)}}touchend(n,u,_){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),0===_.length){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class cl{constructor(n){this.singleTap=new Ba(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(n,u,_){this.singleTap.touchstart(n,u,_)}touchmove(n,u,_){this.singleTap.touchmove(n,u,_)}touchend(n,u,_){const x=this.singleTap.touchend(n,u,_);if(x){const T=n.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(x)<30;if(T&&I||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class Ec{constructor(){this._zoomIn=new cl({numTouches:1,numTaps:2}),this._zoomOut=new cl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,u,_){this._zoomIn.touchstart(n,u,_),this._zoomOut.touchstart(n,u,_)}touchmove(n,u,_){this._zoomIn.touchmove(n,u,_),this._zoomOut.touchmove(n,u,_)}touchend(n,u,_){const x=this._zoomIn.touchend(n,u,_),T=this._zoomOut.touchend(n,u,_);return x?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(x)},{originalEvent:n})}):T?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(T)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Mu={0:1,2:2};class Wo{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(n,u){return!1}_move(n,u){return{}}mousedown(n,u){if(this._lastPoint)return;const _=Z.mouseButton(n);this._correctButton(n,_)&&(this._lastPoint=u,this._eventButton=_)}mousemoveWindow(n,u){const _=this._lastPoint;if(_)if(n.preventDefault(),function(x,T){const I=Mu[T];return void 0===x.buttons||(x.buttons&I)!==I}(n,this._eventButton))this.reset();else if(this._moved||!(u.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(_,u)}mouseupWindow(n){this._lastPoint&&Z.mouseButton(n)===this._eventButton&&(this._moved&&Z.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Na extends Wo{mousedown(n,u){super.mousedown(n,u),this._lastPoint&&(this._active=!0)}_correctButton(n,u){return 0===u&&!n.ctrlKey}_move(n,u){return{around:u,panDelta:u.sub(n)}}}class ls extends Wo{_correctButton(n,u){return 0===u&&n.ctrlKey||2===u}_move(n,u){const _=.8*(u.x-n.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(n){n.preventDefault()}}class xa extends Wo{_correctButton(n,u){return 0===u&&n.ctrlKey||2===u}_move(n,u){const _=-.5*(u.y-n.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(n){n.preventDefault()}}class za{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=u.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(n,u,_){return this._calculateTransform(n,u,_)}touchmove(n,u,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===_.length)return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.preventDefault(),this._calculateTransform(n,u,_)}}touchend(n,u,_){this._calculateTransform(n,u,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,u,_){_.length>0&&(this._active=!0);const x=Ws(_,u),T=new a.pointGeometry(0,0),I=new a.pointGeometry(0,0);let B=0;for(const oe in x){const ce=x[oe],ge=this._touches[oe];ge&&(T._add(ce),I._add(ce.sub(ge)),B++,x[oe]=ce)}if(this._touches=x,B<this._minTouches||!I.mag())return;const J=I.div(B);return this._sum._add(J),this._sum.mag()<this._clickTolerance?void 0:{around:T.div(B),panDelta:J}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z.create("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show")},500)}}class Ys{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(n){}_move(n,u,_){return{}}touchstart(n,u,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([u[0],u[1]]))}touchmove(n,u,_){if(!this._firstTwoTouches)return;n.preventDefault();const[x,T]=this._firstTwoTouches,I=Js(_,u,x),B=Js(_,u,T);if(!I||!B)return;const J=this._aroundCenter?null:I.add(B).div(2);return this._move([I,B],J,n)}touchend(n,u,_){if(!this._firstTwoTouches)return;const[x,T]=this._firstTwoTouches,I=Js(_,u,x),B=Js(_,u,T);I&&B||(this._active&&Z.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&"center"===n.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Js(g,n,u){for(let _=0;_<g.length;_++)if(g[_].identifier===u)return n[_]}function ba(g,n){return Math.log(g/n)/Math.LN2}class Al extends Ys{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,u){const _=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(ba(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:ba(this._distance,_),pinchAround:u}}}function ca(g,n){return 180*g.angleWith(n)/Math.PI}class Ua extends Ys{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,u){const _=this._vector;if(this._vector=n[0].sub(n[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:ca(this._vector,_),pinchAround:u}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const u=25/(Math.PI*this._minDiameter)*360,_=ca(n,this._startVector);return Math.abs(_)<u}}function wa(g){return Math.abs(g.y)>Math.abs(g.x)}class Dc extends Ys{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(n){this._lastPoints=n,wa(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,u,_){const x=n[0].sub(this._lastPoints[0]),T=n[1].sub(this._lastPoints[1]);if(!(this._map._cooperativeGestures&&_.touches.length<3)&&(this._valid=this.gestureBeginsVertically(x,T,_.timeStamp),this._valid))return this._lastPoints=n,this._active=!0,{pitchDelta:(x.y+T.y)/2*-.5}}gestureBeginsVertically(n,u,_){if(void 0!==this._valid)return this._valid;const x=n.mag()>=2,T=u.mag()>=2;if(!x&&!T)return;if(!x||!T)return void 0===this._firstMove&&(this._firstMove=_),_-this._firstMove<100&&void 0;const I=n.y>0==u.y>0;return wa(n)&&wa(u)&&I}}const ul={panStep:100,bearingStep:15,pitchStep:10};class Ta{constructor(){const n=ul;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let u=0,_=0,x=0,T=0,I=0;switch(n.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:n.shiftKey?_=-1:(n.preventDefault(),T=-1);break;case 39:n.shiftKey?_=1:(n.preventDefault(),T=1);break;case 38:n.shiftKey?x=1:(n.preventDefault(),I=-1);break;case 40:n.shiftKey?x=-1:(n.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(_=0,x=0),{cameraAnimation:B=>{const J=B.getZoom();B.easeTo({duration:300,easeId:"keyboardHandler",easing:Jc,zoom:u?Math.round(J)+u*(n.shiftKey?2:1):J,bearing:B.getBearing()+_*this._bearingStep,pitch:B.getPitch()+x*this._pitchStep,offset:[-T*this._panStep,-I*this._panStep],center:B.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jc(g){return g*(2-g)}const Ic=4.000244140625;class Ca{constructor(n,u){this._map=n,this._el=n.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert","_isFullscreen"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&"center"===n.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||this._isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let u=n.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const _=a.exported.now(),x=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,0!==u&&u%Ic==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(x*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),n.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=n,this._delta-=u,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=Z.mousePos(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform,u=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(0!==this._delta){const J="wheel"===this._type&&Math.abs(this._delta)>Ic?this._wheelZoomRate:this._defaultZoomRate;let oe=2/(1+Math.exp(-Math.abs(this._delta*J)));this._delta<0&&0!==oe&&(oe=1/oe);const ce=u(),ge=Math.pow(2,ce),Re="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):ge;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(Re*oe))),"wheel"===this._type&&(this._startZoom=u(),this._easing=this._smoothOutEasing(200)),this._delta=0}const _="number"==typeof this._targetZoom?this._targetZoom:u(),x=this._startZoom,T=this._easing;let I,B=!1;if("wheel"===this._type&&x&&T){const J=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),oe=T(J);I=a.number(x,_,oe),J<1?this._frameId||(this._frameId=!0):B=!0}else I=_,B=!0;return this._active=!0,B&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!B,zoomDelta:I-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let u=a.ease;if(this._prevEase){const _=this._prevEase,x=(a.exported.now()-_.start)/_.duration,T=_.easing(x+.01)-_.easing(x),I=.27/Math.sqrt(T*T+1e-4)*.01,B=Math.sqrt(.0729-I*I);u=a.bezier(I,B,.25,1)}return this._prevEase={start:a.exported.now(),duration:n,easing:u},u}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Z.create("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_isFullscreen(){return!!a.window.document.fullscreenElement}_showBlockerAlert(){"hidden"===this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="visible"),this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show")},200)}}class Ml{constructor(n,u){this._clickZoom=n,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class tc{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,u){return n.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(n.shiftKey?-1:1),around:_.unproject(u)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sl{constructor(){this._tap=new cl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(n,u,_){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=u[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(n,u,_))}touchmove(n,u,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const x=u[0],T=x.y-this._swipePoint.y;return this._swipePoint=x,n.preventDefault(),this._active=!0,{zoomDelta:T/128}}}else this._tap.touchmove(n,u,_)}touchend(n,u,_){this._tapTime?this._swipePoint&&0===_.length&&this.reset():this._tap.touchend(n,u,_)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Za{constructor(n,u,_){this._el=n,this._mousePan=u,this._touchPan=_}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class nc{constructor(n,u,_){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=u,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ac{constructor(n,u,_,x){this._el=n,this._touchZoom=u,this._touchRotate=_,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const dl=g=>g.zoom||g.drag||g.pitch||g.rotate;class Mc extends a.Event{}class Pl{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,u){const _=a.sub([],u,n);this.radius=a.length(_[2]<0?a.div([],_,this.constants):[_[0],_[1],0])}projectRay(n){a.div(n,n,this.constants),a.normalize(n,n),a.mul$1(n,n,this.constants);const u=a.scale$2([],n,this.radius);if(u[2]>0){const _=a.scale$2([],[0,0,1],a.dot(u,[0,0,1])),x=a.scale$2([],a.normalize([],[u[0],u[1],0]),this.radius),T=a.add([],u,a.scale$2([],a.sub([],a.add([],x,_),u),2));u[0]=T[0],u[1]=T[1]}return u}}function kl(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class hl{constructor(n,u){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new La(n),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Pl,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),a.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[x,T,I]of this._listeners)x.addEventListener(T,x===a.window.document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[n,u,_]of this._listeners)n.removeEventListener(u,n===a.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(n){const u=this._map,_=u.getCanvasContainer();this._add("mapEvent",new Fa(u,n));const x=u.boxZoom=new Cc(u,n);this._add("boxZoom",x);const T=new Ec,I=new tc;u.doubleClickZoom=new Ml(I,T),this._add("tapZoom",T),this._add("clickZoom",I);const B=new Sl;this._add("tapDragZoom",B);const J=u.touchPitch=new Dc(u);this._add("touchPitch",J);const oe=new ls(n),ce=new xa(n);u.dragRotate=new nc(n,oe,ce),this._add("mouseRotate",oe,["mousePitch"]),this._add("mousePitch",ce,["mouseRotate"]);const ge=new Na(n),Re=new za(u,n);u.dragPan=new Za(_,ge,Re),this._add("mousePan",ge),this._add("touchPan",Re,["touchZoom","touchRotate"]);const We=new Ua,$e=new Al;u.touchZoomRotate=new Ac(_,$e,We,B),this._add("touchRotate",We,["touchPan","touchZoom"]),this._add("touchZoom",$e,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Au(u));const Ye=u.scrollZoom=new Ca(u,this);this._add("scrollZoom",Ye,["mousePan"]);const mt=u.keyboard=new Ta;this._add("keyboard",mt);for(const Ge of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[Ge]&&u[Ge].enable(n[Ge])}_add(n,u,_){this._handlers.push({handlerName:n,handler:u,allowed:_}),this._handlersById[n]=u}stop(n){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(dl(this._eventsInProgress))||this.isZooming()}_blockedByActive(n,u,_){for(const x in n)if(x!==_&&(!u||u.indexOf(x)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const u=[];for(const _ of n)this._el.contains(_.target)&&u.push(_);return u}handleEvent(n,u){this._updatingCamera=!0;const _="renderFrame"===n.type,x=_?void 0:n,T={needsRenderFrame:!1},I={},B={},J=n.touches?this._getMapTouches(n.touches):void 0,oe=J?Z.touchPos(this._el,J):_?void 0:Z.mousePos(this._el,n);for(const{handlerName:Re,handler:We,allowed:$e}of this._handlers){if(!We.isEnabled())continue;let Ye;this._blockedByActive(B,$e,Re)?We.reset():We[u||n.type]&&(Ye=We[u||n.type](n,oe,J),this.mergeHandlerResult(T,I,Ye,Re,x),Ye&&Ye.needsRenderFrame&&this._triggerRenderFrame()),(Ye||We.isActive())&&(B[Re]=We)}const ce={};for(const Re in this._previousActiveHandlers)B[Re]||(ce[Re]=x);this._previousActiveHandlers=B,(Object.keys(ce).length||kl(T))&&(this._changes.push([T,I,ce]),this._triggerRenderFrame()),(Object.keys(B).length||kl(T))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ge}=T;ge&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ge(this._map))}mergeHandlerResult(n,u,_,x,T){if(!_)return;a.extend(n,_);const I={handlerName:x,originalEvent:_.originalEvent||T};void 0!==_.zoomDelta&&(u.zoom=I),void 0!==_.panDelta&&(u.drag=I),void 0!==_.pitchDelta&&(u.pitch=I),void 0!==_.bearingDelta&&(u.rotate=I)}_applyChanges(){const n={},u={},_={};for(const[x,T,I]of this._changes)x.panDelta&&(n.panDelta=(n.panDelta||new a.pointGeometry(0,0))._add(x.panDelta)),x.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+x.pitchDelta),void 0!==x.around&&(n.around=x.around),void 0!==x.aroundCoord&&(n.aroundCoord=x.aroundCoord),void 0!==x.pinchAround&&(n.pinchAround=x.pinchAround),x.noInertia&&(n.noInertia=x.noInertia),a.extend(u,T),a.extend(_,I);this._updateMapTransform(n,u,_),this._changes=[]}_updateMapTransform(n,u,_){const x=this._map,T=x.transform,I=dt=>[dt.x,dt.y,dt.z];if((dt=>{const _t=this._eventsInProgress.drag;return _t&&!this._handlersById[_t.handlerName].isActive()})()&&!kl(n)){const dt=T.zoom;T.cameraElevationReference="sea",T.recenterOnTerrain(),T.cameraElevationReference="ground",dt!==T.zoom&&this._map._update(!0)}if(!kl(n))return this._fireEvents(u,_,!0);let{panDelta:B,zoomDelta:J,bearingDelta:oe,pitchDelta:ce,around:ge,aroundCoord:Re,pinchAround:We}=n;void 0!==We&&(ge=We),(dt=>u.drag&&!this._eventsInProgress.drag)()&&ge&&(this._dragOrigin=I(T.pointCoordinate3D(ge)),this._trackingEllipsoid.setup(T._camera.position,this._dragOrigin)),T.cameraElevationReference="sea",x._stop(!0),ge=ge||x.transform.centerPoint,oe&&(T.bearing+=oe),ce&&(T.pitch+=ce),T._updateCameraState();const $e=[0,0,0];if(B){const dt=T.pointCoordinate(ge),_t=T.pointCoordinate(ge.sub(B));dt&&_t&&($e[0]=_t.x-dt.x,$e[1]=_t.y-dt.y)}const Ye=T.zoom,mt=[0,0,0];if(J){const dt=I(Re||T.pointCoordinate3D(ge)),_t={dir:a.normalize([],a.sub([],dt,T._camera.position))};if(_t.dir[2]<0){const lt=T.zoomDeltaToMovement(dt,J);a.scale$2(mt,_t.dir,lt)}}const Ge=a.add($e,$e,mt);T._translateCameraConstrained(Ge),J&&Math.abs(T.zoom-Ye)>1e-4&&T.recenterOnTerrain(),T.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(u,_,!0)}_fireEvents(n,u,_){const x=dl(this._eventsInProgress),T=dl(n),I={};for(const ce in n){const{originalEvent:ge}=n[ce];this._eventsInProgress[ce]||(I[`${ce}start`]=ge),this._eventsInProgress[ce]=n[ce]}!x&&T&&this._fireEvent("movestart",T.originalEvent);for(const ce in I)this._fireEvent(ce,I[ce]);T&&this._fireEvent("move",T.originalEvent);for(const ce in n){const{originalEvent:ge}=n[ce];this._fireEvent(ce,ge)}const B={};let J;for(const ce in this._eventsInProgress){const{handlerName:ge,originalEvent:Re}=this._eventsInProgress[ce];this._handlersById[ge].isActive()||(delete this._eventsInProgress[ce],J=u[ge]||Re,B[`${ce}end`]=J)}for(const ce in B)this._fireEvent(ce,B[ce]);const oe=dl(this._eventsInProgress);if(_&&(x||T)&&!oe){this._updatingCamera=!0;const ce=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ge=Re=>0!==Re&&-this._bearingSnap<Re&&Re<this._bearingSnap;ce?(ge(ce.bearing||this._map.getBearing())&&(ce.bearing=0),this._map.easeTo(ce,{originalEvent:J})):(this._map.fire(new a.Event("moveend",{originalEvent:J})),ge(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,u){this._map.fire(new a.Event(n,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{delete this._frameId,this.handleEvent(new Mc("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Va="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class pl extends a.Evented{constructor(n,u){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=u.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,u){return this.jumpTo({center:n},u)}panBy(n,u,_){return n=a.pointGeometry.convert(n).mult(-1),this.panTo(this.transform.center,a.extend({offset:n},u),_)}panTo(n,u,_){return this.easeTo(a.extend({center:n},u),_)}getZoom(){return this.transform.zoom}setZoom(n,u){return this.jumpTo({zoom:n},u),this}zoomTo(n,u,_){return this.easeTo(a.extend({zoom:n},u),_)}zoomIn(n,u){return this.zoomTo(this.getZoom()+1,n,u),this}zoomOut(n,u){return this.zoomTo(this.getZoom()-1,n,u),this}getBearing(){return this.transform.bearing}setBearing(n,u){return this.jumpTo({bearing:n},u),this}getPadding(){return this.transform.padding}setPadding(n,u){return this.jumpTo({padding:n},u),this}rotateTo(n,u,_){return this.easeTo(a.extend({bearing:n},u),_)}resetNorth(n,u){return this.rotateTo(0,a.extend({duration:1e3},n),u),this}resetNorthPitch(n,u){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},n),u),this}snapToNorth(n,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,u):this}getPitch(){return this.transform.pitch}setPitch(n,u){return this.jumpTo({pitch:n},u),this}cameraForBounds(n,u){n=a.LngLatBounds.convert(n);const _=u&&u.bearing||0;return this._cameraForBoxAndBearing(n.getNorthWest(),n.getSouthEast(),_,u)}_extendCameraOptions(n){const u={top:0,bottom:0,right:0,left:0};if("number"==typeof(n=a.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){const _=n.padding;n.padding={top:_,bottom:_,right:_,left:_}}return n.padding=a.extend(u,n.padding),n}_cameraForBoxAndBearing(n,u,_,x){const T=this._extendCameraOptions(x),I=this.transform,B=I.padding,J=I.project(a.LngLat.convert(n)),oe=I.project(a.LngLat.convert(u)),ce=J.rotate(-a.degToRad(_)),ge=oe.rotate(-a.degToRad(_)),Re=new a.pointGeometry(Math.max(ce.x,ge.x),Math.max(ce.y,ge.y)),We=new a.pointGeometry(Math.min(ce.x,ge.x),Math.min(ce.y,ge.y)),$e=Re.sub(We),Ye=(I.width-(B.left+B.right+T.padding.left+T.padding.right))/$e.x,mt=(I.height-(B.top+B.bottom+T.padding.top+T.padding.bottom))/$e.y;if(mt<0||Ye<0)return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Ge=Math.min(I.scaleZoom(I.scale*Math.min(Ye,mt)),T.maxZoom),dt="number"==typeof T.offset.x?new a.pointGeometry(T.offset.x,T.offset.y):a.pointGeometry.convert(T.offset),_t=new a.pointGeometry((T.padding.left-T.padding.right)/2,(T.padding.top-T.padding.bottom)/2).rotate(_*Math.PI/180),lt=dt.add(_t).mult(I.scale/I.zoomScale(Ge));return{center:I.unproject(J.add(oe).div(2).sub(lt)),zoom:Ge,bearing:_}}_cameraForBox(n,u,_,x,T){const I=this._extendCameraOptions(T);_=_||0,x=x||0,n=a.LngLat.convert(n),u=a.LngLat.convert(u);const B=this.transform.clone();B.padding=I.padding;const J=this.getFreeCameraOptions(),oe=new a.LngLat(.5*(n.lng+u.lng),.5*(n.lat+u.lat)),ce=.5*(_+x);if(B._camera.position[2]<a.mercatorZfromAltitude(ce,oe.lat))return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");J.lookAtPoint(oe),B.setFreeCameraOptions(J);const ge=a.MercatorCoordinate.fromLngLat(n),Re=a.MercatorCoordinate.fromLngLat(u),We=B.pointRayIntersection(B.centerPoint,ce),$e=[(Ye=B.rayIntersectionCoordinate(We)).x,Ye.y,Ye.z];var Ye;const mt=B.screenPointToMercatorRay(B.centerPoint),Ge="globe"!==B.projection.name;let dt,_t=0;do{const lt=Math.floor(B.zoom),ut=1<<lt,bt=Math.min(ut*ge.x,ut*Re.x),qt=Math.min(ut*ge.y,ut*Re.y),cn=Math.max(ut*ge.x,ut*Re.x),Gn=Math.max(ut*ge.y,ut*Re.y),On=new a.Aabb([bt,qt,_],[cn,Gn,x]),Sn=a.Frustum.fromInvProjectionMatrix(B.invProjMatrix,B.worldSize,lt,Ge);if(2!==On.intersects(Sn)){dt&&(B._camera.position=a.scaleAndAdd([],B._camera.position,mt.dir,-dt),B._updateStateFromCamera());break}const mn=a.sub([],B._camera.position,$e);dt=.5*a.length(mn),B._camera.position=a.scaleAndAdd([],B._camera.position,mt.dir,dt);try{B._updateStateFromCamera()}catch{return void a.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++_t<10);return{center:B.center,zoom:B.zoom,bearing:B.bearing,pitch:B.pitch}}fitBounds(n,u,_){return this._fitInternal(this.cameraForBounds(n,u),u,_)}_raycastElevationBox(n,u){const _=this.transform.elevation;if(!_)return;const x=new a.pointGeometry(n.x,u.y),T=new a.pointGeometry(u.x,n.y),I=_.pointCoordinate(n);if(!I)return;const B=_.pointCoordinate(u);if(!B)return;const J=_.pointCoordinate(x);if(!J)return;const oe=_.pointCoordinate(T);if(!oe)return;const ce=new a.MercatorCoordinate(I[0],I[1]).toLngLat(),ge=new a.MercatorCoordinate(B[0],B[1]).toLngLat(),Re=new a.MercatorCoordinate(J[0],J[1]).toLngLat(),We=new a.MercatorCoordinate(oe[0],oe[1]).toLngLat(),$e=Math.min(ce.lng,Math.min(ge.lng,Math.min(Re.lng,We.lng))),Ye=Math.min(ce.lat,Math.min(ge.lat,Math.min(Re.lat,We.lat))),mt=Math.max(ce.lng,Math.max(ge.lng,Math.max(Re.lng,We.lng))),Ge=Math.max(ce.lat,Math.max(ge.lat,Math.max(Re.lat,We.lat))),dt=Math.min(I[3],Math.min(B[3],Math.min(J[3],oe[3]))),_t=Math.max(I[3],Math.max(B[3],Math.max(J[3],oe[3])));return{minLngLat:new a.LngLat($e,Ye),maxLngLat:new a.LngLat(mt,Ge),minAltitude:dt,maxAltitude:_t}}fitScreenCoordinates(n,u,_,x,T){let I,B,J,oe;const ce=a.pointGeometry.convert(n),ge=a.pointGeometry.convert(u),Re=this._raycastElevationBox(ce,ge);if(Re)I=Re.minLngLat,B=Re.maxLngLat,J=Re.minAltitude,oe=Re.maxAltitude;else{if(this.transform.anyCornerOffEdge(ce,ge))return this;I=this.transform.pointLocation(ce),B=this.transform.pointLocation(ge)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(a.pointGeometry.convert(n)),this.transform.pointLocation(a.pointGeometry.convert(u)),_,x):this._cameraForBox(I,B,J,oe,x),x,T)}_fitInternal(n,u,_){return n?(delete(u=a.extend(n,u)).padding,u.linear?this.easeTo(u,_):this.flyTo(u,_)):this}jumpTo(n,u){this.stop();const _=n.preloadOnly?this.transform.clone():this.transform;let x=!1,T=!1,I=!1;return"zoom"in n&&_.zoom!==+n.zoom&&(x=!0,_.zoom=+n.zoom),void 0!==n.center&&(_.center=a.LngLat.convert(n.center)),"bearing"in n&&_.bearing!==+n.bearing&&(T=!0,_.bearing=+n.bearing),"pitch"in n&&_.pitch!==+n.pitch&&(I=!0,_.pitch=+n.pitch),null==n.padding||_.isPaddingEqual(n.padding)||(_.padding=n.padding),n.preloadOnly?(this._preloadTiles(_),this):(this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),x&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),T&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),I&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Va),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,u){const _=this.transform;if(!_.projection.supportsFreeCamera)return void a.warnOnce(Va);this.stop();const x=_.zoom,T=_.pitch,I=_.bearing;_.setFreeCameraOptions(n);const B=x!==_.zoom,J=T!==_.pitch,oe=I!==_.bearing;return this.fire(new a.Event("movestart",u)).fire(new a.Event("move",u)),B&&this.fire(new a.Event("zoomstart",u)).fire(new a.Event("zoom",u)).fire(new a.Event("zoomend",u)),oe&&this.fire(new a.Event("rotatestart",u)).fire(new a.Event("rotate",u)).fire(new a.Event("rotateend",u)),J&&this.fire(new a.Event("pitchstart",u)).fire(new a.Event("pitch",u)).fire(new a.Event("pitchend",u)),this.fire(new a.Event("moveend",u)),this}easeTo(n,u){this._stop(!1,n.easeId),(!1===(n=a.extend({offset:[0,0],duration:500,easing:a.ease},n)).animate||!n.essential&&a.exported.prefersReducedMotion)&&(n.duration=0);const _=this.transform,x=this.getZoom(),T=this.getBearing(),I=this.getPitch(),B=this.getPadding(),J="zoom"in n?+n.zoom:x,oe="bearing"in n?this._normalizeBearing(n.bearing,T):T,ce="pitch"in n?+n.pitch:I,ge="padding"in n?n.padding:_.padding,Re=a.pointGeometry.convert(n.offset);let We=_.centerPoint.add(Re);const $e="globe"===_.projection.name?_.pointCoordinate(We).toLngLat():_.pointLocation(We),Ye=a.LngLat.convert(n.center||$e);this._normalizeCenter(Ye);const mt=_.project($e),Ge=_.project(Ye).sub(mt),dt=_.zoomScale(J-x);let _t,lt;n.around&&(_t=a.LngLat.convert(n.around),lt=_.locationPoint(_t));const ut=this._zooming||J!==x,bt=this._rotating||T!==oe,qt=this._pitching||ce!==I,cn=!_.isPaddingEqual(ge),Gn=Sn=>mn=>{if(ut&&(Sn.zoom=a.number(x,J,mn)),bt&&(Sn.bearing=a.number(T,oe,mn)),qt&&(Sn.pitch=a.number(I,ce,mn)),cn&&(Sn.interpolatePadding(B,ge,mn),We=Sn.centerPoint.add(Re)),_t)Sn.setLocationAtPoint(_t,lt);else{const Xt=Sn.zoomScale(Sn.zoom-x),Cn=J>x?Math.min(2,dt):Math.max(.5,dt),bn=Math.pow(Cn,1-mn),Ti=Sn.unproject(mt.add(Ge.mult(mn*bn)).mult(Xt));Sn.setLocationAtPoint(Sn.renderWorldCopies?Ti.wrap():Ti,We)}return n.preloadOnly||this._fireMoveEvents(u),Sn};if(n.preloadOnly){const Sn=this._emulate(Gn,n.duration,_);return this._preloadTiles(Sn),this}const On={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ut,this._rotating=bt,this._pitching=qt,this._padding=cn,this._easeId=n.easeId,this._prepareEase(u,n.noMoveStart,On),this._ease(Gn(_),Sn=>{_.recenterOnTerrain(),this._afterEase(u,Sn)},n),this}_prepareEase(n,u,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||_.moving||this.fire(new a.Event("movestart",n)),this._zooming&&!_.zooming&&this.fire(new a.Event("zoomstart",n)),this._rotating&&!_.rotating&&this.fire(new a.Event("rotatestart",n)),this._pitching&&!_.pitching&&this.fire(new a.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new a.Event("move",n)),this._zooming&&this.fire(new a.Event("zoom",n)),this._rotating&&this.fire(new a.Event("rotate",n)),this._pitching&&this.fire(new a.Event("pitch",n))}_afterEase(n,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId,this.transform.cameraElevationReference="ground";const _=this._zooming,x=this._rotating,T=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new a.Event("zoomend",n)),x&&this.fire(new a.Event("rotateend",n)),T&&this.fire(new a.Event("pitchend",n)),this.fire(new a.Event("moveend",n))}flyTo(n,u){if(!n.essential&&a.exported.prefersReducedMotion){const $n=a.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo($n,u)}this.stop(),n=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},n);const _=this.transform,x=this.getZoom(),T=this.getBearing(),I=this.getPitch(),B=this.getPadding(),J="zoom"in n?a.clamp(+n.zoom,_.minZoom,_.maxZoom):x,oe="bearing"in n?this._normalizeBearing(n.bearing,T):T,ce="pitch"in n?+n.pitch:I,ge="padding"in n?n.padding:_.padding,Re=_.zoomScale(J-x),We=a.pointGeometry.convert(n.offset);let $e=_.centerPoint.add(We);const Ye=_.pointLocation($e),mt=a.LngLat.convert(n.center||Ye);this._normalizeCenter(mt);const Ge=_.project(Ye),dt=_.project(mt).sub(Ge);let _t=n.curve;const lt=Math.max(_.width,_.height),ut=lt/Re,bt=dt.mag();if("minZoom"in n){const $n=a.clamp(Math.min(n.minZoom,x,J),_.minZoom,_.maxZoom),Fi=lt/_.zoomScale($n-x);_t=Math.sqrt(Fi/bt*2)}const qt=_t*_t;function cn($n){const Fi=(ut*ut-lt*lt+($n?-1:1)*qt*qt*bt*bt)/(2*($n?ut:lt)*qt*bt);return Math.log(Math.sqrt(Fi*Fi+1)-Fi)}function Gn($n){return(Math.exp($n)-Math.exp(-$n))/2}function On($n){return(Math.exp($n)+Math.exp(-$n))/2}const Sn=cn(0);let mn=function($n){return On(Sn)/On(Sn+_t*$n)},Xt=function($n){return lt*((On(Sn)*(Gn(Fi=Sn+_t*$n)/On(Fi))-Gn(Sn))/qt)/bt;var Fi},Cn=(cn(1)-Sn)/_t;if(Math.abs(bt)<1e-6||!isFinite(Cn)){if(Math.abs(lt-ut)<1e-6)return this.easeTo(n,u);const $n=ut<lt?-1:1;Cn=Math.abs(Math.log(ut/lt))/_t,Xt=function(){return 0},mn=function(Fi){return Math.exp($n*_t*Fi)}}n.duration="duration"in n?+n.duration:1e3*Cn/("screenSpeed"in n?+n.screenSpeed/_t:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const bn=T!==oe,Ti=ce!==I,Vi=!_.isPaddingEqual(ge),wr=$n=>Fi=>{const ar=Fi*Cn,Xr=1/mn(ar);$n.zoom=1===Fi?J:x+$n.scaleZoom(Xr),bn&&($n.bearing=a.number(T,oe,Fi)),Ti&&($n.pitch=a.number(I,ce,Fi)),Vi&&($n.interpolatePadding(B,ge,Fi),$e=$n.centerPoint.add(We));const xo=1===Fi?mt:$n.unproject(Ge.add(dt.mult(Xt(ar))).mult(Xr));return $n.setLocationAtPoint($n.renderWorldCopies?xo.wrap():xo,$e),$n._updateCenterElevation(),n.preloadOnly||this._fireMoveEvents(u),$n};if(n.preloadOnly){const $n=this._emulate(wr,n.duration,_);return this._preloadTiles($n),this}return this._zooming=!0,this._rotating=bn,this._pitching=Ti,this._padding=Vi,this._prepareEase(u,!1),this._ease(wr(_),()=>this._afterEase(u),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const _=this._onEaseEnd;delete this._onEaseEnd,_.call(this,u)}if(!n){const _=this.handlers;_&&_.stop(!1)}return this}_ease(n,u,_){!1===_.animate||0===_.duration?(n(1),u()):(this._easeStart=a.exported.now(),this._easeOptions=_,this._onEaseFrame=n,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,u){n=a.wrap(n,-180,180);const _=Math.abs(n-u);return Math.abs(n-360-u)<_&&(n-=360),Math.abs(n+360-u)<_&&(n+=360),n}_normalizeCenter(n){const u=this.transform;if(!u.renderWorldCopies||u.maxBounds)return;const _=n.lng-u.center.lng;n.lng+=_>180?-360:_<-180?360:0}_emulate(n,u,_){const x=Math.ceil(15*u/1e3),T=[],I=n(_.clone());for(let B=0;B<=x;B++){const J=I(B/x);T.push(J.clone())}return T}}class Kc{constructor(n={}){this.options=n,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const u=this.options&&this.options.compact;return this._map=n,this._container=Z.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Z.create("button","mapboxgl-ctrl-attrib-button",this._container),Z.create("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden",!0),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Z.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===u&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(n,u){const _=this._map._getUIString(`AttributionControl.${u}`);n.setAttribute("aria-label",_),n.removeAttribute("title"),n.firstElementChild&&n.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(n){const _=u.reduce((x,T,I)=>(T.value&&(x+=`${T.key}=${T.value}${I<u.length-1?"&":""}`),x),"?");n.href=`${a.config.FEEDBACK_URL}/${_}${this._map._hash?this._map._hash.getHashString(!0):""}`,n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}}_updateData(n){!n||"metadata"!==n.sourceDataType&&"visibility"!==n.sourceDataType&&"style"!==n.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const u=this._map.style._sourceCaches;for(const x in u){const T=u[x];if(T.used){const I=T.getSource();I.attribution&&n.indexOf(I.attribution)<0&&n.push(I.attribution)}}n.sort((x,T)=>x.length-T.length),n=n.filter((x,T)=>{for(let I=T+1;I<n.length;I++)if(n[I].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const _=n.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,n.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class ${constructor(){a.bindAll(["_updateLogo"],this),a.bindAll(["_updateCompact"],this)}onAdd(n){this._map=n,this._container=Z.create("div","mapboxgl-ctrl");const u=Z.create("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&"metadata"!==n.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(0===Object.entries(n).length)return!0;for(const u in n){const _=n[u].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const u=n[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class R{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const u=++this._id;return this._queue.push({callback:n,id:u,cancelled:!1}),u}remove(n){const u=this._currentlyRunning,_=u?this._queue.concat(u):this._queue;for(const x of _)if(x.id===n)return void(x.cancelled=!0)}run(n=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const _ of u)if(!_.cancelled&&(_.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function P(g,n,u){if(g=new a.LngLat(g.lng,g.lat),n){const _=new a.LngLat(g.lng-360,g.lat),x=new a.LngLat(g.lng+360,g.lat),T=360*Math.ceil(Math.abs(g.lng-u.center.lng)/360),I=u.locationPoint(g).distSqr(n),B=n.x<0||n.y<0||n.x>u.width||n.y>u.height;u.locationPoint(_).distSqr(n)<I&&(B||Math.abs(_.lng-u.center.lng)<T)?g=_:u.locationPoint(x).distSqr(n)<I&&(B||Math.abs(x.lng-u.center.lng)<T)&&(g=x)}for(;Math.abs(g.lng-u.center.lng)>180;){const _=u.locationPoint(g);if(_.x>=0&&_.y>=0&&_.x<=u.width&&_.y<=u.height)break;g.lng>u.center.lng?g.lng-=360:g.lng+=360}return g}const X={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class he extends a.Evented{constructor(n,u){if(super(),(n instanceof a.window.HTMLElement||u)&&(n=a.extend({element:n},u)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&"auto"!==n.pitchAlignment?n.pitchAlignment:this._rotationAlignment,this._updateMoving=()=>this._update(!0),n&&n.element)this._element=n.element,this._offset=a.pointGeometry.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=Z.create("div");const x=41,T=27,I=Z.createSVG("svg",{display:"block",height:x*this._scale+"px",width:T*this._scale+"px",viewBox:`0 0 ${T} ${x}`},this._element),B=Z.createSVG("radialGradient",{id:"shadowGradient"},Z.createSVG("defs",{},I));Z.createSVG("stop",{offset:"10%","stop-opacity":.4},B),Z.createSVG("stop",{offset:"100%","stop-opacity":.05},B),Z.createSVG("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),Z.createSVG("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),Z.createSVG("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),Z.createSVG("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=a.pointGeometry.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const _=this._element.classList;for(const x in X)_.remove(`mapboxgl-marker-anchor-${x}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick)),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._updateMoving),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=a.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const u=38.1,_=13.5,x=Math.sqrt(Math.pow(_,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-u],"bottom-left":[x,-1*(u-_+x)],"bottom-right":[-x,-1*(u-_+x)],left:[_,-1*(u-_)],right:[-_,-1*(u-_)]}:this._offset}this._popup=n,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const u=n.code,_=n.charCode||n.keyCode;"Space"!==u&&"Enter"!==u&&32!==_&&13!==_||this.togglePopup()}_onMapClick(n){const u=n.originalEvent.target,_=this._element;this._popup&&(u===_||_.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_evaluateOpacity(){const n=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(n))return void this._clearFadeTimer();const u=this._map.unproject(n);let _=!1;if(this._map.transform._terrainEnabled()&&this._map.getTerrain()){const T=this._map.getFreeCameraOptions();if(T.position){const I=T.position.toLngLat();_=I.distanceTo(u)<.9*I.distanceTo(this._lngLat)}}const x=(1-this._map._queryFogOpacity(u))*(_?.2:1);this._element.style.opacity=`${x}`,this._popup&&this._popup._setOpacity(`${x}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(n){const u=this._map.transform;return!!n&&n.x>=0&&n.x<u.width&&n.y>=0&&n.y<u.height}_updateDOM(){const n=this._pos||new a.pointGeometry(0,0),u=this._calculatePitch(),_=this._calculateRotation();this._element.style.transform=`${X[this._anchor]} translate(${n.x}px, ${n.y}px) rotateX(${u}deg) rotateZ(${_}deg)`}_calculatePitch(){return"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?0:"map"===this._pitchAlignment?this._map.getPitch():0}_calculateRotation(){return"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?this._rotation:"map"===this._rotationAlignment?this._rotation-this._map.getBearing():0}_update(n){a.window.cancelAnimationFrame(this._updateFrameId),this._map&&(this._map.transform.renderWorldCopies&&(this._lngLat=P(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset()),!0===n?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}_transformedOffset(){if(!this._defaultMarker)return this._offset;const n=this._map.transform,u=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&u._rotate(n.angle),"map"===this._pitchAlignment&&(u.y*=Math.cos(n._pitch)),u}getOffset(){return this._offset}setOffset(n){return this._offset=a.pointGeometry.convert(n),this._update(),this}_onMove(n){if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=n.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=n.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(n){this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=n.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(n){return this._draggable=!!n,this._map&&(n?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n&&"auto"!==n?n:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class Fe{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const u=a.easeCubicInOut((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,u,_){this._start=this.getValue(u),this._end=n,this._startTime=u,this._endTime=u+_}}const pt={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},{HTMLImageElement:It,HTMLElement:Tn,ImageBitmap:Ii}=a.window,ao={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function Ji(g){g.parentNode&&g.parentNode.removeChild(g)}const Do={showCompass:!0,showZoom:!0,visualizePitch:!1};class lo{constructor(n,u,_=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new ls({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,_&&(this.mousePitch=new xa({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),u.addEventListener("mousedown",this.mousedown),u.addEventListener("touchstart",this.touchstart,{passive:!1}),u.addEventListener("touchmove",this.touchmove),u.addEventListener("touchend",this.touchend),u.addEventListener("touchcancel",this.reset)}down(n,u){this.mouseRotate.mousedown(n,u),this.mousePitch&&this.mousePitch.mousedown(n,u),Z.disableDrag()}move(n,u){const _=this.map,x=this.mouseRotate.mousemoveWindow(n,u);if(x&&x.bearingDelta&&_.setBearing(_.getBearing()+x.bearingDelta),this.mousePitch){const T=this.mousePitch.mousemoveWindow(n,u);T&&T.pitchDelta&&_.setPitch(_.getPitch()+T.pitchDelta)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Z.enableDrag(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(a.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),Z.mousePos(this.element,n)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,Z.mousePos(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){1!==n.targetTouches.length?this.reset():(this._startPos=this._lastPos=Z.touchPos(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){1!==n.targetTouches.length?this.reset():(this._lastPos=Z.touchPos(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){0===n.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Kr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let No,ys=0,Os=!1;const $a={maxWidth:100,unit:"metric"};function li(g,n,u){const _=u&&u.maxWidth||100,x=g._containerHeight/2,T=g.unproject([0,x]),I=g.unproject([_,x]),B=T.distanceTo(I);if(u&&"imperial"===u.unit){const J=3.2808*B;J>5280?Ol(n,_,J/5280,g._getUIString("ScaleControl.Miles"),g):Ol(n,_,J,g._getUIString("ScaleControl.Feet"),g)}else u&&"nautical"===u.unit?Ol(n,_,B/1852,g._getUIString("ScaleControl.NauticalMiles"),g):B>=1e3?Ol(n,_,B/1e3,g._getUIString("ScaleControl.Kilometers"),g):Ol(n,_,B,g._getUIString("ScaleControl.Meters"),g)}function Ol(g,n,u,_,x){const T=function(B){const J=Math.pow(10,`${Math.floor(B)}`.length-1);let oe=B/J;return oe=oe>=10?10:oe>=5?5:oe>=3?3:oe>=2?2:oe>=1?1:function(ce){const ge=Math.pow(10,Math.ceil(-Math.log(ce)/Math.LN10));return Math.round(ce*ge)/ge}(oe),J*oe}(u),I=T/u;x._requestDomTask(()=>{g.style.width=n*I+"px",g.innerHTML=`${T}&nbsp;${_}`})}const _h={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},ja=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Rl={version:a.version,supported:O,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends pl{constructor(g){if(null!=(g=a.extend({},ao,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Co(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._renderTaskQueue=new R,this._domRenderTaskQueue=new R,this._controls=[],this._markers=[],this._mapId=a.uniqueId(),this._locale=a.extend({},pt,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new Fe(0),this._requestManager=new a.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,"string"==typeof g.container){if(this._container=a.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof Tn))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new hl(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this._hash=g.hash&&new wc("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,a.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),g.attributionControl&&this.addControl(new Kc({customAttribution:g.customAttribution})),this._logoControl=new $,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update("style"===n.dataType),this.fire(new a.Event(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new a.Event(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(g,n){if(void 0===n&&(n=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=g.onAdd(this);this._controls.push(g);const _=this._controlPositions[n];return-1!==n.indexOf("bottom")?_.insertBefore(u,_.firstChild):_.appendChild(u),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(g);return n>-1&&this._controls.splice(n,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new a.Event("movestart",g)).fire(new a.Event("move",g)),this.fire(new a.Event("resize",g)),n&&this.fire(new a.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(a.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}getProjection(){return this.transform.getProjection()}setProjection(g){return this._lazyInitEmptyStyle(),"string"==typeof g&&(g={name:g}),this._runtimeProjection=g,this.style.updateProjection(),this._transitionFromGlobe=!1,this}project(g){return this.transform.locationPoint3D(a.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(a.pointGeometry.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(g,n,u){if("mouseenter"===g||"mouseover"===g){let _=!1;const x=I=>{const B=n.filter(oe=>this.getLayer(oe)),J=B.length?this.queryRenderedFeatures(I.point,{layers:B}):[];J.length?_||(_=!0,u.call(this,new Ho(g,this,I.originalEvent,{features:J}))):_=!1},T=()=>{_=!1};return{layers:new Set(n),listener:u,delegates:{mousemove:x,mouseout:T}}}if("mouseleave"===g||"mouseout"===g){let _=!1;const x=I=>{const B=n.filter(J=>this.getLayer(J));(B.length?this.queryRenderedFeatures(I.point,{layers:B}):[]).length?_=!0:_&&(_=!1,u.call(this,new Ho(g,this,I.originalEvent)))},T=I=>{_&&(_=!1,u.call(this,new Ho(g,this,I.originalEvent)))};return{layers:new Set(n),listener:u,delegates:{mousemove:x,mouseout:T}}}{const _=x=>{const T=n.filter(B=>this.getLayer(B)),I=T.length?this.queryRenderedFeatures(x.point,{layers:T}):[];I.length&&(x.features=I,u.call(this,x),delete x.features)};return{layers:new Set(n),listener:u,delegates:{[g]:_}}}}on(g,n,u){if(void 0===u)return super.on(g,n);Array.isArray(n)||(n=[n]);const _=this._createDelegatedListener(g,n,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(_);for(const x in _.delegates)this.on(x,_.delegates[x]);return this}once(g,n,u){if(void 0===u)return super.once(g,n);Array.isArray(n)||(n=[n]);const _=this._createDelegatedListener(g,n,u);for(const x in _.delegates)this.once(x,_.delegates[x]);return this}off(g,n,u){if(void 0===u)return super.off(g,n);n=new Set(Array.isArray(n)?n:[n]);const _=(T,I)=>{if(T.size!==I.size)return!1;for(const B of T)if(!I.has(B))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[g]:void 0;return x&&(T=>{for(let I=0;I<T.length;I++){const B=T[I];if(B.listener===u&&_(B.layers,n)){for(const J in B.delegates)this.off(J,B.delegates[J]);return T.splice(I,1),this}}})(x),this}queryRenderedFeatures(g,n){return this.style?(void 0!==n||void 0===g||g instanceof a.pointGeometry||Array.isArray(g)||(n=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(g,n){return this.style.querySourceFeatures(g,n)}queryTerrainElevation(g,n){const u=this.transform.elevation;return u?(n=a.extend({},{exaggerated:!0},n),u.getAtPoint(a.MercatorCoordinate.fromLngLat(g),null,n.exaggerated)):null}setStyle(g,n){return!1!==(n=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(g,n))}_getUIString(g){const n=this._locale[g];if(null==n)throw new Error(`Missing UI string '${g}'`);return n}_updateStyle(g,n){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),g&&(this.style=new ie(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ie(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,n){if("string"==typeof g){const u=this._requestManager.normalizeStyleURL(g),_=this._requestManager.transformRequest(u,a.ResourceType.Style);a.getJSON(_,(x,T)=>{x?this.fire(new a.ErrorEvent(x)):T&&this._updateDiff(T,n)})}else"object"==typeof g&&this._updateDiff(g,n)}_updateDiff(g,n){try{this.style.setState(g)&&this._update(!0)}catch(u){a.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(g,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():a.warnOnce("There is no style added to the map.")}addSource(g,n){return this._lazyInitEmptyStyle(),this.style.addSource(g,n),this._update(!0)}isSourceLoaded(g){const n=this.style&&this.style._getSourceCaches(g);if(0!==n.length)return n.every(u=>u.loaded());this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${g}'`)))}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const n in g){const u=g[n]._tiles;for(const _ in u){const x=u[_];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}addSourceType(g,n,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,n,u)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,n,{pixelRatio:u=1,sdf:_=!1,stretchX:x,stretchY:T,content:I}={}){if(this._lazyInitEmptyStyle(),n instanceof It||Ii&&n instanceof Ii){const{width:B,height:J,data:oe}=a.exported.getImageData(n);this.style.addImage(g,{data:new a.RGBAImage({width:B,height:J},oe),pixelRatio:u,stretchX:x,stretchY:T,content:I,sdf:_,version:0})}else{if(void 0===n.width||void 0===n.height)return this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:B,height:J,data:oe}=n,ce=n;this.style.addImage(g,{data:new a.RGBAImage({width:B,height:J},new Uint8Array(oe)),pixelRatio:u,stretchX:x,stretchY:T,content:I,sdf:_,version:0,userImage:ce}),ce.onAdd&&ce.onAdd(this,g)}}}updateImage(g,n){const u=this.style.getImage(g);if(!u)return this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=n instanceof It||Ii&&n instanceof Ii?a.exported.getImageData(n):n,{width:x,height:T,data:I}=_;return void 0===x||void 0===T?this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):x!==u.data.width||T!==u.data.height?this.fire(new a.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(u.data.replace(I,!(n instanceof It||Ii&&n instanceof Ii)),void this.style.updateImage(g,u))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,n){a.getImage(this._requestManager.transformRequest(g,a.ResourceType.Image),(u,_)=>{n(u,_ instanceof It?a.exported.getImageData(_):_)})}listImages(){return this.style.listImages()}addLayer(g,n){return this._lazyInitEmptyStyle(),this.style.addLayer(g,n),this._update(!0)}moveLayer(g,n){return this.style.moveLayer(g,n),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,n,u){return this.style.setLayerZoomRange(g,n,u),this._update(!0)}setFilter(g,n,u={}){return this.style.setFilter(g,n,u),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,n,u,_={}){return this.style.setPaintProperty(g,n,u,_),this._update(!0)}getPaintProperty(g,n){return this.style.getPaintProperty(g,n)}setLayoutProperty(g,n,u,_={}){return this.style.setLayoutProperty(g,n,u,_),this._update(!0)}getLayoutProperty(g,n){return this.style.getLayoutProperty(g,n)}setLight(g,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,n),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}_updateProjection(){"globe"===this.transform.projection.name&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX&&!this._transitionFromGlobe&&(this.setProjection({name:"mercator"}),this._transitionFromGlobe=!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(g),this.transform):0}setFeatureState(g,n){return this.style.setFeatureState(g,n),this._update()}removeFeatureState(g,n){return this.style.removeFeatureState(g,n),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let u,_=this._container;for(;_&&!u;){const x=a.window.getComputedStyle(_).transform;x&&"none"!==x&&(u=x.match(/matrix.*\((.+)\)/)[1].split(", ")),_=_.parentElement}u?(this._containerWidth=u[0]&&"0"!==u[0]?Math.abs(g/u[0]):g,this._containerHeight=u[3]&&"0"!==u[3]?Math.abs(n/u[3]):n):(this._containerWidth=g,this._containerHeight=n)}_detectMissingCSS(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=Z.create("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=Z.create("div","mapboxgl-canvas-container",g);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=Z.create("canvas","mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const u=this._controlContainer=Z.create("div","mapboxgl-control-container",g),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{_[x]=Z.create("div",`mapboxgl-ctrl-${x}`,u)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,n){const u=a.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(g),this._canvas.height=u*Math.ceil(n),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${n}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const n=this._markers.indexOf(g);-1!==n&&this._markers.splice(n,1)}_setupPainter(){const g=a.extend({},O.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);n?(a.storeAuthState(n,!0),this.painter=new wi(n,this.transform),this.on("data",u=>{"source"===u.dataType&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(n)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let n;const u=this.painter.context.extTimerQuery,_=a.exported.now();this.listens("gpu-timing-frame")&&(n=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,n));let x=this._updateAverageElevation(_);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjection();let T=!1;const I=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,oe=this.transform.pitch,ce=a.exported.now();this.style.zoomHistory.update(J,ce);const ge=new a.EvaluationParameters(J,{now:ce,fadeDuration:I,pitch:oe,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),Re=ge.crossFadingFactor();1===Re&&Re===this._crossFadingFactor||(T=!0,this._crossFadingFactor=Re),this.style.update(ge)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,I,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:I,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&(this.style.hasTransitions()||T)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const J=a.exported.now()-_;u.endQueryEXT(u.TIME_ELAPSED_EXT,n),setTimeout(()=>{const oe=u.getQueryObjectEXT(n,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(n),this.fire(new a.Event("gpu-timing-frame",{cpuTime:J,gpuTime:oe}))},50)}if(this.listens("gpu-timing-layer")){const J=this.painter.collectGpuTimers();setTimeout(()=>{const oe=this.painter.queryGpuTimers(J);this.fire(new a.Event("gpu-timing-layer",{layerTimes:oe}))},50)}const B=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(B||this._repaint)this.triggerRepaint();else{const J=!this.isMoving()&&this.loaded();if(J&&(x=this._updateAverageElevation(_,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),J&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const oe=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:oe})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||B||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const g of this._markers)g._update()}_updateAverageElevation(g,n=!1){const u=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&u(0);if((n||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const _=this.transform.averageElevation;let x=this.transform.sampleAverageElevation();isNaN(x)?x=0:this._averageElevationLastSampledAt=g;const T=Math.abs(_-x);if(T>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(x),u(x);this._averageElevation.easeTo(x,g,300)}else if(T>1e-4)return this._averageElevation.jumpTo(x),u(x)}return!!this._averageElevation.isEasing(g)&&u(this._averageElevation.getValue(g))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===a.AUTH_ERR_MSG||401===g.status)){const n=this.painter.context.gl;a.storeAuthState(n,!1),this._logoControl instanceof $&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const u=this.painter.context.gl,_=u.createFramebuffer();function x(T){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,T,0);const I=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,I),I}return u.bindFramebuffer(u.FRAMEBUFFER,_),this._canvasPixelComparison(x(g),n.canvasCopies.map(x),n.timeStamps)}_canvasPixelComparison(g,n,u){let _=u[1]-u[0];const x=g.length/4;for(let T=0;T<n.length;T++){const I=n[T];let B=0;for(let J=0;J<I.length;J+=4)I[J]===g[J]&&I[J+1]===g[J+1]&&I[J+2]===g[J+2]&&I[J+3]===g[J+3]&&(B+=1);_+=(u[T+2]-u[T+1])*(1-B/x)}return _}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),Ji(this._canvasContainer),Ji(this._controlContainer),Ji(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=a.exported.frame(n=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(n)}))}_preloadTiles(g){const n=this.style&&Object.values(this.style._sourceCaches)||[];return a.asyncAll(n,(u,_)=>u._preloadTiles(g,_),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}_setCacheLimits(g,n){a.setCacheLimits(g,n)}get version(){return a.version}},NavigationControl:class{constructor(g){this.options=a.extend({},Do,g),this._container=Z.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>this._map.zoomIn({},{originalEvent:n})),Z.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>this._map.zoomOut({},{originalEvent:n})),Z.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:n}):this._map.resetNorth({},{originalEvent:n})}),this._compassIcon=Z.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const g=this._map.getZoom(),n=g===this._map.getMaxZoom(),u=g===this._map.getMinZoom();this._zoomInButton.disabled=n,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",n.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())}_rotateCompassArrow(){const g=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=g)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new lo(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){this._container.remove(),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,n){const u=Z.create("button",g,this._container);return u.type="button",u.addEventListener("click",n),u}_setButtonTitle(g,n){const u=this._map._getUIString(`NavigationControl.${n}`);g.setAttribute("aria-label",u),g.firstElementChild&&g.firstElementChild.setAttribute("title",u)}},GeolocateControl:class extends a.Evented{constructor(g){super(),this.options=a.extend({},Kr,g),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=sa(this._updateMarkerRotation,20)}onAdd(g){var n;return this._map=g,this._container=Z.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),n=this._setupUI,void 0!==No?n(No):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(u=>{No="denied"!==u.state,n(No)}):(No=!!a.window.navigator.geolocation,n(No)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,ys=0,Os=!1}_isOutOfMapMaxBounds(g){const n=this._map.getMaxBounds(),u=g.coords;return n&&(u.longitude<n.getWest()||u.longitude>n.getEast()||u.latitude<n.getSouth()||u.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(g),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",g)),this._finish()}}_updateCamera(g){const n=new a.LngLat(g.coords.longitude,g.coords.latitude),u=g.coords.accuracy,_=this._map.getBearing(),x=a.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(u),x,{geolocateSource:!0})}_updateMarker(g){if(g){const n=new a.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map._containerHeight/2,n=this._map.unproject([0,g]),u=this._map.unproject([100,g]),_=n.distanceTo(u)/100,x=Math.ceil(2*this._accuracy/_);this._circleElement.style.width=`${x}px`,this._circleElement.style.height=`${x}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(1===g.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===g.code&&Os)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=Z.create("button","mapboxgl-ctrl-geolocate",this._container),Z.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===g){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Z.create("div","mapboxgl-user-location"),this._dotElement.appendChild(Z.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Z.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new he({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Z.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new he({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||"ACTIVE_LOCK"!==this._watchState||n.originalEvent&&"resize"===n.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:!0===g.absolute&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":ys--,Os=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),ys++,ys>1?(g={maximumAge:6e5,timeout:0},Os=!0):(g=this.options.positionOptions,Os=!1),this._geolocationWatchID=a.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else a.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};void 0!==a.window.DeviceMotionEvent&&"function"==typeof a.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(n=>{"granted"===n&&g()}).catch(console.error):g()}_clearWatch(){a.window.navigator.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Kc,ScaleControl:class{constructor(g){this.options=a.extend({},$a,g),a.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){li(this._map,this._container,this.options)}onAdd(g){return this._map=g,this._container=Z.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._onMove),this._map=void 0}setUnit(g){this.options.unit=g,li(this._map,this._container,this.options)}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof a.window.HTMLElement?this._container=g.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=Z.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=Z.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Z.create("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden",!0),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(g){super(),this.options=a.extend(Object.create(_h),g),a.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&this._content.remove(),this._container&&(this._container.remove(),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=a.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(a.window.document.createTextNode(g))}setHTML(g){const n=a.window.document.createDocumentFragment(),u=a.window.document.createElement("body");let _;for(u.innerHTML=g;_=u.firstChild,_;)n.appendChild(_);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=Z.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._container&&this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._container&&this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let n;return this._classList.delete(g)?n=!1:(this._classList.add(g),n=!0),this._container&&this._updateClassList(),n}_createCloseButton(){this.options.closeButton&&(this._closeButton=Z.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.setAttribute("aria-hidden","true"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(g){this._update(g.point)}_onMouseMove(g){this._update(g.point)}_onDrag(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const n=this._pos,u=this._container.offsetWidth,_=this._container.offsetHeight;let x;return x=n.y+g.bottom.y<_?["top"]:n.y>this._map.transform.height-_?["bottom"]:[],n.x<u/2?x.push("left"):n.x>this._map.transform.width-u/2&&x.push("right"),0===x.length?"bottom":x.join("-")}_updateClassList(){const g=[...this._classList];g.push("mapboxgl-popup"),this._anchor&&g.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&g.push("mapboxgl-popup-track-pointer"),this._container.className=g.join(" ")}_update(g){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=Z.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=Z.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=P(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||g){const n=this._pos=this._trackPointer&&g?g:this._map.project(this._lngLat),u=function(T){if(T||(T=new a.pointGeometry(0,0)),"number"==typeof T){const I=Math.round(Math.sqrt(.5*Math.pow(T,2)));return{center:new a.pointGeometry(0,0),top:new a.pointGeometry(0,T),"top-left":new a.pointGeometry(I,I),"top-right":new a.pointGeometry(-I,I),bottom:new a.pointGeometry(0,-T),"bottom-left":new a.pointGeometry(I,-I),"bottom-right":new a.pointGeometry(-I,-I),left:new a.pointGeometry(T,0),right:new a.pointGeometry(-T,0)}}if(T instanceof a.pointGeometry||Array.isArray(T)){const I=a.pointGeometry.convert(T);return{center:I,top:I,"top-left":I,"top-right":I,bottom:I,"bottom-left":I,"bottom-right":I,left:I,right:I}}return{center:a.pointGeometry.convert(T.center||[0,0]),top:a.pointGeometry.convert(T.top||[0,0]),"top-left":a.pointGeometry.convert(T["top-left"]||[0,0]),"top-right":a.pointGeometry.convert(T["top-right"]||[0,0]),bottom:a.pointGeometry.convert(T.bottom||[0,0]),"bottom-left":a.pointGeometry.convert(T["bottom-left"]||[0,0]),"bottom-right":a.pointGeometry.convert(T["bottom-right"]||[0,0]),left:a.pointGeometry.convert(T.left||[0,0]),right:a.pointGeometry.convert(T.right||[0,0])}}(this.options.offset),_=this._anchor=this._getAnchor(u),x=n.add(u[_]).round();this._map._requestDomTask(()=>{this._container&&_&&(this._container.style.transform=`${X[_]} translate(${x.x}px,${x.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(ja);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._content&&(this._content.style.opacity=g),this._tip&&(this._tip.style.opacity=g)}},Marker:he,Style:ie,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:ps,Evented:a.Evented,config:a.config,prewarm:function(){tt().acquire(Qe)},clearPrewarmedResources:function(){const g=kt;g&&(g.isPreloaded()&&1===g.numActive()?(g.release(Qe),kt=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(g){a.config.ACCESS_TOKEN=g},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(g){a.config.API_URL=g},get workerCount(){return vt.workerCount},set workerCount(g){vt.workerCount=g},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){a.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){a.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Rl}),d}()},591:(_n,Ke,k)=>{"use strict";k.d(Ke,{X:()=>V});var d=k(8929),c=k(5279);class V extends d.xQ{constructor(O){super(),this._value=O}get value(){return this.getValue()}_subscribe(O){const A=super._subscribe(O);return A&&!A.closed&&O.next(this._value),A}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new c.N;return this._value}next(O){super.next(this._value=O)}}},2916:(_n,Ke,k)=>{"use strict";k.d(Ke,{y:()=>z});var d=k(3489),V=k(7668),a=k(3292),A=k(3821),p=k(5379);var Z=k(2830);let z=(()=>{class te{constructor(me){this._isScalar=!1,me&&(this._subscribe=me)}lift(me){const Ee=new te;return Ee.source=this,Ee.operator=me,Ee}subscribe(me,Ee,je){const{operator:rt}=this,Ae=function O(te,ye,me){if(te){if(te instanceof d.L)return te;if(te[V.b])return te[V.b]()}return te||ye||me?new d.L(te,ye,me):new d.L(a.c)}(me,Ee,je);if(Ae.add(rt?rt.call(Ae,this.source):this.source||Z.v.useDeprecatedSynchronousErrorHandling&&!Ae.syncErrorThrowable?this._subscribe(Ae):this._trySubscribe(Ae)),Z.v.useDeprecatedSynchronousErrorHandling&&Ae.syncErrorThrowable&&(Ae.syncErrorThrowable=!1,Ae.syncErrorThrown))throw Ae.syncErrorValue;return Ae}_trySubscribe(me){try{return this._subscribe(me)}catch(Ee){Z.v.useDeprecatedSynchronousErrorHandling&&(me.syncErrorThrown=!0,me.syncErrorValue=Ee),function c(te){for(;te;){const{closed:ye,destination:me,isStopped:Ee}=te;if(ye||Ee)return!1;te=me&&me instanceof d.L?me:null}return!0}(me)?me.error(Ee):console.warn(Ee)}}forEach(me,Ee){return new(Ee=G(Ee))((je,rt)=>{let Ae;Ae=this.subscribe(Ze=>{try{me(Ze)}catch(Ve){rt(Ve),Ae&&Ae.unsubscribe()}},rt,je)})}_subscribe(me){const{source:Ee}=this;return Ee&&Ee.subscribe(me)}[A.L](){return this}pipe(...me){return 0===me.length?this:function Q(te){return 0===te.length?p.y:1===te.length?te[0]:function(me){return te.reduce((Ee,je)=>je(Ee),me)}}(me)(this)}toPromise(me){return new(me=G(me))((Ee,je)=>{let rt;this.subscribe(Ae=>rt=Ae,Ae=>je(Ae),()=>Ee(rt))})}}return te.create=ye=>new te(ye),te})();function G(te){if(te||(te=Z.v.Promise||Promise),!te)throw new Error("no Promise impl found");return te}},3292:(_n,Ke,k)=>{"use strict";k.d(Ke,{c:()=>V});var d=k(2830),c=k(2782);const V={closed:!0,next(a){},error(a){if(d.v.useDeprecatedSynchronousErrorHandling)throw a;(0,c.z)(a)},complete(){}}},8929:(_n,Ke,k)=>{"use strict";k.d(Ke,{Yc:()=>p,xQ:()=>L});var d=k(2916),c=k(3489),V=k(2654),a=k(5279),O=k(5283),A=k(7668);class p extends c.L{constructor(z){super(z),this.destination=z}}let L=(()=>{class Z extends d.y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[A.b](){return new p(this)}lift(G){const te=new Q(this,this);return te.operator=G,te}next(G){if(this.closed)throw new a.N;if(!this.isStopped){const{observers:te}=this,ye=te.length,me=te.slice();for(let Ee=0;Ee<ye;Ee++)me[Ee].next(G)}}error(G){if(this.closed)throw new a.N;this.hasError=!0,this.thrownError=G,this.isStopped=!0;const{observers:te}=this,ye=te.length,me=te.slice();for(let Ee=0;Ee<ye;Ee++)me[Ee].error(G);this.observers.length=0}complete(){if(this.closed)throw new a.N;this.isStopped=!0;const{observers:G}=this,te=G.length,ye=G.slice();for(let me=0;me<te;me++)ye[me].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(G){if(this.closed)throw new a.N;return super._trySubscribe(G)}_subscribe(G){if(this.closed)throw new a.N;return this.hasError?(G.error(this.thrownError),V.w.EMPTY):this.isStopped?(G.complete(),V.w.EMPTY):(this.observers.push(G),new O.W(this,G))}asObservable(){const G=new d.y;return G.source=this,G}}return Z.create=(z,G)=>new Q(z,G),Z})();class Q extends L{constructor(z,G){super(),this.destination=z,this.source=G}next(z){const{destination:G}=this;G&&G.next&&G.next(z)}error(z){const{destination:G}=this;G&&G.error&&this.destination.error(z)}complete(){const{destination:z}=this;z&&z.complete&&this.destination.complete()}_subscribe(z){const{source:G}=this;return G?this.source.subscribe(z):V.w.EMPTY}}},5283:(_n,Ke,k)=>{"use strict";k.d(Ke,{W:()=>c});var d=k(2654);class c extends d.w{constructor(a,O){super(),this.subject=a,this.subscriber=O,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const a=this.subject,O=a.observers;if(this.subject=null,!O||0===O.length||a.isStopped||a.closed)return;const A=O.indexOf(this.subscriber);-1!==A&&O.splice(A,1)}}},3489:(_n,Ke,k)=>{"use strict";k.d(Ke,{L:()=>p});var d=k(7043),c=k(3292),V=k(2654),a=k(7668),O=k(2830),A=k(2782);class p extends V.w{constructor(Z,z,G){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=c.c;break;case 1:if(!Z){this.destination=c.c;break}if("object"==typeof Z){Z instanceof p?(this.syncErrorThrowable=Z.syncErrorThrowable,this.destination=Z,Z.add(this)):(this.syncErrorThrowable=!0,this.destination=new L(this,Z));break}default:this.syncErrorThrowable=!0,this.destination=new L(this,Z,z,G)}}[a.b](){return this}static create(Z,z,G){const te=new p(Z,z,G);return te.syncErrorThrowable=!1,te}next(Z){this.isStopped||this._next(Z)}error(Z){this.isStopped||(this.isStopped=!0,this._error(Z))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(Z){this.destination.next(Z)}_error(Z){this.destination.error(Z),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:Z}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=Z,this}}class L extends p{constructor(Z,z,G,te){super(),this._parentSubscriber=Z;let ye,me=this;(0,d.m)(z)?ye=z:z&&(ye=z.next,G=z.error,te=z.complete,z!==c.c&&(me=Object.create(z),(0,d.m)(me.unsubscribe)&&this.add(me.unsubscribe.bind(me)),me.unsubscribe=this.unsubscribe.bind(this))),this._context=me,this._next=ye,this._error=G,this._complete=te}next(Z){if(!this.isStopped&&this._next){const{_parentSubscriber:z}=this;O.v.useDeprecatedSynchronousErrorHandling&&z.syncErrorThrowable?this.__tryOrSetError(z,this._next,Z)&&this.unsubscribe():this.__tryOrUnsub(this._next,Z)}}error(Z){if(!this.isStopped){const{_parentSubscriber:z}=this,{useDeprecatedSynchronousErrorHandling:G}=O.v;if(this._error)G&&z.syncErrorThrowable?(this.__tryOrSetError(z,this._error,Z),this.unsubscribe()):(this.__tryOrUnsub(this._error,Z),this.unsubscribe());else if(z.syncErrorThrowable)G?(z.syncErrorValue=Z,z.syncErrorThrown=!0):(0,A.z)(Z),this.unsubscribe();else{if(this.unsubscribe(),G)throw Z;(0,A.z)(Z)}}}complete(){if(!this.isStopped){const{_parentSubscriber:Z}=this;if(this._complete){const z=()=>this._complete.call(this._context);O.v.useDeprecatedSynchronousErrorHandling&&Z.syncErrorThrowable?(this.__tryOrSetError(Z,z),this.unsubscribe()):(this.__tryOrUnsub(z),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(Z,z){try{Z.call(this._context,z)}catch(G){if(this.unsubscribe(),O.v.useDeprecatedSynchronousErrorHandling)throw G;(0,A.z)(G)}}__tryOrSetError(Z,z,G){if(!O.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{z.call(this._context,G)}catch(te){return O.v.useDeprecatedSynchronousErrorHandling?(Z.syncErrorValue=te,Z.syncErrorThrown=!0,!0):((0,A.z)(te),!0)}return!1}_unsubscribe(){const{_parentSubscriber:Z}=this;this._context=null,this._parentSubscriber=null,Z.unsubscribe()}}},2654:(_n,Ke,k)=>{"use strict";k.d(Ke,{w:()=>A});var d=k(6688),c=k(7830),V=k(7043);const O=(()=>{function L(Q){return Error.call(this),this.message=Q?`${Q.length} errors occurred during unsubscription:\n${Q.map((Z,z)=>`${z+1}) ${Z.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=Q,this}return L.prototype=Object.create(Error.prototype),L})();class A{constructor(Q){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,Q&&(this._ctorUnsubscribe=!0,this._unsubscribe=Q)}unsubscribe(){let Q;if(this.closed)return;let{_parentOrParents:Z,_ctorUnsubscribe:z,_unsubscribe:G,_subscriptions:te}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,Z instanceof A)Z.remove(this);else if(null!==Z)for(let ye=0;ye<Z.length;++ye)Z[ye].remove(this);if((0,V.m)(G)){z&&(this._unsubscribe=void 0);try{G.call(this)}catch(ye){Q=ye instanceof O?p(ye.errors):[ye]}}if((0,d.k)(te)){let ye=-1,me=te.length;for(;++ye<me;){const Ee=te[ye];if((0,c.K)(Ee))try{Ee.unsubscribe()}catch(je){Q=Q||[],je instanceof O?Q=Q.concat(p(je.errors)):Q.push(je)}}}if(Q)throw new O(Q)}add(Q){let Z=Q;if(!Q)return A.EMPTY;switch(typeof Q){case"function":Z=new A(Q);case"object":if(Z===this||Z.closed||"function"!=typeof Z.unsubscribe)return Z;if(this.closed)return Z.unsubscribe(),Z;if(!(Z instanceof A)){const te=Z;Z=new A,Z._subscriptions=[te]}break;default:throw new Error("unrecognized teardown "+Q+" added to Subscription.")}let{_parentOrParents:z}=Z;if(null===z)Z._parentOrParents=this;else if(z instanceof A){if(z===this)return Z;Z._parentOrParents=[z,this]}else{if(-1!==z.indexOf(this))return Z;z.push(this)}const G=this._subscriptions;return null===G?this._subscriptions=[Z]:G.push(Z),Z}remove(Q){const Z=this._subscriptions;if(Z){const z=Z.indexOf(Q);-1!==z&&Z.splice(z,1)}}}var L;function p(L){return L.reduce((Q,Z)=>Q.concat(Z instanceof O?Z.errors:Z),[])}A.EMPTY=((L=new A).closed=!0,L)},2830:(_n,Ke,k)=>{"use strict";k.d(Ke,{v:()=>c});let d=!1;const c={Promise:void 0,set useDeprecatedSynchronousErrorHandling(V){if(V){const a=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+a.stack)}else d&&console.log("RxJS: Back to a better error behavior. Thank you. <3");d=V},get useDeprecatedSynchronousErrorHandling(){return d}}},1177:(_n,Ke,k)=>{"use strict";k.d(Ke,{IY:()=>a,Ds:()=>A,ft:()=>L});var d=k(3489),c=k(2916),V=k(9249);class a extends d.L{constructor(Z){super(),this.parent=Z}_next(Z){this.parent.notifyNext(Z)}_error(Z){this.parent.notifyError(Z),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class A extends d.L{notifyNext(Z){this.destination.next(Z)}notifyError(Z){this.destination.error(Z)}notifyComplete(){this.destination.complete()}}function L(Q,Z){if(!Z.closed)return Q instanceof c.y?Q.subscribe(Z):(0,V.s)(Q)(Z)}},1762:(_n,Ke,k)=>{"use strict";k.d(Ke,{c:()=>O,N:()=>A});var d=k(8929),c=k(2916),V=k(2654),a=k(4327);class O extends c.y{constructor(z,G){super(),this.source=z,this.subjectFactory=G,this._refCount=0,this._isComplete=!1}_subscribe(z){return this.getSubject().subscribe(z)}getSubject(){const z=this._subject;return(!z||z.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let z=this._connection;return z||(this._isComplete=!1,z=this._connection=new V.w,z.add(this.source.subscribe(new p(this.getSubject(),this))),z.closed&&(this._connection=null,z=V.w.EMPTY)),z}refCount(){return(0,a.x)()(this)}}const A=(()=>{const Z=O.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:Z._subscribe},_isComplete:{value:Z._isComplete,writable:!0},getSubject:{value:Z.getSubject},connect:{value:Z.connect},refCount:{value:Z.refCount}}})();class p extends d.Yc{constructor(z,G){super(z),this.connectable=G}_error(z){this._unsubscribe(),super._error(z)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const z=this.connectable;if(z){this.connectable=null;const G=z._connection;z._refCount=0,z._subject=null,z._connection=null,G&&G.unsubscribe()}}}},1221:(_n,Ke,k)=>{"use strict";k.d(Ke,{z:()=>a});var d=k(1086),c=k(9146);function a(...O){return function V(){return(0,c.J)(1)}()((0,d.of)(...O))}},8514:(_n,Ke,k)=>{"use strict";k.d(Ke,{P:()=>a});var d=k(2916),c=k(5254),V=k(8896);function a(O){return new d.y(A=>{let p;try{p=O()}catch(Q){return void A.error(Q)}return(p?(0,c.D)(p):(0,V.c)()).subscribe(A)})}},8896:(_n,Ke,k)=>{"use strict";k.d(Ke,{E:()=>c,c:()=>V});var d=k(2916);const c=new d.y(O=>O.complete());function V(O){return O?function a(O){return new d.y(A=>O.schedule(()=>A.complete()))}(O):c}},567:(_n,Ke,k)=>{"use strict";k.d(Ke,{D:()=>A});var d=k(2916),c=k(6688),V=k(4850),a=k(7830),O=k(5254);function A(...L){if(1===L.length){const Q=L[0];if((0,c.k)(Q))return p(Q,null);if((0,a.K)(Q)&&Object.getPrototypeOf(Q)===Object.prototype){const Z=Object.keys(Q);return p(Z.map(z=>Q[z]),Z)}}if("function"==typeof L[L.length-1]){const Q=L.pop();return p(L=1===L.length&&(0,c.k)(L[0])?L[0]:L,null).pipe((0,V.U)(Z=>Q(...Z)))}return p(L,null)}function p(L,Q){return new d.y(Z=>{const z=L.length;if(0===z)return void Z.complete();const G=new Array(z);let te=0,ye=0;for(let me=0;me<z;me++){const Ee=(0,O.D)(L[me]);let je=!1;Z.add(Ee.subscribe({next:rt=>{je||(je=!0,ye++),G[me]=rt},error:rt=>Z.error(rt),complete:()=>{te++,(te===z||!je)&&(ye===z&&Z.next(Q?Q.reduce((rt,Ae,Ze)=>(rt[Ae]=G[Ze],rt),{}):G),Z.complete())}}))}})}},5254:(_n,Ke,k)=>{"use strict";k.d(Ke,{D:()=>me});var d=k(2916),c=k(9249),V=k(2654),a=k(3821),p=k(6454),L=k(5430),z=k(8955),G=k(8515);function me(Ee,je){return je?function ye(Ee,je){if(null!=Ee){if(function Z(Ee){return Ee&&"function"==typeof Ee[a.L]}(Ee))return function O(Ee,je){return new d.y(rt=>{const Ae=new V.w;return Ae.add(je.schedule(()=>{const Ze=Ee[a.L]();Ae.add(Ze.subscribe({next(Ve){Ae.add(je.schedule(()=>rt.next(Ve)))},error(Ve){Ae.add(je.schedule(()=>rt.error(Ve)))},complete(){Ae.add(je.schedule(()=>rt.complete()))}}))})),Ae})}(Ee,je);if((0,z.t)(Ee))return function A(Ee,je){return new d.y(rt=>{const Ae=new V.w;return Ae.add(je.schedule(()=>Ee.then(Ze=>{Ae.add(je.schedule(()=>{rt.next(Ze),Ae.add(je.schedule(()=>rt.complete()))}))},Ze=>{Ae.add(je.schedule(()=>rt.error(Ze)))}))),Ae})}(Ee,je);if((0,G.z)(Ee))return(0,p.r)(Ee,je);if(function te(Ee){return Ee&&"function"==typeof Ee[L.hZ]}(Ee)||"string"==typeof Ee)return function Q(Ee,je){if(!Ee)throw new Error("Iterable cannot be null");return new d.y(rt=>{const Ae=new V.w;let Ze;return Ae.add(()=>{Ze&&"function"==typeof Ze.return&&Ze.return()}),Ae.add(je.schedule(()=>{Ze=Ee[L.hZ](),Ae.add(je.schedule(function(){if(rt.closed)return;let Ve,He;try{const Ne=Ze.next();Ve=Ne.value,He=Ne.done}catch(Ne){return void rt.error(Ne)}He?rt.complete():(rt.next(Ve),this.schedule())}))})),Ae})}(Ee,je)}throw new TypeError((null!==Ee&&typeof Ee||Ee)+" is not observable")}(Ee,je):Ee instanceof d.y?Ee:new d.y((0,c.s)(Ee))}},3009:(_n,Ke,k)=>{"use strict";k.d(Ke,{n:()=>a});var d=k(2916),c=k(3650),V=k(6454);function a(O,A){return A?(0,V.r)(O,A):new d.y((0,c.V)(O))}},3753:(_n,Ke,k)=>{"use strict";k.d(Ke,{R:()=>A});var d=k(2916),c=k(6688),V=k(7043),a=k(4850);function A(z,G,te,ye){return(0,V.m)(te)&&(ye=te,te=void 0),ye?A(z,G,te).pipe((0,a.U)(me=>(0,c.k)(me)?ye(...me):ye(me))):new d.y(me=>{p(z,G,function Ee(je){me.next(arguments.length>1?Array.prototype.slice.call(arguments):je)},me,te)})}function p(z,G,te,ye,me){let Ee;if(function Z(z){return z&&"function"==typeof z.addEventListener&&"function"==typeof z.removeEventListener}(z)){const je=z;z.addEventListener(G,te,me),Ee=()=>je.removeEventListener(G,te,me)}else if(function Q(z){return z&&"function"==typeof z.on&&"function"==typeof z.off}(z)){const je=z;z.on(G,te),Ee=()=>je.off(G,te)}else if(function L(z){return z&&"function"==typeof z.addListener&&"function"==typeof z.removeListener}(z)){const je=z;z.addListener(G,te),Ee=()=>je.removeListener(G,te)}else{if(!z||!z.length)throw new TypeError("Invalid event target");for(let je=0,rt=z.length;je<rt;je++)p(z[je],G,te,ye,me)}ye.add(Ee)}},1086:(_n,Ke,k)=>{"use strict";k.d(Ke,{of:()=>a});var d=k(2866),c=k(3009),V=k(6454);function a(...O){let A=O[O.length-1];return(0,d.K)(A)?(O.pop(),(0,V.r)(O,A)):(0,c.n)(O)}},1406:(_n,Ke,k)=>{"use strict";k.d(Ke,{b:()=>c});var d=k(1709);function c(V,a){return(0,d.zg)(V,a,1)}},2198:(_n,Ke,k)=>{"use strict";k.d(Ke,{h:()=>c});var d=k(3489);function c(O,A){return function(L){return L.lift(new V(O,A))}}class V{constructor(A,p){this.predicate=A,this.thisArg=p}call(A,p){return p.subscribe(new a(A,this.predicate,this.thisArg))}}class a extends d.L{constructor(A,p,L){super(A),this.predicate=p,this.thisArg=L,this.count=0}_next(A){let p;try{p=this.predicate.call(this.thisArg,A,this.count++)}catch(L){return void this.destination.error(L)}p&&this.destination.next(A)}}},4850:(_n,Ke,k)=>{"use strict";k.d(Ke,{U:()=>c});var d=k(3489);function c(O,A){return function(L){if("function"!=typeof O)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return L.lift(new V(O,A))}}class V{constructor(A,p){this.project=A,this.thisArg=p}call(A,p){return p.subscribe(new a(A,this.project,this.thisArg))}}class a extends d.L{constructor(A,p,L){super(A),this.project=p,this.count=0,this.thisArg=L||this}_next(A){let p;try{p=this.project.call(this.thisArg,A,this.count++)}catch(L){return void this.destination.error(L)}this.destination.next(p)}}},9146:(_n,Ke,k)=>{"use strict";k.d(Ke,{J:()=>V});var d=k(1709),c=k(5379);function V(a=Number.POSITIVE_INFINITY){return(0,d.zg)(c.y,a)}},1709:(_n,Ke,k)=>{"use strict";k.d(Ke,{zg:()=>a});var d=k(4850),c=k(5254),V=k(1177);function a(L,Q,Z=Number.POSITIVE_INFINITY){return"function"==typeof Q?z=>z.pipe(a((G,te)=>(0,c.D)(L(G,te)).pipe((0,d.U)((ye,me)=>Q(G,ye,te,me))),Z)):("number"==typeof Q&&(Z=Q),z=>z.lift(new O(L,Z)))}class O{constructor(Q,Z=Number.POSITIVE_INFINITY){this.project=Q,this.concurrent=Z}call(Q,Z){return Z.subscribe(new A(Q,this.project,this.concurrent))}}class A extends V.Ds{constructor(Q,Z,z=Number.POSITIVE_INFINITY){super(Q),this.project=Z,this.concurrent=z,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(Q){this.active<this.concurrent?this._tryNext(Q):this.buffer.push(Q)}_tryNext(Q){let Z;const z=this.index++;try{Z=this.project(Q,z)}catch(G){return void this.destination.error(G)}this.active++,this._innerSub(Z)}_innerSub(Q){const Z=new V.IY(this),z=this.destination;z.add(Z);const G=(0,V.ft)(Q,Z);G!==Z&&z.add(G)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(Q){this.destination.next(Q)}notifyComplete(){const Q=this.buffer;this.active--,Q.length>0?this._next(Q.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},4327:(_n,Ke,k)=>{"use strict";k.d(Ke,{x:()=>c});var d=k(3489);function c(){return function(A){return A.lift(new V(A))}}class V{constructor(A){this.connectable=A}call(A,p){const{connectable:L}=this;L._refCount++;const Q=new a(A,L),Z=p.subscribe(Q);return Q.closed||(Q.connection=L.connect()),Z}}class a extends d.L{constructor(A,p){super(A),this.connectable=p}_unsubscribe(){const{connectable:A}=this;if(!A)return void(this.connection=null);this.connectable=null;const p=A._refCount;if(p<=0)return void(this.connection=null);if(A._refCount=p-1,p>1)return void(this.connection=null);const{connection:L}=this,Q=A._connection;this.connection=null,Q&&(!L||Q===L)&&Q.unsubscribe()}}},7545:(_n,Ke,k)=>{"use strict";k.d(Ke,{w:()=>a});var d=k(4850),c=k(5254),V=k(1177);function a(p,L){return"function"==typeof L?Q=>Q.pipe(a((Z,z)=>(0,c.D)(p(Z,z)).pipe((0,d.U)((G,te)=>L(Z,G,z,te))))):Q=>Q.lift(new O(p))}class O{constructor(L){this.project=L}call(L,Q){return Q.subscribe(new A(L,this.project))}}class A extends V.Ds{constructor(L,Q){super(L),this.project=Q,this.index=0}_next(L){let Q;const Z=this.index++;try{Q=this.project(L,Z)}catch(z){return void this.destination.error(z)}this._innerSub(Q)}_innerSub(L){const Q=this.innerSubscription;Q&&Q.unsubscribe();const Z=new V.IY(this),z=this.destination;z.add(Z),this.innerSubscription=(0,V.ft)(L,Z),this.innerSubscription!==Z&&z.add(this.innerSubscription)}_complete(){const{innerSubscription:L}=this;(!L||L.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(L){this.destination.next(L)}}},2986:(_n,Ke,k)=>{"use strict";k.d(Ke,{q:()=>a});var d=k(3489),c=k(4231),V=k(8896);function a(p){return L=>0===p?(0,V.c)():L.lift(new O(p))}class O{constructor(L){if(this.total=L,this.total<0)throw new c.W}call(L,Q){return Q.subscribe(new A(L,this.total))}}class A extends d.L{constructor(L,Q){super(L),this.total=Q,this.count=0}_next(L){const Q=this.total,Z=++this.count;Z<=Q&&(this.destination.next(L),Z===Q&&(this.destination.complete(),this.unsubscribe()))}}},6454:(_n,Ke,k)=>{"use strict";k.d(Ke,{r:()=>V});var d=k(2916),c=k(2654);function V(a,O){return new d.y(A=>{const p=new c.w;let L=0;return p.add(O.schedule(function(){L!==a.length?(A.next(a[L++]),A.closed||p.add(this.schedule())):A.complete()})),p})}},6686:(_n,Ke,k)=>{"use strict";k.d(Ke,{o:()=>V});var d=k(2654);class c extends d.w{constructor(O,A){super()}schedule(O,A=0){return this}}class V extends c{constructor(O,A){super(O,A),this.scheduler=O,this.work=A,this.pending=!1}schedule(O,A=0){if(this.closed)return this;this.state=O;const p=this.id,L=this.scheduler;return null!=p&&(this.id=this.recycleAsyncId(L,p,A)),this.pending=!0,this.delay=A,this.id=this.id||this.requestAsyncId(L,this.id,A),this}requestAsyncId(O,A,p=0){return setInterval(O.flush.bind(O,this),p)}recycleAsyncId(O,A,p=0){if(null!==p&&this.delay===p&&!1===this.pending)return A;clearInterval(A)}execute(O,A){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const p=this._execute(O,A);if(p)return p;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(O,A){let L,p=!1;try{this.work(O)}catch(Q){p=!0,L=!!Q&&Q||new Error(Q)}if(p)return this.unsubscribe(),L}_unsubscribe(){const O=this.id,A=this.scheduler,p=A.actions,L=p.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==L&&p.splice(L,1),null!=O&&(this.id=this.recycleAsyncId(A,O,null)),this.delay=null}}},2268:(_n,Ke,k)=>{"use strict";k.d(Ke,{v:()=>c});let d=(()=>{class V{constructor(O,A=V.now){this.SchedulerAction=O,this.now=A}schedule(O,A=0,p){return new this.SchedulerAction(this,O).schedule(p,A)}}return V.now=()=>Date.now(),V})();class c extends d{constructor(a,O=d.now){super(a,()=>c.delegate&&c.delegate!==this?c.delegate.now():O()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(a,O=0,A){return c.delegate&&c.delegate!==this?c.delegate.schedule(a,O,A):super.schedule(a,O,A)}flush(a){const{actions:O}=this;if(this.active)return void O.push(a);let A;this.active=!0;do{if(A=a.execute(a.state,a.delay))break}while(a=O.shift());if(this.active=!1,A){for(;a=O.shift();)a.unsubscribe();throw A}}}},5430:(_n,Ke,k)=>{"use strict";k.d(Ke,{hZ:()=>c});const c=function d(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},3821:(_n,Ke,k)=>{"use strict";k.d(Ke,{L:()=>d});const d="function"==typeof Symbol&&Symbol.observable||"@@observable"},7668:(_n,Ke,k)=>{"use strict";k.d(Ke,{b:()=>d});const d="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()},4231:(_n,Ke,k)=>{"use strict";k.d(Ke,{W:()=>c});const c=(()=>{function V(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return V.prototype=Object.create(Error.prototype),V})()},5279:(_n,Ke,k)=>{"use strict";k.d(Ke,{N:()=>c});const c=(()=>{function V(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return V.prototype=Object.create(Error.prototype),V})()},2782:(_n,Ke,k)=>{"use strict";function d(c){setTimeout(()=>{throw c},0)}k.d(Ke,{z:()=>d})},5379:(_n,Ke,k)=>{"use strict";function d(c){return c}k.d(Ke,{y:()=>d})},6688:(_n,Ke,k)=>{"use strict";k.d(Ke,{k:()=>d});const d=Array.isArray||(c=>c&&"number"==typeof c.length)},8515:(_n,Ke,k)=>{"use strict";k.d(Ke,{z:()=>d});const d=c=>c&&"number"==typeof c.length&&"function"!=typeof c},7043:(_n,Ke,k)=>{"use strict";function d(c){return"function"==typeof c}k.d(Ke,{m:()=>d})},7830:(_n,Ke,k)=>{"use strict";function d(c){return null!==c&&"object"==typeof c}k.d(Ke,{K:()=>d})},8955:(_n,Ke,k)=>{"use strict";function d(c){return!!c&&"function"!=typeof c.subscribe&&"function"==typeof c.then}k.d(Ke,{t:()=>d})},2866:(_n,Ke,k)=>{"use strict";function d(c){return c&&"function"==typeof c.schedule}k.d(Ke,{K:()=>d})},9249:(_n,Ke,k)=>{"use strict";k.d(Ke,{s:()=>z});var d=k(3650),c=k(2782),a=k(5430),A=k(3821),L=k(8515),Q=k(8955),Z=k(7830);const z=G=>{if(G&&"function"==typeof G[A.L])return(G=>te=>{const ye=G[A.L]();if("function"!=typeof ye.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return ye.subscribe(te)})(G);if((0,L.z)(G))return(0,d.V)(G);if((0,Q.t)(G))return(G=>te=>(G.then(ye=>{te.closed||(te.next(ye),te.complete())},ye=>te.error(ye)).then(null,c.z),te))(G);if(G&&"function"==typeof G[a.hZ])return(G=>te=>{const ye=G[a.hZ]();for(;;){let me;try{me=ye.next()}catch(Ee){return te.error(Ee),te}if(me.done){te.complete();break}if(te.next(me.value),te.closed)break}return"function"==typeof ye.return&&te.add(()=>{ye.return&&ye.return()}),te})(G);{const ye=`You provided ${(0,Z.K)(G)?"an invalid object":`'${G}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(ye)}}},3650:(_n,Ke,k)=>{"use strict";k.d(Ke,{V:()=>d});const d=c=>V=>{for(let a=0,O=c.length;a<O&&!V.closed;a++)V.next(c[a]);V.complete()}},3760:function(_n,Ke,k){"use strict";var a,d=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,A){O.__proto__=A}||function(O,A){for(var p in A)A.hasOwnProperty(p)&&(O[p]=A[p])},function(O,A){function p(){this.constructor=O}a(O,A),O.prototype=null===A?Object.create(A):(p.prototype=A.prototype,new p)});Object.defineProperty(Ke,"__esModule",{value:!0});var V=function(a){function O(){return null!==a&&a.apply(this,arguments)||this}return d(O,a),O}(k(1206).default);Ke.default=V},1206:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=k(643),V=function(){function a(O){this.root=null,this.compare=O||d.defaultCompare,this.nElements=0}return a.prototype.add=function(O){return!d.isUndefined(O)&&null!==this.insertNode(this.createNode(O))&&(this.nElements++,!0)},a.prototype.clear=function(){this.root=null,this.nElements=0},a.prototype.isEmpty=function(){return 0===this.nElements},a.prototype.size=function(){return this.nElements},a.prototype.contains=function(O){return!d.isUndefined(O)&&null!==this.searchNode(this.root,O)},a.prototype.search=function(O){var A=this.searchNode(this.root,O);if(null!==A)return A.element},a.prototype.remove=function(O){var A=this.searchNode(this.root,O);return null!==A&&(this.removeNode(A),this.nElements--,!0)},a.prototype.inorderTraversal=function(O){this.inorderTraversalAux(this.root,O,{stop:!1})},a.prototype.preorderTraversal=function(O){this.preorderTraversalAux(this.root,O,{stop:!1})},a.prototype.postorderTraversal=function(O){this.postorderTraversalAux(this.root,O,{stop:!1})},a.prototype.levelTraversal=function(O){this.levelTraversalAux(this.root,O)},a.prototype.minimum=function(){if(!this.isEmpty()&&null!==this.root)return this.minimumAux(this.root).element},a.prototype.maximum=function(){if(!this.isEmpty()&&null!==this.root)return this.maximumAux(this.root).element},a.prototype.forEach=function(O){this.inorderTraversal(O)},a.prototype.toArray=function(){var O=[];return this.inorderTraversal(function(A){return O.push(A),!0}),O},a.prototype.height=function(){return this.heightAux(this.root)},a.prototype.searchNode=function(O,A){for(var p=1;null!==O&&0!==p;)(p=this.compare(A,O.element))<0?O=O.leftCh:p>0&&(O=O.rightCh);return O},a.prototype.transplant=function(O,A){null===O.parent?this.root=A:O===O.parent.leftCh?O.parent.leftCh=A:O.parent.rightCh=A,null!==A&&(A.parent=O.parent)},a.prototype.removeNode=function(O){if(null===O.leftCh)this.transplant(O,O.rightCh);else if(null===O.rightCh)this.transplant(O,O.leftCh);else{var A=this.minimumAux(O.rightCh);A.parent!==O&&(this.transplant(A,A.rightCh),A.rightCh=O.rightCh,A.rightCh.parent=A),this.transplant(O,A),A.leftCh=O.leftCh,A.leftCh.parent=A}},a.prototype.inorderTraversalAux=function(O,A,p){null===O||p.stop||(this.inorderTraversalAux(O.leftCh,A,p),!p.stop&&(p.stop=!1===A(O.element),!p.stop&&this.inorderTraversalAux(O.rightCh,A,p)))},a.prototype.levelTraversalAux=function(O,A){var p=new c.default;for(null!==O&&p.enqueue(O),O=p.dequeue()||null;null!=O;){if(!1===A(O.element))return;null!==O.leftCh&&p.enqueue(O.leftCh),null!==O.rightCh&&p.enqueue(O.rightCh),O=p.dequeue()||null}},a.prototype.preorderTraversalAux=function(O,A,p){null===O||p.stop||(p.stop=!1===A(O.element),!p.stop&&(this.preorderTraversalAux(O.leftCh,A,p),!p.stop&&this.preorderTraversalAux(O.rightCh,A,p)))},a.prototype.postorderTraversalAux=function(O,A,p){null===O||p.stop||(this.postorderTraversalAux(O.leftCh,A,p),!p.stop&&(this.postorderTraversalAux(O.rightCh,A,p),!p.stop&&(p.stop=!1===A(O.element))))},a.prototype.minimumAux=function(O){for(;null!=O&&null!==O.leftCh;)O=O.leftCh;return O},a.prototype.maximumAux=function(O){for(;null!=O&&null!==O.rightCh;)O=O.rightCh;return O},a.prototype.heightAux=function(O){return null===O?-1:Math.max(this.heightAux(O.leftCh),this.heightAux(O.rightCh))+1},a.prototype.insertNode=function(O){for(var A=null,p=this.root;null!==p;){var L=this.compare(O.element,p.element);if(0===L)return null;L<0?(A=p,p=p.leftCh):(A=p,p=p.rightCh)}return O.parent=A,null===A?this.root=O:this.compare(O.element,A.element)<0?A.leftCh=O:A.rightCh=O,O},a.prototype.createNode=function(O){return{element:O,leftCh:null,rightCh:null,parent:null}},a}();Ke.default=V},4577:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=k(9166),V=k(7299),a=function(){function O(A){this.toStrF=A||d.defaultToString,this.dictionary=new c.default(this.toStrF),this.nElements=0}return O.prototype.add=function(A,p){return void 0===p&&(p=1),!(d.isUndefined(A)||p<=0)&&(this.contains(A)?this.dictionary.getValue(A).copies+=p:this.dictionary.setValue(A,{value:A,copies:p}),this.nElements+=p,!0)},O.prototype.count=function(A){return this.contains(A)?this.dictionary.getValue(A).copies:0},O.prototype.contains=function(A){return this.dictionary.containsKey(A)},O.prototype.remove=function(A,p){if(void 0===p&&(p=1),d.isUndefined(A)||p<=0)return!1;if(this.contains(A)){var L=this.dictionary.getValue(A);return this.nElements-=p>L.copies?L.copies:p,L.copies-=p,L.copies<=0&&this.dictionary.remove(A),!0}return!1},O.prototype.toArray=function(){for(var A=[],L=0,Q=this.dictionary.values();L<Q.length;L++)for(var Z=Q[L],z=Z.value,G=Z.copies,te=0;te<G;te++)A.push(z);return A},O.prototype.toSet=function(){for(var A=new V.default(this.toStrF),L=0,Q=this.dictionary.values();L<Q.length;L++)A.add(Q[L].value);return A},O.prototype.forEach=function(A){this.dictionary.forEach(function(p,L){for(var Q=L.value,Z=L.copies,z=0;z<Z;z++)if(!1===A(Q))return!1;return!0})},O.prototype.size=function(){return this.nElements},O.prototype.isEmpty=function(){return 0===this.nElements},O.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},O}();Ke.default=a},9166:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=function(){function V(a){this.table={},this.nElements=0,this.toStr=a||d.defaultToString}return V.prototype.getValue=function(a){var O=this.table["$"+this.toStr(a)];if(!d.isUndefined(O))return O.value},V.prototype.setValue=function(a,O){if(!d.isUndefined(a)&&!d.isUndefined(O)){var A,p="$"+this.toStr(a),L=this.table[p];return d.isUndefined(L)?(this.nElements++,A=void 0):A=L.value,this.table[p]={key:a,value:O},A}},V.prototype.remove=function(a){var O="$"+this.toStr(a),A=this.table[O];if(!d.isUndefined(A))return delete this.table[O],this.nElements--,A.value},V.prototype.keys=function(){var a=[];for(var O in this.table)d.has(this.table,O)&&a.push(this.table[O].key);return a},V.prototype.values=function(){var a=[];for(var O in this.table)d.has(this.table,O)&&a.push(this.table[O].value);return a},V.prototype.forEach=function(a){for(var O in this.table)if(d.has(this.table,O)){var A=this.table[O];if(!1===a(A.key,A.value))return}},V.prototype.containsKey=function(a){return!d.isUndefined(this.getValue(a))},V.prototype.clear=function(){this.table={},this.nElements=0},V.prototype.size=function(){return this.nElements},V.prototype.isEmpty=function(){return this.nElements<=0},V.prototype.toString=function(){var a="{";return this.forEach(function(O,A){a+="\n\t"+O+" : "+A}),a+"\n}"},V}();Ke.default=c},7008:function(_n,Ke,k){"use strict";var O,d=this&&this.__extends||(O=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(A,p){A.__proto__=p}||function(A,p){for(var L in p)p.hasOwnProperty(L)&&(A[L]=p[L])},function(A,p){function L(){this.constructor=A}O(A,p),A.prototype=null===p?Object.create(p):(L.prototype=p.prototype,new L)});Object.defineProperty(Ke,"__esModule",{value:!0});var c=k(9166),V=k(3762),a=function(O){function A(p,L){var Q=O.call(this,L)||this;return Q.defaultFactoryFunction=p,Q}return d(A,O),A.prototype.setDefault=function(p,L){var Q=O.prototype.getValue.call(this,p);return V.isUndefined(Q)?(this.setValue(p,L),L):Q},A.prototype.getValue=function(p){return this.setDefault(p,this.defaultFactoryFunction())},A}(c.default);Ke.default=a},4876:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=k(9630),V=function(){function a(O){this.data=[],this.compare=O||d.defaultCompare}return a.prototype.leftChildIndex=function(O){return 2*O+1},a.prototype.rightChildIndex=function(O){return 2*O+2},a.prototype.parentIndex=function(O){return Math.floor((O-1)/2)},a.prototype.minIndex=function(O,A){return A>=this.data.length?O>=this.data.length?-1:O:this.compare(this.data[O],this.data[A])<=0?O:A},a.prototype.siftUp=function(O){for(var A=this.parentIndex(O);O>0&&this.compare(this.data[A],this.data[O])>0;)c.swap(this.data,A,O),A=this.parentIndex(O=A)},a.prototype.siftDown=function(O){for(var A=this.minIndex(this.leftChildIndex(O),this.rightChildIndex(O));A>=0&&this.compare(this.data[O],this.data[A])>0;)c.swap(this.data,A,O),A=this.minIndex(this.leftChildIndex(O=A),this.rightChildIndex(O))},a.prototype.peek=function(){if(this.data.length>0)return this.data[0]},a.prototype.add=function(O){return!d.isUndefined(O)&&(this.data.push(O),this.siftUp(this.data.length-1),!0)},a.prototype.removeRoot=function(){if(this.data.length>0){var O=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),O}},a.prototype.contains=function(O){var A=d.compareToEquals(this.compare);return c.contains(this.data,O,A)},a.prototype.size=function(){return this.data.length},a.prototype.isEmpty=function(){return this.data.length<=0},a.prototype.clear=function(){this.data.length=0},a.prototype.forEach=function(O){c.forEach(this.data,O)},a}();Ke.default=V},3332:function(_n,Ke,k){"use strict";var L,d=this&&this.__extends||(L=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(Q,Z){Q.__proto__=Z}||function(Q,Z){for(var z in Z)Z.hasOwnProperty(z)&&(Q[z]=Z[z])},function(Q,Z){function z(){this.constructor=Q}L(Q,Z),Q.prototype=null===Z?Object.create(Z):(z.prototype=Z.prototype,new z)});Object.defineProperty(Ke,"__esModule",{value:!0});var c=k(9166),V=k(3762),a=function(){function L(Q,Z){this.key=Q,this.value=Z}return L.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},L}(),O=function(){function L(){this.key=null,this.value=null}return L.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},L}();function A(L){return!L.next}var p=function(L){function Q(Z){var z=L.call(this,Z)||this;return z.head=new O,z.tail=new O,z.head.next=z.tail,z.tail.prev=z.head,z}return d(Q,L),Q.prototype.appendToTail=function(Z){var z=this.tail.prev;z.next=Z,Z.prev=z,Z.next=this.tail,this.tail.prev=Z},Q.prototype.getLinkedDictionaryPair=function(Z){if(!V.isUndefined(Z)){var z="$"+this.toStr(Z);return this.table[z]}},Q.prototype.getValue=function(Z){var z=this.getLinkedDictionaryPair(Z);if(!V.isUndefined(z))return z.value},Q.prototype.remove=function(Z){var z=this.getLinkedDictionaryPair(Z);if(!V.isUndefined(z))return L.prototype.remove.call(this,Z),z.unlink(),z.value},Q.prototype.clear=function(){L.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head},Q.prototype.replace=function(Z,z){var G="$"+this.toStr(z.key);z.next=Z.next,z.prev=Z.prev,this.remove(Z.key),z.prev.next=z,z.next.prev=z,this.table[G]=z,++this.nElements},Q.prototype.setValue=function(Z,z){if(!V.isUndefined(Z)&&!V.isUndefined(z)){var G=this.getLinkedDictionaryPair(Z),te=new a(Z,z),ye="$"+this.toStr(Z);return V.isUndefined(G)?(this.appendToTail(te),this.table[ye]=te,void++this.nElements):(this.replace(G,te),G.value)}},Q.prototype.keys=function(){var Z=[];return this.forEach(function(z,G){Z.push(z)}),Z},Q.prototype.values=function(){var Z=[];return this.forEach(function(z,G){Z.push(G)}),Z},Q.prototype.forEach=function(Z){for(var z=this.head.next;!A(z);){if(!1===Z(z.key,z.value))return;z=z.next}},Q}(c.default);Ke.default=p},6319:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=k(9630),V=function(){function a(){this.firstNode=null,this.lastNode=null,this.nElements=0}return a.prototype.add=function(O,A){if(d.isUndefined(A)&&(A=this.nElements),A<0||A>this.nElements||d.isUndefined(O))return!1;var p=this.createNode(O);if(0===this.nElements||null===this.lastNode)this.firstNode=p,this.lastNode=p;else if(A===this.nElements)this.lastNode.next=p,this.lastNode=p;else if(0===A)p.next=this.firstNode,this.firstNode=p;else{var L=this.nodeAtIndex(A-1);if(null===L)return!1;p.next=L.next,L.next=p}return this.nElements++,!0},a.prototype.first=function(){if(null!==this.firstNode)return this.firstNode.element},a.prototype.last=function(){if(null!==this.lastNode)return this.lastNode.element},a.prototype.elementAtIndex=function(O){var A=this.nodeAtIndex(O);if(null!==A)return A.element},a.prototype.indexOf=function(O,A){var p=A||d.defaultEquals;if(d.isUndefined(O))return-1;for(var L=this.firstNode,Q=0;null!==L;){if(p(L.element,O))return Q;Q++,L=L.next}return-1},a.prototype.contains=function(O,A){return this.indexOf(O,A)>=0},a.prototype.remove=function(O,A){var p=A||d.defaultEquals;if(this.nElements<1||d.isUndefined(O))return!1;for(var L=null,Q=this.firstNode;null!==Q;){if(p(Q.element,O))return null===L?(this.firstNode=Q.next,Q===this.lastNode&&(this.lastNode=null)):Q===this.lastNode?(this.lastNode=L,L.next=Q.next,Q.next=null):(L.next=Q.next,Q.next=null),this.nElements--,!0;L=Q,Q=Q.next}return!1},a.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},a.prototype.equals=function(O,A){var p=A||d.defaultEquals;return O instanceof a&&this.size()===O.size()&&this.equalsAux(this.firstNode,O.firstNode,p)},a.prototype.equalsAux=function(O,A,p){for(;null!==O&&null!==A;){if(!p(O.element,A.element))return!1;O=O.next,A=A.next}return!0},a.prototype.removeElementAtIndex=function(O){if(!(O<0||O>=this.nElements||null===this.firstNode||null===this.lastNode)){var A;if(1===this.nElements)A=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var p=this.nodeAtIndex(O-1);null===p?(A=this.firstNode.element,this.firstNode=this.firstNode.next):p.next===this.lastNode&&(A=this.lastNode.element,this.lastNode=p),null!==p&&null!==p.next&&(A=p.next.element,p.next=p.next.next)}return this.nElements--,A}},a.prototype.forEach=function(O){for(var A=this.firstNode;null!==A&&!1!==O(A.element);)A=A.next},a.prototype.reverse=function(){for(var O=null,A=this.firstNode,p=null;null!==A;)p=A.next,A.next=O,O=A,A=p;p=this.firstNode,this.firstNode=this.lastNode,this.lastNode=p},a.prototype.toArray=function(){for(var O=[],A=this.firstNode;null!==A;)O.push(A.element),A=A.next;return O},a.prototype.size=function(){return this.nElements},a.prototype.isEmpty=function(){return this.nElements<=0},a.prototype.toString=function(){return c.toString(this.toArray())},a.prototype.nodeAtIndex=function(O){if(O<0||O>=this.nElements)return null;if(O===this.nElements-1)return this.lastNode;for(var A=this.firstNode,p=0;p<O&&null!==A;p++)A=A.next;return A},a.prototype.createNode=function(O){return{element:O,next:null}},a}();Ke.default=V},7730:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=k(9166),V=k(9630),a=function(){function O(A,p,L){void 0===L&&(L=!1),this.dict=new c.default(A),this.equalsF=p||d.defaultEquals,this.allowDuplicate=L}return O.prototype.getValue=function(A){var p=this.dict.getValue(A);return d.isUndefined(p)?[]:V.copy(p)},O.prototype.setValue=function(A,p){if(d.isUndefined(A)||d.isUndefined(p))return!1;var L=this.dict.getValue(A);return d.isUndefined(L)?(this.dict.setValue(A,[p]),!0):!(!this.allowDuplicate&&V.contains(L,p,this.equalsF)||(L.push(p),0))},O.prototype.remove=function(A,p){if(d.isUndefined(p)){var L=this.dict.remove(A);return!d.isUndefined(L)}var Q=this.dict.getValue(A);return!(d.isUndefined(Q)||!V.remove(Q,p,this.equalsF)||(0===Q.length&&this.dict.remove(A),0))},O.prototype.keys=function(){return this.dict.keys()},O.prototype.values=function(){for(var p=[],L=0,Q=this.dict.values();L<Q.length;L++)for(var z=0,G=Q[L];z<G.length;z++)p.push(G[z]);return p},O.prototype.containsKey=function(A){return this.dict.containsKey(A)},O.prototype.clear=function(){this.dict.clear()},O.prototype.size=function(){return this.dict.size()},O.prototype.isEmpty=function(){return this.dict.isEmpty()},O}();Ke.default=a},3417:(_n,Ke)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var k=(()=>{return(c=k||(k={}))[c.BEFORE=0]="BEFORE",c[c.AFTER=1]="AFTER",c[c.INSIDE_AT_END=2]="INSIDE_AT_END",c[c.INSIDE_AT_START=3]="INSIDE_AT_START",k;var c})(),d=function(){function c(V,a){void 0===V&&(V=[]),void 0===a&&(a={}),this.rootIds=V,this.nodes=a,this.initRootIds(),this.initNodes()}return c.prototype.initRootIds=function(){for(var V=0,a=this.rootIds;V<a.length;V++)this.createEmptyNodeIfNotExist(a[V])},c.prototype.initNodes=function(){for(var V in this.nodes)if(this.nodes.hasOwnProperty(V))for(var a=0,O=this.nodes[V];a<O.length;a++)this.createEmptyNodeIfNotExist(O[a])},c.prototype.createEmptyNodeIfNotExist=function(V){this.nodes[V]||(this.nodes[V]=[])},c.prototype.getRootIds=function(){return this.rootIds.slice()},c.prototype.getNodes=function(){var V={};for(var a in this.nodes)this.nodes.hasOwnProperty(a)&&(V[a]=this.nodes[a].slice());return V},c.prototype.getObject=function(){return{rootIds:this.getRootIds(),nodes:this.getNodes()}},c.prototype.toObject=function(){return this.getObject()},c.prototype.flatten=function(){for(var V=this,a=[],O=0;O<this.rootIds.length;O++){var A=this.rootIds[O];a.push({id:A,level:0,hasParent:!1,childrenCount:0}),z(A,this.nodes,a,0)}for(var p=0,L=a;p<L.length;p++){var Q=L[p];Q.childrenCount=V.nodes[G=Q.id]?V.nodes[G].length:0}var G;return a;function z(G,te,ye,me){if(void 0===me&&(me=0),G&&te&&ye&&te[G]){me++;for(var Ee=te[G],je=0;je<Ee.length;je++){var rt=Ee[je];ye.push({id:rt,level:me,hasParent:!0}),z(rt,te,ye,me)}me--}}},c.prototype.moveIdBeforeId=function(V,a){return this.moveId(V,a,k.BEFORE)},c.prototype.moveIdAfterId=function(V,a){return this.moveId(V,a,k.AFTER)},c.prototype.moveIdIntoId=function(V,a,O){return void 0===O&&(O=!0),this.moveId(V,a,O?k.INSIDE_AT_START:k.INSIDE_AT_END)},c.prototype.swapRootIdWithRootId=function(V,a){var O=this.findRootId(V),A=this.findRootId(a);this.swapRootPositionWithRootPosition(O,A)},c.prototype.swapRootPositionWithRootPosition=function(V,a){var O=this.rootIds[a];this.rootIds[a]=this.rootIds[V],this.rootIds[V]=O},c.prototype.deleteId=function(V){this.rootDeleteId(V),this.nodeAndSubNodesDelete(V),this.nodeRefrencesDelete(V)},c.prototype.insertIdBeforeId=function(V,a){var O=this.findRootId(V);for(var A in O>-1&&this.insertIdIntoRoot(a,O),this.nodes)if(this.nodes.hasOwnProperty(A)){var p=this.findNodeId(A,V);p>-1&&this.insertIdIntoNode(A,a,p)}},c.prototype.insertIdAfterId=function(V,a){var O=this.findRootId(V);for(var A in O>-1&&this.insertIdIntoRoot(a,O+1),this.nodes)if(this.nodes.hasOwnProperty(A)){var p=this.findNodeId(A,V);p>-1&&this.insertIdIntoNode(A,a,p+1)}},c.prototype.insertIdIntoId=function(V,a){this.nodeInsertAtEnd(V,a),this.nodes[a]=[]},c.prototype.insertIdIntoRoot=function(V,a){void 0===a?this.rootInsertAtEnd(V):this.rootIds.splice(a<0?a+this.rootIds.length+1:a,0,V),this.nodes[V]=this.nodes[V]||[]},c.prototype.insertIdIntoNode=function(V,a,O){this.nodes[V]=this.nodes[V]||[],this.nodes[a]=this.nodes[a]||[],void 0===O?this.nodeInsertAtEnd(V,a):this.nodes[V].splice(O<0?O+this.nodes[V].length+1:O,0,a)},c.prototype.moveId=function(V,a,O){var A=V,p=this.findRootId(A);for(var Z in this.nodes)if(this.nodes.hasOwnProperty(Z)){this.findNodeId(Z,a);break}var z=a,G=this.findRootId(z);for(var Z in this.nodes)if(this.nodes.hasOwnProperty(Z)){this.findNodeId(Z,a);break}if(p>-1){if(G>-1)switch(this.rootDelete(p),G>p&&G--,O){case k.BEFORE:this.insertIdIntoRoot(A,G);break;case k.AFTER:this.insertIdIntoRoot(A,G+1);break;case k.INSIDE_AT_START:this.nodeInsertAtStart(z,A);break;case k.INSIDE_AT_END:this.nodeInsertAtEnd(z,A)}else for(var Z in this.rootDelete(p),this.nodes)if(this.nodes.hasOwnProperty(Z)&&(me=this.findNodeId(Z,z))>-1){switch(O){case k.BEFORE:this.insertIdIntoNode(Z,A,me);break;case k.AFTER:this.insertIdIntoNode(Z,A,me+1);break;case k.INSIDE_AT_START:this.nodeInsertAtStart(z,A);break;case k.INSIDE_AT_END:this.nodeInsertAtEnd(z,A)}break}}else if(G>-1){for(var Z in this.nodes)if(this.nodes.hasOwnProperty(Z)&&(me=this.findNodeId(Z,A))>-1){this.nodeDeleteAtIndex(Z,me);break}switch(O){case k.BEFORE:this.insertIdIntoRoot(A,G);break;case k.AFTER:this.insertIdIntoRoot(A,G+1);break;case k.INSIDE_AT_START:this.nodeInsertAtStart(z,A);break;case k.INSIDE_AT_END:this.nodeInsertAtEnd(z,A)}}else{for(var Z in this.nodes)if(this.nodes.hasOwnProperty(Z)&&(me=this.findNodeId(Z,A))>-1){this.nodeDeleteAtIndex(Z,me);break}for(var Z in this.nodes)if(this.nodes.hasOwnProperty(Z)){var me;if((me=this.findNodeId(Z,z))>-1){switch(O){case k.BEFORE:this.insertIdIntoNode(Z,A,me);break;case k.AFTER:this.insertIdIntoNode(Z,A,me+1);break;case k.INSIDE_AT_START:this.nodeInsertAtStart(z,A);break;case k.INSIDE_AT_END:this.nodeInsertAtEnd(z,A)}break}}}},c.prototype.swapArrayElements=function(V,a,O){var A=V[a];return V[a]=V[O],V[O]=A,V},c.prototype.rootDeleteId=function(V){var a=this.findRootId(V);a>-1&&this.rootDelete(a)},c.prototype.nodeAndSubNodesDelete=function(V){for(var a=[],O=0;O<this.nodes[V].length;O++)this.nodeAndSubNodesDelete(this.nodes[V][O]),a.push(V);for(this.nodeDelete(V),O=0;O<a.length;O++)this.nodeDelete(a[O])},c.prototype.nodeRefrencesDelete=function(V){for(var a in this.nodes)if(this.nodes.hasOwnProperty(a))for(var O=0;O<this.nodes[a].length;O++)this.nodes[a][O]===V&&this.nodeDeleteAtIndex(a,O)},c.prototype.nodeDelete=function(V){delete this.nodes[V]},c.prototype.findRootId=function(V){return this.rootIds.indexOf(V)},c.prototype.findNodeId=function(V,a){return this.nodes[V].indexOf(a)},c.prototype.findNode=function(V){return this.nodes[V]},c.prototype.nodeInsertAtStart=function(V,a){this.nodes[V].unshift(a)},c.prototype.nodeInsertAtEnd=function(V,a){this.nodes[V].push(a)},c.prototype.rootDelete=function(V){this.rootIds.splice(V,1)},c.prototype.nodeDeleteAtIndex=function(V,a){this.nodes[V].splice(a,1)},c.prototype.rootInsertAtStart=function(V){this.rootIds.unshift(V)},c.prototype.rootInsertAtEnd=function(V){this.rootIds.push(V)},c}();Ke.default=d},8806:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=k(4876),V=function(){function a(O){this.heap=new c.default(d.reverseCompareFunction(O))}return a.prototype.enqueue=function(O){return this.heap.add(O)},a.prototype.add=function(O){return this.heap.add(O)},a.prototype.dequeue=function(){if(0!==this.heap.size()){var O=this.heap.peek();return this.heap.removeRoot(),O}},a.prototype.peek=function(){return this.heap.peek()},a.prototype.contains=function(O){return this.heap.contains(O)},a.prototype.isEmpty=function(){return this.heap.isEmpty()},a.prototype.size=function(){return this.heap.size()},a.prototype.clear=function(){this.heap.clear()},a.prototype.forEach=function(O){this.heap.forEach(O)},a}();Ke.default=V},643:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(6319),c=function(){function V(){this.list=new d.default}return V.prototype.enqueue=function(a){return this.list.add(a)},V.prototype.add=function(a){return this.list.add(a)},V.prototype.dequeue=function(){if(0!==this.list.size()){var a=this.list.first();return this.list.removeElementAtIndex(0),a}},V.prototype.peek=function(){if(0!==this.list.size())return this.list.first()},V.prototype.size=function(){return this.list.size()},V.prototype.contains=function(a,O){return this.list.contains(a,O)},V.prototype.isEmpty=function(){return this.list.size()<=0},V.prototype.clear=function(){this.list.clear()},V.prototype.forEach=function(a){this.list.forEach(a)},V}();Ke.default=c},7299:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762),c=k(9630),V=k(9166),a=function(){function O(A){this.dictionary=new V.default(A)}return O.prototype.contains=function(A){return this.dictionary.containsKey(A)},O.prototype.add=function(A){return!this.contains(A)&&!d.isUndefined(A)&&(this.dictionary.setValue(A,A),!0)},O.prototype.intersection=function(A){var p=this;this.forEach(function(L){return A.contains(L)||p.remove(L),!0})},O.prototype.union=function(A){var p=this;A.forEach(function(L){return p.add(L),!0})},O.prototype.difference=function(A){var p=this;A.forEach(function(L){return p.remove(L),!0})},O.prototype.isSubsetOf=function(A){if(this.size()>A.size())return!1;var p=!0;return this.forEach(function(L){return!!A.contains(L)||(p=!1,!1)}),p},O.prototype.remove=function(A){return!!this.contains(A)&&(this.dictionary.remove(A),!0)},O.prototype.forEach=function(A){this.dictionary.forEach(function(p,L){return A(L)})},O.prototype.toArray=function(){return this.dictionary.values()},O.prototype.isEmpty=function(){return this.dictionary.isEmpty()},O.prototype.size=function(){return this.dictionary.size()},O.prototype.clear=function(){this.dictionary.clear()},O.prototype.toString=function(){return c.toString(this.toArray())},O}();Ke.default=a},5095:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(6319),c=function(){function V(){this.list=new d.default}return V.prototype.push=function(a){return this.list.add(a,0)},V.prototype.add=function(a){return this.list.add(a,0)},V.prototype.pop=function(){return this.list.removeElementAtIndex(0)},V.prototype.peek=function(){return this.list.first()},V.prototype.size=function(){return this.list.size()},V.prototype.contains=function(a,O){return this.list.contains(a,O)},V.prototype.isEmpty=function(){return this.list.isEmpty()},V.prototype.clear=function(){this.list.clear()},V.prototype.forEach=function(a){this.list.forEach(a)},V}();Ke.default=c},9630:(_n,Ke,k)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var d=k(3762);function c(G,te,ye){for(var me=ye||d.defaultEquals,Ee=G.length,je=0;je<Ee;je++)if(me(G[je],te))return je;return-1}Ke.indexOf=c,Ke.lastIndexOf=function V(G,te,ye){for(var me=ye||d.defaultEquals,je=G.length-1;je>=0;je--)if(me(G[je],te))return je;return-1},Ke.contains=function a(G,te,ye){return c(G,te,ye)>=0},Ke.remove=function O(G,te,ye){var me=c(G,te,ye);return!(me<0||(G.splice(me,1),0))},Ke.frequency=function A(G,te,ye){for(var me=ye||d.defaultEquals,Ee=G.length,je=0,rt=0;rt<Ee;rt++)me(G[rt],te)&&je++;return je},Ke.equals=function p(G,te,ye){var me=ye||d.defaultEquals;if(G.length!==te.length)return!1;for(var Ee=G.length,je=0;je<Ee;je++)if(!me(G[je],te[je]))return!1;return!0},Ke.copy=function L(G){return G.concat()},Ke.swap=function Q(G,te,ye){if(te<0||te>=G.length||ye<0||ye>=G.length)return!1;var me=G[te];return G[te]=G[ye],G[ye]=me,!0},Ke.toString=function Z(G){return"["+G.toString()+"]"},Ke.forEach=function z(G,te){for(var ye=0,me=G;ye<me.length;ye++)if(!1===te(me[ye]))return}},2210:(_n,Ke,k)=>{"use strict";k(9630),k(4577),k(3760),k(1206);var A=k(9166);Ke.Xy=A.default,k(4876),k(3332),k(6319),k(7730),k(7008),k(7008),k(643),k(8806),k(7299),k(5095),k(3417),k(3762)},3762:(_n,Ke)=>{"use strict";Object.defineProperty(Ke,"__esModule",{value:!0});var k=Object.prototype.hasOwnProperty;function O(Z){return"function"==typeof Z}function A(Z){return void 0===Z}function p(Z){return"[object String]"===Object.prototype.toString.call(Z)}Ke.has=function(Z,z){return k.call(Z,z)},Ke.defaultCompare=function d(Z,z){return Z<z?-1:Z===z?0:1},Ke.defaultEquals=function c(Z,z){return Z===z},Ke.defaultToString=function V(Z){return null===Z?"COLLECTION_NULL":A(Z)?"COLLECTION_UNDEFINED":p(Z)?"$s"+Z:"$o"+Z.toString()},Ke.makeString=function a(Z,z){if(void 0===z&&(z=","),null===Z)return"COLLECTION_NULL";if(A(Z))return"COLLECTION_UNDEFINED";if(p(Z))return Z.toString();var G="{",te=!0;for(var ye in Z)Ke.has(Z,ye)&&(te?te=!1:G+=z,G=G+ye+":"+Z[ye]);return G+"}"},Ke.isFunction=O,Ke.isUndefined=A,Ke.isString=p,Ke.reverseCompareFunction=function L(Z){return A(Z)||!O(Z)?function(z,G){return z<G?1:z===G?0:-1}:function(z,G){return-1*Z(z,G)}},Ke.compareToEquals=function Q(Z){return function(z,G){return 0===Z(z,G)}}},863:(_n,Ke,k)=>{var d={"./ion-accordion_2.entry.js":[9654,8592,9654],"./ion-action-sheet.entry.js":[3648,3648],"./ion-alert.entry.js":[1118,1118],"./ion-app_8.entry.js":[53,53],"./ion-avatar_3.entry.js":[4753,4753],"./ion-back-button.entry.js":[2073,8592,2073],"./ion-backdrop.entry.js":[8939,8939],"./ion-breadcrumb_2.entry.js":[7544,8592,7544],"./ion-button_2.entry.js":[5652,5652],"./ion-card_5.entry.js":[5929,388],"./ion-checkbox.entry.js":[9922,9922],"./ion-chip.entry.js":[657,657],"./ion-col_3.entry.js":[9824,9824],"./ion-datetime_3.entry.js":[4959,8592,4959],"./ion-fab_3.entry.js":[5836,8592,5836],"./ion-img.entry.js":[1033,1033],"./ion-infinite-scroll_2.entry.js":[8034,8034],"./ion-input.entry.js":[1217,1217],"./ion-item-option_3.entry.js":[2933,2933],"./ion-item_8.entry.js":[4711,8592,4711],"./ion-loading.entry.js":[9434,9434],"./ion-menu_3.entry.js":[8136,8592,8136],"./ion-modal.entry.js":[2349,2349],"./ion-nav_2.entry.js":[5349,5349],"./ion-picker-column-internal.entry.js":[7602,7602],"./ion-picker-internal.entry.js":[9016,9016],"./ion-popover.entry.js":[3804,3804],"./ion-progress-bar.entry.js":[4174,4174],"./ion-radio_2.entry.js":[4432,4432],"./ion-range.entry.js":[3545,8592,1709],"./ion-refresher_2.entry.js":[3326,8592,3326],"./ion-reorder_2.entry.js":[3583,8592,3583],"./ion-ripple-effect.entry.js":[9958,9958],"./ion-route_4.entry.js":[4330,4330],"./ion-searchbar.entry.js":[8628,8592,8628],"./ion-segment_2.entry.js":[9325,8592,9325],"./ion-select_3.entry.js":[2773,2773],"./ion-slide_2.entry.js":[1650,1650],"./ion-spinner.entry.js":[4908,4908],"./ion-split-pane.entry.js":[9536,9536],"./ion-tab-bar_2.entry.js":[438,438],"./ion-tab_2.entry.js":[1536,1536],"./ion-text.entry.js":[4376,4376],"./ion-textarea.entry.js":[6560,6560],"./ion-toast.entry.js":[6120,6120],"./ion-toggle.entry.js":[5168,8592,5168],"./ion-virtual-scroll.entry.js":[2289,2289]};function c(V){if(!k.o(d,V))return Promise.resolve().then(()=>{var A=new Error("Cannot find module '"+V+"'");throw A.code="MODULE_NOT_FOUND",A});var a=d[V],O=a[0];return Promise.all(a.slice(1).map(k.e)).then(()=>k(O))}c.keys=()=>Object.keys(d),c.id=863,_n.exports=c},6099:(_n,Ke,k)=>{"use strict";function d(V,a,O,A,p,L,Q){try{var Z=V[L](Q),z=Z.value}catch(G){return void O(G)}Z.done?a(z):Promise.resolve(z).then(A,p)}function c(V){return function(){var a=this,O=arguments;return new Promise(function(A,p){var L=V.apply(a,O);function Q(z){d(L,A,p,Q,Z,"next",z)}function Z(z){d(L,A,p,Q,Z,"throw",z)}Q(void 0)})}}k.d(Ke,{Z:()=>c})},6895:(_n,Ke,k)=>{"use strict";k.d(Ke,{mr:()=>Ae,ez:()=>Dn,K0:()=>p,uU:()=>at,JJ:()=>ie,Do:()=>Ve,V_:()=>Z,Ye:()=>He,S$:()=>je,sg:()=>Lr,O5:()=>Se,tP:()=>Bt,b0:()=>Ze,lw:()=>L,EM:()=>nr,JF:()=>Wr,w_:()=>A,bD:()=>yn,q:()=>V,Mx:()=>Oi,HT:()=>O});var d=k(6738);let c=null;function V(){return c}function O(se){c||(c=se)}class A{}const p=new d.OlP("DocumentToken");let L=(()=>{class se{historyGo(ae){throw new Error("Not implemented")}}return se.\u0275fac=function(ae){return new(ae||se)},se.\u0275prov=d.Yz7({token:se,factory:function(){return function Q(){return(0,d.LFG)(z)}()},providedIn:"platform"}),se})();const Z=new d.OlP("Location Initialized");let z=(()=>{class se extends L{constructor(ae){super(),this._doc=ae,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return V().getBaseHref(this._doc)}onPopState(ae){const ze=V().getGlobalEventTarget(this._doc,"window");return ze.addEventListener("popstate",ae,!1),()=>ze.removeEventListener("popstate",ae)}onHashChange(ae){const ze=V().getGlobalEventTarget(this._doc,"window");return ze.addEventListener("hashchange",ae,!1),()=>ze.removeEventListener("hashchange",ae)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(ae){this.location.pathname=ae}pushState(ae,ze,St){G()?this._history.pushState(ae,ze,St):this.location.hash=St}replaceState(ae,ze,St){G()?this._history.replaceState(ae,ze,St):this.location.hash=St}forward(){this._history.forward()}back(){this._history.back()}historyGo(ae=0){this._history.go(ae)}getState(){return this._history.state}}return se.\u0275fac=function(ae){return new(ae||se)(d.LFG(p))},se.\u0275prov=d.Yz7({token:se,factory:function(){return function te(){return new z((0,d.LFG)(p))}()},providedIn:"platform"}),se})();function G(){return!!window.history.pushState}function ye(se,Ce){if(0==se.length)return Ce;if(0==Ce.length)return se;let ae=0;return se.endsWith("/")&&ae++,Ce.startsWith("/")&&ae++,2==ae?se+Ce.substring(1):1==ae?se+Ce:se+"/"+Ce}function me(se){const Ce=se.match(/#|\?|$/),ae=Ce&&Ce.index||se.length;return se.slice(0,ae-("/"===se[ae-1]?1:0))+se.slice(ae)}function Ee(se){return se&&"?"!==se[0]?"?"+se:se}let je=(()=>{class se{historyGo(ae){throw new Error("Not implemented")}}return se.\u0275fac=function(ae){return new(ae||se)},se.\u0275prov=d.Yz7({token:se,factory:function(){return function rt(se){const Ce=(0,d.LFG)(p).location;return new Ze((0,d.LFG)(L),Ce&&Ce.origin||"")}()},providedIn:"root"}),se})();const Ae=new d.OlP("appBaseHref");let Ze=(()=>{class se extends je{constructor(ae,ze){if(super(),this._platformLocation=ae,this._removeListenerFns=[],null==ze&&(ze=this._platformLocation.getBaseHrefFromDOM()),null==ze)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=ze}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(ae){this._removeListenerFns.push(this._platformLocation.onPopState(ae),this._platformLocation.onHashChange(ae))}getBaseHref(){return this._baseHref}prepareExternalUrl(ae){return ye(this._baseHref,ae)}path(ae=!1){const ze=this._platformLocation.pathname+Ee(this._platformLocation.search),St=this._platformLocation.hash;return St&&ae?`${ze}${St}`:ze}pushState(ae,ze,St,tn){const Ln=this.prepareExternalUrl(St+Ee(tn));this._platformLocation.pushState(ae,ze,Ln)}replaceState(ae,ze,St,tn){const Ln=this.prepareExternalUrl(St+Ee(tn));this._platformLocation.replaceState(ae,ze,Ln)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(ae=0){this._platformLocation.historyGo?.(ae)}}return se.\u0275fac=function(ae){return new(ae||se)(d.LFG(L),d.LFG(Ae,8))},se.\u0275prov=d.Yz7({token:se,factory:se.\u0275fac}),se})(),Ve=(()=>{class se extends je{constructor(ae,ze){super(),this._platformLocation=ae,this._baseHref="",this._removeListenerFns=[],null!=ze&&(this._baseHref=ze)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(ae){this._removeListenerFns.push(this._platformLocation.onPopState(ae),this._platformLocation.onHashChange(ae))}getBaseHref(){return this._baseHref}path(ae=!1){let ze=this._platformLocation.hash;return null==ze&&(ze="#"),ze.length>0?ze.substring(1):ze}prepareExternalUrl(ae){const ze=ye(this._baseHref,ae);return ze.length>0?"#"+ze:ze}pushState(ae,ze,St,tn){let Ln=this.prepareExternalUrl(St+Ee(tn));0==Ln.length&&(Ln=this._platformLocation.pathname),this._platformLocation.pushState(ae,ze,Ln)}replaceState(ae,ze,St,tn){let Ln=this.prepareExternalUrl(St+Ee(tn));0==Ln.length&&(Ln=this._platformLocation.pathname),this._platformLocation.replaceState(ae,ze,Ln)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(ae=0){this._platformLocation.historyGo?.(ae)}}return se.\u0275fac=function(ae){return new(ae||se)(d.LFG(L),d.LFG(Ae,8))},se.\u0275prov=d.Yz7({token:se,factory:se.\u0275fac}),se})(),He=(()=>{class se{constructor(ae,ze){this._subject=new d.vpe,this._urlChangeListeners=[],this._platformStrategy=ae;const St=this._platformStrategy.getBaseHref();this._platformLocation=ze,this._baseHref=me(Je(St)),this._platformStrategy.onPopState(tn=>{this._subject.emit({url:this.path(!0),pop:!0,state:tn.state,type:tn.type})})}path(ae=!1){return this.normalize(this._platformStrategy.path(ae))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(ae,ze=""){return this.path()==this.normalize(ae+Ee(ze))}normalize(ae){return se.stripTrailingSlash(function xt(se,Ce){return se&&Ce.startsWith(se)?Ce.substring(se.length):Ce}(this._baseHref,Je(ae)))}prepareExternalUrl(ae){return ae&&"/"!==ae[0]&&(ae="/"+ae),this._platformStrategy.prepareExternalUrl(ae)}go(ae,ze="",St=null){this._platformStrategy.pushState(St,"",ae,ze),this._notifyUrlChangeListeners(this.prepareExternalUrl(ae+Ee(ze)),St)}replaceState(ae,ze="",St=null){this._platformStrategy.replaceState(St,"",ae,ze),this._notifyUrlChangeListeners(this.prepareExternalUrl(ae+Ee(ze)),St)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(ae=0){this._platformStrategy.historyGo?.(ae)}onUrlChange(ae){this._urlChangeListeners.push(ae),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(ze=>{this._notifyUrlChangeListeners(ze.url,ze.state)}))}_notifyUrlChangeListeners(ae="",ze){this._urlChangeListeners.forEach(St=>St(ae,ze))}subscribe(ae,ze,St){return this._subject.subscribe({next:ae,error:ze,complete:St})}}return se.normalizeQueryParams=Ee,se.joinWithSlash=ye,se.stripTrailingSlash=me,se.\u0275fac=function(ae){return new(ae||se)(d.LFG(je),d.LFG(L))},se.\u0275prov=d.Yz7({token:se,factory:function(){return function Ne(){return new He((0,d.LFG)(je),(0,d.LFG)(L))}()},providedIn:"root"}),se})();function Je(se){return se.replace(/\/index.html$/,"")}var wt=(()=>((wt=wt||{})[wt.Decimal=0]="Decimal",wt[wt.Percent=1]="Percent",wt[wt.Currency=2]="Currency",wt[wt.Scientific=3]="Scientific",wt))(),Tt=(()=>((Tt=Tt||{})[Tt.Zero=0]="Zero",Tt[Tt.One=1]="One",Tt[Tt.Two=2]="Two",Tt[Tt.Few=3]="Few",Tt[Tt.Many=4]="Many",Tt[Tt.Other=5]="Other",Tt))(),Ct=(()=>((Ct=Ct||{})[Ct.Format=0]="Format",Ct[Ct.Standalone=1]="Standalone",Ct))(),gt=(()=>((gt=gt||{})[gt.Narrow=0]="Narrow",gt[gt.Abbreviated=1]="Abbreviated",gt[gt.Wide=2]="Wide",gt[gt.Short=3]="Short",gt))(),Lt=(()=>((Lt=Lt||{})[Lt.Short=0]="Short",Lt[Lt.Medium=1]="Medium",Lt[Lt.Long=2]="Long",Lt[Lt.Full=3]="Full",Lt))(),Ht=(()=>((Ht=Ht||{})[Ht.Decimal=0]="Decimal",Ht[Ht.Group=1]="Group",Ht[Ht.List=2]="List",Ht[Ht.PercentSign=3]="PercentSign",Ht[Ht.PlusSign=4]="PlusSign",Ht[Ht.MinusSign=5]="MinusSign",Ht[Ht.Exponential=6]="Exponential",Ht[Ht.SuperscriptingExponent=7]="SuperscriptingExponent",Ht[Ht.PerMille=8]="PerMille",Ht[Ht.Infinity=9]="Infinity",Ht[Ht.NaN=10]="NaN",Ht[Ht.TimeSeparator=11]="TimeSeparator",Ht[Ht.CurrencyDecimal=12]="CurrencyDecimal",Ht[Ht.CurrencyGroup=13]="CurrencyGroup",Ht))();function di(se,Ce){return Si((0,d.cg1)(se)[d.wAp.DateFormat],Ce)}function Bn(se,Ce){return Si((0,d.cg1)(se)[d.wAp.TimeFormat],Ce)}function ln(se,Ce){return Si((0,d.cg1)(se)[d.wAp.DateTimeFormat],Ce)}function Et(se,Ce){const ae=(0,d.cg1)(se),ze=ae[d.wAp.NumberSymbols][Ce];if(void 0===ze){if(Ce===Ht.CurrencyDecimal)return ae[d.wAp.NumberSymbols][Ht.Decimal];if(Ce===Ht.CurrencyGroup)return ae[d.wAp.NumberSymbols][Ht.Group]}return ze}const ir=d.kL8;function _r(se){if(!se[d.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${se[d.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Si(se,Ce){for(let ae=Ce;ae>-1;ae--)if(void 0!==se[ae])return se[ae];throw new Error("Locale data API: locale data undefined")}function ki(se){const[Ce,ae]=se.split(":");return{hours:+Ce,minutes:+ae}}const Pe=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,ft={},Be=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var $t=(()=>(($t=$t||{})[$t.Short=0]="Short",$t[$t.ShortGMT=1]="ShortGMT",$t[$t.Long=2]="Long",$t[$t.Extended=3]="Extended",$t))(),xe=(()=>((xe=xe||{})[xe.FullYear=0]="FullYear",xe[xe.Month=1]="Month",xe[xe.Date=2]="Date",xe[xe.Hours=3]="Hours",xe[xe.Minutes=4]="Minutes",xe[xe.Seconds=5]="Seconds",xe[xe.FractionalSeconds=6]="FractionalSeconds",xe[xe.Day=7]="Day",xe))(),Ie=(()=>((Ie=Ie||{})[Ie.DayPeriods=0]="DayPeriods",Ie[Ie.Days=1]="Days",Ie[Ie.Months=2]="Months",Ie[Ie.Eras=3]="Eras",Ie))();function Ut(se,Ce,ae,ze){let St=function vt(se){if(tt(se))return se;if("number"==typeof se&&!isNaN(se))return new Date(se);if("string"==typeof se){if(se=se.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(se)){const[St,tn=1,Ln=1]=se.split("-").map(Yn=>+Yn);return nn(St,tn-1,Ln)}const ae=parseFloat(se);if(!isNaN(se-ae))return new Date(ae);let ze;if(ze=se.match(Pe))return function kt(se){const Ce=new Date(0);let ae=0,ze=0;const St=se[8]?Ce.setUTCFullYear:Ce.setFullYear,tn=se[8]?Ce.setUTCHours:Ce.setHours;se[9]&&(ae=Number(se[9]+se[10]),ze=Number(se[9]+se[11])),St.call(Ce,Number(se[1]),Number(se[2])-1,Number(se[3]));const Ln=Number(se[4]||0)-ae,Yn=Number(se[5]||0)-ze,Mr=Number(se[6]||0),Fr=Math.floor(1e3*parseFloat("0."+(se[7]||0)));return tn.call(Ce,Ln,Yn,Mr,Fr),Ce}(ze)}const Ce=new Date(se);if(!tt(Ce))throw new Error(`Unable to convert "${se}" into a date`);return Ce}(se);Ce=ni(ae,Ce)||Ce;let Yn,Ln=[];for(;Ce;){if(Yn=Be.exec(Ce),!Yn){Ln.push(Ce);break}{Ln=Ln.concat(Yn.slice(1));const Zi=Ln.pop();if(!Zi)break;Ce=Zi}}let Mr=St.getTimezoneOffset();ze&&(Mr=fe(ze,Mr),St=function Qe(se,Ce,ae){const ze=ae?-1:1,St=se.getTimezoneOffset();return function _e(se,Ce){return(se=new Date(se.getTime())).setMinutes(se.getMinutes()+Ce),se}(se,ze*(fe(Ce,St)-St))}(St,ze,!0));let Fr="";return Ln.forEach(Zi=>{const Er=function F(se){if(K[se])return K[se];let Ce;switch(se){case"G":case"GG":case"GGG":Ce=ji(Ie.Eras,gt.Abbreviated);break;case"GGGG":Ce=ji(Ie.Eras,gt.Wide);break;case"GGGGG":Ce=ji(Ie.Eras,gt.Narrow);break;case"y":Ce=xi(xe.FullYear,1,0,!1,!0);break;case"yy":Ce=xi(xe.FullYear,2,0,!0,!0);break;case"yyy":Ce=xi(xe.FullYear,3,0,!1,!0);break;case"yyyy":Ce=xi(xe.FullYear,4,0,!1,!0);break;case"Y":Ce=re(1);break;case"YY":Ce=re(2,!0);break;case"YYY":Ce=re(3);break;case"YYYY":Ce=re(4);break;case"M":case"L":Ce=xi(xe.Month,1,1);break;case"MM":case"LL":Ce=xi(xe.Month,2,1);break;case"MMM":Ce=ji(Ie.Months,gt.Abbreviated);break;case"MMMM":Ce=ji(Ie.Months,gt.Wide);break;case"MMMMM":Ce=ji(Ie.Months,gt.Narrow);break;case"LLL":Ce=ji(Ie.Months,gt.Abbreviated,Ct.Standalone);break;case"LLLL":Ce=ji(Ie.Months,gt.Wide,Ct.Standalone);break;case"LLLLL":Ce=ji(Ie.Months,gt.Narrow,Ct.Standalone);break;case"w":Ce=ur(1);break;case"ww":Ce=ur(2);break;case"W":Ce=ur(1,!0);break;case"d":Ce=xi(xe.Date,1);break;case"dd":Ce=xi(xe.Date,2);break;case"c":case"cc":Ce=xi(xe.Day,1);break;case"ccc":Ce=ji(Ie.Days,gt.Abbreviated,Ct.Standalone);break;case"cccc":Ce=ji(Ie.Days,gt.Wide,Ct.Standalone);break;case"ccccc":Ce=ji(Ie.Days,gt.Narrow,Ct.Standalone);break;case"cccccc":Ce=ji(Ie.Days,gt.Short,Ct.Standalone);break;case"E":case"EE":case"EEE":Ce=ji(Ie.Days,gt.Abbreviated);break;case"EEEE":Ce=ji(Ie.Days,gt.Wide);break;case"EEEEE":Ce=ji(Ie.Days,gt.Narrow);break;case"EEEEEE":Ce=ji(Ie.Days,gt.Short);break;case"a":case"aa":case"aaa":Ce=ji(Ie.DayPeriods,gt.Abbreviated);break;case"aaaa":Ce=ji(Ie.DayPeriods,gt.Wide);break;case"aaaaa":Ce=ji(Ie.DayPeriods,gt.Narrow);break;case"b":case"bb":case"bbb":Ce=ji(Ie.DayPeriods,gt.Abbreviated,Ct.Standalone,!0);break;case"bbbb":Ce=ji(Ie.DayPeriods,gt.Wide,Ct.Standalone,!0);break;case"bbbbb":Ce=ji(Ie.DayPeriods,gt.Narrow,Ct.Standalone,!0);break;case"B":case"BB":case"BBB":Ce=ji(Ie.DayPeriods,gt.Abbreviated,Ct.Format,!0);break;case"BBBB":Ce=ji(Ie.DayPeriods,gt.Wide,Ct.Format,!0);break;case"BBBBB":Ce=ji(Ie.DayPeriods,gt.Narrow,Ct.Format,!0);break;case"h":Ce=xi(xe.Hours,1,-12);break;case"hh":Ce=xi(xe.Hours,2,-12);break;case"H":Ce=xi(xe.Hours,1);break;case"HH":Ce=xi(xe.Hours,2);break;case"m":Ce=xi(xe.Minutes,1);break;case"mm":Ce=xi(xe.Minutes,2);break;case"s":Ce=xi(xe.Seconds,1);break;case"ss":Ce=xi(xe.Seconds,2);break;case"S":Ce=xi(xe.FractionalSeconds,1);break;case"SS":Ce=xi(xe.FractionalSeconds,2);break;case"SSS":Ce=xi(xe.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":Ce=$i($t.Short);break;case"ZZZZZ":Ce=$i($t.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":Ce=$i($t.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":Ce=$i($t.Long);break;default:return null}return K[se]=Ce,Ce}(Zi);Fr+=Er?Er(St,ae,Mr):"''"===Zi?"'":Zi.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Fr}function nn(se,Ce,ae){const ze=new Date(0);return ze.setFullYear(se,Ce,ae),ze.setHours(0,0,0),ze}function ni(se,Ce){const ae=function Ft(se){return(0,d.cg1)(se)[d.wAp.LocaleId]}(se);if(ft[ae]=ft[ae]||{},ft[ae][Ce])return ft[ae][Ce];let ze="";switch(Ce){case"shortDate":ze=di(se,Lt.Short);break;case"mediumDate":ze=di(se,Lt.Medium);break;case"longDate":ze=di(se,Lt.Long);break;case"fullDate":ze=di(se,Lt.Full);break;case"shortTime":ze=Bn(se,Lt.Short);break;case"mediumTime":ze=Bn(se,Lt.Medium);break;case"longTime":ze=Bn(se,Lt.Long);break;case"fullTime":ze=Bn(se,Lt.Full);break;case"short":const St=ni(se,"shortTime"),tn=ni(se,"shortDate");ze=cr(ln(se,Lt.Short),[St,tn]);break;case"medium":const Ln=ni(se,"mediumTime"),Yn=ni(se,"mediumDate");ze=cr(ln(se,Lt.Medium),[Ln,Yn]);break;case"long":const Mr=ni(se,"longTime"),Fr=ni(se,"longDate");ze=cr(ln(se,Lt.Long),[Mr,Fr]);break;case"full":const Zi=ni(se,"fullTime"),Er=ni(se,"fullDate");ze=cr(ln(se,Lt.Full),[Zi,Er])}return ze&&(ft[ae][Ce]=ze),ze}function cr(se,Ce){return Ce&&(se=se.replace(/\{([^}]+)}/g,function(ae,ze){return null!=Ce&&ze in Ce?Ce[ze]:ae})),se}function Li(se,Ce,ae="-",ze,St){let tn="";(se<0||St&&se<=0)&&(St?se=1-se:(se=-se,tn=ae));let Ln=String(se);for(;Ln.length<Ce;)Ln="0"+Ln;return ze&&(Ln=Ln.substr(Ln.length-Ce)),tn+Ln}function xi(se,Ce,ae=0,ze=!1,St=!1){return function(tn,Ln){let Yn=function vr(se,Ce){switch(se){case xe.FullYear:return Ce.getFullYear();case xe.Month:return Ce.getMonth();case xe.Date:return Ce.getDate();case xe.Hours:return Ce.getHours();case xe.Minutes:return Ce.getMinutes();case xe.Seconds:return Ce.getSeconds();case xe.FractionalSeconds:return Ce.getMilliseconds();case xe.Day:return Ce.getDay();default:throw new Error(`Unknown DateType value "${se}".`)}}(se,tn);if((ae>0||Yn>-ae)&&(Yn+=ae),se===xe.Hours)0===Yn&&-12===ae&&(Yn=12);else if(se===xe.FractionalSeconds)return function Ei(se,Ce){return Li(se,3).substr(0,Ce)}(Yn,Ce);const Mr=Et(Ln,Ht.MinusSign);return Li(Yn,Ce,Mr,ze,St)}}function ji(se,Ce,ae=Ct.Format,ze=!1){return function(St,tn){return function Ir(se,Ce,ae,ze,St,tn){switch(ae){case Ie.Months:return function Jt(se,Ce,ae){const ze=(0,d.cg1)(se),tn=Si([ze[d.wAp.MonthsFormat],ze[d.wAp.MonthsStandalone]],Ce);return Si(tn,ae)}(Ce,St,ze)[se.getMonth()];case Ie.Days:return function Gt(se,Ce,ae){const ze=(0,d.cg1)(se),tn=Si([ze[d.wAp.DaysFormat],ze[d.wAp.DaysStandalone]],Ce);return Si(tn,ae)}(Ce,St,ze)[se.getDay()];case Ie.DayPeriods:const Ln=se.getHours(),Yn=se.getMinutes();if(tn){const Fr=function er(se){const Ce=(0,d.cg1)(se);return _r(Ce),(Ce[d.wAp.ExtraData][2]||[]).map(ze=>"string"==typeof ze?ki(ze):[ki(ze[0]),ki(ze[1])])}(Ce),Zi=function Ri(se,Ce,ae){const ze=(0,d.cg1)(se);_r(ze);const tn=Si([ze[d.wAp.ExtraData][0],ze[d.wAp.ExtraData][1]],Ce)||[];return Si(tn,ae)||[]}(Ce,St,ze),Er=Fr.findIndex(vo=>{if(Array.isArray(vo)){const[le,ee]=vo,ne=Ln>=le.hours&&Yn>=le.minutes,Ue=Ln<ee.hours||Ln===ee.hours&&Yn<ee.minutes;if(le.hours<ee.hours){if(ne&&Ue)return!0}else if(ne||Ue)return!0}else if(vo.hours===Ln&&vo.minutes===Yn)return!0;return!1});if(-1!==Er)return Zi[Er]}return function Wt(se,Ce,ae){const ze=(0,d.cg1)(se),tn=Si([ze[d.wAp.DayPeriodsFormat],ze[d.wAp.DayPeriodsStandalone]],Ce);return Si(tn,ae)}(Ce,St,ze)[Ln<12?0:1];case Ie.Eras:return function an(se,Ce){return Si((0,d.cg1)(se)[d.wAp.Eras],Ce)}(Ce,ze)[se.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${ae}`)}}(St,tn,se,Ce,ae,ze)}}function $i(se){return function(Ce,ae,ze){const St=-1*ze,tn=Et(ae,Ht.MinusSign),Ln=St>0?Math.floor(St/60):Math.ceil(St/60);switch(se){case $t.Short:return(St>=0?"+":"")+Li(Ln,2,tn)+Li(Math.abs(St%60),2,tn);case $t.ShortGMT:return"GMT"+(St>=0?"+":"")+Li(Ln,1,tn);case $t.Long:return"GMT"+(St>=0?"+":"")+Li(Ln,2,tn)+":"+Li(Math.abs(St%60),2,tn);case $t.Extended:return 0===ze?"Z":(St>=0?"+":"")+Li(Ln,2,tn)+":"+Li(Math.abs(St%60),2,tn);default:throw new Error(`Unknown zone width "${se}"`)}}}function Xi(se){return nn(se.getFullYear(),se.getMonth(),se.getDate()+(4-se.getDay()))}function ur(se,Ce=!1){return function(ae,ze){let St;if(Ce){const tn=new Date(ae.getFullYear(),ae.getMonth(),1).getDay()-1,Ln=ae.getDate();St=1+Math.floor((Ln+tn)/7)}else{const tn=Xi(ae),Ln=function zr(se){const Ce=nn(se,0,1).getDay();return nn(se,0,1+(Ce<=4?4:11)-Ce)}(tn.getFullYear()),Yn=tn.getTime()-Ln.getTime();St=1+Math.round(Yn/6048e5)}return Li(St,se,Et(ze,Ht.MinusSign))}}function re(se,Ce=!1){return function(ae,ze){return Li(Xi(ae).getFullYear(),se,Et(ze,Ht.MinusSign),Ce)}}const K={};function fe(se,Ce){se=se.replace(/:/g,"");const ae=Date.parse("Jan 01, 1970 00:00:00 "+se)/6e4;return isNaN(ae)?Ce:ae}function tt(se){return se instanceof Date&&!isNaN(se.valueOf())}const Zt=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function hi(se){const Ce=parseInt(se);if(isNaN(Ce))throw new Error("Invalid integer literal when parsing "+se);return Ce}class Cr{}let qr=(()=>{class se extends Cr{constructor(ae){super(),this.locale=ae}getPluralCategory(ae,ze){switch(ir(ze||this.locale)(ae)){case Tt.Zero:return"zero";case Tt.One:return"one";case Tt.Two:return"two";case Tt.Few:return"few";case Tt.Many:return"many";default:return"other"}}}return se.\u0275fac=function(ae){return new(ae||se)(d.LFG(d.soG))},se.\u0275prov=d.Yz7({token:se,factory:se.\u0275fac}),se})();function Oi(se,Ce){Ce=encodeURIComponent(Ce);for(const ae of se.split(";")){const ze=ae.indexOf("="),[St,tn]=-1==ze?[ae,""]:[ae.slice(0,ze),ae.slice(ze+1)];if(St.trim()===Ce)return decodeURIComponent(tn)}return null}class uo{constructor(Ce,ae,ze,St){this.$implicit=Ce,this.ngForOf=ae,this.index=ze,this.count=St}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Lr=(()=>{class se{constructor(ae,ze,St){this._viewContainer=ae,this._template=ze,this._differs=St,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(ae){this._ngForOf=ae,this._ngForOfDirty=!0}set ngForTrackBy(ae){this._trackByFn=ae}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(ae){ae&&(this._template=ae)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const ae=this._ngForOf;!this._differ&&ae&&(this._differ=this._differs.find(ae).create(this.ngForTrackBy))}if(this._differ){const ae=this._differ.diff(this._ngForOf);ae&&this._applyChanges(ae)}}_applyChanges(ae){const ze=this._viewContainer;ae.forEachOperation((St,tn,Ln)=>{if(null==St.previousIndex)ze.createEmbeddedView(this._template,new uo(St.item,this._ngForOf,-1,-1),null===Ln?void 0:Ln);else if(null==Ln)ze.remove(null===tn?void 0:tn);else if(null!==tn){const Yn=ze.get(tn);ze.move(Yn,Ln),Sr(Yn,St)}});for(let St=0,tn=ze.length;St<tn;St++){const Yn=ze.get(St).context;Yn.index=St,Yn.count=tn,Yn.ngForOf=this._ngForOf}ae.forEachIdentityChange(St=>{Sr(ze.get(St.currentIndex),St)})}static ngTemplateContextGuard(ae,ze){return!0}}return se.\u0275fac=function(ae){return new(ae||se)(d.Y36(d.s_b),d.Y36(d.Rgc),d.Y36(d.ZZ4))},se.\u0275dir=d.lG2({type:se,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),se})();function Sr(se,Ce){se.context.$implicit=Ce.item}let Se=(()=>{class se{constructor(ae,ze){this._viewContainer=ae,this._context=new Xe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=ze}set ngIf(ae){this._context.$implicit=this._context.ngIf=ae,this._updateView()}set ngIfThen(ae){Me("ngIfThen",ae),this._thenTemplateRef=ae,this._thenViewRef=null,this._updateView()}set ngIfElse(ae){Me("ngIfElse",ae),this._elseTemplateRef=ae,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(ae,ze){return!0}}return se.\u0275fac=function(ae){return new(ae||se)(d.Y36(d.s_b),d.Y36(d.Rgc))},se.\u0275dir=d.lG2({type:se,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),se})();class Xe{constructor(){this.$implicit=null,this.ngIf=null}}function Me(se,Ce){if(Ce&&!Ce.createEmbeddedView)throw new Error(`${se} must be a TemplateRef, but received '${(0,d.AaK)(Ce)}'.`)}let Bt=(()=>{class se{constructor(ae){this._viewContainerRef=ae,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null}ngOnChanges(ae){if(ae.ngTemplateOutlet){const ze=this._viewContainerRef;this._viewRef&&ze.remove(ze.indexOf(this._viewRef)),this._viewRef=this.ngTemplateOutlet?ze.createEmbeddedView(this.ngTemplateOutlet,this.ngTemplateOutletContext):null}else this._viewRef&&ae.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return se.\u0275fac=function(ae){return new(ae||se)(d.Y36(d.s_b))},se.\u0275dir=d.lG2({type:se,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet"},features:[d.TTD]}),se})();function qi(se,Ce){return new d.vHH(2100,"")}const wo=new d.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let at=(()=>{class se{constructor(ae,ze){this.locale=ae,this.defaultTimezone=ze}transform(ae,ze="mediumDate",St,tn){if(null==ae||""===ae||ae!=ae)return null;try{return Ut(ae,ze,tn||this.locale,St??this.defaultTimezone??void 0)}catch(Ln){throw qi()}}}return se.\u0275fac=function(ae){return new(ae||se)(d.Y36(d.soG,16),d.Y36(wo,24))},se.\u0275pipe=d.Yjl({name:"date",type:se,pure:!0}),se})(),ie=(()=>{class se{constructor(ae){this._locale=ae}transform(ae,ze,St){if(!function Oe(se){return!(null==se||""===se||se!=se)}(ae))return null;St=St||this._locale;try{return function Pn(se,Ce,ae){return function Qi(se,Ce,ae,ze,St,tn,Ln=!1){let Yn="",Mr=!1;if(isFinite(se)){let Fr=function Gi(se){let ze,St,tn,Ln,Yn,Ce=Math.abs(se)+"",ae=0;for((St=Ce.indexOf("."))>-1&&(Ce=Ce.replace(".","")),(tn=Ce.search(/e/i))>0?(St<0&&(St=tn),St+=+Ce.slice(tn+1),Ce=Ce.substring(0,tn)):St<0&&(St=Ce.length),tn=0;"0"===Ce.charAt(tn);tn++);if(tn===(Yn=Ce.length))ze=[0],St=1;else{for(Yn--;"0"===Ce.charAt(Yn);)Yn--;for(St-=tn,ze=[],Ln=0;tn<=Yn;tn++,Ln++)ze[Ln]=Number(Ce.charAt(tn))}return St>22&&(ze=ze.splice(0,21),ae=St-1,St=1),{digits:ze,exponent:ae,integerLen:St}}(se);Ln&&(Fr=function Bi(se){if(0===se.digits[0])return se;const Ce=se.digits.length-se.integerLen;return se.exponent?se.exponent+=2:(0===Ce?se.digits.push(0,0):1===Ce&&se.digits.push(0),se.integerLen+=2),se}(Fr));let Zi=Ce.minInt,Er=Ce.minFrac,vo=Ce.maxFrac;if(tn){const ri=tn.match(Zt);if(null===ri)throw new Error(`${tn} is not a valid digit info`);const Yr=ri[1],Jr=ri[3],es=ri[5];null!=Yr&&(Zi=hi(Yr)),null!=Jr&&(Er=hi(Jr)),null!=es?vo=hi(es):null!=Jr&&Er>vo&&(vo=Er)}!function Ar(se,Ce,ae){if(Ce>ae)throw new Error(`The minimum number of digits after fraction (${Ce}) is higher than the maximum (${ae}).`);let ze=se.digits,St=ze.length-se.integerLen;const tn=Math.min(Math.max(Ce,St),ae);let Ln=tn+se.integerLen,Yn=ze[Ln];if(Ln>0){ze.splice(Math.max(se.integerLen,Ln));for(let Er=Ln;Er<ze.length;Er++)ze[Er]=0}else{St=Math.max(0,St),se.integerLen=1,ze.length=Math.max(1,Ln=tn+1),ze[0]=0;for(let Er=1;Er<Ln;Er++)ze[Er]=0}if(Yn>=5)if(Ln-1<0){for(let Er=0;Er>Ln;Er--)ze.unshift(0),se.integerLen++;ze.unshift(1),se.integerLen++}else ze[Ln-1]++;for(;St<Math.max(0,tn);St++)ze.push(0);let Mr=0!==tn;const Fr=Ce+se.integerLen,Zi=ze.reduceRight(function(Er,vo,le,ee){return ee[le]=(vo+=Er)<10?vo:vo-10,Mr&&(0===ee[le]&&le>=Fr?ee.pop():Mr=!1),vo>=10?1:0},0);Zi&&(ze.unshift(Zi),se.integerLen++)}(Fr,Er,vo);let le=Fr.digits,ee=Fr.integerLen;const ne=Fr.exponent;let Ue=[];for(Mr=le.every(ri=>!ri);ee<Zi;ee++)le.unshift(0);for(;ee<0;ee++)le.unshift(0);ee>0?Ue=le.splice(ee,le.length):(Ue=le,le=[0]);const pn=[];for(le.length>=Ce.lgSize&&pn.unshift(le.splice(-Ce.lgSize,le.length).join(""));le.length>Ce.gSize;)pn.unshift(le.splice(-Ce.gSize,le.length).join(""));le.length&&pn.unshift(le.join("")),Yn=pn.join(Et(ae,ze)),Ue.length&&(Yn+=Et(ae,St)+Ue.join("")),ne&&(Yn+=Et(ae,Ht.Exponential)+"+"+ne)}else Yn=Et(ae,Ht.Infinity);return Yn=se<0&&!Mr?Ce.negPre+Yn+Ce.negSuf:Ce.posPre+Yn+Ce.posSuf,Yn}(se,function Ai(se,Ce="-"){const ae={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},ze=se.split(";"),St=ze[0],tn=ze[1],Ln=-1!==St.indexOf(".")?St.split("."):[St.substring(0,St.lastIndexOf("0")+1),St.substring(St.lastIndexOf("0")+1)],Yn=Ln[0],Mr=Ln[1]||"";ae.posPre=Yn.substr(0,Yn.indexOf("#"));for(let Zi=0;Zi<Mr.length;Zi++){const Er=Mr.charAt(Zi);"0"===Er?ae.minFrac=ae.maxFrac=Zi+1:"#"===Er?ae.maxFrac=Zi+1:ae.posSuf+=Er}const Fr=Yn.split(",");if(ae.gSize=Fr[1]?Fr[1].length:0,ae.lgSize=Fr[2]||Fr[1]?(Fr[2]||Fr[1]).length:0,tn){const Zi=St.length-ae.posPre.length-ae.posSuf.length,Er=tn.indexOf("#");ae.negPre=tn.substr(0,Er).replace(/'/g,""),ae.negSuf=tn.substr(Er+Zi).replace(/'/g,"")}else ae.negPre=Ce+ae.posPre,ae.negSuf=ae.posSuf;return ae}(function Kt(se,Ce){return(0,d.cg1)(se)[d.wAp.NumberFormats][Ce]}(Ce,wt.Decimal),Et(Ce,Ht.MinusSign)),Ce,Ht.Group,Ht.Decimal,ae)}(function Dt(se){if("string"==typeof se&&!isNaN(Number(se)-parseFloat(se)))return Number(se);if("number"!=typeof se)throw new Error(`${se} is not a number`);return se}(ae),St,ze)}catch(tn){throw qi()}}}return se.\u0275fac=function(ae){return new(ae||se)(d.Y36(d.soG,16))},se.\u0275pipe=d.Yjl({name:"number",type:se,pure:!0}),se})();let Dn=(()=>{class se{}return se.\u0275fac=function(ae){return new(ae||se)},se.\u0275mod=d.oAB({type:se}),se.\u0275inj=d.cJS({providers:[{provide:Cr,useClass:qr}]}),se})();const yn="browser";let nr=(()=>{class se{}return se.\u0275prov=(0,d.Yz7)({token:se,providedIn:"root",factory:()=>new io((0,d.LFG)(p),window)}),se})();class io{constructor(Ce,ae){this.document=Ce,this.window=ae,this.offset=()=>[0,0]}setOffset(Ce){this.offset=Array.isArray(Ce)?()=>Ce:Ce}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(Ce){this.supportsScrolling()&&this.window.scrollTo(Ce[0],Ce[1])}scrollToAnchor(Ce){if(!this.supportsScrolling())return;const ae=function Hr(se,Ce){const ae=se.getElementById(Ce)||se.getElementsByName(Ce)[0];if(ae)return ae;if("function"==typeof se.createTreeWalker&&se.body&&(se.body.createShadowRoot||se.body.attachShadow)){const ze=se.createTreeWalker(se.body,NodeFilter.SHOW_ELEMENT);let St=ze.currentNode;for(;St;){const tn=St.shadowRoot;if(tn){const Ln=tn.getElementById(Ce)||tn.querySelector(`[name="${Ce}"]`);if(Ln)return Ln}St=ze.nextNode()}}return null}(this.document,Ce);ae&&(this.scrollToElement(ae),ae.focus())}setHistoryScrollRestoration(Ce){if(this.supportScrollRestoration()){const ae=this.window.history;ae&&ae.scrollRestoration&&(ae.scrollRestoration=Ce)}}scrollToElement(Ce){const ae=Ce.getBoundingClientRect(),ze=ae.left+this.window.pageXOffset,St=ae.top+this.window.pageYOffset,tn=this.offset();this.window.scrollTo(ze-tn[0],St-tn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const Ce=ho(this.window.history)||ho(Object.getPrototypeOf(this.window.history));return!(!Ce||!Ce.writable&&!Ce.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function ho(se){return Object.getOwnPropertyDescriptor(se,"scrollRestoration")}class Wr{}},529:(_n,Ke,k)=>{"use strict";k.d(Ke,{TP:()=>Ft,eN:()=>Ht,JF:()=>Si,WM:()=>Z});var d=k(6895),c=k(6738),V=k(1086),a=k(2916),O=k(1406),A=k(2198),p=k(4850);class L{}class Q{}class Z{constructor(de){this.normalizedNames=new Map,this.lazyUpdate=null,de?this.lazyInit="string"==typeof de?()=>{this.headers=new Map,de.split("\n").forEach(Pe=>{const ft=Pe.indexOf(":");if(ft>0){const Be=Pe.slice(0,ft),$t=Be.toLowerCase(),xe=Pe.slice(ft+1).trim();this.maybeSetNormalizedName(Be,$t),this.headers.has($t)?this.headers.get($t).push(xe):this.headers.set($t,[xe])}})}:()=>{this.headers=new Map,Object.keys(de).forEach(Pe=>{let ft=de[Pe];const Be=Pe.toLowerCase();"string"==typeof ft&&(ft=[ft]),ft.length>0&&(this.headers.set(Be,ft),this.maybeSetNormalizedName(Pe,Be))})}:this.headers=new Map}has(de){return this.init(),this.headers.has(de.toLowerCase())}get(de){this.init();const Pe=this.headers.get(de.toLowerCase());return Pe&&Pe.length>0?Pe[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(de){return this.init(),this.headers.get(de.toLowerCase())||null}append(de,Pe){return this.clone({name:de,value:Pe,op:"a"})}set(de,Pe){return this.clone({name:de,value:Pe,op:"s"})}delete(de,Pe){return this.clone({name:de,value:Pe,op:"d"})}maybeSetNormalizedName(de,Pe){this.normalizedNames.has(Pe)||this.normalizedNames.set(Pe,de)}init(){this.lazyInit&&(this.lazyInit instanceof Z?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(de=>this.applyUpdate(de)),this.lazyUpdate=null))}copyFrom(de){de.init(),Array.from(de.headers.keys()).forEach(Pe=>{this.headers.set(Pe,de.headers.get(Pe)),this.normalizedNames.set(Pe,de.normalizedNames.get(Pe))})}clone(de){const Pe=new Z;return Pe.lazyInit=this.lazyInit&&this.lazyInit instanceof Z?this.lazyInit:this,Pe.lazyUpdate=(this.lazyUpdate||[]).concat([de]),Pe}applyUpdate(de){const Pe=de.name.toLowerCase();switch(de.op){case"a":case"s":let ft=de.value;if("string"==typeof ft&&(ft=[ft]),0===ft.length)return;this.maybeSetNormalizedName(de.name,Pe);const Be=("a"===de.op?this.headers.get(Pe):void 0)||[];Be.push(...ft),this.headers.set(Pe,Be);break;case"d":const $t=de.value;if($t){let xe=this.headers.get(Pe);if(!xe)return;xe=xe.filter(Ie=>-1===$t.indexOf(Ie)),0===xe.length?(this.headers.delete(Pe),this.normalizedNames.delete(Pe)):this.headers.set(Pe,xe)}else this.headers.delete(Pe),this.normalizedNames.delete(Pe)}}forEach(de){this.init(),Array.from(this.normalizedNames.keys()).forEach(Pe=>de(this.normalizedNames.get(Pe),this.headers.get(Pe)))}}class z{encodeKey(de){return me(de)}encodeValue(de){return me(de)}decodeKey(de){return decodeURIComponent(de)}decodeValue(de){return decodeURIComponent(de)}}const te=/%(\d[a-f0-9])/gi,ye={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function me(et){return encodeURIComponent(et).replace(te,(de,Pe)=>ye[Pe]??de)}function Ee(et){return`${et}`}class je{constructor(de={}){if(this.updates=null,this.cloneFrom=null,this.encoder=de.encoder||new z,de.fromString){if(de.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function G(et,de){const Pe=new Map;return et.length>0&&et.replace(/^\?/,"").split("&").forEach(Be=>{const $t=Be.indexOf("="),[xe,Ie]=-1==$t?[de.decodeKey(Be),""]:[de.decodeKey(Be.slice(0,$t)),de.decodeValue(Be.slice($t+1))],Ut=Pe.get(xe)||[];Ut.push(Ie),Pe.set(xe,Ut)}),Pe}(de.fromString,this.encoder)}else de.fromObject?(this.map=new Map,Object.keys(de.fromObject).forEach(Pe=>{const ft=de.fromObject[Pe];this.map.set(Pe,Array.isArray(ft)?ft:[ft])})):this.map=null}has(de){return this.init(),this.map.has(de)}get(de){this.init();const Pe=this.map.get(de);return Pe?Pe[0]:null}getAll(de){return this.init(),this.map.get(de)||null}keys(){return this.init(),Array.from(this.map.keys())}append(de,Pe){return this.clone({param:de,value:Pe,op:"a"})}appendAll(de){const Pe=[];return Object.keys(de).forEach(ft=>{const Be=de[ft];Array.isArray(Be)?Be.forEach($t=>{Pe.push({param:ft,value:$t,op:"a"})}):Pe.push({param:ft,value:Be,op:"a"})}),this.clone(Pe)}set(de,Pe){return this.clone({param:de,value:Pe,op:"s"})}delete(de,Pe){return this.clone({param:de,value:Pe,op:"d"})}toString(){return this.init(),this.keys().map(de=>{const Pe=this.encoder.encodeKey(de);return this.map.get(de).map(ft=>Pe+"="+this.encoder.encodeValue(ft)).join("&")}).filter(de=>""!==de).join("&")}clone(de){const Pe=new je({encoder:this.encoder});return Pe.cloneFrom=this.cloneFrom||this,Pe.updates=(this.updates||[]).concat(de),Pe}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(de=>this.map.set(de,this.cloneFrom.map.get(de))),this.updates.forEach(de=>{switch(de.op){case"a":case"s":const Pe=("a"===de.op?this.map.get(de.param):void 0)||[];Pe.push(Ee(de.value)),this.map.set(de.param,Pe);break;case"d":if(void 0===de.value){this.map.delete(de.param);break}{let ft=this.map.get(de.param)||[];const Be=ft.indexOf(Ee(de.value));-1!==Be&&ft.splice(Be,1),ft.length>0?this.map.set(de.param,ft):this.map.delete(de.param)}}}),this.cloneFrom=this.updates=null)}}class Ae{constructor(){this.map=new Map}set(de,Pe){return this.map.set(de,Pe),this}get(de){return this.map.has(de)||this.map.set(de,de.defaultValue()),this.map.get(de)}delete(de){return this.map.delete(de),this}has(de){return this.map.has(de)}keys(){return this.map.keys()}}function Ve(et){return"undefined"!=typeof ArrayBuffer&&et instanceof ArrayBuffer}function He(et){return"undefined"!=typeof Blob&&et instanceof Blob}function Ne(et){return"undefined"!=typeof FormData&&et instanceof FormData}class Je{constructor(de,Pe,ft,Be){let $t;if(this.url=Pe,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=de.toUpperCase(),function Ze(et){switch(et){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Be?(this.body=void 0!==ft?ft:null,$t=Be):$t=ft,$t&&(this.reportProgress=!!$t.reportProgress,this.withCredentials=!!$t.withCredentials,$t.responseType&&(this.responseType=$t.responseType),$t.headers&&(this.headers=$t.headers),$t.context&&(this.context=$t.context),$t.params&&(this.params=$t.params)),this.headers||(this.headers=new Z),this.context||(this.context=new Ae),this.params){const xe=this.params.toString();if(0===xe.length)this.urlWithParams=Pe;else{const Ie=Pe.indexOf("?");this.urlWithParams=Pe+(-1===Ie?"?":Ie<Pe.length-1?"&":"")+xe}}else this.params=new je,this.urlWithParams=Pe}serializeBody(){return null===this.body?null:Ve(this.body)||He(this.body)||Ne(this.body)||function xt(et){return"undefined"!=typeof URLSearchParams&&et instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof je?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Ne(this.body)?null:He(this.body)?this.body.type||null:Ve(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof je?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(de={}){const Pe=de.method||this.method,ft=de.url||this.url,Be=de.responseType||this.responseType,$t=void 0!==de.body?de.body:this.body,xe=void 0!==de.withCredentials?de.withCredentials:this.withCredentials,Ie=void 0!==de.reportProgress?de.reportProgress:this.reportProgress;let Ut=de.headers||this.headers,nn=de.params||this.params;const ni=de.context??this.context;return void 0!==de.setHeaders&&(Ut=Object.keys(de.setHeaders).reduce((cr,Li)=>cr.set(Li,de.setHeaders[Li]),Ut)),de.setParams&&(nn=Object.keys(de.setParams).reduce((cr,Li)=>cr.set(Li,de.setParams[Li]),nn)),new Je(Pe,ft,$t,{params:nn,headers:Ut,context:ni,reportProgress:Ie,responseType:Be,withCredentials:xe})}}var ct=(()=>((ct=ct||{})[ct.Sent=0]="Sent",ct[ct.UploadProgress=1]="UploadProgress",ct[ct.ResponseHeader=2]="ResponseHeader",ct[ct.DownloadProgress=3]="DownloadProgress",ct[ct.Response=4]="Response",ct[ct.User=5]="User",ct))();class wt{constructor(de,Pe=200,ft="OK"){this.headers=de.headers||new Z,this.status=void 0!==de.status?de.status:Pe,this.statusText=de.statusText||ft,this.url=de.url||null,this.ok=this.status>=200&&this.status<300}}class Tt extends wt{constructor(de={}){super(de),this.type=ct.ResponseHeader}clone(de={}){return new Tt({headers:de.headers||this.headers,status:void 0!==de.status?de.status:this.status,statusText:de.statusText||this.statusText,url:de.url||this.url||void 0})}}class Ct extends wt{constructor(de={}){super(de),this.type=ct.Response,this.body=void 0!==de.body?de.body:null}clone(de={}){return new Ct({body:void 0!==de.body?de.body:this.body,headers:de.headers||this.headers,status:void 0!==de.status?de.status:this.status,statusText:de.statusText||this.statusText,url:de.url||this.url||void 0})}}class gt extends wt{constructor(de){super(de,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${de.url||"(unknown url)"}`:`Http failure response for ${de.url||"(unknown url)"}: ${de.status} ${de.statusText}`,this.error=de.error||null}}function Lt(et,de){return{body:de,headers:et.headers,context:et.context,observe:et.observe,params:et.params,reportProgress:et.reportProgress,responseType:et.responseType,withCredentials:et.withCredentials}}let Ht=(()=>{class et{constructor(Pe){this.handler=Pe}request(Pe,ft,Be={}){let $t;if(Pe instanceof Je)$t=Pe;else{let Ut,nn;Ut=Be.headers instanceof Z?Be.headers:new Z(Be.headers),Be.params&&(nn=Be.params instanceof je?Be.params:new je({fromObject:Be.params})),$t=new Je(Pe,ft,void 0!==Be.body?Be.body:null,{headers:Ut,context:Be.context,params:nn,reportProgress:Be.reportProgress,responseType:Be.responseType||"json",withCredentials:Be.withCredentials})}const xe=(0,V.of)($t).pipe((0,O.b)(Ut=>this.handler.handle(Ut)));if(Pe instanceof Je||"events"===Be.observe)return xe;const Ie=xe.pipe((0,A.h)(Ut=>Ut instanceof Ct));switch(Be.observe||"body"){case"body":switch($t.responseType){case"arraybuffer":return Ie.pipe((0,p.U)(Ut=>{if(null!==Ut.body&&!(Ut.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return Ut.body}));case"blob":return Ie.pipe((0,p.U)(Ut=>{if(null!==Ut.body&&!(Ut.body instanceof Blob))throw new Error("Response is not a Blob.");return Ut.body}));case"text":return Ie.pipe((0,p.U)(Ut=>{if(null!==Ut.body&&"string"!=typeof Ut.body)throw new Error("Response is not a string.");return Ut.body}));default:return Ie.pipe((0,p.U)(Ut=>Ut.body))}case"response":return Ie;default:throw new Error(`Unreachable: unhandled observe type ${Be.observe}}`)}}delete(Pe,ft={}){return this.request("DELETE",Pe,ft)}get(Pe,ft={}){return this.request("GET",Pe,ft)}head(Pe,ft={}){return this.request("HEAD",Pe,ft)}jsonp(Pe,ft){return this.request("JSONP",Pe,{params:(new je).append(ft,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Pe,ft={}){return this.request("OPTIONS",Pe,ft)}patch(Pe,ft,Be={}){return this.request("PATCH",Pe,Lt(Be,ft))}post(Pe,ft,Be={}){return this.request("POST",Pe,Lt(Be,ft))}put(Pe,ft,Be={}){return this.request("PUT",Pe,Lt(Be,ft))}}return et.\u0275fac=function(Pe){return new(Pe||et)(c.LFG(L))},et.\u0275prov=c.Yz7({token:et,factory:et.\u0275fac}),et})();class Vn{constructor(de,Pe){this.next=de,this.interceptor=Pe}handle(de){return this.interceptor.intercept(de,this.next)}}const Ft=new c.OlP("HTTP_INTERCEPTORS");let Wt=(()=>{class et{intercept(Pe,ft){return ft.handle(Pe)}}return et.\u0275fac=function(Pe){return new(Pe||et)},et.\u0275prov=c.Yz7({token:et,factory:et.\u0275fac}),et})();const ln=/^\)\]\}',?\n/;let Kt=(()=>{class et{constructor(Pe){this.xhrFactory=Pe}handle(Pe){if("JSONP"===Pe.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new a.y(ft=>{const Be=this.xhrFactory.build();if(Be.open(Pe.method,Pe.urlWithParams),Pe.withCredentials&&(Be.withCredentials=!0),Pe.headers.forEach((Ei,xi)=>Be.setRequestHeader(Ei,xi.join(","))),Pe.headers.has("Accept")||Be.setRequestHeader("Accept","application/json, text/plain, */*"),!Pe.headers.has("Content-Type")){const Ei=Pe.detectContentTypeHeader();null!==Ei&&Be.setRequestHeader("Content-Type",Ei)}if(Pe.responseType){const Ei=Pe.responseType.toLowerCase();Be.responseType="json"!==Ei?Ei:"text"}const $t=Pe.serializeBody();let xe=null;const Ie=()=>{if(null!==xe)return xe;const Ei=1223===Be.status?204:Be.status,xi=Be.statusText||"OK",vr=new Z(Be.getAllResponseHeaders()),ji=function Et(et){return"responseURL"in et&&et.responseURL?et.responseURL:/^X-Request-URL:/m.test(et.getAllResponseHeaders())?et.getResponseHeader("X-Request-URL"):null}(Be)||Pe.url;return xe=new Tt({headers:vr,status:Ei,statusText:xi,url:ji}),xe},Ut=()=>{let{headers:Ei,status:xi,statusText:vr,url:ji}=Ie(),Ir=null;204!==xi&&(Ir=void 0===Be.response?Be.responseText:Be.response),0===xi&&(xi=Ir?200:0);let $i=xi>=200&&xi<300;if("json"===Pe.responseType&&"string"==typeof Ir){const Gr=Ir;Ir=Ir.replace(ln,"");try{Ir=""!==Ir?JSON.parse(Ir):null}catch(eo){Ir=Gr,$i&&($i=!1,Ir={error:eo,text:Ir})}}$i?(ft.next(new Ct({body:Ir,headers:Ei,status:xi,statusText:vr,url:ji||void 0})),ft.complete()):ft.error(new gt({error:Ir,headers:Ei,status:xi,statusText:vr,url:ji||void 0}))},nn=Ei=>{const{url:xi}=Ie(),vr=new gt({error:Ei,status:Be.status||0,statusText:Be.statusText||"Unknown Error",url:xi||void 0});ft.error(vr)};let ni=!1;const cr=Ei=>{ni||(ft.next(Ie()),ni=!0);let xi={type:ct.DownloadProgress,loaded:Ei.loaded};Ei.lengthComputable&&(xi.total=Ei.total),"text"===Pe.responseType&&!!Be.responseText&&(xi.partialText=Be.responseText),ft.next(xi)},Li=Ei=>{let xi={type:ct.UploadProgress,loaded:Ei.loaded};Ei.lengthComputable&&(xi.total=Ei.total),ft.next(xi)};return Be.addEventListener("load",Ut),Be.addEventListener("error",nn),Be.addEventListener("timeout",nn),Be.addEventListener("abort",nn),Pe.reportProgress&&(Be.addEventListener("progress",cr),null!==$t&&Be.upload&&Be.upload.addEventListener("progress",Li)),Be.send($t),ft.next({type:ct.Sent}),()=>{Be.removeEventListener("error",nn),Be.removeEventListener("abort",nn),Be.removeEventListener("load",Ut),Be.removeEventListener("timeout",nn),Pe.reportProgress&&(Be.removeEventListener("progress",cr),null!==$t&&Be.upload&&Be.upload.removeEventListener("progress",Li)),Be.readyState!==Be.DONE&&Be.abort()}})}}return et.\u0275fac=function(Pe){return new(Pe||et)(c.LFG(d.JF))},et.\u0275prov=c.Yz7({token:et,factory:et.\u0275fac}),et})();const Hn=new c.OlP("XSRF_COOKIE_NAME"),In=new c.OlP("XSRF_HEADER_NAME");class ti{}let mi=(()=>{class et{constructor(Pe,ft,Be){this.doc=Pe,this.platform=ft,this.cookieName=Be,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Pe=this.doc.cookie||"";return Pe!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,d.Mx)(Pe,this.cookieName),this.lastCookieString=Pe),this.lastToken}}return et.\u0275fac=function(Pe){return new(Pe||et)(c.LFG(d.K0),c.LFG(c.Lbi),c.LFG(Hn))},et.\u0275prov=c.Yz7({token:et,factory:et.\u0275fac}),et})(),ir=(()=>{class et{constructor(Pe,ft){this.tokenService=Pe,this.headerName=ft}intercept(Pe,ft){const Be=Pe.url.toLowerCase();if("GET"===Pe.method||"HEAD"===Pe.method||Be.startsWith("http://")||Be.startsWith("https://"))return ft.handle(Pe);const $t=this.tokenService.getToken();return null!==$t&&!Pe.headers.has(this.headerName)&&(Pe=Pe.clone({headers:Pe.headers.set(this.headerName,$t)})),ft.handle(Pe)}}return et.\u0275fac=function(Pe){return new(Pe||et)(c.LFG(ti),c.LFG(In))},et.\u0275prov=c.Yz7({token:et,factory:et.\u0275fac}),et})(),_r=(()=>{class et{constructor(Pe,ft){this.backend=Pe,this.injector=ft,this.chain=null}handle(Pe){if(null===this.chain){const ft=this.injector.get(Ft,[]);this.chain=ft.reduceRight((Be,$t)=>new Vn(Be,$t),this.backend)}return this.chain.handle(Pe)}}return et.\u0275fac=function(Pe){return new(Pe||et)(c.LFG(Q),c.LFG(c.zs3))},et.\u0275prov=c.Yz7({token:et,factory:et.\u0275fac}),et})(),mr=(()=>{class et{static disable(){return{ngModule:et,providers:[{provide:ir,useClass:Wt}]}}static withOptions(Pe={}){return{ngModule:et,providers:[Pe.cookieName?{provide:Hn,useValue:Pe.cookieName}:[],Pe.headerName?{provide:In,useValue:Pe.headerName}:[]]}}}return et.\u0275fac=function(Pe){return new(Pe||et)},et.\u0275mod=c.oAB({type:et}),et.\u0275inj=c.cJS({providers:[ir,{provide:Ft,useExisting:ir,multi:!0},{provide:ti,useClass:mi},{provide:Hn,useValue:"XSRF-TOKEN"},{provide:In,useValue:"X-XSRF-TOKEN"}]}),et})(),Si=(()=>{class et{}return et.\u0275fac=function(Pe){return new(Pe||et)},et.\u0275mod=c.oAB({type:et}),et.\u0275inj=c.cJS({providers:[Ht,{provide:L,useClass:_r},Kt,{provide:Q,useExisting:Kt}],imports:[[mr.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),et})()},6738:(_n,Ke,k)=>{"use strict";k.d(Ke,{deG:()=>No,tb:()=>Qv,AFp:()=>Jv,ip1:()=>x_,CZH:()=>gh,hGG:()=>uw,z2F:()=>ef,sBO:()=>U1,Sil:()=>w_,_Vd:()=>Hp,EJc:()=>t0,SBq:()=>Wp,qLn:()=>iu,vpe:()=>xc,tBr:()=>Tr,XFs:()=>ft,OlP:()=>Kr,zs3:()=>fa,ZZ4:()=>Zm,aQg:()=>Vm,soG:()=>zm,YKP:()=>cv,h0i:()=>ph,PXZ:()=>O1,R0b:()=>rl,FiY:()=>Eo,Lbi:()=>Xv,g9A:()=>Kv,Qsj:()=>mb,FYo:()=>ov,JOm:()=>yl,tp0:()=>po,Rgc:()=>Xp,dDg:()=>o0,GfV:()=>sv,s_b:()=>Lm,ifc:()=>Ei,eFA:()=>l0,G48:()=>z1,Gpc:()=>Ae,_c5:()=>iw,VLi:()=>S1,c2e:()=>e0,zSh:()=>wp,wAp:()=>hr,vHH:()=>Ne,cg1:()=>Kg,kL8:()=>My,dqk:()=>$i,sIi:()=>bu,CqO:()=>Du,QGY:()=>ma,F4k:()=>qc,RDi:()=>St,AaK:()=>Ee,qOj:()=>Fs,TTD:()=>Mi,_Bn:()=>nv,xp6:()=>Jh,uIk:()=>jc,ekj:()=>Gg,Suo:()=>Mv,Xpm:()=>vt,lG2:()=>Wn,Yz7:()=>mi,cJS:()=>_r,oAB:()=>sn,Yjl:()=>ai,Y36:()=>ms,_UZ:()=>Oo,GkF:()=>Ms,BQk:()=>Cs,ynx:()=>_s,qZA:()=>Qo,TgZ:()=>fo,EpF:()=>os,n5z:()=>X,LFG:()=>Ki,$8M:()=>Fe,$Z:()=>So,NdJ:()=>Hc,CRH:()=>Sv,oxw:()=>oh,ALo:()=>vv,lcZ:()=>xv,xi3:()=>bv,Hsn:()=>sh,F$t:()=>Up,Q6J:()=>Xo,s9C:()=>sd,DdM:()=>pv,iGM:()=>Iv,MAs:()=>M,CHM:()=>Xl,LSH:()=>Mh,Udp:()=>jg,YNc:()=>b,_uU:()=>hy,Oqu:()=>Hg,hij:()=>Im,AsE:()=>Wg,lnq:()=>Yg,HOy:()=>Jg,Gf:()=>Av});var d=k(2916),c=k(2866),V=k(9146),a=k(3009),A=k(8929),p=k(2654),L=k(1762);class Z{constructor(o,l){this.subjectFactory=o,this.selector=l}call(o,l){const{selector:f}=this,v=this.subjectFactory(),w=f(v).subscribe(o);return w.add(l.subscribe(v)),w}}var z=k(4327);function G(){return new A.xQ}function ye(r){for(let o in r)if(r[o]===ye)return o;throw Error("Could not find renamed property on target object.")}function me(r,o){for(const l in o)o.hasOwnProperty(l)&&!r.hasOwnProperty(l)&&(r[l]=o[l])}function Ee(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(Ee).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const l=o.indexOf("\n");return-1===l?o:o.substring(0,l)}function je(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const rt=ye({__forward_ref__:ye});function Ae(r){return r.__forward_ref__=Ae,r.toString=function(){return Ee(this())},r}function Ze(r){return Ve(r)?r():r}function Ve(r){return"function"==typeof r&&r.hasOwnProperty(rt)&&r.__forward_ref__===Ae}class Ne extends Error{constructor(o,l){super(function xt(r,o){return`NG0${Math.abs(r)}${o?": "+o:""}`}(o,l)),this.code=o}}function Je(r){return"string"==typeof r?r:null==r?"":String(r)}function ct(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Je(r)}function gt(r,o){const l=o?` in ${o}`:"";throw new Ne(-201,`No provider for ${ct(r)} found${l}`)}function Et(r,o){null==r&&function Kt(r,o,l,f){throw new Error(`ASSERTION ERROR: ${r}`+(null==f?"":` [Expected=> ${l} ${f} ${o} <=Actual]`))}(o,r,null,"!=")}function mi(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function _r(r){return{providers:r.providers||[],imports:r.imports||[]}}function er(r){return Ri(r,Qt)||Ri(r,de)}function Ri(r,o){return r.hasOwnProperty(o)?r[o]:null}function ki(r){return r&&(r.hasOwnProperty(et)||r.hasOwnProperty(Pe))?r[et]:null}const Qt=ye({\u0275prov:ye}),et=ye({\u0275inj:ye}),de=ye({ngInjectableDef:ye}),Pe=ye({ngInjectorDef:ye});var ft=(()=>((ft=ft||{})[ft.Default=0]="Default",ft[ft.Host=1]="Host",ft[ft.Self=2]="Self",ft[ft.SkipSelf=4]="SkipSelf",ft[ft.Optional=8]="Optional",ft))();let Be;function xe(r){const o=Be;return Be=r,o}function Ie(r,o,l){const f=er(r);return f&&"root"==f.providedIn?void 0===f.value?f.value=f.factory():f.value:l&ft.Optional?null:void 0!==o?o:void gt(Ee(r),"Injector")}function nn(r){return{toString:r}.toString()}var ni=(()=>((ni=ni||{})[ni.OnPush=0]="OnPush",ni[ni.Default=1]="Default",ni))(),Ei=(()=>{return(r=Ei||(Ei={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",Ei;var r})();const xi="undefined"!=typeof globalThis&&globalThis,vr="undefined"!=typeof window&&window,ji="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,$i=xi||"undefined"!=typeof global&&global||vr||ji,zr={},Xi=[],ur=ye({\u0275cmp:ye}),re=ye({\u0275dir:ye}),K=ye({\u0275pipe:ye}),F=ye({\u0275mod:ye}),fe=ye({\u0275fac:ye}),_e=ye({__NG_ELEMENT_ID__:ye});let Qe=0;function vt(r){return nn(()=>{const l={},f={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:l,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===ni.OnPush,directiveDefs:null,pipeDefs:null,selectors:r.selectors||Xi,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||Ei.Emulated,id:"c",styles:r.styles||Xi,_:null,setInput:null,schemas:r.schemas||null,tView:null},v=r.directives,w=r.features,S=r.pipes;return f.id+=Qe++,f.inputs=Nn(r.inputs,l),f.outputs=Nn(r.outputs),w&&w.forEach(U=>U(f)),f.directiveDefs=v?()=>("function"==typeof v?v():v).map(tt):null,f.pipeDefs=S?()=>("function"==typeof S?S():S).map(Zt):null,f})}function tt(r){return Kn(r)||function ui(r){return r[re]||null}(r)}function Zt(r){return function Qi(r){return r[K]||null}(r)}const on={};function sn(r){return nn(()=>{const o={type:r.type,bootstrap:r.bootstrap||Xi,declarations:r.declarations||Xi,imports:r.imports||Xi,exports:r.exports||Xi,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null};return null!=r.id&&(on[r.id]=r.type),o})}function Nn(r,o){if(null==r)return zr;const l={};for(const f in r)if(r.hasOwnProperty(f)){let v=r[f],w=v;Array.isArray(v)&&(w=v[1],v=v[0]),l[v]=f,o&&(o[v]=w)}return l}const Wn=vt;function ai(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,onDestroy:r.type.prototype.ngOnDestroy||null}}function Kn(r){return r[ur]||null}function Hi(r,o){const l=r[F]||null;if(!l&&!0===o)throw new Error(`Type ${Ee(r)} does not have '\u0275mod' property.`);return l}function hn(r){return Array.isArray(r)&&"object"==typeof r[1]}function qi(r){return Array.isArray(r)&&!0===r[1]}function no(r){return 0!=(8&r.flags)}function rr(r){return 2==(2&r.flags)}function Br(r){return 1==(1&r.flags)}function pr(r){return null!==r.template}function Lo(r){return 0!=(512&r[2])}function oi(r,o){return r.hasOwnProperty(fe)?r[fe]:null}class Pi{constructor(o,l,f){this.previousValue=o,this.currentValue=l,this.firstChange=f}isFirstChange(){return this.firstChange}}function Mi(){return bi}function bi(r){return r.type.prototype.ngOnChanges&&(r.setInput=Di),gr}function gr(){const r=dr(this),o=r?.current;if(o){const l=r.previous;if(l===zr)r.previous=o;else for(let f in o)l[f]=o[f];r.current=null,this.ngOnChanges(o)}}function Di(r,o,l,f){const v=dr(r)||function nr(r,o){return r[Ci]=o}(r,{previous:zr,current:null}),w=v.current||(v.current={}),S=v.previous,U=this.declaredInputs[l],q=S[U];w[U]=new Pi(q&&q.currentValue,o,S===zr),r[f]=o}Mi.ngInherit=!0;const Ci="__ngSimpleChanges__";function dr(r){return r[Ci]||null}let ze;function St(r){ze=r}function Yn(r){return!!r.listen}const Mr={createRenderer:(r,o)=>function tn(){return void 0!==ze?ze:"undefined"!=typeof document?document:void 0}()};function Zi(r){for(;Array.isArray(r);)r=r[0];return r}function le(r,o){return Zi(o[r])}function ee(r,o){return Zi(o[r.index])}function Ue(r,o){return r.data[o]}function pn(r,o){return r[o]}function ri(r,o){const l=o[r];return hn(l)?l:l[0]}function Yr(r){return 4==(4&r[2])}function Jr(r){return 128==(128&r[2])}function jo(r,o){return null==o?null:r[o]}function zs(r){r[18]=0}function Ps(r,o){r[5]+=o;let l=r,f=r[3];for(;null!==f&&(1===o&&1===l[5]||-1===o&&0===l[5]);)f[5]+=o,l=f,f=f[3]}const tr={lFrame:ps(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function sl(){return tr.bindingsEnabled}function Rn(){return tr.lFrame.lView}function Dr(){return tr.lFrame.tView}function Xl(r){return tr.lFrame.contextLView=r,r[8]}function Zo(){let r=_a();for(;null!==r&&64===r.type;)r=r.parent;return r}function _a(){return tr.lFrame.currentTNode}function hs(r,o){const l=tr.lFrame;l.currentTNode=r,l.isParent=o}function ya(){return tr.lFrame.isParent}function Oa(){tr.lFrame.isParent=!1}function Ds(){return tr.isInCheckNoChangesMode}function qs(r){tr.isInCheckNoChangesMode=r}function ts(){const r=tr.lFrame;let o=r.bindingRootIndex;return-1===o&&(o=r.bindingRootIndex=r.tView.bindingStartIndex),o}function To(){return tr.lFrame.bindingIndex}function W(){return tr.lFrame.bindingIndex++}function E(r){const o=tr.lFrame,l=o.bindingIndex;return o.bindingIndex=o.bindingIndex+r,l}function Pt(r,o){const l=tr.lFrame;l.bindingIndex=l.bindingRootIndex=r,Qn(o)}function Qn(r){tr.lFrame.currentDirectiveIndex=r}function wi(){return tr.lFrame.currentQueryIndex}function br(r){tr.lFrame.currentQueryIndex=r}function Vr(r){const o=r[1];return 2===o.type?o.declTNode:1===o.type?r[6]:null}function ro(r,o,l){if(l&ft.SkipSelf){let v=o,w=r;for(;!(v=v.parent,null!==v||l&ft.Host||(v=Vr(w),null===v||(w=w[15],10&v.type))););if(null===v)return!1;o=v,r=w}const f=tr.lFrame=ss();return f.currentTNode=o,f.lView=r,!0}function Fo(r){const o=ss(),l=r[1];tr.lFrame=o,o.currentTNode=l.firstChild,o.lView=r,o.tView=l,o.contextLView=r,o.bindingIndex=l.bindingStartIndex,o.inI18n=!1}function ss(){const r=tr.lFrame,o=null===r?null:r.child;return null===o?ps(r):o}function ps(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function al(){const r=tr.lFrame;return tr.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Il=al;function Ra(){const r=al();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function as(){return tr.lFrame.selectedIndex}function Us(r){tr.lFrame.selectedIndex=r}function Co(){const r=tr.lFrame;return Ue(r.tView,r.selectedIndex)}function kr(r,o){for(let l=o.directiveStart,f=o.directiveEnd;l<f;l++){const w=r.data[l].type.prototype,{ngAfterContentInit:S,ngAfterContentChecked:U,ngAfterViewInit:q,ngAfterViewChecked:ve,ngOnDestroy:De}=w;S&&(r.contentHooks||(r.contentHooks=[])).push(-l,S),U&&((r.contentHooks||(r.contentHooks=[])).push(l,U),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(l,U)),q&&(r.viewHooks||(r.viewHooks=[])).push(-l,q),ve&&((r.viewHooks||(r.viewHooks=[])).push(l,ve),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(l,ve)),null!=De&&(r.destroyHooks||(r.destroyHooks=[])).push(l,De)}}function La(r,o,l){Ho(r,o,3,l)}function la(r,o,l,f){(3&r[2])===l&&Ho(r,o,l,f)}function va(r,o){let l=r[2];(3&l)===o&&(l&=2047,l+=1,r[2]=l)}function Ho(r,o,l,f){const w=f??-1,S=o.length-1;let U=0;for(let q=void 0!==f?65535&r[18]:0;q<S;q++)if("number"==typeof o[q+1]){if(U=o[q],null!=f&&U>=f)break}else o[q]<0&&(r[18]+=65536),(U<w||-1==w)&&(ec(r,l,o,q),r[18]=(4294901760&r[18])+q+2),q++}function ec(r,o,l,f){const v=l[f]<0,w=l[f+1],U=r[v?-l[f]:l[f]];if(v){if(r[2]>>11<r[18]>>16&&(3&r[2])===o){r[2]+=2048;try{w.call(U)}finally{}}}else try{w.call(U)}finally{}}class Fa{constructor(o,l,f){this.factory=o,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=f}}function Na(r,o,l){const f=Yn(r);let v=0;for(;v<l.length;){const w=l[v];if("number"==typeof w){if(0!==w)break;v++;const S=l[v++],U=l[v++],q=l[v++];f?r.setAttribute(o,U,q,S):o.setAttributeNS(S,U,q)}else{const S=w,U=l[++v];xa(S)?f&&r.setProperty(o,S,U):f?r.setAttribute(o,S,U):o.setAttribute(S,U),v++}}return v}function ls(r){return 3===r||4===r||6===r}function xa(r){return 64===r.charCodeAt(0)}function za(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let l=-1;for(let f=0;f<o.length;f++){const v=o[f];"number"==typeof v?l=v:0===l||Ys(r,l,v,null,-1===l||2===l?o[++f]:null)}}return r}function Ys(r,o,l,f,v){let w=0,S=r.length;if(-1===o)S=-1;else for(;w<r.length;){const U=r[w++];if("number"==typeof U){if(U===o){S=-1;break}if(U>o){S=w-1;break}}}for(;w<r.length;){const U=r[w];if("number"==typeof U)break;if(U===l){if(null===f)return void(null!==v&&(r[w+1]=v));if(f===r[w+1])return void(r[w+2]=v)}w++,null!==f&&w++,null!==v&&w++}-1!==S&&(r.splice(S,0,o),w=S+1),r.splice(w++,0,l),null!==f&&r.splice(w++,0,f),null!==v&&r.splice(w++,0,v)}function Js(r){return-1!==r}function ba(r){return 32767&r}function ca(r,o){let l=function Al(r){return r>>16}(r),f=o;for(;l>0;)f=f[15],l--;return f}let Ua=!0;function wa(r){const o=Ua;return Ua=r,o}let Jc=0;function Ca(r,o){const l=tc(r,o);if(-1!==l)return l;const f=o[1];f.firstCreatePass&&(r.injectorIndex=o.length,Ml(f.data,r),Ml(o,null),Ml(f.blueprint,null));const v=Sl(r,o),w=r.injectorIndex;if(Js(v)){const S=ba(v),U=ca(v,o),q=U[1].data;for(let ve=0;ve<8;ve++)o[w+ve]=U[S+ve]|q[S+ve]}return o[w+8]=v,w}function Ml(r,o){r.push(0,0,0,0,0,0,0,0,o)}function tc(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function Sl(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let l=0,f=null,v=o;for(;null!==v;){const w=v[1],S=w.type;if(f=2===S?w.declTNode:1===S?v[6]:null,null===f)return-1;if(l++,v=v[15],-1!==f.injectorIndex)return f.injectorIndex|l<<16}return-1}function Za(r,o,l){!function Ic(r,o,l){let f;"string"==typeof l?f=l.charCodeAt(0)||0:l.hasOwnProperty(_e)&&(f=l[_e]),null==f&&(f=l[_e]=Jc++);const v=255&f;o.data[r+(v>>5)]|=1<<v}(r,o,l)}function Ac(r,o,l){if(l&ft.Optional)return r;gt(o,"NodeInjector")}function dl(r,o,l,f){if(l&ft.Optional&&void 0===f&&(f=null),0==(l&(ft.Self|ft.Host))){const v=r[9],w=xe(void 0);try{return v?v.get(o,f,l&ft.Optional):Ie(o,f,l&ft.Optional)}finally{xe(w)}}return Ac(f,o,l)}function Mc(r,o,l,f=ft.Default,v){if(null!==r){const w=function Kc(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(_e)?r[_e]:void 0;return"number"==typeof o?o>=0?255&o:kl:o}(l);if("function"==typeof w){if(!ro(o,r,f))return f&ft.Host?Ac(v,l,f):dl(o,l,f,v);try{const S=w(f);if(null!=S||f&ft.Optional)return S;gt(l)}finally{Il()}}else if("number"==typeof w){let S=null,U=tc(r,o),q=-1,ve=f&ft.Host?o[16][6]:null;for((-1===U||f&ft.SkipSelf)&&(q=-1===U?Sl(r,o):o[U+8],-1!==q&&R(f,!1)?(S=o[1],U=ba(q),o=ca(q,o)):U=-1);-1!==U;){const De=o[1];if($(w,U,De.data)){const ot=hl(U,o,l,S,f,ve);if(ot!==Pl)return ot}q=o[U+8],-1!==q&&R(f,o[1].data[U+8]===ve)&&$(w,U,o)?(S=De,U=ba(q),o=ca(q,o)):U=-1}}}return dl(o,l,f,v)}const Pl={};function kl(){return new P(Zo(),Rn())}function hl(r,o,l,f,v,w){const S=o[1],U=S.data[r+8],De=Va(U,S,l,null==f?rr(U)&&Ua:f!=S&&0!=(3&U.type),v&ft.Host&&w===U);return null!==De?pl(o,S,De,U):Pl}function Va(r,o,l,f,v){const w=r.providerIndexes,S=o.data,U=1048575&w,q=r.directiveStart,De=w>>20,Ot=v?U+De:r.directiveEnd;for(let Yt=f?U:U+De;Yt<Ot;Yt++){const Mn=S[Yt];if(Yt<q&&l===Mn||Yt>=q&&Mn.type===l)return Yt}if(v){const Yt=S[q];if(Yt&&pr(Yt)&&Yt.type===l)return q}return null}function pl(r,o,l,f){let v=r[l];const w=o.data;if(function Au(r){return r instanceof Fa}(v)){const S=v;S.resolving&&function wt(r,o){const l=o?`. Dependency path: ${o.join(" > ")} > ${r}`:"";throw new Ne(-200,`Circular dependency in DI detected for ${r}${l}`)}(ct(w[l]));const U=wa(S.canSeeViewProviders);S.resolving=!0;const q=S.injectImpl?xe(S.injectImpl):null;ro(r,f,ft.Default);try{v=r[l]=S.factory(void 0,w,r,f),o.firstCreatePass&&l>=f.directiveStart&&function Tc(r,o,l){const{ngOnChanges:f,ngOnInit:v,ngDoCheck:w}=o.type.prototype;if(f){const S=bi(o);(l.preOrderHooks||(l.preOrderHooks=[])).push(r,S),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,S)}v&&(l.preOrderHooks||(l.preOrderHooks=[])).push(0-r,v),w&&((l.preOrderHooks||(l.preOrderHooks=[])).push(r,w),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,w))}(l,w[l],o)}finally{null!==q&&xe(q),wa(U),S.resolving=!1,Il()}}return v}function $(r,o,l){return!!(l[o+(r>>5)]&1<<r)}function R(r,o){return!(r&ft.Self||r&ft.Host&&o)}class P{constructor(o,l){this._tNode=o,this._lView=l}get(o,l,f){return Mc(this._tNode,this._lView,o,f,l)}}function X(r){return nn(()=>{const o=r.prototype.constructor,l=o[fe]||he(o),f=Object.prototype;let v=Object.getPrototypeOf(r.prototype).constructor;for(;v&&v!==f;){const w=v[fe]||he(v);if(w&&w!==l)return w;v=Object.getPrototypeOf(v)}return w=>new w})}function he(r){return Ve(r)?()=>{const o=he(Ze(r));return o&&o()}:oi(r)}function Fe(r){return function nc(r,o){if("class"===o)return r.classes;if("style"===o)return r.styles;const l=r.attrs;if(l){const f=l.length;let v=0;for(;v<f;){const w=l[v];if(ls(w))break;if(0===w)v+=2;else if("number"==typeof w)for(v++;v<f&&"string"==typeof l[v];)v++;else{if(w===o)return l[v+1];v+=2}}}return null}(Zo(),r)}const It="__parameters__";function Ji(r,o,l){return nn(()=>{const f=function ao(r){return function(...l){if(r){const f=r(...l);for(const v in f)this[v]=f[v]}}}(o);function v(...w){if(this instanceof v)return f.apply(this,w),this;const S=new v(...w);return U.annotation=S,U;function U(q,ve,De){const ot=q.hasOwnProperty(It)?q[It]:Object.defineProperty(q,It,{value:[]})[It];for(;ot.length<=De;)ot.push(null);return(ot[De]=ot[De]||[]).push(S),q}}return l&&(v.prototype=Object.create(l.prototype)),v.prototype.ngMetadataName=r,v.annotationCls=v,v})}class Kr{constructor(o,l){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=mi({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}toString(){return`InjectionToken ${this._desc}`}}const No=new Kr("AnalyzeForEntryComponents");function T(r,o){void 0===o&&(o=r);for(let l=0;l<r.length;l++){let f=r[l];Array.isArray(f)?(o===r&&(o=r.slice(0,l)),T(f,o)):o!==r&&o.push(f)}return o}function I(r,o){r.forEach(l=>Array.isArray(l)?I(l,o):o(l))}function B(r,o,l){o>=r.length?r.push(l):r.splice(o,0,l)}function J(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}function oe(r,o){const l=[];for(let f=0;f<r;f++)l.push(o);return l}function mt(r,o,l){let f=dt(r,o);return f>=0?r[1|f]=l:(f=~f,function Re(r,o,l,f){let v=r.length;if(v==o)r.push(l,f);else if(1===v)r.push(f,r[0]),r[0]=l;else{for(v--,r.push(r[v-1],r[v]);v>o;)r[v]=r[v-2],v--;r[o]=l,r[o+1]=f}}(r,f,o,l)),f}function Ge(r,o){const l=dt(r,o);if(l>=0)return r[1|l]}function dt(r,o){return function lt(r,o,l){let f=0,v=r.length>>l;for(;v!==f;){const w=f+(v-f>>1),S=r[w<<l];if(o===S)return w<<l;S>o?v=w:f=w+1}return~(v<<l)}(r,o,1)}const Cn={},bn="__NG_DI_FLAG__",Ti="ngTempTokenPath",wr=/\n/gm,Fi="__source",ar=ye({provide:String,useValue:ye});let Xr;function xo(r){const o=Xr;return Xr=r,o}function or(r,o=ft.Default){if(void 0===Xr)throw new Ne(203,"");return null===Xr?Ie(r,void 0,o):Xr.get(r,o&ft.Optional?null:void 0,o)}function Ki(r,o=ft.Default){return(function $t(){return Be}()||or)(Ze(r),o)}function vs(r){const o=[];for(let l=0;l<r.length;l++){const f=Ze(r[l]);if(Array.isArray(f)){if(0===f.length)throw new Ne(900,"");let v,w=ft.Default;for(let S=0;S<f.length;S++){const U=f[S],q=ua(U);"number"==typeof q?-1===q?v=U.token:w|=q:v=U}o.push(Ki(v,w))}else o.push(Ki(f))}return o}function xs(r,o){return r[bn]=o,r.prototype[bn]=o,r}function ua(r){return r[bn]}const Tr=xs(Ji("Inject",r=>({token:r})),-1),Eo=xs(Ji("Optional"),8),po=xs(Ji("SkipSelf"),4);class Qs{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}function fl(r){return r instanceof Qs?r.changingThisBreaksApplicationSecurity:r}const uf=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,df=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;var Po=(()=>((Po=Po||{})[Po.NONE=0]="NONE",Po[Po.HTML=1]="HTML",Po[Po.STYLE=2]="STYLE",Po[Po.SCRIPT=3]="SCRIPT",Po[Po.URL=4]="URL",Po[Po.RESOURCE_URL=5]="RESOURCE_URL",Po))();function Mh(r){const o=function yr(){const r=Rn();return r&&r[12]}();return o?o.sanitize(Po.URL,r)||"":function Da(r,o){const l=function fd(r){return r instanceof Qs&&r.getTypeName()||null}(r);if(null!=l&&l!==o){if("ResourceURL"===l&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${l} (see https://g.co/ng/security#xss)`)}return l===o}(r,"URL")?fl(r):function Lu(r){return(r=String(r)).match(uf)||r.match(df)?r:"unsafe:"+r}(Je(r))}const Sh="__ngContext__";function Is(r,o){r[Sh]=o}function sc(r){const o=function gl(r){return r[Sh]||null}(r);return o?Array.isArray(o)?o:o.lView:null}function Ul(r){return r.ngOriginalError}function kh(r,...o){r.error(...o)}class iu{constructor(){this._console=console}handleError(o){const l=this._findOriginalError(o),f=function xd(r){return r&&r.ngErrorLogger||kh}(o);f(this._console,"ERROR",o),l&&f(this._console,"ORIGINAL ERROR",l)}_findOriginalError(o){let l=o&&Ul(o);for(;l&&Ul(l);)l=Ul(l);return l||null}}const xf=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind($i))();function _l(r){return r instanceof Function?r():r}var yl=(()=>((yl=yl||{})[yl.Important=1]="Important",yl[yl.DashCase=2]="DashCase",yl))();function Rh(r,o){return undefined(r,o)}function kc(r){const o=r[3];return qi(o)?o[3]:o}function vl(r){return Tf(r[13])}function Vs(r){return Tf(r[4])}function Tf(r){for(;null!==r&&!qi(r);)r=r[4];return r}function su(r,o,l,f,v){if(null!=f){let w,S=!1;qi(f)?w=f:hn(f)&&(S=!0,f=f[0]);const U=Zi(f);0===r&&null!==l?null==v?Vo(o,l,U):Rc(o,l,U,v||null,!0):1===r&&null!==l?Rc(o,l,U,v||null,!0):2===r?function Pf(r,o,l){const f=Lc(r,o);f&&function Sf(r,o,l,f){Yn(r)?r.removeChild(o,l,f):o.removeChild(l)}(r,f,o,l)}(o,U,S):3===r&&o.destroyNode(U),null!=w&&function Pd(r,o,l,f,v){const w=l[7];w!==Zi(l)&&su(o,r,f,w,v);for(let U=10;U<l.length;U++){const q=l[U];Zu(q[1],q,r,o,f,w)}}(o,r,w,l,v)}}function Nh(r,o,l){if(Yn(r))return r.createElement(o,l);{const f=null!==l?function ae(r){const o=r.toLowerCase();return"svg"===o?"http://www.w3.org/2000/svg":"math"===o?"http://www.w3.org/1998/MathML/":null}(l):null;return null===f?r.createElement(o):r.createElementNS(f,o)}}function If(r,o){const l=r[9],f=l.indexOf(o),v=o[3];1024&o[2]&&(o[2]&=-1025,Ps(v,-1)),l.splice(f,1)}function zh(r,o){if(r.length<=10)return;const l=10+o,f=r[l];if(f){const v=f[17];null!==v&&v!==r&&If(v,f),o>0&&(r[l-1][4]=f[4]);const w=J(r,10+o);!function Dd(r,o){Zu(r,o,o[11],2,null,null),o[0]=null,o[6]=null}(f[1],f);const S=w[19];null!==S&&S.detachView(w[1]),f[3]=null,f[4]=null,f[2]&=-129}return f}function Af(r,o){if(!(256&o[2])){const l=o[11];Yn(l)&&l.destroyNode&&Zu(r,o,l,3,null,null),function Nu(r){let o=r[13];if(!o)return Uh(r[1],r);for(;o;){let l=null;if(hn(o))l=o[13];else{const f=o[10];f&&(l=f)}if(!l){for(;o&&!o[4]&&o!==r;)hn(o)&&Uh(o[1],o),o=o[3];null===o&&(o=r),hn(o)&&Uh(o[1],o),l=o&&o[4]}o=l}}(o)}}function Uh(r,o){if(!(256&o[2])){o[2]&=-129,o[2]|=256,function Zh(r,o){let l;if(null!=r&&null!=(l=r.destroyHooks))for(let f=0;f<l.length;f+=2){const v=o[l[f]];if(!(v instanceof Fa)){const w=l[f+1];if(Array.isArray(w))for(let S=0;S<w.length;S+=2){const U=v[w[S]],q=w[S+1];try{q.call(U)}finally{}}else try{w.call(v)}finally{}}}}(r,o),function ug(r,o){const l=r.cleanup,f=o[7];let v=-1;if(null!==l)for(let w=0;w<l.length-1;w+=2)if("string"==typeof l[w]){const S=l[w+1],U="function"==typeof S?S(o):Zi(o[S]),q=f[v=l[w+2]],ve=l[w+3];"boolean"==typeof ve?U.removeEventListener(l[w],q,ve):ve>=0?f[v=ve]():f[v=-ve].unsubscribe(),w+=2}else{const S=f[v=l[w+1]];l[w].call(S)}if(null!==f){for(let w=v+1;w<f.length;w++)f[w]();o[7]=null}}(r,o),1===o[1].type&&Yn(o[11])&&o[11].destroy();const l=o[17];if(null!==l&&qi(o[3])){l!==o[3]&&If(l,o);const f=o[19];null!==f&&f.detachView(r)}}}function Mf(r,o,l){return function Oc(r,o,l){let f=o;for(;null!==f&&40&f.type;)f=(o=f).parent;if(null===f)return l[0];if(2&f.flags){const v=r.data[f.directiveStart].encapsulation;if(v===Ei.None||v===Ei.Emulated)return null}return ee(f,l)}(r,o.parent,l)}function Rc(r,o,l,f,v){Yn(r)?r.insertBefore(o,l,f,v):o.insertBefore(l,f,v)}function Vo(r,o,l){Yn(r)?r.appendChild(o,l):o.appendChild(l)}function zu(r,o,l,f,v){null!==f?Rc(r,o,l,f,v):Vo(r,o,l)}function Lc(r,o){return Yn(r)?r.parentNode(o):o.parentNode}function au(r,o,l){return $h(r,o,l)}let $h=function Vh(r,o,l){return 40&r.type?ee(r,l):null};function lu(r,o,l,f){const v=Mf(r,f,o),w=o[11],U=au(f.parent||o[6],f,o);if(null!=v)if(Array.isArray(l))for(let q=0;q<l.length;q++)zu(w,v,l[q],U,!1);else zu(w,v,l,U,!1)}function Md(r,o){if(null!==o){const l=o.type;if(3&l)return ee(o,r);if(4&l)return Bc(-1,r[o.index]);if(8&l){const f=o.child;if(null!==f)return Md(r,f);{const v=r[o.index];return qi(v)?Bc(-1,v):Zi(v)}}if(32&l)return Rh(o,r)()||Zi(r[o.index]);{const f=jh(r,o);return null!==f?Array.isArray(f)?f[0]:Md(kc(r[16]),f):Md(r,o.next)}}return null}function jh(r,o){return null!==o?r[16][6].projection[o.projection]:null}function Bc(r,o){const l=10+r+1;if(l<o.length){const f=o[l],v=f[1].firstChild;if(null!==v)return Md(f,v)}return o[7]}function Uu(r,o,l,f,v,w,S){for(;null!=l;){const U=f[l.index],q=l.type;if(S&&0===o&&(U&&Is(Zi(U),f),l.flags|=4),64!=(64&l.flags))if(8&q)Uu(r,o,l.child,f,v,w,!1),su(o,r,v,U,w);else if(32&q){const ve=Rh(l,f);let De;for(;De=ve();)su(o,r,v,De,w);su(o,r,v,U,w)}else 16&q?Sd(r,o,f,l,v,w):su(o,r,v,U,w);l=S?l.projectionNext:l.next}}function Zu(r,o,l,f,v,w){Uu(l,f,r.firstChild,o,v,w,!1)}function Sd(r,o,l,f,v,w){const S=l[16],q=S[6].projection[f.projection];if(Array.isArray(q))for(let ve=0;ve<q.length;ve++)su(o,r,v,q[ve],w);else Uu(r,o,q,S[3],v,w,!0)}function kf(r,o,l){Yn(r)?r.setAttribute(o,"style",l):o.style.cssText=l}function qh(r,o,l){Yn(r)?""===l?r.removeAttribute(o,"class"):r.setAttribute(o,"class",l):o.className=l}function Of(r,o,l){let f=r.length;for(;;){const v=r.indexOf(o,l);if(-1===v)return v;if(0===v||r.charCodeAt(v-1)<=32){const w=o.length;if(v+w===f||r.charCodeAt(v+w)<=32)return v}l=v+1}}const Hh="ng-template";function cu(r,o,l){let f=0;for(;f<r.length;){let v=r[f++];if(l&&"class"===v){if(v=r[f],-1!==Of(v.toLowerCase(),o,0))return!0}else if(1===v){for(;f<r.length&&"string"==typeof(v=r[f++]);)if(v.toLowerCase()===o)return!0;return!1}}return!1}function Rf(r){return 4===r.type&&r.value!==Hh}function hg(r,o,l){return o===(4!==r.type||l?r.value:Hh)}function Lf(r,o,l){let f=4;const v=r.attrs||[],w=function fg(r){for(let o=0;o<r.length;o++)if(ls(r[o]))return o;return r.length}(v);let S=!1;for(let U=0;U<o.length;U++){const q=o[U];if("number"!=typeof q){if(!S)if(4&f){if(f=2|1&f,""!==q&&!hg(r,q,l)||""===q&&1===o.length){if(Aa(f))return!1;S=!0}}else{const ve=8&f?q:o[++U];if(8&f&&null!==r.attrs){if(!cu(r.attrs,ve,l)){if(Aa(f))return!1;S=!0}continue}const ot=pg(8&f?"class":q,v,Rf(r),l);if(-1===ot){if(Aa(f))return!1;S=!0;continue}if(""!==ve){let Ot;Ot=ot>w?"":v[ot+1].toLowerCase();const Yt=8&f?Ot:null;if(Yt&&-1!==Of(Yt,ve,0)||2&f&&ve!==Ot){if(Aa(f))return!1;S=!0}}}}else{if(!S&&!Aa(f)&&!Aa(q))return!1;if(S&&Aa(q))continue;S=!1,f=q|1&f}}return Aa(f)||S}function Aa(r){return 0==(1&r)}function pg(r,o,l,f){if(null===o)return-1;let v=0;if(f||!l){let w=!1;for(;v<o.length;){const S=o[v];if(S===r)return v;if(3===S||6===S)w=!0;else{if(1===S||2===S){let U=o[++v];for(;"string"==typeof U;)U=o[++v];continue}if(4===S)break;if(0===S){v+=4;continue}}v+=w?1:2}return-1}return function mg(r,o){let l=r.indexOf(4);if(l>-1)for(l++;l<r.length;){const f=r[l];if("number"==typeof f)return-1;if(f===o)return l;l++}return-1}(o,r)}function Ff(r,o,l=!1){for(let f=0;f<o.length;f++)if(Lf(r,o[f],l))return!0;return!1}function Vu(r,o){e:for(let l=0;l<o.length;l++){const f=o[l];if(r.length===f.length){for(let v=0;v<r.length;v++)if(r[v]!==f[v])continue e;return!0}}return!1}function Wh(r,o){return r?":not("+o.trim()+")":o}function Yh(r){let o=r[0],l=1,f=2,v="",w=!1;for(;l<r.length;){let S=r[l];if("string"==typeof S)if(2&f){const U=r[++l];v+="["+S+(U.length>0?'="'+U+'"':"")+"]"}else 8&f?v+="."+S:4&f&&(v+=" "+S);else""!==v&&!Aa(S)&&(o+=Wh(w,v),v=""),f=S,w=w||!Aa(f);l++}return""!==v&&(o+=Wh(w,v)),o}const fr={};function Jh(r){Kh(Dr(),Rn(),as()+r,Ds())}function Kh(r,o,l,f){if(!f)if(3==(3&o[2])){const w=r.preOrderCheckHooks;null!==w&&La(o,w,l)}else{const w=r.preOrderHooks;null!==w&&la(o,w,0,l)}Us(l)}function kd(r,o){return r<<17|o<<2}function Ja(r){return r>>17&32767}function Xh(r){return 2|r}function Zl(r){return(131068&r)>>2}function uu(r,o){return-131069&r|o<<2}function Od(r){return 1|r}function Nd(r,o){const l=r.contentQueries;if(null!==l)for(let f=0;f<l.length;f+=2){const v=l[f],w=l[f+1];if(-1!==w){const S=r.data[w];br(v),S.contentQueries(2,o[w],w)}}}function $l(r,o,l,f,v,w,S,U,q,ve){const De=o.blueprint.slice();return De[0]=v,De[2]=140|f,zs(De),De[3]=De[15]=r,De[8]=l,De[10]=S||r&&r[10],De[11]=U||r&&r[11],De[12]=q||r&&r[12]||null,De[9]=ve||r&&r[9]||null,De[6]=w,De[16]=2==o.type?r[16]:De,De}function Ka(r,o,l,f,v){let w=r.data[o];if(null===w)w=function Gu(r,o,l,f,v){const w=_a(),S=ya(),q=r.data[o]=function Jf(r,o,l,f,v,w){return{type:l,index:f,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:v,attrs:w,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,S?w:w&&w.parent,l,o,f,v);return null===r.firstChild&&(r.firstChild=q),null!==w&&(S?null==w.child&&null!==q.parent&&(w.child=q):null===w.next&&(w.next=q)),q}(r,o,l,f,v),function Y(){return tr.lFrame.inI18n}()&&(w.flags|=64);else if(64&w.type){w.type=l,w.value=f,w.attrs=v;const S=function Gs(){const r=tr.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}();w.injectorIndex=null===S?-1:S.injectorIndex}return hs(w,!0),w}function jl(r,o,l,f){if(0===l)return-1;const v=o.length;for(let w=0;w<l;w++)o.push(f),r.blueprint.push(f),r.data.push(null);return v}function qu(r,o,l){Fo(o);try{const f=r.viewQuery;null!==f&&_u(1,f,l);const v=r.template;null!==v&&Yf(r,o,v,1,l),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&Nd(r,o),r.staticViewQueries&&_u(2,r.viewQuery,l);const w=r.components;null!==w&&function pa(r,o){for(let l=0;l<o.length;l++)Fg(r,o[l])}(o,w)}catch(f){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),f}finally{o[2]&=-5,Ra()}}function Uc(r,o,l,f){const v=o[2];if(256==(256&v))return;Fo(o);const w=Ds();try{zs(o),function D(r){return tr.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==l&&Yf(r,o,l,2,f);const S=3==(3&v);if(!w)if(S){const ve=r.preOrderCheckHooks;null!==ve&&La(o,ve,null)}else{const ve=r.preOrderHooks;null!==ve&&la(o,ve,0,null),va(o,0)}if(function mp(r){for(let o=vl(r);null!==o;o=Vs(o)){if(!o[2])continue;const l=o[9];for(let f=0;f<l.length;f++){const v=l[f],w=v[3];0==(1024&v[2])&&Ps(w,1),v[2]|=1024}}}(o),function Gd(r){for(let o=vl(r);null!==o;o=Vs(o))for(let l=10;l<o.length;l++){const f=o[l],v=f[1];Jr(f)&&Uc(v,f,v.template,f[8])}}(o),null!==r.contentQueries&&Nd(r,o),!w)if(S){const ve=r.contentCheckHooks;null!==ve&&La(o,ve)}else{const ve=r.contentHooks;null!==ve&&la(o,ve,1),va(o,1)}!function ap(r,o){const l=r.hostBindingOpCodes;if(null!==l)try{for(let f=0;f<l.length;f++){const v=l[f];if(v<0)Us(~v);else{const w=v,S=l[++f],U=l[++f];Pt(S,w),U(2,o[w])}}}finally{Us(-1)}}(r,o);const U=r.components;null!==U&&function Hf(r,o){for(let l=0;l<o.length;l++)Lg(r,o[l])}(o,U);const q=r.viewQuery;if(null!==q&&_u(2,q,f),!w)if(S){const ve=r.viewCheckHooks;null!==ve&&La(o,ve)}else{const ve=r.viewHooks;null!==ve&&la(o,ve,2),va(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),w||(o[2]&=-73),1024&o[2]&&(o[2]&=-1025,Ps(o[3],-1))}finally{Ra()}}function Wf(r,o,l,f){const v=o[10],w=!Ds(),S=Yr(o);try{w&&!S&&v.begin&&v.begin(),S&&qu(r,o,f),Uc(r,o,l,f)}finally{w&&!S&&v.end&&v.end()}}function Yf(r,o,l,f,v){const w=as(),S=2&f;try{Us(-1),S&&o.length>20&&Kh(r,o,20,Ds()),l(f,v)}finally{Us(w)}}function lp(r,o,l){if(no(o)){const v=o.directiveEnd;for(let w=o.directiveStart;w<v;w++){const S=r.data[w];S.contentQueries&&S.contentQueries(1,l[w],w)}}}function zd(r,o,l){!sl()||(function $d(r,o,l,f){const v=l.directiveStart,w=l.directiveEnd;r.firstCreatePass||Ca(l,o),Is(f,o);const S=l.initialInputs;for(let U=v;U<w;U++){const q=r.data[U],ve=pr(q);ve&&nm(o,l,q);const De=pl(o,r,U,l);Is(De,o),null!==S&&Og(0,U-v,De,q,0,S),ve&&(ri(l.index,o)[8]=De)}}(r,o,l,ee(l,o)),128==(128&l.flags)&&function Sg(r,o,l){const f=l.directiveStart,v=l.directiveEnd,S=l.index,U=function kn(){return tr.lFrame.currentDirectiveIndex}();try{Us(S);for(let q=f;q<v;q++){const ve=r.data[q],De=o[q];Qn(q),(null!==ve.hostBindings||0!==ve.hostVars||null!==ve.hostAttrs)&&Qf(ve,De)}}finally{Us(-1),Qn(U)}}(r,o,l))}function Hu(r,o,l=ee){const f=o.localNames;if(null!==f){let v=o.index+1;for(let w=0;w<f.length;w+=2){const S=f[w+1],U=-1===S?l(o,r):r[S];r[v++]=U}}}function Ud(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=Wu(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function Wu(r,o,l,f,v,w,S,U,q,ve){const De=20+f,ot=De+v,Ot=function Eg(r,o){const l=[];for(let f=0;f<o;f++)l.push(f<r?null:fr);return l}(De,ot),Yt="function"==typeof ve?ve():ve;return Ot[1]={type:r,blueprint:Ot,template:l,queries:null,viewQuery:U,declTNode:o,data:Ot.slice().fill(null,De),bindingStartIndex:De,expandoStartIndex:ot,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof w?w():w,pipeRegistry:"function"==typeof S?S():S,firstChild:null,schemas:q,consts:Yt,incompleteFirstPass:!1}}function dp(r,o,l,f){const v=om(o);null===l?v.push(f):(v.push(l),r.firstCreatePass&&sm(r).push(f,v.length-1))}function hp(r,o,l){for(let f in r)if(r.hasOwnProperty(f)){const v=r[f];(l=null===l?{}:l).hasOwnProperty(f)?l[f].push(o,v):l[f]=[o,v]}return l}function ea(r,o,l,f,v,w,S,U){const q=ee(o,l);let De,ve=o.inputs;!U&&null!=ve&&(De=ve[f])?(xp(r,l,De,f,v),rr(o)&&function Kf(r,o){const l=ri(o,r);16&l[2]||(l[2]|=64)}(l,o.index)):3&o.type&&(f=function Ig(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(f),v=null!=S?S(v,o.value||"",f):v,Yn(w)?w.setProperty(q,f,v):xa(f)||(q.setProperty?q.setProperty(f,v):q[f]=v))}function fu(r,o,l,f){let v=!1;if(sl()){const w=function Pg(r,o,l){const f=r.directiveRegistry;let v=null;if(f)for(let w=0;w<f.length;w++){const S=f[w];Ff(l,S.selectors,!1)&&(v||(v=[]),Za(Ca(l,o),r,S.type),pr(S)?(em(r,l),v.unshift(S)):v.push(S))}return v}(r,o,l),S=null===f?null:{"":-1};if(null!==w){v=!0,jd(l,r.data.length,w.length);for(let De=0;De<w.length;De++){const ot=w[De];ot.providersResolver&&ot.providersResolver(ot)}let U=!1,q=!1,ve=jl(r,o,w.length,null);for(let De=0;De<w.length;De++){const ot=w[De];l.mergedAttrs=za(l.mergedAttrs,ot.hostAttrs),tm(r,l,o,ve,ot),mu(ve,ot,S),null!==ot.contentQueries&&(l.flags|=8),(null!==ot.hostBindings||null!==ot.hostAttrs||0!==ot.hostVars)&&(l.flags|=128);const Ot=ot.type.prototype;!U&&(Ot.ngOnChanges||Ot.ngOnInit||Ot.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(l.index),U=!0),!q&&(Ot.ngOnChanges||Ot.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(l.index),q=!0),ve++}!function Dg(r,o){const f=o.directiveEnd,v=r.data,w=o.attrs,S=[];let U=null,q=null;for(let ve=o.directiveStart;ve<f;ve++){const De=v[ve],ot=De.inputs,Ot=null===w||Rf(o)?null:dc(ot,w);S.push(Ot),U=hp(ot,ve,U),q=hp(De.outputs,ve,q)}null!==U&&(U.hasOwnProperty("class")&&(o.flags|=16),U.hasOwnProperty("style")&&(o.flags|=32)),o.initialInputs=S,o.inputs=U,o.outputs=q}(r,l)}S&&function kg(r,o,l){if(o){const f=r.localNames=[];for(let v=0;v<o.length;v+=2){const w=l[o[v+1]];if(null==w)throw new Ne(-301,!1);f.push(o[v],w)}}}(l,f,S)}return l.mergedAttrs=za(l.mergedAttrs,l.attrs),v}function pp(r,o,l,f,v,w){const S=w.hostBindings;if(S){let U=r.hostBindingOpCodes;null===U&&(U=r.hostBindingOpCodes=[]);const q=~o.index;(function Vd(r){let o=r.length;for(;o>0;){const l=r[--o];if("number"==typeof l&&l<0)return l}return 0})(U)!=q&&U.push(q),U.push(f,v,S)}}function Qf(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function em(r,o){o.flags|=2,(r.components||(r.components=[])).push(o.index)}function mu(r,o,l){if(l){if(o.exportAs)for(let f=0;f<o.exportAs.length;f++)l[o.exportAs[f]]=r;pr(o)&&(l[""]=r)}}function jd(r,o,l){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+l,r.providerIndexes=o}function tm(r,o,l,f,v){r.data[f]=v;const w=v.factory||(v.factory=oi(v.type)),S=new Fa(w,pr(v),null);r.blueprint[f]=S,l[f]=S,pp(r,o,0,f,jl(r,l,v.hostVars,fr),v)}function nm(r,o,l){const f=ee(o,r),v=Ud(l),w=r[10],S=gu(r,$l(r,v,null,l.onPush?64:16,f,o,w,w.createRenderer(f,l),null,null));r[o.index]=S}function bl(r,o,l,f,v,w){const S=ee(r,o);!function Ku(r,o,l,f,v,w,S){if(null==w)Yn(r)?r.removeAttribute(o,v,l):o.removeAttribute(v);else{const U=null==S?Je(w):S(w,f||"",v);Yn(r)?r.setAttribute(o,v,U,l):l?o.setAttributeNS(l,v,U):o.setAttribute(v,U)}}(o[11],S,w,r.value,l,f,v)}function Og(r,o,l,f,v,w){const S=w[o];if(null!==S){const U=f.setInput;for(let q=0;q<S.length;){const ve=S[q++],De=S[q++],ot=S[q++];null!==U?f.setInput(l,ot,ve,De):l[De]=ot}}}function dc(r,o){let l=null,f=0;for(;f<o.length;){const v=o[f];if(0!==v)if(5!==v){if("number"==typeof v)break;r.hasOwnProperty(v)&&(null===l&&(l=[]),l.push(v,r[v],o[f+1])),f+=2}else f+=2;else f+=4}return l}function fp(r,o,l,f){return new Array(r,!0,!1,o,null,0,f,l,null,null)}function Lg(r,o){const l=ri(o,r);if(Jr(l)){const f=l[1];80&l[2]?Uc(f,l,f.template,l[8]):l[5]>0&&gp(l)}}function gp(r){for(let f=vl(r);null!==f;f=Vs(f))for(let v=10;v<f.length;v++){const w=f[v];if(1024&w[2]){const S=w[1];Uc(S,w,S.template,w[8])}else w[5]>0&&gp(w)}const l=r[1].components;if(null!==l)for(let f=0;f<l.length;f++){const v=ri(l[f],r);Jr(v)&&v[5]>0&&gp(v)}}function Fg(r,o){const l=ri(o,r),f=l[1];(function qd(r,o){for(let l=o.length;l<r.blueprint.length;l++)o.push(r.blueprint[l])})(f,l),qu(f,l,l[8])}function gu(r,o){return r[13]?r[14][4]=o:r[13]=o,r[14]=o,o}function _p(r){for(;r;){r[2]|=64;const o=kc(r);if(Lo(r)&&!o)return r;r=o}return null}function wl(r,o,l){const f=o[10];f.begin&&f.begin();try{Uc(r,o,r.template,l)}catch(v){throw am(o,v),v}finally{f.end&&f.end()}}function im(r){!function Xu(r){for(let o=0;o<r.components.length;o++){const l=r.components[o],f=sc(l),v=f[1];Wf(v,f,v.template,l)}}(r[8])}function _u(r,o,l){br(0),o(r,l)}const Bg=(()=>Promise.resolve(null))();function om(r){return r[7]||(r[7]=[])}function sm(r){return r.cleanup||(r.cleanup=[])}function am(r,o){const l=r[9],f=l?l.get(iu,null):null;f&&f.handleError(o)}function xp(r,o,l,f,v){for(let w=0;w<l.length;){const S=l[w++],U=l[w++],q=o[S],ve=r.data[S];null!==ve.setInput?ve.setInput(q,v,f,U):q[U]=v}}function Tl(r,o,l){const f=le(o,r);!function Ef(r,o,l){Yn(r)?r.setValue(o,l):o.textContent=l}(r[11],f,l)}function Qu(r,o,l){let f=l?r.styles:null,v=l?r.classes:null,w=0;if(null!==o)for(let S=0;S<o.length;S++){const U=o[S];"number"==typeof U?w=U:1==w?v=je(v,U):2==w&&(f=je(f,U+": "+o[++S]+";"))}l?r.styles=f:r.stylesWithoutHost=f,l?r.classes=v:r.classesWithoutHost=v}const ed=new Kr("INJECTOR",-1);class cm{get(o,l=Cn){if(l===Cn){const f=new Error(`NullInjectorError: No provider for ${Ee(o)}!`);throw f.name="NullInjectorError",f}return l}}const wp=new Kr("Set Injector scope."),yu={},Ng={};let Yd;function td(){return void 0===Yd&&(Yd=new cm),Yd}function Jd(r,o=null,l=null,f){const v=Ls(r,o,l,f);return v._resolveInjectorDefTypes(),v}function Ls(r,o=null,l=null,f){return new nd(r,l,o||td(),f)}class nd{constructor(o,l,f,v=null){this.parent=f,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const w=[];l&&I(l,U=>this.processProvider(U,o,l)),I([o],U=>this.processInjectorType(U,[],w)),this.records.set(ed,pc(void 0,this));const S=this.records.get(wp);this.scope=null!=S?S.value:null,this.source=v||("object"==typeof o?null:Ee(o))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(o=>o.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(o,l=Cn,f=ft.Default){this.assertNotDestroyed();const v=xo(this),w=xe(void 0);try{if(!(f&ft.SkipSelf)){let U=this.records.get(o);if(void 0===U){const q=function pm(r){return"function"==typeof r||"object"==typeof r&&r instanceof Kr}(o)&&er(o);U=q&&this.injectableDefInScope(q)?pc(hc(o),yu):null,this.records.set(o,U)}if(null!=U)return this.hydrate(o,U)}return(f&ft.Self?td():this.parent).get(o,l=f&ft.Optional&&l===Cn?null:l)}catch(S){if("NullInjectorError"===S.name){if((S[Ti]=S[Ti]||[]).unshift(Ee(o)),v)throw S;return function $r(r,o,l,f){const v=r[Ti];throw o[Fi]&&v.unshift(o[Fi]),r.message=function lr(r,o,l,f=null){r=r&&"\n"===r.charAt(0)&&"\u0275"==r.charAt(1)?r.substr(2):r;let v=Ee(o);if(Array.isArray(o))v=o.map(Ee).join(" -> ");else if("object"==typeof o){let w=[];for(let S in o)if(o.hasOwnProperty(S)){let U=o[S];w.push(S+":"+("string"==typeof U?JSON.stringify(U):Ee(U)))}v=`{${w.join(", ")}}`}return`${l}${f?"("+f+")":""}[${v}]: ${r.replace(wr,"\n  ")}`}("\n"+r.message,v,l,f),r.ngTokenPath=v,r[Ti]=null,r}(S,o,"R3InjectorError",this.source)}throw S}finally{xe(w),xo(v)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(o=>this.get(o))}toString(){const o=[];return this.records.forEach((f,v)=>o.push(Ee(v))),`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Ne(205,!1)}processInjectorType(o,l,f){if(!(o=Ze(o)))return!1;let v=ki(o);const w=null==v&&o.ngModule||void 0,S=void 0===w?o:w,U=-1!==f.indexOf(S);if(void 0!==w&&(v=ki(w)),null==v)return!1;if(null!=v.imports&&!U){let De;f.push(S);try{I(v.imports,ot=>{this.processInjectorType(ot,l,f)&&(void 0===De&&(De=[]),De.push(ot))})}finally{}if(void 0!==De)for(let ot=0;ot<De.length;ot++){const{ngModule:Ot,providers:Yt}=De[ot];I(Yt,Mn=>this.processProvider(Mn,Ot,Yt||Xi))}}this.injectorDefTypes.add(S);const q=oi(S)||(()=>new S);this.records.set(S,pc(q,yu));const ve=v.providers;if(null!=ve&&!U){const De=o;I(ve,ot=>this.processProvider(ot,De,ve))}return void 0!==w&&void 0!==o.providers}processProvider(o,l,f){let v=Zc(o=Ze(o))?o:Ze(o&&o.provide);const w=function Cp(r,o,l){return Kd(r)?pc(void 0,r.useValue):pc(Xa(r),yu)}(o);if(Zc(o)||!0!==o.multi)this.records.get(v);else{let S=this.records.get(v);S||(S=pc(void 0,yu,!0),S.factory=()=>vs(S.multi),this.records.set(v,S)),v=o,S.multi.push(o)}this.records.set(v,w)}hydrate(o,l){return l.value===yu&&(l.value=Ng,l.value=l.factory()),"object"==typeof l.value&&l.value&&function hm(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(l.value)&&this.onDestroy.add(l.value),l.value}injectableDefInScope(o){if(!o.providedIn)return!1;const l=Ze(o.providedIn);return"string"==typeof l?"any"===l||l===this.scope:this.injectorDefTypes.has(l)}}function hc(r){const o=er(r),l=null!==o?o.factory:oi(r);if(null!==l)return l;if(r instanceof Kr)throw new Ne(204,!1);if(r instanceof Function)return function Tp(r){const o=r.length;if(o>0)throw oe(o,"?"),new Ne(204,!1);const l=function mr(r){const o=r&&(r[Qt]||r[de]);if(o){const l=function Si(r){if(r.hasOwnProperty("name"))return r.name;const o=(""+r).match(/^function\s*([^\s(]+)/);return null===o?"":o[1]}(r);return console.warn(`DEPRECATED: DI is instantiating a token "${l}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${l}" class.`),o}return null}(r);return null!==l?()=>l.factory(r):()=>new r}(r);throw new Ne(204,!1)}function Xa(r,o,l){let f;if(Zc(r)){const v=Ze(r);return oi(v)||hc(v)}if(Kd(r))f=()=>Ze(r.useValue);else if(function um(r){return!(!r||!r.useFactory)}(r))f=()=>r.useFactory(...vs(r.deps||[]));else if(function Qa(r){return!(!r||!r.useExisting)}(r))f=()=>Ki(Ze(r.useExisting));else{const v=Ze(r&&(r.useClass||r.provide));if(!function dm(r){return!!r.deps}(r))return oi(v)||hc(v);f=()=>new v(...vs(r.deps))}return f}function pc(r,o,l=!1){return{factory:r,value:o,multi:l?[]:void 0}}function Kd(r){return null!==r&&"object"==typeof r&&ar in r}function Zc(r){return"function"==typeof r}let fa=(()=>{class r{static create(l,f){if(Array.isArray(l))return Jd({name:""},f,l,"");{const v=l.name??"";return Jd({name:v},l.parent,l.providers,v)}}}return r.THROW_IF_NOT_FOUND=Cn,r.NULL=new cm,r.\u0275prov=mi({token:r,providedIn:"any",factory:()=>Ki(ed)}),r.__NG_ELEMENT_ID__=-1,r})();function vm(r,o){kr(sc(r)[1],Zo())}function Fs(r){let o=function th(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),l=!0;const f=[r];for(;o;){let v;if(pr(r))v=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new Ne(903,"");v=o.\u0275dir}if(v){if(l){f.push(v);const S=r;S.inputs=kp(r.inputs),S.declaredInputs=kp(r.declaredInputs),S.outputs=kp(r.outputs);const U=v.hostBindings;U&&Op(r,U);const q=v.viewQuery,ve=v.contentQueries;if(q&&nh(r,q),ve&&xm(r,ve),me(r.inputs,v.inputs),me(r.declaredInputs,v.declaredInputs),me(r.outputs,v.outputs),pr(v)&&v.data.animation){const De=r.data;De.animation=(De.animation||[]).concat(v.data.animation)}}const w=v.features;if(w)for(let S=0;S<w.length;S++){const U=w[S];U&&U.ngInherit&&U(r),U===Fs&&(l=!1)}}o=Object.getPrototypeOf(o)}!function ta(r){let o=0,l=null;for(let f=r.length-1;f>=0;f--){const v=r[f];v.hostVars=o+=v.hostVars,v.hostAttrs=za(v.hostAttrs,l=za(l,v.hostAttrs))}}(f)}function kp(r){return r===zr?{}:r===Xi?[]:r}function nh(r,o){const l=r.viewQuery;r.viewQuery=l?(f,v)=>{o(f,v),l(f,v)}:o}function xm(r,o){const l=r.contentQueries;r.contentQueries=l?(f,v,w)=>{o(f,v,w),l(f,v,w)}:o}function Op(r,o){const l=r.hostBindings;r.hostBindings=l?(f,v)=>{o(f,v),l(f,v)}:o}let id=null;function mc(){if(!id){const r=$i.Symbol;if(r&&r.iterator)id=r.iterator;else{const o=Object.getOwnPropertyNames(Map.prototype);for(let l=0;l<o.length;++l){const f=o[l];"entries"!==f&&"size"!==f&&Map.prototype[f]===Map.prototype.entries&&(id=f)}}}return id}function bu(r){return!!rh(r)&&(Array.isArray(r)||!(r instanceof Map)&&mc()in r)}function rh(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function nl(r,o,l){return r[o]=l}function Ko(r,o,l){return!Object.is(r[o],l)&&(r[o]=l,!0)}function $c(r,o,l,f){const v=Ko(r,o,l);return Ko(r,o+1,f)||v}function jc(r,o,l,f){const v=Rn();return Ko(v,W(),o)&&(Dr(),bl(Co(),v,r,o,l,f)),jc}function Hl(r,o,l,f){return Ko(r,W(),l)?o+Je(l)+f:fr}function Tu(r,o,l,f,v,w,S,U){const ve=function gc(r,o,l,f,v){const w=$c(r,o,l,f);return Ko(r,o+2,v)||w}(r,To(),l,v,S);return E(3),ve?o+Je(l)+f+Je(v)+w+Je(S)+U:fr}function il(r,o,l,f,v,w,S,U,q,ve){const ot=function Bs(r,o,l,f,v,w){const S=$c(r,o,l,f);return $c(r,o+2,v,w)||S}(r,To(),l,v,S,q);return E(4),ot?o+Je(l)+f+Je(v)+w+Je(S)+U+Je(q)+ve:fr}function b(r,o,l,f,v,w,S,U){const q=Rn(),ve=Dr(),De=r+20,ot=ve.firstCreatePass?function y(r,o,l,f,v,w,S,U,q){const ve=o.consts,De=Ka(o,r,4,S||null,jo(ve,U));fu(o,l,De,jo(ve,q)),kr(o,De);const ot=De.tViews=Wu(2,De,f,v,w,o.directiveRegistry,o.pipeRegistry,null,o.schemas,ve);return null!==o.queries&&(o.queries.template(o,De),ot.queries=o.queries.embeddedTView(De)),De}(De,ve,q,o,l,f,v,w,S):ve.data[De];hs(ot,!1);const Ot=q[11].createComment("");lu(ve,q,Ot,ot),Is(Ot,q),gu(q,q[De]=fp(Ot,q,Ot,ot)),Br(ot)&&zd(ve,q,ot),null!=S&&Hu(q,ot,U)}function M(r){return pn(function bc(){return tr.lFrame.contextLView}(),20+r)}function ms(r,o=ft.Default){const l=Rn();return null===l?Ki(r,o):Mc(Zo(),l,Ze(r),o)}function So(){throw new Error("invalid")}function Xo(r,o,l){const f=Rn();return Ko(f,W(),o)&&ea(Dr(),Co(),f,r,o,f[11],l,!1),Xo}function ia(r,o,l,f,v){const S=v?"class":"style";xp(r,l,o.inputs[S],S,f)}function fo(r,o,l,f){const v=Rn(),w=Dr(),S=20+r,U=v[11],q=v[S]=Nh(U,o,function Yc(){return tr.lFrame.currentNamespace}()),ve=w.firstCreatePass?function gs(r,o,l,f,v,w,S){const U=o.consts,ve=Ka(o,r,2,v,jo(U,w));return fu(o,l,ve,jo(U,S)),null!==ve.attrs&&Qu(ve,ve.attrs,!1),null!==ve.mergedAttrs&&Qu(ve,ve.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,ve),ve}(S,w,v,0,o,l,f):w.data[S];hs(ve,!0);const De=ve.mergedAttrs;null!==De&&Na(U,q,De);const ot=ve.classes;null!==ot&&qh(U,q,ot);const Ot=ve.styles;null!==Ot&&kf(U,q,Ot),64!=(64&ve.flags)&&lu(w,v,q,ve),0===function ka(){return tr.lFrame.elementDepthCount}()&&Is(q,v),function Zr(){tr.lFrame.elementDepthCount++}(),Br(ve)&&(zd(w,v,ve),lp(w,ve,v)),null!==f&&Hu(v,ve)}function Qo(){let r=Zo();ya()?Oa():(r=r.parent,hs(r,!1));const o=r;!function ra(){tr.lFrame.elementDepthCount--}();const l=Dr();l.firstCreatePass&&(kr(l,r),no(r)&&l.queries.elementEnd(r)),null!=o.classesWithoutHost&&function cl(r){return 0!=(16&r.flags)}(o)&&ia(l,o,Rn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function Ec(r){return 0!=(32&r.flags)}(o)&&ia(l,o,Rn(),o.stylesWithoutHost,!1)}function Oo(r,o,l,f){fo(r,o,l,f),Qo()}function _s(r,o,l){const f=Rn(),v=Dr(),w=r+20,S=v.firstCreatePass?function rs(r,o,l,f,v){const w=o.consts,S=jo(w,f),U=Ka(o,r,8,"ng-container",S);return null!==S&&Qu(U,S,!0),fu(o,l,U,jo(w,v)),null!==o.queries&&o.queries.elementStart(o,U),U}(w,v,f,o,l):v.data[w];hs(S,!0);const U=f[w]=f[11].createComment("");lu(v,f,U,S),Is(U,f),Br(S)&&(zd(v,f,S),lp(v,S,f)),null!=l&&Hu(f,S)}function Cs(){let r=Zo();const o=Dr();ya()?Oa():(r=r.parent,hs(r,!1)),o.firstCreatePass&&(kr(o,r),no(r)&&o.queries.elementEnd(r))}function Ms(r,o,l){_s(r,o,l),Cs()}function os(){return Rn()}function ma(r){return!!r&&"function"==typeof r.then}function qc(r){return!!r&&"function"==typeof r.subscribe}const Du=qc;function Hc(r,o,l,f){const v=Rn(),w=Dr(),S=Zo();return function Np(r,o,l,f,v,w,S,U){const q=Br(f),De=r.firstCreatePass&&sm(r),ot=o[8],Ot=om(o);let Yt=!0;if(3&f.type||U){const gi=ee(f,o),zi=U?U(gi):gi,zn=Ot.length,sr=U?co=>U(Zi(co[f.index])):f.index;if(Yn(l)){let co=null;if(!U&&q&&(co=function Cm(r,o,l,f){const v=r.cleanup;if(null!=v)for(let w=0;w<v.length-1;w+=2){const S=v[w];if(S===l&&v[w+1]===f){const U=o[7],q=v[w+2];return U.length>q?U[q]:null}"string"==typeof S&&(w+=2)}return null}(r,o,v,f.index)),null!==co)(co.__ngLastListenerFn__||co).__ngNextListenerFn__=w,co.__ngLastListenerFn__=w,Yt=!1;else{w=od(f,o,ot,w,!1);const Ro=l.listen(zi,v,w);Ot.push(w,Ro),De&&De.push(v,sr,zn,zn+1)}}else w=od(f,o,ot,w,!0),zi.addEventListener(v,w,S),Ot.push(w),De&&De.push(v,sr,zn,S)}else w=od(f,o,ot,w,!1);const Mn=f.outputs;let ii;if(Yt&&null!==Mn&&(ii=Mn[v])){const gi=ii.length;if(gi)for(let zi=0;zi<gi;zi+=2){const ol=o[ii[zi]][ii[zi+1]].subscribe(w),cd=Ot.length;Ot.push(w,ol),De&&De.push(v,f.index,cd,-(cd+1))}}}(w,v,v[11],S,r,o,!!l,f),Hc}function zp(r,o,l,f){try{return!1!==l(f)}catch(v){return am(r,v),!1}}function od(r,o,l,f,v){return function w(S){if(S===Function)return f;const U=2&r.flags?ri(r.index,o):o;0==(32&o[2])&&_p(U);let q=zp(o,0,f,S),ve=w.__ngNextListenerFn__;for(;ve;)q=zp(o,0,ve,S)&&q,ve=ve.__ngNextListenerFn__;return v&&!1===q&&(S.preventDefault(),S.returnValue=!1),q}}function oh(r=1){return function Ql(r){return(tr.lFrame.contextLView=function ks(r,o){for(;r>0;)o=o[15],r--;return o}(r,tr.lFrame.contextLView))[8]}(r)}function El(r,o){let l=null;const f=function Nc(r){const o=r.attrs;if(null!=o){const l=o.indexOf(5);if(0==(1&l))return o[l+1]}return null}(r);for(let v=0;v<o.length;v++){const w=o[v];if("*"!==w){if(null===f?Ff(r,w,!0):Vu(f,w))return v}else l=v}return l}function Up(r){const o=Rn()[16][6];if(!o.projection){const f=o.projection=oe(r?r.length:1,null),v=f.slice();let w=o.child;for(;null!==w;){const S=r?El(w,r):0;null!==S&&(v[S]?v[S].projectionNext=w:f[S]=w,v[S]=w),w=w.next}}}function sh(r,o=0,l){const f=Rn(),v=Dr(),w=Ka(v,20+r,16,null,l||null);null===w.projection&&(w.projection=o),Oa(),64!=(64&w.flags)&&function Gh(r,o,l){Sd(o[11],0,o,l,Mf(r,l,o),au(l.parent||o[6],l,o))}(v,f,w)}function sd(r,o,l){return Dl(r,"",o,"",l),sd}function Dl(r,o,l,f,v){const w=Rn(),S=Hl(w,o,l,f);return S!==fr&&ea(Dr(),Co(),w,r,S,w[11],v,!1),Dl}function Q_(r,o,l,f,v){const w=r[l+1],S=null===o;let U=f?Ja(w):Zl(w),q=!1;for(;0!==U&&(!1===q||S);){const De=r[U+1];M0(r[U],o)&&(q=!0,r[U+1]=f?Od(De):Xh(De)),U=f?Ja(De):Zl(De)}q&&(r[l+1]=f?Xh(w):Od(w))}function M0(r,o){return null===r||null==o||(Array.isArray(r)?r[1]:r)===o||!(!Array.isArray(r)||"string"!=typeof o)&&dt(r,o)>=0}function jg(r,o,l){return Yl(r,o,l,!1),jg}function Gg(r,o){return Yl(r,o,null,!0),Gg}function Yl(r,o,l,f){const v=Rn(),w=Dr(),S=E(2);w.firstUpdatePass&&function ay(r,o,l,f){const v=r.data;if(null===v[l+1]){const w=v[as()],S=function sy(r,o){return o>=r.expandoStartIndex}(r,l);(function dy(r,o){return 0!=(r.flags&(o?16:32))})(w,f)&&null===o&&!S&&(o=!1),o=function N0(r,o,l,f){const v=function Yi(r){const o=tr.lFrame.currentDirectiveIndex;return-1===o?null:r[o]}(r);let w=f?o.residualClasses:o.residualStyles;if(null===v)0===(f?o.classBindings:o.styleBindings)&&(l=Vp(l=qg(null,r,o,l,f),o.attrs,f),w=null);else{const S=o.directiveStylingLast;if(-1===S||r[S]!==v)if(l=qg(v,r,o,l,f),null===w){let q=function z0(r,o,l){const f=l?o.classBindings:o.styleBindings;if(0!==Zl(f))return r[Ja(f)]}(r,o,f);void 0!==q&&Array.isArray(q)&&(q=qg(null,r,o,q[1],f),q=Vp(q,o.attrs,f),function U0(r,o,l,f){r[Ja(l?o.classBindings:o.styleBindings)]=f}(r,o,f,q))}else w=function Z0(r,o,l){let f;const v=o.directiveEnd;for(let w=1+o.directiveStylingLast;w<v;w++)f=Vp(f,r[w].hostAttrs,l);return Vp(f,o.attrs,l)}(r,o,f)}return void 0!==w&&(f?o.residualClasses=w:o.residualStyles=w),l}(v,w,o,f),function I0(r,o,l,f,v,w){let S=w?o.classBindings:o.styleBindings,U=Ja(S),q=Zl(S);r[f]=l;let De,ve=!1;if(Array.isArray(l)){const ot=l;De=ot[1],(null===De||dt(ot,De)>0)&&(ve=!0)}else De=l;if(v)if(0!==q){const Ot=Ja(r[U+1]);r[f+1]=kd(Ot,U),0!==Ot&&(r[Ot+1]=uu(r[Ot+1],f)),r[U+1]=function yg(r,o){return 131071&r|o<<17}(r[U+1],f)}else r[f+1]=kd(U,0),0!==U&&(r[U+1]=uu(r[U+1],f)),U=f;else r[f+1]=kd(q,0),0===U?U=f:r[q+1]=uu(r[q+1],f),q=f;ve&&(r[f+1]=Xh(r[f+1])),Q_(r,De,f,!0),Q_(r,De,f,!1),function A0(r,o,l,f,v){const w=v?r.residualClasses:r.residualStyles;null!=w&&"string"==typeof o&&dt(w,o)>=0&&(l[f+1]=Od(l[f+1]))}(o,De,r,f,w),S=kd(U,q),w?o.classBindings=S:o.styleBindings=S}(v,w,o,l,S,f)}}(w,r,S,f),o!==fr&&Ko(v,S,o)&&function cy(r,o,l,f,v,w,S,U){if(!(3&o.type))return;const q=r.data,ve=q[U+1];Dm(function zf(r){return 1==(1&r)}(ve)?uy(q,o,l,v,Zl(ve),S):void 0)||(Dm(w)||function Nf(r){return 2==(2&r)}(ve)&&(w=uy(q,null,l,v,U,S)),function dg(r,o,l,f,v){const w=Yn(r);if(o)v?w?r.addClass(l,f):l.classList.add(f):w?r.removeClass(l,f):l.classList.remove(f);else{let S=-1===f.indexOf("-")?void 0:yl.DashCase;if(null==v)w?r.removeStyle(l,f,S):l.style.removeProperty(f);else{const U="string"==typeof v&&v.endsWith("!important");U&&(v=v.slice(0,-10),S|=yl.Important),w?r.setStyle(l,f,v,S):l.style.setProperty(f,v,U?"important":"")}}}(f,S,le(as(),l),v,w))}(w,w.data[as()],v,v[11],r,v[S+1]=function j0(r,o){return null==r||("string"==typeof o?r+=o:"object"==typeof r&&(r=Ee(fl(r)))),r}(o,l),f,S)}function qg(r,o,l,f,v){let w=null;const S=l.directiveEnd;let U=l.directiveStylingLast;for(-1===U?U=l.directiveStart:U++;U<S&&(w=o[U],f=Vp(f,w.hostAttrs,v),w!==r);)U++;return null!==r&&(l.directiveStylingLast=U),f}function Vp(r,o,l){const f=l?1:2;let v=-1;if(null!==o)for(let w=0;w<o.length;w++){const S=o[w];"number"==typeof S?v=S:v===f&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),mt(r,S,!!l||o[++w]))}return void 0===r?null:r}function uy(r,o,l,f,v,w){const S=null===o;let U;for(;v>0;){const q=r[v],ve=Array.isArray(q),De=ve?q[1]:q,ot=null===De;let Ot=l[v+1];Ot===fr&&(Ot=ot?Xi:void 0);let Yt=ot?Ge(Ot,f):De===f?Ot:void 0;if(ve&&!Dm(Yt)&&(Yt=Ge(q,f)),Dm(Yt)&&(U=Yt,S))return U;const Mn=r[v+1];v=S?Ja(Mn):Zl(Mn)}if(null!==o){let q=w?o.residualClasses:o.residualStyles;null!=q&&(U=Ge(q,f))}return U}function Dm(r){return void 0!==r}function hy(r,o=""){const l=Rn(),f=Dr(),v=r+20,w=f.firstCreatePass?Ka(f,v,1,o,null):f.data[v],S=l[v]=function Bh(r,o){return Yn(r)?r.createText(o):r.createTextNode(o)}(l[11],o);lu(f,l,S,w),hs(w,!1)}function Hg(r){return Im("",r,""),Hg}function Im(r,o,l){const f=Rn(),v=Hl(f,r,o,l);return v!==fr&&Tl(f,as(),v),Im}function Wg(r,o,l,f,v){const w=Rn(),S=function wu(r,o,l,f,v,w){const U=$c(r,To(),l,v);return E(2),U?o+Je(l)+f+Je(v)+w:fr}(w,r,o,l,f,v);return S!==fr&&Tl(w,as(),S),Wg}function Yg(r,o,l,f,v,w,S){const U=Rn(),q=Tu(U,r,o,l,f,v,w,S);return q!==fr&&Tl(U,as(),q),Yg}function Jg(r,o,l,f,v,w,S,U,q){const ve=Rn(),De=il(ve,r,o,l,f,v,w,S,U,q);return De!==fr&&Tl(ve,as(),De),Jg}const ad=void 0;var ux=["en",[["a","p"],["AM","PM"],ad],[["AM","PM"],ad,ad],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],ad,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],ad,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",ad,"{1} 'at' {0}",ad],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function cx(r){const l=Math.floor(Math.abs(r)),f=r.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===f?1:5}];let uh={};function Kg(r){const o=function dx(r){return r.toLowerCase().replace(/_/g,"-")}(r);let l=Sy(o);if(l)return l;const f=o.split("-")[0];if(l=Sy(f),l)return l;if("en"===f)return ux;throw new Error(`Missing locale data for the locale "${r}".`)}function My(r){return Kg(r)[hr.PluralCase]}function Sy(r){return r in uh||(uh[r]=$i.ng&&$i.ng.common&&$i.ng.common.locales&&$i.ng.common.locales[r]),uh[r]}var hr=(()=>((hr=hr||{})[hr.LocaleId=0]="LocaleId",hr[hr.DayPeriodsFormat=1]="DayPeriodsFormat",hr[hr.DayPeriodsStandalone=2]="DayPeriodsStandalone",hr[hr.DaysFormat=3]="DaysFormat",hr[hr.DaysStandalone=4]="DaysStandalone",hr[hr.MonthsFormat=5]="MonthsFormat",hr[hr.MonthsStandalone=6]="MonthsStandalone",hr[hr.Eras=7]="Eras",hr[hr.FirstDayOfWeek=8]="FirstDayOfWeek",hr[hr.WeekendRange=9]="WeekendRange",hr[hr.DateFormat=10]="DateFormat",hr[hr.TimeFormat=11]="TimeFormat",hr[hr.DateTimeFormat=12]="DateTimeFormat",hr[hr.NumberSymbols=13]="NumberSymbols",hr[hr.NumberFormats=14]="NumberFormats",hr[hr.CurrencyCode=15]="CurrencyCode",hr[hr.CurrencySymbol=16]="CurrencySymbol",hr[hr.CurrencyName=17]="CurrencyName",hr[hr.Currencies=18]="Currencies",hr[hr.Directionality=19]="Directionality",hr[hr.PluralCase=20]="PluralCase",hr[hr.ExtraData=21]="ExtraData",hr))();const Am="en-US";let Py=Am;function e_(r,o,l,f,v){if(r=Ze(r),Array.isArray(r))for(let w=0;w<r.length;w++)e_(r[w],o,l,f,v);else{const w=Dr(),S=Rn();let U=Zc(r)?r:Ze(r.provide),q=Xa(r);const ve=Zo(),De=1048575&ve.providerIndexes,ot=ve.directiveStart,Ot=ve.providerIndexes>>20;if(Zc(r)||!r.multi){const Yt=new Fa(q,v,ms),Mn=n_(U,o,v?De:De+Ot,ot);-1===Mn?(Za(Ca(ve,S),w,U),t_(w,r,o.length),o.push(U),ve.directiveStart++,ve.directiveEnd++,v&&(ve.providerIndexes+=1048576),l.push(Yt),S.push(Yt)):(l[Mn]=Yt,S[Mn]=Yt)}else{const Yt=n_(U,o,De+Ot,ot),Mn=n_(U,o,De,De+Ot),ii=Yt>=0&&l[Yt],gi=Mn>=0&&l[Mn];if(v&&!gi||!v&&!ii){Za(Ca(ve,S),w,U);const zi=function cb(r,o,l,f,v){const w=new Fa(r,l,ms);return w.multi=[],w.index=o,w.componentProviders=0,tv(w,v,f&&!l),w}(v?lb:ab,l.length,v,f,q);!v&&gi&&(l[Mn].providerFactory=zi),t_(w,r,o.length,0),o.push(U),ve.directiveStart++,ve.directiveEnd++,v&&(ve.providerIndexes+=1048576),l.push(zi),S.push(zi)}else t_(w,r,Yt>-1?Yt:Mn,tv(l[v?Mn:Yt],q,!v&&f));!v&&f&&gi&&l[Mn].componentProviders++}}}function t_(r,o,l,f){const v=Zc(o),w=function zg(r){return!!r.useClass}(o);if(v||w){const q=(w?Ze(o.useClass):o).prototype.ngOnDestroy;if(q){const ve=r.destroyHooks||(r.destroyHooks=[]);if(!v&&o.multi){const De=ve.indexOf(l);-1===De?ve.push(l,[f,q]):ve[De+1].push(f,q)}else ve.push(l,q)}}}function tv(r,o,l){return l&&r.componentProviders++,r.multi.push(o)-1}function n_(r,o,l,f){for(let v=l;v<f;v++)if(o[v]===r)return v;return-1}function ab(r,o,l,f){return i_(this.multi,[])}function lb(r,o,l,f){const v=this.multi;let w;if(this.providerFactory){const S=this.providerFactory.componentProviders,U=pl(l,l[1],this.providerFactory.index,f);w=U.slice(0,S),i_(v,w);for(let q=S;q<U.length;q++)w.push(U[q])}else w=[],i_(v,w);return w}function i_(r,o){for(let l=0;l<r.length;l++)o.push((0,r[l])());return o}function nv(r,o=[]){return l=>{l.providersResolver=(f,v)=>function sb(r,o,l){const f=Dr();if(f.firstCreatePass){const v=pr(r);e_(l,f.data,f.blueprint,v,!0),e_(o,f.data,f.blueprint,v,!1)}}(f,v?v(r):r,o)}}class iv{}class hb{resolveComponentFactory(o){throw function db(r){const o=Error(`No component factory found for ${Ee(r)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=r,o}(o)}}let Hp=(()=>{class r{}return r.NULL=new hb,r})();function pb(){return hh(Zo(),Rn())}function hh(r,o){return new Wp(ee(r,o))}let Wp=(()=>{class r{constructor(l){this.nativeElement=l}}return r.__NG_ELEMENT_ID__=pb,r})();function fb(r){return r instanceof Wp?r.nativeElement:r}class ov{}let mb=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function _b(){const r=Rn(),l=ri(Zo().index,r);return function gb(r){return r[11]}(hn(l)?l:r)}(),r})(),yb=(()=>{class r{}return r.\u0275prov=mi({token:r,providedIn:"root",factory:()=>null}),r})();class sv{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const vb=new sv("13.2.1"),r_={};function Om(r,o,l,f,v=!1){for(;null!==l;){const w=o[l.index];if(null!==w&&f.push(Zi(w)),qi(w))for(let U=10;U<w.length;U++){const q=w[U],ve=q[1].firstChild;null!==ve&&Om(q[1],q,ve,f)}const S=l.type;if(8&S)Om(r,o,l.child,f);else if(32&S){const U=Rh(l,o);let q;for(;q=U();)f.push(q)}else if(16&S){const U=jh(o,l);if(Array.isArray(U))f.push(...U);else{const q=kc(o[16]);Om(q[1],q,U,f,!0)}}l=v?l.projectionNext:l.next}return f}class Yp{constructor(o,l){this._lView=o,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const o=this._lView,l=o[1];return Om(l,o,l.firstChild,[])}get context(){return this._lView[8]}set context(o){this._lView[8]=o}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[3];if(qi(o)){const l=o[8],f=l?l.indexOf(this):-1;f>-1&&(zh(o,f),J(l,f))}this._attachedToViewContainer=!1}Af(this._lView[1],this._lView)}onDestroy(o){dp(this._lView[1],this._lView,null,o)}markForCheck(){_p(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){wl(this._lView[1],this._lView,this.context)}checkNoChanges(){!function vp(r,o,l){qs(!0);try{wl(r,o,l)}finally{qs(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Ne(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function ac(r,o){Zu(r,o,o[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new Ne(902,"");this._appRef=o}}class xb extends Yp{constructor(o){super(o),this._view=o}detectChanges(){im(this._view)}checkNoChanges(){!function rm(r){qs(!0);try{im(r)}finally{qs(!1)}}(this._view)}get context(){return null}}class av extends Hp{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const l=Kn(o);return new o_(l,this.ngModule)}}function lv(r){const o=[];for(let l in r)r.hasOwnProperty(l)&&o.push({propName:r[l],templateName:l});return o}const wb=new Kr("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>xf});class o_ extends iv{constructor(o,l){super(),this.componentDef=o,this.ngModule=l,this.componentType=o.type,this.selector=function gg(r){return r.map(Yh).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!l}get inputs(){return lv(this.componentDef.inputs)}get outputs(){return lv(this.componentDef.outputs)}create(o,l,f,v){const w=(v=v||this.ngModule)?function Tb(r,o){return{get:(l,f,v)=>{const w=r.get(l,r_,v);return w!==r_||f===r_?w:o.get(l,f,v)}}}(o,v.injector):o,S=w.get(ov,Mr),U=w.get(yb,null),q=S.createRenderer(null,this.componentDef),ve=this.componentDef.selectors[0][0]||"div",De=f?function up(r,o,l){if(Yn(r))return r.selectRootElement(o,l===Ei.ShadowDom);let f="string"==typeof o?r.querySelector(o):o;return f.textContent="",f}(q,f,this.componentDef.encapsulation):Nh(S.createRenderer(null,this.componentDef),ve,function bb(r){const o=r.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(ve)),ot=this.componentDef.onPush?576:528,Ot=function ym(r,o){return{components:[],scheduler:r||xf,clean:Bg,playerHandler:o||null,flags:0}}(),Yt=Wu(0,null,null,1,0,null,null,null,null,null),Mn=$l(null,Yt,Ot,ot,null,null,S,q,U,w);let ii,gi;Fo(Mn);try{const zi=function eh(r,o,l,f,v,w){const S=l[1];l[20]=r;const q=Ka(S,20,2,"#host",null),ve=q.mergedAttrs=o.hostAttrs;null!==ve&&(Qu(q,ve,!0),null!==r&&(Na(v,r,ve),null!==q.classes&&qh(v,r,q.classes),null!==q.styles&&kf(v,r,q.styles)));const De=f.createRenderer(r,o),ot=$l(l,Ud(o),null,o.onPush?64:16,l[20],q,f,De,w||null,null);return S.firstCreatePass&&(Za(Ca(q,l),S,o.type),em(S,q),jd(q,l.length,1)),gu(l,ot),l[20]=ot}(De,this.componentDef,Mn,S,q);if(De)if(f)Na(q,De,["ng-version",vb.full]);else{const{attrs:zn,classes:sr}=function _g(r){const o=[],l=[];let f=1,v=2;for(;f<r.length;){let w=r[f];if("string"==typeof w)2===v?""!==w&&o.push(w,r[++f]):8===v&&l.push(w);else{if(!Aa(v))break;v=w}f++}return{attrs:o,classes:l}}(this.componentDef.selectors[0]);zn&&Na(q,De,zn),sr&&sr.length>0&&qh(q,De,sr.join(" "))}if(gi=Ue(Yt,20),void 0!==l){const zn=gi.projection=[];for(let sr=0;sr<this.ngContentSelectors.length;sr++){const co=l[sr];zn.push(null!=co?Array.from(co):null)}}ii=function _m(r,o,l,f,v){const w=l[1],S=function Xf(r,o,l){const f=Zo();r.firstCreatePass&&(l.providersResolver&&l.providersResolver(l),tm(r,f,o,jl(r,o,1,null),l));const v=pl(o,r,f.directiveStart,f);Is(v,o);const w=ee(f,o);return w&&Is(w,o),v}(w,l,o);if(f.components.push(S),r[8]=S,v&&v.forEach(q=>q(S,o)),o.contentQueries){const q=Zo();o.contentQueries(1,S,q.directiveStart)}const U=Zo();return!w.firstCreatePass||null===o.hostBindings&&null===o.hostAttrs||(Us(U.index),pp(l[1],U,0,U.directiveStart,U.directiveEnd,o),Qf(o,S)),S}(zi,this.componentDef,Mn,Ot,[vm]),qu(Yt,Mn,null)}finally{Ra()}return new Eb(this.componentType,ii,hh(gi,Mn),Mn,gi)}}class Eb extends class ub{}{constructor(o,l,f,v,w){super(),this.location=f,this._rootLView=v,this._tNode=w,this.instance=l,this.hostView=this.changeDetectorRef=new xb(v),this.componentType=o}get injector(){return new P(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}class ph{}class cv{}const fh=new Map;class hv extends ph{constructor(o,l){super(),this._parent=l,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new av(this);const f=Hi(o);this._bootstrapComponents=_l(f.bootstrap),this._r3Injector=Ls(o,l,[{provide:ph,useValue:this},{provide:Hp,useValue:this.componentFactoryResolver}],Ee(o)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(o)}get(o,l=fa.THROW_IF_NOT_FOUND,f=ft.Default){return o===fa||o===ph||o===ed?this:this._r3Injector.get(o,l,f)}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class s_ extends cv{constructor(o){super(),this.moduleType=o,null!==Hi(o)&&function Ib(r){const o=new Set;!function l(f){const v=Hi(f,!0),w=v.id;null!==w&&(function uv(r,o,l){if(o&&o!==l)throw new Error(`Duplicate module registered for ${r} - ${Ee(o)} vs ${Ee(o.name)}`)}(w,fh.get(w),f),fh.set(w,f));const S=_l(v.imports);for(const U of S)o.has(U)||(o.add(U),l(U))}(r)}(o)}create(o){return new hv(this.moduleType,o)}}function pv(r,o,l){const f=ts()+r,v=Rn();return v[f]===fr?nl(v,f,l?o.call(l):o()):function rd(r,o){return r[o]}(v,f)}function Jp(r,o){const l=r[o];return l===fr?void 0:l}function vv(r,o){const l=Dr();let f;const v=r+20;l.firstCreatePass?(f=function Bb(r,o){if(o)for(let l=o.length-1;l>=0;l--){const f=o[l];if(r===f.name)return f}}(o,l.pipeRegistry),l.data[v]=f,f.onDestroy&&(l.destroyHooks||(l.destroyHooks=[])).push(v,f.onDestroy)):f=l.data[v];const w=f.factory||(f.factory=oi(f.type)),S=xe(ms);try{const U=wa(!1),q=w();return wa(U),function C(r,o,l,f){l>=r.data.length&&(r.data[l]=null,r.blueprint[l]=null),o[l]=f}(l,Rn(),v,q),q}finally{xe(S)}}function xv(r,o,l){const f=r+20,v=Rn(),w=pn(v,f);return Kp(v,f)?function fv(r,o,l,f,v,w){const S=o+l;return Ko(r,S,v)?nl(r,S+1,w?f.call(w,v):f(v)):Jp(r,S+1)}(v,ts(),o,w.transform,l,w):w.transform(l)}function bv(r,o,l,f){const v=r+20,w=Rn(),S=pn(w,v);return Kp(w,v)?function mv(r,o,l,f,v,w,S){const U=o+l;return $c(r,U,v,w)?nl(r,U+2,S?f.call(S,v,w):f(v,w)):Jp(r,U+2)}(w,ts(),o,S.transform,l,f,S):S.transform(l,f)}function Kp(r,o){return r[1].data[o].pure}function a_(r){return o=>{setTimeout(r,void 0,o)}}const xc=class Zb extends A.xQ{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,l,f){let v=o,w=l||(()=>null),S=f;if(o&&"object"==typeof o){const q=o;v=q.next?.bind(q),w=q.error?.bind(q),S=q.complete?.bind(q)}this.__isAsync&&(w=a_(w),v&&(v=a_(v)),S&&(S=a_(S)));const U=super.subscribe({next:v,error:w,complete:S});return o instanceof p.w&&o.add(U),U}};function Vb(){return this._results[mc()]()}class l_{constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const l=mc(),f=l_.prototype;f[l]||(f[l]=Vb)}get changes(){return this._changes||(this._changes=new xc)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,l){return this._results.reduce(o,l)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,l){const f=this;f.dirty=!1;const v=T(o);(this._changesDetected=!function x(r,o,l){if(r.length!==o.length)return!1;for(let f=0;f<r.length;f++){let v=r[f],w=o[f];if(l&&(v=l(v),w=l(w)),w!==v)return!1}return!0}(f._results,v,l))&&(f._results=v,f.length=v.length,f.last=v[this.length-1],f.first=v[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;let Xp=(()=>{class r{}return r.__NG_ELEMENT_ID__=Gb,r})();const $b=Xp,jb=class extends $b{constructor(o,l,f){super(),this._declarationLView=o,this._declarationTContainer=l,this.elementRef=f}createEmbeddedView(o){const l=this._declarationTContainer.tViews,f=$l(this._declarationLView,l,o,16,null,l.declTNode,null,null,null,null);f[17]=this._declarationLView[this._declarationTContainer.index];const w=this._declarationLView[19];return null!==w&&(f[19]=w.createEmbeddedView(l)),qu(l,f,o),new Yp(f)}};function Gb(){return Rm(Zo(),Rn())}function Rm(r,o){return 4&r.type?new jb(o,r,hh(r,o)):null}let Lm=(()=>{class r{}return r.__NG_ELEMENT_ID__=qb,r})();function qb(){return Cv(Zo(),Rn())}const Hb=Lm,wv=class extends Hb{constructor(o,l,f){super(),this._lContainer=o,this._hostTNode=l,this._hostLView=f}get element(){return hh(this._hostTNode,this._hostLView)}get injector(){return new P(this._hostTNode,this._hostLView)}get parentInjector(){const o=Sl(this._hostTNode,this._hostLView);if(Js(o)){const l=ca(o,this._hostLView),f=ba(o);return new P(l[1].data[f+8],l)}return new P(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const l=Tv(this._lContainer);return null!==l&&l[o]||null}get length(){return this._lContainer.length-10}createEmbeddedView(o,l,f){const v=o.createEmbeddedView(l||{});return this.insert(v,f),v}createComponent(o,l,f,v,w){const S=o&&!function u(r){return"function"==typeof r}(o);let U;if(S)U=l;else{const ot=l||{};U=ot.index,f=ot.injector,v=ot.projectableNodes,w=ot.ngModuleRef}const q=S?o:new o_(Kn(o)),ve=f||this.parentInjector;if(!w&&null==q.ngModule&&ve){const ot=ve.get(ph,null);ot&&(w=ot)}const De=q.create(ve,v,void 0,w);return this.insert(De.hostView,U),De}insert(o,l){const f=o._lView,v=f[1];if(function es(r){return qi(r[3])}(f)){const De=this.indexOf(o);if(-1!==De)this.detach(De);else{const ot=f[3],Ot=new wv(ot,ot[6],ot[3]);Ot.detach(Ot.indexOf(o))}}const w=this._adjustIndex(l),S=this._lContainer;!function lg(r,o,l,f){const v=10+f,w=l.length;f>0&&(l[v-1][4]=o),f<w-10?(o[4]=l[v],B(l,10+f,o)):(l.push(o),o[4]=null),o[3]=l;const S=o[17];null!==S&&l!==S&&function cg(r,o){const l=r[9];o[16]!==o[3][3][16]&&(r[2]=!0),null===l?r[9]=[o]:l.push(o)}(S,o);const U=o[19];null!==U&&U.insertView(r),o[2]|=128}(v,f,S,w);const U=Bc(w,S),q=f[11],ve=Lc(q,S[7]);return null!==ve&&function Df(r,o,l,f,v,w){f[0]=v,f[6]=o,Zu(r,f,l,1,v,w)}(v,S[6],q,f,ve,U),o.attachToViewContainerRef(),B(c_(S),w,o),o}move(o,l){return this.insert(o,l)}indexOf(o){const l=Tv(this._lContainer);return null!==l?l.indexOf(o):-1}remove(o){const l=this._adjustIndex(o,-1),f=zh(this._lContainer,l);f&&(J(c_(this._lContainer),l),Af(f[1],f))}detach(o){const l=this._adjustIndex(o,-1),f=zh(this._lContainer,l);return f&&null!=J(c_(this._lContainer),l)?new Yp(f):null}_adjustIndex(o,l=0){return o??this.length+l}};function Tv(r){return r[8]}function c_(r){return r[8]||(r[8]=[])}function Cv(r,o){let l;const f=o[r.index];if(qi(f))l=f;else{let v;if(8&r.type)v=Zi(f);else{const w=o[11];v=w.createComment("");const S=ee(r,o);Rc(w,Lc(w,S),v,function Id(r,o){return Yn(r)?r.nextSibling(o):o.nextSibling}(w,S),!1)}o[r.index]=l=fp(f,o,v,r),gu(o,l)}return new wv(l,r,o)}class u_{constructor(o){this.queryList=o,this.matches=null}clone(){return new u_(this.queryList)}setDirty(){this.queryList.setDirty()}}class d_{constructor(o=[]){this.queries=o}createEmbeddedView(o){const l=o.queries;if(null!==l){const f=null!==o.contentQueries?o.contentQueries[0]:l.length,v=[];for(let w=0;w<f;w++){const S=l.getByIndex(w);v.push(this.queries[S.indexInDeclarationView].clone())}return new d_(v)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let l=0;l<this.queries.length;l++)null!==Ov(o,l).matches&&this.queries[l].setDirty()}}class Ev{constructor(o,l,f=null){this.predicate=o,this.flags=l,this.read=f}}class h_{constructor(o=[]){this.queries=o}elementStart(o,l){for(let f=0;f<this.queries.length;f++)this.queries[f].elementStart(o,l)}elementEnd(o){for(let l=0;l<this.queries.length;l++)this.queries[l].elementEnd(o)}embeddedTView(o){let l=null;for(let f=0;f<this.length;f++){const v=null!==l?l.length:0,w=this.getByIndex(f).embeddedTView(o,v);w&&(w.indexInDeclarationView=f,null!==l?l.push(w):l=[w])}return null!==l?new h_(l):null}template(o,l){for(let f=0;f<this.queries.length;f++)this.queries[f].template(o,l)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class p_{constructor(o,l=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}elementStart(o,l){this.isApplyingToNode(l)&&this.matchTNode(o,l)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,l){this.elementStart(o,l)}embeddedTView(o,l){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,l),new p_(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const l=this._declarationNodeIndex;let f=o.parent;for(;null!==f&&8&f.type&&f.index!==l;)f=f.parent;return l===(null!==f?f.index:-1)}return this._appliesToNextNode}matchTNode(o,l){const f=this.metadata.predicate;if(Array.isArray(f))for(let v=0;v<f.length;v++){const w=f[v];this.matchTNodeWithReadOption(o,l,Jb(l,w)),this.matchTNodeWithReadOption(o,l,Va(l,o,w,!1,!1))}else f===Xp?4&l.type&&this.matchTNodeWithReadOption(o,l,-1):this.matchTNodeWithReadOption(o,l,Va(l,o,f,!1,!1))}matchTNodeWithReadOption(o,l,f){if(null!==f){const v=this.metadata.read;if(null!==v)if(v===Wp||v===Lm||v===Xp&&4&l.type)this.addMatch(l.index,-2);else{const w=Va(l,o,v,!1,!1);null!==w&&this.addMatch(l.index,w)}else this.addMatch(l.index,f)}}addMatch(o,l){null===this.matches?this.matches=[o,l]:this.matches.push(o,l)}}function Jb(r,o){const l=r.localNames;if(null!==l)for(let f=0;f<l.length;f+=2)if(l[f]===o)return l[f+1];return null}function Xb(r,o,l,f){return-1===l?function Kb(r,o){return 11&r.type?hh(r,o):4&r.type?Rm(r,o):null}(o,r):-2===l?function Qb(r,o,l){return l===Wp?hh(o,r):l===Xp?Rm(o,r):l===Lm?Cv(o,r):void 0}(r,o,f):pl(r,r[1],l,o)}function Dv(r,o,l,f){const v=o[19].queries[f];if(null===v.matches){const w=r.data,S=l.matches,U=[];for(let q=0;q<S.length;q+=2){const ve=S[q];U.push(ve<0?null:Xb(o,w[ve],S[q+1],l.metadata.read))}v.matches=U}return v.matches}function f_(r,o,l,f){const v=r.queries.getByIndex(l),w=v.matches;if(null!==w){const S=Dv(r,o,v,l);for(let U=0;U<w.length;U+=2){const q=w[U];if(q>0)f.push(S[U/2]);else{const ve=w[U+1],De=o[-q];for(let ot=10;ot<De.length;ot++){const Ot=De[ot];Ot[17]===Ot[3]&&f_(Ot[1],Ot,ve,f)}if(null!==De[9]){const ot=De[9];for(let Ot=0;Ot<ot.length;Ot++){const Yt=ot[Ot];f_(Yt[1],Yt,ve,f)}}}}}return f}function Iv(r){const o=Rn(),l=Dr(),f=wi();br(f+1);const v=Ov(l,f);if(r.dirty&&Yr(o)===(2==(2&v.metadata.flags))){if(null===v.matches)r.reset([]);else{const w=v.crossesNgTemplate?f_(l,o,f,[]):Dv(l,o,v,f);r.reset(w,fb),r.notifyOnChanges()}return!0}return!1}function Av(r,o,l){const f=Dr();f.firstCreatePass&&(kv(f,new Ev(r,o,l),-1),2==(2&o)&&(f.staticViewQueries=!0)),Pv(f,Rn(),o)}function Mv(r,o,l,f){const v=Dr();if(v.firstCreatePass){const w=Zo();kv(v,new Ev(o,l,f),w.index),function t1(r,o){const l=r.contentQueries||(r.contentQueries=[]);o!==(l.length?l[l.length-1]:-1)&&l.push(r.queries.length-1,o)}(v,r),2==(2&l)&&(v.staticContentQueries=!0)}Pv(v,Rn(),l)}function Sv(){return function e1(r,o){return r[19].queries[o].queryList}(Rn(),wi())}function Pv(r,o,l){const f=new l_(4==(4&l));dp(r,o,f,f.destroy),null===o[19]&&(o[19]=new d_),o[19].queries.push(new u_(f))}function kv(r,o,l){null===r.queries&&(r.queries=new h_),r.queries.track(new p_(o,l))}function Ov(r,o){return r.queries.getByIndex(o)}function Nm(...r){}const x_=new Kr("Application Initializer");let gh=(()=>{class r{constructor(l){this.appInits=l,this.resolve=Nm,this.reject=Nm,this.initialized=!1,this.done=!1,this.donePromise=new Promise((f,v)=>{this.resolve=f,this.reject=v})}runInitializers(){if(this.initialized)return;const l=[],f=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let v=0;v<this.appInits.length;v++){const w=this.appInits[v]();if(ma(w))l.push(w);else if(Du(w)){const S=new Promise((U,q)=>{w.subscribe({complete:U,error:q})});l.push(S)}}Promise.all(l).then(()=>{f()}).catch(v=>{this.reject(v)}),0===l.length&&f(),this.initialized=!0}}return r.\u0275fac=function(l){return new(l||r)(Ki(x_,8))},r.\u0275prov=mi({token:r,factory:r.\u0275fac}),r})();const Jv=new Kr("AppId"),x1={provide:Jv,useFactory:function v1(){return`${b_()}${b_()}${b_()}`},deps:[]};function b_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const Kv=new Kr("Platform Initializer"),Xv=new Kr("Platform ID"),Qv=new Kr("appBootstrapListener");let e0=(()=>{class r{log(l){console.log(l)}warn(l){console.warn(l)}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=mi({token:r,factory:r.\u0275fac}),r})();const zm=new Kr("LocaleId"),t0=new Kr("DefaultCurrencyCode");class b1{constructor(o,l){this.ngModuleFactory=o,this.componentFactories=l}}let w_=(()=>{class r{compileModuleSync(l){return new s_(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const f=this.compileModuleSync(l),w=_l(Hi(l).declarations).reduce((S,U)=>{const q=Kn(U);return q&&S.push(new o_(q)),S},[]);return new b1(f,w)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=mi({token:r,factory:r.\u0275fac}),r})();const T1=(()=>Promise.resolve(0))();function T_(r){"undefined"==typeof Zone?T1.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class rl{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:f=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new xc(!1),this.onMicrotaskEmpty=new xc(!1),this.onStable=new xc(!1),this.onError=new xc(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const v=this;v._nesting=0,v._outer=v._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(v._inner=v._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(v._inner=v._inner.fork(Zone.longStackTraceZoneSpec)),v.shouldCoalesceEventChangeDetection=!f&&l,v.shouldCoalesceRunChangeDetection=f,v.lastRequestAnimationFrameId=-1,v.nativeRequestAnimationFrame=function C1(){let r=$i.requestAnimationFrame,o=$i.cancelAnimationFrame;if("undefined"!=typeof Zone&&r&&o){const l=r[Zone.__symbol__("OriginalDelegate")];l&&(r=l);const f=o[Zone.__symbol__("OriginalDelegate")];f&&(o=f)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function I1(r){const o=()=>{!function D1(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call($i,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,E_(r),r.isCheckStableRunning=!0,C_(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),E_(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,f,v,w,S,U)=>{try{return n0(r),l.invokeTask(v,w,S,U)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===w.type||r.shouldCoalesceRunChangeDetection)&&o(),r0(r)}},onInvoke:(l,f,v,w,S,U,q)=>{try{return n0(r),l.invoke(v,w,S,U,q)}finally{r.shouldCoalesceRunChangeDetection&&o(),r0(r)}},onHasTask:(l,f,v,w)=>{l.hasTask(v,w),f===v&&("microTask"==w.change?(r._hasPendingMicrotasks=w.microTask,E_(r),C_(r)):"macroTask"==w.change&&(r.hasPendingMacrotasks=w.macroTask))},onHandleError:(l,f,v,w)=>(l.handleError(v,w),r.runOutsideAngular(()=>r.onError.emit(w)),!1)})}(v)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!rl.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(rl.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(o,l,f){return this._inner.run(o,l,f)}runTask(o,l,f,v){const w=this._inner,S=w.scheduleEventTask("NgZoneEvent: "+v,o,E1,Nm,Nm);try{return w.runTask(S,l,f)}finally{w.cancelTask(S)}}runGuarded(o,l,f){return this._inner.runGuarded(o,l,f)}runOutsideAngular(o){return this._outer.run(o)}}const E1={};function C_(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function E_(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function n0(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function r0(r){r._nesting--,C_(r)}class A1{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new xc,this.onMicrotaskEmpty=new xc,this.onStable=new xc,this.onError=new xc}run(o,l,f){return o.apply(l,f)}runGuarded(o,l,f){return o.apply(l,f)}runOutsideAngular(o){return o()}runTask(o,l,f,v){return o.apply(l,f)}}let o0=(()=>{class r{constructor(l){this._ngZone=l,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{rl.assertNotInAngularZone(),T_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())T_(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(f=>!f.updateCb||!f.updateCb(l)||(clearTimeout(f.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,f,v){let w=-1;f&&f>0&&(w=setTimeout(()=>{this._callbacks=this._callbacks.filter(S=>S.timeoutId!==w),l(this._didWork,this.getPendingTasks())},f)),this._callbacks.push({doneCb:l,timeoutId:w,updateCb:v})}whenStable(l,f,v){if(v&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,f,v),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(l,f,v){return[]}}return r.\u0275fac=function(l){return new(l||r)(Ki(rl))},r.\u0275prov=mi({token:r,factory:r.\u0275fac}),r})(),s0=(()=>{class r{constructor(){this._applications=new Map,D_.addToWindow(this)}registerApplication(l,f){this._applications.set(l,f)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,f=!0){return D_.findTestabilityInTree(this,l,f)}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=mi({token:r,factory:r.\u0275fac}),r})();class M1{addToWindow(o){}findTestabilityInTree(o,l,f){return null}}function S1(r){D_=r}let Kl,D_=new M1;const a0=new Kr("AllowMultipleToken");class O1{constructor(o,l){this.name=o,this.token=l}}function l0(r,o,l=[]){const f=`Platform: ${o}`,v=new Kr(f);return(w=[])=>{let S=c0();if(!S||S.injector.get(a0,!1))if(r)r(l.concat(w).concat({provide:v,useValue:!0}));else{const U=l.concat(w).concat({provide:v,useValue:!0},{provide:wp,useValue:"platform"});!function R1(r){if(Kl&&!Kl.destroyed&&!Kl.injector.get(a0,!1))throw new Ne(400,"");Kl=r.get(u0);const o=r.get(Kv,null);o&&o.forEach(l=>l())}(fa.create({providers:U,name:f}))}return function L1(r){const o=c0();if(!o)throw new Ne(401,"");return o}()}}function c0(){return Kl&&!Kl.destroyed?Kl:null}let u0=(()=>{class r{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,f){const U=function F1(r,o){let l;return l="noop"===r?new A1:("zone.js"===r?void 0:r)||new rl({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!o?.ngZoneEventCoalescing,shouldCoalesceRunChangeDetection:!!o?.ngZoneRunCoalescing}),l}(f?f.ngZone:void 0,{ngZoneEventCoalescing:f&&f.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:f&&f.ngZoneRunCoalescing||!1}),q=[{provide:rl,useValue:U}];return U.run(()=>{const ve=fa.create({providers:q,parent:this.injector,name:l.moduleType.name}),De=l.create(ve),ot=De.injector.get(iu,null);if(!ot)throw new Ne(402,"");return U.runOutsideAngular(()=>{const Ot=U.onError.subscribe({next:Yt=>{ot.handleError(Yt)}});De.onDestroy(()=>{I_(this._modules,De),Ot.unsubscribe()})}),function B1(r,o,l){try{const f=l();return ma(f)?f.catch(v=>{throw o.runOutsideAngular(()=>r.handleError(v)),v}):f}catch(f){throw o.runOutsideAngular(()=>r.handleError(f)),f}}(ot,U,()=>{const Ot=De.injector.get(gh);return Ot.runInitializers(),Ot.donePromise.then(()=>(function mx(r){Et(r,"Expected localeId to be defined"),"string"==typeof r&&(Py=r.toLowerCase().replace(/_/g,"-"))}(De.injector.get(zm,Am)||Am),this._moduleDoBootstrap(De),De))})})}bootstrapModule(l,f=[]){const v=d0({},f);return function P1(r,o,l){const f=new s_(l);return Promise.resolve(f)}(0,0,l).then(w=>this.bootstrapModuleFactory(w,v))}_moduleDoBootstrap(l){const f=l.injector.get(ef);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(v=>f.bootstrap(v));else{if(!l.instance.ngDoBootstrap)throw new Ne(403,"");l.instance.ngDoBootstrap(f)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Ne(404,"");this._modules.slice().forEach(l=>l.destroy()),this._destroyListeners.forEach(l=>l()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(l){return new(l||r)(Ki(fa))},r.\u0275prov=mi({token:r,factory:r.\u0275fac}),r})();function d0(r,o){return Array.isArray(o)?o.reduce(d0,r):{...r,...o}}let ef=(()=>{class r{constructor(l,f,v,w,S){this._zone=l,this._injector=f,this._exceptionHandler=v,this._componentFactoryResolver=w,this._initStatus=S,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const U=new d.y(ve=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{ve.next(this._stable),ve.complete()})}),q=new d.y(ve=>{let De;this._zone.runOutsideAngular(()=>{De=this._zone.onStable.subscribe(()=>{rl.assertNotInAngularZone(),T_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,ve.next(!0))})})});const ot=this._zone.onUnstable.subscribe(()=>{rl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{ve.next(!1)}))});return()=>{De.unsubscribe(),ot.unsubscribe()}});this.isStable=function O(...r){let o=Number.POSITIVE_INFINITY,l=null,f=r[r.length-1];return(0,c.K)(f)?(l=r.pop(),r.length>1&&"number"==typeof r[r.length-1]&&(o=r.pop())):"number"==typeof f&&(o=r.pop()),null===l&&1===r.length&&r[0]instanceof d.y?r[0]:(0,V.J)(o)((0,a.n)(r,l))}(U,q.pipe(function te(){return r=>(0,z.x)()(function Q(r,o){return function(f){let v;if(v="function"==typeof r?r:function(){return r},"function"==typeof o)return f.lift(new Z(v,o));const w=Object.create(f,L.N);return w.source=f,w.subjectFactory=v,w}}(G)(r))}()))}bootstrap(l,f){if(!this._initStatus.done)throw new Ne(405,"");let v;v=l instanceof iv?l:this._componentFactoryResolver.resolveComponentFactory(l),this.componentTypes.push(v.componentType);const w=function k1(r){return r.isBoundToModule}(v)?void 0:this._injector.get(ph),U=v.create(fa.NULL,[],f||v.selector,w),q=U.location.nativeElement,ve=U.injector.get(o0,null),De=ve&&U.injector.get(s0);return ve&&De&&De.registerApplication(q,ve),U.onDestroy(()=>{this.detachView(U.hostView),I_(this.components,U),De&&De.unregisterApplication(q)}),this._loadComponent(U),U}tick(){if(this._runningTick)throw new Ne(101,"");try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(l))}finally{this._runningTick=!1}}attachView(l){const f=l;this._views.push(f),f.attachToAppRef(this)}detachView(l){const f=l;I_(this._views,f),f.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l),this._injector.get(Qv,[]).concat(this._bootstrapListeners).forEach(v=>v(l))}ngOnDestroy(){this._views.slice().forEach(l=>l.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return r.\u0275fac=function(l){return new(l||r)(Ki(rl),Ki(fa),Ki(iu),Ki(Hp),Ki(gh))},r.\u0275prov=mi({token:r,factory:r.\u0275fac}),r})();function I_(r,o){const l=r.indexOf(o);l>-1&&r.splice(l,1)}let p0=!0;function z1(){p0=!1}let U1=(()=>{class r{}return r.__NG_ELEMENT_ID__=Z1,r})();function Z1(r){return function V1(r,o,l){if(rr(r)&&!l){const f=ri(r.index,o);return new Yp(f,f)}return 47&r.type?new Yp(o[16],o):null}(Zo(),Rn(),16==(16&r))}class x0{constructor(){}supports(o){return bu(o)}create(o){return new W1(o)}}const H1=(r,o)=>o;class W1{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||H1}forEachItem(o){let l;for(l=this._itHead;null!==l;l=l._next)o(l)}forEachOperation(o){let l=this._itHead,f=this._removalsHead,v=0,w=null;for(;l||f;){const S=!f||l&&l.currentIndex<w0(f,v,w)?l:f,U=w0(S,v,w),q=S.currentIndex;if(S===f)v--,f=f._nextRemoved;else if(l=l._next,null==S.previousIndex)v++;else{w||(w=[]);const ve=U-v,De=q-v;if(ve!=De){for(let Ot=0;Ot<ve;Ot++){const Yt=Ot<w.length?w[Ot]:w[Ot]=0,Mn=Yt+Ot;De<=Mn&&Mn<ve&&(w[Ot]=Yt+1)}w[S.previousIndex]=De-ve}}U!==q&&o(S,U,q)}}forEachPreviousItem(o){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)o(l)}forEachAddedItem(o){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)o(l)}forEachMovedItem(o){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)o(l)}forEachRemovedItem(o){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)o(l)}forEachIdentityChange(o){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)o(l)}diff(o){if(null==o&&(o=[]),!bu(o))throw new Ne(900,"");return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let v,w,S,l=this._itHead,f=!1;if(Array.isArray(o)){this.length=o.length;for(let U=0;U<this.length;U++)w=o[U],S=this._trackByFn(U,w),null!==l&&Object.is(l.trackById,S)?(f&&(l=this._verifyReinsertion(l,w,S,U)),Object.is(l.item,w)||this._addIdentityChange(l,w)):(l=this._mismatch(l,w,S,U),f=!0),l=l._next}else v=0,function Rp(r,o){if(Array.isArray(r))for(let l=0;l<r.length;l++)o(r[l]);else{const l=r[mc()]();let f;for(;!(f=l.next()).done;)o(f.value)}}(o,U=>{S=this._trackByFn(v,U),null!==l&&Object.is(l.trackById,S)?(f&&(l=this._verifyReinsertion(l,U,S,v)),Object.is(l.item,U)||this._addIdentityChange(l,U)):(l=this._mismatch(l,U,S,v),f=!0),l=l._next,v++}),this.length=v;return this._truncate(l),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,l,f,v){let w;return null===o?w=this._itTail:(w=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null))?(Object.is(o.item,l)||this._addIdentityChange(o,l),this._reinsertAfter(o,w,v)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(f,v))?(Object.is(o.item,l)||this._addIdentityChange(o,l),this._moveAfter(o,w,v)):o=this._addAfter(new Y1(l,f),w,v),o}_verifyReinsertion(o,l,f,v){let w=null===this._unlinkedRecords?null:this._unlinkedRecords.get(f,null);return null!==w?o=this._reinsertAfter(w,o._prev,v):o.currentIndex!=v&&(o.currentIndex=v,this._addToMoves(o,v)),o}_truncate(o){for(;null!==o;){const l=o._next;this._addToRemovals(this._unlink(o)),o=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,l,f){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const v=o._prevRemoved,w=o._nextRemoved;return null===v?this._removalsHead=w:v._nextRemoved=w,null===w?this._removalsTail=v:w._prevRemoved=v,this._insertAfter(o,l,f),this._addToMoves(o,f),o}_moveAfter(o,l,f){return this._unlink(o),this._insertAfter(o,l,f),this._addToMoves(o,f),o}_addAfter(o,l,f){return this._insertAfter(o,l,f),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,l,f){const v=null===l?this._itHead:l._next;return o._next=v,o._prev=l,null===v?this._itTail=o:v._prev=o,null===l?this._itHead=o:l._next=o,null===this._linkedRecords&&(this._linkedRecords=new b0),this._linkedRecords.put(o),o.currentIndex=f,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const l=o._prev,f=o._next;return null===l?this._itHead=f:l._next=f,null===f?this._itTail=l:f._prev=l,o}_addToMoves(o,l){return o.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new b0),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,l){return o.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class Y1{constructor(o,l){this.item=o,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class J1{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,l){let f;for(f=this._head;null!==f;f=f._nextDup)if((null===l||l<=f.currentIndex)&&Object.is(f.trackById,o))return f;return null}remove(o){const l=o._prevDup,f=o._nextDup;return null===l?this._head=f:l._nextDup=f,null===f?this._tail=l:f._prevDup=l,null===this._head}}class b0{constructor(){this.map=new Map}put(o){const l=o.trackById;let f=this.map.get(l);f||(f=new J1,this.map.set(l,f)),f.add(o)}get(o,l){const v=this.map.get(o);return v?v.get(o,l):null}remove(o){const l=o.trackById;return this.map.get(l).remove(o)&&this.map.delete(l),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function w0(r,o,l){const f=r.previousIndex;if(null===f)return f;let v=0;return l&&f<l.length&&(v=l[f]),f+o+v}class T0{constructor(){}supports(o){return o instanceof Map||rh(o)}create(){return new K1}}class K1{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let l;for(l=this._mapHead;null!==l;l=l._next)o(l)}forEachPreviousItem(o){let l;for(l=this._previousMapHead;null!==l;l=l._nextPrevious)o(l)}forEachChangedItem(o){let l;for(l=this._changesHead;null!==l;l=l._nextChanged)o(l)}forEachAddedItem(o){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)o(l)}forEachRemovedItem(o){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)o(l)}diff(o){if(o){if(!(o instanceof Map||rh(o)))throw new Ne(900,"")}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let l=this._mapHead;if(this._appendAfter=null,this._forEach(o,(f,v)=>{if(l&&l.key===v)this._maybeAddToChanges(l,f),this._appendAfter=l,l=l._next;else{const w=this._getOrCreateRecordForKey(v,f);l=this._insertBeforeOrAppend(l,w)}}),l){l._prev&&(l._prev._next=null),this._removalsHead=l;for(let f=l;null!==f;f=f._nextRemoved)f===this._mapHead&&(this._mapHead=null),this._records.delete(f.key),f._nextRemoved=f._next,f.previousValue=f.currentValue,f.currentValue=null,f._prev=null,f._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,l){if(o){const f=o._prev;return l._next=o,l._prev=f,o._prev=l,f&&(f._next=l),o===this._mapHead&&(this._mapHead=l),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=l,l._prev=this._appendAfter):this._mapHead=l,this._appendAfter=l,null}_getOrCreateRecordForKey(o,l){if(this._records.has(o)){const v=this._records.get(o);this._maybeAddToChanges(v,l);const w=v._prev,S=v._next;return w&&(w._next=S),S&&(S._prev=w),v._next=null,v._prev=null,v}const f=new X1(o);return this._records.set(o,f),f.currentValue=l,this._addToAdditions(f),f}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,l){Object.is(l,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=l,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,l){o instanceof Map?o.forEach(l):Object.keys(o).forEach(f=>l(o[f],f))}}class X1{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function C0(){return new Zm([new x0])}let Zm=(()=>{class r{constructor(l){this.factories=l}static create(l,f){if(null!=f){const v=f.factories.slice();l=l.concat(v)}return new r(l)}static extend(l){return{provide:r,useFactory:f=>r.create(l,f||C0()),deps:[[r,new po,new Eo]]}}find(l){const f=this.factories.find(v=>v.supports(l));if(null!=f)return f;throw new Ne(901,"")}}return r.\u0275prov=mi({token:r,providedIn:"root",factory:C0}),r})();function E0(){return new Vm([new T0])}let Vm=(()=>{class r{constructor(l){this.factories=l}static create(l,f){if(f){const v=f.factories.slice();l=l.concat(v)}return new r(l)}static extend(l){return{provide:r,useFactory:f=>r.create(l,f||E0()),deps:[[r,new po,new Eo]]}}find(l){const f=this.factories.find(w=>w.supports(l));if(f)return f;throw new Ne(901,"")}}return r.\u0275prov=mi({token:r,providedIn:"root",factory:E0}),r})();const Q1=[new T0],tw=new Zm([new x0]),nw=new Vm(Q1),iw=l0(null,"core",[{provide:Xv,useValue:"unknown"},{provide:u0,deps:[fa]},{provide:s0,deps:[]},{provide:e0,deps:[]}]),lw=[{provide:ef,useClass:ef,deps:[rl,fa,iu,Hp,gh]},{provide:wb,deps:[rl],useFactory:function cw(r){let o=[];return r.onStable.subscribe(()=>{for(;o.length;)o.pop()()}),function(l){o.push(l)}}},{provide:gh,useClass:gh,deps:[[new Eo,x_]]},{provide:w_,useClass:w_,deps:[]},x1,{provide:Zm,useFactory:function rw(){return tw},deps:[]},{provide:Vm,useFactory:function ow(){return nw},deps:[]},{provide:zm,useFactory:function sw(r){return r||function aw(){return"undefined"!=typeof $localize&&$localize.locale||Am}()},deps:[[new Tr(zm),new Eo,new po]]},{provide:t0,useValue:"USD"}];let uw=(()=>{class r{constructor(l){}}return r.\u0275fac=function(l){return new(l||r)(Ki(ef))},r.\u0275mod=sn({type:r}),r.\u0275inj=_r({providers:lw}),r})()},4006:(_n,Ke,k)=>{"use strict";k.d(Ke,{Fj:()=>ye,u5:()=>Mr,Fd:()=>bi,qQ:()=>Di,JU:()=>L,a5:()=>mi,JJ:()=>Ri,On:()=>zt,wV:()=>dn});var d=k(6738),c=k(6895),V=k(5254),a=k(567),O=k(4850);let A=(()=>{class le{constructor(ne,Ue){this._renderer=ne,this._elementRef=Ue,this.onChange=pn=>{},this.onTouched=()=>{}}setProperty(ne,Ue){this._renderer.setProperty(this._elementRef.nativeElement,ne,Ue)}registerOnTouched(ne){this.onTouched=ne}registerOnChange(ne){this.onChange=ne}setDisabledState(ne){this.setProperty("disabled",ne)}}return le.\u0275fac=function(ne){return new(ne||le)(d.Y36(d.Qsj),d.Y36(d.SBq))},le.\u0275dir=d.lG2({type:le}),le})(),p=(()=>{class le extends A{}return le.\u0275fac=function(){let ee;return function(Ue){return(ee||(ee=d.n5z(le)))(Ue||le)}}(),le.\u0275dir=d.lG2({type:le,features:[d.qOj]}),le})();const L=new d.OlP("NgValueAccessor"),z={provide:L,useExisting:(0,d.Gpc)(()=>ye),multi:!0},te=new d.OlP("CompositionEventMode");let ye=(()=>{class le extends A{constructor(ne,Ue,pn){super(ne,Ue),this._compositionMode=pn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function G(){const le=(0,c.q)()?(0,c.q)().getUserAgent():"";return/android (\d+)/.test(le.toLowerCase())}())}writeValue(ne){this.setProperty("value",ne??"")}_handleInput(ne){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(ne)}_compositionStart(){this._composing=!0}_compositionEnd(ne){this._composing=!1,this._compositionMode&&this.onChange(ne)}}return le.\u0275fac=function(ne){return new(ne||le)(d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(te,8))},le.\u0275dir=d.lG2({type:le,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(ne,Ue){1&ne&&d.NdJ("input",function(ri){return Ue._handleInput(ri.target.value)})("blur",function(){return Ue.onTouched()})("compositionstart",function(){return Ue._compositionStart()})("compositionend",function(ri){return Ue._compositionEnd(ri.target.value)})},features:[d._Bn([z]),d.qOj]}),le})();function me(le){return null==le||0===le.length}const je=new d.OlP("NgValidators"),rt=new d.OlP("NgAsyncValidators");function Ct(le){return null}function gt(le){return null!=le}function Lt(le){const ee=(0,d.QGY)(le)?(0,V.D)(le):le;return(0,d.CqO)(ee),ee}function Ht(le){let ee={};return le.forEach(ne=>{ee=null!=ne?{...ee,...ne}:ee}),0===Object.keys(ee).length?null:ee}function Vn(le,ee){return ee.map(ne=>ne(le))}function Wt(le){return le.map(ee=>function Ft(le){return!le.validate}(ee)?ee:ne=>ee.validate(ne))}function Jt(le){return null!=le?function Gt(le){if(!le)return null;const ee=le.filter(gt);return 0==ee.length?null:function(ne){return Ht(Vn(ne,ee))}}(Wt(le)):null}function Jn(le){return null!=le?function an(le){if(!le)return null;const ee=le.filter(gt);return 0==ee.length?null:function(ne){const Ue=Vn(ne,ee).map(Lt);return(0,a.D)(Ue).pipe((0,O.U)(Ht))}}(Wt(le)):null}function si(le,ee){return null===le?[ee]:Array.isArray(le)?[...le,ee]:[le,ee]}function ln(le){return le?Array.isArray(le)?le:[le]:[]}function Et(le,ee){return Array.isArray(le)?le.includes(ee):le===ee}function Kt(le,ee){const ne=ln(ee);return ln(le).forEach(pn=>{Et(ne,pn)||ne.push(pn)}),ne}function Hn(le,ee){return ln(ee).filter(ne=>!Et(le,ne))}class In{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(ee){this._rawValidators=ee||[],this._composedValidatorFn=Jt(this._rawValidators)}_setAsyncValidators(ee){this._rawAsyncValidators=ee||[],this._composedAsyncValidatorFn=Jn(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(ee){this._onDestroyCallbacks.push(ee)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(ee=>ee()),this._onDestroyCallbacks=[]}reset(ee){this.control&&this.control.reset(ee)}hasError(ee,ne){return!!this.control&&this.control.hasError(ee,ne)}getError(ee,ne){return this.control?this.control.getError(ee,ne):null}}class ti extends In{get formDirective(){return null}get path(){return null}}class mi extends In{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let Ri=(()=>{class le extends class ir{constructor(ee){this._cd=ee}is(ee){return"submitted"===ee?!!this._cd?.submitted:!!this._cd?.control?.[ee]}}{constructor(ne){super(ne)}}return le.\u0275fac=function(ne){return new(ne||le)(d.Y36(mi,2))},le.\u0275dir=d.lG2({type:le,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(ne,Ue){2&ne&&d.ekj("ng-untouched",Ue.is("untouched"))("ng-touched",Ue.is("touched"))("ng-pristine",Ue.is("pristine"))("ng-dirty",Ue.is("dirty"))("ng-valid",Ue.is("valid"))("ng-invalid",Ue.is("invalid"))("ng-pending",Ue.is("pending"))},features:[d.qOj]}),le})();function xi(le,ee){(function $i(le,ee){const ne=function di(le){return le._rawValidators}(le);null!==ee.validator?le.setValidators(si(ne,ee.validator)):"function"==typeof ne&&le.setValidators([ne]);const Ue=function Bn(le){return le._rawAsyncValidators}(le);null!==ee.asyncValidator?le.setAsyncValidators(si(Ue,ee.asyncValidator)):"function"==typeof Ue&&le.setAsyncValidators([Ue]);const pn=()=>le.updateValueAndValidity();ji(ee._rawValidators,pn),ji(ee._rawAsyncValidators,pn)})(le,ee),ee.valueAccessor.writeValue(le.value),function eo(le,ee){ee.valueAccessor.registerOnChange(ne=>{le._pendingValue=ne,le._pendingChange=!0,le._pendingDirty=!0,"change"===le.updateOn&&Xi(le,ee)})}(le,ee),function ur(le,ee){const ne=(Ue,pn)=>{ee.valueAccessor.writeValue(Ue),pn&&ee.viewToModelUpdate(Ue)};le.registerOnChange(ne),ee._registerOnDestroy(()=>{le._unregisterOnChange(ne)})}(le,ee),function zr(le,ee){ee.valueAccessor.registerOnTouched(()=>{le._pendingTouched=!0,"blur"===le.updateOn&&le._pendingChange&&Xi(le,ee),"submit"!==le.updateOn&&le.markAsTouched()})}(le,ee),function Ir(le,ee){if(ee.valueAccessor.setDisabledState){const ne=Ue=>{ee.valueAccessor.setDisabledState(Ue)};le.registerOnDisabledChange(ne),ee._registerOnDestroy(()=>{le._unregisterOnDisabledChange(ne)})}}(le,ee)}function ji(le,ee){le.forEach(ne=>{ne.registerOnValidatorChange&&ne.registerOnValidatorChange(ee)})}function Xi(le,ee){le._pendingDirty&&le.markAsDirty(),le.setValue(le._pendingValue,{emitModelToViewChange:!1}),ee.viewToModelUpdate(le._pendingValue),le._pendingChange=!1}function tt(le,ee){const ne=le.indexOf(ee);ne>-1&&le.splice(ne,1)}const sn="VALID",gn="INVALID",Nn="PENDING",Wn="DISABLED";function Kn(le){return(vi(le)?le.validators:le)||null}function ui(le){return Array.isArray(le)?Jt(le):le||null}function Qi(le,ee){return(vi(ee)?ee.asyncValidators:le)||null}function Hi(le){return Array.isArray(le)?Jn(le):le||null}function vi(le){return null!=le&&!Array.isArray(le)&&"object"==typeof le}const Ai=le=>le instanceof qr;function Gi(le){return(le=>le instanceof xr)(le)?le.value:le.getRawValue()}function Ar(le,ee){const ne=Ai(le),Ue=le.controls;if(!(ne?Object.keys(Ue):Ue).length)throw new d.vHH(1e3,"");if(!Ue[ee])throw new d.vHH(1001,"")}function hi(le,ee){Ai(le),le._forEachChild((Ue,pn)=>{if(void 0===ee[pn])throw new d.vHH(1002,"")})}class Cr{constructor(ee,ne){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=ee,this._rawAsyncValidators=ne,this._composedValidatorFn=ui(this._rawValidators),this._composedAsyncValidatorFn=Hi(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(ee){this._rawValidators=this._composedValidatorFn=ee}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(ee){this._rawAsyncValidators=this._composedAsyncValidatorFn=ee}get parent(){return this._parent}get valid(){return this.status===sn}get invalid(){return this.status===gn}get pending(){return this.status==Nn}get disabled(){return this.status===Wn}get enabled(){return this.status!==Wn}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(ee){this._rawValidators=ee,this._composedValidatorFn=ui(ee)}setAsyncValidators(ee){this._rawAsyncValidators=ee,this._composedAsyncValidatorFn=Hi(ee)}addValidators(ee){this.setValidators(Kt(ee,this._rawValidators))}addAsyncValidators(ee){this.setAsyncValidators(Kt(ee,this._rawAsyncValidators))}removeValidators(ee){this.setValidators(Hn(ee,this._rawValidators))}removeAsyncValidators(ee){this.setAsyncValidators(Hn(ee,this._rawAsyncValidators))}hasValidator(ee){return Et(this._rawValidators,ee)}hasAsyncValidator(ee){return Et(this._rawAsyncValidators,ee)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(ee={}){this.touched=!0,this._parent&&!ee.onlySelf&&this._parent.markAsTouched(ee)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(ee=>ee.markAllAsTouched())}markAsUntouched(ee={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(ne=>{ne.markAsUntouched({onlySelf:!0})}),this._parent&&!ee.onlySelf&&this._parent._updateTouched(ee)}markAsDirty(ee={}){this.pristine=!1,this._parent&&!ee.onlySelf&&this._parent.markAsDirty(ee)}markAsPristine(ee={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(ne=>{ne.markAsPristine({onlySelf:!0})}),this._parent&&!ee.onlySelf&&this._parent._updatePristine(ee)}markAsPending(ee={}){this.status=Nn,!1!==ee.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!ee.onlySelf&&this._parent.markAsPending(ee)}disable(ee={}){const ne=this._parentMarkedDirty(ee.onlySelf);this.status=Wn,this.errors=null,this._forEachChild(Ue=>{Ue.disable({...ee,onlySelf:!0})}),this._updateValue(),!1!==ee.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...ee,skipPristineCheck:ne}),this._onDisabledChange.forEach(Ue=>Ue(!0))}enable(ee={}){const ne=this._parentMarkedDirty(ee.onlySelf);this.status=sn,this._forEachChild(Ue=>{Ue.enable({...ee,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:ee.emitEvent}),this._updateAncestors({...ee,skipPristineCheck:ne}),this._onDisabledChange.forEach(Ue=>Ue(!1))}_updateAncestors(ee){this._parent&&!ee.onlySelf&&(this._parent.updateValueAndValidity(ee),ee.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(ee){this._parent=ee}updateValueAndValidity(ee={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===sn||this.status===Nn)&&this._runAsyncValidator(ee.emitEvent)),!1!==ee.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!ee.onlySelf&&this._parent.updateValueAndValidity(ee)}_updateTreeValidity(ee={emitEvent:!0}){this._forEachChild(ne=>ne._updateTreeValidity(ee)),this.updateValueAndValidity({onlySelf:!0,emitEvent:ee.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Wn:sn}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(ee){if(this.asyncValidator){this.status=Nn,this._hasOwnPendingAsyncValidator=!0;const ne=Lt(this.asyncValidator(this));this._asyncValidationSubscription=ne.subscribe(Ue=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Ue,{emitEvent:ee})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(ee,ne={}){this.errors=ee,this._updateControlsErrors(!1!==ne.emitEvent)}get(ee){return function ai(le,ee,ne){if(null==ee||(Array.isArray(ee)||(ee=ee.split(ne)),Array.isArray(ee)&&0===ee.length))return null;let Ue=le;return ee.forEach(pn=>{Ue=Ai(Ue)?Ue.controls.hasOwnProperty(pn)?Ue.controls[pn]:null:(le=>le instanceof Ao)(Ue)&&Ue.at(pn)||null}),Ue}(this,ee,".")}getError(ee,ne){const Ue=ne?this.get(ne):this;return Ue&&Ue.errors?Ue.errors[ee]:null}hasError(ee,ne){return!!this.getError(ee,ne)}get root(){let ee=this;for(;ee._parent;)ee=ee._parent;return ee}_updateControlsErrors(ee){this.status=this._calculateStatus(),ee&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(ee)}_initObservables(){this.valueChanges=new d.vpe,this.statusChanges=new d.vpe}_calculateStatus(){return this._allControlsDisabled()?Wn:this.errors?gn:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(Nn)?Nn:this._anyControlsHaveStatus(gn)?gn:sn}_anyControlsHaveStatus(ee){return this._anyControls(ne=>ne.status===ee)}_anyControlsDirty(){return this._anyControls(ee=>ee.dirty)}_anyControlsTouched(){return this._anyControls(ee=>ee.touched)}_updatePristine(ee={}){this.pristine=!this._anyControlsDirty(),this._parent&&!ee.onlySelf&&this._parent._updatePristine(ee)}_updateTouched(ee={}){this.touched=this._anyControlsTouched(),this._parent&&!ee.onlySelf&&this._parent._updateTouched(ee)}_isBoxedValue(ee){return"object"==typeof ee&&null!==ee&&2===Object.keys(ee).length&&"value"in ee&&"disabled"in ee}_registerOnCollectionChange(ee){this._onCollectionChange=ee}_setUpdateStrategy(ee){vi(ee)&&null!=ee.updateOn&&(this._updateOn=ee.updateOn)}_parentMarkedDirty(ee){return!ee&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class xr extends Cr{constructor(ee=null,ne,Ue){super(Kn(ne),Qi(Ue,ne)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(ee),this._setUpdateStrategy(ne),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),vi(ne)&&ne.initialValueIsDefault&&(this.defaultValue=this._isBoxedValue(ee)?ee.value:ee)}setValue(ee,ne={}){this.value=this._pendingValue=ee,this._onChange.length&&!1!==ne.emitModelToViewChange&&this._onChange.forEach(Ue=>Ue(this.value,!1!==ne.emitViewToModelChange)),this.updateValueAndValidity(ne)}patchValue(ee,ne={}){this.setValue(ee,ne)}reset(ee=this.defaultValue,ne={}){this._applyFormState(ee),this.markAsPristine(ne),this.markAsUntouched(ne),this.setValue(this.value,ne),this._pendingChange=!1}_updateValue(){}_anyControls(ee){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(ee){this._onChange.push(ee)}_unregisterOnChange(ee){tt(this._onChange,ee)}registerOnDisabledChange(ee){this._onDisabledChange.push(ee)}_unregisterOnDisabledChange(ee){tt(this._onDisabledChange,ee)}_forEachChild(ee){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(ee){this._isBoxedValue(ee)?(this.value=this._pendingValue=ee.value,ee.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=ee}}class qr extends Cr{constructor(ee,ne,Ue){super(Kn(ne),Qi(Ue,ne)),this.controls=ee,this._initObservables(),this._setUpdateStrategy(ne),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(ee,ne){return this.controls[ee]?this.controls[ee]:(this.controls[ee]=ne,ne.setParent(this),ne._registerOnCollectionChange(this._onCollectionChange),ne)}addControl(ee,ne,Ue={}){this.registerControl(ee,ne),this.updateValueAndValidity({emitEvent:Ue.emitEvent}),this._onCollectionChange()}removeControl(ee,ne={}){this.controls[ee]&&this.controls[ee]._registerOnCollectionChange(()=>{}),delete this.controls[ee],this.updateValueAndValidity({emitEvent:ne.emitEvent}),this._onCollectionChange()}setControl(ee,ne,Ue={}){this.controls[ee]&&this.controls[ee]._registerOnCollectionChange(()=>{}),delete this.controls[ee],ne&&this.registerControl(ee,ne),this.updateValueAndValidity({emitEvent:Ue.emitEvent}),this._onCollectionChange()}contains(ee){return this.controls.hasOwnProperty(ee)&&this.controls[ee].enabled}setValue(ee,ne={}){hi(this,ee),Object.keys(ee).forEach(Ue=>{Ar(this,Ue),this.controls[Ue].setValue(ee[Ue],{onlySelf:!0,emitEvent:ne.emitEvent})}),this.updateValueAndValidity(ne)}patchValue(ee,ne={}){null!=ee&&(Object.keys(ee).forEach(Ue=>{this.controls[Ue]&&this.controls[Ue].patchValue(ee[Ue],{onlySelf:!0,emitEvent:ne.emitEvent})}),this.updateValueAndValidity(ne))}reset(ee={},ne={}){this._forEachChild((Ue,pn)=>{Ue.reset(ee[pn],{onlySelf:!0,emitEvent:ne.emitEvent})}),this._updatePristine(ne),this._updateTouched(ne),this.updateValueAndValidity(ne)}getRawValue(){return this._reduceChildren({},(ee,ne,Ue)=>(ee[Ue]=Gi(ne),ee))}_syncPendingControls(){let ee=this._reduceChildren(!1,(ne,Ue)=>!!Ue._syncPendingControls()||ne);return ee&&this.updateValueAndValidity({onlySelf:!0}),ee}_forEachChild(ee){Object.keys(this.controls).forEach(ne=>{const Ue=this.controls[ne];Ue&&ee(Ue,ne)})}_setUpControls(){this._forEachChild(ee=>{ee.setParent(this),ee._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(ee){for(const ne of Object.keys(this.controls)){const Ue=this.controls[ne];if(this.contains(ne)&&ee(Ue))return!0}return!1}_reduceValue(){return this._reduceChildren({},(ee,ne,Ue)=>((ne.enabled||this.disabled)&&(ee[Ue]=ne.value),ee))}_reduceChildren(ee,ne){let Ue=ee;return this._forEachChild((pn,ri)=>{Ue=ne(Ue,pn,ri)}),Ue}_allControlsDisabled(){for(const ee of Object.keys(this.controls))if(this.controls[ee].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}}class Ao extends Cr{constructor(ee,ne,Ue){super(Kn(ne),Qi(Ue,ne)),this.controls=ee,this._initObservables(),this._setUpdateStrategy(ne),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(ee){return this.controls[ee]}push(ee,ne={}){this.controls.push(ee),this._registerControl(ee),this.updateValueAndValidity({emitEvent:ne.emitEvent}),this._onCollectionChange()}insert(ee,ne,Ue={}){this.controls.splice(ee,0,ne),this._registerControl(ne),this.updateValueAndValidity({emitEvent:Ue.emitEvent})}removeAt(ee,ne={}){this.controls[ee]&&this.controls[ee]._registerOnCollectionChange(()=>{}),this.controls.splice(ee,1),this.updateValueAndValidity({emitEvent:ne.emitEvent})}setControl(ee,ne,Ue={}){this.controls[ee]&&this.controls[ee]._registerOnCollectionChange(()=>{}),this.controls.splice(ee,1),ne&&(this.controls.splice(ee,0,ne),this._registerControl(ne)),this.updateValueAndValidity({emitEvent:Ue.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(ee,ne={}){hi(this,ee),ee.forEach((Ue,pn)=>{Ar(this,pn),this.at(pn).setValue(Ue,{onlySelf:!0,emitEvent:ne.emitEvent})}),this.updateValueAndValidity(ne)}patchValue(ee,ne={}){null!=ee&&(ee.forEach((Ue,pn)=>{this.at(pn)&&this.at(pn).patchValue(Ue,{onlySelf:!0,emitEvent:ne.emitEvent})}),this.updateValueAndValidity(ne))}reset(ee=[],ne={}){this._forEachChild((Ue,pn)=>{Ue.reset(ee[pn],{onlySelf:!0,emitEvent:ne.emitEvent})}),this._updatePristine(ne),this._updateTouched(ne),this.updateValueAndValidity(ne)}getRawValue(){return this.controls.map(ee=>Gi(ee))}clear(ee={}){this.controls.length<1||(this._forEachChild(ne=>ne._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:ee.emitEvent}))}_syncPendingControls(){let ee=this.controls.reduce((ne,Ue)=>!!Ue._syncPendingControls()||ne,!1);return ee&&this.updateValueAndValidity({onlySelf:!0}),ee}_forEachChild(ee){this.controls.forEach((ne,Ue)=>{ee(ne,Ue)})}_updateValue(){this.value=this.controls.filter(ee=>ee.enabled||this.disabled).map(ee=>ee.value)}_anyControls(ee){return this.controls.some(ne=>ne.enabled&&ee(ne))}_setUpControls(){this._forEachChild(ee=>this._registerControl(ee))}_allControlsDisabled(){for(const ee of this.controls)if(ee.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(ee){ee.setParent(this),ee._registerOnCollectionChange(this._onCollectionChange)}}const st={provide:mi,useExisting:(0,d.Gpc)(()=>zt)},Rt=(()=>Promise.resolve(null))();let zt=(()=>{class le extends mi{constructor(ne,Ue,pn,ri,Yr){super(),this._changeDetectorRef=Yr,this.control=new xr,this._registered=!1,this.update=new d.vpe,this._parent=ne,this._setValidators(Ue),this._setAsyncValidators(pn),this.valueAccessor=function kt(le,ee){if(!ee)return null;let ne,Ue,pn;return Array.isArray(ee),ee.forEach(ri=>{ri.constructor===ye?ne=ri:function Qe(le){return Object.getPrototypeOf(le.constructor)===p}(ri)?Ue=ri:pn=ri}),pn||Ue||ne||null}(0,ri)}ngOnChanges(ne){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in ne&&this._updateDisabled(ne),function _e(le,ee){if(!le.hasOwnProperty("model"))return!1;const ne=le.model;return!!ne.isFirstChange()||!Object.is(ee,ne.currentValue)}(ne,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function Ei(le,ee){return[...ee.path,le]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(ne){this.viewModel=ne,this.update.emit(ne)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){xi(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(ne){Rt.then(()=>{this.control.setValue(ne,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(ne){const Ue=ne.isDisabled.currentValue,pn=""===Ue||Ue&&"false"!==Ue;Rt.then(()=>{pn&&!this.control.disabled?this.control.disable():!pn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}}return le.\u0275fac=function(ne){return new(ne||le)(d.Y36(ti,9),d.Y36(je,10),d.Y36(rt,10),d.Y36(L,10),d.Y36(d.sBO,8))},le.\u0275dir=d.lG2({type:le,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[d._Bn([st]),d.qOj,d.TTD]}),le})();const un={provide:L,useExisting:(0,d.Gpc)(()=>dn),multi:!0};let dn=(()=>{class le extends p{writeValue(ne){this.setProperty("value",ne??"")}registerOnChange(ne){this.onChange=Ue=>{ne(""==Ue?null:parseFloat(Ue))}}}return le.\u0275fac=function(){let ee;return function(Ue){return(ee||(ee=d.n5z(le)))(Ue||le)}}(),le.\u0275dir=d.lG2({type:le,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(ne,Ue){1&ne&&d.NdJ("input",function(ri){return Ue.onChange(ri.target.value)})("blur",function(){return Ue.onTouched()})},features:[d._Bn([un]),d.qOj]}),le})(),Bt=(()=>{class le{}return le.\u0275fac=function(ne){return new(ne||le)},le.\u0275mod=d.oAB({type:le}),le.\u0275inj=d.cJS({}),le})();function oi(le){return"number"==typeof le?le:parseFloat(le)}let Pi=(()=>{class le{constructor(){this._validator=Ct}ngOnChanges(ne){if(this.inputName in ne){const Ue=this.normalizeInput(ne[this.inputName].currentValue);this._enabled=this.enabled(Ue),this._validator=this._enabled?this.createValidator(Ue):Ct,this._onChange&&this._onChange()}}validate(ne){return this._validator(ne)}registerOnValidatorChange(ne){this._onChange=ne}enabled(ne){return null!=ne}}return le.\u0275fac=function(ne){return new(ne||le)},le.\u0275dir=d.lG2({type:le,features:[d.TTD]}),le})();const Mi={provide:je,useExisting:(0,d.Gpc)(()=>bi),multi:!0};let bi=(()=>{class le extends Pi{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=ne=>oi(ne),this.createValidator=ne=>function He(le){return ee=>{if(me(ee.value)||me(le))return null;const ne=parseFloat(ee.value);return!isNaN(ne)&&ne>le?{max:{max:le,actual:ee.value}}:null}}(ne)}}return le.\u0275fac=function(){let ee;return function(Ue){return(ee||(ee=d.n5z(le)))(Ue||le)}}(),le.\u0275dir=d.lG2({type:le,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(ne,Ue){2&ne&&d.uIk("max",Ue._enabled?Ue.max:null)},inputs:{max:"max"},features:[d._Bn([Mi]),d.qOj]}),le})();const gr={provide:je,useExisting:(0,d.Gpc)(()=>Di),multi:!0};let Di=(()=>{class le extends Pi{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=ne=>oi(ne),this.createValidator=ne=>function Ve(le){return ee=>{if(me(ee.value)||me(le))return null;const ne=parseFloat(ee.value);return!isNaN(ne)&&ne<le?{min:{min:le,actual:ee.value}}:null}}(ne)}}return le.\u0275fac=function(){let ee;return function(Ue){return(ee||(ee=d.n5z(le)))(Ue||le)}}(),le.\u0275dir=d.lG2({type:le,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(ne,Ue){2&ne&&d.uIk("min",Ue._enabled?Ue.min:null)},inputs:{min:"min"},features:[d._Bn([gr]),d.qOj]}),le})(),Yn=(()=>{class le{}return le.\u0275fac=function(ne){return new(ne||le)},le.\u0275mod=d.oAB({type:le}),le.\u0275inj=d.cJS({imports:[[Bt]]}),le})(),Mr=(()=>{class le{}return le.\u0275fac=function(ne){return new(ne||le)},le.\u0275mod=d.oAB({type:le}),le.\u0275inj=d.cJS({imports:[Yn]}),le})()},3334:(_n,Ke,k)=>{"use strict";k.d(Ke,{gz:()=>Ui,y6:()=>vo,OD:()=>Ut,eC:()=>re,wN:()=>va,F0:()=>Wo,rH:()=>xa,Bz:()=>Ml,Hx:()=>Oi});var d=k(6895),c=k(6738),V=k(2866),a=k(6688),O=k(3489);class A extends O.L{notifyNext(R,P,X,he,Fe){this.destination.next(P)}notifyError(R,P){this.destination.error(R)}notifyComplete(R){this.destination.complete()}}class p extends O.L{constructor(R,P,X){super(),this.parent=R,this.outerValue=P,this.outerIndex=X,this.index=0}_next(R){this.parent.notifyNext(this.outerValue,R,this.outerIndex,this.index++,this)}_error(R){this.parent.notifyError(R,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var L=k(9249),Q=k(2916);function Z($,R,P,X,he=new p($,P,X)){if(!he.closed)return R instanceof Q.y?R.subscribe(he):(0,L.s)(R)(he)}var z=k(3009);const G={};class ye{constructor(R){this.resultSelector=R}call(R,P){return P.subscribe(new me(R,this.resultSelector))}}class me extends A{constructor(R,P){super(R),this.resultSelector=P,this.active=0,this.values=[],this.observables=[]}_next(R){this.values.push(G),this.observables.push(R)}_complete(){const R=this.observables,P=R.length;if(0===P)this.destination.complete();else{this.active=P,this.toRespond=P;for(let X=0;X<P;X++)this.add(Z(this,R[X],void 0,X))}}notifyComplete(R){0==(this.active-=1)&&this.destination.complete()}notifyNext(R,P,X){const he=this.values,pt=this.toRespond?he[X]===G?--this.toRespond:this.toRespond:0;he[X]=P,0===pt&&(this.resultSelector?this._tryResultSelector(he):this.destination.next(he.slice()))}_tryResultSelector(R){let P;try{P=this.resultSelector.apply(this,R)}catch(X){return void this.destination.error(X)}this.destination.next(P)}}const je=(()=>{function $(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return $.prototype=Object.create(Error.prototype),$})();var rt=k(5254),Ae=k(1086),Ze=k(591),Ve=k(1221),He=k(8514),Ne=k(8896),xt=k(1762),Je=k(8929);function wt($,R){let P=!1;return arguments.length>=2&&(P=!0),function(he){return he.lift(new Tt($,R,P))}}class Tt{constructor(R,P,X=!1){this.accumulator=R,this.seed=P,this.hasSeed=X}call(R,P){return P.subscribe(new Ct(R,this.accumulator,this.seed,this.hasSeed))}}class Ct extends O.L{constructor(R,P,X,he){super(R),this.accumulator=P,this._seed=X,this.hasSeed=he,this.index=0}get seed(){return this._seed}set seed(R){this.hasSeed=!0,this._seed=R}_next(R){if(this.hasSeed)return this._tryNext(R);this.seed=R,this.destination.next(R)}_tryNext(R){const P=this.index++;let X;try{X=this.accumulator(this.seed,R,P)}catch(he){this.destination.error(he)}this.seed=X,this.destination.next(X)}}var gt=k(1177);function Lt($){return function(P){const X=new Ht($),he=P.lift(X);return X.caught=he}}class Ht{constructor(R){this.selector=R}call(R,P){return P.subscribe(new Vn(R,this.selector,this.caught))}}class Vn extends gt.Ds{constructor(R,P,X){super(R),this.selector=P,this.caught=X}error(R){if(!this.isStopped){let P;try{P=this.selector(R,this.caught)}catch(Fe){return void super.error(Fe)}this._unsubscribeAndRecycle();const X=new gt.IY(this);this.add(X);const he=(0,gt.ft)(P,X);he!==X&&this.add(he)}}}var Ft=k(2198),Wt=k(4231);function Gt($){return function(P){return 0===$?(0,Ne.c)():P.lift(new Jt($))}}class Jt{constructor(R){if(this.total=R,this.total<0)throw new Wt.W}call(R,P){return P.subscribe(new an(R,this.total))}}class an extends O.L{constructor(R,P){super(R),this.total=P,this.ring=new Array,this.count=0}_next(R){const P=this.ring,X=this.total,he=this.count++;P.length<X?P.push(R):P[he%X]=R}_complete(){const R=this.destination;let P=this.count;if(P>0){const X=this.count>=this.total?this.total:this.count,he=this.ring;for(let Fe=0;Fe<X;Fe++){const pt=P++%X;R.next(he[pt])}}R.complete()}}function Jn($=Bn){return R=>R.lift(new si($))}class si{constructor(R){this.errorFactory=R}call(R,P){return P.subscribe(new di(R,this.errorFactory))}}class di extends O.L{constructor(R,P){super(R),this.errorFactory=P,this.hasValue=!1}_next(R){this.hasValue=!0,this.destination.next(R)}_complete(){if(this.hasValue)return this.destination.complete();{let R;try{R=this.errorFactory()}catch(P){R=P}this.destination.error(R)}}}function Bn(){return new je}function ln($=null){return R=>R.lift(new Et($))}class Et{constructor(R){this.defaultValue=R}call(R,P){return P.subscribe(new Kt(R,this.defaultValue))}}class Kt extends O.L{constructor(R,P){super(R),this.defaultValue=P,this.isEmpty=!0}_next(R){this.isEmpty=!1,this.destination.next(R)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var Hn=k(5379),ti=k(2986);function mi($,R){const P=arguments.length>=2;return X=>X.pipe($?(0,Ft.h)((he,Fe)=>$(he,Fe,X)):Hn.y,(0,ti.q)(1),P?ln(R):Jn(()=>new je))}function ir(){}var _r=k(7043);function er($,R,P){return function(he){return he.lift(new Ri($,R,P))}}class Ri{constructor(R,P,X){this.nextOrObserver=R,this.error=P,this.complete=X}call(R,P){return P.subscribe(new mr(R,this.nextOrObserver,this.error,this.complete))}}class mr extends O.L{constructor(R,P,X,he){super(R),this._tapNext=ir,this._tapError=ir,this._tapComplete=ir,this._tapError=X||ir,this._tapComplete=he||ir,(0,_r.m)(P)?(this._context=this,this._tapNext=P):P&&(this._context=P,this._tapNext=P.next||ir,this._tapError=P.error||ir,this._tapComplete=P.complete||ir)}_next(R){try{this._tapNext.call(this._context,R)}catch(P){return void this.destination.error(P)}this.destination.next(R)}_error(R){try{this._tapError.call(this._context,R)}catch(P){return void this.destination.error(P)}this.destination.error(R)}_complete(){try{this._tapComplete.call(this._context)}catch(R){return void this.destination.error(R)}return this.destination.complete()}}var Si=k(2654);class Qt{constructor(R){this.callback=R}call(R,P){return P.subscribe(new et(R,this.callback))}}class et extends O.L{constructor(R,P){super(R),this.add(new Si.w(P))}}var de=k(4850),Pe=k(7545),ft=k(1406),Be=k(1709),$t=k(4327),xe=k(9146);class Ie{constructor(R,P){this.id=R,this.url=P}}class Ut extends Ie{constructor(R,P,X="imperative",he=null){super(R,P),this.navigationTrigger=X,this.restoredState=he}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class nn extends Ie{constructor(R,P,X){super(R,P),this.urlAfterRedirects=X}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class ni extends Ie{constructor(R,P,X){super(R,P),this.reason=X}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class cr extends Ie{constructor(R,P,X){super(R,P),this.error=X}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Li extends Ie{constructor(R,P,X,he){super(R,P),this.urlAfterRedirects=X,this.state=he}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ei extends Ie{constructor(R,P,X,he){super(R,P),this.urlAfterRedirects=X,this.state=he}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class xi extends Ie{constructor(R,P,X,he,Fe){super(R,P),this.urlAfterRedirects=X,this.state=he,this.shouldActivate=Fe}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class vr extends Ie{constructor(R,P,X,he){super(R,P),this.urlAfterRedirects=X,this.state=he}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ji extends Ie{constructor(R,P,X,he){super(R,P),this.urlAfterRedirects=X,this.state=he}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ir{constructor(R){this.route=R}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class $i{constructor(R){this.route=R}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Gr{constructor(R){this.snapshot=R}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class eo{constructor(R){this.snapshot=R}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class zr{constructor(R){this.snapshot=R}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Xi{constructor(R){this.snapshot=R}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ur{constructor(R,P,X){this.routerEvent=R,this.position=P,this.anchor=X}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const re="primary";class K{constructor(R){this.params=R||{}}has(R){return Object.prototype.hasOwnProperty.call(this.params,R)}get(R){if(this.has(R)){const P=this.params[R];return Array.isArray(P)?P[0]:P}return null}getAll(R){if(this.has(R)){const P=this.params[R];return Array.isArray(P)?P:[P]}return[]}get keys(){return Object.keys(this.params)}}function F($){return new K($)}const fe="ngNavigationCancelingError";function _e($){const R=Error("NavigationCancelingError: "+$);return R[fe]=!0,R}function vt($,R,P){const X=P.path.split("/");if(X.length>$.length||"full"===P.pathMatch&&(R.hasChildren()||X.length<$.length))return null;const he={};for(let Fe=0;Fe<X.length;Fe++){const pt=X[Fe],It=$[Fe];if(pt.startsWith(":"))he[pt.substring(1)]=It;else if(pt!==It.path)return null}return{consumed:$.slice(0,X.length),posParams:he}}function tt($,R){const P=$?Object.keys($):void 0,X=R?Object.keys(R):void 0;if(!P||!X||P.length!=X.length)return!1;let he;for(let Fe=0;Fe<P.length;Fe++)if(he=P[Fe],!Zt($[he],R[he]))return!1;return!0}function Zt($,R){if(Array.isArray($)&&Array.isArray(R)){if($.length!==R.length)return!1;const P=[...$].sort(),X=[...R].sort();return P.every((he,Fe)=>X[Fe]===he)}return $===R}function on($){return Array.prototype.concat.apply([],$)}function sn($){return $.length>0?$[$.length-1]:null}function Nn($,R){for(const P in $)$.hasOwnProperty(P)&&R($[P],P)}function Wn($){return(0,c.CqO)($)?$:(0,c.QGY)($)?(0,rt.D)(Promise.resolve($)):(0,Ae.of)($)}const Kn={exact:function vi($,R,P){if(!qr($.segments,R.segments)||!Gi($.segments,R.segments,P)||$.numberOfChildren!==R.numberOfChildren)return!1;for(const X in R.children)if(!$.children[X]||!vi($.children[X],R.children[X],P))return!1;return!0},subset:Ai},ui={exact:function Hi($,R){return tt($,R)},subset:function Pn($,R){return Object.keys(R).length<=Object.keys($).length&&Object.keys(R).every(P=>Zt($[P],R[P]))},ignored:()=>!0};function Qi($,R,P){return Kn[P.paths]($.root,R.root,P.matrixParams)&&ui[P.queryParams]($.queryParams,R.queryParams)&&!("exact"===P.fragment&&$.fragment!==R.fragment)}function Ai($,R,P){return Bi($,R,R.segments,P)}function Bi($,R,P,X){if($.segments.length>P.length){const he=$.segments.slice(0,P.length);return!(!qr(he,P)||R.hasChildren()||!Gi(he,P,X))}if($.segments.length===P.length){if(!qr($.segments,P)||!Gi($.segments,P,X))return!1;for(const he in R.children)if(!$.children[he]||!Ai($.children[he],R.children[he],X))return!1;return!0}{const he=P.slice(0,$.segments.length),Fe=P.slice($.segments.length);return!!(qr($.segments,he)&&Gi($.segments,he,X)&&$.children[re])&&Bi($.children[re],R,Fe,X)}}function Gi($,R,P){return R.every((X,he)=>ui[P]($[he].parameters,X.parameters))}class Ar{constructor(R,P,X){this.root=R,this.queryParams=P,this.fragment=X}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=F(this.queryParams)),this._queryParamMap}toString(){return to.serialize(this)}}class hi{constructor(R,P){this.segments=R,this.children=P,this.parent=null,Nn(P,(X,he)=>X.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return uo(this)}}class Cr{constructor(R,P){this.path=R,this.parameters=P}get parameterMap(){return this._parameterMap||(this._parameterMap=F(this.parameters)),this._parameterMap}toString(){return Rt(this)}}function qr($,R){return $.length===R.length&&$.every((P,X)=>P.path===R[X].path)}class Oi{}class yo{parse(R){const P=new qi(R);return new Ar(P.parseRootSegment(),P.parseQueryParams(),P.parseFragment())}serialize(R){const P=`/${Lr(R.root,!0)}`,X=function rn($){const R=Object.keys($).map(P=>{const X=$[P];return Array.isArray(X)?X.map(he=>`${Pr(P)}=${Pr(he)}`).join("&"):`${Pr(P)}=${Pr(X)}`}).filter(P=>!!P);return R.length?`?${R.join("&")}`:""}(R.queryParams);return`${P}${X}${"string"==typeof R.fragment?`#${function Se($){return encodeURI($)}(R.fragment)}`:""}`}}const to=new yo;function uo($){return $.segments.map(R=>Rt(R)).join("/")}function Lr($,R){if(!$.hasChildren())return uo($);if(R){const P=$.children[re]?Lr($.children[re],!1):"",X=[];return Nn($.children,(he,Fe)=>{Fe!==re&&X.push(`${Fe}:${Lr(he,!1)}`)}),X.length>0?`${P}(${X.join("//")})`:P}{const P=function Ao($,R){let P=[];return Nn($.children,(X,he)=>{he===re&&(P=P.concat(R(X,he)))}),Nn($.children,(X,he)=>{he!==re&&(P=P.concat(R(X,he)))}),P}($,(X,he)=>he===re?[Lr($.children[re],!1)]:[`${he}:${Lr(X,!1)}`]);return 1===Object.keys($.children).length&&null!=$.children[re]?`${uo($)}/${P[0]}`:`${uo($)}/(${P.join("//")})`}}function Sr($){return encodeURIComponent($).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Pr($){return Sr($).replace(/%3B/gi,";")}function Xe($){return Sr($).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Me($){return decodeURIComponent($)}function st($){return Me($.replace(/\+/g,"%20"))}function Rt($){return`${Xe($.path)}${function zt($){return Object.keys($).map(R=>`;${Xe(R)}=${Xe($[R])}`).join("")}($.parameters)}`}const un=/^[^\/()?;=#]+/;function dn($){const R=$.match(un);return R?R[0]:""}const An=/^[^=?&#]+/,Bt=/^[^&#]+/;class qi{constructor(R){this.url=R,this.remaining=R}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new hi([],{}):new hi([],this.parseChildren())}parseQueryParams(){const R={};if(this.consumeOptional("?"))do{this.parseQueryParam(R)}while(this.consumeOptional("&"));return R}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const R=[];for(this.peekStartsWith("(")||R.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),R.push(this.parseSegment());let P={};this.peekStartsWith("/(")&&(this.capture("/"),P=this.parseParens(!0));let X={};return this.peekStartsWith("(")&&(X=this.parseParens(!1)),(R.length>0||Object.keys(P).length>0)&&(X[re]=new hi(R,P)),X}parseSegment(){const R=dn(this.remaining);if(""===R&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(R),new Cr(Me(R),this.parseMatrixParams())}parseMatrixParams(){const R={};for(;this.consumeOptional(";");)this.parseParam(R);return R}parseParam(R){const P=dn(this.remaining);if(!P)return;this.capture(P);let X="";if(this.consumeOptional("=")){const he=dn(this.remaining);he&&(X=he,this.capture(X))}R[Me(P)]=Me(X)}parseQueryParam(R){const P=function qn($){const R=$.match(An);return R?R[0]:""}(this.remaining);if(!P)return;this.capture(P);let X="";if(this.consumeOptional("=")){const pt=function hn($){const R=$.match(Bt);return R?R[0]:""}(this.remaining);pt&&(X=pt,this.capture(X))}const he=st(P),Fe=st(X);if(R.hasOwnProperty(he)){let pt=R[he];Array.isArray(pt)||(pt=[pt],R[he]=pt),pt.push(Fe)}else R[he]=Fe}parseParens(R){const P={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const X=dn(this.remaining),he=this.remaining[X.length];if("/"!==he&&")"!==he&&";"!==he)throw new Error(`Cannot parse url '${this.url}'`);let Fe;X.indexOf(":")>-1?(Fe=X.substr(0,X.indexOf(":")),this.capture(Fe),this.capture(":")):R&&(Fe=re);const pt=this.parseChildren();P[Fe]=1===Object.keys(pt).length?pt[re]:new hi([],pt),this.consumeOptional("//")}return P}peekStartsWith(R){return this.remaining.startsWith(R)}consumeOptional(R){return!!this.peekStartsWith(R)&&(this.remaining=this.remaining.substring(R.length),!0)}capture(R){if(!this.consumeOptional(R))throw new Error(`Expected "${R}".`)}}class no{constructor(R){this._root=R}get root(){return this._root.value}parent(R){const P=this.pathFromRoot(R);return P.length>1?P[P.length-2]:null}children(R){const P=rr(R,this._root);return P?P.children.map(X=>X.value):[]}firstChild(R){const P=rr(R,this._root);return P&&P.children.length>0?P.children[0].value:null}siblings(R){const P=Br(R,this._root);return P.length<2?[]:P[P.length-2].children.map(he=>he.value).filter(he=>he!==R)}pathFromRoot(R){return Br(R,this._root).map(P=>P.value)}}function rr($,R){if($===R.value)return R;for(const P of R.children){const X=rr($,P);if(X)return X}return null}function Br($,R){if($===R.value)return[R];for(const P of R.children){const X=Br($,P);if(X.length)return X.unshift(R),X}return[]}class pr{constructor(R,P){this.value=R,this.children=P}toString(){return`TreeNode(${this.value})`}}function Lo($){const R={};return $&&$.children.forEach(P=>R[P.value.outlet]=P),R}class mo extends no{constructor(R,P){super(R),this.snapshot=P,At(this,R)}toString(){return this.snapshot.toString()}}function jn($,R){const P=function Wi($,R){const pt=new nt([],{},{},"",{},re,R,null,$.root,-1,{});return new ke("",new pr(pt,[]))}($,R),X=new Ze.X([new Cr("",{})]),he=new Ze.X({}),Fe=new Ze.X({}),pt=new Ze.X({}),It=new Ze.X(""),Tn=new Ui(X,he,pt,It,Fe,re,R,P.root);return Tn.snapshot=P.root,new mo(new pr(Tn,[]),P)}class Ui{constructor(R,P,X,he,Fe,pt,It,Tn){this.url=R,this.params=P,this.queryParams=X,this.fragment=he,this.data=Fe,this.outlet=pt,this.component=It,this._futureSnapshot=Tn}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,de.U)(R=>F(R)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,de.U)(R=>F(R)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function wo($,R="emptyOnly"){const P=$.pathFromRoot;let X=0;if("always"!==R)for(X=P.length-1;X>=1;){const he=P[X],Fe=P[X-1];if(he.routeConfig&&""===he.routeConfig.path)X--;else{if(Fe.component)break;X--}}return function at($){return $.reduce((R,P)=>({params:{...R.params,...P.params},data:{...R.data,...P.data},resolve:{...R.resolve,...P._resolvedData}}),{params:{},data:{},resolve:{}})}(P.slice(X))}class nt{constructor(R,P,X,he,Fe,pt,It,Tn,Ii,ao,Ji){this.url=R,this.params=P,this.queryParams=X,this.fragment=he,this.data=Fe,this.outlet=pt,this.component=It,this.routeConfig=Tn,this._urlSegment=Ii,this._lastPathIndex=ao,this._resolve=Ji}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=F(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=F(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(X=>X.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ke extends no{constructor(R,P){super(P),this.url=R,At(this,P)}toString(){return en(this._root)}}function At($,R){R.value._routerState=$,R.children.forEach(P=>At($,P))}function en($){const R=$.children.length>0?` { ${$.children.map(en).join(", ")} } `:"";return`${$.value}${R}`}function pi($){if($.snapshot){const R=$.snapshot,P=$._futureSnapshot;$.snapshot=P,tt(R.queryParams,P.queryParams)||$.queryParams.next(P.queryParams),R.fragment!==P.fragment&&$.fragment.next(P.fragment),tt(R.params,P.params)||$.params.next(P.params),function kt($,R){if($.length!==R.length)return!1;for(let P=0;P<$.length;++P)if(!tt($[P],R[P]))return!1;return!0}(R.url,P.url)||$.url.next(P.url),tt(R.data,P.data)||$.data.next(P.data)}else $.snapshot=$._futureSnapshot,$.data.next($._futureSnapshot.data)}function fi($,R){const P=tt($.params,R.params)&&function xr($,R){return qr($,R)&&$.every((P,X)=>tt(P.parameters,R[X].parameters))}($.url,R.url);return P&&!(!$.parent!=!R.parent)&&(!$.parent||fi($.parent,R.parent))}function ie($,R,P){if(P&&$.shouldReuseRoute(R.value,P.value.snapshot)){const X=P.value;X._futureSnapshot=R.value;const he=function ue($,R,P){return R.children.map(X=>{for(const he of P.children)if($.shouldReuseRoute(X.value,he.value.snapshot))return ie($,X,he);return ie($,X)})}($,R,P);return new pr(X,he)}{if($.shouldAttach(R.value)){const Fe=$.retrieve(R.value);if(null!==Fe){const pt=Fe.route;return pt.value._futureSnapshot=R.value,pt.children=R.children.map(It=>ie($,It)),pt}}const X=function we($){return new Ui(new Ze.X($.url),new Ze.X($.params),new Ze.X($.queryParams),new Ze.X($.fragment),new Ze.X($.data),$.outlet,$.component,$)}(R.value),he=R.children.map(Fe=>ie($,Fe));return new pr(X,he)}}function Dt($){return"object"==typeof $&&null!=$&&!$.outlets&&!$.segmentPath}function ht($){return"object"==typeof $&&null!=$&&$.outlets}function fn($,R,P,X,he){let Fe={};return X&&Nn(X,(pt,It)=>{Fe[It]=Array.isArray(pt)?pt.map(Tn=>`${Tn}`):`${pt}`}),new Ar(P.root===$?R:Dn(P.root,$,R),Fe,he)}function Dn($,R,P){const X={};return Nn($.children,(he,Fe)=>{X[Fe]=he===R?P:Dn(he,R,P)}),new hi($.segments,X)}class yn{constructor(R,P,X){if(this.isAbsolute=R,this.numberOfDoubleDots=P,this.commands=X,R&&X.length>0&&Dt(X[0]))throw new Error("Root segment cannot have matrix parameters");const he=X.find(ht);if(he&&he!==sn(X))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class Pi{constructor(R,P,X){this.segmentGroup=R,this.processChildren=P,this.index=X}}function Di($,R,P){if($||($=new hi([],{})),0===$.segments.length&&$.hasChildren())return Ci($,R,P);const X=function dr($,R,P){let X=0,he=R;const Fe={match:!1,pathIndex:0,commandIndex:0};for(;he<$.segments.length;){if(X>=P.length)return Fe;const pt=$.segments[he],It=P[X];if(ht(It))break;const Tn=`${It}`,Ii=X<P.length-1?P[X+1]:null;if(he>0&&void 0===Tn)break;if(Tn&&Ii&&"object"==typeof Ii&&void 0===Ii.outlets){if(!Hr(Tn,Ii,pt))return Fe;X+=2}else{if(!Hr(Tn,{},pt))return Fe;X++}he++}return{match:!0,pathIndex:he,commandIndex:X}}($,R,P),he=P.slice(X.commandIndex);if(X.match&&X.pathIndex<$.segments.length){const Fe=new hi($.segments.slice(0,X.pathIndex),{});return Fe.children[re]=new hi($.segments.slice(X.pathIndex),$.children),Ci(Fe,0,he)}return X.match&&0===he.length?new hi($.segments,{}):X.match&&!$.hasChildren()?nr($,R,P):X.match?Ci($,0,he):nr($,R,P)}function Ci($,R,P){if(0===P.length)return new hi($.segments,{});{const X=function gr($){return ht($[0])?$[0].outlets:{[re]:$}}(P),he={};return Nn(X,(Fe,pt)=>{"string"==typeof Fe&&(Fe=[Fe]),null!==Fe&&(he[pt]=Di($.children[pt],R,Fe))}),Nn($.children,(Fe,pt)=>{void 0===X[pt]&&(he[pt]=Fe)}),new hi($.segments,he)}}function nr($,R,P){const X=$.segments.slice(0,R);let he=0;for(;he<P.length;){const Fe=P[he];if(ht(Fe)){const Tn=io(Fe.outlets);return new hi(X,Tn)}if(0===he&&Dt(P[0])){X.push(new Cr($.segments[R].path,ho(P[0]))),he++;continue}const pt=ht(Fe)?Fe.outlets[re]:`${Fe}`,It=he<P.length-1?P[he+1]:null;pt&&It&&Dt(It)?(X.push(new Cr(pt,ho(It))),he+=2):(X.push(new Cr(pt,{})),he++)}return new hi(X,{})}function io($){const R={};return Nn($,(P,X)=>{"string"==typeof P&&(P=[P]),null!==P&&(R[X]=nr(new hi([],{}),0,P))}),R}function ho($){const R={};return Nn($,(P,X)=>R[X]=`${P}`),R}function Hr($,R,P){return $==P.path&&tt(R,P.parameters)}class Wr{constructor(R,P,X,he){this.routeReuseStrategy=R,this.futureState=P,this.currState=X,this.forwardEvent=he}activate(R){const P=this.futureState._root,X=this.currState?this.currState._root:null;this.deactivateChildRoutes(P,X,R),pi(this.futureState.root),this.activateChildRoutes(P,X,R)}deactivateChildRoutes(R,P,X){const he=Lo(P);R.children.forEach(Fe=>{const pt=Fe.value.outlet;this.deactivateRoutes(Fe,he[pt],X),delete he[pt]}),Nn(he,(Fe,pt)=>{this.deactivateRouteAndItsChildren(Fe,X)})}deactivateRoutes(R,P,X){const he=R.value,Fe=P?P.value:null;if(he===Fe)if(he.component){const pt=X.getContext(he.outlet);pt&&this.deactivateChildRoutes(R,P,pt.children)}else this.deactivateChildRoutes(R,P,X);else Fe&&this.deactivateRouteAndItsChildren(P,X)}deactivateRouteAndItsChildren(R,P){R.value.component&&this.routeReuseStrategy.shouldDetach(R.value.snapshot)?this.detachAndStoreRouteSubtree(R,P):this.deactivateRouteAndOutlet(R,P)}detachAndStoreRouteSubtree(R,P){const X=P.getContext(R.value.outlet),he=X&&R.value.component?X.children:P,Fe=Lo(R);for(const pt of Object.keys(Fe))this.deactivateRouteAndItsChildren(Fe[pt],he);if(X&&X.outlet){const pt=X.outlet.detach(),It=X.children.onOutletDeactivated();this.routeReuseStrategy.store(R.value.snapshot,{componentRef:pt,route:R,contexts:It})}}deactivateRouteAndOutlet(R,P){const X=P.getContext(R.value.outlet),he=X&&R.value.component?X.children:P,Fe=Lo(R);for(const pt of Object.keys(Fe))this.deactivateRouteAndItsChildren(Fe[pt],he);X&&X.outlet&&(X.outlet.deactivate(),X.children.onOutletDeactivated(),X.attachRef=null,X.resolver=null,X.route=null)}activateChildRoutes(R,P,X){const he=Lo(P);R.children.forEach(Fe=>{this.activateRoutes(Fe,he[Fe.value.outlet],X),this.forwardEvent(new Xi(Fe.value.snapshot))}),R.children.length&&this.forwardEvent(new eo(R.value.snapshot))}activateRoutes(R,P,X){const he=R.value,Fe=P?P.value:null;if(pi(he),he===Fe)if(he.component){const pt=X.getOrCreateContext(he.outlet);this.activateChildRoutes(R,P,pt.children)}else this.activateChildRoutes(R,P,X);else if(he.component){const pt=X.getOrCreateContext(he.outlet);if(this.routeReuseStrategy.shouldAttach(he.snapshot)){const It=this.routeReuseStrategy.retrieve(he.snapshot);this.routeReuseStrategy.store(he.snapshot,null),pt.children.onOutletReAttached(It.contexts),pt.attachRef=It.componentRef,pt.route=It.route.value,pt.outlet&&pt.outlet.attach(It.componentRef,It.route.value),pi(It.route.value),this.activateChildRoutes(R,null,pt.children)}else{const It=function se($){for(let R=$.parent;R;R=R.parent){const P=R.routeConfig;if(P&&P._loadedConfig)return P._loadedConfig;if(P&&P.component)return null}return null}(he.snapshot),Tn=It?It.module.componentFactoryResolver:null;pt.attachRef=null,pt.route=he,pt.resolver=Tn,pt.outlet&&pt.outlet.activateWith(he,Tn),this.activateChildRoutes(R,null,pt.children)}}else this.activateChildRoutes(R,null,X)}}class Ce{constructor(R,P){this.routes=R,this.module=P}}function ae($){return"function"==typeof $}function St($){return $ instanceof Ar}const Fr=Symbol("INITIAL_VALUE");function Zi(){return(0,Pe.w)($=>function te(...$){let R,P;return(0,V.K)($[$.length-1])&&(P=$.pop()),"function"==typeof $[$.length-1]&&(R=$.pop()),1===$.length&&(0,a.k)($[0])&&($=$[0]),(0,z.n)($,P).lift(new ye(R))}($.map(R=>R.pipe((0,ti.q)(1),function ct(...$){const R=$[$.length-1];return(0,V.K)(R)?($.pop(),P=>(0,Ve.z)($,P,R)):P=>(0,Ve.z)($,P)}(Fr)))).pipe(wt((R,P)=>{let X=!1;return P.reduce((he,Fe,pt)=>he!==Fr?he:(Fe===Fr&&(X=!0),X||!1!==Fe&&pt!==P.length-1&&!St(Fe)?he:Fe),R)},Fr),(0,Ft.h)(R=>R!==Fr),(0,de.U)(R=>St(R)?R:!0===R),(0,ti.q)(1)))}class Er{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new vo,this.attachRef=null}}class vo{constructor(){this.contexts=new Map}onChildOutletCreated(R,P){const X=this.getOrCreateContext(R);X.outlet=P,this.contexts.set(R,X)}onChildOutletDestroyed(R){const P=this.getContext(R);P&&(P.outlet=null,P.attachRef=null)}onOutletDeactivated(){const R=this.contexts;return this.contexts=new Map,R}onOutletReAttached(R){this.contexts=R}getOrCreateContext(R){let P=this.getContext(R);return P||(P=new Er,this.contexts.set(R,P)),P}getContext(R){return this.contexts.get(R)||null}}let le=(()=>{class ${constructor(P,X,he,Fe,pt){this.parentContexts=P,this.location=X,this.resolver=he,this.changeDetector=pt,this.activated=null,this._activatedRoute=null,this.activateEvents=new c.vpe,this.deactivateEvents=new c.vpe,this.attachEvents=new c.vpe,this.detachEvents=new c.vpe,this.name=Fe||re,P.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const P=this.parentContexts.getContext(this.name);P&&P.route&&(P.attachRef?this.attach(P.attachRef,P.route):this.activateWith(P.route,P.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const P=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(P.instance),P}attach(P,X){this.activated=P,this._activatedRoute=X,this.location.insert(P.hostView),this.attachEvents.emit(P.instance)}deactivate(){if(this.activated){const P=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(P)}}activateWith(P,X){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=P;const pt=(X=X||this.resolver).resolveComponentFactory(P._futureSnapshot.routeConfig.component),It=this.parentContexts.getOrCreateContext(this.name).children,Tn=new ee(P,It,this.location.injector);this.activated=this.location.createComponent(pt,this.location.length,Tn),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return $.\u0275fac=function(P){return new(P||$)(c.Y36(vo),c.Y36(c.s_b),c.Y36(c._Vd),c.$8M("name"),c.Y36(c.sBO))},$.\u0275dir=c.lG2({type:$,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),$})();class ee{constructor(R,P,X){this.route=R,this.childContexts=P,this.parent=X}get(R,P){return R===Ui?this.route:R===vo?this.childContexts:this.parent.get(R,P)}}let ne=(()=>{class ${}return $.\u0275fac=function(P){return new(P||$)},$.\u0275cmp=c.Xpm({type:$,selectors:[["ng-component"]],decls:1,vars:0,template:function(P,X){1&P&&c._UZ(0,"router-outlet")},directives:[le],encapsulation:2}),$})();function Ue($,R=""){for(let P=0;P<$.length;P++){const X=$[P];pn(X,ri(R,X))}}function pn($,R){$.children&&Ue($.children,R)}function ri($,R){return R?$||R.path?$&&!R.path?`${$}/`:!$&&R.path?R.path:`${$}/${R.path}`:"":$}function Yr($){const R=$.children&&$.children.map(Yr),P=R?{...$,children:R}:{...$};return!P.component&&(R||P.loadChildren)&&P.outlet&&P.outlet!==re&&(P.component=ne),P}function Jr($){return $.outlet||re}function es($,R){const P=$.filter(X=>Jr(X)===R);return P.push(...$.filter(X=>Jr(X)!==R)),P}const jo={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function zs($,R,P){if(""===R.path)return"full"===R.pathMatch&&($.hasChildren()||P.length>0)?{...jo}:{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const he=(R.matcher||vt)(P,$,R);if(!he)return{...jo};const Fe={};Nn(he.posParams,(It,Tn)=>{Fe[Tn]=It.path});const pt=he.consumed.length>0?{...Fe,...he.consumed[he.consumed.length-1].parameters}:Fe;return{matched:!0,consumedSegments:he.consumed,lastChild:he.consumed.length,parameters:pt,positionalParamSegments:he.posParams??{}}}function Ps($,R,P,X,he="corrected"){if(P.length>0&&function ka($,R,P){return P.some(X=>ra($,R,X)&&Jr(X)!==re)}($,P,X)){const pt=new hi(R,function Pa($,R,P,X){const he={};he[re]=X,X._sourceSegment=$,X._segmentIndexShift=R.length;for(const Fe of P)if(""===Fe.path&&Jr(Fe)!==re){const pt=new hi([],{});pt._sourceSegment=$,pt._segmentIndexShift=R.length,he[Jr(Fe)]=pt}return he}($,R,X,new hi(P,$.children)));return pt._sourceSegment=$,pt._segmentIndexShift=R.length,{segmentGroup:pt,slicedSegments:[]}}if(0===P.length&&function Zr($,R,P){return P.some(X=>ra($,R,X))}($,P,X)){const pt=new hi($.segments,function tr($,R,P,X,he,Fe){const pt={};for(const It of X)if(ra($,P,It)&&!he[Jr(It)]){const Tn=new hi([],{});Tn._sourceSegment=$,Tn._segmentIndexShift="legacy"===Fe?$.segments.length:R.length,pt[Jr(It)]=Tn}return{...he,...pt}}($,R,P,X,$.children,he));return pt._sourceSegment=$,pt._segmentIndexShift=R.length,{segmentGroup:pt,slicedSegments:P}}const Fe=new hi($.segments,$.children);return Fe._sourceSegment=$,Fe._segmentIndexShift=R.length,{segmentGroup:Fe,slicedSegments:P}}function ra($,R,P){return(!($.hasChildren()||R.length>0)||"full"!==P.pathMatch)&&""===P.path}function sl($,R,P,X){return!!(Jr($)===X||X!==re&&ra(R,P,$))&&("**"===$.path||zs(R,$,P).matched)}function Es($,R,P){return 0===R.length&&!$.children[P]}class oa{constructor(R){this.segmentGroup=R||null}}class Rn{constructor(R){this.urlTree=R}}function Dr($){return new Q.y(R=>R.error(new oa($)))}function Xl($){return new Q.y(R=>R.error(new Rn($)))}function Zo($){return new Q.y(R=>R.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${$}'`)))}class hs{constructor(R,P,X,he,Fe){this.configLoader=P,this.urlSerializer=X,this.urlTree=he,this.config=Fe,this.allowRedirects=!0,this.ngModule=R.get(c.h0i)}apply(){const R=Ps(this.urlTree.root,[],[],this.config).segmentGroup,P=new hi(R.segments,R.children);return this.expandSegmentGroup(this.ngModule,this.config,P,re).pipe((0,de.U)(Fe=>this.createUrlTree(Oa(Fe),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Lt(Fe=>{if(Fe instanceof Rn)return this.allowRedirects=!1,this.match(Fe.urlTree);throw Fe instanceof oa?this.noMatchError(Fe):Fe}))}match(R){return this.expandSegmentGroup(this.ngModule,this.config,R.root,re).pipe((0,de.U)(he=>this.createUrlTree(Oa(he),R.queryParams,R.fragment))).pipe(Lt(he=>{throw he instanceof oa?this.noMatchError(he):he}))}noMatchError(R){return new Error(`Cannot match any routes. URL Segment: '${R.segmentGroup}'`)}createUrlTree(R,P,X){const he=R.segments.length>0?new hi([],{[re]:R}):R;return new Ar(he,P,X)}expandSegmentGroup(R,P,X,he){return 0===X.segments.length&&X.hasChildren()?this.expandChildren(R,P,X).pipe((0,de.U)(Fe=>new hi([],Fe))):this.expandSegment(R,X,P,X.segments,he,!0)}expandChildren(R,P,X){const he=[];for(const Fe of Object.keys(X.children))"primary"===Fe?he.unshift(Fe):he.push(Fe);return(0,rt.D)(he).pipe((0,ft.b)(Fe=>{const pt=X.children[Fe],It=es(P,Fe);return this.expandSegmentGroup(R,It,pt,Fe).pipe((0,de.U)(Tn=>({segment:Tn,outlet:Fe})))}),wt((Fe,pt)=>(Fe[pt.outlet]=pt.segment,Fe),{}),function In($,R){const P=arguments.length>=2;return X=>X.pipe($?(0,Ft.h)((he,Fe)=>$(he,Fe,X)):Hn.y,Gt(1),P?ln(R):Jn(()=>new je))}())}expandSegment(R,P,X,he,Fe,pt){return(0,rt.D)(X).pipe((0,ft.b)(It=>this.expandSegmentAgainstRoute(R,P,X,It,he,Fe,pt).pipe(Lt(Ii=>{if(Ii instanceof oa)return(0,Ae.of)(null);throw Ii}))),mi(It=>!!It),Lt((It,Tn)=>{if(It instanceof je||"EmptyError"===It.name){if(Es(P,he,Fe))return(0,Ae.of)(new hi([],{}));throw new oa(P)}throw It}))}expandSegmentAgainstRoute(R,P,X,he,Fe,pt,It){return sl(he,P,Fe,pt)?void 0===he.redirectTo?this.matchSegmentAgainstRoute(R,P,he,Fe,pt):It&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(R,P,X,he,Fe,pt):Dr(P):Dr(P)}expandSegmentAgainstRouteUsingRedirect(R,P,X,he,Fe,pt){return"**"===he.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(R,X,he,pt):this.expandRegularSegmentAgainstRouteUsingRedirect(R,P,X,he,Fe,pt)}expandWildCardWithParamsAgainstRouteUsingRedirect(R,P,X,he){const Fe=this.applyRedirectCommands([],X.redirectTo,{});return X.redirectTo.startsWith("/")?Xl(Fe):this.lineralizeSegments(X,Fe).pipe((0,Be.zg)(pt=>{const It=new hi(pt,{});return this.expandSegment(R,It,P,pt,he,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(R,P,X,he,Fe,pt){const{matched:It,consumedSegments:Tn,lastChild:Ii,positionalParamSegments:ao}=zs(P,he,Fe);if(!It)return Dr(P);const Ji=this.applyRedirectCommands(Tn,he.redirectTo,ao);return he.redirectTo.startsWith("/")?Xl(Ji):this.lineralizeSegments(he,Ji).pipe((0,Be.zg)(Do=>this.expandSegment(R,P,X,Do.concat(Fe.slice(Ii)),pt,!1)))}matchSegmentAgainstRoute(R,P,X,he,Fe){if("**"===X.path)return X.loadChildren?(X._loadedConfig?(0,Ae.of)(X._loadedConfig):this.configLoader.load(R.injector,X)).pipe((0,de.U)(Do=>(X._loadedConfig=Do,new hi(he,{})))):(0,Ae.of)(new hi(he,{}));const{matched:pt,consumedSegments:It,lastChild:Tn}=zs(P,X,he);if(!pt)return Dr(P);const Ii=he.slice(Tn);return this.getChildConfig(R,X,he).pipe((0,Be.zg)(Ji=>{const Do=Ji.module,lo=Ji.routes,{segmentGroup:Kr,slicedSegments:No}=Ps(P,It,Ii,lo),ys=new hi(Kr.segments,Kr.children);if(0===No.length&&ys.hasChildren())return this.expandChildren(Do,lo,ys).pipe((0,de.U)(Ol=>new hi(It,Ol)));if(0===lo.length&&0===No.length)return(0,Ae.of)(new hi(It,{}));const Os=Jr(X)===Fe;return this.expandSegment(Do,ys,lo,No,Os?re:Fe,!0).pipe((0,de.U)(li=>new hi(It.concat(li.segments),li.children)))}))}getChildConfig(R,P,X){return P.children?(0,Ae.of)(new Ce(P.children,R)):P.loadChildren?void 0!==P._loadedConfig?(0,Ae.of)(P._loadedConfig):this.runCanLoadGuards(R.injector,P,X).pipe((0,Be.zg)(he=>he?this.configLoader.load(R.injector,P).pipe((0,de.U)(Fe=>(P._loadedConfig=Fe,Fe))):function _a($){return new Q.y(R=>R.error(_e(`Cannot load children because the guard of the route "path: '${$.path}'" returned false`)))}(P))):(0,Ae.of)(new Ce([],R))}runCanLoadGuards(R,P,X){const he=P.canLoad;if(!he||0===he.length)return(0,Ae.of)(!0);const Fe=he.map(pt=>{const It=R.get(pt);let Tn;if(function tn($){return $&&ae($.canLoad)}(It))Tn=It.canLoad(P,X);else{if(!ae(It))throw new Error("Invalid CanLoad guard");Tn=It(P,X)}return Wn(Tn)});return(0,Ae.of)(Fe).pipe(Zi(),er(pt=>{if(!St(pt))return;const It=_e(`Redirecting to "${this.urlSerializer.serialize(pt)}"`);throw It.url=pt,It}),(0,de.U)(pt=>!0===pt))}lineralizeSegments(R,P){let X=[],he=P.root;for(;;){if(X=X.concat(he.segments),0===he.numberOfChildren)return(0,Ae.of)(X);if(he.numberOfChildren>1||!he.children[re])return Zo(R.redirectTo);he=he.children[re]}}applyRedirectCommands(R,P,X){return this.applyRedirectCreatreUrlTree(P,this.urlSerializer.parse(P),R,X)}applyRedirectCreatreUrlTree(R,P,X,he){const Fe=this.createSegmentGroup(R,P.root,X,he);return new Ar(Fe,this.createQueryParams(P.queryParams,this.urlTree.queryParams),P.fragment)}createQueryParams(R,P){const X={};return Nn(R,(he,Fe)=>{if("string"==typeof he&&he.startsWith(":")){const It=he.substring(1);X[Fe]=P[It]}else X[Fe]=he}),X}createSegmentGroup(R,P,X,he){const Fe=this.createSegments(R,P.segments,X,he);let pt={};return Nn(P.children,(It,Tn)=>{pt[Tn]=this.createSegmentGroup(R,It,X,he)}),new hi(Fe,pt)}createSegments(R,P,X,he){return P.map(Fe=>Fe.path.startsWith(":")?this.findPosParam(R,Fe,he):this.findOrReturn(Fe,X))}findPosParam(R,P,X){const he=X[P.path.substring(1)];if(!he)throw new Error(`Cannot redirect to '${R}'. Cannot find '${P.path}'.`);return he}findOrReturn(R,P){let X=0;for(const he of P){if(he.path===R.path)return P.splice(X),he;X++}return R}}function Oa($){const R={};for(const X of Object.keys($.children)){const Fe=Oa($.children[X]);(Fe.segments.length>0||Fe.hasChildren())&&(R[X]=Fe)}return function ya($){if(1===$.numberOfChildren&&$.children[re]){const R=$.children[re];return new hi($.segments.concat(R.segments),R.children)}return $}(new hi($.segments,R))}class bc{constructor(R){this.path=R,this.route=this.path[this.path.length-1]}}class Ds{constructor(R,P){this.component=R,this.route=P}}function qs($,R,P){const X=$._root;return W(X,R?R._root:null,P,[X.value])}function To($,R,P){const X=function D($){if(!$)return null;for(let R=$.parent;R;R=R.parent){const P=R.routeConfig;if(P&&P._loadedConfig)return P._loadedConfig}return null}(R);return(X?X.module.injector:P).get($)}function W($,R,P,X,he={canDeactivateChecks:[],canActivateChecks:[]}){const Fe=Lo(R);return $.children.forEach(pt=>{(function E($,R,P,X,he={canDeactivateChecks:[],canActivateChecks:[]}){const Fe=$.value,pt=R?R.value:null,It=P?P.getContext($.value.outlet):null;if(pt&&Fe.routeConfig===pt.routeConfig){const Tn=function Y($,R,P){if("function"==typeof P)return P($,R);switch(P){case"pathParamsChange":return!qr($.url,R.url);case"pathParamsOrQueryParamsChange":return!qr($.url,R.url)||!tt($.queryParams,R.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!fi($,R)||!tt($.queryParams,R.queryParams);default:return!fi($,R)}}(pt,Fe,Fe.routeConfig.runGuardsAndResolvers);Tn?he.canActivateChecks.push(new bc(X)):(Fe.data=pt.data,Fe._resolvedData=pt._resolvedData),W($,R,Fe.component?It?It.children:null:P,X,he),Tn&&It&&It.outlet&&It.outlet.isActivated&&he.canDeactivateChecks.push(new Ds(It.outlet.component,pt))}else pt&&Te(R,It,he),he.canActivateChecks.push(new bc(X)),W($,null,Fe.component?It?It.children:null:P,X,he)})(pt,Fe[pt.value.outlet],P,X.concat([pt.value]),he),delete Fe[pt.value.outlet]}),Nn(Fe,(pt,It)=>Te(pt,P.getContext(It),he)),he}function Te($,R,P){const X=Lo($),he=$.value;Nn(X,(Fe,pt)=>{Te(Fe,he.component?R?R.children.getContext(pt):null:R,P)}),P.canDeactivateChecks.push(new Ds(he.component&&R&&R.outlet&&R.outlet.isActivated?R.outlet.component:null,he))}class Fo{}function ss($){return new Q.y(R=>R.error($))}class al{constructor(R,P,X,he,Fe,pt){this.rootComponentType=R,this.config=P,this.urlTree=X,this.url=he,this.paramsInheritanceStrategy=Fe,this.relativeLinkResolution=pt}recognize(){const R=Ps(this.urlTree.root,[],[],this.config.filter(pt=>void 0===pt.redirectTo),this.relativeLinkResolution).segmentGroup,P=this.processSegmentGroup(this.config,R,re);if(null===P)return null;const X=new nt([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},re,this.rootComponentType,null,this.urlTree.root,-1,{}),he=new pr(X,P),Fe=new ke(this.url,he);return this.inheritParamsAndData(Fe._root),Fe}inheritParamsAndData(R){const P=R.value,X=wo(P,this.paramsInheritanceStrategy);P.params=Object.freeze(X.params),P.data=Object.freeze(X.data),R.children.forEach(he=>this.inheritParamsAndData(he))}processSegmentGroup(R,P,X){return 0===P.segments.length&&P.hasChildren()?this.processChildren(R,P):this.processSegment(R,P,P.segments,X)}processChildren(R,P){const X=[];for(const Fe of Object.keys(P.children)){const pt=P.children[Fe],It=es(R,Fe),Tn=this.processSegmentGroup(It,pt,Fe);if(null===Tn)return null;X.push(...Tn)}const he=ks(X);return function Il($){$.sort((R,P)=>R.value.outlet===re?-1:P.value.outlet===re?1:R.value.outlet.localeCompare(P.value.outlet))}(he),he}processSegment(R,P,X,he){for(const Fe of R){const pt=this.processSegmentAgainstRoute(Fe,P,X,he);if(null!==pt)return pt}return Es(P,X,he)?[]:null}processSegmentAgainstRoute(R,P,X,he){if(R.redirectTo||!sl(R,P,X,he))return null;let Fe,pt=[],It=[];if("**"===R.path){const lo=X.length>0?sn(X).parameters:{};Fe=new nt(X,lo,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,sa(R),Jr(R),R.component,R,Us(P),Co(P)+X.length,wc(R))}else{const lo=zs(P,R,X);if(!lo.matched)return null;pt=lo.consumedSegments,It=X.slice(lo.lastChild),Fe=new nt(pt,lo.parameters,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,sa(R),Jr(R),R.component,R,Us(P),Co(P)+pt.length,wc(R))}const Tn=function Ra($){return $.children?$.children:$.loadChildren?$._loadedConfig.routes:[]}(R),{segmentGroup:Ii,slicedSegments:ao}=Ps(P,pt,It,Tn.filter(lo=>void 0===lo.redirectTo),this.relativeLinkResolution);if(0===ao.length&&Ii.hasChildren()){const lo=this.processChildren(Tn,Ii);return null===lo?null:[new pr(Fe,lo)]}if(0===Tn.length&&0===ao.length)return[new pr(Fe,[])];const Ji=Jr(R)===he,Do=this.processSegment(Tn,Ii,ao,Ji?re:he);return null===Do?null:[new pr(Fe,Do)]}}function Ql($){const R=$.value.routeConfig;return R&&""===R.path&&void 0===R.redirectTo}function ks($){const R=[],P=new Set;for(const X of $){if(!Ql(X)){R.push(X);continue}const he=R.find(Fe=>X.value.routeConfig===Fe.value.routeConfig);void 0!==he?(he.children.push(...X.children),P.add(he)):R.push(X)}for(const X of P){const he=ks(X.children);R.push(new pr(X.value,he))}return R.filter(X=>!P.has(X))}function Us($){let R=$;for(;R._sourceSegment;)R=R._sourceSegment;return R}function Co($){let R=$,P=R._segmentIndexShift?R._segmentIndexShift:0;for(;R._sourceSegment;)R=R._sourceSegment,P+=R._segmentIndexShift?R._segmentIndexShift:0;return P-1}function sa($){return $.data||{}}function wc($){return $.resolve||{}}function kr($){return[...Object.keys($),...Object.getOwnPropertySymbols($)]}function la($){return(0,Pe.w)(R=>{const P=$(R);return P?(0,rt.D)(P).pipe((0,de.U)(()=>R)):(0,Ae.of)(R)})}class va{}class ec extends class Ho{shouldDetach(R){return!1}store(R,P){}shouldAttach(R){return!1}retrieve(R){return null}shouldReuseRoute(R,P){return R.routeConfig===P.routeConfig}}{}const Hs=new c.OlP("ROUTES");class Fa{constructor(R,P,X,he){this.injector=R,this.compiler=P,this.onLoadStartListener=X,this.onLoadEndListener=he}load(R,P){if(P._loader$)return P._loader$;this.onLoadStartListener&&this.onLoadStartListener(P);const he=this.loadModuleFactory(P.loadChildren).pipe((0,de.U)(Fe=>{this.onLoadEndListener&&this.onLoadEndListener(P);const pt=Fe.create(R);return new Ce(on(pt.injector.get(Hs,void 0,c.XFs.Self|c.XFs.Optional)).map(Yr),pt)}),Lt(Fe=>{throw P._loader$=void 0,Fe}));return P._loader$=new xt.c(he,()=>new Je.xQ).pipe((0,$t.x)()),P._loader$}loadModuleFactory(R){return Wn(R()).pipe((0,Be.zg)(P=>P instanceof c.YKP?(0,Ae.of)(P):(0,rt.D)(this.compiler.compileModuleAsync(P))))}}class Cc{shouldProcessUrl(R){return!0}extract(R){return R}merge(R,P){return R}}function Ws($){throw $}function Ba($,R,P){return R.parse("/")}function cl($,R){return(0,Ae.of)(null)}const Ec={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Mu={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Wo=(()=>{class ${constructor(P,X,he,Fe,pt,It,Tn){this.rootComponentType=P,this.urlSerializer=X,this.rootContexts=he,this.location=Fe,this.config=Tn,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Je.xQ,this.errorHandler=Ws,this.malformedUriErrorHandler=Ba,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:cl,afterPreactivation:cl},this.urlHandlingStrategy=new Cc,this.routeReuseStrategy=new ec,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=pt.get(c.h0i),this.console=pt.get(c.c2e);const Ji=pt.get(c.R0b);this.isNgZoneEnabled=Ji instanceof c.R0b&&c.R0b.isInAngularZone(),this.resetConfig(Tn),this.currentUrlTree=function ai(){return new Ar(new hi([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new Fa(pt,It,Do=>this.triggerEvent(new Ir(Do)),Do=>this.triggerEvent(new $i(Do))),this.routerState=jn(this.currentUrlTree,this.rootComponentType),this.transitions=new Ze.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(P){const X=this.events;return P.pipe((0,Ft.h)(he=>0!==he.id),(0,de.U)(he=>({...he,extractedUrl:this.urlHandlingStrategy.extract(he.rawUrl)})),(0,Pe.w)(he=>{let Fe=!1,pt=!1;return(0,Ae.of)(he).pipe(er(It=>{this.currentNavigation={id:It.id,initialUrl:It.currentRawUrl,extractedUrl:It.extractedUrl,trigger:It.source,extras:It.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Pe.w)(It=>{const Tn=this.browserUrlTree.toString(),Ii=!this.navigated||It.extractedUrl.toString()!==Tn||Tn!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||Ii)&&this.urlHandlingStrategy.shouldProcessUrl(It.rawUrl))return ls(It.source)&&(this.browserUrlTree=It.extractedUrl),(0,Ae.of)(It).pipe((0,Pe.w)(Ji=>{const Do=this.transitions.getValue();return X.next(new Ut(Ji.id,this.serializeUrl(Ji.extractedUrl),Ji.source,Ji.restoredState)),Do!==this.transitions.getValue()?Ne.E:Promise.resolve(Ji)}),function Wc($,R,P,X){return(0,Pe.w)(he=>function Gs($,R,P,X,he){return new hs($,R,P,X,he).apply()}($,R,P,he.extractedUrl,X).pipe((0,de.U)(Fe=>({...he,urlAfterRedirects:Fe}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),er(Ji=>{this.currentNavigation={...this.currentNavigation,finalUrl:Ji.urlAfterRedirects}}),function aa($,R,P,X,he){return(0,Be.zg)(Fe=>function ps($,R,P,X,he="emptyOnly",Fe="legacy"){try{const pt=new al($,R,P,X,he,Fe).recognize();return null===pt?ss(new Fo):(0,Ae.of)(pt)}catch(pt){return ss(pt)}}($,R,Fe.urlAfterRedirects,P(Fe.urlAfterRedirects),X,he).pipe((0,de.U)(pt=>({...Fe,targetSnapshot:pt}))))}(this.rootComponentType,this.config,Ji=>this.serializeUrl(Ji),this.paramsInheritanceStrategy,this.relativeLinkResolution),er(Ji=>{if("eager"===this.urlUpdateStrategy){if(!Ji.extras.skipLocationChange){const lo=this.urlHandlingStrategy.merge(Ji.urlAfterRedirects,Ji.rawUrl);this.setBrowserUrl(lo,Ji)}this.browserUrlTree=Ji.urlAfterRedirects}const Do=new Li(Ji.id,this.serializeUrl(Ji.extractedUrl),this.serializeUrl(Ji.urlAfterRedirects),Ji.targetSnapshot);X.next(Do)}));if(Ii&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:Do,extractedUrl:lo,source:Kr,restoredState:No,extras:ys}=It,Os=new Ut(Do,this.serializeUrl(lo),Kr,No);X.next(Os);const $a=jn(lo,this.rootComponentType).snapshot;return(0,Ae.of)({...It,targetSnapshot:$a,urlAfterRedirects:lo,extras:{...ys,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=It.rawUrl,It.resolve(null),Ne.E}),la(It=>{const{targetSnapshot:Tn,id:Ii,extractedUrl:ao,rawUrl:Ji,extras:{skipLocationChange:Do,replaceUrl:lo}}=It;return this.hooks.beforePreactivation(Tn,{navigationId:Ii,appliedUrlTree:ao,rawUrlTree:Ji,skipLocationChange:!!Do,replaceUrl:!!lo})}),er(It=>{const Tn=new Ei(It.id,this.serializeUrl(It.extractedUrl),this.serializeUrl(It.urlAfterRedirects),It.targetSnapshot);this.triggerEvent(Tn)}),(0,de.U)(It=>({...It,guards:qs(It.targetSnapshot,It.currentSnapshot,this.rootContexts)})),function Pt($,R){return(0,Be.zg)(P=>{const{targetSnapshot:X,currentSnapshot:he,guards:{canActivateChecks:Fe,canDeactivateChecks:pt}}=P;return 0===pt.length&&0===Fe.length?(0,Ae.of)({...P,guardsResult:!0}):function kn($,R,P,X){return(0,rt.D)($).pipe((0,Be.zg)(he=>function ro($,R,P,X,he){const Fe=R&&R.routeConfig?R.routeConfig.canDeactivate:null;if(!Fe||0===Fe.length)return(0,Ae.of)(!0);const pt=Fe.map(It=>{const Tn=To(It,R,he);let Ii;if(function Mr($){return $&&ae($.canDeactivate)}(Tn))Ii=Wn(Tn.canDeactivate($,R,P,X));else{if(!ae(Tn))throw new Error("Invalid CanDeactivate guard");Ii=Wn(Tn($,R,P,X))}return Ii.pipe(mi())});return(0,Ae.of)(pt).pipe(Zi())}(he.component,he.route,P,R,X)),mi(he=>!0!==he,!0))}(pt,X,he,$).pipe((0,Be.zg)(It=>It&&function ze($){return"boolean"==typeof $}(It)?function Qn($,R,P,X){return(0,rt.D)(R).pipe((0,ft.b)(he=>(0,Ve.z)(function wi($,R){return null!==$&&R&&R(new Gr($)),(0,Ae.of)(!0)}(he.route.parent,X),function Yi($,R){return null!==$&&R&&R(new zr($)),(0,Ae.of)(!0)}(he.route,X),function Vr($,R,P){const X=R[R.length-1],Fe=R.slice(0,R.length-1).reverse().map(pt=>function ts($){const R=$.routeConfig?$.routeConfig.canActivateChild:null;return R&&0!==R.length?{node:$,guards:R}:null}(pt)).filter(pt=>null!==pt).map(pt=>(0,He.P)(()=>{const It=pt.guards.map(Tn=>{const Ii=To(Tn,pt.node,P);let ao;if(function Yn($){return $&&ae($.canActivateChild)}(Ii))ao=Wn(Ii.canActivateChild(X,$));else{if(!ae(Ii))throw new Error("Invalid CanActivateChild guard");ao=Wn(Ii(X,$))}return ao.pipe(mi())});return(0,Ae.of)(It).pipe(Zi())}));return(0,Ae.of)(Fe).pipe(Zi())}($,he.path,P),function br($,R,P){const X=R.routeConfig?R.routeConfig.canActivate:null;if(!X||0===X.length)return(0,Ae.of)(!0);const he=X.map(Fe=>(0,He.P)(()=>{const pt=To(Fe,R,P);let It;if(function Ln($){return $&&ae($.canActivate)}(pt))It=Wn(pt.canActivate(R,$));else{if(!ae(pt))throw new Error("Invalid CanActivate guard");It=Wn(pt(R,$))}return It.pipe(mi())}));return(0,Ae.of)(he).pipe(Zi())}($,he.route,P))),mi(he=>!0!==he,!0))}(X,Fe,$,R):(0,Ae.of)(It)),(0,de.U)(It=>({...P,guardsResult:It})))})}(this.ngModule.injector,It=>this.triggerEvent(It)),er(It=>{if(St(It.guardsResult)){const Ii=_e(`Redirecting to "${this.serializeUrl(It.guardsResult)}"`);throw Ii.url=It.guardsResult,Ii}const Tn=new xi(It.id,this.serializeUrl(It.extractedUrl),this.serializeUrl(It.urlAfterRedirects),It.targetSnapshot,!!It.guardsResult);this.triggerEvent(Tn)}),(0,Ft.h)(It=>!!It.guardsResult||(this.restoreHistory(It),this.cancelNavigationTransition(It,""),!1)),la(It=>{if(It.guards.canActivateChecks.length)return(0,Ae.of)(It).pipe(er(Tn=>{const Ii=new vr(Tn.id,this.serializeUrl(Tn.extractedUrl),this.serializeUrl(Tn.urlAfterRedirects),Tn.targetSnapshot);this.triggerEvent(Ii)}),(0,Pe.w)(Tn=>{let Ii=!1;return(0,Ae.of)(Tn).pipe(function ll($,R){return(0,Be.zg)(P=>{const{targetSnapshot:X,guards:{canActivateChecks:he}}=P;if(!he.length)return(0,Ae.of)(P);let Fe=0;return(0,rt.D)(he).pipe((0,ft.b)(pt=>function Yc($,R,P,X){return function Tc($,R,P,X){const he=kr($);if(0===he.length)return(0,Ae.of)({});const Fe={};return(0,rt.D)(he).pipe((0,Be.zg)(pt=>function La($,R,P,X){const he=To($,R,X);return Wn(he.resolve?he.resolve(R,P):he(R,P))}($[pt],R,P,X).pipe(er(It=>{Fe[pt]=It}))),Gt(1),(0,Be.zg)(()=>kr(Fe).length===he.length?(0,Ae.of)(Fe):Ne.E))}($._resolve,$,R,X).pipe((0,de.U)(Fe=>($._resolvedData=Fe,$.data={...$.data,...wo($,P).resolve},null)))}(pt.route,X,$,R)),er(()=>Fe++),Gt(1),(0,Be.zg)(pt=>Fe===he.length?(0,Ae.of)(P):Ne.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),er({next:()=>Ii=!0,complete:()=>{Ii||(this.restoreHistory(Tn),this.cancelNavigationTransition(Tn,"At least one route resolver didn't emit any value."))}}))}),er(Tn=>{const Ii=new ji(Tn.id,this.serializeUrl(Tn.extractedUrl),this.serializeUrl(Tn.urlAfterRedirects),Tn.targetSnapshot);this.triggerEvent(Ii)}))}),la(It=>{const{targetSnapshot:Tn,id:Ii,extractedUrl:ao,rawUrl:Ji,extras:{skipLocationChange:Do,replaceUrl:lo}}=It;return this.hooks.afterPreactivation(Tn,{navigationId:Ii,appliedUrlTree:ao,rawUrlTree:Ji,skipLocationChange:!!Do,replaceUrl:!!lo})}),(0,de.U)(It=>{const Tn=function Ur($,R,P){const X=ie($,R._root,P?P._root:void 0);return new mo(X,R)}(this.routeReuseStrategy,It.targetSnapshot,It.currentRouterState);return{...It,targetRouterState:Tn}}),er(It=>{this.currentUrlTree=It.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(It.urlAfterRedirects,It.rawUrl),this.routerState=It.targetRouterState,"deferred"===this.urlUpdateStrategy&&(It.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,It),this.browserUrlTree=It.urlAfterRedirects)}),(($,R,P)=>(0,de.U)(X=>(new Wr(R,X.targetRouterState,X.currentRouterState,P).activate($),X)))(this.rootContexts,this.routeReuseStrategy,It=>this.triggerEvent(It)),er({next(){Fe=!0},complete(){Fe=!0}}),function ki($){return R=>R.lift(new Qt($))}(()=>{Fe||pt||this.cancelNavigationTransition(he,`Navigation ID ${he.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation?.id===he.id&&(this.currentNavigation=null)}),Lt(It=>{if(pt=!0,function Qe($){return $&&$[fe]}(It)){const Tn=St(It.url);Tn||(this.navigated=!0,this.restoreHistory(he,!0));const Ii=new ni(he.id,this.serializeUrl(he.extractedUrl),It.message);X.next(Ii),Tn?setTimeout(()=>{const ao=this.urlHandlingStrategy.merge(It.url,this.rawUrlTree),Ji={skipLocationChange:he.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||ls(he.source)};this.scheduleNavigation(ao,"imperative",null,Ji,{resolve:he.resolve,reject:he.reject,promise:he.promise})},0):he.resolve(!1)}else{this.restoreHistory(he,!0);const Tn=new cr(he.id,this.serializeUrl(he.extractedUrl),It);X.next(Tn);try{he.resolve(this.errorHandler(It))}catch(Ii){he.reject(Ii)}}return Ne.E}))}))}resetRootComponentType(P){this.rootComponentType=P,this.routerState.root.component=this.rootComponentType}setTransition(P){this.transitions.next({...this.transitions.value,...P})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(P=>{const X="popstate"===P.type?"popstate":"hashchange";"popstate"===X&&setTimeout(()=>{const he={replaceUrl:!0},Fe=P.state?.navigationId?P.state:null;if(Fe){const It={...Fe};delete It.navigationId,delete It.\u0275routerPageId,0!==Object.keys(It).length&&(he.state=It)}const pt=this.parseUrl(P.url);this.scheduleNavigation(pt,X,Fe,he)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(P){this.events.next(P)}resetConfig(P){Ue(P),this.config=P.map(Yr),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(P,X={}){const{relativeTo:he,queryParams:Fe,fragment:pt,queryParamsHandling:It,preserveFragment:Tn}=X,Ii=he||this.routerState.root,ao=Tn?this.currentUrlTree.fragment:pt;let Ji=null;switch(It){case"merge":Ji={...this.currentUrlTree.queryParams,...Fe};break;case"preserve":Ji=this.currentUrlTree.queryParams;break;default:Ji=Fe||null}return null!==Ji&&(Ji=this.removeEmptyProps(Ji)),function Oe($,R,P,X,he){if(0===P.length)return fn(R.root,R.root,R,X,he);const Fe=function oi($){if("string"==typeof $[0]&&1===$.length&&"/"===$[0])return new yn(!0,0,$);let R=0,P=!1;const X=$.reduce((he,Fe,pt)=>{if("object"==typeof Fe&&null!=Fe){if(Fe.outlets){const It={};return Nn(Fe.outlets,(Tn,Ii)=>{It[Ii]="string"==typeof Tn?Tn.split("/"):Tn}),[...he,{outlets:It}]}if(Fe.segmentPath)return[...he,Fe.segmentPath]}return"string"!=typeof Fe?[...he,Fe]:0===pt?(Fe.split("/").forEach((It,Tn)=>{0==Tn&&"."===It||(0==Tn&&""===It?P=!0:".."===It?R++:""!=It&&he.push(It))}),he):[...he,Fe]},[]);return new yn(P,R,X)}(P);if(Fe.toRoot())return fn(R.root,new hi([],{}),R,X,he);const pt=function Mi($,R,P){if($.isAbsolute)return new Pi(R.root,!0,0);if(-1===P.snapshot._lastPathIndex){const Fe=P.snapshot._urlSegment;return new Pi(Fe,Fe===R.root,0)}const X=Dt($.commands[0])?0:1;return function bi($,R,P){let X=$,he=R,Fe=P;for(;Fe>he;){if(Fe-=he,X=X.parent,!X)throw new Error("Invalid number of '../'");he=X.segments.length}return new Pi(X,!1,he-Fe)}(P.snapshot._urlSegment,P.snapshot._lastPathIndex+X,$.numberOfDoubleDots)}(Fe,R,$),It=pt.processChildren?Ci(pt.segmentGroup,pt.index,Fe.commands):Di(pt.segmentGroup,pt.index,Fe.commands);return fn(pt.segmentGroup,It,R,X,he)}(Ii,this.currentUrlTree,P,Ji,ao??null)}navigateByUrl(P,X={skipLocationChange:!1}){const he=St(P)?P:this.parseUrl(P),Fe=this.urlHandlingStrategy.merge(he,this.rawUrlTree);return this.scheduleNavigation(Fe,"imperative",null,X)}navigate(P,X={skipLocationChange:!1}){return function Na($){for(let R=0;R<$.length;R++){const P=$[R];if(null==P)throw new Error(`The requested path contains ${P} segment at index ${R}`)}}(P),this.navigateByUrl(this.createUrlTree(P,X),X)}serializeUrl(P){return this.urlSerializer.serialize(P)}parseUrl(P){let X;try{X=this.urlSerializer.parse(P)}catch(he){X=this.malformedUriErrorHandler(he,this.urlSerializer,P)}return X}isActive(P,X){let he;if(he=!0===X?{...Ec}:!1===X?{...Mu}:X,St(P))return Qi(this.currentUrlTree,P,he);const Fe=this.parseUrl(P);return Qi(this.currentUrlTree,Fe,he)}removeEmptyProps(P){return Object.keys(P).reduce((X,he)=>{const Fe=P[he];return null!=Fe&&(X[he]=Fe),X},{})}processNavigations(){this.navigations.subscribe(P=>{this.navigated=!0,this.lastSuccessfulId=P.id,this.currentPageId=P.targetPageId,this.events.next(new nn(P.id,this.serializeUrl(P.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,P.resolve(!0)},P=>{this.console.warn(`Unhandled Navigation Error: ${P}`)})}scheduleNavigation(P,X,he,Fe,pt){if(this.disposed)return Promise.resolve(!1);const It=this.transitions.value,Tn=ls(X)&&It&&!ls(It.source),Ii=It.rawUrl.toString()===P.toString();if(Tn&&Ii&&It.id===this.currentNavigation?.id)return Promise.resolve(!0);let Do,lo,Kr;pt?(Do=pt.resolve,lo=pt.reject,Kr=pt.promise):Kr=new Promise((Os,$a)=>{Do=Os,lo=$a});const No=++this.navigationId;let ys;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(he=this.location.getState()),ys=he&&he.\u0275routerPageId?he.\u0275routerPageId:Fe.replaceUrl||Fe.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):ys=0,this.setTransition({id:No,targetPageId:ys,source:X,restoredState:he,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:P,extras:Fe,resolve:Do,reject:lo,promise:Kr,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),Kr.catch(Os=>Promise.reject(Os))}setBrowserUrl(P,X){const he=this.urlSerializer.serialize(P),Fe={...X.extras.state,...this.generateNgRouterState(X.id,X.targetPageId)};this.location.isCurrentPathEqualTo(he)||X.extras.replaceUrl?this.location.replaceState(he,"",Fe):this.location.go(he,"",Fe)}restoreHistory(P,X=!1){if("computed"===this.canceledNavigationResolution){const he=this.currentPageId-P.targetPageId;"popstate"!==P.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===he?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===he&&(this.resetState(P),this.browserUrlTree=P.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(he)}else"replace"===this.canceledNavigationResolution&&(X&&this.resetState(P),this.resetUrlToCurrentUrlTree())}resetState(P){this.routerState=P.currentRouterState,this.currentUrlTree=P.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,P.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(P,X){const he=new ni(P.id,this.serializeUrl(P.extractedUrl),X);this.triggerEvent(he),P.resolve(!1)}generateNgRouterState(P,X){return"computed"===this.canceledNavigationResolution?{navigationId:P,\u0275routerPageId:X}:{navigationId:P}}}return $.\u0275fac=function(P){c.$Z()},$.\u0275prov=c.Yz7({token:$,factory:$.\u0275fac}),$})();function ls($){return"imperative"!==$}let xa=(()=>{class ${constructor(P,X,he,Fe,pt){this.router=P,this.route=X,this.tabIndexAttribute=he,this.renderer=Fe,this.el=pt,this.commands=null,this.onChanges=new Je.xQ,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(P){if(null!=this.tabIndexAttribute)return;const X=this.renderer,he=this.el.nativeElement;null!==P?X.setAttribute(he,"tabindex",P):X.removeAttribute(he,"tabindex")}ngOnChanges(P){this.onChanges.next(this)}set routerLink(P){null!=P?(this.commands=Array.isArray(P)?P:[P],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const P={skipLocationChange:Ys(this.skipLocationChange),replaceUrl:Ys(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,P),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Ys(this.preserveFragment)})}}return $.\u0275fac=function(P){return new(P||$)(c.Y36(Wo),c.Y36(Ui),c.$8M("tabindex"),c.Y36(c.Qsj),c.Y36(c.SBq))},$.\u0275dir=c.lG2({type:$,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(P,X){1&P&&c.NdJ("click",function(){return X.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[c.TTD]}),$})();function Ys($){return""===$||!!$}class Al{}class Ua{preload(R,P){return(0,Ae.of)(null)}}let wa=(()=>{class ${constructor(P,X,he,Fe){this.router=P,this.injector=he,this.preloadingStrategy=Fe,this.loader=new Fa(he,X,Tn=>P.triggerEvent(new Ir(Tn)),Tn=>P.triggerEvent(new $i(Tn)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Ft.h)(P=>P instanceof nn),(0,ft.b)(()=>this.preload())).subscribe(()=>{})}preload(){const P=this.injector.get(c.h0i);return this.processRoutes(P,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(P,X){const he=[];for(const Fe of X)if(Fe.loadChildren&&!Fe.canLoad&&Fe._loadedConfig){const pt=Fe._loadedConfig;he.push(this.processRoutes(pt.module,pt.routes))}else Fe.loadChildren&&!Fe.canLoad?he.push(this.preloadConfig(P,Fe)):Fe.children&&he.push(this.processRoutes(P,Fe.children));return(0,rt.D)(he).pipe((0,xe.J)(),(0,de.U)(Fe=>{}))}preloadConfig(P,X){return this.preloadingStrategy.preload(X,()=>(X._loadedConfig?(0,Ae.of)(X._loadedConfig):this.loader.load(P.injector,X)).pipe((0,Be.zg)(Fe=>(X._loadedConfig=Fe,this.processRoutes(Fe.module,Fe.routes)))))}}return $.\u0275fac=function(P){return new(P||$)(c.LFG(Wo),c.LFG(c.Sil),c.LFG(c.zs3),c.LFG(Al))},$.\u0275prov=c.Yz7({token:$,factory:$.\u0275fac}),$})(),Dc=(()=>{class ${constructor(P,X,he={}){this.router=P,this.viewportScroller=X,this.options=he,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},he.scrollPositionRestoration=he.scrollPositionRestoration||"disabled",he.anchorScrolling=he.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(P=>{P instanceof Ut?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=P.navigationTrigger,this.restoredId=P.restoredState?P.restoredState.navigationId:0):P instanceof nn&&(this.lastId=P.id,this.scheduleScrollEvent(P,this.router.parseUrl(P.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(P=>{P instanceof ur&&(P.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(P.position):P.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(P.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(P,X){this.router.triggerEvent(new ur(P,"popstate"===this.lastSource?this.store[this.restoredId]:null,X))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return $.\u0275fac=function(P){c.$Z()},$.\u0275prov=c.Yz7({token:$,factory:$.\u0275fac}),$})();const Ta=new c.OlP("ROUTER_CONFIGURATION"),Jc=new c.OlP("ROUTER_FORROOT_GUARD"),Ic=[d.Ye,{provide:Oi,useClass:yo},{provide:Wo,useFactory:function Ac($,R,P,X,he,Fe,pt={},It,Tn){const Ii=new Wo(null,$,R,P,X,he,on(Fe));return It&&(Ii.urlHandlingStrategy=It),Tn&&(Ii.routeReuseStrategy=Tn),function dl($,R){$.errorHandler&&(R.errorHandler=$.errorHandler),$.malformedUriErrorHandler&&(R.malformedUriErrorHandler=$.malformedUriErrorHandler),$.onSameUrlNavigation&&(R.onSameUrlNavigation=$.onSameUrlNavigation),$.paramsInheritanceStrategy&&(R.paramsInheritanceStrategy=$.paramsInheritanceStrategy),$.relativeLinkResolution&&(R.relativeLinkResolution=$.relativeLinkResolution),$.urlUpdateStrategy&&(R.urlUpdateStrategy=$.urlUpdateStrategy),$.canceledNavigationResolution&&(R.canceledNavigationResolution=$.canceledNavigationResolution)}(pt,Ii),pt.enableTracing&&Ii.events.subscribe(ao=>{console.group?.(`Router Event: ${ao.constructor.name}`),console.log(ao.toString()),console.log(ao),console.groupEnd?.()}),Ii},deps:[Oi,vo,d.Ye,c.zs3,c.Sil,Hs,Ta,[class Au{},new c.FiY],[va,new c.FiY]]},vo,{provide:Ui,useFactory:function Mc($){return $.routerState.root},deps:[Wo]},wa,Ua,class ca{preload(R,P){return P().pipe(Lt(()=>(0,Ae.of)(null)))}},{provide:Ta,useValue:{enableTracing:!1}}];function Ca(){return new c.PXZ("Router",Wo)}let Ml=(()=>{class ${constructor(P,X){}static forRoot(P,X){return{ngModule:$,providers:[Ic,nc(P),{provide:Jc,useFactory:Za,deps:[[Wo,new c.FiY,new c.tp0]]},{provide:Ta,useValue:X||{}},{provide:d.S$,useFactory:Sl,deps:[d.lw,[new c.tBr(d.mr),new c.FiY],Ta]},{provide:Dc,useFactory:tc,deps:[Wo,d.EM,Ta]},{provide:Al,useExisting:X&&X.preloadingStrategy?X.preloadingStrategy:Ua},{provide:c.PXZ,multi:!0,useFactory:Ca},[Pl,{provide:c.ip1,multi:!0,useFactory:kl,deps:[Pl]},{provide:Va,useFactory:hl,deps:[Pl]},{provide:c.tb,multi:!0,useExisting:Va}]]}}static forChild(P){return{ngModule:$,providers:[nc(P)]}}}return $.\u0275fac=function(P){return new(P||$)(c.LFG(Jc,8),c.LFG(Wo,8))},$.\u0275mod=c.oAB({type:$}),$.\u0275inj=c.cJS({}),$})();function tc($,R,P){return P.scrollOffset&&R.setOffset(P.scrollOffset),new Dc($,R,P)}function Sl($,R,P={}){return P.useHash?new d.Do($,R):new d.b0($,R)}function Za($){return"guarded"}function nc($){return[{provide:c.deG,multi:!0,useValue:$},{provide:Hs,multi:!0,useValue:$}]}let Pl=(()=>{class ${constructor(P){this.injector=P,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Je.xQ}appInitializer(){return this.injector.get(d.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let X=null;const he=new Promise(It=>X=It),Fe=this.injector.get(Wo),pt=this.injector.get(Ta);return"disabled"===pt.initialNavigation?(Fe.setUpLocationChangeListener(),X(!0)):"enabled"===pt.initialNavigation||"enabledBlocking"===pt.initialNavigation?(Fe.hooks.afterPreactivation=()=>this.initNavigation?(0,Ae.of)(null):(this.initNavigation=!0,X(!0),this.resultOfPreactivationDone),Fe.initialNavigation()):X(!0),he})}bootstrapListener(P){const X=this.injector.get(Ta),he=this.injector.get(wa),Fe=this.injector.get(Dc),pt=this.injector.get(Wo),It=this.injector.get(c.z2F);P===It.components[0]&&(("enabledNonBlocking"===X.initialNavigation||void 0===X.initialNavigation)&&pt.initialNavigation(),he.setUpPreloading(),Fe.init(),pt.resetRootComponentType(It.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return $.\u0275fac=function(P){return new(P||$)(c.LFG(c.zs3))},$.\u0275prov=c.Yz7({token:$,factory:$.\u0275fac}),$})();function kl($){return $.appInitializer.bind($)}function hl($){return $.bootstrapListener.bind($)}const Va=new c.OlP("Router Initializer")},9397:(_n,Ke,k)=>{"use strict";k.d(Ke,{Zw:()=>Gt,aw:()=>ki,X$:()=>Si,sK:()=>Ri});var d=k(6738),c=k(2916);function V(Qt){return!!Qt&&(Qt instanceof c.y||"function"==typeof Qt.lift&&"function"==typeof Qt.subscribe)}var a=k(1086),O=k(567),A=k(1221),p=k(8514),L=k(8929),Q=k(6686),z=k(2268);const ye=new class G extends z.v{}(class Z extends Q.o{constructor(et,de){super(et,de),this.scheduler=et,this.work=de}schedule(et,de=0){return de>0?super.schedule(et,de):(this.delay=de,this.state=et,this.scheduler.flush(this),this)}execute(et,de){return de>0||this.closed?super.execute(et,de):this._execute(et,de)}requestAsyncId(et,de,Pe=0){return null!==Pe&&Pe>0||null===Pe&&this.delay>0?super.requestAsyncId(et,de,Pe):et.flush(this)}});var me=k(2654),Ee=k(3489),je=k(8896);function Ae({error:Qt,subscriber:et}){et.error(Qt)}class Ve{constructor(et,de,Pe){this.kind=et,this.value=de,this.error=Pe,this.hasValue="N"===et}observe(et){switch(this.kind){case"N":return et.next&&et.next(this.value);case"E":return et.error&&et.error(this.error);case"C":return et.complete&&et.complete()}}do(et,de,Pe){switch(this.kind){case"N":return et&&et(this.value);case"E":return de&&de(this.error);case"C":return Pe&&Pe()}}accept(et,de,Pe){return et&&"function"==typeof et.next?this.observe(et):this.do(et,de,Pe)}toObservable(){switch(this.kind){case"N":return(0,a.of)(this.value);case"E":return function rt(Qt,et){return new c.y(et?de=>et.schedule(Ae,0,{error:Qt,subscriber:de}):de=>de.error(Qt))}(this.error);case"C":return(0,je.c)()}throw new Error("unexpected notification kind value")}static createNext(et){return void 0!==et?new Ve("N",et):Ve.undefinedValueNotification}static createError(et){return new Ve("E",void 0,et)}static createComplete(){return Ve.completeNotification}}Ve.completeNotification=new Ve("C"),Ve.undefinedValueNotification=new Ve("N",void 0);class xt extends Ee.L{constructor(et,de,Pe=0){super(et),this.scheduler=de,this.delay=Pe}static dispatch(et){const{notification:de,destination:Pe}=et;de.observe(Pe),this.unsubscribe()}scheduleMessage(et){this.destination.add(this.scheduler.schedule(xt.dispatch,this.delay,new Je(et,this.destination)))}_next(et){this.scheduleMessage(Ve.createNext(et))}_error(et){this.scheduleMessage(Ve.createError(et)),this.unsubscribe()}_complete(){this.scheduleMessage(Ve.createComplete()),this.unsubscribe()}}class Je{constructor(et,de){this.notification=et,this.destination=de}}var ct=k(5279),wt=k(5283);class Tt extends L.xQ{constructor(et=Number.POSITIVE_INFINITY,de=Number.POSITIVE_INFINITY,Pe){super(),this.scheduler=Pe,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=et<1?1:et,this._windowTime=de<1?1:de,de===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(et){if(!this.isStopped){const de=this._events;de.push(et),de.length>this._bufferSize&&de.shift()}super.next(et)}nextTimeWindow(et){this.isStopped||(this._events.push(new Ct(this._getNow(),et)),this._trimBufferThenGetEvents()),super.next(et)}_subscribe(et){const de=this._infiniteTimeWindow,Pe=de?this._events:this._trimBufferThenGetEvents(),ft=this.scheduler,Be=Pe.length;let $t;if(this.closed)throw new ct.N;if(this.isStopped||this.hasError?$t=me.w.EMPTY:(this.observers.push(et),$t=new wt.W(this,et)),ft&&et.add(et=new xt(et,ft)),de)for(let xe=0;xe<Be&&!et.closed;xe++)et.next(Pe[xe]);else for(let xe=0;xe<Be&&!et.closed;xe++)et.next(Pe[xe].value);return this.hasError?et.error(this.thrownError):this.isStopped&&et.complete(),$t}_getNow(){return(this.scheduler||ye).now()}_trimBufferThenGetEvents(){const et=this._getNow(),de=this._bufferSize,Pe=this._windowTime,ft=this._events,Be=ft.length;let $t=0;for(;$t<Be&&!(et-ft[$t].time<Pe);)$t++;return Be>de&&($t=Math.max($t,Be-de)),$t>0&&ft.splice(0,$t),ft}}class Ct{constructor(et,de){this.time=et,this.value=de}}function gt(Qt,et,de){let Pe;return Pe=Qt&&"object"==typeof Qt?Qt:{bufferSize:Qt,windowTime:et,refCount:!1,scheduler:de},ft=>ft.lift(function Lt({bufferSize:Qt=Number.POSITIVE_INFINITY,windowTime:et=Number.POSITIVE_INFINITY,refCount:de,scheduler:Pe}){let ft,$t,Be=0,xe=!1,Ie=!1;return function(nn){let ni;Be++,!ft||xe?(xe=!1,ft=new Tt(Qt,et,Pe),ni=ft.subscribe(this),$t=nn.subscribe({next(cr){ft.next(cr)},error(cr){xe=!0,ft.error(cr)},complete(){Ie=!0,$t=void 0,ft.complete()}})):ni=ft.subscribe(this),this.add(()=>{Be--,ni.unsubscribe(),$t&&!Ie&&de&&0===Be&&($t.unsubscribe(),$t=void 0,ft=void 0)})}}(Pe))}var Ht=k(2986),Vn=k(4850),Ft=k(1406),Wt=k(7545);class Gt{}let Jt=(()=>{class Qt extends Gt{getTranslation(de){return(0,a.of)({})}}return Qt.\u0275fac=function(){let et;return function(Pe){return(et||(et=d.n5z(Qt)))(Pe||Qt)}}(),Qt.\u0275prov=d.Yz7({token:Qt,factory:Qt.\u0275fac}),Qt})();class an{}let Jn=(()=>{class Qt{handle(de){return de.key}}return Qt.\u0275fac=function(de){return new(de||Qt)},Qt.\u0275prov=d.Yz7({token:Qt,factory:Qt.\u0275fac}),Qt})();function si(Qt,et){if(Qt===et)return!0;if(null===Qt||null===et)return!1;if(Qt!=Qt&&et!=et)return!0;let ft,Be,$t,de=typeof Qt;if(de==typeof et&&"object"==de){if(!Array.isArray(Qt)){if(Array.isArray(et))return!1;for(Be in $t=Object.create(null),Qt){if(!si(Qt[Be],et[Be]))return!1;$t[Be]=!0}for(Be in et)if(!(Be in $t)&&void 0!==et[Be])return!1;return!0}if(!Array.isArray(et))return!1;if((ft=Qt.length)==et.length){for(Be=0;Be<ft;Be++)if(!si(Qt[Be],et[Be]))return!1;return!0}}return!1}function di(Qt){return null!=Qt}function Bn(Qt){return Qt&&"object"==typeof Qt&&!Array.isArray(Qt)}function ln(Qt,et){let de=Object.assign({},Qt);return Bn(Qt)&&Bn(et)&&Object.keys(et).forEach(Pe=>{Bn(et[Pe])?Pe in Qt?de[Pe]=ln(Qt[Pe],et[Pe]):Object.assign(de,{[Pe]:et[Pe]}):Object.assign(de,{[Pe]:et[Pe]})}),de}class Et{}let Kt=(()=>{class Qt extends Et{constructor(){super(...arguments),this.templateMatcher=/{{\s?([^{}\s]*)\s?}}/g}interpolate(de,Pe){let ft;return ft="string"==typeof de?this.interpolateString(de,Pe):"function"==typeof de?this.interpolateFunction(de,Pe):de,ft}getValue(de,Pe){let ft="string"==typeof Pe?Pe.split("."):[Pe];Pe="";do{Pe+=ft.shift(),!di(de)||!di(de[Pe])||"object"!=typeof de[Pe]&&ft.length?ft.length?Pe+=".":de=void 0:(de=de[Pe],Pe="")}while(ft.length);return de}interpolateFunction(de,Pe){return de(Pe)}interpolateString(de,Pe){return Pe?de.replace(this.templateMatcher,(ft,Be)=>{let $t=this.getValue(Pe,Be);return di($t)?$t:ft}):de}}return Qt.\u0275fac=function(){let et;return function(Pe){return(et||(et=d.n5z(Qt)))(Pe||Qt)}}(),Qt.\u0275prov=d.Yz7({token:Qt,factory:Qt.\u0275fac}),Qt})();class Hn{}let In=(()=>{class Qt extends Hn{compile(de,Pe){return de}compileTranslations(de,Pe){return de}}return Qt.\u0275fac=function(){let et;return function(Pe){return(et||(et=d.n5z(Qt)))(Pe||Qt)}}(),Qt.\u0275prov=d.Yz7({token:Qt,factory:Qt.\u0275fac}),Qt})();class ti{constructor(){this.currentLang=this.defaultLang,this.translations={},this.langs=[],this.onTranslationChange=new d.vpe,this.onLangChange=new d.vpe,this.onDefaultLangChange=new d.vpe}}const mi=new d.OlP("USE_STORE"),ir=new d.OlP("USE_DEFAULT_LANG"),_r=new d.OlP("DEFAULT_LANGUAGE"),er=new d.OlP("USE_EXTEND");let Ri=(()=>{class Qt{constructor(de,Pe,ft,Be,$t,xe=!0,Ie=!1,Ut=!1,nn){this.store=de,this.currentLoader=Pe,this.compiler=ft,this.parser=Be,this.missingTranslationHandler=$t,this.useDefaultLang=xe,this.isolate=Ie,this.extend=Ut,this.pending=!1,this._onTranslationChange=new d.vpe,this._onLangChange=new d.vpe,this._onDefaultLangChange=new d.vpe,this._langs=[],this._translations={},this._translationRequests={},nn&&this.setDefaultLang(nn)}get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(de){this.isolate?this._defaultLang=de:this.store.defaultLang=de}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(de){this.isolate?this._currentLang=de:this.store.currentLang=de}get langs(){return this.isolate?this._langs:this.store.langs}set langs(de){this.isolate?this._langs=de:this.store.langs=de}get translations(){return this.isolate?this._translations:this.store.translations}set translations(de){this.isolate?this._translations=de:this.store.translations=de}setDefaultLang(de){if(de===this.defaultLang)return;let Pe=this.retrieveTranslations(de);void 0!==Pe?(null==this.defaultLang&&(this.defaultLang=de),Pe.pipe((0,Ht.q)(1)).subscribe(ft=>{this.changeDefaultLang(de)})):this.changeDefaultLang(de)}getDefaultLang(){return this.defaultLang}use(de){if(de===this.currentLang)return(0,a.of)(this.translations[de]);let Pe=this.retrieveTranslations(de);return void 0!==Pe?(this.currentLang||(this.currentLang=de),Pe.pipe((0,Ht.q)(1)).subscribe(ft=>{this.changeLang(de)}),Pe):(this.changeLang(de),(0,a.of)(this.translations[de]))}retrieveTranslations(de){let Pe;return(void 0===this.translations[de]||this.extend)&&(this._translationRequests[de]=this._translationRequests[de]||this.getTranslation(de),Pe=this._translationRequests[de]),Pe}getTranslation(de){this.pending=!0;const Pe=this.currentLoader.getTranslation(de).pipe(gt(1),(0,Ht.q)(1));return this.loadingTranslations=Pe.pipe((0,Vn.U)(ft=>this.compiler.compileTranslations(ft,de)),gt(1),(0,Ht.q)(1)),this.loadingTranslations.subscribe({next:ft=>{this.translations[de]=this.extend&&this.translations[de]?{...ft,...this.translations[de]}:ft,this.updateLangs(),this.pending=!1},error:ft=>{this.pending=!1}}),Pe}setTranslation(de,Pe,ft=!1){Pe=this.compiler.compileTranslations(Pe,de),this.translations[de]=(ft||this.extend)&&this.translations[de]?ln(this.translations[de],Pe):Pe,this.updateLangs(),this.onTranslationChange.emit({lang:de,translations:this.translations[de]})}getLangs(){return this.langs}addLangs(de){de.forEach(Pe=>{-1===this.langs.indexOf(Pe)&&this.langs.push(Pe)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(de,Pe,ft){let Be;if(Pe instanceof Array){let $t={},xe=!1;for(let Ie of Pe)$t[Ie]=this.getParsedResult(de,Ie,ft),V($t[Ie])&&(xe=!0);if(xe){const Ie=Pe.map(Ut=>V($t[Ut])?$t[Ut]:(0,a.of)($t[Ut]));return(0,O.D)(Ie).pipe((0,Vn.U)(Ut=>{let nn={};return Ut.forEach((ni,cr)=>{nn[Pe[cr]]=ni}),nn}))}return $t}if(de&&(Be=this.parser.interpolate(this.parser.getValue(de,Pe),ft)),void 0===Be&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(Be=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],Pe),ft)),void 0===Be){let $t={key:Pe,translateService:this};void 0!==ft&&($t.interpolateParams=ft),Be=this.missingTranslationHandler.handle($t)}return void 0!==Be?Be:Pe}get(de,Pe){if(!di(de)||!de.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe((0,Ft.b)(ft=>V(ft=this.getParsedResult(ft,de,Pe))?ft:(0,a.of)(ft)));{let ft=this.getParsedResult(this.translations[this.currentLang],de,Pe);return V(ft)?ft:(0,a.of)(ft)}}getStreamOnTranslationChange(de,Pe){if(!di(de)||!de.length)throw new Error('Parameter "key" required');return(0,A.z)((0,p.P)(()=>this.get(de,Pe)),this.onTranslationChange.pipe((0,Wt.w)(ft=>{const Be=this.getParsedResult(ft.translations,de,Pe);return"function"==typeof Be.subscribe?Be:(0,a.of)(Be)})))}stream(de,Pe){if(!di(de)||!de.length)throw new Error('Parameter "key" required');return(0,A.z)((0,p.P)(()=>this.get(de,Pe)),this.onLangChange.pipe((0,Wt.w)(ft=>{const Be=this.getParsedResult(ft.translations,de,Pe);return V(Be)?Be:(0,a.of)(Be)})))}instant(de,Pe){if(!di(de)||!de.length)throw new Error('Parameter "key" required');let ft=this.getParsedResult(this.translations[this.currentLang],de,Pe);if(V(ft)){if(de instanceof Array){let Be={};return de.forEach(($t,xe)=>{Be[de[xe]]=de[xe]}),Be}return de}return ft}set(de,Pe,ft=this.currentLang){this.translations[ft][de]=this.compiler.compile(Pe,ft),this.updateLangs(),this.onTranslationChange.emit({lang:ft,translations:this.translations[ft]})}changeLang(de){this.currentLang=de,this.onLangChange.emit({lang:de,translations:this.translations[de]}),null==this.defaultLang&&this.changeDefaultLang(de)}changeDefaultLang(de){this.defaultLang=de,this.onDefaultLangChange.emit({lang:de,translations:this.translations[de]})}reloadLang(de){return this.resetLang(de),this.getTranslation(de)}resetLang(de){this._translationRequests[de]=void 0,this.translations[de]=void 0}getBrowserLang(){if("undefined"==typeof window||void 0===window.navigator)return;let de=window.navigator.languages?window.navigator.languages[0]:null;return de=de||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,void 0!==de?(-1!==de.indexOf("-")&&(de=de.split("-")[0]),-1!==de.indexOf("_")&&(de=de.split("_")[0]),de):void 0}getBrowserCultureLang(){if("undefined"==typeof window||void 0===window.navigator)return;let de=window.navigator.languages?window.navigator.languages[0]:null;return de=de||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,de}}return Qt.\u0275fac=function(de){return new(de||Qt)(d.LFG(ti),d.LFG(Gt),d.LFG(Hn),d.LFG(Et),d.LFG(an),d.LFG(ir),d.LFG(mi),d.LFG(er),d.LFG(_r))},Qt.\u0275prov=d.Yz7({token:Qt,factory:Qt.\u0275fac}),Qt})(),Si=(()=>{class Qt{constructor(de,Pe){this.translate=de,this._ref=Pe,this.value="",this.lastKey=null,this.lastParams=[]}updateValue(de,Pe,ft){let Be=$t=>{this.value=void 0!==$t?$t:de,this.lastKey=de,this._ref.markForCheck()};if(ft){let $t=this.translate.getParsedResult(ft,de,Pe);V($t.subscribe)?$t.subscribe(Be):Be($t)}this.translate.get(de,Pe).subscribe(Be)}transform(de,...Pe){if(!de||!de.length)return de;if(si(de,this.lastKey)&&si(Pe,this.lastParams))return this.value;let ft;if(di(Pe[0])&&Pe.length)if("string"==typeof Pe[0]&&Pe[0].length){let Be=Pe[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{ft=JSON.parse(Be)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${Pe[0]}`)}}else"object"==typeof Pe[0]&&!Array.isArray(Pe[0])&&(ft=Pe[0]);return this.lastKey=de,this.lastParams=Pe,this.updateValue(de,ft),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(Be=>{this.lastKey&&Be.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(de,ft,Be.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(Be=>{this.lastKey&&(this.lastKey=null,this.updateValue(de,ft,Be.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(de,ft))})),this.value}_dispose(){void 0!==this.onTranslationChange&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),void 0!==this.onLangChange&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),void 0!==this.onDefaultLangChange&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return Qt.\u0275fac=function(de){return new(de||Qt)(d.Y36(Ri,16),d.Y36(d.sBO,16))},Qt.\u0275pipe=d.Yjl({name:"translate",type:Qt,pure:!1}),Qt.\u0275prov=d.Yz7({token:Qt,factory:Qt.\u0275fac}),Qt})(),ki=(()=>{class Qt{static forRoot(de={}){return{ngModule:Qt,providers:[de.loader||{provide:Gt,useClass:Jt},de.compiler||{provide:Hn,useClass:In},de.parser||{provide:Et,useClass:Kt},de.missingTranslationHandler||{provide:an,useClass:Jn},ti,{provide:mi,useValue:de.isolate},{provide:ir,useValue:de.useDefaultLang},{provide:er,useValue:de.extend},{provide:_r,useValue:de.defaultLanguage},Ri]}}static forChild(de={}){return{ngModule:Qt,providers:[de.loader||{provide:Gt,useClass:Jt},de.compiler||{provide:Hn,useClass:In},de.parser||{provide:Et,useClass:Kt},de.missingTranslationHandler||{provide:an,useClass:Jn},{provide:mi,useValue:de.isolate},{provide:ir,useValue:de.useDefaultLang},{provide:er,useValue:de.extend},{provide:_r,useValue:de.defaultLanguage},Ri]}}}return Qt.\u0275fac=function(de){return new(de||Qt)},Qt.\u0275mod=d.oAB({type:Qt}),Qt.\u0275inj=d.cJS({}),Qt})()}},_n=>{_n(_n.s=552)}]);