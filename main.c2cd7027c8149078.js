(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{6417:(yn,je,N)=>{"use strict";N.d(je,{N0:()=>f,Ar:()=>te});var x=N(865),d=N(6019),Y=N(4421),l=N(1915),P=N(4522);const O=new x.OlP("JWT_OPTIONS");let f=(()=>{class K{constructor(ne=null){this.tokenGetter=ne&&ne.tokenGetter||function(){}}urlBase64Decode(ne){let ce=ne.replace(/-/g,"+").replace(/_/g,"/");switch(ce.length%4){case 0:break;case 2:ce+="==";break;case 3:ce+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(ce)}b64decode(ne){let me="";if((ne=String(ne).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let we,ze,ve=0,Ne=0;ze=ne.charAt(Ne++);~ze&&(we=ve%4?64*we+ze:ze,ve++%4)?me+=String.fromCharCode(255&we>>(-2*ve&6)):0)ze="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(ze);return me}b64DecodeUnicode(ne){return decodeURIComponent(Array.prototype.map.call(this.b64decode(ne),ce=>"%"+("00"+ce.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(ne=this.tokenGetter()){if(!ne||""===ne)return null;const ce=ne.split(".");if(3!==ce.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const me=this.urlBase64Decode(ce[1]);if(!me)throw new Error("Cannot decode the token.");return JSON.parse(me)}getTokenExpirationDate(ne=this.tokenGetter()){let ce;if(ce=this.decodeToken(ne),!ce||!ce.hasOwnProperty("exp"))return null;const me=new Date(0);return me.setUTCSeconds(ce.exp),me}isTokenExpired(ne=this.tokenGetter(),ce){if(!ne||""===ne)return!0;const me=this.getTokenExpirationDate(ne);return ce=ce||0,null!==me&&!(me.valueOf()>(new Date).valueOf()+1e3*ce)}getAuthScheme(ne,ce){return"function"==typeof ne?ne(ce):ne}}return K.\u0275fac=function(ne){return new(ne||K)(x.LFG(O))},K.\u0275prov=x.Yz7({token:K,factory:K.\u0275fac}),K})(),H=(()=>{class K{constructor(ne,ce,me){this.jwtHelper=ce,this.document=me,this.standardPorts=["80","443"],this.tokenGetter=ne.tokenGetter,this.headerName=ne.headerName||"Authorization",this.authScheme=ne.authScheme||""===ne.authScheme?ne.authScheme:"Bearer ",this.allowedDomains=ne.allowedDomains||[],this.disallowedRoutes=ne.disallowedRoutes||[],this.throwNoTokenError=ne.throwNoTokenError||!1,this.skipWhenExpired=ne.skipWhenExpired}isAllowedDomain(ne){const ce=new URL(ne.url,this.document.location.origin);if(ce.host===this.document.location.host)return!0;const me=`${ce.hostname}${ce.port&&!this.standardPorts.includes(ce.port)?":"+ce.port:""}`;return this.allowedDomains.findIndex(ve=>"string"==typeof ve?ve===me:ve instanceof RegExp&&ve.test(me))>-1}isDisallowedRoute(ne){const ce=new URL(ne.url,this.document.location.origin);return this.disallowedRoutes.findIndex(me=>{if("string"==typeof me){const ve=new URL(me,this.document.location.origin);return ve.hostname===ce.hostname&&ve.pathname===ce.pathname}return me instanceof RegExp&&me.test(ne.url)})>-1}handleInterception(ne,ce,me){const ve=this.jwtHelper.getAuthScheme(this.authScheme,ce);let we=!1;if(!ne&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");return this.skipWhenExpired&&(we=!ne||this.jwtHelper.isTokenExpired(ne)),ne&&we&&this.skipWhenExpired?ce=ce.clone():ne&&(ce=ce.clone({setHeaders:{[this.headerName]:`${ve}${ne}`}})),me.handle(ce)}intercept(ne,ce){if(!this.isAllowedDomain(ne)||this.isDisallowedRoute(ne))return ce.handle(ne);const me=this.tokenGetter(ne);return me instanceof Promise?(0,l.D)(me).pipe((0,Y.zg)(ve=>this.handleInterception(ve,ne,ce))):this.handleInterception(me,ne,ce)}}return K.\u0275fac=function(ne){return new(ne||K)(x.LFG(O),x.LFG(f),x.LFG(d.K0))},K.\u0275prov=x.Yz7({token:K,factory:K.\u0275fac}),K})(),te=(()=>{class K{constructor(ne){if(ne)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(ne){return{ngModule:K,providers:[{provide:P.TP,useClass:H,multi:!0},ne.jwtOptionsProvider||{provide:O,useValue:ne.config},f]}}}return K.\u0275fac=function(ne){return new(ne||K)(x.LFG(K,12))},K.\u0275mod=x.oAB({type:K}),K.\u0275inj=x.cJS({}),K})()},1278:(yn,je,N)=>{"use strict";N.d(je,{Uw:()=>ze,fo:()=>me});var x=N(4553);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global&&global;var H=(()=>{return(Ae=H||(H={})).Unimplemented="UNIMPLEMENTED",Ae.Unavailable="UNAVAILABLE",H;var Ae})();class te extends Error{constructor(Te,He){super(Te),this.message=Te,this.code=He}}const G=Ae=>{var Te,He,Ge,Fe,E;const Qe=Ae.CapacitorCustomPlatform||null,et=Ae.Capacitor||{},ct=et.Plugins=et.Plugins||{},gt=Ae.CapacitorPlatforms,ut=(null===(Te=null==gt?void 0:gt.currentPlatform)||void 0===Te?void 0:Te.getPlatform)||(()=>null!==Qe?Qe.name:(Ae=>{var Te,He;return(null==Ae?void 0:Ae.androidBridge)?"android":(null===(He=null===(Te=null==Ae?void 0:Ae.webkit)||void 0===Te?void 0:Te.messageHandlers)||void 0===He?void 0:He.bridge)?"ios":"web"})(Ae)),Vt=(null===(He=null==gt?void 0:gt.currentPlatform)||void 0===He?void 0:He.isNativePlatform)||(()=>"web"!==ut()),Nt=(null===(Ge=null==gt?void 0:gt.currentPlatform)||void 0===Ge?void 0:Ge.isPluginAvailable)||(tn=>{const en=Ft.get(tn);return!(!(null==en?void 0:en.platforms.has(ut()))&&!Mt(tn))}),Mt=(null===(Fe=null==gt?void 0:gt.currentPlatform)||void 0===Fe?void 0:Fe.getPluginHeader)||(tn=>{var en;return null===(en=et.PluginHeaders)||void 0===en?void 0:en.find(yt=>yt.name===tn)}),Ft=new Map,nn=(null===(E=null==gt?void 0:gt.currentPlatform)||void 0===E?void 0:E.registerPlugin)||((tn,en={})=>{const yt=Ft.get(tn);if(yt)return console.warn(`Capacitor plugin "${tn}" already registered. Cannot register plugins twice.`),yt.proxy;const Xt=ut(),cn=Mt(tn);let kn;const An=function(){var _i=(0,x.Z)(function*(){return!kn&&Xt in en?kn=kn="function"==typeof en[Xt]?yield en[Xt]():en[Xt]:null!==Qe&&!kn&&"web"in en&&(kn=kn="function"==typeof en.web?yield en.web():en.web),kn});return function(){return _i.apply(this,arguments)}}(),si=_i=>{let bi;const xn=(...rn)=>{const ot=An().then(ft=>{const pn=((_i,bi)=>{var xn,rn;if(!cn){if(_i)return null===(rn=_i[bi])||void 0===rn?void 0:rn.bind(_i);throw new te(`"${tn}" plugin is not implemented on ${Xt}`,H.Unimplemented)}{const ot=null==cn?void 0:cn.methods.find(ft=>bi===ft.name);if(ot)return"promise"===ot.rtype?ft=>et.nativePromise(tn,bi.toString(),ft):(ft,pn)=>et.nativeCallback(tn,bi.toString(),ft,pn);if(_i)return null===(xn=_i[bi])||void 0===xn?void 0:xn.bind(_i)}})(ft,_i);if(pn){const _e=pn(...rn);return bi=null==_e?void 0:_e.remove,_e}throw new te(`"${tn}.${_i}()" is not implemented on ${Xt}`,H.Unimplemented)});return"addListener"===_i&&(ot.remove=(0,x.Z)(function*(){return bi()})),ot};return xn.toString=()=>`${_i.toString()}() { [capacitor code] }`,Object.defineProperty(xn,"name",{value:_i,writable:!1,configurable:!1}),xn},Ki=si("addListener"),xi=si("removeListener"),Wi=(_i,bi)=>{const xn=Ki({eventName:_i},bi),rn=function(){var ft=(0,x.Z)(function*(){const pn=yield xn;xi({eventName:_i,callbackId:pn},bi)});return function(){return ft.apply(this,arguments)}}(),ot=new Promise(ft=>xn.then(()=>ft({remove:rn})));return ot.remove=(0,x.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield rn()}),ot},Vi=new Proxy({},{get(_i,bi){switch(bi){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return cn?Wi:Ki;case"removeListener":return xi;default:return si(bi)}}});return ct[tn]=Vi,Ft.set(tn,{name:tn,proxy:Vi,platforms:new Set([...Object.keys(en),...cn?[Xt]:[]])}),Vi});return et.convertFileSrc||(et.convertFileSrc=tn=>tn),et.getPlatform=ut,et.handleError=tn=>Ae.console.error(tn),et.isNativePlatform=Vt,et.isPluginAvailable=Nt,et.pluginMethodNoop=(tn,en,yt)=>Promise.reject(`${yt} does not have an implementation of "${en}".`),et.registerPlugin=nn,et.Exception=te,et.DEBUG=!!et.DEBUG,et.isLoggingEnabled=!!et.isLoggingEnabled,et.platform=et.getPlatform(),et.isNative=et.isNativePlatform(),et},ce=(Ae=>Ae.Capacitor=G(Ae))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),me=ce.registerPlugin;class ze{constructor(Te){this.listeners={},this.windowListeners={},Te&&(console.warn(`Capacitor WebPlugin "${Te.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=Te)}addListener(Te,He){var Ge=this;this.listeners[Te]||(this.listeners[Te]=[]),this.listeners[Te].push(He);const E=this.windowListeners[Te];E&&!E.registered&&this.addWindowListener(E);const Qe=function(){var ct=(0,x.Z)(function*(){return Ge.removeListener(Te,He)});return function(){return ct.apply(this,arguments)}}(),et=Promise.resolve({remove:Qe});return Object.defineProperty(et,"remove",{value:(ct=(0,x.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield Qe()}),function(){return ct.apply(this,arguments)})}),et;var ct}removeAllListeners(){var Te=this;return(0,x.Z)(function*(){Te.listeners={};for(const He in Te.windowListeners)Te.removeWindowListener(Te.windowListeners[He]);Te.windowListeners={}})()}notifyListeners(Te,He){const Ge=this.listeners[Te];Ge&&Ge.forEach(Fe=>Fe(He))}hasListeners(Te){return!!this.listeners[Te].length}registerWindowListener(Te,He){this.windowListeners[He]={registered:!1,windowEventName:Te,pluginEventName:He,handler:Ge=>{this.notifyListeners(He,Ge)}}}unimplemented(Te="not implemented"){return new ce.Exception(Te,H.Unimplemented)}unavailable(Te="not available"){return new ce.Exception(Te,H.Unavailable)}removeListener(Te,He){var Ge=this;return(0,x.Z)(function*(){const Fe=Ge.listeners[Te];if(!Fe)return;const E=Fe.indexOf(He);Ge.listeners[Te].splice(E,1),Ge.listeners[Te].length||Ge.removeWindowListener(Ge.windowListeners[Te])})()}addWindowListener(Te){window.addEventListener(Te.windowEventName,Te.handler),Te.registered=!0}removeWindowListener(Te){!Te||(window.removeEventListener(Te.windowEventName,Te.handler),Te.registered=!1)}}},5966:(yn,je,N)=>{"use strict";function P(A,$,R,ue){var Sn,Se=arguments.length,Lt=Se<3?$:null===ue?ue=Object.getOwnPropertyDescriptor($,R):ue;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Lt=Reflect.decorate(A,$,R,ue);else for(var Bn=A.length-1;Bn>=0;Bn--)(Sn=A[Bn])&&(Lt=(Se<3?Sn(Lt):Se>3?Sn($,R,Lt):Sn($,R))||Lt);return Se>3&&Lt&&Object.defineProperty($,R,Lt),Lt}function O(A,$){return function(R,ue){$(R,ue,A)}}function H(A,$,R,ue){return new(R||(R=Promise))(function(Lt,Sn){function Bn(or){try{ni(ue.next(or))}catch(hr){Sn(hr)}}function Bi(or){try{ni(ue.throw(or))}catch(hr){Sn(hr)}}function ni(or){or.done?Lt(or.value):function(Lt){return Lt instanceof R?Lt:new R(function(Sn){Sn(Lt)})}(or.value).then(Bn,Bi)}ni((ue=ue.apply(A,$||[])).next())})}N.d(je,{BX:()=>Jo,Br:()=>Do,w:()=>ai,dr:()=>un,BJ:()=>On,oU:()=>at,cs:()=>Vl,yp:()=>ii,YG:()=>Qn,Sm:()=>ei,PM:()=>yi,FN:()=>Yn,Zi:()=>oi,wI:()=>li,W2:()=>Ci,IJ:()=>Ii,W4:()=>to,zq:()=>Or,fr:()=>jn,jY:()=>$i,Gu:()=>Fr,gu:()=>Ir,pK:()=>xe,Ie:()=>Le,Q$:()=>hn,q_:()=>fn,yh:()=>Vn,z0:()=>Fn,fG:()=>pi,zc:()=>vi,uN:()=>yr,I_:()=>ss,nJ:()=>no,Wo:()=>io,jP:()=>ws,Nd:()=>vs,VI:()=>Rs,cJ:()=>ls,GO:()=>cs,t9:()=>Lo,n0:()=>js,PQ:()=>ao,jI:()=>Fo,g2:()=>st,Bs:()=>Ie,wd:()=>rt,ho:()=>kt,sr:()=>ri,Pc:()=>Xo,r4:()=>Ts,HT:()=>Vr,IN:()=>aa,SH:()=>pe,X1:()=>Io,as:()=>Fi,t4:()=>Ji,YI:()=>ml,QI:()=>Ei,j9:()=>mr,yF:()=>No});var E=N(865),Qe=N(9133),et=N(6019),ct=N(5899),gt=N(3119),St=(N(8886),N(9258),N(3616)),Vt=N(4743),bn=N(4980),Nt=N(697),Bt=N(149),Mt=N(6190),Kt=N(2405),Ft=(N(5042),N(5221)),yt=N(3405),Xt=N(6087),cn=N(4099),kn=N(4168);class mi{constructor($,R){this.compare=$,this.keySelector=R}call($,R){return R.subscribe(new si($,this.compare,this.keySelector))}}class si extends kn.L{constructor($,R,ue){super($),this.keySelector=ue,this.hasKey=!1,"function"==typeof R&&(this.compare=R)}compare($,R){return $===R}_next($){let R;try{const{keySelector:Se}=this;R=Se?Se($):$}catch(Se){return this.destination.error(Se)}let ue=!1;if(this.hasKey)try{const{compare:Se}=this;ue=Se(this.key,R)}catch(Se){return this.destination.error(Se)}else this.hasKey=!0;ue||(this.key=R,this.destination.next($))}}var Ki=N(8735),xi=N(9204);const Vi=bn.i,xn=["*"],pn=A=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(A):"function"==typeof requestAnimationFrame?requestAnimationFrame(A):setTimeout(A);let _e=(()=>{class A{constructor(R,ue){this.injector=R,this.el=ue,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(R){this.el.nativeElement.value=this.lastValue=R??"",Ye(this.el)}handleChangeEvent(R,ue){R===this.el.nativeElement&&(ue!==this.lastValue&&(this.lastValue=ue,this.onChange(ue)),Ye(this.el))}_handleBlurEvent(R){R===this.el.nativeElement&&(this.onTouched(),Ye(this.el))}registerOnChange(R){this.onChange=R}registerOnTouched(R){this.onTouched=R}setDisabledState(R){this.el.nativeElement.disabled=R}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let R;try{R=this.injector.get(Qe.a5)}catch{}if(!R)return;R.statusChanges&&(this.statusChanges=R.statusChanges.subscribe(()=>Ye(this.el)));const ue=R.control;ue&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Lt=>{if(ue[Lt]){const Sn=ue[Lt].bind(ue);ue[Lt]=(...Bn)=>{Sn(...Bn),Ye(this.el)}}})}}return A.\u0275fac=function(R){E.$Z()},A.\u0275dir=E.lG2({type:A,hostBindings:function(R,ue){1&R&&E.NdJ("ionBlur",function(Lt){return ue._handleBlurEvent(Lt.target)})}}),P([(0,E.L6J)("ionBlur",["$event.target"])],A.prototype,"_handleBlurEvent",null),A})();const Ye=A=>{pn(()=>{const $=A.nativeElement,R=j($);We($,R);const ue=$.closest("ion-item");ue&&We(ue,R)})},j=A=>{const $=A.classList,R=[];for(let ue=0;ue<$.length;ue++){const Se=$.item(ue);null!==Se&&on(Se,"ng-")&&R.push(`ion-${Se.substr(3)}`)}return R},We=(A,$)=>{const R=A.classList;["ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"].forEach(ue=>R.remove(ue)),$.forEach(ue=>R.add(ue))},on=(A,$)=>A.substr(0,$.length)===$;var ci;let ai=ci=class extends _e{constructor($,R){super($,R)}writeValue($){this.el.nativeElement.checked=this.lastValue=$??!1,Ye(this.el)}_handleIonChange($){this.handleChangeEvent($,$.checked)}};var Un;ai.\u0275fac=function($){return new($||ai)(E.Y36(E.zs3),E.Y36(E.SBq))},ai.\u0275dir=E.lG2({type:ai,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function($,R){1&$&&E.NdJ("ionChange",function(Se){return R._handleIonChange(Se.target)})},features:[E._Bn([{provide:Qe.JU,useExisting:ci,multi:!0}]),E.qOj]}),ai.ctorParameters=()=>[{type:E.zs3},{type:E.SBq}],P([(0,E.L6J)("ionChange",["$event.target"])],ai.prototype,"_handleIonChange",null);let Fi=Un=class extends _e{constructor($,R){super($,R)}_handleIonChange($){this.handleChangeEvent($,$.value)}registerOnChange($){super.registerOnChange(R=>{$(""===R?null:parseFloat(R))})}};var Ti;Fi.\u0275fac=function($){return new($||Fi)(E.Y36(E.zs3),E.Y36(E.SBq))},Fi.\u0275dir=E.lG2({type:Fi,selectors:[["ion-input","type","number"]],hostBindings:function($,R){1&$&&E.NdJ("ionChange",function(Se){return R._handleIonChange(Se.target)})},features:[E._Bn([{provide:Qe.JU,useExisting:Un,multi:!0}]),E.qOj]}),Fi.ctorParameters=()=>[{type:E.zs3},{type:E.SBq}],P([(0,E.L6J)("ionChange",["$event.target"])],Fi.prototype,"_handleIonChange",null);let Yi=Ti=class extends _e{constructor($,R){super($,R)}_handleIonSelect($){this.handleChangeEvent($,$.checked)}};var br;Yi.\u0275fac=function($){return new($||Yi)(E.Y36(E.zs3),E.Y36(E.SBq))},Yi.\u0275dir=E.lG2({type:Yi,selectors:[["ion-radio"]],hostBindings:function($,R){1&$&&E.NdJ("ionSelect",function(Se){return R._handleIonSelect(Se.target)})},features:[E._Bn([{provide:Qe.JU,useExisting:Ti,multi:!0}]),E.qOj]}),Yi.ctorParameters=()=>[{type:E.zs3},{type:E.SBq}],P([(0,E.L6J)("ionSelect",["$event.target"])],Yi.prototype,"_handleIonSelect",null);let Ei=br=class extends _e{constructor($,R){super($,R)}_handleChangeEvent($){this.handleChangeEvent($,$.value)}};var wr;Ei.\u0275fac=function($){return new($||Ei)(E.Y36(E.zs3),E.Y36(E.SBq))},Ei.\u0275dir=E.lG2({type:Ei,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function($,R){1&$&&E.NdJ("ionChange",function(Se){return R._handleChangeEvent(Se.target)})},features:[E._Bn([{provide:Qe.JU,useExisting:br,multi:!0}]),E.qOj]}),Ei.ctorParameters=()=>[{type:E.zs3},{type:E.SBq}],P([(0,E.L6J)("ionChange",["$event.target"])],Ei.prototype,"_handleChangeEvent",null);let mr=wr=class extends _e{constructor($,R){super($,R)}_handleInputEvent($){this.handleChangeEvent($,$.value)}};mr.\u0275fac=function($){return new($||mr)(E.Y36(E.zs3),E.Y36(E.SBq))},mr.\u0275dir=E.lG2({type:mr,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function($,R){1&$&&E.NdJ("ionChange",function(Se){return R._handleInputEvent(Se.target)})},features:[E._Bn([{provide:Qe.JU,useExisting:wr,multi:!0}]),E.qOj]}),mr.ctorParameters=()=>[{type:E.zs3},{type:E.SBq}],P([(0,E.L6J)("ionChange",["$event.target"])],mr.prototype,"_handleInputEvent",null);let Ji=class{constructor($,R){this.doc=$,this.backButton=new yt.xQ,this.keyboardDidShow=new yt.xQ,this.keyboardDidHide=new yt.xQ,this.pause=new yt.xQ,this.resume=new yt.xQ,this.resize=new yt.xQ,R.run(()=>{let ue;this.win=$.defaultView,this.backButton.subscribeWithPriority=function(Se,Lt){return this.subscribe(Sn=>Sn.register(Se,Bn=>R.run(()=>Lt(Bn))))},ie(this.pause,$,"pause"),ie(this.resume,$,"resume"),ie(this.backButton,$,"ionBackButton"),ie(this.resize,this.win,"resize"),ie(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),ie(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(Se=>{ue=Se}),this.win&&this.win.cordova?$.addEventListener("deviceready",()=>{ue("cordova")},{once:!0}):ue("dom")})}is($){return(0,bn.a)(this.win,$)}platforms(){return(0,bn.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam($){return hi(this.win.location.href,$)}isLandscape(){return!this.isPortrait()}isPortrait(){return this.win.matchMedia&&this.win.matchMedia("(orientation: portrait)").matches}testUserAgent($){const R=this.win.navigator;return!!(R&&R.userAgent&&R.userAgent.indexOf($)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}};Ji.\u0275fac=function($){return new($||Ji)(E.LFG(et.K0),E.LFG(E.R0b))},Ji.\u0275prov=E.Yz7({token:Ji,factory:function(A){return Ji.\u0275fac(A)},providedIn:"root"}),Ji.ngInjectableDef=(0,E.Yz7)({factory:function(){return new Ji((0,E.LFG)(et.K0),(0,E.LFG)(E.R0b))},token:Ji,providedIn:"root"}),Ji=P([O(0,(0,E.tBr)(et.K0))],Ji);const hi=(A,$)=>{$=$.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");const ue=new RegExp("[\\?&]"+$+"=([^&#]*)").exec(A);return ue?decodeURIComponent(ue[1].replace(/\+/g," ")):null},ie=(A,$,R)=>{$&&$.addEventListener(R,ue=>{A.next(null!=ue?ue.detail:void 0)})};let pe=class{constructor($,R,ue,Se){this.location=R,this.serializer=ue,this.router=Se,this.direction=vt,this.animated=Ct,this.guessDirection="forward",this.lastNavId=-1,Se&&Se.events.subscribe(Lt=>{if(Lt instanceof ct.OD){const Sn=Lt.restoredState?Lt.restoredState.navigationId:Lt.id;this.guessDirection=Sn<this.lastNavId?"back":"forward",this.guessAnimation=Lt.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?Lt.id:Sn}}),$.backButton.subscribeWithPriority(0,Lt=>{this.pop(),Lt()})}navigateForward($,R={}){return this.setDirection("forward",R.animated,R.animationDirection,R.animation),this.navigate($,R)}navigateBack($,R={}){return this.setDirection("back",R.animated,R.animationDirection,R.animation),this.navigate($,R)}navigateRoot($,R={}){return this.setDirection("root",R.animated,R.animationDirection,R.animation),this.navigate($,R)}back($={animated:!0,animationDirection:"back"}){return this.setDirection("back",$.animated,$.animationDirection,$.animation),this.location.back()}pop(){return H(this,void 0,void 0,function*(){let $=this.topOutlet;for(;$&&!(yield $.pop());)$=$.parentOutlet})}setDirection($,R,ue,Se){this.direction=$,this.animated=De($,R,ue),this.animationBuilder=Se}setTopOutlet($){this.topOutlet=$}consumeTransition(){let R,$="root";const ue=this.animationBuilder;return"auto"===this.direction?($=this.guessDirection,R=this.guessAnimation):(R=this.animated,$=this.direction),this.direction=vt,this.animated=Ct,this.animationBuilder=void 0,{direction:$,animation:R,animationBuilder:ue}}navigate($,R){if(Array.isArray($))return this.router.navigate($,R);{const ue=this.serializer.parse($.toString());return void 0!==R.queryParams&&(ue.queryParams=Object.assign({},R.queryParams)),void 0!==R.fragment&&(ue.fragment=R.fragment),this.router.navigateByUrl(ue,R)}}};pe.\u0275fac=function($){return new($||pe)(E.LFG(Ji),E.LFG(et.Ye),E.LFG(ct.Hx),E.LFG(ct.F0,8))},pe.\u0275prov=E.Yz7({token:pe,factory:function(A){return pe.\u0275fac(A)},providedIn:"root"}),pe.ngInjectableDef=(0,E.Yz7)({factory:function(){return new pe((0,E.LFG)(Ji),(0,E.LFG)(et.Ye),(0,E.LFG)(ct.Hx),(0,E.LFG)(ct.F0,8))},token:pe,providedIn:"root"}),pe=P([O(3,(0,E.FiY)())],pe);const De=(A,$,R)=>{if(!1!==$){if(void 0!==R)return R;if("forward"===A||"back"===A)return A;if("root"===A&&!0===$)return"forward"}},vt="auto",Ct=void 0,lt=(A,$)=>{const R=A.prototype;$.forEach(ue=>{Object.defineProperty(R,ue,{get(){return this.el[ue]},set(Se){this.z.runOutsideAngular(()=>this.el[ue]=Se)}})})},Dt=(A,$)=>{const R=A.prototype;$.forEach(ue=>{R[ue]=function(){const Se=arguments;return this.z.runOutsideAngular(()=>this.el[ue].apply(this.el,Se))}})},Ht=(A,$,R)=>{R.forEach(ue=>A[ue]=(0,Xt.R)($,ue))};function Zt(A){return function(R){return A.inputs&&lt(R,A.inputs),A.methods&&Dt(R,A.methods),R}}let un=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-app"]],ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A})(),On=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-avatar"]],ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A})(),at=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],A),A})(),ii=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-badge"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","mode"]})],A),A})(),Qn=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionFocus","ionBlur"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["buttonType","color","disabled","download","expand","fill","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],A),A})(),ei=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["collapse"]})],A),A})(),yi=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],A),A})(),Yn=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["mode"]})],A),A})(),oi=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","mode","translucent"]})],A),A})(),li=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],A),A})(),Ci=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],A),A})(),Ii=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-fab"]],inputs:{activated:"activated",edge:"edge",horizontal:"horizontal",vertical:"vertical"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["activated","edge","horizontal","vertical"],methods:["close"]})],A),A})(),to=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionFocus","ionBlur"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-fab-button"]],inputs:{activated:"activated",closeIcon:"closeIcon",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",show:"show",size:"size",target:"target",translucent:"translucent",type:"type"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["activated","closeIcon","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","show","size","target","translucent","type"]})],A),A})(),Or=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-fab-list"]],inputs:{activated:"activated",side:"side"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["activated","side"]})],A),A})(),jn=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-footer"]],inputs:{mode:"mode",translucent:"translucent"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["mode","translucent"]})],A),A})(),$i=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-grid"]],inputs:{fixed:"fixed"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["fixed"]})],A),A})(),Fr=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["collapse","mode","translucent"]})],A),A})(),Ir=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-icon"]],inputs:{ariaHidden:"ariaHidden",ariaLabel:"ariaLabel",color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["ariaHidden","ariaLabel","color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],A),A})(),xe=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","debounce","disabled","enterkeyhint","inputmode","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],A),A})(),Le=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-item"]],inputs:{button:"button",color:"color",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["button","color","detail","detailIcon","disabled","download","href","lines","mode","rel","routerAnimation","routerDirection","target","type"]})],A),A})(),hn=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","mode","position"]})],A),A})(),fn=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],A),A})(),Vn=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-list-header"]],inputs:{color:"color",lines:"lines",mode:"mode"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","lines","mode"]})],A),A})(),Fn=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],A),A})(),pi=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["autoHide","color","disabled","menu","mode","type"]})],A),A})(),vi=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-menu-toggle"]],inputs:{autoHide:"autoHide",menu:"menu"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["autoHide","menu"]})],A),A})(),yr=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-note"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","mode"]})],A),A})(),ss=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionChange","ionFocus","ionBlur"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-range"]],inputs:{color:"color",debounce:"debounce",disabled:"disabled",dualKnobs:"dualKnobs",max:"max",min:"min",mode:"mode",name:"name",pin:"pin",snaps:"snaps",step:"step",ticks:"ticks",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","debounce","disabled","dualKnobs","max","min","mode","name","pin","snaps","step","ticks","value"]})],A),A})(),no=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionRefresh","ionPull","ionStart"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-refresher"]],inputs:{closeDuration:"closeDuration",disabled:"disabled",pullFactor:"pullFactor",pullMax:"pullMax",pullMin:"pullMin",snapbackDuration:"snapbackDuration"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["closeDuration","disabled","pullFactor","pullMax","pullMin","snapbackDuration"],methods:["complete","cancel","getProgress"]})],A),A})(),io=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-refresher-content"]],inputs:{pullingIcon:"pullingIcon",pullingText:"pullingText",refreshingSpinner:"refreshingSpinner",refreshingText:"refreshingText"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["pullingIcon","pullingText","refreshingSpinner","refreshingText"]})],A),A})(),vs=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-row"]],ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A})(),Rs=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionInput","ionChange","ionCancel","ionClear","ionBlur","ionFocus"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-searchbar"]],inputs:{animated:"animated",autocomplete:"autocomplete",autocorrect:"autocorrect",cancelButtonIcon:"cancelButtonIcon",cancelButtonText:"cancelButtonText",clearIcon:"clearIcon",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",mode:"mode",placeholder:"placeholder",searchIcon:"searchIcon",showCancelButton:"showCancelButton",showClearButton:"showClearButton",spellcheck:"spellcheck",type:"type",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","clearIcon","color","debounce","disabled","enterkeyhint","inputmode","mode","placeholder","searchIcon","showCancelButton","showClearButton","spellcheck","type","value"],methods:["setFocus","getInputElement"]})],A),A})(),ls=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionChange"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","disabled","mode","scrollable","swipeGesture","value"]})],A),A})(),cs=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["disabled","layout","mode","type","value"]})],A),A})(),Lo=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionChange","ionCancel","ionFocus","ionBlur"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-select"]],inputs:{cancelText:"cancelText",compareWith:"compareWith",disabled:"disabled",interface:"interface",interfaceOptions:"interfaceOptions",mode:"mode",multiple:"multiple",name:"name",okText:"okText",placeholder:"placeholder",selectedText:"selectedText",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["cancelText","compareWith","disabled","interface","interfaceOptions","mode","multiple","name","okText","placeholder","selectedText","value"],methods:["open"]})],A),A})(),js=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-select-option"]],inputs:{disabled:"disabled",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["disabled","value"]})],A),A})(),ao=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-spinner"]],inputs:{color:"color",duration:"duration",name:"name",paused:"paused"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","duration","name","paused"]})],A),A})(),Fo=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionSplitPaneVisible"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-split-pane"]],inputs:{contentId:"contentId",disabled:"disabled",when:"when"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["contentId","disabled","when"]})],A),A})(),st=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionChange","ionInput","ionBlur","ionFocus"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-textarea"]],inputs:{autoGrow:"autoGrow",autocapitalize:"autocapitalize",autofocus:"autofocus",clearOnEdit:"clearOnEdit",color:"color",cols:"cols",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",maxlength:"maxlength",minlength:"minlength",mode:"mode",name:"name",placeholder:"placeholder",readonly:"readonly",required:"required",rows:"rows",spellcheck:"spellcheck",value:"value",wrap:"wrap"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["autoGrow","autocapitalize","autofocus","clearOnEdit","color","cols","debounce","disabled","enterkeyhint","inputmode","maxlength","minlength","mode","name","placeholder","readonly","required","rows","spellcheck","value","wrap"],methods:["setFocus","getInputElement"]})],A),A})(),Ie=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-thumbnail"]],ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A})(),rt=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","size"]})],A),A})(),kt=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement,Ht(this,this.el,["ionChange","ionFocus","ionBlur"])}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",mode:"mode",name:"name",value:"value"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["checked","color","disabled","mode","name","value"]})],A),A})(),ri=(()=>{let A=class{constructor(R,ue,Se){this.z=Se,R.detach(),this.el=ue.nativeElement}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(E.sBO),E.Y36(E.SBq),E.Y36(E.R0b))},A.\u0275cmp=E.Xpm({type:A,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:xn,decls:1,vars:0,template:function(R,ue){1&R&&(E.F$t(),E.Hsn(0))},encapsulation:2,changeDetection:0}),A=P([Zt({inputs:["color","mode"]})],A),A})(),fi=class{get($,R){const ue=Cr();return ue?ue.get($,R):null}getBoolean($,R){const ue=Cr();return!!ue&&ue.getBoolean($,R)}getNumber($,R){const ue=Cr();return ue?ue.getNumber($,R):0}set($,R){console.warn("[DEPRECATION][Config]: The Config.set() method is deprecated and will be removed in Ionic Framework 6.0. Please see https://ionicframework.com/docs/angular/config for alternatives.");const ue=Cr();ue&&ue.set($,R)}};fi.\u0275fac=function($){return new($||fi)},fi.\u0275prov=E.Yz7({token:fi,factory:function(A){return fi.\u0275fac(A)},providedIn:"root"}),fi.ngInjectableDef=(0,E.Yz7)({factory:function(){return new fi},token:fi,providedIn:"root"});const dr=new E.OlP("USERCONFIG"),Cr=()=>{if("undefined"!=typeof window){const A=window.Ionic;if(A&&A.config)return A.config}return null};class Io{constructor($={}){this.data=$}get($){return this.data[$]}}let bs=(()=>{let A=class{constructor(R,ue){this.zone=R,this.appRef=ue}create(R,ue,Se){return new Yo(R,ue,Se,this.appRef,this.zone)}};return A.\u0275fac=function(R){return new(R||A)(E.LFG(E.R0b),E.LFG(E.z2F))},A.\u0275prov=E.Yz7({token:A,factory:function($){return A.\u0275fac($)}}),A})();class Yo{constructor($,R,ue,Se,Lt){this.resolver=$,this.injector=R,this.location=ue,this.appRef=Se,this.zone=Lt,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom($,R,ue,Se){return this.zone.run(()=>new Promise(Lt=>{Lt(oa(this.zone,this.resolver,this.injector,this.location,this.appRef,this.elRefMap,this.elEventsMap,$,R,ue,Se))}))}removeViewFromDom($,R){return this.zone.run(()=>new Promise(ue=>{const Se=this.elRefMap.get(R);if(Se){Se.destroy(),this.elRefMap.delete(R);const Lt=this.elEventsMap.get(R);Lt&&(Lt(),this.elEventsMap.delete(R))}ue()}))}}const oa=(A,$,R,ue,Se,Lt,Sn,Bn,Bi,ni,or)=>{const hr=$.resolveComponentFactory(Bi),xr=E.zs3.create({providers:B(ni),parent:R}),oo=ue?ue.createComponent(hr,ue.length,xr):hr.create(xr),Zr=oo.instance,Xr=oo.location.nativeElement;if(ni&&Object.assign(Zr,ni),or)for(const _l of or)Xr.classList.add(_l);const Jr=Os(A,Zr,Xr);return Bn.appendChild(Xr),ue||Se.attachView(oo.hostView),oo.changeDetectorRef.reattach(),Lt.set(Xr,oo),Sn.set(Xr,Jr),Xr},xo=[Bt.L,Bt.a,Bt.b,Bt.c,Bt.d],Os=(A,$,R)=>A.run(()=>{const ue=xo.filter(Se=>"function"==typeof $[Se]).map(Se=>{const Lt=Sn=>$[Se](Sn.detail);return R.addEventListener(Se,Lt),()=>R.removeEventListener(Se,Lt)});return()=>ue.forEach(Se=>Se())}),ae=new E.OlP("NavParamsToken"),B=A=>[{provide:ae,useValue:A},{provide:Io,useFactory:S,deps:[ae]}],S=A=>new Io(A),Jt=(A,$)=>((A=A.filter(R=>R.stackId!==$.stackId)).push($),A),Ri=(A,$)=>{const R=A.createUrlTree(["."],{relativeTo:$});return A.serializeUrl(R)},Wr=(A,$)=>{if(!A)return;const R=go($);for(let ue=0;ue<R.length;ue++){if(ue>=A.length)return R[ue];if(R[ue]!==A[ue])return}},go=A=>A.split("/").map($=>$.trim()).filter($=>""!==$),Lr=A=>{A&&(A.ref.destroy(),A.unlistenEvents())};class Ls{constructor($,R,ue,Se,Lt,Sn){this.containerEl=R,this.router=ue,this.navCtrl=Se,this.zone=Lt,this.location=Sn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==$?go($):void 0}createView($,R){const ue=Ri(this.router,R),Se=$&&$.location&&$.location.nativeElement,Lt=Os(this.zone,$.instance,Se);return{id:this.nextId++,stackId:Wr(this.tabsPrefix,ue),unlistenEvents:Lt,element:Se,ref:$,url:ue}}getExistingView($){const R=Ri(this.router,$),ue=this.views.find(Se=>Se.url===R);return ue&&ue.ref.changeDetectorRef.reattach(),ue}setActive($){const R=this.navCtrl.consumeTransition();let{direction:ue,animation:Se,animationBuilder:Lt}=R;const Sn=this.activeView,Bn=((A,$)=>!$||A.stackId!==$.stackId)($,Sn);Bn&&(ue="back",Se=void 0);const Bi=this.views.slice();let ni;const or=this.router;or.getCurrentNavigation?ni=or.getCurrentNavigation():or.navigations&&or.navigations.value&&(ni=or.navigations.value),ni&&ni.extras&&ni.extras.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const hr=this.views.includes($),xr=this.insertView($,ue);hr||$.ref.changeDetectorRef.detectChanges();const oo=$.animationBuilder;return void 0===Lt&&"back"===ue&&!Bn&&void 0!==oo&&(Lt=oo),Sn&&(Sn.animationBuilder=Lt),this.zone.runOutsideAngular(()=>this.wait(()=>(Sn&&Sn.ref.changeDetectorRef.detach(),$.ref.changeDetectorRef.reattach(),this.transition($,Sn,Se,this.canGoBack(1),!1,Lt).then(()=>qo($,xr,Bi,this.location)).then(()=>({enteringView:$,direction:ue,animation:Se,tabSwitch:Bn})))))}canGoBack($,R=this.getActiveStackId()){return this.getStack(R).length>$}pop($,R=this.getActiveStackId()){return this.zone.run(()=>{const ue=this.getStack(R);if(ue.length<=$)return Promise.resolve(!1);const Se=ue[ue.length-$-1];let Lt=Se.url;const Sn=Se.savedData;if(Sn){const Bi=Sn.get("primary");Bi&&Bi.route&&Bi.route._routerState&&Bi.route._routerState.snapshot&&Bi.route._routerState.snapshot.url&&(Lt=Bi.route._routerState.snapshot.url)}const{animationBuilder:Bn}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Lt,Object.assign({},Se.savedExtras,{animation:Bn})).then(()=>!0)})}startBackTransition(){const $=this.activeView;if($){const R=this.getStack($.stackId),ue=R[R.length-2],Se=ue.animationBuilder;return this.wait(()=>this.transition(ue,$,"back",this.canGoBack(2),!0,Se))}return Promise.resolve()}endBackTransition($){$?(this.skipTransition=!0,this.pop(1)):this.activeView&&Pr(this.activeView,this.views,this.views,this.location)}getLastUrl($){const R=this.getStack($);return R.length>0?R[R.length-1]:void 0}getRootUrl($){const R=this.getStack($);return R.length>0?R[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(Lr),this.activeView=void 0,this.views=[]}getStack($){return this.views.filter(R=>R.stackId===$)}insertView($,R){return this.activeView=$,this.views=((A,$,R)=>"root"===R?Jt(A,$):"forward"===R?((A,$)=>(A.indexOf($)>=0?A=A.filter(ue=>ue.stackId!==$.stackId||ue.id<=$.id):A.push($),A))(A,$):((A,$)=>A.indexOf($)>=0?A.filter(ue=>ue.stackId!==$.stackId||ue.id<=$.id):Jt(A,$))(A,$))(this.views,$,R),this.views.slice()}transition($,R,ue,Se,Lt,Sn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(R===$)return Promise.resolve(!1);const Bn=$?$.element:void 0,Bi=R?R.element:void 0,ni=this.containerEl;return Bn&&Bn!==Bi&&(Bn.classList.add("ion-page"),Bn.classList.add("ion-page-invisible"),Bn.parentElement!==ni&&ni.appendChild(Bn),ni.commit)?ni.commit(Bn,Bi,{deepWait:!0,duration:void 0===ue?0:void 0,direction:ue,showGoBack:Se,progressAnimation:Lt,animationBuilder:Sn}):Promise.resolve(!1)}wait($){return H(this,void 0,void 0,function*(){void 0!==this.runningTask&&(yield this.runningTask,this.runningTask=void 0);const R=this.runningTask=$();return R.finally(()=>this.runningTask=void 0),R})}}const qo=(A,$,R,ue)=>"function"==typeof requestAnimationFrame?new Promise(Se=>{requestAnimationFrame(()=>{Pr(A,$,R,ue),Se()})}):Promise.resolve(),Pr=(A,$,R,ue)=>{R.filter(Se=>!$.includes(Se)).forEach(Lr),$.forEach(Se=>{const Sn=ue.path().split("?")[0].split("#")[0];if(Se!==A&&Se.url!==Sn){const Bn=Se.element;Bn.setAttribute("aria-hidden","true"),Bn.classList.add("ion-page-hidden"),Se.ref.changeDetectorRef.detach()}})};let ws=(()=>{let A=class{constructor(R,ue,Se,Lt,Sn,Bn,Bi,ni,or,hr,xr,oo,Zr){this.parentContexts=R,this.location=ue,this.resolver=Se,this.config=Bn,this.navCtrl=Bi,this.parentOutlet=Zr,this.activated=null,this.activatedView=null,this._activatedRoute=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new cn.X(null),this.stackEvents=new E.vpe,this.activateEvents=new E.vpe,this.deactivateEvents=new E.vpe,this.nativeEl=or.nativeElement,this.name=Lt||ct.eC,this.tabsPrefix="true"===Sn?Ri(hr,oo):void 0,this.stackCtrl=new Ls(this.tabsPrefix,this.nativeEl,hr,Bi,xr,ni),R.onChildOutletCreated(this.name,this)}set animation(R){this.nativeEl.animation=R}set animated(R){this.nativeEl.animated=R}set swipeGesture(R){this._swipeGesture=R,this.nativeEl.swipeHandler=R?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:ue=>this.stackCtrl.endBackTransition(ue)}:void 0}ngOnDestroy(){this.stackCtrl.destroy()}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){if(!this.activated){const R=this.getContext();R&&R.route&&this.activateWith(R.route,R.resolver||null)}new Promise(R=>(0,Nt.c)(this.nativeEl,R)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(R,ue){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const ue=this.getContext();this.activatedView.savedData=new Map(ue.children.contexts);const Se=this.activatedView.savedData.get("primary");if(Se&&ue.route&&(Se.route=Object.assign({},ue.route)),this.activatedView.savedExtras={},ue.route){const Lt=ue.route.snapshot;this.activatedView.savedExtras.queryParams=Lt.queryParams,this.activatedView.savedExtras.fragment=Lt.fragment}}const R=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(R)}}activateWith(R,ue){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=R;let Se,Lt=this.stackCtrl.getExistingView(R);if(Lt){Se=this.activated=Lt.ref;const Sn=Lt.savedData;Sn&&(this.getContext().children.contexts=Sn),this.updateActivatedRouteProxy(Se.instance,R)}else{const Bi=(ue=ue||this.resolver).resolveComponentFactory(R._futureSnapshot.routeConfig.component),ni=this.parentContexts.getOrCreateContext(this.name).children,or=new cn.X(null),hr=this.createActivatedRouteProxy(or,R),xr=new Di(hr,ni,this.location.injector);Se=this.activated=this.location.createComponent(Bi,this.location.length,xr),or.next(Se.instance),Lt=this.stackCtrl.createView(this.activated,R),this.proxyMap.set(Se.instance,hr),this.currentActivatedRoute$.next({component:Se.instance,activatedRoute:R})}this.activatedView=Lt,this.stackCtrl.setActive(Lt).then(Sn=>{this.navCtrl.setTopOutlet(this),this.activateEvents.emit(Se.instance),this.stackEvents.emit(Sn)})}canGoBack(R=1,ue){return this.stackCtrl.canGoBack(R,ue)}pop(R=1,ue){return this.stackCtrl.pop(R,ue)}getLastUrl(R){const ue=this.stackCtrl.getLastUrl(R);return ue?ue.url:void 0}getLastRouteView(R){return this.stackCtrl.getLastUrl(R)}getRootView(R){return this.stackCtrl.getRootUrl(R)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(R,ue){const Se=new ct.gz;return Se._futureSnapshot=ue._futureSnapshot,Se._routerState=ue._routerState,Se.snapshot=ue.snapshot,Se.outlet=ue.outlet,Se.component=ue.component,Se._paramMap=this.proxyObservable(R,"paramMap"),Se._queryParamMap=this.proxyObservable(R,"queryParamMap"),Se.url=this.proxyObservable(R,"url"),Se.params=this.proxyObservable(R,"params"),Se.queryParams=this.proxyObservable(R,"queryParams"),Se.fragment=this.proxyObservable(R,"fragment"),Se.data=this.proxyObservable(R,"data"),Se}proxyObservable(R,ue){return R.pipe((0,Ki.h)(Se=>!!Se),(0,xi.w)(Se=>this.currentActivatedRoute$.pipe((0,Ki.h)(Lt=>null!==Lt&&Lt.component===Se),(0,xi.w)(Lt=>Lt&&Lt.activatedRoute[ue]),R=>R.lift(new mi(void 0,void 0)))))}updateActivatedRouteProxy(R,ue){const Se=this.proxyMap.get(R);if(!Se)throw new Error("Could not find activated route proxy for view");Se._futureSnapshot=ue._futureSnapshot,Se._routerState=ue._routerState,Se.snapshot=ue.snapshot,Se.outlet=ue.outlet,Se.component=ue.component,this.currentActivatedRoute$.next({component:R,activatedRoute:ue})}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(ct.y6),E.Y36(E.s_b),E.Y36(E._Vd),E.$8M("name"),E.$8M("tabs"),E.Y36(fi),E.Y36(pe),E.Y36(et.Ye),E.Y36(E.SBq),E.Y36(ct.F0),E.Y36(E.R0b),E.Y36(ct.gz),E.Y36(A,12))},A.\u0275dir=E.lG2({type:A,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",swipeGesture:"swipeGesture"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),P([(0,E.r_U)()],A.prototype,"stackEvents",void 0),P([(0,E.r_U)("activate")],A.prototype,"activateEvents",void 0),P([(0,E.r_U)("deactivate")],A.prototype,"deactivateEvents",void 0),A=P([O(3,(0,E.ahi)("name")),O(4,(0,E.FiY)()),O(4,(0,E.ahi)("tabs")),O(12,(0,E.tp0)()),O(12,(0,E.FiY)())],A),A})();class Di{constructor($,R,ue){this.route=$,this.childContexts=R,this.parent=ue}get($,R){return $===ct.gz?this.route:$===ct.y6?this.childContexts:this.parent.get($,R)}}let Vl=(()=>{let A=class{constructor(R,ue,Se){this.routerOutlet=R,this.navCtrl=ue,this.config=Se}onClick(R){const ue=this.defaultHref||this.config.get("backButtonDefaultHref");this.routerOutlet&&this.routerOutlet.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),R.preventDefault()):null!=ue&&(this.navCtrl.navigateBack(ue,{animation:this.routerAnimation}),R.preventDefault())}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(ws,8),E.Y36(pe),E.Y36(fi))},A.\u0275dir=E.lG2({type:A,selectors:[["ion-back-button"]],hostBindings:function(R,ue){1&R&&E.NdJ("click",function(Lt){return ue.onClick(Lt)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),P([(0,E.L6J)("click",["$event"])],A.prototype,"onClick",null),A=P([O(0,(0,E.FiY)())],A),A})(),ml=(()=>{let A=class{constructor(R,ue,Se,Lt,Sn){this.locationStrategy=R,this.navCtrl=ue,this.elementRef=Se,this.router=Lt,this.routerLink=Sn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}updateTargetUrlAndHref(){if(this.routerLink){const R=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=R}}onClick(R){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),R.preventDefault()}};return A.\u0275fac=function(R){return new(R||A)(E.Y36(et.S$),E.Y36(pe),E.Y36(E.SBq),E.Y36(ct.F0),E.Y36(ct.rH,8))},A.\u0275dir=E.lG2({type:A,selectors:[["","routerLink",""]],hostBindings:function(R,ue){1&R&&E.NdJ("click",function(Lt){return ue.onClick(Lt)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[E.TTD]}),P([(0,E.L6J)("click",["$event"])],A.prototype,"onClick",null),A=P([O(4,(0,E.FiY)())],A),A})();class vr{constructor($){this.ctrl=$}create($){return this.ctrl.create($||{})}dismiss($,R,ue){return this.ctrl.dismiss($,R,ue)}getTop(){return this.ctrl.getTop()}}let Jo=class extends vr{constructor(){super(Kt.b)}};Jo.\u0275fac=function($){return new($||Jo)},Jo.\u0275prov=E.Yz7({token:Jo,factory:function(A){return Jo.\u0275fac(A)},providedIn:"root"}),Jo.ngInjectableDef=(0,E.Yz7)({factory:function(){return new Jo},token:Jo,providedIn:"root"});let Do=class extends vr{constructor(){super(Kt.a)}};Do.\u0275fac=function($){return new($||Do)},Do.\u0275prov=E.Yz7({token:Do,factory:function(A){return Do.\u0275fac(A)},providedIn:"root"}),Do.ngInjectableDef=(0,E.Yz7)({factory:function(){return new Do},token:Do,providedIn:"root"});let Vr=class extends vr{constructor(){super(Kt.l)}};Vr.\u0275fac=function($){return new($||Vr)},Vr.\u0275prov=E.Yz7({token:Vr,factory:function(A){return Vr.\u0275fac(A)},providedIn:"root"}),Vr.ngInjectableDef=(0,E.Yz7)({factory:function(){return new Vr},token:Vr,providedIn:"root"});let Ko=class{open($){return Mt.m.open($)}close($){return Mt.m.close($)}toggle($){return Mt.m.toggle($)}enable($,R){return Mt.m.enable($,R)}swipeGesture($,R){return Mt.m.swipeGesture($,R)}isOpen($){return Mt.m.isOpen($)}isEnabled($){return Mt.m.isEnabled($)}get($){return Mt.m.get($)}getOpen(){return Mt.m.getOpen()}getMenus(){return Mt.m.getMenus()}};Ko.\u0275fac=function($){return new($||Ko)},Ko.\u0275prov=E.Yz7({token:Ko,factory:function(A){return Ko.\u0275fac(A)},providedIn:"root"}),Ko.ngInjectableDef=(0,E.Yz7)({factory:function(){return new Ko},token:Ko,providedIn:"root"});let bo=class extends vr{constructor(){super(Kt.p)}};bo.\u0275fac=function($){return new($||bo)},bo.\u0275prov=E.Yz7({token:bo,factory:function(A){return bo.\u0275fac(A)},providedIn:"root"}),bo.ngInjectableDef=(0,E.Yz7)({factory:function(){return new bo},token:bo,providedIn:"root"});let aa=(()=>{let A=class extends vr{constructor(R,ue,Se){super(Kt.m),this.angularDelegate=R,this.resolver=ue,this.injector=Se}create(R){return super.create(Object.assign({},R,{delegate:this.angularDelegate.create(this.resolver,this.injector)}))}};return A.\u0275fac=function(R){return new(R||A)(E.LFG(bs),E.LFG(E._Vd),E.LFG(E.zs3))},A.\u0275prov=E.Yz7({token:A,factory:function($){return A.\u0275fac($)}}),A})(),ya=(()=>{let A=class extends vr{constructor(R,ue,Se){super(Kt.c),this.angularDelegate=R,this.resolver=ue,this.injector=Se}create(R){return super.create(Object.assign({},R,{delegate:this.angularDelegate.create(this.resolver,this.injector)}))}};return A.\u0275fac=function(R){return new(R||A)(E.LFG(bs),E.LFG(E._Vd),E.LFG(E.zs3))},A.\u0275prov=E.Yz7({token:A,factory:function($){return A.\u0275fac($)}}),A})(),No=class extends vr{constructor(){super(Kt.t)}};No.\u0275fac=function($){return new($||No)},No.\u0275prov=E.Yz7({token:No,factory:function(A){return No.\u0275fac(A)},providedIn:"root"}),No.ngInjectableDef=(0,E.Yz7)({factory:function(){return new No},token:No,providedIn:"root"});let Ni=class{read($){Yr().read($)}write($){Yr().write($)}};Ni.\u0275fac=function($){return new($||Ni)},Ni.\u0275prov=E.Yz7({token:Ni,factory:function(A){return Ni.\u0275fac(A)},providedIn:"root"}),Ni.ngInjectableDef=(0,E.Yz7)({factory:function(){return new Ni},token:Ni,providedIn:"root"});const Yr=()=>{const A="undefined"!=typeof window?window:null;if(null!=A){const $=A.Ionic;return $&&$.queue?$.queue:{read:R=>A.requestAnimationFrame(R),write:R=>A.requestAnimationFrame(R)}}return{read:$=>$(),write:$=>$()}};let Cs=class{create($){return(0,gt.c)($)}easingTime($,R,ue,Se,Lt){return(0,St.g)($,R,ue,Se,Lt)}};Cs.\u0275fac=function($){return new($||Cs)},Cs.\u0275prov=E.Yz7({token:Cs,factory:function(A){return Cs.\u0275fac(A)},providedIn:"root"}),Cs.ngInjectableDef=(0,E.Yz7)({factory:function(){return new Cs},token:Cs,providedIn:"root"});let ro=class{constructor($){this.zone=$}create($,R=!1){return R&&Object.getOwnPropertyNames($).forEach(ue=>{if("function"==typeof $[ue]){const Se=$[ue];$[ue]=(...Lt)=>this.zone.run(()=>Se(...Lt))}}),(0,Vt.createGesture)($)}};ro.\u0275fac=function($){return new($||ro)(E.LFG(E.R0b))},ro.\u0275prov=E.Yz7({token:ro,factory:function(A){return ro.\u0275fac(A)},providedIn:"root"}),ro.ngInjectableDef=(0,E.Yz7)({factory:function(){return new ro((0,E.LFG)(E.R0b))},token:ro,providedIn:"root"});class Ts{shouldDetach($){return!1}shouldAttach($){return!1}store($,R){}retrieve($){return null}shouldReuseRoute($,R){if($.routeConfig!==R.routeConfig)return!1;const ue=$.params,Se=R.params,Lt=Object.keys(ue),Sn=Object.keys(Se);if(Lt.length!==Sn.length)return!1;for(const Bn of Lt)if(Se[Bn]!==ue[Bn])return!1;return!0}}const va=(A,$,R)=>()=>{if($.defaultView&&"undefined"!=typeof window){(A=>{const $=window,R=$.Ionic;R&&R.config&&"Object"!==R.config.constructor.name||($.Ionic=$.Ionic||{},$.Ionic.config=Object.assign(Object.assign({},$.Ionic.config),A))})(Object.assign({},A,{_zoneGate:Lt=>R.run(Lt)}));const Se="__zone_symbol__addEventListener"in $.body?"__zone_symbol__addEventListener":"addEventListener";return function(){var A=[];if("undefined"!=typeof window){var $=window;(!$.customElements||$.Element&&(!$.Element.prototype.closest||!$.Element.prototype.matches||!$.Element.prototype.remove||!$.Element.prototype.getRootNode))&&A.push(N.e(6748).then(N.t.bind(N,1394,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||$.NodeList&&!$.NodeList.prototype.forEach||!$.fetch||!function(){try{var ue=new URL("b","http://a");return ue.pathname="c%20d","http://a/c%20d"===ue.href&&ue.searchParams}catch{return!1}}()||"undefined"==typeof WeakMap)&&A.push(N.e(2214).then(N.t.bind(N,9631,23)))}return Promise.all(A)}().then(()=>((A,$)=>"undefined"==typeof window?Promise.resolve():(Ft.C&&Ft.C.supports&&Ft.C.supports("color","var(--c)")?(0,Ft.a)():N.e(1843).then(N.t.bind(N,8181,23)).then(()=>(Ft.p.$cssShim$=Ft.w.__cssshim)?Ft.p.$cssShim$.i():0)).then(()=>(Vi(),(0,Ft.b)(JSON.parse('[["ion-select_3",[[2,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"options":[16]},[[0,"ionChange","onSelect"]]],[33,"ion-select",{"disabled":[4],"cancelText":[1,"cancel-text"],"okText":[1,"ok-text"],"placeholder":[1],"name":[1],"selectedText":[1,"selected-text"],"multiple":[4],"interface":[1],"interfaceOptions":[8,"interface-options"],"compareWith":[1,"compare-with"],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}]]],["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[4],"layout":[1],"type":[1],"value":[1],"checked":[32]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1025],"activated":[32]}]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[33,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-modal",[[34,"ion-modal",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"swipeToClose":[4,"swipe-to-close"],"presentingElement":[16],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-popover",[[34,"ion-popover",{"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-app_8",[[0,"ion-app"],[34,"ion-buttons",{"collapse":[4]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"],[2,"click","onClick"]]],[36,"ion-footer",{"translucent":[4]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-slide_2",[[0,"ion-slide"],[36,"ion-slides",{"options":[8],"pager":[4],"scrollbar":[4],"update":[64],"updateAutoHeight":[64],"slideTo":[64],"slideNext":[64],"slidePrev":[64],"getActiveIndex":[64],"getPreviousIndex":[64],"length":[64],"isEnd":[64],"isBeginning":[64],"startAutoplay":[64],"stopAutoplay":[64],"lockSwipeToNext":[64],"lockSwipeToPrev":[64],"lockSwipes":[64],"getSwiper":[64]}]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[1]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-input",[[34,"ion-input",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"inputmode":[1],"max":[1],"maxlength":[2],"min":[1],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"snaps":[4],"step":[2],"ticks":[4],"disabled":[4],"value":[1026],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-textarea",[[34,"ion-textarea",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[1028,"clear-on-edit"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[4,"auto-grow"],"value":[1025],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"activated":[32]}]]],["ion-virtual-scroll",[[0,"ion-virtual-scroll",{"approxItemHeight":[2,"approx-item-height"],"approxHeaderHeight":[2,"approx-header-height"],"approxFooterHeight":[2,"approx-footer-height"],"headerFn":[16],"footerFn":[16],"items":[16],"itemHeight":[16],"headerHeight":[16],"footerHeight":[16],"renderItem":[16],"renderHeader":[16],"renderFooter":[16],"nodeRender":[16],"domRender":[16],"totalHeight":[32],"positionForItem":[64],"checkRange":[64],"checkEnd":[64]},[[9,"resize","onResize"]]]]],["ion-datetime_3",[[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[33,"ion-datetime",{"name":[1],"disabled":[4],"readonly":[4],"min":[1025],"max":[1025],"displayFormat":[1,"display-format"],"displayTimezone":[1,"display-timezone"],"pickerFormat":[1,"picker-format"],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"monthNames":[1,"month-names"],"monthShortNames":[1,"month-short-names"],"dayNames":[1,"day-names"],"dayShortNames":[1,"day-short-names"],"pickerOptions":[16],"placeholder":[1],"value":[1025],"isExpanded":[32],"open":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ariaLabel":[1537,"aria-label"],"ariaHidden":[513,"aria-hidden"],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[33,"ion-note",{"color":[513]}],[1,"ion-skeleton-text",{"animated":[4]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"href":[1],"rel":[1],"lines":[1],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"multipleInputs":[32],"focusable":[32]},[[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}]]]]'),$))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:pn,jmp:Lt=>R.runOutsideAngular(Lt),ael(Lt,Sn,Bn,Bi){Lt[Se](Sn,Bn,Bi)},rel(Lt,Sn,Bn,Bi){Lt.removeEventListener(Sn,Bn,Bi)}}))}};var la;let Xo=la=class{static forRoot($){return{ngModule:la,providers:[{provide:dr,useValue:$},{provide:E.ip1,useFactory:va,multi:!0,deps:[dr,et.K0,E.R0b]}]}}};Xo.\u0275fac=function($){return new($||Xo)},Xo.\u0275mod=E.oAB({type:Xo}),Xo.\u0275inj=E.cJS({providers:[bs,aa,ya],imports:[[et.ez]]})},3119:(yn,je,N)=>{"use strict";N.d(je,{c:()=>ve});var x=N(697);let d;const l=we=>we.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),P=we=>{if(void 0===d){const Ne=void 0!==we.style.webkitAnimationName;d=void 0===we.style.animationName&&Ne?"-webkit-":""}return d},O=(we,ze,Ne)=>{const Ae=ze.startsWith("animation")?P(we):"";we.style.setProperty(Ae+ze,Ne)},f=(we,ze)=>{const Ne=ze.startsWith("animation")?P(we):"";we.style.removeProperty(Ne+ze)},K=[],me=(we=[],ze)=>{if(void 0!==ze){const Ne=Array.isArray(ze)?ze:[ze];return[...we,...Ne]}return we},ve=we=>{let ze,Ne,Ae,Te,He,Ge,ct,Bt,Mt,Kt,Ot,tn,en,Fe=[],E=[],Qe=[],et=!1,gt={},bt=[],ut=[],St={},Vt=0,bn=!1,Nt=!1,Ft=!0,ln=!1,nn=!0;const yt=we,Xt=[],cn=[],kn=[],An=[],mi=[],si=[],Ki=[],xi=[],Wi=[],Vi=[],_i="function"==typeof AnimationEffect||"function"==typeof window.AnimationEffect,bi="function"==typeof Element&&"function"==typeof Element.prototype.animate&&_i,_e=(xe,Le)=>((Le&&Le.oneTimeCallback?cn:Xt).push({c:xe,o:Le}),en),j=()=>{if(bi)Vi.forEach(xe=>{xe.cancel()}),Vi.length=0;else{const xe=kn.slice();(0,x.r)(()=>{xe.forEach(Le=>{f(Le,"animation-name"),f(Le,"animation-duration"),f(Le,"animation-timing-function"),f(Le,"animation-iteration-count"),f(Le,"animation-delay"),f(Le,"animation-play-state"),f(Le,"animation-fill-mode"),f(Le,"animation-direction")})})}},ye=()=>{mi.forEach(xe=>{xe&&xe.parentNode&&xe.parentNode.removeChild(xe)}),mi.length=0},wr=()=>void 0!==He?He:ct?ct.getFill():"both",mr=()=>void 0!==Mt?Mt:void 0!==Ge?Ge:ct?ct.getDirection():"normal",Ji=()=>bn?"linear":void 0!==Ae?Ae:ct?ct.getEasing():"linear",hi=()=>Nt?0:void 0!==Kt?Kt:void 0!==Ne?Ne:ct?ct.getDuration():0,re=()=>void 0!==Te?Te:ct?ct.getIterations():1,ie=()=>void 0!==Ot?Ot:void 0!==ze?ze:ct?ct.getDelay():0,Yt=()=>{0!==Vt&&(Vt--,0===Vt&&((()=>{Ii(),xi.forEach(Et=>Et()),Wi.forEach(Et=>Et());const xe=Ft?1:0,Le=bt,Ke=ut,$t=St;kn.forEach(Et=>{const Qt=Et.classList;Le.forEach(mn=>Qt.add(mn)),Ke.forEach(mn=>Qt.remove(mn));for(const mn in $t)$t.hasOwnProperty(mn)&&O(Et,mn,$t[mn])}),Xt.forEach(Et=>Et.c(xe,en)),cn.forEach(Et=>Et.c(xe,en)),cn.length=0,nn=!0,Ft&&(ln=!0),Ft=!0})(),ct&&ct.animationFinish()))},ei=(xe=!0)=>{(()=>{si.forEach($t=>$t()),Ki.forEach($t=>$t());const xe=E,Le=Qe,Ke=gt;kn.forEach($t=>{const Et=$t.classList;xe.forEach(Qt=>Et.add(Qt)),Le.forEach(Qt=>Et.remove(Qt));for(const Qt in Ke)Ke.hasOwnProperty(Qt)&&O($t,Qt,Ke[Qt])})})(),Fe.length>0&&(bi?(kn.forEach(xe=>{const Le=xe.animate(Fe,{id:yt,delay:ie(),duration:hi(),easing:Ji(),iterations:re(),fill:wr(),direction:mr()});Le.pause(),Vi.push(Le)}),Vi.length>0&&(Vi[0].onfinish=()=>{Yt()})):((xe=!0)=>{ye();const Le=(we=>(we.forEach(ze=>{for(const Ne in ze)if(ze.hasOwnProperty(Ne)){const Ae=ze[Ne];if("easing"===Ne)ze["animation-timing-function"]=Ae,delete ze[Ne];else{const Te=l(Ne);Te!==Ne&&(ze[Te]=Ae,delete ze[Ne])}}}),we))(Fe);kn.forEach(Ke=>{if(Le.length>0){const $t=((we=[])=>we.map(ze=>{const Ne=ze.offset,Ae=[];for(const Te in ze)ze.hasOwnProperty(Te)&&"offset"!==Te&&Ae.push(`${Te}: ${ze[Te]};`);return`${100*Ne}% { ${Ae.join(" ")} }`}).join(" "))(Le);tn=void 0!==we?we:(we=>{let ze=K.indexOf(we);return ze<0&&(ze=K.push(we)-1),`ion-animation-${ze}`})($t);const Et=((we,ze,Ne)=>{const Ae=(we=>{const ze=we.getRootNode();return ze.head||ze})(Ne),Te=P(Ne),He=Ae.querySelector("#"+we);if(He)return He;const Ge=(Ne.ownerDocument||document).createElement("style");return Ge.id=we,Ge.textContent=`@${Te}keyframes ${we} { ${ze} } @${Te}keyframes ${we}-alt { ${ze} }`,Ae.appendChild(Ge),Ge})(tn,$t,Ke);mi.push(Et),O(Ke,"animation-duration",`${hi()}ms`),O(Ke,"animation-timing-function",Ji()),O(Ke,"animation-delay",`${ie()}ms`),O(Ke,"animation-fill-mode",wr()),O(Ke,"animation-direction",mr());const Qt=re()===1/0?"infinite":re().toString();O(Ke,"animation-iteration-count",Qt),O(Ke,"animation-play-state","paused"),xe&&O(Ke,"animation-name",`${Et.id}-alt`),(0,x.r)(()=>{O(Ke,"animation-name",Et.id||null)})}})})(xe)),et=!0},yi=xe=>{if(xe=Math.min(Math.max(xe,0),.9999),bi)Vi.forEach(Le=>{Le.currentTime=Le.effect.getComputedTiming().delay+hi()*xe,Le.pause()});else{const Le=`-${hi()*xe}ms`;kn.forEach(Ke=>{Fe.length>0&&(O(Ke,"animation-delay",Le),O(Ke,"animation-play-state","paused"))})}},Yn=xe=>{Vi.forEach(Le=>{Le.effect.updateTiming({delay:ie(),duration:hi(),easing:Ji(),iterations:re(),fill:wr(),direction:mr()})}),void 0!==xe&&yi(xe)},oi=(xe=!0,Le)=>{(0,x.r)(()=>{kn.forEach(Ke=>{O(Ke,"animation-name",tn||null),O(Ke,"animation-duration",`${hi()}ms`),O(Ke,"animation-timing-function",Ji()),O(Ke,"animation-delay",void 0!==Le?`-${Le*hi()}ms`:`${ie()}ms`),O(Ke,"animation-fill-mode",wr()||null),O(Ke,"animation-direction",mr()||null);const $t=re()===1/0?"infinite":re().toString();O(Ke,"animation-iteration-count",$t),xe&&O(Ke,"animation-name",`${tn}-alt`),(0,x.r)(()=>{O(Ke,"animation-name",tn||null)})})})},En=(xe=!1,Le=!0,Ke)=>(xe&&An.forEach($t=>{$t.update(xe,Le,Ke)}),bi?Yn(Ke):oi(Le,Ke),en),li=()=>{et&&(bi?Vi.forEach(xe=>{xe.pause()}):kn.forEach(xe=>{O(xe,"animation-play-state","paused")}))},ui=()=>{Bt=void 0,Yt()},Ii=()=>{Bt&&clearTimeout(Bt)},Fr=xe=>new Promise(Le=>{xe&&xe.sync&&(Nt=!0,_e(()=>Nt=!1,{oneTimeCallback:!0})),et||ei(),ln&&(bi?(yi(0),Yn()):oi(),ln=!1),nn&&(Vt=An.length+1,nn=!1),_e(()=>Le(),{oneTimeCallback:!0}),An.forEach(Ke=>{Ke.play()}),bi?(Vi.forEach(xe=>{xe.play()}),(0===Fe.length||0===kn.length)&&Yt()):(()=>{if(Ii(),(0,x.r)(()=>{kn.forEach(xe=>{Fe.length>0&&O(xe,"animation-play-state","running")})}),0===Fe.length||0===kn.length)Yt();else{const xe=ie()||0,Le=hi()||0,Ke=re()||1;isFinite(Ke)&&(Bt=setTimeout(ui,xe+Le*Ke+100)),((we,ze)=>{let Ne;const Ae={passive:!0},He=Ge=>{we===Ge.target&&(Ne&&Ne(),Ii(),(0,x.r)(()=>{kn.forEach(xe=>{f(xe,"animation-duration"),f(xe,"animation-delay"),f(xe,"animation-play-state")}),(0,x.r)(Yt)}))};we&&(we.addEventListener("webkitAnimationEnd",He,Ae),we.addEventListener("animationend",He,Ae),Ne=()=>{we.removeEventListener("webkitAnimationEnd",He,Ae),we.removeEventListener("animationend",He,Ae)})})(kn[0])}})()}),Nr=(xe,Le)=>{const Ke=Fe[0];return void 0===Ke||void 0!==Ke.offset&&0!==Ke.offset?Fe=[{offset:0,[xe]:Le},...Fe]:Ke[xe]=Le,en};return en={parentAnimation:ct,elements:kn,childAnimations:An,id:yt,animationFinish:Yt,from:Nr,to:(xe,Le)=>{const Ke=Fe[Fe.length-1];return void 0===Ke||void 0!==Ke.offset&&1!==Ke.offset?Fe=[...Fe,{offset:1,[xe]:Le}]:Ke[xe]=Le,en},fromTo:(xe,Le,Ke)=>Nr(xe,Le).to(xe,Ke),parent:xe=>(ct=xe,en),play:Fr,pause:()=>(An.forEach(xe=>{xe.pause()}),li(),en),stop:()=>{An.forEach(xe=>{xe.stop()}),et&&(j(),et=!1),bn=!1,Nt=!1,nn=!0,Mt=void 0,Kt=void 0,Ot=void 0,Vt=0,ln=!1,Ft=!0},destroy:xe=>(An.forEach(Le=>{Le.destroy(xe)}),(xe=>{j(),xe&&ye()})(xe),kn.length=0,An.length=0,Fe.length=0,Xt.length=0,cn.length=0,et=!1,nn=!0,en),keyframes:xe=>(Fe=xe,en),addAnimation:xe=>{if(null!=xe)if(Array.isArray(xe))for(const Le of xe)Le.parent(en),An.push(Le);else xe.parent(en),An.push(xe);return en},addElement:xe=>{if(null!=xe)if(1===xe.nodeType)kn.push(xe);else if(xe.length>=0)for(let Le=0;Le<xe.length;Le++)kn.push(xe[Le]);else console.error("Invalid addElement value");return en},update:En,fill:xe=>(He=xe,En(!0),en),direction:xe=>(Ge=xe,En(!0),en),iterations:xe=>(Te=xe,En(!0),en),duration:xe=>(!bi&&0===xe&&(xe=1),Ne=xe,En(!0),en),easing:xe=>(Ae=xe,En(!0),en),delay:xe=>(ze=xe,En(!0),en),getWebAnimations:()=>Vi,getKeyframes:()=>Fe,getFill:wr,getDirection:mr,getDelay:ie,getIterations:re,getEasing:Ji,getDuration:hi,afterAddRead:xe=>(xi.push(xe),en),afterAddWrite:xe=>(Wi.push(xe),en),afterClearStyles:(xe=[])=>{for(const Le of xe)St[Le]="";return en},afterStyles:(xe={})=>(St=xe,en),afterRemoveClass:xe=>(ut=me(ut,xe),en),afterAddClass:xe=>(bt=me(bt,xe),en),beforeAddRead:xe=>(si.push(xe),en),beforeAddWrite:xe=>(Ki.push(xe),en),beforeClearStyles:(xe=[])=>{for(const Le of xe)gt[Le]="";return en},beforeStyles:(xe={})=>(gt=xe,en),beforeRemoveClass:xe=>(Qe=me(Qe,xe),en),beforeAddClass:xe=>(E=me(E,xe),en),onFinish:_e,progressStart:(xe=!1,Le)=>(An.forEach(Ke=>{Ke.progressStart(xe,Le)}),li(),bn=xe,et?En(!1,!0,Le):ei(),en),progressStep:xe=>(An.forEach(Le=>{Le.progressStep(xe)}),yi(xe),en),progressEnd:(xe,Le,Ke)=>(bn=!1,An.forEach($t=>{$t.progressEnd(xe,Le,Ke)}),void 0!==Ke&&(Kt=Ke),ln=!1,Ft=!0,0===xe?(Mt="reverse"===mr()?"normal":"reverse","reverse"===Mt&&(Ft=!1),bi?(En(),yi(1-Le)):(Ot=(1-Le)*hi()*-1,En(!1,!1))):1===xe&&(bi?(En(),yi(Le)):(Ot=Le*hi()*-1,En(!1,!1))),void 0!==xe&&(_e(()=>{Kt=void 0,Mt=void 0,Ot=void 0},{oneTimeCallback:!0}),ct||Fr()),en)}}},3616:(yn,je,N)=>{"use strict";N.d(je,{g:()=>x});const x=(O,f,H,te,K)=>Y(O[1],f[1],H[1],te[1],K).map(G=>d(O[0],f[0],H[0],te[0],G)),d=(O,f,H,te,K)=>K*(3*f*Math.pow(K-1,2)+K*(-3*H*K+3*H+te*K))-O*Math.pow(K-1,3),Y=(O,f,H,te,K)=>P((te-=K)-3*(H-=K)+3*(f-=K)-(O-=K),3*H-6*f+3*O,3*f-3*O,O).filter(ne=>ne>=0&&ne<=1),P=(O,f,H,te)=>{if(0===O)return((O,f,H)=>{const te=f*f-4*O*H;return te<0?[]:[(-f+Math.sqrt(te))/(2*O),(-f-Math.sqrt(te))/(2*O)]})(f,H,te);const K=(3*(H/=O)-(f/=O)*f)/3,G=(2*f*f*f-9*f*H+27*(te/=O))/27;if(0===K)return[Math.pow(-G,1/3)];if(0===G)return[Math.sqrt(-K),-Math.sqrt(-K)];const ne=Math.pow(G/2,2)+Math.pow(K/3,3);if(0===ne)return[Math.pow(G/2,.5)-f/3];if(ne>0)return[Math.pow(-G/2+Math.sqrt(ne),1/3)-Math.pow(G/2+Math.sqrt(ne),1/3)-f/3];const ce=Math.sqrt(Math.pow(-K/3,3)),me=Math.acos(-G/(2*Math.sqrt(Math.pow(-K/3,3)))),ve=2*Math.pow(ce,1/3);return[ve*Math.cos(me/3)-f/3,ve*Math.cos((me+2*Math.PI)/3)-f/3,ve*Math.cos((me+4*Math.PI)/3)-f/3]}},5042:(yn,je,N)=>{"use strict";N.d(je,{G:()=>P});class d{constructor(f,H,te,K,G){this.id=H,this.name=te,this.disableScroll=G,this.priority=1e6*K+H,this.ctrl=f}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const f=this.ctrl.capture(this.name,this.id,this.priority);return f&&this.disableScroll&&this.ctrl.disableScroll(this.id),f}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class Y{constructor(f,H,te,K){this.id=H,this.disable=te,this.disableScroll=K,this.ctrl=f}block(){if(this.ctrl){if(this.disable)for(const f of this.disable)this.ctrl.disableGesture(f,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const f of this.disable)this.ctrl.enableGesture(f,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const l="backdrop-no-scroll",P=new class{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(f){return new d(this,this.newID(),f.name,f.priority||0,!!f.disableScroll)}createBlocker(f={}){return new Y(this,this.newID(),f.disable,!!f.disableScroll)}start(f,H,te){return this.canStart(f)?(this.requestedStart.set(H,te),!0):(this.requestedStart.delete(H),!1)}capture(f,H,te){if(!this.start(f,H,te))return!1;const K=this.requestedStart;let G=-1e4;if(K.forEach(ne=>{G=Math.max(G,ne)}),G===te){this.capturedId=H,K.clear();const ne=new CustomEvent("ionGestureCaptured",{detail:{gestureName:f}});return document.dispatchEvent(ne),!0}return K.delete(H),!1}release(f){this.requestedStart.delete(f),this.capturedId===f&&(this.capturedId=void 0)}disableGesture(f,H){let te=this.disabledGestures.get(f);void 0===te&&(te=new Set,this.disabledGestures.set(f,te)),te.add(H)}enableGesture(f,H){const te=this.disabledGestures.get(f);void 0!==te&&te.delete(H)}disableScroll(f){this.disabledScroll.add(f),1===this.disabledScroll.size&&document.body.classList.add(l)}enableScroll(f){this.disabledScroll.delete(f),0===this.disabledScroll.size&&document.body.classList.remove(l)}canStart(f){return!(void 0!==this.capturedId||this.isDisabled(f))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(f){const H=this.disabledGestures.get(f);return!!(H&&H.size>0)}newID(){return this.gestureId++,this.gestureId}}},3439:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{MENU_BACK_BUTTON_PRIORITY:()=>P,OVERLAY_BACK_BUTTON_PRIORITY:()=>l,blockHardwareBackButton:()=>d,startHardwareBackButton:()=>Y});var x=N(4553);const d=()=>{document.addEventListener("backbutton",()=>{})},Y=()=>{const O=document;let f=!1;O.addEventListener("backbutton",()=>{if(f)return;let H=0,te=[];const K=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(ce,me){te.push({priority:ce,handler:me,id:H++})}}});O.dispatchEvent(K);const G=function(){var ce=(0,x.Z)(function*(me){try{if(me&&me.handler){const ve=me.handler(ne);null!=ve&&(yield ve)}}catch(ve){console.error(ve)}});return function(ve){return ce.apply(this,arguments)}}(),ne=()=>{if(te.length>0){let ce={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};te.forEach(me=>{me.priority>=ce.priority&&(ce=me)}),f=!0,te=te.filter(me=>me.id!==ce.id),G(ce).then(()=>f=!1)}};ne()})},l=100,P=99},697:(yn,je,N)=>{"use strict";N.d(je,{a:()=>Y,b:()=>l,c:()=>x,d:()=>te,e:()=>K,f:()=>we,g:()=>P,h:()=>H,i:()=>d,j:()=>G,k:()=>f,l:()=>ne,m:()=>ve,n:()=>ze,o:()=>ce,p:()=>me,r:()=>O});const x=(Ne,Ae)=>{Ne.componentOnReady?Ne.componentOnReady().then(Te=>Ae(Te)):O(()=>Ae(Ne))},d=(Ne,Ae=[])=>{const Te={};return Ae.forEach(He=>{Ne.hasAttribute(He)&&(null!==Ne.getAttribute(He)&&(Te[He]=Ne.getAttribute(He)),Ne.removeAttribute(He))}),Te},Y=(Ne,Ae,Te,He)=>{if("undefined"!=typeof window){const Ge=window,Fe=Ge&&Ge.Ionic&&Ge.Ionic.config;if(Fe){const E=Fe.get("_ael");if(E)return E(Ne,Ae,Te,He);if(Fe._ael)return Fe._ael(Ne,Ae,Te,He)}}return Ne.addEventListener(Ae,Te,He)},l=(Ne,Ae,Te,He)=>{if("undefined"!=typeof window){const Ge=window,Fe=Ge&&Ge.Ionic&&Ge.Ionic.config;if(Fe){const E=Fe.get("_rel");if(E)return E(Ne,Ae,Te,He);if(Fe._rel)return Fe._rel(Ne,Ae,Te,He)}}return Ne.removeEventListener(Ae,Te,He)},P=(Ne,Ae=Ne)=>Ne.shadowRoot||Ae,O=Ne=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Ne):"function"==typeof requestAnimationFrame?requestAnimationFrame(Ne):setTimeout(Ne),f=Ne=>!!Ne.shadowRoot&&!!Ne.attachShadow,H=Ne=>{const Ae=Ne.closest("ion-item");return Ae?Ae.querySelector("ion-label"):null},te=(Ne,Ae)=>{let Te;const He=Ne.getAttribute("aria-labelledby"),Ge=Ne.id;let Fe=null!==He&&""!==He.trim()?He:Ae+"-lbl",E=null!==He&&""!==He.trim()?document.getElementById(He):H(Ne);return E?(null===He&&(E.id=Fe),Te=E.textContent,E.setAttribute("aria-hidden","true")):""!==Ge.trim()&&(E=document.querySelector(`label[for="${Ge}"]`),E&&(""!==E.id?Fe=E.id:E.id=Fe=`${Ge}-lbl`,Te=E.textContent)),{label:E,labelId:Fe,labelText:Te}},K=(Ne,Ae,Te,He,Ge)=>{if(Ne||f(Ae)){let Fe=Ae.querySelector("input.aux-input");Fe||(Fe=Ae.ownerDocument.createElement("input"),Fe.type="hidden",Fe.classList.add("aux-input"),Ae.appendChild(Fe)),Fe.disabled=Ge,Fe.name=Te,Fe.value=He||""}},G=(Ne,Ae,Te)=>Math.max(Ne,Math.min(Ae,Te)),ne=(Ne,Ae)=>{if(!Ne){const Te="ASSERT: "+Ae;throw console.error(Te),new Error(Te)}},ce=Ne=>Ne.timeStamp||Date.now(),me=Ne=>{if(Ne){const Ae=Ne.changedTouches;if(Ae&&Ae.length>0){const Te=Ae[0];return{x:Te.clientX,y:Te.clientY}}if(void 0!==Ne.pageX)return{x:Ne.pageX,y:Ne.pageY}}return{x:0,y:0}},ve=Ne=>{const Ae="rtl"===document.dir;switch(Ne){case"start":return Ae;case"end":return!Ae;default:throw new Error(`"${Ne}" is not a valid value for [side]. Use "start" or "end" instead.`)}},we=(Ne,Ae)=>{const Te=Ne._original||Ne;return{_original:Ne,emit:ze(Te.emit.bind(Te),Ae)}},ze=(Ne,Ae=0)=>{let Te;return(...He)=>{clearTimeout(Te),Te=setTimeout(Ne,Ae,...He)}}},6190:(yn,je,N)=>{"use strict";N.d(je,{m:()=>G});var x=N(4553),d=N(3439),Y=N(697),l=N(4980),P=N(3119);const O=ne=>(0,P.c)().duration(ne?400:300),f=ne=>{let ce,me;const ve=ne.width+8,we=(0,P.c)(),ze=(0,P.c)();ne.isEndSide?(ce=ve+"px",me="0px"):(ce=-ve+"px",me="0px"),we.addElement(ne.menuInnerEl).fromTo("transform",`translateX(${ce})`,`translateX(${me})`);const Ae="ios"===(0,l.b)(ne),Te=Ae?.2:.25;return ze.addElement(ne.backdropEl).fromTo("opacity",.01,Te),O(Ae).addAnimation([we,ze])},H=ne=>{let ce,me;const ve=(0,l.b)(ne),we=ne.width;ne.isEndSide?(ce=-we+"px",me=we+"px"):(ce=we+"px",me=-we+"px");const ze=(0,P.c)().addElement(ne.menuInnerEl).fromTo("transform",`translateX(${me})`,"translateX(0px)"),Ne=(0,P.c)().addElement(ne.contentEl).fromTo("transform","translateX(0px)",`translateX(${ce})`),Ae=(0,P.c)().addElement(ne.backdropEl).fromTo("opacity",.01,.32);return O("ios"===ve).addAnimation([ze,Ne,Ae])},te=ne=>{const ce=(0,l.b)(ne),me=ne.width*(ne.isEndSide?-1:1)+"px",ve=(0,P.c)().addElement(ne.contentEl).fromTo("transform","translateX(0px)",`translateX(${me})`);return O("ios"===ce).addAnimation(ve)},G=(()=>{const ne=new Map,ce=[],me=function(){var Mt=(0,x.Z)(function*(Kt){const Ot=yield He(Kt);return!!Ot&&Ot.open()});return function(Ot){return Mt.apply(this,arguments)}}(),ve=function(){var Mt=(0,x.Z)(function*(Kt){const Ot=yield void 0!==Kt?He(Kt):Ge();return void 0!==Ot&&Ot.close()});return function(Ot){return Mt.apply(this,arguments)}}(),we=function(){var Mt=(0,x.Z)(function*(Kt){const Ot=yield He(Kt);return!!Ot&&Ot.toggle()});return function(Ot){return Mt.apply(this,arguments)}}(),ze=function(){var Mt=(0,x.Z)(function*(Kt,Ot){const Ft=yield He(Ot);return Ft&&(Ft.disabled=!Kt),Ft});return function(Ot,Ft){return Mt.apply(this,arguments)}}(),Ne=function(){var Mt=(0,x.Z)(function*(Kt,Ot){const Ft=yield He(Ot);return Ft&&(Ft.swipeGesture=Kt),Ft});return function(Ot,Ft){return Mt.apply(this,arguments)}}(),Ae=function(){var Mt=(0,x.Z)(function*(Kt){if(null!=Kt){const Ot=yield He(Kt);return void 0!==Ot&&Ot.isOpen()}return void 0!==(yield Ge())});return function(Ot){return Mt.apply(this,arguments)}}(),Te=function(){var Mt=(0,x.Z)(function*(Kt){const Ot=yield He(Kt);return!!Ot&&!Ot.disabled});return function(Ot){return Mt.apply(this,arguments)}}(),He=function(){var Mt=(0,x.Z)(function*(Kt){return yield Bt(),"start"===Kt||"end"===Kt?Nt(ln=>ln.side===Kt&&!ln.disabled)||Nt(ln=>ln.side===Kt):null!=Kt?Nt(Ft=>Ft.menuId===Kt):Nt(Ft=>!Ft.disabled)||(ce.length>0?ce[0].el:void 0)});return function(Ot){return Mt.apply(this,arguments)}}(),Ge=function(){var Mt=(0,x.Z)(function*(){return yield Bt(),St()});return function(){return Mt.apply(this,arguments)}}(),Fe=function(){var Mt=(0,x.Z)(function*(){return yield Bt(),Vt()});return function(){return Mt.apply(this,arguments)}}(),E=function(){var Mt=(0,x.Z)(function*(){return yield Bt(),bn()});return function(){return Mt.apply(this,arguments)}}(),Qe=(Mt,Kt)=>{ne.set(Mt,Kt)},gt=Mt=>{const Kt=Mt.side;ce.filter(Ot=>Ot.side===Kt&&Ot!==Mt).forEach(Ot=>Ot.disabled=!0)},bt=function(){var Mt=(0,x.Z)(function*(Kt,Ot,Ft){if(bn())return!1;if(Ot){const ln=yield Ge();ln&&Kt.el!==ln&&(yield ln.setOpen(!1,!1))}return Kt._setOpen(Ot,Ft)});return function(Ot,Ft,ln){return Mt.apply(this,arguments)}}(),St=()=>Nt(Mt=>Mt._isOpen),Vt=()=>ce.map(Mt=>Mt.el),bn=()=>ce.some(Mt=>Mt.isAnimating),Nt=Mt=>{const Kt=ce.find(Mt);if(void 0!==Kt)return Kt.el},Bt=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(Mt=>new Promise(Kt=>(0,Y.c)(Mt,Kt))));return Qe("reveal",te),Qe("push",H),Qe("overlay",f),"undefined"!=typeof document&&document.addEventListener("ionBackButton",Mt=>{const Kt=St();Kt&&Mt.detail.register(d.MENU_BACK_BUTTON_PRIORITY,()=>Kt.close())}),{registerAnimation:Qe,get:He,getMenus:Fe,getOpen:Ge,isEnabled:Te,swipeGesture:Ne,isAnimating:E,isOpen:Ae,enable:ze,toggle:we,close:ve,open:me,_getOpenSync:St,_createAnimation:(Mt,Kt)=>{const Ot=ne.get(Mt);if(!Ot)throw new Error("animation not registered");return Ot(Kt)},_register:Mt=>{ce.indexOf(Mt)<0&&(Mt.disabled||gt(Mt),ce.push(Mt))},_unregister:Mt=>{const Kt=ce.indexOf(Mt);Kt>-1&&ce.splice(Kt,1)},_setOpen:bt,_setActiveMenu:gt}})()},4743:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{GESTURE_CONTROLLER:()=>x.G,createGesture:()=>te});var x=N(5042);const d=(ce,me,ve,we)=>{const ze=Y(ce)?{capture:!!we.capture,passive:!!we.passive}:!!we.capture;let Ne,Ae;return ce.__zone_symbol__addEventListener?(Ne="__zone_symbol__addEventListener",Ae="__zone_symbol__removeEventListener"):(Ne="addEventListener",Ae="removeEventListener"),ce[Ne](me,ve,ze),()=>{ce[Ae](me,ve,ze)}},Y=ce=>{if(void 0===l)try{const me=Object.defineProperty({},"passive",{get:()=>{l=!0}});ce.addEventListener("optsTest",()=>{},me)}catch{l=!1}return!!l};let l;const f=ce=>ce instanceof Document?ce:ce.ownerDocument,te=ce=>{let me=!1,ve=!1,we=!0,ze=!1;const Ne=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},ce),Ae=Ne.canStart,Te=Ne.onWillStart,He=Ne.onStart,Ge=Ne.onEnd,Fe=Ne.notCaptured,E=Ne.onMove,Qe=Ne.threshold,et=Ne.passive,ct=Ne.blurOnStart,gt={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},bt=((ce,me,ve)=>{const we=ve*(Math.PI/180),ze="x"===ce,Ne=Math.cos(we),Ae=me*me;let Te=0,He=0,Ge=!1,Fe=0;return{start(E,Qe){Te=E,He=Qe,Fe=0,Ge=!0},detect(E,Qe){if(!Ge)return!1;const et=E-Te,ct=Qe-He,gt=et*et+ct*ct;if(gt<Ae)return!1;const bt=Math.sqrt(gt),ut=(ze?et:ct)/bt;return Fe=ut>Ne?1:ut<-Ne?-1:0,Ge=!1,!0},isGesture:()=>0!==Fe,getDirection:()=>Fe}})(Ne.direction,Ne.threshold,Ne.maxAngle),ut=x.G.createGesture({name:ce.gestureName,priority:ce.gesturePriority,disableScroll:ce.disableScroll}),bn=()=>{!me||(ze=!1,E&&E(gt))},Nt=()=>!(ut&&!ut.capture()||(me=!0,we=!1,gt.startX=gt.currentX,gt.startY=gt.currentY,gt.startTime=gt.currentTime,Te?Te(gt).then(Mt):Mt(),0)),Mt=()=>{ct&&(()=>{if("undefined"!=typeof document){const nn=document.activeElement;null!==nn&&nn.blur&&nn.blur()}})(),He&&He(gt),we=!0},Kt=()=>{me=!1,ve=!1,ze=!1,we=!0,ut.release()},Ot=nn=>{const tn=me,en=we;if(Kt(),en){if(K(gt,nn),tn)return void(Ge&&Ge(gt));Fe&&Fe(gt)}},Ft=((ce,me,ve,we,ze)=>{let Ne,Ae,Te,He,Ge,Fe,E,Qe=0;const et=Bt=>{Qe=Date.now()+2e3,me(Bt)&&(!Ae&&ve&&(Ae=d(ce,"touchmove",ve,ze)),Te||(Te=d(Bt.target,"touchend",gt,ze)),He||(He=d(Bt.target,"touchcancel",gt,ze)))},ct=Bt=>{Qe>Date.now()||!me(Bt)||(!Fe&&ve&&(Fe=d(f(ce),"mousemove",ve,ze)),E||(E=d(f(ce),"mouseup",bt,ze)))},gt=Bt=>{ut(),we&&we(Bt)},bt=Bt=>{St(),we&&we(Bt)},ut=()=>{Ae&&Ae(),Te&&Te(),He&&He(),Ae=Te=He=void 0},St=()=>{Fe&&Fe(),E&&E(),Fe=E=void 0},Vt=()=>{ut(),St()},bn=(Bt=!0)=>{Bt?(Ne||(Ne=d(ce,"touchstart",et,ze)),Ge||(Ge=d(ce,"mousedown",ct,ze))):(Ne&&Ne(),Ge&&Ge(),Ne=Ge=void 0,Vt())};return{enable:bn,stop:Vt,destroy:()=>{bn(!1),we=ve=me=void 0}}})(Ne.el,nn=>{const tn=ne(nn);return!(ve||!we||(G(nn,gt),gt.startX=gt.currentX,gt.startY=gt.currentY,gt.startTime=gt.currentTime=tn,gt.velocityX=gt.velocityY=gt.deltaX=gt.deltaY=0,gt.event=nn,Ae&&!1===Ae(gt))||(ut.release(),!ut.start()))&&(ve=!0,0===Qe?Nt():(bt.start(gt.startX,gt.startY),!0))},nn=>{me?!ze&&we&&(ze=!0,K(gt,nn),requestAnimationFrame(bn)):(K(gt,nn),bt.detect(gt.currentX,gt.currentY)&&(!bt.isGesture()||!Nt())&&ln())},Ot,{capture:!1,passive:et}),ln=()=>{Kt(),Ft.stop(),Fe&&Fe(gt)};return{enable(nn=!0){nn||(me&&Ot(void 0),Kt()),Ft.enable(nn)},destroy(){ut.destroy(),Ft.destroy()}}},K=(ce,me)=>{if(!me)return;const ve=ce.currentX,we=ce.currentY,ze=ce.currentTime;G(me,ce);const Ne=ce.currentX,Ae=ce.currentY,He=(ce.currentTime=ne(me))-ze;if(He>0&&He<100){const Fe=(Ae-we)/He;ce.velocityX=(Ne-ve)/He*.7+.3*ce.velocityX,ce.velocityY=.7*Fe+.3*ce.velocityY}ce.deltaX=Ne-ce.startX,ce.deltaY=Ae-ce.startY,ce.event=me},G=(ce,me)=>{let ve=0,we=0;if(ce){const ze=ce.changedTouches;if(ze&&ze.length>0){const Ne=ze[0];ve=Ne.clientX,we=Ne.clientY}else void 0!==ce.pageX&&(ve=ce.pageX,we=ce.pageY)}me.currentX=ve,me.currentY=we},ne=ce=>ce.timeStamp||Date.now()},5221:(yn,je,N)=>{"use strict";N.d(je,{B:()=>_r,C:()=>ne,H:()=>mi,a:()=>we,b:()=>Qn,c:()=>Nr,e:()=>Ti,f:()=>Ir,g:()=>nn,h:()=>kn,i:()=>Fi,j:()=>re,k:()=>ei,p:()=>me,r:()=>oi,s:()=>ln,w:()=>G});var x=N(4553);let Y,l,P,O=!1,f=!1,H=!1,te=!1,K=!1;const G="undefined"!=typeof window?window:{},ne=G.CSS,ce=G.document||{head:{}},me={$flags$:0,$resourcesUrl$:"",jmp:Ee=>Ee(),raf:Ee=>requestAnimationFrame(Ee),ael:(Ee,xe,Le,Ke)=>Ee.addEventListener(xe,Le,Ke),rel:(Ee,xe,Le,Ke)=>Ee.removeEventListener(xe,Le,Ke),ce:(Ee,xe)=>new CustomEvent(Ee,xe)},ve=(()=>(ce.head.attachShadow+"").indexOf("[native")>-1)(),we=Ee=>Promise.resolve(Ee),ze=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replace}catch{}return!1})(),Ne=(Ee,xe,Le,Ke)=>{Le&&Le.map(([$t,Et,Qt])=>{const mn=Te(Ee,$t),hn=Ae(xe,Qt),fn=He($t);me.ael(mn,Et,hn,fn),(xe.$rmListeners$=xe.$rmListeners$||[]).push(()=>me.rel(mn,Et,hn,fn))})},Ae=(Ee,xe)=>Le=>{try{256&Ee.$flags$?Ee.$lazyInstance$[xe](Le):(Ee.$queuedListeners$=Ee.$queuedListeners$||[]).push([xe,Le])}catch(Ke){Zn(Ke)}},Te=(Ee,xe)=>4&xe?ce:8&xe?G:16&xe?ce.body:Ee,He=Ee=>0!=(2&Ee),et="s-id",ct="sty-id",ut="http://www.w3.org/1999/xlink",bn=new WeakMap,Nt=(Ee,xe,Le)=>{let Ke=Ci.get(Ee);ze&&Le?(Ke=Ke||new CSSStyleSheet,Ke.replace(xe)):Ke=xe,Ci.set(Ee,Ke)},Bt=(Ee,xe,Le,Ke)=>{let $t=Kt(xe,Le),Et=Ci.get($t);if(Ee=11===Ee.nodeType?Ee:ce,Et)if("string"==typeof Et){let mn,Qt=bn.get(Ee=Ee.head||Ee);if(Qt||bn.set(Ee,Qt=new Set),!Qt.has($t)){if(Ee.host&&(mn=Ee.querySelector(`[${ct}="${$t}"]`)))mn.innerHTML=Et;else{if(me.$cssShim$){mn=me.$cssShim$.createHostStyle(Ke,$t,Et,!!(10&xe.$flags$));const hn=mn["s-sc"];hn&&($t=hn,Qt=null)}else mn=ce.createElement("style"),mn.innerHTML=Et;Ee.insertBefore(mn,Ee.querySelector("link"))}Qt&&Qt.add($t)}}else Ee.adoptedStyleSheets.includes(Et)||(Ee.adoptedStyleSheets=[...Ee.adoptedStyleSheets,Et]);return $t},Kt=(Ee,xe)=>"sc-"+(xe&&32&Ee.$flags$?Ee.$tagName$+"-"+xe:Ee.$tagName$),Ot=Ee=>Ee.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),ln=Ee=>ui.push(Ee),nn=Ee=>Yn(Ee).$modeName$,tn={},cn=Ee=>"object"==(Ee=typeof Ee)||"function"===Ee,kn=(Ee,xe,...Le)=>{let Ke=null,$t=null,Et=null,Qt=!1,mn=!1,hn=[];const fn=Fn=>{for(let pi=0;pi<Fn.length;pi++)Ke=Fn[pi],Array.isArray(Ke)?fn(Ke):null!=Ke&&"boolean"!=typeof Ke&&((Qt="function"!=typeof Ee&&!cn(Ke))&&(Ke=String(Ke)),Qt&&mn?hn[hn.length-1].$text$+=Ke:hn.push(Qt?An(null,Ke):Ke),mn=Qt)};if(fn(Le),xe){xe.key&&($t=xe.key),xe.name&&(Et=xe.name);{const Fn=xe.className||xe.class;Fn&&(xe.class="object"!=typeof Fn?Fn:Object.keys(Fn).filter(pi=>Fn[pi]).join(" "))}}if("function"==typeof Ee)return Ee(null===xe?{}:xe,hn,Ki);const Vn=An(Ee,null);return Vn.$attrs$=xe,hn.length>0&&(Vn.$children$=hn),Vn.$key$=$t,Vn.$name$=Et,Vn},An=(Ee,xe)=>({$flags$:0,$tag$:Ee,$text$:xe,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),mi={},Ki={forEach:(Ee,xe)=>Ee.map(xi).forEach(xe),map:(Ee,xe)=>Ee.map(xi).map(xe).map(Wi)},xi=Ee=>({vattrs:Ee.$attrs$,vchildren:Ee.$children$,vkey:Ee.$key$,vname:Ee.$name$,vtag:Ee.$tag$,vtext:Ee.$text$}),Wi=Ee=>{if("function"==typeof Ee.vtag){const Le=Object.assign({},Ee.vattrs);return Ee.vkey&&(Le.key=Ee.vkey),Ee.vname&&(Le.name=Ee.vname),kn(Ee.vtag,Le,...Ee.vchildren||[])}const xe=An(Ee.vtag,Ee.vtext);return xe.$attrs$=Ee.vattrs,xe.$children$=Ee.vchildren,xe.$key$=Ee.vkey,xe.$name$=Ee.vname,xe},Vi=(Ee,xe,Le,Ke,$t,Et)=>{if(Le!==Ke){let Qt=zt(Ee,xe),mn=xe.toLowerCase();if("class"===xe){const hn=Ee.classList,fn=bi(Le),Vn=bi(Ke);hn.remove(...fn.filter(Fn=>Fn&&!Vn.includes(Fn))),hn.add(...Vn.filter(Fn=>Fn&&!fn.includes(Fn)))}else if("style"===xe){for(const hn in Le)(!Ke||null==Ke[hn])&&(hn.includes("-")?Ee.style.removeProperty(hn):Ee.style[hn]="");for(const hn in Ke)(!Le||Ke[hn]!==Le[hn])&&(hn.includes("-")?Ee.style.setProperty(hn,Ke[hn]):Ee.style[hn]=Ke[hn])}else if("key"!==xe)if("ref"===xe)Ke&&Ke(Ee);else if(Qt||"o"!==xe[0]||"n"!==xe[1]){const hn=cn(Ke);if((Qt||hn&&null!==Ke)&&!$t)try{if(Ee.tagName.includes("-"))Ee[xe]=Ke;else{let Vn=Ke??"";"list"===xe?Qt=!1:(null==Le||Ee[xe]!=Vn)&&(Ee[xe]=Vn)}}catch{}let fn=!1;mn!==(mn=mn.replace(/^xlink\:?/,""))&&(xe=mn,fn=!0),null==Ke||!1===Ke?(!1!==Ke||""===Ee.getAttribute(xe))&&(fn?Ee.removeAttributeNS(ut,xe):Ee.removeAttribute(xe)):(!Qt||4&Et||$t)&&!hn&&(Ke=!0===Ke?"":Ke,fn?Ee.setAttributeNS(ut,xe,Ke):Ee.setAttribute(xe,Ke))}else xe="-"===xe[2]?xe.slice(3):zt(G,mn)?mn.slice(2):mn[2]+xe.slice(3),Le&&me.rel(Ee,xe,Le,!1),Ke&&me.ael(Ee,xe,Ke,!1)}},_i=/\s/,bi=Ee=>Ee?Ee.split(_i):[],xn=(Ee,xe,Le,Ke)=>{const $t=11===xe.$elm$.nodeType&&xe.$elm$.host?xe.$elm$.host:xe.$elm$,Et=Ee&&Ee.$attrs$||tn,Qt=xe.$attrs$||tn;for(Ke in Et)Ke in Qt||Vi($t,Ke,Et[Ke],void 0,Le,xe.$flags$);for(Ke in Qt)Vi($t,Ke,Et[Ke],Qt[Ke],Le,xe.$flags$)},rn=(Ee,xe,Le,Ke)=>{let Qt,mn,hn,$t=xe.$children$[Le],Et=0;if(O||(H=!0,"slot"===$t.$tag$&&(Y&&Ke.classList.add(Y+"-s"),$t.$flags$|=$t.$children$?2:1)),null!==$t.$text$)Qt=$t.$elm$=ce.createTextNode($t.$text$);else if(1&$t.$flags$)Qt=$t.$elm$=ce.createTextNode("");else{if(te||(te="svg"===$t.$tag$),Qt=$t.$elm$=ce.createElementNS(te?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&$t.$flags$?"slot-fb":$t.$tag$),te&&"foreignObject"===$t.$tag$&&(te=!1),xn(null,$t,te),(Ee=>null!=Ee)(Y)&&Qt["s-si"]!==Y&&Qt.classList.add(Qt["s-si"]=Y),$t.$children$)for(Et=0;Et<$t.$children$.length;++Et)mn=rn(Ee,$t,Et,Qt),mn&&Qt.appendChild(mn);"svg"===$t.$tag$?te=!1:"foreignObject"===Qt.tagName&&(te=!0)}return Qt["s-hn"]=P,3&$t.$flags$&&(Qt["s-sr"]=!0,Qt["s-cr"]=l,Qt["s-sn"]=$t.$name$||"",hn=Ee&&Ee.$children$&&Ee.$children$[Le],hn&&hn.$tag$===$t.$tag$&&Ee.$elm$&&ot(Ee.$elm$,!1)),Qt},ot=(Ee,xe)=>{me.$flags$|=1;const Le=Ee.childNodes;for(let Ke=Le.length-1;Ke>=0;Ke--){const $t=Le[Ke];$t["s-hn"]!==P&&$t["s-ol"]&&(ye($t).insertBefore($t,j($t)),$t["s-ol"].remove(),$t["s-ol"]=void 0,H=!0),xe&&ot($t,xe)}me.$flags$&=-2},ft=(Ee,xe,Le,Ke,$t,Et)=>{let mn,Qt=Ee["s-cr"]&&Ee["s-cr"].parentNode||Ee;for(Qt.shadowRoot&&Qt.tagName===P&&(Qt=Qt.shadowRoot);$t<=Et;++$t)Ke[$t]&&(mn=rn(null,Le,$t,Ee),mn&&(Ke[$t].$elm$=mn,Qt.insertBefore(mn,j(xe))))},pn=(Ee,xe,Le,Ke,$t)=>{for(;xe<=Le;++xe)(Ke=Ee[xe])&&($t=Ke.$elm$,ai(Ke),f=!0,$t["s-ol"]?$t["s-ol"].remove():ot($t,!0),$t.remove())},Ye=(Ee,xe)=>Ee.$tag$===xe.$tag$&&("slot"===Ee.$tag$?Ee.$name$===xe.$name$:Ee.$key$===xe.$key$),j=Ee=>Ee&&Ee["s-ol"]||Ee,ye=Ee=>(Ee["s-ol"]?Ee["s-ol"]:Ee).parentNode,We=(Ee,xe)=>{const Le=xe.$elm$=Ee.$elm$,Ke=Ee.$children$,$t=xe.$children$,Et=xe.$tag$,Qt=xe.$text$;let mn;null===Qt?(te="svg"===Et||"foreignObject"!==Et&&te,"slot"===Et||xn(Ee,xe,te),null!==Ke&&null!==$t?((Ee,xe,Le,Ke)=>{let ji,Sr,$t=0,Et=0,Qt=0,mn=0,hn=xe.length-1,fn=xe[0],Vn=xe[hn],Fn=Ke.length-1,pi=Ke[0],vi=Ke[Fn];for(;$t<=hn&&Et<=Fn;)if(null==fn)fn=xe[++$t];else if(null==Vn)Vn=xe[--hn];else if(null==pi)pi=Ke[++Et];else if(null==vi)vi=Ke[--Fn];else if(Ye(fn,pi))We(fn,pi),fn=xe[++$t],pi=Ke[++Et];else if(Ye(Vn,vi))We(Vn,vi),Vn=xe[--hn],vi=Ke[--Fn];else if(Ye(fn,vi))("slot"===fn.$tag$||"slot"===vi.$tag$)&&ot(fn.$elm$.parentNode,!1),We(fn,vi),Ee.insertBefore(fn.$elm$,Vn.$elm$.nextSibling),fn=xe[++$t],vi=Ke[--Fn];else if(Ye(Vn,pi))("slot"===fn.$tag$||"slot"===vi.$tag$)&&ot(Vn.$elm$.parentNode,!1),We(Vn,pi),Ee.insertBefore(Vn.$elm$,fn.$elm$),Vn=xe[--hn],pi=Ke[++Et];else{for(Qt=-1,mn=$t;mn<=hn;++mn)if(xe[mn]&&null!==xe[mn].$key$&&xe[mn].$key$===pi.$key$){Qt=mn;break}Qt>=0?(Sr=xe[Qt],Sr.$tag$!==pi.$tag$?ji=rn(xe&&xe[Et],Le,Qt,Ee):(We(Sr,pi),xe[Qt]=void 0,ji=Sr.$elm$),pi=Ke[++Et]):(ji=rn(xe&&xe[Et],Le,Et,Ee),pi=Ke[++Et]),ji&&ye(fn.$elm$).insertBefore(ji,j(fn.$elm$))}$t>hn?ft(Ee,null==Ke[Fn+1]?null:Ke[Fn+1].$elm$,Le,Ke,Et,Fn):Et>Fn&&pn(xe,$t,hn)})(Le,Ke,xe,$t):null!==$t?(null!==Ee.$text$&&(Le.textContent=""),ft(Le,null,xe,$t,0,$t.length-1)):null!==Ke&&pn(Ke,0,Ke.length-1),te&&"svg"===Et&&(te=!1)):(mn=Le["s-cr"])?mn.parentNode.textContent=Qt:Ee.$text$!==Qt&&(Le.data=Qt)},Tt=Ee=>{let Le,Ke,$t,Et,Qt,mn,xe=Ee.childNodes;for(Ke=0,$t=xe.length;Ke<$t;Ke++)if(Le=xe[Ke],1===Le.nodeType){if(Le["s-sr"])for(Qt=Le["s-sn"],Le.hidden=!1,Et=0;Et<$t;Et++)if(mn=xe[Et].nodeType,xe[Et]["s-hn"]!==Le["s-hn"]||""!==Qt){if(1===mn&&Qt===xe[Et].getAttribute("slot")){Le.hidden=!0;break}}else if(1===mn||3===mn&&""!==xe[Et].textContent.trim()){Le.hidden=!0;break}Tt(Le)}},on=[],qn=Ee=>{let xe,Le,Ke,$t,Et,Qt,mn=0,hn=Ee.childNodes,fn=hn.length;for(;mn<fn;mn++){if(xe=hn[mn],xe["s-sr"]&&(Le=xe["s-cr"])&&Le.parentNode)for(Ke=Le.parentNode.childNodes,$t=xe["s-sn"],Qt=Ke.length-1;Qt>=0;Qt--)Le=Ke[Qt],!Le["s-cn"]&&!Le["s-nr"]&&Le["s-hn"]!==xe["s-hn"]&&(ci(Le,$t)?(Et=on.find(Vn=>Vn.$nodeToRelocate$===Le),f=!0,Le["s-sn"]=Le["s-sn"]||$t,Et?Et.$slotRefNode$=xe:on.push({$slotRefNode$:xe,$nodeToRelocate$:Le}),Le["s-sr"]&&on.map(Vn=>{ci(Vn.$nodeToRelocate$,Le["s-sn"])&&(Et=on.find(Fn=>Fn.$nodeToRelocate$===Le),Et&&!Vn.$slotRefNode$&&(Vn.$slotRefNode$=Et.$slotRefNode$))})):on.some(Vn=>Vn.$nodeToRelocate$===Le)||on.push({$nodeToRelocate$:Le}));1===xe.nodeType&&qn(xe)}},ci=(Ee,xe)=>1===Ee.nodeType?null===Ee.getAttribute("slot")&&""===xe||Ee.getAttribute("slot")===xe:Ee["s-sn"]===xe||""===xe,ai=Ee=>{Ee.$attrs$&&Ee.$attrs$.ref&&Ee.$attrs$.ref(null),Ee.$children$&&Ee.$children$.map(ai)},Fi=Ee=>Yn(Ee).$hostElement$,Ti=(Ee,xe,Le)=>{const Ke=Fi(Ee);return{emit:$t=>Yi(Ke,xe,{bubbles:!!(4&Le),composed:!!(2&Le),cancelable:!!(1&Le),detail:$t})}},Yi=(Ee,xe,Le)=>{const Ke=me.ce(xe,Le);return Ee.dispatchEvent(Ke),Ke},br=(Ee,xe)=>{xe&&!Ee.$onRenderResolve$&&xe["s-p"]&&xe["s-p"].push(new Promise(Le=>Ee.$onRenderResolve$=Le))},Ei=(Ee,xe)=>{if(Ee.$flags$|=16,!(4&Ee.$flags$))return br(Ee,Ee.$ancestorComponent$),Nr(()=>wr(Ee,xe));Ee.$flags$|=512},wr=(Ee,xe)=>{const Ke=Ee.$lazyInstance$;let $t;return xe&&(Ee.$flags$|=256,Ee.$queuedListeners$&&(Ee.$queuedListeners$.map(([Et,Qt])=>V(Ke,Et,Qt)),Ee.$queuedListeners$=null),$t=V(Ke,"componentWillLoad")),$t=pe($t,()=>V(Ke,"componentWillRender")),pe($t,()=>mr(Ee,Ke,xe))},mr=function(){var Ee=(0,x.Z)(function*(xe,Le,Ke){const $t=xe.$hostElement$,Qt=$t["s-rc"];Ke&&(Ee=>{const xe=Ee.$cmpMeta$,Le=Ee.$hostElement$,Ke=xe.$flags$,Et=Bt(ve&&Le.shadowRoot?Le.shadowRoot:Le.getRootNode(),xe,Ee.$modeName$,Le);10&Ke&&(Le["s-sc"]=Et,Le.classList.add(Et+"-h"),2&Ke&&Le.classList.add(Et+"-s"))})(xe);Ji(xe,Le),me.$cssShim$&&me.$cssShim$.updateHost($t),Qt&&(Qt.map(hn=>hn()),$t["s-rc"]=void 0);{const hn=$t["s-p"],fn=()=>hi(xe);0===hn.length?fn():(Promise.all(hn).then(fn),xe.$flags$|=4,hn.length=0)}});return function(Le,Ke,$t){return Ee.apply(this,arguments)}}(),Ji=(Ee,xe,Le)=>{try{xe=xe.render&&xe.render(),Ee.$flags$&=-17,Ee.$flags$|=2,((Ee,xe)=>{const Le=Ee.$hostElement$,Ke=Ee.$cmpMeta$,$t=Ee.$vnode$||An(null,null),Et=(Ee=>Ee&&Ee.$tag$===mi)(xe)?xe:kn(null,null,xe);if(P=Le.tagName,Ke.$attrsToReflect$&&(Et.$attrs$=Et.$attrs$||{},Ke.$attrsToReflect$.map(([Qt,mn])=>Et.$attrs$[mn]=Le[Qt])),Et.$tag$=null,Et.$flags$|=4,Ee.$vnode$=Et,Et.$elm$=$t.$elm$=Le.shadowRoot||Le,Y=Le["s-sc"],l=Le["s-cr"],O=ve&&0!=(1&Ke.$flags$),f=!1,We($t,Et),me.$flags$|=1,H){qn(Et.$elm$);let Qt,mn,hn,fn,Vn,Fn,pi=0;for(;pi<on.length;pi++)Qt=on[pi],mn=Qt.$nodeToRelocate$,mn["s-ol"]||(hn=ce.createTextNode(""),hn["s-nr"]=mn,mn.parentNode.insertBefore(mn["s-ol"]=hn,mn));for(pi=0;pi<on.length;pi++)if(Qt=on[pi],mn=Qt.$nodeToRelocate$,Qt.$slotRefNode$){for(fn=Qt.$slotRefNode$.parentNode,Vn=Qt.$slotRefNode$.nextSibling,hn=mn["s-ol"];hn=hn.previousSibling;)if(Fn=hn["s-nr"],Fn&&Fn["s-sn"]===mn["s-sn"]&&fn===Fn.parentNode&&(Fn=Fn.nextSibling,!Fn||!Fn["s-nr"])){Vn=Fn;break}(!Vn&&fn!==mn.parentNode||mn.nextSibling!==Vn)&&mn!==Vn&&(!mn["s-hn"]&&mn["s-ol"]&&(mn["s-hn"]=mn["s-ol"].parentNode.nodeName),fn.insertBefore(mn,Vn))}else 1===mn.nodeType&&(mn.hidden=!0)}f&&Tt(Et.$elm$),me.$flags$&=-2,on.length=0})(Ee,xe)}catch(Ke){Zn(Ke,Ee.$hostElement$)}return null},hi=Ee=>{const Le=Ee.$hostElement$,$t=Ee.$lazyInstance$,Et=Ee.$ancestorComponent$;64&Ee.$flags$?V($t,"componentDidUpdate"):(Ee.$flags$|=64,De(Le),V($t,"componentDidLoad"),Ee.$onReadyResolve$(Le),Et||ie()),Ee.$onInstanceResolve$(Le),Ee.$onRenderResolve$&&(Ee.$onRenderResolve$(),Ee.$onRenderResolve$=void 0),512&Ee.$flags$&&Fr(()=>Ei(Ee,!1)),Ee.$flags$&=-517},re=Ee=>{{const xe=Yn(Ee),Le=xe.$hostElement$.isConnected;return Le&&2==(18&xe.$flags$)&&Ei(xe,!1),Le}},ie=Ee=>{De(ce.documentElement),Fr(()=>Yi(G,"appload",{detail:{namespace:"ionic"}}))},V=(Ee,xe,Le)=>{if(Ee&&Ee[xe])try{return Ee[xe](Le)}catch(Ke){Zn(Ke)}},pe=(Ee,xe)=>Ee&&Ee.then?Ee.then(xe):xe(),De=Ee=>Ee.classList.add("hydrated"),vt=(Ee,xe,Le,Ke,$t,Et,Qt)=>{let mn,hn,fn,Vn;if(1===Et.nodeType){for(mn=Et.getAttribute("c-id"),mn&&(hn=mn.split("."),(hn[0]===Qt||"0"===hn[0])&&(fn={$flags$:0,$hostId$:hn[0],$nodeId$:hn[1],$depth$:hn[2],$index$:hn[3],$tag$:Et.tagName.toLowerCase(),$elm$:Et,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},xe.push(fn),Et.removeAttribute("c-id"),Ee.$children$||(Ee.$children$=[]),Ee.$children$[fn.$index$]=fn,Ee=fn,Ke&&"0"===fn.$depth$&&(Ke[fn.$index$]=fn.$elm$))),Vn=Et.childNodes.length-1;Vn>=0;Vn--)vt(Ee,xe,Le,Ke,$t,Et.childNodes[Vn],Qt);if(Et.shadowRoot)for(Vn=Et.shadowRoot.childNodes.length-1;Vn>=0;Vn--)vt(Ee,xe,Le,Ke,$t,Et.shadowRoot.childNodes[Vn],Qt)}else if(8===Et.nodeType)hn=Et.nodeValue.split("."),(hn[1]===Qt||"0"===hn[1])&&(mn=hn[0],fn={$flags$:0,$hostId$:hn[1],$nodeId$:hn[2],$depth$:hn[3],$index$:hn[4],$elm$:Et,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===mn?(fn.$elm$=Et.nextSibling,fn.$elm$&&3===fn.$elm$.nodeType&&(fn.$text$=fn.$elm$.textContent,xe.push(fn),Et.remove(),Ee.$children$||(Ee.$children$=[]),Ee.$children$[fn.$index$]=fn,Ke&&"0"===fn.$depth$&&(Ke[fn.$index$]=fn.$elm$))):fn.$hostId$===Qt&&("s"===mn?(fn.$tag$="slot",Et["s-sn"]=hn[5]?fn.$name$=hn[5]:"",Et["s-sr"]=!0,Ke&&(fn.$elm$=ce.createElement(fn.$tag$),fn.$name$&&fn.$elm$.setAttribute("name",fn.$name$),Et.parentNode.insertBefore(fn.$elm$,Et),Et.remove(),"0"===fn.$depth$&&(Ke[fn.$index$]=fn.$elm$)),Le.push(fn),Ee.$children$||(Ee.$children$=[]),Ee.$children$[fn.$index$]=fn):"r"===mn&&(Ke?Et.remove():($t["s-cr"]=Et,Et["s-cn"]=!0))));else if(Ee&&"style"===Ee.$tag$){const Fn=An(null,Et.textContent);Fn.$elm$=Et,Fn.$index$="0",Ee.$children$=[Fn]}},Ct=(Ee,xe)=>{if(1===Ee.nodeType){let Le=0;for(;Le<Ee.childNodes.length;Le++)Ct(Ee.childNodes[Le],xe);if(Ee.shadowRoot)for(Le=0;Le<Ee.shadowRoot.childNodes.length;Le++)Ct(Ee.shadowRoot.childNodes[Le],xe)}else if(8===Ee.nodeType){const Le=Ee.nodeValue.split(".");"o"===Le[0]&&(xe.set(Le[1]+"."+Le[2],Ee),Ee.nodeValue="",Ee["s-en"]=Le[3])}},Zt=(Ee,xe,Le)=>{if(xe.$members$){Ee.watchers&&(xe.$watchers$=Ee.watchers);const Ke=Object.entries(xe.$members$),$t=Ee.prototype;if(Ke.map(([Et,[Qt]])=>{31&Qt||2&Le&&32&Qt?Object.defineProperty($t,Et,{get(){return((Ee,xe)=>Yn(this).$instanceValues$.get(xe))(0,Et)},set(mn){((Ee,xe,Le,Ke)=>{const $t=Yn(Ee),Et=$t.$hostElement$,Qt=$t.$instanceValues$.get(xe),mn=$t.$flags$,hn=$t.$lazyInstance$;if(Le=((Ee,xe)=>null==Ee||cn(Ee)?Ee:4&xe?"false"!==Ee&&(""===Ee||!!Ee):2&xe?parseFloat(Ee):1&xe?String(Ee):Ee)(Le,Ke.$members$[xe][0]),(!(8&mn)||void 0===Qt)&&Le!==Qt&&($t.$instanceValues$.set(xe,Le),hn)){if(Ke.$watchers$&&128&mn){const fn=Ke.$watchers$[xe];fn&&fn.map(Vn=>{try{hn[Vn](Le,Qt,xe)}catch(Fn){Zn(Fn,Et)}})}2==(18&mn)&&Ei($t,!1)}})(this,Et,mn,xe)},configurable:!0,enumerable:!0}):1&Le&&64&Qt&&Object.defineProperty($t,Et,{value(...mn){const hn=Yn(this);return hn.$onInstancePromise$.then(()=>hn.$lazyInstance$[Et](...mn))}})}),1&Le){const Et=new Map;$t.attributeChangedCallback=function(Qt,mn,hn){me.jmp(()=>{const fn=Et.get(Qt);this[fn]=(null!==hn||"boolean"!=typeof this[fn])&&hn})},Ee.observedAttributes=Ke.filter(([Qt,mn])=>15&mn[0]).map(([Qt,mn])=>{const hn=mn[1]||Qt;return Et.set(hn,Qt),512&mn[0]&&xe.$attrsToReflect$.push([Qt,hn]),hn})}}return Ee},un=function(){var Ee=(0,x.Z)(function*(xe,Le,Ke,$t,Et){if(0==(32&Le.$flags$)){{if(Le.$flags$|=32,(Et=li(Ke)).then){const fn=()=>{};Et=yield Et,fn()}Et.isProxied||(Ke.$watchers$=Et.watchers,Zt(Et,Ke,2),Et.isProxied=!0);const hn=()=>{};Le.$flags$|=8;try{new Et(Le)}catch(fn){Zn(fn)}Le.$flags$&=-9,Le.$flags$|=128,hn(),On(Le.$lazyInstance$)}if(Et.style){let hn=Et.style;"string"!=typeof hn&&(hn=hn[Le.$modeName$=(Ee=>ui.map(xe=>xe(Ee)).find(xe=>!!xe))(xe)]);const fn=Kt(Ke,Le.$modeName$);if(!Ci.has(fn)){const Vn=()=>{};8&Ke.$flags$&&(hn=yield N.e(3509).then(N.bind(N,3509)).then(Fn=>Fn.scopeCss(hn,fn,!1))),Nt(fn,hn,!!(1&Ke.$flags$)),Vn()}}}const Qt=Le.$ancestorComponent$,mn=()=>Ei(Le,!0);Qt&&Qt["s-rc"]?Qt["s-rc"].push(mn):mn()});return function(Le,Ke,$t,Et,Qt){return Ee.apply(this,arguments)}}(),On=Ee=>{V(Ee,"connectedCallback")},Yt=Ee=>{const xe=Ee["s-cr"]=ce.createComment("");xe["s-cn"]=!0,Ee.insertBefore(xe,Ee.firstChild)},Qn=(Ee,xe={})=>{const Ke=[],$t=xe.exclude||[],Et=G.customElements,Qt=ce.head,mn=Qt.querySelector("meta[charset]"),hn=ce.createElement("style"),fn=[],Vn=ce.querySelectorAll(`[${ct}]`);let Fn,pi=!0,vi=0;for(Object.assign(me,xe),me.$resourcesUrl$=new URL(xe.resourcesUrl||"./",ce.baseURI).href,me.$flags$|=2;vi<Vn.length;vi++)Nt(Vn[vi].getAttribute(ct),Ot(Vn[vi].innerHTML),!0);Ee.map(ji=>ji[1].map(Sr=>{const yr={$flags$:Sr[0],$tagName$:Sr[1],$members$:Sr[2],$listeners$:Sr[3]};yr.$members$=Sr[2],yr.$listeners$=Sr[3],yr.$attrsToReflect$=[],yr.$watchers$={},!ve&&1&yr.$flags$&&(yr.$flags$|=8);const qr=yr.$tagName$,ur=class extends HTMLElement{constructor(vo){super(vo),En(vo=this,yr),1&yr.$flags$&&(ve?vo.attachShadow({mode:"open",delegatesFocus:!!(16&yr.$flags$)}):"shadowRoot"in vo||(vo.shadowRoot=vo))}connectedCallback(){Fn&&(clearTimeout(Fn),Fn=null),pi?fn.push(this):me.jmp(()=>(Ee=>{if(0==(1&me.$flags$)){const xe=Yn(Ee),Le=xe.$cmpMeta$,Ke=()=>{};if(1&xe.$flags$)Ne(Ee,xe,Le.$listeners$),On(xe.$lazyInstance$);else{let $t;if(xe.$flags$|=1,$t=Ee.getAttribute(et),$t){if(ve&&1&Le.$flags$){const Et=Bt(Ee.shadowRoot,Le,Ee.getAttribute("s-mode"));Ee.classList.remove(Et+"-h",Et+"-s")}((Ee,xe,Le,Ke)=>{const Et=Ee.shadowRoot,Qt=[],hn=Et?[]:null,fn=Ke.$vnode$=An(xe,null);me.$orgLocNodes$||Ct(ce.body,me.$orgLocNodes$=new Map),Ee[et]=Le,Ee.removeAttribute(et),vt(fn,Qt,[],hn,Ee,Ee,Le),Qt.map(Vn=>{const Fn=Vn.$hostId$+"."+Vn.$nodeId$,pi=me.$orgLocNodes$.get(Fn),vi=Vn.$elm$;pi&&ve&&""===pi["s-en"]&&pi.parentNode.insertBefore(vi,pi.nextSibling),Et||(vi["s-hn"]=xe,pi&&(vi["s-ol"]=pi,vi["s-ol"]["s-nr"]=vi)),me.$orgLocNodes$.delete(Fn)}),Et&&hn.map(Vn=>{Vn&&Et.appendChild(Vn)})})(Ee,Le.$tagName$,$t,xe)}$t||12&Le.$flags$&&Yt(Ee);{let Et=Ee;for(;Et=Et.parentNode||Et.host;)if(1===Et.nodeType&&Et.hasAttribute("s-id")&&Et["s-p"]||Et["s-p"]){br(xe,xe.$ancestorComponent$=Et);break}}Le.$members$&&Object.entries(Le.$members$).map(([Et,[Qt]])=>{if(31&Qt&&Ee.hasOwnProperty(Et)){const mn=Ee[Et];delete Ee[Et],Ee[Et]=mn}}),Fr(()=>un(Ee,xe,Le))}Ke()}})(this))}disconnectedCallback(){me.jmp(()=>(Ee=>{if(0==(1&me.$flags$)){const xe=Yn(Ee),Le=xe.$lazyInstance$;xe.$rmListeners$&&(xe.$rmListeners$.map(Ke=>Ke()),xe.$rmListeners$=void 0),me.$cssShim$&&me.$cssShim$.removeHost(Ee),V(Le,"disconnectedCallback")}})(this))}componentOnReady(){return Yn(this).$onReadyPromise$}};yr.$lazyBundleId$=ji[0],!$t.includes(qr)&&!Et.get(qr)&&(Ke.push(qr),Et.define(qr,Zt(ur,yr,1)))})),hn.innerHTML=Ke+"{visibility:hidden}.hydrated{visibility:inherit}",hn.setAttribute("data-styles",""),Qt.insertBefore(hn,mn?mn.nextSibling:Qt.firstChild),pi=!1,fn.length?fn.map(ji=>ji.connectedCallback()):me.jmp(()=>Fn=setTimeout(ie,30))},ei=Ee=>{const xe=new URL(Ee,me.$resourcesUrl$);return xe.origin!==G.location.origin?xe.href:xe.pathname},yi=new WeakMap,Yn=Ee=>yi.get(Ee),oi=(Ee,xe)=>yi.set(xe.$lazyInstance$=Ee,xe),En=(Ee,xe)=>{const Le={$flags$:0,$hostElement$:Ee,$cmpMeta$:xe,$instanceValues$:new Map};return Le.$onInstancePromise$=new Promise(Ke=>Le.$onInstanceResolve$=Ke),Le.$onReadyPromise$=new Promise(Ke=>Le.$onReadyResolve$=Ke),Ee["s-p"]=[],Ee["s-rc"]=[],Ne(Ee,Le,xe.$listeners$),yi.set(Ee,Le)},zt=(Ee,xe)=>xe in Ee,Zn=(Ee,xe)=>(0,console.error)(Ee,xe),ti=new Map,li=(Ee,xe,Le)=>{const Ke=Ee.$tagName$.replace(/-/g,"_"),$t=Ee.$lazyBundleId$,Et=ti.get($t);return Et?Et[Ke]:N(863)(`./${$t}.entry.js`).then(Qt=>(ti.set($t,Qt),Qt[Ke]),Zn)},Ci=new Map,ui=[],Ii=[],to=[],Or=(Ee,xe)=>Le=>{Ee.push(Le),K||(K=!0,xe&&4&me.$flags$?Fr($i):me.raf($i))},jn=Ee=>{for(let xe=0;xe<Ee.length;xe++)try{Ee[xe](performance.now())}catch(Le){Zn(Le)}Ee.length=0},$i=()=>{jn(Ii),jn(to),(K=Ii.length>0)&&me.raf($i)},Fr=Ee=>we().then(Ee),Ir=Or(Ii,!1),Nr=Or(to,!0),_r={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1}},149:(yn,je,N)=>{"use strict";N.d(je,{L:()=>l,a:()=>P,b:()=>O,c:()=>f,d:()=>H,e:()=>Qe,g:()=>gt,l:()=>Fe,s:()=>et,t:()=>G});var x=N(4553),d=N(5221),Y=N(697);const l="ionViewWillEnter",P="ionViewDidEnter",O="ionViewWillLeave",f="ionViewDidLeave",H="ionViewWillUnload",G=bt=>new Promise((ut,St)=>{(0,d.c)(()=>{ne(bt),ce(bt).then(Vt=>{Vt.animation&&Vt.animation.destroy(),me(bt),ut(Vt)},Vt=>{me(bt),St(Vt)})})}),ne=bt=>{const ut=bt.enteringEl,St=bt.leavingEl;ct(ut,St,bt.direction),bt.showGoBack?ut.classList.add("can-go-back"):ut.classList.remove("can-go-back"),et(ut,!1),ut.style.setProperty("pointer-events","none"),St&&(et(St,!1),St.style.setProperty("pointer-events","none"))},ce=function(){var bt=(0,x.Z)(function*(ut){const St=yield ve(ut);return St&&d.B.isBrowser?we(St,ut):ze(ut)});return function(St){return bt.apply(this,arguments)}}(),me=bt=>{const ut=bt.enteringEl,St=bt.leavingEl;ut.classList.remove("ion-page-invisible"),ut.style.removeProperty("pointer-events"),void 0!==St&&(St.classList.remove("ion-page-invisible"),St.style.removeProperty("pointer-events"))},ve=function(){var bt=(0,x.Z)(function*(ut){return ut.leavingEl&&ut.animated&&0!==ut.duration?ut.animationBuilder?ut.animationBuilder:"ios"===ut.mode?(yield Promise.resolve().then(N.bind(N,8886))).iosTransitionAnimation:(yield Promise.resolve().then(N.bind(N,9258))).mdTransitionAnimation:void 0});return function(St){return bt.apply(this,arguments)}}(),we=function(){var bt=(0,x.Z)(function*(ut,St){yield Ne(St,!0);const Vt=ut(St.baseEl,St);He(St.enteringEl,St.leavingEl);const bn=yield Te(Vt,St);return St.progressCallback&&St.progressCallback(void 0),bn&&Ge(St.enteringEl,St.leavingEl),{hasCompleted:bn,animation:Vt}});return function(St,Vt){return bt.apply(this,arguments)}}(),ze=function(){var bt=(0,x.Z)(function*(ut){const St=ut.enteringEl,Vt=ut.leavingEl;return yield Ne(ut,!1),He(St,Vt),Ge(St,Vt),{hasCompleted:!0}});return function(St){return bt.apply(this,arguments)}}(),Ne=function(){var bt=(0,x.Z)(function*(ut,St){const bn=(void 0!==ut.deepWait?ut.deepWait:St)?[Qe(ut.enteringEl),Qe(ut.leavingEl)]:[E(ut.enteringEl),E(ut.leavingEl)];yield Promise.all(bn),yield Ae(ut.viewIsReady,ut.enteringEl)});return function(St,Vt){return bt.apply(this,arguments)}}(),Ae=function(){var bt=(0,x.Z)(function*(ut,St){ut&&(yield ut(St))});return function(St,Vt){return bt.apply(this,arguments)}}(),Te=(bt,ut)=>{const St=ut.progressCallback,Vt=new Promise(bn=>{bt.onFinish(Nt=>bn(1===Nt))});return St?(bt.progressStart(!0),St(bt)):bt.play(),Vt},He=(bt,ut)=>{Fe(ut,O),Fe(bt,l)},Ge=(bt,ut)=>{Fe(bt,P),Fe(ut,f)},Fe=(bt,ut)=>{if(bt){const St=new CustomEvent(ut,{bubbles:!1,cancelable:!1});bt.dispatchEvent(St)}},E=bt=>bt?new Promise(ut=>(0,Y.c)(bt,ut)):Promise.resolve(),Qe=function(){var bt=(0,x.Z)(function*(ut){const St=ut;if(St){if(null!=St.componentOnReady&&null!=(yield St.componentOnReady()))return;yield Promise.all(Array.from(St.children).map(Qe))}});return function(St){return bt.apply(this,arguments)}}(),et=(bt,ut)=>{ut?(bt.setAttribute("aria-hidden","true"),bt.classList.add("ion-page-hidden")):(bt.hidden=!1,bt.removeAttribute("aria-hidden"),bt.classList.remove("ion-page-hidden"))},ct=(bt,ut,St)=>{void 0!==bt&&(bt.style.zIndex="back"===St?"99":"101"),void 0!==ut&&(ut.style.zIndex="100")},gt=bt=>bt.classList.contains("ion-page")?bt:bt.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||bt},4980:(yn,je,N)=>{"use strict";N.d(je,{a:()=>Y,b:()=>bn,c:()=>Qe,g:()=>d,i:()=>Nt});var x=N(5221);const d=Bt=>l(Bt),Y=(Bt,Mt)=>("string"==typeof Bt&&(Mt=Bt,Bt=void 0),d(Bt).includes(Mt)),l=(Bt=window)=>{if(void 0===Bt)return[];Bt.Ionic=Bt.Ionic||{};let Mt=Bt.Ionic.platforms;return null==Mt&&(Mt=Bt.Ionic.platforms=P(Bt),Mt.forEach(Kt=>Bt.document.documentElement.classList.add(`plt-${Kt}`))),Mt},P=Bt=>Object.keys(Fe).filter(Mt=>Fe[Mt](Bt)),f=Bt=>!!(He(Bt,/iPad/i)||He(Bt,/Macintosh/i)&&me(Bt)),K=Bt=>He(Bt,/android|sink/i),me=Bt=>Ge(Bt,"(any-pointer:coarse)"),we=Bt=>ze(Bt)||Ne(Bt),ze=Bt=>!!(Bt.cordova||Bt.phonegap||Bt.PhoneGap),Ne=Bt=>{const Mt=Bt.Capacitor;return!(!Mt||!Mt.isNative)},He=(Bt,Mt)=>Mt.test(Bt.navigator.userAgent),Ge=(Bt,Mt)=>Bt.matchMedia(Mt).matches,Fe={ipad:f,iphone:Bt=>He(Bt,/iPhone/i),ios:Bt=>He(Bt,/iPhone|iPod/i)||f(Bt),android:K,phablet:Bt=>{const Mt=Bt.innerWidth,Kt=Bt.innerHeight,Ot=Math.min(Mt,Kt),Ft=Math.max(Mt,Kt);return Ot>390&&Ot<520&&Ft>620&&Ft<800},tablet:Bt=>{const Mt=Bt.innerWidth,Kt=Bt.innerHeight,Ot=Math.min(Mt,Kt),Ft=Math.max(Mt,Kt);return f(Bt)||(Bt=>K(Bt)&&!He(Bt,/mobile/i))(Bt)||Ot>460&&Ot<820&&Ft>780&&Ft<1400},cordova:ze,capacitor:Ne,electron:Bt=>He(Bt,/electron/i),pwa:Bt=>!(!Bt.matchMedia("(display-mode: standalone)").matches&&!Bt.navigator.standalone),mobile:me,mobileweb:Bt=>me(Bt)&&!we(Bt),desktop:Bt=>!me(Bt),hybrid:we};class E{constructor(){this.m=new Map}reset(Mt){this.m=new Map(Object.entries(Mt))}get(Mt,Kt){const Ot=this.m.get(Mt);return void 0!==Ot?Ot:Kt}getBoolean(Mt,Kt=!1){const Ot=this.m.get(Mt);return void 0===Ot?Kt:"string"==typeof Ot?"true"===Ot:!!Ot}getNumber(Mt,Kt){const Ot=parseFloat(this.m.get(Mt));return isNaN(Ot)?void 0!==Kt?Kt:NaN:Ot}set(Mt,Kt){this.m.set(Mt,Kt)}}const Qe=new E,St="ionic-persist-config";let Vt;const bn=Bt=>Bt&&(0,x.g)(Bt)||Vt,Nt=(Bt={})=>{if("undefined"==typeof window)return;const Mt=window.document,Kt=window,Ot=Kt.Ionic=Kt.Ionic||{};l(Kt);const Ft=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(Bt=>{try{const Mt=Bt.sessionStorage.getItem(St);return null!==Mt?JSON.parse(Mt):{}}catch{return{}}})(Kt)),{persistConfig:!1}),Ot.config),(Bt=>{const Mt={};return Bt.location.search.slice(1).split("&").map(Kt=>Kt.split("=")).map(([Kt,Ot])=>[decodeURIComponent(Kt),decodeURIComponent(Ot)]).filter(([Kt])=>((Bt,Mt)=>Bt.substr(0,Mt.length)===Mt)(Kt,"ionic:")).map(([Kt,Ot])=>[Kt.slice("ionic:".length),Ot]).forEach(([Kt,Ot])=>{Mt[Kt]=Ot}),Mt})(Kt)),Bt);Qe.reset(Ft),Qe.getBoolean("persistConfig")&&((Bt,Mt)=>{try{Bt.sessionStorage.setItem(St,JSON.stringify(Mt))}catch{return}})(Kt,Ft),Ot.config=Qe,Ot.mode=Vt=Qe.get("mode",Mt.documentElement.getAttribute("mode")||(Y(Kt,"ios")?"ios":"md")),Qe.set("mode",Vt),Mt.documentElement.setAttribute("mode",Vt),Mt.documentElement.classList.add(Vt),Qe.getBoolean("_testing")&&Qe.set("animated",!1);const ln=tn=>tn.tagName&&tn.tagName.startsWith("ION-"),nn=tn=>["ios","md"].includes(tn);(0,x.s)(tn=>{for(;tn;){const en=tn.mode||tn.getAttribute("mode");if(en){if(nn(en))return en;ln(tn)&&console.warn('Invalid ionic mode: "'+en+'", expected: "ios" or "md"')}tn=tn.parentElement}return Vt})}},8886:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{iosTransitionAnimation:()=>ne,shadow:()=>O});var x=N(3119),d=N(149);N(5221);const P=ce=>document.querySelector(`${ce}.ion-cloned-element`),O=ce=>ce.shadowRoot||ce,f=ce=>{const me="ION-TABS"===ce.tagName?ce:ce.querySelector("ion-tabs"),ve="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=me){const we=me.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=we?we.querySelector(ve):null}return ce.querySelector(ve)},H=(ce,me)=>{const ve="ION-TABS"===ce.tagName?ce:ce.querySelector("ion-tabs");let we=[];if(null!=ve){const ze=ve.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=ze&&(we=ze.querySelectorAll("ion-buttons"))}else we=ce.querySelectorAll("ion-buttons");for(const ze of we){const Ne=ze.closest("ion-header"),Ae=Ne&&!Ne.classList.contains("header-collapse-condense-inactive"),Te=ze.querySelector("ion-back-button"),He=ze.classList.contains("buttons-collapse"),Ge="start"===ze.slot||""===ze.slot;if(null!==Te&&Ge&&(He&&Ae&&me||!He))return Te}return null},K=(ce,me,ve,we,ze,Ne)=>{const Ae=me?`calc(100% - ${Ne.right+4}px)`:Ne.left-4+"px",Te=me?"7px":"-7px",He=me?"-4px":"4px",Ge=me?"-4px":"4px",Fe=me?"right":"left",E=me?"left":"right",ct=ve?[{offset:0,opacity:1,transform:`translate3d(${He}, ${Ne.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Te}, ${ze.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${Te}, ${ze.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${He}, ${Ne.top-46}px, 0) scale(1)`}],ut=ve?[{offset:0,opacity:1,transform:`translate3d(${Ge}, ${Ne.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${Ge}, ${Ne.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${Ge}, ${Ne.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${Ge}, ${Ne.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${Ge}, ${Ne.top-46}px, 0) scale(1)`}],St=(0,x.c)(),Vt=(0,x.c)(),bn=P("ion-back-button"),Nt=O(bn).querySelector(".button-text"),Bt=O(bn).querySelector("ion-icon");bn.text=we.text,bn.mode=we.mode,bn.icon=we.icon,bn.color=we.color,bn.disabled=we.disabled,bn.style.setProperty("display","block"),bn.style.setProperty("position","fixed"),Vt.addElement(Bt),St.addElement(Nt),St.beforeStyles({"transform-origin":`${Fe} center`}).beforeAddWrite(()=>{we.style.setProperty("display","none"),bn.style.setProperty(Fe,Ae)}).afterAddWrite(()=>{we.style.setProperty("display",""),bn.style.setProperty("display","none"),bn.style.removeProperty(Fe)}).keyframes(ct),Vt.beforeStyles({"transform-origin":`${E} center`}).keyframes(ut),ce.addAnimation([St,Vt])},G=(ce,me,ve,we,ze,Ne)=>{const Ae=me?`calc(100% - ${ze.right}px)`:`${ze.left}px`,Te=me?"-18px":"18px",He=me?"right":"left",E=ve?[{offset:0,opacity:0,transform:`translate3d(${Te}, ${Ne.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${ze.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${ze.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Te}, ${Ne.top-4}px, 0) scale(0.5)`}],Qe=P("ion-title"),et=(0,x.c)();Qe.innerText=we.innerText,Qe.size=we.size,Qe.color=we.color,et.addElement(Qe),et.beforeStyles({"transform-origin":`${He} center`,height:"46px",display:"",position:"relative",[He]:Ae}).beforeAddWrite(()=>{we.style.setProperty("display","none")}).afterAddWrite(()=>{we.style.setProperty("display",""),Qe.style.setProperty("display","none")}).keyframes(E),ce.addAnimation(et)},ne=(ce,me)=>{try{const ve="cubic-bezier(0.32,0.72,0,1)",we="opacity",ze="transform",Ne="0%",Ae=.8,Te="rtl"===ce.ownerDocument.dir,He=Te?"-99.5%":"99.5%",Ge=Te?"33%":"-33%",Fe=me.enteringEl,E=me.leavingEl,Qe="back"===me.direction,et=Fe.querySelector(":scope > ion-content"),ct=Fe.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),gt=Fe.querySelectorAll(":scope > ion-header > ion-toolbar"),bt=(0,x.c)(),ut=(0,x.c)();if(bt.addElement(Fe).duration(me.duration||540).easing(me.easing||ve).fill("both").beforeRemoveClass("ion-page-invisible"),E&&ce){const Nt=(0,x.c)();Nt.addElement(ce),bt.addAnimation(Nt)}if(et||0!==gt.length||0!==ct.length?(ut.addElement(et),ut.addElement(ct)):ut.addElement(Fe.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),bt.addAnimation(ut),Qe?ut.beforeClearStyles([we]).fromTo("transform",`translateX(${Ge})`,`translateX(${Ne})`).fromTo(we,Ae,1):ut.beforeClearStyles([we]).fromTo("transform",`translateX(${He})`,`translateX(${Ne})`),et){const Nt=O(et).querySelector(".transition-effect");if(Nt){const Bt=Nt.querySelector(".transition-cover"),Mt=Nt.querySelector(".transition-shadow"),Kt=(0,x.c)(),Ot=(0,x.c)(),Ft=(0,x.c)();Kt.addElement(Nt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Ot.addElement(Bt).beforeClearStyles([we]).fromTo(we,0,.1),Ft.addElement(Mt).beforeClearStyles([we]).fromTo(we,.03,.7),Kt.addAnimation([Ot,Ft]),ut.addAnimation([Kt])}}const St=Fe.querySelector("ion-header.header-collapse-condense"),{forward:Vt,backward:bn}=((ce,me,ve,we,ze)=>{const Ne=H(we,ve),Ae=f(ze),Te=f(we),He=H(ze,ve),Ge=null!==Ne&&null!==Ae&&!ve,Fe=null!==Te&&null!==He&&ve;if(Ge){const E=Ae.getBoundingClientRect(),Qe=Ne.getBoundingClientRect();G(ce,me,ve,Ae,E,Qe),K(ce,me,ve,Ne,E,Qe)}else if(Fe){const E=Te.getBoundingClientRect(),Qe=He.getBoundingClientRect();G(ce,me,ve,Te,E,Qe),K(ce,me,ve,He,E,Qe)}return{forward:Ge,backward:Fe}})(bt,Te,Qe,Fe,E);if(gt.forEach(Nt=>{const Bt=(0,x.c)();Bt.addElement(Nt),bt.addAnimation(Bt);const Mt=(0,x.c)();Mt.addElement(Nt.querySelector("ion-title"));const Kt=(0,x.c)(),Ot=Array.from(Nt.querySelectorAll("ion-buttons,[menuToggle]")),Ft=Nt.closest("ion-header"),ln=Ft&&Ft.classList.contains("header-collapse-condense-inactive");let nn;nn=Ot.filter(Qe?cn=>{const kn=cn.classList.contains("buttons-collapse");return kn&&!ln||!kn}:cn=>!cn.classList.contains("buttons-collapse")),Kt.addElement(nn);const tn=(0,x.c)();tn.addElement(Nt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const en=(0,x.c)();en.addElement(O(Nt).querySelector(".toolbar-background"));const yt=(0,x.c)(),Xt=Nt.querySelector("ion-back-button");if(Xt&&yt.addElement(Xt),Bt.addAnimation([Mt,Kt,tn,en,yt]),Kt.fromTo(we,.01,1),tn.fromTo(we,.01,1),Qe)ln||Mt.fromTo("transform",`translateX(${Ge})`,`translateX(${Ne})`).fromTo(we,.01,1),tn.fromTo("transform",`translateX(${Ge})`,`translateX(${Ne})`),yt.fromTo(we,.01,1);else if(St||Mt.fromTo("transform",`translateX(${He})`,`translateX(${Ne})`).fromTo(we,.01,1),tn.fromTo("transform",`translateX(${He})`,`translateX(${Ne})`),en.beforeClearStyles([we,"transform"]),(null==Ft?void 0:Ft.translucent)?en.fromTo("transform",Te?"translateX(-100%)":"translateX(100%)","translateX(0px)"):en.fromTo(we,.01,"var(--opacity)"),Vt||yt.fromTo(we,.01,1),Xt&&!Vt){const kn=(0,x.c)();kn.addElement(O(Xt).querySelector(".button-text")).fromTo("transform",Te?"translateX(-100px)":"translateX(100px)","translateX(0px)"),Bt.addAnimation(kn)}}),E){const Nt=(0,x.c)(),Bt=E.querySelector(":scope > ion-content"),Mt=E.querySelectorAll(":scope > ion-header > ion-toolbar"),Kt=E.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(Bt||0!==Mt.length||0!==Kt.length?(Nt.addElement(Bt),Nt.addElement(Kt)):Nt.addElement(E.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),bt.addAnimation(Nt),Qe){Nt.beforeClearStyles([we]).fromTo("transform",`translateX(${Ne})`,Te?"translateX(-100%)":"translateX(100%)");const Ot=(0,d.g)(E);bt.afterAddWrite(()=>{"normal"===bt.getDirection()&&Ot.style.setProperty("display","none")})}else Nt.fromTo("transform",`translateX(${Ne})`,`translateX(${Ge})`).fromTo(we,1,Ae);if(Bt){const Ot=O(Bt).querySelector(".transition-effect");if(Ot){const Ft=Ot.querySelector(".transition-cover"),ln=Ot.querySelector(".transition-shadow"),nn=(0,x.c)(),tn=(0,x.c)(),en=(0,x.c)();nn.addElement(Ot).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),tn.addElement(Ft).beforeClearStyles([we]).fromTo(we,.1,0),en.addElement(ln).beforeClearStyles([we]).fromTo(we,.7,.03),nn.addAnimation([tn,en]),Nt.addAnimation([nn])}}Mt.forEach(Ot=>{const Ft=(0,x.c)();Ft.addElement(Ot);const ln=(0,x.c)();ln.addElement(Ot.querySelector("ion-title"));const nn=(0,x.c)(),tn=Ot.querySelectorAll("ion-buttons,[menuToggle]"),en=Ot.closest("ion-header"),yt=en&&en.classList.contains("header-collapse-condense-inactive"),Xt=Array.from(tn).filter(Ki=>{const xi=Ki.classList.contains("buttons-collapse");return xi&&!yt||!xi});nn.addElement(Xt);const cn=(0,x.c)(),kn=Ot.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");kn.length>0&&cn.addElement(kn);const An=(0,x.c)();An.addElement(O(Ot).querySelector(".toolbar-background"));const mi=(0,x.c)(),si=Ot.querySelector("ion-back-button");if(si&&mi.addElement(si),Ft.addAnimation([ln,nn,cn,mi,An]),bt.addAnimation(Ft),mi.fromTo(we,.99,0),nn.fromTo(we,.99,0),cn.fromTo(we,.99,0),Qe){if(yt||ln.fromTo("transform",`translateX(${Ne})`,Te?"translateX(-100%)":"translateX(100%)").fromTo(we,.99,0),cn.fromTo("transform",`translateX(${Ne})`,Te?"translateX(-100%)":"translateX(100%)"),An.beforeClearStyles([we,"transform"]),(null==en?void 0:en.translucent)?An.fromTo("transform","translateX(0px)",Te?"translateX(-100%)":"translateX(100%)"):An.fromTo(we,"var(--opacity)",0),si&&!bn){const xi=(0,x.c)();xi.addElement(O(si).querySelector(".button-text")).fromTo("transform",`translateX(${Ne})`,`translateX(${(Te?-124:124)+"px"})`),Ft.addAnimation(xi)}}else yt||ln.fromTo("transform",`translateX(${Ne})`,`translateX(${Ge})`).fromTo(we,.99,0).afterClearStyles([ze,we]),cn.fromTo("transform",`translateX(${Ne})`,`translateX(${Ge})`).afterClearStyles([ze,we]),mi.afterClearStyles([we]),ln.afterClearStyles([we]),nn.afterClearStyles([we])})}return bt}catch(ve){throw ve}}},9258:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{mdTransitionAnimation:()=>l});var x=N(3119),d=N(149);N(5221);const l=(P,O)=>{const te="back"===O.direction,G=O.leavingEl,ne=(0,d.g)(O.enteringEl),ce=ne.querySelector("ion-toolbar"),me=(0,x.c)();if(me.addElement(ne).fill("both").beforeRemoveClass("ion-page-invisible"),te?me.duration(O.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):me.duration(O.duration||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),ce){const ve=(0,x.c)();ve.addElement(ce),me.addAnimation(ve)}if(G&&te){me.duration(O.duration||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const ve=(0,x.c)();ve.addElement((0,d.g)(G)).onFinish(we=>{1===we&&ve.elements.length>0&&ve.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),me.addAnimation(ve)}return me}},2405:(yn,je,N)=>{"use strict";N.d(je,{B:()=>Kt,a:()=>H,b:()=>te,c:()=>ce,d:()=>ct,e:()=>ve,f:()=>bt,g:()=>Vt,h:()=>O,i:()=>Nt,l:()=>K,m:()=>G,p:()=>ne,s:()=>Mt,t:()=>me});var x=N(4553),d=N(4980),Y=N(3439),l=N(697);let P=0;const O=new WeakMap,f=Ot=>({create:Ft=>we(Ot,Ft),dismiss:(Ft,ln,nn)=>Fe(document,Ft,ln,Ot,nn),getTop:()=>(0,x.Z)(function*(){return Qe(document,Ot)})()}),H=f("ion-alert"),te=f("ion-action-sheet"),K=f("ion-loading"),G=f("ion-modal"),ne=f("ion-picker"),ce=f("ion-popover"),me=f("ion-toast"),ve=Ot=>{"undefined"!=typeof document&&Ge(document);const Ft=P++;Ot.overlayIndex=Ft,Ot.hasAttribute("id")||(Ot.id=`ion-overlay-${Ft}`)},we=(Ot,Ft)=>"undefined"!=typeof customElements?customElements.whenDefined(Ot).then(()=>{const ln=document.createElement(Ot);return ln.classList.add("overlay-hidden"),Object.assign(ln,Ft),ut(document).appendChild(ln),new Promise(nn=>(0,l.c)(ln,nn))}):Promise.resolve(),ze='[tabindex]:not([tabindex^="-"]), input:not([type=hidden]):not([tabindex^="-"]), textarea:not([tabindex^="-"]), button:not([tabindex^="-"]), select:not([tabindex^="-"]), .ion-focusable:not([tabindex^="-"])',Ne="input:not([type=hidden]), textarea, button, select",Ge=Ot=>{0===P&&(P=1,Ot.addEventListener("focus",Ft=>((Ot,Ft)=>{const ln=Qe(Ft),nn=Ot.target;if(ln&&nn)if(ln===nn)ln.lastFocus=void 0;else{const tn=(0,l.g)(ln);if(!tn.contains(nn))return;const en=tn.querySelector(".ion-overlay-wrapper");if(!en)return;if(en.contains(nn))ln.lastFocus=nn;else{const yt=ln.lastFocus;((Ot,Ft)=>{let ln=Ot.querySelector(ze);const nn=ln&&ln.shadowRoot;nn&&(ln=nn.querySelector(Ne)||ln),ln?ln.focus():Ft.focus()})(en,ln),yt===Ft.activeElement&&((Ot,Ft)=>{const ln=Array.from(Ot.querySelectorAll(ze));let nn=ln.length>0?ln[ln.length-1]:null;const tn=nn&&nn.shadowRoot;tn&&(nn=tn.querySelector(Ne)||nn),nn?nn.focus():Ft.focus()})(en,ln),ln.lastFocus=Ft.activeElement}}})(Ft,Ot),!0),Ot.addEventListener("ionBackButton",Ft=>{const ln=Qe(Ot);ln&&ln.backdropDismiss&&Ft.detail.register(Y.OVERLAY_BACK_BUTTON_PRIORITY,()=>ln.dismiss(void 0,Kt))}),Ot.addEventListener("keyup",Ft=>{if("Escape"===Ft.key){const ln=Qe(Ot);ln&&ln.backdropDismiss&&ln.dismiss(void 0,Kt)}}))},Fe=(Ot,Ft,ln,nn,tn)=>{const en=Qe(Ot,nn,tn);return en?en.dismiss(Ft,ln):Promise.reject("overlay does not exist")},Qe=(Ot,Ft,ln)=>{const nn=((Ot,Ft)=>(void 0===Ft&&(Ft="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(Ot.querySelectorAll(Ft)).filter(ln=>ln.overlayIndex>0)))(Ot,Ft);return void 0===ln?nn[nn.length-1]:nn.find(tn=>tn.id===ln)},et=(Ot=!1)=>{const ln=ut(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");!ln||(Ot?ln.setAttribute("aria-hidden","true"):ln.removeAttribute("aria-hidden"))},ct=function(){var Ot=(0,x.Z)(function*(Ft,ln,nn,tn,en){if(Ft.presented)return;et(!0),Ft.presented=!0,Ft.willPresent.emit();const yt=(0,d.b)(Ft),Xt=Ft.enterAnimation?Ft.enterAnimation:d.c.get(ln,"ios"===yt?nn:tn);(yield St(Ft,Xt,Ft.el,en))&&Ft.didPresent.emit(),"ION-TOAST"!==Ft.el.tagName&&gt(Ft.el),Ft.keyboardClose&&Ft.el.focus()});return function(ln,nn,tn,en,yt){return Ot.apply(this,arguments)}}(),gt=function(){var Ot=(0,x.Z)(function*(Ft){let ln=document.activeElement;if(!ln)return;const nn=ln&&ln.shadowRoot;nn&&(ln=nn.querySelector(Ne)||ln),yield Ft.onDidDismiss(),ln.focus()});return function(ln){return Ot.apply(this,arguments)}}(),bt=function(){var Ot=(0,x.Z)(function*(Ft,ln,nn,tn,en,yt,Xt){if(!Ft.presented)return!1;et(!1),Ft.presented=!1;try{Ft.el.style.setProperty("pointer-events","none"),Ft.willDismiss.emit({data:ln,role:nn});const cn=(0,d.b)(Ft),kn=Ft.leaveAnimation?Ft.leaveAnimation:d.c.get(tn,"ios"===cn?en:yt);"gesture"!==nn&&(yield St(Ft,kn,Ft.el,Xt)),Ft.didDismiss.emit({data:ln,role:nn}),O.delete(Ft)}catch(cn){console.error(cn)}return Ft.el.remove(),!0});return function(ln,nn,tn,en,yt,Xt,cn){return Ot.apply(this,arguments)}}(),ut=Ot=>Ot.querySelector("ion-app")||Ot.body,St=function(){var Ot=(0,x.Z)(function*(Ft,ln,nn,tn){nn.classList.remove("overlay-hidden");const yt=ln(nn.shadowRoot||Ft.el,tn);(!Ft.animated||!d.c.getBoolean("animated",!0))&&yt.duration(0),Ft.keyboardClose&&yt.beforeAddWrite(()=>{const cn=nn.ownerDocument.activeElement;cn&&cn.matches("input, ion-input, ion-textarea")&&cn.blur()});const Xt=O.get(Ft)||[];return O.set(Ft,[...Xt,yt]),yield yt.play(),!0});return function(ln,nn,tn,en){return Ot.apply(this,arguments)}}(),Vt=(Ot,Ft)=>{let ln;const nn=new Promise(tn=>ln=tn);return bn(Ot,Ft,tn=>{ln(tn.detail)}),nn},bn=(Ot,Ft,ln)=>{const nn=tn=>{(0,l.b)(Ot,Ft,nn),ln(tn)};(0,l.a)(Ot,Ft,nn)},Nt=Ot=>"cancel"===Ot||Ot===Kt,Bt=Ot=>Ot(),Mt=(Ot,Ft)=>{if("function"==typeof Ot)return d.c.get("_zoneGate",Bt)(()=>{try{return Ot(Ft)}catch(nn){console.error(nn)}})},Kt="backdrop"},1586:(yn,je,N)=>{"use strict";N.d(je,{Zw:()=>Mt,aw:()=>pn,X$:()=>ot,sK:()=>xn});var x=N(865),d=N(5548);function Y(_e){return!!_e&&(_e instanceof d.y||"function"==typeof _e.lift&&"function"==typeof _e.subscribe)}var l=N(2411),P=N(6813),O=N(3596),f=N(5476),H=N(3405),te=N(6339),G=N(5192);const me=new class extends G.v{}(class extends te.o{constructor(Ye,j){super(Ye,j),this.scheduler=Ye,this.work=j}schedule(Ye,j=0){return j>0?super.schedule(Ye,j):(this.delay=j,this.state=Ye,this.scheduler.flush(this),this)}execute(Ye,j){return j>0||this.closed?super.execute(Ye,j):this._execute(Ye,j)}requestAsyncId(Ye,j,ye=0){return null!==ye&&ye>0||null===ye&&this.delay>0?super.requestAsyncId(Ye,j,ye):Ye.flush(this)}});var ve=N(1346),we=N(4168),ze=N(172);class He{constructor(Ye,j,ye){this.kind=Ye,this.value=j,this.error=ye,this.hasValue="N"===Ye}observe(Ye){switch(this.kind){case"N":return Ye.next&&Ye.next(this.value);case"E":return Ye.error&&Ye.error(this.error);case"C":return Ye.complete&&Ye.complete()}}do(Ye,j,ye){switch(this.kind){case"N":return Ye&&Ye(this.value);case"E":return j&&j(this.error);case"C":return ye&&ye()}}accept(Ye,j,ye){return Ye&&"function"==typeof Ye.next?this.observe(Ye):this.do(Ye,j,ye)}toObservable(){switch(this.kind){case"N":return(0,l.of)(this.value);case"E":return _e=this.error,new d.y(j=>j.error(_e));case"C":return(0,ze.c)()}var _e;throw new Error("unexpected notification kind value")}static createNext(Ye){return void 0!==Ye?new He("N",Ye):He.undefinedValueNotification}static createError(Ye){return new He("E",void 0,Ye)}static createComplete(){return He.completeNotification}}He.completeNotification=new He("C"),He.undefinedValueNotification=new He("N",void 0);class E extends we.L{constructor(Ye,j,ye=0){super(Ye),this.scheduler=j,this.delay=ye}static dispatch(Ye){const{notification:j,destination:ye}=Ye;j.observe(ye),this.unsubscribe()}scheduleMessage(Ye){this.destination.add(this.scheduler.schedule(E.dispatch,this.delay,new Qe(Ye,this.destination)))}_next(Ye){this.scheduleMessage(He.createNext(Ye))}_error(Ye){this.scheduleMessage(He.createError(Ye)),this.unsubscribe()}_complete(){this.scheduleMessage(He.createComplete()),this.unsubscribe()}}class Qe{constructor(Ye,j){this.notification=Ye,this.destination=j}}var et=N(2108),ct=N(5973);class gt extends H.xQ{constructor(Ye=Number.POSITIVE_INFINITY,j=Number.POSITIVE_INFINITY,ye){super(),this.scheduler=ye,this._events=[],this._infiniteTimeWindow=!1,this._bufferSize=Ye<1?1:Ye,this._windowTime=j<1?1:j,j===Number.POSITIVE_INFINITY?(this._infiniteTimeWindow=!0,this.next=this.nextInfiniteTimeWindow):this.next=this.nextTimeWindow}nextInfiniteTimeWindow(Ye){if(!this.isStopped){const j=this._events;j.push(Ye),j.length>this._bufferSize&&j.shift()}super.next(Ye)}nextTimeWindow(Ye){this.isStopped||(this._events.push(new bt(this._getNow(),Ye)),this._trimBufferThenGetEvents()),super.next(Ye)}_subscribe(Ye){const j=this._infiniteTimeWindow,ye=j?this._events:this._trimBufferThenGetEvents(),We=this.scheduler,Tt=ye.length;let on;if(this.closed)throw new et.N;if(this.isStopped||this.hasError?on=ve.w.EMPTY:(this.observers.push(Ye),on=new ct.W(this,Ye)),We&&Ye.add(Ye=new E(Ye,We)),j)for(let qn=0;qn<Tt&&!Ye.closed;qn++)Ye.next(ye[qn]);else for(let qn=0;qn<Tt&&!Ye.closed;qn++)Ye.next(ye[qn].value);return this.hasError?Ye.error(this.thrownError):this.isStopped&&Ye.complete(),on}_getNow(){return(this.scheduler||me).now()}_trimBufferThenGetEvents(){const Ye=this._getNow(),j=this._bufferSize,ye=this._windowTime,We=this._events,Tt=We.length;let on=0;for(;on<Tt&&!(Ye-We[on].time<ye);)on++;return Tt>j&&(on=Math.max(on,Tt-j)),on>0&&We.splice(0,on),We}}class bt{constructor(Ye,j){this.time=Ye,this.value=j}}function ut(_e,Ye,j){let ye;return ye=_e&&"object"==typeof _e?_e:{bufferSize:_e,windowTime:Ye,refCount:!1,scheduler:j},We=>We.lift(function({bufferSize:_e=Number.POSITIVE_INFINITY,windowTime:Ye=Number.POSITIVE_INFINITY,refCount:j,scheduler:ye}){let We,on,Tt=0,qn=!1,ci=!1;return function(Un){let Fi;Tt++,!We||qn?(qn=!1,We=new gt(_e,Ye,ye),Fi=We.subscribe(this),on=Un.subscribe({next(Ti){We.next(Ti)},error(Ti){qn=!0,We.error(Ti)},complete(){ci=!0,on=void 0,We.complete()}})):Fi=We.subscribe(this),this.add(()=>{Tt--,Fi.unsubscribe(),on&&!ci&&j&&0===Tt&&(on.unsubscribe(),on=void 0,We=void 0)})}}(ye))}var Vt=N(6636),bn=N(8053),Nt=N(6700),Bt=N(9204);class Mt{}let Kt=(()=>{class _e extends Mt{getTranslation(j){return(0,l.of)({})}}return _e.\u0275fac=function(){let Ye;return function(ye){return(Ye||(Ye=x.n5z(_e)))(ye||_e)}}(),_e.\u0275prov=x.Yz7({token:_e,factory:_e.\u0275fac}),_e})();class Ft{}let ln=(()=>{class _e{handle(j){return j.key}}return _e.\u0275fac=function(j){return new(j||_e)},_e.\u0275prov=x.Yz7({token:_e,factory:_e.\u0275fac}),_e})();function nn(_e,Ye){if(_e===Ye)return!0;if(null===_e||null===Ye)return!1;if(_e!=_e&&Ye!=Ye)return!0;let We,Tt,on,j=typeof _e;if(j==typeof Ye&&"object"==j){if(!Array.isArray(_e)){if(Array.isArray(Ye))return!1;for(Tt in on=Object.create(null),_e){if(!nn(_e[Tt],Ye[Tt]))return!1;on[Tt]=!0}for(Tt in Ye)if(!(Tt in on)&&void 0!==Ye[Tt])return!1;return!0}if(!Array.isArray(Ye))return!1;if((We=_e.length)==Ye.length){for(Tt=0;Tt<We;Tt++)if(!nn(_e[Tt],Ye[Tt]))return!1;return!0}}return!1}function tn(_e){return null!=_e}function en(_e){return _e&&"object"==typeof _e&&!Array.isArray(_e)}function yt(_e,Ye){let j=Object.assign({},_e);return en(_e)&&en(Ye)&&Object.keys(Ye).forEach(ye=>{en(Ye[ye])?ye in _e?j[ye]=yt(_e[ye],Ye[ye]):Object.assign(j,{[ye]:Ye[ye]}):Object.assign(j,{[ye]:Ye[ye]})}),j}class Xt{}let cn=(()=>{class _e extends Xt{constructor(){super(...arguments),this.templateMatcher=/{{\s?([^{}\s]*)\s?}}/g}interpolate(j,ye){let We;return We="string"==typeof j?this.interpolateString(j,ye):"function"==typeof j?this.interpolateFunction(j,ye):j,We}getValue(j,ye){let We="string"==typeof ye?ye.split("."):[ye];ye="";do{ye+=We.shift(),!tn(j)||!tn(j[ye])||"object"!=typeof j[ye]&&We.length?We.length?ye+=".":j=void 0:(j=j[ye],ye="")}while(We.length);return j}interpolateFunction(j,ye){return j(ye)}interpolateString(j,ye){return ye?j.replace(this.templateMatcher,(We,Tt)=>{let on=this.getValue(ye,Tt);return tn(on)?on:We}):j}}return _e.\u0275fac=function(){let Ye;return function(ye){return(Ye||(Ye=x.n5z(_e)))(ye||_e)}}(),_e.\u0275prov=x.Yz7({token:_e,factory:_e.\u0275fac}),_e})();class kn{}let An=(()=>{class _e extends kn{compile(j,ye){return j}compileTranslations(j,ye){return j}}return _e.\u0275fac=function(){let Ye;return function(ye){return(Ye||(Ye=x.n5z(_e)))(ye||_e)}}(),_e.\u0275prov=x.Yz7({token:_e,factory:_e.\u0275fac}),_e})();class mi{constructor(){this.currentLang=this.defaultLang,this.translations={},this.langs=[],this.onTranslationChange=new x.vpe,this.onLangChange=new x.vpe,this.onDefaultLangChange=new x.vpe}}const si=new x.OlP("USE_STORE"),Ki=new x.OlP("USE_DEFAULT_LANG"),xi=new x.OlP("DEFAULT_LANGUAGE"),Wi=new x.OlP("USE_EXTEND");let xn=(()=>{class _e{constructor(j,ye,We,Tt,on,qn=!0,ci=!1,ai=!1,Un){this.store=j,this.currentLoader=ye,this.compiler=We,this.parser=Tt,this.missingTranslationHandler=on,this.useDefaultLang=qn,this.isolate=ci,this.extend=ai,this.pending=!1,this._onTranslationChange=new x.vpe,this._onLangChange=new x.vpe,this._onDefaultLangChange=new x.vpe,this._langs=[],this._translations={},this._translationRequests={},Un&&this.setDefaultLang(Un)}get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(j){this.isolate?this._defaultLang=j:this.store.defaultLang=j}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(j){this.isolate?this._currentLang=j:this.store.currentLang=j}get langs(){return this.isolate?this._langs:this.store.langs}set langs(j){this.isolate?this._langs=j:this.store.langs=j}get translations(){return this.isolate?this._translations:this.store.translations}set translations(j){this.isolate?this._translations=j:this.store.translations=j}setDefaultLang(j){if(j===this.defaultLang)return;let ye=this.retrieveTranslations(j);void 0!==ye?(null==this.defaultLang&&(this.defaultLang=j),ye.pipe((0,Vt.q)(1)).subscribe(We=>{this.changeDefaultLang(j)})):this.changeDefaultLang(j)}getDefaultLang(){return this.defaultLang}use(j){if(j===this.currentLang)return(0,l.of)(this.translations[j]);let ye=this.retrieveTranslations(j);return void 0!==ye?(this.currentLang||(this.currentLang=j),ye.pipe((0,Vt.q)(1)).subscribe(We=>{this.changeLang(j)}),ye):(this.changeLang(j),(0,l.of)(this.translations[j]))}retrieveTranslations(j){let ye;return(void 0===this.translations[j]||this.extend)&&(this._translationRequests[j]=this._translationRequests[j]||this.getTranslation(j),ye=this._translationRequests[j]),ye}getTranslation(j){this.pending=!0;const ye=this.currentLoader.getTranslation(j).pipe(ut(1),(0,Vt.q)(1));return this.loadingTranslations=ye.pipe((0,bn.U)(We=>this.compiler.compileTranslations(We,j)),ut(1),(0,Vt.q)(1)),this.loadingTranslations.subscribe({next:We=>{this.translations[j]=this.extend&&this.translations[j]?Object.assign(Object.assign({},We),this.translations[j]):We,this.updateLangs(),this.pending=!1},error:We=>{this.pending=!1}}),ye}setTranslation(j,ye,We=!1){ye=this.compiler.compileTranslations(ye,j),this.translations[j]=(We||this.extend)&&this.translations[j]?yt(this.translations[j],ye):ye,this.updateLangs(),this.onTranslationChange.emit({lang:j,translations:this.translations[j]})}getLangs(){return this.langs}addLangs(j){j.forEach(ye=>{-1===this.langs.indexOf(ye)&&this.langs.push(ye)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(j,ye,We){let Tt;if(ye instanceof Array){let on={},qn=!1;for(let ci of ye)on[ci]=this.getParsedResult(j,ci,We),Y(on[ci])&&(qn=!0);if(qn){const ci=ye.map(ai=>Y(on[ai])?on[ai]:(0,l.of)(on[ai]));return(0,P.D)(ci).pipe((0,bn.U)(ai=>{let Un={};return ai.forEach((Fi,Ti)=>{Un[ye[Ti]]=Fi}),Un}))}return on}if(j&&(Tt=this.parser.interpolate(this.parser.getValue(j,ye),We)),void 0===Tt&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(Tt=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],ye),We)),void 0===Tt){let on={key:ye,translateService:this};void 0!==We&&(on.interpolateParams=We),Tt=this.missingTranslationHandler.handle(on)}return void 0!==Tt?Tt:ye}get(j,ye){if(!tn(j)||!j.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe((0,Nt.b)(We=>Y(We=this.getParsedResult(We,j,ye))?We:(0,l.of)(We)));{let We=this.getParsedResult(this.translations[this.currentLang],j,ye);return Y(We)?We:(0,l.of)(We)}}getStreamOnTranslationChange(j,ye){if(!tn(j)||!j.length)throw new Error('Parameter "key" required');return(0,O.z)((0,f.P)(()=>this.get(j,ye)),this.onTranslationChange.pipe((0,Bt.w)(We=>{const Tt=this.getParsedResult(We.translations,j,ye);return"function"==typeof Tt.subscribe?Tt:(0,l.of)(Tt)})))}stream(j,ye){if(!tn(j)||!j.length)throw new Error('Parameter "key" required');return(0,O.z)((0,f.P)(()=>this.get(j,ye)),this.onLangChange.pipe((0,Bt.w)(We=>{const Tt=this.getParsedResult(We.translations,j,ye);return Y(Tt)?Tt:(0,l.of)(Tt)})))}instant(j,ye){if(!tn(j)||!j.length)throw new Error('Parameter "key" required');let We=this.getParsedResult(this.translations[this.currentLang],j,ye);if(Y(We)){if(j instanceof Array){let Tt={};return j.forEach((on,qn)=>{Tt[j[qn]]=j[qn]}),Tt}return j}return We}set(j,ye,We=this.currentLang){this.translations[We][j]=this.compiler.compile(ye,We),this.updateLangs(),this.onTranslationChange.emit({lang:We,translations:this.translations[We]})}changeLang(j){this.currentLang=j,this.onLangChange.emit({lang:j,translations:this.translations[j]}),null==this.defaultLang&&this.changeDefaultLang(j)}changeDefaultLang(j){this.defaultLang=j,this.onDefaultLangChange.emit({lang:j,translations:this.translations[j]})}reloadLang(j){return this.resetLang(j),this.getTranslation(j)}resetLang(j){this._translationRequests[j]=void 0,this.translations[j]=void 0}getBrowserLang(){if("undefined"==typeof window||void 0===window.navigator)return;let j=window.navigator.languages?window.navigator.languages[0]:null;return j=j||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,void 0!==j?(-1!==j.indexOf("-")&&(j=j.split("-")[0]),-1!==j.indexOf("_")&&(j=j.split("_")[0]),j):void 0}getBrowserCultureLang(){if("undefined"==typeof window||void 0===window.navigator)return;let j=window.navigator.languages?window.navigator.languages[0]:null;return j=j||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,j}}return _e.\u0275fac=function(j){return new(j||_e)(x.LFG(mi),x.LFG(Mt),x.LFG(kn),x.LFG(Xt),x.LFG(Ft),x.LFG(Ki),x.LFG(si),x.LFG(Wi),x.LFG(xi))},_e.\u0275prov=x.Yz7({token:_e,factory:_e.\u0275fac}),_e})(),ot=(()=>{class _e{constructor(j,ye){this.translate=j,this._ref=ye,this.value=""}updateValue(j,ye,We){let Tt=on=>{this.value=void 0!==on?on:j,this.lastKey=j,this._ref.markForCheck()};if(We){let on=this.translate.getParsedResult(We,j,ye);Y(on.subscribe)?on.subscribe(Tt):Tt(on)}this.translate.get(j,ye).subscribe(Tt)}transform(j,...ye){if(!j||!j.length)return j;if(nn(j,this.lastKey)&&nn(ye,this.lastParams))return this.value;let We;if(tn(ye[0])&&ye.length)if("string"==typeof ye[0]&&ye[0].length){let Tt=ye[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{We=JSON.parse(Tt)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${ye[0]}`)}}else"object"==typeof ye[0]&&!Array.isArray(ye[0])&&(We=ye[0]);return this.lastKey=j,this.lastParams=ye,this.updateValue(j,We),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(Tt=>{this.lastKey&&Tt.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(j,We,Tt.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(Tt=>{this.lastKey&&(this.lastKey=null,this.updateValue(j,We,Tt.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(j,We))})),this.value}_dispose(){void 0!==this.onTranslationChange&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),void 0!==this.onLangChange&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),void 0!==this.onDefaultLangChange&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return _e.\u0275fac=function(j){return new(j||_e)(x.Y36(xn,16),x.Y36(x.sBO,16))},_e.\u0275pipe=x.Yjl({name:"translate",type:_e,pure:!1}),_e.\u0275prov=x.Yz7({token:_e,factory:_e.\u0275fac}),_e})(),pn=(()=>{class _e{static forRoot(j={}){return{ngModule:_e,providers:[j.loader||{provide:Mt,useClass:Kt},j.compiler||{provide:kn,useClass:An},j.parser||{provide:Xt,useClass:cn},j.missingTranslationHandler||{provide:Ft,useClass:ln},mi,{provide:si,useValue:j.isolate},{provide:Ki,useValue:j.useDefaultLang},{provide:Wi,useValue:j.extend},{provide:xi,useValue:j.defaultLanguage},xn]}}static forChild(j={}){return{ngModule:_e,providers:[j.loader||{provide:Mt,useClass:Kt},j.compiler||{provide:kn,useClass:An},j.parser||{provide:Xt,useClass:cn},j.missingTranslationHandler||{provide:Ft,useClass:ln},{provide:si,useValue:j.isolate},{provide:Ki,useValue:j.useDefaultLang},{provide:Wi,useValue:j.extend},{provide:xi,useValue:j.defaultLanguage},xn]}}}return _e.\u0275fac=function(j){return new(j||_e)},_e.\u0275mod=x.oAB({type:_e}),_e.\u0275inj=x.cJS({}),_e})()},7887:function(yn){yn.exports=function(){"use strict";var je,N,x;function d(l,P){if(je)if(N){var O="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/api/#transpiling-v2'); }; var sharedChunk = {}; ("+je+")(sharedChunk); ("+N+")(sharedChunk); self.onerror = null;",f={};je(f),x=P(f),"undefined"!=typeof window&&(x.workerUrl=window.URL.createObjectURL(new Blob([O],{type:"text/javascript"})))}else N=P;else je=P}return d(0,function(l){var P="2.5.1",O=f;function f(o,e,s,c){this.cx=3*o,this.bx=3*(s-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(c-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=c,this.p2x=s,this.p2y=c}f.prototype.sampleCurveX=function(o){return((this.ax*o+this.bx)*o+this.cx)*o},f.prototype.sampleCurveY=function(o){return((this.ay*o+this.by)*o+this.cy)*o},f.prototype.sampleCurveDerivativeX=function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},f.prototype.solveCurveX=function(o,e){var s,c,p,_,v;for(void 0===e&&(e=1e-6),p=o,v=0;v<8;v++){if(_=this.sampleCurveX(p)-o,Math.abs(_)<e)return p;var T=this.sampleCurveDerivativeX(p);if(Math.abs(T)<1e-6)break;p-=_/T}if((p=o)<(s=0))return s;if(p>(c=1))return c;for(;s<c;){if(_=this.sampleCurveX(p),Math.abs(_-o)<e)return p;o>_?s=p:c=p,p=.5*(c-s)+s}return p},f.prototype.solve=function(o,e){return this.sampleCurveY(this.solveCurveX(o,e))};var H=te;function te(o,e){this.x=o,this.y=e}te.prototype={clone:function(){return new te(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,e){return this.clone()._rotateAround(o,e)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var e=o.x-this.x,s=o.y-this.y;return e*e+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,e){return Math.atan2(this.x*e-this.y*o,this.x*o+this.y*e)},_matMult:function(o){var e=o[2]*this.x+o[3]*this.y;return this.x=o[0]*this.x+o[1]*this.y,this.y=e,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var e=Math.cos(o),s=Math.sin(o),c=s*this.x+e*this.y;return this.x=e*this.x-s*this.y,this.y=c,this},_rotateAround:function(o,e){var s=Math.cos(o),c=Math.sin(o),p=e.y+c*(this.x-e.x)+s*(this.y-e.y);return this.x=e.x+s*(this.x-e.x)-c*(this.y-e.y),this.y=p,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},te.convert=function(o){return o instanceof te?o:Array.isArray(o)?new te(o[0],o[1]):o};var K="undefined"!=typeof self?self:{};const G=Math.pow(2,53)-1,ne=Math.PI/180,ce=180/Math.PI;function me(o){return o*ne}const ve=[[0,0],[1,0],[1,1],[0,1]];function we(o){if(o<=0)return 0;if(o>=1)return 1;const e=o*o,s=e*o;return 4*(o<.5?s:3*(o-e)+s-.75)}function ze(o,e,s,c){const p=new O(o,e,s,c);return function(_){return p.solve(_)}}const Ne=ze(.25,.1,.25,1);function Ae(o,e,s){return Math.min(s,Math.max(e,o))}function Te(o,e,s){const c=s-e,p=((o-e)%c+c)%c+e;return p===e?s:p}function He(o,e,s){if(!o.length)return s(null,[]);let c=o.length;const p=new Array(o.length);let _=null;o.forEach((v,T)=>{e(v,(M,z)=>{M&&(_=M),p[T]=z,0==--c&&s(_,p)})})}function Ge(o){const e=[];for(const s in o)e.push(o[s]);return e}function Fe(o,...e){for(const s of e)for(const c in s)o[c]=s[c];return o}let E=1;function Qe(){return E++}function et(){return function o(e){return e?(e^16*Math.random()>>e/4).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,o)}()}function ct(o){return o<=1?1:Math.pow(2,Math.ceil(Math.log(o)/Math.LN2))}function gt(o){return!!o&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(o)}function bt(o,e){o.forEach(s=>{e[s]&&(e[s]=e[s].bind(e))})}function ut(o,e){return-1!==o.indexOf(e,o.length-e.length)}function St(o,e,s){const c={};for(const p in o)c[p]=e.call(s||this,o[p],p,o);return c}function Vt(o,e,s){const c={};for(const p in o)e.call(s||this,o[p],p,o)&&(c[p]=o[p]);return c}function bn(o){return Array.isArray(o)?o.map(bn):"object"==typeof o&&o?St(o,bn):o}const Nt={};function Bt(o){Nt[o]||("undefined"!=typeof console&&console.warn(o),Nt[o]=!0)}function Mt(o,e,s){return(s.y-o.y)*(e.x-o.x)>(e.y-o.y)*(s.x-o.x)}function Kt(o){let e=0;for(let s,c,p=0,_=o.length,v=_-1;p<_;v=p++)s=o[p],c=o[v],e+=(c.x-s.x)*(s.y+c.y);return e}function Ot(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Ft(o){const e={};if(o.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,c,p,_)=>{const v=p||_;return e[c]=!v||v.toLowerCase(),""}),e["max-age"]){const s=parseInt(e["max-age"],10);isNaN(s)?delete e["max-age"]:e["max-age"]=s}return e}let ln,nn,tn,en=null;function yt(o){if(null==en){const e=o.navigator?o.navigator.userAgent:null;en=!!o.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return en}function Xt(o){try{const e=K[o];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}const cn={now:()=>void 0!==tn?tn:K.performance.now(),setNow(o){tn=o},restoreNow(){tn=void 0},frame(o){const e=K.requestAnimationFrame(o);return{cancel:()=>K.cancelAnimationFrame(e)}},getImageData(o,e=0){const s=K.document.createElement("canvas"),c=s.getContext("2d");if(!c)throw new Error("failed to create canvas 2d context");return s.width=o.width,s.height=o.height,c.drawImage(o,0,0,o.width,o.height),c.getImageData(-e,-e,o.width+2*e,o.height+2*e)},resolveURL:o=>(ln||(ln=K.document.createElement("a")),ln.href=o,ln.href),get devicePixelRatio(){return K.devicePixelRatio},get prefersReducedMotion(){return!!K.matchMedia&&(null==nn&&(nn=K.matchMedia("(prefers-reduced-motion: reduce)")),nn.matches)}};let kn;const An={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==kn){const o=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{kn=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):o}catch{kn=o}}return kn},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},mi={supported:!1,testSupport:function(o){!xi&&Ki&&(Wi?Vi(o):si=o)}};let si,Ki,xi=!1,Wi=!1;function Vi(o){const e=o.createTexture();o.bindTexture(o.TEXTURE_2D,e);try{if(o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,Ki),o.isContextLost())return;mi.supported=!0}catch{}o.deleteTexture(e),xi=!0}K.document&&(Ki=K.document.createElement("img"),Ki.onload=function(){si&&Vi(si),si=null,Wi=!0},Ki.onerror=function(){xi=!0,si=null},Ki.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const _i="01",bi="NO_ACCESS_TOKEN";function xn(o){return 0===o.indexOf("mapbox:")}function rn(o){return An.API_URL_REGEX.test(o)}const ot=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ft(o){const e=o.match(ot);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function pn(o){const e=o.params.length?`?${o.params.join("&")}`:"";return`${o.protocol}://${o.authority}${o.path}${e}`}function _e(o){if(!o)return null;const e=o.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(K.atob(e[1]).split("").map(s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ye{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const s=_e(An.ACCESS_TOKEN);let c="";return c=s&&s.u?K.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,(p,_)=>String.fromCharCode(Number("0x"+_)))):An.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${c}`:`mapbox.eventData:${c}`}fetchEventData(){const e=Xt("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{const p=K.localStorage.getItem(s);p&&(this.eventData=JSON.parse(p));const _=K.localStorage.getItem(c);_&&(this.anonId=_)}catch{Bt("Unable to read from LocalStorage")}}saveEventData(){const e=Xt("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{K.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&K.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{Bt("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,s,c,p){if(!An.EVENTS_URL)return;const _=ft(An.EVENTS_URL);_.params.push(`access_token=${p||An.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(e).toISOString(),sdkIdentifier:"mapbox-gl-js",sdkVersion:P,skuId:_i,userId:this.anonId},T=s?Fe(v,s):v,M={url:pn(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};this.pendingRequest=V(M,z=>{this.pendingRequest=null,c(z),this.saveEventData(),this.processRequests(p)})}queueRequest(e,s){this.queue.push(e),this.processRequests(s)}}const j=new class extends Ye{constructor(o){super("appUserTurnstile"),this._customAccessToken=o}postTurnstileEvent(o,e){An.EVENTS_URL&&An.ACCESS_TOKEN&&Array.isArray(o)&&o.some(s=>xn(s)||rn(s))&&this.queueRequest(Date.now(),e)}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=_e(An.ACCESS_TOKEN),s=e?e.u:An.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;gt(this.anonId)||(this.anonId=et(),c=!0);const p=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),v=new Date(p),T=(p-this.eventData.lastSuccess)/864e5;c=c||T>=1||T<-1||_.getDate()!==v.getDate()}else c=!0;if(!c)return this.processRequests();this.postEvent(p,{"enabled.telemetry":!1},_=>{_||(this.eventData.lastSuccess=p,this.eventData.tokenU=s)},o)}},ye=j.postTurnstileEvent.bind(j),We=new class extends Ye{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(o,e,s,c){this.skuToken=e,this.errorCb=c,An.EVENTS_URL&&(s||An.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},s):this.errorCb(new Error(bi)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:s}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),gt(this.anonId)||(this.anonId=et()),this.postEvent(s,{skuToken:this.skuToken},c=>{c?this.errorCb(c):e&&(this.success[e]=!0)},o))}},Tt=We.postMapLoadEvent.bind(We),on=new class extends Ye{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(o,e,s,c){if(!An.API_URL||!An.SESSION_PATH)return;const p=ft(An.API_URL+An.SESSION_PATH);p.params.push(`sku=${e||""}`),p.params.push(`access_token=${c||An.ACCESS_TOKEN||""}`);const _={url:pn(p),headers:{"Content-Type":"text/plain"}};this.pendingRequest=pe(_,v=>{this.pendingRequest=null,s(v),this.saveEventData(),this.processRequests(c)})}getSessionAPI(o,e,s,c){this.skuToken=e,this.errorCb=c,An.SESSION_PATH&&An.API_URL&&(s||An.ACCESS_TOKEN?this.queueRequest({id:o,timestamp:Date.now()},s):this.errorCb(new Error(bi)))}processRequests(o){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:s}=this.queue.shift();e&&this.success[e]||this.getSession(s,this.skuToken,c=>{c?this.errorCb(c):e&&(this.success[e]=!0)},o)}},qn=on.getSessionAPI.bind(on),ci=new Set,ai="mapbox-tiles";let Un,Fi,Ti=500,Yi=50;function br(){K.caches&&!Un&&(Un=K.caches.open(ai))}function Ei(o){const e=o.indexOf("?");return e<0?o:o.slice(0,e)}let wr=1/0;const mr={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(mr);class Ji extends Error{constructor(e,s,c){401===s&&rn(c)&&(e+=": you may have provided an invalid Mapbox access token. See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes"),super(e),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const hi=Ot()?()=>self.worker&&self.worker.referrer:()=>("blob:"===K.location.protocol?K.parent:K).location.href,re=function(o,e){if(!(/^file:/.test(s=o.url)||/^file:/.test(hi())&&!/^\w+:/.test(s))){if(K.fetch&&K.Request&&K.AbortController&&K.Request.prototype.hasOwnProperty("signal"))return function(c,p){const _=new K.AbortController,v=new K.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:hi(),signal:_.signal});let T=!1,M=!1;const z=(W=v.url).indexOf("sku=")>0&&rn(W);var W;"json"===c.type&&v.headers.set("Accept","application/json");const ee=(fe,Re,ke)=>{if(M)return;if(fe&&"SecurityError"!==fe.message&&Bt(fe),Re&&ke)return oe(Re);const tt=Date.now();K.fetch(v).then(mt=>{if(mt.ok){const It=z?mt.clone():null;return oe(mt,It,tt)}return p(new Ji(mt.statusText,mt.status,c.url))}).catch(mt=>{20!==mt.code&&p(new Error(mt.message))})},oe=(fe,Re,ke)=>{("arrayBuffer"===c.type?fe.arrayBuffer():"json"===c.type?fe.json():fe.text()).then(tt=>{M||(Re&&ke&&function(mt,It,Ut){if(br(),!Un)return;const jt={status:It.status,statusText:It.statusText,headers:new K.Headers};It.headers.forEach((Gt,gn)=>jt.headers.set(gn,Gt));const qt=Ft(It.headers.get("Cache-Control")||"");qt["no-store"]||(qt["max-age"]&&jt.headers.set("Expires",new Date(Ut+1e3*qt["max-age"]).toUTCString()),new Date(jt.headers.get("Expires")).getTime()-Ut<42e4||function(Gt,gn){if(void 0===Fi)try{new Response(new ReadableStream),Fi=!0}catch{Fi=!1}Fi?gn(Gt.body):Gt.blob().then(gn)}(It,Gt=>{const gn=new K.Response(Gt,jt);br(),Un&&Un.then(Dn=>Dn.put(Ei(mt.url),gn)).catch(Dn=>Bt(Dn.message))}))}(v,Re,ke),T=!0,p(null,tt,fe.headers.get("Cache-Control"),fe.headers.get("Expires")))}).catch(tt=>{M||p(new Error(tt.message))})};return z?function(fe,Re){if(br(),!Un)return Re(null);const ke=Ei(fe.url);Un.then(tt=>{tt.match(ke).then(mt=>{const It=function(Ut){if(!Ut)return!1;const jt=new Date(Ut.headers.get("Expires")||0),qt=Ft(Ut.headers.get("Cache-Control")||"");return jt>Date.now()&&!qt["no-cache"]}(mt);tt.delete(ke),It&&tt.put(ke,mt.clone()),Re(null,mt,It)}).catch(Re)}).catch(Re)}(v,ee):ee(null,null),{cancel:()=>{M=!0,T||_.abort()}}}(o,e);if(Ot()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",o,e,void 0,!0)}var s;return function(c,p){const _=new K.XMLHttpRequest;_.open(c.method||"GET",c.url,!0),"arrayBuffer"===c.type&&(_.responseType="arraybuffer");for(const v in c.headers)_.setRequestHeader(v,c.headers[v]);return"json"===c.type&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials="include"===c.credentials,_.onerror=()=>{p(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||0===_.status)&&null!==_.response){let v=_.response;if("json"===c.type)try{v=JSON.parse(_.response)}catch(T){return p(T)}p(null,v,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else p(new Ji(_.statusText,_.status,c.url))},_.send(c.body),{cancel:()=>_.abort()}}(o,e)},ie=function(o,e){return re(Fe(o,{type:"arrayBuffer"}),e)},V=function(o,e){return re(Fe(o,{method:"POST"}),e)},pe=function(o,e){return re(Fe(o,{method:"GET"}),e)};function De(o){const e=K.document.createElement("a");return e.href=o,e.protocol===K.document.location.protocol&&e.host===K.document.location.host}const $e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let vt,Ct;vt=[],Ct=0;const lt=function(o,e){if(mi.supported&&(o.headers||(o.headers={}),o.headers.accept="image/webp,*/*"),Ct>=An.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:o,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return vt.push(_),_}Ct++;let s=!1;const c=()=>{if(!s)for(s=!0,Ct--;vt.length&&Ct<An.MAX_PARALLEL_IMAGE_REQUESTS;){const _=vt.shift(),{requestParameters:v,callback:T,cancelled:M}=_;M||(_.cancel=lt(v,T).cancel)}},p=ie(o,(_,v,T,M)=>{c(),_?e(_):v&&(K.createImageBitmap?function(z,W){const ee=new K.Blob([new Uint8Array(z)],{type:"image/png"});K.createImageBitmap(ee).then(oe=>{W(null,oe)}).catch(oe=>{W(new Error(`Could not load image because of ${oe.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(z,W)=>e(z,W,T,M)):function(z,W){const ee=new K.Image,oe=K.URL;ee.onload=()=>{W(null,ee),oe.revokeObjectURL(ee.src),ee.onload=null,K.requestAnimationFrame(()=>{ee.src=$e})},ee.onerror=()=>W(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const fe=new K.Blob([new Uint8Array(z)],{type:"image/png"});ee.src=z.byteLength?oe.createObjectURL(fe):$e}(v,(z,W)=>e(z,W,T,M)))});return{cancel:()=>{p.cancel(),c()}}};function Dt(o,e,s){s[o]&&-1!==s[o].indexOf(e)||(s[o]=s[o]||[],s[o].push(e))}function Ht(o,e,s){if(s&&s[o]){const c=s[o].indexOf(e);-1!==c&&s[o].splice(c,1)}}class Zt{constructor(e,s={}){Fe(this,s),this.type=e}}class un extends Zt{constructor(e,s={}){super("error",Fe({error:e},s))}}class On{on(e,s){return this._listeners=this._listeners||{},Dt(e,s,this._listeners),this}off(e,s){return Ht(e,s,this._listeners),Ht(e,s,this._oneTimeListeners),this}once(e,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Dt(e,s,this._oneTimeListeners),this):new Promise(c=>this.once(e,c))}fire(e,s){"string"==typeof e&&(e=new Zt(e,s||{}));const c=e.type;if(this.listens(c)){e.target=this;const p=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const T of p)T.call(this,e);const _=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const T of _)Ht(c,T,this._oneTimeListeners),T.call(this,e);const v=this._eventedParent;v&&(Fe(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof un&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,s){return this._eventedParent=e,this._eventedParentData=s,this}}var at={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},fog:{type:"fog"},sources:{required:!0,type:"sources"},sprite:{type:"string"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{}},default:"mapbox"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{},sky:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_sky:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},fog:{range:{type:"array",default:[.5,10],minimum:-20,maximum:20,length:2,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},"horizon-blend":{type:"number","property-type":"data-constant",default:.1,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number","property-type":"data-constant",default:1,minimum:0,maximum:1e3,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_sky:{"sky-type":{type:"enum",values:{gradient:{},atmosphere:{}},default:"atmosphere",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{type:"array",value:"number",length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,requires:[{"sky-type":"atmosphere"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{type:"number",requires:[{"sky-type":"atmosphere"}],default:10,minimum:0,maximum:100,transition:!1,"property-type":"data-constant"},"sky-gradient-center":{type:"array",requires:[{"sky-type":"gradient"}],value:"number",default:[0,0],length:2,units:"degrees",minimum:[0,0],maximum:[360,180],transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{type:"number",requires:[{"sky-type":"gradient"}],default:90,minimum:0,maximum:180,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"sky-gradient":{type:"color",default:["interpolate",["linear"],["sky-radial-progress"],.8,"#87ceeb",1,"white"],transition:!1,requires:[{"sky-type":"gradient"}],expression:{interpolated:!0,parameters:["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{type:"color",default:"white",transition:!1,requires:[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};class Yt{constructor(e,s,c,p){this.message=(e?`${e}: `:"")+c,p&&(this.identifier=p),null!=s&&s.__line__&&(this.line=s.__line__)}}function ii(o){const e=o.value;return e?[new Yt(o.key,e,"constants have been deprecated as of v8")]:[]}function Qn(o,...e){for(const s of e)for(const c in s)o[c]=s[c];return o}function ei(o){return o instanceof Number||o instanceof String||o instanceof Boolean?o.valueOf():o}function yi(o){if(Array.isArray(o))return o.map(yi);if(o instanceof Object&&!(o instanceof Number||o instanceof String||o instanceof Boolean)){const e={};for(const s in o)e[s]=yi(o[s]);return e}return ei(o)}class Yn extends Error{constructor(e,s){super(s),this.message=s,this.key=e}}class oi{constructor(e,s=[]){this.parent=e,this.bindings={};for(const[c,p]of s)this.bindings[c]=p}concat(e){return new oi(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const En={kind:"null"},zt={kind:"number"},Zn={kind:"string"},ti={kind:"boolean"},li={kind:"color"},Ci={kind:"object"},ui={kind:"value"},Ii={kind:"collator"},to={kind:"formatted"},Or={kind:"resolvedImage"};function jn(o,e){return{kind:"array",itemType:o,N:e}}function $i(o){if("array"===o.kind){const e=$i(o.itemType);return"number"==typeof o.N?`array<${e}, ${o.N}>`:"value"===o.itemType.kind?"array":`array<${e}>`}return o.kind}const Fr=[En,zt,Zn,ti,li,to,Ci,jn(ui),Or];function Ir(o,e){if("error"===e.kind)return null;if("array"===o.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Ir(o.itemType,e.itemType))&&("number"!=typeof o.N||o.N===e.N))return null}else{if(o.kind===e.kind)return null;if("value"===o.kind)for(const s of Fr)if(!Ir(s,e))return null}return`Expected ${$i(o)} but found ${$i(e)} instead.`}function Nr(o,e){return e.some(s=>s.kind===o.kind)}function _r(o,e){return e.some(s=>"null"===s?null===o:"array"===s?Array.isArray(o):"object"===s?o&&!Array.isArray(o)&&"object"==typeof o:s===typeof o)}function Ee(o){var e={exports:{}};return o(e,e.exports),e.exports}var xe=Ee(function(o,e){var s={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function c(T){return(T=Math.round(T))<0?0:T>255?255:T}function p(T){return c("%"===T[T.length-1]?parseFloat(T)/100*255:parseInt(T))}function _(T){return(M="%"===T[T.length-1]?parseFloat(T)/100:parseFloat(T))<0?0:M>1?1:M;var M}function v(T,M,z){return z<0?z+=1:z>1&&(z-=1),6*z<1?T+(M-T)*z*6:2*z<1?M:3*z<2?T+(M-T)*(2/3-z)*6:T}try{e.parseCSSColor=function(T){var M,z=T.replace(/ /g,"").toLowerCase();if(z in s)return s[z].slice();if("#"===z[0])return 4===z.length?(M=parseInt(z.substr(1),16))>=0&&M<=4095?[(3840&M)>>4|(3840&M)>>8,240&M|(240&M)>>4,15&M|(15&M)<<4,1]:null:7===z.length&&(M=parseInt(z.substr(1),16))>=0&&M<=16777215?[(16711680&M)>>16,(65280&M)>>8,255&M,1]:null;var W=z.indexOf("("),ee=z.indexOf(")");if(-1!==W&&ee+1===z.length){var oe=z.substr(0,W),fe=z.substr(W+1,ee-(W+1)).split(","),Re=1;switch(oe){case"rgba":if(4!==fe.length)return null;Re=_(fe.pop());case"rgb":return 3!==fe.length?null:[p(fe[0]),p(fe[1]),p(fe[2]),Re];case"hsla":if(4!==fe.length)return null;Re=_(fe.pop());case"hsl":if(3!==fe.length)return null;var ke=(parseFloat(fe[0])%360+360)%360/360,tt=_(fe[1]),mt=_(fe[2]),It=mt<=.5?mt*(tt+1):mt+tt-mt*tt,Ut=2*mt-It;return[c(255*v(Ut,It,ke+1/3)),c(255*v(Ut,It,ke)),c(255*v(Ut,It,ke-1/3)),Re];default:return null}}return null}}catch{}});class Le{constructor(e,s,c,p=1){this.r=e,this.g=s,this.b=c,this.a=p}static parse(e){if(!e)return;if(e instanceof Le)return e;if("string"!=typeof e)return;const s=xe.parseCSSColor(e);return s?new Le(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[e,s,c,p]=this.toArray();return`rgba(${Math.round(e)},${Math.round(s)},${Math.round(c)},${p})`}toArray(){const{r:e,g:s,b:c,a:p}=this;return 0===p?[0,0,0,0]:[255*e/p,255*s/p,255*c/p,p]}}Le.black=new Le(0,0,0,1),Le.white=new Le(1,1,1,1),Le.transparent=new Le(0,0,0,0),Le.red=new Le(1,0,0,1),Le.blue=new Le(0,0,1,1);class Ke{constructor(e,s,c){this.sensitivity=e?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,s){return this.collator.compare(e,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class $t{constructor(e,s,c,p,_){this.text=e,this.image=s,this.scale=c,this.fontStack=p,this.textColor=_}}class Et{constructor(e){this.sections=e}static fromString(e){return new Et([new $t(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Et?e:Et.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const s of this.sections){if(s.image){e.push(["image",s.image.name]);continue}e.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),e.push(c)}return e}}class Qt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Qt({name:e,available:!1}):null}serialize(){return["image",this.name]}}function mn(o,e,s,c){return"number"==typeof o&&o>=0&&o<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof s&&s>=0&&s<=255?void 0===c||"number"==typeof c&&c>=0&&c<=1?null:`Invalid rgba value [${[o,e,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof c?[o,e,s,c]:[o,e,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function hn(o){if(null===o||"string"==typeof o||"boolean"==typeof o||"number"==typeof o||o instanceof Le||o instanceof Ke||o instanceof Et||o instanceof Qt)return!0;if(Array.isArray(o)){for(const e of o)if(!hn(e))return!1;return!0}if("object"==typeof o){for(const e in o)if(!hn(o[e]))return!1;return!0}return!1}function fn(o){if(null===o)return En;if("string"==typeof o)return Zn;if("boolean"==typeof o)return ti;if("number"==typeof o)return zt;if(o instanceof Le)return li;if(o instanceof Ke)return Ii;if(o instanceof Et)return to;if(o instanceof Qt)return Or;if(Array.isArray(o)){const e=o.length;let s;for(const c of o){const p=fn(c);if(s){if(s===p)continue;s=ui;break}s=p}return jn(s||ui,e)}return Ci}function Vn(o){const e=typeof o;return null===o?"":"string"===e||"number"===e||"boolean"===e?String(o):o instanceof Le||o instanceof Et||o instanceof Qt?o.toString():JSON.stringify(o)}class Fn{constructor(e,s){this.type=e,this.value=s}static parse(e,s){if(2!==e.length)return s.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!hn(e[1]))return s.error("invalid value");const c=e[1];let p=fn(c);const _=s.expectedType;return"array"!==p.kind||0!==p.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(p=_),new Fn(p,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof Le?["rgba"].concat(this.value.toArray()):this.value instanceof Et?this.value.serialize():this.value}}class pi{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const vi={string:Zn,number:zt,boolean:ti,object:Ci};class ji{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");let c,p=1;const _=e[0];if("array"===_){let T,M;if(e.length>2){const z=e[1];if("string"!=typeof z||!(z in vi)||"object"===z)return s.error('The item type argument of "array" must be one of string, number, boolean',1);T=vi[z],p++}else T=ui;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return s.error('The length argument to "array" must be a positive integer literal',2);M=e[2],p++}c=jn(T,M)}else c=vi[_];const v=[];for(;p<e.length;p++){const T=s.parse(e[p],p,ui);if(!T)return null;v.push(T)}return new ji(c,v)}evaluate(e){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(e);if(!Ir(this.type,fn(c)))return c;if(s===this.args.length-1)throw new pi(`Expected value to be of type ${$i(this.type)}, but found ${$i(fn(c))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,s=[e.kind];if("array"===e.kind){const c=e.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){s.push(c.kind);const p=e.N;("number"==typeof p||this.args.length>1)&&s.push(p)}}return s.concat(this.args.map(c=>c.serialize()))}}class Sr{constructor(e){this.type=to,this.sections=e}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const c=e[1];if(!Array.isArray(c)&&"object"==typeof c)return s.error("First argument must be an image or text section.");const p=[];let _=!1;for(let v=1;v<=e.length-1;++v){const T=e[v];if(_&&"object"==typeof T&&!Array.isArray(T)){_=!1;let M=null;if(T["font-scale"]&&(M=s.parse(T["font-scale"],1,zt),!M))return null;let z=null;if(T["text-font"]&&(z=s.parse(T["text-font"],1,jn(Zn)),!z))return null;let W=null;if(T["text-color"]&&(W=s.parse(T["text-color"],1,li),!W))return null;const ee=p[p.length-1];ee.scale=M,ee.font=z,ee.textColor=W}else{const M=s.parse(e[v],1,ui);if(!M)return null;const z=M.type.kind;if("string"!==z&&"value"!==z&&"null"!==z&&"resolvedImage"!==z)return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,p.push({content:M,scale:null,font:null,textColor:null})}}return new Sr(p)}evaluate(e){return new Et(this.sections.map(s=>{const c=s.content.evaluate(e);return fn(c)===Or?new $t("",c,null,null,null):new $t(Vn(c),null,s.scale?s.scale.evaluate(e):null,s.font?s.font.evaluate(e).join(","):null,s.textColor?s.textColor.evaluate(e):null)}))}eachChild(e){for(const s of this.sections)e(s.content),s.scale&&e(s.scale),s.font&&e(s.font),s.textColor&&e(s.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const s of this.sections){e.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),e.push(c)}return e}}class yr{constructor(e){this.type=Or,this.input=e}static parse(e,s){if(2!==e.length)return s.error("Expected two arguments.");const c=s.parse(e[1],1,Zn);return c?new yr(c):s.error("No image name provided.")}evaluate(e){const s=this.input.evaluate(e),c=Qt.fromString(s);return c&&e.availableImages&&(c.available=e.availableImages.indexOf(s)>-1),c}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const qr={"to-boolean":ti,"to-color":li,"to-number":zt,"to-string":Zn};class ur{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const c=e[0];if(("to-boolean"===c||"to-string"===c)&&2!==e.length)return s.error("Expected one argument.");const p=qr[c],_=[];for(let v=1;v<e.length;v++){const T=s.parse(e[v],v,ui);if(!T)return null;_.push(T)}return new ur(p,_)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let s,c;for(const p of this.args){if(s=p.evaluate(e),c=null,s instanceof Le)return s;if("string"==typeof s){const _=e.parseColor(s);if(_)return _}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:mn(s[0],s[1],s[2],s[3]),!c))return new Le(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new pi(c||`Could not parse color from value '${"string"==typeof s?s:String(JSON.stringify(s))}'`)}if("number"===this.type.kind){let s=null;for(const c of this.args){if(s=c.evaluate(e),null===s)return 0;const p=Number(s);if(!isNaN(p))return p}throw new pi(`Could not convert ${JSON.stringify(s)} to number.`)}return"formatted"===this.type.kind?Et.fromString(Vn(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Qt.fromString(Vn(this.args[0].evaluate(e))):Vn(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Sr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new yr(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(s=>{e.push(s.serialize())}),e}}const vo=["Unknown","Point","LineString","Polygon"];class ss{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?vo[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let s=this._parseColorCache[e];return s||(s=this._parseColorCache[e]=Le.parse(e)),s}}class no{constructor(e,s,c,p){this.name=e,this.type=s,this._evaluate=c,this.args=p}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,s){const c=e[0],p=no.definitions[c];if(!p)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(p)?p[0]:p.type,v=Array.isArray(p)?[[p[1],p[2]]]:p.overloads,T=v.filter(([z])=>!Array.isArray(z)||z.length===e.length-1);let M=null;for(const[z,W]of T){M=new ri(s.registry,s.path,null,s.scope);const ee=[];let oe=!1;for(let fe=1;fe<e.length;fe++){const Re=e[fe],ke=Array.isArray(z)?z[fe-1]:z.type,tt=M.parse(Re,1+ee.length,ke);if(!tt){oe=!0;break}ee.push(tt)}if(!oe)if(Array.isArray(z)&&z.length!==ee.length)M.error(`Expected ${z.length} arguments, but found ${ee.length} instead.`);else{for(let fe=0;fe<ee.length;fe++){const Re=Array.isArray(z)?z[fe]:z.type,ke=ee[fe];M.concat(fe+1).checkSubtype(Re,ke.type)}if(0===M.errors.length)return new no(c,_,W,ee)}}if(1===T.length)s.errors.push(...M.errors);else{const z=(T.length?T:v).map(([ee])=>{return oe=ee,Array.isArray(oe)?`(${oe.map($i).join(", ")})`:`(${$i(oe.type)}...)`;var oe}).join(" | "),W=[];for(let ee=1;ee<e.length;ee++){const oe=s.parse(e[ee],1+W.length);if(!oe)return null;W.push($i(oe.type))}s.error(`Expected arguments of type ${z}, but found (${W.join(", ")}) instead.`)}return null}static register(e,s){no.definitions=s;for(const c in s)e[c]=no}}class io{constructor(e,s,c){this.type=Ii,this.locale=c,this.caseSensitive=e,this.diacriticSensitive=s}static parse(e,s){if(2!==e.length)return s.error("Expected one argument.");const c=e[1];if("object"!=typeof c||Array.isArray(c))return s.error("Collator options argument must be an object.");const p=s.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,ti);if(!p)return null;const _=s.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,ti);if(!_)return null;let v=null;return c.locale&&(v=s.parse(c.locale,1,Zn),!v)?null:new io(p,_,v)}evaluate(e){return new Ke(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const To=8192;function Ps(o,e){o[0]=Math.min(o[0],e[0]),o[1]=Math.min(o[1],e[1]),o[2]=Math.max(o[2],e[0]),o[3]=Math.max(o[3],e[1])}function as(o,e){return!(o[0]<=e[0]||o[2]>=e[2]||o[1]<=e[1]||o[3]>=e[3])}function vs(o,e){const s=(180+o[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o[1]*Math.PI/360)))/360,p=Math.pow(2,e.z);return[Math.round(s*p*To),Math.round(c*p*To)]}function Rs(o,e,s){const c=o[0]-e[0],p=o[1]-e[1],_=o[0]-s[0],v=o[1]-s[1];return c*v-_*p==0&&c*_<=0&&p*v<=0}function ls(o,e){let s=!1;for(let v=0,T=e.length;v<T;v++){const M=e[v];for(let z=0,W=M.length;z<W-1;z++){if(Rs(o,M[z],M[z+1]))return!1;(p=M[z])[1]>(c=o)[1]!=(_=M[z+1])[1]>c[1]&&c[0]<(_[0]-p[0])*(c[1]-p[1])/(_[1]-p[1])+p[0]&&(s=!s)}}var c,p,_;return s}function cs(o,e){for(let s=0;s<e.length;s++)if(ls(o,e[s]))return!0;return!1}function Lo(o,e,s,c){const p=c[0]-s[0],_=c[1]-s[1],v=(o[0]-s[0])*_-p*(o[1]-s[1]),T=(e[0]-s[0])*_-p*(e[1]-s[1]);return v>0&&T<0||v<0&&T>0}function js(o,e,s){for(const z of s)for(let W=0;W<z.length-1;++W)if((T=[(v=z[W+1])[0]-(_=z[W])[0],v[1]-_[1]])[0]*(M=[(p=e)[0]-(c=o)[0],p[1]-c[1]])[1]-T[1]*M[0]!=0&&Lo(c,p,_,v)&&Lo(_,v,c,p))return!0;var c,p,_,v,T,M;return!1}function ko(o,e){for(let s=0;s<o.length;++s)if(!ls(o[s],e))return!1;for(let s=0;s<o.length-1;++s)if(js(o[s],o[s+1],e))return!1;return!0}function ma(o,e){for(let s=0;s<e.length;s++)if(ko(o,e[s]))return!0;return!1}function xs(o,e,s){const c=[];for(let p=0;p<o.length;p++){const _=[];for(let v=0;v<o[p].length;v++){const T=vs(o[p][v],s);Ps(e,T),_.push(T)}c.push(_)}return c}function ao(o,e,s){const c=[];for(let p=0;p<o.length;p++){const _=xs(o[p],e,s);c.push(_)}return c}function Fo(o,e,s,c){if(o[0]<s[0]||o[0]>s[2]){const p=.5*c;let _=o[0]-s[0]>p?-c:s[0]-o[0]>p?c:0;0===_&&(_=o[0]-s[2]>p?-c:s[2]-o[0]>p?c:0),o[0]+=_}Ps(e,o)}function fo(o,e,s,c){const p=Math.pow(2,c.z)*To,_=[c.x*To,c.y*To],v=[];for(const T of o)for(const M of T){const z=[M.x+_[0],M.y+_[1]];Fo(z,e,s,p),v.push(z)}return v}function Eo(o,e,s,c){const p=Math.pow(2,c.z)*To,_=[c.x*To,c.y*To],v=[];for(const M of o){const z=[];for(const W of M){const ee=[W.x+_[0],W.y+_[1]];Ps(e,ee),z.push(ee)}v.push(z)}if(e[2]-e[0]<=p/2){(T=e)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const M of v)for(const z of M)Fo(z,e,s,p)}var T;return v}class Ze{constructor(e,s){this.type=ti,this.geojson=e,this.geometries=s}static parse(e,s){if(2!==e.length)return s.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(hn(e[1])){const c=e[1];if("FeatureCollection"===c.type)for(let p=0;p<c.features.length;++p){const _=c.features[p].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new Ze(c,c.features[p].geometry)}else if("Feature"===c.type){const p=c.geometry.type;if("Polygon"===p||"MultiPolygon"===p)return new Ze(c,c.geometry)}else if("Polygon"===c.type||"MultiPolygon"===c.type)return new Ze(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(s,c){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if("Polygon"===c.type){const T=xs(c.coordinates,_,v),M=fo(s.geometry(),p,_,v);if(!as(p,_))return!1;for(const z of M)if(!ls(z,T))return!1}if("MultiPolygon"===c.type){const T=ao(c.coordinates,_,v),M=fo(s.geometry(),p,_,v);if(!as(p,_))return!1;for(const z of M)if(!cs(z,T))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(s,c){const p=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=s.canonicalID();if("Polygon"===c.type){const T=xs(c.coordinates,_,v),M=Eo(s.geometry(),p,_,v);if(!as(p,_))return!1;for(const z of M)if(!ko(z,T))return!1}if("MultiPolygon"===c.type){const T=ao(c.coordinates,_,v),M=Eo(s.geometry(),p,_,v);if(!as(p,_))return!1;for(const z of M)if(!ma(z,T))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}function st(o){if(o instanceof no&&("get"===o.name&&1===o.args.length||"feature-state"===o.name||"has"===o.name&&1===o.args.length||"properties"===o.name||"geometry-type"===o.name||"id"===o.name||/^filter-/.test(o.name))||o instanceof Ze)return!1;let e=!0;return o.eachChild(s=>{e&&!st(s)&&(e=!1)}),e}function Ie(o){if(o instanceof no&&"feature-state"===o.name)return!1;let e=!0;return o.eachChild(s=>{e&&!Ie(s)&&(e=!1)}),e}function rt(o,e){if(o instanceof no&&e.indexOf(o.name)>=0)return!1;let s=!0;return o.eachChild(c=>{s&&!rt(c,e)&&(s=!1)}),s}class kt{constructor(e,s){this.type=s.type,this.name=e,this.boundExpression=s}static parse(e,s){if(2!==e.length||"string"!=typeof e[1])return s.error("'var' expression requires exactly one string literal argument.");const c=e[1];return s.scope.has(c)?new kt(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class ri{constructor(e,s=[],c,p=new oi,_=[]){this.registry=e,this.path=s,this.key=s.map(v=>`[${v}]`).join(""),this.scope=p,this.errors=_,this.expectedType=c}parse(e,s,c,p,_={}){return s?this.concat(s,c,p)._parse(e,_):this._parse(e,_)}_parse(e,s){function c(p,_,v){return"assert"===v?new ji(_,[p]):"coerce"===v?new ur(_,[p]):p}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const p=e[0];if("string"!=typeof p)return this.error(`Expression name must be a string, but found ${typeof p} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[p];if(_){let v=_.parse(e,this);if(!v)return null;if(this.expectedType){const T=this.expectedType,M=v.type;if("string"!==T.kind&&"number"!==T.kind&&"boolean"!==T.kind&&"object"!==T.kind&&"array"!==T.kind||"value"!==M.kind)if("color"!==T.kind&&"formatted"!==T.kind&&"resolvedImage"!==T.kind||"value"!==M.kind&&"string"!==M.kind){if(this.checkSubtype(T,M))return null}else v=c(v,T,s.typeAnnotation||"coerce");else v=c(v,T,s.typeAnnotation||"assert")}if(!(v instanceof Fn)&&"resolvedImage"!==v.type.kind&&fi(v)){const T=new ss;try{v=new Fn(v.type,v.evaluate(T))}catch(M){return this.error(M.message),null}}return v}return this.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,s,c){const p="number"==typeof e?this.path.concat(e):this.path,_=c?this.scope.concat(c):this.scope;return new ri(this.registry,p,s||null,_,this.errors)}error(e,...s){const c=`${this.key}${s.map(p=>`[${p}]`).join("")}`;this.errors.push(new Yn(c,e))}checkSubtype(e,s){const c=Ir(e,s);return c&&this.error(c),c}}function fi(o){if(o instanceof kt)return fi(o.boundExpression);if(o instanceof no&&"error"===o.name||o instanceof io||o instanceof Ze)return!1;const e=o instanceof ur||o instanceof ji;let s=!0;return o.eachChild(c=>{s=e?s&&fi(c):s&&c instanceof Fn}),!!s&&st(o)&&rt(o,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script"])}function dr(o,e){const s=o.length-1;let c,p,_=0,v=s,T=0;for(;_<=v;)if(T=Math.floor((_+v)/2),c=o[T],p=o[T+1],c<=e){if(T===s||e<p)return T;_=T+1}else{if(!(c>e))throw new pi("Input is not a number.");v=T-1}return 0}class Cr{constructor(e,s,c){this.type=e,this.input=s,this.labels=[],this.outputs=[];for(const[p,_]of c)this.labels.push(p),this.outputs.push(_)}static parse(e,s){if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(e[1],1,zt);if(!c)return null;const p=[];let _=null;s.expectedType&&"value"!==s.expectedType.kind&&(_=s.expectedType);for(let v=1;v<e.length;v+=2){const T=1===v?-1/0:e[v],M=e[v+1],z=v,W=v+1;if("number"!=typeof T)return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',z);if(p.length&&p[p.length-1][0]>=T)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',z);const ee=s.parse(M,W,_);if(!ee)return null;_=_||ee.type,p.push([T,ee])}return new Cr(_,c,p)}evaluate(e){const s=this.labels,c=this.outputs;if(1===s.length)return c[0].evaluate(e);const p=this.input.evaluate(e);if(p<=s[0])return c[0].evaluate(e);const _=s.length;return p>=s[_-1]?c[_-1].evaluate(e):c[dr(s,p)].evaluate(e)}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&e.push(this.labels[s]),e.push(this.outputs[s].serialize());return e}}function Gi(o,e,s){return o*(1-s)+e*s}var Io=Object.freeze({__proto__:null,number:Gi,color:function(o,e,s){return new Le(Gi(o.r,e.r,s),Gi(o.g,e.g,s),Gi(o.b,e.b,s),Gi(o.a,e.a,s))},array:function(o,e,s){return o.map((c,p)=>Gi(c,e[p],s))}});const oa=4/29,xo=6/29,Os=3*xo*xo,ae=Math.PI/180,B=180/Math.PI;function I(o){return o>.008856451679035631?Math.pow(o,1/3):o/Os+oa}function S(o){return o>xo?o*o*o:Os*(o-oa)}function le(o){return 255*(o<=.0031308?12.92*o:1.055*Math.pow(o,1/2.4)-.055)}function Xe(o){return(o/=255)<=.04045?o/12.92:Math.pow((o+.055)/1.055,2.4)}function Jt(o){const e=Xe(o.r),s=Xe(o.g),c=Xe(o.b),p=I((.4124564*e+.3575761*s+.1804375*c)/.95047),_=I((.2126729*e+.7151522*s+.072175*c)/1);return{l:116*_-16,a:500*(p-_),b:200*(_-I((.0193339*e+.119192*s+.9503041*c)/1.08883)),alpha:o.a}}function Hn(o){let e=(o.l+16)/116,s=isNaN(o.a)?e:e+o.a/500,c=isNaN(o.b)?e:e-o.b/200;return e=1*S(e),s=.95047*S(s),c=1.08883*S(c),new Le(le(3.2404542*s-1.5371385*e-.4985314*c),le(-.969266*s+1.8760108*e+.041556*c),le(.0556434*s-.2040259*e+1.0572252*c),o.alpha)}function wi(o,e,s){const c=e-o;return o+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const Xi={forward:Jt,reverse:Hn,interpolate:function(o,e,s){return{l:Gi(o.l,e.l,s),a:Gi(o.a,e.a,s),b:Gi(o.b,e.b,s),alpha:Gi(o.alpha,e.alpha,s)}}},ar={forward:function(o){const{l:e,a:s,b:c}=Jt(o),p=Math.atan2(c,s)*B;return{h:p<0?p+360:p,c:Math.sqrt(s*s+c*c),l:e,alpha:o.a}},reverse:function(o){const e=o.h*ae,s=o.c;return Hn({l:o.l,a:Math.cos(e)*s,b:Math.sin(e)*s,alpha:o.alpha})},interpolate:function(o,e,s){return{h:wi(o.h,e.h,s),c:Gi(o.c,e.c,s),l:Gi(o.l,e.l,s),alpha:Gi(o.alpha,e.alpha,s)}}};var nr=Object.freeze({__proto__:null,lab:Xi,hcl:ar});class Ri{constructor(e,s,c,p,_){this.type=e,this.operator=s,this.interpolation=c,this.input=p,this.labels=[],this.outputs=[];for(const[v,T]of _)this.labels.push(v),this.outputs.push(T)}static interpolationFactor(e,s,c,p){let _=0;if("exponential"===e.name)_=Dr(s,e.base,c,p);else if("linear"===e.name)_=Dr(s,1,c,p);else if("cubic-bezier"===e.name){const v=e.controlPoints;_=new O(v[0],v[1],v[2],v[3]).solve(Dr(s,1,c,p))}return _}static parse(e,s){let[c,p,_,...v]=e;if(!Array.isArray(p)||0===p.length)return s.error("Expected an interpolation type expression.",1);if("linear"===p[0])p={name:"linear"};else if("exponential"===p[0]){const z=p[1];if("number"!=typeof z)return s.error("Exponential interpolation requires a numeric base.",1,1);p={name:"exponential",base:z}}else{if("cubic-bezier"!==p[0])return s.error(`Unknown interpolation type ${String(p[0])}`,1,0);{const z=p.slice(1);if(4!==z.length||z.some(W=>"number"!=typeof W||W<0||W>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);p={name:"cubic-bezier",controlPoints:z}}}if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(_=s.parse(_,2,zt),!_)return null;const T=[];let M=null;"interpolate-hcl"===c||"interpolate-lab"===c?M=li:s.expectedType&&"value"!==s.expectedType.kind&&(M=s.expectedType);for(let z=0;z<v.length;z+=2){const W=v[z],ee=v[z+1],oe=z+3,fe=z+4;if("number"!=typeof W)return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',oe);if(T.length&&T[T.length-1][0]>=W)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',oe);const Re=s.parse(ee,fe,M);if(!Re)return null;M=M||Re.type,T.push([W,Re])}return"number"===M.kind||"color"===M.kind||"array"===M.kind&&"number"===M.itemType.kind&&"number"==typeof M.N?new Ri(M,c,p,_,T):s.error(`Type ${$i(M)} is not interpolatable.`)}evaluate(e){const s=this.labels,c=this.outputs;if(1===s.length)return c[0].evaluate(e);const p=this.input.evaluate(e);if(p<=s[0])return c[0].evaluate(e);const _=s.length;if(p>=s[_-1])return c[_-1].evaluate(e);const v=dr(s,p),T=Ri.interpolationFactor(this.interpolation,p,s[v],s[v+1]),M=c[v].evaluate(e),z=c[v+1].evaluate(e);return"interpolate"===this.operator?Io[this.type.kind.toLowerCase()](M,z,T):"interpolate-hcl"===this.operator?ar.reverse(ar.interpolate(ar.forward(M),ar.forward(z),T)):Xi.reverse(Xi.interpolate(Xi.forward(M),Xi.forward(z),T))}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,e,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function Dr(o,e,s,c){const p=c-s,_=o-s;return 0===p?0:1===e?_/p:(Math.pow(e,_)-1)/(Math.pow(e,p)-1)}class Wr{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expectected at least one argument.");let c=null;const p=s.expectedType;p&&"value"!==p.kind&&(c=p);const _=[];for(const T of e.slice(1)){const M=s.parse(T,1+_.length,c,void 0,{typeAnnotation:"omit"});if(!M)return null;c=c||M.type,_.push(M)}const v=p&&_.some(T=>Ir(p,T.type));return new Wr(v?ui:c,_)}evaluate(e){let s,c=null,p=0;for(const _ of this.args)if(p++,c=_.evaluate(e),c&&c instanceof Qt&&!c.available&&(s||(s=c.name),c=null,p===this.args.length&&(c=s)),null!==c)break;return c}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(s=>{e.push(s.serialize())}),e}}class go{constructor(e,s){this.type=s.type,this.bindings=[].concat(e),this.result=s}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const s of this.bindings)e(s[1]);e(this.result)}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const c=[];for(let _=1;_<e.length-1;_+=2){const v=e[_];if("string"!=typeof v)return s.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return s.error("Variable names must contain only alphanumeric characters or '_'.",_);const T=s.parse(e[_+1],_+1);if(!T)return null;c.push([v,T])}const p=s.parse(e[e.length-1],e.length-1,s.expectedType,c);return p?new go(c,p):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[s,c]of this.bindings)e.push(s,c.serialize());return e.push(this.result.serialize()),e}}class Lr{constructor(e,s,c){this.type=e,this.index=s,this.input=c}static parse(e,s){if(3!==e.length)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,zt),p=s.parse(e[2],2,jn(s.expectedType||ui));return c&&p?new Lr(p.type.itemType,c,p):null}evaluate(e){const s=this.index.evaluate(e),c=this.input.evaluate(e);if(s<0)throw new pi(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new pi(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new pi(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class Ls{constructor(e,s){this.type=ti,this.needle=e,this.haystack=s}static parse(e,s){if(3!==e.length)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,ui),p=s.parse(e[2],2,ui);return c&&p?Nr(c.type,[ti,Zn,zt,En,ui])?new Ls(c,p):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${$i(c.type)} instead`):null}evaluate(e){const s=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!c)return!1;if(!_r(s,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${$i(fn(s))} instead.`);if(!_r(c,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${$i(fn(c))} instead.`);return c.indexOf(s)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class qo{constructor(e,s,c){this.type=zt,this.needle=e,this.haystack=s,this.fromIndex=c}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,ui),p=s.parse(e[2],2,ui);if(!c||!p)return null;if(!Nr(c.type,[ti,Zn,zt,En,ui]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${$i(c.type)} instead`);if(4===e.length){const _=s.parse(e[3],3,zt);return _?new qo(c,p,_):null}return new qo(c,p)}evaluate(e){const s=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!_r(s,["boolean","string","number","null"]))throw new pi(`Expected first argument to be of type boolean, string, number or null, but found ${$i(fn(s))} instead.`);if(!_r(c,["string","array"]))throw new pi(`Expected second argument to be of type array or string, but found ${$i(fn(c))} instead.`);if(this.fromIndex){const p=this.fromIndex.evaluate(e);return c.indexOf(s,p)}return c.indexOf(s)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class sa{constructor(e,s,c,p,_,v){this.inputType=e,this.type=s,this.input=c,this.cases=p,this.outputs=_,this.otherwise=v}static parse(e,s){if(e.length<5)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return s.error("Expected an even number of arguments.");let c,p;s.expectedType&&"value"!==s.expectedType.kind&&(p=s.expectedType);const _={},v=[];for(let z=2;z<e.length-1;z+=2){let W=e[z];const ee=e[z+1];Array.isArray(W)||(W=[W]);const oe=s.concat(z);if(0===W.length)return oe.error("Expected at least one branch label.");for(const Re of W){if("number"!=typeof Re&&"string"!=typeof Re)return oe.error("Branch labels must be numbers or strings.");if("number"==typeof Re&&Math.abs(Re)>Number.MAX_SAFE_INTEGER)return oe.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof Re&&Math.floor(Re)!==Re)return oe.error("Numeric branch labels must be integer values.");if(c){if(oe.checkSubtype(c,fn(Re)))return null}else c=fn(Re);if(void 0!==_[String(Re)])return oe.error("Branch labels must be unique.");_[String(Re)]=v.length}const fe=s.parse(ee,z,p);if(!fe)return null;p=p||fe.type,v.push(fe)}const T=s.parse(e[1],1,ui);if(!T)return null;const M=s.parse(e[e.length-1],e.length-1,p);return M?"value"!==T.type.kind&&s.concat(1).checkSubtype(c,T.type)?null:new sa(c,p,T,_,v,M):null}evaluate(e){const s=this.input.evaluate(e);return(fn(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],p={};for(const v of s){const T=p[this.cases[v]];void 0===T?(p[this.cases[v]]=c.length,c.push([this.cases[v],[v]])):c[T][1].push(v)}const _=v=>"number"===this.inputType.kind?Number(v):v;for(const[v,T]of c)e.push(1===T.length?_(T[0]):T.map(_)),e.push(this.outputs[v].serialize());return e.push(this.otherwise.serialize()),e}}class Pr{constructor(e,s,c){this.type=e,this.branches=s,this.otherwise=c}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&"value"!==s.expectedType.kind&&(c=s.expectedType);const p=[];for(let v=1;v<e.length-1;v+=2){const T=s.parse(e[v],v,ti);if(!T)return null;const M=s.parse(e[v+1],v+1,c);if(!M)return null;p.push([T,M]),c=c||M.type}const _=s.parse(e[e.length-1],e.length-1,c);return _?new Pr(c,p,_):null}evaluate(e){for(const[s,c]of this.branches)if(s.evaluate(e))return c.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[s,c]of this.branches)e(s),e(c);e(this.otherwise)}outputDefined(){return this.branches.every(([e,s])=>s.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(s=>{e.push(s.serialize())}),e}}class ks{constructor(e,s,c,p){this.type=e,this.input=s,this.beginIndex=c,this.endIndex=p}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=s.parse(e[1],1,ui),p=s.parse(e[2],2,zt);if(!c||!p)return null;if(!Nr(c.type,[jn(ui),Zn,ui]))return s.error(`Expected first argument to be of type array or string, but found ${$i(c.type)} instead`);if(4===e.length){const _=s.parse(e[3],3,zt);return _?new ks(c.type,c,p,_):null}return new ks(c.type,c,p)}evaluate(e){const s=this.input.evaluate(e),c=this.beginIndex.evaluate(e);if(!_r(s,["string","array"]))throw new pi(`Expected first argument to be of type array or string, but found ${$i(fn(s))} instead.`);if(this.endIndex){const p=this.endIndex.evaluate(e);return s.slice(c,p)}return s.slice(c)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function ws(o,e){return"=="===o||"!="===o?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Di(o,e,s,c){return 0===c.compare(e,s)}function qs(o,e,s){const c="=="!==o&&"!="!==o;return class w1{constructor(_,v,T){this.type=ti,this.lhs=_,this.rhs=v,this.collator=T,this.hasUntypedArgument="value"===_.type.kind||"value"===v.type.kind}static parse(_,v){if(3!==_.length&&4!==_.length)return v.error("Expected two or three arguments.");const T=_[0];let M=v.parse(_[1],1,ui);if(!M)return null;if(!ws(T,M.type))return v.concat(1).error(`"${T}" comparisons are not supported for type '${$i(M.type)}'.`);let z=v.parse(_[2],2,ui);if(!z)return null;if(!ws(T,z.type))return v.concat(2).error(`"${T}" comparisons are not supported for type '${$i(z.type)}'.`);if(M.type.kind!==z.type.kind&&"value"!==M.type.kind&&"value"!==z.type.kind)return v.error(`Cannot compare types '${$i(M.type)}' and '${$i(z.type)}'.`);c&&("value"===M.type.kind&&"value"!==z.type.kind?M=new ji(z.type,[M]):"value"!==M.type.kind&&"value"===z.type.kind&&(z=new ji(M.type,[z])));let W=null;if(4===_.length){if("string"!==M.type.kind&&"string"!==z.type.kind&&"value"!==M.type.kind&&"value"!==z.type.kind)return v.error("Cannot use collator to compare non-string types.");if(W=v.parse(_[3],3,Ii),!W)return null}return new w1(M,z,W)}evaluate(_){const v=this.lhs.evaluate(_),T=this.rhs.evaluate(_);if(c&&this.hasUntypedArgument){const M=fn(v),z=fn(T);if(M.kind!==z.kind||"string"!==M.kind&&"number"!==M.kind)throw new pi(`Expected arguments for "${o}" to be (string, string) or (number, number), but found (${M.kind}, ${z.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const M=fn(v),z=fn(T);if("string"!==M.kind||"string"!==z.kind)return e(_,v,T)}return this.collator?s(_,v,T,this.collator.evaluate(_)):e(_,v,T)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[o];return this.eachChild(v=>{_.push(v.serialize())}),_}}}const Vl=qs("==",function(o,e,s){return e===s},Di),Zl=qs("!=",function(o,e,s){return e!==s},function(o,e,s,c){return!Di(0,e,s,c)}),ml=qs("<",function(o,e,s){return e<s},function(o,e,s,c){return c.compare(e,s)<0}),Ka=qs(">",function(o,e,s){return e>s},function(o,e,s,c){return c.compare(e,s)>0}),_a=qs("<=",function(o,e,s){return e<=s},function(o,e,s,c){return c.compare(e,s)<=0}),Xa=qs(">=",function(o,e,s){return e>=s},function(o,e,s,c){return c.compare(e,s)>=0});class Mn{constructor(e,s,c,p,_){this.type=Zn,this.number=e,this.locale=s,this.currency=c,this.minFractionDigits=p,this.maxFractionDigits=_}static parse(e,s){if(3!==e.length)return s.error("Expected two arguments.");const c=s.parse(e[1],1,zt);if(!c)return null;const p=e[2];if("object"!=typeof p||Array.isArray(p))return s.error("NumberFormat options argument must be an object.");let _=null;if(p.locale&&(_=s.parse(p.locale,1,Zn),!_))return null;let v=null;if(p.currency&&(v=s.parse(p.currency,1,Zn),!v))return null;let T=null;if(p["min-fraction-digits"]&&(T=s.parse(p["min-fraction-digits"],1,zt),!T))return null;let M=null;return p["max-fraction-digits"]&&(M=s.parse(p["max-fraction-digits"],1,zt),!M)?null:new Mn(c,_,v,T,M)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ui{constructor(e){this.type=zt,this.input=e}static parse(e,s){if(2!==e.length)return s.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=s.parse(e[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?s.error(`Expected argument of type string or array, but found ${$i(c.type)} instead.`):new Ui(c):null}evaluate(e){const s=this.input.evaluate(e);if("string"==typeof s||Array.isArray(s))return s.length;throw new pi(`Expected value to be of type string or array, but found ${$i(fn(s))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(s=>{e.push(s.serialize())}),e}}const Hs={"==":Vl,"!=":Zl,">":Ka,"<":ml,">=":Xa,"<=":_a,array:ji,at:Lr,boolean:ji,case:Pr,coalesce:Wr,collator:io,format:Sr,image:yr,in:Ls,"index-of":qo,interpolate:Ri,"interpolate-hcl":Ri,"interpolate-lab":Ri,length:Ui,let:go,literal:Fn,match:sa,number:ji,"number-format":Mn,object:ji,slice:ks,step:Cr,string:ji,"to-boolean":ur,"to-color":ur,"to-number":ur,"to-string":ur,var:kt,within:Ze};function vr(o,[e,s,c,p]){e=e.evaluate(o),s=s.evaluate(o),c=c.evaluate(o);const _=p?p.evaluate(o):1,v=mn(e,s,c,_);if(v)throw new pi(v);return new Le(e/255*_,s/255*_,c/255*_,_)}function Jo(o,e){return o in e}function Do(o,e){const s=e[o];return void 0===s?null:s}function Vr(o){return{type:o}}function Ko(o){return{result:"success",value:o}}function bo(o){return{result:"error",value:o}}function aa(o){return"data-driven"===o["property-type"]||"cross-faded-data-driven"===o["property-type"]}function ya(o){return!!o.expression&&o.expression.parameters.indexOf("zoom")>-1}function No(o){return!!o.expression&&o.expression.interpolated}function Ni(o){return o instanceof Number?"number":o instanceof String?"string":o instanceof Boolean?"boolean":Array.isArray(o)?"array":null===o?"null":typeof o}function Yr(o){return"object"==typeof o&&null!==o&&!Array.isArray(o)}function Gs(o){return o}function Cs(o,e){const s="color"===e.type,c=o.stops&&"object"==typeof o.stops[0][0],p=c||!(c||void 0!==o.property),_=o.type||(No(e)?"exponential":"interval");if(s&&((o=Qn({},o)).stops&&(o.stops=o.stops.map(z=>[z[0],Le.parse(z[1])])),o.default=Le.parse(o.default?o.default:e.default)),o.colorSpace&&"rgb"!==o.colorSpace&&!nr[o.colorSpace])throw new Error(`Unknown color space: ${o.colorSpace}`);let v,T,M;if("exponential"===_)v=la;else if("interval"===_)v=va;else if("categorical"===_){v=Ts,T=Object.create(null);for(const z of o.stops)T[z[0]]=z[1];M=typeof o.stops[0][0]}else{if("identity"!==_)throw new Error(`Unknown function type "${_}"`);v=jc}if(c){const z={},W=[];for(let fe=0;fe<o.stops.length;fe++){const Re=o.stops[fe],ke=Re[0].zoom;void 0===z[ke]&&(z[ke]={zoom:ke,type:o.type,property:o.property,default:o.default,stops:[]},W.push(ke)),z[ke].stops.push([Re[0].value,Re[1]])}const ee=[];for(const fe of W)ee.push([z[fe].zoom,Cs(z[fe],e)]);const oe={name:"linear"};return{kind:"composite",interpolationType:oe,interpolationFactor:Ri.interpolationFactor.bind(void 0,oe),zoomStops:ee.map(fe=>fe[0]),evaluate:({zoom:fe},Re)=>la({stops:ee,base:o.base},e,fe).evaluate(fe,Re)}}if(p){const z="exponential"===_?{name:"exponential",base:void 0!==o.base?o.base:1}:null;return{kind:"camera",interpolationType:z,interpolationFactor:Ri.interpolationFactor.bind(void 0,z),zoomStops:o.stops.map(W=>W[0]),evaluate:({zoom:W})=>v(o,e,W,T,M)}}return{kind:"source",evaluate(z,W){const ee=W&&W.properties?W.properties[o.property]:void 0;return void 0===ee?ro(o.default,e.default):v(o,e,ee,T,M)}}}function ro(o,e,s){return void 0!==o?o:void 0!==e?e:void 0!==s?s:void 0}function Ts(o,e,s,c,p){return ro(typeof s===p?c[s]:void 0,o.default,e.default)}function va(o,e,s){if("number"!==Ni(s))return ro(o.default,e.default);const c=o.stops.length;if(1===c||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[c-1][0])return o.stops[c-1][1];const p=dr(o.stops.map(_=>_[0]),s);return o.stops[p][1]}function la(o,e,s){const c=void 0!==o.base?o.base:1;if("number"!==Ni(s))return ro(o.default,e.default);const p=o.stops.length;if(1===p||s<=o.stops[0][0])return o.stops[0][1];if(s>=o.stops[p-1][0])return o.stops[p-1][1];const _=dr(o.stops.map(W=>W[0]),s),v=function(W,ee,oe,fe){const Re=fe-oe,ke=W-oe;return 0===Re?0:1===ee?ke/Re:(Math.pow(ee,ke)-1)/(Math.pow(ee,Re)-1)}(s,c,o.stops[_][0],o.stops[_+1][0]),T=o.stops[_][1],M=o.stops[_+1][1];let z=Io[e.type]||Gs;if(o.colorSpace&&"rgb"!==o.colorSpace){const W=nr[o.colorSpace];z=(ee,oe)=>W.reverse(W.interpolate(W.forward(ee),W.forward(oe),v))}return"function"==typeof T.evaluate?{evaluate(...W){const ee=T.evaluate.apply(void 0,W),oe=M.evaluate.apply(void 0,W);if(void 0!==ee&&void 0!==oe)return z(ee,oe,v)}}:z(T,M,v)}function jc(o,e,s){return"color"===e.type?s=Le.parse(s):"formatted"===e.type?s=Et.fromString(s.toString()):"resolvedImage"===e.type?s=Qt.fromString(s.toString()):Ni(s)===e.type||"enum"===e.type&&e.values[s]||(s=void 0),ro(s,o.default,e.default)}no.register(Hs,{error:[{kind:"error"},[Zn],(o,[e])=>{throw new pi(e.evaluate(o))}],typeof:[Zn,[ui],(o,[e])=>$i(fn(e.evaluate(o)))],"to-rgba":[jn(zt,4),[li],(o,[e])=>e.evaluate(o).toArray()],rgb:[li,[zt,zt,zt],vr],rgba:[li,[zt,zt,zt,zt],vr],has:{type:ti,overloads:[[[Zn],(o,[e])=>Jo(e.evaluate(o),o.properties())],[[Zn,Ci],(o,[e,s])=>Jo(e.evaluate(o),s.evaluate(o))]]},get:{type:ui,overloads:[[[Zn],(o,[e])=>Do(e.evaluate(o),o.properties())],[[Zn,Ci],(o,[e,s])=>Do(e.evaluate(o),s.evaluate(o))]]},"feature-state":[ui,[Zn],(o,[e])=>Do(e.evaluate(o),o.featureState||{})],properties:[Ci,[],o=>o.properties()],"geometry-type":[Zn,[],o=>o.geometryType()],id:[ui,[],o=>o.id()],zoom:[zt,[],o=>o.globals.zoom],"heatmap-density":[zt,[],o=>o.globals.heatmapDensity||0],"line-progress":[zt,[],o=>o.globals.lineProgress||0],"sky-radial-progress":[zt,[],o=>o.globals.skyRadialProgress||0],accumulated:[ui,[],o=>void 0===o.globals.accumulated?null:o.globals.accumulated],"+":[zt,Vr(zt),(o,e)=>{let s=0;for(const c of e)s+=c.evaluate(o);return s}],"*":[zt,Vr(zt),(o,e)=>{let s=1;for(const c of e)s*=c.evaluate(o);return s}],"-":{type:zt,overloads:[[[zt,zt],(o,[e,s])=>e.evaluate(o)-s.evaluate(o)],[[zt],(o,[e])=>-e.evaluate(o)]]},"/":[zt,[zt,zt],(o,[e,s])=>e.evaluate(o)/s.evaluate(o)],"%":[zt,[zt,zt],(o,[e,s])=>e.evaluate(o)%s.evaluate(o)],ln2:[zt,[],()=>Math.LN2],pi:[zt,[],()=>Math.PI],e:[zt,[],()=>Math.E],"^":[zt,[zt,zt],(o,[e,s])=>Math.pow(e.evaluate(o),s.evaluate(o))],sqrt:[zt,[zt],(o,[e])=>Math.sqrt(e.evaluate(o))],log10:[zt,[zt],(o,[e])=>Math.log(e.evaluate(o))/Math.LN10],ln:[zt,[zt],(o,[e])=>Math.log(e.evaluate(o))],log2:[zt,[zt],(o,[e])=>Math.log(e.evaluate(o))/Math.LN2],sin:[zt,[zt],(o,[e])=>Math.sin(e.evaluate(o))],cos:[zt,[zt],(o,[e])=>Math.cos(e.evaluate(o))],tan:[zt,[zt],(o,[e])=>Math.tan(e.evaluate(o))],asin:[zt,[zt],(o,[e])=>Math.asin(e.evaluate(o))],acos:[zt,[zt],(o,[e])=>Math.acos(e.evaluate(o))],atan:[zt,[zt],(o,[e])=>Math.atan(e.evaluate(o))],min:[zt,Vr(zt),(o,e)=>Math.min(...e.map(s=>s.evaluate(o)))],max:[zt,Vr(zt),(o,e)=>Math.max(...e.map(s=>s.evaluate(o)))],abs:[zt,[zt],(o,[e])=>Math.abs(e.evaluate(o))],round:[zt,[zt],(o,[e])=>{const s=e.evaluate(o);return s<0?-Math.round(-s):Math.round(s)}],floor:[zt,[zt],(o,[e])=>Math.floor(e.evaluate(o))],ceil:[zt,[zt],(o,[e])=>Math.ceil(e.evaluate(o))],"filter-==":[ti,[Zn,ui],(o,[e,s])=>o.properties()[e.value]===s.value],"filter-id-==":[ti,[ui],(o,[e])=>o.id()===e.value],"filter-type-==":[ti,[Zn],(o,[e])=>o.geometryType()===e.value],"filter-<":[ti,[Zn,ui],(o,[e,s])=>{const c=o.properties()[e.value],p=s.value;return typeof c==typeof p&&c<p}],"filter-id-<":[ti,[ui],(o,[e])=>{const s=o.id(),c=e.value;return typeof s==typeof c&&s<c}],"filter->":[ti,[Zn,ui],(o,[e,s])=>{const c=o.properties()[e.value],p=s.value;return typeof c==typeof p&&c>p}],"filter-id->":[ti,[ui],(o,[e])=>{const s=o.id(),c=e.value;return typeof s==typeof c&&s>c}],"filter-<=":[ti,[Zn,ui],(o,[e,s])=>{const c=o.properties()[e.value],p=s.value;return typeof c==typeof p&&c<=p}],"filter-id-<=":[ti,[ui],(o,[e])=>{const s=o.id(),c=e.value;return typeof s==typeof c&&s<=c}],"filter->=":[ti,[Zn,ui],(o,[e,s])=>{const c=o.properties()[e.value],p=s.value;return typeof c==typeof p&&c>=p}],"filter-id->=":[ti,[ui],(o,[e])=>{const s=o.id(),c=e.value;return typeof s==typeof c&&s>=c}],"filter-has":[ti,[ui],(o,[e])=>e.value in o.properties()],"filter-has-id":[ti,[],o=>null!==o.id()&&void 0!==o.id()],"filter-type-in":[ti,[jn(Zn)],(o,[e])=>e.value.indexOf(o.geometryType())>=0],"filter-id-in":[ti,[jn(ui)],(o,[e])=>e.value.indexOf(o.id())>=0],"filter-in-small":[ti,[Zn,jn(ui)],(o,[e,s])=>s.value.indexOf(o.properties()[e.value])>=0],"filter-in-large":[ti,[Zn,jn(ui)],(o,[e,s])=>function(c,p,_,v){for(;_<=v;){const T=_+v>>1;if(p[T]===c)return!0;p[T]>c?v=T-1:_=T+1}return!1}(o.properties()[e.value],s.value,0,s.value.length-1)],all:{type:ti,overloads:[[[ti,ti],(o,[e,s])=>e.evaluate(o)&&s.evaluate(o)],[Vr(ti),(o,e)=>{for(const s of e)if(!s.evaluate(o))return!1;return!0}]]},any:{type:ti,overloads:[[[ti,ti],(o,[e,s])=>e.evaluate(o)||s.evaluate(o)],[Vr(ti),(o,e)=>{for(const s of e)if(s.evaluate(o))return!0;return!1}]]},"!":[ti,[ti],(o,[e])=>!e.evaluate(o)],"is-supported-script":[ti,[Zn],(o,[e])=>{const s=o.globals&&o.globals.isSupportedScript;return!s||s(e.evaluate(o))}],upcase:[Zn,[Zn],(o,[e])=>e.evaluate(o).toUpperCase()],downcase:[Zn,[Zn],(o,[e])=>e.evaluate(o).toLowerCase()],concat:[Zn,Vr(ui),(o,e)=>e.map(s=>Vn(s.evaluate(o))).join("")],"resolved-locale":[Zn,[Ii],(o,[e])=>e.evaluate(o).resolvedLocale()]});class Xo{constructor(e,s){var c;this.expression=e,this._warningHistory={},this._evaluator=new ss,this._defaultValue=s?"color"===(c=s).type&&Yr(c.default)?new Le(0,0,0,0):"color"===c.type?Le.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=s&&"enum"===s.type?s.values:null}evaluateWithoutErrorHandling(e,s,c,p,_,v){return this._evaluator.globals=e,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=p,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this.expression.evaluate(this._evaluator)}evaluate(e,s,c,p,_,v){this._evaluator.globals=e,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=p,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null;try{const T=this.expression.evaluate(this._evaluator);if(null==T||"number"==typeof T&&T!=T)return this._defaultValue;if(this._enumValues&&!(T in this._enumValues))throw new pi(`Expected value to be one of ${Object.keys(this._enumValues).map(M=>JSON.stringify(M)).join(", ")}, but found ${JSON.stringify(T)} instead.`);return T}catch(T){return this._warningHistory[T.message]||(this._warningHistory[T.message]=!0,"undefined"!=typeof console&&console.warn(T.message)),this._defaultValue}}}function A(o){return Array.isArray(o)&&o.length>0&&"string"==typeof o[0]&&o[0]in Hs}function $(o,e){const s=new ri(Hs,[],e?function(p){const _={color:li,string:Zn,number:zt,enum:Zn,boolean:ti,formatted:to,resolvedImage:Or};return"array"===p.type?jn(_[p.value]||ui,p.length):_[p.type]}(e):void 0),c=s.parse(o,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return c?Ko(new Xo(c,e)):bo(s.errors)}class R{constructor(e,s){this.kind=e,this._styleExpression=s,this.isStateDependent="constant"!==e&&!Ie(s.expression)}evaluateWithoutErrorHandling(e,s,c,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(e,s,c,p,_,v)}evaluate(e,s,c,p,_,v){return this._styleExpression.evaluate(e,s,c,p,_,v)}}class ue{constructor(e,s,c,p){this.kind=e,this.zoomStops=c,this._styleExpression=s,this.isStateDependent="camera"!==e&&!Ie(s.expression),this.interpolationType=p}evaluateWithoutErrorHandling(e,s,c,p,_,v){return this._styleExpression.evaluateWithoutErrorHandling(e,s,c,p,_,v)}evaluate(e,s,c,p,_,v){return this._styleExpression.evaluate(e,s,c,p,_,v)}interpolationFactor(e,s,c){return this.interpolationType?Ri.interpolationFactor(this.interpolationType,e,s,c):0}}function Se(o,e){if("error"===(o=$(o,e)).result)return o;const s=o.value.expression,c=st(s);if(!c&&!aa(e))return bo([new Yn("","data expressions not supported")]);const p=rt(s,["zoom"]);if(!p&&!ya(e))return bo([new Yn("","zoom expressions not supported")]);const _=Sn(s);return _||p?_ instanceof Yn?bo([_]):_ instanceof Ri&&!No(e)?bo([new Yn("",'"interpolate" expressions cannot be used with this property')]):Ko(_?new ue(c?"camera":"composite",o.value,_.labels,_ instanceof Ri?_.interpolation:void 0):new R(c?"constant":"source",o.value)):bo([new Yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Lt{constructor(e,s){this._parameters=e,this._specification=s,Qn(this,Cs(this._parameters,this._specification))}static deserialize(e){return new Lt(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Sn(o){let e=null;if(o instanceof go)e=Sn(o.result);else if(o instanceof Wr){for(const s of o.args)if(e=Sn(s),e)break}else(o instanceof Cr||o instanceof Ri)&&o.input instanceof no&&"zoom"===o.input.name&&(e=o);return e instanceof Yn||o.eachChild(s=>{const c=Sn(s);c instanceof Yn?e=c:!e&&c?e=new Yn("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&c&&e!==c&&(e=new Yn("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function Bn(o){const e=o.key,s=o.value,c=o.valueSpec||{},p=o.objectElementValidators||{},_=o.style,v=o.styleSpec;let T=[];const M=Ni(s);if("object"!==M)return[new Yt(e,s,`object expected, ${M} found`)];for(const z in s){const W=z.split(".")[0],ee=c[W]||c["*"];let oe;if(p[W])oe=p[W];else if(c[W])oe=Bo;else if(p["*"])oe=p["*"];else{if(!c["*"]){T.push(new Yt(e,s[z],`unknown property "${z}"`));continue}oe=Bo}T=T.concat(oe({key:(e&&`${e}.`)+z,value:s[z],valueSpec:ee,style:_,styleSpec:v,object:s,objectKey:z},s))}for(const z in c)p[z]||c[z].required&&void 0===c[z].default&&void 0===s[z]&&T.push(new Yt(e,s,`missing required property "${z}"`));return T}function Bi(o){const e=o.value,s=o.valueSpec,c=o.style,p=o.styleSpec,_=o.key,v=o.arrayElementValidator||Bo;if("array"!==Ni(e))return[new Yt(_,e,`array expected, ${Ni(e)} found`)];if(s.length&&e.length!==s.length)return[new Yt(_,e,`array length ${s.length} expected, length ${e.length} found`)];if(s["min-length"]&&e.length<s["min-length"])return[new Yt(_,e,`array length at least ${s["min-length"]} expected, length ${e.length} found`)];let T={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum};p.$version<7&&(T.function=s.function),"object"===Ni(s.value)&&(T=s.value);let M=[];for(let z=0;z<e.length;z++)M=M.concat(v({array:e,arrayIndex:z,value:e[z],valueSpec:T,style:c,styleSpec:p,key:`${_}[${z}]`}));return M}function ni(o){const e=o.key,s=o.value,c=o.valueSpec;let p=Ni(s);if("number"===p&&s!=s&&(p="NaN"),"number"!==p)return[new Yt(e,s,`number expected, ${p} found`)];if("minimum"in c){let _=c.minimum;if("array"===Ni(c.minimum)&&(_=c.minimum[o.arrayIndex]),s<_)return[new Yt(e,s,`${s} is less than the minimum value ${_}`)]}if("maximum"in c){let _=c.maximum;if("array"===Ni(c.maximum)&&(_=c.maximum[o.arrayIndex]),s>_)return[new Yt(e,s,`${s} is greater than the maximum value ${_}`)]}return[]}function or(o){const e=o.valueSpec,s=ei(o.value.type);let c,p,_,v={};const T="categorical"!==s&&void 0===o.value.property,M=!T,z="array"===Ni(o.value.stops)&&"array"===Ni(o.value.stops[0])&&"object"===Ni(o.value.stops[0][0]),W=Bn({key:o.key,value:o.value,valueSpec:o.styleSpec.function,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{stops:function(fe){if("identity"===s)return[new Yt(fe.key,fe.value,'identity function may not have a "stops" property')];let Re=[];const ke=fe.value;return Re=Re.concat(Bi({key:fe.key,value:ke,valueSpec:fe.valueSpec,style:fe.style,styleSpec:fe.styleSpec,arrayElementValidator:ee})),"array"===Ni(ke)&&0===ke.length&&Re.push(new Yt(fe.key,ke,"array must have at least one stop")),Re},default:function(fe){return Bo({key:fe.key,value:fe.value,valueSpec:e,style:fe.style,styleSpec:fe.styleSpec})}}});return"identity"===s&&T&&W.push(new Yt(o.key,o.value,'missing required property "property"')),"identity"===s||o.value.stops||W.push(new Yt(o.key,o.value,'missing required property "stops"')),"exponential"===s&&o.valueSpec.expression&&!No(o.valueSpec)&&W.push(new Yt(o.key,o.value,"exponential functions not supported")),o.styleSpec.$version>=8&&(M&&!aa(o.valueSpec)?W.push(new Yt(o.key,o.value,"property functions not supported")):T&&!ya(o.valueSpec)&&W.push(new Yt(o.key,o.value,"zoom functions not supported"))),"categorical"!==s&&!z||void 0!==o.value.property||W.push(new Yt(o.key,o.value,'"property" property is required')),W;function ee(fe){let Re=[];const ke=fe.value,tt=fe.key;if("array"!==Ni(ke))return[new Yt(tt,ke,`array expected, ${Ni(ke)} found`)];if(2!==ke.length)return[new Yt(tt,ke,`array length 2 expected, length ${ke.length} found`)];if(z){if("object"!==Ni(ke[0]))return[new Yt(tt,ke,`object expected, ${Ni(ke[0])} found`)];if(void 0===ke[0].zoom)return[new Yt(tt,ke,"object stop key must have zoom")];if(void 0===ke[0].value)return[new Yt(tt,ke,"object stop key must have value")];if(_&&_>ei(ke[0].zoom))return[new Yt(tt,ke[0].zoom,"stop zoom values must appear in ascending order")];ei(ke[0].zoom)!==_&&(_=ei(ke[0].zoom),p=void 0,v={}),Re=Re.concat(Bn({key:`${tt}[0]`,value:ke[0],valueSpec:{zoom:{}},style:fe.style,styleSpec:fe.styleSpec,objectElementValidators:{zoom:ni,value:oe}}))}else Re=Re.concat(oe({key:`${tt}[0]`,value:ke[0],valueSpec:{},style:fe.style,styleSpec:fe.styleSpec},ke));return A(yi(ke[1]))?Re.concat([new Yt(`${tt}[1]`,ke[1],"expressions are not allowed in function stops.")]):Re.concat(Bo({key:`${tt}[1]`,value:ke[1],valueSpec:e,style:fe.style,styleSpec:fe.styleSpec}))}function oe(fe,Re){const ke=Ni(fe.value),tt=ei(fe.value),mt=null!==fe.value?fe.value:Re;if(c){if(ke!==c)return[new Yt(fe.key,mt,`${ke} stop domain type must match previous stop domain type ${c}`)]}else c=ke;if("number"!==ke&&"string"!==ke&&"boolean"!==ke)return[new Yt(fe.key,mt,"stop domain value must be a number, string, or boolean")];if("number"!==ke&&"categorical"!==s){let It=`number expected, ${ke} found`;return aa(e)&&void 0===s&&(It+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Yt(fe.key,mt,It)]}return"categorical"!==s||"number"!==ke||isFinite(tt)&&Math.floor(tt)===tt?"categorical"!==s&&"number"===ke&&void 0!==p&&tt<p?[new Yt(fe.key,mt,"stop domain values must appear in ascending order")]:(p=tt,"categorical"===s&&tt in v?[new Yt(fe.key,mt,"stop domain values must be unique")]:(v[tt]=!0,[])):[new Yt(fe.key,mt,`integer expected, found ${tt}`)]}}function hr(o){const e=("property"===o.expressionContext?Se:$)(yi(o.value),o.valueSpec);if("error"===e.result)return e.value.map(c=>new Yt(`${o.key}${c.key}`,o.value,c.message));const s=e.value.expression||e.value._styleExpression.expression;if("property"===o.expressionContext&&"text-font"===o.propertyKey&&!s.outputDefined())return[new Yt(o.key,o.value,`Invalid data expression for "${o.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===o.expressionContext&&"layout"===o.propertyType&&!Ie(s))return[new Yt(o.key,o.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===o.expressionContext&&!Ie(s))return[new Yt(o.key,o.value,'"feature-state" data expressions are not supported with filters.')];if(o.expressionContext&&0===o.expressionContext.indexOf("cluster")){if(!rt(s,["zoom","feature-state"]))return[new Yt(o.key,o.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===o.expressionContext&&!st(s))return[new Yt(o.key,o.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function xr(o){const e=o.key,s=o.value,c=o.valueSpec,p=[];return Array.isArray(c.values)?-1===c.values.indexOf(ei(s))&&p.push(new Yt(e,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):-1===Object.keys(c.values).indexOf(ei(s))&&p.push(new Yt(e,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),p}function oo(o){if(!0===o||!1===o)return!0;if(!Array.isArray(o)||0===o.length)return!1;switch(o[0]){case"has":return o.length>=2&&"$id"!==o[1]&&"$type"!==o[1];case"in":return o.length>=3&&("string"!=typeof o[1]||Array.isArray(o[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==o.length||Array.isArray(o[1])||Array.isArray(o[2]);case"any":case"all":for(const e of o.slice(1))if(!oo(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}const Zr={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function Xr(o){if(null==o)return{filter:()=>!0,needGeometry:!1};oo(o)||(o=xa(o));const e=$(o,Zr);if("error"===e.result)throw new Error(e.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,c,p)=>e.value.evaluate(s,c,{},p),needGeometry:_l(o)}}function Jr(o,e){return o<e?-1:o>e?1:0}function _l(o){if(!Array.isArray(o))return!1;if("within"===o[0])return!0;for(let e=1;e<o.length;e++)if(_l(o[e]))return!0;return!1}function xa(o){if(!o)return!0;const e=o[0];return o.length<=1?"any"!==e:"=="===e?$l(o[1],o[2],"=="):"!="===e?jl($l(o[1],o[2],"==")):"<"===e||">"===e||"<="===e||">="===e?$l(o[1],o[2],e):"any"===e?(s=o.slice(1),["any"].concat(s.map(xa))):"all"===e?["all"].concat(o.slice(1).map(xa)):"none"===e?["all"].concat(o.slice(1).map(xa).map(jl)):"in"===e?gc(o[1],o.slice(2)):"!in"===e?jl(gc(o[1],o.slice(2))):"has"===e?qc(o[1]):"!has"===e?jl(qc(o[1])):"within"!==e||o;var s}function $l(o,e,s){switch(o){case"$type":return[`filter-type-${s}`,e];case"$id":return[`filter-id-${s}`,e];default:return[`filter-${s}`,o,e]}}function gc(o,e){if(0===e.length)return!1;switch(o){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(s=>typeof s!=typeof e[0])?["filter-in-large",o,["literal",e.sort(Jr)]]:["filter-in-small",o,["literal",e]]}}function qc(o){switch(o){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",o]}}function jl(o){return["!",o]}function Qa(o){return oo(yi(o.value))?hr(Qn({},o,{expressionContext:"filter",valueSpec:{value:"boolean"}})):ba(o)}function ba(o){const e=o.value,s=o.key;if("array"!==Ni(e))return[new Yt(s,e,`array expected, ${Ni(e)} found`)];const c=o.styleSpec;let p,_=[];if(e.length<1)return[new Yt(s,e,"filter array must have at least 1 element")];switch(_=_.concat(xr({key:`${s}[0]`,value:e[0],valueSpec:c.filter_operator,style:o.style,styleSpec:o.styleSpec})),ei(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===ei(e[1])&&_.push(new Yt(s,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&_.push(new Yt(s,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(p=Ni(e[1]),"string"!==p&&_.push(new Yt(`${s}[1]`,e[1],`string expected, ${p} found`)));for(let v=2;v<e.length;v++)p=Ni(e[v]),"$type"===ei(e[1])?_=_.concat(xr({key:`${s}[${v}]`,value:e[v],valueSpec:c.geometry_type,style:o.style,styleSpec:o.styleSpec})):"string"!==p&&"number"!==p&&"boolean"!==p&&_.push(new Yt(`${s}[${v}]`,e[v],`string, number, or boolean expected, ${p} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)_=_.concat(ba({key:`${s}[${v}]`,value:e[v],style:o.style,styleSpec:o.styleSpec}));break;case"has":case"!has":p=Ni(e[1]),2!==e.length?_.push(new Yt(s,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==p&&_.push(new Yt(`${s}[1]`,e[1],`string expected, ${p} found`));break;case"within":p=Ni(e[1]),2!==e.length?_.push(new Yt(s,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==p&&_.push(new Yt(`${s}[1]`,e[1],`object expected, ${p} found`))}return _}function wa(o,e){const s=o.key,c=o.style,p=o.styleSpec,_=o.value,v=o.objectKey,T=p[`${e}_${o.layerType}`];if(!T)return[];const M=v.match(/^(.*)-transition$/);if("paint"===e&&M&&T[M[1]]&&T[M[1]].transition)return Bo({key:s,value:_,valueSpec:p.transition,style:c,styleSpec:p});const z=o.valueSpec||T[v];if(!z)return[new Yt(s,_,`unknown property "${v}"`)];let W;if("string"===Ni(_)&&aa(z)&&!z.tokens&&(W=/^{([^}]+)}$/.exec(_)))return[new Yt(s,_,`"${v}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(W[1])} }\`.`)];const ee=[];return"symbol"===o.layerType&&("text-field"===v&&c&&!c.glyphs&&ee.push(new Yt(s,_,'use of "text-field" requires a style "glyphs" property')),"text-font"===v&&Yr(yi(_))&&"identity"===ei(_.type)&&ee.push(new Yt(s,_,'"text-font" does not support identity functions'))),ee.concat(Bo({key:o.key,value:_,valueSpec:z,style:c,styleSpec:p,expressionContext:"property",propertyType:e,propertyKey:v}))}function wo(o){return wa(o,"paint")}function La(o){return wa(o,"layout")}function Hc(o){let e=[];const s=o.value,c=o.key,p=o.style,_=o.styleSpec;s.type||s.ref||e.push(new Yt(c,s,'either "type" or "ref" is required'));let v=ei(s.type);const T=ei(s.ref);if(s.id){const M=ei(s.id);for(let z=0;z<o.arrayIndex;z++){const W=p.layers[z];ei(W.id)===M&&e.push(new Yt(c,s.id,`duplicate layer id "${s.id}", previously used at line ${W.id.__line__}`))}}if("ref"in s){let M;["type","source","source-layer","filter","layout"].forEach(z=>{z in s&&e.push(new Yt(c,s[z],`"${z}" is prohibited for ref layers`))}),p.layers.forEach(z=>{ei(z.id)===T&&(M=z)}),M?M.ref?e.push(new Yt(c,s.ref,"ref cannot reference another ref layer")):v=ei(M.type):e.push(new Yt(c,s.ref,`ref layer "${T}" not found`))}else if("background"!==v&&"sky"!==v)if(s.source){const M=p.sources&&p.sources[s.source],z=M&&ei(M.type);M?"vector"===z&&"raster"===v?e.push(new Yt(c,s.source,`layer "${s.id}" requires a raster source`)):"raster"===z&&"raster"!==v?e.push(new Yt(c,s.source,`layer "${s.id}" requires a vector source`)):"vector"!==z||s["source-layer"]?"raster-dem"===z&&"hillshade"!==v?e.push(new Yt(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==v||!s.paint||!s.paint["line-gradient"]||"geojson"===z&&M.lineMetrics||e.push(new Yt(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Yt(c,s,`layer "${s.id}" must specify a "source-layer"`)):e.push(new Yt(c,s.source,`source "${s.source}" not found`))}else e.push(new Yt(c,s,'missing required property "source"'));return e=e.concat(Bn({key:c,value:s,valueSpec:_.layer,style:o.style,styleSpec:o.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Bo({key:`${c}.type`,value:s.type,valueSpec:_.layer.type,style:o.style,styleSpec:o.styleSpec,object:s,objectKey:"type"}),filter:Qa,layout:M=>Bn({layer:s,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":z=>La(Qn({layerType:v},z))}}),paint:M=>Bn({layer:s,key:M.key,value:M.value,style:M.style,styleSpec:M.styleSpec,objectElementValidators:{"*":z=>wo(Qn({layerType:v},z))}})}})),e}function us(o){const e=o.value,s=o.key,c=Ni(e);return"string"!==c?[new Yt(s,e,`string expected, ${c} found`)]:[]}const Ca={promoteId:function({key:o,value:e}){if("string"===Ni(e))return us({key:o,value:e});{const s=[];for(const c in e)s.push(...us({key:`${o}.${c}`,value:e[c]}));return s}}};function mc(o){const e=o.value,s=o.key,c=o.styleSpec,p=o.style;if(!e.type)return[new Yt(s,e,'"type" is required')];const _=ei(e.type);let v;switch(_){case"vector":case"raster":case"raster-dem":return v=Bn({key:s,value:e,valueSpec:c[`source_${_.replace("-","_")}`],style:o.style,styleSpec:c,objectElementValidators:Ca}),v;case"geojson":if(v=Bn({key:s,value:e,valueSpec:c.source_geojson,style:p,styleSpec:c,objectElementValidators:Ca}),e.cluster)for(const T in e.clusterProperties){const[M,z]=e.clusterProperties[T],W="string"==typeof M?[M,["accumulated"],["get",T]]:M;v.push(...hr({key:`${s}.${T}.map`,value:z,expressionContext:"cluster-map"})),v.push(...hr({key:`${s}.${T}.reduce`,value:W,expressionContext:"cluster-reduce"}))}return v;case"video":return Bn({key:s,value:e,valueSpec:c.source_video,style:p,styleSpec:c});case"image":return Bn({key:s,value:e,valueSpec:c.source_image,style:p,styleSpec:c});case"canvas":return[new Yt(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return xr({key:`${s}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:p,styleSpec:c})}}function ql(o){const e=o.value,s=o.styleSpec,c=s.light,p=o.style;let _=[];const v=Ni(e);if(void 0===e)return _;if("object"!==v)return _=_.concat([new Yt("light",e,`object expected, ${v} found`)]),_;for(const T in e){const M=T.match(/^(.*)-transition$/);_=_.concat(M&&c[M[1]]&&c[M[1]].transition?Bo({key:T,value:e[T],valueSpec:s.transition,style:p,styleSpec:s}):c[T]?Bo({key:T,value:e[T],valueSpec:c[T],style:p,styleSpec:s}):[new Yt(T,e[T],`unknown property "${T}"`)])}return _}function el(o){const e=o.value,s=o.key,c=o.style,p=o.styleSpec,_=p.terrain;let v=[];const T=Ni(e);if(void 0===e)return v;if("object"!==T)return v=v.concat([new Yt("terrain",e,`object expected, ${T} found`)]),v;for(const M in e){const z=M.match(/^(.*)-transition$/);v=v.concat(z&&_[z[1]]&&_[z[1]].transition?Bo({key:M,value:e[M],valueSpec:p.transition,style:c,styleSpec:p}):_[M]?Bo({key:M,value:e[M],valueSpec:_[M],style:c,styleSpec:p}):[new Yt(M,e[M],`unknown property "${M}"`)])}if(e.source){const M=c.sources&&c.sources[e.source],z=M&&ei(M.type);M?"raster-dem"!==z&&v.push(new Yt(s,e.source,`terrain cannot be used with a source of type ${z}, it only be used with a "raster-dem" source type`)):v.push(new Yt(s,e.source,`source "${e.source}" not found`))}else v.push(new Yt(s,e,'terrain is missing required property "source"'));return v}function tl(o){const e=o.value,s=o.style,c=o.styleSpec,p=c.fog;let _=[];const v=Ni(e);if(void 0===e)return _;if("object"!==v)return _=_.concat([new Yt("fog",e,`object expected, ${v} found`)]),_;for(const T in e){const M=T.match(/^(.*)-transition$/);_=_.concat(M&&p[M[1]]&&p[M[1]].transition?Bo({key:T,value:e[T],valueSpec:c.transition,style:s,styleSpec:c}):p[T]?Bo({key:T,value:e[T],valueSpec:p[T],style:s,styleSpec:c}):[new Yt(T,e[T],`unknown property "${T}"`)])}return _}const Gc={"*":()=>[],array:Bi,boolean:function(o){const e=o.value,s=o.key,c=Ni(e);return"boolean"!==c?[new Yt(s,e,`boolean expected, ${c} found`)]:[]},number:ni,color:function(o){const e=o.key,s=o.value,c=Ni(s);return"string"!==c?[new Yt(e,s,`color expected, ${c} found`)]:null===xe.parseCSSColor(s)?[new Yt(e,s,`color expected, "${s}" found`)]:[]},constants:ii,enum:xr,filter:Qa,function:or,layer:Hc,object:Bn,source:mc,light:ql,terrain:el,fog:tl,string:us,formatted:function(o){return 0===us(o).length?[]:hr(o)},resolvedImage:function(o){return 0===us(o).length?[]:hr(o)}};function Bo(o){const e=o.value,s=o.valueSpec,c=o.styleSpec;return s.expression&&Yr(ei(e))?or(o):s.expression&&A(yi(e))?hr(o):s.type&&Gc[s.type]?Gc[s.type](o):Bn(Qn({},o,{valueSpec:s.type?c[s.type]:s}))}function Wc(o){const e=o.value,s=o.key,c=us(o);return c.length||(-1===e.indexOf("{fontstack}")&&c.push(new Yt(s,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&c.push(new Yt(s,e,'"glyphs" url must include a "{range}" token'))),c}function Ta(o,e=at){let s=[];return s=s.concat(Bo({key:"",value:o,valueSpec:e.$root,styleSpec:e,style:o,objectElementValidators:{glyphs:Wc,"*":()=>[]}})),o.constants&&(s=s.concat(ii({key:"constants",value:o.constants,style:o,styleSpec:e}))),mo(s)}function mo(o){return[].concat(o).sort((e,s)=>e.line-s.line)}function Ws(o){return function(...e){return mo(o.apply(this,e))}}Ta.source=Ws(mc),Ta.light=Ws(ql),Ta.terrain=Ws(el),Ta.fog=Ws(tl),Ta.layer=Ws(Hc),Ta.filter=Ws(Qa),Ta.paintProperty=Ws(wo),Ta.layoutProperty=Ws(La);const Fs=Ta,ca=Fs.light,ka=Fs.fog,Ea=Fs.paintProperty,nl=Fs.layoutProperty;function _c(o,e){let s=!1;if(e&&e.length)for(const c of e)o.fire(new un(new Error(c.message))),s=!0;return s}var Ns=Qo;function Qo(o,e,s){var c=this.cells=[];if(o instanceof ArrayBuffer){this.arrayBuffer=o;var p=new Int32Array(this.arrayBuffer);o=p[0],this.d=(e=p[1])+2*(s=p[2]);for(var _=0;_<this.d*this.d;_++){var v=p[3+_],T=p[3+_+1];c.push(v===T?null:p.subarray(v,T))}var M=p[3+c.length+1];this.keys=p.subarray(p[3+c.length],M),this.bboxes=p.subarray(M),this.insert=this._insertReadonly}else{this.d=e+2*s;for(var z=0;z<this.d*this.d;z++)c.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=o,this.padding=s,this.scale=e/o,this.uid=0;var W=s/e*o;this.min=-W,this.max=o+W}Qo.prototype.insert=function(o,e,s,c,p){this._forEachCell(e,s,c,p,this._insertCell,this.uid++),this.keys.push(o),this.bboxes.push(e),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(p)},Qo.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Qo.prototype._insertCell=function(o,e,s,c,p,_){this.cells[p].push(_)},Qo.prototype.query=function(o,e,s,c,p){var _=this.min,v=this.max;if(o<=_&&e<=_&&v<=s&&v<=c&&!p)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(o,e,s,c,this._queryCell,T,{},p),T},Qo.prototype._queryCell=function(o,e,s,c,p,_,v,T){var M=this.cells[p];if(null!==M)for(var z=this.keys,W=this.bboxes,ee=0;ee<M.length;ee++){var oe=M[ee];if(void 0===v[oe]){var fe=4*oe;(T?T(W[fe+0],W[fe+1],W[fe+2],W[fe+3]):o<=W[fe+2]&&e<=W[fe+3]&&s>=W[fe+0]&&c>=W[fe+1])?(v[oe]=!0,_.push(z[oe])):v[oe]=!1}}},Qo.prototype._forEachCell=function(o,e,s,c,p,_,v,T){for(var M=this._convertToCellCoord(o),z=this._convertToCellCoord(e),W=this._convertToCellCoord(s),ee=this._convertToCellCoord(c),oe=M;oe<=W;oe++)for(var fe=z;fe<=ee;fe++){var Re=this.d*fe+oe;if((!T||T(this._convertFromCellCoord(oe),this._convertFromCellCoord(fe),this._convertFromCellCoord(oe+1),this._convertFromCellCoord(fe+1)))&&p.call(this,o,e,s,c,Re,_,v,T))return}},Qo.prototype._convertFromCellCoord=function(o){return(o-this.padding)/this.scale},Qo.prototype._convertToCellCoord=function(o){return Math.max(0,Math.min(this.d-1,Math.floor(o*this.scale)+this.padding))},Qo.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var o=this.cells,e=3+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var p=new Int32Array(e+s+this.keys.length+this.bboxes.length);p[0]=this.extent,p[1]=this.n,p[2]=this.padding;for(var _=e,v=0;v<o.length;v++){var T=o[v];p[3+v]=_,p.set(T,_),_+=T.length}return p[3+o.length]=_,p.set(this.keys,_),p[3+o.length+1]=_+=this.keys.length,p.set(this.bboxes,_),_+=this.bboxes.length,p.buffer};const{ImageData:il,ImageBitmap:Yc}=K,Ia={};function Jn(o,e,s={}){Object.defineProperty(e,"_classRegistryKey",{value:o,writeable:!1}),Ia[o]={klass:e,omit:s.omit||[],shallow:s.shallow||[]}}Jn("Object",Object),Ns.serialize=function(o,e){const s=o.toArrayBuffer();return e&&e.push(s),{buffer:s}},Ns.deserialize=function(o){return new Ns(o.buffer)},Jn("Grid",Ns),Jn("Color",Le),Jn("Error",Error),Jn("ResolvedImage",Qt),Jn("StylePropertyFunction",Lt),Jn("StyleExpression",Xo,{omit:["_evaluator"]}),Jn("ZoomDependentExpression",ue),Jn("ZoomConstantExpression",R),Jn("CompoundExpression",no,{omit:["_evaluate"]});for(const o in Hs)Hs[o]._classRegistryKey||Jn(`Expression_${o}`,Hs[o]);function ua(o){return o&&"undefined"!=typeof ArrayBuffer&&(o instanceof ArrayBuffer||o.constructor&&"ArrayBuffer"===o.constructor.name)}function yc(o){return Yc&&o instanceof Yc}function da(o,e){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp)return o;if(ua(o)||yc(o))return e&&e.push(o),o;if(ArrayBuffer.isView(o)){const s=o;return e&&e.push(s.buffer),s}if(o instanceof il)return e&&e.push(o.data.buffer),o;if(Array.isArray(o)){const s=[];for(const c of o)s.push(da(c,e));return s}if("object"==typeof o){const s=o.constructor,c=s._classRegistryKey;if(!c)throw new Error("can't serialize object of unregistered class");const p=s.serialize?s.serialize(o,e):{};if(!s.serialize){for(const _ in o){if(!o.hasOwnProperty(_)||Ia[c].omit.indexOf(_)>=0)continue;const v=o[_];p[_]=Ia[c].shallow.indexOf(_)>=0?v:da(v,e)}o instanceof Error&&(p.message=o.message)}if(p.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(p.$name=c),p}throw new Error("can't serialize object of type "+typeof o)}function Fa(o){if(null==o||"boolean"==typeof o||"number"==typeof o||"string"==typeof o||o instanceof Boolean||o instanceof Number||o instanceof String||o instanceof Date||o instanceof RegExp||ua(o)||yc(o)||ArrayBuffer.isView(o)||o instanceof il)return o;if(Array.isArray(o))return o.map(Fa);if("object"==typeof o){const e=o.$name||"Object",{klass:s}=Ia[e];if(!s)throw new Error(`can't deserialize unregistered class ${e}`);if(s.deserialize)return s.deserialize(o);const c=Object.create(s.prototype);for(const p of Object.keys(o)){if("$name"===p)continue;const _=o[p];c[p]=Ia[e].shallow.indexOf(p)>=0?_:Fa(_)}return c}throw new Error("can't deserialize object of type "+typeof o)}class Hl{constructor(){this.first=!0}update(e,s){const c=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=c,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=c,!0):(this.lastFloorZoom>c?(this.lastIntegerZoom=c+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<c&&(this.lastIntegerZoom=c,this.lastIntegerZoomTime=s),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=c,!0))}}const yl=o=>o>=1536&&o<=1791,vl=o=>o>=1872&&o<=1919,Jc=o=>o>=2208&&o<=2303,Na=o=>o>=11904&&o<=12031,vc=o=>o>=12032&&o<=12255,xc=o=>o>=12272&&o<=12287,Da=o=>o>=12288&&o<=12351,xl=o=>o>=12352&&o<=12447,Gl=o=>o>=12448&&o<=12543,rl=o=>o>=12544&&o<=12591,Aa=o=>o>=12704&&o<=12735,bc=o=>o>=12736&&o<=12783,wc=o=>o>=12784&&o<=12799,q=o=>o>=12800&&o<=13055,F=o=>o>=13056&&o<=13311,L=o=>o>=13312&&o<=19903,X=o=>o>=19968&&o<=40959,de=o=>o>=40960&&o<=42127,Pe=o=>o>=42128&&o<=42191,it=o=>o>=44032&&o<=55215,xt=o=>o>=63744&&o<=64255,_n=o=>o>=64336&&o<=65023,di=o=>o>=65040&&o<=65055,sr=o=>o>=65072&&o<=65103,Mi=o=>o>=65104&&o<=65135,pr=o=>o>=65136&&o<=65279,cr=o=>o>=65280&&o<=65519;function es(o){for(const e of o)if(ts(e.charCodeAt(0)))return!0;return!1}function Ma(o){for(const e of o)if(!fr(e.charCodeAt(0)))return!1;return!0}function fr(o){return!(yl(o)||vl(o)||Jc(o)||_n(o)||pr(o))}function ts(o){return!(746!==o&&747!==o&&(o<4352||!(Aa(o)||rl(o)||sr(o)&&!(o>=65097&&o<=65103)||xt(o)||F(o)||Na(o)||bc(o)||!(!Da(o)||o>=12296&&o<=12305||o>=12308&&o<=12319||12336===o)||L(o)||X(o)||q(o)||(e=o,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(o)||(e=>e>=55216&&e<=55295)(o)||(e=>e>=4352&&e<=4607)(o)||it(o)||xl(o)||xc(o)||(e=>e>=12688&&e<=12703)(o)||vc(o)||wc(o)||Gl(o)&&12540!==o||!(!cr(o)||65288===o||65289===o||65293===o||o>=65306&&o<=65310||65339===o||65341===o||65343===o||o>=65371&&o<=65503||65507===o||o>=65512&&o<=65519)||!(!Mi(o)||o>=65112&&o<=65118||o>=65123&&o<=65126)||(e=>e>=5120&&e<=5759)(o)||(e=>e>=6320&&e<=6399)(o)||di(o)||(e=>e>=19904&&e<=19967)(o)||de(o)||Pe(o))));var e}function Wl(o){return!(ts(o)||(e=o,(s=e)>=128&&s<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(s=>s>=8192&&s<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(s=>s>=8448&&s<=8527)(e)||(s=>s>=8528&&s<=8591)(e)||(s=>s>=8960&&s<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(s=>s>=9216&&s<=9279)(e)&&9251!==e||(s=>s>=9280&&s<=9311)(e)||(s=>s>=9312&&s<=9471)(e)||(s=>s>=9632&&s<=9727)(e)||(s=>s>=9728&&s<=9983)(e)&&!(e>=9754&&e<=9759)||(s=>s>=11008&&s<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Da(e)||Gl(e)||(s=>s>=57344&&s<=63743)(e)||sr(e)||Mi(e)||cr(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,s}function bl(o){return o>=1424&&o<=2303||_n(o)||pr(o)}function Cc(o,e){return!(!e&&bl(o)||o>=2304&&o<=3583||o>=3840&&o<=4255||(s=o,s>=6016&&s<=6143));var s}function g(o){for(const e of o)if(bl(e.charCodeAt(0)))return!0;return!1}const i="deferred",u="loading",m="loaded";let b=null,w="unavailable",k=null;const Z=function(o){o&&"string"==typeof o&&o.indexOf("NetworkError")>-1&&(w="error"),b&&b(o)};function J(){se.fire(new Zt("pluginStateChange",{pluginStatus:w,pluginURL:k}))}const se=new On,he=function(){return w},be=function(){if(w!==i||!k)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");w=u,J(),k&&ie({url:k},o=>{o?Z(o):(w=m,J())})},Ce={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>w===m||null!=Ce.applyArabicShaping,isLoading:()=>w===u,setState(o){w=o.pluginStatus,k=o.pluginURL},isParsed:()=>null!=Ce.applyArabicShaping&&null!=Ce.processBidirectionalText&&null!=Ce.processStyledBidirectionalText,getPluginURL:()=>k};class Me{constructor(e,s){this.zoom=e,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new Hl,this.transition={})}isSupportedScript(e){return function(s,c){for(const p of s)if(!Cc(p.charCodeAt(0),c))return!1;return!0}(e,Ce.isLoaded())}crossFadingFactor(){return 0===this.fadeDuration?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,s=e-Math.floor(e),c=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*c}:{fromScale:.5,toScale:1,t:1-(1-c)*s}}}class Ve{constructor(e,s){this.property=e,this.value=s,this.expression=function(c,p){if(Yr(c))return new Lt(c,p);if(A(c)){const _=Se(c,p);if("error"===_.result)throw new Error(_.value.map(v=>`${v.key}: ${v.message}`).join(", "));return _.value}{let _=c;return"string"==typeof c&&"color"===p.type&&(_=Le.parse(c)),{kind:"constant",evaluate:()=>_}}}(void 0===s?e.specification.default:s,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,s,c){return this.property.possiblyEvaluate(this,e,s,c)}}class qe{constructor(e){this.property=e,this.value=new Ve(e,void 0)}transitioned(e,s){return new Be(this.property,this.value,s,Fe({},e.transition,this.transition),e.now)}untransitioned(){return new Be(this.property,this.value,null,{},0)}}class ht{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return bn(this._values[e].value.value)}setValue(e,s){this._values.hasOwnProperty(e)||(this._values[e]=new qe(this._values[e].property)),this._values[e].value=new Ve(this._values[e].property,null===s?void 0:bn(s))}getTransition(e){return bn(this._values[e].transition)}setTransition(e,s){this._values.hasOwnProperty(e)||(this._values[e]=new qe(this._values[e].property)),this._values[e].transition=bn(s)||void 0}serialize(){const e={};for(const s of Object.keys(this._values)){const c=this.getValue(s);void 0!==c&&(e[s]=c);const p=this.getTransition(s);void 0!==p&&(e[`${s}-transition`]=p)}return e}transitioned(e,s){const c=new Je(this._properties);for(const p of Object.keys(this._values))c._values[p]=this._values[p].transitioned(e,s._values[p]);return c}untransitioned(){const e=new Je(this._properties);for(const s of Object.keys(this._values))e._values[s]=this._values[s].untransitioned();return e}}class Be{constructor(e,s,c,p,_){const v=p.delay||0,T=p.duration||0;_=_||0,this.property=e,this.value=s,this.begin=_+v,this.end=this.begin+T,e.specification.transition&&(p.delay||p.duration)&&(this.prior=c)}possiblyEvaluate(e,s,c){const p=e.now||0,_=this.value.possiblyEvaluate(e,s,c),v=this.prior;if(v){if(p>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(p<this.begin)return v.possiblyEvaluate(e,s,c);{const T=(p-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,s,c),_,we(T))}}return _}}class Je{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,s,c){const p=new wt(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(e,s,c);return p}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class dt{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return bn(this._values[e].value)}setValue(e,s){this._values[e]=new Ve(this._values[e].property,null===s?void 0:bn(s))}serialize(){const e={};for(const s of Object.keys(this._values)){const c=this.getValue(s);void 0!==c&&(e[s]=c)}return e}possiblyEvaluate(e,s,c){const p=new wt(this._properties);for(const _ of Object.keys(this._values))p._values[_]=this._values[_].possiblyEvaluate(e,s,c);return p}}class _t{constructor(e,s,c){this.property=e,this.value=s,this.parameters=c}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,s,c,p){return this.property.evaluate(this.value,this.parameters,e,s,c,p)}}class wt{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class nt{constructor(e){this.specification=e}possiblyEvaluate(e,s){return e.expression.evaluate(s)}interpolate(e,s,c){const p=Io[this.specification.type];return p?p(e,s,c):e}}class Pt{constructor(e,s){this.specification=e,this.overrides=s}possiblyEvaluate(e,s,c,p){return new _t(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(s,null,{},c,p)}:e.expression,s)}interpolate(e,s,c){if("constant"!==e.value.kind||"constant"!==s.value.kind)return e;if(void 0===e.value.value||void 0===s.value.value)return new _t(this,{kind:"constant",value:void 0},e.parameters);const p=Io[this.specification.type];return p?new _t(this,{kind:"constant",value:p(e.value.value,s.value.value,c)},e.parameters):e}evaluate(e,s,c,p,_,v){return"constant"===e.kind?e.value:e.evaluate(s,c,p,_,v)}}class dn extends Pt{possiblyEvaluate(e,s,c,p){if(void 0===e.value)return new _t(this,{kind:"constant",value:void 0},s);if("constant"===e.expression.kind){const _=e.expression.evaluate(s,null,{},c,p),v="resolvedImage"===e.property.specification.type&&"string"!=typeof _?_.name:_,T=this._calculate(v,v,v,s);return new _t(this,{kind:"constant",value:T},s)}if("camera"===e.expression.kind){const _=this._calculate(e.expression.evaluate({zoom:s.zoom-1}),e.expression.evaluate({zoom:s.zoom}),e.expression.evaluate({zoom:s.zoom+1}),s);return new _t(this,{kind:"constant",value:_},s)}return new _t(this,e.expression,s)}evaluate(e,s,c,p,_,v){if("source"===e.kind){const T=e.evaluate(s,c,p,_,v);return this._calculate(T,T,T,s)}return"composite"===e.kind?this._calculate(e.evaluate({zoom:Math.floor(s.zoom)-1},c,p),e.evaluate({zoom:Math.floor(s.zoom)},c,p),e.evaluate({zoom:Math.floor(s.zoom)+1},c,p),s):e.value}_calculate(e,s,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:e,to:s,other:c}:{from:c,to:s,other:e}}interpolate(e){return e}}class wn{constructor(e){this.specification=e}possiblyEvaluate(e,s,c,p){if(void 0!==e.value){if("constant"===e.expression.kind){const _=e.expression.evaluate(s,null,{},c,p);return this._calculate(_,_,_,s)}return this._calculate(e.expression.evaluate(new Me(Math.floor(s.zoom-1),s)),e.expression.evaluate(new Me(Math.floor(s.zoom),s)),e.expression.evaluate(new Me(Math.floor(s.zoom+1),s)),s)}}_calculate(e,s,c,p){return p.zoom>p.zoomHistory.lastIntegerZoom?{from:e,to:s}:{from:c,to:s}}interpolate(e){return e}}class Rt{constructor(e){this.specification=e}possiblyEvaluate(e,s,c,p){return!!e.expression.evaluate(s,null,{},c,p)}interpolate(){return!1}}class sn{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in e){const c=e[s];c.specification.overridable&&this.overridableProperties.push(s);const p=this.defaultPropertyValues[s]=new Ve(c,void 0),_=this.defaultTransitionablePropertyValues[s]=new qe(c);this.defaultTransitioningPropertyValues[s]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=p.possiblyEvaluate({})}}}function $n(o,e){return 256*(o=Ae(Math.floor(o),0,255))+Ae(Math.floor(e),0,255)}Jn("DataDrivenProperty",Pt),Jn("DataConstantProperty",nt),Jn("CrossFadedDataDrivenProperty",dn),Jn("CrossFadedProperty",wn),Jn("ColorRampProperty",Rt);const Kn={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Gn{constructor(e,s){this._structArray=e,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Pn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,s){return e._trim(),s&&(e.isTransferred=!0,s.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const s=Object.create(this.prototype);return s.arrayBuffer=e.arrayBuffer,s.length=e.length,s.capacity=e.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Xn(o,e=1){let s=0,c=0;return{members:o.map(p=>{const _=Kn[p.type].BYTES_PER_ELEMENT,v=s=qi(s,Math.max(e,_)),T=p.components||1;return c=Math.max(c,_),s+=_*T,{name:p.name,type:p.type,components:T,offset:v}}),size:qi(s,Math.max(c,e)),alignment:e}}function qi(o,e){return Math.ceil(o/e)*e}class Li extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,s)}emplace(e,s,c){const p=2*e;return this.int16[p+0]=s,this.int16[p+1]=c,e}}Li.prototype.bytesPerElement=4,Jn("StructArrayLayout2i4",Li);class Hr extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,s,c,p)}emplace(e,s,c,p,_){const v=4*e;return this.int16[v+0]=s,this.int16[v+1]=c,this.int16[v+2]=p,this.int16[v+3]=_,e}}Hr.prototype.bytesPerElement=8,Jn("StructArrayLayout4i8",Hr);class $r extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,s,c,p,_,v,T)}emplace(e,s,c,p,_,v,T,M){const z=6*e,W=12*e,ee=3*e;return this.int16[z+0]=s,this.int16[z+1]=c,this.uint8[W+4]=p,this.uint8[W+5]=_,this.uint8[W+6]=v,this.uint8[W+7]=T,this.float32[ee+2]=M,e}}$r.prototype.bytesPerElement=12,Jn("StructArrayLayout2i4ub1f12",$r);class ki extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c){const p=this.length;return this.resize(p+1),this.emplace(p,e,s,c)}emplace(e,s,c,p){const _=3*e;return this.float32[_+0]=s,this.float32[_+1]=c,this.float32[_+2]=p,e}}ki.prototype.bytesPerElement=12,Jn("StructArrayLayout3f12",ki);class Qi extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T,M,z,W){const ee=this.length;return this.resize(ee+1),this.emplace(ee,e,s,c,p,_,v,T,M,z,W)}emplace(e,s,c,p,_,v,T,M,z,W,ee){const oe=10*e;return this.uint16[oe+0]=s,this.uint16[oe+1]=c,this.uint16[oe+2]=p,this.uint16[oe+3]=_,this.uint16[oe+4]=v,this.uint16[oe+5]=T,this.uint16[oe+6]=M,this.uint16[oe+7]=z,this.uint16[oe+8]=W,this.uint16[oe+9]=ee,e}}Qi.prototype.bytesPerElement=20,Jn("StructArrayLayout10ui20",Qi);class Qr extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T,M){const z=this.length;return this.resize(z+1),this.emplace(z,e,s,c,p,_,v,T,M)}emplace(e,s,c,p,_,v,T,M,z){const W=8*e;return this.uint16[W+0]=s,this.uint16[W+1]=c,this.uint16[W+2]=p,this.uint16[W+3]=_,this.uint16[W+4]=v,this.uint16[W+5]=T,this.uint16[W+6]=M,this.uint16[W+7]=z,e}}Qr.prototype.bytesPerElement=16,Jn("StructArrayLayout8ui16",Qr);class Ys extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt){const mt=this.length;return this.resize(mt+1),this.emplace(mt,e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt)}emplace(e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt,mt){const It=16*e;return this.int16[It+0]=s,this.int16[It+1]=c,this.int16[It+2]=p,this.int16[It+3]=_,this.uint16[It+4]=v,this.uint16[It+5]=T,this.uint16[It+6]=M,this.uint16[It+7]=z,this.int16[It+8]=W,this.int16[It+9]=ee,this.int16[It+10]=oe,this.int16[It+11]=fe,this.int16[It+12]=Re,this.int16[It+13]=ke,this.int16[It+14]=tt,this.int16[It+15]=mt,e}}Ys.prototype.bytesPerElement=32,Jn("StructArrayLayout4i4ui4i4i32",Ys);class Js extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint32[1*e+0]=s,e}}Js.prototype.bytesPerElement=4,Jn("StructArrayLayout1ul4",Js);class zo extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T,M,z,W,ee,oe,fe){const Re=this.length;return this.resize(Re+1),this.emplace(Re,e,s,c,p,_,v,T,M,z,W,ee,oe,fe)}emplace(e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re){const ke=20*e,tt=10*e;return this.int16[ke+0]=s,this.int16[ke+1]=c,this.int16[ke+2]=p,this.int16[ke+3]=_,this.int16[ke+4]=v,this.float32[tt+3]=T,this.float32[tt+4]=M,this.float32[tt+5]=z,this.float32[tt+6]=W,this.int16[ke+14]=ee,this.uint32[tt+8]=oe,this.uint16[ke+18]=fe,this.uint16[ke+19]=Re,e}}zo.prototype.bytesPerElement=40,Jn("StructArrayLayout5i4f1i1ul2ui40",zo);class Uo extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T){const M=this.length;return this.resize(M+1),this.emplace(M,e,s,c,p,_,v,T)}emplace(e,s,c,p,_,v,T,M){const z=8*e;return this.int16[z+0]=s,this.int16[z+1]=c,this.int16[z+2]=p,this.int16[z+4]=_,this.int16[z+5]=v,this.int16[z+6]=T,this.int16[z+7]=M,e}}Uo.prototype.bytesPerElement=16,Jn("StructArrayLayout3i2i2i16",Uo);class ds extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,s,c,p,_)}emplace(e,s,c,p,_,v){const T=4*e,M=8*e;return this.float32[T+0]=s,this.float32[T+1]=c,this.float32[T+2]=p,this.int16[M+6]=_,this.int16[M+7]=v,e}}ds.prototype.bytesPerElement=16,Jn("StructArrayLayout2f1f2i16",ds);class Ba extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,s,c,p)}emplace(e,s,c,p,_){const v=12*e,T=3*e;return this.uint8[v+0]=s,this.uint8[v+1]=c,this.float32[T+1]=p,this.float32[T+2]=_,e}}Ba.prototype.bytesPerElement=12,Jn("StructArrayLayout2ub2f12",Ba);class Zi extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c){const p=this.length;return this.resize(p+1),this.emplace(p,e,s,c)}emplace(e,s,c,p){const _=3*e;return this.uint16[_+0]=s,this.uint16[_+1]=c,this.uint16[_+2]=p,e}}Zi.prototype.bytesPerElement=6,Jn("StructArrayLayout3ui6",Zi);class eo extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt,mt,It,Ut,jt,qt){const Gt=this.length;return this.resize(Gt+1),this.emplace(Gt,e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt,mt,It,Ut,jt,qt)}emplace(e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt,mt,It,Ut,jt,qt,Gt){const gn=30*e,Dn=15*e,Rn=60*e;return this.int16[gn+0]=s,this.int16[gn+1]=c,this.int16[gn+2]=p,this.float32[Dn+2]=_,this.float32[Dn+3]=v,this.uint16[gn+8]=T,this.uint16[gn+9]=M,this.uint32[Dn+5]=z,this.uint32[Dn+6]=W,this.uint32[Dn+7]=ee,this.uint16[gn+16]=oe,this.uint16[gn+17]=fe,this.uint16[gn+18]=Re,this.float32[Dn+10]=ke,this.float32[Dn+11]=tt,this.uint8[Rn+48]=mt,this.uint8[Rn+49]=It,this.uint8[Rn+50]=Ut,this.uint32[Dn+13]=jt,this.int16[gn+28]=qt,this.uint8[Rn+58]=Gt,e}}eo.prototype.bytesPerElement=60,Jn("StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60",eo);class Ar extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt,mt,It,Ut,jt,qt,Gt,gn,Dn,Rn,Ln,vn,In,zn,Cn){const Si=this.length;return this.resize(Si+1),this.emplace(Si,e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt,mt,It,Ut,jt,qt,Gt,gn,Dn,Rn,Ln,vn,In,zn,Cn)}emplace(e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke,tt,mt,It,Ut,jt,qt,Gt,gn,Dn,Rn,Ln,vn,In,zn,Cn,Si){const Wn=38*e,Mr=19*e;return this.int16[Wn+0]=s,this.int16[Wn+1]=c,this.int16[Wn+2]=p,this.float32[Mr+2]=_,this.float32[Mr+3]=v,this.int16[Wn+8]=T,this.int16[Wn+9]=M,this.int16[Wn+10]=z,this.int16[Wn+11]=W,this.int16[Wn+12]=ee,this.int16[Wn+13]=oe,this.uint16[Wn+14]=fe,this.uint16[Wn+15]=Re,this.uint16[Wn+16]=ke,this.uint16[Wn+17]=tt,this.uint16[Wn+18]=mt,this.uint16[Wn+19]=It,this.uint16[Wn+20]=Ut,this.uint16[Wn+21]=jt,this.uint16[Wn+22]=qt,this.uint16[Wn+23]=Gt,this.uint16[Wn+24]=gn,this.uint16[Wn+25]=Dn,this.uint16[Wn+26]=Rn,this.uint16[Wn+27]=Ln,this.uint16[Wn+28]=vn,this.uint32[Mr+15]=In,this.float32[Mr+16]=zn,this.float32[Mr+17]=Cn,this.float32[Mr+18]=Si,e}}Ar.prototype.bytesPerElement=76,Jn("StructArrayLayout3i2f6i15ui1ul3f76",Ar);class Br extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.float32[1*e+0]=s,e}}Br.prototype.bytesPerElement=4,Jn("StructArrayLayout1f4",Br);class Vo extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,c){const p=this.length;return this.resize(p+1),this.emplace(p,e,s,c)}emplace(e,s,c,p){const _=3*e;return this.int16[_+0]=s,this.int16[_+1]=c,this.int16[_+2]=p,e}}Vo.prototype.bytesPerElement=6,Jn("StructArrayLayout3i6",Vo);class Gr extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,s,c,p)}emplace(e,s,c,p,_){const v=6*e;return this.uint32[3*e+0]=s,this.uint16[v+2]=c,this.uint16[v+3]=p,this.uint16[v+4]=_,e}}Gr.prototype.bytesPerElement=12,Jn("StructArrayLayout1ul3ui12",Gr);class Zo extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,s)}emplace(e,s,c){const p=2*e;return this.uint16[p+0]=s,this.uint16[p+1]=c,e}}Zo.prototype.bytesPerElement=4,Jn("StructArrayLayout2ui4",Zo);class Bs extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint16[1*e+0]=s,e}}Bs.prototype.bytesPerElement=2,Jn("StructArrayLayout1ui2",Bs);class hs extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,s,c,p,_)}emplace(e,s,c,p,_,v){const T=5*e;return this.float32[T+0]=s,this.float32[T+1]=c,this.float32[T+2]=p,this.float32[T+3]=_,this.float32[T+4]=v,e}}hs.prototype.bytesPerElement=20,Jn("StructArrayLayout5f20",hs);class Ks extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s){const c=this.length;return this.resize(c+1),this.emplace(c,e,s)}emplace(e,s,c){const p=2*e;return this.float32[p+0]=s,this.float32[p+1]=c,e}}Ks.prototype.bytesPerElement=8,Jn("StructArrayLayout2f8",Ks);class Yl extends Pn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,c,p){const _=this.length;return this.resize(_+1),this.emplace(_,e,s,c,p)}emplace(e,s,c,p,_){const v=4*e;return this.float32[v+0]=s,this.float32[v+1]=c,this.float32[v+2]=p,this.float32[v+3]=_,e}}Yl.prototype.bytesPerElement=16,Jn("StructArrayLayout4f16",Yl);class ha extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}ha.prototype.size=40;class wl extends zo{get(e){return new ha(this,e)}}Jn("CollisionBoxArray",wl);class fu extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}fu.prototype.size=60;class Cl extends eo{get(e){return new fu(this,e)}}Jn("PlacedSymbolArray",Cl);class Tl extends Gn{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Tl.prototype.size=76;class ah extends Ar{get(e){return new Tl(this,e)}}Jn("SymbolInstanceArray",ah);class Dp extends Br{getoffsetX(e){return this.float32[1*e+0]}}Jn("GlyphOffsetArray",Dp);class Ap extends Vo{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Jn("SymbolLineVertexArray",Ap);class Tc extends Gn{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Tc.prototype.size=12;class Kc extends Gr{get(e){return new Tc(this,e)}}Jn("FeatureIndexArray",Kc);class Mp extends Gn{get a_centroid_pos0(){return this._structArray.uint16[this._pos2+0]}get a_centroid_pos1(){return this._structArray.uint16[this._pos2+1]}}Mp.prototype.size=4;class Ag extends Zo{get(e){return new Mp(this,e)}}Jn("FillExtrusionCentroidArray",Ag);const Sp=Xn([{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"}]),Mg=Xn([{name:"a_dash_to",components:4,type:"Uint16"},{name:"a_dash_from",components:4,type:"Uint16"}]);var Sg=Ee(function(o){o.exports=function(e,s){var c,p,_,v,T,M,z,W;for(p=e.length-(c=3&e.length),_=s,T=3432918353,M=461845907,W=0;W<p;)z=255&e.charCodeAt(W)|(255&e.charCodeAt(++W))<<8|(255&e.charCodeAt(++W))<<16|(255&e.charCodeAt(++W))<<24,++W,_=27492+(65535&(v=5*(65535&(_=(_^=z=(65535&(z=(z=(65535&z)*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*M+(((z>>>16)*M&65535)<<16)&4294967295)<<13|_>>>19))+((5*(_>>>16)&65535)<<16)&4294967295))+((58964+(v>>>16)&65535)<<16);switch(z=0,c){case 3:z^=(255&e.charCodeAt(W+2))<<16;case 2:z^=(255&e.charCodeAt(W+1))<<8;case 1:_^=z=(65535&(z=(z=(65535&(z^=255&e.charCodeAt(W)))*T+(((z>>>16)*T&65535)<<16)&4294967295)<<15|z>>>17))*M+(((z>>>16)*M&65535)<<16)&4294967295}return _^=e.length,_=2246822507*(65535&(_^=_>>>16))+((2246822507*(_>>>16)&65535)<<16)&4294967295,_=3266489909*(65535&(_^=_>>>13))+((3266489909*(_>>>16)&65535)<<16)&4294967295,(_^=_>>>16)>>>0}}),Pg=Ee(function(o){o.exports=function(e,s){for(var c,p=e.length,_=s^p,v=0;p>=4;)c=1540483477*(65535&(c=255&e.charCodeAt(v)|(255&e.charCodeAt(++v))<<8|(255&e.charCodeAt(++v))<<16|(255&e.charCodeAt(++v))<<24))+((1540483477*(c>>>16)&65535)<<16),_=1540483477*(65535&_)+((1540483477*(_>>>16)&65535)<<16)^(c=1540483477*(65535&(c^=c>>>24))+((1540483477*(c>>>16)&65535)<<16)),p-=4,++v;switch(p){case 3:_^=(255&e.charCodeAt(v+2))<<16;case 2:_^=(255&e.charCodeAt(v+1))<<8;case 1:_=1540483477*(65535&(_^=255&e.charCodeAt(v)))+((1540483477*(_>>>16)&65535)<<16)}return _=1540483477*(65535&(_^=_>>>13))+((1540483477*(_>>>16)&65535)<<16),(_^=_>>>15)>>>0}}),gu=Sg,Rg=Pg;gu.murmur3=Sg,gu.murmur2=Rg;class Ec{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,s,c,p){this.ids.push(Ku(e)),this.positions.push(s,c,p)}getPositions(e){const s=Ku(e);let c=0,p=this.ids.length-1;for(;c<p;){const v=c+p>>1;this.ids[v]>=s?p=v:c=v+1}const _=[];for(;this.ids[c]===s;)_.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return _}static serialize(e,s){const c=new Float64Array(e.ids),p=new Uint32Array(e.positions);return Jl(c,p,0,c.length-1),s&&s.push(c.buffer,p.buffer),{ids:c,positions:p}}static deserialize(e){const s=new Ec;return s.ids=e.ids,s.positions=e.positions,s.indexed=!0,s}}function Ku(o){const e=+o;return!isNaN(e)&&e<=G?e:gu(String(o))}function Jl(o,e,s,c){for(;s<c;){const p=o[s+c>>1];let _=s-1,v=c+1;for(;;){do{_++}while(o[_]<p);do{v--}while(o[v]>p);if(_>=v)break;Xu(o,_,v),Xu(e,3*_,3*v),Xu(e,3*_+1,3*v+1),Xu(e,3*_+2,3*v+2)}v-s<c-v?(Jl(o,e,s,v),s=v+1):(Jl(o,e,v+1,c),c=v)}}function Xu(o,e,s){const c=o[e];o[e]=o[s],o[s]=c}Jn("FeaturePositionMap",Ec);class Kl{constructor(e,s){this.gl=e.gl,this.location=s}}class lh extends Kl{constructor(e,s){super(e,s),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class mu extends Kl{constructor(e,s){super(e,s),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Qu extends Kl{constructor(e,s){super(e,s),this.current=Le.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Pp=new Float32Array(16),Rp=new Float32Array(9);function ed(o){return[$n(255*o.r,255*o.g),$n(255*o.b,255*o.a)]}class za{constructor(e,s,c){this.value=e,this.uniformNames=s.map(p=>`u_${p}`),this.type=c}setUniform(e,s,c){e.set(c.constantOr(this.value))}getBinding(e,s,c){return"color"===this.type?new Qu(e,s):new lh(e,s)}}class Xc{constructor(e,s){this.uniformNames=s.map(c=>`u_${c}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=s.tl.concat(s.br),this.patternTo=e.tl.concat(e.br)}setUniform(e,s,c,p){const _="u_pattern_to"===p||"u_dash_to"===p?this.patternTo:"u_pattern_from"===p||"u_dash_from"===p?this.patternFrom:"u_pixel_ratio_to"===p?this.pixelRatioTo:"u_pixel_ratio_from"===p?this.pixelRatioFrom:null;_&&e.set(_)}getBinding(e,s,c){return"u_pattern_from"===c||"u_pattern_to"===c||"u_dash_from"===c||"u_dash_to"===c?new mu(e,s):new lh(e,s)}}class El{constructor(e,s,c,p){this.expression=e,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map(_=>({name:`a_${_}`,type:"Float32",components:"color"===c?2:1,offset:0})),this.paintVertexArray=new p}populatePaintArray(e,s,c,p,_){const v=this.paintVertexArray.length,T=this.expression.evaluate(new Me(0),s,{},p,[],_);this.paintVertexArray.resize(e),this._setPaintValue(v,e,T)}updatePaintArray(e,s,c,p){const _=this.expression.evaluate({zoom:0},c,p);this._setPaintValue(e,s,_)}_setPaintValue(e,s,c){if("color"===this.type){const p=ed(c);for(let _=e;_<s;_++)this.paintVertexArray.emplace(_,p[0],p[1])}else{for(let p=e;p<s;p++)this.paintVertexArray.emplace(p,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ua{constructor(e,s,c,p,_,v){this.expression=e,this.uniformNames=s.map(T=>`u_${T}_t`),this.type=c,this.useIntegerZoom=p,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=s.map(T=>({name:`a_${T}`,type:"Float32",components:"color"===c?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(e,s,c,p,_){const v=this.expression.evaluate(new Me(this.zoom),s,{},p,[],_),T=this.expression.evaluate(new Me(this.zoom+1),s,{},p,[],_),M=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(M,e,v,T)}updatePaintArray(e,s,c,p){const _=this.expression.evaluate({zoom:this.zoom},c,p),v=this.expression.evaluate({zoom:this.zoom+1},c,p);this._setPaintValue(e,s,_,v)}_setPaintValue(e,s,c,p){if("color"===this.type){const _=ed(c),v=ed(p);for(let T=e;T<s;T++)this.paintVertexArray.emplace(T,_[0],_[1],v[0],v[1])}else{for(let _=e;_<s;_++)this.paintVertexArray.emplace(_,c,p);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(p))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,s){const c=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,p=Ae(this.expression.interpolationFactor(c,this.zoom,this.zoom+1),0,1);e.set(p)}getBinding(e,s,c){return new lh(e,s)}}class Xl{constructor(e,s,c,p,_,v,T){this.expression=e,this.type=c,this.useIntegerZoom=p,this.zoom=_,this.layerId=T,this.paintVertexAttributes=("array"===c?Mg:Sp).members;for(let M=0;M<s.length;++M);this.zoomInPaintVertexArray=new v,this.zoomOutPaintVertexArray=new v}populatePaintArray(e,s,c){const p=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(p,e,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(e,s,c,p,_){this._setPaintValues(e,s,c.patterns&&c.patterns[this.layerId],_)}_setPaintValues(e,s,c,p){if(!p||!c)return;const{min:_,mid:v,max:T}=c,M=p[_],z=p[v],W=p[T];if(M&&z&&W)for(let ee=e;ee<s;ee++)this._setPaintValue(this.zoomInPaintVertexArray,ee,z,M),this._setPaintValue(this.zoomOutPaintVertexArray,ee,z,W)}_setPaintValue(e,s,c,p){e.emplace(s,c.tl[0],c.tl[1],c.br[0],c.br[1],p.tl[0],p.tl[1],p.br[0],p.br[1],c.pixelRatio,p.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Il{constructor(e,s,c=(()=>!0)){this.binders={},this._buffers=[];const p=[];for(const _ in e.paint._values){if(!c(_))continue;const v=e.paint.get(_);if(!(v instanceof _t&&aa(v.property.specification)))continue;const T=Op(_,e.type),M=v.value,z=v.property.specification.type,W=v.property.useIntegerZoom,ee=v.property.specification["property-type"],oe="cross-faded"===ee||"cross-faded-data-driven"===ee,fe="line-dasharray"===String(_)&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==M.kind||fe)if("source"===M.kind||fe||oe){const Re=Lp(_,z,"source");this.binders[_]=oe?new Xl(M,T,z,W,s,Re,e.id):new El(M,T,z,Re),p.push(`/a_${_}`)}else{const Re=Lp(_,z,"composite");this.binders[_]=new Ua(M,T,z,W,s,Re),p.push(`/z_${_}`)}else this.binders[_]=oe?new Xc(M.value,T):new za(M.value,T,z),p.push(`/u_${_}`)}this.cacheKey=p.sort().join("")}getMaxValue(e){const s=this.binders[e];return s instanceof El||s instanceof Ua?s.maxValue:0}populatePaintArrays(e,s,c,p,_){for(const v in this.binders){const T=this.binders[v];(T instanceof El||T instanceof Ua||T instanceof Xl)&&T.populatePaintArray(e,s,c,p,_)}}setConstantPatternPositions(e,s){for(const c in this.binders){const p=this.binders[c];p instanceof Xc&&p.setConstantPatternPositions(e,s)}}updatePaintArrays(e,s,c,p,_){let v=!1;for(const T in e){const M=s.getPositions(T);for(const z of M){const W=c.feature(z.index);for(const ee in this.binders){const oe=this.binders[ee];if((oe instanceof El||oe instanceof Ua||oe instanceof Xl)&&!0===oe.expression.isStateDependent){const fe=p.paint.get(ee);oe.expression=fe.value,oe.updatePaintArray(z.start,z.end,W,e[T],_),v=!0}}}}return v}defines(){const e=[];for(const s in this.binders){const c=this.binders[s];(c instanceof za||c instanceof Xc)&&e.push(...c.uniformNames.map(p=>`#define HAS_UNIFORM_${p}`))}return e}getBinderAttributes(){const e=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof El||c instanceof Ua||c instanceof Xl)for(let p=0;p<c.paintVertexAttributes.length;p++)e.push(c.paintVertexAttributes[p].name)}return e}getBinderUniforms(){const e=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof za||c instanceof Xc||c instanceof Ua)for(const p of c.uniformNames)e.push(p)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,s){const c=[];for(const p in this.binders){const _=this.binders[p];if(_ instanceof za||_ instanceof Xc||_ instanceof Ua)for(const v of _.uniformNames)if(s[v]){const T=_.getBinding(e,s[v],v);c.push({name:v,property:p,binding:T})}}return c}setUniforms(e,s,c,p){for(const{name:_,property:v,binding:T}of s)this.binders[v].setUniform(T,p,c.get(v),_)}updatePaintBuffers(e){this._buffers=[];for(const s in this.binders){const c=this.binders[s];if(e&&c instanceof Xl){const p=2===e.fromScale?c.zoomInPaintVertexBuffer:c.zoomOutPaintVertexBuffer;p&&this._buffers.push(p)}else(c instanceof El||c instanceof Ua)&&c.paintVertexBuffer&&this._buffers.push(c.paintVertexBuffer)}}upload(e){for(const s in this.binders){const c=this.binders[s];(c instanceof El||c instanceof Ua||c instanceof Xl)&&c.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const s=this.binders[e];(s instanceof El||s instanceof Ua||s instanceof Xl)&&s.destroy()}}}class zs{constructor(e,s,c=(()=>!0)){this.programConfigurations={};for(const p of e)this.programConfigurations[p.id]=new Il(p,s,c);this.needsUpload=!1,this._featureMap=new Ec,this._bufferOffset=0}populatePaintArrays(e,s,c,p,_,v){for(const T in this.programConfigurations)this.programConfigurations[T].populatePaintArrays(e,s,p,_,v);void 0!==s.id&&this._featureMap.add(s.id,c,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,s,c,p){for(const _ of c)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,s,_,p)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const Qc={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"line-dasharray":["dash_to","dash_from"]};function Op(o,e){return Qc[o]||[o.replace(`${e}-`,"").replace(/-/g,"_")]}const Og={"line-pattern":{source:Qi,composite:Qi},"fill-pattern":{source:Qi,composite:Qi},"fill-extrusion-pattern":{source:Qi,composite:Qi},"line-dasharray":{source:Qr,composite:Qr}},Lg={color:{source:Ks,composite:Yl},number:{source:Br,composite:Ks}};function Lp(o,e,s){const c=Og[o];return c&&c[s]||Lg[e][s]}Jn("ConstantBinder",za),Jn("CrossFadedConstantBinder",Xc),Jn("SourceExpressionBinder",El),Jn("CrossFadedCompositeBinder",Xl),Jn("CompositeExpressionBinder",Ua),Jn("ProgramConfiguration",Il,{omit:["_buffers"]}),Jn("ProgramConfigurationSet",zs);const td="-transition";class Va extends On{constructor(e,s){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},"custom"!==e.type&&(this.metadata=(e=e).metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),s.layout&&(this._unevaluatedLayout=new dt(s.layout)),s.paint)){this._transitionablePaint=new ht(s.paint);for(const c in e.paint)this.setPaintProperty(c,e.paint[c],{validate:!1});for(const c in e.layout)this.setLayoutProperty(c,e.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new wt(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,s,c={}){null!=s&&this._validate(nl,`layers.${this.id}.layout.${e}`,e,s,c)||("visibility"!==e?this._unevaluatedLayout.setValue(e,s):this.visibility=s)}getPaintProperty(e){return ut(e,td)?this._transitionablePaint.getTransition(e.slice(0,-td.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,s,c={}){if(null!=s&&this._validate(Ea,`layers.${this.id}.paint.${e}`,e,s,c))return!1;if(ut(e,td))return this._transitionablePaint.setTransition(e.slice(0,-td.length),s||void 0),!1;{const p=this._transitionablePaint._values[e],_="cross-faded-data-driven"===p.property.specification["property-type"],v=p.value.isDataDriven(),T=p.value;this._transitionablePaint.setValue(e,s),this._handleSpecialPaintPropertyUpdate(e);const M=this._transitionablePaint._values[e].value;return M.isDataDriven()||v||_||this._handleOverridablePaintPropertyUpdate(e,T,M)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,s,c){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,s){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,s)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Vt(e,(s,c)=>!(void 0===s||"layout"===c&&!Object.keys(s).length||"paint"===c&&!Object.keys(s).length))}_validate(e,s,c,p,_={}){return(!_||!1!==_.validate)&&_c(this,e.call(Fs,{key:s,layerType:this.type,objectKey:c,value:p,styleSpec:at,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const s=this.paint.get(e);if(s instanceof _t&&aa(s.property.specification)&&("source"===s.value.kind||"composite"===s.value.kind)&&s.value.isStateDependent)return!0}return!1}}const kp=Xn([{name:"a_pos",components:2,type:"Int16"}],4),{members:kg}=kp;class ps{constructor(e=[]){this.segments=e}prepareSegment(e,s,c,p){let _=this.segments[this.segments.length-1];return e>ps.MAX_VERTEX_ARRAY_LENGTH&&Bt(`Max vertices per segment is ${ps.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!_||_.vertexLength+e>ps.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==p)&&(_={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==p&&(_.sortKey=p),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const e of this.segments)for(const s in e.vaos)e.vaos[s].destroy()}static simpleSegment(e,s,c,p){return new ps([{vertexOffset:e,primitiveOffset:s,vertexLength:c,primitiveLength:p,vaos:{},sortKey:0}])}}ps.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Jn("SegmentVector",ps);var Rr=8192;const ch=Math.pow(2,14)-1,Fg=-ch-1;function Ic(o){const e=Rr/o.extent,s=o.loadGeometry();for(let c=0;c<s.length;c++){const p=s[c];for(let _=0;_<p.length;_++){const v=p[_],T=Math.round(v.x*e),M=Math.round(v.y*e);v.x=Ae(T,Fg,ch),v.y=Ae(M,Fg,ch),(T<v.x||T>v.x+1||M<v.y||M>v.y+1)&&Bt("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function Za(o,e){return{type:o.type,id:o.id,properties:o.properties,geometry:e?Ic(o):[]}}function _u(o,e,s,c,p){o.emplaceBack(2*e+(c+1)/2,2*s+(p+1)/2)}class Sa{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Li,this.indexArray=new Zi,this.segments=new ps,this.programConfigurations=new zs(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(e,s,c){const p=this.layers[0],_=[];let v=null;"circle"===p.type&&(v=p.layout.get("circle-sort-key"));for(const{feature:T,id:M,index:z,sourceLayerIndex:W}of e){const ee=this.layers[0]._featureFilter.needGeometry,oe=Za(T,ee);if(!this.layers[0]._featureFilter.filter(new Me(this.zoom),oe,c))continue;const fe=v?v.evaluate(oe,{},c):void 0,Re={id:M,properties:T.properties,type:T.type,sourceLayerIndex:W,index:z,geometry:ee?oe.geometry:Ic(T),patterns:{},sortKey:fe};_.push(Re)}v&&_.sort((T,M)=>T.sortKey-M.sortKey);for(const T of _){const{geometry:M,index:z,sourceLayerIndex:W}=T,ee=e[z].feature;this.addFeature(T,M,z,c),s.featureIndex.insert(ee,M,z,W,this.index)}}update(e,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,kg),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,s,c,p){for(const _ of s)for(const v of _){const T=v.x,M=v.y;if(T<0||T>=Rr||M<0||M>=Rr)continue;const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),W=z.vertexLength;_u(this.layoutVertexArray,T,M,-1,-1),_u(this.layoutVertexArray,T,M,1,-1),_u(this.layoutVertexArray,T,M,1,1),_u(this.layoutVertexArray,T,M,-1,1),this.indexArray.emplaceBack(W,W+1,W+2),this.indexArray.emplaceBack(W,W+3,W+2),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{},p)}}function eu(o,e){for(let s=0;s<o.length;s++)if(Ql(e,o[s]))return!0;for(let s=0;s<e.length;s++)if(Ql(o,e[s]))return!0;return!!Bp(o,e)}function Fp(o,e,s){return!!Ql(o,e)||!!zp(e,o,s)}function uh(o,e){if(1===o.length)return id(e,o[0]);for(let s=0;s<e.length;s++){const c=e[s];for(let p=0;p<c.length;p++)if(Ql(o,c[p]))return!0}for(let s=0;s<o.length;s++)if(id(e,o[s]))return!0;for(let s=0;s<e.length;s++)if(Bp(o,e[s]))return!0;return!1}function Np(o,e,s){if(o.length>1){if(Bp(o,e))return!0;for(let c=0;c<e.length;c++)if(zp(e[c],o,s))return!0}for(let c=0;c<o.length;c++)if(zp(o[c],e,s))return!0;return!1}function Bp(o,e){if(0===o.length||0===e.length)return!1;for(let s=0;s<o.length-1;s++){const c=o[s],p=o[s+1];for(let _=0;_<e.length-1;_++)if(sy(c,p,e[_],e[_+1]))return!0}return!1}function sy(o,e,s,c){return Mt(o,s,c)!==Mt(e,s,c)&&Mt(o,e,s)!==Mt(o,e,c)}function zp(o,e,s){const c=s*s;if(1===e.length)return o.distSqr(e[0])<c;for(let p=1;p<e.length;p++)if(nd(o,e[p-1],e[p])<c)return!0;return!1}function nd(o,e,s){const c=e.distSqr(s);if(0===c)return o.distSqr(e);const p=((o.x-e.x)*(s.x-e.x)+(o.y-e.y)*(s.y-e.y))/c;return o.distSqr(p<0?e:p>1?s:s.sub(e)._mult(p)._add(e))}function id(o,e){let s,c,p,_=!1;for(let v=0;v<o.length;v++){s=o[v];for(let T=0,M=s.length-1;T<s.length;M=T++)c=s[T],p=s[M],c.y>e.y!=p.y>e.y&&e.x<(p.x-c.x)*(e.y-c.y)/(p.y-c.y)+c.x&&(_=!_)}return _}function Ql(o,e){let s=!1;for(let c=0,p=o.length-1;c<o.length;p=c++){const _=o[c],v=o[p];_.y>e.y!=v.y>e.y&&e.x<(v.x-_.x)*(e.y-_.y)/(v.y-_.y)+_.x&&(s=!s)}return s}function Ng(o,e,s,c,p){for(const v of o)if(e<=v.x&&s<=v.y&&c>=v.x&&p>=v.y)return!0;const _=[new H(e,s),new H(e,p),new H(c,p),new H(c,s)];if(o.length>2)for(const v of _)if(Ql(o,v))return!0;for(let v=0;v<o.length-1;v++)if(ay(o[v],o[v+1],_))return!0;return!1}function ay(o,e,s){const c=s[0],p=s[2];if(o.x<c.x&&e.x<c.x||o.x>p.x&&e.x>p.x||o.y<c.y&&e.y<c.y||o.y>p.y&&e.y>p.y)return!1;const _=Mt(o,e,s[0]);return _!==Mt(o,e,s[1])||_!==Mt(o,e,s[2])||_!==Mt(o,e,s[3])}function Dc(o,e,s){const c=e.paint.get(o).value;return"constant"===c.kind?c.value:s.programConfigurations.get(e.id).getMaxValue(o)}function rd(o){return Math.sqrt(o[0]*o[0]+o[1]*o[1])}function Up(o,e,s,c,p){if(!e[0]&&!e[1])return o;const _=H.convert(e)._mult(p);"viewport"===s&&_._rotate(-c);const v=[];for(let T=0;T<o.length;T++)v.push(o[T].sub(_));return v}function Vp(o,e,s,c){const p=H.convert(o)._mult(c);return"viewport"===e&&p._rotate(-s),p}Jn("CircleBucket",Sa,{omit:["layers"]});const Bg=new sn({"circle-sort-key":new Pt(at.layout_circle["circle-sort-key"])});var Zp={paint:new sn({"circle-radius":new Pt(at.paint_circle["circle-radius"]),"circle-color":new Pt(at.paint_circle["circle-color"]),"circle-blur":new Pt(at.paint_circle["circle-blur"]),"circle-opacity":new Pt(at.paint_circle["circle-opacity"]),"circle-translate":new nt(at.paint_circle["circle-translate"]),"circle-translate-anchor":new nt(at.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new nt(at.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new nt(at.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new Pt(at.paint_circle["circle-stroke-width"]),"circle-stroke-color":new Pt(at.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new Pt(at.paint_circle["circle-stroke-opacity"])}),layout:Bg},fs="undefined"!=typeof Float32Array?Float32Array:Array;function dh(){var o=new fs(9);return fs!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[5]=0,o[6]=0,o[7]=0),o[0]=1,o[4]=1,o[8]=1,o}function yu(o){return o[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o}function $p(o,e,s){var c=e[0],p=e[1],_=e[2],v=e[3],T=e[4],M=e[5],z=e[6],W=e[7],ee=e[8],oe=e[9],fe=e[10],Re=e[11],ke=e[12],tt=e[13],mt=e[14],It=e[15],Ut=s[0],jt=s[1],qt=s[2],Gt=s[3];return o[0]=Ut*c+jt*T+qt*ee+Gt*ke,o[1]=Ut*p+jt*M+qt*oe+Gt*tt,o[2]=Ut*_+jt*z+qt*fe+Gt*mt,o[3]=Ut*v+jt*W+qt*Re+Gt*It,o[4]=(Ut=s[4])*c+(jt=s[5])*T+(qt=s[6])*ee+(Gt=s[7])*ke,o[5]=Ut*p+jt*M+qt*oe+Gt*tt,o[6]=Ut*_+jt*z+qt*fe+Gt*mt,o[7]=Ut*v+jt*W+qt*Re+Gt*It,o[8]=(Ut=s[8])*c+(jt=s[9])*T+(qt=s[10])*ee+(Gt=s[11])*ke,o[9]=Ut*p+jt*M+qt*oe+Gt*tt,o[10]=Ut*_+jt*z+qt*fe+Gt*mt,o[11]=Ut*v+jt*W+qt*Re+Gt*It,o[12]=(Ut=s[12])*c+(jt=s[13])*T+(qt=s[14])*ee+(Gt=s[15])*ke,o[13]=Ut*p+jt*M+qt*oe+Gt*tt,o[14]=Ut*_+jt*z+qt*fe+Gt*mt,o[15]=Ut*v+jt*W+qt*Re+Gt*It,o}Math.hypot||(Math.hypot=function(){for(var o=0,e=arguments.length;e--;)o+=arguments[e]*arguments[e];return Math.sqrt(o)});var Co=$p;function od(){var o=new fs(3);return fs!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o}function jp(o){return Math.hypot(o[0],o[1],o[2])}function ec(o,e,s){var c=new fs(3);return c[0]=o,c[1]=e,c[2]=s,c}function hh(o,e,s){return o[0]=e[0]-s[0],o[1]=e[1]-s[1],o[2]=e[2]-s[2],o}function qp(o,e,s){return o[0]=e[0]*s[0],o[1]=e[1]*s[1],o[2]=e[2]*s[2],o}function Hp(o,e,s,c){return o[0]=e[0]+s[0]*c,o[1]=e[1]+s[1]*c,o[2]=e[2]+s[2]*c,o}function Gp(o,e){var s=e[0],c=e[1],p=e[2],_=s*s+c*c+p*p;return _>0&&(_=1/Math.sqrt(_)),o[0]=e[0]*_,o[1]=e[1]*_,o[2]=e[2]*_,o}function Wp(o,e,s){var c=s[0],p=s[1],_=s[2],v=e[0],T=e[1],M=e[2],z=p*M-_*T,W=_*v-c*M,ee=c*T-p*v,oe=p*ee-_*W,fe=_*z-c*ee,Re=c*W-p*z,ke=2*s[3];return W*=ke,ee*=ke,fe*=2,Re*=2,o[0]=v+(z*=ke)+(oe*=2),o[1]=T+W+fe,o[2]=M+ee+Re,o}var vu,ly=hh,cy=qp,xu=jp;function Ho(o,e,s){var c=e[0],p=e[1],_=e[2],v=e[3];return o[0]=s[0]*c+s[4]*p+s[8]*_+s[12]*v,o[1]=s[1]*c+s[5]*p+s[9]*_+s[13]*v,o[2]=s[2]*c+s[6]*p+s[10]*_+s[14]*v,o[3]=s[3]*c+s[7]*p+s[11]*_+s[15]*v,o}function bu(){var o=new fs(4);return fs!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0),o[3]=1,o}function ph(o){return o[0]=0,o[1]=0,o[2]=0,o[3]=1,o}function fh(o,e,s){s*=.5;var c=e[0],p=e[1],_=e[2],v=e[3],T=Math.sin(s),M=Math.cos(s);return o[0]=c*M+v*T,o[1]=p*M+_*T,o[2]=_*M-p*T,o[3]=v*M-c*T,o}function gs(o,e,s,c,p,_,v,T,M){if(_&&o.queryGeometry.isAboveHorizon)return!1;_&&(M*=o.pixelToTileUnitsFactor);for(const z of e)for(const W of z){const ee=W.add(T),oe=p&&s.elevation?s.elevation.exaggeration()*p.getElevationAt(ee.x,ee.y,!0):0,fe=_?ee:wu(ee,oe,c),Re=_?o.tilespaceRays.map(tt=>Ug(tt,oe)):o.queryGeometry.screenGeometry,ke=Ho([],[W.x,W.y,oe,1],c);if(!v&&_?M*=ke[3]/s.cameraToCenterDistance:v&&!_&&(M*=s.cameraToCenterDistance/ke[3]),Fp(Re,fe,M))return!0}return!1}function wu(o,e,s){const c=Ho([],[o.x,o.y,e,1],s);return new H(c[0]/c[3],c[1]/c[3])}od(),vu=new fs(4),fs!=Float32Array&&(vu[0]=0,vu[1]=0,vu[2]=0,vu[3]=0),od(),ec(1,0,0),ec(0,1,0),bu(),bu(),dh();const sd=ec(0,0,0),zg=ec(0,0,1);function Ug(o,e){const s=od();return sd[2]=e,o.intersectsPlane(sd,zg,s),new H(s[0],s[1])}class gh extends Sa{}function mh(o,{width:e,height:s},c,p){if(p){if(p instanceof Uint8ClampedArray)p=new Uint8Array(p.buffer);else if(p.length!==e*s*c)throw new RangeError("mismatched image size")}else p=new Uint8Array(e*s*c);return o.width=e,o.height=s,o.data=p,o}function _h(o,{width:e,height:s},c){if(e===o.width&&s===o.height)return;const p=mh({},{width:e,height:s},c);yh(o,p,{x:0,y:0},{x:0,y:0},{width:Math.min(o.width,e),height:Math.min(o.height,s)},c),o.width=e,o.height=s,o.data=p.data}function yh(o,e,s,c,p,_){if(0===p.width||0===p.height)return e;if(p.width>o.width||p.height>o.height||s.x>o.width-p.width||s.y>o.height-p.height)throw new RangeError("out of range source coordinates for image copy");if(p.width>e.width||p.height>e.height||c.x>e.width-p.width||c.y>e.height-p.height)throw new RangeError("out of range destination coordinates for image copy");const v=o.data,T=e.data;for(let M=0;M<p.height;M++){const z=((s.y+M)*o.width+s.x)*_,W=((c.y+M)*e.width+c.x)*_;for(let ee=0;ee<p.width*_;ee++)T[W+ee]=v[z+ee]}return e}Jn("HeatmapBucket",gh,{omit:["layers"]});class Dl{constructor(e,s){mh(this,e,1,s)}resize(e){_h(this,e,1)}clone(){return new Dl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,c,p,_){yh(e,s,c,p,_,1)}}class pa{constructor(e,s){mh(this,e,4,s)}resize(e){_h(this,e,4)}replace(e,s){s?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new pa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,c,p,_){yh(e,s,c,p,_,4)}}Jn("AlphaImage",Dl),Jn("RGBAImage",pa);var Vg={paint:new sn({"heatmap-radius":new Pt(at.paint_heatmap["heatmap-radius"]),"heatmap-weight":new Pt(at.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new nt(at.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Rt(at.paint_heatmap["heatmap-color"]),"heatmap-opacity":new nt(at.paint_heatmap["heatmap-opacity"])})};function vh(o){const e={},s=o.resolution||256,c=o.clips?o.clips.length:1,p=o.image||new pa({width:s,height:c}),_=(v,T,M)=>{e[o.evaluationKey]=M;const z=o.expression.evaluate(e);p.data[v+T+0]=Math.floor(255*z.r/z.a),p.data[v+T+1]=Math.floor(255*z.g/z.a),p.data[v+T+2]=Math.floor(255*z.b/z.a),p.data[v+T+3]=Math.floor(255*z.a)};if(o.clips)for(let v=0,T=0;v<c;++v,T+=4*s)for(let M=0,z=0;M<s;M++,z+=4){const W=M/(s-1),{start:ee,end:oe}=o.clips[v];_(T,z,ee*(1-W)+oe*W)}else for(let v=0,T=0;v<s;v++,T+=4)_(0,T,v/(s-1));return p}var Yp={paint:new sn({"hillshade-illumination-direction":new nt(at.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new nt(at.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new nt(at.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new nt(at.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new nt(at.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new nt(at.paint_hillshade["hillshade-accent-color"])})};const xh=Xn([{name:"a_pos",components:2,type:"Int16"}],4),{members:Jp}=xh;var bh=Cu,uy=Cu;function Cu(o,e,s){s=s||2;var c,p,_,v,T,M,z,W=e&&e.length,ee=W?e[0]*s:o.length,oe=Tu(o,0,ee,s,!0),fe=[];if(!oe||oe.next===oe.prev)return fe;if(W&&(oe=function(ke,tt,mt,It){var Ut,jt,qt,Gt=[];for(Ut=0,jt=tt.length;Ut<jt;Ut++)(qt=Tu(ke,tt[Ut]*It,Ut<jt-1?tt[Ut+1]*It:ke.length,It,!1))===qt.next&&(qt.steiner=!0),Gt.push(Kp(qt));for(Gt.sort(qg),Ut=0;Ut<Gt.length;Ut++)Hg(Gt[Ut],mt),mt=tc(mt,mt.next);return mt}(o,e,oe,s)),o.length>80*s){c=_=o[0],p=v=o[1];for(var Re=s;Re<ee;Re+=s)(T=o[Re])<c&&(c=T),(M=o[Re+1])<p&&(p=M),T>_&&(_=T),M>v&&(v=M);z=0!==(z=Math.max(_-c,v-p))?1/z:0}return Eu(oe,fe,s,c,p,z),fe}function Tu(o,e,s,c,p){var _,v;if(p===Qp(o,e,s,c)>0)for(_=e;_<s;_+=c)v=Wg(_,o[_],o[_+1],v);else for(_=s-c;_>=e;_-=c)v=Wg(_,o[_],o[_+1],v);return v&&Iu(v,v.next)&&(ud(v),v=v.next),v}function tc(o,e){if(!o)return o;e||(e=o);var s,c=o;do{if(s=!1,c.steiner||!Iu(c,c.next)&&0!==uo(c.prev,c,c.next))c=c.next;else{if(ud(c),(c=e=c.prev)===c.next)break;s=!0}}while(s||c!==e);return e}function Eu(o,e,s,c,p,_,v){if(o){!v&&_&&function(W,ee,oe,fe){var Re=W;do{null===Re.z&&(Re.z=Xs(Re.x,Re.y,ee,oe,fe)),Re.prevZ=Re.prev,Re.nextZ=Re.next,Re=Re.next}while(Re!==W);Re.prevZ.nextZ=null,Re.prevZ=null,function(ke){var tt,mt,It,Ut,jt,qt,Gt,gn,Dn=1;do{for(mt=ke,ke=null,jt=null,qt=0;mt;){for(qt++,It=mt,Gt=0,tt=0;tt<Dn&&(Gt++,It=It.nextZ);tt++);for(gn=Dn;Gt>0||gn>0&&It;)0!==Gt&&(0===gn||!It||mt.z<=It.z)?(Ut=mt,mt=mt.nextZ,Gt--):(Ut=It,It=It.nextZ,gn--),jt?jt.nextZ=Ut:ke=Ut,Ut.prevZ=jt,jt=Ut;mt=It}jt.nextZ=null,Dn*=2}while(qt>1)}(Re)}(o,c,p,_);for(var T,M,z=o;o.prev!==o.next;)if(T=o.prev,M=o.next,_?Zg(o,c,p,_):tu(o))e.push(T.i/s),e.push(o.i/s),e.push(M.i/s),ud(o),o=M.next,z=M.next;else if((o=M)===z){v?1===v?Eu(o=$g(tc(o),e,s),e,s,c,p,_,2):2===v&&jg(o,e,s,c,p,_):Eu(tc(o),e,s,c,p,_,1);break}}}function tu(o){var e=o.prev,s=o,c=o.next;if(uo(e,s,c)>=0)return!1;for(var p=o.next.next;p!==o.prev;){if(nu(e.x,e.y,s.x,s.y,c.x,c.y,p.x,p.y)&&uo(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Zg(o,e,s,c){var p=o.prev,_=o,v=o.next;if(uo(p,_,v)>=0)return!1;for(var T=p.x>_.x?p.x>v.x?p.x:v.x:_.x>v.x?_.x:v.x,M=p.y>_.y?p.y>v.y?p.y:v.y:_.y>v.y?_.y:v.y,z=Xs(p.x<_.x?p.x<v.x?p.x:v.x:_.x<v.x?_.x:v.x,p.y<_.y?p.y<v.y?p.y:v.y:_.y<v.y?_.y:v.y,e,s,c),W=Xs(T,M,e,s,c),ee=o.prevZ,oe=o.nextZ;ee&&ee.z>=z&&oe&&oe.z<=W;){if(ee!==o.prev&&ee!==o.next&&nu(p.x,p.y,_.x,_.y,v.x,v.y,ee.x,ee.y)&&uo(ee.prev,ee,ee.next)>=0||(ee=ee.prevZ,oe!==o.prev&&oe!==o.next&&nu(p.x,p.y,_.x,_.y,v.x,v.y,oe.x,oe.y)&&uo(oe.prev,oe,oe.next)>=0))return!1;oe=oe.nextZ}for(;ee&&ee.z>=z;){if(ee!==o.prev&&ee!==o.next&&nu(p.x,p.y,_.x,_.y,v.x,v.y,ee.x,ee.y)&&uo(ee.prev,ee,ee.next)>=0)return!1;ee=ee.prevZ}for(;oe&&oe.z<=W;){if(oe!==o.prev&&oe!==o.next&&nu(p.x,p.y,_.x,_.y,v.x,v.y,oe.x,oe.y)&&uo(oe.prev,oe,oe.next)>=0)return!1;oe=oe.nextZ}return!0}function $g(o,e,s){var c=o;do{var p=c.prev,_=c.next.next;!Iu(p,_)&&Xp(p,c,c.next,_)&&ol(p,_)&&ol(_,p)&&(e.push(p.i/s),e.push(c.i/s),e.push(_.i/s),ud(c),ud(c.next),c=o=_),c=c.next}while(c!==o);return tc(c)}function jg(o,e,s,c,p,_){var v=o;do{for(var T=v.next.next;T!==v.prev;){if(v.i!==T.i&&Gg(v,T)){var M=$a(v,T);return v=tc(v,v.next),M=tc(M,M.next),Eu(v,e,s,c,p,_),void Eu(M,e,s,c,p,_)}T=T.next}v=v.next}while(v!==o)}function qg(o,e){return o.x-e.x}function Hg(o,e){if(e=function(c,p){var _,v=p,T=c.x,M=c.y,z=-1/0;do{if(M<=v.y&&M>=v.next.y&&v.next.y!==v.y){var W=v.x+(M-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(W<=T&&W>z){if(z=W,W===T){if(M===v.y)return v;if(M===v.next.y)return v.next}_=v.x<v.next.x?v:v.next}}v=v.next}while(v!==p);if(!_)return null;if(T===z)return _;var ee,oe=_,fe=_.x,Re=_.y,ke=1/0;v=_;do{T>=v.x&&v.x>=fe&&T!==v.x&&nu(M<Re?T:z,M,fe,Re,M<Re?z:T,M,v.x,v.y)&&(ee=Math.abs(M-v.y)/(T-v.x),ol(v,c)&&(ee<ke||ee===ke&&(v.x>_.x||v.x===_.x&&ad(_,v)))&&(_=v,ke=ee)),v=v.next}while(v!==oe);return _}(o,e)){var s=$a(e,o);tc(e,e.next),tc(s,s.next)}}function ad(o,e){return uo(o.prev,o,e.prev)<0&&uo(e.next,o,o.next)<0}function Xs(o,e,s,c,p){return(o=1431655765&((o=858993459&((o=252645135&((o=16711935&((o=32767*(o-s)*p)|o<<8))|o<<4))|o<<2))|o<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-c)*p)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Kp(o){var e=o,s=o;do{(e.x<s.x||e.x===s.x&&e.y<s.y)&&(s=e),e=e.next}while(e!==o);return s}function nu(o,e,s,c,p,_,v,T){return(p-v)*(e-T)-(o-v)*(_-T)>=0&&(o-v)*(c-T)-(s-v)*(e-T)>=0&&(s-v)*(_-T)-(p-v)*(c-T)>=0}function Gg(o,e){return o.next.i!==e.i&&o.prev.i!==e.i&&!function(s,c){var p=s;do{if(p.i!==s.i&&p.next.i!==s.i&&p.i!==c.i&&p.next.i!==c.i&&Xp(p,p.next,s,c))return!0;p=p.next}while(p!==s);return!1}(o,e)&&(ol(o,e)&&ol(e,o)&&function(s,c){var p=s,_=!1,v=(s.x+c.x)/2,T=(s.y+c.y)/2;do{p.y>T!=p.next.y>T&&p.next.y!==p.y&&v<(p.next.x-p.x)*(T-p.y)/(p.next.y-p.y)+p.x&&(_=!_),p=p.next}while(p!==s);return _}(o,e)&&(uo(o.prev,o,e.prev)||uo(o,e.prev,e))||Iu(o,e)&&uo(o.prev,o,o.next)>0&&uo(e.prev,e,e.next)>0)}function uo(o,e,s){return(e.y-o.y)*(s.x-e.x)-(e.x-o.x)*(s.y-e.y)}function Iu(o,e){return o.x===e.x&&o.y===e.y}function Xp(o,e,s,c){var p=cd(uo(o,e,s)),_=cd(uo(o,e,c)),v=cd(uo(s,c,o)),T=cd(uo(s,c,e));return p!==_&&v!==T||!(0!==p||!ld(o,s,e))||!(0!==_||!ld(o,c,e))||!(0!==v||!ld(s,o,c))||!(0!==T||!ld(s,e,c))}function ld(o,e,s){return e.x<=Math.max(o.x,s.x)&&e.x>=Math.min(o.x,s.x)&&e.y<=Math.max(o.y,s.y)&&e.y>=Math.min(o.y,s.y)}function cd(o){return o>0?1:o<0?-1:0}function ol(o,e){return uo(o.prev,o,o.next)<0?uo(o,e,o.next)>=0&&uo(o,o.prev,e)>=0:uo(o,e,o.prev)<0||uo(o,o.next,e)<0}function $a(o,e){var s=new dd(o.i,o.x,o.y),c=new dd(e.i,e.x,e.y),p=o.next,_=e.prev;return o.next=e,e.prev=o,s.next=p,p.prev=s,c.next=s,s.prev=c,_.next=c,c.prev=_,c}function Wg(o,e,s,c){var p=new dd(o,e,s);return c?(p.next=c.next,p.prev=c,c.next.prev=p,c.next=p):(p.prev=p,p.next=p),p}function ud(o){o.next.prev=o.prev,o.prev.next=o.next,o.prevZ&&(o.prevZ.nextZ=o.nextZ),o.nextZ&&(o.nextZ.prevZ=o.prevZ)}function dd(o,e,s){this.i=o,this.x=e,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Qp(o,e,s,c){for(var p=0,_=e,v=s-c;_<s;_+=c)p+=(o[v]-o[_])*(o[_+1]+o[v+1]),v=_;return p}function sl(o,e,s,c,p){hd(o,e,s||0,c||o.length-1,p||Yg)}function hd(o,e,s,c,p){for(;c>s;){if(c-s>600){var _=c-s+1,v=e-s+1,T=Math.log(_),M=.5*Math.exp(2*T/3),z=.5*Math.sqrt(T*M*(_-M)/_)*(v-_/2<0?-1:1);hd(o,e,Math.max(s,Math.floor(e-v*M/_+z)),Math.min(c,Math.floor(e+(_-v)*M/_+z)),p)}var W=o[e],ee=s,oe=c;for(Ac(o,s,e),p(o[c],W)>0&&Ac(o,s,c);ee<oe;){for(Ac(o,ee,oe),ee++,oe--;p(o[ee],W)<0;)ee++;for(;p(o[oe],W)>0;)oe--}0===p(o[s],W)?Ac(o,s,oe):Ac(o,++oe,c),oe<=e&&(s=oe+1),e<=oe&&(c=oe-1)}}function Ac(o,e,s){var c=o[e];o[e]=o[s],o[s]=c}function Yg(o,e){return o<e?-1:o>e?1:0}function pd(o,e){const s=o.length;if(s<=1)return[o];const c=[];let p,_;for(let v=0;v<s;v++){const T=Kt(o[v]);0!==T&&(o[v].area=Math.abs(T),void 0===_&&(_=T<0),_===T<0?(p&&c.push(p),p=[o[v]]):p.push(o[v]))}if(p&&c.push(p),e>1)for(let v=0;v<c.length;v++)c[v].length<=e||(sl(c[v],e,1,c[v].length-1,Du),c[v]=c[v].slice(0,e));return c}function Du(o,e){return e.area-o.area}function fd(o,e,s){const c=s.patternDependencies;let p=!1;for(const _ of e){const v=_.paint.get(`${o}-pattern`);v.isConstant()||(p=!0);const T=v.constantOr(null);T&&(p=!0,c[T.to]=!0,c[T.from]=!0)}return p}function gd(o,e,s,c,p){const _=p.patternDependencies;for(const v of e){const T=v.paint.get(`${o}-pattern`).value;if("constant"!==T.kind){let M=T.evaluate({zoom:c-1},s,{},p.availableImages),z=T.evaluate({zoom:c},s,{},p.availableImages),W=T.evaluate({zoom:c+1},s,{},p.availableImages);M=M&&M.name?M.name:M,z=z&&z.name?z.name:z,W=W&&W.name?W.name:W,_[M]=!0,_[z]=!0,_[W]=!0,s.patterns[v.id]={min:M,mid:z,max:W}}}return s}Cu.deviation=function(o,e,s,c){var p=e&&e.length,_=Math.abs(Qp(o,0,p?e[0]*s:o.length,s));if(p)for(var v=0,T=e.length;v<T;v++)_-=Math.abs(Qp(o,e[v]*s,v<T-1?e[v+1]*s:o.length,s));var M=0;for(v=0;v<c.length;v+=3){var z=c[v]*s,W=c[v+1]*s,ee=c[v+2]*s;M+=Math.abs((o[z]-o[ee])*(o[W+1]-o[z+1])-(o[z]-o[W])*(o[ee+1]-o[z+1]))}return 0===_&&0===M?0:Math.abs((M-_)/_)},Cu.flatten=function(o){for(var e=o[0][0].length,s={vertices:[],holes:[],dimensions:e},c=0,p=0;p<o.length;p++){for(var _=0;_<o[p].length;_++)for(var v=0;v<e;v++)s.vertices.push(o[p][_][v]);p>0&&s.holes.push(c+=o[p-1].length)}return s},bh.default=uy;class Au{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Li,this.indexArray=new Zi,this.indexArray2=new Zo,this.programConfigurations=new zs(e.layers,e.zoom),this.segments=new ps,this.segments2=new ps,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(e,s,c){this.hasPattern=fd("fill",this.layers,s);const p=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:v,id:T,index:M,sourceLayerIndex:z}of e){const W=this.layers[0]._featureFilter.needGeometry,ee=Za(v,W);if(!this.layers[0]._featureFilter.filter(new Me(this.zoom),ee,c))continue;const oe=p?p.evaluate(ee,{},c,s.availableImages):void 0,fe={id:T,properties:v.properties,type:v.type,sourceLayerIndex:z,index:M,geometry:W?ee.geometry:Ic(v),patterns:{},sortKey:oe};_.push(fe)}p&&_.sort((v,T)=>v.sortKey-T.sortKey);for(const v of _){const{geometry:T,index:M,sourceLayerIndex:z}=v;if(this.hasPattern){const W=gd("fill",this.layers,v,this.zoom,s);this.patternFeatures.push(W)}else this.addFeature(v,T,M,c,{});s.featureIndex.insert(e[M].feature,T,M,z,this.index)}}update(e,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c)}addFeatures(e,s,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,c)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Jp),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,s,c,p,_){for(const v of pd(s,500)){let T=0;for(const fe of v)T+=fe.length;const M=this.segments.prepareSegment(T,this.layoutVertexArray,this.indexArray),z=M.vertexLength,W=[],ee=[];for(const fe of v){if(0===fe.length)continue;fe!==v[0]&&ee.push(W.length/2);const Re=this.segments2.prepareSegment(fe.length,this.layoutVertexArray,this.indexArray2),ke=Re.vertexLength;this.layoutVertexArray.emplaceBack(fe[0].x,fe[0].y),this.indexArray2.emplaceBack(ke+fe.length-1,ke),W.push(fe[0].x),W.push(fe[0].y);for(let tt=1;tt<fe.length;tt++)this.layoutVertexArray.emplaceBack(fe[tt].x,fe[tt].y),this.indexArray2.emplaceBack(ke+tt-1,ke+tt),W.push(fe[tt].x),W.push(fe[tt].y);Re.vertexLength+=fe.length,Re.primitiveLength+=fe.length}const oe=bh(W,ee);for(let fe=0;fe<oe.length;fe+=3)this.indexArray.emplaceBack(z+oe[fe],z+oe[fe+1],z+oe[fe+2]);M.vertexLength+=T,M.primitiveLength+=oe.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,p)}}Jn("FillBucket",Au,{omit:["layers","patternFeatures"]});const wh=new sn({"fill-sort-key":new Pt(at.layout_fill["fill-sort-key"])});var ef={paint:new sn({"fill-antialias":new nt(at.paint_fill["fill-antialias"]),"fill-opacity":new Pt(at.paint_fill["fill-opacity"]),"fill-color":new Pt(at.paint_fill["fill-color"]),"fill-outline-color":new Pt(at.paint_fill["fill-outline-color"]),"fill-translate":new nt(at.paint_fill["fill-translate"]),"fill-translate-anchor":new nt(at.paint_fill["fill-translate-anchor"]),"fill-pattern":new dn(at.paint_fill["fill-pattern"])}),layout:wh};const dy=Xn([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),iu=Xn([{name:"a_centroid_pos",components:2,type:"Uint16"}]),{members:Ch}=dy;var Th=ru;function ru(o,e,s,c,p){this.properties={},this.extent=s,this.type=0,this._pbf=o,this._geometry=-1,this._keys=c,this._values=p,o.readFields(Eh,this,e)}function Eh(o,e,s){1==o?e.id=s.readVarint():2==o?function(c,p){for(var _=c.readVarint()+c.pos;c.pos<_;){var v=p._keys[c.readVarint()],T=p._values[c.readVarint()];p.properties[v]=T}}(s,e):3==o?e.type=s.readVarint():4==o&&(e._geometry=s.pos)}function Jg(o){for(var e,s,c=0,p=0,_=o.length,v=_-1;p<_;v=p++)c+=((s=o[v]).x-(e=o[p]).x)*(e.y+s.y);return c}ru.types=["Unknown","Point","LineString","Polygon"],ru.prototype.loadGeometry=function(){var o=this._pbf;o.pos=this._geometry;for(var e,s=o.readVarint()+o.pos,c=1,p=0,_=0,v=0,T=[];o.pos<s;){if(p<=0){var M=o.readVarint();c=7&M,p=M>>3}if(p--,1===c||2===c)_+=o.readSVarint(),v+=o.readSVarint(),1===c&&(e&&T.push(e),e=[]),e.push(new H(_,v));else{if(7!==c)throw new Error("unknown command "+c);e&&e.push(e[0].clone())}}return e&&T.push(e),T},ru.prototype.bbox=function(){var o=this._pbf;o.pos=this._geometry;for(var e=o.readVarint()+o.pos,s=1,c=0,p=0,_=0,v=1/0,T=-1/0,M=1/0,z=-1/0;o.pos<e;){if(c<=0){var W=o.readVarint();s=7&W,c=W>>3}if(c--,1===s||2===s)(p+=o.readSVarint())<v&&(v=p),p>T&&(T=p),(_+=o.readSVarint())<M&&(M=_),_>z&&(z=_);else if(7!==s)throw new Error("unknown command "+s)}return[v,M,T,z]},ru.prototype.toGeoJSON=function(o,e,s){var c,p,_=this.extent*Math.pow(2,s),v=this.extent*o,T=this.extent*e,M=this.loadGeometry(),z=ru.types[this.type];function W(fe){for(var Re=0;Re<fe.length;Re++){var ke=fe[Re];fe[Re]=[360*(ke.x+v)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(ke.y+T)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var ee=[];for(c=0;c<M.length;c++)ee[c]=M[c][0];W(M=ee);break;case 2:for(c=0;c<M.length;c++)W(M[c]);break;case 3:for(M=function(fe){var Re=fe.length;if(Re<=1)return[fe];for(var ke,tt,mt=[],It=0;It<Re;It++){var Ut=Jg(fe[It]);0!==Ut&&(void 0===tt&&(tt=Ut<0),tt===Ut<0?(ke&&mt.push(ke),ke=[fe[It]]):ke.push(fe[It]))}return ke&&mt.push(ke),mt}(M),c=0;c<M.length;c++)for(p=0;p<M[c].length;p++)W(M[c][p])}1===M.length?M=M[0]:z="Multi"+z;var oe={type:"Feature",geometry:{type:z,coordinates:M},properties:this.properties};return"id"in this&&(oe.id=this.id),oe};var tf=nf;function nf(o,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=o,this._keys=[],this._values=[],this._features=[],o.readFields(Kg,this,e),this.length=this._features.length}function Kg(o,e,s){15===o?e.version=s.readVarint():1===o?e.name=s.readString():5===o?e.extent=s.readVarint():2===o?e._features.push(s.pos):3===o?e._keys.push(s.readString()):4===o&&e._values.push(function(c){for(var p=null,_=c.readVarint()+c.pos;c.pos<_;){var v=c.readVarint()>>3;p=1===v?c.readString():2===v?c.readFloat():3===v?c.readDouble():4===v?c.readVarint64():5===v?c.readVarint():6===v?c.readSVarint():7===v?c.readBoolean():null}return p}(s))}function Xg(o,e,s){if(3===o){var c=new tf(s,s.readVarint()+s.pos);c.length&&(e[c.name]=c)}}nf.prototype.feature=function(o){if(o<0||o>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[o];var e=this._pbf.readVarint()+this._pbf.pos;return new Th(this._pbf,e,this.extent,this._keys,this._values)};var Mc={VectorTile:function(o,e){this.layers=o.readFields(Xg,{},e)},VectorTileFeature:Th,VectorTileLayer:tf};const rf=Mc.VectorTileFeature.types,Ih=Math.pow(2,13);function ou(o,e,s,c,p,_,v,T){o.emplaceBack((e<<1)+v,(s<<1)+_,(Math.floor(c*Ih)<<1)+p,Math.round(T))}class md{constructor(){this.acc=new H(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new H(e.x,e.y),this.max=new H(e.x,e.y))}append(e,s){this.currentPolyCount.edges++,this.acc._add(e);let c=!!this.borders;const p=this.min,_=this.max;e.x<p.x?(p.x=e.x,c=!0):e.x>_.x&&(_.x=e.x,c=!0),e.y<p.y?(p.y=e.y,c=!0):e.y>_.y&&(_.y=e.y,c=!0),((0===e.x||e.x===Rr)&&e.x===s.x)!=((0===e.y||e.y===Rr)&&e.y===s.y)&&this.processBorderOverlap(e,s),c&&this.checkBorderIntersection(e,s)}checkBorderIntersection(e,s){s.x<0!=e.x<0&&this.addBorderIntersection(0,Gi(s.y,e.y,(0-s.x)/(e.x-s.x))),s.x>Rr!=e.x>Rr&&this.addBorderIntersection(1,Gi(s.y,e.y,(Rr-s.x)/(e.x-s.x))),s.y<0!=e.y<0&&this.addBorderIntersection(2,Gi(s.x,e.x,(0-s.y)/(e.y-s.y))),s.y>Rr!=e.y>Rr&&this.addBorderIntersection(3,Gi(s.x,e.x,(Rr-s.y)/(e.y-s.y)))}addBorderIntersection(e,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[e];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(e,s){if(e.x===s.x){if(e.y===s.y)return;const c=0===e.x?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,e.y)}else{const c=0===e.y?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,e.x)}}centroid(){const e=this.polyCount.reduce((s,c)=>s+c.edges,0);return 0!==e?this.acc.div(e)._round():new H(0,0)}span(){return new H(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,s)=>e+ +(s[0]!==Number.MAX_VALUE),0)}}class Dh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Hr,this.centroidVertexArray=new Ag,this.indexArray=new Zi,this.programConfigurations=new zs(e.layers,e.zoom),this.segments=new ps,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id),this.enableTerrain=e.enableTerrain}populate(e,s,c){this.features=[],this.hasPattern=fd("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDone=[!1,!1,!1,!1],this.tileToMeter=function(p){const _=Math.exp(Math.PI*(1-p.y/(1<<p.z)*2));return 80150034*_/(_*_+1)/Rr/(1<<p.z)}(c);for(const{feature:p,id:_,index:v,sourceLayerIndex:T}of e){const M=this.layers[0]._featureFilter.needGeometry,z=Za(p,M);if(!this.layers[0]._featureFilter.filter(new Me(this.zoom),z,c))continue;const W={id:_,sourceLayerIndex:T,index:v,geometry:M?z.geometry:Ic(p),properties:p.properties,type:p.type,patterns:{}},ee=this.layoutVertexArray.length;this.hasPattern?this.features.push(gd("fill-extrusion",this.layers,W,this.zoom,s)):this.addFeature(W,W.geometry,v,c,{}),s.featureIndex.insert(p,W.geometry,v,T,this.index,ee)}this.sortBorders()}addFeatures(e,s,c){for(const p of this.features){const{geometry:_}=p;this.addFeature(p,_,p.index,s,c)}this.sortBorders()}update(e,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ch),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,iu.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,s,c,p,_){const v=this.enableTerrain?new md:null;for(const M of pd(s,500)){let z=0,W=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);if(0===M.length||(T=M[0]).every(ke=>ke.x<=0)||T.every(ke=>ke.x>=Rr)||T.every(ke=>ke.y<=0)||T.every(ke=>ke.y>=Rr))continue;for(let ke=0;ke<M.length;ke++){const tt=M[ke];if(0===tt.length)continue;z+=tt.length;let mt=0;v&&v.startRing(tt[0]);for(let It=0;It<tt.length;It++){const Ut=tt[It];if(It>=1){const jt=tt[It-1];if(!Qg(Ut,jt)){v&&v.append(Ut,jt),W.vertexLength+4>ps.MAX_VERTEX_ARRAY_LENGTH&&(W=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const qt=Ut.sub(jt)._perp(),Gt=qt.x/(Math.abs(qt.x)+Math.abs(qt.y)),gn=qt.y>0?1:0,Dn=jt.dist(Ut);mt+Dn>32768&&(mt=0),ou(this.layoutVertexArray,Ut.x,Ut.y,Gt,gn,0,0,mt),ou(this.layoutVertexArray,Ut.x,Ut.y,Gt,gn,0,1,mt),mt+=Dn,ou(this.layoutVertexArray,jt.x,jt.y,Gt,gn,0,0,mt),ou(this.layoutVertexArray,jt.x,jt.y,Gt,gn,0,1,mt);const Rn=W.vertexLength;this.indexArray.emplaceBack(Rn,Rn+2,Rn+1),this.indexArray.emplaceBack(Rn+1,Rn+2,Rn+3),W.vertexLength+=4,W.primitiveLength+=2}}}}if(W.vertexLength+z>ps.MAX_VERTEX_ARRAY_LENGTH&&(W=this.segments.prepareSegment(z,this.layoutVertexArray,this.indexArray)),"Polygon"!==rf[e.type])continue;const ee=[],oe=[],fe=W.vertexLength;for(let ke=0;ke<M.length;ke++){const tt=M[ke];if(0!==tt.length){tt!==M[0]&&oe.push(ee.length/2);for(let mt=0;mt<tt.length;mt++){const It=tt[mt];ou(this.layoutVertexArray,It.x,It.y,0,0,1,1,0),ee.push(It.x),ee.push(It.y),v&&v.currentPolyCount.top++}}}const Re=bh(ee,oe);for(let ke=0;ke<Re.length;ke+=3)this.indexArray.emplaceBack(fe+Re[ke],fe+Re[ke+2],fe+Re[ke+1]);W.primitiveLength+=Re.length/3,W.vertexLength+=z}var T;if(v&&v.polyCount.length>0){if(v.borders){v.vertexArrayOffset=this.centroidVertexArray.length;const M=v.borders,z=this.featuresOnBorder.push(v)-1;for(let W=0;W<4;W++)M[W][0]!==Number.MAX_VALUE&&this.borders[W].push(z)}this.encodeCentroid(v.borders?void 0:v.centroid(),v)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,p)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((s,c)=>this.featuresOnBorder[s].borders[e][0]-this.featuresOnBorder[c].borders[e][0])}encodeCentroid(e,s,c=!0){let p,_;if(e)if(0!==e.y){const T=s.span()._mult(this.tileToMeter);p=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(T.x/10)),_=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else p=Math.ceil(7*(e.x+450)),_=0;else p=0,_=+c;let v=c?this.centroidVertexArray.length:s.vertexArrayOffset;for(const T of s.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let M=0;M<2*T.edges;M++)this.centroidVertexArray.emplace(v++,0,_),this.centroidVertexArray.emplace(v++,p,_);for(let M=0;M<T.top;M++)this.centroidVertexArray.emplace(v++,p,_)}}}function Qg(o,e){return o.x===e.x&&(o.x<0||o.x>Rr)||o.y===e.y&&(o.y<0||o.y>Rr)}Jn("FillExtrusionBucket",Dh,{omit:["layers","features"]}),Jn("PartMetadata",md);var of={paint:new sn({"fill-extrusion-opacity":new nt(at["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new Pt(at["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new nt(at["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new nt(at["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new dn(at["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new Pt(at["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new Pt(at["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new nt(at["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})};function su(o,e){return o.x*e.x+o.y*e.y}function nc(o,e){if(1===o.length){let s=0;const c=e[s++];let p;for(;!p||c.equals(p);)if(p=e[s++],!p)return 1/0;for(;s<e.length;s++){const _=e[s],v=o[0],T=p.sub(c),M=_.sub(c),z=v.sub(c),W=su(T,T),ee=su(T,M),oe=su(M,M),fe=su(z,T),Re=su(z,M),ke=W*oe-ee*ee,tt=(oe*fe-ee*Re)/ke,mt=(W*Re-ee*fe)/ke,It=c.z*(1-tt-mt)+p.z*tt+_.z*mt;if(isFinite(It))return It}return 1/0}{let s=1/0;for(const c of e)s=Math.min(s,c.z);return s}}function Ah(o){const e=new H(o[0],o[1]);return e.z=o[2],e}function sf(o,e,s,c,p,_,v,T){const M=v*p.getElevationAt(o,e,!0,!0),z=0!==_[0],W=z?0===_[1]?v*(_[0]/7-450):v*function(ee,oe,fe){const Re=Math.floor(oe[0]/8),ke=Math.floor(oe[1]/8),tt=10*(oe[0]-8*Re),mt=10*(oe[1]-8*ke),It=ee.getElevationAt(Re,ke,!0,!0),Ut=ee.getMeterToDEM(fe),jt=Math.floor(.5*(tt*Ut-1)),qt=Math.floor(.5*(mt*Ut-1)),Gt=ee.tileCoordToPixel(Re,ke),gn=2*jt+1,Dn=2*qt+1,Rn=(Pi=gn,lr=Dn,[(Si=ee).getElevationAtPixel(Wn=Gt.x-jt,Mr=Gt.y-qt,!0),Si.getElevationAtPixel(Wn+lr,Mr,!0),Si.getElevationAtPixel(Wn,Mr+lr,!0),Si.getElevationAtPixel(Wn+Pi,Mr+lr,!0)]),Ln=Math.abs(Rn[0]-Rn[1]),vn=Math.abs(Rn[2]-Rn[3]),In=Math.abs(Rn[0]-Rn[2])+Math.abs(Rn[1]-Rn[3]),zn=Math.min(.25,.5*Ut*(Ln+vn)/gn),Cn=Math.min(.25,.5*Ut*In/Dn);var Si,Wn,Mr,Pi,lr;return It+Math.max(zn*tt,Cn*mt)}(p,_,T):M;return{base:M+(0===s)?-1:s,top:z?Math.max(W+c,M+s+2):M+c}}const em=Xn([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:_d}=em,tm=Xn([{name:"a_packed",components:3,type:"Float32"}]),{members:af}=tm,lf=Mc.VectorTileFeature.types,cf=Math.cos(Math.PI/180*37.5);class Mu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new $r,this.layoutVertexArray2=new ki,this.indexArray=new Zi,this.programConfigurations=new zs(e.layers,e.zoom),this.segments=new ps,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(e,s,c){this.hasPattern=fd("line",this.layers,s);const p=this.layers[0].layout.get("line-sort-key"),_=[];for(const{feature:z,id:W,index:ee,sourceLayerIndex:oe}of e){const fe=this.layers[0]._featureFilter.needGeometry,Re=Za(z,fe);if(!this.layers[0]._featureFilter.filter(new Me(this.zoom),Re,c))continue;const ke=p?p.evaluate(Re,{},c):void 0,tt={id:W,properties:z.properties,type:z.type,sourceLayerIndex:oe,index:ee,geometry:fe?Re.geometry:Ic(z),patterns:{},sortKey:ke};_.push(tt)}p&&_.sort((z,W)=>z.sortKey-W.sortKey);const{lineAtlas:v,featureIndex:T}=s,M=this.addConstantDashes(v);for(const z of _){const{geometry:W,index:ee,sourceLayerIndex:oe}=z;if(M&&this.addFeatureDashes(z,v),this.hasPattern){const fe=gd("line",this.layers,z,this.zoom,s);this.patternFeatures.push(fe)}else this.addFeature(z,W,ee,c,v.positions);T.insert(e[ee].feature,W,ee,oe,this.index)}}addConstantDashes(e){let s=!1;for(const c of this.layers){const p=c.paint.get("line-dasharray").value,_=c.layout.get("line-cap").value;if("constant"!==p.kind||"constant"!==_.kind)s=!0;else{const v=_.value,T=p.value;if(!T)continue;e.addDash(T.from,v),e.addDash(T.to,v),T.other&&e.addDash(T.other,v)}}return s}addFeatureDashes(e,s){const c=this.zoom;for(const p of this.layers){const _=p.paint.get("line-dasharray").value,v=p.layout.get("line-cap").value;if("constant"===_.kind&&"constant"===v.kind)continue;let T,M,z,W,ee,oe;if("constant"===_.kind){const tt=_.value;if(!tt)continue;T=tt.other||tt.to,M=tt.to,z=tt.from}else T=_.evaluate({zoom:c-1},e),M=_.evaluate({zoom:c},e),z=_.evaluate({zoom:c+1},e);"constant"===v.kind?W=ee=oe=v.value:(W=v.evaluate({zoom:c-1},e),ee=v.evaluate({zoom:c},e),oe=v.evaluate({zoom:c+1},e)),s.addDash(T,W),s.addDash(M,ee),s.addDash(z,oe);const fe=s.getKey(T,W),Re=s.getKey(M,ee),ke=s.getKey(z,oe);e.patterns[p.id]={min:fe,mid:Re,max:ke}}}update(e,s,c){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,c)}addFeatures(e,s,c){for(const p of this.patternFeatures)this.addFeature(p,p.geometry,p.index,s,c)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,af)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_d),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,s,c,p,_){const v=this.layers[0].layout,T=v.get("line-join").evaluate(e,{}),M=v.get("line-cap").evaluate(e,{}),z=v.get("line-miter-limit"),W=v.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const ee of s)this.addLine(ee,e,T,M,z,W);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,p)}addLine(e,s,c,p,_,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let mt=0;mt<e.length-1;mt++)this.totalDistance+=e[mt].dist(e[mt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T="Polygon"===lf[s.type];let M=e.length;for(;M>=2&&e[M-1].equals(e[M-2]);)M--;let z=0;for(;z<M-1&&e[z].equals(e[z+1]);)z++;if(M<(T?3:2))return;"bevel"===c&&(_=1.05);const W=this.overscaling<=16?122880/(512*this.overscaling):0,ee=this.segments.prepareSegment(10*M,this.layoutVertexArray,this.indexArray);let oe,fe,Re,ke,tt;this.e1=this.e2=-1,T&&(oe=e[M-2],tt=e[z].sub(oe)._unit()._perp());for(let mt=z;mt<M;mt++){if(Re=mt===M-1?T?e[z+1]:void 0:e[mt+1],Re&&e[mt].equals(Re))continue;tt&&(ke=tt),oe&&(fe=oe),oe=e[mt],tt=Re?Re.sub(oe)._unit()._perp():ke,ke=ke||tt;let It=ke.add(tt);0===It.x&&0===It.y||It._unit();const Ut=ke.x*tt.x+ke.y*tt.y,jt=It.x*tt.x+It.y*tt.y,qt=0!==jt?1/jt:1/0,Gt=2*Math.sqrt(2-2*jt),gn=jt<cf&&fe&&Re,Dn=ke.x*tt.y-ke.y*tt.x>0;if(gn&&mt>z){const vn=oe.dist(fe);if(vn>2*W){const In=oe.sub(oe.sub(fe)._mult(W/vn)._round());this.updateDistance(fe,In),this.addCurrentVertex(In,ke,0,0,ee),fe=In}}const Rn=fe&&Re;let Ln=Rn?c:T?"butt":p;if(Rn&&"round"===Ln&&(qt<v?Ln="miter":qt<=2&&(Ln="fakeround")),"miter"===Ln&&qt>_&&(Ln="bevel"),"bevel"===Ln&&(qt>2&&(Ln="flipbevel"),qt<_&&(Ln="miter")),fe&&this.updateDistance(fe,oe),"miter"===Ln)It._mult(qt),this.addCurrentVertex(oe,It,0,0,ee);else if("flipbevel"===Ln){if(qt>100)It=tt.mult(-1);else{const vn=qt*ke.add(tt).mag()/ke.sub(tt).mag();It._perp()._mult(vn*(Dn?-1:1))}this.addCurrentVertex(oe,It,0,0,ee),this.addCurrentVertex(oe,It.mult(-1),0,0,ee)}else if("bevel"===Ln||"fakeround"===Ln){const vn=-Math.sqrt(qt*qt-1),In=Dn?vn:0,zn=Dn?0:vn;if(fe&&this.addCurrentVertex(oe,ke,In,zn,ee),"fakeround"===Ln){const Cn=Math.round(180*Gt/Math.PI/20);for(let Si=1;Si<Cn;Si++){let Wn=Si/Cn;if(.5!==Wn){const Pi=Wn-.5;Wn+=Wn*Pi*(Wn-1)*((1.0904+Ut*(Ut*(3.55645-1.43519*Ut)-3.2452))*Pi*Pi+(.848013+Ut*(.215638*Ut-1.06021)))}const Mr=tt.sub(ke)._mult(Wn)._add(ke)._unit()._mult(Dn?-1:1);this.addHalfVertex(oe,Mr.x,Mr.y,!1,Dn,0,ee)}}Re&&this.addCurrentVertex(oe,tt,-In,-zn,ee)}else if("butt"===Ln)this.addCurrentVertex(oe,It,0,0,ee);else if("square"===Ln){const vn=fe?1:-1;fe||this.addCurrentVertex(oe,It,vn,vn,ee),this.addCurrentVertex(oe,It,0,0,ee),fe&&this.addCurrentVertex(oe,It,vn,vn,ee)}else"round"===Ln&&(fe&&(this.addCurrentVertex(oe,ke,0,0,ee),this.addCurrentVertex(oe,ke,1,1,ee,!0)),Re&&(this.addCurrentVertex(oe,tt,-1,-1,ee,!0),this.addCurrentVertex(oe,tt,0,0,ee)));if(gn&&mt<M-1){const vn=oe.dist(Re);if(vn>2*W){const In=oe.add(Re.sub(oe)._mult(W/vn)._round());this.updateDistance(oe,In),this.addCurrentVertex(In,tt,0,0,ee),oe=In}}}}addCurrentVertex(e,s,c,p,_,v=!1){const T=s.y*p-s.x,M=-s.y-s.x*p;this.addHalfVertex(e,s.x+s.y*c,s.y-s.x*c,v,!1,c,_),this.addHalfVertex(e,T,M,v,!0,-p,_)}addHalfVertex({x:e,y:s},c,p,_,v,T,M){this.layoutVertexArray.emplaceBack((e<<1)+(_?1:0),(s<<1)+(v?1:0),Math.round(63*c)+128,Math.round(63*p)+128,1+(0===T?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineSoFar);const z=M.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,z),M.primitiveLength++),v?this.e2=z:this.e1=z}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,s){this.distance+=e.dist(s),this.updateScaledDistance()}}Jn("LineBucket",Mu,{omit:["layers","patternFeatures"]});const uf=new sn({"line-cap":new Pt(at.layout_line["line-cap"]),"line-join":new Pt(at.layout_line["line-join"]),"line-miter-limit":new nt(at.layout_line["line-miter-limit"]),"line-round-limit":new nt(at.layout_line["line-round-limit"]),"line-sort-key":new Pt(at.layout_line["line-sort-key"])});var Su={paint:new sn({"line-opacity":new Pt(at.paint_line["line-opacity"]),"line-color":new Pt(at.paint_line["line-color"]),"line-translate":new nt(at.paint_line["line-translate"]),"line-translate-anchor":new nt(at.paint_line["line-translate-anchor"]),"line-width":new Pt(at.paint_line["line-width"]),"line-gap-width":new Pt(at.paint_line["line-gap-width"]),"line-offset":new Pt(at.paint_line["line-offset"]),"line-blur":new Pt(at.paint_line["line-blur"]),"line-dasharray":new dn(at.paint_line["line-dasharray"]),"line-pattern":new dn(at.paint_line["line-pattern"]),"line-gradient":new Rt(at.paint_line["line-gradient"])}),layout:uf};const Pu=new class extends Pt{possiblyEvaluate(o,e){return e=new Me(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,zoomHistory:e.zoomHistory,transition:e.transition}),super.possiblyEvaluate(o,e)}evaluate(o,e,s,c){return e=Fe({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(o,e,s,c)}}(Su.paint.properties["line-width"].specification);function Mh(o,e){return e>0?e+2*o:o}Pu.useIntegerZoom=!0;const Sh=Xn([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"},{name:"a_z_tile_anchor",components:4,type:"Int16"}],4),df=Xn([{name:"a_projected_pos",components:3,type:"Float32"}],4);Xn([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Ph=Xn([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Ru=Xn([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Xn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const hf=Xn([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),pf=Xn([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Xn([{name:"triangle",components:3,type:"Uint16"}]),Xn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Xn([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Xn([{type:"Float32",name:"offsetX"}]),Xn([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]);const al=128;function yd(o,e){const{expression:s}=e;if("constant"===s.kind)return{kind:"constant",layoutSize:s.evaluate(new Me(o+1))};if("source"===s.kind)return{kind:"source"};{const{zoomStops:c,interpolationType:p}=s;let _=0;for(;_<c.length&&c[_]<=o;)_++;_=Math.max(0,_-1);let v=_;for(;v<c.length&&c[v]<o+1;)v++;v=Math.min(c.length-1,v);const T=c[_],M=c[v];return"composite"===s.kind?{kind:"composite",minZoom:T,maxZoom:M,interpolationType:p}:{kind:"camera",minZoom:T,maxZoom:M,minSize:s.evaluate(new Me(T)),maxSize:s.evaluate(new Me(M)),interpolationType:p}}}function au(o,{uSize:e,uSizeT:s},{lowerSize:c,upperSize:p}){return"source"===o.kind?c/al:"composite"===o.kind?Gi(c/al,p/al,s):e}function Sc(o,e){let s=0,c=0;if("constant"===o.kind)c=o.layoutSize;else if("source"!==o.kind){const{interpolationType:p,minZoom:_,maxZoom:v}=o,T=p?Ae(Ri.interpolationFactor(p,e,_,v),0,1):0;"camera"===o.kind?c=Gi(o.minSize,o.maxSize,T):s=T}return{uSizeT:s,uSize:c}}var hy=Object.freeze({__proto__:null,getSizeData:yd,evaluateSizeForFeature:au,evaluateSizeForZoom:Sc,SIZE_PACK_FACTOR:al});function ff(o,e,s){return o.sections.forEach(c=>{c.text=function(p,_,v){const T=_.layout.get("text-transform").evaluate(v,{});return"uppercase"===T?p=p.toLocaleUpperCase():"lowercase"===T&&(p=p.toLocaleLowerCase()),Ce.applyArabicShaping&&(p=Ce.applyArabicShaping(p)),p}(c.text,e,s)}),o}const Ou={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function gf(o){return"\ufe36"===o||"\ufe48"===o||"\ufe38"===o||"\ufe44"===o||"\ufe42"===o||"\ufe3e"===o||"\ufe3c"===o||"\ufe3a"===o||"\ufe18"===o||"\ufe40"===o||"\ufe10"===o||"\ufe13"===o||"\ufe14"===o||"\uff40"===o||"\uffe3"===o||"\ufe11"===o||"\ufe12"===o}function nm(o){return"\ufe35"===o||"\ufe47"===o||"\ufe37"===o||"\ufe43"===o||"\ufe41"===o||"\ufe3d"===o||"\ufe3b"===o||"\ufe39"===o||"\ufe17"===o||"\ufe3f"===o}var mf=function(o,e,s,c,p){var _,v,T=8*p-c-1,M=(1<<T)-1,z=M>>1,W=-7,ee=s?p-1:0,oe=s?-1:1,fe=o[e+ee];for(ee+=oe,_=fe&(1<<-W)-1,fe>>=-W,W+=T;W>0;_=256*_+o[e+ee],ee+=oe,W-=8);for(v=_&(1<<-W)-1,_>>=-W,W+=c;W>0;v=256*v+o[e+ee],ee+=oe,W-=8);if(0===_)_=1-z;else{if(_===M)return v?NaN:1/0*(fe?-1:1);v+=Math.pow(2,c),_-=z}return(fe?-1:1)*v*Math.pow(2,_-c)},Pa=function(o,e,s,c,p,_){var v,T,M,z=8*_-p-1,W=(1<<z)-1,ee=W>>1,oe=23===p?Math.pow(2,-24)-Math.pow(2,-77):0,fe=c?0:_-1,Re=c?1:-1,ke=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(T=isNaN(e)?1:0,v=W):(v=Math.floor(Math.log(e)/Math.LN2),e*(M=Math.pow(2,-v))<1&&(v--,M*=2),(e+=v+ee>=1?oe/M:oe*Math.pow(2,1-ee))*M>=2&&(v++,M/=2),v+ee>=W?(T=0,v=W):v+ee>=1?(T=(e*M-1)*Math.pow(2,p),v+=ee):(T=e*Math.pow(2,ee-1)*Math.pow(2,p),v=0));p>=8;o[s+fe]=255&T,fe+=Re,T/=256,p-=8);for(v=v<<p|T,z+=p;z>0;o[s+fe]=255&v,fe+=Re,v/=256,z-=8);o[s+fe-Re]|=128*ke},Lu=kr;function kr(o){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(o)?o:new Uint8Array(o||0),this.pos=0,this.type=0,this.length=this.buf.length}kr.Varint=0,kr.Fixed64=1,kr.Bytes=2,kr.Fixed32=5;var Rh=4294967296,_f=1/Rh,yf="undefined"==typeof TextDecoder?null:new TextDecoder("utf8");function Al(o){return o.type===kr.Bytes?o.readVarint()+o.pos:o.pos+1}function vf(o,e,s){var c=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));s.realloc(c);for(var p=s.pos-1;p>=o;p--)s.buf[p+c]=s.buf[p]}function im(o,e){for(var s=0;s<o.length;s++)e.writeVarint(o[s])}function rm(o,e){for(var s=0;s<o.length;s++)e.writeSVarint(o[s])}function er(o,e){for(var s=0;s<o.length;s++)e.writeFloat(o[s])}function xf(o,e){for(var s=0;s<o.length;s++)e.writeDouble(o[s])}function bf(o,e){for(var s=0;s<o.length;s++)e.writeBoolean(o[s])}function vd(o,e){for(var s=0;s<o.length;s++)e.writeFixed32(o[s])}function ja(o,e){for(var s=0;s<o.length;s++)e.writeSFixed32(o[s])}function wf(o,e){for(var s=0;s<o.length;s++)e.writeFixed64(o[s])}function om(o,e){for(var s=0;s<o.length;s++)e.writeSFixed64(o[s])}function lu(o,e){return(o[e]|o[e+1]<<8|o[e+2]<<16)+16777216*o[e+3]}function Qs(o,e,s){o[s]=e,o[s+1]=e>>>8,o[s+2]=e>>>16,o[s+3]=e>>>24}function xd(o,e){return(o[e]|o[e+1]<<8|o[e+2]<<16)+(o[e+3]<<24)}function Cf(o,e,s){e.glyphs=[],1===o&&s.readMessage(Oh,e)}function Oh(o,e,s){if(3===o){const{id:c,bitmap:p,width:_,height:v,left:T,top:M,advance:z}=s.readMessage(py,{});e.glyphs.push({id:c,bitmap:new Dl({width:_+6,height:v+6},p),metrics:{width:_,height:v,left:T,top:M,advance:z}})}else 4===o?e.ascender=s.readSVarint():5===o&&(e.descender=s.readSVarint())}function py(o,e,s){1===o?e.id=s.readVarint():2===o?e.bitmap=s.readBytes():3===o?e.width=s.readVarint():4===o?e.height=s.readVarint():5===o?e.left=s.readSVarint():6===o?e.top=s.readSVarint():7===o&&(e.advance=s.readVarint())}function bd(o){let e=0,s=0;for(const v of o)e+=v.w*v.h,s=Math.max(s,v.w);o.sort((v,T)=>T.h-v.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let p=0,_=0;for(const v of o)for(let T=c.length-1;T>=0;T--){const M=c[T];if(!(v.w>M.w||v.h>M.h)){if(v.x=M.x,v.y=M.y,_=Math.max(_,v.y+v.h),p=Math.max(p,v.x+v.w),v.w===M.w&&v.h===M.h){const z=c.pop();T<c.length&&(c[T]=z)}else v.h===M.h?(M.x+=v.w,M.w-=v.w):v.w===M.w?(M.y+=v.h,M.h-=v.h):(c.push({x:M.x+v.w,y:M.y,w:M.w-v.w,h:v.h}),M.y+=v.h,M.h-=v.h);break}}return{w:p,h:_,fill:e/(p*_)||0}}kr.prototype={destroy:function(){this.buf=null},readFields:function(o,e,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),p=c>>3,_=this.pos;this.type=7&c,o(p,e,this),this.pos===_&&this.skip(c)}return e},readMessage:function(o,e){return this.readFields(o,e,this.readVarint()+this.pos)},readFixed32:function(){var o=lu(this.buf,this.pos);return this.pos+=4,o},readSFixed32:function(){var o=xd(this.buf,this.pos);return this.pos+=4,o},readFixed64:function(){var o=lu(this.buf,this.pos)+lu(this.buf,this.pos+4)*Rh;return this.pos+=8,o},readSFixed64:function(){var o=lu(this.buf,this.pos)+xd(this.buf,this.pos+4)*Rh;return this.pos+=8,o},readFloat:function(){var o=mf(this.buf,this.pos,!0,23,4);return this.pos+=4,o},readDouble:function(){var o=mf(this.buf,this.pos,!0,52,8);return this.pos+=8,o},readVarint:function(o){var e,s,c=this.buf;return e=127&(s=c[this.pos++]),s<128?e:(e|=(127&(s=c[this.pos++]))<<7,s<128?e:(e|=(127&(s=c[this.pos++]))<<14,s<128?e:(e|=(127&(s=c[this.pos++]))<<21,s<128?e:function(p,_,v){var T,M,z=v.buf;if(T=(112&(M=z[v.pos++]))>>4,M<128||(T|=(127&(M=z[v.pos++]))<<3,M<128)||(T|=(127&(M=z[v.pos++]))<<10,M<128)||(T|=(127&(M=z[v.pos++]))<<17,M<128)||(T|=(127&(M=z[v.pos++]))<<24,M<128)||(T|=(1&(M=z[v.pos++]))<<31,M<128))return function(o,e,s){return s?4294967296*e+(o>>>0):4294967296*(e>>>0)+(o>>>0)}(p,T,_);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(s=c[this.pos]))<<28,o,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var o=this.readVarint();return o%2==1?(o+1)/-2:o/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var o=this.readVarint()+this.pos,e=this.pos;return this.pos=o,o-e>=12&&yf?yf.decode(this.buf.subarray(e,o)):function(s,c,p){for(var _="",v=c;v<p;){var T,M,z,W=s[v],ee=null,oe=W>239?4:W>223?3:W>191?2:1;if(v+oe>p)break;1===oe?W<128&&(ee=W):2===oe?128==(192&(T=s[v+1]))&&(ee=(31&W)<<6|63&T)<=127&&(ee=null):3===oe?(M=s[v+2],128==(192&(T=s[v+1]))&&128==(192&M)&&((ee=(15&W)<<12|(63&T)<<6|63&M)<=2047||ee>=55296&&ee<=57343)&&(ee=null)):4===oe&&(M=s[v+2],z=s[v+3],128==(192&(T=s[v+1]))&&128==(192&M)&&128==(192&z)&&((ee=(15&W)<<18|(63&T)<<12|(63&M)<<6|63&z)<=65535||ee>=1114112)&&(ee=null)),null===ee?(ee=65533,oe=1):ee>65535&&(ee-=65536,_+=String.fromCharCode(ee>>>10&1023|55296),ee=56320|1023&ee),_+=String.fromCharCode(ee),v+=oe}return _}(this.buf,e,o)},readBytes:function(){var o=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,o);return this.pos=o,e},readPackedVarint:function(o,e){if(this.type!==kr.Bytes)return o.push(this.readVarint(e));var s=Al(this);for(o=o||[];this.pos<s;)o.push(this.readVarint(e));return o},readPackedSVarint:function(o){if(this.type!==kr.Bytes)return o.push(this.readSVarint());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readSVarint());return o},readPackedBoolean:function(o){if(this.type!==kr.Bytes)return o.push(this.readBoolean());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readBoolean());return o},readPackedFloat:function(o){if(this.type!==kr.Bytes)return o.push(this.readFloat());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readFloat());return o},readPackedDouble:function(o){if(this.type!==kr.Bytes)return o.push(this.readDouble());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readDouble());return o},readPackedFixed32:function(o){if(this.type!==kr.Bytes)return o.push(this.readFixed32());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readFixed32());return o},readPackedSFixed32:function(o){if(this.type!==kr.Bytes)return o.push(this.readSFixed32());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readSFixed32());return o},readPackedFixed64:function(o){if(this.type!==kr.Bytes)return o.push(this.readFixed64());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readFixed64());return o},readPackedSFixed64:function(o){if(this.type!==kr.Bytes)return o.push(this.readSFixed64());var e=Al(this);for(o=o||[];this.pos<e;)o.push(this.readSFixed64());return o},skip:function(o){var e=7&o;if(e===kr.Varint)for(;this.buf[this.pos++]>127;);else if(e===kr.Bytes)this.pos=this.readVarint()+this.pos;else if(e===kr.Fixed32)this.pos+=4;else{if(e!==kr.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(o,e){this.writeVarint(o<<3|e)},realloc:function(o){for(var e=this.length||16;e<this.pos+o;)e*=2;if(e!==this.length){var s=new Uint8Array(e);s.set(this.buf),this.buf=s,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(o){this.realloc(4),Qs(this.buf,o,this.pos),this.pos+=4},writeSFixed32:function(o){this.realloc(4),Qs(this.buf,o,this.pos),this.pos+=4},writeFixed64:function(o){this.realloc(8),Qs(this.buf,-1&o,this.pos),Qs(this.buf,Math.floor(o*_f),this.pos+4),this.pos+=8},writeSFixed64:function(o){this.realloc(8),Qs(this.buf,-1&o,this.pos),Qs(this.buf,Math.floor(o*_f),this.pos+4),this.pos+=8},writeVarint:function(o){(o=+o||0)>268435455||o<0?function(e,s){var c,p,_,T;if(e>=0?(c=e%4294967296|0,p=e/4294967296|0):(p=~(-e/4294967296),4294967295^(c=~(-e%4294967296))?c=c+1|0:(c=0,p=p+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),_=c,(T=s).buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,T.buf[T.pos]=127&(_>>>=7),function(_,v){var T=(7&_)<<4;v.buf[v.pos++]|=T|((_>>>=3)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_)))))}(p,s)}(o,this):(this.realloc(4),this.buf[this.pos++]=127&o|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=127&(o>>>=7)|(o>127?128:0),o<=127||(this.buf[this.pos++]=o>>>7&127))))},writeSVarint:function(o){this.writeVarint(o<0?2*-o-1:2*o)},writeBoolean:function(o){this.writeVarint(Boolean(o))},writeString:function(o){o=String(o),this.realloc(4*o.length),this.pos++;var e=this.pos;this.pos=function(c,p,_){for(var v,T,M=0;M<p.length;M++){if((v=p.charCodeAt(M))>55295&&v<57344){if(!T){v>56319||M+1===p.length?(c[_++]=239,c[_++]=191,c[_++]=189):T=v;continue}if(v<56320){c[_++]=239,c[_++]=191,c[_++]=189,T=v;continue}v=T-55296<<10|v-56320|65536,T=null}else T&&(c[_++]=239,c[_++]=191,c[_++]=189,T=null);v<128?c[_++]=v:(v<2048?c[_++]=v>>6|192:(v<65536?c[_++]=v>>12|224:(c[_++]=v>>18|240,c[_++]=v>>12&63|128),c[_++]=v>>6&63|128),c[_++]=63&v|128)}return _}(this.buf,o,this.pos);var s=this.pos-e;s>=128&&vf(e,s,this),this.pos=e-1,this.writeVarint(s),this.pos+=s},writeFloat:function(o){this.realloc(4),Pa(this.buf,o,this.pos,!0,23,4),this.pos+=4},writeDouble:function(o){this.realloc(8),Pa(this.buf,o,this.pos,!0,52,8),this.pos+=8},writeBytes:function(o){var e=o.length;this.writeVarint(e),this.realloc(e);for(var s=0;s<e;s++)this.buf[this.pos++]=o[s]},writeRawMessage:function(o,e){this.pos++;var s=this.pos;o(e,this);var c=this.pos-s;c>=128&&vf(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(o,e,s){this.writeTag(o,kr.Bytes),this.writeRawMessage(e,s)},writePackedVarint:function(o,e){e.length&&this.writeMessage(o,im,e)},writePackedSVarint:function(o,e){e.length&&this.writeMessage(o,rm,e)},writePackedBoolean:function(o,e){e.length&&this.writeMessage(o,bf,e)},writePackedFloat:function(o,e){e.length&&this.writeMessage(o,er,e)},writePackedDouble:function(o,e){e.length&&this.writeMessage(o,xf,e)},writePackedFixed32:function(o,e){e.length&&this.writeMessage(o,vd,e)},writePackedSFixed32:function(o,e){e.length&&this.writeMessage(o,ja,e)},writePackedFixed64:function(o,e){e.length&&this.writeMessage(o,wf,e)},writePackedSFixed64:function(o,e){e.length&&this.writeMessage(o,om,e)},writeBytesField:function(o,e){this.writeTag(o,kr.Bytes),this.writeBytes(e)},writeFixed32Field:function(o,e){this.writeTag(o,kr.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(o,e){this.writeTag(o,kr.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(o,e){this.writeTag(o,kr.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(o,e){this.writeTag(o,kr.Fixed64),this.writeSFixed64(e)},writeVarintField:function(o,e){this.writeTag(o,kr.Varint),this.writeVarint(e)},writeSVarintField:function(o,e){this.writeTag(o,kr.Varint),this.writeSVarint(e)},writeStringField:function(o,e){this.writeTag(o,kr.Bytes),this.writeString(e)},writeFloatField:function(o,e){this.writeTag(o,kr.Fixed32),this.writeFloat(e)},writeDoubleField:function(o,e){this.writeTag(o,kr.Fixed64),this.writeDouble(e)},writeBooleanField:function(o,e){this.writeVarintField(o,Boolean(e))}};class Tf{constructor(e,{pixelRatio:s,version:c,stretchX:p,stretchY:_,content:v}){this.paddedRect=e,this.pixelRatio=s,this.stretchX=p,this.stretchY=_,this.content=v,this.version=c}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ll{constructor(e,s){const c={},p={};this.haveRenderCallbacks=[];const _=[];this.addImages(e,c,_),this.addImages(s,p,_);const{w:v,h:T}=bd(_),M=new pa({width:v||1,height:T||1});for(const z in e){const W=e[z],ee=c[z].paddedRect;pa.copy(W.data,M,{x:0,y:0},{x:ee.x+1,y:ee.y+1},W.data)}for(const z in s){const W=s[z],ee=p[z].paddedRect,oe=ee.x+1,fe=ee.y+1,Re=W.data.width,ke=W.data.height;pa.copy(W.data,M,{x:0,y:0},{x:oe,y:fe},W.data),pa.copy(W.data,M,{x:0,y:ke-1},{x:oe,y:fe-1},{width:Re,height:1}),pa.copy(W.data,M,{x:0,y:0},{x:oe,y:fe+ke},{width:Re,height:1}),pa.copy(W.data,M,{x:Re-1,y:0},{x:oe-1,y:fe},{width:1,height:ke}),pa.copy(W.data,M,{x:0,y:0},{x:oe+Re,y:fe},{width:1,height:ke})}this.image=M,this.iconPositions=c,this.patternPositions=p}addImages(e,s,c){for(const p in e){const _=e[p],v={x:0,y:0,w:_.data.width+2,h:_.data.height+2};c.push(v),s[p]=new Tf(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(p)}}patchUpdatedImages(e,s){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in e.updatedImages)this.patchUpdatedImage(this.iconPositions[c],e.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],e.getImage(c),s)}patchUpdatedImage(e,s,c){if(!e||!s||e.version===s.version)return;e.version=s.version;const[p,_]=e.tl;c.update(s.data,void 0,{x:p,y:_})}}Jn("ImagePosition",Tf),Jn("ImageAtlas",ll);const Es={horizontal:1,vertical:2,horizontalOnly:3};class ic{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,s){const c=new ic;return c.scale=e||1,c.fontStack=s,c}static forImage(e){const s=new ic;return s.imageName=e,s}}class rc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,s){const c=new rc;for(let p=0;p<e.sections.length;p++){const _=e.sections[p];_.image?c.addImageSection(_):c.addTextSection(_,s)}return c}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(s,c){let p="";for(let _=0;_<s.length;_++){const v=s.charCodeAt(_+1)||null,T=s.charCodeAt(_-1)||null;p+=!c&&(v&&Wl(v)&&!Ou[s[_+1]]||T&&Wl(T)&&!Ou[s[_-1]])||!Ou[s[_]]?s[_]:Ou[s[_]]}return p}(this.text,e)}trim(){let e=0;for(let c=0;c<this.text.length&&wd[this.text.charCodeAt(c)];c++)e++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=e&&wd[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(e,s),this.sectionIndex=this.sectionIndex.slice(e,s)}substring(e,s){const c=new rc;return c.text=this.text.substring(e,s),c.sectionIndex=this.sectionIndex.slice(e,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,s)=>Math.max(e,this.sections[s].scale),0)}addTextSection(e,s){this.text+=e.text,this.sections.push(ic.forText(e.scale,e.fontStack||s));const c=this.sections.length-1;for(let p=0;p<e.text.length;++p)this.sectionIndex.push(c)}addImageSection(e){const s=e.image?e.image.name:"";if(0===s.length)return void Bt("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(ic.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Bt("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ef(o,e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke){const tt=rc.fromFeature(o,p);let mt;ee===Es.vertical&&tt.verticalizePunctuation(oe);const{processBidirectionalText:It,processStyledBidirectionalText:Ut}=Ce;if(It&&1===tt.sections.length){mt=[];const Gt=It(tt.toString(),Fh(tt,z,_,e,c,fe,Re));for(const gn of Gt){const Dn=new rc;Dn.text=gn,Dn.sections=tt.sections;for(let Rn=0;Rn<gn.length;Rn++)Dn.sectionIndex.push(0);mt.push(Dn)}}else if(Ut){mt=[];const Gt=Ut(tt.text,tt.sectionIndex,Fh(tt,z,_,e,c,fe,Re));for(const gn of Gt){const Dn=new rc;Dn.text=gn[0],Dn.sectionIndex=gn[1],Dn.sections=tt.sections,mt.push(Dn)}}else mt=function(Gt,gn){const Dn=[],Rn=Gt.text;let Ln=0;for(const vn of gn)Dn.push(Gt.substring(Ln,vn)),Ln=vn;return Ln<Rn.length&&Dn.push(Gt.substring(Ln,Rn.length)),Dn}(tt,Fh(tt,z,_,e,c,fe,Re));const jt=[],qt={positionedLines:jt,text:tt.toString(),top:W[1],bottom:W[1],left:W[0],right:W[0],writingMode:ee,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Gt,gn,Dn,Rn,Ln,vn,In,zn,Cn,Si,Wn,Mr){let Pi=0,lr=0,gi=0;const Oi="right"===zn?1:"left"===zn?0:.5;let gr=!1;for(const ir of Ln){const zr=ir.getSections();for(const is of zr){if(is.imageName)continue;const co=gn[is.fontStack];if(co&&(gr=void 0!==co.ascender&&void 0!==co.descender,!gr))break}if(!gr)break}let Ao=0;for(const ir of Ln){ir.trim();const zr=ir.getMaxScale(),is=24*(zr-1),co={positionedGlyphs:[],lineOffset:0};Gt.positionedLines[Ao]=co;const $o=co.positionedGlyphs;let Po=0;if(!ir.length()){lr+=vn,++Ao;continue}let Ur=0,Vs=0;for(let jr=0;jr<ir.length();jr++){const po=ir.getSection(jr),rs=ir.getSectionIndex(jr),Go=ir.getCharCode(jr);let yo=po.scale,Tr=null,Is=null,ea=null,Wa=24,Zs=0;const Ds=!(Cn===Es.horizontal||!Wn&&!ts(Go)||Wn&&(wd[Go]||(lo=Go,yl(lo)||vl(lo)||Jc(lo)||_n(lo)||pr(lo))));if(po.imageName){const Ya=Rn[po.imageName];if(!Ya)continue;ea=po.imageName,Gt.iconsInText=Gt.iconsInText||!0,Is=Ya.paddedRect;const Ro=Ya.displaySize;yo=24*yo/Mr,Tr={width:Ro[0],height:Ro[1],left:1,top:-3,advance:Ds?Ro[1]:Ro[0],localGlyph:!1},Zs=gr?-Tr.height*yo:24*zr-17-Ro[1]*yo,Wa=Tr.advance;const dl=(Ds?Ro[0]:Ro[1])*yo-24*zr;dl>0&&dl>Po&&(Po=dl)}else{const Ya=Dn[po.fontStack];if(!Ya)continue;Ya[Go]&&(Is=Ya[Go]);const Ro=gn[po.fontStack];if(!Ro)continue;const dl=Ro.glyphs[Go];if(!dl)continue;if(Tr=dl.metrics,Wa=8203!==Go?24:0,gr){const Uc=void 0!==Ro.ascender?Math.abs(Ro.ascender):0,$s=void 0!==Ro.descender?Math.abs(Ro.descender):0,ta=(Uc+$s)*yo;Ur<ta&&(Ur=ta,Vs=(Uc-$s)/2*yo),Zs=-Uc*yo}else Zs=24*(zr-yo)-17}Ds?(Gt.verticalizable=!0,$o.push({glyph:Go,imageName:ea,x:Pi,y:lr+Zs,vertical:Ds,scale:yo,localGlyph:Tr.localGlyph,fontStack:po.fontStack,sectionIndex:rs,metrics:Tr,rect:Is}),Pi+=Wa*yo+Si):($o.push({glyph:Go,imageName:ea,x:Pi,y:lr+Zs,vertical:Ds,scale:yo,localGlyph:Tr.localGlyph,fontStack:po.fontStack,sectionIndex:rs,metrics:Tr,rect:Is}),Pi+=Tr.advance*yo+Si)}0!==$o.length&&(gi=Math.max(Pi-Si,gi),gr?am($o,Oi,Po,Vs,vn*zr/2):am($o,Oi,Po,0,vn/2)),Pi=0;const so=vn*zr+Po;co.lineOffset=Math.max(Po,is),lr+=so,++Ao}var lo;const Mo=lr,{horizontalAlign:So,verticalAlign:_o}=ku(In);(function(ir,zr,is,co,$o,Po){const Ur=(zr-is)*$o,Vs=-Po*co;for(const so of ir)for(const jr of so.positionedGlyphs)jr.x+=Ur,jr.y+=Vs})(Gt.positionedLines,Oi,So,_o,gi,Mo),Gt.top+=-_o*Mo,Gt.bottom=Gt.top+Mo,Gt.left+=-So*gi,Gt.right=Gt.left+gi,Gt.hasBaseline=gr}(qt,e,s,c,mt,v,T,M,ee,z,oe,ke),!function(Gt){for(const gn of Gt)if(0!==gn.positionedGlyphs.length)return!1;return!0}(jt)&&qt}const wd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},If={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function sm(o,e,s,c,p,_){if(e.imageName){const v=c[e.imageName];return v?v.displaySize[0]*e.scale*24/_+p:0}{const v=s[e.fontStack],T=v&&v.glyphs[o];return T?T.metrics.advance*e.scale+p:0}}function Df(o,e,s,c){const p=Math.pow(o-e,2);return c?o<e?p/2:2*p:p+Math.abs(s)*s}function fy(o,e,s){let c=0;return 10===o&&(c-=1e4),s&&(c+=150),40!==o&&65288!==o||(c+=50),41!==e&&65289!==e||(c+=50),c}function Lh(o,e,s,c,p,_){let v=null,T=Df(e,s,p,_);for(const M of c){const z=Df(e-M.x,s,p,_)+M.badness;z<=T&&(v=M,T=z)}return{index:o,x:e,priorBreak:v,badness:T}}function kh(o){return o?kh(o.priorBreak).concat(o.index):[]}function Fh(o,e,s,c,p,_,v){if("point"!==_)return[];if(!o)return[];const T=[],M=function(oe,fe,Re,ke,tt,mt){let It=0;for(let Ut=0;Ut<oe.length();Ut++){const jt=oe.getSection(Ut);It+=sm(oe.getCharCode(Ut),jt,ke,tt,fe,mt)}return It/Math.max(1,Math.ceil(It/Re))}(o,e,s,c,p,v),z=o.text.indexOf("\u200b")>=0;let W=0;for(let oe=0;oe<o.length();oe++){const fe=o.getSection(oe),Re=o.getCharCode(oe);if(wd[Re]||(W+=sm(Re,fe,c,p,e,v)),oe<o.length()-1){const ke=!((ee=Re)<11904||!(Aa(ee)||rl(ee)||sr(ee)||xt(ee)||F(ee)||Na(ee)||bc(ee)||Da(ee)||L(ee)||X(ee)||q(ee)||cr(ee)||xl(ee)||xc(ee)||vc(ee)||wc(ee)||Gl(ee)||di(ee)||Pe(ee)||de(ee)));(If[Re]||ke||fe.imageName)&&T.push(Lh(oe+1,W,M,T,fy(Re,o.getCharCode(oe+1),ke&&z),!1))}}var ee;return kh(Lh(o.length(),W,M,T,0,!0))}function ku(o){let e=.5,s=.5;switch(o){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(o){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:e,verticalAlign:s}}function am(o,e,s,c,p){if(!(e||s||c||p))return;const _=o.length-1,v=o[_],T=(v.x+v.metrics.advance*v.scale)*e;for(let M=0;M<=_;M++)o[M].x-=T,o[M].y+=s+c+p}function gy(o,e,s){const{horizontalAlign:c,verticalAlign:p}=ku(s),_=e[0]-o.displaySize[0]*c,v=e[1]-o.displaySize[1]*p;return{image:o,top:v,bottom:v+o.displaySize[1],left:_,right:_+o.displaySize[0]}}function lm(o,e,s,c,p,_){const v=o.image;let T;if(v.content){const tt=v.content,mt=v.pixelRatio||1;T=[tt[0]/mt,tt[1]/mt,v.displaySize[0]-tt[2]/mt,v.displaySize[1]-tt[3]/mt]}const M=e.left*_,z=e.right*_;let W,ee,oe,fe;"width"===s||"both"===s?(fe=p[0]+M-c[3],ee=p[0]+z+c[1]):(fe=p[0]+(M+z-v.displaySize[0])/2,ee=fe+v.displaySize[0]);const Re=e.top*_,ke=e.bottom*_;return"height"===s||"both"===s?(W=p[1]+Re-c[0],oe=p[1]+ke+c[2]):(W=p[1]+(Re+ke-v.displaySize[1])/2,oe=W+v.displaySize[1]),{image:v,top:W,right:ee,bottom:oe,left:fe,collisionPadding:T}}class Rc extends H{constructor(e,s,c,p,_){super(e,s),this.angle=p,this.z=c,void 0!==_&&(this.segment=_)}clone(){return new Rc(this.x,this.y,this.z,this.angle,this.segment)}}function cm(o,e,s,c,p){if(void 0===e.segment)return!0;let _=e,v=e.segment+1,T=0;for(;T>-s/2;){if(v--,v<0)return!1;T-=o[v].dist(_),_=o[v]}T+=o[v].dist(o[v+1]),v++;const M=[];let z=0;for(;T<s/2;){const W=o[v],ee=o[v+1];if(!ee)return!1;let oe=o[v-1].angleTo(W)-W.angleTo(ee);for(oe=Math.abs((oe+3*Math.PI)%(2*Math.PI)-Math.PI),M.push({distance:T,angleDelta:oe}),z+=oe;T-M[0].distance>c;)z-=M.shift().angleDelta;if(z>p)return!1;v++,T+=W.dist(ee)}return!0}function um(o){let e=0;for(let s=0;s<o.length-1;s++)e+=o[s].dist(o[s+1]);return e}function dm(o,e,s){return o?.6*e*s:0}function hm(o,e){return Math.max(o?o.right-o.left:0,e?e.right-e.left:0)}function my(o,e,s,c,p,_){const v=dm(s,p,_),T=hm(s,c)*_;let M=0;const z=um(o)/2;for(let W=0;W<o.length-1;W++){const ee=o[W],oe=o[W+1],fe=ee.dist(oe);if(M+fe>z){const Re=(z-M)/fe,ke=Gi(ee.x,oe.x,Re),tt=Gi(ee.y,oe.y,Re),mt=new Rc(ke,tt,0,oe.angleTo(ee),W);return!v||cm(o,mt,T,v,e)?mt:void 0}M+=fe}}function _y(o,e,s,c,p,_,v,T,M){const z=dm(c,_,v),W=hm(c,p),ee=W*v,oe=0===o[0].x||o[0].x===M||0===o[0].y||o[0].y===M;return e-ee<e/4&&(e=ee+e/4),pm(o,oe?e/2*T%e:(W/2+2*_)*v*T%e,e,z,s,ee,oe,!1,M)}function pm(o,e,s,c,p,_,v,T,M){const z=_/2,W=um(o);let ee=0,oe=e-s,fe=[];for(let Re=0;Re<o.length-1;Re++){const ke=o[Re],tt=o[Re+1],mt=ke.dist(tt),It=tt.angleTo(ke);for(;oe+s<ee+mt;){oe+=s;const Ut=(oe-ee)/mt,jt=Gi(ke.x,tt.x,Ut),qt=Gi(ke.y,tt.y,Ut);if(jt>=0&&jt<M&&qt>=0&&qt<M&&oe-z>=0&&oe+z<=W){const Gt=new Rc(jt,qt,0,It,Re);Gt._round(),c&&!cm(o,Gt,_,c,p)||fe.push(Gt)}}ee+=mt}return T||fe.length||v||(fe=pm(o,ee/2,s,c,p,_,v,!0,M)),fe}function Ml(o,e,s,c,p){const _=[];for(let v=0;v<o.length;v++){const T=o[v];let M;for(let z=0;z<T.length-1;z++){let W=T[z],ee=T[z+1];W.x<e&&ee.x<e||(W.x<e?W=new H(e,W.y+(e-W.x)/(ee.x-W.x)*(ee.y-W.y))._round():ee.x<e&&(ee=new H(e,W.y+(e-W.x)/(ee.x-W.x)*(ee.y-W.y))._round()),W.y<s&&ee.y<s||(W.y<s?W=new H(W.x+(s-W.y)/(ee.y-W.y)*(ee.x-W.x),s)._round():ee.y<s&&(ee=new H(W.x+(s-W.y)/(ee.y-W.y)*(ee.x-W.x),s)._round()),W.x>=c&&ee.x>=c||(W.x>=c?W=new H(c,W.y+(c-W.x)/(ee.x-W.x)*(ee.y-W.y))._round():ee.x>=c&&(ee=new H(c,W.y+(c-W.x)/(ee.x-W.x)*(ee.y-W.y))._round()),W.y>=p&&ee.y>=p||(W.y>=p?W=new H(W.x+(p-W.y)/(ee.y-W.y)*(ee.x-W.x),p)._round():ee.y>=p&&(ee=new H(W.x+(p-W.y)/(ee.y-W.y)*(ee.x-W.x),p)._round()),M&&W.equals(M[M.length-1])||(M=[W],_.push(M)),M.push(ee)))))}}return _}Jn("Anchor",Rc);const Oc=1e20;function Af(o,e,s,c,p,_,v,T,M){for(let z=e;z<e+c;z++)Nh(o,s*_+z,_,p,v,T,M);for(let z=s;z<s+p;z++)Nh(o,z*_+e,1,c,v,T,M)}function Nh(o,e,s,c,p,_,v){_[0]=0,v[0]=-Oc,v[1]=Oc,p[0]=o[e];for(let T=1,M=0,z=0;T<c;T++){p[T]=o[e+T*s];const W=T*T;do{const ee=_[M];z=(p[T]-p[ee]+W-ee*ee)/(T-ee)/2}while(z<=v[M]&&--M>-1);M++,_[M]=T,v[M]=z,v[M+1]=Oc}for(let T=0,M=0;T<c;T++){for(;v[M+1]<T;)M++;const z=_[M],W=T-z;o[e+T*s]=p[z]+W*W}}const Fu={none:0,ideographs:1,all:2};class Lc{constructor(e,s,c){this.requestManager=e,this.localGlyphMode=s,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,s){const c=[];for(const p in e)for(const _ of e[p])c.push({stack:p,id:_});He(c,({stack:p,id:_},v)=>{let T=this.entries[p];T||(T=this.entries[p]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let M=T.glyphs[_];if(void 0!==M)return void v(null,{stack:p,id:_,glyph:M});if(M=this._tinySDF(T,p,_),M)return T.glyphs[_]=M,void v(null,{stack:p,id:_,glyph:M});const z=Math.floor(_/256);if(256*z>65535)return void v(new Error("glyphs > 65535 not supported"));if(T.ranges[z])return void v(null,{stack:p,id:_,glyph:M});let W=T.requests[z];W||(W=T.requests[z]=[],Lc.loadGlyphRange(p,z,this.url,this.requestManager,(ee,oe)=>{if(oe){T.ascender=oe.ascender,T.descender=oe.descender;for(const fe in oe.glyphs)this._doesCharSupportLocalGlyph(+fe)||(T.glyphs[+fe]=oe.glyphs[+fe]);T.ranges[z]=!0}for(const fe of W)fe(ee,oe);delete T.requests[z]})),W.push((ee,oe)=>{ee?v(ee):oe&&v(null,{stack:p,id:_,glyph:oe.glyphs[_]||null})})},(p,_)=>{if(p)s(p);else if(_){const v={};for(const{stack:T,id:M,glyph:z}of _)void 0===v[T]&&(v[T]={}),void 0===v[T].glyphs&&(v[T].glyphs={}),v[T].glyphs[M]=z&&{id:z.id,bitmap:z.bitmap.clone(),metrics:z.metrics},v[T].ascender=this.entries[T].ascender,v[T].descender=this.entries[T].descender;s(null,v)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==Fu.none&&(this.localGlyphMode===Fu.all?!!this.localFontFamily:!!this.localFontFamily&&(X(e)||it(e)||xl(e)||Gl(e))||Da(e))}_tinySDF(e,s,c){const p=this.localFontFamily;if(!p||!this._doesCharSupportLocalGlyph(c))return;let _=e.tinySDF;if(!_){let ke="400";/bold/i.test(s)?ke="900":/medium/i.test(s)?ke="500":/light/i.test(s)&&(ke="200"),_=e.tinySDF=new Lc.TinySDF({fontFamily:p,fontWeight:ke,fontSize:48,buffer:6,radius:16}),_.fontWeight=ke}if(this.localGlyphs[_.fontWeight][c])return this.localGlyphs[_.fontWeight][c];const v=String.fromCharCode(c),{data:T,width:M,height:z,glyphWidth:W,glyphHeight:ee,glyphLeft:oe,glyphTop:fe,glyphAdvance:Re}=_.draw(v);return this.localGlyphs[_.fontWeight][c]={id:c,bitmap:new Dl({width:M,height:z},T),metrics:{width:W/2,height:ee/2,left:oe/2,top:fe/2-27,advance:Re/2,localGlyph:!0}}}}function Cd(o,e,s,c){const p=[],_=o.image,v=_.pixelRatio,T=_.paddedRect.w-2,M=_.paddedRect.h-2,z=o.right-o.left,W=o.bottom-o.top,ee=_.stretchX||[[0,T]],oe=_.stretchY||[[0,M]],fe=(vn,In)=>vn+In[1]-In[0],Re=ee.reduce(fe,0),ke=oe.reduce(fe,0),tt=T-Re,mt=M-ke;let It=0,Ut=Re,jt=0,qt=ke,Gt=0,gn=tt,Dn=0,Rn=mt;if(_.content&&c){const vn=_.content;It=Td(ee,0,vn[0]),jt=Td(oe,0,vn[1]),Ut=Td(ee,vn[0],vn[2]),qt=Td(oe,vn[1],vn[3]),Gt=vn[0]-It,Dn=vn[1]-jt,gn=vn[2]-vn[0]-Ut,Rn=vn[3]-vn[1]-qt}const Ln=(vn,In,zn,Cn)=>{const Si=Nu(vn.stretch-It,Ut,z,o.left),Wn=Ed(vn.fixed-Gt,gn,vn.stretch,Re),Mr=Nu(In.stretch-jt,qt,W,o.top),Pi=Ed(In.fixed-Dn,Rn,In.stretch,ke),lr=Nu(zn.stretch-It,Ut,z,o.left),gi=Ed(zn.fixed-Gt,gn,zn.stretch,Re),Oi=Nu(Cn.stretch-jt,qt,W,o.top),gr=Ed(Cn.fixed-Dn,Rn,Cn.stretch,ke),Ao=new H(Si,Mr),lo=new H(lr,Mr),Mo=new H(lr,Oi),So=new H(Si,Oi),_o=new H(Wn/v,Pi/v),ir=new H(gi/v,gr/v),zr=e*Math.PI/180;if(zr){const $o=Math.sin(zr),Po=Math.cos(zr),Ur=[Po,-$o,$o,Po];Ao._matMult(Ur),lo._matMult(Ur),So._matMult(Ur),Mo._matMult(Ur)}const is=vn.stretch+vn.fixed,co=In.stretch+In.fixed;return{tl:Ao,tr:lo,bl:So,br:Mo,tex:{x:_.paddedRect.x+1+is,y:_.paddedRect.y+1+co,w:zn.stretch+zn.fixed-is,h:Cn.stretch+Cn.fixed-co},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:_o,pixelOffsetBR:ir,minFontScaleX:gn/v/z,minFontScaleY:Rn/v/W,isSDF:s}};if(c&&(_.stretchX||_.stretchY)){const vn=Sl(ee,tt,Re),In=Sl(oe,mt,ke);for(let zn=0;zn<vn.length-1;zn++){const Cn=vn[zn],Si=vn[zn+1];for(let Wn=0;Wn<In.length-1;Wn++)p.push(Ln(Cn,In[Wn],Si,In[Wn+1]))}}else p.push(Ln({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:M+1}));return p}function Td(o,e,s){let c=0;for(const p of o)c+=Math.max(e,Math.min(s,p[1]))-Math.max(e,Math.min(s,p[0]));return c}function Sl(o,e,s){const c=[{fixed:-1,stretch:0}];for(const[p,_]of o){const v=c[c.length-1];c.push({fixed:p-v.stretch,stretch:v.stretch}),c.push({fixed:p-v.stretch,stretch:v.stretch+(_-p)})}return c.push({fixed:e+1,stretch:s}),c}function Nu(o,e,s,c){return o/e*s+c}function Ed(o,e,s,c){return o-e*s/c}function Bh(o,e,s,c){const p=e+o.positionedLines[c].lineOffset;return 0===c?s+p/2:s+(p+(e+o.positionedLines[c-1].lineOffset))/2}Lc.loadGlyphRange=function(o,e,s,c,p){const _=256*e,v=_+255,T=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",o).replace("{range}",`${_}-${v}`),mr.Glyphs);ie(T,(M,z)=>{if(M)p(M);else if(z){const W={},ee=new Lu(z).readFields(Cf,{});for(const oe of ee.glyphs)W[oe.id]=oe;p(null,{glyphs:W,ascender:ee.ascender,descender:ee.descender})}})},Lc.TinySDF=class{constructor({fontSize:o=24,buffer:e=3,radius:s=8,cutoff:c=.25,fontFamily:p="sans-serif",fontWeight:_="normal",fontStyle:v="normal"}){this.buffer=e,this.cutoff=c,this.radius=s;const T=this.size=o+4*e,M=this._createCanvas(T),z=this.ctx=M.getContext("2d",{willReadFrequently:!0});z.font=`${v} ${_} ${o}px ${p}`,z.textBaseline="alphabetic",z.textAlign="left",z.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(o){const e=document.createElement("canvas");return e.width=e.height=o,e}draw(o){const{width:e,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:p,actualBoundingBoxRight:_}=this.ctx.measureText(o),v=Math.floor(s),T=Math.min(this.size-this.buffer,Math.ceil(_-p)),M=Math.min(this.size-this.buffer,Math.ceil(s)+Math.ceil(c)),z=T+2*this.buffer,W=M+2*this.buffer,ee=z*W,oe=new Uint8ClampedArray(ee),fe={data:oe,width:z,height:W,glyphWidth:T,glyphHeight:M,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(0===T||0===M)return fe;const{ctx:Re,buffer:ke,gridInner:tt,gridOuter:mt}=this;Re.clearRect(ke,ke,T,M),Re.fillText(o,ke,ke+v+1);const It=Re.getImageData(ke,ke,T,M);mt.fill(Oc,0,ee),tt.fill(0,0,ee);for(let Ut=0;Ut<M;Ut++)for(let jt=0;jt<T;jt++){const qt=It.data[4*(Ut*T+jt)+3]/255;if(0===qt)continue;const Gt=(Ut+ke)*z+jt+ke;if(1===qt)mt[Gt]=0,tt[Gt]=Oc;else{const gn=.5-qt;mt[Gt]=gn>0?gn*gn:0,tt[Gt]=gn<0?gn*gn:0}}Af(mt,0,0,z,W,z,this.f,this.v,this.z),Af(tt,ke,ke,T,M,z,this.f,this.v,this.z);for(let Ut=0;Ut<ee;Ut++){const jt=Math.sqrt(mt[Ut])-Math.sqrt(tt[Ut]);oe[Ut]=Math.round(255-255*(jt/this.radius+this.cutoff))}return fe}};class fm{constructor(e=[],s=Mf){if(this.data=e,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:s,compare:c}=this,p=s[e];for(;e>0;){const _=e-1>>1,v=s[_];if(c(p,v)>=0)break;s[e]=v,e=_}s[e]=p}_down(e){const{data:s,compare:c}=this,p=this.length>>1,_=s[e];for(;e<p;){let v=1+(e<<1),T=s[v];const M=v+1;if(M<this.length&&c(s[M],T)<0&&(v=M,T=s[M]),c(T,_)>=0)break;s[e]=T,e=v}s[e]=_}}function Mf(o,e){return o<e?-1:o>e?1:0}function gm(o,e=1,s=!1){let c=1/0,p=1/0,_=-1/0,v=-1/0;const T=o[0];for(let fe=0;fe<T.length;fe++){const Re=T[fe];(!fe||Re.x<c)&&(c=Re.x),(!fe||Re.y<p)&&(p=Re.y),(!fe||Re.x>_)&&(_=Re.x),(!fe||Re.y>v)&&(v=Re.y)}const M=Math.min(_-c,v-p);let z=M/2;const W=new fm([],mm);if(0===M)return new H(c,p);for(let fe=c;fe<_;fe+=M)for(let Re=p;Re<v;Re+=M)W.push(new cl(fe+z,Re+z,z,o));let ee=function(fe){let Re=0,ke=0,tt=0;const mt=fe[0];for(let It=0,Ut=mt.length,jt=Ut-1;It<Ut;jt=It++){const qt=mt[It],Gt=mt[jt],gn=qt.x*Gt.y-Gt.x*qt.y;ke+=(qt.x+Gt.x)*gn,tt+=(qt.y+Gt.y)*gn,Re+=3*gn}return new cl(ke/Re,tt/Re,0,fe)}(o),oe=W.length;for(;W.length;){const fe=W.pop();(fe.d>ee.d||!ee.d)&&(ee=fe,s&&console.log("found best %d after %d probes",Math.round(1e4*fe.d)/1e4,oe)),fe.max-ee.d<=e||(z=fe.h/2,W.push(new cl(fe.p.x-z,fe.p.y-z,z,o)),W.push(new cl(fe.p.x+z,fe.p.y-z,z,o)),W.push(new cl(fe.p.x-z,fe.p.y+z,z,o)),W.push(new cl(fe.p.x+z,fe.p.y+z,z,o)),oe+=4)}return s&&(console.log(`num probes: ${oe}`),console.log(`best distance: ${ee.d}`)),ee.p}function mm(o,e){return e.max-o.max}function cl(o,e,s,c){this.p=new H(o,e),this.h=s,this.d=function(p,_){let v=!1,T=1/0;for(let M=0;M<_.length;M++){const z=_[M];for(let W=0,ee=z.length,oe=ee-1;W<ee;oe=W++){const fe=z[W],Re=z[oe];fe.y>p.y!=Re.y>p.y&&p.x<(Re.x-fe.x)*(p.y-fe.y)/(Re.y-fe.y)+fe.x&&(v=!v),T=Math.min(T,nd(p,fe,Re))}}return(v?1:-1)*Math.sqrt(T)}(this.p,c),this.max=this.d+this.h*Math.SQRT2}const oc=Number.POSITIVE_INFINITY,zh=Math.sqrt(2);function kc(o,e){return e[1]!==oc?function(s,c,p){let _=0,v=0;switch(c=Math.abs(c),p=Math.abs(p),s){case"top-right":case"top-left":case"top":v=p-7;break;case"bottom-right":case"bottom-left":case"bottom":v=7-p}switch(s){case"top-right":case"bottom-right":case"right":_=-c;break;case"top-left":case"bottom-left":case"left":_=c}return[_,v]}(o,e[0],e[1]):function(s,c){let p=0,_=0;c<0&&(c=0);const v=c/zh;switch(s){case"top-right":case"top-left":_=v-7;break;case"bottom-right":case"bottom-left":_=7-v;break;case"bottom":_=7-c;break;case"top":_=c-7}switch(s){case"top-right":case"bottom-right":p=-v;break;case"top-left":case"bottom-left":p=v;break;case"left":p=c;break;case"right":p=-c}return[p,_]}(o,e[0])}function Bu(o,e,s,c,p,_,v,T){o.createArrays(),o.tilePixelRatio=Rr/(512*o.overscaling),o.compareText={},o.iconsNeedLinear=!1;const M=o.layers[0].layout,z=o.layers[0]._unevaluatedLayout._values,W={};if("composite"===o.textSizeData.kind){const{minZoom:fe,maxZoom:Re}=o.textSizeData;W.compositeTextSizes=[z["text-size"].possiblyEvaluate(new Me(fe),v),z["text-size"].possiblyEvaluate(new Me(Re),v)]}if("composite"===o.iconSizeData.kind){const{minZoom:fe,maxZoom:Re}=o.iconSizeData;W.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new Me(fe),v),z["icon-size"].possiblyEvaluate(new Me(Re),v)]}W.layoutTextSize=z["text-size"].possiblyEvaluate(new Me(T+1),v),W.layoutIconSize=z["icon-size"].possiblyEvaluate(new Me(T+1),v),W.textMaxSize=z["text-size"].possiblyEvaluate(new Me(18),v);const ee="map"===M.get("text-rotation-alignment")&&"point"!==M.get("symbol-placement"),oe=M.get("text-size");for(const fe of o.features){const Re=M.get("text-font").evaluate(fe,{},v).join(","),ke=oe.evaluate(fe,{},v),tt=W.layoutTextSize.evaluate(fe,{},v),mt=(W.layoutIconSize.evaluate(fe,{},v),{horizontal:{},vertical:void 0}),It=fe.text;let Ut,jt=[0,0];if(It){const gn=It.toString(),Dn=24*M.get("text-letter-spacing").evaluate(fe,{},v),Rn=24*M.get("text-line-height").evaluate(fe,{},v),Ln=Ma(gn)?Dn:0,vn=M.get("text-anchor").evaluate(fe,{},v),In=M.get("text-variable-anchor");if(!In){const Pi=M.get("text-radial-offset").evaluate(fe,{},v);jt=Pi?kc(vn,[24*Pi,oc]):M.get("text-offset").evaluate(fe,{},v).map(lr=>24*lr)}let zn=ee?"center":M.get("text-justify").evaluate(fe,{},v);const Cn=M.get("symbol-placement"),Si="point"===Cn,Wn="point"===Cn?24*M.get("text-max-width").evaluate(fe,{},v):0,Mr=Pi=>{o.allowVerticalPlacement&&es(gn)&&(mt.vertical=Ef(It,e,s,p,Re,Wn,Rn,vn,Pi,Ln,jt,Es.vertical,!0,Cn,tt,ke))};if(!ee&&In){const Pi="auto"===zn?In.map(gi=>sc(gi)):[zn];let lr=!1;for(let gi=0;gi<Pi.length;gi++){const Oi=Pi[gi];if(!mt.horizontal[Oi])if(lr)mt.horizontal[Oi]=mt.horizontal[0];else{const gr=Ef(It,e,s,p,Re,Wn,Rn,"center",Oi,Ln,jt,Es.horizontal,!1,Cn,tt,ke);gr&&(mt.horizontal[Oi]=gr,lr=1===gr.positionedLines.length)}}Mr("left")}else{if("auto"===zn&&(zn=sc(vn)),Si||M.get("text-writing-mode").indexOf("horizontal")>=0||!es(gn)){const Pi=Ef(It,e,s,p,Re,Wn,Rn,vn,zn,Ln,jt,Es.horizontal,!1,Cn,tt,ke);Pi&&(mt.horizontal[zn]=Pi)}Mr("point"===Cn?"left":zn)}}let qt=!1;if(fe.icon&&fe.icon.name){const gn=c[fe.icon.name];gn&&(Ut=gy(p[fe.icon.name],M.get("icon-offset").evaluate(fe,{},v),M.get("icon-anchor").evaluate(fe,{},v)),qt=gn.sdf,void 0===o.sdfIcons?o.sdfIcons=gn.sdf:o.sdfIcons!==gn.sdf&&Bt("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(gn.pixelRatio!==o.pixelRatio||0!==M.get("icon-rotate").constantOr(1))&&(o.iconsNeedLinear=!0))}const Gt=Id(mt.horizontal)||mt.vertical;o.iconsInText||(o.iconsInText=!!Gt&&Gt.iconsInText),(Gt||Ut)&&_m(o,fe,mt,Ut,c,W,tt,0,jt,qt,v)}_&&o.generateCollisionDebugBuffers(T,o.collisionBoxArray)}function sc(o){switch(o){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _m(o,e,s,c,p,_,v,T,M,z,W){let ee=_.textMaxSize.evaluate(e,{},W);void 0===ee&&(ee=v);const oe=o.layers[0].layout,fe=oe.get("icon-offset").evaluate(e,{},W),Re=Id(s.horizontal)||s.vertical,ke=v/24,tt=o.tilePixelRatio*ee/24,mt=o.tilePixelRatio*oe.get("symbol-spacing"),It=oe.get("text-padding")*o.tilePixelRatio,Ut=oe.get("icon-padding")*o.tilePixelRatio,jt=me(oe.get("text-max-angle")),qt="map"===oe.get("text-rotation-alignment")&&"point"!==oe.get("symbol-placement"),Gt="map"===oe.get("icon-rotation-alignment")&&"point"!==oe.get("symbol-placement"),gn=oe.get("symbol-placement"),Dn=mt/2,Rn=oe.get("icon-text-fit");let Ln;c&&"none"!==Rn&&(o.allowVerticalPlacement&&s.vertical&&(Ln=lm(c,s.vertical,Rn,oe.get("icon-text-fit-padding"),fe,ke)),Re&&(c=lm(c,Re,Rn,oe.get("icon-text-fit-padding"),fe,ke)));const vn=(In,zn)=>{zn.x<0||zn.x>=Rr||zn.y<0||zn.y>=Rr||function(Cn,Si,Wn,Mr,Pi,lr,gi,Oi,gr,Ao,lo,Mo,So,_o,ir,zr,is,co,$o,Po,Ur,Vs,so,jr){const po=Cn.addToLineVertexArray(Si,Mr);let rs,Go,yo,Tr,Is,ea,Wa,Zs=0,Ds=0,Ya=0,Ro=0,dl=-1,Uc=-1;const $s={};let ta=gu(""),Vc=0,os=0;if(void 0===gr._unevaluatedLayout.getValue("text-radial-offset")?[Vc,os]=gr.layout.get("text-offset").evaluate(Ur,{},jr).map(As=>24*As):(Vc=24*gr.layout.get("text-radial-offset").evaluate(Ur,{},jr),os=oc),Cn.allowVerticalPlacement&&Pi.vertical){const As=Pi.vertical;if(ir)ea=Dd(As),Oi&&(Wa=Dd(Oi));else{const Wo=gr.layout.get("text-rotate").evaluate(Ur,{},jr)+90;yo=cu(Ao,Wn,Si,lo,Mo,So,As,_o,Wo,zr),Oi&&(Tr=cu(Ao,Wn,Si,lo,Mo,So,Oi,co,Wo))}}if(lr){const As=gr.layout.get("icon-rotate").evaluate(Ur,{},jr),Wo="none"!==gr.layout.get("icon-text-fit"),hl=Cd(lr,As,so,Wo),uc=Oi?Cd(Oi,As,so,Wo):void 0;Go=cu(Ao,Wn,Si,lo,Mo,So,lr,co,As),Zs=4*hl.length;const Zc=Cn.iconSizeData;let Oa=null;"source"===Zc.kind?(Oa=[al*gr.layout.get("icon-size").evaluate(Ur,{},jr)],Oa[0]>Pl&&Bt(`${Cn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Zc.kind&&(Oa=[al*Vs.compositeIconSizes[0].evaluate(Ur,{},jr),al*Vs.compositeIconSizes[1].evaluate(Ur,{},jr)],(Oa[0]>Pl||Oa[1]>Pl)&&Bt(`${Cn.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),Cn.addSymbols(Cn.icon,hl,Oa,Po,$o,Ur,!1,Wn,Si,po.lineStartIndex,po.lineLength,-1,jr),dl=Cn.icon.placedSymbolArray.length-1,uc&&(Ds=4*uc.length,Cn.addSymbols(Cn.icon,uc,Oa,Po,$o,Ur,Es.vertical,Wn,Si,po.lineStartIndex,po.lineLength,-1,jr),Uc=Cn.icon.placedSymbolArray.length-1)}for(const As in Pi.horizontal){const Wo=Pi.horizontal[As];rs||(ta=gu(Wo.text),ir?Is=Dd(Wo):rs=cu(Ao,Wn,Si,lo,Mo,So,Wo,_o,gr.layout.get("text-rotate").evaluate(Ur,{},jr),zr));const hl=1===Wo.positionedLines.length;if(Ya+=Uh(Cn,Wn,Si,Wo,gi,gr,ir,Ur,zr,po,Pi.vertical?Es.horizontal:Es.horizontalOnly,hl?Object.keys(Pi.horizontal):[As],$s,dl,Vs,jr),hl)break}Pi.vertical&&(Ro+=Uh(Cn,Wn,Si,Pi.vertical,gi,gr,ir,Ur,zr,po,Es.vertical,["vertical"],$s,Uc,Vs,jr));let na=-1;const du=(As,Wo)=>As?Math.max(As,Wo):Wo;na=du(Is,na),na=du(ea,na),na=du(Wa,na);const Ra=na>-1?1:0;Cn.glyphOffsetArray.length>=ac.MAX_GLYPHS&&Bt("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Ur.sortKey&&Cn.addToSortKeyRanges(Cn.symbolInstances.length,Ur.sortKey),Cn.symbolInstances.emplaceBack(Wn.x,Wn.y,Wn.z,Si.x,Si.y,$s.right>=0?$s.right:-1,$s.center>=0?$s.center:-1,$s.left>=0?$s.left:-1,$s.vertical>=0?$s.vertical:-1,dl,Uc,ta,void 0!==rs?rs:Cn.collisionBoxArray.length,void 0!==rs?rs+1:Cn.collisionBoxArray.length,void 0!==yo?yo:Cn.collisionBoxArray.length,void 0!==yo?yo+1:Cn.collisionBoxArray.length,void 0!==Go?Go:Cn.collisionBoxArray.length,void 0!==Go?Go+1:Cn.collisionBoxArray.length,Tr||Cn.collisionBoxArray.length,Tr?Tr+1:Cn.collisionBoxArray.length,lo,Ya,Ro,Zs,Ds,Ra,0,Vc,os,na)}(o,zn,zn,In,s,c,p,Ln,o.layers[0],o.collisionBoxArray,e.index,e.sourceLayerIndex,o.index,It,qt,M,0,Ut,Gt,fe,e,_,z,W)};if("line"===gn)for(const In of Ml(e.geometry,0,0,Rr,Rr)){const zn=_y(In,mt,jt,s.vertical||Re,c,24,tt,o.overscaling,Rr);for(const Cn of zn){const Si=Re;Si&&Ad(o,Si.text,Dn,Cn)||vn(In,Cn)}}else if("line-center"===gn){for(const In of e.geometry)if(In.length>1){const zn=my(In,jt,s.vertical||Re,c,24,tt);zn&&vn(In,zn)}}else if("Polygon"===e.type)for(const In of pd(e.geometry,0)){const zn=gm(In,16);vn(In[0],new Rc(zn.x,zn.y,0,0,void 0))}else if("LineString"===e.type)for(const In of e.geometry)vn(In,new Rc(In[0].x,In[0].y,0,0,void 0));else if("Point"===e.type)for(const In of e.geometry)for(const zn of In)vn([zn],new Rc(zn.x,zn.y,0,0,void 0))}const Pl=32640;function Uh(o,e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke){const tt=function(Ut,jt,qt,Gt,gn,Dn,Rn,Ln){const vn=[];if(0===jt.positionedLines.length)return vn;const In=Gt.layout.get("text-rotate").evaluate(Dn,{})*Math.PI/180,zn=function(Pi){const lr=Pi[0],gi=Pi[1],Oi=lr*gi;return Oi>0?[lr,-gi]:Oi<0?[-lr,gi]:0===lr?[gi,lr]:[gi,-lr]}(qt);let Cn=Math.abs(jt.top-jt.bottom);for(const Pi of jt.positionedLines)Cn-=Pi.lineOffset;const Si=jt.positionedLines.length,Wn=Cn/Si;let Mr=jt.top-qt[1];for(let Pi=0;Pi<Si;++Pi){const lr=jt.positionedLines[Pi];Mr=Bh(jt,Wn,Mr,Pi);for(const gi of lr.positionedGlyphs){if(!gi.rect)continue;const Oi=gi.rect||{};let gr=4,Ao=!0,lo=1,Mo=0;if(gi.imageName){const Tr=Rn[gi.imageName];if(!Tr)continue;if(Tr.sdf){Bt("SDF images are not supported in formatted text and will be ignored.");continue}Ao=!1,lo=Tr.pixelRatio,gr=1/lo}const So=(gn||Ln)&&gi.vertical,_o=gi.metrics.advance*gi.scale/2,ir=gi.metrics,zr=gi.rect;if(null===zr)continue;Ln&&jt.verticalizable&&(Mo=gi.imageName?_o-gi.metrics.width*gi.scale/2:0);const is=gn?[gi.x+_o,gi.y]:[0,0];let co=[0,0],$o=[0,0],Po=!1;gn||(So?($o=[gi.x+_o+zn[0],gi.y+zn[1]-Mo],Po=!0):co=[gi.x+_o+qt[0],gi.y+qt[1]-Mo]);const Ur=zr.w*gi.scale/(lo*(gi.localGlyph?2:1)),Vs=zr.h*gi.scale/(lo*(gi.localGlyph?2:1));let so,jr,po,rs;if(So){const Tr=gi.y-Mr,Is=new H(-_o,_o-Tr),ea=-Math.PI/2,Wa=new H(...$o);so=new H(-_o+co[0],co[1]),so._rotateAround(ea,Is)._add(Wa),so.x+=-Tr+_o,so.y-=(ir.left-gr)*gi.scale;const Zs=gi.imageName?ir.advance*gi.scale:24*gi.scale,Ds=String.fromCharCode(gi.glyph);gf(Ds)?so.x+=(1-gr)*gi.scale:nm(Ds)?so.x+=Zs-ir.height*gi.scale+(-gr-1)*gi.scale:so.x+=gi.imageName||ir.width+2*gr===zr.w&&ir.height+2*gr===zr.h?(Zs-Vs)/2:(Zs-(ir.height+2*gr)*gi.scale)/2,jr=new H(so.x,so.y-Ur),po=new H(so.x+Vs,so.y),rs=new H(so.x+Vs,so.y-Ur)}else{const Tr=(ir.left-gr)*gi.scale-_o+co[0],Is=(-ir.top-gr)*gi.scale+co[1],ea=Tr+Ur,Wa=Is+Vs;so=new H(Tr,Is),jr=new H(ea,Is),po=new H(Tr,Wa),rs=new H(ea,Wa)}if(In){let Tr;Tr=gn?new H(0,0):Po?new H(zn[0],zn[1]):new H(qt[0],qt[1]),so._rotateAround(In,Tr),jr._rotateAround(In,Tr),po._rotateAround(In,Tr),rs._rotateAround(In,Tr)}const Go=new H(0,0),yo=new H(0,0);vn.push({tl:so,tr:jr,bl:po,br:rs,tex:Oi,writingMode:jt.writingMode,glyphOffset:is,sectionIndex:gi.sectionIndex,isSDF:Ao,pixelOffsetTL:Go,pixelOffsetBR:yo,minFontScaleX:0,minFontScaleY:0})}}return vn}(0,c,M,_,v,T,p,o.allowVerticalPlacement),mt=o.textSizeData;let It=null;"source"===mt.kind?(It=[al*_.layout.get("text-size").evaluate(T,{},ke)],It[0]>Pl&&Bt(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===mt.kind&&(It=[al*Re.compositeTextSizes[0].evaluate(T,{},ke),al*Re.compositeTextSizes[1].evaluate(T,{},ke)],(It[0]>Pl||It[1]>Pl)&&Bt(`${o.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),o.addSymbols(o.text,tt,It,M,v,T,W,e,s,z.lineStartIndex,z.lineLength,fe,ke);for(const Ut of ee)oe[Ut]=o.text.placedSymbolArray.length-1;return 4*tt.length}function Id(o){for(const e in o)return o[e];return null}function cu(o,e,s,c,p,_,v,T,M,z){let W=v.top,ee=v.bottom,oe=v.left,fe=v.right;const Re=v.collisionPadding;if(Re&&(oe-=Re[0],W-=Re[1],fe+=Re[2],ee+=Re[3]),M){const ke=new H(oe,W),tt=new H(fe,W),mt=new H(oe,ee),It=new H(fe,ee),Ut=me(M);let jt=new H(0,0);z&&(jt=new H(z[0],z[1])),ke._rotateAround(Ut,jt),tt._rotateAround(Ut,jt),mt._rotateAround(Ut,jt),It._rotateAround(Ut,jt),oe=Math.min(ke.x,tt.x,mt.x,It.x),fe=Math.max(ke.x,tt.x,mt.x,It.x),W=Math.min(ke.y,tt.y,mt.y,It.y),ee=Math.max(ke.y,tt.y,mt.y,It.y)}return o.emplaceBack(e.x,e.y,e.z,s.x,s.y,oe,W,fe,ee,T,c,p,_),o.length-1}function Dd(o){o.collisionPadding&&(o.top-=o.collisionPadding[1],o.bottom+=o.collisionPadding[3]);const e=o.bottom-o.top;return e>0?Math.max(10,e):null}function Ad(o,e,s,c){const p=o.compareText;if(e in p){const _=p[e];for(let v=_.length-1;v>=0;v--)if(c.dist(_[v])<s)return!0}else p[e]=[];return p[e].push(c),!1}const ym=Mc.VectorTileFeature.types,Sf=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Vh(o,e,s,c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke){const tt=W?Math.min(Pl,Math.round(W[0])):0,mt=W?Math.min(Pl,Math.round(W[1])):0;o.emplaceBack(e,s,Math.round(32*v),Math.round(32*T),M,z,(tt<<1)+(ee?1:0),mt,16*oe,16*fe,256*Re,256*ke,c,p,_,0)}function Md(o,e,s){o.emplaceBack(e.x,e.y,s),o.emplaceBack(e.x,e.y,s),o.emplaceBack(e.x,e.y,s),o.emplaceBack(e.x,e.y,s)}function Pf(o){for(const e of o.sections)if(g(e.text))return!0;return!1}class Zh{constructor(e){this.layoutVertexArray=new Ys,this.indexArray=new Zi,this.programConfigurations=e,this.segments=new ps,this.dynamicLayoutVertexArray=new ki,this.opacityVertexArray=new Js,this.placedSymbolArray=new Cl}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,s,c,p){this.isEmpty()||(c&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Sh.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,df.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,Sf,!0),this.opacityVertexBuffer.itemSize=1),(c||p)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Jn("SymbolBuffers",Zh);class Sd{constructor(e,s,c){this.layoutVertexArray=new e,this.layoutAttributes=s,this.indexArray=new c,this.segments=new ps,this.collisionVertexArray=new Ba,this.collisionVertexArrayExt=new ki}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Ph.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Ru.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Jn("CollisionBuffers",Sd);class ac{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(v=>v.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=yu([]),this.placementViewportMatrix=yu([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=yd(this.zoom,s["text-size"]),this.iconSizeData=yd(this.zoom,s["icon-size"]);const c=this.layers[0].layout,p=c.get("symbol-sort-key"),_=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&void 0!==p.constantOr(1),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(v=>Es[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=e.sourceID}createArrays(){this.text=new Zh(new zs(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Zh(new zs(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new Dp,this.lineVertexArray=new Ap,this.symbolInstances=new ah}calculateGlyphDependencies(e,s,c,p,_){for(let v=0;v<e.length;v++)if(s[e.charCodeAt(v)]=!0,p&&_){const T=Ou[e.charAt(v)];T&&(s[T.charCodeAt(0)]=!0)}}populate(e,s,c){const p=this.layers[0],_=p.layout,v=_.get("text-font"),T=_.get("text-field"),M=_.get("icon-image"),z=("constant"!==T.value.kind||T.value.value instanceof Et&&!T.value.value.isEmpty()||T.value.value.toString().length>0)&&("constant"!==v.value.kind||v.value.value.length>0),W="constant"!==M.value.kind||!!M.value.value||Object.keys(M.parameters).length>0,ee=_.get("symbol-sort-key");if(this.features=[],!z&&!W)return;const oe=s.iconDependencies,fe=s.glyphDependencies,Re=s.availableImages,ke=new Me(this.zoom);for(const{feature:tt,id:mt,index:It,sourceLayerIndex:Ut}of e){const jt=p._featureFilter.needGeometry,qt=Za(tt,jt);if(!p._featureFilter.filter(ke,qt,c))continue;let Gt,gn;if(jt||(qt.geometry=Ic(tt)),z){const Rn=p.getValueAndResolveTokens("text-field",qt,c,Re),Ln=Et.factory(Rn);Pf(Ln)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===he()||this.hasRTLText&&Ce.isParsed())&&(Gt=ff(Ln,p,qt))}if(W){const Rn=p.getValueAndResolveTokens("icon-image",qt,c,Re);gn=Rn instanceof Qt?Rn:Qt.fromString(Rn)}if(!Gt&&!gn)continue;const Dn=this.sortFeaturesByKey?ee.evaluate(qt,{},c):void 0;if(this.features.push({id:mt,text:Gt,icon:gn,index:It,sourceLayerIndex:Ut,geometry:qt.geometry,properties:tt.properties,type:ym[tt.type],sortKey:Dn}),gn&&(oe[gn.name]=!0),Gt){const Rn=v.evaluate(qt,{},c).join(","),Ln="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Es.vertical)>=0;for(const vn of Gt.sections)if(vn.image)oe[vn.image.name]=!0;else{const In=es(Gt.toString()),zn=vn.fontStack||Rn,Cn=fe[zn]=fe[zn]||{};this.calculateGlyphDependencies(vn.text,Cn,Ln,this.allowVerticalPlacement,In)}}}"line"===_.get("symbol-placement")&&(this.features=function(tt){const mt={},It={},Ut=[];let jt=0;function qt(Rn){Ut.push(tt[Rn]),jt++}function Gt(Rn,Ln,vn){const In=It[Rn];return delete It[Rn],It[Ln]=In,Ut[In].geometry[0].pop(),Ut[In].geometry[0]=Ut[In].geometry[0].concat(vn[0]),In}function gn(Rn,Ln,vn){const In=mt[Ln];return delete mt[Ln],mt[Rn]=In,Ut[In].geometry[0].shift(),Ut[In].geometry[0]=vn[0].concat(Ut[In].geometry[0]),In}function Dn(Rn,Ln,vn){const In=vn?Ln[0][Ln[0].length-1]:Ln[0][0];return`${Rn}:${In.x}:${In.y}`}for(let Rn=0;Rn<tt.length;Rn++){const Ln=tt[Rn],vn=Ln.geometry,In=Ln.text?Ln.text.toString():null;if(!In){qt(Rn);continue}const zn=Dn(In,vn),Cn=Dn(In,vn,!0);if(zn in It&&Cn in mt&&It[zn]!==mt[Cn]){const Si=gn(zn,Cn,vn),Wn=Gt(zn,Cn,Ut[Si].geometry);delete mt[zn],delete It[Cn],It[Dn(In,Ut[Wn].geometry,!0)]=Wn,Ut[Si].geometry=null}else zn in It?Gt(zn,Cn,vn):Cn in mt?gn(zn,Cn,vn):(qt(Rn),mt[zn]=jt-1,It[Cn]=jt-1)}return Ut.filter(Rn=>Rn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((tt,mt)=>tt.sortKey-mt.sortKey)}update(e,s,c){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,s,this.layers,c),this.icon.programConfigurations.updatePaintArrays(e,s,this.layers,c))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,s){const c=this.lineVertexArray.length;if(void 0!==e.segment){let p=e.dist(s[e.segment+1]),_=e.dist(s[e.segment]);const v={};for(let T=e.segment+1;T<s.length;T++)v[T]={x:s[T].x,y:s[T].y,tileUnitDistanceFromAnchor:p},T<s.length-1&&(p+=s[T+1].dist(s[T]));for(let T=e.segment||0;T>=0;T--)v[T]={x:s[T].x,y:s[T].y,tileUnitDistanceFromAnchor:_},T>0&&(_+=s[T-1].dist(s[T]));for(let T=0;T<s.length;T++){const M=v[T];this.lineVertexArray.emplaceBack(M.x,M.y,M.tileUnitDistanceFromAnchor)}}return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(e,s,c,p,_,v,T,M,z,W,ee,oe,fe){const Re=e.indexArray,ke=e.layoutVertexArray,tt=e.segments.prepareSegment(4*s.length,ke,Re,this.canOverlap?v.sortKey:void 0),mt=this.glyphOffsetArray.length,It=tt.vertexLength,Ut=this.allowVerticalPlacement&&T===Es.vertical?Math.PI/2:0,jt=v.text&&v.text.sections;for(let qt=0;qt<s.length;qt++){const{tl:Gt,tr:gn,bl:Dn,br:Rn,tex:Ln,pixelOffsetTL:vn,pixelOffsetBR:In,minFontScaleX:zn,minFontScaleY:Cn,glyphOffset:Si,isSDF:Wn,sectionIndex:Mr}=s[qt],Pi=tt.vertexLength,lr=Si[1];Vh(ke,M.x,M.y,M.z,z.x,z.y,Gt.x,lr+Gt.y,Ln.x,Ln.y,c,Wn,vn.x,vn.y,zn,Cn),Vh(ke,M.x,M.y,M.z,z.x,z.y,gn.x,lr+gn.y,Ln.x+Ln.w,Ln.y,c,Wn,In.x,vn.y,zn,Cn),Vh(ke,M.x,M.y,M.z,z.x,z.y,Dn.x,lr+Dn.y,Ln.x,Ln.y+Ln.h,c,Wn,vn.x,In.y,zn,Cn),Vh(ke,M.x,M.y,M.z,z.x,z.y,Rn.x,lr+Rn.y,Ln.x+Ln.w,Ln.y+Ln.h,c,Wn,In.x,In.y,zn,Cn),Md(e.dynamicLayoutVertexArray,M,Ut),Re.emplaceBack(Pi,Pi+1,Pi+2),Re.emplaceBack(Pi+1,Pi+2,Pi+3),tt.vertexLength+=4,tt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Si[0]),qt!==s.length-1&&Mr===s[qt+1].sectionIndex||e.programConfigurations.populatePaintArrays(ke.length,v,v.index,{},fe,jt&&jt[Mr])}e.placedSymbolArray.emplaceBack(M.x,M.y,M.z,z.x,z.y,mt,this.glyphOffsetArray.length-mt,It,W,ee,z.segment,c?c[0]:0,c?c[1]:0,p[0],p[1],T,0,!1,0,oe,0)}_commitLayoutVertex(e,s,c,p,_,v,T){e.emplaceBack(s,c,p,_,v,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(e,s,c,p,_,v,T){const M=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),z=M.vertexLength,W=T.tileAnchorX,ee=T.tileAnchorY;for(let fe=0;fe<4;fe++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(s,-e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(s,e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(s,e.padding,e.padding),c.collisionVertexArrayExt.emplaceBack(s,-e.padding,e.padding),this._commitLayoutVertex(c.layoutVertexArray,p,_,v,W,ee,new H(e.x1,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,p,_,v,W,ee,new H(e.x2,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,p,_,v,W,ee,new H(e.x2,e.y2)),this._commitLayoutVertex(c.layoutVertexArray,p,_,v,W,ee,new H(e.x1,e.y2)),M.vertexLength+=4;const oe=c.indexArray;oe.emplaceBack(z,z+1),oe.emplaceBack(z+1,z+2),oe.emplaceBack(z+2,z+3),oe.emplaceBack(z+3,z),M.primitiveLength+=4}_addTextDebugCollisionBoxes(e,s,c,p,_,v){for(let T=p;T<_;T++){const M=c.get(T),z=this.getSymbolInstanceTextSize(e,v,s,T);this._addCollisionDebugVertices(M,z,this.textCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(e,s,c,p,_,v){for(let T=p;T<_;T++){const M=c.get(T),z=this.getSymbolInstanceIconSize(e,s,T);this._addCollisionDebugVertices(M,z,this.iconCollisionBox,M.projectedAnchorX,M.projectedAnchorY,M.projectedAnchorZ,v)}}generateCollisionDebugBuffers(e,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Sd(Uo,hf.members,Zo),this.iconCollisionBox=new Sd(Uo,hf.members,Zo);const c=Sc(this.iconSizeData,e),p=Sc(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(p,e,s,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(p,e,s,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,e,s,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,e,s,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(e,s,c,p){const _=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:p),v=au(this.textSizeData,e,_)/24;return this.tilePixelRatio*v}getSymbolInstanceIconSize(e,s,c){const p=this.icon.placedSymbolArray.get(c),_=au(this.iconSizeData,e,p);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(e,s,c){e.emplaceBack(s,-c,-c),e.emplaceBack(s,c,-c),e.emplaceBack(s,c,c),e.emplaceBack(s,-c,c)}_updateTextDebugCollisionBoxes(e,s,c,p,_,v){for(let T=p;T<_;T++){const M=c.get(T),z=this.getSymbolInstanceTextSize(e,v,s,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,z,M.padding)}}_updateIconDebugCollisionBoxes(e,s,c,p,_){for(let v=p;v<_;v++){const T=c.get(v),M=this.getSymbolInstanceIconSize(e,s,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,T.padding)}}updateCollisionDebugBuffers(e,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Sc(this.iconSizeData,e),p=Sc(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(p,e,s,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(p,e,s,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(c,e,s,v.iconBoxStartIndex,v.iconBoxEndIndex),this._updateIconDebugCollisionBoxes(c,e,s,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,s,c,p,_,v,T,M,z){const W={};for(let ee=s;ee<c;ee++){const oe=e.get(ee);W.textBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,padding:oe.padding,projectedAnchorX:oe.projectedAnchorX,projectedAnchorY:oe.projectedAnchorY,projectedAnchorZ:oe.projectedAnchorZ,tileAnchorX:oe.tileAnchorX,tileAnchorY:oe.tileAnchorY},W.textFeatureIndex=oe.featureIndex;break}for(let ee=p;ee<_;ee++){const oe=e.get(ee);W.verticalTextBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,padding:oe.padding,projectedAnchorX:oe.projectedAnchorX,projectedAnchorY:oe.projectedAnchorY,projectedAnchorZ:oe.projectedAnchorZ,tileAnchorX:oe.tileAnchorX,tileAnchorY:oe.tileAnchorY},W.verticalTextFeatureIndex=oe.featureIndex;break}for(let ee=v;ee<T;ee++){const oe=e.get(ee);W.iconBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,padding:oe.padding,projectedAnchorX:oe.projectedAnchorX,projectedAnchorY:oe.projectedAnchorY,projectedAnchorZ:oe.projectedAnchorZ,tileAnchorX:oe.tileAnchorX,tileAnchorY:oe.tileAnchorY},W.iconFeatureIndex=oe.featureIndex;break}for(let ee=M;ee<z;ee++){const oe=e.get(ee);W.verticalIconBox={x1:oe.x1,y1:oe.y1,x2:oe.x2,y2:oe.y2,padding:oe.padding,projectedAnchorX:oe.projectedAnchorX,projectedAnchorY:oe.projectedAnchorY,projectedAnchorZ:oe.projectedAnchorZ,tileAnchorX:oe.tileAnchorX,tileAnchorY:oe.tileAnchorY},W.verticalIconFeatureIndex=oe.featureIndex;break}return W}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,s){const c=e.placedSymbolArray.get(s),p=c.vertexStartIndex+4*c.numGlyphs;for(let _=c.vertexStartIndex;_<p;_+=4)e.indexArray.emplaceBack(_,_+1,_+2),e.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const s=Math.sin(e),c=Math.cos(e),p=[],_=[],v=[];for(let T=0;T<this.symbolInstances.length;++T){v.push(T);const M=this.symbolInstances.get(T);p.push(0|Math.round(s*M.tileAnchorX+c*M.tileAnchorY)),_.push(M.featureIndex)}return v.sort((T,M)=>p[T]-p[M]||_[M]-_[T]),v}addToSortKeyRanges(e,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex),[c.rightJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.leftJustifiedTextSymbolIndex].forEach((p,_,v)=>{p>=0&&v.indexOf(p)===_&&this.addIndicesForPlacedSymbol(this.text,p)}),c.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,c.verticalPlacedTextSymbolIndex),c.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.placedIconSymbolIndex),c.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,c.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Jn("SymbolBucket",ac,{omit:["layers","collisionBoxArray","features","compareText"]}),ac.MAX_GLYPHS=65535,ac.addDynamicAttributes=Md;const vm=new sn({"symbol-placement":new nt(at.layout_symbol["symbol-placement"]),"symbol-spacing":new nt(at.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new nt(at.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new Pt(at.layout_symbol["symbol-sort-key"]),"symbol-z-order":new nt(at.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new nt(at.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new nt(at.layout_symbol["icon-ignore-placement"]),"icon-optional":new nt(at.layout_symbol["icon-optional"]),"icon-rotation-alignment":new nt(at.layout_symbol["icon-rotation-alignment"]),"icon-size":new Pt(at.layout_symbol["icon-size"]),"icon-text-fit":new nt(at.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new nt(at.layout_symbol["icon-text-fit-padding"]),"icon-image":new Pt(at.layout_symbol["icon-image"]),"icon-rotate":new Pt(at.layout_symbol["icon-rotate"]),"icon-padding":new nt(at.layout_symbol["icon-padding"]),"icon-keep-upright":new nt(at.layout_symbol["icon-keep-upright"]),"icon-offset":new Pt(at.layout_symbol["icon-offset"]),"icon-anchor":new Pt(at.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new nt(at.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new nt(at.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new nt(at.layout_symbol["text-rotation-alignment"]),"text-field":new Pt(at.layout_symbol["text-field"]),"text-font":new Pt(at.layout_symbol["text-font"]),"text-size":new Pt(at.layout_symbol["text-size"]),"text-max-width":new Pt(at.layout_symbol["text-max-width"]),"text-line-height":new Pt(at.layout_symbol["text-line-height"]),"text-letter-spacing":new Pt(at.layout_symbol["text-letter-spacing"]),"text-justify":new Pt(at.layout_symbol["text-justify"]),"text-radial-offset":new Pt(at.layout_symbol["text-radial-offset"]),"text-variable-anchor":new nt(at.layout_symbol["text-variable-anchor"]),"text-anchor":new Pt(at.layout_symbol["text-anchor"]),"text-max-angle":new nt(at.layout_symbol["text-max-angle"]),"text-writing-mode":new nt(at.layout_symbol["text-writing-mode"]),"text-rotate":new Pt(at.layout_symbol["text-rotate"]),"text-padding":new nt(at.layout_symbol["text-padding"]),"text-keep-upright":new nt(at.layout_symbol["text-keep-upright"]),"text-transform":new Pt(at.layout_symbol["text-transform"]),"text-offset":new Pt(at.layout_symbol["text-offset"]),"text-allow-overlap":new nt(at.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new nt(at.layout_symbol["text-ignore-placement"]),"text-optional":new nt(at.layout_symbol["text-optional"])});var Us={paint:new sn({"icon-opacity":new Pt(at.paint_symbol["icon-opacity"]),"icon-color":new Pt(at.paint_symbol["icon-color"]),"icon-halo-color":new Pt(at.paint_symbol["icon-halo-color"]),"icon-halo-width":new Pt(at.paint_symbol["icon-halo-width"]),"icon-halo-blur":new Pt(at.paint_symbol["icon-halo-blur"]),"icon-translate":new nt(at.paint_symbol["icon-translate"]),"icon-translate-anchor":new nt(at.paint_symbol["icon-translate-anchor"]),"text-opacity":new Pt(at.paint_symbol["text-opacity"]),"text-color":new Pt(at.paint_symbol["text-color"],{runtimeType:li,getOverride:o=>o.textColor,hasOverride:o=>!!o.textColor}),"text-halo-color":new Pt(at.paint_symbol["text-halo-color"]),"text-halo-width":new Pt(at.paint_symbol["text-halo-width"]),"text-halo-blur":new Pt(at.paint_symbol["text-halo-blur"]),"text-translate":new nt(at.paint_symbol["text-translate"]),"text-translate-anchor":new nt(at.paint_symbol["text-translate-anchor"])}),layout:vm};class Rf{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:En,this.defaultValue=e}evaluate(e){if(e.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(e.formattedSection))return s.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Jn("FormatSectionOverride",Rf,{omit:["defaultValue"]});class Pd extends Va{constructor(e){super(e,Us)}recalculate(e,s){super.recalculate(e,s),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const p=[];for(const _ of c)p.indexOf(_)<0&&p.push(_);this.layout._values["text-writing-mode"]=p}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,s,c,p){const _=this.layout.get(e).evaluate(s,{},c,p),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||A(v.value)||!_?_:(T=s.properties,_.replace(/{([^{}]+)}/g,(z,W)=>W in T?String(T[W]):""));var T}createBucket(e){return new ac(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of Us.paint.overridableProperties){if(!Pd.hasPaintOverride(this.layout,e))continue;const s=this.paint.get(e),c=new Rf(s),p=new Xo(c,s.property.specification);let _=null;_="constant"===s.value.kind||"source"===s.value.kind?new R("source",p):new ue("composite",p,s.value.zoomStops,s.value._interpolationType),this.paint._values[e]=new _t(s.property,_,s.parameters)}}_handleOverridablePaintPropertyUpdate(e,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&Pd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,s){const c=e.get("text-field"),p=Us.paint.properties[s];let _=!1;const v=T=>{for(const M of T)if(p.overrides&&p.overrides.hasOverride(M))return void(_=!0)};if("constant"===c.value.kind&&c.value.value instanceof Et)v(c.value.value.sections);else if("source"===c.value.kind){const T=z=>{_||(z instanceof Fn&&fn(z.value)===to?v(z.value.sections):z instanceof Sr?v(z.sections):z.eachChild(T))},M=c.value;M._styleExpression&&T(M._styleExpression.expression)}return _}getProgramConfiguration(e){return new Il(this,e)}}var yy={paint:new sn({"background-color":new nt(at.paint_background["background-color"]),"background-pattern":new wn(at.paint_background["background-pattern"]),"background-opacity":new nt(at.paint_background["background-opacity"])})},vy={paint:new sn({"raster-opacity":new nt(at.paint_raster["raster-opacity"]),"raster-hue-rotate":new nt(at.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new nt(at.paint_raster["raster-brightness-min"]),"raster-brightness-max":new nt(at.paint_raster["raster-brightness-max"]),"raster-saturation":new nt(at.paint_raster["raster-saturation"]),"raster-contrast":new nt(at.paint_raster["raster-contrast"]),"raster-resampling":new nt(at.paint_raster["raster-resampling"]),"raster-fade-duration":new nt(at.paint_raster["raster-fade-duration"])})};class Of extends Va{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}recalculate(){}updateTransitions(){}hasTransition(){}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var xy={paint:new sn({"sky-type":new nt(at.paint_sky["sky-type"]),"sky-atmosphere-sun":new nt(at.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new nt(at.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new nt(at.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new nt(at.paint_sky["sky-gradient-radius"]),"sky-gradient":new Rt(at.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new nt(at.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new nt(at.paint_sky["sky-atmosphere-color"]),"sky-opacity":new nt(at.paint_sky["sky-opacity"])})};function $h(o,e,s){const c=ec(0,0,1),p=ph(bu());return function(_,v,T){T*=.5;var M=v[0],z=v[1],W=v[2],ee=v[3],oe=Math.sin(T),fe=Math.cos(T);_[0]=M*fe-W*oe,_[1]=z*fe+ee*oe,_[2]=W*fe+M*oe,_[3]=ee*fe-z*oe}(p,p,s?-me(o)+Math.PI:me(o)),fh(p,p,-me(e)),Wp(c,c,p),Gp(c,c)}const jh={circle:class extends Va{constructor(o){super(o,Zp)}createBucket(o){return new Sa(o)}queryRadius(o){const e=o;return Dc("circle-radius",this,e)+Dc("circle-stroke-width",this,e)+rd(this.paint.get("circle-translate"))}queryIntersectsFeature(o,e,s,c,p,_,v,T){const M=Vp(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,o.pixelToTileUnitsFactor),z=this.paint.get("circle-radius").evaluate(e,s)+this.paint.get("circle-stroke-width").evaluate(e,s);return gs(o,c,_,v,T,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),M,z)}getProgramIds(){return["circle"]}getProgramConfiguration(o){return new Il(this,o)}},heatmap:class extends Va{createBucket(o){return new gh(o)}constructor(o){super(o,Vg),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"heatmap-color"===o&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=vh({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(o){return Dc("heatmap-radius",this,o)}queryIntersectsFeature(o,e,s,c,p,_,v,T){const M=this.paint.get("heatmap-radius").evaluate(e,s);return gs(o,c,_,v,T,!0,!0,new H(0,0),M)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(o){return new Il(this,o)}},hillshade:class extends Va{constructor(o){super(o,Yp)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}getProgramConfiguration(o){return new Il(this,o)}},fill:class extends Va{constructor(o){super(o,ef)}getProgramIds(){const o=this.paint.get("fill-pattern"),e=o&&o.constantOr(1),s=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(o){return new Il(this,o)}recalculate(o,e){super.recalculate(o,e);const s=this.paint._values["fill-outline-color"];"constant"===s.value.kind&&void 0===s.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(o){return new Au(o)}queryRadius(){return rd(this.paint.get("fill-translate"))}queryIntersectsFeature(o,e,s,c,p,_){return!o.queryGeometry.isAboveHorizon&&uh(Up(o.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,o.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends Va{constructor(o){super(o,of)}createBucket(o){return new Dh(o)}queryRadius(){return rd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(o){return new Il(this,o)}queryIntersectsFeature(o,e,s,c,p,_,v,T,M){const z=Vp(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,o.pixelToTileUnitsFactor),W=this.paint.get("fill-extrusion-height").evaluate(e,s),ee=this.paint.get("fill-extrusion-base").evaluate(e,s),oe=[0,0],fe=T&&_.elevation,Re=_.elevation?_.elevation.exaggeration():1;if(fe){const mt=o.tile.getBucket(this).centroidVertexArray,It=M+1;if(It<mt.length){const Ut=mt.get(It);oe[0]=Ut.a_centroid_pos0,oe[1]=Ut.a_centroid_pos1}}if(0===oe[0]&&1===oe[1])return!1;const ke=(mt=c,It=ee,Ut=W,jt=z,qt=v,(Gt=fe?T:null)?function(Ln,vn,In,zn,Cn,Si,Wn,Mr,Pi){const lr=[],gi=[],Oi=[0,0,0,1];for(const gr of Ln){const Ao=[],lo=[];for(const Mo of gr){const So=Mo.x+zn.x,_o=Mo.y+zn.y,ir=sf(So,_o,vn,In,Si,Wn,Mr,Pi);Oi[0]=So,Oi[1]=_o,Oi[2]=ir.base,Oi[3]=1,Ho(Oi,Oi,Cn),Oi[3]=Math.max(Oi[3],1e-5);const zr=Ah([Oi[0]/Oi[3],Oi[1]/Oi[3],Oi[2]/Oi[3]]);Oi[0]=So,Oi[1]=_o,Oi[2]=ir.top,Oi[3]=1,Ho(Oi,Oi,Cn),Oi[3]=Math.max(Oi[3],1e-5);const is=Ah([Oi[0]/Oi[3],Oi[1]/Oi[3],Oi[2]/Oi[3]]);Ao.push(zr),lo.push(is)}lr.push(Ao),gi.push(lo)}return[lr,gi]}(mt,It,Ut,jt,qt,Gt,oe,Re,_.center.lat):function(Ln,vn,In,zn,Cn){const Si=[],Wn=[],Mr=Cn[8]*vn,Pi=Cn[9]*vn,lr=Cn[10]*vn,gi=Cn[11]*vn,Oi=Cn[8]*In,gr=Cn[9]*In,Ao=Cn[10]*In,lo=Cn[11]*In;for(const Mo of Ln){const So=[],_o=[];for(const ir of Mo){const zr=ir.x+zn.x,is=ir.y+zn.y,co=Cn[0]*zr+Cn[4]*is+Cn[12],$o=Cn[1]*zr+Cn[5]*is+Cn[13],Po=Cn[2]*zr+Cn[6]*is+Cn[14],Ur=Cn[3]*zr+Cn[7]*is+Cn[15],Vs=co+Mr,so=$o+Pi,jr=Po+lr,po=Math.max(Ur+gi,1e-5),rs=co+Oi,Go=$o+gr,yo=Po+Ao,Tr=Math.max(Ur+lo,1e-5),Is=new H(Vs/po,so/po);Is.z=jr/po,So.push(Is);const ea=new H(rs/Tr,Go/Tr);ea.z=yo/Tr,_o.push(ea)}Si.push(So),Wn.push(_o)}return[Si,Wn]}(mt,It,Ut,jt,qt)),tt=o.queryGeometry;var mt,It,Ut,jt,qt,Gt;return function(mt,It,Ut){let jt=1/0;uh(Ut,It)&&(jt=nc(Ut,It[0]));for(let qt=0;qt<It.length;qt++){const Gt=It[qt],gn=mt[qt];for(let Dn=0;Dn<Gt.length-1;Dn++){const Rn=Gt[Dn],Ln=[Rn,Gt[Dn+1],gn[Dn+1],gn[Dn],Rn];eu(Ut,Ln)&&(jt=Math.min(jt,nc(Ut,Ln)))}}return jt!==1/0&&jt}(ke[0],ke[1],tt.isPointQuery()?tt.screenBounds:tt.screenGeometry)}},line:class extends Va{constructor(o){super(o,Su),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(o){if("line-gradient"===o){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Cr,this.gradientVersion=(this.gradientVersion+1)%G}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(o,e){super.recalculate(o,e),this.paint._values["line-floorwidth"]=Pu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,o)}createBucket(o){return new Mu(o)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(o){return new Il(this,o)}queryRadius(o){const e=o,s=Mh(Dc("line-width",this,e),Dc("line-gap-width",this,e)),c=Dc("line-offset",this,e);return s/2+Math.abs(c)+rd(this.paint.get("line-translate"))}queryIntersectsFeature(o,e,s,c,p,_){if(o.queryGeometry.isAboveHorizon)return!1;const v=Up(o.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,o.pixelToTileUnitsFactor),T=o.pixelToTileUnitsFactor/2*Mh(this.paint.get("line-width").evaluate(e,s),this.paint.get("line-gap-width").evaluate(e,s)),M=this.paint.get("line-offset").evaluate(e,s);return M&&(c=function(z,W){const ee=[],oe=new H(0,0);for(let fe=0;fe<z.length;fe++){const Re=z[fe],ke=[];for(let tt=0;tt<Re.length;tt++){const mt=Re[tt-1],It=Re[tt],Ut=Re[tt+1],jt=0===tt?oe:It.sub(mt)._unit()._perp(),qt=tt===Re.length-1?oe:Ut.sub(It)._unit()._perp(),Gt=jt._add(qt)._unit();Gt._mult(1/(Gt.x*qt.x+Gt.y*qt.y)),ke.push(Gt._mult(W)._add(It))}ee.push(ke)}return ee}(c,M*o.pixelToTileUnitsFactor)),function(z,W,ee){for(let oe=0;oe<W.length;oe++){const fe=W[oe];if(z.length>=3)for(let Re=0;Re<fe.length;Re++)if(Ql(z,fe[Re]))return!0;if(Np(z,fe,ee))return!0}return!1}(v,c,T)}isTileClipped(){return!0}},symbol:Pd,background:class extends Va{constructor(o){super(o,yy)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends Va{constructor(o){super(o,vy)}getProgramIds(){return["raster"]}},sky:class extends Va{constructor(o){super(o,xy),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(o){"sky-gradient"===o?this._updateColorRamp():"sky-atmosphere-sun"!==o&&"sky-atmosphere-halo-color"!==o&&"sky-atmosphere-color"!==o&&"sky-atmosphere-sun-intensity"!==o||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=vh({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(o){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=o.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}}getCenter(o,e){const s=this.paint.get("sky-type");if("atmosphere"===s){const c=this.paint.get("sky-atmosphere-sun"),p=!c,_=o.style.light,v=_.properties.get("position");return p&&"viewport"===_.properties.get("anchor")&&Bt("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),p?$h(v.azimuthal,90-v.polar,e):$h(c[0],90-c[1],e)}if("gradient"===s){const c=this.paint.get("sky-gradient-center");return $h(c[0],90-c[1],e)}}is3D(){return!1}isSky(){return!0}markSkyboxValid(o){this._skyboxInvalidated=!1,this._lightPosition=o.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const o=this.paint.get("sky-type");return"atmosphere"===o?["skyboxCapture","skybox"]:"gradient"===o?["skyboxGradient"]:null}}},{HTMLImageElement:qh,HTMLCanvasElement:Lf,HTMLVideoElement:kf,ImageData:Ff,ImageBitmap:zu}=K;class Rd{constructor(e,s,c,p){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(s,p)}update(e,s,c){const{width:p,height:_}=e,v=!(this.size&&this.size[0]===p&&this.size[1]===_||c),{context:T}=this,{gl:M}=T;if(this.useMipmap=Boolean(s&&s.useMipmap),M.bindTexture(M.TEXTURE_2D,this.texture),T.pixelStoreUnpackFlipY.set(!1),T.pixelStoreUnpack.set(1),T.pixelStoreUnpackPremultiplyAlpha.set(this.format===M.RGBA&&(!s||!1!==s.premultiply)),v)this.size=[p,_],e instanceof qh||e instanceof Lf||e instanceof kf||e instanceof Ff||zu&&e instanceof zu?M.texImage2D(M.TEXTURE_2D,0,this.format,this.format,M.UNSIGNED_BYTE,e):M.texImage2D(M.TEXTURE_2D,0,this.format,p,_,0,this.format,M.UNSIGNED_BYTE,e.data);else{const{x:z,y:W}=c||{x:0,y:0};e instanceof qh||e instanceof Lf||e instanceof kf||e instanceof Ff||zu&&e instanceof zu?M.texSubImage2D(M.TEXTURE_2D,0,z,W,M.RGBA,M.UNSIGNED_BYTE,e):M.texSubImage2D(M.TEXTURE_2D,0,z,W,p,_,M.RGBA,M.UNSIGNED_BYTE,e.data)}this.useMipmap&&this.isSizePowerOfTwo()&&M.generateMipmap(M.TEXTURE_2D)}bind(e,s,c){const{context:p}=this,{gl:_}=p;_.bindTexture(_.TEXTURE_2D,this.texture),c!==_.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=_.LINEAR),e!==this.filter&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MAG_FILTER,e),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_MIN_FILTER,c||e),this.filter=e),s!==this.wrap&&(_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_S,s),_.texParameteri(_.TEXTURE_2D,_.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class lc{constructor(e,s){e&&(s?this.setSouthWest(e).setNorthEast(s):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof ho?new ho(e.lng,e.lat):ho.convert(e),this}setSouthWest(e){return this._sw=e instanceof ho?new ho(e.lng,e.lat):ho.convert(e),this}extend(e){const s=this._sw,c=this._ne;let p,_;if(e instanceof ho)p=e,_=e;else{if(!(e instanceof lc))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(lc.convert(e)):this.extend(ho.convert(e)):this;if(p=e._sw,_=e._ne,!p||!_)return this}return s||c?(s.lng=Math.min(p.lng,s.lng),s.lat=Math.min(p.lat,s.lat),c.lng=Math.max(_.lng,c.lng),c.lat=Math.max(_.lat,c.lat)):(this._sw=new ho(p.lng,p.lat),this._ne=new ho(_.lng,_.lat)),this}getCenter(){return new ho((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ho(this.getWest(),this.getNorth())}getSouthEast(){return new ho(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:s,lat:c}=ho.convert(e);let p=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(p=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&p}static convert(e){return!e||e instanceof lc?e:new lc(e)}}const Nf=6371008.8;class ho{constructor(e,s){if(isNaN(e)||isNaN(s))throw new Error(`Invalid LngLat object: (${e}, ${s})`);if(this.lng=+e,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ho(Te(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const s=Math.PI/180,c=this.lat*s,p=e.lat*s,_=Math.sin(c)*Math.sin(p)+Math.cos(c)*Math.cos(p)*Math.cos((e.lng-this.lng)*s);return Nf*Math.acos(Math.min(_,1))}toBounds(e=0){const s=360*e/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new lc(new ho(this.lng-c,this.lat-s),new ho(this.lng+c,this.lat+s))}static convert(e){if(e instanceof ho)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new ho(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new ho(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const Hh=2*Math.PI*Nf;function Gh(o){return Hh*Math.cos(o*Math.PI/180)}function Bf(o){return(180+o)/360}function qa(o){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+o*Math.PI/360)))/360}function Uu(o,e){return o/Gh(e)}function Od(o){return 360/Math.PI*Math.atan(Math.exp((180-360*o)*Math.PI/180))-90}function Wh(o,e){return o*Gh(Od(e))}class Vu{constructor(e,s,c=0){this.x=+e,this.y=+s,this.z=+c}static fromLngLat(e,s=0){const c=ho.convert(e);return new Vu(Bf(c.lng),qa(c.lat),Uu(s,c.lat))}toLngLat(){return new ho(360*this.x-180,Od(this.y))}toAltitude(){return Wh(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Hh*(e=Od(this.y),1/Math.cos(e*Math.PI/180));var e}}class Ld{constructor(e,s){this.width=e,this.height=s,this.nextRow=0,this.image=new Dl({width:e,height:s}),this.positions={},this.uploaded=!1}getDash(e,s){const c=this.getKey(e,s);return this.positions[c]}trim(){const e=this.width,s=this.height=ct(this.nextRow);this.image.resize({width:e,height:s})}getKey(e,s){return e.join(",")+s}getDashRanges(e,s,c){const p=[];let _=e.length%2==1?-e[e.length-1]*c:0,v=e[0]*c,T=!0;p.push({left:_,right:v,isDash:T,zeroLength:0===e[0]});let M=e[0];for(let z=1;z<e.length;z++){T=!T;const W=e[z];_=M*c,M+=W,v=M*c,p.push({left:_,right:v,isDash:T,zeroLength:0===W})}return p}addRoundDash(e,s,c){const p=s/2;for(let _=-c;_<=c;_++){const v=this.width*(this.nextRow+c+_);let T=0,M=e[T];for(let z=0;z<this.width;z++){z/M.right>1&&(M=e[++T]);const W=Math.abs(z-M.left),ee=Math.abs(z-M.right),oe=Math.min(W,ee);let fe;const Re=_/c*(p+1);if(M.isDash){const ke=p-Math.abs(Re);fe=Math.sqrt(oe*oe+ke*ke)}else fe=p-Math.sqrt(oe*oe+Re*Re);this.image.data[v+z]=Math.max(0,Math.min(255,fe+128))}}}addRegularDash(e,s){for(let M=e.length-1;M>=0;--M){const z=e[M],W=e[M+1];z.zeroLength?e.splice(M,1):W&&W.isDash===z.isDash&&(W.left=z.left,e.splice(M,1))}const c=e[0],p=e[e.length-1];c.isDash===p.isDash&&(c.left=p.left-this.width,p.right=c.right+this.width);const _=this.width*this.nextRow;let v=0,T=e[v];for(let M=0;M<this.width;M++){M/T.right>1&&(T=e[++v]);const z=Math.abs(M-T.left),W=Math.abs(M-T.right),ee=Math.min(z,W);this.image.data[_+M]=Math.max(0,Math.min(255,(T.isDash?ee:-ee)+s+128))}}addDash(e,s){const c=this.getKey(e,s);if(this.positions[c])return this.positions[c];const p="round"===s,_=p?7:0,v=2*_+1;if(this.nextRow+v>this.height)return Bt("LineAtlas out of space"),null;0===e.length&&e.push(1);let T=0;for(let W=0;W<e.length;W++)e[W]<0&&(Bt("Negative value is found in line dasharray, replacing values with 0"),e[W]=0),T+=e[W];if(0!==T){const W=this.width/T,ee=this.getDashRanges(e,this.width,W);p?this.addRoundDash(ee,W,_):this.addRegularDash(ee,"square"===s?.5*W:0)}const M=this.nextRow+_;this.nextRow+=v;const z={tl:[M,_],br:[T,0]};return this.positions[c]=z,z}}Jn("LineAtlas",Ld);class xm{constructor(e){this._callback=e,this._triggered=!1,"undefined"!=typeof MessageChannel&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const bm=K.performance;function zf(o){const e=o?o.url.toString():void 0;return bm.getEntriesByName(e)}class Yh{constructor(){this.tasks={},this.taskQueue=[],bt(["process"],this),this.invoker=new xm(this.process),this.nextId=0}add(e,s){const c=this.nextId++,p=function({type:_,isSymbolTile:v,zoom:T}){return T=T||0,"message"===_?0:"maybePrepare"!==_||v?"parseTile"!==_||v?"parseTile"===_&&v?300-T:"maybePrepare"===_&&v?400-T:500:200-T:100-T}(s);if(0===p){Ot();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:e,metadata:s,priority:p,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){Ot();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const s=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}finally{}}pick(){let e=null,s=1/0;for(let p=0;p<this.taskQueue.length;p++){const _=this.tasks[this.taskQueue[p]];_.priority<s&&(s=_.priority,e=p)}if(null===e)return null;const c=this.taskQueue[e];return this.taskQueue.splice(e,1),c}remove(){this.invoker.remove()}}function Uf(o,e,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[o*c-2*Math.PI*6378137/2,e*c-2*Math.PI*6378137/2]}class Jh{constructor(e,s,c){this.z=e,this.x=s,this.y=c,this.key=$u(0,e,e,s,c)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,s){const c=(_=this.y,v=this.z,T=Uf(256*(p=this.x),256*(_=Math.pow(2,v)-_-1),v),M=Uf(256*(p+1),256*(_+1),v),T[0]+","+T[1]+","+M[0]+","+M[1]);var p,_,v,T,M;const z=function(W,ee,oe){let fe,Re="";for(let ke=W;ke>0;ke--)fe=1<<ke-1,Re+=(ee&fe?1:0)+(oe&fe?2:0);return Re}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace("{z}",String(this.z)).replace("{x}",String(this.x)).replace("{y}",String("tms"===s?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",z).replace("{bbox-epsg-3857}",c)}getTilePoint(e){const s=Math.pow(2,this.z);return new H((e.x*s-this.x)*Rr,(e.y*s-this.y)*Rr)}getTileVec3(e){const s=Math.pow(2,this.z);return ec((e.x*s-this.x)*Rr,(e.y*s-this.y)*Rr,Wh(e.z,e.y))}toString(){return`${this.z}/${this.x}/${this.y}`}}class Zu{constructor(e,s){this.wrap=e,this.canonical=s,this.key=$u(e,s.z,s.z,s.x,s.y)}}class ms{constructor(e,s,c,p,_){this.overscaledZ=e,this.wrap=s,this.canonical=new Jh(c,+p,+_),this.key=0===s&&e===c?this.canonical.key:$u(s,e,c,p,_)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const s=this.canonical.z-e;return e>this.canonical.z?new ms(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new ms(e,this.wrap,e,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(e,s=!0){if(this.overscaledZ===e&&s)return this.key;if(e>this.canonical.z)return $u(this.wrap*+s,e,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-e;return $u(this.wrap*+s,e,e,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const s=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>s&&e.canonical.y===this.canonical.y>>s}children(e){if(this.overscaledZ>=e)return[new ms(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,p=2*this.canonical.y;return[new ms(s,this.wrap,s,c,p),new ms(s,this.wrap,s,c+1,p),new ms(s,this.wrap,s,c,p+1),new ms(s,this.wrap,s,c+1,p+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new ms(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new ms(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Zu(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Vu(e.x-this.wrap,e.y))}getTileVec3(e){return this.canonical.getTileVec3(new Vu(e.x-this.wrap,e.y,e.z))}}function $u(o,e,s,c,p){const _=1<<Math.min(s,22);let v=_*(p%_)+c%_;return o&&s<22&&(v+=_*_*((o<0?-2*o-1:2*o)%(1<<2*(22-s)))),16*(32*v+s)+(e-s)}Jn("CanonicalTileID",Jh),Jn("OverscaledTileID",ms,{omit:["projMatrix"]});class kd{constructor(e){this._stringToNumber={},this._numberToString=[];for(let s=0;s<e.length;s++){const c=e[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}class Fd{constructor(e,s,c,p,_){this.type="Feature",this._vectorTileFeature=e,e._z=s,e._x=c,e._y=p,this.properties=e.properties,this.id=_}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const s in this)"_geometry"!==s&&"_vectorTileFeature"!==s&&(e[s]=this[s]);return e}}var Vf=Xn([{name:"a_pos",type:"Int16",components:2}]);class Zf{constructor(e,s,c){this.tileID=e,this.uid=Qe(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(e){const s=e+this.timeAdded;s<cn.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}loadVectorData(e,s,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(p,_){const v={};if(!_)return v;for(const T of p){const M=T.layerIds.map(z=>_.getLayer(z)).filter(Boolean);if(0!==M.length){T.layers=M,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(z=>M.filter(W=>W.id===z)[0]));for(const z of M)v[z.id]=T}}return v}(e.buckets,s.style),this.hasSymbolBuckets=!1;for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof ac){if(this.hasSymbolBuckets=!0,!c)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const p in this.buckets){const _=this.buckets[p];if(_ instanceof ac&&_.hasRTLText){this.hasRTLText=!0,Ce.isLoading()||Ce.isLoaded()||"deferred"!==he()||be();break}}this.queryPadding=0;for(const p in this.buckets){const _=this.buckets[p];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(p).queryRadius(_))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new wl}unloadVectorData(){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const p=this.buckets[c];p.uploadPending()&&p.upload(e)}const s=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Rd(e,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Rd(e,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Rd(e,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,s,c,p,_,v,T,M){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:p,pixelPosMatrix:T,transform:v,params:_},e,s,c):{}}querySourceFeatures(e,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const p=c.loadVTLayers(),_=s?s.sourceLayer:"",v=p._geojsonTileLayer||p[_];if(!v)return;const T=Xr(s&&s.filter),{z:M,x:z,y:W}=this.tileID.canonical,ee={z:M,x:z,y:W};for(let oe=0;oe<v.length;oe++){const fe=v.feature(oe);if(T.needGeometry){const tt=Za(fe,!0);if(!T.filter(new Me(this.tileID.overscaledZ),tt,this.tileID.canonical))continue}else if(!T.filter(new Me(this.tileID.overscaledZ),fe))continue;const Re=c.getId(fe,_),ke=new Fd(fe,M,z,W,Re);ke.tile=ee,e.push(ke)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const s=this.expirationTime;if(e.cacheControl){const c=Ft(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let p=!1;if(this.expirationTime>c)p=!1;else if(s)if(this.expirationTime<s)p=!0;else{const _=this.expirationTime-s;_?this.expirationTime=c+Math.max(_,3e4):p=!0}else p=!0;p?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length)return;const c=this.latestFeatureIndex.loadVTLayers();for(const p in this.buckets){if(!s.style.hasLayer(p))continue;const _=this.buckets[p],v=_.layers[0].sourceLayer||"_geojsonTileLayer",T=c[v],M=e[v];if(!T||!M||0===Object.keys(M).length)continue;_.update(M,T,this.imageAtlas&&this.imageAtlas.patternPositions||{});const z=s&&s.style&&s.style.getLayer(p);z&&(this.queryPadding=Math.max(this.queryPadding,z.queryRadius(_)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<cn.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=cn.now()+e}setDependencies(e,s){const c={};for(const p of s)c[p]=!0;this.dependencies[e]=c}hasDependency(e,s){for(const c of e){const p=this.dependencies[c];if(p)for(const _ of s)if(p[_])return!0}return!1}clearQueryDebugViz(){}}class wm{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,s,c){const p=String(s);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][p]=this.stateChanges[e][p]||{},Fe(this.stateChanges[e][p],c),null===this.deletedStates[e]){this.deletedStates[e]={};for(const _ in this.state[e])_!==p&&(this.deletedStates[e][_]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][p]){this.deletedStates[e][p]={};for(const _ in this.state[e][p])c[_]||(this.deletedStates[e][p][_]=null)}else for(const _ in c)this.deletedStates[e]&&this.deletedStates[e][p]&&null===this.deletedStates[e][p][_]&&delete this.deletedStates[e][p][_]}removeFeatureState(e,s,c){if(null===this.deletedStates[e])return;const p=String(s);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&void 0!==s)null!==this.deletedStates[e][p]&&(this.deletedStates[e][p]=this.deletedStates[e][p]||{},this.deletedStates[e][p][c]=null);else if(void 0!==s)if(this.stateChanges[e]&&this.stateChanges[e][p])for(c in this.deletedStates[e][p]={},this.stateChanges[e][p])this.deletedStates[e][p][c]=null;else this.deletedStates[e][p]=null;else this.deletedStates[e]=null}getState(e,s){const c=String(s),p=Fe({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const _=this.deletedStates[e][s];if(null===_)return{};for(const v in _)delete p[v]}return p}initializeTileState(e,s){e.setFeatureState(this.state,s)}coalesceChanges(e,s){const c={};for(const p in this.stateChanges){this.state[p]=this.state[p]||{};const _={};for(const v in this.stateChanges[p])this.state[p][v]||(this.state[p][v]={}),Fe(this.state[p][v],this.stateChanges[p][v]),_[v]=this.state[p][v];c[p]=_}for(const p in this.deletedStates){this.state[p]=this.state[p]||{};const _={};if(null===this.deletedStates[p])for(const v in this.state[p])_[v]={},this.state[p][v]={};else for(const v in this.deletedStates[p]){if(null===this.deletedStates[p][v])this.state[p][v]={};else for(const T of Object.keys(this.deletedStates[p][v]))delete this.state[p][v][T];_[v]=this.state[p][v]}c[p]=c[p]||{},Fe(c[p],_)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(const p in e)e[p].setFeatureState(c,s)}}class Nd{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,s){const c=this.toIdx(e,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(e,s){return this.leaves[this.toIdx(e,s)]}toIdx(e,s){return s*this.size+e}}function Cm(o,e,s,c){let p=0,_=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(c[v])<1e-15){if(s[v]<o[v]||s[v]>e[v])return null}else{const T=1/c[v];let M=(o[v]-s[v])*T,z=(e[v]-s[v])*T;if(M>z){const W=M;M=z,z=W}if(M>p&&(p=M),z<_&&(_=z),p>_)return null}return p}function $f(o,e,s,c,p,_,v,T,M,z,W){const ee=c-o,oe=p-e,fe=_-s,Re=v-o,ke=T-e,tt=M-s,mt=W[1]*tt-W[2]*ke,It=W[2]*Re-W[0]*tt,Ut=W[0]*ke-W[1]*Re,jt=ee*mt+oe*It+fe*Ut;if(Math.abs(jt)<1e-15)return null;const qt=1/jt,Gt=z[0]-o,gn=z[1]-e,Dn=z[2]-s,Rn=(Gt*mt+gn*It+Dn*Ut)*qt;if(Rn<0||Rn>1)return null;const Ln=gn*fe-Dn*oe,vn=Dn*ee-Gt*fe,In=Gt*oe-gn*ee,zn=(W[0]*Ln+W[1]*vn+W[2]*In)*qt;return zn<0||Rn+zn>1?null:(Re*Ln+ke*vn+tt*In)*qt}function Kh(o,e,s){return(o-e)/(s-e)}function Xh(o,e,s,c,p,_,v,T,M){const z=1<<s,W=_-c,ee=v-p,oe=(o+1)/z*W+c,fe=(e+0)/z*ee+p,Re=(e+1)/z*ee+p;T[0]=(o+0)/z*W+c,T[1]=fe,M[0]=oe,M[1]=Re}class Qh{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=function(_){const v=Math.ceil(Math.log2(_.dim/8)),T=[];let M=Math.ceil(Math.pow(2,v));const z=1/M,W=(fe,Re,ke,tt,mt)=>{const It=tt?1:0,Ut=(fe+1)*ke-It,jt=Re*ke,qt=(Re+1)*ke-It;mt[0]=fe*ke,mt[1]=jt,mt[2]=Ut,mt[3]=qt};let ee=new Nd(M);const oe=[];for(let fe=0;fe<M*M;fe++){W(fe%M,Math.floor(fe/M),z,!1,oe);const Re=Rl(oe[0],oe[1],_),ke=Rl(oe[2],oe[1],_),tt=Rl(oe[2],oe[3],_),mt=Rl(oe[0],oe[3],_);ee.minimums.push(Math.min(Re,ke,tt,mt)),ee.maximums.push(Math.max(Re,ke,tt,mt)),ee.leaves.push(1)}for(T.push(ee),M/=2;M>=1;M/=2){const fe=T[T.length-1];ee=new Nd(M);for(let Re=0;Re<M*M;Re++){W(Re%M,Math.floor(Re/M),2,!0,oe);const ke=fe.getElevation(oe[0],oe[1]),tt=fe.getElevation(oe[2],oe[1]),mt=fe.getElevation(oe[2],oe[3]),It=fe.getElevation(oe[0],oe[3]),Ut=fe.isLeaf(oe[0],oe[1]),jt=fe.isLeaf(oe[2],oe[1]),qt=fe.isLeaf(oe[2],oe[3]),Gt=fe.isLeaf(oe[0],oe[3]),gn=Math.min(ke.min,tt.min,mt.min,It.min),Dn=Math.max(ke.max,tt.max,mt.max,It.max),Rn=Ut&&jt&&qt&&Gt;ee.maximums.push(Dn),ee.minimums.push(gn),ee.leaves.push(Dn-gn<=5&&Rn?1:0)}T.push(ee)}return T}(this.dem),c=s.length-1,p=s[c];this._addNode(p.minimums[0],p.maximums[0],p.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(e,s,c,p,_,v,T=1){return Cm([e,s,-100],[c,p,this.maximums[0]*T],_,v)}raycast(e,s,c,p,_,v,T=1){if(!this.nodeCount)return null;const M=this.raycastRoot(e,s,c,p,_,v,T);if(null==M)return null;const z=[],W=[],ee=[],oe=[],fe=[{idx:0,t:M,nodex:0,nodey:0,depth:0}];for(;fe.length>0;){const{idx:Re,t:ke,nodex:tt,nodey:mt,depth:It}=fe.pop();if(this.leaves[Re]){Xh(tt,mt,It,e,s,c,p,ee,oe);const jt=1<<It,qt=(tt+0)/jt,Gt=(tt+1)/jt,gn=(mt+0)/jt,Dn=(mt+1)/jt,Rn=Rl(qt,gn,this.dem)*T,Ln=Rl(Gt,gn,this.dem)*T,vn=Rl(Gt,Dn,this.dem)*T,In=Rl(qt,Dn,this.dem)*T,zn=$f(ee[0],ee[1],Rn,oe[0],ee[1],Ln,oe[0],oe[1],vn,_,v),Cn=$f(oe[0],oe[1],vn,ee[0],oe[1],In,ee[0],ee[1],Rn,_,v),Si=Math.min(null!==zn?zn:Number.MAX_VALUE,null!==Cn?Cn:Number.MAX_VALUE);if(Si!==Number.MAX_VALUE)return Si;{const Wn=Hp([],_,v,ke);if(ep(Rn,Ln,In,vn,Kh(Wn[0],ee[0],oe[0]),Kh(Wn[1],ee[1],oe[1]))>=Wn[2])return ke}continue}let Ut=0;for(let jt=0;jt<this._siblingOffset.length;jt++){Xh((tt<<1)+this._siblingOffset[jt][0],(mt<<1)+this._siblingOffset[jt][1],It+1,e,s,c,p,ee,oe),ee[2]=-100,oe[2]=this.maximums[this.childOffsets[Re]+jt]*T;const qt=Cm(ee,oe,_,v);if(null!=qt){const Gt=qt;z[jt]=Gt;let gn=!1;for(let Dn=0;Dn<Ut&&!gn;Dn++)Gt>=z[W[Dn]]&&(W.splice(Dn,0,jt),gn=!0);gn||(W[Ut]=jt),Ut++}}for(let jt=0;jt<Ut;jt++){const qt=W[jt];fe.push({idx:this.childOffsets[Re]+qt,t:z[qt],nodex:(tt<<1)+this._siblingOffset[qt][0],nodey:(mt<<1)+this._siblingOffset[qt][1],depth:It+1})}}return null}_addNode(e,s,c){return this.minimums.push(e),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(e,s,c,p,_){if(1===e[p].isLeaf(s,c))return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const v=p-1,T=e[v];let M,z=0;for(let W=0;W<this._siblingOffset.length;W++){const ee=2*s+this._siblingOffset[W][0],oe=2*c+this._siblingOffset[W][1],fe=T.getElevation(ee,oe),Re=T.isLeaf(ee,oe),ke=this._addNode(fe.min,fe.max,Re);Re&&(z|=1<<W),M||(M=ke)}for(let W=0;W<this._siblingOffset.length;W++)z&1<<W||this._construct(e,2*s+this._siblingOffset[W][0],2*c+this._siblingOffset[W][1],v,M+W)}}function ep(o,e,s,c,p,_){return Gi(Gi(o,s,_),Gi(e,c,_),p)}function Rl(o,e,s){const c=s.dim,p=Ae(o*c-.5,0,c-1),_=Ae(e*c-.5,0,c-1),v=Math.floor(p),T=Math.floor(_),M=Math.min(v+1,c-1),z=Math.min(T+1,c-1);return ep(s.get(v,T),s.get(M,T),s.get(v,z),s.get(M,z),p-v,_-T)}const ul={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class Fc{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,s,c,p=!1,_=!1){if(this.uid=e,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return Bt(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const v=this.dim=s.height-2;if(this.data=new Uint32Array(s.data.buffer),this.encoding=c||"mapbox",this.borderReady=p,!p){for(let T=0;T<v;T++)this.data[this._idx(-1,T)]=this.data[this._idx(0,T)],this.data[this._idx(v,T)]=this.data[this._idx(v-1,T)],this.data[this._idx(T,-1)]=this.data[this._idx(T,0)],this.data[this._idx(T,v)]=this.data[this._idx(T,v-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(v,-1)]=this.data[this._idx(v-1,0)],this.data[this._idx(-1,v)]=this.data[this._idx(0,v-1)],this.data[this._idx(v,v)]=this.data[this._idx(v-1,v-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Qh(this)}get(e,s,c=!1){const p=new Uint8Array(this.data.buffer);c&&(e=Ae(e,-1,this.dim),s=Ae(s,-1,this.dim));const _=4*this._idx(e,s);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(p[_],p[_+1],p[_+2])}static getUnpackVector(e){return ul[e]}get unpackVector(){return ul[this.encoding]}_idx(e,s){if(e<-1||e>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(e+1)}_unpackMapbox(e,s,c){return(256*e*256+256*s+c)/10-1e4}_unpackTerrarium(e,s,c){return 256*e+s+c/256-32768}static pack(e,s){const c=[0,0,0,0],p=Fc.getUnpackVector(s);let _=Math.floor((e+p[3])/p[2]);return c[2]=_%256,_=Math.floor(_/256),c[1]=_%256,_=Math.floor(_/256),c[0]=_,c}getPixels(){return new pa({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,s,c){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let p=s*this.dim,_=s*this.dim+this.dim,v=c*this.dim,T=c*this.dim+this.dim;switch(s){case-1:p=_-1;break;case 1:_=p+1}switch(c){case-1:v=T-1;break;case 1:T=v+1}const M=-s*this.dim,z=-c*this.dim;for(let W=v;W<T;W++)for(let ee=p;ee<_;ee++)this.data[this._idx(ee,W)]=e.data[this._idx(ee+M,W+z)]}onDeserialize(){this._tree&&(this._tree.dem=this)}}Jn("DEMData",Fc),Jn("DemMinMaxQuadTree",Qh,{omit:["dem"]});class Tm{constructor(e,s){this.max=e,this.onRemove=s,this.reset()}reset(){for(const e in this.data)for(const s of this.data[e])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(e,s,c){const p=e.wrapped().key;void 0===this.data[p]&&(this.data[p]=[]);const _={value:s,timeout:void 0};if(void 0!==c&&(_.timeout=setTimeout(()=>{this.remove(e,_)},c)),this.data[p].push(_),this.order.push(p),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const s=this.data[e].shift();return s.timeout&&clearTimeout(s.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),s.value}getByKey(e){const s=this.data[e];return s?s[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,s){if(!this.has(e))return this;const c=e.wrapped().key,p=void 0===s?0:this.data[c].indexOf(s),_=this.data[c][p];return this.data[c].splice(p,1),_.timeout&&clearTimeout(_.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(_.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(e){const s=[];for(const c in this.data)for(const p of this.data[c])e(p.value)||s.push(p);for(const c of s)this.remove(c.value.tileID,c)}}class uu{constructor(e,s,c){this.func=e,this.mask=s,this.range=c}}uu.ReadOnly=!1,uu.ReadWrite=!0,uu.disabled=new uu(519,uu.ReadOnly,[0,1]);class Nc{constructor(e,s,c,p,_,v){this.test=e,this.ref=s,this.mask=c,this.fail=p,this.depthFail=_,this.pass=v}}Nc.disabled=new Nc({func:519,mask:0},0,0,7680,7680,7680);class Ha{constructor(e,s,c){this.blendFunction=e,this.blendColor=s,this.mask=c}}Ha.Replace=[1,0],Ha.disabled=new Ha(Ha.Replace,Le.transparent,[!1,!1,!1,!1]),Ha.unblended=new Ha(Ha.Replace,Le.transparent,[!0,!0,!0,!0]),Ha.alphaBlended=new Ha([1,771],Le.transparent,[!0,!0,!0,!0]);class Ga{constructor(e,s,c){this.enable=e,this.mode=s,this.frontFace=c}}Ga.disabled=new Ga(!1,1029,2305),Ga.backCCW=new Ga(!0,1029,2305),Ga.backCW=new Ga(!0,1029,2304),Ga.frontCW=new Ga(!0,1028,2304),Ga.frontCCW=new Ga(!0,1028,2305);class Ol extends On{constructor(e,s,c){super(),this.id=e,this._onlySymbols=c,s.on("data",p=>{"source"===p.dataType&&"metadata"===p.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===p.dataType&&"content"===p.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),s.on("error",()=>{this._sourceErrored=!0}),this._source=s,this._tiles={},this._cache=new Tm(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new wm}onAdd(e){this.map=e,this._maxTileCacheSize=e?e._maxTileCacheSize:null}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const s=this._tiles[e];if("loaded"!==s.state&&"errored"!==s.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,s){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,s)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Ge(this._tiles).map(e=>e.tileID).sort(tp).map(e=>e.key)}getRenderableIds(e){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,e)&&s.push(this._tiles[c]);return e?s.sort((c,p)=>{const _=c.tileID,v=p.tileID,T=new H(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),M=new H(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-v.overscaledZ||M.y-T.y||M.x-T.x}).map(c=>c.tileID.key):s.map(c=>c.tileID).sort(tp).map(c=>c.key)}hasRenderableParent(e){const s=this.findLoadedParent(e,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(e,s){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(s||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,s){const c=this._tiles[e];c&&("loading"!==c.state&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,e,s)))}_tileLoaded(e,s,c,p){if(p)return e.state="errored",void(404!==p.status?this._source.fire(new un(p,{tile:e})):this.update(this.transform));e.timeAdded=cn.now(),"expired"===c&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(s,e),"raster-dem"===this.getSource().type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Zt("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const s=this.getRenderableIds();for(let p=0;p<s.length;p++){const _=s[p];if(e.neighboringTiles&&e.neighboringTiles[_]){const v=this.getTileByID(_);c(e,v),c(v,e)}}function c(p,_){if(!p.dem||p.dem.borderReady)return;p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0;let v=_.tileID.canonical.x-p.tileID.canonical.x;const T=_.tileID.canonical.y-p.tileID.canonical.y,M=Math.pow(2,p.tileID.canonical.z),z=_.tileID.key;0===v&&0===T||Math.abs(T)>1||(Math.abs(v)>1&&(1===Math.abs(v+M)?v+=M:1===Math.abs(v-M)&&(v-=M)),_.dem&&p.dem&&(p.dem.backfillBorder(_.dem,v,T),p.neighboringTiles&&p.neighboringTiles[z]&&(p.neighboringTiles[z].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,s,c,p){for(const _ in this._tiles){let v=this._tiles[_];if(p[_]||!v.hasData()||v.tileID.overscaledZ<=s||v.tileID.overscaledZ>c)continue;let T=v.tileID;for(;v&&v.tileID.overscaledZ>s+1;){const z=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[z.key],v&&v.hasData()&&(T=z)}let M=T;for(;M.overscaledZ>s;)if(M=M.scaledTo(M.overscaledZ-1),e[M.key]){p[T.key]=T;break}}}findLoadedParent(e,s){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=e.overscaledZ-1;c>=s;c--){const p=e.scaledTo(c),_=this._getLoadedTile(p);if(_)return _}}_getLoadedTile(e){const s=this._tiles[e.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,s){s=s||this._source.tileSize;const c=Math.ceil(e.width/s)+1,p=Math.ceil(e.height/s)+1,_=Math.floor(c*p*5),v="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(v)}handleWrapJump(e){const s=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,s){const c={};for(const p in this._tiles){const _=this._tiles[p];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+s),c[_.tileID.key]=_}this._tiles=c;for(const p in this._timers)clearTimeout(this._timers[p]),delete this._timers[p];for(const p in this._tiles)this._setTileReloadTimer(+p,this._tiles[p])}}update(e,s,c){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let p;this.updateCacheSize(e,s),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?p=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new ms(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(p=e.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(p=p.filter(T=>this._source.hasTile(T)))):p=[];const _=this._updateRetainedTiles(p);if(qf(this._source.type)&&0!==p.length){const T={},M={},z=Object.keys(_);for(const ee of z){const oe=_[ee],fe=this._tiles[ee];if(!fe||fe.fadeEndTime&&fe.fadeEndTime<=cn.now())continue;const Re=this.findLoadedParent(oe,Math.max(oe.overscaledZ-Ol.maxOverzooming,this._source.minzoom));Re&&(this._addTile(Re.tileID),T[Re.tileID.key]=Re.tileID),M[ee]=oe}const W=p[p.length-1].overscaledZ;for(const ee in this._tiles){const oe=this._tiles[ee];if(_[ee]||!oe.hasData())continue;let fe=oe.tileID;for(;fe.overscaledZ>W;){fe=fe.scaledTo(fe.overscaledZ-1);const Re=this._tiles[fe.key];if(Re&&Re.hasData()&&M[fe.key]){_[ee]=oe.tileID;break}}}for(const ee in T)_[ee]||(this._coveredTiles[ee]=!0,_[ee]=T[ee])}for(const T in _)this._tiles[T].clearFadeHold();const v=function(T,M){const z=[];for(const W in T)W in M||z.push(W);return z}(this._tiles,_);for(const T of v){const M=this._tiles[T];M.hasSymbolBuckets&&!M.holdingForFade()?M.setHoldDuration(this.map._fadeDuration):M.hasSymbolBuckets&&!M.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const s={};if(0===e.length)return s;const c={},p=e[e.length-1].overscaledZ,_=e[0].overscaledZ,v=Math.max(_-Ol.maxOverzooming,this._source.minzoom),T=Math.max(_+Ol.maxUnderzooming,this._source.minzoom),M={};for(const z of e){const W=this._addTile(z);s[z.key]=z,W.hasData()||p<this._source.maxzoom&&(M[z.key]=z)}this._retainLoadedChildren(M,p,T,s);for(const z of e){let W=this._tiles[z.key];if(W.hasData())continue;if(z.canonical.z>=this._source.maxzoom){const oe=z.children(this._source.maxzoom)[0],fe=this.getTile(oe);if(fe&&fe.hasData()){s[oe.key]=oe;continue}}else{const oe=z.children(this._source.maxzoom);if(s[oe[0].key]&&s[oe[1].key]&&s[oe[2].key]&&s[oe[3].key])continue}let ee=W.wasRequested();for(let oe=z.overscaledZ-1;oe>=v;--oe){const fe=z.scaledTo(oe);if(c[fe.key]||(c[fe.key]=!0,W=this.getTile(fe),!W&&ee&&(W=this._addTile(fe)),W&&(s[fe.key]=fe,ee=W.wasRequested(),W.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const s=[];let c,p=this._tiles[e].tileID;for(;p.overscaledZ>0;){if(p.key in this._loadedParentTiles){c=this._loadedParentTiles[p.key];break}s.push(p.key);const _=p.scaledTo(p.overscaledZ-1);if(c=this._getLoadedTile(_),c)break;p=_}for(const _ of s)this._loadedParentTiles[_]=c}}_addTile(e){let s=this._tiles[e.key];if(s)return s;s=this._cache.getAndRemove(e),s&&(this._setTileReloadTimer(e.key,s),s.tileID=e,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,s)));const c=Boolean(s);return c||(s=new Zf(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom),this._loadTile(s,this._tileLoaded.bind(this,s,e.key,s.state))),s?(s.uses++,this._tiles[e.key]=s,c||this._source.fire(new Zt("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(e,s){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=s.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}_removeTile(e){const s=this._tiles[e];s&&(s.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),s.uses>0||(s.hasData()&&"reloading"!==s.state?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._cache.reset()}tilesIn(e,s,c){const p=[],_=this.transform;if(!_)return p;for(const v in this._tiles){const T=this._tiles[v];if(c&&T.clearQueryDebugViz(),T.holdingForFade())continue;const M=e.containsTile(T,_,s);M&&p.push(M)}return p}getVisibleCoordinates(e){const s=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);for(const c of s)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(qf(this._source.type))for(const e in this._tiles){const s=this._tiles[e];if(void 0!==s.fadeEndTime&&s.fadeEndTime>=cn.now())return!0}return!1}setFeatureState(e,s,c){this._state.updateState(e=e||"_geojsonTileLayer",s,c)}removeFeatureState(e,s,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",s,c)}getFeatureState(e,s){return this._state.getState(e=e||"_geojsonTileLayer",s)}setDependencies(e,s,c){const p=this._tiles[e];p&&p.setDependencies(s,c)}reloadTilesForDependencies(e,s){for(const c in this._tiles)this._tiles[c].hasDependency(e,s)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(e,s))}}function tp(o,e){const s=Math.abs(2*o.wrap)-+(o.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return o.overscaledZ-e.overscaledZ||c-s||e.canonical.y-o.canonical.y||e.canonical.x-o.canonical.x}function qf(o){return"raster"===o||"image"===o||"video"===o}Ol.maxOverzooming=10,Ol.maxUnderzooming=3;class ju{constructor(e,s,c){this._demTile=e,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(e,s,c){const p=c||e.findDEMTileFor(s);if(!p||!p.dem)return;const _=p.dem,v=p.tileID,T=1<<s.canonical.z-v.canonical.z;return new ju(p,p.tileSize/Rr/T,[(s.canonical.x/T-v.canonical.x)*_.dim,(s.canonical.y/T-v.canonical.y)*_.dim])}tileCoordToPixel(e,s){const c=s*this._scale+this._offset[1],p=Math.floor(e*this._scale+this._offset[0]),_=Math.floor(c);return new H(p,_)}getElevationAt(e,s,c,p){const _=e*this._scale+this._offset[0],v=s*this._scale+this._offset[1],T=Math.floor(_),M=Math.floor(v),z=this._dem;return p=!!p,c?Gi(Gi(z.get(T,M,p),z.get(T,M+1,p),v-M),Gi(z.get(T+1,M,p),z.get(T+1,M+1,p),v-M),_-T):z.get(T,M,p)}getElevationAtPixel(e,s,c){return this._dem.get(e,s,!!c)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Uu(1,e)*this._dem.stride}}class Hf{constructor(e,s){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Ns(Rr,16,0),this.featureIndexArray=new Kc,this.promoteId=s}insert(e,s,c,p,_,v=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,p,_,v);const M=this.grid;for(let z=0;z<s.length;z++){const W=s[z],ee=[1/0,1/0,-1/0,-1/0];for(let oe=0;oe<W.length;oe++){const fe=W[oe];ee[0]=Math.min(ee[0],fe.x),ee[1]=Math.min(ee[1],fe.y),ee[2]=Math.max(ee[2],fe.x),ee[3]=Math.max(ee[3],fe.y)}ee[0]<Rr&&ee[1]<Rr&&ee[2]>=0&&ee[3]>=0&&M.insert(T,ee[0],ee[1],ee[2],ee[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new Mc.VectorTile(new Lu(this.rawTileData)).layers,this.sourceLayerCoder=new kd(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,s,c,p){this.loadVTLayers();const _=e.params||{},v=Xr(_.filter),T=e.tileResult,M=e.transform,z=T.bufferedTilespaceBounds,W=this.grid.query(z.min.x,z.min.y,z.max.x,z.max.y,(Re,ke,tt,mt)=>Ng(T.bufferedTilespaceGeometry,Re,ke,tt,mt));W.sort(Em);let ee=null;M.elevation&&W.length>0&&(ee=ju.create(M.elevation,this.tileID));const oe={};let fe;for(let Re=0;Re<W.length;Re++){const ke=W[Re];if(ke===fe)continue;fe=ke;const tt=this.featureIndexArray.get(ke);let mt=null;this.loadMatchingFeature(oe,tt,v,_.layers,_.availableImages,s,c,p,(It,Ut,jt,qt=0)=>(mt||(mt=Ic(It)),Ut.queryIntersectsFeature(T,It,jt,mt,this.z,e.transform,e.pixelPosMatrix,ee,qt)))}return oe}loadMatchingFeature(e,s,c,p,_,v,T,M,z){const{featureIndex:W,bucketIndex:ee,sourceLayerIndex:oe,layoutVertexArrayOffset:fe}=s,Re=this.bucketLayerIDs[ee];if(p&&!function(It,Ut){for(let jt=0;jt<It.length;jt++)if(Ut.indexOf(It[jt])>=0)return!0;return!1}(p,Re))return;const ke=this.sourceLayerCoder.decode(oe),tt=this.vtLayers[ke].feature(W);if(c.needGeometry){const It=Za(tt,!0);if(!c.filter(new Me(this.tileID.overscaledZ),It,this.tileID.canonical))return}else if(!c.filter(new Me(this.tileID.overscaledZ),tt))return;const mt=this.getId(tt,ke);for(let It=0;It<Re.length;It++){const Ut=Re[It];if(p&&p.indexOf(Ut)<0)continue;const jt=v[Ut];if(!jt)continue;let qt={};void 0!==mt&&M&&(qt=M.getState(jt.sourceLayer||"_geojsonTileLayer",mt));const Gt=Fe({},T[Ut]);Gt.paint=Bd(Gt.paint,jt.paint,tt,qt,_),Gt.layout=Bd(Gt.layout,jt.layout,tt,qt,_);const gn=!z||z(tt,jt,qt,fe);if(!gn)continue;const Dn=new Fd(tt,this.z,this.x,this.y,mt);Dn.layer=Gt;let Rn=e[Ut];void 0===Rn&&(Rn=e[Ut]=[]),Rn.push({featureIndex:W,feature:Dn,intersectionZ:gn})}}lookupSymbolFeatures(e,s,c,p,_,v,T,M){const z={};this.loadVTLayers();const W=Xr(_);for(const ee of e)this.loadMatchingFeature(z,{bucketIndex:c,sourceLayerIndex:p,featureIndex:ee,layoutVertexArrayOffset:0},W,v,T,M,s);return z}hasLayer(e){for(const s of this.bucketLayerIDs)for(const c of s)if(e===c)return!0;return!1}getId(e,s){let c=e.id;return this.promoteId&&(c=e.properties["string"==typeof this.promoteId?this.promoteId:this.promoteId[s]],"boolean"==typeof c&&(c=Number(c))),c}}function Bd(o,e,s,c,p){return St(o,(_,v)=>{const T=e instanceof wt?e.get(v):null;return T&&T.evaluate?T.evaluate(s,c,p):T})}function Em(o,e){return e-o}Jn("FeatureIndex",Hf,{omit:["rawTileData","sourceLayerCoder"]});class Gf{constructor(e){const s={},c=[];for(const T in e){const M=e[T],z=s[T]={};for(const W in M.glyphs){const ee=M.glyphs[+W];if(!ee||0===ee.bitmap.width||0===ee.bitmap.height)continue;const oe=ee.metrics.localGlyph?2:1,fe={x:0,y:0,w:ee.bitmap.width+2*oe,h:ee.bitmap.height+2*oe};c.push(fe),z[W]=fe}}const{w:p,h:_}=bd(c),v=new Dl({width:p||1,height:_||1});for(const T in e){const M=e[T];for(const z in M.glyphs){const W=M.glyphs[+z];if(!W||0===W.bitmap.width||0===W.bitmap.height)continue;const ee=s[T][z],oe=W.metrics.localGlyph?2:1;Dl.copy(W.bitmap,v,{x:0,y:0},{x:ee.x+oe,y:ee.y+oe},W.bitmap)}}this.image=v,this.positions=s}}Jn("GlyphAtlas",Gf);class Wf{constructor(e){this.tileID=new ms(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile}parse(e,s,c,p,_){this.status="parsing",this.data=e,this.collisionBoxArray=new wl;const v=new kd(Object.keys(e.layers).sort()),T=new Hf(this.tileID,this.promoteId);T.bucketLayerIDs=[];const M={},z=new Ld(256,256),W={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:z,availableImages:c},ee=s.familiesBySource[this.source];for(const qt in ee){const Gt=e.layers[qt];if(!Gt)continue;let gn=!1,Dn=!1;for(const vn of ee[qt])"symbol"===vn[0].type?gn=!0:Dn=!0;if(!0===this.isSymbolTile&&!gn||!1===this.isSymbolTile&&!Dn)continue;1===Gt.version&&Bt(`Vector tile source "${this.source}" layer "${qt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Rn=v.encode(qt),Ln=[];for(let vn=0;vn<Gt.length;vn++){const In=Gt.feature(vn),zn=T.getId(In,qt);Ln.push({feature:In,id:zn,index:vn,sourceLayerIndex:Rn})}for(const vn of ee[qt]){const In=vn[0];void 0!==this.isSymbolTile&&"symbol"===In.type!==this.isSymbolTile||In.minzoom&&this.zoom<Math.floor(In.minzoom)||In.maxzoom&&this.zoom>=In.maxzoom||"none"!==In.visibility&&(cc(vn,this.zoom,c),(M[In.id]=In.createBucket({index:T.bucketLayerIDs.length,layers:vn,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Rn,sourceID:this.source,enableTerrain:this.enableTerrain})).populate(Ln,W,this.tileID.canonical),T.bucketLayerIDs.push(vn.map(zn=>zn.id)))}}let oe,fe,Re,ke;z.trim();const tt={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},mt=St(W.glyphDependencies,qt=>Object.keys(qt).map(Number));Object.keys(mt).length?p.send("getGlyphs",{uid:this.uid,stacks:mt},(qt,Gt)=>{oe||(oe=qt,fe=Gt,jt.call(this))},void 0,!1,tt):fe={};const It=Object.keys(W.iconDependencies);It.length?p.send("getImages",{icons:It,source:this.source,tileID:this.tileID,type:"icons"},(qt,Gt)=>{oe||(oe=qt,Re=Gt,jt.call(this))},void 0,!1,tt):Re={};const Ut=Object.keys(W.patternDependencies);function jt(){if(oe)return _(oe);if(fe&&Re&&ke){const qt=new Gf(fe),Gt=new ll(Re,ke);for(const gn in M){const Dn=M[gn];Dn instanceof ac?(cc(Dn.layers,this.zoom,c),Bu(Dn,fe,qt.positions,Re,Gt.iconPositions,this.showCollisionBoxes,this.tileID.canonical,this.tileZoom)):Dn.hasPattern&&(Dn instanceof Mu||Dn instanceof Au||Dn instanceof Dh)&&(cc(Dn.layers,this.zoom,c),Dn.addFeatures(W,this.tileID.canonical,Gt.patternPositions))}this.status="done",_(null,{buckets:Ge(M).filter(gn=>!gn.isEmpty()),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:qt.image,lineAtlas:z,imageAtlas:Gt,glyphMap:this.returnDependencies?fe:null,iconMap:this.returnDependencies?Re:null,glyphPositions:this.returnDependencies?qt.positions:null})}}Ut.length?p.send("getImages",{icons:Ut,source:this.source,tileID:this.tileID,type:"patterns"},(qt,Gt)=>{oe||(oe=qt,ke=Gt,jt.call(this))},void 0,!1,tt):ke={},jt.call(this)}}function cc(o,e,s){const c=new Me(e);for(const p of o)p.recalculate(c,s)}class np{constructor(e){this.entries={},this.scheduler=e}request(e,s,c,p){const _=this.entries[e]=this.entries[e]||{callbacks:[]};if(_.result){const[v,T]=_.result;return this.scheduler?this.scheduler.add(()=>{p(v,T)},s):p(v,T),()=>{}}return _.callbacks.push(p),_.cancel||(_.cancel=c((v,T)=>{_.result=[v,T];for(const M of _.callbacks)this.scheduler?this.scheduler.add(()=>{M(v,T)},s):M(v,T);setTimeout(()=>delete this.entries[e],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(v=>v!==p),_.callbacks.length||(_.cancel(),delete this.entries[e]))}}}function Yf(o,e,s){const c=JSON.stringify(o.request);return o.data&&(this.deduped.entries[c]={result:[null,o.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom},p=>{const _=ie(o.request,(v,T,M,z)=>{v?p(v):T&&p(null,{vectorTile:s?void 0:new Mc.VectorTile(new Lu(T)),rawData:T,cacheControl:M,expires:z})});return()=>{_.cancel(),p()}},e)}l.ARRAY_TYPE=fs,l.AUTH_ERR_MSG=bi,l.Actor=class{constructor(o,e,s){this.target=o,this.parent=e,this.mapId=s,this.callbacks={},this.cancelCallbacks={},bt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Ot()?o:K,this.scheduler=new Yh}send(o,e,s,c,p=!1,_){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=_,this.callbacks[v]=s);const T=yt(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:o,hasCallback:!!s,targetMapId:c,mustQueue:p,sourceMapId:this.mapId,data:da(e,T)},T),{cancel:()=>{s&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(o){const e=o.data,s=e.id;if(s&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(e.mustQueue||Ot()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add(()=>this.processTask(s,e),c&&c.metadata||{type:"message"})}else this.processTask(s,e)}processTask(o,e){if("<response>"===e.type){const s=this.callbacks[o];delete this.callbacks[o],s&&(e.error?s(Fa(e.error)):s(null,Fa(e.data)))}else{const s=yt(this.globalScope)?void 0:[],c=e.hasCallback?(_,v)=>{delete this.cancelCallbacks[o],this.target.postMessage({id:o,type:"<response>",sourceMapId:this.mapId,error:_?da(_):null,data:da(v,s)},s)}:_=>{},p=Fa(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,p,c);else if(this.parent.getWorkerSource){const _=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,_[0],p.source)[_[1]](p,c)}else c(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.CanonicalTileID=Jh,l.Color=Le,l.ColorMode=Ha,l.CullFaceMode=Ga,l.DEMData=Fc,l.DataConstantProperty=nt,l.DedupedRequest=np,l.DepthMode=uu,l.EXTENT=Rr,l.Elevation=class{getAtPointOrZero(o,e=0){return this.getAtPoint(o,e)||0}getAtPoint(o,e,s=!0){null==e&&(e=null);const c=this._source();if(!c||o.y<0||o.y>1)return e;const p=c.getSource().maxzoom,_=1<<p,v=Math.floor(o.x),T=o.x-v,M=new ms(p,v,p,Math.floor(T*_),Math.floor(o.y*_)),z=this.findDEMTileFor(M);if(!z||!z.dem)return e;const W=z.dem,ee=1<<z.tileID.canonical.z,oe=(T*ee-z.tileID.canonical.x)*W.dim,fe=(o.y*ee-z.tileID.canonical.y)*W.dim,Re=Math.floor(oe),ke=Math.floor(fe);return(s?this.exaggeration():1)*Gi(Gi(W.get(Re,ke),W.get(Re,ke+1),fe-ke),Gi(W.get(Re+1,ke),W.get(Re+1,ke+1),fe-ke),oe-Re)}getAtTileOffset(o,e,s){const c=1<<o.canonical.z;return this.getAtPointOrZero(new Vu(o.wrap+(o.canonical.x+e/Rr)/c,(o.canonical.y+s/Rr)/c))}getForTilePoints(o,e,s,c){const p=ju.create(this,o,c);return!!p&&(e.forEach(_=>{_[2]=this.exaggeration()*p.getElevationAt(_[0],_[1],s)}),!0)}getMinMaxForTile(o){const e=this.findDEMTileFor(o);if(!e||!e.dem)return null;const s=e.dem.tree,c=e.tileID,p=1<<o.canonical.z-c.canonical.z;let _=o.canonical.x/p-c.canonical.x,v=o.canonical.y/p-c.canonical.y,T=0;for(let M=0;M<o.canonical.z-c.canonical.z&&!s.leaves[T];M++){_*=2,v*=2;const z=2*Math.floor(v)+Math.floor(_);T=s.childOffsets[T]+z,_%=1,v%=1}return{min:this.exaggeration()*s.minimums[T],max:this.exaggeration()*s.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(o,e,s){throw new Error("Pure virtual method called.")}pointCoordinate(o){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(o){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},l.ErrorEvent=un,l.EvaluationParameters=Me,l.Event=Zt,l.Evented=On,l.GlyphManager=Lc,l.ImagePosition=Tf,l.LineAtlas=Ld,l.LngLat=ho,l.LngLatBounds=lc,l.LocalGlyphMode=Fu,l.MAX_SAFE_INTEGER=G,l.MercatorCoordinate=Vu,l.ONE_EM=24,l.OverscaledTileID=ms,l.Properties=sn,l.RGBAImage=pa,l.RequestManager=class{constructor(o,e,s){this._transformRequestFn=o,this._customAccessToken=e,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const o=function(){let e="";for(let s=0;s<10;s++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",_i,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,e){return this._transformRequestFn&&this._transformRequestFn(o,e)||{url:o}}normalizeStyleURL(o,e){if(!xn(o))return o;const s=ft(o);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||e)}normalizeGlyphsURL(o,e){if(!xn(o))return o;const s=ft(o);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||e)}normalizeSourceURL(o,e){if(!xn(o))return o;const s=ft(o);return s.path=`/v4/${s.authority}.json`,s.params.push("secure"),this._makeAPIURL(s,this._customAccessToken||e)}normalizeSpriteURL(o,e,s,c){const p=ft(o);return xn(o)?(p.path=`/styles/v1${p.path}/sprite${e}${s}`,this._makeAPIURL(p,this._customAccessToken||c)):(p.path+=`${e}${s}`,pn(p))}normalizeTileURL(o,e,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!xn(o))return o;const c=ft(o);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||s&&"raster"!==c.authority&&512===s?"@2x":""}${mi.supported?".webp":"$1"}`),"raster"===c.authority?c.path=`/${An.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${An.TILE_URL_VERSION}${c.path}`);const p=this._customAccessToken||function(_){for(const v of _){const T=v.match(/^access_token=(.*)$/);if(T)return T[1]}return null}(c.params)||An.ACCESS_TOKEN;return An.REQUIRE_ACCESS_TOKEN&&p&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,p)}canonicalizeTileURL(o,e){const s=ft(o);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return o;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${An.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${An.TILE_URL_VERSION}/`,"")}`;let p=s.params;return e&&(p=p.filter(_=>!_.match(/^access_token=/))),p.length&&(c+=`?${p.join("&")}`),c}canonicalizeTileset(o,e){const s=!!e&&xn(e),c=[];for(const p of o.tiles||[])rn(p)?c.push(this.canonicalizeTileURL(p,s)):c.push(p);return c}_makeAPIURL(o,e){const s="See https://www.mapbox.com/api-documentation/#access-tokens-and-token-scopes",c=ft(An.API_URL);if(o.protocol=c.protocol,o.authority=c.authority,"http"===o.protocol){const p=o.params.indexOf("secure");p>=0&&o.params.splice(p,1)}if("/"!==c.path&&(o.path=`${c.path}${o.path}`),!An.REQUIRE_ACCESS_TOKEN)return pn(o);if(e=e||An.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return o.params=o.params.filter(p=>-1===p.indexOf("access_token")),o.params.push(`access_token=${e||""}`),pn(o)}},l.ResourceType=mr,l.SegmentVector=ps,l.SourceCache=Ol,l.StencilMode=Nc,l.StructArrayLayout1ui2=Bs,l.StructArrayLayout2f1f2i16=ds,l.StructArrayLayout2i4=Li,l.StructArrayLayout2ui4=Zo,l.StructArrayLayout3f12=ki,l.StructArrayLayout3ui6=Zi,l.StructArrayLayout4i8=Hr,l.Texture=Rd,l.Tile=Zf,l.Transitionable=ht,l.Uniform1f=lh,l.Uniform1i=class extends Kl{constructor(o,e){super(o,e),this.current=0}set(o){this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},l.Uniform2f=class extends Kl{constructor(o,e){super(o,e),this.current=[0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1]))}},l.Uniform3f=class extends Kl{constructor(o,e){super(o,e),this.current=[0,0,0]}set(o){o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2]))}},l.Uniform4f=mu,l.UniformColor=Qu,l.UniformMatrix3f=class extends Kl{constructor(o,e){super(o,e),this.current=Rp}set(o){for(let e=0;e<9;e++)if(o[e]!==this.current[e]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}},l.UniformMatrix4f=class extends Kl{constructor(o,e){super(o,e),this.current=Pp}set(o){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let e=1;e<16;e++)if(o[e]!==this.current[e]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}},l.UnwrappedTileID=Zu,l.ValidationError=Yt,l.VectorTileWorkerSource=class extends On{constructor(o,e,s,c,p){super(),this.actor=o,this.layerIndex=e,this.availableImages=s,this.loadVectorData=p||Yf,this.loading={},this.loaded={},this.deduped=new np(o.scheduler),this.isSpriteLoaded=c,this.scheduler=o.scheduler}loadTile(o,e){const s=o.uid,c=o&&o.request,p=c&&c.collectResourceTiming,_=this.loading[s]=new Wf(o);_.abort=this.loadVectorData(o,(v,T)=>{const M=!this.loading[s];if(delete this.loading[s],M||v||!T)return _.status="done",M||(this.loaded[s]=_),e(v);const z=T.rawData,W={};T.expires&&(W.expires=T.expires),T.cacheControl&&(W.cacheControl=T.cacheControl),_.vectorTile=T.vectorTile||new Mc.VectorTile(new Lu(z));const ee=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(oe,fe)=>{if(oe||!fe)return e(oe);const Re={};if(p){const ke=zf(c);ke.length>0&&(Re.resourceTiming=JSON.parse(JSON.stringify(ke)))}e(null,Fe({rawTileData:z.slice(0)},fe,W,Re))})};this.isSpriteLoaded?ee():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(ee,{type:"parseTile",isSymbolTile:o.isSymbolTile,zoom:o.tileZoom}):ee()}),this.loaded=this.loaded||{},this.loaded[s]=_})}reloadTile(o,e){const s=this.loaded,c=o.uid,p=this;if(s&&s[c]){const _=s[c];_.showCollisionBoxes=o.showCollisionBoxes,_.enableTerrain=!!o.enableTerrain;const v=(T,M)=>{const z=_.reloadCallback;z&&(delete _.reloadCallback,_.parse(_.vectorTile,p.layerIndex,this.availableImages,p.actor,z)),e(T,M)};"parsing"===_.status?_.reloadCallback=v:"done"===_.status&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(o,e){const s=o.uid,c=this.loading[s];c&&(c.abort&&c.abort(),delete this.loading[s]),e()}removeTile(o,e){const s=this.loaded,c=o.uid;s&&s[c]&&delete s[c],e()}},l.WritingMode=Es,l.ZoomHistory=Hl,l.add=function(o,e,s){return o[0]=e[0]+s[0],o[1]=e[1]+s[1],o[2]=e[2]+s[2],o},l.addDynamicAttributes=Md,l.altitudeFromMercatorZ=Wh,l.asyncAll=He,l.bezier=ze,l.bindAll=bt,l.bufferConvexPolygon=function(o,e){const s=[];for(let c=0;c<o.length;c++){const p=Te(c-1,-1,o.length-1),_=Te(c+1,-1,o.length-1),v=o[c],T=o[_],M=o[p].sub(v).unit(),z=T.sub(v).unit(),W=z.angleWithSep(M.x,M.y),ee=M.add(z).unit().mult(-1*e/Math.sin(W/2));s.push(v.add(ee))}return s},l.cacheEntryPossiblyAdded=function(o){wr++,wr>Yi&&(o.getActor().send("enforceCacheSizeLimit",Ti),wr=0)},l.clamp=Ae,l.clearTileCache=function(o){const e=K.caches.delete(ai);o&&e.catch(o).then(()=>o())},l.clipLine=Ml,l.clone=function(o){var e=new fs(3);return e[0]=o[0],e[1]=o[1],e[2]=o[2],e},l.clone$1=function(o){var e=new fs(16);return e[0]=o[0],e[1]=o[1],e[2]=o[2],e[3]=o[3],e[4]=o[4],e[5]=o[5],e[6]=o[6],e[7]=o[7],e[8]=o[8],e[9]=o[9],e[10]=o[10],e[11]=o[11],e[12]=o[12],e[13]=o[13],e[14]=o[14],e[15]=o[15],e},l.clone$2=bn,l.collisionCircleLayout=pf,l.config=An,l.conjugate=function(o,e){return o[0]=-e[0],o[1]=-e[1],o[2]=-e[2],o[3]=e[3],o},l.copy=function(o,e){return o[0]=e[0],o[1]=e[1],o[2]=e[2],o},l.create=od,l.create$1=function(){var o=new fs(16);return fs!=Float32Array&&(o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=0,o[12]=0,o[13]=0,o[14]=0),o[0]=1,o[5]=1,o[10]=1,o[15]=1,o},l.create$2=dh,l.createExpression=$,l.createFilter=Xr,l.createLayout=Xn,l.createStyleLayer=function(o){return"custom"===o.type?new Of(o):new jh[o.type](o)},l.cross=function(o,e,s){var c=e[0],p=e[1],_=e[2],v=s[0],T=s[1],M=s[2];return o[0]=p*M-_*T,o[1]=_*v-c*M,o[2]=c*T-p*v,o},l.degToRad=me,l.div=function(o,e,s){return o[0]=e[0]/s[0],o[1]=e[1]/s[1],o[2]=e[2]/s[2],o},l.dot=function(o,e){return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]},l.dot$1=function(o,e){return o[0]*e[0]+o[1]*e[1]+o[2]*e[2]+o[3]*e[3]},l.ease=Ne,l.easeCubicInOut=we,l.emitValidationErrors=_c,l.endsWith=ut,l.enforceCacheSizeLimit=function(o){br(),Un&&Un.then(e=>{e.keys().then(s=>{for(let c=0;c<s.length-o;c++)e.delete(s[c])})})},l.evaluateSizeForFeature=au,l.evaluateSizeForZoom=Sc,l.evaluateVariableOffset=kc,l.evented=se,l.exactEquals=function(o,e){return o[0]===e[0]&&o[1]===e[1]&&o[2]===e[2]&&o[3]===e[3]},l.exactEquals$1=function(o,e){return o[0]===e[0]&&o[1]===e[1]&&o[2]===e[2]},l.exported=cn,l.exported$1=mi,l.extend=Fe,l.filterObject=Vt,l.fromMat4=function(o,e){return o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[4],o[4]=e[5],o[5]=e[6],o[6]=e[8],o[7]=e[9],o[8]=e[10],o},l.fromQuat=function(o,e){var s=e[0],c=e[1],p=e[2],_=e[3],v=s+s,T=c+c,M=p+p,z=s*v,W=c*v,ee=c*T,oe=p*v,fe=p*T,Re=p*M,ke=_*v,tt=_*T,mt=_*M;return o[0]=1-ee-Re,o[1]=W+mt,o[2]=oe-tt,o[3]=0,o[4]=W-mt,o[5]=1-z-Re,o[6]=fe+ke,o[7]=0,o[8]=oe+tt,o[9]=fe-ke,o[10]=1-z-ee,o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},l.fromRotation=function(o,e){var s=Math.sin(e),c=Math.cos(e);return o[0]=c,o[1]=s,o[2]=0,o[3]=-s,o[4]=c,o[5]=0,o[6]=0,o[7]=0,o[8]=1,o},l.fromScaling=function(o,e){return o[0]=e[0],o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=e[1],o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=e[2],o[11]=0,o[12]=0,o[13]=0,o[14]=0,o[15]=1,o},l.furthestTileCorner=function(o){const e=Math.round((o+45+360)%360/90)%4;return ve[e]},l.getAABBPointSquareDist=function(o,e,s){let c=0;for(let p=0;p<2;++p){const _=s?s[p]:0;o[p]>_&&(c+=(o[p]-_)*(o[p]-_)),e[p]<_&&(c+=(_-e[p])*(_-e[p]))}return c},l.getAnchorAlignment=ku,l.getAnchorJustification=sc,l.getBounds=function(o){let e=1/0,s=1/0,c=-1/0,p=-1/0;for(const _ of o)e=Math.min(e,_.x),s=Math.min(s,_.y),c=Math.max(c,_.x),p=Math.max(p,_.y);return{min:new H(e,s),max:new H(c,p)}},l.getImage=lt,l.getJSON=function(o,e){return re(Fe(o,{type:"json"}),e)},l.getMapSessionAPI=qn,l.getPerformanceMeasurement=zf,l.getRTLTextPluginStatus=he,l.getReferrer=hi,l.getVideo=function(o,e){const s=K.document.createElement("video");s.muted=!0,s.onloadstart=function(){e(null,s)};for(let c=0;c<o.length;c++){const p=K.document.createElement("source");De(o[c])||(s.crossOrigin="Anonymous"),p.src=o[c],s.appendChild(p)}return{cancel:()=>{}}},l.identity=yu,l.identity$1=ph,l.invert=function(o,e){var s=e[0],c=e[1],p=e[2],_=e[3],v=e[4],T=e[5],M=e[6],z=e[7],W=e[8],ee=e[9],oe=e[10],fe=e[11],Re=e[12],ke=e[13],tt=e[14],mt=e[15],It=s*T-c*v,Ut=s*M-p*v,jt=s*z-_*v,qt=c*M-p*T,Gt=c*z-_*T,gn=p*z-_*M,Dn=W*ke-ee*Re,Rn=W*tt-oe*Re,Ln=W*mt-fe*Re,vn=ee*tt-oe*ke,In=ee*mt-fe*ke,zn=oe*mt-fe*tt,Cn=It*zn-Ut*In+jt*vn+qt*Ln-Gt*Rn+gn*Dn;return Cn?(o[0]=(T*zn-M*In+z*vn)*(Cn=1/Cn),o[1]=(p*In-c*zn-_*vn)*Cn,o[2]=(ke*gn-tt*Gt+mt*qt)*Cn,o[3]=(oe*Gt-ee*gn-fe*qt)*Cn,o[4]=(M*Ln-v*zn-z*Rn)*Cn,o[5]=(s*zn-p*Ln+_*Rn)*Cn,o[6]=(tt*jt-Re*gn-mt*Ut)*Cn,o[7]=(W*gn-oe*jt+fe*Ut)*Cn,o[8]=(v*In-T*Ln+z*Dn)*Cn,o[9]=(c*Ln-s*In-_*Dn)*Cn,o[10]=(Re*Gt-ke*jt+mt*It)*Cn,o[11]=(ee*jt-W*Gt-fe*It)*Cn,o[12]=(T*Rn-v*vn-M*Dn)*Cn,o[13]=(s*vn-c*Rn+p*Dn)*Cn,o[14]=(ke*Ut-Re*qt-tt*It)*Cn,o[15]=(W*qt-ee*Ut+oe*It)*Cn,o):null},l.isMapAuthenticated=function(o){return ci.has(o)},l.isMapboxURL=xn,l.latFromMercatorY=Od,l.len=xu,l.length=jp,l.length$1=function(o){return Math.hypot(o[0],o[1],o[2],o[3])},l.loadVectorTile=Yf,l.makeRequest=re,l.mercatorXfromLng=Bf,l.mercatorYfromLat=qa,l.mercatorZfromAltitude=Uu,l.mul=function(o,e,s){return o[0]=e[0]*s[0],o[1]=e[1]*s[1],o[2]=e[2]*s[2],o[3]=e[3]*s[3],o},l.mul$1=Co,l.mul$2=cy,l.multiply=$p,l.multiply$1=qp,l.nextPowerOfTwo=ct,l.normalize=Gp,l.normalize$1=function(o,e){var s=e[0],c=e[1],p=e[2],_=e[3],v=s*s+c*c+p*p+_*_;return v>0&&(v=1/Math.sqrt(v)),o[0]=s*v,o[1]=c*v,o[2]=p*v,o[3]=_*v,o},l.number=Gi,l.ortho=function(o,e,s,c,p,_,v){var T=1/(e-s),M=1/(c-p),z=1/(_-v);return o[0]=-2*T,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=-2*M,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=2*z,o[11]=0,o[12]=(e+s)*T,o[13]=(p+c)*M,o[14]=(v+_)*z,o[15]=1,o},l.pbf=Lu,l.perspective=function(o,e,s,c,p){var _,v=1/Math.tan(e/2);return o[0]=v/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=v,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[11]=-1,o[12]=0,o[13]=0,o[15]=0,null!=p&&p!==1/0?(o[10]=(p+c)*(_=1/(c-p)),o[14]=2*p*c*_):(o[10]=-1,o[14]=-2*c),o},l.pick=function(o,e){const s={};for(let c=0;c<e.length;c++){const p=e[c];p in o&&(s[p]=o[p])}return s},l.plugin=Ce,l.pointGeometry=H,l.polygonIntersectsBox=Ng,l.polygonIntersectsPolygon=eu,l.polygonizeBounds=function(o,e,s=0,c=!0){const p=new H(s,s),_=o.sub(p),v=e.add(p),T=[_,new H(v.x,_.y),v,new H(_.x,v.y)];return c&&T.push(_),T},l.posAttributes=Vf,l.postMapLoadEvent=Tt,l.postTurnstileEvent=ye,l.potpack=bd,l.prevPowerOfTwo=function(o){return o<=1?1:Math.pow(2,Math.floor(Math.log(o)/Math.LN2))},l.radToDeg=function(o){return o*ce},l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.registerForPluginStateChange=function(o){return o({pluginStatus:w,pluginURL:k}),se.on("pluginStateChange",o),o},l.removeAuthState=function(o){ci.delete(o)},l.renderColorRamp=vh,l.rotateX=function(o,e,s){var c=Math.sin(s),p=Math.cos(s),_=e[4],v=e[5],T=e[6],M=e[7],z=e[8],W=e[9],ee=e[10],oe=e[11];return e!==o&&(o[0]=e[0],o[1]=e[1],o[2]=e[2],o[3]=e[3],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o[4]=_*p+z*c,o[5]=v*p+W*c,o[6]=T*p+ee*c,o[7]=M*p+oe*c,o[8]=z*p-_*c,o[9]=W*p-v*c,o[10]=ee*p-T*c,o[11]=oe*p-M*c,o},l.rotateX$1=fh,l.rotateY=function(o,e,s){var c=Math.sin(s),p=Math.cos(s),_=e[0],v=e[1],T=e[2],M=e[3],z=e[8],W=e[9],ee=e[10],oe=e[11];return e!==o&&(o[4]=e[4],o[5]=e[5],o[6]=e[6],o[7]=e[7],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o[0]=_*p-z*c,o[1]=v*p-W*c,o[2]=T*p-ee*c,o[3]=M*p-oe*c,o[8]=_*c+z*p,o[9]=v*c+W*p,o[10]=T*c+ee*p,o[11]=M*c+oe*p,o},l.rotateZ=function(o,e,s){var c=Math.sin(s),p=Math.cos(s),_=e[0],v=e[1],T=e[2],M=e[3],z=e[4],W=e[5],ee=e[6],oe=e[7];return e!==o&&(o[8]=e[8],o[9]=e[9],o[10]=e[10],o[11]=e[11],o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15]),o[0]=_*p+z*c,o[1]=v*p+W*c,o[2]=T*p+ee*c,o[3]=M*p+oe*c,o[4]=z*p-_*c,o[5]=W*p-v*c,o[6]=ee*p-T*c,o[7]=oe*p-M*c,o},l.rotateZ$1=function(o,e,s){s*=.5;var c=e[0],p=e[1],_=e[2],v=e[3],T=Math.sin(s),M=Math.cos(s);return o[0]=c*M+p*T,o[1]=p*M-c*T,o[2]=_*M+v*T,o[3]=v*M-_*T,o},l.scale=function(o,e,s){return o[0]=e[0]*s,o[1]=e[1]*s,o[2]=e[2]*s,o},l.scale$1=function(o,e,s){var c=s[0],p=s[1],_=s[2];return o[0]=e[0]*c,o[1]=e[1]*c,o[2]=e[2]*c,o[3]=e[3]*c,o[4]=e[4]*p,o[5]=e[5]*p,o[6]=e[6]*p,o[7]=e[7]*p,o[8]=e[8]*_,o[9]=e[9]*_,o[10]=e[10]*_,o[11]=e[11]*_,o[12]=e[12],o[13]=e[13],o[14]=e[14],o[15]=e[15],o},l.scale$2=function(o,e,s){return o[0]=e[0]*s,o[1]=e[1]*s,o[2]=e[2]*s,o[3]=e[3]*s,o},l.scaleAndAdd=Hp,l.setCacheLimits=function(o,e){Ti=o,Yi=e},l.setRTLTextPlugin=function(o,e,s=!1){if(w===i||w===u||w===m)throw new Error("setRTLTextPlugin cannot be called multiple times.");k=cn.resolveURL(o),w=i,b=e,J(),s||be()},l.smoothstep=function(o,e,s){return(s=Ae((s-o)/(e-o),0,1))*s*(3-2*s)},l.spec=at,l.storeAuthState=function(o,e){e?ci.add(o):ci.delete(o)},l.sub=ly,l.subtract=hh,l.symbolSize=hy,l.transformMat3=function(o,e,s){var c=e[0],p=e[1],_=e[2];return o[0]=c*s[0]+p*s[3]+_*s[6],o[1]=c*s[1]+p*s[4]+_*s[7],o[2]=c*s[2]+p*s[5]+_*s[8],o},l.transformMat4=Ho,l.transformMat4$1=function(o,e,s){var c=e[0],p=e[1],_=e[2],v=s[3]*c+s[7]*p+s[11]*_+s[15];return o[0]=(s[0]*c+s[4]*p+s[8]*_+s[12])/(v=v||1),o[1]=(s[1]*c+s[5]*p+s[9]*_+s[13])/v,o[2]=(s[2]*c+s[6]*p+s[10]*_+s[14])/v,o},l.transformQuat=Wp,l.translate=function(o,e,s){var c,p,_,v,T,M,z,W,ee,oe,fe,Re,ke=s[0],tt=s[1],mt=s[2];return e===o?(o[12]=e[0]*ke+e[4]*tt+e[8]*mt+e[12],o[13]=e[1]*ke+e[5]*tt+e[9]*mt+e[13],o[14]=e[2]*ke+e[6]*tt+e[10]*mt+e[14],o[15]=e[3]*ke+e[7]*tt+e[11]*mt+e[15]):(p=e[1],_=e[2],v=e[3],T=e[4],M=e[5],z=e[6],W=e[7],ee=e[8],oe=e[9],fe=e[10],Re=e[11],o[0]=c=e[0],o[1]=p,o[2]=_,o[3]=v,o[4]=T,o[5]=M,o[6]=z,o[7]=W,o[8]=ee,o[9]=oe,o[10]=fe,o[11]=Re,o[12]=c*ke+T*tt+ee*mt+e[12],o[13]=p*ke+M*tt+oe*mt+e[13],o[14]=_*ke+z*tt+fe*mt+e[14],o[15]=v*ke+W*tt+Re*mt+e[15]),o},l.triggerPluginCompletionEvent=Z,l.uniqueId=Qe,l.validateCustomStyleLayer=function(o){const e=[],s=o.id;return void 0===s&&e.push({message:`layers.${s}: missing required property "id"`}),void 0===o.render&&e.push({message:`layers.${s}: missing required method "render"`}),o.renderingMode&&"2d"!==o.renderingMode&&"3d"!==o.renderingMode&&e.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateFog=ka,l.validateLight=ca,l.validateStyle=Fs,l.values=Ge,l.vectorTile=Mc,l.version=P,l.warnOnce=Bt,l.window=K,l.wrap=Te}),d(0,function(l){function P(re){const ie=typeof re;if("number"===ie||"boolean"===ie||"string"===ie||null==re)return JSON.stringify(re);if(Array.isArray(re)){let De="[";for(const $e of re)De+=`${P($e)},`;return`${De}]`}const V=Object.keys(re).sort();let pe="{";for(let De=0;De<V.length;De++)pe+=`${JSON.stringify(V[De])}:${P(re[V[De]])},`;return`${pe}}`}function O(re){let ie="";for(const V of l.refProperties)ie+=`/${P(re[V])}`;return ie}class f{constructor(ie){this.keyCache={},ie&&this.replace(ie)}replace(ie){this._layerConfigs={},this._layers={},this.update(ie,[])}update(ie,V){for(const De of ie){this._layerConfigs[De.id]=De;const $e=this._layers[De.id]=l.createStyleLayer(De);$e._featureFilter=l.createFilter($e.filter),this.keyCache[De.id]&&delete this.keyCache[De.id]}for(const De of V)delete this.keyCache[De],delete this._layerConfigs[De],delete this._layers[De];this.familiesBySource={};const pe=function(De,$e){const vt={};for(let lt=0;lt<De.length;lt++){const Dt=$e&&$e[De[lt].id]||O(De[lt]);$e&&($e[De[lt].id]=Dt);let Ht=vt[Dt];Ht||(Ht=vt[Dt]=[]),Ht.push(De[lt])}const Ct=[];for(const lt in vt)Ct.push(vt[lt]);return Ct}(l.values(this._layerConfigs),this.keyCache);for(const De of pe){const $e=De.map(Zt=>this._layers[Zt.id]),vt=$e[0];if("none"===vt.visibility)continue;const Ct=vt.source||"";let lt=this.familiesBySource[Ct];lt||(lt=this.familiesBySource[Ct]={});const Dt=vt.sourceLayer||"_geojsonTileLayer";let Ht=lt[Dt];Ht||(Ht=lt[Dt]=[]),Ht.push($e)}}}const{ImageBitmap:H}=l.window;class te{loadTile(ie,V){const{uid:pe,encoding:De,rawImageData:$e,padding:vt,buildQuadTree:Ct}=ie,lt=H&&$e instanceof H?this.getImageData($e,vt):$e;V(null,new l.DEMData(pe,lt,De,vt<1,Ct))}getImageData(ie,V){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ie.width,ie.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d")),this.offscreenCanvas.width=ie.width,this.offscreenCanvas.height=ie.height,this.offscreenCanvasContext.drawImage(ie,0,0,ie.width,ie.height);const pe=this.offscreenCanvasContext.getImageData(-V,-V,ie.width+2*V,ie.height+2*V);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),new l.RGBAImage({width:pe.width,height:pe.height},pe.data)}}var K=function re(ie,V){var pe,De=ie&&ie.type;if("FeatureCollection"===De)for(pe=0;pe<ie.features.length;pe++)re(ie.features[pe],V);else if("GeometryCollection"===De)for(pe=0;pe<ie.geometries.length;pe++)re(ie.geometries[pe],V);else if("Feature"===De)re(ie.geometry,V);else if("Polygon"===De)G(ie.coordinates,V);else if("MultiPolygon"===De)for(pe=0;pe<ie.coordinates.length;pe++)G(ie.coordinates[pe],V);return ie};function G(re,ie){if(0!==re.length){ne(re[0],ie);for(var V=1;V<re.length;V++)ne(re[V],!ie)}}function ne(re,ie){for(var V=0,pe=0,De=re.length,$e=De-1;pe<De;$e=pe++)V+=(re[pe][0]-re[$e][0])*(re[$e][1]+re[pe][1]);V>=0!=!!ie&&re.reverse()}const ce=l.vectorTile.VectorTileFeature.prototype.toGeoJSON;class me{constructor(ie){this._feature=ie,this.extent=l.EXTENT,this.type=ie.type,this.properties=ie.tags,"id"in ie&&!isNaN(ie.id)&&(this.id=parseInt(ie.id,10))}loadGeometry(){if(1===this._feature.type){const ie=[];for(const V of this._feature.geometry)ie.push([new l.pointGeometry(V[0],V[1])]);return ie}{const ie=[];for(const V of this._feature.geometry){const pe=[];for(const De of V)pe.push(new l.pointGeometry(De[0],De[1]));ie.push(pe)}return ie}}toGeoJSON(ie,V,pe){return ce.call(this,ie,V,pe)}}class ve{constructor(ie){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=ie.length,this._features=ie}feature(ie){return new me(this._features[ie])}}var we=l.vectorTile.VectorTileFeature,ze=Ne;function Ne(re,ie){this.options=ie||{},this.features=re,this.length=re.length}function Ae(re,ie){this.id="number"==typeof re.id?re.id:void 0,this.type=re.type,this.rawGeometry=1===re.type?[re.geometry]:re.geometry,this.properties=re.tags,this.extent=ie||4096}Ne.prototype.feature=function(re){return new Ae(this.features[re],this.options.extent)},Ae.prototype.loadGeometry=function(){var re=this.rawGeometry;this.geometry=[];for(var ie=0;ie<re.length;ie++){for(var V=re[ie],pe=[],De=0;De<V.length;De++)pe.push(new l.pointGeometry(V[De][0],V[De][1]));this.geometry.push(pe)}return this.geometry},Ae.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var re=this.geometry,ie=1/0,V=-1/0,pe=1/0,De=-1/0,$e=0;$e<re.length;$e++)for(var vt=re[$e],Ct=0;Ct<vt.length;Ct++){var lt=vt[Ct];ie=Math.min(ie,lt.x),V=Math.max(V,lt.x),pe=Math.min(pe,lt.y),De=Math.max(De,lt.y)}return[ie,pe,V,De]},Ae.prototype.toGeoJSON=we.prototype.toGeoJSON;var Te=Ge,He=ze;function Ge(re){var ie=new l.pbf;return function(V,pe){for(var De in V.layers)pe.writeMessage(3,Fe,V.layers[De])}(re,ie),ie.finish()}function Fe(re,ie){var V;ie.writeVarintField(15,re.version||1),ie.writeStringField(1,re.name||""),ie.writeVarintField(5,re.extent||4096);var pe={keys:[],values:[],keycache:{},valuecache:{}};for(V=0;V<re.length;V++)pe.feature=re.feature(V),ie.writeMessage(2,E,pe);var De=pe.keys;for(V=0;V<De.length;V++)ie.writeStringField(3,De[V]);var $e=pe.values;for(V=0;V<$e.length;V++)ie.writeMessage(4,bt,$e[V])}function E(re,ie){var V=re.feature;void 0!==V.id&&ie.writeVarintField(1,V.id),ie.writeMessage(2,Qe,re),ie.writeVarintField(3,V.type),ie.writeMessage(4,gt,V)}function Qe(re,ie){var V=re.feature,pe=re.keys,De=re.values,$e=re.keycache,vt=re.valuecache;for(var Ct in V.properties){var lt=$e[Ct];void 0===lt&&(pe.push(Ct),$e[Ct]=lt=pe.length-1),ie.writeVarint(lt);var Dt=V.properties[Ct],Ht=typeof Dt;"string"!==Ht&&"boolean"!==Ht&&"number"!==Ht&&(Dt=JSON.stringify(Dt));var Zt=Ht+":"+Dt,un=vt[Zt];void 0===un&&(De.push(Dt),vt[Zt]=un=De.length-1),ie.writeVarint(un)}}function et(re,ie){return(ie<<3)+(7&re)}function ct(re){return re<<1^re>>31}function gt(re,ie){for(var V=re.loadGeometry(),pe=re.type,De=0,$e=0,vt=V.length,Ct=0;Ct<vt;Ct++){var lt=V[Ct],Dt=1;1===pe&&(Dt=lt.length),ie.writeVarint(et(1,Dt));for(var Ht=3===pe?lt.length-1:lt.length,Zt=0;Zt<Ht;Zt++){1===Zt&&1!==pe&&ie.writeVarint(et(2,Ht-1));var un=lt[Zt].x-De,On=lt[Zt].y-$e;ie.writeVarint(ct(un)),ie.writeVarint(ct(On)),De+=un,$e+=On}3===pe&&ie.writeVarint(et(7,1))}}function bt(re,ie){var V=typeof re;"string"===V?ie.writeStringField(1,re):"boolean"===V?ie.writeBooleanField(7,re):"number"===V&&(re%1!=0?ie.writeDoubleField(3,re):re<0?ie.writeSVarintField(6,re):ie.writeVarintField(5,re))}function ut(re,ie,V,pe,De,$e){if(De-pe<=V)return;const vt=pe+De>>1;St(re,ie,vt,pe,De,$e%2),ut(re,ie,V,pe,vt-1,$e+1),ut(re,ie,V,vt+1,De,$e+1)}function St(re,ie,V,pe,De,$e){for(;De>pe;){if(De-pe>600){const Dt=De-pe+1,Ht=V-pe+1,Zt=Math.log(Dt),un=.5*Math.exp(2*Zt/3),On=.5*Math.sqrt(Zt*un*(Dt-un)/Dt)*(Ht-Dt/2<0?-1:1);St(re,ie,V,Math.max(pe,Math.floor(V-Ht*un/Dt+On)),Math.min(De,Math.floor(V+(Dt-Ht)*un/Dt+On)),$e)}const vt=ie[2*V+$e];let Ct=pe,lt=De;for(Vt(re,ie,pe,V),ie[2*De+$e]>vt&&Vt(re,ie,pe,De);Ct<lt;){for(Vt(re,ie,Ct,lt),Ct++,lt--;ie[2*Ct+$e]<vt;)Ct++;for(;ie[2*lt+$e]>vt;)lt--}ie[2*pe+$e]===vt?Vt(re,ie,pe,lt):(lt++,Vt(re,ie,lt,De)),lt<=V&&(pe=lt+1),V<=lt&&(De=lt-1)}}function Vt(re,ie,V,pe){bn(re,V,pe),bn(ie,2*V,2*pe),bn(ie,2*V+1,2*pe+1)}function bn(re,ie,V){const pe=re[ie];re[ie]=re[V],re[V]=pe}function Nt(re,ie,V,pe){const De=re-V,$e=ie-pe;return De*De+$e*$e}Te.fromVectorTileJs=Ge,Te.fromGeojsonVt=function(re,ie){ie=ie||{};var V={};for(var pe in re)V[pe]=new ze(re[pe].features,ie),V[pe].name=pe,V[pe].version=ie.version,V[pe].extent=ie.extent;return Ge({layers:V})},Te.GeoJSONWrapper=He;const Bt=re=>re[0],Mt=re=>re[1];class Kt{constructor(ie,V=Bt,pe=Mt,De=64,$e=Float64Array){this.nodeSize=De,this.points=ie;const vt=ie.length<65536?Uint16Array:Uint32Array,Ct=this.ids=new vt(ie.length),lt=this.coords=new $e(2*ie.length);for(let Dt=0;Dt<ie.length;Dt++)Ct[Dt]=Dt,lt[2*Dt]=V(ie[Dt]),lt[2*Dt+1]=pe(ie[Dt]);ut(Ct,lt,De,0,Ct.length-1,0)}range(ie,V,pe,De){return function($e,vt,Ct,lt,Dt,Ht,Zt){const un=[0,$e.length-1,0],On=[];let at,Yt;for(;un.length;){const ii=un.pop(),Qn=un.pop(),ei=un.pop();if(Qn-ei<=Zt){for(let oi=ei;oi<=Qn;oi++)at=vt[2*oi],Yt=vt[2*oi+1],at>=Ct&&at<=Dt&&Yt>=lt&&Yt<=Ht&&On.push($e[oi]);continue}const yi=Math.floor((ei+Qn)/2);at=vt[2*yi],Yt=vt[2*yi+1],at>=Ct&&at<=Dt&&Yt>=lt&&Yt<=Ht&&On.push($e[yi]);const Yn=(ii+1)%2;(0===ii?Ct<=at:lt<=Yt)&&(un.push(ei),un.push(yi-1),un.push(Yn)),(0===ii?Dt>=at:Ht>=Yt)&&(un.push(yi+1),un.push(Qn),un.push(Yn))}return On}(this.ids,this.coords,ie,V,pe,De,this.nodeSize)}within(ie,V,pe){return function(De,$e,vt,Ct,lt,Dt){const Ht=[0,De.length-1,0],Zt=[],un=lt*lt;for(;Ht.length;){const On=Ht.pop(),at=Ht.pop(),Yt=Ht.pop();if(at-Yt<=Dt){for(let Yn=Yt;Yn<=at;Yn++)Nt($e[2*Yn],$e[2*Yn+1],vt,Ct)<=un&&Zt.push(De[Yn]);continue}const ii=Math.floor((Yt+at)/2),Qn=$e[2*ii],ei=$e[2*ii+1];Nt(Qn,ei,vt,Ct)<=un&&Zt.push(De[ii]);const yi=(On+1)%2;(0===On?vt-lt<=Qn:Ct-lt<=ei)&&(Ht.push(Yt),Ht.push(ii-1),Ht.push(yi)),(0===On?vt+lt>=Qn:Ct+lt>=ei)&&(Ht.push(ii+1),Ht.push(at),Ht.push(yi))}return Zt}(this.ids,this.coords,ie,V,pe,this.nodeSize)}}const Ot={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:re=>re},Ft=Math.fround||(ln=new Float32Array(1),re=>(ln[0]=+re,ln[0]));var ln;class nn{constructor(ie){this.options=mi(Object.create(Ot),ie),this.trees=new Array(this.options.maxZoom+1)}load(ie){const{log:V,minZoom:pe,maxZoom:De,nodeSize:$e}=this.options;V&&console.time("total time");const vt=`prepare ${ie.length} points`;V&&console.time(vt),this.points=ie;let Ct=[];for(let lt=0;lt<ie.length;lt++)ie[lt].geometry&&Ct.push(en(ie[lt],lt));this.trees[De+1]=new Kt(Ct,si,Ki,$e,Float32Array),V&&console.timeEnd(vt);for(let lt=De;lt>=pe;lt--){const Dt=+Date.now();Ct=this._cluster(Ct,lt),this.trees[lt]=new Kt(Ct,si,Ki,$e,Float32Array),V&&console.log("z%d: %d clusters in %dms",lt,Ct.length,+Date.now()-Dt)}return V&&console.timeEnd("total time"),this}getClusters(ie,V){let pe=((ie[0]+180)%360+360)%360-180;const De=Math.max(-90,Math.min(90,ie[1]));let $e=180===ie[2]?180:((ie[2]+180)%360+360)%360-180;const vt=Math.max(-90,Math.min(90,ie[3]));if(ie[2]-ie[0]>=360)pe=-180,$e=180;else if(pe>$e){const Ht=this.getClusters([pe,De,180,vt],V),Zt=this.getClusters([-180,De,$e,vt],V);return Ht.concat(Zt)}const Ct=this.trees[this._limitZoom(V)],lt=Ct.range(cn(pe),kn(vt),cn($e),kn(De)),Dt=[];for(const Ht of lt){const Zt=Ct.points[Ht];Dt.push(Zt.numPoints?yt(Zt):this.points[Zt.index])}return Dt}getChildren(ie){const V=this._getOriginId(ie),pe=this._getOriginZoom(ie),De="No cluster with the specified id.",$e=this.trees[pe];if(!$e)throw new Error(De);const vt=$e.points[V];if(!vt)throw new Error(De);const Ct=this.options.radius/(this.options.extent*Math.pow(2,pe-1)),lt=$e.within(vt.x,vt.y,Ct),Dt=[];for(const Ht of lt){const Zt=$e.points[Ht];Zt.parentId===ie&&Dt.push(Zt.numPoints?yt(Zt):this.points[Zt.index])}if(0===Dt.length)throw new Error(De);return Dt}getLeaves(ie,V,pe){const De=[];return this._appendLeaves(De,ie,V=V||10,pe=pe||0,0),De}getTile(ie,V,pe){const De=this.trees[this._limitZoom(ie)],$e=Math.pow(2,ie),{extent:vt,radius:Ct}=this.options,lt=Ct/vt,Dt=(pe-lt)/$e,Ht=(pe+1+lt)/$e,Zt={features:[]};return this._addTileFeatures(De.range((V-lt)/$e,Dt,(V+1+lt)/$e,Ht),De.points,V,pe,$e,Zt),0===V&&this._addTileFeatures(De.range(1-lt/$e,Dt,1,Ht),De.points,$e,pe,$e,Zt),V===$e-1&&this._addTileFeatures(De.range(0,Dt,lt/$e,Ht),De.points,-1,pe,$e,Zt),Zt.features.length?Zt:null}getClusterExpansionZoom(ie){let V=this._getOriginZoom(ie)-1;for(;V<=this.options.maxZoom;){const pe=this.getChildren(ie);if(V++,1!==pe.length)break;ie=pe[0].properties.cluster_id}return V}_appendLeaves(ie,V,pe,De,$e){const vt=this.getChildren(V);for(const Ct of vt){const lt=Ct.properties;if(lt&&lt.cluster?$e+lt.point_count<=De?$e+=lt.point_count:$e=this._appendLeaves(ie,lt.cluster_id,pe,De,$e):$e<De?$e++:ie.push(Ct),ie.length===pe)break}return $e}_addTileFeatures(ie,V,pe,De,$e,vt){for(const Ct of ie){const lt=V[Ct],Dt=lt.numPoints;let Ht,Zt,un;if(Dt)Ht=Xt(lt),Zt=lt.x,un=lt.y;else{const Yt=this.points[lt.index];Ht=Yt.properties,Zt=cn(Yt.geometry.coordinates[0]),un=kn(Yt.geometry.coordinates[1])}const On={type:1,geometry:[[Math.round(this.options.extent*(Zt*$e-pe)),Math.round(this.options.extent*(un*$e-De))]],tags:Ht};let at;Dt?at=lt.id:this.options.generateId?at=lt.index:this.points[lt.index].id&&(at=this.points[lt.index].id),void 0!==at&&(On.id=at),vt.features.push(On)}}_limitZoom(ie){return Math.max(this.options.minZoom,Math.min(+ie,this.options.maxZoom+1))}_cluster(ie,V){const pe=[],{radius:De,extent:$e,reduce:vt,minPoints:Ct}=this.options,lt=De/($e*Math.pow(2,V));for(let Dt=0;Dt<ie.length;Dt++){const Ht=ie[Dt];if(Ht.zoom<=V)continue;Ht.zoom=V;const Zt=this.trees[V+1],un=Zt.within(Ht.x,Ht.y,lt),On=Ht.numPoints||1;let at=On;for(const Yt of un){const ii=Zt.points[Yt];ii.zoom>V&&(at+=ii.numPoints||1)}if(at>=Ct){let Yt=Ht.x*On,ii=Ht.y*On,Qn=vt&&On>1?this._map(Ht,!0):null;const ei=(Dt<<5)+(V+1)+this.points.length;for(const yi of un){const Yn=Zt.points[yi];if(Yn.zoom<=V)continue;Yn.zoom=V;const oi=Yn.numPoints||1;Yt+=Yn.x*oi,ii+=Yn.y*oi,Yn.parentId=ei,vt&&(Qn||(Qn=this._map(Ht,!0)),vt(Qn,this._map(Yn)))}Ht.parentId=ei,pe.push(tn(Yt/at,ii/at,ei,at,Qn))}else if(pe.push(Ht),at>1)for(const Yt of un){const ii=Zt.points[Yt];ii.zoom<=V||(ii.zoom=V,pe.push(ii))}}return pe}_getOriginId(ie){return ie-this.points.length>>5}_getOriginZoom(ie){return(ie-this.points.length)%32}_map(ie,V){if(ie.numPoints)return V?mi({},ie.properties):ie.properties;const pe=this.points[ie.index].properties,De=this.options.map(pe);return V&&De===pe?mi({},De):De}}function tn(re,ie,V,pe,De){return{x:Ft(re),y:Ft(ie),zoom:1/0,id:V,parentId:-1,numPoints:pe,properties:De}}function en(re,ie){const[V,pe]=re.geometry.coordinates;return{x:Ft(cn(V)),y:Ft(kn(pe)),zoom:1/0,index:ie,parentId:-1}}function yt(re){return{type:"Feature",id:re.id,properties:Xt(re),geometry:{type:"Point",coordinates:[(ie=re.x,360*(ie-.5)),An(re.y)]}};var ie}function Xt(re){const ie=re.numPoints,V=ie>=1e4?`${Math.round(ie/1e3)}k`:ie>=1e3?Math.round(ie/100)/10+"k":ie;return mi(mi({},re.properties),{cluster:!0,cluster_id:re.id,point_count:ie,point_count_abbreviated:V})}function cn(re){return re/360+.5}function kn(re){const ie=Math.sin(re*Math.PI/180),V=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return V<0?0:V>1?1:V}function An(re){const ie=(180-360*re)*Math.PI/180;return 360*Math.atan(Math.exp(ie))/Math.PI-90}function mi(re,ie){for(const V in ie)re[V]=ie[V];return re}function si(re){return re.x}function Ki(re){return re.y}function xi(re,ie,V,pe){for(var De,$e=pe,vt=V-ie>>1,Ct=V-ie,lt=re[ie],Dt=re[ie+1],Ht=re[V],Zt=re[V+1],un=ie+3;un<V;un+=3){var On=Wi(re[un],re[un+1],lt,Dt,Ht,Zt);if(On>$e)De=un,$e=On;else if(On===$e){var at=Math.abs(un-vt);at<Ct&&(De=un,Ct=at)}}$e>pe&&(De-ie>3&&xi(re,ie,De,pe),re[De+2]=$e,V-De>3&&xi(re,De,V,pe))}function Wi(re,ie,V,pe,De,$e){var vt=De-V,Ct=$e-pe;if(0!==vt||0!==Ct){var lt=((re-V)*vt+(ie-pe)*Ct)/(vt*vt+Ct*Ct);lt>1?(V=De,pe=$e):lt>0&&(V+=vt*lt,pe+=Ct*lt)}return(vt=re-V)*vt+(Ct=ie-pe)*Ct}function Vi(re,ie,V,pe){var De={id:void 0===re?null:re,type:ie,geometry:V,tags:pe,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function($e){var vt=$e.geometry,Ct=$e.type;if("Point"===Ct||"MultiPoint"===Ct||"LineString"===Ct)_i($e,vt);else if("Polygon"===Ct||"MultiLineString"===Ct)for(var lt=0;lt<vt.length;lt++)_i($e,vt[lt]);else if("MultiPolygon"===Ct)for(lt=0;lt<vt.length;lt++)for(var Dt=0;Dt<vt[lt].length;Dt++)_i($e,vt[lt][Dt])}(De),De}function _i(re,ie){for(var V=0;V<ie.length;V+=3)re.minX=Math.min(re.minX,ie[V]),re.minY=Math.min(re.minY,ie[V+1]),re.maxX=Math.max(re.maxX,ie[V]),re.maxY=Math.max(re.maxY,ie[V+1])}function bi(re,ie,V,pe){if(ie.geometry){var De=ie.geometry.coordinates,$e=ie.geometry.type,vt=Math.pow(V.tolerance/((1<<V.maxZoom)*V.extent),2),Ct=[],lt=ie.id;if(V.promoteId?lt=ie.properties[V.promoteId]:V.generateId&&(lt=pe||0),"Point"===$e)xn(De,Ct);else if("MultiPoint"===$e)for(var Dt=0;Dt<De.length;Dt++)xn(De[Dt],Ct);else if("LineString"===$e)rn(De,Ct,vt,!1);else if("MultiLineString"===$e){if(V.lineMetrics){for(Dt=0;Dt<De.length;Dt++)rn(De[Dt],Ct=[],vt,!1),re.push(Vi(lt,"LineString",Ct,ie.properties));return}ot(De,Ct,vt,!1)}else if("Polygon"===$e)ot(De,Ct,vt,!0);else{if("MultiPolygon"!==$e){if("GeometryCollection"===$e){for(Dt=0;Dt<ie.geometry.geometries.length;Dt++)bi(re,{id:lt,geometry:ie.geometry.geometries[Dt],properties:ie.properties},V,pe);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Dt=0;Dt<De.length;Dt++){var Ht=[];ot(De[Dt],Ht,vt,!0),Ct.push(Ht)}}re.push(Vi(lt,$e,Ct,ie.properties))}}function xn(re,ie){ie.push(ft(re[0])),ie.push(pn(re[1])),ie.push(0)}function rn(re,ie,V,pe){for(var De,$e,vt=0,Ct=0;Ct<re.length;Ct++){var lt=ft(re[Ct][0]),Dt=pn(re[Ct][1]);ie.push(lt),ie.push(Dt),ie.push(0),Ct>0&&(vt+=pe?(De*Dt-lt*$e)/2:Math.sqrt(Math.pow(lt-De,2)+Math.pow(Dt-$e,2))),De=lt,$e=Dt}var Ht=ie.length-3;ie[2]=1,xi(ie,0,Ht,V),ie[Ht+2]=1,ie.size=Math.abs(vt),ie.start=0,ie.end=ie.size}function ot(re,ie,V,pe){for(var De=0;De<re.length;De++){var $e=[];rn(re[De],$e,V,pe),ie.push($e)}}function ft(re){return re/360+.5}function pn(re){var ie=Math.sin(re*Math.PI/180),V=.5-.25*Math.log((1+ie)/(1-ie))/Math.PI;return V<0?0:V>1?1:V}function _e(re,ie,V,pe,De,$e,vt,Ct){if(pe/=ie,$e>=(V/=ie)&&vt<pe)return re;if(vt<V||$e>=pe)return null;for(var lt=[],Dt=0;Dt<re.length;Dt++){var Ht=re[Dt],Zt=Ht.geometry,un=Ht.type,On=0===De?Ht.minX:Ht.minY,at=0===De?Ht.maxX:Ht.maxY;if(On>=V&&at<pe)lt.push(Ht);else if(!(at<V||On>=pe)){var Yt=[];if("Point"===un||"MultiPoint"===un)Ye(Zt,Yt,V,pe,De);else if("LineString"===un)j(Zt,Yt,V,pe,De,!1,Ct.lineMetrics);else if("MultiLineString"===un)We(Zt,Yt,V,pe,De,!1);else if("Polygon"===un)We(Zt,Yt,V,pe,De,!0);else if("MultiPolygon"===un)for(var ii=0;ii<Zt.length;ii++){var Qn=[];We(Zt[ii],Qn,V,pe,De,!0),Qn.length&&Yt.push(Qn)}if(Yt.length){if(Ct.lineMetrics&&"LineString"===un){for(ii=0;ii<Yt.length;ii++)lt.push(Vi(Ht.id,un,Yt[ii],Ht.tags));continue}"LineString"!==un&&"MultiLineString"!==un||(1===Yt.length?(un="LineString",Yt=Yt[0]):un="MultiLineString"),"Point"!==un&&"MultiPoint"!==un||(un=3===Yt.length?"Point":"MultiPoint"),lt.push(Vi(Ht.id,un,Yt,Ht.tags))}}}return lt.length?lt:null}function Ye(re,ie,V,pe,De){for(var $e=0;$e<re.length;$e+=3){var vt=re[$e+De];vt>=V&&vt<=pe&&(ie.push(re[$e]),ie.push(re[$e+1]),ie.push(re[$e+2]))}}function j(re,ie,V,pe,De,$e,vt){for(var Ct,lt,Dt=ye(re),Ht=0===De?on:qn,Zt=re.start,un=0;un<re.length-3;un+=3){var On=re[un],at=re[un+1],Yt=re[un+2],ii=re[un+3],Qn=re[un+4],ei=0===De?On:at,yi=0===De?ii:Qn,Yn=!1;vt&&(Ct=Math.sqrt(Math.pow(On-ii,2)+Math.pow(at-Qn,2))),ei<V?yi>V&&(lt=Ht(Dt,On,at,ii,Qn,V),vt&&(Dt.start=Zt+Ct*lt)):ei>pe?yi<pe&&(lt=Ht(Dt,On,at,ii,Qn,pe),vt&&(Dt.start=Zt+Ct*lt)):Tt(Dt,On,at,Yt),yi<V&&ei>=V&&(lt=Ht(Dt,On,at,ii,Qn,V),Yn=!0),yi>pe&&ei<=pe&&(lt=Ht(Dt,On,at,ii,Qn,pe),Yn=!0),!$e&&Yn&&(vt&&(Dt.end=Zt+Ct*lt),ie.push(Dt),Dt=ye(re)),vt&&(Zt+=Ct)}var oi=re.length-3;On=re[oi],at=re[oi+1],Yt=re[oi+2],(ei=0===De?On:at)>=V&&ei<=pe&&Tt(Dt,On,at,Yt),oi=Dt.length-3,$e&&oi>=3&&(Dt[oi]!==Dt[0]||Dt[oi+1]!==Dt[1])&&Tt(Dt,Dt[0],Dt[1],Dt[2]),Dt.length&&ie.push(Dt)}function ye(re){var ie=[];return ie.size=re.size,ie.start=re.start,ie.end=re.end,ie}function We(re,ie,V,pe,De,$e){for(var vt=0;vt<re.length;vt++)j(re[vt],ie,V,pe,De,$e,!1)}function Tt(re,ie,V,pe){re.push(ie),re.push(V),re.push(pe)}function on(re,ie,V,pe,De,$e){var vt=($e-ie)/(pe-ie);return re.push($e),re.push(V+(De-V)*vt),re.push(1),vt}function qn(re,ie,V,pe,De,$e){var vt=($e-V)/(De-V);return re.push(ie+(pe-ie)*vt),re.push($e),re.push(1),vt}function ci(re,ie){for(var V=[],pe=0;pe<re.length;pe++){var De,$e=re[pe],vt=$e.type;if("Point"===vt||"MultiPoint"===vt||"LineString"===vt)De=ai($e.geometry,ie);else if("MultiLineString"===vt||"Polygon"===vt){De=[];for(var Ct=0;Ct<$e.geometry.length;Ct++)De.push(ai($e.geometry[Ct],ie))}else if("MultiPolygon"===vt)for(De=[],Ct=0;Ct<$e.geometry.length;Ct++){for(var lt=[],Dt=0;Dt<$e.geometry[Ct].length;Dt++)lt.push(ai($e.geometry[Ct][Dt],ie));De.push(lt)}V.push(Vi($e.id,vt,De,$e.tags))}return V}function ai(re,ie){var V=[];V.size=re.size,void 0!==re.start&&(V.start=re.start,V.end=re.end);for(var pe=0;pe<re.length;pe+=3)V.push(re[pe]+ie,re[pe+1],re[pe+2]);return V}function Un(re,ie){if(re.transformed)return re;var V,pe,De,$e=1<<re.z,vt=re.x,Ct=re.y;for(V=0;V<re.features.length;V++){var lt=re.features[V],Dt=lt.geometry,Ht=lt.type;if(lt.geometry=[],1===Ht)for(pe=0;pe<Dt.length;pe+=2)lt.geometry.push(Fi(Dt[pe],Dt[pe+1],ie,$e,vt,Ct));else for(pe=0;pe<Dt.length;pe++){var Zt=[];for(De=0;De<Dt[pe].length;De+=2)Zt.push(Fi(Dt[pe][De],Dt[pe][De+1],ie,$e,vt,Ct));lt.geometry.push(Zt)}}return re.transformed=!0,re}function Fi(re,ie,V,pe,De,$e){return[Math.round(V*(re*pe-De)),Math.round(V*(ie*pe-$e))]}function Ti(re,ie,V,pe,De){for(var $e=ie===De.maxZoom?0:De.tolerance/((1<<ie)*De.extent),vt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:V,y:pe,z:ie,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Ct=0;Ct<re.length;Ct++){vt.numFeatures++,Yi(vt,re[Ct],$e,De);var lt=re[Ct].minX,Dt=re[Ct].minY,Ht=re[Ct].maxX,Zt=re[Ct].maxY;lt<vt.minX&&(vt.minX=lt),Dt<vt.minY&&(vt.minY=Dt),Ht>vt.maxX&&(vt.maxX=Ht),Zt>vt.maxY&&(vt.maxY=Zt)}return vt}function Yi(re,ie,V,pe){var De=ie.geometry,$e=ie.type,vt=[];if("Point"===$e||"MultiPoint"===$e)for(var Ct=0;Ct<De.length;Ct+=3)vt.push(De[Ct]),vt.push(De[Ct+1]),re.numPoints++,re.numSimplified++;else if("LineString"===$e)br(vt,De,re,V,!1,!1);else if("MultiLineString"===$e||"Polygon"===$e)for(Ct=0;Ct<De.length;Ct++)br(vt,De[Ct],re,V,"Polygon"===$e,0===Ct);else if("MultiPolygon"===$e)for(var lt=0;lt<De.length;lt++){var Dt=De[lt];for(Ct=0;Ct<Dt.length;Ct++)br(vt,Dt[Ct],re,V,!0,0===Ct)}if(vt.length){var Ht=ie.tags||null;if("LineString"===$e&&pe.lineMetrics){for(var Zt in Ht={},ie.tags)Ht[Zt]=ie.tags[Zt];Ht.mapbox_clip_start=De.start/De.size,Ht.mapbox_clip_end=De.end/De.size}var un={geometry:vt,type:"Polygon"===$e||"MultiPolygon"===$e?3:"LineString"===$e||"MultiLineString"===$e?2:1,tags:Ht};null!==ie.id&&(un.id=ie.id),re.features.push(un)}}function br(re,ie,V,pe,De,$e){var vt=pe*pe;if(pe>0&&ie.size<(De?vt:pe))V.numPoints+=ie.length/3;else{for(var Ct=[],lt=0;lt<ie.length;lt+=3)(0===pe||ie[lt+2]>vt)&&(V.numSimplified++,Ct.push(ie[lt]),Ct.push(ie[lt+1])),V.numPoints++;De&&function(Dt,Ht){for(var Zt=0,un=0,On=Dt.length,at=On-2;un<On;at=un,un+=2)Zt+=(Dt[un]-Dt[at])*(Dt[un+1]+Dt[at+1]);if(Zt>0===Ht)for(un=0,On=Dt.length;un<On/2;un+=2){var Yt=Dt[un],ii=Dt[un+1];Dt[un]=Dt[On-2-un],Dt[un+1]=Dt[On-1-un],Dt[On-2-un]=Yt,Dt[On-1-un]=ii}}(Ct,$e),re.push(Ct)}}function Ei(re,ie){var V=(ie=this.options=function(De,$e){for(var vt in $e)De[vt]=$e[vt];return De}(Object.create(this.options),ie)).debug;if(V&&console.time("preprocess data"),ie.maxZoom<0||ie.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ie.promoteId&&ie.generateId)throw new Error("promoteId and generateId cannot be used together.");var De,$e,vt,Ct,lt,Dt,pe=function(De,$e){var vt=[];if("FeatureCollection"===De.type)for(var Ct=0;Ct<De.features.length;Ct++)bi(vt,De.features[Ct],$e,Ct);else bi(vt,"Feature"===De.type?De:{geometry:De},$e);return vt}(re,ie);this.tiles={},this.tileCoords=[],V&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ie.indexMaxZoom,ie.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),(De=pe,$e=ie,vt=$e.buffer/$e.extent,Ct=De,lt=_e(De,1,-1-vt,vt,0,-1,2,$e),Dt=_e(De,1,1-vt,2+vt,0,-1,2,$e),(lt||Dt)&&(Ct=_e(De,1,-vt,1+vt,0,-1,2,$e)||[],lt&&(Ct=ci(lt,1).concat(Ct)),Dt&&(Ct=Ct.concat(ci(Dt,-1)))),pe=Ct).length&&this.splitTile(pe,0,0,0),V&&(pe.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function wr(re,ie,V){return 32*((1<<re)*V+ie)+re}function mr(re,ie){const V=re.tileID.canonical;if(!this._geoJSONIndex)return ie(null,null);const pe=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!pe)return ie(null,null);const De=new ve(pe.features);let $e=Te(De);0===$e.byteOffset&&$e.byteLength===$e.buffer.byteLength||($e=new Uint8Array($e)),ie(null,{vectorTile:De,rawData:$e.buffer})}Ei.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ei.prototype.splitTile=function(re,ie,V,pe,De,$e,vt){for(var Ct=[re,ie,V,pe],lt=this.options,Dt=lt.debug;Ct.length;){pe=Ct.pop(),V=Ct.pop(),ie=Ct.pop(),re=Ct.pop();var Ht=1<<ie,Zt=wr(ie,V,pe),un=this.tiles[Zt];if(!un&&(Dt>1&&console.time("creation"),un=this.tiles[Zt]=Ti(re,ie,V,pe,lt),this.tileCoords.push({z:ie,x:V,y:pe}),Dt)){Dt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ie,V,pe,un.numFeatures,un.numPoints,un.numSimplified),console.timeEnd("creation"));var On="z"+ie;this.stats[On]=(this.stats[On]||0)+1,this.total++}if(un.source=re,De){if(ie===lt.maxZoom||ie===De)continue;var at=1<<De-ie;if(V!==Math.floor($e/at)||pe!==Math.floor(vt/at))continue}else if(ie===lt.indexMaxZoom||un.numPoints<=lt.indexMaxPoints)continue;if(un.source=null,0!==re.length){Dt>1&&console.time("clipping");var Yt,ii,Qn,ei,yi,Yn,oi=.5*lt.buffer/lt.extent,En=.5-oi,zt=.5+oi,Zn=1+oi;Yt=ii=Qn=ei=null,yi=_e(re,Ht,V-oi,V+zt,0,un.minX,un.maxX,lt),Yn=_e(re,Ht,V+En,V+Zn,0,un.minX,un.maxX,lt),re=null,yi&&(Yt=_e(yi,Ht,pe-oi,pe+zt,1,un.minY,un.maxY,lt),ii=_e(yi,Ht,pe+En,pe+Zn,1,un.minY,un.maxY,lt),yi=null),Yn&&(Qn=_e(Yn,Ht,pe-oi,pe+zt,1,un.minY,un.maxY,lt),ei=_e(Yn,Ht,pe+En,pe+Zn,1,un.minY,un.maxY,lt),Yn=null),Dt>1&&console.timeEnd("clipping"),Ct.push(Yt||[],ie+1,2*V,2*pe),Ct.push(ii||[],ie+1,2*V,2*pe+1),Ct.push(Qn||[],ie+1,2*V+1,2*pe),Ct.push(ei||[],ie+1,2*V+1,2*pe+1)}}},Ei.prototype.getTile=function(re,ie,V){var pe=this.options,De=pe.extent,$e=pe.debug;if(re<0||re>24)return null;var vt=1<<re,Ct=wr(re,ie=(ie%vt+vt)%vt,V);if(this.tiles[Ct])return Un(this.tiles[Ct],De);$e>1&&console.log("drilling down to z%d-%d-%d",re,ie,V);for(var lt,Dt=re,Ht=ie,Zt=V;!lt&&Dt>0;)Dt--,Ht=Math.floor(Ht/2),Zt=Math.floor(Zt/2),lt=this.tiles[wr(Dt,Ht,Zt)];return lt&&lt.source?($e>1&&console.log("found parent tile z%d-%d-%d",Dt,Ht,Zt),$e>1&&console.time("drilling down"),this.splitTile(lt.source,Dt,Ht,Zt,re,ie,V),$e>1&&console.timeEnd("drilling down"),this.tiles[Ct]?Un(this.tiles[Ct],De):null):null};class Ji extends l.VectorTileWorkerSource{constructor(ie,V,pe,De,$e){super(ie,V,pe,De,mr),$e&&(this.loadGeoJSON=$e)}loadData(ie,V){const pe=ie&&ie.request,De=pe&&pe.collectResourceTiming;this.loadGeoJSON(ie,($e,vt)=>{if($e||!vt)return V($e);if("object"!=typeof vt)return V(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));{K(vt,!0);try{if(ie.filter){const lt=l.createExpression(ie.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===lt.result)throw new Error(lt.value.map(Ht=>`${Ht.key}: ${Ht.message}`).join(", "));const Dt=vt.features.filter(Ht=>lt.value.evaluate({zoom:0},Ht));vt={type:"FeatureCollection",features:Dt}}this._geoJSONIndex=ie.cluster?new nn(function({superclusterOptions:lt,clusterProperties:Dt}){if(!Dt||!lt)return lt;const Ht={},Zt={},un={accumulated:null,zoom:0},On={properties:null},at=Object.keys(Dt);for(const Yt of at){const[ii,Qn]=Dt[Yt],ei=l.createExpression(Qn),yi=l.createExpression("string"==typeof ii?[ii,["accumulated"],["get",Yt]]:ii);Ht[Yt]=ei.value,Zt[Yt]=yi.value}return lt.map=Yt=>{On.properties=Yt;const ii={};for(const Qn of at)ii[Qn]=Ht[Qn].evaluate(un,On);return ii},lt.reduce=(Yt,ii)=>{On.properties=ii;for(const Qn of at)un.accumulated=Yt[Qn],Yt[Qn]=Zt[Qn].evaluate(un,On)},lt}(ie)).load(vt.features):new Ei(lt=vt,ie.geojsonVtOptions)}catch(lt){return V(lt)}this.loaded={};const Ct={};if(De){const lt=l.getPerformanceMeasurement(pe);lt&&(Ct.resourceTiming={},Ct.resourceTiming[ie.source]=JSON.parse(JSON.stringify(lt)))}V(null,Ct)}var lt})}reloadTile(ie,V){const pe=this.loaded;return pe&&pe[ie.uid]?super.reloadTile(ie,V):this.loadTile(ie,V)}loadGeoJSON(ie,V){if(ie.request)l.getJSON(ie.request,V);else{if("string"!=typeof ie.data)return V(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`));try{return V(null,JSON.parse(ie.data))}catch{return V(new Error(`Input data given to '${ie.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ie,V){try{V(null,this._geoJSONIndex.getClusterExpansionZoom(ie.clusterId))}catch(pe){V(pe)}}getClusterChildren(ie,V){try{V(null,this._geoJSONIndex.getChildren(ie.clusterId))}catch(pe){V(pe)}}getClusterLeaves(ie,V){try{V(null,this._geoJSONIndex.getLeaves(ie.clusterId,ie.limit,ie.offset))}catch(pe){V(pe)}}}class hi{constructor(ie){this.self=ie,this.actor=new l.Actor(ie,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded=!1,this.workerSourceTypes={vector:l.VectorTileWorkerSource,geojson:Ji},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(V,pe)=>{if(this.workerSourceTypes[V])throw new Error(`Worker source with name "${V}" already registered.`);this.workerSourceTypes[V]=pe},this.self.registerRTLTextPlugin=V=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=V.applyArabicShaping,l.plugin.processBidirectionalText=V.processBidirectionalText,l.plugin.processStyledBidirectionalText=V.processStyledBidirectionalText}}checkIfReady(ie,V,pe){pe()}setReferrer(ie,V){this.referrer=V}spriteLoaded(ie,V){this.isSpriteLoaded=V;for(const pe in this.workerSources[ie]){const De=this.workerSources[ie][pe];for(const $e in De)De[$e]instanceof l.VectorTileWorkerSource&&(De[$e].isSpriteLoaded=V,De[$e].fire(new l.Event("isSpriteLoaded")))}}setImages(ie,V,pe){this.availableImages[ie]=V;for(const De in this.workerSources[ie]){const $e=this.workerSources[ie][De];for(const vt in $e)$e[vt].availableImages=V}pe()}enableTerrain(ie,V,pe){this.terrain=V,pe()}setLayers(ie,V,pe){this.getLayerIndex(ie).replace(V),pe()}updateLayers(ie,V,pe){this.getLayerIndex(ie).update(V.layers,V.removedIds),pe()}loadTile(ie,V,pe){const De=this.enableTerrain?l.extend({enableTerrain:this.terrain},V):V;this.getWorkerSource(ie,V.type,V.source).loadTile(De,pe)}loadDEMTile(ie,V,pe){const De=this.enableTerrain?l.extend({buildQuadTree:this.terrain},V):V;this.getDEMWorkerSource(ie,V.source).loadTile(De,pe)}reloadTile(ie,V,pe){const De=this.enableTerrain?l.extend({enableTerrain:this.terrain},V):V;this.getWorkerSource(ie,V.type,V.source).reloadTile(De,pe)}abortTile(ie,V,pe){this.getWorkerSource(ie,V.type,V.source).abortTile(V,pe)}removeTile(ie,V,pe){this.getWorkerSource(ie,V.type,V.source).removeTile(V,pe)}removeSource(ie,V,pe){if(!this.workerSources[ie]||!this.workerSources[ie][V.type]||!this.workerSources[ie][V.type][V.source])return;const De=this.workerSources[ie][V.type][V.source];delete this.workerSources[ie][V.type][V.source],void 0!==De.removeSource?De.removeSource(V,pe):pe()}loadWorkerSource(ie,V,pe){try{this.self.importScripts(V.url),pe()}catch(De){pe(De.toString())}}syncRTLPluginState(ie,V,pe){try{l.plugin.setState(V);const De=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&null!=De){this.self.importScripts(De);const $e=l.plugin.isParsed();pe($e?void 0:new Error(`RTL Text Plugin failed to import scripts from ${De}`),$e)}}catch(De){pe(De.toString())}}getAvailableImages(ie){let V=this.availableImages[ie];return V||(V=[]),V}getLayerIndex(ie){let V=this.layerIndexes[ie];return V||(V=this.layerIndexes[ie]=new f),V}getWorkerSource(ie,V,pe){return this.workerSources[ie]||(this.workerSources[ie]={}),this.workerSources[ie][V]||(this.workerSources[ie][V]={}),this.workerSources[ie][V][pe]||(this.workerSources[ie][V][pe]=new this.workerSourceTypes[V]({send:(De,$e,vt,Ct,lt,Dt)=>{this.actor.send(De,$e,vt,ie,lt,Dt)},scheduler:this.actor.scheduler},this.getLayerIndex(ie),this.getAvailableImages(ie),this.isSpriteLoaded)),this.workerSources[ie][V][pe]}getDEMWorkerSource(ie,V){return this.demWorkerSources[ie]||(this.demWorkerSources[ie]={}),this.demWorkerSources[ie][V]||(this.demWorkerSources[ie][V]=new te),this.demWorkerSources[ie][V]}enforceCacheSizeLimit(ie,V){l.enforceCacheSizeLimit(V)}getWorkerPerformanceMetrics(ie,V,pe){pe(void 0,void 0)}}return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope&&(self.worker=new hi(self)),hi}),d(0,function(l){var P=O;function O(g){return i=g,!("undefined"==typeof window||"undefined"==typeof document||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,b,w=new Blob([""],{type:"text/javascript"}),k=URL.createObjectURL(w);try{b=new Worker(k),m=!0}catch{m=!1}return b&&b.terminate(),URL.revokeObjectURL(k),m}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var m=document.createElement("canvas");m.width=m.height=1;var b=m.getContext("2d");if(!b)return!1;var w=b.getImageData(0,0,1,1);return w&&w.width===m.width}()||(void 0===f[u=i&&i.failIfMajorPerformanceCaveat]&&(f[u]=function(m){var b,k,Z,J,w=(k=m,Z=document.createElement("canvas"),(J=Object.create(O.webGLContextAttributes)).failIfMajorPerformanceCaveat=k,Z.getContext("webgl",J)||Z.getContext("experimental-webgl",J));if(!w)return!1;try{b=w.createShader(w.VERTEX_SHADER)}catch{return!1}return!(!b||w.isContextLost())&&(w.shaderSource(b,"void main() {}"),w.compileShader(b),!0===w.getShaderParameter(b,w.COMPILE_STATUS))}(u)),!f[u]||document.documentMode));var i,u}var f={};function H(g,i){if(Array.isArray(g)){if(!Array.isArray(i)||g.length!==i.length)return!1;for(let u=0;u<g.length;u++)if(!H(g[u],i[u]))return!1;return!0}if("object"==typeof g&&null!==g&&null!==i){if("object"!=typeof i||Object.keys(g).length!==Object.keys(i).length)return!1;for(const u in g)if(!H(g[u],i[u]))return!1;return!0}return g===i}O.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const te={create:function(g,i,u){const m=l.window.document.createElement(g);return void 0!==i&&(m.className=i),u&&u.appendChild(m),m},createNS:function(g,i){return l.window.document.createElementNS(g,i)}},K=l.window.document&&l.window.document.documentElement.style,G=K&&void 0!==K.userSelect?"userSelect":"WebkitUserSelect";let ne;te.disableDrag=function(){K&&G&&(ne=K[G],K[G]="none")},te.enableDrag=function(){K&&G&&(K[G]=ne)},te.setTransform=function(g,i){g.style.transform=i};let ce=!1;try{const g=Object.defineProperty({},"passive",{get(){ce=!0}});l.window.addEventListener("test",g,g),l.window.removeEventListener("test",g,g)}catch{ce=!1}te.addEventListener=function(g,i,u,m={}){g.addEventListener(i,u,"passive"in m&&ce?m:m.capture)},te.removeEventListener=function(g,i,u,m={}){g.removeEventListener(i,u,"passive"in m&&ce?m:m.capture)};const me=function(g){g.preventDefault(),g.stopPropagation(),l.window.removeEventListener("click",me,!0)};function ve(g,i,u){const m=g.offsetWidth===i.width?1:g.offsetWidth/i.width;return new l.pointGeometry((u.clientX-i.left)*m,(u.clientY-i.top)*m)}te.suppressClick=function(){l.window.addEventListener("click",me,!0),l.window.setTimeout(()=>{l.window.removeEventListener("click",me,!0)},0)},te.mousePos=function(g,i){const u=g.getBoundingClientRect();return ve(g,u,i)},te.touchPos=function(g,i){const u=g.getBoundingClientRect(),m=[];for(let b=0;b<i.length;b++)m.push(ve(g,u,i[b]));return m},te.mouseButton=function(g){return void 0!==l.window.InstallTrigger&&2===g.button&&g.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button},te.remove=function(g){g.parentNode&&g.parentNode.removeChild(g)};class we{constructor(i,u){this.pos=i,this.dir=u}intersectsPlane(i,u,m){const b=l.dot(u,this.dir);if(Math.abs(b)<1e-6)return!1;const w=l.dot(l.sub(l.create(),i,this.pos),u)/b,k=l.scaleAndAdd(l.create(),this.pos,this.dir,w);return l.copy(m,k),!0}}class ze{constructor(i,u){this.points=i,this.planes=u}static fromInvProjectionMatrix(i,u,m){const b=Math.pow(2,m),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(Z=>{const J=l.transformMat4([],Z,i),se=1/J[3]/u*b;return l.mul(J,J,[se,se,1/J[3],se])}),k=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(Z=>{const J=l.sub([],w[Z[0]],w[Z[1]]),se=l.sub([],w[Z[2]],w[Z[1]]),he=l.normalize([],l.cross([],J,se)),be=-l.dot(he,w[Z[1]]);return he.concat(be)});return new ze(w,k)}}class Ne{constructor(i,u){this.min=i,this.max=u,this.center=l.scale([],l.add([],this.min,this.max),.5)}quadrant(i){const u=[i%2==0,i<2],m=l.clone(this.min),b=l.clone(this.max);for(let w=0;w<u.length;w++)m[w]=u[w]?this.min[w]:this.center[w],b[w]=u[w]?this.center[w]:this.max[w];return b[2]=this.max[2],new Ne(m,b)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}intersects(i){const u=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let m=!0;for(let b=0;b<i.planes.length;b++){const w=i.planes[b];let k=0;for(let Z=0;Z<u.length;Z++)k+=l.dot$1(w,u[Z])>=0;if(0===k)return 0;k!==u.length&&(m=!1)}if(m)return 2;for(let b=0;b<3;b++){let w=Number.MAX_VALUE,k=-Number.MAX_VALUE;for(let Z=0;Z<i.points.length;Z++){const J=i.points[Z][b]-this.min[b];w=Math.min(w,J),k=Math.max(k,J)}if(k<0||w>this.max[b]-this.min[b])return 0}return 1}}function Ae(g){const{userImage:i}=g;return!!(i&&i.render&&i.render())&&(g.data.replace(new Uint8Array(i.data.buffer)),!0)}class Te extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:u,callback:m}of this.requestors)this._notify(u,m);this.requestors=[]}}getImage(i){return this.images[i]}addImage(i,u){this._validate(i,u)&&(this.images[i]=u)}_validate(i,u){let m=!0;return this._validateStretch(u.stretchX,u.data&&u.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),m=!1),this._validateStretch(u.stretchY,u.data&&u.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),m=!1),this._validateContent(u.content,u)||(this.fire(new l.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),m=!1),m}_validateStretch(i,u){if(!i)return!0;let m=0;for(const b of i){if(b[0]<m||b[1]<b[0]||u<b[1])return!1;m=b[1]}return!0}_validateContent(i,u){return!(i&&(4!==i.length||i[0]<0||u.data.width<i[0]||i[1]<0||u.data.height<i[1]||i[2]<0||u.data.width<i[2]||i[3]<0||u.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,u){u.version=this.images[i].version+1,this.images[i]=u,this.updatedImages[i]=!0}removeImage(i){const u=this.images[i];delete this.images[i],delete this.patterns[i],u.userImage&&u.userImage.onRemove&&u.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,u){let m=!0;if(!this.isLoaded())for(const b of i)this.images[b]||(m=!1);this.isLoaded()||m?this._notify(i,u):this.requestors.push({ids:i,callback:u})}_notify(i,u){const m={};for(const b of i){this.images[b]||this.fire(new l.Event("styleimagemissing",{id:b}));const w=this.images[b];w?m[b]={data:w.data.clone(),pixelRatio:w.pixelRatio,sdf:w.sdf,version:w.version,stretchX:w.stretchX,stretchY:w.stretchY,content:w.content,hasRenderCallback:Boolean(w.userImage&&w.userImage.render)}:l.warnOnce(`Image "${b}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}u(null,m)}getPixelSize(){const{width:i,height:u}=this.atlasImage;return{width:i,height:u}}getPattern(i){const u=this.patterns[i],m=this.getImage(i);if(!m)return null;if(u&&u.position.version===m.version)return u.position;if(u)u.position.version=m.version;else{const b={w:m.data.width+2,h:m.data.height+2,x:0,y:0},w=new l.ImagePosition(b,m);this.patterns[i]={bin:b,position:w}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const u=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(i,this.atlasImage,u.RGBA),this.atlasTexture.bind(u.LINEAR,u.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const w in this.patterns)i.push(this.patterns[w].bin);const{w:u,h:m}=l.potpack(i),b=this.atlasImage;b.resize({width:u||1,height:m||1});for(const w in this.patterns){const{bin:k}=this.patterns[w],Z=k.x+1,J=k.y+1,se=this.images[w].data,he=se.width,be=se.height;l.RGBAImage.copy(se,b,{x:0,y:0},{x:Z,y:J},{width:he,height:be}),l.RGBAImage.copy(se,b,{x:0,y:be-1},{x:Z,y:J-1},{width:he,height:1}),l.RGBAImage.copy(se,b,{x:0,y:0},{x:Z,y:J+be},{width:he,height:1}),l.RGBAImage.copy(se,b,{x:he-1,y:0},{x:Z-1,y:J},{width:1,height:be}),l.RGBAImage.copy(se,b,{x:0,y:0},{x:Z+he,y:J},{width:1,height:be})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const u of i){if(this.callbackDispatchedThisFrame[u])continue;this.callbackDispatchedThisFrame[u]=!0;const m=this.images[u];Ae(m)&&this.updateImage(u,m)}}}const He=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(g,i){return function([u,m,b]){const w=l.degToRad(m+90),k=l.degToRad(b);return{x:u*Math.cos(w)*Math.sin(k),y:u*Math.sin(w)*Math.sin(k),z:u*Math.cos(k),azimuthal:m,polar:b}}(g.expression.evaluate(i))}interpolate(g,i,u){return{x:l.number(g.x,i.x,u),y:l.number(g.y,i.y,u),z:l.number(g.z,i.z,u),azimuthal:l.number(g.azimuthal,i.azimuthal,u),polar:l.number(g.polar,i.polar,u)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)}),Ge="-transition";class Fe extends l.Evented{constructor(i){super(),this._transitionable=new l.Transitionable(He),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,u={}){if(!this._validate(l.validateLight,i,u))for(const m in i){const b=i[m];l.endsWith(m,Ge)?this._transitionable.setTransition(m.slice(0,-Ge.length),b):this._transitionable.setValue(m,b)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,m){return(!m||!1!==m.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}const E=new l.Properties({source:new l.DataConstantProperty(l.spec.terrain.source),exaggeration:new l.DataConstantProperty(l.spec.terrain.exaggeration)}),Qe="-transition";class et extends l.Evented{constructor(i){super(),this._transitionable=new l.Transitionable(E),this.set(i),this._transitioning=this._transitionable.untransitioned()}get(){return this._transitionable.serialize()}set(i){for(const u in i){const m=i[u];l.endsWith(u,Qe)?this._transitionable.setTransition(u.slice(0,-Qe.length),m):this._transitionable.setValue(u,m)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}}function ct(g,i,u,m){const b=l.smoothstep(45,65,u),[w,k]=gt(g,m),Z=l.length(i);let J=1-Math.min(1,Math.exp((Z-w)/(k-w)*-6));return J*=J*J,J=Math.min(1,1.00747*J),J*b*g.alpha}function gt(g,i){const u=.5/Math.tan(.5*i);return[g.range[0]+u,g.range[1]+u]}const bt=new l.Properties({range:new l.DataConstantProperty(l.spec.fog.range),color:new l.DataConstantProperty(l.spec.fog.color),"horizon-blend":new l.DataConstantProperty(l.spec.fog["horizon-blend"])}),ut="-transition";class St extends l.Evented{constructor(i){super(),this._transitionable=new l.Transitionable(bt),this.set(i),this._transitioning=this._transitionable.untransitioned()}get state(){return{range:this.properties.get("range"),horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,u={}){if(!this._validate(l.validateFog,i,u))for(const m in i){const b=i[m];l.endsWith(m,ut)?this._transitionable.setTransition(m.slice(0,-ut.length),b):this._transitionable.setValue(m,b)}}getOpacity(i){const u=this.properties&&this.properties.get("color")||1;return l.smoothstep(45,65,i)*u.a}getOpacityAtLatLng(i,u){return function(m,b,w){const k=l.MercatorCoordinate.fromLngLat(b),Z=w.elevation?w.elevation.getAtPointOrZero(k):0,J=[k.x,k.y,Z];return l.transformMat4$1(J,J,w.mercatorFogMatrix),ct(m,J,w.pitch,w._fov)}(this.state,i,u)}getFovAdjustedRange(i){return gt(this.state,i)}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,u,m){return(!m||!1!==m.validate)&&l.emitValidationErrors(this,i.call(l.validateStyle,l.extend({value:u,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class Vt{constructor(i,u){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const m=this.workerPool.acquire(this.id);for(let b=0;b<m.length;b++){const w=new Vt.Actor(m[b],u,this.id);w.name=`Worker ${b}`,this.actors.push(w)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,u,m){l.asyncAll(this.actors,(b,w)=>{b.send(i,u,w)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function bn(g,i,u){return i*(l.EXTENT/(g.tileSize*Math.pow(2,u-g.tileID.overscaledZ)))}Vt.Actor=l.Actor;class Nt{constructor(i,u,m,b){this.screenBounds=i,this.cameraPoint=u,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this.screenGeometry.map(w=>b.pointCoordinate3D(w)),this.cameraGeometry=this.bufferedCameraGeometry(0)}static createFromScreenPoints(i,u){let m,b;if(i instanceof l.pointGeometry||"number"==typeof i[0]){const w=l.pointGeometry.convert(i);m=[l.pointGeometry.convert(i)],b=u.isPointAboveHorizon(w)}else{const w=l.pointGeometry.convert(i[0]),k=l.pointGeometry.convert(i[1]);m=[w,k],b=l.polygonizeBounds(w,k).every(Z=>u.isPointAboveHorizon(Z))}return new Nt(m,u.getCameraPoint(),b,u)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return l.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const u=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new l.pointGeometry(1,1)):this.screenBounds[1],b=l.polygonizeBounds(u,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>u.x&&this.cameraPoint.x<m.x?b.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?b[2]=this.cameraPoint:this.cameraPoint.x<=u.x&&(b[3]=this.cameraPoint)),l.bufferConvexPolygon(b,i)}containsTile(i,u,m){const b=i.queryPadding+1,w=m?this._bufferedCameraMercator(b,u).map(Me=>i.tileID.getTilePoint(Me)):this._bufferedScreenMercator(b,u).map(Me=>i.tileID.getTilePoint(Me)),k=this.screenGeometryMercator.map(Me=>i.tileID.getTileVec3(Me)),Z=k.map(Me=>new l.pointGeometry(Me[0],Me[1])),J=u.getFreeCameraOptions().position||new l.MercatorCoordinate(0,0,0),se=i.tileID.getTileVec3(J),he=k.map(Me=>{const Ve=l.sub(Me,Me,se);return l.normalize(Ve,Ve),new we(se,Ve)}),be=bn(i,1,u.zoom);if(l.polygonIntersectsBox(w,0,0,l.EXTENT,l.EXTENT))return{queryGeometry:this,tilespaceGeometry:Z,tilespaceRays:he,bufferedTilespaceGeometry:w,bufferedTilespaceBounds:(Ce=l.getBounds(w),Ce.min.x=l.clamp(Ce.min.x,0,l.EXTENT),Ce.min.y=l.clamp(Ce.min.y,0,l.EXTENT),Ce.max.x=l.clamp(Ce.max.x,0,l.EXTENT),Ce.max.y=l.clamp(Ce.max.y,0,l.EXTENT),Ce),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:be};var Ce}_bufferedScreenMercator(i,u){const m=Bt(i);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{const b=this.bufferedScreenGeometry(i).map(w=>u.pointCoordinate3D(w));return this._screenRaycastCache[m]=b,b}}_bufferedCameraMercator(i,u){const m=Bt(i);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{const b=this.bufferedCameraGeometry(i).map(w=>u.pointCoordinate3D(w));return this._cameraRaycastCache[m]=b,b}}}function Bt(g){return 100*g|0}function Mt(g,i,u){const m=function(b,w){if(b)return u(b);if(w){const k=l.pick(l.extend(w,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(k.vectorLayers=w.vector_layers,k.vectorLayerIds=k.vectorLayers.map(Z=>Z.id)),k.tiles=i.canonicalizeTileset(k,g.url),u(null,k)}};return g.url?l.getJSON(i.transformRequest(i.normalizeSourceURL(g.url),l.ResourceType.Source),m):l.exported.frame(()=>m(null,g))}class Kt{constructor(i,u,m){this.bounds=l.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=u||0,this.maxzoom=m||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const u=Math.pow(2,i.z),m=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*u),b=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*u),w=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*u),k=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*u);return i.x>=m&&i.x<w&&i.y>=b&&i.y<k}}class Ot{constructor(i,u,m){this.context=i;const b=i.gl;this.buffer=b.createBuffer(),this.dynamicDraw=Boolean(m),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),b.bufferData(b.ELEMENT_ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?b.DYNAMIC_DRAW:b.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;this.context.unbindVAO(),this.bind(),u.bufferSubData(u.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Ft={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class ln{constructor(i,u,m,b){this.length=u.length,this.attributes=m,this.itemSize=u.bytesPerElement,this.dynamicDraw=b,this.context=i;const w=i.gl;this.buffer=w.createBuffer(),i.bindVertexBuffer.set(this.buffer),w.bufferData(w.ARRAY_BUFFER,u.arrayBuffer,this.dynamicDraw?w.DYNAMIC_DRAW:w.STATIC_DRAW),this.dynamicDraw||delete u.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const u=this.context.gl;this.bind(),u.bufferSubData(u.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,u){for(let m=0;m<this.attributes.length;m++){const b=u.attributes[this.attributes[m].name];void 0!==b&&i.enableVertexAttribArray(b)}}setVertexAttribPointers(i,u,m){for(let b=0;b<this.attributes.length;b++){const w=this.attributes[b],k=u.attributes[w.name];void 0!==k&&i.vertexAttribPointer(k,w.components,i[Ft[w.type]],!1,this.itemSize,w.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class nn{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class tn extends nn{getDefault(){return l.Color.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class en extends nn{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class yt extends nn{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Xt extends nn{getDefault(){return[!0,!0,!0,!0]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class cn extends nn{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class kn extends nn{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class An extends nn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const u=this.current;(i.func!==u.func||i.ref!==u.ref||i.mask!==u.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class mi extends nn{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class si extends nn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.STENCIL_TEST):u.disable(u.STENCIL_TEST),this.current=i,this.dirty=!1}}class Ki extends nn{getDefault(){return[0,1]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class xi extends nn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.DEPTH_TEST):u.disable(u.DEPTH_TEST),this.current=i,this.dirty=!1}}class Wi extends nn{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Vi extends nn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.BLEND):u.disable(u.BLEND),this.current=i,this.dirty=!1}}class _i extends nn{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class bi extends nn{getDefault(){return l.Color.transparent}set(i){const u=this.current;(i.r!==u.r||i.g!==u.g||i.b!==u.b||i.a!==u.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class xn extends nn{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class rn extends nn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;i?u.enable(u.CULL_FACE):u.disable(u.CULL_FACE),this.current=i,this.dirty=!1}}class ot extends nn{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class ft extends nn{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class pn extends nn{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class _e extends nn{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Ye extends nn{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const u=this.current;(i[0]!==u[0]||i[1]!==u[1]||i[2]!==u[2]||i[3]!==u[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class j extends nn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindFramebuffer(u.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class ye extends nn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindRenderbuffer(u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class We extends nn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindTexture(u.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Tt extends nn{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.bindBuffer(u.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class on extends nn{getDefault(){return null}set(i){const u=this.gl;u.bindBuffer(u.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class qn extends nn{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class ci extends nn{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class ai extends nn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class Un extends nn{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const u=this.gl;u.pixelStorei(u.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class Fi extends nn{constructor(i,u){super(i),this.context=i,this.parent=u}getDefault(){return null}}class Ti extends Fi{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class Yi extends Fi{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const u=this.gl;u.framebufferRenderbuffer(u.FRAMEBUFFER,this.attachment(),u.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class br extends Yi{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ei{constructor(i,u,m,b){this.context=i,this.width=u,this.height=m;const w=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Ti(i,w),b&&(this.depthAttachment=new Yi(i,w))}destroy(){const i=this.context.gl,u=this.colorAttachment.get();if(u&&i.deleteTexture(u),this.depthAttachment){const m=this.depthAttachment.get();m&&i.deleteRenderbuffer(m)}i.deleteFramebuffer(this.framebuffer)}}class wr{constructor(i){this.gl=i,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),this.clearColor=new tn(this),this.clearDepth=new en(this),this.clearStencil=new yt(this),this.colorMask=new Xt(this),this.depthMask=new cn(this),this.stencilMask=new kn(this),this.stencilFunc=new An(this),this.stencilOp=new mi(this),this.stencilTest=new si(this),this.depthRange=new Ki(this),this.depthTest=new xi(this),this.depthFunc=new Wi(this),this.blend=new Vi(this),this.blendFunc=new _i(this),this.blendColor=new bi(this),this.blendEquation=new xn(this),this.cullFace=new rn(this),this.cullFaceSide=new ot(this),this.frontFace=new ft(this),this.program=new pn(this),this.activeTexture=new _e(this),this.viewport=new Ye(this),this.bindFramebuffer=new j(this),this.bindRenderbuffer=new ye(this),this.bindTexture=new We(this),this.bindVertexBuffer=new Tt(this),this.bindElementBuffer=new on(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new qn(this),this.pixelStoreUnpack=new ci(this),this.pixelStoreUnpackPremultiplyAlpha=new ai(this),this.pixelStoreUnpackFlipY=new Un(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extTextureHalfFloat=i.getExtension("OES_texture_half_float"),this.extTextureHalfFloat&&(i.getExtension("OES_texture_half_float_linear"),this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,u){return new Ot(this,i,u)}createVertexBuffer(i,u,m){return new ln(this,i,u,m)}createRenderbuffer(i,u,m){const b=this.gl,w=b.createRenderbuffer();return this.bindRenderbuffer.set(w),b.renderbufferStorage(b.RENDERBUFFER,i,u,m),this.bindRenderbuffer.set(null),w}createFramebuffer(i,u,m){return new Ei(this,i,u,m)}clear({color:i,depth:u,stencil:m}){const b=this.gl;let w=0;i&&(w|=b.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==u&&(w|=b.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(u),this.depthMask.set(!0)),void 0!==m&&(w|=b.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),b.clear(w)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){H(i.blendFunction,l.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class mr extends l.Evented{constructor(i,u,m,b){super(),this.id=i,this.dispatcher=m,this.setEventedParent(b),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},u),l.extend(this,l.pick(u,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Mt(this._options,this.map._requestManager,(i,u)=>{this._tileJSONRequest=null,this._loaded=!0,i?this.fire(new l.ErrorEvent(i)):u&&(l.extend(this,u),u.bounds&&(this.tileBounds=new Kt(u.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(u.tiles),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,u){const m=l.exported.devicePixelRatio>=2,b=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);i.request=l.getImage(this.map._requestManager.transformRequest(b,l.ResourceType.Tile),(w,k,Z,J)=>{if(delete i.request,i.aborted)i.state="unloaded",u(null);else if(w)i.state="errored",u(w);else if(k){this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:Z,expires:J});const se=this.map.painter.context,he=se.gl;i.texture=this.map.painter.getTileTexture(k.width),i.texture?i.texture.update(k,{useMipmap:!0}):(i.texture=new l.Texture(se,k,he.RGBA,{useMipmap:!0}),i.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST),se.extTextureFilterAnisotropic&&he.texParameterf(he.TEXTURE_2D,se.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,se.extTextureFilterAnisotropicMax)),i.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),u(null)}})}abortTile(i,u){i.request&&(i.request.cancel(),delete i.request),u()}unloadTile(i,u){i.texture&&this.map.painter.saveTileTexture(i.texture),u()}hasTransition(){return!1}}let Ji;var hi=l.createLayout([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class re extends l.Evented{constructor(i,u,m,b){super(),this.id=i,this.dispatcher=m,this.coordinates=u.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(b),this.options=u}load(i,u){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(m,b)=>{this._loaded=!0,m?this.fire(new l.ErrorEvent(m)):b&&(this.image=l.exported.getImageData(b),i&&(this.coordinates=i),u&&u(),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this.options.url=i.url,this.load(i.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}setCoordinates(i){this.coordinates=i;const u=i.map(l.MercatorCoordinate.fromLngLat);this.tileID=function(b){let w=1/0,k=1/0,Z=-1/0,J=-1/0;for(const Ce of b)w=Math.min(w,Ce.x),k=Math.min(k,Ce.y),Z=Math.max(Z,Ce.x),J=Math.max(J,Ce.y);const se=Math.max(Z-w,J-k),he=Math.max(0,Math.floor(-Math.log(se)/Math.LN2)),be=Math.pow(2,he);return new l.CanonicalTileID(he,Math.floor((w+Z)/2*be),Math.floor((k+J)/2*be))}(u),this.minzoom=this.maxzoom=this.tileID.z;const m=u.map(b=>this.tileID.getTilePoint(b)._round());return this._boundsArray=new l.StructArrayLayout4i8,this._boundsArray.emplaceBack(m[0].x,m[0].y,0,0),this._boundsArray.emplaceBack(m[1].x,m[1].y,l.EXTENT,0),this._boundsArray.emplaceBack(m[3].x,m[3].y,0,l.EXTENT),this._boundsArray.emplaceBack(m[2].x,m[2].y,l.EXTENT,l.EXTENT),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const i=this.map.painter.context,u=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,hi.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture||(this.texture=new l.Texture(i,this.image,u.RGBA),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE));for(const m in this.tiles){const b=this.tiles[m];"loaded"!==b.state&&(b.state="loaded",b.texture=this.texture)}}loadTile(i,u){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},u(null)):(i.state="errored",u(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const ie={vector:class extends l.Evented{constructor(g,i,u,m){if(super(),this.id=g,this.dispatcher=u,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(i,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},i),this._collectResourceTiming=i.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(m),this._tileWorkers={},this._deduped=new l.DedupedRequest}load(){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=Mt(this._options,this.map._requestManager,(g,i)=>{this._tileJSONRequest=null,this._loaded=!0,g?this.fire(new l.ErrorEvent(g)):i&&(l.extend(this,i),i.bounds&&(this.tileBounds=new Kt(i.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(i.tiles,this.map._requestManager._customAccessToken),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}hasTile(g){return!this.tileBounds||this.tileBounds.contains(g.canonical)}onAdd(g){this.map=g,this.load()}setSourceProperty(g){this._tileJSONRequest&&this._tileJSONRequest.cancel(),g();const i=this.map.style._getSourceCaches(this.id);for(const u of i)u.clearTiles();this.load()}setTiles(g){return this.setSourceProperty(()=>{this._options.tiles=g}),this}setUrl(g){return this.setSourceProperty(()=>{this.url=g,this._options.url=g}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}serialize(){return l.extend({},this._options)}loadTile(g,i){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme)),m={request:this.map._requestManager.transformRequest(u,l.ResourceType.Tile),data:void 0,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,tileSize:this.tileSize*g.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:g.isSymbolTile};if(m.request.collectResourceTiming=this._collectResourceTiming,g.actor&&"expired"!==g.state)"loading"===g.state?g.reloadCallback=i:g.request=g.actor.send("reloadTile",m,b.bind(this));else if(g.actor=this._tileWorkers[u]=this._tileWorkers[u]||this.dispatcher.getActor(),this.dispatcher.ready)g.request=g.actor.send("loadTile",m,b.bind(this),void 0,!0);else{const w=l.loadVectorTile.call({deduped:this._deduped},m,(k,Z)=>{k||!Z?b.call(this,k):(m.data={cacheControl:Z.cacheControl,expires:Z.expires,rawData:Z.rawData.slice(0)},g.actor&&g.actor.send("loadTile",m,b.bind(this),void 0,!0))},!0);g.request={cancel:w}}function b(w,k){return delete g.request,g.aborted?i(null):w&&404!==w.status?i(w):(k&&k.resourceTiming&&(g.resourceTiming=k.resourceTiming),this.map._refreshExpiredTiles&&k&&g.setExpiryData(k),g.loadVectorData(k,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),i(null),void(g.reloadCallback&&(this.loadTile(g,g.reloadCallback),g.reloadCallback=null)))}}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.actor&&g.actor.send("abortTile",{uid:g.uid,type:this.type,source:this.id})}unloadTile(g){g.unloadVectorData(),g.actor&&g.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}},raster:mr,"raster-dem":class extends mr{constructor(g,i,u,m){super(g,i,u,m),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(g,i){const u=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(b,w){b&&(g.state="errored",i(b)),w&&(g.dem=w,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",i(null))}g.request=l.getImage(this.map._requestManager.transformRequest(u,l.ResourceType.Tile),function(b,w,k,Z){if(delete g.request,g.aborted)g.state="unloaded",i(null);else if(b)g.state="errored",i(b);else if(w){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:k,expires:Z});const J=l.window.ImageBitmap&&w instanceof l.window.ImageBitmap&&(null==Ji&&(Ji=l.window.OffscreenCanvas&&new l.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof l.window.createImageBitmap),Ji),se=1-(w.width-l.prevPowerOfTwo(w.width))/2;se<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const he=J?w:l.exported.getImageData(w,se),be={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:he,encoding:this.encoding,padding:se};g.actor&&"expired"!==g.state||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",be,m.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(g){const i=g.canonical,u=Math.pow(2,i.z),m=(i.x-1+u)%u,b=0===i.x?g.wrap-1:g.wrap,w=(i.x+1+u)%u,k=i.x+1===u?g.wrap+1:g.wrap,Z={};return Z[new l.OverscaledTileID(g.overscaledZ,b,i.z,m,i.y).key]={backfilled:!1},Z[new l.OverscaledTileID(g.overscaledZ,k,i.z,w,i.y).key]={backfilled:!1},i.y>0&&(Z[new l.OverscaledTileID(g.overscaledZ,b,i.z,m,i.y-1).key]={backfilled:!1},Z[new l.OverscaledTileID(g.overscaledZ,g.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},Z[new l.OverscaledTileID(g.overscaledZ,k,i.z,w,i.y-1).key]={backfilled:!1}),i.y+1<u&&(Z[new l.OverscaledTileID(g.overscaledZ,b,i.z,m,i.y+1).key]={backfilled:!1},Z[new l.OverscaledTileID(g.overscaledZ,g.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},Z[new l.OverscaledTileID(g.overscaledZ,k,i.z,w,i.y+1).key]={backfilled:!1}),Z}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends l.Evented{constructor(g,i,u,m){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=u.getActor(),this.setEventedParent(m),this._data=i.data,this._options=l.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const b=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*b,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*b,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:l.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*b,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},i),this}getClusterChildren(g,i){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},i),this}getClusterLeaves(g,i,u,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:i,offset:u},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new l.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=l.extend({},this.workerOptions),i=this._data;"string"==typeof i?(g.request=this.map._requestManager.transformRequest(l.exported.resolveURL(i),l.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,(u,m)=>{if(this._loaded=!0,this._pendingLoad=null,u)this.fire(new l.ErrorEvent(u));else{const b={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(b.resourceTiming=m.resourceTiming[this.id]),this.fire(new l.Event("data",b)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(g,i){const u=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(u,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,b)=>(delete g.request,g.unloadVectorData(),g.aborted?i(null):m?i(m):(g.loadVectorData(b,this.map.painter,"reloadTile"===u),i(null))),void 0,"loadTile"===u)}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends re{constructor(g,i,u,m){super(g,i,u,m),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const i of g.urls)this.urls.push(this.map._requestManager.transformRequest(i,l.ResourceType.Source).url);l.getVideo(this.urls,(i,u)=>{this._loaded=!0,i?this.fire(new l.ErrorEvent(i)):u&&(this.video=u,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const i=this.video.seekable;g<i.start(0)||g>i.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const g=this.map.painter.context,i=g.gl;this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,hi.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(g,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE));for(const u in this.tiles){const m=this.tiles[u];"loaded"!==m.state&&(m.state="loaded",m.texture=this.texture)}}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:re,canvas:class extends re{constructor(g,i,u,m){super(g,i,u,m),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(b=>!Array.isArray(b)||2!==b.length||b.some(w=>"number"!=typeof w))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context,u=i.gl;this.boundsBuffer||(this.boundsBuffer=i.createVertexBuffer(this._boundsArray,hi.members)),this.boundsSegments||(this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)),this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(i,this.canvas,u.RGBA,{premultiply:!0});for(const m in this.tiles){const b=this.tiles[m];"loaded"!==b.state&&(b.state="loaded",b.texture=this.texture)}}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}}},V=function(g,i,u,m){const b=new ie[i.type](g,i,u,m);if(b.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${b.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],b),b};function pe(g,i){const u=l.identity([]);return l.scale$1(u,u,[.5*g.width,.5*-g.height,1]),l.translate(u,u,[1,-1,0]),l.multiply(u,u,g.calculateProjMatrix(i.toUnwrapped()))}function De(g,i,u,m,b,w,k,Z=!1){const J=g.tilesIn(m,k,Z);J.sort(vt);const se=[];for(const be of J)se.push({wrappedTileID:be.tile.tileID.wrapped().key,queryResults:be.tile.queryRenderedFeatures(i,u,g._state,be,b,w,pe(g.transform,be.tile.tileID),Z)});const he=function(be){const Ce={},Me={};for(const Ve of be){const qe=Ve.queryResults,ht=Ve.wrappedTileID,Be=Me[ht]=Me[ht]||{};for(const Je in qe){const dt=qe[Je],_t=Be[Je]=Be[Je]||{},wt=Ce[Je]=Ce[Je]||[];for(const nt of dt)_t[nt.featureIndex]||(_t[nt.featureIndex]=!0,wt.push(nt))}}return Ce}(se);for(const be in he)he[be].forEach(Ce=>{const Me=Ce.feature,Ve=g.getFeatureState(Me.layer["source-layer"],Me.id);Me.source=Me.layer.source,Me.layer["source-layer"]&&(Me.sourceLayer=Me.layer["source-layer"]),Me.state=Ve});return he}function $e(g,i){const u=g.getRenderableIds().map(w=>g.getTileByID(w)),m=[],b={};for(let w=0;w<u.length;w++){const k=u[w],Z=k.tileID.canonical.key;b[Z]||(b[Z]=!0,k.querySourceFeatures(m,i))}return m}function vt(g,i){const u=g.tileID,m=i.tileID;return u.overscaledZ-m.overscaledZ||u.canonical.y-m.canonical.y||u.wrap-m.wrap||u.canonical.x-m.canonical.x}function Ct(){return null!=Cc.workerClass?new Cc.workerClass:new l.window.Worker(Cc.workerUrl)}const lt="mapboxgl_preloaded_worker_pool";class Dt{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<Dt.workerCount;)this.workers.push(new Ct);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(u=>{u.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[lt]}numActive(){return Object.keys(this.active).length}}let Ht;function Zt(){return Ht||(Ht=new Dt),Ht}function un(g,i){const u={};for(const m in g)"ref"!==m&&(u[m]=g[m]);return l.refProperties.forEach(m=>{m in i&&(u[m]=i[m])}),u}function On(g){g=g.slice();const i=Object.create(null);for(let u=0;u<g.length;u++)i[g[u].id]=g[u];for(let u=0;u<g.length;u++)"ref"in g[u]&&(g[u]=un(g[u],i[g[u].ref]));return g}Dt.workerCount=2;const at={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog"};function Yt(g,i,u){u.push({command:at.addSource,args:[g,i[g]]})}function ii(g,i,u){i.push({command:at.removeSource,args:[g]}),u[g]=!0}function Qn(g,i,u,m){ii(g,u,m),Yt(g,i,u)}function ei(g,i,u){let m;for(m in g[u])if(g[u].hasOwnProperty(m)&&"data"!==m&&!H(g[u][m],i[u][m]))return!1;for(m in i[u])if(i[u].hasOwnProperty(m)&&"data"!==m&&!H(g[u][m],i[u][m]))return!1;return!0}function yi(g,i,u,m,b,w){let k;for(k in i=i||{},g=g||{})g.hasOwnProperty(k)&&(H(g[k],i[k])||u.push({command:w,args:[m,k,i[k],b]}));for(k in i)i.hasOwnProperty(k)&&!g.hasOwnProperty(k)&&(H(g[k],i[k])||u.push({command:w,args:[m,k,i[k],b]}))}function Yn(g){return g.id}function oi(g,i){return g[i.id]=i,g}class En{constructor(i,u){this.reset(i,u)}reset(i,u){this.points=i||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(u||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=l.clamp(i,0,1);let u=1,m=this._distances[u];const b=i*this.paddedLength+this.padding;for(;m<b&&u<this._distances.length;)m=this._distances[++u];const w=u-1,k=this._distances[w],Z=m-k,J=Z>0?(b-k)/Z:0;return this.points[w].mult(1-J).add(this.points[u].mult(J))}}class zt{constructor(i,u,m){const b=this.boxCells=[],w=this.circleCells=[];this.xCellCount=Math.ceil(i/m),this.yCellCount=Math.ceil(u/m);for(let k=0;k<this.xCellCount*this.yCellCount;k++)b.push([]),w.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=u,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/u,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,u,m,b,w){this._forEachCell(u,m,b,w,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(u),this.bboxes.push(m),this.bboxes.push(b),this.bboxes.push(w)}insertCircle(i,u,m,b){this._forEachCell(u-b,m-b,u+b,m+b,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(u),this.circles.push(m),this.circles.push(b)}_insertBoxCell(i,u,m,b,w,k){this.boxCells[w].push(k)}_insertCircleCell(i,u,m,b,w,k){this.circleCells[w].push(k)}_query(i,u,m,b,w,k){if(m<0||i>this.width||b<0||u>this.height)return!w&&[];const Z=[];if(i<=0&&u<=0&&this.width<=m&&this.height<=b){if(w)return!0;for(let J=0;J<this.boxKeys.length;J++)Z.push({key:this.boxKeys[J],x1:this.bboxes[4*J],y1:this.bboxes[4*J+1],x2:this.bboxes[4*J+2],y2:this.bboxes[4*J+3]});for(let J=0;J<this.circleKeys.length;J++){const se=this.circles[3*J],he=this.circles[3*J+1],be=this.circles[3*J+2];Z.push({key:this.circleKeys[J],x1:se-be,y1:he-be,x2:se+be,y2:he+be})}return k?Z.filter(k):Z}return this._forEachCell(i,u,m,b,this._queryCell,Z,{hitTest:w,seenUids:{box:{},circle:{}}},k),w?Z.length>0:Z}_queryCircle(i,u,m,b,w){const k=i-m,Z=i+m,J=u-m,se=u+m;if(Z<0||k>this.width||se<0||J>this.height)return!b&&[];const he=[];return this._forEachCell(k,J,Z,se,this._queryCellCircle,he,{hitTest:b,circle:{x:i,y:u,radius:m},seenUids:{box:{},circle:{}}},w),b?he.length>0:he}query(i,u,m,b,w){return this._query(i,u,m,b,!1,w)}hitTest(i,u,m,b,w){return this._query(i,u,m,b,!0,w)}hitTestCircle(i,u,m,b){return this._queryCircle(i,u,m,!0,b)}_queryCell(i,u,m,b,w,k,Z,J){const se=Z.seenUids,he=this.boxCells[w];if(null!==he){const Ce=this.bboxes;for(const Me of he)if(!se.box[Me]){se.box[Me]=!0;const Ve=4*Me;if(i<=Ce[Ve+2]&&u<=Ce[Ve+3]&&m>=Ce[Ve+0]&&b>=Ce[Ve+1]&&(!J||J(this.boxKeys[Me]))){if(Z.hitTest)return k.push(!0),!0;k.push({key:this.boxKeys[Me],x1:Ce[Ve],y1:Ce[Ve+1],x2:Ce[Ve+2],y2:Ce[Ve+3]})}}}const be=this.circleCells[w];if(null!==be){const Ce=this.circles;for(const Me of be)if(!se.circle[Me]){se.circle[Me]=!0;const Ve=3*Me;if(this._circleAndRectCollide(Ce[Ve],Ce[Ve+1],Ce[Ve+2],i,u,m,b)&&(!J||J(this.circleKeys[Me]))){if(Z.hitTest)return k.push(!0),!0;{const qe=Ce[Ve],ht=Ce[Ve+1],Be=Ce[Ve+2];k.push({key:this.circleKeys[Me],x1:qe-Be,y1:ht-Be,x2:qe+Be,y2:ht+Be})}}}}}_queryCellCircle(i,u,m,b,w,k,Z,J){const se=Z.circle,he=Z.seenUids,be=this.boxCells[w];if(null!==be){const Me=this.bboxes;for(const Ve of be)if(!he.box[Ve]){he.box[Ve]=!0;const qe=4*Ve;if(this._circleAndRectCollide(se.x,se.y,se.radius,Me[qe+0],Me[qe+1],Me[qe+2],Me[qe+3])&&(!J||J(this.boxKeys[Ve])))return k.push(!0),!0}}const Ce=this.circleCells[w];if(null!==Ce){const Me=this.circles;for(const Ve of Ce)if(!he.circle[Ve]){he.circle[Ve]=!0;const qe=3*Ve;if(this._circlesCollide(Me[qe],Me[qe+1],Me[qe+2],se.x,se.y,se.radius)&&(!J||J(this.circleKeys[Ve])))return k.push(!0),!0}}}_forEachCell(i,u,m,b,w,k,Z,J){const se=this._convertToXCellCoord(i),he=this._convertToYCellCoord(u),be=this._convertToXCellCoord(m),Ce=this._convertToYCellCoord(b);for(let Me=se;Me<=be;Me++)for(let Ve=he;Ve<=Ce;Ve++)if(w.call(this,i,u,m,b,this.xCellCount*Ve+Me,k,Z,J))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,u,m,b,w,k){const Z=b-i,J=w-u,se=m+k;return se*se>Z*Z+J*J}_circleAndRectCollide(i,u,m,b,w,k,Z){const J=(k-b)/2,se=Math.abs(i-(b+J));if(se>J+m)return!1;const he=(Z-w)/2,be=Math.abs(u-(w+he));if(be>he+m)return!1;if(se<=J||be<=he)return!0;const Ce=se-J,Me=be-he;return Ce*Ce+Me*Me<=m*m}}const Zn=Math.tan(85*Math.PI/180);function ti(g,i,u,m,b){const w=l.create$1();return i?(l.scale$1(w,w,[1/b,1/b,1]),u||l.rotateZ(w,w,m.angle)):l.multiply(w,m.labelPlaneMatrix,g),w}function li(g,i,u,m,b){if(i){const w=l.clone$1(g);return l.scale$1(w,w,[b,b,1]),u||l.rotateZ(w,w,-m.angle),w}return m.glCoordMatrix}function Ci(g,i,u=0){const m=[g.x,g.y,u,1];u?l.transformMat4(m,m,i):xe(m,m,i);const b=m[3];return{point:new l.pointGeometry(m[0]/b,m[1]/b),signedDistanceFromCamera:b}}function ui(g,i){return Math.min(.5+g/i*.5,1.5)}function Ii(g,i){const u=g[0]/g[3],m=g[1]/g[3];return u>=-i[0]&&u<=i[0]&&m>=-i[1]&&m<=i[1]}function to(g,i,u,m,b,w,k,Z,J){const se=m?g.textSizeData:g.iconSizeData,he=l.evaluateSizeForZoom(se,u.transform.zoom),be=[256/u.width*2+1,256/u.height*2+1],Ce=m?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;Ce.clear();const Me=g.lineVertexArray,Ve=m?g.text.placedSymbolArray:g.icon.placedSymbolArray,qe=u.transform.width/u.transform.height;let ht=!1;for(let Be=0;Be<Ve.length;Be++){const Je=Ve.get(Be);if(Je.writingMode!==l.WritingMode.vertical||ht||0!==Be&&Ve.get(Be-1).writingMode===l.WritingMode.horizontal||(ht=!0),Je.hidden||Je.writingMode===l.WritingMode.vertical&&!ht){Ee(Je.numGlyphs,Ce);continue}ht=!1;const dt=new l.pointGeometry(Je.tileAnchorX,Je.tileAnchorY),_t=J?J(dt):0,wt=[dt.x,dt.y,_t],nt=[...wt,1];if(l.transformMat4(nt,nt,i),!Ii(nt,be)){Ee(Je.numGlyphs,Ce);continue}const Pt=ui(u.transform.cameraToCenterDistance,nt[3]),dn=l.evaluateSizeForFeature(se,he,Je),wn=k?dn/Pt:dn*Pt,Rt=Ci(new l.pointGeometry(wt[0],wt[1]),b,wt[2]);if(Rt.signedDistanceFromCamera<=0){Ee(Je.numGlyphs,Ce);continue}let sn={};const $n=k?null:J,Kn=$i(Je,wn,!1,Z,i,b,w,g.glyphOffsetArray,Me,Ce,Rt.point,dt,sn,qe,$n);ht=Kn.useVertical,$n&&Kn.needsFlipping&&(sn={}),(Kn.notEnoughRoom||ht||Kn.needsFlipping&&$i(Je,wn,!0,Z,i,b,w,g.glyphOffsetArray,Me,Ce,Rt.point,dt,sn,qe,$n).notEnoughRoom)&&Ee(Je.numGlyphs,Ce)}m?g.text.dynamicLayoutVertexBuffer.updateData(Ce):g.icon.dynamicLayoutVertexBuffer.updateData(Ce)}function Or(g,i,u,m,b,w,k,Z,J,se,he,be,Ce){const Me=Z.glyphStartIndex+Z.numGlyphs,Ve=Z.lineStartIndex,qe=Z.lineStartIndex+Z.lineLength,ht=i.getoffsetX(Z.glyphStartIndex),Be=i.getoffsetX(Me-1),Je=Nr(g*ht,u,m,b,w,k,Z.segment,Ve,qe,J,se,he,be,Ce,!0);if(!Je)return null;const dt=Nr(g*Be,u,m,b,w,k,Z.segment,Ve,qe,J,se,he,be,Ce,!0);return dt?{first:Je,last:dt}:null}function jn(g,i,u,m){return g.writingMode===l.WritingMode.horizontal&&Math.abs(u.y-i.y)>Math.abs(u.x-i.x)*m?{useVertical:!0}:g.writingMode===l.WritingMode.vertical?i.y<u.y?{needsFlipping:!0}:null:0!==g.flipState&&function(b,w,k){const Z=(w.x-b.x)*k;return 0===Z||Math.abs((w.y-b.y)/Z)>Zn}(i,u,m)?1===g.flipState?{needsFlipping:!0}:null:i.x>u.x?{needsFlipping:!0}:null}function $i(g,i,u,m,b,w,k,Z,J,se,he,be,Ce,Me,Ve){const qe=i/24,ht=g.lineOffsetX*qe,Be=g.lineOffsetY*qe;let Je;if(g.numGlyphs>1){const dt=g.glyphStartIndex+g.numGlyphs,_t=g.lineStartIndex,wt=g.lineStartIndex+g.lineLength,nt=Or(qe,Z,ht,Be,u,he,be,g,J,w,Ce,Ve,!1);if(!nt)return{notEnoughRoom:!0};const Pt=Ci(nt.first.point,k).point,dn=Ci(nt.last.point,k).point;if(m&&!u){const wn=jn(g,Pt,dn,Me);if(g.flipState=wn&&wn.needsFlipping?1:2,wn)return wn}Je=[nt.first];for(let wn=g.glyphStartIndex+1;wn<dt-1;wn++)Je.push(Nr(qe*Z.getoffsetX(wn),ht,Be,u,he,be,g.segment,_t,wt,J,w,Ce,Ve,!1,!1));Je.push(nt.last)}else{if(m&&!u){const _t=Ci(be,b).point,wt=g.lineStartIndex+g.segment+1,nt=new l.pointGeometry(J.getx(wt),J.gety(wt)),Pt=Ci(nt,b),dn=jn(g,_t,Pt.signedDistanceFromCamera>0?Pt.point:Ir(be,nt,_t,1,b,void 0),Me);if(g.flipState=dn&&dn.needsFlipping?1:2,dn)return dn}const dt=Nr(qe*Z.getoffsetX(g.glyphStartIndex),ht,Be,u,he,be,g.segment,g.lineStartIndex,g.lineStartIndex+g.lineLength,J,w,Ce,Ve,!1,!1);if(!dt)return{notEnoughRoom:!0};Je=[dt]}for(const dt of Je)l.addDynamicAttributes(se,dt.point,dt.angle);return{}}function Fr(g,i,u){const m={x:g.x,y:g.y,z:0};if(!u)return Ci(m,i,m.z);const b=u(g);return Ci(new l.pointGeometry(m.x,m.y),i,m.z+b)}function Ir(g,i,u,m,b,w){const k=Fr(g.add(g.sub(i)._unit()),b,w).point,Z=u.sub(k);return u.add(Z._mult(m/Z.mag()))}function Nr(g,i,u,m,b,w,k,Z,J,se,he,be,Ce,Me,Ve){const qe=m?g-i:g+i;let ht=qe>0?1:-1,Be=0;m&&(ht*=-1,Be=Math.PI),ht<0&&(Be+=Math.PI);let Je=ht>0?Z+k:Z+k+1,dt=b,_t=b,wt=0,nt=0;const Pt=Math.abs(qe),dn=[],wn=[];let Rt=w;const sn=()=>{const qi=Je-ht;return 0===wt?w:new l.pointGeometry(se.getx(qi),se.gety(qi))},$n=()=>Ir(sn(),Rt,_t,Pt-wt+1,he,Ce);for(;wt+nt<=Pt;){if(Je+=ht,Je<Z||Je>=J)return null;if(_t=dt,dn.push(dt),Me&&wn.push(Rt||sn()),dt=be[Je],void 0===dt){Rt=new l.pointGeometry(se.getx(Je),se.gety(Je));const qi=Fr(Rt,he,Ce);dt=qi.signedDistanceFromCamera>0?be[Je]=qi.point:$n()}else Rt=null;wt+=nt,nt=_t.dist(dt)}Ve&&Ce&&(Rt=Rt||new l.pointGeometry(se.getx(Je),se.gety(Je)),be[Je]=dt=void 0===be[Je]?dt:$n(),nt=_t.dist(dt));const Kn=(Pt-wt)/nt,Gn=dt.sub(_t),Pn=Gn.mult(Kn)._add(_t);u&&Pn._add(Gn._unit()._perp()._mult(u*ht));const Xn=Be+Math.atan2(dt.y-_t.y,dt.x-_t.x);return dn.push(Pn),Me&&(Rt=Rt||new l.pointGeometry(se.getx(Je),se.gety(Je)),wn.push(function(qi,Li,Hr){const $r=1-Hr;return new l.pointGeometry(qi.x*$r+Li.x*Hr,qi.y*$r+Li.y*Hr)}(wn.length>0?wn[wn.length-1]:Rt,Rt,Kn))),{point:Pn,angle:Xn,path:dn,tilePath:wn}}const _r=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function Ee(g,i){for(let u=0;u<g;u++){const m=i.length;i.resize(m+4),i.float32.set(_r,3*m)}}function xe(g,i,u){const m=i[0],b=i[1];return g[0]=u[0]*m+u[4]*b+u[12],g[1]=u[1]*m+u[5]*b+u[13],g[3]=u[3]*m+u[7]*b+u[15],g}const Le=100;class Ke{constructor(i,u,m=new zt(i.width+200,i.height+200,25),b=new zt(i.width+200,i.height+200,25)){this.transform=i,this.grid=m,this.ignoredGrid=b,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Le,this.screenBottomBoundary=i.height+Le,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=u}placeCollisionBox(i,u,m,b,w,k,Z){let J=u.projectedAnchorZ;u.elevation&&(J+=u.elevation);const se=this.projectAndGetPerspectiveRatio(k,u.projectedAnchorX,u.projectedAnchorY,J,u.tileID),he=w*se.perspectiveRatio,be=(u.x1*i+m.x-u.padding)*he+se.point.x,Ce=(u.y1*i+m.y-u.padding)*he+se.point.y,Me=(u.x2*i+m.x+u.padding)*he+se.point.x,Ve=(u.y2*i+m.y+u.padding)*he+se.point.y,qe=se.perspectiveRatio<=.55||se.aboveHorizon;return!this.isInsideGrid(be,Ce,Me,Ve)||!b&&this.grid.hitTest(be,Ce,Me,Ve,Z)||qe?{box:[],offscreen:!1}:{box:[be,Ce,Me,Ve],offscreen:this.isOffscreen(be,Ce,Me,Ve)}}placeCollisionCircles(i,u,m,b,w,k,Z,J,se,he,be,Ce,Me,Ve){const qe=[],ht=this.transform.elevation,Be=ht?$n=>ht.getAtTileOffset(Ve,$n.x,$n.y):$n=>0,Je=new l.pointGeometry(u.tileAnchorX,u.tileAnchorY),dt=Be(Je),_t=this.projectAndGetPerspectiveRatio(k,Je.x,Je.y,dt,Ve),{perspectiveRatio:wt}=_t,nt=(he?w/wt:w*wt)/l.ONE_EM,Pt=Ci(Je,Z,dt).point,dn=_t.signedDistanceFromCamera>0?Or(nt,b,u.lineOffsetX*nt,u.lineOffsetY*nt,!1,Pt,Je,u,m,Z,{},ht&&!he?Be:null,he&&!!ht):null;let wn=!1,Rt=!1,sn=!0;if(dn&&!_t.aboveHorizon){const $n=.5*Ce*wt+Me,Kn=new l.pointGeometry(-100,-100),Gn=new l.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),Pn=new En,Xn=dn.first,qi=dn.last;let Li=[];for(let ki=Xn.path.length-1;ki>=1;ki--)Li.push(Xn.path[ki]);for(let ki=1;ki<qi.path.length;ki++)Li.push(qi.path[ki]);const Hr=2.5*$n;if(J){const ki=Li.map(ht?(Qi,Qr)=>{const Ys=Be(Qr<Xn.path.length-1?Xn.tilePath[Xn.path.length-1-Qr]:qi.tilePath[Qr-Xn.path.length+2]);return Ci(Qi,J,Ys)}:Qi=>Ci(Qi,J));Li=ki.some(Qi=>Qi.signedDistanceFromCamera<=0)?[]:ki.map(Qi=>Qi.point)}let $r=[];if(Li.length>0){const ki=Li[0].clone(),Qi=Li[0].clone();for(let Qr=1;Qr<Li.length;Qr++)ki.x=Math.min(ki.x,Li[Qr].x),ki.y=Math.min(ki.y,Li[Qr].y),Qi.x=Math.max(Qi.x,Li[Qr].x),Qi.y=Math.max(Qi.y,Li[Qr].y);$r=ki.x>=Kn.x&&Qi.x<=Gn.x&&ki.y>=Kn.y&&Qi.y<=Gn.y?[Li]:Qi.x<Kn.x||ki.x>Gn.x||Qi.y<Kn.y||ki.y>Gn.y?[]:l.clipLine([Li],Kn.x,Kn.y,Gn.x,Gn.y)}for(const ki of $r){Pn.reset(ki,.25*$n);let Qi=0;Qi=Pn.length<=.5*$n?1:Math.ceil(Pn.paddedLength/Hr)+1;for(let Qr=0;Qr<Qi;Qr++){const Ys=Qr/Math.max(Qi-1,1),Js=Pn.lerp(Ys),zo=Js.x+Le,Uo=Js.y+Le;qe.push(zo,Uo,$n,0);const ds=zo-$n,Ba=Uo-$n,Zi=zo+$n,eo=Uo+$n;if(sn=sn&&this.isOffscreen(ds,Ba,Zi,eo),Rt=Rt||this.isInsideGrid(ds,Ba,Zi,eo),!i&&this.grid.hitTestCircle(zo,Uo,$n,be)&&(wn=!0,!se))return{circles:[],offscreen:!1,collisionDetected:wn}}}}return{circles:!se&&wn||!Rt?[]:qe,offscreen:sn,collisionDetected:wn}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const u=[];let m=1/0,b=1/0,w=-1/0,k=-1/0;for(const he of i){const be=new l.pointGeometry(he.x+Le,he.y+Le);m=Math.min(m,be.x),b=Math.min(b,be.y),w=Math.max(w,be.x),k=Math.max(k,be.y),u.push(be)}const Z=this.grid.query(m,b,w,k).concat(this.ignoredGrid.query(m,b,w,k)),J={},se={};for(const he of Z){const be=he.key;if(void 0===J[be.bucketInstanceId]&&(J[be.bucketInstanceId]={}),J[be.bucketInstanceId][be.featureIndex])continue;const Ce=[new l.pointGeometry(he.x1,he.y1),new l.pointGeometry(he.x2,he.y1),new l.pointGeometry(he.x2,he.y2),new l.pointGeometry(he.x1,he.y2)];l.polygonIntersectsPolygon(u,Ce)&&(J[be.bucketInstanceId][be.featureIndex]=!0,void 0===se[be.bucketInstanceId]&&(se[be.bucketInstanceId]=[]),se[be.bucketInstanceId].push(be.featureIndex))}return se}insertCollisionBox(i,u,m,b,w){(u?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:b,collisionGroupID:w},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,u,m,b,w){const k=u?this.ignoredGrid:this.grid,Z={bucketInstanceId:m,featureIndex:b,collisionGroupID:w};for(let J=0;J<i.length;J+=4)k.insertCircle(Z,i[J],i[J+1],i[J+2])}projectAndGetPerspectiveRatio(i,u,m,b,w){const k=[u,m,b||0,1];let Z=!1;if(b||this.transform.pitch>0){l.transformMat4(k,k,i);let J=!1;this.fogState&&w&&(J=function(se,he,be,Ce,Me,Ve){const qe=Ve.calculateFogTileMatrix(Me),ht=[he,be,Ce];return l.transformMat4$1(ht,ht,qe),ct(se,ht,Ve.pitch,Ve._fov)}(this.fogState,u,m,b||0,w.toUnwrapped(),this.transform)>.9),Z=k[2]>k[3]||J}else xe(k,k,i);return{point:new l.pointGeometry((k[0]/k[3]+1)/2*this.transform.width+Le,(-k[1]/k[3]+1)/2*this.transform.height+Le),perspectiveRatio:Math.min(.5+this.transform.cameraToCenterDistance/k[3]*.5,1.5),signedDistanceFromCamera:k[3],aboveHorizon:Z}}isOffscreen(i,u,m,b){return m<Le||i>=this.screenRightBoundary||b<Le||u>this.screenBottomBoundary}isInsideGrid(i,u,m,b){return m>=0&&i<this.gridRightBoundary&&b>=0&&u<this.gridBottomBoundary}getViewportMatrix(){const i=l.identity([]);return l.translate(i,i,[-100,-100,0]),i}}class $t{constructor(i,u,m,b){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?u:-u))):b&&m?1:0,this.placed=m}isHidden(){return 0===this.opacity&&!this.placed}}class Et{constructor(i,u,m,b,w){this.text=new $t(i?i.text:null,u,m,w),this.icon=new $t(i?i.icon:null,u,b,w)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qt{constructor(i,u,m){this.text=i,this.icon=u,this.skipFade=m}}class mn{constructor(){this.invProjMatrix=l.create$1(),this.viewportMatrix=l.create$1(),this.circles=[]}}class hn{constructor(i,u,m,b,w){this.bucketInstanceId=i,this.featureIndex=u,this.sourceLayerIndex=m,this.bucketIndex=b,this.tileID=w}}class fn{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const u=++this.maxGroupID;this.collisionGroups[i]={ID:u,predicate:m=>m.collisionGroupID===u}}return this.collisionGroups[i]}}function Vn(g,i,u,m,b){const{horizontalAlign:w,verticalAlign:k}=l.getAnchorAlignment(g),Z=-(w-.5)*i,J=-(k-.5)*u,se=l.evaluateVariableOffset(g,m);return new l.pointGeometry(Z+se[0]*b,J+se[1]*b)}function Fn(g,i,u,m,b){const w=new l.pointGeometry(g,i);return u&&w._rotate(m?b:-b),w}class pi{constructor(i,u,m,b,w){this.transform=i.clone(),this.collisionIndex=new Ke(this.transform,w),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=u,this.retainedQueryData={},this.collisionGroups=new fn(m),this.collisionCircleArrays={},this.prevPlacement=b,b&&(b.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,u,m,b){const w=m.getBucket(u),k=m.latestFeatureIndex;if(!w||!k||u.id!==w.layerIds[0])return;const Z=m.collisionBoxArray,J=w.layers[0].layout,se=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),he=m.tileSize/l.EXTENT,be=this.transform.calculateProjMatrix(m.tileID.toUnwrapped()),Ce="map"===J.get("text-pitch-alignment"),Me="map"===J.get("text-rotation-alignment"),Ve=bn(m,1,this.transform.zoom),qe=ti(be,Ce,Me,this.transform,Ve);let ht=null;if(Ce){const Je=li(be,Ce,Me,this.transform,Ve);ht=l.multiply([],this.transform.labelPlaneMatrix,Je)}this.retainedQueryData[w.bucketInstanceId]=new hn(w.bucketInstanceId,k,w.sourceLayerIndex,w.index,m.tileID);const Be={bucket:w,layout:J,posMatrix:be,textLabelPlaneMatrix:qe,labelToScreenMatrix:ht,scale:se,textPixelRatio:he,holdingForFade:m.holdingForFade(),collisionBoxArray:Z,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(w.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:l.evaluateSizeForZoom(w.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(w.sourceID)};if(b)for(const Je of w.sortKeyRanges){const{sortKey:dt,symbolInstanceStart:_t,symbolInstanceEnd:wt}=Je;i.push({sortKey:dt,symbolInstanceStart:_t,symbolInstanceEnd:wt,parameters:Be})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:w.symbolInstances.length,parameters:Be})}attemptAnchorPlacement(i,u,m,b,w,k,Z,J,se,he,be,Ce,Me,Ve,qe,ht,Be,Je){const dt=[Ce.textOffset0,Ce.textOffset1],_t=Vn(i,m,b,dt,w),wt=this.collisionIndex.placeCollisionBox(w,u,Fn(_t.x,_t.y,k,Z,this.transform.angle),be,J,se,he.predicate);if((!ht||0!==this.collisionIndex.placeCollisionBox(Ve.getSymbolInstanceIconSize(Je,this.transform.zoom,Me),ht,Fn(_t.x,_t.y,k,Z,this.transform.angle),be,J,se,he.predicate).box.length)&&wt.box.length>0){let nt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ce.crossTileID]&&this.prevPlacement.placements[Ce.crossTileID]&&this.prevPlacement.placements[Ce.crossTileID].text&&(nt=this.prevPlacement.variableOffsets[Ce.crossTileID].anchor),this.variableOffsets[Ce.crossTileID]={textOffset:dt,width:m,height:b,anchor:i,textScale:w,prevAnchor:nt},this.markUsedJustification(Ve,i,Ce,qe),Ve.allowVerticalPlacement&&(this.markUsedOrientation(Ve,qe,Ce),this.placedOrientations[Ce.crossTileID]=qe),{shift:_t,placedGlyphBoxes:wt}}}placeLayerBucketPart(i,u,m,b){const{bucket:w,layout:k,posMatrix:Z,textLabelPlaneMatrix:J,labelToScreenMatrix:se,textPixelRatio:he,holdingForFade:be,collisionBoxArray:Ce,partiallyEvaluatedTextSize:Me,partiallyEvaluatedIconSize:Ve,collisionGroup:qe}=i.parameters,ht=k.get("text-optional"),Be=k.get("icon-optional"),Je=k.get("text-allow-overlap"),dt=k.get("icon-allow-overlap"),_t="map"===k.get("text-rotation-alignment"),wt="map"===k.get("text-pitch-alignment"),nt="none"!==k.get("icon-text-fit"),Pt="viewport-y"===k.get("symbol-z-order"),dn=Je&&(dt||!w.hasIconData()||Be),wn=dt&&(Je||!w.hasTextData()||ht);!w.collisionArrays&&Ce&&w.deserializeCollisionBoxes(Ce),m&&b&&w.updateCollisionDebugBuffers(this.transform.zoom,Ce);const Rt=(sn,$n,Kn)=>{if(u[sn.crossTileID])return;if(be)return void(this.placements[sn.crossTileID]=new Qt(!1,!1,!1));let Gn=!1,Pn=!1,Xn=!0,qi=null,Li={box:null,offscreen:null},Hr={box:null,offscreen:null},$r=null,ki=null,Qi=null,Qr=0,Ys=0,Js=0;Kn.textFeatureIndex?Qr=Kn.textFeatureIndex:sn.useRuntimeCollisionCircles&&(Qr=sn.featureIndex),Kn.verticalTextFeatureIndex&&(Ys=Kn.verticalTextFeatureIndex);const zo=Zi=>{Zi.tileID=this.retainedQueryData[w.bucketInstanceId].tileID,(this.transform.elevation||Zi.elevation)&&(Zi.elevation=this.transform.elevation?this.transform.elevation.getAtTileOffset(this.retainedQueryData[w.bucketInstanceId].tileID,Zi.tileAnchorX,Zi.tileAnchorY):0)},Uo=Kn.textBox;if(Uo){zo(Uo);const Zi=Ar=>{let Br=l.WritingMode.horizontal;if(w.allowVerticalPlacement&&!Ar&&this.prevPlacement){const Vo=this.prevPlacement.placedOrientations[sn.crossTileID];Vo&&(this.placedOrientations[sn.crossTileID]=Vo,Br=Vo,this.markUsedOrientation(w,Br,sn))}return Br},eo=(Ar,Br)=>{if(w.allowVerticalPlacement&&sn.numVerticalGlyphVertices>0&&Kn.verticalTextBox){for(const Vo of w.writingModes)if(Vo===l.WritingMode.vertical?(Li=Br(),Hr=Li):Li=Ar(),Li&&Li.box&&Li.box.length)break}else Li=Ar()};if(k.get("text-variable-anchor")){let Ar=k.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[sn.crossTileID]){const Gr=this.prevPlacement.variableOffsets[sn.crossTileID];Ar.indexOf(Gr.anchor)>0&&(Ar=Ar.filter(Zo=>Zo!==Gr.anchor),Ar.unshift(Gr.anchor))}const Br=(Gr,Zo,Bs)=>{const hs=w.getSymbolInstanceTextSize(Me,sn,this.transform.zoom,$n),Ks=(Gr.x2-Gr.x1)*hs+2*Gr.padding,Yl=(Gr.y2-Gr.y1)*hs+2*Gr.padding,ha=nt&&!dt?Zo:null;ha&&zo(ha);let wl={box:[],offscreen:!1};const fu=Je?2*Ar.length:Ar.length;for(let Cl=0;Cl<fu;++Cl){const Tl=this.attemptAnchorPlacement(Ar[Cl%Ar.length],Gr,Ks,Yl,hs,_t,wt,he,Z,qe,Cl>=Ar.length,sn,$n,w,Bs,ha,Me,Ve);if(Tl&&(wl=Tl.placedGlyphBoxes,wl&&wl.box&&wl.box.length)){Gn=!0,qi=Tl.shift;break}}return wl};eo(()=>Br(Uo,Kn.iconBox,l.WritingMode.horizontal),()=>{const Gr=Kn.verticalTextBox;return Gr&&zo(Gr),w.allowVerticalPlacement&&!(Li&&Li.box&&Li.box.length)&&sn.numVerticalGlyphVertices>0&&Gr?Br(Gr,Kn.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null}}),Li&&(Gn=Li.box,Xn=Li.offscreen);const Vo=Zi(Li&&Li.box);if(!Gn&&this.prevPlacement){const Gr=this.prevPlacement.variableOffsets[sn.crossTileID];Gr&&(this.variableOffsets[sn.crossTileID]=Gr,this.markUsedJustification(w,Gr.anchor,sn,Vo))}}else{const Ar=(Br,Vo)=>{const Gr=w.getSymbolInstanceTextSize(Me,sn,this.transform.zoom,$n),Zo=this.collisionIndex.placeCollisionBox(Gr,Br,new l.pointGeometry(0,0),Je,he,Z,qe.predicate);return Zo&&Zo.box&&Zo.box.length&&(this.markUsedOrientation(w,Vo,sn),this.placedOrientations[sn.crossTileID]=Vo),Zo};eo(()=>Ar(Uo,l.WritingMode.horizontal),()=>{const Br=Kn.verticalTextBox;return w.allowVerticalPlacement&&sn.numVerticalGlyphVertices>0&&Br?(zo(Br),Ar(Br,l.WritingMode.vertical)):{box:null,offscreen:null}}),Zi(Li&&Li.box&&Li.box.length)}}if($r=Li,Gn=$r&&$r.box&&$r.box.length>0,Xn=$r&&$r.offscreen,sn.useRuntimeCollisionCircles){const Zi=w.text.placedSymbolArray.get(sn.centerJustifiedTextSymbolIndex>=0?sn.centerJustifiedTextSymbolIndex:sn.verticalPlacedTextSymbolIndex),eo=l.evaluateSizeForFeature(w.textSizeData,Me,Zi),Ar=k.get("text-padding");ki=this.collisionIndex.placeCollisionCircles(Je,Zi,w.lineVertexArray,w.glyphOffsetArray,eo,Z,J,se,m,wt,qe.predicate,sn.collisionCircleDiameter*eo/l.ONE_EM,Ar,this.retainedQueryData[w.bucketInstanceId].tileID),Gn=Je||ki.circles.length>0&&!ki.collisionDetected,Xn=Xn&&ki.offscreen}if(Kn.iconFeatureIndex&&(Js=Kn.iconFeatureIndex),Kn.iconBox){const Zi=eo=>{zo(eo);const Ar=nt&&qi?Fn(qi.x,qi.y,_t,wt,this.transform.angle):new l.pointGeometry(0,0),Br=w.getSymbolInstanceIconSize(Ve,this.transform.zoom,$n);return this.collisionIndex.placeCollisionBox(Br,eo,Ar,dt,he,Z,qe.predicate)};Hr&&Hr.box&&Hr.box.length&&Kn.verticalIconBox?(Qi=Zi(Kn.verticalIconBox),Pn=Qi.box.length>0):(Qi=Zi(Kn.iconBox),Pn=Qi.box.length>0),Xn=Xn&&Qi.offscreen}const ds=ht||0===sn.numHorizontalGlyphVertices&&0===sn.numVerticalGlyphVertices,Ba=Be||0===sn.numIconVertices;if(ds||Ba?Ba?ds||(Pn=Pn&&Gn):Gn=Pn&&Gn:Pn=Gn=Pn&&Gn,Gn&&$r&&$r.box&&this.collisionIndex.insertCollisionBox($r.box,k.get("text-ignore-placement"),w.bucketInstanceId,Hr&&Hr.box&&Ys?Ys:Qr,qe.ID),Pn&&Qi&&this.collisionIndex.insertCollisionBox(Qi.box,k.get("icon-ignore-placement"),w.bucketInstanceId,Js,qe.ID),ki&&(Gn&&this.collisionIndex.insertCollisionCircles(ki.circles,k.get("text-ignore-placement"),w.bucketInstanceId,Qr,qe.ID),m)){const Zi=w.bucketInstanceId;let eo=this.collisionCircleArrays[Zi];void 0===eo&&(eo=this.collisionCircleArrays[Zi]=new mn);for(let Ar=0;Ar<ki.circles.length;Ar+=4)eo.circles.push(ki.circles[Ar+0]),eo.circles.push(ki.circles[Ar+1]),eo.circles.push(ki.circles[Ar+2]),eo.circles.push(ki.collisionDetected?1:0)}this.placements[sn.crossTileID]=new Qt(Gn||dn,Pn||wn,Xn||w.justReloaded),u[sn.crossTileID]=!0};if(Pt){const sn=w.getSortedSymbolIndexes(this.transform.angle);for(let $n=sn.length-1;$n>=0;--$n){const Kn=sn[$n];Rt(w.symbolInstances.get(Kn),Kn,w.collisionArrays[Kn])}}else for(let sn=i.symbolInstanceStart;sn<i.symbolInstanceEnd;sn++)Rt(w.symbolInstances.get(sn),sn,w.collisionArrays[sn]);if(m&&w.bucketInstanceId in this.collisionCircleArrays){const sn=this.collisionCircleArrays[w.bucketInstanceId];l.invert(sn.invProjMatrix,Z),sn.viewportMatrix=this.collisionIndex.getViewportMatrix()}w.justReloaded=!1}markUsedJustification(i,u,m,b){let w;w=b===l.WritingMode.vertical?m.verticalPlacedTextSymbolIndex:{left:m.leftJustifiedTextSymbolIndex,center:m.centerJustifiedTextSymbolIndex,right:m.rightJustifiedTextSymbolIndex}[l.getAnchorJustification(u)];const k=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex,m.verticalPlacedTextSymbolIndex];for(const Z of k)Z>=0&&(i.text.placedSymbolArray.get(Z).crossTileID=w>=0&&Z!==w?0:m.crossTileID)}markUsedOrientation(i,u,m){const b=u===l.WritingMode.horizontal||u===l.WritingMode.horizontalOnly?u:0,w=u===l.WritingMode.vertical?u:0,k=[m.leftJustifiedTextSymbolIndex,m.centerJustifiedTextSymbolIndex,m.rightJustifiedTextSymbolIndex];for(const Z of k)i.text.placedSymbolArray.get(Z).placedOrientation=b;m.verticalPlacedTextSymbolIndex&&(i.text.placedSymbolArray.get(m.verticalPlacedTextSymbolIndex).placedOrientation=w)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const u=this.prevPlacement;let m=!1;this.prevZoomAdjustment=u?u.zoomAdjustment(this.transform.zoom):0;const b=u?u.symbolFadeChange(i):1,w=u?u.opacities:{},k=u?u.variableOffsets:{},Z=u?u.placedOrientations:{};for(const J in this.placements){const se=this.placements[J],he=w[J];he?(this.opacities[J]=new Et(he,b,se.text,se.icon),m=m||se.text!==he.text.placed||se.icon!==he.icon.placed):(this.opacities[J]=new Et(null,b,se.text,se.icon,se.skipFade),m=m||se.text||se.icon)}for(const J in w){const se=w[J];if(!this.opacities[J]){const he=new Et(se,b,!1,!1);he.isHidden()||(this.opacities[J]=he,m=m||se.text.placed||se.icon.placed)}}for(const J in k)this.variableOffsets[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.variableOffsets[J]=k[J]);for(const J in Z)this.placedOrientations[J]||!this.opacities[J]||this.opacities[J].isHidden()||(this.placedOrientations[J]=Z[J]);m?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=u?u.lastPlacementChangeTime:i)}updateLayerOpacities(i,u){const m={};for(const b of u){const w=b.getBucket(i);w&&b.latestFeatureIndex&&i.id===w.layerIds[0]&&this.updateBucketOpacities(w,m,b.collisionBoxArray)}}updateBucketOpacities(i,u,m){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const b=i.layers[0].layout,w=new Et(null,0,!1,!1,!0),k=b.get("text-allow-overlap"),Z=b.get("icon-allow-overlap"),J=b.get("text-variable-anchor"),se="map"===b.get("text-rotation-alignment"),he="map"===b.get("text-pitch-alignment"),be="none"!==b.get("icon-text-fit"),Ce=new Et(null,0,k&&(Z||!i.hasIconData()||b.get("icon-optional")),Z&&(k||!i.hasTextData()||b.get("text-optional")),!0);!i.collisionArrays&&m&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(m);const Me=(Ve,qe,ht)=>{for(let Be=0;Be<qe/4;Be++)Ve.opacityVertexArray.emplaceBack(ht)};for(let Ve=0;Ve<i.symbolInstances.length;Ve++){const qe=i.symbolInstances.get(Ve),{numHorizontalGlyphVertices:ht,numVerticalGlyphVertices:Be,crossTileID:Je}=qe;let dt=this.opacities[Je];u[Je]?dt=w:dt||(dt=Ce,this.opacities[Je]=dt),u[Je]=!0;const _t=qe.numIconVertices>0,wt=this.placedOrientations[qe.crossTileID],nt=wt===l.WritingMode.vertical,Pt=wt===l.WritingMode.horizontal||wt===l.WritingMode.horizontalOnly;if(ht>0||Be>0){const dn=no(dt.text);Me(i.text,ht,nt?io:dn),Me(i.text,Be,Pt?io:dn);const wn=dt.text.isHidden();[qe.rightJustifiedTextSymbolIndex,qe.centerJustifiedTextSymbolIndex,qe.leftJustifiedTextSymbolIndex].forEach($n=>{$n>=0&&(i.text.placedSymbolArray.get($n).hidden=wn||nt?1:0)}),qe.verticalPlacedTextSymbolIndex>=0&&(i.text.placedSymbolArray.get(qe.verticalPlacedTextSymbolIndex).hidden=wn||Pt?1:0);const Rt=this.variableOffsets[qe.crossTileID];Rt&&this.markUsedJustification(i,Rt.anchor,qe,wt);const sn=this.placedOrientations[qe.crossTileID];sn&&(this.markUsedJustification(i,"left",qe,sn),this.markUsedOrientation(i,sn,qe))}if(_t){const dn=no(dt.icon);qe.placedIconSymbolIndex>=0&&(Me(i.icon,qe.numIconVertices,nt?io:dn),i.icon.placedSymbolArray.get(qe.placedIconSymbolIndex).hidden=dt.icon.isHidden()),qe.verticalPlacedIconSymbolIndex>=0&&(Me(i.icon,qe.numVerticalIconVertices,Pt?io:dn),i.icon.placedSymbolArray.get(qe.verticalPlacedIconSymbolIndex).hidden=dt.icon.isHidden())}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const dn=i.collisionArrays[Ve];if(dn){let wn=new l.pointGeometry(0,0);if(dn.textBox||dn.verticalTextBox){let sn=!0;if(J){const $n=this.variableOffsets[Je];$n?(wn=Vn($n.anchor,$n.width,$n.height,$n.textOffset,$n.textScale),se&&wn._rotate(he?this.transform.angle:-this.transform.angle)):sn=!1}dn.textBox&&vi(i.textCollisionBox.collisionVertexArray,dt.text.placed,!sn||nt,wn.x,wn.y),dn.verticalTextBox&&vi(i.textCollisionBox.collisionVertexArray,dt.text.placed,!sn||Pt,wn.x,wn.y)}const Rt=Boolean(!Pt&&dn.verticalIconBox);dn.iconBox&&vi(i.iconCollisionBox.collisionVertexArray,dt.icon.placed,Rt,be?wn.x:0,be?wn.y:0),dn.verticalIconBox&&vi(i.iconCollisionBox.collisionVertexArray,dt.icon.placed,!Rt,be?wn.x:0,be?wn.y:0)}}}if(i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const Ve=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Ve.invProjMatrix,i.placementViewportMatrix=Ve.viewportMatrix,i.collisionCircleArray=Ve.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,u){const m=this.zoomAtLastRecencyCheck===u?1-this.zoomAdjustment(u):1;return this.zoomAtLastRecencyCheck=u,this.commitTime+this.fadeDuration*m>i}setStale(){this.stale=!0}}function vi(g,i,u,m,b){g.emplaceBack(i?1:0,u?1:0,m||0,b||0),g.emplaceBack(i?1:0,u?1:0,m||0,b||0),g.emplaceBack(i?1:0,u?1:0,m||0,b||0),g.emplaceBack(i?1:0,u?1:0,m||0,b||0)}const ji=Math.pow(2,25),Sr=Math.pow(2,24),yr=Math.pow(2,17),qr=Math.pow(2,16),ur=Math.pow(2,9),vo=Math.pow(2,8),ss=Math.pow(2,1);function no(g){if(0===g.opacity&&!g.placed)return 0;if(1===g.opacity&&g.placed)return 4294967295;const i=g.placed?1:0,u=Math.floor(127*g.opacity);return u*ji+i*Sr+u*yr+i*qr+u*ur+i*vo+u*ss+i}const io=0;class To{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,u,m,b,w){const k=this._bucketParts;for(;this._currentTileIndex<i.length;)if(u.getBucketParts(k,b,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,w())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,k.sort((Z,J)=>Z.sortKey-J.sortKey));this._currentPartIndex<k.length;){const Z=k[this._currentPartIndex];if(u.placeLayerBucketPart(Z,this._seenCrossTileIDs,m,0===Z.symbolInstanceStart),this._currentPartIndex++,w())return!0}return!1}}class Ps{constructor(i,u,m,b,w,k,Z,J){this.placement=new pi(i,w,k,Z,J),this._currentPlacementIndex=u.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=b,this._done=!1}isDone(){return this._done}continuePlacement(i,u,m){const b=l.exported.now(),w=()=>{const k=l.exported.now()-b;return!this._forceFullPlacement&&k>2};for(;this._currentPlacementIndex>=0;){const k=u[i[this._currentPlacementIndex]],Z=this.placement.collisionIndex.transform.zoom;if("symbol"===k.type&&(!k.minzoom||k.minzoom<=Z)&&(!k.maxzoom||k.maxzoom>Z)){if(this._inProgressLayer||(this._inProgressLayer=new To(k)),this._inProgressLayer.continuePlacement(m[k.source],this.placement,this._showCollisionBoxes,k,w))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const as=512/l.EXTENT/2;class vs{constructor(i,u,m){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=m;for(let b=0;b<u.length;b++){const w=u.get(b),k=w.key;this.indexedSymbolInstances[k]||(this.indexedSymbolInstances[k]=[]),this.indexedSymbolInstances[k].push({crossTileID:w.crossTileID,coord:this.getScaledCoordinates(w,i)})}}getScaledCoordinates(i,u){const m=as/Math.pow(2,u.canonical.z-this.tileID.canonical.z);return{x:Math.floor((u.canonical.x*l.EXTENT+i.tileAnchorX)*m),y:Math.floor((u.canonical.y*l.EXTENT+i.tileAnchorY)*m)}}findMatches(i,u,m){const b=this.tileID.canonical.z<u.canonical.z?1:Math.pow(2,this.tileID.canonical.z-u.canonical.z);for(let w=0;w<i.length;w++){const k=i.get(w);if(k.crossTileID)continue;const Z=this.indexedSymbolInstances[k.key];if(!Z)continue;const J=this.getScaledCoordinates(k,u);for(const se of Z)if(Math.abs(se.coord.x-J.x)<=b&&Math.abs(se.coord.y-J.y)<=b&&!m[se.crossTileID]){m[se.crossTileID]=!0,k.crossTileID=se.crossTileID;break}}}}class Rs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class ls{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const u=Math.round((i-this.lng)/360);if(0!==u)for(const m in this.indexes){const b=this.indexes[m],w={};for(const k in b){const Z=b[k];Z.tileID=Z.tileID.unwrapTo(Z.tileID.wrap+u),w[Z.tileID.key]=Z}this.indexes[m]=w}this.lng=i}addBucket(i,u,m){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===u.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let w=0;w<u.symbolInstances.length;w++)u.symbolInstances.get(w).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const b=this.usedCrossTileIDs[i.overscaledZ];for(const w in this.indexes){const k=this.indexes[w];if(Number(w)>i.overscaledZ)for(const Z in k){const J=k[Z];J.tileID.isChildOf(i)&&J.findMatches(u.symbolInstances,i,b)}else{const Z=k[i.scaledTo(Number(w)).key];Z&&Z.findMatches(u.symbolInstances,i,b)}}for(let w=0;w<u.symbolInstances.length;w++){const k=u.symbolInstances.get(w);k.crossTileID||(k.crossTileID=m.generate(),b[k.crossTileID]=!0)}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new vs(i,u.symbolInstances,u.bucketInstanceId),!0}removeBucketCrossTileIDs(i,u){for(const m in u.indexedSymbolInstances)for(const b of u.indexedSymbolInstances[m])delete this.usedCrossTileIDs[i][b.crossTileID]}removeStaleBuckets(i){let u=!1;for(const m in this.indexes){const b=this.indexes[m];for(const w in b)i[b[w].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,b[w]),delete b[w],u=!0)}return u}}class cs{constructor(){this.layerIndexes={},this.crossTileIDs=new Rs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,u,m){let b=this.layerIndexes[i.id];void 0===b&&(b=this.layerIndexes[i.id]=new ls);let w=!1;const k={};b.handleWrapJump(m);for(const Z of u){const J=Z.getBucket(i);J&&i.id===J.layerIds[0]&&(J.bucketInstanceId||(J.bucketInstanceId=++this.maxBucketInstanceId),b.addBucket(Z.tileID,J,this.crossTileIDs)&&(w=!0),k[J.bucketInstanceId]=!0)}return b.removeStaleBuckets(k)&&(w=!0),w}pruneUnusedLayers(i){const u={};i.forEach(m=>{u[m]=!0});for(const m in this.layerIndexes)u[m]||delete this.layerIndexes[m]}}const Lo=(g,i)=>l.emitValidationErrors(g,i&&i.filter(u=>"source.canvas"!==u.identifier)),js=l.pick(at,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog"]),ko=l.pick(at,["setCenter","setZoom","setBearing","setPitch"]),ma=function(){const g={},i=l.spec.$version;for(const u in l.spec.$root){const m=l.spec.$root[u];if(m.required){let b=null;b="version"===u?i:"array"===m.type?[]:{},null!=b&&(g[u]=b)}}return g}(),xs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ao extends l.Evented{constructor(i,u={}){super(),this.map=i,this.dispatcher=new Vt(Zt(),this),this.imageManager=new Te,this.imageManager.setEventedParent(this),this.glyphManager=new l.GlyphManager(i._requestManager,u.localFontFamily?l.LocalGlyphMode.all:u.localIdeographFontFamily?l.LocalGlyphMode.ideographs:l.LocalGlyphMode.none,u.localFontFamily||u.localIdeographFontFamily),this.lineAtlas=new l.LineAtlas(256,512),this.crossTileSymbolIndex=new cs,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this.zoomHistory=new l.ZoomHistory,this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const m=this;this._rtlTextPluginCallback=ao.registerForPluginStateChange(b=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:b.pluginStatus,pluginURL:b.pluginURL},(w,k)=>{if(l.triggerPluginCompletionEvent(w),k&&k.every(Z=>Z))for(const Z in m._sourceCaches){const J=m._sourceCaches[Z],se=J.getSource().type;"vector"!==se&&"geojson"!==se||J.reload()}})}),this.on("data",b=>{if("source"!==b.dataType||"metadata"!==b.sourceDataType)return;const w=this.getSource(b.sourceId);if(w&&w.vectorLayerIds)for(const k in this._layers){const Z=this._layers[k];Z.source===w.id&&this._validateLayer(Z)}})}loadURL(i,u={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const m="boolean"==typeof u.validate?u.validate:!l.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,u.accessToken);const b=this.map._requestManager.transformRequest(i,l.ResourceType.Style);this._request=l.getJSON(b,(w,k)=>{this._request=null,w?this.fire(new l.ErrorEvent(w)):k&&this._load(k,m)})}loadJSON(i,u={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(i,!1!==u.validate)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(ma,!1)}_updateLayerCount(i,u){const m=u?1:-1;i.is3D()&&(this._num3DLayers+=m),"circle"===i.type&&(this._numCircleLayers+=m),"symbol"===i.type&&(this._numSymbolLayers+=m)}_load(i,u){if(u&&Lo(this,l.validateStyle(i)))return;this._loaded=!0,this.stylesheet=i;for(const b in i.sources)this.addSource(b,i.sources[b],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const m=On(this.stylesheet.layers);this._order=m.map(b=>b.id),this._layers={},this._serializedLayers={};for(let b of m)b=l.createStyleLayer(b),b.setEventedParent(this,{layer:{id:b.id}}),this._layers[b.id]=b,this._serializedLayers[b.id]=b.serialize(),this._updateLayerCount(b,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new Fe(this.stylesheet.light),this.stylesheet.terrain&&this._createTerrain(this.stylesheet.terrain),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}_loadSprite(i){this._spriteRequest=function(u,m,b){let w,k,Z;const J=l.exported.devicePixelRatio>1?"@2x":"";let se=l.getJSON(m.transformRequest(m.normalizeSpriteURL(u,J,".json"),l.ResourceType.SpriteJSON),(Ce,Me)=>{se=null,Z||(Z=Ce,w=Me,be())}),he=l.getImage(m.transformRequest(m.normalizeSpriteURL(u,J,".png"),l.ResourceType.SpriteImage),(Ce,Me)=>{he=null,Z||(Z=Ce,k=Me,be())});function be(){if(Z)b(Z);else if(w&&k){const Ce=l.exported.getImageData(k),Me={};for(const Ve in w){const{width:qe,height:ht,x:Be,y:Je,sdf:dt,pixelRatio:_t,stretchX:wt,stretchY:nt,content:Pt}=w[Ve],dn=new l.RGBAImage({width:qe,height:ht});l.RGBAImage.copy(Ce,dn,{x:Be,y:Je},{x:0,y:0},{width:qe,height:ht}),Me[Ve]={data:dn,pixelRatio:_t,sdf:dt,stretchX:wt,stretchY:nt,content:Pt}}b(null,Me)}}return{cancel(){se&&(se.cancel(),se=null),he&&(he.cancel(),he=null)}}}(i,this.map._requestManager,(u,m)=>{if(this._spriteRequest=null,u)this.fire(new l.ErrorEvent(u));else if(m)for(const b in m)this.imageManager.addImage(b,m[b]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(i){const u=this.getSource(i.source);if(!u)return;const m=i.sourceLayer;m&&("geojson"===u.type||u.vectorLayerIds&&-1===u.vectorLayerIds.indexOf(m))&&this.fire(new l.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${u.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const u=[];for(const m of i){const b=this._layers[m];"custom"!==b.type&&u.push(b.serialize())}return u}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&xs[i.type]}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const u=this._changed;if(this._changed){const b=Object.keys(this._updatedLayers),w=Object.keys(this._removedLayers);(b.length||w.length)&&this._updateWorkerLayers(b,w);for(const k in this._updatedSources){const Z=this._updatedSources[k];"reload"===Z?this._reloadSource(k):"clear"===Z&&this._clearSource(k)}this._updateTilesForChangedImages();for(const k in this._updatedPaintProps)this._layers[k].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const m={};for(const b in this._sourceCaches){const w=this._sourceCaches[b];m[b]=w.used,w.used=!1}for(const b of this._order){const w=this._layers[b];if(w.recalculate(i,this._availableImages),!w.isHidden(i.zoom)){const Z=this._getLayerSourceCache(w);Z&&(Z.used=!0)}const k=this.map.painter;if(k){const Z=w.getProgramIds();if(!Z)continue;const J=w.getProgramConfiguration(i.zoom);for(const se of Z)k.useProgram(se,J)}}for(const b in m){const w=this._sourceCaches[b];m[b]!==w.used&&w.getSource().fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:w.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),u&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const u in this._sourceCaches)this._sourceCaches[u].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,u){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:u})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),Lo(this,l.validateStyle(i)))return!1;(i=l.clone$2(i)).layers=On(i.layers);const u=function(b,w){if(!b)return[{command:at.setStyle,args:[w]}];let k=[];try{if(!H(b.version,w.version))return[{command:at.setStyle,args:[w]}];H(b.center,w.center)||k.push({command:at.setCenter,args:[w.center]}),H(b.zoom,w.zoom)||k.push({command:at.setZoom,args:[w.zoom]}),H(b.bearing,w.bearing)||k.push({command:at.setBearing,args:[w.bearing]}),H(b.pitch,w.pitch)||k.push({command:at.setPitch,args:[w.pitch]}),H(b.sprite,w.sprite)||k.push({command:at.setSprite,args:[w.sprite]}),H(b.glyphs,w.glyphs)||k.push({command:at.setGlyphs,args:[w.glyphs]}),H(b.transition,w.transition)||k.push({command:at.setTransition,args:[w.transition]}),H(b.light,w.light)||k.push({command:at.setLight,args:[w.light]}),H(b.fog,w.fog)||k.push({command:at.setFog,args:[w.fog]});const Z={},J=[];!function(be,Ce,Me,Ve){let qe;for(qe in Ce=Ce||{},be=be||{})be.hasOwnProperty(qe)&&(Ce.hasOwnProperty(qe)||ii(qe,Me,Ve));for(qe in Ce)Ce.hasOwnProperty(qe)&&(be.hasOwnProperty(qe)?H(be[qe],Ce[qe])||("geojson"===be[qe].type&&"geojson"===Ce[qe].type&&ei(be,Ce,qe)?Me.push({command:at.setGeoJSONSourceData,args:[qe,Ce[qe].data]}):Qn(qe,Ce,Me,Ve)):Yt(qe,Ce,Me))}(b.sources,w.sources,J,Z);const se=[];b.layers&&b.layers.forEach(be=>{Z[be.source]?k.push({command:at.removeLayer,args:[be.id]}):se.push(be)});let he=b.terrain;he&&Z[he.source]&&(k.push({command:at.setTerrain,args:[void 0]}),he=void 0),k=k.concat(J),H(he,w.terrain)||k.push({command:at.setTerrain,args:[w.terrain]}),function(be,Ce,Me){Ce=Ce||[];const Ve=(be=be||[]).map(Yn),qe=Ce.map(Yn),ht=be.reduce(oi,{}),Be=Ce.reduce(oi,{}),Je=Ve.slice(),dt=Object.create(null);let _t,wt,nt,Pt,dn,wn,Rt;for(_t=0,wt=0;_t<Ve.length;_t++)nt=Ve[_t],Be.hasOwnProperty(nt)?wt++:(Me.push({command:at.removeLayer,args:[nt]}),Je.splice(Je.indexOf(nt,wt),1));for(_t=0,wt=0;_t<qe.length;_t++)nt=qe[qe.length-1-_t],Je[Je.length-1-_t]!==nt&&(ht.hasOwnProperty(nt)?(Me.push({command:at.removeLayer,args:[nt]}),Je.splice(Je.lastIndexOf(nt,Je.length-wt),1)):wt++,wn=Je[Je.length-_t],Me.push({command:at.addLayer,args:[Be[nt],wn]}),Je.splice(Je.length-_t,0,nt),dt[nt]=!0);for(_t=0;_t<qe.length;_t++)if(nt=qe[_t],Pt=ht[nt],dn=Be[nt],!dt[nt]&&!H(Pt,dn))if(H(Pt.source,dn.source)&&H(Pt["source-layer"],dn["source-layer"])&&H(Pt.type,dn.type)){for(Rt in yi(Pt.layout,dn.layout,Me,nt,null,at.setLayoutProperty),yi(Pt.paint,dn.paint,Me,nt,null,at.setPaintProperty),H(Pt.filter,dn.filter)||Me.push({command:at.setFilter,args:[nt,dn.filter]}),H(Pt.minzoom,dn.minzoom)&&H(Pt.maxzoom,dn.maxzoom)||Me.push({command:at.setLayerZoomRange,args:[nt,dn.minzoom,dn.maxzoom]}),Pt)Pt.hasOwnProperty(Rt)&&"layout"!==Rt&&"paint"!==Rt&&"filter"!==Rt&&"metadata"!==Rt&&"minzoom"!==Rt&&"maxzoom"!==Rt&&(0===Rt.indexOf("paint.")?yi(Pt[Rt],dn[Rt],Me,nt,Rt.slice(6),at.setPaintProperty):H(Pt[Rt],dn[Rt])||Me.push({command:at.setLayerProperty,args:[nt,Rt,dn[Rt]]}));for(Rt in dn)dn.hasOwnProperty(Rt)&&!Pt.hasOwnProperty(Rt)&&"layout"!==Rt&&"paint"!==Rt&&"filter"!==Rt&&"metadata"!==Rt&&"minzoom"!==Rt&&"maxzoom"!==Rt&&(0===Rt.indexOf("paint.")?yi(Pt[Rt],dn[Rt],Me,nt,Rt.slice(6),at.setPaintProperty):H(Pt[Rt],dn[Rt])||Me.push({command:at.setLayerProperty,args:[nt,Rt,dn[Rt]]}))}else Me.push({command:at.removeLayer,args:[nt]}),wn=Je[Je.lastIndexOf(nt)+1],Me.push({command:at.addLayer,args:[dn,wn]})}(se,w.layers,k)}catch(Z){console.warn("Unable to compute style diff:",Z),k=[{command:at.setStyle,args:[w]}]}return k}(this.serialize(),i).filter(b=>!(b.command in ko));if(0===u.length)return!1;const m=u.filter(b=>!(b.command in js));if(m.length>0)throw new Error(`Unimplemented: ${m.map(b=>b.command).join(", ")}.`);return u.forEach(b=>{"setTransition"!==b.command&&this[b.command].apply(this,b.args)}),this.stylesheet=i,!0}addImage(i,u){if(this.getImage(i))return this.fire(new l.ErrorEvent(new Error("An image with this name already exists.")));this.imageManager.addImage(i,u),this._afterImageUpdated(i)}updateImage(i,u){this.imageManager.updateImage(i,u)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){if(!this.getImage(i))return this.fire(new l.ErrorEvent(new Error("No image with this name exists.")));this.imageManager.removeImage(i),this._afterImageUpdated(i)}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(i,u,m={}){if(this._checkLoaded(),void 0!==this.getSource(i))throw new Error("There is already a source with this ID");if(!u.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(u).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(u.type)>=0&&this._validate(l.validateStyle.source,`sources.${i}`,u,null,m))return;this.map&&this.map._collectResourceTiming&&(u.collectResourceTiming=!0);const b=V(i,u,this.dispatcher,this);b.setEventedParent(this,()=>({isSourceLoaded:this.loaded(),source:b.serialize(),sourceId:i}));const w=k=>{const Z=(k?"symbol:":"other:")+i,J=this._sourceCaches[Z]=new l.SourceCache(Z,b,k);(k?this._symbolSourceCaches:this._otherSourceCaches)[i]=J,J.style=this,J.onAdd(this.map)};w(!1),"vector"!==u.type&&"geojson"!==u.type||w(!0),b.onAdd&&b.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const u=this.getSource(i);if(void 0===u)throw new Error("There is no source with this ID");for(const b in this._layers)if(this._layers[b].source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${b}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new l.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(i);for(const b of m)delete this._sourceCaches[b.id],delete this._updatedSources[b.id],b.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:b.getSource().id})),b.setEventedParent(null),b.clearTiles();delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],u.setEventedParent(null),u.onRemove&&u.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(i,u){this._checkLoaded(),this.getSource(i).setData(u),this._changed=!0}getSource(i){const u=this._getSourceCache(i);return u&&u.getSource()}addLayer(i,u,m={}){this._checkLoaded();const b=i.id;if(this.getLayer(b))return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${b}" already exists on this map`)));let w;if("custom"===i.type){if(Lo(this,l.validateCustomStyleLayer(i)))return;w=l.createStyleLayer(i)}else{if("object"==typeof i.source&&(this.addSource(b,i.source),i=l.clone$2(i),i=l.extend(i,{source:b})),this._validate(l.validateStyle.layer,`layers.${b}`,i,{arrayIndex:-1},m))return;w=l.createStyleLayer(i),this._validateLayer(w),w.setEventedParent(this,{layer:{id:b}}),this._serializedLayers[w.id]=w.serialize(),this._updateLayerCount(w,!0)}const k=u?this._order.indexOf(u):this._order.length;if(u&&-1===k)return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`)));this._order.splice(k,0,b),this._layerOrderChanged=!0,this._layers[b]=w;const Z=this._getLayerSourceCache(w);if(this._removedLayers[b]&&w.source&&Z&&"custom"!==w.type){const J=this._removedLayers[b];delete this._removedLayers[b],J.type!==w.type?this._updatedSources[w.source]="clear":(this._updatedSources[w.source]="reload",Z.pause())}this._updateLayer(w),w.onAdd&&w.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,u){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===u)return;const m=this._order.indexOf(i);this._order.splice(m,1);const b=u?this._order.indexOf(u):this._order.length;u&&-1===b?this.fire(new l.ErrorEvent(new Error(`Layer with id "${u}" does not exist on this map.`))):(this._order.splice(b,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const u=this._layers[i];if(!u)return void this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));u.setEventedParent(null),this._updateLayerCount(u,!1);const m=this._order.indexOf(i);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=u,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],u.onRemove&&u.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const u in this._layers)if(this._layers[u].type===i)return!0;return!1}setLayerZoomRange(i,u,m){this._checkLoaded();const b=this.getLayer(i);b?b.minzoom===u&&b.maxzoom===m||(null!=u&&(b.minzoom=u),null!=m&&(b.maxzoom=m),this._updateLayer(b)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,u,m={}){this._checkLoaded();const b=this.getLayer(i);if(b){if(!H(b.filter,u))return null==u?(b.filter=void 0,void this._updateLayer(b)):void(this._validate(l.validateStyle.filter,`layers.${b.id}.filter`,u,null,m)||(b.filter=l.clone$2(u),this._updateLayer(b)))}else this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){return l.clone$2(this.getLayer(i).filter)}setLayoutProperty(i,u,m,b={}){this._checkLoaded();const w=this.getLayer(i);w?H(w.getLayoutProperty(u),m)||(w.setLayoutProperty(u,m,b),this._updateLayer(w)):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,u){const m=this.getLayer(i);if(m)return m.getLayoutProperty(u);this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,u,m,b={}){this._checkLoaded();const w=this.getLayer(i);w?H(w.getPaintProperty(u),m)||(w.setPaintProperty(u,m,b)&&this._updateLayer(w),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new l.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,u){return this.getLayer(i).getPaintProperty(u)}setFeatureState(i,u){this._checkLoaded();const m=i.source,b=i.sourceLayer,w=this.getSource(m);if(void 0===w)return void this.fire(new l.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const k=w.type;if("geojson"===k&&b)return void this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===k&&!b)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided.")));const Z=this._getSourceCaches(m);for(const J of Z)J.setFeatureState(b,i.id,u)}removeFeatureState(i,u){this._checkLoaded();const m=i.source,b=this.getSource(m);if(void 0===b)return void this.fire(new l.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const w=b.type,k="vector"===w?i.sourceLayer:void 0;if("vector"===w&&!k)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(u&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const Z=this._getSourceCaches(m);for(const J of Z)J.removeFeatureState(k,i.id,u)}getFeatureState(i){this._checkLoaded();const u=i.source,m=i.sourceLayer,b=this.getSource(u);if(void 0!==b){if("vector"!==b.type||m)return void 0===i.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(u)[0].getFeatureState(m,i.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error(`The source '${u}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const u in this._sourceCaches){const m=this._sourceCaches[u].getSource();i[m.id]||(i[m.id]=m.serialize())}return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.stylesheet.terrain,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,sources:i,layers:this._serializeLayers(this._order)},u=>void 0!==u)}_updateLayer(i){this._updatedLayers[i.id]=!0;const u=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&u&&"raster"!==u.getSource().type&&(this._updatedSources[i.source]="reload",u.pause()),this._changed=!0}_flattenAndSortRenderedFeatures(i){const u=k=>"fill-extrusion"===this._layers[k].type,m={},b=[];for(let k=this._order.length-1;k>=0;k--){const Z=this._order[k];if(u(Z)){m[Z]=k;for(const J of i){const se=J[Z];if(se)for(const he of se)b.push(he)}}}b.sort((k,Z)=>Z.intersectionZ-k.intersectionZ);const w=[];for(let k=this._order.length-1;k>=0;k--){const Z=this._order[k];if(u(Z))for(let J=b.length-1;J>=0;J--){const se=b[J].feature;if(m[se.layer.id]<k)break;w.push(se),b.pop()}else for(const J of i){const se=J[Z];if(se)for(const he of se)w.push(he.feature)}}return w}queryRenderedFeatures(i,u,m){u&&u.filter&&this._validate(l.validateStyle.filter,"queryRenderedFeatures.filter",u.filter,null,u);const b={};if(u&&u.layers){if(!Array.isArray(u.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const J of u.layers){const se=this._layers[J];if(!se)return this.fire(new l.ErrorEvent(new Error(`The layer '${J}' does not exist in the map's style and cannot be queried for features.`))),[];b[se.source]=!0}}const w=[];u.availableImages=this._availableImages;const k=u&&u.layers?u.layers.some(J=>{const se=this.getLayer(J);return se&&se.is3D()}):this.has3DLayers(),Z=Nt.createFromScreenPoints(i,m);for(const J in this._sourceCaches){const se=this._sourceCaches[J].getSource().id;u.layers&&!b[se]||w.push(De(this._sourceCaches[J],this._layers,this._serializedLayers,Z,u,m,k,!!this.map._showQueryGeometry))}return this.placement&&w.push(function(J,se,he,be,Ce,Me,Ve){const qe={},ht=Me.queryRenderedSymbols(be),Be=[];for(const Je of Object.keys(ht).map(Number))Be.push(Ve[Je]);Be.sort(vt);for(const Je of Be){const dt=Je.featureIndex.lookupSymbolFeatures(ht[Je.bucketInstanceId],se,Je.bucketIndex,Je.sourceLayerIndex,Ce.filter,Ce.layers,Ce.availableImages,J);for(const _t in dt){const wt=qe[_t]=qe[_t]||[],nt=dt[_t];nt.sort((Pt,dn)=>{const wn=Je.featureSortOrder;if(wn){const Rt=wn.indexOf(Pt.featureIndex);return wn.indexOf(dn.featureIndex)-Rt}return dn.featureIndex-Pt.featureIndex});for(const Pt of nt)wt.push(Pt)}}for(const Je in qe)qe[Je].forEach(dt=>{const _t=dt.feature,wt=he(J[Je]).getFeatureState(_t.layer["source-layer"],_t.id);_t.source=_t.layer.source,_t.layer["source-layer"]&&(_t.sourceLayer=_t.layer["source-layer"]),_t.state=wt});return qe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),Z.screenGeometry,u,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(w)}querySourceFeatures(i,u){u&&u.filter&&this._validate(l.validateStyle.filter,"querySourceFeatures.filter",u.filter,null,u);const m=this._getSourceCaches(i);let b=[];for(const w of m)b=b.concat($e(w,u));return b}addSourceType(i,u,m){return ao.getSourceType(i)?m(new Error(`A source type called "${i}" already exists.`)):(ao.setSourceType(i,u),u.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:u.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(i,u={}){this._checkLoaded();const m=this.light.getLight();let b=!1;for(const k in i)if(!H(i[k],m[k])){b=!0;break}if(!b)return;const w={now:l.exported.now(),transition:l.extend({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(i,u),this.light.updateTransitions(w)}getTerrain(){return this.terrain?this.terrain.get():null}setTerrain(i){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if("object"==typeof i.source){const u="terrain-dem-src";this.addSource(u,i.source),i=l.clone$2(i),i=l.extend(i,{source:u})}if(!this._validate(l.validateStyle.terrain,"terrain",i)){if(this.terrain){const u=this.terrain,m=u.get();for(const b in i)if(!H(i[b],m[b])){u.set(i),this.stylesheet.terrain=i;const w={now:l.exported.now(),transition:l.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(w);break}}else this._createTerrain(i);this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}}_createFog(i){const u=this.fog=new St(i);this.stylesheet.fog=i;const m={now:l.exported.now(),transition:l.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(m)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const u=this.fog,m=u.get();for(const b in i)if(!H(i[b],m[b])){u.set(i),this.stylesheet.fog=i;const w={now:l.exported.now(),transition:l.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(w);break}}else this._createFog(i);this._markersNeedUpdate=!0}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(m=>this.isLayerDraped(this._layers[m])),u=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...u)}_createTerrain(i){const u=this.terrain=new et(i);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!0),this._force3DLayerUpdate();const m={now:l.exported.now(),transition:l.extend({duration:0},this.stylesheet.transition)};u.updateTransitions(m)}_force3DLayerUpdate(){for(const i in this._layers){const u=this._layers[i];"fill-extrusion"===u.type&&this._updateLayer(u)}}_validate(i,u,m,b,w={}){return(!w||!1!==w.validate)&&Lo(this,i.call(l.validateStyle,l.extend({key:u,style:this.serialize(),value:m,styleSpec:l.spec},b)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const u=this._getSourceCaches(i);for(const m of u)m.clearTiles()}_reloadSource(i){const u=this._getSourceCaches(i);for(const m of u)m.resume(),m.reload()}_updateSources(i){for(const u in this._sourceCaches)this._sourceCaches[u].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const u=this._sourceCaches[i];u.resume(),u.reload()}}_updatePlacement(i,u,m,b,w=!1){let k=!1,Z=!1;const J={};for(const se of this._order){const he=this._layers[se];if("symbol"!==he.type)continue;if(!J[he.source]){const Ce=this._getLayerSourceCache(he);if(!Ce)continue;J[he.source]=Ce.getRenderableIds(!0).map(Me=>Ce.getTileByID(Me)).sort((Me,Ve)=>Ve.tileID.overscaledZ-Me.tileID.overscaledZ||(Me.tileID.isLessThan(Ve.tileID)?-1:1))}const be=this.crossTileSymbolIndex.addLayer(he,J[he.source],i.center.lng);k=k||be}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),w=w||this._layerOrderChanged||0===m,this._layerOrderChanged&&this.fire(new l.Event("neworder")),(w||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),i.zoom))&&(this.pauseablePlacement=new Ps(i,this._order,w,u,m,b,this.placement,this.fog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,J),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),Z=!0),k&&this.pauseablePlacement.placement.setStale()),Z||k)for(const se of this._order){const he=this._layers[se];"symbol"===he.type&&this.placement.updateLayerOpacities(he,J[he.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,u,m){this.imageManager.getImages(u.icons,m),this._updateTilesForChangedImages();const b=w=>{w&&w.setDependencies(u.tileID.key,u.type,u.icons)};b(this._otherSourceCaches[u.source]),b(this._symbolSourceCaches[u.source])}getGlyphs(i,u,m){this.glyphManager.getGlyphs(u.stacks,m)}getResource(i,u,m){return l.makeRequest(u,m)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const u=[];return this._otherSourceCaches[i]&&u.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&u.push(this._symbolSourceCaches[i]),u}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}}ao.getSourceType=function(g){return ie[g]},ao.setSourceType=function(g,i){ie[g]=i},ao.registerForPluginStateChange=l.registerForPluginStateChange;var Fo="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}\n#endif",fo="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}";let Eo={},Ze={};Eo=kt("","\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec3 elevationVector(vec2 pos) {vec2 uv=pos/8192.0;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {return currentElevation(apos);}\n#endif\nfloat unpack_depth(vec4 rgba_depth)\n{const vec4 bit_shift=vec4(1.0/(256.0*256.0*256.0),1.0/(256.0*256.0),1.0/256.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;vec4 bounds=vec4(d,vec2(1.0)-d);h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif",!0),Ze=kt("#ifdef FOG\nuniform float u_fog_temporal_offset;float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif","#ifdef FOG\nuniform mat4 u_fog_matrix;vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",!0);const st=kt("#ifdef GL_ES\nprecision mediump float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}\n#ifdef TERRAIN\nhighp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(256.0*256.0*256.0,256.0*256.0,256.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/256.0,1.0/256.0,1.0/256.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}\n#endif","#ifdef GL_ES\nprecision highp float;\n#else\n#if !defined(lowp)\n#define lowp\n#endif\n#if !defined(mediump)\n#define mediump\n#endif\n#if !defined(highp)\n#define highp\n#endif\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),Ie=Fo;var rt={background:kt("uniform vec4 u_color;uniform float u_opacity;void main() {vec4 out_color=u_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:kt("uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_mix);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:kt("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float height=circle_elevation(circle_center);vec4 world_center=vec4(circle_center,height,1);vec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);vec4 occlusion_world_center=vec4(circle_center,cantilevered_height,1);vec4 occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nvec4 occlusion_world_center=world_center;vec4 occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:kt("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:kt("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\ngl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec3 pos=vec3(floor(a_pos*0.5)+extrude,elevation(floor(a_pos*0.5)));gl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:kt("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:kt("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:kt("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:kt("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);}"),fill:kt("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:kt("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:kt("uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:kt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:kt("varying vec4 v_color;void main() {vec4 color=v_color;\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec4 v_color;\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 pos=vec3(pos_nx.xy,h);\n#else\nvec3 pos=vec3(pos_nx.xy,t > 0.0 ? height : base);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.rgb+=clamp(color.rgb*directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:kt("uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 out_color=mix(color1,color2,u_fade);out_color=out_color*v_lighting;\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;float ele=elevation(pos_nx.xy);float c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;float h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);vec3 p=vec3(pos_nx.xy,h);\n#else\nvec3 p=vec3(pos_nx.xy,z);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:kt("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos);float f=getElevation(v_pos+vec2(epsilon.x,0));float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float h=getElevation(v_pos+vec2(0,epsilon.y));float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:kt("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:kt("uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;uniform float u_mix;uniform vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist_a=texture2D(u_dash_image,v_tex_a).a;float sdfdist_b=texture2D(u_dash_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);float sdfwidth=min(dash_from.z*u_scale.y,dash_to.z*u_scale.z);float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/sdfwidth;alpha*=smoothstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\n#ifdef RENDER_LINE_GRADIENT\nvec4 out_color=texture2D(u_gradient_image,v_uv);\n#else\nvec4 out_color=color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#ifdef RENDER_LINE_GRADIENT\nattribute vec3 a_packed;\n#else\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform mediump vec3 u_scale;varying vec2 v_tex_a;varying vec2 v_tex_b;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;varying highp vec2 v_uv;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash_from\n#pragma mapbox: define lowp vec4 dash_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash_from\n#pragma mapbox: initialize lowp vec4 dash_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];float a_linesofar=a_packed[2];highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);\n#endif\n#ifdef RENDER_LINE_DASH\nfloat tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;float scaleA=dash_from.z==0.0 ? 0.0 : tileZoomRatio/(dash_from.z*fromScale);float scaleB=dash_to.z==0.0 ? 0.0 : tileZoomRatio/(dash_to.z*toScale);float heightA=dash_from.y;float heightB=dash_to.y;v_tex_a=vec2(a_linesofar*scaleA/floorwidth,(-normal.y*heightA+dash_from.x+0.5)/u_texsize.y);v_tex_b=vec2(a_linesofar*scaleB/floorwidth,(-normal.y*heightB+dash_to.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:kt("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern_from\n#pragma mapbox: define lowp vec4 pattern_to\n#pragma mapbox: define lowp float pixel_ratio_from\n#pragma mapbox: define lowp float pixel_ratio_to\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern_from\n#pragma mapbox: initialize mediump vec4 pattern_to\n#pragma mapbox: initialize lowp float pixel_ratio_from\n#pragma mapbox: initialize lowp float pixel_ratio_to\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:kt("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:kt("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));}"),symbolSDF:kt("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}"),symbolTextAndIcon:kt("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_z_tile_anchor;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}float anchorZ=a_z_tile_anchor.x;vec2 tileAnchor=a_z_tile_anchor.yz;vec3 h=elevationVector(tileAnchor)*elevation(tileAnchor);vec4 projectedPoint=u_matrix*vec4(vec3(a_pos,anchorZ)+h,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),anchorZ,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}\n#ifdef PROJECTED_POS_ON_VIEWPORT\nvec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,0.0,1.0);\n#else\nvec4 projected_pos=u_label_plane_matrix*vec4(vec3(a_projected_pos.xy,anchorZ)+h,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale);\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\nfloat occlusion_fade=occlusionFade(projectedPoint);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projectedPoint.w <=0.0 || occlusion_fade==0.0));float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}"),terrainRaster:kt("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef FOG\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\nconst float skirtOffset=24575.0;const float wireframeOffset=0.00015;void main() {v_pos0=a_texture_pos/8192.0;float skirt=float(a_pos.x >=skirtOffset);float elevation=elevation(a_texture_pos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=u_skirt_height*u_skirt_height*wireframeOffset;\n#endif\nvec2 decodedPos=a_pos-vec2(skirt*skirtOffset,0.0);gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n}"),terrainDepth:kt("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying float v_depth;void main() {float elevation=elevation(a_texture_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:kt("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",fo),skyboxGradient:kt("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",fo),skyboxCapture:kt("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:kt("uniform sampler2D u_image0;varying vec2 v_pos0;void main() {vec4 color=texture2D(u_image0,v_pos0);gl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying vec2 v_pos0;void main() {v_pos0=a_uv;gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);}"),globeAtmosphere:kt("uniform vec2 u_center;uniform float u_radius;uniform vec2 u_screen_size;uniform float u_opacity;uniform float u_fadeout_range;uniform vec3 u_start_color;uniform vec3 u_end_color;uniform float u_pixel_ratio;void main() {vec2 fragCoord=gl_FragCoord.xy/u_pixel_ratio;fragCoord.y=u_screen_size.y-fragCoord.y;float distFromCenter=length(fragCoord-u_center);float normDistFromCenter=length(fragCoord-u_center)/u_radius;if (normDistFromCenter < 1.0)\ndiscard;float t=clamp(1.0-sqrt(normDistFromCenter-1.0)/u_fadeout_range,0.0,1.0);vec3 color=mix(u_start_color,u_end_color,1.0-t);gl_FragColor=vec4(color*t*u_opacity,u_opacity);}","attribute vec3 a_pos;void main() {gl_Position=vec4(a_pos,1.0);}"),globeDepth:kt("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_globe_matrix;attribute vec3 a_globe_pos;attribute vec2 a_uv;varying float v_depth;void main() {gl_Position=u_globe_matrix*vec4(a_globe_pos+elevationVector(a_uv*8192.0)*elevation(a_uv*8192.0),1.0);v_depth=gl_Position.z/gl_Position.w;}")};function kt(g,i,u){const m=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,b=/uniform (highp |mediump |lowp )?([\w]+) ([\w]+)([\s]*)([\w]*)/g,w=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),k=g.match(b),Z=i.match(b),J=Fo.match(b);let se=Z?Z.concat(k):k;u||(Eo.staticUniforms&&(se=Eo.staticUniforms.concat(se)),Ze.staticUniforms&&(se=Ze.staticUniforms.concat(se))),se&&(se=se.concat(J));const he={};return{fragmentSource:g=g.replace(m,(be,Ce,Me,Ve,qe)=>(he[qe]=!0,"define"===Ce?`\n#ifndef HAS_UNIFORM_u_${qe}\nvarying ${Me} ${Ve} ${qe};\n#else\nuniform ${Me} ${Ve} u_${qe};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${qe}\n    ${Me} ${Ve} ${qe} = u_${qe};\n#endif\n`)),vertexSource:i=i.replace(m,(be,Ce,Me,Ve,qe)=>{const ht="float"===Ve?"vec2":"vec4",Be=qe.match(/color/)?"color":ht;return he[qe]?"define"===Ce?`\n#ifndef HAS_UNIFORM_u_${qe}\nuniform lowp float u_${qe}_t;\nattribute ${Me} ${ht} a_${qe};\nvarying ${Me} ${Ve} ${qe};\n#else\nuniform ${Me} ${Ve} u_${qe};\n#endif\n`:"vec4"===Be?`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${qe} = a_${qe};\n#else\n    ${Me} ${Ve} ${qe} = u_${qe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${qe} = unpack_mix_${Be}(a_${qe}, u_${qe}_t);\n#else\n    ${Me} ${Ve} ${qe} = u_${qe};\n#endif\n`:"define"===Ce?`\n#ifndef HAS_UNIFORM_u_${qe}\nuniform lowp float u_${qe}_t;\nattribute ${Me} ${ht} a_${qe};\n#else\nuniform ${Me} ${Ve} u_${qe};\n#endif\n`:"vec4"===Be?`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${Me} ${Ve} ${qe} = a_${qe};\n#else\n    ${Me} ${Ve} ${qe} = u_${qe};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${qe}\n    ${Me} ${Ve} ${qe} = unpack_mix_${Be}(a_${qe}, u_${qe}_t);\n#else\n    ${Me} ${Ve} ${qe} = u_${qe};\n#endif\n`}),staticAttributes:w,staticUniforms:se}}class ri{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(i,u,m,b,w,k,Z,J){this.context=i;let se=this.boundPaintVertexBuffers.length!==b.length;for(let he=0;!se&&he<b.length;he++)this.boundPaintVertexBuffers[he]!==b[he]&&(se=!0);i.extVertexArrayObject&&this.vao&&this.boundProgram===u&&this.boundLayoutVertexBuffer===m&&!se&&this.boundIndexBuffer===w&&this.boundVertexOffset===k&&this.boundDynamicVertexBuffer===Z&&this.boundDynamicVertexBuffer2===J?(i.bindVertexArrayOES.set(this.vao),Z&&Z.bind(),w&&w.dynamicDraw&&w.bind(),J&&J.bind()):this.freshBind(u,m,b,w,k,Z,J)}freshBind(i,u,m,b,w,k,Z){let J;const se=i.numAttributes,he=this.context,be=he.gl;if(he.extVertexArrayObject)this.vao&&this.destroy(),this.vao=he.extVertexArrayObject.createVertexArrayOES(),he.bindVertexArrayOES.set(this.vao),J=0,this.boundProgram=i,this.boundLayoutVertexBuffer=u,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=b,this.boundVertexOffset=w,this.boundDynamicVertexBuffer=k,this.boundDynamicVertexBuffer2=Z;else{J=he.currentNumAttributes||0;for(let Ce=se;Ce<J;Ce++)be.disableVertexAttribArray(Ce)}u.enableAttributes(be,i);for(const Ce of m)Ce.enableAttributes(be,i);k&&k.enableAttributes(be,i),Z&&Z.enableAttributes(be,i),u.bind(),u.setVertexAttribPointers(be,i,w);for(const Ce of m)Ce.bind(),Ce.setVertexAttribPointers(be,i,w);k&&(k.bind(),k.setVertexAttribPointers(be,i,w)),b&&b.bind(),Z&&(Z.bind(),Z.setVertexAttribPointers(be,i,w)),he.currentNumAttributes=se}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function fi(g,i){const u=Math.pow(2,i.canonical.z),m=i.canonical.y;return[new l.MercatorCoordinate(0,m/u).toLngLat().lat,new l.MercatorCoordinate(0,(m+1)/u).toLngLat().lat]}function dr(g,i,u,m,b,w,k){const Z=g.context,J=Z.gl,se=u.fbo;if(!se)return;g.prepareDrawTile(i);const he=g.useProgram("hillshade");Z.activeTexture.set(J.TEXTURE0),J.bindTexture(J.TEXTURE_2D,se.colorAttachment.get());const be=((Ce,Me,Ve,qe)=>{const ht=Ve.paint.get("hillshade-shadow-color"),Be=Ve.paint.get("hillshade-highlight-color"),Je=Ve.paint.get("hillshade-accent-color");let dt=Ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===Ve.paint.get("hillshade-illumination-anchor")&&(dt-=Ce.transform.angle);const _t=!Ce.options.moving;return{u_matrix:qe||Ce.transform.calculateProjMatrix(Me.tileID.toUnwrapped(),_t),u_image:0,u_latrange:fi(0,Me.tileID),u_light:[Ve.paint.get("hillshade-exaggeration"),dt],u_shadow:ht,u_highlight:Be,u_accent:Je}})(g,u,m,g.terrain?i.projMatrix:null);g.prepareDrawProgram(Z,he,i.toUnwrapped()),he.draw(Z,J.TRIANGLES,b,w,k,l.CullFaceMode.disabled,be,m.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}function Cr(g,i,u){if(!i.needsDEMTextureUpload)return;const m=g.context,b=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||g.getTileTexture(u.stride);const w=u.getPixels();i.demTexture?i.demTexture.update(w,{premultiply:!1}):i.demTexture=new l.Texture(m,w,b.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function Gi(g,i,u,m,b,w){const k=g.context,Z=k.gl;if(!i.dem)return;const J=i.dem;if(k.activeTexture.set(Z.TEXTURE1),Cr(g,i,J),!i.demTexture)return;i.demTexture.bind(Z.NEAREST,Z.CLAMP_TO_EDGE);const se=J.dim;k.activeTexture.set(Z.TEXTURE0);let he=i.fbo;if(!he){const be=new l.Texture(k,{width:se,height:se,data:null},Z.RGBA);be.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),he=i.fbo=k.createFramebuffer(se,se,!0),he.colorAttachment.set(be.texture)}k.bindFramebuffer.set(he.framebuffer),k.viewport.set([0,0,se,se]),g.useProgram("hillshadePrepare").draw(k,Z.TRIANGLES,m,b,w,l.CullFaceMode.disabled,((be,Ce)=>{const Me=Ce.stride,Ve=l.create$1();return l.ortho(Ve,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(Ve,Ve,[0,-l.EXTENT,0]),{u_matrix:Ve,u_image:1,u_dimension:[Me,Me],u_zoom:be.overscaledZ,u_unpack:Ce.unpackVector}})(i.tileID,J),u.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments),i.needsHillshadePrepare=!1}const Io=(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_image0:new l.Uniform1i(g,i.u_image0),u_skirt_height:new l.Uniform1f(g,i.u_skirt_height)}),bs=(g,i)=>({u_matrix:g,u_image0:0,u_skirt_height:i}),Yo=new class{constructor(){this.operations={}}newMorphing(g,i,u,m,b){if(g in this.operations){const w=this.operations[g];w.to.tileID.key!==u.tileID.key&&(w.queued=u)}else this.operations[g]={startTime:m,phase:0,duration:b,from:i,to:u,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const i=this.operations[g];return{from:i.from,to:i.to,phase:i.phase}}update(g){for(const i in this.operations){const u=this.operations[i];for(u.phase=(g-u.startTime)/u.duration;u.phase>=1||!this._validOp(u);)if(!this._nextOp(u,g)){delete this.operations[i];break}}}_nextOp(g,i){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=i,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},oa={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function xo(g,i){const u=1<<g.z;return!i&&(0===g.x||g.x===u-1)||0===g.y||g.y===u-1}const Os=g=>({u_matrix:g});function ae(g,i,u,m,b){if(b>0){const w=l.exported.now(),k=(w-g.timeAdded)/b,Z=i?(w-i.timeAdded)/b:-1,J=u.getSource(),se=m.coveringZoomLevel({tileSize:J.tileSize,roundZoom:J.roundZoom}),he=!i||Math.abs(i.tileID.overscaledZ-se)>Math.abs(g.tileID.overscaledZ-se),be=he&&g.refreshedUponExpiration?1:l.clamp(he?k:1-Z,0,1);return g.refreshedUponExpiration&&k>=1&&(g.refreshedUponExpiration=!1),i?{opacity:1,mix:1-be}:{opacity:be,mix:0}}return{opacity:1,mix:0}}class B extends l.SourceCache{constructor(i){const u=V("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new Vt(Zt(),null),i.style);super("proxy",u,!1),u.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,u,m){if(i.freezeTileCoverage)return;this.transform=i;const b=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((w,k)=>{if(w[k.key]="",!this._tiles[k.key]){const Z=new l.Tile(k,this._source.tileSize*k.overscaleFactor(),i.tileZoom);Z.state="loaded",this._tiles[k.key]=Z}return w},{});for(const w in this._tiles)w in b||(this.freeFBO(w),this._tiles[w].unloadVectorData(),delete this._tiles[w])}freeFBO(i){const u=this.proxyCachedFBO[i];if(void 0!==u){const m=Object.values(u);this.renderCachePool.push(...m),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class I extends l.OverscaledTileID{constructor(i,u,m){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=u,this.projMatrix=m}}class S extends l.Elevation{constructor(i,u){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,b,w]=function(J){const se=new l.StructArrayLayout4i8,he=new l.StructArrayLayout3ui6;se.reserve(17161),he.reserve(33800);const Ce=l.EXTENT/128,Me=l.EXTENT+Ce/2,Ve=Me+Ce;for(let ht=-Ce;ht<Ve;ht+=Ce)for(let Be=-Ce;Be<Ve;Be+=Ce){const Je=Be<0||Be>Me||ht<0||ht>Me?24575:0,dt=l.clamp(Math.round(Be),0,l.EXTENT),_t=l.clamp(Math.round(ht),0,l.EXTENT);se.emplaceBack(dt+Je,_t,dt,_t)}const qe=(ht,Be)=>{const Je=131*Be+ht;he.emplaceBack(Je+1,Je,Je+131),he.emplaceBack(Je+131,Je+131+1,Je+1)};for(let ht=1;ht<129;ht++)for(let Be=1;Be<129;Be++)qe(Be,ht);return[0,129].forEach(ht=>{for(let Be=0;Be<130;Be++)qe(Be,ht),qe(ht,Be)}),[se,he,32768]}(),k=i.context;this.gridBuffer=k.createVertexBuffer(m,hi.members),this.gridIndexBuffer=k.createIndexBuffer(b),this.gridSegments=l.SegmentVector.simpleSegment(0,0,m.length,b.length),this.gridNoSkirtSegments=l.SegmentVector.simpleSegment(0,0,m.length,w),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new B(u.map),this.orthoMatrix=l.create$1(),l.ortho(this.orthoMatrix,0,l.EXTENT,0,l.EXTENT,0,1);const Z=k.gl;this._overlapStencilMode=new l.StencilMode({func:Z.GEQUAL,mask:255},0,255,Z.KEEP,Z.KEEP,Z.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=u,this._useVertexMorphing=!0,this._exaggeration=1}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency()}update(i,u,m){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const b=i.terrain.properties;this.sourceCache=i._getSourceCache(b.get("source")),this._exaggeration=b.get("exaggeration");const w=()=>{this.sourceCache.used&&l.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const k=this.sourceCache.getSource().tileSize/128,Z=this.proxySourceCache.getSource().tileSize;this.sourceCache.update(u,k*Z,!0),this._findCoveringTileCache[this.sourceCache.id]={}};this.sourceCache.usedForTerrain||(this._findCoveringTileCache[this.sourceCache.id]={},this.sourceCache.usedForTerrain=!0,w(),this._initializing=!0),w(),u.updateElevation(!m),this._findCoveringTileCache[this.proxySourceCache.id]={},this.proxySourceCache.update(u),this._emptyDEMTextureDirty=!0}else this._disable()}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==i.efficiency&&l.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture)}_source(){return this.enabled?this.sourceCache:null}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const u=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=0===m._centerAltitude&&-1===this.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(m.center),-1),this._emptyDEMTextureDirty=!this._initializing);const b=this.proxyCoords=u.getIds().map(J=>{const se=u.getTileByID(J).tileID;return se.projMatrix=m.calculateProjMatrix(se.toUnwrapped()),se});(function(J,se){const he=se.transform.pointCoordinate(se.transform.getCameraPoint()),be=new l.pointGeometry(he.x,he.y);J.sort((Ce,Me)=>{if(Me.overscaledZ-Ce.overscaledZ)return Me.overscaledZ-Ce.overscaledZ;const Ve=new l.pointGeometry(Ce.canonical.x+(1<<Ce.canonical.z)*Ce.wrap,Ce.canonical.y),qe=new l.pointGeometry(Me.canonical.x+(1<<Me.canonical.z)*Me.wrap,Me.canonical.y),ht=be.mult(1<<Ce.canonical.z);return ht.x-=.5,ht.y-=.5,ht.distSqr(Ve)-ht.distSqr(qe)})})(b,this.painter),this._previousZoom=m.zoom;const w=this.proxyToSource||{};this.proxyToSource={},b.forEach(J=>{this.proxyToSource[J.key]={}}),this.terrainTileForTile={};const k=this._style._sourceCaches;for(const J in k){const se=k[J];if(!se.used||(se!==this.sourceCache&&(this._findCoveringTileCache[se.id]={}),this._setupProxiedCoordsForOrtho(se,i[J],w),se.usedForTerrain))continue;const he=i[J];se.getSource().reparseOverscaled&&this._assignTerrainTiles(he)}this.proxiedCoords[u.id]=b.map(J=>new I(J,J.key,this.orthoMatrix)),this._assignTerrainTiles(b),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(w),this.renderingToTexture=!1,this._updateTimestamp=l.exported.now();const Z={};this._visibleDemTiles=[];for(const J of this.proxyCoords){const se=this.terrainTileForTile[J.key];if(!se)continue;const he=se.tileID.key;he in Z||(this._visibleDemTiles.push(se),Z[he]=he)}}_assignTerrainTiles(i){this._initializing||i.forEach(u=>{if(this.terrainTileForTile[u.key])return;const m=this._findTileCoveringTileID(u,this.sourceCache);m&&(this.terrainTileForTile[u.key]=m)})}_prepareDEMTextures(){const i=this.painter.context,u=i.gl;for(const m in this.terrainTileForTile){const b=this.terrainTileForTile[m],w=b.dem;!w||b.demTexture&&!b.needsDEMTextureUpload||(i.activeTexture.set(u.TEXTURE1),Cr(this.painter,b,w))}}_prepareDemTileUniforms(i,u,m,b){if(!u||null==u.demTexture)return!1;const w=i.tileID.canonical,k=Math.pow(2,u.tileID.canonical.z-w.z),Z=b||"";return m[`u_dem_tl${Z}`]=[w.x*k%1,w.y*k%1],m[`u_dem_scale${Z}`]=k,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){let i=0;const u=this._visibleDemTiles.reduce((m,b)=>{if(!b.dem)return m;const w=b.dem.tree.minimums[0];return w>0&&i++,m+w},0);return i?u/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,u=i.gl;i.activeTexture.set(u.TEXTURE2);const m=this._getLoadedAreaMinimum(),b={width:1,height:1,data:new Uint8Array(l.DEMData.pack(m,this.sourceCache.getSource().encoding))};this._emptyDEMTextureDirty=!1;let w=this._emptyDEMTexture;return w?w.update(b,{premultiply:!1}):w=this._emptyDEMTexture=new l.Texture(i,b,u.RGBA,{premultiply:!1}),w}setupElevationDraw(i,u,m){const b=this.painter.context,w=b.gl,k=(Z=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:l.DEMData.getUnpackVector(Z),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0,u_tile_tl_up:[0,0,1],u_tile_tr_up:[0,0,1],u_tile_br_up:[0,0,1],u_tile_bl_up:[0,0,1],u_tile_up_scale:1});var Z;k.u_dem_size=this.sourceCache.getSource().tileSize,k.u_exaggeration=this.exaggeration();let J=null,se=null,he=1;if(m&&m.morphing&&this._useVertexMorphing){const be=m.morphing.srcDemTile,Ce=m.morphing.dstDemTile;he=m.morphing.phase,be&&Ce&&(this._prepareDemTileUniforms(i,be,k,"_prev")&&(se=be),this._prepareDemTileUniforms(i,Ce,k)&&(J=Ce))}if(se&&J?(b.activeTexture.set(w.TEXTURE2),J.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),b.activeTexture.set(w.TEXTURE4),se.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),k.u_dem_lerp=he):(J=this.terrainTileForTile[i.tileID.key],b.activeTexture.set(w.TEXTURE2),(this._prepareDemTileUniforms(i,J,k)?J.demTexture:this.emptyDEMTexture).bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST)),m&&m.useDepthForOcclusion&&(b.activeTexture.set(w.TEXTURE3),this._depthTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE,w.NEAREST),k.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height]),m&&m.useMeterToDem&&J){const be=(1<<J.tileID.canonical.z)*l.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;k.u_meter_to_dem=be}m&&m.labelPlaneMatrixInv&&(k.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),u.setTerrainUniformValues(b,k)}renderToBackBuffer(i){const u=this.painter,m=this.painter.context;0!==i.length&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),this.renderingToTexture=!1,function(b,w,k,Z,J){const se=b.context,he=se.gl;let be,Ce;const Me=b.options.showTerrainWireframe?2:0,Ve=(dt,_t)=>{if(Ce===dt)return;const wt=[oa[dt]];_t&&wt.push(oa[Me]),be=b.useProgram("terrainRaster",null,wt),Ce=dt},qe=b.colorModeForRenderPass(),ht=new l.DepthMode(he.LEQUAL,l.DepthMode.ReadWrite,b.depthRangeFor3D);Yo.update(J);const Be=b.transform,Je=6*Math.pow(1.5,22-Be.zoom)*w.exaggeration();(Me?[!1,!0]:[!1]).forEach(dt=>{Ce=-1;const _t=dt?he.LINES:he.TRIANGLES,[wt,nt]=dt?w.getWirefameBuffer():[w.gridIndexBuffer,w.gridSegments];for(const wn of Z){const Rt=k.getTile(wn),sn=l.StencilMode.disabled,$n=w.prevTerrainTileForTile[wn.key],Kn=w.terrainTileForTile[wn.key];dn=Kn,null!=(Pt=$n)&&null!=dn&&Pt.hasData()&&dn.hasData()&&null!=Pt.demTexture&&null!=dn.demTexture&&Pt.tileID.key!==dn.tileID.key&&Yo.newMorphing(wn.key,$n,Kn,J,250),se.activeTexture.set(he.TEXTURE0),Rt.texture.bind(he.LINEAR,he.CLAMP_TO_EDGE,he.LINEAR_MIPMAP_NEAREST);const Gn=Yo.getMorphValuesForProxy(wn.key),Pn=Gn?1:0;let Xn;Gn&&(Xn={morphing:{srcDemTile:Gn.from,dstDemTile:Gn.to,phase:l.easeCubicInOut(Gn.phase)}});const qi=bs(wn.projMatrix,xo(wn.canonical,Be.renderWorldCopies)?Je/10:Je);Ve(Pn,dt),w.setupElevationDraw(Rt,be,Xn),b.prepareDrawProgram(se,be,wn.toUnwrapped()),be.draw(se,_t,ht,sn,qe,l.CullFaceMode.backCCW,qi,"terrain_raster",w.gridBuffer,wt,nt)}var Pt,dn})}(u,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const u=this.painter,m=this.painter.context,b=this.proxySourceCache,w=this.proxiedCoords[b.id],k=this._drapedRenderBatches.shift(),Z=[],J=u.style.order;let se=0;for(const he of w){const be=b.getTileByID(he.proxyTileKey),Ce=b.proxyCachedFBO[he.key]?b.proxyCachedFBO[he.key][i]:void 0,Me=void 0!==Ce?b.renderCache[Ce]:this.pool[se++],Ve=void 0!==Ce;if(be.texture=Me.tex,Ve&&!Me.dirty){Z.push(be.tileID);continue}let qe;m.bindFramebuffer.set(Me.fb.framebuffer),this.renderedToTile=!1,Me.dirty&&(m.clear({color:l.Color.transparent}),Me.dirty=!1);for(let ht=k.start;ht<=k.end;++ht){const Be=u.style._layers[J[ht]];if(Be.isHidden(u.transform.zoom))continue;const Je=u.style._getLayerSourceCache(Be),dt=Je?this.proxyToSource[he.key][Je.id]:[he];if(!dt)continue;const _t=dt;m.viewport.set([0,0,Me.fb.width,Me.fb.height]),qe!==(Je?Je.id:null)&&(this._setupStencil(Me,dt,Be,Je),qe=Je?Je.id:null),u.renderLayer(u,Je,Be,_t)}this.renderedToTile?(Me.dirty=!0,Z.push(be.tileID)):Ve||--se,5===se&&(se=0,this.renderToBackBuffer(Z))}return this.renderToBackBuffer(Z),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,u.width,u.height]),k.end+1}postRender(){}renderCacheEfficiency(i){const u=i.order.length;if(0===u)return{efficiency:100};let m,b=0,w=0,k=!1;for(let Z=0;Z<u;++Z){const J=i._layers[i.order[Z]];this._style.isLayerDraped(J)?(k&&++b,++w):k||(k=!0,m=J.id)}return 0===w?{efficiency:100}:{efficiency:100*(1-b/w),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(u=>u.dem).forEach(u=>{i=Math.min(i,u.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,u,m){if(!this._visibleDemTiles)return null;const b=this._visibleDemTiles.filter(w=>w.dem).map(w=>{const k=w.tileID,Z=Math.pow(2,k.overscaledZ),{x:J,y:se}=k.canonical,he=J/Z,be=(J+1)/Z,Ce=se/Z,Me=(se+1)/Z;return{minx:he,miny:Ce,maxx:be,maxy:Me,t:w.dem.tree.raycastRoot(he,Ce,be,Me,i,u,m),tile:w}});b.sort((w,k)=>(null!==w.t?w.t:Number.MAX_VALUE)-(null!==k.t?k.t:Number.MAX_VALUE));for(const w of b){if(null==w.t)return null;const k=w.tile.dem.tree.raycast(w.minx,w.miny,w.maxx,w.maxy,i,u,m);if(null!=k)return k}return null}_createFBO(){const i=this.painter.context,u=i.gl,m=this.drapeBufferSize;i.activeTexture.set(u.TEXTURE0);const b=new l.Texture(i,{width:m[0],height:m[1],data:null},u.RGBA);b.bind(u.LINEAR,u.CLAMP_TO_EDGE);const w=i.createFramebuffer(m[0],m[1],!1);return w.colorAttachment.set(b.texture),w.depthAttachment=new br(i,w.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,w.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):w.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&u.texParameterf(u.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:w,tex:b,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const u=this._style._layers[i],m=u.isHidden(this.painter.transform.zoom),b=u.getCrossfadeParameters(),w=!!b&&1!==b.t,k=u.hasTransition();return"custom"!==u.type&&!m&&(w||k)})}_clearRasterFadeFromRenderCache(){let i=!1;for(const u in this._style._sourceCaches)if(this._style._sourceCaches[u]._source instanceof mr){i=!0;break}if(i)for(let u=0;u<this._style.order.length;++u){const m=this._style._layers[this._style.order[u]],b=m.isHidden(this.painter.transform.zoom),w=this._style._getLayerSourceCache(m);if("raster"!==m.type||b||!w)continue;const k=m.paint.get("raster-fade-duration");for(const Z of this.proxyCoords){const J=this.proxyToSource[Z.key][w.id];if(J)for(const se of J){const he=ae(w.getTile(se),w.findLoadedParent(se,0),w,this.painter.transform,k);(1!==he.opacity||0!==he.mix)&&this._clearRenderCacheForTile(w.id,se)}}}}_setupDrapedRenderBatches(){const i=this._style.order,u=i.length;if(0===u)return;const m=[];let b,w=0,k=this._style._layers[i[w]];for(;!this._style.isLayerDraped(k)&&k.isHidden(this.painter.transform.zoom)&&++w<u;)k=this._style._layers[i[w]];for(;w<u;++w){const Z=this._style._layers[i[w]];Z.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(Z)?void 0===b&&(b=w):void 0!==b&&(m.push({start:b,end:w-1}),b=void 0))}void 0!==b&&m.push({start:b,end:w-1}),this._drapedRenderBatches=m}_setupRenderCache(i){const u=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,u.renderCache.length>u.renderCachePool.length){const k=Object.values(u.proxyCachedFBO);u.proxyCachedFBO={};for(let Z=0;Z<k.length;++Z){const J=Object.values(k[Z]);u.renderCachePool.push(...J)}}return}this._clearRasterFadeFromRenderCache();const m=this.proxyCoords,b=this._tilesDirty;for(let k=m.length-1;k>=0;k--){const Z=m[k];if(u.getTileByID(Z.key),void 0!==u.proxyCachedFBO[Z.key]){const J=i[Z.key],se=this.proxyToSource[Z.key];let he=0;for(const be in se){const Ce=se[be],Me=J[be];if(!Me||Me.length!==Ce.length||Ce.some((Ve,qe)=>Ve!==Me[qe]||b[be]&&b[be].hasOwnProperty(Ve.key))){he=-1;break}++he}for(const be in u.proxyCachedFBO[Z.key])u.renderCache[u.proxyCachedFBO[Z.key][be]].dirty=he<0||he!==Object.values(J).length}}const w=[...this._drapedRenderBatches];w.sort((k,Z)=>Z.end-Z.start-(k.end-k.start));for(const k of w)for(const Z of m){if(u.proxyCachedFBO[Z.key])continue;let J=u.renderCachePool.pop();void 0===J&&u.renderCache.length<50&&(J=u.renderCache.length,u.renderCache.push(this._createFBO())),void 0!==J&&(u.proxyCachedFBO[Z.key]={},u.proxyCachedFBO[Z.key][k.start]=J,u.renderCache[J].dirty=!0)}this._tilesDirty={}}_setupStencil(i,u,m,b){if(!b||!this._sourceTilesOverlap[b.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const w=this.painter.context,k=w.gl;if(u.length<=1)return void(this._overlapStencilType=!1);let Z;if(m.isTileClipped())Z=u.length,this._overlapStencilMode.test={func:k.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(u[0].overscaledZ>u[u.length-1].overscaledZ))return void(this._overlapStencilType=!1);Z=1,this._overlapStencilMode.test={func:k.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+Z>255&&(w.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=Z,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(u,this._overlapStencilMode.ref)}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):l.StencilMode.disabled}_renderTileClippingMasks(i,u){const m=this.painter,b=this.painter.context,w=b.gl;m._tileClippingMaskIDs={},b.setColorMode(l.ColorMode.disabled),b.setDepthMode(l.DepthMode.disabled);const k=m.useProgram("clippingMask");for(const Z of i){const J=m._tileClippingMaskIDs[Z.key]=--u;k.draw(b,w.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:w.ALWAYS,mask:0},J,255,w.KEEP,w.KEEP,w.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,Os(Z.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(i){const u=this.painter.transform;if(i.x<0||i.x>u.width||i.y<0||i.y>u.height)return null;const m=[i.x,i.y,1,1];l.transformMat4(m,m,u.pixelMatrixInverse),l.scale$2(m,m,1/m[3]),m[0]/=u.worldSize,m[1]/=u.worldSize;const b=u._camera.position,w=l.mercatorZfromAltitude(1,u.center.lat),k=[b[0],b[1],b[2]/w,0],Z=l.subtract([],m.slice(0,3),k);l.normalize(Z,Z);const J=this.raycast(k,Z,this._exaggeration);return null!==J&&J?(l.scaleAndAdd(k,k,Z,J),k[3]=k[2],k[2]*=w,k):null}drawDepth(){const i=this.painter,u=i.context,m=this.proxySourceCache,b=Math.ceil(i.width),w=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===b&&this._depthFBO.height===w||(this._depthFBO.destroy(),delete this._depthFBO,delete this._depthTexture),!this._depthFBO){const k=u.gl,Z=u.createFramebuffer(b,w,!0);u.activeTexture.set(k.TEXTURE0);const J=new l.Texture(u,{width:b,height:w,data:null},k.RGBA);J.bind(k.NEAREST,k.CLAMP_TO_EDGE),Z.colorAttachment.set(J.texture);const se=u.createRenderbuffer(u.gl.DEPTH_COMPONENT16,b,w);Z.depthAttachment.set(se),this._depthFBO=Z,this._depthTexture=J}u.bindFramebuffer.set(this._depthFBO.framebuffer),u.viewport.set([0,0,b,w]),function(k,Z,J,se){const he=k.context,be=he.gl;he.clear({depth:1});const Ce=k.useProgram("terrainDepth"),Me=new l.DepthMode(be.LESS,l.DepthMode.ReadWrite,k.depthRangeFor3D);for(const Ve of se){const qe=J.getTile(Ve),ht=bs(Ve.projMatrix,0);Z.setupElevationDraw(qe,Ce),Ce.draw(he,be.TRIANGLES,Me,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.backCCW,ht,"terrain_depth",Z.gridBuffer,Z.gridIndexBuffer,Z.gridNoSkirtSegments)}}(i,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,u,m){if(i.getSource()instanceof re)return this._setupProxiedCoordsForImageSource(i,u,m);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const b=this.proxiedCoords[i.id]=[],w=this.proxyCoords;for(let Z=0;Z<w.length;Z++){const J=w[Z],se=this._findTileCoveringTileID(J,i);if(se){const he=this._createProxiedId(J,se,m[J.key]&&m[J.key][i.id]);b.push(he),this.proxyToSource[J.key][i.id]=[he]}}let k=!1;for(let Z=0;Z<u.length;Z++){const J=i.getTile(u[Z]);if(!J||!J.hasData())continue;const se=this._findTileCoveringTileID(J.tileID,this.proxySourceCache);if(se&&se.tileID.canonical.z!==J.tileID.canonical.z){const he=this.proxyToSource[se.tileID.key][i.id],be=this._createProxiedId(se.tileID,J,m[se.tileID.key]&&m[se.tileID.key][i.id]);he?he.splice(he.length-1,0,be):this.proxyToSource[se.tileID.key][i.id]=[be],b.push(be),k=!0}}this._sourceTilesOverlap[i.id]=k}_setupProxiedCoordsForImageSource(i,u,m){if(!i.getSource().loaded())return;const b=this.proxiedCoords[i.id]=[],w=this.proxyCoords,k=i.getSource(),Z=new l.pointGeometry(k.tileID.x,k.tileID.y)._div(1<<k.tileID.z),J=k.coordinates.map(l.MercatorCoordinate.fromLngLat).reduce((he,be)=>(he.min.x=Math.min(he.min.x,be.x-Z.x),he.min.y=Math.min(he.min.y,be.y-Z.y),he.max.x=Math.max(he.max.x,be.x-Z.x),he.max.y=Math.max(he.max.y,be.y-Z.y),he),{min:new l.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new l.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),se=(he,be)=>{const Ce=he.wrap+he.canonical.x/(1<<he.canonical.z),Me=he.canonical.y/(1<<he.canonical.z),Ve=l.EXTENT/(1<<he.canonical.z),qe=be.wrap+be.canonical.x/(1<<be.canonical.z),ht=be.canonical.y/(1<<be.canonical.z);return Ce+Ve<qe+J.min.x||Ce>qe+J.max.x||Me+Ve<ht+J.min.y||Me>ht+J.max.y};for(let he=0;he<w.length;he++){const be=w[he];for(let Ce=0;Ce<u.length;Ce++){const Me=i.getTile(u[Ce]);if(!Me||!Me.hasData()||se(be,Me.tileID))continue;const Ve=this._createProxiedId(be,Me,m[be.key]&&m[be.key][i.id]),qe=this.proxyToSource[be.key][i.id];qe?qe.push(Ve):this.proxyToSource[be.key][i.id]=[Ve],b.push(Ve)}}}_createProxiedId(i,u,m){let b=this.orthoMatrix;if(m){const w=m.find(k=>k.key===u.tileID.key);if(w)return w}if(u.tileID.key!==i.key){const w=i.canonical.z-u.tileID.canonical.z;let k,Z,J;b=l.create$1();const se=u.tileID.wrap-i.wrap<<i.overscaledZ;w>0?(k=l.EXTENT>>w,Z=k*((u.tileID.canonical.x<<w)-i.canonical.x+se),J=k*((u.tileID.canonical.y<<w)-i.canonical.y)):(k=l.EXTENT<<-w,Z=l.EXTENT*(u.tileID.canonical.x-(i.canonical.x+se<<-w)),J=l.EXTENT*(u.tileID.canonical.y-(i.canonical.y<<-w))),l.ortho(b,0,k,0,k,0,1),l.translate(b,b,[Z,J,0])}return new I(u.tileID,i.key,b)}_findTileCoveringTileID(i,u){let m=u.getTile(i);if(m&&m.hasData())return m;const b=this._findCoveringTileCache[u.id],w=b[i.key];if(m=w?u.getTileByID(w):null,m&&m.hasData()||null===w)return m;let k=m?m.tileID:i,Z=k.overscaledZ;const J=u.getSource().minzoom,se=[];if(!w){const be=u.getSource().maxzoom;if(i.canonical.z>=be){const Ce=i.canonical.z-be;u.getSource().reparseOverscaled?(Z=Math.max(i.canonical.z+2,u.transform.tileZoom),k=new l.OverscaledTileID(Z,i.wrap,be,i.canonical.x>>Ce,i.canonical.y>>Ce)):0!==Ce&&(Z=be,k=new l.OverscaledTileID(Z,i.wrap,be,i.canonical.x>>Ce,i.canonical.y>>Ce))}k.key!==i.key&&(se.push(k.key),m=u.getTile(k))}const he=be=>{se.forEach(Ce=>{b[Ce]=be}),se.length=0};for(Z-=1;Z>=J&&(!m||!m.hasData());Z--){m&&he(m.tileID.key);const be=k.calculateScaledKey(Z);if(m=u.getTileByID(be),m&&m.hasData())break;const Ce=b[be];if(null===Ce)break;void 0===Ce?se.push(be):m=u.getTileByID(Ce)}return he(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(i){this.renderedToTile=!0}_clearRenderCacheForTile(i,u){let m=this._tilesDirty[i];m||(m=this._tilesDirty[i]={}),m[u.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(u){let m,b,w;const k=new l.StructArrayLayout2ui4,Z=131;for(b=1;b<129;b++){for(m=1;m<129;m++)w=b*Z+m,k.emplaceBack(w,w+1),k.emplaceBack(w,w+Z),k.emplaceBack(w+1,w+Z),128===b&&k.emplaceBack(w+Z,w+Z+1);k.emplaceBack(w+1,w+1+Z)}return k}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=l.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}function le(g){const i=[];for(let u=0;u<g.length;u++){if(null===g[u])continue;const m=g[u].split(" ");i.push(m.pop())}return i}class Xe{static cacheKey(i,u,m){let b=`${i}${m?m.cacheKey:""}`;for(const w of u)b+=`/${w}`;return b}constructor(i,u,m,b,w,k){const Z=i.gl;this.program=Z.createProgram();const J=le(m.staticAttributes),se=b?b.getBinderAttributes():[],he=J.concat(se),be=m.staticUniforms?le(m.staticUniforms):[],Ce=b?b.getBinderUniforms():[],Me=be.concat(Ce),Ve=[];for(const wt of Me)Ve.indexOf(wt)<0&&Ve.push(wt);let qe=b?b.defines():[];qe=qe.concat(k.map(wt=>`#define ${wt}`));const ht=qe.concat(st.fragmentSource,Ie,Ze.fragmentSource,m.fragmentSource).join("\n"),Be=qe.concat(st.vertexSource,Ie,Ze.vertexSource,Eo.vertexSource,m.vertexSource).join("\n"),Je=Z.createShader(Z.FRAGMENT_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource(Je,ht),Z.compileShader(Je),Z.attachShader(this.program,Je);const dt=Z.createShader(Z.VERTEX_SHADER);if(Z.isContextLost())return void(this.failedToCreate=!0);Z.shaderSource(dt,Be),Z.compileShader(dt),Z.attachShader(this.program,dt),this.attributes={};const _t={};this.numAttributes=he.length;for(let wt=0;wt<this.numAttributes;wt++)he[wt]&&(Z.bindAttribLocation(this.program,wt,he[wt]),this.attributes[he[wt]]=wt);Z.linkProgram(this.program),Z.deleteShader(dt),Z.deleteShader(Je);for(let wt=0;wt<Ve.length;wt++){const nt=Ve[wt];if(nt&&!_t[nt]){const Pt=Z.getUniformLocation(this.program,nt);Pt&&(_t[nt]=Pt)}}var wt,nt;this.fixedUniforms=w(i,_t),this.binderUniforms=b?b.getUniforms(i,_t):[],-1!==k.indexOf("TERRAIN")&&(this.terrainUniforms={u_dem:new l.Uniform1i(wt=i,(nt=_t).u_dem),u_dem_prev:new l.Uniform1i(wt,nt.u_dem_prev),u_dem_unpack:new l.Uniform4f(wt,nt.u_dem_unpack),u_dem_tl:new l.Uniform2f(wt,nt.u_dem_tl),u_dem_scale:new l.Uniform1f(wt,nt.u_dem_scale),u_dem_tl_prev:new l.Uniform2f(wt,nt.u_dem_tl_prev),u_dem_scale_prev:new l.Uniform1f(wt,nt.u_dem_scale_prev),u_dem_size:new l.Uniform1f(wt,nt.u_dem_size),u_dem_lerp:new l.Uniform1f(wt,nt.u_dem_lerp),u_exaggeration:new l.Uniform1f(wt,nt.u_exaggeration),u_depth:new l.Uniform1i(wt,nt.u_depth),u_depth_size_inv:new l.Uniform2f(wt,nt.u_depth_size_inv),u_meter_to_dem:new l.Uniform1f(wt,nt.u_meter_to_dem),u_label_plane_matrix_inv:new l.UniformMatrix4f(wt,nt.u_label_plane_matrix_inv),u_tile_tl_up:new l.Uniform3f(wt,nt.u_tile_tl_up),u_tile_tr_up:new l.Uniform3f(wt,nt.u_tile_tr_up),u_tile_br_up:new l.Uniform3f(wt,nt.u_tile_br_up),u_tile_bl_up:new l.Uniform3f(wt,nt.u_tile_bl_up),u_tile_up_scale:new l.Uniform1f(wt,nt.u_tile_up_scale)}),-1!==k.indexOf("FOG")&&(this.fogUniforms=((wt,nt)=>({u_fog_matrix:new l.UniformMatrix4f(wt,nt.u_fog_matrix),u_fog_range:new l.Uniform2f(wt,nt.u_fog_range),u_fog_color:new l.Uniform4f(wt,nt.u_fog_color),u_fog_horizon_blend:new l.Uniform1f(wt,nt.u_fog_horizon_blend),u_fog_temporal_offset:new l.Uniform1f(wt,nt.u_fog_temporal_offset)}))(i,_t))}setTerrainUniformValues(i,u){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const b in u)m[b].set(u[b])}}setFogUniformValues(i,u){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const b in u)m[b].location&&m[b].set(u[b])}}draw(i,u,m,b,w,k,Z,J,se,he,be,Ce,Me,Ve,qe,ht){const Be=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(m),i.setStencilMode(b),i.setColorMode(w),i.setCullFace(k);for(const dt in this.fixedUniforms)this.fixedUniforms[dt].set(Z[dt]);Ve&&Ve.setUniforms(i,this.binderUniforms,Ce,{zoom:Me});const Je={[Be.LINES]:2,[Be.TRIANGLES]:3,[Be.LINE_STRIP]:1}[u];for(const dt of be.get()){const _t=dt.vaos||(dt.vaos={});(_t[J]||(_t[J]=new ri)).bind(i,this,se,Ve?Ve.getPaintVertexBuffers():[],he,dt.vertexOffset,qe,ht),Be.drawElements(u,dt.primitiveLength*Je,Be.UNSIGNED_SHORT,dt.primitiveOffset*Je*2)}}}function Jt(g,i,u){const m=1/bn(u,1,i.transform.tileZoom),b=Math.pow(2,u.tileID.overscaledZ),w=u.tileSize*Math.pow(2,i.transform.tileZoom)/b,k=w*(u.tileID.canonical.x+u.tileID.wrap*b),Z=w*u.tileID.canonical.y;return{u_image:0,u_texsize:u.imageAtlasTexture.size,u_scale:[m,g.fromScale,g.toScale],u_fade:g.t,u_pixel_coord_upper:[k>>16,Z>>16],u_pixel_coord_lower:[65535&k,65535&Z]}}const Hn=(g,i,u,m)=>{const b=i.style.light,w=b.properties.get("position"),k=[w.x,w.y,w.z],Z=l.create$2();"viewport"===b.properties.get("anchor")&&(l.fromRotation(Z,-i.transform.angle),l.transformMat3(k,k,Z));const J=b.properties.get("color");return{u_matrix:g,u_lightpos:k,u_lightintensity:b.properties.get("intensity"),u_lightcolor:[J.r,J.g,J.b],u_vertical_gradient:+u,u_opacity:m}},wi=(g,i,u,m,b,w,k)=>l.extend(Hn(g,i,u,m),Jt(w,i,k),{u_height_factor:-Math.pow(2,b.overscaledZ)/k.tileSize/8}),Xi=g=>({u_matrix:g}),ar=(g,i,u,m)=>l.extend(Xi(g),Jt(u,i,m)),nr=(g,i)=>({u_matrix:g,u_world:i}),Ri=(g,i,u,m,b)=>l.extend(ar(g,i,u,m),{u_world:b}),Dr=(g,i,u,m)=>{const b=g.transform;let w;if("map"===m.paint.get("circle-pitch-alignment")){const k=bn(u,1,b.zoom);w=[k,k]}else w=b.pixelsToGLUnits;return{u_camera_to_center_distance:b.cameraToCenterDistance,u_matrix:g.translatePosMatrix(i.projMatrix,u,m.paint.get("circle-translate"),m.paint.get("circle-translate-anchor")),u_device_pixel_ratio:l.exported.devicePixelRatio,u_extrude_scale:w}},Wr=g=>{const i=[];return"map"===g.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===g.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i},go=(g,i,u)=>{const m=l.EXTENT/u.tileSize;return{u_matrix:g,u_camera_to_center_distance:i.cameraToCenterDistance,u_extrude_scale:[i.pixelsToGLUnits[0]/m,i.pixelsToGLUnits[1]/m]}},Lr=(g,i,u=1)=>({u_matrix:g,u_color:i,u_overlay:0,u_overlay_scale:u}),Ls=(g,i,u,m)=>({u_matrix:g,u_extrude_scale:bn(i,1,u),u_intensity:m}),qo=(g,i,u,m,b,w)=>{const k=g.transform,Z={u_matrix:ks(g,i,u,b),u_ratio:1/bn(i,1,k.zoom),u_device_pixel_ratio:l.exported.devicePixelRatio,u_units_to_pixels:[1/k.pixelsToGLUnits[0],1/k.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:w,u_texsize:[0,0],u_scale:[0,0,0],u_mix:0};if(Di(u)){const J=Pr(i,g.transform);Z.u_texsize=i.lineAtlasTexture.size,Z.u_scale=[J,m.fromScale,m.toScale],Z.u_mix=m.t}return Z},sa=(g,i,u,m,b)=>{const w=g.transform,k=Pr(i,w);return{u_matrix:ks(g,i,u,b),u_texsize:i.imageAtlasTexture.size,u_ratio:1/bn(i,1,w.zoom),u_device_pixel_ratio:l.exported.devicePixelRatio,u_image:0,u_scale:[k,m.fromScale,m.toScale],u_fade:m.t,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]]}};function Pr(g,i){return 1/bn(g,1,i.tileZoom)}function ks(g,i,u,m){return g.translatePosMatrix(m||i.tileID.projMatrix,i,u.paint.get("line-translate"),u.paint.get("line-translate-anchor"))}const ws=g=>{const i=[];return Di(g)&&i.push("RENDER_LINE_DASH"),g.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT"),i};function Di(g){const i=g.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const qs=(g,i,u,m,b)=>{return{u_matrix:g,u_tl_parent:i,u_scale_parent:u,u_buffer_scale:1,u_fade_t:m.mix,u_opacity:m.opacity*b.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:b.paint.get("raster-brightness-min"),u_brightness_high:b.paint.get("raster-brightness-max"),u_saturation_factor:(k=b.paint.get("raster-saturation"),k>0?1-1/(1.001-k):-k),u_contrast_factor:(w=b.paint.get("raster-contrast"),w>0?1/(1-w):1+w),u_spin_weights:Vl(b.paint.get("raster-hue-rotate"))};var w,k};function Vl(g){g*=Math.PI/180;const i=Math.sin(g),u=Math.cos(g);return[(2*u+1)/3,(-Math.sqrt(3)*i-u+1)/3,(Math.sqrt(3)*i-u+1)/3]}const Zl=(g,i,u,m,b,w,k,Z,J,se)=>{const he=b.transform;return{u_is_size_zoom_constant:+("constant"===g||"source"===g),u_is_size_feature_constant:+("constant"===g||"camera"===g),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:he.cameraToCenterDistance,u_pitch:he.pitch/360*2*Math.PI,u_rotate_symbol:+u,u_aspect_ratio:he.width/he.height,u_fade_change:b.options.fadeDuration?b.symbolFadeChange:1,u_matrix:w,u_label_plane_matrix:k,u_coord_matrix:Z,u_is_text:+J,u_pitch_with_map:+m,u_texsize:se,u_texture:0}},ml=(g,i,u,m,b,w,k,Z,J,se,he)=>{const{cameraToCenterDistance:be,_pitch:Ce}=b.transform;return l.extend(Zl(g,i,u,m,b,w,k,Z,J,se),{u_gamma_scale:m?be*Math.cos(b.terrain?0:Ce):1,u_device_pixel_ratio:l.exported.devicePixelRatio,u_is_halo:+he})},Ka=(g,i,u,m,b,w,k,Z,J,se)=>l.extend(ml(g,i,u,m,b,w,k,Z,!0,J,!0),{u_texsize_icon:se,u_texture_icon:1}),_a=(g,i,u)=>({u_matrix:g,u_opacity:i,u_color:u}),Xa=(g,i,u,m,b,w)=>l.extend(function(k,Z,J,se){const he=J.imageManager.getPattern(k.from.toString()),be=J.imageManager.getPattern(k.to.toString()),{width:Ce,height:Me}=J.imageManager.getPixelSize(),Ve=Math.pow(2,se.tileID.overscaledZ),qe=se.tileSize*Math.pow(2,J.transform.tileZoom)/Ve,ht=qe*(se.tileID.canonical.x+se.tileID.wrap*Ve),Be=qe*se.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:he.tl,u_pattern_br_a:he.br,u_pattern_tl_b:be.tl,u_pattern_br_b:be.br,u_texsize:[Ce,Me],u_mix:Z.t,u_pattern_size_a:he.displaySize,u_pattern_size_b:be.displaySize,u_scale_a:Z.fromScale,u_scale_b:Z.toScale,u_tile_units_to_pixels:1/bn(se,1,J.transform.tileZoom),u_pixel_coord_upper:[ht>>16,Be>>16],u_pixel_coord_lower:[65535&ht,65535&Be]}}(m,w,u,b),{u_matrix:g,u_opacity:i}),Mn={fillExtrusion:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_lightpos:new l.Uniform3f(g,i.u_lightpos),u_lightintensity:new l.Uniform1f(g,i.u_lightintensity),u_lightcolor:new l.Uniform3f(g,i.u_lightcolor),u_vertical_gradient:new l.Uniform1f(g,i.u_vertical_gradient),u_opacity:new l.Uniform1f(g,i.u_opacity)}),fillExtrusionPattern:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_lightpos:new l.Uniform3f(g,i.u_lightpos),u_lightintensity:new l.Uniform1f(g,i.u_lightintensity),u_lightcolor:new l.Uniform3f(g,i.u_lightcolor),u_vertical_gradient:new l.Uniform1f(g,i.u_vertical_gradient),u_height_factor:new l.Uniform1f(g,i.u_height_factor),u_image:new l.Uniform1i(g,i.u_image),u_texsize:new l.Uniform2f(g,i.u_texsize),u_pixel_coord_upper:new l.Uniform2f(g,i.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(g,i.u_pixel_coord_lower),u_scale:new l.Uniform3f(g,i.u_scale),u_fade:new l.Uniform1f(g,i.u_fade),u_opacity:new l.Uniform1f(g,i.u_opacity)}),fill:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix)}),fillPattern:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_image:new l.Uniform1i(g,i.u_image),u_texsize:new l.Uniform2f(g,i.u_texsize),u_pixel_coord_upper:new l.Uniform2f(g,i.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(g,i.u_pixel_coord_lower),u_scale:new l.Uniform3f(g,i.u_scale),u_fade:new l.Uniform1f(g,i.u_fade)}),fillOutline:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_world:new l.Uniform2f(g,i.u_world)}),fillOutlinePattern:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_world:new l.Uniform2f(g,i.u_world),u_image:new l.Uniform1i(g,i.u_image),u_texsize:new l.Uniform2f(g,i.u_texsize),u_pixel_coord_upper:new l.Uniform2f(g,i.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(g,i.u_pixel_coord_lower),u_scale:new l.Uniform3f(g,i.u_scale),u_fade:new l.Uniform1f(g,i.u_fade)}),circle:(g,i)=>({u_camera_to_center_distance:new l.Uniform1f(g,i.u_camera_to_center_distance),u_extrude_scale:new l.Uniform2f(g,i.u_extrude_scale),u_device_pixel_ratio:new l.Uniform1f(g,i.u_device_pixel_ratio),u_matrix:new l.UniformMatrix4f(g,i.u_matrix)}),collisionBox:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_camera_to_center_distance:new l.Uniform1f(g,i.u_camera_to_center_distance),u_extrude_scale:new l.Uniform2f(g,i.u_extrude_scale)}),collisionCircle:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_inv_matrix:new l.UniformMatrix4f(g,i.u_inv_matrix),u_camera_to_center_distance:new l.Uniform1f(g,i.u_camera_to_center_distance),u_viewport_size:new l.Uniform2f(g,i.u_viewport_size)}),debug:(g,i)=>({u_color:new l.UniformColor(g,i.u_color),u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_overlay:new l.Uniform1i(g,i.u_overlay),u_overlay_scale:new l.Uniform1f(g,i.u_overlay_scale)}),clippingMask:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix)}),heatmap:(g,i)=>({u_extrude_scale:new l.Uniform1f(g,i.u_extrude_scale),u_intensity:new l.Uniform1f(g,i.u_intensity),u_matrix:new l.UniformMatrix4f(g,i.u_matrix)}),heatmapTexture:(g,i)=>({u_image:new l.Uniform1i(g,i.u_image),u_color_ramp:new l.Uniform1i(g,i.u_color_ramp),u_opacity:new l.Uniform1f(g,i.u_opacity)}),hillshade:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_image:new l.Uniform1i(g,i.u_image),u_latrange:new l.Uniform2f(g,i.u_latrange),u_light:new l.Uniform2f(g,i.u_light),u_shadow:new l.UniformColor(g,i.u_shadow),u_highlight:new l.UniformColor(g,i.u_highlight),u_accent:new l.UniformColor(g,i.u_accent)}),hillshadePrepare:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_image:new l.Uniform1i(g,i.u_image),u_dimension:new l.Uniform2f(g,i.u_dimension),u_zoom:new l.Uniform1f(g,i.u_zoom),u_unpack:new l.Uniform4f(g,i.u_unpack)}),line:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_ratio:new l.Uniform1f(g,i.u_ratio),u_device_pixel_ratio:new l.Uniform1f(g,i.u_device_pixel_ratio),u_units_to_pixels:new l.Uniform2f(g,i.u_units_to_pixels),u_dash_image:new l.Uniform1i(g,i.u_dash_image),u_gradient_image:new l.Uniform1i(g,i.u_gradient_image),u_image_height:new l.Uniform1f(g,i.u_image_height),u_texsize:new l.Uniform2f(g,i.u_texsize),u_scale:new l.Uniform3f(g,i.u_scale),u_mix:new l.Uniform1f(g,i.u_mix)}),linePattern:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_texsize:new l.Uniform2f(g,i.u_texsize),u_ratio:new l.Uniform1f(g,i.u_ratio),u_device_pixel_ratio:new l.Uniform1f(g,i.u_device_pixel_ratio),u_image:new l.Uniform1i(g,i.u_image),u_units_to_pixels:new l.Uniform2f(g,i.u_units_to_pixels),u_scale:new l.Uniform3f(g,i.u_scale),u_fade:new l.Uniform1f(g,i.u_fade)}),raster:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_tl_parent:new l.Uniform2f(g,i.u_tl_parent),u_scale_parent:new l.Uniform1f(g,i.u_scale_parent),u_buffer_scale:new l.Uniform1f(g,i.u_buffer_scale),u_fade_t:new l.Uniform1f(g,i.u_fade_t),u_opacity:new l.Uniform1f(g,i.u_opacity),u_image0:new l.Uniform1i(g,i.u_image0),u_image1:new l.Uniform1i(g,i.u_image1),u_brightness_low:new l.Uniform1f(g,i.u_brightness_low),u_brightness_high:new l.Uniform1f(g,i.u_brightness_high),u_saturation_factor:new l.Uniform1f(g,i.u_saturation_factor),u_contrast_factor:new l.Uniform1f(g,i.u_contrast_factor),u_spin_weights:new l.Uniform3f(g,i.u_spin_weights)}),symbolIcon:(g,i)=>({u_is_size_zoom_constant:new l.Uniform1i(g,i.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(g,i.u_is_size_feature_constant),u_size_t:new l.Uniform1f(g,i.u_size_t),u_size:new l.Uniform1f(g,i.u_size),u_camera_to_center_distance:new l.Uniform1f(g,i.u_camera_to_center_distance),u_pitch:new l.Uniform1f(g,i.u_pitch),u_rotate_symbol:new l.Uniform1i(g,i.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(g,i.u_aspect_ratio),u_fade_change:new l.Uniform1f(g,i.u_fade_change),u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(g,i.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(g,i.u_coord_matrix),u_is_text:new l.Uniform1i(g,i.u_is_text),u_pitch_with_map:new l.Uniform1i(g,i.u_pitch_with_map),u_texsize:new l.Uniform2f(g,i.u_texsize),u_texture:new l.Uniform1i(g,i.u_texture)}),symbolSDF:(g,i)=>({u_is_size_zoom_constant:new l.Uniform1i(g,i.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(g,i.u_is_size_feature_constant),u_size_t:new l.Uniform1f(g,i.u_size_t),u_size:new l.Uniform1f(g,i.u_size),u_camera_to_center_distance:new l.Uniform1f(g,i.u_camera_to_center_distance),u_pitch:new l.Uniform1f(g,i.u_pitch),u_rotate_symbol:new l.Uniform1i(g,i.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(g,i.u_aspect_ratio),u_fade_change:new l.Uniform1f(g,i.u_fade_change),u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(g,i.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(g,i.u_coord_matrix),u_is_text:new l.Uniform1i(g,i.u_is_text),u_pitch_with_map:new l.Uniform1i(g,i.u_pitch_with_map),u_texsize:new l.Uniform2f(g,i.u_texsize),u_texture:new l.Uniform1i(g,i.u_texture),u_gamma_scale:new l.Uniform1f(g,i.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(g,i.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(g,i.u_is_halo)}),symbolTextAndIcon:(g,i)=>({u_is_size_zoom_constant:new l.Uniform1i(g,i.u_is_size_zoom_constant),u_is_size_feature_constant:new l.Uniform1i(g,i.u_is_size_feature_constant),u_size_t:new l.Uniform1f(g,i.u_size_t),u_size:new l.Uniform1f(g,i.u_size),u_camera_to_center_distance:new l.Uniform1f(g,i.u_camera_to_center_distance),u_pitch:new l.Uniform1f(g,i.u_pitch),u_rotate_symbol:new l.Uniform1i(g,i.u_rotate_symbol),u_aspect_ratio:new l.Uniform1f(g,i.u_aspect_ratio),u_fade_change:new l.Uniform1f(g,i.u_fade_change),u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_label_plane_matrix:new l.UniformMatrix4f(g,i.u_label_plane_matrix),u_coord_matrix:new l.UniformMatrix4f(g,i.u_coord_matrix),u_is_text:new l.Uniform1i(g,i.u_is_text),u_pitch_with_map:new l.Uniform1i(g,i.u_pitch_with_map),u_texsize:new l.Uniform2f(g,i.u_texsize),u_texsize_icon:new l.Uniform2f(g,i.u_texsize_icon),u_texture:new l.Uniform1i(g,i.u_texture),u_texture_icon:new l.Uniform1i(g,i.u_texture_icon),u_gamma_scale:new l.Uniform1f(g,i.u_gamma_scale),u_device_pixel_ratio:new l.Uniform1f(g,i.u_device_pixel_ratio),u_is_halo:new l.Uniform1i(g,i.u_is_halo)}),background:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_opacity:new l.Uniform1f(g,i.u_opacity),u_color:new l.UniformColor(g,i.u_color)}),backgroundPattern:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_opacity:new l.Uniform1f(g,i.u_opacity),u_image:new l.Uniform1i(g,i.u_image),u_pattern_tl_a:new l.Uniform2f(g,i.u_pattern_tl_a),u_pattern_br_a:new l.Uniform2f(g,i.u_pattern_br_a),u_pattern_tl_b:new l.Uniform2f(g,i.u_pattern_tl_b),u_pattern_br_b:new l.Uniform2f(g,i.u_pattern_br_b),u_texsize:new l.Uniform2f(g,i.u_texsize),u_mix:new l.Uniform1f(g,i.u_mix),u_pattern_size_a:new l.Uniform2f(g,i.u_pattern_size_a),u_pattern_size_b:new l.Uniform2f(g,i.u_pattern_size_b),u_scale_a:new l.Uniform1f(g,i.u_scale_a),u_scale_b:new l.Uniform1f(g,i.u_scale_b),u_pixel_coord_upper:new l.Uniform2f(g,i.u_pixel_coord_upper),u_pixel_coord_lower:new l.Uniform2f(g,i.u_pixel_coord_lower),u_tile_units_to_pixels:new l.Uniform1f(g,i.u_tile_units_to_pixels)}),terrainRaster:Io,terrainDepth:Io,skybox:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_sun_direction:new l.Uniform3f(g,i.u_sun_direction),u_cubemap:new l.Uniform1i(g,i.u_cubemap),u_opacity:new l.Uniform1f(g,i.u_opacity),u_temporal_offset:new l.Uniform1f(g,i.u_temporal_offset)}),skyboxGradient:(g,i)=>({u_matrix:new l.UniformMatrix4f(g,i.u_matrix),u_color_ramp:new l.Uniform1i(g,i.u_color_ramp),u_center_direction:new l.Uniform3f(g,i.u_center_direction),u_radius:new l.Uniform1f(g,i.u_radius),u_opacity:new l.Uniform1f(g,i.u_opacity),u_temporal_offset:new l.Uniform1f(g,i.u_temporal_offset)}),skyboxCapture:(g,i)=>({u_matrix_3f:new l.UniformMatrix3f(g,i.u_matrix_3f),u_sun_direction:new l.Uniform3f(g,i.u_sun_direction),u_sun_intensity:new l.Uniform1f(g,i.u_sun_intensity),u_color_tint_r:new l.Uniform4f(g,i.u_color_tint_r),u_color_tint_m:new l.Uniform4f(g,i.u_color_tint_m),u_luminance:new l.Uniform1f(g,i.u_luminance)})};let Ui;function Hs(g,i,u,m,b,w,k){const Z=g.context,J=Z.gl,se=g.useProgram("collisionBox"),he=[];let be=0,Ce=0;for(let dt=0;dt<m.length;dt++){const _t=m[dt],wt=i.getTile(_t),nt=wt.getBucket(u);if(!nt)continue;let Pt=_t.projMatrix;0===b[0]&&0===b[1]||(Pt=g.translatePosMatrix(_t.projMatrix,wt,b,w));const dn=k?nt.textCollisionBox:nt.iconCollisionBox,wn=nt.collisionCircleArray;if(wn.length>0){const Rt=l.create$1(),sn=Pt;l.mul$1(Rt,nt.placementInvProjMatrix,g.transform.glCoordMatrix),l.mul$1(Rt,Rt,nt.placementViewportMatrix),he.push({circleArray:wn,circleOffset:Ce,transform:sn,invTransform:Rt}),be+=wn.length/4,Ce=be}dn&&(g.terrain&&g.terrain.setupElevationDraw(wt,se),se.draw(Z,J.LINES,l.DepthMode.disabled,l.StencilMode.disabled,g.colorModeForRenderPass(),l.CullFaceMode.disabled,go(Pt,g.transform,wt),u.id,dn.layoutVertexBuffer,dn.indexBuffer,dn.segments,null,g.transform.zoom,null,dn.collisionVertexBuffer,dn.collisionVertexBufferExt))}if(!k||!he.length)return;const Me=g.useProgram("collisionCircle"),Ve=new l.StructArrayLayout2f1f2i16;Ve.resize(4*be),Ve._trim();let qe=0;for(const dt of he)for(let _t=0;_t<dt.circleArray.length/4;_t++){const wt=4*_t,nt=dt.circleArray[wt+0],Pt=dt.circleArray[wt+1],dn=dt.circleArray[wt+2],wn=dt.circleArray[wt+3];Ve.emplace(qe++,nt,Pt,dn,wn,0),Ve.emplace(qe++,nt,Pt,dn,wn,1),Ve.emplace(qe++,nt,Pt,dn,wn,2),Ve.emplace(qe++,nt,Pt,dn,wn,3)}(!Ui||Ui.length<2*be)&&(Ui=function(dt){const _t=2*dt,wt=new l.StructArrayLayout3ui6;wt.resize(_t),wt._trim();for(let nt=0;nt<_t;nt++){const Pt=6*nt;wt.uint16[Pt+0]=4*nt+0,wt.uint16[Pt+1]=4*nt+1,wt.uint16[Pt+2]=4*nt+2,wt.uint16[Pt+3]=4*nt+2,wt.uint16[Pt+4]=4*nt+3,wt.uint16[Pt+5]=4*nt+0}return wt}(be));const ht=Z.createIndexBuffer(Ui,!0),Be=Z.createVertexBuffer(Ve,l.collisionCircleLayout.members,!0);for(const dt of he){const _t={u_matrix:dt.transform,u_inv_matrix:dt.invTransform,u_camera_to_center_distance:(Je=g.transform).cameraToCenterDistance,u_viewport_size:[Je.width,Je.height]};Me.draw(Z,J.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,g.colorModeForRenderPass(),l.CullFaceMode.disabled,_t,u.id,Be,ht,l.SegmentVector.simpleSegment(0,2*dt.circleOffset,dt.circleArray.length,dt.circleArray.length/2),null,g.transform.zoom,null,null,null)}var Je;Be.destroy(),ht.destroy()}const vr=l.identity(new Float32Array(16));function Jo(g,i,u,m,b,w){const{horizontalAlign:k,verticalAlign:Z}=l.getAnchorAlignment(g),J=-(k-.5)*i,se=-(Z-.5)*u,he=l.evaluateVariableOffset(g,m);return new l.pointGeometry((J/b+he[0])*w,(se/b+he[1])*w)}function Do(g,i,u,m,b,w,k,Z,J,se,he,be){const Ce=g.text.placedSymbolArray,Me=g.text.dynamicLayoutVertexArray,Ve=g.icon.dynamicLayoutVertexArray,qe={};Me.clear();for(let ht=0;ht<Ce.length;ht++){const Be=Ce.get(ht),Je=g.allowVerticalPlacement&&!Be.placedOrientation,dt=Be.hidden||!Be.crossTileID||Je?null:m[Be.crossTileID];if(dt){const _t=new l.pointGeometry(Be.tileAnchorX,Be.tileAnchorY),wt=be(_t),nt=Ci(_t,u?Z:k,wt),Pt=ui(w.cameraToCenterDistance,nt.signedDistanceFromCamera);let dn=b.evaluateSizeForFeature(g.textSizeData,se,Be)*Pt/l.ONE_EM;u&&(dn*=g.tilePixelRatio/J);const{width:wn,height:Rt,anchor:sn,textOffset:$n,textScale:Kn}=dt,Gn=Jo(sn,wn,Rt,$n,Kn,dn),Pn=u?Ci(_t.add(Gn),k,wt).point:nt.point.add(i?Gn.rotate(-w.angle):Gn),Xn=g.allowVerticalPlacement&&Be.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let qi=0;qi<Be.numGlyphs;qi++)l.addDynamicAttributes(Me,Pn,Xn);he&&Be.associatedIconIndex>=0&&(qe[Be.associatedIconIndex]={shiftedAnchor:Pn,angle:Xn})}else Ee(Be.numGlyphs,Me)}if(he){Ve.clear();const ht=g.icon.placedSymbolArray;for(let Be=0;Be<ht.length;Be++){const Je=ht.get(Be);if(Je.hidden)Ee(Je.numGlyphs,Ve);else{const dt=qe[Be];if(dt)for(let _t=0;_t<Je.numGlyphs;_t++)l.addDynamicAttributes(Ve,dt.shiftedAnchor,dt.angle);else Ee(Je.numGlyphs,Ve)}}g.icon.dynamicLayoutVertexBuffer.updateData(Ve)}g.text.dynamicLayoutVertexBuffer.updateData(Me)}function Vr(g,i,u){return u.iconsInText&&i?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function Ko(g,i,u,m,b,w,k,Z,J,se,he,be){const Ce=g.context,Me=Ce.gl,Ve=g.transform,qe="map"===Z,ht="map"===J,Be=qe&&"point"!==u.layout.get("symbol-placement"),Je=qe&&!ht&&!Be,dt=void 0!==u.layout.get("symbol-sort-key").constantOr(1);let _t=!1;const wt=g.depthModeForSublayer(0,l.DepthMode.ReadOnly),nt=u.layout.get("text-variable-anchor"),Pt=[],dn=g.terrain&&ht?["PITCH_WITH_MAP_TERRAIN"]:null;for(const wn of m){const Rt=i.getTile(wn),sn=Rt.getBucket(u);if(!sn)continue;const $n=b?sn.text:sn.icon;if(!$n||!$n.segments.get().length)continue;const Kn=$n.programConfigurations.get(u.id),Gn=b||sn.sdfIcons,Pn=b?sn.textSizeData:sn.iconSizeData,Xn=ht||0!==Ve.pitch,qi=g.useProgram(Vr(Gn,b,sn),Kn,dn),Li=l.evaluateSizeForZoom(Pn,Ve.zoom);let Hr,$r,ki,Qi,Qr=[0,0],Ys=null;if(b){if($r=Rt.glyphAtlasTexture,ki=Me.LINEAR,Hr=Rt.glyphAtlasTexture.size,sn.iconsInText){Qr=Rt.imageAtlasTexture.size,Ys=Rt.imageAtlasTexture;const Bs="composite"===Pn.kind||"camera"===Pn.kind;Qi=Xn||g.options.rotating||g.options.zooming||Bs?Me.LINEAR:Me.NEAREST}}else{const Bs=1!==u.layout.get("icon-size").constantOr(0)||sn.iconsNeedLinear;$r=Rt.imageAtlasTexture,ki=Gn||g.options.rotating||g.options.zooming||Bs||Xn?Me.LINEAR:Me.NEAREST,Hr=Rt.imageAtlasTexture.size}const Js=bn(Rt,1,g.transform.zoom),zo=ti(wn.projMatrix,ht,qe,g.transform,Js),Uo=g.terrain&&ht&&Be?l.invert(new Float32Array(16),zo):vr,ds=li(wn.projMatrix,ht,qe,g.transform,Js),Ba=nt&&sn.hasTextData(),Zi="none"!==u.layout.get("icon-text-fit")&&Ba&&sn.hasIconData();if(Be){const Bs=Ve.elevation;to(sn,wn.projMatrix,g,b,zo,ds,ht,se,Bs?hs=>Bs.getAtTileOffset(wn,hs.x,hs.y):null)}const eo=g.translatePosMatrix(wn.projMatrix,Rt,w,k),Ar=Be||b&&nt||Zi?vr:zo,Br=g.translatePosMatrix(ds,Rt,w,k,!0),Vo=Gn&&0!==u.paint.get(b?"text-halo-width":"icon-halo-width").constantOr(1);let Gr;Gr=Gn?sn.iconsInText?Ka(Pn.kind,Li,Je,ht,g,eo,Ar,Br,Hr,Qr):ml(Pn.kind,Li,Je,ht,g,eo,Ar,Br,b,Hr,!0):Zl(Pn.kind,Li,Je,ht,g,eo,Ar,Br,b,Hr);const Zo={program:qi,buffers:$n,uniformValues:Gr,atlasTexture:$r,atlasTextureIcon:Ys,atlasInterpolation:ki,atlasInterpolationIcon:Qi,isSDF:Gn,hasHalo:Vo,tile:Rt,labelPlaneMatrixInv:Uo};if(dt&&sn.canOverlap){_t=!0;const Bs=$n.segments.get();for(const hs of Bs)Pt.push({segments:new l.SegmentVector([hs]),sortKey:hs.sortKey,state:Zo})}else Pt.push({segments:$n.segments,sortKey:0,state:Zo})}_t&&Pt.sort((wn,Rt)=>wn.sortKey-Rt.sortKey);for(const wn of Pt){const Rt=wn.state;if(g.terrain&&g.terrain.setupElevationDraw(Rt.tile,Rt.program,{useDepthForOcclusion:!0,labelPlaneMatrixInv:Rt.labelPlaneMatrixInv}),Ce.activeTexture.set(Me.TEXTURE0),Rt.atlasTexture.bind(Rt.atlasInterpolation,Me.CLAMP_TO_EDGE),Rt.atlasTextureIcon&&(Ce.activeTexture.set(Me.TEXTURE1),Rt.atlasTextureIcon&&Rt.atlasTextureIcon.bind(Rt.atlasInterpolationIcon,Me.CLAMP_TO_EDGE)),Rt.isSDF){const sn=Rt.uniformValues;Rt.hasHalo&&(sn.u_is_halo=1,bo(Rt.buffers,wn.segments,u,g,Rt.program,wt,he,be,sn)),sn.u_is_halo=0}bo(Rt.buffers,wn.segments,u,g,Rt.program,wt,he,be,Rt.uniformValues)}}function bo(g,i,u,m,b,w,k,Z,J){const se=m.context;b.draw(se,se.gl.TRIANGLES,w,k,Z,l.CullFaceMode.disabled,J,u.id,g.layoutVertexBuffer,g.indexBuffer,i,u.paint,m.transform.zoom,g.programConfigurations.get(u.id),g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer)}function aa(g,i,u,m,b,w,k){const Z=g.context.gl,J=u.paint.get("fill-pattern"),se=J&&J.constantOr(1),he=u.getCrossfadeParameters();let be,Ce,Me,Ve,qe;k?(Ce=se&&!u.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",be=Z.LINES):(Ce=se?"fillPattern":"fill",be=Z.TRIANGLES);for(const ht of m){const Be=i.getTile(ht);if(se&&!Be.patternsLoaded())continue;const Je=Be.getBucket(u);if(!Je)continue;g.prepareDrawTile(ht);const dt=Je.programConfigurations.get(u.id),_t=g.useProgram(Ce,dt);se&&(g.context.activeTexture.set(Z.TEXTURE0),Be.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),dt.updatePaintBuffers(he));const wt=J.constantOr(null);if(wt&&Be.imageAtlas){const Pt=Be.imageAtlas,dn=Pt.patternPositions[wt.to.toString()],wn=Pt.patternPositions[wt.from.toString()];dn&&wn&&dt.setConstantPatternPositions(dn,wn)}const nt=g.translatePosMatrix(ht.projMatrix,Be,u.paint.get("fill-translate"),u.paint.get("fill-translate-anchor"));if(k){Ve=Je.indexBuffer2,qe=Je.segments2;const Pt=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[Z.drawingBufferWidth,Z.drawingBufferHeight];Me="fillOutlinePattern"===Ce&&se?Ri(nt,g,he,Be,Pt):nr(nt,Pt)}else Ve=Je.indexBuffer,qe=Je.segments,Me=se?ar(nt,g,he,Be):Xi(nt);g.prepareDrawProgram(g.context,_t,ht.toUnwrapped()),_t.draw(g.context,be,b,g.stencilModeForClipping(ht),w,l.CullFaceMode.disabled,Me,u.id,Je.layoutVertexBuffer,Ve,qe,u.paint,g.transform.zoom,dt)}}function ya(g,i,u,m,b,w,k){const Z=g.context,J=Z.gl,se=u.paint.get("fill-extrusion-pattern"),he=se.constantOr(1),be=u.getCrossfadeParameters(),Ce=u.paint.get("fill-extrusion-opacity");for(const Me of m){const Ve=i.getTile(Me),qe=Ve.getBucket(u);if(!qe)continue;const ht=qe.programConfigurations.get(u.id),Be=g.useProgram(he?"fillExtrusionPattern":"fillExtrusion",ht);if(g.terrain){const nt=g.terrain;if(!qe.enableTerrain)continue;if(nt.setupElevationDraw(Ve,Be,{useMeterToDem:!0}),No(Z,i,Me,qe,u,nt),!qe.centroidVertexBuffer){const Pt=Be.attributes.a_centroid_pos;void 0!==Pt&&J.vertexAttrib2f(Pt,0,0)}}he&&(g.context.activeTexture.set(J.TEXTURE0),Ve.imageAtlasTexture.bind(J.LINEAR,J.CLAMP_TO_EDGE),ht.updatePaintBuffers(be));const Je=se.constantOr(null);if(Je&&Ve.imageAtlas){const nt=Ve.imageAtlas,Pt=nt.patternPositions[Je.to.toString()],dn=nt.patternPositions[Je.from.toString()];Pt&&dn&&ht.setConstantPatternPositions(Pt,dn)}const dt=g.translatePosMatrix(Me.projMatrix,Ve,u.paint.get("fill-extrusion-translate"),u.paint.get("fill-extrusion-translate-anchor")),_t=u.paint.get("fill-extrusion-vertical-gradient"),wt=he?wi(dt,g,_t,Ce,Me,be,Ve):Hn(dt,g,_t,Ce);g.prepareDrawProgram(Z,Be,Me.toUnwrapped()),Be.draw(Z,Z.gl.TRIANGLES,b,w,k,l.CullFaceMode.backCCW,wt,u.id,qe.layoutVertexBuffer,qe.indexBuffer,qe.segments,u.paint,g.transform.zoom,ht,g.terrain?qe.centroidVertexBuffer:null)}}function No(g,i,u,m,b,w){const k=[Be=>{let Je=Be.canonical.x-1,dt=Be.wrap;return Je<0&&(Je=(1<<Be.canonical.z)-1,dt--),new l.OverscaledTileID(Be.overscaledZ,dt,Be.canonical.z,Je,Be.canonical.y)},Be=>{let Je=Be.canonical.x+1,dt=Be.wrap;return Je===1<<Be.canonical.z&&(Je=0,dt++),new l.OverscaledTileID(Be.overscaledZ,dt,Be.canonical.z,Je,Be.canonical.y)},Be=>new l.OverscaledTileID(Be.overscaledZ,Be.wrap,Be.canonical.z,Be.canonical.x,(0===Be.canonical.y?1<<Be.canonical.z:Be.canonical.y)-1),Be=>new l.OverscaledTileID(Be.overscaledZ,Be.wrap,Be.canonical.z,Be.canonical.x,Be.canonical.y===(1<<Be.canonical.z)-1?0:Be.canonical.y+1)],Z=Be=>{const Je=i.getSource().maxzoom,dt=Pt=>{const dn=i.getTileByID(Pt);if(dn&&dn.hasData())return dn.getBucket(b)};let _t,wt,nt;return(Be.overscaledZ===Be.canonical.z||Be.overscaledZ>=Je)&&(_t=dt(Be.key)),Be.overscaledZ>=Je&&(wt=dt(Be.calculateScaledKey(Be.overscaledZ+1))),Be.overscaledZ>Je&&(nt=dt(Be.calculateScaledKey(Be.overscaledZ-1))),_t||wt||nt},J=[0,0,0],se=(Be,Je)=>(J[0]=Math.min(Be.min.y,Je.min.y),J[1]=Math.max(Be.max.y,Je.max.y),J[2]=l.EXTENT-Je.min.x>Be.max.x?Je.min.x-l.EXTENT:Be.max.x,J),he=(Be,Je)=>(J[0]=Math.min(Be.min.x,Je.min.x),J[1]=Math.max(Be.max.x,Je.max.x),J[2]=l.EXTENT-Je.min.y>Be.max.y?Je.min.y-l.EXTENT:Be.max.y,J),be=[(Be,Je)=>se(Be,Je),(Be,Je)=>se(Je,Be),(Be,Je)=>he(Be,Je),(Be,Je)=>he(Je,Be)],Ce=new l.pointGeometry(0,0);let Me,Ve,qe;const ht=(Be,Je,dt,_t,wt)=>{const nt=[[_t?dt:Be,_t?Be:dt,0],[_t?dt:Je,_t?Je:dt,0]],Pt=wt<0?l.EXTENT+wt:wt,dn=[_t?Pt:(Be+Je)/2,_t?(Be+Je)/2:Pt,0];return 0===dt&&wt<0||0!==dt&&wt>0?w.getForTilePoints(qe,[dn],!0,Ve):nt.push(dn),w.getForTilePoints(u,nt,!0,Me),Math.max(nt[0][2],nt[1][2],dn[2])/w.exaggeration()};for(let Be=0;Be<4;Be++){const Je=m.borders[Be];if(0===Je.length&&(m.borderDone[Be]=!0),m.borderDone[Be])continue;const dt=qe=k[Be](u),_t=Z(dt);if(!(_t&&_t.enableTerrain&&(Ve=w.findDEMTileFor(dt),Ve&&Ve.dem)))continue;if(!Me){const dn=w.findDEMTileFor(u);if(!dn||!dn.dem)return;Me=dn}const wt=(Be<2?1:5)-Be,nt=_t.borders[wt];let Pt=0;for(let dn=0;dn<Je.length;dn++){const wn=m.featuresOnBorder[Je[dn]],Rt=wn.borders[Be];let sn;for(;Pt<nt.length&&(sn=_t.featuresOnBorder[nt[Pt]],!(sn.borders[wt][1]>Rt[0]+3));)_t.borderDone[wt]||_t.encodeCentroid(void 0,sn,!1),Pt++;if(sn&&Pt<nt.length){const $n=Pt;let Kn=0;for(;!(sn.borders[wt][0]>Rt[1]-3)&&(Kn++,++Pt!==nt.length);)sn=_t.featuresOnBorder[nt[Pt]];if(sn=_t.featuresOnBorder[nt[$n]],wn.intersectsCount()>1||sn.intersectsCount()>1||1!==Kn){1!==Kn&&(Pt=$n),m.encodeCentroid(void 0,wn,!1),_t.borderDone[wt]||_t.encodeCentroid(void 0,sn,!1);continue}const Gn=be[Be](wn,sn),Pn=Be%2?l.EXTENT-1:0;Ce.x=ht(Gn[0],Math.min(l.EXTENT-1,Gn[1]),Pn,Be<2,Gn[2]),Ce.y=0,m.encodeCentroid(Ce,wn,!1),_t.borderDone[wt]||_t.encodeCentroid(Ce,sn,!1)}else m.encodeCentroid(void 0,wn,!1)}m.borderDone[Be]=m.needsCentroidUpdate=!0,_t.borderDone[wt]||(_t.borderDone[wt]=_t.needsCentroidUpdate=!0)}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&0!==m.centroidVertexArray.length)&&m.uploadCentroid(g)}const Ni=new l.Color(1,0,0,1),Yr=new l.Color(0,1,0,1),Gs=new l.Color(0,0,1,1),Cs=new l.Color(1,0,1,1),ro=new l.Color(0,1,1,1);function Ts(g,i,u,m){la(g,0,i+u/2,g.transform.width,u,m)}function va(g,i,u,m){la(g,i-u/2,0,u,g.transform.height,m)}function la(g,i,u,m,b,w){const k=g.context,Z=k.gl;Z.enable(Z.SCISSOR_TEST),Z.scissor(i*l.exported.devicePixelRatio,u*l.exported.devicePixelRatio,m*l.exported.devicePixelRatio,b*l.exported.devicePixelRatio),k.clear({color:w}),Z.disable(Z.SCISSOR_TEST)}function jc(g,i,u){const m=g.context,b=m.gl,w=u.projMatrix,k=g.useProgram("debug"),Z=i.getTileByID(u.key);g.terrain&&g.terrain.setupElevationDraw(Z,k);const J=l.DepthMode.disabled,se=l.StencilMode.disabled,he=g.colorModeForRenderPass();m.activeTexture.set(b.TEXTURE0),g.emptyTexture.bind(b.LINEAR,b.CLAMP_TO_EDGE),k.draw(m,b.LINE_STRIP,J,se,he,l.CullFaceMode.disabled,Lr(w,l.Color.red),"$debug",g.debugBuffer,g.tileBorderIndexBuffer,g.debugSegments);const Ce=Z.latestRawTileData,Me=Math.floor((Ce&&Ce.byteLength||0)/1024),Ve=i.getTile(u).tileSize,qe=512/Math.min(Ve,512)*(u.overscaledZ/g.transform.zoom)*.5;let ht=u.canonical.toString();u.overscaledZ!==u.canonical.z&&(ht+=` => ${u.overscaledZ}`),function(Be,Je){Be.initDebugOverlayCanvas();const dt=Be.debugOverlayCanvas,_t=Be.context.gl,wt=Be.debugOverlayCanvas.getContext("2d");wt.clearRect(0,0,dt.width,dt.height),wt.shadowColor="white",wt.shadowBlur=2,wt.lineWidth=1.5,wt.strokeStyle="white",wt.textBaseline="top",wt.font="bold 36px Open Sans, sans-serif",wt.fillText(Je,5,5),wt.strokeText(Je,5,5),Be.debugOverlayTexture.update(dt),Be.debugOverlayTexture.bind(_t.LINEAR,_t.CLAMP_TO_EDGE)}(g,`${ht} ${Me}kb`),k.draw(m,b.TRIANGLES,J,se,l.ColorMode.alphaBlended,l.CullFaceMode.disabled,Lr(w,l.Color.transparent,qe),"$debug",g.debugBuffer,g.quadTriangleIndexBuffer,g.debugSegments)}const Xo=l.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:A}=Xo;function $(g,i,u,m){g.emplaceBack(i,u,m)}class R{constructor(i){this.vertexArray=new l.StructArrayLayout3f12,this.indices=new l.StructArrayLayout3ui6,$(this.vertexArray,-1,-1,1),$(this.vertexArray,1,-1,1),$(this.vertexArray,-1,1,1),$(this.vertexArray,1,1,1),$(this.vertexArray,-1,-1,-1),$(this.vertexArray,1,-1,-1),$(this.vertexArray,-1,1,-1),$(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,A),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=l.SegmentVector.simpleSegment(0,0,36,12)}}function ue(g,i,u,m,b,w){const k=g.gl,Z=i.paint.get("sky-atmosphere-color"),J=i.paint.get("sky-atmosphere-halo-color"),se=i.paint.get("sky-atmosphere-sun-intensity"),he={u_matrix_3f:l.fromMat4([],m),u_sun_direction:b,u_sun_intensity:se,u_color_tint_r:[(Ve=Z).r,Ve.g,Ve.b,Ve.a],u_color_tint_m:[(qe=J).r,qe.g,qe.b,qe.a],u_luminance:5e-5};var Ve,qe;k.framebufferTexture2D(k.FRAMEBUFFER,k.COLOR_ATTACHMENT0,k.TEXTURE_CUBE_MAP_POSITIVE_X+w,i.skyboxTexture,0),u.draw(g,k.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.frontCW,he,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Se={symbol:function(g,i,u,m,b){if("translucent"!==g.renderPass)return;const w=l.StencilMode.disabled,k=g.colorModeForRenderPass();u.layout.get("text-variable-anchor")&&function(Z,J,se,he,be,Ce,Me){const Ve=J.transform,qe="map"===be,ht="map"===Ce;for(const Be of Z){const Je=he.getTile(Be),dt=Je.getBucket(se);if(!dt||!dt.text||!dt.text.segments.get().length)continue;const _t=l.evaluateSizeForZoom(dt.textSizeData,Ve.zoom),wt=bn(Je,1,J.transform.zoom),nt=ti(Be.projMatrix,ht,qe,J.transform,wt),Pt="none"!==se.layout.get("icon-text-fit")&&dt.hasIconData();if(_t){const dn=Math.pow(2,Ve.zoom-Je.tileID.overscaledZ),wn=Ve.elevation;Do(dt,qe,ht,Me,l.symbolSize,Ve,nt,Be.projMatrix,dn,_t,Pt,wn?Rt=>wn.getAtTileOffset(Be,Rt.x,Rt.y):Rt=>0)}}}(m,g,u,i,u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),b),0!==u.paint.get("icon-opacity").constantOr(1)&&Ko(g,i,u,m,!1,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),u.layout.get("icon-rotation-alignment"),u.layout.get("icon-pitch-alignment"),u.layout.get("icon-keep-upright"),w,k),0!==u.paint.get("text-opacity").constantOr(1)&&Ko(g,i,u,m,!0,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),u.layout.get("text-rotation-alignment"),u.layout.get("text-pitch-alignment"),u.layout.get("text-keep-upright"),w,k),i.map.showCollisionBoxes&&(Hs(g,i,u,m,u.paint.get("text-translate"),u.paint.get("text-translate-anchor"),!0),Hs(g,i,u,m,u.paint.get("icon-translate"),u.paint.get("icon-translate-anchor"),!1))},circle:function(g,i,u,m){if("translucent"!==g.renderPass)return;const b=u.paint.get("circle-opacity"),w=u.paint.get("circle-stroke-width"),k=u.paint.get("circle-stroke-opacity"),Z=void 0!==u.layout.get("circle-sort-key").constantOr(1);if(0===b.constantOr(1)&&(0===w.constantOr(1)||0===k.constantOr(1)))return;const J=g.context,se=J.gl,he=g.depthModeForSublayer(0,l.DepthMode.ReadOnly),be=l.StencilMode.disabled,Ce=g.colorModeForRenderPass(),Me=[];for(let Ve=0;Ve<m.length;Ve++){const qe=m[Ve],ht=i.getTile(qe),Be=ht.getBucket(u);if(!Be)continue;const Je=Be.programConfigurations.get(u.id),dt=Wr(u),_t={programConfiguration:Je,program:g.useProgram("circle",Je,dt),layoutVertexBuffer:Be.layoutVertexBuffer,indexBuffer:Be.indexBuffer,uniformValues:Dr(g,qe,ht,u),tile:ht};if(Z){const wt=Be.segments.get();for(const nt of wt)Me.push({segments:new l.SegmentVector([nt]),sortKey:nt.sortKey,state:_t})}else Me.push({segments:Be.segments,sortKey:0,state:_t})}Z&&Me.sort((Ve,qe)=>Ve.sortKey-qe.sortKey);for(const Ve of Me){const{programConfiguration:qe,program:ht,layoutVertexBuffer:Be,indexBuffer:Je,uniformValues:dt,tile:_t}=Ve.state,wt=Ve.segments;g.terrain&&g.terrain.setupElevationDraw(_t,ht,{useDepthForOcclusion:!0}),g.prepareDrawProgram(J,ht,_t.tileID.toUnwrapped()),ht.draw(J,se.TRIANGLES,he,be,Ce,l.CullFaceMode.disabled,dt,u.id,Be,Je,wt,u.paint,g.transform.zoom,qe)}},heatmap:function(g,i,u,m){if(0!==u.paint.get("heatmap-opacity"))if("offscreen"===g.renderPass){const b=g.context,w=b.gl,k=l.StencilMode.disabled,Z=new l.ColorMode([w.ONE,w.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(J,se,he){const be=J.gl;J.activeTexture.set(be.TEXTURE1),J.viewport.set([0,0,se.width/4,se.height/4]);let Ce=he.heatmapFbo;if(Ce)be.bindTexture(be.TEXTURE_2D,Ce.colorAttachment.get()),J.bindFramebuffer.set(Ce.framebuffer);else{const Me=be.createTexture();be.bindTexture(be.TEXTURE_2D,Me),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_S,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_WRAP_T,be.CLAMP_TO_EDGE),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MIN_FILTER,be.LINEAR),be.texParameteri(be.TEXTURE_2D,be.TEXTURE_MAG_FILTER,be.LINEAR),Ce=he.heatmapFbo=J.createFramebuffer(se.width/4,se.height/4,!1),function(Ve,qe,ht,Be){const Je=Ve.gl;Je.texImage2D(Je.TEXTURE_2D,0,Je.RGBA,qe.width/4,qe.height/4,0,Je.RGBA,Ve.extRenderToTextureHalfFloat?Ve.extTextureHalfFloat.HALF_FLOAT_OES:Je.UNSIGNED_BYTE,null),Be.colorAttachment.set(ht)}(J,se,Me,Ce)}})(b,g,u),b.clear({color:l.Color.transparent});for(let J=0;J<m.length;J++){const se=m[J];if(i.hasRenderableParent(se))continue;const he=i.getTile(se),be=he.getBucket(u);if(!be)continue;const Ce=be.programConfigurations.get(u.id),Me=g.useProgram("heatmap",Ce),{zoom:Ve}=g.transform;g.terrain&&g.terrain.setupElevationDraw(he,Me),g.prepareDrawProgram(b,Me,se.toUnwrapped()),Me.draw(b,w.TRIANGLES,l.DepthMode.disabled,k,Z,l.CullFaceMode.disabled,Ls(se.projMatrix,he,Ve,u.paint.get("heatmap-intensity")),u.id,be.layoutVertexBuffer,be.indexBuffer,be.segments,u.paint,g.transform.zoom,Ce)}b.viewport.set([0,0,g.width,g.height])}else"translucent"===g.renderPass&&(g.context.setColorMode(g.colorModeForRenderPass()),function(b,w){const k=b.context,Z=k.gl,J=w.heatmapFbo;if(!J)return;k.activeTexture.set(Z.TEXTURE0),Z.bindTexture(Z.TEXTURE_2D,J.colorAttachment.get()),k.activeTexture.set(Z.TEXTURE1);let se=w.colorRampTexture;se||(se=w.colorRampTexture=new l.Texture(k,w.colorRamp,Z.RGBA)),se.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),b.useProgram("heatmapTexture").draw(k,Z.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,b.colorModeForRenderPass(),l.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:w.paint.get("heatmap-opacity")},w.id,b.viewportBuffer,b.quadTriangleIndexBuffer,b.viewportSegments,w.paint,b.transform.zoom)}(g,u))},line:function(g,i,u,m){if("translucent"!==g.renderPass)return;const b=u.paint.get("line-opacity"),w=u.paint.get("line-width");if(0===b.constantOr(1)||0===w.constantOr(1))return;const k=g.depthModeForSublayer(0,l.DepthMode.ReadOnly),Z=g.colorModeForRenderPass(),J=u.paint.get("line-dasharray"),se=J.constantOr(1),he=u.layout.get("line-cap"),be=u.paint.get("line-pattern"),Ce=be.constantOr(1),Me=u.paint.get("line-gradient"),Ve=u.getCrossfadeParameters(),qe=Ce?"linePattern":"line",ht=g.context,Be=ht.gl;for(const Je of m){const dt=i.getTile(Je);if(Ce&&!dt.patternsLoaded())continue;const _t=dt.getBucket(u);if(!_t)continue;g.prepareDrawTile(Je);const wt=_t.programConfigurations.get(u.id),nt=ws(u),Pt=g.useProgram(qe,wt,nt),dn=be.constantOr(null);if(dn&&dt.imageAtlas){const Kn=dt.imageAtlas,Gn=Kn.patternPositions[dn.to.toString()],Pn=Kn.patternPositions[dn.from.toString()];Gn&&Pn&&wt.setConstantPatternPositions(Gn,Pn)}const wn=J.constantOr(null),Rt=he.constantOr(null);if(!Ce&&wn&&Rt&&dt.lineAtlas){const Kn=dt.lineAtlas,Gn=Kn.getDash(wn.to,Rt),Pn=Kn.getDash(wn.from,Rt);Gn&&Pn&&wt.setConstantPatternPositions(Gn,Pn)}const sn=g.terrain?Je.projMatrix:null,$n=Ce?sa(g,dt,u,Ve,sn):qo(g,dt,u,Ve,sn,_t.lineClipsArray.length);if(Me){const Kn=_t.gradients[u.id];let Gn=Kn.texture;if(u.gradientVersion!==Kn.version){let Pn=256;if(u.stepInterpolant){const Xn=i.getSource().maxzoom,qi=Je.canonical.z===Xn?Math.ceil(1<<g.transform.maxZoom-Je.canonical.z):1;Pn=l.clamp(l.nextPowerOfTwo(_t.maxLineLength/l.EXTENT*1024*qi),256,ht.maxTextureSize)}Kn.gradient=l.renderColorRamp({expression:u.gradientExpression(),evaluationKey:"lineProgress",resolution:Pn,image:Kn.gradient||void 0,clips:_t.lineClipsArray}),Kn.texture?Kn.texture.update(Kn.gradient):Kn.texture=new l.Texture(ht,Kn.gradient,Be.RGBA),Kn.version=u.gradientVersion,Gn=Kn.texture}ht.activeTexture.set(Be.TEXTURE1),Gn.bind(u.stepInterpolant?Be.NEAREST:Be.LINEAR,Be.CLAMP_TO_EDGE)}se&&(ht.activeTexture.set(Be.TEXTURE0),dt.lineAtlasTexture.bind(Be.LINEAR,Be.REPEAT),wt.updatePaintBuffers(Ve)),Ce&&(ht.activeTexture.set(Be.TEXTURE0),dt.imageAtlasTexture.bind(Be.LINEAR,Be.CLAMP_TO_EDGE),wt.updatePaintBuffers(Ve)),g.prepareDrawProgram(ht,Pt,Je.toUnwrapped()),Pt.draw(ht,Be.TRIANGLES,k,g.stencilModeForClipping(Je),Z,l.CullFaceMode.disabled,$n,u.id,_t.layoutVertexBuffer,_t.indexBuffer,_t.segments,u.paint,g.transform.zoom,wt,_t.layoutVertexBuffer2)}},fill:function(g,i,u,m){const b=u.paint.get("fill-color"),w=u.paint.get("fill-opacity");if(0===w.constantOr(1))return;const k=g.colorModeForRenderPass(),Z=u.paint.get("fill-pattern"),J=g.opaquePassEnabledForLayer()&&!Z.constantOr(1)&&1===b.constantOr(l.Color.transparent).a&&1===w.constantOr(0)?"opaque":"translucent";if(g.renderPass===J){const se=g.depthModeForSublayer(1,"opaque"===g.renderPass?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly);aa(g,i,u,m,se,k,!1)}if("translucent"===g.renderPass&&u.paint.get("fill-antialias")){const se=g.depthModeForSublayer(u.getPaintProperty("fill-outline-color")?2:0,l.DepthMode.ReadOnly);aa(g,i,u,m,se,k,!0)}},"fill-extrusion":function(g,i,u,m){const b=u.paint.get("fill-extrusion-opacity");if(0!==b&&"translucent"===g.renderPass){const w=new l.DepthMode(g.context.gl.LEQUAL,l.DepthMode.ReadWrite,g.depthRangeFor3D);if(1!==b||u.paint.get("fill-extrusion-pattern").constantOr(1))ya(g,i,u,m,w,l.StencilMode.disabled,l.ColorMode.disabled),ya(g,i,u,m,w,g.stencilModeFor3D(),g.colorModeForRenderPass());else{const k=g.colorModeForRenderPass();ya(g,i,u,m,w,l.StencilMode.disabled,k)}}},hillshade:function(g,i,u,m){if("offscreen"!==g.renderPass&&"translucent"!==g.renderPass)return;const b=g.context,w=g.depthModeForSublayer(0,l.DepthMode.ReadOnly),k=g.colorModeForRenderPass(),Z=g.terrain&&g.terrain.renderingToTexture,[J,se]="translucent"!==g.renderPass||Z?[{},m]:g.stencilConfigForOverlap(m);for(const he of se){const be=i.getTile(he);if(be.needsHillshadePrepare&&"offscreen"===g.renderPass)Gi(g,be,u,w,l.StencilMode.disabled,k);else if("translucent"===g.renderPass){const Ce=Z&&g.terrain?g.terrain.stencilModeForRTTOverlap(he):J[he.overscaledZ];dr(g,he,be,u,w,Ce,k)}}b.viewport.set([0,0,g.width,g.height])},raster:function(g,i,u,m,b,w){if("translucent"!==g.renderPass||0===u.paint.get("raster-opacity")||!m.length)return;const k=g.context,Z=k.gl,J=i.getSource(),se=g.useProgram("raster"),he=g.colorModeForRenderPass(),be=g.terrain&&g.terrain.renderingToTexture,[Ce,Me]=J instanceof re||be?[{},m]:g.stencilConfigForOverlap(m),Ve=Me[Me.length-1].overscaledZ,qe=!g.options.moving;for(const ht of Me){const Be=be?l.DepthMode.disabled:g.depthModeForSublayer(ht.overscaledZ-Ve,1===u.paint.get("raster-opacity")?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly,Z.LESS),Je=ht.toUnwrapped(),dt=i.getTile(ht);if(be&&(!dt||!dt.hasData()))continue;const _t=be?ht.projMatrix:g.transform.calculateProjMatrix(Je,qe),wt=g.terrain&&be?g.terrain.stencilModeForRTTOverlap(ht):Ce[ht.overscaledZ],nt=w?0:u.paint.get("raster-fade-duration");dt.registerFadeDuration(nt);const Pt=i.findLoadedParent(ht,0),dn=ae(dt,Pt,i,g.transform,nt);let wn,Rt;g.terrain&&g.terrain.prepareDrawTile(ht);const sn="nearest"===u.paint.get("raster-resampling")?Z.NEAREST:Z.LINEAR;k.activeTexture.set(Z.TEXTURE0),dt.texture.bind(sn,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),k.activeTexture.set(Z.TEXTURE1),Pt?(Pt.texture.bind(sn,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST),wn=Math.pow(2,Pt.tileID.overscaledZ-dt.tileID.overscaledZ),Rt=[dt.tileID.canonical.x*wn%1,dt.tileID.canonical.y*wn%1]):dt.texture.bind(sn,Z.CLAMP_TO_EDGE,Z.LINEAR_MIPMAP_NEAREST);const $n=qs(_t,Rt||[0,0],wn||1,dn,u);g.prepareDrawProgram(k,se,Je),J instanceof re?se.draw(k,Z.TRIANGLES,Be,l.StencilMode.disabled,he,l.CullFaceMode.disabled,$n,u.id,J.boundsBuffer,g.quadTriangleIndexBuffer,J.boundsSegments):se.draw(k,Z.TRIANGLES,Be,wt,he,l.CullFaceMode.disabled,$n,u.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}},background:function(g,i,u,m){const b=u.paint.get("background-color"),w=u.paint.get("background-opacity");if(0===w)return;const k=g.context,Z=k.gl,J=g.transform,se=J.tileSize,he=u.paint.get("background-pattern");if(g.isPatternMissing(he))return;const be=!he&&1===b.a&&1===w&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==be)return;const Ce=l.StencilMode.disabled,Me=g.depthModeForSublayer(0,"opaque"===be?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly),Ve=g.colorModeForRenderPass(),qe=g.useProgram(he?"backgroundPattern":"background"),ht=m||J.coveringTiles({tileSize:se});he&&(k.activeTexture.set(Z.TEXTURE0),g.imageManager.bind(g.context));const Be=u.getCrossfadeParameters();for(const Je of ht){const dt=Je.toUnwrapped(),_t=m?Je.projMatrix:g.transform.calculateProjMatrix(dt);g.prepareDrawTile(Je);const wt=he?Xa(_t,w,g,he,{tileID:Je,tileSize:se},Be):_a(_t,w,b);g.prepareDrawProgram(k,qe,dt),qe.draw(k,Z.TRIANGLES,Me,Ce,Ve,l.CullFaceMode.disabled,wt,u.id,g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}},sky:function(g,i,u){const m=u.paint.get("sky-opacity");if(0===m)return;const b=g.context,w=u.paint.get("sky-type"),k=new l.DepthMode(b.gl.LEQUAL,l.DepthMode.ReadOnly,[0,1]),Z=g.frameCounter/1e3%1;"atmosphere"===w?"offscreen"===g.renderPass?u.needsSkyboxCapture(g)&&(function(J,se,he,be){const Ce=J.context,Me=Ce.gl;let Ve=se.skyboxFbo;if(!Ve){Ve=se.skyboxFbo=Ce.createFramebuffer(32,32,!1),se.skyboxGeometry=new R(Ce),se.skyboxTexture=Ce.gl.createTexture(),Me.bindTexture(Me.TEXTURE_CUBE_MAP,se.skyboxTexture),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_WRAP_S,Me.CLAMP_TO_EDGE),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_WRAP_T,Me.CLAMP_TO_EDGE),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_MIN_FILTER,Me.LINEAR),Me.texParameteri(Me.TEXTURE_CUBE_MAP,Me.TEXTURE_MAG_FILTER,Me.LINEAR);for(let Je=0;Je<6;++Je)Me.texImage2D(Me.TEXTURE_CUBE_MAP_POSITIVE_X+Je,0,Me.RGBA,32,32,0,Me.RGBA,Me.UNSIGNED_BYTE,null)}Ce.bindFramebuffer.set(Ve.framebuffer),Ce.viewport.set([0,0,32,32]);const qe=se.getCenter(J,!0),ht=J.useProgram("skyboxCapture"),Be=new Float64Array(16);l.identity(Be),l.rotateY(Be,Be,.5*-Math.PI),ue(Ce,se,ht,Be,qe,0),l.identity(Be),l.rotateY(Be,Be,.5*Math.PI),ue(Ce,se,ht,Be,qe,1),l.identity(Be),l.rotateX(Be,Be,.5*-Math.PI),ue(Ce,se,ht,Be,qe,2),l.identity(Be),l.rotateX(Be,Be,.5*Math.PI),ue(Ce,se,ht,Be,qe,3),l.identity(Be),ue(Ce,se,ht,Be,qe,4),l.identity(Be),l.rotateY(Be,Be,Math.PI),ue(Ce,se,ht,Be,qe,5),Ce.viewport.set([0,0,J.width,J.height])}(g,u),u.markSkyboxValid(g)):"sky"===g.renderPass&&function(J,se,he,be,Ce){const Me=J.context,Ve=Me.gl,qe=J.transform,ht=J.useProgram("skybox");Me.activeTexture.set(Ve.TEXTURE0),Ve.bindTexture(Ve.TEXTURE_CUBE_MAP,se.skyboxTexture);const Be={u_matrix:qe.skyboxMatrix,u_sun_direction:se.getCenter(J,!1),u_cubemap:0,u_opacity:be,u_temporal_offset:Ce};J.prepareDrawProgram(Me,ht),ht.draw(Me,Ve.TRIANGLES,he,l.StencilMode.disabled,J.colorModeForRenderPass(),l.CullFaceMode.backCW,Be,"skybox",se.skyboxGeometry.vertexBuffer,se.skyboxGeometry.indexBuffer,se.skyboxGeometry.segment)}(g,u,k,m,Z):"gradient"===w&&"sky"===g.renderPass&&function(J,se,he,be,Ce){const Me=J.context,Ve=Me.gl,qe=J.transform,ht=J.useProgram("skyboxGradient");se.skyboxGeometry||(se.skyboxGeometry=new R(Me)),Me.activeTexture.set(Ve.TEXTURE0);let Be=se.colorRampTexture;Be||(Be=se.colorRampTexture=new l.Texture(Me,se.colorRamp,Ve.RGBA)),Be.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE);const Je=(dt=qe.skyboxMatrix,_t=se.getCenter(J,!1),wt=se.paint.get("sky-gradient-radius"),nt=be,Pt=Ce,{u_matrix:dt,u_color_ramp:0,u_center_direction:_t,u_radius:l.degToRad(wt),u_opacity:nt,u_temporal_offset:Pt});var dt,_t,wt,nt,Pt;J.prepareDrawProgram(Me,ht),ht.draw(Me,Ve.TRIANGLES,he,l.StencilMode.disabled,J.colorModeForRenderPass(),l.CullFaceMode.backCW,Je,"skyboxGradient",se.skyboxGeometry.vertexBuffer,se.skyboxGeometry.indexBuffer,se.skyboxGeometry.segment)}(g,u,k,m,Z)},debug:function(g,i,u){for(let m=0;m<u.length;m++)jc(g,i,u[m])},custom:function(g,i,u){const m=g.context,b=u.implementation;if("offscreen"===g.renderPass){const w=b.prerender;w&&(g.setCustomLayerDefaults(),m.setColorMode(g.colorModeForRenderPass()),w.call(b,m.gl,g.transform.customLayerMatrix()),m.setDirty(),g.setBaseState())}else if("translucent"===g.renderPass){g.setCustomLayerDefaults(),m.setColorMode(g.colorModeForRenderPass()),m.setStencilMode(l.StencilMode.disabled);const w="3d"===b.renderingMode?new l.DepthMode(g.context.gl.LEQUAL,l.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,l.DepthMode.ReadOnly);m.setDepthMode(w),b.render(m.gl,g.transform.customLayerMatrix()),m.setDirty(),g.setBaseState(),m.bindFramebuffer.set(null)}}};class Lt{constructor(i,u){this.context=new wr(i),this.transform=u,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=l.SourceCache.maxUnderzooming+l.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new cs,this.gpuTimers={},this.frameCounter=0}updateTerrain(i,u){const m=!!i&&!!i.terrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new S(this,i));const b=this._terrain;this.transform.elevation=m?b:null,b.update(i,this.transform,u)}_updateFog(i){const u=i.fog;if(!u||u.getOpacity(this.transform.pitch)<1||u.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,b]=u.getFovAdjustedRange(this.transform._fov);if(m>b)return void(this.transform.fogCullDistSq=null);const w=m+.78*(b-m);this.transform.fogCullDistSq=w*w}get terrain(){return this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,u){if(this.width=i*l.exported.devicePixelRatio,this.height=u*l.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const i=this.context,u=new l.StructArrayLayout2i4;u.emplaceBack(0,0),u.emplaceBack(l.EXTENT,0),u.emplaceBack(0,l.EXTENT),u.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(u,l.posAttributes.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const m=new l.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(l.EXTENT,0),m.emplaceBack(0,l.EXTENT),m.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=i.createVertexBuffer(m,l.posAttributes.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const b=new l.StructArrayLayout4i8;b.emplaceBack(0,0,0,0),b.emplaceBack(l.EXTENT,0,l.EXTENT,0),b.emplaceBack(0,l.EXTENT,0,l.EXTENT),b.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.rasterBoundsBuffer=i.createVertexBuffer(b,hi.members),this.rasterBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const w=new l.StructArrayLayout2i4;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(w,l.posAttributes.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const k=new l.StructArrayLayout1ui2;k.emplaceBack(0),k.emplaceBack(1),k.emplaceBack(3),k.emplaceBack(2),k.emplaceBack(0),this.tileBorderIndexBuffer=i.createIndexBuffer(k);const Z=new l.StructArrayLayout3ui6;Z.emplaceBack(0,1,2),Z.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(Z),this.emptyTexture=new l.Texture(i,{width:1,height:1,data:new Uint8Array([0,0,0,0])},i.gl.RGBA),this.identityMat=l.create$1();const J=this.context.gl;this.stencilClearMode=new l.StencilMode({func:J.ALWAYS,mask:0},0,255,J.ZERO,J.ZERO,J.ZERO),this.loadTimeStamps.push(l.window.performance.now())}clearStencil(){const i=this.context,u=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this.useProgram("clippingMask").draw(i,u.TRIANGLES,l.DepthMode.disabled,this.stencilClearMode,l.ColorMode.disabled,l.CullFaceMode.disabled,Os(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(i,u,m){if(!(u&&this.currentStencilSource!==u.id&&i.isTileClipped()&&m&&m.length))return;this.currentStencilSource=u.id;const b=this.context,w=b.gl;this.nextStencilID+m.length>256&&this.clearStencil(),b.setColorMode(l.ColorMode.disabled),b.setDepthMode(l.DepthMode.disabled);const k=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const Z of m){const J=this._tileClippingMaskIDs[Z.key]=this.nextStencilID++;k.draw(b,w.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:w.ALWAYS,mask:0},J,255,w.KEEP,w.KEEP,w.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,Os(Z.projMatrix),"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,u=this.context.gl;return new l.StencilMode({func:u.NOTEQUAL,mask:255},i,255,u.KEEP,u.KEEP,u.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const u=this.context.gl;return new l.StencilMode({func:u.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,u.KEEP,u.KEEP,u.REPLACE)}stencilConfigForOverlap(i){const u=this.context.gl,m=i.sort((k,Z)=>Z.overscaledZ-k.overscaledZ),b=m[m.length-1].overscaledZ,w=m[0].overscaledZ-b+1;if(w>1){this.currentStencilSource=void 0,this.nextStencilID+w>256&&this.clearStencil();const k={};for(let Z=0;Z<w;Z++)k[Z+b]=new l.StencilMode({func:u.GEQUAL,mask:255},Z+this.nextStencilID,255,u.KEEP,u.KEEP,u.REPLACE);return this.nextStencilID+=w,[k,m]}return[{[b]:l.StencilMode.disabled},m]}colorModeForRenderPass(){const i=this.context.gl;if(this._showOverdrawInspector){const u=1/8;return new l.ColorMode([i.CONSTANT_COLOR,i.ONE],new l.Color(u,u,u,0),[!0,!0,!0,!0])}return"opaque"===this.renderPass?l.ColorMode.unblended:l.ColorMode.alphaBlended}depthModeForSublayer(i,u,m){if(!this.opaquePassEnabledForLayer())return l.DepthMode.disabled;const b=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new l.DepthMode(m||this.context.gl.LEQUAL,u,[b,b])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,u){this.style=i,this.options=u,this.lineAtlas=i.lineAtlas,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const m=this.style.order,b=this.style._sourceCaches;for(const se in b){const he=b[se];he.used&&he.prepare(this.context)}const w={},k={},Z={};for(const se in b){const he=b[se];w[se]=he.getVisibleCoordinates(),k[se]=w[se].slice().reverse(),Z[se]=he.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let se=0;se<m.length;se++)if(this.style._layers[m[se]].is3D()){this.opaquePassCutoff=se;break}if(this.terrain&&(this.terrain.updateTileBinding(Z),this.opaquePassCutoff=0),!l.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const se of m){const he=this.style._layers[se],be=i._getLayerSourceCache(he);if(!he.hasOffscreenPass()||he.isHidden(this.transform.zoom))continue;const Ce=be?k[be.id]:void 0;("custom"===he.type||he.isSky()||Ce&&Ce.length)&&this.renderLayer(this,be,he,Ce)}this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);let J=l.Color.transparent;if(this.style.fog&&(J=this.style.fog.properties.get("color")),this.context.clear({color:u.showOverdrawInspector?l.Color.black:J,depth:1}),this.clearStencil(),this._showOverdrawInspector=u.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const se=this.style._layers[m[this.currentLayer]],he=i._getLayerSourceCache(se);if(se.isSky())continue;const be=he?k[he.id]:void 0;this._renderTileClippingMasks(se,he,be),this.renderLayer(this,he,se,be)}if(this.renderPass="sky",this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const se=this.style._layers[m[this.currentLayer]],he=i._getLayerSourceCache(se);se.isSky()&&this.renderLayer(this,he,se,he?k[he.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const se=this.style._layers[m[this.currentLayer]],he=i._getLayerSourceCache(se);if(se.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(se)){if(se.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const be=he?("symbol"===se.type?Z:k)[he.id]:void 0;this._renderTileClippingMasks(se,he,he?w[he.id]:void 0),this.renderLayer(this,he,se,be),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry){let se=null;l.values(this.style._layers).forEach(he=>{const be=i._getLayerSourceCache(he);be&&!he.isHidden(this.transform.zoom)&&(!se||se.getSource().maxzoom<be.getSource().maxzoom)&&(se=be)}),se&&this.options.showTileBoundaries&&Se.debug(this,se,se.getVisibleCoordinates())}this.options.showPadding&&function(se){const he=se.transform.padding;Ts(se,se.transform.height-(he.top||0),3,Ni),Ts(se,he.bottom||0,3,Yr),va(se,he.left||0,3,Gs),va(se,se.transform.width-(he.right||0),3,Cs);const be=se.transform.centerPoint;var Ce,Me,Ve,qe;la(Ce=se,(Me=be.x)-1,(Ve=se.transform.height-be.y)-10,2,20,qe=ro),la(Ce,Me-10,Ve-1,20,2,qe)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%l.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(l.window.performance.now()),this.saveCanvasCopy())}renderLayer(i,u,m,b){m.isHidden(this.transform.zoom)||("background"===m.type||"sky"===m.type||"custom"===m.type||b&&b.length)&&(this.id=m.id,this.gpuTimingStart(m),Se[m.type](i,u,m,b,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const u=this.context.extTimerQuery;let m=this.gpuTimers[i.id];m||(m=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:u.createQueryEXT()}),m.calls++,u.beginQueryEXT(u.TIME_ELAPSED_EXT,m.query)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}queryGpuTimers(i){const u={};for(const m in i){const b=i[m],w=this.context.extTimerQuery,k=w.getQueryObjectEXT(b.query,w.QUERY_RESULT_EXT)/1e6;w.deleteQueryEXT(b.query),u[m]=k}return u}translatePosMatrix(i,u,m,b,w){if(!m[0]&&!m[1])return i;const k=w?"map"===b?this.transform.angle:0:"viewport"===b?-this.transform.angle:0;if(k){const se=Math.sin(k),he=Math.cos(k);m=[m[0]*he-m[1]*se,m[0]*se+m[1]*he]}const Z=[w?m[0]:bn(u,m[0],this.transform.zoom),w?m[1]:bn(u,m[1],this.transform.zoom),0],J=new Float32Array(16);return l.translate(J,i,Z),J}saveTileTexture(i){const u=this._tileTextures[i.size[0]];u?u.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const u=this._tileTextures[i];return u&&u.length>0?u.pop():null}isPatternMissing(i){if(!i)return!1;if(!i.from||!i.to)return!0;const u=this.imageManager.getPattern(i.from.toString()),m=this.imageManager.getPattern(i.to.toString());return!u||!m}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,u=this.style&&this.style.fog,m=[];return this.terrain&&!this.terrain.renderingToTexture&&m.push("TERRAIN"),u&&!i&&0!==u.getOpacity(this.transform.pitch)&&m.push("FOG"),i&&m.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&m.push("OVERDRAW_INSPECTOR"),m}useProgram(i,u,m){this.cache=this.cache||{};const b=m||[],w=this.currentGlobalDefines().concat(b),k=Xe.cacheKey(i,w,u);return this.cache[k]||(this.cache[k]=new Xe(this.context,i,rt[i],u,Mn[i],w)),this.cache[k]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}prepareDrawTile(i){this.terrain&&this.terrain.prepareDrawTile(i)}prepareDrawProgram(i,u,m){if(this.terrain&&this.terrain.renderingToTexture)return;const b=this.style.fog;if(b){const w=b.getOpacity(this.transform.pitch);0!==w&&u.setFogUniformValues(i,((k,Z,J,se)=>{const he=Z.properties.get("color"),be=k.frameCounter/1e3%1,Ce=[he.r/he.a,he.g/he.a,he.b/he.a,se];return{u_fog_matrix:J?k.transform.calculateFogTileMatrix(J):k.identityMat,u_fog_range:Z.getFovAdjustedRange(k.transform._fov),u_fog_color:Ce,u_fog_horizon_blend:Z.properties.get("horizon-blend"),u_fog_temporal_offset:be}})(this,b,m,w))}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){this.frameCopies.push(this.canvasCopy()),this.tileLoaded=!1}canvasCopy(){const i=this.context.gl,u=i.createTexture();return i.bindTexture(i.TEXTURE_2D,u),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),u}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}}class Sn{constructor(i=0,u=0,m=0,b=0){if(isNaN(i)||i<0||isNaN(u)||u<0||isNaN(m)||m<0||isNaN(b)||b<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=u,this.left=m,this.right=b}interpolate(i,u,m){return null!=u.top&&null!=i.top&&(this.top=l.number(i.top,u.top,m)),null!=u.bottom&&null!=i.bottom&&(this.bottom=l.number(i.bottom,u.bottom,m)),null!=u.left&&null!=i.left&&(this.left=l.number(i.left,u.left,m)),null!=u.right&&null!=i.right&&(this.right=l.number(i.right,u.right,m)),this}getCenter(i,u){const m=l.clamp((this.left+i-this.right)/2,0,i),b=l.clamp((this.top+u-this.bottom)/2,0,u);return new l.pointGeometry(m,b)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new Sn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Bn(g,i){return[g[4*i],g[4*i+1],g[4*i+2],g[4*i+3]]}function Bi(g,i,u){g[4*i+0]=u[0],g[4*i+1]=u[1],g[4*i+2]=u[2],g[4*i+3]=u[3]}function ni(g,i){const u=Bn(g,3);l.fromQuat(g,i),Bi(g,3,u)}function or(g,i){Bi(g,3,[i[0],i[1],i[2],1])}function hr(g,i){const u=l.identity$1([]);return l.rotateZ$1(u,u,-i),l.rotateX$1(u,u,-g),u}function xr(g,i){const u=[g[0],g[1],0],m=[i[0],i[1],0];if(l.length(u)>=1e-15){const k=l.normalize([],u);l.scale(m,k,l.dot(m,k)),i[0]=m[0],i[1]=m[1]}const b=l.cross([],i,g);if(l.len(b)<1e-15)return null;const w=Math.atan2(-b[1],b[0]);return hr(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),w)}class oo{constructor(i,u){this.position=i,this.orientation=u}get position(){return this._position}set position(i){this._position=this._renderWorldCopies?function(u){if(!u)return;const m=Array.isArray(u)?new l.MercatorCoordinate(u[0],u[1],u[2]):u;return m.x=l.wrap(m.x,0,1),m}(i):i}lookAtPoint(i,u){if(this.orientation=null,!this.position)return;const m=this._elevation?this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(i)):0,b=this.position,w=l.MercatorCoordinate.fromLngLat(i,m),k=[w.x-b.x,w.y-b.y,w.z-b.z];u||(u=[0,0,1]),u[2]=Math.abs(u[2]),this.orientation=xr(k,u)}setPitchBearing(i,u){this.orientation=hr(l.degToRad(i),l.degToRad(-u))}}class Zr{constructor(i,u){this._transform=l.identity([]),this._orientation=l.identity$1([]),u&&(this._orientation=u,ni(this._transform,this._orientation)),i&&or(this._transform,i)}get mercatorPosition(){const i=this.position;return new l.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=Bn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){or(this._transform,i)}get orientation(){return this._orientation}set orientation(i){this._orientation=i,ni(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),u=this.right();return{bearing:Math.atan2(-u[1],u[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,u){this._orientation=hr(i,u),ni(this._transform,this._orientation)}forward(){const i=Bn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=Bn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=Bn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,u){const m=new Float64Array(16);return l.invert(m,this.getWorldToCamera(i,u)),m}getWorldToCameraPosition(i,u,m){const b=this.position;l.scale(b,b,-i);const w=new Float64Array(16);return l.fromScaling(w,[m,m,m]),l.translate(w,w,b),w[10]*=u,w}getWorldToCamera(i,u){const m=new Float64Array(16),b=new Float64Array(4),w=this.position;return l.conjugate(b,this._orientation),l.scale(w,w,-i),l.fromQuat(m,b),l.translate(m,m,w),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=u,m[9]*=u,m[10]*=u,m[11]*=u,m}getCameraToClipPerspective(i,u,m,b){const w=new Float64Array(16);return l.perspective(w,i,u,m,b),w}getDistanceToElevation(i){const u=0===i?0:l.mercatorZfromAltitude(i,this.position[1]),m=this.forward();return(u-this.position[2])/m[2]}clone(){return new Zr([...this.position],[...this.orientation])}}class Xr{constructor(i,u,m,b,w){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=void 0===w||w,this._minZoom=i||0,this._maxZoom=u||22,this._minPitch=m??0,this._maxPitch=b??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new Sn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._camera=new Zr,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._horizonShift=.1}clone(){const i=new Xr(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i.tileSize=this.tileSize,i.latRange=this.latRange,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._cameraZoom=this._cameraZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,i?this._updateCenterElevation()&&this._updateCameraOnTerrain():(this._cameraZoom=null,this._centerAltitude=0),this._calcMatrices())}updateElevation(i){this._terrainEnabled()&&null==this._cameraZoom&&this._updateCenterElevation()&&this._updateCameraOnTerrain(),i&&this._constrainCameraAltitude(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return l.mercatorZfromAltitude(1,this.center.lat)*this.worldSize}get cameraPixelsPerMeter(){return l.mercatorZfromAltitude(1,this.center.lat)*this.cameraWorldSize}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.pointGeometry(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(i){const u=-l.wrap(i,-180,180)*Math.PI/180;var m,b,w,k,Z,J,se,he,be,Ce;this.angle!==u&&(this._unmodified=!1,this.angle=u,this._calcMatrices(),this.rotationMatrix=(m=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),b=this.rotationMatrix,k=this.angle,Z=(w=this.rotationMatrix)[0],J=w[1],se=w[2],he=w[3],be=Math.sin(k),Ce=Math.cos(k),b[0]=Z*Ce+se*be,b[1]=J*Ce+he*be,b[2]=Z*-be+se*Ce,b[3]=J*-be+he*Ce)}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const u=l.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==u&&(this._unmodified=!1,this._pitch=u,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=i/180*Math.PI,this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices()}get zoom(){return this._zoom}set zoom(i){const u=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==u&&(this._unmodified=!1,this._setZoom(u),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCenterElevation(){if(!this._elevation)return!1;const i=this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(this.center),-1);return-1===i?(this._cameraZoom=null,!1):(this._centerAltitude=i,!0)}_updateCameraOnTerrain(){const i=this.cameraToCenterDistance/this.worldSize,u=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat);this._cameraZoom=this._zoomFromMercatorZ(u+i)}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,u=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let b=0,w=0;for(let k=0;k<u.length;k++){const Z=new l.pointGeometry(u[k][0]*this.width,m+u[k][1]*(this.height-m)),J=i.pointCoordinate(Z);if(!J)continue;const se=1/Math.hypot(J[0]-this._camera.position[0],J[1]-this._camera.position[1]);b+=J[3]*se,w+=se}return 0===w?NaN:b/w}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCenterElevation()?this._updateCameraOnTerrain():this._cameraZoom=null:this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._cameraZoom||!this._elevation)return;const i=this._cameraZoom,u=this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(this.center)),m=l.mercatorZfromAltitude(u,this.center.lat),b=this._mercatorZfromZoom(i),w=this._mercatorZfromZoom(this._maxZoom),k=Math.max(b-m,w);this._setZoom(this._zoomFromMercatorZ(k))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const u=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let m;m=i.z<this._camera.position[2]?[u.x,u.y,u.z]:[i.x,i.y,i.z];const b=l.length(l.sub([],this._camera.position,m));return l.clamp(this._zoomFromMercatorZ(b),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let u=!1;if(i.orientation&&!l.exactEquals(i.orientation,this._camera.orientation)&&(u=this._setCameraOrientation(i.orientation)),i.position){const m=[i.position.x,i.position.y,i.position.z];l.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),u=!0)}u&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,u=new oo;return u.position=new l.MercatorCoordinate(i[0],i[1],i[2]),u.orientation=this._camera.orientation,u._elevation=this.elevation,u._renderWorldCopies=this._renderWorldCopies,u}_setCameraOrientation(i){if(!l.length$1(i))return!1;l.normalize$1(i,i);const u=l.transformQuat([],[0,0,-1],i),m=l.transformQuat([],[0,-1,0],i);if(m[2]<0)return!1;const b=xr(u,m);return!!b&&(this._camera.orientation=b,!0)}_setCameraPosition(i){const u=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,b=this.cameraToCenterDistance;i[2]=l.clamp(i[2],b/m,b/u),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,u,m){this._unmodified=!1,this._edgeInsets.interpolate(i,u,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const u=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,u)}getVisibleUnwrappedCoordinates(i){const u=[new l.UnwrappedTileID(0,i)];if(this._renderWorldCopies){const m=this.pointCoordinate(new l.pointGeometry(0,0)),b=this.pointCoordinate(new l.pointGeometry(this.width,0)),w=this.pointCoordinate(new l.pointGeometry(this.width,this.height)),k=this.pointCoordinate(new l.pointGeometry(0,this.height)),Z=Math.floor(Math.min(m.x,b.x,w.x,k.x)),J=Math.floor(Math.max(m.x,b.x,w.x,k.x)),se=1;for(let he=Z-se;he<=J+se;he++)0!==he&&u.push(new l.UnwrappedTileID(he,i))}return u}coveringTiles(i){let u=this.coveringZoomLevel(i);const m=u,b=this.elevation&&!i.isTerrainDEM;if(void 0!==i.minzoom&&u<i.minzoom)return[];void 0!==i.maxzoom&&u>i.maxzoom&&(u=i.maxzoom);const w=l.MercatorCoordinate.fromLngLat(this.center),k=1<<u,Z=[k*w.x,k*w.y,0],J=ze.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,u),se=this.pointCoordinate(this.getCameraPoint()),he=k*l.mercatorZfromAltitude(1,this.center.lat),be=this._camera.position[2]/l.mercatorZfromAltitude(1,this.center.lat),Ce=[k*se.x,k*se.y,be],Me=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),Ve=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation?u:0,qe=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ht=i.isTerrainDEM?-qe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Be=Rt=>({aabb:new Ne([Rt*k,0,ht],[(Rt+1)*k,k,qe]),zoom:0,x:0,y:0,wrap:Rt,fullyVisible:!1}),Je=[];let dt=[];const _t=u,wt=i.reparseOverscaled?m:u,nt=Rt=>{if(!this._elevation||!Rt.tileID)return;const sn=this._elevation.getMinMaxForTile(Rt.tileID),$n=Rt.aabb;sn?($n.min[2]=sn.min,$n.max[2]=sn.max,$n.center[2]=($n.min[2]+$n.max[2])/2):(Rt.shouldSplit=wn(Rt),Rt.shouldSplit||($n.min[2]=$n.max[2]=$n.center[2]=this._centerAltitude))},Pt=Rt=>Rt*Rt,dn=Pt((be-this._centerAltitude)*he),wn=Rt=>{if(Rt.zoom<Ve)return!0;if(Rt.zoom===_t)return!1;if(null!=Rt.shouldSplit)return Rt.shouldSplit;const sn=Rt.aabb.distanceX(Ce),$n=Rt.aabb.distanceY(Ce);let Kn=dn;b&&(Kn=Pt(Rt.aabb.distanceZ(Ce)*he));const Gn=sn*sn+$n*$n+Kn;return Gn<Pt((1<<_t-Rt.zoom)*Me*((Pn,Xn)=>{if(Xn*Pt(.707)<Pn)return 1;const qi=Math.sqrt(Xn/Pn);return qi/(1.4144271570014144+(Math.pow(1.1,qi-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Kn,dn),Gn))};if(this._renderWorldCopies)for(let Rt=1;Rt<=3;Rt++)Je.push(Be(-Rt)),Je.push(Be(Rt));for(Je.push(Be(0));Je.length>0;){const Rt=Je.pop(),sn=Rt.x,$n=Rt.y;let Kn=Rt.fullyVisible;if(!Kn){const Gn=Rt.aabb.intersects(J);if(0===Gn)continue;Kn=2===Gn}if(Rt.zoom!==_t&&wn(Rt))for(let Gn=0;Gn<4;Gn++){const Pn=(sn<<1)+Gn%2,Xn=($n<<1)+(Gn>>1),qi={aabb:Rt.aabb.quadrant(Gn),zoom:Rt.zoom+1,x:Pn,y:Xn,wrap:Rt.wrap,fullyVisible:Kn,tileID:void 0,shouldSplit:void 0};b&&(qi.tileID=new l.OverscaledTileID(Rt.zoom+1===_t?wt:Rt.zoom+1,Rt.wrap,Rt.zoom+1,Pn,Xn),nt(qi)),Je.push(qi)}else{const Gn=Rt.zoom===_t?wt:Rt.zoom;if(i.minzoom&&i.minzoom>Gn)continue;const Pn=Z[0]-(.5+sn+(Rt.wrap<<Rt.zoom))*(1<<u-Rt.zoom),Xn=Z[1]-.5-$n,qi=Rt.tileID?Rt.tileID:new l.OverscaledTileID(Gn,Rt.wrap,Rt.zoom,sn,$n);dt.push({tileID:qi,distanceSq:Pn*Pn+Xn*Xn})}}if(this.fogCullDistSq){const Rt=this.fogCullDistSq,sn=this.horizonLineFromTop();dt=dt.filter($n=>{const Kn=[0,0,0,1],Gn=[l.EXTENT,l.EXTENT,0,1],Pn=this.calculateFogTileMatrix($n.tileID.toUnwrapped());l.transformMat4(Kn,Kn,Pn),l.transformMat4(Gn,Gn,Pn);const Xn=l.getAABBPointSquareDist(Kn,Gn);if(0===Xn)return!0;let qi=!1;const Li=this._elevation;if(Li&&Xn>Rt&&0!==sn){const Hr=this.calculateProjMatrix($n.tileID.toUnwrapped());let $r;i.isTerrainDEM||($r=Li.getMinMaxForTile($n.tileID)),$r||($r={min:ht,max:qe});const ki=l.furthestTileCorner(this.bearing),Qi=[ki[0]*l.EXTENT,ki[1]*l.EXTENT,$r.max];l.transformMat4$1(Qi,Qi,Hr),qi=(1-Qi[1])*this.height*.5<sn}return Xn<Rt||qi})}return dt.sort((Rt,sn)=>Rt.distanceSq-sn.distanceSq).map(Rt=>Rt.tileID)}resize(i,u){this.width=i,this.height=u,this.pixelsToGLUnits=[2/i,-2/u],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const u=l.clamp(i.lat,-this.maxValidLatitude,this.maxValidLatitude);return new l.pointGeometry(l.mercatorXfromLng(i.lng)*this.worldSize,l.mercatorYfromLat(u)*this.worldSize)}unproject(i){return new l.MercatorCoordinate(i.x/this.worldSize,i.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}setLocationAtPoint(i,u){const m=this.pointCoordinate(u),b=this.pointCoordinate(this.centerPoint),w=this.locationCoordinate(i),k=new l.MercatorCoordinate(w.x-(m.x-b.x),w.y-(m.y-b.y));this.center=this.coordinateLocation(k),this._renderWorldCopies&&(this.center=this.center.wrap())}setLocation(i){this.center=this.coordinateLocation(i),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(i){return this._coordinatePoint(this.locationCoordinate(i),!1)}locationPoint3D(i){return this._coordinatePoint(this.locationCoordinate(i),!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i){return l.MercatorCoordinate.fromLngLat(i)}coordinateLocation(i){return i.toLngLat()}pointRayIntersection(i,u){const m=u??this._centerAltitude,b=[i.x,i.y,0,1],w=[i.x,i.y,1,1];l.transformMat4(b,b,this.pixelMatrixInverse),l.transformMat4(w,w,this.pixelMatrixInverse);const k=w[3];l.scale$2(b,b,1/b[3]),l.scale$2(w,w,1/k);const Z=b[2],J=w[2];return{p0:b,p1:w,t:Z===J?0:(m-Z)/(J-Z)}}screenPointToMercatorRay(i){const u=[i.x,i.y,0,1],m=[i.x,i.y,1,1];return l.transformMat4(u,u,this.pixelMatrixInverse),l.transformMat4(m,m,this.pixelMatrixInverse),l.scale$2(u,u,1/u[3]),l.scale$2(m,m,1/m[3]),u[2]=l.mercatorZfromAltitude(u[2],this._center.lat)*this.worldSize,m[2]=l.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,l.scale$2(u,u,1/this.worldSize),l.scale$2(m,m,1/this.worldSize),new we([u[0],u[1],u[2]],l.normalize([],l.sub([],m,u)))}rayIntersectionCoordinate(i){const{p0:u,p1:m,t:b}=i,w=l.mercatorZfromAltitude(u[2],this._center.lat),k=l.mercatorZfromAltitude(m[2],this._center.lat);return new l.MercatorCoordinate(l.number(u[0],m[0],b)/this.worldSize,l.number(u[1],m[1],b)/this.worldSize,l.number(w,k,b))}pointCoordinate(i,u=this._centerAltitude){const m=this.horizonLineFromTop(!1),b=new l.pointGeometry(i.x,Math.max(m,i.y));return this.rayIntersectionCoordinate(this.pointRayIntersection(b,u))}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);const u=this.elevation;let m=this.elevation.pointCoordinate(i);if(m)return new l.MercatorCoordinate(m[0],m[1],m[2]);let b=0,w=this.horizonLineFromTop();if(i.y>w)return this.pointCoordinate(i);const k=.02*w,Z=i.clone();for(let J=0;J<10&&w-b>k;J++){Z.y=l.number(b,w,.66);const se=u.pointCoordinate(Z);se?(w=Z.y,m=se):b=Z.y}return m?new l.MercatorCoordinate(m[0],m[1],m[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){if(this.elevation)return!this.elevation.pointCoordinate(i);{const u=this.horizonLineFromTop();return i.y<u}}_coordinatePoint(i,u){const m=u&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,b=[i.x*this.worldSize,i.y*this.worldSize,m+i.toAltitude(),1];return l.transformMat4(b,b,this.pixelMatrix),b[3]>0?new l.pointGeometry(b[0]/b[3],b[1]/b[3]):new l.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBounds(i,u){const m=new l.pointGeometry(this._edgeInsets.left,this._edgeInsets.top),b=new l.pointGeometry(this.width-this._edgeInsets.right,this._edgeInsets.top),w=new l.pointGeometry(this.width-this._edgeInsets.right,this.height-this._edgeInsets.bottom),k=new l.pointGeometry(this._edgeInsets.left,this.height-this._edgeInsets.bottom);let Z=this.pointCoordinate(m,i),J=this.pointCoordinate(b,i);const se=this.pointCoordinate(w,u),he=this.pointCoordinate(k,u),be=(Ce,Me)=>(Me.y-Ce.y)/(Me.x-Ce.x);return Z.y>1&&J.y>=0?Z=new l.MercatorCoordinate((1-he.y)/be(he,Z)+he.x,1):Z.y<0&&J.y<=1&&(Z=new l.MercatorCoordinate(-he.y/be(he,Z)+he.x,0)),J.y>1&&Z.y>=0?J=new l.MercatorCoordinate((1-se.y)/be(se,J)+se.x,1):J.y<0&&Z.y<=1&&(J=new l.MercatorCoordinate(-se.y/be(se,J)+se.x,0)),(new l.LngLatBounds).extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(J)).extend(this.coordinateLocation(he)).extend(this.coordinateLocation(se))}_getBounds3D(){const i=this.elevation,u=i.visibleDemTiles.reduce((m,b)=>{if(b.dem){const w=b.dem.tree;m.min=Math.min(m.min,w.minimums[0]),m.max=Math.max(m.max,w.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBounds(u.min*i.exaggeration(),u.max*i.exaggeration())}getBounds(){return this._terrainEnabled()?this._getBounds3D():this._getBounds(0,0)}horizonLineFromTop(i=!0){const u=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-u*(1-this._horizonShift);return i?Math.max(0,m):m}getMaxBounds(){return this.latRange&&2===this.latRange.length&&this.lngRange&&2===this.lngRange.length?new l.LngLatBounds([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}setMaxBounds(i){if(i){const u=i.getEast(),m=i.getWest();this.lngRange=[m,u>m?u:u+360],this.latRange=[i.getSouth(),i.getNorth()],this._constrain()}else this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude]}calculatePosMatrix(i,u){const m=i.canonical,b=u/this.zoomScale(m.z),w=m.x+Math.pow(2,m.z)*i.wrap,k=l.identity(new Float64Array(16));return l.translate(k,k,[w*b,m.y*b,0]),l.scale$1(k,k,[b/l.EXTENT,b/l.EXTENT,1]),k}calculateFogTileMatrix(i){const u=i.key,m=this._fogTileMatrixCache;if(m[u])return m[u];const b=this.calculatePosMatrix(i,this.cameraWorldSize);return l.multiply(b,this.worldToFogMatrix,b),m[u]=new Float32Array(b),m[u]}calculateProjMatrix(i,u=!1){const m=i.key,b=u?this._alignedProjMatrixCache:this._projMatrixCache;if(b[m])return b[m];const w=this.calculatePosMatrix(i,this.worldSize);return l.multiply(w,u?this.alignedProjMatrix:this.projMatrix,w),b[m]=new Float32Array(w),b[m]}customLayerMatrix(){return this.mercatorMatrix.slice()}recenterOnTerrain(){if(!this._elevation)return;const i=this._elevation;this._updateCameraState();const u=this._camera.position,m=this._camera.forward();if(u[2]<=0||m[2]>=0)return;const b=l.mercatorZfromAltitude(1,this._center.lat);u[2]/=b,m[2]/=b,l.normalize(m,m);const w=i.raycast(u,m,i.exaggeration());if(w){const k=l.scaleAndAdd([],u,m,w),Z=new l.MercatorCoordinate(k[0],k[1],l.mercatorZfromAltitude(k[2],l.latFromMercatorY(k[1]))),J=this._camera.position,se=Z.z+l.length([Z.x-J[0],Z.y-J[1],Z.z-J[2]]);this._cameraZoom=this._zoomFromMercatorZ(se),this._centerAltitude=Z.toAltitude(),this._center=Z.toLngLat(),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCameraAltitude(){if(!this._elevation)return;const i=this._elevation;this._updateCameraState();const u=i.getAtPointOrZero(this._camera.mercatorPosition),m=this._minimumHeightOverTerrain()*Math.cos(l.degToRad(this._maxPitch)),b=l.mercatorZfromAltitude(u,this._center.lat),w=this._camera.position[2]-b;if(w<m){const k=l.MercatorCoordinate.fromLngLat(this._center,this._centerAltitude),Z=this._camera.mercatorPosition,J=[k.x-Z.x,k.y-Z.y,k.z-Z.z],se=l.length(J);J[2]-=m-w;const he=l.length(J);if(0===he)return;l.scale(J,J,se/he),this._camera.position=[k.x-J[0],k.y-J[1],k.z-J[2]],this._camera.orientation=xr(J,this._camera.up()),this._updateStateFromCamera()}}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let i,u,m,b,w,k=1/0,Z=-1/0;const J=this.size,se=this._unmodified;if(this.latRange){const Me=this.latRange;k=l.mercatorYfromLat(Me[1])*this.worldSize,Z=l.mercatorYfromLat(Me[0])*this.worldSize,m=Z-k<J.y?J.y/(Z-k):0}if(this.lngRange){const Me=this.lngRange;i=l.mercatorXfromLng(Me[0])*this.worldSize,u=l.mercatorXfromLng(Me[1])*this.worldSize,b=u-i<J.x?J.x/(u-i):0}const he=this.point,be=Math.max(b||0,m||0);if(be)return this.center=this.unproject(new l.pointGeometry(b?(u+i)/2:he.x,m?(Z+k)/2:he.y)),this.zoom+=this.scaleZoom(be),this._unmodified=se,void(this._constraining=!1);if(this.latRange){const Me=he.y,Ve=J.y/2;Me-Ve<k&&(w=k+Ve),Me+Ve>Z&&(w=Z-Ve)}let Ce=he.x;if(this.lngRange){const Me=this.worldSize/2-(i+u)/2;Ce=(Ce+Me+this.worldSize)%this.worldSize,i+=Me,u+=Me;const Ve=J.x/2;Ce-Ve<i&&(Ce=i+Ve),Ce+Ve>u&&(Ce=u-Ve),Ce-=Me}Ce===he.x&&void 0===w||(this.center=this.unproject(new l.pointGeometry(Ce,void 0!==w?w:he.y))),this._constrainCameraAltitude(),this._unmodified=se,this._constraining=!1}_minZoomForBounds(){const i=(b,w)=>Math.log2(b/(this.tileSize*Math.abs(w[1]-w[0])));let u=0;if(this.latRange){const b=this.latRange;u=i(this.height,[l.mercatorYfromLat(b[0]),l.mercatorYfromLat(b[1])])}let m=0;if(this.lngRange){const b=this.lngRange;m=i(this.width,[l.mercatorXfromLng(b[0]),l.mercatorXfromLng(b[1])])}return Math.max(u,m)}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height;const u=this.pixelsPerMeter;this._updateCameraState();const m=Math.PI/2+this._pitch,b=this.fovAboveCenter,w=this.elevation?this.elevation.getMinElevationBelowMSL()*u:0,k=(this._camera.position[2]*this.worldSize-w)/Math.cos(this._pitch),Z=Math.sin(b)*k/Math.sin(l.clamp(Math.PI-m-b,.01,Math.PI-.01)),J=this.point,se=J.x,he=J.y,be=Math.cos(Math.PI/2-this._pitch)*Z+k,Ce=Math.min(1.01*be,k*(1/this._horizonShift)),Me=this.height/50,Ve=this._camera.getWorldToCamera(this.worldSize,u),qe=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,Me,Ce);qe[8]=2*-i.x/this.width,qe[9]=2*i.y/this.height;let ht=l.mul$1([],qe,Ve);this.mercatorMatrix=l.scale$1([],ht,[this.worldSize,this.worldSize,this.worldSize/u]),this.projMatrix=ht,this.invProjMatrix=l.invert(new Float64Array(16),this.projMatrix);const Be=new Float32Array(16);l.identity(Be),l.scale$1(Be,Be,[1,-1,1]),l.rotateX(Be,Be,this._pitch),l.rotateZ(Be,Be,this.angle);const Je=l.perspective(new Float32Array(16),this._fov,this.width/this.height,Me,Ce),dt=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Je[8]=2*-i.x/this.width,Je[9]=2*(i.y+dt)/this.height,this.skyboxMatrix=l.multiply(Be,Je,Be);const _t=this.width%2/2,wt=this.height%2/2,nt=Math.cos(this.angle),Pt=Math.sin(this.angle),dn=se-Math.round(se)+nt*_t+Pt*wt,wn=he-Math.round(he)+nt*wt+Pt*_t,Rt=new Float64Array(ht);if(l.translate(Rt,Rt,[dn>.5?dn-1:dn,wn>.5?wn-1:wn,0]),this.alignedProjMatrix=Rt,ht=l.create$1(),l.scale$1(ht,ht,[this.width/2,-this.height/2,1]),l.translate(ht,ht,[1,-1,0]),this.labelPlaneMatrix=ht,ht=l.create$1(),l.scale$1(ht,ht,[1,-1,1]),l.translate(ht,ht,[-1,-1,0]),l.scale$1(ht,ht,[2/this.width,2/this.height,1]),this.glCoordMatrix=ht,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),ht=l.invert(new Float64Array(16),this.pixelMatrix),!ht)throw new Error("failed to invert matrix");this.pixelMatrixInverse=ht,this._projMatrixCache={},this._alignedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSize,u=this.cameraPixelsPerMeter,m=this._camera.position,b=1/this.height,w=[i,i,u];l.scale(w,w,b),l.scale(m,m,-1),l.multiply$1(m,m,w);const k=l.create$1();l.translate(k,k,m),l.scale$1(k,k,w),this.mercatorFogMatrix=k,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,u,b)}_updateCameraState(){if(!this.height)return;this._camera.setPitchBearing(this._pitch,this.angle);const i=this._camera.forward(),u=this.cameraToCenterDistance,m=this.point,b=this._mercatorZfromZoom(this._cameraZoom?this._cameraZoom:this._zoom)-l.mercatorZfromAltitude(this._centerAltitude,this.center.lat),w=this.cameraToCenterDistance/b;this._camera.position=[m.x/this.worldSize-i[0]*u/w,m.y/this.worldSize-i[1]*u/w,l.mercatorZfromAltitude(this._centerAltitude,this._center.lat)+-i[2]*u/w]}_translateCameraConstrained(i){const u=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=i[2];let b=1;m>0&&(b=Math.min((u-this._camera.position[2])/m,1)),this._camera.position=l.scaleAndAdd([],this._camera.position,i,b),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,u=this._camera.forward(),{pitch:m,bearing:b}=this._camera.getPitchBearing(),w=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat),k=this._mercatorZfromZoom(this._maxZoom)*Math.cos(l.degToRad(this._maxPitch)),Z=Math.max((i[2]-w)/Math.cos(m),k),J=this._zoomFromMercatorZ(Z);l.scaleAndAdd(i,i,u,Z),this._pitch=l.clamp(m,l.degToRad(this.minPitch),l.degToRad(this.maxPitch)),this.angle=l.wrap(b,-Math.PI,Math.PI),this._setZoom(l.clamp(J,this._minZoom,this._maxZoom)),this._terrainEnabled()&&this._updateCameraOnTerrain(),this._center=new l.MercatorCoordinate(i[0],i[1],i[2]).toLngLat(),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._cameraZoom?this._cameraZoom:this._zoom)+2,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}_terrainEnabled(){return!!this._elevation}isCornerOffEdge(i,u){const m=Math.min(i.x,u.x),b=Math.max(i.x,u.x),w=Math.min(i.y,u.y),k=Math.max(i.y,u.y);if(w<this.horizonLineFromTop(!1))return!0;const Z=[new l.pointGeometry(m,w),new l.pointGeometry(b,k),new l.pointGeometry(m,k),new l.pointGeometry(b,w)],J=this._renderWorldCopies?-3:0,se=this._renderWorldCopies?4:1;for(const he of Z){const be=this.pointRayIntersection(he);if(be.t<0)return!0;const Ce=this.rayIntersectionCoordinate(be);if(Ce.x<J||Ce.y<0||Ce.x>se||Ce.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+l.radToDeg(this.fovAboveCenter)>88||this.isCornerOffEdge(new l.pointGeometry(0,0),new l.pointGeometry(this.width,this.height))}zoomDeltaToMovement(i,u){const m=l.length(l.sub([],this._camera.position,i)),b=this._zoomFromMercatorZ(m)+u;return m-this._mercatorZfromZoom(b)}getCameraPoint(){const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.pointGeometry(0,i))}}function Jr(g,i){let u=!1,m=null;const b=()=>{m=null,u&&(g(),m=setTimeout(b,i),u=!1)};return()=>(u=!0,m||b(),m)}class _l{constructor(i){this._hashName=i&&encodeURIComponent(i),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Jr(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,l.window.addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return l.window.removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(i){const u=this._map.getCenter(),m=Math.round(100*this._map.getZoom())/100,b=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),w=Math.pow(10,b),k=Math.round(u.lng*w)/w,Z=Math.round(u.lat*w)/w,J=this._map.getBearing(),se=this._map.getPitch();let he="";if(he+=i?`/${k}/${Z}/${m}`:`${m}/${Z}/${k}`,(J||se)&&(he+="/"+Math.round(10*J)/10),se&&(he+=`/${Math.round(se)}`),this._hashName){const be=this._hashName;let Ce=!1;const Me=l.window.location.hash.slice(1).split("&").map(Ve=>{const qe=Ve.split("=")[0];return qe===be?(Ce=!0,`${qe}=${he}`):Ve}).filter(Ve=>Ve);return Ce||Me.push(`${be}=${he}`),`#${Me.join("&")}`}return`#${he}`}_getCurrentHash(){const i=l.window.location.hash.replace("#","");if(this._hashName){let u;return i.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(u=m)}),(u&&u[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._getCurrentHash();if(i.length>=3&&!i.some(u=>isNaN(u))){const u=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(i[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+i[2],+i[1]],zoom:+i[0],bearing:u,pitch:+(i[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=l.window.location.href.replace(/(#.+)?$/,this.getHashString());l.window.history.replaceState(l.window.history.state,null,i)}}const xa={linearity:.3,easing:l.bezier(0,0,.3,1)},$l=l.extend({deceleration:2500,maxSpeed:1400},xa),gc=l.extend({deceleration:20,maxSpeed:1400},xa),qc=l.extend({deceleration:1e3,maxSpeed:360},xa),jl=l.extend({deceleration:1e3,maxSpeed:90},xa);class Qa{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,u=l.exported.now();for(;i.length>0&&u-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const u={zoom:0,bearing:0,pitch:0,pan:new l.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:w}of this._inertiaBuffer)u.zoom+=w.zoomDelta||0,u.bearing+=w.bearingDelta||0,u.pitch+=w.pitchDelta||0,w.panDelta&&u.pan._add(w.panDelta),w.around&&(u.around=w.around),w.pinchAround&&(u.pinchAround=w.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,b={};if(u.pan.mag()){const w=wa(u.pan.mag(),m,l.extend({},$l,i||{}));b.offset=u.pan.mult(w.amount/u.pan.mag()),b.center=this._map.transform.center,ba(b,w)}if(u.zoom){const w=wa(u.zoom,m,gc);b.zoom=this._map.transform.zoom+w.amount,ba(b,w)}if(u.bearing){const w=wa(u.bearing,m,qc);b.bearing=this._map.transform.bearing+l.clamp(w.amount,-179,179),ba(b,w)}if(u.pitch){const w=wa(u.pitch,m,jl);b.pitch=this._map.transform.pitch+w.amount,ba(b,w)}if(b.zoom||b.bearing){const w=void 0===u.pinchAround?u.around:u.pinchAround;b.around=w?this._map.unproject(w):this._map.getCenter()}return this.clear(),l.extend(b,{noMoveStart:!0})}}function ba(g,i){(!g.duration||g.duration<i.duration)&&(g.duration=i.duration,g.easing=i.easing)}function wa(g,i,u){const{maxSpeed:m,linearity:b,deceleration:w}=u,k=l.clamp(g*b/(i/1e3),-m,m),Z=Math.abs(k)/(w*b);return{easing:u.easing,duration:1e3*Z,amount:k*(Z/2)}}class wo extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,m,b={}){const w=te.mousePos(u.getCanvasContainer(),m),k=u.unproject(w);super(i,l.extend({point:w,lngLat:k,originalEvent:m},b)),this._defaultPrevented=!1,this.target=u}}class La extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,m){const b="touchend"===i?m.changedTouches:m.touches,w=te.touchPos(u.getCanvasContainer(),b),k=w.map(J=>u.unproject(J)),Z=w.reduce((J,se,he,be)=>J.add(se.div(be.length)),new l.pointGeometry(0,0));super(i,{points:w,point:Z,lngLats:k,lngLat:u.unproject(Z),originalEvent:m}),this._defaultPrevented=!1}}class Hc extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,u,m){super(i,{originalEvent:m}),this._defaultPrevented=!1}}class us{constructor(i,u){this._map=i,this._clickTolerance=u.clickTolerance}reset(){delete this._mousedownPos}wheel(i){return this._firePreventable(new Hc(i.type,this._map,i))}mousedown(i,u){return this._mousedownPos=u,this._firePreventable(new wo(i.type,this._map,i))}mouseup(i){this._map.fire(new wo(i.type,this._map,i))}preclick(i){const u=l.extend({},i);u.type="preclick",this._map.fire(new wo(u.type,this._map,u))}click(i,u){this._mousedownPos&&this._mousedownPos.dist(u)>=this._clickTolerance||(this.preclick(i),this._map.fire(new wo(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new wo(i.type,this._map,i))}mouseover(i){this._map.fire(new wo(i.type,this._map,i))}mouseout(i){this._map.fire(new wo(i.type,this._map,i))}touchstart(i){return this._firePreventable(new La(i.type,this._map,i))}touchmove(i){this._map.fire(new La(i.type,this._map,i))}touchend(i){this._map.fire(new La(i.type,this._map,i))}touchcancel(i){this._map.fire(new La(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ca{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,delete this._contextMenuEvent}mousemove(i){this._map.fire(new wo(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new wo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new wo(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class mc{constructor(i,u){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=u.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,u){this.isEnabled()&&i.shiftKey&&0===i.button&&(te.disableDrag(),this._startPos=this._lastPos=u,this._active=!0)}mousemoveWindow(i,u){if(!this._active)return;const m=u;if(this._lastPos.equals(m)||!this._box&&m.dist(this._startPos)<this._clickTolerance)return;const b=this._startPos;this._lastPos=m,this._box||(this._box=te.create("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const w=Math.min(b.x,m.x),k=Math.max(b.x,m.x),Z=Math.min(b.y,m.y),J=Math.max(b.y,m.y);this._map._requestDomTask(()=>{this._box&&(te.setTransform(this._box,`translate(${w}px,${Z}px)`),this._box.style.width=k-w+"px",this._box.style.height=J-Z+"px")})}mouseupWindow(i,u){if(!this._active||0!==i.button)return;const m=this._startPos,b=u;if(this.reset(),te.suppressClick(),m.x!==b.x||m.y!==b.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:w=>w.fitScreenCoordinates(m,b,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(te.remove(this._box),this._box=null),te.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(i,u){return this._map.fire(new l.Event(i,{originalEvent:u}))}}function ql(g,i){const u={};for(let m=0;m<g.length;m++)u[g[m].identifier]=i[m];return u}class el{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(i,u,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(void 0===this.startTime&&(this.startTime=i.timeStamp),m.length===this.numTouches&&(this.centroid=function(b){const w=new l.pointGeometry(0,0);for(const k of b)w._add(k);return w.div(b.length)}(u),this.touches=ql(m,u)))}touchmove(i,u,m){if(this.aborted||!this.centroid)return;const b=ql(m,u);for(const w in this.touches){const k=this.touches[w],Z=b[w];(!Z||Z.dist(k)>30)&&(this.aborted=!0)}}touchend(i,u,m){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===m.length){const b=!this.aborted&&this.centroid;if(this.reset(),b)return b}}}class tl{constructor(i){this.singleTap=new el(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(i,u,m){this.singleTap.touchstart(i,u,m)}touchmove(i,u,m){this.singleTap.touchmove(i,u,m)}touchend(i,u,m){const b=this.singleTap.touchend(i,u,m);if(b){const w=i.timeStamp-this.lastTime<500,k=!this.lastTap||this.lastTap.dist(b)<30;if(w&&k||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=b,this.count===this.numTaps)return this.reset(),b}}}class Gc{constructor(){this._zoomIn=new tl({numTouches:1,numTaps:2}),this._zoomOut=new tl({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,u,m){this._zoomIn.touchstart(i,u,m),this._zoomOut.touchstart(i,u,m)}touchmove(i,u,m){this._zoomIn.touchmove(i,u,m),this._zoomOut.touchmove(i,u,m)}touchend(i,u,m){const b=this._zoomIn.touchend(i,u,m),w=this._zoomOut.touchend(i,u,m);return b?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()+1,around:k.unproject(b)},{originalEvent:i})}):w?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:k=>k.easeTo({duration:300,zoom:k.getZoom()-1,around:k.unproject(w)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Bo={0:1,2:2};class Wc{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,delete this._lastPoint,delete this._eventButton}_correctButton(i,u){return!1}_move(i,u){return{}}mousedown(i,u){if(this._lastPoint)return;const m=te.mouseButton(i);this._correctButton(i,m)&&(this._lastPoint=u,this._eventButton=m)}mousemoveWindow(i,u){const m=this._lastPoint;if(m)if(i.preventDefault(),function(b,w){const k=Bo[w];return void 0===b.buttons||(b.buttons&k)!==k}(i,this._eventButton))this.reset();else if(this._moved||!(u.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=u,this._move(m,u)}mouseupWindow(i){this._lastPoint&&te.mouseButton(i)===this._eventButton&&(this._moved&&te.suppressClick(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ta extends Wc{mousedown(i,u){super.mousedown(i,u),this._lastPoint&&(this._active=!0)}_correctButton(i,u){return 0===u&&!i.ctrlKey}_move(i,u){return{around:u,panDelta:u.sub(i)}}}class mo extends Wc{_correctButton(i,u){return 0===u&&i.ctrlKey||2===u}_move(i,u){const m=.8*(u.x-i.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(i){i.preventDefault()}}class Ws extends Wc{_correctButton(i,u){return 0===u&&i.ctrlKey||2===u}_move(i,u){const m=-.5*(u.y-i.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(i){i.preventDefault()}}class Fs{constructor(i){this._minTouches=1,this._clickTolerance=i.clickTolerance||1,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new l.pointGeometry(0,0)}touchstart(i,u,m){return this._calculateTransform(i,u,m)}touchmove(i,u,m){if(this._active&&!(m.length<this._minTouches))return i.preventDefault(),this._calculateTransform(i,u,m)}touchend(i,u,m){this._calculateTransform(i,u,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,u,m){m.length>0&&(this._active=!0);const b=ql(m,u),w=new l.pointGeometry(0,0),k=new l.pointGeometry(0,0);let Z=0;for(const se in b){const he=b[se],be=this._touches[se];be&&(w._add(he),k._add(he.sub(be)),Z++,b[se]=he)}if(this._touches=b,Z<this._minTouches||!k.mag())return;const J=k.div(Z);return this._sum._add(J),this._sum.mag()<this._clickTolerance?void 0:{around:w.div(Z),panDelta:J}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ca{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}_start(i){}_move(i,u,m){return{}}touchstart(i,u,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([u[0],u[1]]))}touchmove(i,u,m){if(!this._firstTwoTouches)return;i.preventDefault();const[b,w]=this._firstTwoTouches,k=ka(m,u,b),Z=ka(m,u,w);if(!k||!Z)return;const J=this._aroundCenter?null:k.add(Z).div(2);return this._move([k,Z],J,i)}touchend(i,u,m){if(!this._firstTwoTouches)return;const[b,w]=this._firstTwoTouches,k=ka(m,u,b),Z=ka(m,u,w);k&&Z||(this._active&&te.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ka(g,i,u){for(let m=0;m<g.length;m++)if(g[m].identifier===u)return i[m]}function Ea(g,i){return Math.log(g/i)/Math.LN2}class nl extends ca{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,u){const m=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(Ea(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Ea(this._distance,m),pinchAround:u}}}function _c(g,i){return 180*g.angleWith(i)/Math.PI}class Ns extends ca{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,u){const m=this._vector;if(this._vector=i[0].sub(i[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:_c(this._vector,m),pinchAround:u}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const u=25/(Math.PI*this._minDiameter)*360,m=_c(i,this._startVector);return Math.abs(m)<u}}function Qo(g){return Math.abs(g.y)>Math.abs(g.x)}class il extends ca{reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}_start(i){this._lastPoints=i,Qo(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,u,m){const b=i[0].sub(this._lastPoints[0]),w=i[1].sub(this._lastPoints[1]);if(this._valid=this.gestureBeginsVertically(b,w,m.timeStamp),this._valid)return this._lastPoints=i,this._active=!0,{pitchDelta:(b.y+w.y)/2*-.5}}gestureBeginsVertically(i,u,m){if(void 0!==this._valid)return this._valid;const b=i.mag()>=2,w=u.mag()>=2;if(!b&&!w)return;if(!b||!w)return void 0===this._firstMove&&(this._firstMove=m),m-this._firstMove<100&&void 0;const k=i.y>0==u.y>0;return Qo(i)&&Qo(u)&&k}}const Yc={panStep:100,bearingStep:15,pitchStep:10};class Ia{constructor(){const i=Yc;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let u=0,m=0,b=0,w=0,k=0;switch(i.keyCode){case 61:case 107:case 171:case 187:u=1;break;case 189:case 109:case 173:u=-1;break;case 37:i.shiftKey?m=-1:(i.preventDefault(),w=-1);break;case 39:i.shiftKey?m=1:(i.preventDefault(),w=1);break;case 38:i.shiftKey?b=1:(i.preventDefault(),k=-1);break;case 40:i.shiftKey?b=-1:(i.preventDefault(),k=1);break;default:return}return this._rotationDisabled&&(m=0,b=0),{cameraAnimation:Z=>{const J=Z.getZoom();Z.easeTo({duration:300,easeId:"keyboardHandler",easing:Jn,zoom:u?Math.round(J)+u*(i.shiftKey?2:1):J,bearing:Z.getBearing()+m*this._bearingStep,pitch:Z.getPitch()+b*this._pitchStep,offset:[-w*this._panStep,-k*this._panStep],center:Z.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Jn(g){return g*(2-g)}const ua=4.000244140625;class yc{constructor(i,u){this._map=i,this._el=i.getCanvasContainer(),this._handler=u,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return!!this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=i&&"center"===i.around)}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(i){if(!this.isEnabled())return;let u=i.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const m=l.exported.now(),b=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,0!==u&&u%ua==0?this._type="wheel":0!==u&&Math.abs(u)<4?this._type="trackpad":b>400?(this._type=null,this._lastValue=u,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(b*u)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,u+=this._lastValue)),i.shiftKey&&u&&(u/=4),this._type&&(this._lastWheelEvent=i,this._delta-=u,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const u=te.mousePos(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:u,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform,u=()=>i._terrainEnabled()?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const J="wheel"===this._type&&Math.abs(this._delta)>ua?this._wheelZoomRate:this._defaultZoomRate;let se=2/(1+Math.exp(-Math.abs(this._delta*J)));this._delta<0&&0!==se&&(se=1/se);const he=u(),be=Math.pow(2,he),Ce="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):be;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(Ce*se))),"wheel"===this._type&&(this._startZoom=u(),this._easing=this._smoothOutEasing(200)),this._delta=0}const m="number"==typeof this._targetZoom?this._targetZoom:u(),b=this._startZoom,w=this._easing;let k,Z=!1;if("wheel"===this._type&&b&&w){const J=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),se=w(J);k=l.number(b,m,se),J<1?this._frameId||(this._frameId=!0):Z=!0}else k=m,Z=!0;return this._active=!0,Z&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!Z,zoomDelta:k-u(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let u=l.ease;if(this._prevEase){const m=this._prevEase,b=(l.exported.now()-m.start)/m.duration,w=m.easing(b+.01)-m.easing(b),k=.27/Math.sqrt(w*w+1e-4)*.01,Z=Math.sqrt(.0729-k*k);u=l.bezier(k,Z,.25,1)}return this._prevEase={start:l.exported.now(),duration:i,easing:u},u}blur(){this.reset()}reset(){this._active=!1}}class da{constructor(i,u){this._clickZoom=i,this._tapZoom=u}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Fa{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,u){return i.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(i.shiftKey?-1:1),around:m.unproject(u)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Hl{constructor(){this._tap=new tl({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,this._tap.reset()}touchstart(i,u,m){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=u[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(i,u,m))}touchmove(i,u,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const b=u[0],w=b.y-this._swipePoint.y;return this._swipePoint=b,i.preventDefault(),this._active=!0,{zoomDelta:w/128}}}else this._tap.touchmove(i,u,m)}touchend(i,u,m){this._tapTime?this._swipePoint&&0===m.length&&this.reset():this._tap.touchend(i,u,m)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class yl{constructor(i,u,m){this._el=i,this._mousePan=u,this._touchPan=m}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class vl{constructor(i,u,m){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=u,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Jc{constructor(i,u,m,b){this._el=i,this._touchZoom=u,this._touchRotate=m,this._tapDragZoom=b,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Na=g=>g.zoom||g.drag||g.pitch||g.rotate;class vc extends l.Event{}class xc{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,u){const m=l.sub([],u,i);this.radius=l.length(m[2]<0?l.div([],m,this.constants):[m[0],m[1],0])}projectRay(i){l.div(i,i,this.constants),l.normalize(i,i),l.mul$2(i,i,this.constants);const u=l.scale([],i,this.radius);if(u[2]>0){const m=l.scale([],[0,0,1],l.dot(u,[0,0,1])),b=l.scale([],l.normalize([],[u[0],u[1],0]),this.radius),w=l.add([],u,l.scale([],l.sub([],l.add([],b,m),u),2));u[0]=w[0],u[1]=w[1]}return u}}function Da(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class xl{constructor(i,u){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Qa(i),this._bearingSnap=u.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new xc,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(u),l.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[l.window,"blur",void 0]];for(const[b,w,k]of this._listeners)te.addEventListener(b,w,b===l.window.document?this.handleWindowEvent:this.handleEvent,k)}destroy(){for(const[i,u,m]of this._listeners)te.removeEventListener(i,u,i===l.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(i){const u=this._map,m=u.getCanvasContainer();this._add("mapEvent",new us(u,i));const b=u.boxZoom=new mc(u,i);this._add("boxZoom",b);const w=new Gc,k=new Fa;u.doubleClickZoom=new da(k,w),this._add("tapZoom",w),this._add("clickZoom",k);const Z=new Hl;this._add("tapDragZoom",Z);const J=u.touchPitch=new il;this._add("touchPitch",J);const se=new mo(i),he=new Ws(i);u.dragRotate=new vl(i,se,he),this._add("mouseRotate",se,["mousePitch"]),this._add("mousePitch",he,["mouseRotate"]);const be=new Ta(i),Ce=new Fs(i);u.dragPan=new yl(m,be,Ce),this._add("mousePan",be),this._add("touchPan",Ce,["touchZoom","touchRotate"]);const Me=new Ns,Ve=new nl;u.touchZoomRotate=new Jc(m,Ve,Me,Z),this._add("touchRotate",Me,["touchPan","touchZoom"]),this._add("touchZoom",Ve,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Ca(u));const qe=u.scrollZoom=new yc(u,this);this._add("scrollZoom",qe,["mousePan"]);const ht=u.keyboard=new Ia;this._add("keyboard",ht);for(const Be of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[Be]&&u[Be].enable(i[Be])}_add(i,u,m){this._handlers.push({handlerName:i,handler:u,allowed:m}),this._handlersById[i]=u}stop(i){if(!this._updatingCamera){for(const{handler:u}of this._handlers)u.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return Boolean(Na(this._eventsInProgress))||this.isZooming()}_blockedByActive(i,u,m){for(const b in i)if(b!==m&&(!u||u.indexOf(b)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const u=[];for(const m of i)this._el.contains(m.target)&&u.push(m);return u}handleEvent(i,u){this._updatingCamera=!0;const m="renderFrame"===i.type,b=m?void 0:i,w={needsRenderFrame:!1},k={},Z={},J=i.touches?this._getMapTouches(i.touches):void 0,se=J?te.touchPos(this._el,J):m?void 0:te.mousePos(this._el,i);for(const{handlerName:Ce,handler:Me,allowed:Ve}of this._handlers){if(!Me.isEnabled())continue;let qe;this._blockedByActive(Z,Ve,Ce)?Me.reset():Me[u||i.type]&&(qe=Me[u||i.type](i,se,J),this.mergeHandlerResult(w,k,qe,Ce,b),qe&&qe.needsRenderFrame&&this._triggerRenderFrame()),(qe||Me.isActive())&&(Z[Ce]=Me)}const he={};for(const Ce in this._previousActiveHandlers)Z[Ce]||(he[Ce]=b);this._previousActiveHandlers=Z,(Object.keys(he).length||Da(w))&&(this._changes.push([w,k,he]),this._triggerRenderFrame()),(Object.keys(Z).length||Da(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:be}=w;be&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],be(this._map))}mergeHandlerResult(i,u,m,b,w){if(!m)return;l.extend(i,m);const k={handlerName:b,originalEvent:m.originalEvent||w};void 0!==m.zoomDelta&&(u.zoom=k),void 0!==m.panDelta&&(u.drag=k),void 0!==m.pitchDelta&&(u.pitch=k),void 0!==m.bearingDelta&&(u.rotate=k)}_applyChanges(){const i={},u={},m={};for(const[b,w,k]of this._changes)b.panDelta&&(i.panDelta=(i.panDelta||new l.pointGeometry(0,0))._add(b.panDelta)),b.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+b.zoomDelta),b.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+b.bearingDelta),b.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+b.pitchDelta),void 0!==b.around&&(i.around=b.around),void 0!==b.aroundCoord&&(i.aroundCoord=b.aroundCoord),void 0!==b.pinchAround&&(i.pinchAround=b.pinchAround),b.noInertia&&(i.noInertia=b.noInertia),l.extend(u,w),l.extend(m,k);this._updateMapTransform(i,u,m),this._changes=[]}_updateMapTransform(i,u,m){const b=this._map,w=b.transform,k=Je=>[Je.x,Je.y,Je.z];if((Je=>{const dt=this._eventsInProgress.drag;return dt&&!this._handlersById[dt.handlerName].isActive()})()&&!Da(i)){const Je=w.zoom;w.cameraElevationReference="sea",w.recenterOnTerrain(),w.cameraElevationReference="ground",Je!==w.zoom&&this._map._update(!0)}if(!Da(i))return this._fireEvents(u,m,!0);let{panDelta:Z,zoomDelta:J,bearingDelta:se,pitchDelta:he,around:be,aroundCoord:Ce,pinchAround:Me}=i;void 0!==Me&&(be=Me),(Je=>u.drag&&!this._eventsInProgress.drag)()&&be&&(this._dragOrigin=k(w.pointCoordinate3D(be)),this._trackingEllipsoid.setup(w._camera.position,this._dragOrigin)),w.cameraElevationReference="sea",b._stop(!0),be=be||b.transform.centerPoint,se&&(w.bearing+=se),he&&(w.pitch+=he),w._updateCameraState();const Ve=[0,0,0];if(Z){const Je=w.screenPointToMercatorRay(be),dt=w.screenPointToMercatorRay(be.sub(Z)),_t=this._trackingEllipsoid.projectRay(Je.dir),wt=this._trackingEllipsoid.projectRay(dt.dir);Ve[0]=wt[0]-_t[0],Ve[1]=wt[1]-_t[1]}const qe=w.zoom,ht=[0,0,0];if(J){const Je=k(Ce||w.pointCoordinate3D(be)),dt={dir:l.normalize([],l.sub([],Je,w._camera.position))},_t=w.screenPointToMercatorRay(w.centerPoint);if(dt.dir[2]<0){const wt=l.altitudeFromMercatorZ(Je[2],Je[1]),nt=w.rayIntersectionCoordinate(w.pointRayIntersection(w.centerPoint,wt)),Pt=w.zoomDeltaToMovement(k(nt),J)*(_t.dir[2]/dt.dir[2]);l.scale(ht,dt.dir,Pt)}else if(w._terrainEnabled()){const wt=w.zoomDeltaToMovement(Je,J);l.scale(ht,dt.dir,wt)}}const Be=l.add(Ve,Ve,ht);w._translateCameraConstrained(Be),J&&Math.abs(w.zoom-qe)>1e-4&&w.recenterOnTerrain(),w.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(u,m,!0)}_fireEvents(i,u,m){const b=Na(this._eventsInProgress),w=Na(i),k={};for(const he in i){const{originalEvent:be}=i[he];this._eventsInProgress[he]||(k[`${he}start`]=be),this._eventsInProgress[he]=i[he]}!b&&w&&this._fireEvent("movestart",w.originalEvent);for(const he in k)this._fireEvent(he,k[he]);w&&this._fireEvent("move",w.originalEvent);for(const he in i){const{originalEvent:be}=i[he];this._fireEvent(he,be)}const Z={};let J;for(const he in this._eventsInProgress){const{handlerName:be,originalEvent:Ce}=this._eventsInProgress[he];this._handlersById[be].isActive()||(delete this._eventsInProgress[he],J=u[be]||Ce,Z[`${he}end`]=J)}for(const he in Z)this._fireEvent(he,Z[he]);const se=Na(this._eventsInProgress);if(m&&(b||w)&&!se){this._updatingCamera=!0;const he=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),be=Ce=>0!==Ce&&-this._bearingSnap<Ce&&Ce<this._bearingSnap;he?(be(he.bearing||this._map.getBearing())&&(he.bearing=0),this._map.easeTo(he,{originalEvent:J})):(this._map.fire(new l.Event("moveend",{originalEvent:J})),be(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,u){this._map.fire(new l.Event(i,u?{originalEvent:u}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{delete this._frameId,this.handleEvent(new vc("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}class Gl extends l.Evented{constructor(i,u){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=u.bearingSnap,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,u){return this.jumpTo({center:i},u)}panBy(i,u,m){return i=l.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,l.extend({offset:i},u),m)}panTo(i,u,m){return this.easeTo(l.extend({center:i},u),m)}getZoom(){return this.transform.zoom}setZoom(i,u){return this.jumpTo({zoom:i},u),this}zoomTo(i,u,m){return this.easeTo(l.extend({zoom:i},u),m)}zoomIn(i,u){return this.zoomTo(this.getZoom()+1,i,u),this}zoomOut(i,u){return this.zoomTo(this.getZoom()-1,i,u),this}getBearing(){return this.transform.bearing}setBearing(i,u){return this.jumpTo({bearing:i},u),this}getPadding(){return this.transform.padding}setPadding(i,u){return this.jumpTo({padding:i},u),this}rotateTo(i,u,m){return this.easeTo(l.extend({bearing:i},u),m)}resetNorth(i,u){return this.rotateTo(0,l.extend({duration:1e3},i),u),this}resetNorthPitch(i,u){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},i),u),this}snapToNorth(i,u){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,u):this}getPitch(){return this.transform.pitch}setPitch(i,u){return this.jumpTo({pitch:i},u),this}cameraForBounds(i,u){i=l.LngLatBounds.convert(i);const m=u&&u.bearing||0;return this._cameraForBoxAndBearing(i.getNorthWest(),i.getSouthEast(),m,u)}_extendCameraOptions(i){const u={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=l.extend({padding:u,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const m=i.padding;i.padding={top:m,bottom:m,right:m,left:m}}return i.padding=l.extend(u,i.padding),i}_cameraForBoxAndBearing(i,u,m,b){const w=this._extendCameraOptions(b),k=this.transform,Z=k.padding,J=k.project(l.LngLat.convert(i)),se=k.project(l.LngLat.convert(u)),he=J.rotate(-l.degToRad(m)),be=se.rotate(-l.degToRad(m)),Ce=new l.pointGeometry(Math.max(he.x,be.x),Math.max(he.y,be.y)),Me=new l.pointGeometry(Math.min(he.x,be.x),Math.min(he.y,be.y)),Ve=Ce.sub(Me),qe=(k.width-(Z.left+Z.right+w.padding.left+w.padding.right))/Ve.x,ht=(k.height-(Z.top+Z.bottom+w.padding.top+w.padding.bottom))/Ve.y;if(ht<0||qe<0)return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const Be=Math.min(k.scaleZoom(k.scale*Math.min(qe,ht)),w.maxZoom),Je="number"==typeof w.offset.x?new l.pointGeometry(w.offset.x,w.offset.y):l.pointGeometry.convert(w.offset),dt=new l.pointGeometry((w.padding.left-w.padding.right)/2,(w.padding.top-w.padding.bottom)/2).rotate(m*Math.PI/180),_t=Je.add(dt).mult(k.scale/k.zoomScale(Be));return{center:k.unproject(J.add(se).div(2).sub(_t)),zoom:Be,bearing:m}}_cameraForBox(i,u,m,b,w){const k=this._extendCameraOptions(w);m=m||0,b=b||0,i=l.LngLat.convert(i),u=l.LngLat.convert(u);const Z=this.transform.clone();Z.padding=k.padding;const J=this.getFreeCameraOptions(),se=new l.LngLat(.5*(i.lng+u.lng),.5*(i.lat+u.lat)),he=.5*(m+b);if(Z._camera.position[2]<l.mercatorZfromAltitude(he,se.lat))return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.");J.lookAtPoint(se),Z.setFreeCameraOptions(J);const be=l.MercatorCoordinate.fromLngLat(i),Ce=l.MercatorCoordinate.fromLngLat(u),Me=Z.pointRayIntersection(Z.centerPoint,he),Ve=[(qe=Z.rayIntersectionCoordinate(Me)).x,qe.y,qe.z];var qe;const ht=Z.screenPointToMercatorRay(Z.centerPoint);let Be,Je=0;do{const dt=Math.floor(Z.zoom),_t=1<<dt,wt=Math.min(_t*be.x,_t*Ce.x),nt=Math.min(_t*be.y,_t*Ce.y),Pt=Math.max(_t*be.x,_t*Ce.x),dn=Math.max(_t*be.y,_t*Ce.y),wn=new Ne([wt,nt,m],[Pt,dn,b]),Rt=ze.fromInvProjectionMatrix(Z.invProjMatrix,Z.worldSize,dt);if(2!==wn.intersects(Rt)){Be&&(Z._camera.position=l.scaleAndAdd([],Z._camera.position,ht.dir,-Be),Z._updateStateFromCamera());break}const sn=l.sub([],Z._camera.position,Ve);Be=.5*l.length(sn),Z._camera.position=l.scaleAndAdd([],Z._camera.position,ht.dir,Be);try{Z._updateStateFromCamera()}catch{return void l.warnOnce("Map cannot fit within canvas with the given bounds, padding, and/or offset.")}}while(++Je<10);return{center:Z.center,zoom:Z.zoom,bearing:Z.bearing,pitch:Z.pitch}}fitBounds(i,u,m){return this._fitInternal(this.cameraForBounds(i,u),u,m)}_raycastElevationBox(i,u){const m=this.transform.elevation;if(!m)return;const b=new l.pointGeometry(i.x,u.y),w=new l.pointGeometry(u.x,i.y),k=m.pointCoordinate(i);if(!k)return;const Z=m.pointCoordinate(u);if(!Z)return;const J=m.pointCoordinate(b);if(!J)return;const se=m.pointCoordinate(w);if(!se)return;const he=new l.MercatorCoordinate(k[0],k[1]).toLngLat(),be=new l.MercatorCoordinate(Z[0],Z[1]).toLngLat(),Ce=new l.MercatorCoordinate(J[0],J[1]).toLngLat(),Me=new l.MercatorCoordinate(se[0],se[1]).toLngLat(),Ve=Math.min(he.lng,Math.min(be.lng,Math.min(Ce.lng,Me.lng))),qe=Math.min(he.lat,Math.min(be.lat,Math.min(Ce.lat,Me.lat))),ht=Math.max(he.lng,Math.max(be.lng,Math.max(Ce.lng,Me.lng))),Be=Math.max(he.lat,Math.max(be.lat,Math.max(Ce.lat,Me.lat))),Je=Math.min(k[3],Math.min(Z[3],Math.min(J[3],se[3]))),dt=Math.max(k[3],Math.max(Z[3],Math.max(J[3],se[3])));return{minLngLat:new l.LngLat(Ve,qe),maxLngLat:new l.LngLat(ht,Be),minAltitude:Je,maxAltitude:dt}}fitScreenCoordinates(i,u,m,b,w){let k,Z,J,se;const he=l.pointGeometry.convert(i),be=l.pointGeometry.convert(u),Ce=this._raycastElevationBox(he,be);if(Ce)k=Ce.minLngLat,Z=Ce.maxLngLat,J=Ce.minAltitude,se=Ce.maxAltitude;else{if(this.transform.isCornerOffEdge(he,be))return this;k=this.transform.pointLocation(he),Z=this.transform.pointLocation(be)}return this._fitInternal(0===this.transform.pitch?this._cameraForBoxAndBearing(this.transform.pointLocation(l.pointGeometry.convert(i)),this.transform.pointLocation(l.pointGeometry.convert(u)),m,b):this._cameraForBox(k,Z,J,se,b),b,w)}_fitInternal(i,u,m){return i?(delete(u=l.extend(i,u)).padding,u.linear?this.easeTo(u,m):this.flyTo(u,m)):this}jumpTo(i,u){this.stop();const m=this.transform;let b=!1,w=!1,k=!1;return"zoom"in i&&m.zoom!==+i.zoom&&(b=!0,m.zoom=+i.zoom),void 0!==i.center&&(m.center=l.LngLat.convert(i.center)),"bearing"in i&&m.bearing!==+i.bearing&&(w=!0,m.bearing=+i.bearing),"pitch"in i&&m.pitch!==+i.pitch&&(k=!0,m.pitch=+i.pitch),null==i.padding||m.isPaddingEqual(i.padding)||(m.padding=i.padding),this.fire(new l.Event("movestart",u)).fire(new l.Event("move",u)),b&&this.fire(new l.Event("zoomstart",u)).fire(new l.Event("zoom",u)).fire(new l.Event("zoomend",u)),w&&this.fire(new l.Event("rotatestart",u)).fire(new l.Event("rotate",u)).fire(new l.Event("rotateend",u)),k&&this.fire(new l.Event("pitchstart",u)).fire(new l.Event("pitch",u)).fire(new l.Event("pitchend",u)),this.fire(new l.Event("moveend",u))}getFreeCameraOptions(){return this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,u){this.stop();const m=this.transform,b=m.zoom,w=m.pitch,k=m.bearing;m.setFreeCameraOptions(i);const Z=b!==m.zoom,J=w!==m.pitch,se=k!==m.bearing;return this.fire(new l.Event("movestart",u)).fire(new l.Event("move",u)),Z&&this.fire(new l.Event("zoomstart",u)).fire(new l.Event("zoom",u)).fire(new l.Event("zoomend",u)),se&&this.fire(new l.Event("rotatestart",u)).fire(new l.Event("rotate",u)).fire(new l.Event("rotateend",u)),J&&this.fire(new l.Event("pitchstart",u)).fire(new l.Event("pitch",u)).fire(new l.Event("pitchend",u)),this.fire(new l.Event("moveend",u)),this}easeTo(i,u){this._stop(!1,i.easeId),(!1===(i=l.extend({offset:[0,0],duration:500,easing:l.ease},i)).animate||!i.essential&&l.exported.prefersReducedMotion)&&(i.duration=0);const m=this.transform,b=this.getZoom(),w=this.getBearing(),k=this.getPitch(),Z=this.getPadding(),J="zoom"in i?+i.zoom:b,se="bearing"in i?this._normalizeBearing(i.bearing,w):w,he="pitch"in i?+i.pitch:k,be="padding"in i?i.padding:m.padding,Ce=l.pointGeometry.convert(i.offset);let Me=m.centerPoint.add(Ce);const Ve=m.pointLocation(Me),qe=l.LngLat.convert(i.center||Ve);this._normalizeCenter(qe);const ht=m.project(Ve),Be=m.project(qe).sub(ht),Je=m.zoomScale(J-b);let dt,_t;i.around&&(dt=l.LngLat.convert(i.around),_t=m.locationPoint(dt));const wt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||J!==b,this._rotating=this._rotating||w!==se,this._pitching=this._pitching||he!==k,this._padding=!m.isPaddingEqual(be),this._easeId=i.easeId,this._prepareEase(u,i.noMoveStart,wt),this._ease(nt=>{if(this._zooming&&(m.zoom=l.number(b,J,nt)),this._rotating&&(m.bearing=l.number(w,se,nt)),this._pitching&&(m.pitch=l.number(k,he,nt)),this._padding&&(m.interpolatePadding(Z,be,nt),Me=m.centerPoint.add(Ce)),dt)m.setLocationAtPoint(dt,_t);else{const Pt=m.zoomScale(m.zoom-b),dn=J>b?Math.min(2,Je):Math.max(.5,Je),wn=Math.pow(dn,1-nt),Rt=m.unproject(ht.add(Be.mult(nt*wn)).mult(Pt));m.setLocationAtPoint(m.renderWorldCopies?Rt.wrap():Rt,Me)}this._fireMoveEvents(u)},nt=>{m.recenterOnTerrain(),this._afterEase(u,nt)},i),this}_prepareEase(i,u,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",u||m.moving||this.fire(new l.Event("movestart",i)),this._zooming&&!m.zooming&&this.fire(new l.Event("zoomstart",i)),this._rotating&&!m.rotating&&this.fire(new l.Event("rotatestart",i)),this._pitching&&!m.pitching&&this.fire(new l.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new l.Event("move",i)),this._zooming&&this.fire(new l.Event("zoom",i)),this._rotating&&this.fire(new l.Event("rotate",i)),this._pitching&&this.fire(new l.Event("pitch",i))}_afterEase(i,u){if(this._easeId&&u&&this._easeId===u)return;delete this._easeId,this.transform.cameraElevationReference="ground";const m=this._zooming,b=this._rotating,w=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new l.Event("zoomend",i)),b&&this.fire(new l.Event("rotateend",i)),w&&this.fire(new l.Event("pitchend",i)),this.fire(new l.Event("moveend",i))}flyTo(i,u){if(!i.essential&&l.exported.prefersReducedMotion){const Pn=l.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Pn,u)}this.stop(),i=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},i);const m=this.transform,b=this.getZoom(),w=this.getBearing(),k=this.getPitch(),Z=this.getPadding(),J="zoom"in i?l.clamp(+i.zoom,m.minZoom,m.maxZoom):b,se="bearing"in i?this._normalizeBearing(i.bearing,w):w,he="pitch"in i?+i.pitch:k,be="padding"in i?i.padding:m.padding,Ce=m.zoomScale(J-b),Me=l.pointGeometry.convert(i.offset);let Ve=m.centerPoint.add(Me);const qe=m.pointLocation(Ve),ht=l.LngLat.convert(i.center||qe);this._normalizeCenter(ht);const Be=m.project(qe),Je=m.project(ht).sub(Be);let dt=i.curve;const _t=Math.max(m.width,m.height),wt=_t/Ce,nt=Je.mag();if("minZoom"in i){const Pn=l.clamp(Math.min(i.minZoom,b,J),m.minZoom,m.maxZoom),Xn=_t/m.zoomScale(Pn-b);dt=Math.sqrt(Xn/nt*2)}const Pt=dt*dt;function dn(Pn){const Xn=(wt*wt-_t*_t+(Pn?-1:1)*Pt*Pt*nt*nt)/(2*(Pn?wt:_t)*Pt*nt);return Math.log(Math.sqrt(Xn*Xn+1)-Xn)}function wn(Pn){return(Math.exp(Pn)-Math.exp(-Pn))/2}function Rt(Pn){return(Math.exp(Pn)+Math.exp(-Pn))/2}const sn=dn(0);let $n=function(Pn){return Rt(sn)/Rt(sn+dt*Pn)},Kn=function(Pn){return _t*((Rt(sn)*(wn(Xn=sn+dt*Pn)/Rt(Xn))-wn(sn))/Pt)/nt;var Xn},Gn=(dn(1)-sn)/dt;if(Math.abs(nt)<1e-6||!isFinite(Gn)){if(Math.abs(_t-wt)<1e-6)return this.easeTo(i,u);const Pn=wt<_t?-1:1;Gn=Math.abs(Math.log(wt/_t))/dt,Kn=function(){return 0},$n=function(Xn){return Math.exp(Pn*dt*Xn)}}return i.duration="duration"in i?+i.duration:1e3*Gn/("screenSpeed"in i?+i.screenSpeed/dt:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0),this._zooming=!0,this._rotating=w!==se,this._pitching=he!==k,this._padding=!m.isPaddingEqual(be),this._prepareEase(u,!1),this._ease(Pn=>{const Xn=Pn*Gn,qi=1/$n(Xn);m.zoom=1===Pn?J:b+m.scaleZoom(qi),this._rotating&&(m.bearing=l.number(w,se,Pn)),this._pitching&&(m.pitch=l.number(k,he,Pn)),this._padding&&(m.interpolatePadding(Z,be,Pn),Ve=m.centerPoint.add(Me));const Li=1===Pn?ht:m.unproject(Be.add(Je.mult(Kn(Xn))).mult(qi));m.setLocationAtPoint(m.renderWorldCopies?Li.wrap():Li,Ve),m._updateCenterElevation(),this._fireMoveEvents(u)},()=>this._afterEase(u),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,u){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const m=this._onEaseEnd;delete this._onEaseEnd,m.call(this,u)}if(!i){const m=this.handlers;m&&m.stop(!1)}return this}_ease(i,u,m){!1===m.animate||0===m.duration?(i(1),u()):(this._easeStart=l.exported.now(),this._easeOptions=m,this._onEaseFrame=i,this._onEaseEnd=u,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,u){i=l.wrap(i,-180,180);const m=Math.abs(i-u);return Math.abs(i-360-u)<m&&(i-=360),Math.abs(i+360-u)<m&&(i+=360),i}_normalizeCenter(i){const u=this.transform;if(!u.renderWorldCopies||u.lngRange)return;const m=i.lng-u.center.lng;i.lng+=m>180?-360:m<-180?360:0}}class rl{constructor(i={}){this.options=i,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const u=this.options&&this.options.compact;return this._map=i,this._container=te.create("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=te.create("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=te.create("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),u&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===u&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){te.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,u){const m=this._map._getUIString(`AttributionControl.${u}`);i.title=m,i.setAttribute("aria-label",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-pressed","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const u=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(i){const m=u.reduce((b,w,k)=>(w.value&&(b+=`${w.key}=${w.value}${k<u.length-1?"&":""}`),b),"?");i.href=`${l.config.FEEDBACK_URL}/${m}${this._map._hash?this._map._hash.getHashString(!0):""}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=i.concat(this.options.customAttribution.map(b=>"string"!=typeof b?"":b)):"string"==typeof this.options.customAttribution&&i.push(this.options.customAttribution)),this._map.style.stylesheet){const b=this._map.style.stylesheet;this.styleOwner=b.owner,this.styleId=b.id}const u=this._map.style._sourceCaches;for(const b in u){const w=u[b];if(w.used){const k=w.getSource();k.attribution&&i.indexOf(k.attribution)<0&&i.push(k.attribution)}}i.sort((b,w)=>b.length-w.length),i=i.filter((b,w)=>{for(let k=w+1;k<i.length;k++)if(i[k].indexOf(b)>=0)return!1;return!0});const m=i.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,i.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Aa{constructor(){l.bindAll(["_updateLogo"],this),l.bindAll(["_updateCompact"],this)}onAdd(i){this._map=i,this._container=te.create("div","mapboxgl-ctrl");const u=te.create("a","mapboxgl-ctrl-logo");return u.target="_blank",u.rel="noopener nofollow",u.href="https://www.mapbox.com/",u.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),u.setAttribute("rel","noopener nofollow"),this._container.appendChild(u),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){te.remove(this._container),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const u in i){const m=i[u].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const u=i[0];this._map.getCanvasContainer().offsetWidth<250?u.classList.add("mapboxgl-compact"):u.classList.remove("mapboxgl-compact")}}}class bc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const u=++this._id;return this._queue.push({callback:i,id:u,cancelled:!1}),u}remove(i){const u=this._currentlyRunning,m=u?this._queue.concat(u):this._queue;for(const b of m)if(b.id===i)return void(b.cancelled=!0)}run(i=0){const u=this._currentlyRunning=this._queue;this._queue=[];for(const m of u)if(!m.cancelled&&(m.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function wc(g,i,u){if(g=new l.LngLat(g.lng,g.lat),i){const m=new l.LngLat(g.lng-360,g.lat),b=new l.LngLat(g.lng+360,g.lat),w=360*Math.ceil(Math.abs(g.lng-u.center.lng)/360),k=u.locationPoint(g).distSqr(i),Z=i.x<0||i.y<0||i.x>u.width||i.y>u.height;u.locationPoint(m).distSqr(i)<k&&(Z||Math.abs(m.lng-u.center.lng)<w)?g=m:u.locationPoint(b).distSqr(i)<k&&(Z||Math.abs(b.lng-u.center.lng)<w)&&(g=b)}for(;Math.abs(g.lng-u.center.lng)>180;){const m=u.locationPoint(g);if(m.x>=0&&m.y>=0&&m.x<=u.width&&m.y<=u.height)break;g.lng>u.center.lng?g.lng-=360:g.lng+=360}return g}const q={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class F extends l.Evented{constructor(i,u){if(super(),(i instanceof l.window.HTMLElement||u)&&(i=l.extend({element:i},u)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&"auto"!==i.pitchAlignment?i.pitchAlignment:this._rotationAlignment,i&&i.element)this._element=i.element,this._offset=l.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=te.create("div"),this._element.setAttribute("aria-label","Map marker");const b=te.createNS("http://www.w3.org/2000/svg","svg"),w=41,k=27;b.setAttributeNS(null,"display","block"),b.setAttributeNS(null,"height",`${w}px`),b.setAttributeNS(null,"width",`${k}px`),b.setAttributeNS(null,"viewBox",`0 0 ${k} ${w}`);const Z=te.createNS("http://www.w3.org/2000/svg","g");Z.setAttributeNS(null,"stroke","none"),Z.setAttributeNS(null,"stroke-width","1"),Z.setAttributeNS(null,"fill","none"),Z.setAttributeNS(null,"fill-rule","evenodd");const J=te.createNS("http://www.w3.org/2000/svg","g");J.setAttributeNS(null,"fill-rule","nonzero");const se=te.createNS("http://www.w3.org/2000/svg","g");se.setAttributeNS(null,"transform","translate(3.0, 29.0)"),se.setAttributeNS(null,"fill","#000000");const he=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const dt of he){const _t=te.createNS("http://www.w3.org/2000/svg","ellipse");_t.setAttributeNS(null,"opacity","0.04"),_t.setAttributeNS(null,"cx","10.5"),_t.setAttributeNS(null,"cy","5.80029008"),_t.setAttributeNS(null,"rx",dt.rx),_t.setAttributeNS(null,"ry",dt.ry),se.appendChild(_t)}const be=te.createNS("http://www.w3.org/2000/svg","g");be.setAttributeNS(null,"fill",this._color);const Ce=te.createNS("http://www.w3.org/2000/svg","path");Ce.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),be.appendChild(Ce);const Me=te.createNS("http://www.w3.org/2000/svg","g");Me.setAttributeNS(null,"opacity","0.25"),Me.setAttributeNS(null,"fill","#000000");const Ve=te.createNS("http://www.w3.org/2000/svg","path");Ve.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),Me.appendChild(Ve);const qe=te.createNS("http://www.w3.org/2000/svg","g");qe.setAttributeNS(null,"transform","translate(6.0, 7.0)"),qe.setAttributeNS(null,"fill","#FFFFFF");const ht=te.createNS("http://www.w3.org/2000/svg","g");ht.setAttributeNS(null,"transform","translate(8.0, 8.0)");const Be=te.createNS("http://www.w3.org/2000/svg","circle");Be.setAttributeNS(null,"fill","#000000"),Be.setAttributeNS(null,"opacity","0.25"),Be.setAttributeNS(null,"cx","5.5"),Be.setAttributeNS(null,"cy","5.5"),Be.setAttributeNS(null,"r","5.4999962");const Je=te.createNS("http://www.w3.org/2000/svg","circle");Je.setAttributeNS(null,"fill","#FFFFFF"),Je.setAttributeNS(null,"cx","5.5"),Je.setAttributeNS(null,"cy","5.5"),Je.setAttributeNS(null,"r","5.4999962"),ht.appendChild(Be),ht.appendChild(Je),J.appendChild(se),J.appendChild(be),J.appendChild(Me),J.appendChild(qe),J.appendChild(ht),b.appendChild(J),b.setAttributeNS(null,"height",w*this._scale+"px"),b.setAttributeNS(null,"width",k*this._scale+"px"),this._element.appendChild(b),this._offset=l.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",b=>{b.preventDefault()}),this._element.addEventListener("mousedown",b=>{b.preventDefault()});const m=this._element.classList;for(const b in q)m.remove(`mapboxgl-marker-anchor-${b}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._update),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._map.off("remove",this._clearFadeTimer),this._map._removeMarker(this),delete this._map),this._clearFadeTimer(),te.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=l.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const u=38.1,m=13.5,b=Math.sqrt(Math.pow(m,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-u],"bottom-left":[b,-1*(u-m+b)],"bottom-right":[-b,-1*(u-m+b)],left:[m,-1*(u-m)],right:[-m,-1*(u-m)]}:this._offset}this._popup=i,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}_onKeyPress(i){const u=i.code,m=i.charCode||i.keyCode;"Space"!==u&&"Enter"!==u&&32!==m&&13!==m||this.togglePopup()}_onMapClick(i){const u=i.originalEvent.target,m=this._element;this._popup&&(u===m||m.contains(u))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?i.remove():i.addTo(this._map),this):this}_evaluateOpacity(){const i=this._pos?this._pos.sub(this._transformedOffset()):null;if(!this._withinScreenBounds(i))return void this._clearFadeTimer();const u=this._map.unproject(i);let m=!1;if(this._map.getTerrain()){const w=this._map.getFreeCameraOptions();if(w.position){const k=w.position.toLngLat();m=k.distanceTo(u)<.9*k.distanceTo(this._lngLat)}}const b=(1-this._map._queryFogOpacity(u))*(m?.2:1);this._element.style.opacity=`${b}`,this._popup&&this._popup._setOpacity(`${b}`),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_withinScreenBounds(i){const u=this._map.transform;return!!i&&i.x>=0&&i.x<u.width&&i.y>=0&&i.y<u.height}_update(i){if(!this._map)return;this._map.transform.renderWorldCopies&&(this._lngLat=wc(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._transformedOffset());let u="";"viewport"===this._rotationAlignment||"auto"===this._rotationAlignment?u=`rotateZ(${this._rotation}deg)`:"map"===this._rotationAlignment&&(u=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let m="";"viewport"===this._pitchAlignment||"auto"===this._pitchAlignment?m="rotateX(0deg)":"map"===this._pitchAlignment&&(m=`rotateX(${this._map.getPitch()}deg)`),i&&"moveend"!==i.type||(this._pos=this._pos.round()),this._map._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&te.setTransform(this._element,`${q[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${m} ${u}`),!this._map.getTerrain()&&!this._map.getFog()||this._fadeTimer||(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})}_transformedOffset(){if(!this._defaultMarker)return this._offset;const i=this._map.transform,u=this._offset.mult(this._scale);return"map"===this._rotationAlignment&&u._rotate(i.angle),"map"===this._pitchAlignment&&(u.y*=Math.cos(i._pitch)),u}getOffset(){return this._offset}setOffset(i){return this._offset=l.pointGeometry.convert(i),this._update(),this}_onMove(i){if(!this._isDragging){const u=this._clickTolerance||this._map._clickTolerance;this._isDragging=i.point.dist(this._pointerdownPos)>=u}this._isDragging&&(this._pos=i.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag")))}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),"active"===this._state&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(i){this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(this._pos).add(this._transformedOffset()),this._pointerdownPos=i.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))}setDraggable(i){return this._draggable=!!i,this._map&&(i?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i&&"auto"!==i?i:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}class L{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const u=l.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-u)+this._end*u}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,u,m){this._start=this.getValue(u),this._end=i,this._startTime=u,this._endTime=u+m}}const X={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm"},{HTMLImageElement:de,HTMLElement:Pe,ImageBitmap:it}=l.window,xt={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0};function _n(g){g.parentNode&&g.parentNode.removeChild(g)}const di={showCompass:!0,showZoom:!0,visualizePitch:!1};class sr{constructor(i,u,m=!1){this._clickTolerance=10,this.element=u,this.mouseRotate=new mo({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,m&&(this.mousePitch=new Ws({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),te.addEventListener(u,"mousedown",this.mousedown),te.addEventListener(u,"touchstart",this.touchstart,{passive:!1}),te.addEventListener(u,"touchmove",this.touchmove),te.addEventListener(u,"touchend",this.touchend),te.addEventListener(u,"touchcancel",this.reset)}down(i,u){this.mouseRotate.mousedown(i,u),this.mousePitch&&this.mousePitch.mousedown(i,u),te.disableDrag()}move(i,u){const m=this.map,b=this.mouseRotate.mousemoveWindow(i,u);if(b&&b.bearingDelta&&m.setBearing(m.getBearing()+b.bearingDelta),this.mousePitch){const w=this.mousePitch.mousemoveWindow(i,u);w&&w.pitchDelta&&m.setPitch(m.getPitch()+w.pitchDelta)}}off(){const i=this.element;te.removeEventListener(i,"mousedown",this.mousedown),te.removeEventListener(i,"touchstart",this.touchstart,{passive:!1}),te.removeEventListener(i,"touchmove",this.touchmove),te.removeEventListener(i,"touchend",this.touchend),te.removeEventListener(i,"touchcancel",this.reset),this.offTemp()}offTemp(){te.enableDrag(),te.removeEventListener(l.window,"mousemove",this.mousemove),te.removeEventListener(l.window,"mouseup",this.mouseup)}mousedown(i){this.down(l.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),te.mousePos(this.element,i)),te.addEventListener(l.window,"mousemove",this.mousemove),te.addEventListener(l.window,"mouseup",this.mouseup)}mousemove(i){this.move(i,te.mousePos(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=te.touchPos(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=te.touchPos(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Mi={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1};let pr,cr=0,es=!1;const Ma={maxWidth:100,unit:"metric"};function fr(g,i,u){const m=u&&u.maxWidth||100,b=g._container.getBoundingClientRect().height/2,w=g.unproject([0,b]),k=g.unproject([m,b]),Z=w.distanceTo(k);if(u&&"imperial"===u.unit){const J=3.2808*Z;J>5280?ts(i,m,J/5280,g._getUIString("ScaleControl.Miles"),g):ts(i,m,J,g._getUIString("ScaleControl.Feet"),g)}else u&&"nautical"===u.unit?ts(i,m,Z/1852,g._getUIString("ScaleControl.NauticalMiles"),g):Z>=1e3?ts(i,m,Z/1e3,g._getUIString("ScaleControl.Kilometers"),g):ts(i,m,Z,g._getUIString("ScaleControl.Meters"),g)}function ts(g,i,u,m,b){const w=function(Z){const J=Math.pow(10,`${Math.floor(Z)}`.length-1);let se=Z/J;return se=se>=10?10:se>=5?5:se>=3?3:se>=2?2:se>=1?1:function(he){const be=Math.pow(10,Math.ceil(-Math.log(he)/Math.LN10));return Math.round(he*be)/be}(se),J*se}(u),k=w/u;b._requestDomTask(()=>{g.style.width=i*k+"px",g.innerHTML=`${w}&nbsp;${m}`})}const Wl={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},bl=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", "),Cc={version:l.version,supported:P,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends Gl{constructor(g){if(null!=(g=l.extend({},xt,g)).minZoom&&null!=g.maxZoom&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=g.minPitch&&null!=g.maxPitch&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=g.minPitch&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=g.maxPitch&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new Xr(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._renderTaskQueue=new bc,this._domRenderTaskQueue=new bc,this._controls=[],this._markers=[],this._mapId=l.uniqueId(),this._locale=l.extend({},X,g.locale),this._clickTolerance=g.clickTolerance,this._averageElevationLastSampledAt=-1/0,this._averageElevation=new L(0),this._requestManager=new l.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,"string"==typeof g.container){if(this._container=l.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof Pe))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(g.maxBounds&&this.setMaxBounds(g.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==l.window&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1),l.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1)),this.handlers=new xl(this,g),this._hash=g.hash&&new _l("string"==typeof g.hash&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,l.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.attributionControl&&this.addControl(new rl({customAttribution:g.customAttribution})),this._logoControl=new Aa,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update("style"===i.dataType),this.fire(new l.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new l.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(g,i){if(void 0===i&&(i=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const u=g.onAdd(this);this._controls.push(g);const m=this._controlPositions[i];return-1!==i.indexOf("bottom")?m.insertBefore(u,m.firstChild):m.appendChild(u),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(g);return i>-1&&this._controls.splice(i,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){const[i,u]=this._containerDimensions();if(i===this.transform.width&&u===this.transform.height)return this;this._resizeCanvas(i,u),this.transform.resize(i,u),this.painter.resize(Math.ceil(i),Math.ceil(u));const m=!this._moving;return m&&this.fire(new l.Event("movestart",g)).fire(new l.Event("move",g)),this.fire(new l.Event("resize",g)),m&&this.fire(new l.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(g){return this.transform.setMaxBounds(l.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g&&this.setZoom(g),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g&&this.setZoom(g),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g&&this.setPitch(g),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g&&this.setPitch(g),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this._update()}project(g){return this.transform.locationPoint3D(l.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(l.pointGeometry.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()}_createDelegatedListener(g,i,u){if("mouseenter"===g||"mouseover"===g){let m=!1;return{layer:i,listener:u,delegates:{mousemove:w=>{const k=this.getLayer(i)?this.queryRenderedFeatures(w.point,{layers:[i]}):[];k.length?m||(m=!0,u.call(this,new wo(g,this,w.originalEvent,{features:k}))):m=!1},mouseout:()=>{m=!1}}}}if("mouseleave"===g||"mouseout"===g){let m=!1;return{layer:i,listener:u,delegates:{mousemove:k=>{(this.getLayer(i)?this.queryRenderedFeatures(k.point,{layers:[i]}):[]).length?m=!0:m&&(m=!1,u.call(this,new wo(g,this,k.originalEvent)))},mouseout:k=>{m&&(m=!1,u.call(this,new wo(g,this,k.originalEvent)))}}}}{const m=b=>{const w=this.getLayer(i)?this.queryRenderedFeatures(b.point,{layers:[i]}):[];w.length&&(b.features=w,u.call(this,b),delete b.features)};return{layer:i,listener:u,delegates:{[g]:m}}}}on(g,i,u){if(void 0===u)return super.on(g,i);const m=this._createDelegatedListener(g,i,u);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(m);for(const b in m.delegates)this.on(b,m.delegates[b]);return this}once(g,i,u){if(void 0===u)return super.once(g,i);const m=this._createDelegatedListener(g,i,u);for(const b in m.delegates)this.once(b,m.delegates[b]);return this}off(g,i,u){return void 0===u?super.off(g,i):(this._delegatedListeners&&this._delegatedListeners[g]&&(m=>{const b=this._delegatedListeners[g];for(let w=0;w<b.length;w++){const k=b[w];if(k.layer===i&&k.listener===u){for(const Z in k.delegates)this.off(Z,k.delegates[Z]);return b.splice(w,1),this}}})(),this)}queryRenderedFeatures(g,i){return this.style?(void 0!==i||void 0===g||g instanceof l.pointGeometry||Array.isArray(g)||(i=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(g,i){return this.style.querySourceFeatures(g,i)}queryTerrainElevation(g,i){const u=this.transform.elevation;return u?(i=l.extend({},{exaggerated:!0},i),u.getAtPoint(l.MercatorCoordinate.fromLngLat(g),null,i.exaggerated)):null}setStyle(g,i){return!1!==(i=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(g,i))}_getUIString(g){const i=this._locale[g];if(null==i)throw new Error(`Missing UI string '${g}'`);return i}_updateStyle(g,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),delete this.style),g&&(this.style=new ao(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof g?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ao(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,i){if("string"==typeof g){const u=this._requestManager.normalizeStyleURL(g),m=this._requestManager.transformRequest(u,l.ResourceType.Style);l.getJSON(m,(b,w)=>{b?this.fire(new l.ErrorEvent(b)):w&&this._updateDiff(w,i)})}else"object"==typeof g&&this._updateDiff(g,i)}_updateDiff(g,i){try{this.style.setState(g)&&this._update(!0)}catch(u){l.warnOnce(`Unable to perform style diff: ${u.message||u.error||u}.  Rebuilding the style from scratch.`),this._updateStyle(g,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():l.warnOnce("There is no style added to the map.")}addSource(g,i){return this._lazyInitEmptyStyle(),this.style.addSource(g,i),this._update(!0)}isSourceLoaded(g){const i=this.style&&this.style._getSourceCaches(g);if(0!==i.length)return i.every(u=>u.loaded());this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${g}'`)))}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const i in g){const u=g[i]._tiles;for(const m in u){const b=u[m];if("loaded"!==b.state&&"errored"!==b.state)return!1}}return!0}addSourceType(g,i,u){return this._lazyInitEmptyStyle(),this.style.addSourceType(g,i,u)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,i,{pixelRatio:u=1,sdf:m=!1,stretchX:b,stretchY:w,content:k}={}){if(this._lazyInitEmptyStyle(),i instanceof de||it&&i instanceof it){const{width:Z,height:J,data:se}=l.exported.getImageData(i);this.style.addImage(g,{data:new l.RGBAImage({width:Z,height:J},se),pixelRatio:u,stretchX:b,stretchY:w,content:k,sdf:m,version:0})}else{if(void 0===i.width||void 0===i.height)return this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:Z,height:J,data:se}=i,he=i;this.style.addImage(g,{data:new l.RGBAImage({width:Z,height:J},new Uint8Array(se)),pixelRatio:u,stretchX:b,stretchY:w,content:k,sdf:m,version:0,userImage:he}),he.onAdd&&he.onAdd(this,g)}}}updateImage(g,i){const u=this.style.getImage(g);if(!u)return this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=i instanceof de||it&&i instanceof it?l.exported.getImageData(i):i,{width:b,height:w,data:k}=m;return void 0===b||void 0===w?this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`"))):b!==u.data.width||w!==u.data.height?this.fire(new l.ErrorEvent(new Error("The width and height of the updated image must be that same as the previous version of the image"))):(u.data.replace(k,!(i instanceof de||it&&i instanceof it)),void this.style.updateImage(g,u))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,i){l.getImage(this._requestManager.transformRequest(g,l.ResourceType.Image),(u,m)=>{i(u,m instanceof de?l.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(g,i){return this._lazyInitEmptyStyle(),this.style.addLayer(g,i),this._update(!0)}moveLayer(g,i){return this.style.moveLayer(g,i),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,i,u){return this.style.setLayerZoomRange(g,i,u),this._update(!0)}setFilter(g,i,u={}){return this.style.setFilter(g,i,u),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,i,u,m={}){return this.style.setPaintProperty(g,i,u,m),this._update(!0)}getPaintProperty(g,i){return this.style.getPaintProperty(g,i)}setLayoutProperty(g,i,u,m={}){return this.style.setLayoutProperty(g,i,u,m),this._update(!0)}getLayoutProperty(g,i){return this.style.getLayoutProperty(g,i)}setLight(g,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(l.LngLat.convert(g),this.transform):0}setFeatureState(g,i){return this.style.setFeatureState(g,i),this._update()}removeFeatureState(g,i){return this.style.removeFeatureState(g,i),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_containerDimensions(){let g=0,i=0;return this._container&&(g=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300),[g,i]}_detectMissingCSS(){"rgb(250, 128, 114)"!==l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=te.create("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=te.create("div","mapboxgl-canvas-container",g);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=te.create("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const u=this._containerDimensions();this._resizeCanvas(u[0],u[1]);const m=this._controlContainer=te.create("div","mapboxgl-control-container",g),b=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(w=>{b[w]=te.create("div",`mapboxgl-ctrl-${w}`,m)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,i){const u=l.exported.devicePixelRatio||1;this._canvas.width=u*Math.ceil(g),this._canvas.height=u*Math.ceil(i),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${i}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const i=this._markers.indexOf(g);-1!==i&&this._markers.splice(i,1)}_setupPainter(){const g=l.extend({},P.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);i?(l.storeAuthState(i,!0),this.painter=new Lt(i,this.transform),this.on("data",u=>{"source"===u.dataType&&this.painter.setTileLoadedFlag(!0)}),l.exported$1.testSupport(i)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.isMoving()&&this.loaded()?g():this._domRenderTaskQueue.add(g)}_render(g){let i;const u=this.painter.context.extTimerQuery,m=l.exported.now();this.listens("gpu-timing-frame")&&(i=u.createQueryEXT(),u.beginQueryEXT(u.TIME_ELAPSED_EXT,i));let b=this._updateAverageElevation(m);if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;let w=!1;const k=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const J=this.transform.zoom,se=l.exported.now();this.style.zoomHistory.update(J,se);const he=new l.EvaluationParameters(J,{now:se,fadeDuration:k,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),be=he.crossFadingFactor();1===be&&be===this._crossFadingFactor||(w=!0,this._crossFadingFactor=be),this.style.update(he)}if(this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0),this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),this.style._updateSources(this.transform),this._forceMarkerUpdate()),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,k,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:k,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),speedIndexTiming:this.speedIndexTiming}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&(this.style.hasTransitions()||w)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),this.listens("gpu-timing-frame")){const J=l.exported.now()-m;u.endQueryEXT(u.TIME_ELAPSED_EXT,i),setTimeout(()=>{const se=u.getQueryObjectEXT(i,u.QUERY_RESULT_EXT)/1e6;u.deleteQueryEXT(i),this.fire(new l.Event("gpu-timing-frame",{cpuTime:J,gpuTime:se}))},50)}if(this.listens("gpu-timing-layer")){const J=this.painter.collectGpuTimers();setTimeout(()=>{const se=this.painter.queryGpuTimers(J);this.fire(new l.Event("gpu-timing-layer",{layerTimes:se}))},50)}const Z=this._sourcesDirty||this._styleDirty||this._placementDirty||b;if(Z||this._repaint)this.triggerRepaint();else{const J=!this.isMoving()&&this.loaded();if(J&&(b=this._updateAverageElevation(m,!0)),b)this.triggerRepaint();else if(this._triggerFrame(!1),J&&(this.fire(new l.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const se=this._calculateSpeedIndex();this.fire(new l.Event("speedindexcompleted",{speedIndex:se})),this.speedIndexTiming=!1}}return!this._loaded||this._fullyLoaded||Z||(this._fullyLoaded=!0,this._authenticate()),this}_forceMarkerUpdate(){for(const g of this._markers)g._update()}_updateAverageElevation(g,i=!1){const u=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&u(0);if((i||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const m=this.transform.averageElevation;let b=this.transform.sampleAverageElevation();isNaN(b)?b=0:this._averageElevationLastSampledAt=g;const w=Math.abs(m-b);if(w>1){if(this._isInitialLoad)return this._averageElevation.jumpTo(b),u(b);this._averageElevation.easeTo(b,g,300)}else if(w>1e-4)return this._averageElevation.jumpTo(b),u(b)}return!!this._averageElevation.isEasing(g)&&u(this._averageElevation.getValue(g))}_authenticate(){l.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,g=>{if(g&&(g.message===l.AUTH_ERR_MSG||401===g.status)){const i=this.painter.context.gl;l.storeAuthState(i,!1),this._logoControl instanceof Aa&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new l.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),l.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){this.painter.updateTerrain(this.style,this.isMoving()||this.isRotating()||this.isZooming())}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const u=this.painter.context.gl,m=u.createFramebuffer();function b(w){u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,w,0);const k=new Uint8Array(u.drawingBufferWidth*u.drawingBufferHeight*4);return u.readPixels(0,0,u.drawingBufferWidth,u.drawingBufferHeight,u.RGBA,u.UNSIGNED_BYTE,k),k}return u.bindFramebuffer(u.FRAMEBUFFER,m),this._canvasPixelComparison(b(g),i.canvasCopies.map(b),i.timeStamps)}_canvasPixelComparison(g,i,u){let m=u[1]-u[0];const b=g.length/4;for(let w=0;w<i.length;w++){const k=i[w];let Z=0;for(let J=0;J<k.length;J+=4)k[J]===g[J]&&k[J+1]===g[J+1]&&k[J+2]===g[J+2]&&k[J+3]===g[J+3]&&(Z+=1);m+=(u[w+2]-u[w+1])*(1-Z/b)}return m}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),void 0!==l.window&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),_n(this._canvasContainer),_n(this._controlContainer),_n(this._missingCSSCanary),this._container.classList.remove("mapboxgl-map"),l.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=l.exported.frame(i=>{const u=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,u&&this._render(i)}))}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}_setCacheLimits(g,i){l.setCacheLimits(g,i)}get version(){return l.version}},NavigationControl:class{constructor(g){this.options=l.extend({},di,g),this._container=te.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>this._map.zoomIn({},{originalEvent:i})),te.create("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden",!0),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>this._map.zoomOut({},{originalEvent:i})),te.create("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden",!0)),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:i}):this._map.resetNorth({},{originalEvent:i})}),this._compassIcon=te.create("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden",!0))}_updateZoomButtons(){const g=this._map.getZoom(),i=g===this._map.getMaxZoom(),u=g===this._map.getMinZoom();this._zoomInButton.disabled=i,this._zoomOutButton.disabled=u,this._zoomInButton.setAttribute("aria-disabled",i.toString()),this._zoomOutButton.setAttribute("aria-disabled",u.toString())}_rotateCompassArrow(){const g=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._map._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=g)})}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new sr(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){te.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(g,i){const u=te.create("button",g,this._container);return u.type="button",u.addEventListener("click",i),u}_setButtonTitle(g,i){const u=this._map._getUIString(`NavigationControl.${i}`);g.title=u,g.setAttribute("aria-label",u)}},GeolocateControl:class extends l.Evented{constructor(g){super(),this.options=l.extend({},Mi,g),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation"],this),this._onDeviceOrientationListener=this._onDeviceOrientation.bind(this),this._updateMarkerRotationThrottled=Jr(this._updateMarkerRotation,20)}onAdd(g){var i;return this._map=g,this._container=te.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),i=this._setupUI,void 0!==pr?i(pr):void 0!==l.window.navigator.permissions?l.window.navigator.permissions.query({name:"geolocation"}).then(u=>{pr="denied"!==u.state,i(pr)}):(pr=!!l.window.navigator.geolocation,i(pr)),this._container}onRemove(){void 0!==this._geolocationWatchID&&(l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),te.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,cr=0,es=!1}_isOutOfMapMaxBounds(g){const i=this._map.getMaxBounds(),u=g.coords;return i&&(u.longitude<i.getWest()||u.longitude>i.getEast()||u.latitude<i.getSouth()||u.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(g),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",g)),this._finish()}}_updateCamera(g){const i=new l.LngLat(g.coords.longitude,g.coords.latitude),u=g.coords.accuracy,m=this._map.getBearing(),b=l.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(u),b,{geolocateSource:!0})}_updateMarker(g){if(g){const i=new l.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map._container.getBoundingClientRect().height/2,i=this._map.unproject([0,g]),u=this._map.unproject([100,g]),m=i.distanceTo(u)/100,b=Math.ceil(2*this._accuracy/m);this._circleElement.style.width=`${b}px`,this._circleElement.style.height=`${b}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(1===g.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===g.code&&es)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=te.create("button","mapboxgl-ctrl-geolocate",this._container),te.create("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden",!0),this._geolocateButton.type="button",!1===g){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=i,this._geolocateButton.setAttribute("aria-label",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=te.create("div","mapboxgl-user-location"),this._dotElement.appendChild(te.create("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(te.create("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new F({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=te.create("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new F({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:!0===g.absolute&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":cr--,es=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),cr++,cr>1?(g={maximumAge:6e5,timeout:0},es=!0):(g=this.options.positionOptions,es=!1),this._geolocationWatchID=l.window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else l.window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{l.window.addEventListener("ondeviceorientationabsolute"in l.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientationListener)};void 0!==l.window.DeviceMotionEvent&&"function"==typeof l.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&g()}).catch(console.error):g()}_clearWatch(){l.window.navigator.geolocation.clearWatch(this._geolocationWatchID),l.window.removeEventListener("deviceorientation",this._onDeviceOrientationListener),l.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientationListener),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:rl,ScaleControl:class{constructor(g){this.options=l.extend({},Ma,g),l.bindAll(["_onMove","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_onMove(){fr(this._map,this._container,this.options)}onAdd(g){return this._map=g,this._container=te.create("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){te.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}setUnit(g){this.options.unit=g,fr(this._map,this._container,this.options)}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof l.window.HTMLElement?this._container=g.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in l.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=te.create("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){te.remove(this._controlContainer),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!l.window.document.fullscreenEnabled&&!l.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=te.create("button","mapboxgl-ctrl-fullscreen",this._controlContainer);te.create("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden",!0),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.title=g}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(l.window.document.fullscreenElement||l.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(g){super(),this.options=l.extend(Object.create(Wl),g),l.bindAll(["_update","_onClose","remove","_onMouseMove","_onMouseUp","_onDrag"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&this._map.on("preclick",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")):this._map.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){return this._content&&te.remove(this._content),this._container&&(te.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){return this._lngLat=l.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._map._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._map._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(l.window.document.createTextNode(g))}setHTML(g){const i=l.window.document.createDocumentFragment(),u=l.window.document.createElement("body");let m;for(u.innerHTML=g;m=u.firstChild,m;)i.appendChild(m);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=te.create("div","mapboxgl-popup-content",this._container);return this._content.appendChild(g),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._container&&this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._container&&this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let i;return this._classList.delete(g)?i=!1:(this._classList.add(g),i=!0),this._container&&this._updateClassList(),i}_createCloseButton(){this.options.closeButton&&(this._closeButton=te.create("button","mapboxgl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_onMouseUp(g){this._update(g.point)}_onMouseMove(g){this._update(g.point)}_onDrag(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const i=this._pos,u=this._container.offsetWidth,m=this._container.offsetHeight;let b;return b=i.y+g.bottom.y<m?["top"]:i.y>this._map.transform.height-m?["bottom"]:[],i.x<u/2?b.push("left"):i.x>this._map.transform.width-u/2&&b.push("right"),0===b.length?"bottom":b.join("-")}_updateClassList(){const g=[...this._classList];g.push("mapboxgl-popup"),this._anchor&&g.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&g.push("mapboxgl-popup-track-pointer"),this._container.className=g.join(" ")}_update(g){if(this._map&&(this._lngLat||this._trackPointer)&&this._content){if(this._container||(this._container=te.create("div","mapboxgl-popup",this._map.getContainer()),this._tip=te.create("div","mapboxgl-popup-tip",this._container),this._container.appendChild(this._content)),this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=wc(this._lngLat,this._pos,this._map.transform)),!this._trackPointer||g){const i=this._pos=this._trackPointer&&g?g:this._map.project(this._lngLat),u=function(w){if(w||(w=new l.pointGeometry(0,0)),"number"==typeof w){const k=Math.round(Math.sqrt(.5*Math.pow(w,2)));return{center:new l.pointGeometry(0,0),top:new l.pointGeometry(0,w),"top-left":new l.pointGeometry(k,k),"top-right":new l.pointGeometry(-k,k),bottom:new l.pointGeometry(0,-w),"bottom-left":new l.pointGeometry(k,-k),"bottom-right":new l.pointGeometry(-k,-k),left:new l.pointGeometry(w,0),right:new l.pointGeometry(-w,0)}}if(w instanceof l.pointGeometry||Array.isArray(w)){const k=l.pointGeometry.convert(w);return{center:k,top:k,"top-left":k,"top-right":k,bottom:k,"bottom-left":k,"bottom-right":k,left:k,right:k}}return{center:l.pointGeometry.convert(w.center||[0,0]),top:l.pointGeometry.convert(w.top||[0,0]),"top-left":l.pointGeometry.convert(w["top-left"]||[0,0]),"top-right":l.pointGeometry.convert(w["top-right"]||[0,0]),bottom:l.pointGeometry.convert(w.bottom||[0,0]),"bottom-left":l.pointGeometry.convert(w["bottom-left"]||[0,0]),"bottom-right":l.pointGeometry.convert(w["bottom-right"]||[0,0]),left:l.pointGeometry.convert(w.left||[0,0]),right:l.pointGeometry.convert(w.right||[0,0])}}(this.options.offset),m=this._anchor=this._getAnchor(u),b=i.add(u[m]).round();this._map._requestDomTask(()=>{this._container&&m&&te.setTransform(this._container,`${q[m]} translate(${b.x}px,${b.y}px)`)})}this._updateClassList()}}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(bl);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._content&&(this._content.style.opacity=g),this._tip&&(this._tip.style.opacity=g)}},Marker:F,Style:ao,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.pointGeometry,MercatorCoordinate:l.MercatorCoordinate,FreeCameraOptions:oo,Evented:l.Evented,config:l.config,prewarm:function(){Zt().acquire(lt)},clearPrewarmedResources:function(){const g=Ht;g&&(g.isPreloaded()&&1===g.numActive()?(g.release(lt),Ht=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(g){l.config.ACCESS_TOKEN=g},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(g){l.config.API_URL=g},get workerCount(){return Dt.workerCount},set workerCount(g){Dt.workerCount=g},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){l.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){l.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:l.exported.setNow,restoreNow:l.exported.restoreNow};return Cc}),x}()},4099:(yn,je,N)=>{"use strict";N.d(je,{X:()=>Y});var x=N(3405),d=N(2108);class Y extends x.xQ{constructor(P){super(),this._value=P}get value(){return this.getValue()}_subscribe(P){const O=super._subscribe(P);return O&&!O.closed&&P.next(this._value),O}getValue(){if(this.hasError)throw this.thrownError;if(this.closed)throw new d.N;return this._value}next(P){super.next(this._value=P)}}},5548:(yn,je,N)=>{"use strict";N.d(je,{y:()=>G});var x=N(4168),Y=N(2926),l=N(6617),O=N(1359),f=N(7255);var K=N(5426);let G=(()=>{class ce{constructor(ve){this._isScalar=!1,ve&&(this._subscribe=ve)}lift(ve){const we=new ce;return we.source=this,we.operator=ve,we}subscribe(ve,we,ze){const{operator:Ne}=this,Ae=function(ce,me,ve){if(ce){if(ce instanceof x.L)return ce;if(ce[Y.b])return ce[Y.b]()}return ce||me||ve?new x.L(ce,me,ve):new x.L(l.c)}(ve,we,ze);if(Ae.add(Ne?Ne.call(Ae,this.source):this.source||K.v.useDeprecatedSynchronousErrorHandling&&!Ae.syncErrorThrowable?this._subscribe(Ae):this._trySubscribe(Ae)),K.v.useDeprecatedSynchronousErrorHandling&&Ae.syncErrorThrowable&&(Ae.syncErrorThrowable=!1,Ae.syncErrorThrown))throw Ae.syncErrorValue;return Ae}_trySubscribe(ve){try{return this._subscribe(ve)}catch(we){K.v.useDeprecatedSynchronousErrorHandling&&(ve.syncErrorThrown=!0,ve.syncErrorValue=we),function(ce){for(;ce;){const{closed:me,destination:ve,isStopped:we}=ce;if(me||we)return!1;ce=ve&&ve instanceof x.L?ve:null}return!0}(ve)?ve.error(we):console.warn(we)}}forEach(ve,we){return new(we=ne(we))((ze,Ne)=>{let Ae;Ae=this.subscribe(Te=>{try{ve(Te)}catch(He){Ne(He),Ae&&Ae.unsubscribe()}},Ne,ze)})}_subscribe(ve){const{source:we}=this;return we&&we.subscribe(ve)}[O.L](){return this}pipe(...ve){return 0===ve.length?this:function(ce){return 0===ce.length?f.y:1===ce.length?ce[0]:function(ve){return ce.reduce((we,ze)=>ze(we),ve)}}(ve)(this)}toPromise(ve){return new(ve=ne(ve))((we,ze)=>{let Ne;this.subscribe(Ae=>Ne=Ae,Ae=>ze(Ae),()=>we(Ne))})}}return ce.create=me=>new ce(me),ce})();function ne(ce){if(ce||(ce=K.v.Promise||Promise),!ce)throw new Error("no Promise impl found");return ce}},6617:(yn,je,N)=>{"use strict";N.d(je,{c:()=>Y});var x=N(5426),d=N(9887);const Y={closed:!0,next(l){},error(l){if(x.v.useDeprecatedSynchronousErrorHandling)throw l;(0,d.z)(l)},complete(){}}},3405:(yn,je,N)=>{"use strict";N.d(je,{Yc:()=>f,xQ:()=>H});var x=N(5548),d=N(4168),Y=N(1346),l=N(2108),P=N(5973),O=N(2926);class f extends d.L{constructor(G){super(G),this.destination=G}}let H=(()=>{class K extends x.y{constructor(){super(),this.observers=[],this.closed=!1,this.isStopped=!1,this.hasError=!1,this.thrownError=null}[O.b](){return new f(this)}lift(ne){const ce=new te(this,this);return ce.operator=ne,ce}next(ne){if(this.closed)throw new l.N;if(!this.isStopped){const{observers:ce}=this,me=ce.length,ve=ce.slice();for(let we=0;we<me;we++)ve[we].next(ne)}}error(ne){if(this.closed)throw new l.N;this.hasError=!0,this.thrownError=ne,this.isStopped=!0;const{observers:ce}=this,me=ce.length,ve=ce.slice();for(let we=0;we<me;we++)ve[we].error(ne);this.observers.length=0}complete(){if(this.closed)throw new l.N;this.isStopped=!0;const{observers:ne}=this,ce=ne.length,me=ne.slice();for(let ve=0;ve<ce;ve++)me[ve].complete();this.observers.length=0}unsubscribe(){this.isStopped=!0,this.closed=!0,this.observers=null}_trySubscribe(ne){if(this.closed)throw new l.N;return super._trySubscribe(ne)}_subscribe(ne){if(this.closed)throw new l.N;return this.hasError?(ne.error(this.thrownError),Y.w.EMPTY):this.isStopped?(ne.complete(),Y.w.EMPTY):(this.observers.push(ne),new P.W(this,ne))}asObservable(){const ne=new x.y;return ne.source=this,ne}}return K.create=(G,ne)=>new te(G,ne),K})();class te extends H{constructor(G,ne){super(),this.destination=G,this.source=ne}next(G){const{destination:ne}=this;ne&&ne.next&&ne.next(G)}error(G){const{destination:ne}=this;ne&&ne.error&&this.destination.error(G)}complete(){const{destination:G}=this;G&&G.complete&&this.destination.complete()}_subscribe(G){const{source:ne}=this;return ne?this.source.subscribe(G):Y.w.EMPTY}}},5973:(yn,je,N)=>{"use strict";N.d(je,{W:()=>d});var x=N(1346);class d extends x.w{constructor(l,P){super(),this.subject=l,this.subscriber=P,this.closed=!1}unsubscribe(){if(this.closed)return;this.closed=!0;const l=this.subject,P=l.observers;if(this.subject=null,!P||0===P.length||l.isStopped||l.closed)return;const O=P.indexOf(this.subscriber);-1!==O&&P.splice(O,1)}}},4168:(yn,je,N)=>{"use strict";N.d(je,{L:()=>f});var x=N(6783),d=N(6617),Y=N(1346),l=N(2926),P=N(5426),O=N(9887);class f extends Y.w{constructor(K,G,ne){switch(super(),this.syncErrorValue=null,this.syncErrorThrown=!1,this.syncErrorThrowable=!1,this.isStopped=!1,arguments.length){case 0:this.destination=d.c;break;case 1:if(!K){this.destination=d.c;break}if("object"==typeof K){K instanceof f?(this.syncErrorThrowable=K.syncErrorThrowable,this.destination=K,K.add(this)):(this.syncErrorThrowable=!0,this.destination=new H(this,K));break}default:this.syncErrorThrowable=!0,this.destination=new H(this,K,G,ne)}}[l.b](){return this}static create(K,G,ne){const ce=new f(K,G,ne);return ce.syncErrorThrowable=!1,ce}next(K){this.isStopped||this._next(K)}error(K){this.isStopped||(this.isStopped=!0,this._error(K))}complete(){this.isStopped||(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe())}_next(K){this.destination.next(K)}_error(K){this.destination.error(K),this.unsubscribe()}_complete(){this.destination.complete(),this.unsubscribe()}_unsubscribeAndRecycle(){const{_parentOrParents:K}=this;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=K,this}}class H extends f{constructor(K,G,ne,ce){super(),this._parentSubscriber=K;let me,ve=this;(0,x.m)(G)?me=G:G&&(me=G.next,ne=G.error,ce=G.complete,G!==d.c&&(ve=Object.create(G),(0,x.m)(ve.unsubscribe)&&this.add(ve.unsubscribe.bind(ve)),ve.unsubscribe=this.unsubscribe.bind(this))),this._context=ve,this._next=me,this._error=ne,this._complete=ce}next(K){if(!this.isStopped&&this._next){const{_parentSubscriber:G}=this;P.v.useDeprecatedSynchronousErrorHandling&&G.syncErrorThrowable?this.__tryOrSetError(G,this._next,K)&&this.unsubscribe():this.__tryOrUnsub(this._next,K)}}error(K){if(!this.isStopped){const{_parentSubscriber:G}=this,{useDeprecatedSynchronousErrorHandling:ne}=P.v;if(this._error)ne&&G.syncErrorThrowable?(this.__tryOrSetError(G,this._error,K),this.unsubscribe()):(this.__tryOrUnsub(this._error,K),this.unsubscribe());else if(G.syncErrorThrowable)ne?(G.syncErrorValue=K,G.syncErrorThrown=!0):(0,O.z)(K),this.unsubscribe();else{if(this.unsubscribe(),ne)throw K;(0,O.z)(K)}}}complete(){if(!this.isStopped){const{_parentSubscriber:K}=this;if(this._complete){const G=()=>this._complete.call(this._context);P.v.useDeprecatedSynchronousErrorHandling&&K.syncErrorThrowable?(this.__tryOrSetError(K,G),this.unsubscribe()):(this.__tryOrUnsub(G),this.unsubscribe())}else this.unsubscribe()}}__tryOrUnsub(K,G){try{K.call(this._context,G)}catch(ne){if(this.unsubscribe(),P.v.useDeprecatedSynchronousErrorHandling)throw ne;(0,O.z)(ne)}}__tryOrSetError(K,G,ne){if(!P.v.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{G.call(this._context,ne)}catch(ce){return P.v.useDeprecatedSynchronousErrorHandling?(K.syncErrorValue=ce,K.syncErrorThrown=!0,!0):((0,O.z)(ce),!0)}return!1}_unsubscribe(){const{_parentSubscriber:K}=this;this._context=null,this._parentSubscriber=null,K.unsubscribe()}}},1346:(yn,je,N)=>{"use strict";N.d(je,{w:()=>O});var x=N(5894),d=N(7879),Y=N(6783);const P=(()=>{function H(te){return Error.call(this),this.message=te?`${te.length} errors occurred during unsubscription:\n${te.map((K,G)=>`${G+1}) ${K.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=te,this}return H.prototype=Object.create(Error.prototype),H})();class O{constructor(te){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,te&&(this._ctorUnsubscribe=!0,this._unsubscribe=te)}unsubscribe(){let te;if(this.closed)return;let{_parentOrParents:K,_ctorUnsubscribe:G,_unsubscribe:ne,_subscriptions:ce}=this;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,K instanceof O)K.remove(this);else if(null!==K)for(let me=0;me<K.length;++me)K[me].remove(this);if((0,Y.m)(ne)){G&&(this._unsubscribe=void 0);try{ne.call(this)}catch(me){te=me instanceof P?f(me.errors):[me]}}if((0,x.k)(ce)){let me=-1,ve=ce.length;for(;++me<ve;){const we=ce[me];if((0,d.K)(we))try{we.unsubscribe()}catch(ze){te=te||[],ze instanceof P?te=te.concat(f(ze.errors)):te.push(ze)}}}if(te)throw new P(te)}add(te){let K=te;if(!te)return O.EMPTY;switch(typeof te){case"function":K=new O(te);case"object":if(K===this||K.closed||"function"!=typeof K.unsubscribe)return K;if(this.closed)return K.unsubscribe(),K;if(!(K instanceof O)){const ce=K;K=new O,K._subscriptions=[ce]}break;default:throw new Error("unrecognized teardown "+te+" added to Subscription.")}let{_parentOrParents:G}=K;if(null===G)K._parentOrParents=this;else if(G instanceof O){if(G===this)return K;K._parentOrParents=[G,this]}else{if(-1!==G.indexOf(this))return K;G.push(this)}const ne=this._subscriptions;return null===ne?this._subscriptions=[K]:ne.push(K),K}remove(te){const K=this._subscriptions;if(K){const G=K.indexOf(te);-1!==G&&K.splice(G,1)}}}var H;function f(H){return H.reduce((te,K)=>te.concat(K instanceof P?K.errors:K),[])}O.EMPTY=((H=new O).closed=!0,H)},5426:(yn,je,N)=>{"use strict";N.d(je,{v:()=>d});let x=!1;const d={Promise:void 0,set useDeprecatedSynchronousErrorHandling(Y){if(Y){const l=new Error;console.warn("DEPRECATED! RxJS was set to use deprecated synchronous error handling behavior by code at: \n"+l.stack)}else x&&console.log("RxJS: Back to a better error behavior. Thank you. <3");x=Y},get useDeprecatedSynchronousErrorHandling(){return x}}},8345:(yn,je,N)=>{"use strict";N.d(je,{IY:()=>l,Ds:()=>O,ft:()=>H});var x=N(4168),d=N(5548),Y=N(4651);class l extends x.L{constructor(K){super(),this.parent=K}_next(K){this.parent.notifyNext(K)}_error(K){this.parent.notifyError(K),this.unsubscribe()}_complete(){this.parent.notifyComplete(),this.unsubscribe()}}class O extends x.L{notifyNext(K){this.destination.next(K)}notifyError(K){this.destination.error(K)}notifyComplete(){this.destination.complete()}}function H(te,K){if(!K.closed)return te instanceof d.y?te.subscribe(K):(0,Y.s)(te)(K)}},5783:(yn,je,N)=>{"use strict";N.d(je,{c:()=>P,N:()=>O});var x=N(3405),d=N(5548),Y=N(1346),l=N(5234);class P extends d.y{constructor(G,ne){super(),this.source=G,this.subjectFactory=ne,this._refCount=0,this._isComplete=!1}_subscribe(G){return this.getSubject().subscribe(G)}getSubject(){const G=this._subject;return(!G||G.isStopped)&&(this._subject=this.subjectFactory()),this._subject}connect(){let G=this._connection;return G||(this._isComplete=!1,G=this._connection=new Y.w,G.add(this.source.subscribe(new f(this.getSubject(),this))),G.closed&&(this._connection=null,G=Y.w.EMPTY)),G}refCount(){return(0,l.x)()(this)}}const O=(()=>{const K=P.prototype;return{operator:{value:null},_refCount:{value:0,writable:!0},_subject:{value:null,writable:!0},_connection:{value:null,writable:!0},_subscribe:{value:K._subscribe},_isComplete:{value:K._isComplete,writable:!0},getSubject:{value:K.getSubject},connect:{value:K.connect},refCount:{value:K.refCount}}})();class f extends x.Yc{constructor(G,ne){super(G),this.connectable=ne}_error(G){this._unsubscribe(),super._error(G)}_complete(){this.connectable._isComplete=!0,this._unsubscribe(),super._complete()}_unsubscribe(){const G=this.connectable;if(G){this.connectable=null;const ne=G._connection;G._refCount=0,G._subject=null,G._connection=null,ne&&ne.unsubscribe()}}}},3596:(yn,je,N)=>{"use strict";N.d(je,{z:()=>l});var x=N(2411),d=N(2225);function l(...P){return(0,d.J)(1)((0,x.of)(...P))}},5476:(yn,je,N)=>{"use strict";N.d(je,{P:()=>l});var x=N(5548),d=N(1915),Y=N(172);function l(P){return new x.y(O=>{let f;try{f=P()}catch(te){return void O.error(te)}return(f?(0,d.D)(f):(0,Y.c)()).subscribe(O)})}},172:(yn,je,N)=>{"use strict";N.d(je,{E:()=>d,c:()=>Y});var x=N(5548);const d=new x.y(P=>P.complete());function Y(P){return P?function(P){return new x.y(O=>P.schedule(()=>O.complete()))}(P):d}},6813:(yn,je,N)=>{"use strict";N.d(je,{D:()=>O});var x=N(5548),d=N(5894),Y=N(8053),l=N(7879),P=N(1915);function O(...H){if(1===H.length){const te=H[0];if((0,d.k)(te))return f(te,null);if((0,l.K)(te)&&Object.getPrototypeOf(te)===Object.prototype){const K=Object.keys(te);return f(K.map(G=>te[G]),K)}}if("function"==typeof H[H.length-1]){const te=H.pop();return f(H=1===H.length&&(0,d.k)(H[0])?H[0]:H,null).pipe((0,Y.U)(K=>te(...K)))}return f(H,null)}function f(H,te){return new x.y(K=>{const G=H.length;if(0===G)return void K.complete();const ne=new Array(G);let ce=0,me=0;for(let ve=0;ve<G;ve++){const we=(0,P.D)(H[ve]);let ze=!1;K.add(we.subscribe({next:Ne=>{ze||(ze=!0,me++),ne[ve]=Ne},error:Ne=>K.error(Ne),complete:()=>{ce++,(ce===G||!ze)&&(me===G&&K.next(te?te.reduce((Ne,Ae,Te)=>(Ne[Ae]=ne[Te],Ne),{}):ne),K.complete())}}))}})}},1915:(yn,je,N)=>{"use strict";N.d(je,{D:()=>ve});var x=N(5548),d=N(4651),Y=N(1346),l=N(1359),f=N(3428),H=N(4352),G=N(847),ne=N(1265);function ve(we,ze){return ze?function(we,ze){if(null!=we){if(function(we){return we&&"function"==typeof we[l.L]}(we))return function(we,ze){return new x.y(Ne=>{const Ae=new Y.w;return Ae.add(ze.schedule(()=>{const Te=we[l.L]();Ae.add(Te.subscribe({next(He){Ae.add(ze.schedule(()=>Ne.next(He)))},error(He){Ae.add(ze.schedule(()=>Ne.error(He)))},complete(){Ae.add(ze.schedule(()=>Ne.complete()))}}))})),Ae})}(we,ze);if((0,G.t)(we))return function(we,ze){return new x.y(Ne=>{const Ae=new Y.w;return Ae.add(ze.schedule(()=>we.then(Te=>{Ae.add(ze.schedule(()=>{Ne.next(Te),Ae.add(ze.schedule(()=>Ne.complete()))}))},Te=>{Ae.add(ze.schedule(()=>Ne.error(Te)))}))),Ae})}(we,ze);if((0,ne.z)(we))return(0,f.r)(we,ze);if(function(we){return we&&"function"==typeof we[H.hZ]}(we)||"string"==typeof we)return function(we,ze){if(!we)throw new Error("Iterable cannot be null");return new x.y(Ne=>{const Ae=new Y.w;let Te;return Ae.add(()=>{Te&&"function"==typeof Te.return&&Te.return()}),Ae.add(ze.schedule(()=>{Te=we[H.hZ](),Ae.add(ze.schedule(function(){if(Ne.closed)return;let He,Ge;try{const Fe=Te.next();He=Fe.value,Ge=Fe.done}catch(Fe){return void Ne.error(Fe)}Ge?Ne.complete():(Ne.next(He),this.schedule())}))})),Ae})}(we,ze)}throw new TypeError((null!==we&&typeof we||we)+" is not observable")}(we,ze):we instanceof x.y?we:new x.y((0,d.s)(we))}},5433:(yn,je,N)=>{"use strict";N.d(je,{n:()=>l});var x=N(5548),d=N(8769),Y=N(3428);function l(P,O){return O?(0,Y.r)(P,O):new x.y((0,d.V)(P))}},6087:(yn,je,N)=>{"use strict";N.d(je,{R:()=>O});var x=N(5548),d=N(5894),Y=N(6783),l=N(8053);function O(G,ne,ce,me){return(0,Y.m)(ce)&&(me=ce,ce=void 0),me?O(G,ne,ce).pipe((0,l.U)(ve=>(0,d.k)(ve)?me(...ve):me(ve))):new x.y(ve=>{f(G,ne,function(ze){ve.next(arguments.length>1?Array.prototype.slice.call(arguments):ze)},ve,ce)})}function f(G,ne,ce,me,ve){let we;if(function(G){return G&&"function"==typeof G.addEventListener&&"function"==typeof G.removeEventListener}(G)){const ze=G;G.addEventListener(ne,ce,ve),we=()=>ze.removeEventListener(ne,ce,ve)}else if(function(G){return G&&"function"==typeof G.on&&"function"==typeof G.off}(G)){const ze=G;G.on(ne,ce),we=()=>ze.off(ne,ce)}else if(function(G){return G&&"function"==typeof G.addListener&&"function"==typeof G.removeListener}(G)){const ze=G;G.addListener(ne,ce),we=()=>ze.removeListener(ne,ce)}else{if(!G||!G.length)throw new TypeError("Invalid event target");for(let ze=0,Ne=G.length;ze<Ne;ze++)f(G[ze],ne,ce,me,ve)}me.add(we)}},2411:(yn,je,N)=>{"use strict";N.d(je,{of:()=>l});var x=N(8151),d=N(5433),Y=N(3428);function l(...P){let O=P[P.length-1];return(0,x.K)(O)?(P.pop(),(0,Y.r)(P,O)):(0,d.n)(P)}},6700:(yn,je,N)=>{"use strict";N.d(je,{b:()=>d});var x=N(4421);function d(Y,l){return(0,x.zg)(Y,l,1)}},8735:(yn,je,N)=>{"use strict";N.d(je,{h:()=>d});var x=N(4168);function d(P,O){return function(H){return H.lift(new Y(P,O))}}class Y{constructor(O,f){this.predicate=O,this.thisArg=f}call(O,f){return f.subscribe(new l(O,this.predicate,this.thisArg))}}class l extends x.L{constructor(O,f,H){super(O),this.predicate=f,this.thisArg=H,this.count=0}_next(O){let f;try{f=this.predicate.call(this.thisArg,O,this.count++)}catch(H){return void this.destination.error(H)}f&&this.destination.next(O)}}},8053:(yn,je,N)=>{"use strict";N.d(je,{U:()=>d});var x=N(4168);function d(P,O){return function(H){if("function"!=typeof P)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return H.lift(new Y(P,O))}}class Y{constructor(O,f){this.project=O,this.thisArg=f}call(O,f){return f.subscribe(new l(O,this.project,this.thisArg))}}class l extends x.L{constructor(O,f,H){super(O),this.project=f,this.count=0,this.thisArg=H||this}_next(O){let f;try{f=this.project.call(this.thisArg,O,this.count++)}catch(H){return void this.destination.error(H)}this.destination.next(f)}}},2225:(yn,je,N)=>{"use strict";N.d(je,{J:()=>Y});var x=N(4421),d=N(7255);function Y(l=Number.POSITIVE_INFINITY){return(0,x.zg)(d.y,l)}},4421:(yn,je,N)=>{"use strict";N.d(je,{zg:()=>l});var x=N(8053),d=N(1915),Y=N(8345);function l(H,te,K=Number.POSITIVE_INFINITY){return"function"==typeof te?G=>G.pipe(l((ne,ce)=>(0,d.D)(H(ne,ce)).pipe((0,x.U)((me,ve)=>te(ne,me,ce,ve))),K)):("number"==typeof te&&(K=te),G=>G.lift(new P(H,K)))}class P{constructor(te,K=Number.POSITIVE_INFINITY){this.project=te,this.concurrent=K}call(te,K){return K.subscribe(new O(te,this.project,this.concurrent))}}class O extends Y.Ds{constructor(te,K,G=Number.POSITIVE_INFINITY){super(te),this.project=K,this.concurrent=G,this.hasCompleted=!1,this.buffer=[],this.active=0,this.index=0}_next(te){this.active<this.concurrent?this._tryNext(te):this.buffer.push(te)}_tryNext(te){let K;const G=this.index++;try{K=this.project(te,G)}catch(ne){return void this.destination.error(ne)}this.active++,this._innerSub(K)}_innerSub(te){const K=new Y.IY(this),G=this.destination;G.add(K);const ne=(0,Y.ft)(te,K);ne!==K&&G.add(ne)}_complete(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()}notifyNext(te){this.destination.next(te)}notifyComplete(){const te=this.buffer;this.active--,te.length>0?this._next(te.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()}}},5234:(yn,je,N)=>{"use strict";N.d(je,{x:()=>d});var x=N(4168);function d(){return function(O){return O.lift(new Y(O))}}class Y{constructor(O){this.connectable=O}call(O,f){const{connectable:H}=this;H._refCount++;const te=new l(O,H),K=f.subscribe(te);return te.closed||(te.connection=H.connect()),K}}class l extends x.L{constructor(O,f){super(O),this.connectable=f}_unsubscribe(){const{connectable:O}=this;if(!O)return void(this.connection=null);this.connectable=null;const f=O._refCount;if(f<=0)return void(this.connection=null);if(O._refCount=f-1,f>1)return void(this.connection=null);const{connection:H}=this,te=O._connection;this.connection=null,te&&(!H||te===H)&&te.unsubscribe()}}},9204:(yn,je,N)=>{"use strict";N.d(je,{w:()=>l});var x=N(8053),d=N(1915),Y=N(8345);function l(f,H){return"function"==typeof H?te=>te.pipe(l((K,G)=>(0,d.D)(f(K,G)).pipe((0,x.U)((ne,ce)=>H(K,ne,G,ce))))):te=>te.lift(new P(f))}class P{constructor(H){this.project=H}call(H,te){return te.subscribe(new O(H,this.project))}}class O extends Y.Ds{constructor(H,te){super(H),this.project=te,this.index=0}_next(H){let te;const K=this.index++;try{te=this.project(H,K)}catch(G){return void this.destination.error(G)}this._innerSub(te)}_innerSub(H){const te=this.innerSubscription;te&&te.unsubscribe();const K=new Y.IY(this),G=this.destination;G.add(K),this.innerSubscription=(0,Y.ft)(H,K),this.innerSubscription!==K&&G.add(this.innerSubscription)}_complete(){const{innerSubscription:H}=this;(!H||H.closed)&&super._complete(),this.unsubscribe()}_unsubscribe(){this.innerSubscription=void 0}notifyComplete(){this.innerSubscription=void 0,this.isStopped&&super._complete()}notifyNext(H){this.destination.next(H)}}},6636:(yn,je,N)=>{"use strict";N.d(je,{q:()=>l});var x=N(4168),d=N(523),Y=N(172);function l(f){return H=>0===f?(0,Y.c)():H.lift(new P(f))}class P{constructor(H){if(this.total=H,this.total<0)throw new d.W}call(H,te){return te.subscribe(new O(H,this.total))}}class O extends x.L{constructor(H,te){super(H),this.total=te,this.count=0}_next(H){const te=this.total,K=++this.count;K<=te&&(this.destination.next(H),K===te&&(this.destination.complete(),this.unsubscribe()))}}},3428:(yn,je,N)=>{"use strict";N.d(je,{r:()=>Y});var x=N(5548),d=N(1346);function Y(l,P){return new x.y(O=>{const f=new d.w;let H=0;return f.add(P.schedule(function(){H!==l.length?(O.next(l[H++]),O.closed||f.add(this.schedule())):O.complete()})),f})}},6339:(yn,je,N)=>{"use strict";N.d(je,{o:()=>Y});var x=N(1346);class d extends x.w{constructor(P,O){super()}schedule(P,O=0){return this}}class Y extends d{constructor(P,O){super(P,O),this.scheduler=P,this.work=O,this.pending=!1}schedule(P,O=0){if(this.closed)return this;this.state=P;const f=this.id,H=this.scheduler;return null!=f&&(this.id=this.recycleAsyncId(H,f,O)),this.pending=!0,this.delay=O,this.id=this.id||this.requestAsyncId(H,this.id,O),this}requestAsyncId(P,O,f=0){return setInterval(P.flush.bind(P,this),f)}recycleAsyncId(P,O,f=0){if(null!==f&&this.delay===f&&!1===this.pending)return O;clearInterval(O)}execute(P,O){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const f=this._execute(P,O);if(f)return f;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(P,O){let H,f=!1;try{this.work(P)}catch(te){f=!0,H=!!te&&te||new Error(te)}if(f)return this.unsubscribe(),H}_unsubscribe(){const P=this.id,O=this.scheduler,f=O.actions,H=f.indexOf(this);this.work=null,this.state=null,this.pending=!1,this.scheduler=null,-1!==H&&f.splice(H,1),null!=P&&(this.id=this.recycleAsyncId(O,P,null)),this.delay=null}}},5192:(yn,je,N)=>{"use strict";N.d(je,{v:()=>d});let x=(()=>{class Y{constructor(P,O=Y.now){this.SchedulerAction=P,this.now=O}schedule(P,O=0,f){return new this.SchedulerAction(this,P).schedule(f,O)}}return Y.now=()=>Date.now(),Y})();class d extends x{constructor(l,P=x.now){super(l,()=>d.delegate&&d.delegate!==this?d.delegate.now():P()),this.actions=[],this.active=!1,this.scheduled=void 0}schedule(l,P=0,O){return d.delegate&&d.delegate!==this?d.delegate.schedule(l,P,O):super.schedule(l,P,O)}flush(l){const{actions:P}=this;if(this.active)return void P.push(l);let O;this.active=!0;do{if(O=l.execute(l.state,l.delay))break}while(l=P.shift());if(this.active=!1,O){for(;l=P.shift();)l.unsubscribe();throw O}}}},4352:(yn,je,N)=>{"use strict";N.d(je,{hZ:()=>d});const d="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"},1359:(yn,je,N)=>{"use strict";N.d(je,{L:()=>x});const x="function"==typeof Symbol&&Symbol.observable||"@@observable"},2926:(yn,je,N)=>{"use strict";N.d(je,{b:()=>x});const x="function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()},523:(yn,je,N)=>{"use strict";N.d(je,{W:()=>d});const d=(()=>{function Y(){return Error.call(this),this.message="argument out of range",this.name="ArgumentOutOfRangeError",this}return Y.prototype=Object.create(Error.prototype),Y})()},2108:(yn,je,N)=>{"use strict";N.d(je,{N:()=>d});const d=(()=>{function Y(){return Error.call(this),this.message="object unsubscribed",this.name="ObjectUnsubscribedError",this}return Y.prototype=Object.create(Error.prototype),Y})()},9887:(yn,je,N)=>{"use strict";function x(d){setTimeout(()=>{throw d},0)}N.d(je,{z:()=>x})},7255:(yn,je,N)=>{"use strict";function x(d){return d}N.d(je,{y:()=>x})},5894:(yn,je,N)=>{"use strict";N.d(je,{k:()=>x});const x=Array.isArray||(d=>d&&"number"==typeof d.length)},1265:(yn,je,N)=>{"use strict";N.d(je,{z:()=>x});const x=d=>d&&"number"==typeof d.length&&"function"!=typeof d},6783:(yn,je,N)=>{"use strict";function x(d){return"function"==typeof d}N.d(je,{m:()=>x})},7879:(yn,je,N)=>{"use strict";function x(d){return null!==d&&"object"==typeof d}N.d(je,{K:()=>x})},847:(yn,je,N)=>{"use strict";function x(d){return!!d&&"function"!=typeof d.subscribe&&"function"==typeof d.then}N.d(je,{t:()=>x})},8151:(yn,je,N)=>{"use strict";function x(d){return d&&"function"==typeof d.schedule}N.d(je,{K:()=>x})},4651:(yn,je,N)=>{"use strict";N.d(je,{s:()=>G});var x=N(8769),d=N(9887),l=N(4352),O=N(1359),H=N(1265),te=N(847),K=N(7879);const G=ne=>{if(ne&&"function"==typeof ne[O.L])return(ne=>ce=>{const me=ne[O.L]();if("function"!=typeof me.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return me.subscribe(ce)})(ne);if((0,H.z)(ne))return(0,x.V)(ne);if((0,te.t)(ne))return(ne=>ce=>(ne.then(me=>{ce.closed||(ce.next(me),ce.complete())},me=>ce.error(me)).then(null,d.z),ce))(ne);if(ne&&"function"==typeof ne[l.hZ])return(ne=>ce=>{const me=ne[l.hZ]();for(;;){let ve;try{ve=me.next()}catch(we){return ce.error(we),ce}if(ve.done){ce.complete();break}if(ce.next(ve.value),ce.closed)break}return"function"==typeof me.return&&ce.add(()=>{me.return&&me.return()}),ce})(ne);{const me=`You provided ${(0,K.K)(ne)?"an invalid object":`'${ne}'`} where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.`;throw new TypeError(me)}}},8769:(yn,je,N)=>{"use strict";N.d(je,{V:()=>x});const x=d=>Y=>{for(let l=0,P=d.length;l<P&&!Y.closed;l++)Y.next(d[l]);Y.complete()}},2167:function(yn,je,N){"use strict";var l,x=this&&this.__extends||(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(P,O){P.__proto__=O}||function(P,O){for(var f in O)O.hasOwnProperty(f)&&(P[f]=O[f])},function(P,O){function f(){this.constructor=P}l(P,O),P.prototype=null===O?Object.create(O):(f.prototype=O.prototype,new f)});Object.defineProperty(je,"__esModule",{value:!0});var Y=function(l){function P(){return null!==l&&l.apply(this,arguments)||this}return x(P,l),P}(N(2490).default);je.default=Y},2490:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=N(1593),Y=function(){function l(P){this.root=null,this.compare=P||x.defaultCompare,this.nElements=0}return l.prototype.add=function(P){return!x.isUndefined(P)&&null!==this.insertNode(this.createNode(P))&&(this.nElements++,!0)},l.prototype.clear=function(){this.root=null,this.nElements=0},l.prototype.isEmpty=function(){return 0===this.nElements},l.prototype.size=function(){return this.nElements},l.prototype.contains=function(P){return!x.isUndefined(P)&&null!==this.searchNode(this.root,P)},l.prototype.search=function(P){var O=this.searchNode(this.root,P);if(null!==O)return O.element},l.prototype.remove=function(P){var O=this.searchNode(this.root,P);return null!==O&&(this.removeNode(O),this.nElements--,!0)},l.prototype.inorderTraversal=function(P){this.inorderTraversalAux(this.root,P,{stop:!1})},l.prototype.preorderTraversal=function(P){this.preorderTraversalAux(this.root,P,{stop:!1})},l.prototype.postorderTraversal=function(P){this.postorderTraversalAux(this.root,P,{stop:!1})},l.prototype.levelTraversal=function(P){this.levelTraversalAux(this.root,P)},l.prototype.minimum=function(){if(!this.isEmpty()&&null!==this.root)return this.minimumAux(this.root).element},l.prototype.maximum=function(){if(!this.isEmpty()&&null!==this.root)return this.maximumAux(this.root).element},l.prototype.forEach=function(P){this.inorderTraversal(P)},l.prototype.toArray=function(){var P=[];return this.inorderTraversal(function(O){return P.push(O),!0}),P},l.prototype.height=function(){return this.heightAux(this.root)},l.prototype.searchNode=function(P,O){for(var f=1;null!==P&&0!==f;)(f=this.compare(O,P.element))<0?P=P.leftCh:f>0&&(P=P.rightCh);return P},l.prototype.transplant=function(P,O){null===P.parent?this.root=O:P===P.parent.leftCh?P.parent.leftCh=O:P.parent.rightCh=O,null!==O&&(O.parent=P.parent)},l.prototype.removeNode=function(P){if(null===P.leftCh)this.transplant(P,P.rightCh);else if(null===P.rightCh)this.transplant(P,P.leftCh);else{var O=this.minimumAux(P.rightCh);O.parent!==P&&(this.transplant(O,O.rightCh),O.rightCh=P.rightCh,O.rightCh.parent=O),this.transplant(P,O),O.leftCh=P.leftCh,O.leftCh.parent=O}},l.prototype.inorderTraversalAux=function(P,O,f){null===P||f.stop||(this.inorderTraversalAux(P.leftCh,O,f),!f.stop&&(f.stop=!1===O(P.element),!f.stop&&this.inorderTraversalAux(P.rightCh,O,f)))},l.prototype.levelTraversalAux=function(P,O){var f=new d.default;for(null!==P&&f.enqueue(P),P=f.dequeue()||null;null!=P;){if(!1===O(P.element))return;null!==P.leftCh&&f.enqueue(P.leftCh),null!==P.rightCh&&f.enqueue(P.rightCh),P=f.dequeue()||null}},l.prototype.preorderTraversalAux=function(P,O,f){null===P||f.stop||(f.stop=!1===O(P.element),!f.stop&&(this.preorderTraversalAux(P.leftCh,O,f),!f.stop&&this.preorderTraversalAux(P.rightCh,O,f)))},l.prototype.postorderTraversalAux=function(P,O,f){null===P||f.stop||(this.postorderTraversalAux(P.leftCh,O,f),!f.stop&&(this.postorderTraversalAux(P.rightCh,O,f),!f.stop&&(f.stop=!1===O(P.element))))},l.prototype.minimumAux=function(P){for(;null!=P&&null!==P.leftCh;)P=P.leftCh;return P},l.prototype.maximumAux=function(P){for(;null!=P&&null!==P.rightCh;)P=P.rightCh;return P},l.prototype.heightAux=function(P){return null===P?-1:Math.max(this.heightAux(P.leftCh),this.heightAux(P.rightCh))+1},l.prototype.insertNode=function(P){for(var O=null,f=this.root;null!==f;){var H=this.compare(P.element,f.element);if(0===H)return null;H<0?(O=f,f=f.leftCh):(O=f,f=f.rightCh)}return P.parent=O,null===O?this.root=P:this.compare(P.element,O.element)<0?O.leftCh=P:O.rightCh=P,P},l.prototype.createNode=function(P){return{element:P,leftCh:null,rightCh:null,parent:null}},l}();je.default=Y},4909:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=N(1942),Y=N(7251),l=function(){function P(O){this.toStrF=O||x.defaultToString,this.dictionary=new d.default(this.toStrF),this.nElements=0}return P.prototype.add=function(O,f){return void 0===f&&(f=1),!(x.isUndefined(O)||f<=0)&&(this.contains(O)?this.dictionary.getValue(O).copies+=f:this.dictionary.setValue(O,{value:O,copies:f}),this.nElements+=f,!0)},P.prototype.count=function(O){return this.contains(O)?this.dictionary.getValue(O).copies:0},P.prototype.contains=function(O){return this.dictionary.containsKey(O)},P.prototype.remove=function(O,f){if(void 0===f&&(f=1),x.isUndefined(O)||f<=0)return!1;if(this.contains(O)){var H=this.dictionary.getValue(O);return this.nElements-=f>H.copies?H.copies:f,H.copies-=f,H.copies<=0&&this.dictionary.remove(O),!0}return!1},P.prototype.toArray=function(){for(var O=[],H=0,te=this.dictionary.values();H<te.length;H++)for(var K=te[H],G=K.value,ne=K.copies,ce=0;ce<ne;ce++)O.push(G);return O},P.prototype.toSet=function(){for(var O=new Y.default(this.toStrF),H=0,te=this.dictionary.values();H<te.length;H++)O.add(te[H].value);return O},P.prototype.forEach=function(O){this.dictionary.forEach(function(f,H){for(var te=H.value,K=H.copies,G=0;G<K;G++)if(!1===O(te))return!1;return!0})},P.prototype.size=function(){return this.nElements},P.prototype.isEmpty=function(){return 0===this.nElements},P.prototype.clear=function(){this.nElements=0,this.dictionary.clear()},P}();je.default=l},1942:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=function(){function Y(l){this.table={},this.nElements=0,this.toStr=l||x.defaultToString}return Y.prototype.getValue=function(l){var P=this.table["$"+this.toStr(l)];if(!x.isUndefined(P))return P.value},Y.prototype.setValue=function(l,P){if(!x.isUndefined(l)&&!x.isUndefined(P)){var O,f="$"+this.toStr(l),H=this.table[f];return x.isUndefined(H)?(this.nElements++,O=void 0):O=H.value,this.table[f]={key:l,value:P},O}},Y.prototype.remove=function(l){var P="$"+this.toStr(l),O=this.table[P];if(!x.isUndefined(O))return delete this.table[P],this.nElements--,O.value},Y.prototype.keys=function(){var l=[];for(var P in this.table)x.has(this.table,P)&&l.push(this.table[P].key);return l},Y.prototype.values=function(){var l=[];for(var P in this.table)x.has(this.table,P)&&l.push(this.table[P].value);return l},Y.prototype.forEach=function(l){for(var P in this.table)if(x.has(this.table,P)){var O=this.table[P];if(!1===l(O.key,O.value))return}},Y.prototype.containsKey=function(l){return!x.isUndefined(this.getValue(l))},Y.prototype.clear=function(){this.table={},this.nElements=0},Y.prototype.size=function(){return this.nElements},Y.prototype.isEmpty=function(){return this.nElements<=0},Y.prototype.toString=function(){var l="{";return this.forEach(function(P,O){l+="\n\t"+P+" : "+O}),l+"\n}"},Y}();je.default=d},4282:function(yn,je,N){"use strict";var P,x=this&&this.__extends||(P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(O,f){O.__proto__=f}||function(O,f){for(var H in f)f.hasOwnProperty(H)&&(O[H]=f[H])},function(O,f){function H(){this.constructor=O}P(O,f),O.prototype=null===f?Object.create(f):(H.prototype=f.prototype,new H)});Object.defineProperty(je,"__esModule",{value:!0});var d=N(1942),Y=N(4604),l=function(P){function O(f,H){var te=P.call(this,H)||this;return te.defaultFactoryFunction=f,te}return x(O,P),O.prototype.setDefault=function(f,H){var te=P.prototype.getValue.call(this,f);return Y.isUndefined(te)?(this.setValue(f,H),H):te},O.prototype.getValue=function(f){return this.setDefault(f,this.defaultFactoryFunction())},O}(d.default);je.default=l},8994:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=N(5105),Y=function(){function l(P){this.data=[],this.compare=P||x.defaultCompare}return l.prototype.leftChildIndex=function(P){return 2*P+1},l.prototype.rightChildIndex=function(P){return 2*P+2},l.prototype.parentIndex=function(P){return Math.floor((P-1)/2)},l.prototype.minIndex=function(P,O){return O>=this.data.length?P>=this.data.length?-1:P:this.compare(this.data[P],this.data[O])<=0?P:O},l.prototype.siftUp=function(P){for(var O=this.parentIndex(P);P>0&&this.compare(this.data[O],this.data[P])>0;)d.swap(this.data,O,P),O=this.parentIndex(P=O)},l.prototype.siftDown=function(P){for(var O=this.minIndex(this.leftChildIndex(P),this.rightChildIndex(P));O>=0&&this.compare(this.data[P],this.data[O])>0;)d.swap(this.data,O,P),O=this.minIndex(this.leftChildIndex(P=O),this.rightChildIndex(P))},l.prototype.peek=function(){if(this.data.length>0)return this.data[0]},l.prototype.add=function(P){return!x.isUndefined(P)&&(this.data.push(P),this.siftUp(this.data.length-1),!0)},l.prototype.removeRoot=function(){if(this.data.length>0){var P=this.data[0];return this.data[0]=this.data[this.data.length-1],this.data.splice(this.data.length-1,1),this.data.length>0&&this.siftDown(0),P}},l.prototype.contains=function(P){var O=x.compareToEquals(this.compare);return d.contains(this.data,P,O)},l.prototype.size=function(){return this.data.length},l.prototype.isEmpty=function(){return this.data.length<=0},l.prototype.clear=function(){this.data.length=0},l.prototype.forEach=function(P){d.forEach(this.data,P)},l}();je.default=Y},9561:function(yn,je,N){"use strict";var H,x=this&&this.__extends||(H=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(te,K){te.__proto__=K}||function(te,K){for(var G in K)K.hasOwnProperty(G)&&(te[G]=K[G])},function(te,K){function G(){this.constructor=te}H(te,K),te.prototype=null===K?Object.create(K):(G.prototype=K.prototype,new G)});Object.defineProperty(je,"__esModule",{value:!0});var d=N(1942),Y=N(4604),l=function(){function H(te,K){this.key=te,this.value=K}return H.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},H}(),P=function(){function H(){this.key=null,this.value=null}return H.prototype.unlink=function(){this.prev.next=this.next,this.next.prev=this.prev},H}();function O(H){return!H.next}var f=function(H){function te(K){var G=H.call(this,K)||this;return G.head=new P,G.tail=new P,G.head.next=G.tail,G.tail.prev=G.head,G}return x(te,H),te.prototype.appendToTail=function(K){var G=this.tail.prev;G.next=K,K.prev=G,K.next=this.tail,this.tail.prev=K},te.prototype.getLinkedDictionaryPair=function(K){if(!Y.isUndefined(K)){var G="$"+this.toStr(K);return this.table[G]}},te.prototype.getValue=function(K){var G=this.getLinkedDictionaryPair(K);if(!Y.isUndefined(G))return G.value},te.prototype.remove=function(K){var G=this.getLinkedDictionaryPair(K);if(!Y.isUndefined(G))return H.prototype.remove.call(this,K),G.unlink(),G.value},te.prototype.clear=function(){H.prototype.clear.call(this),this.head.next=this.tail,this.tail.prev=this.head},te.prototype.replace=function(K,G){var ne="$"+this.toStr(G.key);G.next=K.next,G.prev=K.prev,this.remove(K.key),G.prev.next=G,G.next.prev=G,this.table[ne]=G,++this.nElements},te.prototype.setValue=function(K,G){if(!Y.isUndefined(K)&&!Y.isUndefined(G)){var ne=this.getLinkedDictionaryPair(K),ce=new l(K,G),me="$"+this.toStr(K);return Y.isUndefined(ne)?(this.appendToTail(ce),this.table[me]=ce,void++this.nElements):(this.replace(ne,ce),ne.value)}},te.prototype.keys=function(){var K=[];return this.forEach(function(G,ne){K.push(G)}),K},te.prototype.values=function(){var K=[];return this.forEach(function(G,ne){K.push(ne)}),K},te.prototype.forEach=function(K){for(var G=this.head.next;!O(G);){if(!1===K(G.key,G.value))return;G=G.next}},te}(d.default);je.default=f},2543:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=N(5105),Y=function(){function l(){this.firstNode=null,this.lastNode=null,this.nElements=0}return l.prototype.add=function(P,O){if(x.isUndefined(O)&&(O=this.nElements),O<0||O>this.nElements||x.isUndefined(P))return!1;var f=this.createNode(P);if(0===this.nElements||null===this.lastNode)this.firstNode=f,this.lastNode=f;else if(O===this.nElements)this.lastNode.next=f,this.lastNode=f;else if(0===O)f.next=this.firstNode,this.firstNode=f;else{var H=this.nodeAtIndex(O-1);if(null===H)return!1;f.next=H.next,H.next=f}return this.nElements++,!0},l.prototype.first=function(){if(null!==this.firstNode)return this.firstNode.element},l.prototype.last=function(){if(null!==this.lastNode)return this.lastNode.element},l.prototype.elementAtIndex=function(P){var O=this.nodeAtIndex(P);if(null!==O)return O.element},l.prototype.indexOf=function(P,O){var f=O||x.defaultEquals;if(x.isUndefined(P))return-1;for(var H=this.firstNode,te=0;null!==H;){if(f(H.element,P))return te;te++,H=H.next}return-1},l.prototype.contains=function(P,O){return this.indexOf(P,O)>=0},l.prototype.remove=function(P,O){var f=O||x.defaultEquals;if(this.nElements<1||x.isUndefined(P))return!1;for(var H=null,te=this.firstNode;null!==te;){if(f(te.element,P))return null===H?(this.firstNode=te.next,te===this.lastNode&&(this.lastNode=null)):te===this.lastNode?(this.lastNode=H,H.next=te.next,te.next=null):(H.next=te.next,te.next=null),this.nElements--,!0;H=te,te=te.next}return!1},l.prototype.clear=function(){this.firstNode=null,this.lastNode=null,this.nElements=0},l.prototype.equals=function(P,O){var f=O||x.defaultEquals;return P instanceof l&&this.size()===P.size()&&this.equalsAux(this.firstNode,P.firstNode,f)},l.prototype.equalsAux=function(P,O,f){for(;null!==P&&null!==O;){if(!f(P.element,O.element))return!1;P=P.next,O=O.next}return!0},l.prototype.removeElementAtIndex=function(P){if(!(P<0||P>=this.nElements||null===this.firstNode||null===this.lastNode)){var O;if(1===this.nElements)O=this.firstNode.element,this.firstNode=null,this.lastNode=null;else{var f=this.nodeAtIndex(P-1);null===f?(O=this.firstNode.element,this.firstNode=this.firstNode.next):f.next===this.lastNode&&(O=this.lastNode.element,this.lastNode=f),null!==f&&null!==f.next&&(O=f.next.element,f.next=f.next.next)}return this.nElements--,O}},l.prototype.forEach=function(P){for(var O=this.firstNode;null!==O&&!1!==P(O.element);)O=O.next},l.prototype.reverse=function(){for(var P=null,O=this.firstNode,f=null;null!==O;)f=O.next,O.next=P,P=O,O=f;f=this.firstNode,this.firstNode=this.lastNode,this.lastNode=f},l.prototype.toArray=function(){for(var P=[],O=this.firstNode;null!==O;)P.push(O.element),O=O.next;return P},l.prototype.size=function(){return this.nElements},l.prototype.isEmpty=function(){return this.nElements<=0},l.prototype.toString=function(){return d.toString(this.toArray())},l.prototype.nodeAtIndex=function(P){if(P<0||P>=this.nElements)return null;if(P===this.nElements-1)return this.lastNode;for(var O=this.firstNode,f=0;f<P&&null!==O;f++)O=O.next;return O},l.prototype.createNode=function(P){return{element:P,next:null}},l}();je.default=Y},5547:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=N(1942),Y=N(5105),l=function(){function P(O,f,H){void 0===H&&(H=!1),this.dict=new d.default(O),this.equalsF=f||x.defaultEquals,this.allowDuplicate=H}return P.prototype.getValue=function(O){var f=this.dict.getValue(O);return x.isUndefined(f)?[]:Y.copy(f)},P.prototype.setValue=function(O,f){if(x.isUndefined(O)||x.isUndefined(f))return!1;var H=this.dict.getValue(O);return x.isUndefined(H)?(this.dict.setValue(O,[f]),!0):!(!this.allowDuplicate&&Y.contains(H,f,this.equalsF)||(H.push(f),0))},P.prototype.remove=function(O,f){if(x.isUndefined(f)){var H=this.dict.remove(O);return!x.isUndefined(H)}var te=this.dict.getValue(O);return!(x.isUndefined(te)||!Y.remove(te,f,this.equalsF)||(0===te.length&&this.dict.remove(O),0))},P.prototype.keys=function(){return this.dict.keys()},P.prototype.values=function(){for(var f=[],H=0,te=this.dict.values();H<te.length;H++)for(var G=0,ne=te[H];G<ne.length;G++)f.push(ne[G]);return f},P.prototype.containsKey=function(O){return this.dict.containsKey(O)},P.prototype.clear=function(){this.dict.clear()},P.prototype.size=function(){return this.dict.size()},P.prototype.isEmpty=function(){return this.dict.isEmpty()},P}();je.default=l},2389:(yn,je)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var N=(()=>{return(d=N||(N={}))[d.BEFORE=0]="BEFORE",d[d.AFTER=1]="AFTER",d[d.INSIDE_AT_END=2]="INSIDE_AT_END",d[d.INSIDE_AT_START=3]="INSIDE_AT_START",N;var d})(),x=function(){function d(Y,l){void 0===Y&&(Y=[]),void 0===l&&(l={}),this.rootIds=Y,this.nodes=l,this.initRootIds(),this.initNodes()}return d.prototype.initRootIds=function(){for(var Y=0,l=this.rootIds;Y<l.length;Y++)this.createEmptyNodeIfNotExist(l[Y])},d.prototype.initNodes=function(){for(var Y in this.nodes)if(this.nodes.hasOwnProperty(Y))for(var l=0,P=this.nodes[Y];l<P.length;l++)this.createEmptyNodeIfNotExist(P[l])},d.prototype.createEmptyNodeIfNotExist=function(Y){this.nodes[Y]||(this.nodes[Y]=[])},d.prototype.getRootIds=function(){return this.rootIds.slice()},d.prototype.getNodes=function(){var Y={};for(var l in this.nodes)this.nodes.hasOwnProperty(l)&&(Y[l]=this.nodes[l].slice());return Y},d.prototype.getObject=function(){return{rootIds:this.getRootIds(),nodes:this.getNodes()}},d.prototype.toObject=function(){return this.getObject()},d.prototype.flatten=function(){for(var Y=this,l=[],P=0;P<this.rootIds.length;P++){var O=this.rootIds[P];l.push({id:O,level:0,hasParent:!1,childrenCount:0}),G(O,this.nodes,l,0)}for(var f=0,H=l;f<H.length;f++){var te=H[f];te.childrenCount=Y.nodes[ne=te.id]?Y.nodes[ne].length:0}var ne;return l;function G(ne,ce,me,ve){if(void 0===ve&&(ve=0),ne&&ce&&me&&ce[ne]){ve++;for(var we=ce[ne],ze=0;ze<we.length;ze++){var Ne=we[ze];me.push({id:Ne,level:ve,hasParent:!0}),G(Ne,ce,me,ve)}ve--}}},d.prototype.moveIdBeforeId=function(Y,l){return this.moveId(Y,l,N.BEFORE)},d.prototype.moveIdAfterId=function(Y,l){return this.moveId(Y,l,N.AFTER)},d.prototype.moveIdIntoId=function(Y,l,P){return void 0===P&&(P=!0),this.moveId(Y,l,P?N.INSIDE_AT_START:N.INSIDE_AT_END)},d.prototype.swapRootIdWithRootId=function(Y,l){var P=this.findRootId(Y),O=this.findRootId(l);this.swapRootPositionWithRootPosition(P,O)},d.prototype.swapRootPositionWithRootPosition=function(Y,l){var P=this.rootIds[l];this.rootIds[l]=this.rootIds[Y],this.rootIds[Y]=P},d.prototype.deleteId=function(Y){this.rootDeleteId(Y),this.nodeAndSubNodesDelete(Y),this.nodeRefrencesDelete(Y)},d.prototype.insertIdBeforeId=function(Y,l){var P=this.findRootId(Y);for(var O in P>-1&&this.insertIdIntoRoot(l,P),this.nodes)if(this.nodes.hasOwnProperty(O)){var f=this.findNodeId(O,Y);f>-1&&this.insertIdIntoNode(O,l,f)}},d.prototype.insertIdAfterId=function(Y,l){var P=this.findRootId(Y);for(var O in P>-1&&this.insertIdIntoRoot(l,P+1),this.nodes)if(this.nodes.hasOwnProperty(O)){var f=this.findNodeId(O,Y);f>-1&&this.insertIdIntoNode(O,l,f+1)}},d.prototype.insertIdIntoId=function(Y,l){this.nodeInsertAtEnd(Y,l),this.nodes[l]=[]},d.prototype.insertIdIntoRoot=function(Y,l){void 0===l?this.rootInsertAtEnd(Y):this.rootIds.splice(l<0?l+this.rootIds.length+1:l,0,Y),this.nodes[Y]=this.nodes[Y]||[]},d.prototype.insertIdIntoNode=function(Y,l,P){this.nodes[Y]=this.nodes[Y]||[],this.nodes[l]=this.nodes[l]||[],void 0===P?this.nodeInsertAtEnd(Y,l):this.nodes[Y].splice(P<0?P+this.nodes[Y].length+1:P,0,l)},d.prototype.moveId=function(Y,l,P){var O=Y,f=this.findRootId(O);for(var K in this.nodes)if(this.nodes.hasOwnProperty(K)){this.findNodeId(K,l);break}var G=l,ne=this.findRootId(G);for(var K in this.nodes)if(this.nodes.hasOwnProperty(K)){this.findNodeId(K,l);break}if(f>-1){if(ne>-1)switch(this.rootDelete(f),ne>f&&ne--,P){case N.BEFORE:this.insertIdIntoRoot(O,ne);break;case N.AFTER:this.insertIdIntoRoot(O,ne+1);break;case N.INSIDE_AT_START:this.nodeInsertAtStart(G,O);break;case N.INSIDE_AT_END:this.nodeInsertAtEnd(G,O)}else for(var K in this.rootDelete(f),this.nodes)if(this.nodes.hasOwnProperty(K)&&(ve=this.findNodeId(K,G))>-1){switch(P){case N.BEFORE:this.insertIdIntoNode(K,O,ve);break;case N.AFTER:this.insertIdIntoNode(K,O,ve+1);break;case N.INSIDE_AT_START:this.nodeInsertAtStart(G,O);break;case N.INSIDE_AT_END:this.nodeInsertAtEnd(G,O)}break}}else if(ne>-1){for(var K in this.nodes)if(this.nodes.hasOwnProperty(K)&&(ve=this.findNodeId(K,O))>-1){this.nodeDeleteAtIndex(K,ve);break}switch(P){case N.BEFORE:this.insertIdIntoRoot(O,ne);break;case N.AFTER:this.insertIdIntoRoot(O,ne+1);break;case N.INSIDE_AT_START:this.nodeInsertAtStart(G,O);break;case N.INSIDE_AT_END:this.nodeInsertAtEnd(G,O)}}else{for(var K in this.nodes)if(this.nodes.hasOwnProperty(K)&&(ve=this.findNodeId(K,O))>-1){this.nodeDeleteAtIndex(K,ve);break}for(var K in this.nodes)if(this.nodes.hasOwnProperty(K)){var ve;if((ve=this.findNodeId(K,G))>-1){switch(P){case N.BEFORE:this.insertIdIntoNode(K,O,ve);break;case N.AFTER:this.insertIdIntoNode(K,O,ve+1);break;case N.INSIDE_AT_START:this.nodeInsertAtStart(G,O);break;case N.INSIDE_AT_END:this.nodeInsertAtEnd(G,O)}break}}}},d.prototype.swapArrayElements=function(Y,l,P){var O=Y[l];return Y[l]=Y[P],Y[P]=O,Y},d.prototype.rootDeleteId=function(Y){var l=this.findRootId(Y);l>-1&&this.rootDelete(l)},d.prototype.nodeAndSubNodesDelete=function(Y){for(var l=[],P=0;P<this.nodes[Y].length;P++)this.nodeAndSubNodesDelete(this.nodes[Y][P]),l.push(Y);for(this.nodeDelete(Y),P=0;P<l.length;P++)this.nodeDelete(l[P])},d.prototype.nodeRefrencesDelete=function(Y){for(var l in this.nodes)if(this.nodes.hasOwnProperty(l))for(var P=0;P<this.nodes[l].length;P++)this.nodes[l][P]===Y&&this.nodeDeleteAtIndex(l,P)},d.prototype.nodeDelete=function(Y){delete this.nodes[Y]},d.prototype.findRootId=function(Y){return this.rootIds.indexOf(Y)},d.prototype.findNodeId=function(Y,l){return this.nodes[Y].indexOf(l)},d.prototype.findNode=function(Y){return this.nodes[Y]},d.prototype.nodeInsertAtStart=function(Y,l){this.nodes[Y].unshift(l)},d.prototype.nodeInsertAtEnd=function(Y,l){this.nodes[Y].push(l)},d.prototype.rootDelete=function(Y){this.rootIds.splice(Y,1)},d.prototype.nodeDeleteAtIndex=function(Y,l){this.nodes[Y].splice(l,1)},d.prototype.rootInsertAtStart=function(Y){this.rootIds.unshift(Y)},d.prototype.rootInsertAtEnd=function(Y){this.rootIds.push(Y)},d}();je.default=x},6718:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=N(8994),Y=function(){function l(P){this.heap=new d.default(x.reverseCompareFunction(P))}return l.prototype.enqueue=function(P){return this.heap.add(P)},l.prototype.add=function(P){return this.heap.add(P)},l.prototype.dequeue=function(){if(0!==this.heap.size()){var P=this.heap.peek();return this.heap.removeRoot(),P}},l.prototype.peek=function(){return this.heap.peek()},l.prototype.contains=function(P){return this.heap.contains(P)},l.prototype.isEmpty=function(){return this.heap.isEmpty()},l.prototype.size=function(){return this.heap.size()},l.prototype.clear=function(){this.heap.clear()},l.prototype.forEach=function(P){this.heap.forEach(P)},l}();je.default=Y},1593:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(2543),d=function(){function Y(){this.list=new x.default}return Y.prototype.enqueue=function(l){return this.list.add(l)},Y.prototype.add=function(l){return this.list.add(l)},Y.prototype.dequeue=function(){if(0!==this.list.size()){var l=this.list.first();return this.list.removeElementAtIndex(0),l}},Y.prototype.peek=function(){if(0!==this.list.size())return this.list.first()},Y.prototype.size=function(){return this.list.size()},Y.prototype.contains=function(l,P){return this.list.contains(l,P)},Y.prototype.isEmpty=function(){return this.list.size()<=0},Y.prototype.clear=function(){this.list.clear()},Y.prototype.forEach=function(l){this.list.forEach(l)},Y}();je.default=d},7251:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604),d=N(5105),Y=N(1942),l=function(){function P(O){this.dictionary=new Y.default(O)}return P.prototype.contains=function(O){return this.dictionary.containsKey(O)},P.prototype.add=function(O){return!this.contains(O)&&!x.isUndefined(O)&&(this.dictionary.setValue(O,O),!0)},P.prototype.intersection=function(O){var f=this;this.forEach(function(H){return O.contains(H)||f.remove(H),!0})},P.prototype.union=function(O){var f=this;O.forEach(function(H){return f.add(H),!0})},P.prototype.difference=function(O){var f=this;O.forEach(function(H){return f.remove(H),!0})},P.prototype.isSubsetOf=function(O){if(this.size()>O.size())return!1;var f=!0;return this.forEach(function(H){return!!O.contains(H)||(f=!1,!1)}),f},P.prototype.remove=function(O){return!!this.contains(O)&&(this.dictionary.remove(O),!0)},P.prototype.forEach=function(O){this.dictionary.forEach(function(f,H){return O(H)})},P.prototype.toArray=function(){return this.dictionary.values()},P.prototype.isEmpty=function(){return this.dictionary.isEmpty()},P.prototype.size=function(){return this.dictionary.size()},P.prototype.clear=function(){this.dictionary.clear()},P.prototype.toString=function(){return d.toString(this.toArray())},P}();je.default=l},9389:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(2543),d=function(){function Y(){this.list=new x.default}return Y.prototype.push=function(l){return this.list.add(l,0)},Y.prototype.add=function(l){return this.list.add(l,0)},Y.prototype.pop=function(){return this.list.removeElementAtIndex(0)},Y.prototype.peek=function(){return this.list.first()},Y.prototype.size=function(){return this.list.size()},Y.prototype.contains=function(l,P){return this.list.contains(l,P)},Y.prototype.isEmpty=function(){return this.list.isEmpty()},Y.prototype.clear=function(){this.list.clear()},Y.prototype.forEach=function(l){this.list.forEach(l)},Y}();je.default=d},5105:(yn,je,N)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var x=N(4604);function d(ne,ce,me){for(var ve=me||x.defaultEquals,we=ne.length,ze=0;ze<we;ze++)if(ve(ne[ze],ce))return ze;return-1}je.indexOf=d,je.lastIndexOf=function(ne,ce,me){for(var ve=me||x.defaultEquals,ze=ne.length-1;ze>=0;ze--)if(ve(ne[ze],ce))return ze;return-1},je.contains=function(ne,ce,me){return d(ne,ce,me)>=0},je.remove=function(ne,ce,me){var ve=d(ne,ce,me);return!(ve<0||(ne.splice(ve,1),0))},je.frequency=function(ne,ce,me){for(var ve=me||x.defaultEquals,we=ne.length,ze=0,Ne=0;Ne<we;Ne++)ve(ne[Ne],ce)&&ze++;return ze},je.equals=function(ne,ce,me){var ve=me||x.defaultEquals;if(ne.length!==ce.length)return!1;for(var we=ne.length,ze=0;ze<we;ze++)if(!ve(ne[ze],ce[ze]))return!1;return!0},je.copy=function(ne){return ne.concat()},je.swap=function(ne,ce,me){if(ce<0||ce>=ne.length||me<0||me>=ne.length)return!1;var ve=ne[ce];return ne[ce]=ne[me],ne[me]=ve,!0},je.toString=function(ne){return"["+ne.toString()+"]"},je.forEach=function(ne,ce){for(var me=0,ve=ne;me<ve.length;me++)if(!1===ce(ve[me]))return}},8254:(yn,je,N)=>{"use strict";N(5105),N(4909),N(2167),N(2490);var O=N(1942);je.Xy=O.default,N(8994),N(9561),N(2543),N(5547),N(4282),N(4282),N(1593),N(6718),N(7251),N(9389),N(2389),N(4604)},4604:(yn,je)=>{"use strict";Object.defineProperty(je,"__esModule",{value:!0});var N=Object.prototype.hasOwnProperty;function P(K){return"function"==typeof K}function O(K){return void 0===K}function f(K){return"[object String]"===Object.prototype.toString.call(K)}je.has=function(K,G){return N.call(K,G)},je.defaultCompare=function(K,G){return K<G?-1:K===G?0:1},je.defaultEquals=function(K,G){return K===G},je.defaultToString=function(K){return null===K?"COLLECTION_NULL":O(K)?"COLLECTION_UNDEFINED":f(K)?"$s"+K:"$o"+K.toString()},je.makeString=function(K,G){if(void 0===G&&(G=","),null===K)return"COLLECTION_NULL";if(O(K))return"COLLECTION_UNDEFINED";if(f(K))return K.toString();var ne="{",ce=!0;for(var me in K)je.has(K,me)&&(ce?ce=!1:ne+=G,ne=ne+me+":"+K[me]);return ne+"}"},je.isFunction=P,je.isUndefined=O,je.isString=f,je.reverseCompareFunction=function(K){return O(K)||!P(K)?function(G,ne){return G<ne?1:G===ne?0:-1}:function(G,ne){return-1*K(G,ne)}},je.compareToEquals=function(K){return function(G,ne){return 0===K(G,ne)}}},1949:(yn,je,N)=>{"use strict";N.d(je,{B:()=>ne});var x=N(865),d=N(2022),Y=N(5966),l=N(6019);function P(ce,me){if(1&ce&&(x.TgZ(0,"ion-badge",7),x._uU(1),x.qZA()),2&ce){const ve=x.oxw().$implicit;x.xp6(1),x.hij("",ve.Quantity," x")}}function O(ce,me){if(1&ce&&(x.TgZ(0,"strong"),x._uU(1),x.qZA()),2&ce){const ve=x.oxw().$implicit;x.xp6(1),x.hij("",ve.PowerKW," kW ")}}function f(ce,me){if(1&ce&&(x.TgZ(0,"div"),x._uU(1),x.qZA()),2&ce){const ve=x.oxw().$implicit;x.xp6(1),x.hij("",null==ve.CurrentType?null:ve.CurrentType.Title," ")}}function H(ce,me){if(1&ce&&(x.TgZ(0,"span"),x._uU(1),x.qZA()),2&ce){const ve=x.oxw().$implicit;x.xp6(1),x.hij("",ve.Amps,"A ")}}function te(ce,me){if(1&ce&&(x.TgZ(0,"span"),x._uU(1),x.qZA()),2&ce){const ve=x.oxw().$implicit;x.xp6(1),x.hij("",ve.Voltage,"V ")}}function K(ce,me){if(1&ce){const ve=x.EpF();x.TgZ(0,"ion-col"),x.TgZ(1,"ion-button",8),x.NdJ("click",function(){x.CHM(ve);const ze=x.oxw().$implicit;return x.oxw().editConnection(ze)}),x._UZ(2,"ion-icon",9),x.qZA(),x._UZ(3,"br"),x.TgZ(4,"ion-button",10),x.NdJ("click",function(){x.CHM(ve);const ze=x.oxw().$implicit;return x.oxw().deleteConnection(ze)}),x._UZ(5,"ion-icon",11),x.qZA(),x.qZA()}}function G(ce,me){if(1&ce&&(x.TgZ(0,"ion-row"),x.TgZ(1,"ion-col"),x.TgZ(2,"ion-row"),x.TgZ(3,"ion-col",1),x._UZ(4,"img",2),x.YNc(5,P,2,1,"ion-badge",3),x.TgZ(6,"div",4),x._uU(7),x.qZA(),x.qZA(),x.TgZ(8,"ion-col"),x.TgZ(9,"ion-row"),x.TgZ(10,"ion-col"),x.TgZ(11,"ion-note"),x.TgZ(12,"div"),x.TgZ(13,"strong",5),x._uU(14),x.qZA(),x.qZA(),x.YNc(15,O,2,1,"strong",6),x.YNc(16,f,2,1,"div",6),x.qZA(),x.TgZ(17,"ion-note"),x.YNc(18,H,2,1,"span",6),x.YNc(19,te,2,1,"span",6),x.qZA(),x.qZA(),x.qZA(),x.TgZ(20,"ion-row"),x.TgZ(21,"ion-col",4),x._uU(22),x.qZA(),x.TgZ(23,"ion-col",4),x._uU(24),x.qZA(),x.qZA(),x.qZA(),x.YNc(25,K,6,0,"ion-col",6),x.qZA(),x.qZA(),x.qZA()),2&ce){const ve=me.$implicit,we=x.oxw();x.xp6(4),x.Q6J("src",we.getConnectorTypeIcon(ve.ConnectionTypeID),x.LSH),x.xp6(1),x.Q6J("ngIf",ve.Quantity),x.xp6(2),x.Oqu(null==ve.StatusType?null:ve.StatusType.Title),x.xp6(6),x.s9C("title",null==ve.ConnectionType?null:ve.ConnectionType.FormalName),x.xp6(1),x.hij("",null==ve.ConnectionType?null:ve.ConnectionType.Title," "),x.xp6(1),x.Q6J("ngIf",ve.PowerKW),x.xp6(1),x.Q6J("ngIf",ve.CurrentTypeID),x.xp6(2),x.Q6J("ngIf",ve.Amps),x.xp6(1),x.Q6J("ngIf",ve.Voltage),x.xp6(3),x.Oqu(ve.Reference),x.xp6(2),x.Oqu(ve.Comments),x.xp6(1),x.Q6J("ngIf",we.enableEdit)}}let ne=(()=>{class ce{constructor(){this.enableEdit=!1,this.onEdit=new x.vpe,this.onDelete=new x.vpe}ngOnInit(){}editConnection(ve){this.onEdit.emit(ve)}deleteConnection(ve){this.onDelete.emit(ve)}getConnectorTypeIcon(ve){return d.c.getIconForConnector(ve)}}return ce.\u0275fac=function(ve){return new(ve||ce)},ce.\u0275cmp=x.Xpm({type:ce,selectors:[["app-equipment-details"]],inputs:{item:"item",enableEdit:"enableEdit"},outputs:{onEdit:"onEdit",onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["size","3"],[2,"max-width","64px",3,"src"],["color","primary",4,"ngIf"],[1,"info"],[3,"title"],[4,"ngIf"],["color","primary"],["size","small","color","secondary",3,"click"],["name","create","slot","icon-only"],["size","small","color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(ve,we){1&ve&&(x.TgZ(0,"ion-grid"),x.YNc(1,G,26,12,"ion-row",0),x.qZA()),2&ve&&(x.xp6(1),x.Q6J("ngForOf",we.item.Connections))},directives:[Y.jY,l.sg,Y.Nd,Y.wI,l.O5,Y.uN,Y.yp,Y.YG,Y.gu],styles:[""]}),ce})()},9574:(yn,je,N)=>{"use strict";N.d(je,{v:()=>ne});var x=N(4553),d=N(6505),Y=N(865),l=N(873),P=N(5966),O=N(4522),f=N(9101),H=N(6019);function te(ce,me){1&ce&&(Y.TgZ(0,"div"),Y._UZ(1,"ion-spinner"),Y.qZA())}function K(ce,me){if(1&ce){const ve=Y.EpF();Y.TgZ(0,"ion-item",5),Y.NdJ("click",function(){const Ne=Y.CHM(ve).$implicit;return Y.oxw(2).placeSelected(Ne)}),Y.TgZ(1,"ion-avatar",6),Y._UZ(2,"ion-icon",7),Y.qZA(),Y.TgZ(3,"ion-label"),Y.TgZ(4,"p"),Y._uU(5),Y.qZA(),Y.qZA(),Y.qZA()}if(2&ce){const ve=me.$implicit;Y.xp6(5),Y.Oqu(ve.Address)}}function G(ce,me){if(1&ce&&(Y.TgZ(0,"div",1),Y.YNc(1,te,2,0,"div",2),Y.TgZ(2,"ion-list"),Y.YNc(3,K,6,1,"ion-item",3),Y.TgZ(4,"ion-item"),Y.TgZ(5,"p",4),Y._uU(6),Y.qZA(),Y.qZA(),Y.qZA(),Y.qZA()),2&ce){const ve=Y.oxw();Y.xp6(1),Y.Q6J("ngIf",ve.searchInProgress),Y.xp6(2),Y.Q6J("ngForOf",ve.placeList),Y.xp6(3),Y.hij(" ",ve.placeAttribution," ")}}let ne=(()=>{class ce{constructor(ve,we,ze,Ne,Ae){this.logging=ve,this.changeDetector=we,this.platform=ze,this.http=Ne,this.events=Ae,this.searchInProgress=!1,this.placeSearchActive=!1,this.placeAttribution="",this.placeChanged=new Y.vpe,this.searchKeyword="",this.searchInProgress=!1,this.mapService=new l.k(Ae,ve,Ne)}ngOnInit(){var ve=this;return(0,x.Z)(function*(){yield ve.platform.ready(),ve.mapService.initAPI()})()}onSearchFocus(){this.placeSearchFocused=!0}onSearchBlur(){this.placeSearchFocused=!1}onSearchCancel(){}getPlacesAutoComplete(ve,we){var ze=this;return(0,x.Z)(function*(){ze.placeSearchType=we;let Ne=ve.target.value;if(Ne&&Ne.length>3){ze.logging.log("Starting place lookup for:"+Ne),ze.placeSearchActive=!0,ze.searchInProgress=!0,ze.searchInProgress=!1,ze.placeSearchActive=!0;try{ze.placeList=yield ze.mapService.placeSearch(Ne),ze.placeList&&ze.placeList.length>0&&(ze.placeAttribution=ze.placeList[0].Attribution)}catch{}ze.searchInProgress=!1,ze.placeSearchActive=!0}else ze.searchInProgress=!1,ze.placeSearchActive=!1})()}placeSelected(ve){this.logging.log("Looking up place details:"+ve.Title+"::"+ve.ReferenceID),this.selectedPlace=ve,this.placeChanged.emit(ve),this.placeSearchActive=!1}}return ce.\u0275fac=function(ve){return new(ve||ce)(Y.Y36(d.z),Y.Y36(Y.sBO),Y.Y36(P.t4),Y.Y36(O.eN),Y.Y36(f.z))},ce.\u0275cmp=Y.Xpm({type:ce,selectors:[["place-search"]],inputs:{searchKeyword:"searchKeyword"},outputs:{selectedPlace:"selectedPlace",placeChanged:"placeChanged"},decls:1,vars:1,consts:[["class","place-search",4,"ngIf"],[1,"place-search"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"place-attribution"],[3,"click"],["item-left",""],["name","locate"]],template:function(ve,we){1&ve&&Y.YNc(0,G,7,3,"div",0),2&ve&&Y.Q6J("ngIf",we.placeSearchActive)},directives:[H.O5,P.q_,H.sg,P.Ie,P.PQ,P.BJ,P.gu,P.Q$],styles:[".place-search[_ngcontent-%COMP%]{position:absolute;z-index:1000}.place-attribution[_ngcontent-%COMP%]{font-size:9px;color:#dcdcdc;max-width:100%}"]}),ce})()},3499:(yn,je,N)=>{"use strict";N.d(je,{o:()=>H});var x=N(865),d=N(2022),Y=N(5966),l=N(6019);function P(te,K){if(1&te){const G=x.EpF();x.TgZ(0,"ion-button",5),x.NdJ("click",function(){x.CHM(G);const ce=x.oxw().$implicit;return x.oxw().onCopyCommand(ce)}),x._uU(1,"Copy"),x.qZA()}}function O(te,K){if(1&te){const G=x.EpF();x.TgZ(0,"ion-button",5),x.NdJ("click",function(){x.CHM(G);const ce=x.oxw().$implicit;return x.oxw().onEditCommand(ce)}),x._uU(1,"Edit"),x.qZA()}}function f(te,K){if(1&te&&(x.TgZ(0,"ion-item",1),x.TgZ(1,"ion-grid"),x.TgZ(2,"ion-row"),x.TgZ(3,"ion-col"),x._uU(4),x.qZA(),x.qZA(),x.TgZ(5,"ion-row"),x.TgZ(6,"ion-col",2),x.TgZ(7,"p"),x._UZ(8,"img",3),x.qZA(),x.TgZ(9,"ion-note"),x._uU(10),x.qZA(),x.YNc(11,P,2,0,"ion-button",4),x.YNc(12,O,2,0,"ion-button",4),x.qZA(),x.TgZ(13,"ion-col"),x.TgZ(14,"ion-row"),x.TgZ(15,"ion-col"),x.TgZ(16,"p"),x._uU(17),x.qZA(),x.TgZ(18,"ion-note"),x._uU(19),x.qZA(),x.qZA(),x.qZA(),x.TgZ(20,"ion-row"),x.TgZ(21,"ion-col"),x._uU(22),x.qZA(),x.TgZ(23,"ion-col"),x._uU(24),x.qZA(),x.qZA(),x.qZA(),x.qZA(),x.qZA(),x.qZA()),2&te){const G=K.$implicit,ne=x.oxw();x.xp6(4),x.hij(" ",G.AddressInfo.Title," "),x.xp6(4),x.Q6J("src",ne.getIconForPOI(G),x.LSH),x.xp6(2),x.hij(" ",ne.getFormattedDistance(G)," "),x.xp6(1),x.Q6J("ngIf",ne.enableCopyOption),x.xp6(1),x.Q6J("ngIf",ne.enableEditOption),x.xp6(5),x.hij(" ",ne.getFormattedAddress(G)," "),x.xp6(2),x.hij(" ",ne.getFormattedConnectorList(G)," "),x.xp6(3),x.hij(" ",null==G.UsageType?null:G.UsageType.Title," "),x.xp6(2),x.hij(" ",null==G.OperatorInfo?null:G.OperatorInfo.Title," ")}}let H=(()=>{class te{constructor(){this.enableCopyOption=!1,this.enableEditOption=!1,this.poiList=[],this.onCopy=new x.vpe,this.onEdit=new x.vpe}ngOnInit(){}onCopyCommand(G){this.onCopy.emit(G)}onEditCommand(G){this.onEdit.emit(G)}getFormattedAddress(G){let ne="";return ne+=G.AddressInfo.Title!=G.AddressInfo.AddressLine1?G.AddressInfo.Title:G.AddressInfo.Town,ne}getFormattedConnectorList(G){if(!G.Connections)return;let ne=[];for(let ce of G.Connections)null!=ce.ConnectionType&&(ne.find(me=>me==ce.ConnectionType.Title)||ne.push(ce.ConnectionType.Title));return ne.join(", ")}getIconForPOI(G){return d.c.getIconForPOI(G)}getFormattedDistance(G){return d.c.getFormattedDistance(G)}}return te.\u0275fac=function(G){return new(G||te)},te.\u0275cmp=x.Xpm({type:te,selectors:[["app-poi-list"]],inputs:{enableCopyOption:"enableCopyOption",enableEditOption:"enableEditOption",poiList:"poiList"},outputs:{onCopy:"onCopy",onEdit:"onEdit"},decls:2,vars:1,consts:[["style","max-width:400px;",4,"ngFor","ngForOf"],[2,"max-width","400px"],["size","3"],[2,"width","24px",3,"src"],["size","small",3,"click",4,"ngIf"],["size","small",3,"click"]],template:function(G,ne){1&G&&(x.TgZ(0,"ion-list"),x.YNc(1,f,25,9,"ion-item",0),x.qZA()),2&G&&(x.xp6(1),x.Q6J("ngForOf",ne.poiList))},directives:[Y.q_,l.sg,Y.Ie,Y.jY,Y.Nd,Y.wI,Y.uN,l.O5,Y.YG],styles:[""]}),te})()},5316:(yn,je,N)=>{"use strict";N.d(je,{e:()=>O});var x=N(6019),d=N(5966),Y=N(9133),l=N(1586),P=N(865);let O=(()=>{class f{}return f.\u0275fac=function(te){return new(te||f)},f.\u0275mod=P.oAB({type:f}),f.\u0275inj=P.cJS({providers:[x.JJ],imports:[[x.ez,d.Pc,Y.u5,l.aw]]}),f})()},9567:(yn,je,N)=>{"use strict";N.d(je,{X:()=>d});var x=N(8260);class d{constructor(){this.baseURL="https://map.openchargemap.io",this.loginProviderRedirectBaseURL="https://openchargemap.org/site/loginprovider/?_mode=silent&_forceLogin=true&_redirectURL=",this.loginProviderRedirectURL=this.loginProviderRedirectBaseURL+this.baseURL,this.enableLiveMapQuerying=!0,this.googleMapsAPIKey=x.N.googleMapsKey,this.enableStaticMaps=x.N.enableStaticMaps}}},2022:(yn,je,N)=>{"use strict";N.d(je,{c:()=>d});var x=N(8260);let d=(()=>{class Y{static isFeatureEnabled(P){return!!x.N.enabledFeatures.find(O=>O===P)}static getClientHeight(){const P=document.body,O=document.documentElement;return Math.max(P.scrollHeight,P.offsetHeight,O.clientHeight,O.scrollHeight,O.offsetHeight)}static getClientWidth(){const P=document.body,O=document.documentElement;return Math.max(P.scrollWidth,P.offsetWidth,O.clientWidth,O.scrollWidth,O.offsetWidth)}static getMaxLevelOfPOI(P){let O=0;if(null!=P.Connections)for(let f=0;f<P.Connections.length;f++)null!=P.Connections[f].Level&&P.Connections[f].Level.ID>O&&(O=P.Connections[f].Level.ID);return 4===O&&(O=2),O>4&&(O=3),O}static getIconForPOI(P){let f="assets/images/icons/map/level"+Y.getMaxLevelOfPOI(P);return null!=P.UsageType&&P.UsageType.Title.indexOf("Private")>-1?f+="_private":f+=null!=P.StatusType&&!0!==P.StatusType.IsOperational?"_nonoperational":"_operational",f+="_icon.png",f}static getColorForPOI(P){const O=Y.getMaxLevelOfPOI(P);let f="#c0c0c0";return null!=P.UsageType&&P.UsageType.Title.indexOf("Private")>-1?f="#FF0000":null!=P.StatusType&&!0!==P.StatusType.IsOperational?f="#a0a0a0":2==O?f="#72EB0D":3==O&&(f="#EB800D"),f}static getIconForConnector(P){let O="assets/images/icons/connectors/";return O+=1===P?"Type1_J1772.svg":2===P?"Chademo_type4.svg":25===P?"Type2_socket.svg":32===P?"Type1_CCS.svg":33===P?"Type2_CCS.svg":1036===P?"Type2_tethered.svg":28===P?"schuko.svg":"Unknown.svg",O}static getFormattedDistance(P){return P&&P.AddressInfo&&P.AddressInfo.Distance?P.AddressInfo.Distance.toFixed(1)+" "+(1===P.AddressInfo.DistanceUnit?"km":"miles"):""}static fixJSONDate(P){if(null==P)return null;if(0==P.indexOf("/")){let f=/Date\(([^)]+)\)/.exec(P);P=new Date(parseFloat(f[1]))}else P=new Date(P);return P}static formatMapLinkFromPosition(P,O,f,H,te){return'<a href="https://maps.google.com/maps?saddr='+O+","+f+"&daddr="+P.AddressInfo.Latitude+","+P.AddressInfo.Longitude+'">Map ('+Math.ceil(H)+" "+te+")</a>"}static formatSystemWebLink(P,O){return"<a href='#' onclick=\"window.open('"+P+"', '_system');return false;\">"+O+"</a>"}static formatMapLink(P,O,f){return f?device&&"WinCE"==device.platform?this.formatSystemWebLink("maps:"+P.AddressInfo.Latitude+","+P.AddressInfo.Longitude,O):device&&"iOS"===device.platform?this.formatSystemWebLink("https://maps.apple.com/?q="+P.AddressInfo.Latitude+","+P.AddressInfo.Longitude,O):this.formatSystemWebLink("https://maps.google.com/maps?q="+P.AddressInfo.Latitude+","+P.AddressInfo.Longitude,O):'<a target="_blank"  href="https://maps.google.com/maps?q='+P.AddressInfo.Latitude+","+P.AddressInfo.Longitude+'">'+O+"</a>"}static formatURL(P,O=null){return null==P||""==P?"":(-1==P.indexOf("http")&&(P="https://"+P),'<a target="_blank" href="'+P+'">'+(O??P)+"</a>")}static formatString(P){return null==P?"":P.toString()}static formatTextField(P,O=null,f=!1,H=!1,te=null){if(null==P||""==P||null==P)return"";let K=(null!=O?"<strong class='ocm-label' "+(null!=te?"data-localize='"+te+"' ":"")+">"+O+"</strong>: ":"")+(f?"<br/>":"")+P.toString().replace("\n","<br/>")+"<br/>";return 1==H&&(K="<p>"+K+"</p>"),K}static formatEmailAddress(P){return null!=P&&null!=P&&""!=P?"<i class='fa fa-envelope fa-fw'></i> <a href=\"mailto:"+P+'">'+P+"</a><br/>":""}static formatPhone(P,O=null){return null!=P&&null!=P&&""!=P?(null==O?O="<i class='fa fa-phone fa-fw '></i> ":O+=": ",O+'<a href="tel:'+P+'">'+P+"</a><br/>"):""}static formatPOIDetails(P,O){let H=new Date;null==O&&(O=!1);let te=this.formatPOIAddress(P,!1),K="";K+=this.formatPhone(P.AddressInfo.ContactTelephone1),K+=this.formatPhone(P.AddressInfo.ContactTelephone2),K+=this.formatEmailAddress(P.AddressInfo.ContactEmail);let G="";if(null!=P.AddressInfo.Distance){let ze="https://maps.google.com/maps?saddr=&daddr="+P.AddressInfo.Latitude+","+P.AddressInfo.Longitude;G+="<strong id='addr_distance'><span data-localize='details.approxDistance'>Distance</span>: "+P.AddressInfo.Distance.toFixed(1)+" "+(2==P.AddressInfo.DistanceUnit?"Miles":"KM")+"</strong>",G+="<p>"+this.formatSystemWebLink(ze,"Get Directions")+"</p>"}if(null!=P.AddressInfo.RelatedURL&&""!=P.AddressInfo.RelatedURL){let ze=P.AddressInfo.RelatedURL;ze=ze.replace(/.*?:\/\//g,""),ze.length>40&&(ze=ze.substr(0,40)+".."),K+="<i class='fa fa-fw fa-external-link'></i>  "+this.formatSystemWebLink(P.AddressInfo.RelatedURL,"<span data-localize='details.addressRelatedURL'>"+ze+"</span>")}K+="</p>";const ne=this.formatTextField(P.GeneralComments,null,!1,!0)+this.formatTextField(P.AddressInfo.AccessComments,"Access",!0,!0,"details.accessComments");let ce="";null!=P.NumberOfPoints&&(ce+=this.formatTextField(P.NumberOfPoints,"Bays",!1,!0,"details.numberOfPoints")),null!=P.UsageType&&(ce+=this.formatTextField(P.UsageType.Title,"Usage",!1,!0,"details.usageType")),null!=P.UsageCost&&(ce+=this.formatTextField(P.UsageCost,"Usage Cost",!1,!0,"details.usageCost")),null!=P.OperatorInfo&&1!=P.OperatorInfo.ID&&(ce+=this.formatTextField(P.OperatorInfo.Title,"Operator",!1,!0,"details.operatorTitle"),null!=P.OperatorInfo.WebsiteURL&&(ce+=this.formatTextField(this.formatURL(P.OperatorInfo.WebsiteURL),"Operator Website",!0,!0,"details.operatorWebsite")));let me="";if(null!=P.StatusType&&(me+=this.formatTextField(P.StatusType.Title,"Status",!1,!0,"details.operationalStatus"),null!=P.DateLastStatusUpdate&&(me+=this.formatTextField(Math.round((H-this.fixJSONDate(P.DateLastStatusUpdate))/864e5)+" days ago","Last Updated",!1,!0,"details.lastUpdated"))),null!=P.Connections&&P.Connections.length>0){me+="<table class='table table-striped'>",me+="<tr><th data-localize='details.equipment.connectionType'>Connection</th><th data-localize='details.equipment.powerLevel'>Power Level</th><th data-localize='details.operationalStatus'>Status</th></tr>";for(let ze=0;ze<P.Connections.length;ze++){let Ne=P.Connections[ze];""==Ne.Amps&&(Ne.Amps=null),""==Ne.Voltage&&(Ne.Voltage=null),""==Ne.Quantity&&(Ne.Quantity=null),""==Ne.PowerKW&&(Ne.PowerKW=null),me+="<tr><td>"+(null!=Ne.ConnectionType?Ne.ConnectionType.Title:"")+"</td><td>"+(null!=Ne.Level?"<strong>"+Ne.Level.Title+"</strong><br/>":"")+(null!=Ne.Amps?this.formatString(Ne.Amps)+"A/ ":"")+(null!=Ne.Voltage?this.formatString(Ne.Voltage)+"V/ ":"")+(null!=Ne.PowerKW?this.formatString(Ne.PowerKW)+"kW <br/>":"")+(null!=Ne.CurrentType?Ne.CurrentType.Title:"")+"<br/>"+(null!=Ne.Quantity?this.formatString(Ne.Quantity):"1")+" Present</td><td>"+(null!=Ne.StatusType?Ne.StatusType.Title:"-")+"</td></tr>"}me+="</table>"}let ve="";return ve+=this.formatTextField("<a target='_blank' href='https://openchargemap.org/site/poi/details/"+P.ID+"'>OCM-"+P.ID+"</a>","OpenChargeMap Ref",!1,!0,"details.refNumber"),null!=P.DataProvider&&(ve+=this.formatTextField(P.DataProvider.Title,"Data Provider",!1,!0,"details.dataProviderTitle"),null!=P.DataProvider.WebsiteURL&&(ve+=this.formatTextField(this.formatURL(P.DataProvider.WebsiteURL),"Website",!1,!0,"details.dataProviderWebsite")),ve+=this.formatTextField(P.AddressInfo.Latitude,"Latitude",!1,!0,null),ve+=this.formatTextField(P.AddressInfo.Longitude,"Longitude",!1,!0,null)),{address:te,drivingInfo:G,contactInfo:K,additionalInfo:ne+ce+me,advancedInfo:ve}}static debounce(P,O,f){let H;return function(){let te=this,K=arguments,G=function(){H=null,f||P.apply(te,K)},ne=f&&!H;clearTimeout(H),H=setTimeout(G,O),ne&&P.apply(te,K)}}static getRandomInt(P){return Math.floor(Math.random()*Math.floor(P))}}return Y.formatPOIAddress=function(l,P=!0){let O="";return O=P?""+this.formatTextField(l.AddressInfo.AddressLine1)+this.formatTextField(l.AddressInfo.AddressLine2)+this.formatTextField(l.AddressInfo.Town)+this.formatTextField(l.AddressInfo.StateOrProvince)+this.formatTextField(l.AddressInfo.Postcode)+(null!=l.AddressInfo.Country?this.formatTextField(l.AddressInfo.Country.Title):""):this.formatStringArray([l.AddressInfo.AddressLine1,l.AddressInfo.AddressLine2,l.AddressInfo.Town,l.AddressInfo.StateOrProvince,l.AddressInfo.Postcode,null!=l.AddressInfo.Country?l.AddressInfo.Country.Title:""]),O},Y.formatStringArray=function(l,P=", "){if(null==l)return"";let O="";for(let f=0;f<l.length;f++)null!=l[f]&&""!=l[f].trim()&&(O+=f==l.length-1?l[f]:l[f]+P);return O},Y})()},9206:(yn,je,N)=>{"use strict";N.d(je,{wC:()=>x,jR:()=>d,LL:()=>Y});class x{constructor(P=null,O=null){this.latitude=P,this.longitude=O}}class d{constructor(P=null,O=null){this.coords=new x,this.coords.latitude=P,this.coords.longitude=O}static fromPosition(P){return new d(P.coords.latitude,P.coords.longitude)}}class Y{constructor(P,O){this.northEast=P,this.southWest=O}}},6520:(yn,je,N)=>{"use strict";N.d(je,{Qp:()=>Y,fw:()=>O,JJ:()=>H,eN:()=>f,vw:()=>P,kA:()=>l});class x{constructor(K,G){this.itemType=K,this.itemId=x.getNewItemId(),this.version=1,this.schemaVersion=G,this.syncTimeStamp=x.getNewSyncTimeStamp()}static getNewSyncTimeStamp(){return Date.now().toString()}static getNewItemId(){return"_syncitem_"+Date.now().toString()}}class d{constructor(K,G){this._sync=new x(K,G)}}class Y extends d{}class l extends d{constructor(){super("waypoint",1)}}class P extends d{constructor(){super("journey_stage",1),this.WayPoints=[]}}class O extends d{constructor(){super("journey",1),this.ID=""+Date.now(),this.Stages=[]}}class f{}class H{}},1058:(yn,je,N)=>{"use strict";N.d(je,{b:()=>x});class x{constructor(){this.poiIdList=null,this.countryCode=null,this.latitude=null,this.longitude=null,this.locationTitle=null,this.distance=null,this.distanceUnit=null,this.connectionTypeIdList=null,this.operatorIdList=null,this.levelIdList=null,this.countryIdList=null,this.usageTypeIdList=null,this.statusTypeIdList=null,this.minPowerKW=null,this.maxPowerKW=null,this.submissionStatusTypeIdList=null,this.maxResults=250,this.additionalParams=null,this.includeComments=!1,this.compact=!0,this.enableCaching=!0,this.levelOfDetail=1,this.polyline=null,this.boundingbox=null}}},74:(yn,je,N)=>{"use strict";N.d(je,{n:()=>x});class x{}},8076:(yn,je,N)=>{"use strict";N.d(je,{U:()=>x,N:()=>d});const x=650;class d{constructor(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MaxPowerKW=null,this.MinPowerKW=null,this.HasActiveFilters=!1,this.FilterOptionsByCountryId=null,this.UseDistanceInKM=!0,this.MapType="ROADMAP",this.EnableAdvancedEditorFeatures=!1}LoadSettings(){}SaveSettings(){}ClearActiveFilters(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MinPowerKW=null,this.MaxPowerKW=null}CheckForActiveFilters(){return this.HasActiveFilters=this.OperatorList.length>0||this.ConnectionTypeList.length>0||this.CountryList.length>0||this.UsageTypeList.length>0||this.StatusTypeList.length>0||this.MinPowerKW>0||this.MaxPowerKW>0||null!=this.MaxPowerKW&&this.MaxPowerKW<x,this.HasActiveFilters}}},8026:(yn,je,N)=>{"use strict";N.d(je,{q:()=>x});var x=(()=>{return(d=x||(x={}))[d.POI=0]="POI",d[d.Comment=1]="Comment",d[d.Media=2]="Media",x;var d})()},7368:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{AboutPageModule:()=>K});var x=N(6019),d=N(9133),Y=N(5966),l=N(5899),P=N(9570),O=N(865);const f=[{path:"",component:P.t}];let H=(()=>{class G{}return G.\u0275fac=function(ce){return new(ce||G)},G.\u0275mod=O.oAB({type:G}),G.\u0275inj=O.cJS({imports:[[l.Bz.forChild(f)],l.Bz]}),G})();var te=N(1586);let K=(()=>{class G{}return G.\u0275fac=function(ce){return new(ce||G)},G.\u0275mod=O.oAB({type:G}),G.\u0275inj=O.cJS({imports:[[x.ez,d.u5,Y.Pc,te.aw,H]]}),G})()},9570:(yn,je,N)=>{"use strict";N.d(je,{t:()=>P});var x=N(8260),d=N(865),Y=N(5966),l=N(1586);let P=(()=>{class O{constructor(H){this.modalController=H}get appVersion(){return x.N.version}get apiUrl(){return x.N.apiBase}ngOnInit(){}close(){this.modalController.dismiss()}}return O.\u0275fac=function(H){return new(H||O)(d.Y36(Y.IN))},O.\u0275cmp=d.Xpm({type:O,selectors:[["app-about"]],decls:49,vars:5,consts:[[1,"ion-padding"],["size","2"],["src","assets/images/icons/branding/AppIcon_128x128.png",2,"padding-top","2em"],["href","https://openchargemap.org"],["href","https://community.openchargemap.org"],["href","https://github.com/openchargemap/ocm-system/issues"],["href","https://webprofusion.com"],["href","https://opencollective.com/openchargemap"],["slot","end"],[3,"click"],["name","close","slot","start"]],template:function(H,te){1&H&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(5,"ion-content",0),d.TgZ(6,"ion-grid"),d.TgZ(7,"ion-row"),d.TgZ(8,"ion-col",1),d._UZ(9,"img",2),d.qZA(),d.TgZ(10,"ion-col"),d.TgZ(11,"h1"),d._uU(12,"Open Charge Map"),d.qZA(),d.TgZ(13,"h2"),d._uU(14,"The global public registry of Electric Vehicle charging locations"),d.qZA(),d.TgZ(15,"p"),d._uU(16,"Web: "),d.TgZ(17,"a",3),d._uU(18,"https://openchargemap.org"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(19,"p"),d._uU(20,"Community Discussions: "),d.TgZ(21,"a",4),d._uU(22,"https://community.openchargemap.org"),d.qZA(),d.qZA(),d.TgZ(23,"p"),d._uU(24,"App or System Bugs and feature suggestions: "),d.TgZ(25,"a",5),d._uU(26,"GitHub"),d.qZA(),d.qZA(),d.TgZ(27,"p"),d._uU(28,"App development by Webprofusion Pty Ltd ("),d.TgZ(29,"a",6),d._uU(30,"https://webprofusion.com"),d.qZA(),d._uU(31,")"),d.qZA(),d.TgZ(32,"h3"),d._uU(33,"Funding"),d.qZA(),d.TgZ(34,"p"),d._uU(35,"Our software is developed and hosted by volunteers, our data is crowdsourced by you. To help further development please encourage your organisation to sponsor us: "),d.TgZ(36,"a",7),d._uU(37,"Open Collective"),d.qZA(),d.qZA(),d.TgZ(38,"ion-note"),d.TgZ(39,"p"),d._uU(40),d.qZA(),d.TgZ(41,"p"),d._uU(42),d.qZA(),d.qZA(),d.qZA(),d.TgZ(43,"ion-footer"),d.TgZ(44,"ion-toolbar"),d.TgZ(45,"ion-buttons",8),d.TgZ(46,"ion-button",9),d.NdJ("click",function(){return te.close()}),d._UZ(47,"ion-icon",10),d._uU(48," Close "),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&H&&(d.xp6(3),d.Oqu(d.lcZ(4,3,"ocm.general.about")),d.xp6(37),d.hij("App Version: ",te.appVersion,""),d.xp6(2),d.hij("API: ",te.apiUrl,""))},directives:[Y.Gu,Y.sr,Y.wd,Y.W2,Y.jY,Y.Nd,Y.wI,Y.uN,Y.fr,Y.Sm,Y.YG,Y.gu],pipes:[l.X$],styles:[""]}),O})()},2347:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{JourneysModule:()=>te});var x=N(209),d=N(5316),Y=N(1586),l=N(6019),P=N(9133),O=N(5966),f=N(5899),H=N(865);let te=(()=>{class K{}return K.\u0275fac=function(ne){return new(ne||K)},K.\u0275mod=H.oAB({type:K}),K.\u0275inj=H.cJS({imports:[[l.ez,P.u5,O.Pc,Y.aw,d.e,f.Bz.forChild([{path:"",component:x.g}])]]}),K})()},209:(yn,je,N)=>{"use strict";N.d(je,{g:()=>Te});var x=N(2840),d=N(4537),Y=N(8615),l=N(9206),P=N(244),O=N(865),f=N(5966),H=N(6019);function te(He,Ge){1&He&&(O.TgZ(0,"p"),O._uU(1," You have no journeys yet. Start by browsing to a charging location, then add it as Favourite to start a new Journey. "),O.qZA())}function K(He,Ge){if(1&He&&(O.TgZ(0,"p"),O._uU(1),O.qZA()),2&He){const Fe=O.oxw(2).$implicit;O.xp6(1),O.hij(" ",Fe.Poi.AddressInfo.AddressLine1,"")}}function G(He,Ge){if(1&He&&(O.TgZ(0,"p"),O._uU(1),O.qZA()),2&He){const Fe=O.oxw(2).$implicit;O.xp6(1),O.hij(" ",Fe.Poi.AddressInfo.AddressLine2,"")}}function ne(He,Ge){if(1&He&&(O.TgZ(0,"p"),O._uU(1),O.qZA()),2&He){const Fe=O.oxw(2).$implicit;O.xp6(1),O.hij(" ",Fe.Poi.AddressInfo.Town,"")}}function ce(He,Ge){if(1&He&&(O.TgZ(0,"p"),O._uU(1),O.qZA()),2&He){const Fe=O.oxw(2).$implicit;O.xp6(1),O.hij(" ",Fe.Poi.AddressInfo.StateOrProvince,"")}}function me(He,Ge){if(1&He&&(O.TgZ(0,"p"),O._uU(1),O.qZA()),2&He){const Fe=O.oxw(2).$implicit;O.xp6(1),O.hij(" ",Fe.Poi.AddressInfo.Postcode,"")}}function ve(He,Ge){if(1&He){const Fe=O.EpF();O.TgZ(0,"div"),O.TgZ(1,"div",18),O.NdJ("click",function(){O.CHM(Fe);const Qe=O.oxw().$implicit;return O.oxw(4).viewPOIDetails(Qe.Poi)}),O.YNc(2,K,2,1,"p",4),O.YNc(3,G,2,1,"p",4),O.YNc(4,ne,2,1,"p",4),O.YNc(5,ce,2,1,"p",4),O.YNc(6,me,2,1,"p",4),O.qZA(),O.TgZ(7,"ion-button",19),O.NdJ("click",function(){O.CHM(Fe);const Qe=O.oxw().$implicit;return O.oxw(4).launchNavigation(Qe.Poi)}),O._UZ(8,"ion-icon",20),O._uU(9," Navigate "),O.qZA(),O.qZA()}if(2&He){const Fe=O.oxw().$implicit;O.xp6(2),O.Q6J("ngIf",Fe.Poi.AddressInfo.AddressLine1),O.xp6(1),O.Q6J("ngIf",Fe.Poi.AddressInfo.AddressLine2),O.xp6(1),O.Q6J("ngIf",Fe.Poi.AddressInfo.Town),O.xp6(1),O.Q6J("ngIf",Fe.Poi.AddressInfo.StateOrProvince),O.xp6(1),O.Q6J("ngIf",Fe.Poi.AddressInfo.Postcode)}}function we(He,Ge){if(1&He&&(O.TgZ(0,"div",17),O.YNc(1,ve,10,5,"div",4),O.qZA()),2&He){const Fe=Ge.$implicit;O.xp6(1),O.Q6J("ngIf",Fe.Poi)}}function ze(He,Ge){if(1&He&&(O.TgZ(0,"ion-item"),O.TgZ(1,"h2"),O._uU(2),O.qZA(),O.TgZ(3,"ion-thumbnail",0),O._UZ(4,"ion-icon",15),O.qZA(),O.TgZ(5,"p"),O._uU(6),O.qZA(),O.YNc(7,we,2,1,"div",16),O.qZA()),2&He){const Fe=Ge.$implicit;O.xp6(2),O.Oqu(Fe.Title),O.xp6(4),O.Oqu(Fe.Notes),O.xp6(1),O.Q6J("ngForOf",Fe.PoiList)}}function Ne(He,Ge){if(1&He&&(O.TgZ(0,"ion-list"),O.TgZ(1,"ion-list-header",11),O._uU(2),O._UZ(3,"ion-icon",12),O._uU(4," -- "),O._UZ(5,"ion-icon",13),O._uU(6," -- "),O._UZ(7,"ion-icon",14),O._uU(8," -- "),O.qZA(),O.YNc(9,ze,8,3,"ion-item",5),O.qZA()),2&He){const Fe=Ge.$implicit;O.xp6(2),O.hij(" ",Fe.Title," "),O.xp6(7),O.Q6J("ngForOf",Fe.WayPoints)}}function Ae(He,Ge){if(1&He){const Fe=O.EpF();O.TgZ(0,"ion-card"),O.TgZ(1,"ion-card-content"),O.TgZ(2,"ion-toolbar",8),O.TgZ(3,"ion-title"),O._uU(4),O.qZA(),O.TgZ(5,"ion-buttons",9),O.TgZ(6,"ion-button",1),O.NdJ("click",function(){const et=O.CHM(Fe).$implicit;return O.oxw().deleteJourney(et.ID)}),O._UZ(7,"ion-icon",10),O.qZA(),O.qZA(),O.qZA(),O.TgZ(8,"p"),O._uU(9),O.qZA(),O.YNc(10,Ne,10,2,"ion-list",5),O.qZA(),O.qZA()}if(2&He){const Fe=Ge.$implicit;O.xp6(4),O.hij(" ",Fe.Title,""),O.xp6(5),O.Oqu(Fe.Notes),O.xp6(1),O.Q6J("ngForOf",Fe.Stages)}}let Te=(()=>{class He{constructor(Fe,E,Qe,et,ct){this.appManager=Fe,this.journeyManager=E,this.api=Qe,this.modalController=et,this.alertController=ct}dismiss(){this.modalController.dismiss()}discoverImages(){this.journeyManager.journeys.forEach(Fe=>{Fe.Stages.forEach(E=>{E.WayPoints.forEach(Qe=>{null!=Qe.PoiList&&Qe.PoiList.forEach(et=>{et.Poi&&this.api.getPanoramioLocationPhotos(new l.wC(et.Poi.AddressInfo.Latitude,et.Poi.AddressInfo.Longitude)).then(ct=>{et.Photos=ct})})})})})}getJson(Fe){return JSON.stringify(Fe,null,4)}viewPOIDetails(Fe){this.modalController.create({component:P.H,componentProps:{item:Fe}}).then(E=>E.present())}get staticMapSize(){return"60x60"}getStaticMapURL(Fe){return"https://maps.googleapis.com/maps/api/staticmap?center="+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude}deleteJourney(Fe){this.alertController.create({header:"Delete this Journey?",message:"Are you sure you want to delete this Journey?",buttons:[{text:"No",handler:()=>{}},{text:"Delete",handler:()=>{this.journeyManager.deleteJourney(Fe)}}]}).then(E=>E.present())}launchNavigation(Fe){let E="https://maps.google.com/?q="+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude;this.appManager.platform.is("ios")&&(E="https://maps.apple.com?q="+Fe.AddressInfo.Latitude+","+Fe.AddressInfo.Longitude),window.open(E,"_system")}}return He.\u0275fac=function(Fe){return new(Fe||He)(O.Y36(Y.c),O.Y36(x.i),O.Y36(d.l),O.Y36(f.IN),O.Y36(f.Br))},He.\u0275cmp=O.Xpm({type:He,selectors:[["ng-component"]],decls:18,vars:2,consts:[["slot","start"],[3,"click"],[1,"journeys-page"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","end"],["name","close","slot","start"],["primary",""],["slot","primary"],["name","close","slot","icon-only"],[2,"font-size","1.5rem"],["name","car"],["name","time"],["name","flash"],["name","caret-down",2,"font-size","4rem"],["style","text-align:right;width:100%;",4,"ngFor","ngForOf"],[2,"text-align","right","width","100%"],["tappable","",3,"click"],["clear","","item-right","",3,"click"],["name","navigate","slot","start"]],template:function(Fe,E){1&Fe&&(O.TgZ(0,"ion-header"),O.TgZ(1,"ion-toolbar"),O.TgZ(2,"ion-buttons",0),O.TgZ(3,"ion-back-button",1),O.NdJ("click",function(){return E.dismiss()}),O.qZA(),O.qZA(),O.TgZ(4,"ion-title"),O._uU(5," Journeys "),O.qZA(),O.qZA(),O.qZA(),O.TgZ(6,"ion-content",2),O.TgZ(7,"div",3),O.TgZ(8,"p"),O._uU(9," You can create and plan journeys to group your favourite charging routes together. "),O.qZA(),O.YNc(10,te,2,0,"p",4),O.qZA(),O.YNc(11,Ae,11,3,"ion-card",5),O.qZA(),O.TgZ(12,"ion-footer"),O.TgZ(13,"ion-toolbar"),O.TgZ(14,"ion-buttons",6),O.TgZ(15,"ion-button",1),O.NdJ("click",function(){return E.dismiss()}),O._UZ(16,"ion-icon",7),O._uU(17," Close "),O.qZA(),O.qZA(),O.qZA(),O.qZA()),2&Fe&&(O.xp6(10),O.Q6J("ngIf",null==E.journeyManager.journeys||0==E.journeyManager.journeys.length),O.xp6(1),O.Q6J("ngForOf",E.journeyManager.journeys))},directives:[f.Gu,f.sr,f.Sm,f.oU,f.cs,f.wd,f.W2,H.O5,H.sg,f.fr,f.YG,f.gu,f.PM,f.FN,f.q_,f.yh,f.Ie,f.Bs],encapsulation:2}),He})()},2326:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{LayerEditorPageModule:()=>K});var x=N(6019),d=N(9133),Y=N(5966),l=N(5899),P=N(2976),O=N(865);const f=[{path:"",component:P.A}];let H=(()=>{class G{}return G.\u0275fac=function(ce){return new(ce||G)},G.\u0275mod=O.oAB({type:G}),G.\u0275inj=O.cJS({imports:[[l.Bz.forChild(f)],l.Bz]}),G})();var te=N(5316);let K=(()=>{class G{}return G.\u0275fac=function(ce){return new(ce||G)},G.\u0275mod=O.oAB({type:G}),G.\u0275inj=O.cJS({imports:[[x.ez,d.u5,Y.Pc,H,te.e]]}),G})()},2976:(yn,je,N)=>{"use strict";N.d(je,{A:()=>H});var x=N(4553),d=N(2377),Y=N(865),l=N(5966),P=N(6019),O=N(3499);function f(te,K){if(1&te&&(Y.TgZ(0,"div"),Y._uU(1),Y._UZ(2,"app-poi-list",10),Y.qZA()),2&te){const G=Y.oxw();Y.xp6(1),Y.hij(" Items Parsed: ",G.fileData.length," "),Y.xp6(1),Y.Q6J("poiList",G.fileData)}}let H=(()=>{class te{constructor(G,ne){this.modalController=G,this.refData=ne}ngOnInit(){}previewFile(){var G=this;return(0,x.Z)(function*(){yield G.loadFile(!1)})()}cancel(){var G=this;return(0,x.Z)(function*(){yield G.modalController.dismiss(G.fileData)})()}loadFile(G=!0){var ne=this;return(0,x.Z)(function*(){const ce=new FileReader;ce.onload=()=>{let ve=JSON.parse(ce.result);for(let we of ve)we.ID="imp_"+we.ID;ne.fileData=ne.refData.hydrateCompactPOIList(ve),G&&ne.modalController.dismiss(ne.fileData)},ce.onerror=()=>{},ce.readAsText(document.getElementById("file-upload").files[0])})()}add(){var G=this;return(0,x.Z)(function*(){G.modalController.dismiss(G.fileData)})()}}return te.\u0275fac=function(G){return new(G||te)(Y.Y36(l.IN),Y.Y36(d.W))},te.\u0275cmp=Y.Xpm({type:te,selectors:[["app-layer-editor"]],decls:27,vars:1,consts:[[1,"ion-padding"],[1,"upload"],["name","file","aria-label","file","slot","start"],["type","file","required","","id","file-upload",3,"change"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","checkmark-circle-outline","slot","end"],[3,"poiList"]],template:function(G,ne){1&G&&(Y.TgZ(0,"ion-header"),Y.TgZ(1,"ion-toolbar"),Y.TgZ(2,"ion-title"),Y._uU(3," Edit Layer "),Y.qZA(),Y.qZA(),Y.qZA(),Y.TgZ(4,"ion-content",0),Y.TgZ(5,"p"),Y._uU(6,"POI layers are used to preview data from other Open Data sources. "),Y.qZA(),Y.TgZ(7,"p"),Y._uU(8,"Select a POI layer JSON file: "),Y.qZA(),Y.TgZ(9,"div"),Y.TgZ(10,"label",1),Y.TgZ(11,"ion-button"),Y._UZ(12,"ion-icon",2),Y.TgZ(13,"ion-label"),Y._uU(14,"Choose File.."),Y.qZA(),Y.qZA(),Y.TgZ(15,"input",3),Y.NdJ("change",function(){return ne.previewFile()}),Y.qZA(),Y.qZA(),Y.qZA(),Y.YNc(16,f,3,2,"div",4),Y.qZA(),Y.TgZ(17,"ion-footer"),Y.TgZ(18,"ion-toolbar"),Y.TgZ(19,"ion-buttons",5),Y.TgZ(20,"ion-button",6),Y.NdJ("click",function(){return ne.cancel()}),Y._UZ(21,"ion-icon",7),Y._uU(22," Cancel "),Y.qZA(),Y.qZA(),Y.TgZ(23,"ion-buttons",8),Y.TgZ(24,"ion-button",6),Y.NdJ("click",function(){return ne.add()}),Y._uU(25," Add "),Y._UZ(26,"ion-icon",9),Y.qZA(),Y.qZA(),Y.qZA(),Y.qZA()),2&G&&(Y.xp6(16),Y.Q6J("ngIf",ne.fileData&&ne.fileData.length>0))},directives:[l.Gu,l.sr,l.wd,l.W2,l.YG,l.gu,l.Q$,P.O5,l.fr,l.Sm,O.o],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),te})()},244:(yn,je,N)=>{"use strict";N.d(je,{H:()=>hi});var x=N(8615),d=N(865),Y=N(5966),l=N(4553),P=N(2840),O=N(6520),f=N(9133),H=N(6019);function te(re,ie){if(1&re&&(d.TgZ(0,"ion-select-option",13),d._uU(1),d.qZA()),2&re){const V=ie.$implicit;d.Q6J("value",V.ID),d.xp6(1),d.Oqu(V.Title)}}function K(re,ie){if(1&re&&(d.TgZ(0,"ion-select-option",16),d._uU(1),d.qZA()),2&re){const V=ie.$implicit;d.Q6J("value",ie.index),d.xp6(1),d.Oqu(V.Title)}}function G(re,ie){if(1&re){const V=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",2),d._uU(2,"Journey Stage"),d.qZA(),d.TgZ(3,"ion-select",3),d.NdJ("ngModelChange",function(De){return d.CHM(V),d.oxw().selectedStageIndex=De}),d.TgZ(4,"ion-select-option",14),d._uU(5,"Create a Journey Stage"),d.qZA(),d.YNc(6,K,2,2,"ion-select-option",15),d.qZA(),d.qZA()}if(2&re){const V=d.oxw();d.xp6(3),d.Q6J("ngModel",V.selectedStageIndex),d.xp6(3),d.Q6J("ngForOf",V.journeyManager.getJourneyStages(V.selectedJourneyID))}}function ne(re,ie){if(1&re){const V=d.EpF();d.TgZ(0,"ion-item"),d.TgZ(1,"ion-label",2),d._uU(2,"New Journey Name"),d.qZA(),d.TgZ(3,"ion-input",7),d.NdJ("ngModelChange",function(De){return d.CHM(V),d.oxw().newJourneyName=De}),d.qZA(),d.qZA()}if(2&re){const V=d.oxw();d.xp6(3),d.Q6J("ngModel",V.newJourneyName)}}let ce=(()=>{class re{constructor(V,pe,De,$e){this.appManager=V,this.navParams=pe,this.journeyManager=De,this.modalController=$e,this.poi=this.navParams.get("poi"),this.waypoint=new O.kA,this.waypoint.Title=this.poi.AddressInfo.Title,this.waypoint.PoiIDs=[this.poi.ID],this.waypoint.PoiList=[];const vt=new O.Qp("charging",1);vt.Poi=this.poi,vt.PoiID=this.poi.ID,this.waypoint.PoiList.push(vt),this.newJourneyName="Trip to "+this.poi.AddressInfo.Title}cancel(){this.modalController.dismiss()}add(){if(null!=this.selectedJourneyID&&""!==this.selectedJourneyID)this.journeyManager.addJourneyWaypoint(this.selectedJourneyID,this.selectedStageIndex,this.waypoint);else{const V=new O.fw;V.ID=Date.now().toString(),""===this.newJourneyName&&(this.newJourneyName="New Journey"),V.Title=this.newJourneyName,this.journeyManager.addJourney(V,this.waypoint)}this.journeyManager.saveJourneys(),this.modalController.dismiss()}}return re.\u0275fac=function(V){return new(V||re)(d.Y36(x.c),d.Y36(Y.X1),d.Y36(P.i),d.Y36(Y.IN))},re.\u0275cmp=d.Xpm({type:re,selectors:[["ng-component"]],decls:39,vars:8,consts:[[1,"journeys-page","ion-padding"],[1,"banner"],["position","stacked"],[3,"ngModel","ngModelChange"],["value","","checked",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","add","slot","end"],[3,"value"],["value",""],["checked","",3,"value",4,"ngFor","ngForOf"],["checked","",3,"value"]],template:function(V,pe){1&V&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3," Edit Favourite "),d.qZA(),d.qZA(),d.qZA(),d.TgZ(4,"ion-content",0),d.TgZ(5,"div",1),d.TgZ(6,"h1"),d._uU(7),d.qZA(),d.TgZ(8,"p"),d._uU(9),d.qZA(),d.qZA(),d.TgZ(10,"p"),d._uU(11," Add Charging Location as a Journey Waypoint "),d.qZA(),d.TgZ(12,"ion-item"),d.TgZ(13,"ion-label",2),d._uU(14,"Add to a Journey"),d.qZA(),d.TgZ(15,"ion-select",3),d.NdJ("ngModelChange",function($e){return pe.selectedJourneyID=$e}),d.TgZ(16,"ion-select-option",4),d._uU(17,"Create a New Journey"),d.qZA(),d.YNc(18,te,2,2,"ion-select-option",5),d.qZA(),d.qZA(),d.YNc(19,G,7,2,"ion-item",6),d.YNc(20,ne,4,1,"ion-item",6),d.TgZ(21,"ion-item"),d.TgZ(22,"ion-label",2),d._uU(23,"Name for this step of your journey"),d.qZA(),d.TgZ(24,"ion-input",7),d.NdJ("ngModelChange",function($e){return pe.waypoint.Title=$e}),d.qZA(),d.qZA(),d.TgZ(25,"ion-item"),d.TgZ(26,"ion-label",2),d._uU(27,"Other Notes"),d.qZA(),d.TgZ(28,"ion-textarea",3),d.NdJ("ngModelChange",function($e){return pe.waypoint.Notes=$e}),d.qZA(),d.qZA(),d.qZA(),d.TgZ(29,"ion-footer"),d.TgZ(30,"ion-toolbar"),d.TgZ(31,"ion-buttons",8),d.TgZ(32,"ion-button",9),d.NdJ("click",function(){return pe.cancel()}),d._UZ(33,"ion-icon",10),d._uU(34," Cancel "),d.qZA(),d.qZA(),d.TgZ(35,"ion-buttons",11),d.TgZ(36,"ion-button",9),d.NdJ("click",function(){return pe.add()}),d._uU(37," Add "),d._UZ(38,"ion-icon",12),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&V&&(d.xp6(7),d.Oqu(pe.poi.AddressInfo.Title),d.xp6(2),d.Oqu(pe.poi.AddressInfo.AddressLine1),d.xp6(6),d.Q6J("ngModel",pe.selectedJourneyID),d.xp6(3),d.Q6J("ngForOf",pe.journeyManager.journeys),d.xp6(1),d.Q6J("ngIf",pe.selectedJourneyID),d.xp6(1),d.Q6J("ngIf",!pe.selectedJourneyID),d.xp6(4),d.Q6J("ngModel",pe.waypoint.Title),d.xp6(4),d.Q6J("ngModel",pe.waypoint.Notes))},directives:[Y.Gu,Y.sr,Y.wd,Y.W2,Y.Ie,Y.Q$,Y.t9,Y.QI,f.JJ,f.On,Y.n0,H.sg,H.O5,Y.pK,Y.j9,Y.g2,Y.fr,Y.Sm,Y.YG,Y.gu],encapsulation:2}),re})();var me=N(6505);function ve(re,ie){if(1&re){const V=d.EpF();d.TgZ(0,"ion-card"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title",14),d._uU(3,"Preview"),d.qZA(),d.TgZ(4,"ion-buttons",15),d.TgZ(5,"ion-button",4),d.NdJ("click",function(){return d.CHM(V),d.oxw().rotateImage()}),d._UZ(6,"ion-icon",16),d.TgZ(7,"ion-label"),d._uU(8,"Rotate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(9,"ion-card-content"),d.TgZ(10,"ion-list"),d.TgZ(11,"ion-item"),d.TgZ(12,"ion-label",17),d._uU(13,"Comment"),d.qZA(),d.TgZ(14,"ion-input",18),d.NdJ("ngModelChange",function(De){return d.CHM(V),d.oxw().comment=De}),d.qZA(),d.qZA(),d.qZA(),d._UZ(15,"img",19),d.qZA(),d.qZA()}if(2&re){const V=d.oxw();d.xp6(14),d.Q6J("ngModel",V.comment)}}let we=(()=>{class re{constructor(V,pe,De,$e,vt){this.navParams=V,this.appManager=pe,this.nav=De,this.modalController=$e,this.logging=vt,this.processingQuality=.8,this.targetWidth=1024,this.targetHeight=800,this.mode=pe.platformMode,this.chargePointId=this.navParams.get("id"),this.poi=this.navParams.get("poi"),this.comment=""}processNativeImageSource(V){let pe=V;const De=document.getElementById("img-upload-canvas"),$e=De.getContext("2d"),vt=new Image;vt.onload=()=>{this.logging.log("img load:"+vt.width),De.width=vt.width,De.height=vt.height,$e.fillStyle="rgb(0,0,0)",$e.fillRect(0,0,De.width,De.height),$e.drawImage(vt,0,0,De.width,De.height),this.imgData=De.toDataURL("image/png"),this.processImage()},vt.src=pe}loadCameraOrLibraryImage(V=!1){this.logging.log("PWA mode: fetching image");const pe=new FileReader;pe.onload=()=>{this.imgData=pe.result,this.processImage()},pe.onerror=()=>{},pe.readAsDataURL(document.getElementById("img-upload-media").files[0])}isBrowserMode(){return this.appManager.isPlatform("desktop")||this.appManager.isPlatform("hybrid")}processImage(){if(null!=this.imgData){const pe=document.getElementById("img-upload-canvas"),De=pe.getContext("2d"),$e=new Image;$e.onload=()=>{pe.width=$e.width,pe.height=$e.height,De.fillStyle="rgb(0,0,0)",De.fillRect(0,0,pe.width,pe.height),De.drawImage($e,0,0,pe.width,pe.height),this.refreshImageFromCanvas()},$e.src=this.imgData}else this.logging.log("processImage: nothing to process.")}refreshImageFromCanvas(){const V=document.getElementById("img-upload-canvas");this.imgData=V.toDataURL("image/jpeg",.8),document.getElementById("preview").src=this.imgData}rotateImage(){const V=document.getElementById("img-upload-canvas");let pe=new Image;pe.src=V.toDataURL(),pe.onload=()=>{let De=V.height,$e=V.width;V.width=De,V.height=$e,De=V.height,$e=V.width;const vt=V.getContext("2d");vt.save(),vt.translate($e,De/$e),vt.rotate(Math.PI/2),vt.drawImage(pe,0,0),vt.restore(),pe=null,this.refreshImageFromCanvas()}}performUpload(){var V=this;return(0,l.Z)(function*(){if(!V.imgData)return void(yield V.appManager.showToastNotification("Select an image to upload."));const pe={chargePointID:V.chargePointId,comment:V.comment,imageDataBase64:V.imgData};yield V.appManager.showLoadingProgress("Uploading photo..");try{yield V.appManager.submitMediaItem(pe),V.appManager.dismissLoadingProgress().then(()=>{V.appManager.showToastNotification("Upload completed"),V.modalController.dismiss()}),V.appManager.analytics.appEvent("MediaUpload","Completed")}catch{yield V.appManager.dismissLoadingProgress(),yield V.appManager.showToastNotification("Upload failed, please try again."),V.appManager.analytics.appEvent("MediaUpload","Failed")}})()}cancel(){var V=this;return(0,l.Z)(function*(){yield V.modalController.dismiss()})()}}return re.\u0275fac=function(V){return new(V||re)(d.Y36(Y.X1),d.Y36(x.c),d.Y36(Y.SH),d.Y36(Y.IN),d.Y36(me.z))},re.\u0275cmp=d.Xpm({type:re,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"media-upload"],[1,"ion-padding"],[1,"banner"],[1,"upload"],[3,"click"],["name","camera","aria-label","camera","slot","start"],["type","file","required","","id","img-upload-media",3,"change"],["inputFile",""],["id","img-upload-canvas",2,"display","none","width","500","height","500","border","1px solid red"],[4,"ngIf"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],["slot","start"],["slot","end"],["name","refresh","slot","start"],["position","floating"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["id","preview",2,"max-width","500px"]],template:function(V,pe){if(1&V){const De=d.EpF();d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3," Share Photo "),d.qZA(),d.qZA(),d.qZA(),d.TgZ(4,"ion-content",0),d.TgZ(5,"div",1),d.TgZ(6,"div",2),d.TgZ(7,"h1"),d._uU(8),d.qZA(),d.TgZ(9,"p"),d._uU(10),d.qZA(),d.qZA(),d.TgZ(11,"p"),d._uU(12,"You can upload a photo from your device or take a new photo: "),d.qZA(),d.TgZ(13,"div",3),d.TgZ(14,"ion-button",4),d.NdJ("click",function(){return d.CHM(De),d.MAs(19).click()}),d._UZ(15,"ion-icon",5),d.TgZ(16,"ion-label"),d._uU(17,"Choose Photo.."),d.qZA(),d.qZA(),d.TgZ(18,"input",6,7),d.NdJ("change",function(){return pe.loadCameraOrLibraryImage()}),d.qZA(),d.qZA(),d._UZ(20,"canvas",8),d.YNc(21,ve,16,1,"ion-card",9),d.qZA(),d.qZA(),d.TgZ(22,"ion-footer"),d.TgZ(23,"ion-toolbar"),d.TgZ(24,"ion-buttons",10),d.TgZ(25,"ion-button",4),d.NdJ("click",function(){return pe.cancel()}),d._UZ(26,"ion-icon",11),d._uU(27," Cancel "),d.qZA(),d.qZA(),d.TgZ(28,"ion-buttons",12),d.TgZ(29,"ion-button",4),d.NdJ("click",function(){return pe.performUpload()}),d._uU(30," Upload "),d._UZ(31,"ion-icon",13),d.qZA(),d.qZA(),d.qZA(),d.qZA()}2&V&&(d.xp6(8),d.Oqu(pe.poi.AddressInfo.Title),d.xp6(2),d.Oqu(pe.poi.AddressInfo.AddressLine1),d.xp6(11),d.Q6J("ngIf",null!=pe.imgData))},directives:[Y.Gu,Y.sr,Y.wd,Y.W2,Y.YG,Y.gu,Y.Q$,H.O5,Y.fr,Y.Sm,Y.PM,Y.FN,Y.q_,Y.Ie,Y.pK,Y.j9,f.JJ,f.On],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),re})();var ze=N(5899);function Ne(re,ie){if(1&re&&(d.TgZ(0,"ion-select-option",19),d._uU(1),d.qZA()),2&re){const V=ie.$implicit;d.Q6J("value",V.ID),d.xp6(1),d.Oqu(V.Title)}}function Ae(re,ie){if(1&re&&(d.TgZ(0,"ion-select-option",19),d._uU(1),d.qZA()),2&re){const V=ie.$implicit;d.Q6J("value",V.ID),d.xp6(1),d.Oqu(V.Title)}}let Te=(()=>{class re{constructor(V,pe,De,$e,vt,Ct,lt,Dt){this.navParams=V,this.appManager=pe,this.nav=De,this.zone=$e,this.loadingController=vt,this.modalController=Ct,this.logging=lt,this.router=Dt,this.commentModel={ChargePointID:this.navParams.get("id"),Comment:"",CheckinStatusTypeID:10,CommentTypeID:10,Rating:null},this.poi=this.navParams.get("poi"),this.commentTypes=pe.referenceDataManager.getCommentTypes(!0,!0),this.checkinTypes=pe.referenceDataManager.getCheckinStatusTypes(!0,!0)}onPageWillEnter(){}cancel(){this.modalController.dismiss()}add(){var V=this;return(0,l.Z)(function*(){const pe=yield V.loadingController.create({message:"Sending .."});yield pe.present(),(yield V.appManager.submitComment(V.commentModel).catch($e=>{V.appManager.showToastNotification("There was a problem submitting your comment."),V.loadingController.dismiss(),V.appManager.analytics.appEvent("Comment","Failed")}))&&(V.logging.log("Comment submitted"),yield pe.dismiss(),yield V.modalController.dismiss(),V.appManager.analytics.appEvent("Comment","Submitted"))})()}}return re.\u0275fac=function(V){return new(V||re)(d.Y36(Y.X1),d.Y36(x.c),d.Y36(Y.SH),d.Y36(d.R0b),d.Y36(Y.HT),d.Y36(Y.IN),d.Y36(me.z),d.Y36(ze.F0))},re.\u0275cmp=d.Xpm({type:re,selectors:[["ng-component"]],decls:53,vars:8,consts:[["color","primary"],[1,"comment-page","ion-padding"],[1,"banner"],[1,"ion-padding"],["position","stacked"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["value","5"],["value","4"],["value","3"],["value","2"],["value","1"],["value",""],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],[3,"value"]],template:function(V,pe){1&V&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar",0),d.TgZ(2,"ion-title"),d._uU(3," Add Comment "),d.qZA(),d.qZA(),d.qZA(),d.TgZ(4,"ion-content",1),d.TgZ(5,"div",2),d.TgZ(6,"h1"),d._uU(7),d.qZA(),d.TgZ(8,"p"),d._uU(9),d.qZA(),d.qZA(),d.TgZ(10,"p",3),d._uU(11,"Recent Check-ins are a big help to other drivers when planning their journey. Tell everyone what you thought about this charging location. "),d.qZA(),d.TgZ(12,"ion-list"),d.TgZ(13,"ion-item"),d.TgZ(14,"ion-label",4),d._uU(15,"Comment Type"),d.qZA(),d.TgZ(16,"ion-select",5),d.NdJ("ngModelChange",function($e){return pe.commentModel.CommentTypeID=$e}),d.YNc(17,Ne,2,2,"ion-select-option",6),d.qZA(),d.qZA(),d.TgZ(18,"ion-item"),d.TgZ(19,"ion-label",4),d._uU(20,"What Did You Think?"),d.qZA(),d.TgZ(21,"ion-input",7),d.NdJ("ngModelChange",function($e){return pe.commentModel.Comment=$e}),d.qZA(),d.qZA(),d.TgZ(22,"ion-item"),d.TgZ(23,"ion-label",4),d._uU(24,"Did You Successfully Charge?"),d.qZA(),d.TgZ(25,"ion-select",5),d.NdJ("ngModelChange",function($e){return pe.commentModel.CheckinStatusTypeID=$e}),d.YNc(26,Ae,2,2,"ion-select-option",6),d.qZA(),d.qZA(),d.TgZ(27,"ion-item"),d.TgZ(28,"ion-label",4),d._uU(29,"Your Rating"),d.qZA(),d.TgZ(30,"ion-select",5),d.NdJ("ngModelChange",function($e){return pe.commentModel.Rating=$e}),d.TgZ(31,"ion-select-option",8),d._uU(32,"5 - Excellent"),d.qZA(),d.TgZ(33,"ion-select-option",9),d._uU(34,"4 - Good"),d.qZA(),d.TgZ(35,"ion-select-option",10),d._uU(36,"3 - Average"),d.qZA(),d.TgZ(37,"ion-select-option",11),d._uU(38,"2 - Not Good"),d.qZA(),d.TgZ(39,"ion-select-option",12),d._uU(40,"1 - Bad"),d.qZA(),d.TgZ(41,"ion-select-option",13),d._uU(42,"Not Rated"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(43,"ion-footer"),d.TgZ(44,"ion-toolbar"),d.TgZ(45,"ion-buttons",14),d.TgZ(46,"ion-button",15),d.NdJ("click",function(){return pe.cancel()}),d._UZ(47,"ion-icon",16),d._uU(48," Cancel "),d.qZA(),d.qZA(),d.TgZ(49,"ion-buttons",17),d.TgZ(50,"ion-button",15),d.NdJ("click",function(){return pe.add()}),d._uU(51," Submit "),d._UZ(52,"ion-icon",18),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&V&&(d.xp6(7),d.Oqu(pe.poi.AddressInfo.Title),d.xp6(2),d.Oqu(pe.poi.AddressInfo.AddressLine1),d.xp6(7),d.Q6J("ngModel",pe.commentModel.CommentTypeID),d.xp6(1),d.Q6J("ngForOf",pe.commentTypes),d.xp6(4),d.Q6J("ngModel",pe.commentModel.Comment),d.xp6(4),d.Q6J("ngModel",pe.commentModel.CheckinStatusTypeID),d.xp6(1),d.Q6J("ngForOf",pe.checkinTypes),d.xp6(4),d.Q6J("ngModel",pe.commentModel.Rating))},directives:[Y.Gu,Y.sr,Y.wd,Y.W2,Y.q_,Y.Ie,Y.Q$,Y.t9,Y.QI,f.JJ,f.On,H.sg,Y.pK,Y.j9,Y.n0,Y.fr,Y.Sm,Y.YG,Y.gu],encapsulation:2}),re})();var He=N(9567),Ge=N(6158),Fe=N(1486),E=N(3357),Qe=N(2022),et=N(1586),ct=N(1949);function gt(re,ie){if(1&re&&(d.TgZ(0,"div"),d.TgZ(1,"small"),d._uU(2),d.qZA(),d.qZA()),2&re){const V=d.oxw(2);d.xp6(2),d.Oqu(V.connectionSummary)}}function bt(re,ie){if(1&re&&(d.TgZ(0,"div"),d.TgZ(1,"small"),d._uU(2),d.qZA(),d.qZA()),2&re){const V=d.oxw(2);d.xp6(2),d.Oqu(V.poi.OperatorInfo.Title)}}function ut(re,ie){if(1&re){const V=d.EpF();d.ynx(0),d.TgZ(1,"ion-button",28),d.NdJ("click",function(){return d.CHM(V),d.oxw(2).addFavourite()}),d._UZ(2,"ion-icon",29),d.TgZ(3,"ion-label"),d._uU(4,"Favourite"),d.qZA(),d.qZA(),d.TgZ(5,"ion-button",13),d.NdJ("click",function(){return d.CHM(V),d.oxw(2).edit()}),d._UZ(6,"ion-icon",30),d.TgZ(7,"ion-label"),d._uU(8,"Edit"),d.qZA(),d.qZA(),d.BQk()}}function St(re,ie){if(1&re){const V=d.EpF();d.ynx(0),d.TgZ(1,"ion-button",31),d.NdJ("click",function(){return d.CHM(V),d.oxw(2).launchNavigation()}),d._UZ(2,"ion-icon",32),d.TgZ(3,"ion-label"),d._uU(4,"Navigate"),d.qZA(),d.qZA(),d.BQk()}}function Vt(re,ie){if(1&re){const V=d.EpF();d.ynx(0),d.TgZ(1,"ion-button",33),d.NdJ("click",function(){return d.CHM(V),d.oxw(2).addComment()}),d._UZ(2,"ion-icon",34),d.TgZ(3,"ion-label"),d._uU(4,"Add Comment"),d.qZA(),d.qZA(),d.BQk()}}function bn(re,ie){if(1&re){const V=d.EpF();d.ynx(0),d.TgZ(1,"ion-button",35),d.NdJ("click",function(){return d.CHM(V),d.oxw(2).addMedia()}),d._UZ(2,"ion-icon",36),d.TgZ(3,"ion-label"),d._uU(4," Add Photo"),d.qZA(),d.qZA(),d.BQk()}}function Nt(re,ie){if(1&re&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&re){const V=d.oxw(4);d.xp6(1),d.hij(" ",V.poi.AddressInfo.AddressLine1,"")}}function Bt(re,ie){if(1&re&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&re){const V=d.oxw(4);d.xp6(1),d.hij(" ",V.poi.AddressInfo.AddressLine2,"")}}function Mt(re,ie){if(1&re&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&re){const V=d.oxw(4);d.xp6(1),d.hij(" ",V.poi.AddressInfo.Town,"")}}function Kt(re,ie){if(1&re&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&re){const V=d.oxw(4);d.xp6(1),d.hij(" ",V.poi.AddressInfo.StateOrProvince,"")}}function Ot(re,ie){if(1&re&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&re){const V=d.oxw(4);d.xp6(1),d.hij(" ",V.poi.AddressInfo.Postcode,"")}}function Ft(re,ie){if(1&re&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&re){const V=d.oxw(4);d.xp6(1),d.hij(" ",V.poi.AddressInfo.Country.Title,"")}}function ln(re,ie){if(1&re&&(d.TgZ(0,"p"),d._uU(1),d.qZA()),2&re){const V=d.oxw(4);d.xp6(1),d.hij(" ",V.poi.AddressInfo.AccessComments," ")}}function nn(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"ion-icon",48),d.TgZ(2,"span",45),d._uU(3),d.qZA(),d.qZA()),2&re){const V=d.oxw(4);d.xp6(3),d.Oqu(V.poi.AddressInfo.ContactTelephone1)}}function tn(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"ion-icon",48),d.TgZ(2,"span",45),d._uU(3),d.qZA(),d.qZA()),2&re){const V=d.oxw(4);d.xp6(3),d.Oqu(V.poi.AddressInfo.ContactTelephone2)}}function en(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"ion-icon",49),d.TgZ(2,"span",45),d._uU(3),d.qZA(),d.qZA()),2&re){const V=d.oxw(4);d.xp6(3),d.Oqu(V.poi.AddressInfo.ContactEmail)}}function yt(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"ion-icon",50),d.TgZ(2,"span",45),d.TgZ(3,"a",51),d._uU(4),d.qZA(),d.qZA(),d.qZA()),2&re){const V=d.oxw(4);d.xp6(3),d.s9C("href",V.poi.AddressInfo.RelatedURL,d.LSH),d.xp6(1),d.Oqu(V.poi.AddressInfo.RelatedURL)}}function Xt(re,ie){if(1&re&&(d.TgZ(0,"ion-card"),d.TgZ(1,"ion-card-header"),d._UZ(2,"ion-icon",43),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"ion-card-content"),d.TgZ(6,"ion-grid"),d.TgZ(7,"ion-row"),d.TgZ(8,"ion-col"),d.TgZ(9,"ion-label",44),d._uU(10),d.ALo(11,"translate"),d.qZA(),d.TgZ(12,"div",45),d.YNc(13,Nt,2,1,"div",0),d.YNc(14,Bt,2,1,"div",0),d.YNc(15,Mt,2,1,"div",0),d.YNc(16,Kt,2,1,"div",0),d.YNc(17,Ot,2,1,"div",0),d.YNc(18,Ft,2,1,"div",0),d.qZA(),d.qZA(),d.TgZ(19,"ion-col"),d.YNc(20,ln,2,1,"p",0),d.YNc(21,nn,4,1,"p",0),d.YNc(22,tn,4,1,"p",0),d.YNc(23,en,4,1,"p",0),d.YNc(24,yt,5,2,"p",0),d.qZA(),d.qZA(),d.TgZ(25,"ion-row"),d.TgZ(26,"ion-col"),d._UZ(27,"ion-icon",46),d.TgZ(28,"ion-label",47),d._uU(29),d.ALo(30,"number"),d.ALo(31,"number"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(3),d.hij(" ",d.lcZ(4,15,"ocm.details.location.sectionTitle")," "),d.xp6(7),d.hij(" ",d.lcZ(11,17,"ocm.details.location.address"),""),d.xp6(3),d.Q6J("ngIf",V.poi.AddressInfo.AddressLine1),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.AddressLine2),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.Town),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.StateOrProvince),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.Postcode),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.Country),d.xp6(2),d.Q6J("ngIf",V.poi.AddressInfo.AccessComments),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.ContactTelephone1),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.ContactTelephone2),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.ContactEmail),d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo.RelatedURL),d.xp6(5),d.AsE(" ",d.xi3(30,19,V.poi.AddressInfo.Latitude,"1.1-13")," , ",d.xi3(31,22,V.poi.AddressInfo.Longitude,"1.1-13")," ")}}function cn(re,ie){if(1&re&&(d.TgZ(0,"p"),d.TgZ(1,"span",44),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"span",45),d._uU(5),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(2),d.hij("",d.lcZ(3,2,"ocm.details.numberOfPoints"),":"),d.xp6(3),d.Oqu(V.poi.NumberOfPoints)}}function kn(re,ie){if(1&re&&(d.TgZ(0,"p"),d.TgZ(1,"span",44),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"span",45),d._uU(5),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(2),d.hij("",d.lcZ(3,2,"ocm.details.operationalStatus"),":"),d.xp6(3),d.hij(" ",V.poi.StatusType.Title," ")}}function An(re,ie){if(1&re&&(d.TgZ(0,"p"),d.TgZ(1,"span",44),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"span",45),d._uU(5),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(2),d.hij("",d.lcZ(3,2,"ocm.details.usageType"),":"),d.xp6(3),d.Oqu(V.poi.UsageType.Title)}}function mi(re,ie){if(1&re&&(d.TgZ(0,"p"),d.TgZ(1,"span",44),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"span",45),d._uU(5),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(2),d.hij("",d.lcZ(3,2,"ocm.details.usageCost"),":"),d.xp6(3),d.hij(" ",V.poi.UsageCost,"")}}function si(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"br"),d._uU(2),d.ALo(3,"translate"),d._UZ(4,"br"),d.TgZ(5,"span",45),d._uU(6),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(2),d.hij("",d.lcZ(3,2,"ocm.details.generalComments"),": "),d.xp6(4),d.Oqu(V.poi.GeneralComments)}}function Ki(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"ion-icon",54),d._uU(2),d.qZA()),2&re){const V=d.oxw(4);d.xp6(2),d.hij(" ",V.poi.OperatorInfo.WebsiteURL," ")}}function xi(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"ion-icon",49),d._uU(2),d.qZA()),2&re){const V=d.oxw(4);d.xp6(2),d.hij(" ",V.poi.OperatorInfo.ContactEmail," ")}}function Wi(re,ie){if(1&re&&(d.TgZ(0,"p"),d._UZ(1,"ion-icon",49),d._uU(2),d.qZA()),2&re){const V=d.oxw(4);d.xp6(2),d.hij(" ",V.poi.OperatorInfo.FaultReportEmail," ")}}function Vi(re,ie){if(1&re&&(d.TgZ(0,"ion-card"),d.TgZ(1,"ion-card-header"),d._UZ(2,"ion-icon",52),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.TgZ(5,"ion-card-content"),d.TgZ(6,"div",45),d.TgZ(7,"p",53),d._uU(8),d.qZA(),d.YNc(9,Ki,3,1,"p",0),d.YNc(10,xi,3,1,"p",0),d.YNc(11,Wi,3,1,"p",0),d.qZA(),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(3),d.hij(" ",d.lcZ(4,5,"ocm.details.operator.sectionTitle")," "),d.xp6(5),d.hij(" ",V.poi.OperatorInfo.Title," "),d.xp6(1),d.Q6J("ngIf",V.poi.OperatorInfo.WebsiteURL),d.xp6(1),d.Q6J("ngIf",null!=V.poi.OperatorInfo.ContactEmail),d.xp6(1),d.Q6J("ngIf",null!=V.poi.OperatorInfo.FaultReportEmail&&V.poi.OperatorInfo.FaultReportEmail!=V.poi.OperatorInfo.ContactEmail)}}function _i(re,ie){if(1&re){const V=d.EpF();d.TgZ(0,"a",56),d.NdJ("click",function(){d.CHM(V);const De=d.oxw(4);return De.launchURL(De.poi.DataProvider.WebsiteURL)}),d._uU(1),d.qZA()}if(2&re){const V=d.oxw(4);d.xp6(1),d.Oqu(V.poi.DataProvider.WebsiteURL)}}function bi(re,ie){if(1&re&&(d.TgZ(0,"div",45),d.TgZ(1,"h3"),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.TgZ(4,"p"),d._uU(5),d.qZA(),d.YNc(6,_i,2,1,"a",55),d.TgZ(7,"p"),d._uU(8),d.qZA(),d.qZA()),2&re){const V=d.oxw(3);d.xp6(2),d.hij(" ",d.lcZ(3,4,"ocm.details.dataProvider.sectionTitle")," "),d.xp6(3),d.Oqu(null==V.poi.DataProvider?null:V.poi.DataProvider.Title),d.xp6(1),d.Q6J("ngIf",V.poi.DataProvider.WebsiteURL),d.xp6(2),d.Oqu(null==V.poi.DataProvider?null:V.poi.DataProvider.License)}}function xn(re,ie){if(1&re&&(d.TgZ(0,"div",37),d.YNc(1,Xt,32,25,"ion-card",0),d.TgZ(2,"ion-card"),d.TgZ(3,"ion-card-header"),d._UZ(4,"ion-icon",38),d._uU(5),d.ALo(6,"translate"),d.qZA(),d.TgZ(7,"ion-card-content"),d.YNc(8,cn,6,4,"p",0),d._UZ(9,"app-equipment-details",39),d.qZA(),d.qZA(),d.TgZ(10,"ion-card"),d.TgZ(11,"ion-card-header"),d._UZ(12,"ion-icon",40),d._uU(13," Usage Restrictions "),d.qZA(),d.TgZ(14,"ion-card-content"),d.YNc(15,kn,6,4,"p",0),d.YNc(16,An,6,4,"p",0),d.YNc(17,mi,6,4,"p",0),d.YNc(18,si,7,4,"p",0),d.qZA(),d.qZA(),d.YNc(19,Vi,12,7,"ion-card",0),d.TgZ(20,"ion-card"),d.TgZ(21,"ion-card-header"),d._UZ(22,"ion-icon",41),d._uU(23),d.ALo(24,"translate"),d.qZA(),d.TgZ(25,"ion-card-content"),d.YNc(26,bi,9,6,"div",42),d.qZA(),d.qZA(),d.qZA()),2&re){const V=d.oxw(2);d.xp6(1),d.Q6J("ngIf",V.poi.AddressInfo),d.xp6(4),d.hij(" ",d.lcZ(6,11,"ocm.details.equipment.sectionTitle")," "),d.xp6(3),d.Q6J("ngIf",null!=V.poi.NumberOfPoints),d.xp6(1),d.Q6J("item",V.poi),d.xp6(6),d.Q6J("ngIf",null!=V.poi.StatusType),d.xp6(1),d.Q6J("ngIf",null!=V.poi.UsageType),d.xp6(1),d.Q6J("ngIf",null!=V.poi.UsageCost),d.xp6(1),d.Q6J("ngIf",null!=V.poi.GeneralComments),d.xp6(1),d.Q6J("ngIf",V.poi.OperatorInfo),d.xp6(4),d.hij(" ",d.lcZ(24,13,"ocm.details.advancedDetails")," "),d.xp6(3),d.Q6J("ngIf",V.poi.DataProvider)}}function rn(re,ie){if(1&re&&d._UZ(0,"img",60),2&re){const V=d.oxw().$implicit;d.s9C("src",null==V.User?null:V.User.ProfileImageURL,d.LSH)}}function ot(re,ie){if(1&re&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&re){const V=d.oxw().$implicit;d.xp6(1),d.Oqu(V.User.Username)}}function ft(re,ie){if(1&re&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&re){const V=d.oxw().$implicit;d.xp6(1),d.Oqu(V.Username)}}function pn(re,ie){if(1&re&&(d.TgZ(0,"p",45),d._uU(1),d.qZA()),2&re){const V=d.oxw().$implicit;d.xp6(1),d.hij(" ",null==V.CommentType?null:V.CommentType.Title," ")}}function _e(re,ie){if(1&re&&(d.TgZ(0,"p"),d.TgZ(1,"span",44),d._uU(2,"Rating:"),d.qZA(),d.TgZ(3,"span",45),d._uU(4),d.qZA(),d.qZA()),2&re){const V=d.oxw().$implicit;d.xp6(4),d.hij("",V.Rating," out of 5")}}function Ye(re,ie){1&re&&(d.ynx(0),d._UZ(1,"ion-icon",61),d.BQk())}function j(re,ie){1&re&&(d.ynx(0),d._UZ(1,"ion-icon",62),d.BQk())}function ye(re,ie){if(1&re&&(d.TgZ(0,"p"),d.YNc(1,Ye,2,0,"ng-container",0),d.YNc(2,j,2,0,"ng-container",0),d._uU(3),d.qZA()),2&re){const V=d.oxw().$implicit;d.xp6(1),d.Q6J("ngIf",!0===V.CheckinStatusType.IsPositive),d.xp6(1),d.Q6J("ngIf",!1===V.CheckinStatusType.IsPositive),d.xp6(1),d.hij(" ",V.CheckinStatusType.Title," ")}}function We(re,ie){if(1&re&&(d.TgZ(0,"ion-card"),d.TgZ(1,"ion-item"),d.TgZ(2,"ion-avatar",19),d.YNc(3,rn,1,1,"img",59),d.qZA(),d.TgZ(4,"ion-label"),d.YNc(5,ot,2,1,"span",0),d.YNc(6,ft,2,1,"span",0),d.qZA(),d.TgZ(7,"ion-label",20),d._uU(8),d.ALo(9,"date"),d.qZA(),d.qZA(),d.TgZ(10,"ion-card-content"),d.TgZ(11,"p"),d._uU(12),d.qZA(),d.YNc(13,pn,2,1,"p",42),d.YNc(14,_e,5,1,"p",0),d.YNc(15,ye,4,3,"p",0),d.qZA(),d.qZA()),2&re){const V=ie.$implicit;d.xp6(3),d.Q6J("ngIf",V.User&&V.User.ProfileImageURL),d.xp6(2),d.Q6J("ngIf",V.User),d.xp6(1),d.Q6J("ngIf",!V.User),d.xp6(2),d.hij(" ",d.lcZ(9,8,V.DateCreated)," "),d.xp6(4),d.Oqu(V.Comment),d.xp6(1),d.Q6J("ngIf",10!=V.CommentTypeID),d.xp6(1),d.Q6J("ngIf",V.Rating),d.xp6(1),d.Q6J("ngIf",V.CheckinStatusType)}}function Tt(re,ie){if(1&re&&(d.ynx(0),d.YNc(1,We,16,10,"ion-card",58),d.BQk()),2&re){const V=d.oxw(3);d.xp6(1),d.Q6J("ngForOf",V.poi.UserComments)}}function on(re,ie){1&re&&(d.TgZ(0,"p",21),d._uU(1),d.ALo(2,"translate"),d.qZA()),2&re&&(d.xp6(1),d.hij(" ",d.lcZ(2,1,"ocm.details.commentsAndRatings.zeroComments")," "))}function qn(re,ie){if(1&re&&(d.TgZ(0,"div"),d.YNc(1,Tt,2,1,"ng-container",0),d.YNc(2,on,3,3,"p",57),d.qZA()),2&re){const V=d.oxw(2);d.xp6(1),d.Q6J("ngIf",1==V.poi._hasComments),d.xp6(1),d.Q6J("ngIf",0==V.poi._hasComments)}}function ci(re,ie){if(1&re&&d._UZ(0,"img",60),2&re){const V=d.oxw().$implicit;d.s9C("src",null==V.User?null:V.User.ProfileImageURL,d.LSH)}}function ai(re,ie){if(1&re&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&re){const V=d.oxw().$implicit;d.xp6(1),d.Oqu(V.User.Username)}}function Un(re,ie){if(1&re&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&re){const V=d.oxw().$implicit;d.xp6(1),d.Oqu(V.Username)}}function Fi(re,ie){if(1&re&&(d.TgZ(0,"ion-card"),d._UZ(1,"img",60),d.TgZ(2,"ion-item"),d.TgZ(3,"ion-avatar",19),d.YNc(4,ci,1,1,"img",59),d.qZA(),d.TgZ(5,"ion-label"),d.YNc(6,ai,2,1,"span",0),d.YNc(7,Un,2,1,"span",0),d.qZA(),d.TgZ(8,"ion-label",20),d._uU(9),d.ALo(10,"date"),d.qZA(),d.qZA(),d.TgZ(11,"ion-card-content"),d.TgZ(12,"p"),d._uU(13),d.qZA(),d.qZA(),d.qZA()),2&re){const V=ie.$implicit;d.xp6(1),d.s9C("src",V.ItemMediumURL,d.LSH),d.xp6(3),d.Q6J("ngIf",V.User&&V.User.ProfileImageURL),d.xp6(2),d.Q6J("ngIf",V.User),d.xp6(1),d.Q6J("ngIf",!V.User),d.xp6(2),d.hij(" ",d.lcZ(10,6,V.DateCreated)," "),d.xp6(4),d.Oqu(V.Comment)}}function Ti(re,ie){if(1&re&&(d.TgZ(0,"div"),d.YNc(1,Fi,14,8,"ion-card",58),d.qZA()),2&re){const V=d.oxw(3);d.xp6(1),d.Q6J("ngForOf",V.poi.MediaItems)}}function Yi(re,ie){1&re&&(d.TgZ(0,"div",21),d.TgZ(1,"p",63),d._uU(2),d.ALo(3,"translate"),d.qZA(),d.qZA()),2&re&&(d.xp6(2),d.hij(" ",d.lcZ(3,1,"ocm.details.mediaItems.addPrompt"),""))}function br(re,ie){if(1&re&&(d.TgZ(0,"div"),d.YNc(1,Ti,2,1,"div",0),d.YNc(2,Yi,4,3,"div",57),d.qZA()),2&re){const V=d.oxw(2);d.xp6(1),d.Q6J("ngIf",V.poi._hasPhotos),d.xp6(1),d.Q6J("ngIf",!V.poi._hasPhotos)}}function Ei(re,ie){if(1&re&&(d.TgZ(0,"p",64),d._uU(1),d.qZA()),2&re){const V=d.oxw(2);d.xp6(1),d.hij(" ",V.json,"")}}function wr(re,ie){if(1&re){const V=d.EpF();d.TgZ(0,"div"),d.TgZ(1,"div",1),d.TgZ(2,"div",2),d.TgZ(3,"h2"),d._uU(4),d.qZA(),d.TgZ(5,"div"),d.TgZ(6,"small"),d._uU(7),d.qZA(),d.qZA(),d.YNc(8,gt,3,1,"div",0),d.YNc(9,bt,3,1,"div",0),d.TgZ(10,"ion-badge",3),d._uU(11),d.ALo(12,"number"),d.qZA(),d.qZA(),d.TgZ(13,"ion-fab",4),d.TgZ(14,"ion-fab-button"),d._UZ(15,"ion-icon",5),d.qZA(),d.TgZ(16,"ion-fab-list",6),d.TgZ(17,"ion-fab-button",7),d.NdJ("click",function(){return d.CHM(V),d.oxw().addComment()}),d._UZ(18,"ion-icon",8),d.qZA(),d.TgZ(19,"ion-fab-button",9),d.NdJ("click",function(){return d.CHM(V),d.oxw().addMedia()}),d._UZ(20,"ion-icon",10),d.qZA(),d.TgZ(21,"ion-fab-button",11),d.NdJ("click",function(){return d.CHM(V),d.oxw().addFavourite()}),d._UZ(22,"ion-icon",12),d.qZA(),d.TgZ(23,"ion-fab-button",13),d.NdJ("click",function(){return d.CHM(V),d.oxw().edit()}),d._UZ(24,"ion-icon",14),d.qZA(),d.TgZ(25,"ion-fab-button",15),d.NdJ("click",function(){return d.CHM(V),d.oxw().refresh()}),d._UZ(26,"ion-icon",16),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(27,"ion-refresher",17),d.NdJ("ionRefresh",function(De){return d.CHM(V),d.oxw().refresh(De)}),d._UZ(28,"ion-refresher-content",18),d.qZA(),d.TgZ(29,"ion-toolbar"),d.TgZ(30,"ion-buttons",19),d.YNc(31,ut,9,0,"ng-container",0),d.qZA(),d.TgZ(32,"ion-buttons",20),d.YNc(33,St,5,0,"ng-container",0),d.YNc(34,Vt,5,0,"ng-container",0),d.YNc(35,bn,5,0,"ng-container",0),d.qZA(),d.qZA(),d.TgZ(36,"div",21),d.TgZ(37,"ion-segment",22),d.NdJ("ngModelChange",function(De){return d.CHM(V),d.oxw().selectedTab=De}),d.TgZ(38,"ion-segment-button",23),d.TgZ(39,"ion-label"),d._uU(40," Details "),d.qZA(),d.qZA(),d.TgZ(41,"ion-segment-button",24),d.TgZ(42,"ion-label"),d._uU(43),d.qZA(),d.qZA(),d.TgZ(44,"ion-segment-button",25),d.TgZ(45,"ion-label"),d._uU(46),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.YNc(47,xn,27,15,"div",26),d.YNc(48,qn,3,2,"div",0),d.YNc(49,br,3,2,"div",0),d.YNc(50,Ei,2,1,"p",27),d.qZA()}if(2&re){const V=d.oxw();d.xp6(1),d.Udp("background-image",V.backdropImage?"url("+V.backdropImage+")":""),d.xp6(3),d.hij(" ",V.poi.AddressInfo.Title," "),d.xp6(3),d.hij("OCM-",V.poi.ID,""),d.xp6(1),d.Q6J("ngIf",V.connectionSummary),d.xp6(1),d.Q6J("ngIf",V.poi.OperatorInfo),d.xp6(2),d.Oqu(d.xi3(12,18,V.avgRating,"1.1-1")),d.xp6(20),d.Q6J("ngIf","location"==V.selectedTab),d.xp6(2),d.Q6J("ngIf","location"==V.selectedTab),d.xp6(1),d.Q6J("ngIf","comments"==V.selectedTab),d.xp6(1),d.Q6J("ngIf","media"==V.selectedTab),d.xp6(2),d.Q6J("ngModel",V.selectedTab),d.xp6(6),d.hij("Comments (",V.poi.UserComments?V.poi.UserComments.length:0,")"),d.xp6(3),d.hij(" Photos (",V.poi.MediaItems?V.poi.MediaItems.length:0,")"),d.xp6(1),d.Q6J("ngIf","location"==V.selectedTab),d.xp6(1),d.Q6J("ngIf","comments"==V.selectedTab),d.xp6(1),d.Q6J("ngIf","media"==V.selectedTab),d.xp6(1),d.Q6J("ngIf",1==V.appManager.isDebugMode)}}function mr(re,ie){1&re&&(d.TgZ(0,"div"),d.TgZ(1,"h2"),d._uU(2,"POI Not Found"),d.qZA(),d.TgZ(3,"p"),d._uU(4,"The POI details could not be loaded."),d.qZA(),d.qZA())}let Ji=(()=>{class re{constructor(V,pe,De,$e,vt,Ct,lt,Dt){this.appManager=V,this.nav=pe,this.translate=De,this.logging=$e,this.modalController=vt,this.actionSheetController=Ct,this.poiManager=lt,this.router=Dt,this.hasNavBar=!1}ngOnChanges(V){if(this.logging.log("In ngOnChanges of POI Details"),null!=this.poi&&null!=this.poi.AddressInfo){if(this.selectedTab="location",null!=this.poi.MediaItems&&this.poi.MediaItems.length>0){this.poi._hasPhotos=!0;for(let pe of this.poi.MediaItems)pe.ItemMediumURL=pe.ItemThumbnailURL.replace(".thmb.",".medi.");this.backdropImage=this.poi.MediaItems[this.poi.MediaItems.length-1].ItemThumbnailURL.replace(".thmb.",".medi.")}else this.poi._hasPhotos=!1,this.backdropImage=null;if(null!=this.poi.UserComments&&this.poi.UserComments.length>0){this.poi._hasComments=!0;try{let pe=this.poi.UserComments.filter(De=>De.Rating>0);if(pe.length>0){let De=0;for(let $e of pe)De+=$e.Rating;this.avgRating=De/pe.length}else this.avgRating=null}catch{}}else this.poi._hasComments=!1;if(this.poi.Connections&&this.poi.Connections.length>0){let pe="";for(let De of this.poi.Connections)-1==pe.indexOf(De.ConnectionType.Title)&&(pe+=(""!=pe?", ":"")+De.ConnectionType.Title);this.connectionSummary=pe}}}ngOnInit(){this.logging.log("In ngInit of POI Details")}get staticMapURL(){return"https://maps.googleapis.com/maps/api/staticmap?key="+(new He.X).googleMapsAPIKey+"&center="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude}get staticMapSize(){return 0===this.appManager.clientWidth?"240x100":this.appManager.clientWidth>=800?"640x100":this.appManager.clientWidth>=400?"400x100":"240x100"}continueAddComment(){var V=this;return(0,l.Z)(function*(){const pe=yield V.modalController.create({component:Te,componentProps:{id:V.poi.ID,poi:V.poi}});setTimeout(()=>{V.refresh()},1e3),yield pe.present()})()}addComment(){var V=this;return(0,l.Z)(function*(){if(V.appManager.isUserAuthenticated(!0))yield V.continueAddComment();else{const pe=yield V.modalController.create({component:Fe.F});pe.onDidDismiss().then((0,l.Z)(function*(){V.appManager.isUserAuthenticated(!0)&&(yield V.continueAddComment())})),yield pe.present()}})()}continueAddMedia(){var V=this;return(0,l.Z)(function*(){const pe=yield V.modalController.create({component:we,componentProps:{id:V.poi.ID,poi:V.poi}});pe.onDidDismiss().then(()=>{setTimeout(()=>{V.refresh()},1e3)}),yield pe.present()})()}addMedia(){var V=this;return(0,l.Z)(function*(){if(V.appManager.isUserAuthenticated(!0))yield V.continueAddMedia();else{const pe=yield V.modalController.create({component:Fe.F});pe.onDidDismiss().then((0,l.Z)(function*(){V.appManager.isUserAuthenticated(!0)&&(yield V.continueAddMedia())})),yield pe.present()}})()}addFavourite(){var V=this;return(0,l.Z)(function*(){yield(yield V.actionSheetController.create({header:"Add Favourite",buttons:[{text:"Add to Journey",handler:()=>{V.modalController.create({component:ce,componentProps:{poi:V.poi}}).then(De=>De.present())}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}launchNavigation(){this.appManager.isPlatform("ios")?this.appManager.launchWebPage("https://maps.apple.com/?ll="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude):this.appManager.launchWebPage("https://maps.google.com/?q="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude)}launchURL(V){this.appManager.launchWebPage(V)}continueEdit(){var V=this;return(0,l.Z)(function*(){const pe=yield V.modalController.create({component:E.Y,componentProps:{id:V.poi.ID}});return pe.onDidDismiss().then(De=>{V.refresh()}),yield pe.present()})()}edit(){var V=this;return(0,l.Z)(function*(){if(Qe.c.isFeatureEnabled("EDIT_POI"))if(V.appManager.isUserAuthenticated(!0))yield V.continueEdit();else{const pe=yield V.modalController.create({component:Fe.F});pe.onDidDismiss().then((0,l.Z)(function*(){V.appManager.isUserAuthenticated(!0)&&(yield V.continueEdit())})),yield pe.present()}else V.appManager.launchOCMWebPage("/poi/edit/"+V.poi.ID)})()}refresh(V=null){this.poi&&this.poiManager.getPOIById(this.poi.ID,!0,!0).then(pe=>{pe&&(this.poi=pe,this.ngOnChanges(null)),V&&V.target.complete()})}}return re.\u0275fac=function(V){return new(V||re)(d.Y36(x.c),d.Y36(Y.SH),d.Y36(et.sK),d.Y36(me.z),d.Y36(Y.IN),d.Y36(Y.BX),d.Y36(Ge.R),d.Y36(ze.F0))},re.\u0275cmp=d.Xpm({type:re,selectors:[["poi-details"]],inputs:{poi:"poi"},features:[d.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"banner"],[1,"banner-content"],["color","primary","title","Average User Rating"],["vertical","top","horizontal","end","slot","fixed"],["name","add"],["side","bottom"],["title","Add a comment or charging check-in",3,"click"],["name","chatbubbles"],["title","Add a Photo",3,"click"],["name","camera"],["title","Add to Favourites",3,"click"],["name","star"],["title","Submit an Edit",3,"click"],["name","create"],["title","Refresh",3,"click"],["name","refresh"],["slot","fixed",3,"ionRefresh"],["pullingIcon","caret-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["slot","start"],["slot","end"],[1,"ion-padding"],[3,"ngModel","ngModelChange"],["value","location","selected",""],["value","comments"],["value","media"],["class","address-details",4,"ngIf"],["style","white-space: pre-wrap;",4,"ngIf"],["size","small","title","Add to Favourites",3,"click"],["name","star","slot","start"],["name","create","slot","start"],[3,"click"],["name","navigate","slot","start"],["size","small","title","Add a comment or charging check-in",3,"click"],["name","chatbubbles","slot","start"],["size","small","title","Add a Photo",3,"click"],["name","camera","slot","start"],[1,"address-details"],["name","battery-charging"],[3,"item"],["name","book"],["name","information-circle"],["class","details",4,"ngIf"],["name","map"],[1,"label"],[1,"details"],["name","pin"],[1,"details-minor"],["name","call"],["name","mail"],["name","globe"],["target","_system",3,"href"],["name","help-circle"],[1,"ion-padding-left"],["name","link"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["class","ion-padding",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"src",4,"ngIf"],[3,"src"],["name","checkmark-circle","color","success",2,"font-size","2em"],["name","close-circle","color","danger"],[1,"subtle"],[2,"white-space","pre-wrap"]],template:function(V,pe){1&V&&(d.YNc(0,wr,51,21,"div",0),d.YNc(1,mr,5,0,"div",0)),2&V&&(d.Q6J("ngIf",null!=pe.poi&&null!=pe.poi.AddressInfo),d.xp6(1),d.Q6J("ngIf",null==pe.poi||null==pe.poi.AddressInfo))},directives:[H.O5,Y.yp,Y.IJ,Y.W4,Y.gu,Y.zq,Y.nJ,Y.Wo,Y.sr,Y.Sm,Y.cJ,Y.QI,f.JJ,f.On,Y.GO,Y.Q$,Y.YG,Y.PM,Y.Zi,Y.FN,ct.B,Y.jY,Y.Nd,Y.wI,H.sg,Y.Ie,Y.BJ],pipes:[H.JJ,et.X$,H.uU],styles:[".banner[_ngcontent-%COMP%]{background-color:#4f712f;color:#ffffffec;padding:1em;text-shadow:#000 1px 1px 1px;min-height:180px;background-size:cover}.banner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.banner-content[_ngcontent-%COMP%]{padding-right:48px}h3[_ngcontent-%COMP%]{font-weight:bold}.label[_ngcontent-%COMP%]{color:#000;font-weight:bold;font-size:12px}.details[_ngcontent-%COMP%]{color:#707d61;margin-left:1em;font-size:12px}.details-minor[_ngcontent-%COMP%]{color:#707d61;font-size:12px}p[_ngcontent-%COMP%]{display:block;padding:4px}ion-card-header[_ngcontent-%COMP%]{font-weight:bold;padding-bottom:0}ion-card-content[_ngcontent-%COMP%]{padding-top:4px}"]}),re})(),hi=(()=>{class re{constructor(V,pe,De){this.modalController=V,this.navParams=pe,this.appManager=De,this.hasNavbar=!1,this.poi=this.navParams.get("item"),this.appManager.analytics.viewEvent("POIDetails")}close(){this.modalController.dismiss()}}return re.\u0275fac=function(V){return new(V||re)(d.Y36(Y.IN),d.Y36(Y.X1),d.Y36(x.c))},re.\u0275cmp=d.Xpm({type:re,selectors:[["ng-component"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],[1,"poi-details"],[3,"poi"]],template:function(V,pe){1&V&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar",0),d.TgZ(2,"ion-title"),d._uU(3),d.TgZ(4,"small"),d._uU(5),d.qZA(),d.qZA(),d.TgZ(6,"ion-buttons",1),d.TgZ(7,"ion-button",2),d.NdJ("click",function(){return pe.close()}),d._UZ(8,"ion-icon",3),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.TgZ(9,"ion-content",4),d._UZ(10,"poi-details",5),d.qZA()),2&V&&(d.xp6(3),d.hij(" ",pe.poi.AddressInfo.Title," "),d.xp6(2),d.hij("OCM-",pe.poi.ID,""),d.xp6(5),d.Q6J("poi",pe.poi))},directives:[Y.Gu,Y.sr,Y.wd,Y.Sm,Y.YG,Y.gu,Y.W2,Ji],styles:['.left-col[_ngcontent-%COMP%]{float:left;width:50%;overflow:auto}.right-col[_ngcontent-%COMP%]{float:right;width:50%;overflow:auto}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both;overflow:auto}.row[_ngcontent-%COMP%]{margin-bottom:1em}.subtle[_ngcontent-%COMP%]{color:silver}@media screen and (max-width: 768px){.left-col[_ngcontent-%COMP%]{float:none;width:100%}.right-col[_ngcontent-%COMP%]{margin-top:1em;float:none;width:100%}}.address-details[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;width:auto}ion-label[_ngcontent-%COMP%]{overflow:inherit}ion-title[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{color:#ffffffbf}']}),re})()},2951:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{PoiEditorPageModule:()=>K});var x=N(6019),d=N(9133),Y=N(5899),l=N(5966),P=N(3357),O=N(1586),f=N(5316),H=N(865);const te=[{path:"",component:P.Y}];let K=(()=>{class G{}return G.\u0275fac=function(ce){return new(ce||G)},G.\u0275mod=H.oAB({type:G}),G.\u0275inj=H.cJS({imports:[[x.ez,d.u5,l.Pc,O.aw,f.e,Y.Bz.forChild(te)]]}),G})()},3357:(yn,je,N)=>{"use strict";N.d(je,{Y:()=>pn});var x=N(4553),d=N(8615),Y=N(1058),l=N(2022),P=N(6158),O=N(8616),f=N(865),H=N(9206),te=N(249),K=N(873),G=N(6505),ne=N(9101),ce=N(4522),me=N(6019),ve=N(5966);function we(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"ion-note"),f.TgZ(2,"p"),f._uU(3," The closest address to this position is: "),f.qZA(),f.TgZ(4,"p"),f.TgZ(5,"strong"),f._uU(6),f.qZA(),f._UZ(7,"br"),f._uU(8),f._UZ(9,"br"),f.TgZ(10,"ion-button",3),f.NdJ("click",function(){return f.CHM(j),f.oxw().useAddressSelection()}),f._uU(11,"Use this address below "),f._UZ(12,"ion-icon",4),f.qZA(),f.qZA(),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw();f.xp6(6),f.Oqu(j.suggestedAddress.AddressLine1),f.xp6(2),f.HOy(" ",j.suggestedAddress.AddressLine2," ",j.suggestedAddress.Town," ",j.suggestedAddress.StateOrProvince," ",j.suggestedAddress.Postcode," ")}}let ze=(()=>{class _e{constructor(j,ye,We,Tt,on){this.mapping=j,this.events=ye,this.logging=We,this.http=Tt,this.appManager=on,this.latitudeChange=new f.vpe,this.longitudeChange=new f.vpe,this.suggestedAddress=null,this.suggestedAddressChange=new f.vpe,this.onUseSuggestedAddress=new f.vpe,this.suggestedAddressAttribution=null,this.suggestedAddressAttributionChange=new f.vpe,this.isMapInitialised=!1}ngOnInit(){this.mapService=new K.k(this.events,this.logging,this.http),this.mapService.initAPI(),this.mapOptions=new te._,this.mapOptions.mapType=this.appManager.searchSettings.MapType,this.mapOptions.onMapMoveCompleted=()=>{let j;j=this.mapService.getMapCenter(),j.subscribe(ye=>{ye&&(this.latitude=ye.coords.latitude,this.longitude=ye.coords.longitude,this.latitudeChange.emit(this.latitude),this.longitudeChange.emit(this.longitude),this.getAddressForCurrentLatLng())})}}ngAfterContentInit(){this.focusMap()}focusMap(){0==this.isMapInitialised&&this.mapService&&0!=this.latitude&&0!=this.longitude&&(this.isMapInitialised=!0,this.mapService.initMap("editor-map",this.mapOptions,null),this.mapService.setMapCenter(new H.jR(this.latitude,this.longitude)),this.originalMarkerPos=new H.wC(this.latitude,this.longitude))}ngOnChanges(j){this.focusMap()}getAddressForCurrentLatLng(){var j=this;return(0,x.Z)(function*(){j.latitude&&j.longitude&&j.appManager.api.fetchReverseGeocodeResult(j.latitude,j.longitude).then(ye=>{ye.AddressInfo&&(j.suggestedAddress=ye.AddressInfo)})})()}useAddressSelection(){this.onUseSuggestedAddress.emit({suggestedAddress:this.suggestedAddress,attribution:this.suggestedAddressAttribution}),this.suggestedAddress=null,this.suggestedAddressAttribution=null}}return _e.\u0275fac=function(j){return new(j||_e)(f.Y36(O.v),f.Y36(ne.z),f.Y36(G.z),f.Y36(ce.eN),f.Y36(d.c))},_e.\u0275cmp=f.Xpm({type:_e,selectors:[["app-poi-location-editor"]],inputs:{latitude:"latitude",longitude:"longitude"},outputs:{latitudeChange:"latitudeChange",longitudeChange:"longitudeChange",suggestedAddressChange:"suggestedAddressChange",onUseSuggestedAddress:"onUseSuggestedAddress",suggestedAddressAttributionChange:"suggestedAddressAttributionChange"},features:[f.TTD],decls:4,vars:1,consts:[[1,"instruction"],["id","editor-map"],[4,"ngIf"],["size","small",3,"click"],["slot","end","name","copy"]],template:function(j,ye){1&j&&(f.TgZ(0,"p",0),f._uU(1,"Drag the map to center the marker on the charging location:"),f.qZA(),f._UZ(2,"div",1),f.YNc(3,we,13,5,"ng-container",2)),2&j&&(f.xp6(3),f.Q6J("ngIf",ye.suggestedAddress))},directives:[me.O5,ve.uN,ve.YG,ve.gu],styles:["#editor-map[_ngcontent-%COMP%]{border:1px solid gainsboro;background-color:gray;width:100%;height:128px}"]}),_e})();var Ne=N(2377),Ae=N(9133);function Te(_e,Ye){if(1&_e&&(f.TgZ(0,"ion-select-option",14),f._uU(1),f.qZA()),2&_e){const j=Ye.$implicit;f.Q6J("value",j.ID),f.xp6(1),f.Oqu(j.Title)}}function He(_e,Ye){if(1&_e&&(f.TgZ(0,"ion-select-option",14),f._uU(1),f.qZA()),2&_e){const j=Ye.$implicit;f.Q6J("value",j.ID),f.xp6(1),f.Oqu(j.Title)}}function Ge(_e,Ye){if(1&_e&&(f.TgZ(0,"ion-select-option",14),f._uU(1),f.qZA()),2&_e){const j=Ye.$implicit;f.Q6J("value",j.ID),f.xp6(1),f.Oqu(j.Title)}}let Fe=(()=>{class _e{constructor(j,ye){this.modalController=j,this.referenceDataManager=ye,this.useFilteredConnectionTypes=!0,this.useFilteredOperators=!0}get isAddMode(){return!(null!=this.conn&&this.conn.ID>0)}get connectionTypes(){return this.referenceDataManager.getConnectionTypes(this.useFilteredConnectionTypes)}get currentTypes(){return this.referenceDataManager.getOutputCurrentTypes()}get statusTypes(){return this.referenceDataManager.getStatusTypes().filter(j=>1==j.IsUserSelectable)}ngOnInit(){}save(){this.modalController.dismiss({item:this.conn})}cancel(){this.modalController.dismiss()}}return _e.\u0275fac=function(j){return new(j||_e)(f.Y36(ve.IN),f.Y36(Ne.W))},_e.\u0275cmp=f.Xpm({type:_e,selectors:[["app-poi-equipment-editor"]],decls:60,vars:13,consts:[[1,"ion-padding"],["position","floating"],[3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange"],["type","text","placeholder","(optional) other comments",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["slot","start"],[3,"click"],["name","close","slot","start"],["slot","end"],["color","success",3,"click"],["name","send","slot","end"],[3,"value"]],template:function(j,ye){1&j&&(f.TgZ(0,"ion-header"),f.TgZ(1,"ion-toolbar"),f.TgZ(2,"ion-title"),f._uU(3),f.qZA(),f.qZA(),f.qZA(),f.TgZ(4,"ion-content",0),f.TgZ(5,"p"),f._uU(6,"Please provide as much information as you can about the equipment. If you don't know then leave the field blank. At a minimum you should include the Connection Type and approximate Power kW (max)."),f.qZA(),f.TgZ(7,"ion-item"),f.TgZ(8,"ion-label",1),f._uU(9,"Connection Type"),f.qZA(),f.TgZ(10,"ion-select",2),f.NdJ("ngModelChange",function(Tt){return ye.conn.ConnectionTypeID=Tt}),f.TgZ(11,"ion-select-option",3),f._uU(12,"Unknown"),f.qZA(),f.YNc(13,Te,2,2,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(14,"ion-item"),f.TgZ(15,"ion-label",1),f._uU(16,"Supply Type"),f.qZA(),f.TgZ(17,"ion-select",2),f.NdJ("ngModelChange",function(Tt){return ye.conn.CurrentTypeID=Tt}),f.TgZ(18,"ion-select-option",3),f._uU(19,"Unknown"),f.qZA(),f.YNc(20,He,2,2,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(21,"ion-item"),f.TgZ(22,"ion-label",1),f._uU(23,"Power (kW)"),f.qZA(),f.TgZ(24,"ion-input",5),f.NdJ("ngModelChange",function(Tt){return ye.conn.PowerKW=Tt}),f.qZA(),f.qZA(),f.TgZ(25,"ion-item"),f.TgZ(26,"ion-label",1),f._uU(27,"Amps"),f.qZA(),f.TgZ(28,"ion-input",5),f.NdJ("ngModelChange",function(Tt){return ye.conn.Amps=Tt}),f.qZA(),f.qZA(),f.TgZ(29,"ion-item"),f.TgZ(30,"ion-label",1),f._uU(31,"Voltage"),f.qZA(),f.TgZ(32,"ion-input",5),f.NdJ("ngModelChange",function(Tt){return ye.conn.Voltage=Tt}),f.qZA(),f.qZA(),f.TgZ(33,"ion-item"),f.TgZ(34,"ion-label",1),f._uU(35,"Status"),f.qZA(),f.TgZ(36,"ion-select",2),f.NdJ("ngModelChange",function(Tt){return ye.conn.StatusTypeID=Tt}),f.YNc(37,Ge,2,2,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(38,"ion-item"),f.TgZ(39,"ion-label",1),f._uU(40,"Quantity Available"),f.qZA(),f.TgZ(41,"ion-input",5),f.NdJ("ngModelChange",function(Tt){return ye.conn.Quantity=Tt}),f.qZA(),f.qZA(),f.TgZ(42,"ion-item"),f.TgZ(43,"ion-label",1),f._uU(44,"Comment"),f.qZA(),f.TgZ(45,"ion-input",6),f.NdJ("ngModelChange",function(Tt){return ye.conn.Comments=Tt}),f.qZA(),f.qZA(),f.TgZ(46,"ion-item"),f.TgZ(47,"ion-label",1),f._uU(48,"Operators Reference"),f.qZA(),f.TgZ(49,"ion-input",7),f.NdJ("ngModelChange",function(Tt){return ye.conn.Reference=Tt}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(50,"ion-footer"),f.TgZ(51,"ion-toolbar"),f.TgZ(52,"ion-buttons",8),f.TgZ(53,"ion-button",9),f.NdJ("click",function(){return ye.cancel()}),f._UZ(54,"ion-icon",10),f._uU(55," Cancel "),f.qZA(),f.qZA(),f.TgZ(56,"ion-buttons",11),f.TgZ(57,"ion-button",12),f.NdJ("click",function(){return ye.save()}),f._uU(58," OK "),f._UZ(59,"ion-icon",13),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&j&&(f.xp6(3),f.Oqu(ye.isAddMode?"Add Equipment":"Edit Equipment"),f.xp6(7),f.Q6J("ngModel",ye.conn.ConnectionTypeID),f.xp6(3),f.Q6J("ngForOf",ye.connectionTypes),f.xp6(4),f.Q6J("ngModel",ye.conn.CurrentTypeID),f.xp6(3),f.Q6J("ngForOf",ye.currentTypes),f.xp6(4),f.Q6J("ngModel",ye.conn.PowerKW),f.xp6(4),f.Q6J("ngModel",ye.conn.Amps),f.xp6(4),f.Q6J("ngModel",ye.conn.Voltage),f.xp6(4),f.Q6J("ngModel",ye.conn.StatusTypeID),f.xp6(1),f.Q6J("ngForOf",ye.statusTypes),f.xp6(4),f.Q6J("ngModel",ye.conn.Quantity),f.xp6(4),f.Q6J("ngModel",ye.conn.Comments),f.xp6(4),f.Q6J("ngModel",ye.conn.Reference))},directives:[ve.Gu,ve.sr,ve.wd,ve.W2,ve.Ie,ve.Q$,ve.t9,ve.QI,Ae.JJ,Ae.On,ve.n0,me.sg,ve.pK,ve.as,ve.j9,ve.fr,ve.Sm,ve.YG,ve.gu],styles:[""]}),_e})();var E=(()=>{return(_e=E||(E={}))[_e.Unknown=0]="Unknown",_e[_e.CurrentlyAvailable=10]="CurrentlyAvailable",_e[_e.CurrentlyInUse=20]="CurrentlyInUse",_e[_e.TemporarilyUnavailable=30]="TemporarilyUnavailable",_e[_e.Operational=50]="Operational",_e[_e.PartlyOperational=75]="PartlyOperational",_e[_e.NotOperational=100]="NotOperational",_e[_e.PlannedForFutureDate=150]="PlannedForFutureDate",_e[_e.RemovedDecomissioned=200]="RemovedDecomissioned",E;var _e})(),Qe=(()=>{return(_e=Qe||(Qe={}))[_e.UnknownOperator=1]="UnknownOperator",_e[_e.SiteOwner=45]="SiteOwner",Qe;var _e})(),gt=N(3499);function bt(_e,Ye){if(1&_e&&(f.TgZ(0,"ion-select-option",5),f._uU(1),f.qZA()),2&_e){const j=Ye.$implicit;f.Q6J("value",j.ID),f.xp6(1),f.Oqu(j.Title)}}function ut(_e,Ye){1&_e&&(f.TgZ(0,"ion-select-option",6),f._uU(1,"Other..."),f.qZA())}function St(_e,Ye){if(1&_e){const j=f.EpF();f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label",1),f._uU(2,"Network Operator"),f.qZA(),f.TgZ(3,"ion-select",2),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().operatorId=We})("ionChange",function(){return f.CHM(j),f.oxw().onOperatorChange()}),f.YNc(4,bt,2,2,"ion-select-option",3),f.YNc(5,ut,2,0,"ion-select-option",4),f.qZA(),f.qZA()}if(2&_e){const j=f.oxw();f.xp6(3),f.Q6J("ngModel",j.operatorId),f.xp6(1),f.Q6J("ngForOf",j.operators),f.xp6(1),f.Q6J("ngIf",j.useFilteredOperators)}}function Vt(_e,Ye){if(1&_e){const j=f.EpF();f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label"),f._uU(2,"Network Operator"),f.qZA(),f.TgZ(3,"ion-searchbar",7),f.NdJ("ionCancel",function(){return f.CHM(j),f.oxw().cancelOperatorLookup()})("ngModelChange",function(We){return f.CHM(j),f.oxw().operatorSearchKeyword=We})("ionChange",function(We){return f.CHM(j),f.oxw().searchOperators(We)}),f.qZA(),f.qZA()}if(2&_e){const j=f.oxw();f.xp6(3),f.Q6J("ngModel",j.operatorSearchKeyword)}}function bn(_e,Ye){if(1&_e){const j=f.EpF();f.TgZ(0,"ion-item",9),f.NdJ("click",function(){const Tt=f.CHM(j).$implicit;return f.oxw(2).onOperatorChange(Tt)}),f.TgZ(1,"ion-avatar",10),f._UZ(2,"ion-icon",11),f.qZA(),f.TgZ(3,"ion-label"),f.TgZ(4,"p"),f._uU(5),f.qZA(),f.TgZ(6,"p"),f._uU(7),f.qZA(),f.qZA(),f.qZA()}if(2&_e){const j=Ye.$implicit;f.xp6(5),f.Oqu(j.Title),f.xp6(2),f.Oqu(j.WebsiteURL)}}function Nt(_e,Ye){if(1&_e&&(f.ynx(0),f.TgZ(1,"ion-list"),f.YNc(2,bn,8,2,"ion-item",8),f.qZA(),f.BQk()),2&_e){const j=f.oxw();f.xp6(2),f.Q6J("ngForOf",j.operatorSearchResults)}}function Bt(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"ion-item"),f.TgZ(2,"ion-avatar",10),f._UZ(3,"ion-icon",12),f.qZA(),f.TgZ(4,"ion-label"),f.TgZ(5,"p"),f._uU(6),f.qZA(),f.TgZ(7,"p"),f._uU(8),f.qZA(),f.TgZ(9,"ion-button",9),f.NdJ("click",function(){return f.CHM(j),f.oxw().selectedOperator=null}),f._uU(10,"Change"),f.qZA(),f.qZA(),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw();f.xp6(6),f.Oqu(j.selectedOperator.Title),f.xp6(2),f.Oqu(j.selectedOperator.WebsiteURL)}}let Mt=(()=>{class _e{constructor(j){this.referenceDataManager=j,this.operatorId=null,this.useFilteredOperators=null,this.operatorChanged=new f.vpe,this.operatorCache=[],this.operatorSearchResults=[],this.operatorSearchKeyword="",this.selectedOperator=null}get operators(){return this.referenceDataManager.getNetworkOperators(this.useFilteredOperators)}ngOnInit(){this.operatorCache=this.referenceDataManager.getNetworkOperators(!1),null!=this.operatorId&&(this.selectedOperator=this.operatorCache.find(j=>j.ID==this.operatorId))}searchOperators(){this.operatorSearchResults=[],0!=this.operatorSearchKeyword.length&&(this.operatorSearchResults=this.operatorCache?this.operatorCache.filter(j=>j.Title.toLowerCase().startsWith(this.operatorSearchKeyword.toLowerCase())||j.Title.toLowerCase().startsWith("("+this.operatorSearchKeyword.toLowerCase())).slice(0,10):[])}onOperatorChange(j=null){var ye=this;return(0,x.Z)(function*(){null==j&&ye.operatorId&&(j=ye.operatorCache.find(We=>We.ID==ye.operatorId)),null!=j&&(ye.operatorSearchResults=[],ye.selectedOperator=j,ye.operatorId=j.ID),ye.operatorId?ye.operatorChanged.emit(ye.selectedOperator):ye.useFilteredOperators=!1})()}cancelOperatorLookup(){this.selectedOperator=null}}return _e.\u0275fac=function(j){return new(j||_e)(f.Y36(Ne.W))},_e.\u0275cmp=f.Xpm({type:_e,selectors:[["app-operator-lookup"]],inputs:{operatorId:"operatorId",useFilteredOperators:"useFilteredOperators"},outputs:{operatorChanged:"operatorChanged"},decls:4,vars:4,consts:[[4,"ngIf"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value"],["value",""],["placeholder","Search by network name (in any country)","showCancelButton","focus","autocomplete","on",3,"ngModel","ionCancel","ngModelChange","ionChange"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["item-left",""],["name","card"],["name","locate"]],template:function(j,ye){1&j&&(f.YNc(0,St,6,3,"ion-item",0),f.YNc(1,Vt,4,1,"ion-item",0),f.YNc(2,Nt,3,1,"ng-container",0),f.YNc(3,Bt,11,2,"ng-container",0)),2&j&&(f.Q6J("ngIf",ye.useFilteredOperators&&!ye.selectedOperator),f.xp6(1),f.Q6J("ngIf",!ye.useFilteredOperators&&!ye.selectedOperator),f.xp6(1),f.Q6J("ngIf",ye.operatorSearchResults.length>0),f.xp6(1),f.Q6J("ngIf",null!=ye.selectedOperator))},directives:[me.O5,ve.Ie,ve.Q$,ve.t9,ve.QI,Ae.JJ,Ae.On,me.sg,ve.n0,ve.VI,ve.j9,ve.q_,ve.BJ,ve.gu,ve.YG],styles:[""]}),_e})();var Kt=N(1949);function Ot(_e,Ye){1&_e&&f._UZ(0,"ion-icon",13)}function Ft(_e,Ye){1&_e&&f._UZ(0,"ion-icon",13)}function ln(_e,Ye){1&_e&&f._UZ(0,"ion-icon",13)}function nn(_e,Ye){if(1&_e&&(f.TgZ(0,"ion-select-option",27),f._uU(1),f.qZA()),2&_e){const j=Ye.$implicit;f.Q6J("value",j.ID),f.xp6(1),f.Oqu(j.Title)}}function tn(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"app-poi-location-editor",14,15),f.NdJ("latitudeChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.Latitude=We})("longitudeChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.Longitude=We})("onUseSuggestedAddress",function(We){return f.CHM(j),f.oxw(2).useSuggestedAddress(We)}),f.qZA(),f.TgZ(3,"ion-list"),f.TgZ(4,"ion-item"),f.TgZ(5,"ion-label",16),f._uU(6,"Location Name"),f.qZA(),f.TgZ(7,"ion-input",17),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.Title=We}),f.qZA(),f.qZA(),f.TgZ(8,"ion-item"),f.TgZ(9,"ion-label",16),f._uU(10,"Address Line 1"),f.qZA(),f.TgZ(11,"ion-input",18),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.AddressLine1=We}),f.qZA(),f.qZA(),f.TgZ(12,"ion-item"),f.TgZ(13,"ion-label",16),f._uU(14,"Address Line 2"),f.qZA(),f.TgZ(15,"ion-input",19),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.AddressLine2=We}),f.qZA(),f.qZA(),f.TgZ(16,"ion-item"),f.TgZ(17,"ion-label",16),f._uU(18,"Town"),f.qZA(),f.TgZ(19,"ion-input",20),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.Town=We}),f.qZA(),f.qZA(),f.TgZ(20,"ion-item"),f.TgZ(21,"ion-label",16),f._uU(22,"State or Province"),f.qZA(),f.TgZ(23,"ion-input",21),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.StateOrProvince=We}),f.qZA(),f.qZA(),f.TgZ(24,"ion-item"),f.TgZ(25,"ion-label",16),f._uU(26,"Postal Code"),f.qZA(),f.TgZ(27,"ion-input",22),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.Postcode=We}),f.qZA(),f.qZA(),f.TgZ(28,"ion-item"),f.TgZ(29,"ion-label",16),f._uU(30,"Country"),f.qZA(),f.TgZ(31,"ion-select",23),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.CountryID=We})("ionChange",function(){return f.CHM(j),f.oxw(2).onCountryChange()}),f.YNc(32,nn,2,2,"ion-select-option",24),f.qZA(),f.qZA(),f.TgZ(33,"ion-item"),f.TgZ(34,"ion-label",16),f._uU(35,"Latitude"),f.qZA(),f.TgZ(36,"ion-input",25),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.Latitude=We}),f.qZA(),f.qZA(),f.TgZ(37,"ion-item"),f.TgZ(38,"ion-label",16),f._uU(39,"Longitude"),f.qZA(),f.TgZ(40,"ion-input",26),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.AddressInfo.Longitude=We}),f.qZA(),f.qZA(),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw(2);f.xp6(1),f.Q6J("latitude",j.item.AddressInfo.Latitude)("longitude",j.item.AddressInfo.Longitude),f.xp6(6),f.Q6J("ngModel",j.item.AddressInfo.Title),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.AddressLine1),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.AddressLine2),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.Town),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.StateOrProvince),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.Postcode),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.CountryID),f.xp6(1),f.Q6J("ngForOf",j.countries),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.Latitude),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.Longitude)}}function en(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"h3"),f._uU(2,"Locations Nearby"),f.qZA(),f.TgZ(3,"p"),f.TgZ(4,"strong"),f._uU(5,"The following locations already exist nearby."),f.qZA(),f.qZA(),f.TgZ(6,"div",28),f.TgZ(7,"p"),f._uU(8,"Ensure you are not adding a duplicate site unless it is for different equipment from another network operator."),f.qZA(),f.TgZ(9,"p"),f._uU(10,"You can edit any of these listings if required instead:"),f.qZA(),f.qZA(),f.TgZ(11,"app-poi-list",29),f.NdJ("onEdit",function(We){return f.CHM(j),f.oxw(2).editPOI(We)}),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw(2);f.xp6(11),f.Q6J("poiList",j.nearbySites)("enableEditOption",!0)}}function yt(_e,Ye){if(1&_e&&(f.ynx(0),f.YNc(1,tn,41,12,"ng-container",9),f.YNc(2,en,12,2,"ng-container",9),f.BQk()),2&_e){const j=f.oxw();f.xp6(1),f.Q6J("ngIf","location"==j.step),f.xp6(1),f.Q6J("ngIf","poi-nearby"==j.step)}}function Xt(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"p"),f._uU(2,"Copied the equipment configuration from:"),f.qZA(),f.TgZ(3,"ion-item"),f.TgZ(4,"ion-label"),f._uU(5),f._UZ(6,"br"),f._uU(7),f._UZ(8,"br"),f._uU(9),f._UZ(10,"br"),f._uU(11),f._UZ(12,"br"),f._uU(13),f.qZA(),f.TgZ(14,"ion-button",31),f.NdJ("click",function(){return f.CHM(j),f.oxw(5).changeTemplatePOI()}),f._uU(15,"Change.."),f.qZA(),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw(5);f.xp6(5),f.hij(" ",j.selectedTemplatePOI.AddressInfo.Title," "),f.xp6(2),f.hij(" ",j.selectedTemplatePOI.AddressInfo.AddressLine1," "),f.xp6(2),f.hij(" ",null==j.selectedTemplatePOI.Connections[0].ConnectionType?null:j.selectedTemplatePOI.Connections[0].ConnectionType.Title," "),f.xp6(2),f.hij(" ",j.selectedTemplatePOI.Connections[0].PowerKW," "),f.xp6(2),f.hij(" ",j.selectedTemplatePOI.DateCreated," ")}}function cn(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"h4"),f._uU(2,"Similar Sites"),f.qZA(),f.TgZ(3,"app-poi-list",32),f.NdJ("onCopy",function(We){return f.CHM(j),f.oxw(6).useTemplatePOI(We)}),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw(6);f.xp6(3),f.Q6J("enableCopyOption",!0)("poiList",j.templateSites)}}function kn(_e,Ye){1&_e&&(f.ynx(0),f.TgZ(1,"p"),f._uU(2," There are no suggested sites to copy for this network operator. "),f.qZA(),f.BQk())}function An(_e,Ye){if(1&_e&&(f.ynx(0),f.YNc(1,cn,4,2,"ng-container",9),f.YNc(2,kn,3,0,"ng-container",9),f.BQk()),2&_e){const j=f.oxw(5);f.xp6(1),f.Q6J("ngIf",j.templateSites.length>0),f.xp6(1),f.Q6J("ngIf",0==j.templateSites.length)}}function mi(_e,Ye){if(1&_e&&(f.ynx(0),f.YNc(1,Xt,16,5,"ng-container",9),f.YNc(2,An,3,2,"ng-container",9),f.BQk()),2&_e){const j=f.oxw(4);f.xp6(1),f.Q6J("ngIf",j.selectedTemplatePOI),f.xp6(1),f.Q6J("ngIf",!j.selectedTemplatePOI)}}function si(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"p",28),f._uU(2,"You can copy the equipment settings from other sites operated by the same network operator or choose 'Next' to skip this step: "),f.qZA(),f.TgZ(3,"app-operator-lookup",30),f.NdJ("operatorChanged",function(We){return f.CHM(j),f.oxw(3).onOperatorChange(We)}),f.qZA(),f.YNc(4,mi,3,2,"ng-container",9),f.BQk()}if(2&_e){const j=f.oxw(3);f.xp6(3),f.Q6J("operatorId",j.item.OperatorID),f.xp6(1),f.Q6J("ngIf",j.item.AddressInfo.CountryID&&j.item.OperatorID)}}function Ki(_e,Ye){if(1&_e&&(f.ynx(0),f.YNc(1,si,5,2,"ng-container",9),f.BQk()),2&_e){const j=f.oxw(2);f.xp6(1),f.Q6J("ngIf",!j.skipPOICopy)}}function xi(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.TgZ(1,"app-operator-lookup",33),f.NdJ("operatorChanged",function(We){return f.CHM(j),f.oxw(2).onOperatorChange(We)}),f.qZA(),f.TgZ(2,"ion-item"),f.TgZ(3,"ion-label",16),f._uU(4,"Number of Stations or Parking Bays"),f.qZA(),f.TgZ(5,"ion-input",21),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw(2).item.NumberOfPoints=We}),f.qZA(),f.qZA(),f.TgZ(6,"h4"),f._uU(7,"Equipment"),f.qZA(),f.TgZ(8,"ion-button",34),f.NdJ("click",function(){return f.CHM(j),f.oxw(2).addConnection()}),f._UZ(9,"ion-icon",35),f.qZA(),f.TgZ(10,"app-equipment-details",36),f.NdJ("onEdit",function(We){return f.CHM(j),f.oxw(2).editConnection(We)})("onDelete",function(We){return f.CHM(j),f.oxw(2).deleteConnection(We)}),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw(2);f.xp6(1),f.Q6J("operatorId",j.item.OperatorID)("useFilteredOperators",!1),f.xp6(4),f.Q6J("ngModel",j.item.NumberOfPoints),f.xp6(5),f.Q6J("item",j.item)("enableEdit",!0)}}function Wi(_e,Ye){if(1&_e&&(f.ynx(0),f.YNc(1,Ki,2,1,"ng-container",9),f.YNc(2,xi,11,5,"ng-container",9),f.BQk()),2&_e){const j=f.oxw();f.xp6(1),f.Q6J("ngIf","copy-equipment"==j.step),f.xp6(1),f.Q6J("ngIf","edit-equipment"==j.step)}}function Vi(_e,Ye){if(1&_e&&(f.TgZ(0,"p",43),f.TgZ(1,"strong"),f._uU(2,"Your changes cannot be saved until the following issues are resolved:"),f.qZA(),f.TgZ(3,"ion-label",44),f._uU(4),f.qZA(),f.qZA()),2&_e){const j=f.oxw(2);f.xp6(4),f.hij(" ",j.validationMsg,"")}}function _i(_e,Ye){if(1&_e&&(f.TgZ(0,"ion-select-option",27),f._uU(1),f.qZA()),2&_e){const j=Ye.$implicit;f.Q6J("value",j.ID),f.xp6(1),f.Oqu(j.Title)}}function bi(_e,Ye){if(1&_e&&(f.TgZ(0,"ion-select-option",27),f._uU(1),f.qZA()),2&_e){const j=Ye.$implicit;f.Q6J("value",j.ID),f.xp6(1),f.Oqu(j.Title)}}function xn(_e,Ye){if(1&_e){const j=f.EpF();f.ynx(0),f.YNc(1,Vi,5,1,"p",37),f.TgZ(2,"p"),f._uU(3,"Please provide any other facts related to this site. Additional comments (your charging experiences etc) can be added as check-in comments once the site is listed."),f.qZA(),f.TgZ(4,"ion-item"),f.TgZ(5,"ion-label",16),f._uU(6,"Operational Status (All Equipment))"),f.qZA(),f.TgZ(7,"ion-select",38),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.StatusTypeID=We}),f.YNc(8,_i,2,2,"ion-select-option",24),f.qZA(),f.qZA(),f.TgZ(9,"ion-item"),f.TgZ(10,"ion-label",16),f._uU(11,"Usage Type"),f.qZA(),f.TgZ(12,"ion-select",38),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.UsageTypeID=We}),f.YNc(13,bi,2,2,"ion-select-option",24),f.qZA(),f.qZA(),f.TgZ(14,"ion-item"),f.TgZ(15,"ion-label",16),f._uU(16,"Usage Cost"),f.qZA(),f.TgZ(17,"ion-input",21),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.UsageCost=We}),f.qZA(),f.qZA(),f.TgZ(18,"ion-item"),f.TgZ(19,"ion-label",16),f._uU(20,"General Comments"),f.qZA(),f.TgZ(21,"ion-input",39),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.GeneralComments=We}),f.qZA(),f.qZA(),f.TgZ(22,"ion-item"),f.TgZ(23,"ion-label",16),f._uU(24,"Main Telephone Number "),f.qZA(),f.TgZ(25,"ion-input",40),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.AddressInfo.ContactTelephone1=We}),f.qZA(),f.qZA(),f.TgZ(26,"ion-item"),f.TgZ(27,"ion-label",16),f._uU(28,"Other Telephone Number "),f.qZA(),f.TgZ(29,"ion-input",40),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.AddressInfo.ContactTelephone2=We}),f.qZA(),f.qZA(),f.TgZ(30,"ion-item"),f.TgZ(31,"ion-label",16),f._uU(32,"Access Comments"),f.qZA(),f.TgZ(33,"ion-input",41),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.AddressInfo.AccessComments=We}),f.qZA(),f.qZA(),f.TgZ(34,"ion-item"),f.TgZ(35,"ion-label",16),f._uU(36,"Related Website"),f.qZA(),f.TgZ(37,"ion-input",42),f.NdJ("ngModelChange",function(We){return f.CHM(j),f.oxw().item.AddressInfo.RelatedURL=We}),f.qZA(),f.qZA(),f.BQk()}if(2&_e){const j=f.oxw();f.xp6(1),f.Q6J("ngIf",j.validationMsg),f.xp6(6),f.Q6J("ngModel",j.item.StatusTypeID),f.xp6(1),f.Q6J("ngForOf",j.statusTypes),f.xp6(4),f.Q6J("ngModel",j.item.UsageTypeID),f.xp6(1),f.Q6J("ngForOf",j.usageTypes),f.xp6(4),f.Q6J("ngModel",j.item.UsageCost),f.xp6(4),f.Q6J("ngModel",j.item.GeneralComments),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.ContactTelephone1),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.ContactTelephone2),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.AccessComments),f.xp6(4),f.Q6J("ngModel",j.item.AddressInfo.RelatedURL)}}function rn(_e,Ye){if(1&_e){const j=f.EpF();f.TgZ(0,"ion-button",1),f.NdJ("click",function(){return f.CHM(j),f.oxw().previous()}),f._uU(1," Previous "),f._UZ(2,"ion-icon",45),f.qZA()}}function ot(_e,Ye){if(1&_e){const j=f.EpF();f.TgZ(0,"ion-button",1),f.NdJ("click",function(){return f.CHM(j),f.oxw().next()}),f._uU(1," Next "),f._UZ(2,"ion-icon",46),f.qZA()}}function ft(_e,Ye){if(1&_e){const j=f.EpF();f.TgZ(0,"ion-button",47),f.NdJ("click",function(){return f.CHM(j),f.oxw().save()}),f._uU(1," Submit "),f._UZ(2,"ion-icon",48),f.qZA()}}let pn=(()=>{class _e{constructor(j,ye,We,Tt,on,qn){this.appManager=j,this.modalController=ye,this.poiManager=We,this.mapping=Tt,this.loadingController=on,this.alertController=qn,this.useFilteredConnectionTypes=!0,this.templateSites=[],this.nearbySites=[],this.selectedTemplatePOI=null,this.suggestedAddress=null,this.suggestedAddressAttribution=null,this.isNonDuplicateConfirmed=!1,this.skipPOICopy=!1,this.validationMsg=null,this.initNewItem()}get countries(){return this.appManager.referenceDataManager.getCountries()}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes()}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes().filter(j=>1==j.IsUserSelectable)}get isAddMode(){return this.item.ID<=0}initNewItem(){this.item={ID:-1,DataProviderID:1,DataProvidersReference:null,OperatorsReference:null,OperatorID:1,UsageCost:null,UsageTypeID:4,NumberOfPoints:1,GeneralComments:null,DatePlanned:null,StatusTypeID:50,SubmissionStatusTypeID:null,Connections:[],MetadataValues:[],AddressInfo:{ID:-1,CountryID:18,Title:"",AddressLine1:"",Latitude:0,Longitude:0}},this.step="location",this.selectedTab="location"}get isReadyToSubmit(){return this.validate().isValid&&"info"==this.step}ngOnInit(){}presentLoadingUI(){var j=this;return(0,x.Z)(function*(){j.loading=yield j.loadingController.create({message:"Please Wait.."}),yield j.loading.present()})()}dismissLoadingUI(){var j=this;return(0,x.Z)(function*(){j.loading&&(yield j.loading.dismiss())})()}ionViewDidEnter(){if(null!=this.id)this.editExistingPOI(this.id);else{let j=localStorage.getItem("_editor-operatorid");j&&(this.item.OperatorID=parseInt(j,10)),this.startPos?(this.item.AddressInfo.Latitude=this.startPos.latitude,this.item.AddressInfo.Longitude=this.startPos.longitude):this.mapping&&this.mapping.getMapCenter().subscribe(ye=>{ye&&(this.item.AddressInfo.Latitude=ye.coords.latitude,this.item.AddressInfo.Longitude=ye.coords.longitude)})}this.refreshFilteredReferenceData()}previous(){var j=this;return(0,x.Z)(function*(){switch(j.step){case"info":j.step="edit-equipment";break;case"edit-equipment":j.step=j.isAddMode?"copy-equipment":"location";break;case"copy-equipment":case"poi-nearby":j.step="location"}yield j.initCurrentStep(!1)})()}next(){var j=this;return(0,x.Z)(function*(){if("poi-nearby"==j.step&&j.nearbySites.length>0&&!j.isNonDuplicateConfirmed)return void(yield j.alertController.create({header:"Confirm",message:"Please confirm you are not adding a duplicate site.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:Tt=>{}},{text:"Confirm",handler:()=>{j.isNonDuplicateConfirmed=!0,j.next()}}]})).present();const ye=j.validate(j.step);if(ye.isValid){switch(j.step){case"location":j.step=j.isAddMode?"poi-nearby":"edit-equipment";break;case"poi-nearby":j.step=j.isAddMode?"copy-equipment":"edit-equipment";break;case"copy-equipment":j.step="edit-equipment";break;case"edit-equipment":j.step="info"}yield j.initCurrentStep(!0)}else(yield j.alertController.create({message:ye.msg})).present()})()}initCurrentStep(j){var ye=this;return(0,x.Z)(function*(){"poi-nearby"==ye.step?(ye.selectedTab="location",0==(yield ye.refreshNearbySites())&&(j?yield ye.next():yield ye.previous())):"location"==ye.step?ye.selectedTab="location":"copy-equipment"==ye.step?(ye.selectedTab="equipment",yield ye.refreshTemplateSites()):"edit-equipment"==ye.step?ye.selectedTab="equipment":"info"==ye.step&&(ye.selectedTab="info")})()}onCountryChange(){var j=this;return(0,x.Z)(function*(){j.refreshFilteredReferenceData()})()}onOperatorChange(j=null){var ye=this;return(0,x.Z)(function*(){null!=j&&ye.item.OperatorID!=j.ID&&(ye.item.OperatorID=j.ID,localStorage.setItem("_editor-operatorid",ye.item.OperatorID.toString()),yield ye.refreshTemplateSites())})()}useSuggestedAddress(j=null){j&&(this.suggestedAddress=j.suggestedAddress,this.suggestedAddressAttribution=j.suggestedAddressAttribution),Object.assign(this.item.AddressInfo,this.suggestedAddress),this.suggestedAddressAttribution&&(this.item.MetadataValues.find(ye=>4==ye.MetadataFieldID)||this.item.MetadataValues.push({ID:-1,MetadataFieldID:4,ItemValue:this.suggestedAddressAttribution,MetadataFieldOptionID:null,MetadataFieldOption:null}))}editConnection(j){var ye=this;return(0,x.Z)(function*(){const We=ye.item.Connections.find(qn=>qn.ID==j.ID),Tt=Object.assign({},We),on=yield ye.modalController.create({component:Fe,componentProps:{conn:Tt}});return on.onWillDismiss().then(qn=>{qn&&qn.data&&qn.data.item&&ye.updateConnection(qn.data.item)}),yield on.present()})()}deleteConnection(j){var ye=this;return(0,x.Z)(function*(){const We=ye.item.Connections.find(on=>on.ID==j.ID);(yield ye.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this connection information?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Yes",handler:()=>{ye.item.Connections=ye.item.Connections.filter(on=>on.ID!=We.ID),ye.appManager.referenceDataManager.hydrateCompactPOI(ye.item,!0)}}]})).present()})()}addConnection(){var j=this;return(0,x.Z)(function*(){const ye={ID:-l.c.getRandomInt(1e4),ConnectionTypeID:null,StatusTypeID:50,PowerKW:null,Quantity:1},We=yield j.modalController.create({component:Fe,componentProps:{conn:ye}});return We.onWillDismiss().then(Tt=>{Tt&&Tt.data&&Tt.data.item&&j.updateConnection(Tt.data.item)}),yield We.present()})()}refreshFilteredReferenceData(){this.appManager.referenceDataManager.refreshFilteredReferenceData(this.appManager.api,{CountryIds:[this.item.AddressInfo.CountryID]})}updateConnection(j){if(j){let ye=this.item.Connections.find(We=>We.ID==j.ID);ye?Object.assign(ye,j):this.item.Connections.push(j)}this.appManager.referenceDataManager.hydrateCompactPOI(this.item,!0)}validate(j="all"){let ye=null;return("all"==j||"location"==j)&&((!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(ye="Location is required"),""==this.item.AddressInfo.Title&&(ye="A location title is required"),this.item.AddressInfo.CountryID||(ye="A country selection is required"),(!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(ye="A location latitude and longitude is required")),("all"==j||"poi-nearby"==j)&&this.nearbySites.length>0&&!this.isNonDuplicateConfirmed&&(ye="Please confirm that the site is not a duplicate"),("all"==j||"equipment"==j)&&(this.item.OperatorID||(ye="Please confirm the charging network or equipment operator."),0==this.item.Connections.length&&(ye="Equipment information is required")),ye?(this.validationMsg=ye,{isValid:!1,msg:ye}):(this.validationMsg=null,{isValid:!0,msg:null})}save(){var j=this;return(0,x.Z)(function*(){let ye=j.validate();if(ye.isValid){yield j.presentLoadingUI();try{yield j.appManager.submitPOI(j.item),yield j.dismissLoadingUI(),j.appManager.showToastNotification("You submission will be reviewed (if required) and published shortly."),j.modalController.dismiss()}catch(We){yield j.dismissLoadingUI(),We.error&&alert("Sorry, your submission could not be completed at this time. Please try again later.")}}else alert(ye.msg)})()}cancel(){var j=this;return(0,x.Z)(function*(){j.modalController.dismiss()})()}refreshTemplateSites(){var j=this;return(0,x.Z)(function*(){if(j.item.AddressInfo.CountryID&&j.item.OperatorID){yield j.presentLoadingUI(),j.templateSites=[];let ye=new Y.b;ye.countryIdList=[j.item.AddressInfo.CountryID],ye.minPowerKW=1,ye.operatorIdList=[j.item.OperatorID],ye.maxResults=10;let We=yield j.poiManager.fetchPOIList(ye);We.sort((Tt,on)=>new Date(Tt.DateCreated).getTime()-new Date(on.DateCreated).getTime()),j.templateSites=We,j.dismissLoadingUI()}})()}refreshNearbySites(){var j=this;return(0,x.Z)(function*(){if(j.item.AddressInfo.Latitude&&j.item.AddressInfo.Longitude){yield j.presentLoadingUI(),j.nearbySites=[];let ye=new Y.b;ye.latitude=j.item.AddressInfo.Latitude,ye.longitude=j.item.AddressInfo.Longitude,ye.distance=5,ye.distanceUnit="km",ye.maxResults=10;let We=yield j.poiManager.fetchPOIList(ye);return We.sort((Tt,on)=>Tt.Distance-on.Distance),j.nearbySites=We,j.dismissLoadingUI(),We.length}return 0})()}confirmNonDuplicate(){this.isNonDuplicateConfirmed=!0,this.next()}changeTemplatePOI(){this.selectedTemplatePOI=null}editPOI(j){this.editExistingPOI(j.ID)}editExistingPOI(j){var ye=this;return(0,x.Z)(function*(){ye.skipPOICopy=!0,ye.isNonDuplicateConfirmed=!0,yield ye.presentLoadingUI(),ye.poiManager.getPOIById(j,!0,!0).then(We=>{ye.item=Object.assign({},We),null==ye.item.OperatorID&&(ye.item.OperatorID=Qe.UnknownOperator),ye.refreshFilteredReferenceData(),ye.dismissLoadingUI()})})()}useTemplatePOI(j){this.selectedTemplatePOI=j,Object.assign(this.item.Connections,j.Connections);for(let ye of this.item.Connections)ye.ID=-l.c.getRandomInt(1e4),ye.Reference=null,ye.Comments=null,ye.StatusTypeID=E.Operational;this.item.UsageCost=j.UsageCost,this.item.UsageTypeID=j.UsageTypeID,this.appManager.referenceDataManager.hydrateCompactPOI(this.item)}skipCopyingPOI(){this.skipPOICopy=!0}}return _e.\u0275fac=function(j){return new(j||_e)(f.Y36(d.c),f.Y36(ve.IN),f.Y36(P.R),f.Y36(O.v),f.Y36(ve.HT),f.Y36(ve.Br))},_e.\u0275cmp=f.Xpm({type:_e,selectors:[["app-poi-editor"]],viewQuery:function(j,ye){if(1&j&&f.Gf(ze,5),2&j){let We;f.iGM(We=f.CRH())&&(ye.editorMap=We.first)}},decls:33,vars:14,consts:[["slot","end"],[3,"click"],["name","close","slot","start"],[1,"ion-padding"],[3,"ngModel"],["value","location","layout","icon-start",3,"disabled"],["name","caret-forward",4,"ngIf"],["value","equipment","layout","icon-start",3,"disabled"],["value","info","layout","icon-start",3,"disabled"],[4,"ngIf"],["slot","start"],[3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],["name","caret-forward"],[3,"latitude","longitude","latitudeChange","longitudeChange","onUseSuggestedAddress"],["editorMap",""],["position","floating"],["type","text","autocapitalize","words","placeholder","A title for this location",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","The nearest street address",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Town or City",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional Postal Code",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["type","number","placeholder","Latitude (if entering manually)",3,"ngModel","ngModelChange"],["type","number","placeholder","Longitude (if entering manually)",3,"ngModel","ngModelChange"],[3,"value"],[1,"instruction"],[3,"poiList","enableEditOption","onEdit"],[3,"operatorId","operatorChanged"],["slot","start","size","small",3,"click"],[3,"enableCopyOption","poiList","onCopy"],[3,"operatorId","useFilteredOperators","operatorChanged"],["size","small",3,"click"],["name","add","slot","icon-only"],[3,"item","enableEdit","onEdit","onDelete"],["color","warning",4,"ngIf"],[3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences",3,"ngModel","ngModelChange"],["type","tel","placeholder","",3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences","placeholder","Instructions for access or tips for finding charging location",3,"ngModel","ngModelChange"],["type","url","placeholder","Website related to this site",3,"ngModel","ngModelChange"],["color","warning"],["color","danger"],["name","caret-back","slot","start"],["name","caret-forward","slot","end"],["color","success",3,"click"],["name","send","slot","end"]],template:function(j,ye){1&j&&(f.TgZ(0,"ion-header"),f.TgZ(1,"ion-toolbar"),f.TgZ(2,"ion-title"),f._uU(3),f.qZA(),f.TgZ(4,"ion-buttons",0),f.TgZ(5,"ion-button",1),f.NdJ("click",function(){return ye.cancel()}),f._UZ(6,"ion-icon",2),f._uU(7," Cancel "),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(8,"ion-content",3),f.ynx(9),f.TgZ(10,"ion-segment",4),f.TgZ(11,"ion-segment-button",5),f.YNc(12,Ot,1,0,"ion-icon",6),f.TgZ(13,"ion-label"),f._uU(14,"Location"),f.qZA(),f.qZA(),f.TgZ(15,"ion-segment-button",7),f.YNc(16,Ft,1,0,"ion-icon",6),f.TgZ(17,"ion-label"),f._uU(18,"Equipment"),f.qZA(),f.qZA(),f.TgZ(19,"ion-segment-button",8),f.YNc(20,ln,1,0,"ion-icon",6),f.TgZ(21,"ion-label"),f._uU(22,"Info"),f.qZA(),f.qZA(),f.qZA(),f.YNc(23,yt,3,2,"ng-container",9),f.YNc(24,Wi,3,2,"ng-container",9),f.YNc(25,xn,38,11,"ng-container",9),f.BQk(),f.qZA(),f.TgZ(26,"ion-footer"),f.TgZ(27,"ion-toolbar"),f.TgZ(28,"ion-buttons",10),f.YNc(29,rn,3,0,"ion-button",11),f.qZA(),f.TgZ(30,"ion-buttons",0),f.YNc(31,ot,3,0,"ion-button",11),f.YNc(32,ft,3,0,"ion-button",12),f.qZA(),f.qZA(),f.qZA()),2&j&&(f.xp6(3),f.Oqu(ye.isAddMode?"Add Location":"Edit Location"),f.xp6(7),f.Q6J("ngModel",ye.selectedTab),f.xp6(1),f.Q6J("disabled",!0),f.xp6(1),f.Q6J("ngIf","location"==ye.selectedTab),f.xp6(3),f.Q6J("disabled",!0),f.xp6(1),f.Q6J("ngIf","equipment"==ye.selectedTab),f.xp6(3),f.Q6J("disabled",!0),f.xp6(1),f.Q6J("ngIf","info"==ye.selectedTab),f.xp6(3),f.Q6J("ngIf","location"==ye.selectedTab),f.xp6(1),f.Q6J("ngIf","equipment"==ye.selectedTab),f.xp6(1),f.Q6J("ngIf","info"==ye.selectedTab),f.xp6(4),f.Q6J("ngIf","location"!=ye.step),f.xp6(2),f.Q6J("ngIf",!ye.isReadyToSubmit&&"info"!=ye.step),f.xp6(1),f.Q6J("ngIf",ye.isReadyToSubmit))},directives:[ve.Gu,ve.sr,ve.wd,ve.Sm,ve.YG,ve.gu,ve.W2,ve.cJ,ve.QI,Ae.JJ,Ae.On,ve.GO,me.O5,ve.Q$,ve.fr,ze,ve.q_,ve.Ie,ve.pK,ve.j9,ve.t9,me.sg,ve.as,ve.n0,gt.o,Mt,Kt.B],styles:['ul.breadcrumb[_ngcontent-%COMP%]{display:inline-flex;margin:0;padding:0}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;margin-right:6px;color:var(--ion-color-light-shade);font-size:10px}ul.breadcrumb[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:var(--ion-color-dark-shade)}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:">";padding-right:4px}']}),_e})()},9950:(yn,je,N)=>{"use strict";N.d(je,{u:()=>E});var x=N(865),d=N(5966),Y=N(9206),l=N(2840),P=N(6505),O=N(6520),f=N(4522);let H=(()=>{class Qe{constructor(ct,gt){this.http=ct,this.journeyManager=gt}getDirections(ct,gt){return new Promise((bt,ut)=>{(new google.maps.DirectionsService).route({origin:ct,destination:gt,travelMode:google.maps.TravelMode.DRIVING},(Vt,bn)=>{bn===google.maps.DirectionsStatus.OK?bt(Vt):ut(bn)})})}analyseRoutes(ct,gt){const bt=new Array;return ct.routes.forEach(ut=>{const St=new O.JJ;St.Title=""+bt.length+1,St.JourneyRouteLegs=new Array,St.TotalDistanceKM=0,St.TotalDurationMinutes=0,St.TotalEnergykWh=0,ut.legs.forEach(Vt=>{const bn=Vt.duration.value,Nt=Vt.distance.value/1e3,Bt=this.journeyManager.calculateEnergyConsumptionkWh(Nt,0,null,gt),Mt=new O.eN;Mt.DistanceKM=Nt,Mt.DurationMinutes=bn/60,Mt.EnergyConsumptionkWh=Bt,St.JourneyRouteLegs.push(Mt),St.TotalDistanceKM+=Mt.DistanceKM,St.TotalDurationMinutes+=Mt.DurationMinutes,St.TotalEnergykWh=Mt.EnergyConsumptionkWh}),bt.push(St)}),bt}}return Qe.\u0275fac=function(ct){return new(ct||Qe)(x.LFG(f.eN),x.LFG(l.i))},Qe.\u0275prov=x.Yz7({token:Qe,factory:Qe.\u0275fac,providedIn:"root"}),Qe})();var te=N(8616),K=N(6019),G=N(9574),ne=N(9133);function ce(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"ion-item"),x._UZ(1,"ion-icon",12),x.TgZ(2,"ion-searchbar",13),x.NdJ("ngModelChange",function(bt){return x.CHM(ct),x.oxw().routeStart=bt})("ionInput",function(bt){return x.CHM(ct),x.oxw(),x.MAs(18).getPlacesAutoComplete(bt,"routeStart")})("ionCancel",function(bt){return x.CHM(ct),x.oxw().onPlaceSearchCancel(bt)}),x.qZA(),x.qZA()}if(2&Qe){const ct=x.oxw();x.xp6(2),x.Q6J("ngModel",ct.routeStart)("debounce",500)}}function me(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"ion-item",14),x.NdJ("click",function(){return x.CHM(ct),x.oxw().clearRouteStart()}),x._UZ(1,"ion-icon",12),x.TgZ(2,"h2"),x._uU(3),x.qZA(),x.qZA()}if(2&Qe){x.oxw();const ct=x.MAs(18);x.xp6(3),x.Oqu(null==ct.selectedPlace?null:ct.selectedPlace.name)}}function ve(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"ion-item"),x._UZ(1,"ion-icon",15),x.TgZ(2,"ion-searchbar",16),x.NdJ("ngModelChange",function(bt){return x.CHM(ct),x.oxw().routeDestination=bt})("ionInput",function(bt){return x.CHM(ct),x.oxw(),x.MAs(20).getPlacesAutoComplete(bt,"routeDestination")})("ionCancel",function(bt){return x.CHM(ct),x.oxw().onPlaceSearchCancel(bt)}),x.qZA(),x.qZA()}if(2&Qe){const ct=x.oxw();x.xp6(2),x.Q6J("ngModel",ct.routeDestination)("debounce",500)}}function we(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"ion-item",14),x.NdJ("click",function(){return x.CHM(ct),x.oxw().clearRouteDestination()}),x._UZ(1,"ion-icon",15),x.TgZ(2,"h2"),x._uU(3),x.qZA(),x.qZA()}if(2&Qe){x.oxw();const ct=x.MAs(20);x.xp6(3),x.Oqu(null==ct.selectedPlace?null:ct.selectedPlace.name)}}function ze(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"ion-button",14),x.NdJ("click",function(){return x.CHM(ct),x.oxw().clearRoute()}),x._UZ(1,"ion-icon",17),x._uU(2," Clear Route "),x.qZA()}}function Ne(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"ion-button",14),x.NdJ("click",function(){return x.CHM(ct),x.oxw().showSettings()}),x._uU(1," Show Settings "),x._UZ(2,"ion-icon",18),x.qZA()}}function Ae(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"ion-button",14),x.NdJ("click",function(){return x.CHM(ct),x.oxw().hideSettings()}),x._uU(1," Hide Settings "),x._UZ(2,"ion-icon",18),x.qZA()}}function Te(Qe,et){1&Qe&&(x.TgZ(0,"p",19),x._UZ(1,"ion-spinner",19),x._uU(2," Calculating Route.. "),x.qZA())}function He(Qe,et){if(1&Qe&&(x.TgZ(0,"ion-list"),x.TgZ(1,"ion-list-header"),x._uU(2),x.ALo(3,"number"),x.ALo(4,"number"),x.qZA(),x.qZA()),2&Qe){const ct=x.oxw();x.xp6(2),x.lnq(" Total Distance ",x.xi3(3,3,ct.selectedJourneyRoute.TotalDistanceKM,"1.0-2")," km, ",ct.formatDuration(ct.selectedJourneyRoute.TotalDurationMinutes),", ",x.xi3(4,6,ct.selectedJourneyRoute.TotalEnergykWh,"1.0-2")," kWh ")}}function Ge(Qe,et){if(1&Qe){const ct=x.EpF();x.TgZ(0,"div"),x.TgZ(1,"ion-list"),x.TgZ(2,"ion-list-header"),x._UZ(3,"ion-icon",20),x._uU(4," Route Settings "),x.qZA(),x.TgZ(5,"ion-item"),x.TgZ(6,"ion-label",21),x._uU(7),x.qZA(),x.TgZ(8,"ion-range",22),x.NdJ("ngModelChange",function(bt){return x.CHM(ct),x.oxw().routeSearchDistance=bt}),x._UZ(9,"ion-icon",23),x._UZ(10,"ion-icon",24),x.qZA(),x.qZA(),x.TgZ(11,"ion-item"),x.TgZ(12,"ion-label",21),x._uU(13,"Energy Efficiency (kWh Per km)"),x.qZA(),x.TgZ(14,"ion-input",25),x.NdJ("ngModelChange",function(bt){return x.CHM(ct),x.oxw().kWhPerKM=bt}),x.qZA(),x.qZA(),x.qZA(),x.qZA()}if(2&Qe){const ct=x.oxw();x.xp6(7),x.hij("Search Distance (",ct.routeSearchDistance,")"),x.xp6(1),x.Q6J("ngModel",ct.routeSearchDistance),x.xp6(6),x.Q6J("ngModel",ct.kWhPerKM)}}let Fe=(()=>{class Qe{constructor(ct,gt,bt,ut,St,Vt){this.mapping=ct,this.logging=gt,this.directions=bt,this.journeyManager=ut,this.changeDetector=St,this.numberPipe=Vt,this.routeSearchDistance=5,this.routeCalcInProgress=!1,this.advancedSettingsMode=!1,this.routeStart="",this.routeDestination="",this.kWhPerKM=.212}get isRouteSet(){return null!=this.routeStartPlace&&null!=this.routeDestinationPlace}showSettings(){this.advancedSettingsMode=!0}hideSettings(){this.advancedSettingsMode=!1}routeStartSelected(ct){this.routeStartPlace=ct,this.calculateRoute(),this.changeDetector.detectChanges()}routeDestinationSelected(ct){this.routeDestinationPlace=ct,this.calculateRoute(),this.changeDetector.detectChanges()}clearRouteStart(){this.routeStartPlace=null,this.changeDetector.detectChanges()}clearRouteDestination(){this.routeDestinationPlace=null,this.changeDetector.detectChanges()}clearRoute(){this.routeStartPlace=null,this.routeDestinationPlace=null,this.journeyManager.setRoutePolyline(null),this.mapping.clearPolyline()}formatDuration(ct){if(ct<=60)return this.numberPipe.transform(ct,"1.0-2")+" mins";{const gt=Math.round(ct/60),bt=Math.floor(ct-60*gt);return gt+" hours "+(bt>0?bt+" mins":"")}}calculateRoute(){null!=this.routeStartPlace&&null!=this.routeDestinationPlace&&(this.logging.log("Fetching route directions.."),this.routeCalcInProgress=!0,this.directions.getDirections(this.routeStartPlace.Location.latitude+","+this.routeStartPlace.Location.longitude,this.routeDestinationPlace.Location.latitude+","+this.routeDestinationPlace.Location.longitude).then(ct=>{if(null!=ct.routes&&ct.routes.length>0){this.logging.log("Got route directions, analysing.."),this.routePolyline=ct.routes[0].overview_polyline;const gt=ct.routes[0].bounds.getSouthWest(),bt=ct.routes[0].bounds.getNorthEast(),ut=new Y.wC(bt.lat(),bt.lng()),St=new Y.wC(gt.lat(),gt.lng()),Vt=new Y.LL(ut,St);this.journeyRoutes=this.directions.analyseRoutes(ct,this.kWhPerKM),this.journeyRoutes.length>0&&(this.selectedJourneyRoute=this.journeyRoutes[0]),this.journeyManager.setRoutePolyline(this.routePolyline),this.mapping.renderPolyline(this.routePolyline),this.mapping.moveToMapBounds(Vt)}else this.logging.log("No route returned..");this.routeCalcInProgress=!1}))}}return Qe.\u0275fac=function(ct){return new(ct||Qe)(x.Y36(te.v),x.Y36(P.z),x.Y36(H),x.Y36(l.i),x.Y36(x.sBO),x.Y36(K.JJ))},Qe.\u0275cmp=x.Xpm({type:Qe,selectors:[["route-planner"]],decls:24,vars:10,consts:[[1,"route"],[1,"route-places"],["name","map","slot","start"],[4,"ngIf"],[3,"click",4,"ngIf"],["primary",""],["slot","secondary"],["slot","primary"],[3,"placeChanged"],["placeSearchRouteStart",""],["placeSearchRouteDestination",""],["class","ion-padding",4,"ngIf"],["name","ionic","item-left",""],["placeholder","Starting Point",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],[3,"click"],["name","pin","item-left",""],["placeholder","Destination",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],["name","close","slot","start"],["name","cog","slot","end"],[1,"ion-padding"],["name","cog"],["position","stacked"],["min","1","max","200","step","5","snaps","true","pin","true","light","",3,"ngModel","ngModelChange"],["slot","start","small","","name","map"],["slot","end","large","","name","map"],["type","number","min","0.1","max","1",3,"ngModel","ngModelChange"]],template:function(ct,gt){1&ct&&(x.TgZ(0,"div",0),x.TgZ(1,"div",1),x.TgZ(2,"ion-list"),x.TgZ(3,"ion-list-header"),x._UZ(4,"ion-icon",2),x.TgZ(5,"ion-label"),x._uU(6,"Plan Your Journey"),x.qZA(),x.qZA(),x.YNc(7,ce,3,2,"ion-item",3),x.YNc(8,me,4,1,"ion-item",4),x.YNc(9,ve,3,2,"ion-item",3),x.YNc(10,we,4,1,"ion-item",4),x.qZA(),x.TgZ(11,"ion-toolbar",5),x.TgZ(12,"ion-buttons",6),x.YNc(13,ze,3,0,"ion-button",4),x.qZA(),x.TgZ(14,"ion-buttons",7),x.YNc(15,Ne,3,0,"ion-button",4),x.YNc(16,Ae,3,0,"ion-button",4),x.qZA(),x.qZA(),x.qZA(),x.TgZ(17,"place-search",8,9),x.NdJ("placeChanged",function(ut){return gt.routeStartSelected(ut)}),x.qZA(),x.TgZ(19,"place-search",8,10),x.NdJ("placeChanged",function(ut){return gt.routeDestinationSelected(ut)}),x.qZA(),x.YNc(21,Te,3,0,"p",11),x.YNc(22,He,5,9,"ion-list",3),x.YNc(23,Ge,15,3,"div",3),x.qZA()),2&ct&&(x.xp6(7),x.Q6J("ngIf",null==gt.routeStartPlace),x.xp6(1),x.Q6J("ngIf",null!=gt.routeStartPlace),x.xp6(1),x.Q6J("ngIf",null==gt.routeDestinationPlace),x.xp6(1),x.Q6J("ngIf",null!=gt.routeDestinationPlace),x.xp6(3),x.Q6J("ngIf",gt.isRouteSet),x.xp6(2),x.Q6J("ngIf",!gt.advancedSettingsMode),x.xp6(1),x.Q6J("ngIf",gt.advancedSettingsMode),x.xp6(5),x.Q6J("ngIf",gt.routeCalcInProgress),x.xp6(1),x.Q6J("ngIf",null!=gt.selectedJourneyRoute),x.xp6(1),x.Q6J("ngIf",gt.advancedSettingsMode))},directives:[d.q_,d.yh,d.gu,d.Q$,K.O5,d.sr,d.Sm,G.v,d.Ie,d.VI,d.j9,ne.JJ,ne.On,d.YG,d.PQ,d.I_,d.QI,d.pK,d.as],pipes:[K.JJ],encapsulation:2}),Qe})(),E=(()=>{class Qe{constructor(ct){this.modalController=ct,this.hasNavbar=!1}close(){this.modalController.dismiss()}}return Qe.\u0275fac=function(ct){return new(ct||Qe)(x.Y36(d.IN))},Qe.\u0275cmp=x.Xpm({type:Qe,selectors:[["ng-component"]],decls:10,vars:0,consts:[["slot","end"],[3,"click"],["name","close","slot","end"],[1,"route-planner","ion-padding"]],template:function(ct,gt){1&ct&&(x.TgZ(0,"ion-header"),x.TgZ(1,"ion-toolbar"),x.TgZ(2,"ion-title"),x._uU(3," Route Planner "),x.qZA(),x.TgZ(4,"ion-buttons",0),x.TgZ(5,"ion-button",1),x.NdJ("click",function(){return gt.close()}),x._UZ(6,"ion-icon",2),x._uU(7," Close "),x.qZA(),x.qZA(),x.qZA(),x.qZA(),x.TgZ(8,"ion-content",3),x._UZ(9,"route-planner"),x.qZA())},directives:[d.Gu,d.sr,d.wd,d.Sm,d.YG,d.gu,d.W2,Fe],encapsulation:2}),Qe})()},2670:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{SearchPageModule:()=>nn});var x=N(5316),d=N(1586),Y=N(6019),l=N(9133),P=N(5966),O=N(5899),f=N(4553),H=N(8260),te=N(9567),K=N(2619),G=N(9950),ne=N(244),ce=N(9206),me=N(1058),ve=N(2022),we=N(6505),ze=N(2840),Ne=N(8616),Ae=N(6158),Te=N(8615),He=N(9574),Ge=N(6087),Fe=N(4168),E=N(6339);const ct=new(N(5192).v)(E.o);class bt{constructor(en,yt){this.dueTime=en,this.scheduler=yt}call(en,yt){return yt.subscribe(new ut(en,this.dueTime,this.scheduler))}}class ut extends Fe.L{constructor(en,yt,Xt){super(en),this.dueTime=yt,this.scheduler=Xt,this.debouncedSubscription=null,this.lastValue=null,this.hasValue=!1}_next(en){this.clearDebounce(),this.lastValue=en,this.hasValue=!0,this.add(this.debouncedSubscription=this.scheduler.schedule(St,this.dueTime,this))}_complete(){this.debouncedNext(),this.destination.complete()}debouncedNext(){if(this.clearDebounce(),this.hasValue){const{lastValue:en}=this;this.lastValue=null,this.hasValue=!1,this.destination.next(en)}}clearDebounce(){const en=this.debouncedSubscription;null!==en&&(this.remove(en),en.unsubscribe(),this.debouncedSubscription=null)}}function St(tn){tn.debouncedNext()}const bn=(0,N(1278).fo)("Geolocation",{web:()=>N.e(8354).then(N.bind(N,8354)).then(tn=>new tn.GeolocationWeb)});var Nt=N(865),Bt=N(9101);function Mt(tn,en){1&tn&&Nt._UZ(0,"ion-icon",13)}function Kt(tn,en){1&tn&&Nt._UZ(0,"ion-spinner")}function Ot(tn,en){if(1&tn){const yt=Nt.EpF();Nt.TgZ(0,"ion-button",3),Nt.NdJ("click",function(){return Nt.CHM(yt),Nt.oxw().openSideView()}),Nt._UZ(1,"ion-icon",14),Nt.qZA()}}function Ft(tn,en){1&tn&&(Nt.ynx(0),Nt.TgZ(1,"div",15),Nt.TgZ(2,"p"),Nt._uU(3,"There was a problem communicating with Open Charge Map. Please check your data connection."),Nt.qZA(),Nt.qZA(),Nt.BQk())}let ln=(()=>{class tn{constructor(yt,Xt,cn,kn,An,mi,si,Ki,xi,Wi,Vi,_i){this.appManager=yt,this.nav=Xt,this.events=cn,this.translate=kn,this.platform=An,this.poiManager=mi,this.mapping=si,this.journeyManager=Ki,this.zone=xi,this.modalController=Wi,this.alertController=Vi,this.logging=_i,this.mapDisplayed=!1,this.initialResultsShown=!1,this.searchOnDemand=!1,this.poiViewMode="modal",this.sideViewAvailable=!1,this.routePlanningMode=!0,this.searchKeyword="",this.appConfig=new te.X,this.defaultMapZoom=15,this.defaultStartPos=new ce.wC(37.415328,-122.076575),this._watchId=null,this.mapCanvasID="map-canvas",this.mapping.setMapType(yt.searchSettings.MapType),this.mapping.setMapAPI(H.N.defaultMapProvider),(0,Ge.R)(window,"resize").pipe(function(tn,en=ct){return yt=>yt.lift(new bt(tn,en))}(500)).subscribe(xn=>{let rn={width:ve.c.getClientHeight(),height:ve.c.getClientWidth()};this.events.publish("ocm:window:resized",[rn])})}ionViewDidEnter(){this.logging.log("Entered search page.",we.i.VERBOSE),this.mapping.focusMap(),this.mapping.updateMapSize()}ionViewWillLeave(){this.logging.log("Leaving search page.",we.i.VERBOSE),this.mapping.unfocusMap()}getPreferredMapHeight(yt){return null==yt&&(yt=ve.c.getClientHeight()),yt-56}enforceMapHeight(yt){this.logging.log("Would resize map:"+yt.width+" "+yt.height,we.i.VERBOSE),this.checkViewportMode();const Xt=this.getPreferredMapHeight(yt[0]);document.getElementById(this.mapCanvasID).offsetHeight!==Xt&&(document.getElementById(this.mapCanvasID).style.height=Xt+"px"),this.mapping&&(this.logging.log("Map height:"+Xt,we.i.VERBOSE),this.mapping.updateMapSize())}checkViewportMode(){}initialiseMapping(){var yt=this;return(0,f.Z)(function*(){yield yt.platform.ready(),yt.debouncedRefreshMapResults=ve.c.debounce(yt.refreshMapResults,1e3,!1),yt.events.subscribe("ocm:mapping:ready",(0,f.Z)(function*(){if(yt.logging.log("init map: mapping ready"),yt.mapping&&yt.mapping.updateMapSize(),!yt.initialResultsShown)if(yt.appManager.searchSettings.StartSearchPosition)yt.searchOnDemand=!0,yt.mapping.updateMapCentrePos(yt.appManager.searchSettings.StartSearchPosition.latitude,yt.appManager.searchSettings.StartSearchPosition.longitude,!0,yt.defaultMapZoom);else{let Xt=localStorage.getItem("_locationEnabled");1==yt.appManager.isEmbeddedMode&&"true"!=Xt?yield(yield yt.alertController.create({header:"Search using your location?",message:"Select OK to continue.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:(kn=(0,f.Z)(function*(An){yield yt.useFallbackPosition()}),function(mi){return kn.apply(this,arguments)})},{text:"OK",handler:function(){var kn=(0,f.Z)(function*(){yield yt.locateUser()});return function(){return kn.apply(this,arguments)}}()}]})).present():(yield yt.locateUser(),yt.mapping&&yt.mapping.updateMapSize())}var kn})),yt.events.subscribe("ocm:mapping:zoom",()=>{yt.debouncedRefreshMapResults()}),yt.events.subscribe("ocm:mapping:dragend",()=>{yt.debouncedRefreshMapResults()}),yt.events.subscribe("ocm:poiList:updated",Xt=>{yt.showPOIListOnMap(Xt)}),yt.events.subscribe("ocm:poiList:cleared",()=>{yt.mapping.clearMarkers(),setTimeout(()=>{yt.debouncedRefreshMapResults()},500)}),yt.events.subscribe("ocm:window:resized",Xt=>{null!=Xt&&Xt.length>0&&yt.enforceMapHeight(Xt[0])}),yt.events.subscribe("ocm:poi:selected",Xt=>{if(Xt.poi)yt.viewPOIDetails(Xt,Xt.poi);else{let cn=yt.getPOIByID(Xt.poiId);yt.viewPOIDetails(Xt,cn)}}),yt.checkViewportMode(),yt.mapping.initMap(yt.mapCanvasID)})()}ngAfterViewInit(){var yt=this;return(0,f.Z)(function*(){yield yt.initialiseMapping()})()}ngOnInit(){var yt=this;return(0,f.Z)(function*(){yt.logging.log("Refreshing reference data ..",we.i.VERBOSE),(yield yt.appManager.referenceDataManager.refreshReferenceData(yt.appManager.api))||(yt.appManager.isOffline=!0)})()}showPOIListOnMap(yt){const Xt=this.getPreferredMapHeight(null);this.mapping.refreshMapView(Xt,this.poiManager.poiList,null),this.mapDisplayed||(this.mapDisplayed=!0)}getIconForPOI(yt){return ve.c.getIconForPOI(yt)}getPOIByID(yt){const Xt=this.poiManager.poiList;for(let cn=0;cn<Xt.length;cn++)if(Xt[cn].ID===yt)return Xt[cn];return null}refreshMapResults(){var yt=this;return(0,f.Z)(function*(){if(!yt.searchOnDemand)return void yt.logging.log("Skipping refresh, search on demand disabled..",we.i.VERBOSE);yt.logging.log("Refreshing Results..",we.i.VERBOSE);const Xt=new me.b;let cn=null;if(yt.appManager.searchSettings.StartSearchPosition&&(cn=new ce.jR(yt.appManager.searchSettings.StartSearchPosition.latitude,yt.appManager.searchSettings.StartSearchPosition.longitude),yt.appManager.searchSettings.StartSearchPosition=null),cn&&0==cn.coords.latitude&&0==cn.coords.longitude)return void yt.logging.log("Map center is zero. No query will be performed",we.i.WARNING);if(null!=cn)Xt.latitude=cn.coords.latitude,Xt.longitude=cn.coords.longitude,Xt.distance=25,Xt.boundingbox=null,yt.appManager.searchSettings.LastSearchPosition=new ce.wC(cn.coords.latitude,cn.coords.longitude);else{Xt.latitude=null,Xt.longitude=null;let An=yield yt.mapping.getMapBounds().toPromise();Xt.boundingbox="("+An[0].latitude+","+An[0].longitude+"),("+An[1].latitude+","+An[1].longitude+")",yt.logging.log(JSON.stringify(An),we.i.VERBOSE)}Xt.includeComments=!0,Xt.enableCaching=!0,null!=yt.appManager.searchSettings&&(null!=yt.appManager.searchSettings.ConnectionTypeList&&(Xt.connectionTypeIdList=yt.appManager.searchSettings.ConnectionTypeList),null!=yt.appManager.searchSettings.UsageTypeList&&(Xt.usageTypeIdList=yt.appManager.searchSettings.UsageTypeList),null!=yt.appManager.searchSettings.StatusTypeList&&(Xt.statusTypeIdList=yt.appManager.searchSettings.StatusTypeList),null!=yt.appManager.searchSettings.OperatorList&&(Xt.operatorIdList=yt.appManager.searchSettings.OperatorList),null!=yt.appManager.searchSettings.MinPowerKW&&yt.appManager.searchSettings.MinPowerKW>0&&(Xt.minPowerKW=yt.appManager.searchSettings.MinPowerKW),null!=yt.appManager.searchSettings.MaxPowerKW&&yt.appManager.searchSettings.MaxPowerKW>0&&(Xt.maxPowerKW=yt.appManager.searchSettings.MaxPowerKW),null!=yt.journeyManager.getRoutePolyline()&&(Xt.polyline=yt.journeyManager.getRoutePolyline(),Xt.boundingbox=null,Xt.levelOfDetail=null,Xt.latitude=null,Xt.longitude=null)),yt.appManager.isRequestInProgress=!0;let kn=yield yt.poiManager.refreshPOIList(Xt);yt.appManager.isRequestInProgress=!1,yt.initialResultsShown=!0,kn>=Xt.maxResults&&yt.appManager.showToastNotification("A maximum of "+kn+" results are returned per search. Zoom in for details.")})()}viewPOIDetails(yt,Xt){this.logging.log("Viewing/fetching ["+this.poiViewMode+"] POI Details "+yt.poiId),null!=Xt?(this.mapping.unfocusMap(),this.modalController.create({component:ne.H,componentProps:{item:Xt}}).then(cn=>{cn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),cn.present()})):this.poiManager.getPOIById(yt.poiId,!0).then(cn=>{this.logging.log("Got POI Details "+cn.ID),"modal"===this.poiViewMode&&(this.searchOnDemand=!1,this.modalController.create({component:ne.H,componentProps:{item:cn}}).then(kn=>{kn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),kn.present()}),this.mapping.unfocusMap()),"side"===this.poiViewMode&&(this.selectedPOI=cn)},cn=>{this.appManager.showToastNotification("POI Details not available")})}closePOIDetails(){this.selectedPOI=null}openRoutePlannerModal(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:G.u}).then(yt=>{yt.onDidDismiss().then(Xt=>{this.logging.log("Dismissing Route Planner Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),yt.present()})}openSearchOptions(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:K.N}).then(yt=>{yt.onDidDismiss().then(Xt=>{this.mapping.focusMap(),this.searchOnDemand=!0}),yt.present()})}openSideView(){this.poiViewMode="side",this.mapping.updateMapSize()}closeSideView(){this.poiViewMode="modal",this.mapping.updateMapSize()}planRoute(){this.routePlanningMode=!0}search(yt){this.placeSearchMapPOI.getPlacesAutoComplete(yt,"poiSearch")}useFallbackPosition(){let yt=this.defaultStartPos;null!=this.appManager.searchSettings.LastSearchPosition&&(yt=this.appManager.searchSettings.LastSearchPosition),this.appManager.searchSettings.StartSearchPosition=yt,this.appManager.searchSettings.LastSearchPosition=null,this.searchOnDemand=!0,this.mapping.updateMapCentrePos(yt.latitude,yt.longitude,!0,this.defaultMapZoom)}getPosition(yt={}){var Xt=this;return(0,f.Z)(function*(){return new Promise((cn,kn)=>{Xt._watchId=bn.watchPosition(yt,(An,mi)=>{bn.clearWatch({id:Xt._watchId}),mi?kn(mi):cn(An)})})})()}locateUser(){var yt=this;return(0,f.Z)(function*(){try{yt.logging.log("Attempting to locate user..");const Xt=yield yt.getPosition();if(!Xt)throw"Failed to get user location.";return yt.logging.log("Got user location."),yt.appManager.searchSettings.StartSearchPosition=new ce.wC(Xt.coords.latitude,Xt.coords.longitude),yt.searchOnDemand=!0,yt.mapping.updateMapCentrePos(Xt.coords.latitude,Xt.coords.longitude,!0,yt.defaultMapZoom),localStorage.setItem("_locationEnabled","true"),!0}catch(Xt){return yt.logging.log("Failed to get user location. Searching using default or last position."+Xt),yt.appManager.showToastNotification("Your location could not be determined."),yt.useFallbackPosition(),!1}})()}placeSelected(yt){this.searchKeyword=yt.Address,this.logging.log("Got place details:"+yt.Address),this.mapping.focusMap(),this.mapping.updateMapCentrePos(yt.Location.latitude,yt.Location.longitude,!0),this.debouncedRefreshMapResults()}}return tn.\u0275fac=function(yt){return new(yt||tn)(Nt.Y36(Te.c),Nt.Y36(P.SH),Nt.Y36(Bt.z),Nt.Y36(d.sK),Nt.Y36(P.t4),Nt.Y36(Ae.R),Nt.Y36(Ne.v),Nt.Y36(ze.i),Nt.Y36(Nt.R0b),Nt.Y36(P.IN),Nt.Y36(P.Br),Nt.Y36(we.z))},tn.\u0275cmp=Nt.Xpm({type:tn,selectors:[["ng-component"]],viewQuery:function(yt,Xt){if(1&yt&&Nt.Gf(He.v,7),2&yt){let cn;Nt.iGM(cn=Nt.CRH())&&(Xt.placeSearchMapPOI=cn.first)}},decls:18,vars:10,consts:[["slot","start"],["autocapitalize","on","autocomplete","on",3,"ngModel","placeholder","debounce","ngModelChange","ionInput"],["slot","end"],[3,"click"],["name","locate","slot","start",4,"ngIf"],[4,"ngIf"],[3,"color","click"],["name","options","slot","end"],[3,"click",4,"ngIf"],[1,"search-page"],[3,"placeChanged"],["placeSearchMapPOI",""],["id","map-canvas",2,"height","100%","width","100%","min-height","300px"],["name","locate","slot","start"],["name","car","title","Route","slot","end"],[2,"position","absolute"]],template:function(yt,Xt){1&yt&&(Nt.TgZ(0,"ion-header"),Nt.TgZ(1,"ion-toolbar"),Nt.TgZ(2,"ion-buttons",0),Nt._UZ(3,"ion-menu-button"),Nt.qZA(),Nt.TgZ(4,"ion-searchbar",1),Nt.NdJ("ngModelChange",function(kn){return Xt.searchKeyword=kn})("ionInput",function(kn){return Xt.search(kn)}),Nt.ALo(5,"translate"),Nt.qZA(),Nt.TgZ(6,"ion-buttons",2),Nt.TgZ(7,"ion-button",3),Nt.NdJ("click",function(){return Xt.locateUser()}),Nt.YNc(8,Mt,1,0,"ion-icon",4),Nt.YNc(9,Kt,1,0,"ion-spinner",5),Nt.qZA(),Nt.TgZ(10,"ion-button",6),Nt.NdJ("click",function(){return Xt.openSearchOptions()}),Nt._UZ(11,"ion-icon",7),Nt.qZA(),Nt.YNc(12,Ot,2,0,"ion-button",8),Nt.qZA(),Nt.qZA(),Nt.qZA(),Nt.TgZ(13,"ion-content",9),Nt.TgZ(14,"place-search",10,11),Nt.NdJ("placeChanged",function(kn){return Xt.placeSelected(kn)}),Nt.qZA(),Nt.YNc(16,Ft,4,0,"ng-container",5),Nt._UZ(17,"div",12),Nt.qZA()),2&yt&&(Nt.xp6(4),Nt.Q6J("ngModel",Xt.searchKeyword)("placeholder",Nt.lcZ(5,8,"ocm.search.performSearch"))("debounce",500),Nt.xp6(4),Nt.Q6J("ngIf",!Xt.appManager.isRequestInProgress),Nt.xp6(1),Nt.Q6J("ngIf",Xt.appManager.isRequestInProgress),Nt.xp6(1),Nt.Q6J("color",Xt.appManager.searchSettings.HasActiveFilters?"danger":"default"),Nt.xp6(2),Nt.Q6J("ngIf",1==Xt.sideViewAvailable&&"modal"==Xt.poiViewMode),Nt.xp6(4),Nt.Q6J("ngIf",Xt.appManager.isOffline))},directives:[P.Gu,P.sr,P.Sm,P.fG,P.VI,P.j9,l.JJ,l.On,P.YG,Y.O5,P.gu,P.W2,He.v,P.PQ],pipes:[d.X$],styles:[".search-page[_ngcontent-%COMP%]   #map-canvas[_ngcontent-%COMP%]{width:100%;height:98%}.search-page[_ngcontent-%COMP%]   #place-search[_ngcontent-%COMP%]{min-height:300px;background-color:#f0f0f0;position:absolute;z-index:100;width:100%}.search-page[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{flex:.4}.search-page[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0}.search-page[_ngcontent-%COMP%]   scroll-content[_ngcontent-%COMP%]{overflow-y:hidden}.search-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{padding-left:2em}.search-page[_ngcontent-%COMP%]   .sideview[_ngcontent-%COMP%]{background:#eeeeee;background:linear-gradient(to bottom,#eeeeee 0%,white 100%)}"]}),tn})(),nn=(()=>{class tn{}return tn.\u0275fac=function(yt){return new(yt||tn)},tn.\u0275mod=Nt.oAB({type:tn}),tn.\u0275inj=Nt.cJS({imports:[[Y.ez,l.u5,P.Pc,d.aw,x.e,O.Bz.forChild([{path:"",component:ln}])]]}),tn})()},2619:(yn,je,N)=>{"use strict";N.d(je,{N:()=>Ge});var x=N(4553),d=N(6158),Y=N(8615),l=N(8076),P=N(2022),O=N(8616),f=N(865),H=N(5966),te=N(9101),K=N(6019),G=N(9133),ne=N(1586);let ce=(()=>{class Fe extends ne.X${constructor(Qe,et){super(Qe,et)}transform(Qe,...et){let ct=super.transform(Qe,...et);return ct==Qe?null!=et&&et[0].default?et[0].default:et[0].Title?et[0].Title:ct:ct}}return Fe.\u0275fac=function(Qe){return new(Qe||Fe)(f.Y36(ne.sK,16),f.Y36(f.sBO,16))},Fe.\u0275pipe=f.Yjl({name:"nullableTranslate",type:Fe,pure:!0}),Fe.\u0275prov=f.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();function me(Fe,E){if(1&Fe){const Qe=f.EpF();f.TgZ(0,"p",21),f._UZ(1,"ion-icon",22),f._uU(2," One or more filters are currently being applied. "),f.TgZ(3,"ion-button",23),f.NdJ("click",function(){return f.CHM(Qe),f.oxw().clearFilters()}),f._UZ(4,"ion-icon",24),f.TgZ(5,"ion-label"),f._uU(6,"Clear"),f.qZA(),f.qZA(),f.qZA()}}function ve(Fe,E){if(1&Fe&&(f.TgZ(0,"ion-select-option",26),f._uU(1),f.qZA()),2&Fe){const Qe=E.$implicit;f.Q6J("value",Qe.ID),f.xp6(1),f.Oqu(Qe.Title)}}function we(Fe,E){if(1&Fe){const Qe=f.EpF();f.TgZ(0,"ion-item"),f.TgZ(1,"ion-label"),f._uU(2),f.ALo(3,"translate"),f.qZA(),f.TgZ(4,"ion-select",14),f.NdJ("ngModelChange",function(ct){return f.CHM(Qe),f.oxw().searchSettings.FilterOptionsByCountryId=ct})("ionChange",function(){return f.CHM(Qe),f.oxw().onCountryChange()}),f.TgZ(5,"ion-select",25),f._uU(6,"(All Countries)"),f.qZA(),f.YNc(7,ve,2,2,"ion-select-option",4),f.qZA(),f.qZA()}if(2&Fe){const Qe=f.oxw();f.xp6(2),f.Oqu(f.lcZ(3,3,"ocm.search.countries")),f.xp6(2),f.Q6J("ngModel",Qe.searchSettings.FilterOptionsByCountryId),f.xp6(3),f.Q6J("ngForOf",Qe.countries)}}function ze(Fe,E){if(1&Fe&&(f.TgZ(0,"ion-select-option",26),f._uU(1),f.ALo(2,"nullableTranslate"),f.qZA()),2&Fe){const Qe=E.$implicit;f.Q6J("value",Qe.ID),f.xp6(1),f.Oqu(f.xi3(2,2,"ocm.reference.operatorInfo.value_"+Qe.ID,Qe))}}function Ne(Fe,E){if(1&Fe&&(f.TgZ(0,"ion-select-option",26),f._uU(1),f.ALo(2,"nullableTranslate"),f.qZA()),2&Fe){const Qe=E.$implicit;f.Q6J("value",Qe.ID),f.xp6(1),f.Oqu(f.xi3(2,2,"ocm.reference.usageType.value_"+Qe.ID,Qe))}}function Ae(Fe,E){if(1&Fe&&(f.TgZ(0,"ion-select-option",26),f._uU(1),f.ALo(2,"nullableTranslate"),f.qZA()),2&Fe){const Qe=E.$implicit;f.Q6J("value",Qe.ID),f.xp6(1),f.Oqu(f.xi3(2,2,"ocm.reference.statusType.value_"+Qe.ID,Qe))}}function Te(Fe,E){if(1&Fe&&(f.TgZ(0,"ion-select-option",26),f._uU(1),f.ALo(2,"nullableTranslate"),f.qZA()),2&Fe){const Qe=E.$implicit;f.Q6J("value",Qe.ID),f.xp6(1),f.Oqu(f.xi3(2,2,"ocm.reference.connectionType.value_"+Qe.ID,Qe))}}function He(Fe,E){if(1&Fe&&(f.TgZ(0,"ion-select-option",26),f._uU(1),f.qZA()),2&Fe){const Qe=E.$implicit;f.Q6J("value",Qe.code),f.xp6(1),f.Oqu(Qe.title)}}let Ge=(()=>{class Fe{constructor(Qe,et,ct,gt,bt){this.appManager=Qe,this.poiManager=et,this.mapping=ct,this.modalController=gt,this.events=bt,this.maxPower=l.U,this.powerRange={lower:0,upper:this.maxPower},this._languages=[],this.searchSettings=Qe.searchSettings}ngOnInit(){var Qe=this;return(0,x.Z)(function*(){null!=Qe.searchSettings.MinPowerKW&&(Qe.powerRange.lower=Qe.searchSettings.MinPowerKW),null!=Qe.searchSettings.MaxPowerKW&&(Qe.powerRange.upper=Qe.searchSettings.MaxPowerKW),0==Qe.powerRange.upper&&(Qe.powerRange.upper=Qe.maxPower),Qe.appManager.analytics.viewEvent("Settings"),Qe.useFilteredOptions&&(yield Qe.onCountryChange())})()}get useFilteredOptions(){return this.searchSettings.FilterOptionsByCountryId>0}clearFilters(){this.searchSettings.ClearActiveFilters(),this.powerRange={lower:0,upper:this.maxPower},this.searchSettings.CheckForActiveFilters()}get operators(){return this.appManager.referenceDataManager.getNetworkOperators(this.useFilteredOptions)}get connectionTypes(){return this.appManager.referenceDataManager.getConnectionTypes(this.useFilteredOptions)}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes(this.useFilteredOptions)}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes(this.useFilteredOptions)}get countries(){return this.appManager.referenceDataManager.getCountries(this.useFilteredOptions)}get isCountryFilterFeatureEnabled(){return P.c.isFeatureEnabled("FILTER_OPTIONS_BY_COUNTRY")}get languages(){return this._languages.length>0||(this._languages=this.appManager.getLanguages()),this._languages}ionViewWillLeave(){null!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language),this.searchSettings.MinPowerKW=this.powerRange.lower,this.searchSettings.MaxPowerKW=this.powerRange.upper,1==this.searchSettings.MinPowerKW&&(this.searchSettings.MinPowerKW=null),this.searchSettings.MaxPowerKW==this.maxPower&&(this.searchSettings.MaxPowerKW=null),this.appManager.searchSettings=this.searchSettings,this.appManager.saveSearchSettings(),this.events.publish("ocm:poiList:cleared")}onLanguageChange(){null!=this.searchSettings.Language&&""!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language)}onCountryChange(){var Qe=this;return(0,x.Z)(function*(){Qe.appManager.referenceDataManager.refreshFilteredReferenceData(Qe.appManager.api,{CountryIds:[Qe.searchSettings.FilterOptionsByCountryId]})})()}onMapTypeChange(){var Qe=this;return(0,x.Z)(function*(){Qe.mapping.setMapType(Qe.searchSettings.MapType)})()}close(){this.modalController.dismiss()}}return Fe.\u0275fac=function(Qe){return new(Qe||Fe)(f.Y36(Y.c),f.Y36(d.R),f.Y36(O.v),f.Y36(H.IN),f.Y36(te.z))},Fe.\u0275cmp=f.Xpm({type:Fe,selectors:[["ng-component"]],decls:77,vars:38,consts:[[1,"settings-page","ion-padding"],["danger","",4,"ngIf"],[4,"ngIf"],["multiple","true","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["lines","none"],["dualKnobs","true","min","0","max","650","pin","true",3,"ngModel","ngModelChange"],["slot","start","size","small","name","flash"],["slot","end","name","flash"],["slot","start",2,"padding-top","0"],["type","number","min","0",2,"width","3em","border","none",3,"ngModel","max","ngModelChange"],["slot","end",2,"padding-top","0"],["type","number",2,"width","3em","border","none",3,"ngModel","max","min","ngModelChange"],["multiple","false",3,"ngModel","ngModelChange","ionChange"],["multiple","false","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange","ionChange"],["value","ROADMAP"],["value","SATELLITE"],[3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","close","slot","start"],["danger",""],["name","alert"],["size","small","color","light",3,"click"],["slot","start","name","close"],["value",""],[3,"value"]],template:function(Qe,et){1&Qe&&(f.TgZ(0,"ion-header"),f.TgZ(1,"ion-toolbar"),f.TgZ(2,"ion-title"),f._uU(3),f.ALo(4,"translate"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(5,"ion-content",0),f.TgZ(6,"h2"),f._uU(7,"Search Filters"),f.qZA(),f.TgZ(8,"p"),f._uU(9,"Note: Filters will remove usable charging locations from your search results if we do not have complete data (i.e Operator or Power Levels)."),f.qZA(),f.YNc(10,me,7,0,"p",1),f.TgZ(11,"ion-list"),f.YNc(12,we,8,5,"ion-item",2),f.TgZ(13,"ion-item"),f.TgZ(14,"ion-label"),f._uU(15),f.ALo(16,"translate"),f.qZA(),f.TgZ(17,"ion-select",3),f.NdJ("ngModelChange",function(gt){return et.searchSettings.OperatorList=gt}),f.YNc(18,ze,3,5,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(19,"ion-item"),f.TgZ(20,"ion-label"),f._uU(21),f.ALo(22,"translate"),f.qZA(),f.TgZ(23,"ion-select",3),f.NdJ("ngModelChange",function(gt){return et.searchSettings.UsageTypeList=gt}),f.YNc(24,Ne,3,5,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(25,"ion-item"),f.TgZ(26,"ion-label"),f._uU(27),f.ALo(28,"translate"),f.qZA(),f.TgZ(29,"ion-select",3),f.NdJ("ngModelChange",function(gt){return et.searchSettings.StatusTypeList=gt}),f.YNc(30,Ae,3,5,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(31,"ion-item"),f.TgZ(32,"ion-label"),f._uU(33),f.ALo(34,"translate"),f.qZA(),f.TgZ(35,"ion-select",3),f.NdJ("ngModelChange",function(gt){return et.searchSettings.ConnectionTypeList=gt}),f.YNc(36,Te,3,5,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(37,"ion-item",5),f.TgZ(38,"ion-range",6),f.NdJ("ngModelChange",function(gt){return et.powerRange=gt}),f.TgZ(39,"ion-icon",7),f._uU(40,"0"),f.qZA(),f._UZ(41,"ion-icon",8),f.qZA(),f.qZA(),f.TgZ(42,"ion-item",5),f.TgZ(43,"ion-note",9),f._uU(44,"Min. Power (kW)"),f._UZ(45,"br"),f.TgZ(46,"input",10),f.NdJ("ngModelChange",function(gt){return et.powerRange.lower=gt}),f.qZA(),f.qZA(),f.TgZ(47,"ion-note",11),f._uU(48,"Max. Power (kW)"),f._UZ(49,"br"),f.TgZ(50,"input",12),f.NdJ("ngModelChange",function(gt){return et.powerRange.upper=gt}),f.qZA(),f.qZA(),f.qZA(),f.qZA(),f.TgZ(51,"h2"),f._uU(52," General Settings "),f.qZA(),f.TgZ(53,"ion-item"),f.TgZ(54,"ion-label"),f._uU(55,"Language"),f.qZA(),f.TgZ(56,"ion-select",13),f.NdJ("ngModelChange",function(gt){return et.searchSettings.Language=gt})("ionChange",function(){return et.onLanguageChange()}),f.YNc(57,He,2,2,"ion-select-option",4),f.qZA(),f.qZA(),f.TgZ(58,"ion-item"),f.TgZ(59,"ion-label"),f._uU(60),f.ALo(61,"translate"),f.qZA(),f.TgZ(62,"ion-select",14),f.NdJ("ngModelChange",function(gt){return et.searchSettings.MapType=gt})("ionChange",function(){return et.onMapTypeChange()}),f.TgZ(63,"ion-select-option",15),f._uU(64,"Road Map"),f.qZA(),f.TgZ(65,"ion-select-option",16),f._uU(66,"Satellite"),f.qZA(),f.qZA(),f.qZA(),f.TgZ(67,"ion-item"),f.TgZ(68,"ion-label"),f._uU(69,"Enable Advanced Editor Options"),f.qZA(),f.TgZ(70,"ion-toggle",17),f.NdJ("ngModelChange",function(gt){return et.searchSettings.EnableAdvancedEditorFeatures=gt}),f.qZA(),f.qZA(),f.qZA(),f.TgZ(71,"ion-footer"),f.TgZ(72,"ion-toolbar"),f.TgZ(73,"ion-buttons",18),f.TgZ(74,"ion-button",19),f.NdJ("click",function(){return et.close()}),f._UZ(75,"ion-icon",20),f._uU(76," Close "),f.qZA(),f.qZA(),f.qZA(),f.qZA()),2&Qe&&(f.xp6(3),f.hij(" ",f.lcZ(4,26,"ocm.general.settings")," "),f.xp6(7),f.Q6J("ngIf",1==et.searchSettings.HasActiveFilters),f.xp6(2),f.Q6J("ngIf",et.isCountryFilterFeatureEnabled),f.xp6(3),f.Oqu(f.lcZ(16,28,"ocm.search.networkOperators")),f.xp6(2),f.Q6J("ngModel",et.searchSettings.OperatorList),f.xp6(1),f.Q6J("ngForOf",et.operators),f.xp6(3),f.Oqu(f.lcZ(22,30,"ocm.search.usageTypes")),f.xp6(2),f.Q6J("ngModel",et.searchSettings.UsageTypeList),f.xp6(1),f.Q6J("ngForOf",et.usageTypes),f.xp6(3),f.Oqu(f.lcZ(28,32,"ocm.search.operationalStatusTypes")),f.xp6(2),f.Q6J("ngModel",et.searchSettings.StatusTypeList),f.xp6(1),f.Q6J("ngForOf",et.statusTypes),f.xp6(3),f.Oqu(f.lcZ(34,34,"ocm.search.connectionTypes")),f.xp6(2),f.Q6J("ngModel",et.searchSettings.ConnectionTypeList),f.xp6(1),f.Q6J("ngForOf",et.connectionTypes),f.xp6(2),f.Q6J("ngModel",et.powerRange),f.xp6(8),f.Q6J("ngModel",et.powerRange.lower)("max",et.powerRange.upper),f.xp6(4),f.Q6J("ngModel",et.powerRange.upper)("max",et.maxPower)("min",et.powerRange.lower),f.xp6(6),f.Q6J("ngModel",et.searchSettings.Language),f.xp6(1),f.Q6J("ngForOf",et.languages),f.xp6(3),f.Oqu(f.lcZ(61,36,"ocm.details.location.map")),f.xp6(2),f.Q6J("ngModel",et.searchSettings.MapType),f.xp6(8),f.Q6J("ngModel",et.searchSettings.EnableAdvancedEditorFeatures))},directives:[H.Gu,H.sr,H.wd,H.W2,K.O5,H.q_,H.Ie,H.Q$,H.t9,H.QI,G.JJ,G.On,K.sg,H.I_,H.gu,H.uN,G.qQ,G.wV,G.Fd,G.Fj,H.n0,H.ho,H.w,H.fr,H.Sm,H.YG],pipes:[ne.X$,ce],encapsulation:2}),Fe})()},6378:(yn,je,N)=>{"use strict";N.r(je),N.d(je,{SignInModule:()=>te});var x=N(1486),d=N(5316),Y=N(1586),l=N(6019),P=N(9133),O=N(5966),f=N(5899),H=N(865);let te=(()=>{class K{}return K.\u0275fac=function(ne){return new(ne||K)},K.\u0275mod=H.oAB({type:K}),K.\u0275inj=H.cJS({imports:[[l.ez,P.u5,O.Pc,Y.aw,d.e,f.Bz.forChild([{path:"",component:x.F}])]]}),K})()},1486:(yn,je,N)=>{"use strict";N.d(je,{F:()=>K});var x=N(4553),d=N(6505),Y=N(8615),l=N(865),P=N(5966),O=N(1586),f=N(5899),H=N(6019),te=N(9133);let K=(()=>{class G{constructor(ce,me,ve,we,ze,Ne,Ae,Te){this.appManager=ce,this.modalController=me,this.translate=ve,this.alertController=we,this.loadingController=ze,this.logging=Ne,this.router=Ae,this.location=Te,this.email=""}cancelSignIn(){this.modalController.dismiss()}performSignIn(){var ce=this;return(0,x.Z)(function*(){const me=yield ce.loadingController.create({message:"Signing In.."});yield me.present();let ve=!1;try{yield ce.appManager.api.performSignIn(ce.email,ce.password),me.dismiss(),localStorage.setItem("authResponse",JSON.stringify(ce.appManager.api.authResponse)),ce.appManager.isUserAuthenticated(!0),ce.modalController.dismiss(),ce.appManager.analytics.appEvent("Profile","SignedIn")}catch(we){ve=!0,me.dismiss(),yield(yield ce.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),ce.logging.log("Error logging in:"+we)}})()}}return G.\u0275fac=function(ce){return new(ce||G)(l.Y36(Y.c),l.Y36(P.IN),l.Y36(O.sK),l.Y36(P.Br),l.Y36(P.HT),l.Y36(d.z),l.Y36(f.F0),l.Y36(H.Ye))},G.\u0275cmp=l.Xpm({type:G,selectors:[["ng-component"]],decls:37,vars:8,consts:[[1,"signin-page","ion-padding"],["item-left",""],["src","assets/images/icons/branding/AppIcon_128x128.png"],[1,"ion-padding"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"],[3,"click"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["type","submit","color","primary",3,"click"],["name","log-in","slot","start"]],template:function(ce,me){1&ce&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-title"),l._uU(3),l.ALo(4,"translate"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(5,"ion-content",0),l.TgZ(6,"ion-avatar",1),l._UZ(7,"img",2),l.qZA(),l.TgZ(8,"p",3),l._uU(9," Sign in using your Open Charge Map account. "),l.qZA(),l.TgZ(10,"ion-list"),l.TgZ(11,"ion-item"),l.TgZ(12,"ion-label",4),l._uU(13,"Email"),l.qZA(),l.TgZ(14,"ion-input",5),l.NdJ("ngModelChange",function(we){return me.email=we}),l.qZA(),l.qZA(),l.TgZ(15,"ion-item"),l.TgZ(16,"ion-label",4),l._uU(17,"Password"),l.qZA(),l.TgZ(18,"ion-input",6),l.NdJ("ngModelChange",function(we){return me.password=we}),l.qZA(),l.qZA(),l.qZA(),l.TgZ(19,"p"),l._uU(20,"or "),l.TgZ(21,"a",7),l.NdJ("click",function(){return me.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/register")}),l._uU(22,"Register as New User"),l.qZA(),l._uU(23," or "),l.TgZ(24,"a",7),l.NdJ("click",function(){return me.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/passwordreset")}),l._uU(25,"Reset your password"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(26,"ion-footer"),l.TgZ(27,"ion-toolbar"),l.TgZ(28,"ion-buttons",8),l.TgZ(29,"ion-button",7),l.NdJ("click",function(){return me.cancelSignIn()}),l._UZ(30,"ion-icon",9),l._uU(31," Cancel"),l.qZA(),l.qZA(),l.TgZ(32,"ion-buttons",10),l.TgZ(33,"ion-button",11),l.NdJ("click",function(){return me.performSignIn()}),l._UZ(34,"ion-icon",12),l._uU(35),l.ALo(36,"translate"),l.qZA(),l.qZA(),l.qZA(),l.qZA()),2&ce&&(l.xp6(3),l.hij(" ",l.lcZ(4,4,"ocm.general.signIn")," "),l.xp6(11),l.Q6J("ngModel",me.email),l.xp6(4),l.Q6J("ngModel",me.password),l.xp6(17),l.hij(" ",l.lcZ(36,6,"ocm.general.signIn"),""))},directives:[P.Gu,P.sr,P.wd,P.W2,P.BJ,P.q_,P.Ie,P.Q$,P.pK,P.j9,te.JJ,te.On,P.fr,P.Sm,P.YG,P.gu],pipes:[O.X$],encapsulation:2}),G})()},4537:(yn,je,N)=>{"use strict";N.d(je,{l:()=>H});var x=N(4553),d=N(6505),Y=N(2377),l=N(8026),P=N(4522),O=N(8260),f=N(865);let H=(()=>{class te{constructor(G,ne,ce){this.http=G,this.refData=ne,this.logging=ce,this.serviceBase="https://api.openchargemap.io",this.serviceBaseURL=this.serviceBase+"/v3",this.hasAuthorizationError=!1,this.ATTRIBUTION_METADATAFIELDID=4,this.clientName="ocm.api.default",this.allowMirror=!1,this.lastPOIApiCallURL="",this.serviceBaseURL=O.N.apiBase+"/v3"}getNumberListString(G){let ne="";for(let ce=0;ce<G.length;ce++)ne+=G[ce],ce<G.length&&(ne+=",");return ne}fetchPOIListByParam(G){var ne=this;return(0,x.Z)(function*(){const ce=ne.serviceBaseURL+"/poi/?client="+ne.clientName+(ne.allowMirror?" &allowmirror=true":"")+"&verbose=false&output=json";G.compact=!0;let me="";null!=G.countryCode&&(me+="&countrycode="+G.countryCode),null!=G.latitude&&(me+="&latitude="+G.latitude),null!=G.longitude&&(me+="&longitude="+G.longitude),null!=G.distance&&(me+="&distance="+G.distance),null!=G.distanceUnit&&(me+="&distanceunit="+G.distanceUnit),null!=G.includeComments&&(me+="&includecomments="+G.includeComments),null!=G.maxResults&&(me+="&maxresults="+G.maxResults),null!=G.countryIdList&&(me+="&countryid="+ne.getNumberListString(G.countryIdList)),null!=G.levelIdList&&(me+="&levelid="+ne.getNumberListString(G.levelIdList)),null!=G.connectionTypeIdList&&G.connectionTypeIdList.length>0&&(me+="&connectiontypeid="+ne.getNumberListString(G.connectionTypeIdList)),null!=G.operatorIdList&&G.operatorIdList.length>0&&(me+="&operatorid="+ne.getNumberListString(G.operatorIdList)),null!=G.usageTypeIdList&&G.usageTypeIdList.length>0&&(me+="&usagetypeid="+ne.getNumberListString(G.usageTypeIdList)),null!=G.statusTypeIdList&&G.statusTypeIdList.length>0&&(me+="&statustypeid="+ne.getNumberListString(G.statusTypeIdList)),null!=G.locationTitle&&(me+="&locationtitle="+G.locationTitle),null!=G.minPowerKW&&G.minPowerKW>0&&(me+="&minpowerkw="+G.minPowerKW),null!=G.maxPowerKW&&G.maxPowerKW>0&&(me+="&maxpowerkw="+G.maxPowerKW),null!=G.submissionStatusTypeIdList&&(me+="&submissionstatustypeid="+ne.getNumberListString(G.submissionStatusTypeIdList)),null!=G.poiIdList&&G.poiIdList.length>0&&(me+="&chargepointid="+ne.getNumberListString(G.poiIdList)),0==G.enableCaching&&(me+="&enablecaching=false"),null!=G.compact&&(me+="&compact="+G.compact),G.levelOfDetail>1&&(me+="&levelofdetail="+G.levelOfDetail),null!=G.polyline&&(me+="&polyline="+G.polyline),null!=G.boundingbox&&(me+="&boundingbox="+G.boundingbox),null!=G.additionalParams&&(me+="&"+G.additionalParams);const ve=ce+me;if(ne.lastPOIApiCallURL===ve&&0!=G.enableCaching)return ne.logging.log("Skipped API call due to same query being repeated."),[];ne.lastPOIApiCallURL=ve,ne.logging.log("API Call:"+ve,d.i.VERBOSE);try{let we=yield ne.http.get(ve,ne.getHttpRequestOptions()).toPromise();return ne.refData.hydrateCompactPOIList(we)}catch(we){const ze=we.message||"Could not fetch POI list from server.";throw ne.logging.log("API Client: "+JSON.stringify(we),d.i.ERROR),ze}})()}getHttpRequestOptions(G=!0){let ne=new P.WM;return G&&(ne=ne.append("Content-Type","application/json")),this.authResponse&&this.authResponse.Data&&this.authResponse.Data.access_token&&(ne=ne.append("Authorization","Bearer "+this.authResponse.Data.access_token)),ne=ne.append("X-API-Key",O.N.apiKey),{headers:ne}}fetchCoreReferenceData(G){let ne=this.serviceBaseURL+"/referencedata/?client="+this.clientName+"&output=json"+(this.allowMirror?"&allowmirror=true":"")+"&verbose=false&compact=true";return null!=G&&null!=G.CountryIds&&(ne+="&countryid="+this.getNumberListString(G.CountryIds)),this.logging.log("API Call:"+ne,d.i.VERBOSE),this.http.get(ne,this.getHttpRequestOptions())}performSignIn(G,ne){return this.http.post(this.serviceBaseURL+"/profile/authenticate/",JSON.stringify({emailaddress:G,password:ne}),this.getHttpRequestOptions()).toPromise().then(ve=>(this.authResponse=ve,this.authResponse))}performSubmission(G,ne){return G===l.q.POI?this.submitPOI(ne):G===l.q.Comment?this.submitUserComment(ne):G===l.q.Media?this.submitMediaItem(ne):void 0}submitUserComment(G){const ne=JSON.stringify(G);return this.logging.log("[api] Submitting user comment"),this.http.post(this.serviceBaseURL+"/comment/",ne,this.getHttpRequestOptions()).toPromise()}submitMediaItem(G){const ne=JSON.stringify(G);return this.http.post(this.serviceBaseURL+"/mediaitem/",ne,this.getHttpRequestOptions()).toPromise()}submitPOI(G){const ne=JSON.stringify(G);return this.http.post(this.serviceBaseURL+"/poi/",ne,this.getHttpRequestOptions()).toPromise()}getPanoramioLocationPhotos(G){return new Promise(ne=>{const ce=.001,me="https://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=2&minx="+(G.longitude-ce)+"&miny="+(G.latitude-ce)+"&maxx="+(G.longitude+ce)+"maxy="+(G.latitude+ce)+"&size=medium&mapfilter=true&callback=?";return console.log(me),this.http.get(me).toPromise()})}fetchReverseGeocodeResult(G,ne){return this.http.get(this.serviceBaseURL+"/geocode/?client="+this.clientName+"&output=json&camelcase=false&latitude="+G+"&longitude="+ne,this.getHttpRequestOptions()).toPromise()}isLocalStorageAvailable(){return void 0!==window.localStorage}setCachedDataObject(G,ne){this.isLocalStorageAvailable()&&(void 0===ne&&(ne=null),null===ne?localStorage.removeItem(G):localStorage.setItem(G,JSON.stringify(ne)))}getCachedDataObject(G){if(this.isLocalStorageAvailable()){const ne=localStorage.getItem(G);if(null!=ne&&ne.length>0)return JSON.parse(ne)}return null}}return te.\u0275fac=function(G){return new(G||te)(f.LFG(P.eN),f.LFG(Y.W),f.LFG(d.z))},te.\u0275prov=f.Yz7({token:te,factory:te.\u0275fac,providedIn:"root"}),te})()},6136:(yn,je,N)=>{"use strict";N.d(je,{c:()=>P});var x=N(4553),d=N(6505),Y=N(865),l=N(5966);let P=(()=>{class O{constructor(H,te){this.logger=H,this.platform=te,this.isCordova=!1,this.ga=null,this.isCordova=!(!te.is("cordova")&&!te.is("capacitor"))}init(H){var te=this;return(0,x.Z)(function*(){te.isCordova&&te.ga?yield te.ga.startTrackerWithId(H):te.logger.log("Could not initialise analytics")})()}setAppVersion(H){var te=this;return(0,x.Z)(function*(){if(te.isCordova&&te.ga)return te.ga.setAppVersion(H);te.logger.log(H)})()}appEvent(H,te){var K=this;return(0,x.Z)(function*(){if(K.isCordova&&K.ga)return K.ga.trackEvent(H,te);K.logger.log(te)})()}viewEvent(H){var te=this;return(0,x.Z)(function*(){if(te.isCordova&&te.ga)return te.ga.trackView(H);te.logger.log(H)})()}}return O.\u0275fac=function(H){return new(H||O)(Y.LFG(d.z),Y.LFG(l.t4))},O.\u0275prov=Y.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},8615:(yn,je,N)=>{"use strict";N.d(je,{c:()=>Ae});var x=N(4553),d=N(6505),Y=N(4537),l=N(8076),P=N(9206),O=N(8026),f=N(2377),H=N(2840),te=N(6136),K=N(8260),G=N(865),ne=N(4522),ce=N(9101);class me{constructor(He,Ge){this.SubmissionType=He,this.Data=Ge,this.DateQueued=new Date,this.IsSubmitted=!1,this.IsInProgress=!1,this.IsCancelled=!1,this.IsFailure=!1,this.Attempts=0,this.ID=new Date+"_"+100*Math.random()}}let ve=(()=>{class Te{constructor(Ge){this.events=Ge,this.isQueueProcessing=!1}setAppManager(Ge){this.appManager=Ge}add(Ge,Fe){let E=this.getQueueItems();E.push(new me(Ge,Fe)),this.saveQueueItems(E)}update(Ge){let Fe=this.getQueueItems(),E=new Array;return Fe.forEach(Qe=>{E.push(Qe.ID==Ge.ID?Ge:Qe)}),E}processNextQueueItem(){let Ge=this.getNextQueueItem();null!=Ge&&null!=this.appManager&&this.appManager.api.performSubmission(Ge.SubmissionType,Ge.Data).then(()=>{Ge.IsSubmitted=!0,Ge.Attempts++,this.update(Ge),this.clear()})}getNextQueueItem(){let Ge=this.getQueueItems(),Fe=null;return Ge.forEach(E=>{null==Fe&&!E.IsCancelled&&!E.IsInProgress&&!E.IsSubmitted&&(Fe=E)}),Fe}hasPendingItems(){let Ge=!1;return this.getQueueItems().forEach(E=>{!E.IsFailure&&!E.IsCancelled&&!E.IsSubmitted&&(Ge=!0)}),Ge}isCompleted(){let Ge=this.getQueueItems(),Fe=!0;return Ge.forEach(E=>{(E.IsInProgress||E.IsFailure)&&(Fe=!1)}),Fe}clear(Ge=!1){let Fe=this.getQueueItems(),E=new Array;Ge||Fe.forEach(Qe=>{(Qe.IsInProgress||Qe.IsFailure)&&E.push(Qe)}),this.saveQueueItems(E)}saveQueueItems(Ge){localStorage.setItem("submissionQueue",JSON.stringify(Ge))}getQueueItems(){let Ge=localStorage.getItem("submissionQueue");return null!=Ge?JSON.parse(Ge):new Array}}return Te.\u0275fac=function(Ge){return new(Ge||Te)(G.LFG(ce.z))},Te.\u0275prov=G.Yz7({token:Te,factory:Te.\u0275fac,providedIn:"root"}),Te})();var we=N(5966),ze=N(1586),Ne=N(6417);let Ae=(()=>{class Te{constructor(Ge,Fe,E,Qe,et,ct,gt,bt,ut,St,Vt,bn,Nt){this.http=Ge,this.events=Fe,this.api=E,this.submissionQueue=Qe,this.platform=et,this.referenceDataManager=ct,this.journeyManager=gt,this.translateService=bt,this.toastController=ut,this.loadingController=St,this.jwtHelper=Vt,this.logging=bn,this.analytics=Nt,this.isRequestInProgress=!1,this.title="Open Charge Map",this._isUserAuthenticated=null,this.isEmbeddedMode=!1,this.isOffline=!1,this.api.clientName="ocm.app.ionic."+K.N.version,this.isDebugMode=!1,this.enableSubmissionQueue=!1,this.submissionQueue.setAppManager(this),this.platformMode=et.is("cordova")?"cordova":"web",this.initAppManager(),this.searchSettings=new l.N,this.loadSearchSettings(),this.applyURLQueryStringOptions(),this.searchSettings.CheckForActiveFilters(),this.journeyManager.loadJourneys()}loadSearchSettings(){if(null!=localStorage.getItem("searchSettings")){this.searchSettings=new l.N;try{let Ge=JSON.parse(localStorage.getItem("searchSettings"));Object.assign(this.searchSettings,Ge)}catch{}}}savePushRegistration(Ge){localStorage.setItem("_pushToken",Ge.toString())}getPushRegistration(){localStorage.getItem("_pushToken")}getQueryVariable(Ge){let E=window.location.search.substring(1).split("&");for(let Qe=0;Qe<E.length;Qe++){let et=E[Qe].split("=");if(decodeURIComponent(et[0])==Ge)return et[1].split(",").map(bt=>decodeURIComponent(bt))}return null}applyURLQueryStringOptions(){if(this.getQueryVariable("mode")&&"embedded"==this.getQueryVariable("mode")[0]&&(this.isEmbeddedMode=!0),this.getQueryVariable("operatorid")){let Ge=this.getQueryVariable("operatorid");for(let Fe of Ge)this.searchSettings.OperatorList.unshift(parseInt(Fe,10))}if(this.getQueryVariable("latitude")&&this.getQueryVariable("longitude")){let Ge=this.getQueryVariable("latitude")[0],Fe=this.getQueryVariable("longitude")[0];this.searchSettings.StartSearchPosition=new P.wC(parseFloat(Ge),parseFloat(Fe))}this.getQueryVariable("title")&&(this.title=this.getQueryVariable("title")[0]),this.getQueryVariable("languagecode")&&this.setLanguage(this.getQueryVariable("languagecode")[0])}saveSearchSettings(){this.searchSettings.CheckForActiveFilters(),localStorage.setItem("searchSettings",JSON.stringify(this.searchSettings))}getLanguages(){return[{code:"ar",title:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 / Arabic"},{code:"bg",title:"Bulgarian / \u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",title:"Czech / \u010ce\u0161tina"},{code:"de",title:"German / Deutsch"},{code:"el",title:"Greek / \u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ae"},{code:"en",title:"English"},{code:"es",title:"Spanish / Espa\xf1ol"},{code:"et",title:"Estonian / Eesti"},{code:"fi",title:"Finnish / Suomi"},{code:"fr",title:"French / Fran\xe7ais"},{code:"fy",title:"West Frisian / Frysk"},{code:"hu",title:"Hungarian / Magyar"},{code:"it",title:"Italian / Italiano"},{code:"ja",title:"Japanese / \u65e5\u672c\u8a9e"},{code:"lt",title:"Lithuanian / Lietuvi\u0173"},{code:"nl",title:"Dutch / Nederlands"},{code:"pt",title:"Portuguese / portugu\xeas"},{code:"ru",title:"Russian / P\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sk",title:"Slovak / Sloven\u010dina"},{code:"tr",title:"Turkish / T\xfcrk\xe7e"},{code:"zh",title:"Chinese / \u4e2d\u56fd\u7684"}]}setLanguage(Ge){(null==Ge||""==Ge)&&(Ge="en"),this.logging.log("Changing language: "+Ge),this.translateService.use(Ge)}initAppManager(){this.initAuthFromStorage(),this.isUserAuthenticated(!0)&&this.enableSubmissionQueue&&null!=this.submissionQueue&&this.submissionQueue.hasPendingItems()&&this.submissionQueue.processNextQueueItem()}initAuthFromStorage(){let Ge=localStorage.getItem("authResponse");if(null!=Ge){let Fe=JSON.parse(Ge);null!=Fe.Data&&null!=Fe.Data.access_token&&(this.jwtHelper.decodeToken(Fe.Data.access_token),this.jwtHelper.isTokenExpired(Fe.Data.access_token)?localStorage.removeItem("authResponse"):(this.api.authResponse=Fe,this.logging.log("User has valid auth token in local storage",d.i.VERBOSE)))}}isUserAuthenticated(Ge=!1){return!1===Ge&&null!=this._isUserAuthenticated||(this._isUserAuthenticated=!1,null!=this.api.authResponse&&(this.jwtHelper.isTokenExpired(this.api.authResponse.Data.access_token)||(this._isUserAuthenticated=!0))),this._isUserAuthenticated}getCurrentAuthToken(){return null!=this.api.authResponse?this.api.authResponse.Data.access_token:null}getUserProfile(){return null!=this.api.authResponse?this.api.authResponse.Data.UserProfile:null}signOutCurrentUser(){localStorage.removeItem("authResponse"),this.api.authResponse=null,this._isUserAuthenticated=!1}submitComment(Ge){if(!this.enableSubmissionQueue)return this.api.performSubmission(O.q.Comment,Ge);this.submissionQueue.add(O.q.Comment,Ge),this.submissionQueue.processNextQueueItem()}submitMediaItem(Ge){if(!this.enableSubmissionQueue)return this.api.performSubmission(O.q.Media,Ge);this.submissionQueue.add(O.q.Media,Ge),this.submissionQueue.processNextQueueItem()}submitPOI(Ge){if(!this.enableSubmissionQueue)return this.api.performSubmission(O.q.POI,Ge);this.submissionQueue.add(O.q.POI,Ge),this.submissionQueue.processNextQueueItem()}showToastNotification(Ge){var Fe=this;return(0,x.Z)(function*(){yield(yield Fe.toastController.create({message:Ge,duration:3e3})).present()})()}showLoadingProgress(Ge){var Fe=this;return(0,x.Z)(function*(){yield(yield Fe.loadingController.create({message:Ge})).present()})()}dismissLoadingProgress(){var Ge=this;return(0,x.Z)(function*(){return Ge.loadingController.dismiss()})()}launchOCMWebPage(Ge){this.isUserAuthenticated(!0)&&(-1===Ge.indexOf("?")&&(Ge+="?"),Ge+="&auth="+this.getCurrentAuthToken()),Ge="https://openchargemap.org/site"+Ge,window.open(Ge,"_system")}launchWebPage(Ge){window.open(Ge,"_system")}isPlatform(Ge){return this.platform.is(Ge)}}return Te.\u0275fac=function(Ge){return new(Ge||Te)(G.LFG(ne.eN),G.LFG(ce.z),G.LFG(Y.l),G.LFG(ve),G.LFG(we.t4),G.LFG(f.W),G.LFG(H.i),G.LFG(ze.sK),G.LFG(we.yF),G.LFG(we.HT),G.LFG(Ne.N0),G.LFG(d.z),G.LFG(te.c))},Te.\u0275prov=G.Yz7({token:Te,factory:Te.\u0275fac,providedIn:"root"}),Te})()},9101:(yn,je,N)=>{"use strict";N.d(je,{z:()=>d});var x=N(865);let d=(()=>{class Y{constructor(){this.c=new Map}subscribe(P,...O){let f=this.c.get(P);f||this.c.set(P,f=[]),f.push(...O)}unsubscribe(P,O){if(!O)return this.c.delete(P);const f=this.c.get(P);if(!f)return!1;const H=f.indexOf(O);return!(H<0||(f.splice(H,1),0===f.length&&this.c.delete(P),0))}publish(P,...O){const f=this.c.get(P);return f?f.map(H=>{try{return H(...O)}catch(te){return console.error(te),null}}):null}}return Y.\u0275fac=function(P){return new(P||Y)},Y.\u0275prov=x.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"}),Y})()},2840:(yn,je,N)=>{"use strict";N.d(je,{i:()=>H});var x=N(6505),d=N(4537),Y=N(6158),l=N(1058),P=N(6520),O=N(9206),f=N(865);let H=(()=>{class te{constructor(G,ne,ce){this.api=G,this.poiManager=ne,this.logging=ce,this.journeys=[],this.favourites=[]}loadJourneys(){let G=localStorage.getItem("journeys");if(null!=G&&(this.journeys=JSON.parse(G)),null!=this.journeys)for(let ne of this.journeys)this.fetchAllJourneyPOIDetails(ne)}fetchAllJourneyPOIDetails(G){this.logging.log("Journeys - fetching poi details for Journey "+G.Title);let ne=new l.b;ne.poiIdList=[];for(let ce of G.Stages)for(let me of ce.WayPoints)for(let ve of me.PoiIDs)ne.poiIdList.push(ve);this.api.fetchPOIListByParam(ne).then(ce=>{for(let me of ce)this.updateStoredPOI(me)})}updateStoredPOI(G){if(this.journeys.forEach(ne=>{ne.Stages.forEach(ce=>{ce.WayPoints.forEach(me=>{me.PoiIDs.forEach(ve=>{if(ve==G.ID)if(null==me.PoiList){me.PoiList=[];let we=new P.Qp("charging",1);we.Poi=G,we.PoiID=G.ID,me.PoiList.push(we)}else for(let we of me.PoiList)we.PoiID==G.ID&&(we.Poi=G)})})})}),null!=this.favourites)for(let ne of this.favourites)"charging"==ne.Type&&ne.PoiID==G.ID&&(ne.Poi=G)}saveJourneys(){let G=JSON.parse(JSON.stringify(this.journeys));for(let ce of G)for(const me of ce.Stages)for(let ve of me.WayPoints)for(let we of ve.PoiList)we.Poi=null,we.Photos=null;const ne=JSON.stringify(G);localStorage.setItem("journeys",ne)}addJourney(G,ne){let ce=new P.vw;ce.Title="Stage 1",null!=ne&&ce.WayPoints.push(ne),G.Stages.push(ce),this.journeys.push(G)}deleteJourney(G){this.journeys=this.journeys.filter(ne=>ne.ID!=G),this.saveJourneys()}getJourney(G){let ne=this.journeys.filter(ce=>ce.ID==G);return ne.length>0?ne[0]:null}getJourneyStages(G){return this.getJourney(G).Stages}addJourneyWaypoint(G,ne,ce){let me=this.getJourney(G);if(null==ne){let ve=new P.vw;ve.Title="Stage "+(me.Stages.length+1),ve.WayPoints.push(ce),me.Stages.push(ve)}else{let ve=me.Stages[ne];null==ve.WayPoints&&(ve.WayPoints=[]),ve.WayPoints.push(ce)}}addJourneyStage(G,ne){return this.getJourney(G).Stages.push(ne)-1}setupTestJourneys(){this.journeys=[];let G=new P.fw;G.Title="New York to Brooklyn",G.Notes="A little jaunt to Brooklyn",G.Stages=[];let ne=new P.vw,ce=new P.kA;ce.Notes="Starting point",ce.Position=new O.wC(40,1.2),ce.Title="Start",ne.WayPoints.push(ce);let me=new P.kA;me.Notes="Middle point",me.Position=new O.wC(40,1.33),me.Title="Middle",ne.WayPoints.push(me);let ve=new P.kA;ve.Notes="End point",ve.Position=new O.wC(40,1.33),ve.Title="End",ne.WayPoints.push(ve),G.Stages.push(ne),this.journeys.push(G);let we=new P.fw;we.Title="Aberdeen to London",we.Notes="Roadtrip",we.Stages=[],this.journeys.push(we)}calculateEnergyConsumptionkWh(G,ne,ce=0,me){return G*me}setRoutePolyline(G){this.routePolyline=G}getRoutePolyline(){return this.routePolyline}}return te.\u0275fac=function(G){return new(G||te)(f.LFG(d.l),f.LFG(Y.R),f.LFG(x.z))},te.\u0275prov=f.Yz7({token:te,factory:te.\u0275fac,providedIn:"root"}),te})()},6505:(yn,je,N)=>{"use strict";N.d(je,{i:()=>Y,z:()=>l});var x=N(8260),d=N(865),Y=(()=>{return(P=Y||(Y={}))[P.VERBOSE=0]="VERBOSE",P[P.INFO=1]="INFO",P[P.WARNING=2]="WARNING",P[P.ERROR=3]="ERROR",Y;var P})();let l=(()=>{class P{constructor(){this.logLevel=Y.VERBOSE,x.N.production&&(this.logLevel=Y.INFO)}log(f,H=Y.VERBOSE){console&&console.log&&H>=this.logLevel&&console.log("["+Y[H]+"] {"+(new Date).toLocaleTimeString()+"} "+f)}}return P.\u0275fac=function(f){return new(f||P)},P.\u0275prov=d.Yz7({token:P,factory:P.\u0275fac,providedIn:"root"}),P})()},6158:(yn,je,N)=>{"use strict";N.d(je,{R:()=>f});var x=N(4553),d=N(6505),Y=N(4537),l=N(6136),P=N(865),O=N(9101);let f=(()=>{class H{constructor(K,G,ne,ce){this.api=K,this.events=G,this.logging=ne,this.analytics=ce,this.isRequestInProgress=!1}refreshPOIList(K){var G=this;return(0,x.Z)(function*(){try{return G.poiList=yield G.fetchPOIList(K),G.events.publish("ocm:poiList:updated"),G.analytics.appEvent("Search","Fetched Results"),G.poiList.length}catch{return 0}})()}fetchPOIList(K){var G=this;return(0,x.Z)(function*(){G.isRequestInProgress=!0;try{let ne=yield G.api.fetchPOIListByParam(K);return G.isRequestInProgress=!1,ne&&ne.length&&G.logging.log("fetched POI list ["+ne.length+"]"),ne}catch{return G.isRequestInProgress=!1,[]}})()}clearResults(){this.poiList=[],this.events.publish("ocm:poiList:cleared"),this.logging.log("clearing results after settings change",d.i.VERBOSE)}getPOIById(K,G=!1,ne=!1){var ce=this;return(0,x.Z)(function*(){if(!ne&&null!=ce.poiList){const we=ce.poiList.find(ze=>ze.ID==K);if(we)return we}const me={poiIdList:[K],enableCaching:!ne,includeComments:!0},ve=yield ce.api.fetchPOIListByParam(me);return ve&&ve.length>0?(ce.poiList&&ve[0].ID==K&&(ce.poiList=ce.poiList.filter(we=>we.ID!=K),ce.poiList.push(ve[0]),ce.logging.log("POI refreshed in cache "+K)),ve[0]):null})()}}return H.\u0275fac=function(K){return new(K||H)(P.LFG(Y.l),P.LFG(O.z),P.LFG(d.z),P.LFG(l.c))},H.\u0275prov=P.Yz7({token:H,factory:H.\u0275fac,providedIn:"root"}),H})()},2377:(yn,je,N)=>{"use strict";N.d(je,{W:()=>P});var x=N(4553),d=N(6505),Y=N(865),l=N(4522);let P=(()=>{class O{constructor(H,te){this.http=H,this.logging=te,this.loadCachedRefData()}refreshReferenceData(H){var te=this;return(0,x.Z)(function*(){try{const K=yield H.fetchCoreReferenceData(null).toPromise();return te.setCoreReferenceData(K),te.setFilteredReferenceData(K),te.logging.log("Got refreshed core ref data.",d.i.VERBOSE),te.sortCoreReferenceData(),te.cacheCurrentRefData(),!0}catch(K){return te.logging.log("Error fetching core ref data:"+K),!1}})()}refreshFilteredReferenceData(H,te){H.fetchCoreReferenceData(te).subscribe(K=>{this.setFilteredReferenceData(K),this.sortCoreReferenceData(),this.logging.log("Got refreshed filtered reference data.",d.i.VERBOSE)},K=>{this.logging.log("Error fetching filtered reference data:"+K)})}setCoreReferenceData(H){this.referenceData=H}setFilteredReferenceData(H){this.filteredReferenceData=H}referenceDataLoaded(){return null!=this.referenceData}getCountries(H=!1){return 1==H?this.filteredReferenceData.Countries:this.referenceData.Countries}getCountryByID(H){return this.getRefDataByID(this.referenceData.Countries,H)}getConnectionTypes(H=!1){return 1==H?this.filteredReferenceData.ConnectionTypes:this.referenceData.ConnectionTypes}getConnectionTypeByID(H){return this.getRefDataByID(this.referenceData.ConnectionTypes,H)}getUsageTypes(H=!1){return 1==H?this.filteredReferenceData.UsageTypes:this.referenceData.UsageTypes.filter(te=>te.ID>0)}getUsageTypeByID(H){return this.getRefDataByID(this.referenceData.UsageTypes,H)}getStatusTypes(H=!1){return 1==H?this.filteredReferenceData.StatusTypes:this.referenceData.StatusTypes.filter(te=>te.ID>0)}getStatusTypeByID(H){return this.getRefDataByID(this.referenceData.StatusTypes,H)}getNetworkOperators(H=!1){return 1==H?this.filteredReferenceData.Operators:this.referenceData.Operators}getNetworkOperatorByID(H){return this.getRefDataByID(this.referenceData.Operators,H)}getDataProviders(H=!1){return 1==H?this.filteredReferenceData.DataProviders:this.referenceData.DataProviders}getDataProviderByID(H){return this.getRefDataByID(this.referenceData.DataProviders,H)}getCheckinStatusTypes(H=!1,te=!0){let K=null;return K=1==H?this.filteredReferenceData.CheckinStatusTypes:this.referenceData.CheckinStatusTypes,te&&(K=K.filter(G=>!1===G.IsAutomatedCheckin)),K}getCheckinStatusTypeByID(H){return this.getRefDataByID(this.referenceData.CheckinStatusTypes,H)}getCommentTypes(H=!1,te=!0){let K;return K=1==H?this.filteredReferenceData.UserCommentTypes:this.referenceData.UserCommentTypes,te&&(K=K.filter(G=>100!==G.ID&&110!==G.ID)),K}getCommentTypeByID(H){return this.getRefDataByID(this.referenceData.UserCommentTypes,H)}getSubmissionStatusTypes(H=!1){return 1==H?this.filteredReferenceData.SubmissionStatusTypes:this.referenceData.SubmissionStatusTypes}getSubmissionStatusTypesByID(H){return this.getRefDataByID(this.referenceData.SubmissionStatusTypes,H)}getChargingLevelTypes(H=!1){return 1==H?this.filteredReferenceData.ChargerTypes:this.referenceData.ChargerTypes}getChargingLevelTypeByID(H){return this.getRefDataByID(this.referenceData.ChargerTypes,H)}getOutputCurrentTypes(H=!1){return H?this.referenceData.CurrentTypes:this.filteredReferenceData.CurrentTypes}getOutputCurrentTypeByID(H){return this.getRefDataByID(this.referenceData.CurrentTypes,H)}loadCachedRefData(){const H=localStorage.getItem("referenceData");if(null==H)this.http.get("./assets/data/CoreReferenceData.json").subscribe(te=>{this.logging.log("Using bundled reference data as cached ref data."),this.setCoreReferenceData(te),this.setFilteredReferenceData(te)});else{let te=JSON.parse(H);this.setCoreReferenceData(te)}this.setFilteredReferenceData(this.referenceData)}cacheCurrentRefData(){null!=this.referenceData&&(this.referenceData.CacheDate=new Date,localStorage.setItem("referenceData",JSON.stringify(this.referenceData)))}getRefDataByID(H,te){if(""!==te&&(te=parseInt(te,10)),null!=H)for(let K=0;K<H.length;K++)if(H[K].ID===te)return H[K];return null}sortCoreReferenceData(){this.sortReferenceData(this.referenceData.ConnectionTypes),this.sortReferenceData(this.referenceData.Countries),this.sortReferenceData(this.referenceData.Operators),this.sortReferenceData(this.referenceData.DataProviders),this.sortReferenceData(this.referenceData.UsageTypes),this.sortReferenceData(this.referenceData.StatusTypes),this.sortReferenceData(this.referenceData.CheckinStatusTypes),this.sortReferenceData(this.referenceData.SubmissionStatusTypes),this.filteredReferenceData&&(this.sortReferenceData(this.filteredReferenceData.ConnectionTypes),this.sortReferenceData(this.filteredReferenceData.Operators))}sortReferenceData(H){H.sort(this.sortListByTitle)}sortListByTitle(H,te){return H.Title<te.Title?-1:H.Title>te.Title?1:0}getMetadataValueByMetadataFieldID(H,te){if(""!==te&&(te=parseInt(te,10)),null!=H)for(let K=0;K<H.length;K++)if(H[K].ID===te)return H[K];return null}hydrateCompactPOI(H,te=!1){const K=this;if(null!=H.DataProviderID&&(te||null==H.DataProvider)&&(H.DataProvider=K.getDataProviderByID(H.DataProviderID)),null!=H.OperatorID&&(te||null==H.OperatorInfo)&&(H.OperatorInfo=K.getNetworkOperatorByID(H.OperatorID)),null!=H.UsageTypeID&&(te||null==H.UsageType)&&(H.UsageType=K.getUsageTypeByID(H.UsageTypeID)),null!=H.AddressInfo.CountryID&&(te||null==H.AddressInfo.Country)&&(H.AddressInfo.Country=K.getCountryByID(H.AddressInfo.CountryID)),null!=H.StatusTypeID&&(te||null==H.StatusType)&&(H.StatusType=K.getStatusTypeByID(H.StatusTypeID)),null!=H.SubmissionStatusTypeID&&(te||null==H.SubmissionStatusType)&&(H.SubmissionStatusType=K.getSubmissionStatusTypesByID(H.SubmissionStatusTypeID)),null!=H.Connections)for(let G=0;G<H.Connections.length;G++){const ne=H.Connections[G];null!=ne.ConnectionTypeID&&(te||null==ne.ConnectionType)&&(ne.ConnectionType=K.getConnectionTypeByID(ne.ConnectionTypeID)),null!=ne.LevelID&&(te||null==ne.Level)&&(ne.Level=K.getChargingLevelTypeByID(ne.LevelID)),null!=ne.CurrentTypeID&&(te||null==ne.CurrentType)&&(ne.CurrentType=K.getOutputCurrentTypeByID(ne.CurrentTypeID)),null!=ne.StatusTypeID&&(te||null==ne.StatusType)&&(ne.StatusType=K.getStatusTypeByID(ne.StatusTypeID)),H.Connections[G]=ne}if(null!=H.UserComments)for(let G=0;G<H.UserComments.length;G++){const ne=H.UserComments[G];null!=ne.CommentTypeID&&(te||null==ne.CommentType)&&(ne.CommentType=K.getCommentTypeByID(ne.CommentTypeID)),null!=ne.CheckinStatusTypeID&&(te||null==ne.CheckinStatusType)&&(ne.CheckinStatusType=K.getCheckinStatusTypeByID(ne.CheckinStatusTypeID)),H.UserComments[G]=ne}return H}hydrateCompactPOIList(H){for(let te=0;te<H.length;te++)H[te]=this.hydrateCompactPOI(H[te]);return H}}return O.\u0275fac=function(H){return new(H||O)(Y.LFG(l.eN),Y.LFG(d.z))},O.\u0275prov=Y.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})()},8616:(yn,je,N)=>{"use strict";N.d(je,{v:()=>ze});var x=N(873),d=N(249),Y=N(2022),l=N(6505),P=N(4553),O=N(5548),f=N(8254),H=N(9206),te=N(8260),K=N(74);class G{constructor(Ae,Te){this.events=Ae,this.logging=Te,this.events=Ae,this.mapAPIType=d.b.MAPKIT_JS,this.mapReady=!1,this.markerList=new f.Xy,this.mapkitUtils=new ne}initAPI(){mapkit&&mapkit.init({authorizationCallback:function(Ae){Ae(te.N.mapKitToken)}})}initMap(Ae,Te,He){this.mapCanvasID=Ae;let Ge=!0;if(Ge="undefined"!=typeof mapkit,!Ge)return this.logging.log("Call to initMap before API is ready:"+d.b[this.mapAPIType],l.i.ERROR),this.mapReady=!1,!1;this.initAPI(),null==this.map&&(document.getElementById(Ae),this.map=new mapkit.Map(Ae),this.map.annotationForCluster=function(E){"poi"===E.clusteringIdentifier&&(E.title="Charging Location",E.subtitle=E.memberAnnotations.reduce((Qe,et)=>Qe+et.population,0))},this.mapReady=!0,mapkit.addEventListener("configuration-change",E=>{this.events.publish("ocm:mapping:ready")}),this.map.addEventListener("scroll-end",E=>{this.events.publish("ocm:mapping:dragend")}),this.map.addEventListener("zoom-end",E=>{this.events.publish("ocm:mapping:zoom")}))}clearMarkers(){null!=this.markerList&&this.markerList.forEach((Ae,Te)=>{try{this.map.removeAnnotation(Te)}catch{}}),this.markerList=new f.Xy}showPOIListOnMap(Ae,Te){let E=0,et=0==this.markerList.size();if(null!=Ae){let gt=[];for(let bt=0;bt<Ae.length;bt++)if(null!=Ae[bt].AddressInfo&&null!=Ae[bt].AddressInfo.Latitude&&null!=Ae[bt].AddressInfo.Longitude){let ut=Ae[bt],St=!0;if(null!=this.markerList&&this.markerList.containsKey(ut.ID)&&(St=!1),St){let Vt=null;Vt=Y.c.getIconForPOI(ut);let Mt="OCM-"+ut.ID+": "+ut.AddressInfo.Title+":";null!=ut.UsageType&&(Mt+=" "+ut.UsageType.Title),null!=ut.StatusType&&(Mt+=" "+ut.StatusType.Title);const Kt=new mapkit.Coordinate(ut.AddressInfo.Latitude,ut.AddressInfo.Longitude);let Ot=new mapkit.ImageAnnotation(Kt,{title:Mt,size:{width:34,height:50},url:{1:Vt},clusteringIdentifier:"poi"});Ot.poi=ut,Ot.addEventListener("select",Ft=>{const ln=Ft.target.poi;this.events.publish("ocm:poi:selected",{poi:ln,poiId:ln.ID})}),this.markerList.setValue(ut.ID,Ot),gt.push(Ot),E++}}gt.length>0&&(this.map.addAnnotations(gt),et&&this.map.showItems(gt,{animate:!0,padding:new mapkit.Padding(60,25,60,25)})),this.logging.log(E+" new map markers added out of a total "+this.markerList.size())}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapKit: refreshMapLayout",l.i.VERBOSE)},200)}setMapCenter(Ae,Te){this.map&&(this.map.setCenterAnimated(new mapkit.Coordinate(Ae.coords.latitude,Ae.coords.longitude),!1),Te&&this.setMapZoom(Te))}getMapCenter(){return new O.y(Te=>{if(null!=this.map){let He=this.map.center;null!=He&&(Te.next(new H.jR(He.latitude,He.longitude)),Te.complete())}})}setMapZoom(Ae){const Te=Math.min(Ae,28),He=this.mapkitUtils.deltaFromZoomLevel(this.map,this.map.center,Math.round(Te)),Ge=new mapkit.CoordinateSpan(111*He.latitudeDelta,111*He.longitudeDelta),Fe=new mapkit.CoordinateRegion(this.map.center,Ge);this.map.setRegionAnimated(Fe)}getMapZoom(){return new O.y(Te=>{this.logging.log("MapKit: getMapZoom not supported",l.i.VERBOSE),Te.next(this.map._impl.zoomLevel),Te.complete()})}setMapType(Ae){this.logging.log("MapKit: skipped setting Map Type :"+Ae)}getMapBounds(){return new O.y(Te=>{let He=new Array,Ge=this.map.region.toBoundingRegion();He.push(new H.wC(Ge.southLatitude,Ge.westLongitude)),He.push(new H.wC(Ge.northLatitude,Ge.eastLongitude)),Te.next(He),Te.complete()})}moveToMapBounds(Ae){this.logging.log("MapKit: map bounds not implemented")}renderMap(Ae,Te,He){return document.getElementById(this.mapCanvasID).style.height=Te+"px",this.mapReady&&this.showPOIListOnMap(Ae,He),!0}renderPolyline(Ae){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(Ae){return(0,P.Z)(function*(){let Te=new mapkit.Search({getsUserLocation:!0});return new Promise(function(){var He=(0,P.Z)(function*(Ge,Fe){let E=[];Te.search(Ae,function(){var Qe=(0,P.Z)(function*(et,ct){et&&Fe(et),E=[],ct.places.map(gt=>{let bt=new K.n;bt.Title=gt.name,bt.Address=gt.formattedAddress,bt.Type="place",bt.Location=new H.wC(gt.coordinate.latitude,gt.coordinate.longitude),E.push(bt)}),Ge(E)});return function(et,ct){return Qe.apply(this,arguments)}}())});return function(Ge,Fe){return He.apply(this,arguments)}}())})()}addPOILayer(Ae){this.logging.log("Add POI Layer not implemented in this provider.")}}class ne{constructor(){this.mercatorRadius=85445659.44705395,this.mercatorOffset=268435456}longitudeToPixelSpaceX(Ae){return Math.round(this.mercatorOffset+this.mercatorRadius*Ae*Math.PI/180)}latitudeToPixelSpaceY(Ae){return Math.round(this.mercatorOffset-this.mercatorRadius*Math.log((1+Math.sin(Ae*Math.PI/180))/(1-Math.sin(Ae*Math.PI/180)))/2)}pixelSpaceXToLongitude(Ae){return(Math.round(Ae)-this.mercatorOffset)/this.mercatorRadius*180/Math.PI}pixelSpaceYToLatitude(Ae){return 180*(Math.PI/2-2*Math.atan(Math.exp((Math.round(Ae)-this.mercatorOffset)/this.mercatorRadius)))/Math.PI}deltaFromZoomLevel(Ae,Te,He){let Ge=this.longitudeToPixelSpaceX(Te.longitude),Fe=this.latitudeToPixelSpaceY(Te.latitude),Qe=Math.pow(2,20-He),et=Ae.visibleMapRect.size,ct=et.width*Qe,gt=et.height*Qe,bt=Ge-ct/2,ut=Fe-gt/2,St=this.pixelSpaceXToLongitude(bt),bn=this.pixelSpaceXToLongitude(bt+ct)-St,Nt=this.pixelSpaceYToLatitude(ut);return{latitudeDelta:-1*(this.pixelSpaceYToLatitude(ut+gt)-Nt),longitudeDelta:bn}}}var ce=N(865),me=N(9101),ve=N(4522);let we=(()=>{class Ne extends x.k{constructor(Te,He,Ge){super(Te,He,Ge),this.mapAPIType=d.b.MAPTILER,this.mapTileSet="https://maps.tilehosting.com/styles/streets/style.json?key=Gs9z7krALe3CGI60d5cL"}initAPI(){}}return Ne.\u0275fac=function(Te){return new(Te||Ne)(ce.LFG(me.z),ce.LFG(l.z),ce.LFG(ve.eN))},Ne.\u0275prov=ce.Yz7({token:Ne,factory:Ne.\u0275fac}),Ne})(),ze=(()=>{class Ne{constructor(Te,He,Ge){this.logging=He,this.http=Ge,this.isFocused=!1,this.events=Te,this.mapOptions=new d._,this.mapAPIReady=!1,this.mapsInitialised=!1,this.setMapAPI(this.mapOptions.mapAPI);let Fe=this;this.debouncedMapPositionUpdate=Y.c.debounce(()=>{this.logging.log("signaling map position change:"),Fe.mapProvider.mapReady&&Fe.getMapCenter().subscribe(E=>{null!=E?(this.logging.log("Map centre/zoom changed, updating search position:"+E),this.updateMapCentrePos(E.coords.latitude,E.coords.longitude,!1)):this.logging.log("Map centre/zoom changed - map not ready to change centre pos:")})},300,!1)}setParentAppContext(Te){this.parentAppContext=Te}setMapAPI(Te){this.mapOptions.mapAPI=Te,this.mapOptions.mapAPI==d.b.MAPBOX&&(this.mapProvider=new x.k(this.events,this.logging,this.http)),this.mapOptions.mapAPI==d.b.MAPKIT_JS&&(this.mapProvider=new G(this.events,this.logging)),this.mapOptions.mapAPI==d.b.MAPTILER&&(this.mapProvider=new we(this.events,this.logging,this.http))}isMapReady(){return null!=this.mapProvider&&this.mapProvider.mapReady}externalAPILoaded(Te){this.mapAPIReady=!0,this.logging.log("Mapping API Loaded: "+d.b[Te])}initMap(Te){if(!this.isMapReady())if(null!=this.mapProvider)this.mapsInitialised&&this.logging.log("initMap: Map provider already initialised"),this.logging.log("Mapping Manager: Init "+d.b[this.mapProvider.mapAPIType]),this.mapProvider.initMap(Te,this.mapOptions,this);else{if(this.mapsInitialised)return void this.logging.log("initMap: map already initialised");this.logging.log("initMap: "+this.mapOptions.mapAPI)}}mapManipulationPerformed(Te){this.logging.log("map manipulated:"+Te),("drag"==Te||"zoom"==Te)&&this.debouncedMapPositionUpdate()}updateMapSize(){this.mapProvider&&this.mapProvider.refreshMapLayout()}updateMapCentrePos(Te,He,Ge,Fe){Ge&&null!=this.mapProvider&&this.mapProvider.setMapCenter(new H.jR(Te,He),Fe),this.mapOptions.mapCentre=new H.jR(Te,He)}moveToMapBounds(Te){this.mapProvider.moveToMapBounds(Te)}refreshMapView(Te,He,Ge){return null!=this.mapProvider?(this.logging.log("Mapping Manager: renderMap "+d.b[this.mapProvider.mapAPIType]),this.isMapReady()?this.mapProvider.renderMap(He,Te,this.parentAppContext):this.logging.log("refreshMapView: map provider not initialised..")):this.logging.log("Unsupported Map API: refreshMapView",l.i.ERROR),!0}setMapType(Te){this.mapOptions.mapType!=Te&&(this.mapOptions.mapType=Te,this.isMapReady()&&null!=this.mapProvider?(this.logging.log("Changing map type:"+Te),this.mapProvider.setMapType(Te)):this.logging.log("Map type set, maps not initialised yet."))}unfocusMap(){this.logging.log("[mapping] Unfocus Map."),this.isFocused=!1,this.mapProvider.unfocusMap()}focusMap(){this.logging.log("[mapping] Focus Map."),this.isFocused=!0,this.mapProvider.focusMap()}getMapBounds(){return this.mapProvider.getMapBounds()}getMapZoom(){return this.mapProvider.getMapZoom()}setMapZoom(Te){this.mapProvider.setMapZoom(Te)}getMapCenter(){return this.mapProvider.getMapCenter()}showPOIOnStaticMap(Te,He,Ge=!1,Fe=!1,E=200,Qe=200){let et=document.getElementById(Te);if(null!=et){let gt=He.AddressInfo.Latitude,bt=He.AddressInfo.Longitude;E>640&&(E=640),Qe>640&&(Qe=640);let ut=E,St=Qe,Vt="https://maps.googleapis.com/maps/api/staticmap?center="+gt+","+bt+"&zoom=14&size="+ut+"x"+St+"&maptype=roadmap&markers=color:blue%7Clabel:A%7C"+gt+","+bt+"&sensor=false",bn="";bn+=1==Ge?"<div>"+Y.c.formatMapLink(He,'<div><img width="'+ut+'" height="'+St+'" src="'+Vt+'" /></div>',Fe)+"</div>":'<div><img width="'+ut+'" height="'+St+'" src="'+Vt+'" /></div>',et.innerHTML=bn}}renderPolyline(Te){this.mapProvider.renderPolyline(Te)}clearPolyline(){this.mapProvider.clearPolyline()}clearMarkers(){this.logging.log("mapping: clearing markers"),this.mapProvider.clearMarkers()}addPOILayer(Te){this.mapProvider.addPOILayer(Te)}}return Ne.\u0275fac=function(Te){return new(Te||Ne)(ce.LFG(me.z),ce.LFG(l.z),ce.LFG(ve.eN))},Ne.\u0275prov=ce.Yz7({token:Ne,factory:Ne.\u0275fac,providedIn:"root"}),Ne})()},249:(yn,je,N)=>{"use strict";N.d(je,{b:()=>d,_:()=>Y});var x=N(8260),d=(()=>{return(l=d||(d={}))[l.GOOGLE_WEB=1]="GOOGLE_WEB",l[l.GOOGLE_NATIVE=2]="GOOGLE_NATIVE",l[l.LEAFLET=3]="LEAFLET",l[l.MAPBOX=4]="MAPBOX",l[l.MAPKIT_JS=5]="MAPKIT_JS",l[l.MAPTILER=6]="MAPTILER",d;var l})();class Y{constructor(){this.enableClustering=!1,this.resultBatchID=-1,this.useMarkerIcons=!0,this.useMarkerAnimation=!0,this.enableTrackingMapCentre=!1,this.enableSearchByWatchingLocation=!1,this.mapCentre=null,this.mapAPI=x.N.defaultMapProvider,this.mapType="ROADMAP",this.searchDistanceKM=1e5,this.mapMoveQueryRefreshMS=300,this.enableSearchRadiusIndicator=!1,this.minZoomLevel=2}}},873:(yn,je,N)=>{"use strict";N.d(je,{k:()=>we});var x=N(4553),d=N(2022),Y=N(249),l=N(5548),P=N(8254),O=N(9206),f=N(6505),H=N(7887),K=N(8260),G=N(74),ne=N(865),ce=N(9101),me=N(4522);let we=(()=>{class ze{constructor(Ae,Te,He){this.events=Ae,this.logging=Te,this.http=He,this._isMapAnimating=!1,this.events=Ae,this.mapAPIType=Y.b.MAPBOX,this.mapReady=!1,this.markerList=new P.Xy}initAPI(){H&&(H.accessToken=K.N.mapBoxToken)}getCurrentMapTileSet(Ae){return"SATELLITE"==Ae?"mapbox://styles/mapbox/satellite-streets-v11?optimize=true":"mapbox://styles/mapbox/streets-v11?optimize=true"}flyAroundPoint(Ae){if(this._isMapAnimating){this.map.rotateTo(Ae/100%360,{duration:0});const Te=this;requestAnimationFrame(function(He){Te.flyAroundPoint(He)})}}initMap(Ae,Te,He){this.mapCanvasID=Ae;let Ge=!0;if(Ge=void 0!==H,!Ge)return this.logging.log("Call to initMap before API is ready:"+Y.b[this.mapAPIType],f.i.ERROR),this.mapReady=!1,!1;if(null==this.map){let et=function(gt){return gt*(2-gt)};document.getElementById(Ae),this.initAPI(),this.map=new H.Map({container:Ae,style:this.getCurrentMapTileSet(Te.mapType),zoom:15,attributionControl:!1}),this.map.addControl(new H.AttributionControl({compact:!0,customAttribution:["Open Charge Map Contributors"]})),this.map.addControl(new H.NavigationControl),this.mapReady=!0,this.map.getCanvas().focus();let E=100,Qe=25;this.map.getCanvas().addEventListener("keydown",gt=>{gt.preventDefault(),38===gt.which?this.map.panBy([0,-E],{easing:et}):40===gt.which?this.map.panBy([0,E],{easing:et}):37===gt.which?this.map.easeTo({bearing:this.map.getBearing()-Qe,easing:et}):39===gt.which?this.map.easeTo({bearing:this.map.getBearing()+Qe,easing:et}):32===gt.which&&(this._isMapAnimating?this._isMapAnimating=!1:(this._isMapAnimating=!0,this.flyAroundPoint(0)))},!0),this.map.on("load",()=>{this.events.publish("ocm:mapping:ready")});let ct=d.c.debounce(()=>{this.getMapCenter().subscribe(gt=>{this.searchMarker.setLngLat(new H.LngLat(gt.coords.longitude,gt.coords.latitude))})},500,!1);this.map.on("move",()=>{this.searchMarker&&ct()}),this.map.on("moveend",()=>{this.events.publish("ocm:mapping:dragend"),Te.onMapMoveCompleted&&Te.onMapMoveCompleted()}),this.map.on("zoomend",()=>{this.events.publish("ocm:mapping:zoom")})}}clearMarkers(){null!=this.markerList&&this.markerList.forEach((Ae,Te)=>{try{Te.remove()}catch{}}),this.markerList=new P.Xy}showPOIListOnMap(Ae,Te,He=!0){let Fe=this.map,E=new H.LngLatBounds,Qe=0;if(Fe.getZoom(),null!=Ae){for(let ut=0;ut<Ae.length;ut++)if(null!=Ae[ut].AddressInfo&&null!=Ae[ut].AddressInfo.Latitude&&null!=Ae[ut].AddressInfo.Longitude){let St=Ae[ut],Vt=!0;if(null!=this.markerList&&this.markerList.containsKey(St.ID)){Vt=!1;let bn=this.markerList.getValue(St.ID);bn&&bn.poi&&bn.poi.DateLastStatusUpdate!=St.DateLastStatusUpdate&&(bn.remove(),Vt=!0)}if(Vt){let bn=null,Nt=null;He?(bn=document.createElement("img"),bn.src=d.c.getIconForPOI(St),bn.width=34,bn.height=50):(bn=null,Nt=d.c.getColorForPOI(St));let Mt=(He?"OCM-":"EXT-")+St.ID+": "+St.AddressInfo.Title+":";null!=St.UsageType&&(Mt+=" "+St.UsageType.Title),null!=St.StatusType&&(Mt+=" "+St.StatusType.Title);let Kt=new H.Marker({element:bn,color:Nt}).setLngLat([St.AddressInfo.Longitude,St.AddressInfo.Latitude]).addTo(Fe);Kt.poi=St;let Ot=Kt.getElement();Ot.poi=St,Ot.addEventListener("click",Ft=>{const ln=Ft.currentTarget.poi;this.events.publish("ocm:poi:selected",{poiId:ln.ID,poi:ln})}),E.extend(Kt.getLngLat()),this.markerList.setValue(St.ID,Kt),Qe++}}this.logging.log(Qe+" new map markers added out of a total "+this.markerList.size())}if(null!=Ae&&Ae.length>0)if(null==Te||Te.appConfig.enableLiveMapQuerying)null==Fe.getCenter()&&Fe.setCenter(E.getCenter());else{this.logging.log("Fitting to marker bounds:"+E),Fe.setCenter(E.getCenter()),this.logging.log("zoom before fit bounds:"+Fe.getZoom()),Fe.fitBounds(E);let bt=Fe.getZoom();Fe.setZoom(bt<6?6:bt)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapBoxGL: refreshMapLayout",f.i.VERBOSE),this.map.resize()},200)}setMapCenter(Ae){this.mapReady&&(this.map.setCenter(new H.LngLat(Ae.coords.longitude,Ae.coords.latitude)),this.searchMarker||(this.searchMarker=new H.Marker({color:"#99ccff",anchor:"top"}).setLngLat(new H.LngLat(Ae.coords.longitude,Ae.coords.latitude)).addTo(this.map),this.searchMarker.getElement().addEventListener("click",()=>{let Te=this.searchMarker.getLngLat();this.events.publish("ocm:mapping:addpoi",new O.wC(Te.lat,Te.lng))})))}getMapCenter(){return new l.y(Te=>{if(null!=this.map){let He=this.map.getCenter();null!=He&&(Te.next(new O.jR(He.lat,He.lng)),Te.complete())}})}setMapZoom(Ae){this.map.setZoom(Ae)}getMapZoom(){return new l.y(Te=>{let He=this.map.getZoom();Te.next(He),Te.complete()})}setMapType(Ae){this.map.setStyle(this.getCurrentMapTileSet(Ae))}getMapBounds(){return new l.y(Te=>{let He=new Array,Ge=this.map.getBounds();He.push(new O.wC(Ge.getSouthWest().lat,Ge.getSouthWest().lng)),He.push(new O.wC(Ge.getNorthEast().lat,Ge.getNorthEast().lng)),Te.next(He),Te.complete()})}moveToMapBounds(Ae){this.map.fitBounds(new H.LngLatBounds(new H.LngLat(Ae.southWest.longitude,Ae.southWest.latitude),new H.LngLat(Ae.northEast.longitude,Ae.northEast.latitude)))}renderMap(Ae,Te,He){return document.getElementById(this.mapCanvasID).style.height=Te+"px",this.mapReady&&this.showPOIListOnMap(Ae,He),!0}renderPolyline(Ae){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(Ae,Te,He){var Ge=this;return(0,x.Z)(function*(){let Fe=`https://api.mapbox.com/geocoding/v5/mapbox.places/${Ae||He+","+Te}.json?access_token=${K.N.mapBoxToken}`;return new Promise(function(){var E=(0,x.Z)(function*(Qe,et){Ge.http.get(Fe).toPromise().then(ct=>{let gt=[];gt=[],ct.features&&ct.features.map(bt=>{let ut=new G.n;ut.Title=bt.place_name,ut.Address=bt.place_name,ut.Type="place",ut.Location=new O.wC(bt.center[1],bt.center[0]),ut.Attribution=ct.attribution,gt.push(ut)}),Qe(gt)})});return function(Qe,et){return E.apply(this,arguments)}}())})()}addPOILayer(Ae){this.logging.log("Add POI Layer not implemented in this provider."),this.showPOIListOnMap(Ae,null,!1)}}return ze.\u0275fac=function(Ae){return new(Ae||ze)(ne.LFG(ce.z),ne.LFG(f.z),ne.LFG(me.eN))},ze.\u0275prov=ne.Yz7({token:ze,factory:ze.\u0275fac}),ze})()},8260:(yn,je,N)=>{"use strict";N.d(je,{N:()=>x});const x={name:"prod",version:"8.1.0",production:!0,analyticsId:"",googleMapsKey:"",mapBoxToken:"pk.eyJ1Ijoid2VicHJvZnVzaW9uIiwiYSI6ImNrdHZlc2N5dTI5Zjcydm8zYWFwc2JnbTMifQ.M7b5SOzbPcg_8XAHCOeP0w",mapKitToken:"",enableStaticMaps:!1,defaultMapProvider:4,apiBase:"https://api.openchargemap.io",apiKey:"9bb03e5b-0fb2-4916-9b2b-26c6bd27a56a",enabledFeatures:["MAP","ADD_COMMENT","ADD_PHOTO","FAVOURITES","FILTER_OPTIONS_BY_COUNTRY","ADD_POI","EDIT_POI","LAYERS"]}},6537:(yn,je,N)=>{"use strict";var x=N(6019),d=N(865);class Y extends x.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class l extends Y{static makeCurrent(){(0,x.HT)(new l)}onAndCancel(st,Ie,rt){return st.addEventListener(Ie,rt,!1),()=>{st.removeEventListener(Ie,rt,!1)}}dispatchEvent(st,Ie){st.dispatchEvent(Ie)}remove(st){st.parentNode&&st.parentNode.removeChild(st)}createElement(st,Ie){return(Ie=Ie||this.getDefaultDocument()).createElement(st)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(st){return st.nodeType===Node.ELEMENT_NODE}isShadowRoot(st){return st instanceof DocumentFragment}getGlobalEventTarget(st,Ie){return"window"===Ie?window:"document"===Ie?st:"body"===Ie?st.body:null}getBaseHref(st){const Ie=(P=P||document.querySelector("base"),P?P.getAttribute("href"):null);return null==Ie?null:function(Ze){f=f||document.createElement("a"),f.setAttribute("href",Ze);const st=f.pathname;return"/"===st.charAt(0)?st:`/${st}`}(Ie)}resetBaseElement(){P=null}getUserAgent(){return window.navigator.userAgent}getCookie(st){return(0,x.Mx)(document.cookie,st)}}let f,P=null;const te=new d.OlP("TRANSITION_ID"),G=[{provide:d.ip1,useFactory:function(Ze,st,Ie){return()=>{Ie.get(d.CZH).donePromise.then(()=>{const rt=(0,x.q)(),kt=st.querySelectorAll(`style[ng-transition="${Ze}"]`);for(let ri=0;ri<kt.length;ri++)rt.remove(kt[ri])})}},deps:[te,x.K0,d.zs3],multi:!0}];class ne{static init(){(0,d.VLi)(new ne)}addToWindow(st){d.dqk.getAngularTestability=(rt,kt=!0)=>{const ri=st.findTestabilityInTree(rt,kt);if(null==ri)throw new Error("Could not find testability for element.");return ri},d.dqk.getAllAngularTestabilities=()=>st.getAllTestabilities(),d.dqk.getAllAngularRootElements=()=>st.getAllRootElements(),d.dqk.frameworkStabilizers||(d.dqk.frameworkStabilizers=[]),d.dqk.frameworkStabilizers.push(rt=>{const kt=d.dqk.getAllAngularTestabilities();let ri=kt.length,fi=!1;const dr=function(Cr){fi=fi||Cr,ri--,0==ri&&rt(fi)};kt.forEach(function(Cr){Cr.whenStable(dr)})})}findTestabilityInTree(st,Ie,rt){return null==Ie?null:st.getTestability(Ie)??(rt?(0,x.q)().isShadowRoot(Ie)?this.findTestabilityInTree(st,Ie.host,!0):this.findTestabilityInTree(st,Ie.parentElement,!0):null)}}let ce=(()=>{class Ze{build(){return new XMLHttpRequest}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275prov=d.Yz7({token:Ze,factory:Ze.\u0275fac}),Ze})();const gt=new d.OlP("EventManagerPlugins");let bt=(()=>{class Ze{constructor(Ie,rt){this._zone=rt,this._eventNameToPlugin=new Map,Ie.forEach(kt=>kt.manager=this),this._plugins=Ie.slice().reverse()}addEventListener(Ie,rt,kt){return this._findPluginFor(rt).addEventListener(Ie,rt,kt)}addGlobalEventListener(Ie,rt,kt){return this._findPluginFor(rt).addGlobalEventListener(Ie,rt,kt)}getZone(){return this._zone}_findPluginFor(Ie){const rt=this._eventNameToPlugin.get(Ie);if(rt)return rt;const kt=this._plugins;for(let ri=0;ri<kt.length;ri++){const fi=kt[ri];if(fi.supports(Ie))return this._eventNameToPlugin.set(Ie,fi),fi}throw new Error(`No event manager plugin found for event ${Ie}`)}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.LFG(gt),d.LFG(d.R0b))},Ze.\u0275prov=d.Yz7({token:Ze,factory:Ze.\u0275fac}),Ze})();class ut{constructor(st){this._doc=st}addGlobalEventListener(st,Ie,rt){const kt=(0,x.q)().getGlobalEventTarget(this._doc,st);if(!kt)throw new Error(`Unsupported event target ${kt} for event ${Ie}`);return this.addEventListener(kt,Ie,rt)}}let St=(()=>{class Ze{constructor(){this._stylesSet=new Set}addStyles(Ie){const rt=new Set;Ie.forEach(kt=>{this._stylesSet.has(kt)||(this._stylesSet.add(kt),rt.add(kt))}),this.onStylesAdded(rt)}onStylesAdded(Ie){}getAllStyles(){return Array.from(this._stylesSet)}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275prov=d.Yz7({token:Ze,factory:Ze.\u0275fac}),Ze})(),Vt=(()=>{class Ze extends St{constructor(Ie){super(),this._doc=Ie,this._hostNodes=new Map,this._hostNodes.set(Ie.head,[])}_addStylesToHost(Ie,rt,kt){Ie.forEach(ri=>{const fi=this._doc.createElement("style");fi.textContent=ri,kt.push(rt.appendChild(fi))})}addHost(Ie){const rt=[];this._addStylesToHost(this._stylesSet,Ie,rt),this._hostNodes.set(Ie,rt)}removeHost(Ie){const rt=this._hostNodes.get(Ie);rt&&rt.forEach(bn),this._hostNodes.delete(Ie)}onStylesAdded(Ie){this._hostNodes.forEach((rt,kt)=>{this._addStylesToHost(Ie,kt,rt)})}ngOnDestroy(){this._hostNodes.forEach(Ie=>Ie.forEach(bn))}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.LFG(x.K0))},Ze.\u0275prov=d.Yz7({token:Ze,factory:Ze.\u0275fac}),Ze})();function bn(Ze){(0,x.q)().remove(Ze)}const Nt={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"},Bt=/%COMP%/g;function tn(Ze,st,Ie){for(let rt=0;rt<st.length;rt++){let kt=st[rt];Array.isArray(kt)?tn(Ze,kt,Ie):(kt=kt.replace(Bt,Ze),Ie.push(kt))}return Ie}function en(Ze){return st=>{if("__ngUnwrap__"===st)return Ze;!1===Ze(st)&&(st.preventDefault(),st.returnValue=!1)}}let Xt=(()=>{class Ze{constructor(Ie,rt,kt){this.eventManager=Ie,this.sharedStylesHost=rt,this.appId=kt,this.rendererByCompId=new Map,this.defaultRenderer=new cn(Ie)}createRenderer(Ie,rt){if(!Ie||!rt)return this.defaultRenderer;switch(rt.encapsulation){case d.ifc.Emulated:{let kt=this.rendererByCompId.get(rt.id);return kt||(kt=new mi(this.eventManager,this.sharedStylesHost,rt,this.appId),this.rendererByCompId.set(rt.id,kt)),kt.applyToHost(Ie),kt}case 1:case d.ifc.ShadowDom:return new si(this.eventManager,this.sharedStylesHost,Ie,rt);default:if(!this.rendererByCompId.has(rt.id)){const kt=tn(rt.id,rt.styles,[]);this.sharedStylesHost.addStyles(kt),this.rendererByCompId.set(rt.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.LFG(bt),d.LFG(Vt),d.LFG(d.AFp))},Ze.\u0275prov=d.Yz7({token:Ze,factory:Ze.\u0275fac}),Ze})();class cn{constructor(st){this.eventManager=st,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(st,Ie){return Ie?document.createElementNS(Nt[Ie]||Ie,st):document.createElement(st)}createComment(st){return document.createComment(st)}createText(st){return document.createTextNode(st)}appendChild(st,Ie){st.appendChild(Ie)}insertBefore(st,Ie,rt){st&&st.insertBefore(Ie,rt)}removeChild(st,Ie){st&&st.removeChild(Ie)}selectRootElement(st,Ie){let rt="string"==typeof st?document.querySelector(st):st;if(!rt)throw new Error(`The selector "${st}" did not match any elements`);return Ie||(rt.textContent=""),rt}parentNode(st){return st.parentNode}nextSibling(st){return st.nextSibling}setAttribute(st,Ie,rt,kt){if(kt){Ie=kt+":"+Ie;const ri=Nt[kt];ri?st.setAttributeNS(ri,Ie,rt):st.setAttribute(Ie,rt)}else st.setAttribute(Ie,rt)}removeAttribute(st,Ie,rt){if(rt){const kt=Nt[rt];kt?st.removeAttributeNS(kt,Ie):st.removeAttribute(`${rt}:${Ie}`)}else st.removeAttribute(Ie)}addClass(st,Ie){st.classList.add(Ie)}removeClass(st,Ie){st.classList.remove(Ie)}setStyle(st,Ie,rt,kt){kt&(d.JOm.DashCase|d.JOm.Important)?st.style.setProperty(Ie,rt,kt&d.JOm.Important?"important":""):st.style[Ie]=rt}removeStyle(st,Ie,rt){rt&d.JOm.DashCase?st.style.removeProperty(Ie):st.style[Ie]=""}setProperty(st,Ie,rt){st[Ie]=rt}setValue(st,Ie){st.nodeValue=Ie}listen(st,Ie,rt){return"string"==typeof st?this.eventManager.addGlobalEventListener(st,Ie,en(rt)):this.eventManager.addEventListener(st,Ie,en(rt))}}class mi extends cn{constructor(st,Ie,rt,kt){super(st),this.component=rt;const ri=tn(kt+"-"+rt.id,rt.styles,[]);Ie.addStyles(ri),this.contentAttr="_ngcontent-%COMP%".replace(Bt,kt+"-"+rt.id),this.hostAttr="_nghost-%COMP%".replace(Bt,kt+"-"+rt.id)}applyToHost(st){super.setAttribute(st,this.hostAttr,"")}createElement(st,Ie){const rt=super.createElement(st,Ie);return super.setAttribute(rt,this.contentAttr,""),rt}}class si extends cn{constructor(st,Ie,rt,kt){super(st),this.sharedStylesHost=Ie,this.hostEl=rt,this.shadowRoot=rt.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const ri=tn(kt.id,kt.styles,[]);for(let fi=0;fi<ri.length;fi++){const dr=document.createElement("style");dr.textContent=ri[fi],this.shadowRoot.appendChild(dr)}}nodeOrShadowRoot(st){return st===this.hostEl?this.shadowRoot:st}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(st,Ie){return super.appendChild(this.nodeOrShadowRoot(st),Ie)}insertBefore(st,Ie,rt){return super.insertBefore(this.nodeOrShadowRoot(st),Ie,rt)}removeChild(st,Ie){return super.removeChild(this.nodeOrShadowRoot(st),Ie)}parentNode(st){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(st)))}}let Ki=(()=>{class Ze extends ut{constructor(Ie){super(Ie)}supports(Ie){return!0}addEventListener(Ie,rt,kt){return Ie.addEventListener(rt,kt,!1),()=>this.removeEventListener(Ie,rt,kt)}removeEventListener(Ie,rt,kt){return Ie.removeEventListener(rt,kt)}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.LFG(x.K0))},Ze.\u0275prov=d.Yz7({token:Ze,factory:Ze.\u0275fac}),Ze})();const pn=["alt","control","meta","shift"],Ye={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},j={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},ye={alt:Ze=>Ze.altKey,control:Ze=>Ze.ctrlKey,meta:Ze=>Ze.metaKey,shift:Ze=>Ze.shiftKey};let We=(()=>{class Ze extends ut{constructor(Ie){super(Ie)}supports(Ie){return null!=Ze.parseEventName(Ie)}addEventListener(Ie,rt,kt){const ri=Ze.parseEventName(rt),fi=Ze.eventCallback(ri.fullKey,kt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,x.q)().onAndCancel(Ie,ri.domEventName,fi))}static parseEventName(Ie){const rt=Ie.toLowerCase().split("."),kt=rt.shift();if(0===rt.length||"keydown"!==kt&&"keyup"!==kt)return null;const ri=Ze._normalizeKey(rt.pop());let fi="";if(pn.forEach(Cr=>{const Gi=rt.indexOf(Cr);Gi>-1&&(rt.splice(Gi,1),fi+=Cr+".")}),fi+=ri,0!=rt.length||0===ri.length)return null;const dr={};return dr.domEventName=kt,dr.fullKey=fi,dr}static getEventFullKey(Ie){let rt="",kt=function(Ze){let st=Ze.key;if(null==st){if(st=Ze.keyIdentifier,null==st)return"Unidentified";st.startsWith("U+")&&(st=String.fromCharCode(parseInt(st.substring(2),16)),3===Ze.location&&j.hasOwnProperty(st)&&(st=j[st]))}return Ye[st]||st}(Ie);return kt=kt.toLowerCase()," "===kt?kt="space":"."===kt&&(kt="dot"),pn.forEach(ri=>{ri!=kt&&ye[ri](Ie)&&(rt+=ri+".")}),rt+=kt,rt}static eventCallback(Ie,rt,kt){return ri=>{Ze.getEventFullKey(ri)===Ie&&kt.runGuarded(()=>rt(ri))}}static _normalizeKey(Ie){return"esc"===Ie?"escape":Ie}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.LFG(x.K0))},Ze.\u0275prov=d.Yz7({token:Ze,factory:Ze.\u0275fac}),Ze})();const wr=(0,d.eFA)(d._c5,"browser",[{provide:d.Lbi,useValue:x.bD},{provide:d.g9A,useValue:function(){l.makeCurrent(),ne.init()},multi:!0},{provide:x.K0,useFactory:function(){return(0,d.RDi)(document),document},deps:[]}]),mr=[[],{provide:d.zSh,useValue:"root"},{provide:d.qLn,useFactory:function(){return new d.qLn},deps:[]},{provide:gt,useClass:Ki,multi:!0,deps:[x.K0,d.R0b,d.Lbi]},{provide:gt,useClass:We,multi:!0,deps:[x.K0]},[],{provide:Xt,useClass:Xt,deps:[bt,Vt,d.AFp]},{provide:d.FYo,useExisting:Xt},{provide:St,useExisting:Vt},{provide:Vt,useClass:Vt,deps:[x.K0]},{provide:d.dDg,useClass:d.dDg,deps:[d.R0b]},{provide:bt,useClass:bt,deps:[gt,d.R0b]},{provide:x.JF,useClass:ce,deps:[]},[]];let Ji=(()=>{class Ze{constructor(Ie){if(Ie)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(Ie){return{ngModule:Ze,providers:[{provide:d.AFp,useValue:Ie.appId},{provide:te,useExisting:d.AFp},G]}}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.LFG(Ze,12))},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({providers:mr,imports:[x.ez,d.hGG]}),Ze})();"undefined"!=typeof window&&window;var Yn=N(5316),oi=N(1586),En=N(9133),zt=N(5966);let Zn=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({imports:[[x.ez,En.u5,zt.Pc,oi.aw,Yn.e]]}),Ze})(),ti=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({imports:[[x.ez,En.u5,zt.Pc,oi.aw,Yn.e]]}),Ze})(),li=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({imports:[[x.ez,En.u5,zt.Pc,oi.aw,Yn.e]]}),Ze})();var Ci=N(2670),ui=N(4522),Ii=N(5899),to=N(6417);class Or{constructor(st,Ie="/assets/i18n/",rt=".json"){this.http=st,this.prefix=Ie,this.suffix=rt}getTranslation(st){return this.http.get(`${this.prefix}${st}${this.suffix}`)}}var jn=N(4553),$i=N(8616),Fr=N(9950),Ir=N(1486),Nr=N(209),_r=N(8615);function Ee(Ze,st){if(1&Ze){const Ie=d.EpF();d.TgZ(0,"div"),d._uU(1," You are not signed in. "),d.TgZ(2,"button",5),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().showSignInModal()}),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA()}2&Ze&&(d.xp6(3),d.Oqu(d.lcZ(4,1,"ocm.general.signIn")))}function xe(Ze,st){if(1&Ze&&(d.TgZ(0,"div"),d.TgZ(1,"ion-card"),d.TgZ(2,"ion-item"),d.TgZ(3,"ion-avatar",6),d._UZ(4,"img",7),d.qZA(),d.TgZ(5,"h2"),d._uU(6),d.qZA(),d.qZA(),d.TgZ(7,"ion-card-content"),d.TgZ(8,"p"),d._uU(9),d.qZA(),d.TgZ(10,"p"),d._uU(11),d.qZA(),d.qZA(),d.TgZ(12,"ion-item"),d.TgZ(13,"ion-note",8),d._UZ(14,"ion-icon",9),d._uU(15),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&Ze){const Ie=d.oxw();d.xp6(4),d.s9C("src",Ie.userProfile.ProfileImageURL,d.LSH),d.xp6(2),d.Oqu(Ie.userProfile.Username),d.xp6(3),d.hij(" ",Ie.userProfile.Profile,""),d.xp6(2),d.hij(" Date Joined: ",Ie.userProfile.DateCreated," "),d.xp6(4),d.hij(" ",Ie.userProfile.ReputationPoints," Contributor Points ")}}let Le=(()=>{class Ze{constructor(Ie,rt,kt,ri){this.appManager=Ie,this.nav=rt,this.translate=kt,this.modalController=ri}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),null!=this.userProfile&&this.appManager.isUserAuthenticated(!0)?this.refreshProfileView():this.showSignInModal(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:Ir.F,componentProps:{Profile:this.userProfile}}).then(Ie=>{Ie.onDidDismiss().then(()=>{this.refreshProfileView()}),Ie.present()})}close(){this.modalController.dismiss()}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.Y36(_r.c),d.Y36(zt.SH),d.Y36(oi.sK),d.Y36(zt.IN))},Ze.\u0275cmp=d.Xpm({type:Ze,selectors:[["ng-component"]],decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(Ie,rt){1&Ie&&(d.TgZ(0,"ion-header"),d.TgZ(1,"ion-toolbar"),d.TgZ(2,"ion-title"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA(),d.qZA(),d.TgZ(5,"ion-content",0),d.YNc(6,Ee,5,3,"div",1),d.YNc(7,xe,16,5,"div",1),d.qZA(),d.TgZ(8,"ion-footer"),d.TgZ(9,"ion-toolbar"),d.TgZ(10,"ion-buttons",2),d.TgZ(11,"ion-button",3),d.NdJ("click",function(){return rt.close()}),d._UZ(12,"ion-icon",4),d._uU(13," Close "),d.qZA(),d.qZA(),d.qZA(),d.qZA()),2&Ie&&(d.xp6(3),d.hij(" ",d.lcZ(4,3,"ocm.navigation.profile.sectionTitle")," "),d.xp6(3),d.Q6J("ngIf",null==rt.userProfile),d.xp6(1),d.Q6J("ngIf",null!=rt.userProfile))},directives:[zt.Gu,zt.sr,zt.wd,zt.W2,x.O5,zt.fr,zt.Sm,zt.YG,zt.gu,zt.PM,zt.Ie,zt.BJ,zt.FN,zt.uN],pipes:[oi.X$],encapsulation:2}),Ze})();var Ke=N(6505),$t=N(8260),Et=N(3357),Qt=N(6136),mn=N(2022),hn=N(9570),fn=N(2976),Vn=N(1278);const Fn=(0,Vn.fo)("PushNotifications",{}),pi=(0,Vn.fo)("StatusBar"),vi=(0,Vn.fo)("SplashScreen",{web:()=>N.e(5539).then(N.bind(N,5539)).then(Ze=>new Ze.SplashScreenWeb)}),ji=(0,Vn.fo)("App",{web:()=>N.e(4774).then(N.bind(N,4774)).then(Ze=>new Ze.AppWeb)});var Sr=N(9101);function yr(Ze,st){if(1&Ze){const Ie=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().openRoutePlannerModal()}),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-label"),d._uU(3," Route Planner "),d.qZA(),d.qZA()}}function qr(Ze,st){if(1&Ze){const Ie=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().add()}),d._UZ(1,"ion-icon",13),d.TgZ(2,"ion-label"),d._uU(3),d.ALo(4,"translate"),d.qZA(),d.qZA()}2&Ze&&(d.xp6(3),d.hij(" ",d.lcZ(4,1,"ocm.general.addLocation")," "))}function ur(Ze,st){if(1&Ze){const Ie=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().journeys()}),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-label"),d._uU(3," Journeys "),d.qZA(),d.qZA()}}function vo(Ze,st){if(1&Ze){const Ie=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().addLayer()}),d._UZ(1,"ion-icon",14),d.TgZ(2,"ion-label"),d._uU(3," Add Layer "),d.qZA(),d.qZA()}}function ss(Ze,st){if(1&Ze){const Ie=d.EpF();d.ynx(0),d.TgZ(1,"ion-item",9),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().signIn()}),d._UZ(2,"ion-icon",15),d.TgZ(3,"ion-label"),d._uU(4),d.ALo(5,"translate"),d.qZA(),d.qZA(),d.BQk()}2&Ze&&(d.xp6(4),d.hij(" ",d.lcZ(5,1,"ocm.general.signIn")," "))}function no(Ze,st){if(1&Ze){const Ie=d.EpF();d.ynx(0),d.TgZ(1,"ion-item",9),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().profile()}),d._UZ(2,"ion-icon",15),d.TgZ(3,"ion-label"),d._uU(4),d.ALo(5,"translate"),d.qZA(),d.qZA(),d.TgZ(6,"ion-item",9),d.NdJ("click",function(){return d.CHM(Ie),d.oxw().signOut()}),d._UZ(7,"ion-icon",16),d.TgZ(8,"ion-label"),d._uU(9),d.ALo(10,"translate"),d._UZ(11,"br"),d.TgZ(12,"small",17),d._uU(13),d.qZA(),d.qZA(),d.qZA(),d.BQk()}if(2&Ze){const Ie=d.oxw();d.xp6(4),d.hij(" ",d.lcZ(5,3,"ocm.navigation.profile.sectionTitle")," "),d.xp6(5),d.hij(" ",d.lcZ(10,5,"ocm.general.signOut")," "),d.xp6(4),d.hij(" ",Ie.getUserName(),"")}}const io=function(){return["/search"]};let To=(()=>{class Ze{constructor(Ie,rt,kt,ri,fi,dr,Cr,Gi){this.platform=Ie,this.translate=rt,this.mapping=kt,this.modalController=ri,this.appManager=fi,this.logger=dr,this.analytics=Cr,this.events=Gi,this.logger.log("Environment: "+$t.N.name),this.initializeApp(),this.enabledFeatures=$t.N.enabledFeatures,1!=fi.searchSettings.EnableAdvancedEditorFeatures&&(this.enabledFeatures=this.enabledFeatures.filter(Io=>"LAYERS"!=Io))}configurePushNotifications(){Fn.register(),Fn.addListener("registration",Ie=>{this.logger.log("Push registration success, token: "+Ie.value),this.appManager.savePushRegistration(Ie.value)}),Fn.addListener("registrationError",Ie=>{this.logger.log("Error on registration: "+JSON.stringify(Ie))}),Fn.addListener("pushNotificationReceived",Ie=>{this.logger.log("Push received: "+JSON.stringify(Ie),Ke.i.INFO)}),Fn.addListener("pushNotificationActionPerformed",Ie=>{this.logger.log("Push action performed: "+JSON.stringify(Ie))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let Ie=this.appManager.getUserProfile();return Ie?Ie.EmailAddress?Ie.EmailAddress:Ie.Username:"Not Signed In"}initializeApp(){var Ie=this;this.platform.ready().then(()=>{this.platform.is("capacitor")&&(pi.show(),vi.hide()),this.translate.addLangs(this.appManager.getLanguages().map(rt=>rt.code)),this.translate.setDefaultLang("en"),null!=this.appManager.searchSettings.Language?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(rt=>{}),this.analytics.init($t.N.analyticsId).then(()=>{this.analytics.setAppVersion($t.N.version),this.analytics.appEvent("Startup","App Loaded")}).catch(rt=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",function(){var rt=(0,jn.Z)(function*(kt){mn.c.isFeatureEnabled("ADD_POI")&&Ie.add(kt)});return function(kt){return rt.apply(this,arguments)}}()),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return(0,jn.Z)(function*(){ji.addListener("appUrlOpen",rt=>{alert("App (re)opened with URL: "+rt.url)});let Ie=yield ji.getLaunchUrl();Ie&&Ie.url&&alert("App opened with URL: "+Ie.url)})()}openRoutePlannerModal(){var Ie=this;return(0,jn.Z)(function*(){Ie.mapping.unfocusMap();const rt=yield Ie.modalController.create({component:Fr.u});rt.onDidDismiss().then(kt=>{Ie.mapping.focusMap()}),yield rt.present()})()}continueAdd(Ie){var rt=this;return(0,jn.Z)(function*(){const kt=yield rt.modalController.create({component:Et.Y,componentProps:{startPos:Ie}});kt.onDidDismiss().then(ri=>{rt.mapping.focusMap()}),yield kt.present()})()}add(Ie){var rt=this;return(0,jn.Z)(function*(){if(rt.mapping.unfocusMap(),!rt.appManager.isUserAuthenticated(!0)){const kt=yield rt.modalController.create({component:Ir.F});return kt.onDidDismiss().then(function(){var ri=(0,jn.Z)(function*(fi){rt.mapping.focusMap(),rt.appManager.isUserAuthenticated(!0)&&(yield rt.continueAdd(Ie))});return function(fi){return ri.apply(this,arguments)}}()),yield kt.present()}yield rt.continueAdd(Ie)})()}signIn(){var Ie=this;return(0,jn.Z)(function*(){Ie.mapping.unfocusMap();const rt=yield Ie.modalController.create({component:Ir.F});return rt.onDidDismiss().then(kt=>{Ie.mapping.focusMap(),Ie.appManager.isUserAuthenticated(!0)}),yield rt.present()})()}signOut(){var Ie=this;return(0,jn.Z)(function*(){Ie.appManager.signOutCurrentUser()})()}profile(){var Ie=this;return(0,jn.Z)(function*(){Ie.mapping.unfocusMap();const rt=yield Ie.modalController.create({component:Le});rt.onDidDismiss().then(kt=>{Ie.mapping.focusMap()}),yield rt.present()})()}journeys(){var Ie=this;return(0,jn.Z)(function*(){Ie.mapping.unfocusMap();const rt=yield Ie.modalController.create({component:Nr.g});rt.onDidDismiss().then(kt=>{Ie.mapping.focusMap()}),yield rt.present()})()}addLayer(){var Ie=this;return(0,jn.Z)(function*(){const rt=yield Ie.modalController.create({component:fn.A});yield rt.present();const{data:kt}=yield rt.onWillDismiss();kt&&Ie.mapping.addPOILayer(kt)})()}about(){var Ie=this;return(0,jn.Z)(function*(){Ie.mapping.unfocusMap();const rt=yield Ie.modalController.create({component:hn.t});rt.onDidDismiss().then(kt=>{Ie.mapping.focusMap()}),yield rt.present()})()}}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)(d.Y36(zt.t4),d.Y36(oi.sK),d.Y36($i.v),d.Y36(zt.IN),d.Y36(_r.c),d.Y36(Ke.z),d.Y36(Qt.c),d.Y36(Sr.z))},Ze.\u0275cmp=d.Xpm({type:Ze,selectors:[["app-root"]],decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(Ie,rt){1&Ie&&(d.TgZ(0,"ion-app"),d.TgZ(1,"ion-split-pane",0),d.TgZ(2,"ion-menu",1),d.TgZ(3,"ion-header"),d.TgZ(4,"ion-toolbar"),d.TgZ(5,"ion-thumbnail",2),d._UZ(6,"img",3),d.qZA(),d.TgZ(7,"ion-title"),d._uU(8),d.qZA(),d.qZA(),d.qZA(),d.TgZ(9,"ion-content"),d.TgZ(10,"ion-list"),d.TgZ(11,"ion-menu-toggle",4),d.TgZ(12,"ion-item",5),d._UZ(13,"ion-icon",6),d.TgZ(14,"ion-label"),d._uU(15),d.ALo(16,"translate"),d.qZA(),d.qZA(),d.YNc(17,yr,4,0,"ion-item",7),d.YNc(18,qr,5,3,"ion-item",7),d.YNc(19,ur,4,0,"ion-item",7),d.YNc(20,vo,4,0,"ion-item",7),d.YNc(21,ss,6,3,"ng-container",8),d.YNc(22,no,14,7,"ng-container",8),d.TgZ(23,"ion-item",9),d.NdJ("click",function(){return rt.about()}),d._UZ(24,"ion-icon",10),d.TgZ(25,"ion-label"),d._uU(26),d.ALo(27,"translate"),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d.qZA(),d._UZ(28,"ion-router-outlet",11),d.qZA(),d.qZA()),2&Ie&&(d.xp6(1),d.Q6J("disabled",!0),d.xp6(7),d.Oqu(rt.appManager.title),d.xp6(4),d.Q6J("routerDirection","root")("routerLink",d.DdM(16,io)),d.xp6(3),d.hij(" ",d.lcZ(16,12,"ocm.search.sectionTitle")," "),d.xp6(2),d.Q6J("ngIf",rt.enabledFeatures.includes("ROUTE_PLANNER")),d.xp6(1),d.Q6J("ngIf",rt.enabledFeatures.includes("ADD_POI")),d.xp6(1),d.Q6J("ngIf",rt.enabledFeatures.includes("FAVOURITES")),d.xp6(1),d.Q6J("ngIf",rt.enabledFeatures.includes("LAYERS")),d.xp6(1),d.Q6J("ngIf",!rt.isUserAuthenticated()),d.xp6(1),d.Q6J("ngIf",rt.isUserAuthenticated()),d.xp6(4),d.hij(" ",d.lcZ(27,14,"ocm.general.about")," "))},directives:[zt.dr,zt.jI,zt.z0,zt.Gu,zt.sr,zt.Bs,zt.wd,zt.W2,zt.q_,zt.zc,zt.Ie,zt.YI,Ii.rH,zt.gu,zt.Q$,x.O5,zt.jP],pipes:[oi.X$],encapsulation:2}),Ze})();const Ps=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>Promise.resolve().then(N.bind(N,2670)).then(Ze=>Ze.SearchPageModule)},{path:"journeys",loadChildren:()=>Promise.resolve().then(N.bind(N,2347)).then(Ze=>Ze.JourneysModule)},{path:"signin",loadChildren:()=>Promise.resolve().then(N.bind(N,6378)).then(Ze=>Ze.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>Promise.resolve().then(N.bind(N,2951)).then(Ze=>Ze.PoiEditorPageModule)},{path:"about",loadChildren:()=>Promise.resolve().then(N.bind(N,7368)).then(Ze=>Ze.AboutPageModule)},{path:"layer-editor",loadChildren:()=>Promise.resolve().then(N.bind(N,2326)).then(Ze=>Ze.LayerEditorPageModule)}];let as=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({imports:[[Ii.Bz.forRoot(Ps,{useHash:!0})],Ii.Bz]}),Ze})(),vs=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({imports:[[x.ez,En.u5,zt.Pc,oi.aw,Yn.e]]}),Ze})();var Rs=N(6378);let ls=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({imports:[[x.ez,En.u5,zt.Pc,oi.aw,Yn.e,Ii.Bz.forChild([{path:"",component:Le}])]]}),Ze})();var cs=N(2619);let Lo=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze}),Ze.\u0275inj=d.cJS({imports:[[x.ez,En.u5,zt.Pc,oi.aw,Yn.e,Ii.Bz.forChild([{path:"",component:cs.N}])]]}),Ze})();var js=N(2347),ko=N(2951),ma=N(7368),xs=N(2326);function ao(){return localStorage.getItem("access_token")}function Fo(Ze){return new Or(Ze,"/assets/i18n/",".json")}let Eo=(()=>{class Ze{}return Ze.\u0275fac=function(Ie){return new(Ie||Ze)},Ze.\u0275mod=d.oAB({type:Ze,bootstrap:[To]}),Ze.\u0275inj=d.cJS({providers:[{provide:Ii.wN,useClass:zt.r4}],imports:[[Ji,ui.JF,oi.aw.forRoot({loader:{provide:oi.Zw,useFactory:Fo,deps:[ui.eN]}}),zt.Pc.forRoot(),as,to.Ar.forRoot({config:{tokenGetter:ao}}),Ci.SearchPageModule,vs,js.JourneysModule,Rs.SignInModule,li,Zn,ti,ko.PoiEditorPageModule,ls,Lo,ma.AboutPageModule,xs.LayerEditorPageModule]]}),Ze})();$t.N.production&&(0,d.G48)(),wr().bootstrapModule(Eo).catch(Ze=>console.log(Ze))},863:(yn,je,N)=>{var x={"./ion-action-sheet.entry.js":[7572,8592,7572],"./ion-alert.entry.js":[1360,8592,1360],"./ion-app_8.entry.js":[4705,8592,4705],"./ion-avatar_3.entry.js":[9871,8592,9871],"./ion-back-button.entry.js":[2430,8592,2430],"./ion-backdrop.entry.js":[3206,3206],"./ion-button_2.entry.js":[9092,8592,9092],"./ion-card_5.entry.js":[1259,8592,1259],"./ion-checkbox.entry.js":[663,8592,663],"./ion-chip.entry.js":[1014,8592,1014],"./ion-col_3.entry.js":[5127,5127],"./ion-datetime_3.entry.js":[5847,8592,5847],"./ion-fab_3.entry.js":[4956,8592,4956],"./ion-img.entry.js":[3800,1915],"./ion-infinite-scroll_2.entry.js":[2259,8592,2259],"./ion-input.entry.js":[3148,8592,3148],"./ion-item-option_3.entry.js":[2753,8592,2753],"./ion-item_8.entry.js":[7446,8592,7446],"./ion-loading.entry.js":[8739,8592,8739],"./ion-menu_3.entry.js":[2473,8592,2473],"./ion-modal.entry.js":[9797,8592,9797],"./ion-nav_2.entry.js":[4138,8592,4138],"./ion-popover.entry.js":[1678,8592,1678],"./ion-progress-bar.entry.js":[2485,8592,2485],"./ion-radio_2.entry.js":[2787,8592,2787],"./ion-range.entry.js":[9009,8592,9009],"./ion-refresher_2.entry.js":[5570,8592,5570],"./ion-reorder_2.entry.js":[8953,8592,8953],"./ion-ripple-effect.entry.js":[5651,5651],"./ion-route_4.entry.js":[7957,8592,7957],"./ion-searchbar.entry.js":[4784,8592,4784],"./ion-segment_2.entry.js":[1662,8592,1662],"./ion-select_3.entry.js":[7668,8592,4099],"./ion-slide_2.entry.js":[170,170],"./ion-spinner.entry.js":[2691,8592,2691],"./ion-split-pane.entry.js":[7245,7245],"./ion-tab-bar_2.entry.js":[9500,8592,9500],"./ion-tab_2.entry.js":[167,8592,167],"./ion-text.entry.js":[1454,8592,1454],"./ion-textarea.entry.js":[8113,8592,8113],"./ion-toast.entry.js":[4269,8592,4269],"./ion-toggle.entry.js":[1772,8592,1772],"./ion-virtual-scroll.entry.js":[7014,7014]};function d(Y){if(!N.o(x,Y))return Promise.resolve().then(()=>{var O=new Error("Cannot find module '"+Y+"'");throw O.code="MODULE_NOT_FOUND",O});var l=x[Y],P=l[0];return Promise.all(l.slice(1).map(N.e)).then(()=>N(P))}d.keys=()=>Object.keys(x),d.id=863,yn.exports=d},6019:(yn,je,N)=>{"use strict";N.d(je,{mr:()=>Ae,ez:()=>Ze,K0:()=>f,uU:()=>Ps,JJ:()=>ko,Do:()=>He,V_:()=>K,Ye:()=>Ge,S$:()=>ze,sg:()=>Ir,O5:()=>Ee,b0:()=>Te,lw:()=>H,EM:()=>Io,JF:()=>Os,w_:()=>O,bD:()=>st,q:()=>Y,Mx:()=>Or,HT:()=>P});var x=N(865);let d=null;function Y(){return d}function P(ae){d||(d=ae)}class O{}const f=new x.OlP("DocumentToken");let H=(()=>{class ae{historyGo(I){throw new Error("Not implemented")}}return ae.\u0275fac=function(I){return new(I||ae)},ae.\u0275prov=x.Yz7({token:ae,factory:function(){return(0,x.LFG)(G)},providedIn:"platform"}),ae})();const K=new x.OlP("Location Initialized");let G=(()=>{class ae extends H{constructor(I){super(),this._doc=I,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Y().getBaseHref(this._doc)}onPopState(I){const S=Y().getGlobalEventTarget(this._doc,"window");return S.addEventListener("popstate",I,!1),()=>S.removeEventListener("popstate",I)}onHashChange(I){const S=Y().getGlobalEventTarget(this._doc,"window");return S.addEventListener("hashchange",I,!1),()=>S.removeEventListener("hashchange",I)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(I){this.location.pathname=I}pushState(I,S,le){ne()?this._history.pushState(I,S,le):this.location.hash=le}replaceState(I,S,le){ne()?this._history.replaceState(I,S,le):this.location.hash=le}forward(){this._history.forward()}back(){this._history.back()}historyGo(I=0){this._history.go(I)}getState(){return this._history.state}}return ae.\u0275fac=function(I){return new(I||ae)(x.LFG(f))},ae.\u0275prov=x.Yz7({token:ae,factory:function(){return new G((0,x.LFG)(f))},providedIn:"platform"}),ae})();function ne(){return!!window.history.pushState}function me(ae,B){if(0==ae.length)return B;if(0==B.length)return ae;let I=0;return ae.endsWith("/")&&I++,B.startsWith("/")&&I++,2==I?ae+B.substring(1):1==I?ae+B:ae+"/"+B}function ve(ae){const B=ae.match(/#|\?|$/),I=B&&B.index||ae.length;return ae.slice(0,I-("/"===ae[I-1]?1:0))+ae.slice(I)}function we(ae){return ae&&"?"!==ae[0]?"?"+ae:ae}let ze=(()=>{class ae{historyGo(I){throw new Error("Not implemented")}}return ae.\u0275fac=function(I){return new(I||ae)},ae.\u0275prov=x.Yz7({token:ae,factory:function(){return function(ae){const B=(0,x.LFG)(f).location;return new Te((0,x.LFG)(H),B&&B.origin||"")}()},providedIn:"root"}),ae})();const Ae=new x.OlP("appBaseHref");let Te=(()=>{class ae extends ze{constructor(I,S){if(super(),this._platformLocation=I,this._removeListenerFns=[],null==S&&(S=this._platformLocation.getBaseHrefFromDOM()),null==S)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=S}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}prepareExternalUrl(I){return me(this._baseHref,I)}path(I=!1){const S=this._platformLocation.pathname+we(this._platformLocation.search),le=this._platformLocation.hash;return le&&I?`${S}${le}`:S}pushState(I,S,le,Xe){const Jt=this.prepareExternalUrl(le+we(Xe));this._platformLocation.pushState(I,S,Jt)}replaceState(I,S,le,Xe){const Jt=this.prepareExternalUrl(le+we(Xe));this._platformLocation.replaceState(I,S,Jt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){this._platformLocation.historyGo?.(I)}}return ae.\u0275fac=function(I){return new(I||ae)(x.LFG(H),x.LFG(Ae,8))},ae.\u0275prov=x.Yz7({token:ae,factory:ae.\u0275fac}),ae})(),He=(()=>{class ae extends ze{constructor(I,S){super(),this._platformLocation=I,this._baseHref="",this._removeListenerFns=[],null!=S&&(this._baseHref=S)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(I){this._removeListenerFns.push(this._platformLocation.onPopState(I),this._platformLocation.onHashChange(I))}getBaseHref(){return this._baseHref}path(I=!1){let S=this._platformLocation.hash;return null==S&&(S="#"),S.length>0?S.substring(1):S}prepareExternalUrl(I){const S=me(this._baseHref,I);return S.length>0?"#"+S:S}pushState(I,S,le,Xe){let Jt=this.prepareExternalUrl(le+we(Xe));0==Jt.length&&(Jt=this._platformLocation.pathname),this._platformLocation.pushState(I,S,Jt)}replaceState(I,S,le,Xe){let Jt=this.prepareExternalUrl(le+we(Xe));0==Jt.length&&(Jt=this._platformLocation.pathname),this._platformLocation.replaceState(I,S,Jt)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(I=0){this._platformLocation.historyGo?.(I)}}return ae.\u0275fac=function(I){return new(I||ae)(x.LFG(H),x.LFG(Ae,8))},ae.\u0275prov=x.Yz7({token:ae,factory:ae.\u0275fac}),ae})(),Ge=(()=>{class ae{constructor(I,S){this._subject=new x.vpe,this._urlChangeListeners=[],this._platformStrategy=I;const le=this._platformStrategy.getBaseHref();this._platformLocation=S,this._baseHref=ve(Qe(le)),this._platformStrategy.onPopState(Xe=>{this._subject.emit({url:this.path(!0),pop:!0,state:Xe.state,type:Xe.type})})}path(I=!1){return this.normalize(this._platformStrategy.path(I))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(I,S=""){return this.path()==this.normalize(I+we(S))}normalize(I){return ae.stripTrailingSlash(function(ae,B){return ae&&B.startsWith(ae)?B.substring(ae.length):B}(this._baseHref,Qe(I)))}prepareExternalUrl(I){return I&&"/"!==I[0]&&(I="/"+I),this._platformStrategy.prepareExternalUrl(I)}go(I,S="",le=null){this._platformStrategy.pushState(le,"",I,S),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+we(S)),le)}replaceState(I,S="",le=null){this._platformStrategy.replaceState(le,"",I,S),this._notifyUrlChangeListeners(this.prepareExternalUrl(I+we(S)),le)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(I=0){this._platformStrategy.historyGo?.(I)}onUrlChange(I){this._urlChangeListeners.push(I),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(S=>{this._notifyUrlChangeListeners(S.url,S.state)}))}_notifyUrlChangeListeners(I="",S){this._urlChangeListeners.forEach(le=>le(I,S))}subscribe(I,S,le){return this._subject.subscribe({next:I,error:S,complete:le})}}return ae.normalizeQueryParams=we,ae.joinWithSlash=me,ae.stripTrailingSlash=ve,ae.\u0275fac=function(I){return new(I||ae)(x.LFG(ze),x.LFG(H))},ae.\u0275prov=x.Yz7({token:ae,factory:function(){return new Ge((0,x.LFG)(ze),(0,x.LFG)(H))},providedIn:"root"}),ae})();function Qe(ae){return ae.replace(/\/index.html$/,"")}var ct=(()=>((ct=ct||{})[ct.Decimal=0]="Decimal",ct[ct.Percent=1]="Percent",ct[ct.Currency=2]="Currency",ct[ct.Scientific=3]="Scientific",ct))(),gt=(()=>((gt=gt||{})[gt.Zero=0]="Zero",gt[gt.One=1]="One",gt[gt.Two=2]="Two",gt[gt.Few=3]="Few",gt[gt.Many=4]="Many",gt[gt.Other=5]="Other",gt))(),bt=(()=>((bt=bt||{})[bt.Format=0]="Format",bt[bt.Standalone=1]="Standalone",bt))(),ut=(()=>((ut=ut||{})[ut.Narrow=0]="Narrow",ut[ut.Abbreviated=1]="Abbreviated",ut[ut.Wide=2]="Wide",ut[ut.Short=3]="Short",ut))(),St=(()=>((St=St||{})[St.Short=0]="Short",St[St.Medium=1]="Medium",St[St.Long=2]="Long",St[St.Full=3]="Full",St))(),Vt=(()=>((Vt=Vt||{})[Vt.Decimal=0]="Decimal",Vt[Vt.Group=1]="Group",Vt[Vt.List=2]="List",Vt[Vt.PercentSign=3]="PercentSign",Vt[Vt.PlusSign=4]="PlusSign",Vt[Vt.MinusSign=5]="MinusSign",Vt[Vt.Exponential=6]="Exponential",Vt[Vt.SuperscriptingExponent=7]="SuperscriptingExponent",Vt[Vt.PerMille=8]="PerMille",Vt[Vt.Infinity=9]="Infinity",Vt[Vt.NaN=10]="NaN",Vt[Vt.TimeSeparator=11]="TimeSeparator",Vt[Vt.CurrencyDecimal=12]="CurrencyDecimal",Vt[Vt.CurrencyGroup=13]="CurrencyGroup",Vt))();function nn(ae,B){return _i((0,x.cg1)(ae)[x.wAp.DateFormat],B)}function tn(ae,B){return _i((0,x.cg1)(ae)[x.wAp.TimeFormat],B)}function en(ae,B){return _i((0,x.cg1)(ae)[x.wAp.DateTimeFormat],B)}function yt(ae,B){const I=(0,x.cg1)(ae),S=I[x.wAp.NumberSymbols][B];if(void 0===S){if(B===Vt.CurrencyDecimal)return I[x.wAp.NumberSymbols][Vt.Decimal];if(B===Vt.CurrencyGroup)return I[x.wAp.NumberSymbols][Vt.Group]}return S}const si=x.kL8;function Ki(ae){if(!ae[x.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${ae[x.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function _i(ae,B){for(let I=B;I>-1;I--)if(void 0!==ae[I])return ae[I];throw new Error("Locale data API: locale data undefined")}function bi(ae){const[B,I]=ae.split(":");return{hours:+B,minutes:+I}}const ft=/^(\d{4})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,pn={},_e=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Ye=(()=>((Ye=Ye||{})[Ye.Short=0]="Short",Ye[Ye.ShortGMT=1]="ShortGMT",Ye[Ye.Long=2]="Long",Ye[Ye.Extended=3]="Extended",Ye))(),j=(()=>((j=j||{})[j.FullYear=0]="FullYear",j[j.Month=1]="Month",j[j.Date=2]="Date",j[j.Hours=3]="Hours",j[j.Minutes=4]="Minutes",j[j.Seconds=5]="Seconds",j[j.FractionalSeconds=6]="FractionalSeconds",j[j.Day=7]="Day",j))(),ye=(()=>((ye=ye||{})[ye.DayPeriods=0]="DayPeriods",ye[ye.Days=1]="Days",ye[ye.Months=2]="Months",ye[ye.Eras=3]="Eras",ye))();function We(ae,B,I,S){let le=function(ae){if(lt(ae))return ae;if("number"==typeof ae&&!isNaN(ae))return new Date(ae);if("string"==typeof ae){if(ae=ae.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(ae)){const[le,Xe=1,Jt=1]=ae.split("-").map(Hn=>+Hn);return Tt(le,Xe-1,Jt)}const I=parseFloat(ae);if(!isNaN(ae-I))return new Date(I);let S;if(S=ae.match(ft))return function(ae){const B=new Date(0);let I=0,S=0;const le=ae[8]?B.setUTCFullYear:B.setFullYear,Xe=ae[8]?B.setUTCHours:B.setHours;ae[9]&&(I=Number(ae[9]+ae[10]),S=Number(ae[9]+ae[11])),le.call(B,Number(ae[1]),Number(ae[2])-1,Number(ae[3]));const Jt=Number(ae[4]||0)-I,Hn=Number(ae[5]||0)-S,wi=Number(ae[6]||0),Xi=Math.floor(1e3*parseFloat("0."+(ae[7]||0)));return Xe.call(B,Jt,Hn,wi,Xi),B}(S)}const B=new Date(ae);if(!lt(B))throw new Error(`Unable to convert "${ae}" into a date`);return B}(ae);B=on(I,B)||B;let Hn,Jt=[];for(;B;){if(Hn=_e.exec(B),!Hn){Jt.push(B);break}{Jt=Jt.concat(Hn.slice(1));const ar=Jt.pop();if(!ar)break;B=ar}}let wi=le.getTimezoneOffset();S&&(wi=pe(S,wi),le=function(ae,B,I){const le=ae.getTimezoneOffset();return function(ae,B){return(ae=new Date(ae.getTime())).setMinutes(ae.getMinutes()+B),ae}(ae,-1*(pe(B,le)-le))}(le,S));let Xi="";return Jt.forEach(ar=>{const nr=function(ae){if(ie[ae])return ie[ae];let B;switch(ae){case"G":case"GG":case"GGG":B=Ti(ye.Eras,ut.Abbreviated);break;case"GGGG":B=Ti(ye.Eras,ut.Wide);break;case"GGGGG":B=Ti(ye.Eras,ut.Narrow);break;case"y":B=Un(j.FullYear,1,0,!1,!0);break;case"yy":B=Un(j.FullYear,2,0,!0,!0);break;case"yyy":B=Un(j.FullYear,3,0,!1,!0);break;case"yyyy":B=Un(j.FullYear,4,0,!1,!0);break;case"Y":B=re(1);break;case"YY":B=re(2,!0);break;case"YYY":B=re(3);break;case"YYYY":B=re(4);break;case"M":case"L":B=Un(j.Month,1,1);break;case"MM":case"LL":B=Un(j.Month,2,1);break;case"MMM":B=Ti(ye.Months,ut.Abbreviated);break;case"MMMM":B=Ti(ye.Months,ut.Wide);break;case"MMMMM":B=Ti(ye.Months,ut.Narrow);break;case"LLL":B=Ti(ye.Months,ut.Abbreviated,bt.Standalone);break;case"LLLL":B=Ti(ye.Months,ut.Wide,bt.Standalone);break;case"LLLLL":B=Ti(ye.Months,ut.Narrow,bt.Standalone);break;case"w":B=hi(1);break;case"ww":B=hi(2);break;case"W":B=hi(1,!0);break;case"d":B=Un(j.Date,1);break;case"dd":B=Un(j.Date,2);break;case"c":case"cc":B=Un(j.Day,1);break;case"ccc":B=Ti(ye.Days,ut.Abbreviated,bt.Standalone);break;case"cccc":B=Ti(ye.Days,ut.Wide,bt.Standalone);break;case"ccccc":B=Ti(ye.Days,ut.Narrow,bt.Standalone);break;case"cccccc":B=Ti(ye.Days,ut.Short,bt.Standalone);break;case"E":case"EE":case"EEE":B=Ti(ye.Days,ut.Abbreviated);break;case"EEEE":B=Ti(ye.Days,ut.Wide);break;case"EEEEE":B=Ti(ye.Days,ut.Narrow);break;case"EEEEEE":B=Ti(ye.Days,ut.Short);break;case"a":case"aa":case"aaa":B=Ti(ye.DayPeriods,ut.Abbreviated);break;case"aaaa":B=Ti(ye.DayPeriods,ut.Wide);break;case"aaaaa":B=Ti(ye.DayPeriods,ut.Narrow);break;case"b":case"bb":case"bbb":B=Ti(ye.DayPeriods,ut.Abbreviated,bt.Standalone,!0);break;case"bbbb":B=Ti(ye.DayPeriods,ut.Wide,bt.Standalone,!0);break;case"bbbbb":B=Ti(ye.DayPeriods,ut.Narrow,bt.Standalone,!0);break;case"B":case"BB":case"BBB":B=Ti(ye.DayPeriods,ut.Abbreviated,bt.Format,!0);break;case"BBBB":B=Ti(ye.DayPeriods,ut.Wide,bt.Format,!0);break;case"BBBBB":B=Ti(ye.DayPeriods,ut.Narrow,bt.Format,!0);break;case"h":B=Un(j.Hours,1,-12);break;case"hh":B=Un(j.Hours,2,-12);break;case"H":B=Un(j.Hours,1);break;case"HH":B=Un(j.Hours,2);break;case"m":B=Un(j.Minutes,1);break;case"mm":B=Un(j.Minutes,2);break;case"s":B=Un(j.Seconds,1);break;case"ss":B=Un(j.Seconds,2);break;case"S":B=Un(j.FractionalSeconds,1);break;case"SS":B=Un(j.FractionalSeconds,2);break;case"SSS":B=Un(j.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":B=br(Ye.Short);break;case"ZZZZZ":B=br(Ye.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":B=br(Ye.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":B=br(Ye.Long);break;default:return null}return ie[ae]=B,B}(ar);Xi+=nr?nr(le,I,wi):"''"===ar?"'":ar.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Xi}function Tt(ae,B,I){const S=new Date(0);return S.setFullYear(ae,B,I),S.setHours(0,0,0),S}function on(ae,B){const I=function(ae){return(0,x.cg1)(ae)[x.wAp.LocaleId]}(ae);if(pn[I]=pn[I]||{},pn[I][B])return pn[I][B];let S="";switch(B){case"shortDate":S=nn(ae,St.Short);break;case"mediumDate":S=nn(ae,St.Medium);break;case"longDate":S=nn(ae,St.Long);break;case"fullDate":S=nn(ae,St.Full);break;case"shortTime":S=tn(ae,St.Short);break;case"mediumTime":S=tn(ae,St.Medium);break;case"longTime":S=tn(ae,St.Long);break;case"fullTime":S=tn(ae,St.Full);break;case"short":const le=on(ae,"shortTime"),Xe=on(ae,"shortDate");S=qn(en(ae,St.Short),[le,Xe]);break;case"medium":const Jt=on(ae,"mediumTime"),Hn=on(ae,"mediumDate");S=qn(en(ae,St.Medium),[Jt,Hn]);break;case"long":const wi=on(ae,"longTime"),Xi=on(ae,"longDate");S=qn(en(ae,St.Long),[wi,Xi]);break;case"full":const ar=on(ae,"fullTime"),nr=on(ae,"fullDate");S=qn(en(ae,St.Full),[ar,nr])}return S&&(pn[I][B]=S),S}function qn(ae,B){return B&&(ae=ae.replace(/\{([^}]+)}/g,function(I,S){return null!=B&&S in B?B[S]:I})),ae}function ci(ae,B,I="-",S,le){let Xe="";(ae<0||le&&ae<=0)&&(le?ae=1-ae:(ae=-ae,Xe=I));let Jt=String(ae);for(;Jt.length<B;)Jt="0"+Jt;return S&&(Jt=Jt.substr(Jt.length-B)),Xe+Jt}function Un(ae,B,I=0,S=!1,le=!1){return function(Xe,Jt){let Hn=function(ae,B){switch(ae){case j.FullYear:return B.getFullYear();case j.Month:return B.getMonth();case j.Date:return B.getDate();case j.Hours:return B.getHours();case j.Minutes:return B.getMinutes();case j.Seconds:return B.getSeconds();case j.FractionalSeconds:return B.getMilliseconds();case j.Day:return B.getDay();default:throw new Error(`Unknown DateType value "${ae}".`)}}(ae,Xe);if((I>0||Hn>-I)&&(Hn+=I),ae===j.Hours)0===Hn&&-12===I&&(Hn=12);else if(ae===j.FractionalSeconds)return function(ae,B){return ci(ae,3).substr(0,B)}(Hn,B);const wi=yt(Jt,Vt.MinusSign);return ci(Hn,B,wi,S,le)}}function Ti(ae,B,I=bt.Format,S=!1){return function(le,Xe){return function(ae,B,I,S,le,Xe){switch(I){case ye.Months:return function(ae,B,I){const S=(0,x.cg1)(ae),Xe=_i([S[x.wAp.MonthsFormat],S[x.wAp.MonthsStandalone]],B);return _i(Xe,I)}(B,le,S)[ae.getMonth()];case ye.Days:return function(ae,B,I){const S=(0,x.cg1)(ae),Xe=_i([S[x.wAp.DaysFormat],S[x.wAp.DaysStandalone]],B);return _i(Xe,I)}(B,le,S)[ae.getDay()];case ye.DayPeriods:const Jt=ae.getHours(),Hn=ae.getMinutes();if(Xe){const Xi=function(ae){const B=(0,x.cg1)(ae);return Ki(B),(B[x.wAp.ExtraData][2]||[]).map(S=>"string"==typeof S?bi(S):[bi(S[0]),bi(S[1])])}(B),ar=function(ae,B,I){const S=(0,x.cg1)(ae);Ki(S);const Xe=_i([S[x.wAp.ExtraData][0],S[x.wAp.ExtraData][1]],B)||[];return _i(Xe,I)||[]}(B,le,S),nr=Xi.findIndex(Ri=>{if(Array.isArray(Ri)){const[Dr,Wr]=Ri,go=Jt>=Dr.hours&&Hn>=Dr.minutes,Lr=Jt<Wr.hours||Jt===Wr.hours&&Hn<Wr.minutes;if(Dr.hours<Wr.hours){if(go&&Lr)return!0}else if(go||Lr)return!0}else if(Ri.hours===Jt&&Ri.minutes===Hn)return!0;return!1});if(-1!==nr)return ar[nr]}return function(ae,B,I){const S=(0,x.cg1)(ae),Xe=_i([S[x.wAp.DayPeriodsFormat],S[x.wAp.DayPeriodsStandalone]],B);return _i(Xe,I)}(B,le,S)[Jt<12?0:1];case ye.Eras:return function(ae,B){return _i((0,x.cg1)(ae)[x.wAp.Eras],B)}(B,S)[ae.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${I}`)}}(le,Xe,ae,B,I,S)}}function br(ae){return function(B,I,S){const le=-1*S,Xe=yt(I,Vt.MinusSign),Jt=le>0?Math.floor(le/60):Math.ceil(le/60);switch(ae){case Ye.Short:return(le>=0?"+":"")+ci(Jt,2,Xe)+ci(Math.abs(le%60),2,Xe);case Ye.ShortGMT:return"GMT"+(le>=0?"+":"")+ci(Jt,1,Xe);case Ye.Long:return"GMT"+(le>=0?"+":"")+ci(Jt,2,Xe)+":"+ci(Math.abs(le%60),2,Xe);case Ye.Extended:return 0===S?"Z":(le>=0?"+":"")+ci(Jt,2,Xe)+":"+ci(Math.abs(le%60),2,Xe);default:throw new Error(`Unknown zone width "${ae}"`)}}}function Ji(ae){return Tt(ae.getFullYear(),ae.getMonth(),ae.getDate()+(4-ae.getDay()))}function hi(ae,B=!1){return function(I,S){let le;if(B){const Xe=new Date(I.getFullYear(),I.getMonth(),1).getDay()-1,Jt=I.getDate();le=1+Math.floor((Jt+Xe)/7)}else{const Xe=Ji(I),Jt=function(ae){const B=Tt(ae,0,1).getDay();return Tt(ae,0,1+(B<=4?4:11)-B)}(Xe.getFullYear()),Hn=Xe.getTime()-Jt.getTime();le=1+Math.round(Hn/6048e5)}return ci(le,ae,yt(S,Vt.MinusSign))}}function re(ae,B=!1){return function(I,S){return ci(Ji(I).getFullYear(),ae,yt(S,Vt.MinusSign),B)}}const ie={};function pe(ae,B){ae=ae.replace(/:/g,"");const I=Date.parse("Jan 01, 1970 00:00:00 "+ae)/6e4;return isNaN(I)?B:I}function lt(ae){return ae instanceof Date&&!isNaN(ae.valueOf())}const Dt=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function li(ae){const B=parseInt(ae);if(isNaN(B))throw new Error("Invalid integer literal when parsing "+ae);return B}class Ci{}let Ii=(()=>{class ae extends Ci{constructor(I){super(),this.locale=I}getPluralCategory(I,S){switch(si(S||this.locale)(I)){case gt.Zero:return"zero";case gt.One:return"one";case gt.Two:return"two";case gt.Few:return"few";case gt.Many:return"many";default:return"other"}}}return ae.\u0275fac=function(I){return new(I||ae)(x.LFG(x.soG))},ae.\u0275prov=x.Yz7({token:ae,factory:ae.\u0275fac}),ae})();function Or(ae,B){B=encodeURIComponent(B);for(const I of ae.split(";")){const S=I.indexOf("="),[le,Xe]=-1==S?[I,""]:[I.slice(0,S),I.slice(S+1)];if(le.trim()===B)return decodeURIComponent(Xe)}return null}class Fr{constructor(B,I,S,le){this.$implicit=B,this.ngForOf=I,this.index=S,this.count=le}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let Ir=(()=>{class ae{constructor(I,S,le){this._viewContainer=I,this._template=S,this._differs=le,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForOf(I){this._ngForOf=I,this._ngForOfDirty=!0}set ngForTrackBy(I){this._trackByFn=I}get ngForTrackBy(){return this._trackByFn}set ngForTemplate(I){I&&(this._template=I)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const I=this._ngForOf;if(!this._differ&&I)try{this._differ=this._differs.find(I).create(this.ngForTrackBy)}catch{throw new Error(`Cannot find a differ supporting object '${I}' of type '${function(ae){return ae.name||typeof ae}(I)}'. NgFor only supports binding to Iterables such as Arrays.`)}}if(this._differ){const I=this._differ.diff(this._ngForOf);I&&this._applyChanges(I)}}_applyChanges(I){const S=[];I.forEachOperation((le,Xe,Jt)=>{if(null==le.previousIndex){const Hn=this._viewContainer.createEmbeddedView(this._template,new Fr(null,this._ngForOf,-1,-1),null===Jt?void 0:Jt),wi=new Nr(le,Hn);S.push(wi)}else if(null==Jt)this._viewContainer.remove(null===Xe?void 0:Xe);else if(null!==Xe){const Hn=this._viewContainer.get(Xe);this._viewContainer.move(Hn,Jt);const wi=new Nr(le,Hn);S.push(wi)}});for(let le=0;le<S.length;le++)this._perViewChange(S[le].view,S[le].record);for(let le=0,Xe=this._viewContainer.length;le<Xe;le++){const Jt=this._viewContainer.get(le);Jt.context.index=le,Jt.context.count=Xe,Jt.context.ngForOf=this._ngForOf}I.forEachIdentityChange(le=>{this._viewContainer.get(le.currentIndex).context.$implicit=le.item})}_perViewChange(I,S){I.context.$implicit=S.item}static ngTemplateContextGuard(I,S){return!0}}return ae.\u0275fac=function(I){return new(I||ae)(x.Y36(x.s_b),x.Y36(x.Rgc),x.Y36(x.ZZ4))},ae.\u0275dir=x.lG2({type:ae,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"}}),ae})();class Nr{constructor(B,I){this.record=B,this.view=I}}let Ee=(()=>{class ae{constructor(I,S){this._viewContainer=I,this._context=new xe,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=S}set ngIf(I){this._context.$implicit=this._context.ngIf=I,this._updateView()}set ngIfThen(I){Le("ngIfThen",I),this._thenTemplateRef=I,this._thenViewRef=null,this._updateView()}set ngIfElse(I){Le("ngIfElse",I),this._elseTemplateRef=I,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(I,S){return!0}}return ae.\u0275fac=function(I){return new(I||ae)(x.Y36(x.s_b),x.Y36(x.Rgc))},ae.\u0275dir=x.lG2({type:ae,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),ae})();class xe{constructor(){this.$implicit=null,this.ngIf=null}}function Le(ae,B){if(B&&!B.createEmbeddedView)throw new Error(`${ae} must be a TemplateRef, but received '${(0,x.AaK)(B)}'.`)}function vi(ae,B){return Error(`InvalidPipeArgument: '${B}' for pipe '${(0,x.AaK)(ae)}'`)}const To=new x.OlP("DATE_PIPE_DEFAULT_TIMEZONE");let Ps=(()=>{class ae{constructor(I,S){this.locale=I,this.defaultTimezone=S}transform(I,S="mediumDate",le,Xe){if(null==I||""===I||I!=I)return null;try{return We(I,S,Xe||this.locale,le??this.defaultTimezone??void 0)}catch(Jt){throw vi(ae,Jt.message)}}}return ae.\u0275fac=function(I){return new(I||ae)(x.Y36(x.soG,16),x.Y36(To,24))},ae.\u0275pipe=x.Yjl({name:"date",type:ae,pure:!0}),ae})(),ko=(()=>{class ae{constructor(I){this._locale=I}transform(I,S,le){if(!function(ae){return!(null==ae||""===ae||ae!=ae)}(I))return null;le=le||this._locale;try{return function(ae,B,I){return function(ae,B,I,S,le,Xe,Jt=!1){let Hn="",wi=!1;if(isFinite(ae)){let Xi=function(ae){let S,le,Xe,Jt,Hn,B=Math.abs(ae)+"",I=0;for((le=B.indexOf("."))>-1&&(B=B.replace(".","")),(Xe=B.search(/e/i))>0?(le<0&&(le=Xe),le+=+B.slice(Xe+1),B=B.substring(0,Xe)):le<0&&(le=B.length),Xe=0;"0"===B.charAt(Xe);Xe++);if(Xe===(Hn=B.length))S=[0],le=1;else{for(Hn--;"0"===B.charAt(Hn);)Hn--;for(le-=Xe,S=[],Jt=0;Xe<=Hn;Xe++,Jt++)S[Jt]=Number(B.charAt(Xe))}return le>22&&(S=S.splice(0,21),I=le-1,le=1),{digits:S,exponent:I,integerLen:le}}(ae);Jt&&(Xi=function(ae){if(0===ae.digits[0])return ae;const B=ae.digits.length-ae.integerLen;return ae.exponent?ae.exponent+=2:(0===B?ae.digits.push(0,0):1===B&&ae.digits.push(0),ae.integerLen+=2),ae}(Xi));let ar=B.minInt,nr=B.minFrac,Ri=B.maxFrac;if(Xe){const qo=Xe.match(Dt);if(null===qo)throw new Error(`${Xe} is not a valid digit info`);const sa=qo[1],Pr=qo[3],ks=qo[5];null!=sa&&(ar=li(sa)),null!=Pr&&(nr=li(Pr)),null!=ks?Ri=li(ks):null!=Pr&&nr>Ri&&(Ri=nr)}!function(ae,B,I){if(B>I)throw new Error(`The minimum number of digits after fraction (${B}) is higher than the maximum (${I}).`);let S=ae.digits,le=S.length-ae.integerLen;const Xe=Math.min(Math.max(B,le),I);let Jt=Xe+ae.integerLen,Hn=S[Jt];if(Jt>0){S.splice(Math.max(ae.integerLen,Jt));for(let nr=Jt;nr<S.length;nr++)S[nr]=0}else{le=Math.max(0,le),ae.integerLen=1,S.length=Math.max(1,Jt=Xe+1),S[0]=0;for(let nr=1;nr<Jt;nr++)S[nr]=0}if(Hn>=5)if(Jt-1<0){for(let nr=0;nr>Jt;nr--)S.unshift(0),ae.integerLen++;S.unshift(1),ae.integerLen++}else S[Jt-1]++;for(;le<Math.max(0,Xe);le++)S.push(0);let wi=0!==Xe;const Xi=B+ae.integerLen,ar=S.reduceRight(function(nr,Ri,Dr,Wr){return Wr[Dr]=(Ri+=nr)<10?Ri:Ri-10,wi&&(0===Wr[Dr]&&Dr>=Xi?Wr.pop():wi=!1),Ri>=10?1:0},0);ar&&(S.unshift(ar),ae.integerLen++)}(Xi,nr,Ri);let Dr=Xi.digits,Wr=Xi.integerLen;const go=Xi.exponent;let Lr=[];for(wi=Dr.every(qo=>!qo);Wr<ar;Wr++)Dr.unshift(0);for(;Wr<0;Wr++)Dr.unshift(0);Wr>0?Lr=Dr.splice(Wr,Dr.length):(Lr=Dr,Dr=[0]);const Ls=[];for(Dr.length>=B.lgSize&&Ls.unshift(Dr.splice(-B.lgSize,Dr.length).join(""));Dr.length>B.gSize;)Ls.unshift(Dr.splice(-B.gSize,Dr.length).join(""));Dr.length&&Ls.unshift(Dr.join("")),Hn=Ls.join(yt(I,S)),Lr.length&&(Hn+=yt(I,le)+Lr.join("")),go&&(Hn+=yt(I,Vt.Exponential)+"+"+go)}else Hn=yt(I,Vt.Infinity);return Hn=ae<0&&!wi?B.negPre+Hn+B.negSuf:B.posPre+Hn+B.posSuf,Hn}(ae,function(ae,B="-"){const I={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},S=ae.split(";"),le=S[0],Xe=S[1],Jt=-1!==le.indexOf(".")?le.split("."):[le.substring(0,le.lastIndexOf("0")+1),le.substring(le.lastIndexOf("0")+1)],Hn=Jt[0],wi=Jt[1]||"";I.posPre=Hn.substr(0,Hn.indexOf("#"));for(let ar=0;ar<wi.length;ar++){const nr=wi.charAt(ar);"0"===nr?I.minFrac=I.maxFrac=ar+1:"#"===nr?I.maxFrac=ar+1:I.posSuf+=nr}const Xi=Hn.split(",");if(I.gSize=Xi[1]?Xi[1].length:0,I.lgSize=Xi[2]||Xi[1]?(Xi[2]||Xi[1]).length:0,Xe){const ar=le.length-I.posPre.length-I.posSuf.length,nr=Xe.indexOf("#");I.negPre=Xe.substr(0,nr).replace(/'/g,""),I.negSuf=Xe.substr(nr+ar).replace(/'/g,"")}else I.negPre=B+I.posPre,I.negSuf=I.posSuf;return I}(function(ae,B){return(0,x.cg1)(ae)[x.wAp.NumberFormats][B]}(B,ct.Decimal),yt(B,Vt.MinusSign)),B,Vt.Group,Vt.Decimal,I)}(function(ae){if("string"==typeof ae&&!isNaN(Number(ae)-parseFloat(ae)))return Number(ae);if("number"!=typeof ae)throw new Error(`${ae} is not a number`);return ae}(I),le,S)}catch(Xe){throw vi(ae,Xe.message)}}}return ae.\u0275fac=function(I){return new(I||ae)(x.Y36(x.soG,16))},ae.\u0275pipe=x.Yjl({name:"number",type:ae,pure:!0}),ae})();let Ze=(()=>{class ae{}return ae.\u0275fac=function(I){return new(I||ae)},ae.\u0275mod=x.oAB({type:ae}),ae.\u0275inj=x.cJS({providers:[{provide:Ci,useClass:Ii}]}),ae})();const st="browser";let Io=(()=>{class ae{}return ae.\u0275prov=(0,x.Yz7)({token:ae,providedIn:"root",factory:()=>new bs((0,x.LFG)(f),window)}),ae})();class bs{constructor(B,I){this.document=B,this.window=I,this.offset=()=>[0,0]}setOffset(B){this.offset=Array.isArray(B)?()=>B:B}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(B){this.supportsScrolling()&&this.window.scrollTo(B[0],B[1])}scrollToAnchor(B){if(!this.supportsScrolling())return;const I=function(ae,B){const I=ae.getElementById(B)||ae.getElementsByName(B)[0];if(I)return I;if("function"==typeof ae.createTreeWalker&&ae.body&&(ae.body.createShadowRoot||ae.body.attachShadow)){const S=ae.createTreeWalker(ae.body,NodeFilter.SHOW_ELEMENT);let le=S.currentNode;for(;le;){const Xe=le.shadowRoot;if(Xe){const Jt=Xe.getElementById(B)||Xe.querySelector(`[name="${B}"]`);if(Jt)return Jt}le=S.nextNode()}}return null}(this.document,B);I&&(this.scrollToElement(I),this.attemptFocus(I))}setHistoryScrollRestoration(B){if(this.supportScrollRestoration()){const I=this.window.history;I&&I.scrollRestoration&&(I.scrollRestoration=B)}}scrollToElement(B){const I=B.getBoundingClientRect(),S=I.left+this.window.pageXOffset,le=I.top+this.window.pageYOffset,Xe=this.offset();this.window.scrollTo(S-Xe[0],le-Xe[1])}attemptFocus(B){return B.focus(),this.document.activeElement===B}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const B=Yo(this.window.history)||Yo(Object.getPrototypeOf(this.window.history));return!(!B||!B.writable&&!B.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Yo(ae){return Object.getOwnPropertyDescriptor(ae,"scrollRestoration")}class Os{}},4522:(yn,je,N)=>{"use strict";N.d(je,{TP:()=>Nt,eN:()=>Vt,JF:()=>_i,WM:()=>K});var x=N(6019),d=N(865),Y=N(2411),l=N(5548),P=N(6700),O=N(8735),f=N(8053);class H{}class te{}class K{constructor(ot){this.normalizedNames=new Map,this.lazyUpdate=null,ot?this.lazyInit="string"==typeof ot?()=>{this.headers=new Map,ot.split("\n").forEach(ft=>{const pn=ft.indexOf(":");if(pn>0){const _e=ft.slice(0,pn),Ye=_e.toLowerCase(),j=ft.slice(pn+1).trim();this.maybeSetNormalizedName(_e,Ye),this.headers.has(Ye)?this.headers.get(Ye).push(j):this.headers.set(Ye,[j])}})}:()=>{this.headers=new Map,Object.keys(ot).forEach(ft=>{let pn=ot[ft];const _e=ft.toLowerCase();"string"==typeof pn&&(pn=[pn]),pn.length>0&&(this.headers.set(_e,pn),this.maybeSetNormalizedName(ft,_e))})}:this.headers=new Map}has(ot){return this.init(),this.headers.has(ot.toLowerCase())}get(ot){this.init();const ft=this.headers.get(ot.toLowerCase());return ft&&ft.length>0?ft[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(ot){return this.init(),this.headers.get(ot.toLowerCase())||null}append(ot,ft){return this.clone({name:ot,value:ft,op:"a"})}set(ot,ft){return this.clone({name:ot,value:ft,op:"s"})}delete(ot,ft){return this.clone({name:ot,value:ft,op:"d"})}maybeSetNormalizedName(ot,ft){this.normalizedNames.has(ft)||this.normalizedNames.set(ft,ot)}init(){this.lazyInit&&(this.lazyInit instanceof K?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(ot=>this.applyUpdate(ot)),this.lazyUpdate=null))}copyFrom(ot){ot.init(),Array.from(ot.headers.keys()).forEach(ft=>{this.headers.set(ft,ot.headers.get(ft)),this.normalizedNames.set(ft,ot.normalizedNames.get(ft))})}clone(ot){const ft=new K;return ft.lazyInit=this.lazyInit&&this.lazyInit instanceof K?this.lazyInit:this,ft.lazyUpdate=(this.lazyUpdate||[]).concat([ot]),ft}applyUpdate(ot){const ft=ot.name.toLowerCase();switch(ot.op){case"a":case"s":let pn=ot.value;if("string"==typeof pn&&(pn=[pn]),0===pn.length)return;this.maybeSetNormalizedName(ot.name,ft);const _e=("a"===ot.op?this.headers.get(ft):void 0)||[];_e.push(...pn),this.headers.set(ft,_e);break;case"d":const Ye=ot.value;if(Ye){let j=this.headers.get(ft);if(!j)return;j=j.filter(ye=>-1===Ye.indexOf(ye)),0===j.length?(this.headers.delete(ft),this.normalizedNames.delete(ft)):this.headers.set(ft,j)}else this.headers.delete(ft),this.normalizedNames.delete(ft)}}forEach(ot){this.init(),Array.from(this.normalizedNames.keys()).forEach(ft=>ot(this.normalizedNames.get(ft),this.headers.get(ft)))}}class G{encodeKey(ot){return ve(ot)}encodeValue(ot){return ve(ot)}decodeKey(ot){return decodeURIComponent(ot)}decodeValue(ot){return decodeURIComponent(ot)}}const ce=/%(\d[a-f0-9])/gi,me={40:"@","3A":":",24:"$","2C":",","3B":";","2B":"+","3D":"=","3F":"?","2F":"/"};function ve(rn){return encodeURIComponent(rn).replace(ce,(ot,ft)=>me[ft]??ot)}function we(rn){return`${rn}`}class ze{constructor(ot={}){if(this.updates=null,this.cloneFrom=null,this.encoder=ot.encoder||new G,ot.fromString){if(ot.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function(rn,ot){const ft=new Map;return rn.length>0&&rn.replace(/^\?/,"").split("&").forEach(_e=>{const Ye=_e.indexOf("="),[j,ye]=-1==Ye?[ot.decodeKey(_e),""]:[ot.decodeKey(_e.slice(0,Ye)),ot.decodeValue(_e.slice(Ye+1))],We=ft.get(j)||[];We.push(ye),ft.set(j,We)}),ft}(ot.fromString,this.encoder)}else ot.fromObject?(this.map=new Map,Object.keys(ot.fromObject).forEach(ft=>{const pn=ot.fromObject[ft];this.map.set(ft,Array.isArray(pn)?pn:[pn])})):this.map=null}has(ot){return this.init(),this.map.has(ot)}get(ot){this.init();const ft=this.map.get(ot);return ft?ft[0]:null}getAll(ot){return this.init(),this.map.get(ot)||null}keys(){return this.init(),Array.from(this.map.keys())}append(ot,ft){return this.clone({param:ot,value:ft,op:"a"})}appendAll(ot){const ft=[];return Object.keys(ot).forEach(pn=>{const _e=ot[pn];Array.isArray(_e)?_e.forEach(Ye=>{ft.push({param:pn,value:Ye,op:"a"})}):ft.push({param:pn,value:_e,op:"a"})}),this.clone(ft)}set(ot,ft){return this.clone({param:ot,value:ft,op:"s"})}delete(ot,ft){return this.clone({param:ot,value:ft,op:"d"})}toString(){return this.init(),this.keys().map(ot=>{const ft=this.encoder.encodeKey(ot);return this.map.get(ot).map(pn=>ft+"="+this.encoder.encodeValue(pn)).join("&")}).filter(ot=>""!==ot).join("&")}clone(ot){const ft=new ze({encoder:this.encoder});return ft.cloneFrom=this.cloneFrom||this,ft.updates=(this.updates||[]).concat(ot),ft}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(ot=>this.map.set(ot,this.cloneFrom.map.get(ot))),this.updates.forEach(ot=>{switch(ot.op){case"a":case"s":const ft=("a"===ot.op?this.map.get(ot.param):void 0)||[];ft.push(we(ot.value)),this.map.set(ot.param,ft);break;case"d":if(void 0===ot.value){this.map.delete(ot.param);break}{let pn=this.map.get(ot.param)||[];const _e=pn.indexOf(we(ot.value));-1!==_e&&pn.splice(_e,1),pn.length>0?this.map.set(ot.param,pn):this.map.delete(ot.param)}}}),this.cloneFrom=this.updates=null)}}class Ae{constructor(){this.map=new Map}set(ot,ft){return this.map.set(ot,ft),this}get(ot){return this.map.has(ot)||this.map.set(ot,ot.defaultValue()),this.map.get(ot)}delete(ot){return this.map.delete(ot),this}keys(){return this.map.keys()}}function He(rn){return"undefined"!=typeof ArrayBuffer&&rn instanceof ArrayBuffer}function Ge(rn){return"undefined"!=typeof Blob&&rn instanceof Blob}function Fe(rn){return"undefined"!=typeof FormData&&rn instanceof FormData}class Qe{constructor(ot,ft,pn,_e){let Ye;if(this.url=ft,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=ot.toUpperCase(),function(rn){switch(rn){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||_e?(this.body=void 0!==pn?pn:null,Ye=_e):Ye=pn,Ye&&(this.reportProgress=!!Ye.reportProgress,this.withCredentials=!!Ye.withCredentials,Ye.responseType&&(this.responseType=Ye.responseType),Ye.headers&&(this.headers=Ye.headers),Ye.context&&(this.context=Ye.context),Ye.params&&(this.params=Ye.params)),this.headers||(this.headers=new K),this.context||(this.context=new Ae),this.params){const j=this.params.toString();if(0===j.length)this.urlWithParams=ft;else{const ye=ft.indexOf("?");this.urlWithParams=ft+(-1===ye?"?":ye<ft.length-1?"&":"")+j}}else this.params=new ze,this.urlWithParams=ft}serializeBody(){return null===this.body?null:He(this.body)||Ge(this.body)||Fe(this.body)||"undefined"!=typeof URLSearchParams&&this.body instanceof URLSearchParams||"string"==typeof this.body?this.body:this.body instanceof ze?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Fe(this.body)?null:Ge(this.body)?this.body.type||null:He(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ze?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(ot={}){const ft=ot.method||this.method,pn=ot.url||this.url,_e=ot.responseType||this.responseType,Ye=void 0!==ot.body?ot.body:this.body,j=void 0!==ot.withCredentials?ot.withCredentials:this.withCredentials,ye=void 0!==ot.reportProgress?ot.reportProgress:this.reportProgress;let We=ot.headers||this.headers,Tt=ot.params||this.params;const on=ot.context??this.context;return void 0!==ot.setHeaders&&(We=Object.keys(ot.setHeaders).reduce((qn,ci)=>qn.set(ci,ot.setHeaders[ci]),We)),ot.setParams&&(Tt=Object.keys(ot.setParams).reduce((qn,ci)=>qn.set(ci,ot.setParams[ci]),Tt)),new Qe(ft,pn,Ye,{params:Tt,headers:We,context:on,reportProgress:ye,responseType:_e,withCredentials:j})}}var et=(()=>((et=et||{})[et.Sent=0]="Sent",et[et.UploadProgress=1]="UploadProgress",et[et.ResponseHeader=2]="ResponseHeader",et[et.DownloadProgress=3]="DownloadProgress",et[et.Response=4]="Response",et[et.User=5]="User",et))();class ct{constructor(ot,ft=200,pn="OK"){this.headers=ot.headers||new K,this.status=void 0!==ot.status?ot.status:ft,this.statusText=ot.statusText||pn,this.url=ot.url||null,this.ok=this.status>=200&&this.status<300}}class gt extends ct{constructor(ot={}){super(ot),this.type=et.ResponseHeader}clone(ot={}){return new gt({headers:ot.headers||this.headers,status:void 0!==ot.status?ot.status:this.status,statusText:ot.statusText||this.statusText,url:ot.url||this.url||void 0})}}class bt extends ct{constructor(ot={}){super(ot),this.type=et.Response,this.body=void 0!==ot.body?ot.body:null}clone(ot={}){return new bt({body:void 0!==ot.body?ot.body:this.body,headers:ot.headers||this.headers,status:void 0!==ot.status?ot.status:this.status,statusText:ot.statusText||this.statusText,url:ot.url||this.url||void 0})}}class ut extends ct{constructor(ot){super(ot,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${ot.url||"(unknown url)"}`:`Http failure response for ${ot.url||"(unknown url)"}: ${ot.status} ${ot.statusText}`,this.error=ot.error||null}}function St(rn,ot){return{body:ot,headers:rn.headers,context:rn.context,observe:rn.observe,params:rn.params,reportProgress:rn.reportProgress,responseType:rn.responseType,withCredentials:rn.withCredentials}}let Vt=(()=>{class rn{constructor(ft){this.handler=ft}request(ft,pn,_e={}){let Ye;if(ft instanceof Qe)Ye=ft;else{let We,Tt;We=_e.headers instanceof K?_e.headers:new K(_e.headers),_e.params&&(Tt=_e.params instanceof ze?_e.params:new ze({fromObject:_e.params})),Ye=new Qe(ft,pn,void 0!==_e.body?_e.body:null,{headers:We,context:_e.context,params:Tt,reportProgress:_e.reportProgress,responseType:_e.responseType||"json",withCredentials:_e.withCredentials})}const j=(0,Y.of)(Ye).pipe((0,P.b)(We=>this.handler.handle(We)));if(ft instanceof Qe||"events"===_e.observe)return j;const ye=j.pipe((0,O.h)(We=>We instanceof bt));switch(_e.observe||"body"){case"body":switch(Ye.responseType){case"arraybuffer":return ye.pipe((0,f.U)(We=>{if(null!==We.body&&!(We.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return We.body}));case"blob":return ye.pipe((0,f.U)(We=>{if(null!==We.body&&!(We.body instanceof Blob))throw new Error("Response is not a Blob.");return We.body}));case"text":return ye.pipe((0,f.U)(We=>{if(null!==We.body&&"string"!=typeof We.body)throw new Error("Response is not a string.");return We.body}));default:return ye.pipe((0,f.U)(We=>We.body))}case"response":return ye;default:throw new Error(`Unreachable: unhandled observe type ${_e.observe}}`)}}delete(ft,pn={}){return this.request("DELETE",ft,pn)}get(ft,pn={}){return this.request("GET",ft,pn)}head(ft,pn={}){return this.request("HEAD",ft,pn)}jsonp(ft,pn){return this.request("JSONP",ft,{params:(new ze).append(pn,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(ft,pn={}){return this.request("OPTIONS",ft,pn)}patch(ft,pn,_e={}){return this.request("PATCH",ft,St(_e,pn))}post(ft,pn,_e={}){return this.request("POST",ft,St(_e,pn))}put(ft,pn,_e={}){return this.request("PUT",ft,St(_e,pn))}}return rn.\u0275fac=function(ft){return new(ft||rn)(d.LFG(H))},rn.\u0275prov=d.Yz7({token:rn,factory:rn.\u0275fac}),rn})();class bn{constructor(ot,ft){this.next=ot,this.interceptor=ft}handle(ot){return this.interceptor.intercept(ot,this.next)}}const Nt=new d.OlP("HTTP_INTERCEPTORS");let Bt=(()=>{class rn{intercept(ft,pn){return pn.handle(ft)}}return rn.\u0275fac=function(ft){return new(ft||rn)},rn.\u0275prov=d.Yz7({token:rn,factory:rn.\u0275fac}),rn})();const en=/^\)\]\}',?\n/;let Xt=(()=>{class rn{constructor(ft){this.xhrFactory=ft}handle(ft){if("JSONP"===ft.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new l.y(pn=>{const _e=this.xhrFactory.build();if(_e.open(ft.method,ft.urlWithParams),ft.withCredentials&&(_e.withCredentials=!0),ft.headers.forEach((ai,Un)=>_e.setRequestHeader(ai,Un.join(","))),ft.headers.has("Accept")||_e.setRequestHeader("Accept","application/json, text/plain, */*"),!ft.headers.has("Content-Type")){const ai=ft.detectContentTypeHeader();null!==ai&&_e.setRequestHeader("Content-Type",ai)}if(ft.responseType){const ai=ft.responseType.toLowerCase();_e.responseType="json"!==ai?ai:"text"}const Ye=ft.serializeBody();let j=null;const ye=()=>{if(null!==j)return j;const ai=1223===_e.status?204:_e.status,Un=_e.statusText||"OK",Fi=new K(_e.getAllResponseHeaders()),Ti=function(rn){return"responseURL"in rn&&rn.responseURL?rn.responseURL:/^X-Request-URL:/m.test(rn.getAllResponseHeaders())?rn.getResponseHeader("X-Request-URL"):null}(_e)||ft.url;return j=new gt({headers:Fi,status:ai,statusText:Un,url:Ti}),j},We=()=>{let{headers:ai,status:Un,statusText:Fi,url:Ti}=ye(),Yi=null;204!==Un&&(Yi=void 0===_e.response?_e.responseText:_e.response),0===Un&&(Un=Yi?200:0);let br=Un>=200&&Un<300;if("json"===ft.responseType&&"string"==typeof Yi){const Ei=Yi;Yi=Yi.replace(en,"");try{Yi=""!==Yi?JSON.parse(Yi):null}catch(wr){Yi=Ei,br&&(br=!1,Yi={error:wr,text:Yi})}}br?(pn.next(new bt({body:Yi,headers:ai,status:Un,statusText:Fi,url:Ti||void 0})),pn.complete()):pn.error(new ut({error:Yi,headers:ai,status:Un,statusText:Fi,url:Ti||void 0}))},Tt=ai=>{const{url:Un}=ye(),Fi=new ut({error:ai,status:_e.status||0,statusText:_e.statusText||"Unknown Error",url:Un||void 0});pn.error(Fi)};let on=!1;const qn=ai=>{on||(pn.next(ye()),on=!0);let Un={type:et.DownloadProgress,loaded:ai.loaded};ai.lengthComputable&&(Un.total=ai.total),"text"===ft.responseType&&!!_e.responseText&&(Un.partialText=_e.responseText),pn.next(Un)},ci=ai=>{let Un={type:et.UploadProgress,loaded:ai.loaded};ai.lengthComputable&&(Un.total=ai.total),pn.next(Un)};return _e.addEventListener("load",We),_e.addEventListener("error",Tt),_e.addEventListener("timeout",Tt),_e.addEventListener("abort",Tt),ft.reportProgress&&(_e.addEventListener("progress",qn),null!==Ye&&_e.upload&&_e.upload.addEventListener("progress",ci)),_e.send(Ye),pn.next({type:et.Sent}),()=>{_e.removeEventListener("error",Tt),_e.removeEventListener("abort",Tt),_e.removeEventListener("load",We),_e.removeEventListener("timeout",Tt),ft.reportProgress&&(_e.removeEventListener("progress",qn),null!==Ye&&_e.upload&&_e.upload.removeEventListener("progress",ci)),_e.readyState!==_e.DONE&&_e.abort()}})}}return rn.\u0275fac=function(ft){return new(ft||rn)(d.LFG(x.JF))},rn.\u0275prov=d.Yz7({token:rn,factory:rn.\u0275fac}),rn})();const cn=new d.OlP("XSRF_COOKIE_NAME"),kn=new d.OlP("XSRF_HEADER_NAME");class An{}let mi=(()=>{class rn{constructor(ft,pn,_e){this.doc=ft,this.platform=pn,this.cookieName=_e,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const ft=this.doc.cookie||"";return ft!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,x.Mx)(ft,this.cookieName),this.lastCookieString=ft),this.lastToken}}return rn.\u0275fac=function(ft){return new(ft||rn)(d.LFG(x.K0),d.LFG(d.Lbi),d.LFG(cn))},rn.\u0275prov=d.Yz7({token:rn,factory:rn.\u0275fac}),rn})(),si=(()=>{class rn{constructor(ft,pn){this.tokenService=ft,this.headerName=pn}intercept(ft,pn){const _e=ft.url.toLowerCase();if("GET"===ft.method||"HEAD"===ft.method||_e.startsWith("http://")||_e.startsWith("https://"))return pn.handle(ft);const Ye=this.tokenService.getToken();return null!==Ye&&!ft.headers.has(this.headerName)&&(ft=ft.clone({headers:ft.headers.set(this.headerName,Ye)})),pn.handle(ft)}}return rn.\u0275fac=function(ft){return new(ft||rn)(d.LFG(An),d.LFG(kn))},rn.\u0275prov=d.Yz7({token:rn,factory:rn.\u0275fac}),rn})(),Ki=(()=>{class rn{constructor(ft,pn){this.backend=ft,this.injector=pn,this.chain=null}handle(ft){if(null===this.chain){const pn=this.injector.get(Nt,[]);this.chain=pn.reduceRight((_e,Ye)=>new bn(_e,Ye),this.backend)}return this.chain.handle(ft)}}return rn.\u0275fac=function(ft){return new(ft||rn)(d.LFG(te),d.LFG(d.zs3))},rn.\u0275prov=d.Yz7({token:rn,factory:rn.\u0275fac}),rn})(),Vi=(()=>{class rn{static disable(){return{ngModule:rn,providers:[{provide:si,useClass:Bt}]}}static withOptions(ft={}){return{ngModule:rn,providers:[ft.cookieName?{provide:cn,useValue:ft.cookieName}:[],ft.headerName?{provide:kn,useValue:ft.headerName}:[]]}}}return rn.\u0275fac=function(ft){return new(ft||rn)},rn.\u0275mod=d.oAB({type:rn}),rn.\u0275inj=d.cJS({providers:[si,{provide:Nt,useExisting:si,multi:!0},{provide:An,useClass:mi},{provide:cn,useValue:"XSRF-TOKEN"},{provide:kn,useValue:"X-XSRF-TOKEN"}]}),rn})(),_i=(()=>{class rn{}return rn.\u0275fac=function(ft){return new(ft||rn)},rn.\u0275mod=d.oAB({type:rn}),rn.\u0275inj=d.cJS({providers:[Vt,{provide:H,useClass:Ki},Xt,{provide:te,useExisting:Xt}],imports:[[Vi.withOptions({cookieName:"XSRF-TOKEN",headerName:"X-XSRF-TOKEN"})]]}),rn})()},865:(yn,je,N)=>{"use strict";N.d(je,{deG:()=>ts,tb:()=>ux,AFp:()=>ax,ip1:()=>v_,CZH:()=>Xd,hGG:()=>fE,z2F:()=>fp,ahi:()=>Ma,sBO:()=>BT,Sil:()=>w_,_Vd:()=>Gd,aQ5:()=>g,EJc:()=>hx,SBq:()=>pc,qLn:()=>tu,vpe:()=>fc,L6J:()=>JC,tBr:()=>hs,XFs:()=>_e,OlP:()=>fr,zs3:()=>z,ZZ4:()=>mg,aQg:()=>_g,soG:()=>hg,YKP:()=>x0,h0i:()=>Hu,PXZ:()=>ST,R0b:()=>Ja,FiY:()=>Ks,r_U:()=>YC,Lbi:()=>cx,g9A:()=>lx,Qsj:()=>Uw,FYo:()=>og,JOm:()=>sl,Tiy:()=>i_,q3G:()=>Co,tp0:()=>ha,Rgc:()=>hp,dDg:()=>_x,GfV:()=>m0,i9L:()=>u,s_b:()=>cg,ifc:()=>Un,eFA:()=>Cx,G48:()=>CT,Gpc:()=>Ae,_c5:()=>aE,VLi:()=>wT,c2e:()=>dx,zSh:()=>Bc,wAp:()=>zi,vHH:()=>Fe,EiD:()=>dh,mCW:()=>Za,qzn:()=>Qc,JVY:()=>Og,pB0:()=>Va,eBb:()=>Lp,L6k:()=>Lg,LAX:()=>td,cg1:()=>Ym,Tjo:()=>WT,kL8:()=>Nv,yhl:()=>Op,dqk:()=>Ei,sIi:()=>Ro,CqO:()=>Nm,QGY:()=>Fm,F4k:()=>Hy,RDi:()=>I,AaK:()=>we,z3N:()=>zs,qOj:()=>jr,TTD:()=>ri,_Bn:()=>d0,xp6:()=>xf,uIk:()=>As,ekj:()=>$m,Suo:()=>z0,Xpm:()=>Ct,lG2:()=>Yt,Yz7:()=>si,cJS:()=>xi,oAB:()=>un,Yjl:()=>ii,Y36:()=>ip,_UZ:()=>jy,BQk:()=>km,ynx:()=>Lm,qZA:()=>Om,TgZ:()=>Rm,EpF:()=>qy,n5z:()=>L,LFG:()=>Zi,$8M:()=>de,$Z:()=>$y,NdJ:()=>Bm,CRH:()=>U0,oxw:()=>Jy,ALo:()=>M0,lcZ:()=>S0,xi3:()=>P0,Hsn:()=>Xy,F$t:()=>Ky,Q6J:()=>Sm,s9C:()=>Um,DdM:()=>C0,iGM:()=>N0,MAs:()=>Py,CHM:()=>Hs,LSH:()=>ec,kYT:()=>On,Udp:()=>Zm,YNc:()=>Sy,_uU:()=>xv,Oqu:()=>qm,hij:()=>Xf,AsE:()=>Hm,lnq:()=>Gm,HOy:()=>Wm,Gf:()=>B0});var x=N(5548),d=N(8151),Y=N(2225),l=N(5433),O=N(3405),f=N(1346),H=N(5783);var G=N(5234);function ne(){return new O.xQ}function me(t){for(let n in t)if(t[n]===me)return n;throw Error("Could not find renamed property on target object.")}function ve(t,n){for(const r in n)n.hasOwnProperty(r)&&!t.hasOwnProperty(r)&&(t[r]=n[r])}function we(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(we).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const n=t.toString();if(null==n)return""+n;const r=n.indexOf("\n");return-1===r?n:n.substring(0,r)}function ze(t,n){return null==t||""===t?null===n?"":n:null==n||""===n?t:t+" "+n}const Ne=me({__forward_ref__:me});function Ae(t){return t.__forward_ref__=Ae,t.toString=function(){return we(this())},t}function Te(t){return He(t)?t():t}function He(t){return"function"==typeof t&&t.hasOwnProperty(Ne)&&t.__forward_ref__===Ae}class Fe extends Error{constructor(n,r){super(function(t,n){return`${t?`NG0${t}: `:""}${n}`}(n,r)),this.code=n}}function et(t){return"string"==typeof t?t:null==t?"":String(t)}function ct(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():et(t)}function St(t,n){const r=n?` in ${n}`:"";throw new Fe("201",`No provider for ${ct(t)} found${r}`)}function Xt(t,n){null==t&&function(t,n,r,a){throw new Error(`ASSERTION ERROR: ${t}`+(null==a?"":` [Expected=> ${r} ${a} ${n} <=Actual]`))}(n,t,null,"!=")}function si(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function xi(t){return{providers:t.providers||[],imports:t.imports||[]}}function Wi(t){return Vi(t,rn)||Vi(t,ft)}function Vi(t,n){return t.hasOwnProperty(n)?t[n]:null}function xn(t){return t&&(t.hasOwnProperty(ot)||t.hasOwnProperty(pn))?t[ot]:null}const rn=me({\u0275prov:me}),ot=me({\u0275inj:me}),ft=me({ngInjectableDef:me}),pn=me({ngInjectorDef:me});var _e=(()=>((_e=_e||{})[_e.Default=0]="Default",_e[_e.Host=1]="Host",_e[_e.Self=2]="Self",_e[_e.SkipSelf=4]="SkipSelf",_e[_e.Optional=8]="Optional",_e))();let Ye;function ye(t){const n=Ye;return Ye=t,n}function We(t,n,r){const a=Wi(t);return a&&"root"==a.providedIn?void 0===a.value?a.value=a.factory():a.value:r&_e.Optional?null:void 0!==n?n:void St(we(t),"Injector")}function on(t){return{toString:t}.toString()}var qn=(()=>((qn=qn||{})[qn.OnPush=0]="OnPush",qn[qn.Default=1]="Default",qn))(),Un=(()=>{return(t=Un||(Un={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",Un;var t})();const Fi="undefined"!=typeof globalThis&&globalThis,Ti="undefined"!=typeof window&&window,Yi="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,Ei=Fi||"undefined"!=typeof global&&global||Ti||Yi,Ji={},hi=[],re=me({\u0275cmp:me}),ie=me({\u0275dir:me}),V=me({\u0275pipe:me}),pe=me({\u0275mod:me}),De=me({\u0275fac:me}),$e=me({__NG_ELEMENT_ID__:me});let vt=0;function Ct(t){return on(()=>{const r={},a={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:r,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===qn.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||hi,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||Un.Emulated,id:"c",styles:t.styles||hi,_:null,setInput:null,schemas:t.schemas||null,tView:null},h=t.directives,y=t.features,C=t.pipes;return a.id+=vt++,a.inputs=at(t.inputs,r),a.outputs=at(t.outputs),y&&y.forEach(D=>D(a)),a.directiveDefs=h?()=>("function"==typeof h?h():h).map(Dt):null,a.pipeDefs=C?()=>("function"==typeof C?C():C).map(Ht):null,a})}function Dt(t){return Qn(t)||function(t){return t[ie]||null}(t)}function Ht(t){return function(t){return t[V]||null}(t)}const Zt={};function un(t){return on(()=>{const n={type:t.type,bootstrap:t.bootstrap||hi,declarations:t.declarations||hi,imports:t.imports||hi,exports:t.exports||hi,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(Zt[t.id]=t.type),n})}function On(t,n){return on(()=>{const r=Yn(t,!0);r.declarations=n.declarations||hi,r.imports=n.imports||hi,r.exports=n.exports||hi})}function at(t,n){if(null==t)return Ji;const r={};for(const a in t)if(t.hasOwnProperty(a)){let h=t[a],y=h;Array.isArray(h)&&(y=h[1],h=h[0]),r[h]=a,n&&(n[h]=y)}return r}const Yt=Ct;function ii(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,onDestroy:t.type.prototype.ngOnDestroy||null}}function Qn(t){return t[re]||null}function Yn(t,n){const r=t[pe]||null;if(!r&&!0===n)throw new Error(`Type ${we(t)} does not have '\u0275mod' property.`);return r}function vi(t){return Array.isArray(t)&&"object"==typeof t[1]}function ji(t){return Array.isArray(t)&&!0===t[1]}function Sr(t){return 0!=(8&t.flags)}function yr(t){return 2==(2&t.flags)}function qr(t){return 1==(1&t.flags)}function ur(t){return null!==t.template}function vo(t){return 0!=(512&t[2])}function rt(t,n){return t.hasOwnProperty(De)?t[De]:null}class kt{constructor(n,r,a){this.previousValue=n,this.currentValue=r,this.firstChange=a}isFirstChange(){return this.firstChange}}function ri(){return fi}function fi(t){return t.type.prototype.ngOnChanges&&(t.setInput=Cr),dr}function dr(){const t=Io(this),n=t?.current;if(n){const r=t.previous;if(r===Ji)t.previous=n;else for(let a in n)r[a]=n[a];t.current=null,this.ngOnChanges(n)}}function Cr(t,n,r,a){const h=Io(t)||function(t,n){return t[Gi]=n}(t,{previous:Ji,current:null}),y=h.current||(h.current={}),C=h.previous,D=this.declaredInputs[r],U=C[D];y[D]=new kt(U&&U.currentValue,n,C===Ji),t[a]=n}ri.ngInherit=!0;const Gi="__ngSimpleChanges__";function Io(t){return t[Gi]||null}let B;function I(t){B=t}function Xe(t){return!!t.listen}const Jt={createRenderer:(t,n)=>void 0!==B?B:"undefined"!=typeof document?document:void 0};function wi(t){for(;Array.isArray(t);)t=t[0];return t}function nr(t,n){return wi(n[t])}function Ri(t,n){return wi(n[t.index])}function Wr(t,n){return t.data[n]}function go(t,n){return t[n]}function Lr(t,n){const r=n[t];return vi(r)?r:r[0]}function Ls(t){return 4==(4&t[2])}function qo(t){return 128==(128&t[2])}function Pr(t,n){return null==n?null:t[n]}function ks(t){t[18]=0}function ws(t,n){t[5]+=n;let r=t,a=t[3];for(;null!==a&&(1===n&&1===r[5]||-1===n&&0===r[5]);)a[5]+=n,r=a,a=a[3]}const Di={lFrame:Bi(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Ka(){return Di.bindingsEnabled}function Mn(){return Di.lFrame.lView}function Ui(){return Di.lFrame.tView}function Hs(t){return Di.lFrame.contextLView=t,t[8]}function vr(){let t=Jo();for(;null!==t&&64===t.type;)t=t.parent;return t}function Jo(){return Di.lFrame.currentTNode}function Vr(t,n){const r=Di.lFrame;r.currentTNode=t,r.isParent=n}function Ko(){return Di.lFrame.isParent}function bo(){Di.lFrame.isParent=!1}function No(){return Di.isInCheckNoChangesMode}function Ni(t){Di.isInCheckNoChangesMode=t}function Yr(){const t=Di.lFrame;let n=t.bindingRootIndex;return-1===n&&(n=t.bindingRootIndex=t.tView.bindingStartIndex),n}function Gs(){return Di.lFrame.bindingIndex}function ro(){return Di.lFrame.bindingIndex++}function Ts(t){const n=Di.lFrame,r=n.bindingIndex;return n.bindingIndex=n.bindingIndex+t,r}function jc(t,n){const r=Di.lFrame;r.bindingIndex=r.bindingRootIndex=t,A(n)}function A(t){Di.lFrame.currentDirectiveIndex=t}function R(){return Di.lFrame.currentQueryIndex}function ue(t){Di.lFrame.currentQueryIndex=t}function Se(t){const n=t[1];return 2===n.type?n.declTNode:1===n.type?t[6]:null}function Lt(t,n,r){if(r&_e.SkipSelf){let h=n,y=t;for(;!(h=h.parent,null!==h||r&_e.Host||(h=Se(y),null===h||(y=y[15],10&h.type))););if(null===h)return!1;n=h,t=y}const a=Di.lFrame=Bn();return a.currentTNode=n,a.lView=t,!0}function Sn(t){const n=Bn(),r=t[1];Di.lFrame=n,n.currentTNode=r.firstChild,n.lView=t,n.tView=r,n.contextLView=t,n.bindingIndex=r.bindingStartIndex,n.inI18n=!1}function Bn(){const t=Di.lFrame,n=null===t?null:t.child;return null===n?Bi(t):n}function Bi(t){const n={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=n),n}function ni(){const t=Di.lFrame;return Di.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const or=ni;function hr(){const t=ni();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Zr(){return Di.lFrame.selectedIndex}function Xr(t){Di.lFrame.selectedIndex=t}function Jr(){const t=Di.lFrame;return Wr(t.tView,t.selectedIndex)}function Qa(t,n){for(let r=n.directiveStart,a=n.directiveEnd;r<a;r++){const y=t.data[r].type.prototype,{ngAfterContentInit:C,ngAfterContentChecked:D,ngAfterViewInit:U,ngAfterViewChecked:Q,ngOnDestroy:ge}=y;C&&(t.contentHooks||(t.contentHooks=[])).push(-r,C),D&&((t.contentHooks||(t.contentHooks=[])).push(r,D),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(r,D)),U&&(t.viewHooks||(t.viewHooks=[])).push(-r,U),Q&&((t.viewHooks||(t.viewHooks=[])).push(r,Q),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(r,Q)),null!=ge&&(t.destroyHooks||(t.destroyHooks=[])).push(r,ge)}}function ba(t,n,r){La(t,n,3,r)}function wa(t,n,r,a){(3&t[2])===r&&La(t,n,r,a)}function wo(t,n){let r=t[2];(3&r)===n&&(r&=2047,r+=1,t[2]=r)}function La(t,n,r,a){const y=a??-1,C=n.length-1;let D=0;for(let U=void 0!==a?65535&t[18]:0;U<C;U++)if("number"==typeof n[U+1]){if(D=n[U],null!=a&&D>=a)break}else n[U]<0&&(t[18]+=65536),(D<y||-1==y)&&(Hc(t,r,n,U),t[18]=(4294901760&t[18])+U+2),U++}function Hc(t,n,r,a){const h=r[a]<0,y=r[a+1],D=t[h?-r[a]:r[a]];if(h){if(t[2]>>11<t[18]>>16&&(3&t[2])===n){t[2]+=2048;try{y.call(D)}finally{}}}else try{y.call(D)}finally{}}class Ca{constructor(n,r,a){this.factory=n,this.resolving=!1,this.canSeeViewProviders=r,this.injectImpl=a}}function mo(t,n,r){const a=Xe(t);let h=0;for(;h<r.length;){const y=r[h];if("number"==typeof y){if(0!==y)break;h++;const C=r[h++],D=r[h++],U=r[h++];a?t.setAttribute(n,D,U,C):n.setAttributeNS(C,D,U)}else{const C=y,D=r[++h];Fs(C)?a&&t.setProperty(n,C,D):a?t.setAttribute(n,C,D):n.setAttribute(C,D),h++}}return h}function Ws(t){return 3===t||4===t||6===t}function Fs(t){return 64===t.charCodeAt(0)}function ca(t,n){if(null!==n&&0!==n.length)if(null===t||0===t.length)t=n.slice();else{let r=-1;for(let a=0;a<n.length;a++){const h=n[a];"number"==typeof h?r=h:0===r||ka(t,r,h,null,-1===r||2===r?n[++a]:null)}}return t}function ka(t,n,r,a,h){let y=0,C=t.length;if(-1===n)C=-1;else for(;y<t.length;){const D=t[y++];if("number"==typeof D){if(D===n){C=-1;break}if(D>n){C=y-1;break}}}for(;y<t.length;){const D=t[y];if("number"==typeof D)break;if(D===r){if(null===a)return void(null!==h&&(t[y+1]=h));if(a===t[y+1])return void(t[y+2]=h)}y++,null!==a&&y++,null!==h&&y++}-1!==C&&(t.splice(C,0,n),y=C+1),t.splice(y++,0,r),null!==a&&t.splice(y++,0,a),null!==h&&t.splice(y++,0,h)}function Ea(t){return-1!==t}function nl(t){return 32767&t}function Ns(t,n){let r=function(t){return t>>16}(t),a=n;for(;r>0;)a=a[15],r--;return a}let Qo=!0;function il(t){const n=Qo;return Qo=t,n}let ua=0;function da(t,n){const r=Hl(t,n);if(-1!==r)return r;const a=n[1];a.firstCreatePass&&(t.injectorIndex=n.length,Fa(a.data,t),Fa(n,null),Fa(a.blueprint,null));const h=yl(t,n),y=t.injectorIndex;if(Ea(h)){const C=nl(h),D=Ns(h,n),U=D[1].data;for(let Q=0;Q<8;Q++)n[y+Q]=D[C+Q]|U[C+Q]}return n[y+8]=h,y}function Fa(t,n){t.push(0,0,0,0,0,0,0,0,n)}function Hl(t,n){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===n[t.injectorIndex+8]?-1:t.injectorIndex}function yl(t,n){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let r=0,a=null,h=n;for(;null!==h;){const y=h[1],C=y.type;if(a=2===C?y.declTNode:1===C?h[6]:null,null===a)return-1;if(r++,h=h[15],-1!==a.injectorIndex)return a.injectorIndex|r<<16}return-1}function vl(t,n,r){!function(t,n,r){let a;"string"==typeof r?a=r.charCodeAt(0)||0:r.hasOwnProperty($e)&&(a=r[$e]),null==a&&(a=r[$e]=ua++);const h=255&a;n.data[t+(h>>5)]|=1<<h}(t,n,r)}function Na(t,n,r){if(r&_e.Optional)return t;St(n,"NodeInjector")}function vc(t,n,r,a){if(r&_e.Optional&&void 0===a&&(a=null),0==(r&(_e.Self|_e.Host))){const h=t[9],y=ye(void 0);try{return h?h.get(n,a,r&_e.Optional):We(n,a,r&_e.Optional)}finally{ye(y)}}return Na(a,n,r)}function xc(t,n,r,a=_e.Default,h){if(null!==t){const y=function(t){if("string"==typeof t)return t.charCodeAt(0)||0;const n=t.hasOwnProperty($e)?t[$e]:void 0;return"number"==typeof n?n>=0?255&n:xl:n}(r);if("function"==typeof y){if(!Lt(n,t,a))return a&_e.Host?Na(h,r,a):vc(n,r,a,h);try{const C=y(a);if(null!=C||a&_e.Optional)return C;St(r)}finally{or()}}else if("number"==typeof y){let C=null,D=Hl(t,n),U=-1,Q=a&_e.Host?n[16][6]:null;for((-1===D||a&_e.SkipSelf)&&(U=-1===D?yl(t,n):n[D+8],-1!==U&&q(a,!1)?(C=n[1],D=nl(U),n=Ns(U,n)):D=-1);-1!==D;){const ge=n[1];if(wc(y,D,ge.data)){const Oe=Gl(D,n,r,C,a,Q);if(Oe!==Da)return Oe}U=n[D+8],-1!==U&&q(a,n[1].data[D+8]===Q)&&wc(y,D,n)?(C=ge,D=nl(U),n=Ns(U,n)):D=-1}}}return vc(n,r,a,h)}const Da={};function xl(){return new F(vr(),Mn())}function Gl(t,n,r,a,h,y){const C=n[1],D=C.data[t+8],ge=rl(D,C,r,null==a?yr(D)&&Qo:a!=C&&0!=(3&D.type),h&_e.Host&&y===D);return null!==ge?Aa(n,C,ge,D):Da}function rl(t,n,r,a,h){const y=t.providerIndexes,C=n.data,D=1048575&y,U=t.directiveStart,ge=y>>20,Ue=h?D+ge:t.directiveEnd;for(let pt=a?D:D+ge;pt<Ue;pt++){const At=C[pt];if(pt<U&&r===At||pt>=U&&At.type===r)return pt}if(h){const pt=C[U];if(pt&&ur(pt)&&pt.type===r)return U}return null}function Aa(t,n,r,a){let h=t[r];const y=n.data;if(function(t){return t instanceof Ca}(h)){const C=h;C.resolving&&function(t,n){throw new Fe("200",`Circular dependency in DI detected for ${t}`)}(ct(y[r]));const D=il(C.canSeeViewProviders);C.resolving=!0;const U=C.injectImpl?ye(C.injectImpl):null;Lt(t,a,_e.Default);try{h=t[r]=C.factory(void 0,y,t,a),n.firstCreatePass&&r>=a.directiveStart&&function(t,n,r){const{ngOnChanges:a,ngOnInit:h,ngDoCheck:y}=n.type.prototype;if(a){const C=fi(n);(r.preOrderHooks||(r.preOrderHooks=[])).push(t,C),(r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(t,C)}h&&(r.preOrderHooks||(r.preOrderHooks=[])).push(0-t,h),y&&((r.preOrderHooks||(r.preOrderHooks=[])).push(t,y),(r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(t,y))}(r,y[r],n)}finally{null!==U&&ye(U),il(D),C.resolving=!1,or()}}return h}function wc(t,n,r){return!!(r[n+(t>>5)]&1<<t)}function q(t,n){return!(t&_e.Self||t&_e.Host&&n)}class F{constructor(n,r){this._tNode=n,this._lView=r}get(n,r,a){return xc(this._tNode,this._lView,n,a,r)}}function L(t){return on(()=>{const n=t.prototype.constructor,r=n[De]||X(n),a=Object.prototype;let h=Object.getPrototypeOf(t.prototype).constructor;for(;h&&h!==a;){const y=h[De]||X(h);if(y&&y!==r)return y;h=Object.getPrototypeOf(h)}return y=>new y})}function X(t){return He(t)?()=>{const n=X(Te(t));return n&&n()}:rt(t)}function de(t){return function(t,n){if("class"===n)return t.classes;if("style"===n)return t.styles;const r=t.attrs;if(r){const a=r.length;let h=0;for(;h<a;){const y=r[h];if(Ws(y))break;if(0===y)h+=2;else if("number"==typeof y)for(h++;h<a&&"string"==typeof r[h];)h++;else{if(y===n)return r[h+1];h+=2}}}return null}(vr(),t)}const it="__parameters__",xt="__prop__metadata__";function di(t){return function(...r){if(t){const a=t(...r);for(const h in a)this[h]=a[h]}}}function sr(t,n,r){return on(()=>{const a=di(n);function h(...y){if(this instanceof h)return a.apply(this,y),this;const C=new h(...y);return D.annotation=C,D;function D(U,Q,ge){const Oe=U.hasOwnProperty(it)?U[it]:Object.defineProperty(U,it,{value:[]})[it];for(;Oe.length<=ge;)Oe.push(null);return(Oe[ge]=Oe[ge]||[]).push(C),U}}return r&&(h.prototype=Object.create(r.prototype)),h.prototype.ngMetadataName=t,h.annotationCls=h,h})}function Mi(t,n,r,a){return on(()=>{const h=di(n);function y(...C){if(this instanceof y)return h.apply(this,C),this;const D=new y(...C);return function(Q,ge){const Oe=Q.constructor,Ue=Oe.hasOwnProperty(xt)?Oe[xt]:Object.defineProperty(Oe,xt,{value:{}})[xt];Ue[ge]=Ue.hasOwnProperty(ge)&&Ue[ge]||[],Ue[ge].unshift(D),a&&a(Q,ge,...C)}}return r&&(y.prototype=Object.create(r.prototype)),y.prototype.ngMetadataName=t,y.annotationCls=y,y})}function cr(){return sr("Attribute",t=>({attributeName:t,__NG_ELEMENT_ID__:()=>de(t)}))}const Ma=cr();class fr{constructor(n,r){this._desc=n,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof r?this.__NG_ELEMENT_ID__=r:void 0!==r&&(this.\u0275prov=si({token:this,providedIn:r.providedIn||"root",factory:r.factory}))}toString(){return`InjectionToken ${this._desc}`}}const ts=new fr("AnalyzeForEntryComponents");class bl{}const g=Mi("ContentChild",(t,n={})=>({selector:t,first:!0,isViewQuery:!1,descendants:!0,...n}),bl),u=Mi("ViewChild",(t,n)=>({selector:t,first:!0,isViewQuery:!0,descendants:!0,...n}),bl);function he(t,n){void 0===n&&(n=t);for(let r=0;r<t.length;r++){let a=t[r];Array.isArray(a)?(n===t&&(n=t.slice(0,r)),he(a,n)):n!==t&&n.push(a)}return n}function be(t,n){t.forEach(r=>Array.isArray(r)?be(r,n):n(r))}function Ce(t,n,r){n>=t.length?t.push(r):t.splice(n,0,r)}function Me(t,n){return n>=t.length-1?t.pop():t.splice(n,1)[0]}function Ve(t,n){const r=[];for(let a=0;a<t;a++)r.push(n);return r}function wt(t,n,r){let a=Pt(t,n);return a>=0?t[1|a]=r:(a=~a,function(t,n,r,a){let h=t.length;if(h==n)t.push(r,a);else if(1===h)t.push(a,t[0]),t[0]=r;else{for(h--,t.push(t[h-1],t[h]);h>n;)t[h]=t[h-2],h--;t[n]=r,t[n+1]=a}}(t,a,n,r)),a}function nt(t,n){const r=Pt(t,n);if(r>=0)return t[1|r]}function Pt(t,n){return function(t,n,r){let a=0,h=t.length>>r;for(;h!==a;){const y=a+(h-a>>1),C=t[y<<r];if(n===C)return y<<r;C>n?h=y:a=y+1}return~(h<<r)}(t,n,1)}const Hr={},$r="__NG_DI_FLAG__",ki="ngTempTokenPath",Qr=/\n/gm,Js="__source",zo=me({provide:String,useValue:me});let Uo;function ds(t){const n=Uo;return Uo=t,n}function Ba(t,n=_e.Default){if(void 0===Uo)throw new Error("inject() must be called from an injection context");return null===Uo?We(t,void 0,n):Uo.get(t,n&_e.Optional?null:void 0,n)}function Zi(t,n=_e.Default){return(Ye||Ba)(Te(t),n)}function Br(t){const n=[];for(let r=0;r<t.length;r++){const a=Te(t[r]);if(Array.isArray(a)){if(0===a.length)throw new Error("Arguments array must have arguments.");let h,y=_e.Default;for(let C=0;C<a.length;C++){const D=a[C],U=Gr(D);"number"==typeof U?-1===U?h=D.token:y|=U:h=D}n.push(Zi(h,y))}else n.push(Zi(a))}return n}function Vo(t,n){return t[$r]=n,t.prototype[$r]=n,t}function Gr(t){return t[$r]}function Zo(t,n,r,a){const h=t[ki];throw n[Js]&&h.unshift(n[Js]),t.message=function(t,n,r,a=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let h=we(n);if(Array.isArray(n))h=n.map(we).join(" -> ");else if("object"==typeof n){let y=[];for(let C in n)if(n.hasOwnProperty(C)){let D=n[C];y.push(C+":"+("string"==typeof D?JSON.stringify(D):we(D)))}h=`{${y.join(", ")}}`}return`${r}${a?"("+a+")":""}[${h}]: ${t.replace(Qr,"\n  ")}`}("\n"+t.message,h,r,a),t.ngTokenPath=h,t[ki]=null,t}const hs=Vo(sr("Inject",t=>({token:t})),-1),Ks=Vo(sr("Optional"),8),ha=Vo(sr("SkipSelf"),4);let Ec;function Jl(t){return function(){if(void 0===Ec&&(Ec=null,Ei.trustedTypes))try{Ec=Ei.trustedTypes.createPolicy("angular",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return Ec}()?.createHTML(t)||t}class za{constructor(n){this.changingThisBreaksApplicationSecurity=n}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see https://g.co/ng/security#xss)`}}class Xc extends za{getTypeName(){return"HTML"}}class El extends za{getTypeName(){return"Style"}}class Ua extends za{getTypeName(){return"Script"}}class Xl extends za{getTypeName(){return"URL"}}class Il extends za{getTypeName(){return"ResourceURL"}}function zs(t){return t instanceof za?t.changingThisBreaksApplicationSecurity:t}function Qc(t,n){const r=Op(t);if(null!=r&&r!==n){if("ResourceURL"===r&&"URL"===n)return!0;throw new Error(`Required a safe ${n}, got a ${r} (see https://g.co/ng/security#xss)`)}return r===n}function Op(t){return t instanceof za&&t.getTypeName()||null}function Og(t){return new Xc(t)}function Lg(t){return new El(t)}function Lp(t){return new Ua(t)}function td(t){return new Xl(t)}function Va(t){return new Il(t)}class kg{constructor(n){this.inertDocumentHelper=n}getInertBodyElement(n){n="<body><remove></remove>"+n;try{const r=(new window.DOMParser).parseFromString(Jl(n),"text/html").body;return null===r?this.inertDocumentHelper.getInertBodyElement(n):(r.removeChild(r.firstChild),r)}catch{return null}}}class ps{constructor(n){if(this.defaultDoc=n,this.inertDocument=this.defaultDoc.implementation.createHTMLDocument("sanitization-inert"),null==this.inertDocument.body){const r=this.inertDocument.createElement("html");this.inertDocument.appendChild(r);const a=this.inertDocument.createElement("body");r.appendChild(a)}}getInertBodyElement(n){const r=this.inertDocument.createElement("template");if("content"in r)return r.innerHTML=Jl(n),r;const a=this.inertDocument.createElement("body");return a.innerHTML=Jl(n),this.defaultDoc.documentMode&&this.stripCustomNsAttrs(a),a}stripCustomNsAttrs(n){const r=n.attributes;for(let h=r.length-1;0<h;h--){const C=r.item(h).name;("xmlns:ns1"===C||0===C.indexOf("ns1:"))&&n.removeAttribute(C)}let a=n.firstChild;for(;a;)a.nodeType===Node.ELEMENT_NODE&&this.stripCustomNsAttrs(a),a=a.nextSibling}}const ch=/^(?:(?:https?|mailto|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi,Ic=/^data:(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm)|audio\/(?:mp3|oga|ogg|opus));base64,[a-z0-9+\/]+=*$/i;function Za(t){return(t=String(t)).match(ch)||t.match(Ic)?t:"unsafe:"+t}function Sa(t){const n={};for(const r of t.split(","))n[r]=!0;return n}function eu(...t){const n={};for(const r of t)for(const a in r)r.hasOwnProperty(a)&&(n[a]=!0);return n}const Fp=Sa("area,br,col,hr,img,wbr"),uh=Sa("colgroup,dd,dt,li,p,tbody,td,tfoot,th,thead,tr"),Np=Sa("rp,rt"),nd=eu(Fp,eu(uh,Sa("address,article,aside,blockquote,caption,center,del,details,dialog,dir,div,dl,figure,figcaption,footer,h1,h2,h3,h4,h5,h6,header,hgroup,hr,ins,main,map,menu,nav,ol,pre,section,summary,table,ul")),eu(Np,Sa("a,abbr,acronym,audio,b,bdi,bdo,big,br,cite,code,del,dfn,em,font,i,img,ins,kbd,label,map,mark,picture,q,ruby,rp,rt,s,samp,small,source,span,strike,strong,sub,sup,time,track,tt,u,var,video")),eu(Np,uh)),id=Sa("background,cite,href,itemtype,longdesc,poster,src,xlink:href"),Ql=Sa("srcset"),Dc=eu(id,Ql,Sa("abbr,accesskey,align,alt,autoplay,axis,bgcolor,border,cellpadding,cellspacing,class,clear,color,cols,colspan,compact,controls,coords,datetime,default,dir,download,face,headers,height,hidden,hreflang,hspace,ismap,itemscope,itemprop,kind,label,lang,language,loop,media,muted,nohref,nowrap,open,preload,rel,rev,role,rows,rowspan,rules,scope,scrolling,shape,size,sizes,span,srclang,start,summary,tabindex,target,title,translate,type,usemap,valign,value,vspace,width"),Sa("aria-activedescendant,aria-atomic,aria-autocomplete,aria-busy,aria-checked,aria-colcount,aria-colindex,aria-colspan,aria-controls,aria-current,aria-describedby,aria-details,aria-disabled,aria-dropeffect,aria-errormessage,aria-expanded,aria-flowto,aria-grabbed,aria-haspopup,aria-hidden,aria-invalid,aria-keyshortcuts,aria-label,aria-labelledby,aria-level,aria-live,aria-modal,aria-multiline,aria-multiselectable,aria-orientation,aria-owns,aria-placeholder,aria-posinset,aria-pressed,aria-readonly,aria-relevant,aria-required,aria-roledescription,aria-rowcount,aria-rowindex,aria-rowspan,aria-selected,aria-setsize,aria-sort,aria-valuemax,aria-valuemin,aria-valuenow,aria-valuetext")),rd=Sa("script,style,template");class Up{constructor(){this.sanitizedSomething=!1,this.buf=[]}sanitizeChildren(n){let r=n.firstChild,a=!0;for(;r;)if(r.nodeType===Node.ELEMENT_NODE?a=this.startElement(r):r.nodeType===Node.TEXT_NODE?this.chars(r.nodeValue):this.sanitizedSomething=!0,a&&r.firstChild)r=r.firstChild;else for(;r;){r.nodeType===Node.ELEMENT_NODE&&this.endElement(r);let h=this.checkClobberedElement(r,r.nextSibling);if(h){r=h;break}r=this.checkClobberedElement(r,r.parentNode)}return this.buf.join("")}startElement(n){const r=n.nodeName.toLowerCase();if(!nd.hasOwnProperty(r))return this.sanitizedSomething=!0,!rd.hasOwnProperty(r);this.buf.push("<"),this.buf.push(r);const a=n.attributes;for(let h=0;h<a.length;h++){const y=a.item(h),C=y.name,D=C.toLowerCase();if(!Dc.hasOwnProperty(D)){this.sanitizedSomething=!0;continue}let U=y.value;id[D]&&(U=Za(U)),Ql[D]&&(t=U,U=(t=String(t)).split(",").map(n=>Za(n.trim())).join(", ")),this.buf.push(" ",C,'="',Zp(U),'"')}var t;return this.buf.push(">"),!0}endElement(n){const r=n.nodeName.toLowerCase();nd.hasOwnProperty(r)&&!Fp.hasOwnProperty(r)&&(this.buf.push("</"),this.buf.push(r),this.buf.push(">"))}chars(n){this.buf.push(Zp(n))}checkClobberedElement(n,r){if(r&&(n.compareDocumentPosition(r)&Node.DOCUMENT_POSITION_CONTAINED_BY)===Node.DOCUMENT_POSITION_CONTAINED_BY)throw new Error(`Failed to sanitize html because the element is clobbered: ${n.outerHTML}`);return r}}const Vp=/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,Bg=/([^\#-~ |!])/g;function Zp(t){return t.replace(/&/g,"&amp;").replace(Vp,function(n){return"&#"+(1024*(n.charCodeAt(0)-55296)+(n.charCodeAt(1)-56320)+65536)+";"}).replace(Bg,function(n){return"&#"+n.charCodeAt(0)+";"}).replace(/</g,"&lt;").replace(/>/g,"&gt;")}let fs;function dh(t,n){let r=null;try{fs=fs||function(t){const n=new ps(t);return function(){try{return!!(new window.DOMParser).parseFromString(Jl(""),"text/html")}catch{return!1}}()?new kg(n):n}(t);let a=n?String(n):"";r=fs.getInertBodyElement(a);let h=5,y=a;do{if(0===h)throw new Error("Failed to sanitize html because the input is unstable");h--,a=y,y=r.innerHTML,r=fs.getInertBodyElement(a)}while(a!==y);return Jl((new Up).sanitizeChildren(yu(r)||r))}finally{if(r){const a=yu(r)||r;for(;a.firstChild;)a.removeChild(a.firstChild)}}}function yu(t){return"content"in t&&function(t){return t.nodeType===Node.ELEMENT_NODE&&"TEMPLATE"===t.nodeName}(t)?t.content:null}var Co=(()=>((Co=Co||{})[Co.NONE=0]="NONE",Co[Co.HTML=1]="HTML",Co[Co.STYLE=2]="STYLE",Co[Co.SCRIPT=3]="SCRIPT",Co[Co.URL=4]="URL",Co[Co.RESOURCE_URL=5]="RESOURCE_URL",Co))();function ec(t){const n=function(){const t=Mn();return t&&t[12]}();return n?n.sanitize(Co.URL,t)||"":Qc(t,"URL")?zs(t):Za(et(t))}const fh="__ngContext__";function gs(t,n){t[fh]=n}function sd(t){const n=function(t){return t[fh]||null}(t);return n?Array.isArray(n)?n:n.lView:null}function Tu(t){return t.ngOriginalError}function Eu(t,...n){t.error(...n)}class tu{constructor(){this._console=console}handleError(n){const r=this._findOriginalError(n),a=this._findContext(n),h=(t=n)&&t.ngErrorLogger||Eu;var t;h(this._console,"ERROR",n),r&&h(this._console,"ORIGINAL ERROR",r),a&&h(this._console,"ERROR CONTEXT",a)}_findContext(n){return n?n.ngDebugContext||this._findContext(Tu(n)):null}_findOriginalError(n){let r=n&&Tu(n);for(;r&&Tu(r);)r=Tu(r);return r||null}}const Iu=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(Ei))();function $a(t){return t instanceof Function?t():t}var sl=(()=>((sl=sl||{})[sl.Important=1]="Important",sl[sl.DashCase=2]="DashCase",sl))();function Ac(t,n){return undefined(t,n)}function Du(t){const n=t[3];return ji(n)?n[3]:n}function Au(t){return ef(t[13])}function wh(t){return ef(t[4])}function ef(t){for(;null!==t&&!ji(t);)t=t[4];return t}function iu(t,n,r,a,h){if(null!=a){let y,C=!1;ji(a)?y=a:vi(a)&&(C=!0,a=a[0]);const D=wi(a);0===t&&null!==r?null==h?Ah(n,r,D):nc(n,r,D,h||null,!0):1===t&&null!==r?nc(n,r,D,h||null,!0):2===t?function(t,n,r){const a=_d(t,n);a&&function(t,n,r,a){Xe(t)?t.removeChild(n,r,a):n.removeChild(r)}(t,a,n,r)}(n,D,C):3===t&&n.destroyNode(D),null!=y&&function(t,n,r,a,h){const y=r[7];y!==wi(r)&&iu(n,t,a,y,h);for(let D=10;D<r.length;D++){const U=r[D];Ru(U[1],U,t,n,a,y)}}(n,t,y,r,h)}}function Eh(t,n,r){return Xe(t)?t.createElement(n,r):null===r?t.createElement(n):t.createElementNS(r,n)}function rf(t,n){const r=t[9],a=r.indexOf(n),h=n[3];1024&n[2]&&(n[2]&=-1025,ws(h,-1)),r.splice(a,1)}function Ih(t,n){if(t.length<=10)return;const r=10+n,a=t[r];if(a){const h=a[17];null!==h&&h!==t&&rf(h,a),n>0&&(t[r-1][4]=a[4]);const y=Me(t,10+n);!function(t,n){Ru(t,n,n[11],2,null,null),n[0]=null,n[6]=null}(a[1],a);const C=y[19];null!==C&&C.detachView(y[1]),a[3]=null,a[4]=null,a[2]&=-129}return a}function ou(t,n){if(!(256&n[2])){const r=n[11];Xe(r)&&r.destroyNode&&Ru(t,n,r,3,null,null),function(t){let n=t[13];if(!n)return md(t[1],t);for(;n;){let r=null;if(vi(n))r=n[13];else{const a=n[10];a&&(r=a)}if(!r){for(;n&&!n[4]&&n!==t;)vi(n)&&md(n[1],n),n=n[3];null===n&&(n=t),vi(n)&&md(n[1],n),r=n&&n[4]}n=r}}(n)}}function md(t,n){if(!(256&n[2])){n[2]&=-129,n[2]|=256,function(t,n){let r;if(null!=t&&null!=(r=t.destroyHooks))for(let a=0;a<r.length;a+=2){const h=n[r[a]];if(!(h instanceof Ca)){const y=r[a+1];if(Array.isArray(y))for(let C=0;C<y.length;C+=2){const D=h[y[C]],U=y[C+1];try{U.call(D)}finally{}}else try{y.call(h)}finally{}}}}(t,n),function(t,n){const r=t.cleanup,a=n[7];let h=-1;if(null!==r)for(let y=0;y<r.length-1;y+=2)if("string"==typeof r[y]){const C=r[y+1],D="function"==typeof C?C(n):wi(n[C]),U=a[h=r[y+2]],Q=r[y+3];"boolean"==typeof Q?D.removeEventListener(r[y],U,Q):Q>=0?a[h=Q]():a[h=-Q].unsubscribe(),y+=2}else{const C=a[h=r[y+1]];r[y].call(C)}if(null!==a){for(let y=h+1;y<a.length;y++)a[y]();n[7]=null}}(t,n),1===n[1].type&&Xe(n[11])&&n[11].destroy();const r=n[17];if(null!==r&&ji(n[3])){r!==n[3]&&rf(r,n);const a=n[19];null!==a&&a.detachView(t)}}}function of(t,n,r){return function(t,n,r){let a=n;for(;null!==a&&40&a.type;)a=(n=a).parent;if(null===a)return r[0];if(2&a.flags){const h=t.data[a.directiveStart].encapsulation;if(h===Un.None||h===Un.Emulated)return null}return Ri(a,r)}(t,n.parent,r)}function nc(t,n,r,a,h){Xe(t)?t.insertBefore(n,r,a,h):n.insertBefore(r,a,h)}function Ah(t,n,r){Xe(t)?t.appendChild(n,r):n.appendChild(r)}function sf(t,n,r,a,h){null!==a?nc(t,n,r,a,h):Ah(t,n,r)}function _d(t,n){return Xe(t)?t.parentNode(n):n.parentNode}function af(t,n,r){return cf(t,n,r)}let cf=function(t,n,r){return 40&t.type?Ri(t,r):null};function Su(t,n,r,a){const h=of(t,a,n),y=n[11],D=af(a.parent||n[6],a,n);if(null!=h)if(Array.isArray(r))for(let U=0;U<r.length;U++)sf(y,h,r[U],D,!1);else sf(y,h,r,D,!1)}function Pu(t,n){if(null!==n){const r=n.type;if(3&r)return Ri(n,t);if(4&r)return Sh(-1,t[n.index]);if(8&r){const a=n.child;if(null!==a)return Pu(t,a);{const h=t[n.index];return ji(h)?Sh(-1,h):wi(h)}}if(32&r)return Ac(n,t)()||wi(t[n.index]);{const a=Mh(t,n);return null!==a?Array.isArray(a)?a[0]:Pu(Du(t[16]),a):Pu(t,n.next)}}return null}function Mh(t,n){return null!==n?t[16][6].projection[n.projection]:null}function Sh(t,n){const r=10+t+1;if(r<n.length){const a=n[r],h=a[1].firstChild;if(null!==h)return Pu(a,h)}return n[7]}function Ph(t,n,r,a,h,y,C){for(;null!=r;){const D=a[r.index],U=r.type;if(C&&0===n&&(D&&gs(wi(D),a),r.flags|=4),64!=(64&r.flags))if(8&U)Ph(t,n,r.child,a,h,y,!1),iu(n,t,h,D,y);else if(32&U){const Q=Ac(r,a);let ge;for(;ge=Q();)iu(n,t,h,ge,y);iu(n,t,h,D,y)}else 16&U?pf(t,n,a,r,h,y):iu(n,t,h,D,y);r=C?r.projectionNext:r.next}}function Ru(t,n,r,a,h,y){Ph(r,a,t.firstChild,n,h,y,!1)}function pf(t,n,r,a,h,y){const C=r[16],U=C[6].projection[a.projection];if(Array.isArray(U))for(let Q=0;Q<U.length;Q++)iu(n,t,h,U[Q],y);else Ph(t,n,U,C[3],h,y,!0)}function yd(t,n,r){Xe(t)?t.setAttribute(n,"style",r):n.style.cssText=r}function au(t,n,r){Xe(t)?""===r?t.removeAttribute(n,"class"):t.setAttribute(n,"class",r):n.className=r}function Sc(t,n,r){let a=t.length;for(;;){const h=t.indexOf(n,r);if(-1===h)return h;if(0===h||t.charCodeAt(h-1)<=32){const y=n.length;if(h+y===a||t.charCodeAt(h+y)<=32)return h}r=h+1}}const ff="ng-template";function Ou(t,n,r){let a=0;for(;a<t.length;){let h=t[a++];if(r&&"class"===h){if(h=t[a],-1!==Sc(h.toLowerCase(),n,0))return!0}else if(1===h){for(;a<t.length&&"string"==typeof(h=t[a++]);)if(h.toLowerCase()===n)return!0;return!1}}return!1}function gf(t){return 4===t.type&&t.value!==ff}function nm(t,n,r){return n===(4!==t.type||r?t.value:ff)}function mf(t,n,r){let a=4;const h=t.attrs||[],y=function(t){for(let n=0;n<t.length;n++)if(Ws(t[n]))return n;return t.length}(h);let C=!1;for(let D=0;D<n.length;D++){const U=n[D];if("number"!=typeof U){if(!C)if(4&a){if(a=2|1&a,""!==U&&!nm(t,U,r)||""===U&&1===n.length){if(Pa(a))return!1;C=!0}}else{const Q=8&a?U:n[++D];if(8&a&&null!==t.attrs){if(!Ou(t.attrs,Q,r)){if(Pa(a))return!1;C=!0}continue}const Oe=Lu(8&a?"class":U,h,gf(t),r);if(-1===Oe){if(Pa(a))return!1;C=!0;continue}if(""!==Q){let Ue;Ue=Oe>y?"":h[Oe+1].toLowerCase();const pt=8&a?Ue:null;if(pt&&-1!==Sc(pt,Q,0)||2&a&&Q!==Ue){if(Pa(a))return!1;C=!0}}}}else{if(!C&&!Pa(a)&&!Pa(U))return!1;if(C&&Pa(U))continue;C=!1,a=U|1&a}}return Pa(a)||C}function Pa(t){return 0==(1&t)}function Lu(t,n,r,a){if(null===n)return-1;let h=0;if(a||!r){let y=!1;for(;h<n.length;){const C=n[h];if(C===t)return h;if(3===C||6===C)y=!0;else{if(1===C||2===C){let D=n[++h];for(;"string"==typeof D;)D=n[++h];continue}if(4===C)break;if(0===C){h+=4;continue}}h+=y?1:2}return-1}return function(t,n){let r=t.indexOf(4);if(r>-1)for(r++;r<t.length;){const a=t[r];if("number"==typeof a)return-1;if(a===n)return r;r++}return-1}(n,t)}function kr(t,n,r=!1){for(let a=0;a<n.length;a++)if(mf(t,n[a],r))return!0;return!1}function Al(t,n){e:for(let r=0;r<n.length;r++){const a=n[r];if(t.length===a.length){for(let h=0;h<t.length;h++)if(t[h]!==a[h])continue e;return!0}}return!1}function Pc(t,n){return t?":not("+n.trim()+")":n}function vf(t){let n=t[0],r=1,a=2,h="",y=!1;for(;r<t.length;){let C=t[r];if("string"==typeof C)if(2&a){const D=t[++r];h+="["+C+(D.length>0?'="'+D+'"':"")+"]"}else 8&a?h+="."+C:4&a&&(h+=" "+C);else""!==h&&!Pa(C)&&(n+=Pc(y,h),h=""),a=C,y=y||!Pa(a);r++}return""!==h&&(n+=Pc(y,h)),n}const er={};function xf(t){bf(Ui(),Mn(),Zr()+t,No())}function bf(t,n,r,a){if(!a)if(3==(3&n[2])){const y=t.preOrderCheckHooks;null!==y&&ba(n,y,r)}else{const y=t.preOrderHooks;null!==y&&wa(n,y,0,r)}Xr(r)}function vd(t,n){return t<<17|n<<2}function ja(t){return t>>17&32767}function lu(t){return 2|t}function Qs(t){return(131068&t)>>2}function xd(t,n){return-131069&t|n<<2}function Oh(t){return 1|t}function Mf(t,n){const r=t.contentQueries;if(null!==r)for(let a=0;a<r.length;a+=2){const h=r[a],y=r[a+1];if(-1!==y){const C=t.data[y];ue(h),C.contentQueries(2,n[y],y)}}}function cl(t,n,r,a,h,y,C,D,U,Q){const ge=n.blueprint.slice();return ge[0]=h,ge[2]=140|a,ks(ge),ge[3]=ge[15]=t,ge[8]=r,ge[10]=C||t&&t[10],ge[11]=D||t&&t[11],ge[12]=U||t&&t[12]||null,ge[9]=Q||t&&t[9]||null,ge[6]=y,ge[16]=2==n.type?t[16]:ge,ge}function oc(t,n,r,a,h){let y=t.data[n];if(null===y)y=function(t,n,r,a,h){const y=Jo(),C=Ko(),U=t.data[n]=function(t,n,r,a,h,y){return{type:r,index:a,insertBeforeIndex:null,injectorIndex:n?n.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:h,attrs:y,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:n,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,C?y:y&&y.parent,r,n,a,h);return null===t.firstChild&&(t.firstChild=U),null!==y&&(C?null==y.child&&null!==U.parent&&(y.child=U):null===y.next&&(y.next=U)),U}(t,n,r,a,h),Di.lFrame.inI18n&&(y.flags|=64);else if(64&y.type){y.type=r,y.value=a,y.attrs=h;const C=function(){const t=Di.lFrame,n=t.currentTNode;return t.isParent?n:n.parent}();y.injectorIndex=null===C?-1:C.injectorIndex}return Vr(y,!0),y}function kc(t,n,r,a){if(0===r)return-1;const h=n.length;for(let y=0;y<r;y++)n.push(a),t.blueprint.push(a),t.data.push(null);return h}function Bu(t,n,r){Sn(n);try{const a=t.viewQuery;null!==a&&Nd(1,a,r);const h=t.template;null!==h&&Pl(t,n,h,1,r),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&Mf(t,n),t.staticViewQueries&&Nd(2,t.viewQuery,r);const y=t.components;null!==y&&function(t,n){for(let r=0;r<n.length;r++)Uf(t,n[r])}(n,y)}catch(a){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),a}finally{n[2]&=-5,hr()}}function sc(t,n,r,a){const h=n[2];if(256==(256&h))return;Sn(n);const y=No();try{ks(n),function(t){Di.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==r&&Pl(t,n,r,2,a);const C=3==(3&h);if(!y)if(C){const Q=t.preOrderCheckHooks;null!==Q&&ba(n,Q,null)}else{const Q=t.preOrderHooks;null!==Q&&wa(n,Q,0,null),wo(n,0)}if(function(t){for(let n=Au(t);null!==n;n=wh(n)){if(!n[2])continue;const r=n[9];for(let a=0;a<r.length;a++){const h=r[a],y=h[3];0==(1024&h[2])&&ws(y,1),h[2]|=1024}}}(n),function(t){for(let n=Au(t);null!==n;n=wh(n))for(let r=10;r<n.length;r++){const a=n[r],h=a[1];qo(a)&&sc(h,a,h.template,a[8])}}(n),null!==t.contentQueries&&Mf(t,n),!y)if(C){const Q=t.contentCheckHooks;null!==Q&&ba(n,Q)}else{const Q=t.contentHooks;null!==Q&&wa(n,Q,1),wo(n,1)}!function(t,n){const r=t.hostBindingOpCodes;if(null!==r)try{for(let a=0;a<r.length;a++){const h=r[a];if(h<0)Xr(~h);else{const y=h,C=r[++a],D=r[++a];jc(C,y),D(2,n[y])}}}finally{Xr(-1)}}(t,n);const D=t.components;null!==D&&function(t,n){for(let r=0;r<n.length;r++)zf(t,n[r])}(n,D);const U=t.viewQuery;if(null!==U&&Nd(2,U,a),!y)if(C){const Q=t.viewCheckHooks;null!==Q&&ba(n,Q)}else{const Q=t.viewHooks;null!==Q&&wa(n,Q,2),wo(n,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),y||(n[2]&=-73),1024&n[2]&&(n[2]&=-1025,ws(n[3],-1))}finally{hr()}}function _m(t,n,r,a){const h=n[10],y=!No(),C=Ls(n);try{y&&!C&&h.begin&&h.begin(),C&&Bu(t,n,a),sc(t,n,r,a)}finally{y&&!C&&h.end&&h.end()}}function Pl(t,n,r,a,h){const y=Zr(),C=2&a;try{Xr(-1),C&&n.length>20&&bf(t,n,20,No()),r(a,h)}finally{Xr(y)}}function Uh(t,n,r){if(Sr(n)){const h=n.directiveEnd;for(let y=n.directiveStart;y<h;y++){const C=t.data[y];C.contentQueries&&C.contentQueries(1,r[y],y)}}}function Id(t,n,r){!Ka()||(function(t,n,r,a){const h=r.directiveStart,y=r.directiveEnd;t.firstCreatePass||da(r,n),gs(a,n);const C=r.initialInputs;for(let D=h;D<y;D++){const U=t.data[D],Q=ur(U);Q&&Bf(n,r,U);const ge=Aa(n,t,D,r);gs(ge,n),null!==C&&Od(0,D-h,ge,U,0,C),Q&&(Lr(r.index,n)[8]=ge)}}(t,n,r,Ri(r,n)),128==(128&r.flags)&&function(t,n,r){const a=r.directiveStart,h=r.directiveEnd,C=r.index,D=Di.lFrame.currentDirectiveIndex;try{Xr(C);for(let U=a;U<h;U++){const Q=t.data[U],ge=n[U];A(U),(null!==Q.hostBindings||0!==Q.hostVars||null!==Q.hostAttrs)&&zu(Q,ge)}}finally{Xr(-1),A(D)}}(t,n,r))}function cu(t,n,r=Ri){const a=n.localNames;if(null!==a){let h=n.index+1;for(let y=0;y<a.length;y+=2){const C=a[y+1],D=-1===C?r(n,t):t[C];t[h++]=D}}}function Dd(t){const n=t.tView;return null===n||n.incompleteFirstPass?t.tView=Ad(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):n}function Ad(t,n,r,a,h,y,C,D,U,Q){const ge=20+a,Oe=ge+h,Ue=function(t,n){const r=[];for(let a=0;a<n;a++)r.push(a<t?null:er);return r}(ge,Oe),pt="function"==typeof Q?Q():Q;return Ue[1]={type:t,blueprint:Ue,template:r,queries:null,viewQuery:D,declTNode:n,data:Ue.slice().fill(null,ge),bindingStartIndex:ge,expandoStartIndex:Oe,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof y?y():y,pipeRegistry:"function"==typeof C?C():C,firstChild:null,schemas:U,consts:pt,incompleteFirstPass:!1}}function Pf(t,n,r,a){const h=Kh(n);null===r?h.push(a):(h.push(r),t.firstCreatePass&&Xh(t).push(a,h.length-1))}function Sd(t,n,r){for(let a in t)if(t.hasOwnProperty(a)){const h=t[a];(r=null===r?{}:r).hasOwnProperty(a)?r[a].push(n,h):r[a]=[n,h]}return r}function Us(t,n,r,a,h,y,C,D){const U=Ri(n,r);let ge,Q=n.inputs;!D&&null!=Q&&(ge=Q[a])?(Rl(t,r,ge,a,h),yr(n)&&function(t,n){const r=Lr(n,t);16&r[2]||(r[2]|=64)}(r,n.index)):3&n.type&&(a=function(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(a),h=null!=C?C(h,n.value||"",a):h,Xe(y)?y.setProperty(U,a,h):Fs(a)||(U.setProperty?U.setProperty(a,h):U[a]=h))}function jh(t,n,r,a){let h=!1;if(Ka()){const y=function(t,n,r){const a=t.directiveRegistry;let h=null;if(a)for(let y=0;y<a.length;y++){const C=a[y];kr(r,C.selectors,!1)&&(h||(h=[]),vl(da(r,n),t,C.type),ur(C)?(lc(t,r),h.unshift(C)):h.push(C))}return h}(t,n,r),C=null===a?null:{"":-1};if(null!==y){h=!0,Hh(r,t.data.length,y.length);for(let ge=0;ge<y.length;ge++){const Oe=y[ge];Oe.providersResolver&&Oe.providersResolver(Oe)}let D=!1,U=!1,Q=kc(t,n,y.length,null);for(let ge=0;ge<y.length;ge++){const Oe=y[ge];r.mergedAttrs=ca(r.mergedAttrs,Oe.hostAttrs),Gh(t,r,n,Q,Oe),ho(Q,Oe,C),null!==Oe.contentQueries&&(r.flags|=8),(null!==Oe.hostBindings||null!==Oe.hostAttrs||0!==Oe.hostVars)&&(r.flags|=128);const Ue=Oe.type.prototype;!D&&(Ue.ngOnChanges||Ue.ngOnInit||Ue.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(r.index),D=!0),!U&&(Ue.ngOnChanges||Ue.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(r.index),U=!0),Q++}!function(t,n){const a=n.directiveEnd,h=t.data,y=n.attrs,C=[];let D=null,U=null;for(let Q=n.directiveStart;Q<a;Q++){const ge=h[Q],Oe=ge.inputs,Ue=null===y||gf(n)?null:Wh(Oe,y);C.push(Ue),D=Sd(Oe,Q,D),U=Sd(ge.outputs,Q,U)}null!==D&&(D.hasOwnProperty("class")&&(n.flags|=16),D.hasOwnProperty("style")&&(n.flags|=32)),n.initialInputs=C,n.inputs=D,n.outputs=U}(t,r)}C&&function(t,n,r){if(n){const a=t.localNames=[];for(let h=0;h<n.length;h+=2){const y=r[n[h+1]];if(null==y)throw new Fe("301",`Export of name '${n[h+1]}' not found!`);a.push(n[h],y)}}}(r,a,C)}return r.mergedAttrs=ca(r.mergedAttrs,r.attrs),h}function qh(t,n,r,a,h,y){const C=y.hostBindings;if(C){let D=t.hostBindingOpCodes;null===D&&(D=t.hostBindingOpCodes=[]);const U=~n.index;(function(t){let n=t.length;for(;n>0;){const r=t[--n];if("number"==typeof r&&r<0)return r}return 0})(D)!=U&&D.push(U),D.push(a,h,C)}}function zu(t,n){null!==t.hostBindings&&t.hostBindings(1,n)}function lc(t,n){n.flags|=2,(t.components||(t.components=[])).push(n.index)}function ho(t,n,r){if(r){if(n.exportAs)for(let a=0;a<n.exportAs.length;a++)r[n.exportAs[a]]=t;ur(n)&&(r[""]=t)}}function Hh(t,n,r){t.flags|=1,t.directiveStart=n,t.directiveEnd=n+r,t.providerIndexes=n}function Gh(t,n,r,a,h){t.data[a]=h;const y=h.factory||(h.factory=rt(h.type)),C=new Ca(y,ur(h),null);t.blueprint[a]=C,r[a]=C,qh(t,n,0,a,kc(t,r,h.hostVars,er),h)}function Bf(t,n,r){const a=Ri(n,t),h=Dd(r),y=t[10],C=Zu(t,cl(t,h,null,r.onPush?64:16,a,n,y,y.createRenderer(a,r),null,null));t[n.index]=C}function qa(t,n,r,a,h,y){const C=Ri(t,n);!function(t,n,r,a,h,y,C){if(null==y)Xe(t)?t.removeAttribute(n,h,r):n.removeAttribute(h);else{const D=null==C?et(y):C(y,a||"",h);Xe(t)?t.setAttribute(n,h,D,r):r?n.setAttributeNS(r,h,D):n.setAttribute(h,D)}}(n[11],C,y,t.value,r,a,h)}function Od(t,n,r,a,h,y){const C=y[n];if(null!==C){const D=a.setInput;for(let U=0;U<C.length;){const Q=C[U++],ge=C[U++],Oe=C[U++];null!==D?a.setInput(r,Oe,Q,ge):r[ge]=Oe}}}function Wh(t,n){let r=null,a=0;for(;a<n.length;){const h=n[a];if(0!==h)if(5!==h){if("number"==typeof h)break;t.hasOwnProperty(h)&&(null===r&&(r=[]),r.push(h,t[h],n[a+1])),a+=2}else a+=2;else a+=4}return r}function Ld(t,n,r,a){return new Array(t,!0,!1,n,null,0,a,r,null,null)}function zf(t,n){const r=Lr(n,t);if(qo(r)){const a=r[1];80&r[2]?sc(a,r,a.template,r[8]):r[5]>0&&Yh(r)}}function Yh(t){for(let a=Au(t);null!==a;a=wh(a))for(let h=10;h<a.length;h++){const y=a[h];if(1024&y[2]){const C=y[1];sc(C,y,C.template,y[8])}else y[5]>0&&Yh(y)}const r=t[1].components;if(null!==r)for(let a=0;a<r.length;a++){const h=Lr(r[a],t);qo(h)&&h[5]>0&&Yh(h)}}function Uf(t,n){const r=Lr(n,t),a=r[1];(function(t,n){for(let r=n.length;r<t.blueprint.length;r++)n.push(t.blueprint[r])})(a,r),Bu(a,r,r[8])}function Zu(t,n){return t[13]?t[14][4]=n:t[13]=n,t[14]=n,n}function ms(t){for(;t;){t[2]|=64;const n=Du(t);if(vo(t)&&!n)return t;t=n}return null}function Fd(t,n,r){const a=n[10];a.begin&&a.begin();try{sc(t,n,t.template,r)}catch(h){throw ep(n,h),h}finally{a.end&&a.end()}}function Vf(t){!function(t){for(let n=0;n<t.components.length;n++){const r=t.components[n],a=sd(r),h=a[1];_m(h,a,h.template,r)}}(t[8])}function Nd(t,n,r){ue(0),n(t,r)}const $f=(()=>Promise.resolve(null))();function Kh(t){return t[7]||(t[7]=[])}function Xh(t){return t.cleanup||(t.cleanup=[])}function ep(t,n){const r=t[9],a=r?r.get(tu,null):null;a&&a.handleError(n)}function Rl(t,n,r,a,h){for(let y=0;y<r.length;){const C=r[y++],D=r[y++],U=n[C],Q=t.data[C];null!==Q.setInput?Q.setInput(U,h,a,D):U[D]=h}}function ul(t,n,r){const a=nr(n,t);!function(t,n,r){Xe(t)?t.setValue(n,r):n.textContent=r}(t[11],a,r)}function Fc(t,n,r){let a=r?t.styles:null,h=r?t.classes:null,y=0;if(null!==n)for(let C=0;C<n.length;C++){const D=n[C];"number"==typeof D?y=D:1==y?h=ze(h,D):2==y&&(a=ze(a,D+": "+n[++C]+";"))}r?t.styles=a:t.stylesWithoutHost=a,r?t.classes=h:t.classesWithoutHost=h}const Nc=new fr("INJECTOR",-1);class Ha{get(n,r=Hr){if(r===Hr){const a=new Error(`NullInjectorError: No provider for ${we(n)}!`);throw a.name="NullInjectorError",a}return r}}const Bc=new fr("Set Injector scope."),zc={},Ga={};let Ol;function tp(){return void 0===Ol&&(Ol=new Ha),Ol}function ju(t,n=null,r=null,a){return new Hf(t,r,n||tp(),a)}class Hf{constructor(n,r,a,h=null){this.parent=a,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const y=[];r&&be(r,D=>this.processProvider(D,n,r)),be([n],D=>this.processInjectorType(D,[],y)),this.records.set(Nc,cc(void 0,this));const C=this.records.get(Bc);this.scope=null!=C?C.value:null,this.source=h||("object"==typeof n?null:we(n))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(n=>n.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(n,r=Hr,a=_e.Default){this.assertNotDestroyed();const h=ds(this),y=ye(void 0);try{if(!(a&_e.SkipSelf)){let D=this.records.get(n);if(void 0===D){const U=("function"==typeof(t=n)||"object"==typeof t&&t instanceof fr)&&Wi(n);D=U&&this.injectableDefInScope(U)?cc(Bd(n),zc):null,this.records.set(n,D)}if(null!=D)return this.hydrate(n,D)}return(a&_e.Self?tp():this.parent).get(n,r=a&_e.Optional&&r===Hr?null:r)}catch(C){if("NullInjectorError"===C.name){if((C[ki]=C[ki]||[]).unshift(we(n)),h)throw C;return Zo(C,n,"R3InjectorError",this.source)}throw C}finally{ye(y),ds(h)}var t}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(n=>this.get(n))}toString(){const n=[];return this.records.forEach((a,h)=>n.push(we(h))),`R3Injector[${n.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Error("Injector has already been destroyed.")}processInjectorType(n,r,a){if(!(n=Te(n)))return!1;let h=xn(n);const y=null==h&&n.ngModule||void 0,C=void 0===y?n:y,D=-1!==a.indexOf(C);if(void 0!==y&&(h=xn(y)),null==h)return!1;if(null!=h.imports&&!D){let ge;a.push(C);try{be(h.imports,Oe=>{this.processInjectorType(Oe,r,a)&&(void 0===ge&&(ge=[]),ge.push(Oe))})}finally{}if(void 0!==ge)for(let Oe=0;Oe<ge.length;Oe++){const{ngModule:Ue,providers:pt}=ge[Oe];be(pt,At=>this.processProvider(At,Ue,pt||hi))}}this.injectorDefTypes.add(C);const U=rt(C)||(()=>new C);this.records.set(C,cc(U,zc));const Q=h.providers;if(null!=Q&&!D){const ge=n;be(Q,Oe=>this.processProvider(Oe,ge,Q))}return void 0!==y&&void 0!==n.providers}processProvider(n,r,a){let h=e(n=Te(n))?n:Te(n&&n.provide);const y=(t=n,np(t)?cc(void 0,t.useValue):cc(Wf(t),zc));var t;if(e(n)||!0!==n.multi)this.records.get(h);else{let C=this.records.get(h);C||(C=cc(void 0,zc,!0),C.factory=()=>Br(C.multi),this.records.set(h,C)),h=n,C.multi.push(n)}this.records.set(h,y)}hydrate(n,r){return r.value===zc&&(r.value=Ga,r.value=r.factory()),"object"==typeof r.value&&r.value&&null!==(t=r.value)&&"object"==typeof t&&"function"==typeof t.ngOnDestroy&&this.onDestroy.add(r.value),r.value;var t}injectableDefInScope(n){if(!n.providedIn)return!1;const r=Te(n.providedIn);return"string"==typeof r?"any"===r||r===this.scope:this.injectorDefTypes.has(r)}}function Bd(t){const n=Wi(t),r=null!==n?n.factory:rt(t);if(null!==r)return r;if(t instanceof fr)throw new Error(`Token ${we(t)} is missing a \u0275prov definition.`);if(t instanceof Function)return function(t){const n=t.length;if(n>0){const a=Ve(n,"?");throw new Error(`Can't resolve all parameters for ${we(t)}: (${a.join(", ")}).`)}const r=function(t){const n=t&&(t[rn]||t[ft]);if(n){const r=function(t){if(t.hasOwnProperty("name"))return t.name;const n=(""+t).match(/^function\s*([^\s(]+)/);return null===n?"":n[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${r}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${r}" class.`),n}return null}(t);return null!==r?()=>r.factory(t):()=>new t}(t);throw new Error("unreachable")}function Wf(t,n,r){let a;if(e(t)){const h=Te(t);return rt(h)||Bd(h)}if(np(t))a=()=>Te(t.useValue);else if(function(t){return!(!t||!t.useFactory)}(t))a=()=>t.useFactory(...Br(t.deps||[]));else if(function(t){return!(!t||!t.useExisting)}(t))a=()=>Zi(Te(t.useExisting));else{const h=Te(t&&(t.useClass||t.provide));if(!function(t){return!!t.deps}(t))return rt(h)||Bd(h);a=()=>new h(...Br(t.deps))}return a}function cc(t,n,r=!1){return{factory:t,value:n,multi:r?[]:void 0}}function np(t){return null!==t&&"object"==typeof t&&zo in t}function e(t){return"function"==typeof t}const M=function(t,n,r){return function(t,n=null,r=null,a){const h=ju(t,n,r,a);return h._resolveInjectorDefTypes(),h}({name:r},n,t,r)};let z=(()=>{class t{static create(r,a){return Array.isArray(r)?M(r,a,""):M(r.providers,r.parent,r.name||"")}}return t.THROW_IF_NOT_FOUND=Hr,t.NULL=new Ha,t.\u0275prov=si({token:t,providedIn:"any",factory:()=>Zi(Nc)}),t.__NG_ELEMENT_ID__=-1,t})();function Ur(t,n){Qa(sd(t)[1],vr())}function jr(t){let n=function(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),r=!0;const a=[t];for(;n;){let h;if(ur(t))h=n.\u0275cmp||n.\u0275dir;else{if(n.\u0275cmp)throw new Error("Directives cannot inherit Components");h=n.\u0275dir}if(h){if(r){a.push(h);const C=t;C.inputs=rs(t.inputs),C.declaredInputs=rs(t.declaredInputs),C.outputs=rs(t.outputs);const D=h.hostBindings;D&&Tr(t,D);const U=h.viewQuery,Q=h.contentQueries;if(U&&Go(t,U),Q&&yo(t,Q),ve(t.inputs,h.inputs),ve(t.declaredInputs,h.declaredInputs),ve(t.outputs,h.outputs),ur(h)&&h.data.animation){const ge=t.data;ge.animation=(ge.animation||[]).concat(h.data.animation)}}const y=h.features;if(y)for(let C=0;C<y.length;C++){const D=y[C];D&&D.ngInherit&&D(t),D===jr&&(r=!1)}}n=Object.getPrototypeOf(n)}!function(t){let n=0,r=null;for(let a=t.length-1;a>=0;a--){const h=t[a];h.hostVars=n+=h.hostVars,h.hostAttrs=ca(h.hostAttrs,r=ca(r,h.hostAttrs))}}(a)}function rs(t){return t===Ji?{}:t===hi?[]:t}function Go(t,n){const r=t.viewQuery;t.viewQuery=r?(a,h)=>{n(a,h),r(a,h)}:n}function yo(t,n){const r=t.contentQueries;t.contentQueries=r?(a,h,y)=>{n(a,h,y),r(a,h,y)}:n}function Tr(t,n){const r=t.hostBindings;t.hostBindings=r?(a,h)=>{n(a,h),r(a,h)}:n}let Zs=null;function Ds(){if(!Zs){const t=Ei.Symbol;if(t&&t.iterator)Zs=t.iterator;else{const n=Object.getOwnPropertyNames(Map.prototype);for(let r=0;r<n.length;++r){const a=n[r];"entries"!==a&&"size"!==a&&Map.prototype[a]===Map.prototype.entries&&(Zs=a)}}}return Zs}function Ro(t){return!!$s(t)&&(Array.isArray(t)||!(t instanceof Map)&&Ds()in t)}function $s(t){return null!==t&&("function"==typeof t||"object"==typeof t)}function ta(t,n,r){return t[n]=r}function os(t,n,r){return!Object.is(t[n],r)&&(t[n]=r,!0)}function na(t,n,r,a){const h=os(t,n,r);return os(t,n+1,a)||h}function As(t,n,r,a){const h=Mn();return os(h,ro(),n)&&(Ui(),qa(Jr(),h,t,n,r,a)),As}function hl(t,n,r,a){return os(t,ro(),r)?n+et(r)+a:er}function Zc(t,n,r,a,h,y,C,D){const Q=function(t,n,r,a,h){const y=na(t,n,r,a);return os(t,n+2,h)||y}(t,Gs(),r,h,C);return Ts(3),Q?n+et(r)+a+et(h)+y+et(C)+D:er}function Oa(t,n,r,a,h,y,C,D,U,Q){const Oe=function(t,n,r,a,h,y){const C=na(t,n,r,a);return na(t,n+2,h,y)||C}(t,Gs(),r,h,C,U);return Ts(4),Oe?n+et(r)+a+et(h)+y+et(C)+D+et(U)+Q:er}function Sy(t,n,r,a,h,y,C,D){const U=Mn(),Q=Ui(),ge=t+20,Oe=Q.firstCreatePass?function(t,n,r,a,h,y,C,D,U){const Q=n.consts,ge=oc(n,t,4,C||null,Pr(Q,D));jh(n,r,ge,Pr(Q,U)),Qa(n,ge);const Oe=ge.tViews=Ad(2,ge,a,h,y,n.directiveRegistry,n.pipeRegistry,null,n.schemas,Q);return null!==n.queries&&(n.queries.template(n,ge),Oe.queries=n.queries.embeddedTView(ge)),ge}(ge,Q,U,n,r,a,h,y,C):Q.data[ge];Vr(Oe,!1);const Ue=U[11].createComment("");Su(Q,U,Ue,Oe),gs(Ue,U),Zu(U,U[ge]=Ld(Ue,U,Ue,Oe)),qr(Oe)&&Id(Q,U,Oe),null!=C&&cu(U,Oe,D)}function Py(t){return go(Di.lFrame.contextLView,20+t)}function ip(t,n=_e.Default){const r=Mn();return null===r?Zi(t,n):xc(vr(),r,Te(t),n)}function $y(){throw new Error("invalid")}function Sm(t,n,r){const a=Mn();return os(a,ro(),n)&&Us(Ui(),Jr(),a,t,n,a[11],r,!1),Sm}function Pm(t,n,r,a,h){const C=h?"class":"style";Rl(t,r,n.inputs[C],C,a)}function Rm(t,n,r,a){const h=Mn(),y=Ui(),C=20+t,D=h[11],U=h[C]=Eh(D,n,Di.lFrame.currentNamespace),Q=y.firstCreatePass?function(t,n,r,a,h,y,C){const D=n.consts,Q=oc(n,t,2,h,Pr(D,y));return jh(n,r,Q,Pr(D,C)),null!==Q.attrs&&Fc(Q,Q.attrs,!1),null!==Q.mergedAttrs&&Fc(Q,Q.mergedAttrs,!0),null!==n.queries&&n.queries.elementStart(n,Q),Q}(C,y,h,0,n,r,a):y.data[C];Vr(Q,!0);const ge=Q.mergedAttrs;null!==ge&&mo(D,U,ge);const Oe=Q.classes;null!==Oe&&au(D,U,Oe);const Ue=Q.styles;null!==Ue&&yd(D,U,Ue),64!=(64&Q.flags)&&Su(y,h,U,Q),0===Di.lFrame.elementDepthCount&&gs(U,h),Di.lFrame.elementDepthCount++,qr(Q)&&(Id(y,h,Q),Uh(y,Q,h)),null!==a&&cu(h,Q)}function Om(){let t=vr();Ko()?bo():(t=t.parent,Vr(t,!1));const n=t;Di.lFrame.elementDepthCount--;const r=Ui();r.firstCreatePass&&(Qa(r,t),Sr(t)&&r.queries.elementEnd(t)),null!=n.classesWithoutHost&&function(t){return 0!=(16&t.flags)}(n)&&Pm(r,n,Mn(),n.classesWithoutHost,!0),null!=n.stylesWithoutHost&&function(t){return 0!=(32&t.flags)}(n)&&Pm(r,n,Mn(),n.stylesWithoutHost,!1)}function jy(t,n,r,a){Rm(t,n,r,a),Om()}function Lm(t,n,r){const a=Mn(),h=Ui(),y=t+20,C=h.firstCreatePass?function(t,n,r,a,h){const y=n.consts,C=Pr(y,a),D=oc(n,t,8,"ng-container",C);return null!==C&&Fc(D,C,!0),jh(n,r,D,Pr(y,h)),null!==n.queries&&n.queries.elementStart(n,D),D}(y,h,a,n,r):h.data[y];Vr(C,!0);const D=a[y]=a[11].createComment("");Su(h,a,D,C),gs(D,a),qr(C)&&(Id(h,a,C),Uh(h,C,a)),null!=r&&cu(a,C)}function km(){let t=vr();const n=Ui();Ko()?bo():(t=t.parent,Vr(t,!1)),n.firstCreatePass&&(Qa(n,t),Sr(t)&&n.queries.elementEnd(t))}function qy(){return Mn()}function Fm(t){return!!t&&"function"==typeof t.then}function Hy(t){return!!t&&"function"==typeof t.subscribe}const Nm=Hy;function Bm(t,n,r,a){const h=Mn(),y=Ui(),C=vr();return function(t,n,r,a,h,y,C,D){const U=qr(a),ge=t.firstCreatePass&&Xh(t),Oe=n[8],Ue=Kh(n);let pt=!0;if(3&a.type||D){const Wt=Ri(a,n),Nn=D?D(Wt):Wt,Tn=Ue.length,Ai=D?Hi=>D(wi(Hi[a.index])):a.index;if(Xe(r)){let Hi=null;if(!D&&U&&(Hi=function(t,n,r,a){const h=t.cleanup;if(null!=h)for(let y=0;y<h.length-1;y+=2){const C=h[y];if(C===r&&h[y+1]===a){const D=n[7],U=h[y+2];return D.length>U?D[U]:null}"string"==typeof C&&(y+=2)}return null}(t,n,h,a.index)),null!==Hi)(Hi.__ngLastListenerFn__||Hi).__ngNextListenerFn__=y,Hi.__ngLastListenerFn__=y,pt=!1;else{y=zm(a,n,Oe,y,!1);const Er=r.listen(Nn,h,y);Ue.push(y,Er),ge&&ge.push(h,Ai,Tn,Tn+1)}}else y=zm(a,n,Oe,y,!0),Nn.addEventListener(h,y,C),Ue.push(y),ge&&ge.push(h,Ai,Tn,C)}else y=zm(a,n,Oe,y,!1);const At=a.outputs;let an;if(pt&&null!==At&&(an=At[h])){const Wt=an.length;if(Wt)for(let Nn=0;Nn<Wt;Nn+=2){const ys=n[an[Nn]][an[Nn+1]].subscribe(y),gl=Ue.length;Ue.push(y,ys),ge&&ge.push(h,a.index,gl,-(gl+1))}}}(y,h,h[11],C,t,n,!!r,a),Bm}function Yy(t,n,r,a){try{return!1!==r(a)}catch(h){return ep(t,h),!1}}function zm(t,n,r,a,h){return function y(C){if(C===Function)return a;const D=2&t.flags?Lr(t.index,n):n;0==(32&n[2])&&ms(D);let U=Yy(n,0,a,C),Q=y.__ngNextListenerFn__;for(;Q;)U=Yy(n,0,Q,C)&&U,Q=Q.__ngNextListenerFn__;return h&&!1===U&&(C.preventDefault(),C.returnValue=!1),U}}function Jy(t=1){return function(t){return(Di.lFrame.contextLView=function(t,n){for(;t>0;)n=n[15],t--;return n}(t,Di.lFrame.contextLView))[8]}(t)}function K1(t,n){let r=null;const a=function(t){const n=t.attrs;if(null!=n){const r=n.indexOf(5);if(0==(1&r))return n[r+1]}return null}(t);for(let h=0;h<n.length;h++){const y=n[h];if("*"!==y){if(null===a?kr(t,y,!0):Al(a,y))return h}else r=h}return r}function Ky(t){const n=Mn()[16][6];if(!n.projection){const a=n.projection=Ve(t?t.length:1,null),h=a.slice();let y=n.child;for(;null!==y;){const C=t?K1(y,t):0;null!==C&&(h[C]?h[C].projectionNext=y:a[C]=y,h[C]=y),y=y.next}}}function Xy(t,n=0,r){const a=Mn(),h=Ui(),y=oc(h,20+t,16,null,r||null);null===y.projection&&(y.projection=n),bo(),64!=(64&y.flags)&&function(t,n,r){pf(n[11],0,n,r,of(t,r,n),af(r.parent||n[6],r,n))}(h,a,y)}function Um(t,n,r){return Vm(t,"",n,"",r),Um}function Vm(t,n,r,a,h){const y=Mn(),C=hl(y,n,r,a);return C!==er&&Us(Ui(),Jr(),y,t,C,y[11],h,!1),Vm}function av(t,n,r,a,h){const y=t[r+1],C=null===n;let D=a?ja(y):Qs(y),U=!1;for(;0!==D&&(!1===U||C);){const ge=t[D+1];eb(t[D],n)&&(U=!0,t[D+1]=a?Oh(ge):lu(ge)),D=a?ja(ge):Qs(ge)}U&&(t[r+1]=a?lu(y):Oh(y))}function eb(t,n){return null===t||null==n||(Array.isArray(t)?t[1]:t)===n||!(!Array.isArray(t)||"string"!=typeof n)&&Pt(t,n)>=0}function Zm(t,n,r){return Ll(t,n,r,!1),Zm}function $m(t,n){return Ll(t,n,null,!0),$m}function Ll(t,n,r,a){const h=Mn(),y=Ui(),C=Ts(2);y.firstUpdatePass&&function(t,n,r,a){const h=t.data;if(null===h[r+1]){const y=h[Zr()],C=function(t,n){return n>=t.expandoStartIndex}(t,r);(function(t,n){return 0!=(t.flags&(n?16:32))})(y,a)&&null===n&&!C&&(n=!1),n=function(t,n,r,a){const h=function(t){const n=Di.lFrame.currentDirectiveIndex;return-1===n?null:t[n]}(t);let y=a?n.residualClasses:n.residualStyles;if(null===h)0===(a?n.classBindings:n.styleBindings)&&(r=rp(r=jm(null,t,n,r,a),n.attrs,a),y=null);else{const C=n.directiveStylingLast;if(-1===C||t[C]!==h)if(r=jm(h,t,n,r,a),null===y){let U=function(t,n,r){const a=r?n.classBindings:n.styleBindings;if(0!==Qs(a))return t[ja(a)]}(t,n,a);void 0!==U&&Array.isArray(U)&&(U=jm(null,t,n,U[1],a),U=rp(U,n.attrs,a),function(t,n,r,a){t[ja(r?n.classBindings:n.styleBindings)]=a}(t,n,a,U))}else y=function(t,n,r){let a;const h=n.directiveEnd;for(let y=1+n.directiveStylingLast;y<h;y++)a=rp(a,t[y].hostAttrs,r);return rp(a,n.attrs,r)}(t,n,a)}return void 0!==y&&(a?n.residualClasses=y:n.residualStyles=y),r}(h,y,n,a),function(t,n,r,a,h,y){let C=y?n.classBindings:n.styleBindings,D=ja(C),U=Qs(C);t[a]=r;let ge,Q=!1;if(Array.isArray(r)){const Oe=r;ge=Oe[1],(null===ge||Pt(Oe,ge)>0)&&(Q=!0)}else ge=r;if(h)if(0!==U){const Ue=ja(t[D+1]);t[a+1]=vd(Ue,D),0!==Ue&&(t[Ue+1]=xd(t[Ue+1],a)),t[D+1]=function(t,n){return 131071&t|n<<17}(t[D+1],a)}else t[a+1]=vd(D,0),0!==D&&(t[D+1]=xd(t[D+1],a)),D=a;else t[a+1]=vd(U,0),0===D?D=a:t[U+1]=xd(t[U+1],a),U=a;Q&&(t[a+1]=lu(t[a+1])),av(t,ge,a,!0),av(t,ge,a,!1),function(t,n,r,a,h){const y=h?t.residualClasses:t.residualStyles;null!=y&&"string"==typeof n&&Pt(y,n)>=0&&(r[a+1]=Oh(r[a+1]))}(n,ge,t,a,y),C=vd(D,U),y?n.classBindings=C:n.styleBindings=C}(h,y,n,r,C,a)}}(y,t,C,a),n!==er&&os(h,C,n)&&function(t,n,r,a,h,y,C,D){if(!(3&n.type))return;const U=t.data,Q=U[D+1];Kf(function(t){return 1==(1&t)}(Q)?yv(U,n,r,h,Qs(Q),C):void 0)||(Kf(y)||function(t){return 2==(2&t)}(Q)&&(y=yv(U,null,r,h,D,C)),function(t,n,r,a,h){const y=Xe(t);if(n)h?y?t.addClass(r,a):r.classList.add(a):y?t.removeClass(r,a):r.classList.remove(a);else{let C=-1===a.indexOf("-")?void 0:sl.DashCase;if(null==h)y?t.removeStyle(r,a,C):r.style.removeProperty(a);else{const D="string"==typeof h&&h.endsWith("!important");D&&(h=h.slice(0,-10),C|=sl.Important),y?t.setStyle(r,a,h,C):r.style.setProperty(a,h,D?"important":"")}}}(a,C,nr(Zr(),r),h,y))}(y,y.data[Zr()],h,h[11],t,h[C+1]=function(t,n){return null==t||("string"==typeof n?t+=n:"object"==typeof t&&(t=we(zs(t)))),t}(n,r),a,C)}function jm(t,n,r,a,h){let y=null;const C=r.directiveEnd;let D=r.directiveStylingLast;for(-1===D?D=r.directiveStart:D++;D<C&&(y=n[D],a=rp(a,y.hostAttrs,h),y!==t);)D++;return null!==t&&(r.directiveStylingLast=D),a}function rp(t,n,r){const a=r?1:2;let h=-1;if(null!==n)for(let y=0;y<n.length;y++){const C=n[y];"number"==typeof C?h=C:h===a&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),wt(t,C,!!r||n[++y]))}return void 0===t?null:t}function yv(t,n,r,a,h,y){const C=null===n;let D;for(;h>0;){const U=t[h],Q=Array.isArray(U),ge=Q?U[1]:U,Oe=null===ge;let Ue=r[h+1];Ue===er&&(Ue=Oe?hi:void 0);let pt=Oe?nt(Ue,a):ge===a?Ue:void 0;if(Q&&!Kf(pt)&&(pt=nt(U,a)),Kf(pt)&&(D=pt,C))return D;const At=t[h+1];h=C?ja(At):Qs(At)}if(null!==n){let U=y?n.residualClasses:n.residualStyles;null!=U&&(D=nt(U,a))}return D}function Kf(t){return void 0!==t}function xv(t,n=""){const r=Mn(),a=Ui(),h=t+20,y=a.firstCreatePass?oc(a,h,1,n,null):a.data[h],C=r[h]=function(t,n){return Xe(t)?t.createText(n):t.createTextNode(n)}(r[11],n);Su(a,r,C,y),Vr(y,!1)}function qm(t){return Xf("",t,""),qm}function Xf(t,n,r){const a=Mn(),h=hl(a,t,n,r);return h!==er&&ul(a,Zr(),h),Xf}function Hm(t,n,r,a,h){const y=Mn(),C=function(t,n,r,a,h,y){const D=na(t,Gs(),r,h);return Ts(2),D?n+et(r)+a+et(h)+y:er}(y,t,n,r,a,h);return C!==er&&ul(y,Zr(),C),Hm}function Gm(t,n,r,a,h,y,C){const D=Mn(),U=Zc(D,t,n,r,a,h,y,C);return U!==er&&ul(D,Zr(),U),Gm}function Wm(t,n,r,a,h,y,C,D,U){const Q=Mn(),ge=Oa(Q,t,n,r,a,h,y,C,D,U);return ge!==er&&ul(Q,Zr(),ge),Wm}const qu=void 0;var kb=["en",[["a","p"],["AM","PM"],qu],[["AM","PM"],qu,qu],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],qu,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],qu,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",qu,"{1} 'at' {0}",qu],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function(t){const r=Math.floor(Math.abs(t)),a=t.toString().replace(/^[^.]*\.?/,"").length;return 1===r&&0===a?1:5}];let qd={};function Ym(t){const n=function(t){return t.toLowerCase().replace(/_/g,"-")}(t);let r=Bv(n);if(r)return r;const a=n.split("-")[0];if(r=Bv(a),r)return r;if("en"===a)return kb;throw new Error(`Missing locale data for the locale "${t}".`)}function Nv(t){return Ym(t)[zi.PluralCase]}function Bv(t){return t in qd||(qd[t]=Ei.ng&&Ei.ng.common&&Ei.ng.common.locales&&Ei.ng.common.locales[t]),qd[t]}var zi=(()=>((zi=zi||{})[zi.LocaleId=0]="LocaleId",zi[zi.DayPeriodsFormat=1]="DayPeriodsFormat",zi[zi.DayPeriodsStandalone=2]="DayPeriodsStandalone",zi[zi.DaysFormat=3]="DaysFormat",zi[zi.DaysStandalone=4]="DaysStandalone",zi[zi.MonthsFormat=5]="MonthsFormat",zi[zi.MonthsStandalone=6]="MonthsStandalone",zi[zi.Eras=7]="Eras",zi[zi.FirstDayOfWeek=8]="FirstDayOfWeek",zi[zi.WeekendRange=9]="WeekendRange",zi[zi.DateFormat=10]="DateFormat",zi[zi.TimeFormat=11]="TimeFormat",zi[zi.DateTimeFormat=12]="DateTimeFormat",zi[zi.NumberSymbols=13]="NumberSymbols",zi[zi.NumberFormats=14]="NumberFormats",zi[zi.CurrencyCode=15]="CurrencyCode",zi[zi.CurrencySymbol=16]="CurrencySymbol",zi[zi.CurrencyName=17]="CurrencyName",zi[zi.Currencies=18]="Currencies",zi[zi.Directionality=19]="Directionality",zi[zi.PluralCase=20]="PluralCase",zi[zi.ExtraData=21]="ExtraData",zi))();const Qf="en-US";let zv=Qf;function Xm(t,n,r,a,h){if(t=Te(t),Array.isArray(t))for(let y=0;y<t.length;y++)Xm(t[y],n,r,a,h);else{const y=Ui(),C=Mn();let D=e(t)?t:Te(t.provide),U=Wf(t);const Q=vr(),ge=1048575&Q.providerIndexes,Oe=Q.directiveStart,Ue=Q.providerIndexes>>20;if(e(t)||!t.multi){const pt=new Ca(U,h,ip),At=e_(D,n,h?ge:ge+Ue,Oe);-1===At?(vl(da(Q,C),y,D),Qm(y,t,n.length),n.push(D),Q.directiveStart++,Q.directiveEnd++,h&&(Q.providerIndexes+=1048576),r.push(pt),C.push(pt)):(r[At]=pt,C[At]=pt)}else{const pt=e_(D,n,ge+Ue,Oe),At=e_(D,n,ge,ge+Ue),an=pt>=0&&r[pt],Wt=At>=0&&r[At];if(h&&!Wt||!h&&!an){vl(da(Q,C),y,D);const Nn=function(t,n,r,a,h){const y=new Ca(t,r,ip);return y.multi=[],y.index=n,y.componentProviders=0,u0(y,h,a&&!r),y}(h?Ow:Rw,r.length,h,a,U);!h&&Wt&&(r[At].providerFactory=Nn),Qm(y,t,n.length,0),n.push(D),Q.directiveStart++,Q.directiveEnd++,h&&(Q.providerIndexes+=1048576),r.push(Nn),C.push(Nn)}else Qm(y,t,pt>-1?pt:At,u0(r[h?At:pt],U,!h&&a));!h&&a&&Wt&&r[At].componentProviders++}}}function Qm(t,n,r,a){const h=e(n);if(h||function(t){return!!t.useClass}(n)){const C=(n.useClass||n).prototype.ngOnDestroy;if(C){const D=t.destroyHooks||(t.destroyHooks=[]);if(!h&&n.multi){const U=D.indexOf(r);-1===U?D.push(r,[a,C]):D[U+1].push(a,C)}else D.push(r,C)}}}function u0(t,n,r){return r&&t.componentProviders++,t.multi.push(n)-1}function e_(t,n,r,a){for(let h=r;h<a;h++)if(n[h]===t)return h;return-1}function Rw(t,n,r,a){return t_(this.multi,[])}function Ow(t,n,r,a){const h=this.multi;let y;if(this.providerFactory){const C=this.providerFactory.componentProviders,D=Aa(r,r[1],this.providerFactory.index,a);y=D.slice(0,C),t_(h,y);for(let U=C;U<D.length;U++)y.push(D[U])}else y=[],t_(h,y);return y}function t_(t,n){for(let r=0;r<t.length;r++)n.push((0,t[r])());return n}function d0(t,n=[]){return r=>{r.providersResolver=(a,h)=>function(t,n,r){const a=Ui();if(a.firstCreatePass){const h=ur(t);Xm(r,a.data,a.blueprint,h,!0),Xm(n,a.data,a.blueprint,h,!1)}}(a,h?h(t):t,n)}}class h0{}const f0="ngComponent";class Fw{resolveComponentFactory(n){throw function(t){const n=Error(`No component factory found for ${we(t)}. Did you add it to @NgModule.entryComponents?`);return n[f0]=t,n}(n)}}let Gd=(()=>{class t{}return t.NULL=new Fw,t})();function rg(...t){}function Wd(t,n){return new pc(Ri(t,n))}const zw=function(){return Wd(vr(),Mn())};let pc=(()=>{class t{constructor(r){this.nativeElement=r}}return t.__NG_ELEMENT_ID__=zw,t})();function g0(t){return t instanceof pc?t.nativeElement:t}class og{}let Uw=(()=>{class t{}return t.__NG_ELEMENT_ID__=()=>Zw(),t})();const Zw=function(){const t=Mn(),r=Lr(vr().index,t);return function(t){return t[11]}(vi(r)?r:t)};let i_=(()=>{class t{}return t.\u0275prov=si({token:t,providedIn:"root",factory:()=>null}),t})();class m0{constructor(n){this.full=n,this.major=n.split(".")[0],this.minor=n.split(".")[1],this.patch=n.split(".").slice(2).join(".")}}const _0=new m0("13.0.0"),Yd={};function sg(t,n,r,a,h=!1){for(;null!==r;){const y=n[r.index];if(null!==y&&a.push(wi(y)),ji(y))for(let D=10;D<y.length;D++){const U=y[D],Q=U[1].firstChild;null!==Q&&sg(U[1],U,Q,a)}const C=r.type;if(8&C)sg(t,n,r.child,a);else if(32&C){const D=Ac(r,n);let U;for(;U=D();)a.push(U)}else if(16&C){const D=Mh(n,r);if(Array.isArray(D))a.push(...D);else{const U=Du(n[16]);sg(U[1],U,D,a,!0)}}r=h?r.projectionNext:r.next}return a}class cp{constructor(n,r){this._lView=n,this._cdRefInjectingView=r,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const n=this._lView,r=n[1];return sg(r,n,r.firstChild,[])}get context(){return this._lView[8]}set context(n){this._lView[8]=n}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const n=this._lView[3];if(ji(n)){const r=n[8],a=r?r.indexOf(this):-1;a>-1&&(Ih(n,a),Me(r,a))}this._attachedToViewContainer=!1}ou(this._lView[1],this._lView)}onDestroy(n){Pf(this._lView[1],this._lView,null,n)}markForCheck(){ms(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){Fd(this._lView[1],this._lView,this.context)}checkNoChanges(){!function(t,n,r){Ni(!0);try{Fd(t,n,r)}finally{Ni(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Error("This view is already attached directly to the ApplicationRef!");this._attachedToViewContainer=!0}detachFromAppRef(){var n;this._appRef=null,Ru(this._lView[1],n=this._lView,n[11],2,null,null)}attachToAppRef(n){if(this._attachedToViewContainer)throw new Error("This view is already attached to a ViewContainer!");this._appRef=n}}class qw extends cp{constructor(n){super(n),this._view=n}detectChanges(){Vf(this._view)}checkNoChanges(){!function(t){Ni(!0);try{Vf(t)}finally{Ni(!1)}}(this._view)}get context(){return null}}class y0 extends Gd{constructor(n){super(),this.ngModule=n}resolveComponentFactory(n){const r=Qn(n);return new r_(r,this.ngModule)}}function v0(t){const n=[];for(let r in t)t.hasOwnProperty(r)&&n.push({propName:t[r],templateName:r});return n}const Gw=new fr("SCHEDULER_TOKEN",{providedIn:"root",factory:()=>Iu});class r_ extends h0{constructor(n,r){super(),this.componentDef=n,this.ngModule=r,this.componentType=n.type,this.selector=n.selectors.map(vf).join(","),this.ngContentSelectors=n.ngContentSelectors?n.ngContentSelectors:[],this.isBoundToModule=!!r}get inputs(){return v0(this.componentDef.inputs)}get outputs(){return v0(this.componentDef.outputs)}create(n,r,a,h){const y=(h=h||this.ngModule)?function(t,n){return{get:(r,a,h)=>{const y=t.get(r,Yd,h);return y!==Yd||a===Yd?y:n.get(r,a,h)}}}(n,h.injector):n,C=y.get(og,Jt),D=y.get(i_,null),U=C.createRenderer(null,this.componentDef),Q=this.componentDef.selectors[0][0]||"div",ge=a?function(t,n,r){if(Xe(t))return t.selectRootElement(n,r===Un.ShadowDom);let a="string"==typeof n?t.querySelector(n):n;return a.textContent="",a}(U,a,this.componentDef.encapsulation):Eh(C.createRenderer(null,this.componentDef),Q,function(t){const n=t.toLowerCase();return"svg"===n?"http://www.w3.org/2000/svg":"math"===n?"http://www.w3.org/1998/MathML/":null}(Q)),Oe=this.componentDef.onPush?576:528,Ue=function(t,n){return{components:[],scheduler:t||Iu,clean:$f,playerHandler:n||null,flags:0}}(),pt=Ad(0,null,null,1,0,null,null,null,null,null),At=cl(null,pt,Ue,Oe,null,null,C,U,D,y);let an,Wt;Sn(At);try{const Nn=function(t,n,r,a,h,y){const C=r[1];r[20]=t;const U=oc(C,20,2,"#host",null),Q=U.mergedAttrs=n.hostAttrs;null!==Q&&(Fc(U,Q,!0),null!==t&&(mo(h,t,Q),null!==U.classes&&au(h,t,U.classes),null!==U.styles&&yd(h,t,U.styles)));const ge=a.createRenderer(t,n),Oe=cl(r,Dd(n),null,n.onPush?64:16,r[20],U,a,ge,y||null,null);return C.firstCreatePass&&(vl(da(U,r),C,n.type),lc(C,U),Hh(U,r.length,1)),Zu(r,Oe),r[20]=Oe}(ge,this.componentDef,At,C,U);if(ge)if(a)mo(U,ge,["ng-version",_0.full]);else{const{attrs:Tn,classes:Ai}=function(t){const n=[],r=[];let a=1,h=2;for(;a<t.length;){let y=t[a];if("string"==typeof y)2===h?""!==y&&n.push(y,t[++a]):8===h&&r.push(y);else{if(!Pa(h))break;h=y}a++}return{attrs:n,classes:r}}(this.componentDef.selectors[0]);Tn&&mo(U,ge,Tn),Ai&&Ai.length>0&&au(U,ge,Ai.join(" "))}if(Wt=Wr(pt,20),void 0!==r){const Tn=Wt.projection=[];for(let Ai=0;Ai<this.ngContentSelectors.length;Ai++){const Hi=r[Ai];Tn.push(null!=Hi?Array.from(Hi):null)}}an=function(t,n,r,a,h){const y=r[1],C=function(t,n,r){const a=vr();t.firstCreatePass&&(r.providersResolver&&r.providersResolver(r),Gh(t,a,n,kc(t,n,1,null),r));const h=Aa(n,t,a.directiveStart,a);gs(h,n);const y=Ri(a,n);return y&&gs(y,n),h}(y,r,n);if(a.components.push(C),t[8]=C,h&&h.forEach(U=>U(C,n)),n.contentQueries){const U=vr();n.contentQueries(1,C,U.directiveStart)}const D=vr();return!y.firstCreatePass||null===n.hostBindings&&null===n.hostAttrs||(Xr(D.index),qh(r[1],D,0,D.directiveStart,D.directiveEnd,n),zu(n,C)),C}(Nn,this.componentDef,At,Ue,[Ur]),Bu(pt,At,null)}finally{hr()}return new Jw(this.componentType,an,Wd(Wt,At),At,Wt)}}class Jw extends class{}{constructor(n,r,a,h,y){super(),this.location=a,this._rootLView=h,this._tNode=y,this.instance=r,this.hostView=this.changeDetectorRef=new qw(h),this.componentType=n}get injector(){return new F(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(n){this.hostView.onDestroy(n)}}class Hu{}class x0{}const Jd=new Map;class w0 extends Hu{constructor(n,r){super(),this._parent=r,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new y0(this);const a=Yn(n);this._bootstrapComponents=$a(a.bootstrap),this._r3Injector=ju(n,r,[{provide:Hu,useValue:this},{provide:Gd,useValue:this.componentFactoryResolver}],we(n)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(n)}get(n,r=z.THROW_IF_NOT_FOUND,a=_e.Default){return n===z||n===Hu||n===Nc?this:this._r3Injector.get(n,r,a)}destroy(){const n=this._r3Injector;!n.destroyed&&n.destroy(),this.destroyCbs.forEach(r=>r()),this.destroyCbs=null}onDestroy(n){this.destroyCbs.push(n)}}class s_ extends x0{constructor(n){super(),this.moduleType=n,null!==Yn(n)&&function(t){const n=new Set;!function r(a){const h=Yn(a,!0),y=h.id;null!==y&&(function(t,n,r){if(n&&n!==r)throw new Error(`Duplicate module registered for ${t} - ${we(n)} vs ${we(n.name)}`)}(y,Jd.get(y),a),Jd.set(y,a));const C=$a(h.imports);for(const D of C)n.has(D)||(n.add(D),r(D))}(t)}(n)}create(n){return new w0(this.moduleType,n)}}function C0(t,n,r){const a=Yr()+t,h=Mn();return h[a]===er?ta(h,a,r?n.call(r):n()):function(t,n){return t[n]}(h,a)}function up(t,n){const r=t[n];return r===er?void 0:r}function M0(t,n){const r=Ui();let a;const h=t+20;r.firstCreatePass?(a=function(t,n){if(n)for(let r=n.length-1;r>=0;r--){const a=n[r];if(t===a.name)return a}throw new Fe("302",`The pipe '${t}' could not be found!`)}(n,r.pipeRegistry),r.data[h]=a,a.onDestroy&&(r.destroyHooks||(r.destroyHooks=[])).push(h,a.onDestroy)):a=r.data[h];const y=a.factory||(a.factory=rt(a.type)),C=ye(ip);try{const D=il(!1),U=y();return il(D),function(t,n,r,a){r>=t.data.length&&(t.data[r]=null,t.blueprint[r]=null),n[r]=a}(r,Mn(),h,U),U}finally{ye(C)}}function S0(t,n,r){const a=t+20,h=Mn(),y=go(h,a);return dp(h,a)?function(t,n,r,a,h,y){const C=n+r;return os(t,C,h)?ta(t,C+1,y?a.call(y,h):a(h)):up(t,C+1)}(h,Yr(),n,y.transform,r,y):y.transform(r)}function P0(t,n,r,a){const h=t+20,y=Mn(),C=go(y,h);return dp(y,h)?function(t,n,r,a,h,y,C){const D=n+r;return na(t,D,h,y)?ta(t,D+2,C?a.call(C,h,y):a(h,y)):up(t,D+2)}(y,Yr(),n,C.transform,r,a,C):C.transform(r,a)}function dp(t,n){return t[1].data[n].pure}function a_(t){return n=>{setTimeout(t,void 0,n)}}const fc=class extends O.xQ{constructor(n=!1){super(),this.__isAsync=n}emit(n){super.next(n)}subscribe(n,r,a){let h=n,y=r||(()=>null),C=a;if(n&&"object"==typeof n){const U=n;h=U.next?.bind(U),y=U.error?.bind(U),C=U.complete?.bind(U)}this.__isAsync&&(y=a_(y),h&&(h=a_(h)),C&&(C=a_(C)));const D=super.subscribe({next:h,error:y,complete:C});return n instanceof f.w&&n.add(D),D}};function pC(){return this._results[Ds()]()}class ag{constructor(n=!1){this._emitDistinctChangesOnly=n,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const r=Ds(),a=ag.prototype;a[r]||(a[r]=pC)}get changes(){return this._changes||(this._changes=new fc)}get(n){return this._results[n]}map(n){return this._results.map(n)}filter(n){return this._results.filter(n)}find(n){return this._results.find(n)}reduce(n,r){return this._results.reduce(n,r)}forEach(n){this._results.forEach(n)}some(n){return this._results.some(n)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(n,r){const a=this;a.dirty=!1;const h=he(n);(this._changesDetected=!function(t,n,r){if(t.length!==n.length)return!1;for(let a=0;a<t.length;a++){let h=t[a],y=n[a];if(r&&(h=r(h),y=r(y)),y!==h)return!1}return!0}(a._results,h,r))&&(a._results=h,a.length=h.length,a.last=h[this.length-1],a.first=h[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}Symbol;const gC=function(){return lg(vr(),Mn())};let hp=(()=>{class t{}return t.__NG_ELEMENT_ID__=gC,t})();const mC=hp,_C=class extends mC{constructor(n,r,a){super(),this._declarationLView=n,this._declarationTContainer=r,this.elementRef=a}createEmbeddedView(n){const r=this._declarationTContainer.tViews,a=cl(this._declarationLView,r,n,16,null,r.declTNode,null,null,null,null);a[17]=this._declarationLView[this._declarationTContainer.index];const y=this._declarationLView[19];return null!==y&&(a[19]=y.createEmbeddedView(r)),Bu(r,a,n),new cp(a)}};function lg(t,n){return 4&t.type?new _C(n,t,Wd(t,n)):null}const xC=function(){return L0(vr(),Mn())};let cg=(()=>{class t{}return t.__NG_ELEMENT_ID__=xC,t})();const wC=cg,R0=class extends wC{constructor(n,r,a){super(),this._lContainer=n,this._hostTNode=r,this._hostLView=a}get element(){return Wd(this._hostTNode,this._hostLView)}get injector(){return new F(this._hostTNode,this._hostLView)}get parentInjector(){const n=yl(this._hostTNode,this._hostLView);if(Ea(n)){const r=Ns(n,this._hostLView),a=nl(n);return new F(r[1].data[a+8],r)}return new F(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(n){const r=O0(this._lContainer);return null!==r&&r[n]||null}get length(){return this._lContainer.length-10}createEmbeddedView(n,r,a){const h=n.createEmbeddedView(r||{});return this.insert(h,a),h}createComponent(n,r,a,h,y){const C=n&&!("function"==typeof n);let D;if(C)D=r;else{const Oe=r||{};D=Oe.index,a=Oe.injector,h=Oe.projectableNodes,y=Oe.ngModuleRef}const U=C?n:new r_(Qn(n)),Q=a||this.parentInjector;if(!y&&null==U.ngModule&&Q){const Oe=Q.get(Hu,null);Oe&&(y=Oe)}const ge=U.create(Q,h,void 0,y);return this.insert(ge.hostView,D),ge}insert(n,r){const a=n._lView,h=a[1];if(ji(a[3])){const ge=this.indexOf(n);if(-1!==ge)this.detach(ge);else{const Oe=a[3],Ue=new R0(Oe,Oe[6],Oe[3]);Ue.detach(Ue.indexOf(n))}}const y=this._adjustIndex(r),C=this._lContainer;!function(t,n,r,a){const h=10+a,y=r.length;a>0&&(r[h-1][4]=n),a<y-10?(n[4]=r[h],Ce(r,10+a,n)):(r.push(n),n[4]=null),n[3]=r;const C=n[17];null!==C&&r!==C&&function(t,n){const r=t[9];n[16]!==n[3][3][16]&&(t[2]=!0),null===r?t[9]=[n]:r.push(n)}(C,n);const D=n[19];null!==D&&D.insertView(t),n[2]|=128}(h,a,C,y);const D=Sh(y,C),U=a[11],Q=_d(U,C[7]);return null!==Q&&function(t,n,r,a,h,y){a[0]=h,a[6]=n,Ru(t,a,r,1,h,y)}(h,C[6],U,a,Q,D),n.attachToViewContainerRef(),Ce(l_(C),y,n),n}move(n,r){return this.insert(n,r)}indexOf(n){const r=O0(this._lContainer);return null!==r?r.indexOf(n):-1}remove(n){const r=this._adjustIndex(n,-1),a=Ih(this._lContainer,r);a&&(Me(l_(this._lContainer),r),ou(a[1],a))}detach(n){const r=this._adjustIndex(n,-1),a=Ih(this._lContainer,r);return a&&null!=Me(l_(this._lContainer),r)?new cp(a):null}_adjustIndex(n,r=0){return n??this.length+r}};function O0(t){return t[8]}function l_(t){return t[8]||(t[8]=[])}function L0(t,n){let r;const a=n[t.index];if(ji(a))r=a;else{let h;if(8&t.type)h=wi(a);else{const y=n[11];h=y.createComment("");const C=Ri(t,n);nc(y,_d(y,C),h,function(t,n){return Xe(t)?t.nextSibling(n):n.nextSibling}(y,C),!1)}n[t.index]=r=Ld(a,n,h,t),Zu(n,r)}return new R0(r,t,n)}class c_{constructor(n){this.queryList=n,this.matches=null}clone(){return new c_(this.queryList)}setDirty(){this.queryList.setDirty()}}class u_{constructor(n=[]){this.queries=n}createEmbeddedView(n){const r=n.queries;if(null!==r){const a=null!==n.contentQueries?n.contentQueries[0]:r.length,h=[];for(let y=0;y<a;y++){const C=r.getByIndex(y);h.push(this.queries[C.indexInDeclarationView].clone())}return new u_(h)}return null}insertView(n){this.dirtyQueriesWithMatches(n)}detachView(n){this.dirtyQueriesWithMatches(n)}dirtyQueriesWithMatches(n){for(let r=0;r<this.queries.length;r++)null!==$0(n,r).matches&&this.queries[r].setDirty()}}class k0{constructor(n,r,a=null){this.predicate=n,this.flags=r,this.read=a}}class d_{constructor(n=[]){this.queries=n}elementStart(n,r){for(let a=0;a<this.queries.length;a++)this.queries[a].elementStart(n,r)}elementEnd(n){for(let r=0;r<this.queries.length;r++)this.queries[r].elementEnd(n)}embeddedTView(n){let r=null;for(let a=0;a<this.length;a++){const h=null!==r?r.length:0,y=this.getByIndex(a).embeddedTView(n,h);y&&(y.indexInDeclarationView=a,null!==r?r.push(y):r=[y])}return null!==r?new d_(r):null}template(n,r){for(let a=0;a<this.queries.length;a++)this.queries[a].template(n,r)}getByIndex(n){return this.queries[n]}get length(){return this.queries.length}track(n){this.queries.push(n)}}class h_{constructor(n,r=-1){this.metadata=n,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=r}elementStart(n,r){this.isApplyingToNode(r)&&this.matchTNode(n,r)}elementEnd(n){this._declarationNodeIndex===n.index&&(this._appliesToNextNode=!1)}template(n,r){this.elementStart(n,r)}embeddedTView(n,r){return this.isApplyingToNode(n)?(this.crossesNgTemplate=!0,this.addMatch(-n.index,r),new h_(this.metadata)):null}isApplyingToNode(n){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const r=this._declarationNodeIndex;let a=n.parent;for(;null!==a&&8&a.type&&a.index!==r;)a=a.parent;return r===(null!==a?a.index:-1)}return this._appliesToNextNode}matchTNode(n,r){const a=this.metadata.predicate;if(Array.isArray(a))for(let h=0;h<a.length;h++){const y=a[h];this.matchTNodeWithReadOption(n,r,EC(r,y)),this.matchTNodeWithReadOption(n,r,rl(r,n,y,!1,!1))}else a===hp?4&r.type&&this.matchTNodeWithReadOption(n,r,-1):this.matchTNodeWithReadOption(n,r,rl(r,n,a,!1,!1))}matchTNodeWithReadOption(n,r,a){if(null!==a){const h=this.metadata.read;if(null!==h)if(h===pc||h===cg||h===hp&&4&r.type)this.addMatch(r.index,-2);else{const y=rl(r,n,h,!1,!1);null!==y&&this.addMatch(r.index,y)}else this.addMatch(r.index,a)}}addMatch(n,r){null===this.matches?this.matches=[n,r]:this.matches.push(n,r)}}function EC(t,n){const r=t.localNames;if(null!==r)for(let a=0;a<r.length;a+=2)if(r[a]===n)return r[a+1];return null}function DC(t,n,r,a){return-1===r?function(t,n){return 11&t.type?Wd(t,n):4&t.type?lg(t,n):null}(n,t):-2===r?function(t,n,r){return r===pc?Wd(n,t):r===hp?lg(n,t):r===cg?L0(n,t):void 0}(t,n,a):Aa(t,t[1],r,n)}function F0(t,n,r,a){const h=n[19].queries[a];if(null===h.matches){const y=t.data,C=r.matches,D=[];for(let U=0;U<C.length;U+=2){const Q=C[U];D.push(Q<0?null:DC(n,y[Q],C[U+1],r.metadata.read))}h.matches=D}return h.matches}function p_(t,n,r,a){const h=t.queries.getByIndex(r),y=h.matches;if(null!==y){const C=F0(t,n,h,r);for(let D=0;D<y.length;D+=2){const U=y[D];if(U>0)a.push(C[D/2]);else{const Q=y[D+1],ge=n[-U];for(let Oe=10;Oe<ge.length;Oe++){const Ue=ge[Oe];Ue[17]===Ue[3]&&p_(Ue[1],Ue,Q,a)}if(null!==ge[9]){const Oe=ge[9];for(let Ue=0;Ue<Oe.length;Ue++){const pt=Oe[Ue];p_(pt[1],pt,Q,a)}}}}}return a}function N0(t){const n=Mn(),r=Ui(),a=R();ue(a+1);const h=$0(r,a);if(t.dirty&&Ls(n)===(2==(2&h.metadata.flags))){if(null===h.matches)t.reset([]);else{const y=h.crossesNgTemplate?p_(r,n,a,[]):F0(r,n,h,a);t.reset(y,g0),t.notifyOnChanges()}return!0}return!1}function B0(t,n,r){const a=Ui();a.firstCreatePass&&(Z0(a,new k0(t,n,r),-1),2==(2&n)&&(a.staticViewQueries=!0)),V0(a,Mn(),n)}function z0(t,n,r,a){const h=Ui();if(h.firstCreatePass){const y=vr();Z0(h,new k0(n,r,a),y.index),function(t,n){const r=t.contentQueries||(t.contentQueries=[]);n!==(r.length?r[r.length-1]:-1)&&r.push(t.queries.length-1,n)}(h,t),2==(2&r)&&(h.staticContentQueries=!0)}V0(h,Mn(),r)}function U0(){return t=Mn(),n=R(),t[19].queries[n].queryList;var t,n}function V0(t,n,r){const a=new ag(4==(4&r));Pf(t,n,a,a.destroy),null===n[19]&&(n[19]=new u_),n[19].queries.push(new c_(a))}function Z0(t,n,r){null===t.queries&&(t.queries=new d_),t.queries.track(new h_(n,r))}function $0(t,n){return t.queries.getByIndex(n)}const YC=Mi("Output",t=>({bindingPropertyName:t})),JC=Mi("HostListener",(t,n)=>({eventName:t,args:n})),v_=new fr("Application Initializer");let Xd=(()=>{class t{constructor(r){this.appInits=r,this.resolve=rg,this.reject=rg,this.initialized=!1,this.done=!1,this.donePromise=new Promise((a,h)=>{this.resolve=a,this.reject=h})}runInitializers(){if(this.initialized)return;const r=[],a=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let h=0;h<this.appInits.length;h++){const y=this.appInits[h]();if(Fm(y))r.push(y);else if(Nm(y)){const C=new Promise((D,U)=>{y.subscribe({complete:D,error:U})});r.push(C)}}Promise.all(r).then(()=>{a()}).catch(h=>{this.reject(h)}),0===r.length&&a(),this.initialized=!0}}return t.\u0275fac=function(r){return new(r||t)(Zi(v_,8))},t.\u0275prov=si({token:t,factory:t.\u0275fac}),t})();const ax=new fr("AppId"),sT={provide:ax,useFactory:function(){return`${x_()}${x_()}${x_()}`},deps:[]};function x_(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const lx=new fr("Platform Initializer"),cx=new fr("Platform ID"),ux=new fr("appBootstrapListener");let dx=(()=>{class t{log(r){console.log(r)}warn(r){console.warn(r)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=si({token:t,factory:t.\u0275fac}),t})();const hg=new fr("LocaleId"),hx=new fr("DefaultCurrencyCode");class lT{constructor(n,r){this.ngModuleFactory=n,this.componentFactories=r}}const b_=function(t){return new s_(t)},cT=b_,uT=function(t){return Promise.resolve(b_(t))},fx=function(t){const n=b_(t),a=$a(Yn(t).declarations).reduce((h,y)=>{const C=Qn(y);return C&&h.push(new r_(C)),h},[]);return new lT(n,a)},dT=fx,hT=function(t){return Promise.resolve(fx(t))};let w_=(()=>{class t{constructor(){this.compileModuleSync=cT,this.compileModuleAsync=uT,this.compileModuleAndAllComponentsSync=dT,this.compileModuleAndAllComponentsAsync=hT}clearCache(){}clearCacheFor(r){}getModuleId(r){}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=si({token:t,factory:t.\u0275fac}),t})();const gT=(()=>Promise.resolve(0))();function C_(t){"undefined"==typeof Zone?gT.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class Ja{constructor({enableLongStackTrace:n=!1,shouldCoalesceEventChangeDetection:r=!1,shouldCoalesceRunChangeDetection:a=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new fc(!1),this.onMicrotaskEmpty=new fc(!1),this.onStable=new fc(!1),this.onError=new fc(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const h=this;h._nesting=0,h._outer=h._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(h._inner=h._inner.fork(new Zone.TaskTrackingZoneSpec)),n&&Zone.longStackTraceZoneSpec&&(h._inner=h._inner.fork(Zone.longStackTraceZoneSpec)),h.shouldCoalesceEventChangeDetection=!a&&r,h.shouldCoalesceRunChangeDetection=a,h.lastRequestAnimationFrameId=-1,h.nativeRequestAnimationFrame=function(){let t=Ei.requestAnimationFrame,n=Ei.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&n){const r=t[Zone.__symbol__("OriginalDelegate")];r&&(t=r);const a=n[Zone.__symbol__("OriginalDelegate")];a&&(n=a)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:n}}().nativeRequestAnimationFrame,function(t){const n=()=>{!function(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(Ei,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,E_(t),t.isCheckStableRunning=!0,T_(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),E_(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(r,a,h,y,C,D)=>{try{return gx(t),r.invokeTask(h,y,C,D)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===y.type||t.shouldCoalesceRunChangeDetection)&&n(),mx(t)}},onInvoke:(r,a,h,y,C,D,U)=>{try{return gx(t),r.invoke(h,y,C,D,U)}finally{t.shouldCoalesceRunChangeDetection&&n(),mx(t)}},onHasTask:(r,a,h,y)=>{r.hasTask(h,y),a===h&&("microTask"==y.change?(t._hasPendingMicrotasks=y.microTask,E_(t),T_(t)):"macroTask"==y.change&&(t.hasPendingMacrotasks=y.macroTask))},onHandleError:(r,a,h,y)=>(r.handleError(h,y),t.runOutsideAngular(()=>t.onError.emit(y)),!1)})}(h)}static isInAngularZone(){return!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Ja.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(Ja.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(n,r,a){return this._inner.run(n,r,a)}runTask(n,r,a,h){const y=this._inner,C=y.scheduleEventTask("NgZoneEvent: "+h,n,_T,rg,rg);try{return y.runTask(C,r,a)}finally{y.cancelTask(C)}}runGuarded(n,r,a){return this._inner.runGuarded(n,r,a)}runOutsideAngular(n){return this._outer.run(n)}}const _T={};function T_(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function E_(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function gx(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function mx(t){t._nesting--,T_(t)}class xT{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new fc,this.onMicrotaskEmpty=new fc,this.onStable=new fc,this.onError=new fc}run(n,r,a){return n.apply(r,a)}runGuarded(n,r,a){return n.apply(r,a)}runOutsideAngular(n){return n()}runTask(n,r,a,h){return n.apply(r,a)}}let _x=(()=>{class t{constructor(r){this._ngZone=r,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),r.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Ja.assertNotInAngularZone(),C_(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())C_(()=>{for(;0!==this._callbacks.length;){let r=this._callbacks.pop();clearTimeout(r.timeoutId),r.doneCb(this._didWork)}this._didWork=!1});else{let r=this.getPendingTasks();this._callbacks=this._callbacks.filter(a=>!a.updateCb||!a.updateCb(r)||(clearTimeout(a.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(r=>({source:r.source,creationLocation:r.creationLocation,data:r.data})):[]}addCallback(r,a,h){let y=-1;a&&a>0&&(y=setTimeout(()=>{this._callbacks=this._callbacks.filter(C=>C.timeoutId!==y),r(this._didWork,this.getPendingTasks())},a)),this._callbacks.push({doneCb:r,timeoutId:y,updateCb:h})}whenStable(r,a,h){if(h&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(r,a,h),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(r,a,h){return[]}}return t.\u0275fac=function(r){return new(r||t)(Zi(Ja))},t.\u0275prov=si({token:t,factory:t.\u0275fac}),t})(),yx=(()=>{class t{constructor(){this._applications=new Map,I_.addToWindow(this)}registerApplication(r,a){this._applications.set(r,a)}unregisterApplication(r){this._applications.delete(r)}unregisterAllApplications(){this._applications.clear()}getTestability(r){return this._applications.get(r)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(r,a=!0){return I_.findTestabilityInTree(this,r,a)}}return t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=si({token:t,factory:t.\u0275fac}),t})();class bT{addToWindow(n){}findTestabilityInTree(n,r,a){return null}}function wT(t){I_=t}let I_=new bT,vx=!0,xx=!1;function CT(){if(xx)throw new Error("Cannot enable prod mode after platform setup.");vx=!1}let Fl;const wx=new fr("AllowMultipleToken");class ST{constructor(n,r){this.name=n,this.token=r}}function Cx(t,n,r=[]){const a=`Platform: ${n}`,h=new fr(a);return(y=[])=>{let C=Tx();if(!C||C.injector.get(wx,!1))if(t)t(r.concat(y).concat({provide:h,useValue:!0}));else{const D=r.concat(y).concat({provide:h,useValue:!0},{provide:Bc,useValue:"platform"});!function(t){if(Fl&&!Fl.destroyed&&!Fl.injector.get(wx,!1))throw new Error("There can be only one platform. Destroy the previous one to create a new one.");Fl=t.get(Ex);const n=t.get(lx,null);n&&n.forEach(r=>r())}(z.create({providers:D,name:a}))}return function(t){const n=Tx();if(!n)throw new Error("No platform exists!");if(!n.injector.get(t,null))throw new Error("A platform with a different configuration has been created. Please destroy it first.");return n}(h)}}function Tx(){return Fl&&!Fl.destroyed?Fl:null}let Ex=(()=>{class t{constructor(r){this._injector=r,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(r,a){const D=function(t,n){let r;return r="noop"===t?new xT:("zone.js"===t?void 0:t)||new Ja({enableLongStackTrace:(xx=!0,vx),shouldCoalesceEventChangeDetection:!!n?.ngZoneEventCoalescing,shouldCoalesceRunChangeDetection:!!n?.ngZoneRunCoalescing}),r}(a?a.ngZone:void 0,{ngZoneEventCoalescing:a&&a.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:a&&a.ngZoneRunCoalescing||!1}),U=[{provide:Ja,useValue:D}];return D.run(()=>{const Q=z.create({providers:U,parent:this.injector,name:r.moduleType.name}),ge=r.create(Q),Oe=ge.injector.get(tu,null);if(!Oe)throw new Error("No ErrorHandler. Is platform module (BrowserModule) included?");return D.runOutsideAngular(()=>{const Ue=D.onError.subscribe({next:pt=>{Oe.handleError(pt)}});ge.onDestroy(()=>{D_(this._modules,ge),Ue.unsubscribe()})}),function(t,n,r){try{const a=r();return Fm(a)?a.catch(h=>{throw n.runOutsideAngular(()=>t.handleError(h)),h}):a}catch(a){throw n.runOutsideAngular(()=>t.handleError(a)),a}}(Oe,D,()=>{const Ue=ge.injector.get(Xd);return Ue.runInitializers(),Ue.donePromise.then(()=>(function(t){Xt(t,"Expected localeId to be defined"),"string"==typeof t&&(zv=t.toLowerCase().replace(/_/g,"-"))}(ge.injector.get(hg,Qf)||Qf),this._moduleDoBootstrap(ge),ge))})})}bootstrapModule(r,a=[]){const h=Ix({},a);return function(t,n,r){const a=new s_(r);return Promise.resolve(a)}(0,0,r).then(y=>this.bootstrapModuleFactory(y,h))}_moduleDoBootstrap(r){const a=r.injector.get(fp);if(r._bootstrapComponents.length>0)r._bootstrapComponents.forEach(h=>a.bootstrap(h));else{if(!r.instance.ngDoBootstrap)throw new Error(`The module ${we(r.instance.constructor)} was bootstrapped, but it does not declare "@NgModule.bootstrap" components nor a "ngDoBootstrap" method. Please define one of these.`);r.instance.ngDoBootstrap(a)}this._modules.push(r)}onDestroy(r){this._destroyListeners.push(r)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Error("The platform has already been destroyed!");this._modules.slice().forEach(r=>r.destroy()),this._destroyListeners.forEach(r=>r()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(r){return new(r||t)(Zi(z))},t.\u0275prov=si({token:t,factory:t.\u0275fac}),t})();function Ix(t,n){return Array.isArray(n)?n.reduce(Ix,t):{...t,...n}}let fp=(()=>{class t{constructor(r,a,h,y,C){this._zone=r,this._injector=a,this._exceptionHandler=h,this._componentFactoryResolver=y,this._initStatus=C,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const D=new x.y(Q=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{Q.next(this._stable),Q.complete()})}),U=new x.y(Q=>{let ge;this._zone.runOutsideAngular(()=>{ge=this._zone.onStable.subscribe(()=>{Ja.assertNotInAngularZone(),C_(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,Q.next(!0))})})});const Oe=this._zone.onUnstable.subscribe(()=>{Ja.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{Q.next(!1)}))});return()=>{ge.unsubscribe(),Oe.unsubscribe()}});this.isStable=function(...t){let n=Number.POSITIVE_INFINITY,r=null,a=t[t.length-1];return(0,d.K)(a)?(r=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof a&&(n=t.pop()),null===r&&1===t.length&&t[0]instanceof x.y?t[0]:(0,Y.J)(n)((0,l.n)(t,r))}(D,U.pipe(t=>(0,G.x)()(function(t,n){return function(a){let h;h="function"==typeof t?t:function(){return t};const y=Object.create(a,H.N);return y.source=a,y.subjectFactory=h,y}}(ne)(t))))}bootstrap(r,a){if(!this._initStatus.done)throw new Error("Cannot bootstrap as there are still asynchronous initializers running. Bootstrap components in the `ngDoBootstrap` method of the root module.");let h;h=r instanceof h0?r:this._componentFactoryResolver.resolveComponentFactory(r),this.componentTypes.push(h.componentType);const y=function(t){return t.isBoundToModule}(h)?void 0:this._injector.get(Hu),D=h.create(z.NULL,[],a||h.selector,y),U=D.location.nativeElement,Q=D.injector.get(_x,null),ge=Q&&D.injector.get(yx);return Q&&ge&&ge.registerApplication(U,Q),D.onDestroy(()=>{this.detachView(D.hostView),D_(this.components,D),ge&&ge.unregisterApplication(U)}),this._loadComponent(D),D}tick(){if(this._runningTick)throw new Error("ApplicationRef.tick is called recursively");try{this._runningTick=!0;for(let r of this._views)r.detectChanges()}catch(r){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(r))}finally{this._runningTick=!1}}attachView(r){const a=r;this._views.push(a),a.attachToAppRef(this)}detachView(r){const a=r;D_(this._views,a),a.detachFromAppRef()}_loadComponent(r){this.attachView(r.hostView),this.tick(),this.components.push(r),this._injector.get(ux,[]).concat(this._bootstrapListeners).forEach(h=>h(r))}ngOnDestroy(){this._views.slice().forEach(r=>r.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(r){return new(r||t)(Zi(Ja),Zi(z),Zi(tu),Zi(Gd),Zi(Xd))},t.\u0275prov=si({token:t,factory:t.\u0275fac}),t})();function D_(t,n){const r=t.indexOf(n);r>-1&&t.splice(r,1)}const NT=function(t){return function(t,n,r){if(yr(t)&&!r){const a=Lr(t.index,n);return new cp(a,a)}return 47&t.type?new cp(n[16],n):null}(vr(),Mn(),16==(16&t))};let BT=(()=>{class t{}return t.__NG_ELEMENT_ID__=NT,t})();const WT=function(t){return null};class Ox{constructor(){}supports(n){return Ro(n)}create(n){return new KT(n)}}const JT=(t,n)=>n;class KT{constructor(n){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=n||JT}forEachItem(n){let r;for(r=this._itHead;null!==r;r=r._next)n(r)}forEachOperation(n){let r=this._itHead,a=this._removalsHead,h=0,y=null;for(;r||a;){const C=!a||r&&r.currentIndex<kx(a,h,y)?r:a,D=kx(C,h,y),U=C.currentIndex;if(C===a)h--,a=a._nextRemoved;else if(r=r._next,null==C.previousIndex)h++;else{y||(y=[]);const Q=D-h,ge=U-h;if(Q!=ge){for(let Ue=0;Ue<Q;Ue++){const pt=Ue<y.length?y[Ue]:y[Ue]=0,At=pt+Ue;ge<=At&&At<Q&&(y[Ue]=pt+1)}y[C.previousIndex]=ge-Q}}D!==U&&n(C,D,U)}}forEachPreviousItem(n){let r;for(r=this._previousItHead;null!==r;r=r._nextPrevious)n(r)}forEachAddedItem(n){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)n(r)}forEachMovedItem(n){let r;for(r=this._movesHead;null!==r;r=r._nextMoved)n(r)}forEachRemovedItem(n){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)n(r)}forEachIdentityChange(n){let r;for(r=this._identityChangesHead;null!==r;r=r._nextIdentityChange)n(r)}diff(n){if(null==n&&(n=[]),!Ro(n))throw new Error(`Error trying to diff '${we(n)}'. Only arrays and iterables are allowed`);return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let h,y,C,r=this._itHead,a=!1;if(Array.isArray(n)){this.length=n.length;for(let D=0;D<this.length;D++)y=n[D],C=this._trackByFn(D,y),null!==r&&Object.is(r.trackById,C)?(a&&(r=this._verifyReinsertion(r,y,C,D)),Object.is(r.item,y)||this._addIdentityChange(r,y)):(r=this._mismatch(r,y,C,D),a=!0),r=r._next}else h=0,function(t,n){if(Array.isArray(t))for(let r=0;r<t.length;r++)n(t[r]);else{const r=t[Ds()]();let a;for(;!(a=r.next()).done;)n(a.value)}}(n,D=>{C=this._trackByFn(h,D),null!==r&&Object.is(r.trackById,C)?(a&&(r=this._verifyReinsertion(r,D,C,h)),Object.is(r.item,D)||this._addIdentityChange(r,D)):(r=this._mismatch(r,D,C,h),a=!0),r=r._next,h++}),this.length=h;return this._truncate(r),this.collection=n,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let n;for(n=this._previousItHead=this._itHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._additionsHead;null!==n;n=n._nextAdded)n.previousIndex=n.currentIndex;for(this._additionsHead=this._additionsTail=null,n=this._movesHead;null!==n;n=n._nextMoved)n.previousIndex=n.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(n,r,a,h){let y;return null===n?y=this._itTail:(y=n._prev,this._remove(n)),null!==(n=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null))?(Object.is(n.item,r)||this._addIdentityChange(n,r),this._reinsertAfter(n,y,h)):null!==(n=null===this._linkedRecords?null:this._linkedRecords.get(a,h))?(Object.is(n.item,r)||this._addIdentityChange(n,r),this._moveAfter(n,y,h)):n=this._addAfter(new XT(r,a),y,h),n}_verifyReinsertion(n,r,a,h){let y=null===this._unlinkedRecords?null:this._unlinkedRecords.get(a,null);return null!==y?n=this._reinsertAfter(y,n._prev,h):n.currentIndex!=h&&(n.currentIndex=h,this._addToMoves(n,h)),n}_truncate(n){for(;null!==n;){const r=n._next;this._addToRemovals(this._unlink(n)),n=r}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(n,r,a){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(n);const h=n._prevRemoved,y=n._nextRemoved;return null===h?this._removalsHead=y:h._nextRemoved=y,null===y?this._removalsTail=h:y._prevRemoved=h,this._insertAfter(n,r,a),this._addToMoves(n,a),n}_moveAfter(n,r,a){return this._unlink(n),this._insertAfter(n,r,a),this._addToMoves(n,a),n}_addAfter(n,r,a){return this._insertAfter(n,r,a),this._additionsTail=null===this._additionsTail?this._additionsHead=n:this._additionsTail._nextAdded=n,n}_insertAfter(n,r,a){const h=null===r?this._itHead:r._next;return n._next=h,n._prev=r,null===h?this._itTail=n:h._prev=n,null===r?this._itHead=n:r._next=n,null===this._linkedRecords&&(this._linkedRecords=new Lx),this._linkedRecords.put(n),n.currentIndex=a,n}_remove(n){return this._addToRemovals(this._unlink(n))}_unlink(n){null!==this._linkedRecords&&this._linkedRecords.remove(n);const r=n._prev,a=n._next;return null===r?this._itHead=a:r._next=a,null===a?this._itTail=r:a._prev=r,n}_addToMoves(n,r){return n.previousIndex===r||(this._movesTail=null===this._movesTail?this._movesHead=n:this._movesTail._nextMoved=n),n}_addToRemovals(n){return null===this._unlinkedRecords&&(this._unlinkedRecords=new Lx),this._unlinkedRecords.put(n),n.currentIndex=null,n._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=n,n._prevRemoved=null):(n._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=n),n}_addIdentityChange(n,r){return n.item=r,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=n:this._identityChangesTail._nextIdentityChange=n,n}}class XT{constructor(n,r){this.item=n,this.trackById=r,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class QT{constructor(){this._head=null,this._tail=null}add(n){null===this._head?(this._head=this._tail=n,n._nextDup=null,n._prevDup=null):(this._tail._nextDup=n,n._prevDup=this._tail,n._nextDup=null,this._tail=n)}get(n,r){let a;for(a=this._head;null!==a;a=a._nextDup)if((null===r||r<=a.currentIndex)&&Object.is(a.trackById,n))return a;return null}remove(n){const r=n._prevDup,a=n._nextDup;return null===r?this._head=a:r._nextDup=a,null===a?this._tail=r:a._prevDup=r,null===this._head}}class Lx{constructor(){this.map=new Map}put(n){const r=n.trackById;let a=this.map.get(r);a||(a=new QT,this.map.set(r,a)),a.add(n)}get(n,r){const h=this.map.get(n);return h?h.get(n,r):null}remove(n){const r=n.trackById;return this.map.get(r).remove(n)&&this.map.delete(r),n}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function kx(t,n,r){const a=t.previousIndex;if(null===a)return a;let h=0;return r&&a<r.length&&(h=r[a]),a+n+h}class Fx{constructor(){}supports(n){return n instanceof Map||$s(n)}create(){return new eE}}class eE{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(n){let r;for(r=this._mapHead;null!==r;r=r._next)n(r)}forEachPreviousItem(n){let r;for(r=this._previousMapHead;null!==r;r=r._nextPrevious)n(r)}forEachChangedItem(n){let r;for(r=this._changesHead;null!==r;r=r._nextChanged)n(r)}forEachAddedItem(n){let r;for(r=this._additionsHead;null!==r;r=r._nextAdded)n(r)}forEachRemovedItem(n){let r;for(r=this._removalsHead;null!==r;r=r._nextRemoved)n(r)}diff(n){if(n){if(!(n instanceof Map||$s(n)))throw new Error(`Error trying to diff '${we(n)}'. Only maps and objects are allowed`)}else n=new Map;return this.check(n)?this:null}onDestroy(){}check(n){this._reset();let r=this._mapHead;if(this._appendAfter=null,this._forEach(n,(a,h)=>{if(r&&r.key===h)this._maybeAddToChanges(r,a),this._appendAfter=r,r=r._next;else{const y=this._getOrCreateRecordForKey(h,a);r=this._insertBeforeOrAppend(r,y)}}),r){r._prev&&(r._prev._next=null),this._removalsHead=r;for(let a=r;null!==a;a=a._nextRemoved)a===this._mapHead&&(this._mapHead=null),this._records.delete(a.key),a._nextRemoved=a._next,a.previousValue=a.currentValue,a.currentValue=null,a._prev=null,a._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(n,r){if(n){const a=n._prev;return r._next=n,r._prev=a,n._prev=r,a&&(a._next=r),n===this._mapHead&&(this._mapHead=r),this._appendAfter=n,n}return this._appendAfter?(this._appendAfter._next=r,r._prev=this._appendAfter):this._mapHead=r,this._appendAfter=r,null}_getOrCreateRecordForKey(n,r){if(this._records.has(n)){const h=this._records.get(n);this._maybeAddToChanges(h,r);const y=h._prev,C=h._next;return y&&(y._next=C),C&&(C._prev=y),h._next=null,h._prev=null,h}const a=new tE(n);return this._records.set(n,a),a.currentValue=r,this._addToAdditions(a),a}_reset(){if(this.isDirty){let n;for(this._previousMapHead=this._mapHead,n=this._previousMapHead;null!==n;n=n._next)n._nextPrevious=n._next;for(n=this._changesHead;null!==n;n=n._nextChanged)n.previousValue=n.currentValue;for(n=this._additionsHead;null!=n;n=n._nextAdded)n.previousValue=n.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(n,r){Object.is(r,n.currentValue)||(n.previousValue=n.currentValue,n.currentValue=r,this._addToChanges(n))}_addToAdditions(n){null===this._additionsHead?this._additionsHead=this._additionsTail=n:(this._additionsTail._nextAdded=n,this._additionsTail=n)}_addToChanges(n){null===this._changesHead?this._changesHead=this._changesTail=n:(this._changesTail._nextChanged=n,this._changesTail=n)}_forEach(n,r){n instanceof Map?n.forEach(r):Object.keys(n).forEach(a=>r(n[a],a))}}class tE{constructor(n){this.key=n,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function Nx(){return new mg([new Ox])}let mg=(()=>{class t{constructor(r){this.factories=r}static create(r,a){if(null!=a){const h=a.factories.slice();r=r.concat(h)}return new t(r)}static extend(r){return{provide:t,useFactory:a=>t.create(r,a||Nx()),deps:[[t,new ha,new Ks]]}}find(r){const a=this.factories.find(h=>h.supports(r));if(null!=a)return a;throw new Error(`Cannot find a differ supporting object '${r}' of type '${function(t){return t.name||typeof t}(r)}'`)}}return t.\u0275prov=si({token:t,providedIn:"root",factory:Nx}),t})();function Bx(){return new _g([new Fx])}let _g=(()=>{class t{constructor(r){this.factories=r}static create(r,a){if(a){const h=a.factories.slice();r=r.concat(h)}return new t(r)}static extend(r){return{provide:t,useFactory:a=>t.create(r,a||Bx()),deps:[[t,new ha,new Ks]]}}find(r){const a=this.factories.find(h=>h.supports(r));if(a)return a;throw new Error(`Cannot find a differ supporting object '${r}'`)}}return t.\u0275prov=si({token:t,providedIn:"root",factory:Bx}),t})();const iE=[new Fx],oE=new mg([new Ox]),sE=new _g(iE),aE=Cx(null,"core",[{provide:cx,useValue:"unknown"},{provide:Ex,deps:[z]},{provide:yx,deps:[]},{provide:dx,deps:[]}]),hE=[{provide:fp,useClass:fp,deps:[Ja,z,tu,Gd,Xd]},{provide:Gw,deps:[Ja],useFactory:function(t){let n=[];return t.onStable.subscribe(()=>{for(;n.length;)n.pop()()}),function(r){n.push(r)}}},{provide:Xd,useClass:Xd,deps:[[new Ks,v_]]},{provide:w_,useClass:w_,deps:[]},sT,{provide:mg,useFactory:function(){return oE},deps:[]},{provide:_g,useFactory:function(){return sE},deps:[]},{provide:hg,useFactory:function(t){return t||"undefined"!=typeof $localize&&$localize.locale||Qf},deps:[[new hs(hg),new Ks,new ha]]},{provide:hx,useValue:"USD"}];let fE=(()=>{class t{constructor(r){}}return t.\u0275fac=function(r){return new(r||t)(Zi(fp))},t.\u0275mod=un({type:t}),t.\u0275inj=xi({providers:hE}),t})()},9133:(yn,je,N)=>{"use strict";N.d(je,{Fj:()=>me,u5:()=>Yo,Fd:()=>ko,qQ:()=>xs,JU:()=>H,a5:()=>mi,JJ:()=>Wi,On:()=>jn,wV:()=>Ir});var x=N(865),d=N(6019),Y=N(1915),l=N(6813),P=N(8053);let O=(()=>{class B{constructor(S,le){this._renderer=S,this._elementRef=le,this.onChange=Xe=>{},this.onTouched=()=>{}}setProperty(S,le){this._renderer.setProperty(this._elementRef.nativeElement,S,le)}registerOnTouched(S){this.onTouched=S}registerOnChange(S){this.onChange=S}setDisabledState(S){this.setProperty("disabled",S)}}return B.\u0275fac=function(S){return new(S||B)(x.Y36(x.Qsj),x.Y36(x.SBq))},B.\u0275dir=x.lG2({type:B}),B})(),f=(()=>{class B extends O{}return B.\u0275fac=function(){let I;return function(le){return(I||(I=x.n5z(B)))(le||B)}}(),B.\u0275dir=x.lG2({type:B,features:[x.qOj]}),B})();const H=new x.OlP("NgValueAccessor"),G={provide:H,useExisting:(0,x.Gpc)(()=>me),multi:!0},ce=new x.OlP("CompositionEventMode");let me=(()=>{class B extends O{constructor(S,le,Xe){super(S,le),this._compositionMode=Xe,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function(){const B=(0,d.q)()?(0,d.q)().getUserAgent():"";return/android (\d+)/.test(B.toLowerCase())}())}writeValue(S){this.setProperty("value",S??"")}_handleInput(S){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(S)}_compositionStart(){this._composing=!0}_compositionEnd(S){this._composing=!1,this._compositionMode&&this.onChange(S)}}return B.\u0275fac=function(S){return new(S||B)(x.Y36(x.Qsj),x.Y36(x.SBq),x.Y36(ce,8))},B.\u0275dir=x.lG2({type:B,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(S,le){1&S&&x.NdJ("input",function(Jt){return le._handleInput(Jt.target.value)})("blur",function(){return le.onTouched()})("compositionstart",function(){return le._compositionStart()})("compositionend",function(Jt){return le._compositionEnd(Jt.target.value)})},features:[x._Bn([G]),x.qOj]}),B})();function ve(B){return null==B||0===B.length}const ze=new x.OlP("NgValidators"),Ne=new x.OlP("NgAsyncValidators");function bt(B){return null}function ut(B){return null!=B}function St(B){const I=(0,x.QGY)(B)?(0,Y.D)(B):B;return(0,x.CqO)(I),I}function Vt(B){let I={};return B.forEach(S=>{I=null!=S?{...I,...S}:I}),0===Object.keys(I).length?null:I}function bn(B,I){return I.map(S=>S(B))}function Bt(B){return B.map(I=>function(B){return!B.validate}(I)?I:S=>I.validate(S))}function Kt(B){return null!=B?function(B){if(!B)return null;const I=B.filter(ut);return 0==I.length?null:function(S){return Vt(bn(S,I))}}(Bt(B)):null}function Ft(B){return null!=B?function(B){if(!B)return null;const I=B.filter(ut);return 0==I.length?null:function(S){const le=bn(S,I).map(St);return(0,l.D)(le).pipe((0,P.U)(Vt))}}(Bt(B)):null}function ln(B,I){return null===B?[I]:Array.isArray(B)?[...B,I]:[B,I]}function en(B){return B?Array.isArray(B)?B:[B]:[]}function yt(B,I){return Array.isArray(B)?B.includes(I):B===I}function Xt(B,I){const S=en(I);return en(B).forEach(Xe=>{yt(S,Xe)||S.push(Xe)}),S}function cn(B,I){return en(I).filter(S=>!yt(B,S))}class kn{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(I){this._rawValidators=I||[],this._composedValidatorFn=Kt(this._rawValidators)}_setAsyncValidators(I){this._rawAsyncValidators=I||[],this._composedAsyncValidatorFn=Ft(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(I){this._onDestroyCallbacks.push(I)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(I=>I()),this._onDestroyCallbacks=[]}reset(I){this.control&&this.control.reset(I)}hasError(I,S){return!!this.control&&this.control.hasError(I,S)}getError(I,S){return this.control?this.control.getError(I,S):null}}class An extends kn{get formDirective(){return null}get path(){return null}}class mi extends kn{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}let Wi=(()=>{class B extends class{constructor(I){this._cd=I}is(I){return"submitted"===I?!!this._cd?.submitted:!!this._cd?.control?.[I]}}{constructor(S){super(S)}}return B.\u0275fac=function(S){return new(S||B)(x.Y36(mi,2))},B.\u0275dir=x.lG2({type:B,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(S,le){2&S&&x.ekj("ng-untouched",le.is("untouched"))("ng-touched",le.is("touched"))("ng-pristine",le.is("pristine"))("ng-dirty",le.is("dirty"))("ng-valid",le.is("valid"))("ng-invalid",le.is("invalid"))("ng-pending",le.is("pending"))},features:[x.qOj]}),B})();function on(B,I){(function(B,I){const S=function(B){return B._rawValidators}(B);null!==I.validator?B.setValidators(ln(S,I.validator)):"function"==typeof S&&B.setValidators([S]);const le=function(B){return B._rawAsyncValidators}(B);null!==I.asyncValidator?B.setAsyncValidators(ln(le,I.asyncValidator)):"function"==typeof le&&B.setAsyncValidators([le]);const Xe=()=>B.updateValueAndValidity();ci(I._rawValidators,Xe),ci(I._rawAsyncValidators,Xe)})(B,I),I.valueAccessor.writeValue(B.value),function(B,I){I.valueAccessor.registerOnChange(S=>{B._pendingValue=S,B._pendingChange=!0,B._pendingDirty=!0,"change"===B.updateOn&&br(B,I)})}(B,I),function(B,I){const S=(le,Xe)=>{I.valueAccessor.writeValue(le),Xe&&I.viewToModelUpdate(le)};B.registerOnChange(S),I._registerOnDestroy(()=>{B._unregisterOnChange(S)})}(B,I),function(B,I){I.valueAccessor.registerOnTouched(()=>{B._pendingTouched=!0,"blur"===B.updateOn&&B._pendingChange&&br(B,I),"submit"!==B.updateOn&&B.markAsTouched()})}(B,I),function(B,I){if(I.valueAccessor.setDisabledState){const S=le=>{I.valueAccessor.setDisabledState(le)};B.registerOnDisabledChange(S),I._registerOnDestroy(()=>{B._unregisterOnDisabledChange(S)})}}(B,I)}function ci(B,I){B.forEach(S=>{S.registerOnValidatorChange&&S.registerOnValidatorChange(I)})}function br(B,I){B._pendingDirty&&B.markAsDirty(),B.setValue(B._pendingValue,{emitModelToViewChange:!1}),I.viewToModelUpdate(B._pendingValue),B._pendingChange=!1}function De(B,I){const S=B.indexOf(I);S>-1&&B.splice(S,1)}const vt="VALID",Ct="INVALID",lt="PENDING",Dt="DISABLED";function Zt(B){return(Yt(B)?B.validators:B)||null}function un(B){return Array.isArray(B)?Kt(B):B||null}function On(B,I){return(Yt(I)?I.asyncValidators:B)||null}function at(B){return Array.isArray(B)?Ft(B):B||null}function Yt(B){return null!=B&&!Array.isArray(B)&&"object"==typeof B}class ii{constructor(I,S){this._hasOwnPendingAsyncValidator=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._rawValidators=I,this._rawAsyncValidators=S,this._composedValidatorFn=un(this._rawValidators),this._composedAsyncValidatorFn=at(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn}set validator(I){this._rawValidators=this._composedValidatorFn=I}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(I){this._rawAsyncValidators=this._composedAsyncValidatorFn=I}get parent(){return this._parent}get valid(){return this.status===vt}get invalid(){return this.status===Ct}get pending(){return this.status==lt}get disabled(){return this.status===Dt}get enabled(){return this.status!==Dt}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(I){this._rawValidators=I,this._composedValidatorFn=un(I)}setAsyncValidators(I){this._rawAsyncValidators=I,this._composedAsyncValidatorFn=at(I)}addValidators(I){this.setValidators(Xt(I,this._rawValidators))}addAsyncValidators(I){this.setAsyncValidators(Xt(I,this._rawAsyncValidators))}removeValidators(I){this.setValidators(cn(I,this._rawValidators))}removeAsyncValidators(I){this.setAsyncValidators(cn(I,this._rawAsyncValidators))}hasValidator(I){return yt(this._rawValidators,I)}hasAsyncValidator(I){return yt(this._rawAsyncValidators,I)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(I={}){this.touched=!0,this._parent&&!I.onlySelf&&this._parent.markAsTouched(I)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(I=>I.markAllAsTouched())}markAsUntouched(I={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(S=>{S.markAsUntouched({onlySelf:!0})}),this._parent&&!I.onlySelf&&this._parent._updateTouched(I)}markAsDirty(I={}){this.pristine=!1,this._parent&&!I.onlySelf&&this._parent.markAsDirty(I)}markAsPristine(I={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(S=>{S.markAsPristine({onlySelf:!0})}),this._parent&&!I.onlySelf&&this._parent._updatePristine(I)}markAsPending(I={}){this.status=lt,!1!==I.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!I.onlySelf&&this._parent.markAsPending(I)}disable(I={}){const S=this._parentMarkedDirty(I.onlySelf);this.status=Dt,this.errors=null,this._forEachChild(le=>{le.disable({...I,onlySelf:!0})}),this._updateValue(),!1!==I.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...I,skipPristineCheck:S}),this._onDisabledChange.forEach(le=>le(!0))}enable(I={}){const S=this._parentMarkedDirty(I.onlySelf);this.status=vt,this._forEachChild(le=>{le.enable({...I,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:I.emitEvent}),this._updateAncestors({...I,skipPristineCheck:S}),this._onDisabledChange.forEach(le=>le(!1))}_updateAncestors(I){this._parent&&!I.onlySelf&&(this._parent.updateValueAndValidity(I),I.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(I){this._parent=I}updateValueAndValidity(I={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===vt||this.status===lt)&&this._runAsyncValidator(I.emitEvent)),!1!==I.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!I.onlySelf&&this._parent.updateValueAndValidity(I)}_updateTreeValidity(I={emitEvent:!0}){this._forEachChild(S=>S._updateTreeValidity(I)),this.updateValueAndValidity({onlySelf:!0,emitEvent:I.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?Dt:vt}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(I){if(this.asyncValidator){this.status=lt,this._hasOwnPendingAsyncValidator=!0;const S=St(this.asyncValidator(this));this._asyncValidationSubscription=S.subscribe(le=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(le,{emitEvent:I})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(I,S={}){this.errors=I,this._updateControlsErrors(!1!==S.emitEvent)}get(I){return function(B,I,S){if(null==I||(Array.isArray(I)||(I=I.split(".")),Array.isArray(I)&&0===I.length))return null;let le=B;return I.forEach(Xe=>{le=le instanceof ei?le.controls.hasOwnProperty(Xe)?le.controls[Xe]:null:le instanceof yi&&le.at(Xe)||null}),le}(this,I)}getError(I,S){const le=S?this.get(S):this;return le&&le.errors?le.errors[I]:null}hasError(I,S){return!!this.getError(I,S)}get root(){let I=this;for(;I._parent;)I=I._parent;return I}_updateControlsErrors(I){this.status=this._calculateStatus(),I&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(I)}_initObservables(){this.valueChanges=new x.vpe,this.statusChanges=new x.vpe}_calculateStatus(){return this._allControlsDisabled()?Dt:this.errors?Ct:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(lt)?lt:this._anyControlsHaveStatus(Ct)?Ct:vt}_anyControlsHaveStatus(I){return this._anyControls(S=>S.status===I)}_anyControlsDirty(){return this._anyControls(I=>I.dirty)}_anyControlsTouched(){return this._anyControls(I=>I.touched)}_updatePristine(I={}){this.pristine=!this._anyControlsDirty(),this._parent&&!I.onlySelf&&this._parent._updatePristine(I)}_updateTouched(I={}){this.touched=this._anyControlsTouched(),this._parent&&!I.onlySelf&&this._parent._updateTouched(I)}_isBoxedValue(I){return"object"==typeof I&&null!==I&&2===Object.keys(I).length&&"value"in I&&"disabled"in I}_registerOnCollectionChange(I){this._onCollectionChange=I}_setUpdateStrategy(I){Yt(I)&&null!=I.updateOn&&(this._updateOn=I.updateOn)}_parentMarkedDirty(I){return!I&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}}class Qn extends ii{constructor(I=null,S,le){super(Zt(S),On(le,S)),this._onChange=[],this._applyFormState(I),this._setUpdateStrategy(S),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}setValue(I,S={}){this.value=this._pendingValue=I,this._onChange.length&&!1!==S.emitModelToViewChange&&this._onChange.forEach(le=>le(this.value,!1!==S.emitViewToModelChange)),this.updateValueAndValidity(S)}patchValue(I,S={}){this.setValue(I,S)}reset(I=null,S={}){this._applyFormState(I),this.markAsPristine(S),this.markAsUntouched(S),this.setValue(this.value,S),this._pendingChange=!1}_updateValue(){}_anyControls(I){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(I){this._onChange.push(I)}_unregisterOnChange(I){De(this._onChange,I)}registerOnDisabledChange(I){this._onDisabledChange.push(I)}_unregisterOnDisabledChange(I){De(this._onDisabledChange,I)}_forEachChild(I){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(I){this._isBoxedValue(I)?(this.value=this._pendingValue=I.value,I.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=I}}class ei extends ii{constructor(I,S,le){super(Zt(S),On(le,S)),this.controls=I,this._initObservables(),this._setUpdateStrategy(S),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}registerControl(I,S){return this.controls[I]?this.controls[I]:(this.controls[I]=S,S.setParent(this),S._registerOnCollectionChange(this._onCollectionChange),S)}addControl(I,S,le={}){this.registerControl(I,S),this.updateValueAndValidity({emitEvent:le.emitEvent}),this._onCollectionChange()}removeControl(I,S={}){this.controls[I]&&this.controls[I]._registerOnCollectionChange(()=>{}),delete this.controls[I],this.updateValueAndValidity({emitEvent:S.emitEvent}),this._onCollectionChange()}setControl(I,S,le={}){this.controls[I]&&this.controls[I]._registerOnCollectionChange(()=>{}),delete this.controls[I],S&&this.registerControl(I,S),this.updateValueAndValidity({emitEvent:le.emitEvent}),this._onCollectionChange()}contains(I){return this.controls.hasOwnProperty(I)&&this.controls[I].enabled}setValue(I,S={}){this._checkAllValuesPresent(I),Object.keys(I).forEach(le=>{this._throwIfControlMissing(le),this.controls[le].setValue(I[le],{onlySelf:!0,emitEvent:S.emitEvent})}),this.updateValueAndValidity(S)}patchValue(I,S={}){null!=I&&(Object.keys(I).forEach(le=>{this.controls[le]&&this.controls[le].patchValue(I[le],{onlySelf:!0,emitEvent:S.emitEvent})}),this.updateValueAndValidity(S))}reset(I={},S={}){this._forEachChild((le,Xe)=>{le.reset(I[Xe],{onlySelf:!0,emitEvent:S.emitEvent})}),this._updatePristine(S),this._updateTouched(S),this.updateValueAndValidity(S)}getRawValue(){return this._reduceChildren({},(I,S,le)=>(I[le]=S instanceof Qn?S.value:S.getRawValue(),I))}_syncPendingControls(){let I=this._reduceChildren(!1,(S,le)=>!!le._syncPendingControls()||S);return I&&this.updateValueAndValidity({onlySelf:!0}),I}_throwIfControlMissing(I){if(!Object.keys(this.controls).length)throw new Error("\n        There are no form controls registered with this group yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.controls[I])throw new Error(`Cannot find form control with name: ${I}.`)}_forEachChild(I){Object.keys(this.controls).forEach(S=>{const le=this.controls[S];le&&I(le,S)})}_setUpControls(){this._forEachChild(I=>{I.setParent(this),I._registerOnCollectionChange(this._onCollectionChange)})}_updateValue(){this.value=this._reduceValue()}_anyControls(I){for(const S of Object.keys(this.controls)){const le=this.controls[S];if(this.contains(S)&&I(le))return!0}return!1}_reduceValue(){return this._reduceChildren({},(I,S,le)=>((S.enabled||this.disabled)&&(I[le]=S.value),I))}_reduceChildren(I,S){let le=I;return this._forEachChild((Xe,Jt)=>{le=S(le,Xe,Jt)}),le}_allControlsDisabled(){for(const I of Object.keys(this.controls))if(this.controls[I].enabled)return!1;return Object.keys(this.controls).length>0||this.disabled}_checkAllValuesPresent(I){this._forEachChild((S,le)=>{if(void 0===I[le])throw new Error(`Must supply a value for form control with name: '${le}'.`)})}}class yi extends ii{constructor(I,S,le){super(Zt(S),On(le,S)),this.controls=I,this._initObservables(),this._setUpdateStrategy(S),this._setUpControls(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator})}at(I){return this.controls[I]}push(I,S={}){this.controls.push(I),this._registerControl(I),this.updateValueAndValidity({emitEvent:S.emitEvent}),this._onCollectionChange()}insert(I,S,le={}){this.controls.splice(I,0,S),this._registerControl(S),this.updateValueAndValidity({emitEvent:le.emitEvent})}removeAt(I,S={}){this.controls[I]&&this.controls[I]._registerOnCollectionChange(()=>{}),this.controls.splice(I,1),this.updateValueAndValidity({emitEvent:S.emitEvent})}setControl(I,S,le={}){this.controls[I]&&this.controls[I]._registerOnCollectionChange(()=>{}),this.controls.splice(I,1),S&&(this.controls.splice(I,0,S),this._registerControl(S)),this.updateValueAndValidity({emitEvent:le.emitEvent}),this._onCollectionChange()}get length(){return this.controls.length}setValue(I,S={}){this._checkAllValuesPresent(I),I.forEach((le,Xe)=>{this._throwIfControlMissing(Xe),this.at(Xe).setValue(le,{onlySelf:!0,emitEvent:S.emitEvent})}),this.updateValueAndValidity(S)}patchValue(I,S={}){null!=I&&(I.forEach((le,Xe)=>{this.at(Xe)&&this.at(Xe).patchValue(le,{onlySelf:!0,emitEvent:S.emitEvent})}),this.updateValueAndValidity(S))}reset(I=[],S={}){this._forEachChild((le,Xe)=>{le.reset(I[Xe],{onlySelf:!0,emitEvent:S.emitEvent})}),this._updatePristine(S),this._updateTouched(S),this.updateValueAndValidity(S)}getRawValue(){return this.controls.map(I=>I instanceof Qn?I.value:I.getRawValue())}clear(I={}){this.controls.length<1||(this._forEachChild(S=>S._registerOnCollectionChange(()=>{})),this.controls.splice(0),this.updateValueAndValidity({emitEvent:I.emitEvent}))}_syncPendingControls(){let I=this.controls.reduce((S,le)=>!!le._syncPendingControls()||S,!1);return I&&this.updateValueAndValidity({onlySelf:!0}),I}_throwIfControlMissing(I){if(!this.controls.length)throw new Error("\n        There are no form controls registered with this array yet. If you're using ngModel,\n        you may want to check next tick (e.g. use setTimeout).\n      ");if(!this.at(I))throw new Error(`Cannot find form control at index ${I}`)}_forEachChild(I){this.controls.forEach((S,le)=>{I(S,le)})}_updateValue(){this.value=this.controls.filter(I=>I.enabled||this.disabled).map(I=>I.value)}_anyControls(I){return this.controls.some(S=>S.enabled&&I(S))}_setUpControls(){this._forEachChild(I=>this._registerControl(I))}_checkAllValuesPresent(I){this._forEachChild((S,le)=>{if(void 0===I[le])throw new Error(`Must supply a value for form control at index: ${le}.`)})}_allControlsDisabled(){for(const I of this.controls)if(I.enabled)return!1;return this.controls.length>0||this.disabled}_registerControl(I){I.setParent(this),I._registerOnCollectionChange(this._onCollectionChange)}}const to={provide:mi,useExisting:(0,x.Gpc)(()=>jn)},Or=(()=>Promise.resolve(null))();let jn=(()=>{class B extends mi{constructor(S,le,Xe,Jt){super(),this.control=new Qn,this._registered=!1,this.update=new x.vpe,this._parent=S,this._setValidators(le),this._setAsyncValidators(Xe),this.valueAccessor=function(B,I){if(!I)return null;let S,le,Xe;return Array.isArray(I),I.forEach(Jt=>{Jt.constructor===me?S=Jt:function(B){return Object.getPrototypeOf(B.constructor)===f}(Jt)?le=Jt:Xe=Jt}),Xe||le||S||null}(0,Jt)}ngOnChanges(S){this._checkForErrors(),this._registered||this._setUpControl(),"isDisabled"in S&&this._updateDisabled(S),function(B,I){if(!B.hasOwnProperty("model"))return!1;const S=B.model;return!!S.isFirstChange()||!Object.is(I,S.currentValue)}(S,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._parent?function(B,I){return[...I.path,B]}(this.name,this._parent):[this.name]}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(S){this.viewModel=S,this.update.emit(S)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){on(this.control,this),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(S){Or.then(()=>{this.control.setValue(S,{emitViewToModelChange:!1})})}_updateDisabled(S){const le=S.isDisabled.currentValue,Xe=""===le||le&&"false"!==le;Or.then(()=>{Xe&&!this.control.disabled?this.control.disable():!Xe&&this.control.disabled&&this.control.enable()})}}return B.\u0275fac=function(S){return new(S||B)(x.Y36(An,9),x.Y36(ze,10),x.Y36(Ne,10),x.Y36(H,10))},B.\u0275dir=x.lG2({type:B,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[x._Bn([to]),x.qOj,x.TTD]}),B})();const Fr={provide:H,useExisting:(0,x.Gpc)(()=>Ir),multi:!0};let Ir=(()=>{class B extends f{writeValue(S){this.setProperty("value",S??"")}registerOnChange(S){this.onChange=le=>{S(""==le?null:parseFloat(le))}}}return B.\u0275fac=function(){let I;return function(le){return(I||(I=x.n5z(B)))(le||B)}}(),B.\u0275dir=x.lG2({type:B,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(S,le){1&S&&x.NdJ("input",function(Jt){return le.onChange(Jt.target.value)})("blur",function(){return le.onTouched()})},features:[x._Bn([Fr]),x.qOj]}),B})(),Ee=(()=>{class B{}return B.\u0275fac=function(S){return new(S||B)},B.\u0275mod=x.oAB({type:B}),B.\u0275inj=x.cJS({}),B})();function cs(B){return"number"==typeof B?B:parseFloat(B)}let Lo=(()=>{class B{constructor(){this._validator=bt}handleChanges(S){if(this.inputName in S){const le=this.normalizeInput(S[this.inputName].currentValue);this._validator=this.enabled()?this.createValidator(le):bt,this._onChange&&this._onChange()}}validate(S){return this._validator(S)}registerOnValidatorChange(S){this._onChange=S}enabled(){return null!=this[this.inputName]}}return B.\u0275fac=function(S){return new(S||B)},B.\u0275dir=x.lG2({type:B}),B})();const js={provide:ze,useExisting:(0,x.Gpc)(()=>ko),multi:!0};let ko=(()=>{class B extends Lo{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=S=>cs(S),this.createValidator=S=>function(B){return I=>{if(ve(I.value)||ve(B))return null;const S=parseFloat(I.value);return!isNaN(S)&&S>B?{max:{max:B,actual:I.value}}:null}}(S)}ngOnChanges(S){this.handleChanges(S)}}return B.\u0275fac=function(){let I;return function(le){return(I||(I=x.n5z(B)))(le||B)}}(),B.\u0275dir=x.lG2({type:B,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(S,le){2&S&&x.uIk("max",le.enabled()?le.max:null)},inputs:{max:"max"},features:[x._Bn([js]),x.qOj,x.TTD]}),B})();const ma={provide:ze,useExisting:(0,x.Gpc)(()=>xs),multi:!0};let xs=(()=>{class B extends Lo{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=S=>cs(S),this.createValidator=S=>function(B){return I=>{if(ve(I.value)||ve(B))return null;const S=parseFloat(I.value);return!isNaN(S)&&S<B?{min:{min:B,actual:I.value}}:null}}(S)}ngOnChanges(S){this.handleChanges(S)}}return B.\u0275fac=function(){let I;return function(le){return(I||(I=x.n5z(B)))(le||B)}}(),B.\u0275dir=x.lG2({type:B,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(S,le){2&S&&x.uIk("min",le.enabled()?le.min:null)},inputs:{min:"min"},features:[x._Bn([ma]),x.qOj,x.TTD]}),B})(),bs=(()=>{class B{}return B.\u0275fac=function(S){return new(S||B)},B.\u0275mod=x.oAB({type:B}),B.\u0275inj=x.cJS({imports:[[Ee]]}),B})(),Yo=(()=>{class B{}return B.\u0275fac=function(S){return new(S||B)},B.\u0275mod=x.oAB({type:B}),B.\u0275inj=x.cJS({imports:[bs]}),B})()},5899:(yn,je,N)=>{"use strict";N.d(je,{gz:()=>io,y6:()=>Ri,OD:()=>We,eC:()=>re,wN:()=>La,F0:()=>mo,rH:()=>ca,Bz:()=>Hl,Hx:()=>Or});var x=N(6019),d=N(865),Y=N(8151),l=N(5894),P=N(4168);class O extends P.L{notifyNext(F,L,X,de,Pe){this.destination.next(L)}notifyError(F,L){this.destination.error(F)}notifyComplete(F){this.destination.complete()}}class f extends P.L{constructor(F,L,X){super(),this.parent=F,this.outerValue=L,this.outerIndex=X,this.index=0}_next(F){this.parent.notifyNext(this.outerValue,F,this.outerIndex,this.index++,this)}_error(F){this.parent.notifyError(F,this),this.unsubscribe()}_complete(){this.parent.notifyComplete(this),this.unsubscribe()}}var H=N(4651),te=N(5548);function K(q,F,L,X,de=new f(q,L,X)){if(!de.closed)return F instanceof te.y?F.subscribe(de):(0,H.s)(F)(de)}var G=N(5433);const ne={};class me{constructor(F){this.resultSelector=F}call(F,L){return L.subscribe(new ve(F,this.resultSelector))}}class ve extends O{constructor(F,L){super(F),this.resultSelector=L,this.active=0,this.values=[],this.observables=[]}_next(F){this.values.push(ne),this.observables.push(F)}_complete(){const F=this.observables,L=F.length;if(0===L)this.destination.complete();else{this.active=L,this.toRespond=L;for(let X=0;X<L;X++)this.add(K(this,F[X],void 0,X))}}notifyComplete(F){0==(this.active-=1)&&this.destination.complete()}notifyNext(F,L,X){const de=this.values,it=this.toRespond?de[X]===ne?--this.toRespond:this.toRespond:0;de[X]=L,0===it&&(this.resultSelector?this._tryResultSelector(de):this.destination.next(de.slice()))}_tryResultSelector(F){let L;try{L=this.resultSelector.apply(this,F)}catch(X){return void this.destination.error(X)}this.destination.next(L)}}const ze=(()=>{function q(){return Error.call(this),this.message="no elements in sequence",this.name="EmptyError",this}return q.prototype=Object.create(Error.prototype),q})();var Ne=N(1915),Ae=N(2411),Te=N(4099),He=N(3596),Ge=N(5476),Fe=N(172),E=N(5783),Qe=N(3405);function ct(q,F){let L=!1;return arguments.length>=2&&(L=!0),function(de){return de.lift(new gt(q,F,L))}}class gt{constructor(F,L,X=!1){this.accumulator=F,this.seed=L,this.hasSeed=X}call(F,L){return L.subscribe(new bt(F,this.accumulator,this.seed,this.hasSeed))}}class bt extends P.L{constructor(F,L,X,de){super(F),this.accumulator=L,this._seed=X,this.hasSeed=de,this.index=0}get seed(){return this._seed}set seed(F){this.hasSeed=!0,this._seed=F}_next(F){if(this.hasSeed)return this._tryNext(F);this.seed=F,this.destination.next(F)}_tryNext(F){const L=this.index++;let X;try{X=this.accumulator(this.seed,F,L)}catch(de){this.destination.error(de)}this.seed=X,this.destination.next(X)}}var ut=N(8345);function St(q){return function(L){const X=new Vt(q),de=L.lift(X);return X.caught=de}}class Vt{constructor(F){this.selector=F}call(F,L){return L.subscribe(new bn(F,this.selector,this.caught))}}class bn extends ut.Ds{constructor(F,L,X){super(F),this.selector=L,this.caught=X}error(F){if(!this.isStopped){let L;try{L=this.selector(F,this.caught)}catch(Pe){return void super.error(Pe)}this._unsubscribeAndRecycle();const X=new ut.IY(this);this.add(X);const de=(0,ut.ft)(L,X);de!==X&&this.add(de)}}}var Nt=N(8735),Bt=N(523);function Mt(q){return function(L){return 0===q?(0,Fe.c)():L.lift(new Kt(q))}}class Kt{constructor(F){if(this.total=F,this.total<0)throw new Bt.W}call(F,L){return L.subscribe(new Ot(F,this.total))}}class Ot extends P.L{constructor(F,L){super(F),this.total=L,this.ring=new Array,this.count=0}_next(F){const L=this.ring,X=this.total,de=this.count++;L.length<X?L.push(F):L[de%X]=F}_complete(){const F=this.destination;let L=this.count;if(L>0){const X=this.count>=this.total?this.total:this.count,de=this.ring;for(let Pe=0;Pe<X;Pe++){const it=L++%X;F.next(de[it])}}F.complete()}}function Ft(q=tn){return F=>F.lift(new ln(q))}class ln{constructor(F){this.errorFactory=F}call(F,L){return L.subscribe(new nn(F,this.errorFactory))}}class nn extends P.L{constructor(F,L){super(F),this.errorFactory=L,this.hasValue=!1}_next(F){this.hasValue=!0,this.destination.next(F)}_complete(){if(this.hasValue)return this.destination.complete();{let F;try{F=this.errorFactory()}catch(L){F=L}this.destination.error(F)}}}function tn(){return new ze}function en(q=null){return F=>F.lift(new yt(q))}class yt{constructor(F){this.defaultValue=F}call(F,L){return L.subscribe(new Xt(F,this.defaultValue))}}class Xt extends P.L{constructor(F,L){super(F),this.defaultValue=L,this.isEmpty=!0}_next(F){this.isEmpty=!1,this.destination.next(F)}_complete(){this.isEmpty&&this.destination.next(this.defaultValue),this.destination.complete()}}var cn=N(7255),An=N(6636);function mi(q,F){const L=arguments.length>=2;return X=>X.pipe(q?(0,Nt.h)((de,Pe)=>q(de,Pe,X)):cn.y,(0,An.q)(1),L?en(F):Ft(()=>new ze))}function si(){}var Ki=N(6783);function xi(q,F,L){return function(de){return de.lift(new Wi(q,F,L))}}class Wi{constructor(F,L,X){this.nextOrObserver=F,this.error=L,this.complete=X}call(F,L){return L.subscribe(new Vi(F,this.nextOrObserver,this.error,this.complete))}}class Vi extends P.L{constructor(F,L,X,de){super(F),this._tapNext=si,this._tapError=si,this._tapComplete=si,this._tapError=X||si,this._tapComplete=de||si,(0,Ki.m)(L)?(this._context=this,this._tapNext=L):L&&(this._context=L,this._tapNext=L.next||si,this._tapError=L.error||si,this._tapComplete=L.complete||si)}_next(F){try{this._tapNext.call(this._context,F)}catch(L){return void this.destination.error(L)}this.destination.next(F)}_error(F){try{this._tapError.call(this._context,F)}catch(L){return void this.destination.error(L)}this.destination.error(F)}_complete(){try{this._tapComplete.call(this._context)}catch(F){return void this.destination.error(F)}return this.destination.complete()}}var _i=N(1346);class xn{constructor(F){this.callback=F}call(F,L){return L.subscribe(new rn(F,this.callback))}}class rn extends P.L{constructor(F,L){super(F),this.add(new _i.w(L))}}var ot=N(8053),ft=N(9204),pn=N(6700),_e=N(4421),Ye=N(5234),j=N(2225);class ye{constructor(F,L){this.id=F,this.url=L}}class We extends ye{constructor(F,L,X="imperative",de=null){super(F,L),this.navigationTrigger=X,this.restoredState=de}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Tt extends ye{constructor(F,L,X){super(F,L),this.urlAfterRedirects=X}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class on extends ye{constructor(F,L,X){super(F,L),this.reason=X}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class qn extends ye{constructor(F,L,X){super(F,L),this.error=X}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class ci extends ye{constructor(F,L,X,de){super(F,L),this.urlAfterRedirects=X,this.state=de}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class ai extends ye{constructor(F,L,X,de){super(F,L),this.urlAfterRedirects=X,this.state=de}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Un extends ye{constructor(F,L,X,de,Pe){super(F,L),this.urlAfterRedirects=X,this.state=de,this.shouldActivate=Pe}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Fi extends ye{constructor(F,L,X,de){super(F,L),this.urlAfterRedirects=X,this.state=de}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ti extends ye{constructor(F,L,X,de){super(F,L),this.urlAfterRedirects=X,this.state=de}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Yi{constructor(F){this.route=F}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class br{constructor(F){this.route=F}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Ei{constructor(F){this.snapshot=F}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wr{constructor(F){this.snapshot=F}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class mr{constructor(F){this.snapshot=F}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ji{constructor(F){this.snapshot=F}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class hi{constructor(F,L,X){this.routerEvent=F,this.position=L,this.anchor=X}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const re="primary";class ie{constructor(F){this.params=F||{}}has(F){return Object.prototype.hasOwnProperty.call(this.params,F)}get(F){if(this.has(F)){const L=this.params[F];return Array.isArray(L)?L[0]:L}return null}getAll(F){if(this.has(F)){const L=this.params[F];return Array.isArray(L)?L:[L]}return[]}get keys(){return Object.keys(this.params)}}function V(q){return new ie(q)}const pe="ngNavigationCancelingError";function De(q){const F=Error("NavigationCancelingError: "+q);return F[pe]=!0,F}function vt(q,F,L){const X=L.path.split("/");if(X.length>q.length||"full"===L.pathMatch&&(F.hasChildren()||X.length<q.length))return null;const de={};for(let Pe=0;Pe<X.length;Pe++){const it=X[Pe],xt=q[Pe];if(it.startsWith(":"))de[it.substring(1)]=xt;else if(it!==xt.path)return null}return{consumed:q.slice(0,X.length),posParams:de}}function lt(q,F){const L=q?Object.keys(q):void 0,X=F?Object.keys(F):void 0;if(!L||!X||L.length!=X.length)return!1;let de;for(let Pe=0;Pe<L.length;Pe++)if(de=L[Pe],!Dt(q[de],F[de]))return!1;return!0}function Dt(q,F){if(Array.isArray(q)&&Array.isArray(F)){if(q.length!==F.length)return!1;const L=[...q].sort(),X=[...F].sort();return L.every((de,Pe)=>X[Pe]===de)}return q===F}function Ht(q){return Array.prototype.concat.apply([],q)}function Zt(q){return q.length>0?q[q.length-1]:null}function On(q,F){for(const L in q)q.hasOwnProperty(L)&&F(q[L],L)}function at(q){return(0,d.CqO)(q)?q:(0,d.QGY)(q)?(0,Ne.D)(Promise.resolve(q)):(0,Ae.of)(q)}const ii={exact:function Yn(q,F,L){if(!Ii(q.segments,F.segments)||!Zn(q.segments,F.segments,L)||q.numberOfChildren!==F.numberOfChildren)return!1;for(const X in F.children)if(!q.children[X]||!Yn(q.children[X],F.children[X],L))return!1;return!0},subset:En},Qn={exact:function(q,F){return lt(q,F)},subset:function(q,F){return Object.keys(F).length<=Object.keys(q).length&&Object.keys(F).every(L=>Dt(q[L],F[L]))},ignored:()=>!0};function ei(q,F,L){return ii[L.paths](q.root,F.root,L.matrixParams)&&Qn[L.queryParams](q.queryParams,F.queryParams)&&!("exact"===L.fragment&&q.fragment!==F.fragment)}function En(q,F,L){return zt(q,F,F.segments,L)}function zt(q,F,L,X){if(q.segments.length>L.length){const de=q.segments.slice(0,L.length);return!(!Ii(de,L)||F.hasChildren()||!Zn(de,L,X))}if(q.segments.length===L.length){if(!Ii(q.segments,L)||!Zn(q.segments,L,X))return!1;for(const de in F.children)if(!q.children[de]||!En(q.children[de],F.children[de],X))return!1;return!0}{const de=L.slice(0,q.segments.length),Pe=L.slice(q.segments.length);return!!(Ii(q.segments,de)&&Zn(q.segments,de,X)&&q.children[re])&&zt(q.children[re],F,Pe,X)}}function Zn(q,F,L){return F.every((X,de)=>Qn[L](q[de].parameters,X.parameters))}class ti{constructor(F,L,X){this.root=F,this.queryParams=L,this.fragment=X}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=V(this.queryParams)),this._queryParamMap}toString(){return $i.serialize(this)}}class li{constructor(F,L){this.segments=F,this.children=L,this.parent=null,On(L,(X,de)=>X.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Fr(this)}}class Ci{constructor(F,L){this.path=F,this.parameters=L}get parameterMap(){return this._parameterMap||(this._parameterMap=V(this.parameters)),this._parameterMap}toString(){return $t(this)}}function Ii(q,F){return q.length===F.length&&q.every((L,X)=>L.path===F[X].path)}class Or{}class jn{parse(F){const L=new vi(F);return new ti(L.parseRootSegment(),L.parseQueryParams(),L.parseFragment())}serialize(F){const L=`/${Ir(F.root,!0)}`,X=function(q){const F=Object.keys(q).map(L=>{const X=q[L];return Array.isArray(X)?X.map(de=>`${_r(L)}=${_r(de)}`).join("&"):`${_r(L)}=${_r(X)}`}).filter(L=>!!L);return F.length?`?${F.join("&")}`:""}(F.queryParams);var q;return`${L}${X}${"string"==typeof F.fragment?`#${q=F.fragment,encodeURI(q)}`:""}`}}const $i=new jn;function Fr(q){return q.segments.map(F=>$t(F)).join("/")}function Ir(q,F){if(!q.hasChildren())return Fr(q);if(F){const L=q.children[re]?Ir(q.children[re],!1):"",X=[];return On(q.children,(de,Pe)=>{Pe!==re&&X.push(`${Pe}:${Ir(de,!1)}`)}),X.length>0?`${L}(${X.join("//")})`:L}{const L=function(q,F){let L=[];return On(q.children,(X,de)=>{de===re&&(L=L.concat(F(X,de)))}),On(q.children,(X,de)=>{de!==re&&(L=L.concat(F(X,de)))}),L}(q,(X,de)=>de===re?[Ir(q.children[re],!1)]:[`${de}:${Ir(X,!1)}`]);return 1===Object.keys(q.children).length&&null!=q.children[re]?`${Fr(q)}/${L[0]}`:`${Fr(q)}/(${L.join("//")})`}}function Nr(q){return encodeURIComponent(q).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function _r(q){return Nr(q).replace(/%3B/gi,";")}function xe(q){return Nr(q).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function Le(q){return decodeURIComponent(q)}function Ke(q){return Le(q.replace(/\+/g,"%20"))}function $t(q){return`${xe(q.path)}${function(q){return Object.keys(q).map(F=>`;${xe(F)}=${xe(q[F])}`).join("")}(q.parameters)}`}const mn=/^[^\/()?;=#]+/;function hn(q){const F=q.match(mn);return F?F[0]:""}const fn=/^[^=?&#]+/,Fn=/^[^&#]+/;class vi{constructor(F){this.url=F,this.remaining=F}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new li([],{}):new li([],this.parseChildren())}parseQueryParams(){const F={};if(this.consumeOptional("?"))do{this.parseQueryParam(F)}while(this.consumeOptional("&"));return F}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const F=[];for(this.peekStartsWith("(")||F.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),F.push(this.parseSegment());let L={};this.peekStartsWith("/(")&&(this.capture("/"),L=this.parseParens(!0));let X={};return this.peekStartsWith("(")&&(X=this.parseParens(!1)),(F.length>0||Object.keys(L).length>0)&&(X[re]=new li(F,L)),X}parseSegment(){const F=hn(this.remaining);if(""===F&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(F),new Ci(Le(F),this.parseMatrixParams())}parseMatrixParams(){const F={};for(;this.consumeOptional(";");)this.parseParam(F);return F}parseParam(F){const L=hn(this.remaining);if(!L)return;this.capture(L);let X="";if(this.consumeOptional("=")){const de=hn(this.remaining);de&&(X=de,this.capture(X))}F[Le(L)]=Le(X)}parseQueryParam(F){const L=function(q){const F=q.match(fn);return F?F[0]:""}(this.remaining);if(!L)return;this.capture(L);let X="";if(this.consumeOptional("=")){const it=function(q){const F=q.match(Fn);return F?F[0]:""}(this.remaining);it&&(X=it,this.capture(X))}const de=Ke(L),Pe=Ke(X);if(F.hasOwnProperty(de)){let it=F[de];Array.isArray(it)||(it=[it],F[de]=it),it.push(Pe)}else F[de]=Pe}parseParens(F){const L={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const X=hn(this.remaining),de=this.remaining[X.length];if("/"!==de&&")"!==de&&";"!==de)throw new Error(`Cannot parse url '${this.url}'`);let Pe;X.indexOf(":")>-1?(Pe=X.substr(0,X.indexOf(":")),this.capture(Pe),this.capture(":")):F&&(Pe=re);const it=this.parseChildren();L[Pe]=1===Object.keys(it).length?it[re]:new li([],it),this.consumeOptional("//")}return L}peekStartsWith(F){return this.remaining.startsWith(F)}consumeOptional(F){return!!this.peekStartsWith(F)&&(this.remaining=this.remaining.substring(F.length),!0)}capture(F){if(!this.consumeOptional(F))throw new Error(`Expected "${F}".`)}}class ji{constructor(F){this._root=F}get root(){return this._root.value}parent(F){const L=this.pathFromRoot(F);return L.length>1?L[L.length-2]:null}children(F){const L=Sr(F,this._root);return L?L.children.map(X=>X.value):[]}firstChild(F){const L=Sr(F,this._root);return L&&L.children.length>0?L.children[0].value:null}siblings(F){const L=yr(F,this._root);return L.length<2?[]:L[L.length-2].children.map(de=>de.value).filter(de=>de!==F)}pathFromRoot(F){return yr(F,this._root).map(L=>L.value)}}function Sr(q,F){if(q===F.value)return F;for(const L of F.children){const X=Sr(q,L);if(X)return X}return null}function yr(q,F){if(q===F.value)return[F];for(const L of F.children){const X=yr(q,L);if(X.length)return X.unshift(F),X}return[]}class qr{constructor(F,L){this.value=F,this.children=L}toString(){return`TreeNode(${this.value})`}}function ur(q){const F={};return q&&q.children.forEach(L=>F[L.value.outlet]=L),F}class vo extends ji{constructor(F,L){super(F),this.snapshot=L,Rs(this,F)}toString(){return this.snapshot.toString()}}function ss(q,F){const L=function(q,F){const it=new as([],{},{},"",{},re,F,null,q.root,-1,{});return new vs("",new qr(it,[]))}(q,F),X=new Te.X([new Ci("",{})]),de=new Te.X({}),Pe=new Te.X({}),it=new Te.X({}),xt=new Te.X(""),_n=new io(X,de,it,xt,Pe,re,F,L.root);return _n.snapshot=L.root,new vo(new qr(_n,[]),L)}class io{constructor(F,L,X,de,Pe,it,xt,_n){this.url=F,this.params=L,this.queryParams=X,this.fragment=de,this.data=Pe,this.outlet=it,this.component=xt,this._futureSnapshot=_n}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ot.U)(F=>V(F)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ot.U)(F=>V(F)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function To(q,F="emptyOnly"){const L=q.pathFromRoot;let X=0;if("always"!==F)for(X=L.length-1;X>=1;){const de=L[X],Pe=L[X-1];if(de.routeConfig&&""===de.routeConfig.path)X--;else{if(Pe.component)break;X--}}return function(q){return q.reduce((F,L)=>({params:{...F.params,...L.params},data:{...F.data,...L.data},resolve:{...F.resolve,...L._resolvedData}}),{params:{},data:{},resolve:{}})}(L.slice(X))}class as{constructor(F,L,X,de,Pe,it,xt,_n,di,sr,Mi){this.url=F,this.params=L,this.queryParams=X,this.fragment=de,this.data=Pe,this.outlet=it,this.component=xt,this.routeConfig=_n,this._urlSegment=di,this._lastPathIndex=sr,this._resolve=Mi}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=V(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=V(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(X=>X.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class vs extends ji{constructor(F,L){super(L),this.url=F,Rs(this,L)}toString(){return ls(this._root)}}function Rs(q,F){F.value._routerState=q,F.children.forEach(L=>Rs(q,L))}function ls(q){const F=q.children.length>0?` { ${q.children.map(ls).join(", ")} } `:"";return`${q.value}${F}`}function cs(q){if(q.snapshot){const F=q.snapshot,L=q._futureSnapshot;q.snapshot=L,lt(F.queryParams,L.queryParams)||q.queryParams.next(L.queryParams),F.fragment!==L.fragment&&q.fragment.next(L.fragment),lt(F.params,L.params)||q.params.next(L.params),function(q,F){if(q.length!==F.length)return!1;for(let L=0;L<q.length;++L)if(!lt(q[L],F[L]))return!1;return!0}(F.url,L.url)||q.url.next(L.url),lt(F.data,L.data)||q.data.next(L.data)}else q.snapshot=q._futureSnapshot,q.data.next(q._futureSnapshot.data)}function Lo(q,F){const L=lt(q.params,F.params)&&function(q,F){return Ii(q,F)&&q.every((L,X)=>lt(L.parameters,F[X].parameters))}(q.url,F.url);return L&&!(!q.parent!=!F.parent)&&(!q.parent||Lo(q.parent,F.parent))}function ko(q,F,L){if(L&&q.shouldReuseRoute(F.value,L.value.snapshot)){const X=L.value;X._futureSnapshot=F.value;const de=function(q,F,L){return F.children.map(X=>{for(const de of L.children)if(q.shouldReuseRoute(X.value,de.value.snapshot))return ko(q,X,de);return ko(q,X)})}(q,F,L);return new qr(X,de)}{if(q.shouldAttach(F.value)){const Pe=q.retrieve(F.value);if(null!==Pe){const it=Pe.route;return it.value._futureSnapshot=F.value,it.children=F.children.map(xt=>ko(q,xt)),it}}const X=function(q){return new io(new Te.X(q.url),new Te.X(q.params),new Te.X(q.queryParams),new Te.X(q.fragment),new Te.X(q.data),q.outlet,q.component,q)}(F.value),de=F.children.map(Pe=>ko(q,Pe));return new qr(X,de)}}function Fo(q){return"object"==typeof q&&null!=q&&!q.outlets&&!q.segmentPath}function fo(q){return"object"==typeof q&&null!=q&&q.outlets}function Eo(q,F,L,X,de){let Pe={};return X&&On(X,(it,xt)=>{Pe[xt]=Array.isArray(it)?it.map(_n=>`${_n}`):`${it}`}),new ti(L.root===q?F:Ze(L.root,q,F),Pe,de)}function Ze(q,F,L){const X={};return On(q.children,(de,Pe)=>{X[Pe]=de===F?L:Ze(de,F,L)}),new li(q.segments,X)}class st{constructor(F,L,X){if(this.isAbsolute=F,this.numberOfDoubleDots=L,this.commands=X,F&&X.length>0&&Fo(X[0]))throw new Error("Root segment cannot have matrix parameters");const de=X.find(fo);if(de&&de!==Zt(X))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class rt{constructor(F,L,X){this.segmentGroup=F,this.processChildren=L,this.index=X}}function dr(q,F,L){if(q||(q=new li([],{})),0===q.segments.length&&q.hasChildren())return Cr(q,F,L);const X=function(q,F,L){let X=0,de=F;const Pe={match:!1,pathIndex:0,commandIndex:0};for(;de<q.segments.length;){if(X>=L.length)return Pe;const it=q.segments[de],xt=L[X];if(fo(xt))break;const _n=`${xt}`,di=X<L.length-1?L[X+1]:null;if(de>0&&void 0===_n)break;if(_n&&di&&"object"==typeof di&&void 0===di.outlets){if(!oa(_n,di,it))return Pe;X+=2}else{if(!oa(_n,{},it))return Pe;X++}de++}return{match:!0,pathIndex:de,commandIndex:X}}(q,F,L),de=L.slice(X.commandIndex);if(X.match&&X.pathIndex<q.segments.length){const Pe=new li(q.segments.slice(0,X.pathIndex),{});return Pe.children[re]=new li(q.segments.slice(X.pathIndex),q.children),Cr(Pe,0,de)}return X.match&&0===de.length?new li(q.segments,{}):X.match&&!q.hasChildren()?Io(q,F,L):X.match?Cr(q,0,de):Io(q,F,L)}function Cr(q,F,L){if(0===L.length)return new li(q.segments,{});{const X=function(q){return fo(q[0])?q[0].outlets:{[re]:q}}(L),de={};return On(X,(Pe,it)=>{"string"==typeof Pe&&(Pe=[Pe]),null!==Pe&&(de[it]=dr(q.children[it],F,Pe))}),On(q.children,(Pe,it)=>{void 0===X[it]&&(de[it]=Pe)}),new li(q.segments,de)}}function Io(q,F,L){const X=q.segments.slice(0,F);let de=0;for(;de<L.length;){const Pe=L[de];if(fo(Pe)){const _n=bs(Pe.outlets);return new li(X,_n)}if(0===de&&Fo(L[0])){X.push(new Ci(q.segments[F].path,Yo(L[0]))),de++;continue}const it=fo(Pe)?Pe.outlets[re]:`${Pe}`,xt=de<L.length-1?L[de+1]:null;it&&xt&&Fo(xt)?(X.push(new Ci(it,Yo(xt))),de+=2):(X.push(new Ci(it,{})),de++)}return new li(X,{})}function bs(q){const F={};return On(q,(L,X)=>{"string"==typeof L&&(L=[L]),null!==L&&(F[X]=Io(new li([],{}),0,L))}),F}function Yo(q){const F={};return On(q,(L,X)=>F[X]=`${L}`),F}function oa(q,F,L){return q==L.path&&lt(F,L.parameters)}class Os{constructor(F,L,X,de){this.routeReuseStrategy=F,this.futureState=L,this.currState=X,this.forwardEvent=de}activate(F){const L=this.futureState._root,X=this.currState?this.currState._root:null;this.deactivateChildRoutes(L,X,F),cs(this.futureState.root),this.activateChildRoutes(L,X,F)}deactivateChildRoutes(F,L,X){const de=ur(L);F.children.forEach(Pe=>{const it=Pe.value.outlet;this.deactivateRoutes(Pe,de[it],X),delete de[it]}),On(de,(Pe,it)=>{this.deactivateRouteAndItsChildren(Pe,X)})}deactivateRoutes(F,L,X){const de=F.value,Pe=L?L.value:null;if(de===Pe)if(de.component){const it=X.getContext(de.outlet);it&&this.deactivateChildRoutes(F,L,it.children)}else this.deactivateChildRoutes(F,L,X);else Pe&&this.deactivateRouteAndItsChildren(L,X)}deactivateRouteAndItsChildren(F,L){this.routeReuseStrategy.shouldDetach(F.value.snapshot)?this.detachAndStoreRouteSubtree(F,L):this.deactivateRouteAndOutlet(F,L)}detachAndStoreRouteSubtree(F,L){const X=L.getContext(F.value.outlet),de=X&&F.value.component?X.children:L,Pe=ur(F);for(const it of Object.keys(Pe))this.deactivateRouteAndItsChildren(Pe[it],de);if(X&&X.outlet){const it=X.outlet.detach(),xt=X.children.onOutletDeactivated();this.routeReuseStrategy.store(F.value.snapshot,{componentRef:it,route:F,contexts:xt})}}deactivateRouteAndOutlet(F,L){const X=L.getContext(F.value.outlet),de=X&&F.value.component?X.children:L,Pe=ur(F);for(const it of Object.keys(Pe))this.deactivateRouteAndItsChildren(Pe[it],de);X&&X.outlet&&(X.outlet.deactivate(),X.children.onOutletDeactivated(),X.attachRef=null,X.resolver=null,X.route=null)}activateChildRoutes(F,L,X){const de=ur(L);F.children.forEach(Pe=>{this.activateRoutes(Pe,de[Pe.value.outlet],X),this.forwardEvent(new Ji(Pe.value.snapshot))}),F.children.length&&this.forwardEvent(new wr(F.value.snapshot))}activateRoutes(F,L,X){const de=F.value,Pe=L?L.value:null;if(cs(de),de===Pe)if(de.component){const it=X.getOrCreateContext(de.outlet);this.activateChildRoutes(F,L,it.children)}else this.activateChildRoutes(F,L,X);else if(de.component){const it=X.getOrCreateContext(de.outlet);if(this.routeReuseStrategy.shouldAttach(de.snapshot)){const xt=this.routeReuseStrategy.retrieve(de.snapshot);this.routeReuseStrategy.store(de.snapshot,null),it.children.onOutletReAttached(xt.contexts),it.attachRef=xt.componentRef,it.route=xt.route.value,it.outlet&&it.outlet.attach(xt.componentRef,xt.route.value),cs(xt.route.value),this.activateChildRoutes(F,null,it.children)}else{const xt=function(q){for(let F=q.parent;F;F=F.parent){const L=F.routeConfig;if(L&&L._loadedConfig)return L._loadedConfig;if(L&&L.component)return null}return null}(de.snapshot),_n=xt?xt.module.componentFactoryResolver:null;it.attachRef=null,it.route=de,it.resolver=_n,it.outlet&&it.outlet.activateWith(de,_n),this.activateChildRoutes(F,null,it.children)}}else this.activateChildRoutes(F,null,X)}}class B{constructor(F,L){this.routes=F,this.module=L}}function I(q){return"function"==typeof q}function le(q){return q instanceof ti}const Xi=Symbol("INITIAL_VALUE");function ar(){return(0,ft.w)(q=>function(...q){let F,L;return(0,Y.K)(q[q.length-1])&&(L=q.pop()),"function"==typeof q[q.length-1]&&(F=q.pop()),1===q.length&&(0,l.k)(q[0])&&(q=q[0]),(0,G.n)(q,L).lift(new me(F))}(q.map(F=>F.pipe((0,An.q)(1),function(...q){const F=q[q.length-1];return(0,Y.K)(F)?(q.pop(),L=>(0,He.z)(q,L,F)):L=>(0,He.z)(q,L)}(Xi)))).pipe(ct((F,L)=>{let X=!1;return L.reduce((de,Pe,it)=>de!==Xi?de:(Pe===Xi&&(X=!0),X||!1!==Pe&&it!==L.length-1&&!le(Pe)?de:Pe),F)},Xi),(0,Nt.h)(F=>F!==Xi),(0,ot.U)(F=>le(F)?F:!0===F),(0,An.q)(1)))}class nr{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new Ri,this.attachRef=null}}class Ri{constructor(){this.contexts=new Map}onChildOutletCreated(F,L){const X=this.getOrCreateContext(F);X.outlet=L,this.contexts.set(F,X)}onChildOutletDestroyed(F){const L=this.getContext(F);L&&(L.outlet=null,L.attachRef=null)}onOutletDeactivated(){const F=this.contexts;return this.contexts=new Map,F}onOutletReAttached(F){this.contexts=F}getOrCreateContext(F){let L=this.getContext(F);return L||(L=new nr,this.contexts.set(F,L)),L}getContext(F){return this.contexts.get(F)||null}}let Dr=(()=>{class q{constructor(L,X,de,Pe,it){this.parentContexts=L,this.location=X,this.resolver=de,this.changeDetector=it,this.activated=null,this._activatedRoute=null,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.attachEvents=new d.vpe,this.detachEvents=new d.vpe,this.name=Pe||re,L.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const L=this.parentContexts.getContext(this.name);L&&L.route&&(L.attachRef?this.attach(L.attachRef,L.route):this.activateWith(L.route,L.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const L=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(L.instance),L}attach(L,X){this.activated=L,this._activatedRoute=X,this.location.insert(L.hostView),this.attachEvents.emit(L.instance)}deactivate(){if(this.activated){const L=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(L)}}activateWith(L,X){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=L;const it=(X=X||this.resolver).resolveComponentFactory(L._futureSnapshot.routeConfig.component),xt=this.parentContexts.getOrCreateContext(this.name).children,_n=new Wr(L,xt,this.location.injector);this.activated=this.location.createComponent(it,this.location.length,_n),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return q.\u0275fac=function(L){return new(L||q)(d.Y36(Ri),d.Y36(d.s_b),d.Y36(d._Vd),d.$8M("name"),d.Y36(d.sBO))},q.\u0275dir=d.lG2({type:q,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),q})();class Wr{constructor(F,L,X){this.route=F,this.childContexts=L,this.parent=X}get(F,L){return F===io?this.route:F===Ri?this.childContexts:this.parent.get(F,L)}}let go=(()=>{class q{}return q.\u0275fac=function(L){return new(L||q)},q.\u0275cmp=d.Xpm({type:q,selectors:[["ng-component"]],decls:1,vars:0,template:function(L,X){1&L&&d._UZ(0,"router-outlet")},directives:[Dr],encapsulation:2}),q})();function Lr(q,F=""){for(let L=0;L<q.length;L++){const X=q[L];Ls(X,qo(F,X))}}function Ls(q,F){q.children&&Lr(q.children,F)}function qo(q,F){return F?q||F.path?q&&!F.path?`${q}/`:!q&&F.path?F.path:`${q}/${F.path}`:"":q}function sa(q){const F=q.children&&q.children.map(sa),L=F?{...q,children:F}:{...q};return!L.component&&(F||L.loadChildren)&&L.outlet&&L.outlet!==re&&(L.component=go),L}function Pr(q){return q.outlet||re}function ks(q,F){const L=q.filter(X=>Pr(X)===F);return L.push(...q.filter(X=>Pr(X)!==F)),L}const ws={matched:!1,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};function Di(q,F,L){if(""===F.path)return"full"===F.pathMatch&&(q.hasChildren()||L.length>0)?{...ws}:{matched:!0,consumedSegments:[],lastChild:0,parameters:{},positionalParamSegments:{}};const de=(F.matcher||vt)(L,q,F);if(!de)return{...ws};const Pe={};On(de.posParams,(xt,_n)=>{Pe[_n]=xt.path});const it=de.consumed.length>0?{...Pe,...de.consumed[de.consumed.length-1].parameters}:Pe;return{matched:!0,consumedSegments:de.consumed,lastChild:de.consumed.length,parameters:it,positionalParamSegments:de.posParams??{}}}function qs(q,F,L,X,de="corrected"){if(L.length>0&&function(q,F,L){return L.some(X=>_a(q,F,X)&&Pr(X)!==re)}(q,L,X)){const it=new li(F,function(q,F,L,X){const de={};de[re]=X,X._sourceSegment=q,X._segmentIndexShift=F.length;for(const Pe of L)if(""===Pe.path&&Pr(Pe)!==re){const it=new li([],{});it._sourceSegment=q,it._segmentIndexShift=F.length,de[Pr(Pe)]=it}return de}(q,F,X,new li(L,q.children)));return it._sourceSegment=q,it._segmentIndexShift=F.length,{segmentGroup:it,slicedSegments:[]}}if(0===L.length&&function(q,F,L){return L.some(X=>_a(q,F,X))}(q,L,X)){const it=new li(q.segments,function(q,F,L,X,de,Pe){const it={};for(const xt of X)if(_a(q,L,xt)&&!de[Pr(xt)]){const _n=new li([],{});_n._sourceSegment=q,_n._segmentIndexShift="legacy"===Pe?q.segments.length:F.length,it[Pr(xt)]=_n}return{...de,...it}}(q,F,L,X,q.children,de));return it._sourceSegment=q,it._segmentIndexShift=F.length,{segmentGroup:it,slicedSegments:L}}const Pe=new li(q.segments,q.children);return Pe._sourceSegment=q,Pe._segmentIndexShift=F.length,{segmentGroup:Pe,slicedSegments:L}}function _a(q,F,L){return(!(q.hasChildren()||F.length>0)||"full"!==L.pathMatch)&&""===L.path}function Xa(q,F,L,X){return!!(Pr(q)===X||X!==re&&_a(F,L,q))&&("**"===q.path||Di(F,q,L).matched)}function Mn(q,F,L){return 0===F.length&&!q.children[L]}class Ui{constructor(F){this.segmentGroup=F||null}}class Hs{constructor(F){this.urlTree=F}}function vr(q){return new te.y(F=>F.error(new Ui(q)))}function Jo(q){return new te.y(F=>F.error(new Hs(q)))}function Do(q){return new te.y(F=>F.error(new Error(`Only absolute redirects can have named outlets. redirectTo: '${q}'`)))}class bo{constructor(F,L,X,de,Pe){this.configLoader=L,this.urlSerializer=X,this.urlTree=de,this.config=Pe,this.allowRedirects=!0,this.ngModule=F.get(d.h0i)}apply(){const F=qs(this.urlTree.root,[],[],this.config).segmentGroup,L=new li(F.segments,F.children);return this.expandSegmentGroup(this.ngModule,this.config,L,re).pipe((0,ot.U)(Pe=>this.createUrlTree(ya(Pe),this.urlTree.queryParams,this.urlTree.fragment))).pipe(St(Pe=>{if(Pe instanceof Hs)return this.allowRedirects=!1,this.match(Pe.urlTree);throw Pe instanceof Ui?this.noMatchError(Pe):Pe}))}match(F){return this.expandSegmentGroup(this.ngModule,this.config,F.root,re).pipe((0,ot.U)(de=>this.createUrlTree(ya(de),F.queryParams,F.fragment))).pipe(St(de=>{throw de instanceof Ui?this.noMatchError(de):de}))}noMatchError(F){return new Error(`Cannot match any routes. URL Segment: '${F.segmentGroup}'`)}createUrlTree(F,L,X){const de=F.segments.length>0?new li([],{[re]:F}):F;return new ti(de,L,X)}expandSegmentGroup(F,L,X,de){return 0===X.segments.length&&X.hasChildren()?this.expandChildren(F,L,X).pipe((0,ot.U)(Pe=>new li([],Pe))):this.expandSegment(F,X,L,X.segments,de,!0)}expandChildren(F,L,X){const de=[];for(const Pe of Object.keys(X.children))"primary"===Pe?de.unshift(Pe):de.push(Pe);return(0,Ne.D)(de).pipe((0,pn.b)(Pe=>{const it=X.children[Pe],xt=ks(L,Pe);return this.expandSegmentGroup(F,xt,it,Pe).pipe((0,ot.U)(_n=>({segment:_n,outlet:Pe})))}),ct((Pe,it)=>(Pe[it.outlet]=it.segment,Pe),{}),function(q,F){const L=arguments.length>=2;return X=>X.pipe(q?(0,Nt.h)((de,Pe)=>q(de,Pe,X)):cn.y,Mt(1),L?en(F):Ft(()=>new ze))}())}expandSegment(F,L,X,de,Pe,it){return(0,Ne.D)(X).pipe((0,pn.b)(xt=>this.expandSegmentAgainstRoute(F,L,X,xt,de,Pe,it).pipe(St(di=>{if(di instanceof Ui)return(0,Ae.of)(null);throw di}))),mi(xt=>!!xt),St((xt,_n)=>{if(xt instanceof ze||"EmptyError"===xt.name){if(Mn(L,de,Pe))return(0,Ae.of)(new li([],{}));throw new Ui(L)}throw xt}))}expandSegmentAgainstRoute(F,L,X,de,Pe,it,xt){return Xa(de,L,Pe,it)?void 0===de.redirectTo?this.matchSegmentAgainstRoute(F,L,de,Pe,it):xt&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(F,L,X,de,Pe,it):vr(L):vr(L)}expandSegmentAgainstRouteUsingRedirect(F,L,X,de,Pe,it){return"**"===de.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(F,X,de,it):this.expandRegularSegmentAgainstRouteUsingRedirect(F,L,X,de,Pe,it)}expandWildCardWithParamsAgainstRouteUsingRedirect(F,L,X,de){const Pe=this.applyRedirectCommands([],X.redirectTo,{});return X.redirectTo.startsWith("/")?Jo(Pe):this.lineralizeSegments(X,Pe).pipe((0,_e.zg)(it=>{const xt=new li(it,{});return this.expandSegment(F,xt,L,it,de,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(F,L,X,de,Pe,it){const{matched:xt,consumedSegments:_n,lastChild:di,positionalParamSegments:sr}=Di(L,de,Pe);if(!xt)return vr(L);const Mi=this.applyRedirectCommands(_n,de.redirectTo,sr);return de.redirectTo.startsWith("/")?Jo(Mi):this.lineralizeSegments(de,Mi).pipe((0,_e.zg)(pr=>this.expandSegment(F,L,X,pr.concat(Pe.slice(di)),it,!1)))}matchSegmentAgainstRoute(F,L,X,de,Pe){if("**"===X.path)return X.loadChildren?(X._loadedConfig?(0,Ae.of)(X._loadedConfig):this.configLoader.load(F.injector,X)).pipe((0,ot.U)(pr=>(X._loadedConfig=pr,new li(de,{})))):(0,Ae.of)(new li(de,{}));const{matched:it,consumedSegments:xt,lastChild:_n}=Di(L,X,de);if(!it)return vr(L);const di=de.slice(_n);return this.getChildConfig(F,X,de).pipe((0,_e.zg)(Mi=>{const pr=Mi.module,cr=Mi.routes,{segmentGroup:es,slicedSegments:Ma}=qs(L,xt,di,cr),fr=new li(es.segments,es.children);if(0===Ma.length&&fr.hasChildren())return this.expandChildren(pr,cr,fr).pipe((0,ot.U)(Cc=>new li(xt,Cc)));if(0===cr.length&&0===Ma.length)return(0,Ae.of)(new li(xt,{}));const ts=Pr(X)===Pe;return this.expandSegment(pr,fr,cr,Ma,ts?re:Pe,!0).pipe((0,ot.U)(bl=>new li(xt.concat(bl.segments),bl.children)))}))}getChildConfig(F,L,X){return L.children?(0,Ae.of)(new B(L.children,F)):L.loadChildren?void 0!==L._loadedConfig?(0,Ae.of)(L._loadedConfig):this.runCanLoadGuards(F.injector,L,X).pipe((0,_e.zg)(de=>{return de?this.configLoader.load(F.injector,L).pipe((0,ot.U)(Pe=>(L._loadedConfig=Pe,Pe))):(q=L,new te.y(F=>F.error(De(`Cannot load children because the guard of the route "path: '${q.path}'" returned false`))));var q})):(0,Ae.of)(new B([],F))}runCanLoadGuards(F,L,X){const de=L.canLoad;if(!de||0===de.length)return(0,Ae.of)(!0);const Pe=de.map(it=>{const xt=F.get(it);let _n;if((q=xt)&&I(q.canLoad))_n=xt.canLoad(L,X);else{if(!I(xt))throw new Error("Invalid CanLoad guard");_n=xt(L,X)}var q;return at(_n)});return(0,Ae.of)(Pe).pipe(ar(),xi(it=>{if(!le(it))return;const xt=De(`Redirecting to "${this.urlSerializer.serialize(it)}"`);throw xt.url=it,xt}),(0,ot.U)(it=>!0===it))}lineralizeSegments(F,L){let X=[],de=L.root;for(;;){if(X=X.concat(de.segments),0===de.numberOfChildren)return(0,Ae.of)(X);if(de.numberOfChildren>1||!de.children[re])return Do(F.redirectTo);de=de.children[re]}}applyRedirectCommands(F,L,X){return this.applyRedirectCreatreUrlTree(L,this.urlSerializer.parse(L),F,X)}applyRedirectCreatreUrlTree(F,L,X,de){const Pe=this.createSegmentGroup(F,L.root,X,de);return new ti(Pe,this.createQueryParams(L.queryParams,this.urlTree.queryParams),L.fragment)}createQueryParams(F,L){const X={};return On(F,(de,Pe)=>{if("string"==typeof de&&de.startsWith(":")){const xt=de.substring(1);X[Pe]=L[xt]}else X[Pe]=de}),X}createSegmentGroup(F,L,X,de){const Pe=this.createSegments(F,L.segments,X,de);let it={};return On(L.children,(xt,_n)=>{it[_n]=this.createSegmentGroup(F,xt,X,de)}),new li(Pe,it)}createSegments(F,L,X,de){return L.map(Pe=>Pe.path.startsWith(":")?this.findPosParam(F,Pe,de):this.findOrReturn(Pe,X))}findPosParam(F,L,X){const de=X[L.path.substring(1)];if(!de)throw new Error(`Cannot redirect to '${F}'. Cannot find '${L.path}'.`);return de}findOrReturn(F,L){let X=0;for(const de of L){if(de.path===F.path)return L.splice(X),de;X++}return F}}function ya(q){const F={};for(const X of Object.keys(q.children)){const Pe=ya(q.children[X]);(Pe.segments.length>0||Pe.hasChildren())&&(F[X]=Pe)}return function(q){if(1===q.numberOfChildren&&q.children[re]){const F=q.children[re];return new li(q.segments.concat(F.segments),F.children)}return q}(new li(q.segments,F))}class Ni{constructor(F){this.path=F,this.route=this.path[this.path.length-1]}}class Yr{constructor(F,L){this.component=F,this.route=L}}function Gs(q,F,L){const X=q._root;return va(X,F?F._root:null,L,[X.value])}function ro(q,F,L){const X=function(q){if(!q)return null;for(let F=q.parent;F;F=F.parent){const L=F.routeConfig;if(L&&L._loadedConfig)return L._loadedConfig}return null}(F);return(X?X.module.injector:L).get(q)}function va(q,F,L,X,de={canDeactivateChecks:[],canActivateChecks:[]}){const Pe=ur(F);return q.children.forEach(it=>{(function(q,F,L,X,de={canDeactivateChecks:[],canActivateChecks:[]}){const Pe=q.value,it=F?F.value:null,xt=L?L.getContext(q.value.outlet):null;if(it&&Pe.routeConfig===it.routeConfig){const _n=function(q,F,L){if("function"==typeof L)return L(q,F);switch(L){case"pathParamsChange":return!Ii(q.url,F.url);case"pathParamsOrQueryParamsChange":return!Ii(q.url,F.url)||!lt(q.queryParams,F.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Lo(q,F)||!lt(q.queryParams,F.queryParams);default:return!Lo(q,F)}}(it,Pe,Pe.routeConfig.runGuardsAndResolvers);_n?de.canActivateChecks.push(new Ni(X)):(Pe.data=it.data,Pe._resolvedData=it._resolvedData),va(q,F,Pe.component?xt?xt.children:null:L,X,de),_n&&xt&&xt.outlet&&xt.outlet.isActivated&&de.canDeactivateChecks.push(new Yr(xt.outlet.component,it))}else it&&Xo(F,xt,de),de.canActivateChecks.push(new Ni(X)),va(q,null,Pe.component?xt?xt.children:null:L,X,de)})(it,Pe[it.value.outlet],L,X.concat([it.value]),de),delete Pe[it.value.outlet]}),On(Pe,(it,xt)=>Xo(it,L.getContext(xt),de)),de}function Xo(q,F,L){const X=ur(q),de=q.value;On(X,(Pe,it)=>{Xo(Pe,de.component?F?F.children.getContext(it):null:F,L)}),L.canDeactivateChecks.push(new Yr(de.component&&F&&F.outlet&&F.outlet.isActivated?F.outlet.component:null,de))}class Bi{}function ni(q){return new te.y(F=>F.error(q))}class hr{constructor(F,L,X,de,Pe,it){this.rootComponentType=F,this.config=L,this.urlTree=X,this.url=de,this.paramsInheritanceStrategy=Pe,this.relativeLinkResolution=it}recognize(){const F=qs(this.urlTree.root,[],[],this.config.filter(it=>void 0===it.redirectTo),this.relativeLinkResolution).segmentGroup,L=this.processSegmentGroup(this.config,F,re);if(null===L)return null;const X=new as([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},re,this.rootComponentType,null,this.urlTree.root,-1,{}),de=new qr(X,L),Pe=new vs(this.url,de);return this.inheritParamsAndData(Pe._root),Pe}inheritParamsAndData(F){const L=F.value,X=To(L,this.paramsInheritanceStrategy);L.params=Object.freeze(X.params),L.data=Object.freeze(X.data),F.children.forEach(de=>this.inheritParamsAndData(de))}processSegmentGroup(F,L,X){return 0===L.segments.length&&L.hasChildren()?this.processChildren(F,L):this.processSegment(F,L,L.segments,X)}processChildren(F,L){const X=[];for(const Pe of Object.keys(L.children)){const it=L.children[Pe],xt=ks(F,Pe),_n=this.processSegmentGroup(xt,it,Pe);if(null===_n)return null;X.push(..._n)}const de=Xr(X);return de.sort((F,L)=>F.value.outlet===re?-1:L.value.outlet===re?1:F.value.outlet.localeCompare(L.value.outlet)),de}processSegment(F,L,X,de){for(const Pe of F){const it=this.processSegmentAgainstRoute(Pe,L,X,de);if(null!==it)return it}return Mn(L,X,de)?[]:null}processSegmentAgainstRoute(F,L,X,de){if(F.redirectTo||!Xa(F,L,X,de))return null;let Pe,it=[],xt=[];if("**"===F.path){const cr=X.length>0?Zt(X).parameters:{};Pe=new as(X,cr,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$l(F),Pr(F),F.component,F,_l(L),xa(L)+X.length,gc(F))}else{const cr=Di(L,F,X);if(!cr.matched)return null;it=cr.consumedSegments,xt=X.slice(cr.lastChild),Pe=new as(it,cr.parameters,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,$l(F),Pr(F),F.component,F,_l(L),xa(L)+it.length,gc(F))}const _n=(q=F).children?q.children:q.loadChildren?q._loadedConfig.routes:[],{segmentGroup:di,slicedSegments:sr}=qs(L,it,xt,_n.filter(cr=>void 0===cr.redirectTo),this.relativeLinkResolution);var q;if(0===sr.length&&di.hasChildren()){const cr=this.processChildren(_n,di);return null===cr?null:[new qr(Pe,cr)]}if(0===_n.length&&0===sr.length)return[new qr(Pe,[])];const Mi=Pr(F)===de,pr=this.processSegment(_n,di,sr,Mi?re:de);return null===pr?null:[new qr(Pe,pr)]}}function Zr(q){const F=q.value.routeConfig;return F&&""===F.path&&void 0===F.redirectTo}function Xr(q){const F=[],L=new Set;for(const X of q){if(!Zr(X)){F.push(X);continue}const de=F.find(Pe=>X.value.routeConfig===Pe.value.routeConfig);void 0!==de?(de.children.push(...X.children),L.add(de)):F.push(X)}for(const X of L){const de=Xr(X.children);F.push(new qr(X.value,de))}return F.filter(X=>!L.has(X))}function _l(q){let F=q;for(;F._sourceSegment;)F=F._sourceSegment;return F}function xa(q){let F=q,L=F._segmentIndexShift?F._segmentIndexShift:0;for(;F._sourceSegment;)F=F._sourceSegment,L+=F._segmentIndexShift?F._segmentIndexShift:0;return L-1}function $l(q){return q.data||{}}function gc(q){return q.resolve||{}}function wo(q){return(0,ft.w)(F=>{const L=q(F);return L?(0,Ne.D)(L).pipe((0,ot.U)(()=>F)):(0,Ae.of)(F)})}class La{}class us extends class{shouldDetach(F){return!1}store(F,L){}shouldAttach(F){return!1}retrieve(F){return null}shouldReuseRoute(F,L){return F.routeConfig===L.routeConfig}}{}const Ca=new d.OlP("ROUTES");class mc{constructor(F,L,X,de){this.injector=F,this.compiler=L,this.onLoadStartListener=X,this.onLoadEndListener=de}load(F,L){if(L._loader$)return L._loader$;this.onLoadStartListener&&this.onLoadStartListener(L);const de=this.loadModuleFactory(L.loadChildren).pipe((0,ot.U)(Pe=>{this.onLoadEndListener&&this.onLoadEndListener(L);const it=Pe.create(F);return new B(Ht(it.injector.get(Ca,void 0,d.XFs.Self|d.XFs.Optional)).map(sa),it)}),St(Pe=>{throw L._loader$=void 0,Pe}));return L._loader$=new E.c(de,()=>new Qe.xQ).pipe((0,Ye.x)()),L._loader$}loadModuleFactory(F){return at(F()).pipe((0,_e.zg)(L=>L instanceof d.YKP?(0,Ae.of)(L):(0,Ne.D)(this.compiler.compileModuleAsync(L))))}}class el{shouldProcessUrl(F){return!0}extract(F){return F}merge(F,L){return F}}function tl(q){throw q}function Gc(q,F,L){return F.parse("/")}function Bo(q,F){return(0,Ae.of)(null)}const Wc={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},Ta={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let mo=(()=>{class q{constructor(L,X,de,Pe,it,xt,_n){this.rootComponentType=L,this.urlSerializer=X,this.rootContexts=de,this.location=Pe,this.config=_n,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Qe.xQ,this.errorHandler=tl,this.malformedUriErrorHandler=Gc,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:Bo,afterPreactivation:Bo},this.urlHandlingStrategy=new el,this.routeReuseStrategy=new us,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=it.get(d.h0i),this.console=it.get(d.c2e);const Mi=it.get(d.R0b);this.isNgZoneEnabled=Mi instanceof d.R0b&&d.R0b.isInAngularZone(),this.resetConfig(_n),this.currentUrlTree=new ti(new li([],{}),{},null),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new mc(it,xt,pr=>this.triggerEvent(new Yi(pr)),pr=>this.triggerEvent(new br(pr))),this.routerState=ss(this.currentUrlTree,this.rootComponentType),this.transitions=new Te.X({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){return this.location.getState()?.\u0275routerPageId}setupNavigations(L){const X=this.events;return L.pipe((0,Nt.h)(de=>0!==de.id),(0,ot.U)(de=>({...de,extractedUrl:this.urlHandlingStrategy.extract(de.rawUrl)})),(0,ft.w)(de=>{let Pe=!1,it=!1;return(0,Ae.of)(de).pipe(xi(xt=>{this.currentNavigation={id:xt.id,initialUrl:xt.currentRawUrl,extractedUrl:xt.extractedUrl,trigger:xt.source,extras:xt.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,ft.w)(xt=>{const _n=this.browserUrlTree.toString(),di=!this.navigated||xt.extractedUrl.toString()!==_n||_n!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||di)&&this.urlHandlingStrategy.shouldProcessUrl(xt.rawUrl))return Fs(xt.source)&&(this.browserUrlTree=xt.extractedUrl),(0,Ae.of)(xt).pipe((0,ft.w)(Mi=>{const pr=this.transitions.getValue();return X.next(new We(Mi.id,this.serializeUrl(Mi.extractedUrl),Mi.source,Mi.restoredState)),pr!==this.transitions.getValue()?Fe.E:Promise.resolve(Mi)}),function(q,F,L,X){return(0,ft.w)(de=>function(q,F,L,X,de){return new bo(q,F,L,X,de).apply()}(q,F,L,de.extractedUrl,X).pipe((0,ot.U)(Pe=>({...de,urlAfterRedirects:Pe}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),xi(Mi=>{this.currentNavigation={...this.currentNavigation,finalUrl:Mi.urlAfterRedirects}}),function(q,F,L,X,de){return(0,_e.zg)(Pe=>function(q,F,L,X,de="emptyOnly",Pe="legacy"){try{const it=new hr(q,F,L,X,de,Pe).recognize();return null===it?ni(new Bi):(0,Ae.of)(it)}catch(it){return ni(it)}}(q,F,Pe.urlAfterRedirects,L(Pe.urlAfterRedirects),X,de).pipe((0,ot.U)(it=>({...Pe,targetSnapshot:it}))))}(this.rootComponentType,this.config,Mi=>this.serializeUrl(Mi),this.paramsInheritanceStrategy,this.relativeLinkResolution),xi(Mi=>{if("eager"===this.urlUpdateStrategy){if(!Mi.extras.skipLocationChange){const cr=this.urlHandlingStrategy.merge(Mi.urlAfterRedirects,Mi.rawUrl);this.setBrowserUrl(cr,Mi)}this.browserUrlTree=Mi.urlAfterRedirects}const pr=new ci(Mi.id,this.serializeUrl(Mi.extractedUrl),this.serializeUrl(Mi.urlAfterRedirects),Mi.targetSnapshot);X.next(pr)}));if(di&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:pr,extractedUrl:cr,source:es,restoredState:Ma,extras:fr}=xt,ts=new We(pr,this.serializeUrl(cr),es,Ma);X.next(ts);const Wl=ss(cr,this.rootComponentType).snapshot;return(0,Ae.of)({...xt,targetSnapshot:Wl,urlAfterRedirects:cr,extras:{...fr,skipLocationChange:!1,replaceUrl:!1}})}return this.rawUrlTree=xt.rawUrl,xt.resolve(null),Fe.E}),wo(xt=>{const{targetSnapshot:_n,id:di,extractedUrl:sr,rawUrl:Mi,extras:{skipLocationChange:pr,replaceUrl:cr}}=xt;return this.hooks.beforePreactivation(_n,{navigationId:di,appliedUrlTree:sr,rawUrlTree:Mi,skipLocationChange:!!pr,replaceUrl:!!cr})}),xi(xt=>{const _n=new ai(xt.id,this.serializeUrl(xt.extractedUrl),this.serializeUrl(xt.urlAfterRedirects),xt.targetSnapshot);this.triggerEvent(_n)}),(0,ot.U)(xt=>({...xt,guards:Gs(xt.targetSnapshot,xt.currentSnapshot,this.rootContexts)})),function(q,F){return(0,_e.zg)(L=>{const{targetSnapshot:X,currentSnapshot:de,guards:{canActivateChecks:Pe,canDeactivateChecks:it}}=L;return 0===it.length&&0===Pe.length?(0,Ae.of)({...L,guardsResult:!0}):function(q,F,L,X){return(0,Ne.D)(q).pipe((0,_e.zg)(de=>function(q,F,L,X,de){const Pe=F&&F.routeConfig?F.routeConfig.canDeactivate:null;if(!Pe||0===Pe.length)return(0,Ae.of)(!0);const it=Pe.map(xt=>{const _n=ro(xt,F,de);let di;if(function(q){return q&&I(q.canDeactivate)}(_n))di=at(_n.canDeactivate(q,F,L,X));else{if(!I(_n))throw new Error("Invalid CanDeactivate guard");di=at(_n(q,F,L,X))}return di.pipe(mi())});return(0,Ae.of)(it).pipe(ar())}(de.component,de.route,L,F,X)),mi(de=>!0!==de,!0))}(it,X,de,q).pipe((0,_e.zg)(xt=>xt&&function(q){return"boolean"==typeof q}(xt)?function(q,F,L,X){return(0,Ne.D)(F).pipe((0,pn.b)(de=>(0,He.z)(function(q,F){return null!==q&&F&&F(new Ei(q)),(0,Ae.of)(!0)}(de.route.parent,X),function(q,F){return null!==q&&F&&F(new mr(q)),(0,Ae.of)(!0)}(de.route,X),function(q,F,L){const X=F[F.length-1],Pe=F.slice(0,F.length-1).reverse().map(it=>function(q){const F=q.routeConfig?q.routeConfig.canActivateChild:null;return F&&0!==F.length?{node:q,guards:F}:null}(it)).filter(it=>null!==it).map(it=>(0,Ge.P)(()=>{const xt=it.guards.map(_n=>{const di=ro(_n,it.node,L);let sr;if(function(q){return q&&I(q.canActivateChild)}(di))sr=at(di.canActivateChild(X,q));else{if(!I(di))throw new Error("Invalid CanActivateChild guard");sr=at(di(X,q))}return sr.pipe(mi())});return(0,Ae.of)(xt).pipe(ar())}));return(0,Ae.of)(Pe).pipe(ar())}(q,de.path,L),function(q,F,L){const X=F.routeConfig?F.routeConfig.canActivate:null;if(!X||0===X.length)return(0,Ae.of)(!0);const de=X.map(Pe=>(0,Ge.P)(()=>{const it=ro(Pe,F,L);let xt;if(function(q){return q&&I(q.canActivate)}(it))xt=at(it.canActivate(F,q));else{if(!I(it))throw new Error("Invalid CanActivate guard");xt=at(it(F,q))}return xt.pipe(mi())}));return(0,Ae.of)(de).pipe(ar())}(q,de.route,L))),mi(de=>!0!==de,!0))}(X,Pe,q,F):(0,Ae.of)(xt)),(0,ot.U)(xt=>({...L,guardsResult:xt})))})}(this.ngModule.injector,xt=>this.triggerEvent(xt)),xi(xt=>{if(le(xt.guardsResult)){const di=De(`Redirecting to "${this.serializeUrl(xt.guardsResult)}"`);throw di.url=xt.guardsResult,di}const _n=new Un(xt.id,this.serializeUrl(xt.extractedUrl),this.serializeUrl(xt.urlAfterRedirects),xt.targetSnapshot,!!xt.guardsResult);this.triggerEvent(_n)}),(0,Nt.h)(xt=>!!xt.guardsResult||(this.restoreHistory(xt),this.cancelNavigationTransition(xt,""),!1)),wo(xt=>{if(xt.guards.canActivateChecks.length)return(0,Ae.of)(xt).pipe(xi(_n=>{const di=new Fi(_n.id,this.serializeUrl(_n.extractedUrl),this.serializeUrl(_n.urlAfterRedirects),_n.targetSnapshot);this.triggerEvent(di)}),(0,ft.w)(_n=>{let di=!1;return(0,Ae.of)(_n).pipe(function(q,F){return(0,_e.zg)(L=>{const{targetSnapshot:X,guards:{canActivateChecks:de}}=L;if(!de.length)return(0,Ae.of)(L);let Pe=0;return(0,Ne.D)(de).pipe((0,pn.b)(it=>function(q,F,L,X){return function(q,F,L,X){const de=Object.keys(q);if(0===de.length)return(0,Ae.of)({});const Pe={};return(0,Ne.D)(de).pipe((0,_e.zg)(it=>function(q,F,L,X){const de=ro(q,F,X);return at(de.resolve?de.resolve(F,L):de(F,L))}(q[it],F,L,X).pipe(xi(xt=>{Pe[it]=xt}))),Mt(1),(0,_e.zg)(()=>Object.keys(Pe).length===de.length?(0,Ae.of)(Pe):Fe.E))}(q._resolve,q,F,X).pipe((0,ot.U)(Pe=>(q._resolvedData=Pe,q.data={...q.data,...To(q,L).resolve},null)))}(it.route,X,q,F)),xi(()=>Pe++),Mt(1),(0,_e.zg)(it=>Pe===de.length?(0,Ae.of)(L):Fe.E))})}(this.paramsInheritanceStrategy,this.ngModule.injector),xi({next:()=>di=!0,complete:()=>{di||(this.restoreHistory(_n),this.cancelNavigationTransition(_n,"At least one route resolver didn't emit any value."))}}))}),xi(_n=>{const di=new Ti(_n.id,this.serializeUrl(_n.extractedUrl),this.serializeUrl(_n.urlAfterRedirects),_n.targetSnapshot);this.triggerEvent(di)}))}),wo(xt=>{const{targetSnapshot:_n,id:di,extractedUrl:sr,rawUrl:Mi,extras:{skipLocationChange:pr,replaceUrl:cr}}=xt;return this.hooks.afterPreactivation(_n,{navigationId:di,appliedUrlTree:sr,rawUrlTree:Mi,skipLocationChange:!!pr,replaceUrl:!!cr})}),(0,ot.U)(xt=>{const _n=function(q,F,L){const X=ko(q,F._root,L?L._root:void 0);return new vo(X,F)}(this.routeReuseStrategy,xt.targetSnapshot,xt.currentRouterState);return{...xt,targetRouterState:_n}}),xi(xt=>{this.currentUrlTree=xt.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(xt.urlAfterRedirects,xt.rawUrl),this.routerState=xt.targetRouterState,"deferred"===this.urlUpdateStrategy&&(xt.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,xt),this.browserUrlTree=xt.urlAfterRedirects)}),((q,F,L)=>(0,ot.U)(X=>(new Os(F,X.targetRouterState,X.currentRouterState,L).activate(q),X)))(this.rootContexts,this.routeReuseStrategy,xt=>this.triggerEvent(xt)),xi({next(){Pe=!0},complete(){Pe=!0}}),function(q){return F=>F.lift(new xn(q))}(()=>{Pe||it||this.cancelNavigationTransition(de,`Navigation ID ${de.id} is not equal to the current navigation id ${this.navigationId}`),this.currentNavigation?.id===de.id&&(this.currentNavigation=null)}),St(xt=>{if(it=!0,function(q){return q&&q[pe]}(xt)){const _n=le(xt.url);_n||(this.navigated=!0,this.restoreHistory(de,!0));const di=new on(de.id,this.serializeUrl(de.extractedUrl),xt.message);X.next(di),_n?setTimeout(()=>{const sr=this.urlHandlingStrategy.merge(xt.url,this.rawUrlTree),Mi={skipLocationChange:de.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Fs(de.source)};this.scheduleNavigation(sr,"imperative",null,Mi,{resolve:de.resolve,reject:de.reject,promise:de.promise})},0):de.resolve(!1)}else{this.restoreHistory(de,!0);const _n=new qn(de.id,this.serializeUrl(de.extractedUrl),xt);X.next(_n);try{de.resolve(this.errorHandler(xt))}catch(di){de.reject(di)}}return Fe.E}))}))}resetRootComponentType(L){this.rootComponentType=L,this.routerState.root.component=this.rootComponentType}setTransition(L){this.transitions.next({...this.transitions.value,...L})}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(L=>{const X="popstate"===L.type?"popstate":"hashchange";"popstate"===X&&setTimeout(()=>{const de={replaceUrl:!0},Pe=L.state?.navigationId?L.state:null;if(Pe){const xt={...Pe};delete xt.navigationId,delete xt.\u0275routerPageId,0!==Object.keys(xt).length&&(de.state=xt)}const it=this.parseUrl(L.url);this.scheduleNavigation(it,X,Pe,de)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(L){this.events.next(L)}resetConfig(L){Lr(L),this.config=L.map(sa),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(L,X={}){const{relativeTo:de,queryParams:Pe,fragment:it,queryParamsHandling:xt,preserveFragment:_n}=X,di=de||this.routerState.root,sr=_n?this.currentUrlTree.fragment:it;let Mi=null;switch(xt){case"merge":Mi={...this.currentUrlTree.queryParams,...Pe};break;case"preserve":Mi=this.currentUrlTree.queryParams;break;default:Mi=Pe||null}return null!==Mi&&(Mi=this.removeEmptyProps(Mi)),function(q,F,L,X,de){if(0===L.length)return Eo(F.root,F.root,F,X,de);const Pe=function(q){if("string"==typeof q[0]&&1===q.length&&"/"===q[0])return new st(!0,0,q);let F=0,L=!1;const X=q.reduce((de,Pe,it)=>{if("object"==typeof Pe&&null!=Pe){if(Pe.outlets){const xt={};return On(Pe.outlets,(_n,di)=>{xt[di]="string"==typeof _n?_n.split("/"):_n}),[...de,{outlets:xt}]}if(Pe.segmentPath)return[...de,Pe.segmentPath]}return"string"!=typeof Pe?[...de,Pe]:0===it?(Pe.split("/").forEach((xt,_n)=>{0==_n&&"."===xt||(0==_n&&""===xt?L=!0:".."===xt?F++:""!=xt&&de.push(xt))}),de):[...de,Pe]},[]);return new st(L,F,X)}(L);if(Pe.toRoot())return Eo(F.root,new li([],{}),F,X,de);const it=function(q,F,L){if(q.isAbsolute)return new rt(F.root,!0,0);if(-1===L.snapshot._lastPathIndex){const Pe=L.snapshot._urlSegment;return new rt(Pe,Pe===F.root,0)}const X=Fo(q.commands[0])?0:1;return function(q,F,L){let X=q,de=F,Pe=L;for(;Pe>de;){if(Pe-=de,X=X.parent,!X)throw new Error("Invalid number of '../'");de=X.segments.length}return new rt(X,!1,de-Pe)}(L.snapshot._urlSegment,L.snapshot._lastPathIndex+X,q.numberOfDoubleDots)}(Pe,F,q),xt=it.processChildren?Cr(it.segmentGroup,it.index,Pe.commands):dr(it.segmentGroup,it.index,Pe.commands);return Eo(it.segmentGroup,xt,F,X,de)}(di,this.currentUrlTree,L,Mi,sr??null)}navigateByUrl(L,X={skipLocationChange:!1}){const de=le(L)?L:this.parseUrl(L),Pe=this.urlHandlingStrategy.merge(de,this.rawUrlTree);return this.scheduleNavigation(Pe,"imperative",null,X)}navigate(L,X={skipLocationChange:!1}){return function(q){for(let F=0;F<q.length;F++){const L=q[F];if(null==L)throw new Error(`The requested path contains ${L} segment at index ${F}`)}}(L),this.navigateByUrl(this.createUrlTree(L,X),X)}serializeUrl(L){return this.urlSerializer.serialize(L)}parseUrl(L){let X;try{X=this.urlSerializer.parse(L)}catch(de){X=this.malformedUriErrorHandler(de,this.urlSerializer,L)}return X}isActive(L,X){let de;if(de=!0===X?{...Wc}:!1===X?{...Ta}:X,le(L))return ei(this.currentUrlTree,L,de);const Pe=this.parseUrl(L);return ei(this.currentUrlTree,Pe,de)}removeEmptyProps(L){return Object.keys(L).reduce((X,de)=>{const Pe=L[de];return null!=Pe&&(X[de]=Pe),X},{})}processNavigations(){this.navigations.subscribe(L=>{this.navigated=!0,this.lastSuccessfulId=L.id,this.currentPageId=L.targetPageId,this.events.next(new Tt(L.id,this.serializeUrl(L.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,L.resolve(!0)},L=>{this.console.warn(`Unhandled Navigation Error: ${L}`)})}scheduleNavigation(L,X,de,Pe,it){if(this.disposed)return Promise.resolve(!1);const xt=this.transitions.value,_n=Fs(X)&&xt&&!Fs(xt.source),di=xt.rawUrl.toString()===L.toString();if(_n&&di&&xt.id===this.currentNavigation?.id)return Promise.resolve(!0);let pr,cr,es;it?(pr=it.resolve,cr=it.reject,es=it.promise):es=new Promise((ts,Wl)=>{pr=ts,cr=Wl});const Ma=++this.navigationId;let fr;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(de=this.location.getState()),fr=de&&de.\u0275routerPageId?de.\u0275routerPageId:Pe.replaceUrl||Pe.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1):fr=0,this.setTransition({id:Ma,targetPageId:fr,source:X,restoredState:de,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:L,extras:Pe,resolve:pr,reject:cr,promise:es,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),es.catch(ts=>Promise.reject(ts))}setBrowserUrl(L,X){const de=this.urlSerializer.serialize(L),Pe={...X.extras.state,...this.generateNgRouterState(X.id,X.targetPageId)};this.location.isCurrentPathEqualTo(de)||X.extras.replaceUrl?this.location.replaceState(de,"",Pe):this.location.go(de,"",Pe)}restoreHistory(L,X=!1){if("computed"===this.canceledNavigationResolution){const de=this.currentPageId-L.targetPageId;"popstate"!==L.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.currentNavigation?.finalUrl||0===de?this.currentUrlTree===this.currentNavigation?.finalUrl&&0===de&&(this.resetState(L),this.browserUrlTree=L.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(de)}else"replace"===this.canceledNavigationResolution&&(X&&this.resetState(L),this.resetUrlToCurrentUrlTree())}resetState(L){this.routerState=L.currentRouterState,this.currentUrlTree=L.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,L.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(L,X){const de=new on(L.id,this.serializeUrl(L.extractedUrl),X);this.triggerEvent(de),L.resolve(!1)}generateNgRouterState(L,X){return"computed"===this.canceledNavigationResolution?{navigationId:L,\u0275routerPageId:X}:{navigationId:L}}}return q.\u0275fac=function(L){d.$Z()},q.\u0275prov=d.Yz7({token:q,factory:q.\u0275fac}),q})();function Fs(q){return"imperative"!==q}let ca=(()=>{class q{constructor(L,X,de,Pe,it){this.router=L,this.route=X,this.tabIndexAttribute=de,this.renderer=Pe,this.el=it,this.commands=null,this.onChanges=new Qe.xQ,this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(L){if(null!=this.tabIndexAttribute)return;const X=this.renderer,de=this.el.nativeElement;null!==L?X.setAttribute(de,"tabindex",L):X.removeAttribute(de,"tabindex")}ngOnChanges(L){this.onChanges.next(this)}set routerLink(L){null!=L?(this.commands=Array.isArray(L)?L:[L],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(){if(null===this.urlTree)return!0;const L={skipLocationChange:Ea(this.skipLocationChange),replaceUrl:Ea(this.replaceUrl),state:this.state};return this.router.navigateByUrl(this.urlTree,L),!0}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:Ea(this.preserveFragment)})}}return q.\u0275fac=function(L){return new(L||q)(d.Y36(mo),d.Y36(io),d.$8M("tabindex"),d.Y36(d.Qsj),d.Y36(d.SBq))},q.\u0275dir=d.lG2({type:q,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(L,X){1&L&&d.NdJ("click",function(){return X.onClick()})},inputs:{queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",state:"state",relativeTo:"relativeTo",routerLink:"routerLink"},features:[d.TTD]}),q})();function Ea(q){return""===q||!!q}class Ns{}class il{preload(F,L){return(0,Ae.of)(null)}}let Yc=(()=>{class q{constructor(L,X,de,Pe){this.router=L,this.injector=de,this.preloadingStrategy=Pe,this.loader=new mc(de,X,_n=>L.triggerEvent(new Yi(_n)),_n=>L.triggerEvent(new br(_n)))}setUpPreloading(){this.subscription=this.router.events.pipe((0,Nt.h)(L=>L instanceof Tt),(0,pn.b)(()=>this.preload())).subscribe(()=>{})}preload(){const L=this.injector.get(d.h0i);return this.processRoutes(L,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(L,X){const de=[];for(const Pe of X)if(Pe.loadChildren&&!Pe.canLoad&&Pe._loadedConfig){const it=Pe._loadedConfig;de.push(this.processRoutes(it.module,it.routes))}else Pe.loadChildren&&!Pe.canLoad?de.push(this.preloadConfig(L,Pe)):Pe.children&&de.push(this.processRoutes(L,Pe.children));return(0,Ne.D)(de).pipe((0,j.J)(),(0,ot.U)(Pe=>{}))}preloadConfig(L,X){return this.preloadingStrategy.preload(X,()=>(X._loadedConfig?(0,Ae.of)(X._loadedConfig):this.loader.load(L.injector,X)).pipe((0,_e.zg)(Pe=>(X._loadedConfig=Pe,this.processRoutes(Pe.module,Pe.routes)))))}}return q.\u0275fac=function(L){return new(L||q)(d.LFG(mo),d.LFG(d.Sil),d.LFG(d.zs3),d.LFG(Ns))},q.\u0275prov=d.Yz7({token:q,factory:q.\u0275fac}),q})(),Ia=(()=>{class q{constructor(L,X,de={}){this.router=L,this.viewportScroller=X,this.options=de,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},de.scrollPositionRestoration=de.scrollPositionRestoration||"disabled",de.anchorScrolling=de.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(L=>{L instanceof We?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=L.navigationTrigger,this.restoredId=L.restoredState?L.restoredState.navigationId:0):L instanceof Tt&&(this.lastId=L.id,this.scheduleScrollEvent(L,this.router.parseUrl(L.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(L=>{L instanceof hi&&(L.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(L.position):L.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(L.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(L,X){this.router.triggerEvent(new hi(L,"popstate"===this.lastSource?this.store[this.restoredId]:null,X))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return q.\u0275fac=function(L){d.$Z()},q.\u0275prov=d.Yz7({token:q,factory:q.\u0275fac}),q})();const ua=new d.OlP("ROUTER_CONFIGURATION"),yc=new d.OlP("ROUTER_FORROOT_GUARD"),da=[x.Ye,{provide:Or,useClass:jn},{provide:mo,useFactory:function(q,F,L,X,de,Pe,it={},xt,_n){const di=new mo(null,q,F,L,X,de,Ht(Pe));return xt&&(di.urlHandlingStrategy=xt),_n&&(di.routeReuseStrategy=_n),function(q,F){q.errorHandler&&(F.errorHandler=q.errorHandler),q.malformedUriErrorHandler&&(F.malformedUriErrorHandler=q.malformedUriErrorHandler),q.onSameUrlNavigation&&(F.onSameUrlNavigation=q.onSameUrlNavigation),q.paramsInheritanceStrategy&&(F.paramsInheritanceStrategy=q.paramsInheritanceStrategy),q.relativeLinkResolution&&(F.relativeLinkResolution=q.relativeLinkResolution),q.urlUpdateStrategy&&(F.urlUpdateStrategy=q.urlUpdateStrategy),q.canceledNavigationResolution&&(F.canceledNavigationResolution=q.canceledNavigationResolution)}(it,di),it.enableTracing&&di.events.subscribe(sr=>{console.group?.(`Router Event: ${sr.constructor.name}`),console.log(sr.toString()),console.log(sr),console.groupEnd?.()}),di},deps:[Or,Ri,x.Ye,d.zs3,d.Sil,Ca,ua,[class{},new d.FiY],[La,new d.FiY]]},Ri,{provide:io,useFactory:function(q){return q.routerState.root},deps:[mo]},Yc,il,class{preload(F,L){return L().pipe(St(()=>(0,Ae.of)(null)))}},{provide:ua,useValue:{enableTracing:!1}}];function Fa(){return new d.PXZ("Router",mo)}let Hl=(()=>{class q{constructor(L,X){}static forRoot(L,X){return{ngModule:q,providers:[da,Na(L),{provide:yc,useFactory:Jc,deps:[[mo,new d.FiY,new d.tp0]]},{provide:ua,useValue:X||{}},{provide:x.S$,useFactory:vl,deps:[x.lw,[new d.tBr(x.mr),new d.FiY],ua]},{provide:Ia,useFactory:yl,deps:[mo,x.EM,ua]},{provide:Ns,useExisting:X&&X.preloadingStrategy?X.preloadingStrategy:il},{provide:d.PXZ,multi:!0,useFactory:Fa},[xl,{provide:d.ip1,multi:!0,useFactory:Gl,deps:[xl]},{provide:Aa,useFactory:rl,deps:[xl]},{provide:d.tb,multi:!0,useExisting:Aa}]]}}static forChild(L){return{ngModule:q,providers:[Na(L)]}}}return q.\u0275fac=function(L){return new(L||q)(d.LFG(yc,8),d.LFG(mo,8))},q.\u0275mod=d.oAB({type:q}),q.\u0275inj=d.cJS({}),q})();function yl(q,F,L){return L.scrollOffset&&F.setOffset(L.scrollOffset),new Ia(q,F,L)}function vl(q,F,L={}){return L.useHash?new x.Do(q,F):new x.b0(q,F)}function Jc(q){return"guarded"}function Na(q){return[{provide:d.deG,multi:!0,useValue:q},{provide:Ca,multi:!0,useValue:q}]}let xl=(()=>{class q{constructor(L){this.injector=L,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Qe.xQ}appInitializer(){return this.injector.get(x.V_,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let X=null;const de=new Promise(xt=>X=xt),Pe=this.injector.get(mo),it=this.injector.get(ua);return"disabled"===it.initialNavigation?(Pe.setUpLocationChangeListener(),X(!0)):"enabled"===it.initialNavigation||"enabledBlocking"===it.initialNavigation?(Pe.hooks.afterPreactivation=()=>this.initNavigation?(0,Ae.of)(null):(this.initNavigation=!0,X(!0),this.resultOfPreactivationDone),Pe.initialNavigation()):X(!0),de})}bootstrapListener(L){const X=this.injector.get(ua),de=this.injector.get(Yc),Pe=this.injector.get(Ia),it=this.injector.get(mo),xt=this.injector.get(d.z2F);L===xt.components[0]&&(("enabledNonBlocking"===X.initialNavigation||void 0===X.initialNavigation)&&it.initialNavigation(),de.setUpPreloading(),Pe.init(),it.resetRootComponentType(xt.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return q.\u0275fac=function(L){return new(L||q)(d.LFG(d.zs3))},q.\u0275prov=d.Yz7({token:q,factory:q.\u0275fac}),q})();function Gl(q){return q.appInitializer.bind(q)}function rl(q){return q.bootstrapListener.bind(q)}const Aa=new d.OlP("Router Initializer")},4553:(yn,je,N)=>{"use strict";function x(Y,l,P,O,f,H,te){try{var K=Y[H](te),G=K.value}catch(ne){return void P(ne)}K.done?l(G):Promise.resolve(G).then(O,f)}function d(Y){return function(){var l=this,P=arguments;return new Promise(function(O,f){var H=Y.apply(l,P);function te(G){x(H,O,f,te,K,"next",G)}function K(G){x(H,O,f,te,K,"throw",G)}te(void 0)})}}N.d(je,{Z:()=>d})}},yn=>{yn(yn.s=6537)}]);