(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{6091:(zn,Ct,R)=>{"use strict";R.d(Ct,{Ar:()=>X,N0:()=>fe});var v=R(2029),d=R(6814),y=R(7398),s=R(1631),Q=R(4911),ie=R(2096),W=R(9862);const w=new v.OlP("JWT_OPTIONS");let fe=(()=>{class se{constructor(ge=null){this.tokenGetter=ge&&ge.tokenGetter||function(){}}urlBase64Decode(ge){let we=ge.replace(/-/g,"+").replace(/_/g,"/");switch(we.length%4){case 0:break;case 2:we+="==";break;case 3:we+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(we)}b64decode(ge){let Le="";if((ge=String(ge).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let ze,Ke,Me=0,Oe=0;Ke=ge.charAt(Oe++);~Ke&&(ze=Me%4?64*ze+Ke:Ke,Me++%4)?Le+=String.fromCharCode(255&ze>>(-2*Me&6)):0)Ke="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(Ke);return Le}b64DecodeUnicode(ge){return decodeURIComponent(Array.prototype.map.call(this.b64decode(ge),we=>"%"+("00"+we.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(ge=this.tokenGetter()){return ge instanceof Promise?ge.then(we=>this._decodeToken(we)):this._decodeToken(ge)}_decodeToken(ge){if(!ge||""===ge)return null;const we=ge.split(".");if(3!==we.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const Le=this.urlBase64Decode(we[1]);if(!Le)throw new Error("Cannot decode the token.");return JSON.parse(Le)}getTokenExpirationDate(ge=this.tokenGetter()){return ge instanceof Promise?ge.then(we=>this._getTokenExpirationDate(we)):this._getTokenExpirationDate(ge)}_getTokenExpirationDate(ge){let we;if(we=this.decodeToken(ge),!we||!we.hasOwnProperty("exp"))return null;const Le=new Date(0);return Le.setUTCSeconds(we.exp),Le}isTokenExpired(ge=this.tokenGetter(),we){return ge instanceof Promise?ge.then(Le=>this._isTokenExpired(Le,we)):this._isTokenExpired(ge,we)}_isTokenExpired(ge,we){if(!ge||""===ge)return!0;const Le=this.getTokenExpirationDate(ge);return we=we||0,null!==Le&&!(Le.valueOf()>(new Date).valueOf()+1e3*we)}getAuthScheme(ge,we){return"function"==typeof ge?ge(we):ge}}return se.\u0275fac=function(ge){return new(ge||se)(v.LFG(w))},se.\u0275prov=v.Yz7({token:se,factory:se.\u0275fac}),se})();const Ae=se=>se instanceof Promise?(0,Q.P)(()=>se):(0,ie.of)(se);let De=(()=>{class se{constructor(ge,we,Le){this.jwtHelper=we,this.document=Le,this.standardPorts=["80","443"],this.tokenGetter=ge.tokenGetter,this.headerName=ge.headerName||"Authorization",this.authScheme=ge.authScheme||""===ge.authScheme?ge.authScheme:"Bearer ",this.allowedDomains=ge.allowedDomains||[],this.disallowedRoutes=ge.disallowedRoutes||[],this.throwNoTokenError=ge.throwNoTokenError||!1,this.skipWhenExpired=ge.skipWhenExpired}isAllowedDomain(ge){const we=new URL(ge.url,this.document.location.origin);if(we.host===this.document.location.host)return!0;const Le=`${we.hostname}${we.port&&!this.standardPorts.includes(we.port)?":"+we.port:""}`;return this.allowedDomains.findIndex(Me=>"string"==typeof Me?Me===Le:Me instanceof RegExp&&Me.test(Le))>-1}isDisallowedRoute(ge){const we=new URL(ge.url,this.document.location.origin);return this.disallowedRoutes.findIndex(Le=>{if("string"==typeof Le){const Me=new URL(Le,this.document.location.origin);return Me.hostname===we.hostname&&Me.pathname===we.pathname}return Le instanceof RegExp&&Le.test(ge.url)})>-1}handleInterception(ge,we,Le){const Me=this.jwtHelper.getAuthScheme(this.authScheme,we);if(!ge&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");let ze=(0,ie.of)(!1);return this.skipWhenExpired&&(ze=ge?Ae(this.jwtHelper.isTokenExpired(ge)):(0,ie.of)(!0)),ge?ze.pipe((0,y.U)(Ke=>Ke&&this.skipWhenExpired?we.clone():we.clone({setHeaders:{[this.headerName]:`${Me}${ge}`}})),(0,s.z)(Ke=>Le.handle(Ke))):Le.handle(we)}intercept(ge,we){if(!this.isAllowedDomain(ge)||this.isDisallowedRoute(ge))return we.handle(ge);const Le=this.tokenGetter(ge);return Ae(Le).pipe((0,s.z)(Me=>this.handleInterception(Me,ge,we)))}}return se.\u0275fac=function(ge){return new(ge||se)(v.LFG(w),v.LFG(fe),v.LFG(d.K0))},se.\u0275prov=v.Yz7({token:se,factory:se.\u0275fac}),se})(),X=(()=>{class se{constructor(ge){if(ge)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(ge){return{ngModule:se,providers:[{provide:W.TP,useClass:De,multi:!0},ge.jwtOptionsProvider||{provide:w,useValue:ge.config},fe]}}}return se.\u0275fac=function(ge){return new(ge||se)(v.LFG(se,12))},se.\u0275mod=v.oAB({type:se}),se.\u0275inj=v.cJS({}),se})()},2726:(zn,Ct,R)=>{"use strict";R.d(Ct,{Uw:()=>Le,fo:()=>Te});var v=R(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var w=(()=>((w=w||{}).Unimplemented="UNIMPLEMENTED",w.Unavailable="UNAVAILABLE",w))();class fe extends Error{constructor(Se,ye,Qt){super(Se),this.message=Se,this.code=ye,this.data=Qt}}const De=Ze=>{var Se,ye,Qt,dt,gt;const ct=Ze.CapacitorCustomPlatform||null,Ue=Ze.Capacitor||{},vt=Ue.Plugins=Ue.Plugins||{},je=Ze.CapacitorPlatforms,Ne=(null===(Se=je?.currentPlatform)||void 0===Se?void 0:Se.getPlatform)||(()=>null!==ct?ct.name:(Ze=>{var Se,ye;return Ze?.androidBridge?"android":null!==(ye=null===(Se=Ze?.webkit)||void 0===Se?void 0:Se.messageHandlers)&&void 0!==ye&&ye.bridge?"ios":"web"})(Ze)),Gt=(null===(ye=je?.currentPlatform)||void 0===ye?void 0:ye.isNativePlatform)||(()=>"web"!==Ne()),Xt=(null===(Qt=je?.currentPlatform)||void 0===Qt?void 0:Qt.isPluginAvailable)||(Sn=>{const Nt=at.get(Sn);return!(!Nt?.platforms.has(Ne())&&!sn(Sn))}),sn=(null===(dt=je?.currentPlatform)||void 0===dt?void 0:dt.getPluginHeader)||(Sn=>{var Nt;return null===(Nt=Ue.PluginHeaders)||void 0===Nt?void 0:Nt.find(yi=>yi.name===Sn)}),at=new Map,dn=(null===(gt=je?.currentPlatform)||void 0===gt?void 0:gt.registerPlugin)||((Sn,Nt={})=>{const yi=at.get(Sn);if(yi)return console.warn(`Capacitor plugin "${Sn}" already registered. Cannot register plugins twice.`),yi.proxy;const Gi=Ne(),gn=sn(Sn);let si;const Je=function(){var Un=(0,v.Z)(function*(){return!si&&Gi in Nt?si=si="function"==typeof Nt[Gi]?yield Nt[Gi]():Nt[Gi]:null!==ct&&!si&&"web"in Nt&&(si=si="function"==typeof Nt.web?yield Nt.web():Nt.web),si});return function(){return Un.apply(this,arguments)}}(),Zt=Un=>{let oi;const Ci=(...Oi)=>{const Po=Je().then(fi=>{const Vo=((Un,oi)=>{var Ci,Oi;if(!gn){if(Un)return null===(Oi=Un[oi])||void 0===Oi?void 0:Oi.bind(Un);throw new fe(`"${Sn}" plugin is not implemented on ${Gi}`,w.Unimplemented)}{const Po=gn?.methods.find(fi=>oi===fi.name);if(Po)return"promise"===Po.rtype?fi=>Ue.nativePromise(Sn,oi.toString(),fi):(fi,Vo)=>Ue.nativeCallback(Sn,oi.toString(),fi,Vo);if(Un)return null===(Ci=Un[oi])||void 0===Ci?void 0:Ci.bind(Un)}})(fi,Un);if(Vo){const ut=Vo(...Oi);return oi=ut?.remove,ut}throw new fe(`"${Sn}.${Un}()" is not implemented on ${Gi}`,w.Unimplemented)});return"addListener"===Un&&(Po.remove=(0,v.Z)(function*(){return oi()})),Po};return Ci.toString=()=>`${Un.toString()}() { [capacitor code] }`,Object.defineProperty(Ci,"name",{value:Un,writable:!1,configurable:!1}),Ci},un=Zt("addListener"),hn=Zt("removeListener"),gi=(Un,oi)=>{const Ci=un({eventName:Un},oi),Oi=function(){var fi=(0,v.Z)(function*(){const Vo=yield Ci;hn({eventName:Un,callbackId:Vo},oi)});return function(){return fi.apply(this,arguments)}}(),Po=new Promise(fi=>Ci.then(()=>fi({remove:Oi})));return Po.remove=(0,v.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield Oi()}),Po},Yt=new Proxy({},{get(Un,oi){switch(oi){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return gn?gi:un;case"removeListener":return hn;default:return Zt(oi)}}});return vt[Sn]=Yt,at.set(Sn,{name:Sn,proxy:Yt,platforms:new Set([...Object.keys(Nt),...gn?[Gi]:[]])}),Yt});return Ue.convertFileSrc||(Ue.convertFileSrc=Sn=>Sn),Ue.getPlatform=Ne,Ue.handleError=Sn=>Ze.console.error(Sn),Ue.isNativePlatform=Gt,Ue.isPluginAvailable=Xt,Ue.pluginMethodNoop=(Sn,Nt,yi)=>Promise.reject(`${yi} does not have an implementation of "${Nt}".`),Ue.registerPlugin=dn,Ue.Exception=fe,Ue.DEBUG=!!Ue.DEBUG,Ue.isLoggingEnabled=!!Ue.isLoggingEnabled,Ue.platform=Ue.getPlatform(),Ue.isNative=Ue.isNativePlatform(),Ue},se=(Ze=>Ze.Capacitor=De(Ze))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Te=se.registerPlugin;class Le{constructor(Se){this.listeners={},this.windowListeners={},Se&&(console.warn(`Capacitor WebPlugin "${Se.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=Se)}addListener(Se,ye){var Qt=this;this.listeners[Se]||(this.listeners[Se]=[]),this.listeners[Se].push(ye);const gt=this.windowListeners[Se];gt&&!gt.registered&&this.addWindowListener(gt);const ct=function(){var vt=(0,v.Z)(function*(){return Qt.removeListener(Se,ye)});return function(){return vt.apply(this,arguments)}}(),Ue=Promise.resolve({remove:ct});return Object.defineProperty(Ue,"remove",{value:(vt=(0,v.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield ct()}),function(){return vt.apply(this,arguments)})}),Ue;var vt}removeAllListeners(){var Se=this;return(0,v.Z)(function*(){Se.listeners={};for(const ye in Se.windowListeners)Se.removeWindowListener(Se.windowListeners[ye]);Se.windowListeners={}})()}notifyListeners(Se,ye){const Qt=this.listeners[Se];Qt&&Qt.forEach(dt=>dt(ye))}hasListeners(Se){return!!this.listeners[Se].length}registerWindowListener(Se,ye){this.windowListeners[ye]={registered:!1,windowEventName:Se,pluginEventName:ye,handler:Qt=>{this.notifyListeners(ye,Qt)}}}unimplemented(Se="not implemented"){return new se.Exception(Se,w.Unimplemented)}unavailable(Se="not available"){return new se.Exception(Se,w.Unavailable)}removeListener(Se,ye){var Qt=this;return(0,v.Z)(function*(){const dt=Qt.listeners[Se];if(!dt)return;const gt=dt.indexOf(ye);Qt.listeners[Se].splice(gt,1),Qt.listeners[Se].length||Qt.removeWindowListener(Qt.windowListeners[Se])})()}addWindowListener(Se){window.addEventListener(Se.windowEventName,Se.handler),Se.registered=!0}removeWindowListener(Se){Se&&(window.removeEventListener(Se.windowEventName,Se.handler),Se.registered=!1)}}const ze=Ze=>encodeURIComponent(Ze).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Ke=Ze=>Ze.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Oe extends Le{getCookies(){return(0,v.Z)(function*(){const Se=document.cookie,ye={};return Se.split(";").forEach(Qt=>{if(Qt.length<=0)return;let[dt,gt]=Qt.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");dt=Ke(dt).trim(),gt=Ke(gt).trim(),ye[dt]=gt}),ye})()}setCookie(Se){return(0,v.Z)(function*(){try{const ye=ze(Se.key),Qt=ze(Se.value),dt=`; expires=${(Se.expires||"").replace("expires=","")}`,gt=(Se.path||"/").replace("path=",""),ct=null!=Se.url&&Se.url.length>0?`domain=${Se.url}`:"";document.cookie=`${ye}=${Qt||""}${dt}; path=${gt}; ${ct};`}catch(ye){return Promise.reject(ye)}})()}deleteCookie(Se){return(0,v.Z)(function*(){try{document.cookie=`${Se.key}=; Max-Age=0`}catch(ye){return Promise.reject(ye)}})()}clearCookies(){return(0,v.Z)(function*(){try{const Se=document.cookie.split(";")||[];for(const ye of Se)document.cookie=ye.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(Se){return Promise.reject(Se)}})()}clearAllCookies(){var Se=this;return(0,v.Z)(function*(){try{yield Se.clearCookies()}catch(ye){return Promise.reject(ye)}})()}}Te("CapacitorCookies",{web:()=>new Oe});const nt=function(){var Ze=(0,v.Z)(function*(Se){return new Promise((ye,Qt)=>{const dt=new FileReader;dt.onload=()=>{const gt=dt.result;ye(gt.indexOf(",")>=0?gt.split(",")[1]:gt)},dt.onerror=gt=>Qt(gt),dt.readAsDataURL(Se)})});return function(ye){return Ze.apply(this,arguments)}}();class mt extends Le{request(Se){return(0,v.Z)(function*(){const ye=((Ze,Se={})=>{const ye=Object.assign({method:Ze.method||"GET",headers:Ze.headers},Se),dt=((Ze={})=>{const Se=Object.keys(Ze);return Object.keys(Ze).map(dt=>dt.toLocaleLowerCase()).reduce((dt,gt,ct)=>(dt[gt]=Ze[Se[ct]],dt),{})})(Ze.headers)["content-type"]||"";if("string"==typeof Ze.data)ye.body=Ze.data;else if(dt.includes("application/x-www-form-urlencoded")){const gt=new URLSearchParams;for(const[ct,Ue]of Object.entries(Ze.data||{}))gt.set(ct,Ue);ye.body=gt.toString()}else if(dt.includes("multipart/form-data")){const gt=new FormData;if(Ze.data instanceof FormData)Ze.data.forEach((Ue,vt)=>{gt.append(vt,Ue)});else for(const Ue of Object.keys(Ze.data))gt.append(Ue,Ze.data[Ue]);ye.body=gt;const ct=new Headers(ye.headers);ct.delete("content-type"),ye.headers=ct}else(dt.includes("application/json")||"object"==typeof Ze.data)&&(ye.body=JSON.stringify(Ze.data));return ye})(Se,Se.webFetchExtra),Qt=((Ze,Se=!0)=>Ze?Object.entries(Ze).reduce((Qt,dt)=>{const[gt,ct]=dt;let Ue,vt;return Array.isArray(ct)?(vt="",ct.forEach(je=>{Ue=Se?encodeURIComponent(je):je,vt+=`${gt}=${Ue}&`}),vt.slice(0,-1)):(Ue=Se?encodeURIComponent(ct):ct,vt=`${gt}=${Ue}`),`${Qt}&${vt}`},"").substr(1):null)(Se.params,Se.shouldEncodeUrlParams),dt=Qt?`${Se.url}?${Qt}`:Se.url,gt=yield fetch(dt,ye),ct=gt.headers.get("content-type")||"";let vt,je,{responseType:Ue="text"}=gt.ok?Se:{};switch(ct.includes("application/json")&&(Ue="json"),Ue){case"arraybuffer":case"blob":je=yield gt.blob(),vt=yield nt(je);break;case"json":vt=yield gt.json();break;default:vt=yield gt.text()}const _t={};return gt.headers.forEach((Ne,Ft)=>{_t[Ft]=Ne}),{data:vt,headers:_t,status:gt.status,url:gt.url}})()}get(Se){var ye=this;return(0,v.Z)(function*(){return ye.request(Object.assign(Object.assign({},Se),{method:"GET"}))})()}post(Se){var ye=this;return(0,v.Z)(function*(){return ye.request(Object.assign(Object.assign({},Se),{method:"POST"}))})()}put(Se){var ye=this;return(0,v.Z)(function*(){return ye.request(Object.assign(Object.assign({},Se),{method:"PUT"}))})()}patch(Se){var ye=this;return(0,v.Z)(function*(){return ye.request(Object.assign(Object.assign({},Se),{method:"PATCH"}))})()}delete(Se){var ye=this;return(0,v.Z)(function*(){return ye.request(Object.assign(Object.assign({},Se),{method:"DELETE"}))})()}}Te("CapacitorHttp",{web:()=>new mt})},6506:(zn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>we});var v=R(7643),d=R(544);let y;const Q=Le=>Le.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),ie=Le=>(void 0===y&&(y=void 0===Le.style.animationName&&void 0!==Le.style.webkitAnimationName?"-webkit-":""),y),W=(Le,Me,ze)=>{const Ke=Me.startsWith("animation")?ie(Le):"";Le.style.setProperty(Ke+Me,ze)},w=(Le,Me)=>{const ze=Me.startsWith("animation")?ie(Le):"";Le.style.removeProperty(ze+Me)},De=[],ge=(Le=[],Me)=>{if(void 0!==Me){const ze=Array.isArray(Me)?Me:[Me];return[...Le,...ze]}return Le},we=Le=>{let Me,ze,Ke,Oe,Ce,nt,xe,Ue,vt,je,_t,wn,Xt,Xe=[],Ee=[],ae=[],mt=!1,Ze={},Se=[],ye=[],Qt={},dt=0,gt=!1,ct=!1,Ne=!0,Ft=!1,Gt=!0,mn=!1;const sn=Le,Vt=[],It=[],at=[],Wt=[],dn=[],Sn=[],Nt=[],yi=[],Gi=[],gn=[],si="function"==typeof AnimationEffect||void 0!==v.w&&"function"==typeof v.w.AnimationEffect,Je="function"==typeof Element&&"function"==typeof Element.prototype.animate&&si,Zt=()=>gn,Un=(ke,it)=>((it?.oneTimeCallback?It:Vt).push({c:ke,o:it}),Xt),Ci=()=>{if(Je)gn.forEach(ke=>{ke.cancel()}),gn.length=0;else{const ke=at.slice();(0,d.r)(()=>{ke.forEach(it=>{w(it,"animation-name"),w(it,"animation-duration"),w(it,"animation-timing-function"),w(it,"animation-iteration-count"),w(it,"animation-delay"),w(it,"animation-play-state"),w(it,"animation-fill-mode"),w(it,"animation-direction")})})}},Oi=()=>{dn.forEach(ke=>{ke?.parentNode&&ke.parentNode.removeChild(ke)}),dn.length=0},Kt=()=>void 0!==Ce?Ce:xe?xe.getFill():"both",In=()=>void 0!==vt?vt:void 0!==nt?nt:xe?xe.getDirection():"normal",tt=()=>gt?"linear":void 0!==Ke?Ke:xe?xe.getEasing():"linear",Ve=()=>ct?0:void 0!==je?je:void 0!==ze?ze:xe?xe.getDuration():0,Y=()=>void 0!==Oe?Oe:xe?xe.getIterations():1,me=()=>void 0!==_t?_t:void 0!==Me?Me:xe?xe.getDelay():0,ri=()=>{0!==dt&&(dt--,0===dt&&((()=>{Ji(),yi.forEach(yn=>yn()),Gi.forEach(yn=>yn());const ke=Ne?1:0,it=Se,Bt=ye,zt=Qt;at.forEach(yn=>{const Tn=yn.classList;it.forEach(xn=>Tn.add(xn)),Bt.forEach(xn=>Tn.remove(xn));for(const xn in zt)zt.hasOwnProperty(xn)&&W(yn,xn,zt[xn])}),Vt.forEach(yn=>yn.c(ke,Xt)),It.forEach(yn=>yn.c(ke,Xt)),It.length=0,Gt=!0,Ne&&(Ft=!0),Ne=!0})(),xe&&xe.animationFinish()))},ni=(ke=!0)=>{Oi();const it=(Le=>(Le.forEach(Me=>{for(const ze in Me)if(Me.hasOwnProperty(ze)){const Ke=Me[ze];if("easing"===ze)Me["animation-timing-function"]=Ke,delete Me[ze];else{const Oe=Q(ze);Oe!==ze&&(Me[Oe]=Ke,delete Me[ze])}}}),Le))(Xe);at.forEach(Bt=>{if(it.length>0){const zt=((Le=[])=>Le.map(Me=>{const ze=Me.offset,Ke=[];for(const Oe in Me)Me.hasOwnProperty(Oe)&&"offset"!==Oe&&Ke.push(`${Oe}: ${Me[Oe]};`);return`${100*ze}% { ${Ke.join(" ")} }`}).join(" "))(it);wn=void 0!==Le?Le:(Le=>{let Me=De.indexOf(Le);return Me<0&&(Me=De.push(Le)-1),`ion-animation-${Me}`})(zt);const yn=((Le,Me,ze)=>{var Ke;const Oe=(Le=>{const Me=void 0!==Le.getRootNode?Le.getRootNode():Le;return Me.head||Me})(ze),Ce=ie(ze),nt=Oe.querySelector("#"+Le);if(nt)return nt;const Xe=(null!==(Ke=ze.ownerDocument)&&void 0!==Ke?Ke:document).createElement("style");return Xe.id=Le,Xe.textContent=`@${Ce}keyframes ${Le} { ${Me} } @${Ce}keyframes ${Le}-alt { ${Me} }`,Oe.appendChild(Xe),Xe})(wn,zt,Bt);dn.push(yn),W(Bt,"animation-duration",`${Ve()}ms`),W(Bt,"animation-timing-function",tt()),W(Bt,"animation-delay",`${me()}ms`),W(Bt,"animation-fill-mode",Kt()),W(Bt,"animation-direction",In());const Tn=Y()===1/0?"infinite":Y().toString();W(Bt,"animation-iteration-count",Tn),W(Bt,"animation-play-state","paused"),ke&&W(Bt,"animation-name",`${yn.id}-alt`),(0,d.r)(()=>{W(Bt,"animation-name",yn.id||null)})}})},wi=(ke=!0)=>{(()=>{Sn.forEach(zt=>zt()),Nt.forEach(zt=>zt());const ke=Ee,it=ae,Bt=Ze;at.forEach(zt=>{const yn=zt.classList;ke.forEach(Tn=>yn.add(Tn)),it.forEach(Tn=>yn.remove(Tn));for(const Tn in Bt)Bt.hasOwnProperty(Tn)&&W(zt,Tn,Bt[Tn])})})(),Xe.length>0&&(Je?(at.forEach(ke=>{const it=ke.animate(Xe,{id:sn,delay:me(),duration:Ve(),easing:tt(),iterations:Y(),fill:Kt(),direction:In()});it.pause(),gn.push(it)}),gn.length>0&&(gn[0].onfinish=()=>{ri()})):ni(ke)),mt=!0},mo=ke=>{if(ke=Math.min(Math.max(ke,0),.9999),Je)gn.forEach(it=>{it.currentTime=it.effect.getComputedTiming().delay+Ve()*ke,it.pause()});else{const it=`-${Ve()*ke}ms`;at.forEach(Bt=>{Xe.length>0&&(W(Bt,"animation-delay",it),W(Bt,"animation-play-state","paused"))})}},Ao=ke=>{gn.forEach(it=>{it.effect.updateTiming({delay:me(),duration:Ve(),easing:tt(),iterations:Y(),fill:Kt(),direction:In()})}),void 0!==ke&&mo(ke)},Go=(ke=!0,it)=>{(0,d.r)(()=>{at.forEach(Bt=>{W(Bt,"animation-name",wn||null),W(Bt,"animation-duration",`${Ve()}ms`),W(Bt,"animation-timing-function",tt()),W(Bt,"animation-delay",void 0!==it?`-${it*Ve()}ms`:`${me()}ms`),W(Bt,"animation-fill-mode",Kt()||null),W(Bt,"animation-direction",In()||null);const zt=Y()===1/0?"infinite":Y().toString();W(Bt,"animation-iteration-count",zt),ke&&W(Bt,"animation-name",`${wn}-alt`),(0,d.r)(()=>{W(Bt,"animation-name",wn||null)})})})},co=(ke=!1,it=!0,Bt)=>(ke&&Wt.forEach(zt=>{zt.update(ke,it,Bt)}),Je?Ao(Bt):Go(it,Bt),Xt),en=()=>{mt&&(Je?gn.forEach(ke=>{ke.pause()}):at.forEach(ke=>{W(ke,"animation-play-state","paused")}),mn=!0)},vo=()=>{Ue=void 0,ri()},Ji=()=>{Ue&&clearTimeout(Ue)},kr=ke=>new Promise(it=>{ke?.sync&&(ct=!0,Un(()=>ct=!1,{oneTimeCallback:!0})),mt||wi(),Ft&&(Je?(mo(0),Ao()):Go(),Ft=!1),Gt&&(dt=Wt.length+1,Gt=!1),Un(()=>it(),{oneTimeCallback:!0}),Wt.forEach(Bt=>{Bt.play()}),Je?(gn.forEach(ke=>{ke.play()}),(0===Xe.length||0===at.length)&&ri()):(()=>{if(Ji(),(0,d.r)(()=>{at.forEach(ke=>{Xe.length>0&&W(ke,"animation-play-state","running")})}),0===Xe.length||0===at.length)ri();else{const ke=me()||0,it=Ve()||0,Bt=Y()||1;isFinite(Bt)&&(Ue=setTimeout(vo,ke+it*Bt+100)),((Le,Me)=>{let ze;const Ke={passive:!0},Ce=nt=>{Le===nt.target&&(ze&&ze(),Ji(),(0,d.r)(()=>{at.forEach(ke=>{w(ke,"animation-duration"),w(ke,"animation-delay"),w(ke,"animation-play-state")}),(0,d.r)(ri)}))};Le&&(Le.addEventListener("webkitAnimationEnd",Ce,Ke),Le.addEventListener("animationend",Ce,Ke),ze=()=>{Le.removeEventListener("webkitAnimationEnd",Ce,Ke),Le.removeEventListener("animationend",Ce,Ke)})})(at[0])}})(),mn=!1}),Vi=(ke,it)=>{const Bt=Xe[0];return void 0===Bt||void 0!==Bt.offset&&0!==Bt.offset?Xe=[{offset:0,[ke]:it},...Xe]:Bt[ke]=it,Xt};return Xt={parentAnimation:xe,elements:at,childAnimations:Wt,id:sn,animationFinish:ri,from:Vi,to:(ke,it)=>{const Bt=Xe[Xe.length-1];return void 0===Bt||void 0!==Bt.offset&&1!==Bt.offset?Xe=[...Xe,{offset:1,[ke]:it}]:Bt[ke]=it,Xt},fromTo:(ke,it,Bt)=>Vi(ke,it).to(ke,Bt),parent:ke=>(xe=ke,Xt),play:kr,pause:()=>(Wt.forEach(ke=>{ke.pause()}),en(),Xt),stop:()=>{Wt.forEach(ke=>{ke.stop()}),mt&&(Ci(),mt=!1),gt=!1,ct=!1,Gt=!0,vt=void 0,je=void 0,_t=void 0,dt=0,Ft=!1,Ne=!0,mn=!1},destroy:ke=>(Wt.forEach(it=>{it.destroy(ke)}),(ke=>{Ci(),ke&&Oi()})(ke),at.length=0,Wt.length=0,Xe.length=0,Vt.length=0,It.length=0,mt=!1,Gt=!0,Xt),keyframes:ke=>{const it=Xe!==ke;return Xe=ke,it&&(ke=>{Je?Zt().forEach(it=>{if(it.effect.setKeyframes)it.effect.setKeyframes(ke);else{const Bt=new KeyframeEffect(it.effect.target,ke,it.effect.getTiming());it.effect=Bt}}):ni()})(Xe),Xt},addAnimation:ke=>{if(null!=ke)if(Array.isArray(ke))for(const it of ke)it.parent(Xt),Wt.push(it);else ke.parent(Xt),Wt.push(ke);return Xt},addElement:ke=>{if(null!=ke)if(1===ke.nodeType)at.push(ke);else if(ke.length>=0)for(let it=0;it<ke.length;it++)at.push(ke[it]);else console.error("Invalid addElement value");return Xt},update:co,fill:ke=>(Ce=ke,co(!0),Xt),direction:ke=>(nt=ke,co(!0),Xt),iterations:ke=>(Oe=ke,co(!0),Xt),duration:ke=>(!Je&&0===ke&&(ke=1),ze=ke,co(!0),Xt),easing:ke=>(Ke=ke,co(!0),Xt),delay:ke=>(Me=ke,co(!0),Xt),getWebAnimations:Zt,getKeyframes:()=>Xe,getFill:Kt,getDirection:In,getDelay:me,getIterations:Y,getEasing:tt,getDuration:Ve,afterAddRead:ke=>(yi.push(ke),Xt),afterAddWrite:ke=>(Gi.push(ke),Xt),afterClearStyles:(ke=[])=>{for(const it of ke)Qt[it]="";return Xt},afterStyles:(ke={})=>(Qt=ke,Xt),afterRemoveClass:ke=>(ye=ge(ye,ke),Xt),afterAddClass:ke=>(Se=ge(Se,ke),Xt),beforeAddRead:ke=>(Sn.push(ke),Xt),beforeAddWrite:ke=>(Nt.push(ke),Xt),beforeClearStyles:(ke=[])=>{for(const it of ke)Ze[it]="";return Xt},beforeStyles:(ke={})=>(Ze=ke,Xt),beforeRemoveClass:ke=>(ae=ge(ae,ke),Xt),beforeAddClass:ke=>(Ee=ge(Ee,ke),Xt),onFinish:Un,isRunning:()=>0!==dt&&!mn,progressStart:(ke=!1,it)=>(Wt.forEach(Bt=>{Bt.progressStart(ke,it)}),en(),gt=ke,mt||wi(),co(!1,!0,it),Xt),progressStep:ke=>(Wt.forEach(it=>{it.progressStep(ke)}),mo(ke),Xt),progressEnd:(ke,it,Bt)=>(gt=!1,Wt.forEach(zt=>{zt.progressEnd(ke,it,Bt)}),void 0!==Bt&&(je=Bt),Ft=!1,Ne=!0,0===ke?(vt="reverse"===In()?"normal":"reverse","reverse"===vt&&(Ne=!1),Je?(co(),mo(1-it)):(_t=(1-it)*Ve()*-1,co(!1,!1))):1===ke&&(Je?(co(),mo(it)):(_t=it*Ve()*-1,co(!1,!1))),void 0!==ke&&(Un(()=>{je=void 0,vt=void 0,_t=void 0},{oneTimeCallback:!0}),xe||kr()),Xt)}}},1273:(zn,Ct,R)=>{"use strict";R.d(Ct,{E:()=>Ae,a:()=>v,s:()=>w});const v=De=>{try{if(De instanceof W)return De.value;if(!s()||"string"!=typeof De||""===De)return De;if(De.includes("onload="))return"";const X=document.createDocumentFragment(),se=document.createElement("div");X.appendChild(se),se.innerHTML=De,ie.forEach(Le=>{const Me=X.querySelectorAll(Le);for(let ze=Me.length-1;ze>=0;ze--){const Ke=Me[ze];Ke.parentNode?Ke.parentNode.removeChild(Ke):X.removeChild(Ke);const Oe=y(Ke);for(let Ce=0;Ce<Oe.length;Ce++)d(Oe[Ce])}});const Te=y(X);for(let Le=0;Le<Te.length;Le++)d(Te[Le]);const ge=document.createElement("div");ge.appendChild(X);const we=ge.querySelector("div");return null!==we?we.innerHTML:ge.innerHTML}catch(X){return console.error(X),""}},d=De=>{if(De.nodeType&&1!==De.nodeType)return;if(typeof NamedNodeMap<"u"&&!(De.attributes instanceof NamedNodeMap))return void De.remove();for(let se=De.attributes.length-1;se>=0;se--){const Te=De.attributes.item(se),ge=Te.name;if(!Q.includes(ge.toLowerCase())){De.removeAttribute(ge);continue}const we=Te.value,Le=De[ge];(null!=we&&we.toLowerCase().includes("javascript:")||null!=Le&&Le.toLowerCase().includes("javascript:"))&&De.removeAttribute(ge)}const X=y(De);for(let se=0;se<X.length;se++)d(X[se])},y=De=>null!=De.children?De.children:De.childNodes,s=()=>{var De;const X=window,se=null===(De=X?.Ionic)||void 0===De?void 0:De.config;return!se||(se.get?se.get("sanitizerEnabled",!0):!0===se.sanitizerEnabled||void 0===se.sanitizerEnabled)},Q=["class","id","href","src","name","slot"],ie=["script","style","iframe","meta","link","object","embed"];class W{constructor(X){this.value=X}}const w=De=>{const X=window,se=X.Ionic;if(!se||!se.config||"Object"===se.config.constructor.name)return X.Ionic=X.Ionic||{},X.Ionic.config=Object.assign(Object.assign({},X.Ionic.config),De),X.Ionic.config},Ae=!1},9439:(zn,Ct,R)=>{"use strict";R.d(Ct,{C:()=>Q,a:()=>y,d:()=>s});var v=R(5861),d=R(544);const y=function(){var ie=(0,v.Z)(function*(W,w,fe,Ae,De,X){var se;if(W)return W.attachViewToDom(w,fe,De,Ae);if(!(X||"string"==typeof fe||fe instanceof HTMLElement))throw new Error("framework delegate is missing");const Te="string"==typeof fe?null===(se=w.ownerDocument)||void 0===se?void 0:se.createElement(fe):fe;return Ae&&Ae.forEach(ge=>Te.classList.add(ge)),De&&Object.assign(Te,De),w.appendChild(Te),yield new Promise(ge=>(0,d.c)(Te,ge)),Te});return function(w,fe,Ae,De,X,se){return ie.apply(this,arguments)}}(),s=(ie,W)=>{if(W){if(ie)return ie.removeViewFromDom(W.parentElement,W);W.remove()}return Promise.resolve()},Q=()=>{let ie,W;return{attachViewToDom:function(){var Ae=(0,v.Z)(function*(De,X,se={},Te=[]){var ge,we;if(ie=De,X){const Me="string"==typeof X?null===(ge=ie.ownerDocument)||void 0===ge?void 0:ge.createElement(X):X;Te.forEach(ze=>Me.classList.add(ze)),Object.assign(Me,se),ie.appendChild(Me),yield new Promise(ze=>(0,d.c)(Me,ze))}else if(ie.children.length>0&&("ION-MODAL"===ie.tagName||"ION-POPOVER"===ie.tagName)&&!ie.children[0].classList.contains("ion-delegate-host")){const ze=null===(we=ie.ownerDocument)||void 0===we?void 0:we.createElement("div");ze.classList.add("ion-delegate-host"),Te.forEach(Ke=>ze.classList.add(Ke)),ze.append(...ie.children),ie.appendChild(ze)}const Le=document.querySelector("ion-app")||document.body;return W=document.createComment("ionic teleport"),ie.parentNode.insertBefore(W,ie),Le.appendChild(ie),ie});return function(X,se){return Ae.apply(this,arguments)}}(),removeViewFromDom:()=>(ie&&W&&(W.parentNode.insertBefore(ie,W),W.remove()),Promise.resolve())}}},4587:(zn,Ct,R)=>{"use strict";R.d(Ct,{G:()=>Q});class d{constructor(W,w,fe,Ae,De){this.id=w,this.name=fe,this.disableScroll=De,this.priority=1e6*Ae+w,this.ctrl=W}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const W=this.ctrl.capture(this.name,this.id,this.priority);return W&&this.disableScroll&&this.ctrl.disableScroll(this.id),W}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class y{constructor(W,w,fe,Ae){this.id=w,this.disable=fe,this.disableScroll=Ae,this.ctrl=W}block(){if(this.ctrl){if(this.disable)for(const W of this.disable)this.ctrl.disableGesture(W,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const W of this.disable)this.ctrl.enableGesture(W,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const s="backdrop-no-scroll",Q=new class v{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(W){var w;return new d(this,this.newID(),W.name,null!==(w=W.priority)&&void 0!==w?w:0,!!W.disableScroll)}createBlocker(W={}){return new y(this,this.newID(),W.disable,!!W.disableScroll)}start(W,w,fe){return this.canStart(W)?(this.requestedStart.set(w,fe),!0):(this.requestedStart.delete(w),!1)}capture(W,w,fe){if(!this.start(W,w,fe))return!1;const Ae=this.requestedStart;let De=-1e4;if(Ae.forEach(X=>{De=Math.max(De,X)}),De===fe){this.capturedId=w,Ae.clear();const X=new CustomEvent("ionGestureCaptured",{detail:{gestureName:W}});return document.dispatchEvent(X),!0}return Ae.delete(w),!1}release(W){this.requestedStart.delete(W),this.capturedId===W&&(this.capturedId=void 0)}disableGesture(W,w){let fe=this.disabledGestures.get(W);void 0===fe&&(fe=new Set,this.disabledGestures.set(W,fe)),fe.add(w)}enableGesture(W,w){const fe=this.disabledGestures.get(W);void 0!==fe&&fe.delete(w)}disableScroll(W){this.disabledScroll.add(W),1===this.disabledScroll.size&&document.body.classList.add(s)}enableScroll(W){this.disabledScroll.delete(W),0===this.disabledScroll.size&&document.body.classList.remove(s)}canStart(W){return!(void 0!==this.capturedId||this.isDisabled(W))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(W){const w=this.disabledGestures.get(W);return!!(w&&w.size>0)}newID(){return this.gestureId++,this.gestureId}}},5421:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{MENU_BACK_BUTTON_PRIORITY:()=>Q,OVERLAY_BACK_BUTTON_PRIORITY:()=>s,blockHardwareBackButton:()=>d,startHardwareBackButton:()=>y});var v=R(5861);const d=()=>{document.addEventListener("backbutton",()=>{})},y=()=>{const ie=document;let W=!1;ie.addEventListener("backbutton",()=>{if(W)return;let w=0,fe=[];const Ae=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(se,Te){fe.push({priority:se,handler:Te,id:w++})}}});ie.dispatchEvent(Ae);const De=function(){var se=(0,v.Z)(function*(Te){try{if(Te?.handler){const ge=Te.handler(X);null!=ge&&(yield ge)}}catch(ge){console.error(ge)}});return function(ge){return se.apply(this,arguments)}}(),X=()=>{if(fe.length>0){let se={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};fe.forEach(Te=>{Te.priority>=se.priority&&(se=Te)}),W=!0,fe=fe.filter(Te=>Te.id!==se.id),De(se).then(()=>W=!1)}};X()})},s=100,Q=99},544:(zn,Ct,R)=>{"use strict";R.d(Ct,{a:()=>w,b:()=>fe,c:()=>y,d:()=>we,e:()=>ge,f:()=>Te,g:()=>Ae,h:()=>se,i:()=>W,j:()=>Ce,k:()=>Q,l:()=>Le,m:()=>s,n:()=>X,o:()=>Me,p:()=>Oe,q:()=>nt,r:()=>De,s:()=>Xe,t:()=>v,u:()=>ze,v:()=>Ke});const v=(Ee,ae=0)=>new Promise(mt=>{d(Ee,ae,mt)}),d=(Ee,ae=0,mt)=>{let xe,Ze;const Se={passive:!0},Qt=()=>{xe&&xe()},dt=gt=>{(void 0===gt||Ee===gt.target)&&(Qt(),mt(gt))};return Ee&&(Ee.addEventListener("webkitTransitionEnd",dt,Se),Ee.addEventListener("transitionend",dt,Se),Ze=setTimeout(dt,ae+500),xe=()=>{Ze&&(clearTimeout(Ze),Ze=void 0),Ee.removeEventListener("webkitTransitionEnd",dt,Se),Ee.removeEventListener("transitionend",dt,Se)}),Qt},y=(Ee,ae)=>{Ee.componentOnReady?Ee.componentOnReady().then(mt=>ae(mt)):De(()=>ae(Ee))},s=Ee=>void 0!==Ee.componentOnReady,Q=(Ee,ae=[])=>{const mt={};return ae.forEach(xe=>{Ee.hasAttribute(xe)&&(null!==Ee.getAttribute(xe)&&(mt[xe]=Ee.getAttribute(xe)),Ee.removeAttribute(xe))}),mt},ie=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],W=(Ee,ae)=>{let mt=ie;return ae&&ae.length>0&&(mt=mt.filter(xe=>!ae.includes(xe))),Q(Ee,mt)},w=(Ee,ae,mt,xe)=>{var Ze;if(typeof window<"u"){const Se=window,ye=null===(Ze=Se?.Ionic)||void 0===Ze?void 0:Ze.config;if(ye){const Qt=ye.get("_ael");if(Qt)return Qt(Ee,ae,mt,xe);if(ye._ael)return ye._ael(Ee,ae,mt,xe)}}return Ee.addEventListener(ae,mt,xe)},fe=(Ee,ae,mt,xe)=>{var Ze;if(typeof window<"u"){const Se=window,ye=null===(Ze=Se?.Ionic)||void 0===Ze?void 0:Ze.config;if(ye){const Qt=ye.get("_rel");if(Qt)return Qt(Ee,ae,mt,xe);if(ye._rel)return ye._rel(Ee,ae,mt,xe)}}return Ee.removeEventListener(ae,mt,xe)},Ae=(Ee,ae=Ee)=>Ee.shadowRoot||ae,De=Ee=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Ee):"function"==typeof requestAnimationFrame?requestAnimationFrame(Ee):setTimeout(Ee),X=Ee=>!!Ee.shadowRoot&&!!Ee.attachShadow,se=Ee=>{const ae=Ee.closest("ion-item");return ae?ae.querySelector("ion-label"):null},Te=Ee=>{if(Ee.focus(),Ee.classList.contains("ion-focusable")){const ae=Ee.closest("ion-app");ae&&ae.setFocus([Ee])}},ge=(Ee,ae)=>{let mt;const xe=Ee.getAttribute("aria-labelledby"),Ze=Ee.id;let Se=null!==xe&&""!==xe.trim()?xe:ae+"-lbl",ye=null!==xe&&""!==xe.trim()?document.getElementById(xe):se(Ee);return ye?(null===xe&&(ye.id=Se),mt=ye.textContent,ye.setAttribute("aria-hidden","true")):""!==Ze.trim()&&(ye=document.querySelector(`label[for="${Ze}"]`),ye&&(""!==ye.id?Se=ye.id:ye.id=Se=`${Ze}-lbl`,mt=ye.textContent)),{label:ye,labelId:Se,labelText:mt}},we=(Ee,ae,mt,xe,Ze)=>{if(Ee||X(ae)){let Se=ae.querySelector("input.aux-input");Se||(Se=ae.ownerDocument.createElement("input"),Se.type="hidden",Se.classList.add("aux-input"),ae.appendChild(Se)),Se.disabled=Ze,Se.name=mt,Se.value=xe||""}},Le=(Ee,ae,mt)=>Math.max(Ee,Math.min(ae,mt)),Me=(Ee,ae)=>{if(!Ee){const mt="ASSERT: "+ae;throw console.error(mt),new Error(mt)}},ze=Ee=>Ee.timeStamp||Date.now(),Ke=Ee=>{if(Ee){const ae=Ee.changedTouches;if(ae&&ae.length>0){const mt=ae[0];return{x:mt.clientX,y:mt.clientY}}if(void 0!==Ee.pageX)return{x:Ee.pageX,y:Ee.pageY}}return{x:0,y:0}},Oe=Ee=>{const ae="rtl"===document.dir;switch(Ee){case"start":return ae;case"end":return!ae;default:throw new Error(`"${Ee}" is not a valid value for [side]. Use "start" or "end" instead.`)}},Ce=(Ee,ae)=>{const mt=Ee._original||Ee;return{_original:Ee,emit:nt(mt.emit.bind(mt),ae)}},nt=(Ee,ae=0)=>{let mt;return(...xe)=>{clearTimeout(mt),mt=setTimeout(Ee,ae,...xe)}},Xe=(Ee,ae)=>{if(Ee??(Ee={}),ae??(ae={}),Ee===ae)return!0;const mt=Object.keys(Ee);if(mt.length!==Object.keys(ae).length)return!1;for(const xe of mt)if(!(xe in ae)||Ee[xe]!==ae[xe])return!1;return!0}},6953:(zn,Ct,R)=>{"use strict";R.d(Ct,{B:()=>De,H:()=>Qt,a:()=>uo,b:()=>Si,c:()=>Ft,d:()=>mn,e:()=>ei,f:()=>Xt,g:()=>Gt,h:()=>Se,i:()=>St,j:()=>X,p:()=>Qo,r:()=>Pn,w:()=>Vi});var v=R(5861);let y,s,Q,ie=!1,W=!1,w=!1,fe=!1,Ae=!1;const De={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},X=_e=>{const st=new URL(_e,Pi.$resourcesUrl$);return st.origin!==co.location.origin?st.href:st.pathname},ze="s-id",Ke="sty-id",nt="http://www.w3.org/1999/xlink",Xe={},xe=_e=>"object"==(_e=typeof _e)||"function"===_e;function Ze(_e){var st,ke,it;return null!==(it=null===(ke=null===(st=_e.head)||void 0===st?void 0:st.querySelector('meta[name="csp-nonce"]'))||void 0===ke?void 0:ke.getAttribute("content"))&&void 0!==it?it:void 0}const Se=(_e,st,...ke)=>{let it=null,Bt=null,zt=null,yn=!1,Tn=!1;const xn=[],On=Ii=>{for(let zi=0;zi<Ii.length;zi++)it=Ii[zi],Array.isArray(it)?On(it):null!=it&&"boolean"!=typeof it&&((yn="function"!=typeof _e&&!xe(it))&&(it=String(it)),yn&&Tn?xn[xn.length-1].$text$+=it:xn.push(yn?ye(null,it):it),Tn=yn)};if(On(ke),st){st.key&&(Bt=st.key),st.name&&(zt=st.name);{const Ii=st.className||st.class;Ii&&(st.class="object"!=typeof Ii?Ii:Object.keys(Ii).filter(zi=>Ii[zi]).join(" "))}}if("function"==typeof _e)return _e(null===st?{}:st,xn,gt);const hi=ye(_e,null);return hi.$attrs$=st,xn.length>0&&(hi.$children$=xn),hi.$key$=Bt,hi.$name$=zt,hi},ye=(_e,st)=>({$flags$:0,$tag$:_e,$text$:st,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),Qt={},gt={forEach:(_e,st)=>_e.map(ct).forEach(st),map:(_e,st)=>_e.map(ct).map(st).map(Ue)},ct=_e=>({vattrs:_e.$attrs$,vchildren:_e.$children$,vkey:_e.$key$,vname:_e.$name$,vtag:_e.$tag$,vtext:_e.$text$}),Ue=_e=>{if("function"==typeof _e.vtag){const ke=Object.assign({},_e.vattrs);return _e.vkey&&(ke.key=_e.vkey),_e.vname&&(ke.name=_e.vname),Se(_e.vtag,ke,..._e.vchildren||[])}const st=ye(_e.vtag,_e.vtext);return st.$attrs$=_e.vattrs,st.$children$=_e.vchildren,st.$key$=_e.vkey,st.$name$=_e.vname,st},je=(_e,st,ke,it,Bt,zt,yn)=>{let Tn,xn,On,hi;if(1===zt.nodeType){for(Tn=zt.getAttribute("c-id"),Tn&&(xn=Tn.split("."),(xn[0]===yn||"0"===xn[0])&&(On={$flags$:0,$hostId$:xn[0],$nodeId$:xn[1],$depth$:xn[2],$index$:xn[3],$tag$:zt.tagName.toLowerCase(),$elm$:zt,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},st.push(On),zt.removeAttribute("c-id"),_e.$children$||(_e.$children$=[]),_e.$children$[On.$index$]=On,_e=On,it&&"0"===On.$depth$&&(it[On.$index$]=On.$elm$))),hi=zt.childNodes.length-1;hi>=0;hi--)je(_e,st,ke,it,Bt,zt.childNodes[hi],yn);if(zt.shadowRoot)for(hi=zt.shadowRoot.childNodes.length-1;hi>=0;hi--)je(_e,st,ke,it,Bt,zt.shadowRoot.childNodes[hi],yn)}else if(8===zt.nodeType)xn=zt.nodeValue.split("."),(xn[1]===yn||"0"===xn[1])&&(Tn=xn[0],On={$flags$:0,$hostId$:xn[1],$nodeId$:xn[2],$depth$:xn[3],$index$:xn[4],$elm$:zt,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===Tn?(On.$elm$=zt.nextSibling,On.$elm$&&3===On.$elm$.nodeType&&(On.$text$=On.$elm$.textContent,st.push(On),zt.remove(),_e.$children$||(_e.$children$=[]),_e.$children$[On.$index$]=On,it&&"0"===On.$depth$&&(it[On.$index$]=On.$elm$))):On.$hostId$===yn&&("s"===Tn?(On.$tag$="slot",zt["s-sn"]=xn[5]?On.$name$=xn[5]:"",zt["s-sr"]=!0,it&&(On.$elm$=io.createElement(On.$tag$),On.$name$&&On.$elm$.setAttribute("name",On.$name$),zt.parentNode.insertBefore(On.$elm$,zt),zt.remove(),"0"===On.$depth$&&(it[On.$index$]=On.$elm$)),ke.push(On),_e.$children$||(_e.$children$=[]),_e.$children$[On.$index$]=On):"r"===Tn&&(it?zt.remove():(Bt["s-cr"]=zt,zt["s-cn"]=!0))));else if(_e&&"style"===_e.$tag$){const Ii=ye(null,zt.textContent);Ii.$elm$=zt,Ii.$index$="0",_e.$children$=[Ii]}},_t=(_e,st)=>{if(1===_e.nodeType){let ke=0;for(;ke<_e.childNodes.length;ke++)_t(_e.childNodes[ke],st);if(_e.shadowRoot)for(ke=0;ke<_e.shadowRoot.childNodes.length;ke++)_t(_e.shadowRoot.childNodes[ke],st)}else if(8===_e.nodeType){const ke=_e.nodeValue.split(".");"o"===ke[0]&&(st.set(ke[1]+"."+ke[2],_e),_e.nodeValue="",_e["s-en"]=ke[3])}},Ft=_e=>Go.push(_e),Gt=_e=>Nn(_e).$modeName$,Xt=_e=>Nn(_e).$hostElement$,mn=(_e,st,ke)=>{const it=Xt(_e);return{emit:Bt=>sn(it,st,{bubbles:!!(4&ke),composed:!!(2&ke),cancelable:!!(1&ke),detail:Bt})}},sn=(_e,st,ke)=>{const it=Pi.ce(st,ke);return _e.dispatchEvent(it),it},Vt=new WeakMap,It=(_e,st,ke)=>{let it=Ao.get(_e);vo&&ke?(it=it||new CSSStyleSheet,"string"==typeof it?it=st:it.replaceSync(st)):it=st,Ao.set(_e,it)},at=(_e,st,ke,it)=>{var Bt;let zt=dn(st,ke);const yn=Ao.get(zt);if(_e=11===_e.nodeType?_e:io,yn)if("string"==typeof yn){let xn,Tn=Vt.get(_e=_e.head||_e);if(Tn||Vt.set(_e,Tn=new Set),!Tn.has(zt)){if(_e.host&&(xn=_e.querySelector(`[${Ke}="${zt}"]`)))xn.innerHTML=yn;else{xn=io.createElement("style"),xn.innerHTML=yn;const On=null!==(Bt=Pi.$nonce$)&&void 0!==Bt?Bt:Ze(io);null!=On&&xn.setAttribute("nonce",On),_e.insertBefore(xn,_e.querySelector("link"))}Tn&&Tn.add(zt)}}else _e.adoptedStyleSheets.includes(yn)||(_e.adoptedStyleSheets=[..._e.adoptedStyleSheets,yn]);return zt},dn=(_e,st)=>"sc-"+(st&&32&_e.$flags$?_e.$tagName$+"-"+st:_e.$tagName$),Sn=_e=>_e.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),Nt=(_e,st,ke,it,Bt,zt)=>{if(ke!==it){let yn=ni(_e,st),Tn=st.toLowerCase();if("class"===st){const xn=_e.classList,On=Gi(ke),hi=Gi(it);xn.remove(...On.filter(Ii=>Ii&&!hi.includes(Ii))),xn.add(...hi.filter(Ii=>Ii&&!On.includes(Ii)))}else if("style"===st){for(const xn in ke)(!it||null==it[xn])&&(xn.includes("-")?_e.style.removeProperty(xn):_e.style[xn]="");for(const xn in it)(!ke||it[xn]!==ke[xn])&&(xn.includes("-")?_e.style.setProperty(xn,it[xn]):_e.style[xn]=it[xn])}else if("key"!==st)if("ref"===st)it&&it(_e);else if(yn||"o"!==st[0]||"n"!==st[1]){const xn=xe(it);if((yn||xn&&null!==it)&&!Bt)try{if(_e.tagName.includes("-"))_e[st]=it;else{const hi=it??"";"list"===st?yn=!1:(null==ke||_e[st]!=hi)&&(_e[st]=hi)}}catch{}let On=!1;Tn!==(Tn=Tn.replace(/^xlink\:?/,""))&&(st=Tn,On=!0),null==it||!1===it?(!1!==it||""===_e.getAttribute(st))&&(On?_e.removeAttributeNS(nt,st):_e.removeAttribute(st)):(!yn||4&zt||Bt)&&!xn&&(it=!0===it?"":it,On?_e.setAttributeNS(nt,st,it):_e.setAttribute(st,it))}else st="-"===st[2]?st.slice(3):ni(co,Tn)?Tn.slice(2):Tn[2]+st.slice(3),ke&&Pi.rel(_e,st,ke,!1),it&&Pi.ael(_e,st,it,!1)}},yi=/\s/,Gi=_e=>_e?_e.split(yi):[],gn=(_e,st,ke,it)=>{const Bt=11===st.$elm$.nodeType&&st.$elm$.host?st.$elm$.host:st.$elm$,zt=_e&&_e.$attrs$||Xe,yn=st.$attrs$||Xe;for(it in zt)it in yn||Nt(Bt,it,zt[it],void 0,ke,st.$flags$);for(it in yn)Nt(Bt,it,zt[it],yn[it],ke,st.$flags$)},si=(_e,st,ke,it)=>{const Bt=st.$children$[ke];let yn,Tn,xn,zt=0;if(ie||(w=!0,"slot"===Bt.$tag$&&(y&&it.classList.add(y+"-s"),Bt.$flags$|=Bt.$children$?2:1)),null!==Bt.$text$)yn=Bt.$elm$=io.createTextNode(Bt.$text$);else if(1&Bt.$flags$)yn=Bt.$elm$=io.createTextNode("");else{if(fe||(fe="svg"===Bt.$tag$),yn=Bt.$elm$=io.createElementNS(fe?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&Bt.$flags$?"slot-fb":Bt.$tag$),fe&&"foreignObject"===Bt.$tag$&&(fe=!1),gn(null,Bt,fe),(_e=>null!=_e)(y)&&yn["s-si"]!==y&&yn.classList.add(yn["s-si"]=y),Bt.$children$)for(zt=0;zt<Bt.$children$.length;++zt)Tn=si(_e,Bt,zt,yn),Tn&&yn.appendChild(Tn);"svg"===Bt.$tag$?fe=!1:"foreignObject"===yn.tagName&&(fe=!0)}return yn["s-hn"]=Q,3&Bt.$flags$&&(yn["s-sr"]=!0,yn["s-cr"]=s,yn["s-sn"]=Bt.$name$||"",xn=_e&&_e.$children$&&_e.$children$[ke],xn&&xn.$tag$===Bt.$tag$&&_e.$elm$&&Je(_e.$elm$,!1)),yn},Je=(_e,st)=>{Pi.$flags$|=1;const ke=_e.childNodes;for(let it=ke.length-1;it>=0;it--){const Bt=ke[it];Bt["s-hn"]!==Q&&Bt["s-ol"]&&(Yt(Bt).insertBefore(Bt,gi(Bt)),Bt["s-ol"].remove(),Bt["s-ol"]=void 0,w=!0),st&&Je(Bt,st)}Pi.$flags$&=-2},At=(_e,st,ke,it,Bt,zt)=>{let Tn,yn=_e["s-cr"]&&_e["s-cr"].parentNode||_e;for(yn.shadowRoot&&yn.tagName===Q&&(yn=yn.shadowRoot);Bt<=zt;++Bt)it[Bt]&&(Tn=si(null,ke,Bt,_e),Tn&&(it[Bt].$elm$=Tn,yn.insertBefore(Tn,gi(st))))},Zt=(_e,st,ke)=>{for(let it=st;it<=ke;++it){const Bt=_e[it];if(Bt){const zt=Bt.$elm$;fi(Bt),zt&&(W=!0,zt["s-ol"]?zt["s-ol"].remove():Je(zt,!0),zt.remove())}}},hn=(_e,st)=>_e.$tag$===st.$tag$&&("slot"===_e.$tag$?_e.$name$===st.$name$:_e.$key$===st.$key$),gi=_e=>_e&&_e["s-ol"]||_e,Yt=_e=>(_e["s-ol"]?_e["s-ol"]:_e).parentNode,Un=(_e,st)=>{const ke=st.$elm$=_e.$elm$,it=_e.$children$,Bt=st.$children$,zt=st.$tag$,yn=st.$text$;let Tn;null===yn?(fe="svg"===zt||"foreignObject"!==zt&&fe,"slot"===zt||gn(_e,st,fe),null!==it&&null!==Bt?((_e,st,ke,it)=>{let Xi,so,Bt=0,zt=0,yn=0,Tn=0,xn=st.length-1,On=st[0],hi=st[xn],Ii=it.length-1,zi=it[0],Lo=it[Ii];for(;Bt<=xn&&zt<=Ii;)if(null==On)On=st[++Bt];else if(null==hi)hi=st[--xn];else if(null==zi)zi=it[++zt];else if(null==Lo)Lo=it[--Ii];else if(hn(On,zi))Un(On,zi),On=st[++Bt],zi=it[++zt];else if(hn(hi,Lo))Un(hi,Lo),hi=st[--xn],Lo=it[--Ii];else if(hn(On,Lo))("slot"===On.$tag$||"slot"===Lo.$tag$)&&Je(On.$elm$.parentNode,!1),Un(On,Lo),_e.insertBefore(On.$elm$,hi.$elm$.nextSibling),On=st[++Bt],Lo=it[--Ii];else if(hn(hi,zi))("slot"===On.$tag$||"slot"===Lo.$tag$)&&Je(hi.$elm$.parentNode,!1),Un(hi,zi),_e.insertBefore(hi.$elm$,On.$elm$),hi=st[--xn],zi=it[++zt];else{for(yn=-1,Tn=Bt;Tn<=xn;++Tn)if(st[Tn]&&null!==st[Tn].$key$&&st[Tn].$key$===zi.$key$){yn=Tn;break}yn>=0?(so=st[yn],so.$tag$!==zi.$tag$?Xi=si(st&&st[zt],ke,yn,_e):(Un(so,zi),st[yn]=void 0,Xi=so.$elm$),zi=it[++zt]):(Xi=si(st&&st[zt],ke,zt,_e),zi=it[++zt]),Xi&&Yt(On.$elm$).insertBefore(Xi,gi(On.$elm$))}Bt>xn?At(_e,null==it[Ii+1]?null:it[Ii+1].$elm$,ke,it,zt,Ii):zt>Ii&&Zt(st,Bt,xn)})(ke,it,st,Bt):null!==Bt?(null!==_e.$text$&&(ke.textContent=""),At(ke,null,st,Bt,0,Bt.length-1)):null!==it&&Zt(it,0,it.length-1),fe&&"svg"===zt&&(fe=!1)):(Tn=ke["s-cr"])?Tn.parentNode.textContent=yn:_e.$text$!==yn&&(ke.data=yn)},oi=_e=>{const st=_e.childNodes;let ke,it,Bt,zt,yn,Tn;for(it=0,Bt=st.length;it<Bt;it++)if(ke=st[it],1===ke.nodeType){if(ke["s-sr"])for(yn=ke["s-sn"],ke.hidden=!1,zt=0;zt<Bt;zt++)if(Tn=st[zt].nodeType,st[zt]["s-hn"]!==ke["s-hn"]||""!==yn){if(1===Tn&&yn===st[zt].getAttribute("slot")){ke.hidden=!0;break}}else if(1===Tn||3===Tn&&""!==st[zt].textContent.trim()){ke.hidden=!0;break}oi(ke)}},Ci=[],Oi=_e=>{let st,ke,it,Bt,zt,yn,Tn=0;const xn=_e.childNodes,On=xn.length;for(;Tn<On;Tn++){if(st=xn[Tn],st["s-sr"]&&(ke=st["s-cr"])&&ke.parentNode)for(it=ke.parentNode.childNodes,Bt=st["s-sn"],yn=it.length-1;yn>=0;yn--)ke=it[yn],!ke["s-cn"]&&!ke["s-nr"]&&ke["s-hn"]!==st["s-hn"]&&(Po(ke,Bt)?(zt=Ci.find(hi=>hi.$nodeToRelocate$===ke),W=!0,ke["s-sn"]=ke["s-sn"]||Bt,zt?zt.$slotRefNode$=st:Ci.push({$slotRefNode$:st,$nodeToRelocate$:ke}),ke["s-sr"]&&Ci.map(hi=>{Po(hi.$nodeToRelocate$,ke["s-sn"])&&(zt=Ci.find(Ii=>Ii.$nodeToRelocate$===ke),zt&&!hi.$slotRefNode$&&(hi.$slotRefNode$=zt.$slotRefNode$))})):Ci.some(hi=>hi.$nodeToRelocate$===ke)||Ci.push({$nodeToRelocate$:ke}));1===st.nodeType&&Oi(st)}},Po=(_e,st)=>1===_e.nodeType?null===_e.getAttribute("slot")&&""===st||_e.getAttribute("slot")===st:_e["s-sn"]===st||""===st,fi=_e=>{_e.$attrs$&&_e.$attrs$.ref&&_e.$attrs$.ref(null),_e.$children$&&_e.$children$.map(fi)},ut=(_e,st)=>{st&&!_e.$onRenderResolve$&&st["s-p"]&&st["s-p"].push(new Promise(ke=>_e.$onRenderResolve$=ke))},pe=(_e,st)=>{if(_e.$flags$|=16,!(4&_e.$flags$))return ut(_e,_e.$ancestorComponent$),Vi(()=>ve(_e,st));_e.$flags$|=512},ve=(_e,st)=>{const it=_e.$lazyInstance$;let Bt;return st&&(_e.$flags$|=256,_e.$queuedListeners$&&(_e.$queuedListeners$.map(([zt,yn])=>In(it,zt,yn)),_e.$queuedListeners$=void 0),Bt=In(it,"componentWillLoad")),Bt=et(Bt,()=>In(it,"componentWillRender")),et(Bt,()=>Rt(_e,it,st))},et=(_e,st)=>yt(_e)?_e.then(st):st(),yt=_e=>_e instanceof Promise||_e&&_e.then&&"function"==typeof _e.then,Rt=function(){var _e=(0,v.Z)(function*(st,ke,it){var Bt;const zt=st.$hostElement$,Tn=zt["s-rc"];it&&(_e=>{const st=_e.$cmpMeta$,ke=_e.$hostElement$,it=st.$flags$,zt=at(ke.shadowRoot?ke.shadowRoot:ke.getRootNode(),st,_e.$modeName$);10&it&&(ke["s-sc"]=zt,ke.classList.add(zt+"-h"),2&it&&ke.classList.add(zt+"-s"))})(st);Ut(st,ke),Tn&&(Tn.map(On=>On()),zt["s-rc"]=void 0);{const On=null!==(Bt=zt["s-p"])&&void 0!==Bt?Bt:[],hi=()=>jt(st);0===On.length?hi():(Promise.all(On).then(hi),st.$flags$|=4,On.length=0)}});return function(ke,it,Bt){return _e.apply(this,arguments)}}(),Ut=(_e,st,ke)=>{try{st=st.render&&st.render(),_e.$flags$&=-17,_e.$flags$|=2,((_e,st)=>{const ke=_e.$hostElement$,it=_e.$cmpMeta$,Bt=_e.$vnode$||ye(null,null),zt=(_e=>_e&&_e.$tag$===Qt)(st)?st:Se(null,null,st);if(Q=ke.tagName,it.$attrsToReflect$&&(zt.$attrs$=zt.$attrs$||{},it.$attrsToReflect$.map(([yn,Tn])=>zt.$attrs$[Tn]=ke[yn])),zt.$tag$=null,zt.$flags$|=4,_e.$vnode$=zt,zt.$elm$=Bt.$elm$=ke.shadowRoot||ke,y=ke["s-sc"],s=ke["s-cr"],ie=0!=(1&it.$flags$),W=!1,Un(Bt,zt),Pi.$flags$|=1,w){Oi(zt.$elm$);let yn,Tn,xn,On,hi,Ii,zi=0;for(;zi<Ci.length;zi++)yn=Ci[zi],Tn=yn.$nodeToRelocate$,Tn["s-ol"]||(xn=io.createTextNode(""),xn["s-nr"]=Tn,Tn.parentNode.insertBefore(Tn["s-ol"]=xn,Tn));for(zi=0;zi<Ci.length;zi++)if(yn=Ci[zi],Tn=yn.$nodeToRelocate$,yn.$slotRefNode$){for(On=yn.$slotRefNode$.parentNode,hi=yn.$slotRefNode$.nextSibling,xn=Tn["s-ol"];xn=xn.previousSibling;)if(Ii=xn["s-nr"],Ii&&Ii["s-sn"]===Tn["s-sn"]&&On===Ii.parentNode&&(Ii=Ii.nextSibling,!Ii||!Ii["s-nr"])){hi=Ii;break}(!hi&&On!==Tn.parentNode||Tn.nextSibling!==hi)&&Tn!==hi&&(!Tn["s-hn"]&&Tn["s-ol"]&&(Tn["s-hn"]=Tn["s-ol"].parentNode.nodeName),On.insertBefore(Tn,hi))}else 1===Tn.nodeType&&(Tn.hidden=!0)}W&&oi(zt.$elm$),Pi.$flags$&=-2,Ci.length=0})(_e,st)}catch(it){qi(it,_e.$hostElement$)}return null},jt=_e=>{const ke=_e.$hostElement$,Bt=_e.$lazyInstance$,zt=_e.$ancestorComponent$;In(Bt,"componentDidRender"),64&_e.$flags$?In(Bt,"componentDidUpdate"):(_e.$flags$|=64,tt(ke),In(Bt,"componentDidLoad"),_e.$onReadyResolve$(ke),zt||Kt()),_e.$onInstanceResolve$(ke),_e.$onRenderResolve$&&(_e.$onRenderResolve$(),_e.$onRenderResolve$=void 0),512&_e.$flags$&&kr(()=>pe(_e,!1)),_e.$flags$&=-517},St=_e=>{{const st=Nn(_e),ke=st.$hostElement$.isConnected;return ke&&2==(18&st.$flags$)&&pe(st,!1),ke}},Kt=_e=>{tt(io.documentElement),kr(()=>sn(co,"appload",{detail:{namespace:"ionic"}}))},In=(_e,st,ke)=>{if(_e&&_e[st])try{return _e[st](ke)}catch(it){qi(it)}},tt=_e=>_e.classList.add("hydrated"),me=(_e,st,ke)=>{if(st.$members$){_e.watchers&&(st.$watchers$=_e.watchers);const it=Object.entries(st.$members$),Bt=_e.prototype;if(it.map(([zt,[yn]])=>{31&yn||2&ke&&32&yn?Object.defineProperty(Bt,zt,{get(){return((_e,st)=>Nn(this).$instanceValues$.get(st))(0,zt)},set(Tn){((_e,st,ke,it)=>{const Bt=Nn(_e),zt=Bt.$hostElement$,yn=Bt.$instanceValues$.get(st),Tn=Bt.$flags$,xn=Bt.$lazyInstance$;ke=((_e,st)=>null==_e||xe(_e)?_e:4&st?"false"!==_e&&(""===_e||!!_e):2&st?parseFloat(_e):1&st?String(_e):_e)(ke,it.$members$[st][0]);const On=Number.isNaN(yn)&&Number.isNaN(ke);if((!(8&Tn)||void 0===yn)&&ke!==yn&&!On&&(Bt.$instanceValues$.set(st,ke),xn)){if(it.$watchers$&&128&Tn){const Ii=it.$watchers$[st];Ii&&Ii.map(zi=>{try{xn[zi](ke,yn,st)}catch(Lo){qi(Lo,zt)}})}2==(18&Tn)&&pe(Bt,!1)}})(this,zt,Tn,st)},configurable:!0,enumerable:!0}):1&ke&&64&yn&&Object.defineProperty(Bt,zt,{value(...Tn){const xn=Nn(this);return xn.$onInstancePromise$.then(()=>xn.$lazyInstance$[zt](...Tn))}})}),1&ke){const zt=new Map;Bt.attributeChangedCallback=function(yn,Tn,xn){Pi.jmp(()=>{const On=zt.get(yn);if(this.hasOwnProperty(On))xn=this[On],delete this[On];else if(Bt.hasOwnProperty(On)&&"number"==typeof this[On]&&this[On]==xn)return;this[On]=(null!==xn||"boolean"!=typeof this[On])&&xn})},_e.observedAttributes=it.filter(([yn,Tn])=>15&Tn[0]).map(([yn,Tn])=>{const xn=Tn[1]||yn;return zt.set(xn,yn),512&Tn[0]&&st.$attrsToReflect$.push([yn,xn]),xn})}}return _e},We=function(){var _e=(0,v.Z)(function*(st,ke,it,Bt,zt){if(!(32&ke.$flags$)){ke.$flags$|=32;{if((zt=mo(it)).then){const On=()=>{};zt=yield zt,On()}zt.isProxied||(it.$watchers$=zt.watchers,me(zt,it,2),zt.isProxied=!0);const xn=()=>{};ke.$flags$|=8;try{new zt(ke)}catch(On){qi(On)}ke.$flags$&=-9,ke.$flags$|=128,xn(),kt(ke.$lazyInstance$)}if(zt.style){let xn=zt.style;"string"!=typeof xn&&(xn=xn[ke.$modeName$=(_e=>Go.map(st=>st(_e)).find(st=>!!st))(st)]);const On=dn(it,ke.$modeName$);if(!Ao.has(On)){const hi=()=>{};It(On,xn,!!(1&it.$flags$)),hi()}}}const yn=ke.$ancestorComponent$,Tn=()=>pe(ke,!0);yn&&yn["s-rc"]?yn["s-rc"].push(Tn):Tn()});return function(ke,it,Bt,zt,yn){return _e.apply(this,arguments)}}(),kt=_e=>{In(_e,"connectedCallback")},ti=_e=>{const st=_e["s-cr"]=io.createComment("");st["s-cn"]=!0,_e.insertBefore(st,_e.firstChild)},Si=(_e,st={})=>{var ke;const Bt=[],zt=st.exclude||[],yn=co.customElements,Tn=io.head,xn=Tn.querySelector("meta[charset]"),On=io.createElement("style"),hi=[],Ii=io.querySelectorAll(`[${Ke}]`);let zi,Lo=!0,Xi=0;for(Object.assign(Pi,st),Pi.$resourcesUrl$=new URL(st.resourcesUrl||"./",io.baseURI).href,Pi.$flags$|=2;Xi<Ii.length;Xi++)It(Ii[Xi].getAttribute(Ke),Sn(Ii[Xi].innerHTML),!0);_e.map(so=>{so[1].map(To=>{const or={$flags$:To[0],$tagName$:To[1],$members$:To[2],$listeners$:To[3]};or.$members$=To[2],or.$listeners$=To[3],or.$attrsToReflect$=[],or.$watchers$={};const Wo=or.$tagName$,dr=class extends HTMLElement{constructor(wo){super(wo),ri(wo=this,or),1&or.$flags$&&wo.attachShadow({mode:"open",delegatesFocus:!!(16&or.$flags$)})}connectedCallback(){zi&&(clearTimeout(zi),zi=null),Lo?hi.push(this):Pi.jmp(()=>(_e=>{if(!(1&Pi.$flags$)){const st=Nn(_e),ke=st.$cmpMeta$,it=()=>{};if(1&st.$flags$)ji(_e,st,ke.$listeners$),kt(st.$lazyInstance$);else{let Bt;if(st.$flags$|=1,Bt=_e.getAttribute(ze),Bt){if(1&ke.$flags$){const zt=at(_e.shadowRoot,ke,_e.getAttribute("s-mode"));_e.classList.remove(zt+"-h",zt+"-s")}((_e,st,ke,it)=>{const zt=_e.shadowRoot,yn=[],xn=zt?[]:null,On=it.$vnode$=ye(st,null);Pi.$orgLocNodes$||_t(io.body,Pi.$orgLocNodes$=new Map),_e[ze]=ke,_e.removeAttribute(ze),je(On,yn,[],xn,_e,_e,ke),yn.map(hi=>{const Ii=hi.$hostId$+"."+hi.$nodeId$,zi=Pi.$orgLocNodes$.get(Ii),Lo=hi.$elm$;zi&&en&&""===zi["s-en"]&&zi.parentNode.insertBefore(Lo,zi.nextSibling),zt||(Lo["s-hn"]=st,zi&&(Lo["s-ol"]=zi,Lo["s-ol"]["s-nr"]=Lo)),Pi.$orgLocNodes$.delete(Ii)}),zt&&xn.map(hi=>{hi&&zt.appendChild(hi)})})(_e,ke.$tagName$,Bt,st)}Bt||12&ke.$flags$&&ti(_e);{let zt=_e;for(;zt=zt.parentNode||zt.host;)if(1===zt.nodeType&&zt.hasAttribute("s-id")&&zt["s-p"]||zt["s-p"]){ut(st,st.$ancestorComponent$=zt);break}}ke.$members$&&Object.entries(ke.$members$).map(([zt,[yn]])=>{if(31&yn&&_e.hasOwnProperty(zt)){const Tn=_e[zt];delete _e[zt],_e[zt]=Tn}}),We(_e,st,ke)}it()}})(this))}disconnectedCallback(){Pi.jmp(()=>(_e=>{if(!(1&Pi.$flags$)){const st=Nn(this),ke=st.$lazyInstance$;st.$rmListeners$&&(st.$rmListeners$.map(it=>it()),st.$rmListeners$=void 0),In(ke,"disconnectedCallback")}})())}componentOnReady(){return Nn(this).$onReadyPromise$}};or.$lazyBundleId$=so[0],!zt.includes(Wo)&&!yn.get(Wo)&&(Bt.push(Wo),yn.define(Wo,me(dr,or,1)))})});{On.innerHTML=Bt+"{visibility:hidden}.hydrated{visibility:inherit}",On.setAttribute("data-styles","");const so=null!==(ke=Pi.$nonce$)&&void 0!==ke?ke:Ze(io);null!=so&&On.setAttribute("nonce",so),Tn.insertBefore(On,xn?xn.nextSibling:Tn.firstChild)}Lo=!1,hi.length?hi.map(so=>so.connectedCallback()):Pi.jmp(()=>zi=setTimeout(Kt,30))},ji=(_e,st,ke,it)=>{ke&&ke.map(([Bt,zt,yn])=>{const Tn=eo(_e,Bt),xn=po(st,yn),On=tn(Bt);Pi.ael(Tn,zt,xn,On),(st.$rmListeners$=st.$rmListeners$||[]).push(()=>Pi.rel(Tn,zt,xn,On))})},po=(_e,st)=>ke=>{try{256&_e.$flags$?_e.$lazyInstance$[st](ke):(_e.$queuedListeners$=_e.$queuedListeners$||[]).push([st,ke])}catch(it){qi(it)}},eo=(_e,st)=>4&st?io:8&st?co:16&st?io.body:_e,tn=_e=>0!=(2&_e),Et=new WeakMap,Nn=_e=>Et.get(_e),Pn=(_e,st)=>Et.set(st.$lazyInstance$=_e,st),ri=(_e,st)=>{const ke={$flags$:0,$hostElement$:_e,$cmpMeta$:st,$instanceValues$:new Map};return ke.$onInstancePromise$=new Promise(it=>ke.$onInstanceResolve$=it),ke.$onReadyPromise$=new Promise(it=>ke.$onReadyResolve$=it),_e["s-p"]=[],_e["s-rc"]=[],ji(_e,ke,st.$listeners$),Et.set(_e,ke)},ni=(_e,st)=>st in _e,qi=(_e,st)=>(0,console.error)(_e,st),wi=new Map,mo=(_e,st,ke)=>{const it=_e.$tagName$.replace(/-/g,"_"),Bt=_e.$lazyBundleId$,zt=wi.get(Bt);return zt?zt[it]:R(863)(`./${Bt}.entry.js`).then(yn=>(wi.set(Bt,yn),yn[it]),qi)},Ao=new Map,Go=[],co=typeof window<"u"?window:{},io=co.document||{head:{}},Pi={$flags$:0,$resourcesUrl$:"",jmp:_e=>_e(),raf:_e=>requestAnimationFrame(_e),ael:(_e,st,ke,it)=>_e.addEventListener(st,ke,it),rel:(_e,st,ke,it)=>_e.removeEventListener(st,ke,it),ce:(_e,st)=>new CustomEvent(_e,st)},uo=_e=>{Object.assign(Pi,_e)},en=!0,Qo=_e=>Promise.resolve(_e),vo=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),Ji=[],gr=[],xo=(_e,st)=>ke=>{_e.push(ke),Ae||(Ae=!0,st&&4&Pi.$flags$?kr(Mr):Pi.raf(Mr))},Zr=_e=>{for(let st=0;st<_e.length;st++)try{_e[st](performance.now())}catch(ke){qi(ke)}_e.length=0},Mr=()=>{Zr(Ji),Zr(gr),(Ae=Ji.length>0)&&Pi.raf(Mr)},kr=_e=>Qo().then(_e),ei=xo(Ji,!1),Vi=xo(gr,!0)},8077:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{GESTURE_CONTROLLER:()=>v.G,createGesture:()=>fe});var v=R(4587);const d=(se,Te,ge,we)=>{const Le=y(se)?{capture:!!we.capture,passive:!!we.passive}:!!we.capture;let Me,ze;return se.__zone_symbol__addEventListener?(Me="__zone_symbol__addEventListener",ze="__zone_symbol__removeEventListener"):(Me="addEventListener",ze="removeEventListener"),se[Me](Te,ge,Le),()=>{se[ze](Te,ge,Le)}},y=se=>{if(void 0===s)try{const Te=Object.defineProperty({},"passive",{get:()=>{s=!0}});se.addEventListener("optsTest",()=>{},Te)}catch{s=!1}return!!s};let s;const W=se=>se instanceof Document?se:se.ownerDocument,fe=se=>{let Te=!1,ge=!1,we=!0,Le=!1;const Me=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},se),ze=Me.canStart,Ke=Me.onWillStart,Oe=Me.onStart,Ce=Me.onEnd,nt=Me.notCaptured,Xe=Me.onMove,Ee=Me.threshold,ae=Me.passive,mt=Me.blurOnStart,xe={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},Ze=((se,Te,ge)=>{const we=ge*(Math.PI/180),Le="x"===se,Me=Math.cos(we),ze=Te*Te;let Ke=0,Oe=0,Ce=!1,nt=0;return{start(Xe,Ee){Ke=Xe,Oe=Ee,nt=0,Ce=!0},detect(Xe,Ee){if(!Ce)return!1;const ae=Xe-Ke,mt=Ee-Oe,xe=ae*ae+mt*mt;if(xe<ze)return!1;const Ze=Math.sqrt(xe),Se=(Le?ae:mt)/Ze;return nt=Se>Me?1:Se<-Me?-1:0,Ce=!1,!0},isGesture:()=>0!==nt,getDirection:()=>nt}})(Me.direction,Me.threshold,Me.maxAngle),Se=v.G.createGesture({name:se.gestureName,priority:se.gesturePriority,disableScroll:se.disableScroll}),dt=()=>{Te&&(Le=!1,Xe&&Xe(xe))},gt=()=>!!Se.capture()&&(Te=!0,we=!1,xe.startX=xe.currentX,xe.startY=xe.currentY,xe.startTime=xe.currentTime,Ke?Ke(xe).then(Ue):Ue(),!0),Ue=()=>{mt&&(()=>{if(typeof document<"u"){const Ft=document.activeElement;Ft?.blur&&Ft.blur()}})(),Oe&&Oe(xe),we=!0},vt=()=>{Te=!1,ge=!1,Le=!1,we=!0,Se.release()},je=Ft=>{const Gt=Te,wn=we;if(vt(),wn){if(Ae(xe,Ft),Gt)return void(Ce&&Ce(xe));nt&&nt(xe)}},_t=((se,Te,ge,we,Le)=>{let Me,ze,Ke,Oe,Ce,nt,Xe,Ee=0;const ae=ct=>{Ee=Date.now()+2e3,Te(ct)&&(!ze&&ge&&(ze=d(se,"touchmove",ge,Le)),Ke||(Ke=d(ct.target,"touchend",xe,Le)),Oe||(Oe=d(ct.target,"touchcancel",xe,Le)))},mt=ct=>{Ee>Date.now()||Te(ct)&&(!nt&&ge&&(nt=d(W(se),"mousemove",ge,Le)),Xe||(Xe=d(W(se),"mouseup",Ze,Le)))},xe=ct=>{Se(),we&&we(ct)},Ze=ct=>{ye(),we&&we(ct)},Se=()=>{ze&&ze(),Ke&&Ke(),Oe&&Oe(),ze=Ke=Oe=void 0},ye=()=>{nt&&nt(),Xe&&Xe(),nt=Xe=void 0},Qt=()=>{Se(),ye()},dt=(ct=!0)=>{ct?(Me||(Me=d(se,"touchstart",ae,Le)),Ce||(Ce=d(se,"mousedown",mt,Le))):(Me&&Me(),Ce&&Ce(),Me=Ce=void 0,Qt())};return{enable:dt,stop:Qt,destroy:()=>{dt(!1),we=ge=Te=void 0}}})(Me.el,Ft=>{const Gt=X(Ft);return!(ge||!we||(De(Ft,xe),xe.startX=xe.currentX,xe.startY=xe.currentY,xe.startTime=xe.currentTime=Gt,xe.velocityX=xe.velocityY=xe.deltaX=xe.deltaY=0,xe.event=Ft,ze&&!1===ze(xe))||(Se.release(),!Se.start()))&&(ge=!0,0===Ee?gt():(Ze.start(xe.startX,xe.startY),!0))},Ft=>{Te?!Le&&we&&(Le=!0,Ae(xe,Ft),requestAnimationFrame(dt)):(Ae(xe,Ft),Ze.detect(xe.currentX,xe.currentY)&&(!Ze.isGesture()||!gt())&&Ne())},je,{capture:!1,passive:ae}),Ne=()=>{vt(),_t.stop(),nt&&nt(xe)};return{enable(Ft=!0){Ft||(Te&&je(void 0),vt()),_t.enable(Ft)},destroy(){Se.destroy(),_t.destroy()}}},Ae=(se,Te)=>{if(!Te)return;const ge=se.currentX,we=se.currentY,Le=se.currentTime;De(Te,se);const Me=se.currentX,ze=se.currentY,Oe=(se.currentTime=X(Te))-Le;if(Oe>0&&Oe<100){const nt=(ze-we)/Oe;se.velocityX=(Me-ge)/Oe*.7+.3*se.velocityX,se.velocityY=.7*nt+.3*se.velocityY}se.deltaX=Me-se.startX,se.deltaY=ze-se.startY,se.event=Te},De=(se,Te)=>{let ge=0,we=0;if(se){const Le=se.changedTouches;if(Le&&Le.length>0){const Me=Le[0];ge=Me.clientX,we=Me.clientY}else void 0!==se.pageX&&(ge=se.pageX,we=se.pageY)}Te.currentX=ge,Te.currentY=we},X=se=>se.timeStamp||Date.now()},1767:(zn,Ct,R)=>{"use strict";R.d(Ct,{m:()=>De});var v=R(5861),d=R(5421),y=R(544),s=R(7876),Q=R(6506);const ie=X=>(0,Q.c)().duration(X?400:300),W=X=>{let se,Te;const ge=X.width+8,we=(0,Q.c)(),Le=(0,Q.c)();X.isEndSide?(se=ge+"px",Te="0px"):(se=-ge+"px",Te="0px"),we.addElement(X.menuInnerEl).fromTo("transform",`translateX(${se})`,`translateX(${Te})`);const ze="ios"===(0,s.b)(X),Ke=ze?.2:.25;return Le.addElement(X.backdropEl).fromTo("opacity",.01,Ke),ie(ze).addAnimation([we,Le])},w=X=>{let se,Te;const ge=(0,s.b)(X),we=X.width;X.isEndSide?(se=-we+"px",Te=we+"px"):(se=we+"px",Te=-we+"px");const Le=(0,Q.c)().addElement(X.menuInnerEl).fromTo("transform",`translateX(${Te})`,"translateX(0px)"),Me=(0,Q.c)().addElement(X.contentEl).fromTo("transform","translateX(0px)",`translateX(${se})`),ze=(0,Q.c)().addElement(X.backdropEl).fromTo("opacity",.01,.32);return ie("ios"===ge).addAnimation([Le,Me,ze])},fe=X=>{const se=(0,s.b)(X),Te=X.width*(X.isEndSide?-1:1)+"px",ge=(0,Q.c)().addElement(X.contentEl).fromTo("transform","translateX(0px)",`translateX(${Te})`);return ie("ios"===se).addAnimation(ge)},De=(()=>{const X=new Map,se=[],Te=function(){var Ue=(0,v.Z)(function*(vt){const je=yield Oe(vt);return!!je&&je.open()});return function(je){return Ue.apply(this,arguments)}}(),ge=function(){var Ue=(0,v.Z)(function*(vt){const je=yield void 0!==vt?Oe(vt):Ce();return void 0!==je&&je.close()});return function(je){return Ue.apply(this,arguments)}}(),we=function(){var Ue=(0,v.Z)(function*(vt){const je=yield Oe(vt);return!!je&&je.toggle()});return function(je){return Ue.apply(this,arguments)}}(),Le=function(){var Ue=(0,v.Z)(function*(vt,je){const _t=yield Oe(je);return _t&&(_t.disabled=!vt),_t});return function(je,_t){return Ue.apply(this,arguments)}}(),Me=function(){var Ue=(0,v.Z)(function*(vt,je){const _t=yield Oe(je);return _t&&(_t.swipeGesture=vt),_t});return function(je,_t){return Ue.apply(this,arguments)}}(),ze=function(){var Ue=(0,v.Z)(function*(vt){if(null!=vt){const je=yield Oe(vt);return void 0!==je&&je.isOpen()}return void 0!==(yield Ce())});return function(je){return Ue.apply(this,arguments)}}(),Ke=function(){var Ue=(0,v.Z)(function*(vt){const je=yield Oe(vt);return!!je&&!je.disabled});return function(je){return Ue.apply(this,arguments)}}(),Oe=function(){var Ue=(0,v.Z)(function*(vt){return yield ct(),"start"===vt||"end"===vt?gt(Ne=>Ne.side===vt&&!Ne.disabled)||gt(Ne=>Ne.side===vt):null!=vt?gt(_t=>_t.menuId===vt):gt(_t=>!_t.disabled)||(se.length>0?se[0].el:void 0)});return function(je){return Ue.apply(this,arguments)}}(),Ce=function(){var Ue=(0,v.Z)(function*(){return yield ct(),ye()});return function(){return Ue.apply(this,arguments)}}(),nt=function(){var Ue=(0,v.Z)(function*(){return yield ct(),Qt()});return function(){return Ue.apply(this,arguments)}}(),Xe=function(){var Ue=(0,v.Z)(function*(){return yield ct(),dt()});return function(){return Ue.apply(this,arguments)}}(),Ee=(Ue,vt)=>{X.set(Ue,vt)},xe=Ue=>{const vt=Ue.side;se.filter(je=>je.side===vt&&je!==Ue).forEach(je=>je.disabled=!0)},Ze=function(){var Ue=(0,v.Z)(function*(vt,je,_t){if(dt())return!1;if(je){const Ne=yield Ce();Ne&&vt.el!==Ne&&(yield Ne.setOpen(!1,!1))}return vt._setOpen(je,_t)});return function(je,_t,Ne){return Ue.apply(this,arguments)}}(),ye=()=>gt(Ue=>Ue._isOpen),Qt=()=>se.map(Ue=>Ue.el),dt=()=>se.some(Ue=>Ue.isAnimating),gt=Ue=>{const vt=se.find(Ue);if(void 0!==vt)return vt.el},ct=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(Ue=>new Promise(vt=>(0,y.c)(Ue,vt))));return Ee("reveal",fe),Ee("push",w),Ee("overlay",W),typeof document<"u"&&document.addEventListener("ionBackButton",Ue=>{const vt=ye();vt&&Ue.detail.register(d.MENU_BACK_BUTTON_PRIORITY,()=>vt.close())}),{registerAnimation:Ee,get:Oe,getMenus:nt,getOpen:Ce,isEnabled:Ke,swipeGesture:Me,isAnimating:Xe,isOpen:ze,enable:Le,toggle:we,close:ge,open:Te,_getOpenSync:ye,_createAnimation:(Ue,vt)=>{const je=X.get(Ue);if(!je)throw new Error("animation not registered");return je(vt)},_register:Ue=>{se.indexOf(Ue)<0&&(Ue.disabled||xe(Ue),se.push(Ue))},_unregister:Ue=>{const vt=se.indexOf(Ue);vt>-1&&se.splice(vt,1)},_setOpen:Ze,_setActiveMenu:xe}})()},8354:(zn,Ct,R)=>{"use strict";R.d(Ct,{L:()=>s,a:()=>Q,b:()=>ie,c:()=>W,d:()=>w,e:()=>Ee,g:()=>xe,l:()=>nt,s:()=>ae,t:()=>De,w:()=>Xe});var v=R(5861),d=R(6953),y=R(544);const s="ionViewWillEnter",Q="ionViewDidEnter",ie="ionViewWillLeave",W="ionViewDidLeave",w="ionViewWillUnload",De=Ze=>new Promise((Se,ye)=>{(0,d.w)(()=>{X(Ze),se(Ze).then(Qt=>{Qt.animation&&Qt.animation.destroy(),Te(Ze),Se(Qt)},Qt=>{Te(Ze),ye(Qt)})})}),X=Ze=>{const Se=Ze.enteringEl,ye=Ze.leavingEl;mt(Se,ye,Ze.direction),Ze.showGoBack?Se.classList.add("can-go-back"):Se.classList.remove("can-go-back"),ae(Se,!1),Se.style.setProperty("pointer-events","none"),ye&&(ae(ye,!1),ye.style.setProperty("pointer-events","none"))},se=function(){var Ze=(0,v.Z)(function*(Se){const ye=yield ge(Se);return ye&&d.B.isBrowser?we(ye,Se):Le(Se)});return function(ye){return Ze.apply(this,arguments)}}(),Te=Ze=>{const Se=Ze.enteringEl,ye=Ze.leavingEl;Se.classList.remove("ion-page-invisible"),Se.style.removeProperty("pointer-events"),void 0!==ye&&(ye.classList.remove("ion-page-invisible"),ye.style.removeProperty("pointer-events"))},ge=function(){var Ze=(0,v.Z)(function*(Se){return Se.leavingEl&&Se.animated&&0!==Se.duration?Se.animationBuilder?Se.animationBuilder:"ios"===Se.mode?(yield Promise.resolve().then(R.bind(R,8899))).iosTransitionAnimation:(yield Promise.resolve().then(R.bind(R,5298))).mdTransitionAnimation:void 0});return function(ye){return Ze.apply(this,arguments)}}(),we=function(){var Ze=(0,v.Z)(function*(Se,ye){yield Me(ye,!0);const Qt=Se(ye.baseEl,ye);Oe(ye.enteringEl,ye.leavingEl);const dt=yield Ke(Qt,ye);return ye.progressCallback&&ye.progressCallback(void 0),dt&&Ce(ye.enteringEl,ye.leavingEl),{hasCompleted:dt,animation:Qt}});return function(ye,Qt){return Ze.apply(this,arguments)}}(),Le=function(){var Ze=(0,v.Z)(function*(Se){const ye=Se.enteringEl,Qt=Se.leavingEl;return yield Me(Se,!1),Oe(ye,Qt),Ce(ye,Qt),{hasCompleted:!0}});return function(ye){return Ze.apply(this,arguments)}}(),Me=function(){var Ze=(0,v.Z)(function*(Se,ye){(void 0!==Se.deepWait?Se.deepWait:ye)&&(yield Promise.all([Ee(Se.enteringEl),Ee(Se.leavingEl)])),yield ze(Se.viewIsReady,Se.enteringEl)});return function(ye,Qt){return Ze.apply(this,arguments)}}(),ze=function(){var Ze=(0,v.Z)(function*(Se,ye){Se&&(yield Se(ye))});return function(ye,Qt){return Ze.apply(this,arguments)}}(),Ke=(Ze,Se)=>{const ye=Se.progressCallback,Qt=new Promise(dt=>{Ze.onFinish(gt=>dt(1===gt))});return ye?(Ze.progressStart(!0),ye(Ze)):Ze.play(),Qt},Oe=(Ze,Se)=>{nt(Se,ie),nt(Ze,s)},Ce=(Ze,Se)=>{nt(Ze,Q),nt(Se,W)},nt=(Ze,Se)=>{if(Ze){const ye=new CustomEvent(Se,{bubbles:!1,cancelable:!1});Ze.dispatchEvent(ye)}},Xe=()=>new Promise(Ze=>(0,y.r)(()=>(0,y.r)(()=>Ze()))),Ee=function(){var Ze=(0,v.Z)(function*(Se){const ye=Se;if(ye){if(null!=ye.componentOnReady){if(null!=(yield ye.componentOnReady()))return}else if(null!=ye.__registerHost)return void(yield new Promise(dt=>(0,y.r)(dt)));yield Promise.all(Array.from(ye.children).map(Ee))}});return function(ye){return Ze.apply(this,arguments)}}(),ae=(Ze,Se)=>{Se?(Ze.setAttribute("aria-hidden","true"),Ze.classList.add("ion-page-hidden")):(Ze.hidden=!1,Ze.removeAttribute("aria-hidden"),Ze.classList.remove("ion-page-hidden"))},mt=(Ze,Se,ye)=>{void 0!==Ze&&(Ze.style.zIndex="back"===ye?"99":"101"),void 0!==Se&&(Se.style.zIndex="100")},xe=Ze=>Ze.classList.contains("ion-page")?Ze:Ze.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||Ze},7643:(zn,Ct,R)=>{"use strict";R.d(Ct,{d:()=>d,w:()=>v});const v=typeof window<"u"?window:void 0,d=typeof document<"u"?document:void 0},7690:(zn,Ct,R)=>{"use strict";R.d(Ct,{a:()=>d,b:()=>y,p:()=>v});const v=(s,...Q)=>console.warn(`[Ionic Warning]: ${s}`,...Q),d=(s,...Q)=>console.error(`[Ionic Error]: ${s}`,...Q),y=(s,...Q)=>console.error(`<${s.tagName.toLowerCase()}> must be used inside ${Q.join(" or ")}.`)},7876:(zn,Ct,R)=>{"use strict";R.d(Ct,{a:()=>De,b:()=>dt,c:()=>y,g:()=>Ae,i:()=>gt});var v=R(6953);class d{constructor(){this.m=new Map}reset(Ue){this.m=new Map(Object.entries(Ue))}get(Ue,vt){const je=this.m.get(Ue);return void 0!==je?je:vt}getBoolean(Ue,vt=!1){const je=this.m.get(Ue);return void 0===je?vt:"string"==typeof je?"true"===je:!!je}getNumber(Ue,vt){const je=parseFloat(this.m.get(Ue));return isNaN(je)?void 0!==vt?vt:NaN:je}set(Ue,vt){this.m.set(Ue,vt)}}const y=new d,w="ionic:",fe="ionic-persist-config",Ae=ct=>X(ct),De=(ct,Ue)=>("string"==typeof ct&&(Ue=ct,ct=void 0),Ae(ct).includes(Ue)),X=(ct=window)=>{if(typeof ct>"u")return[];ct.Ionic=ct.Ionic||{};let Ue=ct.Ionic.platforms;return null==Ue&&(Ue=ct.Ionic.platforms=se(ct),Ue.forEach(vt=>ct.document.documentElement.classList.add(`plt-${vt}`))),Ue},se=ct=>{const Ue=y.get("platform");return Object.keys(ye).filter(vt=>{const je=Ue?.[vt];return"function"==typeof je?je(ct):ye[vt](ct)})},ge=ct=>!!(Ze(ct,/iPad/i)||Ze(ct,/Macintosh/i)&&Ce(ct)),Me=ct=>Ze(ct,/android|sink/i),Ce=ct=>Se(ct,"(any-pointer:coarse)"),Xe=ct=>Ee(ct)||ae(ct),Ee=ct=>!!(ct.cordova||ct.phonegap||ct.PhoneGap),ae=ct=>{const Ue=ct.Capacitor;return!!Ue?.isNative},Ze=(ct,Ue)=>Ue.test(ct.navigator.userAgent),Se=(ct,Ue)=>{var vt;return null===(vt=ct.matchMedia)||void 0===vt?void 0:vt.call(ct,Ue).matches},ye={ipad:ge,iphone:ct=>Ze(ct,/iPhone/i),ios:ct=>Ze(ct,/iPhone|iPod/i)||ge(ct),android:Me,phablet:ct=>{const Ue=ct.innerWidth,vt=ct.innerHeight,je=Math.min(Ue,vt),_t=Math.max(Ue,vt);return je>390&&je<520&&_t>620&&_t<800},tablet:ct=>{const Ue=ct.innerWidth,vt=ct.innerHeight,je=Math.min(Ue,vt),_t=Math.max(Ue,vt);return ge(ct)||(ct=>Me(ct)&&!Ze(ct,/mobile/i))(ct)||je>460&&je<820&&_t>780&&_t<1400},cordova:Ee,capacitor:ae,electron:ct=>Ze(ct,/electron/i),pwa:ct=>{var Ue;return!!(null!==(Ue=ct.matchMedia)&&void 0!==Ue&&Ue.call(ct,"(display-mode: standalone)").matches||ct.navigator.standalone)},mobile:Ce,mobileweb:ct=>Ce(ct)&&!Xe(ct),desktop:ct=>!Ce(ct),hybrid:Xe};let Qt;const dt=ct=>ct&&(0,v.g)(ct)||Qt,gt=(ct={})=>{if(typeof window>"u")return;const Ue=window.document,vt=window,je=vt.Ionic=vt.Ionic||{},_t={};ct._ael&&(_t.ael=ct._ael),ct._rel&&(_t.rel=ct._rel),ct._ce&&(_t.ce=ct._ce),(0,v.a)(_t);const Ne=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(ct=>{try{const Ue=ct.sessionStorage.getItem(fe);return null!==Ue?JSON.parse(Ue):{}}catch{return{}}})(vt)),{persistConfig:!1}),je.config),(ct=>{const Ue={};return ct.location.search.slice(1).split("&").map(vt=>vt.split("=")).map(([vt,je])=>[decodeURIComponent(vt),decodeURIComponent(je)]).filter(([vt])=>((ct,Ue)=>ct.substr(0,Ue.length)===Ue)(vt,w)).map(([vt,je])=>[vt.slice(6),je]).forEach(([vt,je])=>{Ue[vt]=je}),Ue})(vt)),ct);y.reset(Ne),y.getBoolean("persistConfig")&&((ct,Ue)=>{try{ct.sessionStorage.setItem(fe,JSON.stringify(Ue))}catch{return}})(vt,Ne),X(vt),je.config=y,je.mode=Qt=y.get("mode",Ue.documentElement.getAttribute("mode")||(De(vt,"ios")?"ios":"md")),y.set("mode",Qt),Ue.documentElement.setAttribute("mode",Qt),Ue.documentElement.classList.add(Qt),y.getBoolean("_testing")&&y.set("animated",!1);const Ft=wn=>{var Xt;return null===(Xt=wn.tagName)||void 0===Xt?void 0:Xt.startsWith("ION-")},Gt=wn=>["ios","md"].includes(wn);(0,v.c)(wn=>{for(;wn;){const Xt=wn.mode||wn.getAttribute("mode");if(Xt){if(Gt(Xt))return Xt;Ft(wn)&&console.warn('Invalid ionic mode: "'+Xt+'", expected: "ios" or "md"')}wn=wn.parentElement}return Qt})}},8899:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{iosTransitionAnimation:()=>se,shadow:()=>W});var v=R(6506),d=R(8354);R(7643),R(6953);const ie=Te=>document.querySelector(`${Te}.ion-cloned-element`),W=Te=>Te.shadowRoot||Te,w=Te=>{const ge="ION-TABS"===Te.tagName?Te:Te.querySelector("ion-tabs"),we="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=ge){const Le=ge.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=Le?Le.querySelector(we):null}return Te.querySelector(we)},fe=(Te,ge)=>{const we="ION-TABS"===Te.tagName?Te:Te.querySelector("ion-tabs");let Le=[];if(null!=we){const Me=we.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=Me&&(Le=Me.querySelectorAll("ion-buttons"))}else Le=Te.querySelectorAll("ion-buttons");for(const Me of Le){const ze=Me.closest("ion-header"),Ke=ze&&!ze.classList.contains("header-collapse-condense-inactive"),Oe=Me.querySelector("ion-back-button"),Ce=Me.classList.contains("buttons-collapse");if(null!==Oe&&("start"===Me.slot||""===Me.slot)&&(Ce&&Ke&&ge||!Ce))return Oe}return null},De=(Te,ge,we,Le,Me,ze)=>{const Ke=ge?`calc(100% - ${ze.right+4}px)`:ze.left-4+"px",Oe=ge?"7px":"-7px",Ce=ge?"-4px":"4px",nt=ge?"-4px":"4px",Xe=ge?"right":"left",Ee=ge?"left":"right",xe=we?[{offset:0,opacity:1,transform:`translate3d(${Ce}, ${ze.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Oe}, ${Me.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${Oe}, ${Me.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${Ce}, ${ze.top-46}px, 0) scale(1)`}],ye=we?[{offset:0,opacity:1,transform:`translate3d(${nt}, ${ze.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${nt}, ${ze.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${nt}, ${ze.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${nt}, ${ze.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${nt}, ${ze.top-46}px, 0) scale(1)`}],Qt=(0,v.c)(),dt=(0,v.c)(),gt=ie("ion-back-button"),ct=W(gt).querySelector(".button-text"),Ue=W(gt).querySelector("ion-icon");gt.text=Le.text,gt.mode=Le.mode,gt.icon=Le.icon,gt.color=Le.color,gt.disabled=Le.disabled,gt.style.setProperty("display","block"),gt.style.setProperty("position","fixed"),dt.addElement(Ue),Qt.addElement(ct),Qt.beforeStyles({"transform-origin":`${Xe} center`}).beforeAddWrite(()=>{Le.style.setProperty("display","none"),gt.style.setProperty(Xe,Ke)}).afterAddWrite(()=>{Le.style.setProperty("display",""),gt.style.setProperty("display","none"),gt.style.removeProperty(Xe)}).keyframes(xe),dt.beforeStyles({"transform-origin":`${Ee} center`}).keyframes(ye),Te.addAnimation([Qt,dt])},X=(Te,ge,we,Le,Me,ze)=>{const Ke=ge?`calc(100% - ${Me.right}px)`:`${Me.left}px`,Oe=ge?"-18px":"18px",Ce=ge?"right":"left",Ee=we?[{offset:0,opacity:0,transform:`translate3d(${Oe}, ${ze.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${Me.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${Me.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${Oe}, ${ze.top-4}px, 0) scale(0.5)`}],ae=ie("ion-title"),mt=(0,v.c)();ae.innerText=Le.innerText,ae.size=Le.size,ae.color=Le.color,mt.addElement(ae),mt.beforeStyles({"transform-origin":`${Ce} center`,height:"46px",display:"",position:"relative",[Ce]:Ke}).beforeAddWrite(()=>{Le.style.setProperty("display","none")}).afterAddWrite(()=>{Le.style.setProperty("display",""),ae.style.setProperty("display","none")}).keyframes(Ee),Te.addAnimation(mt)},se=(Te,ge)=>{var we;try{const Le="cubic-bezier(0.32,0.72,0,1)",Me="opacity",ze="transform",Ke="0%",Ce="rtl"===Te.ownerDocument.dir,nt=Ce?"-99.5%":"99.5%",Xe=Ce?"33%":"-33%",Ee=ge.enteringEl,ae=ge.leavingEl,mt="back"===ge.direction,xe=Ee.querySelector(":scope > ion-content"),Ze=Ee.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),Se=Ee.querySelectorAll(":scope > ion-header > ion-toolbar"),ye=(0,v.c)(),Qt=(0,v.c)();if(ye.addElement(Ee).duration((null!==(we=ge.duration)&&void 0!==we?we:0)||540).easing(ge.easing||Le).fill("both").beforeRemoveClass("ion-page-invisible"),ae&&null!=Te){const Ue=(0,v.c)();Ue.addElement(Te),ye.addAnimation(Ue)}if(xe||0!==Se.length||0!==Ze.length?(Qt.addElement(xe),Qt.addElement(Ze)):Qt.addElement(Ee.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),ye.addAnimation(Qt),mt?Qt.beforeClearStyles([Me]).fromTo("transform",`translateX(${Xe})`,`translateX(${Ke})`).fromTo(Me,.8,1):Qt.beforeClearStyles([Me]).fromTo("transform",`translateX(${nt})`,`translateX(${Ke})`),xe){const Ue=W(xe).querySelector(".transition-effect");if(Ue){const vt=Ue.querySelector(".transition-cover"),je=Ue.querySelector(".transition-shadow"),_t=(0,v.c)(),Ne=(0,v.c)(),Ft=(0,v.c)();_t.addElement(Ue).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Ne.addElement(vt).beforeClearStyles([Me]).fromTo(Me,0,.1),Ft.addElement(je).beforeClearStyles([Me]).fromTo(Me,.03,.7),_t.addAnimation([Ne,Ft]),Qt.addAnimation([_t])}}const dt=Ee.querySelector("ion-header.header-collapse-condense"),{forward:gt,backward:ct}=((Te,ge,we,Le,Me)=>{const ze=fe(Le,we),Ke=w(Me),Oe=w(Le),Ce=fe(Me,we),nt=null!==ze&&null!==Ke&&!we,Xe=null!==Oe&&null!==Ce&&we;if(nt){const Ee=Ke.getBoundingClientRect(),ae=ze.getBoundingClientRect();X(Te,ge,we,Ke,Ee,ae),De(Te,ge,we,ze,Ee,ae)}else if(Xe){const Ee=Oe.getBoundingClientRect(),ae=Ce.getBoundingClientRect();X(Te,ge,we,Oe,Ee,ae),De(Te,ge,we,Ce,Ee,ae)}return{forward:nt,backward:Xe}})(ye,Ce,mt,Ee,ae);if(Se.forEach(Ue=>{const vt=(0,v.c)();vt.addElement(Ue),ye.addAnimation(vt);const je=(0,v.c)();je.addElement(Ue.querySelector("ion-title"));const _t=(0,v.c)(),Ne=Array.from(Ue.querySelectorAll("ion-buttons,[menuToggle]")),Ft=Ue.closest("ion-header"),Gt=Ft?.classList.contains("header-collapse-condense-inactive");let wn;wn=Ne.filter(mt?It=>{const at=It.classList.contains("buttons-collapse");return at&&!Gt||!at}:It=>!It.classList.contains("buttons-collapse")),_t.addElement(wn);const Xt=(0,v.c)();Xt.addElement(Ue.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const mn=(0,v.c)();mn.addElement(W(Ue).querySelector(".toolbar-background"));const sn=(0,v.c)(),Vt=Ue.querySelector("ion-back-button");if(Vt&&sn.addElement(Vt),vt.addAnimation([je,_t,Xt,mn,sn]),_t.fromTo(Me,.01,1),Xt.fromTo(Me,.01,1),mt)Gt||je.fromTo("transform",`translateX(${Xe})`,`translateX(${Ke})`).fromTo(Me,.01,1),Xt.fromTo("transform",`translateX(${Xe})`,`translateX(${Ke})`),sn.fromTo(Me,.01,1);else if(dt||je.fromTo("transform",`translateX(${nt})`,`translateX(${Ke})`).fromTo(Me,.01,1),Xt.fromTo("transform",`translateX(${nt})`,`translateX(${Ke})`),mn.beforeClearStyles([Me,"transform"]),Ft?.translucent?mn.fromTo("transform",Ce?"translateX(-100%)":"translateX(100%)","translateX(0px)"):mn.fromTo(Me,.01,"var(--opacity)"),gt||sn.fromTo(Me,.01,1),Vt&&!gt){const at=(0,v.c)();at.addElement(W(Vt).querySelector(".button-text")).fromTo("transform",Ce?"translateX(-100px)":"translateX(100px)","translateX(0px)"),vt.addAnimation(at)}}),ae){const Ue=(0,v.c)(),vt=ae.querySelector(":scope > ion-content"),je=ae.querySelectorAll(":scope > ion-header > ion-toolbar"),_t=ae.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(vt||0!==je.length||0!==_t.length?(Ue.addElement(vt),Ue.addElement(_t)):Ue.addElement(ae.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),ye.addAnimation(Ue),mt){Ue.beforeClearStyles([Me]).fromTo("transform",`translateX(${Ke})`,Ce?"translateX(-100%)":"translateX(100%)");const Ne=(0,d.g)(ae);ye.afterAddWrite(()=>{"normal"===ye.getDirection()&&Ne.style.setProperty("display","none")})}else Ue.fromTo("transform",`translateX(${Ke})`,`translateX(${Xe})`).fromTo(Me,1,.8);if(vt){const Ne=W(vt).querySelector(".transition-effect");if(Ne){const Ft=Ne.querySelector(".transition-cover"),Gt=Ne.querySelector(".transition-shadow"),wn=(0,v.c)(),Xt=(0,v.c)(),mn=(0,v.c)();wn.addElement(Ne).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Xt.addElement(Ft).beforeClearStyles([Me]).fromTo(Me,.1,0),mn.addElement(Gt).beforeClearStyles([Me]).fromTo(Me,.7,.03),wn.addAnimation([Xt,mn]),Ue.addAnimation([wn])}}je.forEach(Ne=>{const Ft=(0,v.c)();Ft.addElement(Ne);const Gt=(0,v.c)();Gt.addElement(Ne.querySelector("ion-title"));const wn=(0,v.c)(),Xt=Ne.querySelectorAll("ion-buttons,[menuToggle]"),mn=Ne.closest("ion-header"),sn=mn?.classList.contains("header-collapse-condense-inactive"),Vt=Array.from(Xt).filter(Nt=>{const yi=Nt.classList.contains("buttons-collapse");return yi&&!sn||!yi});wn.addElement(Vt);const It=(0,v.c)(),at=Ne.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");at.length>0&&It.addElement(at);const Wt=(0,v.c)();Wt.addElement(W(Ne).querySelector(".toolbar-background"));const dn=(0,v.c)(),Sn=Ne.querySelector("ion-back-button");if(Sn&&dn.addElement(Sn),Ft.addAnimation([Gt,wn,It,dn,Wt]),ye.addAnimation(Ft),dn.fromTo(Me,.99,0),wn.fromTo(Me,.99,0),It.fromTo(Me,.99,0),mt){if(sn||Gt.fromTo("transform",`translateX(${Ke})`,Ce?"translateX(-100%)":"translateX(100%)").fromTo(Me,.99,0),It.fromTo("transform",`translateX(${Ke})`,Ce?"translateX(-100%)":"translateX(100%)"),Wt.beforeClearStyles([Me,"transform"]),mn?.translucent?Wt.fromTo("transform","translateX(0px)",Ce?"translateX(-100%)":"translateX(100%)"):Wt.fromTo(Me,"var(--opacity)",0),Sn&&!ct){const yi=(0,v.c)();yi.addElement(W(Sn).querySelector(".button-text")).fromTo("transform",`translateX(${Ke})`,`translateX(${(Ce?-124:124)+"px"})`),Ft.addAnimation(yi)}}else sn||Gt.fromTo("transform",`translateX(${Ke})`,`translateX(${Xe})`).fromTo(Me,.99,0).afterClearStyles([ze,Me]),It.fromTo("transform",`translateX(${Ke})`,`translateX(${Xe})`).afterClearStyles([ze,Me]),dn.afterClearStyles([Me]),Gt.afterClearStyles([Me]),wn.afterClearStyles([Me])})}return ye}catch(Le){throw Le}}},5298:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{mdTransitionAnimation:()=>Q});var v=R(6506),d=R(8354);R(7643),R(6953);const Q=(ie,W)=>{var w,fe,Ae;const se="back"===W.direction,ge=W.leavingEl,we=(0,d.g)(W.enteringEl),Le=we.querySelector("ion-toolbar"),Me=(0,v.c)();if(Me.addElement(we).fill("both").beforeRemoveClass("ion-page-invisible"),se?Me.duration((null!==(w=W.duration)&&void 0!==w?w:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):Me.duration((null!==(fe=W.duration)&&void 0!==fe?fe:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform","translateY(40px)","translateY(0px)").fromTo("opacity",.01,1),Le){const ze=(0,v.c)();ze.addElement(Le),Me.addAnimation(ze)}if(ge&&se){Me.duration((null!==(Ae=W.duration)&&void 0!==Ae?Ae:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const ze=(0,v.c)();ze.addElement((0,d.g)(ge)).onFinish(Ke=>{1===Ke&&ze.elements.length>0&&ze.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)","translateY(40px)").fromTo("opacity",1,0),Me.addAnimation(ze)}return Me}},645:(zn,Ct,R)=>{"use strict";R.d(Ct,{B:()=>Ft,G:()=>Gt,a:()=>De,b:()=>X,c:()=>we,d:()=>wn,e:()=>Xt,f:()=>ye,g:()=>dt,h:()=>Ue,i:()=>je,j:()=>Me,k:()=>ze,l:()=>se,m:()=>Te,n:()=>fe,o:()=>Ce,q:()=>Ze,s:()=>Ne,t:()=>Le});var v=R(5861),d=R(7876),y=R(9439),s=R(5421),Q=R(544),ie=R(7690);let W=0,w=0;const fe=new WeakMap,Ae=mn=>({create:sn=>Ke(mn,sn),dismiss:(sn,Vt,It)=>mt(document,sn,Vt,mn,It),getTop:()=>(0,v.Z)(function*(){return Ze(document,mn)})()}),De=Ae("ion-alert"),X=Ae("ion-action-sheet"),se=Ae("ion-loading"),Te=Ae("ion-modal"),we=Ae("ion-popover"),Le=Ae("ion-toast"),Me=mn=>{typeof document<"u"&&ae(document);const sn=W++;mn.overlayIndex=sn},ze=mn=>(mn.hasAttribute("id")||(mn.id="ion-overlay-"+ ++w),mn.id),Ke=(mn,sn)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(mn).then(()=>{const Vt=document.createElement(mn);return Vt.classList.add("overlay-hidden"),Object.assign(Vt,Object.assign(Object.assign({},sn),{hasController:!0})),gt(document).appendChild(Vt),new Promise(It=>(0,Q.c)(Vt,It))}):Promise.resolve(),Oe='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Ce=(mn,sn)=>{let Vt=mn.querySelector(Oe);const It=Vt?.shadowRoot;It&&(Vt=It.querySelector(Oe)||Vt),Vt?(0,Q.f)(Vt):sn.focus()},Xe=(mn,sn)=>{const Vt=Array.from(mn.querySelectorAll(Oe));let It=Vt.length>0?Vt[Vt.length-1]:null;const at=It?.shadowRoot;at&&(It=at.querySelector(Oe)||It),It?It.focus():sn.focus()},ae=mn=>{0===W&&(W=1,mn.addEventListener("focus",sn=>{((mn,sn)=>{const Vt=Ze(sn,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),It=mn.target;Vt&&It&&!Vt.classList.contains("ion-disable-focus-trap")&&(Vt.shadowRoot?(()=>{if(Vt.contains(It))Vt.lastFocus=It;else{const dn=Vt.lastFocus;Ce(Vt,Vt),dn===sn.activeElement&&Xe(Vt,Vt),Vt.lastFocus=sn.activeElement}})():(()=>{if(Vt===It)Vt.lastFocus=void 0;else{const dn=(0,Q.g)(Vt);if(!dn.contains(It))return;const Sn=dn.querySelector(".ion-overlay-wrapper");if(!Sn)return;if(Sn.contains(It))Vt.lastFocus=It;else{const Nt=Vt.lastFocus;Ce(Sn,Vt),Nt===sn.activeElement&&Xe(Sn,Vt),Vt.lastFocus=sn.activeElement}}})())})(sn,mn)},!0),mn.addEventListener("ionBackButton",sn=>{const Vt=Ze(mn);Vt?.backdropDismiss&&sn.detail.register(s.OVERLAY_BACK_BUTTON_PRIORITY,()=>Vt.dismiss(void 0,Ft))}),mn.addEventListener("keydown",sn=>{if("Escape"===sn.key){const Vt=Ze(mn);Vt?.backdropDismiss&&Vt.dismiss(void 0,Ft)}}))},mt=(mn,sn,Vt,It,at)=>{const Wt=Ze(mn,It,at);return Wt?Wt.dismiss(sn,Vt):Promise.reject("overlay does not exist")},Ze=(mn,sn,Vt)=>{const It=((mn,sn)=>(void 0===sn&&(sn="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(mn.querySelectorAll(sn)).filter(Vt=>Vt.overlayIndex>0)))(mn,sn).filter(at=>!(mn=>mn.classList.contains("overlay-hidden"))(at));return void 0===Vt?It[It.length-1]:It.find(at=>at.id===Vt)},Se=(mn=!1)=>{const Vt=gt(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");Vt&&(mn?Vt.setAttribute("aria-hidden","true"):Vt.removeAttribute("aria-hidden"))},ye=function(){var mn=(0,v.Z)(function*(sn,Vt,It,at,Wt){var dn,Sn;if(sn.presented)return;Se(!0),sn.presented=!0,sn.willPresent.emit(),null===(dn=sn.willPresentShorthand)||void 0===dn||dn.emit();const Nt=(0,d.b)(sn),yi=sn.enterAnimation?sn.enterAnimation:d.c.get(Vt,"ios"===Nt?It:at);(yield ct(sn,yi,sn.el,Wt))&&(sn.didPresent.emit(),null===(Sn=sn.didPresentShorthand)||void 0===Sn||Sn.emit()),"ION-TOAST"!==sn.el.tagName&&Qt(sn.el),sn.keyboardClose&&(null===document.activeElement||!sn.el.contains(document.activeElement))&&sn.el.focus()});return function(Vt,It,at,Wt,dn){return mn.apply(this,arguments)}}(),Qt=function(){var mn=(0,v.Z)(function*(sn){let Vt=document.activeElement;if(!Vt)return;const It=Vt?.shadowRoot;It&&(Vt=It.querySelector(Oe)||Vt),yield sn.onDidDismiss(),Vt.focus()});return function(Vt){return mn.apply(this,arguments)}}(),dt=function(){var mn=(0,v.Z)(function*(sn,Vt,It,at,Wt,dn,Sn){var Nt,yi;if(!sn.presented)return!1;Se(!1),sn.presented=!1;try{sn.el.style.setProperty("pointer-events","none"),sn.willDismiss.emit({data:Vt,role:It}),null===(Nt=sn.willDismissShorthand)||void 0===Nt||Nt.emit({data:Vt,role:It});const Gi=(0,d.b)(sn),gn=sn.leaveAnimation?sn.leaveAnimation:d.c.get(at,"ios"===Gi?Wt:dn);It!==Gt&&(yield ct(sn,gn,sn.el,Sn)),sn.didDismiss.emit({data:Vt,role:It}),null===(yi=sn.didDismissShorthand)||void 0===yi||yi.emit({data:Vt,role:It}),fe.delete(sn),sn.el.classList.add("overlay-hidden"),sn.el.style.removeProperty("pointer-events"),void 0!==sn.el.lastFocus&&(sn.el.lastFocus=void 0)}catch(Gi){console.error(Gi)}return sn.el.remove(),!0});return function(Vt,It,at,Wt,dn,Sn,Nt){return mn.apply(this,arguments)}}(),gt=mn=>mn.querySelector("ion-app")||mn.body,ct=function(){var mn=(0,v.Z)(function*(sn,Vt,It,at){It.classList.remove("overlay-hidden");const dn=Vt(sn.el,at);(!sn.animated||!d.c.getBoolean("animated",!0))&&dn.duration(0),sn.keyboardClose&&dn.beforeAddWrite(()=>{const Nt=It.ownerDocument.activeElement;Nt?.matches("input,ion-input, ion-textarea")&&Nt.blur()});const Sn=fe.get(sn)||[];return fe.set(sn,[...Sn,dn]),yield dn.play(),!0});return function(Vt,It,at,Wt){return mn.apply(this,arguments)}}(),Ue=(mn,sn)=>{let Vt;const It=new Promise(at=>Vt=at);return vt(mn,sn,at=>{Vt(at.detail)}),It},vt=(mn,sn,Vt)=>{const It=at=>{(0,Q.b)(mn,sn,It),Vt(at)};(0,Q.a)(mn,sn,It)},je=mn=>"cancel"===mn||mn===Ft,_t=mn=>mn(),Ne=(mn,sn)=>{if("function"==typeof mn)return d.c.get("_zoneGate",_t)(()=>{try{return mn(sn)}catch(It){throw It}})},Ft="backdrop",Gt="gesture",wn=mn=>{let Vt,sn=!1;const It=(0,y.C)(),at=(Sn=!1)=>{if(Vt&&!Sn)return{delegate:Vt,inline:sn};const{el:Nt,hasController:yi,delegate:Gi}=mn;return sn=null!==Nt.parentNode&&!yi,Vt=sn?Gi||It:Gi,{inline:sn,delegate:Vt}};return{attachViewToDom:function(){var Sn=(0,v.Z)(function*(Nt){const{delegate:yi}=at(!0);if(yi)return yield yi.attachViewToDom(mn.el,Nt);const{hasController:Gi}=mn;if(Gi&&void 0!==Nt)throw new Error("framework delegate is missing");return null});return function(yi){return Sn.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:Sn}=at();Sn&&void 0!==mn.el&&Sn.removeViewFromDom(mn.el.parentElement,mn.el)}}},Xt=()=>{let mn;const sn=()=>{mn&&(mn(),mn=void 0)};return{addClickListener:(It,at)=>{sn();const Wt=void 0!==at?document.getElementById(at):null;Wt?mn=((Sn,Nt)=>{const yi=()=>{Nt.present()};return Sn.addEventListener("click",yi),()=>{Sn.removeEventListener("click",yi)}})(Wt,It):(0,ie.p)(`A trigger element with the ID "${at}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,It)},removeClickListener:sn}}},1163:(zn,Ct,R)=>{"use strict";R.d(Ct,{B:()=>se});var v=R(1180),d=R(2029),y=R(866),s=R(6814),Q=R(7852);function ie(Te,ge){if(1&Te&&(d.TgZ(0,"ion-badge",7),d._uU(1),d.qZA()),2&Te){const we=d.oxw().$implicit;d.xp6(1),d.hij("",we.Quantity," x")}}function W(Te,ge){if(1&Te&&(d.TgZ(0,"strong"),d._uU(1),d.qZA()),2&Te){const we=d.oxw().$implicit;d.xp6(1),d.hij("",we.PowerKW," kW ")}}function w(Te,ge){if(1&Te&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&Te){const we=d.oxw().$implicit;d.xp6(1),d.hij("",null==we.CurrentType?null:we.CurrentType.Title," ")}}function fe(Te,ge){if(1&Te&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&Te){const we=d.oxw().$implicit;d.xp6(1),d.hij("",we.Amps,"A ")}}function Ae(Te,ge){if(1&Te&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&Te){const we=d.oxw().$implicit;d.xp6(1),d.hij("",we.Voltage,"V ")}}function De(Te,ge){if(1&Te){const we=d.EpF();d.TgZ(0,"ion-col")(1,"ion-button",8),d.NdJ("click",function(){d.CHM(we);const Me=d.oxw().$implicit,ze=d.oxw();return d.KtG(ze.editConnection(Me))}),d._UZ(2,"ion-icon",9),d.qZA(),d._UZ(3,"br"),d.TgZ(4,"ion-button",10),d.NdJ("click",function(){d.CHM(we);const Me=d.oxw().$implicit,ze=d.oxw();return d.KtG(ze.deleteConnection(Me))}),d._UZ(5,"ion-icon",11),d.qZA()()}}function X(Te,ge){if(1&Te&&(d.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-row")(3,"ion-col",1),d._UZ(4,"img",2),d.YNc(5,ie,2,1,"ion-badge",3),d.TgZ(6,"div",4),d._uU(7),d.qZA()(),d.TgZ(8,"ion-col")(9,"ion-row")(10,"ion-col")(11,"ion-note")(12,"div")(13,"strong",5),d._uU(14),d.qZA()(),d.YNc(15,W,2,1,"strong",6),d.YNc(16,w,2,1,"div",6),d.qZA(),d.TgZ(17,"ion-note"),d.YNc(18,fe,2,1,"span",6),d.YNc(19,Ae,2,1,"span",6),d.qZA()()(),d.TgZ(20,"ion-row")(21,"ion-col",4),d._uU(22),d.qZA(),d.TgZ(23,"ion-col",4),d._uU(24),d.qZA()()(),d.YNc(25,De,6,0,"ion-col",6),d.qZA()()()),2&Te){const we=ge.$implicit,Le=d.oxw();d.xp6(4),d.Q6J("src",Le.getConnectorTypeIcon(we.ConnectionTypeID),d.LSH),d.xp6(1),d.Q6J("ngIf",we.Quantity),d.xp6(2),d.Oqu(null==we.StatusType?null:we.StatusType.Title),d.xp6(6),d.s9C("title",null==we.ConnectionType?null:we.ConnectionType.FormalName),d.xp6(1),d.hij("",null==we.ConnectionType?null:we.ConnectionType.Title," "),d.xp6(1),d.Q6J("ngIf",we.PowerKW),d.xp6(1),d.Q6J("ngIf",we.CurrentTypeID),d.xp6(2),d.Q6J("ngIf",we.Amps),d.xp6(1),d.Q6J("ngIf",we.Voltage),d.xp6(3),d.Oqu(we.Reference),d.xp6(2),d.Oqu(we.Comments),d.xp6(1),d.Q6J("ngIf",Le.enableEdit)}}let se=(()=>{class Te{constructor(){(0,v.Z)(this,"item",void 0),(0,v.Z)(this,"enableEdit",!1),(0,v.Z)(this,"onEdit",new d.vpe),(0,v.Z)(this,"onDelete",new d.vpe)}ngOnInit(){}editConnection(we){this.onEdit.emit(we)}deleteConnection(we){this.onDelete.emit(we)}getConnectorTypeIcon(we){return y.c.getIconForConnector(we)}}return(0,v.Z)(Te,"\u0275fac",function(we){return new(we||Te)}),(0,v.Z)(Te,"\u0275cmp",d.Xpm({type:Te,selectors:[["app-equipment-details"]],inputs:{item:"item",enableEdit:"enableEdit"},outputs:{onEdit:"onEdit",onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["size","3"],[2,"max-width","64px",3,"src"],["color","primary",4,"ngIf"],[1,"info"],[3,"title"],[4,"ngIf"],["color","primary"],["size","small","color","secondary",3,"click"],["name","create","slot","icon-only"],["size","small","color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(we,Le){1&we&&(d.TgZ(0,"ion-grid"),d.YNc(1,X,26,12,"ion-row",0),d.qZA()),2&we&&(d.xp6(1),d.Q6J("ngForOf",Le.item.Connections))},dependencies:[s.sg,s.O5,Q.yp,Q.YG,Q.wI,Q.jY,Q.gu,Q.uN,Q.Nd]})),Te})()},6086:(zn,Ct,R)=>{"use strict";R.d(Ct,{z:()=>Le});var v=R(5861),d=R(1180),y=R(2029),s=R(9159),Q=R(6814),ie=R(7852),W=R(6223);function w(Me,ze){if(1&Me&&(y.TgZ(0,"ion-select-option",5),y._uU(1),y.qZA()),2&Me){const Ke=ze.$implicit;y.Q6J("value",Ke.ID),y.xp6(1),y.Oqu(Ke.Title)}}function fe(Me,ze){1&Me&&(y.TgZ(0,"ion-select-option",6),y._uU(1,"Other..."),y.qZA())}function Ae(Me,ze){if(1&Me){const Ke=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label",1),y._uU(2,"Network Operator"),y.qZA(),y.TgZ(3,"ion-select",2),y.NdJ("ngModelChange",function(Ce){y.CHM(Ke);const nt=y.oxw();return y.KtG(nt.operatorId=Ce)})("ionChange",function(){y.CHM(Ke);const Ce=y.oxw();return y.KtG(Ce.onOperatorChange())}),y.YNc(4,w,2,2,"ion-select-option",3),y.YNc(5,fe,2,0,"ion-select-option",4),y.qZA()()}if(2&Me){const Ke=y.oxw();y.xp6(3),y.Q6J("ngModel",Ke.operatorId),y.xp6(1),y.Q6J("ngForOf",Ke.operators),y.xp6(1),y.Q6J("ngIf",Ke.useFilteredOperators)}}function De(Me,ze){if(1&Me){const Ke=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label"),y._uU(2,"Network Operator"),y.qZA(),y.TgZ(3,"ion-searchbar",7),y.NdJ("ionCancel",function(){y.CHM(Ke);const Ce=y.oxw();return y.KtG(Ce.cancelOperatorLookup())})("ngModelChange",function(Ce){y.CHM(Ke);const nt=y.oxw();return y.KtG(nt.operatorSearchKeyword=Ce)})("ionInput",function(Ce){y.CHM(Ke);const nt=y.oxw();return y.KtG(nt.searchOperators(Ce))}),y.qZA()()}if(2&Me){const Ke=y.oxw();y.xp6(3),y.Q6J("ngModel",Ke.operatorSearchKeyword)}}function X(Me,ze){if(1&Me){const Ke=y.EpF();y.TgZ(0,"ion-item",9),y.NdJ("click",function(){const nt=y.CHM(Ke).$implicit,Xe=y.oxw(2);return y.KtG(Xe.onOperatorChange(nt))}),y.TgZ(1,"ion-avatar",10),y._UZ(2,"ion-icon",11),y.qZA(),y.TgZ(3,"ion-label")(4,"p"),y._uU(5),y.qZA(),y.TgZ(6,"p"),y._uU(7),y.qZA()()()}if(2&Me){const Ke=ze.$implicit;y.xp6(5),y.Oqu(Ke.Title),y.xp6(2),y.Oqu(Ke.WebsiteURL)}}function se(Me,ze){if(1&Me&&(y.ynx(0),y.TgZ(1,"ion-list"),y.YNc(2,X,8,2,"ion-item",8),y.qZA(),y.BQk()),2&Me){const Ke=y.oxw();y.xp6(2),y.Q6J("ngForOf",Ke.operatorSearchResults)}}function Te(Me,ze){if(1&Me){const Ke=y.EpF();y.ynx(0),y.TgZ(1,"ion-item")(2,"ion-avatar",10),y._UZ(3,"ion-icon",12),y.qZA(),y.TgZ(4,"ion-label")(5,"p"),y._uU(6),y.qZA(),y.TgZ(7,"p"),y._uU(8),y.qZA(),y.TgZ(9,"ion-button",9),y.NdJ("click",function(){y.CHM(Ke);const Ce=y.oxw();return y.KtG(Ce.selectedOperator=null)}),y._uU(10,"Change"),y.qZA()()(),y.BQk()}if(2&Me){const Ke=y.oxw();y.xp6(6),y.Oqu(Ke.selectedOperator.Title),y.xp6(2),y.Oqu(Ke.selectedOperator.WebsiteURL)}}function ge(Me,ze){if(1&Me){const Ke=y.EpF();y.TgZ(0,"ion-chip")(1,"ion-label"),y._uU(2),y.qZA(),y.TgZ(3,"ion-icon",14),y.NdJ("click",function(){const nt=y.CHM(Ke).$implicit,Xe=y.oxw(2);return y.KtG(Xe.removeOperator(nt))}),y.qZA()()}if(2&Me){const Ke=ze.$implicit,Oe=y.oxw(2);y.xp6(2),y.Oqu(Oe.getOperatorInfo(Ke).Title)}}function we(Me,ze){if(1&Me&&(y.ynx(0),y.YNc(1,ge,4,1,"ion-chip",13),y.BQk()),2&Me){const Ke=y.oxw();y.xp6(1),y.Q6J("ngForOf",Ke.operatorList)}}let Le=(()=>{class Me{get operators(){return this.referenceDataManager.getNetworkOperators(this.useFilteredOperators)}constructor(Ke,Oe){(0,d.Z)(this,"referenceDataManager",void 0),(0,d.Z)(this,"changeDetector",void 0),(0,d.Z)(this,"operatorId",null),(0,d.Z)(this,"operatorList",null),(0,d.Z)(this,"mode","single"),(0,d.Z)(this,"useFilteredOperators",null),(0,d.Z)(this,"operatorChanged",new y.vpe),(0,d.Z)(this,"operatorRemoved",new y.vpe),(0,d.Z)(this,"operatorCache",[]),(0,d.Z)(this,"operatorSearchResults",[]),(0,d.Z)(this,"operatorSearchKeyword",""),(0,d.Z)(this,"selectedOperator",null),this.referenceDataManager=Ke,this.changeDetector=Oe}ngOnInit(){this.operatorCache=this.referenceDataManager.getNetworkOperators(!1),null!=this.operatorId&&(this.selectedOperator=this.operatorCache.find(Ke=>Ke.ID==this.operatorId))}searchOperators(){this.operatorSearchResults=[],0!=this.operatorSearchKeyword.length&&(this.operatorSearchResults=this.operatorCache?this.operatorCache.filter(Ke=>Ke.Title.toLowerCase().startsWith(this.operatorSearchKeyword.toLowerCase())||Ke.Title.toLowerCase().startsWith("("+this.operatorSearchKeyword.toLowerCase())).slice(0,10):[])}getOperatorInfo(Ke){if(this.operatorCache)return this.operatorCache.find(Oe=>Oe.ID==Ke)}onOperatorChange(Ke=null){var Oe=this;return(0,v.Z)(function*(){null==Ke&&Oe.operatorId&&(Ke=Oe.operatorCache.find(Ce=>Ce.ID==Oe.operatorId)),null!=Ke&&(Oe.operatorSearchResults=[],Oe.selectedOperator=Ke,Oe.operatorId=Ke.ID),Oe.operatorId?(Oe.operatorChanged.emit(Oe.selectedOperator),"single"!=Oe.mode&&(Oe.selectedOperator=null,Oe.operatorSearchKeyword="")):Oe.useFilteredOperators=!1})()}removeOperator(Ke){var Oe=this;return(0,v.Z)(function*(){Oe.operatorId=null,Oe.operatorRemoved.emit(Ke)})()}cancelOperatorLookup(){this.selectedOperator=null}}return(0,d.Z)(Me,"\u0275fac",function(Ke){return new(Ke||Me)(y.Y36(s.W),y.Y36(y.sBO))}),(0,d.Z)(Me,"\u0275cmp",y.Xpm({type:Me,selectors:[["app-operator-lookup"]],inputs:{operatorId:"operatorId",operatorList:"operatorList",mode:"mode",useFilteredOperators:"useFilteredOperators"},outputs:{operatorChanged:"operatorChanged",operatorRemoved:"operatorRemoved"},decls:5,vars:5,consts:[[4,"ngIf"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value"],["value",""],["placeholder","Search by network name (in any country)","showCancelButton","focus","autocomplete","on",3,"ngModel","ionCancel","ngModelChange","ionInput"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["item-left",""],["name","card"],["name","locate"],[4,"ngFor","ngForOf"],["name","close-circle",3,"click"]],template:function(Ke,Oe){1&Ke&&(y.YNc(0,Ae,6,3,"ion-item",0),y.YNc(1,De,4,1,"ion-item",0),y.YNc(2,se,3,1,"ng-container",0),y.YNc(3,Te,11,2,"ng-container",0),y.YNc(4,we,2,1,"ng-container",0)),2&Ke&&(y.Q6J("ngIf",Oe.useFilteredOperators&&!Oe.selectedOperator),y.xp6(1),y.Q6J("ngIf",!Oe.useFilteredOperators&&!Oe.selectedOperator),y.xp6(1),y.Q6J("ngIf",Oe.operatorSearchResults.length>0),y.xp6(1),y.Q6J("ngIf",null!=Oe.selectedOperator),y.xp6(1),y.Q6J("ngIf",(null==Oe.operatorList?null:Oe.operatorList.length)>0))},dependencies:[Q.sg,Q.O5,ie.BJ,ie.YG,ie.hM,ie.gu,ie.Ie,ie.Q$,ie.q_,ie.VI,ie.t9,ie.n0,ie.QI,ie.j9,W.JJ,W.On]})),Me})()},5460:(zn,Ct,R)=>{"use strict";R.d(Ct,{v:()=>se});var v=R(5861),d=R(1180),y=R(9127),s=R(2029),Q=R(9903),ie=R(7852),W=R(9862),w=R(5957),fe=R(6814);function Ae(Te,ge){1&Te&&(s.TgZ(0,"div"),s._UZ(1,"ion-spinner"),s.qZA())}function De(Te,ge){if(1&Te){const we=s.EpF();s.TgZ(0,"ion-item",5),s.NdJ("click",function(){const ze=s.CHM(we).$implicit,Ke=s.oxw(2);return s.KtG(Ke.placeSelected(ze))}),s.TgZ(1,"ion-avatar",6),s._UZ(2,"ion-icon",7),s.qZA(),s.TgZ(3,"ion-label")(4,"p"),s._uU(5),s.qZA()()()}if(2&Te){const we=ge.$implicit;s.xp6(5),s.Oqu(we.Address)}}function X(Te,ge){if(1&Te&&(s.TgZ(0,"div",1),s.YNc(1,Ae,2,0,"div",2),s.TgZ(2,"ion-list"),s.YNc(3,De,6,1,"ion-item",3),s.TgZ(4,"ion-item")(5,"p",4),s._uU(6),s.qZA()()()()),2&Te){const we=s.oxw();s.xp6(1),s.Q6J("ngIf",we.searchInProgress),s.xp6(2),s.Q6J("ngForOf",we.placeList),s.xp6(3),s.hij(" ",we.placeAttribution," ")}}let se=(()=>{class Te{constructor(we,Le,Me,ze,Ke){(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"changeDetector",void 0),(0,d.Z)(this,"platform",void 0),(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"placeSearchType",void 0),(0,d.Z)(this,"placeList",void 0),(0,d.Z)(this,"searchInProgress",!1),(0,d.Z)(this,"searchKeyword",void 0),(0,d.Z)(this,"placeSearchFocused",void 0),(0,d.Z)(this,"placeSearchActive",!1),(0,d.Z)(this,"placeAttribution",""),(0,d.Z)(this,"selectedPlace",void 0),(0,d.Z)(this,"placeChanged",new s.vpe),(0,d.Z)(this,"mapService",void 0),this.logging=we,this.changeDetector=Le,this.platform=Me,this.http=ze,this.events=Ke,this.searchKeyword="",this.searchInProgress=!1,this.mapService=new Q.k(Ke,we,ze)}ngOnInit(){var we=this;return(0,v.Z)(function*(){yield we.platform.ready(),we.mapService.initAPI()})()}onSearchFocus(){this.placeSearchFocused=!0}onSearchBlur(){this.placeSearchFocused=!1}onSearchCancel(){}getPlacesAutoComplete(we,Le){var Me=this;return(0,v.Z)(function*(){Me.placeSearchType=Le;let ze=we.target.value;if(ze&&ze.length>3){Me.logging.log("Starting place lookup for:"+ze),Me.placeSearchActive=!0,Me.searchInProgress=!0,Me.searchInProgress=!1,Me.placeSearchActive=!0;try{Me.placeList=yield Me.mapService.placeSearch(ze),Me.placeList&&Me.placeList.length>0&&(Me.placeAttribution=Me.placeList[0].Attribution)}catch{}Me.searchInProgress=!1,Me.placeSearchActive=!0}else Me.searchInProgress=!1,Me.placeSearchActive=!1})()}placeSelected(we){this.logging.log("Looking up place details:"+we.Title+"::"+we.ReferenceID),this.selectedPlace=we,this.placeChanged.emit(we),this.placeSearchActive=!1}}return(0,d.Z)(Te,"\u0275fac",function(we){return new(we||Te)(s.Y36(y.z),s.Y36(s.sBO),s.Y36(ie.t4),s.Y36(W.eN),s.Y36(w.z))}),(0,d.Z)(Te,"\u0275cmp",s.Xpm({type:Te,selectors:[["place-search"]],inputs:{searchKeyword:"searchKeyword"},outputs:{selectedPlace:"selectedPlace",placeChanged:"placeChanged"},decls:1,vars:1,consts:[["class","place-search",4,"ngIf"],[1,"place-search"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"place-attribution"],[3,"click"],["item-left",""],["name","locate"]],template:function(we,Le){1&we&&s.YNc(0,X,7,3,"div",0),2&we&&s.Q6J("ngIf",Le.placeSearchActive)},dependencies:[fe.sg,fe.O5,ie.BJ,ie.gu,ie.Ie,ie.Q$,ie.q_,ie.PQ],styles:[".place-search[_ngcontent-%COMP%]{position:absolute;z-index:1000}.place-attribution[_ngcontent-%COMP%]{font-size:9px;color:#dcdcdc;max-width:100%}"]})),Te})()},8696:(zn,Ct,R)=>{"use strict";R.d(Ct,{o:()=>fe});var v=R(1180),d=R(2029),y=R(866),s=R(6814),Q=R(7852);function ie(Ae,De){if(1&Ae){const X=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(X);const Te=d.oxw().$implicit,ge=d.oxw();return d.KtG(ge.onCopyCommand(Te))}),d._uU(1,"Copy"),d.qZA()}}function W(Ae,De){if(1&Ae){const X=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(X);const Te=d.oxw().$implicit,ge=d.oxw();return d.KtG(ge.onEditCommand(Te))}),d._uU(1,"Edit"),d.qZA()}}function w(Ae,De){if(1&Ae&&(d.TgZ(0,"ion-item",1)(1,"ion-grid")(2,"ion-row")(3,"ion-col"),d._uU(4),d.qZA()(),d.TgZ(5,"ion-row")(6,"ion-col",2)(7,"p"),d._UZ(8,"img",3),d.qZA(),d.TgZ(9,"ion-note"),d._uU(10),d.qZA(),d.YNc(11,ie,2,0,"ion-button",4),d.YNc(12,W,2,0,"ion-button",4),d.qZA(),d.TgZ(13,"ion-col")(14,"ion-row")(15,"ion-col")(16,"p"),d._uU(17),d.qZA(),d.TgZ(18,"ion-note"),d._uU(19),d.qZA()()(),d.TgZ(20,"ion-row")(21,"ion-col"),d._uU(22),d.qZA(),d.TgZ(23,"ion-col"),d._uU(24),d.qZA()()()()()()),2&Ae){const X=De.$implicit,se=d.oxw();d.xp6(4),d.hij(" ",X.AddressInfo.Title," "),d.xp6(4),d.Q6J("src",se.getIconForPOI(X),d.LSH),d.xp6(2),d.hij(" ",se.getFormattedDistance(X)," "),d.xp6(1),d.Q6J("ngIf",se.enableCopyOption),d.xp6(1),d.Q6J("ngIf",se.enableEditOption),d.xp6(5),d.hij(" ",se.getFormattedAddress(X)," "),d.xp6(2),d.hij(" ",se.getFormattedConnectorList(X)," "),d.xp6(3),d.hij(" ",null==X.UsageType?null:X.UsageType.Title," "),d.xp6(2),d.hij(" ",null==X.OperatorInfo?null:X.OperatorInfo.Title," ")}}let fe=(()=>{class Ae{constructor(){(0,v.Z)(this,"enableCopyOption",!1),(0,v.Z)(this,"enableEditOption",!1),(0,v.Z)(this,"poiList",[]),(0,v.Z)(this,"onCopy",new d.vpe),(0,v.Z)(this,"onEdit",new d.vpe)}ngOnInit(){}onCopyCommand(X){this.onCopy.emit(X)}onEditCommand(X){this.onEdit.emit(X)}getFormattedAddress(X){let se="";return se+=X.AddressInfo.Title!=X.AddressInfo.AddressLine1?X.AddressInfo.Title:X.AddressInfo.Town,se}getFormattedConnectorList(X){if(!X.Connections)return;let se=[];for(let Te of X.Connections)null!=Te.ConnectionType&&(se.find(ge=>ge==Te.ConnectionType.Title)||se.push(Te.ConnectionType.Title));return se.join(", ")}getIconForPOI(X){return y.c.getIconForPOI(X)}getFormattedDistance(X){return y.c.getFormattedDistance(X)}}return(0,v.Z)(Ae,"\u0275fac",function(X){return new(X||Ae)}),(0,v.Z)(Ae,"\u0275cmp",d.Xpm({type:Ae,selectors:[["app-poi-list"]],inputs:{enableCopyOption:"enableCopyOption",enableEditOption:"enableEditOption",poiList:"poiList"},outputs:{onCopy:"onCopy",onEdit:"onEdit"},decls:2,vars:1,consts:[["style","max-width:400px;",4,"ngFor","ngForOf"],[2,"max-width","400px"],["size","3"],[2,"width","24px",3,"src"],["size","small",3,"click",4,"ngIf"],["size","small",3,"click"]],template:function(X,se){1&X&&(d.TgZ(0,"ion-list"),d.YNc(1,w,25,9,"ion-item",0),d.qZA()),2&X&&(d.xp6(1),d.Q6J("ngForOf",se.poiList))},dependencies:[s.sg,s.O5,Q.YG,Q.wI,Q.jY,Q.Ie,Q.q_,Q.uN,Q.Nd]})),Ae})()},5086:(zn,Ct,R)=>{"use strict";R.d(Ct,{e:()=>W});var v=R(1180),d=R(6814),y=R(7852),s=R(6223),Q=R(3999),ie=R(2029);let W=(()=>{class w{}return(0,v.Z)(w,"\u0275fac",function(Ae){return new(Ae||w)}),(0,v.Z)(w,"\u0275mod",ie.oAB({type:w})),(0,v.Z)(w,"\u0275inj",ie.cJS({providers:[d.JJ],imports:[d.ez,y.Pc,s.u5,Q.aw]})),w})()},7777:(zn,Ct,R)=>{"use strict";R.d(Ct,{X:()=>y});var v=R(1180),d=R(553);class y{constructor(){(0,v.Z)(this,"baseURL",void 0),(0,v.Z)(this,"loginProviderRedirectBaseURL",void 0),(0,v.Z)(this,"loginProviderRedirectURL",void 0),(0,v.Z)(this,"enableLiveMapQuerying",void 0),(0,v.Z)(this,"googleMapsAPIKey",void 0),(0,v.Z)(this,"enableStaticMaps",void 0),this.baseURL="https://map.openchargemap.io",this.loginProviderRedirectBaseURL="https://openchargemap.org/site/loginprovider/?_mode=silent&_forceLogin=true&_redirectURL=",this.loginProviderRedirectURL=this.loginProviderRedirectBaseURL+this.baseURL,this.enableLiveMapQuerying=!0,this.googleMapsAPIKey=d.N.googleMapsKey,this.enableStaticMaps=d.N.enableStaticMaps}}},866:(zn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>y});var v=R(1180),d=R(553);let y=(()=>{class s{static isFeatureEnabled(ie){return!!d.N.enabledFeatures.find(W=>W===ie)}static getClientHeight(){const ie=document.body,W=document.documentElement;return Math.max(ie.scrollHeight,ie.offsetHeight,W.clientHeight,W.scrollHeight,W.offsetHeight)}static getClientWidth(){const ie=document.body,W=document.documentElement;return Math.max(ie.scrollWidth,ie.offsetWidth,W.clientWidth,W.scrollWidth,W.offsetWidth)}static getMaxLevelOfPOI(ie){let W=0;if(null!=ie.Connections)for(let w=0;w<ie.Connections.length;w++)null!=ie.Connections[w].Level&&ie.Connections[w].Level.ID>W&&(W=ie.Connections[w].Level.ID);return 4===W&&(W=2),W>4&&(W=3),W}static getIconForPOI(ie){let w="assets/images/icons/map/level"+s.getMaxLevelOfPOI(ie);return null!=ie.UsageType&&ie.UsageType.Title.indexOf("Private")>-1?w+="_private":w+=null!=ie.StatusType&&!0!==ie.StatusType.IsOperational?"_nonoperational":"_operational",w+="_icon.png",w}static getColorForPOI(ie){const W=s.getMaxLevelOfPOI(ie);let w="#c0c0c0";return null!=ie.UsageType&&ie.UsageType.Title.indexOf("Private")>-1?w="#FF0000":null!=ie.StatusType&&!0!==ie.StatusType.IsOperational?w="#a0a0a0":2==W?w="#72EB0D":3==W&&(w="#EB800D"),w}static getIconForConnector(ie){let W="assets/images/icons/connectors/";return W+=1===ie?"Type1_J1772.svg":2===ie?"Chademo_type4.svg":25===ie?"Type2_socket.svg":32===ie?"Type1_CCS.svg":33===ie?"Type2_CCS.svg":1036===ie?"Type2_tethered.svg":26===ie?"Type3c.svg":28===ie?"schuko.svg":"Unknown.svg",W}static getFormattedDistance(ie){return ie&&ie.AddressInfo&&ie.AddressInfo.Distance?ie.AddressInfo.Distance.toFixed(1)+" "+(1===ie.AddressInfo.DistanceUnit?"km":"miles"):""}static fixJSONDate(ie){if(null==ie)return null;if(0==ie.indexOf("/")){let w=/Date\(([^)]+)\)/.exec(ie);ie=new Date(parseFloat(w[1]))}else ie=new Date(ie);return ie}static formatMapLinkFromPosition(ie,W,w,fe,Ae){return'<a href="https://maps.google.com/maps?saddr='+W+","+w+"&daddr="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude+'">Map ('+Math.ceil(fe)+" "+Ae+")</a>"}static formatSystemWebLink(ie,W){return"<a href='#' onclick=\"window.open('"+ie+"', '_system');return false;\">"+W+"</a>"}static formatMapLink(ie,W,w){return w?device&&"WinCE"==device.platform?this.formatSystemWebLink("maps:"+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude,W):device&&"iOS"===device.platform?this.formatSystemWebLink("https://maps.apple.com/?q="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude,W):this.formatSystemWebLink("https://maps.google.com/maps?q="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude,W):'<a target="_blank"  href="https://maps.google.com/maps?q='+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude+'">'+W+"</a>"}static formatURL(ie,W=null){return null==ie||""==ie?"":(-1==ie.indexOf("http")&&(ie="https://"+ie),'<a target="_blank" href="'+ie+'">'+(W??ie)+"</a>")}static formatString(ie){return null==ie?"":ie.toString()}static formatTextField(ie,W=null,w=!1,fe=!1,Ae=null){if(null==ie||""==ie||null==ie)return"";let De=(null!=W?"<strong class='ocm-label' "+(null!=Ae?"data-localize='"+Ae+"' ":"")+">"+W+"</strong>: ":"")+(w?"<br/>":"")+ie.toString().replace("\n","<br/>")+"<br/>";return 1==fe&&(De="<p>"+De+"</p>"),De}static formatEmailAddress(ie){return null!=ie&&null!=ie&&""!=ie?"<i class='fa fa-envelope fa-fw'></i> <a href=\"mailto:"+ie+'">'+ie+"</a><br/>":""}static formatPhone(ie,W=null){return null!=ie&&null!=ie&&""!=ie?(null==W?W="<i class='fa fa-phone fa-fw '></i> ":W+=": ",W+'<a href="tel:'+ie+'">'+ie+"</a><br/>"):""}static formatPOIDetails(ie,W){let fe=new Date;null==W&&(W=!1);let Ae=this.formatPOIAddress(ie,!1),De="";De+=this.formatPhone(ie.AddressInfo.ContactTelephone1),De+=this.formatPhone(ie.AddressInfo.ContactTelephone2),De+=this.formatEmailAddress(ie.AddressInfo.ContactEmail);let X="";if(null!=ie.AddressInfo.Distance){let Me="https://maps.google.com/maps?saddr=&daddr="+ie.AddressInfo.Latitude+","+ie.AddressInfo.Longitude;X+="<strong id='addr_distance'><span data-localize='details.approxDistance'>Distance</span>: "+ie.AddressInfo.Distance.toFixed(1)+" "+(2==ie.AddressInfo.DistanceUnit?"Miles":"KM")+"</strong>",X+="<p>"+this.formatSystemWebLink(Me,"Get Directions")+"</p>"}if(null!=ie.AddressInfo.RelatedURL&&""!=ie.AddressInfo.RelatedURL){let Me=ie.AddressInfo.RelatedURL;Me=Me.replace(/.*?:\/\//g,""),Me.length>40&&(Me=Me.substr(0,40)+".."),De+="<i class='fa fa-fw fa-external-link'></i>  "+this.formatSystemWebLink(ie.AddressInfo.RelatedURL,"<span data-localize='details.addressRelatedURL'>"+Me+"</span>")}De+="</p>";const se=this.formatTextField(ie.GeneralComments,null,!1,!0)+this.formatTextField(ie.AddressInfo.AccessComments,"Access",!0,!0,"details.accessComments");let Te="";null!=ie.NumberOfPoints&&(Te+=this.formatTextField(ie.NumberOfPoints,"Bays",!1,!0,"details.numberOfPoints")),null!=ie.UsageType&&(Te+=this.formatTextField(ie.UsageType.Title,"Usage",!1,!0,"details.usageType")),null!=ie.UsageCost&&(Te+=this.formatTextField(ie.UsageCost,"Usage Cost",!1,!0,"details.usageCost")),null!=ie.OperatorInfo&&1!=ie.OperatorInfo.ID&&(Te+=this.formatTextField(ie.OperatorInfo.Title,"Operator",!1,!0,"details.operatorTitle"),null!=ie.OperatorInfo.WebsiteURL&&(Te+=this.formatTextField(this.formatURL(ie.OperatorInfo.WebsiteURL),"Operator Website",!0,!0,"details.operatorWebsite")));let ge="";if(null!=ie.StatusType&&(ge+=this.formatTextField(ie.StatusType.Title,"Status",!1,!0,"details.operationalStatus"),null!=ie.DateLastStatusUpdate&&(ge+=this.formatTextField(Math.round((fe-this.fixJSONDate(ie.DateLastStatusUpdate))/864e5)+" days ago","Last Updated",!1,!0,"details.lastUpdated"))),null!=ie.Connections&&ie.Connections.length>0){ge+="<table class='table table-striped'>",ge+="<tr><th data-localize='details.equipment.connectionType'>Connection</th><th data-localize='details.equipment.powerLevel'>Power Level</th><th data-localize='details.operationalStatus'>Status</th></tr>";for(let Me=0;Me<ie.Connections.length;Me++){let ze=ie.Connections[Me];""==ze.Amps&&(ze.Amps=null),""==ze.Voltage&&(ze.Voltage=null),""==ze.Quantity&&(ze.Quantity=null),""==ze.PowerKW&&(ze.PowerKW=null),ge+="<tr><td>"+(null!=ze.ConnectionType?ze.ConnectionType.Title:"")+"</td><td>"+(null!=ze.Level?"<strong>"+ze.Level.Title+"</strong><br/>":"")+(null!=ze.Amps?this.formatString(ze.Amps)+"A/ ":"")+(null!=ze.Voltage?this.formatString(ze.Voltage)+"V/ ":"")+(null!=ze.PowerKW?this.formatString(ze.PowerKW)+"kW <br/>":"")+(null!=ze.CurrentType?ze.CurrentType.Title:"")+"<br/>"+(null!=ze.Quantity?this.formatString(ze.Quantity):"1")+" Present</td><td>"+(null!=ze.StatusType?ze.StatusType.Title:"-")+"</td></tr>"}ge+="</table>"}let we="";return we+=this.formatTextField("<a target='_blank' href='https://openchargemap.org/site/poi/details/"+ie.ID+"'>OCM-"+ie.ID+"</a>","OpenChargeMap Ref",!1,!0,"details.refNumber"),null!=ie.DataProvider&&(we+=this.formatTextField(ie.DataProvider.Title,"Data Provider",!1,!0,"details.dataProviderTitle"),null!=ie.DataProvider.WebsiteURL&&(we+=this.formatTextField(this.formatURL(ie.DataProvider.WebsiteURL),"Website",!1,!0,"details.dataProviderWebsite")),we+=this.formatTextField(ie.AddressInfo.Latitude,"Latitude",!1,!0,null),we+=this.formatTextField(ie.AddressInfo.Longitude,"Longitude",!1,!0,null)),{address:Ae,drivingInfo:X,contactInfo:De,additionalInfo:se+Te+ge,advancedInfo:we}}static debounce(ie,W,w){let fe;return function(){let Ae=this,De=arguments,se=w&&!fe;clearTimeout(fe),fe=setTimeout(function(){fe=null,w||ie.apply(Ae,De)},W),se&&ie.apply(Ae,De)}}static getRandomInt(ie){return Math.floor(Math.random()*Math.floor(ie))}}return(0,v.Z)(s,"formatPOIAddress",function(Q,ie=!0){let W="";return W=ie?""+this.formatTextField(Q.AddressInfo.AddressLine1)+this.formatTextField(Q.AddressInfo.AddressLine2)+this.formatTextField(Q.AddressInfo.Town)+this.formatTextField(Q.AddressInfo.StateOrProvince)+this.formatTextField(Q.AddressInfo.Postcode)+(null!=Q.AddressInfo.Country?this.formatTextField(Q.AddressInfo.Country.Title):""):this.formatStringArray([Q.AddressInfo.AddressLine1,Q.AddressInfo.AddressLine2,Q.AddressInfo.Town,Q.AddressInfo.StateOrProvince,Q.AddressInfo.Postcode,null!=Q.AddressInfo.Country?Q.AddressInfo.Country.Title:""]),W}),(0,v.Z)(s,"formatStringArray",function(Q,ie=", "){if(null==Q)return"";let W="";for(let w=0;w<Q.length;w++)null!=Q[w]&&""!=Q[w].trim()&&(W+=w==Q.length-1?Q[w]:Q[w]+ie);return W}),s})()},3052:(zn,Ct,R)=>{"use strict";R.d(Ct,{LL:()=>s,jR:()=>y,wC:()=>d});var v=R(1180);class d{constructor(ie=null,W=null){(0,v.Z)(this,"altitudeAccuracy",void 0),(0,v.Z)(this,"longitude",void 0),(0,v.Z)(this,"latitude",void 0),(0,v.Z)(this,"speed",void 0),(0,v.Z)(this,"heading",void 0),(0,v.Z)(this,"altitude",void 0),(0,v.Z)(this,"accuracy",void 0),this.latitude=ie,this.longitude=W}}class y{constructor(ie=null,W=null){(0,v.Z)(this,"coords",void 0),(0,v.Z)(this,"timestamp",void 0),(0,v.Z)(this,"attribution",void 0),this.coords=new d,this.coords.latitude=ie,this.coords.longitude=W}static fromPosition(ie){return new y(ie.coords.latitude,ie.coords.longitude)}}class s{constructor(ie,W){(0,v.Z)(this,"northEast",void 0),(0,v.Z)(this,"southWest",void 0),this.northEast=ie,this.southWest=W}}},7430:(zn,Ct,R)=>{"use strict";R.d(Ct,{Qp:()=>s,fw:()=>W,JJ:()=>fe,eN:()=>w,vw:()=>ie,kA:()=>Q});var v=R(1180);class d{constructor(De,X){(0,v.Z)(this,"itemType",void 0),(0,v.Z)(this,"itemId",void 0),(0,v.Z)(this,"version",void 0),(0,v.Z)(this,"schemaVersion",void 0),(0,v.Z)(this,"syncTimeStamp",void 0),this.itemType=De,this.itemId=d.getNewItemId(),this.version=1,this.schemaVersion=X,this.syncTimeStamp=d.getNewSyncTimeStamp()}static getNewSyncTimeStamp(){return Date.now().toString()}static getNewItemId(){return"_syncitem_"+Date.now().toString()}}class y{constructor(De,X){(0,v.Z)(this,"Title",void 0),(0,v.Z)(this,"Notes",void 0),(0,v.Z)(this,"_sync",void 0),this._sync=new d(De,X)}}class s extends y{constructor(...De){super(...De),(0,v.Z)(this,"PoiID",void 0),(0,v.Z)(this,"Type",void 0),(0,v.Z)(this,"Poi",void 0),(0,v.Z)(this,"Photos",void 0)}}class Q extends y{constructor(){super("waypoint",1),(0,v.Z)(this,"Stage",void 0),(0,v.Z)(this,"Position",void 0),(0,v.Z)(this,"PoiIDs",void 0),(0,v.Z)(this,"PoiList",void 0)}}class ie extends y{constructor(){super("journey_stage",1),(0,v.Z)(this,"WayPoints",void 0),this.WayPoints=[]}}class W extends y{constructor(){super("journey",1),(0,v.Z)(this,"ID",void 0),(0,v.Z)(this,"Stages",void 0),this.ID=""+Date.now(),this.Stages=[]}}class w{constructor(){(0,v.Z)(this,"Title",void 0),(0,v.Z)(this,"DistanceKM",void 0),(0,v.Z)(this,"DurationMinutes",void 0),(0,v.Z)(this,"StartElevation",void 0),(0,v.Z)(this,"EndElevation",void 0),(0,v.Z)(this,"EnergyConsumptionkWh",void 0)}}class fe{constructor(){(0,v.Z)(this,"Title",void 0),(0,v.Z)(this,"JourneyRouteLegs",void 0),(0,v.Z)(this,"TotalDistanceKM",void 0),(0,v.Z)(this,"TotalDurationMinutes",void 0),(0,v.Z)(this,"TotalEnergykWh",void 0)}}},4677:(zn,Ct,R)=>{"use strict";R.d(Ct,{b:()=>d});var v=R(1180);class d{constructor(){(0,v.Z)(this,"poiIdList",null),(0,v.Z)(this,"countryCode",null),(0,v.Z)(this,"latitude",null),(0,v.Z)(this,"longitude",null),(0,v.Z)(this,"locationTitle",null),(0,v.Z)(this,"distance",null),(0,v.Z)(this,"distanceUnit",null),(0,v.Z)(this,"connectionTypeIdList",null),(0,v.Z)(this,"operatorIdList",null),(0,v.Z)(this,"levelIdList",null),(0,v.Z)(this,"countryIdList",null),(0,v.Z)(this,"usageTypeIdList",null),(0,v.Z)(this,"statusTypeIdList",null),(0,v.Z)(this,"minPowerKW",null),(0,v.Z)(this,"maxPowerKW",null),(0,v.Z)(this,"submissionStatusTypeIdList",null),(0,v.Z)(this,"maxResults",500),(0,v.Z)(this,"additionalParams",null),(0,v.Z)(this,"includeComments",!1),(0,v.Z)(this,"compact",!0),(0,v.Z)(this,"enableCaching",!0),(0,v.Z)(this,"levelOfDetail",1),(0,v.Z)(this,"polyline",null),(0,v.Z)(this,"boundingbox",null)}}},2117:(zn,Ct,R)=>{"use strict";R.d(Ct,{n:()=>d});var v=R(1180);class d{constructor(){(0,v.Z)(this,"Location",void 0),(0,v.Z)(this,"Title",void 0),(0,v.Z)(this,"Address",void 0),(0,v.Z)(this,"Type",void 0),(0,v.Z)(this,"ReferenceID",void 0),(0,v.Z)(this,"Attribution",void 0),(0,v.Z)(this,"AddressInfo",void 0)}}},4783:(zn,Ct,R)=>{"use strict";R.d(Ct,{N:()=>y,U:()=>d});var v=R(1180);const d=650;class y{constructor(){(0,v.Z)(this,"OperatorList",void 0),(0,v.Z)(this,"ConnectionTypeList",void 0),(0,v.Z)(this,"CountryList",void 0),(0,v.Z)(this,"UsageTypeList",void 0),(0,v.Z)(this,"StatusTypeList",void 0),(0,v.Z)(this,"MinPowerKW",void 0),(0,v.Z)(this,"MaxPowerKW",void 0),(0,v.Z)(this,"UseDistanceInKM",void 0),(0,v.Z)(this,"HasActiveFilters",void 0),(0,v.Z)(this,"LastSearchPosition",void 0),(0,v.Z)(this,"StartSearchPosition",void 0),(0,v.Z)(this,"StartViewPoiId",void 0),(0,v.Z)(this,"Language",void 0),(0,v.Z)(this,"FilterOptionsByCountryId",void 0),(0,v.Z)(this,"MapType",void 0),(0,v.Z)(this,"EnableAdvancedEditorFeatures",void 0),(0,v.Z)(this,"MaxResults",void 0),this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MaxPowerKW=null,this.MinPowerKW=null,this.HasActiveFilters=!1,this.FilterOptionsByCountryId=null,this.UseDistanceInKM=!0,this.MapType="ROADMAP",this.EnableAdvancedEditorFeatures=!1,this.MaxResults=500}LoadSettings(){}SaveSettings(){}ClearActiveFilters(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MinPowerKW=null,this.MaxPowerKW=null}CheckForActiveFilters(){return this.HasActiveFilters=this.OperatorList.length>0||this.ConnectionTypeList.length>0||this.CountryList.length>0||this.UsageTypeList.length>0||this.StatusTypeList.length>0||this.MinPowerKW>0||this.MaxPowerKW>0||null!=this.MaxPowerKW&&this.MaxPowerKW<d,this.HasActiveFilters}}},2339:(zn,Ct,R)=>{"use strict";R.d(Ct,{q:()=>v});var v=(()=>((v=v||{})[v.POI=0]="POI",v[v.Comment=1]="Comment",v[v.Media=2]="Media",v))()},7425:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{AboutPageModule:()=>De});var v=R(1180),d=R(6814),y=R(6223),s=R(7852),Q=R(2125),ie=R(9236),W=R(2029);const w=[{path:"",component:ie.t}];let fe=(()=>{class X{}return(0,v.Z)(X,"\u0275fac",function(Te){return new(Te||X)}),(0,v.Z)(X,"\u0275mod",W.oAB({type:X})),(0,v.Z)(X,"\u0275inj",W.cJS({imports:[Q.Bz.forChild(w),Q.Bz]})),X})();var Ae=R(3999);let De=(()=>{class X{}return(0,v.Z)(X,"\u0275fac",function(Te){return new(Te||X)}),(0,v.Z)(X,"\u0275mod",W.oAB({type:X})),(0,v.Z)(X,"\u0275inj",W.cJS({imports:[d.ez,y.u5,s.Pc,Ae.aw,fe]})),X})()},9236:(zn,Ct,R)=>{"use strict";R.d(Ct,{t:()=>ie});var v=R(1180),d=R(553),y=R(2029),s=R(7852),Q=R(3999);let ie=(()=>{class W{constructor(fe){(0,v.Z)(this,"modalController",void 0),this.modalController=fe}get appVersion(){return d.N.version}get apiUrl(){return d.N.apiBase}ngOnInit(){}close(){this.modalController.dismiss()}}return(0,v.Z)(W,"\u0275fac",function(fe){return new(fe||W)(y.Y36(s.IN))}),(0,v.Z)(W,"\u0275cmp",y.Xpm({type:W,selectors:[["app-about"]],decls:41,vars:5,consts:[[1,"ion-padding"],["size","2"],["src","assets/images/icons/branding/AppIcon_128x128.png",2,"padding-top","2em"],["href","https://openchargemap.org"],["href","https://community.openchargemap.org"],["href","https://webprofusion.com"],["slot","end"],[3,"click"],["name","close","slot","start"]],template:function(fe,Ae){1&fe&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3),y.ALo(4,"translate"),y.qZA()()(),y.TgZ(5,"ion-content",0)(6,"ion-grid")(7,"ion-row")(8,"ion-col",1),y._UZ(9,"img",2),y.qZA(),y.TgZ(10,"ion-col")(11,"h1"),y._uU(12,"Open Charge Map"),y.qZA(),y.TgZ(13,"h2"),y._uU(14,"The global public registry of Electric Vehicle charging locations"),y.qZA(),y.TgZ(15,"p"),y._uU(16,"Web: "),y.TgZ(17,"a",3),y._uU(18,"https://openchargemap.org"),y.qZA()()()()(),y.TgZ(19,"p"),y._uU(20,"Community Discussions: "),y.TgZ(21,"a",4),y._uU(22,"https://community.openchargemap.org"),y.qZA()(),y.TgZ(23,"p"),y._uU(24,"App development by Webprofusion Pty Ltd ("),y.TgZ(25,"a",5),y._uU(26,"https://webprofusion.com"),y.qZA(),y._uU(27,")"),y.qZA(),y.TgZ(28,"p"),y._uU(29,"Our software is developed and hosted by volunteers, our data is largely crowdsourced by you."),y.qZA(),y.TgZ(30,"ion-note")(31,"p"),y._uU(32),y.qZA(),y.TgZ(33,"p"),y._uU(34),y.qZA()()(),y.TgZ(35,"ion-footer")(36,"ion-toolbar")(37,"ion-buttons",6)(38,"ion-button",7),y.NdJ("click",function(){return Ae.close()}),y._UZ(39,"ion-icon",8),y._uU(40," Close "),y.qZA()()()()),2&fe&&(y.xp6(3),y.Oqu(y.lcZ(4,3,"ocm.general.about")),y.xp6(29),y.hij("App Version: ",Ae.appVersion,""),y.xp6(2),y.hij("API: ",Ae.apiUrl,""))},dependencies:[s.YG,s.Sm,s.wI,s.W2,s.fr,s.jY,s.Gu,s.gu,s.uN,s.Nd,s.wd,s.sr,Q.X$]})),W})()},9192:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{JourneysModule:()=>Ae});var v=R(1180),d=R(4292),y=R(5086),s=R(3999),Q=R(6814),ie=R(6223),W=R(7852),w=R(2125),fe=R(2029);let Ae=(()=>{class De{}return(0,v.Z)(De,"\u0275fac",function(se){return new(se||De)}),(0,v.Z)(De,"\u0275mod",fe.oAB({type:De})),(0,v.Z)(De,"\u0275inj",fe.cJS({imports:[Q.ez,ie.u5,W.Pc,s.aw,y.e,w.Bz.forChild([{path:"",component:d.g}])]})),De})()},4292:(zn,Ct,R)=>{"use strict";R.d(Ct,{g:()=>Oe});var v=R(1180),d=R(989),y=R(439),s=R(1618),Q=R(3052),ie=R(9723),W=R(2029),w=R(7852),fe=R(6814);function Ae(Ce,nt){1&Ce&&(W.TgZ(0,"p"),W._uU(1," You have no journeys yet. Start by browsing to a charging location, then add it as Favourite to start a new Journey. "),W.qZA())}function De(Ce,nt){if(1&Ce&&(W.TgZ(0,"p"),W._uU(1),W.qZA()),2&Ce){const Xe=W.oxw(2).$implicit;W.xp6(1),W.hij(" ",Xe.Poi.AddressInfo.AddressLine1,"")}}function X(Ce,nt){if(1&Ce&&(W.TgZ(0,"p"),W._uU(1),W.qZA()),2&Ce){const Xe=W.oxw(2).$implicit;W.xp6(1),W.hij(" ",Xe.Poi.AddressInfo.AddressLine2,"")}}function se(Ce,nt){if(1&Ce&&(W.TgZ(0,"p"),W._uU(1),W.qZA()),2&Ce){const Xe=W.oxw(2).$implicit;W.xp6(1),W.hij(" ",Xe.Poi.AddressInfo.Town,"")}}function Te(Ce,nt){if(1&Ce&&(W.TgZ(0,"p"),W._uU(1),W.qZA()),2&Ce){const Xe=W.oxw(2).$implicit;W.xp6(1),W.hij(" ",Xe.Poi.AddressInfo.StateOrProvince,"")}}function ge(Ce,nt){if(1&Ce&&(W.TgZ(0,"p"),W._uU(1),W.qZA()),2&Ce){const Xe=W.oxw(2).$implicit;W.xp6(1),W.hij(" ",Xe.Poi.AddressInfo.Postcode,"")}}function we(Ce,nt){if(1&Ce){const Xe=W.EpF();W.TgZ(0,"div")(1,"div",18),W.NdJ("click",function(){W.CHM(Xe);const ae=W.oxw().$implicit,mt=W.oxw(4);return W.KtG(mt.viewPOIDetails(ae.Poi))}),W.YNc(2,De,2,1,"p",4),W.YNc(3,X,2,1,"p",4),W.YNc(4,se,2,1,"p",4),W.YNc(5,Te,2,1,"p",4),W.YNc(6,ge,2,1,"p",4),W.qZA(),W.TgZ(7,"ion-button",19),W.NdJ("click",function(){W.CHM(Xe);const ae=W.oxw().$implicit,mt=W.oxw(4);return W.KtG(mt.launchNavigation(ae.Poi))}),W._UZ(8,"ion-icon",20),W._uU(9," Navigate "),W.qZA()()}if(2&Ce){const Xe=W.oxw().$implicit;W.xp6(2),W.Q6J("ngIf",Xe.Poi.AddressInfo.AddressLine1),W.xp6(1),W.Q6J("ngIf",Xe.Poi.AddressInfo.AddressLine2),W.xp6(1),W.Q6J("ngIf",Xe.Poi.AddressInfo.Town),W.xp6(1),W.Q6J("ngIf",Xe.Poi.AddressInfo.StateOrProvince),W.xp6(1),W.Q6J("ngIf",Xe.Poi.AddressInfo.Postcode)}}function Le(Ce,nt){if(1&Ce&&(W.TgZ(0,"div",17),W.YNc(1,we,10,5,"div",4),W.qZA()),2&Ce){const Xe=nt.$implicit;W.xp6(1),W.Q6J("ngIf",Xe.Poi)}}function Me(Ce,nt){if(1&Ce&&(W.TgZ(0,"ion-item")(1,"h2"),W._uU(2),W.qZA(),W.TgZ(3,"ion-thumbnail",0),W._UZ(4,"ion-icon",15),W.qZA(),W.TgZ(5,"p"),W._uU(6),W.qZA(),W.YNc(7,Le,2,1,"div",16),W.qZA()),2&Ce){const Xe=nt.$implicit;W.xp6(2),W.Oqu(Xe.Title),W.xp6(4),W.Oqu(Xe.Notes),W.xp6(1),W.Q6J("ngForOf",Xe.PoiList)}}function ze(Ce,nt){if(1&Ce&&(W.TgZ(0,"ion-list")(1,"ion-list-header",11),W._uU(2),W._UZ(3,"ion-icon",12),W._uU(4," -- "),W._UZ(5,"ion-icon",13),W._uU(6," -- "),W._UZ(7,"ion-icon",14),W._uU(8," -- "),W.qZA(),W.YNc(9,Me,8,3,"ion-item",5),W.qZA()),2&Ce){const Xe=nt.$implicit;W.xp6(2),W.hij(" ",Xe.Title," "),W.xp6(7),W.Q6J("ngForOf",Xe.WayPoints)}}function Ke(Ce,nt){if(1&Ce){const Xe=W.EpF();W.TgZ(0,"ion-card")(1,"ion-card-content")(2,"ion-toolbar",8)(3,"ion-title"),W._uU(4),W.qZA(),W.TgZ(5,"ion-buttons",9)(6,"ion-button",1),W.NdJ("click",function(){const mt=W.CHM(Xe).$implicit,xe=W.oxw();return W.KtG(xe.deleteJourney(mt.ID))}),W._UZ(7,"ion-icon",10),W.qZA()()(),W.TgZ(8,"p"),W._uU(9),W.qZA(),W.YNc(10,ze,10,2,"ion-list",5),W.qZA()()}if(2&Ce){const Xe=nt.$implicit;W.xp6(4),W.hij(" ",Xe.Title,""),W.xp6(5),W.Oqu(Xe.Notes),W.xp6(1),W.Q6J("ngForOf",Xe.Stages)}}let Oe=(()=>{class Ce{constructor(Xe,Ee,ae,mt,xe){(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"journeyManager",void 0),(0,v.Z)(this,"api",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"alertController",void 0),this.appManager=Xe,this.journeyManager=Ee,this.api=ae,this.modalController=mt,this.alertController=xe}dismiss(){this.modalController.dismiss()}discoverImages(){this.journeyManager.journeys.forEach(Xe=>{Xe.Stages.forEach(Ee=>{Ee.WayPoints.forEach(ae=>{null!=ae.PoiList&&ae.PoiList.forEach(mt=>{mt.Poi&&this.api.getPanoramioLocationPhotos(new Q.wC(mt.Poi.AddressInfo.Latitude,mt.Poi.AddressInfo.Longitude)).then(xe=>{mt.Photos=xe})})})})})}getJson(Xe){return JSON.stringify(Xe,null,4)}viewPOIDetails(Xe){this.modalController.create({component:ie.H,componentProps:{item:Xe}}).then(Ee=>Ee.present())}get staticMapSize(){return"60x60"}getStaticMapURL(Xe){return"https://maps.googleapis.com/maps/api/staticmap?center="+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude}deleteJourney(Xe){this.alertController.create({header:"Delete this Journey?",message:"Are you sure you want to delete this Journey?",buttons:[{text:"No",handler:()=>{}},{text:"Delete",handler:()=>{this.journeyManager.deleteJourney(Xe)}}]}).then(Ee=>Ee.present())}launchNavigation(Xe){let Ee="https://maps.google.com/?q="+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude;this.appManager.platform.is("ios")&&(Ee="https://maps.apple.com?q="+Xe.AddressInfo.Latitude+","+Xe.AddressInfo.Longitude),window.open(Ee,"_system")}}return(0,v.Z)(Ce,"\u0275fac",function(Xe){return new(Xe||Ce)(W.Y36(s.c),W.Y36(d.i),W.Y36(y.l),W.Y36(w.IN),W.Y36(w.Br))}),(0,v.Z)(Ce,"\u0275cmp",W.Xpm({type:Ce,selectors:[["ng-component"]],decls:18,vars:2,consts:[["slot","start"],[3,"click"],[1,"journeys-page"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","end"],["name","close","slot","start"],["primary",""],["slot","primary"],["name","close","slot","icon-only"],[2,"font-size","1.5rem"],["name","car"],["name","time"],["name","flash"],["name","caret-down",2,"font-size","4rem"],["style","text-align:right;width:100%;",4,"ngFor","ngForOf"],[2,"text-align","right","width","100%"],["tappable","",3,"click"],["clear","","item-right","",3,"click"],["name","navigate","slot","start"]],template:function(Xe,Ee){1&Xe&&(W.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-back-button",1),W.NdJ("click",function(){return Ee.dismiss()}),W.qZA()(),W.TgZ(4,"ion-title"),W._uU(5," Journeys "),W.qZA()()(),W.TgZ(6,"ion-content",2)(7,"div",3)(8,"p"),W._uU(9," You can create and plan journeys to group your favourite charging routes together. "),W.qZA(),W.YNc(10,Ae,2,0,"p",4),W.qZA(),W.YNc(11,Ke,11,3,"ion-card",5),W.qZA(),W.TgZ(12,"ion-footer")(13,"ion-toolbar")(14,"ion-buttons",6)(15,"ion-button",1),W.NdJ("click",function(){return Ee.dismiss()}),W._UZ(16,"ion-icon",7),W._uU(17," Close "),W.qZA()()()()),2&Xe&&(W.xp6(10),W.Q6J("ngIf",null==Ee.journeyManager.journeys||0==Ee.journeyManager.journeys.length),W.xp6(1),W.Q6J("ngForOf",Ee.journeyManager.journeys))},dependencies:[fe.sg,fe.O5,w.oU,w.YG,w.Sm,w.PM,w.FN,w.W2,w.fr,w.Gu,w.gu,w.Ie,w.q_,w.yh,w.Bs,w.wd,w.sr,w.cs],encapsulation:2})),Ce})()},2309:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{LayerEditorPageModule:()=>De});var v=R(1180),d=R(6814),y=R(6223),s=R(7852),Q=R(2125),ie=R(8062),W=R(2029);const w=[{path:"",component:ie.A}];let fe=(()=>{class X{}return(0,v.Z)(X,"\u0275fac",function(Te){return new(Te||X)}),(0,v.Z)(X,"\u0275mod",W.oAB({type:X})),(0,v.Z)(X,"\u0275inj",W.cJS({imports:[Q.Bz.forChild(w),Q.Bz]})),X})();var Ae=R(5086);let De=(()=>{class X{}return(0,v.Z)(X,"\u0275fac",function(Te){return new(Te||X)}),(0,v.Z)(X,"\u0275mod",W.oAB({type:X})),(0,v.Z)(X,"\u0275inj",W.cJS({imports:[d.ez,y.u5,s.Pc,fe,Ae.e]})),X})()},8062:(zn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>fe});var v=R(5861),d=R(1180),y=R(9159),s=R(2029),Q=R(7852),ie=R(6814),W=R(8696);function w(Ae,De){if(1&Ae&&(s.TgZ(0,"div"),s._uU(1),s._UZ(2,"app-poi-list",10),s.qZA()),2&Ae){const X=s.oxw();s.xp6(1),s.hij(" Items Parsed: ",X.fileData.length," "),s.xp6(1),s.Q6J("poiList",X.fileData)}}let fe=(()=>{class Ae{constructor(X,se){(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"refData",void 0),(0,d.Z)(this,"fileData",void 0),this.modalController=X,this.refData=se}ngOnInit(){}previewFile(){var X=this;return(0,v.Z)(function*(){yield X.loadFile(!1)})()}cancel(){var X=this;return(0,v.Z)(function*(){yield X.modalController.dismiss(X.fileData)})()}loadFile(X=!0){var se=this;return(0,v.Z)(function*(){const Te=new FileReader;Te.onload=()=>{let we=JSON.parse(Te.result),Le=5e6;for(let Me of we)(null==Me.ID||""==Me.ID)&&(Me.ID=Le.toString()),Me.ID="imp_"+Me.ID,Le++;se.fileData=se.refData.hydrateCompactPOIList(we),X&&se.modalController.dismiss(se.fileData)},Te.onerror=()=>{},Te.readAsText(document.getElementById("file-upload").files[0])})()}add(){var X=this;return(0,v.Z)(function*(){X.modalController.dismiss(X.fileData)})()}}return(0,d.Z)(Ae,"\u0275fac",function(X){return new(X||Ae)(s.Y36(Q.IN),s.Y36(y.W))}),(0,d.Z)(Ae,"\u0275cmp",s.Xpm({type:Ae,selectors:[["app-layer-editor"]],decls:27,vars:1,consts:[[1,"ion-padding"],[1,"upload"],["name","file","aria-label","file","slot","start"],["type","file","required","","id","file-upload",3,"change"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","checkmark-circle-outline","slot","end"],[3,"poiList"]],template:function(X,se){1&X&&(s.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),s._uU(3," Edit Layer "),s.qZA()()(),s.TgZ(4,"ion-content",0)(5,"p"),s._uU(6,"POI layers are used to preview data from other Open Data sources. "),s.qZA(),s.TgZ(7,"p"),s._uU(8,"Select a POI layer JSON file: "),s.qZA(),s.TgZ(9,"div")(10,"label",1)(11,"ion-button"),s._UZ(12,"ion-icon",2),s.TgZ(13,"ion-label"),s._uU(14,"Choose File.."),s.qZA()(),s.TgZ(15,"input",3),s.NdJ("change",function(){return se.previewFile()}),s.qZA()()(),s.YNc(16,w,3,2,"div",4),s.qZA(),s.TgZ(17,"ion-footer")(18,"ion-toolbar")(19,"ion-buttons",5)(20,"ion-button",6),s.NdJ("click",function(){return se.cancel()}),s._UZ(21,"ion-icon",7),s._uU(22," Cancel "),s.qZA()(),s.TgZ(23,"ion-buttons",8)(24,"ion-button",6),s.NdJ("click",function(){return se.add()}),s._uU(25," Add "),s._UZ(26,"ion-icon",9),s.qZA()()()()),2&X&&(s.xp6(16),s.Q6J("ngIf",se.fileData&&se.fileData.length>0))},dependencies:[ie.O5,Q.YG,Q.Sm,Q.W2,Q.fr,Q.Gu,Q.gu,Q.Q$,Q.wd,Q.sr,W.o],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]})),Ae})()},9723:(zn,Ct,R)=>{"use strict";R.d(Ct,{H:()=>In});var v=R(1180),d=R(1618),y=R(2029),s=R(7852),Q=R(5861),ie=R(989),W=R(7430),w=R(6814),fe=R(6223);function Ae(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-select-option",13),y._uU(1),y.qZA()),2&tt){const Y=Ve.$implicit;y.Q6J("value",Y.ID),y.xp6(1),y.Oqu(Y.Title)}}function De(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-select-option",16),y._uU(1),y.qZA()),2&tt){const Y=Ve.$implicit;y.Q6J("value",Ve.index),y.xp6(1),y.Oqu(Y.Title)}}function X(tt,Ve){if(1&tt){const Y=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label",2),y._uU(2,"Journey Stage"),y.qZA(),y.TgZ(3,"ion-select",3),y.NdJ("ngModelChange",function(We){y.CHM(Y);const kt=y.oxw();return y.KtG(kt.selectedStageIndex=We)}),y.TgZ(4,"ion-select-option",14),y._uU(5,"Create a Journey Stage"),y.qZA(),y.YNc(6,De,2,2,"ion-select-option",15),y.qZA()()}if(2&tt){const Y=y.oxw();y.xp6(3),y.Q6J("ngModel",Y.selectedStageIndex),y.xp6(3),y.Q6J("ngForOf",Y.journeyManager.getJourneyStages(Y.selectedJourneyID))}}function se(tt,Ve){if(1&tt){const Y=y.EpF();y.TgZ(0,"ion-item")(1,"ion-label",2),y._uU(2,"New Journey Name"),y.qZA(),y.TgZ(3,"ion-input",7),y.NdJ("ngModelChange",function(We){y.CHM(Y);const kt=y.oxw();return y.KtG(kt.newJourneyName=We)}),y.qZA()()}if(2&tt){const Y=y.oxw();y.xp6(3),y.Q6J("ngModel",Y.newJourneyName)}}let Te=(()=>{class tt{constructor(Y,me,We,kt){(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"navParams",void 0),(0,v.Z)(this,"journeyManager",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"selectedJourneyID",void 0),(0,v.Z)(this,"selectedStageIndex",void 0),(0,v.Z)(this,"newJourneyName",void 0),(0,v.Z)(this,"waypoint",void 0),(0,v.Z)(this,"poi",void 0),this.appManager=Y,this.navParams=me,this.journeyManager=We,this.modalController=kt,this.poi=this.navParams.get("poi"),this.waypoint=new W.kA,this.waypoint.Title=this.poi.AddressInfo.Title,this.waypoint.PoiIDs=[this.poi.ID],this.waypoint.PoiList=[];const _n=new W.Qp("charging",1);_n.Poi=this.poi,_n.PoiID=this.poi.ID,this.waypoint.PoiList.push(_n),this.newJourneyName="Trip to "+this.poi.AddressInfo.Title}cancel(){this.modalController.dismiss()}add(){if(null!=this.selectedJourneyID&&""!==this.selectedJourneyID)this.journeyManager.addJourneyWaypoint(this.selectedJourneyID,this.selectedStageIndex,this.waypoint);else{const Y=new W.fw;Y.ID=Date.now().toString(),""===this.newJourneyName&&(this.newJourneyName="New Journey"),Y.Title=this.newJourneyName,this.journeyManager.addJourney(Y,this.waypoint)}this.journeyManager.saveJourneys(),this.modalController.dismiss()}}return(0,v.Z)(tt,"\u0275fac",function(Y){return new(Y||tt)(y.Y36(d.c),y.Y36(s.X1),y.Y36(ie.i),y.Y36(s.IN))}),(0,v.Z)(tt,"\u0275cmp",y.Xpm({type:tt,selectors:[["ng-component"]],decls:39,vars:8,consts:[[1,"journeys-page","ion-padding"],[1,"banner"],["position","stacked"],[3,"ngModel","ngModelChange"],["value","","checked",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","add","slot","end"],[3,"value"],["value",""],["checked","",3,"value",4,"ngFor","ngForOf"],["checked","",3,"value"]],template:function(Y,me){1&Y&&(y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3," Edit Favourite "),y.qZA()()(),y.TgZ(4,"ion-content",0)(5,"div",1)(6,"h1"),y._uU(7),y.qZA(),y.TgZ(8,"p"),y._uU(9),y.qZA()(),y.TgZ(10,"p"),y._uU(11," Add Charging Location as a Journey Waypoint "),y.qZA(),y.TgZ(12,"ion-item")(13,"ion-label",2),y._uU(14,"Add to a Journey"),y.qZA(),y.TgZ(15,"ion-select",3),y.NdJ("ngModelChange",function(kt){return me.selectedJourneyID=kt}),y.TgZ(16,"ion-select-option",4),y._uU(17,"Create a New Journey"),y.qZA(),y.YNc(18,Ae,2,2,"ion-select-option",5),y.qZA()(),y.YNc(19,X,7,2,"ion-item",6),y.YNc(20,se,4,1,"ion-item",6),y.TgZ(21,"ion-item")(22,"ion-label",2),y._uU(23,"Name for this step of your journey"),y.qZA(),y.TgZ(24,"ion-input",7),y.NdJ("ngModelChange",function(kt){return me.waypoint.Title=kt}),y.qZA()(),y.TgZ(25,"ion-item")(26,"ion-label",2),y._uU(27,"Other Notes"),y.qZA(),y.TgZ(28,"ion-textarea",3),y.NdJ("ngModelChange",function(kt){return me.waypoint.Notes=kt}),y.qZA()()(),y.TgZ(29,"ion-footer")(30,"ion-toolbar")(31,"ion-buttons",8)(32,"ion-button",9),y.NdJ("click",function(){return me.cancel()}),y._UZ(33,"ion-icon",10),y._uU(34," Cancel "),y.qZA()(),y.TgZ(35,"ion-buttons",11)(36,"ion-button",9),y.NdJ("click",function(){return me.add()}),y._uU(37," Add "),y._UZ(38,"ion-icon",12),y.qZA()()()()),2&Y&&(y.xp6(7),y.Oqu(me.poi.AddressInfo.Title),y.xp6(2),y.Oqu(me.poi.AddressInfo.AddressLine1),y.xp6(6),y.Q6J("ngModel",me.selectedJourneyID),y.xp6(3),y.Q6J("ngForOf",me.journeyManager.journeys),y.xp6(1),y.Q6J("ngIf",me.selectedJourneyID),y.xp6(1),y.Q6J("ngIf",!me.selectedJourneyID),y.xp6(4),y.Q6J("ngModel",me.waypoint.Title),y.xp6(4),y.Q6J("ngModel",me.waypoint.Notes))},dependencies:[w.sg,w.O5,fe.JJ,fe.On,s.YG,s.Sm,s.W2,s.fr,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.t9,s.n0,s.g2,s.wd,s.sr,s.QI,s.j9],encapsulation:2})),tt})();var ge=R(9127);function we(tt,Ve){if(1&tt){const Y=y.EpF();y.TgZ(0,"ion-card")(1,"ion-toolbar")(2,"ion-title",14),y._uU(3,"Preview"),y.qZA(),y.TgZ(4,"ion-buttons",15)(5,"ion-button",4),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw();return y.KtG(We.rotateImage())}),y._UZ(6,"ion-icon",16),y.TgZ(7,"ion-label"),y._uU(8,"Rotate"),y.qZA()()()(),y.TgZ(9,"ion-card-content")(10,"ion-list")(11,"ion-item")(12,"ion-label",17),y._uU(13,"Comment"),y.qZA(),y.TgZ(14,"ion-input",18),y.NdJ("ngModelChange",function(We){y.CHM(Y);const kt=y.oxw();return y.KtG(kt.comment=We)}),y.qZA()()(),y._UZ(15,"img",19),y.qZA()()}if(2&tt){const Y=y.oxw();y.xp6(14),y.Q6J("ngModel",Y.comment)}}let Le=(()=>{class tt{constructor(Y,me,We,kt,_n){(0,v.Z)(this,"navParams",void 0),(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"nav",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"mode",void 0),(0,v.Z)(this,"processingQuality",void 0),(0,v.Z)(this,"imgData",void 0),(0,v.Z)(this,"targetWidth",void 0),(0,v.Z)(this,"targetHeight",void 0),(0,v.Z)(this,"comment",void 0),(0,v.Z)(this,"chargePointId",void 0),(0,v.Z)(this,"poi",void 0),this.navParams=Y,this.appManager=me,this.nav=We,this.modalController=kt,this.logging=_n,this.processingQuality=.8,this.targetWidth=1024,this.targetHeight=800,this.mode=me.platformMode,this.chargePointId=this.navParams.get("id"),this.poi=this.navParams.get("poi"),this.comment=""}processNativeImageSource(Y){let me=Y;const We=document.getElementById("img-upload-canvas"),kt=We.getContext("2d"),_n=new Image;_n.onload=()=>{this.logging.log("img load:"+_n.width),We.width=_n.width,We.height=_n.height,kt.fillStyle="rgb(0,0,0)",kt.fillRect(0,0,We.width,We.height),kt.drawImage(_n,0,0,We.width,We.height),this.imgData=We.toDataURL("image/png"),this.processImage()},_n.src=me}loadCameraOrLibraryImage(Y=!1){this.logging.log("PWA mode: fetching image");const me=new FileReader;me.onload=()=>{this.imgData=me.result,this.processImage()},me.onerror=()=>{},me.readAsDataURL(document.getElementById("img-upload-media").files[0])}isBrowserMode(){return this.appManager.isPlatform("desktop")||this.appManager.isPlatform("hybrid")}processImage(){if(null!=this.imgData){const me=document.getElementById("img-upload-canvas"),We=me.getContext("2d"),kt=new Image;kt.onload=()=>{me.width=kt.width,me.height=kt.height,We.fillStyle="rgb(0,0,0)",We.fillRect(0,0,me.width,me.height),We.drawImage(kt,0,0,me.width,me.height),this.refreshImageFromCanvas()},kt.src=this.imgData}else this.logging.log("processImage: nothing to process.")}refreshImageFromCanvas(){const Y=document.getElementById("img-upload-canvas");this.imgData=Y.toDataURL("image/jpeg",.8),document.getElementById("preview").src=this.imgData}rotateImage(){const Y=document.getElementById("img-upload-canvas");let me=new Image;me.src=Y.toDataURL(),me.onload=()=>{let We=Y.height,kt=Y.width;Y.width=We,Y.height=kt,We=Y.height,kt=Y.width;const _n=Y.getContext("2d");_n.save(),_n.translate(kt,We/kt),_n.rotate(Math.PI/2),_n.drawImage(me,0,0),_n.restore(),me=null,this.refreshImageFromCanvas()}}performUpload(){var Y=this;return(0,Q.Z)(function*(){if(!Y.imgData)return void(yield Y.appManager.showToastNotification("Select an image to upload."));const me={chargePointID:Y.chargePointId,comment:Y.comment,imageDataBase64:Y.imgData};yield Y.appManager.showLoadingProgress("Uploading photo..");try{yield Y.appManager.submitMediaItem(me),Y.appManager.dismissLoadingProgress().then(()=>{Y.appManager.showToastNotification("Upload completed"),Y.modalController.dismiss()}),Y.appManager.analytics.appEvent("MediaUpload","Completed")}catch{yield Y.appManager.dismissLoadingProgress(),yield Y.appManager.showToastNotification("Upload failed, please try again."),Y.appManager.analytics.appEvent("MediaUpload","Failed")}})()}cancel(){var Y=this;return(0,Q.Z)(function*(){yield Y.modalController.dismiss()})()}}return(0,v.Z)(tt,"\u0275fac",function(Y){return new(Y||tt)(y.Y36(s.X1),y.Y36(d.c),y.Y36(s.SH),y.Y36(s.IN),y.Y36(ge.z))}),(0,v.Z)(tt,"\u0275cmp",y.Xpm({type:tt,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"media-upload"],[1,"ion-padding"],[1,"banner"],[1,"upload"],[3,"click"],["name","camera","aria-label","camera","slot","start"],["type","file","required","","id","img-upload-media",3,"change"],["inputFile",""],["id","img-upload-canvas",2,"display","none","width","500","height","500","border","1px solid red"],[4,"ngIf"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],["slot","start"],["slot","end"],["name","refresh","slot","start"],["position","floating"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["id","preview",2,"max-width","500px"]],template:function(Y,me){if(1&Y){const We=y.EpF();y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),y._uU(3," Share Photo "),y.qZA()()(),y.TgZ(4,"ion-content",0)(5,"div",1)(6,"div",2)(7,"h1"),y._uU(8),y.qZA(),y.TgZ(9,"p"),y._uU(10),y.qZA()(),y.TgZ(11,"p"),y._uU(12,"You can upload a photo from your device or take a new photo: "),y.qZA(),y.TgZ(13,"div",3)(14,"ion-button",4),y.NdJ("click",function(){y.CHM(We);const _n=y.MAs(19);return y.KtG(_n.click())}),y._UZ(15,"ion-icon",5),y.TgZ(16,"ion-label"),y._uU(17,"Choose Photo.."),y.qZA()(),y.TgZ(18,"input",6,7),y.NdJ("change",function(){return me.loadCameraOrLibraryImage()}),y.qZA()(),y._UZ(20,"canvas",8),y.YNc(21,we,16,1,"ion-card",9),y.qZA()(),y.TgZ(22,"ion-footer")(23,"ion-toolbar")(24,"ion-buttons",10)(25,"ion-button",4),y.NdJ("click",function(){return me.cancel()}),y._UZ(26,"ion-icon",11),y._uU(27," Cancel "),y.qZA()(),y.TgZ(28,"ion-buttons",12)(29,"ion-button",4),y.NdJ("click",function(){return me.performUpload()}),y._uU(30," Upload "),y._UZ(31,"ion-icon",13),y.qZA()()()()}2&Y&&(y.xp6(8),y.Oqu(me.poi.AddressInfo.Title),y.xp6(2),y.Oqu(me.poi.AddressInfo.AddressLine1),y.xp6(11),y.Q6J("ngIf",null!=me.imgData))},dependencies:[w.O5,fe.JJ,fe.On,s.YG,s.Sm,s.PM,s.FN,s.W2,s.fr,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.wd,s.sr,s.j9],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]})),tt})();var Me=R(2125);function ze(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-select-option",19),y._uU(1),y.qZA()),2&tt){const Y=Ve.$implicit;y.Q6J("value",Y.ID),y.xp6(1),y.Oqu(Y.Title)}}function Ke(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-select-option",19),y._uU(1),y.qZA()),2&tt){const Y=Ve.$implicit;y.Q6J("value",Y.ID),y.xp6(1),y.Oqu(Y.Title)}}let Oe=(()=>{class tt{constructor(Y,me,We,kt,_n,ti,Ei,Si){(0,v.Z)(this,"navParams",void 0),(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"nav",void 0),(0,v.Z)(this,"zone",void 0),(0,v.Z)(this,"loadingController",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"router",void 0),(0,v.Z)(this,"commentModel",void 0),(0,v.Z)(this,"poi",void 0),(0,v.Z)(this,"commentTypes",void 0),(0,v.Z)(this,"checkinTypes",void 0),this.navParams=Y,this.appManager=me,this.nav=We,this.zone=kt,this.loadingController=_n,this.modalController=ti,this.logging=Ei,this.router=Si,this.commentModel={ChargePointID:this.navParams.get("id"),Comment:"",CheckinStatusTypeID:10,CommentTypeID:10,Rating:null},this.poi=this.navParams.get("poi"),this.commentTypes=me.referenceDataManager.getCommentTypes(!0,!0),this.checkinTypes=me.referenceDataManager.getCheckinStatusTypes(!0,!0)}onPageWillEnter(){}cancel(){this.modalController.dismiss()}add(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.loadingController.create({message:"Sending .."});yield me.present(),(yield Y.appManager.submitComment(Y.commentModel).catch(kt=>{Y.appManager.showToastNotification("There was a problem submitting your comment."),Y.loadingController.dismiss(),Y.appManager.analytics.appEvent("Comment","Failed")}))&&(Y.logging.log("Comment submitted"),yield me.dismiss(),yield Y.modalController.dismiss(),Y.appManager.analytics.appEvent("Comment","Submitted"))})()}}return(0,v.Z)(tt,"\u0275fac",function(Y){return new(Y||tt)(y.Y36(s.X1),y.Y36(d.c),y.Y36(s.SH),y.Y36(y.R0b),y.Y36(s.HT),y.Y36(s.IN),y.Y36(ge.z),y.Y36(Me.F0))}),(0,v.Z)(tt,"\u0275cmp",y.Xpm({type:tt,selectors:[["ng-component"]],decls:53,vars:8,consts:[["color","primary"],[1,"comment-page","ion-padding"],[1,"banner"],[1,"ion-padding"],["position","stacked"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["value","5"],["value","4"],["value","3"],["value","2"],["value","1"],["value",""],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],[3,"value"]],template:function(Y,me){1&Y&&(y.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),y._uU(3," Add Comment "),y.qZA()()(),y.TgZ(4,"ion-content",1)(5,"div",2)(6,"h1"),y._uU(7),y.qZA(),y.TgZ(8,"p"),y._uU(9),y.qZA()(),y.TgZ(10,"p",3),y._uU(11,"Recent Check-ins are a big help to other drivers when planning their journey. Tell everyone what you thought about this charging location. "),y.qZA(),y.TgZ(12,"ion-list")(13,"ion-item")(14,"ion-label",4),y._uU(15,"Comment Type"),y.qZA(),y.TgZ(16,"ion-select",5),y.NdJ("ngModelChange",function(kt){return me.commentModel.CommentTypeID=kt}),y.YNc(17,ze,2,2,"ion-select-option",6),y.qZA()(),y.TgZ(18,"ion-item")(19,"ion-label",4),y._uU(20,"What Did You Think?"),y.qZA(),y.TgZ(21,"ion-input",7),y.NdJ("ngModelChange",function(kt){return me.commentModel.Comment=kt}),y.qZA()(),y.TgZ(22,"ion-item")(23,"ion-label",4),y._uU(24,"Did You Successfully Charge?"),y.qZA(),y.TgZ(25,"ion-select",5),y.NdJ("ngModelChange",function(kt){return me.commentModel.CheckinStatusTypeID=kt}),y.YNc(26,Ke,2,2,"ion-select-option",6),y.qZA()(),y.TgZ(27,"ion-item")(28,"ion-label",4),y._uU(29,"Your Rating"),y.qZA(),y.TgZ(30,"ion-select",5),y.NdJ("ngModelChange",function(kt){return me.commentModel.Rating=kt}),y.TgZ(31,"ion-select-option",8),y._uU(32,"5 - Excellent"),y.qZA(),y.TgZ(33,"ion-select-option",9),y._uU(34,"4 - Good"),y.qZA(),y.TgZ(35,"ion-select-option",10),y._uU(36,"3 - Average"),y.qZA(),y.TgZ(37,"ion-select-option",11),y._uU(38,"2 - Not Good"),y.qZA(),y.TgZ(39,"ion-select-option",12),y._uU(40,"1 - Bad"),y.qZA(),y.TgZ(41,"ion-select-option",13),y._uU(42,"Not Rated"),y.qZA()()()()(),y.TgZ(43,"ion-footer")(44,"ion-toolbar")(45,"ion-buttons",14)(46,"ion-button",15),y.NdJ("click",function(){return me.cancel()}),y._UZ(47,"ion-icon",16),y._uU(48," Cancel "),y.qZA()(),y.TgZ(49,"ion-buttons",17)(50,"ion-button",15),y.NdJ("click",function(){return me.add()}),y._uU(51," Submit "),y._UZ(52,"ion-icon",18),y.qZA()()()()),2&Y&&(y.xp6(7),y.Oqu(me.poi.AddressInfo.Title),y.xp6(2),y.Oqu(me.poi.AddressInfo.AddressLine1),y.xp6(7),y.Q6J("ngModel",me.commentModel.CommentTypeID),y.xp6(1),y.Q6J("ngForOf",me.commentTypes),y.xp6(4),y.Q6J("ngModel",me.commentModel.Comment),y.xp6(4),y.Q6J("ngModel",me.commentModel.CheckinStatusTypeID),y.xp6(1),y.Q6J("ngForOf",me.checkinTypes),y.xp6(4),y.Q6J("ngModel",me.commentModel.Rating))},dependencies:[w.sg,fe.JJ,fe.On,s.YG,s.Sm,s.W2,s.fr,s.Gu,s.gu,s.pK,s.Ie,s.Q$,s.q_,s.t9,s.n0,s.wd,s.sr,s.QI,s.j9],encapsulation:2})),tt})();var Ce=R(7777),nt=R(4669),Xe=R(8767),Ee=R(6662),ae=R(866),mt=R(3999),xe=R(1163);function Ze(tt,Ve){if(1&tt&&(y.TgZ(0,"div")(1,"small"),y._uU(2),y.qZA()()),2&tt){const Y=y.oxw(2);y.xp6(2),y.Oqu(Y.connectionSummary)}}function Se(tt,Ve){if(1&tt&&(y.TgZ(0,"div")(1,"small"),y._uU(2),y.qZA()()),2&tt){const Y=y.oxw(2);y.xp6(2),y.Oqu(Y.poi.OperatorInfo.Title)}}function ye(tt,Ve){if(1&tt){const Y=y.EpF();y.ynx(0),y.TgZ(1,"ion-button",28),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw(2);return y.KtG(We.addFavourite())}),y._UZ(2,"ion-icon",29),y.TgZ(3,"ion-label"),y._uU(4,"Favourite"),y.qZA()(),y.TgZ(5,"ion-button",13),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw(2);return y.KtG(We.edit())}),y._UZ(6,"ion-icon",30),y.TgZ(7,"ion-label"),y._uU(8,"Edit"),y.qZA()(),y.BQk()}}function Qt(tt,Ve){if(1&tt){const Y=y.EpF();y.ynx(0),y.TgZ(1,"ion-button",31),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw(2);return y.KtG(We.launchNavigation())}),y._UZ(2,"ion-icon",32),y.TgZ(3,"ion-label"),y._uU(4,"Navigate"),y.qZA()(),y.BQk()}}function dt(tt,Ve){if(1&tt){const Y=y.EpF();y.ynx(0),y.TgZ(1,"ion-button",33),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw(2);return y.KtG(We.addComment())}),y._UZ(2,"ion-icon",34),y.TgZ(3,"ion-label"),y._uU(4,"Add Comment"),y.qZA()(),y.BQk()}}function gt(tt,Ve){if(1&tt){const Y=y.EpF();y.ynx(0),y.TgZ(1,"ion-button",35),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw(2);return y.KtG(We.addMedia())}),y._UZ(2,"ion-icon",36),y.TgZ(3,"ion-label"),y._uU(4," Add Photo"),y.qZA()(),y.BQk()}}function ct(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(1),y.hij(" ",Y.poi.AddressInfo.AddressLine1,"")}}function Ue(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(1),y.hij(" ",Y.poi.AddressInfo.AddressLine2,"")}}function vt(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(1),y.hij(" ",Y.poi.AddressInfo.Town,"")}}function je(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(1),y.hij(" ",Y.poi.AddressInfo.StateOrProvince,"")}}function _t(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(1),y.hij(" ",Y.poi.AddressInfo.Postcode,"")}}function Ne(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(1),y.hij(" ",Y.poi.AddressInfo.Country.Title,"")}}function Ft(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(1),y.hij(" ",Y.poi.AddressInfo.AccessComments," ")}}function Gt(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"ion-icon",48),y.TgZ(2,"span",45),y._uU(3),y.qZA()()),2&tt){const Y=y.oxw(4);y.xp6(3),y.Oqu(Y.poi.AddressInfo.ContactTelephone1)}}function wn(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"ion-icon",48),y.TgZ(2,"span",45),y._uU(3),y.qZA()()),2&tt){const Y=y.oxw(4);y.xp6(3),y.Oqu(Y.poi.AddressInfo.ContactTelephone2)}}function Xt(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"ion-icon",49),y.TgZ(2,"span",45),y._uU(3),y.qZA()()),2&tt){const Y=y.oxw(4);y.xp6(3),y.Oqu(Y.poi.AddressInfo.ContactEmail)}}function mn(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"ion-icon",50),y.TgZ(2,"span",45)(3,"a",51),y._uU(4),y.qZA()()()),2&tt){const Y=y.oxw(4);y.xp6(3),y.s9C("href",Y.poi.AddressInfo.RelatedURL,y.LSH),y.xp6(1),y.Oqu(Y.poi.AddressInfo.RelatedURL)}}function sn(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-card")(1,"ion-card-header"),y._UZ(2,"ion-icon",43),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.TgZ(5,"ion-card-content")(6,"ion-grid")(7,"ion-row")(8,"ion-col")(9,"ion-label",44),y._uU(10),y.ALo(11,"translate"),y.qZA(),y.TgZ(12,"div",45),y.YNc(13,ct,2,1,"div",0),y.YNc(14,Ue,2,1,"div",0),y.YNc(15,vt,2,1,"div",0),y.YNc(16,je,2,1,"div",0),y.YNc(17,_t,2,1,"div",0),y.YNc(18,Ne,2,1,"div",0),y.qZA()(),y.TgZ(19,"ion-col"),y.YNc(20,Ft,2,1,"p",0),y.YNc(21,Gt,4,1,"p",0),y.YNc(22,wn,4,1,"p",0),y.YNc(23,Xt,4,1,"p",0),y.YNc(24,mn,5,2,"p",0),y.qZA()(),y.TgZ(25,"ion-row")(26,"ion-col"),y._UZ(27,"ion-icon",46),y.TgZ(28,"ion-label",47),y._uU(29),y.ALo(30,"number"),y.ALo(31,"number"),y.qZA()()()()()()),2&tt){const Y=y.oxw(3);y.xp6(3),y.hij(" ",y.lcZ(4,15,"ocm.details.location.sectionTitle")," "),y.xp6(7),y.hij(" ",y.lcZ(11,17,"ocm.details.location.address"),""),y.xp6(3),y.Q6J("ngIf",Y.poi.AddressInfo.AddressLine1),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.AddressLine2),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.Town),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.StateOrProvince),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.Postcode),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.Country),y.xp6(2),y.Q6J("ngIf",Y.poi.AddressInfo.AccessComments),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.ContactTelephone1),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.ContactTelephone2),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.ContactEmail),y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo.RelatedURL),y.xp6(5),y.AsE(" ",y.xi3(30,19,Y.poi.AddressInfo.Latitude,"1.1-13")," , ",y.xi3(31,22,Y.poi.AddressInfo.Longitude,"1.1-13")," ")}}function Vt(tt,Ve){if(1&tt&&(y.TgZ(0,"p")(1,"span",44),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"span",45),y._uU(5),y.qZA()()),2&tt){const Y=y.oxw(3);y.xp6(2),y.hij("",y.lcZ(3,2,"ocm.details.numberOfPoints"),":"),y.xp6(3),y.Oqu(Y.poi.NumberOfPoints)}}function It(tt,Ve){if(1&tt&&(y.TgZ(0,"p")(1,"span",44),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"span",45),y._uU(5),y.qZA()()),2&tt){const Y=y.oxw(3);y.xp6(2),y.hij("",y.lcZ(3,2,"ocm.details.operationalStatus"),":"),y.xp6(3),y.hij(" ",Y.poi.StatusType.Title," ")}}function at(tt,Ve){if(1&tt&&(y.TgZ(0,"p")(1,"span",44),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"span",45),y._uU(5),y.qZA()()),2&tt){const Y=y.oxw(3);y.xp6(2),y.hij("",y.lcZ(3,2,"ocm.details.usageType"),":"),y.xp6(3),y.Oqu(Y.poi.UsageType.Title)}}function Wt(tt,Ve){if(1&tt&&(y.TgZ(0,"p")(1,"span",44),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"span",45),y._uU(5),y.qZA()()),2&tt){const Y=y.oxw(3);y.xp6(2),y.hij("",y.lcZ(3,2,"ocm.details.usageCost"),":"),y.xp6(3),y.hij(" ",Y.poi.UsageCost,"")}}function dn(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"br"),y._uU(2),y.ALo(3,"translate"),y._UZ(4,"br"),y.TgZ(5,"span",45),y._uU(6),y.qZA()()),2&tt){const Y=y.oxw(3);y.xp6(2),y.hij("",y.lcZ(3,2,"ocm.details.generalComments"),": "),y.xp6(4),y.Oqu(Y.poi.GeneralComments)}}function Sn(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"ion-icon",54),y._uU(2),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(2),y.hij(" ",Y.poi.OperatorInfo.WebsiteURL," ")}}function Nt(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"ion-icon",49),y._uU(2),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(2),y.hij(" ",Y.poi.OperatorInfo.ContactEmail," ")}}function yi(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y._UZ(1,"ion-icon",49),y._uU(2),y.qZA()),2&tt){const Y=y.oxw(4);y.xp6(2),y.hij(" ",Y.poi.OperatorInfo.FaultReportEmail," ")}}function Gi(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-card")(1,"ion-card-header"),y._UZ(2,"ion-icon",52),y._uU(3),y.ALo(4,"translate"),y.qZA(),y.TgZ(5,"ion-card-content")(6,"div",45)(7,"p",53),y._uU(8),y.qZA(),y.YNc(9,Sn,3,1,"p",0),y.YNc(10,Nt,3,1,"p",0),y.YNc(11,yi,3,1,"p",0),y.qZA()()()),2&tt){const Y=y.oxw(3);y.xp6(3),y.hij(" ",y.lcZ(4,5,"ocm.details.operator.sectionTitle")," "),y.xp6(5),y.hij(" ",Y.poi.OperatorInfo.Title," "),y.xp6(1),y.Q6J("ngIf",Y.poi.OperatorInfo.WebsiteURL),y.xp6(1),y.Q6J("ngIf",null!=Y.poi.OperatorInfo.ContactEmail),y.xp6(1),y.Q6J("ngIf",null!=Y.poi.OperatorInfo.FaultReportEmail&&Y.poi.OperatorInfo.FaultReportEmail!=Y.poi.OperatorInfo.ContactEmail)}}function gn(tt,Ve){if(1&tt){const Y=y.EpF();y.TgZ(0,"a",56),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw(4);return y.KtG(We.launchURL(We.poi.DataProvider.WebsiteURL))}),y._uU(1),y.qZA()}if(2&tt){const Y=y.oxw(4);y.xp6(1),y.Oqu(Y.poi.DataProvider.WebsiteURL)}}function si(tt,Ve){if(1&tt&&(y.TgZ(0,"div",45)(1,"h3"),y._uU(2),y.ALo(3,"translate"),y.qZA(),y.TgZ(4,"p"),y._uU(5),y.qZA(),y.YNc(6,gn,2,1,"a",55),y.TgZ(7,"p"),y._uU(8),y.qZA()()),2&tt){const Y=y.oxw(3);y.xp6(2),y.hij(" ",y.lcZ(3,4,"ocm.details.dataProvider.sectionTitle")," "),y.xp6(3),y.Oqu(null==Y.poi.DataProvider?null:Y.poi.DataProvider.Title),y.xp6(1),y.Q6J("ngIf",Y.poi.DataProvider.WebsiteURL),y.xp6(2),y.Oqu(null==Y.poi.DataProvider?null:Y.poi.DataProvider.License)}}function Je(tt,Ve){if(1&tt&&(y.TgZ(0,"div",37),y.YNc(1,sn,32,25,"ion-card",0),y.TgZ(2,"ion-card")(3,"ion-card-header"),y._UZ(4,"ion-icon",38),y._uU(5),y.ALo(6,"translate"),y.qZA(),y.TgZ(7,"ion-card-content"),y.YNc(8,Vt,6,4,"p",0),y._UZ(9,"app-equipment-details",39),y.qZA()(),y.TgZ(10,"ion-card")(11,"ion-card-header"),y._UZ(12,"ion-icon",40),y._uU(13," Usage Restrictions "),y.qZA(),y.TgZ(14,"ion-card-content"),y.YNc(15,It,6,4,"p",0),y.YNc(16,at,6,4,"p",0),y.YNc(17,Wt,6,4,"p",0),y.YNc(18,dn,7,4,"p",0),y.qZA()(),y.YNc(19,Gi,12,7,"ion-card",0),y.TgZ(20,"ion-card")(21,"ion-card-header"),y._UZ(22,"ion-icon",41),y._uU(23),y.ALo(24,"translate"),y.qZA(),y.TgZ(25,"ion-card-content"),y.YNc(26,si,9,6,"div",42),y.qZA()()()),2&tt){const Y=y.oxw(2);y.xp6(1),y.Q6J("ngIf",Y.poi.AddressInfo),y.xp6(4),y.hij(" ",y.lcZ(6,11,"ocm.details.equipment.sectionTitle")," "),y.xp6(3),y.Q6J("ngIf",null!=Y.poi.NumberOfPoints),y.xp6(1),y.Q6J("item",Y.poi),y.xp6(6),y.Q6J("ngIf",null!=Y.poi.StatusType),y.xp6(1),y.Q6J("ngIf",null!=Y.poi.UsageType),y.xp6(1),y.Q6J("ngIf",null!=Y.poi.UsageCost),y.xp6(1),y.Q6J("ngIf",null!=Y.poi.GeneralComments),y.xp6(1),y.Q6J("ngIf",Y.poi.OperatorInfo),y.xp6(4),y.hij(" ",y.lcZ(24,13,"ocm.details.advancedDetails")," "),y.xp6(3),y.Q6J("ngIf",Y.poi.DataProvider)}}function At(tt,Ve){if(1&tt&&y._UZ(0,"img",60),2&tt){const Y=y.oxw().$implicit;y.s9C("src",null==Y.User?null:Y.User.ProfileImageURL,y.LSH)}}function Zt(tt,Ve){if(1&tt&&(y.TgZ(0,"span"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw().$implicit;y.xp6(1),y.Oqu(Y.User.Username)}}function un(tt,Ve){if(1&tt&&(y.TgZ(0,"span"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw().$implicit;y.xp6(1),y.Oqu(Y.Username)}}function hn(tt,Ve){if(1&tt&&(y.TgZ(0,"p",45),y._uU(1),y.qZA()),2&tt){const Y=y.oxw().$implicit;y.xp6(1),y.hij(" ",null==Y.CommentType?null:Y.CommentType.Title," ")}}function gi(tt,Ve){if(1&tt&&(y.TgZ(0,"p")(1,"span",44),y._uU(2,"Rating:"),y.qZA(),y.TgZ(3,"span",45),y._uU(4),y.qZA()()),2&tt){const Y=y.oxw().$implicit;y.xp6(4),y.hij("",Y.Rating," out of 5")}}function Yt(tt,Ve){1&tt&&(y.ynx(0),y._UZ(1,"ion-icon",61),y.BQk())}function Un(tt,Ve){1&tt&&(y.ynx(0),y._UZ(1,"ion-icon",62),y.BQk())}function oi(tt,Ve){if(1&tt&&(y.TgZ(0,"p"),y.YNc(1,Yt,2,0,"ng-container",0),y.YNc(2,Un,2,0,"ng-container",0),y._uU(3),y.qZA()),2&tt){const Y=y.oxw().$implicit;y.xp6(1),y.Q6J("ngIf",!0===Y.CheckinStatusType.IsPositive),y.xp6(1),y.Q6J("ngIf",!1===Y.CheckinStatusType.IsPositive),y.xp6(1),y.hij(" ",Y.CheckinStatusType.Title," ")}}function Ci(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-card")(1,"ion-item")(2,"ion-avatar",19),y.YNc(3,At,1,1,"img",59),y.qZA(),y.TgZ(4,"ion-label"),y.YNc(5,Zt,2,1,"span",0),y.YNc(6,un,2,1,"span",0),y.qZA(),y.TgZ(7,"ion-label",20),y._uU(8),y.ALo(9,"date"),y.qZA()(),y.TgZ(10,"ion-card-content")(11,"p"),y._uU(12),y.qZA(),y.YNc(13,hn,2,1,"p",42),y.YNc(14,gi,5,1,"p",0),y.YNc(15,oi,4,3,"p",0),y.qZA()()),2&tt){const Y=Ve.$implicit;y.xp6(3),y.Q6J("ngIf",Y.User&&Y.User.ProfileImageURL),y.xp6(2),y.Q6J("ngIf",Y.User),y.xp6(1),y.Q6J("ngIf",!Y.User),y.xp6(2),y.hij(" ",y.lcZ(9,8,Y.DateCreated)," "),y.xp6(4),y.Oqu(Y.Comment),y.xp6(1),y.Q6J("ngIf",10!=Y.CommentTypeID),y.xp6(1),y.Q6J("ngIf",Y.Rating),y.xp6(1),y.Q6J("ngIf",Y.CheckinStatusType)}}function Oi(tt,Ve){if(1&tt&&(y.ynx(0),y.YNc(1,Ci,16,10,"ion-card",58),y.BQk()),2&tt){const Y=y.oxw(3);y.xp6(1),y.Q6J("ngForOf",Y.poi.UserComments)}}function Po(tt,Ve){1&tt&&(y.TgZ(0,"p",21),y._uU(1),y.ALo(2,"translate"),y.qZA()),2&tt&&(y.xp6(1),y.hij(" ",y.lcZ(2,1,"ocm.details.commentsAndRatings.zeroComments")," "))}function fi(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y.YNc(1,Oi,2,1,"ng-container",0),y.YNc(2,Po,3,3,"p",57),y.qZA()),2&tt){const Y=y.oxw(2);y.xp6(1),y.Q6J("ngIf",1==Y.poi._hasComments),y.xp6(1),y.Q6J("ngIf",0==Y.poi._hasComments)}}function Vo(tt,Ve){if(1&tt&&y._UZ(0,"img",60),2&tt){const Y=y.oxw().$implicit;y.s9C("src",null==Y.User?null:Y.User.ProfileImageURL,y.LSH)}}function ut(tt,Ve){if(1&tt&&(y.TgZ(0,"span"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw().$implicit;y.xp6(1),y.Oqu(Y.User.Username)}}function pe(tt,Ve){if(1&tt&&(y.TgZ(0,"span"),y._uU(1),y.qZA()),2&tt){const Y=y.oxw().$implicit;y.xp6(1),y.Oqu(Y.Username)}}function ve(tt,Ve){if(1&tt&&(y.TgZ(0,"ion-card"),y._UZ(1,"img",60),y.TgZ(2,"ion-item")(3,"ion-avatar",19),y.YNc(4,Vo,1,1,"img",59),y.qZA(),y.TgZ(5,"ion-label"),y.YNc(6,ut,2,1,"span",0),y.YNc(7,pe,2,1,"span",0),y.qZA(),y.TgZ(8,"ion-label",20),y._uU(9),y.ALo(10,"date"),y.qZA()(),y.TgZ(11,"ion-card-content")(12,"p"),y._uU(13),y.qZA()()()),2&tt){const Y=Ve.$implicit;y.xp6(1),y.s9C("src",Y.ItemMediumURL,y.LSH),y.xp6(3),y.Q6J("ngIf",Y.User&&Y.User.ProfileImageURL),y.xp6(2),y.Q6J("ngIf",Y.User),y.xp6(1),y.Q6J("ngIf",!Y.User),y.xp6(2),y.hij(" ",y.lcZ(10,6,Y.DateCreated)," "),y.xp6(4),y.Oqu(Y.Comment)}}function et(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y.YNc(1,ve,14,8,"ion-card",58),y.qZA()),2&tt){const Y=y.oxw(3);y.xp6(1),y.Q6J("ngForOf",Y.poi.MediaItems)}}function yt(tt,Ve){1&tt&&(y.TgZ(0,"div",21)(1,"p",63),y._uU(2),y.ALo(3,"translate"),y.qZA()()),2&tt&&(y.xp6(2),y.hij(" ",y.lcZ(3,1,"ocm.details.mediaItems.addPrompt"),""))}function Rt(tt,Ve){if(1&tt&&(y.TgZ(0,"div"),y.YNc(1,et,2,1,"div",0),y.YNc(2,yt,4,3,"div",57),y.qZA()),2&tt){const Y=y.oxw(2);y.xp6(1),y.Q6J("ngIf",Y.poi._hasPhotos),y.xp6(1),y.Q6J("ngIf",!Y.poi._hasPhotos)}}function Ut(tt,Ve){if(1&tt&&(y.TgZ(0,"p",64),y._uU(1),y.qZA()),2&tt){const Y=y.oxw(2);y.xp6(1),y.hij(" ",Y.json,"")}}function jt(tt,Ve){if(1&tt){const Y=y.EpF();y.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"h2"),y._uU(4),y.qZA(),y.TgZ(5,"div")(6,"small"),y._uU(7),y.qZA()(),y.YNc(8,Ze,3,1,"div",0),y.YNc(9,Se,3,1,"div",0),y.TgZ(10,"ion-badge",3),y._uU(11),y.ALo(12,"number"),y.qZA()(),y.TgZ(13,"ion-fab",4)(14,"ion-fab-button"),y._UZ(15,"ion-icon",5),y.qZA(),y.TgZ(16,"ion-fab-list",6)(17,"ion-fab-button",7),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw();return y.KtG(We.addComment())}),y._UZ(18,"ion-icon",8),y.qZA(),y.TgZ(19,"ion-fab-button",9),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw();return y.KtG(We.addMedia())}),y._UZ(20,"ion-icon",10),y.qZA(),y.TgZ(21,"ion-fab-button",11),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw();return y.KtG(We.addFavourite())}),y._UZ(22,"ion-icon",12),y.qZA(),y.TgZ(23,"ion-fab-button",13),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw();return y.KtG(We.edit())}),y._UZ(24,"ion-icon",14),y.qZA(),y.TgZ(25,"ion-fab-button",15),y.NdJ("click",function(){y.CHM(Y);const We=y.oxw();return y.KtG(We.refresh())}),y._UZ(26,"ion-icon",16),y.qZA()()()(),y.TgZ(27,"ion-refresher",17),y.NdJ("ionRefresh",function(We){y.CHM(Y);const kt=y.oxw();return y.KtG(kt.refresh(We))}),y._UZ(28,"ion-refresher-content",18),y.qZA(),y.TgZ(29,"ion-toolbar")(30,"ion-buttons",19),y.YNc(31,ye,9,0,"ng-container",0),y.qZA(),y.TgZ(32,"ion-buttons",20),y.YNc(33,Qt,5,0,"ng-container",0),y.YNc(34,dt,5,0,"ng-container",0),y.YNc(35,gt,5,0,"ng-container",0),y.qZA()(),y.TgZ(36,"div",21)(37,"ion-segment",22),y.NdJ("ngModelChange",function(We){y.CHM(Y);const kt=y.oxw();return y.KtG(kt.selectedTab=We)}),y.TgZ(38,"ion-segment-button",23)(39,"ion-label"),y._uU(40," Details "),y.qZA()(),y.TgZ(41,"ion-segment-button",24)(42,"ion-label"),y._uU(43),y.qZA()(),y.TgZ(44,"ion-segment-button",25)(45,"ion-label"),y._uU(46),y.qZA()()()(),y.YNc(47,Je,27,15,"div",26),y.YNc(48,fi,3,2,"div",0),y.YNc(49,Rt,3,2,"div",0),y.YNc(50,Ut,2,1,"p",27),y.qZA()}if(2&tt){const Y=y.oxw();y.xp6(1),y.Udp("background-image",Y.backdropImage?"url("+Y.backdropImage+")":""),y.xp6(3),y.hij(" ",Y.poi.AddressInfo.Title," "),y.xp6(3),y.hij("OCM-",Y.poi.ID,""),y.xp6(1),y.Q6J("ngIf",Y.connectionSummary),y.xp6(1),y.Q6J("ngIf",Y.poi.OperatorInfo),y.xp6(2),y.Oqu(y.xi3(12,18,Y.avgRating,"1.1-1")),y.xp6(20),y.Q6J("ngIf","location"==Y.selectedTab),y.xp6(2),y.Q6J("ngIf","location"==Y.selectedTab),y.xp6(1),y.Q6J("ngIf","comments"==Y.selectedTab),y.xp6(1),y.Q6J("ngIf","media"==Y.selectedTab),y.xp6(2),y.Q6J("ngModel",Y.selectedTab),y.xp6(6),y.hij("Comments (",Y.poi.UserComments?Y.poi.UserComments.length:0,")"),y.xp6(3),y.hij(" Photos (",Y.poi.MediaItems?Y.poi.MediaItems.length:0,")"),y.xp6(1),y.Q6J("ngIf","location"==Y.selectedTab),y.xp6(1),y.Q6J("ngIf","comments"==Y.selectedTab),y.xp6(1),y.Q6J("ngIf","media"==Y.selectedTab),y.xp6(1),y.Q6J("ngIf",1==Y.appManager.isDebugMode)}}function St(tt,Ve){1&tt&&(y.TgZ(0,"div")(1,"h2"),y._uU(2,"POI Not Found"),y.qZA(),y.TgZ(3,"p"),y._uU(4,"The POI details could not be loaded."),y.qZA()())}let Kt=(()=>{class tt{constructor(Y,me,We,kt,_n,ti,Ei,Si){(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"nav",void 0),(0,v.Z)(this,"translate",void 0),(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"actionSheetController",void 0),(0,v.Z)(this,"poiManager",void 0),(0,v.Z)(this,"router",void 0),(0,v.Z)(this,"poi",void 0),(0,v.Z)(this,"selectedTab",void 0),(0,v.Z)(this,"json",void 0),(0,v.Z)(this,"hasNavBar",!1),(0,v.Z)(this,"backdropImage",void 0),(0,v.Z)(this,"avgRating",void 0),(0,v.Z)(this,"connectionSummary",void 0),this.appManager=Y,this.nav=me,this.translate=We,this.logging=kt,this.modalController=_n,this.actionSheetController=ti,this.poiManager=Ei,this.router=Si}ngOnChanges(Y){if(this.logging.log("In ngOnChanges of POI Details"),null!=this.poi&&null!=this.poi.AddressInfo){if(this.selectedTab="location",null!=this.poi.MediaItems&&this.poi.MediaItems.length>0){this.poi._hasPhotos=!0;for(let me of this.poi.MediaItems)me.ItemMediumURL=me.ItemThumbnailURL.replace(".thmb.",".medi.");this.backdropImage=this.poi.MediaItems[this.poi.MediaItems.length-1].ItemThumbnailURL.replace(".thmb.",".medi.")}else this.poi._hasPhotos=!1,this.backdropImage=null;if(null!=this.poi.UserComments&&this.poi.UserComments.length>0){this.poi._hasComments=!0;try{let me=this.poi.UserComments.filter(We=>We.Rating>0);if(me.length>0){let We=0;for(let kt of me)We+=kt.Rating;this.avgRating=We/me.length}else this.avgRating=null}catch{}}else this.poi._hasComments=!1;if(this.poi.Connections&&this.poi.Connections.length>0){let me="";for(let We of this.poi.Connections)-1==me.indexOf(We.ConnectionType.Title)&&(me+=(""!=me?", ":"")+We.ConnectionType.Title);this.connectionSummary=me}}}ngOnInit(){this.logging.log("In ngInit of POI Details")}get staticMapURL(){return"https://maps.googleapis.com/maps/api/staticmap?key="+(new Ce.X).googleMapsAPIKey+"&center="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude}get staticMapSize(){return 0===this.appManager.clientWidth?"240x100":this.appManager.clientWidth>=800?"640x100":this.appManager.clientWidth>=400?"400x100":"240x100"}continueAddComment(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.modalController.create({component:Oe,componentProps:{id:Y.poi.ID,poi:Y.poi}});setTimeout(()=>{Y.refresh()},1e3),yield me.present()})()}addComment(){var Y=this;return(0,Q.Z)(function*(){if(Y.appManager.isUserAuthenticated(!0))yield Y.continueAddComment();else{const me=yield Y.modalController.create({component:Xe.F});me.onDidDismiss().then((0,Q.Z)(function*(){Y.appManager.isUserAuthenticated(!0)&&(yield Y.continueAddComment())})),yield me.present()}})()}continueAddMedia(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.modalController.create({component:Le,componentProps:{id:Y.poi.ID,poi:Y.poi}});me.onDidDismiss().then(()=>{setTimeout(()=>{Y.refresh()},1e3)}),yield me.present()})()}addMedia(){var Y=this;return(0,Q.Z)(function*(){if(Y.appManager.isUserAuthenticated(!0))yield Y.continueAddMedia();else{const me=yield Y.modalController.create({component:Xe.F});me.onDidDismiss().then((0,Q.Z)(function*(){Y.appManager.isUserAuthenticated(!0)&&(yield Y.continueAddMedia())})),yield me.present()}})()}addFavourite(){var Y=this;return(0,Q.Z)(function*(){yield(yield Y.actionSheetController.create({header:"Add Favourite",buttons:[{text:"Add to Journey",handler:()=>{Y.modalController.create({component:Te,componentProps:{poi:Y.poi}}).then(We=>We.present())}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}launchNavigation(){this.appManager.isPlatform("ios")?this.appManager.launchWebPage("https://maps.apple.com/?ll="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude):this.appManager.launchWebPage("https://maps.google.com/?q="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude)}launchURL(Y){this.appManager.launchWebPage(Y)}continueEdit(){var Y=this;return(0,Q.Z)(function*(){const me=yield Y.modalController.create({component:Ee.Y,componentProps:{id:Y.poi.ID}});return me.onDidDismiss().then(We=>{Y.refresh()}),yield me.present()})()}edit(){var Y=this;return(0,Q.Z)(function*(){if(ae.c.isFeatureEnabled("EDIT_POI"))if(Y.appManager.isUserAuthenticated(!0))yield Y.continueEdit();else{const me=yield Y.modalController.create({component:Xe.F});me.onDidDismiss().then((0,Q.Z)(function*(){Y.appManager.isUserAuthenticated(!0)&&(yield Y.continueEdit())})),yield me.present()}else Y.appManager.launchOCMWebPage("/poi/edit/"+Y.poi.ID)})()}refresh(Y=null){this.poi&&this.poiManager.getPOIById(this.poi.ID,!0,!0).then(me=>{me&&(this.poi=me,this.ngOnChanges(null)),Y&&Y.target.complete()})}}return(0,v.Z)(tt,"\u0275fac",function(Y){return new(Y||tt)(y.Y36(d.c),y.Y36(s.SH),y.Y36(mt.sK),y.Y36(ge.z),y.Y36(s.IN),y.Y36(s.BX),y.Y36(nt.R),y.Y36(Me.F0))}),(0,v.Z)(tt,"\u0275cmp",y.Xpm({type:tt,selectors:[["poi-details"]],inputs:{poi:"poi"},features:[y.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"banner"],[1,"banner-content"],["color","primary","title","Average User Rating"],["vertical","top","horizontal","end","slot","fixed"],["name","add"],["side","bottom"],["title","Add a comment or charging check-in",3,"click"],["name","chatbubbles"],["title","Add a Photo",3,"click"],["name","camera"],["title","Add to Favourites",3,"click"],["name","star"],["title","Submit an Edit",3,"click"],["name","create"],["title","Refresh",3,"click"],["name","refresh"],["slot","fixed",3,"ionRefresh"],["pullingIcon","caret-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["slot","start"],["slot","end"],[1,"ion-padding"],[3,"ngModel","ngModelChange"],["value","location","selected",""],["value","comments"],["value","media"],["class","address-details",4,"ngIf"],["style","white-space: pre-wrap;",4,"ngIf"],["size","small","title","Add to Favourites",3,"click"],["name","star","slot","start"],["name","create","slot","start"],[3,"click"],["name","navigate","slot","start"],["size","small","title","Add a comment or charging check-in",3,"click"],["name","chatbubbles","slot","start"],["size","small","title","Add a Photo",3,"click"],["name","camera","slot","start"],[1,"address-details"],["name","battery-charging"],[3,"item"],["name","book"],["name","information-circle"],["class","details",4,"ngIf"],["name","map"],[1,"label"],[1,"details"],["name","pin"],[1,"details-minor"],["name","call"],["name","mail"],["name","globe"],["target","_system",3,"href"],["name","help-circle"],[1,"ion-padding-left"],["name","link"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["class","ion-padding",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"src",4,"ngIf"],[3,"src"],["name","checkmark-circle","color","success",2,"font-size","2em"],["name","close-circle","color","danger"],[1,"subtle"],[2,"white-space","pre-wrap"]],template:function(Y,me){1&Y&&(y.YNc(0,jt,51,21,"div",0),y.YNc(1,St,5,0,"div",0)),2&Y&&(y.Q6J("ngIf",null!=me.poi&&null!=me.poi.AddressInfo),y.xp6(1),y.Q6J("ngIf",null==me.poi||null==me.poi.AddressInfo))},dependencies:[w.sg,w.O5,s.BJ,s.yp,s.YG,s.Sm,s.PM,s.FN,s.Zi,s.wI,s.IJ,s.W4,s.zq,s.jY,s.gu,s.Ie,s.Q$,s.nJ,s.Wo,s.Nd,s.cJ,s.GO,s.sr,s.QI,fe.JJ,fe.On,xe.B,w.JJ,w.uU,mt.X$],styles:[".banner[_ngcontent-%COMP%]{background-color:#4f712f;color:#ffffffec;padding:1em;text-shadow:#000 1px 1px 1px;min-height:180px;background-size:cover}.banner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.banner-content[_ngcontent-%COMP%]{padding-right:48px}h3[_ngcontent-%COMP%]{font-weight:700}.label[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:12px}.details[_ngcontent-%COMP%]{color:#707d61;margin-left:1em;font-size:12px}.details-minor[_ngcontent-%COMP%]{color:#707d61;font-size:12px}p[_ngcontent-%COMP%]{display:block;padding:4px}ion-card-header[_ngcontent-%COMP%]{font-weight:700;padding-bottom:0}ion-card-content[_ngcontent-%COMP%]{padding-top:4px}"]})),tt})(),In=(()=>{class tt{constructor(Y,me,We){(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"navParams",void 0),(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"poi",void 0),(0,v.Z)(this,"hasNavbar",!1),this.modalController=Y,this.navParams=me,this.appManager=We,this.poi=this.navParams.get("item"),this.appManager.analytics.viewEvent("POIDetails")}close(){this.modalController.dismiss()}}return(0,v.Z)(tt,"\u0275fac",function(Y){return new(Y||tt)(y.Y36(s.IN),y.Y36(s.X1),y.Y36(d.c))}),(0,v.Z)(tt,"\u0275cmp",y.Xpm({type:tt,selectors:[["ng-component"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],[1,"poi-details"],[3,"poi"]],template:function(Y,me){1&Y&&(y.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),y._uU(3),y.TgZ(4,"small"),y._uU(5),y.qZA()(),y.TgZ(6,"ion-buttons",1)(7,"ion-button",2),y.NdJ("click",function(){return me.close()}),y._UZ(8,"ion-icon",3),y.qZA()()()(),y.TgZ(9,"ion-content",4),y._UZ(10,"poi-details",5),y.qZA()),2&Y&&(y.xp6(3),y.hij(" ",me.poi.AddressInfo.Title," "),y.xp6(2),y.hij("OCM-",me.poi.ID,""),y.xp6(5),y.Q6J("poi",me.poi))},dependencies:[s.YG,s.Sm,s.W2,s.Gu,s.gu,s.wd,s.sr,Kt],styles:['.left-col[_ngcontent-%COMP%]{float:left;width:50%;overflow:auto}.right-col[_ngcontent-%COMP%]{float:right;width:50%;overflow:auto}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both;overflow:auto}.row[_ngcontent-%COMP%]{margin-bottom:1em}.subtle[_ngcontent-%COMP%]{color:silver}@media screen and (max-width: 768px){.left-col[_ngcontent-%COMP%]{float:none;width:100%}.right-col[_ngcontent-%COMP%]{margin-top:1em;float:none;width:100%}}.address-details[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;width:auto}ion-label[_ngcontent-%COMP%]{overflow:inherit}ion-title[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{color:#ffffffbf}']})),tt})()},5722:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{PoiEditorPageModule:()=>De});var v=R(1180),d=R(6814),y=R(6223),s=R(2125),Q=R(7852),ie=R(6662),W=R(3999),w=R(5086),fe=R(2029);const Ae=[{path:"",component:ie.Y}];let De=(()=>{class X{}return(0,v.Z)(X,"\u0275fac",function(Te){return new(Te||X)}),(0,v.Z)(X,"\u0275mod",fe.oAB({type:X})),(0,v.Z)(X,"\u0275inj",fe.cJS({imports:[d.ez,y.u5,Q.Pc,W.aw,w.e,s.Bz.forChild(Ae)]})),X})()},6662:(zn,Ct,R)=>{"use strict";R.d(Ct,{Y:()=>Gi});var v=R(5861),d=R(1180),y=R(1618),s=R(4677),Q=R(866),ie=R(4669),W=R(1847),w=R(2029),fe=R(3052),Ae=R(3955),De=R(9903),X=R(9127),se=R(5957),Te=R(9862),ge=R(6814),we=R(7852);function Le(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.TgZ(1,"ion-note")(2,"p"),w._uU(3," The closest address to this position is: "),w.qZA(),w.TgZ(4,"p")(5,"strong"),w._uU(6),w.qZA(),w._UZ(7,"br"),w._uU(8),w._UZ(9,"br"),w.TgZ(10,"ion-button",3),w.NdJ("click",function(){w.CHM(Je);const Zt=w.oxw();return w.KtG(Zt.useAddressSelection())}),w._uU(11,"Use this address below "),w._UZ(12,"ion-icon",4),w.qZA()()(),w.BQk()}if(2&gn){const Je=w.oxw();w.xp6(6),w.Oqu(Je.suggestedAddress.AddressLine1),w.xp6(2),w.HOy(" ",Je.suggestedAddress.AddressLine2," ",Je.suggestedAddress.Town," ",Je.suggestedAddress.StateOrProvince," ",Je.suggestedAddress.Postcode," ")}}let Me=(()=>{class gn{constructor(Je,At,Zt,un,hn){(0,d.Z)(this,"mapping",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"latitude",void 0),(0,d.Z)(this,"latitudeChange",new w.vpe),(0,d.Z)(this,"longitude",void 0),(0,d.Z)(this,"longitudeChange",new w.vpe),(0,d.Z)(this,"suggestedAddress",null),(0,d.Z)(this,"suggestedAddressChange",new w.vpe),(0,d.Z)(this,"onUseSuggestedAddress",new w.vpe),(0,d.Z)(this,"suggestedAddressAttribution",null),(0,d.Z)(this,"suggestedAddressAttributionChange",new w.vpe),(0,d.Z)(this,"originalMarkerPos",void 0),(0,d.Z)(this,"mapService",void 0),(0,d.Z)(this,"mapOptions",void 0),(0,d.Z)(this,"debouncedGecode",void 0),(0,d.Z)(this,"isMapInitialised",!1),this.mapping=Je,this.events=At,this.logging=Zt,this.http=un,this.appManager=hn}ngOnInit(){this.mapService=new De.k(this.events,this.logging,this.http),this.mapService.initAPI(),this.mapOptions=new Ae._,this.mapOptions.mapType=this.appManager.searchSettings.MapType,this.mapOptions.onMapMoveCompleted=()=>{let Je;Je=this.mapService.getMapCenter(),Je.subscribe(At=>{At&&(this.latitude=At.coords.latitude,this.longitude=At.coords.longitude,this.latitudeChange.emit(this.latitude),this.longitudeChange.emit(this.longitude),this.getAddressForCurrentLatLng())})}}ngAfterContentInit(){this.focusMap()}ngOnDestroy(){this.mapService.disposeMap()}focusMap(){0==this.isMapInitialised&&this.mapService&&0!=this.latitude&&0!=this.longitude&&(this.isMapInitialised=!0,this.mapService.initMap("editor-map",this.mapOptions,null),this.mapService.setMapCenter(new fe.jR(this.latitude,this.longitude)),this.originalMarkerPos=new fe.wC(this.latitude,this.longitude))}ngOnChanges(Je){this.focusMap()}getAddressForCurrentLatLng(){var Je=this;return(0,v.Z)(function*(){Je.latitude&&Je.longitude&&Je.appManager.api.fetchReverseGeocodeResult(Je.latitude,Je.longitude).then(At=>{At.AddressInfo&&(Je.suggestedAddress=At.AddressInfo)})})()}useAddressSelection(){this.onUseSuggestedAddress.emit({suggestedAddress:this.suggestedAddress,attribution:this.suggestedAddressAttribution}),this.suggestedAddress=null,this.suggestedAddressAttribution=null}}return(0,d.Z)(gn,"\u0275fac",function(Je){return new(Je||gn)(w.Y36(W.v),w.Y36(se.z),w.Y36(X.z),w.Y36(Te.eN),w.Y36(y.c))}),(0,d.Z)(gn,"\u0275cmp",w.Xpm({type:gn,selectors:[["app-poi-location-editor"]],inputs:{latitude:"latitude",longitude:"longitude"},outputs:{latitudeChange:"latitudeChange",longitudeChange:"longitudeChange",suggestedAddressChange:"suggestedAddressChange",onUseSuggestedAddress:"onUseSuggestedAddress",suggestedAddressAttributionChange:"suggestedAddressAttributionChange"},features:[w.TTD],decls:4,vars:1,consts:[[1,"instruction"],["id","editor-map"],[4,"ngIf"],["size","small",3,"click"],["slot","end","name","copy"]],template:function(Je,At){1&Je&&(w.TgZ(0,"p",0),w._uU(1,"Drag the map to center the marker on the charging location:"),w.qZA(),w._UZ(2,"div",1),w.YNc(3,Le,13,5,"ng-container",2)),2&Je&&(w.xp6(3),w.Q6J("ngIf",At.suggestedAddress))},dependencies:[ge.O5,we.YG,we.gu,we.uN],styles:["#editor-map[_ngcontent-%COMP%]{border:1px solid gainsboro;background-color:gray;width:100%;height:128px}"]})),gn})();var ze=R(9159),Ke=R(6223);function Oe(gn,si){if(1&gn&&(w.TgZ(0,"ion-select-option",14),w._uU(1),w.qZA()),2&gn){const Je=si.$implicit;w.Q6J("value",Je.ID),w.xp6(1),w.Oqu(Je.Title)}}function Ce(gn,si){if(1&gn&&(w.TgZ(0,"ion-select-option",14),w._uU(1),w.qZA()),2&gn){const Je=si.$implicit;w.Q6J("value",Je.ID),w.xp6(1),w.Oqu(Je.Title)}}function nt(gn,si){if(1&gn&&(w.TgZ(0,"ion-select-option",14),w._uU(1),w.qZA()),2&gn){const Je=si.$implicit;w.Q6J("value",Je.ID),w.xp6(1),w.Oqu(Je.Title)}}let Xe=(()=>{class gn{constructor(Je,At){(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"referenceDataManager",void 0),(0,d.Z)(this,"conn",void 0),(0,d.Z)(this,"useFilteredConnectionTypes",!0),(0,d.Z)(this,"useFilteredOperators",!0),this.modalController=Je,this.referenceDataManager=At}get isAddMode(){return!(null!=this.conn&&this.conn.ID>0)}get connectionTypes(){return this.referenceDataManager.getConnectionTypes(this.useFilteredConnectionTypes)}get currentTypes(){return this.referenceDataManager.getOutputCurrentTypes()}get statusTypes(){return this.referenceDataManager.getStatusTypes().filter(Je=>1==Je.IsUserSelectable)}ngOnInit(){}save(){var Je=!0;null!=this.conn.Quantity&&(this.conn.Quantity<0||this.conn.Quantity>100||!Number.isInteger(this.conn.Quantity))&&(alert("Quantity must be a whole number, or leave it blank."),Je=!1),Je&&this.modalController.dismiss({item:this.conn})}cancel(){this.modalController.dismiss()}}return(0,d.Z)(gn,"\u0275fac",function(Je){return new(Je||gn)(w.Y36(we.IN),w.Y36(ze.W))}),(0,d.Z)(gn,"\u0275cmp",w.Xpm({type:gn,selectors:[["app-poi-equipment-editor"]],decls:60,vars:13,consts:[[1,"ion-padding"],["position","floating"],[3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange"],["type","text","placeholder","(optional) other comments",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["slot","start"],[3,"click"],["name","close","slot","start"],["slot","end"],["color","success",3,"click"],["name","send","slot","end"],[3,"value"]],template:function(Je,At){1&Je&&(w.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),w._uU(3),w.qZA()()(),w.TgZ(4,"ion-content",0)(5,"p"),w._uU(6,"Please provide as much information as you can about the equipment. If you don't know then leave the field blank. At a minimum you should include the Connection Type and approximate Power kW (max)."),w.qZA(),w.TgZ(7,"ion-item")(8,"ion-label",1),w._uU(9,"Connection Type"),w.qZA(),w.TgZ(10,"ion-select",2),w.NdJ("ngModelChange",function(un){return At.conn.ConnectionTypeID=un}),w.TgZ(11,"ion-select-option",3),w._uU(12,"Unknown"),w.qZA(),w.YNc(13,Oe,2,2,"ion-select-option",4),w.qZA()(),w.TgZ(14,"ion-item")(15,"ion-label",1),w._uU(16,"Supply Type"),w.qZA(),w.TgZ(17,"ion-select",2),w.NdJ("ngModelChange",function(un){return At.conn.CurrentTypeID=un}),w.TgZ(18,"ion-select-option",3),w._uU(19,"Unknown"),w.qZA(),w.YNc(20,Ce,2,2,"ion-select-option",4),w.qZA()(),w.TgZ(21,"ion-item")(22,"ion-label",1),w._uU(23,"Power (kW)"),w.qZA(),w.TgZ(24,"ion-input",5),w.NdJ("ngModelChange",function(un){return At.conn.PowerKW=un}),w.qZA()(),w.TgZ(25,"ion-item")(26,"ion-label",1),w._uU(27,"Amps"),w.qZA(),w.TgZ(28,"ion-input",5),w.NdJ("ngModelChange",function(un){return At.conn.Amps=un}),w.qZA()(),w.TgZ(29,"ion-item")(30,"ion-label",1),w._uU(31,"Voltage"),w.qZA(),w.TgZ(32,"ion-input",5),w.NdJ("ngModelChange",function(un){return At.conn.Voltage=un}),w.qZA()(),w.TgZ(33,"ion-item")(34,"ion-label",1),w._uU(35,"Status"),w.qZA(),w.TgZ(36,"ion-select",2),w.NdJ("ngModelChange",function(un){return At.conn.StatusTypeID=un}),w.YNc(37,nt,2,2,"ion-select-option",4),w.qZA()(),w.TgZ(38,"ion-item")(39,"ion-label",1),w._uU(40,"Quantity Available"),w.qZA(),w.TgZ(41,"ion-input",5),w.NdJ("ngModelChange",function(un){return At.conn.Quantity=un}),w.qZA()(),w.TgZ(42,"ion-item")(43,"ion-label",1),w._uU(44,"Comment"),w.qZA(),w.TgZ(45,"ion-input",6),w.NdJ("ngModelChange",function(un){return At.conn.Comments=un}),w.qZA()(),w.TgZ(46,"ion-item")(47,"ion-label",1),w._uU(48,"Operators Reference"),w.qZA(),w.TgZ(49,"ion-input",7),w.NdJ("ngModelChange",function(un){return At.conn.Reference=un}),w.qZA()()(),w.TgZ(50,"ion-footer")(51,"ion-toolbar")(52,"ion-buttons",8)(53,"ion-button",9),w.NdJ("click",function(){return At.cancel()}),w._UZ(54,"ion-icon",10),w._uU(55," Cancel "),w.qZA()(),w.TgZ(56,"ion-buttons",11)(57,"ion-button",12),w.NdJ("click",function(){return At.save()}),w._uU(58," OK "),w._UZ(59,"ion-icon",13),w.qZA()()()()),2&Je&&(w.xp6(3),w.Oqu(At.isAddMode?"Add Equipment":"Edit Equipment"),w.xp6(7),w.Q6J("ngModel",At.conn.ConnectionTypeID),w.xp6(3),w.Q6J("ngForOf",At.connectionTypes),w.xp6(4),w.Q6J("ngModel",At.conn.CurrentTypeID),w.xp6(3),w.Q6J("ngForOf",At.currentTypes),w.xp6(4),w.Q6J("ngModel",At.conn.PowerKW),w.xp6(4),w.Q6J("ngModel",At.conn.Amps),w.xp6(4),w.Q6J("ngModel",At.conn.Voltage),w.xp6(4),w.Q6J("ngModel",At.conn.StatusTypeID),w.xp6(1),w.Q6J("ngForOf",At.statusTypes),w.xp6(4),w.Q6J("ngModel",At.conn.Quantity),w.xp6(4),w.Q6J("ngModel",At.conn.Comments),w.xp6(4),w.Q6J("ngModel",At.conn.Reference))},dependencies:[ge.sg,we.YG,we.Sm,we.W2,we.fr,we.Gu,we.gu,we.pK,we.Ie,we.Q$,we.t9,we.n0,we.wd,we.sr,we.as,we.QI,we.j9,Ke.JJ,Ke.On]})),gn})();var Ee=(()=>((Ee=Ee||{})[Ee.Unknown=0]="Unknown",Ee[Ee.CurrentlyAvailable=10]="CurrentlyAvailable",Ee[Ee.CurrentlyInUse=20]="CurrentlyInUse",Ee[Ee.TemporarilyUnavailable=30]="TemporarilyUnavailable",Ee[Ee.Operational=50]="Operational",Ee[Ee.PartlyOperational=75]="PartlyOperational",Ee[Ee.NotOperational=100]="NotOperational",Ee[Ee.PlannedForFutureDate=150]="PlannedForFutureDate",Ee[Ee.RemovedDecomissioned=200]="RemovedDecomissioned",Ee))(),ae=(()=>((ae=ae||{})[ae.UnknownOperator=1]="UnknownOperator",ae[ae.SiteOwner=45]="SiteOwner",ae))(),Ze=R(8696),Se=R(1163),ye=R(6086);function Qt(gn,si){1&gn&&w._UZ(0,"ion-icon",13)}function dt(gn,si){1&gn&&w._UZ(0,"ion-icon",13)}function gt(gn,si){1&gn&&w._UZ(0,"ion-icon",13)}function ct(gn,si){if(1&gn&&(w.TgZ(0,"ion-select-option",27),w._uU(1),w.qZA()),2&gn){const Je=si.$implicit;w.Q6J("value",Je.ID),w.xp6(1),w.Oqu(Je.Title)}}function Ue(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.TgZ(1,"app-poi-location-editor",14,15),w.NdJ("latitudeChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.Latitude=Zt)})("longitudeChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.Longitude=Zt)})("onUseSuggestedAddress",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.useSuggestedAddress(Zt))}),w.qZA(),w.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-label",16),w._uU(6,"Location Name"),w.qZA(),w.TgZ(7,"ion-input",17),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.Title=Zt)}),w.qZA()(),w.TgZ(8,"ion-item")(9,"ion-label",16),w._uU(10,"Address Line 1"),w.qZA(),w.TgZ(11,"ion-input",18),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.AddressLine1=Zt)}),w.qZA()(),w.TgZ(12,"ion-item")(13,"ion-label",16),w._uU(14,"Address Line 2"),w.qZA(),w.TgZ(15,"ion-input",19),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.AddressLine2=Zt)}),w.qZA()(),w.TgZ(16,"ion-item")(17,"ion-label",16),w._uU(18,"Town"),w.qZA(),w.TgZ(19,"ion-input",20),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.Town=Zt)}),w.qZA()(),w.TgZ(20,"ion-item")(21,"ion-label",16),w._uU(22,"State or Province"),w.qZA(),w.TgZ(23,"ion-input",21),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.StateOrProvince=Zt)}),w.qZA()(),w.TgZ(24,"ion-item")(25,"ion-label",16),w._uU(26,"Postal Code"),w.qZA(),w.TgZ(27,"ion-input",22),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.Postcode=Zt)}),w.qZA()(),w.TgZ(28,"ion-item")(29,"ion-label",16),w._uU(30,"Country"),w.qZA(),w.TgZ(31,"ion-select",23),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.CountryID=Zt)})("ionChange",function(){w.CHM(Je);const Zt=w.oxw(2);return w.KtG(Zt.onCountryChange())}),w.YNc(32,ct,2,2,"ion-select-option",24),w.qZA()(),w.TgZ(33,"ion-item")(34,"ion-input",25),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.Latitude=Zt)}),w.qZA()(),w.TgZ(35,"ion-item")(36,"ion-input",26),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.AddressInfo.Longitude=Zt)}),w.qZA()()(),w.BQk()}if(2&gn){const Je=w.oxw(2);w.xp6(1),w.Q6J("latitude",Je.item.AddressInfo.Latitude)("longitude",Je.item.AddressInfo.Longitude),w.xp6(6),w.Q6J("ngModel",Je.item.AddressInfo.Title),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.AddressLine1),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.AddressLine2),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.Town),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.StateOrProvince),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.Postcode),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.CountryID),w.xp6(1),w.Q6J("ngForOf",Je.countries),w.xp6(2),w.Q6J("ngModel",Je.item.AddressInfo.Latitude),w.xp6(2),w.Q6J("ngModel",Je.item.AddressInfo.Longitude)}}function vt(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.TgZ(1,"h3"),w._uU(2,"Locations Nearby"),w.qZA(),w.TgZ(3,"p")(4,"strong"),w._uU(5,"The following locations already exist nearby."),w.qZA()(),w.TgZ(6,"div",28)(7,"p"),w._uU(8,"Ensure you are not adding a duplicate site unless it is for different equipment from another network operator."),w.qZA(),w.TgZ(9,"p"),w._uU(10,"You can edit any of these listings if required instead:"),w.qZA()(),w.TgZ(11,"app-poi-list",29),w.NdJ("onEdit",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.editPOI(Zt))}),w.qZA(),w.BQk()}if(2&gn){const Je=w.oxw(2);w.xp6(11),w.Q6J("poiList",Je.nearbySites)("enableEditOption",!0)}}function je(gn,si){if(1&gn&&(w.ynx(0),w.YNc(1,Ue,37,12,"ng-container",9),w.YNc(2,vt,12,2,"ng-container",9),w.BQk()),2&gn){const Je=w.oxw();w.xp6(1),w.Q6J("ngIf","location"==Je.step),w.xp6(1),w.Q6J("ngIf","poi-nearby"==Je.step)}}function _t(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.TgZ(1,"p"),w._uU(2,"Copied the equipment configuration from:"),w.qZA(),w.TgZ(3,"ion-item")(4,"ion-label"),w._uU(5),w._UZ(6,"br"),w._uU(7),w._UZ(8,"br"),w._uU(9),w._UZ(10,"br"),w._uU(11),w._UZ(12,"br"),w._uU(13),w.qZA(),w.TgZ(14,"ion-button",31),w.NdJ("click",function(){w.CHM(Je);const Zt=w.oxw(5);return w.KtG(Zt.changeTemplatePOI())}),w._uU(15,"Change.."),w.qZA()(),w.BQk()}if(2&gn){const Je=w.oxw(5);w.xp6(5),w.hij(" ",Je.selectedTemplatePOI.AddressInfo.Title," "),w.xp6(2),w.hij(" ",Je.selectedTemplatePOI.AddressInfo.AddressLine1," "),w.xp6(2),w.hij(" ",null==Je.selectedTemplatePOI.Connections[0].ConnectionType?null:Je.selectedTemplatePOI.Connections[0].ConnectionType.Title," "),w.xp6(2),w.hij(" ",Je.selectedTemplatePOI.Connections[0].PowerKW," "),w.xp6(2),w.hij(" ",Je.selectedTemplatePOI.DateCreated," ")}}function Ne(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.TgZ(1,"h4"),w._uU(2,"Similar Sites"),w.qZA(),w.TgZ(3,"app-poi-list",32),w.NdJ("onCopy",function(Zt){w.CHM(Je);const un=w.oxw(6);return w.KtG(un.useTemplatePOI(Zt))}),w.qZA(),w.BQk()}if(2&gn){const Je=w.oxw(6);w.xp6(3),w.Q6J("enableCopyOption",!0)("poiList",Je.templateSites)}}function Ft(gn,si){1&gn&&(w.ynx(0),w.TgZ(1,"p"),w._uU(2," There are no suggested sites to copy for this network operator. "),w.qZA(),w.BQk())}function Gt(gn,si){if(1&gn&&(w.ynx(0),w.YNc(1,Ne,4,2,"ng-container",9),w.YNc(2,Ft,3,0,"ng-container",9),w.BQk()),2&gn){const Je=w.oxw(5);w.xp6(1),w.Q6J("ngIf",Je.templateSites.length>0),w.xp6(1),w.Q6J("ngIf",0==Je.templateSites.length)}}function wn(gn,si){if(1&gn&&(w.ynx(0),w.YNc(1,_t,16,5,"ng-container",9),w.YNc(2,Gt,3,2,"ng-container",9),w.BQk()),2&gn){const Je=w.oxw(4);w.xp6(1),w.Q6J("ngIf",Je.selectedTemplatePOI),w.xp6(1),w.Q6J("ngIf",!Je.selectedTemplatePOI)}}function Xt(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.TgZ(1,"p",28),w._uU(2,"You can copy the equipment settings from other sites operated by the same network operator or choose 'Next' to skip this step: "),w.qZA(),w.TgZ(3,"app-operator-lookup",30),w.NdJ("operatorChanged",function(Zt){w.CHM(Je);const un=w.oxw(3);return w.KtG(un.onOperatorChange(Zt))}),w.qZA(),w.YNc(4,wn,3,2,"ng-container",9),w.BQk()}if(2&gn){const Je=w.oxw(3);w.xp6(3),w.Q6J("operatorId",Je.item.OperatorID),w.xp6(1),w.Q6J("ngIf",Je.item.AddressInfo.CountryID&&Je.item.OperatorID)}}function mn(gn,si){if(1&gn&&(w.ynx(0),w.YNc(1,Xt,5,2,"ng-container",9),w.BQk()),2&gn){const Je=w.oxw(2);w.xp6(1),w.Q6J("ngIf",!Je.skipPOICopy)}}function sn(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.TgZ(1,"app-operator-lookup",33),w.NdJ("operatorChanged",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.onOperatorChange(Zt))}),w.qZA(),w.TgZ(2,"ion-item")(3,"ion-input",34),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.item.NumberOfPoints=Zt)}),w.qZA()(),w.TgZ(4,"h4"),w._uU(5,"Equipment"),w.qZA(),w.TgZ(6,"ion-button",35),w.NdJ("click",function(){w.CHM(Je);const Zt=w.oxw(2);return w.KtG(Zt.addConnection())}),w._UZ(7,"ion-icon",36),w.qZA(),w.TgZ(8,"app-equipment-details",37),w.NdJ("onEdit",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.editConnection(Zt))})("onDelete",function(Zt){w.CHM(Je);const un=w.oxw(2);return w.KtG(un.deleteConnection(Zt))}),w.qZA(),w.BQk()}if(2&gn){const Je=w.oxw(2);w.xp6(1),w.Q6J("operatorId",Je.item.OperatorID)("useFilteredOperators",!1),w.xp6(2),w.Q6J("ngModel",Je.item.NumberOfPoints),w.xp6(5),w.Q6J("item",Je.item)("enableEdit",!0)}}function Vt(gn,si){if(1&gn&&(w.ynx(0),w.YNc(1,mn,2,1,"ng-container",9),w.YNc(2,sn,9,5,"ng-container",9),w.BQk()),2&gn){const Je=w.oxw();w.xp6(1),w.Q6J("ngIf","copy-equipment"==Je.step),w.xp6(1),w.Q6J("ngIf","edit-equipment"==Je.step)}}function It(gn,si){if(1&gn&&(w.TgZ(0,"p",44)(1,"strong"),w._uU(2,"Your changes cannot be saved until the following issues are resolved:"),w.qZA(),w.TgZ(3,"ion-label",45),w._uU(4),w.qZA()()),2&gn){const Je=w.oxw(2);w.xp6(4),w.hij(" ",Je.validationMsg,"")}}function at(gn,si){if(1&gn&&(w.TgZ(0,"ion-select-option",27),w._uU(1),w.qZA()),2&gn){const Je=si.$implicit;w.Q6J("value",Je.ID),w.xp6(1),w.Oqu(Je.Title)}}function Wt(gn,si){if(1&gn&&(w.TgZ(0,"ion-select-option",27),w._uU(1),w.qZA()),2&gn){const Je=si.$implicit;w.Q6J("value",Je.ID),w.xp6(1),w.Oqu(Je.Title)}}function dn(gn,si){if(1&gn){const Je=w.EpF();w.ynx(0),w.YNc(1,It,5,1,"p",38),w.TgZ(2,"p"),w._uU(3,"Please provide any other facts related to this site. Additional comments (your charging experiences etc) can be added as check-in comments once the site is listed."),w.qZA(),w.TgZ(4,"ion-item")(5,"ion-label",16),w._uU(6,"Operational Status (All Equipment))"),w.qZA(),w.TgZ(7,"ion-select",39),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.StatusTypeID=Zt)}),w.YNc(8,at,2,2,"ion-select-option",24),w.qZA()(),w.TgZ(9,"ion-item")(10,"ion-label",16),w._uU(11,"Usage Type"),w.qZA(),w.TgZ(12,"ion-select",39),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.UsageTypeID=Zt)}),w.YNc(13,Wt,2,2,"ion-select-option",24),w.qZA()(),w.TgZ(14,"ion-item")(15,"ion-label",16),w._uU(16,"Usage Cost"),w.qZA(),w.TgZ(17,"ion-input",21),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.UsageCost=Zt)}),w.qZA()(),w.TgZ(18,"ion-item")(19,"ion-label",16),w._uU(20,"General Comments"),w.qZA(),w.TgZ(21,"ion-input",40),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.GeneralComments=Zt)}),w.qZA()(),w.TgZ(22,"ion-item")(23,"ion-label",16),w._uU(24,"Main Telephone Number "),w.qZA(),w.TgZ(25,"ion-input",41),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.AddressInfo.ContactTelephone1=Zt)}),w.qZA()(),w.TgZ(26,"ion-item")(27,"ion-label",16),w._uU(28,"Other Telephone Number "),w.qZA(),w.TgZ(29,"ion-input",41),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.AddressInfo.ContactTelephone2=Zt)}),w.qZA()(),w.TgZ(30,"ion-item")(31,"ion-label",16),w._uU(32,"Access Comments"),w.qZA(),w.TgZ(33,"ion-input",42),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.AddressInfo.AccessComments=Zt)}),w.qZA()(),w.TgZ(34,"ion-item")(35,"ion-label",16),w._uU(36,"Related Website"),w.qZA(),w.TgZ(37,"ion-input",43),w.NdJ("ngModelChange",function(Zt){w.CHM(Je);const un=w.oxw();return w.KtG(un.item.AddressInfo.RelatedURL=Zt)}),w.qZA()(),w.BQk()}if(2&gn){const Je=w.oxw();w.xp6(1),w.Q6J("ngIf",Je.validationMsg),w.xp6(6),w.Q6J("ngModel",Je.item.StatusTypeID),w.xp6(1),w.Q6J("ngForOf",Je.statusTypes),w.xp6(4),w.Q6J("ngModel",Je.item.UsageTypeID),w.xp6(1),w.Q6J("ngForOf",Je.usageTypes),w.xp6(4),w.Q6J("ngModel",Je.item.UsageCost),w.xp6(4),w.Q6J("ngModel",Je.item.GeneralComments),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.ContactTelephone1),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.ContactTelephone2),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.AccessComments),w.xp6(4),w.Q6J("ngModel",Je.item.AddressInfo.RelatedURL)}}function Sn(gn,si){if(1&gn){const Je=w.EpF();w.TgZ(0,"ion-button",1),w.NdJ("click",function(){w.CHM(Je);const Zt=w.oxw();return w.KtG(Zt.previous())}),w._uU(1," Previous "),w._UZ(2,"ion-icon",46),w.qZA()}}function Nt(gn,si){if(1&gn){const Je=w.EpF();w.TgZ(0,"ion-button",1),w.NdJ("click",function(){w.CHM(Je);const Zt=w.oxw();return w.KtG(Zt.next())}),w._uU(1," Next "),w._UZ(2,"ion-icon",47),w.qZA()}}function yi(gn,si){if(1&gn){const Je=w.EpF();w.TgZ(0,"ion-button",48),w.NdJ("click",function(){w.CHM(Je);const Zt=w.oxw();return w.KtG(Zt.save())}),w._uU(1," Submit "),w._UZ(2,"ion-icon",49),w.qZA()}}let Gi=(()=>{class gn{get countries(){return this.appManager.referenceDataManager.getCountries()}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes()}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes().filter(Je=>1==Je.IsUserSelectable)}get isAddMode(){return this.item.ID<=0}constructor(Je,At,Zt,un,hn,gi){(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"poiManager",void 0),(0,d.Z)(this,"mapping",void 0),(0,d.Z)(this,"loadingController",void 0),(0,d.Z)(this,"alertController",void 0),(0,d.Z)(this,"id",void 0),(0,d.Z)(this,"item",void 0),(0,d.Z)(this,"step",void 0),(0,d.Z)(this,"selectedTab",void 0),(0,d.Z)(this,"startPos",void 0),(0,d.Z)(this,"useFilteredConnectionTypes",!0),(0,d.Z)(this,"templateSites",[]),(0,d.Z)(this,"nearbySites",[]),(0,d.Z)(this,"selectedTemplatePOI",null),(0,d.Z)(this,"suggestedAddress",null),(0,d.Z)(this,"suggestedAddressAttribution",null),(0,d.Z)(this,"isNonDuplicateConfirmed",!1),(0,d.Z)(this,"skipPOICopy",!1),(0,d.Z)(this,"validationMsg",null),(0,d.Z)(this,"loading",void 0),(0,d.Z)(this,"editorMap",void 0),this.appManager=Je,this.modalController=At,this.poiManager=Zt,this.mapping=un,this.loadingController=hn,this.alertController=gi,this.initNewItem()}initNewItem(){this.item={ID:-1,DataProviderID:1,DataProvidersReference:null,OperatorsReference:null,OperatorID:1,UsageCost:null,UsageTypeID:4,NumberOfPoints:1,GeneralComments:null,DatePlanned:null,StatusTypeID:50,SubmissionStatusTypeID:null,Connections:[],MetadataValues:[],AddressInfo:{ID:-1,CountryID:18,Title:"",AddressLine1:"",Latitude:0,Longitude:0}},this.step="location",this.selectedTab="location"}get isReadyToSubmit(){return this.validate().isValid&&"info"==this.step}ngOnInit(){}presentLoadingUI(){var Je=this;return(0,v.Z)(function*(){Je.loading=yield Je.loadingController.create({message:"Please Wait.."}),yield Je.loading.present()})()}dismissLoadingUI(){var Je=this;return(0,v.Z)(function*(){Je.loading&&(yield Je.loading.dismiss())})()}ionViewDidEnter(){if(null!=this.id)this.editExistingPOI(this.id);else{let Je=localStorage.getItem("_editor-operatorid");Je&&(this.item.OperatorID=parseInt(Je,10)),this.startPos?(this.item.AddressInfo.Latitude=this.startPos.latitude,this.item.AddressInfo.Longitude=this.startPos.longitude):this.mapping&&this.mapping.getMapCenter().subscribe(At=>{At&&(this.item.AddressInfo.Latitude=At.coords.latitude,this.item.AddressInfo.Longitude=At.coords.longitude)})}this.refreshFilteredReferenceData()}previous(){var Je=this;return(0,v.Z)(function*(){switch(Je.step){case"info":Je.step="edit-equipment";break;case"edit-equipment":Je.step=Je.isAddMode?"copy-equipment":"location";break;case"copy-equipment":case"poi-nearby":Je.step="location"}yield Je.initCurrentStep(!1)})()}next(){var Je=this;return(0,v.Z)(function*(){if("poi-nearby"==Je.step&&Je.nearbySites.length>0&&!Je.isNonDuplicateConfirmed)return void(yield Je.alertController.create({header:"Confirm",message:"Please confirm you are not adding a duplicate site.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:un=>{}},{text:"Confirm",handler:()=>{Je.isNonDuplicateConfirmed=!0,Je.next()}}]})).present();const At=Je.validate(Je.step);if(At.isValid){switch(Je.step){case"location":Je.step=Je.isAddMode?"poi-nearby":"edit-equipment";break;case"poi-nearby":Je.step=Je.isAddMode?"copy-equipment":"edit-equipment";break;case"copy-equipment":Je.step="edit-equipment";break;case"edit-equipment":Je.step="info"}yield Je.initCurrentStep(!0)}else(yield Je.alertController.create({message:At.msg})).present()})()}initCurrentStep(Je){var At=this;return(0,v.Z)(function*(){"poi-nearby"==At.step?(At.selectedTab="location",0==(yield At.refreshNearbySites())&&(Je?yield At.next():yield At.previous())):"location"==At.step?At.selectedTab="location":"copy-equipment"==At.step?(At.selectedTab="equipment",yield At.refreshTemplateSites()):"edit-equipment"==At.step?At.selectedTab="equipment":"info"==At.step&&(At.selectedTab="info")})()}onCountryChange(){var Je=this;return(0,v.Z)(function*(){Je.refreshFilteredReferenceData()})()}onOperatorChange(Je=null){var At=this;return(0,v.Z)(function*(){null!=Je&&At.item.OperatorID!=Je.ID&&(At.item.OperatorID=Je.ID,localStorage.setItem("_editor-operatorid",At.item.OperatorID.toString()),yield At.refreshTemplateSites())})()}useSuggestedAddress(Je=null){Je&&(this.suggestedAddress=Je.suggestedAddress,this.suggestedAddressAttribution=Je.suggestedAddressAttribution),Object.assign(this.item.AddressInfo,this.suggestedAddress),this.suggestedAddressAttribution&&(this.item.MetadataValues.find(At=>4==At.MetadataFieldID)||this.item.MetadataValues.push({ID:-1,MetadataFieldID:4,ItemValue:this.suggestedAddressAttribution,MetadataFieldOptionID:null,MetadataFieldOption:null}))}editConnection(Je){var At=this;return(0,v.Z)(function*(){const Zt=At.item.Connections.find(gi=>gi.ID==Je.ID),un=Object.assign({},Zt),hn=yield At.modalController.create({component:Xe,componentProps:{conn:un}});return hn.onWillDismiss().then(gi=>{gi&&gi.data&&gi.data.item&&At.updateConnection(gi.data.item)}),yield hn.present()})()}deleteConnection(Je){var At=this;return(0,v.Z)(function*(){const Zt=At.item.Connections.find(hn=>hn.ID==Je.ID);(yield At.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this connection information?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Yes",handler:()=>{At.item.Connections=At.item.Connections.filter(hn=>hn.ID!=Zt.ID),At.appManager.referenceDataManager.hydrateCompactPOI(At.item,!0)}}]})).present()})()}addConnection(){var Je=this;return(0,v.Z)(function*(){const At={ID:-Q.c.getRandomInt(1e4),ConnectionTypeID:null,StatusTypeID:50,PowerKW:null,Quantity:1},Zt=yield Je.modalController.create({component:Xe,componentProps:{conn:At}});return Zt.onWillDismiss().then(un=>{un&&un.data&&un.data.item&&Je.updateConnection(un.data.item)}),yield Zt.present()})()}refreshFilteredReferenceData(){this.appManager.referenceDataManager.refreshFilteredReferenceData(this.appManager.api,{CountryIds:[this.item.AddressInfo.CountryID]})}updateConnection(Je){if(Je){let At=this.item.Connections.find(Zt=>Zt.ID==Je.ID);At?Object.assign(At,Je):this.item.Connections.push(Je)}this.appManager.referenceDataManager.hydrateCompactPOI(this.item,!0)}validate(Je="all"){let At=null;return("all"==Je||"location"==Je)&&((!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(At="Location is required"),""==this.item.AddressInfo.Title&&(At="A location title is required"),!this.item.AddressInfo.AddressLine1&&!this.item.AddressInfo.AddressLine2&&(At="An approximate address is required."),this.item.AddressInfo.CountryID||(At="A country selection is required"),(!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(At="A location latitude and longitude is required")),("all"==Je||"poi-nearby"==Je)&&this.nearbySites.length>0&&!this.isNonDuplicateConfirmed&&(At="Please confirm that the site is not a duplicate"),("all"==Je||"equipment"==Je)&&(this.item.OperatorID||(At="Please confirm the charging network or equipment operator."),0==this.item.Connections.length&&(At="Equipment information is required")),At?(this.validationMsg=At,{isValid:!1,msg:At}):(this.validationMsg=null,{isValid:!0,msg:null})}save(){var Je=this;return(0,v.Z)(function*(){let At=Je.validate();if(At.isValid){yield Je.presentLoadingUI();try{yield Je.appManager.submitPOI(Je.item),yield Je.dismissLoadingUI(),Je.appManager.showToastNotification("You submission will be reviewed (if required) and published shortly."),Je.modalController.dismiss()}catch(Zt){yield Je.dismissLoadingUI(),Zt.error&&alert("Sorry, your submission could not be completed at this time. Please try again later.")}}else alert(At.msg)})()}cancel(){var Je=this;return(0,v.Z)(function*(){Je.modalController.dismiss()})()}refreshTemplateSites(){var Je=this;return(0,v.Z)(function*(){if(Je.item.AddressInfo.CountryID&&Je.item.OperatorID){yield Je.presentLoadingUI(),Je.templateSites=[];let At=new s.b;At.countryIdList=[Je.item.AddressInfo.CountryID],At.minPowerKW=1,At.operatorIdList=[Je.item.OperatorID],At.maxResults=10;let Zt=yield Je.poiManager.fetchPOIList(At);Zt.sort((un,hn)=>new Date(un.DateCreated).getTime()-new Date(hn.DateCreated).getTime()),Je.templateSites=Zt,Je.dismissLoadingUI()}})()}refreshNearbySites(){var Je=this;return(0,v.Z)(function*(){if(Je.item.AddressInfo.Latitude&&Je.item.AddressInfo.Longitude){yield Je.presentLoadingUI(),Je.nearbySites=[];let At=new s.b;At.latitude=Je.item.AddressInfo.Latitude,At.longitude=Je.item.AddressInfo.Longitude,At.distance=5,At.distanceUnit="km",At.maxResults=10;let Zt=yield Je.poiManager.fetchPOIList(At);return Zt.sort((un,hn)=>un.Distance-hn.Distance),Je.nearbySites=Zt,Je.dismissLoadingUI(),Zt.length}return 0})()}confirmNonDuplicate(){this.isNonDuplicateConfirmed=!0,this.next()}changeTemplatePOI(){this.selectedTemplatePOI=null}editPOI(Je){this.editExistingPOI(Je.ID)}editExistingPOI(Je){var At=this;return(0,v.Z)(function*(){At.skipPOICopy=!0,At.isNonDuplicateConfirmed=!0,yield At.presentLoadingUI(),At.poiManager.getPOIById(Je,!0,!0).then(Zt=>{At.item=Object.assign({},Zt),null==At.item.OperatorID&&(At.item.OperatorID=ae.UnknownOperator),At.refreshFilteredReferenceData(),At.dismissLoadingUI()})})()}useTemplatePOI(Je){this.selectedTemplatePOI=Je,Object.assign(this.item.Connections,Je.Connections);for(let At of this.item.Connections)At.ID=-Q.c.getRandomInt(1e4),At.Reference=null,At.Comments=null,At.StatusTypeID=Ee.Operational;this.item.UsageCost=Je.UsageCost,this.item.UsageTypeID=Je.UsageTypeID,this.appManager.referenceDataManager.hydrateCompactPOI(this.item)}skipCopyingPOI(){this.skipPOICopy=!0}}return(0,d.Z)(gn,"\u0275fac",function(Je){return new(Je||gn)(w.Y36(y.c),w.Y36(we.IN),w.Y36(ie.R),w.Y36(W.v),w.Y36(we.HT),w.Y36(we.Br))}),(0,d.Z)(gn,"\u0275cmp",w.Xpm({type:gn,selectors:[["app-poi-editor"]],viewQuery:function(Je,At){if(1&Je&&w.Gf(Me,5),2&Je){let Zt;w.iGM(Zt=w.CRH())&&(At.editorMap=Zt.first)}},decls:33,vars:14,consts:[["slot","end"],[3,"click"],["name","close","slot","start"],[1,"ion-padding"],[3,"ngModel"],["value","location","layout","icon-start",3,"disabled"],["name","caret-forward",4,"ngIf"],["value","equipment","layout","icon-start",3,"disabled"],["value","info","layout","icon-start",3,"disabled"],[4,"ngIf"],["slot","start"],[3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],["name","caret-forward"],[3,"latitude","longitude","latitudeChange","longitudeChange","onUseSuggestedAddress"],["editorMap",""],["position","floating"],["type","text","autocapitalize","words","placeholder","A title for this location",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","The nearest street address",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Town or City",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional Postal Code",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["label","Latitude","labelPlacement","floating","type","number","placeholder","Latitude (if entering manually)",3,"ngModel","ngModelChange"],["label","Longitude","labelPlacement","floating","type","number","placeholder","Longitude (if entering manually)",3,"ngModel","ngModelChange"],[3,"value"],[1,"instruction"],[3,"poiList","enableEditOption","onEdit"],[3,"operatorId","operatorChanged"],["slot","start","size","small",3,"click"],[3,"enableCopyOption","poiList","onCopy"],[3,"operatorId","useFilteredOperators","operatorChanged"],["label","Number of Stations or Parking Bays","labelPlacement","floating","min","1","type","number",3,"ngModel","ngModelChange"],["size","small",3,"click"],["name","add","slot","icon-only"],[3,"item","enableEdit","onEdit","onDelete"],["color","warning",4,"ngIf"],[3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences",3,"ngModel","ngModelChange"],["type","tel","placeholder","",3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences","placeholder","Instructions for access or tips for finding charging location",3,"ngModel","ngModelChange"],["type","url","placeholder","Website related to this site",3,"ngModel","ngModelChange"],["color","warning"],["color","danger"],["name","caret-back","slot","start"],["name","caret-forward","slot","end"],["color","success",3,"click"],["name","send","slot","end"]],template:function(Je,At){1&Je&&(w.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),w._uU(3),w.qZA(),w.TgZ(4,"ion-buttons",0)(5,"ion-button",1),w.NdJ("click",function(){return At.cancel()}),w._UZ(6,"ion-icon",2),w._uU(7," Cancel "),w.qZA()()()(),w.TgZ(8,"ion-content",3),w.ynx(9),w.TgZ(10,"ion-segment",4)(11,"ion-segment-button",5),w.YNc(12,Qt,1,0,"ion-icon",6),w.TgZ(13,"ion-label"),w._uU(14,"Location"),w.qZA()(),w.TgZ(15,"ion-segment-button",7),w.YNc(16,dt,1,0,"ion-icon",6),w.TgZ(17,"ion-label"),w._uU(18,"Equipment"),w.qZA()(),w.TgZ(19,"ion-segment-button",8),w.YNc(20,gt,1,0,"ion-icon",6),w.TgZ(21,"ion-label"),w._uU(22,"Info"),w.qZA()()(),w.YNc(23,je,3,2,"ng-container",9),w.YNc(24,Vt,3,2,"ng-container",9),w.YNc(25,dn,38,11,"ng-container",9),w.BQk(),w.qZA(),w.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",10),w.YNc(29,Sn,3,0,"ion-button",11),w.qZA(),w.TgZ(30,"ion-buttons",0),w.YNc(31,Nt,3,0,"ion-button",11),w.YNc(32,yi,3,0,"ion-button",12),w.qZA()()()),2&Je&&(w.xp6(3),w.Oqu(At.isAddMode?"Add Location":"Edit Location"),w.xp6(7),w.Q6J("ngModel",At.selectedTab),w.xp6(1),w.Q6J("disabled",!0),w.xp6(1),w.Q6J("ngIf","location"==At.selectedTab),w.xp6(3),w.Q6J("disabled",!0),w.xp6(1),w.Q6J("ngIf","equipment"==At.selectedTab),w.xp6(3),w.Q6J("disabled",!0),w.xp6(1),w.Q6J("ngIf","info"==At.selectedTab),w.xp6(3),w.Q6J("ngIf","location"==At.selectedTab),w.xp6(1),w.Q6J("ngIf","equipment"==At.selectedTab),w.xp6(1),w.Q6J("ngIf","info"==At.selectedTab),w.xp6(4),w.Q6J("ngIf","location"!=At.step),w.xp6(2),w.Q6J("ngIf",!At.isReadyToSubmit&&"info"!=At.step),w.xp6(1),w.Q6J("ngIf",At.isReadyToSubmit))},dependencies:[ge.sg,ge.O5,Ke.JJ,Ke.On,we.YG,we.Sm,we.W2,we.fr,we.Gu,we.gu,we.pK,we.Ie,we.Q$,we.q_,we.cJ,we.GO,we.t9,we.n0,we.wd,we.sr,we.as,we.QI,we.j9,Ze.o,Se.B,Me,ye.z],styles:['ul.breadcrumb[_ngcontent-%COMP%]{display:inline-flex;margin:0;padding:0}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;margin-right:6px;color:var(--ion-color-light-shade);font-size:10px}ul.breadcrumb[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:var(--ion-color-dark-shade)}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:">";padding-right:4px}']})),gn})()},3247:(zn,Ct,R)=>{"use strict";R.d(Ct,{u:()=>Ee});var v=R(1180),d=R(2029),y=R(7852),s=R(3052),Q=R(989),ie=R(9127),W=R(7430),w=R(9862);let fe=(()=>{class ae{constructor(xe,Ze){(0,v.Z)(this,"http",void 0),(0,v.Z)(this,"journeyManager",void 0),this.http=xe,this.journeyManager=Ze}getDirections(xe,Ze){return new Promise((Se,ye)=>{(new google.maps.DirectionsService).route({origin:xe,destination:Ze,travelMode:google.maps.TravelMode.DRIVING},(dt,gt)=>{gt===google.maps.DirectionsStatus.OK?Se(dt):ye(gt)})})}analyseRoutes(xe,Ze){const Se=new Array;return xe.routes.forEach(ye=>{const Qt=new W.JJ;Qt.Title=""+Se.length+1,Qt.JourneyRouteLegs=new Array,Qt.TotalDistanceKM=0,Qt.TotalDurationMinutes=0,Qt.TotalEnergykWh=0,ye.legs.forEach(dt=>{const gt=dt.duration.value,ct=dt.distance.value/1e3,Ue=this.journeyManager.calculateEnergyConsumptionkWh(ct,0,null,Ze),vt=new W.eN;vt.DistanceKM=ct,vt.DurationMinutes=gt/60,vt.EnergyConsumptionkWh=Ue,Qt.JourneyRouteLegs.push(vt),Qt.TotalDistanceKM+=vt.DistanceKM,Qt.TotalDurationMinutes+=vt.DurationMinutes,Qt.TotalEnergykWh=vt.EnergyConsumptionkWh}),Se.push(Qt)}),Se}}return(0,v.Z)(ae,"\u0275fac",function(xe){return new(xe||ae)(d.LFG(w.eN),d.LFG(Q.i))}),(0,v.Z)(ae,"\u0275prov",d.Yz7({token:ae,factory:ae.\u0275fac,providedIn:"root"})),ae})();var Ae=R(1847),De=R(6814),X=R(6223),se=R(5460);function Te(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-searchbar",13),d.NdJ("ngModelChange",function(Se){d.CHM(xe);const ye=d.oxw();return d.KtG(ye.routeStart=Se)})("ionInput",function(Se){d.CHM(xe),d.oxw();const ye=d.MAs(18);return d.KtG(ye.getPlacesAutoComplete(Se,"routeStart"))})("ionCancel",function(Se){d.CHM(xe);const ye=d.oxw();return d.KtG(ye.onPlaceSearchCancel(Se))}),d.qZA()()}if(2&ae){const xe=d.oxw();d.xp6(2),d.Q6J("ngModel",xe.routeStart)("debounce",500)}}function ge(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){d.CHM(xe);const Se=d.oxw();return d.KtG(Se.clearRouteStart())}),d._UZ(1,"ion-icon",12),d.TgZ(2,"h2"),d._uU(3),d.qZA()()}if(2&ae){d.oxw();const xe=d.MAs(18);d.xp6(3),d.Oqu(null==xe.selectedPlace?null:xe.selectedPlace.name)}}function we(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",15),d.TgZ(2,"ion-searchbar",16),d.NdJ("ngModelChange",function(Se){d.CHM(xe);const ye=d.oxw();return d.KtG(ye.routeDestination=Se)})("ionInput",function(Se){d.CHM(xe),d.oxw();const ye=d.MAs(20);return d.KtG(ye.getPlacesAutoComplete(Se,"routeDestination"))})("ionCancel",function(Se){d.CHM(xe);const ye=d.oxw();return d.KtG(ye.onPlaceSearchCancel(Se))}),d.qZA()()}if(2&ae){const xe=d.oxw();d.xp6(2),d.Q6J("ngModel",xe.routeDestination)("debounce",500)}}function Le(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){d.CHM(xe);const Se=d.oxw();return d.KtG(Se.clearRouteDestination())}),d._UZ(1,"ion-icon",15),d.TgZ(2,"h2"),d._uU(3),d.qZA()()}if(2&ae){d.oxw();const xe=d.MAs(20);d.xp6(3),d.Oqu(null==xe.selectedPlace?null:xe.selectedPlace.name)}}function Me(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(xe);const Se=d.oxw();return d.KtG(Se.clearRoute())}),d._UZ(1,"ion-icon",17),d._uU(2," Clear Route "),d.qZA()}}function ze(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(xe);const Se=d.oxw();return d.KtG(Se.showSettings())}),d._uU(1," Show Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function Ke(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(xe);const Se=d.oxw();return d.KtG(Se.hideSettings())}),d._uU(1," Hide Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function Oe(ae,mt){1&ae&&(d.TgZ(0,"p",19),d._UZ(1,"ion-spinner",19),d._uU(2," Calculating Route.. "),d.qZA())}function Ce(ae,mt){if(1&ae&&(d.TgZ(0,"ion-list")(1,"ion-list-header"),d._uU(2),d.ALo(3,"number"),d.ALo(4,"number"),d.qZA()()),2&ae){const xe=d.oxw();d.xp6(2),d.lnq(" Total Distance ",d.xi3(3,3,xe.selectedJourneyRoute.TotalDistanceKM,"1.0-2")," km, ",xe.formatDuration(xe.selectedJourneyRoute.TotalDurationMinutes),", ",d.xi3(4,6,xe.selectedJourneyRoute.TotalEnergykWh,"1.0-2")," kWh ")}}function nt(ae,mt){if(1&ae){const xe=d.EpF();d.TgZ(0,"div")(1,"ion-list")(2,"ion-list-header"),d._UZ(3,"ion-icon",20),d._uU(4," Route Settings "),d.qZA(),d.TgZ(5,"ion-item")(6,"ion-label",21),d._uU(7),d.qZA(),d.TgZ(8,"ion-range",22),d.NdJ("ngModelChange",function(Se){d.CHM(xe);const ye=d.oxw();return d.KtG(ye.routeSearchDistance=Se)}),d._UZ(9,"ion-icon",23)(10,"ion-icon",24),d.qZA()(),d.TgZ(11,"ion-item")(12,"ion-label",21),d._uU(13,"Energy Efficiency (kWh Per km)"),d.qZA(),d.TgZ(14,"ion-input",25),d.NdJ("ngModelChange",function(Se){d.CHM(xe);const ye=d.oxw();return d.KtG(ye.kWhPerKM=Se)}),d.qZA()()()()}if(2&ae){const xe=d.oxw();d.xp6(7),d.hij("Search Distance (",xe.routeSearchDistance,")"),d.xp6(1),d.Q6J("ngModel",xe.routeSearchDistance),d.xp6(6),d.Q6J("ngModel",xe.kWhPerKM)}}let Xe=(()=>{class ae{constructor(xe,Ze,Se,ye,Qt,dt){(0,v.Z)(this,"mapping",void 0),(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"directions",void 0),(0,v.Z)(this,"journeyManager",void 0),(0,v.Z)(this,"changeDetector",void 0),(0,v.Z)(this,"numberPipe",void 0),(0,v.Z)(this,"routeSearchDistance",5),(0,v.Z)(this,"journeyRoutes",void 0),(0,v.Z)(this,"selectedJourneyRoute",void 0),(0,v.Z)(this,"routePolyline",void 0),(0,v.Z)(this,"kWhPerKM",void 0),(0,v.Z)(this,"routeStartPlace",void 0),(0,v.Z)(this,"routeDestinationPlace",void 0),(0,v.Z)(this,"routeCalcInProgress",!1),(0,v.Z)(this,"advancedSettingsMode",!1),(0,v.Z)(this,"routeStart",""),(0,v.Z)(this,"routeDestination",""),this.mapping=xe,this.logging=Ze,this.directions=Se,this.journeyManager=ye,this.changeDetector=Qt,this.numberPipe=dt,this.kWhPerKM=.212}get isRouteSet(){return null!=this.routeStartPlace&&null!=this.routeDestinationPlace}showSettings(){this.advancedSettingsMode=!0}hideSettings(){this.advancedSettingsMode=!1}routeStartSelected(xe){this.routeStartPlace=xe,this.calculateRoute(),this.changeDetector.detectChanges()}routeDestinationSelected(xe){this.routeDestinationPlace=xe,this.calculateRoute(),this.changeDetector.detectChanges()}clearRouteStart(){this.routeStartPlace=null,this.changeDetector.detectChanges()}clearRouteDestination(){this.routeDestinationPlace=null,this.changeDetector.detectChanges()}clearRoute(){this.routeStartPlace=null,this.routeDestinationPlace=null,this.journeyManager.setRoutePolyline(null),this.mapping.clearPolyline()}formatDuration(xe){if(xe<=60)return this.numberPipe.transform(xe,"1.0-2")+" mins";{const Ze=Math.round(xe/60),Se=Math.floor(xe-60*Ze);return Ze+" hours "+(Se>0?Se+" mins":"")}}calculateRoute(){null!=this.routeStartPlace&&null!=this.routeDestinationPlace&&(this.logging.log("Fetching route directions.."),this.routeCalcInProgress=!0,this.directions.getDirections(this.routeStartPlace.Location.latitude+","+this.routeStartPlace.Location.longitude,this.routeDestinationPlace.Location.latitude+","+this.routeDestinationPlace.Location.longitude).then(xe=>{if(null!=xe.routes&&xe.routes.length>0){this.logging.log("Got route directions, analysing.."),this.routePolyline=xe.routes[0].overview_polyline;const Ze=xe.routes[0].bounds.getSouthWest(),Se=xe.routes[0].bounds.getNorthEast(),ye=new s.wC(Se.lat(),Se.lng()),Qt=new s.wC(Ze.lat(),Ze.lng()),dt=new s.LL(ye,Qt);this.journeyRoutes=this.directions.analyseRoutes(xe,this.kWhPerKM),this.journeyRoutes.length>0&&(this.selectedJourneyRoute=this.journeyRoutes[0]),this.journeyManager.setRoutePolyline(this.routePolyline),this.mapping.renderPolyline(this.routePolyline),this.mapping.moveToMapBounds(dt)}else this.logging.log("No route returned..");this.routeCalcInProgress=!1}))}}return(0,v.Z)(ae,"\u0275fac",function(xe){return new(xe||ae)(d.Y36(Ae.v),d.Y36(ie.z),d.Y36(fe),d.Y36(Q.i),d.Y36(d.sBO),d.Y36(De.JJ))}),(0,v.Z)(ae,"\u0275cmp",d.Xpm({type:ae,selectors:[["route-planner"]],decls:24,vars:10,consts:[[1,"route"],[1,"route-places"],["name","map","slot","start"],[4,"ngIf"],[3,"click",4,"ngIf"],["primary",""],["slot","secondary"],["slot","primary"],[3,"placeChanged"],["placeSearchRouteStart",""],["placeSearchRouteDestination",""],["class","ion-padding",4,"ngIf"],["name","ionic","item-left",""],["placeholder","Starting Point",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],[3,"click"],["name","pin","item-left",""],["placeholder","Destination",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],["name","close","slot","start"],["name","cog","slot","end"],[1,"ion-padding"],["name","cog"],["position","stacked"],["min","1","max","200","step","5","snaps","true","pin","true","light","",3,"ngModel","ngModelChange"],["slot","start","small","","name","map"],["slot","end","large","","name","map"],["type","number","min","0.1","max","1",3,"ngModel","ngModelChange"]],template:function(xe,Ze){1&xe&&(d.TgZ(0,"div",0)(1,"div",1)(2,"ion-list")(3,"ion-list-header"),d._UZ(4,"ion-icon",2),d.TgZ(5,"ion-label"),d._uU(6,"Plan Your Journey"),d.qZA()(),d.YNc(7,Te,3,2,"ion-item",3),d.YNc(8,ge,4,1,"ion-item",4),d.YNc(9,we,3,2,"ion-item",3),d.YNc(10,Le,4,1,"ion-item",4),d.qZA(),d.TgZ(11,"ion-toolbar",5)(12,"ion-buttons",6),d.YNc(13,Me,3,0,"ion-button",4),d.qZA(),d.TgZ(14,"ion-buttons",7),d.YNc(15,ze,3,0,"ion-button",4),d.YNc(16,Ke,3,0,"ion-button",4),d.qZA()()(),d.TgZ(17,"place-search",8,9),d.NdJ("placeChanged",function(ye){return Ze.routeStartSelected(ye)}),d.qZA(),d.TgZ(19,"place-search",8,10),d.NdJ("placeChanged",function(ye){return Ze.routeDestinationSelected(ye)}),d.qZA(),d.YNc(21,Oe,3,0,"p",11),d.YNc(22,Ce,5,9,"ion-list",3),d.YNc(23,nt,15,3,"div",3),d.qZA()),2&xe&&(d.xp6(7),d.Q6J("ngIf",null==Ze.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null!=Ze.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null==Ze.routeDestinationPlace),d.xp6(1),d.Q6J("ngIf",null!=Ze.routeDestinationPlace),d.xp6(3),d.Q6J("ngIf",Ze.isRouteSet),d.xp6(2),d.Q6J("ngIf",!Ze.advancedSettingsMode),d.xp6(1),d.Q6J("ngIf",Ze.advancedSettingsMode),d.xp6(5),d.Q6J("ngIf",Ze.routeCalcInProgress),d.xp6(1),d.Q6J("ngIf",null!=Ze.selectedJourneyRoute),d.xp6(1),d.Q6J("ngIf",Ze.advancedSettingsMode))},dependencies:[De.O5,y.YG,y.Sm,y.gu,y.pK,y.Ie,y.Q$,y.q_,y.yh,y.I_,y.VI,y.PQ,y.sr,y.as,y.QI,y.j9,X.JJ,X.On,se.v,De.JJ],encapsulation:2})),ae})(),Ee=(()=>{class ae{constructor(xe){(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"hasNavbar",!1),this.modalController=xe}close(){this.modalController.dismiss()}}return(0,v.Z)(ae,"\u0275fac",function(xe){return new(xe||ae)(d.Y36(y.IN))}),(0,v.Z)(ae,"\u0275cmp",d.Xpm({type:ae,selectors:[["ng-component"]],decls:10,vars:0,consts:[["slot","end"],[3,"click"],["name","close","slot","end"],[1,"route-planner","ion-padding"]],template:function(xe,Ze){1&xe&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d._uU(3," Route Planner "),d.qZA(),d.TgZ(4,"ion-buttons",0)(5,"ion-button",1),d.NdJ("click",function(){return Ze.close()}),d._UZ(6,"ion-icon",2),d._uU(7," Close "),d.qZA()()()(),d.TgZ(8,"ion-content",3),d._UZ(9,"route-planner"),d.qZA())},dependencies:[y.YG,y.Sm,y.W2,y.Gu,y.gu,y.wd,y.sr,Xe],encapsulation:2})),ae})()},4606:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{SearchPageModule:()=>sn});var v=R(1180),d=R(5086),y=R(3999),s=R(6814),Q=R(6223),ie=R(7852),W=R(2125),w=R(5861),fe=R(553),Ae=R(7777),De=R(4119),X=R(3247),se=R(9723),Te=R(3052),ge=R(4677),we=R(866),Le=R(9127),Me=R(989),ze=R(1847),Ke=R(4669),Oe=R(1618),Ce=R(5460),nt=R(2438),Xe=R(7394);class Ee extends Xe.w0{constructor(It,at){super()}schedule(It,at=0){return this}}const ae={setInterval(Vt,It,...at){const{delegate:Wt}=ae;return Wt?.setInterval?Wt.setInterval(Vt,It,...at):setInterval(Vt,It,...at)},clearInterval(Vt){const{delegate:It}=ae;return(It?.clearInterval||clearInterval)(Vt)},delegate:void 0};var mt=R(9039),Ze=R(4552);class Se{constructor(It,at=Se.now){this.schedulerActionCtor=It,this.now=at}schedule(It,at=0,Wt){return new this.schedulerActionCtor(this,It).schedule(Wt,at)}}Se.now=Ze.l.now;const Qt=new class ye extends Se{constructor(It,at=Se.now){super(It,at),this.actions=[],this._active=!1}flush(It){const{actions:at}=this;if(this._active)return void at.push(It);let Wt;this._active=!0;do{if(Wt=It.execute(It.state,It.delay))break}while(It=at.shift());if(this._active=!1,Wt){for(;It=at.shift();)It.unsubscribe();throw Wt}}}(class xe extends Ee{constructor(It,at){super(It,at),this.scheduler=It,this.work=at,this.pending=!1}schedule(It,at=0){var Wt;if(this.closed)return this;this.state=It;const dn=this.id,Sn=this.scheduler;return null!=dn&&(this.id=this.recycleAsyncId(Sn,dn,at)),this.pending=!0,this.delay=at,this.id=null!==(Wt=this.id)&&void 0!==Wt?Wt:this.requestAsyncId(Sn,this.id,at),this}requestAsyncId(It,at,Wt=0){return ae.setInterval(It.flush.bind(It,this),Wt)}recycleAsyncId(It,at,Wt=0){if(null!=Wt&&this.delay===Wt&&!1===this.pending)return at;null!=at&&ae.clearInterval(at)}execute(It,at){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Wt=this._execute(It,at);if(Wt)return Wt;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(It,at){let dn,Wt=!1;try{this.work(It)}catch(Sn){Wt=!0,dn=Sn||new Error("Scheduled action threw falsy error")}if(Wt)return this.unsubscribe(),dn}unsubscribe(){if(!this.closed){const{id:It,scheduler:at}=this,{actions:Wt}=at;this.work=this.state=this.scheduler=null,this.pending=!1,(0,mt.P)(Wt,this),null!=It&&(this.id=this.recycleAsyncId(at,It,null)),this.delay=null,super.unsubscribe()}}});var gt=R(9360),ct=R(8251);const je=(0,R(2726).fo)("Geolocation",{web:()=>R.e(579).then(R.bind(R,579)).then(Vt=>new Vt.GeolocationWeb)});var _t=R(2029),Ne=R(5957);function Ft(Vt,It){1&Vt&&_t._UZ(0,"ion-icon",13)}function Gt(Vt,It){1&Vt&&_t._UZ(0,"ion-spinner")}function wn(Vt,It){if(1&Vt){const at=_t.EpF();_t.TgZ(0,"ion-button",3),_t.NdJ("click",function(){_t.CHM(at);const dn=_t.oxw();return _t.KtG(dn.openSideView())}),_t._UZ(1,"ion-icon",14),_t.qZA()}}function Xt(Vt,It){1&Vt&&(_t.ynx(0),_t.TgZ(1,"div",15)(2,"p"),_t._uU(3,"There was a problem communicating with Open Charge Map. Please check your data connection."),_t.qZA()(),_t.BQk())}let mn=(()=>{class Vt{constructor(at,Wt,dn,Sn,Nt,yi,Gi,gn,si,Je,At,Zt){(0,v.Z)(this,"appManager",void 0),(0,v.Z)(this,"nav",void 0),(0,v.Z)(this,"events",void 0),(0,v.Z)(this,"translate",void 0),(0,v.Z)(this,"platform",void 0),(0,v.Z)(this,"poiManager",void 0),(0,v.Z)(this,"mapping",void 0),(0,v.Z)(this,"journeyManager",void 0),(0,v.Z)(this,"zone",void 0),(0,v.Z)(this,"modalController",void 0),(0,v.Z)(this,"alertController",void 0),(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"mapDisplayed",!1),(0,v.Z)(this,"debouncedRefreshMapResults",void 0),(0,v.Z)(this,"mapCanvasID",void 0),(0,v.Z)(this,"initialResultsShown",!1),(0,v.Z)(this,"searchOnDemand",!1),(0,v.Z)(this,"poiViewMode","modal"),(0,v.Z)(this,"sideViewAvailable",!1),(0,v.Z)(this,"searchPolyline",void 0),(0,v.Z)(this,"routePlanningMode",!0),(0,v.Z)(this,"searchKeyword",""),(0,v.Z)(this,"selectedPOI",void 0),(0,v.Z)(this,"appConfig",new Ae.X),(0,v.Z)(this,"defaultMapZoom",15),(0,v.Z)(this,"defaultStartPos",new Te.wC(37.415328,-122.076575)),(0,v.Z)(this,"placeSearchMapPOI",void 0),(0,v.Z)(this,"_watchId",null),this.appManager=at,this.nav=Wt,this.events=dn,this.translate=Sn,this.platform=Nt,this.poiManager=yi,this.mapping=Gi,this.journeyManager=gn,this.zone=si,this.modalController=Je,this.alertController=At,this.logging=Zt,this.mapCanvasID="map-canvas",this.mapping.setMapType(at.searchSettings.MapType),this.mapping.setMapAPI(fe.N.defaultMapProvider),(0,nt.R)(window,"resize").pipe(function Ue(Vt,It=Qt){return(0,gt.e)((at,Wt)=>{let dn=null,Sn=null,Nt=null;const yi=()=>{if(dn){dn.unsubscribe(),dn=null;const gn=Sn;Sn=null,Wt.next(gn)}};function Gi(){const gn=Nt+Vt,si=It.now();if(si<gn)return dn=this.schedule(void 0,gn-si),void Wt.add(dn);yi()}at.subscribe((0,ct.x)(Wt,gn=>{Sn=gn,Nt=It.now(),dn||(dn=It.schedule(Gi,Vt),Wt.add(dn))},()=>{yi(),Wt.complete()},void 0,()=>{Sn=dn=null}))})}(500)).subscribe(hn=>{let gi={width:we.c.getClientHeight(),height:we.c.getClientWidth()};this.events.publish("ocm:window:resized",[gi])})}ionViewDidEnter(){this.logging.log("Entered search page.",Le.i.VERBOSE),this.mapping.focusMap(),this.mapping.updateMapSize()}ionViewWillLeave(){this.logging.log("Leaving search page.",Le.i.VERBOSE),this.mapping.unfocusMap()}getPreferredMapHeight(at){return null==at&&(at=we.c.getClientHeight()),at-56}enforceMapHeight(at){this.logging.log("Would resize map:"+at.width+" "+at.height,Le.i.VERBOSE);const Wt=this.getPreferredMapHeight(at[0]);document.getElementById(this.mapCanvasID).offsetHeight!==Wt&&(document.getElementById(this.mapCanvasID).style.height=Wt+"px"),this.mapping&&(this.logging.log("Map height:"+Wt,Le.i.VERBOSE),this.mapping.updateMapSize())}initialiseMapping(){var at=this;return(0,w.Z)(function*(){yield at.platform.ready(),at.debouncedRefreshMapResults=we.c.debounce(at.refreshMapResults,1e3,!1),at.events.subscribe("ocm:mapping:ready",(0,w.Z)(function*(){if(at.logging.log("init map: mapping ready"),at.mapping&&at.mapping.updateMapSize(),!at.initialResultsShown)if(at.appManager.searchSettings.StartSearchPosition&&!at.appManager.searchSettings.StartViewPoiId)at.searchOnDemand=!0,at.mapping.updateMapCentrePos(at.appManager.searchSettings.StartSearchPosition.latitude,at.appManager.searchSettings.StartSearchPosition.longitude,!0,at.defaultMapZoom);else{let Wt=localStorage.getItem("_locationEnabled");1==at.appManager.isEmbeddedMode&&"true"!=Wt?yield(yield at.alertController.create({header:"Search using your location?",message:"Select OK to continue.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:(Sn=(0,w.Z)(function*(Nt){yield at.useFallbackPosition()}),function(yi){return Sn.apply(this,arguments)})},{text:"OK",handler:function(){var Sn=(0,w.Z)(function*(){yield at.locateUser()});return function(){return Sn.apply(this,arguments)}}()}]})).present():(yield at.locateUser(),at.mapping&&at.mapping.updateMapSize())}var Sn})),at.events.subscribe("ocm:mapping:zoom",()=>{at.debouncedRefreshMapResults()}),at.events.subscribe("ocm:mapping:dragend",()=>{at.debouncedRefreshMapResults()}),at.events.subscribe("ocm:poiList:updated",Wt=>{at.showPOIListOnMap(Wt)}),at.events.subscribe("ocm:poiList:cleared",()=>{at.mapping.clearMarkers(),setTimeout(()=>{at.debouncedRefreshMapResults()},500)}),at.events.subscribe("ocm:window:resized",Wt=>{null!=Wt&&Wt.length>0&&at.enforceMapHeight(Wt[0])}),at.events.subscribe("ocm:poi:selected",Wt=>{if(Wt.poi)at.viewPOIDetails(Wt,Wt.poi);else{let dn=at.getPOIByID(Wt.poiId);at.viewPOIDetails(Wt,dn)}}),at.mapping.initMap(at.mapCanvasID)})()}ngAfterViewInit(){var at=this;return(0,w.Z)(function*(){yield at.initialiseMapping()})()}ngOnInit(){var at=this;return(0,w.Z)(function*(){at.logging.log("Refreshing reference data ..",Le.i.VERBOSE),(yield at.appManager.referenceDataManager.refreshReferenceData(at.appManager.api))||(at.appManager.isOffline=!0)})()}showPOIListOnMap(at){const Wt=this.getPreferredMapHeight(null);this.mapping.refreshMapView(Wt,this.poiManager.poiList,null),this.mapDisplayed||(this.mapDisplayed=!0)}getIconForPOI(at){return we.c.getIconForPOI(at)}getPOIByID(at){const Wt=this.poiManager.poiList;for(let dn=0;dn<Wt.length;dn++)if(Wt[dn].ID===at)return Wt[dn];return null}refreshMapResults(){var at=this;return(0,w.Z)(function*(){if(!at.searchOnDemand)return void at.logging.log("Skipping refresh, search on demand disabled..",Le.i.VERBOSE);at.logging.log("Refreshing Results..",Le.i.VERBOSE);const Wt=new ge.b;let dn=null;if(at.appManager.searchSettings.StartViewPoiId){let Nt=at.appManager.searchSettings.StartViewPoiId;at.appManager.searchSettings.StartViewPoiId=null;let yi=yield at.poiManager.getPOIById(Nt);yi&&(at.events.publish("ocm:poi:selected",{poiId:yi.ID,poi:yi}),at.mapping.updateMapCentrePos(yi.AddressInfo.Latitude,yi.AddressInfo.Longitude,!0,at.defaultMapZoom))}if(at.appManager.searchSettings.StartSearchPosition&&(dn=new Te.jR(at.appManager.searchSettings.StartSearchPosition.latitude,at.appManager.searchSettings.StartSearchPosition.longitude),at.appManager.searchSettings.StartSearchPosition=null),dn&&0==dn.coords.latitude&&0==dn.coords.longitude)return void at.logging.log("Map center is zero. No query will be performed",Le.i.WARNING);if(null!=dn)Wt.latitude=dn.coords.latitude,Wt.longitude=dn.coords.longitude,Wt.distance=25,Wt.boundingbox=null,at.appManager.searchSettings.LastSearchPosition=new Te.wC(dn.coords.latitude,dn.coords.longitude);else{Wt.latitude=null,Wt.longitude=null;let Nt=yield at.mapping.getMapBounds().toPromise();Wt.boundingbox="("+Nt[0].latitude+","+Nt[0].longitude+"),("+Nt[1].latitude+","+Nt[1].longitude+")",at.logging.log(JSON.stringify(Nt),Le.i.VERBOSE)}Wt.includeComments=!0,Wt.enableCaching=!0,null!=at.appManager.searchSettings&&(null!=at.appManager.searchSettings.ConnectionTypeList&&(Wt.connectionTypeIdList=at.appManager.searchSettings.ConnectionTypeList),null!=at.appManager.searchSettings.UsageTypeList&&(Wt.usageTypeIdList=at.appManager.searchSettings.UsageTypeList),null!=at.appManager.searchSettings.StatusTypeList&&(Wt.statusTypeIdList=at.appManager.searchSettings.StatusTypeList),null!=at.appManager.searchSettings.OperatorList&&(Wt.operatorIdList=at.appManager.searchSettings.OperatorList),null!=at.appManager.searchSettings.MinPowerKW&&at.appManager.searchSettings.MinPowerKW>0&&(Wt.minPowerKW=at.appManager.searchSettings.MinPowerKW),null!=at.appManager.searchSettings.MaxPowerKW&&at.appManager.searchSettings.MaxPowerKW>0&&(Wt.maxPowerKW=at.appManager.searchSettings.MaxPowerKW),null!=at.appManager.searchSettings.MaxResults&&at.appManager.searchSettings.MaxResults>0&&at.appManager.searchSettings.MaxResults<=1e4&&(Wt.maxResults=at.appManager.searchSettings.MaxResults),null!=at.journeyManager.getRoutePolyline()&&(Wt.polyline=at.journeyManager.getRoutePolyline(),Wt.boundingbox=null,Wt.levelOfDetail=null,Wt.latitude=null,Wt.longitude=null)),at.appManager.isRequestInProgress=!0;let Sn=yield at.poiManager.refreshPOIList(Wt);at.appManager.isRequestInProgress=!1,at.initialResultsShown=!0,Sn>=Wt.maxResults&&at.appManager.showToastNotification("A maximum of "+Sn+" results are returned per search. Zoom in for details.")})()}viewPOIDetails(at,Wt){this.logging.log("Viewing/fetching ["+this.poiViewMode+"] POI Details "+at.poiId),null!=Wt?(this.mapping.unfocusMap(),this.modalController.create({component:se.H,componentProps:{item:Wt}}).then(dn=>{dn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),dn.present()})):this.poiManager.getPOIById(at.poiId,!0).then(dn=>{this.logging.log("Got POI Details "+dn.ID),"modal"===this.poiViewMode&&(this.searchOnDemand=!1,this.modalController.create({component:se.H,componentProps:{item:dn}}).then(Sn=>{Sn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),Sn.present()}),this.mapping.unfocusMap()),"side"===this.poiViewMode&&(this.selectedPOI=dn)},dn=>{this.appManager.showToastNotification("POI Details not available")})}closePOIDetails(){this.selectedPOI=null}openRoutePlannerModal(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:X.u}).then(at=>{at.onDidDismiss().then(Wt=>{this.logging.log("Dismissing Route Planner Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),at.present()})}openSearchOptions(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:De.N}).then(at=>{at.onDidDismiss().then(Wt=>{this.mapping.focusMap(),this.searchOnDemand=!0}),at.present()})}openSideView(){this.poiViewMode="side",this.mapping.updateMapSize()}closeSideView(){this.poiViewMode="modal",this.mapping.updateMapSize()}planRoute(){this.routePlanningMode=!0}search(at){this.placeSearchMapPOI.getPlacesAutoComplete(at,"poiSearch")}useFallbackPosition(){let at=this.defaultStartPos;null!=this.appManager.searchSettings.LastSearchPosition&&(at=this.appManager.searchSettings.LastSearchPosition),this.appManager.searchSettings.StartSearchPosition=at,this.appManager.searchSettings.LastSearchPosition=null,this.searchOnDemand=!0,this.mapping.updateMapCentrePos(at.latitude,at.longitude,!0,this.defaultMapZoom)}getPosition(at={}){var Wt=this;return(0,w.Z)(function*(){return new Promise((dn,Sn)=>{Wt._watchId=je.watchPosition(at,(Nt,yi)=>{Wt._watchId&&je.clearWatch({id:Wt._watchId}),yi?Sn(yi):dn(Nt)})})})()}locateUser(){var at=this;return(0,w.Z)(function*(){at.useFallbackPosition();try{at.logging.log("Attempting to locate user..");const Wt=yield at.getPosition({timeout:1e4});if(!Wt)throw"Failed to get user location.";return at.logging.log("Got user location."),at.appManager.searchSettings.StartSearchPosition=new Te.wC(Wt.coords.latitude,Wt.coords.longitude),at.searchOnDemand=!0,at.mapping.updateMapCentrePos(Wt.coords.latitude,Wt.coords.longitude,!0,at.defaultMapZoom),localStorage.setItem("_locationEnabled","true"),!0}catch(Wt){return at.logging.log("Failed to get user location. Searching using default or last position."+Wt),at.appManager.showToastNotification("Your location could not be determined."),at.useFallbackPosition(),!1}})()}placeSelected(at){this.searchKeyword=at.Address,this.logging.log("Got place details:"+at.Address),this.mapping.focusMap(),this.mapping.updateMapCentrePos(at.Location.latitude,at.Location.longitude,!0),this.debouncedRefreshMapResults()}}return(0,v.Z)(Vt,"\u0275fac",function(at){return new(at||Vt)(_t.Y36(Oe.c),_t.Y36(ie.SH),_t.Y36(Ne.z),_t.Y36(y.sK),_t.Y36(ie.t4),_t.Y36(Ke.R),_t.Y36(ze.v),_t.Y36(Me.i),_t.Y36(_t.R0b),_t.Y36(ie.IN),_t.Y36(ie.Br),_t.Y36(Le.z))}),(0,v.Z)(Vt,"\u0275cmp",_t.Xpm({type:Vt,selectors:[["ng-component"]],viewQuery:function(at,Wt){if(1&at&&_t.Gf(Ce.v,7),2&at){let dn;_t.iGM(dn=_t.CRH())&&(Wt.placeSearchMapPOI=dn.first)}},decls:18,vars:10,consts:[["slot","start"],["autocapitalize","on","autocomplete","on",3,"ngModel","placeholder","debounce","ngModelChange","ionInput"],["slot","end"],[3,"click"],["name","locate","slot","start",4,"ngIf"],[4,"ngIf"],[3,"color","click"],["name","options","slot","end"],[3,"click",4,"ngIf"],[1,"search-page"],[3,"placeChanged"],["placeSearchMapPOI",""],["id","map-canvas",2,"height","100%","width","100%","min-height","300px"],["name","locate","slot","start"],["name","car","title","Route","slot","end"],[2,"position","absolute"]],template:function(at,Wt){1&at&&(_t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),_t._UZ(3,"ion-menu-button"),_t.qZA(),_t.TgZ(4,"ion-searchbar",1),_t.NdJ("ngModelChange",function(Sn){return Wt.searchKeyword=Sn})("ionInput",function(Sn){return Wt.search(Sn)}),_t.ALo(5,"translate"),_t.qZA(),_t.TgZ(6,"ion-buttons",2)(7,"ion-button",3),_t.NdJ("click",function(){return Wt.locateUser()}),_t.YNc(8,Ft,1,0,"ion-icon",4),_t.YNc(9,Gt,1,0,"ion-spinner",5),_t.qZA(),_t.TgZ(10,"ion-button",6),_t.NdJ("click",function(){return Wt.openSearchOptions()}),_t._UZ(11,"ion-icon",7),_t.qZA(),_t.YNc(12,wn,2,0,"ion-button",8),_t.qZA()()(),_t.TgZ(13,"ion-content",9)(14,"place-search",10,11),_t.NdJ("placeChanged",function(Sn){return Wt.placeSelected(Sn)}),_t.qZA(),_t.YNc(16,Xt,4,0,"ng-container",5),_t._UZ(17,"div",12),_t.qZA()),2&at&&(_t.xp6(4),_t.Q6J("ngModel",Wt.searchKeyword)("placeholder",_t.lcZ(5,8,"ocm.search.performSearch"))("debounce",500),_t.xp6(4),_t.Q6J("ngIf",!Wt.appManager.isRequestInProgress),_t.xp6(1),_t.Q6J("ngIf",Wt.appManager.isRequestInProgress),_t.xp6(1),_t.Q6J("color",Wt.appManager.searchSettings.HasActiveFilters?"danger":"default"),_t.xp6(2),_t.Q6J("ngIf",1==Wt.sideViewAvailable&&"modal"==Wt.poiViewMode),_t.xp6(4),_t.Q6J("ngIf",Wt.appManager.isOffline))},dependencies:[s.O5,Q.JJ,Q.On,ie.YG,ie.Sm,ie.W2,ie.Gu,ie.gu,ie.fG,ie.VI,ie.PQ,ie.sr,ie.j9,Ce.v,y.X$],styles:[".search-page[_ngcontent-%COMP%]   #map-canvas[_ngcontent-%COMP%]{width:100%;height:98%}.search-page[_ngcontent-%COMP%]   #place-search[_ngcontent-%COMP%]{min-height:300px;background-color:#f0f0f0;position:absolute;z-index:100;width:100%}.search-page[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{flex:.4}.search-page[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0}.search-page[_ngcontent-%COMP%]   scroll-content[_ngcontent-%COMP%]{overflow-y:hidden}.search-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{padding-left:2em}.search-page[_ngcontent-%COMP%]   .sideview[_ngcontent-%COMP%]{background:rgb(238,238,238);background:linear-gradient(to bottom,rgb(238,238,238) 0%,rgb(255,255,255) 100%)}"]})),Vt})(),sn=(()=>{class Vt{}return(0,v.Z)(Vt,"\u0275fac",function(at){return new(at||Vt)}),(0,v.Z)(Vt,"\u0275mod",_t.oAB({type:Vt})),(0,v.Z)(Vt,"\u0275inj",_t.cJS({imports:[s.ez,Q.u5,ie.Pc,y.aw,d.e,W.Bz.forChild([{path:"",component:mn}])]})),Vt})()},4119:(zn,Ct,R)=>{"use strict";R.d(Ct,{N:()=>nt});var v=R(5861),d=R(1180),y=R(4669),s=R(1618),Q=R(4783),ie=R(866),W=R(1847),w=R(2029),fe=R(7852),Ae=R(5957),De=R(6814),X=R(6223),se=R(6086),Te=R(3999);let ge=(()=>{class Xe extends Te.X${constructor(ae,mt){super(ae,mt)}transform(ae,...mt){let xe=super.transform(ae,...mt);return xe==ae?null!=mt&&mt[0].default?mt[0].default:mt[0].Title?mt[0].Title:xe:xe}}return(0,d.Z)(Xe,"\u0275fac",function(ae){return new(ae||Xe)(w.Y36(Te.sK,16),w.Y36(w.sBO,16))}),(0,d.Z)(Xe,"\u0275pipe",w.Yjl({name:"nullableTranslate",type:Xe,pure:!0})),(0,d.Z)(Xe,"\u0275prov",w.Yz7({token:Xe,factory:Xe.\u0275fac})),Xe})();function we(Xe,Ee){if(1&Xe){const ae=w.EpF();w.TgZ(0,"p",23),w._UZ(1,"ion-icon",24),w._uU(2," One or more filters are currently being applied. "),w.TgZ(3,"ion-button",25),w.NdJ("click",function(){w.CHM(ae);const xe=w.oxw();return w.KtG(xe.clearFilters())}),w._UZ(4,"ion-icon",26),w.TgZ(5,"ion-label"),w._uU(6,"Clear"),w.qZA()()()}}function Le(Xe,Ee){if(1&Xe&&(w.TgZ(0,"ion-select-option",28),w._uU(1),w.qZA()),2&Xe){const ae=Ee.$implicit;w.Q6J("value",ae.ID),w.xp6(1),w.Oqu(ae.Title)}}function Me(Xe,Ee){if(1&Xe){const ae=w.EpF();w.TgZ(0,"ion-item")(1,"ion-select",15),w.NdJ("ngModelChange",function(xe){w.CHM(ae);const Ze=w.oxw();return w.KtG(Ze.searchSettings.FilterOptionsByCountryId=xe)})("ionChange",function(){w.CHM(ae);const xe=w.oxw();return w.KtG(xe.onCountryChange())}),w.ALo(2,"translate"),w.TgZ(3,"ion-select",27),w._uU(4,"(All Countries)"),w.qZA(),w.YNc(5,Le,2,2,"ion-select-option",6),w.qZA()()}if(2&Xe){const ae=w.oxw();w.xp6(1),w.Q6J("label",w.lcZ(2,3,"ocm.search.countries"))("ngModel",ae.searchSettings.FilterOptionsByCountryId),w.xp6(4),w.Q6J("ngForOf",ae.countries)}}function ze(Xe,Ee){if(1&Xe&&(w.TgZ(0,"ion-select-option",28),w._uU(1),w.ALo(2,"nullableTranslate"),w.qZA()),2&Xe){const ae=Ee.$implicit;w.Q6J("value",ae.ID),w.xp6(1),w.Oqu(w.xi3(2,2,"ocm.reference.usageType.value_"+ae.ID,ae))}}function Ke(Xe,Ee){if(1&Xe&&(w.TgZ(0,"ion-select-option",28),w._uU(1),w.ALo(2,"nullableTranslate"),w.qZA()),2&Xe){const ae=Ee.$implicit;w.Q6J("value",ae.ID),w.xp6(1),w.Oqu(w.xi3(2,2,"ocm.reference.statusType.value_"+ae.ID,ae))}}function Oe(Xe,Ee){if(1&Xe&&(w.TgZ(0,"ion-select-option",28),w._uU(1),w.ALo(2,"nullableTranslate"),w.qZA()),2&Xe){const ae=Ee.$implicit;w.Q6J("value",ae.ID),w.xp6(1),w.Oqu(w.xi3(2,2,"ocm.reference.connectionType.value_"+ae.ID,ae))}}function Ce(Xe,Ee){if(1&Xe&&(w.TgZ(0,"ion-select-option",28),w._uU(1),w.qZA()),2&Xe){const ae=Ee.$implicit;w.Q6J("value",ae.code),w.xp6(1),w.Oqu(ae.title)}}let nt=(()=>{class Xe{constructor(ae,mt,xe,Ze,Se){(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"poiManager",void 0),(0,d.Z)(this,"mapping",void 0),(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"searchSettings",void 0),(0,d.Z)(this,"maxPower",Q.U),(0,d.Z)(this,"powerRange",{lower:0,upper:this.maxPower}),(0,d.Z)(this,"_languages",[]),this.appManager=ae,this.poiManager=mt,this.mapping=xe,this.modalController=Ze,this.events=Se,this.searchSettings=ae.searchSettings}ngOnInit(){var ae=this;return(0,v.Z)(function*(){null!=ae.searchSettings.MinPowerKW&&(ae.powerRange.lower=ae.searchSettings.MinPowerKW),null!=ae.searchSettings.MaxPowerKW&&(ae.powerRange.upper=ae.searchSettings.MaxPowerKW),0==ae.powerRange.upper&&(ae.powerRange.upper=ae.maxPower),ae.appManager.analytics.viewEvent("Settings"),ae.useFilteredOptions&&(yield ae.onCountryChange())})()}get useFilteredOptions(){return this.searchSettings.FilterOptionsByCountryId>0}clearFilters(){this.searchSettings.ClearActiveFilters(),this.powerRange={lower:0,upper:this.maxPower},this.searchSettings.CheckForActiveFilters()}get operators(){return this.appManager.referenceDataManager.getNetworkOperators(this.useFilteredOptions)}get connectionTypes(){return this.appManager.referenceDataManager.getConnectionTypes(this.useFilteredOptions)}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes(this.useFilteredOptions)}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes(this.useFilteredOptions)}get countries(){return this.appManager.referenceDataManager.getCountries(this.useFilteredOptions)}get isCountryFilterFeatureEnabled(){return ie.c.isFeatureEnabled("FILTER_OPTIONS_BY_COUNTRY")}get languages(){return this._languages.length>0||(this._languages=this.appManager.getLanguages()),this._languages}ionViewWillLeave(){null!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language),this.searchSettings.MinPowerKW=this.powerRange.lower,this.searchSettings.MaxPowerKW=this.powerRange.upper,1==this.searchSettings.MinPowerKW&&(this.searchSettings.MinPowerKW=null),this.searchSettings.MaxPowerKW==this.maxPower&&(this.searchSettings.MaxPowerKW=null),this.appManager.searchSettings=this.searchSettings,this.appManager.saveSearchSettings(),this.events.publish("ocm:poiList:cleared")}onLanguageChange(){null!=this.searchSettings.Language&&""!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language)}onCountryChange(){var ae=this;return(0,v.Z)(function*(){ae.appManager.referenceDataManager.refreshFilteredReferenceData(ae.appManager.api,{CountryIds:[ae.searchSettings.FilterOptionsByCountryId]})})()}onMapTypeChange(){var ae=this;return(0,v.Z)(function*(){ae.mapping.setMapType(ae.searchSettings.MapType)})()}onOperatorSelected(ae=null){var mt=this;return(0,v.Z)(function*(){null!=ae&&(mt.searchSettings.OperatorList.find(xe=>xe==ae.ID)||mt.searchSettings.OperatorList.push(ae.ID))})()}onOperatorRemoved(ae){var mt=this;return(0,v.Z)(function*(){mt.searchSettings.OperatorList=mt.searchSettings.OperatorList.filter(xe=>xe!=ae)})()}close(){this.modalController.dismiss()}}return(0,d.Z)(Xe,"\u0275fac",function(ae){return new(ae||Xe)(w.Y36(s.c),w.Y36(y.R),w.Y36(W.v),w.Y36(fe.IN),w.Y36(Ae.z))}),(0,d.Z)(Xe,"\u0275cmp",w.Xpm({type:Xe,selectors:[["ng-component"]],decls:67,vars:39,consts:[[1,"settings-page","ion-padding"],["danger","",4,"ngIf"],[4,"ngIf"],["lines","none"],["mode","multi",3,"operatorList","useFilteredOperators","operatorRemoved","operatorChanged"],["multiple","true","cancelText","Cancel","okText","OK",3,"label","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["dualKnobs","true","min","0","max","650","pin","true",3,"ngModel","ngModelChange"],["slot","start","size","small","name","flash"],["slot","end","name","flash"],["slot","start",2,"padding-top","0"],["type","number","min","0",2,"width","3em","border","none",3,"ngModel","max","ngModelChange"],["slot","end",2,"padding-top","0"],["type","number",2,"width","3em","border","none",3,"ngModel","max","min","ngModelChange"],["label","Language","multiple","false",3,"ngModel","ngModelChange","ionChange"],["multiple","false","cancelText","Cancel","okText","OK",3,"label","ngModel","ngModelChange","ionChange"],["value","ROADMAP"],["value","SATELLITE"],["label","Enable Advanced Editor Options",3,"ngModel","ngModelChange"],["label","Max Results","type","number","placeholder","500","min","100","max","10000",3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","close","slot","start"],["danger",""],["name","alert"],["size","small","color","light",3,"click"],["slot","start","name","close"],["value",""],[3,"value"]],template:function(ae,mt){1&ae&&(w.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),w._uU(3),w.ALo(4,"translate"),w.qZA()()(),w.TgZ(5,"ion-content",0)(6,"h2"),w._uU(7,"Search Filters"),w.qZA(),w.TgZ(8,"p"),w._uU(9,"Note: Filters will remove usable charging locations from your search results if we do not have complete data (i.e Operator or Power Levels)."),w.qZA(),w.YNc(10,we,7,0,"p",1),w.TgZ(11,"ion-list"),w.YNc(12,Me,6,5,"ion-item",2),w.TgZ(13,"ion-item",3)(14,"ion-label"),w._uU(15),w.ALo(16,"translate"),w.qZA()(),w.TgZ(17,"ion-item")(18,"app-operator-lookup",4),w.NdJ("operatorRemoved",function(Ze){return mt.onOperatorRemoved(Ze)})("operatorChanged",function(Ze){return mt.onOperatorSelected(Ze)}),w.qZA()(),w.TgZ(19,"ion-item")(20,"ion-select",5),w.NdJ("ngModelChange",function(Ze){return mt.searchSettings.UsageTypeList=Ze}),w.ALo(21,"translate"),w.YNc(22,ze,3,5,"ion-select-option",6),w.qZA()(),w.TgZ(23,"ion-item")(24,"ion-select",5),w.NdJ("ngModelChange",function(Ze){return mt.searchSettings.StatusTypeList=Ze}),w.ALo(25,"translate"),w.YNc(26,Ke,3,5,"ion-select-option",6),w.qZA()(),w.TgZ(27,"ion-item")(28,"ion-select",5),w.NdJ("ngModelChange",function(Ze){return mt.searchSettings.ConnectionTypeList=Ze}),w.ALo(29,"translate"),w.YNc(30,Oe,3,5,"ion-select-option",6),w.qZA()(),w.TgZ(31,"ion-item",3)(32,"ion-range",7),w.NdJ("ngModelChange",function(Ze){return mt.powerRange=Ze}),w.TgZ(33,"ion-icon",8),w._uU(34,"0"),w.qZA(),w._UZ(35,"ion-icon",9),w.qZA()(),w.TgZ(36,"ion-item",3)(37,"ion-note",10),w._uU(38,"Min. Power (kW)"),w._UZ(39,"br"),w.TgZ(40,"input",11),w.NdJ("ngModelChange",function(Ze){return mt.powerRange.lower=Ze}),w.qZA()(),w.TgZ(41,"ion-note",12),w._uU(42,"Max. Power (kW)"),w._UZ(43,"br"),w.TgZ(44,"input",13),w.NdJ("ngModelChange",function(Ze){return mt.powerRange.upper=Ze}),w.qZA()()()(),w.TgZ(45,"h2"),w._uU(46," General Settings "),w.qZA(),w.TgZ(47,"ion-item")(48,"ion-select",14),w.NdJ("ngModelChange",function(Ze){return mt.searchSettings.Language=Ze})("ionChange",function(){return mt.onLanguageChange()}),w.YNc(49,Ce,2,2,"ion-select-option",6),w.qZA()(),w.TgZ(50,"ion-item")(51,"ion-select",15),w.NdJ("ngModelChange",function(Ze){return mt.searchSettings.MapType=Ze})("ionChange",function(){return mt.onMapTypeChange()}),w.ALo(52,"translate"),w.TgZ(53,"ion-select-option",16),w._uU(54,"Road Map"),w.qZA(),w.TgZ(55,"ion-select-option",17),w._uU(56,"Satellite"),w.qZA()()(),w.TgZ(57,"ion-item")(58,"ion-toggle",18),w.NdJ("ngModelChange",function(Ze){return mt.searchSettings.EnableAdvancedEditorFeatures=Ze}),w.qZA()(),w.TgZ(59,"ion-item")(60,"ion-input",19),w.NdJ("ngModelChange",function(Ze){return mt.searchSettings.MaxResults=Ze}),w.qZA()()(),w.TgZ(61,"ion-footer")(62,"ion-toolbar")(63,"ion-buttons",20)(64,"ion-button",21),w.NdJ("click",function(){return mt.close()}),w._UZ(65,"ion-icon",22),w._uU(66," Close "),w.qZA()()()()),2&ae&&(w.xp6(3),w.hij(" ",w.lcZ(4,27,"ocm.general.settings")," "),w.xp6(7),w.Q6J("ngIf",1==mt.searchSettings.HasActiveFilters),w.xp6(2),w.Q6J("ngIf",mt.isCountryFilterFeatureEnabled),w.xp6(3),w.Oqu(w.lcZ(16,29,"ocm.search.networkOperators")),w.xp6(3),w.Q6J("operatorList",mt.searchSettings.OperatorList)("useFilteredOperators",!1),w.xp6(2),w.Q6J("label",w.lcZ(21,31,"ocm.search.usageTypes"))("ngModel",mt.searchSettings.UsageTypeList),w.xp6(2),w.Q6J("ngForOf",mt.usageTypes),w.xp6(2),w.Q6J("label",w.lcZ(25,33,"ocm.search.operationalStatusTypes"))("ngModel",mt.searchSettings.StatusTypeList),w.xp6(2),w.Q6J("ngForOf",mt.statusTypes),w.xp6(2),w.Q6J("label",w.lcZ(29,35,"ocm.search.connectionTypes"))("ngModel",mt.searchSettings.ConnectionTypeList),w.xp6(2),w.Q6J("ngForOf",mt.connectionTypes),w.xp6(2),w.Q6J("ngModel",mt.powerRange),w.xp6(8),w.Q6J("ngModel",mt.powerRange.lower)("max",mt.powerRange.upper),w.xp6(4),w.Q6J("ngModel",mt.powerRange.upper)("max",mt.maxPower)("min",mt.powerRange.lower),w.xp6(4),w.Q6J("ngModel",mt.searchSettings.Language),w.xp6(1),w.Q6J("ngForOf",mt.languages),w.xp6(2),w.Q6J("label",w.lcZ(52,37,"ocm.details.location.map"))("ngModel",mt.searchSettings.MapType),w.xp6(7),w.Q6J("ngModel",mt.searchSettings.EnableAdvancedEditorFeatures),w.xp6(2),w.Q6J("ngModel",mt.searchSettings.MaxResults))},dependencies:[De.sg,De.O5,X.Fj,X.wV,X.JJ,X.qQ,X.Fd,X.On,fe.YG,fe.Sm,fe.W2,fe.fr,fe.Gu,fe.gu,fe.pK,fe.Ie,fe.Q$,fe.q_,fe.uN,fe.I_,fe.t9,fe.n0,fe.wd,fe.ho,fe.sr,fe.w,fe.as,fe.QI,se.z,Te.X$,ge],encapsulation:2})),Xe})()},9472:(zn,Ct,R)=>{"use strict";R.r(Ct),R.d(Ct,{SignInModule:()=>Ae});var v=R(1180),d=R(8767),y=R(5086),s=R(3999),Q=R(6814),ie=R(6223),W=R(7852),w=R(2125),fe=R(2029);let Ae=(()=>{class De{}return(0,v.Z)(De,"\u0275fac",function(se){return new(se||De)}),(0,v.Z)(De,"\u0275mod",fe.oAB({type:De})),(0,v.Z)(De,"\u0275inj",fe.cJS({imports:[Q.ez,ie.u5,W.Pc,s.aw,y.e,w.Bz.forChild([{path:"",component:d.F}])]})),De})()},8767:(zn,Ct,R)=>{"use strict";R.d(Ct,{F:()=>De});var v=R(5861),d=R(1180),y=R(9127),s=R(1618),Q=R(2029),ie=R(7852),W=R(3999),w=R(2125),fe=R(6814),Ae=R(6223);let De=(()=>{class X{constructor(Te,ge,we,Le,Me,ze,Ke,Oe){(0,d.Z)(this,"appManager",void 0),(0,d.Z)(this,"modalController",void 0),(0,d.Z)(this,"translate",void 0),(0,d.Z)(this,"alertController",void 0),(0,d.Z)(this,"loadingController",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"router",void 0),(0,d.Z)(this,"location",void 0),(0,d.Z)(this,"email",void 0),(0,d.Z)(this,"password",void 0),this.appManager=Te,this.modalController=ge,this.translate=we,this.alertController=Le,this.loadingController=Me,this.logging=ze,this.router=Ke,this.location=Oe,this.email=""}cancelSignIn(){this.modalController.dismiss()}performSignIn(){var Te=this;return(0,v.Z)(function*(){const ge=yield Te.loadingController.create({message:"Signing In.."});yield ge.present();let we=!1;try{yield Te.appManager.api.performSignIn(Te.email,Te.password),ge.dismiss(),localStorage.setItem("authResponse",JSON.stringify(Te.appManager.api.authResponse)),Te.appManager.isUserAuthenticated(!0),Te.modalController.dismiss(),Te.appManager.analytics.appEvent("Profile","SignedIn")}catch(Le){we=!0,ge.dismiss(),yield(yield Te.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),Te.logging.log("Error logging in:"+Le)}})()}}return(0,d.Z)(X,"\u0275fac",function(Te){return new(Te||X)(Q.Y36(s.c),Q.Y36(ie.IN),Q.Y36(W.sK),Q.Y36(ie.Br),Q.Y36(ie.HT),Q.Y36(y.z),Q.Y36(w.F0),Q.Y36(fe.Ye))}),(0,d.Z)(X,"\u0275cmp",Q.Xpm({type:X,selectors:[["ng-component"]],decls:37,vars:8,consts:[[1,"signin-page","ion-padding"],["item-left",""],["src","assets/images/icons/branding/AppIcon_128x128.png"],[1,"ion-padding"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"],[3,"click"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["type","submit","color","primary",3,"click"],["name","log-in","slot","start"]],template:function(Te,ge){1&Te&&(Q.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),Q._uU(3),Q.ALo(4,"translate"),Q.qZA()()(),Q.TgZ(5,"ion-content",0)(6,"ion-avatar",1),Q._UZ(7,"img",2),Q.qZA(),Q.TgZ(8,"p",3),Q._uU(9," Sign in using your Open Charge Map account. "),Q.qZA(),Q.TgZ(10,"ion-list")(11,"ion-item")(12,"ion-label",4),Q._uU(13,"Email"),Q.qZA(),Q.TgZ(14,"ion-input",5),Q.NdJ("ngModelChange",function(Le){return ge.email=Le}),Q.qZA()(),Q.TgZ(15,"ion-item")(16,"ion-label",4),Q._uU(17,"Password"),Q.qZA(),Q.TgZ(18,"ion-input",6),Q.NdJ("ngModelChange",function(Le){return ge.password=Le}),Q.qZA()()(),Q.TgZ(19,"p"),Q._uU(20,"or "),Q.TgZ(21,"a",7),Q.NdJ("click",function(){return ge.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/register")}),Q._uU(22,"Register as New User"),Q.qZA(),Q._uU(23," or "),Q.TgZ(24,"a",7),Q.NdJ("click",function(){return ge.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/passwordreset")}),Q._uU(25,"Reset your password"),Q.qZA()()(),Q.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",8)(29,"ion-button",7),Q.NdJ("click",function(){return ge.cancelSignIn()}),Q._UZ(30,"ion-icon",9),Q._uU(31," Cancel"),Q.qZA()(),Q.TgZ(32,"ion-buttons",10)(33,"ion-button",11),Q.NdJ("click",function(){return ge.performSignIn()}),Q._UZ(34,"ion-icon",12),Q._uU(35),Q.ALo(36,"translate"),Q.qZA()()()()),2&Te&&(Q.xp6(3),Q.hij(" ",Q.lcZ(4,4,"ocm.general.signIn")," "),Q.xp6(11),Q.Q6J("ngModel",ge.email),Q.xp6(4),Q.Q6J("ngModel",ge.password),Q.xp6(17),Q.hij(" ",Q.lcZ(36,6,"ocm.general.signIn"),""))},dependencies:[Ae.JJ,Ae.On,ie.BJ,ie.YG,ie.Sm,ie.W2,ie.fr,ie.Gu,ie.gu,ie.pK,ie.Ie,ie.Q$,ie.q_,ie.wd,ie.sr,ie.j9,W.X$],encapsulation:2})),X})()},439:(zn,Ct,R)=>{"use strict";R.d(Ct,{l:()=>fe});var v=R(5861),d=R(1180),y=R(9127),s=R(9159),Q=R(2339),ie=R(9862),W=R(553),w=R(2029);let fe=(()=>{class Ae{constructor(X,se,Te){(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"refData",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"serviceBase","https://api.openchargemap.io"),(0,d.Z)(this,"serviceBaseURL",this.serviceBase+"/v3"),(0,d.Z)(this,"hasAuthorizationError",!1),(0,d.Z)(this,"ATTRIBUTION_METADATAFIELDID",4),(0,d.Z)(this,"authResponse",void 0),(0,d.Z)(this,"clientName","ocm.api.default"),(0,d.Z)(this,"authorizationErrorCallback",void 0),(0,d.Z)(this,"generalErrorCallback",void 0),(0,d.Z)(this,"allowMirror",!1),(0,d.Z)(this,"lastPOIApiCallURL",""),this.http=X,this.refData=se,this.logging=Te,this.serviceBaseURL=W.N.apiBase+"/v3"}getNumberListString(X){let se="";for(let Te=0;Te<X.length;Te++)se+=X[Te],Te<X.length&&(se+=",");return se}fetchPOIListByParam(X){var se=this;return(0,v.Z)(function*(){const Te=se.serviceBaseURL+"/poi/?client="+se.clientName+(se.allowMirror?" &allowmirror=true":"")+"&verbose=false&output=json";X.compact=!0;let ge="";null!=X.countryCode&&(ge+="&countrycode="+X.countryCode),null!=X.latitude&&(ge+="&latitude="+X.latitude),null!=X.longitude&&(ge+="&longitude="+X.longitude),null!=X.distance&&(ge+="&distance="+X.distance),null!=X.distanceUnit&&(ge+="&distanceunit="+X.distanceUnit),null!=X.includeComments&&(ge+="&includecomments="+X.includeComments),null!=X.maxResults&&(ge+="&maxresults="+X.maxResults),null!=X.countryIdList&&(ge+="&countryid="+se.getNumberListString(X.countryIdList)),null!=X.levelIdList&&(ge+="&levelid="+se.getNumberListString(X.levelIdList)),null!=X.connectionTypeIdList&&X.connectionTypeIdList.length>0&&(ge+="&connectiontypeid="+se.getNumberListString(X.connectionTypeIdList)),null!=X.operatorIdList&&X.operatorIdList.length>0&&(ge+="&operatorid="+se.getNumberListString(X.operatorIdList)),null!=X.usageTypeIdList&&X.usageTypeIdList.length>0&&(ge+="&usagetypeid="+se.getNumberListString(X.usageTypeIdList)),null!=X.statusTypeIdList&&X.statusTypeIdList.length>0&&(ge+="&statustypeid="+se.getNumberListString(X.statusTypeIdList)),null!=X.locationTitle&&(ge+="&locationtitle="+X.locationTitle),null!=X.minPowerKW&&X.minPowerKW>0&&(ge+="&minpowerkw="+X.minPowerKW),null!=X.maxPowerKW&&X.maxPowerKW>0&&(ge+="&maxpowerkw="+X.maxPowerKW),null!=X.submissionStatusTypeIdList&&(ge+="&submissionstatustypeid="+se.getNumberListString(X.submissionStatusTypeIdList)),null!=X.poiIdList&&X.poiIdList.length>0&&(ge+="&chargepointid="+se.getNumberListString(X.poiIdList)),0==X.enableCaching&&(ge+="&enablecaching=false"),null!=X.compact&&(ge+="&compact="+X.compact),X.levelOfDetail>1&&(ge+="&levelofdetail="+X.levelOfDetail),null!=X.polyline&&(ge+="&polyline="+X.polyline),null!=X.boundingbox&&(ge+="&boundingbox="+X.boundingbox),null!=X.additionalParams&&(ge+="&"+X.additionalParams);const we=Te+ge;if(se.lastPOIApiCallURL===we&&0!=X.enableCaching)return se.logging.log("Skipped API call due to same query being repeated."),[];se.lastPOIApiCallURL=we,se.logging.log("API Call:"+we,y.i.VERBOSE);try{let Le=yield se.http.get(we,se.getHttpRequestOptions()).toPromise();return se.refData.hydrateCompactPOIList(Le)}catch(Le){const Me=Le.message||"Could not fetch POI list from server.";throw se.logging.log("API Client: "+JSON.stringify(Le),y.i.ERROR),Me}})()}getHttpRequestOptions(X=!0){let se=new ie.WM;return X&&(se=se.append("Content-Type","application/json")),this.authResponse&&this.authResponse.Data&&this.authResponse.Data.access_token&&(se=se.append("Authorization","Bearer "+this.authResponse.Data.access_token)),se=se.append("X-API-Key",W.N.apiKey),{headers:se}}fetchCoreReferenceData(X){let se=this.serviceBaseURL+"/referencedata/?client="+this.clientName+"&output=json"+(this.allowMirror?"&allowmirror=true":"")+"&verbose=false&compact=true";return null!=X&&null!=X.CountryIds&&(se+="&countryid="+this.getNumberListString(X.CountryIds)),this.logging.log("API Call:"+se,y.i.VERBOSE),this.http.get(se,this.getHttpRequestOptions())}performSignIn(X,se){return this.http.post(this.serviceBaseURL+"/profile/authenticate/",JSON.stringify({emailaddress:X,password:se}),this.getHttpRequestOptions()).toPromise().then(we=>(this.authResponse=we,this.authResponse))}performSubmission(X,se){return X===Q.q.POI?this.submitPOI(se):X===Q.q.Comment?this.submitUserComment(se):X===Q.q.Media?this.submitMediaItem(se):void 0}submitUserComment(X){const se=JSON.stringify(X);return this.logging.log("[api] Submitting user comment"),this.http.post(this.serviceBaseURL+"/comment/",se,this.getHttpRequestOptions()).toPromise()}submitMediaItem(X){const se=JSON.stringify(X);return this.http.post(this.serviceBaseURL+"/mediaitem/",se,this.getHttpRequestOptions()).toPromise()}submitPOI(X){const se=JSON.stringify(X);return this.http.post(this.serviceBaseURL+"/poi/",se,this.getHttpRequestOptions()).toPromise()}getPanoramioLocationPhotos(X){return new Promise(se=>{const ge="https://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=2&minx="+(X.longitude-.001)+"&miny="+(X.latitude-.001)+"&maxx="+(X.longitude+.001)+"maxy="+(X.latitude+.001)+"&size=medium&mapfilter=true&callback=?";return console.log(ge),this.http.get(ge).toPromise()})}fetchReverseGeocodeResult(X,se){return this.http.get(this.serviceBaseURL+"/geocode/?client="+this.clientName+"&output=json&camelcase=false&latitude="+X+"&longitude="+se,this.getHttpRequestOptions()).toPromise()}isLocalStorageAvailable(){return typeof window.localStorage<"u"}setCachedDataObject(X,se){this.isLocalStorageAvailable()&&(typeof se>"u"&&(se=null),null===se?localStorage.removeItem(X):localStorage.setItem(X,JSON.stringify(se)))}getCachedDataObject(X){if(this.isLocalStorageAvailable()){const se=localStorage.getItem(X);if(null!=se&&se.length>0)return JSON.parse(se)}return null}}return(0,d.Z)(Ae,"\u0275fac",function(X){return new(X||Ae)(w.LFG(ie.eN),w.LFG(s.W),w.LFG(y.z))}),(0,d.Z)(Ae,"\u0275prov",w.Yz7({token:Ae,factory:Ae.\u0275fac,providedIn:"root"})),Ae})()},3294:(zn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>ie});var v=R(5861),d=R(1180),y=R(9127),s=R(2029),Q=R(7852);let ie=(()=>{class W{constructor(fe,Ae){(0,d.Z)(this,"logger",void 0),(0,d.Z)(this,"platform",void 0),(0,d.Z)(this,"isCordova",!1),(0,d.Z)(this,"ga",null),this.logger=fe,this.platform=Ae,this.isCordova=!(!Ae.is("cordova")&&!Ae.is("capacitor"))}init(fe){var Ae=this;return(0,v.Z)(function*(){Ae.isCordova&&Ae.ga?yield Ae.ga.startTrackerWithId(fe):Ae.logger.log("Could not initialise analytics")})()}setAppVersion(fe){var Ae=this;return(0,v.Z)(function*(){if(Ae.isCordova&&Ae.ga)return Ae.ga.setAppVersion(fe);Ae.logger.log(fe)})()}appEvent(fe,Ae){var De=this;return(0,v.Z)(function*(){if(De.isCordova&&De.ga)return De.ga.trackEvent(fe,Ae);De.logger.log(Ae)})()}viewEvent(fe){var Ae=this;return(0,v.Z)(function*(){if(Ae.isCordova&&Ae.ga)return Ae.ga.trackView(fe);Ae.logger.log(fe)})()}}return(0,d.Z)(W,"\u0275fac",function(fe){return new(fe||W)(s.LFG(y.z),s.LFG(Q.t4))}),(0,d.Z)(W,"\u0275prov",s.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"})),W})()},1618:(zn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>Ke});var v=R(5861),d=R(1180),y=R(9127),s=R(439),Q=R(4783),ie=R(3052),W=R(2339),w=R(9159),fe=R(989),Ae=R(3294),De=R(553),X=R(2029),se=R(9862),Te=R(5957);class ge{constructor(Ce,nt){(0,d.Z)(this,"ID",void 0),(0,d.Z)(this,"SubmissionType",void 0),(0,d.Z)(this,"Data",void 0),(0,d.Z)(this,"Attempts",void 0),(0,d.Z)(this,"DateQueued",void 0),(0,d.Z)(this,"IsSubmitted",void 0),(0,d.Z)(this,"IsInProgress",void 0),(0,d.Z)(this,"IsCancelled",void 0),(0,d.Z)(this,"IsFailure",void 0),(0,d.Z)(this,"FailureReason",void 0),this.SubmissionType=Ce,this.Data=nt,this.DateQueued=new Date,this.IsSubmitted=!1,this.IsInProgress=!1,this.IsCancelled=!1,this.IsFailure=!1,this.Attempts=0,this.ID=new Date+"_"+100*Math.random()}}let we=(()=>{class Oe{constructor(nt){(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"isQueueProcessing",void 0),(0,d.Z)(this,"appManager",void 0),this.events=nt,this.isQueueProcessing=!1}setAppManager(nt){this.appManager=nt}add(nt,Xe){let Ee=this.getQueueItems();Ee.push(new ge(nt,Xe)),this.saveQueueItems(Ee)}update(nt){let Xe=this.getQueueItems(),Ee=new Array;return Xe.forEach(ae=>{Ee.push(ae.ID==nt.ID?nt:ae)}),Ee}processNextQueueItem(){let nt=this.getNextQueueItem();null!=nt&&null!=this.appManager&&this.appManager.api.performSubmission(nt.SubmissionType,nt.Data).then(()=>{nt.IsSubmitted=!0,nt.Attempts++,this.update(nt),this.clear()})}getNextQueueItem(){let nt=this.getQueueItems(),Xe=null;return nt.forEach(Ee=>{null==Xe&&!Ee.IsCancelled&&!Ee.IsInProgress&&!Ee.IsSubmitted&&(Xe=Ee)}),Xe}hasPendingItems(){let nt=!1;return this.getQueueItems().forEach(Ee=>{!Ee.IsFailure&&!Ee.IsCancelled&&!Ee.IsSubmitted&&(nt=!0)}),nt}isCompleted(){let nt=this.getQueueItems(),Xe=!0;return nt.forEach(Ee=>{(Ee.IsInProgress||Ee.IsFailure)&&(Xe=!1)}),Xe}clear(nt=!1){let Xe=this.getQueueItems(),Ee=new Array;nt||Xe.forEach(ae=>{(ae.IsInProgress||ae.IsFailure)&&Ee.push(ae)}),this.saveQueueItems(Ee)}saveQueueItems(nt){localStorage.setItem("submissionQueue",JSON.stringify(nt))}getQueueItems(){let nt=localStorage.getItem("submissionQueue");return null!=nt?JSON.parse(nt):new Array}}return(0,d.Z)(Oe,"\u0275fac",function(nt){return new(nt||Oe)(X.LFG(Te.z))}),(0,d.Z)(Oe,"\u0275prov",X.Yz7({token:Oe,factory:Oe.\u0275fac,providedIn:"root"})),Oe})();var Le=R(7852),Me=R(3999),ze=R(6091);let Ke=(()=>{class Oe{constructor(nt,Xe,Ee,ae,mt,xe,Ze,Se,ye,Qt,dt,gt,ct){(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"api",void 0),(0,d.Z)(this,"submissionQueue",void 0),(0,d.Z)(this,"platform",void 0),(0,d.Z)(this,"referenceDataManager",void 0),(0,d.Z)(this,"journeyManager",void 0),(0,d.Z)(this,"translateService",void 0),(0,d.Z)(this,"toastController",void 0),(0,d.Z)(this,"loadingController",void 0),(0,d.Z)(this,"jwtHelper",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"analytics",void 0),(0,d.Z)(this,"enableSubmissionQueue",void 0),(0,d.Z)(this,"searchSettings",void 0),(0,d.Z)(this,"platformMode",void 0),(0,d.Z)(this,"journeys",void 0),(0,d.Z)(this,"isDebugMode",void 0),(0,d.Z)(this,"clientWidth",void 0),(0,d.Z)(this,"clientHeight",void 0),(0,d.Z)(this,"isRequestInProgress",!1),(0,d.Z)(this,"title","Open Charge Map"),(0,d.Z)(this,"_isUserAuthenticated",null),(0,d.Z)(this,"isEmbeddedMode",!1),(0,d.Z)(this,"isOffline",!1),this.http=nt,this.events=Xe,this.api=Ee,this.submissionQueue=ae,this.platform=mt,this.referenceDataManager=xe,this.journeyManager=Ze,this.translateService=Se,this.toastController=ye,this.loadingController=Qt,this.jwtHelper=dt,this.logging=gt,this.analytics=ct,this.api.clientName="ocm.app.ionic."+De.N.version,this.isDebugMode=!1,this.enableSubmissionQueue=!1,this.submissionQueue.setAppManager(this),this.platformMode=mt.is("cordova")?"cordova":"web",this.initAppManager(),this.searchSettings=new Q.N,this.loadSearchSettings(),this.applyURLQueryStringOptions(),this.searchSettings.CheckForActiveFilters(),this.journeyManager.loadJourneys()}loadSearchSettings(){if(null!=localStorage.getItem("searchSettings")){this.searchSettings=new Q.N;try{let nt=JSON.parse(localStorage.getItem("searchSettings"));Object.assign(this.searchSettings,nt)}catch{}}}savePushRegistration(nt){localStorage.setItem("_pushToken",nt.toString())}getPushRegistration(){localStorage.getItem("_pushToken")}getQueryVariable(nt){let Ee=window.location.search.substring(1).split("&");for(let ae=0;ae<Ee.length;ae++){let mt=Ee[ae].split("=");if(decodeURIComponent(mt[0])==nt)return mt[1].split(",").map(Se=>decodeURIComponent(Se))}return null}applyURLQueryStringOptions(){if(this.getQueryVariable("mode")&&"embedded"==this.getQueryVariable("mode")[0]&&(this.isEmbeddedMode=!0),this.getQueryVariable("operatorid")){let nt=this.getQueryVariable("operatorid");for(let Xe of nt)this.searchSettings.OperatorList.unshift(parseInt(Xe,10))}if(this.getQueryVariable("latitude")&&this.getQueryVariable("longitude")){let nt=this.getQueryVariable("latitude")[0],Xe=this.getQueryVariable("longitude")[0];this.searchSettings.StartSearchPosition=new ie.wC(parseFloat(nt),parseFloat(Xe))}this.getQueryVariable("title")&&(this.title=this.getQueryVariable("title")[0]),this.getQueryVariable("languagecode")&&this.setLanguage(this.getQueryVariable("languagecode")[0]),this.getQueryVariable("id")&&(this.searchSettings.StartViewPoiId=this.getQueryVariable("id")[0])}saveSearchSettings(){this.searchSettings.CheckForActiveFilters(),localStorage.setItem("searchSettings",JSON.stringify(this.searchSettings))}getLanguages(){return[{code:"ar",title:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 / Arabic"},{code:"bg",title:"Bulgarian / \u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",title:"Czech / \u010ce\u0161tina"},{code:"de",title:"German / Deutsch"},{code:"el",title:"Greek / \u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ae"},{code:"en",title:"English"},{code:"es",title:"Spanish / Espa\xf1ol"},{code:"et",title:"Estonian / Eesti"},{code:"fi",title:"Finnish / Suomi"},{code:"fr",title:"French / Fran\xe7ais"},{code:"fy",title:"West Frisian / Frysk"},{code:"hu",title:"Hungarian / Magyar"},{code:"it",title:"Italian / Italiano"},{code:"ja",title:"Japanese / \u65e5\u672c\u8a9e"},{code:"lt",title:"Lithuanian / Lietuvi\u0173"},{code:"nl",title:"Dutch / Nederlands"},{code:"pt",title:"Portuguese / portugu\xeas"},{code:"ro",title:"Romanian / Rom\xe2n\u0103"},{code:"ru",title:"Russian / P\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sk",title:"Slovak / Sloven\u010dina"},{code:"tr",title:"Turkish / T\xfcrk\xe7e"},{code:"zh",title:"Chinese / \u4e2d\u56fd\u7684"}]}setLanguage(nt){(null==nt||""==nt)&&(nt="en"),this.logging.log("Changing language: "+nt),this.translateService.use(nt)}initAppManager(){this.initAuthFromStorage(),this.isUserAuthenticated(!0)&&this.enableSubmissionQueue&&null!=this.submissionQueue&&this.submissionQueue.hasPendingItems()&&this.submissionQueue.processNextQueueItem()}initAuthFromStorage(){let nt=localStorage.getItem("authResponse");if(null!=nt){let Xe=JSON.parse(nt);null!=Xe.Data&&null!=Xe.Data.access_token&&(this.jwtHelper.decodeToken(Xe.Data.access_token),this.jwtHelper.isTokenExpired(Xe.Data.access_token)?localStorage.removeItem("authResponse"):(this.api.authResponse=Xe,this.logging.log("User has valid auth token in local storage",y.i.VERBOSE)))}}isUserAuthenticated(nt=!1){return!1===nt&&null!=this._isUserAuthenticated||(this._isUserAuthenticated=!1,null!=this.api.authResponse&&(this.jwtHelper.isTokenExpired(this.api.authResponse.Data.access_token)||(this._isUserAuthenticated=!0))),this._isUserAuthenticated}getCurrentAuthToken(){return null!=this.api.authResponse?this.api.authResponse.Data.access_token:null}getUserProfile(){return null!=this.api.authResponse?this.api.authResponse.Data.UserProfile:null}signOutCurrentUser(){localStorage.removeItem("authResponse"),this.api.authResponse=null,this._isUserAuthenticated=!1}submitComment(nt){if(!this.enableSubmissionQueue)return this.api.performSubmission(W.q.Comment,nt);this.submissionQueue.add(W.q.Comment,nt),this.submissionQueue.processNextQueueItem()}submitMediaItem(nt){if(!this.enableSubmissionQueue)return this.api.performSubmission(W.q.Media,nt);this.submissionQueue.add(W.q.Media,nt),this.submissionQueue.processNextQueueItem()}submitPOI(nt){if(!this.enableSubmissionQueue)return this.api.performSubmission(W.q.POI,nt);this.submissionQueue.add(W.q.POI,nt),this.submissionQueue.processNextQueueItem()}showToastNotification(nt){var Xe=this;return(0,v.Z)(function*(){yield(yield Xe.toastController.create({message:nt,duration:3e3})).present()})()}showLoadingProgress(nt){var Xe=this;return(0,v.Z)(function*(){yield(yield Xe.loadingController.create({message:nt})).present()})()}dismissLoadingProgress(){var nt=this;return(0,v.Z)(function*(){return nt.loadingController.dismiss()})()}launchOCMWebPage(nt){this.isUserAuthenticated(!0)&&(-1===nt.indexOf("?")&&(nt+="?"),nt+="&auth="+this.getCurrentAuthToken()),nt="https://openchargemap.org/site"+nt,window.open(nt,"_system")}launchWebPage(nt){window.open(nt,"_system")}isPlatform(nt){return this.platform.is(nt)}}return(0,d.Z)(Oe,"\u0275fac",function(nt){return new(nt||Oe)(X.LFG(se.eN),X.LFG(Te.z),X.LFG(s.l),X.LFG(we),X.LFG(Le.t4),X.LFG(w.W),X.LFG(fe.i),X.LFG(Me.sK),X.LFG(Le.yF),X.LFG(Le.HT),X.LFG(ze.N0),X.LFG(y.z),X.LFG(Ae.c))}),(0,d.Z)(Oe,"\u0275prov",X.Yz7({token:Oe,factory:Oe.\u0275fac,providedIn:"root"})),Oe})()},5957:(zn,Ct,R)=>{"use strict";R.d(Ct,{z:()=>y});var v=R(1180),d=R(2029);let y=(()=>{class s{constructor(){(0,v.Z)(this,"c",new Map)}subscribe(ie,...W){let w=this.c.get(ie);w||this.c.set(ie,w=[]),w.push(...W)}unsubscribe(ie,W){if(!W)return this.c.delete(ie);const w=this.c.get(ie);if(!w)return!1;const fe=w.indexOf(W);return!(fe<0||(w.splice(fe,1),0===w.length&&this.c.delete(ie),0))}publish(ie,...W){const w=this.c.get(ie);return w?w.map(fe=>{try{return fe(...W)}catch(Ae){return console.error(Ae),null}}):null}}return(0,v.Z)(s,"\u0275fac",function(ie){return new(ie||s)}),(0,v.Z)(s,"\u0275prov",d.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"})),s})()},989:(zn,Ct,R)=>{"use strict";R.d(Ct,{i:()=>fe});var v=R(1180),d=R(9127),y=R(439),s=R(4669),Q=R(4677),ie=R(7430),W=R(3052),w=R(2029);let fe=(()=>{class Ae{constructor(X,se,Te){(0,v.Z)(this,"api",void 0),(0,v.Z)(this,"poiManager",void 0),(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"journeys",void 0),(0,v.Z)(this,"favourites",void 0),(0,v.Z)(this,"routePolyline",void 0),this.api=X,this.poiManager=se,this.logging=Te,this.journeys=[],this.favourites=[]}loadJourneys(){let X=localStorage.getItem("journeys");if(null!=X&&(this.journeys=JSON.parse(X)),null!=this.journeys)for(let se of this.journeys)this.fetchAllJourneyPOIDetails(se)}fetchAllJourneyPOIDetails(X){this.logging.log("Journeys - fetching poi details for Journey "+X.Title);let se=new Q.b;se.poiIdList=[];for(let Te of X.Stages)for(let ge of Te.WayPoints)for(let we of ge.PoiIDs)se.poiIdList.push(we);this.api.fetchPOIListByParam(se).then(Te=>{for(let ge of Te)this.updateStoredPOI(ge)})}updateStoredPOI(X){if(this.journeys.forEach(se=>{se.Stages.forEach(Te=>{Te.WayPoints.forEach(ge=>{ge.PoiIDs.forEach(we=>{if(we==X.ID)if(null==ge.PoiList){ge.PoiList=[];let Le=new ie.Qp("charging",1);Le.Poi=X,Le.PoiID=X.ID,ge.PoiList.push(Le)}else for(let Le of ge.PoiList)Le.PoiID==X.ID&&(Le.Poi=X)})})})}),null!=this.favourites)for(let se of this.favourites)"charging"==se.Type&&se.PoiID==X.ID&&(se.Poi=X)}saveJourneys(){let X=JSON.parse(JSON.stringify(this.journeys));for(let Te of X)for(const ge of Te.Stages)for(let we of ge.WayPoints)for(let Le of we.PoiList)Le.Poi=null,Le.Photos=null;const se=JSON.stringify(X);localStorage.setItem("journeys",se)}addJourney(X,se){let Te=new ie.vw;Te.Title="Stage 1",null!=se&&Te.WayPoints.push(se),X.Stages.push(Te),this.journeys.push(X)}deleteJourney(X){this.journeys=this.journeys.filter(se=>se.ID!=X),this.saveJourneys()}getJourney(X){let se=this.journeys.filter(Te=>Te.ID==X);return se.length>0?se[0]:null}getJourneyStages(X){return this.getJourney(X).Stages}addJourneyWaypoint(X,se,Te){let ge=this.getJourney(X);if(null==se){let we=new ie.vw;we.Title="Stage "+(ge.Stages.length+1),we.WayPoints.push(Te),ge.Stages.push(we)}else{let we=ge.Stages[se];null==we.WayPoints&&(we.WayPoints=[]),we.WayPoints.push(Te)}}addJourneyStage(X,se){return this.getJourney(X).Stages.push(se)-1}setupTestJourneys(){this.journeys=[];let X=new ie.fw;X.Title="New York to Brooklyn",X.Notes="A little jaunt to Brooklyn",X.Stages=[];let se=new ie.vw,Te=new ie.kA;Te.Notes="Starting point",Te.Position=new W.wC(40,1.2),Te.Title="Start",se.WayPoints.push(Te);let ge=new ie.kA;ge.Notes="Middle point",ge.Position=new W.wC(40,1.33),ge.Title="Middle",se.WayPoints.push(ge);let we=new ie.kA;we.Notes="End point",we.Position=new W.wC(40,1.33),we.Title="End",se.WayPoints.push(we),X.Stages.push(se),this.journeys.push(X);let Le=new ie.fw;Le.Title="Aberdeen to London",Le.Notes="Roadtrip",Le.Stages=[],this.journeys.push(Le)}calculateEnergyConsumptionkWh(X,se,Te=0,ge){return X*ge}setRoutePolyline(X){this.routePolyline=X}getRoutePolyline(){return this.routePolyline}}return(0,v.Z)(Ae,"\u0275fac",function(X){return new(X||Ae)(w.LFG(y.l),w.LFG(s.R),w.LFG(d.z))}),(0,v.Z)(Ae,"\u0275prov",w.Yz7({token:Ae,factory:Ae.\u0275fac,providedIn:"root"})),Ae})()},9127:(zn,Ct,R)=>{"use strict";R.d(Ct,{i:()=>s,z:()=>Q});var v=R(1180),d=R(553),y=R(2029),s=(()=>((s=s||{})[s.VERBOSE=0]="VERBOSE",s[s.INFO=1]="INFO",s[s.WARNING=2]="WARNING",s[s.ERROR=3]="ERROR",s))();let Q=(()=>{class ie{constructor(){(0,v.Z)(this,"logLevel",void 0),this.logLevel=s.VERBOSE,d.N.production&&(this.logLevel=s.INFO)}log(w,fe=s.VERBOSE){console&&console.log&&fe>=this.logLevel&&console.log("["+s[fe]+"] {"+(new Date).toLocaleTimeString()+"} "+w)}}return(0,v.Z)(ie,"\u0275fac",function(w){return new(w||ie)}),(0,v.Z)(ie,"\u0275prov",y.Yz7({token:ie,factory:ie.\u0275fac,providedIn:"root"})),ie})()},4669:(zn,Ct,R)=>{"use strict";R.d(Ct,{R:()=>w});var v=R(5861),d=R(1180),y=R(9127),s=R(439),Q=R(3294),ie=R(2029),W=R(5957);let w=(()=>{class fe{constructor(De,X,se,Te){(0,d.Z)(this,"api",void 0),(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"analytics",void 0),(0,d.Z)(this,"poiList",void 0),(0,d.Z)(this,"isRequestInProgress",!1),this.api=De,this.events=X,this.logging=se,this.analytics=Te}refreshPOIList(De){var X=this;return(0,v.Z)(function*(){try{return X.poiList=yield X.fetchPOIList(De),X.events.publish("ocm:poiList:updated"),X.analytics.appEvent("Search","Fetched Results"),X.poiList.length}catch{return 0}})()}fetchPOIList(De){var X=this;return(0,v.Z)(function*(){X.isRequestInProgress=!0;try{let se=yield X.api.fetchPOIListByParam(De);return X.isRequestInProgress=!1,se&&se.length&&X.logging.log("fetched POI list ["+se.length+"]"),se}catch{return X.isRequestInProgress=!1,[]}})()}clearResults(){this.poiList=[],this.events.publish("ocm:poiList:cleared"),this.logging.log("clearing results after settings change",y.i.VERBOSE)}getPOIById(De,X=!1,se=!1){var Te=this;return(0,v.Z)(function*(){if(!se&&null!=Te.poiList){const Le=Te.poiList.find(Me=>Me.ID==De);if(Le)return Le}const ge={poiIdList:[De],enableCaching:!se,includeComments:!0},we=yield Te.api.fetchPOIListByParam(ge);return we&&we.length>0?(Te.poiList&&we[0].ID==De&&(Te.poiList=Te.poiList.filter(Le=>Le.ID!=De),Te.poiList.push(we[0]),Te.logging.log("POI refreshed in cache "+De)),we[0]):null})()}}return(0,d.Z)(fe,"\u0275fac",function(De){return new(De||fe)(ie.LFG(s.l),ie.LFG(W.z),ie.LFG(y.z),ie.LFG(Q.c))}),(0,d.Z)(fe,"\u0275prov",ie.Yz7({token:fe,factory:fe.\u0275fac,providedIn:"root"})),fe})()},9159:(zn,Ct,R)=>{"use strict";R.d(Ct,{W:()=>ie});var v=R(5861),d=R(1180),y=R(9127),s=R(2029),Q=R(9862);let ie=(()=>{class W{constructor(fe,Ae){(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"referenceData",void 0),(0,d.Z)(this,"filteredReferenceData",void 0),this.http=fe,this.logging=Ae,this.loadCachedRefData()}refreshReferenceData(fe){var Ae=this;return(0,v.Z)(function*(){try{const De=yield fe.fetchCoreReferenceData(null).toPromise();return Ae.setCoreReferenceData(De),Ae.setFilteredReferenceData(De),Ae.logging.log("Got refreshed core ref data.",y.i.VERBOSE),Ae.sortCoreReferenceData(),Ae.cacheCurrentRefData(),!0}catch(De){return Ae.logging.log("Error fetching core ref data:"+De),!1}})()}refreshFilteredReferenceData(fe,Ae){fe.fetchCoreReferenceData(Ae).subscribe(De=>{this.setFilteredReferenceData(De),this.sortCoreReferenceData(),this.logging.log("Got refreshed filtered reference data.",y.i.VERBOSE)},De=>{this.logging.log("Error fetching filtered reference data:"+De)})}setCoreReferenceData(fe){this.referenceData=fe}setFilteredReferenceData(fe){this.filteredReferenceData=fe}referenceDataLoaded(){return null!=this.referenceData}getCountries(fe=!1){return 1==fe?this.filteredReferenceData.Countries:this.referenceData.Countries}getCountryByID(fe){return this.getRefDataByID(this.referenceData.Countries,fe)}getConnectionTypes(fe=!1){return 1==fe?this.filteredReferenceData.ConnectionTypes:this.referenceData.ConnectionTypes}getConnectionTypeByID(fe){return this.getRefDataByID(this.referenceData.ConnectionTypes,fe)}getUsageTypes(fe=!1){return 1==fe?this.filteredReferenceData.UsageTypes:this.referenceData.UsageTypes.filter(Ae=>Ae.ID>0)}getUsageTypeByID(fe){return this.getRefDataByID(this.referenceData.UsageTypes,fe)}getStatusTypes(fe=!1){return 1==fe?this.filteredReferenceData.StatusTypes:this.referenceData.StatusTypes.filter(Ae=>Ae.ID>0)}getStatusTypeByID(fe){return this.getRefDataByID(this.referenceData.StatusTypes,fe)}getNetworkOperators(fe=!1){return 1==fe?this.filteredReferenceData.Operators:this.referenceData.Operators}getNetworkOperatorByID(fe){return this.getRefDataByID(this.referenceData.Operators,fe)}getDataProviders(fe=!1){return 1==fe?this.filteredReferenceData.DataProviders:this.referenceData.DataProviders}getDataProviderByID(fe){return this.getRefDataByID(this.referenceData.DataProviders,fe)}getCheckinStatusTypes(fe=!1,Ae=!0){let De=null;return De=1==fe?this.filteredReferenceData.CheckinStatusTypes:this.referenceData.CheckinStatusTypes,Ae&&(De=De.filter(X=>!1===X.IsAutomatedCheckin)),De}getCheckinStatusTypeByID(fe){return this.getRefDataByID(this.referenceData.CheckinStatusTypes,fe)}getCommentTypes(fe=!1,Ae=!0){let De;return De=1==fe?this.filteredReferenceData.UserCommentTypes:this.referenceData.UserCommentTypes,Ae&&(De=De.filter(X=>100!==X.ID&&110!==X.ID)),De}getCommentTypeByID(fe){return this.getRefDataByID(this.referenceData.UserCommentTypes,fe)}getSubmissionStatusTypes(fe=!1){return 1==fe?this.filteredReferenceData.SubmissionStatusTypes:this.referenceData.SubmissionStatusTypes}getSubmissionStatusTypesByID(fe){return this.getRefDataByID(this.referenceData.SubmissionStatusTypes,fe)}getChargingLevelTypes(fe=!1){return 1==fe?this.filteredReferenceData.ChargerTypes:this.referenceData.ChargerTypes}getChargingLevelTypeByID(fe){return this.getRefDataByID(this.referenceData.ChargerTypes,fe)}getOutputCurrentTypes(fe=!1){return fe?this.referenceData.CurrentTypes:this.filteredReferenceData.CurrentTypes}getOutputCurrentTypeByID(fe){return this.getRefDataByID(this.referenceData.CurrentTypes,fe)}loadCachedRefData(){const fe=localStorage.getItem("referenceData");if(null==fe)this.http.get("./assets/data/CoreReferenceData.json").subscribe(Ae=>{this.logging.log("Using bundled reference data as cached ref data."),this.setCoreReferenceData(Ae),this.setFilteredReferenceData(Ae)});else{let Ae=JSON.parse(fe);this.setCoreReferenceData(Ae)}this.setFilteredReferenceData(this.referenceData)}cacheCurrentRefData(){null!=this.referenceData&&(this.referenceData.CacheDate=new Date,localStorage.setItem("referenceData",JSON.stringify(this.referenceData)))}getRefDataByID(fe,Ae){if(""!==Ae&&(Ae=parseInt(Ae,10)),null!=fe)for(let De=0;De<fe.length;De++)if(fe[De].ID===Ae)return fe[De];return null}sortCoreReferenceData(){this.sortReferenceData(this.referenceData.ConnectionTypes),this.sortReferenceData(this.referenceData.Countries),this.sortReferenceData(this.referenceData.Operators),this.sortReferenceData(this.referenceData.DataProviders),this.sortReferenceData(this.referenceData.UsageTypes),this.sortReferenceData(this.referenceData.StatusTypes),this.sortReferenceData(this.referenceData.CheckinStatusTypes),this.sortReferenceData(this.referenceData.SubmissionStatusTypes),this.filteredReferenceData&&(this.sortReferenceData(this.filteredReferenceData.ConnectionTypes),this.sortReferenceData(this.filteredReferenceData.Operators))}sortReferenceData(fe){fe.sort(this.sortListByTitle)}sortListByTitle(fe,Ae){return fe.Title<Ae.Title?-1:fe.Title>Ae.Title?1:0}getMetadataValueByMetadataFieldID(fe,Ae){if(""!==Ae&&(Ae=parseInt(Ae,10)),null!=fe)for(let De=0;De<fe.length;De++)if(fe[De].ID===Ae)return fe[De];return null}hydrateCompactPOI(fe,Ae=!1){const De=this;if(null!=fe.DataProviderID&&(Ae||null==fe.DataProvider)&&(fe.DataProvider=De.getDataProviderByID(fe.DataProviderID)),null!=fe.OperatorID&&(Ae||null==fe.OperatorInfo)&&(fe.OperatorInfo=De.getNetworkOperatorByID(fe.OperatorID)),null!=fe.UsageTypeID&&(Ae||null==fe.UsageType)&&(fe.UsageType=De.getUsageTypeByID(fe.UsageTypeID)),null!=fe.AddressInfo.CountryID&&(Ae||null==fe.AddressInfo.Country)&&(fe.AddressInfo.Country=De.getCountryByID(fe.AddressInfo.CountryID)),null!=fe.StatusTypeID&&(Ae||null==fe.StatusType)&&(fe.StatusType=De.getStatusTypeByID(fe.StatusTypeID)),null!=fe.SubmissionStatusTypeID&&(Ae||null==fe.SubmissionStatusType)&&(fe.SubmissionStatusType=De.getSubmissionStatusTypesByID(fe.SubmissionStatusTypeID)),null!=fe.Connections)for(let X=0;X<fe.Connections.length;X++){const se=fe.Connections[X];null!=se.ConnectionTypeID&&(Ae||null==se.ConnectionType)&&(se.ConnectionType=De.getConnectionTypeByID(se.ConnectionTypeID)),null!=se.LevelID&&(Ae||null==se.Level)&&(se.Level=De.getChargingLevelTypeByID(se.LevelID)),null!=se.CurrentTypeID&&(Ae||null==se.CurrentType)&&(se.CurrentType=De.getOutputCurrentTypeByID(se.CurrentTypeID)),null!=se.StatusTypeID&&(Ae||null==se.StatusType)&&(se.StatusType=De.getStatusTypeByID(se.StatusTypeID)),fe.Connections[X]=se}if(null!=fe.UserComments)for(let X=0;X<fe.UserComments.length;X++){const se=fe.UserComments[X];null!=se.CommentTypeID&&(Ae||null==se.CommentType)&&(se.CommentType=De.getCommentTypeByID(se.CommentTypeID)),null!=se.CheckinStatusTypeID&&(Ae||null==se.CheckinStatusType)&&(se.CheckinStatusType=De.getCheckinStatusTypeByID(se.CheckinStatusTypeID)),fe.UserComments[X]=se}return fe}hydrateCompactPOIList(fe){for(let Ae=0;Ae<fe.length;Ae++)fe[Ae]=this.hydrateCompactPOI(fe[Ae]);return fe}}return(0,d.Z)(W,"\u0275fac",function(fe){return new(fe||W)(s.LFG(Q.eN),s.LFG(y.z))}),(0,d.Z)(W,"\u0275prov",s.Yz7({token:W,factory:W.\u0275fac,providedIn:"root"})),W})()},1847:(zn,Ct,R)=>{"use strict";R.d(Ct,{v:()=>Le});var v=R(1180),d=R(9903),y=R(3955),s=R(866),Q=R(9127),ie=R(5861),W=R(5592),w=R(3052),fe=R(553),Ae=R(2117);class De{constructor(ze,Ke){(0,v.Z)(this,"events",void 0),(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"mapAPIType",void 0),(0,v.Z)(this,"mapReady",void 0),(0,v.Z)(this,"providerError",void 0),(0,v.Z)(this,"mapCanvasID",void 0),(0,v.Z)(this,"map",void 0),(0,v.Z)(this,"markerList",void 0),(0,v.Z)(this,"polylinePath",void 0),(0,v.Z)(this,"mapkitUtils",void 0),this.events=ze,this.logging=Ke,this.events=ze,this.mapAPIType=y.b.MAPKIT_JS,this.mapReady=!1,this.markerList=new Map,this.mapkitUtils=new X}initAPI(){mapkit&&mapkit.init({authorizationCallback:function(ze){ze(fe.N.mapKitToken)}})}disposeMap(){}initMap(ze,Ke,Oe){this.mapCanvasID=ze;let Ce=!0;if(Ce=!(typeof mapkit>"u"),!Ce)return this.logging.log("Call to initMap before API is ready:"+y.b[this.mapAPIType],Q.i.ERROR),this.mapReady=!1,!1;this.initAPI(),null==this.map&&(document.getElementById(ze),this.map=new mapkit.Map(ze),this.map.annotationForCluster=function(Xe){"poi"===Xe.clusteringIdentifier&&(Xe.title="Charging Location",Xe.subtitle=Xe.memberAnnotations.reduce((Ee,ae)=>Ee+ae.population,0))},this.mapReady=!0,mapkit.addEventListener("configuration-change",Xe=>{this.events.publish("ocm:mapping:ready")}),this.map.addEventListener("scroll-end",Xe=>{this.events.publish("ocm:mapping:dragend")}),this.map.addEventListener("zoom-end",Xe=>{this.events.publish("ocm:mapping:zoom")}))}clearMarkers(){null!=this.markerList&&this.markerList.forEach((ze,Ke)=>{try{this.map.removeAnnotation(Ke)}catch{}}),this.markerList=new Map}showPOIListOnMap(ze,Ke){let Xe=0,ae=0==this.markerList.size;if(null!=ze){let xe=[];for(let Ze=0;Ze<ze.length;Ze++)if(null!=ze[Ze].AddressInfo&&null!=ze[Ze].AddressInfo.Latitude&&null!=ze[Ze].AddressInfo.Longitude){let Se=ze[Ze],ye=!0;if(null!=this.markerList&&this.markerList.has(Se.ID)&&(ye=!1),ye){let Qt=null;Qt=s.c.getIconForPOI(Se);let Ue="OCM-"+Se.ID+": "+Se.AddressInfo.Title+":";null!=Se.UsageType&&(Ue+=" "+Se.UsageType.Title),null!=Se.StatusType&&(Ue+=" "+Se.StatusType.Title);const vt=new mapkit.Coordinate(Se.AddressInfo.Latitude,Se.AddressInfo.Longitude);let je=new mapkit.ImageAnnotation(vt,{title:Ue,size:{width:34,height:50},url:{1:Qt},clusteringIdentifier:"poi"});je.poi=Se,je.addEventListener("select",_t=>{const Ne=_t.target.poi;this.events.publish("ocm:poi:selected",{poi:Ne,poiId:Ne.ID})}),this.markerList.set(Se.ID,je),xe.push(je),Xe++}}xe.length>0&&(this.map.addAnnotations(xe),ae&&this.map.showItems(xe,{animate:!0,padding:new mapkit.Padding(60,25,60,25)})),this.logging.log(Xe+" new map markers added out of a total "+this.markerList.size)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapKit: refreshMapLayout",Q.i.VERBOSE)},200)}setMapCenter(ze,Ke){this.map&&(this.map.setCenterAnimated(new mapkit.Coordinate(ze.coords.latitude,ze.coords.longitude),!1),Ke&&this.setMapZoom(Ke))}getMapCenter(){return new W.y(Ke=>{if(null!=this.map){let Oe=this.map.center;null!=Oe&&(Ke.next(new w.jR(Oe.latitude,Oe.longitude)),Ke.complete())}})}setMapZoom(ze){const Ke=Math.min(ze,28),Oe=this.mapkitUtils.deltaFromZoomLevel(this.map,this.map.center,Math.round(Ke)),Ce=new mapkit.CoordinateSpan(111*Oe.latitudeDelta,111*Oe.longitudeDelta),nt=new mapkit.CoordinateRegion(this.map.center,Ce);this.map.setRegionAnimated(nt)}getMapZoom(){return new W.y(Ke=>{this.logging.log("MapKit: getMapZoom not supported",Q.i.VERBOSE),Ke.next(this.map._impl.zoomLevel),Ke.complete()})}setMapType(ze){this.logging.log("MapKit: skipped setting Map Type :"+ze)}getMapBounds(){return new W.y(Ke=>{let Oe=new Array,Ce=this.map.region.toBoundingRegion();Oe.push(new w.wC(Ce.southLatitude,Ce.westLongitude)),Oe.push(new w.wC(Ce.northLatitude,Ce.eastLongitude)),Ke.next(Oe),Ke.complete()})}moveToMapBounds(ze){this.logging.log("MapKit: map bounds not implemented")}renderMap(ze,Ke,Oe){return document.getElementById(this.mapCanvasID).style.height=Ke+"px",this.mapReady&&this.showPOIListOnMap(ze,Oe),!0}renderPolyline(ze){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(ze){return(0,ie.Z)(function*(){let Ke=new mapkit.Search({getsUserLocation:!0});return new Promise(function(){var Oe=(0,ie.Z)(function*(Ce,nt){let Xe=[];Ke.search(ze,function(){var Ee=(0,ie.Z)(function*(ae,mt){ae&&nt(ae),Xe=[],mt.places.map(xe=>{let Ze=new Ae.n;Ze.Title=xe.name,Ze.Address=xe.formattedAddress,Ze.Type="place",Ze.Location=new w.wC(xe.coordinate.latitude,xe.coordinate.longitude),Xe.push(Ze)}),Ce(Xe)});return function(ae,mt){return Ee.apply(this,arguments)}}())});return function(Ce,nt){return Oe.apply(this,arguments)}}())})()}addPOILayer(ze){this.logging.log("Add POI Layer not implemented in this provider.")}}class X{constructor(){(0,v.Z)(this,"mercatorRadius",85445659.44705395),(0,v.Z)(this,"mercatorOffset",268435456)}longitudeToPixelSpaceX(ze){return Math.round(this.mercatorOffset+this.mercatorRadius*ze*Math.PI/180)}latitudeToPixelSpaceY(ze){return Math.round(this.mercatorOffset-this.mercatorRadius*Math.log((1+Math.sin(ze*Math.PI/180))/(1-Math.sin(ze*Math.PI/180)))/2)}pixelSpaceXToLongitude(ze){return(Math.round(ze)-this.mercatorOffset)/this.mercatorRadius*180/Math.PI}pixelSpaceYToLatitude(ze){return 180*(Math.PI/2-2*Math.atan(Math.exp((Math.round(ze)-this.mercatorOffset)/this.mercatorRadius)))/Math.PI}deltaFromZoomLevel(ze,Ke,Oe){let Ce=this.longitudeToPixelSpaceX(Ke.longitude),nt=this.latitudeToPixelSpaceY(Ke.latitude),Ee=Math.pow(2,20-Oe),ae=ze.visibleMapRect.size,mt=ae.width*Ee,xe=ae.height*Ee,Ze=Ce-mt/2,Se=nt-xe/2,ye=this.pixelSpaceXToLongitude(Ze),dt=this.pixelSpaceXToLongitude(Ze+mt)-ye,gt=this.pixelSpaceYToLatitude(Se);return{latitudeDelta:-1*(this.pixelSpaceYToLatitude(Se+xe)-gt),longitudeDelta:dt}}}var se=R(2029),Te=R(5957),ge=R(9862);let we=(()=>{class Me extends d.k{constructor(Ke,Oe,Ce){super(Ke,Oe,Ce),this.mapAPIType=y.b.MAPTILER,this.mapTileSet="https://maps.tilehosting.com/styles/streets/style.json?key=Gs9z7krALe3CGI60d5cL"}initAPI(){}}return(0,v.Z)(Me,"\u0275fac",function(Ke){return new(Ke||Me)(se.LFG(Te.z),se.LFG(Q.z),se.LFG(ge.eN))}),(0,v.Z)(Me,"\u0275prov",se.Yz7({token:Me,factory:Me.\u0275fac})),Me})(),Le=(()=>{class Me{constructor(Ke,Oe,Ce){(0,v.Z)(this,"logging",void 0),(0,v.Z)(this,"http",void 0),(0,v.Z)(this,"map",void 0),(0,v.Z)(this,"mapCentreMarker",void 0),(0,v.Z)(this,"mapsInitialised",void 0),(0,v.Z)(this,"mapAPIReady",void 0),(0,v.Z)(this,"mapOptions",void 0),(0,v.Z)(this,"searchMarker",void 0),(0,v.Z)(this,"errorMessage",void 0),(0,v.Z)(this,"parentAppContext",void 0),(0,v.Z)(this,"mapProvider",void 0),(0,v.Z)(this,"debouncedMapPositionUpdate",void 0),(0,v.Z)(this,"events",void 0),(0,v.Z)(this,"isFocused",!1),this.logging=Oe,this.http=Ce,this.events=Ke,this.mapOptions=new y._,this.mapAPIReady=!1,this.mapsInitialised=!1,this.setMapAPI(this.mapOptions.mapAPI);let nt=this;this.debouncedMapPositionUpdate=s.c.debounce(()=>{this.logging.log("signaling map position change:"),nt.mapProvider.mapReady&&nt.getMapCenter().subscribe(Xe=>{null!=Xe?(this.logging.log("Map centre/zoom changed, updating search position:"+Xe),this.updateMapCentrePos(Xe.coords.latitude,Xe.coords.longitude,!1)):this.logging.log("Map centre/zoom changed - map not ready to change centre pos:")})},300,!1)}setParentAppContext(Ke){this.parentAppContext=Ke}setMapAPI(Ke){this.mapOptions.mapAPI=Ke,this.mapOptions.mapAPI==y.b.MAPBOX&&(this.mapProvider=new d.k(this.events,this.logging,this.http)),this.mapOptions.mapAPI==y.b.MAPKIT_JS&&(this.mapProvider=new De(this.events,this.logging)),this.mapOptions.mapAPI==y.b.MAPTILER&&(this.mapProvider=new we(this.events,this.logging,this.http))}isMapReady(){return null!=this.mapProvider&&this.mapProvider.mapReady}externalAPILoaded(Ke){this.mapAPIReady=!0,this.logging.log("Mapping API Loaded: "+y.b[Ke])}initMap(Ke){if(!this.isMapReady())if(null!=this.mapProvider)this.mapsInitialised&&this.logging.log("initMap: Map provider already initialised"),this.logging.log("Mapping Manager: Init "+y.b[this.mapProvider.mapAPIType]),this.mapProvider.initMap(Ke,this.mapOptions,this);else{if(this.mapsInitialised)return void this.logging.log("initMap: map already initialised");this.logging.log("initMap: "+this.mapOptions.mapAPI)}}mapManipulationPerformed(Ke){this.logging.log("map manipulated:"+Ke),("drag"==Ke||"zoom"==Ke)&&this.debouncedMapPositionUpdate()}updateMapSize(){this.mapProvider&&this.mapProvider.refreshMapLayout()}updateMapCentrePos(Ke,Oe,Ce,nt){Ce&&null!=this.mapProvider&&this.mapProvider.setMapCenter(new w.jR(Ke,Oe),nt),this.mapOptions.mapCentre=new w.jR(Ke,Oe)}moveToMapBounds(Ke){this.mapProvider.moveToMapBounds(Ke)}refreshMapView(Ke,Oe,Ce){return null!=this.mapProvider?(this.logging.log("Mapping Manager: renderMap "+y.b[this.mapProvider.mapAPIType]),this.isMapReady()?this.mapProvider.renderMap(Oe,Ke,this.parentAppContext):this.logging.log("refreshMapView: map provider not initialised..")):this.logging.log("Unsupported Map API: refreshMapView",Q.i.ERROR),!0}setMapType(Ke){this.mapOptions.mapType!=Ke&&(this.mapOptions.mapType=Ke,this.isMapReady()&&null!=this.mapProvider?(this.logging.log("Changing map type:"+Ke),this.mapProvider.setMapType(Ke)):this.logging.log("Map type set, maps not initialised yet."))}unfocusMap(){this.logging.log("[mapping] Unfocus Map."),this.isFocused=!1,this.mapProvider.unfocusMap()}focusMap(){this.logging.log("[mapping] Focus Map."),this.isFocused=!0,this.mapProvider.focusMap()}getMapBounds(){return this.mapProvider.getMapBounds()}getMapZoom(){return this.mapProvider.getMapZoom()}setMapZoom(Ke){this.mapProvider.setMapZoom(Ke)}getMapCenter(){return this.mapProvider.getMapCenter()}showPOIOnStaticMap(Ke,Oe,Ce=!1,nt=!1,Xe=200,Ee=200){let ae=document.getElementById(Ke);if(null!=ae){let xe=Oe.AddressInfo.Latitude,Ze=Oe.AddressInfo.Longitude;Xe>640&&(Xe=640),Ee>640&&(Ee=640);let Se=Xe,ye=Ee,Qt="https://maps.googleapis.com/maps/api/staticmap?center="+xe+","+Ze+"&zoom=14&size="+Se+"x"+ye+"&maptype=roadmap&markers=color:blue%7Clabel:A%7C"+xe+","+Ze+"&sensor=false",dt="";dt+=1==Ce?"<div>"+s.c.formatMapLink(Oe,'<div><img width="'+Se+'" height="'+ye+'" src="'+Qt+'" /></div>',nt)+"</div>":'<div><img width="'+Se+'" height="'+ye+'" src="'+Qt+'" /></div>',ae.innerHTML=dt}}renderPolyline(Ke){this.mapProvider.renderPolyline(Ke)}clearPolyline(){this.mapProvider.clearPolyline()}clearMarkers(){this.logging.log("mapping: clearing markers"),this.mapProvider.clearMarkers()}addPOILayer(Ke){this.mapProvider.addPOILayer(Ke)}}return(0,v.Z)(Me,"\u0275fac",function(Ke){return new(Ke||Me)(se.LFG(Te.z),se.LFG(Q.z),se.LFG(ge.eN))}),(0,v.Z)(Me,"\u0275prov",se.Yz7({token:Me,factory:Me.\u0275fac,providedIn:"root"})),Me})()},3955:(zn,Ct,R)=>{"use strict";R.d(Ct,{_:()=>s,b:()=>y});var v=R(1180),d=R(553),y=(()=>((y=y||{})[y.GOOGLE_WEB=1]="GOOGLE_WEB",y[y.GOOGLE_NATIVE=2]="GOOGLE_NATIVE",y[y.LEAFLET=3]="LEAFLET",y[y.MAPBOX=4]="MAPBOX",y[y.MAPKIT_JS=5]="MAPKIT_JS",y[y.MAPTILER=6]="MAPTILER",y))();class s{constructor(){(0,v.Z)(this,"enableClustering",void 0),(0,v.Z)(this,"resultBatchID",void 0),(0,v.Z)(this,"useMarkerIcons",void 0),(0,v.Z)(this,"useMarkerAnimation",void 0),(0,v.Z)(this,"enableTrackingMapCentre",void 0),(0,v.Z)(this,"enableSearchByWatchingLocation",void 0),(0,v.Z)(this,"mapCentre",void 0),(0,v.Z)(this,"searchDistanceKM",void 0),(0,v.Z)(this,"iconSet",void 0),(0,v.Z)(this,"mapAPI",void 0),(0,v.Z)(this,"mapMoveQueryRefreshMS",void 0),(0,v.Z)(this,"requestSearchUpdate",void 0),(0,v.Z)(this,"enableSearchRadiusIndicator",void 0),(0,v.Z)(this,"mapType",void 0),(0,v.Z)(this,"minZoomLevel",void 0),(0,v.Z)(this,"onMapMoveCompleted",void 0),this.enableClustering=!1,this.resultBatchID=-1,this.useMarkerIcons=!0,this.useMarkerAnimation=!0,this.enableTrackingMapCentre=!1,this.enableSearchByWatchingLocation=!1,this.mapCentre=null,this.mapAPI=d.N.defaultMapProvider,this.mapType="ROADMAP",this.searchDistanceKM=1e5,this.mapMoveQueryRefreshMS=300,this.enableSearchRadiusIndicator=!1,this.minZoomLevel=2}}},9903:(zn,Ct,R)=>{"use strict";R.d(Ct,{k:()=>we});var v=R(5861),d=R(1180),y=R(866),s=R(3955),Q=R(5592),ie=R(3052),W=R(9127),w=R(2574),Ae=R(553),De=R(2117),X=R(2029),se=R(5957),Te=R(9862);let we=(()=>{class Le{constructor(ze,Ke,Oe){(0,d.Z)(this,"events",void 0),(0,d.Z)(this,"logging",void 0),(0,d.Z)(this,"http",void 0),(0,d.Z)(this,"mapAPIType",void 0),(0,d.Z)(this,"mapReady",void 0),(0,d.Z)(this,"providerError",void 0),(0,d.Z)(this,"mapCanvasID",void 0),(0,d.Z)(this,"map",void 0),(0,d.Z)(this,"markerList",void 0),(0,d.Z)(this,"polylinePath",void 0),(0,d.Z)(this,"_isMapAnimating",!1),(0,d.Z)(this,"searchMarker",void 0),(0,d.Z)(this,"mapTileSet",void 0),this.events=ze,this.logging=Ke,this.http=Oe,this.events=ze,this.mapAPIType=s.b.MAPBOX,this.mapReady=!1,this.markerList=new Map}initAPI(){w&&(w.accessToken=Ae.N.mapBoxToken)}disposeMap(){this.map&&(this.logging.log("Disposing map",W.i.INFO),this.map.remove())}getCurrentMapTileSet(ze){return"SATELLITE"==ze?"mapbox://styles/mapbox/satellite-streets-v12?optimize=true":"mapbox://styles/mapbox/streets-v12?optimize=true"}flyAroundPoint(ze){if(this._isMapAnimating){this.map.rotateTo(ze/100%360,{duration:0});const Ke=this;requestAnimationFrame(function(Oe){Ke.flyAroundPoint(Oe)})}}initMap(ze,Ke,Oe){this.mapCanvasID=ze;let Ce=!0;if(Ce=!(typeof w>"u"),!Ce)return this.logging.log("Call to initMap before API is ready:"+s.b[this.mapAPIType],W.i.ERROR),this.mapReady=!1,!1;if(null==this.map){let ae=function(xe){return xe*(2-xe)};document.getElementById(ze),this.initAPI(),this.map=new w.Map({container:ze,style:this.getCurrentMapTileSet(Ke.mapType),zoom:15,attributionControl:!1}),this.map.addControl(new w.AttributionControl({compact:!0,customAttribution:["Open Charge Map Contributors"]})),this.map.addControl(new w.NavigationControl),this.mapReady=!0,this.map.getCanvas().focus();let Xe=100,Ee=25;this.map.getCanvas().addEventListener("keydown",xe=>{xe.preventDefault(),38===xe.which?this.map.panBy([0,-Xe],{easing:ae}):40===xe.which?this.map.panBy([0,Xe],{easing:ae}):37===xe.which?this.map.easeTo({bearing:this.map.getBearing()-Ee,easing:ae}):39===xe.which?this.map.easeTo({bearing:this.map.getBearing()+Ee,easing:ae}):32===xe.which&&(this._isMapAnimating?this._isMapAnimating=!1:(this._isMapAnimating=!0,this.flyAroundPoint(0)))},!0),this.map.on("load",()=>{this.events.publish("ocm:mapping:ready")});let mt=y.c.debounce(()=>{this.getMapCenter().subscribe(xe=>{this.searchMarker.setLngLat(new w.LngLat(xe.coords.longitude,xe.coords.latitude))})},500,!1);this.map.on("move",()=>{this.searchMarker&&mt()}),this.map.on("moveend",()=>{this.events.publish("ocm:mapping:dragend"),Ke.onMapMoveCompleted&&Ke.onMapMoveCompleted()}),this.map.on("zoomend",()=>{this.events.publish("ocm:mapping:zoom")})}}clearMarkers(){null!=this.markerList&&this.markerList.forEach((ze,Ke)=>{ze.remove()}),this.markerList=new Map}showPOIListOnMap(ze,Ke,Oe=!0){let nt=this.map,Xe=new w.LngLatBounds,Ee=0;if(nt.getZoom(),null!=ze){for(let Se=0;Se<ze.length;Se++)if(null!=ze[Se].AddressInfo&&null!=ze[Se].AddressInfo.Latitude&&null!=ze[Se].AddressInfo.Longitude){let ye=ze[Se],Qt=!0;if(null!=this.markerList&&this.markerList.has(ye.ID)){Qt=!1;let dt=this.markerList.get(ye.ID);dt&&dt.poi&&dt.poi.DateLastStatusUpdate!=ye.DateLastStatusUpdate&&(dt.remove(),Qt=!0)}if(Qt){let dt=null,gt=null;Oe?(dt=document.createElement("img"),dt.src=y.c.getIconForPOI(ye),dt.width=34,dt.height=50):(dt=null,gt=y.c.getColorForPOI(ye));let Ue=(Oe?"OCM-":"EXT-")+ye.ID+": "+ye.AddressInfo.Title+":";null!=ye.UsageType&&(Ue+=" "+ye.UsageType.Title),null!=ye.StatusType&&(Ue+=" "+ye.StatusType.Title);let vt=new w.Marker({element:dt,color:gt,anchor:"bottom"}).setLngLat([ye.AddressInfo.Longitude,ye.AddressInfo.Latitude]).addTo(nt);vt.poi=ye;let je=vt.getElement();je.poi=ye,je.addEventListener("click",_t=>{const Ne=_t.currentTarget.poi;this.events.publish("ocm:poi:selected",{poiId:Ne.ID,poi:Ne})}),Xe.extend(vt.getLngLat()),this.markerList.set(ye.ID,vt),Ee++}}this.logging.log(Ee+" new map markers added out of a total "+this.markerList.size)}if(null!=ze&&ze.length>0)if(null==Ke||Ke.appConfig.enableLiveMapQuerying)null==nt.getCenter()&&nt.setCenter(Xe.getCenter());else{this.logging.log("Fitting to marker bounds:"+Xe),nt.setCenter(Xe.getCenter()),this.logging.log("zoom before fit bounds:"+nt.getZoom()),nt.fitBounds(Xe);let Ze=nt.getZoom();nt.setZoom(Ze<6?6:Ze)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapBoxGL: refreshMapLayout",W.i.VERBOSE),this.map.resize()},200)}setMapCenter(ze){this.mapReady&&(this.map.setCenter(new w.LngLat(ze.coords.longitude,ze.coords.latitude)),this.searchMarker||(this.searchMarker=new w.Marker({color:"#99ccff",anchor:"bottom"}).setLngLat(new w.LngLat(ze.coords.longitude,ze.coords.latitude)).addTo(this.map),this.searchMarker.getElement().addEventListener("click",()=>{let Ke=this.searchMarker.getLngLat();this.events.publish("ocm:mapping:addpoi",new ie.wC(Ke.lat,Ke.lng))})))}getMapCenter(){return new Q.y(Ke=>{if(null!=this.map){let Oe=this.map.getCenter();null!=Oe&&(Ke.next(new ie.jR(Oe.lat,Oe.lng)),Ke.complete())}})}setMapZoom(ze){this.map.setZoom(ze)}getMapZoom(){return new Q.y(Ke=>{let Oe=this.map.getZoom();Ke.next(Oe),Ke.complete()})}setMapType(ze){this.map.setStyle(this.getCurrentMapTileSet(ze))}getMapBounds(){return new Q.y(Ke=>{let Oe=new Array,Ce=this.map.getBounds();Oe.push(new ie.wC(Ce.getSouthWest().lat,Ce.getSouthWest().lng)),Oe.push(new ie.wC(Ce.getNorthEast().lat,Ce.getNorthEast().lng)),Ke.next(Oe),Ke.complete()})}moveToMapBounds(ze){this.map.fitBounds(new w.LngLatBounds(new w.LngLat(ze.southWest.longitude,ze.southWest.latitude),new w.LngLat(ze.northEast.longitude,ze.northEast.latitude)))}renderMap(ze,Ke,Oe){return document.getElementById(this.mapCanvasID).style.height=Ke+"px",this.mapReady&&this.showPOIListOnMap(ze,Oe),!0}renderPolyline(ze){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(ze,Ke,Oe){var Ce=this;return(0,v.Z)(function*(){let nt=`https://api.mapbox.com/geocoding/v5/mapbox.places/${ze||Oe+","+Ke}.json?access_token=${Ae.N.mapBoxToken}`;return new Promise(function(){var Xe=(0,v.Z)(function*(Ee,ae){Ce.http.get(nt).toPromise().then(mt=>{let xe=[];xe=[],mt.features&&mt.features.map(Ze=>{let Se=new De.n;Se.Title=Ze.place_name,Se.Address=Ze.place_name,Se.Type="place",Se.Location=new ie.wC(Ze.center[1],Ze.center[0]),Se.Attribution=mt.attribution,xe.push(Se)}),Ee(xe)})});return function(Ee,ae){return Xe.apply(this,arguments)}}())})()}addPOILayer(ze){this.logging.log("Add POI Layer not implemented in this provider."),this.showPOIListOnMap(ze,null,!1)}}return(0,d.Z)(Le,"\u0275fac",function(ze){return new(ze||Le)(X.LFG(se.z),X.LFG(W.z),X.LFG(Te.eN))}),(0,d.Z)(Le,"\u0275prov",X.Yz7({token:Le,factory:Le.\u0275fac})),Le})()},553:(zn,Ct,R)=>{"use strict";R.d(Ct,{N:()=>v});const v={name:"prod",version:"8.5.5",production:!0,analyticsId:"",googleMapsKey:"",mapBoxToken:"pk.eyJ1Ijoid2VicHJvZnVzaW9uIiwiYSI6ImNrdHZlc2N5dTI5Zjcydm8zYWFwc2JnbTMifQ.M7b5SOzbPcg_8XAHCOeP0w",mapKitToken:"",enableStaticMaps:!1,defaultMapProvider:4,apiBase:"https://api.openchargemap.io",apiKey:"9bb03e5b-0fb2-4916-9b2b-26c6bd27a56a",enabledFeatures:["MAP","ADD_COMMENT","ADD_PHOTO","FAVOURITES","FILTER_OPTIONS_BY_COUNTRY","ADD_POI","EDIT_POI","LAYERS"]}},248:(zn,Ct,R)=>{"use strict";var v=R(6593),d=R(2029),y=R(1180),s=R(5086),Q=R(3999),ie=R(6814),W=R(6223),w=R(7852);let fe=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn})),(0,y.Z)(hn,"\u0275inj",d.cJS({imports:[ie.ez,W.u5,w.Pc,Q.aw,s.e]})),hn})(),Ae=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn})),(0,y.Z)(hn,"\u0275inj",d.cJS({imports:[ie.ez,W.u5,w.Pc,Q.aw,s.e]})),hn})(),De=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn})),(0,y.Z)(hn,"\u0275inj",d.cJS({imports:[ie.ez,W.u5,w.Pc,Q.aw,s.e]})),hn})();var X=R(4606),se=R(9862),Te=R(2125),ge=R(6091);class we{constructor(gi,Yt="/assets/i18n/",Un=".json"){(0,y.Z)(this,"http",void 0),(0,y.Z)(this,"prefix",void 0),(0,y.Z)(this,"suffix",void 0),this.http=gi,this.prefix=Yt,this.suffix=Un}getTranslation(gi){return this.http.get(`${this.prefix}${gi}${this.suffix}`)}}var Le=R(5861),Me=R(1847),ze=R(3247),Ke=R(8767),Oe=R(4292),Ce=R(1618);function nt(hn,gi){if(1&hn){const Yt=d.EpF();d.TgZ(0,"div"),d._uU(1," You are not signed in. "),d.TgZ(2,"button",5),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.showSignInModal())}),d._uU(3),d.ALo(4,"translate"),d.qZA()()}2&hn&&(d.xp6(3),d.Oqu(d.lcZ(4,1,"ocm.general.signIn")))}function Xe(hn,gi){if(1&hn&&(d.TgZ(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-avatar",6),d._UZ(4,"img",7),d.qZA(),d.TgZ(5,"h2"),d._uU(6),d.qZA()(),d.TgZ(7,"ion-card-content")(8,"p"),d._uU(9),d.qZA(),d.TgZ(10,"p"),d._uU(11),d.qZA()(),d.TgZ(12,"ion-item")(13,"ion-note",8),d._UZ(14,"ion-icon",9),d._uU(15),d.qZA()()()()),2&hn){const Yt=d.oxw();d.xp6(4),d.s9C("src",Yt.userProfile.ProfileImageURL,d.LSH),d.xp6(2),d.Oqu(Yt.userProfile.Username),d.xp6(3),d.hij(" ",Yt.userProfile.Profile,""),d.xp6(2),d.hij(" Date Joined: ",Yt.userProfile.DateCreated," "),d.xp6(4),d.hij(" ",Yt.userProfile.ReputationPoints," Contributor Points ")}}let Ee=(()=>{class hn{constructor(Yt,Un,oi,Ci){(0,y.Z)(this,"appManager",void 0),(0,y.Z)(this,"nav",void 0),(0,y.Z)(this,"translate",void 0),(0,y.Z)(this,"modalController",void 0),(0,y.Z)(this,"userProfile",void 0),this.appManager=Yt,this.nav=Un,this.translate=oi,this.modalController=Ci}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),null!=this.userProfile&&this.appManager.isUserAuthenticated(!0)?this.refreshProfileView():this.showSignInModal(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:Ke.F,componentProps:{Profile:this.userProfile}}).then(Yt=>{Yt.onDidDismiss().then(()=>{this.refreshProfileView()}),Yt.present()})}close(){this.modalController.dismiss()}}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)(d.Y36(Ce.c),d.Y36(w.SH),d.Y36(Q.sK),d.Y36(w.IN))}),(0,y.Z)(hn,"\u0275cmp",d.Xpm({type:hn,selectors:[["ng-component"]],decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(Yt,Un){1&Yt&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d._uU(3),d.ALo(4,"translate"),d.qZA()()(),d.TgZ(5,"ion-content",0),d.YNc(6,nt,5,3,"div",1),d.YNc(7,Xe,16,5,"div",1),d.qZA(),d.TgZ(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",2)(11,"ion-button",3),d.NdJ("click",function(){return Un.close()}),d._UZ(12,"ion-icon",4),d._uU(13," Close "),d.qZA()()()()),2&Yt&&(d.xp6(3),d.hij(" ",d.lcZ(4,3,"ocm.navigation.profile.sectionTitle")," "),d.xp6(3),d.Q6J("ngIf",null==Un.userProfile),d.xp6(1),d.Q6J("ngIf",null!=Un.userProfile))},dependencies:[ie.O5,w.BJ,w.YG,w.Sm,w.PM,w.FN,w.W2,w.fr,w.Gu,w.gu,w.Ie,w.uN,w.wd,w.sr,Q.X$],encapsulation:2})),hn})();var ae=R(9127),mt=R(553),xe=R(6662),Ze=R(3294),Se=R(866),ye=R(9236),Qt=R(8062),dt=R(2726);const gt=(0,dt.fo)("PushNotifications",{}),ct=(0,dt.fo)("StatusBar"),Ue=(0,dt.fo)("SplashScreen",{web:()=>R.e(4485).then(R.bind(R,4485)).then(hn=>new hn.SplashScreenWeb)}),vt=(0,dt.fo)("App",{web:()=>R.e(2912).then(R.bind(R,2912)).then(hn=>new hn.AppWeb)});var je=R(5957);function _t(hn,gi){if(1&hn){const Yt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.openRoutePlannerModal())}),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-label"),d._uU(3," Route Planner "),d.qZA()()}}function Ne(hn,gi){if(1&hn){const Yt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.add())}),d._UZ(1,"ion-icon",13),d.TgZ(2,"ion-label"),d._uU(3),d.ALo(4,"translate"),d.qZA()()}2&hn&&(d.xp6(3),d.hij(" ",d.lcZ(4,1,"ocm.general.addLocation")," "))}function Ft(hn,gi){if(1&hn){const Yt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.journeys())}),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-label"),d._uU(3," Journeys "),d.qZA()()}}function Gt(hn,gi){if(1&hn){const Yt=d.EpF();d.TgZ(0,"ion-item",9),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.addLayer())}),d._UZ(1,"ion-icon",14),d.TgZ(2,"ion-label"),d._uU(3," Add Layer "),d.qZA()()}}function wn(hn,gi){if(1&hn){const Yt=d.EpF();d.ynx(0),d.TgZ(1,"ion-item",9),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.signIn())}),d._UZ(2,"ion-icon",15),d.TgZ(3,"ion-label"),d._uU(4),d.ALo(5,"translate"),d.qZA()(),d.BQk()}2&hn&&(d.xp6(4),d.hij(" ",d.lcZ(5,1,"ocm.general.signIn")," "))}function Xt(hn,gi){if(1&hn){const Yt=d.EpF();d.ynx(0),d.TgZ(1,"ion-item",9),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.profile())}),d._UZ(2,"ion-icon",15),d.TgZ(3,"ion-label"),d._uU(4),d.ALo(5,"translate"),d.qZA()(),d.TgZ(6,"ion-item",9),d.NdJ("click",function(){d.CHM(Yt);const oi=d.oxw();return d.KtG(oi.signOut())}),d._UZ(7,"ion-icon",16),d.TgZ(8,"ion-label"),d._uU(9),d.ALo(10,"translate"),d._UZ(11,"br"),d.TgZ(12,"small",17),d._uU(13),d.qZA()()(),d.BQk()}if(2&hn){const Yt=d.oxw();d.xp6(4),d.hij(" ",d.lcZ(5,3,"ocm.navigation.profile.sectionTitle")," "),d.xp6(5),d.hij(" ",d.lcZ(10,5,"ocm.general.signOut")," "),d.xp6(4),d.hij(" ",Yt.getUserName(),"")}}const mn=function(){return["/search"]};let sn=(()=>{class hn{constructor(Yt,Un,oi,Ci,Oi,Po,fi,Vo){(0,y.Z)(this,"platform",void 0),(0,y.Z)(this,"translate",void 0),(0,y.Z)(this,"mapping",void 0),(0,y.Z)(this,"modalController",void 0),(0,y.Z)(this,"appManager",void 0),(0,y.Z)(this,"logger",void 0),(0,y.Z)(this,"analytics",void 0),(0,y.Z)(this,"events",void 0),(0,y.Z)(this,"enabledFeatures",void 0),this.platform=Yt,this.translate=Un,this.mapping=oi,this.modalController=Ci,this.appManager=Oi,this.logger=Po,this.analytics=fi,this.events=Vo,this.logger.log("Environment: "+mt.N.name),this.initializeApp(),this.enabledFeatures=mt.N.enabledFeatures,1!=Oi.searchSettings.EnableAdvancedEditorFeatures&&(this.enabledFeatures=this.enabledFeatures.filter(ut=>"LAYERS"!=ut))}configurePushNotifications(){gt.register(),gt.addListener("registration",Yt=>{this.logger.log("Push registration success, token: "+Yt.value),this.appManager.savePushRegistration(Yt.value)}),gt.addListener("registrationError",Yt=>{this.logger.log("Error on registration: "+JSON.stringify(Yt))}),gt.addListener("pushNotificationReceived",Yt=>{this.logger.log("Push received: "+JSON.stringify(Yt),ae.i.INFO)}),gt.addListener("pushNotificationActionPerformed",Yt=>{this.logger.log("Push action performed: "+JSON.stringify(Yt))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let Yt=this.appManager.getUserProfile();return Yt?Yt.EmailAddress?Yt.EmailAddress:Yt.Username:"Not Signed In"}initializeApp(){var Yt=this;this.platform.ready().then(()=>{this.platform.is("capacitor")&&(ct.show(),Ue.hide()),this.translate.addLangs(this.appManager.getLanguages().map(Un=>Un.code)),this.translate.setDefaultLang("en"),null!=this.appManager.searchSettings.Language?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(Un=>{}),this.analytics.init(mt.N.analyticsId).then(()=>{this.analytics.setAppVersion(mt.N.version),this.analytics.appEvent("Startup","App Loaded")}).catch(Un=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",function(){var Un=(0,Le.Z)(function*(oi){Se.c.isFeatureEnabled("ADD_POI")&&Yt.add(oi)});return function(oi){return Un.apply(this,arguments)}}()),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return(0,Le.Z)(function*(){vt.addListener("appUrlOpen",Un=>{alert("App (re)opened with URL: "+Un.url)});let Yt=yield vt.getLaunchUrl();Yt&&Yt.url&&alert("App opened with URL: "+Yt.url)})()}openRoutePlannerModal(){var Yt=this;return(0,Le.Z)(function*(){Yt.mapping.unfocusMap();const Un=yield Yt.modalController.create({component:ze.u});Un.onDidDismiss().then(oi=>{Yt.mapping.focusMap()}),yield Un.present()})()}continueAdd(Yt){var Un=this;return(0,Le.Z)(function*(){const oi=yield Un.modalController.create({component:xe.Y,componentProps:{startPos:Yt}});oi.onDidDismiss().then(Ci=>{Un.mapping.focusMap()}),yield oi.present()})()}add(Yt){var Un=this;return(0,Le.Z)(function*(){if(Un.mapping.unfocusMap(),!Un.appManager.isUserAuthenticated(!0)){const oi=yield Un.modalController.create({component:Ke.F});return oi.onDidDismiss().then(function(){var Ci=(0,Le.Z)(function*(Oi){Un.mapping.focusMap(),Un.appManager.isUserAuthenticated(!0)&&(yield Un.continueAdd(Yt))});return function(Oi){return Ci.apply(this,arguments)}}()),yield oi.present()}yield Un.continueAdd(Yt)})()}signIn(){var Yt=this;return(0,Le.Z)(function*(){Yt.mapping.unfocusMap();const Un=yield Yt.modalController.create({component:Ke.F});return Un.onDidDismiss().then(oi=>{Yt.mapping.focusMap(),Yt.appManager.isUserAuthenticated(!0)}),yield Un.present()})()}signOut(){var Yt=this;return(0,Le.Z)(function*(){Yt.appManager.signOutCurrentUser()})()}profile(){var Yt=this;return(0,Le.Z)(function*(){Yt.mapping.unfocusMap();const Un=yield Yt.modalController.create({component:Ee});Un.onDidDismiss().then(oi=>{Yt.mapping.focusMap()}),yield Un.present()})()}journeys(){var Yt=this;return(0,Le.Z)(function*(){Yt.mapping.unfocusMap();const Un=yield Yt.modalController.create({component:Oe.g});Un.onDidDismiss().then(oi=>{Yt.mapping.focusMap()}),yield Un.present()})()}addLayer(){var Yt=this;return(0,Le.Z)(function*(){const Un=yield Yt.modalController.create({component:Qt.A});yield Un.present();const{data:oi}=yield Un.onWillDismiss();oi&&Yt.mapping.addPOILayer(oi)})()}about(){var Yt=this;return(0,Le.Z)(function*(){Yt.mapping.unfocusMap();const Un=yield Yt.modalController.create({component:ye.t});Un.onDidDismiss().then(oi=>{Yt.mapping.focusMap()}),yield Un.present()})()}}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)(d.Y36(w.t4),d.Y36(Q.sK),d.Y36(Me.v),d.Y36(w.IN),d.Y36(Ce.c),d.Y36(ae.z),d.Y36(Ze.c),d.Y36(je.z))}),(0,y.Z)(hn,"\u0275cmp",d.Xpm({type:hn,selectors:[["app-root"]],decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(Yt,Un){1&Yt&&(d.TgZ(0,"ion-app")(1,"ion-split-pane",0)(2,"ion-menu",1)(3,"ion-header")(4,"ion-toolbar")(5,"ion-thumbnail",2),d._UZ(6,"img",3),d.qZA(),d.TgZ(7,"ion-title"),d._uU(8),d.qZA()()(),d.TgZ(9,"ion-content")(10,"ion-list")(11,"ion-menu-toggle",4)(12,"ion-item",5),d._UZ(13,"ion-icon",6),d.TgZ(14,"ion-label"),d._uU(15),d.ALo(16,"translate"),d.qZA()(),d.YNc(17,_t,4,0,"ion-item",7),d.YNc(18,Ne,5,3,"ion-item",7),d.YNc(19,Ft,4,0,"ion-item",7),d.YNc(20,Gt,4,0,"ion-item",7),d.YNc(21,wn,6,3,"ng-container",8),d.YNc(22,Xt,14,7,"ng-container",8),d.TgZ(23,"ion-item",9),d.NdJ("click",function(){return Un.about()}),d._UZ(24,"ion-icon",10),d.TgZ(25,"ion-label"),d._uU(26),d.ALo(27,"translate"),d.qZA()()()()()(),d._UZ(28,"ion-router-outlet",11),d.qZA()()),2&Yt&&(d.xp6(1),d.Q6J("disabled",!0),d.xp6(7),d.Oqu(Un.appManager.title),d.xp6(4),d.Q6J("routerDirection","root")("routerLink",d.DdM(16,mn)),d.xp6(3),d.hij(" ",d.lcZ(16,12,"ocm.search.sectionTitle")," "),d.xp6(2),d.Q6J("ngIf",Un.enabledFeatures.includes("ROUTE_PLANNER")),d.xp6(1),d.Q6J("ngIf",Un.enabledFeatures.includes("ADD_POI")),d.xp6(1),d.Q6J("ngIf",Un.enabledFeatures.includes("FAVOURITES")),d.xp6(1),d.Q6J("ngIf",Un.enabledFeatures.includes("LAYERS")),d.xp6(1),d.Q6J("ngIf",!Un.isUserAuthenticated()),d.xp6(1),d.Q6J("ngIf",Un.isUserAuthenticated()),d.xp6(4),d.hij(" ",d.lcZ(27,14,"ocm.general.about")," "))},dependencies:[ie.O5,w.dr,w.W2,w.Gu,w.gu,w.Ie,w.Q$,w.q_,w.z0,w.zc,w.jI,w.Bs,w.wd,w.sr,w.jP,w.YI,Te.rH,Q.X$],encapsulation:2})),hn})();const Vt=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>Promise.resolve().then(R.bind(R,4606)).then(hn=>hn.SearchPageModule)},{path:"journeys",loadChildren:()=>Promise.resolve().then(R.bind(R,9192)).then(hn=>hn.JourneysModule)},{path:"signin",loadChildren:()=>Promise.resolve().then(R.bind(R,9472)).then(hn=>hn.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>Promise.resolve().then(R.bind(R,5722)).then(hn=>hn.PoiEditorPageModule)},{path:"about",loadChildren:()=>Promise.resolve().then(R.bind(R,7425)).then(hn=>hn.AboutPageModule)},{path:"layer-editor",loadChildren:()=>Promise.resolve().then(R.bind(R,2309)).then(hn=>hn.LayerEditorPageModule)}];let It=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn})),(0,y.Z)(hn,"\u0275inj",d.cJS({imports:[Te.Bz.forRoot(Vt,{useHash:!0}),Te.Bz]})),hn})(),at=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn})),(0,y.Z)(hn,"\u0275inj",d.cJS({imports:[ie.ez,W.u5,w.Pc,Q.aw,s.e]})),hn})();var Wt=R(9472);let dn=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn})),(0,y.Z)(hn,"\u0275inj",d.cJS({imports:[ie.ez,W.u5,w.Pc,Q.aw,s.e,Te.Bz.forChild([{path:"",component:Ee}])]})),hn})();var Sn=R(4119);let Nt=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn})),(0,y.Z)(hn,"\u0275inj",d.cJS({imports:[ie.ez,W.u5,w.Pc,Q.aw,s.e,Te.Bz.forChild([{path:"",component:Sn.N}])]})),hn})();var yi=R(9192),Gi=R(5722),gn=R(7425),si=R(2309);function Je(){return localStorage.getItem("access_token")}function At(hn){return new we(hn,"/assets/i18n/",".json")}let un=(()=>{class hn{}return(0,y.Z)(hn,"\u0275fac",function(Yt){return new(Yt||hn)}),(0,y.Z)(hn,"\u0275mod",d.oAB({type:hn,bootstrap:[sn]})),(0,y.Z)(hn,"\u0275inj",d.cJS({providers:[{provide:Te.wN,useClass:w.r4}],imports:[v.b2,se.JF,Q.aw.forRoot({loader:{provide:Q.Zw,useFactory:At,deps:[se.eN]}}),w.Pc.forRoot(),It,ge.Ar.forRoot({config:{tokenGetter:Je}}),X.SearchPageModule,at,yi.JourneysModule,Wt.SignInModule,De,fe,Ae,Gi.PoiEditorPageModule,dn,Nt,gn.AboutPageModule,si.LayerEditorPageModule]})),hn})();mt.N.production&&(0,d.G48)(),v.q6().bootstrapModule(un).catch(hn=>console.log(hn))},2574:function(zn){zn.exports=function(){"use strict";var Ct,R,v;function d(s,Q){if(Ct)if(R){var ie="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Ct+")(sharedChunk); ("+R+")(sharedChunk); self.onerror = null;",W={};Ct(W),v=Q(W),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(v.workerUrl=window.URL.createObjectURL(new Blob([ie],{type:"text/javascript"})))}else R=Q;else Ct=Q}return d(0,function(s){var Q=typeof self<"u"?self:{},ie="2.15.0";let W;const w={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==W){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{W=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch{W=t}}return W},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!w.API_URL)return null;try{const t=new URL(w.API_URL);return"api.mapbox.cn"===t.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===t.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},fe={supported:!1,testSupport:function(t){!X&&De&&(se?Te(t):Ae=t)}};let Ae,De,X=!1,se=!1;function Te(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,De),t.isContextLost())return;fe.supported=!0}catch{}t.deleteTexture(e),X=!0}Q.document&&(De=Q.document.createElement("img"),De.onload=function(){Ae&&Te(Ae),Ae=null,se=!0},De.onerror=function(){X=!0,Ae=null},De.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ge="01";function we(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Le=Me;function Me(t,e,i,a){this.cx=3*t,this.bx=3*(i-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=i,this.p2y=a}Me.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var i=t,a=0;a<8;a++){var u=this.sampleCurveX(i)-t;if(Math.abs(u)<e)return i;var f=this.sampleCurveDerivativeX(i);if(Math.abs(f)<1e-6)break;i-=u/f}var _=0,b=1;for(i=t,a=0;a<20&&(u=this.sampleCurveX(i),!(Math.abs(u-t)<e));a++)t>u?_=i:b=i,i=.5*(b-_)+_;return i},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var ze=we(Le),Ke=Oe;function Oe(t,e){this.x=t,this.y=e}Oe.prototype={clone:function(){return new Oe(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,i=t.y-this.y;return e*e+i*i},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),i=Math.sin(t),a=i*this.x+e*this.y;return this.x=e*this.x-i*this.y,this.y=a,this},_rotateAround:function(t,e){var i=Math.cos(t),a=Math.sin(t),u=e.y+a*(this.x-e.x)+i*(this.y-e.y);return this.x=e.x+i*(this.x-e.x)-a*(this.y-e.y),this.y=u,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Oe.convert=function(t){return t instanceof Oe?t:Array.isArray(t)?new Oe(t[0],t[1]):t};var Ce=we(Ke);const nt=Math.PI/180,Xe=180/Math.PI;function Ee(t){return t*nt}function ae(t){return t*Xe}const mt=[[0,0],[1,0],[1,1],[0,1]];function xe(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,i=e*t;return 4*(t<.5?i:3*(t-e)+i-.75)}function Ze(t,e,i,a){const u=new ze(t,e,i,a);return function(f){return u.solve(f)}}const Se=Ze(.25,.1,.25,1);function ye(t,e,i){return Math.min(i,Math.max(e,t))}function Qt(t,e,i){return(i=ye((i-t)/(e-t),0,1))*i*(3-2*i)}function dt(t,e,i){const a=i-e,u=((t-e)%a+a)%a+e;return u===e?i:u}function gt(t,e,i){if(!t.length)return i(null,[]);let a=t.length;const u=new Array(t.length);let f=null;t.forEach((_,b)=>{e(_,(E,D)=>{E&&(f=E),u[b]=D,0==--a&&i(f,u)})})}function ct(t){const e=[];for(const i in t)e.push(t[i]);return e}function Ue(t,...e){for(const i of e)for(const a in i)t[a]=i[a];return t}let vt=1;function je(){return vt++}function _t(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function Ne(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function Ft(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function Gt(t,e){t.forEach(i=>{e[i]&&(e[i]=e[i].bind(e))})}function wn(t,e){return-1!==t.indexOf(e,t.length-e.length)}function Xt(t,e,i){const a={};for(const u in t)a[u]=e.call(i||this,t[u],u,t);return a}function mn(t,e,i){const a={};for(const u in t)e.call(i||this,t[u],u,t)&&(a[u]=t[u]);return a}function sn(t){return Array.isArray(t)?t.map(sn):"object"==typeof t&&t?Xt(t,sn):t}const Vt={};function It(t){Vt[t]||(typeof console<"u"&&console.warn(t),Vt[t]=!0)}function at(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}function Wt(t){let e=0;for(let i,a,u=0,f=t.length,_=f-1;u<f;_=u++)i=t[u],a=t[_],e+=(a.x-i.x)*(i.y+a.y);return e}function dn(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Sn(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(i,a,u,f)=>{const _=u||f;return e[a]=!_||_.toLowerCase(),""}),e["max-age"]){const i=parseInt(e["max-age"],10);isNaN(i)?delete e["max-age"]:e["max-age"]=i}return e}let Nt=null;function yi(t){if(null==Nt){const e=t.navigator?t.navigator.userAgent:null;Nt=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Nt}function Gi(t){try{const e=Q[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function gn(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const si="mapbox-tiles";let Zt,un,Je=500,At=50;function hn(){try{return Q.caches}catch{}}function gi(){hn()&&!Zt&&(Zt=Q.caches.open(si))}function Yt(t){const e=t.indexOf("?");if(e<0)return t;const a=function(u){const f=u.indexOf("?");return f>0?u.slice(f+1).split("&"):[]}(t).filter(u=>{const f=u.split("=");return"language"===f[0]||"worldview"===f[0]});return a.length?`${t.slice(0,e)}?${a.join("&")}`:t.slice(0,e)}let Un=1/0;const oi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(oi);class Ci extends Error{constructor(e,i,a){401===i&&Ut(a)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=i,this.url=a}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Oi=dn()?()=>self.worker&&self.worker.referrer:()=>("blob:"===Q.location.protocol?Q.parent:Q).location.href,Po=function(t,e){if(!(/^file:/.test(i=t.url)||/^file:/.test(Oi())&&!/^\w+:/.test(i))){if(Q.fetch&&Q.Request&&Q.AbortController&&Q.Request.prototype.hasOwnProperty("signal"))return function(a,u){const f=new Q.AbortController,_=new Q.Request(a.url,{method:a.method||"GET",body:a.body,credentials:a.credentials,headers:a.headers,referrer:Oi(),referrerPolicy:a.referrerPolicy,signal:f.signal});let b=!1,E=!1;const D=(k=_.url).indexOf("sku=")>0&&Ut(k);var k;"json"===a.type&&_.headers.set("Accept","application/json");const z=(K,te,he)=>{if(E)return;if(K&&"SecurityError"!==K.message&&It(K.toString()),te&&he)return j(te);const Re=Date.now();Q.fetch(_).then(rt=>{if(rt.ok){const wt=D?rt.clone():null;return j(rt,wt,Re)}return u(new Ci(rt.statusText,rt.status,a.url))}).catch(rt=>{"AbortError"!==rt.name&&u(new Error(`${rt.message} ${a.url}`))})},j=(K,te,he)=>{("arrayBuffer"===a.type?K.arrayBuffer():"json"===a.type?K.json():K.text()).then(Re=>{E||(te&&he&&function(rt,wt,lt){if(gi(),!Zt)return;const bt={status:wt.status,statusText:wt.statusText,headers:new Q.Headers};wt.headers.forEach((cn,on)=>bt.headers.set(on,cn));const Mt=Sn(wt.headers.get("Cache-Control")||"");if(Mt["no-store"])return;Mt["max-age"]&&bt.headers.set("Expires",new Date(lt+1e3*Mt["max-age"]).toUTCString());const Dt=bt.headers.get("Expires");Dt&&(new Date(Dt).getTime()-lt<42e4||function(cn,on){if(void 0===un)try{new Response(new ReadableStream),un=!0}catch{un=!1}un?on(cn.body):cn.blob().then(on)}(wt,cn=>{const on=new Q.Response(cn,bt);gi(),Zt&&Zt.then(En=>En.put(Yt(rt.url),on)).catch(En=>It(En.message))}))}(_,te,he),b=!0,u(null,Re,K.headers.get("Cache-Control"),K.headers.get("Expires")))}).catch(Re=>{E||u(new Error(Re.message))})};return D?function(K,te){if(gi(),!Zt)return te(null);const he=Yt(K.url);Zt.then(Re=>{Re.match(he).then(rt=>{const wt=function(lt){if(!lt)return!1;const bt=new Date(lt.headers.get("Expires")||0),Mt=Sn(lt.headers.get("Cache-Control")||"");return bt>Date.now()&&!Mt["no-cache"]}(rt);Re.delete(he),wt&&Re.put(he,rt.clone()),te(null,rt,wt)}).catch(te)}).catch(te)}(_,z):z(null,null),{cancel:()=>{E=!0,b||f.abort()}}}(t,e);if(dn()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var i;return function(a,u){const f=new Q.XMLHttpRequest;f.open(a.method||"GET",a.url,!0),"arrayBuffer"===a.type&&(f.responseType="arraybuffer");for(const _ in a.headers)f.setRequestHeader(_,a.headers[_]);return"json"===a.type&&(f.responseType="text",f.setRequestHeader("Accept","application/json")),f.withCredentials="include"===a.credentials,f.onerror=()=>{u(new Error(f.statusText))},f.onload=()=>{if((f.status>=200&&f.status<300||0===f.status)&&null!==f.response){let _=f.response;if("json"===a.type)try{_=JSON.parse(f.response)}catch(b){return u(b)}u(null,_,f.getResponseHeader("Cache-Control"),f.getResponseHeader("Expires"))}else u(new Ci(f.statusText,f.status,a.url))},f.send(a.body),{cancel:()=>f.abort()}}(t,e)},fi=function(t,e){return Po(Ue(t,{type:"arrayBuffer"}),e)};function Vo(t){const e=Q.document.createElement("a");return e.href=t,e.protocol===Q.document.location.protocol&&e.host===Q.document.location.host}const ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let pe,ve;pe=[],ve=0;const et=function(t,e){if(fe.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),ve>=w.MAX_PARALLEL_IMAGE_REQUESTS){const f={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return pe.push(f),f}ve++;let i=!1;const a=()=>{if(!i)for(i=!0,ve--;pe.length&&ve<w.MAX_PARALLEL_IMAGE_REQUESTS;){const f=pe.shift(),{requestParameters:_,callback:b,cancelled:E}=f;E||(f.cancel=et(_,b).cancel)}},u=fi(t,(f,_,b,E)=>{a(),f?e(f):_&&(Q.createImageBitmap?function(D,k){const z=new Q.Blob([new Uint8Array(D)],{type:"image/png"});Q.createImageBitmap(z).then(j=>{k(null,j)}).catch(j=>{k(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(_,(D,k)=>e(D,k,b,E)):function(D,k){const z=new Q.Image,j=Q.URL;z.onload=()=>{k(null,z),j.revokeObjectURL(z.src),z.onload=null,Q.requestAnimationFrame(()=>{z.src=ut})},z.onerror=()=>k(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const K=new Q.Blob([new Uint8Array(D)],{type:"image/png"});z.src=D.byteLength?j.createObjectURL(K):ut}(_,(D,k)=>e(D,k,b,E)))});return{cancel:()=>{u.cancel(),a()}}},yt="NO_ACCESS_TOKEN";function Rt(t){return 0===t.indexOf("mapbox:")}function Ut(t){return w.API_URL_REGEX.test(t)}function jt(t){return w.API_CDN_URL_REGEX.test(t)}function St(t){return w.API_STYLE_REGEX.test(t)&&!Kt(t)}function Kt(t){return w.API_SPRITE_REGEX.test(t)}const In=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function tt(t){const e=t.match(In);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function Ve(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}const Y="mapbox.eventData";function me(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(Q.atob(e[1]).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class We{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const i=me(w.ACCESS_TOKEN);let a="";return a=i&&i.u?Q.btoa(encodeURIComponent(i.u).replace(/%([0-9A-F]{2})/g,(u,f)=>String.fromCharCode(+("0x"+f)))):w.ACCESS_TOKEN||"",e?`${Y}.${e}:${a}`:`${Y}:${a}`}fetchEventData(){const e=Gi("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{const u=Q.localStorage.getItem(i);u&&(this.eventData=JSON.parse(u));const f=Q.localStorage.getItem(a);f&&(this.anonId=f)}catch{It("Unable to read from LocalStorage")}}saveEventData(){const e=Gi("localStorage"),i=this.getStorageKey(),a=this.getStorageKey("uuid");if(e)try{Q.localStorage.setItem(a,this.anonId),Object.keys(this.eventData).length>=1&&Q.localStorage.setItem(i,JSON.stringify(this.eventData))}catch{It("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,i,a,u){if(!w.EVENTS_URL)return;const f=tt(w.EVENTS_URL);f.params.push(`access_token=${u||w.ACCESS_TOKEN||""}`);const _={event:this.type,created:new Date(e).toISOString()},b=i?Ue(_,i):_,E={url:Ve(f),headers:{"Content-Type":"text/plain"},body:JSON.stringify([b])};var k;this.pendingRequest=(k=D=>{this.pendingRequest=null,a(D),this.saveEventData(),this.processRequests(u)},Po(Ue(E,{method:"POST"}),k))}queueRequest(e,i){this.queue.push(e),this.processRequests(i)}}const kt=new class extends We{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){w.EVENTS_URL&&w.ACCESS_TOKEN&&Array.isArray(t)&&t.some(i=>Rt(i)||Ut(i))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=me(w.ACCESS_TOKEN),i=e?e.u:w.ACCESS_TOKEN;let a=i!==this.eventData.tokenU;Ft(this.anonId)||(this.anonId=_t(),a=!0);const u=this.queue.shift();if(this.eventData.lastSuccess){const f=new Date(this.eventData.lastSuccess),_=new Date(u),b=(u-this.eventData.lastSuccess)/864e5;a=a||b>=1||b<-1||f.getDate()!==_.getDate()}else a=!0;a?this.postEvent(u,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ie,skuId:ge,"enabled.telemetry":!1,userId:this.anonId},f=>{f||(this.eventData.lastSuccess=u,this.eventData.tokenU=i)},t):this.processRequests()}},_n=kt.postTurnstileEvent.bind(kt),ti=new class extends We{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,i,a){this.skuToken=e,this.errorCb=a,w.EVENTS_URL&&(i||w.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(yt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),Ft(this.anonId)||(this.anonId=_t()),this.postEvent(i,{sdkIdentifier:"mapbox-gl-js",sdkVersion:ie,skuId:ge,skuToken:this.skuToken,userId:this.anonId},a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t))}},Ei=ti.postMapLoadEvent.bind(ti),Si=new class extends We{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){w.EVENTS_URL&&(t||w.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:i}=this.queue.shift(),a=function(u){const f=Q.performance.getEntriesByType("resource"),_=Q.performance.getEntriesByType("mark"),b=function(j){const K={};if(j)for(const te in j)if("other"!==te)for(const he of j[te]){const Re=`${te}ResolveRangeMin`,rt=`${te}ResolveRangeMax`,wt=`${te}RequestCount`,lt=`${te}RequestCachedCount`;K[Re]=Math.min(K[Re]||1/0,he.startTime),K[rt]=Math.max(K[rt]||-1/0,he.responseEnd);const bt=Mt=>{void 0===K[Mt]&&(K[Mt]=0),++K[Mt]};void 0!==he.transferSize&&0===he.transferSize&&bt(lt),bt(wt)}return K}(function(j,K){const te={};if(j)for(const he of j){const Re=K(he);void 0===te[Re]&&(te[Re]=[]),te[Re].push(he)}return te}(f,Nn)),E=Q.devicePixelRatio,D=Q.navigator.connection||Q.navigator.mozConnection||Q.navigator.webkitConnection,k={counters:[],metadata:[],attributes:[]},z=(j,K,te)=>{null!=te&&j.push({name:K,value:te.toString()})};for(const j in b)z(k.counters,j,b[j]);if(u.interactionRange[0]!==1/0&&u.interactionRange[1]!==-1/0&&(z(k.counters,"interactionRangeMin",u.interactionRange[0]),z(k.counters,"interactionRangeMax",u.interactionRange[1])),_)for(const j of Object.keys(xt)){const K=xt[j],te=_.find(he=>he.name===K);te&&z(k.counters,K,te.startTime)}return z(k.counters,"visibilityHidden",u.visibilityHidden),z(k.attributes,"style",function(j){if(j)for(const K of j){const te=K.name.split("?")[0];if(St(te)){const he=te.split("/").slice(-2);if(2===he.length)return`mapbox://styles/${he[0]}/${he[1]}`}}}(f)),z(k.attributes,"terrainEnabled",u.terrainEnabled?"true":"false"),z(k.attributes,"fogEnabled",u.fogEnabled?"true":"false"),z(k.attributes,"projection",u.projection),z(k.attributes,"zoom",u.zoom),z(k.metadata,"devicePixelRatio",E),z(k.metadata,"connectionEffectiveType",D?D.effectiveType:void 0),z(k.metadata,"navigatorUserAgent",Q.navigator.userAgent),z(k.metadata,"screenWidth",Q.screen.width),z(k.metadata,"screenHeight",Q.screen.height),z(k.metadata,"windowWidth",Q.innerWidth),z(k.metadata,"windowHeight",Q.innerHeight),z(k.metadata,"mapWidth",u.width/E),z(k.metadata,"mapHeight",u.height/E),z(k.metadata,"webglRenderer",u.renderer),z(k.metadata,"webglVendor",u.vendor),z(k.metadata,"sdkVersion",ie),z(k.metadata,"sdkIdentifier","mapbox-gl-js"),k}(i);for(const u of a.metadata);for(const u of a.counters);for(const u of a.attributes);this.postEvent(e,a,()=>{},t)}},ji=Si.postPerformanceEvent.bind(Si),po=new class extends We{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,i,a){if(!w.API_URL||!w.SESSION_PATH)return;const u=tt(w.API_URL+w.SESSION_PATH);u.params.push(`sku=${e||""}`),u.params.push(`access_token=${a||w.ACCESS_TOKEN||""}`);const f={url:Ve(u),headers:{"Content-Type":"text/plain"}};var b;this.pendingRequest=(b=_=>{this.pendingRequest=null,i(_),this.saveEventData(),this.processRequests(a)},Po(Ue(f,{method:"GET"}),b))}getSessionAPI(t,e,i,a){this.skuToken=e,this.errorCb=a,w.SESSION_PATH&&w.API_URL&&(i||w.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},i):this.errorCb(new Error(yt)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:i}=this.queue.shift();e&&this.success[e]||this.getSession(i,this.skuToken,a=>{a?this.errorCb(a):e&&(this.success[e]=!0)},t)}},eo=po.getSessionAPI.bind(po),tn=new Set,xt={create:"create",load:"load",fullLoad:"fullLoad"},Et={mark(t){Q.performance.mark(t)},measure(t,e,i){Q.performance.measure(t,e,i)}};function Nn(t){const e=t.name.split("?")[0];return jt(e)&&e.includes("mapbox-gl.js")?"javascript":jt(e)&&e.includes("mapbox-gl.css")?"css":w.API_FONTS_REGEX.test(e)?"fontRange":Kt(e)?"sprite":St(e)?"style":w.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const Pn=Q.performance;function ri(t){const e=t?t.url.toString():void 0;return Pn.getEntriesByName(e)}let ni,qi,wi,mo;const Ao={now:()=>void 0!==wi?wi:Q.performance.now(),setNow(t){wi=t},restoreNow(){wi=void 0},frame(t){const e=Q.requestAnimationFrame(t);return{cancel:()=>Q.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:i,height:a}=t;mo||(mo=Q.document.createElement("canvas"));const u=mo.getContext("2d",{willReadFrequently:!0});if(!u)throw new Error("failed to create canvas 2d context");return(i>mo.width||a>mo.height)&&(mo.width=i,mo.height=a),u.clearRect(-e,-e,i+2*e,a+2*e),u.drawImage(t,0,0,i,a),u.getImageData(-e,-e,i+2*e,a+2*e)},resolveURL:t=>(ni||(ni=Q.document.createElement("a")),ni.href=t,ni.href),get devicePixelRatio(){return Q.devicePixelRatio},get prefersReducedMotion(){return!!Q.matchMedia&&(null==qi&&(qi=Q.matchMedia("(prefers-reduced-motion: reduce)")),qi.matches)}};function Go(t,e,i){i[t]&&-1!==i[t].indexOf(e)||(i[t]=i[t]||[],i[t].push(e))}function co(t,e,i){if(i&&i[t]){const a=i[t].indexOf(e);-1!==a&&i[t].splice(a,1)}}class io{constructor(e,i={}){Ue(this,i),this.type=e}}class Pi extends io{constructor(e,i={}){super("error",Ue({error:e},i))}}class uo{on(e,i){return this._listeners=this._listeners||{},Go(e,i,this._listeners),this}off(e,i){return co(e,i,this._listeners),co(e,i,this._oneTimeListeners),this}once(e,i){return i?(this._oneTimeListeners=this._oneTimeListeners||{},Go(e,i,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,i){"string"==typeof e&&(e=new io(e,i||{}));const a=e.type;if(this.listens(a)){e.target=this;const u=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const b of u)b.call(this,e);const f=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const b of f)co(a,b,this._oneTimeListeners),b.call(this,e);const _=this._eventedParent;_&&(Ue(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),_.fire(e))}else e instanceof Pi&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,i){return this._eventedParent=e,this._eventedParentData=i,this}}var en=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Qo(t,...e){for(const i of e)for(const a in i)t[a]=i[a];return t}function vo(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function Ji(t){if(Array.isArray(t))return t.map(Ji);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const i in t)e[i]=Ji(t[i]);return e}return vo(t)}class gr extends Error{constructor(e,i){super(i),this.message=i,this.key=e}}var xo=gr;class Zr{constructor(e,i=[]){this.parent=e,this.bindings={};for(const[a,u]of i)this.bindings[a]=u}concat(e){return new Zr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Mr=Zr;const kr={kind:"null"},ei={kind:"number"},Vi={kind:"string"},_e={kind:"boolean"},st={kind:"color"},ke={kind:"object"},it={kind:"value"},Bt={kind:"collator"},zt={kind:"formatted"},yn={kind:"resolvedImage"};function Tn(t,e){return{kind:"array",itemType:t,N:e}}function xn(t){if("array"===t.kind){const e=xn(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const On=[kr,ei,Vi,_e,st,zt,ke,Tn(it),yn];function hi(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!hi(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const i of On)if(!hi(i,e))return null}return`Expected ${xn(t)} but found ${xn(e)} instead.`}function Ii(t,e){return e.some(i=>i.kind===t.kind)}function zi(t,e){return e.some(i=>"null"===i?null===t:"array"===i?Array.isArray(t):"object"===i?t&&!Array.isArray(t)&&"object"==typeof t:i===typeof t)}var Lo,Xi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function so(t){return(t=Math.round(t))<0?0:t>255?255:t}function To(t){return so("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function or(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Wo(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}try{Lo={}.parseCSSColor=function(t){var e,i=t.replace(/ /g,"").toLowerCase();if(i in Xi)return Xi[i].slice();if("#"===i[0])return 4===i.length?(e=parseInt(i.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===i.length&&(e=parseInt(i.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var a=i.indexOf("("),u=i.indexOf(")");if(-1!==a&&u+1===i.length){var f=i.substr(0,a),_=i.substr(a+1,u-(a+1)).split(","),b=1;switch(f){case"rgba":if(4!==_.length)return null;b=or(_.pop());case"rgb":return 3!==_.length?null:[To(_[0]),To(_[1]),To(_[2]),b];case"hsla":if(4!==_.length)return null;b=or(_.pop());case"hsl":if(3!==_.length)return null;var E=(parseFloat(_[0])%360+360)%360/360,D=or(_[1]),k=or(_[2]),z=k<=.5?k*(D+1):k+D-k*D,j=2*k-z;return[so(255*Wo(j,z,E+1/3)),so(255*Wo(j,z,E)),so(255*Wo(j,z,E-1/3)),b];default:return null}}return null}}catch{}class dr{constructor(e,i,a,u=1){this.r=e,this.g=i,this.b=a,this.a=u}static parse(e){if(!e)return;if(e instanceof dr)return e;if("string"!=typeof e)return;const i=Lo(e);return i?new dr(i[0]/255*i[3],i[1]/255*i[3],i[2]/255*i[3],i[3]):void 0}toString(){const[e,i,a,u]=this.toArray();return`rgba(${Math.round(e)},${Math.round(i)},${Math.round(a)},${u})`}toArray(){const{r:e,g:i,b:a,a:u}=this;return 0===u?[0,0,0,0]:[255*e/u,255*i/u,255*a/u,u]}toArray01(){const{r:e,g:i,b:a,a:u}=this;return 0===u?[0,0,0,0]:[e/u,i/u,a/u,u]}toArray01PremultipliedAlpha(){const{r:e,g:i,b:a,a:u}=this;return[e,i,a,u]}}dr.black=new dr(0,0,0,1),dr.white=new dr(1,1,1,1),dr.transparent=new dr(0,0,0,0),dr.red=new dr(1,0,0,1),dr.blue=new dr(0,0,1,1);var wo=dr;class xs{constructor(e,i,a){this.sensitivity=e?i?"variant":"case":i?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,i){return this.collator.compare(e,i)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ea{constructor(e,i,a,u,f){this.text=e.normalize?e.normalize():e,this.image=i,this.scale=a,this.fontStack=u,this.textColor=f}}class hr{constructor(e){this.sections=e}static fromString(e){return new hr([new ea(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof hr?e:hr.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const i of this.sections){if(i.image){e.push(["image",i.image.name]);continue}e.push(i.text);const a={};i.fontStack&&(a["text-font"]=["literal",i.fontStack.split(",")]),i.scale&&(a["font-scale"]=i.scale),i.textColor&&(a["text-color"]=["rgba"].concat(i.textColor.toArray())),e.push(a)}return e}}class bo{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new bo({name:e,available:!1}):null}serialize(){return["image",this.name]}}function mi(t,e,i,a){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof i&&i>=0&&i<=255?void 0===a||"number"==typeof a&&a>=0&&a<=1?null:`Invalid rgba value [${[t,e,i,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof a?[t,e,i,a]:[t,e,i]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Fi(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof wo||t instanceof xs||t instanceof hr||t instanceof bo)return!0;if(Array.isArray(t)){for(const e of t)if(!Fi(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!Fi(t[e]))return!1;return!0}return!1}function Bi(t){if(null===t)return kr;if("string"==typeof t)return Vi;if("boolean"==typeof t)return _e;if("number"==typeof t)return ei;if(t instanceof wo)return st;if(t instanceof xs)return Bt;if(t instanceof hr)return zt;if(t instanceof bo)return yn;if(Array.isArray(t)){const e=t.length;let i;for(const a of t){const u=Bi(a);if(i){if(i===u)continue;i=it;break}i=u}return Tn(i||it,e)}return ke}function er(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof wo||t instanceof hr||t instanceof bo?t.toString():JSON.stringify(t)}class is{constructor(e,i){this.type=e,this.value=i}static parse(e,i){if(2!==e.length)return i.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Fi(e[1]))return i.error("invalid value");const a=e[1];let u=Bi(a);const f=i.expectedType;return"array"!==u.kind||0!==u.N||!f||"array"!==f.kind||"number"==typeof f.N&&0!==f.N||(u=f),new is(u,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof wo?["rgba"].concat(this.value.toArray()):this.value instanceof hr?this.value.serialize():this.value}}var jo=is,Jo=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const Oo={string:Vi,number:ei,boolean:_e,object:ke};class Ur{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");let a,u=1;const f=e[0];if("array"===f){let b,E;if(e.length>2){const D=e[1];if("string"!=typeof D||!(D in Oo)||"object"===D)return i.error('The item type argument of "array" must be one of string, number, boolean',1);b=Oo[D],u++}else b=it;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return i.error('The length argument to "array" must be a positive integer literal',2);E=e[2],u++}a=Tn(b,E)}else a=Oo[f];const _=[];for(;u<e.length;u++){const b=i.parse(e[u],u,it);if(!b)return null;_.push(b)}return new Ur(a,_)}evaluate(e){for(let i=0;i<this.args.length;i++){const a=this.args[i].evaluate(e);if(!hi(this.type,Bi(a)))return a;if(i===this.args.length-1)throw new Jo(`Expected value to be of type ${xn(this.type)}, but found ${xn(Bi(a))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,i=[e.kind];if("array"===e.kind){const a=e.itemType;if("string"===a.kind||"number"===a.kind||"boolean"===a.kind){i.push(a.kind);const u=e.N;("number"==typeof u||this.args.length>1)&&i.push(u)}}return i.concat(this.args.map(a=>a.serialize()))}}var xr=Ur;class Ri{constructor(e){this.type=zt,this.sections=e}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&"object"==typeof a)return i.error("First argument must be an image or text section.");const u=[];let f=!1;for(let _=1;_<=e.length-1;++_){const b=e[_];if(f&&"object"==typeof b&&!Array.isArray(b)){f=!1;let E=null;if(b["font-scale"]&&(E=i.parse(b["font-scale"],1,ei),!E))return null;let D=null;if(b["text-font"]&&(D=i.parse(b["text-font"],1,Tn(Vi)),!D))return null;let k=null;if(b["text-color"]&&(k=i.parse(b["text-color"],1,st),!k))return null;const z=u[u.length-1];z.scale=E,z.font=D,z.textColor=k}else{const E=i.parse(e[_],1,it);if(!E)return null;const D=E.type.kind;if("string"!==D&&"value"!==D&&"null"!==D&&"resolvedImage"!==D)return i.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");f=!0,u.push({content:E,scale:null,font:null,textColor:null})}}return new Ri(u)}evaluate(e){return new hr(this.sections.map(i=>{const a=i.content.evaluate(e);return Bi(a)===yn?new ea("",a,null,null,null):new ea(er(a),null,i.scale?i.scale.evaluate(e):null,i.font?i.font.evaluate(e).join(","):null,i.textColor?i.textColor.evaluate(e):null)}))}eachChild(e){for(const i of this.sections)e(i.content),i.scale&&e(i.scale),i.font&&e(i.font),i.textColor&&e(i.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const i of this.sections){e.push(i.content.serialize());const a={};i.scale&&(a["font-scale"]=i.scale.serialize()),i.font&&(a["text-font"]=i.font.serialize()),i.textColor&&(a["text-color"]=i.textColor.serialize()),e.push(a)}return e}}class us{constructor(e){this.type=yn,this.input=e}static parse(e,i){if(2!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,Vi);return a?new us(a):i.error("No image name provided.")}evaluate(e){const i=this.input.evaluate(e),a=bo.fromString(i);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(i)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ta={"to-boolean":_e,"to-color":st,"to-number":ei,"to-string":Vi};class Xr{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expected at least one argument.");const a=e[0];if(("to-boolean"===a||"to-string"===a)&&2!==e.length)return i.error("Expected one argument.");const u=ta[a],f=[];for(let _=1;_<e.length;_++){const b=i.parse(e[_],_,it);if(!b)return null;f.push(b)}return new Xr(u,f)}evaluate(e){if("boolean"===this.type.kind)return!!this.args[0].evaluate(e);if("color"===this.type.kind){let i,a;for(const u of this.args){if(i=u.evaluate(e),a=null,i instanceof wo)return i;if("string"==typeof i){const f=e.parseColor(i);if(f)return f}else if(Array.isArray(i)&&(a=i.length<3||i.length>4?`Invalid rbga value ${JSON.stringify(i)}: expected an array containing either three or four numeric values.`:mi(i[0],i[1],i[2],i[3]),!a))return new wo(i[0]/255,i[1]/255,i[2]/255,i[3])}throw new Jo(a||`Could not parse color from value '${"string"==typeof i?i:String(JSON.stringify(i))}'`)}if("number"===this.type.kind){let i=null;for(const a of this.args){if(i=a.evaluate(e),null===i)return 0;const u=Number(i);if(!isNaN(u))return u}throw new Jo(`Could not convert ${JSON.stringify(i)} to number.`)}return"formatted"===this.type.kind?hr.fromString(er(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?bo.fromString(er(this.args[0].evaluate(e))):er(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Ri([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new us(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(i=>{e.push(i.serialize())}),e}}var ko=Xr;const Ir=["Unknown","Point","LineString","Polygon"];var Fr=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ir[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:i,y:a}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(i*e-t[0])+this.featureDistanceData.bearing[1]*(a*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=wo.parse(t)),e}};class Br{constructor(e,i,a,u){this.name=e,this.type=i,this._evaluate=a,this.args=u}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,i){const a=e[0],u=Br.definitions[a];if(!u)return i.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const f=Array.isArray(u)?u[0]:u.type,_=Array.isArray(u)?[[u[1],u[2]]]:u.overloads,b=_.filter(([D])=>!Array.isArray(D)||D.length===e.length-1);let E=null;for(const[D,k]of b){E=new re(i.registry,i.path,null,i.scope);const z=[];let j=!1;for(let K=1;K<e.length;K++){const te=e[K],he=Array.isArray(D)?D[K-1]:D.type,Re=E.parse(te,1+z.length,he);if(!Re){j=!0;break}z.push(Re)}if(!j)if(Array.isArray(D)&&D.length!==z.length)E.error(`Expected ${D.length} arguments, but found ${z.length} instead.`);else{for(let K=0;K<z.length;K++){const te=Array.isArray(D)?D[K]:D.type,he=z[K];E.concat(K+1).checkSubtype(te,he.type)}if(0===E.errors.length)return new Br(a,f,k,z)}}if(1===b.length)i.errors.push(...E.errors);else{const D=(b.length?b:_).map(([z])=>{return j=z,Array.isArray(j)?`(${j.map(xn).join(", ")})`:`(${xn(j.type)}...)`;var j}).join(" | "),k=[];for(let z=1;z<e.length;z++){const j=i.parse(e[z],1+k.length);if(!j)return null;k.push(xn(j.type))}i.error(`Expected arguments of type ${D}, but found (${k.join(", ")}) instead.`)}return null}static register(e,i){Br.definitions=i;for(const a in i)e[a]=Br}}var br=Br;class bs{constructor(e,i,a){this.type=Bt,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=i}static parse(e,i){if(2!==e.length)return i.error("Expected one argument.");const a=e[1];if("object"!=typeof a||Array.isArray(a))return i.error("Collator options argument must be an object.");const u=i.parse(void 0!==a["case-sensitive"]&&a["case-sensitive"],1,_e);if(!u)return null;const f=i.parse(void 0!==a["diacritic-sensitive"]&&a["diacritic-sensitive"],1,_e);if(!f)return null;let _=null;return a.locale&&(_=i.parse(a.locale,1,Vi),!_)?null:new bs(u,f,_)}evaluate(e){return new xs(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const rr=8192;function Ar(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Qr(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function ws(t,e){const i=(180+t[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,u=Math.pow(2,e.z);return[Math.round(i*u*rr),Math.round(a*u*rr)]}function Qi(t,e,i){const a=t[0]-e[0],u=t[1]-e[1],f=t[0]-i[0],_=t[1]-i[1];return a*_-f*u==0&&a*f<=0&&u*_<=0}function ds(t,e){let i=!1;for(let _=0,b=e.length;_<b;_++){const E=e[_];for(let D=0,k=E.length;D<k-1;D++){if(Qi(t,E[D],E[D+1]))return!1;(u=E[D])[1]>(a=t)[1]!=(f=E[D+1])[1]>a[1]&&a[0]<(f[0]-u[0])*(a[1]-u[1])/(f[1]-u[1])+u[0]&&(i=!i)}}var a,u,f;return i}function na(t,e){for(let i=0;i<e.length;i++)if(ds(t,e[i]))return!0;return!1}function Ss(t,e,i,a){const u=a[0]-i[0],f=a[1]-i[1],_=(t[0]-i[0])*f-u*(t[1]-i[1]),b=(e[0]-i[0])*f-u*(e[1]-i[1]);return _>0&&b<0||_<0&&b>0}function Sr(t,e,i){for(const D of i)for(let k=0;k<D.length-1;++k)if((b=[(_=D[k+1])[0]-(f=D[k])[0],_[1]-f[1]])[0]*(E=[(u=e)[0]-(a=t)[0],u[1]-a[1]])[1]-b[1]*E[0]!=0&&Ss(a,u,f,_)&&Ss(f,_,a,u))return!0;var a,u,f,_,b,E;return!1}function ao(t,e){for(let i=0;i<t.length;++i)if(!ds(t[i],e))return!1;for(let i=0;i<t.length-1;++i)if(Sr(t[i],t[i+1],e))return!1;return!0}function ia(t,e){for(let i=0;i<e.length;i++)if(ao(t,e[i]))return!0;return!1}function Ps(t,e,i){const a=[];for(let u=0;u<t.length;u++){const f=[];for(let _=0;_<t[u].length;_++){const b=ws(t[u][_],i);Ar(e,b),f.push(b)}a.push(f)}return a}function wr(t,e,i){const a=[];for(let u=0;u<t.length;u++){const f=Ps(t[u],e,i);a.push(f)}return a}function Wa(t,e,i,a){if(t[0]<i[0]||t[0]>i[2]){const u=.5*a;let f=t[0]-i[0]>u?-a:i[0]-t[0]>u?a:0;0===f&&(f=t[0]-i[2]>u?-a:i[2]-t[0]>u?a:0),t[0]+=f}Ar(e,t)}function Pr(t,e,i,a){const u=Math.pow(2,a.z)*rr,f=[a.x*rr,a.y*rr],_=[];if(!t)return _;for(const b of t)for(const E of b){const D=[E.x+f[0],E.y+f[1]];Wa(D,e,i,u),_.push(D)}return _}function Nr(t,e,i,a){const u=Math.pow(2,a.z)*rr,f=[a.x*rr,a.y*rr],_=[];if(!t)return _;for(const E of t){const D=[];for(const k of E){const z=[k.x+f[0],k.y+f[1]];Ar(e,z),D.push(z)}_.push(D)}if(e[2]-e[0]<=u/2){(b=e)[0]=b[1]=1/0,b[2]=b[3]=-1/0;for(const E of _)for(const D of E)Wa(D,e,i,u)}var b;return _}class Gs{constructor(e,i){this.type=_e,this.geojson=e,this.geometries=i}static parse(e,i){if(2!==e.length)return i.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Fi(e[1])){const a=e[1];if("FeatureCollection"===a.type)for(let u=0;u<a.features.length;++u){const f=a.features[u].geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new Gs(a,a.features[u].geometry)}else if("Feature"===a.type){const u=a.geometry.type;if("Polygon"===u||"MultiPolygon"===u)return new Gs(a,a.geometry)}else if("Polygon"===a.type||"MultiPolygon"===a.type)return new Gs(a,a)}return i.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(i,a){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(!_)return!1;if("Polygon"===a.type){const b=Ps(a.coordinates,f,_),E=Pr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!ds(D,b))return!1}if("MultiPolygon"===a.type){const b=wr(a.coordinates,f,_),E=Pr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!na(D,b))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(i,a){const u=[1/0,1/0,-1/0,-1/0],f=[1/0,1/0,-1/0,-1/0],_=i.canonicalID();if(!_)return!1;if("Polygon"===a.type){const b=Ps(a.coordinates,f,_),E=Nr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!ao(D,b))return!1}if("MultiPolygon"===a.type){const b=wr(a.coordinates,f,_),E=Nr(i.geometry(),u,f,_);if(!Qr(u,f))return!1;for(const D of E)if(!ia(D,b))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ts=Gs;function Cs(t){if(t instanceof br&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Ts)return!1;let e=!0;return t.eachChild(i=>{e&&!Cs(i)&&(e=!1)}),e}function pr(t){if(t instanceof br&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(i=>{e&&!pr(i)&&(e=!1)}),e}function Tr(t,e){if(t instanceof br&&e.indexOf(t.name)>=0)return!1;let i=!0;return t.eachChild(a=>{i&&!Tr(a,e)&&(i=!1)}),i}class Ma{constructor(e,i){this.type=i.type,this.name=e,this.boundExpression=i}static parse(e,i){if(2!==e.length||"string"!=typeof e[1])return i.error("'var' expression requires exactly one string literal argument.");const a=e[1];return i.scope.has(a)?new Ma(a,i.scope.get(a)):i.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var oa=Ma;class S{constructor(e,i=[],a,u=new Mr,f=[]){this.registry=e,this.path=i,this.key=i.map(_=>`[${_}]`).join(""),this.scope=u,this.errors=f,this.expectedType=a}parse(e,i,a,u,f={}){return i?this.concat(i,a,u)._parse(e,f):this._parse(e,f)}_parse(e,i){function a(u,f,_){return"assert"===_?new xr(f,[u]):"coerce"===_?new ko(f,[u]):u}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const u=e[0];if("string"!=typeof u)return this.error(`Expression name must be a string, but found ${typeof u} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const f=this.registry[u];if(f){let _=f.parse(e,this);if(!_)return null;if(this.expectedType){const b=this.expectedType,E=_.type;if("string"!==b.kind&&"number"!==b.kind&&"boolean"!==b.kind&&"object"!==b.kind&&"array"!==b.kind||"value"!==E.kind)if("color"!==b.kind&&"formatted"!==b.kind&&"resolvedImage"!==b.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(b,E))return null}else _=a(_,b,i.typeAnnotation||"coerce");else _=a(_,b,i.typeAnnotation||"assert")}if(!(_ instanceof jo)&&"resolvedImage"!==_.type.kind&&P(_)){const b=new Fr;try{_=new jo(_.type,_.evaluate(b))}catch(E){return this.error(E.message),null}}return _}return this.error(`Unknown expression "${u}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,i,a){const u="number"==typeof e?this.path.concat(e):this.path,f=a?this.scope.concat(a):this.scope;return new S(this.registry,u,i||null,f,this.errors)}error(e,...i){const a=`${this.key}${i.map(u=>`[${u}]`).join("")}`;this.errors.push(new xo(a,e))}checkSubtype(e,i){const a=hi(e,i);return a&&this.error(a),a}}var re=S;function P(t){if(t instanceof oa)return P(t.boundExpression);if(t instanceof br&&"error"===t.name||t instanceof bs||t instanceof Ts)return!1;const e=t instanceof ko||t instanceof xr;let i=!0;return t.eachChild(a=>{i=e?i&&P(a):i&&a instanceof jo}),!!i&&Cs(t)&&Tr(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ne(t,e){const i=t.length-1;let a,u,f=0,_=i,b=0;for(;f<=_;)if(b=Math.floor((f+_)/2),a=t[b],u=t[b+1],a<=e){if(b===i||e<u)return b;f=b+1}else{if(!(a>e))throw new Jo("Input is not a number.");_=b-1}return 0}class Ge{constructor(e,i,a){this.type=e,this.input=i,this.labels=[],this.outputs=[];for(const[u,f]of a)this.labels.push(u),this.outputs.push(f)}static parse(e,i){if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");const a=i.parse(e[1],1,ei);if(!a)return null;const u=[];let f=null;i.expectedType&&"value"!==i.expectedType.kind&&(f=i.expectedType);for(let _=1;_<e.length;_+=2){const b=1===_?-1/0:e[_],E=e[_+1],D=_,k=_+1;if("number"!=typeof b)return i.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',D);if(u.length&&u[u.length-1][0]>=b)return i.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',D);const z=i.parse(E,k,f);if(!z)return null;f=f||z.type,u.push([b,z])}return new Ge(f,a,u)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return a[0].evaluate(e);const f=i.length;return u>=i[f-1]?a[f-1].evaluate(e):a[ne(i,u)].evaluate(e)}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let i=0;i<this.labels.length;i++)i>0&&e.push(this.labels[i]),e.push(this.outputs[i].serialize());return e}}var Ln=Ge;function Xn(t,e,i){return t*(1-i)+e*i}var Zi=Object.freeze({__proto__:null,array:function(t,e,i){return t.map((a,u)=>Xn(a,e[u],i))},color:function(t,e,i){return new wo(Xn(t.r,e.r,i),Xn(t.g,e.g,i),Xn(t.b,e.b,i),Xn(t.a,e.a,i))},number:Xn});const J=1.08883,G=4/29,Fe=6/29,bn=3*Fe*Fe,pi=Fe*Fe*Fe,sr=Math.PI/180,hs=180/Math.PI;function Ws(t){return t>pi?Math.pow(t,1/3):t/bn+G}function qa(t){return t>Fe?t*t*t:bn*(t-G)}function kc(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Fc(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function ua(t){const e=Fc(t.r),i=Fc(t.g),a=Fc(t.b),u=Ws((.4124564*e+.3575761*i+.1804375*a)/.95047),f=Ws((.2126729*e+.7151522*i+.072175*a)/1);return{l:116*f-16,a:500*(u-f),b:200*(f-Ws((.0193339*e+.119192*i+.9503041*a)/J)),alpha:t.a}}function Ll(t){let e=(t.l+16)/116,i=isNaN(t.a)?e:e+t.a/500,a=isNaN(t.b)?e:e-t.b/200;return e=1*qa(e),i=.95047*qa(i),a=J*qa(a),new wo(kc(3.2404542*i-1.5371385*e-.4985314*a),kc(-.969266*i+1.8760108*e+.041556*a),kc(.0556434*i-.2040259*e+1.0572252*a),t.alpha)}function rc(t,e,i){const a=e-t;return t+i*(a>180||a<-180?a-360*Math.round(a/360):a)}const Os={forward:ua,reverse:Ll,interpolate:function(t,e,i){return{l:Xn(t.l,e.l,i),a:Xn(t.a,e.a,i),b:Xn(t.b,e.b,i),alpha:Xn(t.alpha,e.alpha,i)}}},da={forward:function(t){const{l:e,a:i,b:a}=ua(t),u=Math.atan2(a,i)*hs;return{h:u<0?u+360:u,c:Math.sqrt(i*i+a*a),l:e,alpha:t.a}},reverse:function(t){const e=t.h*sr,i=t.c;return Ll({l:t.l,a:Math.cos(e)*i,b:Math.sin(e)*i,alpha:t.alpha})},interpolate:function(t,e,i){return{h:rc(t.h,e.h,i),c:Xn(t.c,e.c,i),l:Xn(t.l,e.l,i),alpha:Xn(t.alpha,e.alpha,i)}}};var kl=Object.freeze({__proto__:null,hcl:da,lab:Os});class Ya{constructor(e,i,a,u,f){this.type=e,this.operator=i,this.interpolation=a,this.input=u,this.labels=[],this.outputs=[];for(const[_,b]of f)this.labels.push(_),this.outputs.push(b)}static interpolationFactor(e,i,a,u){let f=0;if("exponential"===e.name)f=Ja(i,e.base,a,u);else if("linear"===e.name)f=Ja(i,1,a,u);else if("cubic-bezier"===e.name){const _=e.controlPoints;f=new ze(_[0],_[1],_[2],_[3]).solve(Ja(i,1,a,u))}return f}static parse(e,i){let[a,u,f,..._]=e;if(!Array.isArray(u)||0===u.length)return i.error("Expected an interpolation type expression.",1);if("linear"===u[0])u={name:"linear"};else if("exponential"===u[0]){const D=u[1];if("number"!=typeof D)return i.error("Exponential interpolation requires a numeric base.",1,1);u={name:"exponential",base:D}}else{if("cubic-bezier"!==u[0])return i.error(`Unknown interpolation type ${String(u[0])}`,1,0);{const D=u.slice(1);if(4!==D.length||D.some(k=>"number"!=typeof k||k<0||k>1))return i.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);u={name:"cubic-bezier",controlPoints:D}}}if(e.length-1<4)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return i.error("Expected an even number of arguments.");if(f=i.parse(f,2,ei),!f)return null;const b=[];let E=null;"interpolate-hcl"===a||"interpolate-lab"===a?E=st:i.expectedType&&"value"!==i.expectedType.kind&&(E=i.expectedType);for(let D=0;D<_.length;D+=2){const k=_[D],z=_[D+1],j=D+3,K=D+4;if("number"!=typeof k)return i.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(b.length&&b[b.length-1][0]>=k)return i.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const te=i.parse(z,K,E);if(!te)return null;E=E||te.type,b.push([k,te])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new Ya(E,a,u,f,b):i.error(`Type ${xn(E)} is not interpolatable.`)}evaluate(e){const i=this.labels,a=this.outputs;if(1===i.length)return a[0].evaluate(e);const u=this.input.evaluate(e);if(u<=i[0])return a[0].evaluate(e);const f=i.length;if(u>=i[f-1])return a[f-1].evaluate(e);const _=ne(i,u),b=Ya.interpolationFactor(this.interpolation,u,i[_],i[_+1]),E=a[_].evaluate(e),D=a[_+1].evaluate(e);return"interpolate"===this.operator?Zi[this.type.kind.toLowerCase()](E,D,b):"interpolate-hcl"===this.operator?da.reverse(da.interpolate(da.forward(E),da.forward(D),b)):Os.reverse(Os.interpolate(Os.forward(E),Os.forward(D),b))}eachChild(e){e(this.input);for(const i of this.outputs)e(i)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const i=[this.operator,e,this.input.serialize()];for(let a=0;a<this.labels.length;a++)i.push(this.labels[a],this.outputs[a].serialize());return i}}function Ja(t,e,i,a){const u=a-i,f=t-i;return 0===u?0:1===e?f/u:(Math.pow(e,f)-1)/(Math.pow(e,u)-1)}var ps=Ya;class Fl{constructor(e,i){this.type=e,this.args=i}static parse(e,i){if(e.length<2)return i.error("Expectected at least one argument.");let a=null;const u=i.expectedType;u&&"value"!==u.kind&&(a=u);const f=[];for(const b of e.slice(1)){const E=i.parse(b,1+f.length,a,void 0,{typeAnnotation:"omit"});if(!E)return null;a=a||E.type,f.push(E)}const _=u&&f.some(b=>hi(u,b.type));return new Fl(_?it:a,f)}evaluate(e){let i,a=null,u=0;for(const f of this.args){if(u++,a=f.evaluate(e),a&&a instanceof bo&&!a.available&&(i||(i=a),a=null,u===this.args.length))return i;if(null!==a)break}return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Rs=Fl;class ha{constructor(e,i){this.type=i.type,this.bindings=[].concat(e),this.result=i}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const i of this.bindings)e(i[1]);e(this.result)}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let f=1;f<e.length-1;f+=2){const _=e[f];if("string"!=typeof _)return i.error(`Expected string, but found ${typeof _} instead.`,f);if(/[^a-zA-Z0-9_]/.test(_))return i.error("Variable names must contain only alphanumeric characters or '_'.",f);const b=i.parse(e[f+1],f+1);if(!b)return null;a.push([_,b])}const u=i.parse(e[e.length-1],e.length-1,i.expectedType,a);return u?new ha(a,u):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[i,a]of this.bindings)e.push(i,a.serialize());return e.push(this.result.serialize()),e}}var Or=ha;class pl{constructor(e,i,a){this.type=e,this.index=i,this.input=a}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,ei),u=i.parse(e[2],2,Tn(i.expectedType||it));return a&&u?new pl(u.type.itemType,a,u):null}evaluate(e){const i=this.index.evaluate(e),a=this.input.evaluate(e);if(i<0)throw new Jo(`Array index out of bounds: ${i} < 0.`);if(i>=a.length)throw new Jo(`Array index out of bounds: ${i} > ${a.length-1}.`);if(i!==Math.floor(i))throw new Jo(`Array index must be an integer, but found ${i} instead.`);return a[i]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var fd=pl;class pa{constructor(e,i){this.type=_e,this.needle=e,this.haystack=i}static parse(e,i){if(3!==e.length)return i.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,it),u=i.parse(e[2],2,it);return a&&u?Ii(a.type,[_e,Vi,ei,kr,it])?new pa(a,u):i.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(a.type)} instead`):null}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(null==a)return!1;if(!zi(i,["boolean","string","number","null"]))throw new Jo(`Expected first argument to be of type boolean, string, number or null, but found ${xn(Bi(i))} instead.`);if(!zi(a,["string","array"]))throw new Jo(`Expected second argument to be of type array or string, but found ${xn(Bi(a))} instead.`);return a.indexOf(i)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var fa=pa;class Es{constructor(e,i,a){this.type=ei,this.needle=e,this.haystack=i,this.fromIndex=a}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,it),u=i.parse(e[2],2,it);if(!a||!u)return null;if(!Ii(a.type,[_e,Vi,ei,kr,it]))return i.error(`Expected first argument to be of type boolean, string, number or null, but found ${xn(a.type)} instead`);if(4===e.length){const f=i.parse(e[3],3,ei);return f?new Es(a,u,f):null}return new Es(a,u)}evaluate(e){const i=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!zi(i,["boolean","string","number","null"]))throw new Jo(`Expected first argument to be of type boolean, string, number or null, but found ${xn(Bi(i))} instead.`);if(!zi(a,["string","array"]))throw new Jo(`Expected second argument to be of type array or string, but found ${xn(Bi(a))} instead.`);if(this.fromIndex){const u=this.fromIndex.evaluate(e);return a.indexOf(i,u)}return a.indexOf(i)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var sc=Es;class Bc{constructor(e,i,a,u,f,_){this.inputType=e,this.type=i,this.input=a,this.cases=u,this.outputs=f,this.otherwise=_}static parse(e,i){if(e.length<5)return i.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return i.error("Expected an even number of arguments.");let a,u;i.expectedType&&"value"!==i.expectedType.kind&&(u=i.expectedType);const f={},_=[];for(let D=2;D<e.length-1;D+=2){let k=e[D];const z=e[D+1];Array.isArray(k)||(k=[k]);const j=i.concat(D);if(0===k.length)return j.error("Expected at least one branch label.");for(const te of k){if("number"!=typeof te&&"string"!=typeof te)return j.error("Branch labels must be numbers or strings.");if("number"==typeof te&&Math.abs(te)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof te&&Math.floor(te)!==te)return j.error("Numeric branch labels must be integer values.");if(a){if(j.checkSubtype(a,Bi(te)))return null}else a=Bi(te);if(void 0!==f[String(te)])return j.error("Branch labels must be unique.");f[String(te)]=_.length}const K=i.parse(z,D,u);if(!K)return null;u=u||K.type,_.push(K)}const b=i.parse(e[1],1,it);if(!b)return null;const E=i.parse(e[e.length-1],e.length-1,u);return E?"value"!==b.type.kind&&i.concat(1).checkSubtype(a,b.type)?null:new Bc(a,u,b,f,_,E):null}evaluate(e){const i=this.input.evaluate(e);return(Bi(i)===this.inputType&&this.outputs[this.cases[i]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],i=Object.keys(this.cases).sort(),a=[],u={};for(const _ of i){const b=u[this.cases[_]];void 0===b?(u[this.cases[_]]=a.length,a.push([this.cases[_],[_]])):a[b][1].push(_)}const f=_=>"number"===this.inputType.kind?Number(_):_;for(const[_,b]of a)e.push(1===b.length?f(b[0]):b.map(f)),e.push(this.outputs[_].serialize());return e.push(this.otherwise.serialize()),e}}var Nc=Bc;class fl{constructor(e,i,a){this.type=e,this.branches=i,this.otherwise=a}static parse(e,i){if(e.length<4)return i.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return i.error("Expected an odd number of arguments.");let a;i.expectedType&&"value"!==i.expectedType.kind&&(a=i.expectedType);const u=[];for(let _=1;_<e.length-1;_+=2){const b=i.parse(e[_],_,_e);if(!b)return null;const E=i.parse(e[_+1],_+1,a);if(!E)return null;u.push([b,E]),a=a||E.type}const f=i.parse(e[e.length-1],e.length-1,a);return f?new fl(a,u,f):null}evaluate(e){for(const[i,a]of this.branches)if(i.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[i,a]of this.branches)e(i),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,i])=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(i=>{e.push(i.serialize())}),e}}var Bl=fl;class Ia{constructor(e,i,a,u){this.type=e,this.input=i,this.beginIndex=a,this.endIndex=u}static parse(e,i){if(e.length<=2||e.length>=5)return i.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=i.parse(e[1],1,it),u=i.parse(e[2],2,ei);if(!a||!u)return null;if(!Ii(a.type,[Tn(it),Vi,it]))return i.error(`Expected first argument to be of type array or string, but found ${xn(a.type)} instead`);if(4===e.length){const f=i.parse(e[3],3,ei);return f?new Ia(a.type,a,u,f):null}return new Ia(a.type,a,u)}evaluate(e){const i=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!zi(i,["string","array"]))throw new Jo(`Expected first argument to be of type array or string, but found ${xn(Bi(i))} instead.`);if(this.endIndex){const u=this.endIndex.evaluate(e);return i.slice(a,u)}return i.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var Nl=Ia;function ml(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function fu(t,e,i,a){return 0===a.compare(e,i)}function Ba(t,e,i){const a="=="!==t&&"!="!==t;return class O1{constructor(f,_,b){this.type=_e,this.lhs=f,this.rhs=_,this.collator=b,this.hasUntypedArgument="value"===f.type.kind||"value"===_.type.kind}static parse(f,_){if(3!==f.length&&4!==f.length)return _.error("Expected two or three arguments.");const b=f[0];let E=_.parse(f[1],1,it);if(!E)return null;if(!ml(b,E.type))return _.concat(1).error(`"${b}" comparisons are not supported for type '${xn(E.type)}'.`);let D=_.parse(f[2],2,it);if(!D)return null;if(!ml(b,D.type))return _.concat(2).error(`"${b}" comparisons are not supported for type '${xn(D.type)}'.`);if(E.type.kind!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return _.error(`Cannot compare types '${xn(E.type)}' and '${xn(D.type)}'.`);a&&("value"===E.type.kind&&"value"!==D.type.kind?E=new xr(D.type,[E]):"value"!==E.type.kind&&"value"===D.type.kind&&(D=new xr(E.type,[D])));let k=null;if(4===f.length){if("string"!==E.type.kind&&"string"!==D.type.kind&&"value"!==E.type.kind&&"value"!==D.type.kind)return _.error("Cannot use collator to compare non-string types.");if(k=_.parse(f[3],3,Bt),!k)return null}return new O1(E,D,k)}evaluate(f){const _=this.lhs.evaluate(f),b=this.rhs.evaluate(f);if(a&&this.hasUntypedArgument){const E=Bi(_),D=Bi(b);if(E.kind!==D.kind||"string"!==E.kind&&"number"!==E.kind)throw new Jo(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${E.kind}, ${D.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const E=Bi(_),D=Bi(b);if("string"!==E.kind||"string"!==D.kind)return e(f,_,b)}return this.collator?i(f,_,b,this.collator.evaluate(f)):e(f,_,b)}eachChild(f){f(this.lhs),f(this.rhs),this.collator&&f(this.collator)}outputDefined(){return!0}serialize(){const f=[t];return this.eachChild(_=>{f.push(_.serialize())}),f}}}const ac=Ba("==",function(t,e,i){return e===i},fu),mu=Ba("!=",function(t,e,i){return e!==i},function(t,e,i,a){return!fu(0,e,i,a)}),zl=Ba("<",function(t,e,i){return e<i},function(t,e,i,a){return a.compare(e,i)<0}),lc=Ba(">",function(t,e,i){return e>i},function(t,e,i,a){return a.compare(e,i)>0}),zc=Ba("<=",function(t,e,i){return e<=i},function(t,e,i,a){return a.compare(e,i)<=0}),Uc=Ba(">=",function(t,e,i){return e>=i},function(t,e,i,a){return a.compare(e,i)>=0});class Ul{constructor(e,i,a,u,f,_){this.type=Vi,this.number=e,this.locale=i,this.currency=a,this.unit=u,this.minFractionDigits=f,this.maxFractionDigits=_}static parse(e,i){if(3!==e.length)return i.error("Expected two arguments.");const a=i.parse(e[1],1,ei);if(!a)return null;const u=e[2];if("object"!=typeof u||Array.isArray(u))return i.error("NumberFormat options argument must be an object.");let f=null;if(u.locale&&(f=i.parse(u.locale,1,Vi),!f))return null;let _=null;if(u.currency&&(_=i.parse(u.currency,1,Vi),!_))return null;let b=null;if(u.unit&&(b=i.parse(u.unit,1,Vi),!b))return null;let E=null;if(u["min-fraction-digits"]&&(E=i.parse(u["min-fraction-digits"],1,ei),!E))return null;let D=null;return u["max-fraction-digits"]&&(D=i.parse(u["max-fraction-digits"],1,ei),!D)?null:new Ul(a,f,_,b,E,D)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Na{constructor(e){this.type=ei,this.input=e}static parse(e,i){if(2!==e.length)return i.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=i.parse(e[1],1);return a?"array"!==a.type.kind&&"string"!==a.type.kind&&"value"!==a.type.kind?i.error(`Expected argument of type string or array, but found ${xn(a.type)} instead.`):new Na(a):null}evaluate(e){const i=this.input.evaluate(e);if("string"==typeof i||Array.isArray(i))return i.length;throw new Jo(`Expected value to be of type string or array, but found ${xn(Bi(i))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(i=>{e.push(i.serialize())}),e}}const cc={"==":ac,"!=":mu,">":lc,"<":zl,">=":Uc,"<=":zc,array:xr,at:fd,boolean:xr,case:Bl,coalesce:Rs,collator:bs,format:Ri,image:us,in:fa,"index-of":sc,interpolate:ps,"interpolate-hcl":ps,"interpolate-lab":ps,length:Na,let:Or,literal:jo,match:Nc,number:xr,"number-format":Ul,object:xr,slice:Nl,step:Ln,string:xr,"to-boolean":ko,"to-color":ko,"to-number":ko,"to-string":ko,var:oa,within:Ts};function uc(t,[e,i,a,u]){e=e.evaluate(t),i=i.evaluate(t),a=a.evaluate(t);const f=u?u.evaluate(t):1,_=mi(e,i,a,f);if(_)throw new Jo(_);return new wo(e/255*f,i/255*f,a/255*f,f)}function ra(t,e){return t in e}function ma(t,e){const i=e[t];return void 0===i?null:i}function Z(t){return{type:t}}br.register(cc,{error:[{kind:"error"},[Vi],(t,[e])=>{throw new Jo(e.evaluate(t))}],typeof:[Vi,[it],(t,[e])=>xn(Bi(e.evaluate(t)))],"to-rgba":[Tn(ei,4),[st],(t,[e])=>e.evaluate(t).toArray()],rgb:[st,[ei,ei,ei],uc],rgba:[st,[ei,ei,ei,ei],uc],has:{type:_e,overloads:[[[Vi],(t,[e])=>ra(e.evaluate(t),t.properties())],[[Vi,ke],(t,[e,i])=>ra(e.evaluate(t),i.evaluate(t))]]},get:{type:it,overloads:[[[Vi],(t,[e])=>ma(e.evaluate(t),t.properties())],[[Vi,ke],(t,[e,i])=>ma(e.evaluate(t),i.evaluate(t))]]},"feature-state":[it,[Vi],(t,[e])=>ma(e.evaluate(t),t.featureState||{})],properties:[ke,[],t=>t.properties()],"geometry-type":[Vi,[],t=>t.geometryType()],id:[it,[],t=>t.id()],zoom:[ei,[],t=>t.globals.zoom],pitch:[ei,[],t=>t.globals.pitch||0],"distance-from-center":[ei,[],t=>t.distanceFromCenter()],"heatmap-density":[ei,[],t=>t.globals.heatmapDensity||0],"line-progress":[ei,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[ei,[],t=>t.globals.skyRadialProgress||0],accumulated:[it,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[ei,Z(ei),(t,e)=>{let i=0;for(const a of e)i+=a.evaluate(t);return i}],"*":[ei,Z(ei),(t,e)=>{let i=1;for(const a of e)i*=a.evaluate(t);return i}],"-":{type:ei,overloads:[[[ei,ei],(t,[e,i])=>e.evaluate(t)-i.evaluate(t)],[[ei],(t,[e])=>-e.evaluate(t)]]},"/":[ei,[ei,ei],(t,[e,i])=>e.evaluate(t)/i.evaluate(t)],"%":[ei,[ei,ei],(t,[e,i])=>e.evaluate(t)%i.evaluate(t)],ln2:[ei,[],()=>Math.LN2],pi:[ei,[],()=>Math.PI],e:[ei,[],()=>Math.E],"^":[ei,[ei,ei],(t,[e,i])=>Math.pow(e.evaluate(t),i.evaluate(t))],sqrt:[ei,[ei],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[ei,[ei],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[ei,[ei],(t,[e])=>Math.log(e.evaluate(t))],log2:[ei,[ei],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[ei,[ei],(t,[e])=>Math.sin(e.evaluate(t))],cos:[ei,[ei],(t,[e])=>Math.cos(e.evaluate(t))],tan:[ei,[ei],(t,[e])=>Math.tan(e.evaluate(t))],asin:[ei,[ei],(t,[e])=>Math.asin(e.evaluate(t))],acos:[ei,[ei],(t,[e])=>Math.acos(e.evaluate(t))],atan:[ei,[ei],(t,[e])=>Math.atan(e.evaluate(t))],min:[ei,Z(ei),(t,e)=>Math.min(...e.map(i=>i.evaluate(t)))],max:[ei,Z(ei),(t,e)=>Math.max(...e.map(i=>i.evaluate(t)))],abs:[ei,[ei],(t,[e])=>Math.abs(e.evaluate(t))],round:[ei,[ei],(t,[e])=>{const i=e.evaluate(t);return i<0?-Math.round(-i):Math.round(i)}],floor:[ei,[ei],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[ei,[ei],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[_e,[Vi,it],(t,[e,i])=>t.properties()[e.value]===i.value],"filter-id-==":[_e,[it],(t,[e])=>t.id()===e.value],"filter-type-==":[_e,[Vi],(t,[e])=>t.geometryType()===e.value],"filter-<":[_e,[Vi,it],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a<u}],"filter-id-<":[_e,[it],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i<a}],"filter->":[_e,[Vi,it],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a>u}],"filter-id->":[_e,[it],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i>a}],"filter-<=":[_e,[Vi,it],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a<=u}],"filter-id-<=":[_e,[it],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i<=a}],"filter->=":[_e,[Vi,it],(t,[e,i])=>{const a=t.properties()[e.value],u=i.value;return typeof a==typeof u&&a>=u}],"filter-id->=":[_e,[it],(t,[e])=>{const i=t.id(),a=e.value;return typeof i==typeof a&&i>=a}],"filter-has":[_e,[it],(t,[e])=>e.value in t.properties()],"filter-has-id":[_e,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[_e,[Tn(Vi)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[_e,[Tn(it)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[_e,[Vi,Tn(it)],(t,[e,i])=>i.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[_e,[Vi,Tn(it)],(t,[e,i])=>function(a,u,f,_){for(;f<=_;){const b=f+_>>1;if(u[b]===a)return!0;u[b]>a?_=b-1:f=b+1}return!1}(t.properties()[e.value],i.value,0,i.value.length-1)],all:{type:_e,overloads:[[[_e,_e],(t,[e,i])=>e.evaluate(t)&&i.evaluate(t)],[Z(_e),(t,e)=>{for(const i of e)if(!i.evaluate(t))return!1;return!0}]]},any:{type:_e,overloads:[[[_e,_e],(t,[e,i])=>e.evaluate(t)||i.evaluate(t)],[Z(_e),(t,e)=>{for(const i of e)if(i.evaluate(t))return!0;return!1}]]},"!":[_e,[_e],(t,[e])=>!e.evaluate(t)],"is-supported-script":[_e,[Vi],(t,[e])=>{const i=t.globals&&t.globals.isSupportedScript;return!i||i(e.evaluate(t))}],upcase:[Vi,[Vi],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[Vi,[Vi],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[Vi,Z(it),(t,e)=>e.map(i=>er(i.evaluate(t))).join("")],"resolved-locale":[Vi,[Bt],(t,[e])=>e.evaluate(t).resolvedLocale()]});var de=cc;function q(t){return{result:"success",value:t}}function be(t){return{result:"error",value:t}}function Tt(t){return"data-driven"===t["property-type"]}function vn(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Dn(t){return!!t.expression&&t.expression.interpolated}function Qn(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Co(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function _o(t){return t}function Ki(t,e){const i="color"===e.type,a=t.stops&&"object"==typeof t.stops[0][0],u=a||!(a||void 0!==t.property),f=t.type||(Dn(e)?"exponential":"interval");if(i&&((t=Qo({},t)).stops&&(t.stops=t.stops.map(D=>[D[0],wo.parse(D[1])])),t.default=wo.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!kl[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let _,b,E;if("exponential"===f)_=Eo;else if("interval"===f)_=Ro;else if("categorical"===f){_=fr,b=Object.create(null);for(const D of t.stops)b[D[0]]=D[1];E=typeof t.stops[0][0]}else{if("identity"!==f)throw new Error(`Unknown function type "${f}"`);_=Ls}if(a){const D={},k=[];for(let K=0;K<t.stops.length;K++){const te=t.stops[K],he=te[0].zoom;void 0===D[he]&&(D[he]={zoom:he,type:t.type,property:t.property,default:t.default,stops:[]},k.push(he)),D[he].stops.push([te[0].value,te[1]])}const z=[];for(const K of k)z.push([D[K].zoom,Ki(D[K],e)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:ps.interpolationFactor.bind(void 0,j),zoomStops:z.map(K=>K[0]),evaluate:({zoom:K},te)=>Eo({stops:z,base:t.base},e,K).evaluate(K,te)}}if(u){const D="exponential"===f?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:D,interpolationFactor:ps.interpolationFactor.bind(void 0,D),zoomStops:t.stops.map(k=>k[0]),evaluate:({zoom:k})=>_(t,e,k,b,E)}}return{kind:"source",evaluate(D,k){const z=k&&k.properties?k.properties[t.property]:void 0;return void 0===z?lo(t.default,e.default):_(t,e,z,b,E)}}}function lo(t,e,i){return void 0!==t?t:void 0!==e?e:void 0!==i?i:void 0}function fr(t,e,i,a,u){return lo(typeof i===u?a[i]:void 0,t.default,e.default)}function Ro(t,e,i){if("number"!==Qn(i))return lo(t.default,e.default);const a=t.stops.length;if(1===a||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[a-1][0])return t.stops[a-1][1];const u=ne(t.stops.map(f=>f[0]),i);return t.stops[u][1]}function Eo(t,e,i){const a=void 0!==t.base?t.base:1;if("number"!==Qn(i))return lo(t.default,e.default);const u=t.stops.length;if(1===u||i<=t.stops[0][0])return t.stops[0][1];if(i>=t.stops[u-1][0])return t.stops[u-1][1];const f=ne(t.stops.map(k=>k[0]),i),_=function(k,z,j,K){const te=K-j,he=k-j;return 0===te?0:1===z?he/te:(Math.pow(z,he)-1)/(Math.pow(z,te)-1)}(i,a,t.stops[f][0],t.stops[f+1][0]),b=t.stops[f][1],E=t.stops[f+1][1];let D=Zi[e.type]||_o;if(t.colorSpace&&"rgb"!==t.colorSpace){const k=kl[t.colorSpace];D=(z,j)=>k.reverse(k.interpolate(k.forward(z),k.forward(j),_))}return"function"==typeof b.evaluate?{evaluate(...k){const z=b.evaluate.apply(void 0,k),j=E.evaluate.apply(void 0,k);if(void 0!==z&&void 0!==j)return D(z,j,_)}}:D(b,E,_)}function Ls(t,e,i){return"color"===e.type?i=wo.parse(i):"formatted"===e.type?i=hr.fromString(i.toString()):"resolvedImage"===e.type?i=bo.fromString(i.toString()):Qn(i)===e.type||"enum"===e.type&&e.values[i]||(i=void 0),lo(i,t.default,e.default)}class Ds{constructor(e,i){var a;this.expression=e,this._warningHistory={},this._evaluator=new Fr,this._defaultValue=i?"color"===(a=i).type&&(Co(a.default)||Array.isArray(a.default))?new wo(0,0,0,0):"color"===a.type?wo.parse(a.default)||null:void 0===a.default?null:a.default:null,this._enumValues=i&&"enum"===i.type?i.values:null}evaluateWithoutErrorHandling(e,i,a,u,f,_,b,E){return this._evaluator.globals=e,this._evaluator.feature=i,this._evaluator.featureState=a,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(e,i,a,u,f,_,b,E){this._evaluator.globals=e,this._evaluator.feature=i||null,this._evaluator.featureState=a||null,this._evaluator.canonical=u||null,this._evaluator.availableImages=f||null,this._evaluator.formattedSection=_||null,this._evaluator.featureTileCoord=b||null,this._evaluator.featureDistanceData=E||null;try{const D=this.expression.evaluate(this._evaluator);if(null==D||"number"==typeof D&&D!=D)return this._defaultValue;if(this._enumValues&&!(D in this._enumValues))throw new Jo(`Expected value to be one of ${Object.keys(this._enumValues).map(k=>JSON.stringify(k)).join(", ")}, but found ${JSON.stringify(D)} instead.`);return D}catch(D){return this._warningHistory[D.message]||(this._warningHistory[D.message]=!0,typeof console<"u"&&console.warn(D.message)),this._defaultValue}}}function fs(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in de}function Vr(t,e){const i=new re(de,[],e?function(u){const f={color:st,string:Vi,number:ei,enum:Vi,boolean:_e,formatted:zt,resolvedImage:yn};return"array"===u.type?Tn(f[u.value]||it,u.length):f[u.type]}(e):void 0),a=i.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return a?q(new Ds(a,e)):be(i.errors)}class qs{constructor(e,i){this.kind=e,this._styleExpression=i,this.isStateDependent="constant"!==e&&!pr(i.expression)}evaluateWithoutErrorHandling(e,i,a,u,f,_){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,u,f,_)}evaluate(e,i,a,u,f,_){return this._styleExpression.evaluate(e,i,a,u,f,_)}}class os{constructor(e,i,a,u){this.kind=e,this.zoomStops=a,this._styleExpression=i,this.isStateDependent="camera"!==e&&!pr(i.expression),this.interpolationType=u}evaluateWithoutErrorHandling(e,i,a,u,f,_){return this._styleExpression.evaluateWithoutErrorHandling(e,i,a,u,f,_)}evaluate(e,i,a,u,f,_){return this._styleExpression.evaluate(e,i,a,u,f,_)}interpolationFactor(e,i,a){return this.interpolationType?ps.interpolationFactor(this.interpolationType,e,i,a):0}}function Ni(t,e){if("error"===(t=Vr(t,e)).result)return t;const i=t.value.expression,a=Cs(i);if(!a&&!Tt(e))return be([new xo("","data expressions not supported")]);const u=Tr(i,["zoom","pitch","distance-from-center"]);if(!u&&!vn(e))return be([new xo("","zoom expressions not supported")]);const f=ms(i);return f||u?f instanceof xo?be([f]):f instanceof ps&&!Dn(e)?be([new xo("",'"interpolate" expressions cannot be used with this property')]):q(f?new os(a?"camera":"composite",t.value,f.labels,f instanceof ps?f.interpolation:void 0):new qs(a?"constant":"source",t.value)):be([new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Zl{constructor(e,i){this._parameters=e,this._specification=i,Qo(this,Ki(this._parameters,this._specification))}static deserialize(e){return new Zl(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ms(t){let e=null;if(t instanceof Or)e=ms(t.result);else if(t instanceof Rs){for(const i of t.args)if(e=ms(i),e)break}else(t instanceof Ln||t instanceof ps)&&t.input instanceof br&&"zoom"===t.input.name&&(e=t);return e instanceof xo||t.eachChild(i=>{const a=ms(i);a instanceof xo?e=a:!e&&a?e=new xo("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new xo("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class ui{constructor(e,i,a,u){this.message=(e?`${e}: `:"")+a,u&&(this.identifier=u),null!=i&&i.__line__&&(this.line=i.__line__)}}function sa(t){const e=t.key,i=t.value,a=t.valueSpec||{},u=t.objectElementValidators||{},f=t.style,_=t.styleSpec;let b=[];const E=Qn(i);if("object"!==E)return[new ui(e,i,`object expected, ${E} found`)];for(const D in i){const k=D.split(".")[0];let z;u[k]?z=u[k]:a[k]?z=es:u["*"]?z=u["*"]:a["*"]&&(z=es),z?b=b.concat(z({key:(e&&`${e}.`)+D,value:i[D],valueSpec:a[k]||a["*"],style:f,styleSpec:_,object:i,objectKey:D},i)):b.push(new ui(e,i[D],`unknown property "${D}"`))}for(const D in a)u[D]||a[D].required&&void 0===a[D].default&&void 0===i[D]&&b.push(new ui(e,i,`missing required property "${D}"`));return b}function gu(t){const e=t.value,i=t.valueSpec,a=t.style,u=t.styleSpec,f=t.key,_=t.arrayElementValidator||es;if("array"!==Qn(e))return[new ui(f,e,`array expected, ${Qn(e)} found`)];if(i.length&&e.length!==i.length)return[new ui(f,e,`array length ${i.length} expected, length ${e.length} found`)];if(i["min-length"]&&e.length<i["min-length"])return[new ui(f,e,`array length at least ${i["min-length"]} expected, length ${e.length} found`)];let b={type:i.value,values:i.values,minimum:i.minimum,maximum:i.maximum,function:void 0};u.$version<7&&(b.function=i.function),"object"===Qn(i.value)&&(b=i.value);let E=[];for(let D=0;D<e.length;D++)E=E.concat(_({array:e,arrayIndex:D,value:e[D],valueSpec:b,style:a,styleSpec:u,key:`${f}[${D}]`}));return E}function gl(t){const e=t.key,i=t.value,a=t.valueSpec;let u=Qn(i);if("number"===u&&i!=i&&(u="NaN"),"number"!==u)return[new ui(e,i,`number expected, ${u} found`)];if("minimum"in a){let f=a.minimum;if("array"===Qn(a.minimum)&&(f=a.minimum[t.arrayIndex]),i<f)return[new ui(e,i,`${i} is less than the minimum value ${f}`)]}if("maximum"in a){let f=a.maximum;if("array"===Qn(a.maximum)&&(f=a.maximum[t.arrayIndex]),i>f)return[new ui(e,i,`${i} is greater than the maximum value ${f}`)]}return[]}function ga(t){const e=t.valueSpec,i=vo(t.value.type);let a,u,f,_={};const b="categorical"!==i&&void 0===t.value.property,E=!b,D="array"===Qn(t.value.stops)&&"array"===Qn(t.value.stops[0])&&"object"===Qn(t.value.stops[0][0]),k=sa({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(K){if("identity"===i)return[new ui(K.key,K.value,'identity function may not have a "stops" property')];let te=[];const he=K.value;return te=te.concat(gu({key:K.key,value:he,valueSpec:K.valueSpec,style:K.style,styleSpec:K.styleSpec,arrayElementValidator:z})),"array"===Qn(he)&&0===he.length&&te.push(new ui(K.key,he,"array must have at least one stop")),te},default:function(K){return es({key:K.key,value:K.value,valueSpec:e,style:K.style,styleSpec:K.styleSpec})}}});return"identity"===i&&b&&k.push(new ui(t.key,t.value,'missing required property "property"')),"identity"===i||t.value.stops||k.push(new ui(t.key,t.value,'missing required property "stops"')),"exponential"===i&&t.valueSpec.expression&&!Dn(t.valueSpec)&&k.push(new ui(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(E&&!Tt(t.valueSpec)?k.push(new ui(t.key,t.value,"property functions not supported")):b&&!vn(t.valueSpec)&&k.push(new ui(t.key,t.value,"zoom functions not supported"))),"categorical"!==i&&!D||void 0!==t.value.property||k.push(new ui(t.key,t.value,'"property" property is required')),k;function z(K){let te=[];const he=K.value,Re=K.key;if("array"!==Qn(he))return[new ui(Re,he,`array expected, ${Qn(he)} found`)];if(2!==he.length)return[new ui(Re,he,`array length 2 expected, length ${he.length} found`)];if(D){if("object"!==Qn(he[0]))return[new ui(Re,he,`object expected, ${Qn(he[0])} found`)];if(void 0===he[0].zoom)return[new ui(Re,he,"object stop key must have zoom")];if(void 0===he[0].value)return[new ui(Re,he,"object stop key must have value")];const rt=vo(he[0].zoom);if("number"!=typeof rt)return[new ui(Re,he[0].zoom,"stop zoom values must be numbers")];if(f&&f>rt)return[new ui(Re,he[0].zoom,"stop zoom values must appear in ascending order")];rt!==f&&(f=rt,u=void 0,_={}),te=te.concat(sa({key:`${Re}[0]`,value:he[0],valueSpec:{zoom:{}},style:K.style,styleSpec:K.styleSpec,objectElementValidators:{zoom:gl,value:j}}))}else te=te.concat(j({key:`${Re}[0]`,value:he[0],valueSpec:{},style:K.style,styleSpec:K.styleSpec},he));return fs(Ji(he[1]))?te.concat([new ui(`${Re}[1]`,he[1],"expressions are not allowed in function stops.")]):te.concat(es({key:`${Re}[1]`,value:he[1],valueSpec:e,style:K.style,styleSpec:K.styleSpec}))}function j(K,te){const he=Qn(K.value),Re=vo(K.value),rt=null!==K.value?K.value:te;if(a){if(he!==a)return[new ui(K.key,rt,`${he} stop domain type must match previous stop domain type ${a}`)]}else a=he;if("number"!==he&&"string"!==he&&"boolean"!==he&&"number"!=typeof Re&&"string"!=typeof Re&&"boolean"!=typeof Re)return[new ui(K.key,rt,"stop domain value must be a number, string, or boolean")];if("number"!==he&&"categorical"!==i){let wt=`number expected, ${he} found`;return Tt(e)&&void 0===i&&(wt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new ui(K.key,rt,wt)]}return"categorical"!==i||"number"!==he||"number"==typeof Re&&isFinite(Re)&&Math.floor(Re)===Re?"categorical"!==i&&"number"===he&&"number"==typeof Re&&"number"==typeof u&&void 0!==u&&Re<u?[new ui(K.key,rt,"stop domain values must appear in ascending order")]:(u=Re,"categorical"===i&&Re in _?[new ui(K.key,rt,"stop domain values must be unique")]:(_[Re]=!0,[])):[new ui(K.key,rt,`integer expected, found ${String(Re)}`)]}}function qo(t){const e=("property"===t.expressionContext?Ni:Vr)(Ji(t.value),t.valueSpec);if("error"===e.result)return e.value.map(a=>new ui(`${t.key}${a.key}`,t.value,a.message));const i=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!i.outputDefined())return[new ui(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!pr(i))return[new ui(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return Vl(i,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Tr(i,["zoom","feature-state"]))return[new ui(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!Cs(i))return[new ui(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Vl(t,e){const i=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const u of e.valueSpec.expression.parameters)i.delete(u);if(0===i.size)return[];const a=[];return t instanceof br&&i.has(t.name)?[new ui(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(u=>{a.push(...Vl(u,e))}),a)}function Ka(t){const e=t.key,i=t.value,a=t.valueSpec,u=[];return Array.isArray(a.values)?-1===a.values.indexOf(vo(i))&&u.push(new ui(e,i,`expected one of [${a.values.join(", ")}], ${JSON.stringify(i)} found`)):-1===Object.keys(a.values).indexOf(vo(i))&&u.push(new ui(e,i,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(i)} found`)),u}function Zc(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Zc(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function dc(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Zc(t)||(t=Aa(t));const i=t;let a=!0;try{a=function(D){if(!_l(D))return D;let k=Ji(D);return Do(k),k=Gn(k),k}(i)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(i,null,2)}\n        `)}const u=en[`filter_${e}`],f=Vr(a,u);let _=null;if("error"===f.result)throw new Error(f.value.map(D=>`${D.key}: ${D.message}`).join(", "));_=(D,k,z)=>f.value.evaluate(D,k,{},z);let b=null,E=null;if(a!==i){const D=Vr(i,u);if("error"===D.result)throw new Error(D.value.map(k=>`${k.key}: ${k.message}`).join(", "));b=(k,z,j,K,te)=>D.value.evaluate(k,z,{},j,void 0,void 0,K,te),E=!Cs(D.value.expression)}return{filter:_,dynamicFilter:b||void 0,needGeometry:pc(a),needFeature:!!E}}function Gn(t){if(!Array.isArray(t))return t;const e=function(i){if(hc.has(i[0]))for(let a=1;a<i.length;a++)if(_l(i[a]))return!0;return i}(t);return!0===e?e:e.map(i=>Gn(i))}function Do(t){let e=!1;const i=[];if("case"===t[0]){for(let a=1;a<t.length-1;a+=2)e=e||_l(t[a]),i.push(t[a+1]);i.push(t[t.length-1])}else if("match"===t[0]){e=e||_l(t[1]);for(let a=2;a<t.length-1;a+=2)i.push(t[a+1]);i.push(t[t.length-1])}else if("step"===t[0]){e=e||_l(t[1]);for(let a=1;a<t.length-1;a+=2)i.push(t[a+1])}e&&(t.length=0,t.push("any",...i));for(let a=1;a<t.length;a++)Do(t[a])}function _l(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let i=1;i<t.length;i++)if(_l(t[i]))return!0;return!1}const hc=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function jr(t,e){return t<e?-1:t>e?1:0}function pc(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(pc(t[e]))return!0;return!1}function Aa(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?ks(t[1],t[2],"=="):"!="===e?Vc(ks(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?ks(t[1],t[2],e):"any"===e?(i=t.slice(1),["any"].concat(i.map(Aa))):"all"===e?["all"].concat(t.slice(1).map(Aa)):"none"===e?["all"].concat(t.slice(1).map(Aa).map(Vc)):"in"===e?Fs(t[1],t.slice(2)):"!in"===e?Vc(Fs(t[1],t.slice(2))):"has"===e?jl(t[1]):"!has"===e?Vc(jl(t[1])):"within"!==e||t;var i}function ks(t,e,i){switch(t){case"$type":return[`filter-type-${i}`,e];case"$id":return[`filter-id-${i}`,e];default:return[`filter-${i}`,t,e]}}function Fs(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(i=>typeof i!=typeof e[0])?["filter-in-large",t,["literal",e.sort(jr)]]:["filter-in-small",t,["literal",e]]}}function jl(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Vc(t){return["!",t]}function jc(t){return Zc(Ji(t.value))?qo(Qo({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):$l(t)}function $l(t){const e=t.value,i=t.key;if("array"!==Qn(e))return[new ui(i,e,`array expected, ${Qn(e)} found`)];const a=t.styleSpec;let u,f=[];if(e.length<1)return[new ui(i,e,"filter array must have at least 1 element")];switch(f=f.concat(Ka({key:`${i}[0]`,value:e[0],valueSpec:a.filter_operator,style:t.style,styleSpec:t.styleSpec})),vo(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===vo(e[1])&&f.push(new ui(i,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&f.push(new ui(i,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(u=Qn(e[1]),"string"!==u&&f.push(new ui(`${i}[1]`,e[1],`string expected, ${u} found`)));for(let _=2;_<e.length;_++)u=Qn(e[_]),"$type"===vo(e[1])?f=f.concat(Ka({key:`${i}[${_}]`,value:e[_],valueSpec:a.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==u&&"number"!==u&&"boolean"!==u&&f.push(new ui(`${i}[${_}]`,e[_],`string, number, or boolean expected, ${u} found`));break;case"any":case"all":case"none":for(let _=1;_<e.length;_++)f=f.concat($l({key:`${i}[${_}]`,value:e[_],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":u=Qn(e[1]),2!==e.length?f.push(new ui(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==u&&f.push(new ui(`${i}[1]`,e[1],`string expected, ${u} found`));break;case"within":u=Qn(e[1]),2!==e.length?f.push(new ui(i,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==u&&f.push(new ui(`${i}[1]`,e[1],`object expected, ${u} found`))}return f}function Wr(t,e){const i=t.key,a=t.style,u=t.styleSpec,f=t.value,_=t.objectKey,b=u[`${e}_${t.layerType}`];if(!b)return[];const E=_.match(/^(.*)-transition$/);if("paint"===e&&E&&b[E[1]]&&b[E[1]].transition)return es({key:i,value:f,valueSpec:u.transition,style:a,styleSpec:u});const D=t.valueSpec||b[_];if(!D)return[new ui(i,f,`unknown property "${_}"`)];let k;if("string"===Qn(f)&&Tt(D)&&!D.tokens&&(k=/^{([^}]+)}$/.exec(f))){const j=`\`{ "type": "identity", "property": ${k?JSON.stringify(k[1]):'"_"'} }\``;return[new ui(i,f,`"${_}" does not support interpolation syntax\nUse an identity property function instead: ${j}.`)]}const z=[];return"symbol"===t.layerType&&("text-field"===_&&a&&!a.glyphs&&z.push(new ui(i,f,'use of "text-field" requires a style "glyphs" property')),"text-font"===_&&Co(Ji(f))&&"identity"===vo(f.type)&&z.push(new ui(i,f,'"text-font" does not support identity functions'))),z.concat(es({key:t.key,value:f,valueSpec:D,style:a,styleSpec:u,expressionContext:"property",propertyType:e,propertyKey:_}))}function aa(t){return Wr(t,"paint")}function yl(t){return Wr(t,"layout")}function Xa(t){let e=[];const i=t.value,a=t.key,u=t.style,f=t.styleSpec;i.type||i.ref||e.push(new ui(a,i,'either "type" or "ref" is required'));let _=vo(i.type);const b=vo(i.ref);if(i.id){const E=vo(i.id);for(let D=0;D<t.arrayIndex;D++){const k=u.layers[D];vo(k.id)===E&&e.push(new ui(a,i.id,`duplicate layer id "${i.id}", previously used at line ${k.id.__line__}`))}}if("ref"in i){let E;["type","source","source-layer","filter","layout"].forEach(D=>{D in i&&e.push(new ui(a,i[D],`"${D}" is prohibited for ref layers`))}),u.layers.forEach(D=>{vo(D.id)===b&&(E=D)}),E?E.ref?e.push(new ui(a,i.ref,"ref cannot reference another ref layer")):_=vo(E.type):"string"==typeof b&&e.push(new ui(a,i.ref,`ref layer "${b}" not found`))}else if("background"!==_&&"sky"!==_)if(i.source){const E=u.sources&&u.sources[i.source],D=E&&vo(E.type);E?"vector"===D&&"raster"===_?e.push(new ui(a,i.source,`layer "${i.id}" requires a raster source`)):"raster"===D&&"raster"!==_?e.push(new ui(a,i.source,`layer "${i.id}" requires a vector source`)):"vector"!==D||i["source-layer"]?"raster-dem"===D&&"hillshade"!==_?e.push(new ui(a,i.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==_||!i.paint||!i.paint["line-gradient"]&&!i.paint["line-trim-offset"]||"geojson"===D&&E.lineMetrics||e.push(new ui(a,i,`layer "${i.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new ui(a,i,`layer "${i.id}" must specify a "source-layer"`)):e.push(new ui(a,i.source,`source "${i.source}" not found`))}else e.push(new ui(a,i,'missing required property "source"'));return e=e.concat(sa({key:a,value:i,valueSpec:f.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>es({key:`${a}.type`,value:i.type,valueSpec:f.layer.type,style:t.style,styleSpec:t.styleSpec,object:i,objectKey:"type"}),filter:E=>jc(Qo({layerType:_},E)),layout:E=>sa({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>yl(Qo({layerType:_},D))}}),paint:E=>sa({layer:i,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":D=>aa(Qo({layerType:_},D))}})}})),e}function rs(t){const e=t.value,i=t.key,a=Qn(e);return"string"!==a?[new ui(i,e,`string expected, ${a} found`)]:[]}const md={promoteId:function({key:t,value:e}){if("string"===Qn(e))return rs({key:t,value:e});{const i=[];for(const a in e)i.push(...rs({key:`${t}.${a}`,value:e[a]}));return i}}};function fc(t){const e=t.value,i=t.key,a=t.styleSpec,u=t.style;if(!e.type)return[new ui(i,e,'"type" is required')];const f=vo(e.type);let _;switch(f){case"vector":case"raster":case"raster-dem":return _=sa({key:i,value:e,valueSpec:a[`source_${f.replace("-","_")}`],style:t.style,styleSpec:a,objectElementValidators:md}),_;case"geojson":if(_=sa({key:i,value:e,valueSpec:a.source_geojson,style:u,styleSpec:a,objectElementValidators:md}),e.cluster)for(const b in e.clusterProperties){const[E,D]=e.clusterProperties[b],k="string"==typeof E?[E,["accumulated"],["get",b]]:E;_.push(...qo({key:`${i}.${b}.map`,value:D,expressionContext:"cluster-map"})),_.push(...qo({key:`${i}.${b}.reduce`,value:k,expressionContext:"cluster-reduce"}))}return _;case"video":return sa({key:i,value:e,valueSpec:a.source_video,style:u,styleSpec:a});case"image":return sa({key:i,value:e,valueSpec:a.source_image,style:u,styleSpec:a});case"canvas":return[new ui(i,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ka({key:`${i}.type`,value:e.type,valueSpec:{values:gd(a)},style:u,styleSpec:a})}}function gd(t){return t.source.reduce((e,i)=>{const a=t[i];return"enum"===a.type.type&&(e=e.concat(Object.keys(a.type.values))),e},[])}function _d(t){const e=t.value,i=t.styleSpec,a=i.light,u=t.style;let f=[];const _=Qn(e);if(void 0===e)return f;if("object"!==_)return f=f.concat([new ui("light",e,`object expected, ${_} found`)]),f;for(const b in e){const E=b.match(/^(.*)-transition$/);f=f.concat(E&&a[E[1]]&&a[E[1]].transition?es({key:b,value:e[b],valueSpec:i.transition,style:u,styleSpec:i}):a[b]?es({key:b,value:e[b],valueSpec:a[b],style:u,styleSpec:i}):[new ui(b,e[b],`unknown property "${b}"`)])}return f}function mc(t){const e=t.value,i=t.key,a=t.style,u=t.styleSpec,f=u.terrain;let _=[];const b=Qn(e);if(void 0===e)return _;if("object"!==b)return _=_.concat([new ui("terrain",e,`object expected, ${b} found`)]),_;for(const E in e){const D=E.match(/^(.*)-transition$/);_=_.concat(D&&f[D[1]]&&f[D[1]].transition?es({key:E,value:e[E],valueSpec:u.transition,style:a,styleSpec:u}):f[E]?es({key:E,value:e[E],valueSpec:f[E],style:a,styleSpec:u}):[new ui(E,e[E],`unknown property "${E}"`)])}if(e.source){const E=a.sources&&a.sources[e.source],D=E&&vo(E.type);E?"raster-dem"!==D&&_.push(new ui(i,e.source,`terrain cannot be used with a source of type ${String(D)}, it only be used with a "raster-dem" source type`)):_.push(new ui(i,e.source,`source "${e.source}" not found`))}else _.push(new ui(i,e,'terrain is missing required property "source"'));return _}function $c(t){const e=t.value,i=t.style,a=t.styleSpec,u=a.fog;let f=[];const _=Qn(e);if(void 0===e)return f;if("object"!==_)return f=f.concat([new ui("fog",e,`object expected, ${_} found`)]),f;for(const b in e){const E=b.match(/^(.*)-transition$/);f=f.concat(E&&u[E[1]]&&u[E[1]].transition?es({key:b,value:e[b],valueSpec:a.transition,style:i,styleSpec:a}):u[b]?es({key:b,value:e[b],valueSpec:u[b],style:i,styleSpec:a}):[new ui(b,e[b],`unknown property "${b}"`)])}return f}const Hc={"*":()=>[],array:gu,boolean:function(t){const e=t.value,i=t.key,a=Qn(e);return"boolean"!==a?[new ui(i,e,`boolean expected, ${a} found`)]:[]},number:gl,color:function(t){const e=t.key,i=t.value,a=Qn(i);return"string"!==a?[new ui(e,i,`color expected, ${a} found`)]:null===Lo(i)?[new ui(e,i,`color expected, "${i}" found`)]:[]},enum:Ka,filter:jc,function:ga,layer:Xa,object:sa,source:fc,light:_d,terrain:mc,fog:$c,string:rs,formatted:function(t){return 0===rs(t).length?[]:qo(t)},resolvedImage:function(t){return 0===rs(t).length?[]:qo(t)},projection:function(t){const e=t.value,i=t.styleSpec,a=i.projection,u=t.style;let f=[];const _=Qn(e);if("object"===_)for(const b in e)f=f.concat(es({key:b,value:e[b],valueSpec:a[b],style:u,styleSpec:i}));else"string"!==_&&(f=f.concat([new ui("projection",e,`object or string expected, ${_} found`)]));return f}};function es(t){const e=t.value,i=t.valueSpec,a=t.styleSpec;return i.expression&&Co(vo(e))?ga(t):i.expression&&fs(Ji(e))?qo(t):i.type&&Hc[i.type]?Hc[i.type](t):sa(Qo({},t,{valueSpec:i.type?a[i.type]:i}))}function _u(t){const e=t.value,i=t.key,a=rs(t);return a.length||(-1===e.indexOf("{fontstack}")&&a.push(new ui(i,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&a.push(new ui(i,e,'"glyphs" url must include a "{range}" token'))),a}function Gc(t,e=en){return Bs(es({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:_u,"*":()=>[]}}))}const Wc=t=>Bs(aa(t)),yu=t=>Bs(yl(t));function Bs(t){return t.slice().sort((e,i)=>e.line&&i.line?e.line-i.line:0)}function qc(t,e){let i=!1;if(e&&e.length)for(const a of e)t.fire(new Pi(new Error(a.message))),i=!0;return i}var vu=_a,Ns=3;function _a(t,e,i){var a=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var u=new Int32Array(this.arrayBuffer);t=u[0],this.d=(e=u[1])+2*(i=u[2]);for(var f=0;f<this.d*this.d;f++){var _=u[Ns+f],b=u[Ns+f+1];a.push(_===b?null:u.subarray(_,b))}var E=u[Ns+a.length+1];this.keys=u.subarray(u[Ns+a.length],E),this.bboxes=u.subarray(E),this.insert=this._insertReadonly}else{this.d=e+2*i;for(var D=0;D<this.d*this.d;D++)a.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=i,this.scale=e/t,this.uid=0;var k=i/e*t;this.min=-k,this.max=t+k}_a.prototype.insert=function(t,e,i,a,u){this._forEachCell(e,i,a,u,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(i),this.bboxes.push(a),this.bboxes.push(u)},_a.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},_a.prototype._insertCell=function(t,e,i,a,u,f){this.cells[u].push(f)},_a.prototype.query=function(t,e,i,a,u){var f=this.min,_=this.max;if(t<=f&&e<=f&&_<=i&&_<=a&&!u)return Array.prototype.slice.call(this.keys);var b=[];return this._forEachCell(t,e,i,a,this._queryCell,b,{},u),b},_a.prototype._queryCell=function(t,e,i,a,u,f,_,b){var E=this.cells[u];if(null!==E)for(var D=this.keys,k=this.bboxes,z=0;z<E.length;z++){var j=E[z];if(void 0===_[j]){var K=4*j;(b?b(k[K+0],k[K+1],k[K+2],k[K+3]):t<=k[K+2]&&e<=k[K+3]&&i>=k[K+0]&&a>=k[K+1])?(_[j]=!0,f.push(D[j])):_[j]=!1}}},_a.prototype._forEachCell=function(t,e,i,a,u,f,_,b){for(var E=this._convertToCellCoord(t),D=this._convertToCellCoord(e),k=this._convertToCellCoord(i),z=this._convertToCellCoord(a),j=E;j<=k;j++)for(var K=D;K<=z;K++){var te=this.d*K+j;if((!b||b(this._convertFromCellCoord(j),this._convertFromCellCoord(K),this._convertFromCellCoord(j+1),this._convertFromCellCoord(K+1)))&&u.call(this,t,e,i,a,te,f,_,b))return}},_a.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},_a.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},_a.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=Ns+this.cells.length+1+1,i=0,a=0;a<this.cells.length;a++)i+=this.cells[a].length;var u=new Int32Array(e+i+this.keys.length+this.bboxes.length);u[0]=this.extent,u[1]=this.n,u[2]=this.padding;for(var f=e,_=0;_<t.length;_++){var b=t[_];u[Ns+_]=f,u.set(b,f),f+=b.length}return u[Ns+t.length]=f,u.set(this.keys,f),u[Ns+t.length+1]=f+=this.keys.length,u.set(this.bboxes,f),f+=this.bboxes.length,u.buffer};var za=we(vu);const qr={};function di(t,e,i={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),qr[e]={klass:t,omit:i.omit||[]}}di(Object,"Object"),za.serialize=function(t,e){const i=t.toArrayBuffer();return e&&e.push(i),{buffer:i}},za.deserialize=function(t){return new za(t.buffer)},Object.defineProperty(za,"name",{value:"Grid"}),di(za,"Grid"),di(wo,"Color"),di(Error,"Error"),di(Ci,"AJAXError"),di(bo,"ResolvedImage"),di(Zl,"StylePropertyFunction"),di(Ds,"StyleExpression",{omit:["_evaluator"]}),di(os,"ZoomDependentExpression"),di(qs,"ZoomConstantExpression"),di(br,"CompoundExpression",{omit:["_evaluate"]});for(const t in de)qr[de[t]._classRegistryKey]||di(de[t],`Expression${t}`);function _r(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function xu(t){return Q.ImageBitmap&&t instanceof Q.ImageBitmap}function Hl(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(_r(t)||xu(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const i=t;return e&&e.push(i.buffer),i}if(t instanceof Q.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const i=[];for(const a of t)i.push(Hl(a,e));return i}if("object"==typeof t){const i=t.constructor,a=i._classRegistryKey;if(!a)throw new Error(`can't serialize object of unregistered class ${a}`);const u=i.serialize?i.serialize(t,e):{};if(!i.serialize){for(const f in t)t.hasOwnProperty(f)&&(qr[a].omit.indexOf(f)>=0||(u[f]=Hl(t[f],e)));t instanceof Error&&(u.message=t.message)}if(u.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==a&&(u.$name=a),u}throw new Error("can't serialize object of type "+typeof t)}function vl(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||_r(t)||xu(t)||ArrayBuffer.isView(t)||t instanceof Q.ImageData)return t;if(Array.isArray(t))return t.map(vl);if("object"==typeof t){const e=t.$name||"Object",{klass:i}=qr[e];if(!i)throw new Error(`can't deserialize unregistered class ${e}`);if(i.deserialize)return i.deserialize(t);const a=Object.create(i.prototype);for(const u of Object.keys(t))"$name"!==u&&(a[u]=vl(t[u]));return a}throw new Error("can't deserialize object of type "+typeof t)}const li={"Latin-1 Supplement":t=>t>=128&&t<=255,Arabic:t=>t>=1536&&t<=1791,"Arabic Supplement":t=>t>=1872&&t<=1919,"Arabic Extended-A":t=>t>=2208&&t<=2303,"Hangul Jamo":t=>t>=4352&&t<=4607,"Unified Canadian Aboriginal Syllabics":t=>t>=5120&&t<=5759,Khmer:t=>t>=6016&&t<=6143,"Unified Canadian Aboriginal Syllabics Extended":t=>t>=6320&&t<=6399,"General Punctuation":t=>t>=8192&&t<=8303,"Letterlike Symbols":t=>t>=8448&&t<=8527,"Number Forms":t=>t>=8528&&t<=8591,"Miscellaneous Technical":t=>t>=8960&&t<=9215,"Control Pictures":t=>t>=9216&&t<=9279,"Optical Character Recognition":t=>t>=9280&&t<=9311,"Enclosed Alphanumerics":t=>t>=9312&&t<=9471,"Geometric Shapes":t=>t>=9632&&t<=9727,"Miscellaneous Symbols":t=>t>=9728&&t<=9983,"Miscellaneous Symbols and Arrows":t=>t>=11008&&t<=11263,"CJK Radicals Supplement":t=>t>=11904&&t<=12031,"Kangxi Radicals":t=>t>=12032&&t<=12255,"Ideographic Description Characters":t=>t>=12272&&t<=12287,"CJK Symbols and Punctuation":t=>t>=12288&&t<=12351,Hiragana:t=>t>=12352&&t<=12447,Katakana:t=>t>=12448&&t<=12543,Bopomofo:t=>t>=12544&&t<=12591,"Hangul Compatibility Jamo":t=>t>=12592&&t<=12687,Kanbun:t=>t>=12688&&t<=12703,"Bopomofo Extended":t=>t>=12704&&t<=12735,"CJK Strokes":t=>t>=12736&&t<=12783,"Katakana Phonetic Extensions":t=>t>=12784&&t<=12799,"Enclosed CJK Letters and Months":t=>t>=12800&&t<=13055,"CJK Compatibility":t=>t>=13056&&t<=13311,"CJK Unified Ideographs Extension A":t=>t>=13312&&t<=19903,"Yijing Hexagram Symbols":t=>t>=19904&&t<=19967,"CJK Unified Ideographs":t=>t>=19968&&t<=40959,"Yi Syllables":t=>t>=40960&&t<=42127,"Yi Radicals":t=>t>=42128&&t<=42191,"Hangul Jamo Extended-A":t=>t>=43360&&t<=43391,"Hangul Syllables":t=>t>=44032&&t<=55215,"Hangul Jamo Extended-B":t=>t>=55216&&t<=55295,"Private Use Area":t=>t>=57344&&t<=63743,"CJK Compatibility Ideographs":t=>t>=63744&&t<=64255,"Arabic Presentation Forms-A":t=>t>=64336&&t<=65023,"Vertical Forms":t=>t>=65040&&t<=65055,"CJK Compatibility Forms":t=>t>=65072&&t<=65103,"Small Form Variants":t=>t>=65104&&t<=65135,"Arabic Presentation Forms-B":t=>t>=65136&&t<=65279,"Halfwidth and Fullwidth Forms":t=>t>=65280&&t<=65519};function L(t){for(const e of t)if(U(e.charCodeAt(0)))return!0;return!1}function B(t){for(const e of t)if(!A(e.charCodeAt(0)))return!1;return!0}function A(t){return!(li.Arabic(t)||li["Arabic Supplement"](t)||li["Arabic Extended-A"](t)||li["Arabic Presentation Forms-A"](t)||li["Arabic Presentation Forms-B"](t))}function U(t){return!(746!==t&&747!==t&&(t<4352||!(li["Bopomofo Extended"](t)||li.Bopomofo(t)||li["CJK Compatibility Forms"](t)&&!(t>=65097&&t<=65103)||li["CJK Compatibility Ideographs"](t)||li["CJK Compatibility"](t)||li["CJK Radicals Supplement"](t)||li["CJK Strokes"](t)||!(!li["CJK Symbols and Punctuation"](t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||li["CJK Unified Ideographs Extension A"](t)||li["CJK Unified Ideographs"](t)||li["Enclosed CJK Letters and Months"](t)||li["Hangul Compatibility Jamo"](t)||li["Hangul Jamo Extended-A"](t)||li["Hangul Jamo Extended-B"](t)||li["Hangul Jamo"](t)||li["Hangul Syllables"](t)||li.Hiragana(t)||li["Ideographic Description Characters"](t)||li.Kanbun(t)||li["Kangxi Radicals"](t)||li["Katakana Phonetic Extensions"](t)||li.Katakana(t)&&12540!==t||!(!li["Halfwidth and Fullwidth Forms"](t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!li["Small Form Variants"](t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||li["Unified Canadian Aboriginal Syllabics"](t)||li["Unified Canadian Aboriginal Syllabics Extended"](t)||li["Vertical Forms"](t)||li["Yijing Hexagram Symbols"](t)||li["Yi Syllables"](t)||li["Yi Radicals"](t))))}function le(t){return!(U(t)||(e=t,li["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||li["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||li["Letterlike Symbols"](e)||li["Number Forms"](e)||li["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||li["Control Pictures"](e)&&9251!==e||li["Optical Character Recognition"](e)||li["Enclosed Alphanumerics"](e)||li["Geometric Shapes"](e)||li["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||li["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||li["CJK Symbols and Punctuation"](e)||li.Katakana(e)||li["Private Use Area"](e)||li["CJK Compatibility Forms"](e)||li["Small Form Variants"](e)||li["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function Be(t){return t>=1424&&t<=2303||li["Arabic Presentation Forms-A"](t)||li["Arabic Presentation Forms-B"](t)}function qe(t,e){return!(!e&&Be(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||li.Khmer(t))}function Jt(t){for(const e of t)if(Be(e.charCodeAt(0)))return!0;return!1}const Rn="deferred",_i="loading",Ai="loaded";let Mo=null,p="unavailable",o=null;const c=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(p="error"),Mo&&Mo(t)};function m(){x.fire(new io("pluginStateChange",{pluginStatus:p,pluginURL:o}))}const x=new uo,C=function(){return p},I=function(){if(p!==Rn||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");p=_i,m(),o&&fi({url:o},t=>{t?c(t):(p=Ai,m())})},O={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>p===Ai||null!=O.applyArabicShaping,isLoading:()=>p===_i,setState(t){p=t.pluginStatus,o=t.pluginURL},isParsed:()=>null!=O.applyArabicShaping&&null!=O.processBidirectionalText&&null!=O.processStyledBidirectionalText,getPluginURL:()=>o};class N{constructor(e,i){this.zoom=e,i?(this.now=i.now,this.fadeDuration=i.fadeDuration,this.transition=i.transition,this.pitch=i.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(i,a){for(const u of i)if(!qe(u.charCodeAt(0),a))return!1;return!0}(e,O.isLoaded())}}class H{constructor(e,i){this.property=e,this.value=i,this.expression=function(a,u){if(Co(a))return new Zl(a,u);if(fs(a)){const f=Ni(a,u);if("error"===f.result)throw new Error(f.value.map(_=>`${_.key}: ${_.message}`).join(", "));return f.value}{let f=a;return"string"==typeof a&&"color"===u.type&&(f=wo.parse(a)),{kind:"constant",evaluate:()=>f}}}(void 0===i?e.specification.default:i,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,i,a){return this.property.possiblyEvaluate(this,e,i,a)}}class ${constructor(e){this.property=e,this.value=new H(e,void 0)}transitioned(e,i){return new Ie(this.property,this.value,i,Ue({},e.transition,this.transition),e.now)}untransitioned(){return new Ie(this.property,this.value,null,{},0)}}class ce{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return sn(this._values[e].value.value)}setValue(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new $(this._values[e].property)),this._values[e].value=new H(this._values[e].property,null===i?void 0:sn(i))}getTransition(e){return sn(this._values[e].transition)}setTransition(e,i){this._values.hasOwnProperty(e)||(this._values[e]=new $(this._values[e].property)),this._values[e].transition=sn(i)||void 0}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a);const u=this.getTransition(i);void 0!==u&&(e[`${i}-transition`]=u)}return e}transitioned(e,i){const a=new $e(this._properties);for(const u of Object.keys(this._values))a._values[u]=this._values[u].transitioned(e,i._values[u]);return a}untransitioned(){const e=new $e(this._properties);for(const i of Object.keys(this._values))e._values[i]=this._values[i].untransitioned();return e}}class Ie{constructor(e,i,a,u,f){const _=u.delay||0,b=u.duration||0;f=f||0,this.property=e,this.value=i,this.begin=f+_,this.end=this.begin+b,e.specification.transition&&(u.delay||u.duration)&&(this.prior=a)}possiblyEvaluate(e,i,a){const u=e.now||0,f=this.value.possiblyEvaluate(e,i,a),_=this.prior;if(_){if(u>this.end)return this.prior=null,f;if(this.value.isDataDriven())return this.prior=null,f;if(u<this.begin)return _.possiblyEvaluate(e,i,a);{const b=(u-this.begin)/(this.end-this.begin);return this.property.interpolate(_.possiblyEvaluate(e,i,a),f,xe(b))}}return f}}class $e{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,i,a){const u=new ot(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,i,a);return u}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Qe{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return sn(this._values[e].value)}setValue(e,i){this._values[e]=new H(this._values[e].property,null===i?void 0:sn(i))}serialize(){const e={};for(const i of Object.keys(this._values)){const a=this.getValue(i);void 0!==a&&(e[i]=a)}return e}possiblyEvaluate(e,i,a){const u=new ot(this._properties);for(const f of Object.keys(this._values))u._values[f]=this._values[f].possiblyEvaluate(e,i,a);return u}}class Ye{constructor(e,i,a){this.property=e,this.value=i,this.parameters=a}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,i,a,u){return this.property.evaluate(this.value,this.parameters,e,i,a,u)}}class ot{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ue{constructor(e){this.specification=e}possiblyEvaluate(e,i){return e.expression.evaluate(i)}interpolate(e,i,a){const u=Zi[this.specification.type];return u?u(e,i,a):e}}class He{constructor(e,i){this.specification=e,this.overrides=i}possiblyEvaluate(e,i,a,u){return new Ye(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(i,null,{},a,u)}:e.expression,i)}interpolate(e,i,a){if("constant"!==e.value.kind||"constant"!==i.value.kind)return e;if(void 0===e.value.value||void 0===i.value.value)return new Ye(this,{kind:"constant",value:void 0},e.parameters);const u=Zi[this.specification.type];return u?new Ye(this,{kind:"constant",value:u(e.value.value,i.value.value,a)},e.parameters):e}evaluate(e,i,a,u,f,_){return"constant"===e.kind?e.value:e.evaluate(i,a,u,f,_)}}class pt{constructor(e){this.specification=e}possiblyEvaluate(e,i,a,u){return!!e.expression.evaluate(i,null,{},a,u)}interpolate(){return!1}}class ht{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const i=new N(0,{});for(const a in e){const u=e[a];u.specification.overridable&&this.overridableProperties.push(a);const f=this.defaultPropertyValues[a]=new H(u,void 0),_=this.defaultTransitionablePropertyValues[a]=new $(u);this.defaultTransitioningPropertyValues[a]=_.untransitioned(),this.defaultPossiblyEvaluatedValues[a]=f.possiblyEvaluate(i)}}}function Pt(t,e){return 256*(t=ye(Math.floor(t),0,255))+ye(Math.floor(e),0,255)}di(He,"DataDrivenProperty"),di(ue,"DataConstantProperty"),di(pt,"ColorRampProperty");const Lt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ot{constructor(e,i){this._structArray=e,this._pos1=i*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class qt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,i){return e._trim(),i&&(e.isTransferred=!0,i.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const i=Object.create(this.prototype);return i.arrayBuffer=e.arrayBuffer,i.length=e.length,i.capacity=e.arrayBuffer.byteLength/i.bytesPerElement,i._refreshViews(),i}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const i=this.uint8;this._refreshViews(),i&&this.uint8.set(i)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function $t(t,e=1){let i=0,a=0;return{members:t.map(u=>{const f=Lt[u.type].BYTES_PER_ELEMENT,_=i=an(i,Math.max(e,f)),b=u.components||1;return a=Math.max(a,f),i+=f*b,{name:u.name,type:u.type,components:b,offset:_}}),size:an(i,Math.max(a,e)),alignment:e}}function an(t,e){return Math.ceil(t/e)*e}class Wn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.int16[u+0]=i,this.int16[u+1]=a,e}}Wn.prototype.bytesPerElement=4,di(Wn,"StructArrayLayout2i4");class nn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const f=3*e;return this.int16[f+0]=i,this.int16[f+1]=a,this.int16[f+2]=u,e}}nn.prototype.bytesPerElement=6,di(nn,"StructArrayLayout3i6");class An extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=4*e;return this.int16[_+0]=i,this.int16[_+1]=a,this.int16[_+2]=u,this.int16[_+3]=f,e}}An.prototype.bytesPerElement=8,di(An,"StructArrayLayout4i8");class pn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,b){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,a,u,f,_,b)}emplace(e,i,a,u,f,_,b,E){const D=6*e,k=12*e,z=3*e;return this.int16[D+0]=i,this.int16[D+1]=a,this.uint8[k+4]=u,this.uint8[k+5]=f,this.uint8[k+6]=_,this.uint8[k+7]=b,this.float32[z+2]=E,e}}pn.prototype.bytesPerElement=12,di(pn,"StructArrayLayout2i4ub1f12");class $n extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=4*e;return this.float32[_+0]=i,this.float32[_+1]=a,this.float32[_+2]=u,this.float32[_+3]=f,e}}$n.prototype.bytesPerElement=16,di($n,"StructArrayLayout4f16");class ln extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,u,f)}emplace(e,i,a,u,f,_){const b=6*e,E=3*e;return this.uint16[b+0]=i,this.uint16[b+1]=a,this.uint16[b+2]=u,this.uint16[b+3]=f,this.float32[E+2]=_,e}}ln.prototype.bytesPerElement=12,di(ln,"StructArrayLayout4ui1f12");class Mn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=4*e;return this.uint16[_+0]=i,this.uint16[_+1]=a,this.uint16[_+2]=u,this.uint16[_+3]=f,e}}Mn.prototype.bytesPerElement=8,di(Mn,"StructArrayLayout4ui8");class jn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,a,u,f,_)}emplace(e,i,a,u,f,_,b){const E=6*e;return this.int16[E+0]=i,this.int16[E+1]=a,this.int16[E+2]=u,this.int16[E+3]=f,this.int16[E+4]=_,this.int16[E+5]=b,e}}jn.prototype.bytesPerElement=12,di(jn,"StructArrayLayout6i12");class Bn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,b,E,D,k,z,j){const K=this.length;return this.resize(K+1),this.emplace(K,e,i,a,u,f,_,b,E,D,k,z,j)}emplace(e,i,a,u,f,_,b,E,D,k,z,j,K){const te=12*e;return this.int16[te+0]=i,this.int16[te+1]=a,this.int16[te+2]=u,this.int16[te+3]=f,this.uint16[te+4]=_,this.uint16[te+5]=b,this.uint16[te+6]=E,this.uint16[te+7]=D,this.int16[te+8]=k,this.int16[te+9]=z,this.int16[te+10]=j,this.int16[te+11]=K,e}}Bn.prototype.bytesPerElement=24,di(Bn,"StructArrayLayout4i4ui4i24");class Yn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_){const b=this.length;return this.resize(b+1),this.emplace(b,e,i,a,u,f,_)}emplace(e,i,a,u,f,_,b){const E=10*e,D=5*e;return this.int16[E+0]=i,this.int16[E+1]=a,this.int16[E+2]=u,this.float32[D+2]=f,this.float32[D+3]=_,this.float32[D+4]=b,e}}Yn.prototype.bytesPerElement=20,di(Yn,"StructArrayLayout3i3f20");class Di extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint32[1*e+0]=i,e}}Di.prototype.bytesPerElement=4,di(Di,"StructArrayLayout1ul4");class $i extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,b,E,D,k,z,j,K){const te=this.length;return this.resize(te+1),this.emplace(te,e,i,a,u,f,_,b,E,D,k,z,j,K)}emplace(e,i,a,u,f,_,b,E,D,k,z,j,K,te){const he=20*e,Re=10*e;return this.int16[he+0]=i,this.int16[he+1]=a,this.int16[he+2]=u,this.int16[he+3]=f,this.int16[he+4]=_,this.float32[Re+3]=b,this.float32[Re+4]=E,this.float32[Re+5]=D,this.float32[Re+6]=k,this.int16[he+14]=z,this.uint32[Re+8]=j,this.uint16[he+18]=K,this.uint16[he+19]=te,e}}$i.prototype.bytesPerElement=40,di($i,"StructArrayLayout5i4f1i1ul2ui40");class vi extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,b){const E=this.length;return this.resize(E+1),this.emplace(E,e,i,a,u,f,_,b)}emplace(e,i,a,u,f,_,b,E){const D=8*e;return this.int16[D+0]=i,this.int16[D+1]=a,this.int16[D+2]=u,this.int16[D+4]=f,this.int16[D+5]=_,this.int16[D+6]=b,this.int16[D+7]=E,e}}vi.prototype.bytesPerElement=16,di(vi,"StructArrayLayout3i2i2i16");class ki extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,u,f)}emplace(e,i,a,u,f,_){const b=4*e,E=8*e;return this.float32[b+0]=i,this.float32[b+1]=a,this.float32[b+2]=u,this.int16[E+6]=f,this.int16[E+7]=_,e}}ki.prototype.bytesPerElement=16,di(ki,"StructArrayLayout2f1f2i16");class ho extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=12*e,b=3*e;return this.uint8[_+0]=i,this.uint8[_+1]=a,this.float32[b+1]=u,this.float32[b+2]=f,e}}ho.prototype.bytesPerElement=12,di(ho,"StructArrayLayout2ub2f12");class fo extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const f=3*e;return this.float32[f+0]=i,this.float32[f+1]=a,this.float32[f+2]=u,e}}fo.prototype.bytesPerElement=12,di(fo,"StructArrayLayout3f12");class Ti extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a){const u=this.length;return this.resize(u+1),this.emplace(u,e,i,a)}emplace(e,i,a,u){const f=3*e;return this.uint16[f+0]=i,this.uint16[f+1]=a,this.uint16[f+2]=u,e}}Ti.prototype.bytesPerElement=6,di(Ti,"StructArrayLayout3ui6");class Fo extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,b,E,D,k,z,j,K,te,he,Re,rt,wt,lt,bt,Mt){const Dt=this.length;return this.resize(Dt+1),this.emplace(Dt,e,i,a,u,f,_,b,E,D,k,z,j,K,te,he,Re,rt,wt,lt,bt,Mt)}emplace(e,i,a,u,f,_,b,E,D,k,z,j,K,te,he,Re,rt,wt,lt,bt,Mt,Dt){const cn=30*e,on=15*e,En=60*e;return this.int16[cn+0]=i,this.int16[cn+1]=a,this.int16[cn+2]=u,this.float32[on+2]=f,this.float32[on+3]=_,this.uint16[cn+8]=b,this.uint16[cn+9]=E,this.uint32[on+5]=D,this.uint32[on+6]=k,this.uint32[on+7]=z,this.uint16[cn+16]=j,this.uint16[cn+17]=K,this.uint16[cn+18]=te,this.float32[on+10]=he,this.float32[on+11]=Re,this.uint8[En+48]=rt,this.uint8[En+49]=wt,this.uint8[En+50]=lt,this.uint32[on+13]=bt,this.int16[cn+28]=Mt,this.uint8[En+58]=Dt,e}}Fo.prototype.bytesPerElement=60,di(Fo,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Bo extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f,_,b,E,D,k,z,j,K,te,he,Re,rt,wt,lt,bt,Mt,Dt,cn,on,En,Hn,fn,kn,Fn,Vn){const Jn=this.length;return this.resize(Jn+1),this.emplace(Jn,e,i,a,u,f,_,b,E,D,k,z,j,K,te,he,Re,rt,wt,lt,bt,Mt,Dt,cn,on,En,Hn,fn,kn,Fn,Vn)}emplace(e,i,a,u,f,_,b,E,D,k,z,j,K,te,he,Re,rt,wt,lt,bt,Mt,Dt,cn,on,En,Hn,fn,kn,Fn,Vn,Jn){const Cn=38*e,ai=19*e;return this.int16[Cn+0]=i,this.int16[Cn+1]=a,this.int16[Cn+2]=u,this.float32[ai+2]=f,this.float32[ai+3]=_,this.int16[Cn+8]=b,this.int16[Cn+9]=E,this.int16[Cn+10]=D,this.int16[Cn+11]=k,this.int16[Cn+12]=z,this.int16[Cn+13]=j,this.uint16[Cn+14]=K,this.uint16[Cn+15]=te,this.uint16[Cn+16]=he,this.uint16[Cn+17]=Re,this.uint16[Cn+18]=rt,this.uint16[Cn+19]=wt,this.uint16[Cn+20]=lt,this.uint16[Cn+21]=bt,this.uint16[Cn+22]=Mt,this.uint16[Cn+23]=Dt,this.uint16[Cn+24]=cn,this.uint16[Cn+25]=on,this.uint16[Cn+26]=En,this.uint16[Cn+27]=Hn,this.uint16[Cn+28]=fn,this.uint32[ai+15]=kn,this.float32[ai+16]=Fn,this.float32[ai+17]=Vn,this.float32[ai+18]=Jn,e}}Bo.prototype.bytesPerElement=76,di(Bo,"StructArrayLayout3i2f6i15ui1ul3f76");class No extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.float32[1*e+0]=i,e}}No.prototype.bytesPerElement=4,di(No,"StructArrayLayout1f4");class zo extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i,a,u,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,i,a,u,f)}emplace(e,i,a,u,f,_){const b=5*e;return this.float32[b+0]=i,this.float32[b+1]=a,this.float32[b+2]=u,this.float32[b+3]=f,this.float32[b+4]=_,e}}zo.prototype.bytesPerElement=20,di(zo,"StructArrayLayout5f20");class gs extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i,a,u){const f=this.length;return this.resize(f+1),this.emplace(f,e,i,a,u)}emplace(e,i,a,u,f){const _=6*e;return this.uint32[3*e+0]=i,this.uint16[_+2]=a,this.uint16[_+3]=u,this.uint16[_+4]=f,e}}gs.prototype.bytesPerElement=12,di(gs,"StructArrayLayout1ul3ui12");class Yr extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.uint16[u+0]=i,this.uint16[u+1]=a,e}}Yr.prototype.bytesPerElement=4,di(Yr,"StructArrayLayout2ui4");class _s extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const i=this.length;return this.resize(i+1),this.emplace(i,e)}emplace(e,i){return this.uint16[1*e+0]=i,e}}_s.prototype.bytesPerElement=2,di(_s,"StructArrayLayout1ui2");class Qa extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,i){const a=this.length;return this.resize(a+1),this.emplace(a,e,i)}emplace(e,i,a){const u=2*e;return this.float32[u+0]=i,this.float32[u+1]=a,e}}Qa.prototype.bytesPerElement=8,di(Qa,"StructArrayLayout2f8");class yr extends Ot{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}yr.prototype.size=40;class ar extends $i{get(e){return new yr(this,e)}}di(ar,"CollisionBoxArray");class Uo extends Ot{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Uo.prototype.size=60;class Jr extends Fo{get(e){return new Uo(this,e)}}di(Jr,"PlacedSymbolArray");class Ys extends Ot{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Ys.prototype.size=76;class vr extends Bo{get(e){return new Ys(this,e)}}di(vr,"SymbolInstanceArray");class la extends No{getoffsetX(e){return this.float32[1*e+0]}}di(la,"GlyphOffsetArray");class xl extends Wn{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}di(xl,"SymbolLineVertexArray");class gc extends Ot{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}gc.prototype.size=12;class bu extends gs{get(e){return new gc(this,e)}}di(bu,"FeatureIndexArray");class mr extends Yr{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}di(mr,"FillExtrusionCentroidArray");const bl=$t([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Sa=$t([{name:"a_dash",components:4,type:"Uint16"}]);var wu={exports:{}},yd=function(t,e){var i,a,u,f,_,b,E,D;for(a=t.length-(i=3&t.length),u=e,_=3432918353,b=461845907,D=0;D<a;)E=255&t.charCodeAt(D)|(255&t.charCodeAt(++D))<<8|(255&t.charCodeAt(++D))<<16|(255&t.charCodeAt(++D))<<24,++D,u=27492+(65535&(f=5*(65535&(u=(u^=E=(65535&(E=(E=(65535&E)*_+(((E>>>16)*_&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295)<<13|u>>>19))+((5*(u>>>16)&65535)<<16)&4294967295))+((58964+(f>>>16)&65535)<<16);switch(E=0,i){case 3:E^=(255&t.charCodeAt(D+2))<<16;case 2:E^=(255&t.charCodeAt(D+1))<<8;case 1:u^=E=(65535&(E=(E=(65535&(E^=255&t.charCodeAt(D)))*_+(((E>>>16)*_&65535)<<16)&4294967295)<<15|E>>>17))*b+(((E>>>16)*b&65535)<<16)&4294967295}return u^=t.length,u=2246822507*(65535&(u^=u>>>16))+((2246822507*(u>>>16)&65535)<<16)&4294967295,u=3266489909*(65535&(u^=u>>>13))+((3266489909*(u>>>16)&65535)<<16)&4294967295,(u^=u>>>16)>>>0},vd=function(t,e){for(var i,a=t.length,u=e^a,f=0;a>=4;)i=1540483477*(65535&(i=255&t.charCodeAt(f)|(255&t.charCodeAt(++f))<<8|(255&t.charCodeAt(++f))<<16|(255&t.charCodeAt(++f))<<24))+((1540483477*(i>>>16)&65535)<<16),u=1540483477*(65535&u)+((1540483477*(u>>>16)&65535)<<16)^(i=1540483477*(65535&(i^=i>>>24))+((1540483477*(i>>>16)&65535)<<16)),a-=4,++f;switch(a){case 3:u^=(255&t.charCodeAt(f+2))<<16;case 2:u^=(255&t.charCodeAt(f+1))<<8;case 1:u=1540483477*(65535&(u^=255&t.charCodeAt(f)))+((1540483477*(u>>>16)&65535)<<16)}return u=1540483477*(65535&(u^=u>>>13))+((1540483477*(u>>>16)&65535)<<16),(u^=u>>>15)>>>0};wu.exports=yd,wu.exports.murmur3=yd,wu.exports.murmur2=vd;var Up=we(wu.exports);class Zp{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,i,a,u){this.ids.push(vm(e)),this.positions.push(i,a,u)}getPositions(e){const i=vm(e);let a=0,u=this.ids.length-1;for(;a<u;){const _=a+u>>1;this.ids[_]>=i?u=_:a=_+1}const f=[];for(;this.ids[a]===i;)f.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return f}static serialize(e,i){const a=new Float64Array(e.ids),u=new Uint32Array(e.positions);return xm(a,u,0,a.length-1),i&&i.push(a.buffer,u.buffer),{ids:a,positions:u}}static deserialize(e){const i=new Zp;return i.ids=e.ids,i.positions=e.positions,i.indexed=!0,i}}function vm(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:Up(String(t))}function xm(t,e,i,a){for(;i<a;){const u=t[i+a>>1];let f=i-1,_=a+1;for(;;){do{f++}while(t[f]<u);do{_--}while(t[_]>u);if(f>=_)break;Js(t,f,_),Js(e,3*f,3*_),Js(e,3*f+1,3*_+1),Js(e,3*f+2,3*_+2)}_-i<a-_?(xm(t,e,i,_),i=_+1):(xm(t,e,_+1,a),a=_)}}function Js(t,e,i){const a=t[e];t[e]=t[i],t[i]=a}di(Zp,"FeaturePositionMap");class el{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,i){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,i),this.initialized=!0),!!this.location}}class Wl extends el{constructor(e){super(e),this.current=0}set(e,i,a){this.fetchUniformLocation(e,i)&&this.current!==a&&(this.current=a,this.gl.uniform1f(this.location,a))}}class a_ extends el{constructor(e){super(e),this.current=[0,0,0,0]}set(e,i,a){this.fetchUniformLocation(e,i)&&(a[0]===this.current[0]&&a[1]===this.current[1]&&a[2]===this.current[2]&&a[3]===this.current[3]||(this.current=a,this.gl.uniform4f(this.location,a[0],a[1],a[2],a[3])))}}class Vp extends el{constructor(e){super(e),this.current=wo.transparent}set(e,i,a){this.fetchUniformLocation(e,i)&&(a.r===this.current.r&&a.g===this.current.g&&a.b===this.current.b&&a.a===this.current.a||(this.current=a,this.gl.uniform4f(this.location,a.r,a.g,a.b,a.a)))}}const l_=new Float32Array(16),c_=new Float32Array(9),u_=new Float32Array(4);function jp(t){return[Pt(255*t.r,255*t.g),Pt(255*t.b,255*t.a)]}class xd{constructor(e,i,a){this.value=e,this.uniformNames=i.map(u=>`u_${u}`),this.type=a}setUniform(e,i,a,u,f){i.set(e,f,u.constantOr(this.value))}getBinding(e,i){return"color"===this.type?new Vp(e):new Wl(e)}}class Tu{constructor(e,i){this.uniformNames=i.map(a=>`u_${a}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,i,a,u,f){const _="u_pattern"===f||"u_dash"===f?this.pattern:"u_pixel_ratio"===f?this.pixelRatio:null;_&&i.set(e,f,_)}getBinding(e,i){return"u_pattern"===i||"u_dash"===i?new a_(e):new Wl(e)}}class tl{constructor(e,i,a,u){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=i.map(f=>({name:`a_${f}`,type:"Float32",components:"color"===a?2:1,offset:0})),this.paintVertexArray=new u}populatePaintArray(e,i,a,u,f,_){const b=this.paintVertexArray.length,E=this.expression.evaluate(new N(0),i,{},f,u,_);this.paintVertexArray.resize(e),this._setPaintValue(b,e,E)}updatePaintArray(e,i,a,u,f){const _=this.expression.evaluate({zoom:0},a,u,void 0,f);this._setPaintValue(e,i,_)}_setPaintValue(e,i,a){if("color"===this.type){const u=jp(a);for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,u[0],u[1])}else{for(let u=e;u<i;u++)this.paintVertexArray.emplace(u,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class ya{constructor(e,i,a,u,f,_){this.expression=e,this.uniformNames=i.map(b=>`u_${b}_t`),this.type=a,this.useIntegerZoom=u,this.zoom=f,this.maxValue=0,this.paintVertexAttributes=i.map(b=>({name:`a_${b}`,type:"Float32",components:"color"===a?4:2,offset:0})),this.paintVertexArray=new _}populatePaintArray(e,i,a,u,f,_){const b=this.expression.evaluate(new N(this.zoom),i,{},f,u,_),E=this.expression.evaluate(new N(this.zoom+1),i,{},f,u,_),D=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(D,e,b,E)}updatePaintArray(e,i,a,u,f){const _=this.expression.evaluate({zoom:this.zoom},a,u,void 0,f),b=this.expression.evaluate({zoom:this.zoom+1},a,u,void 0,f);this._setPaintValue(e,i,_,b)}_setPaintValue(e,i,a,u){if("color"===this.type){const f=jp(a),_=jp(u);for(let b=e;b<i;b++)this.paintVertexArray.emplace(b,f[0],f[1],_[0],_[1])}else{for(let f=e;f<i;f++)this.paintVertexArray.emplace(f,a,u);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(u))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,i,a,u,f){const _=this.useIntegerZoom?Math.floor(a.zoom):a.zoom,b=ye(this.expression.interpolationFactor(_,this.zoom,this.zoom+1),0,1);i.set(e,f,b)}getBinding(e,i){return new Wl(e)}}class _c{constructor(e,i,a,u,f){this.expression=e,this.layerId=f,this.paintVertexAttributes=("array"===a?Sa:bl).members;for(let _=0;_<i.length;++_);this.paintVertexArray=new u}populatePaintArray(e,i,a){const u=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(u,e,i.patterns&&i.patterns[this.layerId],a)}updatePaintArray(e,i,a,u,f,_){this._setPaintValues(e,i,a.patterns&&a.patterns[this.layerId],_)}_setPaintValues(e,i,a,u){if(!u||!a)return;const f=u[a];if(!f)return;const{tl:_,br:b,pixelRatio:E}=f;for(let D=e;D<i;D++)this.paintVertexArray.emplace(D,_[0],_[1],b[0],b[1],E)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class nl{constructor(e,i,a=(()=>!0)){this.binders={},this._buffers=[];const u=[];for(const f in e.paint._values){if(!a(f))continue;const _=e.paint.get(f);if(!(_ instanceof Ye&&Tt(_.property.specification)))continue;const b=d_(f,e.type),E=_.value,D=_.property.specification.type,k=!!_.property.useIntegerZoom,z="line-dasharray"===f||f.endsWith("pattern"),j="line-dasharray"===f&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==E.kind||j)if("source"===E.kind||j||z){const K=bd(f,D,"source");this.binders[f]=z?new _c(E,b,D,K,e.id):new tl(E,b,D,K),u.push(`/a_${f}`)}else{const K=bd(f,D,"composite");this.binders[f]=new ya(E,b,D,k,i,K),u.push(`/z_${f}`)}else this.binders[f]=z?new Tu(E.value,b):new xd(E.value,b,D),u.push(`/u_${f}`)}this.cacheKey=u.sort().join("")}getMaxValue(e){const i=this.binders[e];return i instanceof tl||i instanceof ya?i.maxValue:0}populatePaintArrays(e,i,a,u,f,_){for(const b in this.binders){const E=this.binders[b];(E instanceof tl||E instanceof ya||E instanceof _c)&&E.populatePaintArray(e,i,a,u,f,_)}}setConstantPatternPositions(e){for(const i in this.binders){const a=this.binders[i];a instanceof Tu&&a.setConstantPatternPositions(e)}}updatePaintArrays(e,i,a,u,f,_){let b=!1;for(const E in e){const D=i.getPositions(E);for(const k of D){const z=a.feature(k.index);for(const j in this.binders){const K=this.binders[j];if((K instanceof tl||K instanceof ya||K instanceof _c)&&!0===K.expression.isStateDependent){const te=u.paint.get(j);K.expression=te.value,K.updatePaintArray(k.start,k.end,z,e[E],f,_),b=!0}}}}return b}defines(){const e=[];for(const i in this.binders){const a=this.binders[i];(a instanceof xd||a instanceof Tu)&&e.push(...a.uniformNames.map(u=>`#define HAS_UNIFORM_${u}`))}return e}getBinderAttributes(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof tl||a instanceof ya||a instanceof _c)for(let u=0;u<a.paintVertexAttributes.length;u++)e.push(a.paintVertexAttributes[u].name)}return e}getBinderUniforms(){const e=[];for(const i in this.binders){const a=this.binders[i];if(a instanceof xd||a instanceof Tu||a instanceof ya)for(const u of a.uniformNames)e.push(u)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const i=[];for(const a in this.binders){const u=this.binders[a];if(u instanceof xd||u instanceof Tu||u instanceof ya)for(const f of u.uniformNames)i.push({name:f,property:a,binding:u.getBinding(e,f)})}return i}setUniforms(e,i,a,u,f){for(const{name:_,property:b,binding:E}of a)this.binders[b].setUniform(e,E,f,u.get(b),_)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const i=this.binders[e];(i instanceof tl||i instanceof ya||i instanceof _c)&&i.paintVertexBuffer&&this._buffers.push(i.paintVertexBuffer)}}upload(e){for(const i in this.binders){const a=this.binders[i];(a instanceof tl||a instanceof ya||a instanceof _c)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const i=this.binders[e];(i instanceof tl||i instanceof ya||i instanceof _c)&&i.destroy()}}}class Yc{constructor(e,i,a=(()=>!0)){this.programConfigurations={};for(const u of e)this.programConfigurations[u.id]=new nl(u,i,a);this.needsUpload=!1,this._featureMap=new Zp,this._bufferOffset=0}populatePaintArrays(e,i,a,u,f,_,b){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(e,i,u,f,_,b);void 0!==i.id&&this._featureMap.add(i.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,i,a,u,f){for(const _ of a)this.needsUpload=this.programConfigurations[_.id].updatePaintArrays(e,this._featureMap,i,_,u,f)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const i in this.programConfigurations)this.programConfigurations[i].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const yh={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function d_(t,e){return yh[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const bm={"line-pattern":{source:ln,composite:ln},"fill-pattern":{source:ln,composite:ln},"fill-extrusion-pattern":{source:ln,composite:ln},"line-dasharray":{source:Mn,composite:Mn}},$p={color:{source:Qa,composite:$n},number:{source:No,composite:Qa}};function bd(t,e,i){const a=bm[t];return a&&a[i]||$p[e][i]}di(xd,"ConstantBinder"),di(Tu,"PatternConstantBinder"),di(tl,"SourceExpressionBinder"),di(_c,"PatternCompositeBinder"),di(ya,"CompositeExpressionBinder"),di(nl,"ProgramConfiguration",{omit:["_buffers"]}),di(Yc,"ProgramConfigurationSet");const Hp="-transition";class il extends uo{constructor(e,i){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),i.layout&&(this._unevaluatedLayout=new Qe(i.layout)),i.paint)){this._transitionablePaint=new ce(i.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ot(i.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,i,a={}){null!=i&&this._validate(yu,`layers.${this.id}.layout.${e}`,e,i,a)||("visibility"!==e?this._unevaluatedLayout.setValue(e,i):this.visibility=i)}getPaintProperty(e){return wn(e,Hp)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,i,a={}){if(null!=i&&this._validate(Wc,`layers.${this.id}.paint.${e}`,e,i,a))return!1;if(wn(e,Hp))return this._transitionablePaint.setTransition(e.slice(0,-11),i||void 0),!1;{const u=this._transitionablePaint._values[e],f=u.value.isDataDriven(),_=u.value;this._transitionablePaint.setValue(e,i),this._handleSpecialPaintPropertyUpdate(e);const b=this._transitionablePaint._values[e].value,E=b.isDataDriven(),D=wn(e,"pattern")||"line-dasharray"===e;return E||f||D||this._handleOverridablePaintPropertyUpdate(e,_,b)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,i,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,i){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,i)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,i)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),mn(e,(i,a)=>!(void 0===i||"layout"===a&&!Object.keys(i).length||"paint"===a&&!Object.keys(i).length))}_validate(e,i,a,u,f={}){return(!f||!1!==f.validate)&&qc(this,e.call(Gc,{key:i,layerType:this.type,objectKey:a,value:u,styleSpec:en,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const i=this.paint.get(e);if(i instanceof Ye&&Tt(i.property.specification)&&("source"===i.value.kind||"composite"===i.value.kind)&&i.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=dc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const h_=$t([{name:"a_pos",components:2,type:"Int16"}],4),Cu=$t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Cr{constructor(e=[]){this.segments=e}prepareSegment(e,i,a,u){let f=this.segments[this.segments.length-1];return e>Cr.MAX_VERTEX_ARRAY_LENGTH&&It(`Max vertices per segment is ${Cr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!f||f.vertexLength+e>Cr.MAX_VERTEX_ARRAY_LENGTH||f.sortKey!==u)&&(f={vertexOffset:i.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},void 0!==u&&(f.sortKey=u),this.segments.push(f)),f}get(){return this.segments}destroy(){for(const e of this.segments)for(const i in e.vaos)e.vaos[i].destroy()}static simpleSegment(e,i,a,u){return new Cr([{vertexOffset:e,primitiveOffset:i,vertexLength:a,primitiveLength:u,vaos:{},sortKey:0}])}}Cr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,di(Cr,"SegmentVector");var Li=8192;class Jc{constructor(e,i){e&&(i?this.setSouthWest(e).setNorthEast(i):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof tr?new tr(e.lng,e.lat):tr.convert(e),this}setSouthWest(e){return this._sw=e instanceof tr?new tr(e.lng,e.lat):tr.convert(e),this}extend(e){const i=this._sw,a=this._ne;let u,f;if(e instanceof tr)u=e,f=e;else{if(!(e instanceof Jc))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Jc.convert(e)):this.extend(tr.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(tr.convert(e)):this;if(u=e._sw,f=e._ne,!u||!f)return this}return i||a?(i.lng=Math.min(u.lng,i.lng),i.lat=Math.min(u.lat,i.lat),a.lng=Math.max(f.lng,a.lng),a.lat=Math.max(f.lat,a.lat)):(this._sw=new tr(u.lng,u.lat),this._ne=new tr(f.lng,f.lat)),this}getCenter(){return new tr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new tr(this.getWest(),this.getNorth())}getSouthEast(){return new tr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:i,lat:a}=tr.convert(e);let u=this._sw.lng<=i&&i<=this._ne.lng;return this._sw.lng>this._ne.lng&&(u=this._sw.lng>=i&&i>=this._ne.lng),this._sw.lat<=a&&a<=this._ne.lat&&u}static convert(e){return!e||e instanceof Jc?e:new Jc(e)}}var wd=1e-6,va=typeof Float32Array<"u"?Float32Array:Array;function p_(){var t=new va(9);return va!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function wm(t,e,i){var a=e[0],u=e[1],f=e[2],_=e[3],b=e[4],E=e[5],D=e[6],k=e[7],z=e[8],j=i[0],K=i[1],te=i[2],he=i[3],Re=i[4],rt=i[5],wt=i[6],lt=i[7],bt=i[8];return t[0]=j*a+K*_+te*D,t[1]=j*u+K*b+te*k,t[2]=j*f+K*E+te*z,t[3]=he*a+Re*_+rt*D,t[4]=he*u+Re*b+rt*k,t[5]=he*f+Re*E+rt*z,t[6]=wt*a+lt*_+bt*D,t[7]=wt*u+lt*b+bt*k,t[8]=wt*f+lt*E+bt*z,t}function ol(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Gp(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=e[4],b=e[5],E=e[6],D=e[7],k=e[8],z=e[9],j=e[10],K=e[11],te=e[12],he=e[13],Re=e[14],rt=e[15],wt=i*b-a*_,lt=i*E-u*_,bt=i*D-f*_,Mt=a*E-u*b,Dt=a*D-f*b,cn=u*D-f*E,on=k*he-z*te,En=k*Re-j*te,Hn=k*rt-K*te,fn=z*Re-j*he,kn=z*rt-K*he,Fn=j*rt-K*Re,Vn=wt*Fn-lt*kn+bt*fn+Mt*Hn-Dt*En+cn*on;return Vn?(t[0]=(b*Fn-E*kn+D*fn)*(Vn=1/Vn),t[1]=(u*kn-a*Fn-f*fn)*Vn,t[2]=(he*cn-Re*Dt+rt*Mt)*Vn,t[3]=(j*Dt-z*cn-K*Mt)*Vn,t[4]=(E*Hn-_*Fn-D*En)*Vn,t[5]=(i*Fn-u*Hn+f*En)*Vn,t[6]=(Re*bt-te*cn-rt*lt)*Vn,t[7]=(k*cn-j*bt+K*lt)*Vn,t[8]=(_*kn-b*Hn+D*on)*Vn,t[9]=(a*Hn-i*kn-f*on)*Vn,t[10]=(te*Dt-he*bt+rt*wt)*Vn,t[11]=(z*bt-k*Dt-K*wt)*Vn,t[12]=(b*En-_*fn-E*on)*Vn,t[13]=(i*fn-a*En+u*on)*Vn,t[14]=(he*lt-te*Mt-Re*wt)*Vn,t[15]=(k*Mt-z*lt+j*wt)*Vn,t):null}function wl(t,e,i){var a=e[0],u=e[1],f=e[2],_=e[3],b=e[4],E=e[5],D=e[6],k=e[7],z=e[8],j=e[9],K=e[10],te=e[11],he=e[12],Re=e[13],rt=e[14],wt=e[15],lt=i[0],bt=i[1],Mt=i[2],Dt=i[3];return t[0]=lt*a+bt*b+Mt*z+Dt*he,t[1]=lt*u+bt*E+Mt*j+Dt*Re,t[2]=lt*f+bt*D+Mt*K+Dt*rt,t[3]=lt*_+bt*k+Mt*te+Dt*wt,t[4]=(lt=i[4])*a+(bt=i[5])*b+(Mt=i[6])*z+(Dt=i[7])*he,t[5]=lt*u+bt*E+Mt*j+Dt*Re,t[6]=lt*f+bt*D+Mt*K+Dt*rt,t[7]=lt*_+bt*k+Mt*te+Dt*wt,t[8]=(lt=i[8])*a+(bt=i[9])*b+(Mt=i[10])*z+(Dt=i[11])*he,t[9]=lt*u+bt*E+Mt*j+Dt*Re,t[10]=lt*f+bt*D+Mt*K+Dt*rt,t[11]=lt*_+bt*k+Mt*te+Dt*wt,t[12]=(lt=i[12])*a+(bt=i[13])*b+(Mt=i[14])*z+(Dt=i[15])*he,t[13]=lt*u+bt*E+Mt*j+Dt*Re,t[14]=lt*f+bt*D+Mt*K+Dt*rt,t[15]=lt*_+bt*k+Mt*te+Dt*wt,t}function Eu(t,e,i){var a,u,f,_,b,E,D,k,z,j,K,te,he=i[0],Re=i[1],rt=i[2];return e===t?(t[12]=e[0]*he+e[4]*Re+e[8]*rt+e[12],t[13]=e[1]*he+e[5]*Re+e[9]*rt+e[13],t[14]=e[2]*he+e[6]*Re+e[10]*rt+e[14],t[15]=e[3]*he+e[7]*Re+e[11]*rt+e[15]):(u=e[1],f=e[2],_=e[3],b=e[4],E=e[5],D=e[6],k=e[7],z=e[8],j=e[9],K=e[10],te=e[11],t[0]=a=e[0],t[1]=u,t[2]=f,t[3]=_,t[4]=b,t[5]=E,t[6]=D,t[7]=k,t[8]=z,t[9]=j,t[10]=K,t[11]=te,t[12]=a*he+b*Re+z*rt+e[12],t[13]=u*he+E*Re+j*rt+e[13],t[14]=f*he+D*Re+K*rt+e[14],t[15]=_*he+k*Re+te*rt+e[15]),t}function Kc(t,e,i){var a=i[0],u=i[1],f=i[2];return t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*u,t[5]=e[5]*u,t[6]=e[6]*u,t[7]=e[7]*u,t[8]=e[8]*f,t[9]=e[9]*f,t[10]=e[10]*f,t[11]=e[11]*f,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function vh(t,e,i){var a=Math.sin(i),u=Math.cos(i),f=e[4],_=e[5],b=e[6],E=e[7],D=e[8],k=e[9],z=e[10],j=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=f*u+D*a,t[5]=_*u+k*a,t[6]=b*u+z*a,t[7]=E*u+j*a,t[8]=D*u-f*a,t[9]=k*u-_*a,t[10]=z*u-b*a,t[11]=j*u-E*a,t}function Wp(t,e,i){var a=Math.sin(i),u=Math.cos(i),f=e[0],_=e[1],b=e[2],E=e[3],D=e[8],k=e[9],z=e[10],j=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*u-D*a,t[1]=_*u-k*a,t[2]=b*u-z*a,t[3]=E*u-j*a,t[8]=f*a+D*u,t[9]=_*a+k*u,t[10]=b*a+z*u,t[11]=E*a+j*u,t}function qp(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function f_(t,e,i){var a,u,f,_=i[0],b=i[1],E=i[2],D=Math.hypot(_,b,E);return D<wd?null:(_*=D=1/D,b*=D,E*=D,a=Math.sin(e),u=Math.cos(e),t[0]=_*_*(f=1-u)+u,t[1]=b*_*f+E*a,t[2]=E*_*f-b*a,t[3]=0,t[4]=_*b*f-E*a,t[5]=b*b*f+u,t[6]=E*b*f+_*a,t[7]=0,t[8]=_*E*f+b*a,t[9]=b*E*f-_*a,t[10]=E*E*f+u,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var m_=wl;function Yp(){var t=new va(3);return va!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function xh(t){var e=new va(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function bh(t){return Math.hypot(t[0],t[1],t[2])}function Td(t,e,i){var a=new va(3);return a[0]=t,a[1]=e,a[2]=i,a}function rl(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t[2]=e[2]+i[2],t}function Tm(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t[2]=e[2]-i[2],t}function g_(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t[2]=e[2]*i[2],t}function wh(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t[2]=Math.min(e[2],i[2]),t}function Th(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t[2]=Math.max(e[2],i[2]),t}function Ua(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t}function Cd(t,e,i,a){return t[0]=e[0]+i[0]*a,t[1]=e[1]+i[1]*a,t[2]=e[2]+i[2]*a,t}function ys(t,e){var i=e[0],a=e[1],u=e[2],f=i*i+a*a+u*u;return f>0&&(f=1/Math.sqrt(f)),t[0]=e[0]*f,t[1]=e[1]*f,t[2]=e[2]*f,t}function xa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ch(t,e,i){var a=e[0],u=e[1],f=e[2],_=i[0],b=i[1],E=i[2];return t[0]=u*E-f*b,t[1]=f*_-a*E,t[2]=a*b-u*_,t}function zr(t,e,i){var a=e[0],u=e[1],f=e[2],_=i[3]*a+i[7]*u+i[11]*f+i[15];return t[0]=(i[0]*a+i[4]*u+i[8]*f+i[12])/(_=_||1),t[1]=(i[1]*a+i[5]*u+i[9]*f+i[13])/_,t[2]=(i[2]*a+i[6]*u+i[10]*f+i[14])/_,t}function Jp(t,e,i){var a=i[0],u=i[1],f=i[2],_=e[0],b=e[1],E=e[2],D=u*E-f*b,k=f*_-a*E,z=a*b-u*_,j=u*z-f*k,K=f*D-a*z,te=a*k-u*D,he=2*i[3];return k*=he,z*=he,K*=2,te*=2,t[0]=_+(D*=he)+(j*=2),t[1]=b+k+K,t[2]=E+z+te,t}var Tl,Za=Tm,Cm=g_,Eh=bh;function Ed(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t}function sl(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=i*i+a*a+u*u+f*f;return _>0&&(_=1/Math.sqrt(_)),t[0]=i*_,t[1]=a*_,t[2]=u*_,t[3]=f*_,t}function Xc(t,e,i){var a=e[0],u=e[1],f=e[2],_=e[3];return t[0]=i[0]*a+i[4]*u+i[8]*f+i[12]*_,t[1]=i[1]*a+i[5]*u+i[9]*f+i[13]*_,t[2]=i[2]*a+i[6]*u+i[10]*f+i[14]*_,t[3]=i[3]*a+i[7]*u+i[11]*f+i[15]*_,t}function Em(){var t=new va(4);return va!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function Dm(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Kp(t,e,i){i*=.5;var a=e[0],u=e[1],f=e[2],_=e[3],b=Math.sin(i),E=Math.cos(i);return t[0]=a*E+_*b,t[1]=u*E+f*b,t[2]=f*E-u*b,t[3]=_*E-a*b,t}function Dh(t,e,i){i*=.5;var a=e[0],u=e[1],f=e[2],_=e[3],b=Math.sin(i),E=Math.cos(i);return t[0]=a*E-f*b,t[1]=u*E+_*b,t[2]=f*E+a*b,t[3]=_*E-u*b,t}Yp(),Tl=new va(4),va!=Float32Array&&(Tl[0]=0,Tl[1]=0,Tl[2]=0,Tl[3]=0);var __=sl;Yp(),Td(1,0,0),Td(0,1,0),Em(),Em(),p_();const y_=$t([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Mm}=y_,Xp=$t([{name:"a_pos_3",components:3,type:"Int16"}]);var Dd=$t([{name:"a_pos",type:"Int16",components:2}]);class Qp{constructor(e,i){this.pos=e,this.dir=i}intersectsPlane(e,i,a){const u=xa(i,this.dir);if(Math.abs(u)<1e-6)return!1;const f=((e[0]-this.pos[0])*i[0]+(e[1]-this.pos[1])*i[1]+(e[2]-this.pos[2])*i[2])/u;return a[0]=this.pos[0]+this.dir[0]*f,a[1]=this.pos[1]+this.dir[1]*f,a[2]=this.pos[2]+this.dir[2]*f,!0}closestPointOnSphere(e,i,a){if(he=(K=this.pos)[0],Re=K[1],rt=K[2],wt=(te=e)[0],lt=te[1],bt=te[2],Math.abs(he-wt)<=wd*Math.max(1,Math.abs(he),Math.abs(wt))&&Math.abs(Re-lt)<=wd*Math.max(1,Math.abs(Re),Math.abs(lt))&&Math.abs(rt-bt)<=wd*Math.max(1,Math.abs(rt),Math.abs(bt))||0===i)return a[0]=a[1]=a[2]=0,!1;var K,te,he,Re,rt,wt,lt,bt;const[u,f,_]=this.dir,b=this.pos[0]-e[0],E=this.pos[1]-e[1],D=this.pos[2]-e[2],k=u*u+f*f+_*_,z=2*(b*u+E*f+D*_),j=z*z-4*k*(b*b+E*E+D*D-i*i);if(j<0){const K=Math.max(-z/2,0),te=b+u*K,he=E+f*K,Re=D+_*K,rt=Math.hypot(te,he,Re);return a[0]=te*i/rt,a[1]=he*i/rt,a[2]=Re*i/rt,!1}{const K=(-z-Math.sqrt(j))/(2*k);if(K<0){const te=Math.hypot(b,E,D);return a[0]=b*i/te,a[1]=E*i/te,a[2]=D*i/te,!1}return a[0]=b+u*K,a[1]=E+f*K,a[2]=D+_*K,!0}}}class Ks{constructor(e,i,a,u,f){this.TL=e,this.TR=i,this.BR=a,this.BL=u,this.horizon=f}static fromInvProjectionMatrix(e,i,a){const u=[-1,1,1],f=[1,1,1],_=[1,-1,1],b=[-1,-1,1],E=zr(u,u,e),D=zr(f,f,e),k=zr(_,_,e),z=zr(b,b,e);return new Ks(E,D,k,z,i/a)}}class Md{constructor(e,i){this.points=e,this.planes=i}static fromInvProjectionMatrix(e,i,a,u){const f=Math.pow(2,a),_=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const D=Xc([],E,e),k=1/D[3]/i*f;return(z=D)[0]=(j=D)[0]*(K=[k,k,u?1/D[3]:k,k])[0],z[1]=j[1]*K[1],z[2]=j[2]*K[2],z[3]=j[3]*K[3],z;var z,j,K}),b=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const D=ys([],Ch([],Za([],_[E[0]],_[E[1]]),Za([],_[E[2]],_[E[1]]))),k=-xa(D,_[E[1]]);return D.concat(k)});return new Md(_,b)}}class zs{static fromPoints(e){const i=[1/0,1/0,1/0],a=[-1/0,-1/0,-1/0];for(const u of e)wh(i,i,u),Th(a,a,u);return new zs(i,a)}static applyTransform(e,i){const a=e.getCorners();for(let u=0;u<a.length;++u)zr(a[u],a[u],i);return zs.fromPoints(a)}constructor(e,i){this.min=e,this.max=i,this.center=Ua([],rl([],this.min,this.max),.5)}quadrant(e){const i=[e%2==0,e<2],a=xh(this.min),u=xh(this.max);for(let f=0;f<i.length;f++)a[f]=i[f]?this.min[f]:this.center[f],u[f]=i[f]?this.center[f]:this.max[f];return u[2]=this.max[2],new zs(a,u)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,i=this.max;return[[e[0],e[1],e[2]],[i[0],e[1],e[2]],[i[0],i[1],e[2]],[e[0],i[1],e[2]],[e[0],e[1],i[2]],[i[0],e[1],i[2]],[i[0],i[1],i[2]],[e[0],i[1],i[2]]]}intersects(e){const i=this.getCorners();let a=!0;for(let u=0;u<e.planes.length;u++){const f=e.planes[u];let _=0;for(let b=0;b<i.length;b++)_+=xa(f,i[b])+f[3]>=0;if(0===_)return 0;_!==i.length&&(a=!1)}if(a)return 2;for(let u=0;u<3;u++){let f=Number.MAX_VALUE,_=-Number.MAX_VALUE;for(let b=0;b<e.points.length;b++){const E=e.points[b][u]-this.min[u];f=Math.min(f,E),_=Math.max(_,E)}if(_<0||f>this.max[u]-this.min[u])return 0}return 1}}const Id=5,Us=6,ba=Li/Math.PI/2,Im=16383,Ad=[64,32,16],Pa=-ba,Va=ba,Am=[new zs([Pa,Pa,Pa],[Va,Va,Va]),new zs([Pa,Pa,Pa],[0,0,Va]),new zs([0,Pa,Pa],[Va,0,Va]),new zs([Pa,0,Pa],[0,Va,Va]),new zs([0,0,Pa],[Va,Va,Va])];function Mh(t){return t*ba/iu}function ef(t,e,i,a=!0){const u=Ua([],t._camera.position,t.worldSize),f=[e,i,1,1];Xc(f,f,t.pixelMatrixInverse),Ed(f,f,1/f[3]);const _=ys([],Za([],f,u)),b=t.globeMatrix,E=[b[12],b[13],b[14]],D=Za([],E,u),k=bh(D),z=ys([],D),j=t.worldSize/(2*Math.PI),K=xa(z,_),te=Math.asin(j/k);if(te<Math.acos(K)){if(!a)return null;const Hn=[],fn=[];Ua(Hn,_,k/K),ys(fn,Za(fn,Hn,D)),ys(_,rl(_,D,Ua(_,fn,Math.tan(te)*k)))}const he=[];new Qp(u,_).closestPointOnSphere(E,j,he);const Re=ys([],gn(b,0)),rt=ys([],gn(b,1)),wt=ys([],gn(b,2)),lt=xa(Re,he),bt=xa(rt,he),Mt=xa(wt,he),Dt=ae(Math.asin(-bt/j));let cn=ae(Math.atan2(lt,Mt));cn=t.center.lng+function(Hn,fn){const kn=(fn-Hn+180)%360-180;return kn<-180?kn+360:kn}(t.center.lng,cn);const on=$a(cn),En=ye(al(Dt),0,1);return new Au(on,En)}class v_{constructor(e,i,a){this.a=Za([],e,a),this.b=Za([],i,a),this.center=a;const u=ys([],this.a),f=ys([],this.b);this.angle=Math.acos(xa(u,f))}}function tf(t,e){if(0===t.angle)return null;let i;return i=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),i<0||i>1?null:function(a,u,f,_){const b=Math.sin(f);return a*(Math.sin((1-_)*f)/b)+u*(Math.sin(_*f)/b)}(t.a[e],t.b[e],t.angle,ye(i,0,1))+t.center[e]}function ja(t){if(t.z<=1)return Am[t.z+2*t.y+t.x];const e=Ah(Ih(t));return zs.fromPoints(e)}function ql(t,e,i){return Ua(t,t,1-i),Cd(t,t,e,i)}function Sm(t,e){const i=Iu(e.zoom);if(0===i)return ja(t);const a=Ih(t),u=Ah(a),f=$a(a.getWest())*e.worldSize,_=$a(a.getEast())*e.worldSize,b=al(a.getNorth())*e.worldSize,E=al(a.getSouth())*e.worldSize,D=[f,b,0],k=[_,b,0],z=[f,E,0],j=[_,E,0],K=Gp([],e.globeMatrix);return zr(D,D,K),zr(k,k,K),zr(z,z,K),zr(j,j,K),u[0]=ql(u[0],z,i),u[1]=ql(u[1],j,i),u[2]=ql(u[2],k,i),u[3]=ql(u[3],D,i),zs.fromPoints(u)}function Du(t,e,i){for(const a of t)zr(a,a,e),Ua(a,a,i)}function Ih({x:t,y:e,z:i}){const a=1/(1<<i),u=new tr(wa(t*a),vs((e+1)*a)),f=new tr(wa((t+1)*a),vs(e*a));return new Jc(u,f)}function Ah(t){const e=Ee(t.getNorth()),i=Ee(t.getSouth()),a=Math.cos(e),u=Math.cos(i),f=Math.sin(e),_=Math.sin(i),b=t.getWest(),E=t.getEast();return[Qc(u,_,b),Qc(u,_,E),Qc(a,f,E),Qc(a,f,b)]}function Qc(t,e,i,a=ba){return i=Ee(i),[t*Math.sin(i)*a,-e*a,t*Math.cos(i)*a]}function eu(t,e,i){return Qc(Math.cos(Ee(t)),Math.sin(Ee(t)),e,i)}function Cl(t,e,i,a){const u=1<<i.z,f=(t/Li+i.x)/u;return eu(vs((e/Li+i.y)/u),wa(f),a)}function tu({min:t,max:e}){return Im/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const nf=new Float64Array(16);function nu(t){const e=tu(t),i=qp(nf,[e,e,e]);return Eu(i,i,((a=[])[0]=-(u=t.min)[0],a[1]=-u[1],a[2]=-u[2],a));var a,u}function Mu(t){const e=(a=t.min,(i=nf)[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=a[0],i[13]=a[1],i[14]=a[2],i[15]=1,i);var i,a;const u=1/tu(t);return Kc(e,e,[u,u,u])}function Pm(t,e,i,a,u){const f=function(E){const D=Li/(2*Math.PI);return E/(2*Math.PI)/D}(i),_=[t,e,-i/(2*Math.PI)],b=ol(new Float64Array(16));return Eu(b,b,_),Kc(b,b,[f,f,f]),vh(b,b,Ee(-u)),Wp(b,b,Ee(-a)),b}function Iu(t){return Qt(Id,Us,t)}function Om(t,e){const i=eu(e.lat,e.lng);return _=(u=Tm([],function(te){const he=eu(te._center.lat,te._center.lng);let Re=Ch([],Td(0,1,0),he);const rt=f_([],-te.angle,he);Re=zr(Re,Re,rt),f_(rt,-te._pitch,Re);const wt=ys([],he);return Ua(wt,wt,Mh(te.cameraToCenterDistance/te.pixelsPerMeter)),zr(wt,wt,rt),rl([],he,wt)}(t),i))[0],b=u[1],E=u[2],D=(f=i)[0],k=f[1],z=f[2],K=(j=Math.sqrt(_*_+b*b+E*E)*Math.sqrt(D*D+k*k+z*z))&&xa(u,f)/j,Math.acos(Math.min(Math.max(K,-1),1));var u,f,_,b,E,D,k,z,j,K}function rf(t,e){return Om(t,e)>Math.PI/2*1.01}const Rm=Ee(85),b_=Math.cos(Rm),Lm=Math.sin(Rm),iu=6371008.8,sf=2*Math.PI*iu;class El{constructor(e,i){if(isNaN(e)||isNaN(i))throw new Error(`Invalid LngLat object: (${e}, ${i})`);if(this.lng=+e,this.lat=+i,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new El(dt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const i=Math.PI/180,a=this.lat*i,u=e.lat*i,f=Math.sin(a)*Math.sin(u)+Math.cos(a)*Math.cos(u)*Math.cos((e.lng-this.lng)*i);return iu*Math.acos(Math.min(f,1))}toBounds(e=0){const i=360*e/40075017,a=i/Math.cos(Math.PI/180*this.lat);return new Jc(new El(this.lng-a,this.lat-i),new El(this.lng+a,this.lat+i))}toEcef(e){const i=Mh(e);return eu(this.lat,this.lng,ba+i)}static convert(e){if(e instanceof El)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new El(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new El(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var tr=El;function af(t){return sf*Math.cos(t*Math.PI/180)}function $a(t){return(180+t)/360}function al(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function Zs(t,e){return t/af(e)}function wa(t){return 360*t-180}function vs(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function km(t,e){return t*af(vs(e))}const Vs=85.051129;function Sd(t){return 1/Math.cos(t*Math.PI/180)}class Au{constructor(e,i,a=0){this.x=+e,this.y=+i,this.z=+a}static fromLngLat(e,i=0){const a=tr.convert(e);return new Au($a(a.lng),al(a.lat),Zs(i,a.lat))}toLngLat(){return new tr(wa(this.x),vs(this.y))}toAltitude(){return km(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/sf*Sd(vs(this.y))}}function Sh(t,e,i,a,u,f,_,b,E){const D=(e+a)/2,k=(i+u)/2,z=new Ce(D,k);b(z),function(j,K,te,he,Re,rt){const wt=te-Re,lt=he-rt;return Math.abs((he-K)*wt-(te-j)*lt)/Math.hypot(wt,lt)}(z.x,z.y,f.x,f.y,_.x,_.y)>=E?(Sh(t,e,i,D,k,f,z,b,E),Sh(t,D,k,a,u,z,_,b,E)):t.push(_)}function lf(t,e,i){let a=t[0],u=a.x,f=a.y;e(a);const _=[a];for(let b=1;b<t.length;b++){const E=t[b],{x:D,y:k}=E;e(E),Sh(_,u,f,D,k,a,E,e,i),u=D,f=k,a=E}return _}function Ph(t,e,i,a){if(a(e,i)){const u=e.add(i)._mult(.5);Ph(t,e,u,a),Ph(t,u,i,a)}else t.push(i)}function cf(t,e){let i=t[0];const a=[i];for(let u=1;u<t.length;u++){const f=t[u];Ph(a,i,f,e),i=f}return a}const Oh=Math.pow(2,14)-1,Pd=-Oh-1;function Od(t,e){const i=Math.round(t.x*e),a=Math.round(t.y*e);return t.x=ye(i,Pd,Oh),t.y=ye(a,Pd,Oh),(i<t.x||i>t.x+1||a<t.y||a>t.y+1)&&It("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Dl(t,e,i){const a=t.loadGeometry(),u=t.extent,f=Li/u;if(e&&i&&i.projection.isReprojectedInTileSpace){const _=1<<e.z,{scale:b,x:E,y:D,projection:k}=i,z=j=>{const K=wa((e.x+j.x/u)/_),te=vs((e.y+j.y/u)/_),he=k.project(K,te);j.x=(he.x*b-E)*u,j.y=(he.y*b-D)*u};for(let j=0;j<a.length;j++)if(1!==t.type)a[j]=lf(a[j],z,1);else{const K=[];for(const te of a[j])te.x<0||te.x>=u||te.y<0||te.y>=u||(z(te),K.push(te));a[j]=K}}for(const _ of a)for(const b of _)Od(b,f);return a}function Yl(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Dl(t):[]}}function ou(t,e,i,a,u){t.emplaceBack(2*e+(a+1)/2,2*i+(u+1)/2)}function Rd(t,e,i){t.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Ld{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Wn,this.indexArray=new Ti,this.segments=new Cr,this.programConfigurations=new Yc(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,u){const f=this.layers[0],_=[];let b=null;"circle"===f.type&&(b=f.layout.get("circle-sort-key"));for(const{feature:D,id:k,index:z,sourceLayerIndex:j}of e){const K=this.layers[0]._featureFilter.needGeometry,te=Yl(D,K);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),te,a))continue;const he=b?b.evaluate(te,{},a):void 0,Re={id:k,properties:D.properties,type:D.type,sourceLayerIndex:j,index:z,geometry:K?te.geometry:Dl(D,a,u),patterns:{},sortKey:he};_.push(Re)}b&&_.sort((D,k)=>D.sortKey-k.sortKey);let E=null;"globe"===u.projection.name&&(this.globeExtVertexArray=new jn,E=u.projection);for(const D of _){const{geometry:k,index:z,sourceLayerIndex:j}=D,K=e[z].feature;this.addFeature(D,k,z,i.availableImages,a,E),i.featureIndex.insert(K,k,z,j,this.index)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,h_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Cu.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,i,a,u,f,_){for(const b of i)for(const E of b){const D=E.x,k=E.y;if(D<0||D>=Li||k<0||k>=Li)continue;if(_){const K=_.projectTilePoint(D,k,f),te=_.upVector(f,D,k),he=this.globeExtVertexArray;Rd(he,K,te),Rd(he,K,te),Rd(he,K,te),Rd(he,K,te)}const z=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),j=z.vertexLength;ou(this.layoutVertexArray,D,k,-1,-1),ou(this.layoutVertexArray,D,k,1,-1),ou(this.layoutVertexArray,D,k,1,1),ou(this.layoutVertexArray,D,k,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+2,j+3),z.vertexLength+=4,z.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},u,f)}}function Su(t,e){for(let i=0;i<t.length;i++)if(Jl(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(Jl(t,e[i]))return!0;return!!df(t,e)}function w_(t,e,i){return!!Jl(t,e)||!!Rh(e,t,i)}function uf(t,e){if(1===t.length)return kd(e,t[0]);for(let i=0;i<e.length;i++){const a=e[i];for(let u=0;u<a.length;u++)if(Jl(t,a[u]))return!0}for(let i=0;i<t.length;i++)if(kd(e,t[i]))return!0;for(let i=0;i<e.length;i++)if(df(t,e[i]))return!0;return!1}function T_(t,e,i){if(t.length>1){if(df(t,e))return!0;for(let a=0;a<e.length;a++)if(Rh(e[a],t,i))return!0}for(let a=0;a<t.length;a++)if(Rh(t[a],e,i))return!0;return!1}function df(t,e){if(0===t.length||0===e.length)return!1;for(let i=0;i<t.length-1;i++){const a=t[i],u=t[i+1];for(let f=0;f<e.length-1;f++)if(C_(a,u,e[f],e[f+1]))return!0}return!1}function C_(t,e,i,a){return at(t,i,a)!==at(e,i,a)&&at(t,e,i)!==at(t,e,a)}function Rh(t,e,i){const a=i*i;if(1===e.length)return t.distSqr(e[0])<a;for(let u=1;u<e.length;u++)if(hf(t,e[u-1],e[u])<a)return!0;return!1}function hf(t,e,i){const a=e.distSqr(i);if(0===a)return t.distSqr(e);const u=((t.x-e.x)*(i.x-e.x)+(t.y-e.y)*(i.y-e.y))/a;return t.distSqr(u<0?e:u>1?i:i.sub(e)._mult(u)._add(e))}function kd(t,e){let i,a,u,f=!1;for(let _=0;_<t.length;_++){i=t[_];for(let b=0,E=i.length-1;b<i.length;E=b++)a=i[b],u=i[E],a.y>e.y!=u.y>e.y&&e.x<(u.x-a.x)*(e.y-a.y)/(u.y-a.y)+a.x&&(f=!f)}return f}function Jl(t,e){let i=!1;for(let a=0,u=t.length-1;a<t.length;u=a++){const f=t[a],_=t[u];f.y>e.y!=_.y>e.y&&e.x<(_.x-f.x)*(e.y-f.y)/(_.y-f.y)+f.x&&(i=!i)}return i}function ru(t,e,i,a,u){for(const _ of t)if(e<=_.x&&i<=_.y&&a>=_.x&&u>=_.y)return!0;const f=[new Ce(e,i),new Ce(e,u),new Ce(a,u),new Ce(a,i)];if(t.length>2)for(const _ of f)if(Jl(t,_))return!0;for(let _=0;_<t.length-1;_++)if(E_(t[_],t[_+1],f))return!0;return!1}function E_(t,e,i){const a=i[0],u=i[2];if(t.x<a.x&&e.x<a.x||t.x>u.x&&e.x>u.x||t.y<a.y&&e.y<a.y||t.y>u.y&&e.y>u.y)return!1;const f=at(t,e,i[0]);return f!==at(t,e,i[1])||f!==at(t,e,i[2])||f!==at(t,e,i[3])}function Pu(t,e,i){const a=e.paint.get(t).value;return"constant"===a.kind?a.value:i.programConfigurations.get(e.id).getMaxValue(t)}function pf(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Fm(t,e,i,a,u){if(!e[0]&&!e[1])return t;const f=Ce.convert(e)._mult(u);"viewport"===i&&f._rotate(-a);const _=[];for(let b=0;b<t.length;b++)_.push(t[b].sub(f));return _}function Lh(t,e,i,a){const u=Ce.convert(t)._mult(a);return"viewport"===e&&u._rotate(-i),u}di(Ld,"CircleBucket",{omit:["layers"]});const D_=new ht({"circle-sort-key":new He(en.layout_circle["circle-sort-key"])});var Fd={paint:new ht({"circle-radius":new He(en.paint_circle["circle-radius"]),"circle-color":new He(en.paint_circle["circle-color"]),"circle-blur":new He(en.paint_circle["circle-blur"]),"circle-opacity":new He(en.paint_circle["circle-opacity"]),"circle-translate":new ue(en.paint_circle["circle-translate"]),"circle-translate-anchor":new ue(en.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ue(en.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ue(en.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new He(en.paint_circle["circle-stroke-width"]),"circle-stroke-color":new He(en.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new He(en.paint_circle["circle-stroke-opacity"])}),layout:D_};function Bd(t,e,i,a,u,f,_,b,E){if(f&&t.queryGeometry.isAboveHorizon)return!1;f&&(E*=t.pixelToTileUnitsFactor);const D=t.tileID.canonical,k=i.projection.upVectorScale(D,i.center.lat,i.worldSize).metersToTile;for(const z of e)for(const j of z){const K=j.add(b),te=u&&i.elevation?i.elevation.exaggeration()*u.getElevationAt(K.x,K.y,!0):0,he=i.projection.projectTilePoint(K.x,K.y,D);if(te>0){const lt=i.projection.upVector(D,K.x,K.y);he.x+=lt[0]*k*te,he.y+=lt[1]*k*te,he.z+=lt[2]*k*te}const Re=f?K:ff(he.x,he.y,he.z,a),rt=f?t.tilespaceRays.map(lt=>Nm(lt,te)):t.queryGeometry.screenGeometry,wt=Xc([],[he.x,he.y,he.z,1],a);if(!_&&f?E*=wt[3]/i.cameraToCenterDistance:_&&!f&&(E*=i.cameraToCenterDistance/wt[3]),f){const lt=vs((j.y/Li+D.y)/(1<<D.z));E/=i.projection.pixelsPerMeter(lt,1)/Zs(1,lt)}if(w_(rt,Re,E))return!0}return!1}function ff(t,e,i,a){const u=Xc([],[t,e,i,1],a);return new Ce(u[0]/u[3],u[1]/u[3])}const mf=Td(0,0,0),Bm=Td(0,0,1);function Nm(t,e){const i=Yp();return mf[2]=e,t.intersectsPlane(mf,Bm,i),new Ce(i[0],i[1])}class gf extends Ld{}function zm(t,{width:e,height:i},a,u){if(u){if(u instanceof Uint8ClampedArray)u=new Uint8Array(u.buffer);else if(u.length!==e*i*a)throw new RangeError("mismatched image size")}else u=new Uint8Array(e*i*a);return t.width=e,t.height=i,t.data=u,t}function Um(t,e,i){const{width:a,height:u}=e;a===t.width&&u===t.height||(_f(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,a),height:Math.min(t.height,u)},i),t.width=a,t.height=u,t.data=e.data)}function _f(t,e,i,a,u,f){if(0===u.width||0===u.height)return e;if(u.width>t.width||u.height>t.height||i.x>t.width-u.width||i.y>t.height-u.height)throw new RangeError("out of range source coordinates for image copy");if(u.width>e.width||u.height>e.height||a.x>e.width-u.width||a.y>e.height-u.height)throw new RangeError("out of range destination coordinates for image copy");const _=t.data,b=e.data;for(let E=0;E<u.height;E++){const D=((i.y+E)*t.width+i.x)*f,k=((a.y+E)*e.width+a.x)*f;for(let z=0;z<u.width*f;z++)b[k+z]=_[D+z]}return e}di(gf,"HeatmapBucket",{omit:["layers"]});class Kl{constructor(e,i){zm(this,e,1,i)}resize(e){Um(this,new Kl(e),1)}clone(){return new Kl({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,u,f){_f(e,i,a,u,f,1)}}class Ta{constructor(e,i){zm(this,e,4,i)}resize(e){Um(this,new Ta(e),4)}replace(e,i){i?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ta({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,i,a,u,f){_f(e,i,a,u,f,4)}}di(Kl,"AlphaImage"),di(Ta,"RGBAImage");var vc={paint:new ht({"heatmap-radius":new He(en.paint_heatmap["heatmap-radius"]),"heatmap-weight":new He(en.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ue(en.paint_heatmap["heatmap-intensity"]),"heatmap-color":new pt(en.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ue(en.paint_heatmap["heatmap-opacity"])})};function su(t){const e={},i=t.resolution||256,a=t.clips?t.clips.length:1,u=t.image||new Ta({width:i,height:a}),f=(_,b,E)=>{e[t.evaluationKey]=E;const D=t.expression.evaluate(e);u.data[_+b+0]=Math.floor(255*D.r/D.a),u.data[_+b+1]=Math.floor(255*D.g/D.a),u.data[_+b+2]=Math.floor(255*D.b/D.a),u.data[_+b+3]=Math.floor(255*D.a)};if(t.clips)for(let _=0,b=0;_<a;++_,b+=4*i)for(let E=0,D=0;E<i;E++,D+=4){const k=E/(i-1),{start:z,end:j}=t.clips[_];f(b,D,z*(1-k)+j*k)}else for(let _=0,b=0;_<i;_++,b+=4)f(0,b,_/(i-1));return u}var M_={paint:new ht({"hillshade-illumination-direction":new ue(en.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ue(en.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ue(en.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ue(en.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ue(en.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ue(en.paint_hillshade["hillshade-accent-color"])})};const pv=$t([{name:"a_pos",components:2,type:"Int16"}],4),{members:fv}=pv;var Zm={exports:{}};function yf(t,e,i){i=i||2;var a,u,f,_,b,E,D,k=e&&e.length,z=k?e[0]*i:t.length,j=I_(t,0,z,i,!0),K=[];if(!j||j.next===j.prev)return K;if(k&&(j=function(he,Re,rt,wt){var lt,bt,Mt,Dt=[];for(lt=0,bt=Re.length;lt<bt;lt++)(Mt=I_(he,Re[lt]*wt,lt<bt-1?Re[lt+1]*wt:he.length,wt,!1))===Mt.next&&(Mt.steiner=!0),Dt.push(jm(Mt));for(Dt.sort(Xl),lt=0;lt<Dt.length;lt++)rt=zd(Dt[lt],rt);return rt}(t,e,j,i)),t.length>80*i){a=f=t[0],u=_=t[1];for(var te=i;te<z;te+=i)(b=t[te])<a&&(a=b),(E=t[te+1])<u&&(u=E),b>f&&(f=b),E>_&&(_=E);D=0!==(D=Math.max(f-a,_-u))?32767/D:0}return Nd(j,K,i,a,u,D,0),K}function I_(t,e,i,a,u){var f,_;if(u===Bh(t,e,i,a)>0)for(f=e;f<i;f+=a)_=Hm(f,t[f],t[f+1],_);else for(f=i-a;f>=e;f-=a)_=Hm(f,t[f],t[f+1],_);return _&&Ou(_,_.next)&&(Zd(_),_=_.next),_}function xc(t,e){if(!t)return t;e||(e=t);var i,a=t;do{if(i=!1,a.steiner||!Ou(a,a.next)&&0!==Kr(a.prev,a,a.next))a=a.next;else{if(Zd(a),(a=e=a.prev)===a.next)break;i=!0}}while(i||a!==e);return e}function Nd(t,e,i,a,u,f,_){if(t){!_&&f&&function(k,z,j,K){var te=k;do{0===te.z&&(te.z=kh(te.x,te.y,z,j,K)),te.prevZ=te.prev,te.nextZ=te.next,te=te.next}while(te!==k);te.prevZ.nextZ=null,te.prevZ=null,function(he){var Re,rt,wt,lt,bt,Mt,Dt,cn,on=1;do{for(rt=he,he=null,bt=null,Mt=0;rt;){for(Mt++,wt=rt,Dt=0,Re=0;Re<on&&(Dt++,wt=wt.nextZ);Re++);for(cn=on;Dt>0||cn>0&&wt;)0!==Dt&&(0===cn||!wt||rt.z<=wt.z)?(lt=rt,rt=rt.nextZ,Dt--):(lt=wt,wt=wt.nextZ,cn--),bt?bt.nextZ=lt:he=lt,lt.prevZ=bt,bt=lt;rt=wt}bt.nextZ=null,on*=2}while(Mt>1)}(te)}(t,a,u,f);for(var b,E,D=t;t.prev!==t.next;)if(b=t.prev,E=t.next,f?S_(t,a,u,f):A_(t))e.push(b.i/i|0),e.push(t.i/i|0),e.push(E.i/i|0),Zd(t),t=E.next,D=E.next;else if((t=E)===D){_?1===_?Nd(t=P_(xc(t),e,i),e,i,a,u,f,2):2===_&&vf(t,e,i,a,u,f):Nd(xc(t),e,i,a,u,f,1);break}}}function A_(t){var e=t.prev,i=t,a=t.next;if(Kr(e,i,a)>=0)return!1;for(var u=e.x,f=i.x,_=a.x,b=e.y,E=i.y,D=a.y,k=u<f?u<_?u:_:f<_?f:_,z=b<E?b<D?b:D:E<D?E:D,j=u>f?u>_?u:_:f>_?f:_,K=b>E?b>D?b:D:E>D?E:D,te=a.next;te!==e;){if(te.x>=k&&te.x<=j&&te.y>=z&&te.y<=K&&Ud(u,b,f,E,_,D,te.x,te.y)&&Kr(te.prev,te,te.next)>=0)return!1;te=te.next}return!0}function S_(t,e,i,a){var u=t.prev,f=t,_=t.next;if(Kr(u,f,_)>=0)return!1;for(var b=u.x,E=f.x,D=_.x,k=u.y,z=f.y,j=_.y,K=b<E?b<D?b:D:E<D?E:D,te=k<z?k<j?k:j:z<j?z:j,he=b>E?b>D?b:D:E>D?E:D,Re=k>z?k>j?k:j:z>j?z:j,rt=kh(K,te,e,i,a),wt=kh(he,Re,e,i,a),lt=t.prevZ,bt=t.nextZ;lt&&lt.z>=rt&&bt&&bt.z<=wt;){if(lt.x>=K&&lt.x<=he&&lt.y>=te&&lt.y<=Re&&lt!==u&&lt!==_&&Ud(b,k,E,z,D,j,lt.x,lt.y)&&Kr(lt.prev,lt,lt.next)>=0||(lt=lt.prevZ,bt.x>=K&&bt.x<=he&&bt.y>=te&&bt.y<=Re&&bt!==u&&bt!==_&&Ud(b,k,E,z,D,j,bt.x,bt.y)&&Kr(bt.prev,bt,bt.next)>=0))return!1;bt=bt.nextZ}for(;lt&&lt.z>=rt;){if(lt.x>=K&&lt.x<=he&&lt.y>=te&&lt.y<=Re&&lt!==u&&lt!==_&&Ud(b,k,E,z,D,j,lt.x,lt.y)&&Kr(lt.prev,lt,lt.next)>=0)return!1;lt=lt.prevZ}for(;bt&&bt.z<=wt;){if(bt.x>=K&&bt.x<=he&&bt.y>=te&&bt.y<=Re&&bt!==u&&bt!==_&&Ud(b,k,E,z,D,j,bt.x,bt.y)&&Kr(bt.prev,bt,bt.next)>=0)return!1;bt=bt.nextZ}return!0}function P_(t,e,i){var a=t;do{var u=a.prev,f=a.next.next;!Ou(u,f)&&Fh(u,a,a.next,f)&&Ru(u,f)&&Ru(f,u)&&(e.push(u.i/i|0),e.push(a.i/i|0),e.push(f.i/i|0),Zd(a),Zd(a.next),a=t=f),a=a.next}while(a!==t);return xc(a)}function vf(t,e,i,a,u,f){var _=t;do{for(var b=_.next.next;b!==_.prev;){if(_.i!==b.i&&mv(_,b)){var E=$m(_,b);return _=xc(_,_.next),E=xc(E,E.next),Nd(_,e,i,a,u,f,0),void Nd(E,e,i,a,u,f,0)}b=b.next}_=_.next}while(_!==t)}function Xl(t,e){return t.x-e.x}function zd(t,e){var i=function(u,f){var _,b=f,E=u.x,D=u.y,k=-1/0;do{if(D<=b.y&&D>=b.next.y&&b.next.y!==b.y){var z=b.x+(D-b.y)*(b.next.x-b.x)/(b.next.y-b.y);if(z<=E&&z>k&&(k=z,_=b.x<b.next.x?b:b.next,z===E))return _}b=b.next}while(b!==f);if(!_)return null;var j,K=_,te=_.x,he=_.y,Re=1/0;b=_;do{E>=b.x&&b.x>=te&&E!==b.x&&Ud(D<he?E:k,D,te,he,D<he?k:E,D,b.x,b.y)&&(j=Math.abs(D-b.y)/(E-b.x),Ru(b,u)&&(j<Re||j===Re&&(b.x>_.x||b.x===_.x&&Vm(_,b)))&&(_=b,Re=j)),b=b.next}while(b!==K);return _}(t,e);if(!i)return e;var a=$m(i,t);return xc(a,a.next),xc(i,i.next)}function Vm(t,e){return Kr(t.prev,t,e.prev)<0&&Kr(e.next,t,t.next)<0}function kh(t,e,i,a,u){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-i)*u|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*u|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function jm(t){var e=t,i=t;do{(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next}while(e!==t);return i}function Ud(t,e,i,a,u,f,_,b){return(u-_)*(e-b)>=(t-_)*(f-b)&&(t-_)*(a-b)>=(i-_)*(e-b)&&(i-_)*(f-b)>=(u-_)*(a-b)}function mv(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(i,a){var u=i;do{if(u.i!==i.i&&u.next.i!==i.i&&u.i!==a.i&&u.next.i!==a.i&&Fh(u,u.next,i,a))return!0;u=u.next}while(u!==i);return!1}(t,e)&&(Ru(t,e)&&Ru(e,t)&&function(i,a){var u=i,f=!1,_=(i.x+a.x)/2,b=(i.y+a.y)/2;do{u.y>b!=u.next.y>b&&u.next.y!==u.y&&_<(u.next.x-u.x)*(b-u.y)/(u.next.y-u.y)+u.x&&(f=!f),u=u.next}while(u!==i);return f}(t,e)&&(Kr(t.prev,t,e.prev)||Kr(t,e.prev,e))||Ou(t,e)&&Kr(t.prev,t,t.next)>0&&Kr(e.prev,e,e.next)>0)}function Kr(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function Ou(t,e){return t.x===e.x&&t.y===e.y}function Fh(t,e,i,a){var u=bf(Kr(t,e,i)),f=bf(Kr(t,e,a)),_=bf(Kr(i,a,t)),b=bf(Kr(i,a,e));return u!==f&&_!==b||!(0!==u||!xf(t,i,e))||!(0!==f||!xf(t,a,e))||!(0!==_||!xf(i,t,a))||!(0!==b||!xf(i,e,a))}function xf(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function bf(t){return t>0?1:t<0?-1:0}function Ru(t,e){return Kr(t.prev,t,t.next)<0?Kr(t,e,t.next)>=0&&Kr(t,t.prev,e)>=0:Kr(t,e,t.prev)<0||Kr(t,t.next,e)<0}function $m(t,e){var i=new wf(t.i,t.x,t.y),a=new wf(e.i,e.x,e.y),u=t.next,f=e.prev;return t.next=e,e.prev=t,i.next=u,u.prev=i,a.next=i,i.prev=a,f.next=a,a.prev=f,a}function Hm(t,e,i,a){var u=new wf(t,e,i);return a?(u.next=a.next,u.prev=a,a.next.prev=u,a.next=u):(u.prev=u,u.next=u),u}function Zd(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function wf(t,e,i){this.i=t,this.x=e,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bh(t,e,i,a){for(var u=0,f=e,_=i-a;f<i;f+=a)u+=(t[_]-t[f])*(t[f+1]+t[_+1]),_=f;return u}Zm.exports=yf,Zm.exports.default=yf,yf.deviation=function(t,e,i,a){var u=e&&e.length,f=Math.abs(Bh(t,0,u?e[0]*i:t.length,i));if(u)for(var _=0,b=e.length;_<b;_++)f-=Math.abs(Bh(t,e[_]*i,_<b-1?e[_+1]*i:t.length,i));var E=0;for(_=0;_<a.length;_+=3){var D=a[_]*i,k=a[_+1]*i,z=a[_+2]*i;E+=Math.abs((t[D]-t[z])*(t[k+1]-t[D+1])-(t[D]-t[k])*(t[z+1]-t[D+1]))}return 0===f&&0===E?0:Math.abs((E-f)/f)},yf.flatten=function(t){for(var e=t[0][0].length,i={vertices:[],holes:[],dimensions:e},a=0,u=0;u<t.length;u++){for(var f=0;f<t[u].length;f++)for(var _=0;_<e;_++)i.vertices.push(t[u][f][_]);u>0&&i.holes.push(a+=t[u-1].length)}return i};var Lu=we(Zm.exports);function O_(t,e,i,a,u){Nh(t,e,i||0,a||t.length-1,u||ss)}function Nh(t,e,i,a,u){for(;a>i;){if(a-i>600){var f=a-i+1,_=e-i+1,b=Math.log(f),E=.5*Math.exp(2*b/3),D=.5*Math.sqrt(b*E*(f-E)/f)*(_-f/2<0?-1:1);Nh(t,e,Math.max(i,Math.floor(e-_*E/f+D)),Math.min(a,Math.floor(e+(f-_)*E/f+D)),u)}var k=t[e],z=i,j=a;for(Vd(t,i,e),u(t[a],k)>0&&Vd(t,i,a);z<j;){for(Vd(t,z,j),z++,j--;u(t[z],k)<0;)z++;for(;u(t[j],k)>0;)j--}0===u(t[i],k)?Vd(t,i,j):Vd(t,++j,a),j<=e&&(i=j+1),e<=j&&(a=j-1)}}function Vd(t,e,i){var a=t[e];t[e]=t[i],t[i]=a}function ss(t,e){return t<e?-1:t>e?1:0}function Tf(t,e){const i=t.length;if(i<=1)return[t];const a=[];let u,f;for(let _=0;_<i;_++){const b=Wt(t[_]);0!==b&&(t[_].area=Math.abs(b),void 0===f&&(f=b<0),f===b<0?(u&&a.push(u),u=[t[_]]):u.push(t[_]))}if(u&&a.push(u),e>1)for(let _=0;_<a.length;_++)a[_].length<=e||(O_(a[_],e,1,a[_].length-1,R_),a[_]=a[_].slice(0,e));return a}function R_(t,e){return e.area-t.area}function jd(t,e,i){const a=i.patternDependencies;let u=!1;for(const f of e){const _=f.paint.get(`${t}-pattern`);_.isConstant()||(u=!0);const b=_.constantOr(null);b&&(u=!0,a[b]=!0)}return u}function zh(t,e,i,a,u){const f=u.patternDependencies;for(const _ of e){const b=_.paint.get(`${t}-pattern`).value;if("constant"!==b.kind){let E=b.evaluate({zoom:a},i,{},u.availableImages);E=E&&E.name?E.name:E,f[E]=!0,i.patterns[_.id]=E}}return i}class Uh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wn,this.indexArray=new Ti,this.indexArray2=new Yr,this.programConfigurations=new Yc(e.layers,e.zoom),this.segments=new Cr,this.segments2=new Cr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.projection=e.projection}populate(e,i,a,u){this.hasPattern=jd("fill",this.layers,i);const f=this.layers[0].layout.get("fill-sort-key"),_=[];for(const{feature:b,id:E,index:D,sourceLayerIndex:k}of e){const z=this.layers[0]._featureFilter.needGeometry,j=Yl(b,z);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),j,a))continue;const K=f?f.evaluate(j,{},a,i.availableImages):void 0,te={id:E,properties:b.properties,type:b.type,sourceLayerIndex:k,index:D,geometry:z?j.geometry:Dl(b,a,u),patterns:{},sortKey:K};_.push(te)}f&&_.sort((b,E)=>b.sortKey-E.sortKey);for(const b of _){const{geometry:E,index:D,sourceLayerIndex:k}=b;if(this.hasPattern){const z=zh("fill",this.layers,b,this.zoom,i);this.patternFeatures.push(z)}else this.addFeature(b,E,D,a,{},i.availableImages);i.featureIndex.insert(e[D].feature,E,D,k,this.index)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}addFeatures(e,i,a,u,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,i,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,fv),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,i,a,u,f,_=[]){for(const b of Tf(i,500)){let E=0;for(const te of b)E+=te.length;const D=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),k=D.vertexLength,z=[],j=[];for(const te of b){if(0===te.length)continue;te!==b[0]&&j.push(z.length/2);const he=this.segments2.prepareSegment(te.length,this.layoutVertexArray,this.indexArray2),Re=he.vertexLength;this.layoutVertexArray.emplaceBack(te[0].x,te[0].y),this.indexArray2.emplaceBack(Re+te.length-1,Re),z.push(te[0].x),z.push(te[0].y);for(let rt=1;rt<te.length;rt++)this.layoutVertexArray.emplaceBack(te[rt].x,te[rt].y),this.indexArray2.emplaceBack(Re+rt-1,Re+rt),z.push(te[rt].x),z.push(te[rt].y);he.vertexLength+=te.length,he.primitiveLength+=te.length}const K=Lu(z,j);for(let te=0;te<K.length;te+=3)this.indexArray.emplaceBack(k+K[te],k+K[te+1],k+K[te+2]);D.vertexLength+=E,D.primitiveLength+=K.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,_,u)}}di(Uh,"FillBucket",{omit:["layers","patternFeatures"]});const L_=new ht({"fill-sort-key":new He(en.layout_fill["fill-sort-key"])});var k_={paint:new ht({"fill-antialias":new ue(en.paint_fill["fill-antialias"]),"fill-opacity":new He(en.paint_fill["fill-opacity"]),"fill-color":new He(en.paint_fill["fill-color"]),"fill-outline-color":new He(en.paint_fill["fill-outline-color"]),"fill-translate":new ue(en.paint_fill["fill-translate"]),"fill-translate-anchor":new ue(en.paint_fill["fill-translate-anchor"]),"fill-pattern":new He(en.paint_fill["fill-pattern"])}),layout:L_};const F_=$t([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),Gm=$t([{name:"a_centroid_pos",components:2,type:"Uint16"}]),gv=$t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:_v}=F_;var bc={},lr=Ke,ku=au;function au(t,e,i,a,u){this.properties={},this.extent=i,this.type=0,this._pbf=t,this._geometry=-1,this._keys=a,this._values=u,t.readFields(Wm,this,e)}function Wm(t,e,i){1==t?e.id=i.readVarint():2==t?function(a,u){for(var f=a.readVarint()+a.pos;a.pos<f;){var _=u._keys[a.readVarint()],b=u._values[a.readVarint()];u.properties[_]=b}}(i,e):3==t?e.type=i.readVarint():4==t&&(e._geometry=i.pos)}function qm(t){for(var e,i,a=0,u=0,f=t.length,_=f-1;u<f;_=u++)a+=((i=t[_]).x-(e=t[u]).x)*(e.y+i.y);return a}au.types=["Unknown","Point","LineString","Polygon"],au.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,i=t.readVarint()+t.pos,a=1,u=0,f=0,_=0,b=[];t.pos<i;){if(u<=0){var E=t.readVarint();a=7&E,u=E>>3}if(u--,1===a||2===a)f+=t.readSVarint(),_+=t.readSVarint(),1===a&&(e&&b.push(e),e=[]),e.push(new lr(f,_));else{if(7!==a)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&b.push(e),b},au.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,i=1,a=0,u=0,f=0,_=1/0,b=-1/0,E=1/0,D=-1/0;t.pos<e;){if(a<=0){var k=t.readVarint();i=7&k,a=k>>3}if(a--,1===i||2===i)(u+=t.readSVarint())<_&&(_=u),u>b&&(b=u),(f+=t.readSVarint())<E&&(E=f),f>D&&(D=f);else if(7!==i)throw new Error("unknown command "+i)}return[_,E,b,D]},au.prototype.toGeoJSON=function(t,e,i){var a,u,f=this.extent*Math.pow(2,i),_=this.extent*t,b=this.extent*e,E=this.loadGeometry(),D=au.types[this.type];function k(K){for(var te=0;te<K.length;te++){var he=K[te];K[te]=[360*(he.x+_)/f-180,360/Math.PI*Math.atan(Math.exp((180-360*(he.y+b)/f)*Math.PI/180))-90]}}switch(this.type){case 1:var z=[];for(a=0;a<E.length;a++)z[a]=E[a][0];k(E=z);break;case 2:for(a=0;a<E.length;a++)k(E[a]);break;case 3:for(E=function(K){var te=K.length;if(te<=1)return[K];for(var he,Re,rt=[],wt=0;wt<te;wt++){var lt=qm(K[wt]);0!==lt&&(void 0===Re&&(Re=lt<0),Re===lt<0?(he&&rt.push(he),he=[K[wt]]):he.push(K[wt]))}return he&&rt.push(he),rt}(E),a=0;a<E.length;a++)for(u=0;u<E[a].length;u++)k(E[a][u])}1===E.length?E=E[0]:D="Multi"+D;var j={type:"Feature",geometry:{type:D,coordinates:E},properties:this.properties};return"id"in this&&(j.id=this.id),j};var Cf=ku,Ym=Ef;function Ef(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(Jm,this,e),this.length=this._features.length}function Jm(t,e,i){15===t?e.version=i.readVarint():1===t?e.name=i.readString():5===t?e.extent=i.readVarint():2===t?e._features.push(i.pos):3===t?e._keys.push(i.readString()):4===t&&e._values.push(function(a){for(var u=null,f=a.readVarint()+a.pos;a.pos<f;){var _=a.readVarint()>>3;u=1===_?a.readString():2===_?a.readFloat():3===_?a.readDouble():4===_?a.readVarint64():5===_?a.readVarint():6===_?a.readSVarint():7===_?a.readBoolean():null}return u}(i))}Ef.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Cf(this._pbf,e,this.extent,this._keys,this._values)};var Df=Ym;function yv(t,e,i){if(3===t){var a=new Df(i,i.readVarint()+i.pos);a.length&&(e[a.name]=a)}}var $d=bc.VectorTile=function(t,e){this.layers=t.readFields(yv,{},e)},Zh=bc.VectorTileFeature=ku;function Fu(t,e,i,a){const u=[],f=0===a?(_,b,E,D,k,z)=>{_.push(new Ce(z,E+(z-b)/(D-b)*(k-E)))}:(_,b,E,D,k,z)=>{_.push(new Ce(b+(z-E)/(k-E)*(D-b),z))};for(const _ of t){const b=[];for(const E of _){if(E.length<=2)continue;const D=[];for(let j=0;j<E.length-1;j++){const K=E[j].x,te=E[j].y,he=E[j+1].x,Re=E[j+1].y,rt=0===a?K:te,wt=0===a?he:Re;rt<e?wt>e&&f(D,K,te,he,Re,e):rt>i?wt<i&&f(D,K,te,he,Re,i):D.push(E[j]),wt<e&&rt>=e&&f(D,K,te,he,Re,e),wt>i&&rt<=i&&f(D,K,te,he,Re,i)}let k=E[E.length-1];const z=0===a?k.x:k.y;z>=e&&z<=i&&D.push(k),D.length&&(k=D[D.length-1],D[0].x===k.x&&D[0].y===k.y||D.push(D[0]),b.push(D))}b.length&&u.push(b)}return u}bc.VectorTileLayer=Ym;const Km=Zh.types,Xm=Math.pow(2,13);function ll(t,e,i,a,u,f,_,b){t.emplaceBack((e<<1)+_,(i<<1)+f,(Math.floor(a*Xm)<<1)+u,Math.round(b))}function Hd(t,e,i){t.emplaceBack(e.x,e.y,e.z,16384*i[0],16384*i[1],16384*i[2])}class Vh{constructor(){this.acc=new Ce(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ce(e.x,e.y),this.max=new Ce(e.x,e.y))}append(e,i){this.currentPolyCount.edges++,this.acc._add(e);const a=this.min,u=this.max;e.x<a.x?a.x=e.x:e.x>u.x&&(u.x=e.x),e.y<a.y?a.y=e.y:e.y>u.y&&(u.y=e.y),((0===e.x||e.x===Li)&&e.x===i.x)!=((0===e.y||e.y===Li)&&e.y===i.y)&&this.processBorderOverlap(e,i),i.x<0!=e.x<0&&this.addBorderIntersection(0,Xn(i.y,e.y,(0-i.x)/(e.x-i.x))),i.x>Li!=e.x>Li&&this.addBorderIntersection(1,Xn(i.y,e.y,(Li-i.x)/(e.x-i.x))),i.y<0!=e.y<0&&this.addBorderIntersection(2,Xn(i.x,e.x,(0-i.y)/(e.y-i.y))),i.y>Li!=e.y>Li&&this.addBorderIntersection(3,Xn(i.x,e.x,(Li-i.y)/(e.y-i.y)))}addBorderIntersection(e,i){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const a=this.borders[e];i<a[0]&&(a[0]=i),i>a[1]&&(a[1]=i)}processBorderOverlap(e,i){if(e.x===i.x){if(e.y===i.y)return;const a=0===e.x?0:1;this.addBorderIntersection(a,i.y),this.addBorderIntersection(a,e.y)}else{const a=0===e.y?2:3;this.addBorderIntersection(a,i.x),this.addBorderIntersection(a,e.x)}}centroid(){const e=this.polyCount.reduce((i,a)=>i+a.edges,0);return 0!==e?this.acc.div(e)._round():new Ce(0,0)}span(){return new Ce(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,i)=>e+ +(i[0]!==Number.MAX_VALUE),0)}}class wc{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new An,this.centroidVertexArray=new mr,this.indexArray=new Ti,this.programConfigurations=new Yc(e.layers,e.zoom),this.segments=new Cr,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id),this.enableTerrain=e.enableTerrain}populate(e,i,a,u){this.features=[],this.hasPattern=jd("fill-extrusion",this.layers,i),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(f){const _=Math.exp(Math.PI*(1-f.y/(1<<f.z)*2));return 80150034*_/(_*_+1)/Li/(1<<f.z)}(a),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:f,id:_,index:b,sourceLayerIndex:E}of e){const D=this.layers[0]._featureFilter.needGeometry,k=Yl(f,D);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),k,a))continue;const z={id:_,sourceLayerIndex:E,index:b,geometry:D?k.geometry:Dl(f,a,u),properties:f.properties,type:f.type,patterns:{}},j=this.layoutVertexArray.length;this.hasPattern?this.features.push(zh("fill-extrusion",this.layers,z,this.zoom,i)):this.addFeature(z,z.geometry,b,a,{},i.availableImages,u),i.featureIndex.insert(f,z.geometry,b,E,this.index,j)}this.sortBorders()}addFeatures(e,i,a,u,f){for(const _ of this.features){const{geometry:b}=_;this.addFeature(_,b,_.index,i,a,u,f)}this.sortBorders()}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,_v),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,gv.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Gm.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,i,a,u,f,_,b){const E=[new Ce(0,0),new Ce(Li,Li)],D=b.projection,k="globe"===D.name,z=this.enableTerrain&&!k?new Vh:null,j="Polygon"===Km[e.type];k&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new jn);const K=Tf(i,500);for(let rt=K.length-1;rt>=0;rt--){const wt=K[rt];(0===wt.length||(te=wt[0]).every(lt=>lt.x<=0)||te.every(lt=>lt.x>=Li)||te.every(lt=>lt.y<=0)||te.every(lt=>lt.y>=Li))&&K.splice(rt,1)}var te;let he;if(k)he=tg(K,E,u);else{he=[];for(const rt of K)he.push({polygon:rt,bounds:E})}const Re=j?this.edgeRadius:0;for(const{polygon:rt,bounds:wt}of he){let lt=0,bt=0;for(const Dt of rt)j&&!Dt[0].equals(Dt[Dt.length-1])&&Dt.push(Dt[0]),bt+=j?Dt.length-1:Dt.length;const Mt=this.segments.prepareSegment((j?5:4)*bt,this.layoutVertexArray,this.indexArray);if(j){const Dt=[],cn=[];lt=Mt.vertexLength;for(const En of rt){let Hn,fn;En.length&&En!==rt[0]&&cn.push(Dt.length/2),Hn=En[1].sub(En[0])._perp()._unit();for(let kn=1;kn<En.length;kn++){const Fn=En[kn],Vn=En[kn===En.length-1?1:kn+1];let{x:Jn,y:Cn}=Fn;if(Re){fn=Vn.sub(Fn)._perp()._unit();const ai=Hn.add(fn)._unit(),xi=Re*Math.min(4,1/(Hn.x*ai.x+Hn.y*ai.y));Jn+=xi*ai.x,Cn+=xi*ai.y,Hn=fn}ll(this.layoutVertexArray,Jn,Cn,0,0,1,1,0),Mt.vertexLength++,Dt.push(Fn.x,Fn.y),k&&Hd(this.layoutVertexExtArray,D.projectTilePoint(Jn,Cn,u),D.upVector(u,Jn,Cn))}}const on=Lu(Dt,cn);for(let En=0;En<on.length;En+=3)this.indexArray.emplaceBack(lt+on[En],lt+on[En+2],lt+on[En+1]),Mt.primitiveLength++}for(const Dt of rt){z&&Dt.length&&z.startRing(Dt[0]);let cn,on,En,Hn=Dt.length>4&&jh(Dt[Dt.length-2],Dt[0],Dt[1]),fn=Re?Mf(Dt[Dt.length-2],Dt[0],Dt[1],Re):0;on=Dt[1].sub(Dt[0])._perp()._unit();let kn=!0;for(let Fn=1,Vn=0;Fn<Dt.length;Fn++){let Jn=Dt[Fn-1],Cn=Dt[Fn];const ai=Dt[Fn===Dt.length-1?1:Fn+1];if(z&&j&&z.currentPolyCount.top++,Tc(Cn,Jn,wt)){Re&&(on=ai.sub(Cn)._perp()._unit(),kn=!kn);continue}z&&z.append(Cn,Jn);const xi=Cn.sub(Jn)._perp(),ci=xi.x/(Math.abs(xi.x)+Math.abs(xi.y)),to=xi.y>0?1:0,Kn=Jn.dist(Cn);if(Vn+Kn>32768&&(Vn=0),Re){En=ai.sub(Cn)._perp()._unit();let Yi=Gd(Jn,Cn,ai,Qm(on,En),Re);isNaN(Yi)&&(Yi=0);const Ui=Cn.sub(Jn)._unit();Jn=Jn.add(Ui.mult(fn))._round(),Cn=Cn.add(Ui.mult(-Yi))._round(),fn=Yi,on=En}const Mi=Mt.vertexLength,Wi=Dt.length>4&&jh(Jn,Cn,ai);let Io=$h(Vn,Hn,kn);if(ll(this.layoutVertexArray,Jn.x,Jn.y,ci,to,0,0,Io),ll(this.layoutVertexArray,Jn.x,Jn.y,ci,to,0,1,Io),Vn+=Kn,Io=$h(Vn,Wi,!kn),Hn=Wi,ll(this.layoutVertexArray,Cn.x,Cn.y,ci,to,0,0,Io),ll(this.layoutVertexArray,Cn.x,Cn.y,ci,to,0,1,Io),Mt.vertexLength+=4,this.indexArray.emplaceBack(Mi+0,Mi+1,Mi+2),this.indexArray.emplaceBack(Mi+1,Mi+3,Mi+2),Mt.primitiveLength+=2,Re){const Yi=lt+(1===Fn?Dt.length-2:Fn-2),Ui=1===Fn?lt:Yi+1;if(this.indexArray.emplaceBack(Mi+1,Yi,Mi+3),this.indexArray.emplaceBack(Yi,Ui,Mi+3),Mt.primitiveLength+=2,void 0===cn&&(cn=Mi),!Tc(ai,Dt[Fn],wt)){const Yo=Fn===Dt.length-1?cn:Mt.vertexLength;this.indexArray.emplaceBack(Mi+2,Mi+3,Yo),this.indexArray.emplaceBack(Mi+3,Yo+1,Yo),this.indexArray.emplaceBack(Mi+3,Ui,Yo+1),Mt.primitiveLength+=3}kn=!kn}if(k){const Yi=this.layoutVertexExtArray,Ui=D.projectTilePoint(Jn.x,Jn.y,u),Yo=D.projectTilePoint(Cn.x,Cn.y,u),no=D.upVector(u,Jn.x,Jn.y),oo=D.upVector(u,Cn.x,Cn.y);Hd(Yi,Ui,no),Hd(Yi,Ui,no),Hd(Yi,Yo,oo),Hd(Yi,Yo,oo)}}j&&(lt+=Dt.length-1)}}if(z&&z.polyCount.length>0){if(z.borders){z.vertexArrayOffset=this.centroidVertexArray.length;const rt=z.borders,wt=this.featuresOnBorder.push(z)-1;for(let lt=0;lt<4;lt++)rt[lt][0]!==Number.MAX_VALUE&&this.borders[lt].push(wt)}this.encodeCentroid(z.borders?void 0:z.centroid(),z)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,_,u)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((i,a)=>this.featuresOnBorder[i].borders[e][0]-this.featuresOnBorder[a].borders[e][0])}encodeCentroid(e,i,a=!0){let u,f;if(e)if(0!==e.y){const b=i.span()._mult(this.tileToMeter);u=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(b.x/10)),f=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(b.y/10))}else u=Math.ceil(7*(e.x+450)),f=0;else u=0,f=+a;let _=a?this.centroidVertexArray.length:i.vertexArrayOffset;for(const b of i.polyCount){a&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*b.edges+b.top);for(let E=0;E<b.top;E++)this.centroidVertexArray.emplace(_++,u,f);for(let E=0;E<2*b.edges;E++)this.centroidVertexArray.emplace(_++,0,f),this.centroidVertexArray.emplace(_++,u,f)}}}function Qm(t,e){const i=t.add(e)._unit();return t.x*i.x+t.y*i.y}function Mf(t,e,i,a){const u=e.sub(t)._perp()._unit(),f=i.sub(e)._perp()._unit();return Gd(t,e,i,Qm(u,f),a)}function Gd(t,e,i,a,u){const f=Math.sqrt(1-a*a);return Math.min(t.dist(e)/3,e.dist(i)/3,u*f/a)}function Tc(t,e,i){return t.x<i[0].x&&e.x<i[0].x||t.x>i[1].x&&e.x>i[1].x||t.y<i[0].y&&e.y<i[0].y||t.y>i[1].y&&e.y>i[1].y}function jh(t,e,i){if(t.x<0||t.x>=Li||e.x<0||e.x>=Li||i.x<0||i.x>=Li)return!1;const a=i.sub(e),u=a.perp(),f=t.sub(e);return(a.x*f.x+a.y*f.y)/Math.sqrt((a.x*a.x+a.y*a.y)*(f.x*f.x+f.y*f.y))>-.866&&u.x*f.x+u.y*f.y<0}function $h(t,e,i){const a=e?2|t:-3&t;return i?1|a:-2&a}function eg(){const t=Math.PI/32,e=Math.tan(t),i=iu;return i*Math.sqrt(1+2*e*e)-i}function tg(t,e,i){const a=1<<i.z,u=wa(i.x/a),f=wa((i.x+1)/a),_=vs(i.y/a),b=vs((i.y+1)/a);return function(E,D,k,z,j=0,K){const te=[];if(!E.length||!k||!z)return te;const he=(Dt,cn)=>{for(const on of Dt)te.push({polygon:on,bounds:cn})},Re=Math.ceil(Math.log2(k)),rt=Math.ceil(Math.log2(z)),wt=Re-rt,lt=[];for(let Dt=0;Dt<Math.abs(wt);Dt++)lt.push(wt>0?0:1);for(let Dt=0;Dt<Math.min(Re,rt);Dt++)lt.push(0),lt.push(1);let bt=E;if(bt=Fu(bt,D[0].y-j,D[1].y+j,1),bt=Fu(bt,D[0].x-j,D[1].x+j,0),!bt.length)return te;const Mt=[];for(lt.length?Mt.push({polygons:bt,bounds:D,depth:0}):he(bt,D);Mt.length;){const Dt=Mt.pop(),cn=Dt.depth,on=lt[cn],En=Dt.bounds[0],Hn=Dt.bounds[1],fn=0===on?En.x:En.y,kn=0===on?Hn.x:Hn.y,Fn=K?K(on,fn,kn):.5*(fn+kn),Vn=Fu(Dt.polygons,fn-j,Fn+j,on),Jn=Fu(Dt.polygons,Fn-j,kn+j,on);if(Vn.length){const Cn=[En,new Ce(0===on?Fn:Hn.x,1===on?Fn:Hn.y)];lt.length>cn+1?Mt.push({polygons:Vn,bounds:Cn,depth:cn+1}):he(Vn,Cn)}if(Jn.length){const Cn=[new Ce(0===on?Fn:En.x,1===on?Fn:En.y),Hn];lt.length>cn+1?Mt.push({polygons:Jn,bounds:Cn,depth:cn+1}):he(Jn,Cn)}}return te}(t,e,Math.ceil((f-u)/11.25),Math.ceil((_-b)/11.25),1,(E,D,k)=>{if(0===E)return.5*(D+k);{const z=vs((i.y+D/Li)/a);return(al(.5*(vs((i.y+k/Li)/a)+z))*a-i.y)*Li}})}di(wc,"FillExtrusionBucket",{omit:["layers","features"]}),di(Vh,"PartMetadata");const ng=new ht({"fill-extrusion-edge-radius":new ue(en["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var Bu={paint:new ht({"fill-extrusion-opacity":new ue(en["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new He(en["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ue(en["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ue(en["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new He(en["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new He(en["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new He(en["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ue(en["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ue(en["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ue(en["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ue(en["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:ng};function ig(t,e,i){var a=2*Math.PI*6378137/256/Math.pow(2,i);return[t*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Hh{constructor(e,i,a){this.z=e,this.x=i,this.y=a,this.key=Nu(0,e,e,i,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,i){const a=(_=this.y,b=this.z,E=ig(256*(f=this.x),256*(_=Math.pow(2,b)-_-1),b),D=ig(256*(f+1),256*(_+1),b),E[0]+","+E[1]+","+D[0]+","+D[1]),u=function(f,_,b){let E,D="";for(let k=f;k>0;k--)E=1<<k-1,D+=(_&E?1:0)+(b&E?2:0);return D}(this.z,this.x,this.y);var f,_,b,E,D;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===i?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",u).replace("{bbox-epsg-3857}",a)}toString(){return`${this.z}/${this.x}/${this.y}`}}class og{constructor(e,i){this.wrap=e,this.canonical=i,this.key=Nu(e,i.z,i.z,i.x,i.y)}}class Is{constructor(e,i,a,u,f){this.overscaledZ=e,this.wrap=i,this.canonical=new Hh(a,+u,+f),this.key=0===i&&e===a?this.canonical.key:Nu(i,e,a,u,f)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const i=this.canonical.z-e;return e>this.canonical.z?new Is(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Is(e,this.wrap,e,this.canonical.x>>i,this.canonical.y>>i)}calculateScaledKey(e,i=!0){if(this.overscaledZ===e&&i)return this.key;if(e>this.canonical.z)return Nu(this.wrap*+i,e,this.canonical.z,this.canonical.x,this.canonical.y);{const a=this.canonical.z-e;return Nu(this.wrap*+i,e,e,this.canonical.x>>a,this.canonical.y>>a)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const i=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>i&&e.canonical.y===this.canonical.y>>i}children(e){if(this.overscaledZ>=e)return[new Is(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const i=this.canonical.z+1,a=2*this.canonical.x,u=2*this.canonical.y;return[new Is(i,this.wrap,i,a,u),new Is(i,this.wrap,i,a+1,u),new Is(i,this.wrap,i,a,u+1),new Is(i,this.wrap,i,a+1,u+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Is(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Is(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new og(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Nu(t,e,i,a,u){const f=1<<Math.min(i,22);let _=f*(u%f)+a%f;return t&&i<22&&(_+=f*f*((t<0?-2*t-1:2*t)%(1<<2*(22-i)))),16*(32*_+i)+(e-i)}di(Hh,"CanonicalTileID"),di(Is,"OverscaledTileID",{omit:["projMatrix"]});class zu extends Ce{constructor(e,i,a){super(e,i),this.z=a}}function Uu(t,e){return t.x*e.x+t.y*e.y}function Gh(t,e){if(1===t.length){let i=0;const a=e[i++];let u;for(;!u||a.equals(u);)if(u=e[i++],!u)return 1/0;for(;i<e.length;i++){const f=e[i],_=t[0],b=u.sub(a),E=f.sub(a),D=_.sub(a),k=Uu(b,b),z=Uu(b,E),j=Uu(E,E),K=Uu(D,b),te=Uu(D,E),he=k*j-z*z,Re=(j*K-z*te)/he,rt=(k*te-z*K)/he,wt=a.z*(1-Re-rt)+u.z*Re+f.z*rt;if(isFinite(wt))return wt}return 1/0}{let i=1/0;for(const a of e)i=Math.min(i,a.z);return i}}function B_(t,e,i,a,u,f,_,b){const E=_*u.getElevationAt(t,e,!0,!0),D=0!==f[0],k=D?0===f[1]?_*(f[0]/7-450):_*function(z,j,K){const te=Math.floor(j[0]/8),he=Math.floor(j[1]/8),Re=10*(j[0]-8*te),rt=10*(j[1]-8*he),wt=z.getElevationAt(te,he,!0,!0),lt=z.getMeterToDEM(K),bt=Math.floor(.5*(Re*lt-1)),Mt=Math.floor(.5*(rt*lt-1)),Dt=z.tileCoordToPixel(te,he),cn=2*bt+1,on=2*Mt+1,En=(xi=cn,ci=on,[(Jn=z).getElevationAtPixel(Cn=Dt.x-bt,ai=Dt.y-Mt,!0),Jn.getElevationAtPixel(Cn+ci,ai,!0),Jn.getElevationAtPixel(Cn,ai+ci,!0),Jn.getElevationAtPixel(Cn+xi,ai+ci,!0)]),Hn=Math.abs(En[0]-En[1]),fn=Math.abs(En[2]-En[3]),kn=Math.abs(En[0]-En[2])+Math.abs(En[1]-En[3]),Fn=Math.min(.25,.5*lt*(Hn+fn)/cn),Vn=Math.min(.25,.5*lt*kn/on);var Jn,Cn,ai,xi,ci;return wt+Math.max(Fn*Re,Vn*rt)}(u,f,b):E;return{base:E+(0===i)?-1:i,top:D?Math.max(k+a,E+i+2):E+a}}const vv=$t([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:N_}=vv,z_=$t([{name:"a_packed",components:4,type:"Float32"}]),{members:xv}=z_,bv=Zh.types,Wh=Math.cos(Math.PI/180*37.5);class qh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(i=>i.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(i=>{this.gradients[i.id]={}}),this.layoutVertexArray=new pn,this.layoutVertexArray2=new $n,this.indexArray=new Ti,this.programConfigurations=new Yc(e.layers,e.zoom),this.segments=new Cr,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(i=>i.isStateDependent()).map(i=>i.id)}populate(e,i,a,u){this.hasPattern=jd("line",this.layers,i);const f=this.layers[0].layout.get("line-sort-key"),_=[];for(const{feature:k,id:z,index:j,sourceLayerIndex:K}of e){const te=this.layers[0]._featureFilter.needGeometry,he=Yl(k,te);if(!this.layers[0]._featureFilter.filter(new N(this.zoom),he,a))continue;const Re=f?f.evaluate(he,{},a):void 0,rt={id:z,properties:k.properties,type:k.type,sourceLayerIndex:K,index:j,geometry:te?he.geometry:Dl(k,a,u),patterns:{},sortKey:Re};_.push(rt)}f&&_.sort((k,z)=>k.sortKey-z.sortKey);const{lineAtlas:b,featureIndex:E}=i,D=this.addConstantDashes(b);for(const k of _){const{geometry:z,index:j,sourceLayerIndex:K}=k;if(D&&this.addFeatureDashes(k,b),this.hasPattern){const te=zh("line",this.layers,k,this.zoom,i);this.patternFeatures.push(te)}else this.addFeature(k,z,j,a,b.positions,i.availableImages);E.insert(e[j].feature,z,j,K,this.index)}}addConstantDashes(e){let i=!1;for(const a of this.layers){const u=a.paint.get("line-dasharray").value,f=a.layout.get("line-cap").value;if("constant"!==u.kind||"constant"!==f.kind)i=!0;else{const _=f.value,b=u.value;if(!b)continue;e.addDash(b,_)}}return i}addFeatureDashes(e,i){const a=this.zoom;for(const u of this.layers){const f=u.paint.get("line-dasharray").value,_=u.layout.get("line-cap").value;if("constant"===f.kind&&"constant"===_.kind)continue;let b,E;if("constant"===f.kind){if(b=f.value,!b)continue}else b=f.evaluate({zoom:a},e);E="constant"===_.kind?_.value:_.evaluate({zoom:a},e),i.addDash(b,E),e.patterns[u.id]=i.getKey(b,E)}}update(e,i,a,u){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,i,this.stateDependentLayers,a,u)}addFeatures(e,i,a,u,f){for(const _ of this.patternFeatures)this.addFeature(_,_.geometry,_.index,i,a,u)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,xv)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,N_),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,i,a,u,f,_){const b=this.layers[0].layout,E=b.get("line-join").evaluate(e,{}),D=b.get("line-cap").evaluate(e,{}),k=b.get("line-miter-limit"),z=b.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const j of i)this.addLine(j,e,E,D,k,z);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,f,_,u)}addLine(e,i,a,u,f,_){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let rt=0;rt<e.length-1;rt++)this.totalDistance+=e[rt].dist(e[rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const b="Polygon"===bv[i.type];let E=e.length;for(;E>=2&&e[E-1].equals(e[E-2]);)E--;let D=0;for(;D<E-1&&e[D].equals(e[D+1]);)D++;if(E<(b?3:2))return;"bevel"===a&&(f=1.05);const k=this.overscaling<=16?15*Li/(512*this.overscaling):0,z=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let j,K,te,he,Re;this.e1=this.e2=-1,b&&(j=e[E-2],Re=e[D].sub(j)._unit()._perp());for(let rt=D;rt<E;rt++){if(te=rt===E-1?b?e[D+1]:void 0:e[rt+1],te&&e[rt].equals(te))continue;Re&&(he=Re),j&&(K=j),j=e[rt],Re=te?te.sub(j)._unit()._perp():he,he=he||Re;let wt=he.add(Re);0===wt.x&&0===wt.y||wt._unit();const lt=he.x*Re.x+he.y*Re.y,bt=wt.x*Re.x+wt.y*Re.y,Mt=0!==bt?1/bt:1/0,Dt=2*Math.sqrt(2-2*bt),cn=bt<Wh&&K&&te,on=he.x*Re.y-he.y*Re.x>0;if(cn&&rt>D){const fn=j.dist(K);if(fn>2*k){const kn=j.sub(j.sub(K)._mult(k/fn)._round());this.updateDistance(K,kn),this.addCurrentVertex(kn,he,0,0,z),K=kn}}const En=K&&te;let Hn=En?a:b?"butt":u;if(En&&"round"===Hn&&(Mt<_?Hn="miter":Mt<=2&&(Hn="fakeround")),"miter"===Hn&&Mt>f&&(Hn="bevel"),"bevel"===Hn&&(Mt>2&&(Hn="flipbevel"),Mt<f&&(Hn="miter")),K&&this.updateDistance(K,j),"miter"===Hn)wt._mult(Mt),this.addCurrentVertex(j,wt,0,0,z);else if("flipbevel"===Hn){if(Mt>100)wt=Re.mult(-1);else{const fn=Mt*he.add(Re).mag()/he.sub(Re).mag();wt._perp()._mult(fn*(on?-1:1))}this.addCurrentVertex(j,wt,0,0,z),this.addCurrentVertex(j,wt.mult(-1),0,0,z)}else if("bevel"===Hn||"fakeround"===Hn){const fn=-Math.sqrt(Mt*Mt-1),kn=on?fn:0,Fn=on?0:fn;if(K&&this.addCurrentVertex(j,he,kn,Fn,z),"fakeround"===Hn){const Vn=Math.round(180*Dt/Math.PI/20);for(let Jn=1;Jn<Vn;Jn++){let Cn=Jn/Vn;if(.5!==Cn){const xi=Cn-.5;Cn+=Cn*xi*(Cn-1)*((1.0904+lt*(lt*(3.55645-1.43519*lt)-3.2452))*xi*xi+(.848013+lt*(.215638*lt-1.06021)))}const ai=Re.sub(he)._mult(Cn)._add(he)._unit()._mult(on?-1:1);this.addHalfVertex(j,ai.x,ai.y,!1,on,0,z)}}te&&this.addCurrentVertex(j,Re,-kn,-Fn,z)}else if("butt"===Hn)this.addCurrentVertex(j,wt,0,0,z);else if("square"===Hn){const fn=K?1:-1;K||this.addCurrentVertex(j,wt,fn,fn,z),this.addCurrentVertex(j,wt,0,0,z),K&&this.addCurrentVertex(j,wt,fn,fn,z)}else"round"===Hn&&(K&&(this.addCurrentVertex(j,he,0,0,z),this.addCurrentVertex(j,he,1,1,z,!0)),te&&(this.addCurrentVertex(j,Re,-1,-1,z,!0),this.addCurrentVertex(j,Re,0,0,z)));if(cn&&rt<E-1){const fn=j.dist(te);if(fn>2*k){const kn=j.add(te.sub(j)._mult(k/fn)._round());this.updateDistance(j,kn),this.addCurrentVertex(kn,Re,0,0,z),j=kn}}}}addCurrentVertex(e,i,a,u,f,_=!1){const b=i.y*u-i.x,E=-i.y-i.x*u;this.addHalfVertex(e,i.x+i.y*a,i.y-i.x*a,_,!1,a,f),this.addHalfVertex(e,b,E,_,!0,-u,f)}addHalfVertex({x:e,y:i},a,u,f,_,b,E){this.layoutVertexArray.emplaceBack((e<<1)+(f?1:0),(i<<1)+(_?1:0),Math.round(63*a)+128,Math.round(63*u)+128,1+(0===b?0:b<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const D=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,D),E.primitiveLength++),_?this.e2=D:this.e1=D}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,i){this.distance+=e.dist(i),this.updateScaledDistance()}}di(qh,"LineBucket",{omit:["layers","patternFeatures"]});const If=new ht({"line-cap":new He(en.layout_line["line-cap"]),"line-join":new He(en.layout_line["line-join"]),"line-miter-limit":new ue(en.layout_line["line-miter-limit"]),"line-round-limit":new ue(en.layout_line["line-round-limit"]),"line-sort-key":new He(en.layout_line["line-sort-key"])});var Yh={paint:new ht({"line-opacity":new He(en.paint_line["line-opacity"]),"line-color":new He(en.paint_line["line-color"]),"line-translate":new ue(en.paint_line["line-translate"]),"line-translate-anchor":new ue(en.paint_line["line-translate-anchor"]),"line-width":new He(en.paint_line["line-width"]),"line-gap-width":new He(en.paint_line["line-gap-width"]),"line-offset":new He(en.paint_line["line-offset"]),"line-blur":new He(en.paint_line["line-blur"]),"line-dasharray":new He(en.paint_line["line-dasharray"]),"line-pattern":new He(en.paint_line["line-pattern"]),"line-gradient":new pt(en.paint_line["line-gradient"]),"line-trim-offset":new ue(en.paint_line["line-trim-offset"])}),layout:If};const Zu=new class extends He{possiblyEvaluate(t,e){return e=new N(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,i,a){return e=Ue({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,i,a)}}(Yh.paint.properties["line-width"].specification);function Jh(t,e){return e>0?e+2*t:t}Zu.useIntegerZoom=!0;const Af=$t([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Wd=$t([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Kh=$t([{name:"a_projected_pos",components:4,type:"Float32"}],4);$t([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const qd=$t([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),rg=$t([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Xh=$t([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Qh=$t([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);$t([{name:"triangle",components:3,type:"Uint16"}]),$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),$t([{type:"Float32",name:"offsetX"}]),$t([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var As=24;const Oa=128;function Yd(t,e){const{expression:i}=e;if("constant"===i.kind)return{kind:"constant",layoutSize:i.evaluate(new N(t+1))};if("source"===i.kind)return{kind:"source"};{const{zoomStops:a,interpolationType:u}=i;let f=0;for(;f<a.length&&a[f]<=t;)f++;f=Math.max(0,f-1);let _=f;for(;_<a.length&&a[_]<t+1;)_++;_=Math.min(a.length-1,_);const b=a[f],E=a[_];return"composite"===i.kind?{kind:"composite",minZoom:b,maxZoom:E,interpolationType:u}:{kind:"camera",minZoom:b,maxZoom:E,minSize:i.evaluate(new N(b)),maxSize:i.evaluate(new N(E)),interpolationType:u}}}function Jd(t,{uSize:e,uSizeT:i},{lowerSize:a,upperSize:u}){return"source"===t.kind?a/Oa:"composite"===t.kind?Xn(a/Oa,u/Oa,i):e}function Vu(t,e){let i=0,a=0;if("constant"===t.kind)a=t.layoutSize;else if("source"!==t.kind){const{interpolationType:u,minZoom:f,maxZoom:_}=t,b=u?ye(ps.interpolationFactor(u,e,f,_),0,1):0;"camera"===t.kind?a=Xn(t.minSize,t.maxSize,b):i=b}return{uSizeT:i,uSize:a}}var U_=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Oa,evaluateSizeForFeature:Jd,evaluateSizeForZoom:Vu,getSizeData:Yd});function sg(t,e,i){return t.sections.forEach(a=>{a.text=function(u,f,_){const b=f.layout.get("text-transform").evaluate(_,{});return"uppercase"===b?u=u.toLocaleUpperCase():"lowercase"===b&&(u=u.toLocaleLowerCase()),O.applyArabicShaping&&(u=O.applyArabicShaping(u)),u}(a.text,e,i)}),t}const ju={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Z_(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function V_(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var j_=Ko,ag=function(t,e,i,a,u){var f,_,b=8*u-a-1,E=(1<<b)-1,D=E>>1,k=-7,z=i?u-1:0,j=i?-1:1,K=t[e+z];for(z+=j,f=K&(1<<-k)-1,K>>=-k,k+=b;k>0;f=256*f+t[e+z],z+=j,k-=8);for(_=f&(1<<-k)-1,f>>=-k,k+=a;k>0;_=256*_+t[e+z],z+=j,k-=8);if(0===f)f=1-D;else{if(f===E)return _?NaN:1/0*(K?-1:1);_+=Math.pow(2,a),f-=D}return(K?-1:1)*_*Math.pow(2,f-a)},ep=function(t,e,i,a,u,f){var _,b,E,D=8*f-u-1,k=(1<<D)-1,z=k>>1,j=23===u?Math.pow(2,-24)-Math.pow(2,-77):0,K=a?0:f-1,te=a?1:-1,he=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(b=isNaN(e)?1:0,_=k):(_=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-_))<1&&(_--,E*=2),(e+=_+z>=1?j/E:j*Math.pow(2,1-z))*E>=2&&(_++,E/=2),_+z>=k?(b=0,_=k):_+z>=1?(b=(e*E-1)*Math.pow(2,u),_+=z):(b=e*Math.pow(2,z-1)*Math.pow(2,u),_=0));u>=8;t[i+K]=255&b,K+=te,b/=256,u-=8);for(_=_<<u|b,D+=u;D>0;t[i+K]=255&_,K+=te,_/=256,D-=8);t[i+K-te]|=128*he};function Ko(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}Ko.Varint=0,Ko.Fixed64=1,Ko.Bytes=2,Ko.Fixed32=5;var Sf=4294967296,Pf=1/Sf,tp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ha(t){return t.type===Ko.Bytes?t.readVarint()+t.pos:t.pos+1}function Of(t,e,i){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));i.realloc(a);for(var u=i.pos-1;u>=t;u--)i.buf[u+a]=i.buf[u]}function $_(t,e){for(var i=0;i<t.length;i++)e.writeVarint(t[i])}function lg(t,e){for(var i=0;i<t.length;i++)e.writeSVarint(t[i])}function wv(t,e){for(var i=0;i<t.length;i++)e.writeFloat(t[i])}function H_(t,e){for(var i=0;i<t.length;i++)e.writeDouble(t[i])}function np(t,e){for(var i=0;i<t.length;i++)e.writeBoolean(t[i])}function G_(t,e){for(var i=0;i<t.length;i++)e.writeFixed32(t[i])}function Hu(t,e){for(var i=0;i<t.length;i++)e.writeSFixed32(t[i])}function Kd(t,e){for(var i=0;i<t.length;i++)e.writeFixed64(t[i])}function W_(t,e){for(var i=0;i<t.length;i++)e.writeSFixed64(t[i])}function Xd(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Gu(t,e,i){t[i]=e,t[i+1]=e>>>8,t[i+2]=e>>>16,t[i+3]=e>>>24}function cg(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}Ko.prototype={destroy:function(){this.buf=null},readFields:function(t,e,i){for(i=i||this.length;this.pos<i;){var a=this.readVarint(),u=a>>3,f=this.pos;this.type=7&a,t(u,e,this),this.pos===f&&this.skip(a)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Xd(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=cg(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Xd(this.buf,this.pos)+Xd(this.buf,this.pos+4)*Sf;return this.pos+=8,t},readSFixed64:function(){var t=Xd(this.buf,this.pos)+cg(this.buf,this.pos+4)*Sf;return this.pos+=8,t},readFloat:function(){var t=ag(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ag(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,i,a=this.buf;return e=127&(i=a[this.pos++]),i<128?e:(e|=(127&(i=a[this.pos++]))<<7,i<128?e:(e|=(127&(i=a[this.pos++]))<<14,i<128?e:(e|=(127&(i=a[this.pos++]))<<21,i<128?e:function(u,f,_){var b,E,D=_.buf;if(b=(112&(E=D[_.pos++]))>>4,E<128||(b|=(127&(E=D[_.pos++]))<<3,E<128)||(b|=(127&(E=D[_.pos++]))<<10,E<128)||(b|=(127&(E=D[_.pos++]))<<17,E<128)||(b|=(127&(E=D[_.pos++]))<<24,E<128)||(b|=(1&(E=D[_.pos++]))<<31,E<128))return function $u(t,e,i){return i?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(u,b,f);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(i=a[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&tp?tp.decode(this.buf.subarray(e,t)):function(i,a,u){for(var f="",_=a;_<u;){var b,E,D,k=i[_],z=null,j=k>239?4:k>223?3:k>191?2:1;if(_+j>u)break;1===j?k<128&&(z=k):2===j?128==(192&(b=i[_+1]))&&(z=(31&k)<<6|63&b)<=127&&(z=null):3===j?(E=i[_+2],128==(192&(b=i[_+1]))&&128==(192&E)&&((z=(15&k)<<12|(63&b)<<6|63&E)<=2047||z>=55296&&z<=57343)&&(z=null)):4===j&&(E=i[_+2],D=i[_+3],128==(192&(b=i[_+1]))&&128==(192&E)&&128==(192&D)&&((z=(15&k)<<18|(63&b)<<12|(63&E)<<6|63&D)<=65535||z>=1114112)&&(z=null)),null===z?(z=65533,j=1):z>65535&&(z-=65536,f+=String.fromCharCode(z>>>10&1023|55296),z=56320|1023&z),f+=String.fromCharCode(z),_+=j}return f}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==Ko.Bytes)return t.push(this.readVarint(e));var i=Ha(this);for(t=t||[];this.pos<i;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==Ko.Bytes)return t.push(this.readSVarint());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==Ko.Bytes)return t.push(this.readBoolean());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==Ko.Bytes)return t.push(this.readFloat());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==Ko.Bytes)return t.push(this.readDouble());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==Ko.Bytes)return t.push(this.readFixed32());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==Ko.Bytes)return t.push(this.readSFixed32());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==Ko.Bytes)return t.push(this.readFixed64());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==Ko.Bytes)return t.push(this.readSFixed64());var e=Ha(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===Ko.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ko.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ko.Fixed32)this.pos+=4;else{if(e!==Ko.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Gu(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Gu(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Gu(this.buf,-1&t,this.pos),Gu(this.buf,Math.floor(t*Pf),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Gu(this.buf,-1&t,this.pos),Gu(this.buf,Math.floor(t*Pf),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,i){var a,u,f,b;if(e>=0?(a=e%4294967296|0,u=e/4294967296|0):(u=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,u=u+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");i.realloc(10),f=a,(b=i).buf[b.pos++]=127&f|128,f>>>=7,b.buf[b.pos++]=127&f|128,f>>>=7,b.buf[b.pos++]=127&f|128,f>>>=7,b.buf[b.pos++]=127&f|128,b.buf[b.pos]=127&(f>>>=7),function(f,_){var b=(7&f)<<4;_.buf[_.pos++]|=b|((f>>>=3)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f|((f>>>=7)?128:0),f&&(_.buf[_.pos++]=127&f)))))}(u,i)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(!!t)},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(a,u,f){for(var _,b,E=0;E<u.length;E++){if((_=u.charCodeAt(E))>55295&&_<57344){if(!b){_>56319||E+1===u.length?(a[f++]=239,a[f++]=191,a[f++]=189):b=_;continue}if(_<56320){a[f++]=239,a[f++]=191,a[f++]=189,b=_;continue}_=b-55296<<10|_-56320|65536,b=null}else b&&(a[f++]=239,a[f++]=191,a[f++]=189,b=null);_<128?a[f++]=_:(_<2048?a[f++]=_>>6|192:(_<65536?a[f++]=_>>12|224:(a[f++]=_>>18|240,a[f++]=_>>12&63|128),a[f++]=_>>6&63|128),a[f++]=63&_|128)}return f}(this.buf,t,this.pos);var i=this.pos-e;i>=128&&Of(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i},writeFloat:function(t){this.realloc(4),ep(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),ep(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var i=0;i<e;i++)this.buf[this.pos++]=t[i]},writeRawMessage:function(t,e){this.pos++;var i=this.pos;t(e,this);var a=this.pos-i;a>=128&&Of(i,a,this),this.pos=i-1,this.writeVarint(a),this.pos+=a},writeMessage:function(t,e,i){this.writeTag(t,Ko.Bytes),this.writeRawMessage(e,i)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,$_,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,lg,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,np,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,wv,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,H_,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,G_,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,Hu,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,Kd,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,W_,e)},writeBytesField:function(t,e){this.writeTag(t,Ko.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,Ko.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,Ko.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,Ko.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,Ko.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,Ko.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,Ko.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,Ko.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,Ko.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,Ko.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,!!e)}};var ip=we(j_);const op=3;function q_(t,e,i){e.glyphs=[],1===t&&i.readMessage(Rf,e)}function Rf(t,e,i){if(3===t){const{id:a,bitmap:u,width:f,height:_,left:b,top:E,advance:D}=i.readMessage(Qd,{});e.glyphs.push({id:a,bitmap:new Kl({width:f+2*op,height:_+2*op},u),metrics:{width:f,height:_,left:b,top:E,advance:D}})}else 4===t?e.ascender=i.readSVarint():5===t&&(e.descender=i.readSVarint())}function Qd(t,e,i){1===t?e.id=i.readVarint():2===t?e.bitmap=i.readBytes():3===t?e.width=i.readVarint():4===t?e.height=i.readVarint():5===t?e.left=i.readSVarint():6===t?e.top=i.readSVarint():7===t&&(e.advance=i.readVarint())}const Lf=op;function ug(t){let e=0,i=0;for(const _ of t)e+=_.w*_.h,i=Math.max(i,_.w);t.sort((_,b)=>b.h-_.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),i),h:1/0}];let u=0,f=0;for(const _ of t)for(let b=a.length-1;b>=0;b--){const E=a[b];if(!(_.w>E.w||_.h>E.h)){if(_.x=E.x,_.y=E.y,f=Math.max(f,_.y+_.h),u=Math.max(u,_.x+_.w),_.w===E.w&&_.h===E.h){const D=a.pop();b<a.length&&(a[b]=D)}else _.h===E.h?(E.x+=_.w,E.w-=_.w):_.w===E.w?(E.y+=_.h,E.h-=_.h):(a.push({x:E.x+_.w,y:E.y,w:E.w-_.w,h:_.h}),E.y+=_.h,E.h-=_.h);break}}return{w:u,h:f,fill:e/(u*f)||0}}const js=1;class Cc{constructor(e,{pixelRatio:i,version:a,stretchX:u,stretchY:f,content:_}){this.paddedRect=e,this.pixelRatio=i,this.stretchX=u,this.stretchY=f,this.content=_,this.version=a}get tl(){return[this.paddedRect.x+js,this.paddedRect.y+js]}get br(){return[this.paddedRect.x+this.paddedRect.w-js,this.paddedRect.y+this.paddedRect.h-js]}get displaySize(){return[(this.paddedRect.w-2*js)/this.pixelRatio,(this.paddedRect.h-2*js)/this.pixelRatio]}}class eh{constructor(e,i){const a={},u={};this.haveRenderCallbacks=[];const f=[];this.addImages(e,a,f),this.addImages(i,u,f);const{w:_,h:b}=ug(f),E=new Ta({width:_||1,height:b||1});for(const D in e){const k=e[D],z=a[D].paddedRect;Ta.copy(k.data,E,{x:0,y:0},{x:z.x+js,y:z.y+js},k.data)}for(const D in i){const k=i[D],z=u[D].paddedRect,j=z.x+js,K=z.y+js,te=k.data.width,he=k.data.height;Ta.copy(k.data,E,{x:0,y:0},{x:j,y:K},k.data),Ta.copy(k.data,E,{x:0,y:he-1},{x:j,y:K-1},{width:te,height:1}),Ta.copy(k.data,E,{x:0,y:0},{x:j,y:K+he},{width:te,height:1}),Ta.copy(k.data,E,{x:te-1,y:0},{x:j-1,y:K},{width:1,height:he}),Ta.copy(k.data,E,{x:0,y:0},{x:j+te,y:K},{width:1,height:he})}this.image=E,this.iconPositions=a,this.patternPositions=u}addImages(e,i,a){for(const u in e){const f=e[u],_={x:0,y:0,w:f.data.width+2*js,h:f.data.height+2*js};a.push(_),i[u]=new Cc(_,f),f.hasRenderCallback&&this.haveRenderCallbacks.push(u)}}patchUpdatedImages(e,i){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(a=>e.hasImage(a)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),i),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),i)}patchUpdatedImage(e,i,a){if(!e||!i||e.version===i.version)return;e.version=i.version;const[u,f]=e.tl;a.update(i.data,void 0,{x:u,y:f})}}di(Cc,"ImagePosition"),di(eh,"ImageAtlas");const Ca={horizontal:1,vertical:2,horizontalOnly:3},kf=-17;class th{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,i){const a=new th;return a.scale=e||1,a.fontStack=i,a}static forImage(e){const i=new th;return i.imageName=e,i}}class Wu{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,i){const a=new Wu;for(let u=0;u<e.sections.length;u++){const f=e.sections[u];f.image?a.addImageSection(f):a.addTextSection(f,i)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(i,a){let u="";for(let f=0;f<i.length;f++){const _=i.charCodeAt(f+1)||null,b=i.charCodeAt(f-1)||null;u+=!a&&(_&&le(_)&&!ju[i[f+1]]||b&&le(b)&&!ju[i[f-1]])||!ju[i[f]]?i[f]:ju[i[f]]}return u}(this.text,e)}trim(){let e=0;for(let a=0;a<this.text.length&&rp[this.text.charCodeAt(a)];a++)e++;let i=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&rp[this.text.charCodeAt(a)];a--)i--;this.text=this.text.substring(e,i),this.sectionIndex=this.sectionIndex.slice(e,i)}substring(e,i){const a=new Wu;return a.text=this.text.substring(e,i),a.sectionIndex=this.sectionIndex.slice(e,i),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,i)=>Math.max(e,this.sections[i].scale),0)}addTextSection(e,i){this.text+=e.text,this.sections.push(th.forText(e.scale,e.fontStack||i));const a=this.sections.length-1;for(let u=0;u<e.text.length;++u)this.sectionIndex.push(a)}addImageSection(e){const i=e.image?e.image.name:"";if(0===i.length)return void It("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(th.forImage(i)),this.sectionIndex.push(this.sections.length-1)):It("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Ff(t,e,i,a,u,f,_,b,E,D,k,z,j,K,te){const he=Wu.fromFeature(t,u);z===Ca.vertical&&he.verticalizePunctuation(j);let Re=[];const rt=function(Dt,cn,on,En,Hn,fn){if(!Dt)return[];const kn=[],Fn=function(ai,xi,ci,to,Kn,Mi){let Wi=0;for(let Io=0;Io<ai.length();Io++){const Yi=ai.getSection(Io);Wi+=dg(ai.getCharCode(Io),Yi,to,Kn,xi,Mi)}return Wi/Math.max(1,Math.ceil(Wi/ci))}(Dt,cn,on,En,Hn,fn),Vn=Dt.text.indexOf("\u200b")>=0;let Jn=0;for(let ai=0;ai<Dt.length();ai++){const xi=Dt.getSection(ai),ci=Dt.getCharCode(ai);if(rp[ci]||(Jn+=dg(ci,xi,En,Hn,cn,fn)),ai<Dt.length()-1){const to=!((Cn=ci)<11904||!(li["Bopomofo Extended"](Cn)||li.Bopomofo(Cn)||li["CJK Compatibility Forms"](Cn)||li["CJK Compatibility Ideographs"](Cn)||li["CJK Compatibility"](Cn)||li["CJK Radicals Supplement"](Cn)||li["CJK Strokes"](Cn)||li["CJK Symbols and Punctuation"](Cn)||li["CJK Unified Ideographs Extension A"](Cn)||li["CJK Unified Ideographs"](Cn)||li["Enclosed CJK Letters and Months"](Cn)||li["Halfwidth and Fullwidth Forms"](Cn)||li.Hiragana(Cn)||li["Ideographic Description Characters"](Cn)||li["Kangxi Radicals"](Cn)||li["Katakana Phonetic Extensions"](Cn)||li.Katakana(Cn)||li["Vertical Forms"](Cn)||li["Yi Radicals"](Cn)||li["Yi Syllables"](Cn)));(Y_[ci]||to||xi.imageName)&&kn.push(Ml(ai+1,Jn,Fn,kn,qu(ci,Dt.getCharCode(ai+1),to&&Vn),!1))}}var Cn;return Nf(Ml(Dt.length(),Jn,Fn,kn,0,!0))}(he,D,f,e,a,K),{processBidirectionalText:wt,processStyledBidirectionalText:lt}=O;if(wt&&1===he.sections.length){const Dt=wt(he.toString(),rt);for(const cn of Dt){const on=new Wu;on.text=cn,on.sections=he.sections;for(let En=0;En<cn.length;En++)on.sectionIndex.push(0);Re.push(on)}}else if(lt){const Dt=lt(he.text,he.sectionIndex,rt);for(const cn of Dt){const on=new Wu;on.text=cn[0],on.sectionIndex=cn[1],on.sections=he.sections,Re.push(on)}}else Re=function(Dt,cn){const on=[],En=Dt.text;let Hn=0;for(const fn of cn)on.push(Dt.substring(Hn,fn)),Hn=fn;return Hn<En.length&&on.push(Dt.substring(Hn,En.length)),on}(he,rt);const bt=[],Mt={positionedLines:bt,text:he.toString(),top:k[1],bottom:k[1],left:k[0],right:k[0],writingMode:z,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Dt,cn,on,En,Hn,fn,kn,Fn,Vn,Jn,Cn,ai){let xi=0,ci=0,to=0;const Kn="right"===Fn?1:"left"===Fn?0:.5;let Mi=!1;for(const no of Hn){const oo=no.getSections();for(const Zo of oo){if(Zo.imageName)continue;const cr=cn[Zo.fontStack];if(cr&&(Mi=void 0!==cr.ascender&&void 0!==cr.descender,!Mi))break}if(!Mi)break}let Wi=0;for(const no of Hn){no.trim();const oo=no.getMaxScale(),Zo=(oo-1)*As,cr={positionedGlyphs:[],lineOffset:0};Dt.positionedLines[Wi]=cr;const ur=cr.positionedGlyphs;let nr=0;if(!no.length()){ci+=fn,++Wi;continue}let Er=0,Dr=0;for(let $o=0;$o<no.length();$o++){const ts=no.getSection($o),$r=no.getSectionIndex($o),Lr=no.getCharCode($o);let So=ts.scale,Hr=null,ir=null,Qs=null,Gr=As,as=0;const ns=!(Vn===Ca.horizontal||!Cn&&!U(Lr)||Cn&&(rp[Lr]||(Io=Lr,li.Arabic(Io)||li["Arabic Supplement"](Io)||li["Arabic Extended-A"](Io)||li["Arabic Presentation Forms-A"](Io)||li["Arabic Presentation Forms-B"](Io))));if(ts.imageName){const $s=En[ts.imageName];if(!$s)continue;Qs=ts.imageName,Dt.iconsInText=Dt.iconsInText||!0,ir=$s.paddedRect;const ls=$s.displaySize;So=So*As/ai,Hr={width:ls[0],height:ls[1],left:js,top:-Lf,advance:ns?ls[1]:ls[0],localGlyph:!1},as=Mi?-Hr.height*So:kf+oo*As-ls[1]*So,Gr=Hr.advance;const hl=(ns?ls[0]:ls[1])*So-As*oo;hl>0&&hl>nr&&(nr=hl)}else{const $s=on[ts.fontStack];if(!$s)continue;$s[Lr]&&(ir=$s[Lr]);const ls=cn[ts.fontStack];if(!ls)continue;const hl=ls.glyphs[Lr];if(!hl)continue;if(Hr=hl.metrics,Gr=8203!==Lr?As:0,Mi){const ld=void 0!==ls.ascender?Math.abs(ls.ascender):0,cd=void 0!==ls.descender?Math.abs(ls.descender):0,du=(ld+cd)*So;Er<du&&(Er=du,Dr=(ld-cd)/2*So),as=-ld*So}else as=kf+(oo-So)*As}ns?(Dt.verticalizable=!0,ur.push({glyph:Lr,imageName:Qs,x:xi,y:ci+as,vertical:ns,scale:So,localGlyph:Hr.localGlyph,fontStack:ts.fontStack,sectionIndex:$r,metrics:Hr,rect:ir}),xi+=Gr*So+Jn):(ur.push({glyph:Lr,imageName:Qs,x:xi,y:ci+as,vertical:ns,scale:So,localGlyph:Hr.localGlyph,fontStack:ts.fontStack,sectionIndex:$r,metrics:Hr,rect:ir}),xi+=Hr.advance*So+Jn)}0!==ur.length&&(to=Math.max(xi-Jn,to),Mi?pg(ur,Kn,nr,Dr,fn*oo/2):pg(ur,Kn,nr,0,fn/2)),xi=0;const Rr=fn*oo+nr;cr.lineOffset=Math.max(nr,Zo),ci+=Rr,++Wi}var Io;const Yi=ci,{horizontalAlign:Ui,verticalAlign:Yo}=hg(kn);(function(no,oo,Zo,cr,ur,nr){const Er=(oo-Zo)*ur,Dr=-nr*cr;for(const Rr of no)for(const $o of Rr.positionedGlyphs)$o.x+=Er,$o.y+=Dr})(Dt.positionedLines,Kn,Ui,Yo,to,Yi),Dt.top+=-Yo*Yi,Dt.bottom=Dt.top+Yi,Dt.left+=-Ui*to,Dt.right=Dt.left+to,Dt.hasBaseline=Mi}(Mt,e,i,a,Re,_,b,E,z,D,j,te),!function(Dt){for(const cn of Dt)if(0!==cn.positionedGlyphs.length)return!1;return!0}(bt)&&Mt}const rp={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Y_={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function dg(t,e,i,a,u,f){if(e.imageName){const _=a[e.imageName];return _?_.displaySize[0]*e.scale*As/f+u:0}{const _=i[e.fontStack],b=_&&_.glyphs[t];return b?b.metrics.advance*e.scale+u:0}}function Bf(t,e,i,a){const u=Math.pow(t-e,2);return a?t<e?u/2:2*u:u+Math.abs(i)*i}function qu(t,e,i){let a=0;return 10===t&&(a-=1e4),i&&(a+=150),40!==t&&65288!==t||(a+=50),41!==e&&65289!==e||(a+=50),a}function Ml(t,e,i,a,u,f){let _=null,b=Bf(e,i,u,f);for(const E of a){const D=Bf(e-E.x,i,u,f)+E.badness;D<=b&&(_=E,b=D)}return{index:t,x:e,priorBreak:_,badness:b}}function Nf(t){return t?Nf(t.priorBreak).concat(t.index):[]}function hg(t){let e=.5,i=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":i=1;break;case"top":case"top-right":case"top-left":i=0}return{horizontalAlign:e,verticalAlign:i}}function pg(t,e,i,a,u){if(!(e||i||a||u))return;const f=t.length-1,_=t[f],b=(_.x+_.metrics.advance*_.scale)*e;for(let E=0;E<=f;E++)t[E].x-=b,t[E].y+=i+a+u}function Tv(t,e,i){const{horizontalAlign:a,verticalAlign:u}=hg(i),f=e[0]-t.displaySize[0]*a,_=e[1]-t.displaySize[1]*u;return{image:t,top:_,bottom:_+t.displaySize[1],left:f,right:f+t.displaySize[0]}}function J_(t,e,i,a,u,f){const _=t.image;let b;if(_.content){const Re=_.content,rt=_.pixelRatio||1;b=[Re[0]/rt,Re[1]/rt,_.displaySize[0]-Re[2]/rt,_.displaySize[1]-Re[3]/rt]}const E=e.left*f,D=e.right*f;let k,z,j,K;"width"===i||"both"===i?(K=u[0]+E-a[3],z=u[0]+D+a[1]):(K=u[0]+(E+D-_.displaySize[0])/2,z=K+_.displaySize[0]);const te=e.top*f,he=e.bottom*f;return"height"===i||"both"===i?(k=u[1]+te-a[0],j=u[1]+he+a[2]):(k=u[1]+(te+he-_.displaySize[1])/2,j=k+_.displaySize[1]),{image:_,top:k,right:z,bottom:j,left:K,collisionPadding:b}}class Il extends Ce{constructor(e,i,a,u,f){super(e,i),this.angle=u,this.z=a,void 0!==f&&(this.segment=f)}clone(){return new Il(this.x,this.y,this.z,this.angle,this.segment)}}function zf(t,e,i,a,u){if(void 0===e.segment)return!0;let f=e,_=e.segment+1,b=0;for(;b>-i/2;){if(_--,_<0)return!1;b-=t[_].dist(f),f=t[_]}b+=t[_].dist(t[_+1]),_++;const E=[];let D=0;for(;b<i/2;){const k=t[_],z=t[_+1];if(!z)return!1;let j=t[_-1].angleTo(k)-k.angleTo(z);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:b,angleDelta:j}),D+=j;b-E[0].distance>a;)D-=E.shift().angleDelta;if(D>u)return!1;_++,b+=k.dist(z)}return!0}function K_(t){let e=0;for(let i=0;i<t.length-1;i++)e+=t[i].dist(t[i+1]);return e}function Uf(t,e,i){return t?.6*e*i:0}function nh(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function fg(t,e,i,a,u,f){const _=Uf(i,u,f),b=nh(i,a)*f;let E=0;const D=K_(t)/2;for(let k=0;k<t.length-1;k++){const z=t[k],j=t[k+1],K=z.dist(j);if(E+K>D){const te=(D-E)/K,he=Xn(z.x,j.x,te),Re=Xn(z.y,j.y,te),rt=new Il(he,Re,0,j.angleTo(z),k);return!_||zf(t,rt,b,_,e)?rt:void 0}E+=K}}function mg(t,e,i,a,u,f,_,b,E){const D=Uf(a,f,_),k=nh(a,u),z=k*_,j=0===t[0].x||t[0].x===E||0===t[0].y||t[0].y===E;return e-z<e/4&&(e=z+e/4),Zf(t,j?e/2*b%e:(k/2+2*f)*_*b%e,e,D,i,z,j,!1,E)}function Zf(t,e,i,a,u,f,_,b,E){const D=f/2,k=K_(t);let z=0,j=e-i,K=[];for(let te=0;te<t.length-1;te++){const he=t[te],Re=t[te+1],rt=he.dist(Re),wt=Re.angleTo(he);for(;j+i<z+rt;){j+=i;const lt=(j-z)/rt,bt=Xn(he.x,Re.x,lt),Mt=Xn(he.y,Re.y,lt);if(bt>=0&&bt<E&&Mt>=0&&Mt<E&&j-D>=0&&j+D<=k){const Dt=new Il(bt,Mt,0,wt,te);Dt._round(),a&&!zf(t,Dt,f,a,u)||K.push(Dt)}}z+=rt}return b||K.length||_||(K=Zf(t,z/2,i,a,u,f,_,!0,E)),K}function go(t,e,i,a,u){const f=[];for(let _=0;_<t.length;_++){const b=t[_];let E;for(let D=0;D<b.length-1;D++){let k=b[D],z=b[D+1];k.x<e&&z.x<e||(k.x<e?k=new Ce(e,k.y+(e-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x<e&&(z=new Ce(e,k.y+(e-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y<i&&z.y<i||(k.y<i?k=new Ce(k.x+(i-k.y)/(z.y-k.y)*(z.x-k.x),i)._round():z.y<i&&(z=new Ce(k.x+(i-k.y)/(z.y-k.y)*(z.x-k.x),i)._round()),k.x>=a&&z.x>=a||(k.x>=a?k=new Ce(a,k.y+(a-k.x)/(z.x-k.x)*(z.y-k.y))._round():z.x>=a&&(z=new Ce(a,k.y+(a-k.x)/(z.x-k.x)*(z.y-k.y))._round()),k.y>=u&&z.y>=u||(k.y>=u?k=new Ce(k.x+(u-k.y)/(z.y-k.y)*(z.x-k.x),u)._round():z.y>=u&&(z=new Ce(k.x+(u-k.y)/(z.y-k.y)*(z.x-k.x),u)._round()),E&&k.equals(E[E.length-1])||(E=[k],f.push(E)),E.push(z)))))}}return f}di(Il,"Anchor");const Yu=1e20;function Vf(t,e,i,a,u,f,_,b,E){for(let D=e;D<e+a;D++)X_(t,i*f+D,f,u,_,b,E);for(let D=i;D<i+u;D++)X_(t,D*f+e,1,a,_,b,E)}function X_(t,e,i,a,u,f,_){f[0]=0,_[0]=-Yu,_[1]=Yu,u[0]=t[e];for(let b=1,E=0,D=0;b<a;b++){u[b]=t[e+b*i];const k=b*b;do{const z=f[E];D=(u[b]-u[z]+k-z*z)/(b-z)/2}while(D<=_[E]&&--E>-1);E++,f[E]=b,_[E]=D,_[E+1]=Yu}for(let b=0,E=0;b<a;b++){for(;_[E+1]<b;)E++;const D=f[E],k=b-D;t[e+b*i]=u[D]+k*k}}const cl=2,sp={none:0,ideographs:1,all:2};class Ju{constructor(e,i,a){this.requestManager=e,this.localGlyphMode=i,this.localFontFamily=a,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,i){const a=[];for(const u in e)for(const f of e[u])a.push({stack:u,id:f});gt(a,({stack:u,id:f},_)=>{let b=this.entries[u];b||(b=this.entries[u]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=b.glyphs[f];if(void 0!==E)return void _(null,{stack:u,id:f,glyph:E});if(E=this._tinySDF(b,u,f),E)return b.glyphs[f]=E,void _(null,{stack:u,id:f,glyph:E});const D=Math.floor(f/256);if(256*D>65535)return void _(new Error("glyphs > 65535 not supported"));if(b.ranges[D])return void _(null,{stack:u,id:f,glyph:E});let k=b.requests[D];k||(k=b.requests[D]=[],Ju.loadGlyphRange(u,D,this.url,this.requestManager,(z,j)=>{if(j){b.ascender=j.ascender,b.descender=j.descender;for(const K in j.glyphs)this._doesCharSupportLocalGlyph(+K)||(b.glyphs[+K]=j.glyphs[+K]);b.ranges[D]=!0}for(const K of k)K(z,j);delete b.requests[D]})),k.push((z,j)=>{z?_(z):j&&_(null,{stack:u,id:f,glyph:j.glyphs[f]||null})})},(u,f)=>{if(u)i(u);else if(f){const _={};for(const{stack:b,id:E,glyph:D}of f)void 0===_[b]&&(_[b]={}),void 0===_[b].glyphs&&(_[b].glyphs={}),_[b].glyphs[E]=D&&{id:D.id,bitmap:D.bitmap.clone(),metrics:D.metrics},_[b].ascender=this.entries[b].ascender,_[b].descender=this.entries[b].descender;i(null,_)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==sp.none&&(this.localGlyphMode===sp.all?!!this.localFontFamily:!!this.localFontFamily&&(li["CJK Unified Ideographs"](e)||li["Hangul Syllables"](e)||li.Hiragana(e)||li.Katakana(e)||li["CJK Symbols and Punctuation"](e)))}_tinySDF(e,i,a){const u=this.localFontFamily;if(!u||!this._doesCharSupportLocalGlyph(a))return;let f=e.tinySDF;if(!f){let he="400";/bold/i.test(i)?he="900":/medium/i.test(i)?he="500":/light/i.test(i)&&(he="200"),f=e.tinySDF=new Ju.TinySDF({fontFamily:u,fontWeight:he,fontSize:24*cl,buffer:3*cl,radius:8*cl}),f.fontWeight=he}if(this.localGlyphs[f.fontWeight][a])return this.localGlyphs[f.fontWeight][a];const _=String.fromCharCode(a),{data:b,width:E,height:D,glyphWidth:k,glyphHeight:z,glyphLeft:j,glyphTop:K,glyphAdvance:te}=f.draw(_);return this.localGlyphs[f.fontWeight][a]={id:a,bitmap:new Kl({width:E,height:D},b),metrics:{width:k/cl,height:z/cl,left:j/cl,top:K/cl-27,advance:te/cl,localGlyph:!0}}}}Ju.loadGlyphRange=function(t,e,i,a,u){const f=256*e,_=f+255,b=a.transformRequest(a.normalizeGlyphsURL(i).replace("{fontstack}",t).replace("{range}",`${f}-${_}`),oi.Glyphs);fi(b,(E,D)=>{if(E)u(E);else if(D){const k={},z=new ip(D).readFields(q_,{});for(const j of z.glyphs)k[j.id]=j;u(null,{glyphs:k,ascender:z.ascender,descender:z.descender})}})},Ju.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:i=8,cutoff:a=.25,fontFamily:u="sans-serif",fontWeight:f="normal",fontStyle:_="normal"}={}){this.buffer=e,this.cutoff=a,this.radius=i;const b=this.size=t+4*e,E=this._createCanvas(b),D=this.ctx=E.getContext("2d",{willReadFrequently:!0});D.font=`${_} ${f} ${t}px ${u}`,D.textBaseline="alphabetic",D.textAlign="left",D.fillStyle="black",this.gridOuter=new Float64Array(b*b),this.gridInner=new Float64Array(b*b),this.f=new Float64Array(b),this.z=new Float64Array(b+1),this.v=new Uint16Array(b)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a,actualBoundingBoxLeft:u,actualBoundingBoxRight:f}=this.ctx.measureText(t),_=Math.ceil(i),b=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(f-u))),E=Math.min(this.size-this.buffer,_+Math.ceil(a)),D=b+2*this.buffer,k=E+2*this.buffer,z=Math.max(D*k,0),j=new Uint8ClampedArray(z),K={data:j,width:D,height:k,glyphWidth:b,glyphHeight:E,glyphTop:_,glyphLeft:0,glyphAdvance:e};if(0===b||0===E)return K;const{ctx:te,buffer:he,gridInner:Re,gridOuter:rt}=this;te.clearRect(he,he,b,E),te.fillText(t,he,he+_);const wt=te.getImageData(he,he,b,E);rt.fill(Yu,0,z),Re.fill(0,0,z);for(let lt=0;lt<E;lt++)for(let bt=0;bt<b;bt++){const Mt=wt.data[4*(lt*b+bt)+3]/255;if(0===Mt)continue;const Dt=(lt+he)*D+bt+he;if(1===Mt)rt[Dt]=0,Re[Dt]=Yu;else{const cn=.5-Mt;rt[Dt]=cn>0?cn*cn:0,Re[Dt]=cn<0?cn*cn:0}}Vf(rt,0,0,D,k,D,this.f,this.v,this.z),Vf(Re,he,he,b,E,D,this.f,this.v,this.z);for(let lt=0;lt<z;lt++){const bt=Math.sqrt(rt[lt])-Math.sqrt(Re[lt]);j[lt]=Math.round(255-255*(bt/this.radius+this.cutoff))}return K}};const Ku=js;function jf(t,e,i,a){const u=[],f=t.image,_=f.pixelRatio,b=f.paddedRect.w-2*Ku,E=f.paddedRect.h-2*Ku,D=t.right-t.left,k=t.bottom-t.top,z=f.stretchX||[[0,b]],j=f.stretchY||[[0,E]],K=(fn,kn)=>fn+kn[1]-kn[0],te=z.reduce(K,0),he=j.reduce(K,0),Re=b-te,rt=E-he;let wt=0,lt=te,bt=0,Mt=he,Dt=0,cn=Re,on=0,En=rt;if(f.content&&a){const fn=f.content;wt=ap(z,0,fn[0]),bt=ap(j,0,fn[1]),lt=ap(z,fn[0],fn[2]),Mt=ap(j,fn[1],fn[3]),Dt=fn[0]-wt,on=fn[1]-bt,cn=fn[2]-fn[0]-lt,En=fn[3]-fn[1]-Mt}const Hn=(fn,kn,Fn,Vn)=>{const Jn=lp(fn.stretch-wt,lt,D,t.left),Cn=cp(fn.fixed-Dt,cn,fn.stretch,te),ai=lp(kn.stretch-bt,Mt,k,t.top),xi=cp(kn.fixed-on,En,kn.stretch,he),ci=lp(Fn.stretch-wt,lt,D,t.left),to=cp(Fn.fixed-Dt,cn,Fn.stretch,te),Kn=lp(Vn.stretch-bt,Mt,k,t.top),Mi=cp(Vn.fixed-on,En,Vn.stretch,he),Wi=new Ce(Jn,ai),Io=new Ce(ci,ai),Yi=new Ce(ci,Kn),Ui=new Ce(Jn,Kn),Yo=new Ce(Cn/_,xi/_),no=new Ce(to/_,Mi/_),oo=e*Math.PI/180;if(oo){const ur=Math.sin(oo),nr=Math.cos(oo),Er=[nr,-ur,ur,nr];Wi._matMult(Er),Io._matMult(Er),Ui._matMult(Er),Yi._matMult(Er)}const Zo=fn.stretch+fn.fixed,cr=kn.stretch+kn.fixed;return{tl:Wi,tr:Io,bl:Ui,br:Yi,tex:{x:f.paddedRect.x+Ku+Zo,y:f.paddedRect.y+Ku+cr,w:Fn.stretch+Fn.fixed-Zo,h:Vn.stretch+Vn.fixed-cr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Yo,pixelOffsetBR:no,minFontScaleX:cn/_/D,minFontScaleY:En/_/k,isSDF:i}};if(a&&(f.stretchX||f.stretchY)){const fn=$f(z,Re,te),kn=$f(j,rt,he);for(let Fn=0;Fn<fn.length-1;Fn++){const Vn=fn[Fn],Jn=fn[Fn+1];for(let Cn=0;Cn<kn.length-1;Cn++)u.push(Hn(Vn,kn[Cn],Jn,kn[Cn+1]))}}else u.push(Hn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:b+1},{fixed:0,stretch:E+1}));return u}function ap(t,e,i){let a=0;for(const u of t)a+=Math.max(e,Math.min(i,u[1]))-Math.max(e,Math.min(i,u[0]));return a}function $f(t,e,i){const a=[{fixed:-Ku,stretch:0}];for(const[u,f]of t){const _=a[a.length-1];a.push({fixed:u-_.stretch,stretch:_.stretch}),a.push({fixed:u-_.stretch,stretch:_.stretch+(f-u)})}return a.push({fixed:e+Ku,stretch:i}),a}function lp(t,e,i,a){return t/e*i+a}function cp(t,e,i,a){return t-e*i/a}function Cv(t,e,i,a){const u=e+t.positionedLines[a].lineOffset;return 0===a?i+u/2:i+(u+(e+t.positionedLines[a-1].lineOffset))/2}class gg{constructor(e=[],i=_g){if(this.data=e,this.length=this.data.length,this.compare=i,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],i=this.data.pop();return this.length--,this.length>0&&(this.data[0]=i,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:i,compare:a}=this,u=i[e];for(;e>0;){const f=e-1>>1,_=i[f];if(a(u,_)>=0)break;i[e]=_,e=f}i[e]=u}_down(e){const{data:i,compare:a}=this,u=this.length>>1,f=i[e];for(;e<u;){let _=1+(e<<1),b=i[_];const E=_+1;if(E<this.length&&a(i[E],b)<0&&(_=E,b=i[E]),a(b,f)>=0)break;i[e]=b,e=_}i[e]=f}}function _g(t,e){return t<e?-1:t>e?1:0}function Ec(t,e=1,i=!1){let a=1/0,u=1/0,f=-1/0,_=-1/0;const b=t[0];for(let K=0;K<b.length;K++){const te=b[K];(!K||te.x<a)&&(a=te.x),(!K||te.y<u)&&(u=te.y),(!K||te.x>f)&&(f=te.x),(!K||te.y>_)&&(_=te.y)}const E=Math.min(f-a,_-u);let D=E/2;const k=new gg([],Xu);if(0===E)return new Ce(a,u);for(let K=a;K<f;K+=E)for(let te=u;te<_;te+=E)k.push(new lu(K+D,te+D,D,t));let z=function(K){let te=0,he=0,Re=0;const rt=K[0];for(let wt=0,lt=rt.length,bt=lt-1;wt<lt;bt=wt++){const Mt=rt[wt],Dt=rt[bt],cn=Mt.x*Dt.y-Dt.x*Mt.y;he+=(Mt.x+Dt.x)*cn,Re+=(Mt.y+Dt.y)*cn,te+=3*cn}return new lu(he/te,Re/te,0,K)}(t),j=k.length;for(;k.length;){const K=k.pop();(K.d>z.d||!z.d)&&(z=K,i&&console.log("found best %d after %d probes",Math.round(1e4*K.d)/1e4,j)),K.max-z.d<=e||(D=K.h/2,k.push(new lu(K.p.x-D,K.p.y-D,D,t)),k.push(new lu(K.p.x+D,K.p.y-D,D,t)),k.push(new lu(K.p.x-D,K.p.y+D,D,t)),k.push(new lu(K.p.x+D,K.p.y+D,D,t)),j+=4)}return i&&(console.log(`num probes: ${j}`),console.log(`best distance: ${z.d}`)),z.p}function Xu(t,e){return e.max-t.max}class lu{constructor(e,i,a,u){this.p=new Ce(e,i),this.h=a,this.d=function(f,_){let b=!1,E=1/0;for(let D=0;D<_.length;D++){const k=_[D];for(let z=0,j=k.length,K=j-1;z<j;K=z++){const te=k[z],he=k[K];te.y>f.y!=he.y>f.y&&f.x<(he.x-te.x)*(f.y-te.y)/(he.y-te.y)+te.x&&(b=!b),E=Math.min(E,hf(f,te,he))}}return(b?1:-1)*Math.sqrt(E)}(this.p,u),this.max=this.d+this.h*Math.SQRT2}}const Qu=7,ed=Number.POSITIVE_INFINITY,td=Math.sqrt(2);function up(t,[e,i]){let a=0,u=0;if(i===ed){e<0&&(e=0);const f=e/td;switch(t){case"top-right":case"top-left":u=f-Qu;break;case"bottom-right":case"bottom-left":u=-f+Qu;break;case"bottom":u=-e+Qu;break;case"top":u=e-Qu}switch(t){case"top-right":case"bottom-right":a=-f;break;case"top-left":case"bottom-left":a=f;break;case"left":a=e;break;case"right":a=-e}}else{switch(e=Math.abs(e),i=Math.abs(i),t){case"top-right":case"top-left":case"top":u=i-Qu;break;case"bottom-right":case"bottom-left":case"bottom":u=-i+Qu}switch(t){case"top-right":case"bottom-right":case"right":a=-e;break;case"top-left":case"bottom-left":case"left":a=e}}return[a,u]}function ih(t,e,i,a,u,f,_,b,E,D){t.createArrays(),t.tilePixelRatio=Li/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const k=t.layers[0].layout,z=t.layers[0]._unevaluatedLayout._values,j={};if("composite"===t.textSizeData.kind){const{minZoom:he,maxZoom:Re}=t.textSizeData;j.compositeTextSizes=[z["text-size"].possiblyEvaluate(new N(he),b),z["text-size"].possiblyEvaluate(new N(Re),b)]}if("composite"===t.iconSizeData.kind){const{minZoom:he,maxZoom:Re}=t.iconSizeData;j.compositeIconSizes=[z["icon-size"].possiblyEvaluate(new N(he),b),z["icon-size"].possiblyEvaluate(new N(Re),b)]}j.layoutTextSize=z["text-size"].possiblyEvaluate(new N(E+1),b),j.layoutIconSize=z["icon-size"].possiblyEvaluate(new N(E+1),b),j.textMaxSize=z["text-size"].possiblyEvaluate(new N(18),b);const K="map"===k.get("text-rotation-alignment")&&"point"!==k.get("symbol-placement"),te=k.get("text-size");for(const he of t.features){const Re=k.get("text-font").evaluate(he,{},b).join(","),rt=te.evaluate(he,{},b),wt=j.layoutTextSize.evaluate(he,{},b),lt=(j.layoutIconSize.evaluate(he,{},b),{horizontal:{},vertical:void 0}),bt=he.text;let Mt,Dt=[0,0];if(bt){const En=bt.toString(),Hn=k.get("text-letter-spacing").evaluate(he,{},b)*As,fn=k.get("text-line-height").evaluate(he,{},b)*As,kn=B(En)?Hn:0,Fn=k.get("text-anchor").evaluate(he,{},b),Vn=k.get("text-variable-anchor");if(!Vn){const ci=k.get("text-radial-offset").evaluate(he,{},b);Dt=ci?up(Fn,[ci*As,ed]):k.get("text-offset").evaluate(he,{},b).map(to=>to*As)}let Jn=K?"center":k.get("text-justify").evaluate(he,{},b);const Cn="point"===k.get("symbol-placement"),ai=Cn?k.get("text-max-width").evaluate(he,{},b)*As:1/0,xi=ci=>{t.allowVerticalPlacement&&L(En)&&(lt.vertical=Ff(bt,e,i,u,Re,ai,fn,Fn,ci,kn,Dt,Ca.vertical,!0,wt,rt))};if(!K&&Vn){const ci="auto"===Jn?Vn.map(Kn=>dp(Kn)):[Jn];let to=!1;for(let Kn=0;Kn<ci.length;Kn++){const Mi=ci[Kn];if(!lt.horizontal[Mi])if(to)lt.horizontal[Mi]=lt.horizontal[0];else{const Wi=Ff(bt,e,i,u,Re,ai,fn,"center",Mi,kn,Dt,Ca.horizontal,!1,wt,rt);Wi&&(lt.horizontal[Mi]=Wi,to=1===Wi.positionedLines.length)}}xi("left")}else{if("auto"===Jn&&(Jn=dp(Fn)),Cn||k.get("text-writing-mode").indexOf("horizontal")>=0||!L(En)){const ci=Ff(bt,e,i,u,Re,ai,fn,Fn,Jn,kn,Dt,Ca.horizontal,!1,wt,rt);ci&&(lt.horizontal[Jn]=ci)}xi(Cn?"left":Jn)}}let cn=!1;if(he.icon&&he.icon.name){const En=a[he.icon.name];En&&(Mt=Tv(u[he.icon.name],k.get("icon-offset").evaluate(he,{},b),k.get("icon-anchor").evaluate(he,{},b)),cn=En.sdf,void 0===t.sdfIcons?t.sdfIcons=En.sdf:t.sdfIcons!==En.sdf&&It("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(En.pixelRatio!==t.pixelRatio||0!==k.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const on=hp(lt.horizontal)||lt.vertical;t.iconsInText||(t.iconsInText=!!on&&on.iconsInText),(on||Mt)&&Hf(t,he,lt,Mt,a,j,wt,0,Dt,cn,_,b,D)}f&&t.generateCollisionDebugBuffers(E,t.collisionBoxArray)}function dp(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function Hf(t,e,i,a,u,f,_,b,E,D,k,z,j){let K=f.textMaxSize.evaluate(e,{},z);void 0===K&&(K=_);const te=t.layers[0].layout,he=te.get("icon-offset").evaluate(e,{},z),Re=hp(i.horizontal)||i.vertical,rt="globe"===j.name,wt=As,lt=_/wt,bt=t.tilePixelRatio*K/wt,Mt=(Fn=t.overscaling,t.zoom>18&&Fn>2&&(Fn>>=1),Math.max(Li/(512*Fn),1)*te.get("symbol-spacing")),Dt=te.get("text-padding")*t.tilePixelRatio,cn=te.get("icon-padding")*t.tilePixelRatio,on=Ee(te.get("text-max-angle")),En="map"===te.get("text-rotation-alignment")&&"point"!==te.get("symbol-placement"),Hn="map"===te.get("icon-rotation-alignment")&&"point"!==te.get("symbol-placement"),fn=te.get("symbol-placement"),kn=Mt/2;var Fn;const Vn=te.get("icon-text-fit");let Jn;a&&"none"!==Vn&&(t.allowVerticalPlacement&&i.vertical&&(Jn=J_(a,i.vertical,Vn,te.get("icon-text-fit-padding"),he,lt)),Re&&(a=J_(a,Re,Vn,te.get("icon-text-fit-padding"),he,lt)));const Cn=(ai,xi,ci)=>{if(xi.x<0||xi.x>=Li||xi.y<0||xi.y>=Li)return;let to=null;if(rt){const{x:Kn,y:Mi,z:Wi}=j.projectTilePoint(xi.x,xi.y,ci);to={anchor:new Il(Kn,Mi,Wi,0,void 0),up:j.upVector(ci,xi.x,xi.y)}}!function(Kn,Mi,Wi,Io,Yi,Ui,Yo,no,oo,Zo,cr,ur,nr,Er,Dr,Rr,$o,ts,$r,Lr,So,Hr,ir,Qs,Gr){const as=Kn.addToLineVertexArray(Mi,Io);let ns,$s,ls,hl,ld,cd,du,Mp=0,jg=0,hh=0,ph=0,fh=-1,Ip=-1;const Ol={};let $g=Up("");const hu=Wi?Wi.anchor:Mi;let ud=0,dd=0;if(void 0===oo._unevaluatedLayout.getValue("text-radial-offset")?[ud,dd]=oo.layout.get("text-offset").evaluate(So,{},Gr).map(Ea=>Ea*As):(ud=oo.layout.get("text-radial-offset").evaluate(So,{},Gr)*As,dd=ed),Kn.allowVerticalPlacement&&Yi.vertical){const Ea=Yi.vertical;if(Dr)cd=Wf(Ea),no&&(du=Wf(no));else{const ca=oo.layout.get("text-rotate").evaluate(So,{},Gr)+90;ls=pp(Zo,hu,Mi,cr,ur,nr,Ea,Er,ca,Rr),no&&(hl=pp(Zo,hu,Mi,cr,ur,nr,no,ts,ca))}}if(Ui){const Ea=oo.layout.get("icon-rotate").evaluate(So,{},Gr),ca="none"!==oo.layout.get("icon-text-fit"),pu=jf(Ui,Ea,ir,ca),Sp=no?jf(no,Ea,ir,ca):void 0;$s=pp(Zo,hu,Mi,cr,ur,nr,Ui,ts,Ea),Mp=4*pu.length;const Pp=Kn.iconSizeData;let Pc=null;"source"===Pp.kind?(Pc=[Oa*oo.layout.get("icon-size").evaluate(So,{},Gr)],Pc[0]>Al&&It(`${Kn.layerIds[0]}: Value for "icon-size" is >= ${cu}. Reduce your "icon-size".`)):"composite"===Pp.kind&&(Pc=[Oa*Hr.compositeIconSizes[0].evaluate(So,{},Gr),Oa*Hr.compositeIconSizes[1].evaluate(So,{},Gr)],(Pc[0]>Al||Pc[1]>Al)&&It(`${Kn.layerIds[0]}: Value for "icon-size" is >= ${cu}. Reduce your "icon-size".`)),Kn.addSymbols(Kn.icon,pu,Pc,Lr,$r,So,!1,Wi,Mi,as.lineStartIndex,as.lineLength,-1,Qs,Gr),fh=Kn.icon.placedSymbolArray.length-1,Sp&&(jg=4*Sp.length,Kn.addSymbols(Kn.icon,Sp,Pc,Lr,$r,So,Ca.vertical,Wi,Mi,as.lineStartIndex,as.lineLength,-1,Qs,Gr),Ip=Kn.icon.placedSymbolArray.length-1)}for(const Ea in Yi.horizontal){const ca=Yi.horizontal[Ea];ns||($g=Up(ca.text),Dr?ld=Wf(ca):ns=pp(Zo,hu,Mi,cr,ur,nr,ca,Er,oo.layout.get("text-rotate").evaluate(So,{},Gr),Rr));const pu=1===ca.positionedLines.length;if(hh+=Gf(Kn,Wi,Mi,ca,Yo,oo,Dr,So,Rr,as,Yi.vertical?Ca.horizontal:Ca.horizontalOnly,pu?Object.keys(Yi.horizontal):[Ea],Ol,fh,Hr,Qs,Gr),pu)break}Yi.vertical&&(ph+=Gf(Kn,Wi,Mi,Yi.vertical,Yo,oo,Dr,So,Rr,as,Ca.vertical,["vertical"],Ol,Ip,Hr,Qs,Gr));let Rl=-1;const Ap=(Ea,ca)=>Ea?Math.max(Ea,ca):ca;Rl=Ap(ld,Rl),Rl=Ap(cd,Rl),Rl=Ap(du,Rl);const my=Rl>-1?1:0;Kn.glyphOffsetArray.length>=Mc.MAX_GLYPHS&&It("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==So.sortKey&&Kn.addToSortKeyRanges(Kn.symbolInstances.length,So.sortKey),Kn.symbolInstances.emplaceBack(hu.x,hu.y,hu.z,Mi.x,Mi.y,Ol.right>=0?Ol.right:-1,Ol.center>=0?Ol.center:-1,Ol.left>=0?Ol.left:-1,Ol.vertical>=0?Ol.vertical:-1,fh,Ip,$g,void 0!==ns?ns:Kn.collisionBoxArray.length,void 0!==ns?ns+1:Kn.collisionBoxArray.length,void 0!==ls?ls:Kn.collisionBoxArray.length,void 0!==ls?ls+1:Kn.collisionBoxArray.length,void 0!==$s?$s:Kn.collisionBoxArray.length,void 0!==$s?$s+1:Kn.collisionBoxArray.length,hl||Kn.collisionBoxArray.length,hl?hl+1:Kn.collisionBoxArray.length,cr,hh,ph,Mp,jg,my,0,ud,dd,Rl)}(t,xi,to,ai,i,a,u,Jn,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Dt,En,E,0,cn,Hn,he,e,f,D,k,z)};if("line"===fn)for(const ai of go(e.geometry,0,0,Li,Li)){const xi=mg(ai,Mt,on,i.vertical||Re,a,wt,bt,t.overscaling,Li);for(const ci of xi)Re&&Q_(t,Re.text,kn,ci)||Cn(ai,ci,z)}else if("line-center"===fn){for(const ai of e.geometry)if(ai.length>1){const xi=fg(ai,on,i.vertical||Re,a,wt,bt);xi&&Cn(ai,xi,z)}}else if("Polygon"===e.type)for(const ai of Tf(e.geometry,0)){const xi=Ec(ai,16);Cn(ai[0],new Il(xi.x,xi.y,0,0,void 0),z)}else if("LineString"===e.type)for(const ai of e.geometry)Cn(ai,new Il(ai[0].x,ai[0].y,0,0,void 0),z);else if("Point"===e.type)for(const ai of e.geometry)for(const xi of ai)Cn([xi],new Il(xi.x,xi.y,0,0,void 0),z)}const cu=255,Al=cu*Oa;function Gf(t,e,i,a,u,f,_,b,E,D,k,z,j,K,te,he,Re){const rt=function(bt,Mt,Dt,cn,on,En,Hn,fn){const kn=[];if(0===Mt.positionedLines.length)return kn;const Fn=cn.layout.get("text-rotate").evaluate(En,{})*Math.PI/180,Vn=function(ci){const to=ci[0],Kn=ci[1],Mi=to*Kn;return Mi>0?[to,-Kn]:Mi<0?[-to,Kn]:0===to?[Kn,to]:[Kn,-to]}(Dt);let Jn=Math.abs(Mt.top-Mt.bottom);for(const ci of Mt.positionedLines)Jn-=ci.lineOffset;const Cn=Mt.positionedLines.length,ai=Jn/Cn;let xi=Mt.top-Dt[1];for(let ci=0;ci<Cn;++ci){const to=Mt.positionedLines[ci];xi=Cv(Mt,ai,xi,ci);for(const Kn of to.positionedGlyphs){if(!Kn.rect)continue;const Mi=Kn.rect||{};let Wi=Lf+1,Io=!0,Yi=1,Ui=0;if(Kn.imageName){const ir=Hn[Kn.imageName];if(!ir)continue;if(ir.sdf){It("SDF images are not supported in formatted text and will be ignored.");continue}Io=!1,Yi=ir.pixelRatio,Wi=js/Yi}const Yo=(on||fn)&&Kn.vertical,no=Kn.metrics.advance*Kn.scale/2,oo=Kn.metrics,Zo=Kn.rect;if(null===Zo)continue;fn&&Mt.verticalizable&&(Ui=Kn.imageName?no-Kn.metrics.width*Kn.scale/2:0);const cr=on?[Kn.x+no,Kn.y]:[0,0];let ur=[0,0],nr=[0,0],Er=!1;on||(Yo?(nr=[Kn.x+no+Vn[0],Kn.y+Vn[1]-Ui],Er=!0):ur=[Kn.x+no+Dt[0],Kn.y+Dt[1]-Ui]);const Dr=Zo.w*Kn.scale/(Yi*(Kn.localGlyph?cl:1)),Rr=Zo.h*Kn.scale/(Yi*(Kn.localGlyph?cl:1));let $o,ts,$r,Lr;if(Yo){const ir=Kn.y-xi,Qs=new Ce(-no,no-ir),Gr=-Math.PI/2,as=new Ce(...nr);$o=new Ce(-no+ur[0],ur[1]),$o._rotateAround(Gr,Qs)._add(as),$o.x+=-ir+no,$o.y-=(oo.left-Wi)*Kn.scale;const ns=Kn.imageName?oo.advance*Kn.scale:As*Kn.scale,$s=String.fromCharCode(Kn.glyph);Z_($s)?$o.x+=(1-Wi)*Kn.scale:V_($s)?$o.x+=ns-oo.height*Kn.scale+(-Wi-1)*Kn.scale:$o.x+=Kn.imageName||oo.width+2*Wi===Zo.w&&oo.height+2*Wi===Zo.h?(ns-Rr)/2:(ns-(oo.height+2*Wi)*Kn.scale)/2,ts=new Ce($o.x,$o.y-Dr),$r=new Ce($o.x+Rr,$o.y),Lr=new Ce($o.x+Rr,$o.y-Dr)}else{const ir=(oo.left-Wi)*Kn.scale-no+ur[0],Qs=(-oo.top-Wi)*Kn.scale+ur[1],Gr=ir+Dr,as=Qs+Rr;$o=new Ce(ir,Qs),ts=new Ce(Gr,Qs),$r=new Ce(ir,as),Lr=new Ce(Gr,as)}if(Fn){let ir;ir=on?new Ce(0,0):Er?new Ce(Vn[0],Vn[1]):new Ce(Dt[0],Dt[1]),$o._rotateAround(Fn,ir),ts._rotateAround(Fn,ir),$r._rotateAround(Fn,ir),Lr._rotateAround(Fn,ir)}const So=new Ce(0,0),Hr=new Ce(0,0);kn.push({tl:$o,tr:ts,bl:$r,br:Lr,tex:Mi,writingMode:Mt.writingMode,glyphOffset:cr,sectionIndex:Kn.sectionIndex,isSDF:Io,pixelOffsetTL:So,pixelOffsetBR:Hr,minFontScaleX:0,minFontScaleY:0})}}return kn}(0,a,E,f,_,b,u,t.allowVerticalPlacement),wt=t.textSizeData;let lt=null;"source"===wt.kind?(lt=[Oa*f.layout.get("text-size").evaluate(b,{},Re)],lt[0]>Al&&It(`${t.layerIds[0]}: Value for "text-size" is >= ${cu}. Reduce your "text-size".`)):"composite"===wt.kind&&(lt=[Oa*te.compositeTextSizes[0].evaluate(b,{},Re),Oa*te.compositeTextSizes[1].evaluate(b,{},Re)],(lt[0]>Al||lt[1]>Al)&&It(`${t.layerIds[0]}: Value for "text-size" is >= ${cu}. Reduce your "text-size".`)),t.addSymbols(t.text,rt,lt,E,_,b,k,e,i,D.lineStartIndex,D.lineLength,K,he,Re);for(const bt of z)j[bt]=t.text.placedSymbolArray.length-1;return 4*rt.length}function hp(t){for(const e in t)return t[e];return null}function pp(t,e,i,a,u,f,_,b,E,D){let k=_.top,z=_.bottom,j=_.left,K=_.right;const te=_.collisionPadding;if(te&&(j-=te[0],k-=te[1],K+=te[2],z+=te[3]),E){const he=new Ce(j,k),Re=new Ce(K,k),rt=new Ce(j,z),wt=new Ce(K,z),lt=Ee(E);let bt=new Ce(0,0);D&&(bt=new Ce(D[0],D[1])),he._rotateAround(lt,bt),Re._rotateAround(lt,bt),rt._rotateAround(lt,bt),wt._rotateAround(lt,bt),j=Math.min(he.x,Re.x,rt.x,wt.x),K=Math.max(he.x,Re.x,rt.x,wt.x),k=Math.min(he.y,Re.y,rt.y,wt.y),z=Math.max(he.y,Re.y,rt.y,wt.y)}return t.emplaceBack(e.x,e.y,e.z,i.x,i.y,j,k,K,z,b,a,u,f),t.length-1}function Wf(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Q_(t,e,i,a){const u=t.compareText;if(e in u){const f=u[e];for(let _=f.length-1;_>=0;_--)if(a.dist(f[_])<i)return!0}else u[e]=[];return u[e].push(a),!1}function qf(t,e){const i=t.fovAboveCenter,a=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,u=(t._camera.position[2]*t.worldSize-a)/Math.cos(t._pitch),f=Math.sin(i)*u/Math.sin(Math.max(Math.PI/2-t._pitch-i,.01)),_=Math.sin(t._pitch)*f+u;return Math.min(1.01*_,u*(1/t._horizonShift))}function uu(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const i=Math.pow(2,-t.z),a=t.x*i,u=(t.x+1)*i,f=t.y*i,_=(t.y+1)*i,b=wa(a),E=wa(u),D=vs(f),k=vs(_),z=e.project(b,D),j=e.project(E,D),K=e.project(E,k),te=e.project(b,k);let he=Math.min(z.x,j.x,K.x,te.x),Re=Math.min(z.y,j.y,K.y,te.y),rt=Math.max(z.x,j.x,K.x,te.x),wt=Math.max(z.y,j.y,K.y,te.y);const lt=i/16;function bt(Dt,cn,on,En,Hn,fn){const kn=(on+Hn)/2,Fn=(En+fn)/2,Vn=e.project(wa(kn),vs(Fn)),Jn=Math.max(0,he-Vn.x,Re-Vn.y,Vn.x-rt,Vn.y-wt);he=Math.min(he,Vn.x),rt=Math.max(rt,Vn.x),Re=Math.min(Re,Vn.y),wt=Math.max(wt,Vn.y),Jn>lt&&(bt(Dt,Vn,on,En,kn,Fn),bt(Vn,cn,kn,Fn,Hn,fn))}bt(z,j,a,f,u,f),bt(j,K,u,f,u,_),bt(K,te,u,_,a,_),bt(te,z,a,_,a,f),he-=lt,Re-=lt,rt+=lt,wt+=lt;const Mt=1/Math.max(rt-he,wt-Re);return{scale:Mt,x:he*Mt,y:Re*Mt,x2:rt*Mt,y2:wt*Mt,projection:e}}const ey=ol(new Float32Array(16));class Dc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,i){return{x:0,y:0,z:0}}unproject(e,i){return new tr(0,0)}projectTilePoint(e,i,a){return{x:e,y:i,z:0}}locationPoint(e,i,a=!0){return e._coordinatePoint(e.locationCoordinate(i),a)}pixelsPerMeter(e,i){return Zs(1,e)*i}pixelSpaceConversion(e,i,a){return 1}farthestPixelDistance(e){return qf(e,e.pixelsPerMeter)}pointCoordinate(e,i,a,u){const f=e.horizonLineFromTop(!1),_=new Ce(i,Math.max(f,a));return e.rayIntersectionCoordinate(e.pointRayIntersection(_,u))}pointCoordinate3D(e,i,a){const u=new Ce(i,a);if(e.elevation)return e.elevation.pointCoordinate(u);{const f=this.pointCoordinate(e,u.x,u.y,0);return[f.x,f.y,f.z]}}isPointAboveHorizon(e,i){if(e.elevation)return!this.pointCoordinate3D(e,i.x,i.y);const a=e.horizonLineFromTop();return i.y<a}createInversionMatrix(e,i){return ey}createTileMatrix(e,i,a){let u,f,_;const b=a.canonical,E=ol(new Float64Array(16));if(this.isReprojectedInTileSpace){const D=uu(b,this);u=1,f=D.x+a.wrap*D.scale,_=D.y,Kc(E,E,[u/D.scale,u/D.scale,e.pixelsPerMeter/i])}else u=i/e.zoomScale(b.z),f=(b.x+Math.pow(2,b.z)*a.wrap)*u,_=b.y*u;return Eu(E,E,[f,_,0]),Kc(E,E,[u/Li,u/Li,1]),E}upVector(e,i,a){return[0,0,1]}upVectorScale(e,i,a){return{metersToTile:1}}}class ty extends Dc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[i,a]=this.parallels=e.parallels||[29.5,45.5],u=Math.sin(Ee(i));this.n=(u+Math.sin(Ee(a)))/2,this.c=1+u*(2*this.n-u),this.r0=Math.sqrt(this.c)/this.n}project(e,i){const{n:a,c:u,r0:f}=this,_=Ee(e-this.center[0]),b=Ee(i),E=Math.sqrt(u-2*a*Math.sin(b))/a;return{x:E*Math.sin(_*a),y:E*Math.cos(_*a)-f,z:0}}unproject(e,i){const{n:a,c:u,r0:f}=this,_=f+i;let b=Math.atan2(e,Math.abs(_))*Math.sign(_);_*a<0&&(b-=Math.PI*Math.sign(e)*Math.sign(_));const E=Ee(this.center[0])*a;b=dt(b,-Math.PI-E,Math.PI-E);const D=ye(ae(b/a)+this.center[0],-180,180),k=Math.asin(ye((u-(e*e+_*_)*a*a)/(2*a),-1,1)),z=ye(ae(k),-Vs,Vs);return new tr(D,z)}}const nd=1.340264,id=-.081106,oh=893e-6,rh=.003796,Xs=Math.sqrt(3)/2;class ny extends Dc{project(e,i){i=i/180*Math.PI,e=e/180*Math.PI;const a=Math.asin(Xs*Math.sin(i)),u=a*a,f=u*u*u;return{x:.5*(e*Math.cos(a)/(Xs*(nd+3*id*u+f*(7*oh+9*rh*u)))/Math.PI+.5),y:1-.5*(a*(nd+id*u+f*(oh+rh*u))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,u=a*a,f=u*u*u;for(let k,z,j,K=0;K<12&&(z=a*(nd+id*u+f*(oh+rh*u))-i,j=nd+3*id*u+f*(7*oh+9*rh*u),k=z/j,a=ye(a-k,-Math.PI/3,Math.PI/3),u=a*a,f=u*u*u,!(Math.abs(k)<1e-12));++K);const _=Xs*e*(nd+3*id*u+f*(7*oh+9*rh*u))/Math.cos(a),b=Math.asin(Math.sin(a)/Xs),E=ye(180*_/Math.PI,-180,180),D=ye(180*b/Math.PI,-Vs,Vs);return new tr(E,D)}}class iy extends Dc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){return{x:.5+e/360,y:.5-i/360,z:0}}unproject(e,i){const a=360*(e-.5),u=ye(360*(.5-i),-Vs,Vs);return new tr(a,u)}}const sh=Math.PI/2;function od(t){return Math.tan((sh+t)/2)}class yg extends Dc{constructor(e){super(e),this.center=e.center||[0,30];const[i,a]=this.parallels=e.parallels||[30,30];let u=Ee(i),f=Ee(a);this.southernCenter=u+f<0,this.southernCenter&&(u=-u,f=-f);const _=Math.cos(u),b=od(u);this.n=u===f?Math.sin(u):Math.log(_/Math.cos(f))/Math.log(od(f)/b),this.f=_*Math.pow(od(u),this.n)/this.n}project(e,i){i=Ee(i),this.southernCenter&&(i=-i),e=Ee(e-this.center[0]);const a=1e-6,{n:u,f}=this;f>0?i<-sh+a&&(i=-sh+a):i>sh-a&&(i=sh-a);const _=f/Math.pow(od(i),u);let b=_*Math.sin(u*e),E=f-_*Math.cos(u*e);return b=.5*(b/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:b,y:this.southernCenter?E:1-E,z:0}}unproject(e,i){e=(2*e-.5)*Math.PI,this.southernCenter&&(i=1-i),i=(2*(1-i)-.5)*Math.PI;const{n:a,f:u}=this,f=u-i,_=Math.sign(f),b=Math.sign(a)*Math.sqrt(e*e+f*f);let E=Math.atan2(e,Math.abs(f))*_;f*a<0&&(E-=Math.PI*Math.sign(e)*_);const D=ye(ae(E/a)+this.center[0],-180,180),k=ye(ae(2*Math.atan(Math.pow(u/b,1/a))-sh),-Vs,Vs);return new tr(D,this.southernCenter?-k:k)}}class vg extends Dc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,i){return{x:$a(e),y:al(i),z:0}}unproject(e,i){const a=wa(e),u=vs(i);return new tr(a,u)}}const xg=Ee(Vs);class oy extends Dc{project(e,i){const a=(i=Ee(i))*i,u=a*a;return{x:.5*((e=Ee(e))*(.8707-.131979*a+u*(u*(.003971*a-.001529*u)-.013791))/Math.PI+.5),y:1-.5*(i*(1.007226+a*(.015085+u*(.028874*a-.044475-.005916*u)))/Math.PI+1),z:0}}unproject(e,i){e=(2*e-.5)*Math.PI;let a=i=(2*(1-i)-1)*Math.PI,u=25,f=0,_=a*a;do{_=a*a;const D=_*_;f=(a*(1.007226+_*(.015085+D*(.028874*_-.044475-.005916*D)))-i)/(1.007226+_*(.045255+D*(.259866*_-.311325-.005916*11*D))),a=ye(a-f,-xg,xg)}while(Math.abs(f)>1e-6&&--u>0);_=a*a;const b=ye(ae(e/(.8707+_*(_*(_*_*_*(.003971-.001529*_)-.013791)-.131979))),-180,180),E=ae(a);return new tr(b,E)}}const Yf=Ee(Vs);class ry extends Dc{project(e,i){i=Ee(i),e=Ee(e);const a=Math.cos(i),u=2/Math.PI,f=Math.acos(a*Math.cos(e/2)),_=Math.sin(f)/f,b=.5*(e*u+2*a*Math.sin(e/2)/_)||0,E=.5*(i+Math.sin(i)/_)||0;return{x:.5*(b/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(e,i){let a=e=(2*e-.5)*Math.PI,u=i=(2*(1-i)-1)*Math.PI,f=25;const _=1e-6;let b=0,E=0;do{const D=Math.cos(u),k=Math.sin(u),z=2*k*D,j=k*k,K=D*D,te=Math.cos(a/2),he=Math.sin(a/2),Re=2*te*he,rt=he*he,wt=1-K*te*te,lt=wt?1/wt:0,bt=wt?Math.acos(D*te)*Math.sqrt(1/wt):0,Mt=.5*(2*bt*D*he+2*a/Math.PI)-e,Dt=.5*(bt*k+u)-i,cn=.5*lt*(K*rt+bt*D*te*j)+1/Math.PI,on=lt*(Re*z/4-bt*k*he),En=.125*lt*(z*he-bt*k*K*Re),Hn=.5*lt*(j*te+bt*rt*D)+.5,fn=on*En-Hn*cn;b=(Dt*on-Mt*Hn)/fn,E=(Mt*En-Dt*cn)/fn,a=ye(a-b,-Math.PI,Math.PI),u=ye(u-E,-Yf,Yf)}while((Math.abs(b)>_||Math.abs(E)>_)&&--f>0);return new tr(ae(a),ae(u))}}class bg extends Dc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(Ee(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,i){const{scale:a,cosPhi:u}=this;return{x:Ee(e)*u*a+.5,y:-Math.sin(Ee(i))/u*a+.5,z:0}}unproject(e,i){const{scale:a,cosPhi:u}=this,f=-(i-.5)/a,_=ye(ae((e-.5)/a)/u,-180,180),b=Math.asin(ye(f*u,-1,1)),E=ye(ae(b),-Vs,Vs);return new tr(_,E)}}class Jf extends vg{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,i,a){const u=Cl(e,i,a);return zr(u,u,nu(ja(a))),{x:u[0],y:u[1],z:u[2]}}locationPoint(e,i){const a=eu(i.lat,i.lng),u=ys([],a),f=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(i),e._centerAltitude):e._centerAltitude;Cd(a,a,u,Zs(1,0)*Li*f);const _=ol(new Float64Array(16));return wl(_,e.pixelMatrix,e.globeMatrix),zr(a,a,_),new Ce(a[0],a[1])}pixelsPerMeter(e,i){return Zs(1,0)*i}pixelSpaceConversion(e,i,a){const u=Zs(1,e)*i,f=Xn(Zs(1,45)*i,u,a);return this.pixelsPerMeter(e,i)/f}createTileMatrix(e,i,a){const u=Mu(ja(a.canonical));return wl(new Float64Array(16),e.globeMatrix,u)}createInversionMatrix(e,i){const{center:a}=e,u=nu(ja(i));return Wp(u,u,Ee(a.lng)),vh(u,u,Ee(a.lat)),Kc(u,u,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(u)}pointCoordinate(e,i,a,u){return ef(e,i,a,!0)||new Au(0,0)}pointCoordinate3D(e,i,a){const u=this.pointCoordinate(e,i,a,0);return[u.x,u.y,u.z]}isPointAboveHorizon(e,i){return!ef(e,i.x,i.y,!1)}farthestPixelDistance(e){const i=function(u,f){const _=u.cameraToCenterDistance,b=u._centerAltitude*f,E=u._camera,D=u._camera.forward(),k=rl([],Ua([],D,-_),[0,0,b]),z=u.worldSize/(2*Math.PI),j=[0,0,-z],K=u.width/u.height,te=Math.tan(u.fovAboveCenter),he=Ua([],E.up(),te),Re=Ua([],E.right(),te*K),rt=ys([],rl([],rl([],D,he),Re)),wt=[];let lt;if(new Qp(k,rt).closestPointOnSphere(j,z,wt)){const bt=rl([],wt,j),Mt=Za([],bt,k);lt=Math.cos(u.fovAboveCenter)*bh(Mt)}else{const bt=Za([],k,j),Mt=Za([],j,k);ys(Mt,Mt);const Dt=bh(bt)-z;lt=Math.sqrt(Dt*(Dt+2*z));const cn=Math.acos(lt/(z+Dt))-Math.acos(xa(D,Mt));lt*=Math.cos(cn)}return 1.01*lt}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),a=Iu(e.zoom);if(a>0){const u=qf(e,Zs(1,e.center.lat)*e.worldSize),f=e.worldSize/(2*Math.PI),_=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Xn(i,u+f*(1-Math.cos(_)),Math.pow(a,10))}return i}upVector(e,i,a){return Cl(i,a,e,1)}upVectorScale(e){return{metersToTile:Mh(tu(ja(e)))}}}function wg(t){const e=t.parallels,i=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new vg(t);case"equirectangular":return new iy(t);case"naturalEarth":return new oy(t);case"equalEarth":return new ny(t);case"winkelTripel":return new ry(t);case"albers":return i?new bg(t):new ty(t);case"lambertConformalConic":return i?new bg(t):new yg(t);case"globe":return new Jf(t)}throw new Error(`Invalid projection name: ${t.name}`)}const sy=Zh.types,ay=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function fp(t,e,i,a,u,f,_,b,E,D,k,z,j){const K=b?Math.min(Al,Math.round(b[0])):0,te=b?Math.min(Al,Math.round(b[1])):0;t.emplaceBack(e,i,Math.round(32*a),Math.round(32*u),f,_,(K<<1)+(E?1:0),te,16*D,16*k,256*z,256*j)}function mp(t,e,i,a,u,f,_){t.emplaceBack(e,i,a,u,f,_)}function Ra(t,e,i,a,u){t.emplaceBack(e,i,a,u),t.emplaceBack(e,i,a,u),t.emplaceBack(e,i,a,u),t.emplaceBack(e,i,a,u)}function Kf(t){for(const e of t.sections)if(Jt(e.text))return!0;return!1}class Xf{constructor(e){this.layoutVertexArray=new Bn,this.indexArray=new Ti,this.programConfigurations=e,this.segments=new Cr,this.dynamicLayoutVertexArray=new $n,this.opacityVertexArray=new Di,this.placedSymbolArray=new Jr,this.globeExtVertexArray=new Yn}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,i,a,u){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Af.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,i),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Kh.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,ay,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Wd.members,!0)),this.opacityVertexBuffer.itemSize=1),(a||u)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}di(Xf,"SymbolBuffers");class gp{constructor(e,i,a){this.layoutVertexArray=new e,this.layoutAttributes=i,this.indexArray=new a,this.segments=new Cr,this.collisionVertexArray=new ho,this.collisionVertexArrayExt=new fo}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,qd.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,rg.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}di(gp,"CollisionBuffers");class Mc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(_=>_.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ol([]),this.placementViewportMatrix=ol([]);const i=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Yd(this.zoom,i["text-size"]),this.iconSizeData=Yd(this.zoom,i["icon-size"]);const a=this.layers[0].layout,u=a.get("symbol-sort-key"),f=a.get("symbol-z-order");this.canOverlap=a.get("text-allow-overlap")||a.get("icon-allow-overlap")||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==f&&void 0!==u.constantOr(1),this.sortFeaturesByY=("viewport-y"===f||"auto"===f&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=a.get("text-writing-mode").map(_=>Ca[_]),this.stateDependentLayerIds=this.layers.filter(_=>_.isStateDependent()).map(_=>_.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new Xf(new Yc(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new Xf(new Yc(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new la,this.lineVertexArray=new xl,this.symbolInstances=new vr}calculateGlyphDependencies(e,i,a,u,f){for(let _=0;_<e.length;_++)if(i[e.charCodeAt(_)]=!0,u&&f){const b=ju[e.charAt(_)];b&&(i[b.charCodeAt(0)]=!0)}}populate(e,i,a,u){const f=this.layers[0],_=f.layout,b="globe"===this.projection.name,E=_.get("text-font"),D=_.get("text-field"),k=_.get("icon-image"),z=("constant"!==D.value.kind||D.value.value instanceof hr&&!D.value.value.isEmpty()||D.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),j="constant"!==k.value.kind||!!k.value.value||Object.keys(k.parameters).length>0,K=_.get("symbol-sort-key");if(this.features=[],!z&&!j)return;const te=i.iconDependencies,he=i.glyphDependencies,Re=i.availableImages,rt=new N(this.zoom);for(const{feature:wt,id:lt,index:bt,sourceLayerIndex:Mt}of e){const Dt=f._featureFilter.needGeometry,cn=Yl(wt,Dt);if(!f._featureFilter.filter(rt,cn,a))continue;if(Dt||(cn.geometry=Dl(wt,a,u)),b&&1!==wt.type&&a.z<=5){const fn=cn.geometry,kn=.98078528056,Fn=(Vn,Jn)=>xa(Cl(Vn.x,Vn.y,a,1),Cl(Jn.x,Jn.y,a,1))<kn;for(let Vn=0;Vn<fn.length;Vn++)fn[Vn]=cf(fn[Vn],Fn)}let on,En;if(z){const fn=f.getValueAndResolveTokens("text-field",cn,a,Re),kn=hr.factory(fn);Kf(kn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===C()||this.hasRTLText&&O.isParsed())&&(on=sg(kn,f,cn))}if(j){const fn=f.getValueAndResolveTokens("icon-image",cn,a,Re);En=fn instanceof bo?fn:bo.fromString(fn)}if(!on&&!En)continue;const Hn=this.sortFeaturesByKey?K.evaluate(cn,{},a):void 0;if(this.features.push({id:lt,text:on,icon:En,index:bt,sourceLayerIndex:Mt,geometry:cn.geometry,properties:wt.properties,type:sy[wt.type],sortKey:Hn}),En&&(te[En.name]=!0),on){const fn=E.evaluate(cn,{},a).join(","),kn="map"===_.get("text-rotation-alignment")&&"point"!==_.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Ca.vertical)>=0;for(const Fn of on.sections)if(Fn.image)te[Fn.image.name]=!0;else{const Vn=L(on.toString()),Jn=Fn.fontStack||fn,Cn=he[Jn]=he[Jn]||{};this.calculateGlyphDependencies(Fn.text,Cn,kn,this.allowVerticalPlacement,Vn)}}}"line"===_.get("symbol-placement")&&(this.features=function(wt){const lt={},bt={},Mt=[];let Dt=0;function cn(fn){Mt.push(wt[fn]),Dt++}function on(fn,kn,Fn){const Vn=bt[fn];return delete bt[fn],bt[kn]=Vn,Mt[Vn].geometry[0].pop(),Mt[Vn].geometry[0]=Mt[Vn].geometry[0].concat(Fn[0]),Vn}function En(fn,kn,Fn){const Vn=lt[kn];return delete lt[kn],lt[fn]=Vn,Mt[Vn].geometry[0].shift(),Mt[Vn].geometry[0]=Fn[0].concat(Mt[Vn].geometry[0]),Vn}function Hn(fn,kn,Fn){const Vn=Fn?kn[0][kn[0].length-1]:kn[0][0];return`${fn}:${Vn.x}:${Vn.y}`}for(let fn=0;fn<wt.length;fn++){const kn=wt[fn],Fn=kn.geometry,Vn=kn.text?kn.text.toString():null;if(!Vn){cn(fn);continue}const Jn=Hn(Vn,Fn),Cn=Hn(Vn,Fn,!0);if(Jn in bt&&Cn in lt&&bt[Jn]!==lt[Cn]){const ai=En(Jn,Cn,Fn),xi=on(Jn,Cn,Mt[ai].geometry);delete lt[Jn],delete bt[Cn],bt[Hn(Vn,Mt[xi].geometry,!0)]=xi,Mt[ai].geometry=null}else Jn in bt?on(Jn,Cn,Fn):Cn in lt?En(Jn,Cn,Fn):(cn(fn),lt[Jn]=Dt-1,bt[Cn]=Dt-1)}return Mt.filter(fn=>fn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((wt,lt)=>wt.sortKey-lt.sortKey)}update(e,i,a,u){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,i,this.layers,a,u),this.icon.programConfigurations.updatePaintArrays(e,i,this.layers,a,u))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=wg(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,i){const a=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:u,y:f}of i)this.lineVertexArray.emplaceBack(u,f);return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,i,a,u,f,_,b,E,D,k,z,j,K,te){const he=e.indexArray,Re=e.layoutVertexArray,rt=e.globeExtVertexArray,wt=e.segments.prepareSegment(4*i.length,Re,he,this.canOverlap?_.sortKey:void 0),lt=this.glyphOffsetArray.length,bt=wt.vertexLength,Mt=this.allowVerticalPlacement&&b===Ca.vertical?Math.PI/2:0,Dt=_.text&&_.text.sections;for(let on=0;on<i.length;on++){const{tl:En,tr:Hn,bl:fn,br:kn,tex:Fn,pixelOffsetTL:Vn,pixelOffsetBR:Jn,minFontScaleX:Cn,minFontScaleY:ai,glyphOffset:xi,isSDF:ci,sectionIndex:to}=i[on],Kn=wt.vertexLength,Mi=xi[1];if(fp(Re,D.x,D.y,En.x,Mi+En.y,Fn.x,Fn.y,a,ci,Vn.x,Vn.y,Cn,ai),fp(Re,D.x,D.y,Hn.x,Mi+Hn.y,Fn.x+Fn.w,Fn.y,a,ci,Jn.x,Vn.y,Cn,ai),fp(Re,D.x,D.y,fn.x,Mi+fn.y,Fn.x,Fn.y+Fn.h,a,ci,Vn.x,Jn.y,Cn,ai),fp(Re,D.x,D.y,kn.x,Mi+kn.y,Fn.x+Fn.w,Fn.y+Fn.h,a,ci,Jn.x,Jn.y,Cn,ai),E){const{x:Wi,y:Io,z:Yi}=E.anchor,[Ui,Yo,no]=E.up;mp(rt,Wi,Io,Yi,Ui,Yo,no),mp(rt,Wi,Io,Yi,Ui,Yo,no),mp(rt,Wi,Io,Yi,Ui,Yo,no),mp(rt,Wi,Io,Yi,Ui,Yo,no),Ra(e.dynamicLayoutVertexArray,Wi,Io,Yi,Mt)}else Ra(e.dynamicLayoutVertexArray,D.x,D.y,D.z,Mt);he.emplaceBack(Kn,Kn+1,Kn+2),he.emplaceBack(Kn+1,Kn+2,Kn+3),wt.vertexLength+=4,wt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(xi[0]),on!==i.length-1&&to===i[on+1].sectionIndex||e.programConfigurations.populatePaintArrays(Re.length,_,_.index,{},K,te,Dt&&Dt[to])}const cn=E?E.anchor:D;e.placedSymbolArray.emplaceBack(cn.x,cn.y,cn.z,D.x,D.y,lt,this.glyphOffsetArray.length-lt,bt,k,z,D.segment,a?a[0]:0,a?a[1]:0,u[0],u[1],b,0,!1,0,j,0)}_commitLayoutVertex(e,i,a,u,f,_,b){e.emplaceBack(i,a,u,f,_,Math.round(b.x),Math.round(b.y))}_addCollisionDebugVertices(e,i,a,u,f,_,b){const E=a.segments.prepareSegment(4,a.layoutVertexArray,a.indexArray),D=E.vertexLength,k=b.tileAnchorX,z=b.tileAnchorY;for(let K=0;K<4;K++)a.collisionVertexArray.emplaceBack(0,0,0,0);a.collisionVertexArrayExt.emplaceBack(i,-e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,-e.padding),a.collisionVertexArrayExt.emplaceBack(i,e.padding,e.padding),a.collisionVertexArrayExt.emplaceBack(i,-e.padding,e.padding),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Ce(e.x1,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Ce(e.x2,e.y1)),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Ce(e.x2,e.y2)),this._commitLayoutVertex(a.layoutVertexArray,u,f,_,k,z,new Ce(e.x1,e.y2)),E.vertexLength+=4;const j=a.indexArray;j.emplaceBack(D,D+1),j.emplaceBack(D+1,D+2),j.emplaceBack(D+2,D+3),j.emplaceBack(D+3,D),E.primitiveLength+=4}_addTextDebugCollisionBoxes(e,i,a,u,f,_){for(let b=u;b<f;b++){const E=a.get(b),D=this.getSymbolInstanceTextSize(e,_,i,b);this._addCollisionDebugVertices(E,D,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}_addIconDebugCollisionBoxes(e,i,a,u,f,_){for(let b=u;b<f;b++){const E=a.get(b),D=this.getSymbolInstanceIconSize(e,i,_.placedIconSymbolIndex);this._addCollisionDebugVertices(E,D,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,_)}}generateCollisionDebugBuffers(e,i){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new gp(vi,Xh.members,Yr),this.iconCollisionBox=new gp(vi,Xh.members,Yr);const a=Vu(this.iconSizeData,e),u=Vu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f);this._addTextDebugCollisionBoxes(u,e,i,_.textBoxStartIndex,_.textBoxEndIndex,_),this._addTextDebugCollisionBoxes(u,e,i,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._addIconDebugCollisionBoxes(a,e,i,_.iconBoxStartIndex,_.iconBoxEndIndex,_),this._addIconDebugCollisionBoxes(a,e,i,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_)}}getSymbolInstanceTextSize(e,i,a,u){const f=this.text.placedSymbolArray.get(i.rightJustifiedTextSymbolIndex>=0?i.rightJustifiedTextSymbolIndex:i.centerJustifiedTextSymbolIndex>=0?i.centerJustifiedTextSymbolIndex:i.leftJustifiedTextSymbolIndex>=0?i.leftJustifiedTextSymbolIndex:i.verticalPlacedTextSymbolIndex>=0?i.verticalPlacedTextSymbolIndex:u),_=Jd(this.textSizeData,e,f)/As;return this.tilePixelRatio*_}getSymbolInstanceIconSize(e,i,a){const u=this.icon.placedSymbolArray.get(a),f=Jd(this.iconSizeData,e,u);return this.tilePixelRatio*f}_commitDebugCollisionVertexUpdate(e,i,a){e.emplaceBack(i,-a,-a),e.emplaceBack(i,a,-a),e.emplaceBack(i,a,a),e.emplaceBack(i,-a,a)}_updateTextDebugCollisionBoxes(e,i,a,u,f,_){for(let b=u;b<f;b++){const E=a.get(b),D=this.getSymbolInstanceTextSize(e,_,i,b);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,D,E.padding)}}_updateIconDebugCollisionBoxes(e,i,a,u,f,_){for(let b=u;b<f;b++){const E=a.get(b),D=this.getSymbolInstanceIconSize(e,i,_);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,D,E.padding)}}updateCollisionDebugBuffers(e,i){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const a=Vu(this.iconSizeData,e),u=Vu(this.textSizeData,e);for(let f=0;f<this.symbolInstances.length;f++){const _=this.symbolInstances.get(f);this._updateTextDebugCollisionBoxes(u,e,i,_.textBoxStartIndex,_.textBoxEndIndex,_),this._updateTextDebugCollisionBoxes(u,e,i,_.verticalTextBoxStartIndex,_.verticalTextBoxEndIndex,_),this._updateIconDebugCollisionBoxes(a,e,i,_.iconBoxStartIndex,_.iconBoxEndIndex,_.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(a,e,i,_.verticalIconBoxStartIndex,_.verticalIconBoxEndIndex,_.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,i,a,u,f,_,b,E,D){const k={};if(i<a){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt,featureIndex:Mt}=e.get(i);k.textBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt},k.textFeatureIndex=Mt}if(u<f){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt,featureIndex:Mt}=e.get(u);k.verticalTextBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt},k.verticalTextFeatureIndex=Mt}if(_<b){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt,featureIndex:Mt}=e.get(_);k.iconBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt},k.iconFeatureIndex=Mt}if(E<D){const{x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt,featureIndex:Mt}=e.get(E);k.verticalIconBox={x1:z,y1:j,x2:K,y2:te,padding:he,projectedAnchorX:Re,projectedAnchorY:rt,projectedAnchorZ:wt,tileAnchorX:lt,tileAnchorY:bt},k.verticalIconFeatureIndex=Mt}return k}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let i=0;i<this.symbolInstances.length;i++){const a=this.symbolInstances.get(i);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,i){const a=e.placedSymbolArray.get(i),u=a.vertexStartIndex+4*a.numGlyphs;for(let f=a.vertexStartIndex;f<u;f+=4)e.indexArray.emplaceBack(f,f+1,f+2),e.indexArray.emplaceBack(f+1,f+2,f+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const i=Math.sin(e),a=Math.cos(e),u=[],f=[],_=[];for(let b=0;b<this.symbolInstances.length;++b){_.push(b);const E=this.symbolInstances.get(b);u.push(0|Math.round(i*E.tileAnchorX+a*E.tileAnchorY)),f.push(E.featureIndex)}return _.sort((b,E)=>u[b]-u[E]||f[E]-f[b]),_}addToSortKeyRanges(e,i){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===i?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:i,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const i of this.symbolInstanceIndexes){const a=this.symbolInstances.get(i);this.featureSortOrder.push(a.featureIndex);const{rightJustifiedTextSymbolIndex:u,centerJustifiedTextSymbolIndex:f,leftJustifiedTextSymbolIndex:_,verticalPlacedTextSymbolIndex:b,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:D}=a;u>=0&&this.addIndicesForPlacedSymbol(this.text,u),f>=0&&f!==u&&this.addIndicesForPlacedSymbol(this.text,f),_>=0&&_!==f&&_!==u&&this.addIndicesForPlacedSymbol(this.text,_),b>=0&&this.addIndicesForPlacedSymbol(this.text,b),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),D>=0&&this.addIndicesForPlacedSymbol(this.icon,D)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}di(Mc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Mc.MAX_GLYPHS=65535,Mc.addDynamicAttributes=Ra;const Tg=new ht({"symbol-placement":new ue(en.layout_symbol["symbol-placement"]),"symbol-spacing":new ue(en.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ue(en.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new He(en.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ue(en.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ue(en.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ue(en.layout_symbol["icon-ignore-placement"]),"icon-optional":new ue(en.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ue(en.layout_symbol["icon-rotation-alignment"]),"icon-size":new He(en.layout_symbol["icon-size"]),"icon-text-fit":new ue(en.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ue(en.layout_symbol["icon-text-fit-padding"]),"icon-image":new He(en.layout_symbol["icon-image"]),"icon-rotate":new He(en.layout_symbol["icon-rotate"]),"icon-padding":new ue(en.layout_symbol["icon-padding"]),"icon-keep-upright":new ue(en.layout_symbol["icon-keep-upright"]),"icon-offset":new He(en.layout_symbol["icon-offset"]),"icon-anchor":new He(en.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ue(en.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ue(en.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ue(en.layout_symbol["text-rotation-alignment"]),"text-field":new He(en.layout_symbol["text-field"]),"text-font":new He(en.layout_symbol["text-font"]),"text-size":new He(en.layout_symbol["text-size"]),"text-max-width":new He(en.layout_symbol["text-max-width"]),"text-line-height":new He(en.layout_symbol["text-line-height"]),"text-letter-spacing":new He(en.layout_symbol["text-letter-spacing"]),"text-justify":new He(en.layout_symbol["text-justify"]),"text-radial-offset":new He(en.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ue(en.layout_symbol["text-variable-anchor"]),"text-anchor":new He(en.layout_symbol["text-anchor"]),"text-max-angle":new ue(en.layout_symbol["text-max-angle"]),"text-writing-mode":new ue(en.layout_symbol["text-writing-mode"]),"text-rotate":new He(en.layout_symbol["text-rotate"]),"text-padding":new ue(en.layout_symbol["text-padding"]),"text-keep-upright":new ue(en.layout_symbol["text-keep-upright"]),"text-transform":new He(en.layout_symbol["text-transform"]),"text-offset":new He(en.layout_symbol["text-offset"]),"text-allow-overlap":new ue(en.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ue(en.layout_symbol["text-ignore-placement"]),"text-optional":new ue(en.layout_symbol["text-optional"])});var _p={paint:new ht({"icon-opacity":new He(en.paint_symbol["icon-opacity"]),"icon-color":new He(en.paint_symbol["icon-color"]),"icon-halo-color":new He(en.paint_symbol["icon-halo-color"]),"icon-halo-width":new He(en.paint_symbol["icon-halo-width"]),"icon-halo-blur":new He(en.paint_symbol["icon-halo-blur"]),"icon-translate":new ue(en.paint_symbol["icon-translate"]),"icon-translate-anchor":new ue(en.paint_symbol["icon-translate-anchor"]),"text-opacity":new He(en.paint_symbol["text-opacity"]),"text-color":new He(en.paint_symbol["text-color"],{runtimeType:st,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new He(en.paint_symbol["text-halo-color"]),"text-halo-width":new He(en.paint_symbol["text-halo-width"]),"text-halo-blur":new He(en.paint_symbol["text-halo-blur"]),"text-translate":new ue(en.paint_symbol["text-translate"]),"text-translate-anchor":new ue(en.paint_symbol["text-translate-anchor"])}),layout:Tg};class ah{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:kr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const i=this.defaultValue.property.overrides;if(i&&i.hasOverride(e.formattedSection))return i.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}di(ah,"FormatSectionOverride",{omit:["defaultValue"]});class rd extends il{constructor(e){super(e,_p)}recalculate(e,i){super.recalculate(e,i),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const a=this.layout.get("text-writing-mode");if(a){const u=[];for(const f of a)u.indexOf(f)<0&&u.push(f);this.layout._values["text-writing-mode"]=u}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,i,a,u){const f=this.layout.get(e).evaluate(i,{},a,u),_=this._unevaluatedLayout._values[e];return _.isDataDriven()||fs(_.value)||!f?f:(b=i.properties,f.replace(/{([^{}]+)}/g,(D,k)=>k in b?String(b[k]):""));var b}createBucket(e){return new Mc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of _p.paint.overridableProperties){if(!rd.hasPaintOverride(this.layout,e))continue;const i=this.paint.get(e),a=new ah(i),u=new Ds(a,i.property.specification);let f=null;f="constant"===i.value.kind||"source"===i.value.kind?new qs("source",u):new os("composite",u,i.value.zoomStops,i.value._interpolationType),this.paint._values[e]=new Ye(i.property,f,i.parameters)}}_handleOverridablePaintPropertyUpdate(e,i,a){return!(!this.layout||i.isDataDriven()||a.isDataDriven())&&rd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,i){const a=e.get("text-field"),u=_p.paint.properties[i];let f=!1;const _=b=>{for(const E of b)if(u.overrides&&u.overrides.hasOverride(E))return void(f=!0)};if("constant"===a.value.kind&&a.value.value instanceof hr)_(a.value.value.sections);else if("source"===a.value.kind){const b=D=>{f||(D instanceof jo&&Bi(D.value)===zt?_(D.value.sections):D instanceof Ri?_(D.sections):D.eachChild(b))},E=a.value;E._styleExpression&&b(E._styleExpression.expression)}return f}getProgramConfiguration(e){return new nl(this,e)}}var Ev={paint:new ht({"background-color":new ue(en.paint_background["background-color"]),"background-pattern":new ue(en.paint_background["background-pattern"]),"background-opacity":new ue(en.paint_background["background-opacity"])})},Cg={paint:new ht({"raster-opacity":new ue(en.paint_raster["raster-opacity"]),"raster-hue-rotate":new ue(en.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ue(en.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ue(en.paint_raster["raster-brightness-max"]),"raster-saturation":new ue(en.paint_raster["raster-saturation"]),"raster-contrast":new ue(en.paint_raster["raster-contrast"]),"raster-resampling":new ue(en.paint_raster["raster-resampling"]),"raster-fade-duration":new ue(en.paint_raster["raster-fade-duration"])})};class Eg extends il{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var Dg={paint:new ht({"sky-type":new ue(en.paint_sky["sky-type"]),"sky-atmosphere-sun":new ue(en.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ue(en.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ue(en.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ue(en.paint_sky["sky-gradient-radius"]),"sky-gradient":new pt(en.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ue(en.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ue(en.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ue(en.paint_sky["sky-opacity"])})};function yp(t,e,i){const a=[0,0,1],u=Dm([]);return Dh(u,u,i?-Ee(t)+Math.PI:Ee(t)),Kp(u,u,-Ee(e)),Jp(a,a,u),ys(a,a)}const Qf={circle:class extends il{constructor(t){super(t,Fd)}createBucket(t){return new Ld(t)}queryRadius(t){const e=t;return Pu("circle-radius",this,e)+Pu("circle-stroke-width",this,e)+pf(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,i,a,u,f,_,b){const E=Lh(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),D=this.paint.get("circle-radius").evaluate(e,i)+this.paint.get("circle-stroke-width").evaluate(e,i);return Bd(t,a,f,_,b,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,D)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new nl(this,t)}},heatmap:class extends il{createBucket(t){return new gf(t)}constructor(t){super(t,vc),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=su({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return Pu("heatmap-radius",this,t)}queryIntersectsFeature(t,e,i,a,u,f,_,b){const E=this.paint.get("heatmap-radius").evaluate(e,i);return Bd(t,a,f,_,b,!0,!0,new Ce(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new nl(this,t)}},hillshade:class extends il{constructor(t){super(t,M_)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends il{constructor(t){super(t,k_)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),i=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&i.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),i}getProgramConfiguration(t){return new nl(this,t)}recalculate(t,e){super.recalculate(t,e);const i=this.paint._values["fill-outline-color"];"constant"===i.value.kind&&void 0===i.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Uh(t)}queryRadius(){return pf(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,i,a,u,f){return!t.queryGeometry.isAboveHorizon&&uf(Fm(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),a)}isTileClipped(){return!0}},"fill-extrusion":class extends il{constructor(t){super(t,Bu)}createBucket(t){return new wc(t)}queryRadius(){return pf(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new nl(this,t)}queryIntersectsFeature(t,e,i,a,u,f,_,b,E){const D=Lh(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),k=this.paint.get("fill-extrusion-height").evaluate(e,i),z=this.paint.get("fill-extrusion-base").evaluate(e,i),j=[0,0],K=b&&f.elevation,te=f.elevation?f.elevation.exaggeration():1,he=t.tile.getBucket(this);if(K&&he instanceof wc){const bt=he.centroidVertexArray,Mt=E+1;Mt<bt.length&&(j[0]=bt.geta_centroid_pos0(Mt),j[1]=bt.geta_centroid_pos1(Mt))}if(0===j[0]&&1===j[1])return!1;"globe"===f.projection.name&&(a=tg([a],[new Ce(0,0),new Ce(Li,Li)],t.tileID.canonical).map(bt=>bt.polygon).flat());const Re=K?b:null,[rt,wt]=(Mt=a,Dt=z,cn=k,on=D,En=_,Hn=Re,fn=j,kn=te,Fn=f.center.lat,"globe"===(bt=f).projection.name?function(Jn,Cn,ai,xi,ci,to,Kn,Mi,Wi,Io,Yi){const Ui=[],Yo=[],no=Jn.projection.upVectorScale(Yi,Jn.center.lat,Jn.worldSize).metersToTile,oo=[0,0,0,1],Zo=[0,0,0,1],cr=(nr,Er,Dr,Rr)=>{nr[0]=Er,nr[1]=Dr,nr[2]=Rr,nr[3]=1},ur=eg();ai>0&&(ai+=ur),xi+=ur;for(const nr of Cn){const Er=[],Dr=[];for(const Rr of nr){const $o=Rr.x+ci.x,ts=Rr.y+ci.y,$r=Jn.projection.projectTilePoint($o,ts,Yi),Lr=Jn.projection.upVector(Yi,Rr.x,Rr.y);let So=ai,Hr=xi;if(Kn){const ir=B_($o,ts,ai,xi,Kn,Mi,Wi,Io);So+=ir.base,Hr+=ir.top}0!==ai?cr(oo,$r.x+Lr[0]*no*So,$r.y+Lr[1]*no*So,$r.z+Lr[2]*no*So):cr(oo,$r.x,$r.y,$r.z),cr(Zo,$r.x+Lr[0]*no*Hr,$r.y+Lr[1]*no*Hr,$r.z+Lr[2]*no*Hr),zr(oo,oo,to),zr(Zo,Zo,to),Er.push(new zu(oo[0],oo[1],oo[2])),Dr.push(new zu(Zo[0],Zo[1],Zo[2]))}Ui.push(Er),Yo.push(Dr)}return[Ui,Yo]}(bt,Mt,Dt,cn,on,En,Hn,fn,kn,Fn,t.tileID.canonical):Hn?function(Jn,Cn,ai,xi,ci,to,Kn,Mi,Wi){const Io=[],Yi=[],Ui=[0,0,0,1];for(const Yo of Jn){const no=[],oo=[];for(const Zo of Yo){const cr=Zo.x+xi.x,ur=Zo.y+xi.y,nr=B_(cr,ur,Cn,ai,to,Kn,Mi,Wi);Ui[0]=cr,Ui[1]=ur,Ui[2]=nr.base,Ui[3]=1,Xc(Ui,Ui,ci),Ui[3]=Math.max(Ui[3],1e-5);const Er=new zu(Ui[0]/Ui[3],Ui[1]/Ui[3],Ui[2]/Ui[3]);Ui[0]=cr,Ui[1]=ur,Ui[2]=nr.top,Ui[3]=1,Xc(Ui,Ui,ci),Ui[3]=Math.max(Ui[3],1e-5);const Dr=new zu(Ui[0]/Ui[3],Ui[1]/Ui[3],Ui[2]/Ui[3]);no.push(Er),oo.push(Dr)}Io.push(no),Yi.push(oo)}return[Io,Yi]}(Mt,Dt,cn,on,En,Hn,fn,kn,Fn):function(Jn,Cn,ai,xi,ci){const to=[],Kn=[],Mi=ci[8]*Cn,Wi=ci[9]*Cn,Io=ci[10]*Cn,Yi=ci[11]*Cn,Ui=ci[8]*ai,Yo=ci[9]*ai,no=ci[10]*ai,oo=ci[11]*ai;for(const Zo of Jn){const cr=[],ur=[];for(const nr of Zo){const Er=nr.x+xi.x,Dr=nr.y+xi.y,Rr=ci[0]*Er+ci[4]*Dr+ci[12],$o=ci[1]*Er+ci[5]*Dr+ci[13],ts=ci[2]*Er+ci[6]*Dr+ci[14],$r=ci[3]*Er+ci[7]*Dr+ci[15],Lr=Rr+Mi,So=$o+Wi,Hr=ts+Io,ir=Math.max($r+Yi,1e-5),Qs=Rr+Ui,Gr=$o+Yo,as=ts+no,ns=Math.max($r+oo,1e-5);cr.push(new zu(Lr/ir,So/ir,Hr/ir)),ur.push(new zu(Qs/ns,Gr/ns,as/ns))}to.push(cr),Kn.push(ur)}return[to,Kn]}(Mt,Dt,cn,on,En)),lt=t.queryGeometry;var bt,Mt,Dt,cn,on,En,Hn,fn,kn,Fn;return function(bt,Mt,Dt){let cn=1/0;uf(Dt,Mt)&&(cn=Gh(Dt,Mt[0]));for(let on=0;on<Mt.length;on++){const En=Mt[on],Hn=bt[on];for(let fn=0;fn<En.length-1;fn++){const kn=En[fn],Fn=[kn,En[fn+1],Hn[fn+1],Hn[fn],kn];Su(Dt,Fn)&&(cn=Math.min(cn,Gh(Dt,Fn)))}}return cn!==1/0&&cn}(rt,wt,lt.isPointQuery()?lt.screenBounds:lt.screenGeometry)}},line:class extends il{constructor(t){super(t,Yh),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof Ln,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Zu.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new qh(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new nl(this,t)}queryRadius(t){const e=t,i=Jh(Pu("line-width",this,e),Pu("line-gap-width",this,e)),a=Pu("line-offset",this,e);return i/2+Math.abs(a)+pf(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,i,a,u,f){if(t.queryGeometry.isAboveHorizon)return!1;const _=Fm(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),f.angle,t.pixelToTileUnitsFactor),b=t.pixelToTileUnitsFactor/2*Jh(this.paint.get("line-width").evaluate(e,i),this.paint.get("line-gap-width").evaluate(e,i)),E=this.paint.get("line-offset").evaluate(e,i);return E&&(a=function(D,k){const z=[],j=new Ce(0,0);for(let K=0;K<D.length;K++){const te=D[K],he=[];for(let Re=0;Re<te.length;Re++){const rt=te[Re],wt=te[Re+1],lt=0===Re?j:rt.sub(te[Re-1])._unit()._perp(),bt=Re===te.length-1?j:wt.sub(rt)._unit()._perp(),Mt=lt._add(bt)._unit();Mt._mult(1/(Mt.x*bt.x+Mt.y*bt.y)),he.push(Mt._mult(k)._add(rt))}z.push(he)}return z}(a,E*t.pixelToTileUnitsFactor)),function(D,k,z){for(let j=0;j<k.length;j++){const K=k[j];if(D.length>=3)for(let te=0;te<K.length;te++)if(Jl(D,K[te]))return!0;if(T_(D,K,z))return!0}return!1}(_,a,b)}isTileClipped(){return!0}},symbol:rd,background:class extends il{constructor(t){super(t,Ev)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends il{constructor(t){super(t,Cg)}getProgramIds(){return["raster"]}},sky:class extends il{constructor(t){super(t,Dg),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=su({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const a=this.paint.get("sky-atmosphere-sun"),u=!a,f=t.style.light,_=f.properties.get("position");return u&&"viewport"===f.properties.get("anchor")&&It("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),u?yp(_.azimuthal,90-_.polar,e):yp(a[0],90-a[1],e)}const i=this.paint.get("sky-gradient-center");return yp(i[0],90-i[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}};class La{constructor(e,i,a,u){this.context=e,this.format=a,this.texture=e.gl.createTexture(),this.update(i,u)}update(e,i,a){const{width:u,height:f}=e,{context:_}=this,{gl:b}=_,{HTMLImageElement:E,HTMLCanvasElement:D,HTMLVideoElement:k,ImageData:z,ImageBitmap:j}=Q;if(b.bindTexture(b.TEXTURE_2D,this.texture),_.pixelStoreUnpackFlipY.set(!1),_.pixelStoreUnpack.set(1),_.pixelStoreUnpackPremultiplyAlpha.set(this.format===b.RGBA&&(!i||!1!==i.premultiply)),a||this.size&&this.size[0]===u&&this.size[1]===f){const{x:K,y:te}=a||{x:0,y:0};e instanceof E||e instanceof D||e instanceof k||e instanceof z||j&&e instanceof j?b.texSubImage2D(b.TEXTURE_2D,0,K,te,b.RGBA,b.UNSIGNED_BYTE,e):b.texSubImage2D(b.TEXTURE_2D,0,K,te,u,f,b.RGBA,b.UNSIGNED_BYTE,e.data)}else this.size=[u,f],e instanceof E||e instanceof D||e instanceof k||e instanceof z||j&&e instanceof j?b.texImage2D(b.TEXTURE_2D,0,this.format,this.format,b.UNSIGNED_BYTE,e):b.texImage2D(b.TEXTURE_2D,0,this.format,u,f,0,this.format,b.UNSIGNED_BYTE,e.data);this.useMipmap=!!(i&&i.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&b.generateMipmap(b.TEXTURE_2D)}bind(e,i){const{context:a}=this,{gl:u}=a;u.bindTexture(u.TEXTURE_2D,this.texture),e!==this.filter&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MAG_FILTER,e),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_MIN_FILTER,this.useMipmap?e===u.NEAREST?u.NEAREST_MIPMAP_NEAREST:u.LINEAR_MIPMAP_NEAREST:e),this.filter=e),i!==this.wrap&&(u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_S,i),u.texParameteri(u.TEXTURE_2D,u.TEXTURE_WRAP_T,i),this.wrap=i)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class ly{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class cy{constructor(){this.tasks={},this.taskQueue=[],Gt(["process"],this),this.invoker=new ly(this.process),this.nextId=0}add(e,i){const a=this.nextId++,u=function({type:f,isSymbolTile:_,zoom:b}){return b=b||0,"message"===f?0:"maybePrepare"!==f||_?"parseTile"!==f||_?"parseTile"===f&&_?300-b:"maybePrepare"===f&&_?400-b:500:200-b:100-b}(i);if(0===u){dn();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[a]={fn:e,metadata:i,priority:u,id:a},this.taskQueue.push(a),this.invoker.trigger(),{cancel:()=>{delete this.tasks[a]}}}process(){dn();try{if(this.taskQueue=this.taskQueue.filter(a=>!!this.tasks[a]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const i=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!i)return;i.fn()}finally{}}pick(){let e=null,i=1/0;for(let u=0;u<this.taskQueue.length;u++){const f=this.tasks[this.taskQueue[u]];f.priority<i&&(i=f.priority,e=u)}if(null===e)return null;const a=this.taskQueue[e];return this.taskQueue.splice(e,1),a}remove(){this.invoker.remove()}}class vp{constructor(e){this._stringToNumber={},this._numberToString=[];for(let i=0;i<e.length;i++){const a=e[i];this._stringToNumber[a]=i,this._numberToString[i]=a}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const uy=["tile","layer","source","sourceLayer","state"];class Mg{constructor(e,i,a,u,f){this.type="Feature",this._vectorTileFeature=e,this._z=i,this._x=a,this._y=u,this.properties=e.properties,this.id=f}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const i of uy)void 0!==this[i]&&(e[i]=this[i]);return e}}const ec=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,i=0,a=0,u=0,f=0,_=0,b=0;for(1&e?u=f=_=32:i=a=b=32;(e>>=1)>1;){const D=i+u>>1,k=a+f>>1;1&e?(u=i,f=a,i=_,a=b):(i=u,a=f,u=_,f=b),_=D,b=k}const E=4*t;ec[E+0]=i,ec[E+1]=a,ec[E+2]=u,ec[E+3]=f}const Sl=new Uint16Array(2178),ul=new Uint8Array(1089),Ic=new Uint16Array(1089);function lh(t){return 0===t?-.03125:32===t?.03125:0}var dy=$t([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const Ig={type:2,extent:Li,loadGeometry:()=>[[new Ce(0,0),new Ce(Li+1,0),new Ce(Li+1,Li+1),new Ce(0,Li+1),new Ce(0,0)]]};class xp{constructor(e,i,a,u,f){this.tileID=e,this.uid=je(),this.uses=0,this.tileSize=i,this.tileZoom=a,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=f,this.expiredRequestCount=0,this.state="loading",u&&u.transform&&(this.projection=u.transform.projection)}registerFadeDuration(e){const i=e+this.timeAdded;i<Ao.now()||this.fadeEndTime&&i<this.fadeEndTime||(this.fadeEndTime=i)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=uu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,i,a){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(u,f){const _={};if(!f)return _;for(const b of u){const E=b.layerIds.map(D=>f.getLayer(D)).filter(Boolean);if(0!==E.length){b.layers=E,b.stateDependentLayerIds&&(b.stateDependentLayers=b.stateDependentLayerIds.map(D=>E.filter(k=>k.id===D)[0]));for(const D of E)_[D.id]=b}}return _}(e.buckets,i.style),this.hasSymbolBuckets=!1;for(const u in this.buckets){const f=this.buckets[u];if(f instanceof Mc){if(this.hasSymbolBuckets=!0,!a)break;f.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const u in this.buckets){const f=this.buckets[u];if(f instanceof Mc&&f.hasRTLText){this.hasRTLText=!0,O.isLoading()||O.isLoaded()||"deferred"!==C()||I();break}}this.queryPadding=0;for(const u in this.buckets){const f=this.buckets[u];this.queryPadding=Math.max(this.queryPadding,i.style.getLayer(u).queryRadius(f))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new ar}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const a in this.buckets){const u=this.buckets[a];u.uploadPending()&&u.upload(e)}const i=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new La(e,this.imageAtlas.image,i.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new La(e,this.glyphAtlasImage,i.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new La(e,this.lineAtlas.image,i.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,i,a,u,f,_,b,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:u,pixelPosMatrix:b,transform:_,params:f,tileTransform:this.tileTransform},e,i,a):{}}querySourceFeatures(e,i){const a=this.latestFeatureIndex;if(!a||!a.rawTileData)return;const u=a.loadVTLayers(),f=i?i.sourceLayer:"",_=u._geojsonTileLayer||u[f];if(!_)return;const b=dc(i&&i.filter),{z:E,x:D,y:k}=this.tileID.canonical,z={z:E,x:D,y:k};for(let j=0;j<_.length;j++){const K=_.feature(j);if(b.needGeometry){const Re=Yl(K,!0);if(!b.filter(new N(this.tileID.overscaledZ),Re,this.tileID.canonical))continue}else if(!b.filter(new N(this.tileID.overscaledZ),K))continue;const te=a.getId(K,f),he=new Mg(K,E,D,k,te);he.tile=z,e.push(he)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const i=this.expirationTime;if(e.cacheControl){const a=Sn(e.cacheControl);a["max-age"]&&(this.expirationTime=Date.now()+1e3*a["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const a=Date.now();let u=!1;if(this.expirationTime>a)u=!1;else if(i)if(this.expirationTime<i)u=!0;else{const f=this.expirationTime-i;f?this.expirationTime=a+Math.max(f,3e4):u=!0}else u=!0;u?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,i){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!i)return;const a=this.latestFeatureIndex.loadVTLayers(),u=i.style.listImages();for(const f in this.buckets){if(!i.style.hasLayer(f))continue;const _=this.buckets[f],b=_.layers[0].sourceLayer||"_geojsonTileLayer",E=a[b],D=e[b];if(!E||!D||0===Object.keys(D).length)continue;if(_.update(D,E,u,this.imageAtlas&&this.imageAtlas.patternPositions||{}),_ instanceof qh||_ instanceof Uh){const z=i.style._getSourceCache(_.layers[0].source);i._terrain&&i._terrain.enabled&&z&&_.programConfigurations.needsUpload&&i._terrain._clearRenderCacheForTile(z.id,this.tileID)}const k=i&&i.style&&i.style.getLayer(f);k&&(this.queryPadding=Math.max(this.queryPadding,k.queryRadius(_)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Ao.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Ao.now()+e}setTexture(e,i){const a=i.context,u=a.gl;this.texture=this.texture||i.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new La(a,e,u.RGBA,{useMipmap:!0}),this.texture.bind(u.LINEAR,u.CLAMP_TO_EDGE))}setDependencies(e,i){const a={};for(const u of i)a[u]=!0;this.dependencies[e]=a}hasDependency(e,i){for(const a of e){const u=this.dependencies[a];if(u)for(const f of i)if(u[f])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,i){if(!i||"mercator"===i.name||this._tileDebugBuffer)return;const a=Dl(Ig,this.tileID.canonical,this.tileTransform)[0],u=new Wn,f=new _s;for(let _=0;_<a.length;_++){const{x:b,y:E}=a[_];u.emplaceBack(b,E),f.emplaceBack(_)}f.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(f),this._tileDebugBuffer=e.createVertexBuffer(u,Dd.members),this._tileDebugSegments=Cr.simpleSegment(0,0,u.length,f.length)}_makeTileBoundsBuffers(e,i){if(this._tileBoundsBuffer||!i||"mercator"===i.name)return;const a=Dl(Ig,this.tileID.canonical,this.tileTransform)[0];let u,f;if(this.isRaster){const _=function(b,E){const D=uu(b,E),k=Math.pow(2,b.z);for(let Re=0;Re<33;Re++)for(let rt=0;rt<33;rt++){const wt=wa((b.x+(rt+lh(rt))/32)/k),lt=vs((b.y+(Re+lh(Re))/32)/k),bt=E.project(wt,lt),Mt=33*Re+rt;Sl[2*Mt+0]=Math.round((bt.x*D.scale-D.x)*Li),Sl[2*Mt+1]=Math.round((bt.y*D.scale-D.y)*Li)}ul.fill(0),Ic.fill(0);for(let Re=2045;Re>=0;Re--){const rt=4*Re,wt=ec[rt+0],lt=ec[rt+1],bt=ec[rt+2],Mt=ec[rt+3],Dt=wt+bt>>1,cn=lt+Mt>>1,on=Dt+cn-lt,En=cn+wt-Dt,Hn=33*lt+wt,fn=33*Mt+bt,kn=33*cn+Dt,Fn=Math.hypot((Sl[2*Hn+0]+Sl[2*fn+0])/2-Sl[2*kn+0],(Sl[2*Hn+1]+Sl[2*fn+1])/2-Sl[2*kn+1])>=16;ul[kn]=ul[kn]||(Fn?1:0),Re<1022&&(ul[kn]=ul[kn]||ul[33*(lt+En>>1)+(wt+on>>1)]||ul[33*(Mt+En>>1)+(bt+on>>1)])}const z=new An,j=new Ti;let K=0;function te(Re,rt){const wt=33*rt+Re;return 0===Ic[wt]&&(z.emplaceBack(Sl[2*wt+0],Sl[2*wt+1],Re*Li/32,rt*Li/32),Ic[wt]=++K),Ic[wt]-1}function he(Re,rt,wt,lt,bt,Mt){const Dt=Re+wt>>1,cn=rt+lt>>1;if(Math.abs(Re-bt)+Math.abs(rt-Mt)>1&&ul[33*cn+Dt])he(bt,Mt,Re,rt,Dt,cn),he(wt,lt,bt,Mt,Dt,cn);else{const on=te(Re,rt),En=te(wt,lt),Hn=te(bt,Mt);j.emplaceBack(on,En,Hn)}}return he(0,0,32,32,32,0),he(32,32,0,0,0,32),{vertices:z,indices:j}}(this.tileID.canonical,i);u=_.vertices,f=_.indices}else{u=new An,f=new Ti;for(const{x:b,y:E}of a)u.emplaceBack(b,E,0,0);const _=Lu(u.int16,void 0,4);for(let b=0;b<_.length;b+=3)f.emplaceBack(_[b],_[b+1],_[b+2])}this._tileBoundsBuffer=e.createVertexBuffer(u,dy.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(f),this._tileBoundsSegments=Cr.simpleSegment(0,0,u.length,f.length)}_makeGlobeTileDebugBuffers(e,i){const a=i.projection;if(!a||"globe"!==a.name||i.freezeTileCoverage)return;const u=this.tileID.canonical,f=nu(Sm(u,i)),_=Iu(i.zoom);let b;_>0&&(b=Gp(new Float64Array(16),i.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,u,i,f,b,_),this._makeGlobeTileDebugTextBuffer(e,u,i,f,b,_)}_globePoint(e,i,a,u,f,_,b){let E=Cl(e,i,a);if(_){const D=1<<a.z,k=$a(u.center.lng),z=al(u.center.lat),j=(a.x+.5)/D-k;let K=0;j>.5?K=-1:j<-.5&&(K=1);let te=(e/Li+a.x)/D+K,he=(i/Li+a.y)/D;te=(te-k)*u._pixelsPerMercatorPixel+k,he=(he-z)*u._pixelsPerMercatorPixel+z;const Re=[te*u.worldSize,he*u.worldSize,0];zr(Re,Re,_),E=ql(E,Re,b)}return zr(E,E,f)}_makeGlobeTileDebugBorderBuffer(e,i,a,u,f,_){const b=new Wn,E=new _s,D=new nn,k=(j,K,te,he,Re)=>{const rt=(te-j)/(Re-1),wt=(he-K)/(Re-1),lt=b.length;for(let bt=0;bt<Re;bt++){const Mt=j+bt*rt,Dt=K+bt*wt;b.emplaceBack(Mt,Dt);const cn=this._globePoint(Mt,Dt,i,a,u,f,_);D.emplaceBack(cn[0],cn[1],cn[2]),E.emplaceBack(lt+bt)}},z=Li;k(0,0,z,0,16),k(z,0,z,z,16),k(z,z,0,z,16),k(0,z,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(E),this._tileDebugBuffer=e.createVertexBuffer(b,Dd.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(D,Xp.members),this._tileDebugSegments=Cr.simpleSegment(0,0,b.length,E.length)}_makeGlobeTileDebugTextBuffer(e,i,a,u,f,_){const b=Li/4,E=new Wn,D=new Ti,k=new nn,z=25;D.reserve(32),E.reserve(z),k.reserve(z);const j=(K,te)=>z*K+te;for(let K=0;K<z;K++){const te=K*b;for(let he=0;he<z;he++){const Re=he*b;E.emplaceBack(Re,te);const rt=this._globePoint(Re,te,i,a,u,f,_);k.emplaceBack(rt[0],rt[1],rt[2])}}for(let K=0;K<4;K++)for(let te=0;te<4;te++){const he=j(K,te),Re=j(K,te+1),rt=j(K+1,te),wt=j(K+1,te+1);D.emplaceBack(he,Re,rt),D.emplaceBack(rt,Re,wt)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(D),this._tileDebugTextBuffer=e.createVertexBuffer(E,Dd.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(k,Xp.members),this._tileDebugTextSegments=Cr.simpleSegment(0,0,z,32)}}class Ag{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,i,a){const u=String(i);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][u]=this.stateChanges[e][u]||{},Ue(this.stateChanges[e][u],a),null===this.deletedStates[e]){this.deletedStates[e]={};for(const f in this.state[e])f!==u&&(this.deletedStates[e][f]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][u]){this.deletedStates[e][u]={};for(const f in this.state[e][u])a[f]||(this.deletedStates[e][u][f]=null)}else for(const f in a)this.deletedStates[e]&&this.deletedStates[e][u]&&null===this.deletedStates[e][u][f]&&delete this.deletedStates[e][u][f]}removeFeatureState(e,i,a){if(null===this.deletedStates[e])return;const u=String(i);if(this.deletedStates[e]=this.deletedStates[e]||{},a&&void 0!==i)null!==this.deletedStates[e][u]&&(this.deletedStates[e][u]=this.deletedStates[e][u]||{},this.deletedStates[e][u][a]=null);else if(void 0!==i)if(this.stateChanges[e]&&this.stateChanges[e][u])for(a in this.deletedStates[e][u]={},this.stateChanges[e][u])this.deletedStates[e][u][a]=null;else this.deletedStates[e][u]=null;else this.deletedStates[e]=null}getState(e,i){const a=String(i),u=Ue({},(this.state[e]||{})[a],(this.stateChanges[e]||{})[a]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const f=this.deletedStates[e][i];if(null===f)return{};for(const _ in f)delete u[_]}return u}initializeTileState(e,i){e.setFeatureState(this.state,i)}coalesceChanges(e,i){const a={};for(const u in this.stateChanges){this.state[u]=this.state[u]||{};const f={};for(const _ in this.stateChanges[u])this.state[u][_]||(this.state[u][_]={}),Ue(this.state[u][_],this.stateChanges[u][_]),f[_]=this.state[u][_];a[u]=f}for(const u in this.deletedStates){this.state[u]=this.state[u]||{};const f={};if(null===this.deletedStates[u])for(const _ in this.state[u])f[_]={},this.state[u][_]={};else for(const _ in this.deletedStates[u]){if(null===this.deletedStates[u][_])this.state[u][_]={};else if(this.state[u][_])for(const b of Object.keys(this.deletedStates[u][_]))delete this.state[u][_][b];f[_]=this.state[u][_]}a[u]=a[u]||{},Ue(a[u],f)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(a).length)for(const u in e)e[u].setFeatureState(a,i)}}class Sg{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,i){const a=this.toIdx(e,i);return{min:this.minimums[a],max:this.maximums[a]}}isLeaf(e,i){return this.leaves[this.toIdx(e,i)]}toIdx(e,i){return i*this.size+e}}function Pg(t,e,i,a){let u=0,f=Number.MAX_VALUE;for(let _=0;_<3;_++)if(Math.abs(a[_])<1e-15){if(i[_]<t[_]||i[_]>e[_])return null}else{const b=1/a[_];let E=(t[_]-i[_])*b,D=(e[_]-i[_])*b;if(E>D){const k=E;E=D,D=k}if(E>u&&(u=E),D<f&&(f=D),u>f)return null}return u}function em(t,e,i,a,u,f,_,b,E,D,k){const z=a-t,j=u-e,K=f-i,te=_-t,he=b-e,Re=E-i,rt=k[1]*Re-k[2]*he,wt=k[2]*te-k[0]*Re,lt=k[0]*he-k[1]*te,bt=z*rt+j*wt+K*lt;if(Math.abs(bt)<1e-15)return null;const Mt=1/bt,Dt=D[0]-t,cn=D[1]-e,on=D[2]-i,En=(Dt*rt+cn*wt+on*lt)*Mt;if(En<0||En>1)return null;const Hn=cn*K-on*j,fn=on*z-Dt*K,kn=Dt*j-cn*z,Fn=(k[0]*Hn+k[1]*fn+k[2]*kn)*Mt;return Fn<0||En+Fn>1?null:(te*Hn+he*fn+Re*kn)*Mt}function tm(t,e,i){return(t-e)/(i-e)}function sd(t,e,i,a,u,f,_,b,E){const D=1<<i,k=f-a,z=_-u,j=(t+1)/D*k+a,K=(e+0)/D*z+u,te=(e+1)/D*z+u;b[0]=(t+0)/D*k+a,b[1]=K,E[0]=j,E[1]=te}class Og{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const i=function(f){const _=Math.ceil(Math.log2(f.dim/8)),b=[];let E=Math.ceil(Math.pow(2,_));const D=1/E,k=(K,te,he,Re,rt)=>{const wt=Re?1:0,lt=(K+1)*he-wt,bt=te*he,Mt=(te+1)*he-wt;rt[0]=K*he,rt[1]=bt,rt[2]=lt,rt[3]=Mt};let z=new Sg(E);const j=[];for(let K=0;K<E*E;K++){k(K%E,Math.floor(K/E),D,!1,j);const te=tc(j[0],j[1],f),he=tc(j[2],j[1],f),Re=tc(j[2],j[3],f),rt=tc(j[0],j[3],f);z.minimums.push(Math.min(te,he,Re,rt)),z.maximums.push(Math.max(te,he,Re,rt)),z.leaves.push(1)}for(b.push(z),E/=2;E>=1;E/=2){const K=b[b.length-1];z=new Sg(E);for(let te=0;te<E*E;te++){k(te%E,Math.floor(te/E),2,!0,j);const he=K.getElevation(j[0],j[1]),Re=K.getElevation(j[2],j[1]),rt=K.getElevation(j[2],j[3]),wt=K.getElevation(j[0],j[3]),lt=K.isLeaf(j[0],j[1]),bt=K.isLeaf(j[2],j[1]),Mt=K.isLeaf(j[2],j[3]),Dt=K.isLeaf(j[0],j[3]),cn=Math.min(he.min,Re.min,rt.min,wt.min),on=Math.max(he.max,Re.max,rt.max,wt.max),En=lt&&bt&&Mt&&Dt;z.maximums.push(on),z.minimums.push(cn),z.leaves.push(on-cn<=5&&En?1:0)}b.push(z)}return b}(this.dem),a=i.length-1,u=i[a];this._addNode(u.minimums[0],u.maximums[0],u.leaves[0]),this._construct(i,0,0,a,0)}raycastRoot(e,i,a,u,f,_,b=1){return Pg([e,i,-100],[a,u,this.maximums[0]*b],f,_)}raycast(e,i,a,u,f,_,b=1){if(!this.nodeCount)return null;const E=this.raycastRoot(e,i,a,u,f,_,b);if(null==E)return null;const D=[],k=[],z=[],j=[],K=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;K.length>0;){const{idx:te,t:he,nodex:Re,nodey:rt,depth:wt}=K.pop();if(this.leaves[te]){sd(Re,rt,wt,e,i,a,u,z,j);const bt=1<<wt,Mt=(Re+0)/bt,Dt=(Re+1)/bt,cn=(rt+0)/bt,on=(rt+1)/bt,En=tc(Mt,cn,this.dem)*b,Hn=tc(Dt,cn,this.dem)*b,fn=tc(Dt,on,this.dem)*b,kn=tc(Mt,on,this.dem)*b,Fn=em(z[0],z[1],En,j[0],z[1],Hn,j[0],j[1],fn,f,_),Vn=em(j[0],j[1],fn,z[0],j[1],kn,z[0],z[1],En,f,_),Jn=Math.min(null!==Fn?Fn:Number.MAX_VALUE,null!==Vn?Vn:Number.MAX_VALUE);if(Jn!==Number.MAX_VALUE)return Jn;{const Cn=Cd([],f,_,he);if(nm(En,Hn,kn,fn,tm(Cn[0],z[0],j[0]),tm(Cn[1],z[1],j[1]))>=Cn[2])return he}continue}let lt=0;for(let bt=0;bt<this._siblingOffset.length;bt++){sd((Re<<1)+this._siblingOffset[bt][0],(rt<<1)+this._siblingOffset[bt][1],wt+1,e,i,a,u,z,j),z[2]=-100,j[2]=this.maximums[this.childOffsets[te]+bt]*b;const Mt=Pg(z,j,f,_);if(null!=Mt){const Dt=Mt;D[bt]=Dt;let cn=!1;for(let on=0;on<lt&&!cn;on++)Dt>=D[k[on]]&&(k.splice(on,0,bt),cn=!0);cn||(k[lt]=bt),lt++}}for(let bt=0;bt<lt;bt++){const Mt=k[bt];K.push({idx:this.childOffsets[te]+Mt,t:D[Mt],nodex:(Re<<1)+this._siblingOffset[Mt][0],nodey:(rt<<1)+this._siblingOffset[Mt][1],depth:wt+1})}}return null}_addNode(e,i,a){return this.minimums.push(e),this.maximums.push(i),this.leaves.push(a),this.childOffsets.push(0),this.nodeCount++}_construct(e,i,a,u,f){if(1===e[u].isLeaf(i,a))return;this.childOffsets[f]||(this.childOffsets[f]=this.nodeCount);const _=u-1,b=e[_];let E=0,D=0;for(let k=0;k<this._siblingOffset.length;k++){const z=2*i+this._siblingOffset[k][0],j=2*a+this._siblingOffset[k][1],K=b.getElevation(z,j),te=b.isLeaf(z,j),he=this._addNode(K.min,K.max,te);te&&(E|=1<<k),D||(D=he)}for(let k=0;k<this._siblingOffset.length;k++)E&1<<k||this._construct(e,2*i+this._siblingOffset[k][0],2*a+this._siblingOffset[k][1],_,D+k)}}function nm(t,e,i,a,u,f){return Xn(Xn(t,i,f),Xn(e,a,f),u)}function tc(t,e,i){const a=i.dim,u=ye(t*a-.5,0,a-1),f=ye(e*a-.5,0,a-1),_=Math.floor(u),b=Math.floor(f),E=Math.min(_+1,a-1),D=Math.min(b+1,a-1);return nm(i.get(_,b),i.get(E,b),i.get(_,D),i.get(E,D),u-_,f-b)}const Rg={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function hy(t,e,i){return(256*t*256+256*e+i)/10-1e4}function ch(t,e,i){return 256*t+e+i/256-32768}class bp{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,i,a,u=!1,f=!1){if(this.uid=e,i.height!==i.width)throw new RangeError("DEM tiles must be square");if(a&&"mapbox"!==a&&"terrarium"!==a)return It(`"${a}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=i.height;const _=this.dim=i.height-2,b=new Uint32Array(i.data.buffer);if(this.pixels=new Uint8Array(i.data.buffer),this.encoding=a||"mapbox",this.borderReady=u,!u){for(let E=0;E<_;E++)b[this._idx(-1,E)]=b[this._idx(0,E)],b[this._idx(_,E)]=b[this._idx(_-1,E)],b[this._idx(E,-1)]=b[this._idx(E,0)],b[this._idx(E,_)]=b[this._idx(E,_-1)];b[this._idx(-1,-1)]=b[this._idx(0,0)],b[this._idx(_,-1)]=b[this._idx(_-1,0)],b[this._idx(-1,_)]=b[this._idx(0,_-1)],b[this._idx(_,_)]=b[this._idx(_-1,_-1)],f&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Og(this)}get(e,i,a=!1){a&&(e=ye(e,-1,this.dim),i=ye(i,-1,this.dim));const u=4*this._idx(e,i);return("terrarium"===this.encoding?ch:hy)(this.pixels[u],this.pixels[u+1],this.pixels[u+2])}static getUnpackVector(e){return Rg[e]}get unpackVector(){return Rg[this.encoding]}_idx(e,i){if(e<-1||e>=this.dim+1||i<-1||i>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(i+1)*this.stride+(e+1)}static pack(e,i){const a=[0,0,0,0],u=bp.getUnpackVector(i);let f=Math.floor((e+u[3])/u[2]);return a[2]=f%256,f=Math.floor(f/256),a[1]=f%256,f=Math.floor(f/256),a[0]=f,a}getPixels(){return new Ta({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,i,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let u=i*this.dim,f=i*this.dim+this.dim,_=a*this.dim,b=a*this.dim+this.dim;switch(i){case-1:u=f-1;break;case 1:f=u+1}switch(a){case-1:_=b-1;break;case 1:b=_+1}const E=-i*this.dim,D=-a*this.dim;for(let k=_;k<b;k++)for(let z=u;z<f;z++){const j=4*this._idx(z,k),K=4*this._idx(z+E,k+D);this.pixels[j+0]=e.pixels[K+0],this.pixels[j+1]=e.pixels[K+1],this.pixels[j+2]=e.pixels[K+2],this.pixels[j+3]=e.pixels[K+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}di(bp,"DEMData"),di(Og,"DemMinMaxQuadTree",{omit:["dem"]});class Dv{constructor(e,i){this.max=e,this.onRemove=i,this.reset()}reset(){for(const e in this.data)for(const i of this.data[e])i.timeout&&clearTimeout(i.timeout),this.onRemove(i.value);return this.data={},this.order=[],this}add(e,i,a){const u=e.wrapped().key;void 0===this.data[u]&&(this.data[u]=[]);const f={value:i,timeout:void 0};if(void 0!==a&&(f.timeout=setTimeout(()=>{this.remove(e,f)},a)),this.data[u].push(f),this.order.push(u),this.order.length>this.max){const _=this._getAndRemoveByKey(this.order[0]);_&&this.onRemove(_)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const i=this.data[e].shift();return i.timeout&&clearTimeout(i.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),i.value}getByKey(e){const i=this.data[e];return i?i[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,i){if(!this.has(e))return this;const a=e.wrapped().key,u=void 0===i?0:this.data[a].indexOf(i),f=this.data[a][u];return this.data[a].splice(u,1),f.timeout&&clearTimeout(f.timeout),0===this.data[a].length&&delete this.data[a],this.onRemove(f.value),this.order.splice(this.order.indexOf(a),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const i=this._getAndRemoveByKey(this.order[0]);i&&this.onRemove(i)}return this}filter(e){const i=[];for(const a in this.data)for(const u of this.data[a])e(u.value)||i.push(u);for(const a of i)this.remove(a.value.tileID,a)}}class ad{constructor(e,i,a){this.func=e,this.mask=i,this.range=a}}ad.ReadOnly=!1,ad.ReadWrite=!0,ad.disabled=new ad(519,ad.ReadOnly,[0,1]);class om{constructor(e,i,a,u,f,_){this.test=e,this.ref=i,this.mask=a,this.fail=u,this.depthFail=f,this.pass=_}}om.disabled=new om({func:519,mask:0},0,0,7680,7680,7680);class Pl{constructor(e,i,a){this.blendFunction=e,this.blendColor=i,this.mask=a}}Pl.Replace=[1,0],Pl.disabled=new Pl(Pl.Replace,wo.transparent,[!1,!1,!1,!1]),Pl.unblended=new Pl(Pl.Replace,wo.transparent,[!0,!0,!0,!0]),Pl.alphaBlended=new Pl([1,771],wo.transparent,[!0,!0,!0,!0]);class dl{constructor(e,i,a){this.enable=e,this.mode=i,this.frontFace=a}}dl.disabled=new dl(!1,1029,2305),dl.backCCW=new dl(!0,1029,2305),dl.backCW=new dl(!0,1029,2304),dl.frontCW=new dl(!0,1028,2304),dl.frontCCW=new dl(!0,1028,2305);class Ac extends uo{constructor(e,i,a){super(),this.id=e,this._onlySymbols=a,i.on("data",u=>{"source"===u.dataType&&"metadata"===u.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===u.dataType&&"content"===u.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),i.on("error",()=>{this._sourceErrored=!0}),this._source=i,this._tiles={},this._cache=new Dv(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=i.minTileCacheSize,this._maxTileCacheSize=i.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Ag,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const i=this._tiles[e];if("loaded"!==i.state&&"errored"!==i.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,i){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,i)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const i in this._tiles){const a=this._tiles[i];a.upload(e),a.prepare(this.map.style.imageManager)}}getIds(){return ct(this._tiles).map(e=>e.tileID).sort(wp).map(e=>e.key)}getRenderableIds(e){const i=[];for(const a in this._tiles)this._isIdRenderable(+a,e)&&i.push(this._tiles[a]);return e?i.sort((a,u)=>{const f=a.tileID,_=u.tileID,b=new Ce(f.canonical.x,f.canonical.y)._rotate(this.transform.angle),E=new Ce(_.canonical.x,_.canonical.y)._rotate(this.transform.angle);return f.overscaledZ-_.overscaledZ||E.y-b.y||E.x-b.x}).map(a=>a.tileID.key):i.map(a=>a.tileID).sort(wp).map(a=>a.key)}hasRenderableParent(e){const i=this.findLoadedParent(e,0);return!!i&&this._isIdRenderable(i.tileID.key)}_isIdRenderable(e,i){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(i||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,i){const a=this._tiles[e];a&&("loading"!==a.state&&(a.state=i),this._loadTile(a,this._tileLoaded.bind(this,a,e,i)))}_tileLoaded(e,i,a,u){if(u)if(e.state="errored",404!==u.status)this._source.fire(new Pi(u,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const f=this.map.painter.terrain;this.update(this.transform,f.getScaledDemTileSize(),!0),f.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Ao.now(),"expired"===a&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(i,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new io("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const i=this.getRenderableIds();for(let u=0;u<i.length;u++){const f=i[u];if(e.neighboringTiles&&e.neighboringTiles[f]){const _=this.getTileByID(f);a(e,_),a(_,e)}}function a(u,f){if(!u.dem||u.dem.borderReady)return;u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0;let _=f.tileID.canonical.x-u.tileID.canonical.x;const b=f.tileID.canonical.y-u.tileID.canonical.y,E=Math.pow(2,u.tileID.canonical.z),D=f.tileID.key;0===_&&0===b||Math.abs(b)>1||(Math.abs(_)>1&&(1===Math.abs(_+E)?_+=E:1===Math.abs(_-E)&&(_-=E)),f.dem&&u.dem&&(u.dem.backfillBorder(f.dem,_,b),u.neighboringTiles&&u.neighboringTiles[D]&&(u.neighboringTiles[D].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,i,a,u){for(const f in this._tiles){let _=this._tiles[f];if(u[f]||!_.hasData()||_.tileID.overscaledZ<=i||_.tileID.overscaledZ>a)continue;let b=_.tileID;for(;_&&_.tileID.overscaledZ>i+1;){const D=_.tileID.scaledTo(_.tileID.overscaledZ-1);_=this._tiles[D.key],_&&_.hasData()&&(b=D)}let E=b;for(;E.overscaledZ>i;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]){u[b.key]=b;break}}}findLoadedParent(e,i){if(e.key in this._loadedParentTiles){const a=this._loadedParentTiles[e.key];return a&&a.tileID.overscaledZ>=i?a:null}for(let a=e.overscaledZ-1;a>=i;a--){const u=e.scaledTo(a),f=this._getLoadedTile(u);if(f)return f}}_getLoadedTile(e){const i=this._tiles[e.key];return i&&i.hasData()?i:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,i){i=i||this._source.tileSize;const a=Math.ceil(e.width/i)+1,u=Math.ceil(e.height/i)+1,f=Math.floor(a*u*5),_="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,f):f,b="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,_):_;this._cache.setMaxSize(b)}handleWrapJump(e){const i=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,i){const a={};for(const u in this._tiles){const f=this._tiles[u];f.tileID=f.tileID.unwrapTo(f.tileID.wrap+i),a[f.tileID.key]=f}this._tiles=a;for(const u in this._timers)clearTimeout(this._timers[u]),delete this._timers[u];for(const u in this._tiles)this._setTileReloadTimer(+u,this._tiles[u])}}update(e,i,a){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!a)return;let u;this.updateCacheSize(e,i),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?u=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(b=>new Is(b.canonical.z,b.wrap,b.canonical.z,b.canonical.x,b.canonical.y)):(u=e.coveringTiles({tileSize:i||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!a,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(u=u.filter(b=>this._source.hasTile(b)))):u=[];const f=this._updateRetainedTiles(u);if(Lg(this._source.type)&&0!==u.length){const b={},E={},D=Object.keys(f);for(const z of D){const j=f[z],K=this._tiles[z];if(!K||K.fadeEndTime&&K.fadeEndTime<=Ao.now())continue;const te=this.findLoadedParent(j,Math.max(j.overscaledZ-Ac.maxOverzooming,this._source.minzoom));te&&(this._addTile(te.tileID),b[te.tileID.key]=te.tileID),E[z]=j}const k=u[u.length-1].overscaledZ;for(const z in this._tiles){const j=this._tiles[z];if(f[z]||!j.hasData())continue;let K=j.tileID;for(;K.overscaledZ>k;){K=K.scaledTo(K.overscaledZ-1);const te=this._tiles[K.key];if(te&&te.hasData()&&E[K.key]){f[z]=j.tileID;break}}}for(const z in b)f[z]||(this._coveredTiles[z]=!0,f[z]=b[z])}for(const b in f)this._tiles[b].clearFadeHold();const _=function(b,E){const D=[];for(const k in b)k in E||D.push(k);return D}(this._tiles,f);for(const b of _){const E=this._tiles[b];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+b)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const i={};if(0===e.length)return i;const a={},u=e.reduce((D,k)=>Math.min(D,k.overscaledZ),1/0),f=e[0].overscaledZ,_=Math.max(f-Ac.maxOverzooming,this._source.minzoom),b=Math.max(f+Ac.maxUnderzooming,this._source.minzoom),E={};for(const D of e){const k=this._addTile(D);i[D.key]=D,k.hasData()||u<this._source.maxzoom&&(E[D.key]=D)}this._retainLoadedChildren(E,u,b,i);for(const D of e){let k=this._tiles[D.key];if(k.hasData())continue;if(D.canonical.z>=this._source.maxzoom){const j=D.children(this._source.maxzoom)[0],K=this.getTile(j);if(K&&K.hasData()){i[j.key]=j;continue}}else{const j=D.children(this._source.maxzoom);if(i[j[0].key]&&i[j[1].key]&&i[j[2].key]&&i[j[3].key])continue}let z=k.wasRequested();for(let j=D.overscaledZ-1;j>=_;--j){const K=D.scaledTo(j);if(a[K.key]||(a[K.key]=!0,k=this.getTile(K),!k&&z&&(k=this._addTile(K)),k&&(i[K.key]=K,z=k.wasRequested(),k.hasData())))break}}return i}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const i=[];let a,u=this._tiles[e].tileID;for(;u.overscaledZ>0;){if(u.key in this._loadedParentTiles){a=this._loadedParentTiles[u.key];break}i.push(u.key);const f=u.scaledTo(u.overscaledZ-1);if(a=this._getLoadedTile(f),a)break;u=f}for(const f of i)this._loadedParentTiles[f]=a}}_addTile(e){let i=this._tiles[e.key];if(i)return i;i=this._cache.getAndRemove(e),i&&(this._setTileReloadTimer(e.key,i),i.tileID=e,this._state.initializeTileState(i,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,i)));const a=!!i;if(!a){const u=this.map?this.map.painter:null;i=new xp(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,u,this._isRaster),this._loadTile(i,this._tileLoaded.bind(this,i,e.key,i.state))}return i?(i.uses++,this._tiles[e.key]=i,a||this._source.fire(new io("dataloading",{tile:i,coord:i.tileID,dataType:"source"})),i):null}_setTileReloadTimer(e,i){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const a=i.getExpiryTimeout();a&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},a))}_removeTile(e){const i=this._tiles[e];i&&(i.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),i.uses>0||(i.hasData()&&"reloading"!==i.state?this._cache.add(i.tileID,i,i.getExpiryTimeout()):(i.aborted=!0,this._abortTile(i),this._unloadTile(i))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,i,a){const u=[],f=this.transform;if(!f)return u;const _="globe"===f.projection.name,b=$a(f.center.lng);for(const E in this._tiles){const D=this._tiles[E];if(a&&D.clearQueryDebugViz(),D.holdingForFade())continue;let k;if(_){const z=D.tileID.canonical;if(0===z.z){const j=[Math.abs(ye(b,...Sc(z,-1))-b),Math.abs(ye(b,...Sc(z,1))-b)];k=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(ye(b,...Sc(z,-1))-b),Math.abs(ye(b,...Sc(z,0))-b),Math.abs(ye(b,...Sc(z,1))-b)];k=[j.indexOf(Math.min(...j))-1]}}else k=[0];for(const z of k){const j=e.containsTile(D,f,i,z);j&&u.push(j)}}return u}getVisibleCoordinates(e){const i=this.getRenderableIds(e).map(a=>this._tiles[a].tileID);for(const a of i)a.projMatrix=this.transform.calculateProjMatrix(a.toUnwrapped());return i}hasTransition(){if(this._source.hasTransition())return!0;if(Lg(this._source.type))for(const e in this._tiles){const i=this._tiles[e];if(void 0!==i.fadeEndTime&&i.fadeEndTime>=Ao.now())return!0}return!1}setFeatureState(e,i,a){this._state.updateState(e=e||"_geojsonTileLayer",i,a)}removeFeatureState(e,i,a){this._state.removeFeatureState(e=e||"_geojsonTileLayer",i,a)}getFeatureState(e,i){return this._state.getState(e=e||"_geojsonTileLayer",i)}setDependencies(e,i,a){const u=this._tiles[e];u&&u.setDependencies(i,a)}reloadTilesForDependencies(e,i){for(const a in this._tiles)this._tiles[a].hasDependency(e,i)&&this._reloadTile(+a,"reloading");this._cache.filter(a=>!a.hasDependency(e,i))}_preloadTiles(e,i){if(!this._sourceLoaded){const b=()=>{this._sourceLoaded&&(this._source.off("data",b),this._preloadTiles(e,i))};return void this._source.on("data",b)}const a=new Map,u=Array.isArray(e)?e:[e],f=this.map.painter.terrain,_=this.usedForTerrain&&f?f.getScaledDemTileSize():this._source.tileSize;for(const b of u){const E=b.coveringTiles({tileSize:_,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const D of E)a.set(D.key,D);this.usedForTerrain&&b.updateElevation(!1)}gt(Array.from(a.values()),(b,E)=>{const D=new xp(b,this._source.tileSize*b.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(D,k=>{"raster-dem"===this._source.type&&D.dem&&this._backfillDEM(D),E(k,D)})},i)}}function wp(t,e){const i=Math.abs(2*t.wrap)-+(t.wrap<0),a=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||a-i||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Lg(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function Sc(t,e){const i=1<<t.z;return[t.x/i+e,(t.x+1)/i+e]}Ac.maxOverzooming=10,Ac.maxUnderzooming=3;class Tp{constructor(e,i,a){this._demTile=e,this._dem=this._demTile.dem,this._scale=i,this._offset=a}static create(e,i,a){const u=a||e.findDEMTileFor(i);if(!u||!u.dem)return;const f=u.dem,_=u.tileID,b=1<<i.canonical.z-_.canonical.z;return new Tp(u,u.tileSize/Li/b,[(i.canonical.x/b-_.canonical.x)*f.dim,(i.canonical.y/b-_.canonical.y)*f.dim])}tileCoordToPixel(e,i){const a=i*this._scale+this._offset[1],u=Math.floor(e*this._scale+this._offset[0]),f=Math.floor(a);return new Ce(u,f)}getElevationAt(e,i,a,u){const f=e*this._scale+this._offset[0],_=i*this._scale+this._offset[1],b=Math.floor(f),E=Math.floor(_),D=this._dem;return u=!!u,a?Xn(Xn(D.get(b,E,u),D.get(b,E+1,u),_-E),Xn(D.get(b+1,E,u),D.get(b+1,E+1,u),_-E),f-b):D.get(b,E,u)}getElevationAtPixel(e,i,a){return this._dem.get(e,i,!!a)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Zs(1,e)*this._dem.stride}}class kg{constructor(e,i){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new za(Li,16,0),this.featureIndexArray=new bu,this.promoteId=i}insert(e,i,a,u,f,_=0){const b=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,u,f,_);const E=this.grid;for(let D=0;D<i.length;D++){const k=i[D],z=[1/0,1/0,-1/0,-1/0];for(let j=0;j<k.length;j++){const K=k[j];z[0]=Math.min(z[0],K.x),z[1]=Math.min(z[1],K.y),z[2]=Math.max(z[2],K.x),z[3]=Math.max(z[3],K.y)}z[0]<Li&&z[1]<Li&&z[2]>=0&&z[3]>=0&&E.insert(b,z[0],z[1],z[2],z[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new $d(new ip(this.rawTileData)).layers,this.sourceLayerCoder=new vp(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,i,a,u){this.loadVTLayers();const f=e.params||{},_=dc(f.filter),b=e.tileResult,E=e.transform,D=b.bufferedTilespaceBounds,k=this.grid.query(D.min.x,D.min.y,D.max.x,D.max.y,(te,he,Re,rt)=>ru(b.bufferedTilespaceGeometry,te,he,Re,rt));k.sort(py);let z=null;E.elevation&&k.length>0&&(z=Tp.create(E.elevation,this.tileID));const j={};let K;for(let te=0;te<k.length;te++){const he=k[te];if(he===K)continue;K=he;const Re=this.featureIndexArray.get(he);let rt=null;this.loadMatchingFeature(j,Re,_,f.layers,f.availableImages,i,a,u,(wt,lt,bt,Mt=0)=>(rt||(rt=Dl(wt,this.tileID.canonical,e.tileTransform)),lt.queryIntersectsFeature(b,wt,bt,rt,this.z,e.transform,e.pixelPosMatrix,z,Mt)))}return j}loadMatchingFeature(e,i,a,u,f,_,b,E,D){const{featureIndex:k,bucketIndex:z,sourceLayerIndex:j,layoutVertexArrayOffset:K}=i,te=this.bucketLayerIDs[z];if(u&&!function(wt,lt){for(let bt=0;bt<wt.length;bt++)if(lt.indexOf(wt[bt])>=0)return!0;return!1}(u,te))return;const he=this.sourceLayerCoder.decode(j),Re=this.vtLayers[he].feature(k);if(a.needGeometry){const wt=Yl(Re,!0);if(!a.filter(new N(this.tileID.overscaledZ),wt,this.tileID.canonical))return}else if(!a.filter(new N(this.tileID.overscaledZ),Re))return;const rt=this.getId(Re,he);for(let wt=0;wt<te.length;wt++){const lt=te[wt];if(u&&u.indexOf(lt)<0)continue;const bt=_[lt];if(!bt)continue;let Mt={};void 0!==rt&&E&&(Mt=E.getState(bt.sourceLayer||"_geojsonTileLayer",rt));const Dt=Ue({},b[lt]);Dt.paint=Fg(Dt.paint,bt.paint,Re,Mt,f),Dt.layout=Fg(Dt.layout,bt.layout,Re,Mt,f);const cn=!D||D(Re,bt,Mt,K);if(!cn)continue;const on=new Mg(Re,this.z,this.x,this.y,rt);on.layer=Dt;let En=e[lt];void 0===En&&(En=e[lt]=[]),En.push({featureIndex:k,feature:on,intersectionZ:cn})}}lookupSymbolFeatures(e,i,a,u,f,_,b,E){const D={};this.loadVTLayers();const k=dc(f);for(const z of e)this.loadMatchingFeature(D,{bucketIndex:a,sourceLayerIndex:u,featureIndex:z,layoutVertexArrayOffset:0},k,_,b,E,i);return D}loadFeature(e){const{featureIndex:i,sourceLayerIndex:a}=e;this.loadVTLayers();const u=this.sourceLayerCoder.decode(a),f=this.vtFeatures[u];if(f[i])return f[i];const _=this.vtLayers[u].feature(i);return f[i]=_,_}hasLayer(e){for(const i of this.bucketLayerIDs)for(const a of i)if(e===a)return!0;return!1}getId(e,i){let a=e.id;if(this.promoteId){const u="string"==typeof this.promoteId?this.promoteId:this.promoteId[i];null!=u&&(a=e.properties[u]),"boolean"==typeof a&&(a=Number(a))}return a}}function Fg(t,e,i,a,u){return Xt(t,(f,_)=>{const b=e instanceof ot?e.get(_):null;return b&&b.evaluate?b.evaluate(i,a,u):b})}function py(t,e){return e-t}di(kg,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class Bg{constructor(e,i){this.width=e,this.height=i,this.nextRow=0,this.image=new Kl({width:e,height:i}),this.positions={},this.uploaded=!1}getDash(e,i){const a=this.getKey(e,i);return this.positions[a]}trim(){const e=this.width,i=this.height=Ne(this.nextRow);this.image.resize({width:e,height:i})}getKey(e,i){return e.join(",")+i}getDashRanges(e,i,a){const u=[];let f=e.length%2==1?-e[e.length-1]*a:0,_=e[0]*a,b=!0;u.push({left:f,right:_,isDash:b,zeroLength:0===e[0]});let E=e[0];for(let D=1;D<e.length;D++){b=!b;const k=e[D];f=E*a,E+=k,_=E*a,u.push({left:f,right:_,isDash:b,zeroLength:0===k})}return u}addRoundDash(e,i,a){const u=i/2;for(let f=-a;f<=a;f++){const _=this.width*(this.nextRow+a+f);let b=0,E=e[b];for(let D=0;D<this.width;D++){D/E.right>1&&(E=e[++b]);const k=Math.abs(D-E.left),z=Math.abs(D-E.right),j=Math.min(k,z);let K;const te=f/a*(u+1);if(E.isDash){const he=u-Math.abs(te);K=Math.sqrt(j*j+he*he)}else K=u-Math.sqrt(j*j+te*te);this.image.data[_+D]=Math.max(0,Math.min(255,K+128))}}}addRegularDash(e,i){for(let E=e.length-1;E>=0;--E){const D=e[E],k=e[E+1];D.zeroLength?e.splice(E,1):k&&k.isDash===D.isDash&&(k.left=D.left,e.splice(E,1))}const a=e[0],u=e[e.length-1];a.isDash===u.isDash&&(a.left=u.left-this.width,u.right=a.right+this.width);const f=this.width*this.nextRow;let _=0,b=e[_];for(let E=0;E<this.width;E++){E/b.right>1&&(b=e[++_]);const D=Math.abs(E-b.left),k=Math.abs(E-b.right),z=Math.min(D,k);this.image.data[f+E]=Math.max(0,Math.min(255,(b.isDash?z:-z)+i+128))}}addDash(e,i){const a=this.getKey(e,i);if(this.positions[a])return this.positions[a];const u="round"===i,f=u?7:0,_=2*f+1;if(this.nextRow+_>this.height)return It("LineAtlas out of space"),null;0===e.length&&e.push(1);let b=0;for(let k=0;k<e.length;k++)e[k]<0&&(It("Negative value is found in line dasharray, replacing values with 0"),e[k]=0),b+=e[k];if(0!==b){const k=this.width/b,z=this.getDashRanges(e,this.width,k);u?this.addRoundDash(z,k,f):this.addRegularDash(z,"square"===i?.5*k:0)}const E=this.nextRow+f;this.nextRow+=_;const D={tl:[E,f],br:[b,0]};return this.positions[a]=D,D}}di(Bg,"LineAtlas");const Ng=1*cl;class zg{constructor(e){const i={},a=[];for(const b in e){const E=e[b],D=i[b]={};for(const k in E.glyphs){const z=E.glyphs[+k];if(!z||0===z.bitmap.width||0===z.bitmap.height)continue;const j=z.metrics.localGlyph?Ng:1,K={x:0,y:0,w:z.bitmap.width+2*j,h:z.bitmap.height+2*j};a.push(K),D[k]=K}}const{w:u,h:f}=ug(a),_=new Kl({width:u||1,height:f||1});for(const b in e){const E=e[b];for(const D in E.glyphs){const k=E.glyphs[+D];if(!k||0===k.bitmap.width||0===k.bitmap.height)continue;const z=i[b][D],j=k.metrics.localGlyph?Ng:1;Kl.copy(k.bitmap,_,{x:0,y:0},{x:z.x+j,y:z.y+j},k.bitmap)}}this.image=_,this.positions=i}}di(zg,"GlyphAtlas");class Ug{constructor(e){this.tileID=new Is(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=uu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,i,a,u,f){this.status="parsing",this.data=e,this.collisionBoxArray=new ar;const _=new vp(Object.keys(e.layers).sort()),b=new kg(this.tileID,this.promoteId);b.bucketLayerIDs=[];const E={},D=new Bg(256,256),k={featureIndex:b,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:D,availableImages:a},z=i.familiesBySource[this.source];for(const Mt in z){const Dt=e.layers[Mt];if(!Dt)continue;let cn=!1,on=!1;for(const fn of z[Mt])"symbol"===fn[0].type?cn=!0:on=!0;if(!0===this.isSymbolTile&&!cn||!1===this.isSymbolTile&&!on)continue;1===Dt.version&&It(`Vector tile source "${this.source}" layer "${Mt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const En=_.encode(Mt),Hn=[];for(let fn=0;fn<Dt.length;fn++){const kn=Dt.feature(fn),Fn=b.getId(kn,Mt);Hn.push({feature:kn,id:Fn,index:fn,sourceLayerIndex:En})}for(const fn of z[Mt]){const kn=fn[0];void 0!==this.isSymbolTile&&"symbol"===kn.type!==this.isSymbolTile||kn.minzoom&&this.zoom<Math.floor(kn.minzoom)||kn.maxzoom&&this.zoom>=kn.maxzoom||"none"!==kn.visibility&&(Cp(fn,this.zoom,a),(E[kn.id]=kn.createBucket({index:b.bucketLayerIDs.length,layers:fn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:En,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:a})).populate(Hn,k,this.tileID.canonical,this.tileTransform),b.bucketLayerIDs.push(fn.map(Fn=>Fn.id)))}}let j,K,te,he;D.trim();const Re={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},rt=()=>{if(j)return f(j);if(K&&te&&he){const Mt=new zg(K),Dt=new eh(te,he);for(const cn in E){const on=E[cn];on instanceof Mc?(Cp(on.layers,this.zoom,a),ih(on,K,Mt.positions,te,Dt.iconPositions,this.showCollisionBoxes,a,this.tileID.canonical,this.tileZoom,this.projection)):on.hasPattern&&(on instanceof qh||on instanceof Uh||on instanceof wc)&&(Cp(on.layers,this.zoom,a),on.addFeatures(k,this.tileID.canonical,Dt.patternPositions,a,this.tileTransform))}this.status="done",f(null,{buckets:ct(E).filter(cn=>!cn.isEmpty()),featureIndex:b,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Mt.image,lineAtlas:D,imageAtlas:Dt,glyphMap:this.returnDependencies?K:null,iconMap:this.returnDependencies?te:null,glyphPositions:this.returnDependencies?Mt.positions:null})}},wt=Xt(k.glyphDependencies,Mt=>Object.keys(Mt).map(Number));Object.keys(wt).length?u.send("getGlyphs",{uid:this.uid,stacks:wt},(Mt,Dt)=>{j||(j=Mt,K=Dt,rt())},void 0,!1,Re):K={};const lt=Object.keys(k.iconDependencies);lt.length?u.send("getImages",{icons:lt,source:this.source,tileID:this.tileID,type:"icons"},(Mt,Dt)=>{j||(j=Mt,te=Dt,rt())},void 0,!1,Re):te={};const bt=Object.keys(k.patternDependencies);bt.length?u.send("getImages",{icons:bt,source:this.source,tileID:this.tileID,type:"patterns"},(Mt,Dt)=>{j||(j=Mt,he=Dt,rt())},void 0,!1,Re):he={},rt()}}function Cp(t,e,i){const a=new N(e);for(const u of t)u.recalculate(a,i)}class Zg{constructor(e){this.entries={},this.scheduler=e}request(e,i,a,u){const f=this.entries[e]=this.entries[e]||{callbacks:[]};if(f.result){const[_,b]=f.result;return this.scheduler?this.scheduler.add(()=>{u(_,b)},i):u(_,b),()=>{}}return f.callbacks.push(u),f.cancel||(f.cancel=a((_,b)=>{f.result=[_,b];for(const E of f.callbacks)this.scheduler?this.scheduler.add(()=>{E(_,b)},i):E(_,b);setTimeout(()=>delete this.entries[e],3e3)})),()=>{f.result||(f.callbacks=f.callbacks.filter(_=>_!==u),f.callbacks.length||(f.cancel(),delete this.entries[e]))}}}function fy(t,e,i){const a=JSON.stringify(t.request);return t.data&&(this.deduped.entries[a]={result:[null,t.data]}),this.deduped.request(a,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},u=>{const f=fi(t.request,(_,b,E,D)=>{_?u(_):b&&u(null,{vectorTile:i?void 0:new $d(new ip(b)),rawData:b,cacheControl:E,expires:D})});return()=>{f.cancel(),u()}},e)}const am=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ep{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[i,a]=new Uint8Array(e,0,2);if(219!==i)throw new Error("Data does not appear to be in a KDBush format.");const u=a>>4;if(1!==u)throw new Error(`Got v${u} data when expected v1.`);const f=am[15&a];if(!f)throw new Error("Unrecognized array type.");const[_]=new Uint16Array(e,2,1),[b]=new Uint32Array(e,4,1);return new Ep(b,_,f,e)}constructor(e,i=64,a=Float64Array,u){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+i,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const f=am.indexOf(this.ArrayType),_=2*e*this.ArrayType.BYTES_PER_ELEMENT,b=e*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-b%8)%8;if(f<0)throw new Error(`Unexpected typed array class: ${a}.`);u&&u instanceof ArrayBuffer?(this.data=u,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+b+E,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+_+b+E),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+b+E,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+f]),new Uint16Array(this.data,2,1)[0]=i,new Uint32Array(this.data,4,1)[0]=e)}add(e,i){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=i,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Vg(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,i,a,u){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:b}=this,E=[0,f.length-1,0],D=[];for(;E.length;){const k=E.pop()||0,z=E.pop()||0,j=E.pop()||0;if(z-j<=b){for(let Re=j;Re<=z;Re++){const rt=_[2*Re],wt=_[2*Re+1];rt>=e&&rt<=a&&wt>=i&&wt<=u&&D.push(f[Re])}continue}const K=j+z>>1,te=_[2*K],he=_[2*K+1];te>=e&&te<=a&&he>=i&&he<=u&&D.push(f[K]),(0===k?e<=te:i<=he)&&(E.push(j),E.push(K-1),E.push(1-k)),(0===k?a>=te:u>=he)&&(E.push(K+1),E.push(z),E.push(1-k))}return D}within(e,i,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:u,coords:f,nodeSize:_}=this,b=[0,u.length-1,0],E=[],D=a*a;for(;b.length;){const k=b.pop()||0,z=b.pop()||0,j=b.pop()||0;if(z-j<=_){for(let Re=j;Re<=z;Re++)Dp(f[2*Re],f[2*Re+1],e,i)<=D&&E.push(u[Re]);continue}const K=j+z>>1,te=f[2*K],he=f[2*K+1];Dp(te,he,e,i)<=D&&E.push(u[K]),(0===k?e-a<=te:i-a<=he)&&(b.push(j),b.push(K-1),b.push(1-k)),(0===k?e+a>=te:i+a>=he)&&(b.push(K+1),b.push(z),b.push(1-k))}return E}}function Vg(t,e,i,a,u,f){if(u-a<=i)return;const _=a+u>>1;uh(t,e,_,a,u,f),Vg(t,e,i,a,_-1,1-f),Vg(t,e,i,_+1,u,1-f)}function uh(t,e,i,a,u,f){for(;u>a;){if(u-a>600){const D=u-a+1,k=i-a+1,z=Math.log(D),j=.5*Math.exp(2*z/3),K=.5*Math.sqrt(z*j*(D-j)/D)*(k-D/2<0?-1:1);uh(t,e,i,Math.max(a,Math.floor(i-k*j/D+K)),Math.min(u,Math.floor(i+(D-k)*j/D+K)),f)}const _=e[2*i+f];let b=a,E=u;for(dh(t,e,a,i),e[2*u+f]>_&&dh(t,e,a,u);b<E;){for(dh(t,e,b,E),b++,E--;e[2*b+f]<_;)b++;for(;e[2*E+f]>_;)E--}e[2*a+f]===_?dh(t,e,a,E):(E++,dh(t,e,E,u)),E<=i&&(a=E+1),i<=E&&(u=E-1)}}function dh(t,e,i,a){lm(t,i,a),lm(e,2*i,2*a),lm(e,2*i+1,2*a+1)}function lm(t,e,i){const a=t[e];t[e]=t[i],t[i]=a}function Dp(t,e,i,a){const u=t-i,f=e-a;return u*u+f*f}s.ARRAY_TYPE=va,s.AUTH_ERR_MSG=yt,s.Aabb=zs,s.Actor=class{constructor(t,e,i){this.target=t,this.parent=e,this.mapId=i,this.callbacks={},this.cancelCallbacks={},Gt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=dn()?t:Q,this.scheduler=new cy}send(t,e,i,a,u=!1,f){const _=Math.round(1e18*Math.random()).toString(36).substring(0,10);i&&(i.metadata=f,this.callbacks[_]=i);const b=yi(this.globalScope)?void 0:[];return this.target.postMessage({id:_,type:t,hasCallback:!!i,targetMapId:a,mustQueue:u,sourceMapId:this.mapId,data:Hl(e,b)},b),{cancel:()=>{i&&delete this.callbacks[_],this.target.postMessage({id:_,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}receive(t){const e=t.data,i=e.id;if(i&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const a=this.cancelCallbacks[i];delete this.cancelCallbacks[i],a&&a.cancel()}else if(e.mustQueue||dn()){const a=this.callbacks[i];this.cancelCallbacks[i]=this.scheduler.add(()=>this.processTask(i,e),a&&a.metadata||{type:"message"})}else this.processTask(i,e)}processTask(t,e){if("<response>"===e.type){const i=this.callbacks[t];delete this.callbacks[t],i&&(e.error?i(vl(e.error)):i(null,vl(e.data)))}else{const i=yi(this.globalScope)?void 0:[],a=e.hasCallback?(f,_)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:f?Hl(f):null,data:Hl(_,i)},i)}:f=>{},u=vl(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,u,a);else if(this.parent.getWorkerSource){const f=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,f[0],u.source)[f[1]](u,a)}else a(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},s.CanonicalTileID=Hh,s.Color=wo,s.ColorMode=Pl,s.CullFaceMode=dl,s.DEMData=bp,s.DataConstantProperty=ue,s.DedupedRequest=Zg,s.DepthMode=ad,s.EXTENT=Li,s.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const i=e.getSource().maxzoom,a=1<<i,u=Math.floor(t.x),f=Math.floor((t.x-u)*a),_=Math.floor(t.y*a),b=this.findDEMTileFor(new Is(i,u,i,f,_));return!(!b||!b.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,i=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const a=this._source();if(!a||t.y<0||t.y>1)return e;const u=a.getSource().maxzoom,f=1<<u,_=Math.floor(t.x),b=t.x-_,E=new Is(u,_,u,Math.floor(b*f),Math.floor(t.y*f)),D=this.findDEMTileFor(E);if(!D||!D.dem)return e;const k=D.dem,z=1<<D.tileID.canonical.z,j=(b*z-D.tileID.canonical.x)*k.dim,K=(t.y*z-D.tileID.canonical.y)*k.dim,te=Math.floor(j),he=Math.floor(K);return(i?this.exaggeration():1)*Xn(Xn(k.get(te,he),k.get(te,he+1),K-he),Xn(k.get(te+1,he),k.get(te+1,he+1),K-he),j-te)}getAtTileOffset(t,e,i){const a=1<<t.canonical.z;return this.getAtPointOrZero(new Au(t.wrap+(t.canonical.x+e/Li)/a,(t.canonical.y+i/Li)/a))}getAtTileOffsetFunc(t,e,i,a){return u=>{const f=this.getAtTileOffset(t,u.x,u.y),_=a.upVector(t.canonical,u.x,u.y);return Ua(_,_,f*a.upVectorScale(t.canonical,e,i).metersToTile),_}}getForTilePoints(t,e,i,a){if(this.isUsingMockSource())return!1;const u=Tp.create(this,t,a);return!!u&&(e.forEach(f=>{f[2]=this.exaggeration()*u.getElevationAt(f[0],f[1],i)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const i=e.dem.tree,a=e.tileID,u=1<<t.canonical.z-a.canonical.z;let f=t.canonical.x/u-a.canonical.x,_=t.canonical.y/u-a.canonical.y,b=0;for(let E=0;E<t.canonical.z-a.canonical.z&&!i.leaves[b];E++){f*=2,_*=2;const D=2*Math.floor(_)+Math.floor(f);b=i.childOffsets[b]+D,f%=1,_%=1}return{min:this.exaggeration()*i.minimums[b],max:this.exaggeration()*i.maximums[b]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,i){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},s.ErrorEvent=Pi,s.EvaluationParameters=N,s.Event=io,s.Evented=uo,s.FillExtrusionBucket=wc,s.Frustum=Md,s.FrustumCorners=Ks,s.GLOBE_RADIUS=ba,s.GLOBE_SCALE_MATCH_LATITUDE=45,s.GLOBE_ZOOM_THRESHOLD_MAX=Us,s.GLOBE_ZOOM_THRESHOLD_MIN=Id,s.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_fillGridMeshWithLods(t,e){const i=new Wn,a=new Ti,u=[],f=t+1+2,_=e[0]+1,b=e[0]+1+(1+e.length),E=(D,k,z)=>{let j=D===f-1?D-2:0===D?D:D-1;return j+=z?24575:0,[j,k]};for(let D=0;D<f;++D)i.emplaceBack(...E(D,0,!0));for(let D=0;D<_;++D)for(let k=0;k<f;++k)i.emplaceBack(...E(k,D,(0===k||k===f-1)&&!0));for(let D=0;D<e.length;++D){const k=e[D];for(let z=0;z<f;++z)i.emplaceBack(...E(z,k,!0))}for(let D=0;D<e.length;++D){const k=a.length,z=e[D]+1+2,j=new Ti;for(let he=0;he<z-1;he++){const Re=he===z-2,rt=Re?f*(b-e.length+D-he):f;for(let wt=0;wt<f-1;wt++){const lt=he*f+wt;0===he||Re||0===wt||wt===f-2?(j.emplaceBack(lt+1,lt,lt+rt),j.emplaceBack(lt+rt,lt+rt+1,lt+1)):(a.emplaceBack(lt+1,lt,lt+rt),a.emplaceBack(lt+rt,lt+rt+1,lt+1))}}const K=Cr.simpleSegment(0,k,i.length,a.length-k);for(let he=0;he<j.uint16.length;he+=3)a.emplaceBack(j.uint16[he],j.uint16[he+1],j.uint16[he+2]);const te=Cr.simpleSegment(0,k,i.length,a.length-k);u.push({withoutSkirts:K,withSkirts:te})}return{vertices:i,indices:a,segments:u}}_createGrid(t){const e=this._fillGridMeshWithLods(64,Ad);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Dd.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new Ti;for(let u=0;u<=64;u++)e.emplaceBack(0,u+1,u+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const i=new zo,a=new zo;this._poleSegments=[];for(let u=0,f=0;u<Id;u++){const _=360/(1<<u);i.emplaceBack(0,-ba,0,.5,0),a.emplaceBack(0,-ba,0,.5,1);for(let b=0;b<=64;b++){const E=b/64,D=Xn(0,_,E),[k,z,j]=Qc(b_,Lm,D,ba);i.emplaceBack(k,z,j,E,0),a.emplaceBack(k,z,j,E,1)}this._poleSegments.push(Cr.simpleSegment(f,0,66,64)),f+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(i,Mm,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(a,Mm,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const i=new Yr,a=64,u=a+1+2,f=1;this._wireframeSegments=[];for(let _=0,b=0;_<Ad.length;_++){const E=Ad[_];for(let k=f;k<E+f;k++)for(let z=f;z<a+f;z++){const j=k*u+z;i.emplaceBack(j,j+1),i.emplaceBack(j,j+u),i.emplaceBack(j,j+u+1)}const D=E*a*3;this._wireframeSegments.push(Cr.simpleSegment(0,b,(E+1)*u,D)),b+=D}this._wireframeIndexBuffer=t.createIndexBuffer(i)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},s.GlyphManager=Ju,s.ImagePosition=Cc,s.KDBush=Ep,s.LivePerformanceUtils=Et,s.LngLat=tr,s.LngLatBounds=Jc,s.LocalGlyphMode=sp,s.MAX_MERCATOR_LATITUDE=Vs,s.MercatorCoordinate=Au,s.ONE_EM=As,s.OverscaledTileID=Is,s.PerformanceMarkers=xt,s.Point=Ce,s.Properties=ht,s.RGBAImage=Ta,s.Ray=Qp,s.RequestManager=class{constructor(t,e,i){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!i,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let i=0;i<10;i++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ge,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!Rt(t))return t;const i=tt(t);return i.path=`/styles/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!Rt(t))return t;const i=tt(t);return i.path=`/fonts/v1${i.path}`,this._makeAPIURL(i,this._customAccessToken||e)}normalizeSourceURL(t,e,i,a){if(!Rt(t))return t;const u=tt(t);return u.path=`/v4/${u.authority}.json`,u.params.push("secure"),i&&u.params.push(`language=${i}`),a&&u.params.push(`worldview=${a}`),this._makeAPIURL(u,this._customAccessToken||e)}normalizeSpriteURL(t,e,i,a){const u=tt(t);return Rt(t)?(u.path=`/styles/v1${u.path}/sprite${e}${i}`,this._makeAPIURL(u,this._customAccessToken||a)):(u.path+=`${e}${i}`,Ve(u))}normalizeTileURL(t,e,i){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!Rt(t))return t;const a=tt(t);a.path=a.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||i&&"raster"!==a.authority&&512===i?"@2x":""}${fe.supported?".webp":"$1"}`),"raster"===a.authority?a.path=`/${w.RASTER_URL_PREFIX}${a.path}`:(a.path=a.path.replace(/^.+\/v4\//,"/"),a.path=`/${w.TILE_URL_VERSION}${a.path}`);const u=this._customAccessToken||function(f){for(const _ of f){const b=_.match(/^access_token=(.*)$/);if(b)return b[1]}return null}(a.params)||w.ACCESS_TOKEN;return w.REQUIRE_ACCESS_TOKEN&&u&&this._skuToken&&a.params.push(`sku=${this._skuToken}`),this._makeAPIURL(a,u)}canonicalizeTileURL(t,e){const i=tt(t);if(!i.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!i.path.match(/\.[\w]+$/))return t;let a="mapbox://";i.path.match(/^\/raster\/v1\//)?a+=`raster/${i.path.replace(`/${w.RASTER_URL_PREFIX}/`,"")}`:a+=`tiles/${i.path.replace(`/${w.TILE_URL_VERSION}/`,"")}`;let u=i.params;return e&&(u=u.filter(f=>!f.match(/^access_token=/))),u.length&&(a+=`?${u.join("&")}`),a}canonicalizeTileset(t,e){const i=!!e&&Rt(e),a=[];for(const u of t.tiles||[])Ut(u)?a.push(this.canonicalizeTileURL(u,i)):a.push(u);return a}_makeAPIURL(t,e){const i="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",a=tt(w.API_URL);if(t.protocol=a.protocol,t.authority=a.authority,"http"===t.protocol){const u=t.params.indexOf("secure");u>=0&&t.params.splice(u,1)}if("/"!==a.path&&(t.path=`${a.path}${t.path}`),!w.REQUIRE_ACCESS_TOKEN)return Ve(t);if(e=e||w.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${i}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${i}`)}return t.params=t.params.filter(u=>-1===u.indexOf("access_token")),t.params.push(`access_token=${e||""}`),Ve(t)}},s.ResourceType=oi,s.SegmentVector=Cr,s.SourceCache=Ac,s.StencilMode=om,s.StructArrayLayout1ui2=_s,s.StructArrayLayout2f1f2i16=ki,s.StructArrayLayout2i4=Wn,s.StructArrayLayout2ui4=Yr,s.StructArrayLayout3f12=fo,s.StructArrayLayout3ui6=Ti,s.StructArrayLayout4i8=An,s.StructArrayLayout5f20=zo,s.Texture=La,s.Tile=xp,s.Transitionable=ce,s.Uniform1f=Wl,s.Uniform1i=class extends el{constructor(t){super(t),this.current=0}set(t,e,i){this.fetchUniformLocation(t,e)&&this.current!==i&&(this.current=i,this.gl.uniform1i(this.location,i))}},s.Uniform2f=class extends el{constructor(t){super(t),this.current=[0,0]}set(t,e,i){this.fetchUniformLocation(t,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]||(this.current=i,this.gl.uniform2f(this.location,i[0],i[1])))}},s.Uniform3f=class extends el{constructor(t){super(t),this.current=[0,0,0]}set(t,e,i){this.fetchUniformLocation(t,e)&&(i[0]===this.current[0]&&i[1]===this.current[1]&&i[2]===this.current[2]||(this.current=i,this.gl.uniform3f(this.location,i[0],i[1],i[2])))}},s.Uniform4f=a_,s.UniformColor=Vp,s.UniformMatrix2f=class extends el{constructor(t){super(t),this.current=u_}set(t,e,i){if(this.fetchUniformLocation(t,e))for(let a=0;a<4;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix2fv(this.location,!1,i);break}}},s.UniformMatrix3f=class extends el{constructor(t){super(t),this.current=c_}set(t,e,i){if(this.fetchUniformLocation(t,e))for(let a=0;a<9;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix3fv(this.location,!1,i);break}}},s.UniformMatrix4f=class extends el{constructor(t){super(t),this.current=l_}set(t,e,i){if(this.fetchUniformLocation(t,e)){if(i[12]!==this.current[12]||i[0]!==this.current[0])return this.current=i,void this.gl.uniformMatrix4fv(this.location,!1,i);for(let a=1;a<16;a++)if(i[a]!==this.current[a]){this.current=i,this.gl.uniformMatrix4fv(this.location,!1,i);break}}}},s.UnwrappedTileID=og,s.ValidationError=ui,s.VectorTileFeature=Zh,s.VectorTileWorkerSource=class extends uo{constructor(t,e,i,a,u){super(),this.actor=t,this.layerIndex=e,this.availableImages=i,this.loadVectorData=u||fy,this.loading={},this.loaded={},this.deduped=new Zg(t.scheduler),this.isSpriteLoaded=a,this.scheduler=t.scheduler}loadTile(t,e){const i=t.uid,a=t&&t.request,u=a&&a.collectResourceTiming,f=this.loading[i]=new Ug(t);f.abort=this.loadVectorData(t,(_,b)=>{const E=!this.loading[i];if(delete this.loading[i],E||_||!b)return f.status="done",E||(this.loaded[i]=f),e(_);const D=b.rawData,k={};b.expires&&(k.expires=b.expires),b.cacheControl&&(k.cacheControl=b.cacheControl),f.vectorTile=b.vectorTile||new $d(new ip(D));const z=()=>{f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,(j,K)=>{if(j||!K)return e(j);const te={};if(u){const he=ri(a);he.length>0&&(te.resourceTiming=JSON.parse(JSON.stringify(he)))}e(null,Ue({rawTileData:D.slice(0)},K,k,te))})};this.isSpriteLoaded?z():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(z,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):z()}),this.loaded=this.loaded||{},this.loaded[i]=f})}reloadTile(t,e){const i=this.loaded,a=t.uid,u=this;if(i&&i[a]){const f=i[a];f.showCollisionBoxes=t.showCollisionBoxes,f.enableTerrain=!!t.enableTerrain,f.projection=t.projection,f.tileTransform=uu(t.tileID.canonical,t.projection);const _=(b,E)=>{const D=f.reloadCallback;D&&(delete f.reloadCallback,f.parse(f.vectorTile,u.layerIndex,this.availableImages,u.actor,D)),e(b,E)};"parsing"===f.status?f.reloadCallback=_:"done"===f.status&&(f.vectorTile?f.parse(f.vectorTile,this.layerIndex,this.availableImages,this.actor,_):_())}}abortTile(t,e){const i=t.uid,a=this.loading[i];a&&(a.abort&&a.abort(),delete this.loading[i]),e()}removeTile(t,e){const i=this.loaded,a=t.uid;i&&i[a]&&delete i[a],e()}},s.WritingMode=Ca,s.ZoomDependentExpression=os,s.add=rl,s.addDynamicAttributes=Ra,s.adjoint=function(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=e[4],b=e[5],E=e[6],D=e[7],k=e[8];return t[0]=_*k-b*D,t[1]=u*D-a*k,t[2]=a*b-u*_,t[3]=b*E-f*k,t[4]=i*k-u*E,t[5]=u*f-i*b,t[6]=f*D-_*E,t[7]=a*E-i*D,t[8]=i*_-a*f,t},s.asyncAll=gt,s.bezier=Ze,s.bindAll=Gt,s.boundsAttributes=dy,s.bufferConvexPolygon=function(t,e){const i=[];for(let a=0;a<t.length;a++){const u=dt(a-1,-1,t.length-1),f=dt(a+1,-1,t.length-1),_=t[a],b=t[f],E=t[u].sub(_).unit(),D=b.sub(_).unit(),k=D.angleWithSep(E.x,E.y),z=E.add(D).unit().mult(-1*e/Math.sin(k/2));i.push(_.add(z))}return i},s.cacheEntryPossiblyAdded=function(t){Un++,Un>At&&(t.getActor().send("enforceCacheSizeLimit",Je),Un=0)},s.calculateGlobeLabelMatrix=function(t,e){const{x:i,y:a}=t.point,u=Pm(i,a,t.worldSize/t._pixelsPerMercatorPixel,0,0);return wl(u,u,Mu(ja(e)))},s.calculateGlobeMatrix=function(t){const{x:e,y:i}=t.point,{lng:a,lat:u}=t._center;return Pm(e,i,t.worldSize,a,u)},s.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,i=e/Zs(1,t.center.lat),a=ol(new Float64Array(16));return Eu(a,a,[t.point.x,t.point.y,0]),Kc(a,a,[i,i,e]),Float32Array.from(a)},s.circumferenceAtLatitude=af,s.clamp=ye,s.clearTileCache=function(t){if(!hn())return;const e=Q.caches.delete(si);t&&e.catch(t).then(()=>t())},s.clipLine=go,s.clone=function(t){var e=new va(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},s.clone$1=sn,s.collisionCircleLayout=Qh,s.config=w,s.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},s.create=function(){var t=new va(16);return va!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},s.create$1=p_,s.createExpression=Vr,s.createLayout=$t,s.createStyleLayer=function(t){return"custom"===t.type?new Eg(t):new Qf[t.type](t)},s.cross=Ch,s.degToRad=Ee,s.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},s.div=function(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t[2]=e[2]/i[2],t},s.dot=xa,s.earthRadius=iu,s.ease=Se,s.easeCubicInOut=xe,s.ecefToLatLng=function([t,e,i]){const a=Math.hypot(t,e,i),u=Math.atan2(t,i),f=.5*Math.PI-Math.acos(-e/a);return new tr(ae(u),ae(f))},s.emitValidationErrors=qc,s.endsWith=wn,s.enforceCacheSizeLimit=function(t){gi(),Zt&&Zt.then(e=>{e.keys().then(i=>{for(let a=0;a<i.length-t;a++)e.delete(i[a])})})},s.evaluateSizeForFeature=Jd,s.evaluateSizeForZoom=Vu,s.evaluateVariableOffset=up,s.evented=x,s.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},s.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},s.exported=Ao,s.exported$1=fe,s.extend=Ue,s.extend$1=Qo,s.fillExtrusionHeightLift=eg,s.filterObject=mn,s.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},s.fromQuat=function(t,e){var i=e[0],a=e[1],u=e[2],f=e[3],_=i+i,b=a+a,E=u+u,D=i*_,k=a*_,z=a*b,j=u*_,K=u*b,te=u*E,he=f*_,Re=f*b,rt=f*E;return t[0]=1-z-te,t[1]=k+rt,t[2]=j-Re,t[3]=0,t[4]=k-rt,t[5]=1-D-te,t[6]=K+he,t[7]=0,t[8]=j+Re,t[9]=K-he,t[10]=1-D-z,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},s.fromRotation=function(t,e){var i=Math.sin(e),a=Math.cos(e);return t[0]=a,t[1]=i,t[2]=0,t[3]=-i,t[4]=a,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},s.fromScaling=qp,s.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return mt[e]},s.getAABBPointSquareDist=function(t,e,i){let a=0;for(let u=0;u<2;++u){const f=i?i[u]:0;t[u]>f&&(a+=(t[u]-f)*(t[u]-f)),e[u]<f&&(a+=(f-e[u])*(f-e[u]))}return a},s.getAnchorAlignment=hg,s.getAnchorJustification=dp,s.getBounds=function(t){let e=1/0,i=1/0,a=-1/0,u=-1/0;for(const f of t)e=Math.min(e,f.x),i=Math.min(i,f.y),a=Math.max(a,f.x),u=Math.max(u,f.y);return{min:new Ce(e,i),max:new Ce(a,u)}},s.getColumn=gn,s.getDefaultExportFromCjs=we,s.getGridMatrix=function(t,e,i,a){const u=e.getNorth(),f=e.getSouth(),_=e.getWest(),b=e.getEast(),E=1<<t.z,D=b-_,k=u-f,z=D/64,j=-k/Ad[i],K=[0,z,0,j,0,0,u,_,0];if(t.z>0){const te=180/a;wm(K,K,[te/D+1,0,0,0,te/k+1,0,-.5*te/z,.5*te/j,1])}return K[2]=E,K[5]=t.x,K[8]=t.y,K},s.getImage=et,s.getJSON=function(t,e){return Po(Ue(t,{type:"json"}),e)},s.getLatitudinalLod=function(t){const e=Vs-5;t=ye(t,-e,e)/e*90;const i=Math.pow(Math.abs(Math.sin(Ee(t))),3);return Math.round(i*(Ad.length-1))},s.getMapSessionAPI=eo,s.getPerformanceMeasurement=ri,s.getProjection=wg,s.getRTLTextPluginStatus=C,s.getReferrer=Oi,s.getTilePoint=function(t,{x:e,y:i},a=0){return new Ce(((e-a)*t.scale-t.x)*Li,(i*t.scale-t.y)*Li)},s.getTileVec3=function(t,e,i=0){return Td(((e.x-i)*t.scale-t.x)*Li,(e.y*t.scale-t.y)*Li,km(e.z,e.y))},s.getVideo=function(t,e){const i=Q.document.createElement("video");i.muted=!0,i.onloadstart=function(){e(null,i)};for(let a=0;a<t.length;a++){const u=Q.document.createElement("source");Vo(t[a])||(i.crossOrigin="Anonymous"),u.src=t[a],i.appendChild(u)}return{cancel:()=>{}}},s.globeCenterToScreenPoint=function(t){const e=[0,0,0],i=ol(new Float64Array(16));return wl(i,t.pixelMatrix,t.globeMatrix),zr(e,e,i),new Ce(e[0],e[1])},s.globeDenormalizeECEF=Mu,s.globeECEFOrigin=function(t,e){const i=[0,0,0];return zr(i,i,nu(ja(e.canonical))),zr(i,i,t),i},s.globeMetersToEcef=Mh,s.globeNormalizeECEF=nu,s.globePixelsToTileUnits=function(t,e){return Li/(512*Math.pow(2,t))*tu(ja(e))},s.globePoleMatrixForTile=function(t,e,i){const a=ol(new Float64Array(16)),u=(e/(1<<t)-.5)*Math.PI*2;return Wp(a,i.globeMatrix,u),Float32Array.from(a)},s.globeTileBounds=ja,s.globeTiltAtLngLat=Om,s.globeToMercatorTransition=Iu,s.globeUseCustomAntiAliasing=function(t,e,i){const a=Iu(i.zoom),u=t.style.map._antialias,f=!!e.extStandardDerivatives,_=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===a&&!u&&!_&&f},s.identity=ol,s.identity$1=Dm,s.invert=Gp,s.isFullscreen=function(){return!!Q.document.fullscreenElement||!!Q.document.webkitFullscreenElement},s.isLngLatBehindGlobe=rf,s.isMapAuthenticated=function(t){return tn.has(t)},s.isMapboxURL=Rt,s.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!yi(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},s.latFromMercatorY=vs,s.latLngToECEF=eu,s.len=Eh,s.length=bh,s.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},s.lngFromMercatorX=wa,s.loadVectorTile=fy,s.makeRequest=Po,s.mapValue=function(t,e,i,a,u){return ye((t-e)/(i-e)*(u-a)+a,a,u)},s.mercatorScale=Sd,s.mercatorXfromLng=$a,s.mercatorYfromLat=al,s.mercatorZfromAltitude=Zs,s.mul=m_,s.mul$1=Cm,s.multiply=wl,s.multiply$1=wm,s.multiply$2=g_,s.nextPowerOfTwo=Ne,s.normalize=ys,s.normalize$1=__,s.normalize$2=sl,s.number=Xn,s.ortho=function(t,e,i,a,u,f,_){var b=1/(e-i),E=1/(a-u),D=1/(f-_);return t[0]=-2*b,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*E,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*D,t[11]=0,t[12]=(e+i)*b,t[13]=(u+a)*E,t[14]=(_+f)*D,t[15]=1,t},s.pbf=j_,s.perspective=function(t,e,i,a,u){var f,_=1/Math.tan(e/2);return t[0]=_/i,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=_,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=u&&u!==1/0?(t[10]=(u+a)*(f=1/(a-u)),t[14]=2*u*a*f):(t[10]=-1,t[14]=-2*a),t},s.pick=function(t,e){const i={};for(let a=0;a<e.length;a++){const u=e[a];u in t&&(i[u]=t[u])}return i},s.plugin=O,s.pointGeometry=Ke,s.polesInViewport=function(t){const e=ol(new Float64Array(16));wl(e,t.pixelMatrix,t.globeMatrix);const i=[0,Pa,0],a=[0,Va,0];return zr(i,i,e),zr(a,a,e),[i[0]>0&&i[0]<=t.width&&i[1]>0&&i[1]<=t.height&&!rf(t,new tr(t.center.lat,90)),a[0]>0&&a[0]<=t.width&&a[1]>0&&a[1]<=t.height&&!rf(t,new tr(t.center.lat,-90))]},s.polygonContainsPoint=Jl,s.polygonIntersectsBox=ru,s.polygonIntersectsPolygon=Su,s.polygonizeBounds=function(t,e,i=0,a=!0){const u=new Ce(i,i),f=t.sub(u),_=e.add(u),b=[f,new Ce(_.x,f.y),_,new Ce(f.x,_.y)];return a&&b.push(f.clone()),b},s.posAttributes=Dd,s.postMapLoadEvent=Ei,s.postPerformanceEvent=ji,s.postTurnstileEvent=_n,s.potpack=ug,s.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},s.radToDeg=ae,s.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.registerForPluginStateChange=function(t){return t({pluginStatus:p,pluginURL:o}),x.on("pluginStateChange",t),t},s.removeAuthState=function(t){tn.delete(t)},s.renderColorRamp=su,s.resample=lf,s.rotateX=vh,s.rotateX$1=Kp,s.rotateY=Wp,s.rotateY$1=Dh,s.rotateZ=function(t,e,i){var a=Math.sin(i),u=Math.cos(i),f=e[0],_=e[1],b=e[2],E=e[3],D=e[4],k=e[5],z=e[6],j=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=f*u+D*a,t[1]=_*u+k*a,t[2]=b*u+z*a,t[3]=E*u+j*a,t[4]=D*u-f*a,t[5]=k*u-_*a,t[6]=z*u-b*a,t[7]=j*u-E*a,t},s.rotateZ$1=function(t,e,i){i*=.5;var a=e[0],u=e[1],f=e[2],_=e[3],b=Math.sin(i),E=Math.cos(i);return t[0]=a*E+u*b,t[1]=u*E-a*b,t[2]=f*E+_*b,t[3]=_*E-f*b,t},s.scale=Kc,s.scale$1=Ed,s.scale$2=Ua,s.scaleAndAdd=Cd,s.set=function(t,e,i,a){return t[0]=e,t[1]=i,t[2]=a,t},s.setCacheLimits=function(t,e){Je=t,At=e},s.setColumn=function(t,e,i){t[4*e+0]=i[0],t[4*e+1]=i[1],t[4*e+2]=i[2],t[4*e+3]=i[3]},s.setRTLTextPlugin=function(t,e,i=!1){if(p===Rn||p===_i||p===Ai)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=Ao.resolveURL(t),p=Rn,Mo=e,m(),i||I()},s.smoothstep=Qt,s.spec=en,s.squaredLength=function(t){var e=t[0],i=t[1],a=t[2];return e*e+i*i+a*a},s.storeAuthState=function(t,e){e?tn.add(t):tn.delete(t)},s.sub=Za,s.subtract=Tm,s.symbolSize=U_,s.tileAABB=function(t,e,i,a,u,f,_,b,E){if("globe"===E.name)return function x_(t,e,i){const a=e/t.worldSize,u=t.globeMatrix;if(i.z<=1){const on=ja(i).getCorners();return Du(on,u,a),zs.fromPoints(on)}const f=Ih(i),_=Ah(f);Du(_,u,a);const b=Number.MAX_VALUE,E=[-b,-b,-b],D=[b,b,b];if(f.contains(t.center)){for(const Hn of _)wh(D,D,Hn),Th(E,E,Hn);E[2]=0;const on=t.point,En=[on.x*a,on.y*a,0];return wh(D,D,En),Th(E,E,En),new zs(D,E)}const k=[u[12]*a,u[13]*a,u[14]*a],z=f.getCenter(),j=ye(t.center.lat,-Vs,Vs),K=ye(z.lat,-Vs,Vs),te=$a(t.center.lng),he=al(j);let Re=te-$a(z.lng);const rt=he-al(K);Re>.5?Re-=1:Re<-.5&&(Re+=1);let wt=0;Math.abs(Re)>Math.abs(rt)?wt=Re>=0?1:3:(wt=rt>=0?0:2,Cd(k,k,[u[4]*a,u[5]*a,u[6]*a],-Math.sin(Ee(rt>=0?f.getSouth():f.getNorth()))*ba));const lt=_[wt],bt=_[(wt+1)%4],Mt=new v_(lt,bt,k),Dt=[tf(Mt,0)||lt[0],tf(Mt,1)||lt[1],tf(Mt,2)||lt[2]],cn=Iu(t.zoom);if(cn>0){const on=function({x:Hn,y:fn,z:kn},Fn,Vn,Jn,Cn){const ai=1/(1<<kn);let xi=Hn*ai,ci=xi+ai,to=fn*ai,Kn=to+ai,Mi=0;const Wi=(xi+ci)/2-Jn;return Wi>.5?Mi=-1:Wi<-.5&&(Mi=1),xi=((xi+Mi)*Fn-(Jn*=Fn))*Vn+Jn,ci=((ci+Mi)*Fn-Jn)*Vn+Jn,to=(to*Fn-(Cn*=Fn))*Vn+Cn,Kn=(Kn*Fn-Cn)*Vn+Cn,[[xi,Kn,0],[ci,Kn,0],[ci,to,0],[xi,to,0]]}(i,e,t._pixelsPerMercatorPixel,te,he);for(let Hn=0;Hn<_.length;Hn++)ql(_[Hn],on[Hn],cn);const En=rl([],on[wt],on[(wt+1)%4]);Ua(En,En,.5),ql(Dt,En,cn)}for(const on of _)wh(D,D,on),Th(E,E,on);return D[2]=Math.min(lt[2],bt[2]),wh(D,D,Dt),Th(E,E,Dt),new zs(D,E)}(t,e,new Hh(i,a,u));const D=uu({z:i,x:a,y:u},E);return new zs([(f+D.x/D.scale)*e,e*(D.y/D.scale),_],[(f+D.x2/D.scale)*e,e*(D.y2/D.scale),b])},s.tileCornersToBounds=Ih,s.tileTransform=uu,s.transformMat3=function(t,e,i){var a=e[0],u=e[1],f=e[2];return t[0]=a*i[0]+u*i[3]+f*i[6],t[1]=a*i[1]+u*i[4]+f*i[7],t[2]=a*i[2]+u*i[5]+f*i[8],t},s.transformMat4=zr,s.transformMat4$1=Xc,s.transformQuat=Jp,s.transitionTileAABBinECEF=Sm,s.translate=Eu,s.transpose=function(t,e){if(t===e){var i=e[1],a=e[2],u=e[5];t[1]=e[3],t[2]=e[6],t[3]=i,t[5]=e[7],t[6]=a,t[7]=u}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},s.triggerPluginCompletionEvent=c,s.uniqueId=je,s.updateGlobeVertexNormal=function(t,e,i,a,u){const f=5*e+2;t.float32[f+0]=i,t.float32[f+1]=a,t.float32[f+2]=u},s.validateCustomStyleLayer=function(t){const e=[],i=t.id;return void 0===i&&e.push({message:`layers.${i}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${i}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${i}: property "renderingMode" must be either "2d" or "3d"`}),e},s.validateFilter=t=>Bs(jc(t)),s.validateFog=t=>Bs($c(t)),s.validateLayer=t=>Bs(Xa(t)),s.validateLight=t=>Bs(_d(t)),s.validateSource=t=>Bs(fc(t)),s.validateStyle=Gc,s.validateTerrain=t=>Bs(mc(t)),s.values=ct,s.vectorTile=bc,s.version=ie,s.warnOnce=It,s.window=Q,s.wrap=dt}),d(0,function(s){function Q(ut){if("number"==typeof ut||"boolean"==typeof ut||"string"==typeof ut||null==ut)return JSON.stringify(ut);if(Array.isArray(ut)){let ve="[";for(const et of ut)ve+=`${Q(et)},`;return`${ve}]`}let pe="{";for(const ve of Object.keys(ut).sort())pe+=`${ve}:${Q(ut[ve])},`;return`${pe}}`}function ie(ut){let pe="";for(const ve of s.refProperties)pe+=`/${Q(ut[ve])}`;return pe}class W{constructor(pe){this.keyCache={},pe&&this.replace(pe)}replace(pe){this._layerConfigs={},this._layers={},this.update(pe,[])}update(pe,ve){for(const yt of pe)this._layerConfigs[yt.id]=yt,(this._layers[yt.id]=s.createStyleLayer(yt)).compileFilter(),this.keyCache[yt.id]&&delete this.keyCache[yt.id];for(const yt of ve)delete this.keyCache[yt],delete this._layerConfigs[yt],delete this._layers[yt];this.familiesBySource={};const et=function(yt,Rt){const Ut={};for(let St=0;St<yt.length;St++){const Kt=Rt&&Rt[yt[St].id]||ie(yt[St]);Rt&&(Rt[yt[St].id]=Kt);let In=Ut[Kt];In||(In=Ut[Kt]=[]),In.push(yt[St])}const jt=[];for(const St in Ut)jt.push(Ut[St]);return jt}(s.values(this._layerConfigs),this.keyCache);for(const yt of et){const Rt=yt.map(tt=>this._layers[tt.id]),Ut=Rt[0];if("none"===Ut.visibility)continue;const jt=Ut.source||"";let St=this.familiesBySource[jt];St||(St=this.familiesBySource[jt]={});const Kt=Ut.sourceLayer||"_geojsonTileLayer";let In=St[Kt];In||(In=St[Kt]=[]),In.push(Rt)}}}class w{loadTile(pe,ve){const{uid:et,encoding:yt,rawImageData:Rt,padding:Ut,buildQuadTree:jt}=pe,St=s.window.ImageBitmap&&Rt instanceof s.window.ImageBitmap?this.getImageData(Rt,Ut):Rt;ve(null,new s.DEMData(et,St,yt,Ut<1,jt))}getImageData(pe,ve){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(pe.width,pe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=pe.width,this.offscreenCanvas.height=pe.height,this.offscreenCanvasContext.drawImage(pe,0,0,pe.width,pe.height);const et=this.offscreenCanvasContext.getImageData(-ve,-ve,pe.width+2*ve,pe.height+2*ve);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),et}}function fe(ut,pe){if(0!==ut.length){Ae(ut[0],pe);for(var ve=1;ve<ut.length;ve++)Ae(ut[ve],!pe)}}function Ae(ut,pe){for(var ve=0,et=0,yt=0,Rt=ut.length,Ut=Rt-1;yt<Rt;Ut=yt++){var jt=(ut[yt][0]-ut[Ut][0])*(ut[Ut][1]+ut[yt][1]),St=ve+jt;et+=Math.abs(ve)>=Math.abs(jt)?ve-St+jt:jt-St+ve,ve=St}ve+et>=0!=!!pe&&ut.reverse()}var De=s.getDefaultExportFromCjs(function ut(pe,ve){var et,yt=pe&&pe.type;if("FeatureCollection"===yt)for(et=0;et<pe.features.length;et++)ut(pe.features[et],ve);else if("GeometryCollection"===yt)for(et=0;et<pe.geometries.length;et++)ut(pe.geometries[et],ve);else if("Feature"===yt)ut(pe.geometry,ve);else if("Polygon"===yt)fe(pe.coordinates,ve);else if("MultiPolygon"===yt)for(et=0;et<pe.coordinates.length;et++)fe(pe.coordinates[et],ve);return pe});const X=s.VectorTileFeature.prototype.toGeoJSON;var se={exports:{}},Te=s.pointGeometry,ge=s.vectorTile.VectorTileFeature,we=Le;function Le(ut,pe){this.options=pe||{},this.features=ut,this.length=ut.length}function Me(ut,pe){this.id="number"==typeof ut.id?ut.id:void 0,this.type=ut.type,this.rawGeometry=1===ut.type?[ut.geometry]:ut.geometry,this.properties=ut.tags,this.extent=pe||4096}Le.prototype.feature=function(ut){return new Me(this.features[ut],this.options.extent)},Me.prototype.loadGeometry=function(){var ut=this.rawGeometry;this.geometry=[];for(var pe=0;pe<ut.length;pe++){for(var ve=ut[pe],et=[],yt=0;yt<ve.length;yt++)et.push(new Te(ve[yt][0],ve[yt][1]));this.geometry.push(et)}return this.geometry},Me.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ut=this.geometry,pe=1/0,ve=-1/0,et=1/0,yt=-1/0,Rt=0;Rt<ut.length;Rt++)for(var Ut=ut[Rt],jt=0;jt<Ut.length;jt++){var St=Ut[jt];pe=Math.min(pe,St.x),ve=Math.max(ve,St.x),et=Math.min(et,St.y),yt=Math.max(yt,St.y)}return[pe,et,ve,yt]},Me.prototype.toGeoJSON=ge.prototype.toGeoJSON;var ze=s.pbf,Ke=we;function Oe(ut){var pe=new ze;return function(ve,et){for(var yt in ve.layers)et.writeMessage(3,Ce,ve.layers[yt])}(ut,pe),pe.finish()}function Ce(ut,pe){var ve;pe.writeVarintField(15,ut.version||1),pe.writeStringField(1,ut.name||""),pe.writeVarintField(5,ut.extent||4096);var et={keys:[],values:[],keycache:{},valuecache:{}};for(ve=0;ve<ut.length;ve++)et.feature=ut.feature(ve),pe.writeMessage(2,nt,et);var yt=et.keys;for(ve=0;ve<yt.length;ve++)pe.writeStringField(3,yt[ve]);var Rt=et.values;for(ve=0;ve<Rt.length;ve++)pe.writeMessage(4,xe,Rt[ve])}function nt(ut,pe){var ve=ut.feature;void 0!==ve.id&&pe.writeVarintField(1,ve.id),pe.writeMessage(2,Xe,ut),pe.writeVarintField(3,ve.type),pe.writeMessage(4,mt,ve)}function Xe(ut,pe){var ve=ut.feature,et=ut.keys,yt=ut.values,Rt=ut.keycache,Ut=ut.valuecache;for(var jt in ve.properties){var St=ve.properties[jt],Kt=Rt[jt];if(null!==St){void 0===Kt&&(et.push(jt),Rt[jt]=Kt=et.length-1),pe.writeVarint(Kt);var In=typeof St;"string"!==In&&"boolean"!==In&&"number"!==In&&(St=JSON.stringify(St));var tt=In+":"+St,Ve=Ut[tt];void 0===Ve&&(yt.push(St),Ut[tt]=Ve=yt.length-1),pe.writeVarint(Ve)}}}function Ee(ut,pe){return(pe<<3)+(7&ut)}function ae(ut){return ut<<1^ut>>31}function mt(ut,pe){for(var ve=ut.loadGeometry(),et=ut.type,yt=0,Rt=0,Ut=ve.length,jt=0;jt<Ut;jt++){var St=ve[jt],Kt=1;1===et&&(Kt=St.length),pe.writeVarint(Ee(1,Kt));for(var In=3===et?St.length-1:St.length,tt=0;tt<In;tt++){1===tt&&1!==et&&pe.writeVarint(Ee(2,In-1));var Ve=St[tt].x-yt,Y=St[tt].y-Rt;pe.writeVarint(ae(Ve)),pe.writeVarint(ae(Y)),yt+=Ve,Rt+=Y}3===et&&pe.writeVarint(Ee(7,1))}}function xe(ut,pe){var ve=typeof ut;"string"===ve?pe.writeStringField(1,ut):"boolean"===ve?pe.writeBooleanField(7,ut):"number"===ve&&(ut%1!=0?pe.writeDoubleField(3,ut):ut<0?pe.writeSVarintField(6,ut):pe.writeVarintField(5,ut))}se.exports=Oe,se.exports.fromVectorTileJs=Oe,se.exports.fromGeojsonVt=function(ut,pe){pe=pe||{};var ve={};for(var et in ut)ve[et]=new Ke(ut[et].features,pe),ve[et].name=et,ve[et].version=pe.version,ve[et].extent=pe.extent;return Oe({layers:ve})},se.exports.GeoJSONWrapper=Ke;var Ze=s.getDefaultExportFromCjs(se.exports);const Se={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ut=>ut},ye=Math.fround||(Qt=new Float32Array(1),ut=>(Qt[0]=+ut,Qt[0]));var Qt;const dt=3,gt=5,ct=6;class Ue{constructor(pe){this.options=Object.assign(Object.create(Se),pe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(pe){const{log:ve,minZoom:et,maxZoom:yt}=this.options;ve&&console.time("total time");const Rt=`prepare ${pe.length} points`;ve&&console.time(Rt),this.points=pe;const Ut=[];for(let St=0;St<pe.length;St++){const Kt=pe[St];if(!Kt.geometry)continue;const[In,tt]=Kt.geometry.coordinates,Ve=ye(_t(In)),Y=ye(Ne(tt));Ut.push(Ve,Y,1/0,St,-1,1),this.options.reduce&&Ut.push(0)}let jt=this.trees[yt+1]=this._createTree(Ut);ve&&console.timeEnd(Rt);for(let St=yt;St>=et;St--){const Kt=+Date.now();jt=this.trees[St]=this._createTree(this._cluster(jt,St)),ve&&console.log("z%d: %d clusters in %dms",St,jt.numItems,+Date.now()-Kt)}return ve&&console.timeEnd("total time"),this}getClusters(pe,ve){let et=((pe[0]+180)%360+360)%360-180;const yt=Math.max(-90,Math.min(90,pe[1]));let Rt=180===pe[2]?180:((pe[2]+180)%360+360)%360-180;const Ut=Math.max(-90,Math.min(90,pe[3]));if(pe[2]-pe[0]>=360)et=-180,Rt=180;else if(et>Rt){const tt=this.getClusters([et,yt,180,Ut],ve),Ve=this.getClusters([-180,yt,Rt,Ut],ve);return tt.concat(Ve)}const jt=this.trees[this._limitZoom(ve)],St=jt.range(_t(et),Ne(Ut),_t(Rt),Ne(yt)),Kt=jt.data,In=[];for(const tt of St){const Ve=this.stride*tt;In.push(Kt[Ve+gt]>1?vt(Kt,Ve,this.clusterProps):this.points[Kt[Ve+dt]])}return In}getChildren(pe){const ve=this._getOriginId(pe),et=this._getOriginZoom(pe),yt="No cluster with the specified id.",Rt=this.trees[et];if(!Rt)throw new Error(yt);const Ut=Rt.data;if(ve*this.stride>=Ut.length)throw new Error(yt);const jt=this.options.radius/(this.options.extent*Math.pow(2,et-1)),St=Rt.within(Ut[ve*this.stride],Ut[ve*this.stride+1],jt),Kt=[];for(const In of St){const tt=In*this.stride;Ut[tt+4]===pe&&Kt.push(Ut[tt+gt]>1?vt(Ut,tt,this.clusterProps):this.points[Ut[tt+dt]])}if(0===Kt.length)throw new Error(yt);return Kt}getLeaves(pe,ve,et){const yt=[];return this._appendLeaves(yt,pe,ve=ve||10,et=et||0,0),yt}getTile(pe,ve,et){const yt=this.trees[this._limitZoom(pe)],Rt=Math.pow(2,pe),{extent:Ut,radius:jt}=this.options,St=jt/Ut,Kt=(et-St)/Rt,In=(et+1+St)/Rt,tt={features:[]};return this._addTileFeatures(yt.range((ve-St)/Rt,Kt,(ve+1+St)/Rt,In),yt.data,ve,et,Rt,tt),0===ve&&this._addTileFeatures(yt.range(1-St/Rt,Kt,1,In),yt.data,Rt,et,Rt,tt),ve===Rt-1&&this._addTileFeatures(yt.range(0,Kt,St/Rt,In),yt.data,-1,et,Rt,tt),tt.features.length?tt:null}getClusterExpansionZoom(pe){let ve=this._getOriginZoom(pe)-1;for(;ve<=this.options.maxZoom;){const et=this.getChildren(pe);if(ve++,1!==et.length)break;pe=et[0].properties.cluster_id}return ve}_appendLeaves(pe,ve,et,yt,Rt){const Ut=this.getChildren(ve);for(const jt of Ut){const St=jt.properties;if(St&&St.cluster?Rt+St.point_count<=yt?Rt+=St.point_count:Rt=this._appendLeaves(pe,St.cluster_id,et,yt,Rt):Rt<yt?Rt++:pe.push(jt),pe.length===et)break}return Rt}_createTree(pe){const ve=new s.KDBush(pe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let et=0;et<pe.length;et+=this.stride)ve.add(pe[et],pe[et+1]);return ve.finish(),ve.data=pe,ve}_addTileFeatures(pe,ve,et,yt,Rt,Ut){for(const jt of pe){const St=jt*this.stride,Kt=ve[St+gt]>1;let In,tt,Ve;if(Kt)In=je(ve,St,this.clusterProps),tt=ve[St],Ve=ve[St+1];else{const We=this.points[ve[St+dt]];In=We.properties;const[kt,_n]=We.geometry.coordinates;tt=_t(kt),Ve=Ne(_n)}const Y={type:1,geometry:[[Math.round(this.options.extent*(tt*Rt-et)),Math.round(this.options.extent*(Ve*Rt-yt))]],tags:In};let me;me=Kt||this.options.generateId?ve[St+dt]:this.points[ve[St+dt]].id,void 0!==me&&(Y.id=me),Ut.features.push(Y)}}_limitZoom(pe){return Math.max(this.options.minZoom,Math.min(Math.floor(+pe),this.options.maxZoom+1))}_cluster(pe,ve){const{radius:et,extent:yt,reduce:Rt,minPoints:Ut}=this.options,jt=et/(yt*Math.pow(2,ve)),St=pe.data,Kt=[],In=this.stride;for(let tt=0;tt<St.length;tt+=In){if(St[tt+2]<=ve)continue;St[tt+2]=ve;const Ve=St[tt],Y=St[tt+1],me=pe.within(St[tt],St[tt+1],jt),We=St[tt+gt];let kt=We;for(const _n of me){const ti=_n*In;St[ti+2]>ve&&(kt+=St[ti+gt])}if(kt>We&&kt>=Ut){let _n,ti=Ve*We,Ei=Y*We,Si=-1;const ji=((tt/In|0)<<5)+(ve+1)+this.points.length;for(const po of me){const eo=po*In;if(St[eo+2]<=ve)continue;St[eo+2]=ve;const tn=St[eo+gt];ti+=St[eo]*tn,Ei+=St[eo+1]*tn,St[eo+4]=ji,Rt&&(_n||(_n=this._map(St,tt,!0),Si=this.clusterProps.length,this.clusterProps.push(_n)),Rt(_n,this._map(St,eo)))}St[tt+4]=ji,Kt.push(ti/kt,Ei/kt,1/0,ji,-1,kt),Rt&&Kt.push(Si)}else{for(let _n=0;_n<In;_n++)Kt.push(St[tt+_n]);if(kt>1)for(const _n of me){const ti=_n*In;if(!(St[ti+2]<=ve)){St[ti+2]=ve;for(let Ei=0;Ei<In;Ei++)Kt.push(St[ti+Ei])}}}}return Kt}_getOriginId(pe){return pe-this.points.length>>5}_getOriginZoom(pe){return(pe-this.points.length)%32}_map(pe,ve,et){if(pe[ve+gt]>1){const Ut=this.clusterProps[pe[ve+ct]];return et?Object.assign({},Ut):Ut}const yt=this.points[pe[ve+dt]].properties,Rt=this.options.map(yt);return et&&Rt===yt?Object.assign({},Rt):Rt}}function vt(ut,pe,ve){return{type:"Feature",id:ut[pe+dt],properties:je(ut,pe,ve),geometry:{type:"Point",coordinates:[(et=ut[pe],360*(et-.5)),Ft(ut[pe+1])]}};var et}function je(ut,pe,ve){const et=ut[pe+gt],yt=et>=1e4?`${Math.round(et/1e3)}k`:et>=1e3?Math.round(et/100)/10+"k":et,Rt=ut[pe+ct],Ut=-1===Rt?{}:Object.assign({},ve[Rt]);return Object.assign(Ut,{cluster:!0,cluster_id:ut[pe+dt],point_count:et,point_count_abbreviated:yt})}function _t(ut){return ut/360+.5}function Ne(ut){const pe=Math.sin(ut*Math.PI/180),ve=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return ve<0?0:ve>1?1:ve}function Ft(ut){const pe=(180-360*ut)*Math.PI/180;return 360*Math.atan(Math.exp(pe))/Math.PI-90}function Gt(ut,pe,ve,et){for(var yt,Rt=et,Ut=ve-pe>>1,jt=ve-pe,St=ut[pe],Kt=ut[pe+1],In=ut[ve],tt=ut[ve+1],Ve=pe+3;Ve<ve;Ve+=3){var Y=wn(ut[Ve],ut[Ve+1],St,Kt,In,tt);if(Y>Rt)yt=Ve,Rt=Y;else if(Y===Rt){var me=Math.abs(Ve-Ut);me<jt&&(yt=Ve,jt=me)}}Rt>et&&(yt-pe>3&&Gt(ut,pe,yt,et),ut[yt+2]=Rt,ve-yt>3&&Gt(ut,yt,ve,et))}function wn(ut,pe,ve,et,yt,Rt){var Ut=yt-ve,jt=Rt-et;if(0!==Ut||0!==jt){var St=((ut-ve)*Ut+(pe-et)*jt)/(Ut*Ut+jt*jt);St>1?(ve=yt,et=Rt):St>0&&(ve+=Ut*St,et+=jt*St)}return(Ut=ut-ve)*Ut+(jt=pe-et)*jt}function Xt(ut,pe,ve,et){var yt={id:void 0===ut?null:ut,type:pe,geometry:ve,tags:et,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Rt){var Ut=Rt.geometry,jt=Rt.type;if("Point"===jt||"MultiPoint"===jt||"LineString"===jt)mn(Rt,Ut);else if("Polygon"===jt||"MultiLineString"===jt)for(var St=0;St<Ut.length;St++)mn(Rt,Ut[St]);else if("MultiPolygon"===jt)for(St=0;St<Ut.length;St++)for(var Kt=0;Kt<Ut[St].length;Kt++)mn(Rt,Ut[St][Kt])}(yt),yt}function mn(ut,pe){for(var ve=0;ve<pe.length;ve+=3)ut.minX=Math.min(ut.minX,pe[ve]),ut.minY=Math.min(ut.minY,pe[ve+1]),ut.maxX=Math.max(ut.maxX,pe[ve]),ut.maxY=Math.max(ut.maxY,pe[ve+1])}function sn(ut,pe,ve,et){if(pe.geometry){var yt=pe.geometry.coordinates,Rt=pe.geometry.type,Ut=Math.pow(ve.tolerance/((1<<ve.maxZoom)*ve.extent),2),jt=[],St=pe.id;if(ve.promoteId?St=pe.properties[ve.promoteId]:ve.generateId&&(St=et||0),"Point"===Rt)Vt(yt,jt);else if("MultiPoint"===Rt)for(var Kt=0;Kt<yt.length;Kt++)Vt(yt[Kt],jt);else if("LineString"===Rt)It(yt,jt,Ut,!1);else if("MultiLineString"===Rt){if(ve.lineMetrics){for(Kt=0;Kt<yt.length;Kt++)It(yt[Kt],jt=[],Ut,!1),ut.push(Xt(St,"LineString",jt,pe.properties));return}at(yt,jt,Ut,!1)}else if("Polygon"===Rt)at(yt,jt,Ut,!0);else{if("MultiPolygon"!==Rt){if("GeometryCollection"===Rt){for(Kt=0;Kt<pe.geometry.geometries.length;Kt++)sn(ut,{id:St,geometry:pe.geometry.geometries[Kt],properties:pe.properties},ve,et);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Kt=0;Kt<yt.length;Kt++){var In=[];at(yt[Kt],In,Ut,!0),jt.push(In)}}ut.push(Xt(St,Rt,jt,pe.properties))}}function Vt(ut,pe){pe.push(Wt(ut[0])),pe.push(dn(ut[1])),pe.push(0)}function It(ut,pe,ve,et){for(var yt,Rt,Ut=0,jt=0;jt<ut.length;jt++){var St=Wt(ut[jt][0]),Kt=dn(ut[jt][1]);pe.push(St),pe.push(Kt),pe.push(0),jt>0&&(Ut+=et?(yt*Kt-St*Rt)/2:Math.sqrt(Math.pow(St-yt,2)+Math.pow(Kt-Rt,2))),yt=St,Rt=Kt}var In=pe.length-3;pe[2]=1,Gt(pe,0,In,ve),pe[In+2]=1,pe.size=Math.abs(Ut),pe.start=0,pe.end=pe.size}function at(ut,pe,ve,et){for(var yt=0;yt<ut.length;yt++){var Rt=[];It(ut[yt],Rt,ve,et),pe.push(Rt)}}function Wt(ut){return ut/360+.5}function dn(ut){var pe=Math.sin(ut*Math.PI/180),ve=.5-.25*Math.log((1+pe)/(1-pe))/Math.PI;return ve<0?0:ve>1?1:ve}function Sn(ut,pe,ve,et,yt,Rt,Ut,jt){if(et/=pe,Rt>=(ve/=pe)&&Ut<et)return ut;if(Ut<ve||Rt>=et)return null;for(var St=[],Kt=0;Kt<ut.length;Kt++){var In=ut[Kt],tt=In.geometry,Ve=In.type,Y=0===yt?In.minX:In.minY,me=0===yt?In.maxX:In.maxY;if(Y>=ve&&me<et)St.push(In);else if(!(me<ve||Y>=et)){var We=[];if("Point"===Ve||"MultiPoint"===Ve)Nt(tt,We,ve,et,yt);else if("LineString"===Ve)yi(tt,We,ve,et,yt,!1,jt.lineMetrics);else if("MultiLineString"===Ve)gn(tt,We,ve,et,yt,!1);else if("Polygon"===Ve)gn(tt,We,ve,et,yt,!0);else if("MultiPolygon"===Ve)for(var kt=0;kt<tt.length;kt++){var _n=[];gn(tt[kt],_n,ve,et,yt,!0),_n.length&&We.push(_n)}if(We.length){if(jt.lineMetrics&&"LineString"===Ve){for(kt=0;kt<We.length;kt++)St.push(Xt(In.id,Ve,We[kt],In.tags));continue}"LineString"!==Ve&&"MultiLineString"!==Ve||(1===We.length?(Ve="LineString",We=We[0]):Ve="MultiLineString"),"Point"!==Ve&&"MultiPoint"!==Ve||(Ve=3===We.length?"Point":"MultiPoint"),St.push(Xt(In.id,Ve,We,In.tags))}}}return St.length?St:null}function Nt(ut,pe,ve,et,yt){for(var Rt=0;Rt<ut.length;Rt+=3){var Ut=ut[Rt+yt];Ut>=ve&&Ut<=et&&(pe.push(ut[Rt]),pe.push(ut[Rt+1]),pe.push(ut[Rt+2]))}}function yi(ut,pe,ve,et,yt,Rt,Ut){for(var jt,St,Kt=Gi(ut),In=0===yt?Je:At,tt=ut.start,Ve=0;Ve<ut.length-3;Ve+=3){var Y=ut[Ve],me=ut[Ve+1],We=ut[Ve+2],kt=ut[Ve+3],_n=ut[Ve+4],ti=0===yt?Y:me,Ei=0===yt?kt:_n,Si=!1;Ut&&(jt=Math.sqrt(Math.pow(Y-kt,2)+Math.pow(me-_n,2))),ti<ve?Ei>ve&&(St=In(Kt,Y,me,kt,_n,ve),Ut&&(Kt.start=tt+jt*St)):ti>et?Ei<et&&(St=In(Kt,Y,me,kt,_n,et),Ut&&(Kt.start=tt+jt*St)):si(Kt,Y,me,We),Ei<ve&&ti>=ve&&(St=In(Kt,Y,me,kt,_n,ve),Si=!0),Ei>et&&ti<=et&&(St=In(Kt,Y,me,kt,_n,et),Si=!0),!Rt&&Si&&(Ut&&(Kt.end=tt+jt*St),pe.push(Kt),Kt=Gi(ut)),Ut&&(tt+=jt)}var ji=ut.length-3;Y=ut[ji],me=ut[ji+1],We=ut[ji+2],(ti=0===yt?Y:me)>=ve&&ti<=et&&si(Kt,Y,me,We),ji=Kt.length-3,Rt&&ji>=3&&(Kt[ji]!==Kt[0]||Kt[ji+1]!==Kt[1])&&si(Kt,Kt[0],Kt[1],Kt[2]),Kt.length&&pe.push(Kt)}function Gi(ut){var pe=[];return pe.size=ut.size,pe.start=ut.start,pe.end=ut.end,pe}function gn(ut,pe,ve,et,yt,Rt){for(var Ut=0;Ut<ut.length;Ut++)yi(ut[Ut],pe,ve,et,yt,Rt,!1)}function si(ut,pe,ve,et){ut.push(pe),ut.push(ve),ut.push(et)}function Je(ut,pe,ve,et,yt,Rt){var Ut=(Rt-pe)/(et-pe);return ut.push(Rt),ut.push(ve+(yt-ve)*Ut),ut.push(1),Ut}function At(ut,pe,ve,et,yt,Rt){var Ut=(Rt-ve)/(yt-ve);return ut.push(pe+(et-pe)*Ut),ut.push(Rt),ut.push(1),Ut}function Zt(ut,pe){for(var ve=[],et=0;et<ut.length;et++){var yt,Rt=ut[et],Ut=Rt.type;if("Point"===Ut||"MultiPoint"===Ut||"LineString"===Ut)yt=un(Rt.geometry,pe);else if("MultiLineString"===Ut||"Polygon"===Ut){yt=[];for(var jt=0;jt<Rt.geometry.length;jt++)yt.push(un(Rt.geometry[jt],pe))}else if("MultiPolygon"===Ut)for(yt=[],jt=0;jt<Rt.geometry.length;jt++){for(var St=[],Kt=0;Kt<Rt.geometry[jt].length;Kt++)St.push(un(Rt.geometry[jt][Kt],pe));yt.push(St)}ve.push(Xt(Rt.id,Ut,yt,Rt.tags))}return ve}function un(ut,pe){var ve=[];ve.size=ut.size,void 0!==ut.start&&(ve.start=ut.start,ve.end=ut.end);for(var et=0;et<ut.length;et+=3)ve.push(ut[et]+pe,ut[et+1],ut[et+2]);return ve}function hn(ut,pe){if(ut.transformed)return ut;var ve,et,yt,Rt=1<<ut.z,Ut=ut.x,jt=ut.y;for(ve=0;ve<ut.features.length;ve++){var St=ut.features[ve],Kt=St.geometry,In=St.type;if(St.geometry=[],1===In)for(et=0;et<Kt.length;et+=2)St.geometry.push(gi(Kt[et],Kt[et+1],pe,Rt,Ut,jt));else for(et=0;et<Kt.length;et++){var tt=[];for(yt=0;yt<Kt[et].length;yt+=2)tt.push(gi(Kt[et][yt],Kt[et][yt+1],pe,Rt,Ut,jt));St.geometry.push(tt)}}return ut.transformed=!0,ut}function gi(ut,pe,ve,et,yt,Rt){return[Math.round(ve*(ut*et-yt)),Math.round(ve*(pe*et-Rt))]}function Yt(ut,pe,ve,et,yt){for(var Rt=pe===yt.maxZoom?0:yt.tolerance/((1<<pe)*yt.extent),Ut={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:ve,y:et,z:pe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},jt=0;jt<ut.length;jt++){Ut.numFeatures++,Un(Ut,ut[jt],Rt,yt);var St=ut[jt].minX,Kt=ut[jt].minY,In=ut[jt].maxX,tt=ut[jt].maxY;St<Ut.minX&&(Ut.minX=St),Kt<Ut.minY&&(Ut.minY=Kt),In>Ut.maxX&&(Ut.maxX=In),tt>Ut.maxY&&(Ut.maxY=tt)}return Ut}function Un(ut,pe,ve,et){var yt=pe.geometry,Rt=pe.type,Ut=[];if("Point"===Rt||"MultiPoint"===Rt)for(var jt=0;jt<yt.length;jt+=3)Ut.push(yt[jt]),Ut.push(yt[jt+1]),ut.numPoints++,ut.numSimplified++;else if("LineString"===Rt)oi(Ut,yt,ut,ve,!1,!1);else if("MultiLineString"===Rt||"Polygon"===Rt)for(jt=0;jt<yt.length;jt++)oi(Ut,yt[jt],ut,ve,"Polygon"===Rt,0===jt);else if("MultiPolygon"===Rt)for(var St=0;St<yt.length;St++){var Kt=yt[St];for(jt=0;jt<Kt.length;jt++)oi(Ut,Kt[jt],ut,ve,!0,0===jt)}if(Ut.length){var In=pe.tags||null;if("LineString"===Rt&&et.lineMetrics){for(var tt in In={},pe.tags)In[tt]=pe.tags[tt];In.mapbox_clip_start=yt.start/yt.size,In.mapbox_clip_end=yt.end/yt.size}var Ve={geometry:Ut,type:"Polygon"===Rt||"MultiPolygon"===Rt?3:"LineString"===Rt||"MultiLineString"===Rt?2:1,tags:In};null!==pe.id&&(Ve.id=pe.id),ut.features.push(Ve)}}function oi(ut,pe,ve,et,yt,Rt){var Ut=et*et;if(et>0&&pe.size<(yt?Ut:et))ve.numPoints+=pe.length/3;else{for(var jt=[],St=0;St<pe.length;St+=3)(0===et||pe[St+2]>Ut)&&(ve.numSimplified++,jt.push(pe[St]),jt.push(pe[St+1])),ve.numPoints++;yt&&function(Kt,In){for(var tt=0,Ve=0,Y=Kt.length,me=Y-2;Ve<Y;me=Ve,Ve+=2)tt+=(Kt[Ve]-Kt[me])*(Kt[Ve+1]+Kt[me+1]);if(tt>0===In)for(Ve=0,Y=Kt.length;Ve<Y/2;Ve+=2){var We=Kt[Ve],kt=Kt[Ve+1];Kt[Ve]=Kt[Y-2-Ve],Kt[Ve+1]=Kt[Y-1-Ve],Kt[Y-2-Ve]=We,Kt[Y-1-Ve]=kt}}(jt,Rt),ut.push(jt)}}function Ci(ut,pe){var ve=(pe=this.options=function(yt,Rt){for(var Ut in Rt)yt[Ut]=Rt[Ut];return yt}(Object.create(this.options),pe)).debug;if(ve&&console.time("preprocess data"),pe.maxZoom<0||pe.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(pe.promoteId&&pe.generateId)throw new Error("promoteId and generateId cannot be used together.");var yt,Rt,Ut,jt,St,Kt,et=function(yt,Rt){var Ut=[];if("FeatureCollection"===yt.type)for(var jt=0;jt<yt.features.length;jt++)sn(Ut,yt.features[jt],Rt,jt);else sn(Ut,"Feature"===yt.type?yt:{geometry:yt},Rt);return Ut}(ut,pe);this.tiles={},this.tileCoords=[],ve&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",pe.indexMaxZoom,pe.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),jt=yt=et,St=Sn(yt,1,-1-(Ut=(Rt=pe).buffer/Rt.extent),Ut,0,-1,2,Rt),Kt=Sn(yt,1,1-Ut,2+Ut,0,-1,2,Rt),(St||Kt)&&(jt=Sn(yt,1,-Ut,1+Ut,0,-1,2,Rt)||[],St&&(jt=Zt(St,1).concat(jt)),Kt&&(jt=jt.concat(Zt(Kt,-1)))),(et=jt).length&&this.splitTile(et,0,0,0),ve&&(et.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Oi(ut,pe,ve){return 32*((1<<ut)*ve+pe)+ut}function Po(ut,pe){const ve=ut.tileID.canonical;if(!this._geoJSONIndex)return pe(null,null);const et=this._geoJSONIndex.getTile(ve.z,ve.x,ve.y);if(!et)return pe(null,null);const yt=new class{constructor(Ut){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.EXTENT,this.length=Ut.length,this._features=Ut}feature(Ut){return new class{constructor(jt){this._feature=jt,this.extent=s.EXTENT,this.type=jt.type,this.properties=jt.tags,"id"in jt&&!isNaN(jt.id)&&(this.id=parseInt(jt.id,10))}loadGeometry(){if(1===this._feature.type){const jt=[];for(const St of this._feature.geometry)jt.push([new s.Point(St[0],St[1])]);return jt}{const jt=[];for(const St of this._feature.geometry){const Kt=[];for(const In of St)Kt.push(new s.Point(In[0],In[1]));jt.push(Kt)}return jt}}toGeoJSON(jt,St,Kt){return X.call(this,jt,St,Kt)}}(this._features[Ut])}}(et.features);let Rt=Ze(yt);0===Rt.byteOffset&&Rt.byteLength===Rt.buffer.byteLength||(Rt=new Uint8Array(Rt)),pe(null,{vectorTile:yt,rawData:Rt.buffer})}Ci.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Ci.prototype.splitTile=function(ut,pe,ve,et,yt,Rt,Ut){for(var jt=[ut,pe,ve,et],St=this.options,Kt=St.debug;jt.length;){et=jt.pop(),ve=jt.pop(),pe=jt.pop(),ut=jt.pop();var In=1<<pe,tt=Oi(pe,ve,et),Ve=this.tiles[tt];if(!Ve&&(Kt>1&&console.time("creation"),Ve=this.tiles[tt]=Yt(ut,pe,ve,et,St),this.tileCoords.push({z:pe,x:ve,y:et}),Kt)){Kt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",pe,ve,et,Ve.numFeatures,Ve.numPoints,Ve.numSimplified),console.timeEnd("creation"));var Y="z"+pe;this.stats[Y]=(this.stats[Y]||0)+1,this.total++}if(Ve.source=ut,yt){if(pe===St.maxZoom||pe===yt)continue;var me=1<<yt-pe;if(ve!==Math.floor(Rt/me)||et!==Math.floor(Ut/me))continue}else if(pe===St.indexMaxZoom||Ve.numPoints<=St.indexMaxPoints)continue;if(Ve.source=null,0!==ut.length){Kt>1&&console.time("clipping");var We,kt,_n,ti,Ei,Si,ji=.5*St.buffer/St.extent,po=.5-ji,eo=.5+ji,tn=1+ji;We=kt=_n=ti=null,Ei=Sn(ut,In,ve-ji,ve+eo,0,Ve.minX,Ve.maxX,St),Si=Sn(ut,In,ve+po,ve+tn,0,Ve.minX,Ve.maxX,St),ut=null,Ei&&(We=Sn(Ei,In,et-ji,et+eo,1,Ve.minY,Ve.maxY,St),kt=Sn(Ei,In,et+po,et+tn,1,Ve.minY,Ve.maxY,St),Ei=null),Si&&(_n=Sn(Si,In,et-ji,et+eo,1,Ve.minY,Ve.maxY,St),ti=Sn(Si,In,et+po,et+tn,1,Ve.minY,Ve.maxY,St),Si=null),Kt>1&&console.timeEnd("clipping"),jt.push(We||[],pe+1,2*ve,2*et),jt.push(kt||[],pe+1,2*ve,2*et+1),jt.push(_n||[],pe+1,2*ve+1,2*et),jt.push(ti||[],pe+1,2*ve+1,2*et+1)}}},Ci.prototype.getTile=function(ut,pe,ve){var et=this.options,yt=et.extent,Rt=et.debug;if(ut<0||ut>24)return null;var Ut=1<<ut,jt=Oi(ut,pe=(pe%Ut+Ut)%Ut,ve);if(this.tiles[jt])return hn(this.tiles[jt],yt);Rt>1&&console.log("drilling down to z%d-%d-%d",ut,pe,ve);for(var St,Kt=ut,In=pe,tt=ve;!St&&Kt>0;)Kt--,In=Math.floor(In/2),tt=Math.floor(tt/2),St=this.tiles[Oi(Kt,In,tt)];return St&&St.source?(Rt>1&&console.log("found parent tile z%d-%d-%d",Kt,In,tt),Rt>1&&console.time("drilling down"),this.splitTile(St.source,Kt,In,tt,ut,pe,ve),Rt>1&&console.timeEnd("drilling down"),this.tiles[jt]?hn(this.tiles[jt],yt):null):null};class fi extends s.VectorTileWorkerSource{constructor(pe,ve,et,yt,Rt){super(pe,ve,et,yt,Po),Rt&&(this.loadGeoJSON=Rt)}loadData(pe,ve){const et=pe&&pe.request,yt=et&&et.collectResourceTiming;this.loadGeoJSON(pe,(Rt,Ut)=>{if(Rt||!Ut)return ve(Rt);if("object"!=typeof Ut)return ve(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));{De(Ut,!0);try{if(pe.filter){const St=s.createExpression(pe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===St.result)throw new Error(St.value.map(In=>`${In.key}: ${In.message}`).join(", "));Ut={type:"FeatureCollection",features:Ut.features.filter(In=>St.value.evaluate({zoom:0},In))}}this._geoJSONIndex=pe.cluster?new Ue(function({superclusterOptions:St,clusterProperties:Kt}){if(!Kt||!St)return St;const In={},tt={},Ve={accumulated:null,zoom:0},Y={properties:null},me=Object.keys(Kt);for(const We of me){const[kt,_n]=Kt[We],ti=s.createExpression(_n),Ei=s.createExpression("string"==typeof kt?[kt,["accumulated"],["get",We]]:kt);In[We]=ti.value,tt[We]=Ei.value}return St.map=We=>{Y.properties=We;const kt={};for(const _n of me)kt[_n]=In[_n].evaluate(Ve,Y);return kt},St.reduce=(We,kt)=>{Y.properties=kt;for(const _n of me)Ve.accumulated=We[_n],We[_n]=tt[_n].evaluate(Ve,Y)},St}(pe)).load(Ut.features):new Ci(St=Ut,pe.geojsonVtOptions)}catch(St){return ve(St)}this.loaded={};const jt={};if(yt){const St=s.getPerformanceMeasurement(et);St&&(jt.resourceTiming={},jt.resourceTiming[pe.source]=JSON.parse(JSON.stringify(St)))}ve(null,jt)}var St})}reloadTile(pe,ve){const et=this.loaded;return et&&et[pe.uid]?super.reloadTile(pe,ve):this.loadTile(pe,ve)}loadGeoJSON(pe,ve){if(pe.request)s.getJSON(pe.request,ve);else{if("string"!=typeof pe.data)return ve(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`));try{return ve(null,JSON.parse(pe.data))}catch{return ve(new Error(`Input data given to '${pe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(pe,ve){try{ve(null,this._geoJSONIndex.getClusterExpansionZoom(pe.clusterId))}catch(et){ve(et)}}getClusterChildren(pe,ve){try{ve(null,this._geoJSONIndex.getChildren(pe.clusterId))}catch(et){ve(et)}}getClusterLeaves(pe,ve){try{ve(null,this._geoJSONIndex.getLeaves(pe.clusterId,pe.limit,pe.offset))}catch(et){ve(et)}}}class Vo{constructor(pe){this.self=pe,this.actor=new s.Actor(pe,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=s.getProjection({name:"mercator"}),this.workerSourceTypes={vector:s.VectorTileWorkerSource,geojson:fi},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(ve,et)=>{if(this.workerSourceTypes[ve])throw new Error(`Worker source with name "${ve}" already registered.`);this.workerSourceTypes[ve]=et},this.self.registerRTLTextPlugin=ve=>{if(s.plugin.isParsed())throw new Error("RTL text plugin already registered.");s.plugin.applyArabicShaping=ve.applyArabicShaping,s.plugin.processBidirectionalText=ve.processBidirectionalText,s.plugin.processStyledBidirectionalText=ve.processStyledBidirectionalText}}clearCaches(pe,ve,et){delete this.layerIndexes[pe],delete this.availableImages[pe],delete this.workerSources[pe],delete this.demWorkerSources[pe],et()}checkIfReady(pe,ve,et){et()}setReferrer(pe,ve){this.referrer=ve}spriteLoaded(pe,ve){this.isSpriteLoaded[pe]=ve;for(const et in this.workerSources[pe]){const yt=this.workerSources[pe][et];for(const Rt in yt)yt[Rt]instanceof s.VectorTileWorkerSource&&(yt[Rt].isSpriteLoaded=ve,yt[Rt].fire(new s.Event("isSpriteLoaded")))}}setImages(pe,ve,et){this.availableImages[pe]=ve;for(const yt in this.workerSources[pe]){const Rt=this.workerSources[pe][yt];for(const Ut in Rt)Rt[Ut].availableImages=ve}et()}enableTerrain(pe,ve,et){this.terrain=ve,et()}setProjection(pe,ve){this.projections[pe]=s.getProjection(ve)}setLayers(pe,ve,et){this.getLayerIndex(pe).replace(ve),et()}updateLayers(pe,ve,et){this.getLayerIndex(pe).update(ve.layers,ve.removedIds),et()}loadTile(pe,ve,et){const yt=this.enableTerrain?s.extend({enableTerrain:this.terrain},ve):ve;yt.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,ve.type,ve.source).loadTile(yt,et)}loadDEMTile(pe,ve,et){const yt=this.enableTerrain?s.extend({buildQuadTree:this.terrain},ve):ve;this.getDEMWorkerSource(pe,ve.source).loadTile(yt,et)}reloadTile(pe,ve,et){const yt=this.enableTerrain?s.extend({enableTerrain:this.terrain},ve):ve;yt.projection=this.projections[pe]||this.defaultProjection,this.getWorkerSource(pe,ve.type,ve.source).reloadTile(yt,et)}abortTile(pe,ve,et){this.getWorkerSource(pe,ve.type,ve.source).abortTile(ve,et)}removeTile(pe,ve,et){this.getWorkerSource(pe,ve.type,ve.source).removeTile(ve,et)}removeSource(pe,ve,et){if(!this.workerSources[pe]||!this.workerSources[pe][ve.type]||!this.workerSources[pe][ve.type][ve.source])return;const yt=this.workerSources[pe][ve.type][ve.source];delete this.workerSources[pe][ve.type][ve.source],void 0!==yt.removeSource?yt.removeSource(ve,et):et()}loadWorkerSource(pe,ve,et){try{this.self.importScripts(ve.url),et()}catch(yt){et(yt.toString())}}syncRTLPluginState(pe,ve,et){try{s.plugin.setState(ve);const yt=s.plugin.getPluginURL();if(s.plugin.isLoaded()&&!s.plugin.isParsed()&&null!=yt){this.self.importScripts(yt);const Rt=s.plugin.isParsed();et(Rt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${yt}`),Rt)}}catch(yt){et(yt.toString())}}getAvailableImages(pe){let ve=this.availableImages[pe];return ve||(ve=[]),ve}getLayerIndex(pe){let ve=this.layerIndexes[pe];return ve||(ve=this.layerIndexes[pe]=new W),ve}getWorkerSource(pe,ve,et){return this.workerSources[pe]||(this.workerSources[pe]={}),this.workerSources[pe][ve]||(this.workerSources[pe][ve]={}),this.workerSources[pe][ve][et]||(this.workerSources[pe][ve][et]=new this.workerSourceTypes[ve]({send:(Rt,Ut,jt,St,Kt,In)=>{this.actor.send(Rt,Ut,jt,pe,Kt,In)},scheduler:this.actor.scheduler},this.getLayerIndex(pe),this.getAvailableImages(pe),this.isSpriteLoaded[pe])),this.workerSources[pe][ve][et]}getDEMWorkerSource(pe,ve){return this.demWorkerSources[pe]||(this.demWorkerSources[pe]={}),this.demWorkerSources[pe][ve]||(this.demWorkerSources[pe][ve]=new w),this.demWorkerSources[pe][ve]}enforceCacheSizeLimit(pe,ve){s.enforceCacheSizeLimit(ve)}getWorkerPerformanceMetrics(pe,ve,et){et(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Vo(self)),Vo}),d(0,function(s){function Q(p,o){if(Array.isArray(p)){if(!Array.isArray(o)||p.length!==o.length)return!1;for(let c=0;c<p.length;c++)if(!Q(p[c],o[c]))return!1;return!0}if("object"==typeof p&&null!==p&&null!==o){if("object"!=typeof o||Object.keys(p).length!==Object.keys(o).length)return!1;for(const c in p)if(!Q(p[c],o[c]))return!1;return!0}return p===o}var ie=W;function W(p){return o=p,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var m,x,C=new Blob([""],{type:"text/javascript"}),I=URL.createObjectURL(C);try{x=new Worker(I),m=!0}catch{m=!1}return x&&x.terminate(),URL.revokeObjectURL(I),m}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var m=document.createElement("canvas");m.width=m.height=1;var x=m.getContext("2d");if(!x)return!1;var C=x.getImageData(0,0,1,1);return C&&C.width===m.width}()||(void 0===w[c=o&&o.failIfMajorPerformanceCaveat]&&(w[c]=function(m){var x,I,O,N,C=(I=m,O=document.createElement("canvas"),(N=Object.create(W.webGLContextAttributes)).failIfMajorPerformanceCaveat=I,O.getContext("webgl",N)||O.getContext("experimental-webgl",N));if(!C)return!1;try{x=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!x||C.isContextLost())&&(C.shaderSource(x,"void main() {}"),C.compileShader(x),!0===C.getShaderParameter(x,C.COMPILE_STATUS))}(c)),!w[c]||document.documentMode));var o,c}var w={};function fe(p,o,c){const m=s.window.document.createElement(p);return void 0!==o&&(m.className=o),c&&c.appendChild(m),m}function Ae(p,o,c){const m=s.window.document.createElementNS("http://www.w3.org/2000/svg",p);for(const x of Object.keys(o))m.setAttributeNS(null,x,o[x]);return c&&c.appendChild(m),m}W.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const De=s.window.document&&s.window.document.documentElement.style,X=De&&void 0!==De.userSelect?"userSelect":"WebkitUserSelect";let se;function Te(){De&&X&&(se=De[X],De[X]="none")}function ge(){De&&X&&(De[X]=se)}function we(p){p.preventDefault(),p.stopPropagation(),s.window.removeEventListener("click",we,!0)}function Le(){s.window.addEventListener("click",we,!0),s.window.setTimeout(()=>{s.window.removeEventListener("click",we,!0)},0)}function Me(p,o){const c=p.getBoundingClientRect();return Oe(p,c,o)}function ze(p,o){const c=p.getBoundingClientRect(),m=[];for(let x=0;x<o.length;x++)m.push(Oe(p,c,o[x]));return m}function Ke(p){return void 0!==s.window.InstallTrigger&&2===p.button&&p.ctrlKey&&s.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:p.button}function Oe(p,o,c){const m=p.offsetWidth===o.width?1:p.offsetWidth/o.width;return new s.Point((c.clientX-o.left)*m,(c.clientY-o.top)*m)}function Ce(p,o){var c=o[0],m=o[1],x=o[2],C=o[3],I=c*C-x*m;return I?(p[0]=C*(I=1/I),p[1]=-m*I,p[2]=-x*I,p[3]=c*I,p):null}function nt(p){const{userImage:o}=p;return!!(o&&o.render&&o.render())&&(p.data.replace(new Uint8Array(o.data.buffer)),!0)}class Xe extends s.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new s.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:c,callback:m}of this.requestors)this._notify(c,m);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,c){this._validate(o,c)&&(this.images[o]=c)}_validate(o,c){let m=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),m=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),m=!1),this._validateContent(c.content,c)||(this.fire(new s.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),m=!1),m}_validateStretch(o,c){if(!o)return!0;let m=0;for(const x of o){if(x[0]<m||x[1]<x[0]||c<x[1])return!1;m=x[1]}return!0}_validateContent(o,c){return!(o&&(4!==o.length||o[0]<0||c.data.width<o[0]||o[1]<0||c.data.height<o[1]||o[2]<0||c.data.width<o[2]||o[3]<0||c.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,c){c.version=this.images[o].version+1,this.images[o]=c,this.updatedImages[o]=!0}removeImage(o){const c=this.images[o];delete this.images[o],delete this.patterns[o],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,c){let m=!0;if(!this.isLoaded())for(const x of o)this.images[x]||(m=!1);this.isLoaded()||m?this._notify(o,c):this.requestors.push({ids:o,callback:c})}_notify(o,c){const m={};for(const x of o){this.images[x]||this.fire(new s.Event("styleimagemissing",{id:x}));const C=this.images[x];C?m[x]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!(!C.userImage||!C.userImage.render)}:s.warnOnce(`Image "${x}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,m)}getPixelSize(){const{width:o,height:c}=this.atlasImage;return{width:o,height:c}}getPattern(o){const c=this.patterns[o],m=this.getImage(o);if(!m)return null;if(c&&c.position.version===m.version)return c.position;if(c)c.position.version=m.version;else{const x={w:m.data.width+2,h:m.data.height+2,x:0,y:0},C=new s.ImagePosition(x,m);this.patterns[o]={bin:x,position:C}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const c=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new s.Texture(o,this.atlasImage,c.RGBA),this.atlasTexture&&this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const C in this.patterns)o.push(this.patterns[C].bin);const{w:c,h:m}=s.potpack(o),x=this.atlasImage;x.resize({width:c||1,height:m||1});for(const C in this.patterns){const{bin:I}=this.patterns[C],O=I.x+1,N=I.y+1,H=this.images[C].data,$=H.width,ce=H.height;s.RGBAImage.copy(H,x,{x:0,y:0},{x:O,y:N},{width:$,height:ce}),s.RGBAImage.copy(H,x,{x:0,y:ce-1},{x:O,y:N-1},{width:$,height:1}),s.RGBAImage.copy(H,x,{x:0,y:0},{x:O,y:N+ce},{width:$,height:1}),s.RGBAImage.copy(H,x,{x:$-1,y:0},{x:O-1,y:N},{width:1,height:ce}),s.RGBAImage.copy(H,x,{x:0,y:0},{x:O+$,y:N},{width:1,height:ce})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const c of o){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const m=this.images[c];nt(m)&&this.updateImage(c,m)}}}const Ee=new s.Properties({anchor:new s.DataConstantProperty(s.spec.light.anchor),position:new class{constructor(){this.specification=s.spec.light.position}possiblyEvaluate(p,o){return function([c,m,x]){const C=s.degToRad(m+90),I=s.degToRad(x);return{x:c*Math.cos(C)*Math.sin(I),y:c*Math.sin(C)*Math.sin(I),z:c*Math.cos(I),azimuthal:m,polar:x}}(p.expression.evaluate(o))}interpolate(p,o,c){return{x:s.number(p.x,o.x,c),y:s.number(p.y,o.y,c),z:s.number(p.z,o.z,c),azimuthal:s.number(p.azimuthal,o.azimuthal,c),polar:s.number(p.polar,o.polar,c)}}},color:new s.DataConstantProperty(s.spec.light.color),intensity:new s.DataConstantProperty(s.spec.light.intensity)});class ae extends s.Evented{constructor(o){super(),this._transitionable=new s.Transitionable(Ee),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,c={}){if(!this._validate(s.validateLight,o,c))for(const m in o){const x=o[m];s.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),x):this._transitionable.setValue(m,x)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,m){return(!m||!1!==m.validate)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}const mt=new s.Properties({source:new s.DataConstantProperty(s.spec.terrain.source),exaggeration:new s.DataConstantProperty(s.spec.terrain.exaggeration)});let xe=class extends s.Evented{constructor(p,o){super(),this._transitionable=new s.Transitionable(mt),this.set(p),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(p){for(const o in p){const c=p[o];s.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),c):this._transitionable.setValue(o,c)}}updateTransitions(p){this._transitioning=this._transitionable.transitioned(p,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(p){this.properties=this._transitioning.possiblyEvaluate(p)}};function Ze(p,o,c,m){const x=s.smoothstep(45,65,c),[C,I]=Se(p,m),O=s.length(o);let N=1-Math.min(1,Math.exp((O-C)/(I-C)*-6));return N*=N*N,N=Math.min(1,1.00747*N),N*x*p.alpha}function Se(p,o){const c=.5/Math.tan(.5*o);return[p.range[0]+c,p.range[1]+c]}const ye=new s.Properties({range:new s.DataConstantProperty(s.spec.fog.range),color:new s.DataConstantProperty(s.spec.fog.color),"high-color":new s.DataConstantProperty(s.spec.fog["high-color"]),"space-color":new s.DataConstantProperty(s.spec.fog["space-color"]),"horizon-blend":new s.DataConstantProperty(s.spec.fog["horizon-blend"]),"star-intensity":new s.DataConstantProperty(s.spec.fog["star-intensity"])});class Qt extends s.Evented{constructor(o,c){super(),this._transitionable=new s.Transitionable(ye),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const o=this._transform,c="globe"===o.projection.name,m=s.globeToMercatorTransition(o.zoom),x=this.properties.get("range"),C=[.5,3];return{range:c?[s.number(C[0],x[0],m),s.number(C[1],x[1],m)]:x,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,c={}){if(!this._validate(s.validateFog,o,c)){for(const m of Object.keys(s.spec.fog))o&&void 0===o[m]&&(o[m]=s.spec.fog[m].default);for(const m in o){const x=o[m];s.endsWith(m,"-transition")?this._transitionable.setTransition(m.slice(0,-11),x):this._transitionable.setValue(m,x)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:s.smoothstep(45,65,o))*c.a}getOpacityAtLatLng(o,c){return this._transform.projection.supportsFog?function(m,x,C){const I=s.MercatorCoordinate.fromLngLat(x),O=C.elevation?C.elevation.getAtPointOrZero(I):0,N=[I.x,I.y,O];return s.transformMat4(N,N,C.mercatorFogMatrix),Ze(m,N,C.pitch,C._fov)}(this.state,o,c):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?Se(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,c,m){return(!m||!1!==m.validate)&&s.emitValidationErrors(this,o.call(s.validateStyle,s.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:s.spec})))}}class dt{constructor(o,c){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=s.uniqueId();const m=this.workerPool.acquire(this.id);for(let x=0;x<m.length;x++){const C=new dt.Actor(m[x],c,this.id);C.name=`Worker ${x}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(o,c,m){s.asyncAll(this.actors,(x,C)=>{x.send(o,c,C)},m=m||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(o=>{o.remove()}),this.actors=[],this.workerPool.release(this.id)}}function gt(p,o,c){return o*(s.EXTENT/(p.tileSize*Math.pow(2,c-p.tileID.overscaledZ)))}dt.Actor=s.Actor;class ct{constructor(o,c,m,x){this.screenBounds=o,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=m,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,x)}static createFromScreenPoints(o,c){let m,x;if(o instanceof s.Point||"number"==typeof o[0]){const C=s.Point.convert(o);m=[C],x=c.isPointAboveHorizon(C)}else{const C=s.Point.convert(o[0]),I=s.Point.convert(o[1]);m=[C,I],x=s.polygonizeBounds(C,I).every(O=>c.isPointAboveHorizon(O))}return new ct(m,c.getCameraPoint(),x,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(o){return s.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const c=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],x=s.polygonizeBounds(c,m,0,!1);return this.cameraPoint.y>m.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<m.x?x.splice(3,0,this.cameraPoint):this.cameraPoint.x>=m.x?x[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(x[3]=this.cameraPoint)),s.bufferConvexPolygon(x,o)}bufferedCameraGeometryGlobe(o){const c=this.screenBounds[0],m=1===this.screenBounds.length?this.screenBounds[0].add(new s.Point(1,1)):this.screenBounds[1],x=s.polygonizeBounds(c,m,o),C=this.cameraPoint.clone();switch(3*((C.y>c.y)+(C.y>m.y))+((C.x>c.x)+(C.x>m.x))){case 0:x[0]=C,x[4]=C.clone();break;case 1:x.splice(1,0,C);break;case 2:x[1]=C;break;case 3:x.splice(4,0,C);break;case 5:x.splice(2,0,C);break;case 6:x[3]=C;break;case 7:x.splice(3,0,C);break;case 8:x[2]=C}return x}containsTile(o,c,m,x=0){const C=o.queryPadding/c._pixelsPerMercatorPixel+1,I=m?this._bufferedCameraMercator(C,c):this._bufferedScreenMercator(C,c);let O=o.tileID.wrap+(I.unwrapped?x:0);const N=I.polygon.map(ot=>s.getTilePoint(o.tileTransform,ot,O));if(!s.polygonIntersectsBox(N,0,0,s.EXTENT,s.EXTENT))return;O=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?x:0);const H=this.screenGeometryMercator.polygon.map(ot=>s.getTileVec3(o.tileTransform,ot,O)),$=H.map(ot=>new s.Point(ot[0],ot[1])),ce=c.getFreeCameraOptions().position||new s.MercatorCoordinate(0,0,0),Ie=s.getTileVec3(o.tileTransform,ce,O),$e=H.map(ot=>{const ue=s.sub(ot,ot,Ie);return s.normalize(ue,ue),new s.Ray(Ie,ue)}),Qe=gt(o,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:$e,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(Ye=s.getBounds(N),Ye.min.x=s.clamp(Ye.min.x,0,s.EXTENT),Ye.min.y=s.clamp(Ye.min.y,0,s.EXTENT),Ye.max.x=s.clamp(Ye.max.x,0,s.EXTENT),Ye.max.y=s.clamp(Ye.max.y,0,s.EXTENT),Ye),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:Qe};var Ye}_bufferedScreenMercator(o,c){const m=je(o);if(this._screenRaycastCache[m])return this._screenRaycastCache[m];{let x;return x="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(o),c):{polygon:this.bufferedScreenGeometry(o).map(C=>c.pointCoordinate3D(C)),unwrapped:!0},this._screenRaycastCache[m]=x,x}}_bufferedCameraMercator(o,c){const m=je(o);if(this._cameraRaycastCache[m])return this._cameraRaycastCache[m];{let x;return x="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),c):{polygon:this.bufferedCameraGeometry(o).map(C=>c.pointCoordinate3D(C)),unwrapped:!0},this._cameraRaycastCache[m]=x,x}}_projectAndResample(o,c){const m=function(C,I){const O=s.multiply([],I.pixelMatrix,I.globeMatrix),N=[0,-s.GLOBE_RADIUS,0,1],H=[0,s.GLOBE_RADIUS,0,1],$=[0,0,0,1];s.transformMat4$1(N,N,O),s.transformMat4$1(H,H,O),s.transformMat4$1($,$,O);const ce=new s.Point(N[0]/N[3],N[1]/N[3]),Ie=new s.Point(H[0]/H[3],H[1]/H[3]),$e=s.polygonContainsPoint(C,ce)&&N[3]<$[3],Qe=s.polygonContainsPoint(C,Ie)&&H[3]<$[3];if(!$e&&!Qe)return null;const Ye=function(Ot,qt,$t){for(let an=1;an<Ot.length;an++){const Wn=vt(qt.pointCoordinate3D(Ot[an-1]).x),nn=vt(qt.pointCoordinate3D(Ot[an]).x);if($t<0){if(Wn<nn)return{idx:an,t:-Wn/(nn-1-Wn)}}else if(nn<Wn)return{idx:an,t:(1-Wn)/(nn+1-Wn)}}return null}(C,I,$e?-1:1);if(!Ye)return null;const{idx:ot,t:ue}=Ye;let He=ot>1?Ue(C.slice(0,ot),I):[],pt=ot<C.length?Ue(C.slice(ot),I):[];He=He.map(Ot=>new s.Point(vt(Ot.x),Ot.y)),pt=pt.map(Ot=>new s.Point(vt(Ot.x),Ot.y));const ht=[...He];0===ht.length&&ht.push(pt[pt.length-1]);const Pt=s.number(ht[ht.length-1].y,(0===pt.length?He[0]:pt[0]).y,ue);let Lt;return Lt=$e?[new s.Point(0,Pt),new s.Point(0,0),new s.Point(1,0),new s.Point(1,Pt)]:[new s.Point(1,Pt),new s.Point(1,1),new s.Point(0,1),new s.Point(0,Pt)],ht.push(...Lt),0===pt.length?ht.push(He[0]):ht.push(...pt),{polygon:ht.map(Ot=>new s.MercatorCoordinate(Ot.x,Ot.y)),unwrapped:!1}}(o,c);if(m)return m;const x=function(C,I){let O=!1,N=-1/0,H=0;for(let ce=0;ce<C.length-1;ce++)C[ce].x>N&&(N=C[ce].x,H=ce);for(let ce=0;ce<C.length-1;ce++){const Ie=(H+ce)%(C.length-1),$e=C[Ie],Qe=C[Ie+1];Math.abs($e.x-Qe.x)>.5&&($e.x<Qe.x?($e.x+=1,0===Ie&&(C[C.length-1].x+=1)):(Qe.x+=1,Ie+1===C.length-1&&(C[0].x+=1)),O=!0)}const $=s.mercatorXfromLng(I.center.lng);return O&&$<Math.abs($-1)&&C.forEach(ce=>{ce.x-=1}),{polygon:C,unwrapped:O}}(Ue(o,c).map(C=>new s.Point(vt(C.x),C.y)),c);return{polygon:x.polygon.map(C=>new s.MercatorCoordinate(C.x,C.y)),unwrapped:x.unwrapped}}}function Ue(p,o){return s.resample(p,c=>{const m=o.pointCoordinate3D(c);c.x=m.x,c.y=m.y},1/256)}function vt(p){return p<0?1+p%1:p%1}function je(p){return 100*p|0}function _t(p,o,c,m,x){const C=function(I,O){if(I)return x(I);if(O){p.url&&O.tiles&&p.tiles&&delete p.tiles;const N=s.pick(s.extend(O,p),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);O.vector_layers&&(N.vectorLayers=O.vector_layers,N.vectorLayerIds=N.vectorLayers.map(H=>H.id)),N.tiles=o.canonicalizeTileset(N,p.url),x(null,N)}};return p.url?s.getJSON(o.transformRequest(o.normalizeSourceURL(p.url,null,c,m),s.ResourceType.Source),C):s.exported.frame(()=>C(null,p))}class Ne{constructor(o,c,m){this.bounds=s.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=c||0,this.maxzoom=m||24}validateBounds(o){return Array.isArray(o)&&4===o.length?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const c=Math.pow(2,o.z),m=Math.floor(s.mercatorXfromLng(this.bounds.getWest())*c),x=Math.floor(s.mercatorYfromLat(this.bounds.getNorth())*c),C=Math.ceil(s.mercatorXfromLng(this.bounds.getEast())*c),I=Math.ceil(s.mercatorYfromLat(this.bounds.getSouth())*c);return o.x>=m&&o.x<C&&o.y>=x&&o.y<I}}class Ft{constructor(o,c,m){this.context=o;const x=o.gl;this.buffer=x.createBuffer(),this.dynamicDraw=!!m,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),x.bufferData(x.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Gt={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class wn{constructor(o,c,m,x){this.length=c.length,this.attributes=m,this.itemSize=c.bytesPerElement,this.dynamicDraw=x,this.context=o;const C=o.gl;this.buffer=C.createBuffer(),o.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,c){for(let m=0;m<this.attributes.length;m++){const x=c.attributes[this.attributes[m].name];void 0!==x&&o.enableVertexAttribArray(x)}}setVertexAttribPointers(o,c,m){for(let x=0;x<this.attributes.length;x++){const C=this.attributes[x],I=c.attributes[C.name];void 0!==I&&o.vertexAttribPointer(I,C.components,o[Gt[C.type]],!1,this.itemSize,C.offset+this.itemSize*(m||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Xt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mn extends Xt{getDefault(){return s.Color.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class sn extends Xt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class Vt extends Xt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class It extends Xt{getDefault(){return[!0,!0,!0,!0]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class at extends Xt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Wt extends Xt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class dn extends Xt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const c=this.current;(o.func!==c.func||o.ref!==c.ref||o.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Sn extends Xt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class Nt extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=o,this.dirty=!1}}class yi extends Xt{getDefault(){return[0,1]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Gi extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=o,this.dirty=!1}}class gn extends Xt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class si extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.BLEND):c.disable(c.BLEND),this.current=o,this.dirty=!1}}class Je extends Xt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class At extends Xt{getDefault(){return s.Color.transparent}set(o){const c=this.current;(o.r!==c.r||o.g!==c.g||o.b!==c.b||o.a!==c.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Zt extends Xt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class un extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;o?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=o,this.dirty=!1}}class hn extends Xt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class gi extends Xt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let Yt,Un=class extends Xt{getDefault(){return null}set(p){(p!==this.current||this.dirty)&&(this.gl.useProgram(p),this.current=p,this.dirty=!1)}};class oi extends Xt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class Ci extends Xt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const c=this.current;(o[0]!==c[0]||o[1]!==c[1]||o[2]!==c[2]||o[3]!==c[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Oi extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Po extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class fi extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Vo extends Xt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ut extends Xt{getDefault(){return null}set(o){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class pe extends Xt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class ve extends Xt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class et extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class yt extends Xt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Rt extends Xt{constructor(o,c){super(o),this.context=o,this.parent=c}getDefault(){return null}}class Ut extends Rt{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class jt extends Rt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class St extends jt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Kt{constructor(o,c,m,x){this.context=o,this.width=c,this.height=m;const C=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Ut(o,C),x&&(this.depthAttachment=new jt(o,C))}destroy(){const o=this.context.gl,c=this.colorAttachment.get();if(c&&o.deleteTexture(c),this.depthAttachment){const m=this.depthAttachment.get();m&&o.deleteRenderbuffer(m)}o.deleteFramebuffer(this.framebuffer)}}class In{constructor(o,c=!1){if(this.gl=o,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const m=o;this.extVertexArrayObject={createVertexArrayOES:m.createVertexArray.bind(o),deleteVertexArrayOES:m.deleteVertexArray.bind(o),bindVertexArrayOES:m.bindVertexArray.bind(o)}}this.clearColor=new mn(this),this.clearDepth=new sn(this),this.clearStencil=new Vt(this),this.colorMask=new It(this),this.depthMask=new at(this),this.stencilMask=new Wt(this),this.stencilFunc=new dn(this),this.stencilOp=new Sn(this),this.stencilTest=new Nt(this),this.depthRange=new yi(this),this.depthTest=new Gi(this),this.depthFunc=new gn(this),this.blend=new si(this),this.blendFunc=new Je(this),this.blendColor=new At(this),this.blendEquation=new Zt(this),this.cullFace=new un(this),this.cullFaceSide=new hn(this),this.frontFace=new gi(this),this.program=new Un(this),this.activeTexture=new oi(this),this.viewport=new Ci(this),this.bindFramebuffer=new Oi(this),this.bindRenderbuffer=new Po(this),this.bindTexture=new fi(this),this.bindVertexBuffer=new Vo(this),this.bindElementBuffer=new ut(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new pe(this),this.pixelStoreUnpack=new ve(this),this.pixelStoreUnpackPremultiplyAlpha=new et(this),this.pixelStoreUnpackFlipY=new yt(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,c){return new Ft(this,o,c)}createVertexBuffer(o,c,m){return new wn(this,o,c,m)}createRenderbuffer(o,c,m){const x=this.gl,C=x.createRenderbuffer();return this.bindRenderbuffer.set(C),x.renderbufferStorage(x.RENDERBUFFER,o,c,m),this.bindRenderbuffer.set(null),C}createFramebuffer(o,c,m){return new Kt(this,o,c,m)}clear({color:o,depth:c,stencil:m}){const x=this.gl;let C=0;o&&(C|=x.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(C|=x.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==m&&(C|=x.STENCIL_BUFFER_BIT,this.clearStencil.set(m),this.stencilMask.set(255)),x.clear(C)}setCullFace(o){!1===o.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){Q(o.blendFunction,s.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class tt extends s.Evented{constructor(o,c,m,x){if(super(),this.id=o,this.dispatcher=m,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.extend(this,s.pick(c,["url","scheme","tileSize","promoteId"])),this._options=s.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(x),this._tileWorkers={},this._deduped=new s.DedupedRequest}load(o){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,m=this.map._worldview;this._tileJSONRequest=_t(this._options,this.map._requestManager,c,m,(x,C)=>{this._tileJSONRequest=null,this._loaded=!0,x?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),m&&2!==m.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${m}`),this.fire(new s.ErrorEvent(x))):C&&(s.extend(this,C),C.bounds&&(this.tileBounds=new Ne(C.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(C.tiles,this.map._requestManager._customAccessToken),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(x)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}loadTile(o,c){const m=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),x={request:this.map._requestManager.transformRequest(m,s.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(x.request.collectResourceTiming=this._collectResourceTiming,o.actor&&"expired"!==o.state)"loading"===o.state?o.reloadCallback=c:o.request=o.actor.send("reloadTile",x,C.bind(this));else if(o.actor=this._tileWorkers[m]=this._tileWorkers[m]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",x,C.bind(this),void 0,!0);else{const I=s.loadVectorTile.call({deduped:this._deduped},x,(O,N)=>{O||!N?C.call(this,O):(x.data={cacheControl:N.cacheControl,expires:N.expires,rawData:N.rawData.slice(0)},o.actor&&o.actor.send("loadTile",x,C.bind(this),void 0,!0))},!0);o.request={cancel:I}}function C(I,O){return delete o.request,o.aborted?c(null):I&&404!==I.status?c(I):(O&&O.resourceTiming&&(o.resourceTiming=O.resourceTiming),this.map._refreshExpiredTiles&&O&&o.setExpiryData(O),o.loadVectorData(O,this.map.painter),s.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ve extends s.Evented{constructor(o,c,m,x){super(),this.id=o,this.dispatcher=m,this.setEventedParent(x),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.extend({type:"raster"},c),s.extend(this,s.pick(c,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=_t(this._options,this.map._requestManager,null,null,(c,m)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new s.ErrorEvent(c)):m&&(s.extend(this,m),m.bounds&&(this.tileBounds=new Ne(m.bounds,this.minzoom,this.maxzoom)),s.postTurnstileEvent(m.tiles),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(c)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return s.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,c){const m=s.exported.devicePixelRatio>=2,x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),m,this.tileSize);o.request=s.getImage(this.map._requestManager.transformRequest(x,s.ResourceType.Tile),(C,I,O,N)=>(delete o.request,o.aborted?(o.state="unloaded",c(null)):C?(o.state="errored",c(C)):I?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:O,expires:N}),o.setTexture(I,this.map.painter),o.state="loaded",s.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(o,c,m){o.setTexture(c,m)}static unloadTileData(o,c){o.texture&&c.saveTileTexture(o.texture)}abortTile(o,c){o.request&&(o.request.cancel(),delete o.request),c()}unloadTile(o,c){o.texture&&this.map.painter.saveTileTexture(o.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function Y(p,o,c,m,x,C,I,O){const N=[p,c,x,o,m,C,1,1,1],H=[I,O,1],$=s.adjoint([],N),[ce,Ie,$e]=s.transformMat3(H,H,s.transpose($,$));return s.multiply$1(N,[ce,0,0,0,Ie,0,0,0,$e],N)}class me extends s.Evented{constructor(o,c,m,x){super(),this.id=o,this.dispatcher=m,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(x),this.options=c,this._dirty=!1}load(o,c){this._loaded=c||!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=s.getImage(this.map._requestManager.transformRequest(this.url,s.ResourceType.Image),(m,x)=>{if(this._imageRequest=null,this._loaded=!0,m)this.fire(new s.ErrorEvent(m));else if(x){const{HTMLImageElement:C}=s.window;this.image=x instanceof C?s.exported.getImageData(x):x,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}})}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const c=o.map(s.MercatorCoordinate.fromLngLat);return this.tileID=function(m){let x=1/0,C=1/0,I=-1/0,O=-1/0;for(const ce of m)x=Math.min(x,ce.x),C=Math.min(C,ce.y),I=Math.max(I,ce.x),O=Math.max(O,ce.y);const N=Math.max(I-x,O-C),H=Math.max(0,Math.floor(-Math.log(N)/Math.LN2)),$=Math.pow(2,H);return new s.CanonicalTileID(H,Math.floor((x+I)/2*$),Math.floor((C+O)/2*$))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const N in this.tiles){const H=this.tiles[N];"loaded"!==H.state&&(H.state="loaded",H.texture=this.texture)}if(this._boundsArray)return;const c=s.tileTransform(this.tileID,this.map.transform.projection),[m,x,C,I]=this.coordinates.map(N=>{const H=c.projection.project(N[0],N[1]);return s.getTilePoint(c,H)._round()});this.perspectiveTransform=function(N,H,$,ce,Ie,$e,Qe,Ye,ot,ue){const He=Y(0,0,N,0,0,H,N,H),pt=Y($,ce,Ie,$e,Qe,Ye,ot,ue);return s.multiply$1(pt,s.adjoint(He,He),pt),[pt[6]/pt[8]*N/s.EXTENT,pt[7]/pt[8]*H/s.EXTENT]}(this.width,this.height,m.x,m.y,x.x,x.y,I.x,I.y,C.x,C.y);const O=this._boundsArray=new s.StructArrayLayout4i8;O.emplaceBack(m.x,m.y,0,0),O.emplaceBack(x.x,x.y,s.EXTENT,0),O.emplaceBack(I.x,I.y,0,s.EXTENT),O.emplaceBack(C.x,C.y,s.EXTENT,s.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(O,s.boundsAttributes.members),this.boundsSegments=s.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const o=this.map.painter.context,c=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new s.Texture(o,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,c){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},c(null)):(o.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const We={vector:tt,raster:Ve,"raster-dem":class extends Ve{constructor(p,o,c,m){super(p,o,c,m),this.type="raster-dem",this.maxzoom=22,this._options=s.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(p,o){const c=this.map._requestManager.normalizeTileURL(p.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function m(x,C){x&&(p.state="errored",o(x)),C&&(p.dem=C,p.dem.onDeserialize(),p.needsHillshadePrepare=!0,p.needsDEMTextureUpload=!0,p.state="loaded",o(null))}p.request=s.getImage(this.map._requestManager.transformRequest(c,s.ResourceType.Tile),function(x,C,I,O){if(delete p.request,p.aborted)p.state="unloaded",o(null);else if(x)p.state="errored",o(x);else if(C){this.map._refreshExpiredTiles&&p.setExpiryData({cacheControl:I,expires:O});const N=s.window.ImageBitmap&&C instanceof s.window.ImageBitmap&&(null==Yt&&(Yt=s.window.OffscreenCanvas&&new s.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof s.window.createImageBitmap),Yt),H=1-(C.width-s.prevPowerOfTwo(C.width))/2;H<1||p.neighboringTiles||(p.neighboringTiles=this._getNeighboringTiles(p.tileID));const $=N?C:s.exported.getImageData(C,H),ce={uid:p.uid,coord:p.tileID,source:this.id,rawImageData:$,encoding:this.encoding,padding:H};p.actor&&"expired"!==p.state||(p.actor=this.dispatcher.getActor(),p.actor.send("loadDEMTile",ce,m.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(p){const o=p.canonical,c=Math.pow(2,o.z),m=(o.x-1+c)%c,x=0===o.x?p.wrap-1:p.wrap,C=(o.x+1+c)%c,I=o.x+1===c?p.wrap+1:p.wrap,O={};return O[new s.OverscaledTileID(p.overscaledZ,x,o.z,m,o.y).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,I,o.z,C,o.y).key]={backfilled:!1},o.y>0&&(O[new s.OverscaledTileID(p.overscaledZ,x,o.z,m,o.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,p.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,I,o.z,C,o.y-1).key]={backfilled:!1}),o.y+1<c&&(O[new s.OverscaledTileID(p.overscaledZ,x,o.z,m,o.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,p.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},O[new s.OverscaledTileID(p.overscaledZ,I,o.z,C,o.y+1).key]={backfilled:!1}),O}unloadTile(p){p.demTexture&&this.map.painter.saveTileTexture(p.demTexture),p.fbo&&(p.fbo.destroy(),delete p.fbo),p.dem&&delete p.dem,delete p.neighboringTiles,p.state="unloaded"}},geojson:class extends s.Evented{constructor(p,o,c,m){super(),this.id=p,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(m),this._data=o.data,this._options=s.extend({},o),this._collectResourceTiming=o.collectResourceTiming,void 0!==o.maxzoom&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const x=s.EXTENT/this.tileSize;this.workerOptions=s.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(void 0!==o.buffer?o.buffer:128)*x,tolerance:(void 0!==o.tolerance?o.tolerance:.375)*x,extent:s.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:void 0!==o.clusterMaxZoom?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.EXTENT,radius:(void 0!==o.clusterRadius?o.clusterRadius:50)*x,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(p){this.map=p,this.setData(this._data)}setData(p){return this._data=p,this._updateWorkerData(),this}getClusterExpansionZoom(p,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:p,source:this.id},o),this}getClusterChildren(p,o){return this.actor.send("geojson.getClusterChildren",{clusterId:p,source:this.id},o),this}getClusterLeaves(p,o,c,m){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:p,limit:o,offset:c},m),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.Event("dataloading",{dataType:"source"})),this._loaded=!1;const p=s.extend({},this.workerOptions),o=this._data;"string"==typeof o?(p.request=this.map._requestManager.transformRequest(s.exported.resolveURL(o),s.ResourceType.Source),p.request.collectResourceTiming=this._collectResourceTiming):p.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,p,(c,m)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new s.ErrorEvent(c));else{const x={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&m&&m.resourceTiming&&m.resourceTiming[this.id]&&(x.resourceTiming=m.resourceTiming[this.id]),this.fire(new s.Event("data",x)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(p,o){const c=p.actor?"reloadTile":"loadTile";p.actor=this.actor,p.request=this.actor.send(c,{type:this.type,uid:p.uid,tileID:p.tileID,tileZoom:p.tileZoom,zoom:p.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:s.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(m,x)=>(delete p.request,p.unloadVectorData(),p.aborted?o(null):m?o(m):(p.loadVectorData(x,this.map.painter,"reloadTile"===c),o(null))),void 0,"loadTile"===c)}abortTile(p){p.request&&(p.request.cancel(),delete p.request),p.aborted=!0}unloadTile(p){p.unloadVectorData(),this.actor.send("removeTile",{uid:p.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends me{constructor(p,o,c,m){super(p,o,c,m),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const p=this.options;this.urls=[];for(const o of p.urls)this.urls.push(this.map._requestManager.transformRequest(o,s.ResourceType.Source).url);s.getVideo(this.urls,(o,c)=>{this._loaded=!0,o?this.fire(new s.ErrorEvent(o)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(p){if(this.video){const o=this.video.seekable;p<o.start(0)||p>o.end(0)?this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=p}}getVideo(){return this.video}onAdd(p){this.map||(this.map=p,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const p=this.map.painter.context,o=p.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.Texture(p,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(p)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:me,canvas:class extends me{constructor(p,o,c,m){super(p,o,c,m),o.coordinates?Array.isArray(o.coordinates)&&4===o.coordinates.length&&!o.coordinates.some(x=>!Array.isArray(x)||2!==x.length||x.some(C=>"number"!=typeof C))||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "coordinates"'))),o.animate&&"boolean"!=typeof o.animate&&this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'optional "animate" property must be a boolean value'))),o.canvas?"string"==typeof o.canvas||o.canvas instanceof s.window.HTMLCanvasElement||this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.ErrorEvent(new s.ValidationError(`sources.${p}`,null,'missing required property "canvas"'))),this.options=o,this.animate=void 0===o.animate||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof s.window.HTMLCanvasElement?this.options.canvas:s.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(p){this.map=p,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let p=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,p=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,p=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const o=this.map.painter.context;this.texture?(p||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const p of[this.canvas.width,this.canvas.height])if(isNaN(p)||p<=0)return!0;return!1}},custom:class extends s.Evented{constructor(p,o,c,m){super(),this.id=p,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=o,this.setEventedParent(m),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Ne(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),s.extend(this,s.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(p){this._map=p,this._loaded=!1,this.fire(new s.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(p),this.load()}onRemove(p){this._implementation.onRemove&&this._implementation.onRemove(p)}hasTile(p){if(this._implementation.hasTile){const{x:o,y:c,z:m}=p.canonical;return this._implementation.hasTile({x:o,y:c,z:m})}return!this.tileBounds||this.tileBounds.contains(p.canonical)}loadTile(p,o){const{x:c,y:m,z:x}=p.tileID.canonical,C=new s.window.AbortController;p.request=Promise.resolve(this._implementation.loadTile({x:c,y:m,z:x},{signal:C.signal})).then(function(I){return delete p.request,p.aborted?(p.state="unloaded",o(null)):void 0===I?(p.state="errored",o(null)):null===I?(this.loadTileData(p,{width:this.tileSize,height:this.tileSize,data:null}),p.state="loaded",o(null)):(O=I)instanceof s.window.ImageData||O instanceof s.window.HTMLCanvasElement||O instanceof s.window.ImageBitmap||O instanceof s.window.HTMLImageElement?(this.loadTileData(p,I),p.state="loaded",void o(null)):(p.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var O}.bind(this)).catch(I=>{20!==I.code&&(p.state="errored",o(I))}),p.request.cancel=()=>C.abort()}loadTileData(p,o){Ve.loadTileData(p,o,this._map.painter)}unloadTileData(p){Ve.unloadTileData(p,this._map.painter)}unloadTile(p,o){if(this.unloadTileData(p),this._implementation.unloadTile){const{x:c,y:m,z:x}=p.tileID.canonical;this._implementation.unloadTile({x:c,y:m,z:x})}o()}abortTile(p,o){p.request&&p.request.cancel&&(p.request.cancel(),delete p.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(p=>({x:p.canonical.x,y:p.canonical.y,z:p.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new s.Event("data",{dataType:"source",sourceDataType:"content"}))}}},kt=function(p,o,c,m){const x=new We[o.type](p,o,c,m);if(x.id!==p)throw new Error(`Expected Source id to be ${p} instead of ${x.id}`);return s.bindAll(["load","abort","unload","serialize","prepare"],x),x};function _n(p,o){const c=s.identity([]);return s.scale(c,c,[.5*p.width,.5*-p.height,1]),s.translate(c,c,[1,-1,0]),s.multiply(c,c,p.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(c)}function ti(p,o,c,m,x,C,I,O=!1){const N=p.tilesIn(m,I,O);N.sort(Si);const H=[];for(const ce of N)H.push({wrappedTileID:ce.tile.tileID.wrapped().key,queryResults:ce.tile.queryRenderedFeatures(o,c,p._state,ce,x,C,_n(p.transform,ce.tile.tileID),O)});const $=function(ce){const Ie={},$e={};for(const Qe of ce){const Ye=Qe.queryResults,ot=Qe.wrappedTileID,ue=$e[ot]=$e[ot]||{};for(const He in Ye){const pt=Ye[He],ht=ue[He]=ue[He]||{},Pt=Ie[He]=Ie[He]||[];for(const Lt of pt)ht[Lt.featureIndex]||(ht[Lt.featureIndex]=!0,Pt.push(Lt))}}return Ie}(H);for(const ce in $)$[ce].forEach(Ie=>{const $e=Ie.feature,Qe=$e.layer;Qe&&"background"!==Qe.type&&"sky"!==Qe.type&&($e.source=Qe.source,Qe["source-layer"]&&($e.sourceLayer=Qe["source-layer"]),$e.state=void 0!==$e.id?p.getFeatureState(Qe["source-layer"],$e.id):{})});return $}function Ei(p,o){const c=p.getRenderableIds().map(C=>p.getTileByID(C)),m=[],x={};for(let C=0;C<c.length;C++){const I=c[C],O=I.tileID.canonical.key;x[O]||(x[O]=!0,I.querySourceFeatures(m,o))}return m}function Si(p,o){const c=p.tileID,m=o.tileID;return c.overscaledZ-m.overscaledZ||c.canonical.y-m.canonical.y||c.wrap-m.wrap||c.canonical.x-m.canonical.x}function ji(){return null!=Mo.workerClass?new Mo.workerClass:new s.window.Worker(Mo.workerUrl)}const po="mapboxgl_preloaded_worker_pool";class eo{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<eo.workerCount;)this.workers.push(new ji);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],0===this.numActive()&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[po]}numActive(){return Object.keys(this.active).length}}let tn;function xt(){return tn||(tn=new eo),tn}function Et(p,o){const c={};for(const m in p)"ref"!==m&&(c[m]=p[m]);return s.refProperties.forEach(m=>{m in o&&(c[m]=o[m])}),c}function Nn(p){p=p.slice();const o=Object.create(null);for(let c=0;c<p.length;c++)o[p[c].id]=p[c];for(let c=0;c<p.length;c++)"ref"in p[c]&&(p[c]=Et(p[c],o[p[c].ref]));return p}eo.workerCount=2;const Pn={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function ri(p,o,c){c.push({command:Pn.addSource,args:[p,o[p]]})}function ni(p,o,c){o.push({command:Pn.removeSource,args:[p]}),c[p]=!0}function qi(p,o,c,m){ni(p,c,m),ri(p,o,c)}function wi(p,o,c){let m;for(m in p[c])if(p[c].hasOwnProperty(m)&&"data"!==m&&!Q(p[c][m],o[c][m]))return!1;for(m in o[c])if(o[c].hasOwnProperty(m)&&"data"!==m&&!Q(p[c][m],o[c][m]))return!1;return!0}function mo(p,o,c,m,x,C){let I;for(I in o=o||{},p=p||{})p.hasOwnProperty(I)&&(Q(p[I],o[I])||c.push({command:C,args:[m,I,o[I],x]}));for(I in o)o.hasOwnProperty(I)&&!p.hasOwnProperty(I)&&(Q(p[I],o[I])||c.push({command:C,args:[m,I,o[I],x]}))}function Ao(p){return p.id}function Go(p,o){return p[o.id]=o,p}class co{constructor(o,c){this.reset(o,c)}reset(o,c){this.points=o||[],this._distances=[0];for(let m=1;m<this.points.length;m++)this._distances[m]=this._distances[m-1]+this.points[m].dist(this.points[m-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(1===this.points.length)return this.points[0];o=s.clamp(o,0,1);let c=1,m=this._distances[c];const x=o*this.paddedLength+this.padding;for(;m<x&&c<this._distances.length;)m=this._distances[++c];const C=c-1,I=this._distances[C],O=m-I,N=O>0?(x-I)/O:0;return this.points[C].mult(1-N).add(this.points[c].mult(N))}}class io{constructor(o,c,m){const x=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(o/m),this.yCellCount=Math.ceil(c/m);for(let I=0;I<this.xCellCount*this.yCellCount;I++)x.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=c,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,c,m,x,C){this._forEachCell(c,m,x,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(c),this.bboxes.push(m),this.bboxes.push(x),this.bboxes.push(C)}insertCircle(o,c,m,x){this._forEachCell(c-x,m-x,c+x,m+x,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(c),this.circles.push(m),this.circles.push(x)}_insertBoxCell(o,c,m,x,C,I){this.boxCells[C].push(I)}_insertCircleCell(o,c,m,x,C,I){this.circleCells[C].push(I)}_query(o,c,m,x,C,I){if(m<0||o>this.width||x<0||c>this.height)return!C&&[];const O=[];if(o<=0&&c<=0&&this.width<=m&&this.height<=x){if(C)return!0;for(let N=0;N<this.boxKeys.length;N++)O.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const H=this.circles[3*N],$=this.circles[3*N+1],ce=this.circles[3*N+2];O.push({key:this.circleKeys[N],x1:H-ce,y1:$-ce,x2:H+ce,y2:$+ce})}return I?O.filter(I):O}return this._forEachCell(o,c,m,x,this._queryCell,O,{hitTest:C,seenUids:{box:{},circle:{}}},I),C?O.length>0:O}_queryCircle(o,c,m,x,C){const I=o-m,O=o+m,N=c-m,H=c+m;if(O<0||I>this.width||H<0||N>this.height)return!x&&[];const $=[];return this._forEachCell(I,N,O,H,this._queryCellCircle,$,{hitTest:x,circle:{x:o,y:c,radius:m},seenUids:{box:{},circle:{}}},C),x?$.length>0:$}query(o,c,m,x,C){return this._query(o,c,m,x,!1,C)}hitTest(o,c,m,x,C){return this._query(o,c,m,x,!0,C)}hitTestCircle(o,c,m,x){return this._queryCircle(o,c,m,!0,x)}_queryCell(o,c,m,x,C,I,O,N){const H=O.seenUids,$=this.boxCells[C];if(null!==$){const Ie=this.bboxes;for(const $e of $)if(!H.box[$e]){H.box[$e]=!0;const Qe=4*$e;if(o<=Ie[Qe+2]&&c<=Ie[Qe+3]&&m>=Ie[Qe+0]&&x>=Ie[Qe+1]&&(!N||N(this.boxKeys[$e]))){if(O.hitTest)return I.push(!0),!0;I.push({key:this.boxKeys[$e],x1:Ie[Qe],y1:Ie[Qe+1],x2:Ie[Qe+2],y2:Ie[Qe+3]})}}}const ce=this.circleCells[C];if(null!==ce){const Ie=this.circles;for(const $e of ce)if(!H.circle[$e]){H.circle[$e]=!0;const Qe=3*$e;if(this._circleAndRectCollide(Ie[Qe],Ie[Qe+1],Ie[Qe+2],o,c,m,x)&&(!N||N(this.circleKeys[$e]))){if(O.hitTest)return I.push(!0),!0;{const Ye=Ie[Qe],ot=Ie[Qe+1],ue=Ie[Qe+2];I.push({key:this.circleKeys[$e],x1:Ye-ue,y1:ot-ue,x2:Ye+ue,y2:ot+ue})}}}}}_queryCellCircle(o,c,m,x,C,I,O,N){const H=O.circle,$=O.seenUids,ce=this.boxCells[C];if(null!==ce){const $e=this.bboxes;for(const Qe of ce)if(!$.box[Qe]){$.box[Qe]=!0;const Ye=4*Qe;if(this._circleAndRectCollide(H.x,H.y,H.radius,$e[Ye+0],$e[Ye+1],$e[Ye+2],$e[Ye+3])&&(!N||N(this.boxKeys[Qe])))return I.push(!0),!0}}const Ie=this.circleCells[C];if(null!==Ie){const $e=this.circles;for(const Qe of Ie)if(!$.circle[Qe]){$.circle[Qe]=!0;const Ye=3*Qe;if(this._circlesCollide($e[Ye],$e[Ye+1],$e[Ye+2],H.x,H.y,H.radius)&&(!N||N(this.circleKeys[Qe])))return I.push(!0),!0}}}_forEachCell(o,c,m,x,C,I,O,N){const H=this._convertToXCellCoord(o),$=this._convertToYCellCoord(c),ce=this._convertToXCellCoord(m),Ie=this._convertToYCellCoord(x);for(let $e=H;$e<=ce;$e++)for(let Qe=$;Qe<=Ie;Qe++)if(C.call(this,o,c,m,x,this.xCellCount*Qe+$e,I,O,N))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,c,m,x,C,I){const O=x-o,N=C-c,H=m+I;return H*H>O*O+N*N}_circleAndRectCollide(o,c,m,x,C,I,O){const N=(I-x)/2,H=Math.abs(o-(x+N));if(H>N+m)return!1;const $=(O-C)/2,ce=Math.abs(c-(C+$));if(ce>$+m)return!1;if(H<=N||ce<=$)return!0;const Ie=H-N,$e=ce-$;return Ie*Ie+$e*$e<=m*m}}const Pi={unknown:0,flipRequired:1,flipNotRequired:2},uo=Math.tan(85*Math.PI/180);function en(p,o,c,m,x,C,I){const O=s.create();if(c)if("globe"===C.name){const N=s.calculateGlobeLabelMatrix(x,o);s.multiply(O,O,N)}else{const N=Ce([],I);O[0]=N[0],O[1]=N[1],O[4]=N[2],O[5]=N[3],m||s.rotateZ(O,O,x.angle)}else s.multiply(O,x.labelPlaneMatrix,p);return O}function Qo(p,o,c,m,x,C,I){const O=en(p,o,c,m,x,C,I);return"globe"===C.name&&c||(O[2]=O[6]=O[10]=O[14]=0),O}function vo(p,o,c,m,x,C,I){if(c){if("globe"===C.name){const O=en(p,o,c,m,x,C,I);return s.invert(O,O),s.multiply(O,p,O),O}{const O=s.clone(p),N=s.identity([]);return N[0]=I[0],N[1]=I[1],N[4]=I[2],N[5]=I[3],s.multiply(O,O,N),m||s.rotateZ(O,O,-x.angle),O}}return x.glCoordMatrix}function Ji(p,o,c,m){const x=[p,o,c,1];c?s.transformMat4$1(x,x,m):it(x,x,m);const C=x[3];return x[0]/=C,x[1]/=C,x[2]/=C,x}function gr(p,o){return Math.min(.5+p/o*.5,1.5)}function xo(p,o){const c=p[0]/p[3],m=p[1]/p[3];return c>=-o[0]&&c<=o[0]&&m>=-o[1]&&m<=o[1]}function Zr(p,o,c,m,x,C,I,O,N,H){const $=c.transform,ce=m?p.textSizeData:p.iconSizeData,Ie=s.evaluateSizeForZoom(ce,c.transform.zoom),$e="globe"===$.projection.name,Qe=[256/c.width*2+1,256/c.height*2+1],Ye=m?p.text.dynamicLayoutVertexArray:p.icon.dynamicLayoutVertexArray;Ye.clear();let ot=null;$e&&(ot=m?p.text.globeExtVertexArray:p.icon.globeExtVertexArray);const ue=p.lineVertexArray,He=m?p.text.placedSymbolArray:p.icon.placedSymbolArray,pt=c.transform.width/c.transform.height;let ht,Pt=!1;for(let Lt=0;Lt<He.length;Lt++){const Ot=He.get(Lt),{numGlyphs:qt,writingMode:$t}=Ot;if($t!==s.WritingMode.vertical||Pt||ht===s.WritingMode.horizontal||(Pt=!0),ht=$t,(Ot.hidden||$t===s.WritingMode.vertical)&&!Pt){ke(qt,Ye);continue}Pt=!1;const an=new s.Point(Ot.tileAnchorX,Ot.tileAnchorY);let{x:Wn,y:nn,z:An}=$.projection.projectTilePoint(an.x,an.y,H.canonical);if(N){const[$i,vi,ki]=N(an);Wn+=$i,nn+=vi,An+=ki}const pn=[Wn,nn,An,1];if(s.transformMat4$1(pn,pn,o),!xo(pn,Qe)){ke(qt,Ye);continue}const $n=gr(c.transform.cameraToCenterDistance,pn[3]),ln=s.evaluateSizeForFeature(ce,Ie,Ot),Mn=I?ln/$n:ln*$n,jn=Ji(Wn,nn,An,x);if(jn[3]<=0){ke(qt,Ye);continue}let Bn={};const Yn=I?null:N,Di=ei(Ot,Mn,!1,O,o,x,C,p.glyphOffsetArray,ue,Ye,ot,jn,an,Bn,pt,Yn,$.projection,H,I);Pt=Di.useVertical,Yn&&Di.needsFlipping&&(Bn={}),(Di.notEnoughRoom||Pt||Di.needsFlipping&&ei(Ot,Mn,!0,O,o,x,C,p.glyphOffsetArray,ue,Ye,ot,jn,an,Bn,pt,Yn,$.projection,H,I).notEnoughRoom)&&ke(qt,Ye)}m?(p.text.dynamicLayoutVertexBuffer.updateData(Ye),ot&&p.text.globeExtVertexBuffer.updateData(ot)):(p.icon.dynamicLayoutVertexBuffer.updateData(Ye),ot&&p.icon.globeExtVertexBuffer.updateData(ot))}function Mr(p,o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye){const{lineStartIndex:ot,glyphStartIndex:ue,segment:He}=O,pt=ue+O.numGlyphs,ht=ot+O.lineLength,Pt=o.getoffsetX(ue),Lt=o.getoffsetX(pt-1),Ot=st(p*Pt,c,m,x,C,I,He,ot,ht,N,H,$,ce,Ie,!0,$e,Qe,Ye);if(!Ot)return null;const qt=st(p*Lt,c,m,x,C,I,He,ot,ht,N,H,$,ce,Ie,!0,$e,Qe,Ye);return qt?{first:Ot,last:qt}:null}function kr(p,o,c,m){return p===s.WritingMode.horizontal&&Math.abs(m)>Math.abs(c)?{useVertical:!0}:p===s.WritingMode.vertical?m>0?{needsFlipping:!0}:null:o!==Pi.unknown&&(0===(x=c)||Math.abs(m/x)>uo)?o===Pi.flipRequired?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var x}function ei(p,o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye,ot,ue,He){const pt=o/24,ht=p.lineOffsetX*pt,Pt=p.lineOffsetY*pt,{lineStartIndex:Lt,glyphStartIndex:Ot,numGlyphs:qt,segment:$t,writingMode:an,flipState:Wn}=p,nn=Lt+p.lineLength,An=pn=>{if($){const[jn,Bn,Yn]=pn.up,Di=H.length;s.updateGlobeVertexNormal($,Di+0,jn,Bn,Yn),s.updateGlobeVertexNormal($,Di+1,jn,Bn,Yn),s.updateGlobeVertexNormal($,Di+2,jn,Bn,Yn),s.updateGlobeVertexNormal($,Di+3,jn,Bn,Yn)}const[$n,ln,Mn]=pn.point;s.addDynamicAttributes(H,$n,ln,Mn,pn.angle)};if(qt>1){const pn=Mr(pt,O,ht,Pt,c,ce,Ie,p,N,C,$e,Ye,!1,ot,ue,He);if(!pn)return{notEnoughRoom:!0};if(m&&!c){let[$n,ln,Mn]=pn.first.point,[jn,Bn,Yn]=pn.last.point;[$n,ln]=Ji($n,ln,Mn,I),[jn,Bn]=Ji(jn,Bn,Yn,I);const Di=kr(an,Wn,(jn-$n)*Qe,Bn-ln);if(p.flipState=Di&&Di.needsFlipping?Pi.flipRequired:Pi.flipNotRequired,Di)return Di}An(pn.first);for(let $n=Ot+1;$n<Ot+qt-1;$n++){const ln=st(pt*O.getoffsetX($n),ht,Pt,c,ce,Ie,$t,Lt,nn,N,C,$e,Ye,!1,!1,ot,ue,He);if(!ln)return H.length-=4*($n-Ot),{notEnoughRoom:!0};An(ln)}An(pn.last)}else{if(m&&!c){const $n=Ji(Ie.x,Ie.y,0,x),ln=Lt+$t+1,Mn=new s.Point(N.getx(ln),N.gety(ln)),jn=Ji(Mn.x,Mn.y,0,x),Bn=jn[3]>0?jn:_e(Ie,Mn,$n,1,x,void 0,ot,ue.canonical),Yn=kr(an,Wn,(Bn[0]-$n[0])*Qe,Bn[1]-$n[1]);if(p.flipState=Yn&&Yn.needsFlipping?Pi.flipRequired:Pi.flipNotRequired,Yn)return Yn}const pn=st(pt*O.getoffsetX(Ot),ht,Pt,c,ce,Ie,$t,Lt,nn,N,C,$e,Ye,!1,!1,ot,ue,He);if(!pn)return{notEnoughRoom:!0};An(pn)}return{}}function Vi(p,o,c,m,x){const{x:C,y:I,z:O}=m.projectTilePoint(p.x,p.y,o);if(!x)return Ji(C,I,O,c);const[N,H,$]=x(p);return Ji(C+N,I+H,O+$,c)}function _e(p,o,c,m,x,C,I,O){const N=Vi(p.sub(o)._unit()._add(p),O,x,I,C);return s.sub(N,c,N),s.normalize(N,N),s.scaleAndAdd(N,c,N,m)}function st(p,o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye,ot,ue){const He=m?p-o:p+o;let pt=He>0?1:-1,ht=0;m&&(pt*=-1,ht=Math.PI),pt<0&&(ht+=Math.PI);let Pt=O+I+(pt>0?0:1)|0,Lt=x,Ot=x,qt=0,$t=0;const an=Math.abs(He),Wn=[],nn=[];let An=C,pn=An;const $n=()=>_e(pn,An,Ot,an-qt+1,$,Ie,Ye,ot.canonical);for(;qt+$t<=an;){if(Pt+=pt,Pt<O||Pt>=N)return null;if(Ot=Lt,pn=An,Wn.push(Ot),$e&&nn.push(pn),An=new s.Point(H.getx(Pt),H.gety(Pt)),Lt=ce[Pt],!Lt){const ki=Vi(An,ot.canonical,$,Ye,Ie);Lt=ki[3]>0?ce[Pt]=ki:$n()}qt+=$t,$t=s.distance(Ot,Lt)}Qe&&Ie&&(ce[Pt]&&(Lt=$n(),$t=s.distance(Ot,Lt)),ce[Pt]=Lt);const ln=(an-qt)/$t,Mn=An.sub(pn)._mult(ln)._add(pn),jn=s.sub([],Lt,Ot),Bn=s.scaleAndAdd([],Ot,jn,ln);let Yn=[0,0,1],Di=jn[0],$i=jn[1];if(ue&&(Yn=Ye.upVector(ot.canonical,Mn.x,Mn.y),0!==Yn[0]||0!==Yn[1]||1!==Yn[2])){const ki=[Yn[2],0,-Yn[0]],ho=s.cross([],Yn,ki);s.normalize(ki,ki),s.normalize(ho,ho),Di=s.dot(jn,ki),$i=s.dot(jn,ho)}if(c){const ki=s.cross([],Yn,jn);s.normalize(ki,ki),s.scaleAndAdd(Bn,Bn,ki,c*pt)}const vi=ht+Math.atan2($i,Di);return Wn.push(Bn),$e&&nn.push(Mn),{point:Bn,angle:vi,path:Wn,tilePath:nn,up:Yn}}function ke(p,o){const c=o.length,m=c+4*p;o.resize(m),o.float32.fill(-1/0,4*c,4*m)}function it(p,o,c){const m=o[0],x=o[1];return p[0]=c[0]*m+c[4]*x+c[12],p[1]=c[1]*m+c[5]*x+c[13],p[3]=c[3]*m+c[7]*x+c[15],p}const Bt=100;class zt{constructor(o,c,m=new io(o.width+200,o.height+200,25),x=new io(o.width+200,o.height+200,25)){this.transform=o,this.grid=m,this.ignoredGrid=x,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Bt,this.screenBottomBoundary=o.height+Bt,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=c}placeCollisionBox(o,c,m,x,C,I,O,N){let H=m.projectedAnchorX,$=m.projectedAnchorY,ce=m.projectedAnchorZ;const Ie=m.elevation,$e=m.tileID,Qe=o.getProjection();if(Ie&&$e){const[Lt,Ot,qt]=Qe.upVector($e.canonical,m.tileAnchorX,m.tileAnchorY),$t=Qe.upVectorScale($e.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;H+=Lt*Ie*$t,$+=Ot*Ie*$t,ce+=qt*Ie*$t}const Ye=this.projectAndGetPerspectiveRatio(O,H,$,ce,m.tileID,"globe"===Qe.name||!!Ie||this.transform.pitch>0,Qe),ot=I*Ye.perspectiveRatio,ue=(m.x1*c+x.x-m.padding)*ot+Ye.point.x,He=(m.y1*c+x.y-m.padding)*ot+Ye.point.y,pt=(m.x2*c+x.x+m.padding)*ot+Ye.point.x,ht=(m.y2*c+x.y+m.padding)*ot+Ye.point.y,Pt=Ye.perspectiveRatio<=.55||Ye.occluded;return!this.isInsideGrid(ue,He,pt,ht)||!C&&this.grid.hitTest(ue,He,pt,ht,N)||Pt?{box:[],offscreen:!1,occluded:Ye.occluded}:{box:[ue,He,pt,ht],offscreen:this.isOffscreen(ue,He,pt,ht),occluded:!1}}placeCollisionCircles(o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye){const ot=[],ue=this.transform.elevation,He=o.getProjection(),pt=ue?ue.getAtTileOffsetFunc(Ye,this.transform.center.lat,this.transform.worldSize,He):null,ht=new s.Point(m.tileAnchorX,m.tileAnchorY);let{x:Pt,y:Lt,z:Ot}=He.projectTilePoint(ht.x,ht.y,Ye.canonical);if(pt){const[Mn,jn,Bn]=pt(ht);Pt+=Mn,Lt+=jn,Ot+=Bn}const qt="globe"===He.name,$t=this.projectAndGetPerspectiveRatio(O,Pt,Lt,Ot,Ye,qt||!!ue||this.transform.pitch>0,He),{perspectiveRatio:an}=$t,Wn=(ce?I/an:I*an)/s.ONE_EM,nn=Ji(Pt,Lt,Ot,N),An=$t.signedDistanceFromCamera>0?Mr(Wn,C,m.lineOffsetX*Wn,m.lineOffsetY*Wn,!1,nn,ht,m,x,N,{},ue&&!ce?pt:null,ce&&!!ue,He,Ye,ce):null;let pn=!1,$n=!1,ln=!0;if(An&&!$t.occluded){const Mn=.5*$e*an+Qe,jn=new s.Point(-100,-100),Bn=new s.Point(this.screenRightBoundary,this.screenBottomBoundary),Yn=new co,{first:Di,last:$i}=An,vi=Di.path.length;let ki=[];for(let Ti=vi-1;Ti>=1;Ti--)ki.push(Di.path[Ti]);for(let Ti=1;Ti<$i.path.length;Ti++)ki.push($i.path[Ti]);const ho=2.5*Mn;H&&(ki=ki.map(([Ti,Fo,Bo],No)=>(pt&&!qt&&(Bo=pt(No<vi-1?Di.tilePath[vi-1-No]:$i.tilePath[No-vi+2])[2]),Ji(Ti,Fo,Bo,H))),ki.some(Ti=>Ti[3]<=0)&&(ki=[]));let fo=[];if(ki.length>0){let Ti=1/0,Fo=-1/0,Bo=1/0,No=-1/0;for(const zo of ki)Ti=Math.min(Ti,zo[0]),Bo=Math.min(Bo,zo[1]),Fo=Math.max(Fo,zo[0]),No=Math.max(No,zo[1]);Fo>=jn.x&&Ti<=Bn.x&&No>=jn.y&&Bo<=Bn.y&&(fo=[ki.map(zo=>new s.Point(zo[0],zo[1]))],(Ti<jn.x||Fo>Bn.x||Bo<jn.y||No>Bn.y)&&(fo=s.clipLine(fo,jn.x,jn.y,Bn.x,Bn.y)))}for(const Ti of fo){Yn.reset(Ti,.25*Mn);let Fo=0;Fo=Yn.length<=.5*Mn?1:Math.ceil(Yn.paddedLength/ho)+1;for(let Bo=0;Bo<Fo;Bo++){const No=Bo/Math.max(Fo-1,1),zo=Yn.lerp(No),gs=zo.x+Bt,Yr=zo.y+Bt;ot.push(gs,Yr,Mn,0);const _s=gs-Mn,Qa=Yr-Mn,yr=gs+Mn,ar=Yr+Mn;if(ln=ln&&this.isOffscreen(_s,Qa,yr,ar),$n=$n||this.isInsideGrid(_s,Qa,yr,ar),!c&&this.grid.hitTestCircle(gs,Yr,Mn,Ie)&&(pn=!0,!$))return{circles:[],offscreen:!1,collisionDetected:pn,occluded:!1}}}}return{circles:!$&&pn||!$n?[]:ot,offscreen:ln,collisionDetected:pn,occluded:$t.occluded}}queryRenderedSymbols(o){if(0===o.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let m=1/0,x=1/0,C=-1/0,I=-1/0;for(const $ of o){const ce=new s.Point($.x+Bt,$.y+Bt);m=Math.min(m,ce.x),x=Math.min(x,ce.y),C=Math.max(C,ce.x),I=Math.max(I,ce.y),c.push(ce)}const O=this.grid.query(m,x,C,I).concat(this.ignoredGrid.query(m,x,C,I)),N={},H={};for(const $ of O){const ce=$.key;if(void 0===N[ce.bucketInstanceId]&&(N[ce.bucketInstanceId]={}),N[ce.bucketInstanceId][ce.featureIndex])continue;const Ie=[new s.Point($.x1,$.y1),new s.Point($.x2,$.y1),new s.Point($.x2,$.y2),new s.Point($.x1,$.y2)];s.polygonIntersectsPolygon(c,Ie)&&(N[ce.bucketInstanceId][ce.featureIndex]=!0,void 0===H[ce.bucketInstanceId]&&(H[ce.bucketInstanceId]=[]),H[ce.bucketInstanceId].push(ce.featureIndex))}return H}insertCollisionBox(o,c,m,x,C){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:m,featureIndex:x,collisionGroupID:C},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,c,m,x,C){const I=c?this.ignoredGrid:this.grid,O={bucketInstanceId:m,featureIndex:x,collisionGroupID:C};for(let N=0;N<o.length;N+=4)I.insertCircle(O,o[N],o[N+1],o[N+2])}projectAndGetPerspectiveRatio(o,c,m,x,C,I,O){const N=[c,m,x,1];let H=!1;x||this.transform.pitch>0?(s.transformMat4$1(N,N,o),this.fogState&&C&&"globe"!==O.name&&(H=function(Ie,$e,Qe,Ye,ot,ue){const He=ue.calculateFogTileMatrix(ot),pt=[$e,Qe,Ye];return s.transformMat4(pt,pt,He),Ze(Ie,pt,ue.pitch,ue._fov)}(this.fogState,c,m,x,C.toUnwrapped(),this.transform)>.9)):it(N,N,o);const $=N[3];return{point:new s.Point((N[0]/$+1)/2*this.transform.width+Bt,(-N[1]/$+1)/2*this.transform.height+Bt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(O)/$*.5,1.5),signedDistanceFromCamera:$,occluded:I&&N[2]>$||H}}isOffscreen(o,c,m,x){return m<Bt||o>=this.screenRightBoundary||x<Bt||c>this.screenBottomBoundary}isInsideGrid(o,c,m,x){return m>=0&&o<this.gridRightBoundary&&x>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const o=s.identity([]);return s.translate(o,o,[-100,-100,0]),o}}function yn(p,o,c){const m=o.createTileMatrix(p,p.worldSize,c.toUnwrapped());return s.multiply(new Float32Array(16),p.projMatrix,m)}function Tn(p,o,c){if(o.projection.name===c.projection.name)return p.projMatrix;const m=c.clone();return m.setProjection(o.projection),yn(m,o.getProjection(),p)}function xn(p,o,c){return o.name===c.projection.name?p.projMatrix:yn(c,o,p)}class On{constructor(o,c,m,x){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?c:-c))):x&&m?1:0,this.placed=m}isHidden(){return 0===this.opacity&&!this.placed}}class hi{constructor(o,c,m,x,C,I=!1){this.text=new On(o?o.text:null,c,m,C),this.icon=new On(o?o.icon:null,c,x,C),this.clipped=I}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Ii{constructor(o,c,m,x=!1){this.text=o,this.icon=c,this.skipFade=m,this.clipped=x}}class zi{constructor(){this.invProjMatrix=s.create(),this.viewportMatrix=s.create(),this.circles=[]}}class Lo{constructor(o,c,m,x,C){this.bucketInstanceId=o,this.featureIndex=c,this.sourceLayerIndex=m,this.bucketIndex=x,this.tileID=C}}class Xi{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const c=++this.maxGroupID;this.collisionGroups[o]={ID:c,predicate:m=>m.collisionGroupID===c}}return this.collisionGroups[o]}}function so(p,o,c,m,x){const{horizontalAlign:C,verticalAlign:I}=s.getAnchorAlignment(p),O=-(C-.5)*o,N=-(I-.5)*c,H=s.evaluateVariableOffset(p,m);return new s.Point(O+H[0]*x,N+H[1]*x)}function To(p,o,c,m,x){const C=new s.Point(p,o);return c&&C._rotate(m?x:-x),C}class or{constructor(o,c,m,x,C){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new zt(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new Xi(m),this.collisionCircleArrays={},this.prevPlacement=x,x&&(x.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,c,m,x){const C=m.getBucket(c),I=m.latestFeatureIndex;if(!C||!I||c.id!==C.layerIds[0])return;const O=C.layers[0].layout,N=m.collisionBoxArray,H=Math.pow(2,this.transform.zoom-m.tileID.overscaledZ),$=m.tileSize/s.EXTENT,ce=m.tileID.toUnwrapped();this.transform.setProjection(C.projection);const Ie=($e=m.tileID,Qe=C.getProjection(),Ye=this.transform,Qe.name===this.projection?Ye.calculateProjMatrix($e.toUnwrapped()):yn(Ye,Qe,$e));var $e,Qe,Ye;const ot="map"===O.get("text-pitch-alignment"),ue="map"===O.get("text-rotation-alignment");c.compileFilter();const He=c.dynamicFilter(),pt=c.dynamicFilterNeedsFeature(),ht=this.transform.calculatePixelsToTileUnitsMatrix(m),Pt=Qo(Ie,m.tileID.canonical,ot,ue,this.transform,C.getProjection(),ht);let Lt=null;if(ot){const $t=vo(Ie,m.tileID.canonical,ot,ue,this.transform,C.getProjection(),ht);Lt=s.multiply([],this.transform.labelPlaneMatrix,$t)}let Ot=null;He&&m.latestFeatureIndex&&(Ot={unwrappedTileID:ce,dynamicFilter:He,dynamicFilterNeedsFeature:pt,featureIndex:m.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new Lo(C.bucketInstanceId,I,C.sourceLayerIndex,C.index,m.tileID);const qt={bucket:C,layout:O,posMatrix:Ie,textLabelPlaneMatrix:Pt,labelToScreenMatrix:Lt,clippingData:Ot,scale:H,textPixelRatio:$,holdingForFade:m.holdingForFade(),collisionBoxArray:N,partiallyEvaluatedTextSize:s.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:s.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(x)for(const $t of C.sortKeyRanges){const{sortKey:an,symbolInstanceStart:Wn,symbolInstanceEnd:nn}=$t;o.push({sortKey:an,symbolInstanceStart:Wn,symbolInstanceEnd:nn,parameters:qt})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:qt})}attemptAnchorPlacement(o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye,ot,ue,He){const{textOffset0:pt,textOffset1:ht,crossTileID:Pt}=Ie,Lt=[pt,ht],Ot=so(o,m,x,Lt,C),qt=this.collisionIndex.placeCollisionBox(Qe,C,c,To(Ot.x,Ot.y,I,O,this.transform.angle),ce,N,H,$.predicate);if(ot){const $t=Qe.getSymbolInstanceIconSize(He,this.transform.zoom,Ie.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Qe,$t,ot,To(Ot.x,Ot.y,I,O,this.transform.angle),ce,N,H,$.predicate).box.length)return}if(qt.box.length>0){let $t;return this.prevPlacement&&this.prevPlacement.variableOffsets[Pt]&&this.prevPlacement.placements[Pt]&&this.prevPlacement.placements[Pt].text&&($t=this.prevPlacement.variableOffsets[Pt].anchor),this.variableOffsets[Pt]={textOffset:Lt,width:m,height:x,anchor:o,textScale:C,prevAnchor:$t},this.markUsedJustification(Qe,o,Ie,Ye),Qe.allowVerticalPlacement&&(this.markUsedOrientation(Qe,Ye,Ie),this.placedOrientations[Pt]=Ye),{shift:Ot,placedGlyphBoxes:qt}}}placeLayerBucketPart(o,c,m,x){const{bucket:C,layout:I,posMatrix:O,textLabelPlaneMatrix:N,labelToScreenMatrix:H,clippingData:$,textPixelRatio:ce,holdingForFade:Ie,collisionBoxArray:$e,partiallyEvaluatedTextSize:Qe,partiallyEvaluatedIconSize:Ye,collisionGroup:ot}=o.parameters,ue=I.get("text-optional"),He=I.get("icon-optional"),pt=I.get("text-allow-overlap"),ht=I.get("icon-allow-overlap"),Pt="map"===I.get("text-rotation-alignment"),Lt="map"===I.get("text-pitch-alignment"),Ot="none"!==I.get("icon-text-fit"),qt="viewport-y"===I.get("symbol-z-order");this.transform.setProjection(C.projection);let $t=pt&&(ht||!C.hasIconData()||He),an=ht&&(pt||!C.hasTextData()||ue);!C.collisionArrays&&$e&&C.deserializeCollisionBoxes($e),m&&x&&C.updateCollisionDebugBuffers(this.transform.zoom,$e);const Wn=(nn,An,pn)=>{const{crossTileID:$n,numVerticalGlyphVertices:ln}=nn;if($){const yr={zoom:this.transform.zoom,pitch:this.transform.pitch};let ar=null;if($.dynamicFilterNeedsFeature){const Uo=this.retainedQueryData[C.bucketInstanceId];ar=$.featureIndex.loadFeature({featureIndex:nn.featureIndex,bucketIndex:Uo.bucketIndex,sourceLayerIndex:Uo.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,$.dynamicFilter)(yr,ar,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new s.Point(nn.tileAnchorX,nn.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[$n]=new Ii(!1,!1,!1,!0),void c.add($n)}if(c.has($n))return;if(Ie)return void(this.placements[$n]=new Ii(!1,!1,!1));let Mn=!1,jn=!1,Bn=!0,Yn=!1,Di=!1,$i=null,vi={box:null,offscreen:null,occluded:null},ki={box:null,offscreen:null,occluded:null},ho=null,fo=null,Ti=null,Fo=0,Bo=0,No=0;pn.textFeatureIndex?Fo=pn.textFeatureIndex:nn.useRuntimeCollisionCircles&&(Fo=nn.featureIndex),pn.verticalTextFeatureIndex&&(Bo=pn.verticalTextFeatureIndex);const zo=yr=>{yr.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const ar=this.transform.elevation;(ar||yr.elevation)&&(yr.elevation=ar?ar.getAtTileOffset(yr.tileID,yr.tileAnchorX,yr.tileAnchorY):0)},gs=pn.textBox;if(gs){zo(gs);const yr=Uo=>{let Jr=s.WritingMode.horizontal;if(C.allowVerticalPlacement&&!Uo&&this.prevPlacement){const Ys=this.prevPlacement.placedOrientations[$n];Ys&&(this.placedOrientations[$n]=Ys,Jr=Ys,this.markUsedOrientation(C,Jr,nn))}return Jr},ar=(Uo,Jr)=>{if(C.allowVerticalPlacement&&ln>0&&pn.verticalTextBox){for(const Ys of C.writingModes)if(Ys===s.WritingMode.vertical?(vi=Jr(),ki=vi):vi=Uo(),vi&&vi.box&&vi.box.length)break}else vi=Uo()};if(I.get("text-variable-anchor")){let Uo=I.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[$n]){const vr=this.prevPlacement.variableOffsets[$n];Uo.indexOf(vr.anchor)>0&&(Uo=Uo.filter(la=>la!==vr.anchor),Uo.unshift(vr.anchor))}const Jr=(vr,la,xl)=>{const gc=C.getSymbolInstanceTextSize(Qe,nn,this.transform.zoom,An),bu=(vr.x2-vr.x1)*gc+2*vr.padding,mr=(vr.y2-vr.y1)*gc+2*vr.padding,bl=Ot&&!ht?la:null;bl&&zo(bl);let Sa={box:[],offscreen:!1,occluded:!1};const wu=pt?2*Uo.length:Uo.length;for(let Ms=0;Ms<wu;++Ms){const Gl=this.attemptAnchorPlacement(Uo[Ms%Uo.length],vr,bu,mr,gc,Pt,Lt,ce,O,ot,Ms>=Uo.length,nn,An,C,xl,bl,Qe,Ye);if(Gl&&(Sa=Gl.placedGlyphBoxes,Sa&&Sa.box&&Sa.box.length)){Mn=!0,$i=Gl.shift;break}}return Sa};ar(()=>Jr(gs,pn.iconBox,s.WritingMode.horizontal),()=>{const vr=pn.verticalTextBox;return vr&&zo(vr),C.allowVerticalPlacement&&!(vi&&vi.box&&vi.box.length)&&ln>0&&vr?Jr(vr,pn.verticalIconBox,s.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),vi&&(Mn=vi.box,Bn=vi.offscreen,Yn=vi.occluded);const Ys=yr(!(!vi||!vi.box));if(!Mn&&this.prevPlacement){const vr=this.prevPlacement.variableOffsets[$n];vr&&(this.variableOffsets[$n]=vr,this.markUsedJustification(C,vr.anchor,nn,Ys))}}else{const Uo=(Jr,Ys)=>{const vr=C.getSymbolInstanceTextSize(Qe,nn,this.transform.zoom,An),la=this.collisionIndex.placeCollisionBox(C,vr,Jr,new s.Point(0,0),pt,ce,O,ot.predicate);return la&&la.box&&la.box.length&&(this.markUsedOrientation(C,Ys,nn),this.placedOrientations[$n]=Ys),la};ar(()=>Uo(gs,s.WritingMode.horizontal),()=>{const Jr=pn.verticalTextBox;return C.allowVerticalPlacement&&ln>0&&Jr?(zo(Jr),Uo(Jr,s.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),yr(!!(vi&&vi.box&&vi.box.length))}}if(ho=vi,Mn=ho&&ho.box&&ho.box.length>0,Bn=ho&&ho.offscreen,Yn=ho&&ho.occluded,nn.useRuntimeCollisionCircles){const yr=C.text.placedSymbolArray.get(nn.centerJustifiedTextSymbolIndex>=0?nn.centerJustifiedTextSymbolIndex:nn.verticalPlacedTextSymbolIndex),ar=s.evaluateSizeForFeature(C.textSizeData,Qe,yr),Uo=I.get("text-padding");fo=this.collisionIndex.placeCollisionCircles(C,pt,yr,C.lineVertexArray,C.glyphOffsetArray,ar,O,N,H,m,Lt,ot.predicate,nn.collisionCircleDiameter*ar/s.ONE_EM,Uo,this.retainedQueryData[C.bucketInstanceId].tileID),Mn=pt||fo.circles.length>0&&!fo.collisionDetected,Bn=Bn&&fo.offscreen,Yn=fo.occluded}if(pn.iconFeatureIndex&&(No=pn.iconFeatureIndex),pn.iconBox){const yr=ar=>{zo(ar);const Uo=Ot&&$i?To($i.x,$i.y,Pt,Lt,this.transform.angle):new s.Point(0,0),Jr=C.getSymbolInstanceIconSize(Ye,this.transform.zoom,nn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Jr,ar,Uo,ht,ce,O,ot.predicate)};ki&&ki.box&&ki.box.length&&pn.verticalIconBox?(Ti=yr(pn.verticalIconBox),jn=Ti.box.length>0):(Ti=yr(pn.iconBox),jn=Ti.box.length>0),Bn=Bn&&Ti.offscreen,Di=Ti.occluded}const Yr=ue||0===nn.numHorizontalGlyphVertices&&0===ln,_s=He||0===nn.numIconVertices;if(Yr||_s?_s?Yr||(jn=jn&&Mn):Mn=jn&&Mn:jn=Mn=jn&&Mn,Mn&&ho&&ho.box&&this.collisionIndex.insertCollisionBox(ho.box,I.get("text-ignore-placement"),C.bucketInstanceId,ki&&ki.box&&Bo?Bo:Fo,ot.ID),jn&&Ti&&this.collisionIndex.insertCollisionBox(Ti.box,I.get("icon-ignore-placement"),C.bucketInstanceId,No,ot.ID),fo&&(Mn&&this.collisionIndex.insertCollisionCircles(fo.circles,I.get("text-ignore-placement"),C.bucketInstanceId,Fo,ot.ID),m)){const yr=C.bucketInstanceId;let ar=this.collisionCircleArrays[yr];void 0===ar&&(ar=this.collisionCircleArrays[yr]=new zi);for(let Uo=0;Uo<fo.circles.length;Uo+=4)ar.circles.push(fo.circles[Uo+0]),ar.circles.push(fo.circles[Uo+1]),ar.circles.push(fo.circles[Uo+2]),ar.circles.push(fo.collisionDetected?1:0)}const Qa="globe"!==C.projection.name;$t=$t&&(Qa||!Yn),an=an&&(Qa||!Di),this.placements[$n]=new Ii(Mn||$t,jn||an,Bn||C.justReloaded),c.add($n)};if(qt){const nn=C.getSortedSymbolIndexes(this.transform.angle);for(let An=nn.length-1;An>=0;--An){const pn=nn[An];Wn(C.symbolInstances.get(pn),pn,C.collisionArrays[pn])}}else for(let nn=o.symbolInstanceStart;nn<o.symbolInstanceEnd;nn++)Wn(C.symbolInstances.get(nn),nn,C.collisionArrays[nn]);if(m&&C.bucketInstanceId in this.collisionCircleArrays){const nn=this.collisionCircleArrays[C.bucketInstanceId];s.invert(nn.invProjMatrix,O),nn.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(o,c,m,x){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:O,verticalPlacedTextSymbolIndex:N,crossTileID:H}=m,$=s.getAnchorJustification(c),ce=x===s.WritingMode.vertical?N:"left"===$?C:"center"===$?I:"right"===$?O:-1;C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=ce>=0&&C!==ce?0:H),I>=0&&(o.text.placedSymbolArray.get(I).crossTileID=ce>=0&&I!==ce?0:H),O>=0&&(o.text.placedSymbolArray.get(O).crossTileID=ce>=0&&O!==ce?0:H),N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=ce>=0&&N!==ce?0:H)}markUsedOrientation(o,c,m){const x=c===s.WritingMode.horizontal||c===s.WritingMode.horizontalOnly?c:0,C=c===s.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:I,centerJustifiedTextSymbolIndex:O,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:H}=m,$=o.text.placedSymbolArray;I>=0&&($.get(I).placedOrientation=x),O>=0&&($.get(O).placedOrientation=x),N>=0&&($.get(N).placedOrientation=x),H>=0&&($.get(H).placedOrientation=C)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let m=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const x=c?c.symbolFadeChange(o):1,C=c?c.opacities:{},I=c?c.variableOffsets:{},O=c?c.placedOrientations:{};for(const N in this.placements){const H=this.placements[N],$=C[N];$?(this.opacities[N]=new hi($,x,H.text,H.icon,null,H.clipped),m=m||H.text!==$.text.placed||H.icon!==$.icon.placed):(this.opacities[N]=new hi(null,x,H.text,H.icon,H.skipFade,H.clipped),m=m||H.text||H.icon)}for(const N in C){const H=C[N];if(!this.opacities[N]){const $=new hi(H,x,!1,!1);$.isHidden()||(this.opacities[N]=$,m=m||H.text.placed||H.icon.placed)}}for(const N in I)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=I[N]);for(const N in O)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=O[N]);m?this.lastPlacementChangeTime=o:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:o)}updateLayerOpacities(o,c){const m=new Set;for(const x of c){const C=x.getBucket(o);C&&x.latestFeatureIndex&&o.id===C.layerIds[0]&&this.updateBucketOpacities(C,m,x.collisionBoxArray)}}updateBucketOpacities(o,c,m){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const x=o.layers[0].layout,C=!!o.layers[0].dynamicFilter(),I=new hi(null,0,!1,!1,!0),O=x.get("text-allow-overlap"),N=x.get("icon-allow-overlap"),H=x.get("text-variable-anchor"),$="map"===x.get("text-rotation-alignment"),ce="map"===x.get("text-pitch-alignment"),Ie="none"!==x.get("icon-text-fit"),$e=new hi(null,0,O&&(N||!o.hasIconData()||x.get("icon-optional")),N&&(O||!o.hasTextData()||x.get("text-optional")),!0);!o.collisionArrays&&m&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(m);const Qe=(ot,ue,He)=>{for(let pt=0;pt<ue/4;pt++)ot.opacityVertexArray.emplaceBack(He)};let Ye=0;for(let ot=0;ot<o.symbolInstances.length;ot++){const ue=o.symbolInstances.get(ot),{numHorizontalGlyphVertices:He,numVerticalGlyphVertices:pt,crossTileID:ht,numIconVertices:Pt}=ue,Lt=c.has(ht);let Ot=this.opacities[ht];Lt?Ot=I:Ot||(Ot=$e,this.opacities[ht]=Ot),c.add(ht);const qt=He>0||pt>0,$t=Pt>0,an=this.placedOrientations[ht],Wn=an===s.WritingMode.vertical,nn=an===s.WritingMode.horizontal||an===s.WritingMode.horizontalOnly;if(!qt&&!$t||Ot.isHidden()||Ye++,qt){const An=Fi(Ot.text);Qe(o.text,He,Wn?Bi:An),Qe(o.text,pt,nn?Bi:An);const pn=Ot.text.isHidden(),{leftJustifiedTextSymbolIndex:$n,centerJustifiedTextSymbolIndex:ln,rightJustifiedTextSymbolIndex:Mn,verticalPlacedTextSymbolIndex:jn}=ue,Bn=o.text.placedSymbolArray,Yn=pn||Wn?1:0;$n>=0&&(Bn.get($n).hidden=Yn),ln>=0&&(Bn.get(ln).hidden=Yn),Mn>=0&&(Bn.get(Mn).hidden=Yn),jn>=0&&(Bn.get(jn).hidden=pn||nn?1:0);const Di=this.variableOffsets[ht];Di&&this.markUsedJustification(o,Di.anchor,ue,an);const $i=this.placedOrientations[ht];$i&&(this.markUsedJustification(o,"left",ue,$i),this.markUsedOrientation(o,$i,ue))}if($t){const An=Fi(Ot.icon),{placedIconSymbolIndex:pn,verticalPlacedIconSymbolIndex:$n}=ue,ln=o.icon.placedSymbolArray,Mn=Ot.icon.isHidden()?1:0;pn>=0&&(Qe(o.icon,Pt,Wn?Bi:An),ln.get(pn).hidden=Mn),$n>=0&&(Qe(o.icon,ue.numVerticalIconVertices,nn?Bi:An),ln.get($n).hidden=Mn)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const An=o.collisionArrays[ot];if(An){let pn=new s.Point(0,0),$n=!0;if(An.textBox||An.verticalTextBox){if(H){const Mn=this.variableOffsets[ht];Mn?(pn=so(Mn.anchor,Mn.width,Mn.height,Mn.textOffset,Mn.textScale),$&&pn._rotate(ce?this.transform.angle:-this.transform.angle)):$n=!1}C&&($n=!Ot.clipped),An.textBox&&Wo(o.textCollisionBox.collisionVertexArray,Ot.text.placed,!$n||Wn,pn.x,pn.y),An.verticalTextBox&&Wo(o.textCollisionBox.collisionVertexArray,Ot.text.placed,!$n||nn,pn.x,pn.y)}const ln=$n&&!(nn||!An.verticalIconBox);An.iconBox&&Wo(o.iconCollisionBox.collisionVertexArray,Ot.icon.placed,ln,Ie?pn.x:0,Ie?pn.y:0),An.verticalIconBox&&Wo(o.iconCollisionBox.collisionVertexArray,Ot.icon.placed,!ln,Ie?pn.x:0,Ie?pn.y:0)}}}if(o.fullyClipped=0===Ye,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const ot=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=ot.invProjMatrix,o.placementViewportMatrix=ot.viewportMatrix,o.collisionCircleArray=ot.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return 0===this.fadeDuration?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,c){const m=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*m>o}setStale(){this.stale=!0}}function Wo(p,o,c,m,x){p.emplaceBack(o?1:0,c?1:0,m||0,x||0),p.emplaceBack(o?1:0,c?1:0,m||0,x||0),p.emplaceBack(o?1:0,c?1:0,m||0,x||0),p.emplaceBack(o?1:0,c?1:0,m||0,x||0)}const dr=Math.pow(2,25),wo=Math.pow(2,24),xs=Math.pow(2,17),ea=Math.pow(2,16),hr=Math.pow(2,9),bo=Math.pow(2,8),mi=Math.pow(2,1);function Fi(p){if(0===p.opacity&&!p.placed)return 0;if(1===p.opacity&&p.placed)return 4294967295;const o=p.placed?1:0,c=Math.floor(127*p.opacity);return c*dr+o*wo+c*xs+o*ea+c*hr+o*bo+c*mi+o}const Bi=0;class er{constructor(o){this._sortAcrossTiles="viewport-y"!==o.layout.get("symbol-z-order")&&void 0!==o.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,c,m,x,C){const I=this._bucketParts;for(;this._currentTileIndex<o.length;)if(c.getBucketParts(I,x,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,I.sort((O,N)=>O.sortKey-N.sortKey));this._currentPartIndex<I.length;){const O=I[this._currentPartIndex];if(c.placeLayerBucketPart(O,this._seenCrossTileIDs,m,0===O.symbolInstanceStart),this._currentPartIndex++,C())return!0}return!1}}class is{constructor(o,c,m,x,C,I,O,N){this.placement=new or(o,C,I,O,N),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=m,this._showCollisionBoxes=x,this._done=!1}isDone(){return this._done}continuePlacement(o,c,m){const x=s.exported.now(),C=()=>{const I=s.exported.now()-x;return!this._forceFullPlacement&&I>2};for(;this._currentPlacementIndex>=0;){const I=c[o[this._currentPlacementIndex]],O=this.placement.collisionIndex.transform.zoom;if("symbol"===I.type&&(!I.minzoom||I.minzoom<=O)&&(!I.maxzoom||I.maxzoom>O)){if(this._inProgressLayer||(this._inProgressLayer=new er(I)),this._inProgressLayer.continuePlacement(m[I.source],this.placement,this._showCollisionBoxes,I,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const jo=512/s.EXTENT/2;class Jo{constructor(o,c,m){this.tileID=o,this.bucketInstanceId=m,this.index=new s.KDBush(c.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const x=o.canonical.x*s.EXTENT,C=o.canonical.y*s.EXTENT;for(let I=0;I<c.length;I++){const{key:O,crossTileID:N,tileAnchorX:H,tileAnchorY:$}=c.get(I),ce=Math.floor((x+H)*jo),Ie=Math.floor((C+$)*jo);this.index.add(ce,Ie),this.keys.push(O),this.crossTileIDs.push(N)}this.index.finish()}findMatches(o,c,m){const x=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z),C=jo/Math.pow(2,c.canonical.z-this.tileID.canonical.z),I=c.canonical.x*s.EXTENT,O=c.canonical.y*s.EXTENT;for(let N=0;N<o.length;N++){const H=o.get(N);if(H.crossTileID)continue;const{key:$,tileAnchorX:ce,tileAnchorY:Ie}=H,$e=Math.floor((I+ce)*C),Qe=Math.floor((O+Ie)*C),Ye=this.index.range($e-x,Qe-x,$e+x,Qe+x);for(const ot of Ye){const ue=this.crossTileIDs[ot];if(this.keys[ot]===$&&!m.has(ue)){m.add(ue),H.crossTileID=ue;break}}}}}class Oo{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ur{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const c=Math.round((o-this.lng)/360);if(0!==c)for(const m in this.indexes){const x=this.indexes[m],C={};for(const I in x){const O=x[I];O.tileID=O.tileID.unwrapTo(O.tileID.wrap+c),C[O.tileID.key]=O}this.indexes[m]=C}this.lng=o}addBucket(o,c,m){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let C=0;C<c.symbolInstances.length;C++)c.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const x=this.usedCrossTileIDs[o.overscaledZ];for(const C in this.indexes){const I=this.indexes[C];if(Number(C)>o.overscaledZ)for(const O in I){const N=I[O];N.tileID.isChildOf(o)&&N.findMatches(c.symbolInstances,o,x)}else{const O=I[o.scaledTo(Number(C)).key];O&&O.findMatches(c.symbolInstances,o,x)}}for(let C=0;C<c.symbolInstances.length;C++){const I=c.symbolInstances.get(C);I.crossTileID||(I.crossTileID=m.generate(),x.add(I.crossTileID))}return void 0===this.indexes[o.overscaledZ]&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Jo(o,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(o,c){for(const m of c.crossTileIDs)this.usedCrossTileIDs[o].delete(m)}removeStaleBuckets(o){let c=!1;for(const m in this.indexes){const x=this.indexes[m];for(const C in x)o[x[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(m,x[C]),delete x[C],c=!0)}return c}}class xr{constructor(){this.layerIndexes={},this.crossTileIDs=new Oo,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,c,m,x){let C=this.layerIndexes[o.id];void 0===C&&(C=this.layerIndexes[o.id]=new Ur);let I=!1;const O={};"globe"!==x.name&&C.handleWrapJump(m);for(const N of c){const H=N.getBucket(o);H&&o.id===H.layerIds[0]&&(H.bucketInstanceId||(H.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(N.tileID,H,this.crossTileIDs)&&(I=!0),O[H.bucketInstanceId]=!0)}return C.removeStaleBuckets(O)&&(I=!0),I}pruneUnusedLayers(o){const c={};o.forEach(m=>{c[m]=!0});for(const m in this.layerIndexes)c[m]||delete this.layerIndexes[m]}}const Ri=(p,o)=>s.emitValidationErrors(p,o&&o.filter(c=>"source.canvas"!==c.identifier)),us=s.pick(Pn,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ta=s.pick(Pn,["setCenter","setZoom","setBearing","setPitch"]),Xr={version:8,layers:[],sources:{}},ko={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class Ir extends s.Evented{constructor(o,c={}){super(),this.map=o,this.dispatcher=new dt(xt(),this),this.imageManager=new Xe,this.imageManager.setEventedParent(this),this.glyphManager=new s.GlyphManager(o._requestManager,c.localFontFamily?s.LocalGlyphMode.all:c.localIdeographFontFamily?s.LocalGlyphMode.ideographs:s.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new xr,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",s.getReferrer());const m=this;this._rtlTextPluginCallback=Ir.registerForPluginStateChange(x=>{m.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:x.pluginStatus,pluginURL:x.pluginURL},(C,I)=>{if(s.triggerPluginCompletionEvent(C),I&&I.every(O=>O))for(const O in m._sourceCaches){const N=m._sourceCaches[O],H=N.getSource().type;"vector"!==H&&"geojson"!==H||N.reload()}})}),this.on("data",x=>{if("source"!==x.dataType||"metadata"!==x.sourceDataType)return;const C=this.getSource(x.sourceId);if(C&&C.vectorLayerIds)for(const I in this._layers){const O=this._layers[I];O.source===C.id&&this._validateLayer(O)}})}loadURL(o,c={}){this.fire(new s.Event("dataloading",{dataType:"style"}));const m="boolean"==typeof c.validate?c.validate:!s.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,c.accessToken);const x=this.map._requestManager.transformRequest(o,s.ResourceType.Style);this._request=s.getJSON(x,(C,I)=>{this._request=null,C?this.fire(new s.ErrorEvent(C)):I&&this._load(I,m)})}loadJSON(o,c={}){this.fire(new s.Event("dataloading",{dataType:"style"})),this._request=s.exported.frame(()=>{this._request=null,this._load(o,!1!==c.validate)})}loadEmpty(){this.fire(new s.Event("dataloading",{dataType:"style"})),this._load(Xr,!1)}_updateLayerCount(o,c){const m=c?1:-1;o.is3D()&&(this._num3DLayers+=m),"circle"===o.type&&(this._numCircleLayers+=m),"symbol"===o.type&&(this._numSymbolLayers+=m)}_load(o,c){if(c&&Ri(this,s.validateStyle(o)))return;this._loaded=!0,this.stylesheet=s.clone$1(o),this._updateMapProjection();for(const x in o.sources)this.addSource(x,o.sources[x],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const m=Nn(this.stylesheet.layers);this._order=m.map(x=>x.id),this._layers={},this._serializedLayers={};for(const x of m){const C=s.createStyleLayer(x);C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ae(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new s.Event("data",{dataType:"style"})),this.fire(new s.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=function(c,m,x){let C,I,O;const N=s.exported.devicePixelRatio>1?"@2x":"";let H=s.getJSON(m.transformRequest(m.normalizeSpriteURL(c,N,".json"),s.ResourceType.SpriteJSON),(Ie,$e)=>{H=null,O||(O=Ie,C=$e,ce())}),$=s.getImage(m.transformRequest(m.normalizeSpriteURL(c,N,".png"),s.ResourceType.SpriteImage),(Ie,$e)=>{$=null,O||(O=Ie,I=$e,ce())});function ce(){if(O)x(O);else if(C&&I){const Ie=s.exported.getImageData(I),$e={};for(const Qe in C){const{width:Ye,height:ot,x:ue,y:He,sdf:pt,pixelRatio:ht,stretchX:Pt,stretchY:Lt,content:Ot}=C[Qe],qt=new s.RGBAImage({width:Ye,height:ot});s.RGBAImage.copy(Ie,qt,{x:ue,y:He},{x:0,y:0},{width:Ye,height:ot}),$e[Qe]={data:qt,pixelRatio:ht,sdf:pt,stretchX:Pt,stretchY:Lt,content:Ot}}x(null,$e)}}return{cancel(){H&&(H.cancel(),H=null),$&&($.cancel(),$=null)}}}(o,this.map._requestManager,(c,m)=>{if(this._spriteRequest=null,c)this.fire(new s.ErrorEvent(c));else if(m)for(const x in m)this.imageManager.addImage(x,m[x]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new s.Event("data",{dataType:"style"}))})}_validateLayer(o){const c=this.getSource(o.source);if(!c)return;const m=o.sourceLayer;m&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(m))&&this.fire(new s.ErrorEvent(new Error(`Source layer "${m}" does not exist on source "${c.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const c=[];for(const m of o){const x=this._layers[m];"custom"!==x.type&&c.push(x.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&("function"==typeof o.isLayerDraped?o.isLayerDraped():ko[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const c=this._changed;if(this._changed){const x=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(x.length||C.length)&&this._updateWorkerLayers(x,C);for(const I in this._updatedSources){const O=this._updatedSources[I];"reload"===O?this._reloadSource(I):"clear"===O&&this._clearSource(I)}this._updateTilesForChangedImages();for(const I in this._updatedPaintProps)this._layers[I].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const m={};for(const x in this._sourceCaches){const C=this._sourceCaches[x];m[x]=C.used,C.used=!1}for(const x of this._order){const C=this._layers[x];if(C.recalculate(o,this._availableImages),!C.isHidden(o.zoom)){const O=this._getLayerSourceCache(C);O&&(O.used=!0)}const I=this.map.painter;if(I){const O=C.getProgramIds();if(!O)continue;const N=C.getProgramConfiguration(o.zoom);for(const H of O)I.useProgram(H,N)}}for(const x in m){const C=this._sourceCaches[x];m[x]!==C.used&&C.getSource().fire(new s.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new s.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Ri(this,s.validateStyle(o)))return!1;(o=s.clone$1(o)).layers=Nn(o.layers);const c=function(x,C){if(!x)return[{command:Pn.setStyle,args:[C]}];let I=[];try{if(!Q(x.version,C.version))return[{command:Pn.setStyle,args:[C]}];Q(x.center,C.center)||I.push({command:Pn.setCenter,args:[C.center]}),Q(x.zoom,C.zoom)||I.push({command:Pn.setZoom,args:[C.zoom]}),Q(x.bearing,C.bearing)||I.push({command:Pn.setBearing,args:[C.bearing]}),Q(x.pitch,C.pitch)||I.push({command:Pn.setPitch,args:[C.pitch]}),Q(x.sprite,C.sprite)||I.push({command:Pn.setSprite,args:[C.sprite]}),Q(x.glyphs,C.glyphs)||I.push({command:Pn.setGlyphs,args:[C.glyphs]}),Q(x.transition,C.transition)||I.push({command:Pn.setTransition,args:[C.transition]}),Q(x.light,C.light)||I.push({command:Pn.setLight,args:[C.light]}),Q(x.fog,C.fog)||I.push({command:Pn.setFog,args:[C.fog]}),Q(x.projection,C.projection)||I.push({command:Pn.setProjection,args:[C.projection]});const O={},N=[];!function(ce,Ie,$e,Qe){let Ye;for(Ye in Ie=Ie||{},ce=ce||{})ce.hasOwnProperty(Ye)&&(Ie.hasOwnProperty(Ye)||ni(Ye,$e,Qe));for(Ye in Ie){if(!Ie.hasOwnProperty(Ye))continue;const ot=Ie[Ye];ce.hasOwnProperty(Ye)?Q(ce[Ye],ot)||("geojson"===ce[Ye].type&&"geojson"===ot.type&&wi(ce,Ie,Ye)?$e.push({command:Pn.setGeoJSONSourceData,args:[Ye,ot.data]}):qi(Ye,Ie,$e,Qe)):ri(Ye,Ie,$e)}}(x.sources,C.sources,N,O);const H=[];x.layers&&x.layers.forEach(ce=>{ce.source&&O[ce.source]?I.push({command:Pn.removeLayer,args:[ce.id]}):H.push(ce)});let $=x.terrain;$&&O[$.source]&&(I.push({command:Pn.setTerrain,args:[void 0]}),$=void 0),I=I.concat(N),Q($,C.terrain)||I.push({command:Pn.setTerrain,args:[C.terrain]}),function(ce,Ie,$e){Ie=Ie||[];const Qe=(ce=ce||[]).map(Ao),Ye=Ie.map(Ao),ot=ce.reduce(Go,{}),ue=Ie.reduce(Go,{}),He=Qe.slice(),pt=Object.create(null);let ht,Pt,Lt,Ot,qt,$t,an;for(ht=0,Pt=0;ht<Qe.length;ht++)Lt=Qe[ht],ue.hasOwnProperty(Lt)?Pt++:($e.push({command:Pn.removeLayer,args:[Lt]}),He.splice(He.indexOf(Lt,Pt),1));for(ht=0,Pt=0;ht<Ye.length;ht++)Lt=Ye[Ye.length-1-ht],He[He.length-1-ht]!==Lt&&(ot.hasOwnProperty(Lt)?($e.push({command:Pn.removeLayer,args:[Lt]}),He.splice(He.lastIndexOf(Lt,He.length-Pt),1)):Pt++,$t=He[He.length-ht],$e.push({command:Pn.addLayer,args:[ue[Lt],$t]}),He.splice(He.length-ht,0,Lt),pt[Lt]=!0);for(ht=0;ht<Ye.length;ht++)if(Lt=Ye[ht],Ot=ot[Lt],qt=ue[Lt],!pt[Lt]&&!Q(Ot,qt))if(Q(Ot.source,qt.source)&&Q(Ot["source-layer"],qt["source-layer"])&&Q(Ot.type,qt.type)){for(an in mo(Ot.layout,qt.layout,$e,Lt,null,Pn.setLayoutProperty),mo(Ot.paint,qt.paint,$e,Lt,null,Pn.setPaintProperty),Q(Ot.filter,qt.filter)||$e.push({command:Pn.setFilter,args:[Lt,qt.filter]}),Q(Ot.minzoom,qt.minzoom)&&Q(Ot.maxzoom,qt.maxzoom)||$e.push({command:Pn.setLayerZoomRange,args:[Lt,qt.minzoom,qt.maxzoom]}),Ot)Ot.hasOwnProperty(an)&&"layout"!==an&&"paint"!==an&&"filter"!==an&&"metadata"!==an&&"minzoom"!==an&&"maxzoom"!==an&&(0===an.indexOf("paint.")?mo(Ot[an],qt[an],$e,Lt,an.slice(6),Pn.setPaintProperty):Q(Ot[an],qt[an])||$e.push({command:Pn.setLayerProperty,args:[Lt,an,qt[an]]}));for(an in qt)qt.hasOwnProperty(an)&&!Ot.hasOwnProperty(an)&&"layout"!==an&&"paint"!==an&&"filter"!==an&&"metadata"!==an&&"minzoom"!==an&&"maxzoom"!==an&&(0===an.indexOf("paint.")?mo(Ot[an],qt[an],$e,Lt,an.slice(6),Pn.setPaintProperty):Q(Ot[an],qt[an])||$e.push({command:Pn.setLayerProperty,args:[Lt,an,qt[an]]}))}else $e.push({command:Pn.removeLayer,args:[Lt]}),$t=He[He.lastIndexOf(Lt)+1],$e.push({command:Pn.addLayer,args:[qt,$t]})}(H,C.layers,I)}catch(O){console.warn("Unable to compute style diff:",O),I=[{command:Pn.setStyle,args:[C]}]}return I}(this.serialize(),o).filter(x=>!(x.command in ta));if(0===c.length)return!1;const m=c.filter(x=>!(x.command in us));if(m.length>0)throw new Error(`Unimplemented: ${m.map(x=>x.command).join(", ")}.`);return c.forEach(x=>{"setTransition"!==x.command&&"setProjection"!==x.command&&this[x.command].apply(this,x.args)}),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,c){return this.getImage(o)?this.fire(new s.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,c),this._afterImageUpdated(o),this)}updateImage(o,c){this.imageManager.updateImage(o,c)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new s.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new s.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,c,m={}){if(this._checkLoaded(),void 0!==this.getSource(o))throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(s.validateSource,`sources.${o}`,c,null,m))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const x=kt(o,c,this.dispatcher,this);x.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:x.serialize(),sourceId:o}));const C=I=>{const O=(I?"symbol:":"other:")+o,N=this._sourceCaches[O]=new s.SourceCache(O,x,I);(I?this._symbolSourceCaches:this._otherSourceCaches)[o]=N,N.style=this,N.onAdd(this.map)};C(!1),"vector"!==c.type&&"geojson"!==c.type||C(!0),x.onAdd&&x.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const c=this.getSource(o);if(!c)throw new Error("There is no source with this ID");for(const x in this._layers)if(this._layers[x].source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${x}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new s.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const m=this._getSourceCaches(o);for(const x of m)delete this._sourceCaches[x.id],delete this._updatedSources[x.id],x.fire(new s.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:x.getSource().id})),x.setEventedParent(null),x.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,c){this._checkLoaded(),this.getSource(o).setData(c),this._changed=!0}getSource(o){const c=this._getSourceCache(o);return c&&c.getSource()}_getSources(){const o=[];for(const c in this._otherSourceCaches){const m=this._getSourceCache(c);m&&o.push(m.getSource())}return o}addLayer(o,c,m={}){this._checkLoaded();const x=o.id;if(this.getLayer(x))return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${x}" already exists on this map`)));let C;if("custom"===o.type){if(Ri(this,s.validateCustomStyleLayer(o)))return;C=s.createStyleLayer(o)}else{if("object"==typeof o.source&&(this.addSource(x,o.source),o=s.clone$1(o),o=s.extend(o,{source:x})),this._validate(s.validateLayer,`layers.${x}`,o,{arrayIndex:-1},m))return;C=s.createStyleLayer(o),this._validateLayer(C),C.setEventedParent(this,{layer:{id:x}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const I=c?this._order.indexOf(c):this._order.length;if(c&&-1===I)return void this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(I,0,x),this._layerOrderChanged=!0,this._layers[x]=C;const O=this._getLayerSourceCache(C);if(this._removedLayers[x]&&C.source&&O&&"custom"!==C.type){const N=this._removedLayers[x];delete this._removedLayers[x],N.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",O.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,c){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===c)return;const m=this._order.indexOf(o);this._order.splice(m,1);const x=c?this._order.indexOf(c):this._order.length;c&&-1===x?this.fire(new s.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(x,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const c=this._layers[o];if(!c)return void this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const m=this._order.indexOf(o);this._order.splice(m,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=c,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const c in this._layers)if(this._layers[c].type===o)return!0;return!1}setLayerZoomRange(o,c,m){this._checkLoaded();const x=this.getLayer(o);x?x.minzoom===c&&x.maxzoom===m||(null!=c&&(x.minzoom=c),null!=m&&(x.maxzoom=m),this._updateLayer(x)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,c,m={}){this._checkLoaded();const x=this.getLayer(o);if(x){if(!Q(x.filter,c))return null==c?(x.filter=void 0,void this._updateLayer(x)):void(this._validate(s.validateFilter,`layers.${x.id}.filter`,c,{layerType:x.type},m)||(x.filter=s.clone$1(c),this._updateLayer(x)))}else this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const c=this.getLayer(o);return c&&s.clone$1(c.filter)}setLayoutProperty(o,c,m,x={}){this._checkLoaded();const C=this.getLayer(o);C?Q(C.getLayoutProperty(c),m)||(C.setLayoutProperty(c,m,x),this._updateLayer(C)):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,c){const m=this.getLayer(o);if(m)return m.getLayoutProperty(c);this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,c,m,x={}){this._checkLoaded();const C=this.getLayer(o);C?Q(C.getPaintProperty(c),m)||(C.setPaintProperty(c,m,x)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new s.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,c){const m=this.getLayer(o);return m&&m.getPaintProperty(c)}setFeatureState(o,c){this._checkLoaded();const m=o.source,x=o.sourceLayer,C=this.getSource(m);if(!C)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const I=C.type;if("geojson"===I&&x)return void this.fire(new s.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===I&&!x)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===o.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided.")));const O=this._getSourceCaches(m);for(const N of O)N.setFeatureState(x,o.id,c)}removeFeatureState(o,c){this._checkLoaded();const m=o.source,x=this.getSource(m);if(!x)return void this.fire(new s.ErrorEvent(new Error(`The source '${m}' does not exist in the map's style.`)));const C=x.type,I="vector"===C?o.sourceLayer:void 0;if("vector"===C&&!I)return void this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof o.id&&"number"!=typeof o.id)return void this.fire(new s.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const O=this._getSourceCaches(m);for(const N of O)N.removeFeatureState(I,o.id,c)}getFeatureState(o){this._checkLoaded();const c=o.source,m=o.sourceLayer,x=this.getSource(c);if(x){if("vector"!==x.type||m)return void 0===o.id&&this.fire(new s.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(m,o.id);this.fire(new s.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new s.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return s.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const c in this._sourceCaches){const m=this._sourceCaches[c].getSource();o[m.id]||(o[m.id]=m.serialize())}return s.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},c=>void 0!==c)}_updateLayer(o){this._updatedLayers[o.id]=!0;const c=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&c&&"raster"!==c.getSource().type&&(this._updatedSources[o.source]="reload",c.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const c=I=>"fill-extrusion"===this._layers[I].type,m={},x=[];for(let I=this._order.length-1;I>=0;I--){const O=this._order[I];if(c(O)){m[O]=I;for(const N of o){const H=N[O];if(H)for(const $ of H)x.push($)}}}x.sort((I,O)=>O.intersectionZ-I.intersectionZ);const C=[];for(let I=this._order.length-1;I>=0;I--){const O=this._order[I];if(c(O))for(let N=x.length-1;N>=0;N--){const H=x[N].feature;if(m[H.layer.id]<I)break;C.push(H),x.pop()}else for(const N of o){const H=N[O];if(H)for(const $ of H)C.push($.feature)}}return C}queryRenderedFeatures(o,c,m){c&&c.filter&&this._validate(s.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const x={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new s.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const N of c.layers){const H=this._layers[N];if(!H)return this.fire(new s.ErrorEvent(new Error(`The layer '${N}' does not exist in the map's style and cannot be queried for features.`))),[];x[H.source]=!0}}const C=[];c.availableImages=this._availableImages;const I=c&&c.layers?c.layers.some(N=>{const H=this.getLayer(N);return H&&H.is3D()}):this.has3DLayers(),O=ct.createFromScreenPoints(o,m);for(const N in this._sourceCaches){const H=this._sourceCaches[N].getSource().id;c.layers&&!x[H]||C.push(ti(this._sourceCaches[N],this._layers,this._serializedLayers,O,c,m,I,!!this.map._showQueryGeometry))}return this.placement&&C.push(function(N,H,$,ce,Ie,$e,Qe){const Ye={},ot=$e.queryRenderedSymbols(ce),ue=[];for(const He of Object.keys(ot).map(Number))ue.push(Qe[He]);ue.sort(Si);for(const He of ue){const pt=He.featureIndex.lookupSymbolFeatures(ot[He.bucketInstanceId],H,He.bucketIndex,He.sourceLayerIndex,Ie.filter,Ie.layers,Ie.availableImages,N);for(const ht in pt){const Pt=Ye[ht]=Ye[ht]||[],Lt=pt[ht];Lt.sort((Ot,qt)=>{const $t=He.featureSortOrder;if($t){const an=$t.indexOf(Ot.featureIndex);return $t.indexOf(qt.featureIndex)-an}return qt.featureIndex-Ot.featureIndex});for(const Ot of Lt)Pt.push(Ot)}}for(const He in Ye)Ye[He].forEach(pt=>{const ht=pt.feature,Pt=$(N[He]);if(!Pt)return;const Lt=Pt.getFeatureState(ht.layer["source-layer"],ht.id);ht.source=ht.layer.source,ht.layer["source-layer"]&&(ht.sourceLayer=ht.layer["source-layer"]),ht.state=Lt});return Ye}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),O.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(o,c){c&&c.filter&&this._validate(s.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const m=this._getSourceCaches(o);let x=[];for(const C of m)x=x.concat(Ei(C,c));return x}addSourceType(o,c,m){return Ir.getSourceType(o)?m(new Error(`A source type called "${o}" already exists.`)):(Ir.setSourceType(o,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:c.workerSourceURL},m):m(null,null))}getLight(){return this.light.getLight()}setLight(o,c={}){this._checkLoaded();const m=this.light.getLight();let x=!1;for(const I in o)if(!Q(o[I],m[I])){x=!0;break}if(!x)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,c),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,c=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let m=o;if(1===c){if("object"==typeof m.source){const x="terrain-dem-src";this.addSource(x,m.source),m=s.clone$1(m),m=s.extend(m,{source:x})}if(this._validate(s.validateTerrain,"terrain",m))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode){if(!m)return;this._createTerrain(m,c)}else{const x=this.terrain,C=x.get();for(const I of Object.keys(s.spec.terrain))!m.hasOwnProperty(I)&&s.spec.terrain[I].default&&(m[I]=s.spec.terrain[I].default);for(const I in m)if(!Q(m[I],C[I])){x.set(m),this.stylesheet.terrain=m;const O=this._setTransitionParameters({duration:0});x.updateTransitions(O);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const c=this.fog=new Qt(o,this.map.transform);this.stylesheet.fog=o;const m=this._setTransitionParameters({duration:0});c.updateTransitions(m)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,m=c.get();0===Object.keys(o).length&&c.set(o);for(const x in o)if(!Q(o[x],m[x])){c.set(o),this.stylesheet.fog=o;const C=this._setTransitionParameters({duration:0});c.updateTransitions(C);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:s.exported.now(),transition:s.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter(m=>this.isLayerDraped(this._layers[m])),c=this._order.filter(m=>!this.isLayerDraped(this._layers[m]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...c)}_createTerrain(o,c){const m=this.terrain=new xe(o,c);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const x=this._setTransitionParameters({duration:0});m.updateTransitions(x)}_force3DLayerUpdate(){for(const o in this._layers){const c=this._layers[o];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const c=this._layers[o];"symbol"===c.type&&this._updateLayer(c)}}_validate(o,c,m,x,C={}){return(!C||!1!==C.validate)&&Ri(this,o.call(s.validateStyle,s.extend({key:c,style:this.serialize(),value:m,styleSpec:s.spec},x)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const c=this._getSourceCaches(o);for(const m of c)m.clearTiles()}_reloadSource(o){const c=this._getSourceCaches(o);for(const m of c)m.resume(),m.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const c in this._sourceCaches)this._sourceCaches[c].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const c=this._sourceCaches[o];c.resume(),c.reload()}}_updatePlacement(o,c,m,x,C=!1){let I=!1,O=!1;const N={};for(const H of this._order){const $=this._layers[H];if("symbol"!==$.type)continue;if(!N[$.source]){const Ie=this._getLayerSourceCache($);if(!Ie)continue;N[$.source]=Ie.getRenderableIds(!0).map($e=>Ie.getTileByID($e)).sort(($e,Qe)=>Qe.tileID.overscaledZ-$e.tileID.overscaledZ||($e.tileID.isLessThan(Qe.tileID)?-1:1))}const ce=this.crossTileSymbolIndex.addLayer($,N[$.source],o.center.lng,o.projection);I=I||ce}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||0===m,this._layerOrderChanged&&this.fire(new s.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.exported.now(),o.zoom))&&(this.pauseablePlacement=new is(o,this._order,C,c,m,x,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,N),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.exported.now()),O=!0),I&&this.pauseablePlacement.placement.setStale()),O||I)for(const H of this._order){const $=this._layers[H];"symbol"===$.type&&this.placement.updateLayerOpacities($,N[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,c,m){this.imageManager.getImages(c.icons,m),this._updateTilesForChangedImages();const x=C=>{C&&C.setDependencies(c.tileID.key,c.type,c.icons)};x(this._otherSourceCaches[c.source]),x(this._symbolSourceCaches[c.source])}getGlyphs(o,c,m){this.glyphManager.getGlyphs(c.stacks,m)}getResource(o,c,m){return s.makeRequest(c,m)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return"symbol"===o.type?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const c=[];return this._otherSourceCaches[o]&&c.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&c.push(this._symbolSourceCaches[o]),c}_isSourceCacheLoaded(o){const c=this._getSourceCaches(o);return 0===c.length?(this.fire(new s.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):c.every(m=>m.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Ir.getSourceType=function(p){return We[p]},Ir.setSourceType=function(p,o){We[p]=o},Ir.registerForPluginStateChange=s.registerForPluginStateChange;var Fr="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",Br="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",br="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",bs="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",rr="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ar={},Qr={};const ws=[];Sr(Fr,ws),Sr(br,ws),Sr(bs,ws),Sr(rr,ws),Ar=ao("",br),Qr=ao(rr,bs);const Qi=ao("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),ds=Fr,na="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Ss={background:ao("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:ao("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:ao("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:ao("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ao("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:ao("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ao("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ao("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ao("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:ao("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:ao("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:ao("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:ao("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:ao("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:ao("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:ao("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ao("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:ao("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:ao("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:ao("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:ao("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:ao("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:ao("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:ao("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:ao("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ao("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Br),skyboxGradient:ao("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",Br),skyboxCapture:ao("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ao("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:ao("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Sr(p,o){const c=p.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let m of c)if(m=m.trim(),"#"===m[0]&&m.includes("if")&&!m.includes("endif")){m=m.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const x=m.split(" ");for(const C of x)o.includes(C)||o.push(C)}}function ao(p,o){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,m=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),x={},C=[...ws];return Sr(p,C),Sr(o,C),{fragmentSource:p=p.replace(c,(I,O,N,H,$)=>(x[$]=!0,"define"===O?`\n#ifndef HAS_UNIFORM_u_${$}\nvarying ${N} ${H} ${$};\n#else\nuniform ${N} ${H} u_${$};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${$}\n    ${N} ${H} ${$} = u_${$};\n#endif\n`)),vertexSource:o=o.replace(c,(I,O,N,H,$)=>{const ce="float"===H?"vec2":"vec4",Ie=$.match(/color/)?"color":ce;return x[$]?"define"===O?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${N} ${ce} a_${$};\nvarying ${N} ${H} ${$};\n#else\nuniform ${N} ${H} u_${$};\n#endif\n`:"vec4"===Ie?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = a_${$};\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${$} = unpack_mix_${Ie}(a_${$}, u_${$}_t);\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`:"define"===O?`\n#ifndef HAS_UNIFORM_u_${$}\nuniform lowp float u_${$}_t;\nattribute ${N} ${ce} a_${$};\n#else\nuniform ${N} ${H} u_${$};\n#endif\n`:"vec4"===Ie?`\n#ifndef HAS_UNIFORM_u_${$}\n    ${N} ${H} ${$} = a_${$};\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${$}\n    ${N} ${H} ${$} = unpack_mix_${Ie}(a_${$}, u_${$}_t);\n#else\n    ${N} ${H} ${$} = u_${$};\n#endif\n`}),staticAttributes:m,usedDefines:C}}class ia{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,c,m,x,C,I,O){this.context=o;let N=this.boundPaintVertexBuffers.length!==x.length;for(let $=0;!N&&$<x.length;$++)this.boundPaintVertexBuffers[$]!==x[$]&&(N=!0);let H=this.boundDynamicVertexBuffers.length!==O.length;for(let $=0;!H&&$<O.length;$++)this.boundDynamicVertexBuffers[$]!==O[$]&&(H=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==m||N||H||this.boundIndexBuffer!==C||this.boundVertexOffset!==I)this.freshBind(c,m,x,C,I,O);else{o.bindVertexArrayOES.set(this.vao);for(const $ of O)$&&$.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(o,c,m,x,C,I){let O;const N=o.numAttributes,H=this.context,$=H.gl;if(H.extVertexArrayObject)this.vao&&this.destroy(),this.vao=H.extVertexArrayObject.createVertexArrayOES(),H.bindVertexArrayOES.set(this.vao),O=0,this.boundProgram=o,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=m,this.boundIndexBuffer=x,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=I;else{O=H.currentNumAttributes||0;for(let ce=N;ce<O;ce++)$.disableVertexAttribArray(ce)}c.enableAttributes($,o),c.bind(),c.setVertexAttribPointers($,o,C);for(const ce of m)ce.enableAttributes($,o),ce.bind(),ce.setVertexAttribPointers($,o,C);for(const ce of I)ce&&(ce.enableAttributes($,o),ce.bind(),ce.setVertexAttribPointers($,o,C));x&&x.bind(),H.currentNumAttributes=N}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ps(p,o){const c=Math.pow(2,o.canonical.z),m=o.canonical.y;return[new s.MercatorCoordinate(0,m/c).toLngLat().lat,new s.MercatorCoordinate(0,(m+1)/c).toLngLat().lat]}function wr(p,o,c,m,x,C,I){const O=p.context,N=O.gl,H=c.fbo;if(!H)return;p.prepareDrawTile();const $=p.useProgram("hillshade");O.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,H.colorAttachment.get());const ce=((Ye,ot,ue,He)=>{const pt=ue.paint.get("hillshade-shadow-color"),ht=ue.paint.get("hillshade-highlight-color"),Pt=ue.paint.get("hillshade-accent-color");let Lt=ue.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ue.paint.get("hillshade-illumination-anchor")&&(Lt-=Ye.transform.angle);const Ot=!Ye.options.moving;return{u_matrix:He||Ye.transform.calculateProjMatrix(ot.tileID.toUnwrapped(),Ot),u_image:0,u_latrange:Ps(0,ot.tileID),u_light:[ue.paint.get("hillshade-exaggeration"),Lt],u_shadow:pt,u_highlight:ht,u_accent:Pt}})(p,c,m,p.terrain?o.projMatrix:null);p.prepareDrawProgram(O,$,o.toUnwrapped());const{tileBoundsBuffer:Ie,tileBoundsIndexBuffer:$e,tileBoundsSegments:Qe}=p.getTileBoundsBuffers(c);$.draw(O,N.TRIANGLES,x,C,I,s.CullFaceMode.disabled,ce,m.id,Ie,$e,Qe)}function Wa(p,o,c){if(!o.needsDEMTextureUpload)return;const m=p.context,x=m.gl;m.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||p.getTileTexture(c.stride);const C=c.getPixels();o.demTexture?o.demTexture.update(C,{premultiply:!1}):o.demTexture=new s.Texture(m,C,x.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function Pr(p,o,c,m,x,C){const I=p.context,O=I.gl;if(!o.dem)return;const N=o.dem;if(I.activeTexture.set(O.TEXTURE1),Wa(p,o,N),!o.demTexture)return;o.demTexture.bind(O.NEAREST,O.CLAMP_TO_EDGE);const H=N.dim;I.activeTexture.set(O.TEXTURE0);let $=o.fbo;if(!$){const Qe=new s.Texture(I,{width:H,height:H,data:null},O.RGBA);Qe.bind(O.LINEAR,O.CLAMP_TO_EDGE),$=o.fbo=I.createFramebuffer(H,H,!0),$.colorAttachment.set(Qe.texture)}I.bindFramebuffer.set($.framebuffer),I.viewport.set([0,0,H,H]);const{tileBoundsBuffer:ce,tileBoundsIndexBuffer:Ie,tileBoundsSegments:$e}=p.getMercatorTileBoundsBuffers();p.useProgram("hillshadePrepare").draw(I,O.TRIANGLES,m,x,C,s.CullFaceMode.disabled,((Qe,Ye)=>{const ot=Ye.stride,ue=s.create();return s.ortho(ue,0,s.EXTENT,-s.EXTENT,0,0,1),s.translate(ue,ue,[0,-s.EXTENT,0]),{u_matrix:ue,u_image:1,u_dimension:[ot,ot],u_zoom:Qe.overscaledZ,u_unpack:Ye.unpackVector}})(o.tileID,N),c.id,ce,Ie,$e),o.needsHillshadePrepare=!1}const Nr=p=>({u_matrix:new s.UniformMatrix4f(p),u_image0:new s.Uniform1i(p),u_skirt_height:new s.Uniform1f(p)}),Gs=(p,o)=>({u_matrix:p,u_image0:0,u_skirt_height:o}),Ts=(p,o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe)=>({u_proj_matrix:Float32Array.from(p),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(m),u_merc_matrix:c,u_zoom_transition:x,u_merc_center:C,u_image0:0,u_frustum_tl:I,u_frustum_tr:O,u_frustum_br:N,u_frustum_bl:H,u_globe_pos:$,u_globe_radius:ce,u_viewport:Ie,u_grid_matrix:Qe?Float32Array.from(Qe):new Float32Array(9),u_skirt_height:$e});function Cs(p,o){return null!=p&&null!=o&&!(!p.hasData()||!o.hasData())&&null!=p.demTexture&&null!=o.demTexture&&p.tileID.key!==o.tileID.key}const pr=new class{constructor(){this.operations={}}newMorphing(p,o,c,m,x){if(p in this.operations){const C=this.operations[p];C.to.tileID.key!==c.tileID.key&&(C.queued=c)}else this.operations[p]={startTime:m,phase:0,duration:x,from:o,to:c,queued:null}}getMorphValuesForProxy(p){if(!(p in this.operations))return null;const o=this.operations[p];return{from:o.from,to:o.to,phase:o.phase}}update(p){for(const o in this.operations){const c=this.operations[o];for(c.phase=(p-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,p)){delete this.operations[o];break}}}_nextOp(p,o){return!!p.queued&&(p.from=p.to,p.to=p.queued,p.queued=null,p.phase=0,p.startTime=o,!0)}_validOp(p){return p.from.hasData()&&p.to.hasData()}},Tr={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ma(p){return 6*Math.pow(1.5,22-p)}function oa(p,o){const c=1<<p.z;return!o&&(0===p.x||p.x===c-1)||0===p.y||p.y===c-1}const S=p=>({u_matrix:p});function re(p,o,c,m,x){if(x>0){const C=s.exported.now(),I=(C-p.timeAdded)/x,O=o?(C-o.timeAdded)/x:-1,N=c.getSource(),H=m.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),$=!o||Math.abs(o.tileID.overscaledZ-H)>Math.abs(p.tileID.overscaledZ-H),ce=$&&p.refreshedUponExpiration?1:s.clamp($?I:1-O,0,1);return p.refreshedUponExpiration&&I>=1&&(p.refreshedUponExpiration=!1),o?{opacity:1,mix:1-ce}:{opacity:ce,mix:0}}return{opacity:1,mix:0}}class P extends s.SourceCache{constructor(o){const c={type:"raster-dem",maxzoom:o.transform.maxZoom},m=new dt(xt(),null),x=kt("mock-dem",c,m,o.style);super("mock-dem",x,!1),x.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,c){o.state="loaded",c(null)}}class ne extends s.SourceCache{constructor(o){const c=kt("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new dt(xt(),null),o.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,c,m){if(o.freezeTileCoverage)return;this.transform=o;const x=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((C,I)=>{if(C[I.key]="",!this._tiles[I.key]){const O=new s.Tile(I,this._source.tileSize*I.overscaleFactor(),o.tileZoom);O.state="loaded",this._tiles[I.key]=O}return C},{});for(const C in this._tiles)C in x||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(o){const c=this.proxyCachedFBO[o];if(void 0!==c){const m=Object.values(c);this.renderCachePool.push(...m),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Ge extends s.OverscaledTileID{constructor(o,c,m){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=c,this.projMatrix=m}}class Ln extends s.Elevation{constructor(o,c){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[m,x,C]=function(N){const H=new s.StructArrayLayout2i4,$=new s.StructArrayLayout3ui6;H.reserve(17161),$.reserve(33800);const Ie=s.EXTENT/128,$e=s.EXTENT+Ie/2,Qe=$e+Ie;for(let ot=-Ie;ot<Qe;ot+=Ie)for(let ue=-Ie;ue<Qe;ue+=Ie){const He=ue<0||ue>$e||ot<0||ot>$e?24575:0,pt=s.clamp(Math.round(ue),0,s.EXTENT),ht=s.clamp(Math.round(ot),0,s.EXTENT);H.emplaceBack(pt+He,ht)}const Ye=(ot,ue)=>{const He=131*ue+ot;$.emplaceBack(He+1,He,He+131),$.emplaceBack(He+131,He+131+1,He+1)};for(let ot=1;ot<129;ot++)for(let ue=1;ue<129;ue++)Ye(ue,ot);return[0,129].forEach(ot=>{for(let ue=0;ue<130;ue++)Ye(ue,ot),Ye(ot,ue)}),[H,$,32768]}(),I=o.context;this.gridBuffer=I.createVertexBuffer(m,s.posAttributes.members),this.gridIndexBuffer=I.createIndexBuffer(x),this.gridSegments=s.SegmentVector.simpleSegment(0,0,m.length,x.length),this.gridNoSkirtSegments=s.SegmentVector.simpleSegment(0,0,m.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ne(c.map),this.orthoMatrix=s.create(),s.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,s.EXTENT,0,s.EXTENT,0,1);const O=I.gl;this._overlapStencilMode=new s.StencilMode({func:O.GEQUAL,mask:255},0,255,O.KEEP,O.KEEP,O.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new P(c.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,c,m){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const x=o.terrain.properties;this.sourceCache=0===o.terrain.drapeRenderMode?this._mockSourceCache:o._getSourceCache(x.get("source")),this._exaggeration=x.get("exaggeration");const C=()=>{this.sourceCache.used&&s.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const I=this.getScaledDemTileSize();this.sourceCache.update(c,I,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),c.updateElevation(!0,m),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==o.efficiency&&s.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&"source"===o.dataType?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):"style"===o.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,m=this.painter.transform;this._initializing&&(this._initializing=0===m._centerAltitude&&-1===this.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(m.center),-1),this._emptyDEMTextureDirty=!this._initializing);const x=this.proxyCoords=c.getIds().map(N=>{const H=c.getTileByID(N).tileID;return H.projMatrix=m.calculateProjMatrix(H.toUnwrapped()),H});(function(N,H){const $=H.transform.pointCoordinate(H.transform.getCameraPoint()),ce=new s.Point($.x,$.y);N.sort((Ie,$e)=>{if($e.overscaledZ-Ie.overscaledZ)return $e.overscaledZ-Ie.overscaledZ;const Qe=new s.Point(Ie.canonical.x+(1<<Ie.canonical.z)*Ie.wrap,Ie.canonical.y),Ye=new s.Point($e.canonical.x+(1<<$e.canonical.z)*$e.wrap,$e.canonical.y),ot=ce.mult(1<<Ie.canonical.z);return ot.x-=.5,ot.y-=.5,ot.distSqr(Qe)-ot.distSqr(Ye)})})(x,this.painter),this._previousZoom=m.zoom;const C=this.proxyToSource||{};this.proxyToSource={},x.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const I=this._style._sourceCaches;for(const N in I){const H=I[N];if(!H.used||(H!==this.sourceCache&&this.resetTileLookupCache(H.id),this._setupProxiedCoordsForOrtho(H,o[N],C),H.usedForTerrain))continue;const $=o[N];H.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[c.id]=x.map(N=>new Ge(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(x),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=s.exported.now();const O={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const H=this.terrainTileForTile[N.key];if(!H)continue;const $=H.tileID.key;$ in O||(this._visibleDemTiles.push(H),O[$]=$)}}_assignTerrainTiles(o){this._initializing||o.forEach(c=>{if(this.terrainTileForTile[c.key])return;const m=this._findTileCoveringTileID(c,this.sourceCache);m&&(this.terrainTileForTile[c.key]=m)})}_prepareDEMTextures(){const o=this.painter.context,c=o.gl;for(const m in this.terrainTileForTile){const x=this.terrainTileForTile[m],C=x.dem;!C||x.demTexture&&!x.needsDEMTextureUpload||(o.activeTexture.set(c.TEXTURE1),Wa(this.painter,x,C))}}_prepareDemTileUniforms(o,c,m,x){if(!c||null==c.demTexture)return!1;const C=o.tileID.canonical,I=Math.pow(2,c.tileID.canonical.z-C.z),O=x||"";return m[`u_dem_tl${O}`]=[C.x*I%1,C.y*I%1],m[`u_dem_scale${O}`]=I,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,c=o.gl;if(!this._emptyDepthBufferTexture){const m=new s.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new s.Texture(o,m,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const c=this._visibleDemTiles.reduce((m,x)=>{if(!x.dem)return m;const C=x.dem.tree.minimums[0];return C>0&&o++,m+C},0);return o?c/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,c=o.gl;o.activeTexture.set(c.TEXTURE2);const m=this._getLoadedAreaMinimum(),x=new s.RGBAImage({width:1,height:1},new Uint8Array(s.DEMData.pack(m,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(x,{premultiply:!1}):C=this._emptyDEMTexture=new s.Texture(o,x,c.RGBA,{premultiply:!1}),C}setupElevationDraw(o,c,m){const x=this.painter.context,C=x.gl,I=(O=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:s.DEMData.getUnpackVector(O),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var O;I.u_dem_size=this.sourceCache.getSource().tileSize,I.u_exaggeration=this.exaggeration();let N=null,H=null,$=1;if(m&&m.morphing&&this._useVertexMorphing){const ce=m.morphing.srcDemTile,Ie=m.morphing.dstDemTile;$=m.morphing.phase,ce&&Ie&&(this._prepareDemTileUniforms(o,ce,I,"_prev")&&(H=ce),this._prepareDemTileUniforms(o,Ie,I)&&(N=Ie))}if(H&&N?(x.activeTexture.set(C.TEXTURE2),N.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),x.activeTexture.set(C.TEXTURE4),H.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),I.u_dem_lerp=$):(N=this.terrainTileForTile[o.tileID.key],x.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(o,N,I)?N.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),x.activeTexture.set(C.TEXTURE3),m&&m.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(I.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),I.u_depth_size_inv=[1,1]),m&&m.useMeterToDem&&N){const ce=(1<<N.tileID.canonical.z)*s.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;I.u_meter_to_dem=ce}if(m&&m.labelPlaneMatrixInv&&(I.u_label_plane_matrix_inv=m.labelPlaneMatrixInv),c.setTerrainUniformValues(x,I),"globe"===this.painter.transform.projection.name){const ce=this.globeUniformValues(this.painter.transform,o.tileID.canonical,m&&m.useDenormalizedUpVectorScale);c.setGlobeUniformValues(x,ce)}}globeUniformValues(o,c,m){const x=o.projection;return{u_tile_tl_up:x.upVector(c,0,0),u_tile_tr_up:x.upVector(c,s.EXTENT,0),u_tile_br_up:x.upVector(c,s.EXTENT,s.EXTENT),u_tile_bl_up:x.upVector(c,0,s.EXTENT),u_tile_up_scale:m?s.globeMetersToEcef(1):x.upVectorScale(c,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const c=this.painter,m=this.painter.context;0!==o.length&&(m.bindFramebuffer.set(null),m.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(x,C,I,O,N){if("globe"===x.transform.projection.name)!function(H,$,ce,Ie,$e){const Qe=H.context,Ye=Qe.gl;let ot,ue;const He=H.options.showTerrainWireframe?2:0,pt=H.transform,ht=s.globeUseCustomAntiAliasing(H,Qe,pt),Pt=($n,ln)=>{if(ue===$n)return;const Mn=[Tr[$n],"PROJECTION_GLOBE_VIEW"];ht&&Mn.push("CUSTOM_ANTIALIASING"),ln&&Mn.push(Tr[He]),ot=H.useProgram("globeRaster",null,Mn),ue=$n},Lt=H.colorModeForRenderPass(),Ot=new s.DepthMode(Ye.LEQUAL,s.DepthMode.ReadWrite,H.depthRangeFor3D);pr.update($e);const qt=s.calculateGlobeMercatorMatrix(pt),$t=[s.mercatorXfromLng(pt.center.lng),s.mercatorYfromLat(pt.center.lat)],an=He?[!1,!0]:[!1],Wn=H.globeSharedBuffers,nn=[pt.width*s.exported.devicePixelRatio,pt.height*s.exported.devicePixelRatio],An=Float32Array.from(pt.globeMatrix),pn={useDenormalizedUpVectorScale:!0};if(an.forEach($n=>{const ln=H.transform,Mn=Ma(ln.zoom)*$.exaggeration();ue=-1;const jn=$n?Ye.LINES:Ye.TRIANGLES;for(const Bn of Ie){const Yn=ce.getTile(Bn),Di=s.StencilMode.disabled,$i=$.prevTerrainTileForTile[Bn.key],vi=$.terrainTileForTile[Bn.key];Cs($i,vi)&&pr.newMorphing(Bn.key,$i,vi,$e,250),Qe.activeTexture.set(Ye.TEXTURE0),Yn.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE);const ki=pr.getMorphValuesForProxy(Bn.key),ho=ki?1:0;ki&&s.extend$1(pn,{morphing:{srcDemTile:ki.from,dstDemTile:ki.to,phase:s.easeCubicInOut(ki.phase)}});const fo=s.tileCornersToBounds(Bn.canonical),Ti=s.getLatitudinalLod(fo.getCenter().lat),Fo=s.getGridMatrix(Bn.canonical,fo,Ti,ln.worldSize/ln._pixelsPerMercatorPixel),Bo=s.globeNormalizeECEF(s.globeTileBounds(Bn.canonical)),No=Ts(ln.projMatrix,An,qt,Bo,s.globeToMercatorTransition(ln.zoom),$t,ln.frustumCorners.TL,ln.frustumCorners.TR,ln.frustumCorners.BR,ln.frustumCorners.BL,ln.globeCenterInViewSpace,ln.globeRadius,nn,Mn,Fo);if(Pt(ho,$n),$.setupElevationDraw(Yn,ot,pn),H.prepareDrawProgram(Qe,ot,Bn.toUnwrapped()),Wn){const[zo,gs,Yr]=$n?Wn.getWirefameBuffers(H.context,Ti):Wn.getGridBuffers(Ti,0!==Mn);ot.draw(Qe,jn,Ot,Di,Lt,s.CullFaceMode.backCCW,No,"globe_raster",zo,gs,Yr)}}}),Wn){const $n=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ht&&$n.push("CUSTOM_ANTIALIASING"),ot=H.useProgram("globeRaster",null,$n);for(const ln of Ie){const{x:Mn,y:jn,z:Bn}=ln.canonical,Yn=0===jn,Di=jn===(1<<Bn)-1,[$i,vi,ki,ho]=Wn.getPoleBuffers(Bn);if(ho&&(Yn||Di)){const fo=ce.getTile(ln);Qe.activeTexture.set(Ye.TEXTURE0),fo.texture.bind(Ye.LINEAR,Ye.CLAMP_TO_EDGE);let Ti=s.globePoleMatrixForTile(Bn,Mn,pt);const Fo=s.globeNormalizeECEF(s.globeTileBounds(ln.canonical)),Bo=(No,zo)=>No.draw(Qe,Ye.TRIANGLES,Ot,s.StencilMode.disabled,Lt,s.CullFaceMode.disabled,Ts(pt.projMatrix,Ti,Ti,Fo,0,$t,pt.frustumCorners.TL,pt.frustumCorners.TR,pt.frustumCorners.BR,pt.frustumCorners.BL,pt.globeCenterInViewSpace,pt.globeRadius,nn,0),"globe_pole_raster",zo,ki,ho);$.setupElevationDraw(fo,ot,pn),H.prepareDrawProgram(Qe,ot,ln.toUnwrapped()),Yn&&Bo(ot,$i),Di&&(Ti=s.scale(s.create(),Ti,[1,-1,1]),Bo(ot,vi))}}}}(x,C,I,O,N);else{const H=x.context,$=H.gl;let ce,Ie;const $e=x.options.showTerrainWireframe?2:0,Qe=(pt,ht)=>{if(Ie===pt)return;const Pt=[Tr[pt]];ht&&Pt.push(Tr[$e]),ce=x.useProgram("terrainRaster",null,Pt),Ie=pt},Ye=x.colorModeForRenderPass(),ot=new s.DepthMode($.LEQUAL,s.DepthMode.ReadWrite,x.depthRangeFor3D);pr.update(N);const ue=x.transform,He=Ma(ue.zoom)*C.exaggeration();($e?[!1,!0]:[!1]).forEach(pt=>{Ie=-1;const ht=pt?$.LINES:$.TRIANGLES,[Pt,Lt]=pt?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const Ot of O){const qt=I.getTile(Ot),$t=s.StencilMode.disabled,an=C.prevTerrainTileForTile[Ot.key],Wn=C.terrainTileForTile[Ot.key];Cs(an,Wn)&&pr.newMorphing(Ot.key,an,Wn,N,250),H.activeTexture.set($.TEXTURE0),qt.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST);const nn=pr.getMorphValuesForProxy(Ot.key),An=nn?1:0;let pn;nn&&(pn={morphing:{srcDemTile:nn.from,dstDemTile:nn.to,phase:s.easeCubicInOut(nn.phase)}});const $n=Gs(Ot.projMatrix,oa(Ot.canonical,ue.renderWorldCopies)?He/10:He);Qe(An,pt),C.setupElevationDraw(qt,ce,pn),x.prepareDrawProgram(H,ce,Ot.toUnwrapped()),ce.draw(H,ht,ot,$t,Ye,s.CullFaceMode.backCCW,$n,"terrain_raster",C.gridBuffer,Pt,Lt)}})}}(c,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(0===this._drapedRenderBatches.length)return o+1;this.renderingToTexture=!0;const c=this.painter,m=this.painter.context,x=this.proxySourceCache,C=this.proxiedCoords[x.id],I=this._drapedRenderBatches.shift(),O=[],N=c.style.order;let H=0;for(const $ of C){const ce=x.getTileByID($.proxyTileKey),Ie=x.proxyCachedFBO[$.key]?x.proxyCachedFBO[$.key][o]:void 0,$e=void 0!==Ie?x.renderCache[Ie]:this.pool[H++],Qe=void 0!==Ie;if(ce.texture=$e.tex,Qe&&!$e.dirty){O.push(ce.tileID);continue}let Ye;m.bindFramebuffer.set($e.fb.framebuffer),this.renderedToTile=!1,$e.dirty&&(m.clear({color:s.Color.transparent,stencil:0}),$e.dirty=!1);for(let ot=I.start;ot<=I.end;++ot){const ue=c.style._layers[N[ot]];if(ue.isHidden(c.transform.zoom))continue;const He=c.style._getLayerSourceCache(ue),pt=He?this.proxyToSource[$.key][He.id]:[$];if(!pt)continue;const ht=pt;m.viewport.set([0,0,$e.fb.width,$e.fb.height]),Ye!==(He?He.id:null)&&(this._setupStencil($e,pt,ue,He),Ye=He?He.id:null),c.renderLayer(c,He,ue,ht)}this.renderedToTile?($e.dirty=!0,O.push(ce.tileID)):Qe||--H,5===H&&(H=0,this.renderToBackBuffer(O))}return this.renderToBackBuffer(O),this.renderingToTexture=!1,m.bindFramebuffer.set(null),m.viewport.set([0,0,c.width,c.height]),I.end+1}postRender(){}renderCacheEfficiency(o){const c=o.order.length;if(0===c)return{efficiency:100};let m,x=0,C=0,I=!1;for(let O=0;O<c;++O){const N=o._layers[o.order[O]];this._style.isLayerDraped(N)?(I&&++x,++C):I||(I=!0,m=N.id)}return 0===C?{efficiency:100}:{efficiency:100*(1-x/C),firstUndrapedLayer:m}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{o=Math.min(o,c.dem.tree.minimums[0])}),0===o?o:(o-30)*this._exaggeration}raycast(o,c,m){if(!this._visibleDemTiles)return null;const x=this._visibleDemTiles.filter(C=>C.dem).map(C=>{const I=C.tileID,O=1<<I.overscaledZ,{x:N,y:H}=I.canonical,$=N/O,ce=(N+1)/O,Ie=H/O,$e=(H+1)/O;return{minx:$,miny:Ie,maxx:ce,maxy:$e,t:C.dem.tree.raycastRoot($,Ie,ce,$e,o,c,m),tile:C}});x.sort((C,I)=>(null!==C.t?C.t:Number.MAX_VALUE)-(null!==I.t?I.t:Number.MAX_VALUE));for(const C of x){if(null==C.t)return null;const I=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,o,c,m);if(null!=I)return I}return null}_createFBO(){const o=this.painter.context,c=o.gl,m=this.drapeBufferSize;o.activeTexture.set(c.TEXTURE0);const x=new s.Texture(o,{width:m[0],height:m[1],data:null},c.RGBA);x.bind(c.LINEAR,c.CLAMP_TO_EDGE);const C=o.createFramebuffer(m[0],m[1],!1);return C.colorAttachment.set(x.texture),C.depthAttachment=new St(o,C.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,m[0],m[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:C,tex:x,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const c=this._style._layers[o],m=c.isHidden(this.painter.transform.zoom);return"custom"===c.type?!m&&c.shouldRedrape():!m&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const m of this._style._getSources())if(m instanceof tt){o=!0;break}if(!o)return;const c={};for(let m=0;m<this._style.order.length;++m){const x=this._style._layers[this._style.order[m]],C=this._style._getLayerSourceCache(x);if(C&&!c[C.id]&&!x.isHidden(this.painter.transform.zoom)&&"line"===x.type&&x.widthExpression()instanceof s.ZoomDependentExpression){c[C.id]=!0;for(const I of this.proxyCoords){const O=this.proxyToSource[I.key][C.id];if(O)for(const N of O)this._clearRenderCacheForTile(C.id,N)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const m in this._style._sourceCaches)if(this._style._sourceCaches[m]._source instanceof Ve){o=!0;break}if(!o)return;const c={};for(let m=0;m<this._style.order.length;++m){const x=this._style._layers[this._style.order[m]],C=this._style._getLayerSourceCache(x);if(!C||c[C.id]||x.isHidden(this.painter.transform.zoom)||"raster"!==x.type)continue;const I=x.paint.get("raster-fade-duration");for(const O of this.proxyCoords){const N=this.proxyToSource[O.key][C.id];if(N)for(const H of N){const $=re(C.getTile(H),C.findLoadedParent(H,0),C,this.painter.transform,I);(1!==$.opacity||0!==$.mix)&&this._clearRenderCacheForTile(C.id,H)}}}}_setupDrapedRenderBatches(){const o=this._style.order,c=o.length;if(0===c)return;const m=[];let x,C=0,I=this._style._layers[o[C]];for(;!this._style.isLayerDraped(I)&&I.isHidden(this.painter.transform.zoom)&&++C<c;)I=this._style._layers[o[C]];for(;C<c;++C){const O=this._style._layers[o[C]];O.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(O)?void 0===x&&(x=C):void 0!==x&&(m.push({start:x,end:C-1}),x=void 0))}void 0!==x&&m.push({start:x,end:C-1}),this._drapedRenderBatches=m}_setupRenderCache(o){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const I=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let O=0;O<I.length;++O){const N=Object.values(I[O]);c.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const m=this.proxyCoords,x=this._tilesDirty;for(let I=m.length-1;I>=0;I--){const O=m[I];if(c.getTileByID(O.key),void 0!==c.proxyCachedFBO[O.key]){const N=o[O.key],H=this.proxyToSource[O.key];let $=0;for(const ce in H){const Ie=H[ce],$e=N[ce];if(!$e||$e.length!==Ie.length||Ie.some((Qe,Ye)=>Qe!==$e[Ye]||x[ce]&&x[ce].hasOwnProperty(Qe.key))){$=-1;break}++$}for(const ce in c.proxyCachedFBO[O.key])c.renderCache[c.proxyCachedFBO[O.key][ce]].dirty=$<0||$!==Object.values(N).length}}const C=[...this._drapedRenderBatches];C.sort((I,O)=>O.end-O.start-(I.end-I.start));for(const I of C)for(const O of m){if(c.proxyCachedFBO[O.key])continue;let N=c.renderCachePool.pop();void 0===N&&c.renderCache.length<50&&(N=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==N&&(c.proxyCachedFBO[O.key]={},c.proxyCachedFBO[O.key][I.start]=N,c.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(o,c,m,x){if(!x||!this._sourceTilesOverlap[x.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,I=C.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let O;if(m.isTileClipped())O=c.length,this._overlapStencilMode.test={func:I.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);O=1,this._overlapStencilMode.test={func:I.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+O>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=O,this._overlapStencilMode.ref=this._stencilRef,m.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):s.StencilMode.disabled}_renderTileClippingMasks(o,c){const m=this.painter,x=this.painter.context,C=x.gl;m._tileClippingMaskIDs={},x.setColorMode(s.ColorMode.disabled),x.setDepthMode(s.DepthMode.disabled);const I=m.useProgram("clippingMask");for(const O of o){const N=m._tileClippingMaskIDs[O.key]=--c;I.draw(x,C.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:C.ALWAYS,mask:0},N,255,C.KEEP,C.KEEP,C.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,S(O.projMatrix),"$clipping",m.tileExtentBuffer,m.quadTriangleIndexBuffer,m.tileExtentSegments)}}pointCoordinate(o){const c=this.painter.transform;if(o.x<0||o.x>c.width||o.y<0||o.y>c.height)return null;const m=[o.x,o.y,1,1];s.transformMat4$1(m,m,c.pixelMatrixInverse),s.scale$1(m,m,1/m[3]),m[0]/=c.worldSize,m[1]/=c.worldSize;const x=c._camera.position,C=s.mercatorZfromAltitude(1,c.center.lat),I=[x[0],x[1],x[2]/C,0],O=s.subtract([],m.slice(0,3),I);s.normalize(O,O);const N=this.raycast(I,O,this._exaggeration);return null!==N&&N?(s.scaleAndAdd(I,I,O,N),I[3]=I[2],I[2]*=C,I):null}drawDepth(){const o=this.painter,c=o.context,m=this.proxySourceCache,x=Math.ceil(o.width),C=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===x&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const I=c.gl,O=c.createFramebuffer(x,C,!0);c.activeTexture.set(I.TEXTURE0);const N=new s.Texture(c,{width:x,height:C,data:null},I.RGBA);N.bind(I.NEAREST,I.CLAMP_TO_EDGE),O.colorAttachment.set(N.texture);const H=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,x,C);O.depthAttachment.set(H),this._depthFBO=O,this._depthTexture=N}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,x,C]),function(I,O,N,H){if("globe"===I.transform.projection.name)return;const $=I.context,ce=$.gl;$.clear({depth:1});const Ie=I.useProgram("terrainDepth"),$e=new s.DepthMode(ce.LESS,s.DepthMode.ReadWrite,I.depthRangeFor3D);for(const Qe of H){const Ye=N.getTile(Qe),ot=Gs(Qe.projMatrix,0);O.setupElevationDraw(Ye,Ie),Ie.draw($,ce.TRIANGLES,$e,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.backCCW,ot,"terrain_depth",O.gridBuffer,O.gridIndexBuffer,O.gridNoSkirtSegments)}}(o,this,m,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,c,m){if(o.getSource()instanceof me)return this._setupProxiedCoordsForImageSource(o,c,m);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const x=this.proxiedCoords[o.id]=[],C=this.proxyCoords;for(let O=0;O<C.length;O++){const N=C[O],H=this._findTileCoveringTileID(N,o);if(H){const $=this._createProxiedId(N,H,m[N.key]&&m[N.key][o.id]);x.push($),this.proxyToSource[N.key][o.id]=[$]}}let I=!1;for(let O=0;O<c.length;O++){const N=o.getTile(c[O]);if(!N||!N.hasData())continue;const H=this._findTileCoveringTileID(N.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==N.tileID.canonical.z){const $=this.proxyToSource[H.tileID.key][o.id],ce=this._createProxiedId(H.tileID,N,m[H.tileID.key]&&m[H.tileID.key][o.id]);$?$.splice($.length-1,0,ce):this.proxyToSource[H.tileID.key][o.id]=[ce],x.push(ce),I=!0}}this._sourceTilesOverlap[o.id]=I}_setupProxiedCoordsForImageSource(o,c,m){if(!o.getSource().loaded())return;const x=this.proxiedCoords[o.id]=[],C=this.proxyCoords,I=o.getSource(),O=new s.Point(I.tileID.x,I.tileID.y)._div(1<<I.tileID.z),N=I.coordinates.map(s.MercatorCoordinate.fromLngLat).reduce(($,ce)=>($.min.x=Math.min($.min.x,ce.x-O.x),$.min.y=Math.min($.min.y,ce.y-O.y),$.max.x=Math.max($.max.x,ce.x-O.x),$.max.y=Math.max($.max.y,ce.y-O.y),$),{min:new s.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=($,ce)=>{const Ie=$.wrap+$.canonical.x/(1<<$.canonical.z),$e=$.canonical.y/(1<<$.canonical.z),Qe=s.EXTENT/(1<<$.canonical.z),Ye=ce.wrap+ce.canonical.x/(1<<ce.canonical.z),ot=ce.canonical.y/(1<<ce.canonical.z);return Ie+Qe<Ye+N.min.x||Ie>Ye+N.max.x||$e+Qe<ot+N.min.y||$e>ot+N.max.y};for(let $=0;$<C.length;$++){const ce=C[$];for(let Ie=0;Ie<c.length;Ie++){const $e=o.getTile(c[Ie]);if(!$e||!$e.hasData()||H(ce,$e.tileID))continue;const Qe=this._createProxiedId(ce,$e,m[ce.key]&&m[ce.key][o.id]),Ye=this.proxyToSource[ce.key][o.id];Ye?Ye.push(Qe):this.proxyToSource[ce.key][o.id]=[Qe],x.push(Qe)}}}_createProxiedId(o,c,m){let x=this.orthoMatrix;if(m){const C=m.find(I=>I.key===c.tileID.key);if(C)return C}if(c.tileID.key!==o.key){const C=o.canonical.z-c.tileID.canonical.z;let I,O,N;x=s.create();const H=c.tileID.wrap-o.wrap<<o.overscaledZ;C>0?(I=s.EXTENT>>C,O=I*((c.tileID.canonical.x<<C)-o.canonical.x+H),N=I*((c.tileID.canonical.y<<C)-o.canonical.y)):(I=s.EXTENT<<-C,O=s.EXTENT*(c.tileID.canonical.x-(o.canonical.x+H<<-C)),N=s.EXTENT*(c.tileID.canonical.y-(o.canonical.y<<-C))),s.ortho(x,0,I,0,I,0,1),s.translate(x,x,[O,N,0])}return new Ge(c.tileID,o.key,x)}_findTileCoveringTileID(o,c){let m=c.getTile(o);if(m&&m.hasData())return m;const x=this._findCoveringTileCache[c.id],C=x[o.key];if(m=C?c.getTileByID(C):null,m&&m.hasData()||null===C)return m;let I=m?m.tileID:o,O=I.overscaledZ;const N=c.getSource().minzoom,H=[];if(!C){const ce=c.getSource().maxzoom;if(o.canonical.z>=ce){const Ie=o.canonical.z-ce;c.getSource().reparseOverscaled?(O=Math.max(o.canonical.z+2,c.transform.tileZoom),I=new s.OverscaledTileID(O,o.wrap,ce,o.canonical.x>>Ie,o.canonical.y>>Ie)):0!==Ie&&(O=ce,I=new s.OverscaledTileID(O,o.wrap,ce,o.canonical.x>>Ie,o.canonical.y>>Ie))}I.key!==o.key&&(H.push(I.key),m=c.getTile(I))}const $=ce=>{H.forEach(Ie=>{x[Ie]=ce}),H.length=0};for(O-=1;O>=N&&(!m||!m.hasData());O--){m&&$(m.tileID.key);const ce=I.calculateScaledKey(O);if(m=c.getTileByID(ce),m&&m.hasData())break;const Ie=x[ce];if(null===Ie)break;void 0===Ie?H.push(ce):m=c.getTileByID(Ie)}return $(m?m.tileID.key:null),m&&m.hasData()?m:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,c){let m=this._tilesDirty[o];m||(m=this._tilesDirty[o]={}),m[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=function(c){let m=0;const x=new s.StructArrayLayout2ui4,C=131;for(let I=1;I<129;I++){for(let O=1;O<129;O++)m=I*C+O,x.emplaceBack(m,m+1),x.emplaceBack(m,m+C),x.emplaceBack(m+1,m+C),128===I&&x.emplaceBack(m+C,m+C+1);x.emplaceBack(m+1,m+1+C)}return x}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=s.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Xn{static cacheKey(o,c,m,x){let C=`${c}${x?x.cacheKey:""}`;for(const I of m)o.usedDefines.includes(I)&&(C+=`/${I}`);return C}constructor(o,c,m,x,C,I){const O=o.gl;this.program=O.createProgram();const N=function(ue){const He=[];for(let pt=0;pt<ue.length;pt++){if(null===ue[pt])continue;const ht=ue[pt].split(" ");He.push(ht.pop())}return He}(m.staticAttributes),H=x?x.getBinderAttributes():[],$=N.concat(H);let ce=x?x.defines():[];ce=ce.concat(I.map(ue=>`#define ${ue}`));const Ie=o.isWebGL2?"#version 300 es\n":"",$e=Ie+ce.concat(o.extStandardDerivatives&&0===Ie.length?"#extension GL_OES_standard_derivatives : enable\n".concat(na):na,na,ds,Qi.fragmentSource,Qr.fragmentSource,m.fragmentSource).join("\n"),Qe=Ie+ce.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",ds,Qi.vertexSource,Qr.vertexSource,Ar.vertexSource,m.vertexSource).join("\n"),Ye=O.createShader(O.FRAGMENT_SHADER);if(O.isContextLost())return void(this.failedToCreate=!0);O.shaderSource(Ye,$e),O.compileShader(Ye),O.attachShader(this.program,Ye);const ot=O.createShader(O.VERTEX_SHADER);if(O.isContextLost())this.failedToCreate=!0;else{O.shaderSource(ot,Qe),O.compileShader(ot),O.attachShader(this.program,ot),this.attributes={},this.numAttributes=$.length;for(let ue=0;ue<this.numAttributes;ue++)$[ue]&&(O.bindAttribLocation(this.program,ue,$[ue]),this.attributes[$[ue]]=ue);O.linkProgram(this.program),O.deleteShader(ot),O.deleteShader(Ye),this.fixedUniforms=C(o),this.binderUniforms=x?x.getUniforms(o):[],I.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new s.Uniform1i(ue=o),u_dem_prev:new s.Uniform1i(ue),u_dem_unpack:new s.Uniform4f(ue),u_dem_tl:new s.Uniform2f(ue),u_dem_scale:new s.Uniform1f(ue),u_dem_tl_prev:new s.Uniform2f(ue),u_dem_scale_prev:new s.Uniform1f(ue),u_dem_size:new s.Uniform1f(ue),u_dem_lerp:new s.Uniform1f(ue),u_exaggeration:new s.Uniform1f(ue),u_depth:new s.Uniform1i(ue),u_depth_size_inv:new s.Uniform2f(ue),u_meter_to_dem:new s.Uniform1f(ue),u_label_plane_matrix_inv:new s.UniformMatrix4f(ue)}),I.includes("GLOBE")&&(this.globeUniforms=(ue=>({u_tile_tl_up:new s.Uniform3f(ue),u_tile_tr_up:new s.Uniform3f(ue),u_tile_br_up:new s.Uniform3f(ue),u_tile_bl_up:new s.Uniform3f(ue),u_tile_up_scale:new s.Uniform1f(ue)}))(o)),I.includes("FOG")&&(this.fogUniforms=(ue=>({u_fog_matrix:new s.UniformMatrix4f(ue),u_fog_range:new s.Uniform2f(ue),u_fog_color:new s.Uniform4f(ue),u_fog_horizon_blend:new s.Uniform1f(ue),u_fog_temporal_offset:new s.Uniform1f(ue),u_frustum_tl:new s.Uniform3f(ue),u_frustum_tr:new s.Uniform3f(ue),u_frustum_br:new s.Uniform3f(ue),u_frustum_bl:new s.Uniform3f(ue),u_globe_pos:new s.Uniform3f(ue),u_globe_radius:new s.Uniform1f(ue),u_globe_transition:new s.Uniform1f(ue),u_is_globe:new s.Uniform1i(ue),u_viewport:new s.Uniform2f(ue)}))(o))}var ue}setTerrainUniformValues(o,c){if(!this.terrainUniforms)return;const m=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const x in c)m[x]&&m[x].set(this.program,x,c[x])}}setGlobeUniformValues(o,c){if(!this.globeUniforms)return;const m=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const x in c)m[x]&&m[x].set(this.program,x,c[x])}}setFogUniformValues(o,c){if(!this.fogUniforms)return;const m=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const x in c)m[x].set(this.program,x,c[x])}}draw(o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye){const ot=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(m),o.setStencilMode(x),o.setColorMode(C),o.setCullFace(I);for(const He of Object.keys(this.fixedUniforms))this.fixedUniforms[He].set(this.program,He,O[He]);Qe&&Qe.setUniforms(this.program,o,this.binderUniforms,Ie,{zoom:$e});const ue={[ot.LINES]:2,[ot.TRIANGLES]:3,[ot.LINE_STRIP]:1}[c];for(const He of ce.get()){const pt=He.vaos||(He.vaos={});(pt[N]||(pt[N]=new ia)).bind(o,this,H,Qe?Qe.getPaintVertexBuffers():[],$,He.vertexOffset,Ye||[]),ot.drawElements(c,He.primitiveLength*ue,ot.UNSIGNED_SHORT,He.primitiveOffset*ue*2)}}}function Zi(p,o){const c=Math.pow(2,o.tileID.overscaledZ),m=o.tileSize*Math.pow(2,p.transform.tileZoom)/c,x=m*(o.tileID.canonical.x+o.tileID.wrap*c),C=m*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/gt(o,1,p.transform.tileZoom),u_pixel_coord_upper:[x>>16,C>>16],u_pixel_coord_lower:[65535&x,65535&C]}}const ee=s.create(),J=(p,o,c,m,x,C,I,O,N,H,$)=>{const ce=o.style.light,Ie=ce.properties.get("position"),$e=[Ie.x,Ie.y,Ie.z],Qe=s.create$1();"viewport"===ce.properties.get("anchor")&&(s.fromRotation(Qe,-o.transform.angle),s.transformMat3($e,$e,Qe));const Ye=ce.properties.get("color"),ot=o.transform,ue={u_matrix:p,u_lightpos:$e,u_lightintensity:ce.properties.get("intensity"),u_lightcolor:[Ye.r,Ye.g,Ye.b],u_vertical_gradient:+c,u_opacity:m,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:ee,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:x,u_edge_radius:C};return"globe"===ot.projection.name&&(ue.u_tile_id=[I.canonical.x,I.canonical.y,1<<I.canonical.z],ue.u_zoom_transition=N,ue.u_inv_rot_matrix=$,ue.u_merc_center=H,ue.u_up_dir=ot.projection.upVector(new s.CanonicalTileID(0,0,0),H[0]*s.EXTENT,H[1]*s.EXTENT),ue.u_height_lift=O),ue},G=(p,o,c,m,x,C,I,O,N,H,$,ce)=>{const Ie=J(p,o,c,m,x,C,I,N,H,$,ce),$e={u_height_factor:-Math.pow(2,I.overscaledZ)/O.tileSize/8};return s.extend(Ie,Zi(o,O),$e)},Fe=p=>({u_matrix:p}),bn=(p,o,c)=>s.extend(Fe(p),Zi(o,c)),pi=(p,o)=>({u_matrix:p,u_world:o}),sr=(p,o,c,m)=>s.extend(bn(p,o,c),{u_world:m}),hs=s.create(),Ws=(p,o,c,m,x,C)=>{const I=p.transform,O="globe"===I.projection.name;let N;if("map"===C.paint.get("circle-pitch-alignment"))if(O){const $=s.globePixelsToTileUnits(I.zoom,o.canonical)*I._pixelsPerMercatorPixel;N=Float32Array.from([$,0,0,$])}else N=I.calculatePixelsToTileUnitsMatrix(c);else N=new Float32Array([I.pixelsToGLUnits[0],0,0,I.pixelsToGLUnits[1]]);const H={u_camera_to_center_distance:I.cameraToCenterDistance,u_matrix:p.translatePosMatrix(o.projMatrix,c,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:s.exported.devicePixelRatio,u_extrude_scale:N,u_inv_rot_matrix:hs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(O){H.u_inv_rot_matrix=m,H.u_merc_center=x,H.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],H.u_zoom_transition=s.globeToMercatorTransition(I.zoom);const $=x[0]*s.EXTENT,ce=x[1]*s.EXTENT;H.u_up_dir=I.projection.upVector(new s.CanonicalTileID(0,0,0),$,ce)}return H},qa=p=>{const o=[];return"map"===p.paint.get("circle-pitch-alignment")&&o.push("PITCH_WITH_MAP"),"map"===p.paint.get("circle-pitch-scale")&&o.push("SCALE_WITH_MAP"),o},kc=(p,o,c,m)=>{const x=s.EXTENT/c.tileSize;return{u_matrix:p,u_camera_to_center_distance:o.getCameraToCenterDistance(m),u_extrude_scale:[o.pixelsToGLUnits[0]/x,o.pixelsToGLUnits[1]/x]}},Fc=(p,o,c=1)=>({u_matrix:p,u_color:o,u_overlay:0,u_overlay_scale:c}),ua=s.create(),Ll=(p,o,c,m,x,C,I)=>{const O=p.transform,N="globe"===O.projection.name,H=N?s.globePixelsToTileUnits(O.zoom,o.canonical)*O._pixelsPerMercatorPixel:gt(c,1,C),$={u_matrix:o.projMatrix,u_extrude_scale:H,u_intensity:I,u_inv_rot_matrix:ua,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){$.u_inv_rot_matrix=m,$.u_merc_center=x,$.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],$.u_zoom_transition=s.globeToMercatorTransition(O.zoom);const ce=x[0]*s.EXTENT,Ie=x[1]*s.EXTENT;$.u_up_dir=O.projection.upVector(new s.CanonicalTileID(0,0,0),ce,Ie)}return $},rc=(p,o,c,m,x,C,I)=>{const O=p.transform,N=O.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:kl(p,o,c,m),u_pixels_to_tile_units:N,u_device_pixel_ratio:C,u_units_to_pixels:[1/O.pixelsToGLUnits[0],1/O.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:x,u_texsize:Ya(c)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:da(o,p.transform),u_alpha_discard_threshold:0,u_trim_offset:I}},Os=(p,o,c,m,x)=>{const C=p.transform;return{u_matrix:kl(p,o,c,m),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:x,u_image:0,u_tile_units_to_pixels:da(o,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function da(p,o){return 1/gt(p,1,o.tileZoom)}function kl(p,o,c,m){return p.translatePosMatrix(m||o.tileID.projMatrix,o,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Ya(p){const o=p.paint.get("line-dasharray").value;return o.value||"constant"!==o.kind}const Ja=(p,o,c,m,x,C)=>{return{u_matrix:p,u_tl_parent:o,u_scale_parent:c,u_fade_t:m.mix,u_opacity:m.opacity*x.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:x.paint.get("raster-brightness-min"),u_brightness_high:x.paint.get("raster-brightness-max"),u_saturation_factor:(O=x.paint.get("raster-saturation"),O>0?1-1/(1.001-O):-O),u_contrast_factor:(I=x.paint.get("raster-contrast"),I>0?1/(1-I):1+I),u_spin_weights:ps(x.paint.get("raster-hue-rotate")),u_perspective_transform:C};var I,O};function ps(p){p*=Math.PI/180;const o=Math.sin(p),c=Math.cos(p);return[(2*c+1)/3,(-Math.sqrt(3)*o-c+1)/3,(Math.sqrt(3)*o-c+1)/3]}const Fl=s.create(),Rs=(p,o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye)=>{const ot=x.transform,ue={u_is_size_zoom_constant:+("constant"===p||"source"===p),u_is_size_feature_constant:+("constant"===p||"camera"===p),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:ot.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:ot.width/ot.height,u_fade_change:x.options.fadeDuration?x.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:I,u_coord_matrix:O,u_is_text:+N,u_pitch_with_map:+m,u_texsize:H,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Fl,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Fl,u_up_vector:[0,-1,0]};return"globe"===Ye.name&&(ue.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],ue.u_zoom_transition=ce,ue.u_inv_rot_matrix=$e,ue.u_merc_center=Ie,ue.u_camera_forward=ot._camera.forward(),ue.u_ecef_origin=s.globeECEFOrigin(ot.globeMatrix,$.toUnwrapped()),ue.u_tile_matrix=Float32Array.from(ot.globeMatrix),ue.u_up_vector=Qe),ue},ha=(p,o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye,ot)=>s.extend(Rs(p,o,c,m,x,C,I,O,N,H,ce,Ie,$e,Qe,Ye,ot),{u_gamma_scale:m?x.transform.cameraToCenterDistance*Math.cos(x.terrain?0:x.transform._pitch):1,u_device_pixel_ratio:s.exported.devicePixelRatio,u_is_halo:+$}),Or=(p,o,c,m,x,C,I,O,N,H,$,ce,Ie,$e,Qe,Ye)=>s.extend(ha(p,o,c,m,x,C,I,O,!0,N,!0,$,ce,Ie,$e,Qe,Ye),{u_texsize_icon:H,u_texture_icon:1}),pl=(p,o,c)=>({u_matrix:p,u_opacity:o,u_color:c}),fd=(p,o,c,m,x)=>s.extend(function(C,I,O){const N=I.imageManager.getPattern(C.toString()),{width:H,height:$}=I.imageManager.getPixelSize(),ce=Math.pow(2,O.tileID.overscaledZ),Ie=O.tileSize*Math.pow(2,I.transform.tileZoom)/ce,$e=Ie*(O.tileID.canonical.x+O.tileID.wrap*ce),Qe=Ie*O.tileID.canonical.y;return{u_image:0,u_pattern_tl:N.tl,u_pattern_br:N.br,u_texsize:[H,$],u_pattern_size:N.displaySize,u_tile_units_to_pixels:1/gt(O,1,I.transform.tileZoom),u_pixel_coord_upper:[$e>>16,Qe>>16],u_pixel_coord_lower:[65535&$e,65535&Qe]}}(m,c,x),{u_matrix:p,u_opacity:o}),pa={fillExtrusion:p=>({u_matrix:new s.UniformMatrix4f(p),u_lightpos:new s.Uniform3f(p),u_lightintensity:new s.Uniform1f(p),u_lightcolor:new s.Uniform3f(p),u_vertical_gradient:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_edge_radius:new s.Uniform1f(p),u_ao:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_up_dir:new s.Uniform3f(p),u_height_lift:new s.Uniform1f(p)}),fillExtrusionPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_lightpos:new s.Uniform3f(p),u_lightintensity:new s.Uniform1f(p),u_lightcolor:new s.Uniform3f(p),u_vertical_gradient:new s.Uniform1f(p),u_height_factor:new s.Uniform1f(p),u_edge_radius:new s.Uniform1f(p),u_ao:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_up_dir:new s.Uniform3f(p),u_height_lift:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p)}),fill:p=>({u_matrix:new s.UniformMatrix4f(p)}),fillPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p)}),fillOutline:p=>({u_matrix:new s.UniformMatrix4f(p),u_world:new s.Uniform2f(p)}),fillOutlinePattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_world:new s.Uniform2f(p),u_image:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p)}),circle:p=>({u_camera_to_center_distance:new s.Uniform1f(p),u_extrude_scale:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_up_dir:new s.Uniform3f(p)}),collisionBox:p=>({u_matrix:new s.UniformMatrix4f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_extrude_scale:new s.Uniform2f(p)}),collisionCircle:p=>({u_matrix:new s.UniformMatrix4f(p),u_inv_matrix:new s.UniformMatrix4f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_viewport_size:new s.Uniform2f(p)}),debug:p=>({u_color:new s.UniformColor(p),u_matrix:new s.UniformMatrix4f(p),u_overlay:new s.Uniform1i(p),u_overlay_scale:new s.Uniform1f(p)}),clippingMask:p=>({u_matrix:new s.UniformMatrix4f(p)}),heatmap:p=>({u_extrude_scale:new s.Uniform1f(p),u_intensity:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_up_dir:new s.Uniform3f(p)}),heatmapTexture:p=>({u_image:new s.Uniform1i(p),u_color_ramp:new s.Uniform1i(p),u_opacity:new s.Uniform1f(p)}),hillshade:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_latrange:new s.Uniform2f(p),u_light:new s.Uniform2f(p),u_shadow:new s.UniformColor(p),u_highlight:new s.UniformColor(p),u_accent:new s.UniformColor(p)}),hillshadePrepare:p=>({u_matrix:new s.UniformMatrix4f(p),u_image:new s.Uniform1i(p),u_dimension:new s.Uniform2f(p),u_zoom:new s.Uniform1f(p),u_unpack:new s.Uniform4f(p)}),line:p=>({u_matrix:new s.UniformMatrix4f(p),u_pixels_to_tile_units:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_units_to_pixels:new s.Uniform2f(p),u_dash_image:new s.Uniform1i(p),u_gradient_image:new s.Uniform1i(p),u_image_height:new s.Uniform1f(p),u_texsize:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p),u_alpha_discard_threshold:new s.Uniform1f(p),u_trim_offset:new s.Uniform2f(p)}),linePattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_texsize:new s.Uniform2f(p),u_pixels_to_tile_units:new s.UniformMatrix2f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_units_to_pixels:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p),u_alpha_discard_threshold:new s.Uniform1f(p)}),raster:p=>({u_matrix:new s.UniformMatrix4f(p),u_tl_parent:new s.Uniform2f(p),u_scale_parent:new s.Uniform1f(p),u_fade_t:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_image0:new s.Uniform1i(p),u_image1:new s.Uniform1i(p),u_brightness_low:new s.Uniform1f(p),u_brightness_high:new s.Uniform1f(p),u_saturation_factor:new s.Uniform1f(p),u_contrast_factor:new s.Uniform1f(p),u_spin_weights:new s.Uniform3f(p),u_perspective_transform:new s.Uniform2f(p)}),symbolIcon:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_camera_forward:new s.Uniform3f(p),u_tile_matrix:new s.UniformMatrix4f(p),u_up_vector:new s.Uniform3f(p),u_ecef_origin:new s.Uniform3f(p),u_texture:new s.Uniform1i(p)}),symbolSDF:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_texture:new s.Uniform1i(p),u_gamma_scale:new s.Uniform1f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_tile_id:new s.Uniform3f(p),u_zoom_transition:new s.Uniform1f(p),u_inv_rot_matrix:new s.UniformMatrix4f(p),u_merc_center:new s.Uniform2f(p),u_camera_forward:new s.Uniform3f(p),u_tile_matrix:new s.UniformMatrix4f(p),u_up_vector:new s.Uniform3f(p),u_ecef_origin:new s.Uniform3f(p),u_is_halo:new s.Uniform1i(p)}),symbolTextAndIcon:p=>({u_is_size_zoom_constant:new s.Uniform1i(p),u_is_size_feature_constant:new s.Uniform1i(p),u_size_t:new s.Uniform1f(p),u_size:new s.Uniform1f(p),u_camera_to_center_distance:new s.Uniform1f(p),u_rotate_symbol:new s.Uniform1i(p),u_aspect_ratio:new s.Uniform1f(p),u_fade_change:new s.Uniform1f(p),u_matrix:new s.UniformMatrix4f(p),u_label_plane_matrix:new s.UniformMatrix4f(p),u_coord_matrix:new s.UniformMatrix4f(p),u_is_text:new s.Uniform1i(p),u_pitch_with_map:new s.Uniform1i(p),u_texsize:new s.Uniform2f(p),u_texsize_icon:new s.Uniform2f(p),u_texture:new s.Uniform1i(p),u_texture_icon:new s.Uniform1i(p),u_gamma_scale:new s.Uniform1f(p),u_device_pixel_ratio:new s.Uniform1f(p),u_is_halo:new s.Uniform1i(p)}),background:p=>({u_matrix:new s.UniformMatrix4f(p),u_opacity:new s.Uniform1f(p),u_color:new s.UniformColor(p)}),backgroundPattern:p=>({u_matrix:new s.UniformMatrix4f(p),u_opacity:new s.Uniform1f(p),u_image:new s.Uniform1i(p),u_pattern_tl:new s.Uniform2f(p),u_pattern_br:new s.Uniform2f(p),u_texsize:new s.Uniform2f(p),u_pattern_size:new s.Uniform2f(p),u_pixel_coord_upper:new s.Uniform2f(p),u_pixel_coord_lower:new s.Uniform2f(p),u_tile_units_to_pixels:new s.Uniform1f(p)}),terrainRaster:Nr,terrainDepth:Nr,skybox:p=>({u_matrix:new s.UniformMatrix4f(p),u_sun_direction:new s.Uniform3f(p),u_cubemap:new s.Uniform1i(p),u_opacity:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p)}),skyboxGradient:p=>({u_matrix:new s.UniformMatrix4f(p),u_color_ramp:new s.Uniform1i(p),u_center_direction:new s.Uniform3f(p),u_radius:new s.Uniform1f(p),u_opacity:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p)}),skyboxCapture:p=>({u_matrix_3f:new s.UniformMatrix3f(p),u_sun_direction:new s.Uniform3f(p),u_sun_intensity:new s.Uniform1f(p),u_color_tint_r:new s.Uniform4f(p),u_color_tint_m:new s.Uniform4f(p),u_luminance:new s.Uniform1f(p)}),globeRaster:p=>({u_proj_matrix:new s.UniformMatrix4f(p),u_globe_matrix:new s.UniformMatrix4f(p),u_normalize_matrix:new s.UniformMatrix4f(p),u_merc_matrix:new s.UniformMatrix4f(p),u_zoom_transition:new s.Uniform1f(p),u_merc_center:new s.Uniform2f(p),u_image0:new s.Uniform1i(p),u_grid_matrix:new s.UniformMatrix3f(p),u_skirt_height:new s.Uniform1f(p),u_frustum_tl:new s.Uniform3f(p),u_frustum_tr:new s.Uniform3f(p),u_frustum_br:new s.Uniform3f(p),u_frustum_bl:new s.Uniform3f(p),u_globe_pos:new s.Uniform3f(p),u_globe_radius:new s.Uniform1f(p),u_viewport:new s.Uniform2f(p)}),globeAtmosphere:p=>({u_frustum_tl:new s.Uniform3f(p),u_frustum_tr:new s.Uniform3f(p),u_frustum_br:new s.Uniform3f(p),u_frustum_bl:new s.Uniform3f(p),u_horizon:new s.Uniform1f(p),u_transition:new s.Uniform1f(p),u_fadeout_range:new s.Uniform1f(p),u_color:new s.Uniform4f(p),u_high_color:new s.Uniform4f(p),u_space_color:new s.Uniform4f(p),u_star_intensity:new s.Uniform1f(p),u_star_density:new s.Uniform1f(p),u_star_size:new s.Uniform1f(p),u_temporal_offset:new s.Uniform1f(p),u_horizon_angle:new s.Uniform1f(p),u_rotation_matrix:new s.UniformMatrix4f(p)})};let fa;function Es(p,o,c,m,x,C,I){const O=p.context,N=O.gl,H=p.transform,$=p.useProgram("collisionBox"),ce=[];let Ie=0,$e=0;for(let ht=0;ht<m.length;ht++){const Pt=m[ht],Lt=o.getTile(Pt),Ot=Lt.getBucket(c);if(!Ot)continue;const qt=Tn(Pt,Ot,H);let $t=qt;0===x[0]&&0===x[1]||($t=p.translatePosMatrix(qt,Lt,x,C));const an=I?Ot.textCollisionBox:Ot.iconCollisionBox,Wn=Ot.collisionCircleArray;if(Wn.length>0){const nn=s.create(),An=$t;s.mul(nn,Ot.placementInvProjMatrix,H.glCoordMatrix),s.mul(nn,nn,Ot.placementViewportMatrix),ce.push({circleArray:Wn,circleOffset:$e,transform:An,invTransform:nn,projection:Ot.getProjection()}),Ie+=Wn.length/4,$e=Ie}an&&(p.terrain&&p.terrain.setupElevationDraw(Lt,$),$.draw(O,N.LINES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,kc($t,H,Lt,Ot.getProjection()),c.id,an.layoutVertexBuffer,an.indexBuffer,an.segments,null,H.zoom,null,[an.collisionVertexBuffer,an.collisionVertexBufferExt]))}if(!I||!ce.length)return;const Qe=p.useProgram("collisionCircle"),Ye=new s.StructArrayLayout2f1f2i16;Ye.resize(4*Ie),Ye._trim();let ot=0;for(const ht of ce)for(let Pt=0;Pt<ht.circleArray.length/4;Pt++){const Lt=4*Pt,Ot=ht.circleArray[Lt+0],qt=ht.circleArray[Lt+1],$t=ht.circleArray[Lt+2],an=ht.circleArray[Lt+3];Ye.emplace(ot++,Ot,qt,$t,an,0),Ye.emplace(ot++,Ot,qt,$t,an,1),Ye.emplace(ot++,Ot,qt,$t,an,2),Ye.emplace(ot++,Ot,qt,$t,an,3)}(!fa||fa.length<2*Ie)&&(fa=function(ht){const Pt=2*ht,Lt=new s.StructArrayLayout3ui6;Lt.resize(Pt),Lt._trim();for(let Ot=0;Ot<Pt;Ot++){const qt=6*Ot;Lt.uint16[qt+0]=4*Ot+0,Lt.uint16[qt+1]=4*Ot+1,Lt.uint16[qt+2]=4*Ot+2,Lt.uint16[qt+3]=4*Ot+2,Lt.uint16[qt+4]=4*Ot+3,Lt.uint16[qt+5]=4*Ot+0}return Lt}(Ie));const ue=O.createIndexBuffer(fa,!0),He=O.createVertexBuffer(Ye,s.collisionCircleLayout.members,!0);for(const ht of ce){const Pt={u_matrix:ht.transform,u_inv_matrix:ht.invTransform,u_camera_to_center_distance:(pt=H).getCameraToCenterDistance(ht.projection),u_viewport_size:[pt.width,pt.height]};Qe.draw(O,N.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,p.colorModeForRenderPass(),s.CullFaceMode.disabled,Pt,c.id,He,ue,s.SegmentVector.simpleSegment(0,2*ht.circleOffset,ht.circleArray.length,ht.circleArray.length/2),null,H.zoom)}var pt;He.destroy(),ue.destroy()}const sc=s.create();function Bc({width:p,height:o,anchor:c,textOffset:m,textScale:x},C){const{horizontalAlign:I,verticalAlign:O}=s.getAnchorAlignment(c),N=-(I-.5)*p,H=-(O-.5)*o,$=s.evaluateVariableOffset(c,m);return new s.Point((N/x+$[0])*C,(H/x+$[1])*C)}function Nc(p,o,c,m,x,C,I,O,N,H,$){const ce=p.text.placedSymbolArray,Ie=p.text.dynamicLayoutVertexArray,$e=p.icon.dynamicLayoutVertexArray,Qe={},Ye=p.getProjection(),ot=xn(O,Ye,C),ue=C.elevation,He=Ye.upVectorScale(O.canonical,C.center.lat,C.worldSize).metersToTile;Ie.clear();for(let pt=0;pt<ce.length;pt++){const ht=ce.get(pt),{tileAnchorX:Pt,tileAnchorY:Lt,numGlyphs:Ot}=ht,qt=ht.hidden||!ht.crossTileID||p.allowVerticalPlacement&&!ht.placedOrientation?null:m[ht.crossTileID];if(qt){let $t=0,an=0,Wn=0;if(ue){const Yn=ue?ue.getAtTileOffset(O,Pt,Lt):0,[Di,$i,vi]=Ye.upVector(O.canonical,Pt,Lt);$t=Yn*Di*He,an=Yn*$i*He,Wn=Yn*vi*He}let[nn,An,pn,$n]=Ji(ht.projectedAnchorX+$t,ht.projectedAnchorY+an,ht.projectedAnchorZ+Wn,c?ot:I);const ln=gr(C.getCameraToCenterDistance(Ye),$n);let Mn=x.evaluateSizeForFeature(p.textSizeData,H,ht)*ln/s.ONE_EM;c&&(Mn*=p.tilePixelRatio/N);const jn=Bc(qt,Mn);c?(({x:nn,y:An,z:pn}=Ye.projectTilePoint(Pt+jn.x,Lt+jn.y,O.canonical)),[nn,An,pn]=Ji(nn+$t,An+an,pn+Wn,I)):(o&&jn._rotate(-C.angle),nn+=jn.x,An+=jn.y,pn=0);const Bn=p.allowVerticalPlacement&&ht.placedOrientation===s.WritingMode.vertical?Math.PI/2:0;for(let Yn=0;Yn<Ot;Yn++)s.addDynamicAttributes(Ie,nn,An,pn,Bn);$&&ht.associatedIconIndex>=0&&(Qe[ht.associatedIconIndex]={x:nn,y:An,z:pn,angle:Bn})}else ke(Ot,Ie)}if($){$e.clear();const pt=p.icon.placedSymbolArray;for(let ht=0;ht<pt.length;ht++){const Pt=pt.get(ht),{numGlyphs:Lt}=Pt,Ot=Qe[ht];if(Pt.hidden||!Ot)ke(Lt,$e);else{const{x:qt,y:$t,z:an,angle:Wn}=Ot;for(let nn=0;nn<Lt;nn++)s.addDynamicAttributes($e,qt,$t,an,Wn)}}p.icon.dynamicLayoutVertexBuffer.updateData($e)}p.text.dynamicLayoutVertexBuffer.updateData(Ie)}function fl(p,o,c){return c.iconsInText&&o?"symbolTextAndIcon":p?"symbolSDF":"symbolIcon"}function Bl(p,o,c,m,x,C,I,O,N,H,$,ce){const Ie=p.context,$e=Ie.gl,Qe=p.transform,Ye="map"===O,ot="map"===N,ue=Ye&&"point"!==c.layout.get("symbol-placement"),He=Ye&&!ot&&!ue,pt=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let ht=!1;const Pt=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),Lt=[s.mercatorXfromLng(Qe.center.lng),s.mercatorYfromLat(Qe.center.lat)],Ot=c.layout.get("text-variable-anchor"),qt="globe"===Qe.projection.name,$t=[],an=[0,-1,0];let Wn=an;!qt&&!Qe.mercatorFromTransition||Ye||(Wn=function(nn){const An=nn._camera.getWorldToCamera(nn.worldSize,1),pn=s.multiply([],An,nn.globeMatrix);s.invert(pn,pn);const $n=[0,0,0],ln=[0,1,0,0];return s.transformMat4$1(ln,ln,pn),$n[0]=ln[0],$n[1]=ln[1],$n[2]=ln[2],s.normalize($n,$n),$n}(Qe));for(const nn of m){const An=o.getTile(nn),pn=An.getBucket(c);if(!pn||"mercator"===pn.projection.name&&qt)continue;const $n=x?pn.text:pn.icon;if(!$n||pn.fullyClipped||!$n.segments.get().length)continue;const ln=$n.programConfigurations.get(c.id),Mn=x||pn.sdfIcons,jn=x?pn.textSizeData:pn.iconSizeData,Bn=ot||0!==Qe.pitch,Yn=s.evaluateSizeForZoom(jn,Qe.zoom);let Di,$i,vi,ki,ho=[0,0],fo=null;if(x)$i=An.glyphAtlasTexture,vi=$e.LINEAR,Di=An.glyphAtlasTexture.size,pn.iconsInText&&(ho=An.imageAtlasTexture.size,fo=An.imageAtlasTexture,ki=Bn||p.options.rotating||p.options.zooming||"composite"===jn.kind||"camera"===jn.kind?$e.LINEAR:$e.NEAREST);else{const mr=1!==c.layout.get("icon-size").constantOr(0)||pn.iconsNeedLinear;$i=An.imageAtlasTexture,vi=Mn||p.options.rotating||p.options.zooming||mr||Bn?$e.LINEAR:$e.NEAREST,Di=An.imageAtlasTexture.size}const Ti="globe"===pn.projection.name,Fo=Ti?Wn:an,Bo=Ti?s.globeToMercatorTransition(Qe.zoom):0,No=xn(nn,pn.getProjection(),Qe),zo=Qe.calculatePixelsToTileUnitsMatrix(An),gs=en(No,An.tileID.canonical,ot,Ye,Qe,pn.getProjection(),zo),Yr=p.terrain&&ot&&ue?s.invert(s.create(),gs):sc,_s=vo(No,An.tileID.canonical,ot,Ye,Qe,pn.getProjection(),zo),Qa=Ot&&pn.hasTextData(),yr="none"!==c.layout.get("icon-text-fit")&&Qa&&pn.hasIconData();if(ue){const mr=Qe.elevation,bl=mr?mr.getAtTileOffsetFunc(nn,Qe.center.lat,Qe.worldSize,pn.getProjection()):null,Sa=Qo(No,An.tileID.canonical,ot,Ye,Qe,pn.getProjection(),zo);Zr(pn,No,p,x,Sa,_s,ot,H,bl,nn)}const ar=ue||x&&Ot||yr,Uo=p.translatePosMatrix(No,An,C,I),Jr=ar?sc:gs,Ys=p.translatePosMatrix(_s,An,C,I,!0),vr=pn.getProjection().createInversionMatrix(Qe,nn.canonical),la=[];p.terrainRenderModeElevated()&&ot&&la.push("PITCH_WITH_MAP_TERRAIN"),Ti&&la.push("PROJECTION_GLOBE_VIEW"),ar&&la.push("PROJECTED_POS_ON_VIEWPORT");const xl=Mn&&0!==c.paint.get(x?"text-halo-width":"icon-halo-width").constantOr(1);let gc;gc=Mn?pn.iconsInText?Or(jn.kind,Yn,He,ot,p,Uo,Jr,Ys,Di,ho,nn,Bo,Lt,vr,Fo,pn.getProjection()):ha(jn.kind,Yn,He,ot,p,Uo,Jr,Ys,x,Di,!0,nn,Bo,Lt,vr,Fo,pn.getProjection()):Rs(jn.kind,Yn,He,ot,p,Uo,Jr,Ys,x,Di,nn,Bo,Lt,vr,Fo,pn.getProjection());const bu={program:p.useProgram(fl(Mn,x,pn),ln,la),buffers:$n,uniformValues:gc,atlasTexture:$i,atlasTextureIcon:fo,atlasInterpolation:vi,atlasInterpolationIcon:ki,isSDF:Mn,hasHalo:xl,tile:An,labelPlaneMatrixInv:Yr};if(pt&&pn.canOverlap){ht=!0;const mr=$n.segments.get();for(const bl of mr)$t.push({segments:new s.SegmentVector([bl]),sortKey:bl.sortKey,state:bu})}else $t.push({segments:$n.segments,sortKey:0,state:bu})}ht&&$t.sort((nn,An)=>nn.sortKey-An.sortKey);for(const nn of $t){const An=nn.state;if(p.terrain&&p.terrain.setupElevationDraw(An.tile,An.program,{useDepthForOcclusion:!qt,labelPlaneMatrixInv:An.labelPlaneMatrixInv}),Ie.activeTexture.set($e.TEXTURE0),An.atlasTexture.bind(An.atlasInterpolation,$e.CLAMP_TO_EDGE),An.atlasTextureIcon&&(Ie.activeTexture.set($e.TEXTURE1),An.atlasTextureIcon&&An.atlasTextureIcon.bind(An.atlasInterpolationIcon,$e.CLAMP_TO_EDGE)),An.isSDF){const pn=An.uniformValues;An.hasHalo&&(pn.u_is_halo=1,Ia(An.buffers,nn.segments,c,p,An.program,Pt,$,ce,pn)),pn.u_is_halo=0}Ia(An.buffers,nn.segments,c,p,An.program,Pt,$,ce,An.uniformValues)}}function Ia(p,o,c,m,x,C,I,O,N){const H=m.context,$=[p.dynamicLayoutVertexBuffer,p.opacityVertexBuffer,p.globeExtVertexBuffer];x.draw(H,H.gl.TRIANGLES,C,I,O,s.CullFaceMode.disabled,N,c.id,p.layoutVertexBuffer,p.indexBuffer,o,c.paint,m.transform.zoom,p.programConfigurations.get(c.id),$)}function Nl(p,o,c,m,x,C,I){const O=p.context.gl,N=c.paint.get("fill-pattern"),H=N&&N.constantOr(1);let $,ce,Ie,$e,Qe;I?(ce=H&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=O.LINES):(ce=H?"fillPattern":"fill",$=O.TRIANGLES);for(const Ye of m){const ot=o.getTile(Ye);if(H&&!ot.patternsLoaded())continue;const ue=ot.getBucket(c);if(!ue)continue;p.prepareDrawTile();const He=ue.programConfigurations.get(c.id),pt=p.useProgram(ce,He);H&&(p.context.activeTexture.set(O.TEXTURE0),ot.imageAtlasTexture.bind(O.LINEAR,O.CLAMP_TO_EDGE),He.updatePaintBuffers());const ht=N.constantOr(null);if(ht&&ot.imageAtlas){const Lt=ot.imageAtlas.patternPositions[ht.toString()];Lt&&He.setConstantPatternPositions(Lt)}const Pt=p.translatePosMatrix(Ye.projMatrix,ot,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(I){$e=ue.indexBuffer2,Qe=ue.segments2;const Lt=p.terrain&&p.terrain.renderingToTexture?p.terrain.drapeBufferSize:[O.drawingBufferWidth,O.drawingBufferHeight];Ie="fillOutlinePattern"===ce&&H?sr(Pt,p,ot,Lt):pi(Pt,Lt)}else $e=ue.indexBuffer,Qe=ue.segments,Ie=H?bn(Pt,p,ot):Fe(Pt);p.prepareDrawProgram(p.context,pt,Ye.toUnwrapped()),pt.draw(p.context,$,x,p.stencilModeForClipping(Ye),C,s.CullFaceMode.disabled,Ie,c.id,ue.layoutVertexBuffer,$e,Qe,c.paint,p.transform.zoom,He)}}function ml(p,o,c,m,x,C,I){const O=p.context,N=O.gl,H=p.transform,$=c.paint.get("fill-extrusion-pattern"),ce=$.constantOr(1),Ie=c.paint.get("fill-extrusion-opacity"),$e=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],Qe=c.layout.get("fill-extrusion-edge-radius"),Ye=Qe>0&&!c.paint.get("fill-extrusion-rounded-roof"),ot=Ye?0:Qe,ue="globe"===H.projection.name?s.fillExtrusionHeightLift():0,He="globe"===H.projection.name,pt=He?s.globeToMercatorTransition(H.zoom):0,ht=[s.mercatorXfromLng(H.center.lng),s.mercatorYfromLat(H.center.lat)],Pt=[];He&&Pt.push("PROJECTION_GLOBE_VIEW"),$e[0]>0&&Pt.push("FAUX_AO"),Ye&&Pt.push("ZERO_ROOF_RADIUS");for(const Lt of m){const Ot=o.getTile(Lt),qt=Ot.getBucket(c);if(!qt||qt.projection.name!==H.projection.name)continue;const $t=qt.programConfigurations.get(c.id),an=p.useProgram(ce?"fillExtrusionPattern":"fillExtrusion",$t,Pt);if(p.terrain){const Mn=p.terrain;if(p.style.terrainSetForDrapingOnly())Mn.setupElevationDraw(Ot,an,{useMeterToDem:!0});else{if(!qt.enableTerrain)continue;if(Mn.setupElevationDraw(Ot,an,{useMeterToDem:!0}),fu(O,o,Lt,qt,c,Mn),!qt.centroidVertexBuffer){const jn=an.attributes.a_centroid_pos;void 0!==jn&&N.vertexAttrib2f(jn,0,0)}}}ce&&(p.context.activeTexture.set(N.TEXTURE0),Ot.imageAtlasTexture.bind(N.LINEAR,N.CLAMP_TO_EDGE),$t.updatePaintBuffers());const Wn=$.constantOr(null);if(Wn&&Ot.imageAtlas){const Mn=Ot.imageAtlas.patternPositions[Wn.toString()];Mn&&$t.setConstantPatternPositions(Mn)}const nn=p.translatePosMatrix(Lt.projMatrix,Ot,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),An=H.projection.createInversionMatrix(H,Lt.canonical),pn=c.paint.get("fill-extrusion-vertical-gradient"),$n=ce?G(nn,p,pn,Ie,$e,ot,Lt,Ot,ue,pt,ht,An):J(nn,p,pn,Ie,$e,ot,Lt,ue,pt,ht,An);p.prepareDrawProgram(O,an,Lt.toUnwrapped());const ln=[];p.terrain&&ln.push(qt.centroidVertexBuffer),He&&ln.push(qt.layoutVertexExtBuffer),an.draw(O,O.gl.TRIANGLES,x,C,I,s.CullFaceMode.backCCW,$n,c.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,c.paint,p.transform.zoom,$t,ln)}}function fu(p,o,c,m,x,C){const I=[ue=>{let He=ue.canonical.x-1,pt=ue.wrap;return He<0&&(He=(1<<ue.canonical.z)-1,pt--),new s.OverscaledTileID(ue.overscaledZ,pt,ue.canonical.z,He,ue.canonical.y)},ue=>{let He=ue.canonical.x+1,pt=ue.wrap;return He===1<<ue.canonical.z&&(He=0,pt++),new s.OverscaledTileID(ue.overscaledZ,pt,ue.canonical.z,He,ue.canonical.y)},ue=>new s.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,(0===ue.canonical.y?1<<ue.canonical.z:ue.canonical.y)-1),ue=>new s.OverscaledTileID(ue.overscaledZ,ue.wrap,ue.canonical.z,ue.canonical.x,ue.canonical.y===(1<<ue.canonical.z)-1?0:ue.canonical.y+1)],O=ue=>{const He=o.getSource().minzoom,pt=Pt=>{const Lt=o.getTileByID(Pt);if(Lt&&Lt.hasData())return Lt.getBucket(x)},ht=[0,-1,1];for(const Pt of ht){if(ue.overscaledZ+Pt<He)continue;const Lt=pt(ue.calculateScaledKey(ue.overscaledZ+Pt));if(Lt)return Lt}},N=[0,0,0],H=(ue,He)=>(N[0]=Math.min(ue.min.y,He.min.y),N[1]=Math.max(ue.max.y,He.max.y),N[2]=s.EXTENT-He.min.x>ue.max.x?He.min.x-s.EXTENT:ue.max.x,N),$=(ue,He)=>(N[0]=Math.min(ue.min.x,He.min.x),N[1]=Math.max(ue.max.x,He.max.x),N[2]=s.EXTENT-He.min.y>ue.max.y?He.min.y-s.EXTENT:ue.max.y,N),ce=[(ue,He)=>H(ue,He),(ue,He)=>H(He,ue),(ue,He)=>$(ue,He),(ue,He)=>$(He,ue)],Ie=new s.Point(0,0);let $e,Qe,Ye;const ot=(ue,He,pt,ht,Pt)=>{const Lt=[[ht?pt:ue,ht?ue:pt,0],[ht?pt:He,ht?He:pt,0]],Ot=Pt<0?s.EXTENT+Pt:Pt,qt=[ht?Ot:(ue+He)/2,ht?(ue+He)/2:Ot,0];return 0===pt&&Pt<0||0!==pt&&Pt>0?C.getForTilePoints(Ye,[qt],!0,Qe):Lt.push(qt),C.getForTilePoints(c,Lt,!0,$e),Math.max(Lt[0][2],Lt[1][2],qt[2])/C.exaggeration()};for(let ue=0;ue<4;ue++){const He=(ue<2?1:5)-ue,pt=m.borders[ue];if(0===pt.length)continue;const ht=Ye=I[ue](c),Pt=O(ht);if(!(Pt&&Pt instanceof s.FillExtrusionBucket&&Pt.enableTerrain)||m.borderDoneWithNeighborZ[ue]===Pt.canonical.z&&Pt.borderDoneWithNeighborZ[He]===m.canonical.z||(Qe=C.findDEMTileFor(ht),!Qe||!Qe.dem))continue;if(!$e){const $t=C.findDEMTileFor(c);if(!$t||!$t.dem)return;$e=$t}const Lt=Pt.borders[He];let Ot=0;const qt=Pt.borderDoneWithNeighborZ[He]!==m.canonical.z;if(m.canonical.z===Pt.canonical.z){for(let $t=0;$t<pt.length;$t++){const an=m.featuresOnBorder[pt[$t]],Wn=an.borders[ue];let nn;for(;Ot<Lt.length&&(nn=Pt.featuresOnBorder[Lt[Ot]],!(nn.borders[He][1]>Wn[0]+3));)qt&&Pt.encodeCentroid(void 0,nn,!1),Ot++;if(nn&&Ot<Lt.length){const An=Ot;let pn=0;for(;!(nn.borders[He][0]>Wn[1]-3)&&(pn++,++Ot!==Lt.length);)nn=Pt.featuresOnBorder[Lt[Ot]];if(nn=Pt.featuresOnBorder[Lt[An]],an.intersectsCount()>1||nn.intersectsCount()>1||1!==pn){1!==pn&&(Ot=An),m.encodeCentroid(void 0,an,!1),qt&&Pt.encodeCentroid(void 0,nn,!1);continue}const $n=ce[ue](an,nn),ln=ue%2?s.EXTENT-1:0;Ie.x=ot($n[0],Math.min(s.EXTENT-1,$n[1]),ln,ue<2,$n[2]),Ie.y=0,m.encodeCentroid(Ie,an,!1),qt&&Pt.encodeCentroid(Ie,nn,!1)}else m.encodeCentroid(void 0,an,!1)}m.borderDoneWithNeighborZ[ue]=Pt.canonical.z,m.needsCentroidUpdate=!0,qt&&(Pt.borderDoneWithNeighborZ[He]=m.canonical.z,Pt.needsCentroidUpdate=!0)}else{for(const $t of pt)m.encodeCentroid(void 0,m.featuresOnBorder[$t],!1);if(qt){for(const $t of Lt)Pt.encodeCentroid(void 0,Pt.featuresOnBorder[$t],!1);Pt.borderDoneWithNeighborZ[He]=m.canonical.z,Pt.needsCentroidUpdate=!0}m.borderDoneWithNeighborZ[ue]=Pt.canonical.z,m.needsCentroidUpdate=!0}}(m.needsCentroidUpdate||!m.centroidVertexBuffer&&0!==m.centroidVertexArray.length)&&m.uploadCentroid(p)}const Ba=new s.Color(1,0,0,1),ac=new s.Color(0,1,0,1),mu=new s.Color(0,0,1,1),zl=new s.Color(1,0,1,1),lc=new s.Color(0,1,1,1);function zc(p,o,c){const m=p.context,x=p.transform,C=m.gl,I="globe"===x.projection.name,O=I?["PROJECTION_GLOBE_VIEW"]:null;let N=c.projMatrix;if(I&&s.globeToMercatorTransition(x.zoom)>0){const an=s.transitionTileAABBinECEF(c.canonical,x),Wn=s.globeDenormalizeECEF(an);N=s.multiply(new Float32Array(16),x.globeMatrix,Wn),s.multiply(N,x.projMatrix,N)}const H=p.useProgram("debug",null,O),$=o.getTileByID(c.key);p.terrain&&p.terrain.setupElevationDraw($,H);const ce=s.DepthMode.disabled,Ie=s.StencilMode.disabled,$e=p.colorModeForRenderPass();m.activeTexture.set(C.TEXTURE0),p.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),I?$._makeGlobeTileDebugBuffers(p.context,x):$._makeDebugTileBoundsBuffers(p.context,x.projection);const Ye=$._tileDebugBuffer||p.debugBuffer,ot=$._tileDebugIndexBuffer||p.debugIndexBuffer,ue=$._tileDebugSegments||p.debugSegments;H.draw(m,C.LINE_STRIP,ce,Ie,$e,s.CullFaceMode.disabled,Fc(N,s.Color.red),"$debug",Ye,ot,ue,null,null,null,[$._globeTileDebugBorderBuffer]);const He=$.latestRawTileData,pt=Math.floor((He&&He.byteLength||0)/1024),ht=o.getTile(c).tileSize,Pt=512/Math.min(ht,512)*(c.overscaledZ/x.zoom)*.5;let Lt=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(Lt+=` => ${c.overscaledZ}`),Lt+=` ${pt}kb`,function(an,Wn){an.initDebugOverlayCanvas();const nn=an.debugOverlayCanvas,An=an.context.gl,pn=an.debugOverlayCanvas.getContext("2d");pn.clearRect(0,0,nn.width,nn.height),pn.shadowColor="white",pn.shadowBlur=2,pn.lineWidth=1.5,pn.strokeStyle="white",pn.textBaseline="top",pn.font="bold 36px Open Sans, sans-serif",pn.fillText(Wn,5,5),pn.strokeText(Wn,5,5),an.debugOverlayTexture.update(nn),an.debugOverlayTexture.bind(An.LINEAR,An.CLAMP_TO_EDGE)}(p,Lt);const Ot=$._tileDebugTextBuffer||p.debugBuffer,qt=$._tileDebugTextIndexBuffer||p.quadTriangleIndexBuffer,$t=$._tileDebugTextSegments||p.debugSegments;H.draw(m,C.TRIANGLES,ce,Ie,s.ColorMode.alphaBlended,s.CullFaceMode.disabled,Fc(N,s.Color.transparent,Pt),"$debug",Ot,qt,$t,null,null,null,[$._globeTileDebugTextBuffer])}function Uc(p,o,c,m){Na(p,0,o+c/2,p.transform.width,c,m)}function Ul(p,o,c,m){Na(p,o-c/2,0,c,p.transform.height,m)}function Na(p,o,c,m,x,C){const I=p.context,O=I.gl;O.enable(O.SCISSOR_TEST),O.scissor(o*s.exported.devicePixelRatio,c*s.exported.devicePixelRatio,m*s.exported.devicePixelRatio,x*s.exported.devicePixelRatio),I.clear({color:C}),O.disable(O.SCISSOR_TEST)}const cc=s.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:uc}=cc;function ra(p,o,c,m){p.emplaceBack(o,c,m)}class ma{constructor(o){this.vertexArray=new s.StructArrayLayout3f12,this.indices=new s.StructArrayLayout3ui6,ra(this.vertexArray,-1,-1,1),ra(this.vertexArray,1,-1,1),ra(this.vertexArray,-1,1,1),ra(this.vertexArray,1,1,1),ra(this.vertexArray,-1,-1,-1),ra(this.vertexArray,1,-1,-1),ra(this.vertexArray,-1,1,-1),ra(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,uc),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=s.SegmentVector.simpleSegment(0,0,36,12)}}function Z(p,o,c,m,x,C){const I=p.gl,O=o.paint.get("sky-atmosphere-color"),N=o.paint.get("sky-atmosphere-halo-color"),H=o.paint.get("sky-atmosphere-sun-intensity"),$={u_matrix_3f:s.fromMat4(s.create$1(),m),u_sun_direction:x,u_sun_intensity:H,u_color_tint_r:[(Qe=O).r,Qe.g,Qe.b,Qe.a],u_color_tint_m:[(Ye=N).r,Ye.g,Ye.b,Ye.a],u_luminance:5e-5};var Qe,Ye;I.framebufferTexture2D(I.FRAMEBUFFER,I.COLOR_ATTACHMENT0,I.TEXTURE_CUBE_MAP_POSITIVE_X+C,o.skyboxTexture,0),c.draw(p,I.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,s.ColorMode.unblended,s.CullFaceMode.frontCW,$,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const de=s.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class q{constructor(o){const c=new s.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const m=new s.StructArrayLayout3ui6;m.emplaceBack(0,1,2),m.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(c,de.members),this.indexBuffer=o.createIndexBuffer(m),this.segments=s.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const be={symbol:function(p,o,c,m,x){if("translucent"!==p.renderPass)return;const C=s.StencilMode.disabled,I=p.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(O,N,H,$,ce,Ie,$e){const Qe=N.transform,Ye="map"===ce,ot="map"===Ie;for(const ue of O){const He=$.getTile(ue),pt=He.getBucket(H);if(!pt||!pt.text||!pt.text.segments.get().length)continue;const ht=s.evaluateSizeForZoom(pt.textSizeData,Qe.zoom),Pt=xn(ue,pt.getProjection(),Qe),Lt=Qe.calculatePixelsToTileUnitsMatrix(He),Ot=en(Pt,He.tileID.canonical,ot,Ye,Qe,pt.getProjection(),Lt),qt="none"!==H.layout.get("icon-text-fit")&&pt.hasIconData();if(ht){const $t=Math.pow(2,Qe.zoom-He.tileID.overscaledZ);Nc(pt,Ye,ot,$e,s.symbolSize,Qe,Ot,ue,$t,ht,qt)}}}(m,p,c,o,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),x),0!==c.paint.get("icon-opacity").constantOr(1)&&Bl(p,o,c,m,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),C,I),0!==c.paint.get("text-opacity").constantOr(1)&&Bl(p,o,c,m,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),C,I),o.map.showCollisionBoxes&&(Es(p,o,c,m,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),Es(p,o,c,m,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(p,o,c,m){if("translucent"!==p.renderPass)return;const x=c.paint.get("circle-opacity"),C=c.paint.get("circle-stroke-width"),I=c.paint.get("circle-stroke-opacity"),O=void 0!==c.layout.get("circle-sort-key").constantOr(1);if(0===x.constantOr(1)&&(0===C.constantOr(1)||0===I.constantOr(1)))return;const N=p.context,H=N.gl,$=p.transform,ce=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),Ie=s.StencilMode.disabled,$e=p.colorModeForRenderPass(),Qe="globe"===$.projection.name,Ye=[s.mercatorXfromLng($.center.lng),s.mercatorYfromLat($.center.lat)],ot=[];for(let He=0;He<m.length;He++){const pt=m[He],ht=o.getTile(pt),Pt=ht.getBucket(c);if(!Pt||Pt.projection.name!==$.projection.name)continue;const Lt=Pt.programConfigurations.get(c.id),Ot=qa(c);Qe&&Ot.push("PROJECTION_GLOBE_VIEW");const qt=p.useProgram("circle",Lt,Ot),$t=Pt.layoutVertexBuffer,an=Pt.globeExtVertexBuffer,Wn=Pt.indexBuffer,nn=$.projection.createInversionMatrix($,pt.canonical),An={programConfiguration:Lt,program:qt,layoutVertexBuffer:$t,globeExtVertexBuffer:an,indexBuffer:Wn,uniformValues:Ws(p,pt,ht,nn,Ye,c),tile:ht};if(O){const pn=Pt.segments.get();for(const $n of pn)ot.push({segments:new s.SegmentVector([$n]),sortKey:$n.sortKey,state:An})}else ot.push({segments:Pt.segments,sortKey:0,state:An})}O&&ot.sort((He,pt)=>He.sortKey-pt.sortKey);const ue={useDepthForOcclusion:!Qe};for(const He of ot){const{programConfiguration:pt,program:ht,layoutVertexBuffer:Pt,globeExtVertexBuffer:Lt,indexBuffer:Ot,uniformValues:qt,tile:$t}=He.state,an=He.segments;p.terrain&&p.terrain.setupElevationDraw($t,ht,ue),p.prepareDrawProgram(N,ht,$t.tileID.toUnwrapped()),ht.draw(N,H.TRIANGLES,ce,Ie,$e,s.CullFaceMode.disabled,qt,c.id,Pt,Ot,an,c.paint,$.zoom,pt,[Lt])}},heatmap:function(p,o,c,m){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===p.renderPass){const x=p.context,C=x.gl,I=s.StencilMode.disabled,O=new s.ColorMode([C.ONE,C.ONE],s.Color.transparent,[!0,!0,!0,!0]);(function($e,Qe,Ye,ot){const ue=$e.gl,He=Qe.width*ot,pt=Qe.height*ot;$e.activeTexture.set(ue.TEXTURE1),$e.viewport.set([0,0,He,pt]);let ht=Ye.heatmapFbo;if(!ht||ht&&(ht.width!==He||ht.height!==pt)){ht&&ht.destroy();const Pt=ue.createTexture();ue.bindTexture(ue.TEXTURE_2D,Pt),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_S,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_WRAP_T,ue.CLAMP_TO_EDGE),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MIN_FILTER,ue.LINEAR),ue.texParameteri(ue.TEXTURE_2D,ue.TEXTURE_MAG_FILTER,ue.LINEAR),ht=Ye.heatmapFbo=$e.createFramebuffer(He,pt,!1),function(Lt,Ot,qt,$t,an,Wn){const nn=Lt.gl;nn.texImage2D(nn.TEXTURE_2D,0,Lt.isWebGL2&&Lt.extRenderToTextureHalfFloat?nn.RGBA16F:nn.RGBA,an,Wn,0,nn.RGBA,Lt.extRenderToTextureHalfFloat?Lt.isWebGL2?nn.HALF_FLOAT:Lt.extTextureHalfFloat.HALF_FLOAT_OES:nn.UNSIGNED_BYTE,null),$t.colorAttachment.set(qt)}($e,0,Pt,ht,He,pt)}else ue.bindTexture(ue.TEXTURE_2D,ht.colorAttachment.get()),$e.bindFramebuffer.set(ht.framebuffer)})(x,p,c,"globe"===p.transform.projection.name?.5:.25),x.clear({color:s.Color.transparent});const N=p.transform,H="globe"===N.projection.name,$=H?["PROJECTION_GLOBE_VIEW"]:null,ce=H?s.CullFaceMode.frontCCW:s.CullFaceMode.disabled,Ie=[s.mercatorXfromLng(N.center.lng),s.mercatorYfromLat(N.center.lat)];for(let $e=0;$e<m.length;$e++){const Qe=m[$e];if(o.hasRenderableParent(Qe))continue;const Ye=o.getTile(Qe),ot=Ye.getBucket(c);if(!ot||ot.projection.name!==N.projection.name)continue;const ue=ot.programConfigurations.get(c.id),He=p.useProgram("heatmap",ue,$),{zoom:pt}=p.transform;p.terrain&&p.terrain.setupElevationDraw(Ye,He),p.prepareDrawProgram(x,He,Qe.toUnwrapped());const ht=N.projection.createInversionMatrix(N,Qe.canonical);He.draw(x,C.TRIANGLES,s.DepthMode.disabled,I,O,ce,Ll(p,Qe,Ye,ht,Ie,pt,c.paint.get("heatmap-intensity")),c.id,ot.layoutVertexBuffer,ot.indexBuffer,ot.segments,c.paint,p.transform.zoom,ue,H?[ot.globeExtVertexBuffer]:null)}x.viewport.set([0,0,p.width,p.height])}else"translucent"===p.renderPass&&(p.context.setColorMode(p.colorModeForRenderPass()),function(x,C){const I=x.context,O=I.gl,N=C.heatmapFbo;if(!N)return;I.activeTexture.set(O.TEXTURE0),O.bindTexture(O.TEXTURE_2D,N.colorAttachment.get()),I.activeTexture.set(O.TEXTURE1);let H=C.colorRampTexture;H||(H=C.colorRampTexture=new s.Texture(I,C.colorRamp,O.RGBA)),H.bind(O.LINEAR,O.CLAMP_TO_EDGE),x.useProgram("heatmapTexture").draw(I,O.TRIANGLES,s.DepthMode.disabled,s.StencilMode.disabled,x.colorModeForRenderPass(),s.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:C.paint.get("heatmap-opacity")},C.id,x.viewportBuffer,x.quadTriangleIndexBuffer,x.viewportSegments,C.paint,x.transform.zoom)}(p,c))},line:function(p,o,c,m){if("translucent"!==p.renderPass)return;const x=c.paint.get("line-opacity"),C=c.paint.get("line-width");if(0===x.constantOr(1)||0===C.constantOr(1))return;const I=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),O=p.colorModeForRenderPass(),N=p.terrain&&p.terrain.renderingToTexture?1:s.exported.devicePixelRatio,H=c.paint.get("line-dasharray"),$=H.constantOr(1),ce=c.layout.get("line-cap"),Ie=c.paint.get("line-pattern"),$e=Ie.constantOr(1),Qe=c.paint.get("line-gradient"),Ye=$e?"linePattern":"line",ot=p.context,ue=ot.gl,He=(ht=>{const Pt=[];Ya(ht)&&Pt.push("RENDER_LINE_DASH"),ht.paint.get("line-gradient")&&Pt.push("RENDER_LINE_GRADIENT");const Lt=ht.paint.get("line-trim-offset");0===Lt[0]&&0===Lt[1]||Pt.push("RENDER_LINE_TRIM_OFFSET");const Ot=ht.paint.get("line-pattern").constantOr(1),qt=1!==ht.paint.get("line-opacity").constantOr(1);return!Ot&&qt&&Pt.push("RENDER_LINE_ALPHA_DISCARD"),Pt})(c);let pt=He.includes("RENDER_LINE_ALPHA_DISCARD");p.terrain&&p.terrain.clipOrMaskOverlapStencilType()&&(pt=!1);for(const ht of m){const Pt=o.getTile(ht);if($e&&!Pt.patternsLoaded())continue;const Lt=Pt.getBucket(c);if(!Lt)continue;p.prepareDrawTile();const Ot=Lt.programConfigurations.get(c.id),qt=p.useProgram(Ye,Ot,He),$t=Ie.constantOr(null);if($t&&Pt.imageAtlas){const Mn=Pt.imageAtlas.patternPositions[$t.toString()];Mn&&Ot.setConstantPatternPositions(Mn)}const an=H.constantOr(null),Wn=ce.constantOr(null);if(!$e&&an&&Wn&&Pt.lineAtlas){const Mn=Pt.lineAtlas.getDash(an,Wn);Mn&&Ot.setConstantPatternPositions(Mn)}let[nn,An]=c.paint.get("line-trim-offset");("round"===Wn||"square"===Wn)&&nn!==An&&(0===nn&&(nn-=1),1===An&&(An+=1));const pn=p.terrain?ht.projMatrix:null,$n=$e?Os(p,Pt,c,pn,N):rc(p,Pt,c,pn,Lt.lineClipsArray.length,N,[nn,An]);if(Qe){const Mn=Lt.gradients[c.id];let jn=Mn.texture;if(c.gradientVersion!==Mn.version){let Bn=256;if(c.stepInterpolant){const Yn=o.getSource().maxzoom,Di=ht.canonical.z===Yn?Math.ceil(1<<p.transform.maxZoom-ht.canonical.z):1;Bn=s.clamp(s.nextPowerOfTwo(Lt.maxLineLength/s.EXTENT*1024*Di),256,ot.maxTextureSize)}Mn.gradient=s.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:Bn,image:Mn.gradient||void 0,clips:Lt.lineClipsArray}),Mn.texture?Mn.texture.update(Mn.gradient):Mn.texture=new s.Texture(ot,Mn.gradient,ue.RGBA),Mn.version=c.gradientVersion,jn=Mn.texture}ot.activeTexture.set(ue.TEXTURE1),jn.bind(c.stepInterpolant?ue.NEAREST:ue.LINEAR,ue.CLAMP_TO_EDGE)}$&&(ot.activeTexture.set(ue.TEXTURE0),Pt.lineAtlasTexture.bind(ue.LINEAR,ue.REPEAT),Ot.updatePaintBuffers()),$e&&(ot.activeTexture.set(ue.TEXTURE0),Pt.imageAtlasTexture.bind(ue.LINEAR,ue.CLAMP_TO_EDGE),Ot.updatePaintBuffers()),p.prepareDrawProgram(ot,qt,ht.toUnwrapped());const ln=Mn=>{qt.draw(ot,ue.TRIANGLES,I,Mn,O,s.CullFaceMode.disabled,$n,c.id,Lt.layoutVertexBuffer,Lt.indexBuffer,Lt.segments,c.paint,p.transform.zoom,Ot,[Lt.layoutVertexBuffer2])};if(pt){const Mn=p.stencilModeForClipping(ht).ref;0===Mn&&p.terrain&&ot.clear({stencil:0});const jn={func:ue.EQUAL,mask:255};$n.u_alpha_discard_threshold=.8,ln(new s.StencilMode(jn,Mn,255,ue.KEEP,ue.KEEP,ue.INVERT)),$n.u_alpha_discard_threshold=0,ln(new s.StencilMode(jn,Mn,255,ue.KEEP,ue.KEEP,ue.KEEP))}else ln(p.stencilModeForClipping(ht))}pt&&(p.resetStencilClippingMasks(),p.terrain&&ot.clear({stencil:0}))},fill:function(p,o,c,m){const x=c.paint.get("fill-color"),C=c.paint.get("fill-opacity");if(0===C.constantOr(1))return;const I=p.colorModeForRenderPass(),O=c.paint.get("fill-pattern"),N=p.opaquePassEnabledForLayer()&&!O.constantOr(1)&&1===x.constantOr(s.Color.transparent).a&&1===C.constantOr(0)?"opaque":"translucent";if(p.renderPass===N){const H=p.depthModeForSublayer(1,"opaque"===p.renderPass?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly);Nl(p,o,c,m,H,I,!1)}if("translucent"===p.renderPass&&c.paint.get("fill-antialias")){const H=p.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,s.DepthMode.ReadOnly);Nl(p,o,c,m,H,I,!0)}},"fill-extrusion":function(p,o,c,m){const x=c.paint.get("fill-extrusion-opacity");if(0!==x&&"translucent"===p.renderPass){const C=new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D);if(1!==x||c.paint.get("fill-extrusion-pattern").constantOr(1))ml(p,o,c,m,C,s.StencilMode.disabled,s.ColorMode.disabled),ml(p,o,c,m,C,p.stencilModeFor3D(),p.colorModeForRenderPass()),p.resetStencilClippingMasks();else{const I=p.colorModeForRenderPass();ml(p,o,c,m,C,s.StencilMode.disabled,I)}}},hillshade:function(p,o,c,m){if("offscreen"!==p.renderPass&&"translucent"!==p.renderPass)return;const x=p.context,C=p.depthModeForSublayer(0,s.DepthMode.ReadOnly),I=p.colorModeForRenderPass(),O=p.terrain&&p.terrain.renderingToTexture,[N,H]="translucent"!==p.renderPass||O?[{},m]:p.stencilConfigForOverlap(m);for(const $ of H){const ce=o.getTile($);if(ce.needsHillshadePrepare&&"offscreen"===p.renderPass)Pr(p,ce,c,C,s.StencilMode.disabled,I);else if("translucent"===p.renderPass){const Ie=O&&p.terrain?p.terrain.stencilModeForRTTOverlap($):N[$.overscaledZ];wr(p,$,ce,c,C,Ie,I)}}x.viewport.set([0,0,p.width,p.height]),p.resetStencilClippingMasks()},raster:function(p,o,c,m,x,C){if("translucent"!==p.renderPass||0===c.paint.get("raster-opacity")||!m.length)return;const I=p.context,O=I.gl,N=o.getSource(),H=p.useProgram("raster"),$=p.colorModeForRenderPass(),ce=p.terrain&&p.terrain.renderingToTexture,[Ie,$e]=N instanceof me||ce?[{},m]:p.stencilConfigForOverlap(m),Qe=$e[$e.length-1].overscaledZ,Ye=!p.options.moving;for(const ot of $e){const ue=ce?s.DepthMode.disabled:p.depthModeForSublayer(ot.overscaledZ-Qe,1===c.paint.get("raster-opacity")?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly,O.LESS),He=ot.toUnwrapped(),pt=o.getTile(ot);if(ce&&(!pt||!pt.hasData()))continue;const ht=ce?ot.projMatrix:p.transform.calculateProjMatrix(He,Ye),Pt=p.terrain&&ce?p.terrain.stencilModeForRTTOverlap(ot):Ie[ot.overscaledZ],Lt=C?0:c.paint.get("raster-fade-duration");pt.registerFadeDuration(Lt);const Ot=o.findLoadedParent(ot,0),qt=re(pt,Ot,o,p.transform,Lt);let $t,an;p.terrain&&p.terrain.prepareDrawTile();const Wn="nearest"===c.paint.get("raster-resampling")?O.NEAREST:O.LINEAR;I.activeTexture.set(O.TEXTURE0),pt.texture.bind(Wn,O.CLAMP_TO_EDGE),I.activeTexture.set(O.TEXTURE1),Ot?(Ot.texture.bind(Wn,O.CLAMP_TO_EDGE),$t=Math.pow(2,Ot.tileID.overscaledZ-pt.tileID.overscaledZ),an=[pt.tileID.canonical.x*$t%1,pt.tileID.canonical.y*$t%1]):pt.texture.bind(Wn,O.CLAMP_TO_EDGE),pt.texture.useMipmap&&I.extTextureFilterAnisotropic&&p.transform.pitch>20&&O.texParameterf(O.TEXTURE_2D,I.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,I.extTextureFilterAnisotropicMax);const nn=Ja(ht,an||[0,0],$t||1,qt,c,N instanceof me?N.perspectiveTransform:[0,0]);if(p.prepareDrawProgram(I,H,He),N instanceof me)N.boundsBuffer&&N.boundsSegments&&H.draw(I,O.TRIANGLES,ue,s.StencilMode.disabled,$,s.CullFaceMode.disabled,nn,c.id,N.boundsBuffer,p.quadTriangleIndexBuffer,N.boundsSegments);else{const{tileBoundsBuffer:An,tileBoundsIndexBuffer:pn,tileBoundsSegments:$n}=p.getTileBoundsBuffers(pt);H.draw(I,O.TRIANGLES,ue,Pt,$,s.CullFaceMode.disabled,nn,c.id,An,pn,$n)}}p.resetStencilClippingMasks()},background:function(p,o,c,m){const x=c.paint.get("background-color"),C=c.paint.get("background-opacity");if(0===C)return;const I=p.context,O=I.gl,N=p.transform,H=N.tileSize,$=c.paint.get("background-pattern");if(p.isPatternMissing($))return;const ce=!$&&1===x.a&&1===C&&p.opaquePassEnabledForLayer()?"opaque":"translucent";if(p.renderPass!==ce)return;const Ie=s.StencilMode.disabled,$e=p.depthModeForSublayer(0,"opaque"===ce?s.DepthMode.ReadWrite:s.DepthMode.ReadOnly),Qe=p.colorModeForRenderPass(),Ye=p.useProgram($?"backgroundPattern":"background");let ot,ue=m;ue||(ot=p.getBackgroundTiles(),ue=Object.values(ot).map(He=>He.tileID)),$&&(I.activeTexture.set(O.TEXTURE0),p.imageManager.bind(p.context));for(const He of ue){const pt=He.toUnwrapped(),ht=m?He.projMatrix:p.transform.calculateProjMatrix(pt);p.prepareDrawTile();const Pt=o?o.getTile(He):ot?ot[He.key]:new s.Tile(He,H,N.zoom,p),Lt=$?fd(ht,C,p,$,{tileID:He,tileSize:H}):pl(ht,C,x);p.prepareDrawProgram(I,Ye,pt);const{tileBoundsBuffer:Ot,tileBoundsIndexBuffer:qt,tileBoundsSegments:$t}=p.getTileBoundsBuffers(Pt);Ye.draw(I,O.TRIANGLES,$e,Ie,Qe,s.CullFaceMode.disabled,Lt,c.id,Ot,qt,$t)}},sky:function(p,o,c){const m=p.transform,x="mercator"===m.projection.name||"globe"===m.projection.name?1:s.smoothstep(7,8,m.zoom),C=c.paint.get("sky-opacity")*x;if(0===C)return;const I=p.context,O=c.paint.get("sky-type"),N=new s.DepthMode(I.gl.LEQUAL,s.DepthMode.ReadOnly,[0,1]),H=p.frameCounter/1e3%1;"atmosphere"===O?"offscreen"===p.renderPass?c.needsSkyboxCapture(p)&&(function($,ce,Ie,$e){const Qe=$.context,Ye=Qe.gl;let ot=ce.skyboxFbo;if(!ot){ot=ce.skyboxFbo=Qe.createFramebuffer(32,32,!1),ce.skyboxGeometry=new ma(Qe),ce.skyboxTexture=Qe.gl.createTexture(),Ye.bindTexture(Ye.TEXTURE_CUBE_MAP,ce.skyboxTexture),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_S,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_WRAP_T,Ye.CLAMP_TO_EDGE),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MIN_FILTER,Ye.LINEAR),Ye.texParameteri(Ye.TEXTURE_CUBE_MAP,Ye.TEXTURE_MAG_FILTER,Ye.LINEAR);for(let ht=0;ht<6;++ht)Ye.texImage2D(Ye.TEXTURE_CUBE_MAP_POSITIVE_X+ht,0,Ye.RGBA,32,32,0,Ye.RGBA,Ye.UNSIGNED_BYTE,null)}Qe.bindFramebuffer.set(ot.framebuffer),Qe.viewport.set([0,0,32,32]);const ue=ce.getCenter($,!0),He=$.useProgram("skyboxCapture"),pt=new Float64Array(16);s.identity(pt),s.rotateY(pt,pt,.5*-Math.PI),Z(Qe,ce,He,pt,ue,0),s.identity(pt),s.rotateY(pt,pt,.5*Math.PI),Z(Qe,ce,He,pt,ue,1),s.identity(pt),s.rotateX(pt,pt,.5*-Math.PI),Z(Qe,ce,He,pt,ue,2),s.identity(pt),s.rotateX(pt,pt,.5*Math.PI),Z(Qe,ce,He,pt,ue,3),s.identity(pt),Z(Qe,ce,He,pt,ue,4),s.identity(pt),s.rotateY(pt,pt,Math.PI),Z(Qe,ce,He,pt,ue,5),Qe.viewport.set([0,0,$.width,$.height])}(p,c),c.markSkyboxValid(p)):"sky"===p.renderPass&&function($,ce,Ie,$e,Qe){const Ye=$.context,ot=Ye.gl,ue=$.transform,He=$.useProgram("skybox");Ye.activeTexture.set(ot.TEXTURE0),ot.bindTexture(ot.TEXTURE_CUBE_MAP,ce.skyboxTexture);const pt={u_matrix:ue.skyboxMatrix,u_sun_direction:ce.getCenter($,!1),u_cubemap:0,u_opacity:$e,u_temporal_offset:Qe};$.prepareDrawProgram(Ye,He),He.draw(Ye,ot.TRIANGLES,Ie,s.StencilMode.disabled,$.colorModeForRenderPass(),s.CullFaceMode.backCW,pt,"skybox",ce.skyboxGeometry.vertexBuffer,ce.skyboxGeometry.indexBuffer,ce.skyboxGeometry.segment)}(p,c,N,C,H):"gradient"===O&&"sky"===p.renderPass&&function($,ce,Ie,$e,Qe){const Ye=$.context,ot=Ye.gl,ue=$.transform,He=$.useProgram("skyboxGradient");ce.skyboxGeometry||(ce.skyboxGeometry=new ma(Ye)),Ye.activeTexture.set(ot.TEXTURE0);let pt=ce.colorRampTexture;pt||(pt=ce.colorRampTexture=new s.Texture(Ye,ce.colorRamp,ot.RGBA)),pt.bind(ot.LINEAR,ot.CLAMP_TO_EDGE);const ht=(Pt=ue.skyboxMatrix,Lt=ce.getCenter($,!1),Ot=ce.paint.get("sky-gradient-radius"),qt=$e,$t=Qe,{u_matrix:Pt,u_color_ramp:0,u_center_direction:Lt,u_radius:s.degToRad(Ot),u_opacity:qt,u_temporal_offset:$t});var Pt,Lt,Ot,qt,$t;$.prepareDrawProgram(Ye,He),He.draw(Ye,ot.TRIANGLES,Ie,s.StencilMode.disabled,$.colorModeForRenderPass(),s.CullFaceMode.backCW,ht,"skyboxGradient",ce.skyboxGeometry.vertexBuffer,ce.skyboxGeometry.indexBuffer,ce.skyboxGeometry.segment)}(p,c,N,C,H)},debug:function(p,o,c){for(let m=0;m<c.length;m++)zc(p,o,c[m])},custom:function(p,o,c,m){const x=p.context,C=c.implementation;if(!p.transform.projection.unsupportedLayers||!p.transform.projection.unsupportedLayers.includes("custom")||p.terrain&&(p.terrain.renderingToTexture||"offscreen"===p.renderPass)&&c.isLayerDraped()){if("offscreen"===p.renderPass){const I=C.prerender;if(I){if(p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),"globe"===p.transform.projection.name){const O=p.transform.pointMerc;I.call(C,x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(p.transform.zoom),[O.x,O.y],p.transform.pixelsPerMeterRatio)}else I.call(C,x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState()}}else if("translucent"===p.renderPass){if(p.terrain&&p.terrain.renderingToTexture){const O=C.renderToTile;if(O){const N=m[0].canonical,H=new s.MercatorCoordinate(N.x+m[0].wrap*(1<<N.z),N.y,N.z);x.setDepthMode(s.DepthMode.disabled),x.setStencilMode(s.StencilMode.disabled),x.setColorMode(p.colorModeForRenderPass()),p.setCustomLayerDefaults(),O.call(C,x.gl,H),x.setDirty(),p.setBaseState()}return}p.setCustomLayerDefaults(),x.setColorMode(p.colorModeForRenderPass()),x.setStencilMode(s.StencilMode.disabled);const I="3d"===C.renderingMode?new s.DepthMode(p.context.gl.LEQUAL,s.DepthMode.ReadWrite,p.depthRangeFor3D):p.depthModeForSublayer(0,s.DepthMode.ReadOnly);if(x.setDepthMode(I),"globe"===p.transform.projection.name){const O=p.transform.pointMerc;C.render(x.gl,p.transform.customLayerMatrix(),p.transform.getProjection(),p.transform.globeToMercatorMatrix(),s.globeToMercatorTransition(p.transform.zoom),[O.x,O.y],p.transform.pixelsPerMeterRatio)}else C.render(x.gl,p.transform.customLayerMatrix());x.setDirty(),p.setBaseState(),x.bindFramebuffer.set(null)}}else s.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class Tt{constructor(o,c,m=!1){this.context=new In(o,m),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=s.SourceCache.maxUnderzooming+s.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,c){const m=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(m||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ln(this,o));const x=this._terrain;this.transform.elevation=m?x:null,x.update(o,this.transform,c)}_updateFog(o){const c=o.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[m,x]=c.getFovAdjustedRange(this.transform._fov);if(m>x)return void(this.transform.fogCullDistSq=null);const C=m+.78*(x-m);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,c){if(this.width=o*s.exported.devicePixelRatio,this.height=c*s.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const m of this.style.order)this.style._layers[m].resize()}setup(){const o=this.context,c=new s.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(s.EXTENT,0),c.emplaceBack(0,s.EXTENT),c.emplaceBack(s.EXTENT,s.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(c,s.posAttributes.members),this.tileExtentSegments=s.SegmentVector.simpleSegment(0,0,4,2);const m=new s.StructArrayLayout2i4;m.emplaceBack(0,0),m.emplaceBack(s.EXTENT,0),m.emplaceBack(0,s.EXTENT),m.emplaceBack(s.EXTENT,s.EXTENT),this.debugBuffer=o.createVertexBuffer(m,s.posAttributes.members),this.debugSegments=s.SegmentVector.simpleSegment(0,0,4,5);const x=new s.StructArrayLayout2i4;x.emplaceBack(-1,-1),x.emplaceBack(1,-1),x.emplaceBack(-1,1),x.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(x,s.posAttributes.members),this.viewportSegments=s.SegmentVector.simpleSegment(0,0,4,2);const C=new s.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(s.EXTENT,0,s.EXTENT,0),C.emplaceBack(0,s.EXTENT,0,s.EXTENT),C.emplaceBack(s.EXTENT,s.EXTENT,s.EXTENT,s.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(C,s.boundsAttributes.members),this.mercatorBoundsSegments=s.SegmentVector.simpleSegment(0,0,4,2);const I=new s.StructArrayLayout3ui6;I.emplaceBack(0,1,2),I.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(I);const O=new s.StructArrayLayout1ui2;for(const H of[0,1,3,2,0])O.emplaceBack(H);this.debugIndexBuffer=o.createIndexBuffer(O),this.emptyTexture=new s.Texture(o,new s.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=s.create();const N=this.context.gl;this.stencilClearMode=new s.StencilMode({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(s.window.performance.now()),this.atmosphereBuffer=new q(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,c=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,c.TRIANGLES,s.DepthMode.disabled,this.stencilClearMode,s.ColorMode.disabled,s.CullFaceMode.disabled,S(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,c,m){if(!c||this.currentStencilSource===c.id||!o.isTileClipped()||!m||0===m.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let O=!1;for(const N of m)if(void 0===this._tileClippingMaskIDs[N.key]){O=!0;break}if(!O)return}this.currentStencilSource=c.id;const x=this.context,C=x.gl;this.nextStencilID+m.length>256&&this.clearStencil(),x.setColorMode(s.ColorMode.disabled),x.setDepthMode(s.DepthMode.disabled);const I=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const O of m){const N=c.getTile(O),H=this._tileClippingMaskIDs[O.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:ce,tileBoundsSegments:Ie}=this.getTileBoundsBuffers(N);I.draw(x,C.TRIANGLES,s.DepthMode.disabled,new s.StencilMode({func:C.ALWAYS,mask:0},H,255,C.KEEP,C.KEEP,C.REPLACE),s.ColorMode.disabled,s.CullFaceMode.disabled,S(O.projMatrix),"$clipping",$,ce,Ie)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,c=this.context.gl;return new s.StencilMode({func:c.NOTEQUAL,mask:255},o,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const c=this.context.gl;return new s.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(o){const c=this.context.gl,m=o.sort((I,O)=>O.overscaledZ-I.overscaledZ),x=m[m.length-1].overscaledZ,C=m[0].overscaledZ-x+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const I={};for(let O=0;O<C;O++)I[O+x]=new s.StencilMode({func:c.GEQUAL,mask:255},O+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=C,[I,m]}return[{[x]:s.StencilMode.disabled},m]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new s.ColorMode([o.CONSTANT_COLOR,o.ONE],new s.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?s.ColorMode.unblended:s.ColorMode.alphaBlended}depthModeForSublayer(o,c,m){if(!this.opaquePassEnabledForLayer())return s.DepthMode.disabled;const x=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new s.DepthMode(m||this.context.gl.LEQUAL,c,[x,x])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,c){this.style=o,this.options=c,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(s.exported.now()),this.imageManager.beginFrame();const m=this.style.order,x=this.style._sourceCaches;for(const H in x){const $=x[H];$.used&&$.prepare(this.context)}const C={},I={},O={};for(const H in x){const $=x[H];C[H]=$.getVisibleCoordinates(),I[H]=C[H].slice().reverse(),O[H]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let H=0;H<m.length;H++)if(this.style._layers[m[H]].is3D()){this.opaquePassCutoff=H;break}if(this.terrain&&(this.terrain.updateTileBinding(O),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new s.GlobeSharedBuffers(this.context)),!s.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const H of m){const $=this.style._layers[H],ce=o._getLayerSourceCache($);if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const Ie=ce?I[ce.id]:void 0;("custom"===$.type||$.isSky()||Ie&&Ie.length)&&this.renderLayer(this,ce,$,Ie)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const N=this.terrain;if(N&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&N.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?s.Color.black:s.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=m.length-1;this.currentLayer>=0;this.currentLayer--){const H=this.style._layers[m[this.currentLayer]],$=o._getLayerSourceCache(H);if(H.isSky())continue;const ce=$?I[$.id]:void 0;this._renderTileClippingMasks(H,$,ce),this.renderLayer(this,$,H,ce)}if(this.style.fog&&this.transform.projection.supportsFog&&function(H,$){const ce=H.context,Ie=ce.gl,$e=H.transform,Qe=new s.DepthMode(Ie.LEQUAL,s.DepthMode.ReadOnly,[0,1]),Ye=H.useProgram("globeAtmosphere",null,"globe"===$e.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),ot=s.globeToMercatorTransition($e.zoom),ue=$.properties.get("color").toArray01(),He=$.properties.get("high-color").toArray01(),pt=$.properties.get("space-color").toArray01PremultipliedAlpha(),ht=s.identity$1([]);s.rotateY$1(ht,ht,-s.degToRad($e._center.lng)),s.rotateX$1(ht,ht,s.degToRad($e._center.lat)),s.rotateZ$1(ht,ht,$e.angle),s.rotateX$1(ht,ht,-$e._pitch);const Pt=s.fromQuat(new Float32Array(16),ht),Lt=s.mapValue($.properties.get("star-intensity"),0,1,0,.25),qt=s.mapValue($.properties.get("horizon-blend"),0,1,5e-4,.25),$t=s.globeUseCustomAntiAliasing(H,ce,$e)&&5e-4===qt?$e.worldSize/(2*Math.PI*1.025)-1:$e.globeRadius,an=H.frameCounter/1e3%1,Wn=s.length($e.globeCenterInViewSpace),nn=Math.sqrt(Math.pow(Wn,2)-Math.pow($t,2)),An=Math.acos(nn/Wn),pn={u_frustum_tl:$e.frustumCorners.TL,u_frustum_tr:$e.frustumCorners.TR,u_frustum_br:$e.frustumCorners.BR,u_frustum_bl:$e.frustumCorners.BL,u_horizon:$e.frustumCorners.horizon,u_transition:ot,u_fadeout_range:qt,u_color:ue,u_high_color:He,u_space_color:pt,u_star_intensity:Lt,u_star_size:5*s.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:an,u_horizon_angle:An,u_rotation_matrix:Pt};H.prepareDrawProgram(ce,Ye);const $n=H.atmosphereBuffer;$n&&Ye.draw(ce,Ie.TRIANGLES,Qe,s.StencilMode.disabled,s.ColorMode.alphaBlended,s.CullFaceMode.backCW,pn,"skybox",$n.vertexBuffer,$n.indexBuffer,$n.segments)}(this,this.style.fog),this.renderPass="sky",(s.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<m.length;this.currentLayer++){const H=this.style._layers[m[this.currentLayer]],$=o._getLayerSourceCache(H);H.isSky()&&this.renderLayer(this,$,H,$?I[$.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<m.length;){const H=this.style._layers[m[this.currentLayer]],$=o._getLayerSourceCache(H);if(H.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(H)){if(H.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const ce=$?("symbol"===H.type?O:I)[$.id]:void 0;this._renderTileClippingMasks(H,$,$?C[$.id]:void 0),this.renderLayer(this,$,H,ce),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let H=null;s.values(this.style._layers).forEach($=>{const ce=o._getLayerSourceCache($);ce&&!$.isHidden(this.transform.zoom)&&(!H||H.getSource().maxzoom<ce.getSource().maxzoom)&&(H=ce)}),H&&this.options.showTileBoundaries&&be.debug(this,H,H.getVisibleCoordinates())}this.options.showPadding&&function(H){const $=H.transform.padding;Uc(H,H.transform.height-($.top||0),3,Ba),Uc(H,$.bottom||0,3,ac),Ul(H,$.left||0,3,mu),Ul(H,H.transform.width-($.right||0),3,zl);const ce=H.transform.centerPoint;var Ie,$e,Qe,Ye;Na(Ie=H,($e=ce.x)-1,(Qe=H.transform.height-ce.y)-10,2,20,Ye=lc),Na(Ie,$e-10,Qe-1,20,2,Ye)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(s.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,c,m,x){m.isHidden(this.transform.zoom)||("background"===m.type||"sky"===m.type||"custom"===m.type||x&&x.length)&&(this.id=m.id,this.gpuTimingStart(m),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(m.type)||o.terrain&&"custom"===m.type)&&be[m.type](o,c,m,x,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let m=this.gpuTimers[o.id];m||(m=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),m.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,m.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,c=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),o.beginQueryEXT(o.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const c={};for(const m in o){const x=o[m],C=this.context.extTimerQuery,I=C.getQueryObjectEXT(x.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(x.query),c[m]=I}return c}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let m=0;for(const x of o)m+=c.getQueryObjectEXT(x,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(x);return m}translatePosMatrix(o,c,m,x,C){if(!m[0]&&!m[1])return o;const I=C?"map"===x?this.transform.angle:0:"viewport"===x?-this.transform.angle:0;if(I){const H=Math.sin(I),$=Math.cos(I);m=[m[0]*$-m[1]*H,m[0]*H+m[1]*$]}const O=[C?m[0]:gt(c,m[0],this.transform.zoom),C?m[1]:gt(c,m[1],this.transform.zoom),0],N=new Float32Array(16);return s.translate(N,o,O),N}saveTileTexture(o){const c=this._tileTextures[o.size[0]];c?c.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const c=this._tileTextures[o];return c&&c.length>0?c.pop():null}isPatternMissing(o){return null===o||void 0!==o&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&0===this.terrain.exaggeration(),m=this.style&&this.style.fog,x=[];return this.terrainRenderModeElevated()&&x.push("TERRAIN"),"globe"===this.transform.projection.name&&x.push("GLOBE"),c&&x.push("ZERO_EXAGGERATION"),m&&!o&&0!==m.getOpacity(this.transform.pitch)&&x.push("FOG"),o&&x.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&x.push("OVERDRAW_INSPECTOR"),x}useProgram(o,c,m){this.cache=this.cache||{};const x=m||[],C=this.currentGlobalDefines().concat(x),I=Xn.cacheKey(Ss[o],o,C,c);return this.cache[I]||(this.cache[I]=new Xn(this.context,o,Ss[o],c,pa[o],C)),this.cache[I]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=s.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,c,m){if(this.terrain&&this.terrain.renderingToTexture)return;const x=this.style.fog;if(x){const C=x.getOpacity(this.transform.pitch),I=((O,N,H,$,ce,Ie,$e,Qe,Ye,ot,ue)=>{const He=O.transform,pt=N.properties.get("color").toArray01();pt[3]=$;const ht=O.frameCounter/1e3%1;return{u_fog_matrix:H?He.calculateFogTileMatrix(H):O.identityMat,u_fog_range:N.getFovAdjustedRange(He._fov),u_fog_color:pt,u_fog_horizon_blend:N.properties.get("horizon-blend"),u_fog_temporal_offset:ht,u_frustum_tl:ce,u_frustum_tr:Ie,u_frustum_br:$e,u_frustum_bl:Qe,u_globe_pos:Ye,u_globe_radius:ot,u_viewport:ue,u_globe_transition:s.globeToMercatorTransition(He.zoom),u_is_globe:+("globe"===He.projection.name)}})(this,x,m,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.exported.devicePixelRatio,this.transform.height*s.exported.devicePixelRatio]);c.setFogUniformValues(o,I)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,c=o.createTexture();return o.bindTexture(o.TEXTURE_2D,c),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&0!==o.getOpacity(this.transform.pitch)}getBackgroundTiles(){const o=this._backgroundTiles,c=this._backgroundTiles={},m=this.transform.coveringTiles({tileSize:512});for(const x of m)c[x.key]=o[x.key]||new s.Tile(x,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class vn{constructor(o=0,c=0,m=0,x=0){if(isNaN(o)||o<0||isNaN(c)||c<0||isNaN(m)||m<0||isNaN(x)||x<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=c,this.left=m,this.right=x}interpolate(o,c,m){return null!=c.top&&null!=o.top&&(this.top=s.number(o.top,c.top,m)),null!=c.bottom&&null!=o.bottom&&(this.bottom=s.number(o.bottom,c.bottom,m)),null!=c.left&&null!=o.left&&(this.left=s.number(o.left,c.left,m)),null!=c.right&&null!=o.right&&(this.right=s.number(o.right,c.right,m)),this}getCenter(o,c){const m=s.clamp((this.left+o-this.right)/2,0,o),x=s.clamp((this.top+c-this.bottom)/2,0,c);return new s.Point(m,x)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new vn(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Dn(p,o){const c=s.getColumn(p,3);s.fromQuat(p,o),s.setColumn(p,3,c)}function Qn(p,o){const c=s.identity$1([]);return s.rotateZ$1(c,c,-o),s.rotateX$1(c,c,-p),c}function Co(p,o){const c=[p[0],p[1],0],m=[o[0],o[1],0];if(s.length(c)>=1e-15){const I=s.normalize([],c);s.scale$2(m,I,s.dot(m,I)),o[0]=m[0],o[1]=m[1]}const x=s.cross([],o,p);if(s.len(x)<1e-15)return null;const C=Math.atan2(-x[1],x[0]);return Qn(Math.atan2(Math.sqrt(p[0]*p[0]+p[1]*p[1]),-p[2]),C)}class _o{constructor(o,c){this.position=o,this.orientation=c}get position(){return this._position}set position(o){if(o){const c=o instanceof s.MercatorCoordinate?o:new s.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(c.x=s.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(o,c){if(this.orientation=null,!this.position)return;const m=this.position,x=this._elevation?this._elevation.getAtPointOrZero(s.MercatorCoordinate.fromLngLat(o)):0,C=s.MercatorCoordinate.fromLngLat(o,x),I=[C.x-m.x,C.y-m.y,C.z-m.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=Co(I,c)}setPitchBearing(o,c){this.orientation=Qn(s.degToRad(o),s.degToRad(-c))}}class Ki{constructor(o,c){this._transform=s.identity([]),this.orientation=c,this.position=o}get mercatorPosition(){const o=this.position;return new s.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=s.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var c;o&&s.setColumn(this._transform,3,[(c=o)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||s.identity$1([]),o&&Dn(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,c){this._orientation=Qn(o,c),Dn(this._transform,this._orientation)}forward(){const o=s.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=s.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=s.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,c){const m=new Float64Array(16);return s.invert(m,this.getWorldToCamera(o,c)),m}getWorldToCameraPosition(o,c,m){const x=this.position;s.scale$2(x,x,-o);const C=new Float64Array(16);return s.fromScaling(C,[m,m,m]),s.translate(C,C,x),C[10]*=c,C}getWorldToCamera(o,c){const m=new Float64Array(16),x=new Float64Array(4),C=this.position;return s.conjugate(x,this._orientation),s.scale$2(C,C,-o),s.fromQuat(m,x),s.translate(m,m,C),m[1]*=-1,m[5]*=-1,m[9]*=-1,m[13]*=-1,m[8]*=c,m[9]*=c,m[10]*=c,m[11]*=c,m}getCameraToClipPerspective(o,c,m,x){const C=new Float64Array(16);return s.perspective(C,o,c,m,x),C}getDistanceToElevation(o,c=!1){const m=0===o?0:s.mercatorZfromAltitude(o,c?s.latFromMercatorY(this.position[1]):this.position[1]),x=this.forward();return(m-this.position[2])/x[2]}clone(){return new Ki([...this.position],[...this.orientation])}}function lo(p,o){const c=Ro(p.projection,p.zoom,p.width,p.height),m=function(C,I,O,N,H){const $=new s.LngLat(O.lng-180*Eo,O.lat),ce=new s.LngLat(O.lng+180*Eo,O.lat),Ie=C.project($.lng,$.lat),$e=C.project(ce.lng,ce.lat),Qe=-Math.atan2($e.y-Ie.y,$e.x-Ie.x),Ye=s.MercatorCoordinate.fromLngLat(O);Ye.y=s.clamp(Ye.y,-1+Eo,1-Eo);const ot=Ye.toLngLat(),ue=C.project(ot.lng,ot.lat),He=s.MercatorCoordinate.fromLngLat(ot);He.x+=Eo;const pt=He.toLngLat(),ht=C.project(pt.lng,pt.lat),Pt=Ds(ht.x-ue.x,ht.y-ue.y,Qe),Lt=s.MercatorCoordinate.fromLngLat(ot);Lt.y+=Eo;const Ot=Lt.toLngLat(),qt=C.project(Ot.lng,Ot.lat),$t=Ds(qt.x-ue.x,qt.y-ue.y,Qe),an=Math.abs(Pt.x)/Math.abs($t.y),Wn=s.identity([]);s.rotateZ(Wn,Wn,-Qe*(1-(H?0:N)));const nn=s.identity([]);return s.scale(nn,nn,[1,1-(1-an)*N,1]),nn[4]=-$t.x/$t.y*N,s.rotateZ(nn,nn,Qe),s.multiply(nn,Wn,nn),nn}(p.projection,0,p.center,c,o),x=fr(p);return s.scale(m,m,[x,x,1]),m}function fr(p){const o=p.projection,c=Ro(p.projection,p.zoom,p.width,p.height),m=Ls(o,p.center),x=Ls(o,s.LngLat.convert(o.center));return Math.pow(2,m*c+(1-c)*x)}function Ro(p,o,c,m,x=1/0){const C=p.range;if(!C)return 0;const I=Math.min(x,Math.max(c,m)),O=Math.log(I/1024)/Math.LN2;return s.smoothstep(C[0]+O,C[1]+O,o)}const Eo=1/4e4;function Ls(p,o){const c=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),m=new s.LngLat(o.lng-180*Eo,c),x=new s.LngLat(o.lng+180*Eo,c),C=p.project(m.lng,c),I=p.project(x.lng,c),O=s.MercatorCoordinate.fromLngLat(m),N=s.MercatorCoordinate.fromLngLat(x),H=I.x-C.x,$=I.y-C.y,ce=N.x-O.x,Ie=N.y-O.y,$e=Math.sqrt((ce*ce+Ie*Ie)/(H*H+$*$));return Math.log($e)/Math.LN2}function Ds(p,o,c){const m=Math.cos(c),x=Math.sin(c);return{x:p*m-o*x,y:p*x+o*m}}class fs{constructor(o,c,m,x,C,I,O){this.tileSize=512,this._renderWorldCopies=void 0===C||C,this._minZoom=o||0,this._maxZoom=c||22,this._minPitch=m??0,this._maxPitch=x??60,this.setProjection(I),this.setMaxBounds(O),this.width=0,this.height=0,this._center=new s.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new vn,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Ki,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new fs(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,c=!1){const m=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||m)&&this._updateCameraOnTerrain(),(o||m)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return s.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=s.getProjection(this.projectionOptions);const m=!Q(c,this.getProjection());return m&&this._calcMatrices(),this.mercatorFromTransition=!1,m}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.getProjection({name:"mercator"});const c=o!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(o){void 0===o?o=!0:null===o&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.Point(this.width,this.height)}get bearing(){return s.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const c=-o*Math.PI/180;var m,x,C,I,O,N,H,$,ce,Ie;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(m=new s.ARRAY_TYPE(4),s.ARRAY_TYPE!=Float32Array&&(m[1]=0,m[2]=0),m[0]=1,m[3]=1,m),x=this.rotationMatrix,I=this.angle,O=(C=this.rotationMatrix)[0],N=C[1],H=C[2],$=C[3],ce=Math.sin(I),Ie=Math.cos(I),x[0]=O*Ie+H*ce,x[1]=N*Ie+$*ce,x[2]=O*-ce+H*Ie,x[3]=N*-ce+$*Ie)}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const c=s.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=s.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const c=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],m=this.horizonLineFromTop();let x=0,C=0;for(let I=0;I<c.length;I++){const O=new s.Point(c[I][0]*this.width,m+c[I][1]*(this.height-m)),N=o.pointCoordinate(O);if(!N)continue;const H=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);x+=N[3]*H,C+=H}return 0===C?NaN:x/C}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const o=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),m=this.pixelsPerMeter/this.worldSize*c,x=this._mercatorZfromZoom(o),C=this._mercatorZfromZoom(this._maxZoom),I=Math.max(x-m,C);this._setZoom(this._zoomFromMercatorZ(I))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let m;m=o.z<this._camera.position[2]?[c.x,c.y,c.z]:[o.x,o.y,o.z];const x=s.length(s.sub([],this._camera.position,m));return s.clamp(this._zoomFromMercatorZ(x),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let c=!1;if(o.orientation&&!s.exactEquals(o.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(o.orientation)),o.position){const m=[o.position.x,o.position.y,o.position.z];s.exactEquals$1(m,this._camera.position)||(this._setCameraPosition(m),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,c=new _o;return c.position=new s.MercatorCoordinate(o[0],o[1],o[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(o){if(!s.length$1(o))return!1;s.normalize$1(o,o);const c=s.transformQuat([],[0,0,-1],o),m=s.transformQuat([],[0,-1,0],o);if(m[2]<0)return!1;const x=Co(c,m);return!!x&&(this._camera.orientation=x,!0)}_setCameraPosition(o){const c=this.zoomScale(this.minZoom)*this.tileSize,m=this.zoomScale(this.maxZoom)*this.tileSize,x=this.cameraToCenterDistance;o[2]=s.clamp(o[2],x/m,x/c),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,c,m){this._unmodified=!1,this._edgeInsets.interpolate(o,c,m),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const c=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(o){const c=[new s.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const m=this.pointCoordinate(new s.Point(0,0)),x=this.pointCoordinate(new s.Point(this.width,0)),C=this.pointCoordinate(new s.Point(this.width,this.height)),I=this.pointCoordinate(new s.Point(0,this.height)),O=Math.floor(Math.min(m.x,x.x,C.x,I.x)),N=Math.floor(Math.max(m.x,x.x,C.x,I.x)),H=1;for(let $=O-H;$<=N+H;$++)0!==$&&c.push(new s.UnwrappedTileID($,o))}return c}coveringTiles(o){let c=this.coveringZoomLevel(o);const m=c,x=this.elevation&&!o.isTerrainDEM,C="mercator"===this.projection.name;if(void 0!==o.minzoom&&c<o.minzoom)return[];void 0!==o.maxzoom&&c>o.maxzoom&&(c=o.maxzoom);const I=this.locationCoordinate(this.center),O=this.center.lat,N=1<<c,H=[N*I.x,N*I.y,0],$="globe"===this.projection.name,ce=!$,Ie=s.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,ce),$e=$?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Qe=N*s.mercatorZfromAltitude(1,this.center.lat),Ye=this._camera.position[2]/s.mercatorZfromAltitude(1,this.center.lat),ot=[N*$e.x,N*$e.y,Ye*(ce?1:Qe)],ue=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),He=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,pt=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ht=o.isTerrainDEM?-pt:this._elevation?this._elevation.getMinElevationBelowMSL():0,Pt=this.projection.isReprojectedInTileSpace?fr(this):1,Lt=ln=>{const jn=new s.MercatorCoordinate(ln.x+25e-6,ln.y,ln.z),Bn=new s.MercatorCoordinate(ln.x,ln.y+25e-6,ln.z),Yn=ln.toLngLat(),Di=jn.toLngLat(),$i=Bn.toLngLat(),vi=this.locationCoordinate(Yn),ki=this.locationCoordinate(Di),ho=this.locationCoordinate($i),fo=Math.hypot(ki.x-vi.x,ki.y-vi.y),Ti=Math.hypot(ho.x-vi.x,ho.y-vi.y);return Math.sqrt(fo*Ti)*Pt/25e-6},Ot=ln=>{const Mn=pt,jn=ht;return{aabb:s.tileAABB(this,N,0,0,0,ln,jn,Mn,this.projection),zoom:0,x:0,y:0,minZ:jn,maxZ:Mn,wrap:ln,fullyVisible:!1}},qt=[];let $t=[];const an=c,Wn=o.reparseOverscaled?m:c,nn=ln=>ln*ln,An=nn((Ye-this._centerAltitude)*Qe),pn=ln=>{if(!this._elevation||!ln.tileID||!C)return;const Mn=this._elevation.getMinMaxForTile(ln.tileID),jn=ln.aabb;Mn?(jn.min[2]=Mn.min,jn.max[2]=Mn.max,jn.center[2]=(jn.min[2]+jn.max[2])/2):(ln.shouldSplit=$n(ln),ln.shouldSplit||(jn.min[2]=jn.max[2]=jn.center[2]=this._centerAltitude))},$n=ln=>{if(ln.zoom<He)return!0;if(ln.zoom===an)return!1;if(null!=ln.shouldSplit)return ln.shouldSplit;const Mn=ln.aabb.distanceX(ot),jn=ln.aabb.distanceY(ot);let Bn=An,Yn=1;if($){Bn=nn(ln.aabb.distanceZ(ot));const vi=Math.pow(2,ln.zoom),ki=s.latFromMercatorY((ln.y+1)/vi),ho=s.latFromMercatorY(ln.y/vi),fo=Math.min(Math.max(O,ki),ho),Ti=s.circumferenceAtLatitude(fo)/s.circumferenceAtLatitude(O);if(Yn=fo===O?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ti/this._mercatorScaleRatio),this.zoom<=s.GLOBE_ZOOM_THRESHOLD_MIN&&ln.zoom===an-1&&Ti>=.9)return!0}else if(x&&(Bn=nn(ln.aabb.distanceZ(ot)*Qe)),this.projection.isReprojectedInTileSpace&&m<=5){const vi=Math.pow(2,ln.zoom),ki=Lt(new s.MercatorCoordinate((ln.x+.5)/vi,(ln.y+.5)/vi));Yn=ki>.85?1:ki}const Di=Mn*Mn+jn*jn+Bn;return Di<nn((1<<an-ln.zoom)*ue*Yn*((vi,ki)=>{if(ki*nn(.707)<vi)return 1;const ho=Math.sqrt(ki/vi);return ho/(1.4144271570014144+(Math.pow(1.1,ho-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(Bn,An),Di))};if(this.renderWorldCopies)for(let ln=1;ln<=3;ln++)qt.push(Ot(-ln)),qt.push(Ot(ln));for(qt.push(Ot(0));qt.length>0;){const ln=qt.pop(),Mn=ln.x,jn=ln.y;let Bn=ln.fullyVisible;if(!Bn){const Yn=ln.aabb.intersects(Ie);if(0===Yn)continue;Bn=2===Yn}if(ln.zoom!==an&&$n(ln))for(let Yn=0;Yn<4;Yn++){const Di=(Mn<<1)+Yn%2,$i=(jn<<1)+(Yn>>1),vi={aabb:C?ln.aabb.quadrant(Yn):s.tileAABB(this,N,ln.zoom+1,Di,$i,ln.wrap,ln.minZ,ln.maxZ,this.projection),zoom:ln.zoom+1,x:Di,y:$i,wrap:ln.wrap,fullyVisible:Bn,tileID:void 0,shouldSplit:void 0,minZ:ln.minZ,maxZ:ln.maxZ};x&&!$&&(vi.tileID=new s.OverscaledTileID(ln.zoom+1===an?Wn:ln.zoom+1,ln.wrap,ln.zoom+1,Di,$i),pn(vi)),qt.push(vi)}else{const Yn=ln.zoom===an?Wn:ln.zoom;if(o.minzoom&&o.minzoom>Yn)continue;const Di=H[0]-(.5+Mn+(ln.wrap<<ln.zoom))*(1<<c-ln.zoom),$i=H[1]-.5-jn,vi=ln.tileID?ln.tileID:new s.OverscaledTileID(Yn,ln.wrap,ln.zoom,Mn,jn);$t.push({tileID:vi,distanceSq:Di*Di+$i*$i})}}if(this.fogCullDistSq){const ln=this.fogCullDistSq,Mn=this.horizonLineFromTop();$t=$t.filter(jn=>{const Bn=[0,0,0,1],Yn=[s.EXTENT,s.EXTENT,0,1],Di=this.calculateFogTileMatrix(jn.tileID.toUnwrapped());s.transformMat4$1(Bn,Bn,Di),s.transformMat4$1(Yn,Yn,Di);const $i=s.getAABBPointSquareDist(Bn,Yn);if(0===$i)return!0;let vi=!1;const ki=this._elevation;if(ki&&$i>ln&&0!==Mn){const ho=this.calculateProjMatrix(jn.tileID.toUnwrapped());let fo;o.isTerrainDEM||(fo=ki.getMinMaxForTile(jn.tileID)),fo||(fo={min:ht,max:pt});const Ti=s.furthestTileCorner(this.rotation),Fo=[Ti[0]*s.EXTENT,Ti[1]*s.EXTENT,fo.max];s.transformMat4(Fo,Fo,ho),vi=(1-Fo[1])*this.height*.5<Mn}return $i<ln||vi})}return $t.sort((ln,Mn)=>ln.distanceSq-Mn.distanceSq).map(ln=>ln.tileID)}resize(o,c){this.width=o,this.height=c,this.pixelsToGLUnits=[2/o,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const c=s.clamp(o.lat,-s.MAX_MERCATOR_LATITUDE,s.MAX_MERCATOR_LATITUDE),m=this.projection.project(o.lng,c);return new s.Point(m.x*this.worldSize,m.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,c){let m,x;const C=this.centerPoint;if("globe"===this.projection.name){const O=this.worldSize;m=(c.x-C.x)/O,x=(c.y-C.y)/O}else{const O=this.pointCoordinate(c),N=this.pointCoordinate(C);m=O.x-N.x,x=O.y-N.y}const I=this.locationCoordinate(o);this.setLocation(new s.MercatorCoordinate(I.x-m,I.y-x))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,c){const m=c?s.mercatorZfromAltitude(c,o.lat):void 0,x=this.projection.project(o.lng,o.lat);return new s.MercatorCoordinate(x.x,x.y,m)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,c){const m=c??this._centerAltitude,x=[o.x,o.y,0,1],C=[o.x,o.y,1,1];s.transformMat4$1(x,x,this.pixelMatrixInverse),s.transformMat4$1(C,C,this.pixelMatrixInverse);const I=C[3];s.scale$1(x,x,1/x[3]),s.scale$1(C,C,1/I);const O=x[2],N=C[2];return{p0:x,p1:C,t:O===N?0:(m-O)/(N-O)}}screenPointToMercatorRay(o){const c=[o.x,o.y,0,1],m=[o.x,o.y,1,1];return s.transformMat4$1(c,c,this.pixelMatrixInverse),s.transformMat4$1(m,m,this.pixelMatrixInverse),s.scale$1(c,c,1/c[3]),s.scale$1(m,m,1/m[3]),c[2]=s.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,m[2]=s.mercatorZfromAltitude(m[2],this._center.lat)*this.worldSize,s.scale$1(c,c,1/this.worldSize),s.scale$1(m,m,1/this.worldSize),new s.Ray([c[0],c[1],c[2]],s.normalize([],s.sub([],m,c)))}rayIntersectionCoordinate(o){const{p0:c,p1:m,t:x}=o,C=s.mercatorZfromAltitude(c[2],this._center.lat),I=s.mercatorZfromAltitude(m[2],this._center.lat);return new s.MercatorCoordinate(s.number(c[0],m[0],x)/this.worldSize,s.number(c[1],m[1],x)/this.worldSize,s.number(C,I,x))}pointCoordinate(o,c=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,c)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let c=this.projection.pointCoordinate3D(this,o.x,o.y);if(c)return new s.MercatorCoordinate(c[0],c[1],c[2]);let m=0,x=this.horizonLineFromTop();if(o.y>x)return this.pointCoordinate(o);const C=.02*x,I=o.clone();for(let O=0;O<10&&x-m>C;O++){I.y=s.number(m,x,.66);const N=this.projection.pointCoordinate3D(this,I.x,I.y);N?(x=I.y,c=N):m=I.y}return c?new s.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const c=this.pointCoordinate(o);return c.y>=0&&c.y<=1}_coordinatePoint(o,c){const m=c&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,x=[o.x*this.worldSize,o.y*this.worldSize,m+o.toAltitude(),1];return s.transformMat4$1(x,x,this.pixelMatrix),x[3]>0?new s.Point(x[0]/x[3],x[1]/x[3]):new s.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:c}=this._edgeInsets,m=this.height-this._edgeInsets.bottom,x=this.width-this._edgeInsets.right,C=this.pointLocation3D(new s.Point(c,o)),I=this.pointLocation3D(new s.Point(x,o)),O=this.pointLocation3D(new s.Point(x,m)),N=this.pointLocation3D(new s.Point(c,m));let H=Math.min(C.lng,I.lng,O.lng,N.lng),$=Math.max(C.lng,I.lng,O.lng,N.lng),ce=Math.min(C.lat,I.lat,O.lat,N.lat),Ie=Math.max(C.lat,I.lat,O.lat,N.lat);const $e=Math.pow(2,-this.zoom)/16*270,Qe="globe"===this.projection.name?1:4,Ye=(ot,ue,He,pt,ht)=>{const Pt=(ot+He)/2,Lt=(ue+pt)/2,Ot=new s.Point(Pt,Lt),{lng:qt,lat:$t}=this.pointLocation3D(Ot),an=Math.max(0,H-qt,ce-$t,qt-$,$t-Ie);H=Math.min(H,qt),$=Math.max($,qt),ce=Math.min(ce,$t),Ie=Math.max(Ie,$t),(ht<Qe||an>$e)&&(Ye(ot,ue,Pt,Lt,ht+1),Ye(Pt,Lt,He,pt,ht+1))};if(Ye(c,o,x,o,1),Ye(x,o,x,m,1),Ye(x,m,c,m,1),Ye(c,m,c,o,1),"globe"===this.projection.name){const[ot,ue]=s.polesInViewport(this);ot?(Ie=90,$=180,H=-180):ue&&(ce=-90,$=180,H=-180)}return new s.LngLatBounds(new s.LngLat(H,ce),new s.LngLat($,Ie))}_getBoundsRectangular(o,c){const{top:m,left:x}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,I=this.width-this._edgeInsets.right,O=new s.Point(x,m),N=new s.Point(I,m),H=new s.Point(I,C),$=new s.Point(x,C);let ce=this.pointCoordinate(O,o),Ie=this.pointCoordinate(N,o);const $e=this.pointCoordinate(H,c),Qe=this.pointCoordinate($,c),Ye=(ot,ue)=>(ue.y-ot.y)/(ue.x-ot.x);return ce.y>1&&Ie.y>=0?ce=new s.MercatorCoordinate((1-Qe.y)/Ye(Qe,ce)+Qe.x,1):ce.y<0&&Ie.y<=1&&(ce=new s.MercatorCoordinate(-Qe.y/Ye(Qe,ce)+Qe.x,0)),Ie.y>1&&ce.y>=0?Ie=new s.MercatorCoordinate((1-$e.y)/Ye($e,Ie)+$e.x,1):Ie.y<0&&ce.y<=1&&(Ie=new s.MercatorCoordinate(-$e.y/Ye($e,Ie)+$e.x,0)),(new s.LngLatBounds).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(Ie)).extend(this.coordinateLocation(Qe)).extend(this.coordinateLocation($e))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=o.visibleDemTiles.reduce((m,x)=>{if(x.dem){const C=x.dem.tree;m.min=Math.min(m.min,C.minimums[0]),m.max=Math.max(m.max,C.maximums[0])}return m},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*o.exaggeration(),c.max*o.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,m=this.height/2-c*(1-this._horizonShift);return o?Math.max(0,m):m}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-s.MAX_MERCATOR_LATITUDE,this.maxLat=s.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=s.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=s.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=s.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,c){return this.projection.createTileMatrix(this,c,o)}calculateDistanceTileData(o){const c=o.key,m=this._distanceTileDataCache;if(m[c])return m[c];const x=o.canonical,C=1/this.height,I=this.cameraWorldSize,O=I/this.zoomScale(x.z),N=(x.x+Math.pow(2,x.z)*o.wrap)*O,H=x.y*O,$=this.point;$.x*=I/this.worldSize,$.y*=I/this.worldSize;const ce=this.angle,Ie=Math.sin(-ce),$e=-Math.cos(-ce);return m[c]={bearing:[Ie,$e],center:[($.x-N)*C,($.y-H)*C],scale:O/s.EXTENT*C},m[c]}calculateFogTileMatrix(o){const c=o.key,m=this._fogTileMatrixCache;if(m[c])return m[c];const x=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return s.multiply(x,this.worldToFogMatrix,x),m[c]=new Float32Array(x),m[c]}calculateProjMatrix(o,c=!1){const m=o.key,x=c?this._alignedProjMatrixCache:this._projMatrixCache;if(x[m])return x[m];const C=this.calculatePosMatrix(o,this.worldSize);return s.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,C),x[m]=new Float32Array(C),x[m]}calculatePixelsToTileUnitsMatrix(o){const c=o.tileID.key,m=this._pixelsToTileUnitsCache;if(m[c])return m[c];const x=function(C,I){const{scale:O}=C.tileTransform,N=O*s.EXTENT/(C.tileSize*Math.pow(2,I.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return H=new Float32Array(4),Ie=($=I.inverseAdjustmentMatrix)[1],$e=$[2],Qe=$[3],ot=(ce=[N,N])[1],H[0]=$[0]*(Ye=ce[0]),H[1]=Ie*Ye,H[2]=$e*ot,H[3]=Qe*ot,H;var H,$,ce,Ie,$e,Qe,Ye,ot}(o,this);return m[c]=x,m[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const o=1/this.worldSize,c=s.fromScaling([],[o,o,o]);return s.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const o=this._elevation;this._updateCameraState();const c=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,m=this._computeCameraPosition(c),x=this._camera.forward(),C=s.mercatorZfromAltitude(1,this._center.lat);m[2]/=C,x[2]/=C,s.normalize(x,x);const I=o.raycast(m,x,o.exaggeration());if(I){const O=s.scaleAndAdd([],m,x,I),N=new s.MercatorCoordinate(O[0],O[1],s.mercatorZfromAltitude(O[2],s.latFromMercatorY(O[1]))),H=(N.z+s.length([N.x-m[0],N.y-m[1],N.z-m[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(H),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const c=this._elevation,m=s.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(m),C=c.getAtPointOrZero(new s.MercatorCoordinate(...x)),I=this.pixelsPerMeter/this.worldSize*C,O=this._minimumHeightOverTerrain(),N=x[2]-I;if(N<=O)if(N<0||o){const H=this.locationCoordinate(this._center,this._centerAltitude),$=[x[0],x[1],H.z-x[2]],ce=s.length($);$[2]-=(O-N)/this._pixelsPerMercatorPixel;const Ie=s.length($);if(0===Ie)return;s.scale$2($,$,ce/Ie*this._pixelsPerMercatorPixel),this._camera.position=[x[0],x[1],H.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const Ie=this.center;return Ie.lat=s.clamp(Ie.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(Ie.lng=s.clamp(Ie.lng,this.minLng,this.maxLng)),this.center=Ie,void(this._constraining=!1)}const c=this._unmodified,{x:m,y:x}=this.point;let C=0,I=m,O=x;const N=this.width/2,H=this.height/2,$=this.worldMinY*this.scale,ce=this.worldMaxY*this.scale;if(x-H<$&&(O=$+H),x+H>ce&&(O=ce-H),ce-$<this.height&&(C=Math.max(C,this.height/(ce-$)),O=(ce+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Ie=this.worldMinX*this.scale,$e=this.worldMaxX*this.scale,Qe=this.worldSize/2-(Ie+$e)/2;I=(m+Qe+this.worldSize)%this.worldSize-Qe,I-N<Ie&&(I=Ie+N),I+N>$e&&(I=$e-N),$e-Ie<this.width&&(C=Math.max(C,this.width/($e-Ie)),I=($e+Ie)/2)}I===m&&O===x||(this.center=this.unproject(new s.Point(I,O))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,c=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=s.mercatorZfromAltitude(1,this.center.lat)/s.mercatorZfromAltitude(1,s.GLOBE_SCALE_MATCH_LATITUDE));const m=Ro(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,m),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const x="meters"===this.projection.zAxisUnit?c:1,C=this._camera.getWorldToCamera(this.worldSize,x),I=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);I[8]=2*-o.x/this.width,I[9]=2*o.y/this.height;let O=s.mul([],I,C);if(this.projection.isReprojectedInTileSpace){const Lt=this.locationCoordinate(this.center),Ot=s.identity([]);s.translate(Ot,Ot,[Lt.x*this.worldSize,Lt.y*this.worldSize,0]),s.multiply(Ot,Ot,lo(this)),s.translate(Ot,Ot,[-Lt.x*this.worldSize,-Lt.y*this.worldSize,0]),s.multiply(O,O,Ot),this.inverseAdjustmentMatrix=function(qt){const $t=lo(qt,!0);return Ce([],[$t[0],$t[1],$t[4],$t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=s.scale([],O,[this.worldSize,this.worldSize,this.worldSize/x,1]),this.projMatrix=O,this.invProjMatrix=s.invert(new Float64Array(16),this.projMatrix);const N=s.invert([],I);this.frustumCorners=s.FrustumCorners.fromInvProjectionMatrix(N,this.horizonLineFromTop(),this.height);const H=new Float32Array(16);s.identity(H),s.scale(H,H,[1,-1,1]),s.rotateX(H,H,this._pitch),s.rotateZ(H,H,this.angle);const $=s.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),ce=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;$[8]=2*-o.x/this.width,$[9]=2*(o.y+ce)/this.height,this.skyboxMatrix=s.multiply(H,$,H);const Ie=this.point,$e=Ie.x,Qe=Ie.y,Ye=this.width%2/2,ot=this.height%2/2,ue=Math.cos(this.angle),He=Math.sin(this.angle),pt=$e-Math.round($e)+ue*Ye+He*ot,ht=Qe-Math.round(Qe)+ue*ot+He*Ye,Pt=new Float64Array(O);if(s.translate(Pt,Pt,[pt>.5?pt-1:pt,ht>.5?ht-1:ht,0]),this.alignedProjMatrix=Pt,O=s.create(),s.scale(O,O,[this.width/2,-this.height/2,1]),s.translate(O,O,[1,-1,0]),this.labelPlaneMatrix=O,O=s.create(),s.scale(O,O,[1,-1,1]),s.translate(O,O,[-1,-1,0]),s.scale(O,O,[2/this.width,2/this.height,1]),this.glCoordMatrix=O,this.pixelMatrix=s.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},O=s.invert(new Float64Array(16),this.pixelMatrix),!O)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=O,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=s.calculateGlobeMatrix(this);const Lt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.transformMat4(Lt,Lt,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=O;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,m=this._camera.position,x=1/this.height/this._pixelsPerMercatorPixel,C=[o,o,c];s.scale$2(C,C,x),s.scale$2(m,m,-1),s.multiply$2(m,m,C);const I=s.create();s.translate(I,I,m),s.scale(I,I,C),this.mercatorFogMatrix=I,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,c,x)}_computeCameraPosition(o){const c=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,m=this._camera.forward(),x=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-o/this.worldSize*this._centerAltitude;return[x.x/this.worldSize-m[0]*C,x.y/this.worldSize-m[1]*C,o/this.worldSize*this._centerAltitude-m[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),m=this._camera.position[2],x=o[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),x>0&&(C=Math.min((c-m)/x,1)),this._camera.position=s.scaleAndAdd([],this._camera.position,o,C),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,c=this._camera.forward(),{pitch:m,bearing:x}=this._camera.getPitchBearing(),C=s.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,I=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.degToRad(this._maxPitch)),O=Math.max((o[2]-C)/Math.cos(m),I),N=this._zoomFromMercatorZ(O);s.scaleAndAdd(o,o,c,O),this._pitch=s.clamp(m,s.degToRad(this.minPitch),s.degToRad(this.maxPitch)),this.angle=s.wrap(x,-Math.PI,Math.PI),this._setZoom(s.clamp(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let c=0,m=s.GLOBE_ZOOM_THRESHOLD_MAX,x=0,C=1/0;for(;m-c>1e-6&&m>c;){const I=c+.5*(m-c),O=this.tileSize*Math.pow(2,I),N=this.getCameraToCenterDistance(this.projection,I,O),H=this.scaleZoom(N/(o*this.tileSize)),$=Math.abs(I-H);$<C&&(C=$,x=I),I<H?c=I:m=I}return x}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,c){const m=Math.min(o.x,c.x),x=Math.max(o.x,c.x),C=Math.min(o.y,c.y),I=Math.max(o.y,c.y);if(C<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const O=[new s.Point(m,C),new s.Point(x,I),new s.Point(m,I),new s.Point(x,C)],N=this.renderWorldCopies?-3:0,H=this.renderWorldCopies?4:1;for(const $ of O){const ce=this.pointRayIntersection($);if(ce.t<0)return!0;const Ie=this.rayIntersectionCoordinate(ce);if(Ie.x<N||Ie.y<0||Ie.x>H||Ie.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.Point(0,0),new s.Point(this.width,this.height))}zoomDeltaToMovement(o,c){const m=s.length(s.sub([],this._camera.position,o)),x=this._zoomFromMercatorZ(m)+c;return m-this._mercatorZfromZoom(x)}getCameraPoint(){if("globe"===this.projection.name){const o=function([c,m,x],C){const I=[c,m,x,1];s.transformMat4$1(I,I,C);const O=I[3]=Math.max(I[3],1e-6);return I[0]/=O,I[1]/=O,I[2]/=O,I}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.Point(0,o))}}getCameraToCenterDistance(o,c=this.zoom,m=this.worldSize){const x=Ro(o,c,this.width,this.height,1024),C=o.pixelSpaceConversion(this.center.lat,m,x);return.5/Math.tan(.5*this._fov)*this.height*C}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&s.multiply(o,o,this.globeMatrix),o}}function Vr(p,o){let c=!1,m=null;const x=()=>{m=null,c&&(p(),m=setTimeout(x,o),c=!1)};return()=>(c=!0,m||x(),m)}class qs{constructor(o){this._hashName=o&&encodeURIComponent(o),s.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Vr(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,s.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),s.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const c=os(o);if(this._hashName){const m=this._hashName;let x=!1;const C=s.window.location.hash.slice(1).split("&").map(I=>{const O=I.split("=")[0];return O===m?(x=!0,`${O}=${c}`):I}).filter(I=>I);return x||C.push(`${m}=${c}`),`#${C.join("&")}`}return`#${c}`}_getCurrentHash(){const o=s.window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(m=>m.split("=")).forEach(m=>{m[0]===this._hashName&&(c=m)}),(c&&c[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(m=>isNaN(m))){const m=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(c[3]||0):o.getBearing();return o.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:m,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=s.window.location.href.replace(/(#.+)?$/,this.getHashString());s.window.history.replaceState(s.window.history.state,null,o)}}function os(p,o){const c=p.getCenter(),m=Math.round(100*p.getZoom())/100,x=Math.ceil((m*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,x),I=Math.round(c.lng*C)/C,O=Math.round(c.lat*C)/C,N=p.getBearing(),H=p.getPitch();let $=o?`/${I}/${O}/${m}`:`${m}/${O}/${I}`;return(N||H)&&($+="/"+Math.round(10*N)/10),H&&($+=`/${Math.round(H)}`),$}const Ni={linearity:.3,easing:s.bezier(0,0,.3,1)},Zl=s.extend({deceleration:2500,maxSpeed:1400},Ni),ms=s.extend({deceleration:20,maxSpeed:1400},Ni),ui=s.extend({deceleration:1e3,maxSpeed:360},Ni),sa=s.extend({deceleration:1e3,maxSpeed:90},Ni);class gu{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,c=s.exported.now();for(;o.length>0&&c-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const c={zoom:0,bearing:0,pitch:0,pan:new s.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)c.zoom+=C.zoomDelta||0,c.bearing+=C.bearingDelta||0,c.pitch+=C.pitchDelta||0,C.panDelta&&c.pan._add(C.panDelta),C.around&&(c.around=C.around),C.pinchAround&&(c.pinchAround=C.pinchAround);const m=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,x={};if(c.pan.mag()){const C=ga(c.pan.mag(),m,s.extend({},Zl,o||{}));x.offset=c.pan.mult(C.amount/c.pan.mag()),x.center=this._map.transform.center,gl(x,C)}if(c.zoom){const C=ga(c.zoom,m,ms);x.zoom=this._map.transform.zoom+C.amount,gl(x,C)}if(c.bearing){const C=ga(c.bearing,m,ui);x.bearing=this._map.transform.bearing+s.clamp(C.amount,-179,179),gl(x,C)}if(c.pitch){const C=ga(c.pitch,m,sa);x.pitch=this._map.transform.pitch+C.amount,gl(x,C)}if(x.zoom||x.bearing){const C=void 0===c.pinchAround?c.around:c.pinchAround;x.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),x.noMoveStart=!0,x}}function gl(p,o){(!p.duration||p.duration<o.duration)&&(p.duration=o.duration,p.easing=o.easing)}function ga(p,o,c){const{maxSpeed:m,linearity:x,deceleration:C}=c,I=s.clamp(p*x/(o/1e3),-m,m),O=Math.abs(I)/(C*x);return{easing:c.easing,duration:1e3*O,amount:I*(O/2)}}class qo extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,m,x={}){const C=Me(c.getCanvasContainer(),m),I=c.unproject(C);super(o,s.extend({point:C,lngLat:I,originalEvent:m},x)),this._defaultPrevented=!1,this.target=c}}class Vl extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,m){const x="touchend"===o?m.changedTouches:m.touches,C=ze(c.getCanvasContainer(),x),I=C.map(N=>c.unproject(N)),O=C.reduce((N,H,$,ce)=>N.add(H.div(ce.length)),new s.Point(0,0));super(o,{points:C,point:O,lngLats:I,lngLat:c.unproject(O),originalEvent:m}),this._defaultPrevented=!1}}class Ka extends s.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,c,m){super(o,{originalEvent:m}),this._defaultPrevented=!1}}class Zc{constructor(o,c){this._map=o,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Ka(o.type,this._map,o))}mousedown(o,c){return this._mousedownPos=c,this._firePreventable(new qo(o.type,this._map,o))}mouseup(o){this._map.fire(new qo(o.type,this._map,o))}preclick(o){const c=s.extend({},o);c.type="preclick",this._map.fire(new qo(c.type,this._map,c))}click(o,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(o),this._map.fire(new qo(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new qo(o.type,this._map,o))}mouseover(o){this._map.fire(new qo(o.type,this._map,o))}mouseout(o){this._map.fire(new qo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new Vl(o.type,this._map,o))}touchmove(o){this._map.fire(new Vl(o.type,this._map,o))}touchend(o){this._map.fire(new Vl(o.type,this._map,o))}touchcancel(o){this._map.fire(new Vl(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class dc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new qo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new qo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new qo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Gn{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,c){this.isEnabled()&&o.shiftKey&&0===o.button&&(Te(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(o,c){if(!this._active)return;const m=c,x=this._startPos,C=this._lastPos;if(!x||!C||C.equals(m)||!this._box&&m.dist(x)<this._clickTolerance)return;this._lastPos=m,this._box||(this._box=fe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const I=Math.min(x.x,m.x),O=Math.max(x.x,m.x),N=Math.min(x.y,m.y),H=Math.max(x.y,m.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${I}px,${N}px)`,this._box.style.width=O-I+"px",this._box.style.height=H-N+"px")})}mouseupWindow(o,c){if(!this._active)return;const m=this._startPos,x=c;if(m&&0===o.button){if(this.reset(),Le(),m.x!==x.x||m.y!==x.y)return this._map.fire(new s.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:C=>C.fitScreenCoordinates(m,x,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&27===o.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ge(),delete this._startPos,delete this._lastPos}_fireEvent(o,c){return this._map.fire(new s.Event(o,{originalEvent:c}))}}function Do(p,o){const c={};for(let m=0;m<p.length;m++)c[p[m].identifier]=o[m];return c}class _l{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,c,m){(this.centroid||m.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=o.timeStamp),m.length===this.numTouches&&(this.centroid=function(x){const C=new s.Point(0,0);for(const I of x)C._add(I);return C.div(x.length)}(c),this.touches=Do(m,c)))}touchmove(o,c,m){if(this.aborted||!this.centroid)return;const x=Do(m,c);for(const C in this.touches){const I=x[C];(!I||I.dist(this.touches[C])>30)&&(this.aborted=!0)}}touchend(o,c,m){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),0===m.length){const x=!this.aborted&&this.centroid;if(this.reset(),x)return x}}}class hc{constructor(o){this.singleTap=new _l(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,c,m){this.singleTap.touchstart(o,c,m)}touchmove(o,c,m){this.singleTap.touchmove(o,c,m)}touchend(o,c,m){const x=this.singleTap.touchend(o,c,m);if(x){const C=o.timeStamp-this.lastTime<500,I=!this.lastTap||this.lastTap.dist(x)<30;if(C&&I||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=x,this.count===this.numTaps)return this.reset(),x}}}class jr{constructor(){this._zoomIn=new hc({numTouches:1,numTaps:2}),this._zoomOut=new hc({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,c,m){this._zoomIn.touchstart(o,c,m),this._zoomOut.touchstart(o,c,m)}touchmove(o,c,m){this._zoomIn.touchmove(o,c,m),this._zoomOut.touchmove(o,c,m)}touchend(o,c,m){const x=this._zoomIn.touchend(o,c,m),C=this._zoomOut.touchend(o,c,m);return x?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()+1,around:I.unproject(x)},{originalEvent:o})}):C?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:I=>I.easeTo({duration:300,zoom:I.getZoom()-1,around:I.unproject(C)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const pc={0:1,2:2};class Aa{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,c){return!1}_move(o,c){return{}}mousedown(o,c){if(this._lastPoint)return;const m=Ke(o);this._correctButton(o,m)&&(this._lastPoint=c,this._eventButton=m)}mousemoveWindow(o,c){const m=this._lastPoint;if(m)if(o.preventDefault(),null!=this._eventButton&&function(x,C){const I=pc[C];return void 0===x.buttons||(x.buttons&I)!==I}(o,this._eventButton))this.reset();else if(this._moved||!(c.dist(m)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(m,c)}mouseupWindow(o){this._lastPoint&&Ke(o)===this._eventButton&&(this._moved&&Le(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ks extends Aa{mousedown(o,c){super.mousedown(o,c),this._lastPoint&&(this._active=!0)}_correctButton(o,c){return 0===c&&!o.ctrlKey}_move(o,c){return{around:c,panDelta:c.sub(o)}}}class Fs extends Aa{_correctButton(o,c){return 0===c&&o.ctrlKey||2===c}_move(o,c){const m=.8*(c.x-o.x);if(m)return this._active=!0,{bearingDelta:m}}contextmenu(o){o.preventDefault()}}class jl extends Aa{_correctButton(o,c){return 0===c&&o.ctrlKey||2===c}_move(o,c){const m=-.5*(c.y-o.y);if(m)return this._active=!0,{pitchDelta:m}}contextmenu(o){o.preventDefault()}}class Vc{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),s.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.Point(0,0)}touchstart(o,c,m){return this._calculateTransform(o,c,m)}touchmove(o,c,m){if(this._active&&!(m.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===m.length&&!s.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,c,m)}}touchend(o,c,m){this._calculateTransform(o,c,m),this._active&&m.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,c,m){m.length>0&&(this._active=!0);const x=Do(m,c),C=new s.Point(0,0),I=new s.Point(0,0);let O=0;for(const H in x){const $=x[H],ce=this._touches[H];ce&&(C._add($),I._add($.sub(ce)),O++,x[H]=$)}if(this._touches=x,O<this._minTouches||!I.mag())return;const N=I.div(O);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(O),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class jc{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,c,m){return{}}touchstart(o,c,m){this._firstTwoTouches||m.length<2||(this._firstTwoTouches=[m[0].identifier,m[1].identifier],this._start([c[0],c[1]]))}touchmove(o,c,m){const x=this._firstTwoTouches;if(!x)return;o.preventDefault();const[C,I]=x,O=$l(m,c,C),N=$l(m,c,I);if(!O||!N)return;const H=this._aroundCenter?null:O.add(N).div(2);return this._move([O,N],H,o)}touchend(o,c,m){if(!this._firstTwoTouches)return;const[x,C]=this._firstTwoTouches,I=$l(m,c,x),O=$l(m,c,C);I&&O||(this._active&&Le(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function $l(p,o,c){for(let m=0;m<p.length;m++)if(p[m].identifier===c)return o[m]}function Wr(p,o){return Math.log(p/o)/Math.LN2}class aa extends jc{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,c){const m=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Wr(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Wr(this._distance,m),pinchAround:c}}}function yl(p,o){return 180*p.angleWith(o)/Math.PI}class Xa extends jc{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,c){const m=this._vector;if(this._vector=o[0].sub(o[1]),m&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:yl(this._vector,m),pinchAround:c}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const c=25/(Math.PI*this._minDiameter)*360,m=this._startVector;if(!m)return!1;const x=yl(o,m);return Math.abs(x)<c}}function rs(p){return Math.abs(p.y)>Math.abs(p.x)}class md extends jc{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,rs(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,c,m){const x=this._lastPoints;if(!x)return;const C=o[0].sub(x[0]),I=o[1].sub(x[1]);return this._map._cooperativeGestures&&!s.isFullscreen()&&m.touches.length<3||(this._valid=this.gestureBeginsVertically(C,I,m.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(C.y+I.y)/2*-.5})}gestureBeginsVertically(o,c,m){if(void 0!==this._valid)return this._valid;const x=o.mag()>=2,C=c.mag()>=2;if(!x&&!C)return;if(!x||!C)return null==this._firstMove&&(this._firstMove=m),m-this._firstMove<100&&void 0;const I=o.y>0==c.y>0;return rs(o)&&rs(c)&&I}}const fc={panStep:100,bearingStep:15,pitchStep:10};class gd{constructor(){const o=fc;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let c=0,m=0,x=0,C=0,I=0;switch(o.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:o.shiftKey?m=-1:(o.preventDefault(),C=-1);break;case 39:o.shiftKey?m=1:(o.preventDefault(),C=1);break;case 38:o.shiftKey?x=1:(o.preventDefault(),I=-1);break;case 40:o.shiftKey?x=-1:(o.preventDefault(),I=1);break;default:return}return this._rotationDisabled&&(m=0,x=0),{cameraAnimation:O=>{const N=O.getZoom();O.easeTo({duration:300,easeId:"keyboardHandler",easing:_d,zoom:c?Math.round(N)+c*(o.shiftKey?2:1):N,bearing:O.getBearing()+m*this._bearingStep,pitch:O.getPitch()+x*this._pitchStep,offset:[-C*this._panStep,-I*this._panStep],center:O.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function _d(p){return p*(2-p)}const mc=4.000244140625;class $c{constructor(o,c){this._map=o,this._el=o.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,s.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&"center"===o.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||s.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=o.deltaMode===s.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const m=s.exported.now(),x=m-(this._lastWheelEventTime||0);this._lastWheelEventTime=m,0!==c&&c%mc==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":x>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(x*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),o.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=o,this._delta-=c,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=Me(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;"wheel"===this._type&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(0!==this._delta){const N="wheel"===this._type&&Math.abs(this._delta)>mc?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*N)));this._delta<0&&0!==H&&(H=1/H);const $=c(),ce=Math.pow(2,$),Ie="number"==typeof this._targetZoom?o.zoomScale(this._targetZoom):ce;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(Ie*H))),"wheel"===this._type&&(this._startZoom=$,this._easing=this._smoothOutEasing(200)),this._delta=0}const m="number"==typeof this._targetZoom?this._targetZoom:c(),x=this._startZoom,C=this._easing;let I,O=!1;if("wheel"===this._type&&x&&C){const N=Math.min((s.exported.now()-this._lastWheelEventTime)/200,1),H=C(N);I=s.number(x,m,H),N<1?this._frameId||(this._frameId=!0):O=!0}else I=m,O=!0;return this._active=!0,O&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!O,zoomDelta:I-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let c=s.ease;if(this._prevEase){const m=this._prevEase,x=(s.exported.now()-m.start)/m.duration,C=m.easing(x+.01)-m.easing(x),I=.27/Math.sqrt(C*C+1e-4)*.01,O=Math.sqrt(.0729-I*I);c=s.bezier(I,O,.25,1)}return this._prevEase={start:s.exported.now(),duration:o,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(s.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Hc{constructor(o,c){this._clickZoom=o,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class es{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,c){return o.preventDefault(),{cameraAnimation:m=>{m.easeTo({duration:300,zoom:m.getZoom()+(o.shiftKey?-1:1),around:m.unproject(c)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class _u{constructor(){this._tap=new hc({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,c,m){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?m.length>0&&(this._swipePoint=c[0],this._swipeTouch=m[0].identifier):this._tap.touchstart(o,c,m))}touchmove(o,c,m){if(this._tapTime){if(this._swipePoint){if(m[0].identifier!==this._swipeTouch)return;const x=c[0],C=x.y-this._swipePoint.y;return this._swipePoint=x,o.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(o,c,m)}touchend(o,c,m){this._tapTime?this._swipePoint&&0===m.length&&this.reset():this._tap.touchend(o,c,m)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Gc{constructor(o,c,m){this._el=o,this._mousePan=c,this._touchPan=m}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Wc{constructor(o,c,m){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=c,this._mousePitch=m}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class yu{constructor(o,c,m,x){this._el=o,this._touchZoom=c,this._touchRotate=m,this._tapDragZoom=x,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Bs=p=>p.zoom||p.drag||p.pitch||p.rotate;class qc extends s.Event{}class vu{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,c){const m=s.sub([],c,o);this.radius=s.length(m[2]<0?s.div([],m,this.constants):[m[0],m[1],0])}projectRay(o){s.div(o,o,this.constants),s.normalize(o,o),s.mul$1(o,o,this.constants);const c=s.scale$2([],o,this.radius);if(c[2]>0){const m=s.scale$2([],[0,0,1],s.dot(c,[0,0,1])),x=s.scale$2([],s.normalize([],[c[0],c[1],0]),this.radius),C=s.add([],c,s.scale$2([],s.sub([],s.add([],x,m),c),2));c[0]=C[0],c[1]=C[1]}return c}}function Ns(p){return p.panDelta&&p.panDelta.mag()||p.zoomDelta||p.bearingDelta||p.pitchDelta}class _a{constructor(o,c){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new gu(o),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new vu,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),s.bindAll(["handleEvent","handleWindowEvent"],this);const m=this._el;this._listeners=[[m,"touchstart",{passive:!0}],[m,"touchmove",{passive:!1}],[m,"touchend",void 0],[m,"touchcancel",void 0],[m,"mousedown",void 0],[m,"mousemove",void 0],[m,"mouseup",void 0],[s.window.document,"mousemove",{capture:!0}],[s.window.document,"mouseup",void 0],[m,"mouseover",void 0],[m,"mouseout",void 0],[m,"dblclick",void 0],[m,"click",void 0],[m,"keydown",{capture:!1}],[m,"keyup",void 0],[m,"wheel",{passive:!1}],[m,"contextmenu",void 0],[s.window,"blur",void 0]];for(const[x,C,I]of this._listeners)x.addEventListener(C,x===s.window.document?this.handleWindowEvent:this.handleEvent,I)}destroy(){for(const[o,c,m]of this._listeners)o.removeEventListener(c,o===s.window.document?this.handleWindowEvent:this.handleEvent,m)}_addDefaultHandlers(o){const c=this._map,m=c.getCanvasContainer();this._add("mapEvent",new Zc(c,o));const x=c.boxZoom=new Gn(c,o);this._add("boxZoom",x);const C=new jr,I=new es;c.doubleClickZoom=new Hc(I,C),this._add("tapZoom",C),this._add("clickZoom",I);const O=new _u;this._add("tapDragZoom",O);const N=c.touchPitch=new md(c);this._add("touchPitch",N);const H=new Fs(o),$=new jl(o);c.dragRotate=new Wc(o,H,$),this._add("mouseRotate",H,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const ce=new ks(o),Ie=new Vc(c,o);c.dragPan=new Gc(m,ce,Ie),this._add("mousePan",ce),this._add("touchPan",Ie,["touchZoom","touchRotate"]);const $e=new Xa,Qe=new aa;c.touchZoomRotate=new yu(m,Qe,$e,O),this._add("touchRotate",$e,["touchPan","touchZoom"]),this._add("touchZoom",Qe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new dc(c));const Ye=c.scrollZoom=new $c(c,this);this._add("scrollZoom",Ye,["mousePan"]);const ot=c.keyboard=new gd;this._add("keyboard",ot);for(const ue of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[ue]&&c[ue].enable(o[ue])}_add(o,c,m){this._handlers.push({handlerName:o,handler:c,allowed:m}),this._handlersById[o]=c}stop(o){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Bs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,c,m){for(const x in o)if(x!==m&&(!c||c.indexOf(x)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const c=[];for(const m of o)this._el.contains(m.target)&&c.push(m);return c}handleEvent(o,c){this._updatingCamera=!0;const m="renderFrame"===o.type,x=m?void 0:o,C={needsRenderFrame:!1},I={},O={},N=o.touches?this._getMapTouches(o.touches):void 0,H=N?ze(this._el,N):m?void 0:Me(this._el,o);for(const{handlerName:Ie,handler:$e,allowed:Qe}of this._handlers){if(!$e.isEnabled())continue;let Ye;this._blockedByActive(O,Qe,Ie)?$e.reset():$e[c||o.type]&&(Ye=$e[c||o.type](o,H,N),this.mergeHandlerResult(C,I,Ye,Ie,x),Ye&&Ye.needsRenderFrame&&this._triggerRenderFrame()),(Ye||$e.isActive())&&(O[Ie]=$e)}const $={};for(const Ie in this._previousActiveHandlers)O[Ie]||($[Ie]=x);this._previousActiveHandlers=O,(Object.keys($).length||Ns(C))&&(this._changes.push([C,I,$]),this._triggerRenderFrame()),(Object.keys(O).length||Ns(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:ce}=C;ce&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],ce(this._map))}mergeHandlerResult(o,c,m,x,C){if(!m)return;s.extend(o,m);const I={handlerName:x,originalEvent:m.originalEvent||C};void 0!==m.zoomDelta&&(c.zoom=I),void 0!==m.panDelta&&(c.drag=I),void 0!==m.pitchDelta&&(c.pitch=I),void 0!==m.bearingDelta&&(c.rotate=I)}_applyChanges(){const o={},c={},m={};for(const[x,C,I]of this._changes)x.panDelta&&(o.panDelta=(o.panDelta||new s.Point(0,0))._add(x.panDelta)),x.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+x.zoomDelta),x.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+x.bearingDelta),x.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+x.pitchDelta),void 0!==x.around&&(o.around=x.around),void 0!==x.aroundCoord&&(o.aroundCoord=x.aroundCoord),void 0!==x.pinchAround&&(o.pinchAround=x.pinchAround),x.noInertia&&(o.noInertia=x.noInertia),s.extend(c,C),s.extend(m,I);this._updateMapTransform(o,c,m),this._changes=[]}_updateMapTransform(o,c,m){const x=this._map,C=x.transform,I=He=>[He.x,He.y,He.z];if((He=>{const pt=this._eventsInProgress.drag;return pt&&!this._handlersById[pt.handlerName].isActive()})()&&!Ns(o)){const He=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",He!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&x._stop(!0),!Ns(o))return void this._fireEvents(c,m,!0);let{panDelta:O,zoomDelta:N,bearingDelta:H,pitchDelta:$,around:ce,aroundCoord:Ie,pinchAround:$e}=o;C._isCameraConstrained&&(N>0&&(N=0),C._isCameraConstrained=!1),void 0!==$e&&(ce=$e),(N||(He=>c.drag&&!this._eventsInProgress.drag)())&&ce&&(this._dragOrigin=I(C.pointCoordinate3D(ce)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",x._stop(!0),ce=ce||x.transform.centerPoint,H&&(C.bearing+=H),$&&(C.pitch+=$),C._updateCameraState();const Qe=[0,0,0];if(O)if("mercator"===C.projection.name){const He=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(ce).dir),pt=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(ce.sub(O)).dir);Qe[0]=pt[0]-He[0],Qe[1]=pt[1]-He[1]}else{const He=C.pointCoordinate(ce);if("globe"===C.projection.name){O=O.rotate(-C.angle);const pt=C._pixelsPerMercatorPixel/C.worldSize;Qe[0]=-O.x*s.mercatorScale(s.latFromMercatorY(He.y))*pt,Qe[1]=-O.y*s.mercatorScale(C.center.lat)*pt}else{const pt=C.pointCoordinate(ce.sub(O));He&&pt&&(Qe[0]=pt.x-He.x,Qe[1]=pt.y-He.y)}}const Ye=C.zoom,ot=[0,0,0];if(N){const He=I(Ie||C.pointCoordinate3D(ce)),pt={dir:s.normalize([],s.sub([],He,C._camera.position))};if(pt.dir[2]<0){const ht=C.zoomDeltaToMovement(He,N);s.scale$2(ot,pt.dir,ht)}}const ue=s.add(Qe,Qe,ot);C._translateCameraConstrained(ue),N&&Math.abs(C.zoom-Ye)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(c,m,!0)}_fireEvents(o,c,m){const x=Bs(this._eventsInProgress),C=Bs(o),I={};for(const $ in o){const{originalEvent:ce}=o[$];this._eventsInProgress[$]||(I[`${$}start`]=ce),this._eventsInProgress[$]=o[$]}!x&&C&&this._fireEvent("movestart",C.originalEvent);for(const $ in I)this._fireEvent($,I[$]);C&&this._fireEvent("move",C.originalEvent);for(const $ in o){const{originalEvent:ce}=o[$];this._fireEvent($,ce)}const O={};let N;for(const $ in this._eventsInProgress){const{handlerName:ce,originalEvent:Ie}=this._eventsInProgress[$];this._handlersById[ce].isActive()||(delete this._eventsInProgress[$],N=c[ce]||Ie,O[`${$}end`]=N)}for(const $ in O)this._fireEvent($,O[$]);const H=Bs(this._eventsInProgress);if(m&&(x||C)&&!H){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),ce=Ie=>0!==Ie&&-this._bearingSnap<Ie&&Ie<this._bearingSnap;$?(ce($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:N})):(this._map.fire(new s.Event("moveend",{originalEvent:N})),ce(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,c){this._map.fire(new s.Event(o,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new qc("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const za="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class qr extends s.Evented{constructor(o,c){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=c.bearingSnap,this._respectPrefersReducedMotion=!1!==c.respectPrefersReducedMotion,s.bindAll(["_renderFrameCallback"],this)}getCenter(){return new s.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,c){return this.jumpTo({center:o},c)}panBy(o,c,m){return o=s.Point.convert(o).mult(-1),this.panTo(this.transform.center,s.extend({offset:o},c),m)}panTo(o,c,m){return this.easeTo(s.extend({center:o},c),m)}getZoom(){return this.transform.zoom}setZoom(o,c){return this.jumpTo({zoom:o},c),this}zoomTo(o,c,m){return this.easeTo(s.extend({zoom:o},c),m)}zoomIn(o,c){return this.zoomTo(this.getZoom()+1,o,c),this}zoomOut(o,c){return this.zoomTo(this.getZoom()-1,o,c),this}getBearing(){return this.transform.bearing}setBearing(o,c){return this.jumpTo({bearing:o},c),this}getPadding(){return this.transform.padding}setPadding(o,c){return this.jumpTo({padding:o},c),this}rotateTo(o,c,m){return this.easeTo(s.extend({bearing:o},c),m)}resetNorth(o,c){return this.rotateTo(0,s.extend({duration:1e3},o),c),this}resetNorthPitch(o,c){return this.easeTo(s.extend({bearing:0,pitch:0,duration:1e3},o),c),this}snapToNorth(o,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,c):this}getPitch(){return this.transform.pitch}setPitch(o,c){return this.jumpTo({pitch:o},c),this}cameraForBounds(o,c){o=s.LngLatBounds.convert(o);const m=c&&c.bearing||0,x=c&&c.pitch||0,C=o.getNorthWest(),I=o.getSouthEast();return this._cameraForBounds(this.transform,C,I,m,x,c)}_extendCameraOptions(o){const c={top:0,bottom:0,right:0,left:0};if("number"==typeof(o=s.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding){const m=o.padding;o.padding={top:m,bottom:m,right:m,left:m}}return o.padding=s.extend(c,o.padding),o}_minimumAABBFrustumDistance(o,c){const m=c.max[0]-c.min[0],x=c.max[1]-c.min[1];return m/x>o.aspect?m/(2*Math.tan(.5*o.fovX)*o.aspect):x/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,c,m,x,C,I){const O=o.clone(),N=this._extendCameraOptions(I);O.bearing=x,O.pitch=C;const H=s.LngLat.convert(c),$=s.LngLat.convert(m),ce=.5*(H.lat+$.lat),Ie=.5*(H.lng+$.lng),$e=s.latLngToECEF(ce,Ie),Qe=s.normalize([],$e),Ye=s.normalize([],s.cross([],Qe,[0,1,0])),ot=s.cross([],Ye,Qe),ue=[Ye[0],Ye[1],Ye[2],0,ot[0],ot[1],ot[2],0,Qe[0],Qe[1],Qe[2],0,0,0,0,1],He=[$e,s.latLngToECEF(H.lat,H.lng),s.latLngToECEF($.lat,H.lng),s.latLngToECEF($.lat,$.lng),s.latLngToECEF(H.lat,$.lng),s.latLngToECEF(ce,H.lng),s.latLngToECEF(ce,$.lng),s.latLngToECEF(H.lat,Ie),s.latLngToECEF($.lat,Ie)];let pt=s.Aabb.fromPoints(He.map(Bn=>[s.dot(Ye,Bn),s.dot(ot,Bn),s.dot(Qe,Bn)]));const ht=s.transformMat4([],pt.center,ue);0===s.squaredLength(ht)&&s.set(ht,0,0,1),s.normalize(ht,ht),s.scale$2(ht,ht,s.GLOBE_RADIUS),O.center=s.ecefToLatLng(ht);const Pt=O.getWorldToCameraMatrix(),Lt=s.invert(new Float64Array(16),Pt);pt=s.Aabb.applyTransform(pt,s.multiply([],Pt,ue)),s.transformMat4(ht,ht,Pt);const Ot=.5*(pt.max[2]-pt.min[2]),qt=this._minimumAABBFrustumDistance(O,pt),$t=s.scale$2([],[0,0,1],Ot),an=s.add($t,ht,$t),Wn=qt+(0===O.pitch?0:s.distance(ht,an)),nn=O.globeCenterInViewSpace,An=s.sub([],ht,[nn[0],nn[1],nn[2]]);s.normalize(An,An),s.scale$2(An,An,Wn);const pn=s.add([],ht,An);s.transformMat4(pn,pn,Lt);const $n=s.earthRadius/s.GLOBE_RADIUS,ln=s.length(pn),Mn=s.mercatorZfromAltitude(Math.max(ln*$n-s.earthRadius,Number.EPSILON),0),jn=Math.min(O.zoomFromMercatorZAdjusted(Mn),N.maxZoom);return jn>.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"mercator"}),O.zoom=jn,this._cameraForBounds(O,c,m,x,C,I)):{center:O.center,zoom:jn,bearing:x,pitch:C}}queryTerrainElevation(o,c){const m=this.transform.elevation;return m?(c=s.extend({},{exaggerated:!0},c),m.getAtPoint(s.MercatorCoordinate.fromLngLat(o),null,c.exaggerated)):null}_cameraForBounds(o,c,m,x,C,I){if("globe"===o.projection.name)return this._cameraForBoundsOnGlobe(o,c,m,x,C,I);const O=o.clone(),N=this._extendCameraOptions(I),H=O.padding;O.bearing=x,O.pitch=C;const $=s.LngLat.convert(c),ce=s.LngLat.convert(m),Ie=new s.LngLat($.lng,ce.lat),$e=new s.LngLat(ce.lng,$.lat),Qe=O.project($),Ye=O.project(ce),ot=this.queryTerrainElevation($),ue=this.queryTerrainElevation(ce),He=this.queryTerrainElevation(Ie),pt=this.queryTerrainElevation($e),ht=[[Qe.x,Qe.y,Math.min(ot||0,ue||0,He||0,pt||0)],[Ye.x,Ye.y,Math.max(ot||0,ue||0,He||0,pt||0)]];let Pt=s.Aabb.fromPoints(ht);const Lt=O.getWorldToCameraMatrix(),Ot=s.invert(new Float64Array(16),Lt);Pt=s.Aabb.applyTransform(Pt,Lt);const qt=s.sub([],Pt.max,Pt.min),$t=H.left||0,an=H.right||0,Wn=H.bottom||0,nn=H.top||0,{left:An,right:pn,top:$n,bottom:ln}=N.padding,Mn=.5*($t+an),jn=.5*(nn+Wn),Bn=Math.min(O.scaleZoom(O.scale*Math.min((O.width-($t+an+An+pn))/qt[0],(O.height-(Wn+nn+ln+$n))/qt[1])),N.maxZoom),Yn=O.scale/O.zoomScale(Bn);Pt=new s.Aabb([Pt.min[0]-(An+Mn)*Yn,Pt.min[1]-(ln+jn)*Yn,Pt.min[2]],[Pt.max[0]+(pn+Mn)*Yn,Pt.max[1]+($n+jn)*Yn,Pt.max[2]]);const Di=.5*qt[2],$i=this._minimumAABBFrustumDistance(O,Pt),vi=[0,0,1,0];s.transformMat4$1(vi,vi,Lt),s.normalize$2(vi,vi);const ki=s.scale$2([],vi,$i+Di),ho=s.add([],Pt.center,ki),fo=("number"==typeof N.offset.x&&"number"==typeof N.offset.y?new s.Point(N.offset.x,N.offset.y):s.Point.convert(N.offset)).rotate(-s.degToRad(x));Pt.center[0]-=fo.x*Yn,Pt.center[1]+=fo.y*Yn,s.transformMat4(Pt.center,Pt.center,Ot),s.transformMat4(ho,ho,Ot);const Ti=[Pt.center[0],Pt.center[1],ho[2]*O.pixelsPerMeter];s.scale$2(Ti,Ti,1/O.worldSize);const Fo=s.lngFromMercatorX(Ti[0]),Bo=s.latFromMercatorY(Ti[1]),No=Math.min(O._zoomFromMercatorZ(Ti[2]),N.maxZoom),zo=new s.LngLat(Fo,Bo);return O.mercatorFromTransition&&No<.5*(s.GLOBE_ZOOM_THRESHOLD_MIN+s.GLOBE_ZOOM_THRESHOLD_MAX)?(O.setProjection({name:"globe"}),O.zoom=No,this._cameraForBounds(O,c,m,x,C,I)):{center:zo,zoom:No,bearing:x,pitch:C}}fitBounds(o,c,m){const x=this.cameraForBounds(o,c);return this._fitInternal(x,c,m)}fitScreenCoordinates(o,c,m,x,C){const I=s.Point.convert(o),O=s.Point.convert(c),N=new s.Point(Math.min(I.x,O.x),Math.min(I.y,O.y)),H=new s.Point(Math.max(I.x,O.x),Math.max(I.y,O.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(I,O))return this;const $=this.transform.pointLocation3D(N),ce=this.transform.pointLocation3D(H),Ie=this.transform.pointLocation3D(new s.Point(N.x,H.y)),$e=this.transform.pointLocation3D(new s.Point(H.x,N.y)),Qe=[Math.min($.lng,ce.lng,Ie.lng,$e.lng),Math.min($.lat,ce.lat,Ie.lat,$e.lat)],Ye=[Math.max($.lng,ce.lng,Ie.lng,$e.lng),Math.max($.lat,ce.lat,Ie.lat,$e.lat)],ot=x&&x.pitch?x.pitch:this.getPitch(),ue=this._cameraForBounds(this.transform,Qe,Ye,m,ot,x);return this._fitInternal(ue,x,C)}_fitInternal(o,c,m){return o?(delete(c=s.extend(o,c)).padding,c.linear?this.easeTo(c,m):this.flyTo(c,m)):this}jumpTo(o,c){this.stop();const m=o.preloadOnly?this.transform.clone():this.transform;let x=!1,C=!1,I=!1;return"zoom"in o&&m.zoom!==+o.zoom&&(x=!0,m.zoom=+o.zoom),void 0!==o.center&&(m.center=s.LngLat.convert(o.center)),"bearing"in o&&m.bearing!==+o.bearing&&(C=!0,m.bearing=+o.bearing),"pitch"in o&&m.pitch!==+o.pitch&&(I=!0,m.pitch=+o.pitch),null==o.padding||m.isPaddingEqual(o.padding)||(m.padding=o.padding),o.preloadOnly?(this._preloadTiles(m),this):(this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),x&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),C&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),I&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.warnOnce(za),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,c){const m=this.transform;if(!m.projection.supportsFreeCamera)return s.warnOnce(za),this;this.stop();const x=m.zoom,C=m.pitch,I=m.bearing;m.setFreeCameraOptions(o);const O=x!==m.zoom,N=C!==m.pitch,H=I!==m.bearing;return this.fire(new s.Event("movestart",c)).fire(new s.Event("move",c)),O&&this.fire(new s.Event("zoomstart",c)).fire(new s.Event("zoom",c)).fire(new s.Event("zoomend",c)),H&&this.fire(new s.Event("rotatestart",c)).fire(new s.Event("rotate",c)).fire(new s.Event("rotateend",c)),N&&this.fire(new s.Event("pitchstart",c)).fire(new s.Event("pitch",c)).fire(new s.Event("pitchend",c)),this.fire(new s.Event("moveend",c)),this}easeTo(o,c){this._stop(!1,o.easeId),(!1===(o=s.extend({offset:[0,0],duration:500,easing:s.ease},o)).animate||this._prefersReducedMotion(o))&&(o.duration=0);const m=this.transform,x=this.getZoom(),C=this.getBearing(),I=this.getPitch(),O=this.getPadding(),N="zoom"in o?+o.zoom:x,H="bearing"in o?this._normalizeBearing(o.bearing,C):C,$="pitch"in o?+o.pitch:I,ce="padding"in o?o.padding:m.padding,Ie=s.Point.convert(o.offset);let $e,Qe,Ye;if("globe"===m.projection.name){const $t=s.MercatorCoordinate.fromLngLat(m.center),an=Ie.rotate(-m.angle);$t.x+=an.x/m.worldSize,$t.y+=an.y/m.worldSize;const Wn=$t.toLngLat(),nn=s.LngLat.convert(o.center||Wn);this._normalizeCenter(nn),$e=m.centerPoint.add(an),Qe=new s.Point($t.x,$t.y).mult(m.worldSize),Ye=new s.Point(s.mercatorXfromLng(nn.lng),s.mercatorYfromLat(nn.lat)).mult(m.worldSize).sub(Qe)}else{$e=m.centerPoint.add(Ie);const $t=m.pointLocation($e),an=s.LngLat.convert(o.center||$t);this._normalizeCenter(an),Qe=m.project($t),Ye=m.project(an).sub(Qe)}const ot=m.zoomScale(N-x);let ue,He;o.around&&(ue=s.LngLat.convert(o.around),He=m.locationPoint(ue));const pt=this._zooming||N!==x,ht=this._rotating||C!==H,Pt=this._pitching||$!==I,Lt=!m.isPaddingEqual(ce),Ot=$t=>an=>{if(pt&&($t.zoom=s.number(x,N,an)),ht&&($t.bearing=s.number(C,H,an)),Pt&&($t.pitch=s.number(I,$,an)),Lt&&($t.interpolatePadding(O,ce,an),$e=$t.centerPoint.add(Ie)),ue)$t.setLocationAtPoint(ue,He);else{const Wn=$t.zoomScale($t.zoom-x),nn=N>x?Math.min(2,ot):Math.max(.5,ot),An=Math.pow(nn,1-an),pn=$t.unproject(Qe.add(Ye.mult(an*An)).mult(Wn));$t.setLocationAtPoint($t.renderWorldCopies?pn.wrap():pn,$e)}return o.preloadOnly||this._fireMoveEvents(c),$t};if(o.preloadOnly){const $t=this._emulate(Ot,o.duration,m);return this._preloadTiles($t),this}const qt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=pt,this._rotating=ht,this._pitching=Pt,this._padding=Lt,this._easeId=o.easeId,this._prepareEase(c,o.noMoveStart,qt),this._ease(Ot(m),$t=>{m.recenterOnTerrain(),this._afterEase(c,$t)},o),this}_prepareEase(o,c,m={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||m.moving||this.fire(new s.Event("movestart",o)),this._zooming&&!m.zooming&&this.fire(new s.Event("zoomstart",o)),this._rotating&&!m.rotating&&this.fire(new s.Event("rotatestart",o)),this._pitching&&!m.pitching&&this.fire(new s.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new s.Event("move",o)),this._zooming&&this.fire(new s.Event("zoom",o)),this._rotating&&this.fire(new s.Event("rotate",o)),this._pitching&&this.fire(new s.Event("pitch",o))}_afterEase(o,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const m=this._zooming,x=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,m&&this.fire(new s.Event("zoomend",o)),x&&this.fire(new s.Event("rotateend",o)),C&&this.fire(new s.Event("pitchend",o)),this.fire(new s.Event("moveend",o))}flyTo(o,c){if(this._prefersReducedMotion(o)){const Bn=s.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Bn,c)}this.stop(),o=s.extend({offset:[0,0],speed:1.2,curve:1.42,easing:s.ease},o);const m=this.transform,x=this.getZoom(),C=this.getBearing(),I=this.getPitch(),O=this.getPadding(),N="zoom"in o?s.clamp(+o.zoom,m.minZoom,m.maxZoom):x,H="bearing"in o?this._normalizeBearing(o.bearing,C):C,$="pitch"in o?+o.pitch:I,ce="padding"in o?o.padding:m.padding,Ie=m.zoomScale(N-x),$e=s.Point.convert(o.offset);let Qe=m.centerPoint.add($e);const Ye=m.pointLocation(Qe),ot=s.LngLat.convert(o.center||Ye);this._normalizeCenter(ot);const ue=m.project(Ye),He=m.project(ot).sub(ue);let pt=o.curve;const ht=Math.max(m.width,m.height),Pt=ht/Ie,Lt=He.mag();if("minZoom"in o){const Bn=s.clamp(Math.min(o.minZoom,x,N),m.minZoom,m.maxZoom),Yn=ht/m.zoomScale(Bn-x);pt=Math.sqrt(Yn/Lt*2)}const Ot=pt*pt;function qt(Bn){const Yn=(Pt*Pt-ht*ht+(Bn?-1:1)*Ot*Ot*Lt*Lt)/(2*(Bn?Pt:ht)*Ot*Lt);return Math.log(Math.sqrt(Yn*Yn+1)-Yn)}function $t(Bn){return(Math.exp(Bn)-Math.exp(-Bn))/2}function an(Bn){return(Math.exp(Bn)+Math.exp(-Bn))/2}const Wn=qt(0);let nn=function(Bn){return an(Wn)/an(Wn+pt*Bn)},An=function(Bn){return ht*((an(Wn)*($t(Yn=Wn+pt*Bn)/an(Yn))-$t(Wn))/Ot)/Lt;var Yn},pn=(qt(1)-Wn)/pt;if(Math.abs(Lt)<1e-6||!isFinite(pn)){if(Math.abs(ht-Pt)<1e-6)return this.easeTo(o,c);const Bn=Pt<ht?-1:1;pn=Math.abs(Math.log(Pt/ht))/pt,An=function(){return 0},nn=function(Yn){return Math.exp(Bn*pt*Yn)}}o.duration="duration"in o?+o.duration:1e3*pn/("screenSpeed"in o?+o.screenSpeed/pt:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const $n=C!==H,ln=$!==I,Mn=!m.isPaddingEqual(ce),jn=Bn=>Yn=>{const Di=Yn*pn,$i=1/nn(Di);Bn.zoom=1===Yn?N:x+Bn.scaleZoom($i),$n&&(Bn.bearing=s.number(C,H,Yn)),ln&&(Bn.pitch=s.number(I,$,Yn)),Mn&&(Bn.interpolatePadding(O,ce,Yn),Qe=Bn.centerPoint.add($e));const vi=1===Yn?ot:Bn.unproject(ue.add(He.mult(An(Di))).mult($i));return Bn.setLocationAtPoint(Bn.renderWorldCopies?vi.wrap():vi,Qe),Bn._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(c),Bn};if(o.preloadOnly){const Bn=this._emulate(jn,o.duration,m);return this._preloadTiles(Bn),this}return this._zooming=!0,this._rotating=$n,this._pitching=ln,this._padding=Mn,this._prepareEase(c,!1),this._ease(jn(m),()=>this._afterEase(c),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const m=this._onEaseEnd;this._onEaseEnd=void 0,m.call(this,c)}if(!o){const m=this.handlers;m&&m.stop(!1)}return this}_ease(o,c,m){!1===m.animate||0===m.duration?(o(1),c()):(this._easeStart=s.exported.now(),this._easeOptions=m,this._onEaseFrame=o,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((s.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,c){o=s.wrap(o,-180,180);const m=Math.abs(o-c);return Math.abs(o-360-c)<m&&(o-=360),Math.abs(o+360-c)<m&&(o+=360),o}_normalizeCenter(o){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const m=o.lng-c.center.lng;o.lng+=m>180?-360:m<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&s.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,c,m){const x=Math.ceil(15*c/1e3),C=[],I=o(m.clone());for(let O=0;O<=x;O++){const N=I(O/x);C.push(N.clone())}return C}}class di{constructor(o={}){this.options=o,s.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const c=this.options&&this.options.compact;return this._map=o,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=fe("button","mapboxgl-ctrl-attrib-button",this._container),fe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=fe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,c){const m=this._map._getUIString(`AttributionControl.${c}`);o.setAttribute("aria-label",m),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",m)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.config.ACCESS_TOKEN}];if(o){const m=c.reduce((x,C,I)=>(C.value&&(x+=`${C.key}=${C.value}${I<c.length-1?"&":""}`),x),"?");o.href=`${s.config.FEEDBACK_URL}/${m}#${os(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||"metadata"!==o.sourceDataType&&"visibility"!==o.sourceDataType&&"style"!==o.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const x=this._map.style.stylesheet;this.styleOwner=x.owner,this.styleId=x.id}const c=this._map.style._sourceCaches;for(const x in c){const C=c[x];if(C.used){const I=C.getSource();I.attribution&&o.indexOf(I.attribution)<0&&o.push(I.attribution)}}o.sort((x,C)=>x.length-C.length),o=o.filter((x,C)=>{for(let I=C+1;I<o.length;I++)if(o[I].indexOf(x)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const m=o.join(" | ");m!==this._attribHTML&&(this._attribHTML=m,o.length?(this._innerContainer.innerHTML=m,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class _r{constructor(){s.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=fe("div","mapboxgl-ctrl");const c=fe("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&"metadata"!==o.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(0===Object.entries(o).length)return!0;for(const c in o){const m=o[c].getSource();if(m.hasOwnProperty("mapbox_logo")&&!m.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class xu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const c=++this._id;return this._queue.push({callback:o,id:c,cancelled:!1}),c}remove(o){const c=this._currentlyRunning,m=c?this._queue.concat(c):this._queue;for(const x of m)if(x.id===o)return void(x.cancelled=!0)}run(o=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const m of c)if(!m.cancelled&&(m.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Hl(p,o,c){if(p=new s.LngLat(p.lng,p.lat),o){const m=new s.LngLat(p.lng-360,p.lat),x=new s.LngLat(p.lng+360,p.lat),C=360*Math.ceil(Math.abs(p.lng-c.center.lng)/360),I=c.locationPoint(p).distSqr(o),O=o.x<0||o.y<0||o.x>c.width||o.y>c.height;c.locationPoint(m).distSqr(o)<I&&(O||Math.abs(m.lng-c.center.lng)<C)?p=m:c.locationPoint(x).distSqr(o)<I&&(O||Math.abs(x.lng-c.center.lng)<C)&&(p=x)}for(;Math.abs(p.lng-c.center.lng)>180;){const m=c.locationPoint(p);if(m.x>=0&&m.y>=0&&m.x<=c.width&&m.y<=c.height)break;p.lng>c.center.lng?p.lng-=360:p.lng+=360}return p}const vl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class li extends s.Evented{constructor(o,c){if(super(),(o instanceof s.window.HTMLElement||c)&&(o=s.extend({element:o},c)),s.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=s.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=fe("div");const x=41,C=27,I=Ae("svg",{display:"block",height:x*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${x}`},this._element),O=Ae("radialGradient",{id:"shadowGradient"},Ae("defs",{},I));Ae("stop",{offset:"10%","stop-opacity":.4},O),Ae("stop",{offset:"100%","stop-opacity":.05},O),Ae("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},I),Ae("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},I),Ae("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},I),Ae("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},I),this._offset=s.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",x=>{x.preventDefault()}),this._element.addEventListener("mousedown",x=>{x.preventDefault()});const m=this._element.classList;for(const x in vl)m.remove(`mapboxgl-marker-anchor-${x}`);m.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const x=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[x,-1*(24.6+x)],"bottom-right":[-x,-1*(24.6+x)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const c=o.code,m=o.charCode||o.keyCode;"Space"!==c&&"Enter"!==c&&32!==m&&13!==m||this.togglePopup()}_onMapClick(o){const c=o.originalEvent.target,m=this._element;this._popup&&(c===m||m.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,c=this._pos;if(!o||!c)return!1;const m=o.unproject(c),x=o.getFreeCameraOptions();if(!x.position)return!1;const C=x.position.toLngLat();return C.distanceTo(m)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const c=this._pos;if(!c||c.x<0||c.x>o.transform.width||c.y<0||c.y>o.transform.height)return void this._clearFadeTimer();const m=o.unproject(c);let x;o._showingGlobe()&&s.isLngLatBehindGlobe(o.transform,this._lngLat)?x=0:(x=1-o._queryFogOpacity(m),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(x*=this._occludedOpacity)),this._element.style.opacity=`${x}`,this._element.style.pointerEvents=x>0?"auto":"none",this._popup&&this._popup._setOpacity(x),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${o.x}px,${o.y}px)\n            ${vl[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const o=this._pos,c=this._map,m=this.getPitchAlignment();if(!c||!o||"map"!==m)return"";if(!c._showingGlobe()){const N=c.getPitch();return N?`rotateX(${N}deg)`:""}const x=s.radToDeg(s.globeTiltAtLngLat(c.transform,this._lngLat)),C=o.sub(s.globeCenterToScreenPoint(c.transform)),I=Math.abs(C.x)+Math.abs(C.y);if(0===I)return"";const O=x/I;return`rotateX(${-C.y*O}deg) rotateY(${C.x*O}deg)`}_calculateZTransform(){const o=this._pos,c=this._map;if(!c||!o)return"";let m=0;const x=this.getRotationAlignment();if("map"===x)if(c._showingGlobe()){const C=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),I=c.project(new s.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);m=s.radToDeg(Math.atan2(I.y,I.x))-90}else m=-c.getBearing();else if("horizon"===x){const C=s.smoothstep(4,6,c.getZoom()),I=s.globeCenterToScreenPoint(c.transform);I.y+=C*c.transform.height;const O=o.sub(I),N=s.radToDeg(Math.atan2(O.y,O.x));m=(N>90?N-270:N+90)*(1-C)}return m+=this._rotation,m?`rotateZ(${m}deg)`:""}_update(o){s.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=Hl(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===o?this._updateFrameId=s.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=s.Point.convert(o),this._update(),this}_onMove(o){const c=this._map;if(!c)return;const m=this._pointerdownPos,x=this._positionDelta;if(m&&x){if(!this._isDragging){const C=this._clickTolerance||c._clickTolerance;if(o.point.dist(m)<C)return;this._isDragging=!0}this._pos=o.point.sub(x),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new s.Event("dragstart"))),this.fire(new s.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new s.Event("dragend")),this._state="inactive"}_addDragHandler(o){const c=this._map,m=this._pos;c&&m&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(m),this._pointerdownPos=o.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const c=this._map;return c&&(o?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const L={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},B=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function A(p=new s.Point(0,0),o="bottom"){if("number"==typeof p){const c=Math.round(Math.sqrt(.5*Math.pow(p,2)));switch(o){case"top":return new s.Point(0,p);case"top-left":return new s.Point(c,c);case"top-right":return new s.Point(-c,c);case"bottom":return new s.Point(0,-p);case"bottom-left":return new s.Point(c,-c);case"bottom-right":return new s.Point(-c,-c);case"left":return new s.Point(p,0);case"right":return new s.Point(-p,0)}return new s.Point(0,0)}return p instanceof s.Point||Array.isArray(p)?s.Point.convert(p):s.Point.convert(p[o]||[0,0])}class U{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const c=s.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,c,m){this._start=this.getValue(c),this._end=o,this._startTime=c,this._endTime=c+m}}const le={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Be={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},qe={showCompass:!0,showZoom:!0,visualizePitch:!1};class Jt{constructor(o,c,m=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Fs({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,m&&(this.mousePitch=new jl({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),s.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(o,c){this.mouseRotate.mousedown(o,c),this.mousePitch&&this.mousePitch.mousedown(o,c),Te()}move(o,c){const m=this.map,x=this.mouseRotate.mousemoveWindow(o,c),C=x&&x.bearingDelta;if(C&&m.setBearing(m.getBearing()+C),this.mousePitch){const I=this.mousePitch.mousemoveWindow(o,c),O=I&&I.pitchDelta;O&&m.setPitch(m.getPitch()+O)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ge(),s.window.removeEventListener("mousemove",this.mousemove),s.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(s.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Me(this.element,o)),s.window.addEventListener("mousemove",this.mousemove),s.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,Me(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){1!==o.targetTouches.length?this.reset():(this._startPos=this._lastPos=ze(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){1!==o.targetTouches.length?this.reset():(this._lastPos=ze(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){0===o.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Rn={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},_i={maxWidth:100,unit:"metric"},Ai={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Mo={version:s.version,supported:ie,setRTLTextPlugin:s.setRTLTextPlugin,getRTLTextPluginStatus:s.getRTLTextPluginStatus,Map:class extends qr{constructor(p){if(s.LivePerformanceUtils.mark(s.PerformanceMarkers.create),null!=(p=s.extend({},Be,p)).minZoom&&null!=p.maxZoom&&p.minZoom>p.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=p.minPitch&&null!=p.maxPitch&&p.minPitch>p.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=p.minPitch&&p.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=p.maxPitch&&p.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(p.antialias&&s.isSafariWithAntialiasingBug(s.window)&&(p.antialias=!1,s.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new fs(p.minZoom,p.maxZoom,p.minPitch,p.maxPitch,p.renderWorldCopies),p),this._interactive=p.interactive,this._minTileCacheSize=p.minTileCacheSize,this._maxTileCacheSize=p.maxTileCacheSize,this._failIfMajorPerformanceCaveat=p.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=p.preserveDrawingBuffer,this._antialias=p.antialias,this._useWebGL2=p.useWebGL2,this._trackResize=p.trackResize,this._bearingSnap=p.bearingSnap,this._refreshExpiredTiles=p.refreshExpiredTiles,this._fadeDuration=p.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=p.crossSourceCollisions,this._collectResourceTiming=p.collectResourceTiming,this._optimizeForTerrain=p.optimizeForTerrain,this._language=this._parseLanguage(p.language),this._worldview=p.worldview,this._renderTaskQueue=new xu,this._domRenderTaskQueue=new xu,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.uniqueId(),this._locale=s.extend({},le,p.locale),this._clickTolerance=p.clickTolerance,this._cooperativeGestures=p.cooperativeGestures,this._performanceMetricsCollection=p.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new U(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new s.RequestManager(p.transformRequest,p.accessToken,p.testMode),this._silenceAuthErrors=!!p.testMode,"string"==typeof p.container){if(this._container=s.window.document.getElementById(p.container),!this._container)throw new Error(`Container '${p.container}' not found.`)}else{if(!(p.container instanceof s.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=p.container}if(this._container.childNodes.length>0&&s.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),p.maxBounds&&this.setMaxBounds(p.maxBounds),s.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==s.window&&(s.window.addEventListener("online",this._onWindowOnline,!1),s.window.addEventListener("resize",this._onWindowResize,!1),s.window.addEventListener("orientationchange",this._onWindowResize,!1),s.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new _a(this,p),this._localFontFamily=p.localFontFamily,this._localIdeographFontFamily=p.localIdeographFontFamily,p.style&&this.setStyle(p.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),p.projection&&this.setProjection(p.projection),this._hash=p.hash&&new qs("string"==typeof p.hash&&p.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:p.center,zoom:p.zoom,bearing:p.bearing,pitch:p.pitch}),p.bounds&&(this.resize(),this.fitBounds(p.bounds,s.extend({},p.fitBoundsOptions,{duration:0})))),this.resize(),p.attributionControl&&this.addControl(new di({customAttribution:p.customAttribution})),this._logoControl=new _r,this.addControl(this._logoControl,p.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",o=>{this._update("style"===o.dataType),this.fire(new s.Event(`${o.dataType}data`,o))}),this.on("dataloading",o=>{this.fire(new s.Event(`${o.dataType}dataloading`,o))})}_getMapId(){return this._mapId}addControl(p,o){if(void 0===o&&(o=p.getDefaultPosition?p.getDefaultPosition():"top-right"),!p||!p.onAdd)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=p.onAdd(this);this._controls.push(p);const m=this._controlPositions[o];return-1!==o.indexOf("bottom")?m.insertBefore(c,m.firstChild):m.appendChild(c),this}removeControl(p){if(!p||!p.onRemove)return this.fire(new s.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(p);return o>-1&&this._controls.splice(o,1),p.onRemove(this),this}hasControl(p){return this._controls.indexOf(p)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(p){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new s.Event("movestart",p)).fire(new s.Event("move",p)),this.fire(new s.Event("resize",p)),o&&this.fire(new s.Event("moveend",p)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(p){return this.transform.setMaxBounds(s.LngLatBounds.convert(p)),this._update()}setMinZoom(p){if((p=p??-2)>=-2&&p<=this.transform.maxZoom)return this.transform.minZoom=p,this._update(),this.getZoom()<p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(p){if((p=p??22)>=this.transform.minZoom)return this.transform.maxZoom=p,this._update(),this.getZoom()>p?this.setZoom(p):this.fire(new s.Event("zoomstart")).fire(new s.Event("zoom")).fire(new s.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(p){if((p=p??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(p>=0&&p<=this.transform.maxPitch)return this.transform.minPitch=p,this._update(),this.getPitch()<p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(p){if((p=p??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(p>=this.transform.minPitch)return this.transform.maxPitch=p,this._update(),this.getPitch()>p?this.setPitch(p):this.fire(new s.Event("pitchstart")).fire(new s.Event("pitch")).fire(new s.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(p){return this.transform.renderWorldCopies=p,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(p){return"auto"===p?s.window.navigator.language:Array.isArray(p)?0===p.length?void 0:p.map(o=>"auto"===o?s.window.navigator.language:o):p}setLanguage(p){const o=this._parseLanguage(p);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(p){return this.style&&p!==this._worldview?(this._worldview=p,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(p){return this._lazyInitEmptyStyle(),p?"string"==typeof p&&(p={name:p}):p=null,this._useExplicitProjection=!!p,this._prioritizeAndUpdateProjection(p,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const p=this.transform,o=p.projection.name;let c;"globe"===o&&p.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?(p.setMercatorFromTransition(),c=!0):"mercator"===o&&p.zoom<s.GLOBE_ZOOM_THRESHOLD_MAX&&(p.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(p,o){return this._updateProjection(p||o||{name:"mercator"})}_updateProjection(p){let o;if(o="globe"===p.name&&this.transform.zoom>=s.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(p),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(p){return this.transform.locationPoint3D(s.LngLat.convert(p))}unproject(p){return this.transform.pointLocation3D(s.Point.convert(p))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(p,o,c){if("mouseenter"===p||"mouseover"===p){let m=!1;const x=I=>{const O=o.filter(H=>this.getLayer(H)),N=O.length?this.queryRenderedFeatures(I.point,{layers:O}):[];N.length?m||(m=!0,c.call(this,new qo(p,this,I.originalEvent,{features:N}))):m=!1},C=()=>{m=!1};return{layers:new Set(o),listener:c,delegates:{mousemove:x,mouseout:C}}}if("mouseleave"===p||"mouseout"===p){let m=!1;const x=I=>{const O=o.filter(N=>this.getLayer(N));(O.length?this.queryRenderedFeatures(I.point,{layers:O}):[]).length?m=!0:m&&(m=!1,c.call(this,new qo(p,this,I.originalEvent)))},C=I=>{m&&(m=!1,c.call(this,new qo(p,this,I.originalEvent)))};return{layers:new Set(o),listener:c,delegates:{mousemove:x,mouseout:C}}}{const m=x=>{const C=o.filter(O=>this.getLayer(O)),I=C.length?this.queryRenderedFeatures(x.point,{layers:C}):[];I.length&&(x.features=I,c.call(this,x),delete x.features)};return{layers:new Set(o),listener:c,delegates:{[p]:m}}}}on(p,o,c){if(void 0===c)return super.on(p,o);Array.isArray(o)||(o=[o]);const m=this._createDelegatedListener(p,o,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[p]=this._delegatedListeners[p]||[],this._delegatedListeners[p].push(m);for(const x in m.delegates)this.on(x,m.delegates[x]);return this}once(p,o,c){if(void 0===c)return super.once(p,o);Array.isArray(o)||(o=[o]);const m=this._createDelegatedListener(p,o,c);for(const x in m.delegates)this.once(x,m.delegates[x]);return this}off(p,o,c){if(void 0===c)return super.off(p,o);o=new Set(Array.isArray(o)?o:[o]);const m=(C,I)=>{if(C.size!==I.size)return!1;for(const O of C)if(!I.has(O))return!1;return!0},x=this._delegatedListeners?this._delegatedListeners[p]:void 0;return x&&(C=>{for(let I=0;I<C.length;I++){const O=C[I];if(O.listener===c&&m(O.layers,o)){for(const N in O.delegates)this.off(N,O.delegates[N]);return C.splice(I,1),this}}})(x),this}queryRenderedFeatures(p,o){return this.style?(void 0!==o||void 0===p||p instanceof s.Point||Array.isArray(p)||(o=p,p=void 0),this.style.queryRenderedFeatures(p=p||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(p,o){return this.style.querySourceFeatures(p,o)}isPointOnSurface(p){const{name:o}=this.transform.projection;return"globe"!==o&&"mercator"!==o&&s.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.Point.convert(p))}setStyle(p,o){return!1!==(o=s.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&p?(this._diffStyle(p,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(p,o))}_getUIString(p){const o=this._locale[p];if(null==o)throw new Error(`Missing UI string '${p}'`);return o}_updateStyle(p,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),p&&(this.style=new Ir(this,o||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof p?this.style.loadURL(p):this.style.loadJSON(p)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Ir(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(p,o){if("string"==typeof p){const c=this._requestManager.normalizeStyleURL(p),m=this._requestManager.transformRequest(c,s.ResourceType.Style);s.getJSON(m,(x,C)=>{x?this.fire(new s.ErrorEvent(x)):C&&this._updateDiff(C,o)})}else"object"==typeof p&&this._updateDiff(p,o)}_updateDiff(p,o){try{this.style.setState(p)&&this._update(!0)}catch(c){s.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(p,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.warnOnce("There is no style added to the map."),!1)}addSource(p,o){return this._lazyInitEmptyStyle(),this.style.addSource(p,o),this._update(!0)}isSourceLoaded(p){return!!this.style&&this.style._isSourceCacheLoaded(p)}areTilesLoaded(){const p=this.style&&this.style._sourceCaches;for(const o in p){const c=p[o]._tiles;for(const m in c){const x=c[m];if("loaded"!==x.state&&"errored"!==x.state)return!1}}return!0}addSourceType(p,o,c){this._lazyInitEmptyStyle(),this.style.addSourceType(p,o,c)}removeSource(p){return this.style.removeSource(p),this._updateTerrain(),this._update(!0)}getSource(p){return this.style.getSource(p)}addImage(p,o,{pixelRatio:c=1,sdf:m=!1,stretchX:x,stretchY:C,content:I}={}){if(this._lazyInitEmptyStyle(),o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap){const{width:O,height:N,data:H}=s.exported.getImageData(o);this.style.addImage(p,{data:new s.RGBAImage({width:O,height:N},H),pixelRatio:c,stretchX:x,stretchY:C,content:I,sdf:m,version:0})}else if(void 0===o.width||void 0===o.height)this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:O,height:N}=o,H=o;this.style.addImage(p,{data:new s.RGBAImage({width:O,height:N},new Uint8Array(H.data)),pixelRatio:c,stretchX:x,stretchY:C,content:I,sdf:m,version:0,userImage:H}),H.onAdd&&H.onAdd(this,p)}}updateImage(p,o){const c=this.style.getImage(p);if(!c)return void this.fire(new s.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const m=o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap?s.exported.getImageData(o):o,{width:x,height:C}=m;void 0!==x&&void 0!==C?x===c.data.width&&C===c.data.height?(c.data.replace(m.data,!(o instanceof s.window.HTMLImageElement||s.window.ImageBitmap&&o instanceof s.window.ImageBitmap)),this.style.updateImage(p,c)):this.fire(new s.ErrorEvent(new Error(`The width and height of the updated image (${x}, ${C})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`))):this.fire(new s.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(p){return p?!!this.style.getImage(p):(this.fire(new s.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(p){this.style.removeImage(p)}loadImage(p,o){s.getImage(this._requestManager.transformRequest(p,s.ResourceType.Image),(c,m)=>{o(c,m instanceof s.window.HTMLImageElement?s.exported.getImageData(m):m)})}listImages(){return this.style.listImages()}addLayer(p,o){return this._lazyInitEmptyStyle(),this.style.addLayer(p,o),this._update(!0)}moveLayer(p,o){return this.style.moveLayer(p,o),this._update(!0)}removeLayer(p){return this.style.removeLayer(p),this._update(!0)}getLayer(p){return this.style.getLayer(p)}setLayerZoomRange(p,o,c){return this.style.setLayerZoomRange(p,o,c),this._update(!0)}setFilter(p,o,c={}){return this.style.setFilter(p,o,c),this._update(!0)}getFilter(p){return this.style.getFilter(p)}setPaintProperty(p,o,c,m={}){return this.style.setPaintProperty(p,o,c,m),this._update(!0)}getPaintProperty(p,o){return this.style.getPaintProperty(p,o)}setLayoutProperty(p,o,c,m={}){return this.style.setLayoutProperty(p,o,c,m),this._update(!0)}getLayoutProperty(p,o){return this.style.getLayoutProperty(p,o)}setLight(p,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(p,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(p){return this._lazyInitEmptyStyle(),!p&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(p),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(p){return this._lazyInitEmptyStyle(),this.style.setFog(p),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(p){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.LngLat.convert(p),this.transform):0}setFeatureState(p,o){return this.style.setFeatureState(p,o),this._update()}removeFeatureState(p,o){return this.style.removeFeatureState(p,o),this._update()}getFeatureState(p){return this.style.getFeatureState(p)}_updateContainerDimensions(){if(!this._container)return;const p=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let c,m,x,C=this._container;for(;C&&(!m||!x);){const I=s.window.getComputedStyle(C).transform;I&&"none"!==I&&(c=I.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(m=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(x=c[3])),C=C.parentElement}this._containerWidth=m?Math.abs(p/m):p,this._containerHeight=x?Math.abs(o/x):o}_detectMissingCSS(){"rgb(250, 128, 114)"!==s.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&s.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const p=this._container;p.classList.add("mapboxgl-map"),(this._missingCSSCanary=fe("div","mapboxgl-canary",p)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=fe("div","mapboxgl-canvas-container",p);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=fe("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=fe("div","mapboxgl-control-container",p),m=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{m[x]=fe("div",`mapboxgl-ctrl-${x}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(p,o){const c=s.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(p),this._canvas.height=c*Math.ceil(o),this._canvas.style.width=`${p}px`,this._canvas.style.height=`${o}px`}_addMarker(p){this._markers.push(p)}_removeMarker(p){const o=this._markers.indexOf(p);-1!==o&&this._markers.splice(o,1)}_addPopup(p){this._popups.push(p)}_removePopup(p){const o=this._popups.indexOf(p);-1!==o&&this._popups.splice(o,1)}_setupPainter(){const p=s.extend({},ie.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",p),c=o||this._canvas.getContext("webgl",p)||this._canvas.getContext("experimental-webgl",p);c?(this._useWebGL2&&!o&&s.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),s.storeAuthState(c,!0),this.painter=new Tt(c,this.transform,!!o),this.on("data",m=>{"source"===m.dataType&&this.painter.setTileLoadedFlag(!0)}),s.exported$1.testSupport(c)):this.fire(new s.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(p){p.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.Event("webglcontextlost",{originalEvent:p}))}_contextRestored(p){this._setupPainter(),this.resize(),this._update(),this.fire(new s.Event("webglcontextrestored",{originalEvent:p}))}_onMapScroll(p){if(p.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(p){return this.style?(this._styleDirty=this._styleDirty||p,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(p){return this._update(),this._renderTaskQueue.add(p)}_cancelRenderFrame(p){this._renderTaskQueue.remove(p)}_requestDomTask(p){!this.loaded()||this.loaded()&&!this.isMoving()?p():this._domRenderTaskQueue.add(p)}_render(p){let o;const c=this.painter.context.extTimerQuery,m=s.exported.now();if(this.listens("gpu-timing-frame")&&(o=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],s.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],s.window.performance.now())),this._renderTaskQueue.run(p),this._domRenderTaskQueue.run(p),this._removed)return;this._updateProjectionTransition();const x=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const O=this.transform.zoom,N=this.transform.pitch,H=s.exported.now(),$=new s.EvaluationParameters(O,{now:H,fadeDuration:x,pitch:N,transition:this.style.getTransition()});this.style.update($)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(m),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(m),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,x,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:x,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new s.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const O=s.exported.now()-m;c.endQueryEXT(c.TIME_ELAPSED_EXT,o),setTimeout(()=>{const N=c.getQueryObjectEXT(o,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(o),this.fire(new s.Event("gpu-timing-frame",{cpuTime:O,gpuTime:N})),s.window.performance.mark("frame-gpu",{startTime:m,detail:{gpuTime:N}})},50)}if(this.listens("gpu-timing-layer")){const O=this.painter.collectGpuTimers();setTimeout(()=>{const N=this.painter.queryGpuTimers(O);this.fire(new s.Event("gpu-timing-layer",{layerTimes:N}))},50)}if(this.listens("gpu-timing-deferred-render")){const O=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const N=this.painter.queryGpuTimeDeferredRender(O);this.fire(new s.Event("gpu-timing-deferred-render",{gpuTime:N}))},50)}const I=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(I||this._repaint)this.triggerRepaint();else{const O=!this.isMoving()&&this.loaded();if(O&&(C=this._updateAverageElevation(m,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),O&&(this.fire(new s.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const N=this._calculateSpeedIndex();this.fire(new s.Event("speedindexcompleted",{speedIndex:N})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||I||(this._fullyLoaded=!0,s.LivePerformanceUtils.mark(s.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&s.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(p){for(const o of this._markers)p&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!p||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(p,o=!1){const c=m=>(this.transform.averageElevation=m,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);if((o||p-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(p)){const m=this.transform.averageElevation;let x=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(x)?x=0:this._averageElevationLastSampledAt=p;const I=Math.abs(m-x);if(I>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(x),c(x);this._averageElevation.easeTo(x,p,300)}else if(I>1e-4)return this._averageElevation.jumpTo(x),c(x)}return!!this._averageElevation.isEasing(p)&&c(this._averageElevation.getValue(p))}_authenticate(){s.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,p=>{if(p&&(p.message===s.AUTH_ERR_MSG||401===p.status)){const o=this.painter.context.gl;s.storeAuthState(o,!1),this._logoControl instanceof _r&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),s.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const p=this._isDragging();this.painter.updateTerrain(this.style,p)}_calculateSpeedIndex(){const p=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const c=this.painter.context.gl,m=c.createFramebuffer();function x(C){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,C,0);const I=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,I),I}return c.bindFramebuffer(c.FRAMEBUFFER,m),this._canvasPixelComparison(x(p),o.canvasCopies.map(x),o.timeStamps)}_canvasPixelComparison(p,o,c){let m=c[1]-c[0];const x=p.length/4;for(let C=0;C<o.length;C++){const I=o[C];let O=0;for(let N=0;N<I.length;N+=4)I[N]===p[N]&&I[N+1]===p[N+1]&&I[N+2]===p[N+2]&&I[N+3]===p[N+3]&&(O+=1);m+=(c[C+2]-c[C+1])*(1-O/x)}return m}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==s.window&&(s.window.removeEventListener("resize",this._onWindowResize,!1),s.window.removeEventListener("orientationchange",this._onWindowResize,!1),s.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),s.window.removeEventListener("online",this._onWindowOnline,!1),s.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const p=this.painter.context.gl.getExtension("WEBGL_lose_context");p&&p.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),s.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new s.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(p){this._renderNextFrame=this._renderNextFrame||p,this.style&&!this._frame&&(this._frame=s.exported.frame(o=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(o)}))}_preloadTiles(p){const o=this.style?Object.values(this.style._sourceCaches):[];return s.asyncAll(o,(c,m)=>c._preloadTiles(p,m),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(p){this._trackResize&&this.resize({originalEvent:p})._update()}_onVisibilityChange(){"hidden"===s.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(p){this._showTileBoundaries!==p&&(this._showTileBoundaries=p,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(p){this._showTerrainWireframe!==p&&(this._showTerrainWireframe=p,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(p){this._speedIndexTiming!==p&&(this._speedIndexTiming=p,this._update())}get showPadding(){return!!this._showPadding}set showPadding(p){this._showPadding!==p&&(this._showPadding=p,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(p){this._showCollisionBoxes!==p&&(this._showCollisionBoxes=p,p?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(p){this._showOverdrawInspector!==p&&(this._showOverdrawInspector=p,this._update())}get repaint(){return!!this._repaint}set repaint(p){this._repaint!==p&&(this._repaint=p,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(p){this._vertices=p,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(p){this._showTileAABBs!==p&&(this._showTileAABBs=p,p&&this._update())}_setCacheLimits(p,o){s.setCacheLimits(p,o)}get version(){return s.version}},NavigationControl:class{constructor(p){this.options=s.extend({},qe,p),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(s.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),fe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),fe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:o}):c.resetNorth({},{originalEvent:o}))}),this._compassIcon=fe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const p=this._map;if(!p)return;const o=p.getZoom(),c=o===p.getMaxZoom(),m=o===p.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=m,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",m.toString())}_rotateCompassArrow(){const p=this._map;if(!p)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(p.transform.pitch*(Math.PI/180)),.5)}) rotateX(${p.transform.pitch}deg) rotateZ(${p.transform.angle*(180/Math.PI)}deg)`:`rotate(${p.transform.angle*(180/Math.PI)}deg)`;p._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(p){return this._map=p,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),p.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&p.on("pitch",this._rotateCompassArrow),p.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Jt(p,this._compass,this.options.visualizePitch)),this._container}onRemove(){const p=this._map;p&&(this._container.remove(),this.options.showZoom&&p.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&p.off("pitch",this._rotateCompassArrow),p.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(p,o){const c=fe("button",p,this._container);return c.type="button",c.addEventListener("click",o),c}_setButtonTitle(p,o){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${o}`);p.setAttribute("aria-label",c),p.firstElementChild&&p.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends s.Evented{constructor(p){super(),this.options=s.extend({geolocation:s.window.navigator.geolocation},Rn,p),s.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Vr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(p){return this._map=p,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(p){const o=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,p(c)};void 0!==this._supportsGeolocation?p(this._supportsGeolocation):void 0!==s.window.navigator.permissions?s.window.navigator.permissions.query({name:"geolocation"}).then(c=>o("denied"!==c.state)).catch(()=>o()):o()}_isOutOfMapMaxBounds(p){const o=this._map.getMaxBounds(),c=p.coords;return!!o&&(c.longitude<o.getWest()||c.longitude>o.getEast()||c.latitude<o.getSouth()||c.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(p){if(this._map){if(this._isOutOfMapMaxBounds(p))return this._setErrorState(),this.fire(new s.Event("outofmaxbounds",p)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=p,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(p),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(p),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("geolocate",p)),this._finish()}}_updateCamera(p){const o=new s.LngLat(p.coords.longitude,p.coords.latitude),c=p.coords.accuracy,m=this._map.getBearing(),x=s.extend({bearing:m},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(c),x,{geolocateSource:!0})}_updateMarker(p){if(p){const o=new s.LngLat(p.coords.longitude,p.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=p.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const p=this._map.transform,o=s.mercatorZfromAltitude(1,p._center.lat)*p.worldSize,c=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(p){if(this._map){if(this.options.trackUserLocation)if(1===p.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===p.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new s.Event("error",p)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(p){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=fe("button","mapboxgl-ctrl-geolocate",this._container),fe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===p){s.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=fe("div","mapboxgl-user-location"),this._dotElement.appendChild(fe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(fe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new li({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=fe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new li({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||"ACTIVE_LOCK"!==this._watchState||o.originalEvent&&"resize"===o.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.Event("trackuserlocationend")))})}}_onDeviceOrientation(p){this._userLocationDotMarker&&(p.webkitCompassHeading?this._heading=p.webkitCompassHeading:!0===p.absolute&&(this._heading=-1*p.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let p;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(p={maximumAge:6e5,timeout:0},this._noTimeout=!0):(p=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,p),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const p=()=>{s.window.addEventListener("ondeviceorientationabsolute"in s.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==s.window.DeviceMotionEvent&&"function"==typeof s.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(o=>{"granted"===o&&p()}).catch(console.error):p()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),s.window.removeEventListener("deviceorientation",this._onDeviceOrientation),s.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:di,ScaleControl:class{constructor(p){this.options=s.extend({},_i,p),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const p=this.options.maxWidth||100,o=this._map,c=o._containerHeight/2,m=o._containerWidth/2-p/2,x=o.unproject([m,c]),C=o.unproject([m+p,c]),I=x.distanceTo(C);if("imperial"===this.options.unit){const O=3.2808*I;O>5280?this._setScale(p,O/5280,"mile"):this._setScale(p,O,"foot")}else"nautical"===this.options.unit?this._setScale(p,I/1852,"nautical-mile"):I>=1e3?this._setScale(p,I/1e3,"kilometer"):this._setScale(p,I,"meter")}_setScale(p,o,c){this._map._requestDomTask(()=>{const m=function(C){const I=Math.pow(10,`${Math.floor(C)}`.length-1);let O=C/I;return O=O>=10?10:O>=5?5:O>=3?3:O>=2?2:O>=1?1:function(N){const H=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*H)/H}(O),I*O}(o),x=m/o;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:c}).format(m):`${m}&nbsp;${Ai[c]}`,this._container.style.width=p*x+"px"})}onAdd(p){return this._map=p,this._language=p.getLanguage(),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",p.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(p){this._language=p,this._update()}setUnit(p){this.options.unit=p,this._update()}},FullscreenControl:class{constructor(p){this._fullscreen=!1,p&&p.container&&(p.container instanceof s.window.HTMLElement?this._container=p.container:s.warnOnce("Full screen control 'container' must be a DOM element.")),s.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in s.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in s.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(p){return this._map=p,this._container||(this._container=this._map.getContainer()),this._controlContainer=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,s.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!s.window.document.fullscreenEnabled&&!s.window.document.webkitFullscreenEnabled)}_setupUI(){const p=this._fullscreenButton=fe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);fe("span","mapboxgl-ctrl-icon",p).setAttribute("aria-hidden","true"),p.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),s.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const p=this._getTitle();this._fullscreenButton.setAttribute("aria-label",p),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",p)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(s.window.document.fullscreenElement||s.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?s.window.document.exitFullscreen?s.window.document.exitFullscreen():s.window.document.webkitCancelFullScreen&&s.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.Evented{constructor(p){super(),this.options=s.extend(Object.create(L),p),s.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(p&&p.className?p.className.trim().split(/\s+/):[])}addTo(p){return this._map&&this.remove(),this._map=p,this.options.closeOnClick&&p.on("preclick",this._onClose),this.options.closeOnMove&&p.on("move",this._onClose),p.on("remove",this.remove),this._update(),p._addPopup(this),this._focusFirstElement(),this._trackPointer?(p.on("mousemove",this._onMouseEvent),p.on("mouseup",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")):p.on("move",this._update),this.fire(new s.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const p=this._map;return p&&(p.off("move",this._update),p.off("move",this._onClose),p.off("preclick",this._onClose),p.off("click",this._onClose),p.off("remove",this.remove),p.off("mousemove",this._onMouseEvent),p.off("mouseup",this._onMouseEvent),p.off("drag",this._onMouseEvent),p._canvasContainer&&p._canvasContainer.classList.remove("mapboxgl-track-pointer"),p._removePopup(this),this._map=void 0),this.fire(new s.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(p){this._lngLat=s.LngLat.convert(p),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const p=this._map;return p&&(p.off("move",this._update),p.on("mousemove",this._onMouseEvent),p.on("drag",this._onMouseEvent),p._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(p){return this.setDOMContent(s.window.document.createTextNode(p))}setHTML(p){const o=s.window.document.createDocumentFragment(),c=s.window.document.createElement("body");let m;for(c.innerHTML=p;m=c.firstChild,m;)o.appendChild(m);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(p){return this.options.maxWidth=p,this._update(),this}setDOMContent(p){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=fe("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(p),this.options.closeButton){const c=this._closeButton=fe("button","mapboxgl-popup-close-button",o);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(p){return this._classList.add(p),this._updateClassList(),this}removeClassName(p){return this._classList.delete(p),this._updateClassList(),this}setOffset(p){return this.options.offset=p,this._update(),this}toggleClassName(p){let o;return this._classList.delete(p)?o=!1:(this._classList.add(p),o=!0),this._updateClassList(),o}_onMouseEvent(p){this._update(p.point)}_getAnchor(p){if(this.options.anchor)return this.options.anchor;const o=this._map,c=this._container,m=this._pos;if(!o||!c||!m)return"bottom";const x=c.offsetWidth,C=c.offsetHeight,I=m.x<x/2,O=m.x>o.transform.width-x/2;if(m.y+p<C)return I?"top-left":O?"top-right":"top";if(m.y>o.transform.height-C){if(I)return"bottom-left";if(O)return"bottom-right"}return I?"left":O?"right":"bottom"}_updateClassList(){const p=this._container;if(!p)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),p.className=o.join(" ")}_update(p){const o=this._map,c=this._content;if(!o||!this._lngLat&&!this._trackPointer||!c)return;let m=this._container;if(m||(m=this._container=fe("div","mapboxgl-popup",o.getContainer()),this._tip=fe("div","mapboxgl-popup-tip",m),m.appendChild(c)),this.options.maxWidth&&m.style.maxWidth!==this.options.maxWidth&&(m.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Hl(this._lngLat,this._pos,o.transform)),!this._trackPointer||p){const x=this._pos=this._trackPointer&&p?p:o.project(this._lngLat),C=A(this.options.offset),I=this._anchor=this._getAnchor(C.y),O=A(this.options.offset,I),N=x.add(O).round();o._requestDomTask(()=>{this._container&&I&&(this._container.style.transform=`${vl[I]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&o._showingGlobe()){const x=s.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(x)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const p=this._container.querySelector(B);p&&p.focus()}_onClose(){this.remove()}_setOpacity(p){this._container&&(this._container.style.opacity=`${p}`),this._content&&(this._content.style.pointerEvents=p?"auto":"none")}},Marker:li,Style:Ir,LngLat:s.LngLat,LngLatBounds:s.LngLatBounds,Point:s.Point,MercatorCoordinate:s.MercatorCoordinate,FreeCameraOptions:_o,Evented:s.Evented,config:s.config,prewarm:function(){xt().acquire(po)},clearPrewarmedResources:function(){const p=tn;p&&(p.isPreloaded()&&1===p.numActive()?(p.release(po),tn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return s.config.ACCESS_TOKEN},set accessToken(p){s.config.ACCESS_TOKEN=p},get baseApiUrl(){return s.config.API_URL},set baseApiUrl(p){s.config.API_URL=p},get workerCount(){return eo.workerCount},set workerCount(p){eo.workerCount=p},get maxParallelImageRequests(){return s.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(p){s.config.MAX_PARALLEL_IMAGE_REQUESTS=p},clearStorage(p){s.clearTileCache(p)},workerUrl:"",workerClass:null,setNow:s.exported.setNow,restoreNow:s.exported.restoreNow};return Mo}),v}()},5619:(zn,Ct,R)=>{"use strict";R.d(Ct,{X:()=>d});var v=R(8645);class d extends v.x{constructor(s){super(),this._value=s}get value(){return this.getValue()}_subscribe(s){const Q=super._subscribe(s);return!Q.closed&&s.next(this._value),Q}getValue(){const{hasError:s,thrownError:Q,_value:ie}=this;if(s)throw Q;return this._throwIfClosed(),ie}next(s){super.next(this._value=s)}}},5592:(zn,Ct,R)=>{"use strict";R.d(Ct,{y:()=>w});var v=R(1887),d=R(7394),y=R(4850),s=R(8407),Q=R(2653),ie=R(4674),W=R(1441);let w=(()=>{class X{constructor(Te){Te&&(this._subscribe=Te)}lift(Te){const ge=new X;return ge.source=this,ge.operator=Te,ge}subscribe(Te,ge,we){const Le=function De(X){return X&&X instanceof v.Lv||function Ae(X){return X&&(0,ie.m)(X.next)&&(0,ie.m)(X.error)&&(0,ie.m)(X.complete)}(X)&&(0,d.Nn)(X)}(Te)?Te:new v.Hp(Te,ge,we);return(0,W.x)(()=>{const{operator:Me,source:ze}=this;Le.add(Me?Me.call(Le,ze):ze?this._subscribe(Le):this._trySubscribe(Le))}),Le}_trySubscribe(Te){try{return this._subscribe(Te)}catch(ge){Te.error(ge)}}forEach(Te,ge){return new(ge=fe(ge))((we,Le)=>{const Me=new v.Hp({next:ze=>{try{Te(ze)}catch(Ke){Le(Ke),Me.unsubscribe()}},error:Le,complete:we});this.subscribe(Me)})}_subscribe(Te){var ge;return null===(ge=this.source)||void 0===ge?void 0:ge.subscribe(Te)}[y.L](){return this}pipe(...Te){return(0,s.U)(Te)(this)}toPromise(Te){return new(Te=fe(Te))((ge,we)=>{let Le;this.subscribe(Me=>Le=Me,Me=>we(Me),()=>ge(Le))})}}return X.create=se=>new X(se),X})();function fe(X){var se;return null!==(se=X??Q.config.Promise)&&void 0!==se?se:Promise}},8645:(zn,Ct,R)=>{"use strict";R.d(Ct,{x:()=>W});var v=R(5592),d=R(7394);const s=(0,R(2306).d)(fe=>function(){fe(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var Q=R(9039),ie=R(1441);let W=(()=>{class fe extends v.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(De){const X=new w(this,this);return X.operator=De,X}_throwIfClosed(){if(this.closed)throw new s}next(De){(0,ie.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const X of this.currentObservers)X.next(De)}})}error(De){(0,ie.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=De;const{observers:X}=this;for(;X.length;)X.shift().error(De)}})}complete(){(0,ie.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:De}=this;for(;De.length;)De.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var De;return(null===(De=this.observers)||void 0===De?void 0:De.length)>0}_trySubscribe(De){return this._throwIfClosed(),super._trySubscribe(De)}_subscribe(De){return this._throwIfClosed(),this._checkFinalizedStatuses(De),this._innerSubscribe(De)}_innerSubscribe(De){const{hasError:X,isStopped:se,observers:Te}=this;return X||se?d.Lc:(this.currentObservers=null,Te.push(De),new d.w0(()=>{this.currentObservers=null,(0,Q.P)(Te,De)}))}_checkFinalizedStatuses(De){const{hasError:X,thrownError:se,isStopped:Te}=this;X?De.error(se):Te&&De.complete()}asObservable(){const De=new v.y;return De.source=this,De}}return fe.create=(Ae,De)=>new w(Ae,De),fe})();class w extends W{constructor(Ae,De){super(),this.destination=Ae,this.source=De}next(Ae){var De,X;null===(X=null===(De=this.destination)||void 0===De?void 0:De.next)||void 0===X||X.call(De,Ae)}error(Ae){var De,X;null===(X=null===(De=this.destination)||void 0===De?void 0:De.error)||void 0===X||X.call(De,Ae)}complete(){var Ae,De;null===(De=null===(Ae=this.destination)||void 0===Ae?void 0:Ae.complete)||void 0===De||De.call(Ae)}_subscribe(Ae){var De,X;return null!==(X=null===(De=this.source)||void 0===De?void 0:De.subscribe(Ae))&&void 0!==X?X:d.Lc}}},1887:(zn,Ct,R)=>{"use strict";R.d(Ct,{Hp:()=>we,Lv:()=>X});var v=R(4674),d=R(7394),y=R(2653),s=R(3894);function Q(){}const ie=fe("C",void 0,void 0);function fe(Oe,Ce,nt){return{kind:Oe,value:Ce,error:nt}}var Ae=R(7599),De=R(1441);class X extends d.w0{constructor(Ce){super(),this.isStopped=!1,Ce?(this.destination=Ce,(0,d.Nn)(Ce)&&Ce.add(this)):this.destination=Ke}static create(Ce,nt,Xe){return new we(Ce,nt,Xe)}next(Ce){this.isStopped?ze(function w(Oe){return fe("N",Oe,void 0)}(Ce),this):this._next(Ce)}error(Ce){this.isStopped?ze(function W(Oe){return fe("E",void 0,Oe)}(Ce),this):(this.isStopped=!0,this._error(Ce))}complete(){this.isStopped?ze(ie,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(Ce){this.destination.next(Ce)}_error(Ce){try{this.destination.error(Ce)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const se=Function.prototype.bind;function Te(Oe,Ce){return se.call(Oe,Ce)}class ge{constructor(Ce){this.partialObserver=Ce}next(Ce){const{partialObserver:nt}=this;if(nt.next)try{nt.next(Ce)}catch(Xe){Le(Xe)}}error(Ce){const{partialObserver:nt}=this;if(nt.error)try{nt.error(Ce)}catch(Xe){Le(Xe)}else Le(Ce)}complete(){const{partialObserver:Ce}=this;if(Ce.complete)try{Ce.complete()}catch(nt){Le(nt)}}}class we extends X{constructor(Ce,nt,Xe){let Ee;if(super(),(0,v.m)(Ce)||!Ce)Ee={next:Ce??void 0,error:nt??void 0,complete:Xe??void 0};else{let ae;this&&y.config.useDeprecatedNextContext?(ae=Object.create(Ce),ae.unsubscribe=()=>this.unsubscribe(),Ee={next:Ce.next&&Te(Ce.next,ae),error:Ce.error&&Te(Ce.error,ae),complete:Ce.complete&&Te(Ce.complete,ae)}):Ee=Ce}this.destination=new ge(Ee)}}function Le(Oe){y.config.useDeprecatedSynchronousErrorHandling?(0,De.O)(Oe):(0,s.h)(Oe)}function ze(Oe,Ce){const{onStoppedNotification:nt}=y.config;nt&&Ae.z.setTimeout(()=>nt(Oe,Ce))}const Ke={closed:!0,next:Q,error:function Me(Oe){throw Oe},complete:Q}},7394:(zn,Ct,R)=>{"use strict";R.d(Ct,{Lc:()=>ie,w0:()=>Q,Nn:()=>W});var v=R(4674);const y=(0,R(2306).d)(fe=>function(De){fe(this),this.message=De?`${De.length} errors occurred during unsubscription:\n${De.map((X,se)=>`${se+1}) ${X.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=De});var s=R(9039);class Q{constructor(Ae){this.initialTeardown=Ae,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ae;if(!this.closed){this.closed=!0;const{_parentage:De}=this;if(De)if(this._parentage=null,Array.isArray(De))for(const Te of De)Te.remove(this);else De.remove(this);const{initialTeardown:X}=this;if((0,v.m)(X))try{X()}catch(Te){Ae=Te instanceof y?Te.errors:[Te]}const{_finalizers:se}=this;if(se){this._finalizers=null;for(const Te of se)try{w(Te)}catch(ge){Ae=Ae??[],ge instanceof y?Ae=[...Ae,...ge.errors]:Ae.push(ge)}}if(Ae)throw new y(Ae)}}add(Ae){var De;if(Ae&&Ae!==this)if(this.closed)w(Ae);else{if(Ae instanceof Q){if(Ae.closed||Ae._hasParent(this))return;Ae._addParent(this)}(this._finalizers=null!==(De=this._finalizers)&&void 0!==De?De:[]).push(Ae)}}_hasParent(Ae){const{_parentage:De}=this;return De===Ae||Array.isArray(De)&&De.includes(Ae)}_addParent(Ae){const{_parentage:De}=this;this._parentage=Array.isArray(De)?(De.push(Ae),De):De?[De,Ae]:Ae}_removeParent(Ae){const{_parentage:De}=this;De===Ae?this._parentage=null:Array.isArray(De)&&(0,s.P)(De,Ae)}remove(Ae){const{_finalizers:De}=this;De&&(0,s.P)(De,Ae),Ae instanceof Q&&Ae._removeParent(this)}}Q.EMPTY=(()=>{const fe=new Q;return fe.closed=!0,fe})();const ie=Q.EMPTY;function W(fe){return fe instanceof Q||fe&&"closed"in fe&&(0,v.m)(fe.remove)&&(0,v.m)(fe.add)&&(0,v.m)(fe.unsubscribe)}function w(fe){(0,v.m)(fe)?fe():fe.unsubscribe()}},2653:(zn,Ct,R)=>{"use strict";R.d(Ct,{config:()=>v});const v={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},5211:(zn,Ct,R)=>{"use strict";R.d(Ct,{z:()=>Q});var v=R(7537),y=R(4564),s=R(7715);function Q(...ie){return function d(){return(0,v.J)(1)}()((0,s.D)(ie,(0,y.yG)(ie)))}},4911:(zn,Ct,R)=>{"use strict";R.d(Ct,{P:()=>y});var v=R(5592),d=R(4829);function y(s){return new v.y(Q=>{(0,d.Xf)(s()).subscribe(Q)})}},6232:(zn,Ct,R)=>{"use strict";R.d(Ct,{E:()=>d});const d=new(R(5592).y)(Q=>Q.complete())},9315:(zn,Ct,R)=>{"use strict";R.d(Ct,{D:()=>w});var v=R(5592),d=R(7453),y=R(4829),s=R(4564),Q=R(8251),ie=R(7400),W=R(2714);function w(...fe){const Ae=(0,s.jO)(fe),{args:De,keys:X}=(0,d.D)(fe),se=new v.y(Te=>{const{length:ge}=De;if(!ge)return void Te.complete();const we=new Array(ge);let Le=ge,Me=ge;for(let ze=0;ze<ge;ze++){let Ke=!1;(0,y.Xf)(De[ze]).subscribe((0,Q.x)(Te,Oe=>{Ke||(Ke=!0,Me--),we[ze]=Oe},()=>Le--,void 0,()=>{(!Le||!Ke)&&(Me||Te.next(X?(0,W.n)(X,we):we),Te.complete())}))}});return Ae?se.pipe((0,ie.Z)(Ae)):se}},7715:(zn,Ct,R)=>{"use strict";R.d(Ct,{D:()=>Xe});var v=R(4829),d=R(7103),y=R(9360),s=R(8251);function Q(Ee,ae=0){return(0,y.e)((mt,xe)=>{mt.subscribe((0,s.x)(xe,Ze=>(0,d.f)(xe,Ee,()=>xe.next(Ze),ae),()=>(0,d.f)(xe,Ee,()=>xe.complete(),ae),Ze=>(0,d.f)(xe,Ee,()=>xe.error(Ze),ae)))})}function ie(Ee,ae=0){return(0,y.e)((mt,xe)=>{xe.add(Ee.schedule(()=>mt.subscribe(xe),ae))})}var fe=R(5592),De=R(4971),X=R(4674);function Te(Ee,ae){if(!Ee)throw new Error("Iterable cannot be null");return new fe.y(mt=>{(0,d.f)(mt,ae,()=>{const xe=Ee[Symbol.asyncIterator]();(0,d.f)(mt,ae,()=>{xe.next().then(Ze=>{Ze.done?mt.complete():mt.next(Ze.value)})},0,!0)})})}var ge=R(8382),we=R(4026),Le=R(4266),Me=R(3664),ze=R(5726),Ke=R(9853),Oe=R(541);function Xe(Ee,ae){return ae?function nt(Ee,ae){if(null!=Ee){if((0,ge.c)(Ee))return function W(Ee,ae){return(0,v.Xf)(Ee).pipe(ie(ae),Q(ae))}(Ee,ae);if((0,Le.z)(Ee))return function Ae(Ee,ae){return new fe.y(mt=>{let xe=0;return ae.schedule(function(){xe===Ee.length?mt.complete():(mt.next(Ee[xe++]),mt.closed||this.schedule())})})}(Ee,ae);if((0,we.t)(Ee))return function w(Ee,ae){return(0,v.Xf)(Ee).pipe(ie(ae),Q(ae))}(Ee,ae);if((0,ze.D)(Ee))return Te(Ee,ae);if((0,Me.T)(Ee))return function se(Ee,ae){return new fe.y(mt=>{let xe;return(0,d.f)(mt,ae,()=>{xe=Ee[De.h](),(0,d.f)(mt,ae,()=>{let Ze,Se;try{({value:Ze,done:Se}=xe.next())}catch(ye){return void mt.error(ye)}Se?mt.complete():mt.next(Ze)},0,!0)}),()=>(0,X.m)(xe?.return)&&xe.return()})}(Ee,ae);if((0,Oe.L)(Ee))return function Ce(Ee,ae){return Te((0,Oe.Q)(Ee),ae)}(Ee,ae)}throw(0,Ke.z)(Ee)}(Ee,ae):(0,v.Xf)(Ee)}},2438:(zn,Ct,R)=>{"use strict";R.d(Ct,{R:()=>Ae});var v=R(4829),d=R(5592),y=R(1631),s=R(4266),Q=R(4674),ie=R(7400);const W=["addListener","removeListener"],w=["addEventListener","removeEventListener"],fe=["on","off"];function Ae(ge,we,Le,Me){if((0,Q.m)(Le)&&(Me=Le,Le=void 0),Me)return Ae(ge,we,Le).pipe((0,ie.Z)(Me));const[ze,Ke]=function Te(ge){return(0,Q.m)(ge.addEventListener)&&(0,Q.m)(ge.removeEventListener)}(ge)?w.map(Oe=>Ce=>ge[Oe](we,Ce,Le)):function X(ge){return(0,Q.m)(ge.addListener)&&(0,Q.m)(ge.removeListener)}(ge)?W.map(De(ge,we)):function se(ge){return(0,Q.m)(ge.on)&&(0,Q.m)(ge.off)}(ge)?fe.map(De(ge,we)):[];if(!ze&&(0,s.z)(ge))return(0,y.z)(Oe=>Ae(Oe,we,Le))((0,v.Xf)(ge));if(!ze)throw new TypeError("Invalid event target");return new d.y(Oe=>{const Ce=(...nt)=>Oe.next(1<nt.length?nt:nt[0]);return ze(Ce),()=>Ke(Ce)})}function De(ge,we){return Le=>Me=>ge[Le](we,Me)}},4829:(zn,Ct,R)=>{"use strict";R.d(Ct,{Xf:()=>se});var v=R(7582),d=R(4266),y=R(4026),s=R(5592),Q=R(8382),ie=R(5726),W=R(9853),w=R(3664),fe=R(541),Ae=R(4674),De=R(3894),X=R(4850);function se(Oe){if(Oe instanceof s.y)return Oe;if(null!=Oe){if((0,Q.c)(Oe))return function Te(Oe){return new s.y(Ce=>{const nt=Oe[X.L]();if((0,Ae.m)(nt.subscribe))return nt.subscribe(Ce);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Oe);if((0,d.z)(Oe))return function ge(Oe){return new s.y(Ce=>{for(let nt=0;nt<Oe.length&&!Ce.closed;nt++)Ce.next(Oe[nt]);Ce.complete()})}(Oe);if((0,y.t)(Oe))return function we(Oe){return new s.y(Ce=>{Oe.then(nt=>{Ce.closed||(Ce.next(nt),Ce.complete())},nt=>Ce.error(nt)).then(null,De.h)})}(Oe);if((0,ie.D)(Oe))return Me(Oe);if((0,w.T)(Oe))return function Le(Oe){return new s.y(Ce=>{for(const nt of Oe)if(Ce.next(nt),Ce.closed)return;Ce.complete()})}(Oe);if((0,fe.L)(Oe))return function ze(Oe){return Me((0,fe.Q)(Oe))}(Oe)}throw(0,W.z)(Oe)}function Me(Oe){return new s.y(Ce=>{(function Ke(Oe,Ce){var nt,Xe,Ee,ae;return(0,v.mG)(this,void 0,void 0,function*(){try{for(nt=(0,v.KL)(Oe);!(Xe=yield nt.next()).done;)if(Ce.next(Xe.value),Ce.closed)return}catch(mt){Ee={error:mt}}finally{try{Xe&&!Xe.done&&(ae=nt.return)&&(yield ae.call(nt))}finally{if(Ee)throw Ee.error}}Ce.complete()})})(Oe,Ce).catch(nt=>Ce.error(nt))})}},2096:(zn,Ct,R)=>{"use strict";R.d(Ct,{of:()=>y});var v=R(4564),d=R(7715);function y(...s){const Q=(0,v.yG)(s);return(0,d.D)(s,Q)}},8251:(zn,Ct,R)=>{"use strict";R.d(Ct,{x:()=>d});var v=R(1887);function d(s,Q,ie,W,w){return new y(s,Q,ie,W,w)}class y extends v.Lv{constructor(Q,ie,W,w,fe,Ae){super(Q),this.onFinalize=fe,this.shouldUnsubscribe=Ae,this._next=ie?function(De){try{ie(De)}catch(X){Q.error(X)}}:super._next,this._error=w?function(De){try{w(De)}catch(X){Q.error(X)}finally{this.unsubscribe()}}:super._error,this._complete=W?function(){try{W()}catch(De){Q.error(De)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var Q;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:ie}=this;super.unsubscribe(),!ie&&(null===(Q=this.onFinalize)||void 0===Q||Q.call(this))}}}},6328:(zn,Ct,R)=>{"use strict";R.d(Ct,{b:()=>y});var v=R(1631),d=R(4674);function y(s,Q){return(0,d.m)(Q)?(0,v.z)(s,Q,1):(0,v.z)(s,1)}},3997:(zn,Ct,R)=>{"use strict";R.d(Ct,{x:()=>s});var v=R(2737),d=R(9360),y=R(8251);function s(ie,W=v.y){return ie=ie??Q,(0,d.e)((w,fe)=>{let Ae,De=!0;w.subscribe((0,y.x)(fe,X=>{const se=W(X);(De||!ie(Ae,se))&&(De=!1,Ae=se,fe.next(X))}))})}function Q(ie,W){return ie===W}},2181:(zn,Ct,R)=>{"use strict";R.d(Ct,{h:()=>y});var v=R(9360),d=R(8251);function y(s,Q){return(0,v.e)((ie,W)=>{let w=0;ie.subscribe((0,d.x)(W,fe=>s.call(Q,fe,w++)&&W.next(fe)))})}},4716:(zn,Ct,R)=>{"use strict";R.d(Ct,{x:()=>d});var v=R(9360);function d(y){return(0,v.e)((s,Q)=>{try{s.subscribe(Q)}finally{Q.add(y)}})}},7398:(zn,Ct,R)=>{"use strict";R.d(Ct,{U:()=>y});var v=R(9360),d=R(8251);function y(s,Q){return(0,v.e)((ie,W)=>{let w=0;ie.subscribe((0,d.x)(W,fe=>{W.next(s.call(Q,fe,w++))}))})}},7537:(zn,Ct,R)=>{"use strict";R.d(Ct,{J:()=>y});var v=R(1631),d=R(2737);function y(s=1/0){return(0,v.z)(d.y,s)}},1631:(zn,Ct,R)=>{"use strict";R.d(Ct,{z:()=>w});var v=R(7398),d=R(4829),y=R(9360),s=R(7103),Q=R(8251),W=R(4674);function w(fe,Ae,De=1/0){return(0,W.m)(Ae)?w((X,se)=>(0,v.U)((Te,ge)=>Ae(X,Te,se,ge))((0,d.Xf)(fe(X,se))),De):("number"==typeof Ae&&(De=Ae),(0,y.e)((X,se)=>function ie(fe,Ae,De,X,se,Te,ge,we){const Le=[];let Me=0,ze=0,Ke=!1;const Oe=()=>{Ke&&!Le.length&&!Me&&Ae.complete()},Ce=Xe=>Me<X?nt(Xe):Le.push(Xe),nt=Xe=>{Te&&Ae.next(Xe),Me++;let Ee=!1;(0,d.Xf)(De(Xe,ze++)).subscribe((0,Q.x)(Ae,ae=>{se?.(ae),Te?Ce(ae):Ae.next(ae)},()=>{Ee=!0},void 0,()=>{if(Ee)try{for(Me--;Le.length&&Me<X;){const ae=Le.shift();ge?(0,s.f)(Ae,ge,()=>nt(ae)):nt(ae)}Oe()}catch(ae){Ae.error(ae)}}))};return fe.subscribe((0,Q.x)(Ae,Ce,()=>{Ke=!0,Oe()})),()=>{we?.()}}(X,se,fe,De)))}},3020:(zn,Ct,R)=>{"use strict";R.d(Ct,{B:()=>Q});var v=R(4829),d=R(8645),y=R(1887),s=R(9360);function Q(W={}){const{connector:w=(()=>new d.x),resetOnError:fe=!0,resetOnComplete:Ae=!0,resetOnRefCountZero:De=!0}=W;return X=>{let se,Te,ge,we=0,Le=!1,Me=!1;const ze=()=>{Te?.unsubscribe(),Te=void 0},Ke=()=>{ze(),se=ge=void 0,Le=Me=!1},Oe=()=>{const Ce=se;Ke(),Ce?.unsubscribe()};return(0,s.e)((Ce,nt)=>{we++,!Me&&!Le&&ze();const Xe=ge=ge??w();nt.add(()=>{we--,0===we&&!Me&&!Le&&(Te=ie(Oe,De))}),Xe.subscribe(nt),!se&&we>0&&(se=new y.Hp({next:Ee=>Xe.next(Ee),error:Ee=>{Me=!0,ze(),Te=ie(Ke,fe,Ee),Xe.error(Ee)},complete:()=>{Le=!0,ze(),Te=ie(Ke,Ae),Xe.complete()}}),(0,v.Xf)(Ce).subscribe(se))})(X)}}function ie(W,w,...fe){if(!0===w)return void W();if(!1===w)return;const Ae=new y.Hp({next:()=>{Ae.unsubscribe(),W()}});return(0,v.Xf)(w(...fe)).subscribe(Ae)}},4664:(zn,Ct,R)=>{"use strict";R.d(Ct,{w:()=>s});var v=R(4829),d=R(9360),y=R(8251);function s(Q,ie){return(0,d.e)((W,w)=>{let fe=null,Ae=0,De=!1;const X=()=>De&&!fe&&w.complete();W.subscribe((0,y.x)(w,se=>{fe?.unsubscribe();let Te=0;const ge=Ae++;(0,v.Xf)(Q(se,ge)).subscribe(fe=(0,y.x)(w,we=>w.next(ie?ie(se,we,ge,Te++):we),()=>{fe=null,X()}))},()=>{De=!0,X()}))})}},8180:(zn,Ct,R)=>{"use strict";R.d(Ct,{q:()=>s});var v=R(6232),d=R(9360),y=R(8251);function s(Q){return Q<=0?()=>v.E:(0,d.e)((ie,W)=>{let w=0;ie.subscribe((0,y.x)(W,fe=>{++w<=Q&&(W.next(fe),Q<=w&&W.complete())}))})}},4552:(zn,Ct,R)=>{"use strict";R.d(Ct,{l:()=>v});const v={now:()=>(v.delegate||Date).now(),delegate:void 0}},7599:(zn,Ct,R)=>{"use strict";R.d(Ct,{z:()=>v});const v={setTimeout(d,y,...s){const{delegate:Q}=v;return Q?.setTimeout?Q.setTimeout(d,y,...s):setTimeout(d,y,...s)},clearTimeout(d){const{delegate:y}=v;return(y?.clearTimeout||clearTimeout)(d)},delegate:void 0}},4971:(zn,Ct,R)=>{"use strict";R.d(Ct,{h:()=>d});const d=function v(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(zn,Ct,R)=>{"use strict";R.d(Ct,{L:()=>v});const v="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(zn,Ct,R)=>{"use strict";R.d(Ct,{_6:()=>ie,jO:()=>s,yG:()=>Q});var v=R(4674);function y(W){return W[W.length-1]}function s(W){return(0,v.m)(y(W))?W.pop():void 0}function Q(W){return function d(W){return W&&(0,v.m)(W.schedule)}(y(W))?W.pop():void 0}function ie(W,w){return"number"==typeof y(W)?W.pop():w}},7453:(zn,Ct,R)=>{"use strict";R.d(Ct,{D:()=>Q});const{isArray:v}=Array,{getPrototypeOf:d,prototype:y,keys:s}=Object;function Q(W){if(1===W.length){const w=W[0];if(v(w))return{args:w,keys:null};if(function ie(W){return W&&"object"==typeof W&&d(W)===y}(w)){const fe=s(w);return{args:fe.map(Ae=>w[Ae]),keys:fe}}}return{args:W,keys:null}}},9039:(zn,Ct,R)=>{"use strict";function v(d,y){if(d){const s=d.indexOf(y);0<=s&&d.splice(s,1)}}R.d(Ct,{P:()=>v})},2306:(zn,Ct,R)=>{"use strict";function v(d){const s=d(Q=>{Error.call(Q),Q.stack=(new Error).stack});return s.prototype=Object.create(Error.prototype),s.prototype.constructor=s,s}R.d(Ct,{d:()=>v})},2714:(zn,Ct,R)=>{"use strict";function v(d,y){return d.reduce((s,Q,ie)=>(s[Q]=y[ie],s),{})}R.d(Ct,{n:()=>v})},1441:(zn,Ct,R)=>{"use strict";R.d(Ct,{O:()=>s,x:()=>y});var v=R(2653);let d=null;function y(Q){if(v.config.useDeprecatedSynchronousErrorHandling){const ie=!d;if(ie&&(d={errorThrown:!1,error:null}),Q(),ie){const{errorThrown:W,error:w}=d;if(d=null,W)throw w}}else Q()}function s(Q){v.config.useDeprecatedSynchronousErrorHandling&&d&&(d.errorThrown=!0,d.error=Q)}},7103:(zn,Ct,R)=>{"use strict";function v(d,y,s,Q=0,ie=!1){const W=y.schedule(function(){s(),ie?d.add(this.schedule(null,Q)):this.unsubscribe()},Q);if(d.add(W),!ie)return W}R.d(Ct,{f:()=>v})},2737:(zn,Ct,R)=>{"use strict";function v(d){return d}R.d(Ct,{y:()=>v})},4266:(zn,Ct,R)=>{"use strict";R.d(Ct,{z:()=>v});const v=d=>d&&"number"==typeof d.length&&"function"!=typeof d},5726:(zn,Ct,R)=>{"use strict";R.d(Ct,{D:()=>d});var v=R(4674);function d(y){return Symbol.asyncIterator&&(0,v.m)(y?.[Symbol.asyncIterator])}},4674:(zn,Ct,R)=>{"use strict";function v(d){return"function"==typeof d}R.d(Ct,{m:()=>v})},8382:(zn,Ct,R)=>{"use strict";R.d(Ct,{c:()=>y});var v=R(4850),d=R(4674);function y(s){return(0,d.m)(s[v.L])}},3664:(zn,Ct,R)=>{"use strict";R.d(Ct,{T:()=>y});var v=R(4971),d=R(4674);function y(s){return(0,d.m)(s?.[v.h])}},2664:(zn,Ct,R)=>{"use strict";R.d(Ct,{b:()=>y});var v=R(5592),d=R(4674);function y(s){return!!s&&(s instanceof v.y||(0,d.m)(s.lift)&&(0,d.m)(s.subscribe))}},4026:(zn,Ct,R)=>{"use strict";R.d(Ct,{t:()=>d});var v=R(4674);function d(y){return(0,v.m)(y?.then)}},541:(zn,Ct,R)=>{"use strict";R.d(Ct,{L:()=>s,Q:()=>y});var v=R(7582),d=R(4674);function y(Q){return(0,v.FC)(this,arguments,function*(){const W=Q.getReader();try{for(;;){const{value:w,done:fe}=yield(0,v.qq)(W.read());if(fe)return yield(0,v.qq)(void 0);yield yield(0,v.qq)(w)}}finally{W.releaseLock()}})}function s(Q){return(0,d.m)(Q?.getReader)}},9360:(zn,Ct,R)=>{"use strict";R.d(Ct,{A:()=>d,e:()=>y});var v=R(4674);function d(s){return(0,v.m)(s?.lift)}function y(s){return Q=>{if(d(Q))return Q.lift(function(ie){try{return s(ie,this)}catch(W){this.error(W)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(zn,Ct,R)=>{"use strict";R.d(Ct,{Z:()=>s});var v=R(7398);const{isArray:d}=Array;function s(Q){return(0,v.U)(ie=>function y(Q,ie){return d(ie)?Q(...ie):Q(ie)}(Q,ie))}},8407:(zn,Ct,R)=>{"use strict";R.d(Ct,{U:()=>y,z:()=>d});var v=R(2737);function d(...s){return y(s)}function y(s){return 0===s.length?v.y:1===s.length?s[0]:function(ie){return s.reduce((W,w)=>w(W),ie)}}},3894:(zn,Ct,R)=>{"use strict";R.d(Ct,{h:()=>y});var v=R(2653),d=R(7599);function y(s){d.z.setTimeout(()=>{const{onUnhandledError:Q}=v.config;if(!Q)throw s;Q(s)})}},9853:(zn,Ct,R)=>{"use strict";function v(d){return new TypeError(`You provided ${null!==d&&"object"==typeof d?"an invalid object":`'${d}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}R.d(Ct,{z:()=>v})},863:(zn,Ct,R)=>{var v={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,3591,433],"./ion-datetime_3.entry.js":[7059,3591,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function d(y){if(!R.o(v,y))return Promise.resolve().then(()=>{var ie=new Error("Cannot find module '"+y+"'");throw ie.code="MODULE_NOT_FOUND",ie});var s=v[y],Q=s[0];return Promise.all(s.slice(1).map(R.e)).then(()=>R(Q))}d.keys=()=>Object.keys(v),d.id=863,zn.exports=d},6814:(zn,Ct,R)=>{"use strict";R.d(Ct,{Do:()=>we,EM:()=>Qr,HT:()=>s,JF:()=>Ss,JJ:()=>jo,K0:()=>ie,Mx:()=>io,O5:()=>Mr,PM:()=>br,S$:()=>se,V_:()=>w,Ye:()=>Le,b0:()=>ge,bD:()=>Xr,ez:()=>ta,q:()=>y,sg:()=>gr,tP:()=>Tn,uU:()=>ea,w_:()=>Q});var v=R(2029);let d=null;function y(){return d}function s(Z){d||(d=Z)}class Q{}const ie=new v.OlP("DocumentToken");let W=(()=>{class Z{historyGo(q){throw new Error("Not implemented")}}return Z.\u0275fac=function(q){return new(q||Z)},Z.\u0275prov=v.Yz7({token:Z,factory:function(){return(0,v.f3M)(fe)},providedIn:"platform"}),Z})();const w=new v.OlP("Location Initialized");let fe=(()=>{class Z extends W{constructor(){super(),this._doc=(0,v.f3M)(ie),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return y().getBaseHref(this._doc)}onPopState(q){const be=y().getGlobalEventTarget(this._doc,"window");return be.addEventListener("popstate",q,!1),()=>be.removeEventListener("popstate",q)}onHashChange(q){const be=y().getGlobalEventTarget(this._doc,"window");return be.addEventListener("hashchange",q,!1),()=>be.removeEventListener("hashchange",q)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(q){this._location.pathname=q}pushState(q,be,Tt){this._history.pushState(q,be,Tt)}replaceState(q,be,Tt){this._history.replaceState(q,be,Tt)}forward(){this._history.forward()}back(){this._history.back()}historyGo(q=0){this._history.go(q)}getState(){return this._history.state}}return Z.\u0275fac=function(q){return new(q||Z)},Z.\u0275prov=v.Yz7({token:Z,factory:function(){return new Z},providedIn:"platform"}),Z})();function Ae(Z,de){if(0==Z.length)return de;if(0==de.length)return Z;let q=0;return Z.endsWith("/")&&q++,de.startsWith("/")&&q++,2==q?Z+de.substring(1):1==q?Z+de:Z+"/"+de}function De(Z){const de=Z.match(/#|\?|$/),q=de&&de.index||Z.length;return Z.slice(0,q-("/"===Z[q-1]?1:0))+Z.slice(q)}function X(Z){return Z&&"?"!==Z[0]?"?"+Z:Z}let se=(()=>{class Z{historyGo(q){throw new Error("Not implemented")}}return Z.\u0275fac=function(q){return new(q||Z)},Z.\u0275prov=v.Yz7({token:Z,factory:function(){return(0,v.f3M)(ge)},providedIn:"root"}),Z})();const Te=new v.OlP("appBaseHref");let ge=(()=>{class Z extends se{constructor(q,be){super(),this._platformLocation=q,this._removeListenerFns=[],this._baseHref=be??this._platformLocation.getBaseHrefFromDOM()??(0,v.f3M)(ie).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(q){this._removeListenerFns.push(this._platformLocation.onPopState(q),this._platformLocation.onHashChange(q))}getBaseHref(){return this._baseHref}prepareExternalUrl(q){return Ae(this._baseHref,q)}path(q=!1){const be=this._platformLocation.pathname+X(this._platformLocation.search),Tt=this._platformLocation.hash;return Tt&&q?`${be}${Tt}`:be}pushState(q,be,Tt,vn){const Dn=this.prepareExternalUrl(Tt+X(vn));this._platformLocation.pushState(q,be,Dn)}replaceState(q,be,Tt,vn){const Dn=this.prepareExternalUrl(Tt+X(vn));this._platformLocation.replaceState(q,be,Dn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(q=0){this._platformLocation.historyGo?.(q)}}return Z.\u0275fac=function(q){return new(q||Z)(v.LFG(W),v.LFG(Te,8))},Z.\u0275prov=v.Yz7({token:Z,factory:Z.\u0275fac,providedIn:"root"}),Z})(),we=(()=>{class Z extends se{constructor(q,be){super(),this._platformLocation=q,this._baseHref="",this._removeListenerFns=[],null!=be&&(this._baseHref=be)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(q){this._removeListenerFns.push(this._platformLocation.onPopState(q),this._platformLocation.onHashChange(q))}getBaseHref(){return this._baseHref}path(q=!1){let be=this._platformLocation.hash;return null==be&&(be="#"),be.length>0?be.substring(1):be}prepareExternalUrl(q){const be=Ae(this._baseHref,q);return be.length>0?"#"+be:be}pushState(q,be,Tt,vn){let Dn=this.prepareExternalUrl(Tt+X(vn));0==Dn.length&&(Dn=this._platformLocation.pathname),this._platformLocation.pushState(q,be,Dn)}replaceState(q,be,Tt,vn){let Dn=this.prepareExternalUrl(Tt+X(vn));0==Dn.length&&(Dn=this._platformLocation.pathname),this._platformLocation.replaceState(q,be,Dn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(q=0){this._platformLocation.historyGo?.(q)}}return Z.\u0275fac=function(q){return new(q||Z)(v.LFG(W),v.LFG(Te,8))},Z.\u0275prov=v.Yz7({token:Z,factory:Z.\u0275fac}),Z})(),Le=(()=>{class Z{constructor(q){this._subject=new v.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=q;const be=this._locationStrategy.getBaseHref();this._basePath=function Oe(Z){if(new RegExp("^(https?:)?//").test(Z)){const[,q]=Z.split(/\/\/[^\/]+/);return q}return Z}(De(Ke(be))),this._locationStrategy.onPopState(Tt=>{this._subject.emit({url:this.path(!0),pop:!0,state:Tt.state,type:Tt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(q=!1){return this.normalize(this._locationStrategy.path(q))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(q,be=""){return this.path()==this.normalize(q+X(be))}normalize(q){return Z.stripTrailingSlash(function ze(Z,de){if(!Z||!de.startsWith(Z))return de;const q=de.substring(Z.length);return""===q||["/",";","?","#"].includes(q[0])?q:de}(this._basePath,Ke(q)))}prepareExternalUrl(q){return q&&"/"!==q[0]&&(q="/"+q),this._locationStrategy.prepareExternalUrl(q)}go(q,be="",Tt=null){this._locationStrategy.pushState(Tt,"",q,be),this._notifyUrlChangeListeners(this.prepareExternalUrl(q+X(be)),Tt)}replaceState(q,be="",Tt=null){this._locationStrategy.replaceState(Tt,"",q,be),this._notifyUrlChangeListeners(this.prepareExternalUrl(q+X(be)),Tt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(q=0){this._locationStrategy.historyGo?.(q)}onUrlChange(q){return this._urlChangeListeners.push(q),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(be=>{this._notifyUrlChangeListeners(be.url,be.state)})),()=>{const be=this._urlChangeListeners.indexOf(q);this._urlChangeListeners.splice(be,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(q="",be){this._urlChangeListeners.forEach(Tt=>Tt(q,be))}subscribe(q,be,Tt){return this._subject.subscribe({next:q,error:be,complete:Tt})}}return Z.normalizeQueryParams=X,Z.joinWithSlash=Ae,Z.stripTrailingSlash=De,Z.\u0275fac=function(q){return new(q||Z)(v.LFG(se))},Z.\u0275prov=v.Yz7({token:Z,factory:function(){return function Me(){return new Le((0,v.LFG)(se))}()},providedIn:"root"}),Z})();function Ke(Z){return Z.replace(/\/index.html$/,"")}var nt=(()=>((nt=nt||{})[nt.Decimal=0]="Decimal",nt[nt.Percent=1]="Percent",nt[nt.Currency=2]="Currency",nt[nt.Scientific=3]="Scientific",nt))(),Ee=(()=>((Ee=Ee||{})[Ee.Format=0]="Format",Ee[Ee.Standalone=1]="Standalone",Ee))(),ae=(()=>((ae=ae||{})[ae.Narrow=0]="Narrow",ae[ae.Abbreviated=1]="Abbreviated",ae[ae.Wide=2]="Wide",ae[ae.Short=3]="Short",ae))(),mt=(()=>((mt=mt||{})[mt.Short=0]="Short",mt[mt.Medium=1]="Medium",mt[mt.Long=2]="Long",mt[mt.Full=3]="Full",mt))(),xe=(()=>((xe=xe||{})[xe.Decimal=0]="Decimal",xe[xe.Group=1]="Group",xe[xe.List=2]="List",xe[xe.PercentSign=3]="PercentSign",xe[xe.PlusSign=4]="PlusSign",xe[xe.MinusSign=5]="MinusSign",xe[xe.Exponential=6]="Exponential",xe[xe.SuperscriptingExponent=7]="SuperscriptingExponent",xe[xe.PerMille=8]="PerMille",xe[xe.Infinity=9]="Infinity",xe[xe.NaN=10]="NaN",xe[xe.TimeSeparator=11]="TimeSeparator",xe[xe.CurrencyDecimal=12]="CurrencyDecimal",xe[xe.CurrencyGroup=13]="CurrencyGroup",xe))();function vt(Z,de){return dn((0,v.cg1)(Z)[v.wAp.DateFormat],de)}function je(Z,de){return dn((0,v.cg1)(Z)[v.wAp.TimeFormat],de)}function _t(Z,de){return dn((0,v.cg1)(Z)[v.wAp.DateTimeFormat],de)}function Ne(Z,de){const q=(0,v.cg1)(Z),be=q[v.wAp.NumberSymbols][de];if(typeof be>"u"){if(de===xe.CurrencyDecimal)return q[v.wAp.NumberSymbols][xe.Decimal];if(de===xe.CurrencyGroup)return q[v.wAp.NumberSymbols][xe.Group]}return be}function Vt(Z){if(!Z[v.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${Z[v.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function dn(Z,de){for(let q=de;q>-1;q--)if(typeof Z[q]<"u")return Z[q];throw new Error("Locale data API: locale data undefined")}function Sn(Z){const[de,q]=Z.split(":");return{hours:+de,minutes:+q}}const gn=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,si={},Je=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var At=(()=>((At=At||{})[At.Short=0]="Short",At[At.ShortGMT=1]="ShortGMT",At[At.Long=2]="Long",At[At.Extended=3]="Extended",At))(),Zt=(()=>((Zt=Zt||{})[Zt.FullYear=0]="FullYear",Zt[Zt.Month=1]="Month",Zt[Zt.Date=2]="Date",Zt[Zt.Hours=3]="Hours",Zt[Zt.Minutes=4]="Minutes",Zt[Zt.Seconds=5]="Seconds",Zt[Zt.FractionalSeconds=6]="FractionalSeconds",Zt[Zt.Day=7]="Day",Zt))(),un=(()=>((un=un||{})[un.DayPeriods=0]="DayPeriods",un[un.Days=1]="Days",un[un.Months=2]="Months",un[un.Eras=3]="Eras",un))();function hn(Z,de,q,be){let Tt=function Ve(Z){if(me(Z))return Z;if("number"==typeof Z&&!isNaN(Z))return new Date(Z);if("string"==typeof Z){if(Z=Z.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(Z)){const[Tt,vn=1,Dn=1]=Z.split("-").map(Qn=>+Qn);return gi(Tt,vn-1,Dn)}const q=parseFloat(Z);if(!isNaN(Z-q))return new Date(q);let be;if(be=Z.match(gn))return function Y(Z){const de=new Date(0);let q=0,be=0;const Tt=Z[8]?de.setUTCFullYear:de.setFullYear,vn=Z[8]?de.setUTCHours:de.setHours;Z[9]&&(q=Number(Z[9]+Z[10]),be=Number(Z[9]+Z[11])),Tt.call(de,Number(Z[1]),Number(Z[2])-1,Number(Z[3]));const Dn=Number(Z[4]||0)-q,Qn=Number(Z[5]||0)-be,Co=Number(Z[6]||0),_o=Math.floor(1e3*parseFloat("0."+(Z[7]||0)));return vn.call(de,Dn,Qn,Co,_o),de}(be)}const de=new Date(Z);if(!me(de))throw new Error(`Unable to convert "${Z}" into a date`);return de}(Z);de=Yt(q,de)||de;let Qn,Dn=[];for(;de;){if(Qn=Je.exec(de),!Qn){Dn.push(de);break}{Dn=Dn.concat(Qn.slice(1));const Ki=Dn.pop();if(!Ki)break;de=Ki}}let Co=Tt.getTimezoneOffset();be&&(Co=Kt(be,Co),Tt=function tt(Z,de,q){const be=q?-1:1,Tt=Z.getTimezoneOffset();return function In(Z,de){return(Z=new Date(Z.getTime())).setMinutes(Z.getMinutes()+de),Z}(Z,be*(Kt(de,Tt)-Tt))}(Tt,be,!0));let _o="";return Dn.forEach(Ki=>{const lo=function St(Z){if(jt[Z])return jt[Z];let de;switch(Z){case"G":case"GG":case"GGG":de=fi(un.Eras,ae.Abbreviated);break;case"GGGG":de=fi(un.Eras,ae.Wide);break;case"GGGGG":de=fi(un.Eras,ae.Narrow);break;case"y":de=Oi(Zt.FullYear,1,0,!1,!0);break;case"yy":de=Oi(Zt.FullYear,2,0,!0,!0);break;case"yyy":de=Oi(Zt.FullYear,3,0,!1,!0);break;case"yyyy":de=Oi(Zt.FullYear,4,0,!1,!0);break;case"Y":de=Ut(1);break;case"YY":de=Ut(2,!0);break;case"YYY":de=Ut(3);break;case"YYYY":de=Ut(4);break;case"M":case"L":de=Oi(Zt.Month,1,1);break;case"MM":case"LL":de=Oi(Zt.Month,2,1);break;case"MMM":de=fi(un.Months,ae.Abbreviated);break;case"MMMM":de=fi(un.Months,ae.Wide);break;case"MMMMM":de=fi(un.Months,ae.Narrow);break;case"LLL":de=fi(un.Months,ae.Abbreviated,Ee.Standalone);break;case"LLLL":de=fi(un.Months,ae.Wide,Ee.Standalone);break;case"LLLLL":de=fi(un.Months,ae.Narrow,Ee.Standalone);break;case"w":de=Rt(1);break;case"ww":de=Rt(2);break;case"W":de=Rt(1,!0);break;case"d":de=Oi(Zt.Date,1);break;case"dd":de=Oi(Zt.Date,2);break;case"c":case"cc":de=Oi(Zt.Day,1);break;case"ccc":de=fi(un.Days,ae.Abbreviated,Ee.Standalone);break;case"cccc":de=fi(un.Days,ae.Wide,Ee.Standalone);break;case"ccccc":de=fi(un.Days,ae.Narrow,Ee.Standalone);break;case"cccccc":de=fi(un.Days,ae.Short,Ee.Standalone);break;case"E":case"EE":case"EEE":de=fi(un.Days,ae.Abbreviated);break;case"EEEE":de=fi(un.Days,ae.Wide);break;case"EEEEE":de=fi(un.Days,ae.Narrow);break;case"EEEEEE":de=fi(un.Days,ae.Short);break;case"a":case"aa":case"aaa":de=fi(un.DayPeriods,ae.Abbreviated);break;case"aaaa":de=fi(un.DayPeriods,ae.Wide);break;case"aaaaa":de=fi(un.DayPeriods,ae.Narrow);break;case"b":case"bb":case"bbb":de=fi(un.DayPeriods,ae.Abbreviated,Ee.Standalone,!0);break;case"bbbb":de=fi(un.DayPeriods,ae.Wide,Ee.Standalone,!0);break;case"bbbbb":de=fi(un.DayPeriods,ae.Narrow,Ee.Standalone,!0);break;case"B":case"BB":case"BBB":de=fi(un.DayPeriods,ae.Abbreviated,Ee.Format,!0);break;case"BBBB":de=fi(un.DayPeriods,ae.Wide,Ee.Format,!0);break;case"BBBBB":de=fi(un.DayPeriods,ae.Narrow,Ee.Format,!0);break;case"h":de=Oi(Zt.Hours,1,-12);break;case"hh":de=Oi(Zt.Hours,2,-12);break;case"H":de=Oi(Zt.Hours,1);break;case"HH":de=Oi(Zt.Hours,2);break;case"m":de=Oi(Zt.Minutes,1);break;case"mm":de=Oi(Zt.Minutes,2);break;case"s":de=Oi(Zt.Seconds,1);break;case"ss":de=Oi(Zt.Seconds,2);break;case"S":de=Oi(Zt.FractionalSeconds,1);break;case"SS":de=Oi(Zt.FractionalSeconds,2);break;case"SSS":de=Oi(Zt.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":de=ut(At.Short);break;case"ZZZZZ":de=ut(At.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":de=ut(At.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":de=ut(At.Long);break;default:return null}return jt[Z]=de,de}(Ki);_o+=lo?lo(Tt,q,Co):"''"===Ki?"'":Ki.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),_o}function gi(Z,de,q){const be=new Date(0);return be.setFullYear(Z,de,q),be.setHours(0,0,0),be}function Yt(Z,de){const q=function Se(Z){return(0,v.cg1)(Z)[v.wAp.LocaleId]}(Z);if(si[q]=si[q]||{},si[q][de])return si[q][de];let be="";switch(de){case"shortDate":be=vt(Z,mt.Short);break;case"mediumDate":be=vt(Z,mt.Medium);break;case"longDate":be=vt(Z,mt.Long);break;case"fullDate":be=vt(Z,mt.Full);break;case"shortTime":be=je(Z,mt.Short);break;case"mediumTime":be=je(Z,mt.Medium);break;case"longTime":be=je(Z,mt.Long);break;case"fullTime":be=je(Z,mt.Full);break;case"short":const Tt=Yt(Z,"shortTime"),vn=Yt(Z,"shortDate");be=Un(_t(Z,mt.Short),[Tt,vn]);break;case"medium":const Dn=Yt(Z,"mediumTime"),Qn=Yt(Z,"mediumDate");be=Un(_t(Z,mt.Medium),[Dn,Qn]);break;case"long":const Co=Yt(Z,"longTime"),_o=Yt(Z,"longDate");be=Un(_t(Z,mt.Long),[Co,_o]);break;case"full":const Ki=Yt(Z,"fullTime"),lo=Yt(Z,"fullDate");be=Un(_t(Z,mt.Full),[Ki,lo])}return be&&(si[q][de]=be),be}function Un(Z,de){return de&&(Z=Z.replace(/\{([^}]+)}/g,function(q,be){return null!=de&&be in de?de[be]:q})),Z}function oi(Z,de,q="-",be,Tt){let vn="";(Z<0||Tt&&Z<=0)&&(Tt?Z=1-Z:(Z=-Z,vn=q));let Dn=String(Z);for(;Dn.length<de;)Dn="0"+Dn;return be&&(Dn=Dn.slice(Dn.length-de)),vn+Dn}function Oi(Z,de,q=0,be=!1,Tt=!1){return function(vn,Dn){let Qn=function Po(Z,de){switch(Z){case Zt.FullYear:return de.getFullYear();case Zt.Month:return de.getMonth();case Zt.Date:return de.getDate();case Zt.Hours:return de.getHours();case Zt.Minutes:return de.getMinutes();case Zt.Seconds:return de.getSeconds();case Zt.FractionalSeconds:return de.getMilliseconds();case Zt.Day:return de.getDay();default:throw new Error(`Unknown DateType value "${Z}".`)}}(Z,vn);if((q>0||Qn>-q)&&(Qn+=q),Z===Zt.Hours)0===Qn&&-12===q&&(Qn=12);else if(Z===Zt.FractionalSeconds)return function Ci(Z,de){return oi(Z,3).substring(0,de)}(Qn,de);const Co=Ne(Dn,xe.MinusSign);return oi(Qn,de,Co,be,Tt)}}function fi(Z,de,q=Ee.Format,be=!1){return function(Tt,vn){return function Vo(Z,de,q,be,Tt,vn){switch(q){case un.Months:return function dt(Z,de,q){const be=(0,v.cg1)(Z),vn=dn([be[v.wAp.MonthsFormat],be[v.wAp.MonthsStandalone]],de);return dn(vn,q)}(de,Tt,be)[Z.getMonth()];case un.Days:return function Qt(Z,de,q){const be=(0,v.cg1)(Z),vn=dn([be[v.wAp.DaysFormat],be[v.wAp.DaysStandalone]],de);return dn(vn,q)}(de,Tt,be)[Z.getDay()];case un.DayPeriods:const Dn=Z.getHours(),Qn=Z.getMinutes();if(vn){const _o=function It(Z){const de=(0,v.cg1)(Z);return Vt(de),(de[v.wAp.ExtraData][2]||[]).map(be=>"string"==typeof be?Sn(be):[Sn(be[0]),Sn(be[1])])}(de),Ki=function at(Z,de,q){const be=(0,v.cg1)(Z);Vt(be);const vn=dn([be[v.wAp.ExtraData][0],be[v.wAp.ExtraData][1]],de)||[];return dn(vn,q)||[]}(de,Tt,be),lo=_o.findIndex(fr=>{if(Array.isArray(fr)){const[Ro,Eo]=fr,Ls=Dn>=Ro.hours&&Qn>=Ro.minutes,Ds=Dn<Eo.hours||Dn===Eo.hours&&Qn<Eo.minutes;if(Ro.hours<Eo.hours){if(Ls&&Ds)return!0}else if(Ls||Ds)return!0}else if(fr.hours===Dn&&fr.minutes===Qn)return!0;return!1});if(-1!==lo)return Ki[lo]}return function ye(Z,de,q){const be=(0,v.cg1)(Z),vn=dn([be[v.wAp.DayPeriodsFormat],be[v.wAp.DayPeriodsStandalone]],de);return dn(vn,q)}(de,Tt,be)[Dn<12?0:1];case un.Eras:return function gt(Z,de){return dn((0,v.cg1)(Z)[v.wAp.Eras],de)}(de,be)[Z.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${q}`)}}(Tt,vn,Z,de,q,be)}}function ut(Z){return function(de,q,be){const Tt=-1*be,vn=Ne(q,xe.MinusSign),Dn=Tt>0?Math.floor(Tt/60):Math.ceil(Tt/60);switch(Z){case At.Short:return(Tt>=0?"+":"")+oi(Dn,2,vn)+oi(Math.abs(Tt%60),2,vn);case At.ShortGMT:return"GMT"+(Tt>=0?"+":"")+oi(Dn,1,vn);case At.Long:return"GMT"+(Tt>=0?"+":"")+oi(Dn,2,vn)+":"+oi(Math.abs(Tt%60),2,vn);case At.Extended:return 0===be?"Z":(Tt>=0?"+":"")+oi(Dn,2,vn)+":"+oi(Math.abs(Tt%60),2,vn);default:throw new Error(`Unknown zone width "${Z}"`)}}}const pe=0,ve=4;function yt(Z){return gi(Z.getFullYear(),Z.getMonth(),Z.getDate()+(ve-Z.getDay()))}function Rt(Z,de=!1){return function(q,be){let Tt;if(de){const vn=new Date(q.getFullYear(),q.getMonth(),1).getDay()-1,Dn=q.getDate();Tt=1+Math.floor((Dn+vn)/7)}else{const vn=yt(q),Dn=function et(Z){const de=gi(Z,pe,1).getDay();return gi(Z,0,1+(de<=ve?ve:ve+7)-de)}(vn.getFullYear()),Qn=vn.getTime()-Dn.getTime();Tt=1+Math.round(Qn/6048e5)}return oi(Tt,Z,Ne(be,xe.MinusSign))}}function Ut(Z,de=!1){return function(q,be){return oi(yt(q).getFullYear(),Z,Ne(be,xe.MinusSign),de)}}const jt={};function Kt(Z,de){Z=Z.replace(/:/g,"");const q=Date.parse("Jan 01, 1970 00:00:00 "+Z)/6e4;return isNaN(q)?de:q}function me(Z){return Z instanceof Date&&!isNaN(Z.valueOf())}const We=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function wi(Z){const de=parseInt(Z);if(isNaN(de))throw new Error("Invalid integer literal when parsing "+Z);return de}function io(Z,de){de=encodeURIComponent(de);for(const q of Z.split(";")){const be=q.indexOf("="),[Tt,vn]=-1==be?[q,""]:[q.slice(0,be),q.slice(be+1)];if(Tt.trim()===de)return decodeURIComponent(vn)}return null}class Ji{constructor(de,q,be,Tt){this.$implicit=de,this.ngForOf=q,this.index=be,this.count=Tt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let gr=(()=>{class Z{set ngForOf(q){this._ngForOf=q,this._ngForOfDirty=!0}set ngForTrackBy(q){this._trackByFn=q}get ngForTrackBy(){return this._trackByFn}constructor(q,be,Tt){this._viewContainer=q,this._template=be,this._differs=Tt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(q){q&&(this._template=q)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const q=this._ngForOf;!this._differ&&q&&(this._differ=this._differs.find(q).create(this.ngForTrackBy))}if(this._differ){const q=this._differ.diff(this._ngForOf);q&&this._applyChanges(q)}}_applyChanges(q){const be=this._viewContainer;q.forEachOperation((Tt,vn,Dn)=>{if(null==Tt.previousIndex)be.createEmbeddedView(this._template,new Ji(Tt.item,this._ngForOf,-1,-1),null===Dn?void 0:Dn);else if(null==Dn)be.remove(null===vn?void 0:vn);else if(null!==vn){const Qn=be.get(vn);be.move(Qn,Dn),xo(Qn,Tt)}});for(let Tt=0,vn=be.length;Tt<vn;Tt++){const Qn=be.get(Tt).context;Qn.index=Tt,Qn.count=vn,Qn.ngForOf=this._ngForOf}q.forEachIdentityChange(Tt=>{xo(be.get(Tt.currentIndex),Tt)})}static ngTemplateContextGuard(q,be){return!0}}return Z.\u0275fac=function(q){return new(q||Z)(v.Y36(v.s_b),v.Y36(v.Rgc),v.Y36(v.ZZ4))},Z.\u0275dir=v.lG2({type:Z,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),Z})();function xo(Z,de){Z.context.$implicit=de.item}let Mr=(()=>{class Z{constructor(q,be){this._viewContainer=q,this._context=new kr,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=be}set ngIf(q){this._context.$implicit=this._context.ngIf=q,this._updateView()}set ngIfThen(q){ei("ngIfThen",q),this._thenTemplateRef=q,this._thenViewRef=null,this._updateView()}set ngIfElse(q){ei("ngIfElse",q),this._elseTemplateRef=q,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(q,be){return!0}}return Z.\u0275fac=function(q){return new(q||Z)(v.Y36(v.s_b),v.Y36(v.Rgc))},Z.\u0275dir=v.lG2({type:Z,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),Z})();class kr{constructor(){this.$implicit=null,this.ngIf=null}}function ei(Z,de){if(de&&!de.createEmbeddedView)throw new Error(`${Z} must be a TemplateRef, but received '${(0,v.AaK)(de)}'.`)}let Tn=(()=>{class Z{constructor(q){this._viewContainerRef=q,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(q){if(q.ngTemplateOutlet||q.ngTemplateOutletInjector){const be=this._viewContainerRef;if(this._viewRef&&be.remove(be.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:Tt,ngTemplateOutletContext:vn,ngTemplateOutletInjector:Dn}=this;this._viewRef=be.createEmbeddedView(Tt,vn,Dn?{injector:Dn}:void 0)}else this._viewRef=null}else this._viewRef&&q.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return Z.\u0275fac=function(q){return new(q||Z)(v.Y36(v.s_b))},Z.\u0275dir=v.lG2({type:Z,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[v.TTD]}),Z})();function On(Z,de){return new v.vHH(2100,!1)}const wo=new v.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),xs=new v.OlP("DATE_PIPE_DEFAULT_OPTIONS");let ea=(()=>{class Z{constructor(q,be,Tt){this.locale=q,this.defaultTimezone=be,this.defaultOptions=Tt}transform(q,be,Tt,vn){if(null==q||""===q||q!=q)return null;try{return hn(q,be??this.defaultOptions?.dateFormat??"mediumDate",vn||this.locale,Tt??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(Dn){throw On()}}}return Z.\u0275fac=function(q){return new(q||Z)(v.Y36(v.soG,16),v.Y36(wo,24),v.Y36(xs,24))},Z.\u0275pipe=v.Yjl({name:"date",type:Z,pure:!0,standalone:!0}),Z})(),jo=(()=>{class Z{constructor(q){this._locale=q}transform(q,be,Tt){if(!function Ur(Z){return!(null==Z||""===Z||Z!=Z)}(q))return null;Tt=Tt||this._locale;try{return function Nn(Z,de,q){return function tn(Z,de,q,be,Tt,vn,Dn=!1){let Qn="",Co=!1;if(isFinite(Z)){let _o=function ni(Z){let be,Tt,vn,Dn,Qn,de=Math.abs(Z)+"",q=0;for((Tt=de.indexOf("."))>-1&&(de=de.replace(".","")),(vn=de.search(/e/i))>0?(Tt<0&&(Tt=vn),Tt+=+de.slice(vn+1),de=de.substring(0,vn)):Tt<0&&(Tt=de.length),vn=0;"0"===de.charAt(vn);vn++);if(vn===(Qn=de.length))be=[0],Tt=1;else{for(Qn--;"0"===de.charAt(Qn);)Qn--;for(Tt-=vn,be=[],Dn=0;vn<=Qn;vn++,Dn++)be[Dn]=Number(de.charAt(vn))}return Tt>22&&(be=be.splice(0,21),q=Tt-1,Tt=1),{digits:be,exponent:q,integerLen:Tt}}(Z);Dn&&(_o=function ri(Z){if(0===Z.digits[0])return Z;const de=Z.digits.length-Z.integerLen;return Z.exponent?Z.exponent+=2:(0===de?Z.digits.push(0,0):1===de&&Z.digits.push(0),Z.integerLen+=2),Z}(_o));let Ki=de.minInt,lo=de.minFrac,fr=de.maxFrac;if(vn){const Vr=vn.match(We);if(null===Vr)throw new Error(`${vn} is not a valid digit info`);const qs=Vr[1],os=Vr[3],Ni=Vr[5];null!=qs&&(Ki=wi(qs)),null!=os&&(lo=wi(os)),null!=Ni?fr=wi(Ni):null!=os&&lo>fr&&(fr=lo)}!function qi(Z,de,q){if(de>q)throw new Error(`The minimum number of digits after fraction (${de}) is higher than the maximum (${q}).`);let be=Z.digits,Tt=be.length-Z.integerLen;const vn=Math.min(Math.max(de,Tt),q);let Dn=vn+Z.integerLen,Qn=be[Dn];if(Dn>0){be.splice(Math.max(Z.integerLen,Dn));for(let lo=Dn;lo<be.length;lo++)be[lo]=0}else{Tt=Math.max(0,Tt),Z.integerLen=1,be.length=Math.max(1,Dn=vn+1),be[0]=0;for(let lo=1;lo<Dn;lo++)be[lo]=0}if(Qn>=5)if(Dn-1<0){for(let lo=0;lo>Dn;lo--)be.unshift(0),Z.integerLen++;be.unshift(1),Z.integerLen++}else be[Dn-1]++;for(;Tt<Math.max(0,vn);Tt++)be.push(0);let Co=0!==vn;const _o=de+Z.integerLen,Ki=be.reduceRight(function(lo,fr,Ro,Eo){return Eo[Ro]=(fr+=lo)<10?fr:fr-10,Co&&(0===Eo[Ro]&&Ro>=_o?Eo.pop():Co=!1),fr>=10?1:0},0);Ki&&(be.unshift(Ki),Z.integerLen++)}(_o,lo,fr);let Ro=_o.digits,Eo=_o.integerLen;const Ls=_o.exponent;let Ds=[];for(Co=Ro.every(Vr=>!Vr);Eo<Ki;Eo++)Ro.unshift(0);for(;Eo<0;Eo++)Ro.unshift(0);Eo>0?Ds=Ro.splice(Eo,Ro.length):(Ds=Ro,Ro=[0]);const fs=[];for(Ro.length>=de.lgSize&&fs.unshift(Ro.splice(-de.lgSize,Ro.length).join(""));Ro.length>de.gSize;)fs.unshift(Ro.splice(-de.gSize,Ro.length).join(""));Ro.length&&fs.unshift(Ro.join("")),Qn=fs.join(Ne(q,be)),Ds.length&&(Qn+=Ne(q,Tt)+Ds.join("")),Ls&&(Qn+=Ne(q,xe.Exponential)+"+"+Ls)}else Qn=Ne(q,xe.Infinity);return Qn=Z<0&&!Co?de.negPre+Qn+de.negSuf:de.posPre+Qn+de.posSuf,Qn}(Z,function Pn(Z,de="-"){const q={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},be=Z.split(";"),Tt=be[0],vn=be[1],Dn=-1!==Tt.indexOf(".")?Tt.split("."):[Tt.substring(0,Tt.lastIndexOf("0")+1),Tt.substring(Tt.lastIndexOf("0")+1)],Qn=Dn[0],Co=Dn[1]||"";q.posPre=Qn.substring(0,Qn.indexOf("#"));for(let Ki=0;Ki<Co.length;Ki++){const lo=Co.charAt(Ki);"0"===lo?q.minFrac=q.maxFrac=Ki+1:"#"===lo?q.maxFrac=Ki+1:q.posSuf+=lo}const _o=Qn.split(",");if(q.gSize=_o[1]?_o[1].length:0,q.lgSize=_o[2]||_o[1]?(_o[2]||_o[1]).length:0,vn){const Ki=Tt.length-q.posPre.length-q.posSuf.length,lo=vn.indexOf("#");q.negPre=vn.substring(0,lo).replace(/'/g,""),q.negSuf=vn.slice(lo+Ki).replace(/'/g,"")}else q.negPre=de+q.posPre,q.negSuf=q.posSuf;return q}(function Ft(Z,de){return(0,v.cg1)(Z)[v.wAp.NumberFormats][de]}(de,nt.Decimal),Ne(de,xe.MinusSign)),de,xe.Group,xe.Decimal,q)}(function xr(Z){if("string"==typeof Z&&!isNaN(Number(Z)-parseFloat(Z)))return Number(Z);if("number"!=typeof Z)throw new Error(`${Z} is not a number`);return Z}(q),Tt,be)}catch(vn){throw On()}}}return Z.\u0275fac=function(q){return new(q||Z)(v.Y36(v.soG,16))},Z.\u0275pipe=v.Yjl({name:"number",type:Z,pure:!0,standalone:!0}),Z})();let ta=(()=>{class Z{}return Z.\u0275fac=function(q){return new(q||Z)},Z.\u0275mod=v.oAB({type:Z}),Z.\u0275inj=v.cJS({}),Z})();const Xr="browser",ko="server";function br(Z){return Z===ko}let Qr=(()=>{class Z{}return Z.\u0275prov=(0,v.Yz7)({token:Z,providedIn:"root",factory:()=>new ws((0,v.LFG)(ie),window)}),Z})();class ws{constructor(de,q){this.document=de,this.window=q,this.offset=()=>[0,0]}setOffset(de){this.offset=Array.isArray(de)?()=>de:de}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(de){this.supportsScrolling()&&this.window.scrollTo(de[0],de[1])}scrollToAnchor(de){if(!this.supportsScrolling())return;const q=function ds(Z,de){const q=Z.getElementById(de)||Z.getElementsByName(de)[0];if(q)return q;if("function"==typeof Z.createTreeWalker&&Z.body&&"function"==typeof Z.body.attachShadow){const be=Z.createTreeWalker(Z.body,NodeFilter.SHOW_ELEMENT);let Tt=be.currentNode;for(;Tt;){const vn=Tt.shadowRoot;if(vn){const Dn=vn.getElementById(de)||vn.querySelector(`[name="${de}"]`);if(Dn)return Dn}Tt=be.nextNode()}}return null}(this.document,de);q&&(this.scrollToElement(q),q.focus())}setHistoryScrollRestoration(de){if(this.supportScrollRestoration()){const q=this.window.history;q&&q.scrollRestoration&&(q.scrollRestoration=de)}}scrollToElement(de){const q=de.getBoundingClientRect(),be=q.left+this.window.pageXOffset,Tt=q.top+this.window.pageYOffset,vn=this.offset();this.window.scrollTo(be-vn[0],Tt-vn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const de=Qi(this.window.history)||Qi(Object.getPrototypeOf(this.window.history));return!(!de||!de.writable&&!de.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Qi(Z){return Object.getOwnPropertyDescriptor(Z,"scrollRestoration")}class Ss{}},9862:(zn,Ct,R)=>{"use strict";R.d(Ct,{JF:()=>We,TP:()=>Vt,WM:()=>se,eN:()=>Ue});var v=R(2029),d=R(2096),y=R(7715),s=R(5592),Q=R(6328),ie=R(2181),W=R(7398),w=R(4716),fe=R(4664),Ae=R(6814);class De{}class X{}class se{constructor(xt){this.normalizedNames=new Map,this.lazyUpdate=null,xt?"string"==typeof xt?this.lazyInit=()=>{this.headers=new Map,xt.split("\n").forEach(Et=>{const Nn=Et.indexOf(":");if(Nn>0){const Pn=Et.slice(0,Nn),ri=Pn.toLowerCase(),ni=Et.slice(Nn+1).trim();this.maybeSetNormalizedName(Pn,ri),this.headers.has(ri)?this.headers.get(ri).push(ni):this.headers.set(ri,[ni])}})}:typeof Headers<"u"&&xt instanceof Headers?(this.headers=new Map,xt.forEach((Et,Nn)=>{this.setHeaderEntries(Nn,Et)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(xt).forEach(([Et,Nn])=>{this.setHeaderEntries(Et,Nn)})}:this.headers=new Map}has(xt){return this.init(),this.headers.has(xt.toLowerCase())}get(xt){this.init();const Et=this.headers.get(xt.toLowerCase());return Et&&Et.length>0?Et[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(xt){return this.init(),this.headers.get(xt.toLowerCase())||null}append(xt,Et){return this.clone({name:xt,value:Et,op:"a"})}set(xt,Et){return this.clone({name:xt,value:Et,op:"s"})}delete(xt,Et){return this.clone({name:xt,value:Et,op:"d"})}maybeSetNormalizedName(xt,Et){this.normalizedNames.has(Et)||this.normalizedNames.set(Et,xt)}init(){this.lazyInit&&(this.lazyInit instanceof se?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(xt=>this.applyUpdate(xt)),this.lazyUpdate=null))}copyFrom(xt){xt.init(),Array.from(xt.headers.keys()).forEach(Et=>{this.headers.set(Et,xt.headers.get(Et)),this.normalizedNames.set(Et,xt.normalizedNames.get(Et))})}clone(xt){const Et=new se;return Et.lazyInit=this.lazyInit&&this.lazyInit instanceof se?this.lazyInit:this,Et.lazyUpdate=(this.lazyUpdate||[]).concat([xt]),Et}applyUpdate(xt){const Et=xt.name.toLowerCase();switch(xt.op){case"a":case"s":let Nn=xt.value;if("string"==typeof Nn&&(Nn=[Nn]),0===Nn.length)return;this.maybeSetNormalizedName(xt.name,Et);const Pn=("a"===xt.op?this.headers.get(Et):void 0)||[];Pn.push(...Nn),this.headers.set(Et,Pn);break;case"d":const ri=xt.value;if(ri){let ni=this.headers.get(Et);if(!ni)return;ni=ni.filter(qi=>-1===ri.indexOf(qi)),0===ni.length?(this.headers.delete(Et),this.normalizedNames.delete(Et)):this.headers.set(Et,ni)}else this.headers.delete(Et),this.normalizedNames.delete(Et)}}setHeaderEntries(xt,Et){const Nn=(Array.isArray(Et)?Et:[Et]).map(ri=>ri.toString()),Pn=xt.toLowerCase();this.headers.set(Pn,Nn),this.maybeSetNormalizedName(xt,Pn)}forEach(xt){this.init(),Array.from(this.normalizedNames.keys()).forEach(Et=>xt(this.normalizedNames.get(Et),this.headers.get(Et)))}}class ge{encodeKey(xt){return ze(xt)}encodeValue(xt){return ze(xt)}decodeKey(xt){return decodeURIComponent(xt)}decodeValue(xt){return decodeURIComponent(xt)}}const Le=/%(\d[a-f0-9])/gi,Me={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function ze(tn){return encodeURIComponent(tn).replace(Le,(xt,Et)=>Me[Et]??xt)}function Ke(tn){return`${tn}`}class Oe{constructor(xt={}){if(this.updates=null,this.cloneFrom=null,this.encoder=xt.encoder||new ge,xt.fromString){if(xt.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function we(tn,xt){const Et=new Map;return tn.length>0&&tn.replace(/^\?/,"").split("&").forEach(Pn=>{const ri=Pn.indexOf("="),[ni,qi]=-1==ri?[xt.decodeKey(Pn),""]:[xt.decodeKey(Pn.slice(0,ri)),xt.decodeValue(Pn.slice(ri+1))],wi=Et.get(ni)||[];wi.push(qi),Et.set(ni,wi)}),Et}(xt.fromString,this.encoder)}else xt.fromObject?(this.map=new Map,Object.keys(xt.fromObject).forEach(Et=>{const Nn=xt.fromObject[Et],Pn=Array.isArray(Nn)?Nn.map(Ke):[Ke(Nn)];this.map.set(Et,Pn)})):this.map=null}has(xt){return this.init(),this.map.has(xt)}get(xt){this.init();const Et=this.map.get(xt);return Et?Et[0]:null}getAll(xt){return this.init(),this.map.get(xt)||null}keys(){return this.init(),Array.from(this.map.keys())}append(xt,Et){return this.clone({param:xt,value:Et,op:"a"})}appendAll(xt){const Et=[];return Object.keys(xt).forEach(Nn=>{const Pn=xt[Nn];Array.isArray(Pn)?Pn.forEach(ri=>{Et.push({param:Nn,value:ri,op:"a"})}):Et.push({param:Nn,value:Pn,op:"a"})}),this.clone(Et)}set(xt,Et){return this.clone({param:xt,value:Et,op:"s"})}delete(xt,Et){return this.clone({param:xt,value:Et,op:"d"})}toString(){return this.init(),this.keys().map(xt=>{const Et=this.encoder.encodeKey(xt);return this.map.get(xt).map(Nn=>Et+"="+this.encoder.encodeValue(Nn)).join("&")}).filter(xt=>""!==xt).join("&")}clone(xt){const Et=new Oe({encoder:this.encoder});return Et.cloneFrom=this.cloneFrom||this,Et.updates=(this.updates||[]).concat(xt),Et}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(xt=>this.map.set(xt,this.cloneFrom.map.get(xt))),this.updates.forEach(xt=>{switch(xt.op){case"a":case"s":const Et=("a"===xt.op?this.map.get(xt.param):void 0)||[];Et.push(Ke(xt.value)),this.map.set(xt.param,Et);break;case"d":if(void 0===xt.value){this.map.delete(xt.param);break}{let Nn=this.map.get(xt.param)||[];const Pn=Nn.indexOf(Ke(xt.value));-1!==Pn&&Nn.splice(Pn,1),Nn.length>0?this.map.set(xt.param,Nn):this.map.delete(xt.param)}}}),this.cloneFrom=this.updates=null)}}class nt{constructor(){this.map=new Map}set(xt,Et){return this.map.set(xt,Et),this}get(xt){return this.map.has(xt)||this.map.set(xt,xt.defaultValue()),this.map.get(xt)}delete(xt){return this.map.delete(xt),this}has(xt){return this.map.has(xt)}keys(){return this.map.keys()}}function Ee(tn){return typeof ArrayBuffer<"u"&&tn instanceof ArrayBuffer}function ae(tn){return typeof Blob<"u"&&tn instanceof Blob}function mt(tn){return typeof FormData<"u"&&tn instanceof FormData}class Ze{constructor(xt,Et,Nn,Pn){let ri;if(this.url=Et,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=xt.toUpperCase(),function Xe(tn){switch(tn){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Pn?(this.body=void 0!==Nn?Nn:null,ri=Pn):ri=Nn,ri&&(this.reportProgress=!!ri.reportProgress,this.withCredentials=!!ri.withCredentials,ri.responseType&&(this.responseType=ri.responseType),ri.headers&&(this.headers=ri.headers),ri.context&&(this.context=ri.context),ri.params&&(this.params=ri.params)),this.headers||(this.headers=new se),this.context||(this.context=new nt),this.params){const ni=this.params.toString();if(0===ni.length)this.urlWithParams=Et;else{const qi=Et.indexOf("?");this.urlWithParams=Et+(-1===qi?"?":qi<Et.length-1?"&":"")+ni}}else this.params=new Oe,this.urlWithParams=Et}serializeBody(){return null===this.body?null:Ee(this.body)||ae(this.body)||mt(this.body)||function xe(tn){return typeof URLSearchParams<"u"&&tn instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof Oe?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||mt(this.body)?null:ae(this.body)?this.body.type||null:Ee(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof Oe?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(xt={}){const Et=xt.method||this.method,Nn=xt.url||this.url,Pn=xt.responseType||this.responseType,ri=void 0!==xt.body?xt.body:this.body,ni=void 0!==xt.withCredentials?xt.withCredentials:this.withCredentials,qi=void 0!==xt.reportProgress?xt.reportProgress:this.reportProgress;let wi=xt.headers||this.headers,mo=xt.params||this.params;const Ao=xt.context??this.context;return void 0!==xt.setHeaders&&(wi=Object.keys(xt.setHeaders).reduce((Go,co)=>Go.set(co,xt.setHeaders[co]),wi)),xt.setParams&&(mo=Object.keys(xt.setParams).reduce((Go,co)=>Go.set(co,xt.setParams[co]),mo)),new Ze(Et,Nn,ri,{params:mo,headers:wi,context:Ao,reportProgress:qi,responseType:Pn,withCredentials:ni})}}var Se=(()=>((Se=Se||{})[Se.Sent=0]="Sent",Se[Se.UploadProgress=1]="UploadProgress",Se[Se.ResponseHeader=2]="ResponseHeader",Se[Se.DownloadProgress=3]="DownloadProgress",Se[Se.Response=4]="Response",Se[Se.User=5]="User",Se))();class ye{constructor(xt,Et=200,Nn="OK"){this.headers=xt.headers||new se,this.status=void 0!==xt.status?xt.status:Et,this.statusText=xt.statusText||Nn,this.url=xt.url||null,this.ok=this.status>=200&&this.status<300}}class Qt extends ye{constructor(xt={}){super(xt),this.type=Se.ResponseHeader}clone(xt={}){return new Qt({headers:xt.headers||this.headers,status:void 0!==xt.status?xt.status:this.status,statusText:xt.statusText||this.statusText,url:xt.url||this.url||void 0})}}class dt extends ye{constructor(xt={}){super(xt),this.type=Se.Response,this.body=void 0!==xt.body?xt.body:null}clone(xt={}){return new dt({body:void 0!==xt.body?xt.body:this.body,headers:xt.headers||this.headers,status:void 0!==xt.status?xt.status:this.status,statusText:xt.statusText||this.statusText,url:xt.url||this.url||void 0})}}class gt extends ye{constructor(xt){super(xt,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${xt.url||"(unknown url)"}`:`Http failure response for ${xt.url||"(unknown url)"}: ${xt.status} ${xt.statusText}`,this.error=xt.error||null}}function ct(tn,xt){return{body:xt,headers:tn.headers,context:tn.context,observe:tn.observe,params:tn.params,reportProgress:tn.reportProgress,responseType:tn.responseType,withCredentials:tn.withCredentials}}let Ue=(()=>{class tn{constructor(Et){this.handler=Et}request(Et,Nn,Pn={}){let ri;if(Et instanceof Ze)ri=Et;else{let wi,mo;wi=Pn.headers instanceof se?Pn.headers:new se(Pn.headers),Pn.params&&(mo=Pn.params instanceof Oe?Pn.params:new Oe({fromObject:Pn.params})),ri=new Ze(Et,Nn,void 0!==Pn.body?Pn.body:null,{headers:wi,context:Pn.context,params:mo,reportProgress:Pn.reportProgress,responseType:Pn.responseType||"json",withCredentials:Pn.withCredentials})}const ni=(0,d.of)(ri).pipe((0,Q.b)(wi=>this.handler.handle(wi)));if(Et instanceof Ze||"events"===Pn.observe)return ni;const qi=ni.pipe((0,ie.h)(wi=>wi instanceof dt));switch(Pn.observe||"body"){case"body":switch(ri.responseType){case"arraybuffer":return qi.pipe((0,W.U)(wi=>{if(null!==wi.body&&!(wi.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return wi.body}));case"blob":return qi.pipe((0,W.U)(wi=>{if(null!==wi.body&&!(wi.body instanceof Blob))throw new Error("Response is not a Blob.");return wi.body}));case"text":return qi.pipe((0,W.U)(wi=>{if(null!==wi.body&&"string"!=typeof wi.body)throw new Error("Response is not a string.");return wi.body}));default:return qi.pipe((0,W.U)(wi=>wi.body))}case"response":return qi;default:throw new Error(`Unreachable: unhandled observe type ${Pn.observe}}`)}}delete(Et,Nn={}){return this.request("DELETE",Et,Nn)}get(Et,Nn={}){return this.request("GET",Et,Nn)}head(Et,Nn={}){return this.request("HEAD",Et,Nn)}jsonp(Et,Nn){return this.request("JSONP",Et,{params:(new Oe).append(Nn,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Et,Nn={}){return this.request("OPTIONS",Et,Nn)}patch(Et,Nn,Pn={}){return this.request("PATCH",Et,ct(Pn,Nn))}post(Et,Nn,Pn={}){return this.request("POST",Et,ct(Pn,Nn))}put(Et,Nn,Pn={}){return this.request("PUT",Et,ct(Pn,Nn))}}return tn.\u0275fac=function(Et){return new(Et||tn)(v.LFG(De))},tn.\u0275prov=v.Yz7({token:tn,factory:tn.\u0275fac}),tn})();function Xt(tn,xt){return xt(tn)}function mn(tn,xt){return(Et,Nn)=>xt.intercept(Et,{handle:Pn=>tn(Pn,Nn)})}const Vt=new v.OlP(""),It=new v.OlP(""),at=new v.OlP("");function Wt(){let tn=null;return(xt,Et)=>{null===tn&&(tn=((0,v.f3M)(Vt,{optional:!0})??[]).reduceRight(mn,Xt));const Nn=(0,v.f3M)(v.HDt),Pn=Nn.add();return tn(xt,Et).pipe((0,w.x)(()=>Nn.remove(Pn)))}}let dn=(()=>{class tn extends De{constructor(Et,Nn){super(),this.backend=Et,this.injector=Nn,this.chain=null,this.pendingTasks=(0,v.f3M)(v.HDt)}handle(Et){if(null===this.chain){const Pn=Array.from(new Set([...this.injector.get(It),...this.injector.get(at,[])]));this.chain=Pn.reduceRight((ri,ni)=>function sn(tn,xt,Et){return(Nn,Pn)=>Et.runInContext(()=>xt(Nn,ri=>tn(ri,Pn)))}(ri,ni,this.injector),Xt)}const Nn=this.pendingTasks.add();return this.chain(Et,Pn=>this.backend.handle(Pn)).pipe((0,w.x)(()=>this.pendingTasks.remove(Nn)))}}return tn.\u0275fac=function(Et){return new(Et||tn)(v.LFG(X),v.LFG(v.lqb))},tn.\u0275prov=v.Yz7({token:tn,factory:tn.\u0275fac}),tn})();const gi=/^\)\]\}',?\n/;let Un=(()=>{class tn{constructor(Et){this.xhrFactory=Et}handle(Et){if("JSONP"===Et.method)throw new v.vHH(-2800,!1);const Nn=this.xhrFactory;return(Nn.\u0275loadImpl?(0,y.D)(Nn.\u0275loadImpl()):(0,d.of)(null)).pipe((0,fe.w)(()=>new s.y(ri=>{const ni=Nn.build();if(ni.open(Et.method,Et.urlWithParams),Et.withCredentials&&(ni.withCredentials=!0),Et.headers.forEach((uo,en)=>ni.setRequestHeader(uo,en.join(","))),Et.headers.has("Accept")||ni.setRequestHeader("Accept","application/json, text/plain, */*"),!Et.headers.has("Content-Type")){const uo=Et.detectContentTypeHeader();null!==uo&&ni.setRequestHeader("Content-Type",uo)}if(Et.responseType){const uo=Et.responseType.toLowerCase();ni.responseType="json"!==uo?uo:"text"}const qi=Et.serializeBody();let wi=null;const mo=()=>{if(null!==wi)return wi;const uo=ni.statusText||"OK",en=new se(ni.getAllResponseHeaders()),Qo=function Yt(tn){return"responseURL"in tn&&tn.responseURL?tn.responseURL:/^X-Request-URL:/m.test(tn.getAllResponseHeaders())?tn.getResponseHeader("X-Request-URL"):null}(ni)||Et.url;return wi=new Qt({headers:en,status:ni.status,statusText:uo,url:Qo}),wi},Ao=()=>{let{headers:uo,status:en,statusText:Qo,url:vo}=mo(),Ji=null;204!==en&&(Ji=typeof ni.response>"u"?ni.responseText:ni.response),0===en&&(en=Ji?200:0);let gr=en>=200&&en<300;if("json"===Et.responseType&&"string"==typeof Ji){const xo=Ji;Ji=Ji.replace(gi,"");try{Ji=""!==Ji?JSON.parse(Ji):null}catch(Zr){Ji=xo,gr&&(gr=!1,Ji={error:Zr,text:Ji})}}gr?(ri.next(new dt({body:Ji,headers:uo,status:en,statusText:Qo,url:vo||void 0})),ri.complete()):ri.error(new gt({error:Ji,headers:uo,status:en,statusText:Qo,url:vo||void 0}))},Go=uo=>{const{url:en}=mo(),Qo=new gt({error:uo,status:ni.status||0,statusText:ni.statusText||"Unknown Error",url:en||void 0});ri.error(Qo)};let co=!1;const io=uo=>{co||(ri.next(mo()),co=!0);let en={type:Se.DownloadProgress,loaded:uo.loaded};uo.lengthComputable&&(en.total=uo.total),"text"===Et.responseType&&ni.responseText&&(en.partialText=ni.responseText),ri.next(en)},Pi=uo=>{let en={type:Se.UploadProgress,loaded:uo.loaded};uo.lengthComputable&&(en.total=uo.total),ri.next(en)};return ni.addEventListener("load",Ao),ni.addEventListener("error",Go),ni.addEventListener("timeout",Go),ni.addEventListener("abort",Go),Et.reportProgress&&(ni.addEventListener("progress",io),null!==qi&&ni.upload&&ni.upload.addEventListener("progress",Pi)),ni.send(qi),ri.next({type:Se.Sent}),()=>{ni.removeEventListener("error",Go),ni.removeEventListener("abort",Go),ni.removeEventListener("load",Ao),ni.removeEventListener("timeout",Go),Et.reportProgress&&(ni.removeEventListener("progress",io),null!==qi&&ni.upload&&ni.upload.removeEventListener("progress",Pi)),ni.readyState!==ni.DONE&&ni.abort()}})))}}return tn.\u0275fac=function(Et){return new(Et||tn)(v.LFG(Ae.JF))},tn.\u0275prov=v.Yz7({token:tn,factory:tn.\u0275fac}),tn})();const oi=new v.OlP("XSRF_ENABLED"),Oi=new v.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),fi=new v.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Vo{}let ut=(()=>{class tn{constructor(Et,Nn,Pn){this.doc=Et,this.platform=Nn,this.cookieName=Pn,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Et=this.doc.cookie||"";return Et!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,Ae.Mx)(Et,this.cookieName),this.lastCookieString=Et),this.lastToken}}return tn.\u0275fac=function(Et){return new(Et||tn)(v.LFG(Ae.K0),v.LFG(v.Lbi),v.LFG(Oi))},tn.\u0275prov=v.Yz7({token:tn,factory:tn.\u0275fac}),tn})();function pe(tn,xt){const Et=tn.url.toLowerCase();if(!(0,v.f3M)(oi)||"GET"===tn.method||"HEAD"===tn.method||Et.startsWith("http://")||Et.startsWith("https://"))return xt(tn);const Nn=(0,v.f3M)(Vo).getToken(),Pn=(0,v.f3M)(fi);return null!=Nn&&!tn.headers.has(Pn)&&(tn=tn.clone({headers:tn.headers.set(Pn,Nn)})),xt(tn)}var et=(()=>((et=et||{})[et.Interceptors=0]="Interceptors",et[et.LegacyInterceptors=1]="LegacyInterceptors",et[et.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",et[et.NoXsrfProtection=3]="NoXsrfProtection",et[et.JsonpSupport=4]="JsonpSupport",et[et.RequestsMadeViaParent=5]="RequestsMadeViaParent",et[et.Fetch=6]="Fetch",et))();function yt(tn,xt){return{\u0275kind:tn,\u0275providers:xt}}function Rt(...tn){const xt=[Ue,Un,dn,{provide:De,useExisting:dn},{provide:X,useExisting:Un},{provide:It,useValue:pe,multi:!0},{provide:oi,useValue:!0},{provide:Vo,useClass:ut}];for(const Et of tn)xt.push(...Et.\u0275providers);return(0,v.MR2)(xt)}const jt=new v.OlP("LEGACY_INTERCEPTOR_FN");let We=(()=>{class tn{}return tn.\u0275fac=function(Et){return new(Et||tn)},tn.\u0275mod=v.oAB({type:tn}),tn.\u0275inj=v.cJS({providers:[Rt(yt(et.LegacyInterceptors,[{provide:jt,useFactory:Wt},{provide:It,useExisting:jt,multi:!0}]))]}),tn})()},2029:(zn,Ct,R)=>{"use strict";R.d(Ct,{tb:()=>iv,AFp:()=>Nu,ip1:()=>Gx,hGG:()=>wC,z2F:()=>Np,Ojb:()=>N_,sBO:()=>sC,Sil:()=>zT,EJc:()=>BT,Xts:()=>ku,SBq:()=>Kd,lqb:()=>Tc,qLn:()=>Cc,vpe:()=>Lc,XFs:()=>Yt,OlP:()=>lr,zs3:()=>Ec,ZZ4:()=>cv,aQg:()=>uv,soG:()=>t_,YKP:()=>q0,h0i:()=>kp,PXZ:()=>KT,R0b:()=>Fa,FiY:()=>nl,Lbi:()=>Gh,g9A:()=>Uu,Qsj:()=>Gu,FYo:()=>Xd,JOm:()=>sl,tp0:()=>yh,Rgc:()=>_m,dDg:()=>WT,eoX:()=>o1,GfV:()=>op,s_b:()=>Qg,ifc:()=>tn,VuI:()=>PC,LMc:()=>RC,MMx:()=>J0,Lck:()=>Tw,eFA:()=>l1,G48:()=>rC,Gpc:()=>Ke,f3M:()=>We,$WT:()=>or,MR2:()=>Cf,_c5:()=>bC,qFp:()=>LC,rg0:()=>Ba,c2e:()=>Wx,zSh:()=>Vh,HDt:()=>qx,wAp:()=>ro,vHH:()=>ae,lri:()=>n1,rWj:()=>i1,cg1:()=>Iy,kL8:()=>v0,dqk:()=>fi,Z0I:()=>gn,eJc:()=>Wy,QGY:()=>pu,F4k:()=>Sp,RDi:()=>D_,AaK:()=>Le,qOj:()=>wp,Xq5:()=>Ep,TTD:()=>lc,_Bn:()=>W0,jDz:()=>K0,xp6:()=>Yu,uIk:()=>b,ekj:()=>wy,Suo:()=>Ex,Xpm:()=>zt,lG2:()=>zi,Yz7:()=>Sn,cJS:()=>yi,oAB:()=>On,Yjl:()=>Lo,Y36:()=>Xu,_UZ:()=>fh,GkF:()=>Rl,BQk:()=>dd,ynx:()=>ud,qZA:()=>ph,TgZ:()=>hh,EpF:()=>ca,n5z:()=>ki,LFG:()=>Y,$8M:()=>Fo,$Z:()=>lu,NdJ:()=>Pp,CRH:()=>Dx,oxw:()=>Sv,ALo:()=>ux,lcZ:()=>dx,xi3:()=>hx,Hsn:()=>Ov,F$t:()=>Pv,Q6J:()=>du,s9C:()=>gy,DdM:()=>ox,iGM:()=>Tx,MAs:()=>cd,KtG:()=>hc,CHM:()=>_l,LSH:()=>jd,P3R:()=>Gm,Udp:()=>by,YNc:()=>as,_uU:()=>e0,Oqu:()=>Cy,hij:()=>Wg,AsE:()=>Ey,lnq:()=>Dy,HOy:()=>My,Gf:()=>Cx});var v=R(8645),d=R(7394),y=R(5619),s=R(5592),Q=R(7537),ie=R(4829),W=R(6232),w=R(4564),fe=R(7715),De=R(2096),X=R(3020),se=R(4664),Te=R(3997);function ge(n){for(let r in n)if(n[r]===ge)return r;throw Error("Could not find renamed property on target object.")}function we(n,r){for(const l in r)r.hasOwnProperty(l)&&!n.hasOwnProperty(l)&&(n[l]=r[l])}function Le(n){if("string"==typeof n)return n;if(Array.isArray(n))return"["+n.map(Le).join(", ")+"]";if(null==n)return""+n;if(n.overriddenName)return`${n.overriddenName}`;if(n.name)return`${n.name}`;const r=n.toString();if(null==r)return""+r;const l=r.indexOf("\n");return-1===l?r:r.substring(0,l)}function Me(n,r){return null==n||""===n?null===r?"":r:null==r||""===r?n:n+" "+r}const ze=ge({__forward_ref__:ge});function Ke(n){return n.__forward_ref__=Ke,n.toString=function(){return Le(this())},n}function Oe(n){return Ce(n)?n():n}function Ce(n){return"function"==typeof n&&n.hasOwnProperty(ze)&&n.__forward_ref__===Ke}function nt(n){return n&&!!n.\u0275providers}const Ee="https://g.co/ng/security#xss";class ae extends Error{constructor(r,l){super(function mt(n,r){return`NG0${Math.abs(n)}${r?": "+r:""}`}(r,l)),this.code=r}}function xe(n){return"string"==typeof n?n:null==n?"":String(n)}function dt(n,r){throw new ae(-201,!1)}function Vt(n,r){null==n&&function It(n,r,l,h){throw new Error(`ASSERTION ERROR: ${n}`+(null==h?"":` [Expected=> ${l} ${h} ${r} <=Actual]`))}(r,n,null,"!=")}function Sn(n){return{token:n.token,providedIn:n.providedIn||null,factory:n.factory,value:void 0}}function yi(n){return{providers:n.providers||[],imports:n.imports||[]}}function Gi(n){return si(n,Zt)||si(n,hn)}function gn(n){return null!==Gi(n)}function si(n,r){return n.hasOwnProperty(r)?n[r]:null}function At(n){return n&&(n.hasOwnProperty(un)||n.hasOwnProperty(gi))?n[un]:null}const Zt=ge({\u0275prov:ge}),un=ge({\u0275inj:ge}),hn=ge({ngInjectableDef:ge}),gi=ge({ngInjectorDef:ge});var Yt=(()=>((Yt=Yt||{})[Yt.Default=0]="Default",Yt[Yt.Host=1]="Host",Yt[Yt.Self=2]="Self",Yt[Yt.SkipSelf=4]="SkipSelf",Yt[Yt.Optional=8]="Optional",Yt))();let Un;function Ci(n){const r=Un;return Un=n,r}function Oi(n,r,l){const h=Gi(n);return h&&"root"==h.providedIn?void 0===h.value?h.value=h.factory():h.value:l&Yt.Optional?null:void 0!==r?r:void dt(Le(n))}const fi=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),ve={},et="__NG_DI_FLAG__",yt="ngTempTokenPath",Ut=/\n/gm,St="__source";let Kt;function tt(n){const r=Kt;return Kt=n,r}function Ve(n,r=Yt.Default){if(void 0===Kt)throw new ae(-203,!1);return null===Kt?Oi(n,void 0,r):Kt.get(n,r&Yt.Optional?null:void 0,r)}function Y(n,r=Yt.Default){return(function oi(){return Un}()||Ve)(Oe(n),r)}function We(n,r=Yt.Default){return Y(n,kt(r))}function kt(n){return typeof n>"u"||"number"==typeof n?n:0|(n.optional&&8)|(n.host&&1)|(n.self&&2)|(n.skipSelf&&4)}function _n(n){const r=[];for(let l=0;l<n.length;l++){const h=Oe(n[l]);if(Array.isArray(h)){if(0===h.length)throw new ae(900,!1);let g,T=Yt.Default;for(let M=0;M<h.length;M++){const F=h[M],V=Ei(F);"number"==typeof V?-1===V?g=F.token:T|=V:g=F}r.push(Y(g,T))}else r.push(Y(h))}return r}function ti(n,r){return n[et]=r,n.prototype[et]=r,n}function Ei(n){return n[et]}function po(n){return{toString:n}.toString()}var eo=(()=>((eo=eo||{})[eo.OnPush=0]="OnPush",eo[eo.Default=1]="Default",eo))(),tn=(()=>{return(n=tn||(tn={}))[n.Emulated=0]="Emulated",n[n.None=2]="None",n[n.ShadowDom=3]="ShadowDom",tn;var n})();const xt={},Et=[],Nn=ge({\u0275cmp:ge}),Pn=ge({\u0275dir:ge}),ri=ge({\u0275pipe:ge}),ni=ge({\u0275mod:ge}),qi=ge({\u0275fac:ge}),wi=ge({__NG_ELEMENT_ID__:ge}),mo=ge({__NG_ENV_ID__:ge});function Ao(n,r,l){let h=n.length;for(;;){const g=n.indexOf(r,l);if(-1===g)return g;if(0===g||n.charCodeAt(g-1)<=32){const T=r.length;if(g+T===h||n.charCodeAt(g+T)<=32)return g}l=g+1}}function Go(n,r,l){let h=0;for(;h<l.length;){const g=l[h];if("number"==typeof g){if(0!==g)break;h++;const T=l[h++],M=l[h++],F=l[h++];n.setAttribute(r,M,F,T)}else{const T=g,M=l[++h];io(T)?n.setProperty(r,T,M):n.setAttribute(r,T,M),h++}}return h}function co(n){return 3===n||4===n||6===n}function io(n){return 64===n.charCodeAt(0)}function Pi(n,r){if(null!==r&&0!==r.length)if(null===n||0===n.length)n=r.slice();else{let l=-1;for(let h=0;h<r.length;h++){const g=r[h];"number"==typeof g?l=g:0===l||uo(n,l,g,null,-1===l||2===l?r[++h]:null)}}return n}function uo(n,r,l,h,g){let T=0,M=n.length;if(-1===r)M=-1;else for(;T<n.length;){const F=n[T++];if("number"==typeof F){if(F===r){M=-1;break}if(F>r){M=T-1;break}}}for(;T<n.length;){const F=n[T];if("number"==typeof F)break;if(F===l){if(null===h)return void(null!==g&&(n[T+1]=g));if(h===n[T+1])return void(n[T+2]=g)}T++,null!==h&&T++,null!==g&&T++}-1!==M&&(n.splice(M,0,r),T=M+1),n.splice(T++,0,l),null!==h&&n.splice(T++,0,h),null!==g&&n.splice(T++,0,g)}const en="ng-template";function Qo(n,r,l){let h=0,g=!0;for(;h<n.length;){let T=n[h++];if("string"==typeof T&&g){const M=n[h++];if(l&&"class"===T&&-1!==Ao(M.toLowerCase(),r,0))return!0}else{if(1===T){for(;h<n.length&&"string"==typeof(T=n[h++]);)if(T.toLowerCase()===r)return!0;return!1}"number"==typeof T&&(g=!1)}}return!1}function vo(n){return 4===n.type&&n.value!==en}function Ji(n,r,l){return r===(4!==n.type||l?n.value:en)}function gr(n,r,l){let h=4;const g=n.attrs||[],T=function ei(n){for(let r=0;r<n.length;r++)if(co(n[r]))return r;return n.length}(g);let M=!1;for(let F=0;F<r.length;F++){const V=r[F];if("number"!=typeof V){if(!M)if(4&h){if(h=2|1&h,""!==V&&!Ji(n,V,l)||""===V&&1===r.length){if(xo(h))return!1;M=!0}}else{const oe=8&h?V:r[++F];if(8&h&&null!==n.attrs){if(!Qo(n.attrs,oe,l)){if(xo(h))return!1;M=!0}continue}const ft=Zr(8&h?"class":V,g,vo(n),l);if(-1===ft){if(xo(h))return!1;M=!0;continue}if(""!==oe){let Ht;Ht=ft>T?"":g[ft+1].toLowerCase();const rn=8&h?Ht:null;if(rn&&-1!==Ao(rn,oe,0)||2&h&&oe!==Ht){if(xo(h))return!1;M=!0}}}}else{if(!M&&!xo(h)&&!xo(V))return!1;if(M&&xo(V))continue;M=!1,h=V|1&h}}return xo(h)||M}function xo(n){return 0==(1&n)}function Zr(n,r,l,h){if(null===r)return-1;let g=0;if(h||!l){let T=!1;for(;g<r.length;){const M=r[g];if(M===n)return g;if(3===M||6===M)T=!0;else{if(1===M||2===M){let F=r[++g];for(;"string"==typeof F;)F=r[++g];continue}if(4===M)break;if(0===M){g+=4;continue}}g+=T?1:2}return-1}return function Vi(n,r){let l=n.indexOf(4);if(l>-1)for(l++;l<n.length;){const h=n[l];if("number"==typeof h)return-1;if(h===r)return l;l++}return-1}(r,n)}function Mr(n,r,l=!1){for(let h=0;h<r.length;h++)if(gr(n,r[h],l))return!0;return!1}function _e(n,r){e:for(let l=0;l<r.length;l++){const h=r[l];if(n.length===h.length){for(let g=0;g<n.length;g++)if(n[g]!==h[g])continue e;return!0}}return!1}function st(n,r){return n?":not("+r.trim()+")":r}function ke(n){let r=n[0],l=1,h=2,g="",T=!1;for(;l<n.length;){let M=n[l];if("string"==typeof M)if(2&h){const F=n[++l];g+="["+M+(F.length>0?'="'+F+'"':"")+"]"}else 8&h?g+="."+M:4&h&&(g+=" "+M);else""!==g&&!xo(M)&&(r+=st(T,g),g=""),h=M,T=T||!xo(h);l++}return""!==g&&(r+=st(T,g)),r}function zt(n){return po(()=>{const r=dr(n),l={...r,decls:n.decls,vars:n.vars,template:n.template,consts:n.consts||null,ngContentSelectors:n.ngContentSelectors,onPush:n.changeDetection===eo.OnPush,directiveDefs:null,pipeDefs:null,dependencies:r.standalone&&n.dependencies||null,getStandaloneInjector:null,signals:n.signals??!1,data:n.data||{},encapsulation:n.encapsulation||tn.Emulated,styles:n.styles||Et,_:null,schemas:n.schemas||null,tView:null,id:""};wo(l);const h=n.dependencies;return l.directiveDefs=xs(h,!1),l.pipeDefs=xs(h,!0),l.id=function hr(n){let r=0;const l=[n.selectors,n.ngContentSelectors,n.hostVars,n.hostAttrs,n.consts,n.vars,n.decls,n.encapsulation,n.standalone,n.signals,n.exportAs,JSON.stringify(n.inputs),JSON.stringify(n.outputs),Object.getOwnPropertyNames(n.type.prototype),!!n.contentQueries,!!n.viewQuery].join("|");for(const g of l)r=Math.imul(31,r)+g.charCodeAt(0)<<0;return r+=2147483648,"c"+r}(l),l})}function Tn(n){return Xi(n)||so(n)}function xn(n){return null!==n}function On(n){return po(()=>({type:n.type,bootstrap:n.bootstrap||Et,declarations:n.declarations||Et,imports:n.imports||Et,exports:n.exports||Et,transitiveCompileScopes:null,schemas:n.schemas||null,id:n.id||null}))}function Ii(n,r){if(null==n)return xt;const l={};for(const h in n)if(n.hasOwnProperty(h)){let g=n[h],T=g;Array.isArray(g)&&(T=g[1],g=g[0]),l[g]=h,r&&(r[g]=T)}return l}function zi(n){return po(()=>{const r=dr(n);return wo(r),r})}function Lo(n){return{type:n.type,name:n.name,factory:null,pure:!1!==n.pure,standalone:!0===n.standalone,onDestroy:n.type.prototype.ngOnDestroy||null}}function Xi(n){return n[Nn]||null}function so(n){return n[Pn]||null}function To(n){return n[ri]||null}function or(n){const r=Xi(n)||so(n)||To(n);return null!==r&&r.standalone}function Wo(n,r){const l=n[ni]||null;if(!l&&!0===r)throw new Error(`Type ${Le(n)} does not have '\u0275mod' property.`);return l}function dr(n){const r={};return{type:n.type,providersResolver:null,factory:null,hostBindings:n.hostBindings||null,hostVars:n.hostVars||0,hostAttrs:n.hostAttrs||null,contentQueries:n.contentQueries||null,declaredInputs:r,inputTransforms:null,inputConfig:n.inputs||xt,exportAs:n.exportAs||null,standalone:!0===n.standalone,signals:!0===n.signals,selectors:n.selectors||Et,viewQuery:n.viewQuery||null,features:n.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:Ii(n.inputs,r),outputs:Ii(n.outputs)}}function wo(n){n.features?.forEach(r=>r(n))}function xs(n,r){if(!n)return null;const l=r?To:Tn;return()=>("function"==typeof n?n():n).map(h=>l(h)).filter(xn)}const bo=0,mi=1,Fi=2,Bi=3,er=4,is=5,jo=6,Jo=7,Oo=8,Ur=9,xr=10,Ri=11,us=12,ta=13,Xr=14,ko=15,Ir=16,Fr=17,Br=18,br=19,bs=20,rr=21,Ar=22,Qr=23,ws=24,Qi=25,na=1,Ss=2,Sr=7,ia=9,wr=11;function Pr(n){return Array.isArray(n)&&"object"==typeof n[na]}function Nr(n){return Array.isArray(n)&&!0===n[na]}function Gs(n){return 0!=(4&n.flags)}function Ts(n){return n.componentOffset>-1}function Cs(n){return 1==(1&n.flags)}function pr(n){return!!n.template}function Tr(n){return 0!=(512&n[Fi])}function ua(n,r){return n.hasOwnProperty(qi)?n[qi]:null}let Ya=fi.WeakRef??class kl{constructor(r){this.ref=r}deref(){return this.ref}},Fl=0,Rs=null,ha=!1;function Or(n){const r=Rs;return Rs=n,r}class pl{constructor(){this.id=Fl++,this.ref=function Ja(n){return new Ya(n)}(this),this.producers=new Map,this.consumers=new Map,this.trackingVersion=0,this.valueVersion=0}consumerPollProducersForChange(){for(const[r,l]of this.producers){const h=l.producerNode.deref();if(void 0!==h&&l.atTrackingVersion===this.trackingVersion){if(h.producerPollStatus(l.seenValueVersion))return!0}else this.producers.delete(r),h?.consumers.delete(this.id)}return!1}producerMayHaveChanged(){const r=ha;ha=!0;try{for(const[l,h]of this.consumers){const g=h.consumerNode.deref();void 0!==g&&g.trackingVersion===h.atTrackingVersion?g.onConsumerDependencyMayHaveChanged():(this.consumers.delete(l),g?.producers.delete(this.id))}}finally{ha=r}}producerAccessed(){if(ha)throw new Error("");if(null===Rs)return;let r=Rs.producers.get(this.id);void 0===r?(r={consumerNode:Rs.ref,producerNode:this.ref,seenValueVersion:this.valueVersion,atTrackingVersion:Rs.trackingVersion},Rs.producers.set(this.id,r),this.consumers.set(Rs.id,r)):(r.seenValueVersion=this.valueVersion,r.atTrackingVersion=Rs.trackingVersion)}get hasProducers(){return this.producers.size>0}get producerUpdatesAllowed(){return!1!==Rs?.consumerAllowSignalWrites}producerPollStatus(r){return this.valueVersion!==r||(this.onProducerUpdateValueVersion(),this.valueVersion!==r)}}let Nc=null;function Ba(n){const r=Or(null);try{return n()}finally{Or(r)}}const ac=()=>{};class mu extends pl{constructor(r,l,h){super(),this.watch=r,this.schedule=l,this.dirty=!1,this.cleanupFn=ac,this.registerOnCleanup=g=>{this.cleanupFn=g},this.consumerAllowSignalWrites=h}notify(){this.dirty||this.schedule(this),this.dirty=!0}onConsumerDependencyMayHaveChanged(){this.notify()}onProducerUpdateValueVersion(){}run(){if(this.dirty=!1,0!==this.trackingVersion&&!this.consumerPollProducersForChange())return;const r=Or(this);this.trackingVersion++;try{this.cleanupFn(),this.cleanupFn=ac,this.watch(this.registerOnCleanup)}finally{Or(r)}}cleanup(){this.cleanupFn()}}class zl{constructor(r,l,h){this.previousValue=r,this.currentValue=l,this.firstChange=h}isFirstChange(){return this.firstChange}}function lc(){return zc}function zc(n){return n.type.prototype.ngOnChanges&&(n.setInput=Ul),Uc}function Uc(){const n=cc(this),r=n?.current;if(r){const l=n.previous;if(l===xt)n.previous=r;else for(let h in r)l[h]=r[h];n.current=null,this.ngOnChanges(r)}}function Ul(n,r,l,h){const g=this.declaredInputs[l],T=cc(n)||function uc(n,r){return n[Na]=r}(n,{previous:xt,current:null}),M=T.current||(T.current={}),F=T.previous,V=F[g];M[g]=new zl(V&&V.currentValue,r,F===xt),n[h]=r}lc.ngInherit=!0;const Na="__ngSimpleChanges__";function cc(n){return n[Na]||null}const Z=function(n,r,l){};function be(n){for(;Array.isArray(n);)n=n[bo];return n}function vn(n,r){return be(r[n])}function Dn(n,r){return be(r[n.index])}function Co(n,r){return n.data[r]}function _o(n,r){return n[r]}function Ki(n,r){const l=r[n];return Pr(l)?l:l[bo]}function Eo(n,r){return null==r?null:n[r]}function Ls(n){n[Fr]=0}function Ds(n){1024&n[Fi]||(n[Fi]|=1024,Vr(n,1))}function fs(n){1024&n[Fi]&&(n[Fi]&=-1025,Vr(n,-1))}function Vr(n,r){let l=n[Bi];if(null===l)return;l[is]+=r;let h=l;for(l=l[Bi];null!==l&&(1===r&&1===h[is]||-1===r&&0===h[is]);)l[is]+=r,h=l,l=l[Bi]}const Ni={lFrame:Bs(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function gl(){return Ni.bindingsEnabled}function ga(){return null!==Ni.skipHydrationRootTNode}function Gn(){return Ni.lFrame.lView}function Do(){return Ni.lFrame.tView}function _l(n){return Ni.lFrame.contextLView=n,n[Oo]}function hc(n){return Ni.lFrame.contextLView=null,n}function jr(){let n=pc();for(;null!==n&&64===n.type;)n=n.parent;return n}function pc(){return Ni.lFrame.currentTNode}function ks(n,r){const l=Ni.lFrame;l.currentTNode=n,l.isParent=r}function Fs(){return Ni.lFrame.isParent}function jl(){Ni.lFrame.isParent=!1}function Wr(){const n=Ni.lFrame;let r=n.bindingRootIndex;return-1===r&&(r=n.bindingRootIndex=n.tView.bindingStartIndex),r}function aa(){return Ni.lFrame.bindingIndex}function Xa(){return Ni.lFrame.bindingIndex++}function rs(n){const r=Ni.lFrame,l=r.bindingIndex;return r.bindingIndex=r.bindingIndex+n,l}function gd(n,r){const l=Ni.lFrame;l.bindingIndex=l.bindingRootIndex=n,mc(r)}function mc(n){Ni.lFrame.currentDirectiveIndex=n}function Hc(){return Ni.lFrame.currentQueryIndex}function es(n){Ni.lFrame.currentQueryIndex=n}function _u(n){const r=n[mi];return 2===r.type?r.declTNode:1===r.type?n[jo]:null}function Gc(n,r,l){if(l&Yt.SkipSelf){let g=r,T=n;for(;!(g=g.parent,null!==g||l&Yt.Host||(g=_u(T),null===g||(T=T[Xr],10&g.type))););if(null===g)return!1;r=g,n=T}const h=Ni.lFrame=yu();return h.currentTNode=r,h.lView=n,!0}function Wc(n){const r=yu(),l=n[mi];Ni.lFrame=r,r.currentTNode=l.firstChild,r.lView=n,r.tView=l,r.contextLView=n,r.bindingIndex=l.bindingStartIndex,r.inI18n=!1}function yu(){const n=Ni.lFrame,r=null===n?null:n.child;return null===r?Bs(n):r}function Bs(n){const r={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:n,child:null,inI18n:!1};return null!==n&&(n.child=r),r}function qc(){const n=Ni.lFrame;return Ni.lFrame=n.parent,n.currentTNode=null,n.lView=null,n}const vu=qc;function Ns(){const n=qc();n.isParent=!0,n.tView=null,n.selectedIndex=-1,n.contextLView=null,n.elementDepthCount=0,n.currentDirectiveIndex=-1,n.currentNamespace=null,n.bindingRootIndex=-1,n.bindingIndex=-1,n.currentQueryIndex=0}function qr(){return Ni.lFrame.selectedIndex}function di(n){Ni.lFrame.selectedIndex=n}function _r(){const n=Ni.lFrame;return Co(n.tView,n.selectedIndex)}let B=!0;function A(){return B}function U(n){B=n}function Be(n,r){for(let l=r.directiveStart,h=r.directiveEnd;l<h;l++){const T=n.data[l].type.prototype,{ngAfterContentInit:M,ngAfterContentChecked:F,ngAfterViewInit:V,ngAfterViewChecked:oe,ngOnDestroy:Pe}=T;M&&(n.contentHooks??=[]).push(-l,M),F&&((n.contentHooks??=[]).push(l,F),(n.contentCheckHooks??=[]).push(l,F)),V&&(n.viewHooks??=[]).push(-l,V),oe&&((n.viewHooks??=[]).push(l,oe),(n.viewCheckHooks??=[]).push(l,oe)),null!=Pe&&(n.destroyHooks??=[]).push(l,Pe)}}function qe(n,r,l){_i(n,r,3,l)}function Jt(n,r,l,h){(3&n[Fi])===l&&_i(n,r,l,h)}function Rn(n,r){let l=n[Fi];(3&l)===r&&(l&=8191,l+=1,n[Fi]=l)}function _i(n,r,l,h){const T=h??-1,M=r.length-1;let F=0;for(let V=void 0!==h?65535&n[Fr]:0;V<M;V++)if("number"==typeof r[V+1]){if(F=r[V],null!=h&&F>=h)break}else r[V]<0&&(n[Fr]+=65536),(F<T||-1==T)&&(Mo(n,l,r,V),n[Fr]=(4294901760&n[Fr])+V+2),V++}function Ai(n,r){Z(4,n,r);const l=Or(null);try{r.call(n)}finally{Or(l),Z(5,n,r)}}function Mo(n,r,l,h){const g=l[h]<0,T=l[h+1],F=n[g?-l[h]:l[h]];g?n[Fi]>>13<n[Fr]>>16&&(3&n[Fi])===r&&(n[Fi]+=8192,Ai(F,T)):Ai(F,T)}const p=-1;class o{constructor(r,l,h){this.factory=r,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=h}}function $(n){return n!==p}function ce(n){return 32767&n}function $e(n,r){let l=function Ie(n){return n>>16}(n),h=r;for(;l>0;)h=h[Xr],l--;return h}let Qe=!0;function Ye(n){const r=Qe;return Qe=n,r}const ue=255,He=5;let pt=0;const ht={};function Lt(n,r){const l=qt(n,r);if(-1!==l)return l;const h=r[mi];h.firstCreatePass&&(n.injectorIndex=r.length,Ot(h.data,n),Ot(r,null),Ot(h.blueprint,null));const g=$t(n,r),T=n.injectorIndex;if($(g)){const M=ce(g),F=$e(g,r),V=F[mi].data;for(let oe=0;oe<8;oe++)r[T+oe]=F[M+oe]|V[M+oe]}return r[T+8]=g,T}function Ot(n,r){n.push(0,0,0,0,0,0,0,0,r)}function qt(n,r){return-1===n.injectorIndex||n.parent&&n.parent.injectorIndex===n.injectorIndex||null===r[n.injectorIndex+8]?-1:n.injectorIndex}function $t(n,r){if(n.parent&&-1!==n.parent.injectorIndex)return n.parent.injectorIndex;let l=0,h=null,g=r;for(;null!==g;){if(h=Ti(g),null===h)return p;if(l++,g=g[Xr],-1!==h.injectorIndex)return h.injectorIndex|l<<16}return p}function an(n,r,l){!function Pt(n,r,l){let h;"string"==typeof l?h=l.charCodeAt(0)||0:l.hasOwnProperty(wi)&&(h=l[wi]),null==h&&(h=l[wi]=pt++);const g=h&ue;r.data[n+(g>>He)]|=1<<g}(n,r,l)}function nn(n,r,l){if(l&Yt.Optional||void 0!==n)return n;dt()}function An(n,r,l,h){if(l&Yt.Optional&&void 0===h&&(h=null),!(l&(Yt.Self|Yt.Host))){const g=n[Ur],T=Ci(void 0);try{return g?g.get(r,h,l&Yt.Optional):Oi(r,h,l&Yt.Optional)}finally{Ci(T)}}return nn(h,0,l)}function pn(n,r,l,h=Yt.Default,g){if(null!==n){if(2048&r[Fi]&&!(h&Yt.Self)){const M=function fo(n,r,l,h,g){let T=n,M=r;for(;null!==T&&null!==M&&2048&M[Fi]&&!(512&M[Fi]);){const F=$n(T,M,l,h|Yt.Self,ht);if(F!==ht)return F;let V=T.parent;if(!V){const oe=M[bs];if(oe){const Pe=oe.get(l,ht,h);if(Pe!==ht)return Pe}V=Ti(M),M=M[Xr]}T=V}return g}(n,r,l,h,ht);if(M!==ht)return M}const T=$n(n,r,l,h,ht);if(T!==ht)return T}return An(r,l,h,g)}function $n(n,r,l,h,g){const T=function Bn(n){if("string"==typeof n)return n.charCodeAt(0)||0;const r=n.hasOwnProperty(wi)?n[wi]:void 0;return"number"==typeof r?r>=0?r&ue:vi:r}(l);if("function"==typeof T){if(!Gc(r,n,h))return h&Yt.Host?nn(g,0,h):An(r,l,h,g);try{const M=T(h);if(null!=M||h&Yt.Optional)return M;dt()}finally{vu()}}else if("number"==typeof T){let M=null,F=qt(n,r),V=p,oe=h&Yt.Host?r[ko][jo]:null;for((-1===F||h&Yt.SkipSelf)&&(V=-1===F?$t(n,r):r[F+8],V!==p&&Di(h,!1)?(M=r[mi],F=ce(V),r=$e(V,r)):F=-1);-1!==F;){const Pe=r[mi];if(Yn(T,F,Pe.data)){const ft=ln(F,r,l,M,h,oe);if(ft!==ht)return ft}V=r[F+8],V!==p&&Di(h,r[mi].data[F+8]===oe)&&Yn(T,F,r)?(M=Pe,F=ce(V),r=$e(V,r)):F=-1}}return g}function ln(n,r,l,h,g,T){const M=r[mi],F=M.data[n+8],Pe=Mn(F,M,l,null==h?Ts(F)&&Qe:h!=M&&0!=(3&F.type),g&Yt.Host&&T===F);return null!==Pe?jn(r,M,Pe,F):ht}function Mn(n,r,l,h,g){const T=n.providerIndexes,M=r.data,F=1048575&T,V=n.directiveStart,Pe=T>>20,Ht=g?F+Pe:n.directiveEnd;for(let rn=h?F:F+Pe;rn<Ht;rn++){const Zn=M[rn];if(rn<V&&l===Zn||rn>=V&&Zn.type===l)return rn}if(g){const rn=M[V];if(rn&&pr(rn)&&rn.type===l)return V}return null}function jn(n,r,l,h){let g=n[l];const T=r.data;if(function c(n){return n instanceof o}(g)){const M=g;M.resolving&&function Se(n,r){const l=r?`. Dependency path: ${r.join(" > ")} > ${n}`:"";throw new ae(-200,`Circular dependency in DI detected for ${n}${l}`)}(function Ze(n){return"function"==typeof n?n.name||n.toString():"object"==typeof n&&null!=n&&"function"==typeof n.type?n.type.name||n.type.toString():xe(n)}(T[l]));const F=Ye(M.canSeeViewProviders);M.resolving=!0;const V=M.injectImpl?Ci(M.injectImpl):null;Gc(n,h,Yt.Default);try{g=n[l]=M.factory(void 0,T,n,h),r.firstCreatePass&&l>=h.directiveStart&&function le(n,r,l){const{ngOnChanges:h,ngOnInit:g,ngDoCheck:T}=r.type.prototype;if(h){const M=zc(r);(l.preOrderHooks??=[]).push(n,M),(l.preOrderCheckHooks??=[]).push(n,M)}g&&(l.preOrderHooks??=[]).push(0-n,g),T&&((l.preOrderHooks??=[]).push(n,T),(l.preOrderCheckHooks??=[]).push(n,T))}(l,T[l],r)}finally{null!==V&&Ci(V),Ye(F),M.resolving=!1,vu()}}return g}function Yn(n,r,l){return!!(l[r+(n>>He)]&1<<n)}function Di(n,r){return!(n&Yt.Self||n&Yt.Host&&r)}class $i{constructor(r,l){this._tNode=r,this._lView=l}get(r,l,h){return pn(this._tNode,this._lView,r,kt(h),l)}}function vi(){return new $i(jr(),Gn())}function ki(n){return po(()=>{const r=n.prototype.constructor,l=r[qi]||ho(r),h=Object.prototype;let g=Object.getPrototypeOf(n.prototype).constructor;for(;g&&g!==h;){const T=g[qi]||ho(g);if(T&&T!==l)return T;g=Object.getPrototypeOf(g)}return T=>new T})}function ho(n){return Ce(n)?()=>{const r=ho(Oe(n));return r&&r()}:ua(n)}function Ti(n){const r=n[mi],l=r.type;return 2===l?r.declTNode:1===l?n[jo]:null}function Fo(n){return function Wn(n,r){if("class"===r)return n.classes;if("style"===r)return n.styles;const l=n.attrs;if(l){const h=l.length;let g=0;for(;g<h;){const T=l[g];if(co(T))break;if(0===T)g+=2;else if("number"==typeof T)for(g++;g<h&&"string"==typeof l[g];)g++;else{if(T===r)return l[g+1];g+=2}}}return null}(jr(),n)}const No="__parameters__";function _s(n,r,l){return po(()=>{const h=function Yr(n){return function(...l){if(n){const h=n(...l);for(const g in h)this[g]=h[g]}}}(r);function g(...T){if(this instanceof g)return h.apply(this,T),this;const M=new g(...T);return F.annotation=M,F;function F(V,oe,Pe){const ft=V.hasOwnProperty(No)?V[No]:Object.defineProperty(V,No,{value:[]})[No];for(;ft.length<=Pe;)ft.push(null);return(ft[Pe]=ft[Pe]||[]).push(M),V}}return l&&(g.prototype=Object.create(l.prototype)),g.prototype.ngMetadataName=n,g.annotationCls=g,g})}function Gl(n,r){n.forEach(l=>Array.isArray(l)?Gl(l,r):r(l))}function zp(n,r,l){r>=n.length?n.push(l):n.splice(r,0,l)}function yd(n,r){return r>=n.length-1?n.pop():n.splice(r,1)[0]}function vd(n,r){const l=[];for(let h=0;h<n;h++)l.push(r);return l}function Js(n,r,l){let h=Wl(n,r);return h>=0?n[1|h]=l:(h=~h,function vm(n,r,l,h){let g=n.length;if(g==r)n.push(l,h);else if(1===g)n.push(h,n[0]),n[0]=l;else{for(g--,n.push(n[g-1],n[g]);g>r;)n[g]=n[g-2],g--;n[r]=l,n[r+1]=h}}(n,h,r,l)),h}function el(n,r){const l=Wl(n,r);if(l>=0)return n[1|l]}function Wl(n,r){return function Vp(n,r,l){let h=0,g=n.length>>l;for(;g!==h;){const T=h+(g-h>>1),M=n[T<<l];if(r===M)return T<<l;M>r?g=T:h=T+1}return~(g<<l)}(n,r,1)}const nl=ti(_s("Optional"),8),yh=ti(_s("SkipSelf"),4);function Eh(n){return 128==(128&n.flags)}var sl=(()=>((sl=sl||{})[sl.Important=1]="Important",sl[sl.DashCase=2]="DashCase",sl))();const Xc=/^>|^->|<!--|-->|--!>|<!-$/g,Em=/(<|>)/,Dm="\u200b$1\u200b";const Dh=new Map;let __=0;const Id="__ngContext__";function Us(n,r){Pr(r)?(n[Id]=r[br],function Mm(n){Dh.set(n[br],n)}(r)):n[Id]=r}let ja;function ql(n,r){return ja(n,r)}function Du(n){const r=n[Bi];return Nr(r)?r[Bi]:r}function Ah(n){return eu(n[us])}function Qc(n){return eu(n[er])}function eu(n){for(;null!==n&&!Nr(n);)n=n[er];return n}function Cl(n,r,l,h,g){if(null!=h){let T,M=!1;Nr(h)?T=h:Pr(h)&&(M=!0,h=h[bo]);const F=be(h);0===n&&null!==l?null==g?wa(r,l,F):Zs(r,l,F,g||null,!0):1===n&&null!==l?Zs(r,l,F,g||null,!0):2===n?function ou(n,r,l){const h=Sd(n,r);h&&function km(n,r,l,h){n.removeChild(r,l,h)}(n,h,r,l)}(r,F,M):3===n&&r.destroyNode(F),null!=T&&function T_(n,r,l,h,g){const T=l[Sr];T!==be(l)&&Cl(r,n,h,T,g);for(let F=wr;F<l.length;F++){const V=l[F];Su(V[mi],V,n,r,h,T)}}(r,n,T,l,g)}}function nu(n,r){return n.createComment(function Kp(n){return n.replace(Xc,r=>r.replace(Em,Dm))}(r))}function Mu(n,r,l){return n.createElement(r,l)}function Lm(n,r){const l=n[ia],h=l.indexOf(r);fs(r),l.splice(h,1)}function iu(n,r){if(n.length<=wr)return;const l=wr+r,h=n[l];if(h){const g=h[Ir];null!==g&&g!==n&&Lm(g,h),r>0&&(n[l-1][er]=h[er]);const T=yd(n,wr+r);!function Pm(n,r){Su(n,r,r[Ri],2,null,null),r[bo]=null,r[jo]=null}(h[mi],h);const M=T[Br];null!==M&&M.detachView(T[mi]),h[Bi]=null,h[er]=null,h[Fi]&=-129}return h}function sf(n,r){if(!(256&r[Fi])){const l=r[Ri];r[Qr]?.destroy(),r[ws]?.destroy(),l.destroyNode&&Su(n,r,l,3,null,null),function rf(n){let r=n[us];if(!r)return El(n[mi],n);for(;r;){let l=null;if(Pr(r))l=r[us];else{const h=r[wr];h&&(l=h)}if(!l){for(;r&&!r[er]&&r!==n;)Pr(r)&&El(r[mi],r),r=r[Bi];null===r&&(r=n),Pr(r)&&El(r[mi],r),l=r&&r[er]}r=l}}(r)}}function El(n,r){if(!(256&r[Fi])){r[Fi]&=-129,r[Fi]|=256,function af(n,r){let l;if(null!=n&&null!=(l=n.destroyHooks))for(let h=0;h<l.length;h+=2){const g=r[l[h]];if(!(g instanceof o)){const T=l[h+1];if(Array.isArray(T))for(let M=0;M<T.length;M+=2){const F=g[T[M]],V=T[M+1];Z(4,F,V);try{V.call(F)}finally{Z(5,F,V)}}else{Z(4,g,T);try{T.call(g)}finally{Z(5,g,T)}}}}}(n,r),function tr(n,r){const l=n.cleanup,h=r[Jo];if(null!==l)for(let T=0;T<l.length-1;T+=2)if("string"==typeof l[T]){const M=l[T+3];M>=0?h[M]():h[-M].unsubscribe(),T+=2}else l[T].call(h[l[T+1]]);null!==h&&(r[Jo]=null);const g=r[rr];if(null!==g){r[rr]=null;for(let T=0;T<g.length;T++)(0,g[T])()}}(n,r),1===r[mi].type&&r[Ri].destroy();const l=r[Ir];if(null!==l&&Nr(r[Bi])){l!==r[Bi]&&Lm(l,r);const h=r[Br];null!==h&&h.detachView(n)}!function Dd(n){Dh.delete(n[br])}(r)}}function $a(n,r,l){return function al(n,r,l){let h=r;for(;null!==h&&40&h.type;)h=(r=h).parent;if(null===h)return l[bo];{const{componentOffset:g}=h;if(g>-1){const{encapsulation:T}=n.data[h.directiveStart+g];if(T===tn.None||T===tn.Emulated)return null}return Dn(h,l)}}(n,r.parent,l)}function Zs(n,r,l,h,g){n.insertBefore(r,l,h,g)}function wa(n,r,l){n.appendChild(r,l)}function vs(n,r,l,h,g){null!==h?Zs(n,r,l,h,g):wa(n,r,l)}function Sd(n,r){return n.parentNode(r)}function Sh(n,r,l){return Ph(n,r,l)}let cf,Lh,Bd,Ph=function lf(n,r,l){return 40&n.type?Dn(n,l):null};function Pd(n,r,l,h){const g=$a(n,h,r),T=r[Ri],F=Sh(h.parent||r[jo],h,r);if(null!=g)if(Array.isArray(l))for(let V=0;V<l.length;V++)vs(T,g,l[V],F,!1);else vs(T,g,l,F,!1);void 0!==cf&&cf(T,h,r,l,g)}function Od(n,r){if(null!==r){const l=r.type;if(3&l)return Dn(r,n);if(4&l)return Yl(-1,n[r.index]);if(8&l){const h=r.child;if(null!==h)return Od(n,h);{const g=n[r.index];return Nr(g)?Yl(-1,g):be(g)}}if(32&l)return ql(r,n)()||be(n[r.index]);{const h=Dl(n,r);return null!==h?Array.isArray(h)?h[0]:Od(Du(n[ko]),h):Od(n,r.next)}}return null}function Dl(n,r){return null!==r?n[ko][jo].projection[r.projection]:null}function Yl(n,r){const l=wr+n+1;if(l<r.length){const h=r[l],g=h[mi].firstChild;if(null!==g)return Od(h,g)}return r[Sr]}function Ld(n,r,l,h,g,T,M){for(;null!=l;){const F=h[l.index],V=l.type;if(M&&0===r&&(F&&Us(be(F),h),l.flags|=2),32!=(32&l.flags))if(8&V)Ld(n,r,l.child,h,g,T,!1),Cl(r,n,g,F,T);else if(32&V){const oe=ql(l,h);let Pe;for(;Pe=oe();)Cl(r,n,g,Pe,T);Cl(r,n,g,F,T)}else 16&V?uf(n,r,h,l,g,T):Cl(r,n,g,F,T);l=M?l.projectionNext:l.next}}function Su(n,r,l,h,g,T){Ld(l,h,n.firstChild,r,g,T,!1)}function uf(n,r,l,h,g,T){const M=l[ko],V=M[jo].projection[h.projection];if(Array.isArray(V))for(let oe=0;oe<V.length;oe++)Cl(r,n,g,V[oe],T);else{let oe=V;const Pe=M[Bi];Eh(h)&&(oe.flags|=128),Ld(n,r,oe,Pe,g,T,!0)}}function Rh(n,r,l){""===l?n.removeAttribute(r,"class"):n.setAttribute(r,"class",l)}function hf(n,r,l){const{mergedAttrs:h,classes:g,styles:T}=l;null!==h&&Go(n,r,h),null!==g&&Rh(n,r,g),null!==T&&function C_(n,r,l){n.setAttribute(r,"style",l)}(n,r,T)}function D_(n){Lh=n}function Nm(n){return function ff(){if(void 0===Bd&&(Bd=null,fi.trustedTypes))try{Bd=fi.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:n=>n,createScript:n=>n,createScriptURL:n=>n})}catch{}return Bd}()?.createScriptURL(n)||n}class gf{constructor(r){this.changingThisBreaksApplicationSecurity=r}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${Ee})`}}function vc(n){return n instanceof gf?n.changingThisBreaksApplicationSecurity:n}function su(n,r){const l=function M_(n){return n instanceof gf&&n.getTypeName()||null}(n);if(null!=l&&l!==r){if("ResourceURL"===l&&"URL"===r)return!0;throw new Error(`Required a safe ${r}, got a ${l} (see ${Ee})`)}return l===r}const P_=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var ss=(()=>((ss=ss||{})[ss.NONE=0]="NONE",ss[ss.HTML=1]="HTML",ss[ss.STYLE=2]="STYLE",ss[ss.SCRIPT=3]="SCRIPT",ss[ss.URL=4]="URL",ss[ss.RESOURCE_URL=5]="RESOURCE_URL",ss))();function jd(n){const r=bc();return r?r.sanitize(ss.URL,n)||"":su(n,"URL")?vc(n):function vf(n){return(n=String(n)).match(P_)?n:"unsafe:"+n}(xe(n))}function zh(n){const r=bc();if(r)return Nm(r.sanitize(ss.RESOURCE_URL,n)||"");if(su(n,"ResourceURL"))return Nm(vc(n));throw new ae(904,!1)}function Gm(n,r,l){return function F_(n,r){return"src"===r&&("embed"===n||"frame"===n||"iframe"===n||"media"===n||"script"===n)||"href"===r&&("base"===n||"link"===n)?zh:jd}(r,l)(n)}function bc(){const n=Gn();return n&&n[xr].sanitizer}class lr{constructor(r,l){this._desc=r,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=Sn({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const ku=new lr("ENVIRONMENT_INITIALIZER"),au=new lr("INJECTOR",-1),Wm=new lr("INJECTOR_DEF_TYPES");class qm{get(r,l=ve){if(l===ve){const h=new Error(`NullInjectorError: No provider for ${Le(r)}!`);throw h.name="NullInjectorError",h}return l}}function Cf(n){return{\u0275providers:n}}function Ym(...n){return{\u0275providers:Ef(0,n),\u0275fromNgModule:!0}}function Ef(n,...r){const l=[],h=new Set;let g;return Gl(r,T=>{const M=T;Df(M,l,[],h)&&(g||=[],g.push(M))}),void 0!==g&&Jm(g,l),l}function Jm(n,r){for(let l=0;l<n.length;l++){const{providers:g}=n[l];$d(g,T=>{r.push(T)})}}function Df(n,r,l,h){if(!(n=Oe(n)))return!1;let g=null,T=At(n);const M=!T&&Xi(n);if(T||M){if(M&&!M.standalone)return!1;g=n}else{const V=n.ngModule;if(T=At(V),!T)return!1;g=V}const F=h.has(g);if(M){if(F)return!1;if(h.add(g),M.dependencies){const V="function"==typeof M.dependencies?M.dependencies():M.dependencies;for(const oe of V)Df(oe,r,l,h)}}else{if(!T)return!1;{if(null!=T.imports&&!F){let oe;h.add(g);try{Gl(T.imports,Pe=>{Df(Pe,r,l,h)&&(oe||=[],oe.push(Pe))})}finally{}void 0!==oe&&Jm(oe,r)}if(!F){const oe=ua(g)||(()=>new g);r.push({provide:g,useFactory:oe,deps:Et},{provide:Wm,useValue:g,multi:!0},{provide:ku,useValue:()=>Y(g),multi:!0})}const V=T.providers;null==V||F||$d(V,Pe=>{r.push(Pe)})}}return g!==n&&void 0!==n.providers}function $d(n,r){for(let l of n)nt(l)&&(l=l.\u0275providers),Array.isArray(l)?$d(l,r):r(l)}const Zh=ge({provide:String,useValue:ge});function Fu(n){return null!==n&&"object"==typeof n&&Zh in n}function ll(n){return"function"==typeof n}const Vh=new lr("Set Injector scope."),wc={},Qm={};let Mf;function Gd(){return void 0===Mf&&(Mf=new qm),Mf}class Tc{}class jh extends Tc{get destroyed(){return this._destroyed}constructor(r,l,h,g){super(),this.parent=l,this.source=h,this.scopes=g,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Is(r,M=>this.processProvider(M)),this.records.set(au,Bu(void 0,this)),g.has("environment")&&this.records.set(Tc,Bu(void 0,this));const T=this.records.get(Vh);null!=T&&"string"==typeof T.value&&this.scopes.add(T.value),this.injectorDefTypes=new Set(this.get(Wm.multi,Et,Yt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const l of this._ngOnDestroyHooks)l.ngOnDestroy();const r=this._onDestroyHooks;this._onDestroyHooks=[];for(const l of r)l()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(r){return this.assertNotDestroyed(),this._onDestroyHooks.push(r),()=>this.removeOnDestroy(r)}runInContext(r){this.assertNotDestroyed();const l=tt(this),h=Ci(void 0);try{return r()}finally{tt(l),Ci(h)}}get(r,l=ve,h=Yt.Default){if(this.assertNotDestroyed(),r.hasOwnProperty(mo))return r[mo](this);h=kt(h);const g=tt(this),T=Ci(void 0);try{if(!(h&Yt.SkipSelf)){let F=this.records.get(r);if(void 0===F){const V=function og(n){return"function"==typeof n||"object"==typeof n&&n instanceof lr}(r)&&Gi(r);F=V&&this.injectableDefInScope(V)?Bu($h(r),wc):null,this.records.set(r,F)}if(null!=F)return this.hydrate(r,F)}return(h&Yt.Self?Gd():this.parent).get(r,l=h&Yt.Optional&&l===ve?null:l)}catch(M){if("NullInjectorError"===M.name){if((M[yt]=M[yt]||[]).unshift(Le(r)),g)throw M;return function Si(n,r,l,h){const g=n[yt];throw r[St]&&g.unshift(r[St]),n.message=function ji(n,r,l,h=null){n=n&&"\n"===n.charAt(0)&&"\u0275"==n.charAt(1)?n.slice(2):n;let g=Le(r);if(Array.isArray(r))g=r.map(Le).join(" -> ");else if("object"==typeof r){let T=[];for(let M in r)if(r.hasOwnProperty(M)){let F=r[M];T.push(M+":"+("string"==typeof F?JSON.stringify(F):Le(F)))}g=`{${T.join(", ")}}`}return`${l}${h?"("+h+")":""}[${g}]: ${n.replace(Ut,"\n  ")}`}("\n"+n.message,g,l,h),n.ngTokenPath=g,n[yt]=null,n}(M,r,"R3InjectorError",this.source)}throw M}finally{Ci(T),tt(g)}}resolveInjectorInitializers(){const r=tt(this),l=Ci(void 0);try{const h=this.get(ku.multi,Et,Yt.Self);for(const g of h)g()}finally{tt(r),Ci(l)}}toString(){const r=[],l=this.records;for(const h of l.keys())r.push(Le(h));return`R3Injector[${r.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ae(205,!1)}processProvider(r){let l=ll(r=Oe(r))?r:Oe(r&&r.provide);const h=function tg(n){return Fu(n)?Bu(void 0,n.useValue):Bu(ng(n),wc)}(r);if(ll(r)||!0!==r.multi)this.records.get(l);else{let g=this.records.get(l);g||(g=Bu(void 0,wc,!0),g.factory=()=>_n(g.multi),this.records.set(l,g)),l=r,g.multi.push(r)}this.records.set(l,h)}hydrate(r,l){return l.value===wc&&(l.value=Qm,l.value=l.factory()),"object"==typeof l.value&&l.value&&function Hh(n){return null!==n&&"object"==typeof n&&"function"==typeof n.ngOnDestroy}(l.value)&&this._ngOnDestroyHooks.add(l.value),l.value}injectableDefInScope(r){if(!r.providedIn)return!1;const l=Oe(r.providedIn);return"string"==typeof l?"any"===l||this.scopes.has(l):this.injectorDefTypes.has(l)}removeOnDestroy(r){const l=this._onDestroyHooks.indexOf(r);-1!==l&&this._onDestroyHooks.splice(l,1)}}function $h(n){const r=Gi(n),l=null!==r?r.factory:ua(n);if(null!==l)return l;if(n instanceof lr)throw new ae(204,!1);if(n instanceof Function)return function eg(n){const r=n.length;if(r>0)throw vd(r,"?"),new ae(204,!1);const l=function Je(n){return n&&(n[Zt]||n[hn])||null}(n);return null!==l?()=>l.factory(n):()=>new n}(n);throw new ae(204,!1)}function ng(n,r,l){let h;if(ll(n)){const g=Oe(n);return ua(g)||$h(g)}if(Fu(n))h=()=>Oe(n.useValue);else if(function Xm(n){return!(!n||!n.useFactory)}(n))h=()=>n.useFactory(..._n(n.deps||[]));else if(function Km(n){return!(!n||!n.useExisting)}(n))h=()=>Y(Oe(n.useExisting));else{const g=Oe(n&&(n.useClass||n.provide));if(!function ig(n){return!!n.deps}(n))return ua(g)||$h(g);h=()=>new g(..._n(n.deps))}return h}function Bu(n,r,l=!1){return{factory:n,value:r,multi:l?[]:void 0}}function Is(n,r){for(const l of n)Array.isArray(l)?Is(l,r):l&&nt(l)?Is(l.\u0275providers,r):r(l)}const Nu=new lr("AppId",{providedIn:"root",factory:()=>zu}),zu="ng",Uu=new lr("Platform Initializer"),Gh=new lr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),N_=new lr("CSP nonce",{providedIn:"root",factory:()=>function Fd(){if(void 0!==Lh)return Lh;if(typeof document<"u")return document;throw new ae(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});let Jd=(n,r)=>null;function sg(n,r){return Jd(n,r)}class $u{}class Of{}class H_{resolveComponentFactory(r){throw function $_(n){const r=Error(`No component factory found for ${Le(n)}.`);return r.ngComponent=n,r}(r)}}let np=(()=>{class n{}return n.NULL=new H_,n})();function G_(){return Hu(jr(),Gn())}function Hu(n,r){return new Kd(Dn(n,r))}let Kd=(()=>{class n{constructor(l){this.nativeElement=l}}return n.__NG_ELEMENT_ID__=G_,n})();function W_(n){return n instanceof Kd?n.nativeElement:n}class Xd{}let Gu=(()=>{class n{constructor(){this.destroyNode=null}}return n.__NG_ELEMENT_ID__=()=>function cg(){const n=Gn(),l=Ki(jr().index,n);return(Pr(l)?l:n)[Ri]}(),n})(),ip=(()=>{class n{}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:()=>null}),n})();class op{constructor(r){this.full=r,this.major=r.split(".")[0],this.minor=r.split(".")[1],this.patch=r.split(".").slice(2).join(".")}}const q_=new op("16.1.3"),Rf={};function Qd(n){for(;n;){n[Fi]|=64;const r=Du(n);if(Tr(n)&&!r)return n;n=r}return null}function js(n){return n.ngOriginalError}class Cc{constructor(){this._console=console}handleError(r){const l=this._findOriginalError(r);this._console.error("ERROR",r),l&&this._console.error("ORIGINAL ERROR",l)}_findOriginalError(r){let l=r&&js(r);for(;l&&js(l);)l=js(l);return l||null}}const kf=new lr("",{providedIn:"root",factory:()=>!1});function Ml(n){return n instanceof Function?n():n}class Uf extends pl{constructor(){super(...arguments),this.consumerAllowSignalWrites=!1,this._lView=null}set lView(r){this._lView=r}onConsumerDependencyMayHaveChanged(){Qd(this._lView)}onProducerUpdateValueVersion(){}get hasReadASignal(){return this.hasProducers}runInContext(r,l,h){const g=Or(this);this.trackingVersion++;try{r(l,h)}finally{Or(g)}}destroy(){this.trackingVersion++}}let nh=null;function fg(){return nh??=new Uf,nh}function mg(n,r){return n[r]??fg()}function Zf(n,r){const l=fg();l.hasReadASignal&&(n[r]=nh,l.lView=n,nh=new Uf)}const go={};function Yu(n){Vf(Do(),Gn(),qr()+n,!1)}function Vf(n,r,l,h){if(!h)if(3==(3&r[Fi])){const T=n.preOrderCheckHooks;null!==T&&qe(r,T,l)}else{const T=n.preOrderHooks;null!==T&&Jt(r,T,0,l)}di(l)}function gg(n,r=null,l=null,h){const g=_g(n,r,l,h);return g.resolveInjectorInitializers(),g}function _g(n,r=null,l=null,h,g=new Set){const T=[l||Et,Ym(n)];return h=h||("object"==typeof n?void 0:Le(n)),new jh(T,r||Gd(),h||null,g)}let Ec=(()=>{class n{static create(l,h){if(Array.isArray(l))return gg({name:""},h,l,"");{const g=l.name??"";return gg({name:g},l.parent,l.providers,g)}}}return n.THROW_IF_NOT_FOUND=ve,n.NULL=new qm,n.\u0275prov=Sn({token:n,providedIn:"any",factory:()=>Y(au)}),n.__NG_ELEMENT_ID__=-1,n})();function Xu(n,r=Yt.Default){const l=Gn();return null===l?Y(n,r):pn(jr(),l,Oe(n),r)}function lu(){throw new Error("invalid")}function ed(n,r,l,h,g,T,M,F,V,oe,Pe){const ft=r.blueprint.slice();return ft[bo]=g,ft[Fi]=140|h,(null!==oe||n&&2048&n[Fi])&&(ft[Fi]|=2048),Ls(ft),ft[Bi]=ft[Xr]=n,ft[Oo]=l,ft[xr]=M||n&&n[xr],ft[Ri]=F||n&&n[Ri],ft[Ur]=V||n&&n[Ur]||null,ft[jo]=T,ft[br]=function y_(){return __++}(),ft[Ar]=Pe,ft[bs]=oe,ft[ko]=2==r.type?n[ko]:ft,ft}function td(n,r,l,h,g){let T=n.data[r];if(null===T)T=function up(n,r,l,h,g){const T=pc(),M=Fs(),V=n.data[r]=function ty(n,r,l,h,g,T){let M=r?r.injectorIndex:-1,F=0;return ga()&&(F|=128),{type:l,index:h,insertBeforeIndex:null,injectorIndex:M,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:F,providerIndexes:0,value:g,attrs:T,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:r,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,M?T:T&&T.parent,l,r,h,g);return null===n.firstChild&&(n.firstChild=V),null!==T&&(M?null==T.child&&null!==V.parent&&(T.child=V):null===T.next&&(T.next=V,V.prev=T)),V}(n,r,l,h,g),function md(){return Ni.lFrame.inI18n}()&&(T.flags|=32);else if(64&T.type){T.type=l,T.value=h,T.attrs=g;const M=function Aa(){const n=Ni.lFrame,r=n.currentTNode;return n.isParent?r:r.parent}();T.injectorIndex=null===M?-1:M.injectorIndex}return ks(T,!0),T}function ih(n,r,l,h){if(0===l)return-1;const g=r.length;for(let T=0;T<l;T++)r.push(h),n.blueprint.push(h),n.data.push(null);return g}function dp(n,r,l,h,g){const T=mg(r,Qr),M=qr(),F=2&h;try{if(di(-1),F&&r.length>Qi&&Vf(n,r,Qi,!1),Z(F?2:0,g),F)T.runInContext(l,h,g);else{const oe=Or(null);try{l(h,g)}finally{Or(oe)}}}finally{F&&null===r[Qr]&&Zf(r,Qr),di(M),Z(F?3:1,g)}}function Hf(n,r,l){if(Gs(r)){const h=Or(null);try{const T=r.directiveEnd;for(let M=r.directiveStart;M<T;M++){const F=n.data[M];F.contentQueries&&F.contentQueries(1,l[M],M)}}finally{Or(h)}}}function cu(n,r,l){gl()&&(function oy(n,r,l,h){const g=l.directiveStart,T=l.directiveEnd;Ts(l)&&function mp(n,r,l){const h=Dn(r,n),g=Gf(l);let M=16;l.signals?M=4096:l.onPush&&(M=64);const F=ah(n,ed(n,g,null,M,h,r,null,n[xr].rendererFactory.createRenderer(h,l),null,null,null));n[r.index]=F}(r,l,n.data[g+l.componentOffset]),n.firstCreatePass||Lt(l,r),Us(h,r);const M=l.initialInputs;for(let F=g;F<T;F++){const V=n.data[F],oe=jn(r,n,F,l);Us(oe,r),null!==M&&Xf(0,F-g,oe,V,0,M),pr(V)&&(Ki(l.index,r)[Oo]=jn(r,n,F,l))}}(n,r,l,Dn(l,r)),64==(64&l.flags)&&Yf(n,r,l))}function Al(n,r,l=Dn){const h=r.localNames;if(null!==h){let g=r.index+1;for(let T=0;T<h.length;T+=2){const M=h[T+1],F=-1===M?l(r,n):n[M];n[g++]=F}}}function Gf(n){const r=n.tView;return null===r||r.incompleteFirstPass?n.tView=hp(1,null,n.template,n.decls,n.vars,n.directiveDefs,n.pipeDefs,n.viewQuery,n.schemas,n.consts,n.id):r}function hp(n,r,l,h,g,T,M,F,V,oe,Pe){const ft=Qi+h,Ht=ft+g,rn=function pp(n,r){const l=[];for(let h=0;h<r;h++)l.push(h<n?null:go);return l}(ft,Ht),Zn="function"==typeof oe?oe():oe;return rn[mi]={type:n,blueprint:rn,template:l,queries:null,viewQuery:F,declTNode:r,data:rn.slice().fill(null,ft),bindingStartIndex:ft,expandoStartIndex:Ht,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof T?T():T,pipeRegistry:"function"==typeof M?M():M,firstChild:null,schemas:V,consts:Zn,incompleteFirstPass:!1,ssrId:Pe}}let qf=n=>null;function nd(n,r,l,h){for(let g in n)if(n.hasOwnProperty(g)){l=null===l?{}:l;const T=n[g];null===h?id(l,r,g,T):h.hasOwnProperty(g)&&id(l,r,h[g],T)}return l}function id(n,r,l,h){n.hasOwnProperty(l)?n[l].push(r,h):n[l]=[r,h]}function Xs(n,r,l,h,g,T,M,F){const V=Dn(r,l);let Pe,oe=r.inputs;!F&&null!=oe&&(Pe=oe[h])?(Qf(n,l,Pe,h,g),Ts(r)&&function ny(n,r){const l=Ki(r,n);16&l[Fi]||(l[Fi]|=64)}(l,r.index)):3&r.type&&(h=function rh(n){return"class"===n?"className":"for"===n?"htmlFor":"formaction"===n?"formAction":"innerHtml"===n?"innerHTML":"readonly"===n?"readOnly":"tabindex"===n?"tabIndex":n}(h),g=null!=M?M(g,r.value||"",h):g,T.setProperty(V,h,g))}function od(n,r,l,h){if(gl()){const g=null===h?null:{"":-1},T=function bg(n,r){const l=n.directiveRegistry;let h=null,g=null;if(l)for(let T=0;T<l.length;T++){const M=l[T];if(Mr(r,M.selectors,!1))if(h||(h=[]),pr(M))if(null!==M.findHostDirectiveDefs){const F=[];g=g||new Map,M.findHostDirectiveDefs(M,F,g),h.unshift(...F,M),Jf(n,r,F.length)}else h.unshift(M),Jf(n,r,0);else g=g||new Map,M.findHostDirectiveDefs?.(M,h,g),h.push(M)}return null===h?null:[h,g]}(n,l);let M,F;null===T?M=F=null:[M,F]=T,null!==M&&yg(n,r,l,M,g,F),g&&function wg(n,r,l){if(r){const h=n.localNames=[];for(let g=0;g<r.length;g+=2){const T=l[r[g+1]];if(null==T)throw new ae(-301,!1);h.push(r[g],T)}}}(l,h,g)}l.mergedAttrs=Pi(l.mergedAttrs,l.attrs)}function yg(n,r,l,h,g,T){for(let oe=0;oe<h.length;oe++)an(Lt(l,r),n,h[oe].type);!function ay(n,r,l){n.flags|=1,n.directiveStart=r,n.directiveEnd=r+l,n.providerIndexes=r}(l,n.data.length,h.length);for(let oe=0;oe<h.length;oe++){const Pe=h[oe];Pe.providersResolver&&Pe.providersResolver(Pe)}let M=!1,F=!1,V=ih(n,r,h.length,null);for(let oe=0;oe<h.length;oe++){const Pe=h[oe];l.mergedAttrs=Pi(l.mergedAttrs,Pe.hostAttrs),fp(n,l,r,V,Pe),sy(V,Pe,g),null!==Pe.contentQueries&&(l.flags|=4),(null!==Pe.hostBindings||null!==Pe.hostAttrs||0!==Pe.hostVars)&&(l.flags|=64);const ft=Pe.type.prototype;!M&&(ft.ngOnChanges||ft.ngOnInit||ft.ngDoCheck)&&((n.preOrderHooks??=[]).push(l.index),M=!0),!F&&(ft.ngOnChanges||ft.ngDoCheck)&&((n.preOrderCheckHooks??=[]).push(l.index),F=!0),V++}!function oh(n,r,l){const g=r.directiveEnd,T=n.data,M=r.attrs,F=[];let V=null,oe=null;for(let Pe=r.directiveStart;Pe<g;Pe++){const ft=T[Pe],Ht=l?l.get(ft):null,Zn=Ht?Ht.outputs:null;V=nd(ft.inputs,Pe,V,Ht?Ht.inputs:null),oe=nd(ft.outputs,Pe,oe,Zn);const ii=null===V||null===M||vo(r)?null:Mc(V,Pe,M);F.push(ii)}null!==V&&(V.hasOwnProperty("class")&&(r.flags|=8),V.hasOwnProperty("style")&&(r.flags|=16)),r.initialInputs=F,r.inputs=V,r.outputs=oe}(n,l,T)}function Yf(n,r,l){const h=l.directiveStart,g=l.directiveEnd,T=l.index,M=function _d(){return Ni.lFrame.currentDirectiveIndex}();try{di(T);for(let F=h;F<g;F++){const V=n.data[F],oe=r[F];mc(F),(null!==V.hostBindings||0!==V.hostVars||null!==V.hostAttrs)&&ry(V,oe)}}finally{di(-1),mc(M)}}function ry(n,r){null!==n.hostBindings&&n.hostBindings(1,r)}function Jf(n,r,l){r.componentOffset=l,(n.components??=[]).push(r.index)}function sy(n,r,l){if(l){if(r.exportAs)for(let h=0;h<r.exportAs.length;h++)l[r.exportAs[h]]=n;pr(r)&&(l[""]=n)}}function fp(n,r,l,h,g){n.data[h]=g;const T=g.factory||(g.factory=ua(g.type)),M=new o(T,pr(g),Xu);n.blueprint[h]=M,l[h]=M,function vg(n,r,l,h,g){const T=g.hostBindings;if(T){let M=n.hostBindingOpCodes;null===M&&(M=n.hostBindingOpCodes=[]);const F=~r.index;(function xg(n){let r=n.length;for(;r>0;){const l=n[--r];if("number"==typeof l&&l<0)return l}return 0})(M)!=F&&M.push(F),M.push(l,h,T)}}(n,r,h,ih(n,l,g.hostVars,go),g)}function Ra(n,r,l,h,g,T){const M=Dn(n,r);!function Kf(n,r,l,h,g,T,M){if(null==T)n.removeAttribute(r,g,l);else{const F=null==M?xe(T):M(T,h||"",g);n.setAttribute(r,g,F,l)}}(r[Ri],M,T,n.value,l,h,g)}function Xf(n,r,l,h,g,T){const M=T[r];if(null!==M)for(let F=0;F<M.length;)gp(h,l,M[F++],M[F++],M[F++])}function gp(n,r,l,h,g){const T=Or(null);try{const M=n.inputTransforms;null!==M&&M.hasOwnProperty(h)&&(g=M[h].call(r,g)),null!==n.setInput?n.setInput(r,g,l,h):r[h]=g}finally{Or(T)}}function Mc(n,r,l){let h=null,g=0;for(;g<l.length;){const T=l[g];if(0!==T)if(5!==T){if("number"==typeof T)break;if(n.hasOwnProperty(T)){null===h&&(h=[]);const M=n[T];for(let F=0;F<M.length;F+=2)if(M[F]===r){h.push(T,M[F+1],l[g+1]);break}}g+=2}else g+=2;else g+=4}return h}function Tg(n,r,l,h){return[n,!0,!1,r,null,0,h,l,null,null,null]}function _p(n,r){const l=n.contentQueries;if(null!==l)for(let h=0;h<l.length;h+=2){const T=l[h+1];if(-1!==T){const M=n.data[T];es(l[h]),M.contentQueries(2,r[T],T)}}}function ah(n,r){return n[us]?n[ta][er]=r:n[us]=r,n[ta]=r,r}function rd(n,r,l){es(0);const h=Or(null);try{r(n,l)}finally{Or(h)}}function Cg(n){return n[Jo]||(n[Jo]=[])}function Eg(n){return n.cleanup||(n.cleanup=[])}function yp(n,r){const l=n[Ur],h=l?l.get(Cc,null):null;h&&h.handleError(r)}function Qf(n,r,l,h,g){for(let T=0;T<l.length;){const M=l[T++],F=l[T++];gp(n.data[M],r[M],h,F,g)}}function La(n,r,l){const h=vn(r,n);!function nf(n,r,l){n.setValue(r,l)}(n[Ri],h,l)}function ly(n,r){const l=Ki(r,n),h=l[mi];!function cy(n,r){for(let l=r.length;l<n.blueprint.length;l++)r.push(n.blueprint[l])}(h,l);const g=l[bo];null!==g&&null===l[Ar]&&(l[Ar]=sg(g,l[Ur])),vp(h,l,l[Oo])}function vp(n,r,l){Wc(r);try{const h=n.viewQuery;null!==h&&rd(1,h,l);const g=n.template;null!==g&&dp(n,r,g,1,l),n.firstCreatePass&&(n.firstCreatePass=!1),n.staticContentQueries&&_p(n,r),n.staticViewQueries&&rd(2,n.viewQuery,l);const T=n.components;null!==T&&function uy(n,r){for(let l=0;l<r.length;l++)ly(n,r[l])}(r,T)}catch(h){throw n.firstCreatePass&&(n.incompleteFirstPass=!0,n.firstCreatePass=!1),h}finally{r[Fi]&=-5,Ns()}}let ec=(()=>{class n{constructor(){this.all=new Set,this.queue=new Map}create(l,h,g){const T=typeof Zone>"u"?null:Zone.current,M=new mu(l,oe=>{this.all.has(oe)&&this.queue.set(oe,T)},g);let F;this.all.add(M),M.notify();const V=()=>{M.cleanup(),F?.(),this.all.delete(M),this.queue.delete(M)};return F=h?.onDestroy(V),{destroy:V}}flush(){if(0!==this.queue.size)for(const[l,h]of this.queue)this.queue.delete(l),h?h.run(()=>l.run()):l.run()}get isQueueEmpty(){return 0===this.queue.size}}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:()=>new n}),n})();function ul(n,r,l){let h=l?n.styles:null,g=l?n.classes:null,T=0;if(null!==r)for(let M=0;M<r.length;M++){const F=r[M];"number"==typeof F?T=F:1==T?g=Me(g,F):2==T&&(h=Me(h,F+": "+r[++M]+";"))}l?n.styles=h:n.stylesWithoutHost=h,l?n.classes=g:n.classesWithoutHost=g}function Ic(n,r,l,h,g=!1){for(;null!==l;){const T=r[l.index];if(null!==T&&h.push(be(T)),Nr(T)){for(let F=wr;F<T.length;F++){const V=T[F],oe=V[mi].firstChild;null!==oe&&Ic(V[mi],V,oe,h)}T[Sr]!==T[bo]&&h.push(T[Sr])}const M=l.type;if(8&M)Ic(n,r,l.child,h);else if(32&M){const F=ql(l,r);let V;for(;V=F();)h.push(V)}else if(16&M){const F=Dl(r,l);if(Array.isArray(F))h.push(...F);else{const V=Du(r[ko]);Ic(V[mi],V,F,h,!0)}}l=g?l.projectionNext:l.next}return h}function lh(n,r,l,h=!0){const g=r[xr].rendererFactory;g.begin&&g.begin();try{xp(n,r,n.template,l)}catch(M){throw h&&yp(r,M),M}finally{g.end&&g.end(),r[xr].effectManager?.flush()}}function xp(n,r,l,h){const g=r[Fi];if(256!=(256&g)){r[xr].effectManager?.flush(),Wc(r);try{Ls(r),function yl(n){return Ni.lFrame.bindingIndex=n}(n.bindingStartIndex),null!==l&&dp(n,r,l,2,h);const M=3==(3&g);if(M){const oe=n.preOrderCheckHooks;null!==oe&&qe(r,oe,null)}else{const oe=n.preOrderHooks;null!==oe&&Jt(r,oe,0,null),Rn(r,0)}if(function Sg(n){for(let r=Ah(n);null!==r;r=Qc(r)){if(!r[Ss])continue;const l=r[ia];for(let h=0;h<l.length;h++){Ds(l[h])}}}(r),Ag(r,2),null!==n.contentQueries&&_p(n,r),M){const oe=n.contentCheckHooks;null!==oe&&qe(r,oe)}else{const oe=n.contentHooks;null!==oe&&Jt(r,oe,1),Rn(r,1)}!function Qu(n,r){const l=n.hostBindingOpCodes;if(null===l)return;const h=mg(r,ws);try{for(let g=0;g<l.length;g++){const T=l[g];if(T<0)di(~T);else{const M=T,F=l[++g],V=l[++g];gd(F,M),h.runInContext(V,2,r[M])}}}finally{null===r[ws]&&Zf(r,ws),di(-1)}}(n,r);const F=n.components;null!==F&&tm(r,F,0);const V=n.viewQuery;if(null!==V&&rd(2,V,h),M){const oe=n.viewCheckHooks;null!==oe&&qe(r,oe)}else{const oe=n.viewHooks;null!==oe&&Jt(r,oe,2),Rn(r,2)}!0===n.firstUpdatePass&&(n.firstUpdatePass=!1),r[Fi]&=-73,fs(r)}finally{Ns()}}}function Ag(n,r){for(let l=Ah(n);null!==l;l=Qc(l))for(let h=wr;h<l.length;h++)em(l[h],r)}function Pg(n,r,l){em(Ki(r,n),l)}function em(n,r){if(!function fr(n){return 128==(128&n[Fi])}(n))return;const l=n[mi];if(80&n[Fi]&&0===r||1024&n[Fi]||2===r)xp(l,n,l.template,n[Oo]);else if(n[is]>0){Ag(n,1);const g=n[mi].components;null!==g&&tm(n,g,1)}}function tm(n,r,l){for(let h=0;h<r.length;h++)Pg(n,r[h],l)}class sd{get rootNodes(){const r=this._lView,l=r[mi];return Ic(l,r,l.firstChild,[])}constructor(r,l){this._lView=r,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[Oo]}set context(r){this._lView[Oo]=r}get destroyed(){return 256==(256&this._lView[Fi])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const r=this._lView[Bi];if(Nr(r)){const l=r[8],h=l?l.indexOf(this):-1;h>-1&&(iu(r,h),yd(l,h))}this._attachedToViewContainer=!1}sf(this._lView[mi],this._lView)}onDestroy(r){!function qs(n,r){if(256==(256&n[Fi]))throw new ae(911,!1);null===n[rr]&&(n[rr]=[]),n[rr].push(r)}(this._lView,r)}markForCheck(){Qd(this._cdRefInjectingView||this._lView)}detach(){this._lView[Fi]&=-129}reattach(){this._lView[Fi]|=128}detectChanges(){lh(this._lView[mi],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ae(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function Om(n,r){Su(n,r,r[Ri],2,null,null)}(this._lView[mi],this._lView)}attachToAppRef(r){if(this._attachedToViewContainer)throw new ae(902,!1);this._appRef=r}}class Og extends sd{constructor(r){super(r),this._view=r}detectChanges(){const r=this._view;lh(r[mi],r,r[Oo],!1)}checkNoChanges(){}get context(){return null}}class nm extends np{constructor(r){super(),this.ngModule=r}resolveComponentFactory(r){const l=Xi(r);return new ch(l,this.ngModule)}}function tc(n){const r=[];for(let l in n)n.hasOwnProperty(l)&&r.push({propName:n[l],templateName:l});return r}class hy{constructor(r,l){this.injector=r,this.parentInjector=l}get(r,l,h){h=kt(h);const g=this.injector.get(r,Rf,h);return g!==Rf||l===Rf?g:this.parentInjector.get(r,l,h)}}class ch extends Of{get inputs(){const r=this.componentDef,l=r.inputTransforms,h=tc(r.inputs);if(null!==l)for(const g of h)l.hasOwnProperty(g.propName)&&(g.transform=l[g.propName]);return h}get outputs(){return tc(this.componentDef.outputs)}constructor(r,l){super(),this.componentDef=r,this.ngModule=l,this.componentType=r.type,this.selector=function it(n){return n.map(ke).join(",")}(r.selectors),this.ngContentSelectors=r.ngContentSelectors?r.ngContentSelectors:[],this.isBoundToModule=!!l}create(r,l,h,g){let T=(g=g||this.ngModule)instanceof Tc?g:g?.injector;T&&null!==this.componentDef.getStandaloneInjector&&(T=this.componentDef.getStandaloneInjector(T)||T);const M=T?new hy(r,T):r,F=M.get(Xd,null);if(null===F)throw new ae(407,!1);const Pe={rendererFactory:F,sanitizer:M.get(ip,null),effectManager:M.get(ec,null)},ft=F.createRenderer(null,this.componentDef),Ht=this.componentDef.selectors[0][0]||"div",rn=h?function Wf(n,r,l,h){const T=h.get(kf,!1)||l===tn.ShadowDom,M=n.selectRootElement(r,T);return function Q_(n){qf(n)}(M),M}(ft,h,this.componentDef.encapsulation,M):Mu(ft,Ht,function Rg(n){const r=n.toLowerCase();return"svg"===r?"svg":"math"===r?"math":null}(Ht)),bi=this.componentDef.signals?4608:this.componentDef.onPush?576:528,Hi=hp(0,null,null,1,0,null,null,null,null,null,null),qn=ed(null,Hi,null,bi,null,null,Pe,ft,M,null,null);let yo,Ho;Wc(qn);try{const Xo=this.componentDef;let Da,s_=null;Xo.findHostDirectiveDefs?(Da=[],s_=new Map,Xo.findHostDirectiveDefs(Xo,Da,s_),Da.push(Xo)):Da=[Xo];const kC=function ad(n,r){const l=n[mi],h=Qi;return n[h]=r,td(l,h,2,"#host",null)}(qn,rn),FC=function im(n,r,l,h,g,T,M){const F=g[mi];!function om(n,r,l,h){for(const g of n)r.mergedAttrs=Pi(r.mergedAttrs,g.hostAttrs);null!==r.mergedAttrs&&(ul(r,r.mergedAttrs,!0),null!==l&&hf(h,l,r))}(h,n,r,M);let V=null;null!==r&&(V=sg(r,g[Ur]));const oe=T.rendererFactory.createRenderer(r,l);let Pe=16;l.signals?Pe=4096:l.onPush&&(Pe=64);const ft=ed(g,Gf(l),null,Pe,g[n.index],n,T,oe,null,null,V);return F.firstCreatePass&&Jf(F,n,h.length-1),ah(g,ft),g[n.index]=ft}(kC,rn,Xo,Da,qn,Pe,ft);Ho=Co(Hi,Qi),rn&&function rm(n,r,l,h){if(h)Go(n,l,["ng-version",q_.full]);else{const{attrs:g,classes:T}=function Bt(n){const r=[],l=[];let h=1,g=2;for(;h<n.length;){let T=n[h];if("string"==typeof T)2===g?""!==T&&r.push(T,n[++h]):8===g&&l.push(T);else{if(!xo(g))break;g=T}h++}return{attrs:r,classes:l}}(r.selectors[0]);g&&Go(n,l,g),T&&T.length>0&&Rh(n,l,T.join(" "))}}(ft,Xo,rn,h),void 0!==l&&function sm(n,r,l){const h=n.projection=[];for(let g=0;g<r.length;g++){const T=l[g];h.push(null!=T?Array.from(T):null)}}(Ho,this.ngContentSelectors,l),yo=function Pl(n,r,l,h,g,T){const M=jr(),F=g[mi],V=Dn(M,g);yg(F,g,M,l,null,h);for(let Pe=0;Pe<l.length;Pe++)Us(jn(g,F,M.directiveStart+Pe,M),g);Yf(F,g,M),V&&Us(V,g);const oe=jn(g,F,M.directiveStart+M.componentOffset,M);if(n[Oo]=g[Oo]=oe,null!==T)for(const Pe of T)Pe(oe,r);return Hf(F,M,n),oe}(FC,Xo,Da,s_,qn,[dl]),vp(Hi,qn,null)}finally{Ns()}return new bp(this.componentType,yo,Hu(Ho,qn),qn,Ho)}}class bp extends $u{constructor(r,l,h,g,T){super(),this.location=h,this._rootLView=g,this._tNode=T,this.previousInputValues=null,this.instance=l,this.hostView=this.changeDetectorRef=new Og(g),this.componentType=r}setInput(r,l){const h=this._tNode.inputs;let g;if(null!==h&&(g=h[r])){if(this.previousInputValues??=new Map,this.previousInputValues.has(r)&&Object.is(this.previousInputValues.get(r),l))return;const T=this._rootLView;Qf(T[mi],T,g,r,l),this.previousInputValues.set(r,l),Qd(Ki(this._tNode.index,T))}}get injector(){return new $i(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(r){this.hostView.onDestroy(r)}}function dl(){const n=jr();Be(Gn()[mi],n)}function wp(n){let r=function Ac(n){return Object.getPrototypeOf(n.prototype).constructor}(n.type),l=!0;const h=[n];for(;r;){let g;if(pr(n))g=r.\u0275cmp||r.\u0275dir;else{if(r.\u0275cmp)throw new ae(903,!1);g=r.\u0275dir}if(g){if(l){h.push(g);const M=n;M.inputs=Sc(n.inputs),M.inputTransforms=Sc(n.inputTransforms),M.declaredInputs=Sc(n.declaredInputs),M.outputs=Sc(n.outputs);const F=g.hostBindings;F&&Fg(n,F);const V=g.viewQuery,oe=g.contentQueries;if(V&&Tp(n,V),oe&&kg(n,oe),we(n.inputs,g.inputs),we(n.declaredInputs,g.declaredInputs),we(n.outputs,g.outputs),null!==g.inputTransforms&&(null===M.inputTransforms&&(M.inputTransforms={}),we(M.inputTransforms,g.inputTransforms)),pr(g)&&g.data.animation){const Pe=n.data;Pe.animation=(Pe.animation||[]).concat(g.data.animation)}}const T=g.features;if(T)for(let M=0;M<T.length;M++){const F=T[M];F&&F.ngInherit&&F(n),F===wp&&(l=!1)}}r=Object.getPrototypeOf(r)}!function Lg(n){let r=0,l=null;for(let h=n.length-1;h>=0;h--){const g=n[h];g.hostVars=r+=g.hostVars,g.hostAttrs=Pi(g.hostAttrs,l=Pi(l,g.hostAttrs))}}(h)}function Sc(n){return n===xt?{}:n===Et?[]:n}function Tp(n,r){const l=n.viewQuery;n.viewQuery=l?(h,g)=>{r(h,g),l(h,g)}:r}function kg(n,r){const l=n.contentQueries;n.contentQueries=l?(h,g,T)=>{r(h,g,T),l(h,g,T)}:r}function Fg(n,r){const l=n.hostBindings;n.hostBindings=l?(h,g)=>{r(h,g),l(h,g)}:r}function Ep(n){const r=n.inputConfig,l={};for(const h in r)if(r.hasOwnProperty(h)){const g=r[h];Array.isArray(g)&&g[2]&&(l[h]=g[2])}n.inputTransforms=l}function uh(n){return!!Dp(n)&&(Array.isArray(n)||!(n instanceof Map)&&Symbol.iterator in n)}function Dp(n){return null!==n&&("function"==typeof n||"object"==typeof n)}function e(n,r,l){return n[r]=l}function a(n,r,l){return!Object.is(n[r],l)&&(n[r]=l,!0)}function u(n,r,l,h){const g=a(n,r,l);return a(n,r+1,h)||g}function b(n,r,l,h){const g=Gn();return a(g,Xa(),r)&&(Do(),Ra(_r(),g,n,r,l,h)),b}function D(n,r,l,h){return a(n,Xa(),l)?r+xe(l)+h:go}function z(n,r,l,h,g,T,M,F){const oe=function f(n,r,l,h,g){const T=u(n,r,l,h);return a(n,r+2,g)||T}(n,aa(),l,g,M);return rs(3),oe?r+xe(l)+h+xe(g)+T+xe(M)+F:go}function j(n,r,l,h,g,T,M,F,V,oe){const ft=function _(n,r,l,h,g,T){const M=u(n,r,l,h);return u(n,r+2,g,T)||M}(n,aa(),l,g,M,V);return rs(4),ft?r+xe(l)+h+xe(g)+T+xe(M)+F+xe(V)+oe:go}function as(n,r,l,h,g,T,M,F){const V=Gn(),oe=Do(),Pe=n+Qi,ft=oe.firstCreatePass?function Gr(n,r,l,h,g,T,M,F,V){const oe=r.consts,Pe=td(r,n,4,M||null,Eo(oe,F));od(r,l,Pe,Eo(oe,V)),Be(r,Pe);const ft=Pe.tView=hp(2,Pe,h,g,T,r.directiveRegistry,r.pipeRegistry,null,r.schemas,oe,null);return null!==r.queries&&(r.queries.template(r,Pe),ft.queries=r.queries.embeddedTView(Pe)),Pe}(Pe,oe,V,r,l,h,g,T,M):oe.data[Pe];ks(ft,!1);const Ht=ns(oe,V,ft,n);A()&&Pd(oe,V,Ht,ft),Us(Ht,V),ah(V,V[Pe]=Tg(Ht,V,Ht,ft)),Cs(ft)&&cu(oe,V,ft),null!=M&&Al(V,ft,F)}let ns=function $s(n,r,l,h){return U(!0),r[Ri].createComment("")};function cd(n){return _o(function Vc(){return Ni.lFrame.contextLView}(),Qi+n)}function du(n,r,l){const h=Gn();return a(h,Xa(),r)&&Xs(Do(),_r(),h,n,r,h[Ri],l,!1),du}function Mp(n,r,l,h,g){const M=g?"class":"style";Qf(n,l,r.inputs[M],M,h)}function hh(n,r,l,h){const g=Gn(),T=Do(),M=Qi+n,F=g[Ri],V=T.firstCreatePass?function jg(n,r,l,h,g,T){const M=r.consts,V=td(r,n,2,h,Eo(M,g));return od(r,l,V,Eo(M,T)),null!==V.attrs&&ul(V,V.attrs,!1),null!==V.mergedAttrs&&ul(V,V.mergedAttrs,!0),null!==r.queries&&r.queries.elementStart(r,V),V}(M,T,g,r,l,h):T.data[M],oe=Ip(T,g,V,F,r,n);g[M]=oe;const Pe=Cs(V);return ks(V,!0),hf(F,oe,V),32!=(32&V.flags)&&A()&&Pd(T,g,oe,V),0===function ui(){return Ni.lFrame.elementDepthCount}()&&Us(oe,g),function sa(){Ni.lFrame.elementDepthCount++}(),Pe&&(cu(T,g,V),Hf(T,V,g)),null!==h&&Al(g,V),hh}function ph(){let n=jr();Fs()?jl():(n=n.parent,ks(n,!1));const r=n;(function qo(n){return Ni.skipHydrationRootTNode===n})(r)&&function dc(){Ni.skipHydrationRootTNode=null}(),function gu(){Ni.lFrame.elementDepthCount--}();const l=Do();return l.firstCreatePass&&(Be(l,n),Gs(n)&&l.queries.elementEnd(n)),null!=r.classesWithoutHost&&function I(n){return 0!=(8&n.flags)}(r)&&Mp(l,r,Gn(),r.classesWithoutHost,!0),null!=r.stylesWithoutHost&&function O(n){return 0!=(16&n.flags)}(r)&&Mp(l,r,Gn(),r.stylesWithoutHost,!1),ph}function fh(n,r,l,h){return hh(n,r,l,h),ph(),fh}let Ip=(n,r,l,h,g,T)=>(U(!0),Mu(h,g,function L(){return Ni.lFrame.currentNamespace}()));function ud(n,r,l){const h=Gn(),g=Do(),T=n+Qi,M=g.firstCreatePass?function hu(n,r,l,h,g){const T=r.consts,M=Eo(T,h),F=td(r,n,8,"ng-container",M);return null!==M&&ul(F,M,!0),od(r,l,F,Eo(T,g)),null!==r.queries&&r.queries.elementStart(r,F),F}(T,g,h,r,l):g.data[T];ks(M,!0);const F=Ap(g,h,M,n);return h[T]=F,A()&&Pd(g,h,F,M),Us(F,h),Cs(M)&&(cu(g,h,M),Hf(g,M,h)),null!=l&&Al(h,M),ud}function dd(){let n=jr();const r=Do();return Fs()?jl():(n=n.parent,ks(n,!1)),r.firstCreatePass&&(Be(r,n),Gs(n)&&r.queries.elementEnd(n)),dd}function Rl(n,r,l){return ud(n,r,l),dd(),Rl}let Ap=(n,r,l,h)=>(U(!0),nu(r[Ri],""));function ca(){return Gn()}function pu(n){return!!n&&"function"==typeof n.then}function Sp(n){return!!n&&"function"==typeof n.subscribe}function Pp(n,r,l,h){const g=Gn(),T=Do(),M=jr();return function Mv(n,r,l,h,g,T,M){const F=Cs(h),oe=n.firstCreatePass&&Eg(n),Pe=r[Oo],ft=Cg(r);let Ht=!0;if(3&h.type||M){const ii=Dn(h,r),bi=M?M(ii):ii,Hi=ft.length,qn=M?Ho=>M(be(Ho[h.index])):h.index;let yo=null;if(!M&&F&&(yo=function R1(n,r,l,h){const g=n.cleanup;if(null!=g)for(let T=0;T<g.length-1;T+=2){const M=g[T];if(M===l&&g[T+1]===h){const F=r[Jo],V=g[T+2];return F.length>V?F[V]:null}"string"==typeof M&&(T+=2)}return null}(n,r,g,h.index)),null!==yo)(yo.__ngLastListenerFn__||yo).__ngNextListenerFn__=T,yo.__ngLastListenerFn__=T,Ht=!1;else{T=Av(h,r,Pe,T,!1);const Ho=l.listen(bi,g,T);ft.push(T,Ho),oe&&oe.push(g,qn,Hi,Hi+1)}}else T=Av(h,r,Pe,T,!1);const rn=h.outputs;let Zn;if(Ht&&null!==rn&&(Zn=rn[g])){const ii=Zn.length;if(ii)for(let bi=0;bi<ii;bi+=2){const Xo=r[Zn[bi]][Zn[bi+1]].subscribe(T),Da=ft.length;ft.push(T,Xo),oe&&oe.push(g,h.index,Da,-(Da+1))}}}(T,g,g[Ri],M,n,r,h),Pp}function Iv(n,r,l,h){try{return Z(6,r,l),!1!==l(h)}catch(g){return yp(n,g),!1}finally{Z(7,r,l)}}function Av(n,r,l,h,g){return function T(M){if(M===Function)return h;Qd(n.componentOffset>-1?Ki(n.index,r):r);let V=Iv(r,l,h,M),oe=T.__ngNextListenerFn__;for(;oe;)V=Iv(r,l,oe,M)&&V,oe=oe.__ngNextListenerFn__;return g&&!1===V&&M.preventDefault(),V}}function Sv(n=1){return function _a(n){return(Ni.lFrame.contextLView=function za(n,r){for(;n>0;)r=r[Xr],n--;return r}(n,Ni.lFrame.contextLView))[Oo]}(n)}function L1(n,r){let l=null;const h=function kr(n){const r=n.attrs;if(null!=r){const l=r.indexOf(5);if(!(1&l))return r[l+1]}return null}(n);for(let g=0;g<r.length;g++){const T=r[g];if("*"!==T){if(null===h?Mr(n,T,!0):_e(h,T))return g}else l=g}return l}function Pv(n){const r=Gn()[ko][jo];if(!r.projection){const h=r.projection=vd(n?n.length:1,null),g=h.slice();let T=r.child;for(;null!==T;){const M=n?L1(T,n):0;null!==M&&(g[M]?g[M].projectionNext=T:h[M]=T,g[M]=T),T=T.next}}}function Ov(n,r=0,l){const h=Gn(),g=Do(),T=td(g,Qi+n,16,null,l||null);null===T.projection&&(T.projection=r),jl(),(!h[Ar]||ga())&&32!=(32&T.flags)&&function w_(n,r,l){uf(r[Ri],0,r,l,$a(n,l,r),Sh(l.parent||r[jo],l,r))}(g,h,T)}function gy(n,r,l){return _y(n,"",r,"",l),gy}function _y(n,r,l,h,g){const T=Gn(),M=D(T,r,l,h);return M!==go&&Xs(Do(),_r(),T,n,M,T[Ri],g,!1),_y}function Hg(n,r){return n<<17|r<<2}function hd(n){return n>>17&32767}function yy(n){return 2|n}function mh(n){return(131068&n)>>2}function vy(n,r){return-131069&n|r<<2}function xy(n){return 1|n}function Zv(n,r,l,h,g){const T=n[l+1],M=null===r;let F=h?hd(T):mh(T),V=!1;for(;0!==F&&(!1===V||M);){const Pe=n[F+1];U1(n[F],r)&&(V=!0,n[F+1]=h?xy(Pe):yy(Pe)),F=h?hd(Pe):mh(Pe)}V&&(n[l+1]=h?yy(T):xy(T))}function U1(n,r){return null===n||null==r||(Array.isArray(n)?n[1]:n)===r||!(!Array.isArray(n)||"string"!=typeof r)&&Wl(n,r)>=0}function by(n,r,l){return nc(n,r,l,!1),by}function wy(n,r){return nc(n,r,null,!0),wy}function nc(n,r,l,h){const g=Gn(),T=Do(),M=rs(2);T.firstUpdatePass&&function Yv(n,r,l,h){const g=n.data;if(null===g[l+1]){const T=g[qr()],M=function qv(n,r){return r>=n.expandoStartIndex}(n,l);(function Qv(n,r){return 0!=(n.flags&(r?8:16))})(T,h)&&null===r&&!M&&(r=!1),r=function Y1(n,r,l,h){const g=function $c(n){const r=Ni.lFrame.currentDirectiveIndex;return-1===r?null:n[r]}(n);let T=h?r.residualClasses:r.residualStyles;if(null===g)0===(h?r.classBindings:r.styleBindings)&&(l=cm(l=Ty(null,n,r,l,h),r.attrs,h),T=null);else{const M=r.directiveStylingLast;if(-1===M||n[M]!==g)if(l=Ty(g,n,r,l,h),null===T){let V=function J1(n,r,l){const h=l?r.classBindings:r.styleBindings;if(0!==mh(h))return n[hd(h)]}(n,r,h);void 0!==V&&Array.isArray(V)&&(V=Ty(null,n,r,V[1],h),V=cm(V,r.attrs,h),function K1(n,r,l,h){n[hd(l?r.classBindings:r.styleBindings)]=h}(n,r,h,V))}else T=function X1(n,r,l){let h;const g=r.directiveEnd;for(let T=1+r.directiveStylingLast;T<g;T++)h=cm(h,n[T].hostAttrs,l);return cm(h,r.attrs,l)}(n,r,h)}return void 0!==T&&(h?r.residualClasses=T:r.residualStyles=T),l}(g,T,r,h),function N1(n,r,l,h,g,T){let M=T?r.classBindings:r.styleBindings,F=hd(M),V=mh(M);n[h]=l;let Pe,oe=!1;if(Array.isArray(l)?(Pe=l[1],(null===Pe||Wl(l,Pe)>0)&&(oe=!0)):Pe=l,g)if(0!==V){const Ht=hd(n[F+1]);n[h+1]=Hg(Ht,F),0!==Ht&&(n[Ht+1]=vy(n[Ht+1],h)),n[F+1]=function F1(n,r){return 131071&n|r<<17}(n[F+1],h)}else n[h+1]=Hg(F,0),0!==F&&(n[F+1]=vy(n[F+1],h)),F=h;else n[h+1]=Hg(V,0),0===F?F=h:n[V+1]=vy(n[V+1],h),V=h;oe&&(n[h+1]=yy(n[h+1])),Zv(n,Pe,h,!0),Zv(n,Pe,h,!1),function z1(n,r,l,h,g){const T=g?n.residualClasses:n.residualStyles;null!=T&&"string"==typeof r&&Wl(T,r)>=0&&(l[h+1]=xy(l[h+1]))}(r,Pe,n,h,T),M=Hg(F,V),T?r.classBindings=M:r.styleBindings=M}(g,T,r,l,M,h)}}(T,n,M,h),r!==go&&a(g,M,r)&&function Kv(n,r,l,h,g,T,M,F){if(!(3&r.type))return;const V=n.data,oe=V[F+1],Pe=function B1(n){return 1==(1&n)}(oe)?Xv(V,r,l,g,mh(oe),M):void 0;Gg(Pe)||(Gg(T)||function k1(n){return 2==(2&n)}(oe)&&(T=Xv(V,null,l,g,F,M)),function df(n,r,l,h,g){if(r)g?n.addClass(l,h):n.removeClass(l,h);else{let T=-1===h.indexOf("-")?void 0:sl.DashCase;null==g?n.removeStyle(l,h,T):("string"==typeof g&&g.endsWith("!important")&&(g=g.slice(0,-10),T|=sl.Important),n.setStyle(l,h,g,T))}}(h,M,vn(qr(),l),g,T))}(T,T.data[qr()],g,g[Ri],n,g[M+1]=function nb(n,r){return null==n||""===n||("string"==typeof r?n+=r:"object"==typeof n&&(n=Le(vc(n)))),n}(r,l),h,M)}function Ty(n,r,l,h,g){let T=null;const M=l.directiveEnd;let F=l.directiveStylingLast;for(-1===F?F=l.directiveStart:F++;F<M&&(T=r[F],h=cm(h,T.hostAttrs,g),T!==n);)F++;return null!==n&&(l.directiveStylingLast=F),h}function cm(n,r,l){const h=l?1:2;let g=-1;if(null!==r)for(let T=0;T<r.length;T++){const M=r[T];"number"==typeof M?g=M:g===h&&(Array.isArray(n)||(n=void 0===n?[]:["",n]),Js(n,M,!!l||r[++T]))}return void 0===n?null:n}function Xv(n,r,l,h,g,T){const M=null===r;let F;for(;g>0;){const V=n[g],oe=Array.isArray(V),Pe=oe?V[1]:V,ft=null===Pe;let Ht=l[g+1];Ht===go&&(Ht=ft?Et:void 0);let rn=ft?el(Ht,h):Pe===h?Ht:void 0;if(oe&&!Gg(rn)&&(rn=el(V,h)),Gg(rn)&&(F=rn,M))return F;const Zn=n[g+1];g=M?hd(Zn):mh(Zn)}if(null!==r){let V=T?r.residualClasses:r.residualStyles;null!=V&&(F=el(V,h))}return F}function Gg(n){return void 0!==n}function e0(n,r=""){const l=Gn(),h=Do(),g=n+Qi,T=h.firstCreatePass?td(h,g,1,r,null):h.data[g],M=t0(h,l,T,r,n);l[g]=M,A()&&Pd(h,l,M,T),ks(T,!1)}let t0=(n,r,l,h,g)=>(U(!0),function tu(n,r){return n.createText(r)}(r[Ri],h));function Cy(n){return Wg("",n,""),Cy}function Wg(n,r,l){const h=Gn(),g=D(h,n,r,l);return g!==go&&La(h,qr(),g),Wg}function Ey(n,r,l,h,g){const T=Gn(),M=function k(n,r,l,h,g,T){const F=u(n,aa(),l,g);return rs(2),F?r+xe(l)+h+xe(g)+T:go}(T,n,r,l,h,g);return M!==go&&La(T,qr(),M),Ey}function Dy(n,r,l,h,g,T,M){const F=Gn(),V=z(F,n,r,l,h,g,T,M);return V!==go&&La(F,qr(),V),Dy}function My(n,r,l,h,g,T,M,F,V){const oe=Gn(),Pe=j(oe,n,r,l,h,g,T,M,F,V);return Pe!==go&&La(oe,qr(),Pe),My}const gh=void 0;var Cb=["en",[["a","p"],["AM","PM"],gh],[["AM","PM"],gh,gh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],gh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],gh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",gh,"{1} 'at' {0}",gh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function Tb(n){const l=Math.floor(Math.abs(n)),h=n.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===h?1:5}];let Rp={};function Iy(n){const r=function Eb(n){return n.toLowerCase().replace(/_/g,"-")}(n);let l=x0(r);if(l)return l;const h=r.split("-")[0];if(l=x0(h),l)return l;if("en"===h)return Cb;throw new ae(701,!1)}function v0(n){return Iy(n)[ro.PluralCase]}function x0(n){return n in Rp||(Rp[n]=fi.ng&&fi.ng.common&&fi.ng.common.locales&&fi.ng.common.locales[n]),Rp[n]}var ro=(()=>((ro=ro||{})[ro.LocaleId=0]="LocaleId",ro[ro.DayPeriodsFormat=1]="DayPeriodsFormat",ro[ro.DayPeriodsStandalone=2]="DayPeriodsStandalone",ro[ro.DaysFormat=3]="DaysFormat",ro[ro.DaysStandalone=4]="DaysStandalone",ro[ro.MonthsFormat=5]="MonthsFormat",ro[ro.MonthsStandalone=6]="MonthsStandalone",ro[ro.Eras=7]="Eras",ro[ro.FirstDayOfWeek=8]="FirstDayOfWeek",ro[ro.WeekendRange=9]="WeekendRange",ro[ro.DateFormat=10]="DateFormat",ro[ro.TimeFormat=11]="TimeFormat",ro[ro.DateTimeFormat=12]="DateTimeFormat",ro[ro.NumberSymbols=13]="NumberSymbols",ro[ro.NumberFormats=14]="NumberFormats",ro[ro.CurrencyCode=15]="CurrencyCode",ro[ro.CurrencySymbol=16]="CurrencySymbol",ro[ro.CurrencyName=17]="CurrencyName",ro[ro.Currencies=18]="Currencies",ro[ro.Directionality=19]="Directionality",ro[ro.PluralCase=20]="PluralCase",ro[ro.ExtraData=21]="ExtraData",ro))();const Lp="en-US";let b0=Lp;function Py(n,r,l,h,g){if(n=Oe(n),Array.isArray(n))for(let T=0;T<n.length;T++)Py(n[T],r,l,h,g);else{const T=Do(),M=Gn();let F=ll(n)?n:Oe(n.provide),V=ng(n);const oe=jr(),Pe=1048575&oe.providerIndexes,ft=oe.directiveStart,Ht=oe.providerIndexes>>20;if(ll(n)||!n.multi){const rn=new o(V,g,Xu),Zn=Ry(F,r,g?Pe:Pe+Ht,ft);-1===Zn?(an(Lt(oe,M),T,F),Oy(T,n,r.length),r.push(F),oe.directiveStart++,oe.directiveEnd++,g&&(oe.providerIndexes+=1048576),l.push(rn),M.push(rn)):(l[Zn]=rn,M[Zn]=rn)}else{const rn=Ry(F,r,Pe+Ht,ft),Zn=Ry(F,r,Pe,Pe+Ht),bi=Zn>=0&&l[Zn];if(g&&!bi||!g&&!(rn>=0&&l[rn])){an(Lt(oe,M),T,F);const Hi=function ww(n,r,l,h,g){const T=new o(n,l,Xu);return T.multi=[],T.index=r,T.componentProviders=0,G0(T,g,h&&!l),T}(g?bw:xw,l.length,g,h,V);!g&&bi&&(l[Zn].providerFactory=Hi),Oy(T,n,r.length,0),r.push(F),oe.directiveStart++,oe.directiveEnd++,g&&(oe.providerIndexes+=1048576),l.push(Hi),M.push(Hi)}else Oy(T,n,rn>-1?rn:Zn,G0(l[g?Zn:rn],V,!g&&h));!g&&h&&bi&&l[Zn].componentProviders++}}}function Oy(n,r,l,h){const g=ll(r),T=function Hd(n){return!!n.useClass}(r);if(g||T){const V=(T?Oe(r.useClass):r).prototype.ngOnDestroy;if(V){const oe=n.destroyHooks||(n.destroyHooks=[]);if(!g&&r.multi){const Pe=oe.indexOf(l);-1===Pe?oe.push(l,[h,V]):oe[Pe+1].push(h,V)}else oe.push(l,V)}}}function G0(n,r,l){return l&&n.componentProviders++,n.multi.push(r)-1}function Ry(n,r,l,h){for(let g=l;g<h;g++)if(r[g]===n)return g;return-1}function xw(n,r,l,h){return Ly(this.multi,[])}function bw(n,r,l,h){const g=this.multi;let T;if(this.providerFactory){const M=this.providerFactory.componentProviders,F=jn(l,l[mi],this.providerFactory.index,h);T=F.slice(0,M),Ly(g,T);for(let V=M;V<F.length;V++)T.push(F[V])}else T=[],Ly(g,T);return T}function Ly(n,r){for(let l=0;l<n.length;l++)r.push((0,n[l])());return r}function W0(n,r=[]){return l=>{l.providersResolver=(h,g)=>function vw(n,r,l){const h=Do();if(h.firstCreatePass){const g=pr(n);Py(l,h.data,h.blueprint,g,!0),Py(r,h.data,h.blueprint,g,!1)}}(h,g?g(n):n,r)}}class kp{}class q0{}function Tw(n,r){return new ky(n,r??null,[])}class ky extends kp{constructor(r,l,h){super(),this._parent=l,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new nm(this);const g=Wo(r);this._bootstrapComponents=Ml(g.bootstrap),this._r3Injector=_g(r,l,[{provide:kp,useValue:this},{provide:np,useValue:this.componentFactoryResolver},...h],Le(r),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(r)}get injector(){return this._r3Injector}destroy(){const r=this._r3Injector;!r.destroyed&&r.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(r){this.destroyCbs.push(r)}}class Fy extends q0{constructor(r){super(),this.moduleType=r}create(r){return new ky(this.moduleType,r,[])}}class Y0 extends kp{constructor(r){super(),this.componentFactoryResolver=new nm(this),this.instance=null;const l=new jh([...r.providers,{provide:kp,useValue:this},{provide:np,useValue:this.componentFactoryResolver}],r.parent||Gd(),r.debugName,new Set(["environment"]));this.injector=l,r.runEnvironmentInitializers&&l.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(r){this.injector.onDestroy(r)}}function J0(n,r,l=null){return new Y0({providers:n,parent:r,debugName:l,runEnvironmentInitializers:!0}).injector}let Ew=(()=>{class n{constructor(l){this._injector=l,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(l){if(!l.standalone)return null;if(!this.cachedInjectors.has(l.id)){const h=Ef(0,l.type),g=h.length>0?J0([h],this._injector,`Standalone[${l.type.name}]`):null;this.cachedInjectors.set(l.id,g)}return this.cachedInjectors.get(l.id)}ngOnDestroy(){try{for(const l of this.cachedInjectors.values())null!==l&&l.destroy()}finally{this.cachedInjectors.clear()}}}return n.\u0275prov=Sn({token:n,providedIn:"environment",factory:()=>new n(Y(Tc))}),n})();function K0(n){n.getStandaloneInjector=r=>r.get(Ew).getOrCreateStandaloneInjector(n)}function ox(n,r,l){const h=Wr()+n,g=Gn();return g[h]===go?e(g,h,l?r.call(l):r()):function i(n,r){return n[r]}(g,h)}function mm(n,r){const l=n[r];return l===go?void 0:l}function ux(n,r){const l=Do();let h;const g=n+Qi;l.firstCreatePass?(h=function jw(n,r){if(r)for(let l=r.length-1;l>=0;l--){const h=r[l];if(n===h.name)return h}}(r,l.pipeRegistry),l.data[g]=h,h.onDestroy&&(l.destroyHooks??=[]).push(g,h.onDestroy)):h=l.data[g];const T=h.factory||(h.factory=ua(h.type)),M=Ci(Xu);try{const F=Ye(!1),V=T();return Ye(F),function ld(n,r,l,h){l>=n.data.length&&(n.data[l]=null,n.blueprint[l]=null),r[l]=h}(l,Gn(),g,V),V}finally{Ci(M)}}function dx(n,r,l){const h=n+Qi,g=Gn(),T=_o(g,h);return gm(g,h)?function rx(n,r,l,h,g,T){const M=r+l;return a(n,M,g)?e(n,M+1,T?h.call(T,g):h(g)):mm(n,M+1)}(g,Wr(),r,T.transform,l,T):T.transform(l)}function hx(n,r,l,h){const g=n+Qi,T=Gn(),M=_o(T,g);return gm(T,g)?function sx(n,r,l,h,g,T,M){const F=r+l;return u(n,F,g,T)?e(n,F+2,M?h.call(M,g,T):h(g,T)):mm(n,F+2)}(T,Wr(),r,M.transform,l,h,M):M.transform(l,h)}function gm(n,r){return n[mi].data[r].pure}function Ny(n){return r=>{setTimeout(n,void 0,r)}}const Lc=class Ww extends v.x{constructor(r=!1){super(),this.__isAsync=r}emit(r){super.next(r)}subscribe(r,l,h){let g=r,T=l||(()=>null),M=h;if(r&&"object"==typeof r){const V=r;g=V.next?.bind(V),T=V.error?.bind(V),M=V.complete?.bind(V)}this.__isAsync&&(T=Ny(T),g&&(g=Ny(g)),M&&(M=Ny(M)));const F=super.subscribe({next:g,error:T,complete:M});return r instanceof d.w0&&r.add(F),F}};function qw(){return this._results[Symbol.iterator]()}class zy{get changes(){return this._changes||(this._changes=new Lc)}constructor(r=!1){this._emitDistinctChangesOnly=r,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const l=zy.prototype;l[Symbol.iterator]||(l[Symbol.iterator]=qw)}get(r){return this._results[r]}map(r){return this._results.map(r)}filter(r){return this._results.filter(r)}find(r){return this._results.find(r)}reduce(r,l){return this._results.reduce(r,l)}forEach(r){this._results.forEach(r)}some(r){return this._results.some(r)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(r,l){const h=this;h.dirty=!1;const g=function Ms(n){return n.flat(Number.POSITIVE_INFINITY)}(r);(this._changesDetected=!function wu(n,r,l){if(n.length!==r.length)return!1;for(let h=0;h<n.length;h++){let g=n[h],T=r[h];if(l&&(g=l(g),T=l(T)),T!==g)return!1}return!0}(h._results,g,l))&&(h._results=g,h.length=g.length,h.last=g[this.length-1],h.first=g[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let _m=(()=>{class n{}return n.__NG_ELEMENT_ID__=Kw,n})();const Yw=_m,Jw=class extends Yw{constructor(r,l,h){super(),this._declarationLView=r,this._declarationTContainer=l,this.elementRef=h}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(r,l){return this.createEmbeddedViewImpl(r,l,null)}createEmbeddedViewImpl(r,l,h){const M=this._declarationTContainer.tView,F=ed(this._declarationLView,M,r,4096&this._declarationLView[Fi]?4096:16,null,M.declTNode,null,null,null,l||null,h||null);F[Ir]=this._declarationLView[this._declarationTContainer.index];const oe=this._declarationLView[Br];return null!==oe&&(F[Br]=oe.createEmbeddedView(M)),vp(M,F,r),new sd(F)}};function Kw(){return Xg(jr(),Gn())}function Xg(n,r){return 4&n.type?new Jw(r,n,Hu(n,r)):null}let Qg=(()=>{class n{}return n.__NG_ELEMENT_ID__=oT,n})();function oT(){return yx(jr(),Gn())}const rT=Qg,gx=class extends rT{constructor(r,l,h){super(),this._lContainer=r,this._hostTNode=l,this._hostLView=h}get element(){return Hu(this._hostTNode,this._hostLView)}get injector(){return new $i(this._hostTNode,this._hostLView)}get parentInjector(){const r=$t(this._hostTNode,this._hostLView);if($(r)){const l=$e(r,this._hostLView),h=ce(r);return new $i(l[mi].data[h+8],l)}return new $i(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(r){const l=_x(this._lContainer);return null!==l&&l[r]||null}get length(){return this._lContainer.length-wr}createEmbeddedView(r,l,h){let g,T;"number"==typeof h?g=h:null!=h&&(g=h.index,T=h.injector);const F=r.createEmbeddedViewImpl(l||{},T,null);return this.insertImpl(F,g,false),F}createComponent(r,l,h,g,T){const M=r&&!function Sa(n){return"function"==typeof n}(r);let F;if(M)F=l;else{const ii=l||{};F=ii.index,h=ii.injector,g=ii.projectableNodes,T=ii.environmentInjector||ii.ngModuleRef}const V=M?r:new ch(Xi(r)),oe=h||this.parentInjector;if(!T&&null==V.ngModule){const bi=(M?oe:this.parentInjector).get(Tc,null);bi&&(T=bi)}Xi(V.componentType??{});const rn=V.create(oe,g,null,T);return this.insertImpl(rn.hostView,F,false),rn}insert(r,l){return this.insertImpl(r,l,!1)}insertImpl(r,l,h){const g=r._lView,T=g[mi];if(function Ro(n){return Nr(n[Bi])}(g)){const V=this.indexOf(r);if(-1!==V)this.detach(V);else{const oe=g[Bi],Pe=new gx(oe,oe[jo],oe[Bi]);Pe.detach(Pe.indexOf(r))}}const M=this._adjustIndex(l),F=this._lContainer;if(function Rm(n,r,l,h){const g=wr+h,T=l.length;h>0&&(l[g-1][er]=r),h<T-wr?(r[er]=l[g],zp(l,wr+h,r)):(l.push(r),r[er]=null),r[Bi]=l;const M=r[Ir];null!==M&&l!==M&&function b_(n,r){const l=n[ia];r[ko]!==r[Bi][Bi][ko]&&(n[Ss]=!0),null===l?n[ia]=[r]:l.push(r)}(M,r);const F=r[Br];null!==F&&F.insertView(n),r[Fi]|=128}(T,g,F,M),!h){const V=Yl(M,F),oe=g[Ri],Pe=Sd(oe,F[Sr]);null!==Pe&&function Iu(n,r,l,h,g,T){h[bo]=g,h[jo]=r,Su(n,h,l,1,g,T)}(T,F[jo],oe,g,Pe,V)}return r.attachToViewContainerRef(),zp(Zy(F),M,r),r}move(r,l){return this.insert(r,l)}indexOf(r){const l=_x(this._lContainer);return null!==l?l.indexOf(r):-1}remove(r){const l=this._adjustIndex(r,-1),h=iu(this._lContainer,l);h&&(yd(Zy(this._lContainer),l),sf(h[mi],h))}detach(r){const l=this._adjustIndex(r,-1),h=iu(this._lContainer,l);return h&&null!=yd(Zy(this._lContainer),l)?new sd(h):null}_adjustIndex(r,l=0){return r??this.length+l}};function _x(n){return n[8]}function Zy(n){return n[8]||(n[8]=[])}function yx(n,r){let l;const h=r[n.index];return Nr(h)?l=h:(l=Tg(h,r,null,n),r[n.index]=l,ah(r,l)),vx(l,r,n,h),new gx(l,n,r)}let vx=function xx(n,r,l,h){if(n[Sr])return;let g;g=8&l.type?be(h):function sT(n,r){const l=n[Ri],h=l.createComment(""),g=Dn(r,n);return Zs(l,Sd(l,g),h,function Au(n,r){return n.nextSibling(r)}(l,g),!1),h}(r,l),n[Sr]=g};class Vy{constructor(r){this.queryList=r,this.matches=null}clone(){return new Vy(this.queryList)}setDirty(){this.queryList.setDirty()}}class jy{constructor(r=[]){this.queries=r}createEmbeddedView(r){const l=r.queries;if(null!==l){const h=null!==r.contentQueries?r.contentQueries[0]:l.length,g=[];for(let T=0;T<h;T++){const M=l.getByIndex(T);g.push(this.queries[M.indexInDeclarationView].clone())}return new jy(g)}return null}insertView(r){this.dirtyQueriesWithMatches(r)}detachView(r){this.dirtyQueriesWithMatches(r)}dirtyQueriesWithMatches(r){for(let l=0;l<this.queries.length;l++)null!==Ax(r,l).matches&&this.queries[l].setDirty()}}class bx{constructor(r,l,h=null){this.predicate=r,this.flags=l,this.read=h}}class $y{constructor(r=[]){this.queries=r}elementStart(r,l){for(let h=0;h<this.queries.length;h++)this.queries[h].elementStart(r,l)}elementEnd(r){for(let l=0;l<this.queries.length;l++)this.queries[l].elementEnd(r)}embeddedTView(r){let l=null;for(let h=0;h<this.length;h++){const g=null!==l?l.length:0,T=this.getByIndex(h).embeddedTView(r,g);T&&(T.indexInDeclarationView=h,null!==l?l.push(T):l=[T])}return null!==l?new $y(l):null}template(r,l){for(let h=0;h<this.queries.length;h++)this.queries[h].template(r,l)}getByIndex(r){return this.queries[r]}get length(){return this.queries.length}track(r){this.queries.push(r)}}class Hy{constructor(r,l=-1){this.metadata=r,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}elementStart(r,l){this.isApplyingToNode(l)&&this.matchTNode(r,l)}elementEnd(r){this._declarationNodeIndex===r.index&&(this._appliesToNextNode=!1)}template(r,l){this.elementStart(r,l)}embeddedTView(r,l){return this.isApplyingToNode(r)?(this.crossesNgTemplate=!0,this.addMatch(-r.index,l),new Hy(this.metadata)):null}isApplyingToNode(r){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const l=this._declarationNodeIndex;let h=r.parent;for(;null!==h&&8&h.type&&h.index!==l;)h=h.parent;return l===(null!==h?h.index:-1)}return this._appliesToNextNode}matchTNode(r,l){const h=this.metadata.predicate;if(Array.isArray(h))for(let g=0;g<h.length;g++){const T=h[g];this.matchTNodeWithReadOption(r,l,cT(l,T)),this.matchTNodeWithReadOption(r,l,Mn(l,r,T,!1,!1))}else h===_m?4&l.type&&this.matchTNodeWithReadOption(r,l,-1):this.matchTNodeWithReadOption(r,l,Mn(l,r,h,!1,!1))}matchTNodeWithReadOption(r,l,h){if(null!==h){const g=this.metadata.read;if(null!==g)if(g===Kd||g===Qg||g===_m&&4&l.type)this.addMatch(l.index,-2);else{const T=Mn(l,r,g,!1,!1);null!==T&&this.addMatch(l.index,T)}else this.addMatch(l.index,h)}}addMatch(r,l){null===this.matches?this.matches=[r,l]:this.matches.push(r,l)}}function cT(n,r){const l=n.localNames;if(null!==l)for(let h=0;h<l.length;h+=2)if(l[h]===r)return l[h+1];return null}function dT(n,r,l,h){return-1===l?function uT(n,r){return 11&n.type?Hu(n,r):4&n.type?Xg(n,r):null}(r,n):-2===l?function hT(n,r,l){return l===Kd?Hu(r,n):l===_m?Xg(r,n):l===Qg?yx(r,n):void 0}(n,r,h):jn(n,n[mi],l,r)}function wx(n,r,l,h){const g=r[Br].queries[h];if(null===g.matches){const T=n.data,M=l.matches,F=[];for(let V=0;V<M.length;V+=2){const oe=M[V];F.push(oe<0?null:dT(r,T[oe],M[V+1],l.metadata.read))}g.matches=F}return g.matches}function Gy(n,r,l,h){const g=n.queries.getByIndex(l),T=g.matches;if(null!==T){const M=wx(n,r,g,l);for(let F=0;F<T.length;F+=2){const V=T[F];if(V>0)h.push(M[F/2]);else{const oe=T[F+1],Pe=r[-V];for(let ft=wr;ft<Pe.length;ft++){const Ht=Pe[ft];Ht[Ir]===Ht[Bi]&&Gy(Ht[mi],Ht,oe,h)}if(null!==Pe[ia]){const ft=Pe[ia];for(let Ht=0;Ht<ft.length;Ht++){const rn=ft[Ht];Gy(rn[mi],rn,oe,h)}}}}}return h}function Tx(n){const r=Gn(),l=Do(),h=Hc();es(h+1);const g=Ax(l,h);if(n.dirty&&function lo(n){return 4==(4&n[Fi])}(r)===(2==(2&g.metadata.flags))){if(null===g.matches)n.reset([]);else{const T=g.crossesNgTemplate?Gy(l,r,h,[]):wx(l,r,g,h);n.reset(T,W_),n.notifyOnChanges()}return!0}return!1}function Cx(n,r,l){const h=Do();h.firstCreatePass&&(Ix(h,new bx(n,r,l),-1),2==(2&r)&&(h.staticViewQueries=!0)),Mx(h,Gn(),r)}function Ex(n,r,l,h){const g=Do();if(g.firstCreatePass){const T=jr();Ix(g,new bx(r,l,h),T.index),function fT(n,r){const l=n.contentQueries||(n.contentQueries=[]);r!==(l.length?l[l.length-1]:-1)&&l.push(n.queries.length-1,r)}(g,n),2==(2&l)&&(g.staticContentQueries=!0)}Mx(g,Gn(),l)}function Dx(){return function pT(n,r){return n[Br].queries[r].queryList}(Gn(),Hc())}function Mx(n,r,l){const h=new zy(4==(4&l));(function Dc(n,r,l,h){const g=Cg(r);g.push(l),n.firstCreatePass&&Eg(n).push(h,g.length-1)})(n,r,h,h.destroy),null===r[Br]&&(r[Br]=new jy),r[Br].queries.push(new Vy(h))}function Ix(n,r,l){null===n.queries&&(n.queries=new $y),n.queries.track(new Hy(r,l))}function Ax(n,r){return n.queries.getByIndex(r)}function Wy(n){return!!Wo(n)}const Gx=new lr("Application Initializer");let Xy=(()=>{class n{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((l,h)=>{this.resolve=l,this.reject=h}),this.appInits=We(Gx,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const l=[];for(const g of this.appInits){const T=g();if(pu(T))l.push(T);else if(Sp(T)){const M=new Promise((F,V)=>{T.subscribe({complete:F,error:V})});l.push(M)}}const h=()=>{this.done=!0,this.resolve()};Promise.all(l).then(()=>{h()}).catch(g=>{this.reject(g)}),0===l.length&&h(),this.initialized=!0}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),Wx=(()=>{class n{log(l){console.log(l)}warn(l){console.warn(l)}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();const t_=new lr("LocaleId",{providedIn:"root",factory:()=>We(t_,Yt.Optional|Yt.SkipSelf)||function FT(){return typeof $localize<"u"&&$localize.locale||Lp}()}),BT=new lr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});let qx=(()=>{class n{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new y.X(!1)}add(){this.hasPendingTasks.next(!0);const l=this.taskId++;return this.pendingTasks.add(l),l}remove(l){this.pendingTasks.delete(l),0===this.pendingTasks.size&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this.hasPendingTasks.next(!1)}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();class NT{constructor(r,l){this.ngModuleFactory=r,this.componentFactories=l}}let zT=(()=>{class n{compileModuleSync(l){return new Fy(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const h=this.compileModuleSync(l),T=Ml(Wo(l).declarations).reduce((M,F)=>{const V=Xi(F);return V&&M.push(new ch(V)),M},[]);return new NT(h,T)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function Kx(...n){}class Fa{constructor({enableLongStackTrace:r=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:h=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Lc(!1),this.onMicrotaskEmpty=new Lc(!1),this.onStable=new Lc(!1),this.onError=new Lc(!1),typeof Zone>"u")throw new ae(908,!1);Zone.assertZonePatched();const g=this;g._nesting=0,g._outer=g._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(g._inner=g._inner.fork(new Zone.TaskTrackingZoneSpec)),r&&Zone.longStackTraceZoneSpec&&(g._inner=g._inner.fork(Zone.longStackTraceZoneSpec)),g.shouldCoalesceEventChangeDetection=!h&&l,g.shouldCoalesceRunChangeDetection=h,g.lastRequestAnimationFrameId=-1,g.nativeRequestAnimationFrame=function VT(){let n=fi.requestAnimationFrame,r=fi.cancelAnimationFrame;if(typeof Zone<"u"&&n&&r){const l=n[Zone.__symbol__("OriginalDelegate")];l&&(n=l);const h=r[Zone.__symbol__("OriginalDelegate")];h&&(r=h)}return{nativeRequestAnimationFrame:n,nativeCancelAnimationFrame:r}}().nativeRequestAnimationFrame,function HT(n){const r=()=>{!function $T(n){n.isCheckStableRunning||-1!==n.lastRequestAnimationFrameId||(n.lastRequestAnimationFrameId=n.nativeRequestAnimationFrame.call(fi,()=>{n.fakeTopEventTask||(n.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{n.lastRequestAnimationFrameId=-1,ev(n),n.isCheckStableRunning=!0,Qy(n),n.isCheckStableRunning=!1},void 0,()=>{},()=>{})),n.fakeTopEventTask.invoke()}),ev(n))}(n)};n._inner=n._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,h,g,T,M,F)=>{try{return Xx(n),l.invokeTask(g,T,M,F)}finally{(n.shouldCoalesceEventChangeDetection&&"eventTask"===T.type||n.shouldCoalesceRunChangeDetection)&&r(),Qx(n)}},onInvoke:(l,h,g,T,M,F,V)=>{try{return Xx(n),l.invoke(g,T,M,F,V)}finally{n.shouldCoalesceRunChangeDetection&&r(),Qx(n)}},onHasTask:(l,h,g,T)=>{l.hasTask(g,T),h===g&&("microTask"==T.change?(n._hasPendingMicrotasks=T.microTask,ev(n),Qy(n)):"macroTask"==T.change&&(n.hasPendingMacrotasks=T.macroTask))},onHandleError:(l,h,g,T)=>(l.handleError(g,T),n.runOutsideAngular(()=>n.onError.emit(T)),!1)})}(g)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Fa.isInAngularZone())throw new ae(909,!1)}static assertNotInAngularZone(){if(Fa.isInAngularZone())throw new ae(909,!1)}run(r,l,h){return this._inner.run(r,l,h)}runTask(r,l,h,g){const T=this._inner,M=T.scheduleEventTask("NgZoneEvent: "+g,r,jT,Kx,Kx);try{return T.runTask(M,l,h)}finally{T.cancelTask(M)}}runGuarded(r,l,h){return this._inner.runGuarded(r,l,h)}runOutsideAngular(r){return this._outer.run(r)}}const jT={};function Qy(n){if(0==n._nesting&&!n.hasPendingMicrotasks&&!n.isStable)try{n._nesting++,n.onMicrotaskEmpty.emit(null)}finally{if(n._nesting--,!n.hasPendingMicrotasks)try{n.runOutsideAngular(()=>n.onStable.emit(null))}finally{n.isStable=!0}}}function ev(n){n.hasPendingMicrotasks=!!(n._hasPendingMicrotasks||(n.shouldCoalesceEventChangeDetection||n.shouldCoalesceRunChangeDetection)&&-1!==n.lastRequestAnimationFrameId)}function Xx(n){n._nesting++,n.isStable&&(n.isStable=!1,n.onUnstable.emit(null))}function Qx(n){n._nesting--,Qy(n)}class GT{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Lc,this.onMicrotaskEmpty=new Lc,this.onStable=new Lc,this.onError=new Lc}run(r,l,h){return r.apply(l,h)}runGuarded(r,l,h){return r.apply(l,h)}runOutsideAngular(r){return r()}runTask(r,l,h,g){return r.apply(l,h)}}const e1=new lr("",{providedIn:"root",factory:t1});function t1(){const n=We(Fa);let r=!0;return function Ae(...n){const r=(0,w.yG)(n),l=(0,w._6)(n,1/0),h=n;return h.length?1===h.length?(0,ie.Xf)(h[0]):(0,Q.J)(l)((0,fe.D)(h,r)):W.E}(new s.y(g=>{r=n.isStable&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks,n.runOutsideAngular(()=>{g.next(r),g.complete()})}),new s.y(g=>{let T;n.runOutsideAngular(()=>{T=n.onStable.subscribe(()=>{Fa.assertNotInAngularZone(),queueMicrotask(()=>{!r&&!n.hasPendingMacrotasks&&!n.hasPendingMicrotasks&&(r=!0,g.next(!0))})})});const M=n.onUnstable.subscribe(()=>{Fa.assertInAngularZone(),r&&(r=!1,n.runOutsideAngular(()=>{g.next(!1)}))});return()=>{T.unsubscribe(),M.unsubscribe()}}).pipe((0,X.B)()))}const n1=new lr(""),i1=new lr("");let tv,WT=(()=>{class n{constructor(l,h,g){this._ngZone=l,this.registry=h,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,tv||(function qT(n){tv=n}(g),g.addToWindow(h)),this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Fa.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(h=>!h.updateCb||!h.updateCb(l)||(clearTimeout(h.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,h,g){let T=-1;h&&h>0&&(T=setTimeout(()=>{this._callbacks=this._callbacks.filter(M=>M.timeoutId!==T),l(this._didWork,this.getPendingTasks())},h)),this._callbacks.push({doneCb:l,timeoutId:T,updateCb:g})}whenStable(l,h,g){if(g&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,h,g),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(l){this.registry.registerApplication(l,this)}unregisterApplication(l){this.registry.unregisterApplication(l)}findProviders(l,h,g){return[]}}return n.\u0275fac=function(l){return new(l||n)(Y(Fa),Y(o1),Y(i1))},n.\u0275prov=Sn({token:n,factory:n.\u0275fac}),n})(),o1=(()=>{class n{constructor(){this._applications=new Map}registerApplication(l,h){this._applications.set(l,h)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,h=!0){return tv?.findTestabilityInTree(this,l,h)??null}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})(),pd=null;const r1=new lr("AllowMultipleToken"),nv=new lr("PlatformDestroyListeners"),iv=new lr("appBootstrapListener");class KT{constructor(r,l){this.name=r,this.token=l}}function l1(n,r,l=[]){const h=`Platform: ${r}`,g=new lr(h);return(T=[])=>{let M=ov();if(!M||M.injector.get(r1,!1)){const F=[...l,...T,{provide:g,useValue:!0}];n?n(F):function XT(n){if(pd&&!pd.get(r1,!1))throw new ae(400,!1);(function s1(){!function Bl(n){Nc=n}(()=>{throw new ae(600,!1)})})(),pd=n;const r=n.get(u1);(function a1(n){n.get(Uu,null)?.forEach(l=>l())})(n)}(function c1(n=[],r){return Ec.create({name:r,providers:[{provide:Vh,useValue:"platform"},{provide:nv,useValue:new Set([()=>pd=null])},...n]})}(F,h))}return function eC(n){const r=ov();if(!r)throw new ae(401,!1);return r}()}}function ov(){return pd?.get(u1)??null}let u1=(()=>{class n{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,h){const g=function tC(n="zone.js",r){return"noop"===n?new GT:"zone.js"===n?new Fa(r):n}(h?.ngZone,function d1(n){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:n?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:n?.runCoalescing??!1}}({eventCoalescing:h?.ngZoneEventCoalescing,runCoalescing:h?.ngZoneRunCoalescing}));return g.run(()=>{const T=function Cw(n,r,l){return new ky(n,r,l)}(l.moduleType,this.injector,function g1(n){return[{provide:Fa,useFactory:n},{provide:ku,multi:!0,useFactory:()=>{const r=We(iC,{optional:!0});return()=>r.initialize()}},{provide:m1,useFactory:nC},{provide:e1,useFactory:t1}]}(()=>g)),M=T.injector.get(Cc,null);return g.runOutsideAngular(()=>{const F=g.onError.subscribe({next:V=>{M.handleError(V)}});T.onDestroy(()=>{n_(this._modules,T),F.unsubscribe()})}),function h1(n,r,l){try{const h=l();return pu(h)?h.catch(g=>{throw r.runOutsideAngular(()=>n.handleError(g)),g}):h}catch(h){throw r.runOutsideAngular(()=>n.handleError(h)),h}}(M,g,()=>{const F=T.injector.get(Xy);return F.runInitializers(),F.donePromise.then(()=>(function w0(n){Vt(n,"Expected localeId to be defined"),"string"==typeof n&&(b0=n.toLowerCase().replace(/_/g,"-"))}(T.injector.get(t_,Lp)||Lp),this._moduleDoBootstrap(T),T))})})}bootstrapModule(l,h=[]){const g=p1({},h);return function YT(n,r,l){const h=new Fy(l);return Promise.resolve(h)}(0,0,l).then(T=>this.bootstrapModuleFactory(T,g))}_moduleDoBootstrap(l){const h=l.injector.get(Np);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(g=>h.bootstrap(g));else{if(!l.instance.ngDoBootstrap)throw new ae(-403,!1);l.instance.ngDoBootstrap(h)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ae(404,!1);this._modules.slice().forEach(h=>h.destroy()),this._destroyListeners.forEach(h=>h());const l=this._injector.get(nv,null);l&&(l.forEach(h=>h()),l.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return n.\u0275fac=function(l){return new(l||n)(Y(Ec))},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"platform"}),n})();function p1(n,r){return Array.isArray(r)?r.reduce(p1,n):{...n,...r}}let Np=(()=>{class n{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=We(m1),this.zoneIsStable=We(e1),this.componentTypes=[],this.components=[],this.isStable=We(qx).hasPendingTasks.pipe((0,se.w)(l=>l?(0,De.of)(!1):this.zoneIsStable),(0,Te.x)(),(0,X.B)()),this._injector=We(Tc)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(l,h){const g=l instanceof Of;if(!this._injector.get(Xy).done)throw!g&&or(l),new ae(405,!1);let M;M=g?l:this._injector.get(np).resolveComponentFactory(l),this.componentTypes.push(M.componentType);const F=function JT(n){return n.isBoundToModule}(M)?void 0:this._injector.get(kp),oe=M.create(Ec.NULL,[],h||M.selector,F),Pe=oe.location.nativeElement,ft=oe.injector.get(n1,null);return ft?.registerApplication(Pe),oe.onDestroy(()=>{this.detachView(oe.hostView),n_(this.components,oe),ft?.unregisterApplication(Pe)}),this._loadComponent(oe),oe}tick(){if(this._runningTick)throw new ae(101,!1);try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this.internalErrorHandler(l)}finally{this._runningTick=!1}}attachView(l){const h=l;this._views.push(h),h.attachToAppRef(this)}detachView(l){const h=l;n_(this._views,h),h.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l);const h=this._injector.get(iv,[]);h.push(...this._bootstrapListeners),h.forEach(g=>g(l))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(l=>l()),this._views.slice().forEach(l=>l.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(l){return this._destroyListeners.push(l),()=>n_(this._destroyListeners,l)}destroy(){if(this._destroyed)throw new ae(406,!1);const l=this._injector;l.destroy&&!l.destroyed&&l.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function n_(n,r){const l=n.indexOf(r);l>-1&&n.splice(l,1)}const m1=new lr("",{providedIn:"root",factory:()=>We(Cc).handleError.bind(void 0)});function nC(){const n=We(Fa),r=We(Cc);return l=>n.runOutsideAngular(()=>r.handleError(l))}let iC=(()=>{class n{constructor(){this.zone=We(Fa),this.applicationRef=We(Np)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}}return n.\u0275fac=function(l){return new(l||n)},n.\u0275prov=Sn({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function rC(){}let sC=(()=>{class n{}return n.__NG_ELEMENT_ID__=aC,n})();function aC(n){return function lC(n,r,l){if(Ts(n)&&!l){const h=Ki(n.index,r);return new sd(h,h)}return 47&n.type?new sd(r[ko],r):null}(jr(),Gn(),16==(16&n))}class x1{constructor(){}supports(r){return uh(r)}create(r){return new fC(r)}}const pC=(n,r)=>r;class fC{constructor(r){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=r||pC}forEachItem(r){let l;for(l=this._itHead;null!==l;l=l._next)r(l)}forEachOperation(r){let l=this._itHead,h=this._removalsHead,g=0,T=null;for(;l||h;){const M=!h||l&&l.currentIndex<w1(h,g,T)?l:h,F=w1(M,g,T),V=M.currentIndex;if(M===h)g--,h=h._nextRemoved;else if(l=l._next,null==M.previousIndex)g++;else{T||(T=[]);const oe=F-g,Pe=V-g;if(oe!=Pe){for(let Ht=0;Ht<oe;Ht++){const rn=Ht<T.length?T[Ht]:T[Ht]=0,Zn=rn+Ht;Pe<=Zn&&Zn<oe&&(T[Ht]=rn+1)}T[M.previousIndex]=Pe-oe}}F!==V&&r(M,F,V)}}forEachPreviousItem(r){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)r(l)}forEachAddedItem(r){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)r(l)}forEachMovedItem(r){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)r(l)}forEachRemovedItem(r){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)r(l)}forEachIdentityChange(r){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)r(l)}diff(r){if(null==r&&(r=[]),!uh(r))throw new ae(900,!1);return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let g,T,M,l=this._itHead,h=!1;if(Array.isArray(r)){this.length=r.length;for(let F=0;F<this.length;F++)T=r[F],M=this._trackByFn(F,T),null!==l&&Object.is(l.trackById,M)?(h&&(l=this._verifyReinsertion(l,T,M,F)),Object.is(l.item,T)||this._addIdentityChange(l,T)):(l=this._mismatch(l,T,M,F),h=!0),l=l._next}else g=0,function lm(n,r){if(Array.isArray(n))for(let l=0;l<n.length;l++)r(n[l]);else{const l=n[Symbol.iterator]();let h;for(;!(h=l.next()).done;)r(h.value)}}(r,F=>{M=this._trackByFn(g,F),null!==l&&Object.is(l.trackById,M)?(h&&(l=this._verifyReinsertion(l,F,M,g)),Object.is(l.item,F)||this._addIdentityChange(l,F)):(l=this._mismatch(l,F,M,g),h=!0),l=l._next,g++}),this.length=g;return this._truncate(l),this.collection=r,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let r;for(r=this._previousItHead=this._itHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._additionsHead;null!==r;r=r._nextAdded)r.previousIndex=r.currentIndex;for(this._additionsHead=this._additionsTail=null,r=this._movesHead;null!==r;r=r._nextMoved)r.previousIndex=r.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(r,l,h,g){let T;return null===r?T=this._itTail:(T=r._prev,this._remove(r)),null!==(r=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null))?(Object.is(r.item,l)||this._addIdentityChange(r,l),this._reinsertAfter(r,T,g)):null!==(r=null===this._linkedRecords?null:this._linkedRecords.get(h,g))?(Object.is(r.item,l)||this._addIdentityChange(r,l),this._moveAfter(r,T,g)):r=this._addAfter(new mC(l,h),T,g),r}_verifyReinsertion(r,l,h,g){let T=null===this._unlinkedRecords?null:this._unlinkedRecords.get(h,null);return null!==T?r=this._reinsertAfter(T,r._prev,g):r.currentIndex!=g&&(r.currentIndex=g,this._addToMoves(r,g)),r}_truncate(r){for(;null!==r;){const l=r._next;this._addToRemovals(this._unlink(r)),r=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(r,l,h){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(r);const g=r._prevRemoved,T=r._nextRemoved;return null===g?this._removalsHead=T:g._nextRemoved=T,null===T?this._removalsTail=g:T._prevRemoved=g,this._insertAfter(r,l,h),this._addToMoves(r,h),r}_moveAfter(r,l,h){return this._unlink(r),this._insertAfter(r,l,h),this._addToMoves(r,h),r}_addAfter(r,l,h){return this._insertAfter(r,l,h),this._additionsTail=null===this._additionsTail?this._additionsHead=r:this._additionsTail._nextAdded=r,r}_insertAfter(r,l,h){const g=null===l?this._itHead:l._next;return r._next=g,r._prev=l,null===g?this._itTail=r:g._prev=r,null===l?this._itHead=r:l._next=r,null===this._linkedRecords&&(this._linkedRecords=new b1),this._linkedRecords.put(r),r.currentIndex=h,r}_remove(r){return this._addToRemovals(this._unlink(r))}_unlink(r){null!==this._linkedRecords&&this._linkedRecords.remove(r);const l=r._prev,h=r._next;return null===l?this._itHead=h:l._next=h,null===h?this._itTail=l:h._prev=l,r}_addToMoves(r,l){return r.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=r:this._movesTail._nextMoved=r),r}_addToRemovals(r){return null===this._unlinkedRecords&&(this._unlinkedRecords=new b1),this._unlinkedRecords.put(r),r.currentIndex=null,r._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=r,r._prevRemoved=null):(r._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=r),r}_addIdentityChange(r,l){return r.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=r:this._identityChangesTail._nextIdentityChange=r,r}}class mC{constructor(r,l){this.item=r,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class gC{constructor(){this._head=null,this._tail=null}add(r){null===this._head?(this._head=this._tail=r,r._nextDup=null,r._prevDup=null):(this._tail._nextDup=r,r._prevDup=this._tail,r._nextDup=null,this._tail=r)}get(r,l){let h;for(h=this._head;null!==h;h=h._nextDup)if((null===l||l<=h.currentIndex)&&Object.is(h.trackById,r))return h;return null}remove(r){const l=r._prevDup,h=r._nextDup;return null===l?this._head=h:l._nextDup=h,null===h?this._tail=l:h._prevDup=l,null===this._head}}class b1{constructor(){this.map=new Map}put(r){const l=r.trackById;let h=this.map.get(l);h||(h=new gC,this.map.set(l,h)),h.add(r)}get(r,l){const g=this.map.get(r);return g?g.get(r,l):null}remove(r){const l=r.trackById;return this.map.get(l).remove(r)&&this.map.delete(l),r}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function w1(n,r,l){const h=n.previousIndex;if(null===h)return h;let g=0;return l&&h<l.length&&(g=l[h]),h+r+g}class T1{constructor(){}supports(r){return r instanceof Map||Dp(r)}create(){return new _C}}class _C{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(r){let l;for(l=this._mapHead;null!==l;l=l._next)r(l)}forEachPreviousItem(r){let l;for(l=this._previousMapHead;null!==l;l=l._nextPrevious)r(l)}forEachChangedItem(r){let l;for(l=this._changesHead;null!==l;l=l._nextChanged)r(l)}forEachAddedItem(r){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)r(l)}forEachRemovedItem(r){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)r(l)}diff(r){if(r){if(!(r instanceof Map||Dp(r)))throw new ae(900,!1)}else r=new Map;return this.check(r)?this:null}onDestroy(){}check(r){this._reset();let l=this._mapHead;if(this._appendAfter=null,this._forEach(r,(h,g)=>{if(l&&l.key===g)this._maybeAddToChanges(l,h),this._appendAfter=l,l=l._next;else{const T=this._getOrCreateRecordForKey(g,h);l=this._insertBeforeOrAppend(l,T)}}),l){l._prev&&(l._prev._next=null),this._removalsHead=l;for(let h=l;null!==h;h=h._nextRemoved)h===this._mapHead&&(this._mapHead=null),this._records.delete(h.key),h._nextRemoved=h._next,h.previousValue=h.currentValue,h.currentValue=null,h._prev=null,h._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(r,l){if(r){const h=r._prev;return l._next=r,l._prev=h,r._prev=l,h&&(h._next=l),r===this._mapHead&&(this._mapHead=l),this._appendAfter=r,r}return this._appendAfter?(this._appendAfter._next=l,l._prev=this._appendAfter):this._mapHead=l,this._appendAfter=l,null}_getOrCreateRecordForKey(r,l){if(this._records.has(r)){const g=this._records.get(r);this._maybeAddToChanges(g,l);const T=g._prev,M=g._next;return T&&(T._next=M),M&&(M._prev=T),g._next=null,g._prev=null,g}const h=new yC(r);return this._records.set(r,h),h.currentValue=l,this._addToAdditions(h),h}_reset(){if(this.isDirty){let r;for(this._previousMapHead=this._mapHead,r=this._previousMapHead;null!==r;r=r._next)r._nextPrevious=r._next;for(r=this._changesHead;null!==r;r=r._nextChanged)r.previousValue=r.currentValue;for(r=this._additionsHead;null!=r;r=r._nextAdded)r.previousValue=r.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(r,l){Object.is(l,r.currentValue)||(r.previousValue=r.currentValue,r.currentValue=l,this._addToChanges(r))}_addToAdditions(r){null===this._additionsHead?this._additionsHead=this._additionsTail=r:(this._additionsTail._nextAdded=r,this._additionsTail=r)}_addToChanges(r){null===this._changesHead?this._changesHead=this._changesTail=r:(this._changesTail._nextChanged=r,this._changesTail=r)}_forEach(r,l){r instanceof Map?r.forEach(l):Object.keys(r).forEach(h=>l(r[h],h))}}class yC{constructor(r){this.key=r,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function C1(){return new cv([new x1])}let cv=(()=>{class n{constructor(l){this.factories=l}static create(l,h){if(null!=h){const g=h.factories.slice();l=l.concat(g)}return new n(l)}static extend(l){return{provide:n,useFactory:h=>n.create(l,h||C1()),deps:[[n,new yh,new nl]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(null!=h)return h;throw new ae(901,!1)}}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:C1}),n})();function E1(){return new uv([new T1])}let uv=(()=>{class n{constructor(l){this.factories=l}static create(l,h){if(h){const g=h.factories.slice();l=l.concat(g)}return new n(l)}static extend(l){return{provide:n,useFactory:h=>n.create(l,h||E1()),deps:[[n,new yh,new nl]]}}find(l){const h=this.factories.find(g=>g.supports(l));if(h)return h;throw new ae(901,!1)}}return n.\u0275prov=Sn({token:n,providedIn:"root",factory:E1}),n})();const bC=l1(null,"core",[]);let wC=(()=>{class n{constructor(l){}}return n.\u0275fac=function(l){return new(l||n)(Y(Np))},n.\u0275mod=On({type:n}),n.\u0275inj=yi({}),n})();function PC(n){return"boolean"==typeof n?n:null!=n&&"false"!==n}function RC(n,r){const l=Xi(n),h=r.elementInjector||Gd();return new ch(l).create(h,r.projectableNodes,r.hostElement,r.environmentInjector)}function LC(n){const r=Xi(n);if(!r)return null;const l=new ch(r);return{get selector(){return l.selector},get type(){return l.componentType},get inputs(){return l.inputs},get outputs(){return l.outputs},get ngContentSelectors(){return l.ngContentSelectors},get isStandalone(){return r.standalone},get isSignal(){return r.signals}}}},6223:(zn,Ct,R)=>{"use strict";R.d(Ct,{Fd:()=>Qr,Fj:()=>Te,JJ:()=>Nt,JU:()=>w,On:()=>On,a5:()=>at,qQ:()=>Qi,u5:()=>Xn,wV:()=>zi});var v=R(2029),d=R(6814),y=R(7715),s=R(9315),Q=R(7398);let ie=(()=>{class ee{constructor(G,Fe){this._renderer=G,this._elementRef=Fe,this.onChange=bn=>{},this.onTouched=()=>{}}setProperty(G,Fe){this._renderer.setProperty(this._elementRef.nativeElement,G,Fe)}registerOnTouched(G){this.onTouched=G}registerOnChange(G){this.onChange=G}setDisabledState(G){this.setProperty("disabled",G)}}return ee.\u0275fac=function(G){return new(G||ee)(v.Y36(v.Qsj),v.Y36(v.SBq))},ee.\u0275dir=v.lG2({type:ee}),ee})(),W=(()=>{class ee extends ie{}return ee.\u0275fac=function(){let J;return function(Fe){return(J||(J=v.n5z(ee)))(Fe||ee)}}(),ee.\u0275dir=v.lG2({type:ee,features:[v.qOj]}),ee})();const w=new v.OlP("NgValueAccessor"),De={provide:w,useExisting:(0,v.Gpc)(()=>Te),multi:!0},se=new v.OlP("CompositionEventMode");let Te=(()=>{class ee extends ie{constructor(G,Fe,bn){super(G,Fe),this._compositionMode=bn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function X(){const ee=(0,d.q)()?(0,d.q)().getUserAgent():"";return/android (\d+)/.test(ee.toLowerCase())}())}writeValue(G){this.setProperty("value",G??"")}_handleInput(G){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(G)}_compositionStart(){this._composing=!0}_compositionEnd(G){this._composing=!1,this._compositionMode&&this.onChange(G)}}return ee.\u0275fac=function(G){return new(G||ee)(v.Y36(v.Qsj),v.Y36(v.SBq),v.Y36(se,8))},ee.\u0275dir=v.lG2({type:ee,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(G,Fe){1&G&&v.NdJ("input",function(pi){return Fe._handleInput(pi.target.value)})("blur",function(){return Fe.onTouched()})("compositionstart",function(){return Fe._compositionStart()})("compositionend",function(pi){return Fe._compositionEnd(pi.target.value)})},features:[v._Bn([De]),v.qOj]}),ee})();function ge(ee){return null==ee||("string"==typeof ee||Array.isArray(ee))&&0===ee.length}const Le=new v.OlP("NgValidators"),Me=new v.OlP("NgAsyncValidators");function Ze(ee){return null}function Se(ee){return null!=ee}function ye(ee){return(0,v.QGY)(ee)?(0,y.D)(ee):ee}function Qt(ee){let J={};return ee.forEach(G=>{J=null!=G?{...J,...G}:J}),0===Object.keys(J).length?null:J}function dt(ee,J){return J.map(G=>G(ee))}function ct(ee){return ee.map(J=>function gt(ee){return!ee.validate}(J)?J:G=>J.validate(G))}function vt(ee){return null!=ee?function Ue(ee){if(!ee)return null;const J=ee.filter(Se);return 0==J.length?null:function(G){return Qt(dt(G,J))}}(ct(ee)):null}function _t(ee){return null!=ee?function je(ee){if(!ee)return null;const J=ee.filter(Se);return 0==J.length?null:function(G){const Fe=dt(G,J).map(ye);return(0,s.D)(Fe).pipe((0,Q.U)(Qt))}}(ct(ee)):null}function Ne(ee,J){return null===ee?[J]:Array.isArray(ee)?[...ee,J]:[ee,J]}function wn(ee){return ee?Array.isArray(ee)?ee:[ee]:[]}function Xt(ee,J){return Array.isArray(ee)?ee.includes(J):ee===J}function mn(ee,J){const G=wn(J);return wn(ee).forEach(bn=>{Xt(G,bn)||G.push(bn)}),G}function sn(ee,J){return wn(J).filter(G=>!Xt(ee,G))}class Vt{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(J){this._rawValidators=J||[],this._composedValidatorFn=vt(this._rawValidators)}_setAsyncValidators(J){this._rawAsyncValidators=J||[],this._composedAsyncValidatorFn=_t(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(J){this._onDestroyCallbacks.push(J)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(J=>J()),this._onDestroyCallbacks=[]}reset(J=void 0){this.control&&this.control.reset(J)}hasError(J,G){return!!this.control&&this.control.hasError(J,G)}getError(J,G){return this.control?this.control.getError(J,G):null}}class It extends Vt{get formDirective(){return null}get path(){return null}}class at extends Vt{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Wt{constructor(J){this._cd=J}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Nt=(()=>{class ee extends Wt{constructor(G){super(G)}}return ee.\u0275fac=function(G){return new(G||ee)(v.Y36(at,2))},ee.\u0275dir=v.lG2({type:ee,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(G,Fe){2&G&&v.ekj("ng-untouched",Fe.isUntouched)("ng-touched",Fe.isTouched)("ng-pristine",Fe.isPristine)("ng-dirty",Fe.isDirty)("ng-valid",Fe.isValid)("ng-invalid",Fe.isInvalid)("ng-pending",Fe.isPending)},features:[v.qOj]}),ee})();const ut="VALID",pe="INVALID",ve="PENDING",et="DISABLED";function St(ee){return null!=ee&&!Array.isArray(ee)&&"object"==typeof ee}class tt{constructor(J,G){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(J),this._assignAsyncValidators(G)}get validator(){return this._composedValidatorFn}set validator(J){this._rawValidators=this._composedValidatorFn=J}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(J){this._rawAsyncValidators=this._composedAsyncValidatorFn=J}get parent(){return this._parent}get valid(){return this.status===ut}get invalid(){return this.status===pe}get pending(){return this.status==ve}get disabled(){return this.status===et}get enabled(){return this.status!==et}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(J){this._assignValidators(J)}setAsyncValidators(J){this._assignAsyncValidators(J)}addValidators(J){this.setValidators(mn(J,this._rawValidators))}addAsyncValidators(J){this.setAsyncValidators(mn(J,this._rawAsyncValidators))}removeValidators(J){this.setValidators(sn(J,this._rawValidators))}removeAsyncValidators(J){this.setAsyncValidators(sn(J,this._rawAsyncValidators))}hasValidator(J){return Xt(this._rawValidators,J)}hasAsyncValidator(J){return Xt(this._rawAsyncValidators,J)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(J={}){this.touched=!0,this._parent&&!J.onlySelf&&this._parent.markAsTouched(J)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(J=>J.markAllAsTouched())}markAsUntouched(J={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(G=>{G.markAsUntouched({onlySelf:!0})}),this._parent&&!J.onlySelf&&this._parent._updateTouched(J)}markAsDirty(J={}){this.pristine=!1,this._parent&&!J.onlySelf&&this._parent.markAsDirty(J)}markAsPristine(J={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(G=>{G.markAsPristine({onlySelf:!0})}),this._parent&&!J.onlySelf&&this._parent._updatePristine(J)}markAsPending(J={}){this.status=ve,!1!==J.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!J.onlySelf&&this._parent.markAsPending(J)}disable(J={}){const G=this._parentMarkedDirty(J.onlySelf);this.status=et,this.errors=null,this._forEachChild(Fe=>{Fe.disable({...J,onlySelf:!0})}),this._updateValue(),!1!==J.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...J,skipPristineCheck:G}),this._onDisabledChange.forEach(Fe=>Fe(!0))}enable(J={}){const G=this._parentMarkedDirty(J.onlySelf);this.status=ut,this._forEachChild(Fe=>{Fe.enable({...J,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:J.emitEvent}),this._updateAncestors({...J,skipPristineCheck:G}),this._onDisabledChange.forEach(Fe=>Fe(!1))}_updateAncestors(J){this._parent&&!J.onlySelf&&(this._parent.updateValueAndValidity(J),J.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(J){this._parent=J}getRawValue(){return this.value}updateValueAndValidity(J={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ut||this.status===ve)&&this._runAsyncValidator(J.emitEvent)),!1!==J.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!J.onlySelf&&this._parent.updateValueAndValidity(J)}_updateTreeValidity(J={emitEvent:!0}){this._forEachChild(G=>G._updateTreeValidity(J)),this.updateValueAndValidity({onlySelf:!0,emitEvent:J.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?et:ut}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(J){if(this.asyncValidator){this.status=ve,this._hasOwnPendingAsyncValidator=!0;const G=ye(this.asyncValidator(this));this._asyncValidationSubscription=G.subscribe(Fe=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Fe,{emitEvent:J})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(J,G={}){this.errors=J,this._updateControlsErrors(!1!==G.emitEvent)}get(J){let G=J;return null==G||(Array.isArray(G)||(G=G.split(".")),0===G.length)?null:G.reduce((Fe,bn)=>Fe&&Fe._find(bn),this)}getError(J,G){const Fe=G?this.get(G):this;return Fe&&Fe.errors?Fe.errors[J]:null}hasError(J,G){return!!this.getError(J,G)}get root(){let J=this;for(;J._parent;)J=J._parent;return J}_updateControlsErrors(J){this.status=this._calculateStatus(),J&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(J)}_initObservables(){this.valueChanges=new v.vpe,this.statusChanges=new v.vpe}_calculateStatus(){return this._allControlsDisabled()?et:this.errors?pe:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(ve)?ve:this._anyControlsHaveStatus(pe)?pe:ut}_anyControlsHaveStatus(J){return this._anyControls(G=>G.status===J)}_anyControlsDirty(){return this._anyControls(J=>J.dirty)}_anyControlsTouched(){return this._anyControls(J=>J.touched)}_updatePristine(J={}){this.pristine=!this._anyControlsDirty(),this._parent&&!J.onlySelf&&this._parent._updatePristine(J)}_updateTouched(J={}){this.touched=this._anyControlsTouched(),this._parent&&!J.onlySelf&&this._parent._updateTouched(J)}_registerOnCollectionChange(J){this._onCollectionChange=J}_setUpdateStrategy(J){St(J)&&null!=J.updateOn&&(this._updateOn=J.updateOn)}_parentMarkedDirty(J){return!J&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(J){return null}_assignValidators(J){this._rawValidators=Array.isArray(J)?J.slice():J,this._composedValidatorFn=function Rt(ee){return Array.isArray(ee)?vt(ee):ee||null}(this._rawValidators)}_assignAsyncValidators(J){this._rawAsyncValidators=Array.isArray(J)?J.slice():J,this._composedAsyncValidatorFn=function jt(ee){return Array.isArray(ee)?_t(ee):ee||null}(this._rawAsyncValidators)}}const _n=new v.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>ti}),ti="always";function Si(ee,J,G=ti){(function tn(ee,J){const G=function Ft(ee){return ee._rawValidators}(ee);null!==J.validator?ee.setValidators(Ne(G,J.validator)):"function"==typeof G&&ee.setValidators([G]);const Fe=function Gt(ee){return ee._rawAsyncValidators}(ee);null!==J.asyncValidator?ee.setAsyncValidators(Ne(Fe,J.asyncValidator)):"function"==typeof Fe&&ee.setAsyncValidators([Fe]);const bn=()=>ee.updateValueAndValidity();po(J._rawValidators,bn),po(J._rawAsyncValidators,bn)})(ee,J),J.valueAccessor.writeValue(ee.value),(ee.disabled||"always"===G)&&J.valueAccessor.setDisabledState?.(ee.disabled),function Et(ee,J){J.valueAccessor.registerOnChange(G=>{ee._pendingValue=G,ee._pendingChange=!0,ee._pendingDirty=!0,"change"===ee.updateOn&&Pn(ee,J)})}(ee,J),function ri(ee,J){const G=(Fe,bn)=>{J.valueAccessor.writeValue(Fe),bn&&J.viewToModelUpdate(Fe)};ee.registerOnChange(G),J._registerOnDestroy(()=>{ee._unregisterOnChange(G)})}(ee,J),function Nn(ee,J){J.valueAccessor.registerOnTouched(()=>{ee._pendingTouched=!0,"blur"===ee.updateOn&&ee._pendingChange&&Pn(ee,J),"submit"!==ee.updateOn&&ee.markAsTouched()})}(ee,J),function eo(ee,J){if(J.valueAccessor.setDisabledState){const G=Fe=>{J.valueAccessor.setDisabledState(Fe)};ee.registerOnDisabledChange(G),J._registerOnDestroy(()=>{ee._unregisterOnDisabledChange(G)})}}(ee,J)}function po(ee,J){ee.forEach(G=>{G.registerOnValidatorChange&&G.registerOnValidatorChange(J)})}function Pn(ee,J){ee._pendingDirty&&ee.markAsDirty(),ee.setValue(ee._pendingValue,{emitModelToViewChange:!1}),J.viewToModelUpdate(ee._pendingValue),ee._pendingChange=!1}function Zr(ee,J){const G=ee.indexOf(J);G>-1&&ee.splice(G,1)}function Mr(ee){return"object"==typeof ee&&null!==ee&&2===Object.keys(ee).length&&"value"in ee&&"disabled"in ee}const kr=class extends tt{constructor(J=null,G,Fe){super(function yt(ee){return(St(ee)?ee.validators:ee)||null}(G),function Ut(ee,J){return(St(J)?J.asyncValidators:ee)||null}(Fe,G)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(J),this._setUpdateStrategy(G),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),St(G)&&(G.nonNullable||G.initialValueIsDefault)&&(this.defaultValue=Mr(J)?J.value:J)}setValue(J,G={}){this.value=this._pendingValue=J,this._onChange.length&&!1!==G.emitModelToViewChange&&this._onChange.forEach(Fe=>Fe(this.value,!1!==G.emitViewToModelChange)),this.updateValueAndValidity(G)}patchValue(J,G={}){this.setValue(J,G)}reset(J=this.defaultValue,G={}){this._applyFormState(J),this.markAsPristine(G),this.markAsUntouched(G),this.setValue(this.value,G),this._pendingChange=!1}_updateValue(){}_anyControls(J){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(J){this._onChange.push(J)}_unregisterOnChange(J){Zr(this._onChange,J)}registerOnDisabledChange(J){this._onDisabledChange.push(J)}_unregisterOnDisabledChange(J){Zr(this._onDisabledChange,J)}_forEachChild(J){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(J){Mr(J)?(this.value=this._pendingValue=J.value,J.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=J}},Tn={provide:at,useExisting:(0,v.Gpc)(()=>On)},xn=(()=>Promise.resolve())();let On=(()=>{class ee extends at{constructor(G,Fe,bn,pi,sr,hs){super(),this._changeDetectorRef=sr,this.callSetDisabledState=hs,this.control=new kr,this._registered=!1,this.name="",this.update=new v.vpe,this._parent=G,this._setValidators(Fe),this._setAsyncValidators(bn),this.valueAccessor=function en(ee,J){if(!J)return null;let G,Fe,bn;return Array.isArray(J),J.forEach(pi=>{pi.constructor===Te?G=pi:function Pi(ee){return Object.getPrototypeOf(ee.constructor)===W}(pi)?Fe=pi:bn=pi}),bn||Fe||G||null}(0,pi)}ngOnChanges(G){if(this._checkForErrors(),!this._registered||"name"in G){if(this._registered&&(this._checkName(),this.formDirective)){const Fe=G.name.previousValue;this.formDirective.removeControl({name:Fe,path:this._getPath(Fe)})}this._setUpControl()}"isDisabled"in G&&this._updateDisabled(G),function io(ee,J){if(!ee.hasOwnProperty("model"))return!1;const G=ee.model;return!!G.isFirstChange()||!Object.is(J,G.currentValue)}(G,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(G){this.viewModel=G,this.update.emit(G)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Si(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(G){xn.then(()=>{this.control.setValue(G,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(G){const Fe=G.isDisabled.currentValue,bn=0!==Fe&&(0,v.VuI)(Fe);xn.then(()=>{bn&&!this.control.disabled?this.control.disable():!bn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(G){return this._parent?function Ei(ee,J){return[...J.path,ee]}(G,this._parent):[G]}}return ee.\u0275fac=function(G){return new(G||ee)(v.Y36(It,9),v.Y36(Le,10),v.Y36(Me,10),v.Y36(w,10),v.Y36(v.sBO,8),v.Y36(_n,8))},ee.\u0275dir=v.lG2({type:ee,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[v._Bn([Tn]),v.qOj,v.TTD]}),ee})();const Ii={provide:w,useExisting:(0,v.Gpc)(()=>zi),multi:!0};let zi=(()=>{class ee extends W{writeValue(G){this.setProperty("value",G??"")}registerOnChange(G){this.onChange=Fe=>{G(""==Fe?null:parseFloat(Fe))}}}return ee.\u0275fac=function(){let J;return function(Fe){return(J||(J=v.n5z(ee)))(Fe||ee)}}(),ee.\u0275dir=v.lG2({type:ee,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(G,Fe){1&G&&v.NdJ("input",function(pi){return Fe.onChange(pi.target.value)})("blur",function(){return Fe.onTouched()})},features:[v._Bn([Ii]),v.qOj]}),ee})(),so=(()=>{class ee{}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275mod=v.oAB({type:ee}),ee.\u0275inj=v.cJS({}),ee})();function bs(ee){return"number"==typeof ee?ee:parseFloat(ee)}let rr=(()=>{class ee{constructor(){this._validator=Ze}ngOnChanges(G){if(this.inputName in G){const Fe=this.normalizeInput(G[this.inputName].currentValue);this._enabled=this.enabled(Fe),this._validator=this._enabled?this.createValidator(Fe):Ze,this._onChange&&this._onChange()}}validate(G){return this._validator(G)}registerOnValidatorChange(G){this._onChange=G}enabled(G){return null!=G}}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275dir=v.lG2({type:ee,features:[v.TTD]}),ee})();const Ar={provide:Le,useExisting:(0,v.Gpc)(()=>Qr),multi:!0};let Qr=(()=>{class ee extends rr{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=G=>bs(G),this.createValidator=G=>function Ce(ee){return J=>{if(ge(J.value)||ge(ee))return null;const G=parseFloat(J.value);return!isNaN(G)&&G>ee?{max:{max:ee,actual:J.value}}:null}}(G)}}return ee.\u0275fac=function(){let J;return function(Fe){return(J||(J=v.n5z(ee)))(Fe||ee)}}(),ee.\u0275dir=v.lG2({type:ee,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(G,Fe){2&G&&v.uIk("max",Fe._enabled?Fe.max:null)},inputs:{max:"max"},features:[v._Bn([Ar]),v.qOj]}),ee})();const ws={provide:Le,useExisting:(0,v.Gpc)(()=>Qi),multi:!0};let Qi=(()=>{class ee extends rr{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=G=>bs(G),this.createValidator=G=>function Oe(ee){return J=>{if(ge(J.value)||ge(ee))return null;const G=parseFloat(J.value);return!isNaN(G)&&G<ee?{min:{min:ee,actual:J.value}}:null}}(G)}}return ee.\u0275fac=function(){let J;return function(Fe){return(J||(J=v.n5z(ee)))(Fe||ee)}}(),ee.\u0275dir=v.lG2({type:ee,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(G,Fe){2&G&&v.uIk("min",Fe._enabled?Fe.min:null)},inputs:{min:"min"},features:[v._Bn([ws]),v.qOj]}),ee})(),Tr=(()=>{class ee{}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275mod=v.oAB({type:ee}),ee.\u0275inj=v.cJS({imports:[so]}),ee})(),Xn=(()=>{class ee{static withConfig(G){return{ngModule:ee,providers:[{provide:_n,useValue:G.callSetDisabledState??ti}]}}}return ee.\u0275fac=function(G){return new(G||ee)},ee.\u0275mod=v.oAB({type:ee}),ee.\u0275inj=v.cJS({imports:[Tr]}),ee})()},6593:(zn,Ct,R)=>{"use strict";R.d(Ct,{Dx:()=>gn,b2:()=>dn,q6:()=>Vt});var v=R(2029),d=R(6814);class y extends d.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class s extends y{static makeCurrent(){(0,d.HT)(new s)}onAndCancel(Y,me,We){return Y.addEventListener(me,We),()=>{Y.removeEventListener(me,We)}}dispatchEvent(Y,me){Y.dispatchEvent(me)}remove(Y){Y.parentNode&&Y.parentNode.removeChild(Y)}createElement(Y,me){return(me=me||this.getDefaultDocument()).createElement(Y)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Y){return Y.nodeType===Node.ELEMENT_NODE}isShadowRoot(Y){return Y instanceof DocumentFragment}getGlobalEventTarget(Y,me){return"window"===me?window:"document"===me?Y:"body"===me?Y.body:null}getBaseHref(Y){const me=function ie(){return Q=Q||document.querySelector("base"),Q?Q.getAttribute("href"):null}();return null==me?null:function w(Ve){W=W||document.createElement("a"),W.setAttribute("href",Ve);const Y=W.pathname;return"/"===Y.charAt(0)?Y:`/${Y}`}(me)}resetBaseElement(){Q=null}getUserAgent(){return window.navigator.userAgent}getCookie(Y){return(0,d.Mx)(document.cookie,Y)}}let W,Q=null,Ae=(()=>{class Ve{build(){return new XMLHttpRequest}}return Ve.\u0275fac=function(me){return new(me||Ve)},Ve.\u0275prov=v.Yz7({token:Ve,factory:Ve.\u0275fac}),Ve})();const De=new v.OlP("EventManagerPlugins");let X=(()=>{class Ve{constructor(me,We){this._zone=We,this._eventNameToPlugin=new Map,me.forEach(kt=>{kt.manager=this}),this._plugins=me.slice().reverse()}addEventListener(me,We,kt){return this._findPluginFor(We).addEventListener(me,We,kt)}getZone(){return this._zone}_findPluginFor(me){let We=this._eventNameToPlugin.get(me);if(We)return We;if(We=this._plugins.find(_n=>_n.supports(me)),!We)throw new v.vHH(5101,!1);return this._eventNameToPlugin.set(me,We),We}}return Ve.\u0275fac=function(me){return new(me||Ve)(v.LFG(De),v.LFG(v.R0b))},Ve.\u0275prov=v.Yz7({token:Ve,factory:Ve.\u0275fac}),Ve})();class se{constructor(Y){this._doc=Y}}const Te="ng-app-id";let ge=(()=>{class Ve{constructor(me,We,kt,_n={}){this.doc=me,this.appId=We,this.nonce=kt,this.platformId=_n,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,d.PM)(_n),this.resetHostNodes()}addStyles(me){for(const We of me)1===this.changeUsageCount(We,1)&&this.onStyleAdded(We)}removeStyles(me){for(const We of me)this.changeUsageCount(We,-1)<=0&&this.onStyleRemoved(We)}ngOnDestroy(){const me=this.styleNodesInDOM;me&&(me.forEach(We=>We.remove()),me.clear());for(const We of this.getAllStyles())this.onStyleRemoved(We);this.resetHostNodes()}addHost(me){this.hostNodes.add(me);for(const We of this.getAllStyles())this.addStyleToHost(me,We)}removeHost(me){this.hostNodes.delete(me)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(me){for(const We of this.hostNodes)this.addStyleToHost(We,me)}onStyleRemoved(me){const We=this.styleRef;We.get(me)?.elements?.forEach(kt=>kt.remove()),We.delete(me)}collectServerRenderedStyles(){const me=this.doc.head?.querySelectorAll(`style[${Te}="${this.appId}"]`);if(me?.length){const We=new Map;return me.forEach(kt=>{null!=kt.textContent&&We.set(kt.textContent,kt)}),We}return null}changeUsageCount(me,We){const kt=this.styleRef;if(kt.has(me)){const _n=kt.get(me);return _n.usage+=We,_n.usage}return kt.set(me,{usage:We,elements:[]}),We}getStyleElement(me,We){const kt=this.styleNodesInDOM,_n=kt?.get(We);if(_n?.parentNode===me)return kt.delete(We),_n.removeAttribute(Te),_n;{const ti=this.doc.createElement("style");return this.nonce&&ti.setAttribute("nonce",this.nonce),ti.textContent=We,this.platformIsServer&&ti.setAttribute(Te,this.appId),ti}}addStyleToHost(me,We){const kt=this.getStyleElement(me,We);me.appendChild(kt);const _n=this.styleRef,ti=_n.get(We)?.elements;ti?ti.push(kt):_n.set(We,{elements:[kt],usage:1})}resetHostNodes(){const me=this.hostNodes;me.clear(),me.add(this.doc.head)}}return Ve.\u0275fac=function(me){return new(me||Ve)(v.LFG(d.K0),v.LFG(v.AFp),v.LFG(v.Ojb,8),v.LFG(v.Lbi))},Ve.\u0275prov=v.Yz7({token:Ve,factory:Ve.\u0275fac}),Ve})();const we={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Le=/%COMP%/g,Ce=new v.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!1});function Ee(Ve,Y){return Y.map(me=>me.replace(Le,Ve))}let ae=(()=>{class Ve{constructor(me,We,kt,_n,ti,Ei,Si,ji=null){this.eventManager=me,this.sharedStylesHost=We,this.appId=kt,this.removeStylesOnCompDestroy=_n,this.doc=ti,this.platformId=Ei,this.ngZone=Si,this.nonce=ji,this.rendererByCompId=new Map,this.platformIsServer=(0,d.PM)(Ei),this.defaultRenderer=new mt(me,ti,Si,this.platformIsServer)}createRenderer(me,We){if(!me||!We)return this.defaultRenderer;this.platformIsServer&&We.encapsulation===v.ifc.ShadowDom&&(We={...We,encapsulation:v.ifc.Emulated});const kt=this.getOrCreateRenderer(me,We);return kt instanceof dt?kt.applyToHost(me):kt instanceof Qt&&kt.applyStyles(),kt}getOrCreateRenderer(me,We){const kt=this.rendererByCompId;let _n=kt.get(We.id);if(!_n){const ti=this.doc,Ei=this.ngZone,Si=this.eventManager,ji=this.sharedStylesHost,po=this.removeStylesOnCompDestroy,eo=this.platformIsServer;switch(We.encapsulation){case v.ifc.Emulated:_n=new dt(Si,ji,We,this.appId,po,ti,Ei,eo);break;case v.ifc.ShadowDom:return new ye(Si,ji,me,We,ti,Ei,this.nonce,eo);default:_n=new Qt(Si,ji,We,po,ti,Ei,eo)}_n.onDestroy=()=>kt.delete(We.id),kt.set(We.id,_n)}return _n}ngOnDestroy(){this.rendererByCompId.clear()}}return Ve.\u0275fac=function(me){return new(me||Ve)(v.LFG(X),v.LFG(ge),v.LFG(v.AFp),v.LFG(Ce),v.LFG(d.K0),v.LFG(v.Lbi),v.LFG(v.R0b),v.LFG(v.Ojb))},Ve.\u0275prov=v.Yz7({token:Ve,factory:Ve.\u0275fac}),Ve})();class mt{constructor(Y,me,We,kt){this.eventManager=Y,this.doc=me,this.ngZone=We,this.platformIsServer=kt,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(Y,me){return me?this.doc.createElementNS(we[me]||me,Y):this.doc.createElement(Y)}createComment(Y){return this.doc.createComment(Y)}createText(Y){return this.doc.createTextNode(Y)}appendChild(Y,me){(Se(Y)?Y.content:Y).appendChild(me)}insertBefore(Y,me,We){Y&&(Se(Y)?Y.content:Y).insertBefore(me,We)}removeChild(Y,me){Y&&Y.removeChild(me)}selectRootElement(Y,me){let We="string"==typeof Y?this.doc.querySelector(Y):Y;if(!We)throw new v.vHH(-5104,!1);return me||(We.textContent=""),We}parentNode(Y){return Y.parentNode}nextSibling(Y){return Y.nextSibling}setAttribute(Y,me,We,kt){if(kt){me=kt+":"+me;const _n=we[kt];_n?Y.setAttributeNS(_n,me,We):Y.setAttribute(me,We)}else Y.setAttribute(me,We)}removeAttribute(Y,me,We){if(We){const kt=we[We];kt?Y.removeAttributeNS(kt,me):Y.removeAttribute(`${We}:${me}`)}else Y.removeAttribute(me)}addClass(Y,me){Y.classList.add(me)}removeClass(Y,me){Y.classList.remove(me)}setStyle(Y,me,We,kt){kt&(v.JOm.DashCase|v.JOm.Important)?Y.style.setProperty(me,We,kt&v.JOm.Important?"important":""):Y.style[me]=We}removeStyle(Y,me,We){We&v.JOm.DashCase?Y.style.removeProperty(me):Y.style[me]=""}setProperty(Y,me,We){Y[me]=We}setValue(Y,me){Y.nodeValue=me}listen(Y,me,We){if("string"==typeof Y&&!(Y=(0,d.q)().getGlobalEventTarget(this.doc,Y)))throw new Error(`Unsupported event target ${Y} for event ${me}`);return this.eventManager.addEventListener(Y,me,this.decoratePreventDefault(We))}decoratePreventDefault(Y){return me=>{if("__ngUnwrap__"===me)return Y;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>Y(me)):Y(me))&&me.preventDefault()}}}function Se(Ve){return"TEMPLATE"===Ve.tagName&&void 0!==Ve.content}class ye extends mt{constructor(Y,me,We,kt,_n,ti,Ei,Si){super(Y,_n,ti,Si),this.sharedStylesHost=me,this.hostEl=We,this.shadowRoot=We.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const ji=Ee(kt.id,kt.styles);for(const po of ji){const eo=document.createElement("style");Ei&&eo.setAttribute("nonce",Ei),eo.textContent=po,this.shadowRoot.appendChild(eo)}}nodeOrShadowRoot(Y){return Y===this.hostEl?this.shadowRoot:Y}appendChild(Y,me){return super.appendChild(this.nodeOrShadowRoot(Y),me)}insertBefore(Y,me,We){return super.insertBefore(this.nodeOrShadowRoot(Y),me,We)}removeChild(Y,me){return super.removeChild(this.nodeOrShadowRoot(Y),me)}parentNode(Y){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Y)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Qt extends mt{constructor(Y,me,We,kt,_n,ti,Ei,Si){super(Y,_n,ti,Ei),this.sharedStylesHost=me,this.removeStylesOnCompDestroy=kt,this.rendererUsageCount=0,this.styles=Si?Ee(Si,We.styles):We.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestroy&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class dt extends Qt{constructor(Y,me,We,kt,_n,ti,Ei,Si){const ji=kt+"-"+We.id;super(Y,me,We,_n,ti,Ei,Si,ji),this.contentAttr=function nt(Ve){return"_ngcontent-%COMP%".replace(Le,Ve)}(ji),this.hostAttr=function Xe(Ve){return"_nghost-%COMP%".replace(Le,Ve)}(ji)}applyToHost(Y){this.applyStyles(),this.setAttribute(Y,this.hostAttr,"")}createElement(Y,me){const We=super.createElement(Y,me);return super.setAttribute(We,this.contentAttr,""),We}}let gt=(()=>{class Ve extends se{constructor(me){super(me)}supports(me){return!0}addEventListener(me,We,kt){return me.addEventListener(We,kt,!1),()=>this.removeEventListener(me,We,kt)}removeEventListener(me,We,kt){return me.removeEventListener(We,kt)}}return Ve.\u0275fac=function(me){return new(me||Ve)(v.LFG(d.K0))},Ve.\u0275prov=v.Yz7({token:Ve,factory:Ve.\u0275fac}),Ve})();const ct=["alt","control","meta","shift"],Ue={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},vt={alt:Ve=>Ve.altKey,control:Ve=>Ve.ctrlKey,meta:Ve=>Ve.metaKey,shift:Ve=>Ve.shiftKey};let je=(()=>{class Ve extends se{constructor(me){super(me)}supports(me){return null!=Ve.parseEventName(me)}addEventListener(me,We,kt){const _n=Ve.parseEventName(We),ti=Ve.eventCallback(_n.fullKey,kt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,d.q)().onAndCancel(me,_n.domEventName,ti))}static parseEventName(me){const We=me.toLowerCase().split("."),kt=We.shift();if(0===We.length||"keydown"!==kt&&"keyup"!==kt)return null;const _n=Ve._normalizeKey(We.pop());let ti="",Ei=We.indexOf("code");if(Ei>-1&&(We.splice(Ei,1),ti="code."),ct.forEach(ji=>{const po=We.indexOf(ji);po>-1&&(We.splice(po,1),ti+=ji+".")}),ti+=_n,0!=We.length||0===_n.length)return null;const Si={};return Si.domEventName=kt,Si.fullKey=ti,Si}static matchEventFullKeyCode(me,We){let kt=Ue[me.key]||me.key,_n="";return We.indexOf("code.")>-1&&(kt=me.code,_n="code."),!(null==kt||!kt)&&(kt=kt.toLowerCase()," "===kt?kt="space":"."===kt&&(kt="dot"),ct.forEach(ti=>{ti!==kt&&(0,vt[ti])(me)&&(_n+=ti+".")}),_n+=kt,_n===We)}static eventCallback(me,We,kt){return _n=>{Ve.matchEventFullKeyCode(_n,me)&&kt.runGuarded(()=>We(_n))}}static _normalizeKey(me){return"esc"===me?"escape":me}}return Ve.\u0275fac=function(me){return new(me||Ve)(v.LFG(d.K0))},Ve.\u0275prov=v.Yz7({token:Ve,factory:Ve.\u0275fac}),Ve})();const Vt=(0,v.eFA)(v._c5,"browser",[{provide:v.Lbi,useValue:d.bD},{provide:v.g9A,useValue:function wn(){s.makeCurrent()},multi:!0},{provide:d.K0,useFactory:function mn(){return(0,v.RDi)(document),document},deps:[]}]),It=new v.OlP(""),at=[{provide:v.rWj,useClass:class fe{addToWindow(Y){v.dqk.getAngularTestability=(We,kt=!0)=>{const _n=Y.findTestabilityInTree(We,kt);if(null==_n)throw new v.vHH(5103,!1);return _n},v.dqk.getAllAngularTestabilities=()=>Y.getAllTestabilities(),v.dqk.getAllAngularRootElements=()=>Y.getAllRootElements(),v.dqk.frameworkStabilizers||(v.dqk.frameworkStabilizers=[]),v.dqk.frameworkStabilizers.push(We=>{const kt=v.dqk.getAllAngularTestabilities();let _n=kt.length,ti=!1;const Ei=function(Si){ti=ti||Si,_n--,0==_n&&We(ti)};kt.forEach(Si=>{Si.whenStable(Ei)})})}findTestabilityInTree(Y,me,We){return null==me?null:Y.getTestability(me)??(We?(0,d.q)().isShadowRoot(me)?this.findTestabilityInTree(Y,me.host,!0):this.findTestabilityInTree(Y,me.parentElement,!0):null)}},deps:[]},{provide:v.lri,useClass:v.dDg,deps:[v.R0b,v.eoX,v.rWj]},{provide:v.dDg,useClass:v.dDg,deps:[v.R0b,v.eoX,v.rWj]}],Wt=[{provide:v.zSh,useValue:"root"},{provide:v.qLn,useFactory:function Xt(){return new v.qLn},deps:[]},{provide:De,useClass:gt,multi:!0,deps:[d.K0,v.R0b,v.Lbi]},{provide:De,useClass:je,multi:!0,deps:[d.K0]},ae,ge,X,{provide:v.FYo,useExisting:ae},{provide:d.JF,useClass:Ae,deps:[]},[]];let dn=(()=>{class Ve{constructor(me){}static withServerTransition(me){return{ngModule:Ve,providers:[{provide:v.AFp,useValue:me.appId}]}}}return Ve.\u0275fac=function(me){return new(me||Ve)(v.LFG(It,12))},Ve.\u0275mod=v.oAB({type:Ve}),Ve.\u0275inj=v.cJS({providers:[...Wt,...at],imports:[d.ez,v.hGG]}),Ve})(),gn=(()=>{class Ve{constructor(me){this._doc=me}getTitle(){return this._doc.title}setTitle(me){this._doc.title=me||""}}return Ve.\u0275fac=function(me){return new(me||Ve)(v.LFG(d.K0))},Ve.\u0275prov=v.Yz7({token:Ve,factory:function(me){let We=null;return We=me?new me:function Gi(){return new gn((0,v.LFG)(d.K0))}(),We},providedIn:"root"}),Ve})();typeof window<"u"&&window},2125:(zn,Ct,R)=>{"use strict";R.d(Ct,{gz:()=>Oo,y6:()=>hr,OD:()=>Bt,eC:()=>Nt,wN:()=>fs,F0:()=>qo,rH:()=>Ka,Bz:()=>yu,Hx:()=>Ut});var v=R(2029),d=R(2664),y=R(7715),s=R(2096),Q=R(5619),ie=R(5592),W=R(7453),w=R(2737),fe=R(7400),Ae=R(4564),De=R(2714),X=R(8251),se=R(7103);function Te(...L){const B=(0,Ae.yG)(L),A=(0,Ae.jO)(L),{args:U,keys:le}=(0,W.D)(L);if(0===U.length)return(0,y.D)([],B);const Be=new ie.y(function ge(L,B,A=w.y){return U=>{we(B,()=>{const{length:le}=L,Be=new Array(le);let qe=le,Jt=le;for(let Rn=0;Rn<le;Rn++)we(B,()=>{const _i=(0,y.D)(L[Rn],B);let Ai=!1;_i.subscribe((0,X.x)(U,Mo=>{Be[Rn]=Mo,Ai||(Ai=!0,Jt--),Jt||U.next(A(Be.slice()))},()=>{--qe||U.complete()}))},U)},U)}}(U,B,le?qe=>(0,De.n)(le,qe):w.y));return A?Be.pipe((0,fe.Z)(A)):Be}function we(L,B,A){L?(0,se.f)(A,L,B):B()}const Me=(0,R(2306).d)(L=>function(){L(this),this.name="EmptyError",this.message="no elements in sequence"});var ze=R(5211),Ke=R(4911),Oe=R(8407),Ce=R(4674);function nt(L,B){const A=(0,Ce.m)(L)?L:()=>L,U=le=>le.error(A());return new ie.y(B?le=>B.schedule(U,0,le):U)}var Xe=R(6232),Ee=R(7394),ae=R(9360);function mt(){return(0,ae.e)((L,B)=>{let A=null;L._refCount++;const U=(0,X.x)(B,void 0,void 0,void 0,()=>{if(!L||L._refCount<=0||0<--L._refCount)return void(A=null);const le=L._connection,Be=A;A=null,le&&(!Be||le===Be)&&le.unsubscribe(),B.unsubscribe()});L.subscribe(U),U.closed||(A=L.connect())})}class xe extends ie.y{constructor(B,A){super(),this.source=B,this.subjectFactory=A,this._subject=null,this._refCount=0,this._connection=null,(0,ae.A)(B)&&(this.lift=B.lift)}_subscribe(B){return this.getSubject().subscribe(B)}getSubject(){const B=this._subject;return(!B||B.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:B}=this;this._subject=this._connection=null,B?.unsubscribe()}connect(){let B=this._connection;if(!B){B=this._connection=new Ee.w0;const A=this.getSubject();B.add(this.source.subscribe((0,X.x)(A,void 0,()=>{this._teardown(),A.complete()},U=>{this._teardown(),A.error(U)},()=>this._teardown()))),B.closed&&(this._connection=null,B=Ee.w0.EMPTY)}return B}refCount(){return mt()(this)}}var Ze=R(8645),Se=R(6814),ye=R(7398),Qt=R(4664),dt=R(8180),ct=R(2181),Ue=R(1631);function vt(L){return(0,ae.e)((B,A)=>{let U=!1;B.subscribe((0,X.x)(A,le=>{U=!0,A.next(le)},()=>{U||A.next(L),A.complete()}))})}function je(L=_t){return(0,ae.e)((B,A)=>{let U=!1;B.subscribe((0,X.x)(A,le=>{U=!0,A.next(le)},()=>U?A.complete():A.error(L())))})}function _t(){return new Me}function Ne(L,B){const A=arguments.length>=2;return U=>U.pipe(L?(0,ct.h)((le,Be)=>L(le,Be,U)):w.y,(0,dt.q)(1),A?vt(B):je(()=>new Me))}var Ft=R(6328);function Gt(L,B,A){const U=(0,Ce.m)(L)||B||A?{next:L,error:B,complete:A}:L;return U?(0,ae.e)((le,Be)=>{var qe;null===(qe=U.subscribe)||void 0===qe||qe.call(U);let Jt=!0;le.subscribe((0,X.x)(Be,Rn=>{var _i;null===(_i=U.next)||void 0===_i||_i.call(U,Rn),Be.next(Rn)},()=>{var Rn;Jt=!1,null===(Rn=U.complete)||void 0===Rn||Rn.call(U),Be.complete()},Rn=>{var _i;Jt=!1,null===(_i=U.error)||void 0===_i||_i.call(U,Rn),Be.error(Rn)},()=>{var Rn,_i;Jt&&(null===(Rn=U.unsubscribe)||void 0===Rn||Rn.call(U)),null===(_i=U.finalize)||void 0===_i||_i.call(U)}))}):w.y}var wn=R(4829);function Xt(L){return(0,ae.e)((B,A)=>{let Be,U=null,le=!1;U=B.subscribe((0,X.x)(A,void 0,void 0,qe=>{Be=(0,wn.Xf)(L(qe,Xt(L)(B))),U?(U.unsubscribe(),U=null,Be.subscribe(A)):le=!0})),le&&(U.unsubscribe(),U=null,Be.subscribe(A))})}function Vt(L){return L<=0?()=>Xe.E:(0,ae.e)((B,A)=>{let U=[];B.subscribe((0,X.x)(A,le=>{U.push(le),L<U.length&&U.shift()},()=>{for(const le of U)A.next(le);A.complete()},void 0,()=>{U=null}))})}var Wt=R(4716),dn=R(7537),Sn=R(6593);const Nt="primary",yi=Symbol("RouteTitle");class Gi{constructor(B){this.params=B||{}}has(B){return Object.prototype.hasOwnProperty.call(this.params,B)}get(B){if(this.has(B)){const A=this.params[B];return Array.isArray(A)?A[0]:A}return null}getAll(B){if(this.has(B)){const A=this.params[B];return Array.isArray(A)?A:[A]}return[]}get keys(){return Object.keys(this.params)}}function gn(L){return new Gi(L)}function si(L,B,A){const U=A.path.split("/");if(U.length>L.length||"full"===A.pathMatch&&(B.hasChildren()||U.length<L.length))return null;const le={};for(let Be=0;Be<U.length;Be++){const qe=U[Be],Jt=L[Be];if(qe.startsWith(":"))le[qe.substring(1)]=Jt;else if(qe!==Jt.path)return null}return{consumed:L.slice(0,U.length),posParams:le}}function At(L,B){const A=L?Object.keys(L):void 0,U=B?Object.keys(B):void 0;if(!A||!U||A.length!=U.length)return!1;let le;for(let Be=0;Be<A.length;Be++)if(le=A[Be],!Zt(L[le],B[le]))return!1;return!0}function Zt(L,B){if(Array.isArray(L)&&Array.isArray(B)){if(L.length!==B.length)return!1;const A=[...L].sort(),U=[...B].sort();return A.every((le,Be)=>U[Be]===le)}return L===B}function un(L){return L.length>0?L[L.length-1]:null}function hn(L){return(0,d.b)(L)?L:(0,v.QGY)(L)?(0,y.D)(Promise.resolve(L)):(0,s.of)(L)}const gi={exact:function Ci(L,B,A){if(!yt(L.segments,B.segments)||!Vo(L.segments,B.segments,A)||L.numberOfChildren!==B.numberOfChildren)return!1;for(const U in B.children)if(!L.children[U]||!Ci(L.children[U],B.children[U],A))return!1;return!0},subset:Po},Yt={exact:function oi(L,B){return At(L,B)},subset:function Oi(L,B){return Object.keys(B).length<=Object.keys(L).length&&Object.keys(B).every(A=>Zt(L[A],B[A]))},ignored:()=>!0};function Un(L,B,A){return gi[A.paths](L.root,B.root,A.matrixParams)&&Yt[A.queryParams](L.queryParams,B.queryParams)&&!("exact"===A.fragment&&L.fragment!==B.fragment)}function Po(L,B,A){return fi(L,B,B.segments,A)}function fi(L,B,A,U){if(L.segments.length>A.length){const le=L.segments.slice(0,A.length);return!(!yt(le,A)||B.hasChildren()||!Vo(le,A,U))}if(L.segments.length===A.length){if(!yt(L.segments,A)||!Vo(L.segments,A,U))return!1;for(const le in B.children)if(!L.children[le]||!Po(L.children[le],B.children[le],U))return!1;return!0}{const le=A.slice(0,L.segments.length),Be=A.slice(L.segments.length);return!!(yt(L.segments,le)&&Vo(L.segments,le,U)&&L.children[Nt])&&fi(L.children[Nt],B,Be,U)}}function Vo(L,B,A){return B.every((U,le)=>Yt[A](L[le].parameters,U.parameters))}class ut{constructor(B=new pe([],{}),A={},U=null){this.root=B,this.queryParams=A,this.fragment=U}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gn(this.queryParams)),this._queryParamMap}toString(){return St.serialize(this)}}class pe{constructor(B,A){this.segments=B,this.children=A,this.parent=null,Object.values(A).forEach(U=>U.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Kt(this)}}class ve{constructor(B,A){this.path=B,this.parameters=A}get parameterMap(){return this._parameterMap||(this._parameterMap=gn(this.parameters)),this._parameterMap}toString(){return _n(this)}}function yt(L,B){return L.length===B.length&&L.every((A,U)=>A.path===B[U].path)}let Ut=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:function(){return new jt},providedIn:"root"}),L})();class jt{parse(B){const A=new Pn(B);return new ut(A.parseRootSegment(),A.parseQueryParams(),A.parseFragment())}serialize(B){const A=`/${In(B.root,!0)}`,U=function Ei(L){const B=Object.keys(L).map(A=>{const U=L[A];return Array.isArray(U)?U.map(le=>`${Ve(A)}=${Ve(le)}`).join("&"):`${Ve(A)}=${Ve(U)}`}).filter(A=>!!A);return B.length?`?${B.join("&")}`:""}(B.queryParams);return`${A}${U}${"string"==typeof B.fragment?`#${function Y(L){return encodeURI(L)}(B.fragment)}`:""}`}}const St=new jt;function Kt(L){return L.segments.map(B=>_n(B)).join("/")}function In(L,B){if(!L.hasChildren())return Kt(L);if(B){const A=L.children[Nt]?In(L.children[Nt],!1):"",U=[];return Object.entries(L.children).forEach(([le,Be])=>{le!==Nt&&U.push(`${le}:${In(Be,!1)}`)}),U.length>0?`${A}(${U.join("//")})`:A}{const A=function Rt(L,B){let A=[];return Object.entries(L.children).forEach(([U,le])=>{U===Nt&&(A=A.concat(B(le,U)))}),Object.entries(L.children).forEach(([U,le])=>{U!==Nt&&(A=A.concat(B(le,U)))}),A}(L,(U,le)=>le===Nt?[In(L.children[Nt],!1)]:[`${le}:${In(U,!1)}`]);return 1===Object.keys(L.children).length&&null!=L.children[Nt]?`${Kt(L)}/${A[0]}`:`${Kt(L)}/(${A.join("//")})`}}function tt(L){return encodeURIComponent(L).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ve(L){return tt(L).replace(/%3B/gi,";")}function me(L){return tt(L).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function We(L){return decodeURIComponent(L)}function kt(L){return We(L.replace(/\+/g,"%20"))}function _n(L){return`${me(L.path)}${function ti(L){return Object.keys(L).map(B=>`;${me(B)}=${me(L[B])}`).join("")}(L.parameters)}`}const Si=/^[^\/()?;#]+/;function ji(L){const B=L.match(Si);return B?B[0]:""}const po=/^[^\/()?;=#]+/,tn=/^[^=?&#]+/,Et=/^[^&#]+/;class Pn{constructor(B){this.url=B,this.remaining=B}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new pe([],{}):new pe([],this.parseChildren())}parseQueryParams(){const B={};if(this.consumeOptional("?"))do{this.parseQueryParam(B)}while(this.consumeOptional("&"));return B}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const B=[];for(this.peekStartsWith("(")||B.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),B.push(this.parseSegment());let A={};this.peekStartsWith("/(")&&(this.capture("/"),A=this.parseParens(!0));let U={};return this.peekStartsWith("(")&&(U=this.parseParens(!1)),(B.length>0||Object.keys(A).length>0)&&(U[Nt]=new pe(B,A)),U}parseSegment(){const B=ji(this.remaining);if(""===B&&this.peekStartsWith(";"))throw new v.vHH(4009,!1);return this.capture(B),new ve(We(B),this.parseMatrixParams())}parseMatrixParams(){const B={};for(;this.consumeOptional(";");)this.parseParam(B);return B}parseParam(B){const A=function eo(L){const B=L.match(po);return B?B[0]:""}(this.remaining);if(!A)return;this.capture(A);let U="";if(this.consumeOptional("=")){const le=ji(this.remaining);le&&(U=le,this.capture(U))}B[We(A)]=We(U)}parseQueryParam(B){const A=function xt(L){const B=L.match(tn);return B?B[0]:""}(this.remaining);if(!A)return;this.capture(A);let U="";if(this.consumeOptional("=")){const qe=function Nn(L){const B=L.match(Et);return B?B[0]:""}(this.remaining);qe&&(U=qe,this.capture(U))}const le=kt(A),Be=kt(U);if(B.hasOwnProperty(le)){let qe=B[le];Array.isArray(qe)||(qe=[qe],B[le]=qe),qe.push(Be)}else B[le]=Be}parseParens(B){const A={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const U=ji(this.remaining),le=this.remaining[U.length];if("/"!==le&&")"!==le&&";"!==le)throw new v.vHH(4010,!1);let Be;U.indexOf(":")>-1?(Be=U.slice(0,U.indexOf(":")),this.capture(Be),this.capture(":")):B&&(Be=Nt);const qe=this.parseChildren();A[Be]=1===Object.keys(qe).length?qe[Nt]:new pe([],qe),this.consumeOptional("//")}return A}peekStartsWith(B){return this.remaining.startsWith(B)}consumeOptional(B){return!!this.peekStartsWith(B)&&(this.remaining=this.remaining.substring(B.length),!0)}capture(B){if(!this.consumeOptional(B))throw new v.vHH(4011,!1)}}function ri(L){return L.segments.length>0?new pe([],{[Nt]:L}):L}function ni(L){const B={};for(const U of Object.keys(L.children)){const Be=ni(L.children[U]);if(U===Nt&&0===Be.segments.length&&Be.hasChildren())for(const[qe,Jt]of Object.entries(Be.children))B[qe]=Jt;else(Be.segments.length>0||Be.hasChildren())&&(B[U]=Be)}return function qi(L){if(1===L.numberOfChildren&&L.children[Nt]){const B=L.children[Nt];return new pe(L.segments.concat(B.segments),B.children)}return L}(new pe(L.segments,B))}function wi(L){return L instanceof ut}function Ao(L){let B;const le=ri(function A(Be){const qe={};for(const Rn of Be.children){const _i=A(Rn);qe[Rn.outlet]=_i}const Jt=new pe(Be.url,qe);return Be===L&&(B=Jt),Jt}(L.root));return B??le}function Go(L,B,A,U){let le=L;for(;le.parent;)le=le.parent;if(0===B.length)return Pi(le,le,le,A,U);const Be=function Qo(L){if("string"==typeof L[0]&&1===L.length&&"/"===L[0])return new en(!0,0,L);let B=0,A=!1;const U=L.reduce((le,Be,qe)=>{if("object"==typeof Be&&null!=Be){if(Be.outlets){const Jt={};return Object.entries(Be.outlets).forEach(([Rn,_i])=>{Jt[Rn]="string"==typeof _i?_i.split("/"):_i}),[...le,{outlets:Jt}]}if(Be.segmentPath)return[...le,Be.segmentPath]}return"string"!=typeof Be?[...le,Be]:0===qe?(Be.split("/").forEach((Jt,Rn)=>{0==Rn&&"."===Jt||(0==Rn&&""===Jt?A=!0:".."===Jt?B++:""!=Jt&&le.push(Jt))}),le):[...le,Be]},[]);return new en(A,B,U)}(B);if(Be.toRoot())return Pi(le,le,new pe([],{}),A,U);const qe=function Ji(L,B,A){if(L.isAbsolute)return new vo(B,!0,0);if(!A)return new vo(B,!1,NaN);if(null===A.parent)return new vo(A,!0,0);const U=co(L.commands[0])?0:1;return function gr(L,B,A){let U=L,le=B,Be=A;for(;Be>le;){if(Be-=le,U=U.parent,!U)throw new v.vHH(4005,!1);le=U.segments.length}return new vo(U,!1,le-Be)}(A,A.segments.length-1+U,L.numberOfDoubleDots)}(Be,le,L),Jt=qe.processChildren?Mr(qe.segmentGroup,qe.index,Be.commands):Zr(qe.segmentGroup,qe.index,Be.commands);return Pi(le,qe.segmentGroup,Jt,A,U)}function co(L){return"object"==typeof L&&null!=L&&!L.outlets&&!L.segmentPath}function io(L){return"object"==typeof L&&null!=L&&L.outlets}function Pi(L,B,A,U,le){let qe,Be={};U&&Object.entries(U).forEach(([Rn,_i])=>{Be[Rn]=Array.isArray(_i)?_i.map(Ai=>`${Ai}`):`${_i}`}),qe=L===B?A:uo(L,B,A);const Jt=ri(ni(qe));return new ut(Jt,Be,le)}function uo(L,B,A){const U={};return Object.entries(L.children).forEach(([le,Be])=>{U[le]=Be===B?A:uo(Be,B,A)}),new pe(L.segments,U)}class en{constructor(B,A,U){if(this.isAbsolute=B,this.numberOfDoubleDots=A,this.commands=U,B&&U.length>0&&co(U[0]))throw new v.vHH(4003,!1);const le=U.find(io);if(le&&le!==un(U))throw new v.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class vo{constructor(B,A,U){this.segmentGroup=B,this.processChildren=A,this.index=U}}function Zr(L,B,A){if(L||(L=new pe([],{})),0===L.segments.length&&L.hasChildren())return Mr(L,B,A);const U=function kr(L,B,A){let U=0,le=B;const Be={match:!1,pathIndex:0,commandIndex:0};for(;le<L.segments.length;){if(U>=A.length)return Be;const qe=L.segments[le],Jt=A[U];if(io(Jt))break;const Rn=`${Jt}`,_i=U<A.length-1?A[U+1]:null;if(le>0&&void 0===Rn)break;if(Rn&&_i&&"object"==typeof _i&&void 0===_i.outlets){if(!st(Rn,_i,qe))return Be;U+=2}else{if(!st(Rn,{},qe))return Be;U++}le++}return{match:!0,pathIndex:le,commandIndex:U}}(L,B,A),le=A.slice(U.commandIndex);if(U.match&&U.pathIndex<L.segments.length){const Be=new pe(L.segments.slice(0,U.pathIndex),{});return Be.children[Nt]=new pe(L.segments.slice(U.pathIndex),L.children),Mr(Be,0,le)}return U.match&&0===le.length?new pe(L.segments,{}):U.match&&!L.hasChildren()?ei(L,B,A):U.match?Mr(L,0,le):ei(L,B,A)}function Mr(L,B,A){if(0===A.length)return new pe(L.segments,{});{const U=function xo(L){return io(L[0])?L[0].outlets:{[Nt]:L}}(A),le={};if(!U[Nt]&&L.children[Nt]&&1===L.numberOfChildren&&0===L.children[Nt].segments.length){const Be=Mr(L.children[Nt],B,A);return new pe(L.segments,Be.children)}return Object.entries(U).forEach(([Be,qe])=>{"string"==typeof qe&&(qe=[qe]),null!==qe&&(le[Be]=Zr(L.children[Be],B,qe))}),Object.entries(L.children).forEach(([Be,qe])=>{void 0===U[Be]&&(le[Be]=qe)}),new pe(L.segments,le)}}function ei(L,B,A){const U=L.segments.slice(0,B);let le=0;for(;le<A.length;){const Be=A[le];if(io(Be)){const Rn=Vi(Be.outlets);return new pe(U,Rn)}if(0===le&&co(A[0])){U.push(new ve(L.segments[B].path,_e(A[0]))),le++;continue}const qe=io(Be)?Be.outlets[Nt]:`${Be}`,Jt=le<A.length-1?A[le+1]:null;qe&&Jt&&co(Jt)?(U.push(new ve(qe,_e(Jt))),le+=2):(U.push(new ve(qe,{})),le++)}return new pe(U,{})}function Vi(L){const B={};return Object.entries(L).forEach(([A,U])=>{"string"==typeof U&&(U=[U]),null!==U&&(B[A]=ei(new pe([],{}),0,U))}),B}function _e(L){const B={};return Object.entries(L).forEach(([A,U])=>B[A]=`${U}`),B}function st(L,B,A){return L==A.path&&At(B,A.parameters)}const ke="imperative";class it{constructor(B,A){this.id=B,this.url=A}}class Bt extends it{constructor(B,A,U="imperative",le=null){super(B,A),this.type=0,this.navigationTrigger=U,this.restoredState=le}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class zt extends it{constructor(B,A,U){super(B,A),this.urlAfterRedirects=U,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class yn extends it{constructor(B,A,U,le){super(B,A),this.reason=U,this.code=le,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Tn extends it{constructor(B,A,U,le){super(B,A),this.reason=U,this.code=le,this.type=16}}class xn extends it{constructor(B,A,U,le){super(B,A),this.error=U,this.target=le,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class On extends it{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hi extends it{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Ii extends it{constructor(B,A,U,le,Be){super(B,A),this.urlAfterRedirects=U,this.state=le,this.shouldActivate=Be,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class zi extends it{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Lo extends it{constructor(B,A,U,le){super(B,A),this.urlAfterRedirects=U,this.state=le,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xi{constructor(B){this.route=B,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class so{constructor(B){this.route=B,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class To{constructor(B){this.snapshot=B,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class or{constructor(B){this.snapshot=B,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Wo{constructor(B){this.snapshot=B,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class dr{constructor(B){this.snapshot=B,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class wo{constructor(B,A,U){this.routerEvent=B,this.position=A,this.anchor=U,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class ea{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new hr,this.attachRef=null}}let hr=(()=>{class L{constructor(){this.contexts=new Map}onChildOutletCreated(A,U){const le=this.getOrCreateContext(A);le.outlet=U,this.contexts.set(A,le)}onChildOutletDestroyed(A){const U=this.getContext(A);U&&(U.outlet=null,U.attachRef=null)}onOutletDeactivated(){const A=this.contexts;return this.contexts=new Map,A}onOutletReAttached(A){this.contexts=A}getOrCreateContext(A){let U=this.getContext(A);return U||(U=new ea,this.contexts.set(A,U)),U}getContext(A){return this.contexts.get(A)||null}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();class bo{constructor(B){this._root=B}get root(){return this._root.value}parent(B){const A=this.pathFromRoot(B);return A.length>1?A[A.length-2]:null}children(B){const A=mi(B,this._root);return A?A.children.map(U=>U.value):[]}firstChild(B){const A=mi(B,this._root);return A&&A.children.length>0?A.children[0].value:null}siblings(B){const A=Fi(B,this._root);return A.length<2?[]:A[A.length-2].children.map(le=>le.value).filter(le=>le!==B)}pathFromRoot(B){return Fi(B,this._root).map(A=>A.value)}}function mi(L,B){if(L===B.value)return B;for(const A of B.children){const U=mi(L,A);if(U)return U}return null}function Fi(L,B){if(L===B.value)return[B];for(const A of B.children){const U=Fi(L,A);if(U.length)return U.unshift(B),U}return[]}class Bi{constructor(B,A){this.value=B,this.children=A}toString(){return`TreeNode(${this.value})`}}function er(L){const B={};return L&&L.children.forEach(A=>B[A.value.outlet]=A),B}class is extends bo{constructor(B,A){super(B),this.snapshot=A,ta(this,B)}toString(){return this.snapshot.toString()}}function jo(L,B){const A=function Jo(L,B){const qe=new Ri([],{},{},"",{},Nt,B,null,{});return new us("",new Bi(qe,[]))}(0,B),U=new Q.X([new ve("",{})]),le=new Q.X({}),Be=new Q.X({}),qe=new Q.X({}),Jt=new Q.X(""),Rn=new Oo(U,le,qe,Jt,Be,Nt,B,A.root);return Rn.snapshot=A.root,new is(new Bi(Rn,[]),A)}class Oo{constructor(B,A,U,le,Be,qe,Jt,Rn){this.urlSubject=B,this.paramsSubject=A,this.queryParamsSubject=U,this.fragmentSubject=le,this.dataSubject=Be,this.outlet=qe,this.component=Jt,this._futureSnapshot=Rn,this.title=this.dataSubject?.pipe((0,ye.U)(_i=>_i[yi]))??(0,s.of)(void 0),this.url=B,this.params=A,this.queryParams=U,this.fragment=le,this.data=Be}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,ye.U)(B=>gn(B)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,ye.U)(B=>gn(B)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Ur(L,B="emptyOnly"){const A=L.pathFromRoot;let U=0;if("always"!==B)for(U=A.length-1;U>=1;){const le=A[U],Be=A[U-1];if(le.routeConfig&&""===le.routeConfig.path)U--;else{if(Be.component)break;U--}}return function xr(L){return L.reduce((B,A)=>({params:{...B.params,...A.params},data:{...B.data,...A.data},resolve:{...A.data,...B.resolve,...A.routeConfig?.data,...A._resolvedData}}),{params:{},data:{},resolve:{}})}(A.slice(U))}class Ri{get title(){return this.data?.[yi]}constructor(B,A,U,le,Be,qe,Jt,Rn,_i){this.url=B,this.params=A,this.queryParams=U,this.fragment=le,this.data=Be,this.outlet=qe,this.component=Jt,this.routeConfig=Rn,this._resolve=_i}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=gn(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=gn(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(U=>U.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class us extends bo{constructor(B,A){super(A),this.url=B,ta(this,A)}toString(){return Xr(this._root)}}function ta(L,B){B.value._routerState=L,B.children.forEach(A=>ta(L,A))}function Xr(L){const B=L.children.length>0?` { ${L.children.map(Xr).join(", ")} } `:"";return`${L.value}${B}`}function ko(L){if(L.snapshot){const B=L.snapshot,A=L._futureSnapshot;L.snapshot=A,At(B.queryParams,A.queryParams)||L.queryParamsSubject.next(A.queryParams),B.fragment!==A.fragment&&L.fragmentSubject.next(A.fragment),At(B.params,A.params)||L.paramsSubject.next(A.params),function Je(L,B){if(L.length!==B.length)return!1;for(let A=0;A<L.length;++A)if(!At(L[A],B[A]))return!1;return!0}(B.url,A.url)||L.urlSubject.next(A.url),At(B.data,A.data)||L.dataSubject.next(A.data)}else L.snapshot=L._futureSnapshot,L.dataSubject.next(L._futureSnapshot.data)}function Ir(L,B){const A=At(L.params,B.params)&&function et(L,B){return yt(L,B)&&L.every((A,U)=>At(A.parameters,B[U].parameters))}(L.url,B.url);return A&&!(!L.parent!=!B.parent)&&(!L.parent||Ir(L.parent,B.parent))}let Fr=(()=>{class L{constructor(){this.activated=null,this._activatedRoute=null,this.name=Nt,this.activateEvents=new v.vpe,this.deactivateEvents=new v.vpe,this.attachEvents=new v.vpe,this.detachEvents=new v.vpe,this.parentContexts=(0,v.f3M)(hr),this.location=(0,v.f3M)(v.s_b),this.changeDetector=(0,v.f3M)(v.sBO),this.environmentInjector=(0,v.f3M)(v.lqb),this.inputBinder=(0,v.f3M)(br,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(A){if(A.name){const{firstChange:U,previousValue:le}=A.name;if(U)return;this.isTrackedInParentContexts(le)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(le)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(A){return this.parentContexts.getContext(A)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const A=this.parentContexts.getContext(this.name);A?.route&&(A.attachRef?this.attach(A.attachRef,A.route):this.activateWith(A.route,A.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new v.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new v.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new v.vHH(4012,!1);this.location.detach();const A=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(A.instance),A}attach(A,U){this.activated=A,this._activatedRoute=U,this.location.insert(A.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(A.instance)}deactivate(){if(this.activated){const A=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(A)}}activateWith(A,U){if(this.isActivated)throw new v.vHH(4013,!1);this._activatedRoute=A;const le=this.location,qe=A.snapshot.component,Jt=this.parentContexts.getOrCreateContext(this.name).children,Rn=new Br(A,Jt,le.injector);this.activated=le.createComponent(qe,{index:le.length,injector:Rn,environmentInjector:U??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275dir=v.lG2({type:L,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[v.TTD]}),L})();class Br{constructor(B,A,U){this.route=B,this.childContexts=A,this.parent=U}get(B,A){return B===Oo?this.route:B===hr?this.childContexts:this.parent.get(B,A)}}const br=new v.OlP("");let bs=(()=>{class L{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(A){this.unsubscribeFromRouteData(A),this.subscribeToRouteData(A)}unsubscribeFromRouteData(A){this.outletDataSubscriptions.get(A)?.unsubscribe(),this.outletDataSubscriptions.delete(A)}subscribeToRouteData(A){const{activatedRoute:U}=A,le=Te([U.queryParams,U.params,U.data]).pipe((0,Qt.w)(([Be,qe,Jt],Rn)=>(Jt={...Be,...qe,...Jt},0===Rn?(0,s.of)(Jt):Promise.resolve(Jt)))).subscribe(Be=>{if(!A.isActivated||!A.activatedComponentRef||A.activatedRoute!==U||null===U.component)return void this.unsubscribeFromRouteData(A);const qe=(0,v.qFp)(U.component);if(qe)for(const{templateName:Jt}of qe.inputs)A.activatedComponentRef.setInput(Jt,Be[Jt]);else this.unsubscribeFromRouteData(A)});this.outletDataSubscriptions.set(A,le)}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac}),L})();function Ar(L,B,A){if(A&&L.shouldReuseRoute(B.value,A.value.snapshot)){const U=A.value;U._futureSnapshot=B.value;const le=function Qr(L,B,A){return B.children.map(U=>{for(const le of A.children)if(L.shouldReuseRoute(U.value,le.value.snapshot))return Ar(L,U,le);return Ar(L,U)})}(L,B,A);return new Bi(U,le)}{if(L.shouldAttach(B.value)){const Be=L.retrieve(B.value);if(null!==Be){const qe=Be.route;return qe.value._futureSnapshot=B.value,qe.children=B.children.map(Jt=>Ar(L,Jt)),qe}}const U=function ws(L){return new Oo(new Q.X(L.url),new Q.X(L.params),new Q.X(L.queryParams),new Q.X(L.fragment),new Q.X(L.data),L.outlet,L.component,L)}(B.value),le=B.children.map(Be=>Ar(L,Be));return new Bi(U,le)}}const Qi="ngNavigationCancelingError";function ds(L,B){const{redirectTo:A,navigationBehaviorOptions:U}=wi(B)?{redirectTo:B,navigationBehaviorOptions:void 0}:B,le=na(!1,0,B);return le.url=A,le.navigationBehaviorOptions=U,le}function na(L,B,A){const U=new Error("NavigationCancelingError: "+(L||""));return U[Qi]=!0,U.cancellationCode=B,A&&(U.url=A),U}function Ss(L){return Sr(L)&&wi(L.url)}function Sr(L){return L&&L[Qi]}let ao=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275cmp=v.Xpm({type:L,selectors:[["ng-component"]],standalone:!0,features:[v.jDz],decls:1,vars:0,template:function(A,U){1&A&&v._UZ(0,"router-outlet")},dependencies:[Fr],encapsulation:2}),L})();function pr(L){const B=L.children&&L.children.map(pr),A=B?{...L,children:B}:{...L};return!A.component&&!A.loadComponent&&(B||A.loadChildren)&&A.outlet&&A.outlet!==Nt&&(A.component=ao),A}function Tr(L){return L.outlet||Nt}function oa(L){if(!L)return null;if(L.routeConfig?._injector)return L.routeConfig._injector;for(let B=L.parent;B;B=B.parent){const A=B.routeConfig;if(A?._loadedInjector)return A._loadedInjector;if(A?._injector)return A._injector}return null}class P{constructor(B,A,U,le,Be){this.routeReuseStrategy=B,this.futureState=A,this.currState=U,this.forwardEvent=le,this.inputBindingEnabled=Be}activate(B){const A=this.futureState._root,U=this.currState?this.currState._root:null;this.deactivateChildRoutes(A,U,B),ko(this.futureState.root),this.activateChildRoutes(A,U,B)}deactivateChildRoutes(B,A,U){const le=er(A);B.children.forEach(Be=>{const qe=Be.value.outlet;this.deactivateRoutes(Be,le[qe],U),delete le[qe]}),Object.values(le).forEach(Be=>{this.deactivateRouteAndItsChildren(Be,U)})}deactivateRoutes(B,A,U){const le=B.value,Be=A?A.value:null;if(le===Be)if(le.component){const qe=U.getContext(le.outlet);qe&&this.deactivateChildRoutes(B,A,qe.children)}else this.deactivateChildRoutes(B,A,U);else Be&&this.deactivateRouteAndItsChildren(A,U)}deactivateRouteAndItsChildren(B,A){B.value.component&&this.routeReuseStrategy.shouldDetach(B.value.snapshot)?this.detachAndStoreRouteSubtree(B,A):this.deactivateRouteAndOutlet(B,A)}detachAndStoreRouteSubtree(B,A){const U=A.getContext(B.value.outlet),le=U&&B.value.component?U.children:A,Be=er(B);for(const qe of Object.keys(Be))this.deactivateRouteAndItsChildren(Be[qe],le);if(U&&U.outlet){const qe=U.outlet.detach(),Jt=U.children.onOutletDeactivated();this.routeReuseStrategy.store(B.value.snapshot,{componentRef:qe,route:B,contexts:Jt})}}deactivateRouteAndOutlet(B,A){const U=A.getContext(B.value.outlet),le=U&&B.value.component?U.children:A,Be=er(B);for(const qe of Object.keys(Be))this.deactivateRouteAndItsChildren(Be[qe],le);U&&(U.outlet&&(U.outlet.deactivate(),U.children.onOutletDeactivated()),U.attachRef=null,U.route=null)}activateChildRoutes(B,A,U){const le=er(A);B.children.forEach(Be=>{this.activateRoutes(Be,le[Be.value.outlet],U),this.forwardEvent(new dr(Be.value.snapshot))}),B.children.length&&this.forwardEvent(new or(B.value.snapshot))}activateRoutes(B,A,U){const le=B.value,Be=A?A.value:null;if(ko(le),le===Be)if(le.component){const qe=U.getOrCreateContext(le.outlet);this.activateChildRoutes(B,A,qe.children)}else this.activateChildRoutes(B,A,U);else if(le.component){const qe=U.getOrCreateContext(le.outlet);if(this.routeReuseStrategy.shouldAttach(le.snapshot)){const Jt=this.routeReuseStrategy.retrieve(le.snapshot);this.routeReuseStrategy.store(le.snapshot,null),qe.children.onOutletReAttached(Jt.contexts),qe.attachRef=Jt.componentRef,qe.route=Jt.route.value,qe.outlet&&qe.outlet.attach(Jt.componentRef,Jt.route.value),ko(Jt.route.value),this.activateChildRoutes(B,null,qe.children)}else{const Jt=oa(le.snapshot);qe.attachRef=null,qe.route=le,qe.injector=Jt,qe.outlet&&qe.outlet.activateWith(le,qe.injector),this.activateChildRoutes(B,null,qe.children)}}else this.activateChildRoutes(B,null,U)}}class ne{constructor(B){this.path=B,this.route=this.path[this.path.length-1]}}class Ge{constructor(B,A){this.component=B,this.route=A}}function Ln(L,B,A){const U=L._root;return ee(U,B?B._root:null,A,[U.value])}function Zi(L,B){const A=Symbol(),U=B.get(L,A);return U===A?"function"!=typeof L||(0,v.Z0I)(L)?B.get(L):L:U}function ee(L,B,A,U,le={canDeactivateChecks:[],canActivateChecks:[]}){const Be=er(B);return L.children.forEach(qe=>{(function J(L,B,A,U,le={canDeactivateChecks:[],canActivateChecks:[]}){const Be=L.value,qe=B?B.value:null,Jt=A?A.getContext(L.value.outlet):null;if(qe&&Be.routeConfig===qe.routeConfig){const Rn=function G(L,B,A){if("function"==typeof A)return A(L,B);switch(A){case"pathParamsChange":return!yt(L.url,B.url);case"pathParamsOrQueryParamsChange":return!yt(L.url,B.url)||!At(L.queryParams,B.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!Ir(L,B)||!At(L.queryParams,B.queryParams);default:return!Ir(L,B)}}(qe,Be,Be.routeConfig.runGuardsAndResolvers);Rn?le.canActivateChecks.push(new ne(U)):(Be.data=qe.data,Be._resolvedData=qe._resolvedData),ee(L,B,Be.component?Jt?Jt.children:null:A,U,le),Rn&&Jt&&Jt.outlet&&Jt.outlet.isActivated&&le.canDeactivateChecks.push(new Ge(Jt.outlet.component,qe))}else qe&&Fe(B,Jt,le),le.canActivateChecks.push(new ne(U)),ee(L,null,Be.component?Jt?Jt.children:null:A,U,le)})(qe,Be[qe.value.outlet],A,U.concat([qe.value]),le),delete Be[qe.value.outlet]}),Object.entries(Be).forEach(([qe,Jt])=>Fe(Jt,A.getContext(qe),le)),le}function Fe(L,B,A){const U=er(L),le=L.value;Object.entries(U).forEach(([Be,qe])=>{Fe(qe,le.component?B?B.children.getContext(Be):null:B,A)}),A.canDeactivateChecks.push(new Ge(le.component&&B&&B.outlet&&B.outlet.isActivated?B.outlet.component:null,le))}function bn(L){return"function"==typeof L}function Ll(L){return L instanceof Me||"EmptyError"===L?.name}const rc=Symbol("INITIAL_VALUE");function Os(){return(0,Qt.w)(L=>Te(L.map(B=>B.pipe((0,dt.q)(1),function gt(...L){const B=(0,Ae.yG)(L);return(0,ae.e)((A,U)=>{(B?(0,ze.z)(L,A,B):(0,ze.z)(L,A)).subscribe(U)})}(rc)))).pipe((0,ye.U)(B=>{for(const A of B)if(!0!==A){if(A===rc)return rc;if(!1===A||A instanceof ut)return A}return!0}),(0,ct.h)(B=>B!==rc),(0,dt.q)(1)))}function pl(L){return(0,Oe.z)(Gt(B=>{if(wi(B))throw ds(0,B)}),(0,ye.U)(B=>!0===B))}class pa{constructor(B){this.segmentGroup=B||null}}class fa{constructor(B){this.urlTree=B}}function Es(L){return nt(new pa(L))}function sc(L){return nt(new fa(L))}class fl{constructor(B,A){this.urlSerializer=B,this.urlTree=A}noMatchError(B){return new v.vHH(4002,!1)}lineralizeSegments(B,A){let U=[],le=A.root;for(;;){if(U=U.concat(le.segments),0===le.numberOfChildren)return(0,s.of)(U);if(le.numberOfChildren>1||!le.children[Nt])return nt(new v.vHH(4e3,!1));le=le.children[Nt]}}applyRedirectCommands(B,A,U){return this.applyRedirectCreateUrlTree(A,this.urlSerializer.parse(A),B,U)}applyRedirectCreateUrlTree(B,A,U,le){const Be=this.createSegmentGroup(B,A.root,U,le);return new ut(Be,this.createQueryParams(A.queryParams,this.urlTree.queryParams),A.fragment)}createQueryParams(B,A){const U={};return Object.entries(B).forEach(([le,Be])=>{if("string"==typeof Be&&Be.startsWith(":")){const Jt=Be.substring(1);U[le]=A[Jt]}else U[le]=Be}),U}createSegmentGroup(B,A,U,le){const Be=this.createSegments(B,A.segments,U,le);let qe={};return Object.entries(A.children).forEach(([Jt,Rn])=>{qe[Jt]=this.createSegmentGroup(B,Rn,U,le)}),new pe(Be,qe)}createSegments(B,A,U,le){return A.map(Be=>Be.path.startsWith(":")?this.findPosParam(B,Be,le):this.findOrReturn(Be,U))}findPosParam(B,A,U){const le=U[A.path.substring(1)];if(!le)throw new v.vHH(4001,!1);return le}findOrReturn(B,A){let U=0;for(const le of A){if(le.path===B.path)return A.splice(U),le;U++}return B}}const Bl={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function Ia(L,B,A,U,le){const Be=Nl(L,B,A);return Be.matched?(U=function ia(L,B){return L.providers&&!L._injector&&(L._injector=(0,v.MMx)(L.providers,B,`Route: ${L.path}`)),L._injector??B}(B,U),function fd(L,B,A,U){const le=B.canMatch;if(!le||0===le.length)return(0,s.of)(!0);const Be=le.map(qe=>{const Jt=Zi(qe,L);return hn(function kc(L){return L&&bn(L.canMatch)}(Jt)?Jt.canMatch(B,A):L.runInContext(()=>Jt(B,A)))});return(0,s.of)(Be).pipe(Os(),pl())}(U,B,A).pipe((0,ye.U)(qe=>!0===qe?Be:{...Bl}))):(0,s.of)(Be)}function Nl(L,B,A){if(""===B.path)return"full"===B.pathMatch&&(L.hasChildren()||A.length>0)?{...Bl}:{matched:!0,consumedSegments:[],remainingSegments:A,parameters:{},positionalParamSegments:{}};const le=(B.matcher||si)(A,L,B);if(!le)return{...Bl};const Be={};Object.entries(le.posParams??{}).forEach(([Jt,Rn])=>{Be[Jt]=Rn.path});const qe=le.consumed.length>0?{...Be,...le.consumed[le.consumed.length-1].parameters}:Be;return{matched:!0,consumedSegments:le.consumed,remainingSegments:A.slice(le.consumed.length),parameters:qe,positionalParamSegments:le.posParams??{}}}function ml(L,B,A,U){return A.length>0&&function ac(L,B,A){return A.some(U=>zl(L,B,U)&&Tr(U)!==Nt)}(L,A,U)?{segmentGroup:new pe(B,Ba(U,new pe(A,L.children))),slicedSegments:[]}:0===A.length&&function mu(L,B,A){return A.some(U=>zl(L,B,U))}(L,A,U)?{segmentGroup:new pe(L.segments,fu(L,0,A,U,L.children)),slicedSegments:A}:{segmentGroup:new pe(L.segments,L.children),slicedSegments:A}}function fu(L,B,A,U,le){const Be={};for(const qe of U)if(zl(L,A,qe)&&!le[Tr(qe)]){const Jt=new pe([],{});Be[Tr(qe)]=Jt}return{...le,...Be}}function Ba(L,B){const A={};A[Nt]=B;for(const U of L)if(""===U.path&&Tr(U)!==Nt){const le=new pe([],{});A[Tr(U)]=le}return A}function zl(L,B,A){return(!(L.hasChildren()||B.length>0)||"full"!==A.pathMatch)&&""===A.path}class Ul{constructor(B,A,U,le,Be,qe,Jt){this.injector=B,this.configLoader=A,this.rootComponentType=U,this.config=le,this.urlTree=Be,this.paramsInheritanceStrategy=qe,this.urlSerializer=Jt,this.allowRedirects=!0,this.applyRedirects=new fl(this.urlSerializer,this.urlTree)}noMatchError(B){return new v.vHH(4002,!1)}recognize(){const B=ml(this.urlTree.root,[],[],this.config).segmentGroup;return this.processSegmentGroup(this.injector,this.config,B,Nt).pipe(Xt(A=>{if(A instanceof fa)return this.allowRedirects=!1,this.urlTree=A.urlTree,this.match(A.urlTree);throw A instanceof pa?this.noMatchError(A):A}),(0,ye.U)(A=>{const U=new Ri([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Nt,this.rootComponentType,null,{}),le=new Bi(U,A),Be=new us("",le),qe=function mo(L,B,A=null,U=null){return Go(Ao(L),B,A,U)}(U,[],this.urlTree.queryParams,this.urlTree.fragment);return qe.queryParams=this.urlTree.queryParams,Be.url=this.urlSerializer.serialize(qe),this.inheritParamsAndData(Be._root),{state:Be,tree:qe}}))}match(B){return this.processSegmentGroup(this.injector,this.config,B.root,Nt).pipe(Xt(U=>{throw U instanceof pa?this.noMatchError(U):U}))}inheritParamsAndData(B){const A=B.value,U=Ur(A,this.paramsInheritanceStrategy);A.params=Object.freeze(U.params),A.data=Object.freeze(U.data),B.children.forEach(le=>this.inheritParamsAndData(le))}processSegmentGroup(B,A,U,le){return 0===U.segments.length&&U.hasChildren()?this.processChildren(B,A,U):this.processSegment(B,A,U,U.segments,le,!0)}processChildren(B,A,U){const le=[];for(const Be of Object.keys(U.children))"primary"===Be?le.unshift(Be):le.push(Be);return(0,y.D)(le).pipe((0,Ft.b)(Be=>{const qe=U.children[Be],Jt=function Ma(L,B){const A=L.filter(U=>Tr(U)===B);return A.push(...L.filter(U=>Tr(U)!==B)),A}(A,Be);return this.processSegmentGroup(B,Jt,qe,Be)}),function sn(L,B){return(0,ae.e)(function mn(L,B,A,U,le){return(Be,qe)=>{let Jt=A,Rn=B,_i=0;Be.subscribe((0,X.x)(qe,Ai=>{const Mo=_i++;Rn=Jt?L(Rn,Ai,Mo):(Jt=!0,Ai),U&&qe.next(Rn)},le&&(()=>{Jt&&qe.next(Rn),qe.complete()})))}}(L,B,arguments.length>=2,!0))}((Be,qe)=>(Be.push(...qe),Be)),vt(null),function It(L,B){const A=arguments.length>=2;return U=>U.pipe(L?(0,ct.h)((le,Be)=>L(le,Be,U)):w.y,Vt(1),A?vt(B):je(()=>new Me))}(),(0,Ue.z)(Be=>{if(null===Be)return Es(U);const qe=uc(Be);return function Na(L){L.sort((B,A)=>B.value.outlet===Nt?-1:A.value.outlet===Nt?1:B.value.outlet.localeCompare(A.value.outlet))}(qe),(0,s.of)(qe)}))}processSegment(B,A,U,le,Be,qe){return(0,y.D)(A).pipe((0,Ft.b)(Jt=>this.processSegmentAgainstRoute(Jt._injector??B,A,Jt,U,le,Be,qe).pipe(Xt(Rn=>{if(Rn instanceof pa)return(0,s.of)(null);throw Rn}))),Ne(Jt=>!!Jt),Xt(Jt=>{if(Ll(Jt))return function zc(L,B,A){return 0===B.length&&!L.children[A]}(U,le,Be)?(0,s.of)([]):Es(U);throw Jt}))}processSegmentAgainstRoute(B,A,U,le,Be,qe,Jt){return function lc(L,B,A,U){return!!(Tr(L)===U||U!==Nt&&zl(B,A,L))&&("**"===L.path||Nl(B,L,A).matched)}(U,le,Be,qe)?void 0===U.redirectTo?this.matchSegmentAgainstRoute(B,le,U,Be,qe,Jt):Jt&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(B,le,A,U,Be,qe):Es(le):Es(le)}expandSegmentAgainstRouteUsingRedirect(B,A,U,le,Be,qe){return"**"===le.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(B,U,le,qe):this.expandRegularSegmentAgainstRouteUsingRedirect(B,A,U,le,Be,qe)}expandWildCardWithParamsAgainstRouteUsingRedirect(B,A,U,le){const Be=this.applyRedirects.applyRedirectCommands([],U.redirectTo,{});return U.redirectTo.startsWith("/")?sc(Be):this.applyRedirects.lineralizeSegments(U,Be).pipe((0,Ue.z)(qe=>{const Jt=new pe(qe,{});return this.processSegment(B,A,Jt,qe,le,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(B,A,U,le,Be,qe){const{matched:Jt,consumedSegments:Rn,remainingSegments:_i,positionalParamSegments:Ai}=Nl(A,le,Be);if(!Jt)return Es(A);const Mo=this.applyRedirects.applyRedirectCommands(Rn,le.redirectTo,Ai);return le.redirectTo.startsWith("/")?sc(Mo):this.applyRedirects.lineralizeSegments(le,Mo).pipe((0,Ue.z)(p=>this.processSegment(B,U,A,p.concat(_i),qe,!1)))}matchSegmentAgainstRoute(B,A,U,le,Be,qe){let Jt;if("**"===U.path){const Rn=le.length>0?un(le).parameters:{},_i=new Ri(le,Rn,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ma(U),Tr(U),U.component??U._loadedComponent??null,U,Z(U));Jt=(0,s.of)({snapshot:_i,consumedSegments:[],remainingSegments:[]}),A.children={}}else Jt=Ia(A,U,le,B).pipe((0,ye.U)(({matched:Rn,consumedSegments:_i,remainingSegments:Ai,parameters:Mo})=>Rn?{snapshot:new Ri(_i,Mo,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,ma(U),Tr(U),U.component??U._loadedComponent??null,U,Z(U)),consumedSegments:_i,remainingSegments:Ai}:null));return Jt.pipe((0,Qt.w)(Rn=>null===Rn?Es(A):this.getChildConfig(B=U._injector??B,U,le).pipe((0,Qt.w)(({routes:_i})=>{const Ai=U._loadedInjector??B,{snapshot:Mo,consumedSegments:p,remainingSegments:o}=Rn,{segmentGroup:c,slicedSegments:m}=ml(A,p,o,_i);if(0===m.length&&c.hasChildren())return this.processChildren(Ai,_i,c).pipe((0,ye.U)(C=>null===C?null:[new Bi(Mo,C)]));if(0===_i.length&&0===m.length)return(0,s.of)([new Bi(Mo,[])]);const x=Tr(U)===Be;return this.processSegment(Ai,_i,c,m,x?Nt:Be,!0).pipe((0,ye.U)(C=>[new Bi(Mo,C)]))}))))}getChildConfig(B,A,U){return A.children?(0,s.of)({routes:A.children,injector:B}):A.loadChildren?void 0!==A._loadedRoutes?(0,s.of)({routes:A._loadedRoutes,injector:A._loadedInjector}):function Or(L,B,A,U){const le=B.canLoad;if(void 0===le||0===le.length)return(0,s.of)(!0);const Be=le.map(qe=>{const Jt=Zi(qe,L);return hn(function sr(L){return L&&bn(L.canLoad)}(Jt)?Jt.canLoad(B,A):L.runInContext(()=>Jt(B,A)))});return(0,s.of)(Be).pipe(Os(),pl())}(B,A,U).pipe((0,Ue.z)(le=>le?this.configLoader.loadChildren(B,A).pipe(Gt(Be=>{A._loadedRoutes=Be.routes,A._loadedInjector=Be.injector})):function Nc(L){return nt(na(!1,3))}())):(0,s.of)({routes:[],injector:B})}}function cc(L){const B=L.value.routeConfig;return B&&""===B.path}function uc(L){const B=[],A=new Set;for(const U of L){if(!cc(U)){B.push(U);continue}const le=B.find(Be=>U.value.routeConfig===Be.value.routeConfig);void 0!==le?(le.children.push(...U.children),A.add(le)):B.push(U)}for(const U of A){const le=uc(U.children);B.push(new Bi(U.value,le))}return B.filter(U=>!A.has(U))}function ma(L){return L.data||{}}function Z(L){return L.resolve||{}}function Qn(L){return"string"==typeof L.title||null===L.title}function Co(L){return(0,Qt.w)(B=>{const A=L(B);return A?(0,y.D)(A).pipe((0,ye.U)(()=>B)):(0,s.of)(B)})}const _o=new v.OlP("ROUTES");let Ki=(()=>{class L{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,v.f3M)(v.Sil)}loadComponent(A){if(this.componentLoaders.get(A))return this.componentLoaders.get(A);if(A._loadedComponent)return(0,s.of)(A._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(A);const U=hn(A.loadComponent()).pipe((0,ye.U)(fr),Gt(Be=>{this.onLoadEndListener&&this.onLoadEndListener(A),A._loadedComponent=Be}),(0,Wt.x)(()=>{this.componentLoaders.delete(A)})),le=new xe(U,()=>new Ze.x).pipe(mt());return this.componentLoaders.set(A,le),le}loadChildren(A,U){if(this.childrenLoaders.get(U))return this.childrenLoaders.get(U);if(U._loadedRoutes)return(0,s.of)({routes:U._loadedRoutes,injector:U._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(U);const Be=this.loadModuleFactoryOrRoutes(U.loadChildren).pipe((0,ye.U)(Jt=>{this.onLoadEndListener&&this.onLoadEndListener(U);let Rn,_i;return Array.isArray(Jt)?_i=Jt:(Rn=Jt.create(A).injector,_i=Rn.get(_o,[],v.XFs.Self|v.XFs.Optional).flat()),{routes:_i.map(pr),injector:Rn}}),(0,Wt.x)(()=>{this.childrenLoaders.delete(U)})),qe=new xe(Be,()=>new Ze.x).pipe(mt());return this.childrenLoaders.set(U,qe),qe}loadModuleFactoryOrRoutes(A){return hn(A()).pipe((0,ye.U)(fr),(0,Ue.z)(U=>U instanceof v.YKP||Array.isArray(U)?(0,s.of)(U):(0,y.D)(this.compiler.compileModuleAsync(U))))}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();function fr(L){return function lo(L){return L&&"object"==typeof L&&"default"in L}(L)?L.default:L}let Ro=(()=>{class L{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new Ze.x,this.configLoader=(0,v.f3M)(Ki),this.environmentInjector=(0,v.f3M)(v.lqb),this.urlSerializer=(0,v.f3M)(Ut),this.rootContexts=(0,v.f3M)(hr),this.inputBindingEnabled=null!==(0,v.f3M)(br,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,s.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=le=>this.events.next(new so(le)),this.configLoader.onLoadStartListener=le=>this.events.next(new Xi(le))}complete(){this.transitions?.complete()}handleNavigationRequest(A){const U=++this.navigationId;this.transitions?.next({...this.transitions.value,...A,id:U})}setupNavigations(A){return this.transitions=new Q.X({id:0,currentUrlTree:A.currentUrlTree,currentRawUrl:A.currentUrlTree,extractedUrl:A.urlHandlingStrategy.extract(A.currentUrlTree),urlAfterRedirects:A.urlHandlingStrategy.extract(A.currentUrlTree),rawUrl:A.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:ke,restoredState:null,currentSnapshot:A.routerState.snapshot,targetSnapshot:null,currentRouterState:A.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,ct.h)(U=>0!==U.id),(0,ye.U)(U=>({...U,extractedUrl:A.urlHandlingStrategy.extract(U.rawUrl)})),(0,Qt.w)(U=>{let le=!1,Be=!1;return(0,s.of)(U).pipe(Gt(qe=>{this.currentNavigation={id:qe.id,initialUrl:qe.rawUrl,extractedUrl:qe.extractedUrl,trigger:qe.source,extras:qe.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Qt.w)(qe=>{const Jt=A.browserUrlTree.toString(),Rn=!A.navigated||qe.extractedUrl.toString()!==Jt||Jt!==A.currentUrlTree.toString();if(!Rn&&"reload"!==(qe.extras.onSameUrlNavigation??A.onSameUrlNavigation)){const Ai="";return this.events.next(new Tn(qe.id,A.serializeUrl(U.rawUrl),Ai,0)),A.rawUrlTree=qe.rawUrl,qe.resolve(null),Xe.E}if(A.urlHandlingStrategy.shouldProcessUrl(qe.rawUrl))return Eo(qe.source)&&(A.browserUrlTree=qe.extractedUrl),(0,s.of)(qe).pipe((0,Qt.w)(Ai=>{const Mo=this.transitions?.getValue();return this.events.next(new Bt(Ai.id,this.urlSerializer.serialize(Ai.extractedUrl),Ai.source,Ai.restoredState)),Mo!==this.transitions?.getValue()?Xe.E:Promise.resolve(Ai)}),function de(L,B,A,U,le,Be){return(0,Ue.z)(qe=>function Uc(L,B,A,U,le,Be,qe="emptyOnly"){return new Ul(L,B,A,U,le,qe,Be).recognize()}(L,B,A,U,qe.extractedUrl,le,Be).pipe((0,ye.U)(({state:Jt,tree:Rn})=>({...qe,targetSnapshot:Jt,urlAfterRedirects:Rn}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,A.config,this.urlSerializer,A.paramsInheritanceStrategy),Gt(Ai=>{if(U.targetSnapshot=Ai.targetSnapshot,U.urlAfterRedirects=Ai.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:Ai.urlAfterRedirects},"eager"===A.urlUpdateStrategy){if(!Ai.extras.skipLocationChange){const p=A.urlHandlingStrategy.merge(Ai.urlAfterRedirects,Ai.rawUrl);A.setBrowserUrl(p,Ai)}A.browserUrlTree=Ai.urlAfterRedirects}const Mo=new On(Ai.id,this.urlSerializer.serialize(Ai.extractedUrl),this.urlSerializer.serialize(Ai.urlAfterRedirects),Ai.targetSnapshot);this.events.next(Mo)}));if(Rn&&A.urlHandlingStrategy.shouldProcessUrl(A.rawUrlTree)){const{id:Ai,extractedUrl:Mo,source:p,restoredState:o,extras:c}=qe,m=new Bt(Ai,this.urlSerializer.serialize(Mo),p,o);this.events.next(m);const x=jo(0,this.rootComponentType).snapshot;return U={...qe,targetSnapshot:x,urlAfterRedirects:Mo,extras:{...c,skipLocationChange:!1,replaceUrl:!1}},(0,s.of)(U)}{const Ai="";return this.events.next(new Tn(qe.id,A.serializeUrl(U.extractedUrl),Ai,1)),A.rawUrlTree=qe.rawUrl,qe.resolve(null),Xe.E}}),Gt(qe=>{const Jt=new hi(qe.id,this.urlSerializer.serialize(qe.extractedUrl),this.urlSerializer.serialize(qe.urlAfterRedirects),qe.targetSnapshot);this.events.next(Jt)}),(0,ye.U)(qe=>U={...qe,guards:Ln(qe.targetSnapshot,qe.currentSnapshot,this.rootContexts)}),function da(L,B){return(0,Ue.z)(A=>{const{targetSnapshot:U,currentSnapshot:le,guards:{canActivateChecks:Be,canDeactivateChecks:qe}}=A;return 0===qe.length&&0===Be.length?(0,s.of)({...A,guardsResult:!0}):function kl(L,B,A,U){return(0,y.D)(L).pipe((0,Ue.z)(le=>function ha(L,B,A,U,le){const Be=B&&B.routeConfig?B.routeConfig.canDeactivate:null;if(!Be||0===Be.length)return(0,s.of)(!0);const qe=Be.map(Jt=>{const Rn=oa(B)??le,_i=Zi(Jt,Rn);return hn(function qa(L){return L&&bn(L.canDeactivate)}(_i)?_i.canDeactivate(L,B,A,U):Rn.runInContext(()=>_i(L,B,A,U))).pipe(Ne())});return(0,s.of)(qe).pipe(Os())}(le.component,le.route,A,B,U)),Ne(le=>!0!==le,!0))}(qe,U,le,L).pipe((0,Ue.z)(Jt=>Jt&&function pi(L){return"boolean"==typeof L}(Jt)?function Ya(L,B,A,U){return(0,y.D)(B).pipe((0,Ft.b)(le=>(0,ze.z)(function ps(L,B){return null!==L&&B&&B(new To(L)),(0,s.of)(!0)}(le.route.parent,U),function Ja(L,B){return null!==L&&B&&B(new Wo(L)),(0,s.of)(!0)}(le.route,U),function Rs(L,B,A){const U=B[B.length-1],Be=B.slice(0,B.length-1).reverse().map(qe=>function Xn(L){const B=L.routeConfig?L.routeConfig.canActivateChild:null;return B&&0!==B.length?{node:L,guards:B}:null}(qe)).filter(qe=>null!==qe).map(qe=>(0,Ke.P)(()=>{const Jt=qe.guards.map(Rn=>{const _i=oa(qe.node)??A,Ai=Zi(Rn,_i);return hn(function Ws(L){return L&&bn(L.canActivateChild)}(Ai)?Ai.canActivateChild(U,L):_i.runInContext(()=>Ai(U,L))).pipe(Ne())});return(0,s.of)(Jt).pipe(Os())}));return(0,s.of)(Be).pipe(Os())}(L,le.path,A),function Fl(L,B,A){const U=B.routeConfig?B.routeConfig.canActivate:null;if(!U||0===U.length)return(0,s.of)(!0);const le=U.map(Be=>(0,Ke.P)(()=>{const qe=oa(B)??A,Jt=Zi(Be,qe);return hn(function hs(L){return L&&bn(L.canActivate)}(Jt)?Jt.canActivate(B,L):qe.runInContext(()=>Jt(B,L))).pipe(Ne())}));return(0,s.of)(le).pipe(Os())}(L,le.route,A))),Ne(le=>!0!==le,!0))}(U,Be,L,B):(0,s.of)(Jt)),(0,ye.U)(Jt=>({...A,guardsResult:Jt})))})}(this.environmentInjector,qe=>this.events.next(qe)),Gt(qe=>{if(U.guardsResult=qe.guardsResult,wi(qe.guardsResult))throw ds(0,qe.guardsResult);const Jt=new Ii(qe.id,this.urlSerializer.serialize(qe.extractedUrl),this.urlSerializer.serialize(qe.urlAfterRedirects),qe.targetSnapshot,!!qe.guardsResult);this.events.next(Jt)}),(0,ct.h)(qe=>!!qe.guardsResult||(A.restoreHistory(qe),this.cancelNavigationTransition(qe,"",3),!1)),Co(qe=>{if(qe.guards.canActivateChecks.length)return(0,s.of)(qe).pipe(Gt(Jt=>{const Rn=new zi(Jt.id,this.urlSerializer.serialize(Jt.extractedUrl),this.urlSerializer.serialize(Jt.urlAfterRedirects),Jt.targetSnapshot);this.events.next(Rn)}),(0,Qt.w)(Jt=>{let Rn=!1;return(0,s.of)(Jt).pipe(function q(L,B){return(0,Ue.z)(A=>{const{targetSnapshot:U,guards:{canActivateChecks:le}}=A;if(!le.length)return(0,s.of)(A);let Be=0;return(0,y.D)(le).pipe((0,Ft.b)(qe=>function be(L,B,A,U){const le=L.routeConfig,Be=L._resolve;return void 0!==le?.title&&!Qn(le)&&(Be[yi]=le.title),function Tt(L,B,A,U){const le=function vn(L){return[...Object.keys(L),...Object.getOwnPropertySymbols(L)]}(L);if(0===le.length)return(0,s.of)({});const Be={};return(0,y.D)(le).pipe((0,Ue.z)(qe=>function Dn(L,B,A,U){const le=oa(B)??U,Be=Zi(L,le);return hn(Be.resolve?Be.resolve(B,A):le.runInContext(()=>Be(B,A)))}(L[qe],B,A,U).pipe(Ne(),Gt(Jt=>{Be[qe]=Jt}))),Vt(1),function at(L){return(0,ye.U)(()=>L)}(Be),Xt(qe=>Ll(qe)?Xe.E:nt(qe)))}(Be,L,B,U).pipe((0,ye.U)(qe=>(L._resolvedData=qe,L.data=Ur(L,A).resolve,le&&Qn(le)&&(L.data[yi]=le.title),null)))}(qe.route,U,L,B)),Gt(()=>Be++),Vt(1),(0,Ue.z)(qe=>Be===le.length?(0,s.of)(A):Xe.E))})}(A.paramsInheritanceStrategy,this.environmentInjector),Gt({next:()=>Rn=!0,complete:()=>{Rn||(A.restoreHistory(Jt),this.cancelNavigationTransition(Jt,"",2))}}))}),Gt(Jt=>{const Rn=new Lo(Jt.id,this.urlSerializer.serialize(Jt.extractedUrl),this.urlSerializer.serialize(Jt.urlAfterRedirects),Jt.targetSnapshot);this.events.next(Rn)}))}),Co(qe=>{const Jt=Rn=>{const _i=[];Rn.routeConfig?.loadComponent&&!Rn.routeConfig._loadedComponent&&_i.push(this.configLoader.loadComponent(Rn.routeConfig).pipe(Gt(Ai=>{Rn.component=Ai}),(0,ye.U)(()=>{})));for(const Ai of Rn.children)_i.push(...Jt(Ai));return _i};return Te(Jt(qe.targetSnapshot.root)).pipe(vt(),(0,dt.q)(1))}),Co(()=>this.afterPreactivation()),(0,ye.U)(qe=>{const Jt=function rr(L,B,A){const U=Ar(L,B._root,A?A._root:void 0);return new is(U,B)}(A.routeReuseStrategy,qe.targetSnapshot,qe.currentRouterState);return U={...qe,targetRouterState:Jt}}),Gt(qe=>{A.currentUrlTree=qe.urlAfterRedirects,A.rawUrlTree=A.urlHandlingStrategy.merge(qe.urlAfterRedirects,qe.rawUrl),A.routerState=qe.targetRouterState,"deferred"===A.urlUpdateStrategy&&(qe.extras.skipLocationChange||A.setBrowserUrl(A.rawUrlTree,qe),A.browserUrlTree=qe.urlAfterRedirects)}),((L,B,A,U)=>(0,ye.U)(le=>(new P(B,le.targetRouterState,le.currentRouterState,A,U).activate(L),le)))(this.rootContexts,A.routeReuseStrategy,qe=>this.events.next(qe),this.inputBindingEnabled),(0,dt.q)(1),Gt({next:qe=>{le=!0,this.lastSuccessfulNavigation=this.currentNavigation,A.navigated=!0,this.events.next(new zt(qe.id,this.urlSerializer.serialize(qe.extractedUrl),this.urlSerializer.serialize(A.currentUrlTree))),A.titleStrategy?.updateTitle(qe.targetRouterState.snapshot),qe.resolve(!0)},complete:()=>{le=!0}}),(0,Wt.x)(()=>{le||Be||this.cancelNavigationTransition(U,"",1),this.currentNavigation?.id===U.id&&(this.currentNavigation=null)}),Xt(qe=>{if(Be=!0,Sr(qe)){Ss(qe)||(A.navigated=!0,A.restoreHistory(U,!0));const Jt=new yn(U.id,this.urlSerializer.serialize(U.extractedUrl),qe.message,qe.cancellationCode);if(this.events.next(Jt),Ss(qe)){const Rn=A.urlHandlingStrategy.merge(qe.url,A.rawUrlTree),_i={skipLocationChange:U.extras.skipLocationChange,replaceUrl:"eager"===A.urlUpdateStrategy||Eo(U.source)};A.scheduleNavigation(Rn,ke,null,_i,{resolve:U.resolve,reject:U.reject,promise:U.promise})}else U.resolve(!1)}else{A.restoreHistory(U,!0);const Jt=new xn(U.id,this.urlSerializer.serialize(U.extractedUrl),qe,U.targetSnapshot??void 0);this.events.next(Jt);try{U.resolve(A.errorHandler(qe))}catch(Rn){U.reject(Rn)}}return Xe.E}))}))}cancelNavigationTransition(A,U,le){const Be=new yn(A.id,this.urlSerializer.serialize(A.extractedUrl),U,le);this.events.next(Be),A.resolve(!1)}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();function Eo(L){return L!==ke}let Ls=(()=>{class L{buildTitle(A){let U,le=A.root;for(;void 0!==le;)U=this.getResolvedTitleForRoute(le)??U,le=le.children.find(Be=>Be.outlet===Nt);return U}getResolvedTitleForRoute(A){return A.data[yi]}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:function(){return(0,v.f3M)(Ds)},providedIn:"root"}),L})(),Ds=(()=>{class L extends Ls{constructor(A){super(),this.title=A}updateTitle(A){const U=this.buildTitle(A);void 0!==U&&this.title.setTitle(U)}}return L.\u0275fac=function(A){return new(A||L)(v.LFG(Sn.Dx))},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})(),fs=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:function(){return(0,v.f3M)(qs)},providedIn:"root"}),L})();class Vr{shouldDetach(B){return!1}store(B,A){}shouldAttach(B){return!1}retrieve(B){return null}shouldReuseRoute(B,A){return B.routeConfig===A.routeConfig}}let qs=(()=>{class L extends Vr{}return L.\u0275fac=function(){let B;return function(U){return(B||(B=v.n5z(L)))(U||L)}}(),L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();const os=new v.OlP("",{providedIn:"root",factory:()=>({})});let Ni=(()=>{class L{}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:function(){return(0,v.f3M)(Zl)},providedIn:"root"}),L})(),Zl=(()=>{class L{shouldProcessUrl(A){return!0}extract(A){return A}merge(A,U){return A}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();var ms=(()=>((ms=ms||{})[ms.COMPLETE=0]="COMPLETE",ms[ms.FAILED=1]="FAILED",ms[ms.REDIRECTING=2]="REDIRECTING",ms))();function ui(L,B){L.events.pipe((0,ct.h)(A=>A instanceof zt||A instanceof yn||A instanceof xn||A instanceof Tn),(0,ye.U)(A=>A instanceof zt||A instanceof Tn?ms.COMPLETE:A instanceof yn&&(0===A.code||1===A.code)?ms.REDIRECTING:ms.FAILED),(0,ct.h)(A=>A!==ms.REDIRECTING),(0,dt.q)(1)).subscribe(()=>{B()})}function sa(L){throw L}function gu(L,B,A){return B.parse("/")}const gl={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ga={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let qo=(()=>{class L{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){if("computed"===this.canceledNavigationResolution)return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,v.f3M)(v.c2e),this.isNgZoneEnabled=!1,this.options=(0,v.f3M)(os,{optional:!0})||{},this.pendingTasks=(0,v.f3M)(v.HDt),this.errorHandler=this.options.errorHandler||sa,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||gu,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,v.f3M)(Ni),this.routeReuseStrategy=(0,v.f3M)(fs),this.titleStrategy=(0,v.f3M)(Ls),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=(0,v.f3M)(_o,{optional:!0})?.flat()??[],this.navigationTransitions=(0,v.f3M)(Ro),this.urlSerializer=(0,v.f3M)(Ut),this.location=(0,v.f3M)(Se.Ye),this.componentInputBindingEnabled=!!(0,v.f3M)(br,{optional:!0}),this.isNgZoneEnabled=(0,v.f3M)(v.R0b)instanceof v.R0b&&v.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new ut,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=jo(0,null),this.navigationTransitions.setupNavigations(this).subscribe(A=>{this.lastSuccessfulId=A.id,this.currentPageId=this.browserPageId??0},A=>{this.console.warn(`Unhandled Navigation Error: ${A}`)})}resetRootComponentType(A){this.routerState.root.component=A,this.navigationTransitions.rootComponentType=A}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const A=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),ke,A)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(A=>{const U="popstate"===A.type?"popstate":"hashchange";"popstate"===U&&setTimeout(()=>{this.navigateToSyncWithBrowser(A.url,U,A.state)},0)}))}navigateToSyncWithBrowser(A,U,le){const Be={replaceUrl:!0},qe=le?.navigationId?le:null;if(le){const Rn={...le};delete Rn.navigationId,delete Rn.\u0275routerPageId,0!==Object.keys(Rn).length&&(Be.state=Rn)}const Jt=this.parseUrl(A);this.scheduleNavigation(Jt,U,qe,Be)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(A){this.config=A.map(pr),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(A,U={}){const{relativeTo:le,queryParams:Be,fragment:qe,queryParamsHandling:Jt,preserveFragment:Rn}=U,_i=Rn?this.currentUrlTree.fragment:qe;let Mo,Ai=null;switch(Jt){case"merge":Ai={...this.currentUrlTree.queryParams,...Be};break;case"preserve":Ai=this.currentUrlTree.queryParams;break;default:Ai=Be||null}null!==Ai&&(Ai=this.removeEmptyProps(Ai));try{Mo=Ao(le?le.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof A[0]||!A[0].startsWith("/"))&&(A=[]),Mo=this.currentUrlTree.root}return Go(Mo,A,Ai,_i??null)}navigateByUrl(A,U={skipLocationChange:!1}){const le=wi(A)?A:this.parseUrl(A),Be=this.urlHandlingStrategy.merge(le,this.rawUrlTree);return this.scheduleNavigation(Be,ke,null,U)}navigate(A,U={skipLocationChange:!1}){return function Vl(L){for(let B=0;B<L.length;B++)if(null==L[B])throw new v.vHH(4008,!1)}(A),this.navigateByUrl(this.createUrlTree(A,U),U)}serializeUrl(A){return this.urlSerializer.serialize(A)}parseUrl(A){let U;try{U=this.urlSerializer.parse(A)}catch(le){U=this.malformedUriErrorHandler(le,this.urlSerializer,A)}return U}isActive(A,U){let le;if(le=!0===U?{...gl}:!1===U?{...ga}:U,wi(A))return Un(this.currentUrlTree,A,le);const Be=this.parseUrl(A);return Un(this.currentUrlTree,Be,le)}removeEmptyProps(A){return Object.keys(A).reduce((U,le)=>{const Be=A[le];return null!=Be&&(U[le]=Be),U},{})}scheduleNavigation(A,U,le,Be,qe){if(this.disposed)return Promise.resolve(!1);let Jt,Rn,_i;qe?(Jt=qe.resolve,Rn=qe.reject,_i=qe.promise):_i=new Promise((Mo,p)=>{Jt=Mo,Rn=p});const Ai=this.pendingTasks.add();return ui(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(Ai))}),this.navigationTransitions.handleNavigationRequest({source:U,restoredState:le,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:A,extras:Be,resolve:Jt,reject:Rn,promise:_i,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),_i.catch(Mo=>Promise.reject(Mo))}setBrowserUrl(A,U){const le=this.urlSerializer.serialize(A);if(this.location.isCurrentPathEqualTo(le)||U.extras.replaceUrl){const qe={...U.extras.state,...this.generateNgRouterState(U.id,this.browserPageId)};this.location.replaceState(le,"",qe)}else{const Be={...U.extras.state,...this.generateNgRouterState(U.id,(this.browserPageId??0)+1)};this.location.go(le,"",Be)}}restoreHistory(A,U=!1){if("computed"===this.canceledNavigationResolution){const Be=this.currentPageId-(this.browserPageId??this.currentPageId);0!==Be?this.location.historyGo(Be):this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===Be&&(this.resetState(A),this.browserUrlTree=A.currentUrlTree,this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(U&&this.resetState(A),this.resetUrlToCurrentUrlTree())}resetState(A){this.routerState=A.currentRouterState,this.currentUrlTree=A.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,A.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(A,U){return"computed"===this.canceledNavigationResolution?{navigationId:A,\u0275routerPageId:U}:{navigationId:A}}}return L.\u0275fac=function(A){return new(A||L)},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})(),Ka=(()=>{class L{constructor(A,U,le,Be,qe,Jt){this.router=A,this.route=U,this.tabIndexAttribute=le,this.renderer=Be,this.el=qe,this.locationStrategy=Jt,this.href=null,this.commands=null,this.onChanges=new Ze.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const Rn=qe.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===Rn||"area"===Rn,this.isAnchorElement?this.subscription=A.events.subscribe(_i=>{_i instanceof zt&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(A){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",A)}ngOnChanges(A){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(A){null!=A?(this.commands=Array.isArray(A)?A:[A],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(A,U,le,Be,qe){return!!(null===this.urlTree||this.isAnchorElement&&(0!==A||U||le||Be||qe||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const A=null===this.href?null:(0,v.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",A)}applyAttributeValue(A,U){const le=this.renderer,Be=this.el.nativeElement;null!==U?le.setAttribute(Be,A,U):le.removeAttribute(Be,A)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return L.\u0275fac=function(A){return new(A||L)(v.Y36(qo),v.Y36(Oo),v.$8M("tabindex"),v.Y36(v.Qsj),v.Y36(v.SBq),v.Y36(Se.S$))},L.\u0275dir=v.lG2({type:L,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(A,U){1&A&&v.NdJ("click",function(Be){return U.onClick(Be.button,Be.ctrlKey,Be.shiftKey,Be.altKey,Be.metaKey)}),2&A&&v.uIk("target",U.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:["preserveFragment","preserveFragment",v.VuI],skipLocationChange:["skipLocationChange","skipLocationChange",v.VuI],replaceUrl:["replaceUrl","replaceUrl",v.VuI],routerLink:"routerLink"},standalone:!0,features:[v.Xq5,v.TTD]}),L})();class Gn{}let hc=(()=>{class L{constructor(A,U,le,Be,qe){this.router=A,this.injector=le,this.preloadingStrategy=Be,this.loader=qe}setUpPreloading(){this.subscription=this.router.events.pipe((0,ct.h)(A=>A instanceof zt),(0,Ft.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(A,U){const le=[];for(const Be of U){Be.providers&&!Be._injector&&(Be._injector=(0,v.MMx)(Be.providers,A,`Route: ${Be.path}`));const qe=Be._injector??A,Jt=Be._loadedInjector??qe;(Be.loadChildren&&!Be._loadedRoutes&&void 0===Be.canLoad||Be.loadComponent&&!Be._loadedComponent)&&le.push(this.preloadConfig(qe,Be)),(Be.children||Be._loadedRoutes)&&le.push(this.processRoutes(Jt,Be.children??Be._loadedRoutes))}return(0,y.D)(le).pipe((0,dn.J)())}preloadConfig(A,U){return this.preloadingStrategy.preload(U,()=>{let le;le=U.loadChildren&&void 0===U.canLoad?this.loader.loadChildren(A,U):(0,s.of)(null);const Be=le.pipe((0,Ue.z)(qe=>null===qe?(0,s.of)(void 0):(U._loadedRoutes=qe.routes,U._loadedInjector=qe.injector,this.processRoutes(qe.injector??A,qe.routes))));if(U.loadComponent&&!U._loadedComponent){const qe=this.loader.loadComponent(U);return(0,y.D)([Be,qe]).pipe((0,dn.J)())}return Be})}}return L.\u0275fac=function(A){return new(A||L)(v.LFG(qo),v.LFG(v.Sil),v.LFG(v.lqb),v.LFG(Gn),v.LFG(Ki))},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac,providedIn:"root"}),L})();const jr=new v.OlP("");let pc=(()=>{class L{constructor(A,U,le,Be,qe={}){this.urlSerializer=A,this.transitions=U,this.viewportScroller=le,this.zone=Be,this.options=qe,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},qe.scrollPositionRestoration=qe.scrollPositionRestoration||"disabled",qe.anchorScrolling=qe.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(A=>{A instanceof Bt?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=A.navigationTrigger,this.restoredId=A.restoredState?A.restoredState.navigationId:0):A instanceof zt?(this.lastId=A.id,this.scheduleScrollEvent(A,this.urlSerializer.parse(A.urlAfterRedirects).fragment)):A instanceof Tn&&0===A.code&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(A,this.urlSerializer.parse(A.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(A=>{A instanceof wo&&(A.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(A.position):A.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(A.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(A,U){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new wo(A,"popstate"===this.lastSource?this.store[this.restoredId]:null,U))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return L.\u0275fac=function(A){v.$Z()},L.\u0275prov=v.Yz7({token:L,factory:L.\u0275fac}),L})();function Fs(L,B){return{\u0275kind:L,\u0275providers:B}}function Wr(){const L=(0,v.f3M)(v.zs3);return B=>{const A=L.get(v.z2F);if(B!==A.components[0])return;const U=L.get(qo),le=L.get(aa);1===L.get(yl)&&U.initialNavigation(),L.get(fc,null,v.XFs.Optional)?.setUpPreloading(),L.get(jr,null,v.XFs.Optional)?.init(),U.resetRootComponentType(A.componentTypes[0]),le.closed||(le.next(),le.complete(),le.unsubscribe())}}const aa=new v.OlP("",{factory:()=>new Ze.x}),yl=new v.OlP("",{providedIn:"root",factory:()=>1}),fc=new v.OlP("");function gd(L){return Fs(0,[{provide:fc,useExisting:hc},{provide:Gn,useExisting:L}])}const _u=new v.OlP("ROUTER_FORROOT_GUARD"),Gc=[Se.Ye,{provide:Ut,useClass:jt},qo,hr,{provide:Oo,useFactory:function ks(L){return L.routerState.root},deps:[qo]},Ki,[]];function Wc(){return new v.PXZ("Router",qo)}let yu=(()=>{class L{constructor(A){}static forRoot(A,U){return{ngModule:L,providers:[Gc,[],{provide:_o,multi:!0,useValue:A},{provide:_u,useFactory:Ns,deps:[[qo,new v.FiY,new v.tp0]]},{provide:os,useValue:U||{}},U?.useHash?{provide:Se.S$,useClass:Se.Do}:{provide:Se.S$,useClass:Se.b0},{provide:jr,useFactory:()=>{const L=(0,v.f3M)(Se.EM),B=(0,v.f3M)(v.R0b),A=(0,v.f3M)(os),U=(0,v.f3M)(Ro),le=(0,v.f3M)(Ut);return A.scrollOffset&&L.setOffset(A.scrollOffset),new pc(le,U,L,B,A)}},U?.preloadingStrategy?gd(U.preloadingStrategy).\u0275providers:[],{provide:v.PXZ,multi:!0,useFactory:Wc},U?.initialNavigation?_a(U):[],U?.bindToComponentInputs?Fs(8,[bs,{provide:br,useExisting:bs}]).\u0275providers:[],[{provide:za,useFactory:Wr},{provide:v.tb,multi:!0,useExisting:za}]]}}static forChild(A){return{ngModule:L,providers:[{provide:_o,multi:!0,useValue:A}]}}}return L.\u0275fac=function(A){return new(A||L)(v.LFG(_u,8))},L.\u0275mod=v.oAB({type:L}),L.\u0275inj=v.cJS({}),L})();function Ns(L){return"guarded"}function _a(L){return["disabled"===L.initialNavigation?Fs(3,[{provide:v.ip1,multi:!0,useFactory:()=>{const B=(0,v.f3M)(qo);return()=>{B.setUpLocationChangeListener()}}},{provide:yl,useValue:2}]).\u0275providers:[],"enabledBlocking"===L.initialNavigation?Fs(2,[{provide:yl,useValue:0},{provide:v.ip1,multi:!0,deps:[v.zs3],useFactory:B=>{const A=B.get(Se.V_,Promise.resolve());return()=>A.then(()=>new Promise(U=>{const le=B.get(qo),Be=B.get(aa);ui(le,()=>{U(!0)}),B.get(Ro).afterPreactivation=()=>(U(!0),Be.closed?(0,s.of)(void 0):Be),le.initialNavigation()}))}}]).\u0275providers:[]]}const za=new v.OlP("")},7852:(zn,Ct,R)=>{"use strict";R.d(Ct,{BX:()=>na,Br:()=>Ss,w:()=>Xt,dr:()=>Je,BJ:()=>At,oU:()=>Zt,cs:()=>bs,yp:()=>hn,YG:()=>Un,Sm:()=>oi,PM:()=>Ci,FN:()=>Oi,Zi:()=>Po,hM:()=>pe,wI:()=>ve,W2:()=>et,IJ:()=>Ut,W4:()=>jt,zq:()=>St,fr:()=>Kt,jY:()=>In,Gu:()=>tt,gu:()=>Ve,pK:()=>kt,Ie:()=>_n,Q$:()=>eo,q_:()=>tn,yh:()=>xt,z0:()=>Nn,fG:()=>Pn,zc:()=>ri,uN:()=>wi,I_:()=>io,nJ:()=>Pi,Wo:()=>uo,jP:()=>Fr,Nd:()=>Ji,VI:()=>gr,cJ:()=>xo,GO:()=>Zr,t9:()=>Mr,n0:()=>kr,PQ:()=>Vi,jI:()=>_e,g2:()=>Bt,Bs:()=>zt,wd:()=>yn,ho:()=>xn,sr:()=>On,Pc:()=>oa,r4:()=>Cs,HT:()=>Sr,IN:()=>Ps,SH:()=>To,X1:()=>wo,as:()=>mn,t4:()=>Lo,YI:()=>Ar,QI:()=>Vt,j9:()=>It,yF:()=>Wa});var v=R(5861),d=R(2029),y=R(6223),s=R(7582),Q=R(2438),ie=R(8645),W=R(5619),w=R(2125),se=(R(6506),R(8899),R(5298),R(8077),R(7876)),Te=R(544),ge=R(1273),we=R(8354),Me=(R(1767),R(645)),Oe=(R(7643),R(4587),R(6953)),nt=R(2181),Xe=R(4664),Ee=R(3997),ae=R(6814);const xe=se.i,ye=["*"],je=S=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(S):"function"==typeof requestAnimationFrame?requestAnimationFrame(S):setTimeout(S);let _t=(()=>{class S{constructor(P,ne){this.injector=P,this.el=ne,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(P){this.el.nativeElement.value=this.lastValue=P,Ne(this.el)}handleValueChange(P,ne){P===this.el.nativeElement&&(ne!==this.lastValue&&(this.lastValue=ne,this.onChange(ne)),Ne(this.el))}_handleBlurEvent(P){P===this.el.nativeElement&&(this.onTouched(),Ne(this.el))}registerOnChange(P){this.onChange=P}registerOnTouched(P){this.onTouched=P}setDisabledState(P){this.el.nativeElement.disabled=P}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let P;try{P=this.injector.get(y.a5)}catch{}if(!P)return;P.statusChanges&&(this.statusChanges=P.statusChanges.subscribe(()=>Ne(this.el)));const ne=P.control;ne&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Ln=>{if(typeof ne[Ln]<"u"){const Xn=ne[Ln].bind(ne);ne[Ln]=(...Zi)=>{Xn(...Zi),Ne(this.el)}}})}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,hostBindings:function(P,ne){1&P&&d.NdJ("ionBlur",function(Ln){return ne._handleBlurEvent(Ln.target)})}}),S})();const Ne=S=>{je(()=>{const re=S.nativeElement,P=null!=re.value&&re.value.toString().length>0,ne=Ft(re);Gt(re,ne);const Ge=re.closest("ion-item");Ge&&Gt(Ge,P?[...ne,"item-has-value"]:ne)})},Ft=S=>{const re=S.classList,P=[];for(let ne=0;ne<re.length;ne++){const Ge=re.item(ne);null!==Ge&&wn(Ge,"ng-")&&P.push(`ion-${Ge.substring(3)}`)}return P},Gt=(S,re)=>{const P=S.classList;P.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),P.add(...re)},wn=(S,re)=>S.substring(0,re.length)===re;let Xt=(()=>{class S extends _t{constructor(P,ne){super(P,ne)}writeValue(P){this.el.nativeElement.checked=this.lastValue=P,Ne(this.el)}_handleIonChange(P){this.handleValueChange(P,P.checked)}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionChange",function(Ln){return ne._handleIonChange(Ln.target)})},features:[d._Bn([{provide:y.JU,useExisting:S,multi:!0}]),d.qOj]}),S})(),mn=(()=>{class S extends _t{constructor(P,ne){super(P,ne)}handleInputEvent(P){this.handleValueChange(P,P.value)}registerOnChange(P){super.registerOnChange(ne=>{P(""===ne?null:parseFloat(ne))})}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-input","type","number"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionInput",function(Ln){return ne.handleInputEvent(Ln.target)})},features:[d._Bn([{provide:y.JU,useExisting:S,multi:!0}]),d.qOj]}),S})(),Vt=(()=>{class S extends _t{constructor(P,ne){super(P,ne)}_handleChangeEvent(P){this.handleValueChange(P,P.value)}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionChange",function(Ln){return ne._handleChangeEvent(Ln.target)})},features:[d._Bn([{provide:y.JU,useExisting:S,multi:!0}]),d.qOj]}),S})(),It=(()=>{class S extends _t{constructor(P,ne){super(P,ne)}_handleInputEvent(P){this.handleValueChange(P,P.value)}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.zs3),d.Y36(d.SBq))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(P,ne){1&P&&d.NdJ("ionInput",function(Ln){return ne._handleInputEvent(Ln.target)})},features:[d._Bn([{provide:y.JU,useExisting:S,multi:!0}]),d.qOj]}),S})();const at=(S,re)=>{const P=S.prototype;re.forEach(ne=>{Object.defineProperty(P,ne,{get(){return this.el[ne]},set(Ge){this.z.runOutsideAngular(()=>this.el[ne]=Ge)}})})},Wt=(S,re)=>{const P=S.prototype;re.forEach(ne=>{P[ne]=function(){const Ge=arguments;return this.z.runOutsideAngular(()=>this.el[ne].apply(this.el,Ge))}})},dn=(S,re,P)=>{P.forEach(ne=>S[ne]=(0,Q.R)(re,ne))};function Nt(S){return function(P){const{defineCustomElementFn:ne,inputs:Ge,methods:Ln}=S;return void 0!==ne&&ne(),Ge&&at(P,Ge),Ln&&Wt(P,Ln),P}}let Je=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-app"]],ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({})],S),S})(),At=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-avatar"]],ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({})],S),S})(),Zt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],S),S})(),hn=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-badge"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","mode"]})],S),S})(),Un=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],S),S})(),oi=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["collapse"]})],S),S})(),Ci=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],S),S})(),Oi=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["mode"]})],S),S})(),Po=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","mode","translucent"]})],S),S})(),pe=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-chip"]],inputs:{color:"color",disabled:"disabled",mode:"mode",outline:"outline"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","disabled","mode","outline"]})],S),S})(),ve=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],S),S})(),et=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],S),S})(),Ut=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-fab"]],inputs:{activated:"activated",edge:"edge",horizontal:"horizontal",vertical:"vertical"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["activated","edge","horizontal","vertical"],methods:["close"]})],S),S})(),jt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-fab-button"]],inputs:{activated:"activated",closeIcon:"closeIcon",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",show:"show",size:"size",target:"target",translucent:"translucent",type:"type"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["activated","closeIcon","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","show","size","target","translucent","type"]})],S),S})(),St=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-fab-list"]],inputs:{activated:"activated",side:"side"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["activated","side"]})],S),S})(),Kt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["collapse","mode","translucent"]})],S),S})(),In=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-grid"]],inputs:{fixed:"fixed"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["fixed"]})],S),S})(),tt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["collapse","mode","translucent"]})],S),S})(),Ve=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],S),S})(),kt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",shape:"shape",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","shape","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],S),S})(),_n=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],S),S})(),eo=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","mode","position"]})],S),S})(),tn=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],S),S})(),xt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-list-header"]],inputs:{color:"color",lines:"lines",mode:"mode"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","lines","mode"]})],S),S})(),Nn=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],S),S})(),Pn=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["autoHide","color","disabled","menu","mode","type"]})],S),S})(),ri=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-menu-toggle"]],inputs:{autoHide:"autoHide",menu:"menu"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["autoHide","menu"]})],S),S})(),wi=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-note"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","mode"]})],S),S})(),io=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionInput","ionFocus","ionBlur","ionKnobMoveStart","ionKnobMoveEnd"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-range"]],inputs:{activeBarStart:"activeBarStart",color:"color",debounce:"debounce",disabled:"disabled",dualKnobs:"dualKnobs",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",min:"min",mode:"mode",name:"name",pin:"pin",pinFormatter:"pinFormatter",snaps:"snaps",step:"step",ticks:"ticks",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["activeBarStart","color","debounce","disabled","dualKnobs","label","labelPlacement","legacy","max","min","mode","name","pin","pinFormatter","snaps","step","ticks","value"]})],S),S})(),Pi=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionRefresh","ionPull","ionStart"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-refresher"]],inputs:{closeDuration:"closeDuration",disabled:"disabled",pullFactor:"pullFactor",pullMax:"pullMax",pullMin:"pullMin",snapbackDuration:"snapbackDuration"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["closeDuration","disabled","pullFactor","pullMax","pullMin","snapbackDuration"],methods:["complete","cancel","getProgress"]})],S),S})(),uo=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-refresher-content"]],inputs:{pullingIcon:"pullingIcon",pullingText:"pullingText",refreshingSpinner:"refreshingSpinner",refreshingText:"refreshingText"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["pullingIcon","pullingText","refreshingSpinner","refreshingText"]})],S),S})(),Ji=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-row"]],ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({})],S),S})(),gr=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionInput","ionChange","ionCancel","ionClear","ionBlur","ionFocus"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-searchbar"]],inputs:{animated:"animated",autocomplete:"autocomplete",autocorrect:"autocorrect",cancelButtonIcon:"cancelButtonIcon",cancelButtonText:"cancelButtonText",clearIcon:"clearIcon",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",mode:"mode",placeholder:"placeholder",searchIcon:"searchIcon",showCancelButton:"showCancelButton",showClearButton:"showClearButton",spellcheck:"spellcheck",type:"type",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","clearIcon","color","debounce","disabled","enterkeyhint","inputmode","mode","placeholder","searchIcon","showCancelButton","showClearButton","spellcheck","type","value"],methods:["setFocus","getInputElement"]})],S),S})(),xo=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],S),S})(),Zr=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["disabled","layout","mode","type","value"]})],S),S})(),Mr=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionCancel","ionDismiss","ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-select"]],inputs:{cancelText:"cancelText",color:"color",compareWith:"compareWith",disabled:"disabled",expandedIcon:"expandedIcon",fill:"fill",interface:"interface",interfaceOptions:"interfaceOptions",justify:"justify",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",multiple:"multiple",name:"name",okText:"okText",placeholder:"placeholder",selectedText:"selectedText",shape:"shape",toggleIcon:"toggleIcon",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["cancelText","color","compareWith","disabled","expandedIcon","fill","interface","interfaceOptions","justify","label","labelPlacement","legacy","mode","multiple","name","okText","placeholder","selectedText","shape","toggleIcon","value"],methods:["open"]})],S),S})(),kr=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-select-option"]],inputs:{disabled:"disabled",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["disabled","value"]})],S),S})(),Vi=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-spinner"]],inputs:{color:"color",duration:"duration",name:"name",paused:"paused"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","duration","name","paused"]})],S),S})(),_e=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionSplitPaneVisible"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-split-pane"]],inputs:{contentId:"contentId",disabled:"disabled",when:"when"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["contentId","disabled","when"]})],S),S})(),Bt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionInput","ionBlur","ionFocus"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-textarea"]],inputs:{autoGrow:"autoGrow",autocapitalize:"autocapitalize",autofocus:"autofocus",clearOnEdit:"clearOnEdit",color:"color",cols:"cols",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",maxlength:"maxlength",minlength:"minlength",mode:"mode",name:"name",placeholder:"placeholder",readonly:"readonly",required:"required",rows:"rows",shape:"shape",spellcheck:"spellcheck",value:"value",wrap:"wrap"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["autoGrow","autocapitalize","autofocus","clearOnEdit","color","cols","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","maxlength","minlength","mode","name","placeholder","readonly","required","rows","shape","spellcheck","value","wrap"],methods:["setFocus","getInputElement"]})],S),S})(),zt=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-thumbnail"]],ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({})],S),S})(),yn=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","size"]})],S),S})(),xn=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement,dn(this,this.el,["ionChange","ionFocus","ionBlur"])}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",justify:"justify",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",name:"name",value:"value"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["checked","color","disabled","enableOnOffLabels","justify","labelPlacement","legacy","mode","name","value"]})],S),S})(),On=(()=>{let S=class{constructor(P,ne,Ge){this.z=Ge,P.detach(),this.el=ne.nativeElement}};return S.\u0275fac=function(P){return new(P||S)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},S.\u0275cmp=d.Xpm({type:S,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ye,decls:1,vars:0,template:function(P,ne){1&P&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),S=(0,s.gn)([Nt({inputs:["color","mode"]})],S),S})(),hi=(()=>{class S{get(P,ne){const Ge=zi();return Ge?Ge.get(P,ne):null}getBoolean(P,ne){const Ge=zi();return!!Ge&&Ge.getBoolean(P,ne)}getNumber(P,ne){const Ge=zi();return Ge?Ge.getNumber(P,ne):0}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const Ii=new d.OlP("USERCONFIG"),zi=()=>{if(typeof window<"u"){const S=window.Ionic;if(S?.config)return S.config}return null};let Lo=(()=>{class S{constructor(P,ne){this.doc=P,this.backButton=new ie.x,this.keyboardDidShow=new ie.x,this.keyboardDidHide=new ie.x,this.pause=new ie.x,this.resume=new ie.x,this.resize=new ie.x,ne.run(()=>{let Ge;this.win=P.defaultView,this.backButton.subscribeWithPriority=function(Ln,Xn){return this.subscribe(Zi=>Zi.register(Ln,ee=>ne.run(()=>Xn(ee))))},so(this.pause,P,"pause"),so(this.resume,P,"resume"),so(this.backButton,P,"ionBackButton"),so(this.resize,this.win,"resize"),so(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),so(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(Ln=>{Ge=Ln}),this.win?.cordova?P.addEventListener("deviceready",()=>{Ge("cordova")},{once:!0}):Ge("dom")})}is(P){return(0,se.a)(this.win,P)}platforms(){return(0,se.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(P){return Xi(this.win.location.href,P)}isLandscape(){return!this.isPortrait()}isPortrait(){return this.win.matchMedia?.("(orientation: portrait)").matches}testUserAgent(P){const ne=this.win.navigator;return!!(ne?.userAgent&&ne.userAgent.indexOf(P)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return S.\u0275fac=function(P){return new(P||S)(d.LFG(ae.K0),d.LFG(d.R0b))},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const Xi=(S,re)=>{re=re.replace(/[[\]\\]/g,"\\$&");const ne=new RegExp("[\\?&]"+re+"=([^&#]*)").exec(S);return ne?decodeURIComponent(ne[1].replace(/\+/g," ")):null},so=(S,re,P)=>{re&&re.addEventListener(P,ne=>{const Ge=ne?.detail;S.next(Ge)})};let To=(()=>{class S{constructor(P,ne,Ge,Ln){this.location=ne,this.serializer=Ge,this.router=Ln,this.direction=Wo,this.animated=dr,this.guessDirection="forward",this.lastNavId=-1,Ln&&Ln.events.subscribe(Xn=>{if(Xn instanceof w.OD){const Zi=Xn.restoredState?Xn.restoredState.navigationId:Xn.id;this.guessDirection=Zi<this.lastNavId?"back":"forward",this.guessAnimation=Xn.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?Xn.id:Zi}}),P.backButton.subscribeWithPriority(0,Xn=>{this.pop(),Xn()})}navigateForward(P,ne={}){return this.setDirection("forward",ne.animated,ne.animationDirection,ne.animation),this.navigate(P,ne)}navigateBack(P,ne={}){return this.setDirection("back",ne.animated,ne.animationDirection,ne.animation),this.navigate(P,ne)}navigateRoot(P,ne={}){return this.setDirection("root",ne.animated,ne.animationDirection,ne.animation),this.navigate(P,ne)}back(P={animated:!0,animationDirection:"back"}){return this.setDirection("back",P.animated,P.animationDirection,P.animation),this.location.back()}pop(){var P=this;return(0,v.Z)(function*(){let ne=P.topOutlet;for(;ne;){if(yield ne.pop())return!0;ne=ne.parentOutlet}return!1})()}setDirection(P,ne,Ge,Ln){this.direction=P,this.animated=or(P,ne,Ge),this.animationBuilder=Ln}setTopOutlet(P){this.topOutlet=P}consumeTransition(){let ne,P="root";const Ge=this.animationBuilder;return"auto"===this.direction?(P=this.guessDirection,ne=this.guessAnimation):(ne=this.animated,P=this.direction),this.direction=Wo,this.animated=dr,this.animationBuilder=void 0,{direction:P,animation:ne,animationBuilder:Ge}}navigate(P,ne){if(Array.isArray(P))return this.router.navigate(P,ne);{const Ge=this.serializer.parse(P.toString());return void 0!==ne.queryParams&&(Ge.queryParams={...ne.queryParams}),void 0!==ne.fragment&&(Ge.fragment=ne.fragment),this.router.navigateByUrl(Ge,ne)}}}return S.\u0275fac=function(P){return new(P||S)(d.LFG(Lo),d.LFG(ae.Ye),d.LFG(w.Hx),d.LFG(w.F0,8))},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();const or=(S,re,P)=>{if(!1!==re){if(void 0!==P)return P;if("forward"===S||"back"===S)return S;if("root"===S&&!0===re)return"forward"}},Wo="auto",dr=void 0;class wo{constructor(re={}){this.data=re}get(re){return this.data[re]}}let xs=(()=>{class S{constructor(){this.zone=(0,d.f3M)(d.R0b),this.applicationRef=(0,d.f3M)(d.z2F)}create(P,ne,Ge){return new ea(P,ne,this.applicationRef,this.zone,Ge)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac}),S})();class ea{constructor(re,P,ne,Ge,Ln){this.environmentInjector=re,this.injector=P,this.applicationRef=ne,this.zone=Ge,this.elementReferenceKey=Ln,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(re,P,ne,Ge){return this.zone.run(()=>new Promise(Ln=>{const Xn={...ne};void 0!==this.elementReferenceKey&&(Xn[this.elementReferenceKey]=re),Ln(hr(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,re,P,Xn,Ge,this.elementReferenceKey))}))}removeViewFromDom(re,P){return this.zone.run(()=>new Promise(ne=>{const Ge=this.elRefMap.get(P);if(Ge){Ge.destroy(),this.elRefMap.delete(P);const Ln=this.elEventsMap.get(P);Ln&&(Ln(),this.elEventsMap.delete(P))}ne()}))}}const hr=(S,re,P,ne,Ge,Ln,Xn,Zi,ee,J,G)=>{const Fe=d.zs3.create({providers:Bi(ee),parent:P}),bn=(0,d.LMc)(Zi,{environmentInjector:re,elementInjector:Fe}),pi=bn.instance,sr=bn.location.nativeElement;if(ee&&(G&&void 0!==pi[G]&&console.error(`[Ionic Error]: ${G} is a reserved property when using ${Xn.tagName.toLowerCase()}. Rename or remove the "${G}" property from ${Zi.name}.`),Object.assign(pi,ee)),J)for(const Ws of J)sr.classList.add(Ws);const hs=mi(S,pi,sr);return Xn.appendChild(sr),ne.attachView(bn.hostView),Ge.set(sr,bn),Ln.set(sr,hs),sr},bo=[we.L,we.a,we.b,we.c,we.d],mi=(S,re,P)=>S.run(()=>{const ne=bo.filter(Ge=>"function"==typeof re[Ge]).map(Ge=>{const Ln=Xn=>re[Ge](Xn.detail);return P.addEventListener(Ge,Ln),()=>P.removeEventListener(Ge,Ln)});return()=>ne.forEach(Ge=>Ge())}),Fi=new d.OlP("NavParamsToken"),Bi=S=>[{provide:Fi,useValue:S},{provide:wo,useFactory:er,deps:[Fi]}],er=S=>new wo(S),jo=(S,re)=>((S=S.filter(P=>P.stackId!==re.stackId)).push(re),S),Ur=(S,re)=>{const P=S.createUrlTree(["."],{relativeTo:re});return S.serializeUrl(P)},Ri=(S,re)=>{if(!S)return;const P=us(re);for(let ne=0;ne<P.length;ne++){if(ne>=S.length)return P[ne];if(P[ne]!==S[ne])return}},us=S=>S.split("/").map(re=>re.trim()).filter(re=>""!==re),ta=S=>{S&&(S.ref.destroy(),S.unlistenEvents())};class Xr{constructor(re,P,ne,Ge,Ln,Xn){this.containerEl=P,this.router=ne,this.navCtrl=Ge,this.zone=Ln,this.location=Xn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==re?us(re):void 0}createView(re,P){const ne=Ur(this.router,P),Ge=re?.location?.nativeElement,Ln=mi(this.zone,re.instance,Ge);return{id:this.nextId++,stackId:Ri(this.tabsPrefix,ne),unlistenEvents:Ln,element:Ge,ref:re,url:ne}}getExistingView(re){const P=Ur(this.router,re),ne=this.views.find(Ge=>Ge.url===P);return ne&&ne.ref.changeDetectorRef.reattach(),ne}setActive(re){const P=this.navCtrl.consumeTransition();let{direction:ne,animation:Ge,animationBuilder:Ln}=P;const Xn=this.activeView,Zi=((S,re)=>!re||S.stackId!==re.stackId)(re,Xn);Zi&&(ne="back",Ge=void 0);const ee=this.views.slice();let J;const G=this.router;G.getCurrentNavigation?J=G.getCurrentNavigation():G.navigations?.value&&(J=G.navigations.value),J?.extras?.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const Fe=this.views.includes(re),bn=this.insertView(re,ne);Fe||re.ref.changeDetectorRef.detectChanges();const pi=re.animationBuilder;return void 0===Ln&&"back"===ne&&!Zi&&void 0!==pi&&(Ln=pi),Xn&&(Xn.animationBuilder=Ln),this.zone.runOutsideAngular(()=>this.wait(()=>(Xn&&Xn.ref.changeDetectorRef.detach(),re.ref.changeDetectorRef.reattach(),this.transition(re,Xn,Ge,this.canGoBack(1),!1,Ln).then(()=>ko(re,bn,ee,this.location,this.zone)).then(()=>({enteringView:re,direction:ne,animation:Ge,tabSwitch:Zi})))))}canGoBack(re,P=this.getActiveStackId()){return this.getStack(P).length>re}pop(re,P=this.getActiveStackId()){return this.zone.run(()=>{const ne=this.getStack(P);if(ne.length<=re)return Promise.resolve(!1);const Ge=ne[ne.length-re-1];let Ln=Ge.url;const Xn=Ge.savedData;if(Xn){const ee=Xn.get("primary");ee?.route?._routerState?.snapshot.url&&(Ln=ee.route._routerState.snapshot.url)}const{animationBuilder:Zi}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Ln,{...Ge.savedExtras,animation:Zi}).then(()=>!0)})}startBackTransition(){const re=this.activeView;if(re){const P=this.getStack(re.stackId),ne=P[P.length-2],Ge=ne.animationBuilder;return this.wait(()=>this.transition(ne,re,"back",this.canGoBack(2),!0,Ge))}return Promise.resolve()}endBackTransition(re){re?(this.skipTransition=!0,this.pop(1)):this.activeView&&Ir(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(re){const P=this.getStack(re);return P.length>0?P[P.length-1]:void 0}getRootUrl(re){const P=this.getStack(re);return P.length>0?P[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(ta),this.activeView=void 0,this.views=[]}getStack(re){return this.views.filter(P=>P.stackId===re)}insertView(re,P){return this.activeView=re,this.views=((S,re,P)=>"root"===P?jo(S,re):"forward"===P?((S,re)=>(S.indexOf(re)>=0?S=S.filter(ne=>ne.stackId!==re.stackId||ne.id<=re.id):S.push(re),S))(S,re):((S,re)=>S.indexOf(re)>=0?S.filter(ne=>ne.stackId!==re.stackId||ne.id<=re.id):jo(S,re))(S,re))(this.views,re,P),this.views.slice()}transition(re,P,ne,Ge,Ln,Xn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(P===re)return Promise.resolve(!1);const Zi=re?re.element:void 0,ee=P?P.element:void 0,J=this.containerEl;return Zi&&Zi!==ee&&(Zi.classList.add("ion-page"),Zi.classList.add("ion-page-invisible"),Zi.parentElement!==J&&J.appendChild(Zi),J.commit)?J.commit(Zi,ee,{duration:void 0===ne?0:void 0,direction:ne,showGoBack:Ge,progressAnimation:Ln,animationBuilder:Xn}):Promise.resolve(!1)}wait(re){var P=this;return(0,v.Z)(function*(){void 0!==P.runningTask&&(yield P.runningTask,P.runningTask=void 0);const ne=P.runningTask=re();return ne.finally(()=>P.runningTask=void 0),ne})()}}const ko=(S,re,P,ne,Ge)=>"function"==typeof requestAnimationFrame?new Promise(Ln=>{requestAnimationFrame(()=>{Ir(S,re,P,ne,Ge),Ln()})}):Promise.resolve(),Ir=(S,re,P,ne,Ge)=>{Ge.run(()=>P.filter(Ln=>!re.includes(Ln)).forEach(ta)),re.forEach(Ln=>{const Zi=ne.path().split("?")[0].split("#")[0];if(Ln!==S&&Ln.url!==Zi){const ee=Ln.element;ee.setAttribute("aria-hidden","true"),ee.classList.add("ion-page-hidden"),Ln.ref.changeDetectorRef.detach()}})};let Fr=(()=>{class S{constructor(P,ne,Ge,Ln,Xn,Zi,ee,J){this.parentOutlet=J,this.activated=null,this.activatedView=null,this._activatedRoute=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new W.X(null),this.stackEvents=new d.vpe,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.parentContexts=(0,d.f3M)(w.y6),this.location=(0,d.f3M)(d.s_b),this.environmentInjector=(0,d.f3M)(d.lqb),this.config=(0,d.f3M)(hi),this.navCtrl=(0,d.f3M)(To),this.nativeEl=Ln.nativeElement,this.name=P||w.eC,this.tabsPrefix="true"===ne?Ur(Xn,ee):void 0,this.stackCtrl=new Xr(this.tabsPrefix,this.nativeEl,Xn,this.navCtrl,Zi,Ge),this.parentContexts.onChildOutletCreated(this.name,this)}set animation(P){this.nativeEl.animation=P}set animated(P){this.nativeEl.animated=P}set swipeGesture(P){this._swipeGesture=P,this.nativeEl.swipeHandler=P?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:ne=>this.stackCtrl.endBackTransition(ne)}:void 0}ngOnDestroy(){this.stackCtrl.destroy()}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const P=this.getContext();P?.route&&this.activateWith(P.route,P.injector)}new Promise(P=>(0,Te.c)(this.nativeEl,P)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(P,ne){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const ne=this.getContext();this.activatedView.savedData=new Map(ne.children.contexts);const Ge=this.activatedView.savedData.get("primary");if(Ge&&ne.route&&(Ge.route={...ne.route}),this.activatedView.savedExtras={},ne.route){const Ln=ne.route.snapshot;this.activatedView.savedExtras.queryParams=Ln.queryParams,this.activatedView.savedExtras.fragment=Ln.fragment}}const P=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(P)}}activateWith(P,ne){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=P;let Ge,Ln=this.stackCtrl.getExistingView(P);if(Ln){Ge=this.activated=Ln.ref;const Xn=Ln.savedData;Xn&&(this.getContext().children.contexts=Xn),this.updateActivatedRouteProxy(Ge.instance,P)}else{const Xn=P._futureSnapshot,Zi=this.parentContexts.getOrCreateContext(this.name).children,ee=new W.X(null),J=this.createActivatedRouteProxy(ee,P),G=new Br(J,Zi,this.location.injector);Ge=this.activated=this.location.createComponent(Xn.routeConfig.component??Xn.component,{index:this.location.length,injector:G,environmentInjector:ne??this.environmentInjector}),ee.next(Ge.instance),Ln=this.stackCtrl.createView(this.activated,P),this.proxyMap.set(Ge.instance,J),this.currentActivatedRoute$.next({component:Ge.instance,activatedRoute:P})}this.activatedView=Ln,this.navCtrl.setTopOutlet(this),this.stackCtrl.setActive(Ln).then(Xn=>{this.activateEvents.emit(Ge.instance),this.stackEvents.emit(Xn)})}canGoBack(P=1,ne){return this.stackCtrl.canGoBack(P,ne)}pop(P=1,ne){return this.stackCtrl.pop(P,ne)}getLastUrl(P){const ne=this.stackCtrl.getLastUrl(P);return ne?ne.url:void 0}getLastRouteView(P){return this.stackCtrl.getLastUrl(P)}getRootView(P){return this.stackCtrl.getRootUrl(P)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(P,ne){const Ge=new w.gz;return Ge._futureSnapshot=ne._futureSnapshot,Ge._routerState=ne._routerState,Ge.snapshot=ne.snapshot,Ge.outlet=ne.outlet,Ge.component=ne.component,Ge._paramMap=this.proxyObservable(P,"paramMap"),Ge._queryParamMap=this.proxyObservable(P,"queryParamMap"),Ge.url=this.proxyObservable(P,"url"),Ge.params=this.proxyObservable(P,"params"),Ge.queryParams=this.proxyObservable(P,"queryParams"),Ge.fragment=this.proxyObservable(P,"fragment"),Ge.data=this.proxyObservable(P,"data"),Ge}proxyObservable(P,ne){return P.pipe((0,nt.h)(Ge=>!!Ge),(0,Xe.w)(Ge=>this.currentActivatedRoute$.pipe((0,nt.h)(Ln=>null!==Ln&&Ln.component===Ge),(0,Xe.w)(Ln=>Ln&&Ln.activatedRoute[ne]),(0,Ee.x)())))}updateActivatedRouteProxy(P,ne){const Ge=this.proxyMap.get(P);if(!Ge)throw new Error("Could not find activated route proxy for view");Ge._futureSnapshot=ne._futureSnapshot,Ge._routerState=ne._routerState,Ge.snapshot=ne.snapshot,Ge.outlet=ne.outlet,Ge.component=ne.component,this.currentActivatedRoute$.next({component:P,activatedRoute:ne})}}return S.\u0275fac=function(P){return new(P||S)(d.$8M("name"),d.$8M("tabs"),d.Y36(ae.Ye),d.Y36(d.SBq),d.Y36(w.F0),d.Y36(d.R0b),d.Y36(w.gz),d.Y36(S,12))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),S})();class Br{constructor(re,P,ne){this.route=re,this.childContexts=P,this.parent=ne}get(re,P){return re===w.gz?this.route:re===w.y6?this.childContexts:this.parent.get(re,P)}}let bs=(()=>{class S{constructor(P,ne,Ge){this.routerOutlet=P,this.navCtrl=ne,this.config=Ge}onClick(P){const ne=this.defaultHref||this.config.get("backButtonDefaultHref");this.routerOutlet?.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),P.preventDefault()):null!=ne&&(this.navCtrl.navigateBack(ne,{animation:this.routerAnimation}),P.preventDefault())}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(Fr,8),d.Y36(To),d.Y36(hi))},S.\u0275dir=d.lG2({type:S,selectors:[["ion-back-button"]],hostBindings:function(P,ne){1&P&&d.NdJ("click",function(Ln){return ne.onClick(Ln)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),S})(),Ar=(()=>{class S{constructor(P,ne,Ge,Ln,Xn){this.locationStrategy=P,this.navCtrl=ne,this.elementRef=Ge,this.router=Ln,this.routerLink=Xn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){if(this.routerLink?.urlTree){const P=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=P}}onClick(P){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),P.preventDefault()}}return S.\u0275fac=function(P){return new(P||S)(d.Y36(ae.S$),d.Y36(To),d.Y36(d.SBq),d.Y36(w.F0),d.Y36(w.rH,8))},S.\u0275dir=d.lG2({type:S,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(P,ne){1&P&&d.NdJ("click",function(Ln){return ne.onClick(Ln)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[d.TTD]}),S})();class ds{constructor(re){this.ctrl=re}create(re){return this.ctrl.create(re||{})}dismiss(re,P,ne){return this.ctrl.dismiss(re,P,ne)}getTop(){return this.ctrl.getTop()}}let na=(()=>{class S extends ds{constructor(){super(Me.b)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})(),Ss=(()=>{class S extends ds{constructor(){super(Me.a)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})(),Sr=(()=>{class S extends ds{constructor(){super(Me.l)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})(),Ps=(()=>{class S extends ds{constructor(){super(Me.m),this.angularDelegate=(0,d.f3M)(xs),this.injector=(0,d.f3M)(d.zs3),this.environmentInjector=(0,d.f3M)(d.lqb)}create(P){return super.create({...P,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac}),S})(),wr=(()=>{class S extends ds{constructor(){super(Me.c),this.angularDelegate=(0,d.f3M)(xs),this.injector=(0,d.f3M)(d.zs3),this.environmentInjector=(0,d.f3M)(d.lqb)}create(P){return super.create({...P,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac}),S})(),Wa=(()=>{class S extends ds{constructor(){super(Me.t)}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275prov=d.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"}),S})();class Cs{shouldDetach(re){return!1}shouldAttach(re){return!1}store(re,P){}retrieve(re){return null}shouldReuseRoute(re,P){if(re.routeConfig!==P.routeConfig)return!1;const ne=re.params,Ge=P.params,Ln=Object.keys(ne),Xn=Object.keys(Ge);if(Ln.length!==Xn.length)return!1;for(const Zi of Ln)if(Ge[Zi]!==ne[Zi])return!1;return!0}}const pr=(S,re,P)=>()=>{if(re.defaultView&&typeof window<"u"){(0,ge.s)({...S,_zoneGate:Ln=>P.run(Ln)});const Ge="__zone_symbol__addEventListener"in re.body?"__zone_symbol__addEventListener":"addEventListener";return function mt(){var S=[];if(typeof window<"u"){var re=window;(!re.customElements||re.Element&&(!re.Element.prototype.closest||!re.Element.prototype.matches||!re.Element.prototype.remove||!re.Element.prototype.getRootNode))&&S.push(R.e(6748).then(R.t.bind(R,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||re.NodeList&&!re.NodeList.prototype.forEach||!re.fetch||!function(){try{var ne=new URL("b","http://a");return ne.pathname="c%20d","http://a/c%20d"===ne.href&&ne.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&S.push(R.e(2214).then(R.t.bind(R,2668,23)))}return Promise.all(S)}().then(()=>((S,re)=>typeof window>"u"?Promise.resolve():(0,Oe.p)().then(()=>(xe(),(0,Oe.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[1,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"activated":[32]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isPresented":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"legacy":[4]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),re))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:je,jmp:Ln=>P.runOutsideAngular(Ln),ael(Ln,Xn,Zi,ee){Ln[Ge](Xn,Zi,ee)},rel(Ln,Xn,Zi,ee){Ln.removeEventListener(Xn,Zi,ee)}}))}};let oa=(()=>{class S{static forRoot(P){return{ngModule:S,providers:[{provide:Ii,useValue:P},{provide:d.ip1,useFactory:pr,multi:!0,deps:[Ii,ae.K0,d.R0b]}]}}}return S.\u0275fac=function(P){return new(P||S)},S.\u0275mod=d.oAB({type:S}),S.\u0275inj=d.cJS({providers:[xs,Ps,wr],imports:[ae.ez]}),S})()},3999:(zn,Ct,R)=>{"use strict";R.d(Ct,{Zw:()=>Le,aw:()=>vt,X$:()=>Ue,sK:()=>gt});var v=R(1180),d=R(2029),y=R(2096),s=R(2664),Q=R(9315),ie=R(5211),W=R(4911),w=R(8180),fe=R(8645),Ae=R(4552);class De extends fe.x{constructor(_t=1/0,Ne=1/0,Ft=Ae.l){super(),this._bufferSize=_t,this._windowTime=Ne,this._timestampProvider=Ft,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Ne===1/0,this._bufferSize=Math.max(1,_t),this._windowTime=Math.max(1,Ne)}next(_t){const{isStopped:Ne,_buffer:Ft,_infiniteTimeWindow:Gt,_timestampProvider:wn,_windowTime:Xt}=this;Ne||(Ft.push(_t),!Gt&&Ft.push(wn.now()+Xt)),this._trimBuffer(),super.next(_t)}_subscribe(_t){this._throwIfClosed(),this._trimBuffer();const Ne=this._innerSubscribe(_t),{_infiniteTimeWindow:Ft,_buffer:Gt}=this,wn=Gt.slice();for(let Xt=0;Xt<wn.length&&!_t.closed;Xt+=Ft?1:2)_t.next(wn[Xt]);return this._checkFinalizedStatuses(_t),Ne}_trimBuffer(){const{_bufferSize:_t,_timestampProvider:Ne,_buffer:Ft,_infiniteTimeWindow:Gt}=this,wn=(Gt?1:2)*_t;if(_t<1/0&&wn<Ft.length&&Ft.splice(0,Ft.length-wn),!Gt){const Xt=Ne.now();let mn=0;for(let sn=1;sn<Ft.length&&Ft[sn]<=Xt;sn+=2)mn=sn;mn&&Ft.splice(0,mn+1)}}}var X=R(3020);function se(je,_t,Ne){let Ft,Gt=!1;return je&&"object"==typeof je?({bufferSize:Ft=1/0,windowTime:_t=1/0,refCount:Gt=!1,scheduler:Ne}=je):Ft=je??1/0,(0,X.B)({connector:()=>new De(Ft,_t,Ne),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Gt})}var Te=R(7398),ge=R(6328),we=R(4664);class Le{}let Me=(()=>{class je extends Le{getTranslation(Ne){return(0,y.of)({})}}return(0,v.Z)(je,"\u0275fac",function(){let _t;return function(Ft){return(_t||(_t=d.n5z(je)))(Ft||je)}}()),(0,v.Z)(je,"\u0275prov",d.Yz7({token:je,factory:je.\u0275fac})),je})();class ze{}let Ke=(()=>{class je{handle(Ne){return Ne.key}}return(0,v.Z)(je,"\u0275fac",function(Ne){return new(Ne||je)}),(0,v.Z)(je,"\u0275prov",d.Yz7({token:je,factory:je.\u0275fac})),je})();function Oe(je,_t){if(je===_t)return!0;if(null===je||null===_t)return!1;if(je!=je&&_t!=_t)return!0;let Gt,wn,Xt,Ne=typeof je;if(Ne==typeof _t&&"object"==Ne){if(!Array.isArray(je)){if(Array.isArray(_t))return!1;for(wn in Xt=Object.create(null),je){if(!Oe(je[wn],_t[wn]))return!1;Xt[wn]=!0}for(wn in _t)if(!(wn in Xt)&&typeof _t[wn]<"u")return!1;return!0}if(!Array.isArray(_t))return!1;if((Gt=je.length)==_t.length){for(wn=0;wn<Gt;wn++)if(!Oe(je[wn],_t[wn]))return!1;return!0}}return!1}function Ce(je){return typeof je<"u"&&null!==je}function nt(je){return je&&"object"==typeof je&&!Array.isArray(je)}function Xe(je,_t){let Ne=Object.assign({},je);return nt(je)&&nt(_t)&&Object.keys(_t).forEach(Ft=>{nt(_t[Ft])?Ft in je?Ne[Ft]=Xe(je[Ft],_t[Ft]):Object.assign(Ne,{[Ft]:_t[Ft]}):Object.assign(Ne,{[Ft]:_t[Ft]})}),Ne}class Ee{}let ae=(()=>{class je extends Ee{constructor(...Ne){super(...Ne),(0,v.Z)(this,"templateMatcher",/{{\s?([^{}\s]*)\s?}}/g)}interpolate(Ne,Ft){let Gt;return Gt="string"==typeof Ne?this.interpolateString(Ne,Ft):"function"==typeof Ne?this.interpolateFunction(Ne,Ft):Ne,Gt}getValue(Ne,Ft){let Gt="string"==typeof Ft?Ft.split("."):[Ft];Ft="";do{Ft+=Gt.shift(),!Ce(Ne)||!Ce(Ne[Ft])||"object"!=typeof Ne[Ft]&&Gt.length?Gt.length?Ft+=".":Ne=void 0:(Ne=Ne[Ft],Ft="")}while(Gt.length);return Ne}interpolateFunction(Ne,Ft){return Ne(Ft)}interpolateString(Ne,Ft){return Ft?Ne.replace(this.templateMatcher,(Gt,wn)=>{let Xt=this.getValue(Ft,wn);return Ce(Xt)?Xt:Gt}):Ne}}return(0,v.Z)(je,"\u0275fac",function(){let _t;return function(Ft){return(_t||(_t=d.n5z(je)))(Ft||je)}}()),(0,v.Z)(je,"\u0275prov",d.Yz7({token:je,factory:je.\u0275fac})),je})();class mt{}let xe=(()=>{class je extends mt{compile(Ne,Ft){return Ne}compileTranslations(Ne,Ft){return Ne}}return(0,v.Z)(je,"\u0275fac",function(){let _t;return function(Ft){return(_t||(_t=d.n5z(je)))(Ft||je)}}()),(0,v.Z)(je,"\u0275prov",d.Yz7({token:je,factory:je.\u0275fac})),je})();class Ze{constructor(){(0,v.Z)(this,"defaultLang",void 0),(0,v.Z)(this,"currentLang",this.defaultLang),(0,v.Z)(this,"translations",{}),(0,v.Z)(this,"langs",[]),(0,v.Z)(this,"onTranslationChange",new d.vpe),(0,v.Z)(this,"onLangChange",new d.vpe),(0,v.Z)(this,"onDefaultLangChange",new d.vpe)}}const Se=new d.OlP("USE_STORE"),ye=new d.OlP("USE_DEFAULT_LANG"),Qt=new d.OlP("DEFAULT_LANGUAGE"),dt=new d.OlP("USE_EXTEND");let gt=(()=>{class je{get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(Ne){this.isolate?this._defaultLang=Ne:this.store.defaultLang=Ne}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(Ne){this.isolate?this._currentLang=Ne:this.store.currentLang=Ne}get langs(){return this.isolate?this._langs:this.store.langs}set langs(Ne){this.isolate?this._langs=Ne:this.store.langs=Ne}get translations(){return this.isolate?this._translations:this.store.translations}set translations(Ne){this.isolate?this._translations=Ne:this.store.translations=Ne}constructor(Ne,Ft,Gt,wn,Xt,mn=!0,sn=!1,Vt=!1,It){(0,v.Z)(this,"store",void 0),(0,v.Z)(this,"currentLoader",void 0),(0,v.Z)(this,"compiler",void 0),(0,v.Z)(this,"parser",void 0),(0,v.Z)(this,"missingTranslationHandler",void 0),(0,v.Z)(this,"useDefaultLang",void 0),(0,v.Z)(this,"isolate",void 0),(0,v.Z)(this,"extend",void 0),(0,v.Z)(this,"loadingTranslations",void 0),(0,v.Z)(this,"pending",!1),(0,v.Z)(this,"_onTranslationChange",new d.vpe),(0,v.Z)(this,"_onLangChange",new d.vpe),(0,v.Z)(this,"_onDefaultLangChange",new d.vpe),(0,v.Z)(this,"_defaultLang",void 0),(0,v.Z)(this,"_currentLang",void 0),(0,v.Z)(this,"_langs",[]),(0,v.Z)(this,"_translations",{}),(0,v.Z)(this,"_translationRequests",{}),this.store=Ne,this.currentLoader=Ft,this.compiler=Gt,this.parser=wn,this.missingTranslationHandler=Xt,this.useDefaultLang=mn,this.isolate=sn,this.extend=Vt,It&&this.setDefaultLang(It)}setDefaultLang(Ne){if(Ne===this.defaultLang)return;let Ft=this.retrieveTranslations(Ne);typeof Ft<"u"?(null==this.defaultLang&&(this.defaultLang=Ne),Ft.pipe((0,w.q)(1)).subscribe(Gt=>{this.changeDefaultLang(Ne)})):this.changeDefaultLang(Ne)}getDefaultLang(){return this.defaultLang}use(Ne){if(Ne===this.currentLang)return(0,y.of)(this.translations[Ne]);let Ft=this.retrieveTranslations(Ne);return typeof Ft<"u"?(this.currentLang||(this.currentLang=Ne),Ft.pipe((0,w.q)(1)).subscribe(Gt=>{this.changeLang(Ne)}),Ft):(this.changeLang(Ne),(0,y.of)(this.translations[Ne]))}retrieveTranslations(Ne){let Ft;return(typeof this.translations[Ne]>"u"||this.extend)&&(this._translationRequests[Ne]=this._translationRequests[Ne]||this.getTranslation(Ne),Ft=this._translationRequests[Ne]),Ft}getTranslation(Ne){this.pending=!0;const Ft=this.currentLoader.getTranslation(Ne).pipe(se(1),(0,w.q)(1));return this.loadingTranslations=Ft.pipe((0,Te.U)(Gt=>this.compiler.compileTranslations(Gt,Ne)),se(1),(0,w.q)(1)),this.loadingTranslations.subscribe({next:Gt=>{this.translations[Ne]=this.extend&&this.translations[Ne]?{...Gt,...this.translations[Ne]}:Gt,this.updateLangs(),this.pending=!1},error:Gt=>{this.pending=!1}}),Ft}setTranslation(Ne,Ft,Gt=!1){Ft=this.compiler.compileTranslations(Ft,Ne),this.translations[Ne]=(Gt||this.extend)&&this.translations[Ne]?Xe(this.translations[Ne],Ft):Ft,this.updateLangs(),this.onTranslationChange.emit({lang:Ne,translations:this.translations[Ne]})}getLangs(){return this.langs}addLangs(Ne){Ne.forEach(Ft=>{-1===this.langs.indexOf(Ft)&&this.langs.push(Ft)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(Ne,Ft,Gt){let wn;if(Ft instanceof Array){let Xt={},mn=!1;for(let sn of Ft)Xt[sn]=this.getParsedResult(Ne,sn,Gt),(0,s.b)(Xt[sn])&&(mn=!0);if(mn){const sn=Ft.map(Vt=>(0,s.b)(Xt[Vt])?Xt[Vt]:(0,y.of)(Xt[Vt]));return(0,Q.D)(sn).pipe((0,Te.U)(Vt=>{let It={};return Vt.forEach((at,Wt)=>{It[Ft[Wt]]=at}),It}))}return Xt}if(Ne&&(wn=this.parser.interpolate(this.parser.getValue(Ne,Ft),Gt)),typeof wn>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(wn=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],Ft),Gt)),typeof wn>"u"){let Xt={key:Ft,translateService:this};typeof Gt<"u"&&(Xt.interpolateParams=Gt),wn=this.missingTranslationHandler.handle(Xt)}return typeof wn<"u"?wn:Ft}get(Ne,Ft){if(!Ce(Ne)||!Ne.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe((0,ge.b)(Gt=>(Gt=this.getParsedResult(Gt,Ne,Ft),(0,s.b)(Gt)?Gt:(0,y.of)(Gt))));{let Gt=this.getParsedResult(this.translations[this.currentLang],Ne,Ft);return(0,s.b)(Gt)?Gt:(0,y.of)(Gt)}}getStreamOnTranslationChange(Ne,Ft){if(!Ce(Ne)||!Ne.length)throw new Error('Parameter "key" required');return(0,ie.z)((0,W.P)(()=>this.get(Ne,Ft)),this.onTranslationChange.pipe((0,we.w)(Gt=>{const wn=this.getParsedResult(Gt.translations,Ne,Ft);return"function"==typeof wn.subscribe?wn:(0,y.of)(wn)})))}stream(Ne,Ft){if(!Ce(Ne)||!Ne.length)throw new Error('Parameter "key" required');return(0,ie.z)((0,W.P)(()=>this.get(Ne,Ft)),this.onLangChange.pipe((0,we.w)(Gt=>{const wn=this.getParsedResult(Gt.translations,Ne,Ft);return(0,s.b)(wn)?wn:(0,y.of)(wn)})))}instant(Ne,Ft){if(!Ce(Ne)||!Ne.length)throw new Error('Parameter "key" required');let Gt=this.getParsedResult(this.translations[this.currentLang],Ne,Ft);if((0,s.b)(Gt)){if(Ne instanceof Array){let wn={};return Ne.forEach((Xt,mn)=>{wn[Ne[mn]]=Ne[mn]}),wn}return Ne}return Gt}set(Ne,Ft,Gt=this.currentLang){this.translations[Gt][Ne]=this.compiler.compile(Ft,Gt),this.updateLangs(),this.onTranslationChange.emit({lang:Gt,translations:this.translations[Gt]})}changeLang(Ne){this.currentLang=Ne,this.onLangChange.emit({lang:Ne,translations:this.translations[Ne]}),null==this.defaultLang&&this.changeDefaultLang(Ne)}changeDefaultLang(Ne){this.defaultLang=Ne,this.onDefaultLangChange.emit({lang:Ne,translations:this.translations[Ne]})}reloadLang(Ne){return this.resetLang(Ne),this.getTranslation(Ne)}resetLang(Ne){this._translationRequests[Ne]=void 0,this.translations[Ne]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Ne=window.navigator.languages?window.navigator.languages[0]:null;return Ne=Ne||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof Ne>"u"?void 0:(-1!==Ne.indexOf("-")&&(Ne=Ne.split("-")[0]),-1!==Ne.indexOf("_")&&(Ne=Ne.split("_")[0]),Ne)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Ne=window.navigator.languages?window.navigator.languages[0]:null;return Ne=Ne||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,Ne}}return(0,v.Z)(je,"\u0275fac",function(Ne){return new(Ne||je)(d.LFG(Ze),d.LFG(Le),d.LFG(mt),d.LFG(Ee),d.LFG(ze),d.LFG(ye),d.LFG(Se),d.LFG(dt),d.LFG(Qt))}),(0,v.Z)(je,"\u0275prov",d.Yz7({token:je,factory:je.\u0275fac})),je})(),Ue=(()=>{class je{constructor(Ne,Ft){(0,v.Z)(this,"translate",void 0),(0,v.Z)(this,"_ref",void 0),(0,v.Z)(this,"value",""),(0,v.Z)(this,"lastKey",null),(0,v.Z)(this,"lastParams",[]),(0,v.Z)(this,"onTranslationChange",void 0),(0,v.Z)(this,"onLangChange",void 0),(0,v.Z)(this,"onDefaultLangChange",void 0),this.translate=Ne,this._ref=Ft}updateValue(Ne,Ft,Gt){let wn=Xt=>{this.value=void 0!==Xt?Xt:Ne,this.lastKey=Ne,this._ref.markForCheck()};if(Gt){let Xt=this.translate.getParsedResult(Gt,Ne,Ft);(0,s.b)(Xt.subscribe)?Xt.subscribe(wn):wn(Xt)}this.translate.get(Ne,Ft).subscribe(wn)}transform(Ne,...Ft){if(!Ne||!Ne.length)return Ne;if(Oe(Ne,this.lastKey)&&Oe(Ft,this.lastParams))return this.value;let Gt;if(Ce(Ft[0])&&Ft.length)if("string"==typeof Ft[0]&&Ft[0].length){let wn=Ft[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{Gt=JSON.parse(wn)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${Ft[0]}`)}}else"object"==typeof Ft[0]&&!Array.isArray(Ft[0])&&(Gt=Ft[0]);return this.lastKey=Ne,this.lastParams=Ft,this.updateValue(Ne,Gt),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(wn=>{this.lastKey&&wn.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(Ne,Gt,wn.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(wn=>{this.lastKey&&(this.lastKey=null,this.updateValue(Ne,Gt,wn.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(Ne,Gt))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return(0,v.Z)(je,"\u0275fac",function(Ne){return new(Ne||je)(d.Y36(gt,16),d.Y36(d.sBO,16))}),(0,v.Z)(je,"\u0275pipe",d.Yjl({name:"translate",type:je,pure:!1})),(0,v.Z)(je,"\u0275prov",d.Yz7({token:je,factory:je.\u0275fac})),je})(),vt=(()=>{class je{static forRoot(Ne={}){return{ngModule:je,providers:[Ne.loader||{provide:Le,useClass:Me},Ne.compiler||{provide:mt,useClass:xe},Ne.parser||{provide:Ee,useClass:ae},Ne.missingTranslationHandler||{provide:ze,useClass:Ke},Ze,{provide:Se,useValue:Ne.isolate},{provide:ye,useValue:Ne.useDefaultLang},{provide:dt,useValue:Ne.extend},{provide:Qt,useValue:Ne.defaultLanguage},gt]}}static forChild(Ne={}){return{ngModule:je,providers:[Ne.loader||{provide:Le,useClass:Me},Ne.compiler||{provide:mt,useClass:xe},Ne.parser||{provide:Ee,useClass:ae},Ne.missingTranslationHandler||{provide:ze,useClass:Ke},{provide:Se,useValue:Ne.isolate},{provide:ye,useValue:Ne.useDefaultLang},{provide:dt,useValue:Ne.extend},{provide:Qt,useValue:Ne.defaultLanguage},gt]}}}return(0,v.Z)(je,"\u0275fac",function(Ne){return new(Ne||je)}),(0,v.Z)(je,"\u0275mod",d.oAB({type:je})),(0,v.Z)(je,"\u0275inj",d.cJS({})),je})()},5861:(zn,Ct,R)=>{"use strict";function v(y,s,Q,ie,W,w,fe){try{var Ae=y[w](fe),De=Ae.value}catch(X){return void Q(X)}Ae.done?s(De):Promise.resolve(De).then(ie,W)}function d(y){return function(){var s=this,Q=arguments;return new Promise(function(ie,W){var w=y.apply(s,Q);function fe(De){v(w,ie,W,fe,Ae,"next",De)}function Ae(De){v(w,ie,W,fe,Ae,"throw",De)}fe(void 0)})}}R.d(Ct,{Z:()=>d})},1180:(zn,Ct,R)=>{"use strict";function v(Q){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(ie){return typeof ie}:function(ie){return ie&&"function"==typeof Symbol&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie})(Q)}function s(Q,ie,W){return(ie=function y(Q){var ie=function d(Q,ie){if("object"!==v(Q)||null===Q)return Q;var W=Q[Symbol.toPrimitive];if(void 0!==W){var w=W.call(Q,ie||"default");if("object"!==v(w))return w;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===ie?String:Number)(Q)}(Q,"string");return"symbol"===v(ie)?ie:String(ie)}(ie))in Q?Object.defineProperty(Q,ie,{value:W,enumerable:!0,configurable:!0,writable:!0}):Q[ie]=W,Q}R.d(Ct,{Z:()=>s})},7582:(zn,Ct,R)=>{"use strict";function Q(dt,gt,ct,Ue){var _t,vt=arguments.length,je=vt<3?gt:null===Ue?Ue=Object.getOwnPropertyDescriptor(gt,ct):Ue;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)je=Reflect.decorate(dt,gt,ct,Ue);else for(var Ne=dt.length-1;Ne>=0;Ne--)(_t=dt[Ne])&&(je=(vt<3?_t(je):vt>3?_t(gt,ct,je):_t(gt,ct))||je);return vt>3&&je&&Object.defineProperty(gt,ct,je),je}function X(dt,gt,ct,Ue){return new(ct||(ct=Promise))(function(je,_t){function Ne(wn){try{Gt(Ue.next(wn))}catch(Xt){_t(Xt)}}function Ft(wn){try{Gt(Ue.throw(wn))}catch(Xt){_t(Xt)}}function Gt(wn){wn.done?je(wn.value):function vt(je){return je instanceof ct?je:new ct(function(_t){_t(je)})}(wn.value).then(Ne,Ft)}Gt((Ue=Ue.apply(dt,gt||[])).next())})}function Oe(dt){return this instanceof Oe?(this.v=dt,this):new Oe(dt)}function Ce(dt,gt,ct){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var vt,Ue=ct.apply(dt,gt||[]),je=[];return vt={},_t("next"),_t("throw"),_t("return"),vt[Symbol.asyncIterator]=function(){return this},vt;function _t(mn){Ue[mn]&&(vt[mn]=function(sn){return new Promise(function(Vt,It){je.push([mn,sn,Vt,It])>1||Ne(mn,sn)})})}function Ne(mn,sn){try{!function Ft(mn){mn.value instanceof Oe?Promise.resolve(mn.value.v).then(Gt,wn):Xt(je[0][2],mn)}(Ue[mn](sn))}catch(Vt){Xt(je[0][3],Vt)}}function Gt(mn){Ne("next",mn)}function wn(mn){Ne("throw",mn)}function Xt(mn,sn){mn(sn),je.shift(),je.length&&Ne(je[0][0],je[0][1])}}function Xe(dt){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ct,gt=dt[Symbol.asyncIterator];return gt?gt.call(dt):(dt=function we(dt){var gt="function"==typeof Symbol&&Symbol.iterator,ct=gt&&dt[gt],Ue=0;if(ct)return ct.call(dt);if(dt&&"number"==typeof dt.length)return{next:function(){return dt&&Ue>=dt.length&&(dt=void 0),{value:dt&&dt[Ue++],done:!dt}}};throw new TypeError(gt?"Object is not iterable.":"Symbol.iterator is not defined.")}(dt),ct={},Ue("next"),Ue("throw"),Ue("return"),ct[Symbol.asyncIterator]=function(){return this},ct);function Ue(je){ct[je]=dt[je]&&function(_t){return new Promise(function(Ne,Ft){!function vt(je,_t,Ne,Ft){Promise.resolve(Ft).then(function(Gt){je({value:Gt,done:Ne})},_t)}(Ne,Ft,(_t=dt[je](_t)).done,_t.value)})}}}R.d(Ct,{FC:()=>Ce,KL:()=>Xe,gn:()=>Q,mG:()=>X,qq:()=>Oe})}},zn=>{zn(zn.s=248)}]);