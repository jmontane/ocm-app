(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{3175:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Ar:()=>xe,N0:()=>Ie});var d=F(8274),v=F(6895),re=F(4004),a=F(5577),q=F(9770),oe=F(9646),b=F(529);const he=new d.OlP("JWT_OPTIONS");let Ie=(()=>{class pe{constructor(ce=null){this.tokenGetter=ce&&ce.tokenGetter||function(){}}urlBase64Decode(ce){let Ke=ce.replace(/-/g,"+").replace(/_/g,"/");switch(Ke.length%4){case 0:break;case 2:Ke+="==";break;case 3:Ke+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(Ke)}b64decode(ce){let Pe="";if((ce=String(ce).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let Je,Pt,ne=0,at=0;Pt=ce.charAt(at++);~Pt&&(Je=ne%4?64*Je+Pt:Pt,ne++%4)?Pe+=String.fromCharCode(255&Je>>(-2*ne&6)):0)Pt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(Pt);return Pe}b64DecodeUnicode(ce){return decodeURIComponent(Array.prototype.map.call(this.b64decode(ce),Ke=>"%"+("00"+Ke.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(ce=this.tokenGetter()){return ce instanceof Promise?ce.then(Ke=>this._decodeToken(Ke)):this._decodeToken(ce)}_decodeToken(ce){if(!ce||""===ce)return null;const Ke=ce.split(".");if(3!==Ke.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const Pe=this.urlBase64Decode(Ke[1]);if(!Pe)throw new Error("Cannot decode the token.");return JSON.parse(Pe)}getTokenExpirationDate(ce=this.tokenGetter()){return ce instanceof Promise?ce.then(Ke=>this._getTokenExpirationDate(Ke)):this._getTokenExpirationDate(ce)}_getTokenExpirationDate(ce){let Ke;if(Ke=this.decodeToken(ce),!Ke||!Ke.hasOwnProperty("exp"))return null;const Pe=new Date(0);return Pe.setUTCSeconds(Ke.exp),Pe}isTokenExpired(ce=this.tokenGetter(),Ke){return ce instanceof Promise?ce.then(Pe=>this._isTokenExpired(Pe,Ke)):this._isTokenExpired(ce,Ke)}_isTokenExpired(ce,Ke){if(!ce||""===ce)return!0;const Pe=this.getTokenExpirationDate(ce);return Ke=Ke||0,null!==Pe&&!(Pe.valueOf()>(new Date).valueOf()+1e3*Ke)}getAuthScheme(ce,Ke){return"function"==typeof ce?ce(Ke):ce}}return pe.\u0275fac=function(ce){return new(ce||pe)(d.LFG(he))},pe.\u0275prov=d.Yz7({token:pe,factory:pe.\u0275fac}),pe})();const Ve=pe=>pe instanceof Promise?(0,q.P)(()=>pe):(0,oe.of)(pe);let K=(()=>{class pe{constructor(ce,Ke,Pe){this.jwtHelper=Ke,this.document=Pe,this.standardPorts=["80","443"],this.tokenGetter=ce.tokenGetter,this.headerName=ce.headerName||"Authorization",this.authScheme=ce.authScheme||""===ce.authScheme?ce.authScheme:"Bearer ",this.allowedDomains=ce.allowedDomains||[],this.disallowedRoutes=ce.disallowedRoutes||[],this.throwNoTokenError=ce.throwNoTokenError||!1,this.skipWhenExpired=ce.skipWhenExpired}isAllowedDomain(ce){const Ke=new URL(ce.url,this.document.location.origin);if(Ke.host===this.document.location.host)return!0;const Pe=`${Ke.hostname}${Ke.port&&!this.standardPorts.includes(Ke.port)?":"+Ke.port:""}`;return this.allowedDomains.findIndex(ne=>"string"==typeof ne?ne===Pe:ne instanceof RegExp&&ne.test(Pe))>-1}isDisallowedRoute(ce){const Ke=new URL(ce.url,this.document.location.origin);return this.disallowedRoutes.findIndex(Pe=>{if("string"==typeof Pe){const ne=new URL(Pe,this.document.location.origin);return ne.hostname===Ke.hostname&&ne.pathname===Ke.pathname}return Pe instanceof RegExp&&Pe.test(ce.url)})>-1}handleInterception(ce,Ke,Pe){const ne=this.jwtHelper.getAuthScheme(this.authScheme,Ke);if(!ce&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");let Je=(0,oe.of)(!1);return this.skipWhenExpired&&(Je=ce?Ve(this.jwtHelper.isTokenExpired(ce)):(0,oe.of)(!0)),ce?Je.pipe((0,re.U)(Pt=>Pt&&this.skipWhenExpired?Ke.clone():Ke.clone({setHeaders:{[this.headerName]:`${ne}${ce}`}})),(0,a.z)(Pt=>Pe.handle(Pt))):Pe.handle(Ke)}intercept(ce,Ke){if(!this.isAllowedDomain(ce)||this.isDisallowedRoute(ce))return Ke.handle(ce);const Pe=this.tokenGetter(ce);return Ve(Pe).pipe((0,a.z)(ne=>this.handleInterception(ne,ce,Ke)))}}return pe.\u0275fac=function(ce){return new(ce||pe)(d.LFG(he),d.LFG(Ie),d.LFG(v.K0))},pe.\u0275prov=d.Yz7({token:pe,factory:pe.\u0275fac}),pe})(),xe=(()=>{class pe{constructor(ce){if(ce)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(ce){return{ngModule:pe,providers:[{provide:b.TP,useClass:K,multi:!0},ce.jwtOptionsProvider||{provide:he,useValue:ce.config},Ie]}}}return pe.\u0275fac=function(ce){return new(ce||pe)(d.LFG(pe,12))},pe.\u0275mod=d.oAB({type:pe}),pe.\u0275inj=d.cJS({}),pe})()},7423:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Uw:()=>Pe,fo:()=>ze});var d=F(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var he=(()=>{return(de=he||(he={})).Unimplemented="UNIMPLEMENTED",de.Unavailable="UNAVAILABLE",he;var de})();class Ie extends Error{constructor(se,Ee,_t){super(se),this.message=se,this.code=Ee,this.data=_t}}const K=de=>{var se,Ee,_t,It,Gt;const Lt=de.CapacitorCustomPlatform||null,yt=de.Capacitor||{},St=yt.Plugins=yt.Plugins||{},xt=de.CapacitorPlatforms,lt=(null===(se=xt?.currentPlatform)||void 0===se?void 0:se.getPlatform)||(()=>null!==Lt?Lt.name:(de=>{var se,Ee;return de?.androidBridge?"android":null!==(Ee=null===(se=de?.webkit)||void 0===se?void 0:se.messageHandlers)&&void 0!==Ee&&Ee.bridge?"ios":"web"})(de)),bt=(null===(Ee=xt?.currentPlatform)||void 0===Ee?void 0:Ee.isNativePlatform)||(()=>"web"!==lt()),Ut=(null===(_t=xt?.currentPlatform)||void 0===_t?void 0:_t.isPluginAvailable)||(ci=>!(!Bt.get(ci)?.platforms.has(lt())&&!Nn(ci))),Nn=(null===(It=xt?.currentPlatform)||void 0===It?void 0:It.getPluginHeader)||(ci=>{var Un;return null===(Un=yt.PluginHeaders)||void 0===Un?void 0:Un.find(hi=>hi.name===ci)}),Bt=new Map,Qn=(null===(Gt=xt?.currentPlatform)||void 0===Gt?void 0:Gt.registerPlugin)||((ci,Un={})=>{const hi=Bt.get(ci);if(hi)return console.warn(`Capacitor plugin "${ci}" already registered. Cannot register plugins twice.`),hi.proxy;const Ii=lt(),yi=Nn(ci);let Bi;const Mi=function(){var Qe=(0,d.Z)(function*(){return!Bi&&Ii in Un?Bi=Bi="function"==typeof Un[Ii]?yield Un[Ii]():Un[Ii]:null!==Lt&&!Bi&&"web"in Un&&(Bi=Bi="function"==typeof Un.web?yield Un.web():Un.web),Bi});return function(){return Qe.apply(this,arguments)}}(),Ki=Qe=>{let Wt;const rn=(...oi)=>{const Di=Mi().then(ar=>{const pi=((Qe,Wt)=>{var rn,oi;if(!yi){if(Qe)return null===(oi=Qe[Wt])||void 0===oi?void 0:oi.bind(Qe);throw new Ie(`"${ci}" plugin is not implemented on ${Ii}`,he.Unimplemented)}{const Di=yi?.methods.find(ar=>Wt===ar.name);if(Di)return"promise"===Di.rtype?ar=>yt.nativePromise(ci,Wt.toString(),ar):(ar,pi)=>yt.nativeCallback(ci,Wt.toString(),ar,pi);if(Qe)return null===(rn=Qe[Wt])||void 0===rn?void 0:rn.bind(Qe)}})(ar,Qe);if(pi){const mr=pi(...oi);return Wt=mr?.remove,mr}throw new Ie(`"${ci}.${Qe}()" is not implemented on ${Ii}`,he.Unimplemented)});return"addListener"===Qe&&(Di.remove=(0,d.Z)(function*(){return Wt()})),Di};return rn.toString=()=>`${Qe.toString()}() { [capacitor code] }`,Object.defineProperty(rn,"name",{value:Qe,writable:!1,configurable:!1}),rn},Vt=Ki("addListener"),Mt=Ki("removeListener"),Ge=(Qe,Wt)=>{const rn=Vt({eventName:Qe},Wt),oi=function(){var ar=(0,d.Z)(function*(){const pi=yield rn;Mt({eventName:Qe,callbackId:pi},Wt)});return function(){return ar.apply(this,arguments)}}(),Di=new Promise(ar=>rn.then(()=>ar({remove:oi})));return Di.remove=(0,d.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield oi()}),Di},ie=new Proxy({},{get(Qe,Wt){switch(Wt){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return yi?Ge:Vt;case"removeListener":return Mt;default:return Ki(Wt)}}});return St[ci]=ie,Bt.set(ci,{name:ci,proxy:ie,platforms:new Set([...Object.keys(Un),...yi?[Ii]:[]])}),ie});return yt.convertFileSrc||(yt.convertFileSrc=ci=>ci),yt.getPlatform=lt,yt.handleError=ci=>de.console.error(ci),yt.isNativePlatform=bt,yt.isPluginAvailable=Ut,yt.pluginMethodNoop=(ci,Un,hi)=>Promise.reject(`${hi} does not have an implementation of "${Un}".`),yt.registerPlugin=Qn,yt.Exception=Ie,yt.DEBUG=!!yt.DEBUG,yt.isLoggingEnabled=!!yt.isLoggingEnabled,yt.platform=yt.getPlatform(),yt.isNative=yt.isNativePlatform(),yt},pe=(de=>de.Capacitor=K(de))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),ze=pe.registerPlugin;class Pe{constructor(se){this.listeners={},this.windowListeners={},se&&(console.warn(`Capacitor WebPlugin "${se.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=se)}addListener(se,Ee){var _t=this;this.listeners[se]||(this.listeners[se]=[]),this.listeners[se].push(Ee);const Gt=this.windowListeners[se];Gt&&!Gt.registered&&this.addWindowListener(Gt);const Lt=function(){var St=(0,d.Z)(function*(){return _t.removeListener(se,Ee)});return function(){return St.apply(this,arguments)}}(),yt=Promise.resolve({remove:Lt});return Object.defineProperty(yt,"remove",{value:(St=(0,d.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield Lt()}),function(){return St.apply(this,arguments)})}),yt;var St}removeAllListeners(){var se=this;return(0,d.Z)(function*(){se.listeners={};for(const Ee in se.windowListeners)se.removeWindowListener(se.windowListeners[Ee]);se.windowListeners={}})()}notifyListeners(se,Ee){const _t=this.listeners[se];_t&&_t.forEach(It=>It(Ee))}hasListeners(se){return!!this.listeners[se].length}registerWindowListener(se,Ee){this.windowListeners[Ee]={registered:!1,windowEventName:se,pluginEventName:Ee,handler:_t=>{this.notifyListeners(Ee,_t)}}}unimplemented(se="not implemented"){return new pe.Exception(se,he.Unimplemented)}unavailable(se="not available"){return new pe.Exception(se,he.Unavailable)}removeListener(se,Ee){var _t=this;return(0,d.Z)(function*(){const It=_t.listeners[se];if(!It)return;const Gt=It.indexOf(Ee);_t.listeners[se].splice(Gt,1),_t.listeners[se].length||_t.removeWindowListener(_t.windowListeners[se])})()}addWindowListener(se){window.addEventListener(se.windowEventName,se.handler),se.registered=!0}removeWindowListener(se){se&&(window.removeEventListener(se.windowEventName,se.handler),se.registered=!1)}}const Je=de=>encodeURIComponent(de).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Pt=de=>de.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class at extends Pe{getCookies(){return(0,d.Z)(function*(){const se=document.cookie,Ee={};return se.split(";").forEach(_t=>{if(_t.length<=0)return;let[It,Gt]=_t.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");It=Pt(It).trim(),Gt=Pt(Gt).trim(),Ee[It]=Gt}),Ee})()}setCookie(se){return(0,d.Z)(function*(){try{const Ee=Je(se.key),_t=Je(se.value),It=`; expires=${(se.expires||"").replace("expires=","")}`,Gt=(se.path||"/").replace("path=",""),Lt=null!=se.url&&se.url.length>0?`domain=${se.url}`:"";document.cookie=`${Ee}=${_t||""}${It}; path=${Gt}; ${Lt};`}catch(Ee){return Promise.reject(Ee)}})()}deleteCookie(se){return(0,d.Z)(function*(){try{document.cookie=`${se.key}=; Max-Age=0`}catch(Ee){return Promise.reject(Ee)}})()}clearCookies(){return(0,d.Z)(function*(){try{const se=document.cookie.split(";")||[];for(const Ee of se)document.cookie=Ee.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(se){return Promise.reject(se)}})()}clearAllCookies(){var se=this;return(0,d.Z)(function*(){try{yield se.clearCookies()}catch(Ee){return Promise.reject(Ee)}})()}}ze("CapacitorCookies",{web:()=>new at});const ke=function(){var de=(0,d.Z)(function*(se){return new Promise((Ee,_t)=>{const It=new FileReader;It.onload=()=>{const Gt=It.result;Ee(Gt.indexOf(",")>=0?Gt.split(",")[1]:Gt)},It.onerror=Gt=>_t(Gt),It.readAsDataURL(se)})});return function(Ee){return de.apply(this,arguments)}}();class He extends Pe{request(se){return(0,d.Z)(function*(){const Ee=((de,se={})=>{const Ee=Object.assign({method:de.method||"GET",headers:de.headers},se),It=((de={})=>{const se=Object.keys(de);return Object.keys(de).map(It=>It.toLocaleLowerCase()).reduce((It,Gt,Lt)=>(It[Gt]=de[se[Lt]],It),{})})(de.headers)["content-type"]||"";if("string"==typeof de.data)Ee.body=de.data;else if(It.includes("application/x-www-form-urlencoded")){const Gt=new URLSearchParams;for(const[Lt,yt]of Object.entries(de.data||{}))Gt.set(Lt,yt);Ee.body=Gt.toString()}else if(It.includes("multipart/form-data")){const Gt=new FormData;if(de.data instanceof FormData)de.data.forEach((yt,St)=>{Gt.append(St,yt)});else for(const yt of Object.keys(de.data))Gt.append(yt,de.data[yt]);Ee.body=Gt;const Lt=new Headers(Ee.headers);Lt.delete("content-type"),Ee.headers=Lt}else(It.includes("application/json")||"object"==typeof de.data)&&(Ee.body=JSON.stringify(de.data));return Ee})(se,se.webFetchExtra),_t=((de,se=!0)=>de?Object.entries(de).reduce((_t,It)=>{const[Gt,Lt]=It;let yt,St;return Array.isArray(Lt)?(St="",Lt.forEach(xt=>{yt=se?encodeURIComponent(xt):xt,St+=`${Gt}=${yt}&`}),St.slice(0,-1)):(yt=se?encodeURIComponent(Lt):Lt,St=`${Gt}=${yt}`),`${_t}&${St}`},"").substr(1):null)(se.params,se.shouldEncodeUrlParams),It=_t?`${se.url}?${_t}`:se.url,Gt=yield fetch(It,Ee),Lt=Gt.headers.get("content-type")||"";let St,xt,{responseType:yt="text"}=Gt.ok?se:{};switch(Lt.includes("application/json")&&(yt="json"),yt){case"arraybuffer":case"blob":xt=yield Gt.blob(),St=yield ke(xt);break;case"json":St=yield Gt.json();break;default:St=yield Gt.text()}const rt={};return Gt.headers.forEach((lt,Ce)=>{rt[Ce]=lt}),{data:St,headers:rt,status:Gt.status,url:Gt.url}})()}get(se){var Ee=this;return(0,d.Z)(function*(){return Ee.request(Object.assign(Object.assign({},se),{method:"GET"}))})()}post(se){var Ee=this;return(0,d.Z)(function*(){return Ee.request(Object.assign(Object.assign({},se),{method:"POST"}))})()}put(se){var Ee=this;return(0,d.Z)(function*(){return Ee.request(Object.assign(Object.assign({},se),{method:"PUT"}))})()}patch(se){var Ee=this;return(0,d.Z)(function*(){return Ee.request(Object.assign(Object.assign({},se),{method:"PATCH"}))})()}delete(se){var Ee=this;return(0,d.Z)(function*(){return Ee.request(Object.assign(Object.assign({},se),{method:"DELETE"}))})()}}ze("CapacitorHttp",{web:()=>new He})},425:(Ln,Dt,F)=>{"use strict";F.d(Dt,{BX:()=>cr,Br:()=>Ps,w:()=>gr,dr:()=>Ze,BJ:()=>dt,oU:()=>Ot,cs:()=>ys,yp:()=>ut,YG:()=>Me,Sm:()=>We,PM:()=>jt,FN:()=>dn,Zi:()=>Tn,wI:()=>Oi,W2:()=>Li,IJ:()=>Jt,W4:()=>Xr,zq:()=>dr,fr:()=>no,jY:()=>fo,Gu:()=>bi,gu:()=>qi,pK:()=>si,Ie:()=>En,Q$:()=>je,q_:()=>gt,yh:()=>Ft,z0:()=>gn,fG:()=>Yt,zc:()=>Gn,uN:()=>Fi,I_:()=>Hr,nJ:()=>zr,Wo:()=>hr,jP:()=>vi,Nd:()=>ro,VI:()=>Ds,cJ:()=>Ko,GO:()=>br,t9:()=>Ur,n0:()=>ca,PQ:()=>Ro,jI:()=>lo,g2:()=>Co,Bs:()=>To,wd:()=>Ia,ho:()=>zo,sr:()=>ps,Pc:()=>sl,r4:()=>Hs,HT:()=>Fo,IN:()=>ki,SH:()=>So,X1:()=>mo,as:()=>ui,t4:()=>$o,YI:()=>ma,QI:()=>wt,j9:()=>Rt,yF:()=>Tl});var d=F(8274),v=F(4006);function b(M,G,S,j){var Cn,_e=arguments.length,Et=_e<3?G:null===j?j=Object.getOwnPropertyDescriptor(G,S):j;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)Et=Reflect.decorate(M,G,S,j);else for(var Vn=M.length-1;Vn>=0;Vn--)(Cn=M[Vn])&&(Et=(_e<3?Cn(Et):_e>3?Cn(G,S,Et):Cn(G,S))||Et);return _e>3&&Et&&Object.defineProperty(G,S,Et),Et}function Ve(M,G,S,j){return new(S||(S=Promise))(function(Et,Cn){function Vn(Gi){try{ii(j.next(Gi))}catch(ir){Cn(ir)}}function Ci(Gi){try{ii(j.throw(Gi))}catch(ir){Cn(ir)}}function ii(Gi){Gi.done?Et(Gi.value):function _e(Et){return Et instanceof S?Et:new S(function(Cn){Cn(Et)})}(Gi.value).then(Vn,Ci)}ii((j=j.apply(M,G||[])).next())})}var se=F(4968),Ee=F(7579),_t=F(1135),It=F(4228),xt=(F(181),F(6439),F(7838),F(1898),F(5179)),rt=F(5730),lt=F(1843),bt=(F(6369),F(3539)),bn=(F(3457),F(4349),F(1308)),Qn=F(9300),ci=F(3900),Un=F(4671),hi=F(4482),Ii=F(5403);function Bi(M,G){return M===G}var Mi=F(6895);const Ki=xt.i,Ge=["*"],Di=M=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(M):"function"==typeof requestAnimationFrame?requestAnimationFrame(M):setTimeout(M),ar=M=>!!M.resolveComponentFactory;let pi=(()=>{class M{constructor(S,j){this.injector=S,this.el=j,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(S){this.el.nativeElement.value=this.lastValue=S??"",mr(this.el)}handleChangeEvent(S,j){S===this.el.nativeElement&&(j!==this.lastValue&&(this.lastValue=j,this.onChange(j)),mr(this.el))}_handleBlurEvent(S){S===this.el.nativeElement&&(this.onTouched(),mr(this.el))}registerOnChange(S){this.onChange=S}registerOnTouched(S){this.onTouched=S}setDisabledState(S){this.el.nativeElement.disabled=S}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let S;try{S=this.injector.get(v.a5)}catch{}if(!S)return;S.statusChanges&&(this.statusChanges=S.statusChanges.subscribe(()=>mr(this.el)));const j=S.control;j&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(Et=>{if(typeof j[Et]<"u"){const Cn=j[Et].bind(j);j[Et]=(...Vn)=>{Cn(...Vn),mr(this.el)}}})}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.zs3),d.Y36(d.SBq))},M.\u0275dir=d.lG2({type:M,hostBindings:function(S,j){1&S&&d.NdJ("ionBlur",function(Et){return j._handleBlurEvent(Et.target)})}}),M})();const mr=M=>{Di(()=>{const G=M.nativeElement,S=null!=G.value&&G.value.toString().length>0,j=Si(G);vr(G,j);const _e=G.closest("ion-item");_e&&vr(_e,S?[...j,"item-has-value"]:j)})},Si=M=>{const G=M.classList,S=[];for(let j=0;j<G.length;j++){const _e=G.item(j);null!==_e&&xr(_e,"ng-")&&S.push(`ion-${_e.substring(3)}`)}return S},vr=(M,G)=>{const S=M.classList;S.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),S.add(...G)},xr=(M,G)=>M.substring(0,G.length)===G;let gr=(()=>{class M extends pi{constructor(S,j){super(S,j)}writeValue(S){this.el.nativeElement.checked=this.lastValue=S??!1,mr(this.el)}_handleIonChange(S){this.handleChangeEvent(S,S.checked)}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.zs3),d.Y36(d.SBq))},M.\u0275dir=d.lG2({type:M,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function(S,j){1&S&&d.NdJ("ionChange",function(Et){return j._handleIonChange(Et.target)})},features:[d._Bn([{provide:v.JU,useExisting:M,multi:!0}]),d.qOj]}),M})(),ui=(()=>{class M extends pi{constructor(S,j){super(S,j)}_handleIonChange(S){this.handleChangeEvent(S,S.value)}registerOnChange(S){super.registerOnChange(j=>{S(""===j?null:parseFloat(j))})}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.zs3),d.Y36(d.SBq))},M.\u0275dir=d.lG2({type:M,selectors:[["ion-input","type","number"]],hostBindings:function(S,j){1&S&&d.NdJ("ionChange",function(Et){return j._handleIonChange(Et.target)})},features:[d._Bn([{provide:v.JU,useExisting:M,multi:!0}]),d.qOj]}),M})(),wt=(()=>{class M extends pi{constructor(S,j){super(S,j)}_handleChangeEvent(S){this.handleChangeEvent(S,S.value)}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.zs3),d.Y36(d.SBq))},M.\u0275dir=d.lG2({type:M,selectors:[["ion-range"],["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function(S,j){1&S&&d.NdJ("ionChange",function(Et){return j._handleChangeEvent(Et.target)})},features:[d._Bn([{provide:v.JU,useExisting:M,multi:!0}]),d.qOj]}),M})(),Rt=(()=>{class M extends pi{constructor(S,j){super(S,j)}_handleInputEvent(S){this.handleChangeEvent(S,S.value)}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.zs3),d.Y36(d.SBq))},M.\u0275dir=d.lG2({type:M,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"]],hostBindings:function(S,j){1&S&&d.NdJ("ionChange",function(Et){return j._handleInputEvent(Et.target)})},features:[d._Bn([{provide:v.JU,useExisting:M,multi:!0}]),d.qOj]}),M})();const _n=(M,G)=>{const S=M.prototype;G.forEach(j=>{Object.defineProperty(S,j,{get(){return this.el[j]},set(_e){this.z.runOutsideAngular(()=>this.el[j]=_e)}})})},Ue=(M,G)=>{const S=M.prototype;G.forEach(j=>{S[j]=function(){const _e=arguments;return this.z.runOutsideAngular(()=>this.el[j].apply(this.el,_e))}})},Ht=(M,G,S)=>{S.forEach(j=>M[j]=(0,se.R)(G,j))};function k(M){return function(S){const{defineCustomElementFn:j,inputs:_e,methods:Et}=M;return void 0!==j&&j(),_e&&_n(S,_e),Et&&Ue(S,Et),S}}let Ze=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-app"]],ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0})],M),M})(),dt=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-avatar"]],ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0})],M),M})(),Ot=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-back-button"]],inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"]})],M),M})(),ut=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-badge"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","mode"]})],M),M})(),Me=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionFocus","ionBlur"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],M),M})(),We=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["collapse"]})],M),M})(),jt=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],M),M})(),dn=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["mode"]})],M),M})(),Tn=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","mode","translucent"]})],M),M})(),Oi=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],M),M})(),Li=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],M),M})(),Jt=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-fab"]],inputs:{activated:"activated",edge:"edge",horizontal:"horizontal",vertical:"vertical"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["activated","edge","horizontal","vertical"],methods:["close"]})],M),M})(),Xr=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionFocus","ionBlur"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-fab-button"]],inputs:{activated:"activated",closeIcon:"closeIcon",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",show:"show",size:"size",target:"target",translucent:"translucent",type:"type"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["activated","closeIcon","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","show","size","target","translucent","type"]})],M),M})(),dr=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-fab-list"]],inputs:{activated:"activated",side:"side"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["activated","side"]})],M),M})(),no=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["collapse","mode","translucent"]})],M),M})(),fo=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-grid"]],inputs:{fixed:"fixed"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["fixed"]})],M),M})(),bi=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["collapse","mode","translucent"]})],M),M})(),qi=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],M),M})(),si=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","debounce","disabled","enterkeyhint","inputmode","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],M),M})(),En=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],M),M})(),je=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","mode","position"]})],M),M})(),gt=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],M),M})(),Ft=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-list-header"]],inputs:{color:"color",lines:"lines",mode:"mode"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","lines","mode"]})],M),M})(),gn=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],M),M})(),Yt=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["autoHide","color","disabled","menu","mode","type"]})],M),M})(),Gn=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-menu-toggle"]],inputs:{autoHide:"autoHide",menu:"menu"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["autoHide","menu"]})],M),M})(),Fi=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-note"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","mode"]})],M),M})(),Hr=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionChange","ionFocus","ionBlur","ionKnobMoveStart","ionKnobMoveEnd"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-range"]],inputs:{activeBarStart:"activeBarStart",color:"color",debounce:"debounce",disabled:"disabled",dualKnobs:"dualKnobs",max:"max",min:"min",mode:"mode",name:"name",pin:"pin",pinFormatter:"pinFormatter",snaps:"snaps",step:"step",ticks:"ticks",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["activeBarStart","color","debounce","disabled","dualKnobs","max","min","mode","name","pin","pinFormatter","snaps","step","ticks","value"]})],M),M})(),zr=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionRefresh","ionPull","ionStart"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-refresher"]],inputs:{closeDuration:"closeDuration",disabled:"disabled",pullFactor:"pullFactor",pullMax:"pullMax",pullMin:"pullMin",snapbackDuration:"snapbackDuration"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["closeDuration","disabled","pullFactor","pullMax","pullMin","snapbackDuration"],methods:["complete","cancel","getProgress"]})],M),M})(),hr=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-refresher-content"]],inputs:{pullingIcon:"pullingIcon",pullingText:"pullingText",refreshingSpinner:"refreshingSpinner",refreshingText:"refreshingText"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["pullingIcon","pullingText","refreshingSpinner","refreshingText"]})],M),M})(),ro=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-row"]],ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0})],M),M})(),Ds=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionInput","ionChange","ionCancel","ionClear","ionBlur","ionFocus"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-searchbar"]],inputs:{animated:"animated",autocomplete:"autocomplete",autocorrect:"autocorrect",cancelButtonIcon:"cancelButtonIcon",cancelButtonText:"cancelButtonText",clearIcon:"clearIcon",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",mode:"mode",placeholder:"placeholder",searchIcon:"searchIcon",showCancelButton:"showCancelButton",showClearButton:"showClearButton",spellcheck:"spellcheck",type:"type",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","clearIcon","color","debounce","disabled","enterkeyhint","inputmode","mode","placeholder","searchIcon","showCancelButton","showClearButton","spellcheck","type","value"],methods:["setFocus","getInputElement"]})],M),M})(),Ko=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionChange"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],M),M})(),br=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["disabled","layout","mode","type","value"]})],M),M})(),Ur=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionChange","ionCancel","ionDismiss","ionFocus","ionBlur"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-select"]],inputs:{cancelText:"cancelText",compareWith:"compareWith",disabled:"disabled",interface:"interface",interfaceOptions:"interfaceOptions",mode:"mode",multiple:"multiple",name:"name",okText:"okText",placeholder:"placeholder",selectedText:"selectedText",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["cancelText","compareWith","disabled","interface","interfaceOptions","mode","multiple","name","okText","placeholder","selectedText","value"],methods:["open"]})],M),M})(),ca=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-select-option"]],inputs:{disabled:"disabled",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["disabled","value"]})],M),M})(),Ro=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-spinner"]],inputs:{color:"color",duration:"duration",name:"name",paused:"paused"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","duration","name","paused"]})],M),M})(),lo=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionSplitPaneVisible"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-split-pane"]],inputs:{contentId:"contentId",disabled:"disabled",when:"when"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["contentId","disabled","when"]})],M),M})(),Co=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionChange","ionInput","ionBlur","ionFocus"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-textarea"]],inputs:{autoGrow:"autoGrow",autocapitalize:"autocapitalize",autofocus:"autofocus",clearOnEdit:"clearOnEdit",color:"color",cols:"cols",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",maxlength:"maxlength",minlength:"minlength",mode:"mode",name:"name",placeholder:"placeholder",readonly:"readonly",required:"required",rows:"rows",spellcheck:"spellcheck",value:"value",wrap:"wrap"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["autoGrow","autocapitalize","autofocus","clearOnEdit","color","cols","debounce","disabled","enterkeyhint","inputmode","maxlength","minlength","mode","name","placeholder","readonly","required","rows","spellcheck","value","wrap"],methods:["setFocus","getInputElement"]})],M),M})(),To=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-thumbnail"]],ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0})],M),M})(),Ia=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","size"]})],M),M})(),zo=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement,Ht(this,this.el,["ionChange","ionFocus","ionBlur"])}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-toggle"]],inputs:{checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",mode:"mode",name:"name",value:"value"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["checked","color","disabled","enableOnOffLabels","mode","name","value"]})],M),M})(),ps=(()=>{let M=class{constructor(S,j,_e){this.z=_e,S.detach(),this.el=j.nativeElement}};return M.\u0275fac=function(S){return new(S||M)(d.Y36(d.sBO),d.Y36(d.SBq),d.Y36(d.R0b))},M.\u0275cmp=d.Xpm({type:M,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:Ge,decls:1,vars:0,template:function(S,j){1&S&&(d.F$t(),d.Hsn(0))},encapsulation:2,changeDetection:0}),M=b([k({defineCustomElementFn:void 0,inputs:["color","mode"]})],M),M})();class mo{constructor(G={}){this.data=G}get(G){return this.data[G]}}let Is=(()=>{class M{constructor(S,j){this.zone=S,this.appRef=j}create(S,j,_e,Et){return new Ms(S,j,_e,this.appRef,this.zone,Et)}}return M.\u0275fac=function(S){return new(S||M)(d.LFG(d.R0b),d.LFG(d.z2F))},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac}),M})();class Ms{constructor(G,S,j,_e,Et,Cn){this.resolverOrInjector=G,this.injector=S,this.location=j,this.appRef=_e,this.zone=Et,this.elementReferenceKey=Cn,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(G,S,j,_e){return this.zone.run(()=>new Promise(Et=>{const Cn=Object.assign({},j);void 0!==this.elementReferenceKey&&(Cn[this.elementReferenceKey]=G),Et(go(this.zone,this.resolverOrInjector,this.injector,this.location,this.appRef,this.elRefMap,this.elEventsMap,G,S,Cn,_e))}))}removeViewFromDom(G,S){return this.zone.run(()=>new Promise(j=>{const _e=this.elRefMap.get(S);if(_e){_e.destroy(),this.elRefMap.delete(S);const Et=this.elEventsMap.get(S);Et&&(Et(),this.elEventsMap.delete(S))}j()}))}}const go=(M,G,S,j,_e,Et,Cn,Vn,Ci,ii,Gi)=>{let ir;const sr=d.zs3.create({providers:Qs(ii),parent:S});if(G&&ar(G)){const ts=G.resolveComponentFactory(Ci);ir=j?j.createComponent(ts,j.length,sr):ts.create(sr)}else{if(!j)return null;ir=j.createComponent(Ci,{index:j.indexOf,injector:sr,environmentInjector:G})}const _o=ir.instance,yo=ir.location.nativeElement;if(ii&&Object.assign(_o,ii),Gi)for(const ts of Gi)yo.classList.add(ts);const Os=da(M,_o,yo);return Vn.appendChild(yo),j||_e.attachView(ir.hostView),ir.changeDetectorRef.reattach(),Et.set(yo,ir),Cn.set(yo,Os),yo},Ss=[lt.L,lt.a,lt.b,lt.c,lt.d],da=(M,G,S)=>M.run(()=>{const j=Ss.filter(_e=>"function"==typeof G[_e]).map(_e=>{const Et=Cn=>G[_e](Cn.detail);return S.addEventListener(_e,Et),()=>S.removeEventListener(_e,Et)});return()=>j.forEach(_e=>_e())}),ha=new d.OlP("NavParamsToken"),Qs=M=>[{provide:ha,useValue:M},{provide:mo,useFactory:fs,deps:[ha]}],fs=M=>new mo(M),Uo=(M,G)=>((M=M.filter(S=>S.stackId!==G.stackId)).push(G),M),As=(M,G)=>{const S=M.createUrlTree(["."],{relativeTo:G});return M.serializeUrl(S)},$s=(M,G)=>{if(!M)return;const S=Lo(G);for(let j=0;j<S.length;j++){if(j>=M.length)return S[j];if(S[j]!==M[j])return}},Lo=M=>M.split("/").map(G=>G.trim()).filter(G=>""!==G),ji=M=>{M&&(M.ref.destroy(),M.unlistenEvents())};class ea{constructor(G,S,j,_e,Et,Cn){this.containerEl=S,this.router=j,this.navCtrl=_e,this.zone=Et,this.location=Cn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==G?Lo(G):void 0}createView(G,S){var j;const _e=As(this.router,S),Et=null===(j=G?.location)||void 0===j?void 0:j.nativeElement,Cn=da(this.zone,G.instance,Et);return{id:this.nextId++,stackId:$s(this.tabsPrefix,_e),unlistenEvents:Cn,element:Et,ref:G,url:_e}}getExistingView(G){const S=As(this.router,G),j=this.views.find(_e=>_e.url===S);return j&&j.ref.changeDetectorRef.reattach(),j}setActive(G){var S,j;const _e=this.navCtrl.consumeTransition();let{direction:Et,animation:Cn,animationBuilder:Vn}=_e;const Ci=this.activeView,ii=((M,G)=>!G||M.stackId!==G.stackId)(G,Ci);ii&&(Et="back",Cn=void 0);const Gi=this.views.slice();let ir;const sr=this.router;sr.getCurrentNavigation?ir=sr.getCurrentNavigation():!(null===(S=sr.navigations)||void 0===S)&&S.value&&(ir=sr.navigations.value),null!==(j=ir?.extras)&&void 0!==j&&j.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const _o=this.views.includes(G),yo=this.insertView(G,Et);_o||G.ref.changeDetectorRef.detectChanges();const Os=G.animationBuilder;return void 0===Vn&&"back"===Et&&!ii&&void 0!==Os&&(Vn=Os),Ci&&(Ci.animationBuilder=Vn),this.zone.runOutsideAngular(()=>this.wait(()=>(Ci&&Ci.ref.changeDetectorRef.detach(),G.ref.changeDetectorRef.reattach(),this.transition(G,Ci,Cn,this.canGoBack(1),!1,Vn).then(()=>Vo(G,yo,Gi,this.location,this.zone)).then(()=>({enteringView:G,direction:Et,animation:Cn,tabSwitch:ii})))))}canGoBack(G,S=this.getActiveStackId()){return this.getStack(S).length>G}pop(G,S=this.getActiveStackId()){return this.zone.run(()=>{var j,_e;const Et=this.getStack(S);if(Et.length<=G)return Promise.resolve(!1);const Cn=Et[Et.length-G-1];let Vn=Cn.url;const Ci=Cn.savedData;if(Ci){const Gi=Ci.get("primary");null!==(_e=null===(j=Gi?.route)||void 0===j?void 0:j._routerState)&&void 0!==_e&&_e.snapshot.url&&(Vn=Gi.route._routerState.snapshot.url)}const{animationBuilder:ii}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(Vn,Object.assign(Object.assign({},Cn.savedExtras),{animation:ii})).then(()=>!0)})}startBackTransition(){const G=this.activeView;if(G){const S=this.getStack(G.stackId),j=S[S.length-2],_e=j.animationBuilder;return this.wait(()=>this.transition(j,G,"back",this.canGoBack(2),!0,_e))}return Promise.resolve()}endBackTransition(G){G?(this.skipTransition=!0,this.pop(1)):this.activeView&&jo(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(G){const S=this.getStack(G);return S.length>0?S[S.length-1]:void 0}getRootUrl(G){const S=this.getStack(G);return S.length>0?S[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(ji),this.activeView=void 0,this.views=[]}getStack(G){return this.views.filter(S=>S.stackId===G)}insertView(G,S){return this.activeView=G,this.views=((M,G,S)=>"root"===S?Uo(M,G):"forward"===S?((M,G)=>(M.indexOf(G)>=0?M=M.filter(j=>j.stackId!==G.stackId||j.id<=G.id):M.push(G),M))(M,G):((M,G)=>M.indexOf(G)>=0?M.filter(j=>j.stackId!==G.stackId||j.id<=G.id):Uo(M,G))(M,G))(this.views,G,S),this.views.slice()}transition(G,S,j,_e,Et,Cn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(S===G)return Promise.resolve(!1);const Vn=G?G.element:void 0,Ci=S?S.element:void 0,ii=this.containerEl;return Vn&&Vn!==Ci&&(Vn.classList.add("ion-page"),Vn.classList.add("ion-page-invisible"),Vn.parentElement!==ii&&ii.appendChild(Vn),ii.commit)?ii.commit(Vn,Ci,{deepWait:!0,duration:void 0===j?0:void 0,direction:j,showGoBack:_e,progressAnimation:Et,animationBuilder:Cn}):Promise.resolve(!1)}wait(G){return Ve(this,void 0,void 0,function*(){void 0!==this.runningTask&&(yield this.runningTask,this.runningTask=void 0);const S=this.runningTask=G();return S.finally(()=>this.runningTask=void 0),S})}}const Vo=(M,G,S,j,_e)=>"function"==typeof requestAnimationFrame?new Promise(Et=>{requestAnimationFrame(()=>{jo(M,G,S,j,_e),Et()})}):Promise.resolve(),jo=(M,G,S,j,_e)=>{_e.run(()=>S.filter(Et=>!G.includes(Et)).forEach(ji)),G.forEach(Et=>{const Vn=j.path().split("?")[0].split("#")[0];if(Et!==M&&Et.url!==Vn){const Ci=Et.element;Ci.setAttribute("aria-hidden","true"),Ci.classList.add("ion-page-hidden"),Et.ref.changeDetectorRef.detach()}})};let ms=(()=>{class M{get(S,j){const _e=gs();return _e?_e.get(S,j):null}getBoolean(S,j){const _e=gs();return!!_e&&_e.getBoolean(S,j)}getNumber(S,j){const _e=gs();return _e?_e.getNumber(S,j):0}}return M.\u0275fac=function(S){return new(S||M)},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})();const Zs=new d.OlP("USERCONFIG"),gs=()=>{if(typeof window<"u"){const M=window.Ionic;if(M?.config)return M.config}return null};let $o=(()=>{class M{constructor(S,j){this.doc=S,this.backButton=new Ee.x,this.keyboardDidShow=new Ee.x,this.keyboardDidHide=new Ee.x,this.pause=new Ee.x,this.resume=new Ee.x,this.resize=new Ee.x,j.run(()=>{var _e;let Et;this.win=S.defaultView,this.backButton.subscribeWithPriority=function(Cn,Vn){return this.subscribe(Ci=>Ci.register(Cn,ii=>j.run(()=>Vn(ii))))},Zo(this.pause,S,"pause"),Zo(this.resume,S,"resume"),Zo(this.backButton,S,"ionBackButton"),Zo(this.resize,this.win,"resize"),Zo(this.keyboardDidShow,this.win,"ionKeyboardDidShow"),Zo(this.keyboardDidHide,this.win,"ionKeyboardDidHide"),this._readyPromise=new Promise(Cn=>{Et=Cn}),null!==(_e=this.win)&&void 0!==_e&&_e.cordova?S.addEventListener("deviceready",()=>{Et("cordova")},{once:!0}):Et("dom")})}is(S){return(0,xt.a)(this.win,S)}platforms(){return(0,xt.g)(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(S){return co(this.win.location.href,S)}isLandscape(){return!this.isPortrait()}isPortrait(){var S,j;return null===(j=(S=this.win).matchMedia)||void 0===j?void 0:j.call(S,"(orientation: portrait)").matches}testUserAgent(S){const j=this.win.navigator;return!!(j?.userAgent&&j.userAgent.indexOf(S)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return M.\u0275fac=function(S){return new(S||M)(d.LFG(Mi.K0),d.LFG(d.R0b))},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})();const co=(M,G)=>{G=G.replace(/[[\]\\]/g,"\\$&");const j=new RegExp("[\\?&]"+G+"=([^&#]*)").exec(M);return j?decodeURIComponent(j[1].replace(/\+/g," ")):null},Zo=(M,G,S)=>{G&&G.addEventListener(S,j=>{M.next(j?.detail)})};let So=(()=>{class M{constructor(S,j,_e,Et){this.location=j,this.serializer=_e,this.router=Et,this.direction=Aa,this.animated=_s,this.guessDirection="forward",this.lastNavId=-1,Et&&Et.events.subscribe(Cn=>{if(Cn instanceof It.OD){const Vn=Cn.restoredState?Cn.restoredState.navigationId:Cn.id;this.guessDirection=Vn<this.lastNavId?"back":"forward",this.guessAnimation=Cn.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?Cn.id:Vn}}),S.backButton.subscribeWithPriority(0,Cn=>{this.pop(),Cn()})}navigateForward(S,j={}){return this.setDirection("forward",j.animated,j.animationDirection,j.animation),this.navigate(S,j)}navigateBack(S,j={}){return this.setDirection("back",j.animated,j.animationDirection,j.animation),this.navigate(S,j)}navigateRoot(S,j={}){return this.setDirection("root",j.animated,j.animationDirection,j.animation),this.navigate(S,j)}back(S={animated:!0,animationDirection:"back"}){return this.setDirection("back",S.animated,S.animationDirection,S.animation),this.location.back()}pop(){return Ve(this,void 0,void 0,function*(){let S=this.topOutlet;for(;S&&!(yield S.pop());)S=S.parentOutlet})}setDirection(S,j,_e,Et){this.direction=S,this.animated=kr(S,j,_e),this.animationBuilder=Et}setTopOutlet(S){this.topOutlet=S}consumeTransition(){let j,S="root";const _e=this.animationBuilder;return"auto"===this.direction?(S=this.guessDirection,j=this.guessAnimation):(j=this.animated,S=this.direction),this.direction=Aa,this.animated=_s,this.animationBuilder=void 0,{direction:S,animation:j,animationBuilder:_e}}navigate(S,j){if(Array.isArray(S))return this.router.navigate(S,j);{const _e=this.serializer.parse(S.toString());return void 0!==j.queryParams&&(_e.queryParams=Object.assign({},j.queryParams)),void 0!==j.fragment&&(_e.fragment=j.fragment),this.router.navigateByUrl(_e,j)}}}return M.\u0275fac=function(S){return new(S||M)(d.LFG($o),d.LFG(Mi.Ye),d.LFG(It.Hx),d.LFG(It.F0,8))},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})();const kr=(M,G,S)=>{if(!1!==G){if(void 0!==S)return S;if("forward"===M||"back"===M)return M;if("root"===M&&!0===G)return"forward"}},Aa="auto",_s=void 0;let vi=(()=>{class M{constructor(S,j,_e,Et,Cn,Vn,Ci,ii,Gi,ir,sr,_o,yo){this.parentContexts=S,this.location=j,this.config=Cn,this.navCtrl=Vn,this.componentFactoryResolver=Ci,this.parentOutlet=yo,this.activated=null,this.activatedView=null,this._activatedRoute=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new _t.X(null),this.stackEvents=new d.vpe,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.nativeEl=Gi.nativeElement,this.name=_e||It.eC,this.tabsPrefix="true"===Et?As(ir,_o):void 0,this.stackCtrl=new ea(this.tabsPrefix,this.nativeEl,ir,Vn,sr,ii),S.onChildOutletCreated(this.name,this)}set animation(S){this.nativeEl.animation=S}set animated(S){this.nativeEl.animated=S}set swipeGesture(S){this._swipeGesture=S,this.nativeEl.swipeHandler=S?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:j=>this.stackCtrl.endBackTransition(j)}:void 0}ngOnDestroy(){this.stackCtrl.destroy()}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){if(!this.activated){const S=this.getContext();S?.route&&this.activateWith(S.route,S.resolver||null)}new Promise(S=>(0,rt.c)(this.nativeEl,S)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(S,j){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const j=this.getContext();this.activatedView.savedData=new Map(j.children.contexts);const _e=this.activatedView.savedData.get("primary");if(_e&&j.route&&(_e.route=Object.assign({},j.route)),this.activatedView.savedExtras={},j.route){const Et=j.route.snapshot;this.activatedView.savedExtras.queryParams=Et.queryParams,this.activatedView.savedExtras.fragment=Et.fragment}}const S=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(S)}}activateWith(S,j){var _e;if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=S;let Et,Cn=this.stackCtrl.getExistingView(S);if(Cn){Et=this.activated=Cn.ref;const Vn=Cn.savedData;Vn&&(this.getContext().children.contexts=Vn),this.updateActivatedRouteProxy(Et.instance,S)}else{const Vn=S._futureSnapshot;if(null==Vn.routeConfig.component&&null==this.environmentInjector)return void console.warn('[Ionic Warning]: You must supply an environmentInjector to use standalone components with routing:\n\nIn your component class, add:\n\n   import { EnvironmentInjector } from \'@angular/core\';\n   constructor(public environmentInjector: EnvironmentInjector) {}\n\nIn your router outlet template, add:\n\n   <ion-router-outlet [environmentInjector]="environmentInjector"></ion-router-outlet>\n\nAlternatively, if you are routing within ion-tabs:\n\n   <ion-tabs [environmentInjector]="environmentInjector"></ion-tabs>');const Ci=this.parentContexts.getOrCreateContext(this.name).children,ii=new _t.X(null),Gi=this.createActivatedRouteProxy(ii,S),ir=new fa(Gi,Ci,this.location.injector),sr=null!==(_e=Vn.routeConfig.component)&&void 0!==_e?_e:Vn.component;if((j=j||this.componentFactoryResolver)&&ar(j)){const _o=j.resolveComponentFactory(sr);Et=this.activated=this.location.createComponent(_o,this.location.length,ir)}else Et=this.activated=this.location.createComponent(sr,{index:this.location.length,injector:ir,environmentInjector:j??this.environmentInjector});ii.next(Et.instance),Cn=this.stackCtrl.createView(this.activated,S),this.proxyMap.set(Et.instance,Gi),this.currentActivatedRoute$.next({component:Et.instance,activatedRoute:S})}this.activatedView=Cn,this.navCtrl.setTopOutlet(this),this.stackCtrl.setActive(Cn).then(Vn=>{this.activateEvents.emit(Et.instance),this.stackEvents.emit(Vn)})}canGoBack(S=1,j){return this.stackCtrl.canGoBack(S,j)}pop(S=1,j){return this.stackCtrl.pop(S,j)}getLastUrl(S){const j=this.stackCtrl.getLastUrl(S);return j?j.url:void 0}getLastRouteView(S){return this.stackCtrl.getLastUrl(S)}getRootView(S){return this.stackCtrl.getRootUrl(S)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(S,j){const _e=new It.gz;return _e._futureSnapshot=j._futureSnapshot,_e._routerState=j._routerState,_e.snapshot=j.snapshot,_e.outlet=j.outlet,_e.component=j.component,_e._paramMap=this.proxyObservable(S,"paramMap"),_e._queryParamMap=this.proxyObservable(S,"queryParamMap"),_e.url=this.proxyObservable(S,"url"),_e.params=this.proxyObservable(S,"params"),_e.queryParams=this.proxyObservable(S,"queryParams"),_e.fragment=this.proxyObservable(S,"fragment"),_e.data=this.proxyObservable(S,"data"),_e}proxyObservable(S,j){return S.pipe((0,Qn.h)(_e=>!!_e),(0,ci.w)(_e=>this.currentActivatedRoute$.pipe((0,Qn.h)(Et=>null!==Et&&Et.component===_e),(0,ci.w)(Et=>Et&&Et.activatedRoute[j]),function yi(M,G=Un.y){return M=M??Bi,(0,hi.e)((S,j)=>{let _e,Et=!0;S.subscribe((0,Ii.x)(j,Cn=>{const Vn=G(Cn);(Et||!M(_e,Vn))&&(Et=!1,_e=Vn,j.next(Cn))}))})}())))}updateActivatedRouteProxy(S,j){const _e=this.proxyMap.get(S);if(!_e)throw new Error("Could not find activated route proxy for view");_e._futureSnapshot=j._futureSnapshot,_e._routerState=j._routerState,_e.snapshot=j.snapshot,_e.outlet=j.outlet,_e.component=j.component,this.currentActivatedRoute$.next({component:S,activatedRoute:j})}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(It.y6),d.Y36(d.s_b),d.$8M("name"),d.$8M("tabs"),d.Y36(ms),d.Y36(So),d.Y36(d._Vd,8),d.Y36(Mi.Ye),d.Y36(d.SBq),d.Y36(It.F0),d.Y36(d.R0b),d.Y36(It.gz),d.Y36(M,12))},M.\u0275dir=d.lG2({type:M,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",environmentInjector:"environmentInjector"},outputs:{stackEvents:"stackEvents",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),M})();class fa{constructor(G,S,j){this.route=G,this.childContexts=S,this.parent=j}get(G,S){return G===It.gz?this.route:G===It.y6?this.childContexts:this.parent.get(G,S)}}let ys=(()=>{class M{constructor(S,j,_e){this.routerOutlet=S,this.navCtrl=j,this.config=_e}onClick(S){var j;const _e=this.defaultHref||this.config.get("backButtonDefaultHref");null!==(j=this.routerOutlet)&&void 0!==j&&j.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),S.preventDefault()):null!=_e&&(this.navCtrl.navigateBack(_e,{animation:this.routerAnimation}),S.preventDefault())}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(vi,8),d.Y36(So),d.Y36(ms))},M.\u0275dir=d.lG2({type:M,selectors:[["ion-back-button"]],hostBindings:function(S,j){1&S&&d.NdJ("click",function(Et){return j.onClick(Et)})},inputs:{defaultHref:"defaultHref",routerAnimation:"routerAnimation"}}),M})(),ma=(()=>{class M{constructor(S,j,_e,Et,Cn){this.locationStrategy=S,this.navCtrl=j,this.elementRef=_e,this.router=Et,this.routerLink=Cn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){var S;if(null!==(S=this.routerLink)&&void 0!==S&&S.urlTree){const j=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=j}}onClick(S){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),S.preventDefault()}}return M.\u0275fac=function(S){return new(S||M)(d.Y36(Mi.S$),d.Y36(So),d.Y36(d.SBq),d.Y36(It.F0),d.Y36(It.rH,8))},M.\u0275dir=d.lG2({type:M,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(S,j){1&S&&d.NdJ("click",function(Et){return j.onClick(Et)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[d.TTD]}),M})();class pr{constructor(G){this.ctrl=G}create(G){return this.ctrl.create(G||{})}dismiss(G,S,j){return this.ctrl.dismiss(G,S,j)}getTop(){return this.ctrl.getTop()}}let cr=(()=>{class M extends pr{constructor(){super(bt.b)}}return M.\u0275fac=function(S){return new(S||M)},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Ps=(()=>{class M extends pr{constructor(){super(bt.a)}}return M.\u0275fac=function(S){return new(S||M)},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})(),Fo=(()=>{class M extends pr{constructor(){super(bt.l)}}return M.\u0275fac=function(S){return new(S||M)},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})();class Rn{}let ki=(()=>{class M extends pr{constructor(S,j,_e,Et){super(bt.m),this.angularDelegate=S,this.resolver=j,this.injector=_e,this.environmentInjector=Et}create(S){var j;return super.create(Object.assign(Object.assign({},S),{delegate:this.angularDelegate.create(null!==(j=this.resolver)&&void 0!==j?j:this.environmentInjector,this.injector,void 0,"modal")}))}}return M.\u0275fac=function(S){return new(S||M)(d.LFG(Is),d.LFG(d._Vd),d.LFG(d.zs3),d.LFG(Rn,8))},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac}),M})(),Ga=(()=>{class M extends pr{constructor(S,j,_e,Et){super(bt.c),this.angularDelegate=S,this.resolver=j,this.injector=_e,this.environmentInjector=Et}create(S){var j;return super.create(Object.assign(Object.assign({},S),{delegate:this.angularDelegate.create(null!==(j=this.resolver)&&void 0!==j?j:this.environmentInjector,this.injector,void 0,"popover")}))}}return M.\u0275fac=function(S){return new(S||M)(d.LFG(Is),d.LFG(d._Vd),d.LFG(d.zs3),d.LFG(Rn,8))},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac}),M})(),Tl=(()=>{class M extends pr{constructor(){super(bt.t)}}return M.\u0275fac=function(S){return new(S||M)},M.\u0275prov=d.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"}),M})();class Hs{shouldDetach(G){return!1}shouldAttach(G){return!1}store(G,S){}retrieve(G){return null}shouldReuseRoute(G,S){if(G.routeConfig!==S.routeConfig)return!1;const j=G.params,_e=S.params,Et=Object.keys(j),Cn=Object.keys(_e);if(Et.length!==Cn.length)return!1;for(const Vn of Et)if(_e[Vn]!==j[Vn])return!1;return!0}}const es=(M,G,S)=>()=>{if(G.defaultView&&typeof window<"u"){(M=>{const G=window,S=G.Ionic;S&&S.config&&"Object"!==S.config.constructor.name||(G.Ionic=G.Ionic||{},G.Ionic.config=Object.assign(Object.assign({},G.Ionic.config),M))})(Object.assign(Object.assign({},M),{_zoneGate:Et=>S.run(Et)}));const _e="__zone_symbol__addEventListener"in G.body?"__zone_symbol__addEventListener":"addEventListener";return function Ni(){var M=[];if(typeof window<"u"){var G=window;(!G.customElements||G.Element&&(!G.Element.prototype.closest||!G.Element.prototype.matches||!G.Element.prototype.remove||!G.Element.prototype.getRootNode))&&M.push(F.e(6748).then(F.t.bind(F,723,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||G.NodeList&&!G.NodeList.prototype.forEach||!G.fetch||!function(){try{var j=new URL("b","http://a");return j.pathname="c%20d","http://a/c%20d"===j.href&&j.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&M.push(F.e(2214).then(F.t.bind(F,4144,23)))}return Promise.all(M)}().then(()=>((M,G)=>typeof window>"u"?Promise.resolve():(0,bn.p)().then(()=>(Ki(),(0,bn.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]]],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]}],[1,"ion-fab-list",{"activated":[4],"side":[1]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]]]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[1],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]]]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[4],"layout":[1],"type":[1],"value":[1],"checked":[32],"setFocus":[64]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1025],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]]]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]}]]],["ion-chip",[[1,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[34,"ion-input",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"inputmode":[1],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"activated":[32]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-textarea",[[34,"ion-textarea",{"fireFocusEvents":[4,"fire-focus-events"],"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[1028,"clear-on-edit"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[2],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"hasFocus":[32],"setFocus":[64],"setBlur":[64],"getInputElement":[64]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"swipeToClose":[4,"swipe-to-close"],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]}],[0,"ion-route-redirect",{"from":[1],"to":[1]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-slide_2",[[0,"ion-slide"],[36,"ion-slides",{"options":[8],"pager":[4],"scrollbar":[4],"update":[64],"updateAutoHeight":[64],"slideTo":[64],"slideNext":[64],"slidePrev":[64],"getActiveIndex":[64],"getPreviousIndex":[64],"length":[64],"isEnd":[64],"isBeginning":[64],"startAutoplay":[64],"stopAutoplay":[64],"lockSwipeToNext":[64],"lockSwipeToPrev":[64],"lockSwipes":[64],"getSwiper":[64]}]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-virtual-scroll",[[0,"ion-virtual-scroll",{"approxItemHeight":[2,"approx-item-height"],"approxHeaderHeight":[2,"approx-header-height"],"approxFooterHeight":[2,"approx-footer-height"],"headerFn":[16],"footerFn":[16],"items":[16],"itemHeight":[16],"headerHeight":[16],"footerHeight":[16],"renderItem":[16],"renderHeader":[16],"renderFooter":[16],"nodeRender":[16],"domRender":[16],"totalHeight":[32],"positionForItem":[64],"checkRange":[64],"checkEnd":[64]},[[9,"resize","onResize"]]]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]]]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32],"ariaLabel":[32]}]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isPresented":[32],"isTimePopoverOpen":[32],"confirm":[64],"reset":[64],"cancel":[64]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]}],[32,"ion-picker-column",{"col":[16]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]]]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8]}]]],["ion-select_3",[[33,"ion-select",{"disabled":[4],"cancelText":[1,"cancel-text"],"okText":[1,"ok-text"],"placeholder":[1],"name":[1],"selectedText":[1,"selected-text"],"multiple":[4],"interface":[1],"interfaceOptions":[8,"interface-options"],"compareWith":[1,"compare-with"],"value":[1032],"isExpanded":[32],"open":[64]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]},[[0,"ionChange","onSelect"]]]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[8,"appload","onAppLoad"],[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]}],[33,"ion-title",{"color":[513],"size":[1]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionChange","handleIonChange"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]]],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]}],[33,"ion-note",{"color":[513]}]]]]'),G))))(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:Di,jmp:Et=>S.runOutsideAngular(Et),ael(Et,Cn,Vn,Ci){Et[_e](Cn,Vn,Ci)},rel(Et,Cn,Vn,Ci){Et.removeEventListener(Cn,Vn,Ci)}}))}};let sl=(()=>{class M{static forRoot(S){return{ngModule:M,providers:[{provide:Zs,useValue:S},{provide:d.ip1,useFactory:es,multi:!0,deps:[Zs,Mi.K0,d.R0b]}]}}}return M.\u0275fac=function(S){return new(S||M)},M.\u0275mod=d.oAB({type:M}),M.\u0275inj=d.cJS({providers:[Is,ki,Ga],imports:[[Mi.ez]]}),M})()},181:(Ln,Dt,F)=>{"use strict";F.d(Dt,{c:()=>Ke});var d=F(5730),v=F(3457);let re;const q=Pe=>Pe.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oe=Pe=>(void 0===re&&(re=void 0===Pe.style.animationName&&void 0!==Pe.style.webkitAnimationName?"-webkit-":""),re),b=(Pe,ne,Je)=>{const Pt=ne.startsWith("animation")?oe(Pe):"";Pe.style.setProperty(Pt+ne,Je)},he=(Pe,ne)=>{const Je=ne.startsWith("animation")?oe(Pe):"";Pe.style.removeProperty(Je+ne)},K=[],ce=(Pe=[],ne)=>{if(void 0!==ne){const Je=Array.isArray(ne)?ne:[ne];return[...Pe,...Je]}return Pe},Ke=Pe=>{let ne,Je,Pt,at,ge,ke,me,yt,St,xt,rt,kt,Ut,Le=[],we=[],Xe=[],He=!1,de={},se=[],Ee=[],_t={},It=0,Gt=!1,Lt=!1,lt=!0,Ce=!1,bt=!0,bn=!1;const Nn=Pe,un=[],ot=[],Bt=[],Sn=[],Qn=[],ci=[],Un=[],hi=[],Ii=[],yi=[],Bi="function"==typeof AnimationEffect||void 0!==v.w&&"function"==typeof v.w.AnimationEffect,Mi="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Bi,Ki=()=>yi,Qe=(je,gt)=>((gt?.oneTimeCallback?ot:un).push({c:je,o:gt}),Ut),rn=()=>{if(Mi)yi.forEach(je=>{je.cancel()}),yi.length=0;else{const je=Bt.slice();(0,d.r)(()=>{je.forEach(gt=>{he(gt,"animation-name"),he(gt,"animation-duration"),he(gt,"animation-timing-function"),he(gt,"animation-iteration-count"),he(gt,"animation-delay"),he(gt,"animation-play-state"),he(gt,"animation-fill-mode"),he(gt,"animation-direction")})})}},oi=()=>{Qn.forEach(je=>{je?.parentNode&&je.parentNode.removeChild(je)}),Qn.length=0},_n=()=>void 0!==ge?ge:me?me.getFill():"both",Ue=()=>void 0!==St?St:void 0!==ke?ke:me?me.getDirection():"normal",Ht=()=>Gt?"linear":void 0!==Pt?Pt:me?me.getEasing():"linear",z=()=>Lt?0:void 0!==xt?xt:void 0!==Je?Je:me?me.getDuration():0,k=()=>void 0!==at?at:me?me.getIterations():1,X=()=>void 0!==rt?rt:void 0!==ne?ne:me?me.getDelay():0,Yn=()=>{0!==It&&(It--,0===It&&((()=>{Dr(),hi.forEach(Yt=>Yt()),Ii.forEach(Yt=>Yt());const je=lt?1:0,gt=se,Ft=Ee,gn=_t;Bt.forEach(Yt=>{const Gn=Yt.classList;gt.forEach(Hn=>Gn.add(Hn)),Ft.forEach(Hn=>Gn.remove(Hn));for(const Hn in gn)gn.hasOwnProperty(Hn)&&b(Yt,Hn,gn[Hn])}),un.forEach(Yt=>Yt.c(je,Ut)),ot.forEach(Yt=>Yt.c(je,Ut)),ot.length=0,bt=!0,lt&&(Ce=!0),lt=!0})(),me&&me.animationFinish()))},mi=(je=!0)=>{oi();const gt=(Pe=>(Pe.forEach(ne=>{for(const Je in ne)if(ne.hasOwnProperty(Je)){const Pt=ne[Je];if("easing"===Je)ne["animation-timing-function"]=Pt,delete ne[Je];else{const at=q(Je);at!==Je&&(ne[at]=Pt,delete ne[Je])}}}),Pe))(Le);Bt.forEach(Ft=>{if(gt.length>0){const gn=((Pe=[])=>Pe.map(ne=>{const Je=ne.offset,Pt=[];for(const at in ne)ne.hasOwnProperty(at)&&"offset"!==at&&Pt.push(`${at}: ${ne[at]};`);return`${100*Je}% { ${Pt.join(" ")} }`}).join(" "))(gt);kt=void 0!==Pe?Pe:(Pe=>{let ne=K.indexOf(Pe);return ne<0&&(ne=K.push(Pe)-1),`ion-animation-${ne}`})(gn);const Yt=((Pe,ne,Je)=>{var Pt;const at=(Pe=>{const ne=void 0!==Pe.getRootNode?Pe.getRootNode():Pe;return ne.head||ne})(Je),ge=oe(Je),ke=at.querySelector("#"+Pe);if(ke)return ke;const Le=(null!==(Pt=Je.ownerDocument)&&void 0!==Pt?Pt:document).createElement("style");return Le.id=Pe,Le.textContent=`@${ge}keyframes ${Pe} { ${ne} } @${ge}keyframes ${Pe}-alt { ${ne} }`,at.appendChild(Le),Le})(kt,gn,Ft);Qn.push(Yt),b(Ft,"animation-duration",`${z()}ms`),b(Ft,"animation-timing-function",Ht()),b(Ft,"animation-delay",`${X()}ms`),b(Ft,"animation-fill-mode",_n()),b(Ft,"animation-direction",Ue());const Gn=k()===1/0?"infinite":k().toString();b(Ft,"animation-iteration-count",Gn),b(Ft,"animation-play-state","paused"),je&&b(Ft,"animation-name",`${Yt.id}-alt`),(0,d.r)(()=>{b(Ft,"animation-name",Yt.id||null)})}})},Oi=(je=!0)=>{(()=>{ci.forEach(gn=>gn()),Un.forEach(gn=>gn());const je=we,gt=Xe,Ft=de;Bt.forEach(gn=>{const Yt=gn.classList;je.forEach(Gn=>Yt.add(Gn)),gt.forEach(Gn=>Yt.remove(Gn));for(const Gn in Ft)Ft.hasOwnProperty(Gn)&&b(gn,Gn,Ft[Gn])})})(),Le.length>0&&(Mi?(Bt.forEach(je=>{const gt=je.animate(Le,{id:Nn,delay:X(),duration:z(),easing:Ht(),iterations:k(),fill:_n(),direction:Ue()});gt.pause(),yi.push(gt)}),yi.length>0&&(yi[0].onfinish=()=>{Yn()})):mi(je)),He=!0},Li=je=>{if(je=Math.min(Math.max(je,0),.9999),Mi)yi.forEach(gt=>{gt.currentTime=gt.effect.getComputedTiming().delay+z()*je,gt.pause()});else{const gt=`-${z()*je}ms`;Bt.forEach(Ft=>{Le.length>0&&(b(Ft,"animation-delay",gt),b(Ft,"animation-play-state","paused"))})}},Er=je=>{yi.forEach(gt=>{gt.effect.updateTiming({delay:X(),duration:z(),easing:Ht(),iterations:k(),fill:_n(),direction:Ue()})}),void 0!==je&&Li(je)},Gr=(je=!0,gt)=>{(0,d.r)(()=>{Bt.forEach(Ft=>{b(Ft,"animation-name",kt||null),b(Ft,"animation-duration",`${z()}ms`),b(Ft,"animation-timing-function",Ht()),b(Ft,"animation-delay",void 0!==gt?`-${gt*z()}ms`:`${X()}ms`),b(Ft,"animation-fill-mode",_n()||null),b(Ft,"animation-direction",Ue()||null);const gn=k()===1/0?"infinite":k().toString();b(Ft,"animation-iteration-count",gn),je&&b(Ft,"animation-name",`${kt}-alt`),(0,d.r)(()=>{b(Ft,"animation-name",kt||null)})})})},Jt=(je=!1,gt=!0,Ft)=>(je&&Sn.forEach(gn=>{gn.update(je,gt,Ft)}),Mi?Er(Ft):Gr(gt,Ft),Ut),fo=()=>{He&&(Mi?yi.forEach(je=>{je.pause()}):Bt.forEach(je=>{b(je,"animation-play-state","paused")}),bn=!0)},qi=()=>{yt=void 0,Yn()},Dr=()=>{yt&&clearTimeout(yt)},fe=je=>new Promise(gt=>{je?.sync&&(Lt=!0,Qe(()=>Lt=!1,{oneTimeCallback:!0})),He||Oi(),Ce&&(Mi?(Li(0),Er()):Gr(),Ce=!1),bt&&(It=Sn.length+1,bt=!1),Qe(()=>gt(),{oneTimeCallback:!0}),Sn.forEach(Ft=>{Ft.play()}),Mi?(yi.forEach(je=>{je.play()}),(0===Le.length||0===Bt.length)&&Yn()):(()=>{if(Dr(),(0,d.r)(()=>{Bt.forEach(je=>{Le.length>0&&b(je,"animation-play-state","running")})}),0===Le.length||0===Bt.length)Yn();else{const je=X()||0,gt=z()||0,Ft=k()||1;isFinite(Ft)&&(yt=setTimeout(qi,je+gt*Ft+100)),((Pe,ne)=>{let Je;const Pt={passive:!0},ge=ke=>{Pe===ke.target&&(Je&&Je(),Dr(),(0,d.r)(()=>{Bt.forEach(je=>{he(je,"animation-duration"),he(je,"animation-delay"),he(je,"animation-play-state")}),(0,d.r)(Yn)}))};Pe&&(Pe.addEventListener("webkitAnimationEnd",ge,Pt),Pe.addEventListener("animationend",ge,Pt),Je=()=>{Pe.removeEventListener("webkitAnimationEnd",ge,Pt),Pe.removeEventListener("animationend",ge,Pt)})})(Bt[0])}})(),bn=!1}),ct=(je,gt)=>{const Ft=Le[0];return void 0===Ft||void 0!==Ft.offset&&0!==Ft.offset?Le=[{offset:0,[je]:gt},...Le]:Ft[je]=gt,Ut};return Ut={parentAnimation:me,elements:Bt,childAnimations:Sn,id:Nn,animationFinish:Yn,from:ct,to:(je,gt)=>{const Ft=Le[Le.length-1];return void 0===Ft||void 0!==Ft.offset&&1!==Ft.offset?Le=[...Le,{offset:1,[je]:gt}]:Ft[je]=gt,Ut},fromTo:(je,gt,Ft)=>ct(je,gt).to(je,Ft),parent:je=>(me=je,Ut),play:fe,pause:()=>(Sn.forEach(je=>{je.pause()}),fo(),Ut),stop:()=>{Sn.forEach(je=>{je.stop()}),He&&(rn(),He=!1),Gt=!1,Lt=!1,bt=!0,St=void 0,xt=void 0,rt=void 0,It=0,Ce=!1,lt=!0,bn=!1},destroy:je=>(Sn.forEach(gt=>{gt.destroy(je)}),(je=>{rn(),je&&oi()})(je),Bt.length=0,Sn.length=0,Le.length=0,un.length=0,ot.length=0,He=!1,bt=!0,Ut),keyframes:je=>{const gt=Le!==je;return Le=je,gt&&(je=>{Mi?Ki().forEach(gt=>{if(gt.effect.setKeyframes)gt.effect.setKeyframes(je);else{const Ft=new KeyframeEffect(gt.effect.target,je,gt.effect.getTiming());gt.effect=Ft}}):mi()})(Le),Ut},addAnimation:je=>{if(null!=je)if(Array.isArray(je))for(const gt of je)gt.parent(Ut),Sn.push(gt);else je.parent(Ut),Sn.push(je);return Ut},addElement:je=>{if(null!=je)if(1===je.nodeType)Bt.push(je);else if(je.length>=0)for(let gt=0;gt<je.length;gt++)Bt.push(je[gt]);else console.error("Invalid addElement value");return Ut},update:Jt,fill:je=>(ge=je,Jt(!0),Ut),direction:je=>(ke=je,Jt(!0),Ut),iterations:je=>(at=je,Jt(!0),Ut),duration:je=>(!Mi&&0===je&&(je=1),Je=je,Jt(!0),Ut),easing:je=>(Pt=je,Jt(!0),Ut),delay:je=>(ne=je,Jt(!0),Ut),getWebAnimations:Ki,getKeyframes:()=>Le,getFill:_n,getDirection:Ue,getDelay:X,getIterations:k,getEasing:Ht,getDuration:z,afterAddRead:je=>(hi.push(je),Ut),afterAddWrite:je=>(Ii.push(je),Ut),afterClearStyles:(je=[])=>{for(const gt of je)_t[gt]="";return Ut},afterStyles:(je={})=>(_t=je,Ut),afterRemoveClass:je=>(Ee=ce(Ee,je),Ut),afterAddClass:je=>(se=ce(se,je),Ut),beforeAddRead:je=>(ci.push(je),Ut),beforeAddWrite:je=>(Un.push(je),Ut),beforeClearStyles:(je=[])=>{for(const gt of je)de[gt]="";return Ut},beforeStyles:(je={})=>(de=je,Ut),beforeRemoveClass:je=>(Xe=ce(Xe,je),Ut),beforeAddClass:je=>(we=ce(we,je),Ut),onFinish:Qe,isRunning:()=>0!==It&&!bn,progressStart:(je=!1,gt)=>(Sn.forEach(Ft=>{Ft.progressStart(je,gt)}),fo(),Gt=je,He||Oi(),Jt(!1,!0,gt),Ut),progressStep:je=>(Sn.forEach(gt=>{gt.progressStep(je)}),Li(je),Ut),progressEnd:(je,gt,Ft)=>(Gt=!1,Sn.forEach(gn=>{gn.progressEnd(je,gt,Ft)}),void 0!==Ft&&(xt=Ft),Ce=!1,lt=!0,0===je?(St="reverse"===Ue()?"normal":"reverse","reverse"===St&&(lt=!1),Mi?(Jt(),Li(1-gt)):(rt=(1-gt)*z()*-1,Jt(!1,!1))):1===je&&(Mi?(Jt(),Li(gt)):(rt=gt*z()*-1,Jt(!1,!1))),void 0!==je&&(Qe(()=>{xt=void 0,St=void 0,rt=void 0},{oneTimeCallback:!0}),me||fe()),Ut)}}},4349:(Ln,Dt,F)=>{"use strict";F.d(Dt,{G:()=>q});class v{constructor(b,he,Ie,Ve,K){this.id=he,this.name=Ie,this.disableScroll=K,this.priority=1e6*Ve+he,this.ctrl=b}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const b=this.ctrl.capture(this.name,this.id,this.priority);return b&&this.disableScroll&&this.ctrl.disableScroll(this.id),b}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class re{constructor(b,he,Ie,Ve){this.id=he,this.disable=Ie,this.disableScroll=Ve,this.ctrl=b}block(){if(this.ctrl){if(this.disable)for(const b of this.disable)this.ctrl.disableGesture(b,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const b of this.disable)this.ctrl.enableGesture(b,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const a="backdrop-no-scroll",q=new class d{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(b){var he;return new v(this,this.newID(),b.name,null!==(he=b.priority)&&void 0!==he?he:0,!!b.disableScroll)}createBlocker(b={}){return new re(this,this.newID(),b.disable,!!b.disableScroll)}start(b,he,Ie){return this.canStart(b)?(this.requestedStart.set(he,Ie),!0):(this.requestedStart.delete(he),!1)}capture(b,he,Ie){if(!this.start(b,he,Ie))return!1;const Ve=this.requestedStart;let K=-1e4;if(Ve.forEach(xe=>{K=Math.max(K,xe)}),K===Ie){this.capturedId=he,Ve.clear();const xe=new CustomEvent("ionGestureCaptured",{detail:{gestureName:b}});return document.dispatchEvent(xe),!0}return Ve.delete(he),!1}release(b){this.requestedStart.delete(b),this.capturedId===b&&(this.capturedId=void 0)}disableGesture(b,he){let Ie=this.disabledGestures.get(b);void 0===Ie&&(Ie=new Set,this.disabledGestures.set(b,Ie)),Ie.add(he)}enableGesture(b,he){const Ie=this.disabledGestures.get(b);void 0!==Ie&&Ie.delete(he)}disableScroll(b){this.disabledScroll.add(b),1===this.disabledScroll.size&&document.body.classList.add(a)}enableScroll(b){this.disabledScroll.delete(b),0===this.disabledScroll.size&&document.body.classList.remove(a)}canStart(b){return!(void 0!==this.capturedId||this.isDisabled(b))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(b){const he=this.disabledGestures.get(b);return!!(he&&he.size>0)}newID(){return this.gestureId++,this.gestureId}}},7593:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{MENU_BACK_BUTTON_PRIORITY:()=>q,OVERLAY_BACK_BUTTON_PRIORITY:()=>a,blockHardwareBackButton:()=>v,startHardwareBackButton:()=>re});var d=F(5861);const v=()=>{document.addEventListener("backbutton",()=>{})},re=()=>{const oe=document;let b=!1;oe.addEventListener("backbutton",()=>{if(b)return;let he=0,Ie=[];const Ve=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(pe,ze){Ie.push({priority:pe,handler:ze,id:he++})}}});oe.dispatchEvent(Ve);const K=function(){var pe=(0,d.Z)(function*(ze){try{if(ze?.handler){const ce=ze.handler(xe);null!=ce&&(yield ce)}}catch(ce){console.error(ce)}});return function(ce){return pe.apply(this,arguments)}}(),xe=()=>{if(Ie.length>0){let pe={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};Ie.forEach(ze=>{ze.priority>=pe.priority&&(pe=ze)}),b=!0,Ie=Ie.filter(ze=>ze.id!==pe.id),K(pe).then(()=>b=!1)}};xe()})},a=100,q=99},5730:(Ln,Dt,F)=>{"use strict";F.d(Dt,{a:()=>b,b:()=>he,c:()=>re,d:()=>ze,e:()=>ce,f:()=>pe,g:()=>Ie,h:()=>at,i:()=>oe,j:()=>a,k:()=>xe,l:()=>Ke,m:()=>K,n:()=>Pe,o:()=>Pt,p:()=>Je,q:()=>ge,r:()=>Ve,s:()=>ke,t:()=>d,u:()=>ne});const d=(Le,we=0)=>new Promise(Xe=>{v(Le,we,Xe)}),v=(Le,we=0,Xe)=>{let He,me;const de={passive:!0},Ee=()=>{He&&He()},_t=It=>{(void 0===It||Le===It.target)&&(Ee(),Xe(It))};return Le&&(Le.addEventListener("webkitTransitionEnd",_t,de),Le.addEventListener("transitionend",_t,de),me=setTimeout(_t,we+500),He=()=>{me&&(clearTimeout(me),me=void 0),Le.removeEventListener("webkitTransitionEnd",_t,de),Le.removeEventListener("transitionend",_t,de)}),Ee},re=(Le,we)=>{Le.componentOnReady?Le.componentOnReady().then(Xe=>we(Xe)):Ve(()=>we(Le))},a=(Le,we=[])=>{const Xe={};return we.forEach(He=>{Le.hasAttribute(He)&&(null!==Le.getAttribute(He)&&(Xe[He]=Le.getAttribute(He)),Le.removeAttribute(He))}),Xe},q=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],oe=(Le,we)=>{let Xe=q;return we&&we.length>0&&(Xe=Xe.filter(He=>!we.includes(He))),a(Le,Xe)},b=(Le,we,Xe,He)=>{var me;if(typeof window<"u"){const se=null===(me=window?.Ionic)||void 0===me?void 0:me.config;if(se){const Ee=se.get("_ael");if(Ee)return Ee(Le,we,Xe,He);if(se._ael)return se._ael(Le,we,Xe,He)}}return Le.addEventListener(we,Xe,He)},he=(Le,we,Xe,He)=>{var me;if(typeof window<"u"){const se=null===(me=window?.Ionic)||void 0===me?void 0:me.config;if(se){const Ee=se.get("_rel");if(Ee)return Ee(Le,we,Xe,He);if(se._rel)return se._rel(Le,we,Xe,He)}}return Le.removeEventListener(we,Xe,He)},Ie=(Le,we=Le)=>Le.shadowRoot||we,Ve=Le=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Le):"function"==typeof requestAnimationFrame?requestAnimationFrame(Le):setTimeout(Le),K=Le=>!!Le.shadowRoot&&!!Le.attachShadow,xe=Le=>{const we=Le.closest("ion-item");return we?we.querySelector("ion-label"):null},pe=Le=>{if(Le.focus(),Le.classList.contains("ion-focusable")){const we=Le.closest("ion-app");we&&we.setFocus([Le])}},ze=(Le,we)=>{let Xe;const He=Le.getAttribute("aria-labelledby"),me=Le.id;let de=null!==He&&""!==He.trim()?He:we+"-lbl",se=null!==He&&""!==He.trim()?document.getElementById(He):xe(Le);return se?(null===He&&(se.id=de),Xe=se.textContent,se.setAttribute("aria-hidden","true")):""!==me.trim()&&(se=document.querySelector(`label[for="${me}"]`),se&&(""!==se.id?de=se.id:se.id=de=`${me}-lbl`,Xe=se.textContent)),{label:se,labelId:de,labelText:Xe}},ce=(Le,we,Xe,He,me)=>{if(Le||K(we)){let de=we.querySelector("input.aux-input");de||(de=we.ownerDocument.createElement("input"),de.type="hidden",de.classList.add("aux-input"),we.appendChild(de)),de.disabled=me,de.name=Xe,de.value=He||""}},Ke=(Le,we,Xe)=>Math.max(Le,Math.min(we,Xe)),Pe=(Le,we)=>{if(!Le){const Xe="ASSERT: "+we;throw console.error(Xe),new Error(Xe)}},ne=Le=>Le.timeStamp||Date.now(),Je=Le=>{if(Le){const we=Le.changedTouches;if(we&&we.length>0){const Xe=we[0];return{x:Xe.clientX,y:Xe.clientY}}if(void 0!==Le.pageX)return{x:Le.pageX,y:Le.pageY}}return{x:0,y:0}},Pt=Le=>{const we="rtl"===document.dir;switch(Le){case"start":return we;case"end":return!we;default:throw new Error(`"${Le}" is not a valid value for [side]. Use "start" or "end" instead.`)}},at=(Le,we)=>{const Xe=Le._original||Le;return{_original:Le,emit:ge(Xe.emit.bind(Xe),we)}},ge=(Le,we=0)=>{let Xe;return(...He)=>{clearTimeout(Xe),Xe=setTimeout(Le,we,...He)}},ke=(Le,we)=>{if(Le??(Le={}),we??(we={}),Le===we)return!0;const Xe=Object.keys(Le);if(Xe.length!==Object.keys(we).length)return!1;for(const He of Xe)if(!(He in we)||Le[He]!==we[He])return!1;return!0}},1843:(Ln,Dt,F)=>{"use strict";F.d(Dt,{L:()=>a,a:()=>q,b:()=>oe,c:()=>b,d:()=>he,e:()=>we,g:()=>me,l:()=>ke,s:()=>Xe,t:()=>K});var d=F(5861),v=F(1308),re=F(5730);const a="ionViewWillEnter",q="ionViewDidEnter",oe="ionViewWillLeave",b="ionViewDidLeave",he="ionViewWillUnload",K=de=>new Promise((se,Ee)=>{(0,v.c)(()=>{xe(de),pe(de).then(_t=>{_t.animation&&_t.animation.destroy(),ze(de),se(_t)},_t=>{ze(de),Ee(_t)})})}),xe=de=>{const se=de.enteringEl,Ee=de.leavingEl;He(se,Ee,de.direction),de.showGoBack?se.classList.add("can-go-back"):se.classList.remove("can-go-back"),Xe(se,!1),se.style.setProperty("pointer-events","none"),Ee&&(Xe(Ee,!1),Ee.style.setProperty("pointer-events","none"))},pe=function(){var de=(0,d.Z)(function*(se){const Ee=yield ce(se);return Ee&&v.B.isBrowser?Ke(Ee,se):Pe(se)});return function(Ee){return de.apply(this,arguments)}}(),ze=de=>{const se=de.enteringEl,Ee=de.leavingEl;se.classList.remove("ion-page-invisible"),se.style.removeProperty("pointer-events"),void 0!==Ee&&(Ee.classList.remove("ion-page-invisible"),Ee.style.removeProperty("pointer-events"))},ce=function(){var de=(0,d.Z)(function*(se){return se.leavingEl&&se.animated&&0!==se.duration?se.animationBuilder?se.animationBuilder:"ios"===se.mode?(yield Promise.resolve().then(F.bind(F,6439))).iosTransitionAnimation:(yield Promise.resolve().then(F.bind(F,7838))).mdTransitionAnimation:void 0});return function(Ee){return de.apply(this,arguments)}}(),Ke=function(){var de=(0,d.Z)(function*(se,Ee){yield ne(Ee,!0);const _t=se(Ee.baseEl,Ee);at(Ee.enteringEl,Ee.leavingEl);const It=yield Pt(_t,Ee);return Ee.progressCallback&&Ee.progressCallback(void 0),It&&ge(Ee.enteringEl,Ee.leavingEl),{hasCompleted:It,animation:_t}});return function(Ee,_t){return de.apply(this,arguments)}}(),Pe=function(){var de=(0,d.Z)(function*(se){const Ee=se.enteringEl,_t=se.leavingEl;return yield ne(se,!1),at(Ee,_t),ge(Ee,_t),{hasCompleted:!0}});return function(Ee){return de.apply(this,arguments)}}(),ne=function(){var de=(0,d.Z)(function*(se,Ee){const It=(void 0!==se.deepWait?se.deepWait:Ee)?[we(se.enteringEl),we(se.leavingEl)]:[Le(se.enteringEl),Le(se.leavingEl)];yield Promise.all(It),yield Je(se.viewIsReady,se.enteringEl)});return function(Ee,_t){return de.apply(this,arguments)}}(),Je=function(){var de=(0,d.Z)(function*(se,Ee){se&&(yield se(Ee))});return function(Ee,_t){return de.apply(this,arguments)}}(),Pt=(de,se)=>{const Ee=se.progressCallback,_t=new Promise(It=>{de.onFinish(Gt=>It(1===Gt))});return Ee?(de.progressStart(!0),Ee(de)):de.play(),_t},at=(de,se)=>{ke(se,oe),ke(de,a)},ge=(de,se)=>{ke(de,q),ke(se,b)},ke=(de,se)=>{if(de){const Ee=new CustomEvent(se,{bubbles:!1,cancelable:!1});de.dispatchEvent(Ee)}},Le=de=>de?new Promise(se=>(0,re.c)(de,se)):Promise.resolve(),we=function(){var de=(0,d.Z)(function*(se){const Ee=se;if(Ee){if(null!=Ee.componentOnReady){if(null!=(yield Ee.componentOnReady()))return}else if(null!=Ee.__registerHost)return void(yield new Promise(It=>(0,re.r)(It)));yield Promise.all(Array.from(Ee.children).map(we))}});return function(Ee){return de.apply(this,arguments)}}(),Xe=(de,se)=>{se?(de.setAttribute("aria-hidden","true"),de.classList.add("ion-page-hidden")):(de.hidden=!1,de.removeAttribute("aria-hidden"),de.classList.remove("ion-page-hidden"))},He=(de,se,Ee)=>{void 0!==de&&(de.style.zIndex="back"===Ee?"99":"101"),void 0!==se&&(se.style.zIndex="100")},me=de=>de.classList.contains("ion-page")?de:de.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||de},6369:(Ln,Dt,F)=>{"use strict";F.d(Dt,{m:()=>K});var d=F(5861),v=F(7593),re=F(5730),a=F(5179),q=F(181);const oe=xe=>(0,q.c)().duration(xe?400:300),b=xe=>{let pe,ze;const ce=xe.width+8,Ke=(0,q.c)(),Pe=(0,q.c)();xe.isEndSide?(pe=ce+"px",ze="0px"):(pe=-ce+"px",ze="0px"),Ke.addElement(xe.menuInnerEl).fromTo("transform",`translateX(${pe})`,`translateX(${ze})`);const Je="ios"===(0,a.b)(xe),Pt=Je?.2:.25;return Pe.addElement(xe.backdropEl).fromTo("opacity",.01,Pt),oe(Je).addAnimation([Ke,Pe])},he=xe=>{let pe,ze;const ce=(0,a.b)(xe),Ke=xe.width;xe.isEndSide?(pe=-Ke+"px",ze=Ke+"px"):(pe=Ke+"px",ze=-Ke+"px");const Pe=(0,q.c)().addElement(xe.menuInnerEl).fromTo("transform",`translateX(${ze})`,"translateX(0px)"),ne=(0,q.c)().addElement(xe.contentEl).fromTo("transform","translateX(0px)",`translateX(${pe})`),Je=(0,q.c)().addElement(xe.backdropEl).fromTo("opacity",.01,.32);return oe("ios"===ce).addAnimation([Pe,ne,Je])},Ie=xe=>{const pe=(0,a.b)(xe),ze=xe.width*(xe.isEndSide?-1:1)+"px",ce=(0,q.c)().addElement(xe.contentEl).fromTo("transform","translateX(0px)",`translateX(${ze})`);return oe("ios"===pe).addAnimation(ce)},K=(()=>{const xe=new Map,pe=[],ze=function(){var yt=(0,d.Z)(function*(St){const xt=yield at(St);return!!xt&&xt.open()});return function(xt){return yt.apply(this,arguments)}}(),ce=function(){var yt=(0,d.Z)(function*(St){const xt=yield void 0!==St?at(St):ge();return void 0!==xt&&xt.close()});return function(xt){return yt.apply(this,arguments)}}(),Ke=function(){var yt=(0,d.Z)(function*(St){const xt=yield at(St);return!!xt&&xt.toggle()});return function(xt){return yt.apply(this,arguments)}}(),Pe=function(){var yt=(0,d.Z)(function*(St,xt){const rt=yield at(xt);return rt&&(rt.disabled=!St),rt});return function(xt,rt){return yt.apply(this,arguments)}}(),ne=function(){var yt=(0,d.Z)(function*(St,xt){const rt=yield at(xt);return rt&&(rt.swipeGesture=St),rt});return function(xt,rt){return yt.apply(this,arguments)}}(),Je=function(){var yt=(0,d.Z)(function*(St){if(null!=St){const xt=yield at(St);return void 0!==xt&&xt.isOpen()}return void 0!==(yield ge())});return function(xt){return yt.apply(this,arguments)}}(),Pt=function(){var yt=(0,d.Z)(function*(St){const xt=yield at(St);return!!xt&&!xt.disabled});return function(xt){return yt.apply(this,arguments)}}(),at=function(){var yt=(0,d.Z)(function*(St){return yield Lt(),"start"===St||"end"===St?Gt(lt=>lt.side===St&&!lt.disabled)||Gt(lt=>lt.side===St):null!=St?Gt(rt=>rt.menuId===St):Gt(rt=>!rt.disabled)||(pe.length>0?pe[0].el:void 0)});return function(xt){return yt.apply(this,arguments)}}(),ge=function(){var yt=(0,d.Z)(function*(){return yield Lt(),Ee()});return function(){return yt.apply(this,arguments)}}(),ke=function(){var yt=(0,d.Z)(function*(){return yield Lt(),_t()});return function(){return yt.apply(this,arguments)}}(),Le=function(){var yt=(0,d.Z)(function*(){return yield Lt(),It()});return function(){return yt.apply(this,arguments)}}(),we=(yt,St)=>{xe.set(yt,St)},me=yt=>{const St=yt.side;pe.filter(xt=>xt.side===St&&xt!==yt).forEach(xt=>xt.disabled=!0)},de=function(){var yt=(0,d.Z)(function*(St,xt,rt){if(It())return!1;if(xt){const lt=yield ge();lt&&St.el!==lt&&(yield lt.setOpen(!1,!1))}return St._setOpen(xt,rt)});return function(xt,rt,lt){return yt.apply(this,arguments)}}(),Ee=()=>Gt(yt=>yt._isOpen),_t=()=>pe.map(yt=>yt.el),It=()=>pe.some(yt=>yt.isAnimating),Gt=yt=>{const St=pe.find(yt);if(void 0!==St)return St.el},Lt=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(yt=>new Promise(St=>(0,re.c)(yt,St))));return we("reveal",Ie),we("push",he),we("overlay",b),typeof document<"u"&&document.addEventListener("ionBackButton",yt=>{const St=Ee();St&&yt.detail.register(v.MENU_BACK_BUTTON_PRIORITY,()=>St.close())}),{registerAnimation:we,get:at,getMenus:ke,getOpen:ge,isEnabled:Pt,swipeGesture:ne,isAnimating:Le,isOpen:Je,enable:Pe,toggle:Ke,close:ce,open:ze,_getOpenSync:Ee,_createAnimation:(yt,St)=>{const xt=xe.get(yt);if(!xt)throw new Error("animation not registered");return xt(St)},_register:yt=>{pe.indexOf(yt)<0&&(yt.disabled||me(yt),pe.push(yt))},_unregister:yt=>{const St=pe.indexOf(yt);St>-1&&pe.splice(St,1)},_setOpen:de,_setActiveMenu:me}})()},3457:(Ln,Dt,F)=>{"use strict";F.d(Dt,{w:()=>d});const d=typeof window<"u"?window:void 0},1898:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{GESTURE_CONTROLLER:()=>d.G,createGesture:()=>Ie});var d=F(4349);const v=(pe,ze,ce,Ke)=>{const Pe=re(pe)?{capture:!!Ke.capture,passive:!!Ke.passive}:!!Ke.capture;let ne,Je;return pe.__zone_symbol__addEventListener?(ne="__zone_symbol__addEventListener",Je="__zone_symbol__removeEventListener"):(ne="addEventListener",Je="removeEventListener"),pe[ne](ze,ce,Pe),()=>{pe[Je](ze,ce,Pe)}},re=pe=>{if(void 0===a)try{const ze=Object.defineProperty({},"passive",{get:()=>{a=!0}});pe.addEventListener("optsTest",()=>{},ze)}catch{a=!1}return!!a};let a;const b=pe=>pe instanceof Document?pe:pe.ownerDocument,Ie=pe=>{let ze=!1,ce=!1,Ke=!0,Pe=!1;const ne=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},pe),Je=ne.canStart,Pt=ne.onWillStart,at=ne.onStart,ge=ne.onEnd,ke=ne.notCaptured,Le=ne.onMove,we=ne.threshold,Xe=ne.passive,He=ne.blurOnStart,me={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},de=((pe,ze,ce)=>{const Ke=ce*(Math.PI/180),Pe="x"===pe,ne=Math.cos(Ke),Je=ze*ze;let Pt=0,at=0,ge=!1,ke=0;return{start(Le,we){Pt=Le,at=we,ke=0,ge=!0},detect(Le,we){if(!ge)return!1;const Xe=Le-Pt,He=we-at,me=Xe*Xe+He*He;if(me<Je)return!1;const de=Math.sqrt(me),se=(Pe?Xe:He)/de;return ke=se>ne?1:se<-ne?-1:0,ge=!1,!0},isGesture:()=>0!==ke,getDirection:()=>ke}})(ne.direction,ne.threshold,ne.maxAngle),se=d.G.createGesture({name:pe.gestureName,priority:pe.gesturePriority,disableScroll:pe.disableScroll}),It=()=>{ze&&(Pe=!1,Le&&Le(me))},Gt=()=>!!se.capture()&&(ze=!0,Ke=!1,me.startX=me.currentX,me.startY=me.currentY,me.startTime=me.currentTime,Pt?Pt(me).then(yt):yt(),!0),yt=()=>{He&&(()=>{if(typeof document<"u"){const Ce=document.activeElement;Ce?.blur&&Ce.blur()}})(),at&&at(me),Ke=!0},St=()=>{ze=!1,ce=!1,Pe=!1,Ke=!0,se.release()},xt=Ce=>{const bt=ze,kt=Ke;if(St(),kt){if(Ve(me,Ce),bt)return void(ge&&ge(me));ke&&ke(me)}},rt=((pe,ze,ce,Ke,Pe)=>{let ne,Je,Pt,at,ge,ke,Le,we=0;const Xe=Lt=>{we=Date.now()+2e3,ze(Lt)&&(!Je&&ce&&(Je=v(pe,"touchmove",ce,Pe)),Pt||(Pt=v(Lt.target,"touchend",me,Pe)),at||(at=v(Lt.target,"touchcancel",me,Pe)))},He=Lt=>{we>Date.now()||ze(Lt)&&(!ke&&ce&&(ke=v(b(pe),"mousemove",ce,Pe)),Le||(Le=v(b(pe),"mouseup",de,Pe)))},me=Lt=>{se(),Ke&&Ke(Lt)},de=Lt=>{Ee(),Ke&&Ke(Lt)},se=()=>{Je&&Je(),Pt&&Pt(),at&&at(),Je=Pt=at=void 0},Ee=()=>{ke&&ke(),Le&&Le(),ke=Le=void 0},_t=()=>{se(),Ee()},It=(Lt=!0)=>{Lt?(ne||(ne=v(pe,"touchstart",Xe,Pe)),ge||(ge=v(pe,"mousedown",He,Pe))):(ne&&ne(),ge&&ge(),ne=ge=void 0,_t())};return{enable:It,stop:_t,destroy:()=>{It(!1),Ke=ce=ze=void 0}}})(ne.el,Ce=>{const bt=xe(Ce);return!(ce||!Ke||(K(Ce,me),me.startX=me.currentX,me.startY=me.currentY,me.startTime=me.currentTime=bt,me.velocityX=me.velocityY=me.deltaX=me.deltaY=0,me.event=Ce,Je&&!1===Je(me))||(se.release(),!se.start()))&&(ce=!0,0===we?Gt():(de.start(me.startX,me.startY),!0))},Ce=>{ze?!Pe&&Ke&&(Pe=!0,Ve(me,Ce),requestAnimationFrame(It)):(Ve(me,Ce),de.detect(me.currentX,me.currentY)&&(!de.isGesture()||!Gt())&&lt())},xt,{capture:!1,passive:Xe}),lt=()=>{St(),rt.stop(),ke&&ke(me)};return{enable(Ce=!0){Ce||(ze&&xt(void 0),St()),rt.enable(Ce)},destroy(){se.destroy(),rt.destroy()}}},Ve=(pe,ze)=>{if(!ze)return;const ce=pe.currentX,Ke=pe.currentY,Pe=pe.currentTime;K(ze,pe);const ne=pe.currentX,Je=pe.currentY,at=(pe.currentTime=xe(ze))-Pe;if(at>0&&at<100){const ke=(Je-Ke)/at;pe.velocityX=(ne-ce)/at*.7+.3*pe.velocityX,pe.velocityY=.7*ke+.3*pe.velocityY}pe.deltaX=ne-pe.startX,pe.deltaY=Je-pe.startY,pe.event=ze},K=(pe,ze)=>{let ce=0,Ke=0;if(pe){const Pe=pe.changedTouches;if(Pe&&Pe.length>0){const ne=Pe[0];ce=ne.clientX,Ke=ne.clientY}else void 0!==pe.pageX&&(ce=pe.pageX,Ke=pe.pageY)}ze.currentX=ce,ze.currentY=Ke},xe=pe=>pe.timeStamp||Date.now()},1308:(Ln,Dt,F)=>{"use strict";F.d(Dt,{B:()=>En,H:()=>Bt,a:()=>lt,b:()=>Tn,c:()=>si,e:()=>vr,f:()=>In,g:()=>Ce,h:()=>un,i:()=>Si,j:()=>Ue,k:()=>qn,p:()=>Ke,r:()=>ei,s:()=>ze});var d=F(5861);let re,a,q,oe=!1,b=!1,he=!1,Ie=!1,Ve=!1;const K=typeof window<"u"?window:{},xe=K.document||{head:{}},pe={$flags$:0,$resourcesUrl$:"",jmp:fe=>fe(),raf:fe=>requestAnimationFrame(fe),ael:(fe,$e,ct,zt)=>fe.addEventListener($e,ct,zt),rel:(fe,$e,ct,zt)=>fe.removeEventListener($e,ct,zt),ce:(fe,$e)=>new CustomEvent(fe,$e)},ze=fe=>{Object.assign(pe,fe)},Ke=fe=>Promise.resolve(fe),Pe=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),ne=(fe,$e,ct,zt)=>{ct&&ct.map(([en,je,gt])=>{const Ft=Pt(fe,en),gn=Je($e,gt),Yt=at(en);pe.ael(Ft,je,gn,Yt),($e.$rmListeners$=$e.$rmListeners$||[]).push(()=>pe.rel(Ft,je,gn,Yt))})},Je=(fe,$e)=>ct=>{try{256&fe.$flags$?fe.$lazyInstance$[$e](ct):(fe.$queuedListeners$=fe.$queuedListeners$||[]).push([$e,ct])}catch(zt){Er(zt)}},Pt=(fe,$e)=>4&$e?xe:8&$e?K:16&$e?xe.body:fe,at=fe=>0!=(2&fe),Xe="s-id",He="sty-id",se="http://www.w3.org/1999/xlink",It=new WeakMap,Gt=(fe,$e,ct)=>{let zt=Xr.get(fe);Pe&&ct?(zt=zt||new CSSStyleSheet,"string"==typeof zt?zt=$e:zt.replaceSync($e)):zt=$e,Xr.set(fe,zt)},Lt=(fe,$e,ct,zt)=>{let en=St($e,ct);const je=Xr.get(en);if(fe=11===fe.nodeType?fe:xe,je)if("string"==typeof je){let Ft,gt=It.get(fe=fe.head||fe);gt||It.set(fe,gt=new Set),gt.has(en)||(fe.host&&(Ft=fe.querySelector(`[${He}="${en}"]`))?Ft.innerHTML=je:(Ft=xe.createElement("style"),Ft.innerHTML=je,fe.insertBefore(Ft,fe.querySelector("link"))),gt&&gt.add(en))}else fe.adoptedStyleSheets.includes(je)||(fe.adoptedStyleSheets=[...fe.adoptedStyleSheets,je]);return en},St=(fe,$e)=>"sc-"+($e&&32&fe.$flags$?fe.$tagName$+"-"+$e:fe.$tagName$),xt=fe=>fe.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),lt=fe=>dr.push(fe),Ce=fe=>mi(fe).$modeName$,bt={},Nn=fe=>"object"==(fe=typeof fe)||"function"===fe,un=(fe,$e,...ct)=>{let zt=null,en=null,je=null,gt=!1,Ft=!1;const gn=[],Yt=Hn=>{for(let Ai=0;Ai<Hn.length;Ai++)zt=Hn[Ai],Array.isArray(zt)?Yt(zt):null!=zt&&"boolean"!=typeof zt&&((gt="function"!=typeof fe&&!Nn(zt))&&(zt=String(zt)),gt&&Ft?gn[gn.length-1].$text$+=zt:gn.push(gt?ot(null,zt):zt),Ft=gt)};if(Yt(ct),$e){$e.key&&(en=$e.key),$e.name&&(je=$e.name);{const Hn=$e.className||$e.class;Hn&&($e.class="object"!=typeof Hn?Hn:Object.keys(Hn).filter(Ai=>Hn[Ai]).join(" "))}}if("function"==typeof fe)return fe(null===$e?{}:$e,gn,Qn);const Gn=ot(fe,null);return Gn.$attrs$=$e,gn.length>0&&(Gn.$children$=gn),Gn.$key$=en,Gn.$name$=je,Gn},ot=(fe,$e)=>({$flags$:0,$tag$:fe,$text$:$e,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),Bt={},Qn={forEach:(fe,$e)=>fe.map(ci).forEach($e),map:(fe,$e)=>fe.map(ci).map($e).map(Un)},ci=fe=>({vattrs:fe.$attrs$,vchildren:fe.$children$,vkey:fe.$key$,vname:fe.$name$,vtag:fe.$tag$,vtext:fe.$text$}),Un=fe=>{if("function"==typeof fe.vtag){const ct=Object.assign({},fe.vattrs);return fe.vkey&&(ct.key=fe.vkey),fe.vname&&(ct.name=fe.vname),un(fe.vtag,ct,...fe.vchildren||[])}const $e=ot(fe.vtag,fe.vtext);return $e.$attrs$=fe.vattrs,$e.$children$=fe.vchildren,$e.$key$=fe.vkey,$e.$name$=fe.vname,$e},hi=(fe,$e,ct,zt,en,je)=>{if(ct!==zt){let gt=Li(fe,$e),Ft=$e.toLowerCase();if("class"===$e){const gn=fe.classList,Yt=yi(ct),Gn=yi(zt);gn.remove(...Yt.filter(Hn=>Hn&&!Gn.includes(Hn))),gn.add(...Gn.filter(Hn=>Hn&&!Yt.includes(Hn)))}else if("style"===$e){for(const gn in ct)(!zt||null==zt[gn])&&(gn.includes("-")?fe.style.removeProperty(gn):fe.style[gn]="");for(const gn in zt)(!ct||zt[gn]!==ct[gn])&&(gn.includes("-")?fe.style.setProperty(gn,zt[gn]):fe.style[gn]=zt[gn])}else if("key"!==$e)if("ref"===$e)zt&&zt(fe);else if(gt||"o"!==$e[0]||"n"!==$e[1]){const gn=Nn(zt);if((gt||gn&&null!==zt)&&!en)try{if(fe.tagName.includes("-"))fe[$e]=zt;else{const Gn=zt??"";"list"===$e?gt=!1:(null==ct||fe[$e]!=Gn)&&(fe[$e]=Gn)}}catch{}let Yt=!1;Ft!==(Ft=Ft.replace(/^xlink\:?/,""))&&($e=Ft,Yt=!0),null==zt||!1===zt?(!1!==zt||""===fe.getAttribute($e))&&(Yt?fe.removeAttributeNS(se,$e):fe.removeAttribute($e)):(!gt||4&je||en)&&!gn&&(zt=!0===zt?"":zt,Yt?fe.setAttributeNS(se,$e,zt):fe.setAttribute($e,zt))}else $e="-"===$e[2]?$e.slice(3):Li(K,Ft)?Ft.slice(2):Ft[2]+$e.slice(3),ct&&pe.rel(fe,$e,ct,!1),zt&&pe.ael(fe,$e,zt,!1)}},Ii=/\s/,yi=fe=>fe?fe.split(Ii):[],Bi=(fe,$e,ct,zt)=>{const en=11===$e.$elm$.nodeType&&$e.$elm$.host?$e.$elm$.host:$e.$elm$,je=fe&&fe.$attrs$||bt,gt=$e.$attrs$||bt;for(zt in je)zt in gt||hi(en,zt,je[zt],void 0,ct,$e.$flags$);for(zt in gt)hi(en,zt,je[zt],gt[zt],ct,$e.$flags$)},Mi=(fe,$e,ct,zt)=>{const en=$e.$children$[ct];let gt,Ft,gn,je=0;if(oe||(he=!0,"slot"===en.$tag$&&(re&&zt.classList.add(re+"-s"),en.$flags$|=en.$children$?2:1)),null!==en.$text$)gt=en.$elm$=xe.createTextNode(en.$text$);else if(1&en.$flags$)gt=en.$elm$=xe.createTextNode("");else{if(Ie||(Ie="svg"===en.$tag$),gt=en.$elm$=xe.createElementNS(Ie?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&en.$flags$?"slot-fb":en.$tag$),Ie&&"foreignObject"===en.$tag$&&(Ie=!1),Bi(null,en,Ie),(fe=>null!=fe)(re)&&gt["s-si"]!==re&&gt.classList.add(gt["s-si"]=re),en.$children$)for(je=0;je<en.$children$.length;++je)Ft=Mi(fe,en,je,gt),Ft&&gt.appendChild(Ft);"svg"===en.$tag$?Ie=!1:"foreignObject"===gt.tagName&&(Ie=!0)}return gt["s-hn"]=q,3&en.$flags$&&(gt["s-sr"]=!0,gt["s-cr"]=a,gt["s-sn"]=en.$name$||"",gn=fe&&fe.$children$&&fe.$children$[ct],gn&&gn.$tag$===en.$tag$&&fe.$elm$&&Ni(fe.$elm$,!1)),gt},Ni=(fe,$e)=>{pe.$flags$|=1;const ct=fe.childNodes;for(let zt=ct.length-1;zt>=0;zt--){const en=ct[zt];en["s-hn"]!==q&&en["s-ol"]&&(Qe(en).insertBefore(en,ie(en)),en["s-ol"].remove(),en["s-ol"]=void 0,he=!0),$e&&Ni(en,$e)}pe.$flags$&=-2},Ki=(fe,$e,ct,zt,en,je)=>{let Ft,gt=fe["s-cr"]&&fe["s-cr"].parentNode||fe;for(gt.shadowRoot&&gt.tagName===q&&(gt=gt.shadowRoot);en<=je;++en)zt[en]&&(Ft=Mi(null,ct,en,fe),Ft&&(zt[en].$elm$=Ft,gt.insertBefore(Ft,ie($e))))},Vt=(fe,$e,ct,zt,en)=>{for(;$e<=ct;++$e)(zt=fe[$e])&&(en=zt.$elm$,pi(zt),b=!0,en["s-ol"]?en["s-ol"].remove():Ni(en,!0),en.remove())},Ge=(fe,$e)=>fe.$tag$===$e.$tag$&&("slot"===fe.$tag$?fe.$name$===$e.$name$:fe.$key$===$e.$key$),ie=fe=>fe&&fe["s-ol"]||fe,Qe=fe=>(fe["s-ol"]?fe["s-ol"]:fe).parentNode,Wt=(fe,$e)=>{const ct=$e.$elm$=fe.$elm$,zt=fe.$children$,en=$e.$children$,je=$e.$tag$,gt=$e.$text$;let Ft;null===gt?(Ie="svg"===je||"foreignObject"!==je&&Ie,"slot"===je||Bi(fe,$e,Ie),null!==zt&&null!==en?((fe,$e,ct,zt)=>{let Vi,Ir,en=0,je=0,gt=0,Ft=0,gn=$e.length-1,Yt=$e[0],Gn=$e[gn],Hn=zt.length-1,Ai=zt[0],Fi=zt[Hn];for(;en<=gn&&je<=Hn;)if(null==Yt)Yt=$e[++en];else if(null==Gn)Gn=$e[--gn];else if(null==Ai)Ai=zt[++je];else if(null==Fi)Fi=zt[--Hn];else if(Ge(Yt,Ai))Wt(Yt,Ai),Yt=$e[++en],Ai=zt[++je];else if(Ge(Gn,Fi))Wt(Gn,Fi),Gn=$e[--gn],Fi=zt[--Hn];else if(Ge(Yt,Fi))("slot"===Yt.$tag$||"slot"===Fi.$tag$)&&Ni(Yt.$elm$.parentNode,!1),Wt(Yt,Fi),fe.insertBefore(Yt.$elm$,Gn.$elm$.nextSibling),Yt=$e[++en],Fi=zt[--Hn];else if(Ge(Gn,Ai))("slot"===Yt.$tag$||"slot"===Fi.$tag$)&&Ni(Gn.$elm$.parentNode,!1),Wt(Gn,Ai),fe.insertBefore(Gn.$elm$,Yt.$elm$),Gn=$e[--gn],Ai=zt[++je];else{for(gt=-1,Ft=en;Ft<=gn;++Ft)if($e[Ft]&&null!==$e[Ft].$key$&&$e[Ft].$key$===Ai.$key$){gt=Ft;break}gt>=0?(Ir=$e[gt],Ir.$tag$!==Ai.$tag$?Vi=Mi($e&&$e[je],ct,gt,fe):(Wt(Ir,Ai),$e[gt]=void 0,Vi=Ir.$elm$),Ai=zt[++je]):(Vi=Mi($e&&$e[je],ct,je,fe),Ai=zt[++je]),Vi&&Qe(Yt.$elm$).insertBefore(Vi,ie(Yt.$elm$))}en>gn?Ki(fe,null==zt[Hn+1]?null:zt[Hn+1].$elm$,ct,zt,je,Hn):je>Hn&&Vt($e,en,gn)})(ct,zt,$e,en):null!==en?(null!==fe.$text$&&(ct.textContent=""),Ki(ct,null,$e,en,0,en.length-1)):null!==zt&&Vt(zt,0,zt.length-1),Ie&&"svg"===je&&(Ie=!1)):(Ft=ct["s-cr"])?Ft.parentNode.textContent=gt:fe.$text$!==gt&&(ct.data=gt)},rn=fe=>{const $e=fe.childNodes;let ct,zt,en,je,gt,Ft;for(zt=0,en=$e.length;zt<en;zt++)if(ct=$e[zt],1===ct.nodeType){if(ct["s-sr"])for(gt=ct["s-sn"],ct.hidden=!1,je=0;je<en;je++)if(Ft=$e[je].nodeType,$e[je]["s-hn"]!==ct["s-hn"]||""!==gt){if(1===Ft&&gt===$e[je].getAttribute("slot")){ct.hidden=!0;break}}else if(1===Ft||3===Ft&&""!==$e[je].textContent.trim()){ct.hidden=!0;break}rn(ct)}},oi=[],Di=fe=>{let $e,ct,zt,en,je,gt,Ft=0;const gn=fe.childNodes,Yt=gn.length;for(;Ft<Yt;Ft++){if($e=gn[Ft],$e["s-sr"]&&(ct=$e["s-cr"])&&ct.parentNode)for(zt=ct.parentNode.childNodes,en=$e["s-sn"],gt=zt.length-1;gt>=0;gt--)ct=zt[gt],!ct["s-cn"]&&!ct["s-nr"]&&ct["s-hn"]!==$e["s-hn"]&&(ar(ct,en)?(je=oi.find(Gn=>Gn.$nodeToRelocate$===ct),b=!0,ct["s-sn"]=ct["s-sn"]||en,je?je.$slotRefNode$=$e:oi.push({$slotRefNode$:$e,$nodeToRelocate$:ct}),ct["s-sr"]&&oi.map(Gn=>{ar(Gn.$nodeToRelocate$,ct["s-sn"])&&(je=oi.find(Hn=>Hn.$nodeToRelocate$===ct),je&&!Gn.$slotRefNode$&&(Gn.$slotRefNode$=je.$slotRefNode$))})):oi.some(Gn=>Gn.$nodeToRelocate$===ct)||oi.push({$nodeToRelocate$:ct}));1===$e.nodeType&&Di($e)}},ar=(fe,$e)=>1===fe.nodeType?null===fe.getAttribute("slot")&&""===$e||fe.getAttribute("slot")===$e:fe["s-sn"]===$e||""===$e,pi=fe=>{fe.$attrs$&&fe.$attrs$.ref&&fe.$attrs$.ref(null),fe.$children$&&fe.$children$.map(pi)},Si=fe=>mi(fe).$hostElement$,vr=(fe,$e,ct)=>{const zt=Si(fe);return{emit:en=>xr(zt,$e,{bubbles:!!(4&ct),composed:!!(2&ct),cancelable:!!(1&ct),detail:en})}},xr=(fe,$e,ct)=>{const zt=pe.ce($e,ct);return fe.dispatchEvent(zt),zt},gr=(fe,$e)=>{$e&&!fe.$onRenderResolve$&&$e["s-p"]&&$e["s-p"].push(new Promise(ct=>fe.$onRenderResolve$=ct))},ui=(fe,$e)=>{if(fe.$flags$|=16,!(4&fe.$flags$))return gr(fe,fe.$ancestorComponent$),si(()=>pn(fe,$e));fe.$flags$|=512},pn=(fe,$e)=>{const zt=fe.$lazyInstance$;let en;return $e&&(fe.$flags$|=256,fe.$queuedListeners$&&(fe.$queuedListeners$.map(([je,gt])=>z(zt,je,gt)),fe.$queuedListeners$=null),en=z(zt,"componentWillLoad")),en=k(en,()=>z(zt,"componentWillRender")),k(en,()=>wt(fe,zt,$e))},wt=function(){var fe=(0,d.Z)(function*($e,ct,zt){const en=$e.$hostElement$,gt=en["s-rc"];zt&&(fe=>{const $e=fe.$cmpMeta$,ct=fe.$hostElement$,zt=$e.$flags$,je=Lt(ct.shadowRoot?ct.shadowRoot:ct.getRootNode(),$e,fe.$modeName$);10&zt&&(ct["s-sc"]=je,ct.classList.add(je+"-h"),2&zt&&ct.classList.add(je+"-s"))})($e);Rt($e,ct),gt&&(gt.map(gn=>gn()),en["s-rc"]=void 0);{const gn=en["s-p"],Yt=()=>_n($e);0===gn.length?Yt():(Promise.all(gn).then(Yt),$e.$flags$|=4,gn.length=0)}});return function(ct,zt,en){return fe.apply(this,arguments)}}(),Rt=(fe,$e,ct)=>{try{$e=$e.render&&$e.render(),fe.$flags$&=-17,fe.$flags$|=2,((fe,$e)=>{const ct=fe.$hostElement$,zt=fe.$cmpMeta$,en=fe.$vnode$||ot(null,null),je=(fe=>fe&&fe.$tag$===Bt)($e)?$e:un(null,null,$e);if(q=ct.tagName,zt.$attrsToReflect$&&(je.$attrs$=je.$attrs$||{},zt.$attrsToReflect$.map(([gt,Ft])=>je.$attrs$[Ft]=ct[gt])),je.$tag$=null,je.$flags$|=4,fe.$vnode$=je,je.$elm$=en.$elm$=ct.shadowRoot||ct,re=ct["s-sc"],a=ct["s-cr"],oe=0!=(1&zt.$flags$),b=!1,Wt(en,je),pe.$flags$|=1,he){Di(je.$elm$);let gt,Ft,gn,Yt,Gn,Hn,Ai=0;for(;Ai<oi.length;Ai++)gt=oi[Ai],Ft=gt.$nodeToRelocate$,Ft["s-ol"]||(gn=xe.createTextNode(""),gn["s-nr"]=Ft,Ft.parentNode.insertBefore(Ft["s-ol"]=gn,Ft));for(Ai=0;Ai<oi.length;Ai++)if(gt=oi[Ai],Ft=gt.$nodeToRelocate$,gt.$slotRefNode$){for(Yt=gt.$slotRefNode$.parentNode,Gn=gt.$slotRefNode$.nextSibling,gn=Ft["s-ol"];gn=gn.previousSibling;)if(Hn=gn["s-nr"],Hn&&Hn["s-sn"]===Ft["s-sn"]&&Yt===Hn.parentNode&&(Hn=Hn.nextSibling,!Hn||!Hn["s-nr"])){Gn=Hn;break}(!Gn&&Yt!==Ft.parentNode||Ft.nextSibling!==Gn)&&Ft!==Gn&&(!Ft["s-hn"]&&Ft["s-ol"]&&(Ft["s-hn"]=Ft["s-ol"].parentNode.nodeName),Yt.insertBefore(Ft,Gn))}else 1===Ft.nodeType&&(Ft.hidden=!0)}b&&rn(je.$elm$),pe.$flags$&=-2,oi.length=0})(fe,$e)}catch(zt){Er(zt,fe.$hostElement$)}return null},_n=fe=>{const ct=fe.$hostElement$,en=fe.$lazyInstance$,je=fe.$ancestorComponent$;z(en,"componentDidRender"),64&fe.$flags$?z(en,"componentDidUpdate"):(fe.$flags$|=64,X(ct),z(en,"componentDidLoad"),fe.$onReadyResolve$(ct),je||Ht()),fe.$onInstanceResolve$(ct),fe.$onRenderResolve$&&(fe.$onRenderResolve$(),fe.$onRenderResolve$=void 0),512&fe.$flags$&&Kr(()=>ui(fe,!1)),fe.$flags$&=-517},Ue=fe=>{{const $e=mi(fe),ct=$e.$hostElement$.isConnected;return ct&&2==(18&$e.$flags$)&&ui($e,!1),ct}},Ht=fe=>{X(xe.documentElement),Kr(()=>xr(K,"appload",{detail:{namespace:"ionic"}}))},z=(fe,$e,ct)=>{if(fe&&fe[$e])try{return fe[$e](ct)}catch(zt){Er(zt)}},k=(fe,$e)=>fe&&fe.then?fe.then($e):$e(),X=fe=>fe.classList.add("hydrated"),Ze=(fe,$e,ct,zt,en,je,gt)=>{let Ft,gn,Yt,Gn;if(1===je.nodeType){for(Ft=je.getAttribute("c-id"),Ft&&(gn=Ft.split("."),(gn[0]===gt||"0"===gn[0])&&(Yt={$flags$:0,$hostId$:gn[0],$nodeId$:gn[1],$depth$:gn[2],$index$:gn[3],$tag$:je.tagName.toLowerCase(),$elm$:je,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},$e.push(Yt),je.removeAttribute("c-id"),fe.$children$||(fe.$children$=[]),fe.$children$[Yt.$index$]=Yt,fe=Yt,zt&&"0"===Yt.$depth$&&(zt[Yt.$index$]=Yt.$elm$))),Gn=je.childNodes.length-1;Gn>=0;Gn--)Ze(fe,$e,ct,zt,en,je.childNodes[Gn],gt);if(je.shadowRoot)for(Gn=je.shadowRoot.childNodes.length-1;Gn>=0;Gn--)Ze(fe,$e,ct,zt,en,je.shadowRoot.childNodes[Gn],gt)}else if(8===je.nodeType)gn=je.nodeValue.split("."),(gn[1]===gt||"0"===gn[1])&&(Ft=gn[0],Yt={$flags$:0,$hostId$:gn[1],$nodeId$:gn[2],$depth$:gn[3],$index$:gn[4],$elm$:je,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===Ft?(Yt.$elm$=je.nextSibling,Yt.$elm$&&3===Yt.$elm$.nodeType&&(Yt.$text$=Yt.$elm$.textContent,$e.push(Yt),je.remove(),fe.$children$||(fe.$children$=[]),fe.$children$[Yt.$index$]=Yt,zt&&"0"===Yt.$depth$&&(zt[Yt.$index$]=Yt.$elm$))):Yt.$hostId$===gt&&("s"===Ft?(Yt.$tag$="slot",je["s-sn"]=gn[5]?Yt.$name$=gn[5]:"",je["s-sr"]=!0,zt&&(Yt.$elm$=xe.createElement(Yt.$tag$),Yt.$name$&&Yt.$elm$.setAttribute("name",Yt.$name$),je.parentNode.insertBefore(Yt.$elm$,je),je.remove(),"0"===Yt.$depth$&&(zt[Yt.$index$]=Yt.$elm$)),ct.push(Yt),fe.$children$||(fe.$children$=[]),fe.$children$[Yt.$index$]=Yt):"r"===Ft&&(zt?je.remove():(en["s-cr"]=je,je["s-cn"]=!0))));else if(fe&&"style"===fe.$tag$){const Hn=ot(null,je.textContent);Hn.$elm$=je,Hn.$index$="0",fe.$children$=[Hn]}},dt=(fe,$e)=>{if(1===fe.nodeType){let ct=0;for(;ct<fe.childNodes.length;ct++)dt(fe.childNodes[ct],$e);if(fe.shadowRoot)for(ct=0;ct<fe.shadowRoot.childNodes.length;ct++)dt(fe.shadowRoot.childNodes[ct],$e)}else if(8===fe.nodeType){const ct=fe.nodeValue.split(".");"o"===ct[0]&&($e.set(ct[1]+"."+ct[2],fe),fe.nodeValue="",fe["s-en"]=ct[3])}},Fe=(fe,$e,ct)=>{if($e.$members$){fe.watchers&&($e.$watchers$=fe.watchers);const zt=Object.entries($e.$members$),en=fe.prototype;if(zt.map(([je,[gt]])=>{31&gt||2&ct&&32&gt?Object.defineProperty(en,je,{get(){return((fe,$e)=>mi(this).$instanceValues$.get($e))(0,je)},set(Ft){((fe,$e,ct,zt)=>{const en=mi(fe),je=en.$hostElement$,gt=en.$instanceValues$.get($e),Ft=en.$flags$,gn=en.$lazyInstance$;ct=((fe,$e)=>null==fe||Nn(fe)?fe:4&$e?"false"!==fe&&(""===fe||!!fe):2&$e?parseFloat(fe):1&$e?String(fe):fe)(ct,zt.$members$[$e][0]);const Yt=Number.isNaN(gt)&&Number.isNaN(ct);if((!(8&Ft)||void 0===gt)&&ct!==gt&&!Yt&&(en.$instanceValues$.set($e,ct),gn)){if(zt.$watchers$&&128&Ft){const Hn=zt.$watchers$[$e];Hn&&Hn.map(Ai=>{try{gn[Ai](ct,gt,$e)}catch(Fi){Er(Fi,je)}})}2==(18&Ft)&&ui(en,!1)}})(this,je,Ft,$e)},configurable:!0,enumerable:!0}):1&ct&&64&gt&&Object.defineProperty(en,je,{value(...Ft){const gn=mi(this);return gn.$onInstancePromise$.then(()=>gn.$lazyInstance$[je](...Ft))}})}),1&ct){const je=new Map;en.attributeChangedCallback=function(gt,Ft,gn){pe.jmp(()=>{const Yt=je.get(gt);if(this.hasOwnProperty(Yt))gn=this[Yt],delete this[Yt];else if(en.hasOwnProperty(Yt)&&"number"==typeof this[Yt]&&this[Yt]==gn)return;this[Yt]=(null!==gn||"boolean"!=typeof this[Yt])&&gn})},fe.observedAttributes=zt.filter(([gt,Ft])=>15&Ft[0]).map(([gt,Ft])=>{const gn=Ft[1]||gt;return je.set(gn,gt),512&Ft[0]&&$e.$attrsToReflect$.push([gt,gn]),gn})}}return fe},Be=function(){var fe=(0,d.Z)(function*($e,ct,zt,en,je){if(!(32&ct.$flags$)){{if(ct.$flags$|=32,(je=Jt(zt)).then){const Yt=()=>{};je=yield je,Yt()}je.isProxied||(zt.$watchers$=je.watchers,Fe(je,zt,2),je.isProxied=!0);const gn=()=>{};ct.$flags$|=8;try{new je(ct)}catch(Yt){Er(Yt)}ct.$flags$&=-9,ct.$flags$|=128,gn(),Me(ct.$lazyInstance$)}if(je.style){let gn=je.style;"string"!=typeof gn&&(gn=gn[ct.$modeName$=(fe=>dr.map($e=>$e(fe)).find($e=>!!$e))($e)]);const Yt=St(zt,ct.$modeName$);if(!Xr.has(Yt)){const Gn=()=>{};Gt(Yt,gn,!!(1&zt.$flags$)),Gn()}}}const gt=ct.$ancestorComponent$,Ft=()=>ui(ct,!0);gt&&gt["s-rc"]?gt["s-rc"].push(Ft):Ft()});return function(ct,zt,en,je,gt){return fe.apply(this,arguments)}}(),Me=fe=>{z(fe,"connectedCallback")},jt=fe=>{const $e=fe["s-cr"]=xe.createComment("");$e["s-cn"]=!0,fe.insertBefore($e,fe.firstChild)},Tn=(fe,$e={})=>{const zt=[],en=$e.exclude||[],je=K.customElements,gt=xe.head,Ft=gt.querySelector("meta[charset]"),gn=xe.createElement("style"),Yt=[],Gn=xe.querySelectorAll(`[${He}]`);let Hn,Ai=!0,Fi=0;for(Object.assign(pe,$e),pe.$resourcesUrl$=new URL($e.resourcesUrl||"./",xe.baseURI).href,pe.$flags$|=2;Fi<Gn.length;Fi++)Gt(Gn[Fi].getAttribute(He),xt(Gn[Fi].innerHTML),!0);fe.map(Vi=>{Vi[1].map(Ir=>{const Qi={$flags$:Ir[0],$tagName$:Ir[1],$members$:Ir[2],$listeners$:Ir[3]};Qi.$members$=Ir[2],Qi.$listeners$=Ir[3],Qi.$attrsToReflect$=[],Qi.$watchers$={};const Hr=Qi.$tagName$,zr=class extends HTMLElement{constructor(hr){super(hr),Oi(hr=this,Qi),1&Qi.$flags$&&hr.attachShadow({mode:"open",delegatesFocus:!!(16&Qi.$flags$)})}connectedCallback(){Hn&&(clearTimeout(Hn),Hn=null),Ai?Yt.push(this):pe.jmp(()=>(fe=>{if(!(1&pe.$flags$)){const $e=mi(fe),ct=$e.$cmpMeta$,zt=()=>{};if(1&$e.$flags$)ne(fe,$e,ct.$listeners$),Me($e.$lazyInstance$);else{let en;if($e.$flags$|=1,en=fe.getAttribute(Xe),en){if(1&ct.$flags$){const je=Lt(fe.shadowRoot,ct,fe.getAttribute("s-mode"));fe.classList.remove(je+"-h",je+"-s")}((fe,$e,ct,zt)=>{const je=fe.shadowRoot,gt=[],gn=je?[]:null,Yt=zt.$vnode$=ot($e,null);pe.$orgLocNodes$||dt(xe.body,pe.$orgLocNodes$=new Map),fe[Xe]=ct,fe.removeAttribute(Xe),Ze(Yt,gt,[],gn,fe,fe,ct),gt.map(Gn=>{const Hn=Gn.$hostId$+"."+Gn.$nodeId$,Ai=pe.$orgLocNodes$.get(Hn),Fi=Gn.$elm$;Ai&&""===Ai["s-en"]&&Ai.parentNode.insertBefore(Fi,Ai.nextSibling),je||(Fi["s-hn"]=$e,Ai&&(Fi["s-ol"]=Ai,Fi["s-ol"]["s-nr"]=Fi)),pe.$orgLocNodes$.delete(Hn)}),je&&gn.map(Gn=>{Gn&&je.appendChild(Gn)})})(fe,ct.$tagName$,en,$e)}en||12&ct.$flags$&&jt(fe);{let je=fe;for(;je=je.parentNode||je.host;)if(1===je.nodeType&&je.hasAttribute("s-id")&&je["s-p"]||je["s-p"]){gr($e,$e.$ancestorComponent$=je);break}}ct.$members$&&Object.entries(ct.$members$).map(([je,[gt]])=>{if(31&gt&&fe.hasOwnProperty(je)){const Ft=fe[je];delete fe[je],fe[je]=Ft}}),Kr(()=>Be(fe,$e,ct))}zt()}})(this))}disconnectedCallback(){pe.jmp(()=>(fe=>{if(!(1&pe.$flags$)){const $e=mi(this),ct=$e.$lazyInstance$;$e.$rmListeners$&&($e.$rmListeners$.map(zt=>zt()),$e.$rmListeners$=void 0),z(ct,"disconnectedCallback")}})())}componentOnReady(){return mi(this).$onReadyPromise$}};Qi.$lazyBundleId$=Vi[0],!en.includes(Hr)&&!je.get(Hr)&&(zt.push(Hr),je.define(Hr,Fe(zr,Qi,1)))})}),gn.innerHTML=zt+"{visibility:hidden}.hydrated{visibility:inherit}",gn.setAttribute("data-styles",""),gt.insertBefore(gn,Ft?Ft.nextSibling:gt.firstChild),Ai=!1,Yt.length?Yt.map(Vi=>Vi.connectedCallback()):pe.jmp(()=>Hn=setTimeout(Ht,30))},qn=fe=>{const $e=new URL(fe,pe.$resourcesUrl$);return $e.origin!==K.location.origin?$e.href:$e.pathname},Yn=new WeakMap,mi=fe=>Yn.get(fe),ei=(fe,$e)=>Yn.set($e.$lazyInstance$=fe,$e),Oi=(fe,$e)=>{const ct={$flags$:0,$hostElement$:fe,$cmpMeta$:$e,$instanceValues$:new Map};return ct.$onInstancePromise$=new Promise(zt=>ct.$onInstanceResolve$=zt),ct.$onReadyPromise$=new Promise(zt=>ct.$onReadyResolve$=zt),fe["s-p"]=[],fe["s-rc"]=[],ne(fe,ct,$e.$listeners$),Yn.set(fe,ct)},Li=(fe,$e)=>$e in fe,Er=(fe,$e)=>(0,console.error)(fe,$e),Gr=new Map,Jt=(fe,$e,ct)=>{const zt=fe.$tagName$.replace(/-/g,"_"),en=fe.$lazyBundleId$,je=Gr.get(en);return je?je[zt]:F(863)(`./${en}.entry.js`).then(gt=>(Gr.set(en,gt),gt[zt]),Er)},Xr=new Map,dr=[],no=[],fo=[],bi=(fe,$e)=>ct=>{fe.push(ct),Ve||(Ve=!0,$e&&4&pe.$flags$?Kr(Dr):pe.raf(Dr))},qi=fe=>{for(let $e=0;$e<fe.length;$e++)try{fe[$e](performance.now())}catch(ct){Er(ct)}fe.length=0},Dr=()=>{qi(no),qi(fo),(Ve=no.length>0)&&pe.raf(Dr)},Kr=fe=>Ke().then(fe),In=bi(no,!1),si=bi(fo,!0),En={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1}},5179:(Ln,Dt,F)=>{"use strict";F.d(Dt,{a:()=>K,b:()=>It,c:()=>re,g:()=>Ve,i:()=>Gt});var d=F(1308);class v{constructor(){this.m=new Map}reset(yt){this.m=new Map(Object.entries(yt))}get(yt,St){const xt=this.m.get(yt);return void 0!==xt?xt:St}getBoolean(yt,St=!1){const xt=this.m.get(yt);return void 0===xt?St:"string"==typeof xt?"true"===xt:!!xt}getNumber(yt,St){const xt=parseFloat(this.m.get(yt));return isNaN(xt)?void 0!==St?St:NaN:xt}set(yt,St){this.m.set(yt,St)}}const re=new v,Ie="ionic-persist-config",Ve=Lt=>xe(Lt),K=(Lt,yt)=>("string"==typeof Lt&&(yt=Lt,Lt=void 0),Ve(Lt).includes(yt)),xe=(Lt=window)=>{if(typeof Lt>"u")return[];Lt.Ionic=Lt.Ionic||{};let yt=Lt.Ionic.platforms;return null==yt&&(yt=Lt.Ionic.platforms=pe(Lt),yt.forEach(St=>Lt.document.documentElement.classList.add(`plt-${St}`))),yt},pe=Lt=>{const yt=re.get("platform");return Object.keys(Ee).filter(St=>{const xt=yt?.[St];return"function"==typeof xt?xt(Lt):Ee[St](Lt)})},ce=Lt=>!!(de(Lt,/iPad/i)||de(Lt,/Macintosh/i)&&ge(Lt)),ne=Lt=>de(Lt,/android|sink/i),ge=Lt=>se(Lt,"(any-pointer:coarse)"),Le=Lt=>we(Lt)||Xe(Lt),we=Lt=>!!(Lt.cordova||Lt.phonegap||Lt.PhoneGap),Xe=Lt=>!!Lt.Capacitor?.isNative,de=(Lt,yt)=>yt.test(Lt.navigator.userAgent),se=(Lt,yt)=>{var St;return null===(St=Lt.matchMedia)||void 0===St?void 0:St.call(Lt,yt).matches},Ee={ipad:ce,iphone:Lt=>de(Lt,/iPhone/i),ios:Lt=>de(Lt,/iPhone|iPod/i)||ce(Lt),android:ne,phablet:Lt=>{const yt=Lt.innerWidth,St=Lt.innerHeight,xt=Math.min(yt,St),rt=Math.max(yt,St);return xt>390&&xt<520&&rt>620&&rt<800},tablet:Lt=>{const yt=Lt.innerWidth,St=Lt.innerHeight,xt=Math.min(yt,St),rt=Math.max(yt,St);return ce(Lt)||(Lt=>ne(Lt)&&!de(Lt,/mobile/i))(Lt)||xt>460&&xt<820&&rt>780&&rt<1400},cordova:we,capacitor:Xe,electron:Lt=>de(Lt,/electron/i),pwa:Lt=>{var yt;return!!(null!==(yt=Lt.matchMedia)&&void 0!==yt&&yt.call(Lt,"(display-mode: standalone)").matches||Lt.navigator.standalone)},mobile:ge,mobileweb:Lt=>ge(Lt)&&!Le(Lt),desktop:Lt=>!ge(Lt),hybrid:Le};let _t;const It=Lt=>Lt&&(0,d.g)(Lt)||_t,Gt=(Lt={})=>{if(typeof window>"u")return;const yt=window.document,St=window,xt=St.Ionic=St.Ionic||{},rt={};Lt._ael&&(rt.ael=Lt._ael),Lt._rel&&(rt.rel=Lt._rel),Lt._ce&&(rt.ce=Lt._ce),(0,d.s)(rt);const lt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(Lt=>{try{const yt=Lt.sessionStorage.getItem(Ie);return null!==yt?JSON.parse(yt):{}}catch{return{}}})(St)),{persistConfig:!1}),xt.config),(Lt=>{const yt={};return Lt.location.search.slice(1).split("&").map(St=>St.split("=")).map(([St,xt])=>[decodeURIComponent(St),decodeURIComponent(xt)]).filter(([St])=>((Lt,yt)=>Lt.substr(0,yt.length)===yt)(St,"ionic:")).map(([St,xt])=>[St.slice("ionic:".length),xt]).forEach(([St,xt])=>{yt[St]=xt}),yt})(St)),Lt);re.reset(lt),re.getBoolean("persistConfig")&&((Lt,yt)=>{try{Lt.sessionStorage.setItem(Ie,JSON.stringify(yt))}catch{return}})(St,lt),xe(St),xt.config=re,xt.mode=_t=re.get("mode",yt.documentElement.getAttribute("mode")||(K(St,"ios")?"ios":"md")),re.set("mode",_t),yt.documentElement.setAttribute("mode",_t),yt.documentElement.classList.add(_t),re.getBoolean("_testing")&&re.set("animated",!1);const Ce=kt=>{var Ut;return null===(Ut=kt.tagName)||void 0===Ut?void 0:Ut.startsWith("ION-")},bt=kt=>["ios","md"].includes(kt);(0,d.a)(kt=>{for(;kt;){const Ut=kt.mode||kt.getAttribute("mode");if(Ut){if(bt(Ut))return Ut;Ce(kt)&&console.warn('Invalid ionic mode: "'+Ut+'", expected: "ios" or "md"')}kt=kt.parentElement}return _t})}},6439:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{iosTransitionAnimation:()=>pe,shadow:()=>b});var d=F(181),v=F(1843);F(3457),F(1308);const oe=ze=>document.querySelector(`${ze}.ion-cloned-element`),b=ze=>ze.shadowRoot||ze,he=ze=>{const ce="ION-TABS"===ze.tagName?ze:ze.querySelector("ion-tabs"),Ke="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=ce){const Pe=ce.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=Pe?Pe.querySelector(Ke):null}return ze.querySelector(Ke)},Ie=(ze,ce)=>{const Ke="ION-TABS"===ze.tagName?ze:ze.querySelector("ion-tabs");let Pe=[];if(null!=Ke){const ne=Ke.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=ne&&(Pe=ne.querySelectorAll("ion-buttons"))}else Pe=ze.querySelectorAll("ion-buttons");for(const ne of Pe){const Je=ne.closest("ion-header"),Pt=Je&&!Je.classList.contains("header-collapse-condense-inactive"),at=ne.querySelector("ion-back-button"),ge=ne.classList.contains("buttons-collapse");if(null!==at&&("start"===ne.slot||""===ne.slot)&&(ge&&Pt&&ce||!ge))return at}return null},K=(ze,ce,Ke,Pe,ne,Je)=>{const Pt=ce?`calc(100% - ${Je.right+4}px)`:Je.left-4+"px",at=ce?"7px":"-7px",ge=ce?"-4px":"4px",ke=ce?"-4px":"4px",Le=ce?"right":"left",we=ce?"left":"right",me=Ke?[{offset:0,opacity:1,transform:`translate3d(${ge}, ${Je.top-46}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${at}, ${ne.top-40}px, 0) scale(2.1)`}]:[{offset:0,opacity:0,transform:`translate3d(${at}, ${ne.top-40}px, 0) scale(2.1)`},{offset:1,opacity:1,transform:`translate3d(${ge}, ${Je.top-46}px, 0) scale(1)`}],Ee=Ke?[{offset:0,opacity:1,transform:`translate3d(${ke}, ${Je.top-46}px, 0) scale(1)`},{offset:.2,opacity:0,transform:`translate3d(${ke}, ${Je.top-41}px, 0) scale(0.6)`},{offset:1,opacity:0,transform:`translate3d(${ke}, ${Je.top-41}px, 0) scale(0.6)`}]:[{offset:0,opacity:0,transform:`translate3d(${ke}, ${Je.top-41}px, 0) scale(0.6)`},{offset:1,opacity:1,transform:`translate3d(${ke}, ${Je.top-46}px, 0) scale(1)`}],_t=(0,d.c)(),It=(0,d.c)(),Gt=oe("ion-back-button"),Lt=b(Gt).querySelector(".button-text"),yt=b(Gt).querySelector("ion-icon");Gt.text=Pe.text,Gt.mode=Pe.mode,Gt.icon=Pe.icon,Gt.color=Pe.color,Gt.disabled=Pe.disabled,Gt.style.setProperty("display","block"),Gt.style.setProperty("position","fixed"),It.addElement(yt),_t.addElement(Lt),_t.beforeStyles({"transform-origin":`${Le} center`}).beforeAddWrite(()=>{Pe.style.setProperty("display","none"),Gt.style.setProperty(Le,Pt)}).afterAddWrite(()=>{Pe.style.setProperty("display",""),Gt.style.setProperty("display","none"),Gt.style.removeProperty(Le)}).keyframes(me),It.beforeStyles({"transform-origin":`${we} center`}).keyframes(Ee),ze.addAnimation([_t,It])},xe=(ze,ce,Ke,Pe,ne,Je)=>{const Pt=ce?`calc(100% - ${ne.right}px)`:`${ne.left}px`,at=ce?"-18px":"18px",ge=ce?"right":"left",we=Ke?[{offset:0,opacity:0,transform:`translate3d(${at}, ${Je.top-4}px, 0) scale(0.49)`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0, ${ne.top-2}px, 0) scale(1)`}]:[{offset:0,opacity:.99,transform:`translate3d(0, ${ne.top-2}px, 0) scale(1)`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${at}, ${Je.top-4}px, 0) scale(0.5)`}],Xe=oe("ion-title"),He=(0,d.c)();Xe.innerText=Pe.innerText,Xe.size=Pe.size,Xe.color=Pe.color,He.addElement(Xe),He.beforeStyles({"transform-origin":`${ge} center`,height:"46px",display:"",position:"relative",[ge]:Pt}).beforeAddWrite(()=>{Pe.style.setProperty("display","none")}).afterAddWrite(()=>{Pe.style.setProperty("display",""),Xe.style.setProperty("display","none")}).keyframes(we),ze.addAnimation(He)},pe=(ze,ce)=>{var Ke;try{const Pe="cubic-bezier(0.32,0.72,0,1)",ne="opacity",Je="transform",Pt="0%",ge="rtl"===ze.ownerDocument.dir,ke=ge?"-99.5%":"99.5%",Le=ge?"33%":"-33%",we=ce.enteringEl,Xe=ce.leavingEl,He="back"===ce.direction,me=we.querySelector(":scope > ion-content"),de=we.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),se=we.querySelectorAll(":scope > ion-header > ion-toolbar"),Ee=(0,d.c)(),_t=(0,d.c)();if(Ee.addElement(we).duration((null!==(Ke=ce.duration)&&void 0!==Ke?Ke:0)||540).easing(ce.easing||Pe).fill("both").beforeRemoveClass("ion-page-invisible"),Xe&&null!=ze){const yt=(0,d.c)();yt.addElement(ze),Ee.addAnimation(yt)}if(me||0!==se.length||0!==de.length?(_t.addElement(me),_t.addElement(de)):_t.addElement(we.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ee.addAnimation(_t),He?_t.beforeClearStyles([ne]).fromTo("transform",`translateX(${Le})`,`translateX(${Pt})`).fromTo(ne,.8,1):_t.beforeClearStyles([ne]).fromTo("transform",`translateX(${ke})`,`translateX(${Pt})`),me){const yt=b(me).querySelector(".transition-effect");if(yt){const St=yt.querySelector(".transition-cover"),xt=yt.querySelector(".transition-shadow"),rt=(0,d.c)(),lt=(0,d.c)(),Ce=(0,d.c)();rt.addElement(yt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),lt.addElement(St).beforeClearStyles([ne]).fromTo(ne,0,.1),Ce.addElement(xt).beforeClearStyles([ne]).fromTo(ne,.03,.7),rt.addAnimation([lt,Ce]),_t.addAnimation([rt])}}const It=we.querySelector("ion-header.header-collapse-condense"),{forward:Gt,backward:Lt}=((ze,ce,Ke,Pe,ne)=>{const Je=Ie(Pe,Ke),Pt=he(ne),at=he(Pe),ge=Ie(ne,Ke),ke=null!==Je&&null!==Pt&&!Ke,Le=null!==at&&null!==ge&&Ke;if(ke){const we=Pt.getBoundingClientRect(),Xe=Je.getBoundingClientRect();xe(ze,ce,Ke,Pt,we,Xe),K(ze,ce,Ke,Je,we,Xe)}else if(Le){const we=at.getBoundingClientRect(),Xe=ge.getBoundingClientRect();xe(ze,ce,Ke,at,we,Xe),K(ze,ce,Ke,ge,we,Xe)}return{forward:ke,backward:Le}})(Ee,ge,He,we,Xe);if(se.forEach(yt=>{const St=(0,d.c)();St.addElement(yt),Ee.addAnimation(St);const xt=(0,d.c)();xt.addElement(yt.querySelector("ion-title"));const rt=(0,d.c)(),lt=Array.from(yt.querySelectorAll("ion-buttons,[menuToggle]")),Ce=yt.closest("ion-header"),bt=Ce?.classList.contains("header-collapse-condense-inactive");let kt;kt=lt.filter(He?ot=>{const Bt=ot.classList.contains("buttons-collapse");return Bt&&!bt||!Bt}:ot=>!ot.classList.contains("buttons-collapse")),rt.addElement(kt);const Ut=(0,d.c)();Ut.addElement(yt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const bn=(0,d.c)();bn.addElement(b(yt).querySelector(".toolbar-background"));const Nn=(0,d.c)(),un=yt.querySelector("ion-back-button");if(un&&Nn.addElement(un),St.addAnimation([xt,rt,Ut,bn,Nn]),rt.fromTo(ne,.01,1),Ut.fromTo(ne,.01,1),He)bt||xt.fromTo("transform",`translateX(${Le})`,`translateX(${Pt})`).fromTo(ne,.01,1),Ut.fromTo("transform",`translateX(${Le})`,`translateX(${Pt})`),Nn.fromTo(ne,.01,1);else if(It||xt.fromTo("transform",`translateX(${ke})`,`translateX(${Pt})`).fromTo(ne,.01,1),Ut.fromTo("transform",`translateX(${ke})`,`translateX(${Pt})`),bn.beforeClearStyles([ne,"transform"]),Ce?.translucent?bn.fromTo("transform",ge?"translateX(-100%)":"translateX(100%)","translateX(0px)"):bn.fromTo(ne,.01,"var(--opacity)"),Gt||Nn.fromTo(ne,.01,1),un&&!Gt){const Bt=(0,d.c)();Bt.addElement(b(un).querySelector(".button-text")).fromTo("transform",ge?"translateX(-100px)":"translateX(100px)","translateX(0px)"),St.addAnimation(Bt)}}),Xe){const yt=(0,d.c)(),St=Xe.querySelector(":scope > ion-content"),xt=Xe.querySelectorAll(":scope > ion-header > ion-toolbar"),rt=Xe.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(St||0!==xt.length||0!==rt.length?(yt.addElement(St),yt.addElement(rt)):yt.addElement(Xe.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ee.addAnimation(yt),He){yt.beforeClearStyles([ne]).fromTo("transform",`translateX(${Pt})`,ge?"translateX(-100%)":"translateX(100%)");const lt=(0,v.g)(Xe);Ee.afterAddWrite(()=>{"normal"===Ee.getDirection()&&lt.style.setProperty("display","none")})}else yt.fromTo("transform",`translateX(${Pt})`,`translateX(${Le})`).fromTo(ne,1,.8);if(St){const lt=b(St).querySelector(".transition-effect");if(lt){const Ce=lt.querySelector(".transition-cover"),bt=lt.querySelector(".transition-shadow"),kt=(0,d.c)(),Ut=(0,d.c)(),bn=(0,d.c)();kt.addElement(lt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Ut.addElement(Ce).beforeClearStyles([ne]).fromTo(ne,.1,0),bn.addElement(bt).beforeClearStyles([ne]).fromTo(ne,.7,.03),kt.addAnimation([Ut,bn]),yt.addAnimation([kt])}}xt.forEach(lt=>{const Ce=(0,d.c)();Ce.addElement(lt);const bt=(0,d.c)();bt.addElement(lt.querySelector("ion-title"));const kt=(0,d.c)(),Ut=lt.querySelectorAll("ion-buttons,[menuToggle]"),bn=lt.closest("ion-header"),Nn=bn?.classList.contains("header-collapse-condense-inactive"),un=Array.from(Ut).filter(Un=>{const hi=Un.classList.contains("buttons-collapse");return hi&&!Nn||!hi});kt.addElement(un);const ot=(0,d.c)(),Bt=lt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");Bt.length>0&&ot.addElement(Bt);const Sn=(0,d.c)();Sn.addElement(b(lt).querySelector(".toolbar-background"));const Qn=(0,d.c)(),ci=lt.querySelector("ion-back-button");if(ci&&Qn.addElement(ci),Ce.addAnimation([bt,kt,ot,Qn,Sn]),Ee.addAnimation(Ce),Qn.fromTo(ne,.99,0),kt.fromTo(ne,.99,0),ot.fromTo(ne,.99,0),He){if(Nn||bt.fromTo("transform",`translateX(${Pt})`,ge?"translateX(-100%)":"translateX(100%)").fromTo(ne,.99,0),ot.fromTo("transform",`translateX(${Pt})`,ge?"translateX(-100%)":"translateX(100%)"),Sn.beforeClearStyles([ne,"transform"]),bn?.translucent?Sn.fromTo("transform","translateX(0px)",ge?"translateX(-100%)":"translateX(100%)"):Sn.fromTo(ne,"var(--opacity)",0),ci&&!Lt){const hi=(0,d.c)();hi.addElement(b(ci).querySelector(".button-text")).fromTo("transform",`translateX(${Pt})`,`translateX(${(ge?-124:124)+"px"})`),Ce.addAnimation(hi)}}else Nn||bt.fromTo("transform",`translateX(${Pt})`,`translateX(${Le})`).fromTo(ne,.99,0).afterClearStyles([Je,ne]),ot.fromTo("transform",`translateX(${Pt})`,`translateX(${Le})`).afterClearStyles([Je,ne]),Qn.afterClearStyles([ne]),bt.afterClearStyles([ne]),kt.afterClearStyles([ne])})}return Ee}catch(Pe){throw Pe}}},7838:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{mdTransitionAnimation:()=>q});var d=F(181),v=F(1843);F(3457),F(1308);const q=(oe,b)=>{var he,Ie,Ve;const K="40px",pe="back"===b.direction,ce=b.leavingEl,Ke=(0,v.g)(b.enteringEl),Pe=Ke.querySelector("ion-toolbar"),ne=(0,d.c)();if(ne.addElement(Ke).fill("both").beforeRemoveClass("ion-page-invisible"),pe?ne.duration((null!==(he=b.duration)&&void 0!==he?he:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):ne.duration((null!==(Ie=b.duration)&&void 0!==Ie?Ie:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform",`translateY(${K})`,"translateY(0px)").fromTo("opacity",.01,1),Pe){const Je=(0,d.c)();Je.addElement(Pe),ne.addAnimation(Je)}if(ce&&pe){ne.duration((null!==(Ve=b.duration)&&void 0!==Ve?Ve:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const Je=(0,d.c)();Je.addElement((0,v.g)(ce)).onFinish(Pt=>{1===Pt&&Je.elements.length>0&&Je.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)",`translateY(${K})`).fromTo("opacity",1,0),ne.addAnimation(Je)}return ne}},3539:(Ln,Dt,F)=>{"use strict";F.d(Dt,{B:()=>St,G:()=>xt,a:()=>he,b:()=>Ie,c:()=>pe,d:()=>He,e:()=>ce,f:()=>de,g:()=>_t,h:()=>oe,i:()=>Gt,j:()=>ne,k:()=>we,l:()=>Ve,m:()=>K,s:()=>yt,t:()=>ze});var d=F(5861),v=F(5179),re=F(7593),a=F(5730);let q=0;const oe=new WeakMap,b=rt=>({create:lt=>Ke(rt,lt),dismiss:(lt,Ce,bt)=>ke(document,lt,Ce,rt,bt),getTop:()=>(0,d.Z)(function*(){return we(document,rt)})()}),he=b("ion-alert"),Ie=b("ion-action-sheet"),Ve=b("ion-loading"),K=b("ion-modal"),pe=b("ion-popover"),ze=b("ion-toast"),ce=rt=>{typeof document<"u"&&ge(document);const lt=q++;rt.overlayIndex=lt,rt.hasAttribute("id")||(rt.id=`ion-overlay-${lt}`)},Ke=(rt,lt)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(rt).then(()=>{const Ce=document.createElement(rt);return Ce.classList.add("overlay-hidden"),Object.assign(Ce,Object.assign(Object.assign({},lt),{hasController:!0})),se(document).appendChild(Ce),new Promise(bt=>(0,a.c)(Ce,bt))}):Promise.resolve(),Pe='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',ne=(rt,lt)=>{let Ce=rt.querySelector(Pe);const bt=Ce?.shadowRoot;bt&&(Ce=bt.querySelector(Pe)||Ce),Ce?(0,a.f)(Ce):lt.focus()},Pt=(rt,lt)=>{const Ce=Array.from(rt.querySelectorAll(Pe));let bt=Ce.length>0?Ce[Ce.length-1]:null;const kt=bt?.shadowRoot;kt&&(bt=kt.querySelector(Pe)||bt),bt?bt.focus():lt.focus()},ge=rt=>{0===q&&(q=1,rt.addEventListener("focus",lt=>{((rt,lt)=>{const Ce=we(lt,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),bt=rt.target;Ce&&bt&&!Ce.classList.contains("ion-disable-focus-trap")&&(Ce.shadowRoot?(()=>{if(Ce.contains(bt))Ce.lastFocus=bt;else{const bn=Ce.lastFocus;ne(Ce,Ce),bn===lt.activeElement&&Pt(Ce,Ce),Ce.lastFocus=lt.activeElement}})():(()=>{if(Ce===bt)Ce.lastFocus=void 0;else{const bn=(0,a.g)(Ce);if(!bn.contains(bt))return;const Nn=bn.querySelector(".ion-overlay-wrapper");if(!Nn)return;if(Nn.contains(bt))Ce.lastFocus=bt;else{const un=Ce.lastFocus;ne(Nn,Ce),un===lt.activeElement&&Pt(Nn,Ce),Ce.lastFocus=lt.activeElement}}})())})(lt,rt)},!0),rt.addEventListener("ionBackButton",lt=>{const Ce=we(rt);Ce?.backdropDismiss&&lt.detail.register(re.OVERLAY_BACK_BUTTON_PRIORITY,()=>Ce.dismiss(void 0,St))}),rt.addEventListener("keyup",lt=>{if("Escape"===lt.key){const Ce=we(rt);Ce?.backdropDismiss&&Ce.dismiss(void 0,St)}}))},ke=(rt,lt,Ce,bt,kt)=>{const Ut=we(rt,bt,kt);return Ut?Ut.dismiss(lt,Ce):Promise.reject("overlay does not exist")},we=(rt,lt,Ce)=>{const bt=((rt,lt)=>(void 0===lt&&(lt="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(rt.querySelectorAll(lt)).filter(Ce=>Ce.overlayIndex>0)))(rt,lt).filter(kt=>!(rt=>rt.classList.contains("overlay-hidden"))(kt));return void 0===Ce?bt[bt.length-1]:bt.find(kt=>kt.id===Ce)},Xe=(rt=!1)=>{const Ce=se(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");Ce&&(rt?Ce.setAttribute("aria-hidden","true"):Ce.removeAttribute("aria-hidden"))},He=function(){var rt=(0,d.Z)(function*(lt,Ce,bt,kt,Ut){var bn,Nn;if(lt.presented)return;Xe(!0),lt.presented=!0,lt.willPresent.emit(),null===(bn=lt.willPresentShorthand)||void 0===bn||bn.emit();const un=(0,v.b)(lt),ot=lt.enterAnimation?lt.enterAnimation:v.c.get(Ce,"ios"===un?bt:kt);(yield Ee(lt,ot,lt.el,Ut))&&(lt.didPresent.emit(),null===(Nn=lt.didPresentShorthand)||void 0===Nn||Nn.emit()),"ION-TOAST"!==lt.el.tagName&&me(lt.el),lt.keyboardClose&&(null===document.activeElement||!lt.el.contains(document.activeElement))&&lt.el.focus()});return function(Ce,bt,kt,Ut,bn){return rt.apply(this,arguments)}}(),me=function(){var rt=(0,d.Z)(function*(lt){let Ce=document.activeElement;if(!Ce)return;const bt=Ce?.shadowRoot;bt&&(Ce=bt.querySelector(Pe)||Ce),yield lt.onDidDismiss(),Ce.focus()});return function(Ce){return rt.apply(this,arguments)}}(),de=function(){var rt=(0,d.Z)(function*(lt,Ce,bt,kt,Ut,bn,Nn){var un,ot;if(!lt.presented)return!1;Xe(!1),lt.presented=!1;try{lt.el.style.setProperty("pointer-events","none"),lt.willDismiss.emit({data:Ce,role:bt}),null===(un=lt.willDismissShorthand)||void 0===un||un.emit({data:Ce,role:bt});const Bt=(0,v.b)(lt),Sn=lt.leaveAnimation?lt.leaveAnimation:v.c.get(kt,"ios"===Bt?Ut:bn);bt!==xt&&(yield Ee(lt,Sn,lt.el,Nn)),lt.didDismiss.emit({data:Ce,role:bt}),null===(ot=lt.didDismissShorthand)||void 0===ot||ot.emit({data:Ce,role:bt}),oe.delete(lt),lt.el.classList.add("overlay-hidden"),lt.el.style.removeProperty("pointer-events"),void 0!==lt.el.lastFocus&&(lt.el.lastFocus=void 0)}catch(Bt){console.error(Bt)}return lt.el.remove(),!0});return function(Ce,bt,kt,Ut,bn,Nn,un){return rt.apply(this,arguments)}}(),se=rt=>rt.querySelector("ion-app")||rt.body,Ee=function(){var rt=(0,d.Z)(function*(lt,Ce,bt,kt){bt.classList.remove("overlay-hidden");const bn=Ce(lt.el,kt);(!lt.animated||!v.c.getBoolean("animated",!0))&&bn.duration(0),lt.keyboardClose&&bn.beforeAddWrite(()=>{const un=bt.ownerDocument.activeElement;un?.matches("input,ion-input, ion-textarea")&&un.blur()});const Nn=oe.get(lt)||[];return oe.set(lt,[...Nn,bn]),yield bn.play(),!0});return function(Ce,bt,kt,Ut){return rt.apply(this,arguments)}}(),_t=(rt,lt)=>{let Ce;const bt=new Promise(kt=>Ce=kt);return It(rt,lt,kt=>{Ce(kt.detail)}),bt},It=(rt,lt,Ce)=>{const bt=kt=>{(0,a.b)(rt,lt,bt),Ce(kt)};(0,a.a)(rt,lt,bt)},Gt=rt=>"cancel"===rt||rt===St,Lt=rt=>rt(),yt=(rt,lt)=>{if("function"==typeof rt)return v.c.get("_zoneGate",Lt)(()=>{try{return rt(lt)}catch(bt){throw bt}})},St="backdrop",xt="gesture"},1099:(Ln,Dt,F)=>{"use strict";F.d(Dt,{B:()=>xe});var d=F(8274),v=F(6579),re=F(6895),a=F(425);function q(pe,ze){if(1&pe&&(d.TgZ(0,"ion-badge",7),d._uU(1),d.qZA()),2&pe){const ce=d.oxw().$implicit;d.xp6(1),d.hij("",ce.Quantity," x")}}function oe(pe,ze){if(1&pe&&(d.TgZ(0,"strong"),d._uU(1),d.qZA()),2&pe){const ce=d.oxw().$implicit;d.xp6(1),d.hij("",ce.PowerKW," kW ")}}function b(pe,ze){if(1&pe&&(d.TgZ(0,"div"),d._uU(1),d.qZA()),2&pe){const ce=d.oxw().$implicit;d.xp6(1),d.hij("",null==ce.CurrentType?null:ce.CurrentType.Title," ")}}function he(pe,ze){if(1&pe&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&pe){const ce=d.oxw().$implicit;d.xp6(1),d.hij("",ce.Amps,"A ")}}function Ie(pe,ze){if(1&pe&&(d.TgZ(0,"span"),d._uU(1),d.qZA()),2&pe){const ce=d.oxw().$implicit;d.xp6(1),d.hij("",ce.Voltage,"V ")}}function Ve(pe,ze){if(1&pe){const ce=d.EpF();d.TgZ(0,"ion-col")(1,"ion-button",8),d.NdJ("click",function(){d.CHM(ce);const Pe=d.oxw().$implicit,ne=d.oxw();return d.KtG(ne.editConnection(Pe))}),d._UZ(2,"ion-icon",9),d.qZA(),d._UZ(3,"br"),d.TgZ(4,"ion-button",10),d.NdJ("click",function(){d.CHM(ce);const Pe=d.oxw().$implicit,ne=d.oxw();return d.KtG(ne.deleteConnection(Pe))}),d._UZ(5,"ion-icon",11),d.qZA()()}}function K(pe,ze){if(1&pe&&(d.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-row")(3,"ion-col",1),d._UZ(4,"img",2),d.YNc(5,q,2,1,"ion-badge",3),d.TgZ(6,"div",4),d._uU(7),d.qZA()(),d.TgZ(8,"ion-col")(9,"ion-row")(10,"ion-col")(11,"ion-note")(12,"div")(13,"strong",5),d._uU(14),d.qZA()(),d.YNc(15,oe,2,1,"strong",6),d.YNc(16,b,2,1,"div",6),d.qZA(),d.TgZ(17,"ion-note"),d.YNc(18,he,2,1,"span",6),d.YNc(19,Ie,2,1,"span",6),d.qZA()()(),d.TgZ(20,"ion-row")(21,"ion-col",4),d._uU(22),d.qZA(),d.TgZ(23,"ion-col",4),d._uU(24),d.qZA()()(),d.YNc(25,Ve,6,0,"ion-col",6),d.qZA()()()),2&pe){const ce=ze.$implicit,Ke=d.oxw();d.xp6(4),d.Q6J("src",Ke.getConnectorTypeIcon(ce.ConnectionTypeID),d.LSH),d.xp6(1),d.Q6J("ngIf",ce.Quantity),d.xp6(2),d.Oqu(null==ce.StatusType?null:ce.StatusType.Title),d.xp6(6),d.s9C("title",null==ce.ConnectionType?null:ce.ConnectionType.FormalName),d.xp6(1),d.hij("",null==ce.ConnectionType?null:ce.ConnectionType.Title," "),d.xp6(1),d.Q6J("ngIf",ce.PowerKW),d.xp6(1),d.Q6J("ngIf",ce.CurrentTypeID),d.xp6(2),d.Q6J("ngIf",ce.Amps),d.xp6(1),d.Q6J("ngIf",ce.Voltage),d.xp6(3),d.Oqu(ce.Reference),d.xp6(2),d.Oqu(ce.Comments),d.xp6(1),d.Q6J("ngIf",Ke.enableEdit)}}let xe=(()=>{class pe{constructor(){this.enableEdit=!1,this.onEdit=new d.vpe,this.onDelete=new d.vpe}ngOnInit(){}editConnection(ce){this.onEdit.emit(ce)}deleteConnection(ce){this.onDelete.emit(ce)}getConnectorTypeIcon(ce){return v.c.getIconForConnector(ce)}}return pe.\u0275fac=function(ce){return new(ce||pe)},pe.\u0275cmp=d.Xpm({type:pe,selectors:[["app-equipment-details"]],inputs:{item:"item",enableEdit:"enableEdit"},outputs:{onEdit:"onEdit",onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["size","3"],[2,"max-width","64px",3,"src"],["color","primary",4,"ngIf"],[1,"info"],[3,"title"],[4,"ngIf"],["color","primary"],["size","small","color","secondary",3,"click"],["name","create","slot","icon-only"],["size","small","color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(ce,Ke){1&ce&&(d.TgZ(0,"ion-grid"),d.YNc(1,K,26,12,"ion-row",0),d.qZA()),2&ce&&(d.xp6(1),d.Q6J("ngForOf",Ke.item.Connections))},dependencies:[re.sg,re.O5,a.yp,a.YG,a.wI,a.jY,a.gu,a.uN,a.Nd]}),pe})()},2428:(Ln,Dt,F)=>{"use strict";F.d(Dt,{v:()=>xe});var d=F(5861),v=F(7689),re=F(8274),a=F(553),q=F(425),oe=F(529),b=F(6260),he=F(6895);function Ie(pe,ze){1&pe&&(re.TgZ(0,"div"),re._UZ(1,"ion-spinner"),re.qZA())}function Ve(pe,ze){if(1&pe){const ce=re.EpF();re.TgZ(0,"ion-item",5),re.NdJ("click",function(){const ne=re.CHM(ce).$implicit,Je=re.oxw(2);return re.KtG(Je.placeSelected(ne))}),re.TgZ(1,"ion-avatar",6),re._UZ(2,"ion-icon",7),re.qZA(),re.TgZ(3,"ion-label")(4,"p"),re._uU(5),re.qZA()()()}if(2&pe){const ce=ze.$implicit;re.xp6(5),re.Oqu(ce.Address)}}function K(pe,ze){if(1&pe&&(re.TgZ(0,"div",1),re.YNc(1,Ie,2,0,"div",2),re.TgZ(2,"ion-list"),re.YNc(3,Ve,6,1,"ion-item",3),re.TgZ(4,"ion-item")(5,"p",4),re._uU(6),re.qZA()()()()),2&pe){const ce=re.oxw();re.xp6(1),re.Q6J("ngIf",ce.searchInProgress),re.xp6(2),re.Q6J("ngForOf",ce.placeList),re.xp6(3),re.hij(" ",ce.placeAttribution," ")}}let xe=(()=>{class pe{constructor(ce,Ke,Pe,ne,Je){this.logging=ce,this.changeDetector=Ke,this.platform=Pe,this.http=ne,this.events=Je,this.searchInProgress=!1,this.placeSearchActive=!1,this.placeAttribution="",this.placeChanged=new re.vpe,this.searchKeyword="",this.searchInProgress=!1,this.mapService=new a.k(Je,ce,ne)}ngOnInit(){var ce=this;return(0,d.Z)(function*(){yield ce.platform.ready(),ce.mapService.initAPI()})()}onSearchFocus(){this.placeSearchFocused=!0}onSearchBlur(){this.placeSearchFocused=!1}onSearchCancel(){}getPlacesAutoComplete(ce,Ke){var Pe=this;return(0,d.Z)(function*(){Pe.placeSearchType=Ke;let ne=ce.target.value;if(ne&&ne.length>3){Pe.logging.log("Starting place lookup for:"+ne),Pe.placeSearchActive=!0,Pe.searchInProgress=!0,Pe.searchInProgress=!1,Pe.placeSearchActive=!0;try{Pe.placeList=yield Pe.mapService.placeSearch(ne),Pe.placeList&&Pe.placeList.length>0&&(Pe.placeAttribution=Pe.placeList[0].Attribution)}catch{}Pe.searchInProgress=!1,Pe.placeSearchActive=!0}else Pe.searchInProgress=!1,Pe.placeSearchActive=!1})()}placeSelected(ce){this.logging.log("Looking up place details:"+ce.Title+"::"+ce.ReferenceID),this.selectedPlace=ce,this.placeChanged.emit(ce),this.placeSearchActive=!1}}return pe.\u0275fac=function(ce){return new(ce||pe)(re.Y36(v.z),re.Y36(re.sBO),re.Y36(q.t4),re.Y36(oe.eN),re.Y36(b.z))},pe.\u0275cmp=re.Xpm({type:pe,selectors:[["place-search"]],inputs:{searchKeyword:"searchKeyword"},outputs:{selectedPlace:"selectedPlace",placeChanged:"placeChanged"},decls:1,vars:1,consts:[["class","place-search",4,"ngIf"],[1,"place-search"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"place-attribution"],[3,"click"],["item-left",""],["name","locate"]],template:function(ce,Ke){1&ce&&re.YNc(0,K,7,3,"div",0),2&ce&&re.Q6J("ngIf",Ke.placeSearchActive)},dependencies:[he.sg,he.O5,q.BJ,q.gu,q.Ie,q.Q$,q.q_,q.PQ],styles:[".place-search[_ngcontent-%COMP%]{position:absolute;z-index:1000}.place-attribution[_ngcontent-%COMP%]{font-size:9px;color:#dcdcdc;max-width:100%}"]}),pe})()},6585:(Ln,Dt,F)=>{"use strict";F.d(Dt,{o:()=>he});var d=F(8274),v=F(6579),re=F(6895),a=F(425);function q(Ie,Ve){if(1&Ie){const K=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(K);const pe=d.oxw().$implicit,ze=d.oxw();return d.KtG(ze.onCopyCommand(pe))}),d._uU(1,"Copy"),d.qZA()}}function oe(Ie,Ve){if(1&Ie){const K=d.EpF();d.TgZ(0,"ion-button",5),d.NdJ("click",function(){d.CHM(K);const pe=d.oxw().$implicit,ze=d.oxw();return d.KtG(ze.onEditCommand(pe))}),d._uU(1,"Edit"),d.qZA()}}function b(Ie,Ve){if(1&Ie&&(d.TgZ(0,"ion-item",1)(1,"ion-grid")(2,"ion-row")(3,"ion-col"),d._uU(4),d.qZA()(),d.TgZ(5,"ion-row")(6,"ion-col",2)(7,"p"),d._UZ(8,"img",3),d.qZA(),d.TgZ(9,"ion-note"),d._uU(10),d.qZA(),d.YNc(11,q,2,0,"ion-button",4),d.YNc(12,oe,2,0,"ion-button",4),d.qZA(),d.TgZ(13,"ion-col")(14,"ion-row")(15,"ion-col")(16,"p"),d._uU(17),d.qZA(),d.TgZ(18,"ion-note"),d._uU(19),d.qZA()()(),d.TgZ(20,"ion-row")(21,"ion-col"),d._uU(22),d.qZA(),d.TgZ(23,"ion-col"),d._uU(24),d.qZA()()()()()()),2&Ie){const K=Ve.$implicit,xe=d.oxw();d.xp6(4),d.hij(" ",K.AddressInfo.Title," "),d.xp6(4),d.Q6J("src",xe.getIconForPOI(K),d.LSH),d.xp6(2),d.hij(" ",xe.getFormattedDistance(K)," "),d.xp6(1),d.Q6J("ngIf",xe.enableCopyOption),d.xp6(1),d.Q6J("ngIf",xe.enableEditOption),d.xp6(5),d.hij(" ",xe.getFormattedAddress(K)," "),d.xp6(2),d.hij(" ",xe.getFormattedConnectorList(K)," "),d.xp6(3),d.hij(" ",null==K.UsageType?null:K.UsageType.Title," "),d.xp6(2),d.hij(" ",null==K.OperatorInfo?null:K.OperatorInfo.Title," ")}}let he=(()=>{class Ie{constructor(){this.enableCopyOption=!1,this.enableEditOption=!1,this.poiList=[],this.onCopy=new d.vpe,this.onEdit=new d.vpe}ngOnInit(){}onCopyCommand(K){this.onCopy.emit(K)}onEditCommand(K){this.onEdit.emit(K)}getFormattedAddress(K){let xe="";return xe+=K.AddressInfo.Title!=K.AddressInfo.AddressLine1?K.AddressInfo.Title:K.AddressInfo.Town,xe}getFormattedConnectorList(K){if(!K.Connections)return;let xe=[];for(let pe of K.Connections)null!=pe.ConnectionType&&(xe.find(ze=>ze==pe.ConnectionType.Title)||xe.push(pe.ConnectionType.Title));return xe.join(", ")}getIconForPOI(K){return v.c.getIconForPOI(K)}getFormattedDistance(K){return v.c.getFormattedDistance(K)}}return Ie.\u0275fac=function(K){return new(K||Ie)},Ie.\u0275cmp=d.Xpm({type:Ie,selectors:[["app-poi-list"]],inputs:{enableCopyOption:"enableCopyOption",enableEditOption:"enableEditOption",poiList:"poiList"},outputs:{onCopy:"onCopy",onEdit:"onEdit"},decls:2,vars:1,consts:[["style","max-width:400px;",4,"ngFor","ngForOf"],[2,"max-width","400px"],["size","3"],[2,"width","24px",3,"src"],["size","small",3,"click",4,"ngIf"],["size","small",3,"click"]],template:function(K,xe){1&K&&(d.TgZ(0,"ion-list"),d.YNc(1,b,25,9,"ion-item",0),d.qZA()),2&K&&(d.xp6(1),d.Q6J("ngForOf",xe.poiList))},dependencies:[re.sg,re.O5,a.YG,a.wI,a.jY,a.Ie,a.q_,a.uN,a.Nd]}),Ie})()},8936:(Ln,Dt,F)=>{"use strict";F.d(Dt,{e:()=>oe});var d=F(6895),v=F(425),re=F(4006),a=F(4463),q=F(8274);let oe=(()=>{class b{}return b.\u0275fac=function(Ie){return new(Ie||b)},b.\u0275mod=q.oAB({type:b}),b.\u0275inj=q.cJS({providers:[d.JJ],imports:[d.ez,v.Pc,re.u5,a.aw]}),b})()},2951:(Ln,Dt,F)=>{"use strict";F.d(Dt,{X:()=>v});var d=F(2340);class v{constructor(){this.baseURL="https://map.openchargemap.io",this.loginProviderRedirectBaseURL="https://openchargemap.org/site/loginprovider/?_mode=silent&_forceLogin=true&_redirectURL=",this.loginProviderRedirectURL=this.loginProviderRedirectBaseURL+this.baseURL,this.enableLiveMapQuerying=!0,this.googleMapsAPIKey=d.N.googleMapsKey,this.enableStaticMaps=d.N.enableStaticMaps}}},6579:(Ln,Dt,F)=>{"use strict";F.d(Dt,{c:()=>v});var d=F(2340);let v=(()=>{class re{static isFeatureEnabled(q){return!!d.N.enabledFeatures.find(oe=>oe===q)}static getClientHeight(){const q=document.body,oe=document.documentElement;return Math.max(q.scrollHeight,q.offsetHeight,oe.clientHeight,oe.scrollHeight,oe.offsetHeight)}static getClientWidth(){const q=document.body,oe=document.documentElement;return Math.max(q.scrollWidth,q.offsetWidth,oe.clientWidth,oe.scrollWidth,oe.offsetWidth)}static getMaxLevelOfPOI(q){let oe=0;if(null!=q.Connections)for(let b=0;b<q.Connections.length;b++)null!=q.Connections[b].Level&&q.Connections[b].Level.ID>oe&&(oe=q.Connections[b].Level.ID);return 4===oe&&(oe=2),oe>4&&(oe=3),oe}static getIconForPOI(q){let b="assets/images/icons/map/level"+re.getMaxLevelOfPOI(q);return null!=q.UsageType&&q.UsageType.Title.indexOf("Private")>-1?b+="_private":b+=null!=q.StatusType&&!0!==q.StatusType.IsOperational?"_nonoperational":"_operational",b+="_icon.png",b}static getColorForPOI(q){const oe=re.getMaxLevelOfPOI(q);let b="#c0c0c0";return null!=q.UsageType&&q.UsageType.Title.indexOf("Private")>-1?b="#FF0000":null!=q.StatusType&&!0!==q.StatusType.IsOperational?b="#a0a0a0":2==oe?b="#72EB0D":3==oe&&(b="#EB800D"),b}static getIconForConnector(q){let oe="assets/images/icons/connectors/";return oe+=1===q?"Type1_J1772.svg":2===q?"Chademo_type4.svg":25===q?"Type2_socket.svg":32===q?"Type1_CCS.svg":33===q?"Type2_CCS.svg":1036===q?"Type2_tethered.svg":26===q?"Type3c.svg":28===q?"schuko.svg":"Unknown.svg",oe}static getFormattedDistance(q){return q&&q.AddressInfo&&q.AddressInfo.Distance?q.AddressInfo.Distance.toFixed(1)+" "+(1===q.AddressInfo.DistanceUnit?"km":"miles"):""}static fixJSONDate(q){if(null==q)return null;if(0==q.indexOf("/")){let b=/Date\(([^)]+)\)/.exec(q);q=new Date(parseFloat(b[1]))}else q=new Date(q);return q}static formatMapLinkFromPosition(q,oe,b,he,Ie){return'<a href="https://maps.google.com/maps?saddr='+oe+","+b+"&daddr="+q.AddressInfo.Latitude+","+q.AddressInfo.Longitude+'">Map ('+Math.ceil(he)+" "+Ie+")</a>"}static formatSystemWebLink(q,oe){return"<a href='#' onclick=\"window.open('"+q+"', '_system');return false;\">"+oe+"</a>"}static formatMapLink(q,oe,b){return b?device&&"WinCE"==device.platform?this.formatSystemWebLink("maps:"+q.AddressInfo.Latitude+","+q.AddressInfo.Longitude,oe):device&&"iOS"===device.platform?this.formatSystemWebLink("https://maps.apple.com/?q="+q.AddressInfo.Latitude+","+q.AddressInfo.Longitude,oe):this.formatSystemWebLink("https://maps.google.com/maps?q="+q.AddressInfo.Latitude+","+q.AddressInfo.Longitude,oe):'<a target="_blank"  href="https://maps.google.com/maps?q='+q.AddressInfo.Latitude+","+q.AddressInfo.Longitude+'">'+oe+"</a>"}static formatURL(q,oe=null){return null==q||""==q?"":(-1==q.indexOf("http")&&(q="https://"+q),'<a target="_blank" href="'+q+'">'+(oe??q)+"</a>")}static formatString(q){return null==q?"":q.toString()}static formatTextField(q,oe=null,b=!1,he=!1,Ie=null){if(null==q||""==q||null==q)return"";let Ve=(null!=oe?"<strong class='ocm-label' "+(null!=Ie?"data-localize='"+Ie+"' ":"")+">"+oe+"</strong>: ":"")+(b?"<br/>":"")+q.toString().replace("\n","<br/>")+"<br/>";return 1==he&&(Ve="<p>"+Ve+"</p>"),Ve}static formatEmailAddress(q){return null!=q&&null!=q&&""!=q?"<i class='fa fa-envelope fa-fw'></i> <a href=\"mailto:"+q+'">'+q+"</a><br/>":""}static formatPhone(q,oe=null){return null!=q&&null!=q&&""!=q?(null==oe?oe="<i class='fa fa-phone fa-fw '></i> ":oe+=": ",oe+'<a href="tel:'+q+'">'+q+"</a><br/>"):""}static formatPOIDetails(q,oe){let he=new Date;null==oe&&(oe=!1);let Ie=this.formatPOIAddress(q,!1),Ve="";Ve+=this.formatPhone(q.AddressInfo.ContactTelephone1),Ve+=this.formatPhone(q.AddressInfo.ContactTelephone2),Ve+=this.formatEmailAddress(q.AddressInfo.ContactEmail);let K="";if(null!=q.AddressInfo.Distance){let Pe="https://maps.google.com/maps?saddr=&daddr="+q.AddressInfo.Latitude+","+q.AddressInfo.Longitude;K+="<strong id='addr_distance'><span data-localize='details.approxDistance'>Distance</span>: "+q.AddressInfo.Distance.toFixed(1)+" "+(2==q.AddressInfo.DistanceUnit?"Miles":"KM")+"</strong>",K+="<p>"+this.formatSystemWebLink(Pe,"Get Directions")+"</p>"}if(null!=q.AddressInfo.RelatedURL&&""!=q.AddressInfo.RelatedURL){let Pe=q.AddressInfo.RelatedURL;Pe=Pe.replace(/.*?:\/\//g,""),Pe.length>40&&(Pe=Pe.substr(0,40)+".."),Ve+="<i class='fa fa-fw fa-external-link'></i>  "+this.formatSystemWebLink(q.AddressInfo.RelatedURL,"<span data-localize='details.addressRelatedURL'>"+Pe+"</span>")}Ve+="</p>";const xe=this.formatTextField(q.GeneralComments,null,!1,!0)+this.formatTextField(q.AddressInfo.AccessComments,"Access",!0,!0,"details.accessComments");let pe="";null!=q.NumberOfPoints&&(pe+=this.formatTextField(q.NumberOfPoints,"Bays",!1,!0,"details.numberOfPoints")),null!=q.UsageType&&(pe+=this.formatTextField(q.UsageType.Title,"Usage",!1,!0,"details.usageType")),null!=q.UsageCost&&(pe+=this.formatTextField(q.UsageCost,"Usage Cost",!1,!0,"details.usageCost")),null!=q.OperatorInfo&&1!=q.OperatorInfo.ID&&(pe+=this.formatTextField(q.OperatorInfo.Title,"Operator",!1,!0,"details.operatorTitle"),null!=q.OperatorInfo.WebsiteURL&&(pe+=this.formatTextField(this.formatURL(q.OperatorInfo.WebsiteURL),"Operator Website",!0,!0,"details.operatorWebsite")));let ze="";if(null!=q.StatusType&&(ze+=this.formatTextField(q.StatusType.Title,"Status",!1,!0,"details.operationalStatus"),null!=q.DateLastStatusUpdate&&(ze+=this.formatTextField(Math.round((he-this.fixJSONDate(q.DateLastStatusUpdate))/864e5)+" days ago","Last Updated",!1,!0,"details.lastUpdated"))),null!=q.Connections&&q.Connections.length>0){ze+="<table class='table table-striped'>",ze+="<tr><th data-localize='details.equipment.connectionType'>Connection</th><th data-localize='details.equipment.powerLevel'>Power Level</th><th data-localize='details.operationalStatus'>Status</th></tr>";for(let Pe=0;Pe<q.Connections.length;Pe++){let ne=q.Connections[Pe];""==ne.Amps&&(ne.Amps=null),""==ne.Voltage&&(ne.Voltage=null),""==ne.Quantity&&(ne.Quantity=null),""==ne.PowerKW&&(ne.PowerKW=null),ze+="<tr><td>"+(null!=ne.ConnectionType?ne.ConnectionType.Title:"")+"</td><td>"+(null!=ne.Level?"<strong>"+ne.Level.Title+"</strong><br/>":"")+(null!=ne.Amps?this.formatString(ne.Amps)+"A/ ":"")+(null!=ne.Voltage?this.formatString(ne.Voltage)+"V/ ":"")+(null!=ne.PowerKW?this.formatString(ne.PowerKW)+"kW <br/>":"")+(null!=ne.CurrentType?ne.CurrentType.Title:"")+"<br/>"+(null!=ne.Quantity?this.formatString(ne.Quantity):"1")+" Present</td><td>"+(null!=ne.StatusType?ne.StatusType.Title:"-")+"</td></tr>"}ze+="</table>"}let ce="";return ce+=this.formatTextField("<a target='_blank' href='https://openchargemap.org/site/poi/details/"+q.ID+"'>OCM-"+q.ID+"</a>","OpenChargeMap Ref",!1,!0,"details.refNumber"),null!=q.DataProvider&&(ce+=this.formatTextField(q.DataProvider.Title,"Data Provider",!1,!0,"details.dataProviderTitle"),null!=q.DataProvider.WebsiteURL&&(ce+=this.formatTextField(this.formatURL(q.DataProvider.WebsiteURL),"Website",!1,!0,"details.dataProviderWebsite")),ce+=this.formatTextField(q.AddressInfo.Latitude,"Latitude",!1,!0,null),ce+=this.formatTextField(q.AddressInfo.Longitude,"Longitude",!1,!0,null)),{address:Ie,drivingInfo:K,contactInfo:Ve,additionalInfo:xe+pe+ze,advancedInfo:ce}}static debounce(q,oe,b){let he;return function(){let Ie=this,Ve=arguments,xe=b&&!he;clearTimeout(he),he=setTimeout(function(){he=null,b||q.apply(Ie,Ve)},oe),xe&&q.apply(Ie,Ve)}}static getRandomInt(q){return Math.floor(Math.random()*Math.floor(q))}}return re.formatPOIAddress=function(a,q=!0){let oe="";return oe=q?""+this.formatTextField(a.AddressInfo.AddressLine1)+this.formatTextField(a.AddressInfo.AddressLine2)+this.formatTextField(a.AddressInfo.Town)+this.formatTextField(a.AddressInfo.StateOrProvince)+this.formatTextField(a.AddressInfo.Postcode)+(null!=a.AddressInfo.Country?this.formatTextField(a.AddressInfo.Country.Title):""):this.formatStringArray([a.AddressInfo.AddressLine1,a.AddressInfo.AddressLine2,a.AddressInfo.Town,a.AddressInfo.StateOrProvince,a.AddressInfo.Postcode,null!=a.AddressInfo.Country?a.AddressInfo.Country.Title:""]),oe},re.formatStringArray=function(a,q=", "){if(null==a)return"";let oe="";for(let b=0;b<a.length;b++)null!=a[b]&&""!=a[b].trim()&&(oe+=b==a.length-1?a[b]:a[b]+q);return oe},re})()},4120:(Ln,Dt,F)=>{"use strict";F.d(Dt,{LL:()=>re,jR:()=>v,wC:()=>d});class d{constructor(q=null,oe=null){this.latitude=q,this.longitude=oe}}class v{constructor(q=null,oe=null){this.coords=new d,this.coords.latitude=q,this.coords.longitude=oe}static fromPosition(q){return new v(q.coords.latitude,q.coords.longitude)}}class re{constructor(q,oe){this.northEast=q,this.southWest=oe}}},129:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Qp:()=>re,fw:()=>oe,JJ:()=>he,eN:()=>b,vw:()=>q,kA:()=>a});class d{constructor(Ve,K){this.itemType=Ve,this.itemId=d.getNewItemId(),this.version=1,this.schemaVersion=K,this.syncTimeStamp=d.getNewSyncTimeStamp()}static getNewSyncTimeStamp(){return Date.now().toString()}static getNewItemId(){return"_syncitem_"+Date.now().toString()}}class v{constructor(Ve,K){this._sync=new d(Ve,K)}}class re extends v{}class a extends v{constructor(){super("waypoint",1)}}class q extends v{constructor(){super("journey_stage",1),this.WayPoints=[]}}class oe extends v{constructor(){super("journey",1),this.ID=""+Date.now(),this.Stages=[]}}class b{}class he{}},8016:(Ln,Dt,F)=>{"use strict";F.d(Dt,{b:()=>d});class d{constructor(){this.poiIdList=null,this.countryCode=null,this.latitude=null,this.longitude=null,this.locationTitle=null,this.distance=null,this.distanceUnit=null,this.connectionTypeIdList=null,this.operatorIdList=null,this.levelIdList=null,this.countryIdList=null,this.usageTypeIdList=null,this.statusTypeIdList=null,this.minPowerKW=null,this.maxPowerKW=null,this.submissionStatusTypeIdList=null,this.maxResults=500,this.additionalParams=null,this.includeComments=!1,this.compact=!0,this.enableCaching=!0,this.levelOfDetail=1,this.polyline=null,this.boundingbox=null}}},4209:(Ln,Dt,F)=>{"use strict";F.d(Dt,{n:()=>d});class d{}},7627:(Ln,Dt,F)=>{"use strict";F.d(Dt,{N:()=>v,U:()=>d});const d=650;class v{constructor(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MaxPowerKW=null,this.MinPowerKW=null,this.HasActiveFilters=!1,this.FilterOptionsByCountryId=null,this.UseDistanceInKM=!0,this.MapType="ROADMAP",this.EnableAdvancedEditorFeatures=!1}LoadSettings(){}SaveSettings(){}ClearActiveFilters(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MinPowerKW=null,this.MaxPowerKW=null}CheckForActiveFilters(){return this.HasActiveFilters=this.OperatorList.length>0||this.ConnectionTypeList.length>0||this.CountryList.length>0||this.UsageTypeList.length>0||this.StatusTypeList.length>0||this.MinPowerKW>0||this.MaxPowerKW>0||null!=this.MaxPowerKW&&this.MaxPowerKW<d,this.HasActiveFilters}}},8649:(Ln,Dt,F)=>{"use strict";F.d(Dt,{q:()=>d});var d=(()=>{return(v=d||(d={}))[v.POI=0]="POI",v[v.Comment=1]="Comment",v[v.Media=2]="Media",d;var v})()},534:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{AboutPageModule:()=>Ve});var d=F(6895),v=F(4006),re=F(425),a=F(4228),q=F(388),oe=F(8274);const b=[{path:"",component:q.t}];let he=(()=>{class K{}return K.\u0275fac=function(pe){return new(pe||K)},K.\u0275mod=oe.oAB({type:K}),K.\u0275inj=oe.cJS({imports:[a.Bz.forChild(b),a.Bz]}),K})();var Ie=F(4463);let Ve=(()=>{class K{}return K.\u0275fac=function(pe){return new(pe||K)},K.\u0275mod=oe.oAB({type:K}),K.\u0275inj=oe.cJS({imports:[d.ez,v.u5,re.Pc,Ie.aw,he]}),K})()},388:(Ln,Dt,F)=>{"use strict";F.d(Dt,{t:()=>q});var d=F(2340),v=F(8274),re=F(425),a=F(4463);let q=(()=>{class oe{constructor(he){this.modalController=he}get appVersion(){return d.N.version}get apiUrl(){return d.N.apiBase}ngOnInit(){}close(){this.modalController.dismiss()}}return oe.\u0275fac=function(he){return new(he||oe)(v.Y36(re.IN))},oe.\u0275cmp=v.Xpm({type:oe,selectors:[["app-about"]],decls:41,vars:5,consts:[[1,"ion-padding"],["size","2"],["src","assets/images/icons/branding/AppIcon_128x128.png",2,"padding-top","2em"],["href","https://openchargemap.org"],["href","https://community.openchargemap.org"],["href","https://webprofusion.com"],["slot","end"],[3,"click"],["name","close","slot","start"]],template:function(he,Ie){1&he&&(v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),v._uU(3),v.ALo(4,"translate"),v.qZA()()(),v.TgZ(5,"ion-content",0)(6,"ion-grid")(7,"ion-row")(8,"ion-col",1),v._UZ(9,"img",2),v.qZA(),v.TgZ(10,"ion-col")(11,"h1"),v._uU(12,"Open Charge Map"),v.qZA(),v.TgZ(13,"h2"),v._uU(14,"The global public registry of Electric Vehicle charging locations"),v.qZA(),v.TgZ(15,"p"),v._uU(16,"Web: "),v.TgZ(17,"a",3),v._uU(18,"https://openchargemap.org"),v.qZA()()()()(),v.TgZ(19,"p"),v._uU(20,"Community Discussions: "),v.TgZ(21,"a",4),v._uU(22,"https://community.openchargemap.org"),v.qZA()(),v.TgZ(23,"p"),v._uU(24,"App development by Webprofusion Pty Ltd ("),v.TgZ(25,"a",5),v._uU(26,"https://webprofusion.com"),v.qZA(),v._uU(27,")"),v.qZA(),v.TgZ(28,"p"),v._uU(29,"Our software is developed and hosted by volunteers, our data is largely crowdsourced by you."),v.qZA(),v.TgZ(30,"ion-note")(31,"p"),v._uU(32),v.qZA(),v.TgZ(33,"p"),v._uU(34),v.qZA()()(),v.TgZ(35,"ion-footer")(36,"ion-toolbar")(37,"ion-buttons",6)(38,"ion-button",7),v.NdJ("click",function(){return Ie.close()}),v._UZ(39,"ion-icon",8),v._uU(40," Close "),v.qZA()()()()),2&he&&(v.xp6(3),v.Oqu(v.lcZ(4,3,"ocm.general.about")),v.xp6(29),v.hij("App Version: ",Ie.appVersion,""),v.xp6(2),v.hij("API: ",Ie.apiUrl,""))},dependencies:[re.YG,re.Sm,re.wI,re.W2,re.fr,re.jY,re.Gu,re.gu,re.uN,re.Nd,re.wd,re.sr,a.X$]}),oe})()},5476:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{JourneysModule:()=>Ie});var d=F(9741),v=F(8936),re=F(4463),a=F(6895),q=F(4006),oe=F(425),b=F(4228),he=F(8274);let Ie=(()=>{class Ve{}return Ve.\u0275fac=function(xe){return new(xe||Ve)},Ve.\u0275mod=he.oAB({type:Ve}),Ve.\u0275inj=he.cJS({imports:[a.ez,q.u5,oe.Pc,re.aw,v.e,b.Bz.forChild([{path:"",component:d.g}])]}),Ve})()},9741:(Ln,Dt,F)=>{"use strict";F.d(Dt,{g:()=>Pt});var d=F(3912),v=F(7814),re=F(3855),a=F(4120),q=F(3399),oe=F(8274),b=F(425),he=F(6895);function Ie(at,ge){1&at&&(oe.TgZ(0,"p"),oe._uU(1," You have no journeys yet. Start by browsing to a charging location, then add it as Favourite to start a new Journey. "),oe.qZA())}function Ve(at,ge){if(1&at&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&at){const ke=oe.oxw(2).$implicit;oe.xp6(1),oe.hij(" ",ke.Poi.AddressInfo.AddressLine1,"")}}function K(at,ge){if(1&at&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&at){const ke=oe.oxw(2).$implicit;oe.xp6(1),oe.hij(" ",ke.Poi.AddressInfo.AddressLine2,"")}}function xe(at,ge){if(1&at&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&at){const ke=oe.oxw(2).$implicit;oe.xp6(1),oe.hij(" ",ke.Poi.AddressInfo.Town,"")}}function pe(at,ge){if(1&at&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&at){const ke=oe.oxw(2).$implicit;oe.xp6(1),oe.hij(" ",ke.Poi.AddressInfo.StateOrProvince,"")}}function ze(at,ge){if(1&at&&(oe.TgZ(0,"p"),oe._uU(1),oe.qZA()),2&at){const ke=oe.oxw(2).$implicit;oe.xp6(1),oe.hij(" ",ke.Poi.AddressInfo.Postcode,"")}}function ce(at,ge){if(1&at){const ke=oe.EpF();oe.TgZ(0,"div")(1,"div",18),oe.NdJ("click",function(){oe.CHM(ke);const we=oe.oxw().$implicit,Xe=oe.oxw(4);return oe.KtG(Xe.viewPOIDetails(we.Poi))}),oe.YNc(2,Ve,2,1,"p",4),oe.YNc(3,K,2,1,"p",4),oe.YNc(4,xe,2,1,"p",4),oe.YNc(5,pe,2,1,"p",4),oe.YNc(6,ze,2,1,"p",4),oe.qZA(),oe.TgZ(7,"ion-button",19),oe.NdJ("click",function(){oe.CHM(ke);const we=oe.oxw().$implicit,Xe=oe.oxw(4);return oe.KtG(Xe.launchNavigation(we.Poi))}),oe._UZ(8,"ion-icon",20),oe._uU(9," Navigate "),oe.qZA()()}if(2&at){const ke=oe.oxw().$implicit;oe.xp6(2),oe.Q6J("ngIf",ke.Poi.AddressInfo.AddressLine1),oe.xp6(1),oe.Q6J("ngIf",ke.Poi.AddressInfo.AddressLine2),oe.xp6(1),oe.Q6J("ngIf",ke.Poi.AddressInfo.Town),oe.xp6(1),oe.Q6J("ngIf",ke.Poi.AddressInfo.StateOrProvince),oe.xp6(1),oe.Q6J("ngIf",ke.Poi.AddressInfo.Postcode)}}function Ke(at,ge){if(1&at&&(oe.TgZ(0,"div",17),oe.YNc(1,ce,10,5,"div",4),oe.qZA()),2&at){const ke=ge.$implicit;oe.xp6(1),oe.Q6J("ngIf",ke.Poi)}}function Pe(at,ge){if(1&at&&(oe.TgZ(0,"ion-item")(1,"h2"),oe._uU(2),oe.qZA(),oe.TgZ(3,"ion-thumbnail",0),oe._UZ(4,"ion-icon",15),oe.qZA(),oe.TgZ(5,"p"),oe._uU(6),oe.qZA(),oe.YNc(7,Ke,2,1,"div",16),oe.qZA()),2&at){const ke=ge.$implicit;oe.xp6(2),oe.Oqu(ke.Title),oe.xp6(4),oe.Oqu(ke.Notes),oe.xp6(1),oe.Q6J("ngForOf",ke.PoiList)}}function ne(at,ge){if(1&at&&(oe.TgZ(0,"ion-list")(1,"ion-list-header",11),oe._uU(2),oe._UZ(3,"ion-icon",12),oe._uU(4," -- "),oe._UZ(5,"ion-icon",13),oe._uU(6," -- "),oe._UZ(7,"ion-icon",14),oe._uU(8," -- "),oe.qZA(),oe.YNc(9,Pe,8,3,"ion-item",5),oe.qZA()),2&at){const ke=ge.$implicit;oe.xp6(2),oe.hij(" ",ke.Title," "),oe.xp6(7),oe.Q6J("ngForOf",ke.WayPoints)}}function Je(at,ge){if(1&at){const ke=oe.EpF();oe.TgZ(0,"ion-card")(1,"ion-card-content")(2,"ion-toolbar",8)(3,"ion-title"),oe._uU(4),oe.qZA(),oe.TgZ(5,"ion-buttons",9)(6,"ion-button",1),oe.NdJ("click",function(){const Xe=oe.CHM(ke).$implicit,He=oe.oxw();return oe.KtG(He.deleteJourney(Xe.ID))}),oe._UZ(7,"ion-icon",10),oe.qZA()()(),oe.TgZ(8,"p"),oe._uU(9),oe.qZA(),oe.YNc(10,ne,10,2,"ion-list",5),oe.qZA()()}if(2&at){const ke=ge.$implicit;oe.xp6(4),oe.hij(" ",ke.Title,""),oe.xp6(5),oe.Oqu(ke.Notes),oe.xp6(1),oe.Q6J("ngForOf",ke.Stages)}}let Pt=(()=>{class at{constructor(ke,Le,we,Xe,He){this.appManager=ke,this.journeyManager=Le,this.api=we,this.modalController=Xe,this.alertController=He}dismiss(){this.modalController.dismiss()}discoverImages(){this.journeyManager.journeys.forEach(ke=>{ke.Stages.forEach(Le=>{Le.WayPoints.forEach(we=>{null!=we.PoiList&&we.PoiList.forEach(Xe=>{Xe.Poi&&this.api.getPanoramioLocationPhotos(new a.wC(Xe.Poi.AddressInfo.Latitude,Xe.Poi.AddressInfo.Longitude)).then(He=>{Xe.Photos=He})})})})})}getJson(ke){return JSON.stringify(ke,null,4)}viewPOIDetails(ke){this.modalController.create({component:q.H,componentProps:{item:ke}}).then(Le=>Le.present())}get staticMapSize(){return"60x60"}getStaticMapURL(ke){return"https://maps.googleapis.com/maps/api/staticmap?center="+ke.AddressInfo.Latitude+","+ke.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+ke.AddressInfo.Latitude+","+ke.AddressInfo.Longitude}deleteJourney(ke){this.alertController.create({header:"Delete this Journey?",message:"Are you sure you want to delete this Journey?",buttons:[{text:"No",handler:()=>{}},{text:"Delete",handler:()=>{this.journeyManager.deleteJourney(ke)}}]}).then(Le=>Le.present())}launchNavigation(ke){let Le="https://maps.google.com/?q="+ke.AddressInfo.Latitude+","+ke.AddressInfo.Longitude;this.appManager.platform.is("ios")&&(Le="https://maps.apple.com?q="+ke.AddressInfo.Latitude+","+ke.AddressInfo.Longitude),window.open(Le,"_system")}}return at.\u0275fac=function(ke){return new(ke||at)(oe.Y36(re.c),oe.Y36(d.i),oe.Y36(v.l),oe.Y36(b.IN),oe.Y36(b.Br))},at.\u0275cmp=oe.Xpm({type:at,selectors:[["ng-component"]],decls:18,vars:2,consts:[["slot","start"],[3,"click"],[1,"journeys-page"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","end"],["name","close","slot","start"],["primary",""],["slot","primary"],["name","close","slot","icon-only"],[2,"font-size","1.5rem"],["name","car"],["name","time"],["name","flash"],["name","caret-down",2,"font-size","4rem"],["style","text-align:right;width:100%;",4,"ngFor","ngForOf"],[2,"text-align","right","width","100%"],["tappable","",3,"click"],["clear","","item-right","",3,"click"],["name","navigate","slot","start"]],template:function(ke,Le){1&ke&&(oe.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-back-button",1),oe.NdJ("click",function(){return Le.dismiss()}),oe.qZA()(),oe.TgZ(4,"ion-title"),oe._uU(5," Journeys "),oe.qZA()()(),oe.TgZ(6,"ion-content",2)(7,"div",3)(8,"p"),oe._uU(9," You can create and plan journeys to group your favourite charging routes together. "),oe.qZA(),oe.YNc(10,Ie,2,0,"p",4),oe.qZA(),oe.YNc(11,Je,11,3,"ion-card",5),oe.qZA(),oe.TgZ(12,"ion-footer")(13,"ion-toolbar")(14,"ion-buttons",6)(15,"ion-button",1),oe.NdJ("click",function(){return Le.dismiss()}),oe._UZ(16,"ion-icon",7),oe._uU(17," Close "),oe.qZA()()()()),2&ke&&(oe.xp6(10),oe.Q6J("ngIf",null==Le.journeyManager.journeys||0==Le.journeyManager.journeys.length),oe.xp6(1),oe.Q6J("ngForOf",Le.journeyManager.journeys))},dependencies:[he.sg,he.O5,b.oU,b.YG,b.Sm,b.PM,b.FN,b.W2,b.fr,b.Gu,b.gu,b.Ie,b.q_,b.yh,b.Bs,b.wd,b.sr,b.cs],encapsulation:2}),at})()},5005:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{LayerEditorPageModule:()=>Ve});var d=F(6895),v=F(4006),re=F(425),a=F(4228),q=F(6588),oe=F(8274);const b=[{path:"",component:q.A}];let he=(()=>{class K{}return K.\u0275fac=function(pe){return new(pe||K)},K.\u0275mod=oe.oAB({type:K}),K.\u0275inj=oe.cJS({imports:[a.Bz.forChild(b),a.Bz]}),K})();var Ie=F(8936);let Ve=(()=>{class K{}return K.\u0275fac=function(pe){return new(pe||K)},K.\u0275mod=oe.oAB({type:K}),K.\u0275inj=oe.cJS({imports:[d.ez,v.u5,re.Pc,he,Ie.e]}),K})()},6588:(Ln,Dt,F)=>{"use strict";F.d(Dt,{A:()=>he});var d=F(5861),v=F(6799),re=F(8274),a=F(425),q=F(6895),oe=F(6585);function b(Ie,Ve){if(1&Ie&&(re.TgZ(0,"div"),re._uU(1),re._UZ(2,"app-poi-list",10),re.qZA()),2&Ie){const K=re.oxw();re.xp6(1),re.hij(" Items Parsed: ",K.fileData.length," "),re.xp6(1),re.Q6J("poiList",K.fileData)}}let he=(()=>{class Ie{constructor(K,xe){this.modalController=K,this.refData=xe}ngOnInit(){}previewFile(){var K=this;return(0,d.Z)(function*(){yield K.loadFile(!1)})()}cancel(){var K=this;return(0,d.Z)(function*(){yield K.modalController.dismiss(K.fileData)})()}loadFile(K=!0){var xe=this;return(0,d.Z)(function*(){const pe=new FileReader;pe.onload=()=>{let ce=JSON.parse(pe.result),Ke=5e6;for(let Pe of ce)(null==Pe.ID||""==Pe.ID)&&(Pe.ID=Ke.toString()),Pe.ID="imp_"+Pe.ID,Ke++;xe.fileData=xe.refData.hydrateCompactPOIList(ce),K&&xe.modalController.dismiss(xe.fileData)},pe.onerror=()=>{},pe.readAsText(document.getElementById("file-upload").files[0])})()}add(){var K=this;return(0,d.Z)(function*(){K.modalController.dismiss(K.fileData)})()}}return Ie.\u0275fac=function(K){return new(K||Ie)(re.Y36(a.IN),re.Y36(v.W))},Ie.\u0275cmp=re.Xpm({type:Ie,selectors:[["app-layer-editor"]],decls:27,vars:1,consts:[[1,"ion-padding"],[1,"upload"],["name","file","aria-label","file","slot","start"],["type","file","required","","id","file-upload",3,"change"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","checkmark-circle-outline","slot","end"],[3,"poiList"]],template:function(K,xe){1&K&&(re.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),re._uU(3," Edit Layer "),re.qZA()()(),re.TgZ(4,"ion-content",0)(5,"p"),re._uU(6,"POI layers are used to preview data from other Open Data sources. "),re.qZA(),re.TgZ(7,"p"),re._uU(8,"Select a POI layer JSON file: "),re.qZA(),re.TgZ(9,"div")(10,"label",1)(11,"ion-button"),re._UZ(12,"ion-icon",2),re.TgZ(13,"ion-label"),re._uU(14,"Choose File.."),re.qZA()(),re.TgZ(15,"input",3),re.NdJ("change",function(){return xe.previewFile()}),re.qZA()()(),re.YNc(16,b,3,2,"div",4),re.qZA(),re.TgZ(17,"ion-footer")(18,"ion-toolbar")(19,"ion-buttons",5)(20,"ion-button",6),re.NdJ("click",function(){return xe.cancel()}),re._UZ(21,"ion-icon",7),re._uU(22," Cancel "),re.qZA()(),re.TgZ(23,"ion-buttons",8)(24,"ion-button",6),re.NdJ("click",function(){return xe.add()}),re._uU(25," Add "),re._UZ(26,"ion-icon",9),re.qZA()()()()),2&K&&(re.xp6(16),re.Q6J("ngIf",xe.fileData&&xe.fileData.length>0))},dependencies:[q.O5,a.YG,a.Sm,a.W2,a.fr,a.Gu,a.gu,a.Q$,a.wd,a.sr,oe.o],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),Ie})()},3399:(Ln,Dt,F)=>{"use strict";F.d(Dt,{H:()=>_n});var d=F(3855),v=F(8274),re=F(425),a=F(5861),q=F(3912),oe=F(129),b=F(6895),he=F(4006);function Ie(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-select-option",13),v._uU(1),v.qZA()),2&Ue){const z=Ht.$implicit;v.Q6J("value",z.ID),v.xp6(1),v.Oqu(z.Title)}}function Ve(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-select-option",16),v._uU(1),v.qZA()),2&Ue){const z=Ht.$implicit;v.Q6J("value",Ht.index),v.xp6(1),v.Oqu(z.Title)}}function K(Ue,Ht){if(1&Ue){const z=v.EpF();v.TgZ(0,"ion-item")(1,"ion-label",2),v._uU(2,"Journey Stage"),v.qZA(),v.TgZ(3,"ion-select",3),v.NdJ("ngModelChange",function(X){v.CHM(z);const De=v.oxw();return v.KtG(De.selectedStageIndex=X)}),v.TgZ(4,"ion-select-option",14),v._uU(5,"Create a Journey Stage"),v.qZA(),v.YNc(6,Ve,2,2,"ion-select-option",15),v.qZA()()}if(2&Ue){const z=v.oxw();v.xp6(3),v.Q6J("ngModel",z.selectedStageIndex),v.xp6(3),v.Q6J("ngForOf",z.journeyManager.getJourneyStages(z.selectedJourneyID))}}function xe(Ue,Ht){if(1&Ue){const z=v.EpF();v.TgZ(0,"ion-item")(1,"ion-label",2),v._uU(2,"New Journey Name"),v.qZA(),v.TgZ(3,"ion-input",7),v.NdJ("ngModelChange",function(X){v.CHM(z);const De=v.oxw();return v.KtG(De.newJourneyName=X)}),v.qZA()()}if(2&Ue){const z=v.oxw();v.xp6(3),v.Q6J("ngModel",z.newJourneyName)}}let pe=(()=>{class Ue{constructor(z,k,X,De){this.appManager=z,this.navParams=k,this.journeyManager=X,this.modalController=De,this.poi=this.navParams.get("poi"),this.waypoint=new oe.kA,this.waypoint.Title=this.poi.AddressInfo.Title,this.waypoint.PoiIDs=[this.poi.ID],this.waypoint.PoiList=[];const Ze=new oe.Qp("charging",1);Ze.Poi=this.poi,Ze.PoiID=this.poi.ID,this.waypoint.PoiList.push(Ze),this.newJourneyName="Trip to "+this.poi.AddressInfo.Title}cancel(){this.modalController.dismiss()}add(){if(null!=this.selectedJourneyID&&""!==this.selectedJourneyID)this.journeyManager.addJourneyWaypoint(this.selectedJourneyID,this.selectedStageIndex,this.waypoint);else{const z=new oe.fw;z.ID=Date.now().toString(),""===this.newJourneyName&&(this.newJourneyName="New Journey"),z.Title=this.newJourneyName,this.journeyManager.addJourney(z,this.waypoint)}this.journeyManager.saveJourneys(),this.modalController.dismiss()}}return Ue.\u0275fac=function(z){return new(z||Ue)(v.Y36(d.c),v.Y36(re.X1),v.Y36(q.i),v.Y36(re.IN))},Ue.\u0275cmp=v.Xpm({type:Ue,selectors:[["ng-component"]],decls:39,vars:8,consts:[[1,"journeys-page","ion-padding"],[1,"banner"],["position","stacked"],[3,"ngModel","ngModelChange"],["value","","checked",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","add","slot","end"],[3,"value"],["value",""],["checked","",3,"value",4,"ngFor","ngForOf"],["checked","",3,"value"]],template:function(z,k){1&z&&(v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),v._uU(3," Edit Favourite "),v.qZA()()(),v.TgZ(4,"ion-content",0)(5,"div",1)(6,"h1"),v._uU(7),v.qZA(),v.TgZ(8,"p"),v._uU(9),v.qZA()(),v.TgZ(10,"p"),v._uU(11," Add Charging Location as a Journey Waypoint "),v.qZA(),v.TgZ(12,"ion-item")(13,"ion-label",2),v._uU(14,"Add to a Journey"),v.qZA(),v.TgZ(15,"ion-select",3),v.NdJ("ngModelChange",function(De){return k.selectedJourneyID=De}),v.TgZ(16,"ion-select-option",4),v._uU(17,"Create a New Journey"),v.qZA(),v.YNc(18,Ie,2,2,"ion-select-option",5),v.qZA()(),v.YNc(19,K,7,2,"ion-item",6),v.YNc(20,xe,4,1,"ion-item",6),v.TgZ(21,"ion-item")(22,"ion-label",2),v._uU(23,"Name for this step of your journey"),v.qZA(),v.TgZ(24,"ion-input",7),v.NdJ("ngModelChange",function(De){return k.waypoint.Title=De}),v.qZA()(),v.TgZ(25,"ion-item")(26,"ion-label",2),v._uU(27,"Other Notes"),v.qZA(),v.TgZ(28,"ion-textarea",3),v.NdJ("ngModelChange",function(De){return k.waypoint.Notes=De}),v.qZA()()(),v.TgZ(29,"ion-footer")(30,"ion-toolbar")(31,"ion-buttons",8)(32,"ion-button",9),v.NdJ("click",function(){return k.cancel()}),v._UZ(33,"ion-icon",10),v._uU(34," Cancel "),v.qZA()(),v.TgZ(35,"ion-buttons",11)(36,"ion-button",9),v.NdJ("click",function(){return k.add()}),v._uU(37," Add "),v._UZ(38,"ion-icon",12),v.qZA()()()()),2&z&&(v.xp6(7),v.Oqu(k.poi.AddressInfo.Title),v.xp6(2),v.Oqu(k.poi.AddressInfo.AddressLine1),v.xp6(6),v.Q6J("ngModel",k.selectedJourneyID),v.xp6(3),v.Q6J("ngForOf",k.journeyManager.journeys),v.xp6(1),v.Q6J("ngIf",k.selectedJourneyID),v.xp6(1),v.Q6J("ngIf",!k.selectedJourneyID),v.xp6(4),v.Q6J("ngModel",k.waypoint.Title),v.xp6(4),v.Q6J("ngModel",k.waypoint.Notes))},dependencies:[b.sg,b.O5,he.JJ,he.On,re.YG,re.Sm,re.W2,re.fr,re.Gu,re.gu,re.pK,re.Ie,re.Q$,re.t9,re.n0,re.g2,re.wd,re.sr,re.QI,re.j9],encapsulation:2}),Ue})();var ze=F(7689);function ce(Ue,Ht){if(1&Ue){const z=v.EpF();v.TgZ(0,"ion-card")(1,"ion-toolbar")(2,"ion-title",14),v._uU(3,"Preview"),v.qZA(),v.TgZ(4,"ion-buttons",15)(5,"ion-button",4),v.NdJ("click",function(){v.CHM(z);const X=v.oxw();return v.KtG(X.rotateImage())}),v._UZ(6,"ion-icon",16),v.TgZ(7,"ion-label"),v._uU(8,"Rotate"),v.qZA()()()(),v.TgZ(9,"ion-card-content")(10,"ion-list")(11,"ion-item")(12,"ion-label",17),v._uU(13,"Comment"),v.qZA(),v.TgZ(14,"ion-input",18),v.NdJ("ngModelChange",function(X){v.CHM(z);const De=v.oxw();return v.KtG(De.comment=X)}),v.qZA()()(),v._UZ(15,"img",19),v.qZA()()}if(2&Ue){const z=v.oxw();v.xp6(14),v.Q6J("ngModel",z.comment)}}let Ke=(()=>{class Ue{constructor(z,k,X,De,Ze){this.navParams=z,this.appManager=k,this.nav=X,this.modalController=De,this.logging=Ze,this.processingQuality=.8,this.targetWidth=1024,this.targetHeight=800,this.mode=k.platformMode,this.chargePointId=this.navParams.get("id"),this.poi=this.navParams.get("poi"),this.comment=""}processNativeImageSource(z){let k=z;const X=document.getElementById("img-upload-canvas"),De=X.getContext("2d"),Ze=new Image;Ze.onload=()=>{this.logging.log("img load:"+Ze.width),X.width=Ze.width,X.height=Ze.height,De.fillStyle="rgb(0,0,0)",De.fillRect(0,0,X.width,X.height),De.drawImage(Ze,0,0,X.width,X.height),this.imgData=X.toDataURL("image/png"),this.processImage()},Ze.src=k}loadCameraOrLibraryImage(z=!1){this.logging.log("PWA mode: fetching image");const k=new FileReader;k.onload=()=>{this.imgData=k.result,this.processImage()},k.onerror=()=>{},k.readAsDataURL(document.getElementById("img-upload-media").files[0])}isBrowserMode(){return this.appManager.isPlatform("desktop")||this.appManager.isPlatform("hybrid")}processImage(){if(null!=this.imgData){const k=document.getElementById("img-upload-canvas"),X=k.getContext("2d"),De=new Image;De.onload=()=>{k.width=De.width,k.height=De.height,X.fillStyle="rgb(0,0,0)",X.fillRect(0,0,k.width,k.height),X.drawImage(De,0,0,k.width,k.height),this.refreshImageFromCanvas()},De.src=this.imgData}else this.logging.log("processImage: nothing to process.")}refreshImageFromCanvas(){const z=document.getElementById("img-upload-canvas");this.imgData=z.toDataURL("image/jpeg",.8),document.getElementById("preview").src=this.imgData}rotateImage(){const z=document.getElementById("img-upload-canvas");let k=new Image;k.src=z.toDataURL(),k.onload=()=>{let X=z.height,De=z.width;z.width=X,z.height=De,X=z.height,De=z.width;const Ze=z.getContext("2d");Ze.save(),Ze.translate(De,X/De),Ze.rotate(Math.PI/2),Ze.drawImage(k,0,0),Ze.restore(),k=null,this.refreshImageFromCanvas()}}performUpload(){var z=this;return(0,a.Z)(function*(){if(!z.imgData)return void(yield z.appManager.showToastNotification("Select an image to upload."));const k={chargePointID:z.chargePointId,comment:z.comment,imageDataBase64:z.imgData};yield z.appManager.showLoadingProgress("Uploading photo..");try{yield z.appManager.submitMediaItem(k),z.appManager.dismissLoadingProgress().then(()=>{z.appManager.showToastNotification("Upload completed"),z.modalController.dismiss()}),z.appManager.analytics.appEvent("MediaUpload","Completed")}catch{yield z.appManager.dismissLoadingProgress(),yield z.appManager.showToastNotification("Upload failed, please try again."),z.appManager.analytics.appEvent("MediaUpload","Failed")}})()}cancel(){var z=this;return(0,a.Z)(function*(){yield z.modalController.dismiss()})()}}return Ue.\u0275fac=function(z){return new(z||Ue)(v.Y36(re.X1),v.Y36(d.c),v.Y36(re.SH),v.Y36(re.IN),v.Y36(ze.z))},Ue.\u0275cmp=v.Xpm({type:Ue,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"media-upload"],[1,"ion-padding"],[1,"banner"],[1,"upload"],[3,"click"],["name","camera","aria-label","camera","slot","start"],["type","file","required","","id","img-upload-media",3,"change"],["inputFile",""],["id","img-upload-canvas",2,"display","none","width","500","height","500","border","1px solid red"],[4,"ngIf"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],["slot","start"],["slot","end"],["name","refresh","slot","start"],["position","floating"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["id","preview",2,"max-width","500px"]],template:function(z,k){if(1&z){const X=v.EpF();v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),v._uU(3," Share Photo "),v.qZA()()(),v.TgZ(4,"ion-content",0)(5,"div",1)(6,"div",2)(7,"h1"),v._uU(8),v.qZA(),v.TgZ(9,"p"),v._uU(10),v.qZA()(),v.TgZ(11,"p"),v._uU(12,"You can upload a photo from your device or take a new photo: "),v.qZA(),v.TgZ(13,"div",3)(14,"ion-button",4),v.NdJ("click",function(){v.CHM(X);const Ze=v.MAs(19);return v.KtG(Ze.click())}),v._UZ(15,"ion-icon",5),v.TgZ(16,"ion-label"),v._uU(17,"Choose Photo.."),v.qZA()(),v.TgZ(18,"input",6,7),v.NdJ("change",function(){return k.loadCameraOrLibraryImage()}),v.qZA()(),v._UZ(20,"canvas",8),v.YNc(21,ce,16,1,"ion-card",9),v.qZA()(),v.TgZ(22,"ion-footer")(23,"ion-toolbar")(24,"ion-buttons",10)(25,"ion-button",4),v.NdJ("click",function(){return k.cancel()}),v._UZ(26,"ion-icon",11),v._uU(27," Cancel "),v.qZA()(),v.TgZ(28,"ion-buttons",12)(29,"ion-button",4),v.NdJ("click",function(){return k.performUpload()}),v._uU(30," Upload "),v._UZ(31,"ion-icon",13),v.qZA()()()()}2&z&&(v.xp6(8),v.Oqu(k.poi.AddressInfo.Title),v.xp6(2),v.Oqu(k.poi.AddressInfo.AddressLine1),v.xp6(11),v.Q6J("ngIf",null!=k.imgData))},dependencies:[b.O5,he.JJ,he.On,re.YG,re.Sm,re.PM,re.FN,re.W2,re.fr,re.Gu,re.gu,re.pK,re.Ie,re.Q$,re.q_,re.wd,re.sr,re.j9],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]}),Ue})();var Pe=F(4228);function ne(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-select-option",19),v._uU(1),v.qZA()),2&Ue){const z=Ht.$implicit;v.Q6J("value",z.ID),v.xp6(1),v.Oqu(z.Title)}}function Je(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-select-option",19),v._uU(1),v.qZA()),2&Ue){const z=Ht.$implicit;v.Q6J("value",z.ID),v.xp6(1),v.Oqu(z.Title)}}let Pt=(()=>{class Ue{constructor(z,k,X,De,Ze,dt,Ot,vt){this.navParams=z,this.appManager=k,this.nav=X,this.zone=De,this.loadingController=Ze,this.modalController=dt,this.logging=Ot,this.router=vt,this.commentModel={ChargePointID:this.navParams.get("id"),Comment:"",CheckinStatusTypeID:10,CommentTypeID:10,Rating:null},this.poi=this.navParams.get("poi"),this.commentTypes=k.referenceDataManager.getCommentTypes(!0,!0),this.checkinTypes=k.referenceDataManager.getCheckinStatusTypes(!0,!0)}onPageWillEnter(){}cancel(){this.modalController.dismiss()}add(){var z=this;return(0,a.Z)(function*(){const k=yield z.loadingController.create({message:"Sending .."});yield k.present(),(yield z.appManager.submitComment(z.commentModel).catch(De=>{z.appManager.showToastNotification("There was a problem submitting your comment."),z.loadingController.dismiss(),z.appManager.analytics.appEvent("Comment","Failed")}))&&(z.logging.log("Comment submitted"),yield k.dismiss(),yield z.modalController.dismiss(),z.appManager.analytics.appEvent("Comment","Submitted"))})()}}return Ue.\u0275fac=function(z){return new(z||Ue)(v.Y36(re.X1),v.Y36(d.c),v.Y36(re.SH),v.Y36(v.R0b),v.Y36(re.HT),v.Y36(re.IN),v.Y36(ze.z),v.Y36(Pe.F0))},Ue.\u0275cmp=v.Xpm({type:Ue,selectors:[["ng-component"]],decls:53,vars:8,consts:[["color","primary"],[1,"comment-page","ion-padding"],[1,"banner"],[1,"ion-padding"],["position","stacked"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["value","5"],["value","4"],["value","3"],["value","2"],["value","1"],["value",""],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],[3,"value"]],template:function(z,k){1&z&&(v.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),v._uU(3," Add Comment "),v.qZA()()(),v.TgZ(4,"ion-content",1)(5,"div",2)(6,"h1"),v._uU(7),v.qZA(),v.TgZ(8,"p"),v._uU(9),v.qZA()(),v.TgZ(10,"p",3),v._uU(11,"Recent Check-ins are a big help to other drivers when planning their journey. Tell everyone what you thought about this charging location. "),v.qZA(),v.TgZ(12,"ion-list")(13,"ion-item")(14,"ion-label",4),v._uU(15,"Comment Type"),v.qZA(),v.TgZ(16,"ion-select",5),v.NdJ("ngModelChange",function(De){return k.commentModel.CommentTypeID=De}),v.YNc(17,ne,2,2,"ion-select-option",6),v.qZA()(),v.TgZ(18,"ion-item")(19,"ion-label",4),v._uU(20,"What Did You Think?"),v.qZA(),v.TgZ(21,"ion-input",7),v.NdJ("ngModelChange",function(De){return k.commentModel.Comment=De}),v.qZA()(),v.TgZ(22,"ion-item")(23,"ion-label",4),v._uU(24,"Did You Successfully Charge?"),v.qZA(),v.TgZ(25,"ion-select",5),v.NdJ("ngModelChange",function(De){return k.commentModel.CheckinStatusTypeID=De}),v.YNc(26,Je,2,2,"ion-select-option",6),v.qZA()(),v.TgZ(27,"ion-item")(28,"ion-label",4),v._uU(29,"Your Rating"),v.qZA(),v.TgZ(30,"ion-select",5),v.NdJ("ngModelChange",function(De){return k.commentModel.Rating=De}),v.TgZ(31,"ion-select-option",8),v._uU(32,"5 - Excellent"),v.qZA(),v.TgZ(33,"ion-select-option",9),v._uU(34,"4 - Good"),v.qZA(),v.TgZ(35,"ion-select-option",10),v._uU(36,"3 - Average"),v.qZA(),v.TgZ(37,"ion-select-option",11),v._uU(38,"2 - Not Good"),v.qZA(),v.TgZ(39,"ion-select-option",12),v._uU(40,"1 - Bad"),v.qZA(),v.TgZ(41,"ion-select-option",13),v._uU(42,"Not Rated"),v.qZA()()()()(),v.TgZ(43,"ion-footer")(44,"ion-toolbar")(45,"ion-buttons",14)(46,"ion-button",15),v.NdJ("click",function(){return k.cancel()}),v._UZ(47,"ion-icon",16),v._uU(48," Cancel "),v.qZA()(),v.TgZ(49,"ion-buttons",17)(50,"ion-button",15),v.NdJ("click",function(){return k.add()}),v._uU(51," Submit "),v._UZ(52,"ion-icon",18),v.qZA()()()()),2&z&&(v.xp6(7),v.Oqu(k.poi.AddressInfo.Title),v.xp6(2),v.Oqu(k.poi.AddressInfo.AddressLine1),v.xp6(7),v.Q6J("ngModel",k.commentModel.CommentTypeID),v.xp6(1),v.Q6J("ngForOf",k.commentTypes),v.xp6(4),v.Q6J("ngModel",k.commentModel.Comment),v.xp6(4),v.Q6J("ngModel",k.commentModel.CheckinStatusTypeID),v.xp6(1),v.Q6J("ngForOf",k.checkinTypes),v.xp6(4),v.Q6J("ngModel",k.commentModel.Rating))},dependencies:[b.sg,he.JJ,he.On,re.YG,re.Sm,re.W2,re.fr,re.Gu,re.gu,re.pK,re.Ie,re.Q$,re.q_,re.t9,re.n0,re.wd,re.sr,re.QI,re.j9],encapsulation:2}),Ue})();var at=F(2951),ge=F(9698),ke=F(9492),Le=F(4508),we=F(6579),Xe=F(4463),He=F(1099);function me(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div")(1,"small"),v._uU(2),v.qZA()()),2&Ue){const z=v.oxw(2);v.xp6(2),v.Oqu(z.connectionSummary)}}function de(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div")(1,"small"),v._uU(2),v.qZA()()),2&Ue){const z=v.oxw(2);v.xp6(2),v.Oqu(z.poi.OperatorInfo.Title)}}function se(Ue,Ht){if(1&Ue){const z=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",28),v.NdJ("click",function(){v.CHM(z);const X=v.oxw(2);return v.KtG(X.addFavourite())}),v._UZ(2,"ion-icon",29),v.TgZ(3,"ion-label"),v._uU(4,"Favourite"),v.qZA()(),v.TgZ(5,"ion-button",13),v.NdJ("click",function(){v.CHM(z);const X=v.oxw(2);return v.KtG(X.edit())}),v._UZ(6,"ion-icon",30),v.TgZ(7,"ion-label"),v._uU(8,"Edit"),v.qZA()(),v.BQk()}}function Ee(Ue,Ht){if(1&Ue){const z=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",31),v.NdJ("click",function(){v.CHM(z);const X=v.oxw(2);return v.KtG(X.launchNavigation())}),v._UZ(2,"ion-icon",32),v.TgZ(3,"ion-label"),v._uU(4,"Navigate"),v.qZA()(),v.BQk()}}function _t(Ue,Ht){if(1&Ue){const z=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",33),v.NdJ("click",function(){v.CHM(z);const X=v.oxw(2);return v.KtG(X.addComment())}),v._UZ(2,"ion-icon",34),v.TgZ(3,"ion-label"),v._uU(4,"Add Comment"),v.qZA()(),v.BQk()}}function It(Ue,Ht){if(1&Ue){const z=v.EpF();v.ynx(0),v.TgZ(1,"ion-button",35),v.NdJ("click",function(){v.CHM(z);const X=v.oxw(2);return v.KtG(X.addMedia())}),v._UZ(2,"ion-icon",36),v.TgZ(3,"ion-label"),v._uU(4," Add Photo"),v.qZA()(),v.BQk()}}function Gt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(1),v.hij(" ",z.poi.AddressInfo.AddressLine1,"")}}function Lt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(1),v.hij(" ",z.poi.AddressInfo.AddressLine2,"")}}function yt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(1),v.hij(" ",z.poi.AddressInfo.Town,"")}}function St(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(1),v.hij(" ",z.poi.AddressInfo.StateOrProvince,"")}}function xt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(1),v.hij(" ",z.poi.AddressInfo.Postcode,"")}}function rt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(1),v.hij(" ",z.poi.AddressInfo.Country.Title,"")}}function lt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(1),v.hij(" ",z.poi.AddressInfo.AccessComments," ")}}function Ce(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",48),v.TgZ(2,"span",45),v._uU(3),v.qZA()()),2&Ue){const z=v.oxw(4);v.xp6(3),v.Oqu(z.poi.AddressInfo.ContactTelephone1)}}function bt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",48),v.TgZ(2,"span",45),v._uU(3),v.qZA()()),2&Ue){const z=v.oxw(4);v.xp6(3),v.Oqu(z.poi.AddressInfo.ContactTelephone2)}}function kt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",49),v.TgZ(2,"span",45),v._uU(3),v.qZA()()),2&Ue){const z=v.oxw(4);v.xp6(3),v.Oqu(z.poi.AddressInfo.ContactEmail)}}function Ut(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",50),v.TgZ(2,"span",45)(3,"a",51),v._uU(4),v.qZA()()()),2&Ue){const z=v.oxw(4);v.xp6(3),v.s9C("href",z.poi.AddressInfo.RelatedURL,v.LSH),v.xp6(1),v.Oqu(z.poi.AddressInfo.RelatedURL)}}function bn(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-card")(1,"ion-card-header"),v._UZ(2,"ion-icon",43),v._uU(3),v.ALo(4,"translate"),v.qZA(),v.TgZ(5,"ion-card-content")(6,"ion-grid")(7,"ion-row")(8,"ion-col")(9,"ion-label",44),v._uU(10),v.ALo(11,"translate"),v.qZA(),v.TgZ(12,"div",45),v.YNc(13,Gt,2,1,"div",0),v.YNc(14,Lt,2,1,"div",0),v.YNc(15,yt,2,1,"div",0),v.YNc(16,St,2,1,"div",0),v.YNc(17,xt,2,1,"div",0),v.YNc(18,rt,2,1,"div",0),v.qZA()(),v.TgZ(19,"ion-col"),v.YNc(20,lt,2,1,"p",0),v.YNc(21,Ce,4,1,"p",0),v.YNc(22,bt,4,1,"p",0),v.YNc(23,kt,4,1,"p",0),v.YNc(24,Ut,5,2,"p",0),v.qZA()(),v.TgZ(25,"ion-row")(26,"ion-col"),v._UZ(27,"ion-icon",46),v.TgZ(28,"ion-label",47),v._uU(29),v.ALo(30,"number"),v.ALo(31,"number"),v.qZA()()()()()()),2&Ue){const z=v.oxw(3);v.xp6(3),v.hij(" ",v.lcZ(4,15,"ocm.details.location.sectionTitle")," "),v.xp6(7),v.hij(" ",v.lcZ(11,17,"ocm.details.location.address"),""),v.xp6(3),v.Q6J("ngIf",z.poi.AddressInfo.AddressLine1),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.AddressLine2),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.Town),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.StateOrProvince),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.Postcode),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.Country),v.xp6(2),v.Q6J("ngIf",z.poi.AddressInfo.AccessComments),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.ContactTelephone1),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.ContactTelephone2),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.ContactEmail),v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo.RelatedURL),v.xp6(5),v.AsE(" ",v.xi3(30,19,z.poi.AddressInfo.Latitude,"1.1-13")," , ",v.xi3(31,22,z.poi.AddressInfo.Longitude,"1.1-13")," ")}}function Nn(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&Ue){const z=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.numberOfPoints"),":"),v.xp6(3),v.Oqu(z.poi.NumberOfPoints)}}function un(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&Ue){const z=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.operationalStatus"),":"),v.xp6(3),v.hij(" ",z.poi.StatusType.Title," ")}}function ot(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&Ue){const z=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.usageType"),":"),v.xp6(3),v.Oqu(z.poi.UsageType.Title)}}function Bt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p")(1,"span",44),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"span",45),v._uU(5),v.qZA()()),2&Ue){const z=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.usageCost"),":"),v.xp6(3),v.hij(" ",z.poi.UsageCost,"")}}function Sn(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"br"),v._uU(2),v.ALo(3,"translate"),v._UZ(4,"br"),v.TgZ(5,"span",45),v._uU(6),v.qZA()()),2&Ue){const z=v.oxw(3);v.xp6(2),v.hij("",v.lcZ(3,2,"ocm.details.generalComments"),": "),v.xp6(4),v.Oqu(z.poi.GeneralComments)}}function Qn(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",54),v._uU(2),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(2),v.hij(" ",z.poi.OperatorInfo.WebsiteURL," ")}}function ci(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",49),v._uU(2),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(2),v.hij(" ",z.poi.OperatorInfo.ContactEmail," ")}}function Un(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v._UZ(1,"ion-icon",49),v._uU(2),v.qZA()),2&Ue){const z=v.oxw(4);v.xp6(2),v.hij(" ",z.poi.OperatorInfo.FaultReportEmail," ")}}function hi(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-card")(1,"ion-card-header"),v._UZ(2,"ion-icon",52),v._uU(3),v.ALo(4,"translate"),v.qZA(),v.TgZ(5,"ion-card-content")(6,"div",45)(7,"p",53),v._uU(8),v.qZA(),v.YNc(9,Qn,3,1,"p",0),v.YNc(10,ci,3,1,"p",0),v.YNc(11,Un,3,1,"p",0),v.qZA()()()),2&Ue){const z=v.oxw(3);v.xp6(3),v.hij(" ",v.lcZ(4,5,"ocm.details.operator.sectionTitle")," "),v.xp6(5),v.hij(" ",z.poi.OperatorInfo.Title," "),v.xp6(1),v.Q6J("ngIf",z.poi.OperatorInfo.WebsiteURL),v.xp6(1),v.Q6J("ngIf",null!=z.poi.OperatorInfo.ContactEmail),v.xp6(1),v.Q6J("ngIf",null!=z.poi.OperatorInfo.FaultReportEmail&&z.poi.OperatorInfo.FaultReportEmail!=z.poi.OperatorInfo.ContactEmail)}}function Ii(Ue,Ht){if(1&Ue){const z=v.EpF();v.TgZ(0,"a",56),v.NdJ("click",function(){v.CHM(z);const X=v.oxw(4);return v.KtG(X.launchURL(X.poi.DataProvider.WebsiteURL))}),v._uU(1),v.qZA()}if(2&Ue){const z=v.oxw(4);v.xp6(1),v.Oqu(z.poi.DataProvider.WebsiteURL)}}function yi(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div",45)(1,"h3"),v._uU(2),v.ALo(3,"translate"),v.qZA(),v.TgZ(4,"p"),v._uU(5),v.qZA(),v.YNc(6,Ii,2,1,"a",55),v.TgZ(7,"p"),v._uU(8),v.qZA()()),2&Ue){const z=v.oxw(3);v.xp6(2),v.hij(" ",v.lcZ(3,4,"ocm.details.dataProvider.sectionTitle")," "),v.xp6(3),v.Oqu(null==z.poi.DataProvider?null:z.poi.DataProvider.Title),v.xp6(1),v.Q6J("ngIf",z.poi.DataProvider.WebsiteURL),v.xp6(2),v.Oqu(null==z.poi.DataProvider?null:z.poi.DataProvider.License)}}function Bi(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div",37),v.YNc(1,bn,32,25,"ion-card",0),v.TgZ(2,"ion-card")(3,"ion-card-header"),v._UZ(4,"ion-icon",38),v._uU(5),v.ALo(6,"translate"),v.qZA(),v.TgZ(7,"ion-card-content"),v.YNc(8,Nn,6,4,"p",0),v._UZ(9,"app-equipment-details",39),v.qZA()(),v.TgZ(10,"ion-card")(11,"ion-card-header"),v._UZ(12,"ion-icon",40),v._uU(13," Usage Restrictions "),v.qZA(),v.TgZ(14,"ion-card-content"),v.YNc(15,un,6,4,"p",0),v.YNc(16,ot,6,4,"p",0),v.YNc(17,Bt,6,4,"p",0),v.YNc(18,Sn,7,4,"p",0),v.qZA()(),v.YNc(19,hi,12,7,"ion-card",0),v.TgZ(20,"ion-card")(21,"ion-card-header"),v._UZ(22,"ion-icon",41),v._uU(23),v.ALo(24,"translate"),v.qZA(),v.TgZ(25,"ion-card-content"),v.YNc(26,yi,9,6,"div",42),v.qZA()()()),2&Ue){const z=v.oxw(2);v.xp6(1),v.Q6J("ngIf",z.poi.AddressInfo),v.xp6(4),v.hij(" ",v.lcZ(6,11,"ocm.details.equipment.sectionTitle")," "),v.xp6(3),v.Q6J("ngIf",null!=z.poi.NumberOfPoints),v.xp6(1),v.Q6J("item",z.poi),v.xp6(6),v.Q6J("ngIf",null!=z.poi.StatusType),v.xp6(1),v.Q6J("ngIf",null!=z.poi.UsageType),v.xp6(1),v.Q6J("ngIf",null!=z.poi.UsageCost),v.xp6(1),v.Q6J("ngIf",null!=z.poi.GeneralComments),v.xp6(1),v.Q6J("ngIf",z.poi.OperatorInfo),v.xp6(4),v.hij(" ",v.lcZ(24,13,"ocm.details.advancedDetails")," "),v.xp6(3),v.Q6J("ngIf",z.poi.DataProvider)}}function Mi(Ue,Ht){if(1&Ue&&v._UZ(0,"img",60),2&Ue){const z=v.oxw().$implicit;v.s9C("src",null==z.User?null:z.User.ProfileImageURL,v.LSH)}}function Ni(Ue,Ht){if(1&Ue&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw().$implicit;v.xp6(1),v.Oqu(z.User.Username)}}function Ki(Ue,Ht){if(1&Ue&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw().$implicit;v.xp6(1),v.Oqu(z.Username)}}function Vt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p",45),v._uU(1),v.qZA()),2&Ue){const z=v.oxw().$implicit;v.xp6(1),v.hij(" ",null==z.CommentType?null:z.CommentType.Title," ")}}function Mt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p")(1,"span",44),v._uU(2,"Rating:"),v.qZA(),v.TgZ(3,"span",45),v._uU(4),v.qZA()()),2&Ue){const z=v.oxw().$implicit;v.xp6(4),v.hij("",z.Rating," out of 5")}}function Ge(Ue,Ht){1&Ue&&(v.ynx(0),v._UZ(1,"ion-icon",61),v.BQk())}function ie(Ue,Ht){1&Ue&&(v.ynx(0),v._UZ(1,"ion-icon",62),v.BQk())}function Qe(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p"),v.YNc(1,Ge,2,0,"ng-container",0),v.YNc(2,ie,2,0,"ng-container",0),v._uU(3),v.qZA()),2&Ue){const z=v.oxw().$implicit;v.xp6(1),v.Q6J("ngIf",!0===z.CheckinStatusType.IsPositive),v.xp6(1),v.Q6J("ngIf",!1===z.CheckinStatusType.IsPositive),v.xp6(1),v.hij(" ",z.CheckinStatusType.Title," ")}}function Wt(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-card")(1,"ion-item")(2,"ion-avatar",19),v.YNc(3,Mi,1,1,"img",59),v.qZA(),v.TgZ(4,"ion-label"),v.YNc(5,Ni,2,1,"span",0),v.YNc(6,Ki,2,1,"span",0),v.qZA(),v.TgZ(7,"ion-label",20),v._uU(8),v.ALo(9,"date"),v.qZA()(),v.TgZ(10,"ion-card-content")(11,"p"),v._uU(12),v.qZA(),v.YNc(13,Vt,2,1,"p",42),v.YNc(14,Mt,5,1,"p",0),v.YNc(15,Qe,4,3,"p",0),v.qZA()()),2&Ue){const z=Ht.$implicit;v.xp6(3),v.Q6J("ngIf",z.User&&z.User.ProfileImageURL),v.xp6(2),v.Q6J("ngIf",z.User),v.xp6(1),v.Q6J("ngIf",!z.User),v.xp6(2),v.hij(" ",v.lcZ(9,8,z.DateCreated)," "),v.xp6(4),v.Oqu(z.Comment),v.xp6(1),v.Q6J("ngIf",10!=z.CommentTypeID),v.xp6(1),v.Q6J("ngIf",z.Rating),v.xp6(1),v.Q6J("ngIf",z.CheckinStatusType)}}function rn(Ue,Ht){if(1&Ue&&(v.ynx(0),v.YNc(1,Wt,16,10,"ion-card",58),v.BQk()),2&Ue){const z=v.oxw(3);v.xp6(1),v.Q6J("ngForOf",z.poi.UserComments)}}function oi(Ue,Ht){1&Ue&&(v.TgZ(0,"p",21),v._uU(1),v.ALo(2,"translate"),v.qZA()),2&Ue&&(v.xp6(1),v.hij(" ",v.lcZ(2,1,"ocm.details.commentsAndRatings.zeroComments")," "))}function Di(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v.YNc(1,rn,2,1,"ng-container",0),v.YNc(2,oi,3,3,"p",57),v.qZA()),2&Ue){const z=v.oxw(2);v.xp6(1),v.Q6J("ngIf",1==z.poi._hasComments),v.xp6(1),v.Q6J("ngIf",0==z.poi._hasComments)}}function ar(Ue,Ht){if(1&Ue&&v._UZ(0,"img",60),2&Ue){const z=v.oxw().$implicit;v.s9C("src",null==z.User?null:z.User.ProfileImageURL,v.LSH)}}function pi(Ue,Ht){if(1&Ue&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw().$implicit;v.xp6(1),v.Oqu(z.User.Username)}}function mr(Ue,Ht){if(1&Ue&&(v.TgZ(0,"span"),v._uU(1),v.qZA()),2&Ue){const z=v.oxw().$implicit;v.xp6(1),v.Oqu(z.Username)}}function Si(Ue,Ht){if(1&Ue&&(v.TgZ(0,"ion-card"),v._UZ(1,"img",60),v.TgZ(2,"ion-item")(3,"ion-avatar",19),v.YNc(4,ar,1,1,"img",59),v.qZA(),v.TgZ(5,"ion-label"),v.YNc(6,pi,2,1,"span",0),v.YNc(7,mr,2,1,"span",0),v.qZA(),v.TgZ(8,"ion-label",20),v._uU(9),v.ALo(10,"date"),v.qZA()(),v.TgZ(11,"ion-card-content")(12,"p"),v._uU(13),v.qZA()()()),2&Ue){const z=Ht.$implicit;v.xp6(1),v.s9C("src",z.ItemMediumURL,v.LSH),v.xp6(3),v.Q6J("ngIf",z.User&&z.User.ProfileImageURL),v.xp6(2),v.Q6J("ngIf",z.User),v.xp6(1),v.Q6J("ngIf",!z.User),v.xp6(2),v.hij(" ",v.lcZ(10,6,z.DateCreated)," "),v.xp6(4),v.Oqu(z.Comment)}}function vr(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v.YNc(1,Si,14,8,"ion-card",58),v.qZA()),2&Ue){const z=v.oxw(3);v.xp6(1),v.Q6J("ngForOf",z.poi.MediaItems)}}function xr(Ue,Ht){1&Ue&&(v.TgZ(0,"div",21)(1,"p",63),v._uU(2),v.ALo(3,"translate"),v.qZA()()),2&Ue&&(v.xp6(2),v.hij(" ",v.lcZ(3,1,"ocm.details.mediaItems.addPrompt"),""))}function gr(Ue,Ht){if(1&Ue&&(v.TgZ(0,"div"),v.YNc(1,vr,2,1,"div",0),v.YNc(2,xr,4,3,"div",57),v.qZA()),2&Ue){const z=v.oxw(2);v.xp6(1),v.Q6J("ngIf",z.poi._hasPhotos),v.xp6(1),v.Q6J("ngIf",!z.poi._hasPhotos)}}function ui(Ue,Ht){if(1&Ue&&(v.TgZ(0,"p",64),v._uU(1),v.qZA()),2&Ue){const z=v.oxw(2);v.xp6(1),v.hij(" ",z.json,"")}}function pn(Ue,Ht){if(1&Ue){const z=v.EpF();v.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"h2"),v._uU(4),v.qZA(),v.TgZ(5,"div")(6,"small"),v._uU(7),v.qZA()(),v.YNc(8,me,3,1,"div",0),v.YNc(9,de,3,1,"div",0),v.TgZ(10,"ion-badge",3),v._uU(11),v.ALo(12,"number"),v.qZA()(),v.TgZ(13,"ion-fab",4)(14,"ion-fab-button"),v._UZ(15,"ion-icon",5),v.qZA(),v.TgZ(16,"ion-fab-list",6)(17,"ion-fab-button",7),v.NdJ("click",function(){v.CHM(z);const X=v.oxw();return v.KtG(X.addComment())}),v._UZ(18,"ion-icon",8),v.qZA(),v.TgZ(19,"ion-fab-button",9),v.NdJ("click",function(){v.CHM(z);const X=v.oxw();return v.KtG(X.addMedia())}),v._UZ(20,"ion-icon",10),v.qZA(),v.TgZ(21,"ion-fab-button",11),v.NdJ("click",function(){v.CHM(z);const X=v.oxw();return v.KtG(X.addFavourite())}),v._UZ(22,"ion-icon",12),v.qZA(),v.TgZ(23,"ion-fab-button",13),v.NdJ("click",function(){v.CHM(z);const X=v.oxw();return v.KtG(X.edit())}),v._UZ(24,"ion-icon",14),v.qZA(),v.TgZ(25,"ion-fab-button",15),v.NdJ("click",function(){v.CHM(z);const X=v.oxw();return v.KtG(X.refresh())}),v._UZ(26,"ion-icon",16),v.qZA()()()(),v.TgZ(27,"ion-refresher",17),v.NdJ("ionRefresh",function(X){v.CHM(z);const De=v.oxw();return v.KtG(De.refresh(X))}),v._UZ(28,"ion-refresher-content",18),v.qZA(),v.TgZ(29,"ion-toolbar")(30,"ion-buttons",19),v.YNc(31,se,9,0,"ng-container",0),v.qZA(),v.TgZ(32,"ion-buttons",20),v.YNc(33,Ee,5,0,"ng-container",0),v.YNc(34,_t,5,0,"ng-container",0),v.YNc(35,It,5,0,"ng-container",0),v.qZA()(),v.TgZ(36,"div",21)(37,"ion-segment",22),v.NdJ("ngModelChange",function(X){v.CHM(z);const De=v.oxw();return v.KtG(De.selectedTab=X)}),v.TgZ(38,"ion-segment-button",23)(39,"ion-label"),v._uU(40," Details "),v.qZA()(),v.TgZ(41,"ion-segment-button",24)(42,"ion-label"),v._uU(43),v.qZA()(),v.TgZ(44,"ion-segment-button",25)(45,"ion-label"),v._uU(46),v.qZA()()()(),v.YNc(47,Bi,27,15,"div",26),v.YNc(48,Di,3,2,"div",0),v.YNc(49,gr,3,2,"div",0),v.YNc(50,ui,2,1,"p",27),v.qZA()}if(2&Ue){const z=v.oxw();v.xp6(1),v.Udp("background-image",z.backdropImage?"url("+z.backdropImage+")":""),v.xp6(3),v.hij(" ",z.poi.AddressInfo.Title," "),v.xp6(3),v.hij("OCM-",z.poi.ID,""),v.xp6(1),v.Q6J("ngIf",z.connectionSummary),v.xp6(1),v.Q6J("ngIf",z.poi.OperatorInfo),v.xp6(2),v.Oqu(v.xi3(12,18,z.avgRating,"1.1-1")),v.xp6(20),v.Q6J("ngIf","location"==z.selectedTab),v.xp6(2),v.Q6J("ngIf","location"==z.selectedTab),v.xp6(1),v.Q6J("ngIf","comments"==z.selectedTab),v.xp6(1),v.Q6J("ngIf","media"==z.selectedTab),v.xp6(2),v.Q6J("ngModel",z.selectedTab),v.xp6(6),v.hij("Comments (",z.poi.UserComments?z.poi.UserComments.length:0,")"),v.xp6(3),v.hij(" Photos (",z.poi.MediaItems?z.poi.MediaItems.length:0,")"),v.xp6(1),v.Q6J("ngIf","location"==z.selectedTab),v.xp6(1),v.Q6J("ngIf","comments"==z.selectedTab),v.xp6(1),v.Q6J("ngIf","media"==z.selectedTab),v.xp6(1),v.Q6J("ngIf",1==z.appManager.isDebugMode)}}function wt(Ue,Ht){1&Ue&&(v.TgZ(0,"div")(1,"h2"),v._uU(2,"POI Not Found"),v.qZA(),v.TgZ(3,"p"),v._uU(4,"The POI details could not be loaded."),v.qZA()())}let Rt=(()=>{class Ue{constructor(z,k,X,De,Ze,dt,Ot,vt){this.appManager=z,this.nav=k,this.translate=X,this.logging=De,this.modalController=Ze,this.actionSheetController=dt,this.poiManager=Ot,this.router=vt,this.hasNavBar=!1}ngOnChanges(z){if(this.logging.log("In ngOnChanges of POI Details"),null!=this.poi&&null!=this.poi.AddressInfo){if(this.selectedTab="location",null!=this.poi.MediaItems&&this.poi.MediaItems.length>0){this.poi._hasPhotos=!0;for(let k of this.poi.MediaItems)k.ItemMediumURL=k.ItemThumbnailURL.replace(".thmb.",".medi.");this.backdropImage=this.poi.MediaItems[this.poi.MediaItems.length-1].ItemThumbnailURL.replace(".thmb.",".medi.")}else this.poi._hasPhotos=!1,this.backdropImage=null;if(null!=this.poi.UserComments&&this.poi.UserComments.length>0){this.poi._hasComments=!0;try{let k=this.poi.UserComments.filter(X=>X.Rating>0);if(k.length>0){let X=0;for(let De of k)X+=De.Rating;this.avgRating=X/k.length}else this.avgRating=null}catch{}}else this.poi._hasComments=!1;if(this.poi.Connections&&this.poi.Connections.length>0){let k="";for(let X of this.poi.Connections)-1==k.indexOf(X.ConnectionType.Title)&&(k+=(""!=k?", ":"")+X.ConnectionType.Title);this.connectionSummary=k}}}ngOnInit(){this.logging.log("In ngInit of POI Details")}get staticMapURL(){return"https://maps.googleapis.com/maps/api/staticmap?key="+(new at.X).googleMapsAPIKey+"&center="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude}get staticMapSize(){return 0===this.appManager.clientWidth?"240x100":this.appManager.clientWidth>=800?"640x100":this.appManager.clientWidth>=400?"400x100":"240x100"}continueAddComment(){var z=this;return(0,a.Z)(function*(){const k=yield z.modalController.create({component:Pt,componentProps:{id:z.poi.ID,poi:z.poi}});setTimeout(()=>{z.refresh()},1e3),yield k.present()})()}addComment(){var z=this;return(0,a.Z)(function*(){if(z.appManager.isUserAuthenticated(!0))yield z.continueAddComment();else{const k=yield z.modalController.create({component:ke.F});k.onDidDismiss().then((0,a.Z)(function*(){z.appManager.isUserAuthenticated(!0)&&(yield z.continueAddComment())})),yield k.present()}})()}continueAddMedia(){var z=this;return(0,a.Z)(function*(){const k=yield z.modalController.create({component:Ke,componentProps:{id:z.poi.ID,poi:z.poi}});k.onDidDismiss().then(()=>{setTimeout(()=>{z.refresh()},1e3)}),yield k.present()})()}addMedia(){var z=this;return(0,a.Z)(function*(){if(z.appManager.isUserAuthenticated(!0))yield z.continueAddMedia();else{const k=yield z.modalController.create({component:ke.F});k.onDidDismiss().then((0,a.Z)(function*(){z.appManager.isUserAuthenticated(!0)&&(yield z.continueAddMedia())})),yield k.present()}})()}addFavourite(){var z=this;return(0,a.Z)(function*(){yield(yield z.actionSheetController.create({header:"Add Favourite",buttons:[{text:"Add to Journey",handler:()=>{z.modalController.create({component:pe,componentProps:{poi:z.poi}}).then(X=>X.present())}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}launchNavigation(){this.appManager.isPlatform("ios")?this.appManager.launchWebPage("https://maps.apple.com/?ll="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude):this.appManager.launchWebPage("https://maps.google.com/?q="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude)}launchURL(z){this.appManager.launchWebPage(z)}continueEdit(){var z=this;return(0,a.Z)(function*(){const k=yield z.modalController.create({component:Le.Y,componentProps:{id:z.poi.ID}});return k.onDidDismiss().then(X=>{z.refresh()}),yield k.present()})()}edit(){var z=this;return(0,a.Z)(function*(){if(we.c.isFeatureEnabled("EDIT_POI"))if(z.appManager.isUserAuthenticated(!0))yield z.continueEdit();else{const k=yield z.modalController.create({component:ke.F});k.onDidDismiss().then((0,a.Z)(function*(){z.appManager.isUserAuthenticated(!0)&&(yield z.continueEdit())})),yield k.present()}else z.appManager.launchOCMWebPage("/poi/edit/"+z.poi.ID)})()}refresh(z=null){this.poi&&this.poiManager.getPOIById(this.poi.ID,!0,!0).then(k=>{k&&(this.poi=k,this.ngOnChanges(null)),z&&z.target.complete()})}}return Ue.\u0275fac=function(z){return new(z||Ue)(v.Y36(d.c),v.Y36(re.SH),v.Y36(Xe.sK),v.Y36(ze.z),v.Y36(re.IN),v.Y36(re.BX),v.Y36(ge.R),v.Y36(Pe.F0))},Ue.\u0275cmp=v.Xpm({type:Ue,selectors:[["poi-details"]],inputs:{poi:"poi"},features:[v.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"banner"],[1,"banner-content"],["color","primary","title","Average User Rating"],["vertical","top","horizontal","end","slot","fixed"],["name","add"],["side","bottom"],["title","Add a comment or charging check-in",3,"click"],["name","chatbubbles"],["title","Add a Photo",3,"click"],["name","camera"],["title","Add to Favourites",3,"click"],["name","star"],["title","Submit an Edit",3,"click"],["name","create"],["title","Refresh",3,"click"],["name","refresh"],["slot","fixed",3,"ionRefresh"],["pullingIcon","caret-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["slot","start"],["slot","end"],[1,"ion-padding"],[3,"ngModel","ngModelChange"],["value","location","selected",""],["value","comments"],["value","media"],["class","address-details",4,"ngIf"],["style","white-space: pre-wrap;",4,"ngIf"],["size","small","title","Add to Favourites",3,"click"],["name","star","slot","start"],["name","create","slot","start"],[3,"click"],["name","navigate","slot","start"],["size","small","title","Add a comment or charging check-in",3,"click"],["name","chatbubbles","slot","start"],["size","small","title","Add a Photo",3,"click"],["name","camera","slot","start"],[1,"address-details"],["name","battery-charging"],[3,"item"],["name","book"],["name","information-circle"],["class","details",4,"ngIf"],["name","map"],[1,"label"],[1,"details"],["name","pin"],[1,"details-minor"],["name","call"],["name","mail"],["name","globe"],["target","_system",3,"href"],["name","help-circle"],[1,"ion-padding-left"],["name","link"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],["class","ion-padding",4,"ngIf"],[4,"ngFor","ngForOf"],[3,"src",4,"ngIf"],[3,"src"],["name","checkmark-circle","color","success",2,"font-size","2em"],["name","close-circle","color","danger"],[1,"subtle"],[2,"white-space","pre-wrap"]],template:function(z,k){1&z&&(v.YNc(0,pn,51,21,"div",0),v.YNc(1,wt,5,0,"div",0)),2&z&&(v.Q6J("ngIf",null!=k.poi&&null!=k.poi.AddressInfo),v.xp6(1),v.Q6J("ngIf",null==k.poi||null==k.poi.AddressInfo))},dependencies:[b.sg,b.O5,re.BJ,re.yp,re.YG,re.Sm,re.PM,re.FN,re.Zi,re.wI,re.IJ,re.W4,re.zq,re.jY,re.gu,re.Ie,re.Q$,re.nJ,re.Wo,re.Nd,re.cJ,re.GO,re.sr,re.QI,he.JJ,he.On,He.B,b.JJ,b.uU,Xe.X$],styles:[".banner[_ngcontent-%COMP%]{background-color:#4f712f;color:#ffffffec;padding:1em;text-shadow:#000 1px 1px 1px;min-height:180px;background-size:cover}.banner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.banner-content[_ngcontent-%COMP%]{padding-right:48px}h3[_ngcontent-%COMP%]{font-weight:700}.label[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:12px}.details[_ngcontent-%COMP%]{color:#707d61;margin-left:1em;font-size:12px}.details-minor[_ngcontent-%COMP%]{color:#707d61;font-size:12px}p[_ngcontent-%COMP%]{display:block;padding:4px}ion-card-header[_ngcontent-%COMP%]{font-weight:700;padding-bottom:0}ion-card-content[_ngcontent-%COMP%]{padding-top:4px}"]}),Ue})(),_n=(()=>{class Ue{constructor(z,k,X){this.modalController=z,this.navParams=k,this.appManager=X,this.hasNavbar=!1,this.poi=this.navParams.get("item"),this.appManager.analytics.viewEvent("POIDetails")}close(){this.modalController.dismiss()}}return Ue.\u0275fac=function(z){return new(z||Ue)(v.Y36(re.IN),v.Y36(re.X1),v.Y36(d.c))},Ue.\u0275cmp=v.Xpm({type:Ue,selectors:[["ng-component"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],[1,"poi-details"],[3,"poi"]],template:function(z,k){1&z&&(v.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),v._uU(3),v.TgZ(4,"small"),v._uU(5),v.qZA()(),v.TgZ(6,"ion-buttons",1)(7,"ion-button",2),v.NdJ("click",function(){return k.close()}),v._UZ(8,"ion-icon",3),v.qZA()()()(),v.TgZ(9,"ion-content",4),v._UZ(10,"poi-details",5),v.qZA()),2&z&&(v.xp6(3),v.hij(" ",k.poi.AddressInfo.Title," "),v.xp6(2),v.hij("OCM-",k.poi.ID,""),v.xp6(5),v.Q6J("poi",k.poi))},dependencies:[re.YG,re.Sm,re.W2,re.Gu,re.gu,re.wd,re.sr,Rt],styles:['.left-col[_ngcontent-%COMP%]{float:left;width:50%;overflow:auto}.right-col[_ngcontent-%COMP%]{float:right;width:50%;overflow:auto}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both;overflow:auto}.row[_ngcontent-%COMP%]{margin-bottom:1em}.subtle[_ngcontent-%COMP%]{color:silver}@media screen and (max-width: 768px){.left-col[_ngcontent-%COMP%]{float:none;width:100%}.right-col[_ngcontent-%COMP%]{margin-top:1em;float:none;width:100%}}.address-details[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;width:auto}ion-label[_ngcontent-%COMP%]{overflow:inherit}ion-title[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{color:#ffffffbf}']}),Ue})()},1948:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{PoiEditorPageModule:()=>Ve});var d=F(6895),v=F(4006),re=F(4228),a=F(425),q=F(4508),oe=F(4463),b=F(8936),he=F(8274);const Ie=[{path:"",component:q.Y}];let Ve=(()=>{class K{}return K.\u0275fac=function(pe){return new(pe||K)},K.\u0275mod=he.oAB({type:K}),K.\u0275inj=he.cJS({imports:[d.ez,v.u5,a.Pc,oe.aw,b.e,re.Bz.forChild(Ie)]}),K})()},4508:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Y:()=>Vt});var d=F(5861),v=F(3855),re=F(8016),a=F(6579),q=F(9698),oe=F(4781),b=F(8274),he=F(4120),Ie=F(5906),Ve=F(553),K=F(7689),xe=F(6260),pe=F(529),ze=F(6895),ce=F(425);function Ke(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"ion-note")(2,"p"),b._uU(3," The closest address to this position is: "),b.qZA(),b.TgZ(4,"p")(5,"strong"),b._uU(6),b.qZA(),b._UZ(7,"br"),b._uU(8),b._UZ(9,"br"),b.TgZ(10,"ion-button",3),b.NdJ("click",function(){b.CHM(ie);const Wt=b.oxw();return b.KtG(Wt.useAddressSelection())}),b._uU(11,"Use this address below "),b._UZ(12,"ion-icon",4),b.qZA()()(),b.BQk()}if(2&Mt){const ie=b.oxw();b.xp6(6),b.Oqu(ie.suggestedAddress.AddressLine1),b.xp6(2),b.HOy(" ",ie.suggestedAddress.AddressLine2," ",ie.suggestedAddress.Town," ",ie.suggestedAddress.StateOrProvince," ",ie.suggestedAddress.Postcode," ")}}let Pe=(()=>{class Mt{constructor(ie,Qe,Wt,rn,oi){this.mapping=ie,this.events=Qe,this.logging=Wt,this.http=rn,this.appManager=oi,this.latitudeChange=new b.vpe,this.longitudeChange=new b.vpe,this.suggestedAddress=null,this.suggestedAddressChange=new b.vpe,this.onUseSuggestedAddress=new b.vpe,this.suggestedAddressAttribution=null,this.suggestedAddressAttributionChange=new b.vpe,this.isMapInitialised=!1}ngOnInit(){this.mapService=new Ve.k(this.events,this.logging,this.http),this.mapService.initAPI(),this.mapOptions=new Ie._,this.mapOptions.mapType=this.appManager.searchSettings.MapType,this.mapOptions.onMapMoveCompleted=()=>{let ie;ie=this.mapService.getMapCenter(),ie.subscribe(Qe=>{Qe&&(this.latitude=Qe.coords.latitude,this.longitude=Qe.coords.longitude,this.latitudeChange.emit(this.latitude),this.longitudeChange.emit(this.longitude),this.getAddressForCurrentLatLng())})}}ngAfterContentInit(){this.focusMap()}ngOnDestroy(){this.mapService.disposeMap()}focusMap(){0==this.isMapInitialised&&this.mapService&&0!=this.latitude&&0!=this.longitude&&(this.isMapInitialised=!0,this.mapService.initMap("editor-map",this.mapOptions,null),this.mapService.setMapCenter(new he.jR(this.latitude,this.longitude)),this.originalMarkerPos=new he.wC(this.latitude,this.longitude))}ngOnChanges(ie){this.focusMap()}getAddressForCurrentLatLng(){var ie=this;return(0,d.Z)(function*(){ie.latitude&&ie.longitude&&ie.appManager.api.fetchReverseGeocodeResult(ie.latitude,ie.longitude).then(Qe=>{Qe.AddressInfo&&(ie.suggestedAddress=Qe.AddressInfo)})})()}useAddressSelection(){this.onUseSuggestedAddress.emit({suggestedAddress:this.suggestedAddress,attribution:this.suggestedAddressAttribution}),this.suggestedAddress=null,this.suggestedAddressAttribution=null}}return Mt.\u0275fac=function(ie){return new(ie||Mt)(b.Y36(oe.v),b.Y36(xe.z),b.Y36(K.z),b.Y36(pe.eN),b.Y36(v.c))},Mt.\u0275cmp=b.Xpm({type:Mt,selectors:[["app-poi-location-editor"]],inputs:{latitude:"latitude",longitude:"longitude"},outputs:{latitudeChange:"latitudeChange",longitudeChange:"longitudeChange",suggestedAddressChange:"suggestedAddressChange",onUseSuggestedAddress:"onUseSuggestedAddress",suggestedAddressAttributionChange:"suggestedAddressAttributionChange"},features:[b.TTD],decls:4,vars:1,consts:[[1,"instruction"],["id","editor-map"],[4,"ngIf"],["size","small",3,"click"],["slot","end","name","copy"]],template:function(ie,Qe){1&ie&&(b.TgZ(0,"p",0),b._uU(1,"Drag the map to center the marker on the charging location:"),b.qZA(),b._UZ(2,"div",1),b.YNc(3,Ke,13,5,"ng-container",2)),2&ie&&(b.xp6(3),b.Q6J("ngIf",Qe.suggestedAddress))},dependencies:[ze.O5,ce.YG,ce.gu,ce.uN],styles:["#editor-map[_ngcontent-%COMP%]{border:1px solid gainsboro;background-color:gray;width:100%;height:128px}"]}),Mt})();var ne=F(6799),Je=F(4006);function Pt(Mt,Ge){if(1&Mt&&(b.TgZ(0,"ion-select-option",14),b._uU(1),b.qZA()),2&Mt){const ie=Ge.$implicit;b.Q6J("value",ie.ID),b.xp6(1),b.Oqu(ie.Title)}}function at(Mt,Ge){if(1&Mt&&(b.TgZ(0,"ion-select-option",14),b._uU(1),b.qZA()),2&Mt){const ie=Ge.$implicit;b.Q6J("value",ie.ID),b.xp6(1),b.Oqu(ie.Title)}}function ge(Mt,Ge){if(1&Mt&&(b.TgZ(0,"ion-select-option",14),b._uU(1),b.qZA()),2&Mt){const ie=Ge.$implicit;b.Q6J("value",ie.ID),b.xp6(1),b.Oqu(ie.Title)}}let ke=(()=>{class Mt{constructor(ie,Qe){this.modalController=ie,this.referenceDataManager=Qe,this.useFilteredConnectionTypes=!0,this.useFilteredOperators=!0}get isAddMode(){return!(null!=this.conn&&this.conn.ID>0)}get connectionTypes(){return this.referenceDataManager.getConnectionTypes(this.useFilteredConnectionTypes)}get currentTypes(){return this.referenceDataManager.getOutputCurrentTypes()}get statusTypes(){return this.referenceDataManager.getStatusTypes().filter(ie=>1==ie.IsUserSelectable)}ngOnInit(){}save(){this.modalController.dismiss({item:this.conn})}cancel(){this.modalController.dismiss()}}return Mt.\u0275fac=function(ie){return new(ie||Mt)(b.Y36(ce.IN),b.Y36(ne.W))},Mt.\u0275cmp=b.Xpm({type:Mt,selectors:[["app-poi-equipment-editor"]],decls:60,vars:13,consts:[[1,"ion-padding"],["position","floating"],[3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange"],["type","text","placeholder","(optional) other comments",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["slot","start"],[3,"click"],["name","close","slot","start"],["slot","end"],["color","success",3,"click"],["name","send","slot","end"],[3,"value"]],template:function(ie,Qe){1&ie&&(b.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),b._uU(3),b.qZA()()(),b.TgZ(4,"ion-content",0)(5,"p"),b._uU(6,"Please provide as much information as you can about the equipment. If you don't know then leave the field blank. At a minimum you should include the Connection Type and approximate Power kW (max)."),b.qZA(),b.TgZ(7,"ion-item")(8,"ion-label",1),b._uU(9,"Connection Type"),b.qZA(),b.TgZ(10,"ion-select",2),b.NdJ("ngModelChange",function(rn){return Qe.conn.ConnectionTypeID=rn}),b.TgZ(11,"ion-select-option",3),b._uU(12,"Unknown"),b.qZA(),b.YNc(13,Pt,2,2,"ion-select-option",4),b.qZA()(),b.TgZ(14,"ion-item")(15,"ion-label",1),b._uU(16,"Supply Type"),b.qZA(),b.TgZ(17,"ion-select",2),b.NdJ("ngModelChange",function(rn){return Qe.conn.CurrentTypeID=rn}),b.TgZ(18,"ion-select-option",3),b._uU(19,"Unknown"),b.qZA(),b.YNc(20,at,2,2,"ion-select-option",4),b.qZA()(),b.TgZ(21,"ion-item")(22,"ion-label",1),b._uU(23,"Power (kW)"),b.qZA(),b.TgZ(24,"ion-input",5),b.NdJ("ngModelChange",function(rn){return Qe.conn.PowerKW=rn}),b.qZA()(),b.TgZ(25,"ion-item")(26,"ion-label",1),b._uU(27,"Amps"),b.qZA(),b.TgZ(28,"ion-input",5),b.NdJ("ngModelChange",function(rn){return Qe.conn.Amps=rn}),b.qZA()(),b.TgZ(29,"ion-item")(30,"ion-label",1),b._uU(31,"Voltage"),b.qZA(),b.TgZ(32,"ion-input",5),b.NdJ("ngModelChange",function(rn){return Qe.conn.Voltage=rn}),b.qZA()(),b.TgZ(33,"ion-item")(34,"ion-label",1),b._uU(35,"Status"),b.qZA(),b.TgZ(36,"ion-select",2),b.NdJ("ngModelChange",function(rn){return Qe.conn.StatusTypeID=rn}),b.YNc(37,ge,2,2,"ion-select-option",4),b.qZA()(),b.TgZ(38,"ion-item")(39,"ion-label",1),b._uU(40,"Quantity Available"),b.qZA(),b.TgZ(41,"ion-input",5),b.NdJ("ngModelChange",function(rn){return Qe.conn.Quantity=rn}),b.qZA()(),b.TgZ(42,"ion-item")(43,"ion-label",1),b._uU(44,"Comment"),b.qZA(),b.TgZ(45,"ion-input",6),b.NdJ("ngModelChange",function(rn){return Qe.conn.Comments=rn}),b.qZA()(),b.TgZ(46,"ion-item")(47,"ion-label",1),b._uU(48,"Operators Reference"),b.qZA(),b.TgZ(49,"ion-input",7),b.NdJ("ngModelChange",function(rn){return Qe.conn.Reference=rn}),b.qZA()()(),b.TgZ(50,"ion-footer")(51,"ion-toolbar")(52,"ion-buttons",8)(53,"ion-button",9),b.NdJ("click",function(){return Qe.cancel()}),b._UZ(54,"ion-icon",10),b._uU(55," Cancel "),b.qZA()(),b.TgZ(56,"ion-buttons",11)(57,"ion-button",12),b.NdJ("click",function(){return Qe.save()}),b._uU(58," OK "),b._UZ(59,"ion-icon",13),b.qZA()()()()),2&ie&&(b.xp6(3),b.Oqu(Qe.isAddMode?"Add Equipment":"Edit Equipment"),b.xp6(7),b.Q6J("ngModel",Qe.conn.ConnectionTypeID),b.xp6(3),b.Q6J("ngForOf",Qe.connectionTypes),b.xp6(4),b.Q6J("ngModel",Qe.conn.CurrentTypeID),b.xp6(3),b.Q6J("ngForOf",Qe.currentTypes),b.xp6(4),b.Q6J("ngModel",Qe.conn.PowerKW),b.xp6(4),b.Q6J("ngModel",Qe.conn.Amps),b.xp6(4),b.Q6J("ngModel",Qe.conn.Voltage),b.xp6(4),b.Q6J("ngModel",Qe.conn.StatusTypeID),b.xp6(1),b.Q6J("ngForOf",Qe.statusTypes),b.xp6(4),b.Q6J("ngModel",Qe.conn.Quantity),b.xp6(4),b.Q6J("ngModel",Qe.conn.Comments),b.xp6(4),b.Q6J("ngModel",Qe.conn.Reference))},dependencies:[ze.sg,ce.YG,ce.Sm,ce.W2,ce.fr,ce.Gu,ce.gu,ce.pK,ce.Ie,ce.Q$,ce.t9,ce.n0,ce.wd,ce.sr,ce.as,ce.QI,ce.j9,Je.JJ,Je.On]}),Mt})();var Le=(()=>{return(Mt=Le||(Le={}))[Mt.Unknown=0]="Unknown",Mt[Mt.CurrentlyAvailable=10]="CurrentlyAvailable",Mt[Mt.CurrentlyInUse=20]="CurrentlyInUse",Mt[Mt.TemporarilyUnavailable=30]="TemporarilyUnavailable",Mt[Mt.Operational=50]="Operational",Mt[Mt.PartlyOperational=75]="PartlyOperational",Mt[Mt.NotOperational=100]="NotOperational",Mt[Mt.PlannedForFutureDate=150]="PlannedForFutureDate",Mt[Mt.RemovedDecomissioned=200]="RemovedDecomissioned",Le;var Mt})(),we=(()=>{return(Mt=we||(we={}))[Mt.UnknownOperator=1]="UnknownOperator",Mt[Mt.SiteOwner=45]="SiteOwner",we;var Mt})(),me=F(6585),de=F(1099);function se(Mt,Ge){if(1&Mt&&(b.TgZ(0,"ion-select-option",5),b._uU(1),b.qZA()),2&Mt){const ie=Ge.$implicit;b.Q6J("value",ie.ID),b.xp6(1),b.Oqu(ie.Title)}}function Ee(Mt,Ge){1&Mt&&(b.TgZ(0,"ion-select-option",6),b._uU(1,"Other..."),b.qZA())}function _t(Mt,Ge){if(1&Mt){const ie=b.EpF();b.TgZ(0,"ion-item")(1,"ion-label",1),b._uU(2,"Network Operator"),b.qZA(),b.TgZ(3,"ion-select",2),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.operatorId=Wt)})("ionChange",function(){b.CHM(ie);const Wt=b.oxw();return b.KtG(Wt.onOperatorChange())}),b.YNc(4,se,2,2,"ion-select-option",3),b.YNc(5,Ee,2,0,"ion-select-option",4),b.qZA()()}if(2&Mt){const ie=b.oxw();b.xp6(3),b.Q6J("ngModel",ie.operatorId),b.xp6(1),b.Q6J("ngForOf",ie.operators),b.xp6(1),b.Q6J("ngIf",ie.useFilteredOperators)}}function It(Mt,Ge){if(1&Mt){const ie=b.EpF();b.TgZ(0,"ion-item")(1,"ion-label"),b._uU(2,"Network Operator"),b.qZA(),b.TgZ(3,"ion-searchbar",7),b.NdJ("ionCancel",function(){b.CHM(ie);const Wt=b.oxw();return b.KtG(Wt.cancelOperatorLookup())})("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.operatorSearchKeyword=Wt)})("ionChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.searchOperators(Wt))}),b.qZA()()}if(2&Mt){const ie=b.oxw();b.xp6(3),b.Q6J("ngModel",ie.operatorSearchKeyword)}}function Gt(Mt,Ge){if(1&Mt){const ie=b.EpF();b.TgZ(0,"ion-item",9),b.NdJ("click",function(){const rn=b.CHM(ie).$implicit,oi=b.oxw(2);return b.KtG(oi.onOperatorChange(rn))}),b.TgZ(1,"ion-avatar",10),b._UZ(2,"ion-icon",11),b.qZA(),b.TgZ(3,"ion-label")(4,"p"),b._uU(5),b.qZA(),b.TgZ(6,"p"),b._uU(7),b.qZA()()()}if(2&Mt){const ie=Ge.$implicit;b.xp6(5),b.Oqu(ie.Title),b.xp6(2),b.Oqu(ie.WebsiteURL)}}function Lt(Mt,Ge){if(1&Mt&&(b.ynx(0),b.TgZ(1,"ion-list"),b.YNc(2,Gt,8,2,"ion-item",8),b.qZA(),b.BQk()),2&Mt){const ie=b.oxw();b.xp6(2),b.Q6J("ngForOf",ie.operatorSearchResults)}}function yt(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"ion-item")(2,"ion-avatar",10),b._UZ(3,"ion-icon",12),b.qZA(),b.TgZ(4,"ion-label")(5,"p"),b._uU(6),b.qZA(),b.TgZ(7,"p"),b._uU(8),b.qZA(),b.TgZ(9,"ion-button",9),b.NdJ("click",function(){b.CHM(ie);const Wt=b.oxw();return b.KtG(Wt.selectedOperator=null)}),b._uU(10,"Change"),b.qZA()()(),b.BQk()}if(2&Mt){const ie=b.oxw();b.xp6(6),b.Oqu(ie.selectedOperator.Title),b.xp6(2),b.Oqu(ie.selectedOperator.WebsiteURL)}}let St=(()=>{class Mt{constructor(ie){this.referenceDataManager=ie,this.operatorId=null,this.useFilteredOperators=null,this.operatorChanged=new b.vpe,this.operatorCache=[],this.operatorSearchResults=[],this.operatorSearchKeyword="",this.selectedOperator=null}get operators(){return this.referenceDataManager.getNetworkOperators(this.useFilteredOperators)}ngOnInit(){this.operatorCache=this.referenceDataManager.getNetworkOperators(!1),null!=this.operatorId&&(this.selectedOperator=this.operatorCache.find(ie=>ie.ID==this.operatorId))}searchOperators(){this.operatorSearchResults=[],0!=this.operatorSearchKeyword.length&&(this.operatorSearchResults=this.operatorCache?this.operatorCache.filter(ie=>ie.Title.toLowerCase().startsWith(this.operatorSearchKeyword.toLowerCase())||ie.Title.toLowerCase().startsWith("("+this.operatorSearchKeyword.toLowerCase())).slice(0,10):[])}onOperatorChange(ie=null){var Qe=this;return(0,d.Z)(function*(){null==ie&&Qe.operatorId&&(ie=Qe.operatorCache.find(Wt=>Wt.ID==Qe.operatorId)),null!=ie&&(Qe.operatorSearchResults=[],Qe.selectedOperator=ie,Qe.operatorId=ie.ID),Qe.operatorId?Qe.operatorChanged.emit(Qe.selectedOperator):Qe.useFilteredOperators=!1})()}cancelOperatorLookup(){this.selectedOperator=null}}return Mt.\u0275fac=function(ie){return new(ie||Mt)(b.Y36(ne.W))},Mt.\u0275cmp=b.Xpm({type:Mt,selectors:[["app-operator-lookup"]],inputs:{operatorId:"operatorId",useFilteredOperators:"useFilteredOperators"},outputs:{operatorChanged:"operatorChanged"},decls:4,vars:4,consts:[[4,"ngIf"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value"],["value",""],["placeholder","Search by network name (in any country)","showCancelButton","focus","autocomplete","on",3,"ngModel","ionCancel","ngModelChange","ionChange"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["item-left",""],["name","card"],["name","locate"]],template:function(ie,Qe){1&ie&&(b.YNc(0,_t,6,3,"ion-item",0),b.YNc(1,It,4,1,"ion-item",0),b.YNc(2,Lt,3,1,"ng-container",0),b.YNc(3,yt,11,2,"ng-container",0)),2&ie&&(b.Q6J("ngIf",Qe.useFilteredOperators&&!Qe.selectedOperator),b.xp6(1),b.Q6J("ngIf",!Qe.useFilteredOperators&&!Qe.selectedOperator),b.xp6(1),b.Q6J("ngIf",Qe.operatorSearchResults.length>0),b.xp6(1),b.Q6J("ngIf",null!=Qe.selectedOperator))},dependencies:[ze.sg,ze.O5,ce.BJ,ce.YG,ce.gu,ce.Ie,ce.Q$,ce.q_,ce.VI,ce.t9,ce.n0,ce.QI,ce.j9,Je.JJ,Je.On]}),Mt})();function xt(Mt,Ge){1&Mt&&b._UZ(0,"ion-icon",13)}function rt(Mt,Ge){1&Mt&&b._UZ(0,"ion-icon",13)}function lt(Mt,Ge){1&Mt&&b._UZ(0,"ion-icon",13)}function Ce(Mt,Ge){if(1&Mt&&(b.TgZ(0,"ion-select-option",27),b._uU(1),b.qZA()),2&Mt){const ie=Ge.$implicit;b.Q6J("value",ie.ID),b.xp6(1),b.Oqu(ie.Title)}}function bt(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"app-poi-location-editor",14,15),b.NdJ("latitudeChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.Latitude=Wt)})("longitudeChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.Longitude=Wt)})("onUseSuggestedAddress",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.useSuggestedAddress(Wt))}),b.qZA(),b.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-label",16),b._uU(6,"Location Name"),b.qZA(),b.TgZ(7,"ion-input",17),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.Title=Wt)}),b.qZA()(),b.TgZ(8,"ion-item")(9,"ion-label",16),b._uU(10,"Address Line 1"),b.qZA(),b.TgZ(11,"ion-input",18),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.AddressLine1=Wt)}),b.qZA()(),b.TgZ(12,"ion-item")(13,"ion-label",16),b._uU(14,"Address Line 2"),b.qZA(),b.TgZ(15,"ion-input",19),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.AddressLine2=Wt)}),b.qZA()(),b.TgZ(16,"ion-item")(17,"ion-label",16),b._uU(18,"Town"),b.qZA(),b.TgZ(19,"ion-input",20),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.Town=Wt)}),b.qZA()(),b.TgZ(20,"ion-item")(21,"ion-label",16),b._uU(22,"State or Province"),b.qZA(),b.TgZ(23,"ion-input",21),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.StateOrProvince=Wt)}),b.qZA()(),b.TgZ(24,"ion-item")(25,"ion-label",16),b._uU(26,"Postal Code"),b.qZA(),b.TgZ(27,"ion-input",22),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.Postcode=Wt)}),b.qZA()(),b.TgZ(28,"ion-item")(29,"ion-label",16),b._uU(30,"Country"),b.qZA(),b.TgZ(31,"ion-select",23),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.CountryID=Wt)})("ionChange",function(){b.CHM(ie);const Wt=b.oxw(2);return b.KtG(Wt.onCountryChange())}),b.YNc(32,Ce,2,2,"ion-select-option",24),b.qZA()(),b.TgZ(33,"ion-item")(34,"ion-label",16),b._uU(35,"Latitude"),b.qZA(),b.TgZ(36,"ion-input",25),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.Latitude=Wt)}),b.qZA()(),b.TgZ(37,"ion-item")(38,"ion-label",16),b._uU(39,"Longitude"),b.qZA(),b.TgZ(40,"ion-input",26),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.AddressInfo.Longitude=Wt)}),b.qZA()()(),b.BQk()}if(2&Mt){const ie=b.oxw(2);b.xp6(1),b.Q6J("latitude",ie.item.AddressInfo.Latitude)("longitude",ie.item.AddressInfo.Longitude),b.xp6(6),b.Q6J("ngModel",ie.item.AddressInfo.Title),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.AddressLine1),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.AddressLine2),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.Town),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.StateOrProvince),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.Postcode),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.CountryID),b.xp6(1),b.Q6J("ngForOf",ie.countries),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.Latitude),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.Longitude)}}function kt(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"h3"),b._uU(2,"Locations Nearby"),b.qZA(),b.TgZ(3,"p")(4,"strong"),b._uU(5,"The following locations already exist nearby."),b.qZA()(),b.TgZ(6,"div",28)(7,"p"),b._uU(8,"Ensure you are not adding a duplicate site unless it is for different equipment from another network operator."),b.qZA(),b.TgZ(9,"p"),b._uU(10,"You can edit any of these listings if required instead:"),b.qZA()(),b.TgZ(11,"app-poi-list",29),b.NdJ("onEdit",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.editPOI(Wt))}),b.qZA(),b.BQk()}if(2&Mt){const ie=b.oxw(2);b.xp6(11),b.Q6J("poiList",ie.nearbySites)("enableEditOption",!0)}}function Ut(Mt,Ge){if(1&Mt&&(b.ynx(0),b.YNc(1,bt,41,12,"ng-container",9),b.YNc(2,kt,12,2,"ng-container",9),b.BQk()),2&Mt){const ie=b.oxw();b.xp6(1),b.Q6J("ngIf","location"==ie.step),b.xp6(1),b.Q6J("ngIf","poi-nearby"==ie.step)}}function bn(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"p"),b._uU(2,"Copied the equipment configuration from:"),b.qZA(),b.TgZ(3,"ion-item")(4,"ion-label"),b._uU(5),b._UZ(6,"br"),b._uU(7),b._UZ(8,"br"),b._uU(9),b._UZ(10,"br"),b._uU(11),b._UZ(12,"br"),b._uU(13),b.qZA(),b.TgZ(14,"ion-button",31),b.NdJ("click",function(){b.CHM(ie);const Wt=b.oxw(5);return b.KtG(Wt.changeTemplatePOI())}),b._uU(15,"Change.."),b.qZA()(),b.BQk()}if(2&Mt){const ie=b.oxw(5);b.xp6(5),b.hij(" ",ie.selectedTemplatePOI.AddressInfo.Title," "),b.xp6(2),b.hij(" ",ie.selectedTemplatePOI.AddressInfo.AddressLine1," "),b.xp6(2),b.hij(" ",null==ie.selectedTemplatePOI.Connections[0].ConnectionType?null:ie.selectedTemplatePOI.Connections[0].ConnectionType.Title," "),b.xp6(2),b.hij(" ",ie.selectedTemplatePOI.Connections[0].PowerKW," "),b.xp6(2),b.hij(" ",ie.selectedTemplatePOI.DateCreated," ")}}function Nn(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"h4"),b._uU(2,"Similar Sites"),b.qZA(),b.TgZ(3,"app-poi-list",32),b.NdJ("onCopy",function(Wt){b.CHM(ie);const rn=b.oxw(6);return b.KtG(rn.useTemplatePOI(Wt))}),b.qZA(),b.BQk()}if(2&Mt){const ie=b.oxw(6);b.xp6(3),b.Q6J("enableCopyOption",!0)("poiList",ie.templateSites)}}function un(Mt,Ge){1&Mt&&(b.ynx(0),b.TgZ(1,"p"),b._uU(2," There are no suggested sites to copy for this network operator. "),b.qZA(),b.BQk())}function ot(Mt,Ge){if(1&Mt&&(b.ynx(0),b.YNc(1,Nn,4,2,"ng-container",9),b.YNc(2,un,3,0,"ng-container",9),b.BQk()),2&Mt){const ie=b.oxw(5);b.xp6(1),b.Q6J("ngIf",ie.templateSites.length>0),b.xp6(1),b.Q6J("ngIf",0==ie.templateSites.length)}}function Bt(Mt,Ge){if(1&Mt&&(b.ynx(0),b.YNc(1,bn,16,5,"ng-container",9),b.YNc(2,ot,3,2,"ng-container",9),b.BQk()),2&Mt){const ie=b.oxw(4);b.xp6(1),b.Q6J("ngIf",ie.selectedTemplatePOI),b.xp6(1),b.Q6J("ngIf",!ie.selectedTemplatePOI)}}function Sn(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"p",28),b._uU(2,"You can copy the equipment settings from other sites operated by the same network operator or choose 'Next' to skip this step: "),b.qZA(),b.TgZ(3,"app-operator-lookup",30),b.NdJ("operatorChanged",function(Wt){b.CHM(ie);const rn=b.oxw(3);return b.KtG(rn.onOperatorChange(Wt))}),b.qZA(),b.YNc(4,Bt,3,2,"ng-container",9),b.BQk()}if(2&Mt){const ie=b.oxw(3);b.xp6(3),b.Q6J("operatorId",ie.item.OperatorID),b.xp6(1),b.Q6J("ngIf",ie.item.AddressInfo.CountryID&&ie.item.OperatorID)}}function Qn(Mt,Ge){if(1&Mt&&(b.ynx(0),b.YNc(1,Sn,5,2,"ng-container",9),b.BQk()),2&Mt){const ie=b.oxw(2);b.xp6(1),b.Q6J("ngIf",!ie.skipPOICopy)}}function ci(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.TgZ(1,"app-operator-lookup",33),b.NdJ("operatorChanged",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.onOperatorChange(Wt))}),b.qZA(),b.TgZ(2,"ion-item")(3,"ion-label",16),b._uU(4,"Number of Stations or Parking Bays"),b.qZA(),b.TgZ(5,"ion-input",21),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.item.NumberOfPoints=Wt)}),b.qZA()(),b.TgZ(6,"h4"),b._uU(7,"Equipment"),b.qZA(),b.TgZ(8,"ion-button",34),b.NdJ("click",function(){b.CHM(ie);const Wt=b.oxw(2);return b.KtG(Wt.addConnection())}),b._UZ(9,"ion-icon",35),b.qZA(),b.TgZ(10,"app-equipment-details",36),b.NdJ("onEdit",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.editConnection(Wt))})("onDelete",function(Wt){b.CHM(ie);const rn=b.oxw(2);return b.KtG(rn.deleteConnection(Wt))}),b.qZA(),b.BQk()}if(2&Mt){const ie=b.oxw(2);b.xp6(1),b.Q6J("operatorId",ie.item.OperatorID)("useFilteredOperators",!1),b.xp6(4),b.Q6J("ngModel",ie.item.NumberOfPoints),b.xp6(5),b.Q6J("item",ie.item)("enableEdit",!0)}}function Un(Mt,Ge){if(1&Mt&&(b.ynx(0),b.YNc(1,Qn,2,1,"ng-container",9),b.YNc(2,ci,11,5,"ng-container",9),b.BQk()),2&Mt){const ie=b.oxw();b.xp6(1),b.Q6J("ngIf","copy-equipment"==ie.step),b.xp6(1),b.Q6J("ngIf","edit-equipment"==ie.step)}}function hi(Mt,Ge){if(1&Mt&&(b.TgZ(0,"p",43)(1,"strong"),b._uU(2,"Your changes cannot be saved until the following issues are resolved:"),b.qZA(),b.TgZ(3,"ion-label",44),b._uU(4),b.qZA()()),2&Mt){const ie=b.oxw(2);b.xp6(4),b.hij(" ",ie.validationMsg,"")}}function Ii(Mt,Ge){if(1&Mt&&(b.TgZ(0,"ion-select-option",27),b._uU(1),b.qZA()),2&Mt){const ie=Ge.$implicit;b.Q6J("value",ie.ID),b.xp6(1),b.Oqu(ie.Title)}}function yi(Mt,Ge){if(1&Mt&&(b.TgZ(0,"ion-select-option",27),b._uU(1),b.qZA()),2&Mt){const ie=Ge.$implicit;b.Q6J("value",ie.ID),b.xp6(1),b.Oqu(ie.Title)}}function Bi(Mt,Ge){if(1&Mt){const ie=b.EpF();b.ynx(0),b.YNc(1,hi,5,1,"p",37),b.TgZ(2,"p"),b._uU(3,"Please provide any other facts related to this site. Additional comments (your charging experiences etc) can be added as check-in comments once the site is listed."),b.qZA(),b.TgZ(4,"ion-item")(5,"ion-label",16),b._uU(6,"Operational Status (All Equipment))"),b.qZA(),b.TgZ(7,"ion-select",38),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.StatusTypeID=Wt)}),b.YNc(8,Ii,2,2,"ion-select-option",24),b.qZA()(),b.TgZ(9,"ion-item")(10,"ion-label",16),b._uU(11,"Usage Type"),b.qZA(),b.TgZ(12,"ion-select",38),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.UsageTypeID=Wt)}),b.YNc(13,yi,2,2,"ion-select-option",24),b.qZA()(),b.TgZ(14,"ion-item")(15,"ion-label",16),b._uU(16,"Usage Cost"),b.qZA(),b.TgZ(17,"ion-input",21),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.UsageCost=Wt)}),b.qZA()(),b.TgZ(18,"ion-item")(19,"ion-label",16),b._uU(20,"General Comments"),b.qZA(),b.TgZ(21,"ion-input",39),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.GeneralComments=Wt)}),b.qZA()(),b.TgZ(22,"ion-item")(23,"ion-label",16),b._uU(24,"Main Telephone Number "),b.qZA(),b.TgZ(25,"ion-input",40),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.AddressInfo.ContactTelephone1=Wt)}),b.qZA()(),b.TgZ(26,"ion-item")(27,"ion-label",16),b._uU(28,"Other Telephone Number "),b.qZA(),b.TgZ(29,"ion-input",40),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.AddressInfo.ContactTelephone2=Wt)}),b.qZA()(),b.TgZ(30,"ion-item")(31,"ion-label",16),b._uU(32,"Access Comments"),b.qZA(),b.TgZ(33,"ion-input",41),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.AddressInfo.AccessComments=Wt)}),b.qZA()(),b.TgZ(34,"ion-item")(35,"ion-label",16),b._uU(36,"Related Website"),b.qZA(),b.TgZ(37,"ion-input",42),b.NdJ("ngModelChange",function(Wt){b.CHM(ie);const rn=b.oxw();return b.KtG(rn.item.AddressInfo.RelatedURL=Wt)}),b.qZA()(),b.BQk()}if(2&Mt){const ie=b.oxw();b.xp6(1),b.Q6J("ngIf",ie.validationMsg),b.xp6(6),b.Q6J("ngModel",ie.item.StatusTypeID),b.xp6(1),b.Q6J("ngForOf",ie.statusTypes),b.xp6(4),b.Q6J("ngModel",ie.item.UsageTypeID),b.xp6(1),b.Q6J("ngForOf",ie.usageTypes),b.xp6(4),b.Q6J("ngModel",ie.item.UsageCost),b.xp6(4),b.Q6J("ngModel",ie.item.GeneralComments),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.ContactTelephone1),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.ContactTelephone2),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.AccessComments),b.xp6(4),b.Q6J("ngModel",ie.item.AddressInfo.RelatedURL)}}function Mi(Mt,Ge){if(1&Mt){const ie=b.EpF();b.TgZ(0,"ion-button",1),b.NdJ("click",function(){b.CHM(ie);const Wt=b.oxw();return b.KtG(Wt.previous())}),b._uU(1," Previous "),b._UZ(2,"ion-icon",45),b.qZA()}}function Ni(Mt,Ge){if(1&Mt){const ie=b.EpF();b.TgZ(0,"ion-button",1),b.NdJ("click",function(){b.CHM(ie);const Wt=b.oxw();return b.KtG(Wt.next())}),b._uU(1," Next "),b._UZ(2,"ion-icon",46),b.qZA()}}function Ki(Mt,Ge){if(1&Mt){const ie=b.EpF();b.TgZ(0,"ion-button",47),b.NdJ("click",function(){b.CHM(ie);const Wt=b.oxw();return b.KtG(Wt.save())}),b._uU(1," Submit "),b._UZ(2,"ion-icon",48),b.qZA()}}let Vt=(()=>{class Mt{constructor(ie,Qe,Wt,rn,oi,Di){this.appManager=ie,this.modalController=Qe,this.poiManager=Wt,this.mapping=rn,this.loadingController=oi,this.alertController=Di,this.useFilteredConnectionTypes=!0,this.templateSites=[],this.nearbySites=[],this.selectedTemplatePOI=null,this.suggestedAddress=null,this.suggestedAddressAttribution=null,this.isNonDuplicateConfirmed=!1,this.skipPOICopy=!1,this.validationMsg=null,this.initNewItem()}get countries(){return this.appManager.referenceDataManager.getCountries()}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes()}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes().filter(ie=>1==ie.IsUserSelectable)}get isAddMode(){return this.item.ID<=0}initNewItem(){this.item={ID:-1,DataProviderID:1,DataProvidersReference:null,OperatorsReference:null,OperatorID:1,UsageCost:null,UsageTypeID:4,NumberOfPoints:1,GeneralComments:null,DatePlanned:null,StatusTypeID:50,SubmissionStatusTypeID:null,Connections:[],MetadataValues:[],AddressInfo:{ID:-1,CountryID:18,Title:"",AddressLine1:"",Latitude:0,Longitude:0}},this.step="location",this.selectedTab="location"}get isReadyToSubmit(){return this.validate().isValid&&"info"==this.step}ngOnInit(){}presentLoadingUI(){var ie=this;return(0,d.Z)(function*(){ie.loading=yield ie.loadingController.create({message:"Please Wait.."}),yield ie.loading.present()})()}dismissLoadingUI(){var ie=this;return(0,d.Z)(function*(){ie.loading&&(yield ie.loading.dismiss())})()}ionViewDidEnter(){if(null!=this.id)this.editExistingPOI(this.id);else{let ie=localStorage.getItem("_editor-operatorid");ie&&(this.item.OperatorID=parseInt(ie,10)),this.startPos?(this.item.AddressInfo.Latitude=this.startPos.latitude,this.item.AddressInfo.Longitude=this.startPos.longitude):this.mapping&&this.mapping.getMapCenter().subscribe(Qe=>{Qe&&(this.item.AddressInfo.Latitude=Qe.coords.latitude,this.item.AddressInfo.Longitude=Qe.coords.longitude)})}this.refreshFilteredReferenceData()}previous(){var ie=this;return(0,d.Z)(function*(){switch(ie.step){case"info":ie.step="edit-equipment";break;case"edit-equipment":ie.step=ie.isAddMode?"copy-equipment":"location";break;case"copy-equipment":case"poi-nearby":ie.step="location"}yield ie.initCurrentStep(!1)})()}next(){var ie=this;return(0,d.Z)(function*(){if("poi-nearby"==ie.step&&ie.nearbySites.length>0&&!ie.isNonDuplicateConfirmed)return void(yield ie.alertController.create({header:"Confirm",message:"Please confirm you are not adding a duplicate site.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:rn=>{}},{text:"Confirm",handler:()=>{ie.isNonDuplicateConfirmed=!0,ie.next()}}]})).present();const Qe=ie.validate(ie.step);if(Qe.isValid){switch(ie.step){case"location":ie.step=ie.isAddMode?"poi-nearby":"edit-equipment";break;case"poi-nearby":ie.step=ie.isAddMode?"copy-equipment":"edit-equipment";break;case"copy-equipment":ie.step="edit-equipment";break;case"edit-equipment":ie.step="info"}yield ie.initCurrentStep(!0)}else(yield ie.alertController.create({message:Qe.msg})).present()})()}initCurrentStep(ie){var Qe=this;return(0,d.Z)(function*(){"poi-nearby"==Qe.step?(Qe.selectedTab="location",0==(yield Qe.refreshNearbySites())&&(ie?yield Qe.next():yield Qe.previous())):"location"==Qe.step?Qe.selectedTab="location":"copy-equipment"==Qe.step?(Qe.selectedTab="equipment",yield Qe.refreshTemplateSites()):"edit-equipment"==Qe.step?Qe.selectedTab="equipment":"info"==Qe.step&&(Qe.selectedTab="info")})()}onCountryChange(){var ie=this;return(0,d.Z)(function*(){ie.refreshFilteredReferenceData()})()}onOperatorChange(ie=null){var Qe=this;return(0,d.Z)(function*(){null!=ie&&Qe.item.OperatorID!=ie.ID&&(Qe.item.OperatorID=ie.ID,localStorage.setItem("_editor-operatorid",Qe.item.OperatorID.toString()),yield Qe.refreshTemplateSites())})()}useSuggestedAddress(ie=null){ie&&(this.suggestedAddress=ie.suggestedAddress,this.suggestedAddressAttribution=ie.suggestedAddressAttribution),Object.assign(this.item.AddressInfo,this.suggestedAddress),this.suggestedAddressAttribution&&(this.item.MetadataValues.find(Qe=>4==Qe.MetadataFieldID)||this.item.MetadataValues.push({ID:-1,MetadataFieldID:4,ItemValue:this.suggestedAddressAttribution,MetadataFieldOptionID:null,MetadataFieldOption:null}))}editConnection(ie){var Qe=this;return(0,d.Z)(function*(){const Wt=Qe.item.Connections.find(Di=>Di.ID==ie.ID),rn=Object.assign({},Wt),oi=yield Qe.modalController.create({component:ke,componentProps:{conn:rn}});return oi.onWillDismiss().then(Di=>{Di&&Di.data&&Di.data.item&&Qe.updateConnection(Di.data.item)}),yield oi.present()})()}deleteConnection(ie){var Qe=this;return(0,d.Z)(function*(){const Wt=Qe.item.Connections.find(oi=>oi.ID==ie.ID);(yield Qe.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this connection information?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Yes",handler:()=>{Qe.item.Connections=Qe.item.Connections.filter(oi=>oi.ID!=Wt.ID),Qe.appManager.referenceDataManager.hydrateCompactPOI(Qe.item,!0)}}]})).present()})()}addConnection(){var ie=this;return(0,d.Z)(function*(){const Qe={ID:-a.c.getRandomInt(1e4),ConnectionTypeID:null,StatusTypeID:50,PowerKW:null,Quantity:1},Wt=yield ie.modalController.create({component:ke,componentProps:{conn:Qe}});return Wt.onWillDismiss().then(rn=>{rn&&rn.data&&rn.data.item&&ie.updateConnection(rn.data.item)}),yield Wt.present()})()}refreshFilteredReferenceData(){this.appManager.referenceDataManager.refreshFilteredReferenceData(this.appManager.api,{CountryIds:[this.item.AddressInfo.CountryID]})}updateConnection(ie){if(ie){let Qe=this.item.Connections.find(Wt=>Wt.ID==ie.ID);Qe?Object.assign(Qe,ie):this.item.Connections.push(ie)}this.appManager.referenceDataManager.hydrateCompactPOI(this.item,!0)}validate(ie="all"){let Qe=null;return("all"==ie||"location"==ie)&&((!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(Qe="Location is required"),""==this.item.AddressInfo.Title&&(Qe="A location title is required"),!this.item.AddressInfo.AddressLine1&&!this.item.AddressInfo.AddressLine2&&(Qe="An approximate address is required."),this.item.AddressInfo.CountryID||(Qe="A country selection is required"),(!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(Qe="A location latitude and longitude is required")),("all"==ie||"poi-nearby"==ie)&&this.nearbySites.length>0&&!this.isNonDuplicateConfirmed&&(Qe="Please confirm that the site is not a duplicate"),("all"==ie||"equipment"==ie)&&(this.item.OperatorID||(Qe="Please confirm the charging network or equipment operator."),0==this.item.Connections.length&&(Qe="Equipment information is required")),Qe?(this.validationMsg=Qe,{isValid:!1,msg:Qe}):(this.validationMsg=null,{isValid:!0,msg:null})}save(){var ie=this;return(0,d.Z)(function*(){let Qe=ie.validate();if(Qe.isValid){yield ie.presentLoadingUI();try{yield ie.appManager.submitPOI(ie.item),yield ie.dismissLoadingUI(),ie.appManager.showToastNotification("You submission will be reviewed (if required) and published shortly."),ie.modalController.dismiss()}catch(Wt){yield ie.dismissLoadingUI(),Wt.error&&alert("Sorry, your submission could not be completed at this time. Please try again later.")}}else alert(Qe.msg)})()}cancel(){var ie=this;return(0,d.Z)(function*(){ie.modalController.dismiss()})()}refreshTemplateSites(){var ie=this;return(0,d.Z)(function*(){if(ie.item.AddressInfo.CountryID&&ie.item.OperatorID){yield ie.presentLoadingUI(),ie.templateSites=[];let Qe=new re.b;Qe.countryIdList=[ie.item.AddressInfo.CountryID],Qe.minPowerKW=1,Qe.operatorIdList=[ie.item.OperatorID],Qe.maxResults=10;let Wt=yield ie.poiManager.fetchPOIList(Qe);Wt.sort((rn,oi)=>new Date(rn.DateCreated).getTime()-new Date(oi.DateCreated).getTime()),ie.templateSites=Wt,ie.dismissLoadingUI()}})()}refreshNearbySites(){var ie=this;return(0,d.Z)(function*(){if(ie.item.AddressInfo.Latitude&&ie.item.AddressInfo.Longitude){yield ie.presentLoadingUI(),ie.nearbySites=[];let Qe=new re.b;Qe.latitude=ie.item.AddressInfo.Latitude,Qe.longitude=ie.item.AddressInfo.Longitude,Qe.distance=5,Qe.distanceUnit="km",Qe.maxResults=10;let Wt=yield ie.poiManager.fetchPOIList(Qe);return Wt.sort((rn,oi)=>rn.Distance-oi.Distance),ie.nearbySites=Wt,ie.dismissLoadingUI(),Wt.length}return 0})()}confirmNonDuplicate(){this.isNonDuplicateConfirmed=!0,this.next()}changeTemplatePOI(){this.selectedTemplatePOI=null}editPOI(ie){this.editExistingPOI(ie.ID)}editExistingPOI(ie){var Qe=this;return(0,d.Z)(function*(){Qe.skipPOICopy=!0,Qe.isNonDuplicateConfirmed=!0,yield Qe.presentLoadingUI(),Qe.poiManager.getPOIById(ie,!0,!0).then(Wt=>{Qe.item=Object.assign({},Wt),null==Qe.item.OperatorID&&(Qe.item.OperatorID=we.UnknownOperator),Qe.refreshFilteredReferenceData(),Qe.dismissLoadingUI()})})()}useTemplatePOI(ie){this.selectedTemplatePOI=ie,Object.assign(this.item.Connections,ie.Connections);for(let Qe of this.item.Connections)Qe.ID=-a.c.getRandomInt(1e4),Qe.Reference=null,Qe.Comments=null,Qe.StatusTypeID=Le.Operational;this.item.UsageCost=ie.UsageCost,this.item.UsageTypeID=ie.UsageTypeID,this.appManager.referenceDataManager.hydrateCompactPOI(this.item)}skipCopyingPOI(){this.skipPOICopy=!0}}return Mt.\u0275fac=function(ie){return new(ie||Mt)(b.Y36(v.c),b.Y36(ce.IN),b.Y36(q.R),b.Y36(oe.v),b.Y36(ce.HT),b.Y36(ce.Br))},Mt.\u0275cmp=b.Xpm({type:Mt,selectors:[["app-poi-editor"]],viewQuery:function(ie,Qe){if(1&ie&&b.Gf(Pe,5),2&ie){let Wt;b.iGM(Wt=b.CRH())&&(Qe.editorMap=Wt.first)}},decls:33,vars:14,consts:[["slot","end"],[3,"click"],["name","close","slot","start"],[1,"ion-padding"],[3,"ngModel"],["value","location","layout","icon-start",3,"disabled"],["name","caret-forward",4,"ngIf"],["value","equipment","layout","icon-start",3,"disabled"],["value","info","layout","icon-start",3,"disabled"],[4,"ngIf"],["slot","start"],[3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],["name","caret-forward"],[3,"latitude","longitude","latitudeChange","longitudeChange","onUseSuggestedAddress"],["editorMap",""],["position","floating"],["type","text","autocapitalize","words","placeholder","A title for this location",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","The nearest street address",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Town or City",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional Postal Code",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["type","number","placeholder","Latitude (if entering manually)",3,"ngModel","ngModelChange"],["type","number","placeholder","Longitude (if entering manually)",3,"ngModel","ngModelChange"],[3,"value"],[1,"instruction"],[3,"poiList","enableEditOption","onEdit"],[3,"operatorId","operatorChanged"],["slot","start","size","small",3,"click"],[3,"enableCopyOption","poiList","onCopy"],[3,"operatorId","useFilteredOperators","operatorChanged"],["size","small",3,"click"],["name","add","slot","icon-only"],[3,"item","enableEdit","onEdit","onDelete"],["color","warning",4,"ngIf"],[3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences",3,"ngModel","ngModelChange"],["type","tel","placeholder","",3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences","placeholder","Instructions for access or tips for finding charging location",3,"ngModel","ngModelChange"],["type","url","placeholder","Website related to this site",3,"ngModel","ngModelChange"],["color","warning"],["color","danger"],["name","caret-back","slot","start"],["name","caret-forward","slot","end"],["color","success",3,"click"],["name","send","slot","end"]],template:function(ie,Qe){1&ie&&(b.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),b._uU(3),b.qZA(),b.TgZ(4,"ion-buttons",0)(5,"ion-button",1),b.NdJ("click",function(){return Qe.cancel()}),b._UZ(6,"ion-icon",2),b._uU(7," Cancel "),b.qZA()()()(),b.TgZ(8,"ion-content",3),b.ynx(9),b.TgZ(10,"ion-segment",4)(11,"ion-segment-button",5),b.YNc(12,xt,1,0,"ion-icon",6),b.TgZ(13,"ion-label"),b._uU(14,"Location"),b.qZA()(),b.TgZ(15,"ion-segment-button",7),b.YNc(16,rt,1,0,"ion-icon",6),b.TgZ(17,"ion-label"),b._uU(18,"Equipment"),b.qZA()(),b.TgZ(19,"ion-segment-button",8),b.YNc(20,lt,1,0,"ion-icon",6),b.TgZ(21,"ion-label"),b._uU(22,"Info"),b.qZA()()(),b.YNc(23,Ut,3,2,"ng-container",9),b.YNc(24,Un,3,2,"ng-container",9),b.YNc(25,Bi,38,11,"ng-container",9),b.BQk(),b.qZA(),b.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",10),b.YNc(29,Mi,3,0,"ion-button",11),b.qZA(),b.TgZ(30,"ion-buttons",0),b.YNc(31,Ni,3,0,"ion-button",11),b.YNc(32,Ki,3,0,"ion-button",12),b.qZA()()()),2&ie&&(b.xp6(3),b.Oqu(Qe.isAddMode?"Add Location":"Edit Location"),b.xp6(7),b.Q6J("ngModel",Qe.selectedTab),b.xp6(1),b.Q6J("disabled",!0),b.xp6(1),b.Q6J("ngIf","location"==Qe.selectedTab),b.xp6(3),b.Q6J("disabled",!0),b.xp6(1),b.Q6J("ngIf","equipment"==Qe.selectedTab),b.xp6(3),b.Q6J("disabled",!0),b.xp6(1),b.Q6J("ngIf","info"==Qe.selectedTab),b.xp6(3),b.Q6J("ngIf","location"==Qe.selectedTab),b.xp6(1),b.Q6J("ngIf","equipment"==Qe.selectedTab),b.xp6(1),b.Q6J("ngIf","info"==Qe.selectedTab),b.xp6(4),b.Q6J("ngIf","location"!=Qe.step),b.xp6(2),b.Q6J("ngIf",!Qe.isReadyToSubmit&&"info"!=Qe.step),b.xp6(1),b.Q6J("ngIf",Qe.isReadyToSubmit))},dependencies:[ze.sg,ze.O5,Je.JJ,Je.On,ce.YG,ce.Sm,ce.W2,ce.fr,ce.Gu,ce.gu,ce.pK,ce.Ie,ce.Q$,ce.q_,ce.cJ,ce.GO,ce.t9,ce.n0,ce.wd,ce.sr,ce.as,ce.QI,ce.j9,me.o,de.B,Pe,St],styles:['ul.breadcrumb[_ngcontent-%COMP%]{display:inline-flex;margin:0;padding:0}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;margin-right:6px;color:var(--ion-color-light-shade);font-size:10px}ul.breadcrumb[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:var(--ion-color-dark-shade)}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:">";padding-right:4px}']}),Mt})()},6763:(Ln,Dt,F)=>{"use strict";F.d(Dt,{u:()=>Le});var d=F(8274),v=F(425),re=F(4120),a=F(3912),q=F(7689),oe=F(129),b=F(529);let he=(()=>{class we{constructor(He,me){this.http=He,this.journeyManager=me}getDirections(He,me){return new Promise((de,se)=>{(new google.maps.DirectionsService).route({origin:He,destination:me,travelMode:google.maps.TravelMode.DRIVING},(_t,It)=>{It===google.maps.DirectionsStatus.OK?de(_t):se(It)})})}analyseRoutes(He,me){const de=new Array;return He.routes.forEach(se=>{const Ee=new oe.JJ;Ee.Title=""+de.length+1,Ee.JourneyRouteLegs=new Array,Ee.TotalDistanceKM=0,Ee.TotalDurationMinutes=0,Ee.TotalEnergykWh=0,se.legs.forEach(_t=>{const It=_t.duration.value,Gt=_t.distance.value/1e3,Lt=this.journeyManager.calculateEnergyConsumptionkWh(Gt,0,null,me),yt=new oe.eN;yt.DistanceKM=Gt,yt.DurationMinutes=It/60,yt.EnergyConsumptionkWh=Lt,Ee.JourneyRouteLegs.push(yt),Ee.TotalDistanceKM+=yt.DistanceKM,Ee.TotalDurationMinutes+=yt.DurationMinutes,Ee.TotalEnergykWh=yt.EnergyConsumptionkWh}),de.push(Ee)}),de}}return we.\u0275fac=function(He){return new(He||we)(d.LFG(b.eN),d.LFG(a.i))},we.\u0275prov=d.Yz7({token:we,factory:we.\u0275fac,providedIn:"root"}),we})();var Ie=F(4781),Ve=F(6895),K=F(4006),xe=F(2428);function pe(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",12),d.TgZ(2,"ion-searchbar",13),d.NdJ("ngModelChange",function(de){d.CHM(He);const se=d.oxw();return d.KtG(se.routeStart=de)})("ionInput",function(de){d.CHM(He),d.oxw();const se=d.MAs(18);return d.KtG(se.getPlacesAutoComplete(de,"routeStart"))})("ionCancel",function(de){d.CHM(He);const se=d.oxw();return d.KtG(se.onPlaceSearchCancel(de))}),d.qZA()()}if(2&we){const He=d.oxw();d.xp6(2),d.Q6J("ngModel",He.routeStart)("debounce",500)}}function ze(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){d.CHM(He);const de=d.oxw();return d.KtG(de.clearRouteStart())}),d._UZ(1,"ion-icon",12),d.TgZ(2,"h2"),d._uU(3),d.qZA()()}if(2&we){d.oxw();const He=d.MAs(18);d.xp6(3),d.Oqu(null==He.selectedPlace?null:He.selectedPlace.name)}}function ce(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"ion-item"),d._UZ(1,"ion-icon",15),d.TgZ(2,"ion-searchbar",16),d.NdJ("ngModelChange",function(de){d.CHM(He);const se=d.oxw();return d.KtG(se.routeDestination=de)})("ionInput",function(de){d.CHM(He),d.oxw();const se=d.MAs(20);return d.KtG(se.getPlacesAutoComplete(de,"routeDestination"))})("ionCancel",function(de){d.CHM(He);const se=d.oxw();return d.KtG(se.onPlaceSearchCancel(de))}),d.qZA()()}if(2&we){const He=d.oxw();d.xp6(2),d.Q6J("ngModel",He.routeDestination)("debounce",500)}}function Ke(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"ion-item",14),d.NdJ("click",function(){d.CHM(He);const de=d.oxw();return d.KtG(de.clearRouteDestination())}),d._UZ(1,"ion-icon",15),d.TgZ(2,"h2"),d._uU(3),d.qZA()()}if(2&we){d.oxw();const He=d.MAs(20);d.xp6(3),d.Oqu(null==He.selectedPlace?null:He.selectedPlace.name)}}function Pe(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(He);const de=d.oxw();return d.KtG(de.clearRoute())}),d._UZ(1,"ion-icon",17),d._uU(2," Clear Route "),d.qZA()}}function ne(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(He);const de=d.oxw();return d.KtG(de.showSettings())}),d._uU(1," Show Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function Je(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"ion-button",14),d.NdJ("click",function(){d.CHM(He);const de=d.oxw();return d.KtG(de.hideSettings())}),d._uU(1," Hide Settings "),d._UZ(2,"ion-icon",18),d.qZA()}}function Pt(we,Xe){1&we&&(d.TgZ(0,"p",19),d._UZ(1,"ion-spinner",19),d._uU(2," Calculating Route.. "),d.qZA())}function at(we,Xe){if(1&we&&(d.TgZ(0,"ion-list")(1,"ion-list-header"),d._uU(2),d.ALo(3,"number"),d.ALo(4,"number"),d.qZA()()),2&we){const He=d.oxw();d.xp6(2),d.lnq(" Total Distance ",d.xi3(3,3,He.selectedJourneyRoute.TotalDistanceKM,"1.0-2")," km, ",He.formatDuration(He.selectedJourneyRoute.TotalDurationMinutes),", ",d.xi3(4,6,He.selectedJourneyRoute.TotalEnergykWh,"1.0-2")," kWh ")}}function ge(we,Xe){if(1&we){const He=d.EpF();d.TgZ(0,"div")(1,"ion-list")(2,"ion-list-header"),d._UZ(3,"ion-icon",20),d._uU(4," Route Settings "),d.qZA(),d.TgZ(5,"ion-item")(6,"ion-label",21),d._uU(7),d.qZA(),d.TgZ(8,"ion-range",22),d.NdJ("ngModelChange",function(de){d.CHM(He);const se=d.oxw();return d.KtG(se.routeSearchDistance=de)}),d._UZ(9,"ion-icon",23)(10,"ion-icon",24),d.qZA()(),d.TgZ(11,"ion-item")(12,"ion-label",21),d._uU(13,"Energy Efficiency (kWh Per km)"),d.qZA(),d.TgZ(14,"ion-input",25),d.NdJ("ngModelChange",function(de){d.CHM(He);const se=d.oxw();return d.KtG(se.kWhPerKM=de)}),d.qZA()()()()}if(2&we){const He=d.oxw();d.xp6(7),d.hij("Search Distance (",He.routeSearchDistance,")"),d.xp6(1),d.Q6J("ngModel",He.routeSearchDistance),d.xp6(6),d.Q6J("ngModel",He.kWhPerKM)}}let ke=(()=>{class we{constructor(He,me,de,se,Ee,_t){this.mapping=He,this.logging=me,this.directions=de,this.journeyManager=se,this.changeDetector=Ee,this.numberPipe=_t,this.routeSearchDistance=5,this.routeCalcInProgress=!1,this.advancedSettingsMode=!1,this.routeStart="",this.routeDestination="",this.kWhPerKM=.212}get isRouteSet(){return null!=this.routeStartPlace&&null!=this.routeDestinationPlace}showSettings(){this.advancedSettingsMode=!0}hideSettings(){this.advancedSettingsMode=!1}routeStartSelected(He){this.routeStartPlace=He,this.calculateRoute(),this.changeDetector.detectChanges()}routeDestinationSelected(He){this.routeDestinationPlace=He,this.calculateRoute(),this.changeDetector.detectChanges()}clearRouteStart(){this.routeStartPlace=null,this.changeDetector.detectChanges()}clearRouteDestination(){this.routeDestinationPlace=null,this.changeDetector.detectChanges()}clearRoute(){this.routeStartPlace=null,this.routeDestinationPlace=null,this.journeyManager.setRoutePolyline(null),this.mapping.clearPolyline()}formatDuration(He){if(He<=60)return this.numberPipe.transform(He,"1.0-2")+" mins";{const me=Math.round(He/60),de=Math.floor(He-60*me);return me+" hours "+(de>0?de+" mins":"")}}calculateRoute(){null!=this.routeStartPlace&&null!=this.routeDestinationPlace&&(this.logging.log("Fetching route directions.."),this.routeCalcInProgress=!0,this.directions.getDirections(this.routeStartPlace.Location.latitude+","+this.routeStartPlace.Location.longitude,this.routeDestinationPlace.Location.latitude+","+this.routeDestinationPlace.Location.longitude).then(He=>{if(null!=He.routes&&He.routes.length>0){this.logging.log("Got route directions, analysing.."),this.routePolyline=He.routes[0].overview_polyline;const me=He.routes[0].bounds.getSouthWest(),de=He.routes[0].bounds.getNorthEast(),se=new re.wC(de.lat(),de.lng()),Ee=new re.wC(me.lat(),me.lng()),_t=new re.LL(se,Ee);this.journeyRoutes=this.directions.analyseRoutes(He,this.kWhPerKM),this.journeyRoutes.length>0&&(this.selectedJourneyRoute=this.journeyRoutes[0]),this.journeyManager.setRoutePolyline(this.routePolyline),this.mapping.renderPolyline(this.routePolyline),this.mapping.moveToMapBounds(_t)}else this.logging.log("No route returned..");this.routeCalcInProgress=!1}))}}return we.\u0275fac=function(He){return new(He||we)(d.Y36(Ie.v),d.Y36(q.z),d.Y36(he),d.Y36(a.i),d.Y36(d.sBO),d.Y36(Ve.JJ))},we.\u0275cmp=d.Xpm({type:we,selectors:[["route-planner"]],decls:24,vars:10,consts:[[1,"route"],[1,"route-places"],["name","map","slot","start"],[4,"ngIf"],[3,"click",4,"ngIf"],["primary",""],["slot","secondary"],["slot","primary"],[3,"placeChanged"],["placeSearchRouteStart",""],["placeSearchRouteDestination",""],["class","ion-padding",4,"ngIf"],["name","ionic","item-left",""],["placeholder","Starting Point",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],[3,"click"],["name","pin","item-left",""],["placeholder","Destination",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],["name","close","slot","start"],["name","cog","slot","end"],[1,"ion-padding"],["name","cog"],["position","stacked"],["min","1","max","200","step","5","snaps","true","pin","true","light","",3,"ngModel","ngModelChange"],["slot","start","small","","name","map"],["slot","end","large","","name","map"],["type","number","min","0.1","max","1",3,"ngModel","ngModelChange"]],template:function(He,me){1&He&&(d.TgZ(0,"div",0)(1,"div",1)(2,"ion-list")(3,"ion-list-header"),d._UZ(4,"ion-icon",2),d.TgZ(5,"ion-label"),d._uU(6,"Plan Your Journey"),d.qZA()(),d.YNc(7,pe,3,2,"ion-item",3),d.YNc(8,ze,4,1,"ion-item",4),d.YNc(9,ce,3,2,"ion-item",3),d.YNc(10,Ke,4,1,"ion-item",4),d.qZA(),d.TgZ(11,"ion-toolbar",5)(12,"ion-buttons",6),d.YNc(13,Pe,3,0,"ion-button",4),d.qZA(),d.TgZ(14,"ion-buttons",7),d.YNc(15,ne,3,0,"ion-button",4),d.YNc(16,Je,3,0,"ion-button",4),d.qZA()()(),d.TgZ(17,"place-search",8,9),d.NdJ("placeChanged",function(se){return me.routeStartSelected(se)}),d.qZA(),d.TgZ(19,"place-search",8,10),d.NdJ("placeChanged",function(se){return me.routeDestinationSelected(se)}),d.qZA(),d.YNc(21,Pt,3,0,"p",11),d.YNc(22,at,5,9,"ion-list",3),d.YNc(23,ge,15,3,"div",3),d.qZA()),2&He&&(d.xp6(7),d.Q6J("ngIf",null==me.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null!=me.routeStartPlace),d.xp6(1),d.Q6J("ngIf",null==me.routeDestinationPlace),d.xp6(1),d.Q6J("ngIf",null!=me.routeDestinationPlace),d.xp6(3),d.Q6J("ngIf",me.isRouteSet),d.xp6(2),d.Q6J("ngIf",!me.advancedSettingsMode),d.xp6(1),d.Q6J("ngIf",me.advancedSettingsMode),d.xp6(5),d.Q6J("ngIf",me.routeCalcInProgress),d.xp6(1),d.Q6J("ngIf",null!=me.selectedJourneyRoute),d.xp6(1),d.Q6J("ngIf",me.advancedSettingsMode))},dependencies:[Ve.O5,v.YG,v.Sm,v.gu,v.pK,v.Ie,v.Q$,v.q_,v.yh,v.I_,v.VI,v.PQ,v.sr,v.as,v.QI,v.j9,K.JJ,K.On,xe.v,Ve.JJ],encapsulation:2}),we})(),Le=(()=>{class we{constructor(He){this.modalController=He,this.hasNavbar=!1}close(){this.modalController.dismiss()}}return we.\u0275fac=function(He){return new(He||we)(d.Y36(v.IN))},we.\u0275cmp=d.Xpm({type:we,selectors:[["ng-component"]],decls:10,vars:0,consts:[["slot","end"],[3,"click"],["name","close","slot","end"],[1,"route-planner","ion-padding"]],template:function(He,me){1&He&&(d.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),d._uU(3," Route Planner "),d.qZA(),d.TgZ(4,"ion-buttons",0)(5,"ion-button",1),d.NdJ("click",function(){return me.close()}),d._UZ(6,"ion-icon",2),d._uU(7," Close "),d.qZA()()()(),d.TgZ(8,"ion-content",3),d._UZ(9,"route-planner"),d.qZA())},dependencies:[v.YG,v.Sm,v.W2,v.Gu,v.gu,v.wd,v.sr,ke],encapsulation:2}),we})()},3548:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{SearchPageModule:()=>bn});var d=F(8936),v=F(4463),re=F(6895),a=F(4006),q=F(425),oe=F(4228),b=F(5861),he=F(2340),Ie=F(2951),Ve=F(6314),K=F(6763),xe=F(3399),pe=F(4120),ze=F(8016),ce=F(6579),Ke=F(7689),Pe=F(3912),ne=F(4781),Je=F(9698),Pt=F(3855),at=F(2428),ge=F(4968),ke=F(727);class Le extends ke.w0{constructor(un,ot){super()}schedule(un,ot=0){return this}}const we={setInterval(Nn,un,...ot){const{delegate:Bt}=we;return Bt?.setInterval?Bt.setInterval(Nn,un,...ot):setInterval(Nn,un,...ot)},clearInterval(Nn){const{delegate:un}=we;return(un?.clearInterval||clearInterval)(Nn)},delegate:void 0};var Xe=F(8737),me=F(6063);class de{constructor(un,ot=de.now){this.schedulerActionCtor=un,this.now=ot}schedule(un,ot=0,Bt){return new this.schedulerActionCtor(this,un).schedule(Bt,ot)}}de.now=me.l.now;const Ee=new class se extends de{constructor(un,ot=de.now){super(un,ot),this.actions=[],this._active=!1}flush(un){const{actions:ot}=this;if(this._active)return void ot.push(un);let Bt;this._active=!0;do{if(Bt=un.execute(un.state,un.delay))break}while(un=ot.shift());if(this._active=!1,Bt){for(;un=ot.shift();)un.unsubscribe();throw Bt}}}(class He extends Le{constructor(un,ot){super(un,ot),this.scheduler=un,this.work=ot,this.pending=!1}schedule(un,ot=0){var Bt;if(this.closed)return this;this.state=un;const Sn=this.id,Qn=this.scheduler;return null!=Sn&&(this.id=this.recycleAsyncId(Qn,Sn,ot)),this.pending=!0,this.delay=ot,this.id=null!==(Bt=this.id)&&void 0!==Bt?Bt:this.requestAsyncId(Qn,this.id,ot),this}requestAsyncId(un,ot,Bt=0){return we.setInterval(un.flush.bind(un,this),Bt)}recycleAsyncId(un,ot,Bt=0){if(null!=Bt&&this.delay===Bt&&!1===this.pending)return ot;null!=ot&&we.clearInterval(ot)}execute(un,ot){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const Bt=this._execute(un,ot);if(Bt)return Bt;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(un,ot){let Sn,Bt=!1;try{this.work(un)}catch(Qn){Bt=!0,Sn=Qn||new Error("Scheduled action threw falsy error")}if(Bt)return this.unsubscribe(),Sn}unsubscribe(){if(!this.closed){const{id:un,scheduler:ot}=this,{actions:Bt}=ot;this.work=this.state=this.scheduler=null,this.pending=!1,(0,Xe.P)(Bt,this),null!=un&&(this.id=this.recycleAsyncId(ot,un,null)),this.delay=null,super.unsubscribe()}}});var It=F(4482),Gt=F(5403);const St=(0,F(7423).fo)("Geolocation",{web:()=>F.e(4561).then(F.bind(F,4561)).then(Nn=>new Nn.GeolocationWeb)});var xt=F(8274),rt=F(6260);function lt(Nn,un){1&Nn&&xt._UZ(0,"ion-icon",13)}function Ce(Nn,un){1&Nn&&xt._UZ(0,"ion-spinner")}function bt(Nn,un){if(1&Nn){const ot=xt.EpF();xt.TgZ(0,"ion-button",3),xt.NdJ("click",function(){xt.CHM(ot);const Sn=xt.oxw();return xt.KtG(Sn.openSideView())}),xt._UZ(1,"ion-icon",14),xt.qZA()}}function kt(Nn,un){1&Nn&&(xt.ynx(0),xt.TgZ(1,"div",15)(2,"p"),xt._uU(3,"There was a problem communicating with Open Charge Map. Please check your data connection."),xt.qZA()(),xt.BQk())}let Ut=(()=>{class Nn{constructor(ot,Bt,Sn,Qn,ci,Un,hi,Ii,yi,Bi,Mi,Ni){this.appManager=ot,this.nav=Bt,this.events=Sn,this.translate=Qn,this.platform=ci,this.poiManager=Un,this.mapping=hi,this.journeyManager=Ii,this.zone=yi,this.modalController=Bi,this.alertController=Mi,this.logging=Ni,this.mapDisplayed=!1,this.initialResultsShown=!1,this.searchOnDemand=!1,this.poiViewMode="modal",this.sideViewAvailable=!1,this.routePlanningMode=!0,this.searchKeyword="",this.appConfig=new Ie.X,this.defaultMapZoom=15,this.defaultStartPos=new pe.wC(37.415328,-122.076575),this._watchId=null,this.mapCanvasID="map-canvas",this.mapping.setMapType(ot.searchSettings.MapType),this.mapping.setMapAPI(he.N.defaultMapProvider),(0,ge.R)(window,"resize").pipe(function Lt(Nn,un=Ee){return(0,It.e)((ot,Bt)=>{let Sn=null,Qn=null,ci=null;const Un=()=>{if(Sn){Sn.unsubscribe(),Sn=null;const Ii=Qn;Qn=null,Bt.next(Ii)}};function hi(){const Ii=ci+Nn,yi=un.now();if(yi<Ii)return Sn=this.schedule(void 0,Ii-yi),void Bt.add(Sn);Un()}ot.subscribe((0,Gt.x)(Bt,Ii=>{Qn=Ii,ci=un.now(),Sn||(Sn=un.schedule(hi,Nn),Bt.add(Sn))},()=>{Un(),Bt.complete()},void 0,()=>{Qn=Sn=null}))})}(500)).subscribe(Vt=>{let Mt={width:ce.c.getClientHeight(),height:ce.c.getClientWidth()};this.events.publish("ocm:window:resized",[Mt])})}ionViewDidEnter(){this.logging.log("Entered search page.",Ke.i.VERBOSE),this.mapping.focusMap(),this.mapping.updateMapSize()}ionViewWillLeave(){this.logging.log("Leaving search page.",Ke.i.VERBOSE),this.mapping.unfocusMap()}getPreferredMapHeight(ot){return null==ot&&(ot=ce.c.getClientHeight()),ot-56}enforceMapHeight(ot){this.logging.log("Would resize map:"+ot.width+" "+ot.height,Ke.i.VERBOSE),this.checkViewportMode();const Bt=this.getPreferredMapHeight(ot[0]);document.getElementById(this.mapCanvasID).offsetHeight!==Bt&&(document.getElementById(this.mapCanvasID).style.height=Bt+"px"),this.mapping&&(this.logging.log("Map height:"+Bt,Ke.i.VERBOSE),this.mapping.updateMapSize())}checkViewportMode(){}initialiseMapping(){var ot=this;return(0,b.Z)(function*(){yield ot.platform.ready(),ot.debouncedRefreshMapResults=ce.c.debounce(ot.refreshMapResults,1e3,!1),ot.events.subscribe("ocm:mapping:ready",(0,b.Z)(function*(){if(ot.logging.log("init map: mapping ready"),ot.mapping&&ot.mapping.updateMapSize(),!ot.initialResultsShown)if(ot.appManager.searchSettings.StartSearchPosition)ot.searchOnDemand=!0,ot.mapping.updateMapCentrePos(ot.appManager.searchSettings.StartSearchPosition.latitude,ot.appManager.searchSettings.StartSearchPosition.longitude,!0,ot.defaultMapZoom);else{let Bt=localStorage.getItem("_locationEnabled");1==ot.appManager.isEmbeddedMode&&"true"!=Bt?yield(yield ot.alertController.create({header:"Search using your location?",message:"Select OK to continue.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:(Qn=(0,b.Z)(function*(ci){yield ot.useFallbackPosition()}),function(Un){return Qn.apply(this,arguments)})},{text:"OK",handler:function(){var Qn=(0,b.Z)(function*(){yield ot.locateUser()});return function(){return Qn.apply(this,arguments)}}()}]})).present():(yield ot.locateUser(),ot.mapping&&ot.mapping.updateMapSize())}var Qn})),ot.events.subscribe("ocm:mapping:zoom",()=>{ot.debouncedRefreshMapResults()}),ot.events.subscribe("ocm:mapping:dragend",()=>{ot.debouncedRefreshMapResults()}),ot.events.subscribe("ocm:poiList:updated",Bt=>{ot.showPOIListOnMap(Bt)}),ot.events.subscribe("ocm:poiList:cleared",()=>{ot.mapping.clearMarkers(),setTimeout(()=>{ot.debouncedRefreshMapResults()},500)}),ot.events.subscribe("ocm:window:resized",Bt=>{null!=Bt&&Bt.length>0&&ot.enforceMapHeight(Bt[0])}),ot.events.subscribe("ocm:poi:selected",Bt=>{if(Bt.poi)ot.viewPOIDetails(Bt,Bt.poi);else{let Sn=ot.getPOIByID(Bt.poiId);ot.viewPOIDetails(Bt,Sn)}}),ot.checkViewportMode(),ot.mapping.initMap(ot.mapCanvasID)})()}ngAfterViewInit(){var ot=this;return(0,b.Z)(function*(){yield ot.initialiseMapping()})()}ngOnInit(){var ot=this;return(0,b.Z)(function*(){ot.logging.log("Refreshing reference data ..",Ke.i.VERBOSE),(yield ot.appManager.referenceDataManager.refreshReferenceData(ot.appManager.api))||(ot.appManager.isOffline=!0)})()}showPOIListOnMap(ot){const Bt=this.getPreferredMapHeight(null);this.mapping.refreshMapView(Bt,this.poiManager.poiList,null),this.mapDisplayed||(this.mapDisplayed=!0)}getIconForPOI(ot){return ce.c.getIconForPOI(ot)}getPOIByID(ot){const Bt=this.poiManager.poiList;for(let Sn=0;Sn<Bt.length;Sn++)if(Bt[Sn].ID===ot)return Bt[Sn];return null}refreshMapResults(){var ot=this;return(0,b.Z)(function*(){if(!ot.searchOnDemand)return void ot.logging.log("Skipping refresh, search on demand disabled..",Ke.i.VERBOSE);ot.logging.log("Refreshing Results..",Ke.i.VERBOSE);const Bt=new ze.b;let Sn=null;if(ot.appManager.searchSettings.StartSearchPosition&&(Sn=new pe.jR(ot.appManager.searchSettings.StartSearchPosition.latitude,ot.appManager.searchSettings.StartSearchPosition.longitude),ot.appManager.searchSettings.StartSearchPosition=null),Sn&&0==Sn.coords.latitude&&0==Sn.coords.longitude)return void ot.logging.log("Map center is zero. No query will be performed",Ke.i.WARNING);if(null!=Sn)Bt.latitude=Sn.coords.latitude,Bt.longitude=Sn.coords.longitude,Bt.distance=25,Bt.boundingbox=null,ot.appManager.searchSettings.LastSearchPosition=new pe.wC(Sn.coords.latitude,Sn.coords.longitude);else{Bt.latitude=null,Bt.longitude=null;let ci=yield ot.mapping.getMapBounds().toPromise();Bt.boundingbox="("+ci[0].latitude+","+ci[0].longitude+"),("+ci[1].latitude+","+ci[1].longitude+")",ot.logging.log(JSON.stringify(ci),Ke.i.VERBOSE)}Bt.includeComments=!0,Bt.enableCaching=!0,null!=ot.appManager.searchSettings&&(null!=ot.appManager.searchSettings.ConnectionTypeList&&(Bt.connectionTypeIdList=ot.appManager.searchSettings.ConnectionTypeList),null!=ot.appManager.searchSettings.UsageTypeList&&(Bt.usageTypeIdList=ot.appManager.searchSettings.UsageTypeList),null!=ot.appManager.searchSettings.StatusTypeList&&(Bt.statusTypeIdList=ot.appManager.searchSettings.StatusTypeList),null!=ot.appManager.searchSettings.OperatorList&&(Bt.operatorIdList=ot.appManager.searchSettings.OperatorList),null!=ot.appManager.searchSettings.MinPowerKW&&ot.appManager.searchSettings.MinPowerKW>0&&(Bt.minPowerKW=ot.appManager.searchSettings.MinPowerKW),null!=ot.appManager.searchSettings.MaxPowerKW&&ot.appManager.searchSettings.MaxPowerKW>0&&(Bt.maxPowerKW=ot.appManager.searchSettings.MaxPowerKW),null!=ot.journeyManager.getRoutePolyline()&&(Bt.polyline=ot.journeyManager.getRoutePolyline(),Bt.boundingbox=null,Bt.levelOfDetail=null,Bt.latitude=null,Bt.longitude=null)),ot.appManager.isRequestInProgress=!0;let Qn=yield ot.poiManager.refreshPOIList(Bt);ot.appManager.isRequestInProgress=!1,ot.initialResultsShown=!0,Qn>=Bt.maxResults&&ot.appManager.showToastNotification("A maximum of "+Qn+" results are returned per search. Zoom in for details.")})()}viewPOIDetails(ot,Bt){this.logging.log("Viewing/fetching ["+this.poiViewMode+"] POI Details "+ot.poiId),null!=Bt?(this.mapping.unfocusMap(),this.modalController.create({component:xe.H,componentProps:{item:Bt}}).then(Sn=>{Sn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),Sn.present()})):this.poiManager.getPOIById(ot.poiId,!0).then(Sn=>{this.logging.log("Got POI Details "+Sn.ID),"modal"===this.poiViewMode&&(this.searchOnDemand=!1,this.modalController.create({component:xe.H,componentProps:{item:Sn}}).then(Qn=>{Qn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),Qn.present()}),this.mapping.unfocusMap()),"side"===this.poiViewMode&&(this.selectedPOI=Sn)},Sn=>{this.appManager.showToastNotification("POI Details not available")})}closePOIDetails(){this.selectedPOI=null}openRoutePlannerModal(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:K.u}).then(ot=>{ot.onDidDismiss().then(Bt=>{this.logging.log("Dismissing Route Planner Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),ot.present()})}openSearchOptions(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:Ve.N}).then(ot=>{ot.onDidDismiss().then(Bt=>{this.mapping.focusMap(),this.searchOnDemand=!0}),ot.present()})}openSideView(){this.poiViewMode="side",this.mapping.updateMapSize()}closeSideView(){this.poiViewMode="modal",this.mapping.updateMapSize()}planRoute(){this.routePlanningMode=!0}search(ot){this.placeSearchMapPOI.getPlacesAutoComplete(ot,"poiSearch")}useFallbackPosition(){let ot=this.defaultStartPos;null!=this.appManager.searchSettings.LastSearchPosition&&(ot=this.appManager.searchSettings.LastSearchPosition),this.appManager.searchSettings.StartSearchPosition=ot,this.appManager.searchSettings.LastSearchPosition=null,this.searchOnDemand=!0,this.mapping.updateMapCentrePos(ot.latitude,ot.longitude,!0,this.defaultMapZoom)}getPosition(ot={}){var Bt=this;return(0,b.Z)(function*(){return new Promise((Sn,Qn)=>{Bt._watchId=St.watchPosition(ot,(ci,Un)=>{Bt._watchId&&St.clearWatch({id:Bt._watchId}),Un?Qn(Un):Sn(ci)})})})()}locateUser(){var ot=this;return(0,b.Z)(function*(){ot.useFallbackPosition();try{ot.logging.log("Attempting to locate user..");const Bt=yield ot.getPosition({timeout:1e4});if(!Bt)throw"Failed to get user location.";return ot.logging.log("Got user location."),ot.appManager.searchSettings.StartSearchPosition=new pe.wC(Bt.coords.latitude,Bt.coords.longitude),ot.searchOnDemand=!0,ot.mapping.updateMapCentrePos(Bt.coords.latitude,Bt.coords.longitude,!0,ot.defaultMapZoom),localStorage.setItem("_locationEnabled","true"),!0}catch(Bt){return ot.logging.log("Failed to get user location. Searching using default or last position."+Bt),ot.appManager.showToastNotification("Your location could not be determined."),ot.useFallbackPosition(),!1}})()}placeSelected(ot){this.searchKeyword=ot.Address,this.logging.log("Got place details:"+ot.Address),this.mapping.focusMap(),this.mapping.updateMapCentrePos(ot.Location.latitude,ot.Location.longitude,!0),this.debouncedRefreshMapResults()}}return Nn.\u0275fac=function(ot){return new(ot||Nn)(xt.Y36(Pt.c),xt.Y36(q.SH),xt.Y36(rt.z),xt.Y36(v.sK),xt.Y36(q.t4),xt.Y36(Je.R),xt.Y36(ne.v),xt.Y36(Pe.i),xt.Y36(xt.R0b),xt.Y36(q.IN),xt.Y36(q.Br),xt.Y36(Ke.z))},Nn.\u0275cmp=xt.Xpm({type:Nn,selectors:[["ng-component"]],viewQuery:function(ot,Bt){if(1&ot&&xt.Gf(at.v,7),2&ot){let Sn;xt.iGM(Sn=xt.CRH())&&(Bt.placeSearchMapPOI=Sn.first)}},decls:18,vars:10,consts:[["slot","start"],["autocapitalize","on","autocomplete","on",3,"ngModel","placeholder","debounce","ngModelChange","ionInput"],["slot","end"],[3,"click"],["name","locate","slot","start",4,"ngIf"],[4,"ngIf"],[3,"color","click"],["name","options","slot","end"],[3,"click",4,"ngIf"],[1,"search-page"],[3,"placeChanged"],["placeSearchMapPOI",""],["id","map-canvas",2,"height","100%","width","100%","min-height","300px"],["name","locate","slot","start"],["name","car","title","Route","slot","end"],[2,"position","absolute"]],template:function(ot,Bt){1&ot&&(xt.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),xt._UZ(3,"ion-menu-button"),xt.qZA(),xt.TgZ(4,"ion-searchbar",1),xt.NdJ("ngModelChange",function(Qn){return Bt.searchKeyword=Qn})("ionInput",function(Qn){return Bt.search(Qn)}),xt.ALo(5,"translate"),xt.qZA(),xt.TgZ(6,"ion-buttons",2)(7,"ion-button",3),xt.NdJ("click",function(){return Bt.locateUser()}),xt.YNc(8,lt,1,0,"ion-icon",4),xt.YNc(9,Ce,1,0,"ion-spinner",5),xt.qZA(),xt.TgZ(10,"ion-button",6),xt.NdJ("click",function(){return Bt.openSearchOptions()}),xt._UZ(11,"ion-icon",7),xt.qZA(),xt.YNc(12,bt,2,0,"ion-button",8),xt.qZA()()(),xt.TgZ(13,"ion-content",9)(14,"place-search",10,11),xt.NdJ("placeChanged",function(Qn){return Bt.placeSelected(Qn)}),xt.qZA(),xt.YNc(16,kt,4,0,"ng-container",5),xt._UZ(17,"div",12),xt.qZA()),2&ot&&(xt.xp6(4),xt.Q6J("ngModel",Bt.searchKeyword)("placeholder",xt.lcZ(5,8,"ocm.search.performSearch"))("debounce",500),xt.xp6(4),xt.Q6J("ngIf",!Bt.appManager.isRequestInProgress),xt.xp6(1),xt.Q6J("ngIf",Bt.appManager.isRequestInProgress),xt.xp6(1),xt.Q6J("color",Bt.appManager.searchSettings.HasActiveFilters?"danger":"default"),xt.xp6(2),xt.Q6J("ngIf",1==Bt.sideViewAvailable&&"modal"==Bt.poiViewMode),xt.xp6(4),xt.Q6J("ngIf",Bt.appManager.isOffline))},dependencies:[re.O5,a.JJ,a.On,q.YG,q.Sm,q.W2,q.Gu,q.gu,q.fG,q.VI,q.PQ,q.sr,q.j9,at.v,v.X$],styles:[".search-page[_ngcontent-%COMP%]   #map-canvas[_ngcontent-%COMP%]{width:100%;height:98%}.search-page[_ngcontent-%COMP%]   #place-search[_ngcontent-%COMP%]{min-height:300px;background-color:#f0f0f0;position:absolute;z-index:100;width:100%}.search-page[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{flex:.4}.search-page[_ngcontent-%COMP%]   ion-grid[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%], .search-page[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]{padding:0}.search-page[_ngcontent-%COMP%]   scroll-content[_ngcontent-%COMP%]{overflow-y:hidden}.search-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{padding-left:2em}.search-page[_ngcontent-%COMP%]   .sideview[_ngcontent-%COMP%]{background:rgb(238,238,238);background:linear-gradient(to bottom,rgb(238,238,238) 0%,rgb(255,255,255) 100%)}"]}),Nn})(),bn=(()=>{class Nn{}return Nn.\u0275fac=function(ot){return new(ot||Nn)},Nn.\u0275mod=xt.oAB({type:Nn}),Nn.\u0275inj=xt.cJS({imports:[re.ez,a.u5,q.Pc,v.aw,d.e,oe.Bz.forChild([{path:"",component:Ut}])]}),Nn})()},6314:(Ln,Dt,F)=>{"use strict";F.d(Dt,{N:()=>ge});var d=F(5861),v=F(9698),re=F(3855),a=F(7627),q=F(6579),oe=F(4781),b=F(8274),he=F(425),Ie=F(6260),Ve=F(6895),K=F(4006),xe=F(4463);let pe=(()=>{class ke extends xe.X${constructor(we,Xe){super(we,Xe)}transform(we,...Xe){let He=super.transform(we,...Xe);return He==we?null!=Xe&&Xe[0].default?Xe[0].default:Xe[0].Title?Xe[0].Title:He:He}}return ke.\u0275fac=function(we){return new(we||ke)(b.Y36(xe.sK,16),b.Y36(b.sBO,16))},ke.\u0275pipe=b.Yjl({name:"nullableTranslate",type:ke,pure:!0}),ke.\u0275prov=b.Yz7({token:ke,factory:ke.\u0275fac}),ke})();function ze(ke,Le){if(1&ke){const we=b.EpF();b.TgZ(0,"p",21),b._UZ(1,"ion-icon",22),b._uU(2," One or more filters are currently being applied. "),b.TgZ(3,"ion-button",23),b.NdJ("click",function(){b.CHM(we);const He=b.oxw();return b.KtG(He.clearFilters())}),b._UZ(4,"ion-icon",24),b.TgZ(5,"ion-label"),b._uU(6,"Clear"),b.qZA()()()}}function ce(ke,Le){if(1&ke&&(b.TgZ(0,"ion-select-option",26),b._uU(1),b.qZA()),2&ke){const we=Le.$implicit;b.Q6J("value",we.ID),b.xp6(1),b.Oqu(we.Title)}}function Ke(ke,Le){if(1&ke){const we=b.EpF();b.TgZ(0,"ion-item")(1,"ion-label"),b._uU(2),b.ALo(3,"translate"),b.qZA(),b.TgZ(4,"ion-select",14),b.NdJ("ngModelChange",function(He){b.CHM(we);const me=b.oxw();return b.KtG(me.searchSettings.FilterOptionsByCountryId=He)})("ionChange",function(){b.CHM(we);const He=b.oxw();return b.KtG(He.onCountryChange())}),b.TgZ(5,"ion-select",25),b._uU(6,"(All Countries)"),b.qZA(),b.YNc(7,ce,2,2,"ion-select-option",4),b.qZA()()}if(2&ke){const we=b.oxw();b.xp6(2),b.Oqu(b.lcZ(3,3,"ocm.search.countries")),b.xp6(2),b.Q6J("ngModel",we.searchSettings.FilterOptionsByCountryId),b.xp6(3),b.Q6J("ngForOf",we.countries)}}function Pe(ke,Le){if(1&ke&&(b.TgZ(0,"ion-select-option",26),b._uU(1),b.ALo(2,"nullableTranslate"),b.qZA()),2&ke){const we=Le.$implicit;b.Q6J("value",we.ID),b.xp6(1),b.Oqu(b.xi3(2,2,"ocm.reference.operatorInfo.value_"+we.ID,we))}}function ne(ke,Le){if(1&ke&&(b.TgZ(0,"ion-select-option",26),b._uU(1),b.ALo(2,"nullableTranslate"),b.qZA()),2&ke){const we=Le.$implicit;b.Q6J("value",we.ID),b.xp6(1),b.Oqu(b.xi3(2,2,"ocm.reference.usageType.value_"+we.ID,we))}}function Je(ke,Le){if(1&ke&&(b.TgZ(0,"ion-select-option",26),b._uU(1),b.ALo(2,"nullableTranslate"),b.qZA()),2&ke){const we=Le.$implicit;b.Q6J("value",we.ID),b.xp6(1),b.Oqu(b.xi3(2,2,"ocm.reference.statusType.value_"+we.ID,we))}}function Pt(ke,Le){if(1&ke&&(b.TgZ(0,"ion-select-option",26),b._uU(1),b.ALo(2,"nullableTranslate"),b.qZA()),2&ke){const we=Le.$implicit;b.Q6J("value",we.ID),b.xp6(1),b.Oqu(b.xi3(2,2,"ocm.reference.connectionType.value_"+we.ID,we))}}function at(ke,Le){if(1&ke&&(b.TgZ(0,"ion-select-option",26),b._uU(1),b.qZA()),2&ke){const we=Le.$implicit;b.Q6J("value",we.code),b.xp6(1),b.Oqu(we.title)}}let ge=(()=>{class ke{constructor(we,Xe,He,me,de){this.appManager=we,this.poiManager=Xe,this.mapping=He,this.modalController=me,this.events=de,this.maxPower=a.U,this.powerRange={lower:0,upper:this.maxPower},this._languages=[],this.searchSettings=we.searchSettings}ngOnInit(){var we=this;return(0,d.Z)(function*(){null!=we.searchSettings.MinPowerKW&&(we.powerRange.lower=we.searchSettings.MinPowerKW),null!=we.searchSettings.MaxPowerKW&&(we.powerRange.upper=we.searchSettings.MaxPowerKW),0==we.powerRange.upper&&(we.powerRange.upper=we.maxPower),we.appManager.analytics.viewEvent("Settings"),we.useFilteredOptions&&(yield we.onCountryChange())})()}get useFilteredOptions(){return this.searchSettings.FilterOptionsByCountryId>0}clearFilters(){this.searchSettings.ClearActiveFilters(),this.powerRange={lower:0,upper:this.maxPower},this.searchSettings.CheckForActiveFilters()}get operators(){return this.appManager.referenceDataManager.getNetworkOperators(this.useFilteredOptions)}get connectionTypes(){return this.appManager.referenceDataManager.getConnectionTypes(this.useFilteredOptions)}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes(this.useFilteredOptions)}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes(this.useFilteredOptions)}get countries(){return this.appManager.referenceDataManager.getCountries(this.useFilteredOptions)}get isCountryFilterFeatureEnabled(){return q.c.isFeatureEnabled("FILTER_OPTIONS_BY_COUNTRY")}get languages(){return this._languages.length>0||(this._languages=this.appManager.getLanguages()),this._languages}ionViewWillLeave(){null!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language),this.searchSettings.MinPowerKW=this.powerRange.lower,this.searchSettings.MaxPowerKW=this.powerRange.upper,1==this.searchSettings.MinPowerKW&&(this.searchSettings.MinPowerKW=null),this.searchSettings.MaxPowerKW==this.maxPower&&(this.searchSettings.MaxPowerKW=null),this.appManager.searchSettings=this.searchSettings,this.appManager.saveSearchSettings(),this.events.publish("ocm:poiList:cleared")}onLanguageChange(){null!=this.searchSettings.Language&&""!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language)}onCountryChange(){var we=this;return(0,d.Z)(function*(){we.appManager.referenceDataManager.refreshFilteredReferenceData(we.appManager.api,{CountryIds:[we.searchSettings.FilterOptionsByCountryId]})})()}onMapTypeChange(){var we=this;return(0,d.Z)(function*(){we.mapping.setMapType(we.searchSettings.MapType)})()}close(){this.modalController.dismiss()}}return ke.\u0275fac=function(we){return new(we||ke)(b.Y36(re.c),b.Y36(v.R),b.Y36(oe.v),b.Y36(he.IN),b.Y36(Ie.z))},ke.\u0275cmp=b.Xpm({type:ke,selectors:[["ng-component"]],decls:77,vars:38,consts:[[1,"settings-page","ion-padding"],["danger","",4,"ngIf"],[4,"ngIf"],["multiple","true","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["lines","none"],["dualKnobs","true","min","0","max","650","pin","true",3,"ngModel","ngModelChange"],["slot","start","size","small","name","flash"],["slot","end","name","flash"],["slot","start",2,"padding-top","0"],["type","number","min","0",2,"width","3em","border","none",3,"ngModel","max","ngModelChange"],["slot","end",2,"padding-top","0"],["type","number",2,"width","3em","border","none",3,"ngModel","max","min","ngModelChange"],["multiple","false",3,"ngModel","ngModelChange","ionChange"],["multiple","false","cancelText","Cancel","okText","OK",3,"ngModel","ngModelChange","ionChange"],["value","ROADMAP"],["value","SATELLITE"],[3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","close","slot","start"],["danger",""],["name","alert"],["size","small","color","light",3,"click"],["slot","start","name","close"],["value",""],[3,"value"]],template:function(we,Xe){1&we&&(b.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),b._uU(3),b.ALo(4,"translate"),b.qZA()()(),b.TgZ(5,"ion-content",0)(6,"h2"),b._uU(7,"Search Filters"),b.qZA(),b.TgZ(8,"p"),b._uU(9,"Note: Filters will remove usable charging locations from your search results if we do not have complete data (i.e Operator or Power Levels)."),b.qZA(),b.YNc(10,ze,7,0,"p",1),b.TgZ(11,"ion-list"),b.YNc(12,Ke,8,5,"ion-item",2),b.TgZ(13,"ion-item")(14,"ion-label"),b._uU(15),b.ALo(16,"translate"),b.qZA(),b.TgZ(17,"ion-select",3),b.NdJ("ngModelChange",function(me){return Xe.searchSettings.OperatorList=me}),b.YNc(18,Pe,3,5,"ion-select-option",4),b.qZA()(),b.TgZ(19,"ion-item")(20,"ion-label"),b._uU(21),b.ALo(22,"translate"),b.qZA(),b.TgZ(23,"ion-select",3),b.NdJ("ngModelChange",function(me){return Xe.searchSettings.UsageTypeList=me}),b.YNc(24,ne,3,5,"ion-select-option",4),b.qZA()(),b.TgZ(25,"ion-item")(26,"ion-label"),b._uU(27),b.ALo(28,"translate"),b.qZA(),b.TgZ(29,"ion-select",3),b.NdJ("ngModelChange",function(me){return Xe.searchSettings.StatusTypeList=me}),b.YNc(30,Je,3,5,"ion-select-option",4),b.qZA()(),b.TgZ(31,"ion-item")(32,"ion-label"),b._uU(33),b.ALo(34,"translate"),b.qZA(),b.TgZ(35,"ion-select",3),b.NdJ("ngModelChange",function(me){return Xe.searchSettings.ConnectionTypeList=me}),b.YNc(36,Pt,3,5,"ion-select-option",4),b.qZA()(),b.TgZ(37,"ion-item",5)(38,"ion-range",6),b.NdJ("ngModelChange",function(me){return Xe.powerRange=me}),b.TgZ(39,"ion-icon",7),b._uU(40,"0"),b.qZA(),b._UZ(41,"ion-icon",8),b.qZA()(),b.TgZ(42,"ion-item",5)(43,"ion-note",9),b._uU(44,"Min. Power (kW)"),b._UZ(45,"br"),b.TgZ(46,"input",10),b.NdJ("ngModelChange",function(me){return Xe.powerRange.lower=me}),b.qZA()(),b.TgZ(47,"ion-note",11),b._uU(48,"Max. Power (kW)"),b._UZ(49,"br"),b.TgZ(50,"input",12),b.NdJ("ngModelChange",function(me){return Xe.powerRange.upper=me}),b.qZA()()()(),b.TgZ(51,"h2"),b._uU(52," General Settings "),b.qZA(),b.TgZ(53,"ion-item")(54,"ion-label"),b._uU(55,"Language"),b.qZA(),b.TgZ(56,"ion-select",13),b.NdJ("ngModelChange",function(me){return Xe.searchSettings.Language=me})("ionChange",function(){return Xe.onLanguageChange()}),b.YNc(57,at,2,2,"ion-select-option",4),b.qZA()(),b.TgZ(58,"ion-item")(59,"ion-label"),b._uU(60),b.ALo(61,"translate"),b.qZA(),b.TgZ(62,"ion-select",14),b.NdJ("ngModelChange",function(me){return Xe.searchSettings.MapType=me})("ionChange",function(){return Xe.onMapTypeChange()}),b.TgZ(63,"ion-select-option",15),b._uU(64,"Road Map"),b.qZA(),b.TgZ(65,"ion-select-option",16),b._uU(66,"Satellite"),b.qZA()()(),b.TgZ(67,"ion-item")(68,"ion-label"),b._uU(69,"Enable Advanced Editor Options"),b.qZA(),b.TgZ(70,"ion-toggle",17),b.NdJ("ngModelChange",function(me){return Xe.searchSettings.EnableAdvancedEditorFeatures=me}),b.qZA()()(),b.TgZ(71,"ion-footer")(72,"ion-toolbar")(73,"ion-buttons",18)(74,"ion-button",19),b.NdJ("click",function(){return Xe.close()}),b._UZ(75,"ion-icon",20),b._uU(76," Close "),b.qZA()()()()),2&we&&(b.xp6(3),b.hij(" ",b.lcZ(4,26,"ocm.general.settings")," "),b.xp6(7),b.Q6J("ngIf",1==Xe.searchSettings.HasActiveFilters),b.xp6(2),b.Q6J("ngIf",Xe.isCountryFilterFeatureEnabled),b.xp6(3),b.Oqu(b.lcZ(16,28,"ocm.search.networkOperators")),b.xp6(2),b.Q6J("ngModel",Xe.searchSettings.OperatorList),b.xp6(1),b.Q6J("ngForOf",Xe.operators),b.xp6(3),b.Oqu(b.lcZ(22,30,"ocm.search.usageTypes")),b.xp6(2),b.Q6J("ngModel",Xe.searchSettings.UsageTypeList),b.xp6(1),b.Q6J("ngForOf",Xe.usageTypes),b.xp6(3),b.Oqu(b.lcZ(28,32,"ocm.search.operationalStatusTypes")),b.xp6(2),b.Q6J("ngModel",Xe.searchSettings.StatusTypeList),b.xp6(1),b.Q6J("ngForOf",Xe.statusTypes),b.xp6(3),b.Oqu(b.lcZ(34,34,"ocm.search.connectionTypes")),b.xp6(2),b.Q6J("ngModel",Xe.searchSettings.ConnectionTypeList),b.xp6(1),b.Q6J("ngForOf",Xe.connectionTypes),b.xp6(2),b.Q6J("ngModel",Xe.powerRange),b.xp6(8),b.Q6J("ngModel",Xe.powerRange.lower)("max",Xe.powerRange.upper),b.xp6(4),b.Q6J("ngModel",Xe.powerRange.upper)("max",Xe.maxPower)("min",Xe.powerRange.lower),b.xp6(6),b.Q6J("ngModel",Xe.searchSettings.Language),b.xp6(1),b.Q6J("ngForOf",Xe.languages),b.xp6(3),b.Oqu(b.lcZ(61,36,"ocm.details.location.map")),b.xp6(2),b.Q6J("ngModel",Xe.searchSettings.MapType),b.xp6(8),b.Q6J("ngModel",Xe.searchSettings.EnableAdvancedEditorFeatures))},dependencies:[Ve.sg,Ve.O5,K.Fj,K.wV,K.JJ,K.qQ,K.Fd,K.On,he.YG,he.Sm,he.W2,he.fr,he.Gu,he.gu,he.Ie,he.Q$,he.q_,he.uN,he.I_,he.t9,he.n0,he.wd,he.ho,he.sr,he.w,he.QI,xe.X$,pe],encapsulation:2}),ke})()},6779:(Ln,Dt,F)=>{"use strict";F.r(Dt),F.d(Dt,{SignInModule:()=>Ie});var d=F(9492),v=F(8936),re=F(4463),a=F(6895),q=F(4006),oe=F(425),b=F(4228),he=F(8274);let Ie=(()=>{class Ve{}return Ve.\u0275fac=function(xe){return new(xe||Ve)},Ve.\u0275mod=he.oAB({type:Ve}),Ve.\u0275inj=he.cJS({imports:[a.ez,q.u5,oe.Pc,re.aw,v.e,b.Bz.forChild([{path:"",component:d.F}])]}),Ve})()},9492:(Ln,Dt,F)=>{"use strict";F.d(Dt,{F:()=>Ve});var d=F(5861),v=F(7689),re=F(3855),a=F(8274),q=F(425),oe=F(4463),b=F(4228),he=F(6895),Ie=F(4006);let Ve=(()=>{class K{constructor(pe,ze,ce,Ke,Pe,ne,Je,Pt){this.appManager=pe,this.modalController=ze,this.translate=ce,this.alertController=Ke,this.loadingController=Pe,this.logging=ne,this.router=Je,this.location=Pt,this.email=""}cancelSignIn(){this.modalController.dismiss()}performSignIn(){var pe=this;return(0,d.Z)(function*(){const ze=yield pe.loadingController.create({message:"Signing In.."});yield ze.present();let ce=!1;try{yield pe.appManager.api.performSignIn(pe.email,pe.password),ze.dismiss(),localStorage.setItem("authResponse",JSON.stringify(pe.appManager.api.authResponse)),pe.appManager.isUserAuthenticated(!0),pe.modalController.dismiss(),pe.appManager.analytics.appEvent("Profile","SignedIn")}catch(Ke){ce=!0,ze.dismiss(),yield(yield pe.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),pe.logging.log("Error logging in:"+Ke)}})()}}return K.\u0275fac=function(pe){return new(pe||K)(a.Y36(re.c),a.Y36(q.IN),a.Y36(oe.sK),a.Y36(q.Br),a.Y36(q.HT),a.Y36(v.z),a.Y36(b.F0),a.Y36(he.Ye))},K.\u0275cmp=a.Xpm({type:K,selectors:[["ng-component"]],decls:37,vars:8,consts:[[1,"signin-page","ion-padding"],["item-left",""],["src","assets/images/icons/branding/AppIcon_128x128.png"],[1,"ion-padding"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"],[3,"click"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["type","submit","color","primary",3,"click"],["name","log-in","slot","start"]],template:function(pe,ze){1&pe&&(a.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),a._uU(3),a.ALo(4,"translate"),a.qZA()()(),a.TgZ(5,"ion-content",0)(6,"ion-avatar",1),a._UZ(7,"img",2),a.qZA(),a.TgZ(8,"p",3),a._uU(9," Sign in using your Open Charge Map account. "),a.qZA(),a.TgZ(10,"ion-list")(11,"ion-item")(12,"ion-label",4),a._uU(13,"Email"),a.qZA(),a.TgZ(14,"ion-input",5),a.NdJ("ngModelChange",function(Ke){return ze.email=Ke}),a.qZA()(),a.TgZ(15,"ion-item")(16,"ion-label",4),a._uU(17,"Password"),a.qZA(),a.TgZ(18,"ion-input",6),a.NdJ("ngModelChange",function(Ke){return ze.password=Ke}),a.qZA()()(),a.TgZ(19,"p"),a._uU(20,"or "),a.TgZ(21,"a",7),a.NdJ("click",function(){return ze.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/register")}),a._uU(22,"Register as New User"),a.qZA(),a._uU(23," or "),a.TgZ(24,"a",7),a.NdJ("click",function(){return ze.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/passwordreset")}),a._uU(25,"Reset your password"),a.qZA()()(),a.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",8)(29,"ion-button",7),a.NdJ("click",function(){return ze.cancelSignIn()}),a._UZ(30,"ion-icon",9),a._uU(31," Cancel"),a.qZA()(),a.TgZ(32,"ion-buttons",10)(33,"ion-button",11),a.NdJ("click",function(){return ze.performSignIn()}),a._UZ(34,"ion-icon",12),a._uU(35),a.ALo(36,"translate"),a.qZA()()()()),2&pe&&(a.xp6(3),a.hij(" ",a.lcZ(4,4,"ocm.general.signIn")," "),a.xp6(11),a.Q6J("ngModel",ze.email),a.xp6(4),a.Q6J("ngModel",ze.password),a.xp6(17),a.hij(" ",a.lcZ(36,6,"ocm.general.signIn"),""))},dependencies:[Ie.JJ,Ie.On,q.BJ,q.YG,q.Sm,q.W2,q.fr,q.Gu,q.gu,q.pK,q.Ie,q.Q$,q.q_,q.wd,q.sr,q.j9,oe.X$],encapsulation:2}),K})()},7814:(Ln,Dt,F)=>{"use strict";F.d(Dt,{l:()=>he});var d=F(5861),v=F(7689),re=F(6799),a=F(8649),q=F(529),oe=F(2340),b=F(8274);let he=(()=>{class Ie{constructor(K,xe,pe){this.http=K,this.refData=xe,this.logging=pe,this.serviceBase="https://api.openchargemap.io",this.serviceBaseURL=this.serviceBase+"/v3",this.hasAuthorizationError=!1,this.ATTRIBUTION_METADATAFIELDID=4,this.clientName="ocm.api.default",this.allowMirror=!1,this.lastPOIApiCallURL="",this.serviceBaseURL=oe.N.apiBase+"/v3"}getNumberListString(K){let xe="";for(let pe=0;pe<K.length;pe++)xe+=K[pe],pe<K.length&&(xe+=",");return xe}fetchPOIListByParam(K){var xe=this;return(0,d.Z)(function*(){const pe=xe.serviceBaseURL+"/poi/?client="+xe.clientName+(xe.allowMirror?" &allowmirror=true":"")+"&verbose=false&output=json";K.compact=!0;let ze="";null!=K.countryCode&&(ze+="&countrycode="+K.countryCode),null!=K.latitude&&(ze+="&latitude="+K.latitude),null!=K.longitude&&(ze+="&longitude="+K.longitude),null!=K.distance&&(ze+="&distance="+K.distance),null!=K.distanceUnit&&(ze+="&distanceunit="+K.distanceUnit),null!=K.includeComments&&(ze+="&includecomments="+K.includeComments),null!=K.maxResults&&(ze+="&maxresults="+K.maxResults),null!=K.countryIdList&&(ze+="&countryid="+xe.getNumberListString(K.countryIdList)),null!=K.levelIdList&&(ze+="&levelid="+xe.getNumberListString(K.levelIdList)),null!=K.connectionTypeIdList&&K.connectionTypeIdList.length>0&&(ze+="&connectiontypeid="+xe.getNumberListString(K.connectionTypeIdList)),null!=K.operatorIdList&&K.operatorIdList.length>0&&(ze+="&operatorid="+xe.getNumberListString(K.operatorIdList)),null!=K.usageTypeIdList&&K.usageTypeIdList.length>0&&(ze+="&usagetypeid="+xe.getNumberListString(K.usageTypeIdList)),null!=K.statusTypeIdList&&K.statusTypeIdList.length>0&&(ze+="&statustypeid="+xe.getNumberListString(K.statusTypeIdList)),null!=K.locationTitle&&(ze+="&locationtitle="+K.locationTitle),null!=K.minPowerKW&&K.minPowerKW>0&&(ze+="&minpowerkw="+K.minPowerKW),null!=K.maxPowerKW&&K.maxPowerKW>0&&(ze+="&maxpowerkw="+K.maxPowerKW),null!=K.submissionStatusTypeIdList&&(ze+="&submissionstatustypeid="+xe.getNumberListString(K.submissionStatusTypeIdList)),null!=K.poiIdList&&K.poiIdList.length>0&&(ze+="&chargepointid="+xe.getNumberListString(K.poiIdList)),0==K.enableCaching&&(ze+="&enablecaching=false"),null!=K.compact&&(ze+="&compact="+K.compact),K.levelOfDetail>1&&(ze+="&levelofdetail="+K.levelOfDetail),null!=K.polyline&&(ze+="&polyline="+K.polyline),null!=K.boundingbox&&(ze+="&boundingbox="+K.boundingbox),null!=K.additionalParams&&(ze+="&"+K.additionalParams);const ce=pe+ze;if(xe.lastPOIApiCallURL===ce&&0!=K.enableCaching)return xe.logging.log("Skipped API call due to same query being repeated."),[];xe.lastPOIApiCallURL=ce,xe.logging.log("API Call:"+ce,v.i.VERBOSE);try{let Ke=yield xe.http.get(ce,xe.getHttpRequestOptions()).toPromise();return xe.refData.hydrateCompactPOIList(Ke)}catch(Ke){const Pe=Ke.message||"Could not fetch POI list from server.";throw xe.logging.log("API Client: "+JSON.stringify(Ke),v.i.ERROR),Pe}})()}getHttpRequestOptions(K=!0){let xe=new q.WM;return K&&(xe=xe.append("Content-Type","application/json")),this.authResponse&&this.authResponse.Data&&this.authResponse.Data.access_token&&(xe=xe.append("Authorization","Bearer "+this.authResponse.Data.access_token)),xe=xe.append("X-API-Key",oe.N.apiKey),{headers:xe}}fetchCoreReferenceData(K){let xe=this.serviceBaseURL+"/referencedata/?client="+this.clientName+"&output=json"+(this.allowMirror?"&allowmirror=true":"")+"&verbose=false&compact=true";return null!=K&&null!=K.CountryIds&&(xe+="&countryid="+this.getNumberListString(K.CountryIds)),this.logging.log("API Call:"+xe,v.i.VERBOSE),this.http.get(xe,this.getHttpRequestOptions())}performSignIn(K,xe){return this.http.post(this.serviceBaseURL+"/profile/authenticate/",JSON.stringify({emailaddress:K,password:xe}),this.getHttpRequestOptions()).toPromise().then(ce=>(this.authResponse=ce,this.authResponse))}performSubmission(K,xe){return K===a.q.POI?this.submitPOI(xe):K===a.q.Comment?this.submitUserComment(xe):K===a.q.Media?this.submitMediaItem(xe):void 0}submitUserComment(K){const xe=JSON.stringify(K);return this.logging.log("[api] Submitting user comment"),this.http.post(this.serviceBaseURL+"/comment/",xe,this.getHttpRequestOptions()).toPromise()}submitMediaItem(K){const xe=JSON.stringify(K);return this.http.post(this.serviceBaseURL+"/mediaitem/",xe,this.getHttpRequestOptions()).toPromise()}submitPOI(K){const xe=JSON.stringify(K);return this.http.post(this.serviceBaseURL+"/poi/",xe,this.getHttpRequestOptions()).toPromise()}getPanoramioLocationPhotos(K){return new Promise(xe=>{const ze="https://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=2&minx="+(K.longitude-.001)+"&miny="+(K.latitude-.001)+"&maxx="+(K.longitude+.001)+"maxy="+(K.latitude+.001)+"&size=medium&mapfilter=true&callback=?";return console.log(ze),this.http.get(ze).toPromise()})}fetchReverseGeocodeResult(K,xe){return this.http.get(this.serviceBaseURL+"/geocode/?client="+this.clientName+"&output=json&camelcase=false&latitude="+K+"&longitude="+xe,this.getHttpRequestOptions()).toPromise()}isLocalStorageAvailable(){return typeof window.localStorage<"u"}setCachedDataObject(K,xe){this.isLocalStorageAvailable()&&(typeof xe>"u"&&(xe=null),null===xe?localStorage.removeItem(K):localStorage.setItem(K,JSON.stringify(xe)))}getCachedDataObject(K){if(this.isLocalStorageAvailable()){const xe=localStorage.getItem(K);if(null!=xe&&xe.length>0)return JSON.parse(xe)}return null}}return Ie.\u0275fac=function(K){return new(K||Ie)(b.LFG(q.eN),b.LFG(re.W),b.LFG(v.z))},Ie.\u0275prov=b.Yz7({token:Ie,factory:Ie.\u0275fac,providedIn:"root"}),Ie})()},56:(Ln,Dt,F)=>{"use strict";F.d(Dt,{c:()=>q});var d=F(5861),v=F(7689),re=F(8274),a=F(425);let q=(()=>{class oe{constructor(he,Ie){this.logger=he,this.platform=Ie,this.isCordova=!1,this.ga=null,this.isCordova=!(!Ie.is("cordova")&&!Ie.is("capacitor"))}init(he){var Ie=this;return(0,d.Z)(function*(){Ie.isCordova&&Ie.ga?yield Ie.ga.startTrackerWithId(he):Ie.logger.log("Could not initialise analytics")})()}setAppVersion(he){var Ie=this;return(0,d.Z)(function*(){if(Ie.isCordova&&Ie.ga)return Ie.ga.setAppVersion(he);Ie.logger.log(he)})()}appEvent(he,Ie){var Ve=this;return(0,d.Z)(function*(){if(Ve.isCordova&&Ve.ga)return Ve.ga.trackEvent(he,Ie);Ve.logger.log(Ie)})()}viewEvent(he){var Ie=this;return(0,d.Z)(function*(){if(Ie.isCordova&&Ie.ga)return Ie.ga.trackView(he);Ie.logger.log(he)})()}}return oe.\u0275fac=function(he){return new(he||oe)(re.LFG(v.z),re.LFG(a.t4))},oe.\u0275prov=re.Yz7({token:oe,factory:oe.\u0275fac,providedIn:"root"}),oe})()},3855:(Ln,Dt,F)=>{"use strict";F.d(Dt,{c:()=>Je});var d=F(5861),v=F(7689),re=F(7814),a=F(7627),q=F(4120),oe=F(8649),b=F(6799),he=F(3912),Ie=F(56),Ve=F(2340),K=F(8274),xe=F(529),pe=F(6260);class ze{constructor(at,ge){this.SubmissionType=at,this.Data=ge,this.DateQueued=new Date,this.IsSubmitted=!1,this.IsInProgress=!1,this.IsCancelled=!1,this.IsFailure=!1,this.Attempts=0,this.ID=new Date+"_"+100*Math.random()}}let ce=(()=>{class Pt{constructor(ge){this.events=ge,this.isQueueProcessing=!1}setAppManager(ge){this.appManager=ge}add(ge,ke){let Le=this.getQueueItems();Le.push(new ze(ge,ke)),this.saveQueueItems(Le)}update(ge){let ke=this.getQueueItems(),Le=new Array;return ke.forEach(we=>{Le.push(we.ID==ge.ID?ge:we)}),Le}processNextQueueItem(){let ge=this.getNextQueueItem();null!=ge&&null!=this.appManager&&this.appManager.api.performSubmission(ge.SubmissionType,ge.Data).then(()=>{ge.IsSubmitted=!0,ge.Attempts++,this.update(ge),this.clear()})}getNextQueueItem(){let ge=this.getQueueItems(),ke=null;return ge.forEach(Le=>{null==ke&&!Le.IsCancelled&&!Le.IsInProgress&&!Le.IsSubmitted&&(ke=Le)}),ke}hasPendingItems(){let ge=!1;return this.getQueueItems().forEach(Le=>{!Le.IsFailure&&!Le.IsCancelled&&!Le.IsSubmitted&&(ge=!0)}),ge}isCompleted(){let ge=this.getQueueItems(),ke=!0;return ge.forEach(Le=>{(Le.IsInProgress||Le.IsFailure)&&(ke=!1)}),ke}clear(ge=!1){let ke=this.getQueueItems(),Le=new Array;ge||ke.forEach(we=>{(we.IsInProgress||we.IsFailure)&&Le.push(we)}),this.saveQueueItems(Le)}saveQueueItems(ge){localStorage.setItem("submissionQueue",JSON.stringify(ge))}getQueueItems(){let ge=localStorage.getItem("submissionQueue");return null!=ge?JSON.parse(ge):new Array}}return Pt.\u0275fac=function(ge){return new(ge||Pt)(K.LFG(pe.z))},Pt.\u0275prov=K.Yz7({token:Pt,factory:Pt.\u0275fac,providedIn:"root"}),Pt})();var Ke=F(425),Pe=F(4463),ne=F(3175);let Je=(()=>{class Pt{constructor(ge,ke,Le,we,Xe,He,me,de,se,Ee,_t,It,Gt){this.http=ge,this.events=ke,this.api=Le,this.submissionQueue=we,this.platform=Xe,this.referenceDataManager=He,this.journeyManager=me,this.translateService=de,this.toastController=se,this.loadingController=Ee,this.jwtHelper=_t,this.logging=It,this.analytics=Gt,this.isRequestInProgress=!1,this.title="Open Charge Map",this._isUserAuthenticated=null,this.isEmbeddedMode=!1,this.isOffline=!1,this.api.clientName="ocm.app.ionic."+Ve.N.version,this.isDebugMode=!1,this.enableSubmissionQueue=!1,this.submissionQueue.setAppManager(this),this.platformMode=Xe.is("cordova")?"cordova":"web",this.initAppManager(),this.searchSettings=new a.N,this.loadSearchSettings(),this.applyURLQueryStringOptions(),this.searchSettings.CheckForActiveFilters(),this.journeyManager.loadJourneys()}loadSearchSettings(){if(null!=localStorage.getItem("searchSettings")){this.searchSettings=new a.N;try{let ge=JSON.parse(localStorage.getItem("searchSettings"));Object.assign(this.searchSettings,ge)}catch{}}}savePushRegistration(ge){localStorage.setItem("_pushToken",ge.toString())}getPushRegistration(){localStorage.getItem("_pushToken")}getQueryVariable(ge){let Le=window.location.search.substring(1).split("&");for(let we=0;we<Le.length;we++){let Xe=Le[we].split("=");if(decodeURIComponent(Xe[0])==ge)return Xe[1].split(",").map(de=>decodeURIComponent(de))}return null}applyURLQueryStringOptions(){if(this.getQueryVariable("mode")&&"embedded"==this.getQueryVariable("mode")[0]&&(this.isEmbeddedMode=!0),this.getQueryVariable("operatorid")){let ge=this.getQueryVariable("operatorid");for(let ke of ge)this.searchSettings.OperatorList.unshift(parseInt(ke,10))}if(this.getQueryVariable("latitude")&&this.getQueryVariable("longitude")){let ge=this.getQueryVariable("latitude")[0],ke=this.getQueryVariable("longitude")[0];this.searchSettings.StartSearchPosition=new q.wC(parseFloat(ge),parseFloat(ke))}this.getQueryVariable("title")&&(this.title=this.getQueryVariable("title")[0]),this.getQueryVariable("languagecode")&&this.setLanguage(this.getQueryVariable("languagecode")[0])}saveSearchSettings(){this.searchSettings.CheckForActiveFilters(),localStorage.setItem("searchSettings",JSON.stringify(this.searchSettings))}getLanguages(){return[{code:"ar",title:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 / Arabic"},{code:"bg",title:"Bulgarian / \u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",title:"Czech / \u010ce\u0161tina"},{code:"de",title:"German / Deutsch"},{code:"el",title:"Greek / \u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ae"},{code:"en",title:"English"},{code:"es",title:"Spanish / Espa\xf1ol"},{code:"et",title:"Estonian / Eesti"},{code:"fi",title:"Finnish / Suomi"},{code:"fr",title:"French / Fran\xe7ais"},{code:"fy",title:"West Frisian / Frysk"},{code:"hu",title:"Hungarian / Magyar"},{code:"it",title:"Italian / Italiano"},{code:"ja",title:"Japanese / \u65e5\u672c\u8a9e"},{code:"lt",title:"Lithuanian / Lietuvi\u0173"},{code:"nl",title:"Dutch / Nederlands"},{code:"pt",title:"Portuguese / portugu\xeas"},{code:"ru",title:"Russian / P\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sk",title:"Slovak / Sloven\u010dina"},{code:"tr",title:"Turkish / T\xfcrk\xe7e"},{code:"zh",title:"Chinese / \u4e2d\u56fd\u7684"}]}setLanguage(ge){(null==ge||""==ge)&&(ge="en"),this.logging.log("Changing language: "+ge),this.translateService.use(ge)}initAppManager(){this.initAuthFromStorage(),this.isUserAuthenticated(!0)&&this.enableSubmissionQueue&&null!=this.submissionQueue&&this.submissionQueue.hasPendingItems()&&this.submissionQueue.processNextQueueItem()}initAuthFromStorage(){let ge=localStorage.getItem("authResponse");if(null!=ge){let ke=JSON.parse(ge);null!=ke.Data&&null!=ke.Data.access_token&&(this.jwtHelper.decodeToken(ke.Data.access_token),this.jwtHelper.isTokenExpired(ke.Data.access_token)?localStorage.removeItem("authResponse"):(this.api.authResponse=ke,this.logging.log("User has valid auth token in local storage",v.i.VERBOSE)))}}isUserAuthenticated(ge=!1){return!1===ge&&null!=this._isUserAuthenticated||(this._isUserAuthenticated=!1,null!=this.api.authResponse&&(this.jwtHelper.isTokenExpired(this.api.authResponse.Data.access_token)||(this._isUserAuthenticated=!0))),this._isUserAuthenticated}getCurrentAuthToken(){return null!=this.api.authResponse?this.api.authResponse.Data.access_token:null}getUserProfile(){return null!=this.api.authResponse?this.api.authResponse.Data.UserProfile:null}signOutCurrentUser(){localStorage.removeItem("authResponse"),this.api.authResponse=null,this._isUserAuthenticated=!1}submitComment(ge){if(!this.enableSubmissionQueue)return this.api.performSubmission(oe.q.Comment,ge);this.submissionQueue.add(oe.q.Comment,ge),this.submissionQueue.processNextQueueItem()}submitMediaItem(ge){if(!this.enableSubmissionQueue)return this.api.performSubmission(oe.q.Media,ge);this.submissionQueue.add(oe.q.Media,ge),this.submissionQueue.processNextQueueItem()}submitPOI(ge){if(!this.enableSubmissionQueue)return this.api.performSubmission(oe.q.POI,ge);this.submissionQueue.add(oe.q.POI,ge),this.submissionQueue.processNextQueueItem()}showToastNotification(ge){var ke=this;return(0,d.Z)(function*(){yield(yield ke.toastController.create({message:ge,duration:3e3})).present()})()}showLoadingProgress(ge){var ke=this;return(0,d.Z)(function*(){yield(yield ke.loadingController.create({message:ge})).present()})()}dismissLoadingProgress(){var ge=this;return(0,d.Z)(function*(){return ge.loadingController.dismiss()})()}launchOCMWebPage(ge){this.isUserAuthenticated(!0)&&(-1===ge.indexOf("?")&&(ge+="?"),ge+="&auth="+this.getCurrentAuthToken()),ge="https://openchargemap.org/site"+ge,window.open(ge,"_system")}launchWebPage(ge){window.open(ge,"_system")}isPlatform(ge){return this.platform.is(ge)}}return Pt.\u0275fac=function(ge){return new(ge||Pt)(K.LFG(xe.eN),K.LFG(pe.z),K.LFG(re.l),K.LFG(ce),K.LFG(Ke.t4),K.LFG(b.W),K.LFG(he.i),K.LFG(Pe.sK),K.LFG(Ke.yF),K.LFG(Ke.HT),K.LFG(ne.N0),K.LFG(v.z),K.LFG(Ie.c))},Pt.\u0275prov=K.Yz7({token:Pt,factory:Pt.\u0275fac,providedIn:"root"}),Pt})()},6260:(Ln,Dt,F)=>{"use strict";F.d(Dt,{z:()=>v});var d=F(8274);let v=(()=>{class re{constructor(){this.c=new Map}subscribe(q,...oe){let b=this.c.get(q);b||this.c.set(q,b=[]),b.push(...oe)}unsubscribe(q,oe){if(!oe)return this.c.delete(q);const b=this.c.get(q);if(!b)return!1;const he=b.indexOf(oe);return!(he<0||(b.splice(he,1),0===b.length&&this.c.delete(q),0))}publish(q,...oe){const b=this.c.get(q);return b?b.map(he=>{try{return he(...oe)}catch(Ie){return console.error(Ie),null}}):null}}return re.\u0275fac=function(q){return new(q||re)},re.\u0275prov=d.Yz7({token:re,factory:re.\u0275fac,providedIn:"root"}),re})()},3912:(Ln,Dt,F)=>{"use strict";F.d(Dt,{i:()=>he});var d=F(7689),v=F(7814),re=F(9698),a=F(8016),q=F(129),oe=F(4120),b=F(8274);let he=(()=>{class Ie{constructor(K,xe,pe){this.api=K,this.poiManager=xe,this.logging=pe,this.journeys=[],this.favourites=[]}loadJourneys(){let K=localStorage.getItem("journeys");if(null!=K&&(this.journeys=JSON.parse(K)),null!=this.journeys)for(let xe of this.journeys)this.fetchAllJourneyPOIDetails(xe)}fetchAllJourneyPOIDetails(K){this.logging.log("Journeys - fetching poi details for Journey "+K.Title);let xe=new a.b;xe.poiIdList=[];for(let pe of K.Stages)for(let ze of pe.WayPoints)for(let ce of ze.PoiIDs)xe.poiIdList.push(ce);this.api.fetchPOIListByParam(xe).then(pe=>{for(let ze of pe)this.updateStoredPOI(ze)})}updateStoredPOI(K){if(this.journeys.forEach(xe=>{xe.Stages.forEach(pe=>{pe.WayPoints.forEach(ze=>{ze.PoiIDs.forEach(ce=>{if(ce==K.ID)if(null==ze.PoiList){ze.PoiList=[];let Ke=new q.Qp("charging",1);Ke.Poi=K,Ke.PoiID=K.ID,ze.PoiList.push(Ke)}else for(let Ke of ze.PoiList)Ke.PoiID==K.ID&&(Ke.Poi=K)})})})}),null!=this.favourites)for(let xe of this.favourites)"charging"==xe.Type&&xe.PoiID==K.ID&&(xe.Poi=K)}saveJourneys(){let K=JSON.parse(JSON.stringify(this.journeys));for(let pe of K)for(const ze of pe.Stages)for(let ce of ze.WayPoints)for(let Ke of ce.PoiList)Ke.Poi=null,Ke.Photos=null;const xe=JSON.stringify(K);localStorage.setItem("journeys",xe)}addJourney(K,xe){let pe=new q.vw;pe.Title="Stage 1",null!=xe&&pe.WayPoints.push(xe),K.Stages.push(pe),this.journeys.push(K)}deleteJourney(K){this.journeys=this.journeys.filter(xe=>xe.ID!=K),this.saveJourneys()}getJourney(K){let xe=this.journeys.filter(pe=>pe.ID==K);return xe.length>0?xe[0]:null}getJourneyStages(K){return this.getJourney(K).Stages}addJourneyWaypoint(K,xe,pe){let ze=this.getJourney(K);if(null==xe){let ce=new q.vw;ce.Title="Stage "+(ze.Stages.length+1),ce.WayPoints.push(pe),ze.Stages.push(ce)}else{let ce=ze.Stages[xe];null==ce.WayPoints&&(ce.WayPoints=[]),ce.WayPoints.push(pe)}}addJourneyStage(K,xe){return this.getJourney(K).Stages.push(xe)-1}setupTestJourneys(){this.journeys=[];let K=new q.fw;K.Title="New York to Brooklyn",K.Notes="A little jaunt to Brooklyn",K.Stages=[];let xe=new q.vw,pe=new q.kA;pe.Notes="Starting point",pe.Position=new oe.wC(40,1.2),pe.Title="Start",xe.WayPoints.push(pe);let ze=new q.kA;ze.Notes="Middle point",ze.Position=new oe.wC(40,1.33),ze.Title="Middle",xe.WayPoints.push(ze);let ce=new q.kA;ce.Notes="End point",ce.Position=new oe.wC(40,1.33),ce.Title="End",xe.WayPoints.push(ce),K.Stages.push(xe),this.journeys.push(K);let Ke=new q.fw;Ke.Title="Aberdeen to London",Ke.Notes="Roadtrip",Ke.Stages=[],this.journeys.push(Ke)}calculateEnergyConsumptionkWh(K,xe,pe=0,ze){return K*ze}setRoutePolyline(K){this.routePolyline=K}getRoutePolyline(){return this.routePolyline}}return Ie.\u0275fac=function(K){return new(K||Ie)(b.LFG(v.l),b.LFG(re.R),b.LFG(d.z))},Ie.\u0275prov=b.Yz7({token:Ie,factory:Ie.\u0275fac,providedIn:"root"}),Ie})()},7689:(Ln,Dt,F)=>{"use strict";F.d(Dt,{i:()=>re,z:()=>a});var d=F(2340),v=F(8274),re=(()=>{return(q=re||(re={}))[q.VERBOSE=0]="VERBOSE",q[q.INFO=1]="INFO",q[q.WARNING=2]="WARNING",q[q.ERROR=3]="ERROR",re;var q})();let a=(()=>{class q{constructor(){this.logLevel=re.VERBOSE,d.N.production&&(this.logLevel=re.INFO)}log(b,he=re.VERBOSE){console&&console.log&&he>=this.logLevel&&console.log("["+re[he]+"] {"+(new Date).toLocaleTimeString()+"} "+b)}}return q.\u0275fac=function(b){return new(b||q)},q.\u0275prov=v.Yz7({token:q,factory:q.\u0275fac,providedIn:"root"}),q})()},9698:(Ln,Dt,F)=>{"use strict";F.d(Dt,{R:()=>b});var d=F(5861),v=F(7689),re=F(7814),a=F(56),q=F(8274),oe=F(6260);let b=(()=>{class he{constructor(Ve,K,xe,pe){this.api=Ve,this.events=K,this.logging=xe,this.analytics=pe,this.isRequestInProgress=!1}refreshPOIList(Ve){var K=this;return(0,d.Z)(function*(){try{return K.poiList=yield K.fetchPOIList(Ve),K.events.publish("ocm:poiList:updated"),K.analytics.appEvent("Search","Fetched Results"),K.poiList.length}catch{return 0}})()}fetchPOIList(Ve){var K=this;return(0,d.Z)(function*(){K.isRequestInProgress=!0;try{let xe=yield K.api.fetchPOIListByParam(Ve);return K.isRequestInProgress=!1,xe&&xe.length&&K.logging.log("fetched POI list ["+xe.length+"]"),xe}catch{return K.isRequestInProgress=!1,[]}})()}clearResults(){this.poiList=[],this.events.publish("ocm:poiList:cleared"),this.logging.log("clearing results after settings change",v.i.VERBOSE)}getPOIById(Ve,K=!1,xe=!1){var pe=this;return(0,d.Z)(function*(){if(!xe&&null!=pe.poiList){const Ke=pe.poiList.find(Pe=>Pe.ID==Ve);if(Ke)return Ke}const ze={poiIdList:[Ve],enableCaching:!xe,includeComments:!0},ce=yield pe.api.fetchPOIListByParam(ze);return ce&&ce.length>0?(pe.poiList&&ce[0].ID==Ve&&(pe.poiList=pe.poiList.filter(Ke=>Ke.ID!=Ve),pe.poiList.push(ce[0]),pe.logging.log("POI refreshed in cache "+Ve)),ce[0]):null})()}}return he.\u0275fac=function(Ve){return new(Ve||he)(q.LFG(re.l),q.LFG(oe.z),q.LFG(v.z),q.LFG(a.c))},he.\u0275prov=q.Yz7({token:he,factory:he.\u0275fac,providedIn:"root"}),he})()},6799:(Ln,Dt,F)=>{"use strict";F.d(Dt,{W:()=>q});var d=F(5861),v=F(7689),re=F(8274),a=F(529);let q=(()=>{class oe{constructor(he,Ie){this.http=he,this.logging=Ie,this.loadCachedRefData()}refreshReferenceData(he){var Ie=this;return(0,d.Z)(function*(){try{const Ve=yield he.fetchCoreReferenceData(null).toPromise();return Ie.setCoreReferenceData(Ve),Ie.setFilteredReferenceData(Ve),Ie.logging.log("Got refreshed core ref data.",v.i.VERBOSE),Ie.sortCoreReferenceData(),Ie.cacheCurrentRefData(),!0}catch(Ve){return Ie.logging.log("Error fetching core ref data:"+Ve),!1}})()}refreshFilteredReferenceData(he,Ie){he.fetchCoreReferenceData(Ie).subscribe(Ve=>{this.setFilteredReferenceData(Ve),this.sortCoreReferenceData(),this.logging.log("Got refreshed filtered reference data.",v.i.VERBOSE)},Ve=>{this.logging.log("Error fetching filtered reference data:"+Ve)})}setCoreReferenceData(he){this.referenceData=he}setFilteredReferenceData(he){this.filteredReferenceData=he}referenceDataLoaded(){return null!=this.referenceData}getCountries(he=!1){return 1==he?this.filteredReferenceData.Countries:this.referenceData.Countries}getCountryByID(he){return this.getRefDataByID(this.referenceData.Countries,he)}getConnectionTypes(he=!1){return 1==he?this.filteredReferenceData.ConnectionTypes:this.referenceData.ConnectionTypes}getConnectionTypeByID(he){return this.getRefDataByID(this.referenceData.ConnectionTypes,he)}getUsageTypes(he=!1){return 1==he?this.filteredReferenceData.UsageTypes:this.referenceData.UsageTypes.filter(Ie=>Ie.ID>0)}getUsageTypeByID(he){return this.getRefDataByID(this.referenceData.UsageTypes,he)}getStatusTypes(he=!1){return 1==he?this.filteredReferenceData.StatusTypes:this.referenceData.StatusTypes.filter(Ie=>Ie.ID>0)}getStatusTypeByID(he){return this.getRefDataByID(this.referenceData.StatusTypes,he)}getNetworkOperators(he=!1){return 1==he?this.filteredReferenceData.Operators:this.referenceData.Operators}getNetworkOperatorByID(he){return this.getRefDataByID(this.referenceData.Operators,he)}getDataProviders(he=!1){return 1==he?this.filteredReferenceData.DataProviders:this.referenceData.DataProviders}getDataProviderByID(he){return this.getRefDataByID(this.referenceData.DataProviders,he)}getCheckinStatusTypes(he=!1,Ie=!0){let Ve=null;return Ve=1==he?this.filteredReferenceData.CheckinStatusTypes:this.referenceData.CheckinStatusTypes,Ie&&(Ve=Ve.filter(K=>!1===K.IsAutomatedCheckin)),Ve}getCheckinStatusTypeByID(he){return this.getRefDataByID(this.referenceData.CheckinStatusTypes,he)}getCommentTypes(he=!1,Ie=!0){let Ve;return Ve=1==he?this.filteredReferenceData.UserCommentTypes:this.referenceData.UserCommentTypes,Ie&&(Ve=Ve.filter(K=>100!==K.ID&&110!==K.ID)),Ve}getCommentTypeByID(he){return this.getRefDataByID(this.referenceData.UserCommentTypes,he)}getSubmissionStatusTypes(he=!1){return 1==he?this.filteredReferenceData.SubmissionStatusTypes:this.referenceData.SubmissionStatusTypes}getSubmissionStatusTypesByID(he){return this.getRefDataByID(this.referenceData.SubmissionStatusTypes,he)}getChargingLevelTypes(he=!1){return 1==he?this.filteredReferenceData.ChargerTypes:this.referenceData.ChargerTypes}getChargingLevelTypeByID(he){return this.getRefDataByID(this.referenceData.ChargerTypes,he)}getOutputCurrentTypes(he=!1){return he?this.referenceData.CurrentTypes:this.filteredReferenceData.CurrentTypes}getOutputCurrentTypeByID(he){return this.getRefDataByID(this.referenceData.CurrentTypes,he)}loadCachedRefData(){const he=localStorage.getItem("referenceData");if(null==he)this.http.get("./assets/data/CoreReferenceData.json").subscribe(Ie=>{this.logging.log("Using bundled reference data as cached ref data."),this.setCoreReferenceData(Ie),this.setFilteredReferenceData(Ie)});else{let Ie=JSON.parse(he);this.setCoreReferenceData(Ie)}this.setFilteredReferenceData(this.referenceData)}cacheCurrentRefData(){null!=this.referenceData&&(this.referenceData.CacheDate=new Date,localStorage.setItem("referenceData",JSON.stringify(this.referenceData)))}getRefDataByID(he,Ie){if(""!==Ie&&(Ie=parseInt(Ie,10)),null!=he)for(let Ve=0;Ve<he.length;Ve++)if(he[Ve].ID===Ie)return he[Ve];return null}sortCoreReferenceData(){this.sortReferenceData(this.referenceData.ConnectionTypes),this.sortReferenceData(this.referenceData.Countries),this.sortReferenceData(this.referenceData.Operators),this.sortReferenceData(this.referenceData.DataProviders),this.sortReferenceData(this.referenceData.UsageTypes),this.sortReferenceData(this.referenceData.StatusTypes),this.sortReferenceData(this.referenceData.CheckinStatusTypes),this.sortReferenceData(this.referenceData.SubmissionStatusTypes),this.filteredReferenceData&&(this.sortReferenceData(this.filteredReferenceData.ConnectionTypes),this.sortReferenceData(this.filteredReferenceData.Operators))}sortReferenceData(he){he.sort(this.sortListByTitle)}sortListByTitle(he,Ie){return he.Title<Ie.Title?-1:he.Title>Ie.Title?1:0}getMetadataValueByMetadataFieldID(he,Ie){if(""!==Ie&&(Ie=parseInt(Ie,10)),null!=he)for(let Ve=0;Ve<he.length;Ve++)if(he[Ve].ID===Ie)return he[Ve];return null}hydrateCompactPOI(he,Ie=!1){const Ve=this;if(null!=he.DataProviderID&&(Ie||null==he.DataProvider)&&(he.DataProvider=Ve.getDataProviderByID(he.DataProviderID)),null!=he.OperatorID&&(Ie||null==he.OperatorInfo)&&(he.OperatorInfo=Ve.getNetworkOperatorByID(he.OperatorID)),null!=he.UsageTypeID&&(Ie||null==he.UsageType)&&(he.UsageType=Ve.getUsageTypeByID(he.UsageTypeID)),null!=he.AddressInfo.CountryID&&(Ie||null==he.AddressInfo.Country)&&(he.AddressInfo.Country=Ve.getCountryByID(he.AddressInfo.CountryID)),null!=he.StatusTypeID&&(Ie||null==he.StatusType)&&(he.StatusType=Ve.getStatusTypeByID(he.StatusTypeID)),null!=he.SubmissionStatusTypeID&&(Ie||null==he.SubmissionStatusType)&&(he.SubmissionStatusType=Ve.getSubmissionStatusTypesByID(he.SubmissionStatusTypeID)),null!=he.Connections)for(let K=0;K<he.Connections.length;K++){const xe=he.Connections[K];null!=xe.ConnectionTypeID&&(Ie||null==xe.ConnectionType)&&(xe.ConnectionType=Ve.getConnectionTypeByID(xe.ConnectionTypeID)),null!=xe.LevelID&&(Ie||null==xe.Level)&&(xe.Level=Ve.getChargingLevelTypeByID(xe.LevelID)),null!=xe.CurrentTypeID&&(Ie||null==xe.CurrentType)&&(xe.CurrentType=Ve.getOutputCurrentTypeByID(xe.CurrentTypeID)),null!=xe.StatusTypeID&&(Ie||null==xe.StatusType)&&(xe.StatusType=Ve.getStatusTypeByID(xe.StatusTypeID)),he.Connections[K]=xe}if(null!=he.UserComments)for(let K=0;K<he.UserComments.length;K++){const xe=he.UserComments[K];null!=xe.CommentTypeID&&(Ie||null==xe.CommentType)&&(xe.CommentType=Ve.getCommentTypeByID(xe.CommentTypeID)),null!=xe.CheckinStatusTypeID&&(Ie||null==xe.CheckinStatusType)&&(xe.CheckinStatusType=Ve.getCheckinStatusTypeByID(xe.CheckinStatusTypeID)),he.UserComments[K]=xe}return he}hydrateCompactPOIList(he){for(let Ie=0;Ie<he.length;Ie++)he[Ie]=this.hydrateCompactPOI(he[Ie]);return he}}return oe.\u0275fac=function(he){return new(he||oe)(re.LFG(a.eN),re.LFG(v.z))},oe.\u0275prov=re.Yz7({token:oe,factory:oe.\u0275fac,providedIn:"root"}),oe})()},4781:(Ln,Dt,F)=>{"use strict";F.d(Dt,{v:()=>Ke});var d=F(553),v=F(5906),re=F(6579),a=F(7689),q=F(5861),oe=F(9751),b=F(4120),he=F(2340),Ie=F(4209);class Ve{constructor(ne,Je){this.events=ne,this.logging=Je,this.events=ne,this.mapAPIType=v.b.MAPKIT_JS,this.mapReady=!1,this.markerList=new Map,this.mapkitUtils=new K}initAPI(){mapkit&&mapkit.init({authorizationCallback:function(ne){ne(he.N.mapKitToken)}})}disposeMap(){}initMap(ne,Je,Pt){this.mapCanvasID=ne;let at=!0;if(at=!(typeof mapkit>"u"),!at)return this.logging.log("Call to initMap before API is ready:"+v.b[this.mapAPIType],a.i.ERROR),this.mapReady=!1,!1;this.initAPI(),null==this.map&&(document.getElementById(ne),this.map=new mapkit.Map(ne),this.map.annotationForCluster=function(ke){"poi"===ke.clusteringIdentifier&&(ke.title="Charging Location",ke.subtitle=ke.memberAnnotations.reduce((Le,we)=>Le+we.population,0))},this.mapReady=!0,mapkit.addEventListener("configuration-change",ke=>{this.events.publish("ocm:mapping:ready")}),this.map.addEventListener("scroll-end",ke=>{this.events.publish("ocm:mapping:dragend")}),this.map.addEventListener("zoom-end",ke=>{this.events.publish("ocm:mapping:zoom")}))}clearMarkers(){null!=this.markerList&&this.markerList.forEach((ne,Je)=>{try{this.map.removeAnnotation(Je)}catch{}}),this.markerList=new Map}showPOIListOnMap(ne,Je){let ke=0,we=0==this.markerList.size;if(null!=ne){let He=[];for(let me=0;me<ne.length;me++)if(null!=ne[me].AddressInfo&&null!=ne[me].AddressInfo.Latitude&&null!=ne[me].AddressInfo.Longitude){let de=ne[me],se=!0;if(null!=this.markerList&&this.markerList.has(de.ID)&&(se=!1),se){let Ee=null;Ee=re.c.getIconForPOI(de);let Lt="OCM-"+de.ID+": "+de.AddressInfo.Title+":";null!=de.UsageType&&(Lt+=" "+de.UsageType.Title),null!=de.StatusType&&(Lt+=" "+de.StatusType.Title);const yt=new mapkit.Coordinate(de.AddressInfo.Latitude,de.AddressInfo.Longitude);let St=new mapkit.ImageAnnotation(yt,{title:Lt,size:{width:34,height:50},url:{1:Ee},clusteringIdentifier:"poi"});St.poi=de,St.addEventListener("select",xt=>{const rt=xt.target.poi;this.events.publish("ocm:poi:selected",{poi:rt,poiId:rt.ID})}),this.markerList.set(de.ID,St),He.push(St),ke++}}He.length>0&&(this.map.addAnnotations(He),we&&this.map.showItems(He,{animate:!0,padding:new mapkit.Padding(60,25,60,25)})),this.logging.log(ke+" new map markers added out of a total "+this.markerList.size)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapKit: refreshMapLayout",a.i.VERBOSE)},200)}setMapCenter(ne,Je){this.map&&(this.map.setCenterAnimated(new mapkit.Coordinate(ne.coords.latitude,ne.coords.longitude),!1),Je&&this.setMapZoom(Je))}getMapCenter(){return new oe.y(Je=>{if(null!=this.map){let Pt=this.map.center;null!=Pt&&(Je.next(new b.jR(Pt.latitude,Pt.longitude)),Je.complete())}})}setMapZoom(ne){const Je=Math.min(ne,28),Pt=this.mapkitUtils.deltaFromZoomLevel(this.map,this.map.center,Math.round(Je)),at=new mapkit.CoordinateSpan(111*Pt.latitudeDelta,111*Pt.longitudeDelta),ge=new mapkit.CoordinateRegion(this.map.center,at);this.map.setRegionAnimated(ge)}getMapZoom(){return new oe.y(Je=>{this.logging.log("MapKit: getMapZoom not supported",a.i.VERBOSE),Je.next(this.map._impl.zoomLevel),Je.complete()})}setMapType(ne){this.logging.log("MapKit: skipped setting Map Type :"+ne)}getMapBounds(){return new oe.y(Je=>{let Pt=new Array,at=this.map.region.toBoundingRegion();Pt.push(new b.wC(at.southLatitude,at.westLongitude)),Pt.push(new b.wC(at.northLatitude,at.eastLongitude)),Je.next(Pt),Je.complete()})}moveToMapBounds(ne){this.logging.log("MapKit: map bounds not implemented")}renderMap(ne,Je,Pt){return document.getElementById(this.mapCanvasID).style.height=Je+"px",this.mapReady&&this.showPOIListOnMap(ne,Pt),!0}renderPolyline(ne){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(ne){return(0,q.Z)(function*(){let Je=new mapkit.Search({getsUserLocation:!0});return new Promise(function(){var Pt=(0,q.Z)(function*(at,ge){let ke=[];Je.search(ne,function(){var Le=(0,q.Z)(function*(we,Xe){we&&ge(we),ke=[],Xe.places.map(He=>{let me=new Ie.n;me.Title=He.name,me.Address=He.formattedAddress,me.Type="place",me.Location=new b.wC(He.coordinate.latitude,He.coordinate.longitude),ke.push(me)}),at(ke)});return function(we,Xe){return Le.apply(this,arguments)}}())});return function(at,ge){return Pt.apply(this,arguments)}}())})()}addPOILayer(ne){this.logging.log("Add POI Layer not implemented in this provider.")}}class K{constructor(){this.mercatorRadius=85445659.44705395,this.mercatorOffset=268435456}longitudeToPixelSpaceX(ne){return Math.round(this.mercatorOffset+this.mercatorRadius*ne*Math.PI/180)}latitudeToPixelSpaceY(ne){return Math.round(this.mercatorOffset-this.mercatorRadius*Math.log((1+Math.sin(ne*Math.PI/180))/(1-Math.sin(ne*Math.PI/180)))/2)}pixelSpaceXToLongitude(ne){return(Math.round(ne)-this.mercatorOffset)/this.mercatorRadius*180/Math.PI}pixelSpaceYToLatitude(ne){return 180*(Math.PI/2-2*Math.atan(Math.exp((Math.round(ne)-this.mercatorOffset)/this.mercatorRadius)))/Math.PI}deltaFromZoomLevel(ne,Je,Pt){let at=this.longitudeToPixelSpaceX(Je.longitude),ge=this.latitudeToPixelSpaceY(Je.latitude),Le=Math.pow(2,20-Pt),we=ne.visibleMapRect.size,Xe=we.width*Le,He=we.height*Le,me=at-Xe/2,de=ge-He/2,se=this.pixelSpaceXToLongitude(me),_t=this.pixelSpaceXToLongitude(me+Xe)-se,It=this.pixelSpaceYToLatitude(de);return{latitudeDelta:-1*(this.pixelSpaceYToLatitude(de+He)-It),longitudeDelta:_t}}}var xe=F(8274),pe=F(6260),ze=F(529);let ce=(()=>{class Pe extends d.k{constructor(Je,Pt,at){super(Je,Pt,at),this.mapAPIType=v.b.MAPTILER,this.mapTileSet="https://maps.tilehosting.com/styles/streets/style.json?key=Gs9z7krALe3CGI60d5cL"}initAPI(){}}return Pe.\u0275fac=function(Je){return new(Je||Pe)(xe.LFG(pe.z),xe.LFG(a.z),xe.LFG(ze.eN))},Pe.\u0275prov=xe.Yz7({token:Pe,factory:Pe.\u0275fac}),Pe})(),Ke=(()=>{class Pe{constructor(Je,Pt,at){this.logging=Pt,this.http=at,this.isFocused=!1,this.events=Je,this.mapOptions=new v._,this.mapAPIReady=!1,this.mapsInitialised=!1,this.setMapAPI(this.mapOptions.mapAPI);let ge=this;this.debouncedMapPositionUpdate=re.c.debounce(()=>{this.logging.log("signaling map position change:"),ge.mapProvider.mapReady&&ge.getMapCenter().subscribe(ke=>{null!=ke?(this.logging.log("Map centre/zoom changed, updating search position:"+ke),this.updateMapCentrePos(ke.coords.latitude,ke.coords.longitude,!1)):this.logging.log("Map centre/zoom changed - map not ready to change centre pos:")})},300,!1)}setParentAppContext(Je){this.parentAppContext=Je}setMapAPI(Je){this.mapOptions.mapAPI=Je,this.mapOptions.mapAPI==v.b.MAPBOX&&(this.mapProvider=new d.k(this.events,this.logging,this.http)),this.mapOptions.mapAPI==v.b.MAPKIT_JS&&(this.mapProvider=new Ve(this.events,this.logging)),this.mapOptions.mapAPI==v.b.MAPTILER&&(this.mapProvider=new ce(this.events,this.logging,this.http))}isMapReady(){return null!=this.mapProvider&&this.mapProvider.mapReady}externalAPILoaded(Je){this.mapAPIReady=!0,this.logging.log("Mapping API Loaded: "+v.b[Je])}initMap(Je){if(!this.isMapReady())if(null!=this.mapProvider)this.mapsInitialised&&this.logging.log("initMap: Map provider already initialised"),this.logging.log("Mapping Manager: Init "+v.b[this.mapProvider.mapAPIType]),this.mapProvider.initMap(Je,this.mapOptions,this);else{if(this.mapsInitialised)return void this.logging.log("initMap: map already initialised");this.logging.log("initMap: "+this.mapOptions.mapAPI)}}mapManipulationPerformed(Je){this.logging.log("map manipulated:"+Je),("drag"==Je||"zoom"==Je)&&this.debouncedMapPositionUpdate()}updateMapSize(){this.mapProvider&&this.mapProvider.refreshMapLayout()}updateMapCentrePos(Je,Pt,at,ge){at&&null!=this.mapProvider&&this.mapProvider.setMapCenter(new b.jR(Je,Pt),ge),this.mapOptions.mapCentre=new b.jR(Je,Pt)}moveToMapBounds(Je){this.mapProvider.moveToMapBounds(Je)}refreshMapView(Je,Pt,at){return null!=this.mapProvider?(this.logging.log("Mapping Manager: renderMap "+v.b[this.mapProvider.mapAPIType]),this.isMapReady()?this.mapProvider.renderMap(Pt,Je,this.parentAppContext):this.logging.log("refreshMapView: map provider not initialised..")):this.logging.log("Unsupported Map API: refreshMapView",a.i.ERROR),!0}setMapType(Je){this.mapOptions.mapType!=Je&&(this.mapOptions.mapType=Je,this.isMapReady()&&null!=this.mapProvider?(this.logging.log("Changing map type:"+Je),this.mapProvider.setMapType(Je)):this.logging.log("Map type set, maps not initialised yet."))}unfocusMap(){this.logging.log("[mapping] Unfocus Map."),this.isFocused=!1,this.mapProvider.unfocusMap()}focusMap(){this.logging.log("[mapping] Focus Map."),this.isFocused=!0,this.mapProvider.focusMap()}getMapBounds(){return this.mapProvider.getMapBounds()}getMapZoom(){return this.mapProvider.getMapZoom()}setMapZoom(Je){this.mapProvider.setMapZoom(Je)}getMapCenter(){return this.mapProvider.getMapCenter()}showPOIOnStaticMap(Je,Pt,at=!1,ge=!1,ke=200,Le=200){let we=document.getElementById(Je);if(null!=we){let He=Pt.AddressInfo.Latitude,me=Pt.AddressInfo.Longitude;ke>640&&(ke=640),Le>640&&(Le=640);let de=ke,se=Le,Ee="https://maps.googleapis.com/maps/api/staticmap?center="+He+","+me+"&zoom=14&size="+de+"x"+se+"&maptype=roadmap&markers=color:blue%7Clabel:A%7C"+He+","+me+"&sensor=false",_t="";_t+=1==at?"<div>"+re.c.formatMapLink(Pt,'<div><img width="'+de+'" height="'+se+'" src="'+Ee+'" /></div>',ge)+"</div>":'<div><img width="'+de+'" height="'+se+'" src="'+Ee+'" /></div>',we.innerHTML=_t}}renderPolyline(Je){this.mapProvider.renderPolyline(Je)}clearPolyline(){this.mapProvider.clearPolyline()}clearMarkers(){this.logging.log("mapping: clearing markers"),this.mapProvider.clearMarkers()}addPOILayer(Je){this.mapProvider.addPOILayer(Je)}}return Pe.\u0275fac=function(Je){return new(Je||Pe)(xe.LFG(pe.z),xe.LFG(a.z),xe.LFG(ze.eN))},Pe.\u0275prov=xe.Yz7({token:Pe,factory:Pe.\u0275fac,providedIn:"root"}),Pe})()},5906:(Ln,Dt,F)=>{"use strict";F.d(Dt,{_:()=>re,b:()=>v});var d=F(2340),v=(()=>{return(a=v||(v={}))[a.GOOGLE_WEB=1]="GOOGLE_WEB",a[a.GOOGLE_NATIVE=2]="GOOGLE_NATIVE",a[a.LEAFLET=3]="LEAFLET",a[a.MAPBOX=4]="MAPBOX",a[a.MAPKIT_JS=5]="MAPKIT_JS",a[a.MAPTILER=6]="MAPTILER",v;var a})();class re{constructor(){this.enableClustering=!1,this.resultBatchID=-1,this.useMarkerIcons=!0,this.useMarkerAnimation=!0,this.enableTrackingMapCentre=!1,this.enableSearchByWatchingLocation=!1,this.mapCentre=null,this.mapAPI=d.N.defaultMapProvider,this.mapType="ROADMAP",this.searchDistanceKM=1e5,this.mapMoveQueryRefreshMS=300,this.enableSearchRadiusIndicator=!1,this.minZoomLevel=2}}},553:(Ln,Dt,F)=>{"use strict";F.d(Dt,{k:()=>ce});var d=F(5861),v=F(6579),re=F(5906),a=F(9751),q=F(4120),oe=F(7689),b=F(9898),Ie=F(2340),Ve=F(4209),K=F(8274),xe=F(6260),pe=F(529);let ce=(()=>{class Ke{constructor(ne,Je,Pt){this.events=ne,this.logging=Je,this.http=Pt,this._isMapAnimating=!1,this.events=ne,this.mapAPIType=re.b.MAPBOX,this.mapReady=!1,this.markerList=new Map}initAPI(){b&&(b.accessToken=Ie.N.mapBoxToken)}disposeMap(){this.map&&(this.logging.log("Disposing map",oe.i.INFO),this.map.remove())}getCurrentMapTileSet(ne){return"SATELLITE"==ne?"mapbox://styles/mapbox/satellite-streets-v12?optimize=true":"mapbox://styles/mapbox/streets-v12?optimize=true"}flyAroundPoint(ne){if(this._isMapAnimating){this.map.rotateTo(ne/100%360,{duration:0});const Je=this;requestAnimationFrame(function(Pt){Je.flyAroundPoint(Pt)})}}initMap(ne,Je,Pt){this.mapCanvasID=ne;let at=!0;if(at=!(typeof b>"u"),!at)return this.logging.log("Call to initMap before API is ready:"+re.b[this.mapAPIType],oe.i.ERROR),this.mapReady=!1,!1;if(null==this.map){let we=function(He){return He*(2-He)};document.getElementById(ne),this.initAPI(),this.map=new b.Map({container:ne,style:this.getCurrentMapTileSet(Je.mapType),zoom:15,attributionControl:!1}),this.map.addControl(new b.AttributionControl({compact:!0,customAttribution:["Open Charge Map Contributors"]})),this.map.addControl(new b.NavigationControl),this.mapReady=!0,this.map.getCanvas().focus();let ke=100,Le=25;this.map.getCanvas().addEventListener("keydown",He=>{He.preventDefault(),38===He.which?this.map.panBy([0,-ke],{easing:we}):40===He.which?this.map.panBy([0,ke],{easing:we}):37===He.which?this.map.easeTo({bearing:this.map.getBearing()-Le,easing:we}):39===He.which?this.map.easeTo({bearing:this.map.getBearing()+Le,easing:we}):32===He.which&&(this._isMapAnimating?this._isMapAnimating=!1:(this._isMapAnimating=!0,this.flyAroundPoint(0)))},!0),this.map.on("load",()=>{this.events.publish("ocm:mapping:ready")});let Xe=v.c.debounce(()=>{this.getMapCenter().subscribe(He=>{this.searchMarker.setLngLat(new b.LngLat(He.coords.longitude,He.coords.latitude))})},500,!1);this.map.on("move",()=>{this.searchMarker&&Xe()}),this.map.on("moveend",()=>{this.events.publish("ocm:mapping:dragend"),Je.onMapMoveCompleted&&Je.onMapMoveCompleted()}),this.map.on("zoomend",()=>{this.events.publish("ocm:mapping:zoom")})}}clearMarkers(){null!=this.markerList&&this.markerList.forEach((ne,Je)=>{ne.remove()}),this.markerList=new Map}showPOIListOnMap(ne,Je,Pt=!0){let ge=this.map,ke=new b.LngLatBounds,Le=0;if(ge.getZoom(),null!=ne){for(let de=0;de<ne.length;de++)if(null!=ne[de].AddressInfo&&null!=ne[de].AddressInfo.Latitude&&null!=ne[de].AddressInfo.Longitude){let se=ne[de],Ee=!0;if(null!=this.markerList&&this.markerList.has(se.ID)){Ee=!1;let _t=this.markerList.get(se.ID);_t&&_t.poi&&_t.poi.DateLastStatusUpdate!=se.DateLastStatusUpdate&&(_t.remove(),Ee=!0)}if(Ee){let _t=null,It=null;Pt?(_t=document.createElement("img"),_t.src=v.c.getIconForPOI(se),_t.width=34,_t.height=50):(_t=null,It=v.c.getColorForPOI(se));let Lt=(Pt?"OCM-":"EXT-")+se.ID+": "+se.AddressInfo.Title+":";null!=se.UsageType&&(Lt+=" "+se.UsageType.Title),null!=se.StatusType&&(Lt+=" "+se.StatusType.Title);let yt=new b.Marker({element:_t,color:It,anchor:"bottom"}).setLngLat([se.AddressInfo.Longitude,se.AddressInfo.Latitude]).addTo(ge);yt.poi=se;let St=yt.getElement();St.poi=se,St.addEventListener("click",xt=>{const rt=xt.currentTarget.poi;this.events.publish("ocm:poi:selected",{poiId:rt.ID,poi:rt})}),ke.extend(yt.getLngLat()),this.markerList.set(se.ID,yt),Le++}}this.logging.log(Le+" new map markers added out of a total "+this.markerList.size)}if(null!=ne&&ne.length>0)if(null==Je||Je.appConfig.enableLiveMapQuerying)null==ge.getCenter()&&ge.setCenter(ke.getCenter());else{this.logging.log("Fitting to marker bounds:"+ke),ge.setCenter(ke.getCenter()),this.logging.log("zoom before fit bounds:"+ge.getZoom()),ge.fitBounds(ke);let me=ge.getZoom();ge.setZoom(me<6?6:me)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapBoxGL: refreshMapLayout",oe.i.VERBOSE),this.map.resize()},200)}setMapCenter(ne){this.mapReady&&(this.map.setCenter(new b.LngLat(ne.coords.longitude,ne.coords.latitude)),this.searchMarker||(this.searchMarker=new b.Marker({color:"#99ccff",anchor:"bottom"}).setLngLat(new b.LngLat(ne.coords.longitude,ne.coords.latitude)).addTo(this.map),this.searchMarker.getElement().addEventListener("click",()=>{let Je=this.searchMarker.getLngLat();this.events.publish("ocm:mapping:addpoi",new q.wC(Je.lat,Je.lng))})))}getMapCenter(){return new a.y(Je=>{if(null!=this.map){let Pt=this.map.getCenter();null!=Pt&&(Je.next(new q.jR(Pt.lat,Pt.lng)),Je.complete())}})}setMapZoom(ne){this.map.setZoom(ne)}getMapZoom(){return new a.y(Je=>{let Pt=this.map.getZoom();Je.next(Pt),Je.complete()})}setMapType(ne){this.map.setStyle(this.getCurrentMapTileSet(ne))}getMapBounds(){return new a.y(Je=>{let Pt=new Array,at=this.map.getBounds();Pt.push(new q.wC(at.getSouthWest().lat,at.getSouthWest().lng)),Pt.push(new q.wC(at.getNorthEast().lat,at.getNorthEast().lng)),Je.next(Pt),Je.complete()})}moveToMapBounds(ne){this.map.fitBounds(new b.LngLatBounds(new b.LngLat(ne.southWest.longitude,ne.southWest.latitude),new b.LngLat(ne.northEast.longitude,ne.northEast.latitude)))}renderMap(ne,Je,Pt){return document.getElementById(this.mapCanvasID).style.height=Je+"px",this.mapReady&&this.showPOIListOnMap(ne,Pt),!0}renderPolyline(ne){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(ne,Je,Pt){var at=this;return(0,d.Z)(function*(){let ge=`https://api.mapbox.com/geocoding/v5/mapbox.places/${ne||Pt+","+Je}.json?access_token=${Ie.N.mapBoxToken}`;return new Promise(function(){var ke=(0,d.Z)(function*(Le,we){at.http.get(ge).toPromise().then(Xe=>{let He=[];He=[],Xe.features&&Xe.features.map(me=>{let de=new Ve.n;de.Title=me.place_name,de.Address=me.place_name,de.Type="place",de.Location=new q.wC(me.center[1],me.center[0]),de.Attribution=Xe.attribution,He.push(de)}),Le(He)})});return function(Le,we){return ke.apply(this,arguments)}}())})()}addPOILayer(ne){this.logging.log("Add POI Layer not implemented in this provider."),this.showPOIListOnMap(ne,null,!1)}}return Ke.\u0275fac=function(ne){return new(ne||Ke)(K.LFG(xe.z),K.LFG(oe.z),K.LFG(pe.eN))},Ke.\u0275prov=K.Yz7({token:Ke,factory:Ke.\u0275fac}),Ke})()},2340:(Ln,Dt,F)=>{"use strict";F.d(Dt,{N:()=>d});const d={name:"prod",version:"8.5.1",production:!0,analyticsId:"",googleMapsKey:"",mapBoxToken:"pk.eyJ1Ijoid2VicHJvZnVzaW9uIiwiYSI6ImNrdHZlc2N5dTI5Zjcydm8zYWFwc2JnbTMifQ.M7b5SOzbPcg_8XAHCOeP0w",mapKitToken:"",enableStaticMaps:!1,defaultMapProvider:4,apiBase:"https://api.openchargemap.io",apiKey:"9bb03e5b-0fb2-4916-9b2b-26c6bd27a56a",enabledFeatures:["MAP","ADD_COMMENT","ADD_PHOTO","FAVOURITES","FILTER_OPTIONS_BY_COUNTRY","ADD_POI","EDIT_POI","LAYERS"]}},659:(Ln,Dt,F)=>{"use strict";var d=F(1481),v=F(8274),re=F(8936),a=F(4463),q=F(6895),oe=F(4006),b=F(425);let he=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt}),Vt.\u0275inj=v.cJS({imports:[q.ez,oe.u5,b.Pc,a.aw,re.e]}),Vt})(),Ie=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt}),Vt.\u0275inj=v.cJS({imports:[q.ez,oe.u5,b.Pc,a.aw,re.e]}),Vt})(),Ve=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt}),Vt.\u0275inj=v.cJS({imports:[q.ez,oe.u5,b.Pc,a.aw,re.e]}),Vt})();var K=F(3548),xe=F(529),pe=F(4228),ze=F(3175);class ce{constructor(Mt,Ge="/assets/i18n/",ie=".json"){this.http=Mt,this.prefix=Ge,this.suffix=ie}getTranslation(Mt){return this.http.get(`${this.prefix}${Mt}${this.suffix}`)}}var Ke=F(5861),Pe=F(4781),ne=F(6763),Je=F(9492),Pt=F(9741),at=F(3855);function ge(Vt,Mt){if(1&Vt){const Ge=v.EpF();v.TgZ(0,"div"),v._uU(1," You are not signed in. "),v.TgZ(2,"button",5),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.showSignInModal())}),v._uU(3),v.ALo(4,"translate"),v.qZA()()}2&Vt&&(v.xp6(3),v.Oqu(v.lcZ(4,1,"ocm.general.signIn")))}function ke(Vt,Mt){if(1&Vt&&(v.TgZ(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-avatar",6),v._UZ(4,"img",7),v.qZA(),v.TgZ(5,"h2"),v._uU(6),v.qZA()(),v.TgZ(7,"ion-card-content")(8,"p"),v._uU(9),v.qZA(),v.TgZ(10,"p"),v._uU(11),v.qZA()(),v.TgZ(12,"ion-item")(13,"ion-note",8),v._UZ(14,"ion-icon",9),v._uU(15),v.qZA()()()()),2&Vt){const Ge=v.oxw();v.xp6(4),v.s9C("src",Ge.userProfile.ProfileImageURL,v.LSH),v.xp6(2),v.Oqu(Ge.userProfile.Username),v.xp6(3),v.hij(" ",Ge.userProfile.Profile,""),v.xp6(2),v.hij(" Date Joined: ",Ge.userProfile.DateCreated," "),v.xp6(4),v.hij(" ",Ge.userProfile.ReputationPoints," Contributor Points ")}}let Le=(()=>{class Vt{constructor(Ge,ie,Qe,Wt){this.appManager=Ge,this.nav=ie,this.translate=Qe,this.modalController=Wt}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),null!=this.userProfile&&this.appManager.isUserAuthenticated(!0)?this.refreshProfileView():this.showSignInModal(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:Je.F,componentProps:{Profile:this.userProfile}}).then(Ge=>{Ge.onDidDismiss().then(()=>{this.refreshProfileView()}),Ge.present()})}close(){this.modalController.dismiss()}}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)(v.Y36(at.c),v.Y36(b.SH),v.Y36(a.sK),v.Y36(b.IN))},Vt.\u0275cmp=v.Xpm({type:Vt,selectors:[["ng-component"]],decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(Ge,ie){1&Ge&&(v.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),v._uU(3),v.ALo(4,"translate"),v.qZA()()(),v.TgZ(5,"ion-content",0),v.YNc(6,ge,5,3,"div",1),v.YNc(7,ke,16,5,"div",1),v.qZA(),v.TgZ(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",2)(11,"ion-button",3),v.NdJ("click",function(){return ie.close()}),v._UZ(12,"ion-icon",4),v._uU(13," Close "),v.qZA()()()()),2&Ge&&(v.xp6(3),v.hij(" ",v.lcZ(4,3,"ocm.navigation.profile.sectionTitle")," "),v.xp6(3),v.Q6J("ngIf",null==ie.userProfile),v.xp6(1),v.Q6J("ngIf",null!=ie.userProfile))},dependencies:[q.O5,b.BJ,b.YG,b.Sm,b.PM,b.FN,b.W2,b.fr,b.Gu,b.gu,b.Ie,b.uN,b.wd,b.sr,a.X$],encapsulation:2}),Vt})();var we=F(7689),Xe=F(2340),He=F(4508),me=F(56),de=F(6579),se=F(388),Ee=F(6588),_t=F(7423);const It=(0,_t.fo)("PushNotifications",{}),Gt=(0,_t.fo)("StatusBar"),Lt=(0,_t.fo)("SplashScreen",{web:()=>F.e(2680).then(F.bind(F,2680)).then(Vt=>new Vt.SplashScreenWeb)}),yt=(0,_t.fo)("App",{web:()=>F.e(4477).then(F.bind(F,4477)).then(Vt=>new Vt.AppWeb)});var St=F(6260);function xt(Vt,Mt){if(1&Vt){const Ge=v.EpF();v.TgZ(0,"ion-item",9),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.openRoutePlannerModal())}),v._UZ(1,"ion-icon",12),v.TgZ(2,"ion-label"),v._uU(3," Route Planner "),v.qZA()()}}function rt(Vt,Mt){if(1&Vt){const Ge=v.EpF();v.TgZ(0,"ion-item",9),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.add())}),v._UZ(1,"ion-icon",13),v.TgZ(2,"ion-label"),v._uU(3),v.ALo(4,"translate"),v.qZA()()}2&Vt&&(v.xp6(3),v.hij(" ",v.lcZ(4,1,"ocm.general.addLocation")," "))}function lt(Vt,Mt){if(1&Vt){const Ge=v.EpF();v.TgZ(0,"ion-item",9),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.journeys())}),v._UZ(1,"ion-icon",12),v.TgZ(2,"ion-label"),v._uU(3," Journeys "),v.qZA()()}}function Ce(Vt,Mt){if(1&Vt){const Ge=v.EpF();v.TgZ(0,"ion-item",9),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.addLayer())}),v._UZ(1,"ion-icon",14),v.TgZ(2,"ion-label"),v._uU(3," Add Layer "),v.qZA()()}}function bt(Vt,Mt){if(1&Vt){const Ge=v.EpF();v.ynx(0),v.TgZ(1,"ion-item",9),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.signIn())}),v._UZ(2,"ion-icon",15),v.TgZ(3,"ion-label"),v._uU(4),v.ALo(5,"translate"),v.qZA()(),v.BQk()}2&Vt&&(v.xp6(4),v.hij(" ",v.lcZ(5,1,"ocm.general.signIn")," "))}function kt(Vt,Mt){if(1&Vt){const Ge=v.EpF();v.ynx(0),v.TgZ(1,"ion-item",9),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.profile())}),v._UZ(2,"ion-icon",15),v.TgZ(3,"ion-label"),v._uU(4),v.ALo(5,"translate"),v.qZA()(),v.TgZ(6,"ion-item",9),v.NdJ("click",function(){v.CHM(Ge);const Qe=v.oxw();return v.KtG(Qe.signOut())}),v._UZ(7,"ion-icon",16),v.TgZ(8,"ion-label"),v._uU(9),v.ALo(10,"translate"),v._UZ(11,"br"),v.TgZ(12,"small",17),v._uU(13),v.qZA()()(),v.BQk()}if(2&Vt){const Ge=v.oxw();v.xp6(4),v.hij(" ",v.lcZ(5,3,"ocm.navigation.profile.sectionTitle")," "),v.xp6(5),v.hij(" ",v.lcZ(10,5,"ocm.general.signOut")," "),v.xp6(4),v.hij(" ",Ge.getUserName(),"")}}const Ut=function(){return["/search"]};let bn=(()=>{class Vt{constructor(Ge,ie,Qe,Wt,rn,oi,Di,ar){this.platform=Ge,this.translate=ie,this.mapping=Qe,this.modalController=Wt,this.appManager=rn,this.logger=oi,this.analytics=Di,this.events=ar,this.logger.log("Environment: "+Xe.N.name),this.initializeApp(),this.enabledFeatures=Xe.N.enabledFeatures,1!=rn.searchSettings.EnableAdvancedEditorFeatures&&(this.enabledFeatures=this.enabledFeatures.filter(pi=>"LAYERS"!=pi))}configurePushNotifications(){It.register(),It.addListener("registration",Ge=>{this.logger.log("Push registration success, token: "+Ge.value),this.appManager.savePushRegistration(Ge.value)}),It.addListener("registrationError",Ge=>{this.logger.log("Error on registration: "+JSON.stringify(Ge))}),It.addListener("pushNotificationReceived",Ge=>{this.logger.log("Push received: "+JSON.stringify(Ge),we.i.INFO)}),It.addListener("pushNotificationActionPerformed",Ge=>{this.logger.log("Push action performed: "+JSON.stringify(Ge))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let Ge=this.appManager.getUserProfile();return Ge?Ge.EmailAddress?Ge.EmailAddress:Ge.Username:"Not Signed In"}initializeApp(){var Ge=this;this.platform.ready().then(()=>{this.platform.is("capacitor")&&(Gt.show(),Lt.hide()),this.translate.addLangs(this.appManager.getLanguages().map(ie=>ie.code)),this.translate.setDefaultLang("en"),null!=this.appManager.searchSettings.Language?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(ie=>{}),this.analytics.init(Xe.N.analyticsId).then(()=>{this.analytics.setAppVersion(Xe.N.version),this.analytics.appEvent("Startup","App Loaded")}).catch(ie=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",function(){var ie=(0,Ke.Z)(function*(Qe){de.c.isFeatureEnabled("ADD_POI")&&Ge.add(Qe)});return function(Qe){return ie.apply(this,arguments)}}()),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return(0,Ke.Z)(function*(){yt.addListener("appUrlOpen",ie=>{alert("App (re)opened with URL: "+ie.url)});let Ge=yield yt.getLaunchUrl();Ge&&Ge.url&&alert("App opened with URL: "+Ge.url)})()}openRoutePlannerModal(){var Ge=this;return(0,Ke.Z)(function*(){Ge.mapping.unfocusMap();const ie=yield Ge.modalController.create({component:ne.u});ie.onDidDismiss().then(Qe=>{Ge.mapping.focusMap()}),yield ie.present()})()}continueAdd(Ge){var ie=this;return(0,Ke.Z)(function*(){const Qe=yield ie.modalController.create({component:He.Y,componentProps:{startPos:Ge}});Qe.onDidDismiss().then(Wt=>{ie.mapping.focusMap()}),yield Qe.present()})()}add(Ge){var ie=this;return(0,Ke.Z)(function*(){if(ie.mapping.unfocusMap(),!ie.appManager.isUserAuthenticated(!0)){const Qe=yield ie.modalController.create({component:Je.F});return Qe.onDidDismiss().then(function(){var Wt=(0,Ke.Z)(function*(rn){ie.mapping.focusMap(),ie.appManager.isUserAuthenticated(!0)&&(yield ie.continueAdd(Ge))});return function(rn){return Wt.apply(this,arguments)}}()),yield Qe.present()}yield ie.continueAdd(Ge)})()}signIn(){var Ge=this;return(0,Ke.Z)(function*(){Ge.mapping.unfocusMap();const ie=yield Ge.modalController.create({component:Je.F});return ie.onDidDismiss().then(Qe=>{Ge.mapping.focusMap(),Ge.appManager.isUserAuthenticated(!0)}),yield ie.present()})()}signOut(){var Ge=this;return(0,Ke.Z)(function*(){Ge.appManager.signOutCurrentUser()})()}profile(){var Ge=this;return(0,Ke.Z)(function*(){Ge.mapping.unfocusMap();const ie=yield Ge.modalController.create({component:Le});ie.onDidDismiss().then(Qe=>{Ge.mapping.focusMap()}),yield ie.present()})()}journeys(){var Ge=this;return(0,Ke.Z)(function*(){Ge.mapping.unfocusMap();const ie=yield Ge.modalController.create({component:Pt.g});ie.onDidDismiss().then(Qe=>{Ge.mapping.focusMap()}),yield ie.present()})()}addLayer(){var Ge=this;return(0,Ke.Z)(function*(){const ie=yield Ge.modalController.create({component:Ee.A});yield ie.present();const{data:Qe}=yield ie.onWillDismiss();Qe&&Ge.mapping.addPOILayer(Qe)})()}about(){var Ge=this;return(0,Ke.Z)(function*(){Ge.mapping.unfocusMap();const ie=yield Ge.modalController.create({component:se.t});ie.onDidDismiss().then(Qe=>{Ge.mapping.focusMap()}),yield ie.present()})()}}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)(v.Y36(b.t4),v.Y36(a.sK),v.Y36(Pe.v),v.Y36(b.IN),v.Y36(at.c),v.Y36(we.z),v.Y36(me.c),v.Y36(St.z))},Vt.\u0275cmp=v.Xpm({type:Vt,selectors:[["app-root"]],decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(Ge,ie){1&Ge&&(v.TgZ(0,"ion-app")(1,"ion-split-pane",0)(2,"ion-menu",1)(3,"ion-header")(4,"ion-toolbar")(5,"ion-thumbnail",2),v._UZ(6,"img",3),v.qZA(),v.TgZ(7,"ion-title"),v._uU(8),v.qZA()()(),v.TgZ(9,"ion-content")(10,"ion-list")(11,"ion-menu-toggle",4)(12,"ion-item",5),v._UZ(13,"ion-icon",6),v.TgZ(14,"ion-label"),v._uU(15),v.ALo(16,"translate"),v.qZA()(),v.YNc(17,xt,4,0,"ion-item",7),v.YNc(18,rt,5,3,"ion-item",7),v.YNc(19,lt,4,0,"ion-item",7),v.YNc(20,Ce,4,0,"ion-item",7),v.YNc(21,bt,6,3,"ng-container",8),v.YNc(22,kt,14,7,"ng-container",8),v.TgZ(23,"ion-item",9),v.NdJ("click",function(){return ie.about()}),v._UZ(24,"ion-icon",10),v.TgZ(25,"ion-label"),v._uU(26),v.ALo(27,"translate"),v.qZA()()()()()(),v._UZ(28,"ion-router-outlet",11),v.qZA()()),2&Ge&&(v.xp6(1),v.Q6J("disabled",!0),v.xp6(7),v.Oqu(ie.appManager.title),v.xp6(4),v.Q6J("routerDirection","root")("routerLink",v.DdM(16,Ut)),v.xp6(3),v.hij(" ",v.lcZ(16,12,"ocm.search.sectionTitle")," "),v.xp6(2),v.Q6J("ngIf",ie.enabledFeatures.includes("ROUTE_PLANNER")),v.xp6(1),v.Q6J("ngIf",ie.enabledFeatures.includes("ADD_POI")),v.xp6(1),v.Q6J("ngIf",ie.enabledFeatures.includes("FAVOURITES")),v.xp6(1),v.Q6J("ngIf",ie.enabledFeatures.includes("LAYERS")),v.xp6(1),v.Q6J("ngIf",!ie.isUserAuthenticated()),v.xp6(1),v.Q6J("ngIf",ie.isUserAuthenticated()),v.xp6(4),v.hij(" ",v.lcZ(27,14,"ocm.general.about")," "))},dependencies:[q.O5,b.dr,b.W2,b.Gu,b.gu,b.Ie,b.Q$,b.q_,b.z0,b.zc,b.jI,b.Bs,b.wd,b.sr,b.jP,b.YI,pe.rH,a.X$],encapsulation:2}),Vt})();const Nn=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>Promise.resolve().then(F.bind(F,3548)).then(Vt=>Vt.SearchPageModule)},{path:"journeys",loadChildren:()=>Promise.resolve().then(F.bind(F,5476)).then(Vt=>Vt.JourneysModule)},{path:"signin",loadChildren:()=>Promise.resolve().then(F.bind(F,6779)).then(Vt=>Vt.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>Promise.resolve().then(F.bind(F,1948)).then(Vt=>Vt.PoiEditorPageModule)},{path:"about",loadChildren:()=>Promise.resolve().then(F.bind(F,534)).then(Vt=>Vt.AboutPageModule)},{path:"layer-editor",loadChildren:()=>Promise.resolve().then(F.bind(F,5005)).then(Vt=>Vt.LayerEditorPageModule)}];let un=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt}),Vt.\u0275inj=v.cJS({imports:[pe.Bz.forRoot(Nn,{useHash:!0}),pe.Bz]}),Vt})(),ot=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt}),Vt.\u0275inj=v.cJS({imports:[q.ez,oe.u5,b.Pc,a.aw,re.e]}),Vt})();var Bt=F(6779);let Sn=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt}),Vt.\u0275inj=v.cJS({imports:[q.ez,oe.u5,b.Pc,a.aw,re.e,pe.Bz.forChild([{path:"",component:Le}])]}),Vt})();var Qn=F(6314);let ci=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt}),Vt.\u0275inj=v.cJS({imports:[q.ez,oe.u5,b.Pc,a.aw,re.e,pe.Bz.forChild([{path:"",component:Qn.N}])]}),Vt})();var Un=F(5476),hi=F(1948),Ii=F(534),yi=F(5005);function Bi(){return localStorage.getItem("access_token")}function Mi(Vt){return new ce(Vt,"/assets/i18n/",".json")}let Ki=(()=>{class Vt{}return Vt.\u0275fac=function(Ge){return new(Ge||Vt)},Vt.\u0275mod=v.oAB({type:Vt,bootstrap:[bn]}),Vt.\u0275inj=v.cJS({providers:[{provide:pe.wN,useClass:b.r4}],imports:[d.b2,xe.JF,a.aw.forRoot({loader:{provide:a.Zw,useFactory:Mi,deps:[xe.eN]}}),b.Pc.forRoot(),un,ze.Ar.forRoot({config:{tokenGetter:Bi}}),K.SearchPageModule,ot,Un.JourneysModule,Bt.SignInModule,Ve,he,Ie,hi.PoiEditorPageModule,Sn,ci,Ii.AboutPageModule,yi.LayerEditorPageModule]}),Vt})();Xe.N.production&&(0,v.G48)(),d.q6().bootstrapModule(Ki).catch(Vt=>console.log(Vt))},9898:function(Ln){Ln.exports=function(){"use strict";var Dt,F,d;function v(a,q){if(Dt)if(F){var oe="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Dt+")(sharedChunk); ("+F+")(sharedChunk); self.onerror = null;",b={};Dt(b),d=q(b),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(d.workerUrl=window.URL.createObjectURL(new Blob([oe],{type:"text/javascript"})))}else F=q;else Dt=q}return v(0,function(a){var q=typeof self<"u"?self:{},oe="2.13.0";let b;const he={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==b){const t=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{b=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):t}catch{b=t}}return b},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){return this.API_URL?0===this.API_URL.indexOf("https://api.mapbox.cn")?"https://events.mapbox.cn/events/v2":0===this.API_URL.indexOf("https://api.mapbox.com")?"https://events.mapbox.com/events/v2":null:null},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},Ie={supported:!1,testSupport:function(t){!xe&&K&&(pe?ze(t):Ve=t)}};let Ve,K,xe=!1,pe=!1;function ze(t){const e=t.createTexture();t.bindTexture(t.TEXTURE_2D,e);try{if(t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,K),t.isContextLost())return;Ie.supported=!0}catch{}t.deleteTexture(e),xe=!0}q.document&&(K=q.document.createElement("img"),K.onload=function(){Ve&&ze(Ve),Ve=null,pe=!0},K.onerror=function(){xe=!0,Ve=null},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ce="01";var Ke=Pe;function Pe(t,e,n,s){this.cx=3*t,this.bx=3*(n-t)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(s-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=t,this.p1y=e,this.p2x=n,this.p2y=s}Pe.prototype={sampleCurveX:function(t){return((this.ax*t+this.bx)*t+this.cx)*t},sampleCurveY:function(t){return((this.ay*t+this.by)*t+this.cy)*t},sampleCurveDerivativeX:function(t){return(3*this.ax*t+2*this.bx)*t+this.cx},solveCurveX:function(t,e){if(void 0===e&&(e=1e-6),t<0)return 0;if(t>1)return 1;for(var n=t,s=0;s<8;s++){var h=this.sampleCurveX(n)-t;if(Math.abs(h)<e)return n;var _=this.sampleCurveDerivativeX(n);if(Math.abs(_)<1e-6)break;n-=h/_}var x=0,T=1;for(n=t,s=0;s<20&&(h=this.sampleCurveX(n),!(Math.abs(h-t)<e));s++)t>h?x=n:T=n,n=.5*(T-x)+x;return n},solve:function(t,e){return this.sampleCurveY(this.solveCurveX(t,e))}};var ne=Je;function Je(t,e){this.x=t,this.y=e}Je.prototype={clone:function(){return new Je(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,e){return this.clone()._rotateAround(t,e)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var e=t.x-this.x,n=t.y-this.y;return e*e+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,e){return Math.atan2(this.x*e-this.y*t,this.x*t+this.y*e)},_matMult:function(t){var e=t[2]*this.x+t[3]*this.y;return this.x=t[0]*this.x+t[1]*this.y,this.y=e,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var e=Math.cos(t),n=Math.sin(t),s=n*this.x+e*this.y;return this.x=e*this.x-n*this.y,this.y=s,this},_rotateAround:function(t,e){var n=Math.cos(t),s=Math.sin(t),h=e.y+s*(this.x-e.x)+n*(this.y-e.y);return this.x=e.x+n*(this.x-e.x)-s*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Je.convert=function(t){return t instanceof Je?t:Array.isArray(t)?new Je(t[0],t[1]):t};const Pt=Math.PI/180,at=180/Math.PI;function ge(t){return t*Pt}function ke(t){return t*at}const Le=[[0,0],[1,0],[1,1],[0,1]];function we(t){if(t<=0)return 0;if(t>=1)return 1;const e=t*t,n=e*t;return 4*(t<.5?n:3*(t-e)+n-.75)}function Xe(t,e,n,s){const h=new Ke(t,e,n,s);return function(_){return h.solve(_)}}const He=Xe(.25,.1,.25,1);function me(t,e,n){return Math.min(n,Math.max(e,t))}function de(t,e,n){return(n=me((n-t)/(e-t),0,1))*n*(3-2*n)}function se(t,e,n){const s=n-e,h=((t-e)%s+s)%s+e;return h===e?n:h}function Ee(t,e,n){if(!t.length)return n(null,[]);let s=t.length;const h=new Array(t.length);let _=null;t.forEach((x,T)=>{e(x,(I,A)=>{I&&(_=I),h[T]=A,0==--s&&n(_,h)})})}function _t(t){const e=[];for(const n in t)e.push(t[n]);return e}function It(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}let Gt=1;function Lt(){return Gt++}function yt(){return function t(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,t)}()}function St(t){return t<=1?1:Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))}function xt(t){return!!t&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(t)}function rt(t,e){t.forEach(n=>{e[n]&&(e[n]=e[n].bind(e))})}function lt(t,e){return-1!==t.indexOf(e,t.length-e.length)}function Ce(t,e,n){const s={};for(const h in t)s[h]=e.call(n||this,t[h],h,t);return s}function bt(t,e,n){const s={};for(const h in t)e.call(n||this,t[h],h,t)&&(s[h]=t[h]);return s}function kt(t){return Array.isArray(t)?t.map(kt):"object"==typeof t&&t?Ce(t,kt):t}const Ut={};function bn(t){Ut[t]||(typeof console<"u"&&console.warn(t),Ut[t]=!0)}function Nn(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function un(t){let e=0;for(let n,s,h=0,_=t.length,x=_-1;h<_;x=h++)n=t[h],s=t[x],e+=(s.x-n.x)*(n.y+s.y);return e}function ot(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Bt(t){const e={};if(t.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(n,s,h,_)=>{const x=h||_;return e[s]=!x||x.toLowerCase(),""}),e["max-age"]){const n=parseInt(e["max-age"],10);isNaN(n)?delete e["max-age"]:e["max-age"]=n}return e}let Sn=null;function Qn(t){if(null==Sn){const e=t.navigator?t.navigator.userAgent:null;Sn=!!t.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Sn}function ci(t){try{const e=q[t];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Un(t,e){return[t[4*e],t[4*e+1],t[4*e+2],t[4*e+3]]}const hi="mapbox-tiles";let Ii,yi,Bi=500,Mi=50;function Ni(){try{return q.caches}catch{}}function Ki(){Ni()&&!Ii&&(Ii=q.caches.open(hi))}function Vt(t){const e=t.indexOf("?");if(e<0)return t;const s=function(h){const _=h.indexOf("?");return _>0?h.slice(_+1).split("&"):[]}(t).filter(h=>{const _=h.split("=");return"language"===_[0]||"worldview"===_[0]});return s.length?`${t.slice(0,e)}?${s.join("&")}`:t.slice(0,e)}let Mt=1/0;const Ge={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(Ge);class ie extends Error{constructor(e,n,s){401===n&&xr(s)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=n,this.url=s}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const Qe=ot()?()=>self.worker&&self.worker.referrer:()=>("blob:"===q.location.protocol?q.parent:q).location.href,Wt=function(t,e){if(!(/^file:/.test(n=t.url)||/^file:/.test(Qe())&&!/^\w+:/.test(n))){if(q.fetch&&q.Request&&q.AbortController&&q.Request.prototype.hasOwnProperty("signal"))return function(s,h){const _=new q.AbortController,x=new q.Request(s.url,{method:s.method||"GET",body:s.body,credentials:s.credentials,headers:s.headers,referrer:Qe(),signal:_.signal});let T=!1,I=!1;const A=(L=x.url).indexOf("sku=")>0&&xr(L);var L;"json"===s.type&&x.headers.set("Accept","application/json");const N=(J,ee,ue)=>{if(I)return;if(J&&"SecurityError"!==J.message&&bn(J),ee&&ue)return $(ee);const Re=Date.now();q.fetch(x).then(et=>{if(et.ok){const pt=A?et.clone():null;return $(et,pt,Re)}return h(new ie(et.statusText,et.status,s.url))}).catch(et=>{"AbortError"!==et.name&&h(new Error(`${et.message} ${s.url}`))})},$=(J,ee,ue)=>{("arrayBuffer"===s.type?J.arrayBuffer():"json"===s.type?J.json():J.text()).then(Re=>{I||(ee&&ue&&function(et,pt,Ye){if(Ki(),!Ii)return;const st={status:pt.status,statusText:pt.statusText,headers:new q.Headers};pt.headers.forEach((Qt,Xt)=>st.headers.set(Xt,Qt));const Ct=Bt(pt.headers.get("Cache-Control")||"");if(Ct["no-store"])return;Ct["max-age"]&&st.headers.set("Expires",new Date(Ye+1e3*Ct["max-age"]).toUTCString());const mt=st.headers.get("Expires");mt&&(new Date(mt).getTime()-Ye<42e4||function(Qt,Xt){if(void 0===yi)try{new Response(new ReadableStream),yi=!0}catch{yi=!1}yi?Xt(Qt.body):Qt.blob().then(Xt)}(pt,Qt=>{const Xt=new q.Response(Qt,st);Ki(),Ii&&Ii.then(mn=>mn.put(Vt(et.url),Xt)).catch(mn=>bn(mn.message))}))}(x,ee,ue),T=!0,h(null,Re,J.headers.get("Cache-Control"),J.headers.get("Expires")))}).catch(Re=>{I||h(new Error(Re.message))})};return A?function(J,ee){if(Ki(),!Ii)return ee(null);const ue=Vt(J.url);Ii.then(Re=>{Re.match(ue).then(et=>{const pt=function(Ye){if(!Ye)return!1;const st=new Date(Ye.headers.get("Expires")||0),Ct=Bt(Ye.headers.get("Cache-Control")||"");return st>Date.now()&&!Ct["no-cache"]}(et);Re.delete(ue),pt&&Re.put(ue,et.clone()),ee(null,et,pt)}).catch(ee)}).catch(ee)}(x,N):N(null,null),{cancel:()=>{I=!0,T||_.abort()}}}(t,e);if(ot()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",t,e,void 0,!0)}var n;return function(s,h){const _=new q.XMLHttpRequest;_.open(s.method||"GET",s.url,!0),"arrayBuffer"===s.type&&(_.responseType="arraybuffer");for(const x in s.headers)_.setRequestHeader(x,s.headers[x]);return"json"===s.type&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials="include"===s.credentials,_.onerror=()=>{h(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||0===_.status)&&null!==_.response){let x=_.response;if("json"===s.type)try{x=JSON.parse(_.response)}catch(T){return h(T)}h(null,x,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else h(new ie(_.statusText,_.status,s.url))},_.send(s.body),{cancel:()=>_.abort()}}(t,e)},rn=function(t,e){return Wt(It(t,{type:"arrayBuffer"}),e)};function oi(t){const e=q.document.createElement("a");return e.href=t,e.protocol===q.document.location.protocol&&e.host===q.document.location.host}const Di="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ar,pi;ar=[],pi=0;const mr=function(t,e){if(Ie.supported&&(t.headers||(t.headers={}),t.headers.accept="image/webp,*/*"),pi>=he.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:t,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return ar.push(_),_}pi++;let n=!1;const s=()=>{if(!n)for(n=!0,pi--;ar.length&&pi<he.MAX_PARALLEL_IMAGE_REQUESTS;){const _=ar.shift(),{requestParameters:x,callback:T,cancelled:I}=_;I||(_.cancel=mr(x,T).cancel)}},h=rn(t,(_,x,T,I)=>{s(),_?e(_):x&&(q.createImageBitmap?function(A,L){const N=new q.Blob([new Uint8Array(A)],{type:"image/png"});q.createImageBitmap(N).then($=>{L(null,$)}).catch($=>{L(new Error(`Could not load image because of ${$.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(A,L)=>e(A,L,T,I)):function(A,L){const N=new q.Image,$=q.URL;N.onload=()=>{L(null,N),$.revokeObjectURL(N.src),N.onload=null,q.requestAnimationFrame(()=>{N.src=Di})},N.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const J=new q.Blob([new Uint8Array(A)],{type:"image/png"});N.src=A.byteLength?$.createObjectURL(J):Di}(x,(A,L)=>e(A,L,T,I)))});return{cancel:()=>{h.cancel(),s()}}},Si="NO_ACCESS_TOKEN";function vr(t){return 0===t.indexOf("mapbox:")}function xr(t){return he.API_URL_REGEX.test(t)}function gr(t){return he.API_CDN_URL_REGEX.test(t)}function ui(t){return he.API_STYLE_REGEX.test(t)&&!pn(t)}function pn(t){return he.API_SPRITE_REGEX.test(t)}const wt=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Rt(t){const e=t.match(wt);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function _n(t){const e=t.params.length?`?${t.params.join("&")}`:"";return`${t.protocol}://${t.authority}${t.path}${e}`}function Ue(t){if(!t)return null;const e=t.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(q.atob(e[1]).split("").map(n=>"%"+("00"+n.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Ht{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const n=Ue(he.ACCESS_TOKEN);let s="";return s=n&&n.u?q.btoa(encodeURIComponent(n.u).replace(/%([0-9A-F]{2})/g,(h,_)=>String.fromCharCode(Number("0x"+_)))):he.ACCESS_TOKEN||"",e?`mapbox.eventData.${e}:${s}`:`mapbox.eventData:${s}`}fetchEventData(){const e=ci("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{const h=q.localStorage.getItem(n);h&&(this.eventData=JSON.parse(h));const _=q.localStorage.getItem(s);_&&(this.anonId=_)}catch{bn("Unable to read from LocalStorage")}}saveEventData(){const e=ci("localStorage"),n=this.getStorageKey(),s=this.getStorageKey("uuid");if(e)try{q.localStorage.setItem(s,this.anonId),Object.keys(this.eventData).length>=1&&q.localStorage.setItem(n,JSON.stringify(this.eventData))}catch{bn("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,n,s,h){if(!he.EVENTS_URL)return;const _=Rt(he.EVENTS_URL);_.params.push(`access_token=${h||he.ACCESS_TOKEN||""}`);const x={event:this.type,created:new Date(e).toISOString()},T=n?It(x,n):x,I={url:_n(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([T])};var L;this.pendingRequest=(L=A=>{this.pendingRequest=null,s(A),this.saveEventData(),this.processRequests(h)},Wt(It(I,{method:"POST"}),L))}queueRequest(e,n){this.queue.push(e),this.processRequests(n)}}const z=new class extends Ht{constructor(t){super("appUserTurnstile"),this._customAccessToken=t}postTurnstileEvent(t,e){he.EVENTS_URL&&he.ACCESS_TOKEN&&Array.isArray(t)&&t.some(n=>vr(n)||xr(n))&&this.queueRequest(Date.now(),e)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Ue(he.ACCESS_TOKEN),n=e?e.u:he.ACCESS_TOKEN;let s=n!==this.eventData.tokenU;xt(this.anonId)||(this.anonId=yt(),s=!0);const h=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),x=new Date(h),T=(h-this.eventData.lastSuccess)/864e5;s=s||T>=1||T<-1||_.getDate()!==x.getDate()}else s=!0;s?this.postEvent(h,{sdkIdentifier:"mapbox-gl-js",sdkVersion:oe,skuId:ce,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=h,this.eventData.tokenU=n)},t):this.processRequests()}},k=z.postTurnstileEvent.bind(z),X=new class extends Ht{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(t,e,n,s){this.skuToken=e,this.errorCb=s,he.EVENTS_URL&&(n||he.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Si)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),xt(this.anonId)||(this.anonId=yt()),this.postEvent(n,{sdkIdentifier:"mapbox-gl-js",sdkVersion:oe,skuId:ce,skuToken:this.skuToken,userId:this.anonId},s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t))}},De=X.postMapLoadEvent.bind(X),Ze=new class extends Ht{constructor(){super("gljs.performance")}postPerformanceEvent(t,e){he.EVENTS_URL&&(t||he.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},t)}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:n}=this.queue.shift(),s=function(h){const _=q.performance.getEntriesByType("resource"),x=q.performance.getEntriesByType("mark"),T=function($){const J={};if($)for(const ee in $)if("other"!==ee)for(const ue of $[ee]){const Re=`${ee}ResolveRangeMin`,et=`${ee}ResolveRangeMax`,pt=`${ee}RequestCount`,Ye=`${ee}RequestCachedCount`;J[Re]=Math.min(J[Re]||1/0,ue.startTime),J[et]=Math.max(J[et]||-1/0,ue.responseEnd);const st=Ct=>{void 0===J[Ct]&&(J[Ct]=0),++J[Ct]};void 0!==ue.transferSize&&0===ue.transferSize&&st(Ye),st(pt)}return J}(function($,J){const ee={};if($)for(const ue of $){const Re=J(ue);void 0===ee[Re]&&(ee[Re]=[]),ee[Re].push(ue)}return ee}(_,Me)),I=q.devicePixelRatio,A=q.navigator.connection||q.navigator.mozConnection||q.navigator.webkitConnection,L={counters:[],metadata:[],attributes:[]},N=($,J,ee)=>{null!=ee&&$.push({name:J,value:ee.toString()})};for(const $ in T)N(L.counters,$,T[$]);if(h.interactionRange[0]!==1/0&&h.interactionRange[1]!==-1/0&&(N(L.counters,"interactionRangeMin",h.interactionRange[0]),N(L.counters,"interactionRangeMax",h.interactionRange[1])),x)for(const $ of Object.keys(Fe)){const J=Fe[$],ee=x.find(ue=>ue.name===J);ee&&N(L.counters,J,ee.startTime)}return N(L.counters,"visibilityHidden",h.visibilityHidden),N(L.attributes,"style",function($){if($)for(const J of $){const ee=J.name.split("?")[0];if(ui(ee)){const ue=ee.split("/").slice(-2);if(2===ue.length)return`mapbox://styles/${ue[0]}/${ue[1]}`}}}(_)),N(L.attributes,"terrainEnabled",h.terrainEnabled?"true":"false"),N(L.attributes,"fogEnabled",h.fogEnabled?"true":"false"),N(L.attributes,"projection",h.projection),N(L.attributes,"zoom",h.zoom),N(L.metadata,"devicePixelRatio",I),N(L.metadata,"connectionEffectiveType",A?A.effectiveType:void 0),N(L.metadata,"navigatorUserAgent",q.navigator.userAgent),N(L.metadata,"screenWidth",q.screen.width),N(L.metadata,"screenHeight",q.screen.height),N(L.metadata,"windowWidth",q.innerWidth),N(L.metadata,"windowHeight",q.innerHeight),N(L.metadata,"mapWidth",h.width/I),N(L.metadata,"mapHeight",h.height/I),N(L.metadata,"webglRenderer",h.renderer),N(L.metadata,"webglVendor",h.vendor),N(L.metadata,"sdkVersion",oe),N(L.metadata,"sdkIdentifier","mapbox-gl-js"),L}(n);for(const h of s.metadata);for(const h of s.counters);for(const h of s.attributes);this.postEvent(e,s,()=>{},t)}},dt=Ze.postPerformanceEvent.bind(Ze),Ot=new class extends Ht{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(t,e,n,s){if(!he.API_URL||!he.SESSION_PATH)return;const h=Rt(he.API_URL+he.SESSION_PATH);h.params.push(`sku=${e||""}`),h.params.push(`access_token=${s||he.ACCESS_TOKEN||""}`);const _={url:_n(h),headers:{"Content-Type":"text/plain"}};var T;this.pendingRequest=(T=x=>{this.pendingRequest=null,n(x),this.saveEventData(),this.processRequests(s)},Wt(It(_,{method:"GET"}),T))}getSessionAPI(t,e,n,s){this.skuToken=e,this.errorCb=s,he.SESSION_PATH&&he.API_URL&&(n||he.ACCESS_TOKEN?this.queueRequest({id:t,timestamp:Date.now()},n):this.errorCb(new Error(Si)))}processRequests(t){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:n}=this.queue.shift();e&&this.success[e]||this.getSession(n,this.skuToken,s=>{s?this.errorCb(s):e&&(this.success[e]=!0)},t)}},vt=Ot.getSessionAPI.bind(Ot),ut=new Set,Fe={create:"create",load:"load",fullLoad:"fullLoad"},Be={mark(t){q.performance.mark(t)},measure(t,e,n){q.performance.measure(t,e,n)}};function Me(t){const e=t.name.split("?")[0];return gr(e)&&e.includes("mapbox-gl.js")?"javascript":gr(e)&&e.includes("mapbox-gl.css")?"css":he.API_FONTS_REGEX.test(e)?"fontRange":pn(e)?"sprite":ui(e)?"style":he.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const We=q.performance;function jt(t){const e=t?t.url.toString():void 0;return We.getEntriesByName(e)}let dn,Tn,qn,Yn;const mi={now:()=>void 0!==qn?qn:q.performance.now(),setNow(t){qn=t},restoreNow(){qn=void 0},frame(t){const e=q.requestAnimationFrame(t);return{cancel:()=>q.cancelAnimationFrame(e)}},getImageData(t,e=0){const{width:n,height:s}=t;Yn||(Yn=q.document.createElement("canvas"));const h=Yn.getContext("2d",{willReadFrequently:!0});if(!h)throw new Error("failed to create canvas 2d context");return(n>Yn.width||s>Yn.height)&&(Yn.width=n,Yn.height=s),h.clearRect(-e,-e,n+2*e,s+2*e),h.drawImage(t,0,0,n,s),h.getImageData(-e,-e,n+2*e,s+2*e)},resolveURL:t=>(dn||(dn=q.document.createElement("a")),dn.href=t,dn.href),get devicePixelRatio(){return q.devicePixelRatio},get prefersReducedMotion(){return!!q.matchMedia&&(null==Tn&&(Tn=q.matchMedia("(prefers-reduced-motion: reduce)")),Tn.matches)}};function ei(t,e,n){n[t]&&-1!==n[t].indexOf(e)||(n[t]=n[t]||[],n[t].push(e))}function Oi(t,e,n){if(n&&n[t]){const s=n[t].indexOf(e);-1!==s&&n[t].splice(s,1)}}class Li{constructor(e,n={}){It(this,n),this.type=e}}class Er extends Li{constructor(e,n={}){super("error",It({error:e},n))}}class Gr{on(e,n){return this._listeners=this._listeners||{},ei(e,n,this._listeners),this}off(e,n){return Oi(e,n,this._listeners),Oi(e,n,this._oneTimeListeners),this}once(e,n){return n?(this._oneTimeListeners=this._oneTimeListeners||{},ei(e,n,this._oneTimeListeners),this):new Promise(s=>this.once(e,s))}fire(e,n){"string"==typeof e&&(e=new Li(e,n||{}));const s=e.type;if(this.listens(s)){e.target=this;const h=this._listeners&&this._listeners[s]?this._listeners[s].slice():[];for(const T of h)T.call(this,e);const _=this._oneTimeListeners&&this._oneTimeListeners[s]?this._oneTimeListeners[s].slice():[];for(const T of _)Oi(s,T,this._oneTimeListeners),T.call(this,e);const x=this._eventedParent;x&&(It(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),x.fire(e))}else e instanceof Er&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,n){return this._eventedParent=e,this._eventedParentData=n,this}}var Jt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Xr(t,...e){for(const n of e)for(const s in n)t[s]=n[s];return t}function dr(t){return t instanceof Number||t instanceof String||t instanceof Boolean?t.valueOf():t}function no(t){if(Array.isArray(t))return t.map(no);if(t instanceof Object&&!(t instanceof Number||t instanceof String||t instanceof Boolean)){const e={};for(const n in t)e[n]=no(t[n]);return e}return dr(t)}class fo extends Error{constructor(e,n){super(n),this.message=n,this.key=e}}var bi=fo;class qi{constructor(e,n=[]){this.parent=e,this.bindings={};for(const[s,h]of n)this.bindings[s]=h}concat(e){return new qi(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var Dr=qi;const Kr={kind:"null"},In={kind:"number"},si={kind:"string"},En={kind:"boolean"},fe={kind:"color"},$e={kind:"object"},ct={kind:"value"},zt={kind:"collator"},en={kind:"formatted"},je={kind:"resolvedImage"};function gt(t,e){return{kind:"array",itemType:t,N:e}}function Ft(t){if("array"===t.kind){const e=Ft(t.itemType);return"number"==typeof t.N?`array<${e}, ${t.N}>`:"value"===t.itemType.kind?"array":`array<${e}>`}return t.kind}const gn=[Kr,In,si,En,fe,en,$e,gt(ct),je];function Yt(t,e){if("error"===e.kind)return null;if("array"===t.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!Yt(t.itemType,e.itemType))&&("number"!=typeof t.N||t.N===e.N))return null}else{if(t.kind===e.kind)return null;if("value"===t.kind)for(const n of gn)if(!Yt(n,e))return null}return`Expected ${Ft(t)} but found ${Ft(e)} instead.`}function Gn(t,e){return e.some(n=>n.kind===t.kind)}function Hn(t,e){return e.some(n=>"null"===n?null===t:"array"===n?Array.isArray(t):"object"===n?t&&!Array.isArray(t)&&"object"==typeof t:n===typeof t)}var Ai,Fi={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function Vi(t){return(t=Math.round(t))<0?0:t>255?255:t}function Ir(t){return Vi("%"===t[t.length-1]?parseFloat(t)/100*255:parseInt(t))}function Qi(t){return(e="%"===t[t.length-1]?parseFloat(t)/100:parseFloat(t))<0?0:e>1?1:e;var e}function Hr(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}try{Ai={}.parseCSSColor=function(t){var e,n=t.replace(/ /g,"").toLowerCase();if(n in Fi)return Fi[n].slice();if("#"===n[0])return 4===n.length?(e=parseInt(n.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===n.length&&(e=parseInt(n.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var s=n.indexOf("("),h=n.indexOf(")");if(-1!==s&&h+1===n.length){var _=n.substr(0,s),x=n.substr(s+1,h-(s+1)).split(","),T=1;switch(_){case"rgba":if(4!==x.length)return null;T=Qi(x.pop());case"rgb":return 3!==x.length?null:[Ir(x[0]),Ir(x[1]),Ir(x[2]),T];case"hsla":if(4!==x.length)return null;T=Qi(x.pop());case"hsl":if(3!==x.length)return null;var I=(parseFloat(x[0])%360+360)%360/360,A=Qi(x[1]),L=Qi(x[2]),N=L<=.5?L*(A+1):L+A-L*A,$=2*L-N;return[Vi(255*Hr($,N,I+1/3)),Vi(255*Hr($,N,I)),Vi(255*Hr($,N,I-1/3)),T];default:return null}}return null}}catch{}class zr{constructor(e,n,s,h=1){this.r=e,this.g=n,this.b=s,this.a=h}static parse(e){if(!e)return;if(e instanceof zr)return e;if("string"!=typeof e)return;const n=Ai(e);return n?new zr(n[0]/255*n[3],n[1]/255*n[3],n[2]/255*n[3],n[3]):void 0}toString(){const[e,n,s,h]=this.toArray();return`rgba(${Math.round(e)},${Math.round(n)},${Math.round(s)},${h})`}toArray(){const{r:e,g:n,b:s,a:h}=this;return 0===h?[0,0,0,0]:[255*e/h,255*n/h,255*s/h,h]}toArray01(){const{r:e,g:n,b:s,a:h}=this;return 0===h?[0,0,0,0]:[e/h,n/h,s/h,h]}toArray01PremultipliedAlpha(){const{r:e,g:n,b:s,a:h}=this;return[e,n,s,h]}}zr.black=new zr(0,0,0,1),zr.white=new zr(1,1,1,1),zr.transparent=new zr(0,0,0,0),zr.red=new zr(1,0,0,1),zr.blue=new zr(0,0,1,1);var hr=zr;class lr{constructor(e,n,s){this.sensitivity=e?n?"variant":"case":n?"accent":"base",this.locale=s,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,n){return this.collator.compare(e,n)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class la{constructor(e,n,s,h,_){this.text=e.normalize?e.normalize():e,this.image=n,this.scale=s,this.fontStack=h,this.textColor=_}}class io{constructor(e){this.sections=e}static fromString(e){return new io([new la(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof io?e:io.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const n of this.sections){if(n.image){e.push(["image",n.image.name]);continue}e.push(n.text);const s={};n.fontStack&&(s["text-font"]=["literal",n.fontStack.split(",")]),n.scale&&(s["font-scale"]=n.scale),n.textColor&&(s["text-color"]=["rgba"].concat(n.textColor.toArray())),e.push(s)}return e}}class ro{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new ro({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Ds(t,e,n,s){return"number"==typeof t&&t>=0&&t<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof n&&n>=0&&n<=255?void 0===s||"number"==typeof s&&s>=0&&s<=1?null:`Invalid rgba value [${[t,e,n,s].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof s?[t,e,n,s]:[t,e,n]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Ko(t){if(null===t||"string"==typeof t||"boolean"==typeof t||"number"==typeof t||t instanceof hr||t instanceof lr||t instanceof io||t instanceof ro)return!0;if(Array.isArray(t)){for(const e of t)if(!Ko(e))return!1;return!0}if("object"==typeof t){for(const e in t)if(!Ko(t[e]))return!1;return!0}return!1}function br(t){if(null===t)return Kr;if("string"==typeof t)return si;if("boolean"==typeof t)return En;if("number"==typeof t)return In;if(t instanceof hr)return fe;if(t instanceof lr)return zt;if(t instanceof io)return en;if(t instanceof ro)return je;if(Array.isArray(t)){const e=t.length;let n;for(const s of t){const h=br(s);if(n){if(n===h)continue;n=ct;break}n=h}return gt(n||ct,e)}return $e}function Ur(t){const e=typeof t;return null===t?"":"string"===e||"number"===e||"boolean"===e?String(t):t instanceof hr||t instanceof io||t instanceof ro?t.toString():JSON.stringify(t)}class ca{constructor(e,n){this.type=e,this.value=n}static parse(e,n){if(2!==e.length)return n.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Ko(e[1]))return n.error("invalid value");const s=e[1];let h=br(s);const _=n.expectedType;return"array"!==h.kind||0!==h.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(h=_),new ca(h,s)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof hr?["rgba"].concat(this.value.toArray()):this.value instanceof io?this.value.serialize():this.value}}var Wr=ca,_r=class{constructor(t){this.name="ExpressionEvaluationError",this.message=t}toJSON(){return this.message}};const hs={string:si,number:In,boolean:En,object:$e};class Ro{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");let s,h=1;const _=e[0];if("array"===_){let T,I;if(e.length>2){const A=e[1];if("string"!=typeof A||!(A in hs)||"object"===A)return n.error('The item type argument of "array" must be one of string, number, boolean',1);T=hs[A],h++}else T=ct;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return n.error('The length argument to "array" must be a positive integer literal',2);I=e[2],h++}s=gt(T,I)}else s=hs[_];const x=[];for(;h<e.length;h++){const T=n.parse(e[h],h,ct);if(!T)return null;x.push(T)}return new Ro(s,x)}evaluate(e){for(let n=0;n<this.args.length;n++){const s=this.args[n].evaluate(e);if(!Yt(this.type,br(s)))return s;if(n===this.args.length-1)throw new _r(`Expected value to be of type ${Ft(this.type)}, but found ${Ft(br(s))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,n=[e.kind];if("array"===e.kind){const s=e.itemType;if("string"===s.kind||"number"===s.kind||"boolean"===s.kind){n.push(s.kind);const h=e.N;("number"==typeof h||this.args.length>1)&&n.push(h)}}return n.concat(this.args.map(s=>s.serialize()))}}var lo=Ro;class Qr{constructor(e){this.type=en,this.sections=e}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[1];if(!Array.isArray(s)&&"object"==typeof s)return n.error("First argument must be an image or text section.");const h=[];let _=!1;for(let x=1;x<=e.length-1;++x){const T=e[x];if(_&&"object"==typeof T&&!Array.isArray(T)){_=!1;let I=null;if(T["font-scale"]&&(I=n.parse(T["font-scale"],1,In),!I))return null;let A=null;if(T["text-font"]&&(A=n.parse(T["text-font"],1,gt(si)),!A))return null;let L=null;if(T["text-color"]&&(L=n.parse(T["text-color"],1,fe),!L))return null;const N=h[h.length-1];N.scale=I,N.font=A,N.textColor=L}else{const I=n.parse(e[x],1,ct);if(!I)return null;const A=I.type.kind;if("string"!==A&&"value"!==A&&"null"!==A&&"resolvedImage"!==A)return n.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,h.push({content:I,scale:null,font:null,textColor:null})}}return new Qr(h)}evaluate(e){return new io(this.sections.map(n=>{const s=n.content.evaluate(e);return br(s)===je?new la("",s,null,null,null):new la(Ur(s),null,n.scale?n.scale.evaluate(e):null,n.font?n.font.evaluate(e).join(","):null,n.textColor?n.textColor.evaluate(e):null)}))}eachChild(e){for(const n of this.sections)e(n.content),n.scale&&e(n.scale),n.font&&e(n.font),n.textColor&&e(n.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const n of this.sections){e.push(n.content.serialize());const s={};n.scale&&(s["font-scale"]=n.scale.serialize()),n.font&&(s["text-font"]=n.font.serialize()),n.textColor&&(s["text-color"]=n.textColor.serialize()),e.push(s)}return e}}class js{constructor(e){this.type=je,this.input=e}static parse(e,n){if(2!==e.length)return n.error("Expected two arguments.");const s=n.parse(e[1],1,si);return s?new js(s):n.error("No image name provided.")}evaluate(e){const n=this.input.evaluate(e),s=ro.fromString(n);return s&&e.availableImages&&(s.available=e.availableImages.indexOf(n)>-1),s}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ua={"to-boolean":En,"to-color":fe,"to-number":In,"to-string":si};class Co{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expected at least one argument.");const s=e[0];if(("to-boolean"===s||"to-string"===s)&&2!==e.length)return n.error("Expected one argument.");const h=ua[s],_=[];for(let x=1;x<e.length;x++){const T=n.parse(e[x],x,ct);if(!T)return null;_.push(T)}return new Co(h,_)}evaluate(e){if("boolean"===this.type.kind)return Boolean(this.args[0].evaluate(e));if("color"===this.type.kind){let n,s;for(const h of this.args){if(n=h.evaluate(e),s=null,n instanceof hr)return n;if("string"==typeof n){const _=e.parseColor(n);if(_)return _}else if(Array.isArray(n)&&(s=n.length<3||n.length>4?`Invalid rbga value ${JSON.stringify(n)}: expected an array containing either three or four numeric values.`:Ds(n[0],n[1],n[2],n[3]),!s))return new hr(n[0]/255,n[1]/255,n[2]/255,n[3])}throw new _r(s||`Could not parse color from value '${"string"==typeof n?n:String(JSON.stringify(n))}'`)}if("number"===this.type.kind){let n=null;for(const s of this.args){if(n=s.evaluate(e),null===n)return 0;const h=Number(n);if(!isNaN(h))return h}throw new _r(`Could not convert ${JSON.stringify(n)} to number.`)}return"formatted"===this.type.kind?io.fromString(Ur(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?ro.fromString(Ur(this.args[0].evaluate(e))):Ur(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new Qr([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new js(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(n=>{e.push(n.serialize())}),e}}var To=Co;const Ia=["Unknown","Point","LineString","Polygon"];var zo=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?Ia[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const t=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:n,y:s}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(n*e-t[0])+this.featureDistanceData.bearing[1]*(s*e-t[1])}return 0}parseColor(t){let e=this._parseColorCache[t];return e||(e=this._parseColorCache[t]=hr.parse(t)),e}};class ps{constructor(e,n,s,h){this.name=e,this.type=n,this._evaluate=s,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,n){const s=e[0],h=ps.definitions[s];if(!h)return n.error(`Unknown expression "${s}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(h)?h[0]:h.type,x=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,T=x.filter(([A])=>!Array.isArray(A)||A.length===e.length-1);let I=null;for(const[A,L]of T){I=new Zo(n.registry,n.path,null,n.scope);const N=[];let $=!1;for(let J=1;J<e.length;J++){const ee=e[J],ue=Array.isArray(A)?A[J-1]:A.type,Re=I.parse(ee,1+N.length,ue);if(!Re){$=!0;break}N.push(Re)}if(!$)if(Array.isArray(A)&&A.length!==N.length)I.error(`Expected ${A.length} arguments, but found ${N.length} instead.`);else{for(let J=0;J<N.length;J++){const ee=Array.isArray(A)?A[J]:A.type,ue=N[J];I.concat(J+1).checkSubtype(ee,ue.type)}if(0===I.errors.length)return new ps(s,_,L,N)}}if(1===T.length)n.errors.push(...I.errors);else{const A=(T.length?T:x).map(([N])=>{return $=N,Array.isArray($)?`(${$.map(Ft).join(", ")})`:`(${Ft($.type)}...)`;var $}).join(" | "),L=[];for(let N=1;N<e.length;N++){const $=n.parse(e[N],1+L.length);if(!$)return null;L.push(Ft($.type))}n.error(`Expected arguments of type ${A}, but found (${L.join(", ")}) instead.`)}return null}static register(e,n){ps.definitions=n;for(const s in n)e[s]=ps}}var mo=ps;class Is{constructor(e,n,s){this.type=zt,this.locale=s,this.caseSensitive=e,this.diacriticSensitive=n}static parse(e,n){if(2!==e.length)return n.error("Expected one argument.");const s=e[1];if("object"!=typeof s||Array.isArray(s))return n.error("Collator options argument must be an object.");const h=n.parse(void 0!==s["case-sensitive"]&&s["case-sensitive"],1,En);if(!h)return null;const _=n.parse(void 0!==s["diacritic-sensitive"]&&s["diacritic-sensitive"],1,En);if(!_)return null;let x=null;return s.locale&&(x=n.parse(s.locale,1,si),!x)?null:new Is(h,_,x)}evaluate(e){return new lr(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Ms=8192;function go(t,e){t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[0]),t[3]=Math.max(t[3],e[1])}function Ss(t,e){return!(t[0]<=e[0]||t[2]>=e[2]||t[1]<=e[1]||t[3]>=e[3])}function da(t,e){const n=(180+t[0])/360,s=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(n*h*Ms),Math.round(s*h*Ms)]}function ha(t,e,n){const s=t[0]-e[0],h=t[1]-e[1],_=t[0]-n[0],x=t[1]-n[1];return s*x-_*h==0&&s*_<=0&&h*x<=0}function Qs(t,e){let n=!1;for(let x=0,T=e.length;x<T;x++){const I=e[x];for(let A=0,L=I.length;A<L-1;A++){if(ha(t,I[A],I[A+1]))return!1;(h=I[A])[1]>(s=t)[1]!=(_=I[A+1])[1]>s[1]&&s[0]<(_[0]-h[0])*(s[1]-h[1])/(_[1]-h[1])+h[0]&&(n=!n)}}var s,h,_;return n}function fs(t,e){for(let n=0;n<e.length;n++)if(Qs(t,e[n]))return!0;return!1}function Ma(t,e,n,s){const h=s[0]-n[0],_=s[1]-n[1],x=(t[0]-n[0])*_-h*(t[1]-n[1]),T=(e[0]-n[0])*_-h*(e[1]-n[1]);return x>0&&T<0||x<0&&T>0}function Uo(t,e,n){for(const A of n)for(let L=0;L<A.length-1;++L)if((T=[(x=A[L+1])[0]-(_=A[L])[0],x[1]-_[1]])[0]*(I=[(h=e)[0]-(s=t)[0],h[1]-s[1]])[1]-T[1]*I[0]!=0&&Ma(s,h,_,x)&&Ma(_,x,s,h))return!0;var s,h,_,x,T,I;return!1}function pa(t,e){for(let n=0;n<t.length;++n)if(!Qs(t[n],e))return!1;for(let n=0;n<t.length-1;++n)if(Uo(t[n],t[n+1],e))return!1;return!0}function Sa(t,e){for(let n=0;n<e.length;n++)if(pa(t,e[n]))return!0;return!1}function As(t,e,n){const s=[];for(let h=0;h<t.length;h++){const _=[];for(let x=0;x<t[h].length;x++){const T=da(t[h][x],n);go(e,T),_.push(T)}s.push(_)}return s}function Mo(t,e,n){const s=[];for(let h=0;h<t.length;h++){const _=As(t[h],e,n);s.push(_)}return s}function $s(t,e,n,s){if(t[0]<n[0]||t[0]>n[2]){const h=.5*s;let _=t[0]-n[0]>h?-s:n[0]-t[0]>h?s:0;0===_&&(_=t[0]-n[2]>h?-s:n[2]-t[0]>h?s:0),t[0]+=_}go(e,t)}function Lo(t,e,n,s){const h=Math.pow(2,s.z)*Ms,_=[s.x*Ms,s.y*Ms],x=[];if(!t)return x;for(const T of t)for(const I of T){const A=[I.x+_[0],I.y+_[1]];$s(A,e,n,h),x.push(A)}return x}function ji(t,e,n,s){const h=Math.pow(2,s.z)*Ms,_=[s.x*Ms,s.y*Ms],x=[];if(!t)return x;for(const I of t){const A=[];for(const L of I){const N=[L.x+_[0],L.y+_[1]];go(e,N),A.push(N)}x.push(A)}if(e[2]-e[0]<=h/2){(T=e)[0]=T[1]=1/0,T[2]=T[3]=-1/0;for(const I of x)for(const A of I)$s(A,e,n,h)}var T;return x}class ea{constructor(e,n){this.type=En,this.geojson=e,this.geometries=n}static parse(e,n){if(2!==e.length)return n.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Ko(e[1])){const s=e[1];if("FeatureCollection"===s.type)for(let h=0;h<s.features.length;++h){const _=s.features[h].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new ea(s,s.features[h].geometry)}else if("Feature"===s.type){const h=s.geometry.type;if("Polygon"===h||"MultiPolygon"===h)return new ea(s,s.geometry)}else if("Polygon"===s.type||"MultiPolygon"===s.type)return new ea(s,s)}return n.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(n,s){const h=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=n.canonicalID();if(!x)return!1;if("Polygon"===s.type){const T=As(s.coordinates,_,x),I=Lo(n.geometry(),h,_,x);if(!Ss(h,_))return!1;for(const A of I)if(!Qs(A,T))return!1}if("MultiPolygon"===s.type){const T=Mo(s.coordinates,_,x),I=Lo(n.geometry(),h,_,x);if(!Ss(h,_))return!1;for(const A of I)if(!fs(A,T))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(n,s){const h=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],x=n.canonicalID();if(!x)return!1;if("Polygon"===s.type){const T=As(s.coordinates,_,x),I=ji(n.geometry(),h,_,x);if(!Ss(h,_))return!1;for(const A of I)if(!pa(A,T))return!1}if("MultiPolygon"===s.type){const T=Mo(s.coordinates,_,x),I=ji(n.geometry(),h,_,x);if(!Ss(h,_))return!1;for(const A of I)if(!Sa(A,T))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Vo=ea;function jo(t){if(t instanceof mo&&("get"===t.name&&1===t.args.length||"feature-state"===t.name||"has"===t.name&&1===t.args.length||"properties"===t.name||"geometry-type"===t.name||"id"===t.name||/^filter-/.test(t.name))||t instanceof Vo)return!1;let e=!0;return t.eachChild(n=>{e&&!jo(n)&&(e=!1)}),e}function ms(t){if(t instanceof mo&&"feature-state"===t.name)return!1;let e=!0;return t.eachChild(n=>{e&&!ms(n)&&(e=!1)}),e}function Zs(t,e){if(t instanceof mo&&e.indexOf(t.name)>=0)return!1;let n=!0;return t.eachChild(s=>{n&&!Zs(s,e)&&(n=!1)}),n}class gs{constructor(e,n){this.type=n.type,this.name=e,this.boundExpression=n}static parse(e,n){if(2!==e.length||"string"!=typeof e[1])return n.error("'var' expression requires exactly one string literal argument.");const s=e[1];return n.scope.has(s)?new gs(s,n.scope.get(s)):n.error(`Unknown variable "${s}". Make sure "${s}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var $o=gs;class co{constructor(e,n=[],s,h=new Dr,_=[]){this.registry=e,this.path=n,this.key=n.map(x=>`[${x}]`).join(""),this.scope=h,this.errors=_,this.expectedType=s}parse(e,n,s,h,_={}){return n?this.concat(n,s,h)._parse(e,_):this._parse(e,_)}_parse(e,n){function s(h,_,x){return"assert"===x?new lo(_,[h]):"coerce"===x?new To(_,[h]):h}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if("string"!=typeof h)return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[h];if(_){let x=_.parse(e,this);if(!x)return null;if(this.expectedType){const T=this.expectedType,I=x.type;if("string"!==T.kind&&"number"!==T.kind&&"boolean"!==T.kind&&"object"!==T.kind&&"array"!==T.kind||"value"!==I.kind)if("color"!==T.kind&&"formatted"!==T.kind&&"resolvedImage"!==T.kind||"value"!==I.kind&&"string"!==I.kind){if(this.checkSubtype(T,I))return null}else x=s(x,T,n.typeAnnotation||"coerce");else x=s(x,T,n.typeAnnotation||"assert")}if(!(x instanceof Wr)&&"resolvedImage"!==x.type.kind&&So(x)){const T=new zo;try{x=new Wr(x.type,x.evaluate(T))}catch(I){return this.error(I.message),null}}return x}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,n,s){const h="number"==typeof e?this.path.concat(e):this.path,_=s?this.scope.concat(s):this.scope;return new co(this.registry,h,n||null,_,this.errors)}error(e,...n){const s=`${this.key}${n.map(h=>`[${h}]`).join("")}`;this.errors.push(new bi(s,e))}checkSubtype(e,n){const s=Yt(e,n);return s&&this.error(s),s}}var Zo=co;function So(t){if(t instanceof $o)return So(t.boundExpression);if(t instanceof mo&&"error"===t.name||t instanceof Is||t instanceof Vo)return!1;const e=t instanceof To||t instanceof lo;let n=!0;return t.eachChild(s=>{n=e?n&&So(s):n&&s instanceof Wr}),!!n&&jo(t)&&Zs(t,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function kr(t,e){const n=t.length-1;let s,h,_=0,x=n,T=0;for(;_<=x;)if(T=Math.floor((_+x)/2),s=t[T],h=t[T+1],s<=e){if(T===n||e<h)return T;_=T+1}else{if(!(s>e))throw new _r("Input is not a number.");x=T-1}return 0}class Aa{constructor(e,n,s){this.type=e,this.input=n,this.labels=[],this.outputs=[];for(const[h,_]of s)this.labels.push(h),this.outputs.push(_)}static parse(e,n){if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");const s=n.parse(e[1],1,In);if(!s)return null;const h=[];let _=null;n.expectedType&&"value"!==n.expectedType.kind&&(_=n.expectedType);for(let x=1;x<e.length;x+=2){const T=1===x?-1/0:e[x],I=e[x+1],A=x,L=x+1;if("number"!=typeof T)return n.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',A);if(h.length&&h[h.length-1][0]>=T)return n.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',A);const N=n.parse(I,L,_);if(!N)return null;_=_||N.type,h.push([T,N])}return new Aa(_,s,h)}evaluate(e){const n=this.labels,s=this.outputs;if(1===n.length)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return s[0].evaluate(e);const _=n.length;return h>=n[_-1]?s[_-1].evaluate(e):s[kr(n,h)].evaluate(e)}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let n=0;n<this.labels.length;n++)n>0&&e.push(this.labels[n]),e.push(this.outputs[n].serialize());return e}}var _s=Aa;function vi(t,e,n){return t*(1-n)+e*n}var fa=Object.freeze({__proto__:null,number:vi,color:function(t,e,n){return new hr(vi(t.r,e.r,n),vi(t.g,e.g,n),vi(t.b,e.b,n),vi(t.a,e.a,n))},array:function(t,e,n){return t.map((s,h)=>vi(s,e[h],n))}});const ja=.95047,ys=1.08883,Mr=4/29,ma=6/29,Go=3*ma*ma,$a=Math.PI/180,te=180/Math.PI;function Y(t){return t>.008856451679035631?Math.pow(t,1/3):t/Go+Mr}function W(t){return t>ma?t*t*t:Go*(t-Mr)}function Te(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function fn(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fi(t){const e=fn(t.r),n=fn(t.g),s=fn(t.b),h=Y((.4124564*e+.3575761*n+.1804375*s)/ja),_=Y((.2126729*e+.7151522*n+.072175*s)/1);return{l:116*_-16,a:500*(h-_),b:200*(_-Y((.0193339*e+.119192*n+.9503041*s)/ys)),alpha:t.a}}function pr(t){let e=(t.l+16)/116,n=isNaN(t.a)?e:e+t.a/500,s=isNaN(t.b)?e:e-t.b/200;return e=1*W(e),n=ja*W(n),s=ys*W(s),new hr(Te(3.2404542*n-1.5371385*e-.4985314*s),Te(-.969266*n+1.8760108*e+.041556*s),Te(.0556434*n-.2040259*e+1.0572252*s),t.alpha)}function cr(t,e,n){const s=e-t;return t+n*(s>180||s<-180?s-360*Math.round(s/360):s)}const Ps={forward:fi,reverse:pr,interpolate:function(t,e,n){return{l:vi(t.l,e.l,n),a:vi(t.a,e.a,n),b:vi(t.b,e.b,n),alpha:vi(t.alpha,e.alpha,n)}}},Fo={forward:function(t){const{l:e,a:n,b:s}=fi(t),h=Math.atan2(s,n)*te;return{h:h<0?h+360:h,c:Math.sqrt(n*n+s*s),l:e,alpha:t.a}},reverse:function(t){const e=t.h*$a,n=t.c;return pr({l:t.l,a:Math.cos(e)*n,b:Math.sin(e)*n,alpha:t.alpha})},interpolate:function(t,e,n){return{h:cr(t.h,e.h,n),c:vi(t.c,e.c,n),l:vi(t.l,e.l,n),alpha:vi(t.alpha,e.alpha,n)}}};var Za=Object.freeze({__proto__:null,lab:Ps,hcl:Fo});class ol{constructor(e,n,s,h,_){this.type=e,this.operator=n,this.interpolation=s,this.input=h,this.labels=[],this.outputs=[];for(const[x,T]of _)this.labels.push(x),this.outputs.push(T)}static interpolationFactor(e,n,s,h){let _=0;if("exponential"===e.name)_=Rn(n,e.base,s,h);else if("linear"===e.name)_=Rn(n,1,s,h);else if("cubic-bezier"===e.name){const x=e.controlPoints;_=new Ke(x[0],x[1],x[2],x[3]).solve(Rn(n,1,s,h))}return _}static parse(e,n){let[s,h,_,...x]=e;if(!Array.isArray(h)||0===h.length)return n.error("Expected an interpolation type expression.",1);if("linear"===h[0])h={name:"linear"};else if("exponential"===h[0]){const A=h[1];if("number"!=typeof A)return n.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:A}}else{if("cubic-bezier"!==h[0])return n.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const A=h.slice(1);if(4!==A.length||A.some(L=>"number"!=typeof L||L<0||L>1))return n.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:A}}}if(e.length-1<4)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return n.error("Expected an even number of arguments.");if(_=n.parse(_,2,In),!_)return null;const T=[];let I=null;"interpolate-hcl"===s||"interpolate-lab"===s?I=fe:n.expectedType&&"value"!==n.expectedType.kind&&(I=n.expectedType);for(let A=0;A<x.length;A+=2){const L=x[A],N=x[A+1],$=A+3,J=A+4;if("number"!=typeof L)return n.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',$);if(T.length&&T[T.length-1][0]>=L)return n.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',$);const ee=n.parse(N,J,I);if(!ee)return null;I=I||ee.type,T.push([L,ee])}return"number"===I.kind||"color"===I.kind||"array"===I.kind&&"number"===I.itemType.kind&&"number"==typeof I.N?new ol(I,s,h,_,T):n.error(`Type ${Ft(I)} is not interpolatable.`)}evaluate(e){const n=this.labels,s=this.outputs;if(1===n.length)return s[0].evaluate(e);const h=this.input.evaluate(e);if(h<=n[0])return s[0].evaluate(e);const _=n.length;if(h>=n[_-1])return s[_-1].evaluate(e);const x=kr(n,h),T=ol.interpolationFactor(this.interpolation,h,n[x],n[x+1]),I=s[x].evaluate(e),A=s[x+1].evaluate(e);return"interpolate"===this.operator?fa[this.type.kind.toLowerCase()](I,A,T):"interpolate-hcl"===this.operator?Fo.reverse(Fo.interpolate(Fo.forward(I),Fo.forward(A),T)):Ps.reverse(Ps.interpolate(Ps.forward(I),Ps.forward(A),T))}eachChild(e){e(this.input);for(const n of this.outputs)e(n)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const n=[this.operator,e,this.input.serialize()];for(let s=0;s<this.labels.length;s++)n.push(this.labels[s],this.outputs[s].serialize());return n}}function Rn(t,e,n,s){const h=s-n,_=t-n;return 0===h?0:1===e?_/h:(Math.pow(e,_)-1)/(Math.pow(e,h)-1)}var ki=ol;class Ga{constructor(e,n){this.type=e,this.args=n}static parse(e,n){if(e.length<2)return n.error("Expectected at least one argument.");let s=null;const h=n.expectedType;h&&"value"!==h.kind&&(s=h);const _=[];for(const T of e.slice(1)){const I=n.parse(T,1+_.length,s,void 0,{typeAnnotation:"omit"});if(!I)return null;s=s||I.type,_.push(I)}const x=h&&_.some(T=>Yt(h,T.type));return new Ga(x?ct:s,_)}evaluate(e){let n,s=null,h=0;for(const _ of this.args){if(h++,s=_.evaluate(e),s&&s instanceof ro&&!s.available&&(n||(n=s),s=null,h===this.args.length))return n;if(null!==s)break}return s}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var Tl=Ga;class so{constructor(e,n){this.type=n.type,this.bindings=[].concat(e),this.result=n}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const n of this.bindings)e(n[1]);e(this.result)}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const s=[];for(let _=1;_<e.length-1;_+=2){const x=e[_];if("string"!=typeof x)return n.error(`Expected string, but found ${typeof x} instead.`,_);if(/[^a-zA-Z0-9_]/.test(x))return n.error("Variable names must contain only alphanumeric characters or '_'.",_);const T=n.parse(e[_+1],_+1);if(!T)return null;s.push([x,T])}const h=n.parse(e[e.length-1],e.length-1,n.expectedType,s);return h?new so(s,h):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[n,s]of this.bindings)e.push(n,s.serialize());return e.push(this.result.serialize()),e}}var Wl=so;class Gs{constructor(e,n,s){this.type=e,this.index=n,this.input=s}static parse(e,n){if(3!==e.length)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,In),h=n.parse(e[2],2,gt(n.expectedType||ct));return s&&h?new Gs(h.type.itemType,s,h):null}evaluate(e){const n=this.index.evaluate(e),s=this.input.evaluate(e);if(n<0)throw new _r(`Array index out of bounds: ${n} < 0.`);if(n>=s.length)throw new _r(`Array index out of bounds: ${n} > ${s.length-1}.`);if(n!==Math.floor(n))throw new _r(`Array index must be an integer, but found ${n} instead.`);return s[n]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Qo=Gs;class Hs{constructor(e,n){this.type=En,this.needle=e,this.haystack=n}static parse(e,n){if(3!==e.length)return n.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,ct),h=n.parse(e[2],2,ct);return s&&h?Gn(s.type,[En,si,In,Kr,ct])?new Hs(s,h):n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ft(s.type)} instead`):null}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(null==s)return!1;if(!Hn(n,["boolean","string","number","null"]))throw new _r(`Expected first argument to be of type boolean, string, number or null, but found ${Ft(br(n))} instead.`);if(!Hn(s,["string","array"]))throw new _r(`Expected second argument to be of type array or string, but found ${Ft(br(s))} instead.`);return s.indexOf(n)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var es=Hs;class Ws{constructor(e,n,s){this.type=In,this.needle=e,this.haystack=n,this.fromIndex=s}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,ct),h=n.parse(e[2],2,ct);if(!s||!h)return null;if(!Gn(s.type,[En,si,In,Kr,ct]))return n.error(`Expected first argument to be of type boolean, string, number or null, but found ${Ft(s.type)} instead`);if(4===e.length){const _=n.parse(e[3],3,In);return _?new Ws(s,h,_):null}return new Ws(s,h)}evaluate(e){const n=this.needle.evaluate(e),s=this.haystack.evaluate(e);if(!Hn(n,["boolean","string","number","null"]))throw new _r(`Expected first argument to be of type boolean, string, number or null, but found ${Ft(br(n))} instead.`);if(!Hn(s,["string","array"]))throw new _r(`Expected second argument to be of type array or string, but found ${Ft(br(s))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return s.indexOf(n,h)}return s.indexOf(n)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Qc=Ws;class sl{constructor(e,n,s,h,_,x){this.inputType=e,this.type=n,this.input=s,this.cases=h,this.outputs=_,this.otherwise=x}static parse(e,n){if(e.length<5)return n.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return n.error("Expected an even number of arguments.");let s,h;n.expectedType&&"value"!==n.expectedType.kind&&(h=n.expectedType);const _={},x=[];for(let A=2;A<e.length-1;A+=2){let L=e[A];const N=e[A+1];Array.isArray(L)||(L=[L]);const $=n.concat(A);if(0===L.length)return $.error("Expected at least one branch label.");for(const ee of L){if("number"!=typeof ee&&"string"!=typeof ee)return $.error("Branch labels must be numbers or strings.");if("number"==typeof ee&&Math.abs(ee)>Number.MAX_SAFE_INTEGER)return $.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof ee&&Math.floor(ee)!==ee)return $.error("Numeric branch labels must be integer values.");if(s){if($.checkSubtype(s,br(ee)))return null}else s=br(ee);if(void 0!==_[String(ee)])return $.error("Branch labels must be unique.");_[String(ee)]=x.length}const J=n.parse(N,A,h);if(!J)return null;h=h||J.type,x.push(J)}const T=n.parse(e[1],1,ct);if(!T)return null;const I=n.parse(e[e.length-1],e.length-1,h);return I?"value"!==T.type.kind&&n.concat(1).checkSubtype(s,T.type)?null:new sl(s,h,T,_,x,I):null}evaluate(e){const n=this.input.evaluate(e);return(br(n)===this.inputType&&this.outputs[this.cases[n]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],n=Object.keys(this.cases).sort(),s=[],h={};for(const x of n){const T=h[this.cases[x]];void 0===T?(h[this.cases[x]]=s.length,s.push([this.cases[x],[x]])):s[T][1].push(x)}const _=x=>"number"===this.inputType.kind?Number(x):x;for(const[x,T]of s)e.push(1===T.length?_(T[0]):T.map(_)),e.push(this.outputs[x].serialize());return e.push(this.otherwise.serialize()),e}}var M=sl;class G{constructor(e,n,s){this.type=e,this.branches=n,this.otherwise=s}static parse(e,n){if(e.length<4)return n.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return n.error("Expected an odd number of arguments.");let s;n.expectedType&&"value"!==n.expectedType.kind&&(s=n.expectedType);const h=[];for(let x=1;x<e.length-1;x+=2){const T=n.parse(e[x],x,En);if(!T)return null;const I=n.parse(e[x+1],x+1,s);if(!I)return null;h.push([T,I]),s=s||I.type}const _=n.parse(e[e.length-1],e.length-1,s);return _?new G(s,h,_):null}evaluate(e){for(const[n,s]of this.branches)if(n.evaluate(e))return s.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[n,s]of this.branches)e(n),e(s);e(this.otherwise)}outputDefined(){return this.branches.every(([e,n])=>n.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(n=>{e.push(n.serialize())}),e}}var S=G;class j{constructor(e,n,s,h){this.type=e,this.input=n,this.beginIndex=s,this.endIndex=h}static parse(e,n){if(e.length<=2||e.length>=5)return n.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const s=n.parse(e[1],1,ct),h=n.parse(e[2],2,In);if(!s||!h)return null;if(!Gn(s.type,[gt(ct),si,ct]))return n.error(`Expected first argument to be of type array or string, but found ${Ft(s.type)} instead`);if(4===e.length){const _=n.parse(e[3],3,In);return _?new j(s.type,s,h,_):null}return new j(s.type,s,h)}evaluate(e){const n=this.input.evaluate(e),s=this.beginIndex.evaluate(e);if(!Hn(n,["string","array"]))throw new _r(`Expected first argument to be of type array or string, but found ${Ft(br(n))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return n.slice(s,h)}return n.slice(s)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var _e=j;function Et(t,e){return"=="===t||"!="===t?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Cn(t,e,n,s){return 0===s.compare(e,n)}function Vn(t,e,n){const s="=="!==t&&"!="!==t;return class U0{constructor(_,x,T){this.type=En,this.lhs=_,this.rhs=x,this.collator=T,this.hasUntypedArgument="value"===_.type.kind||"value"===x.type.kind}static parse(_,x){if(3!==_.length&&4!==_.length)return x.error("Expected two or three arguments.");const T=_[0];let I=x.parse(_[1],1,ct);if(!I)return null;if(!Et(T,I.type))return x.concat(1).error(`"${T}" comparisons are not supported for type '${Ft(I.type)}'.`);let A=x.parse(_[2],2,ct);if(!A)return null;if(!Et(T,A.type))return x.concat(2).error(`"${T}" comparisons are not supported for type '${Ft(A.type)}'.`);if(I.type.kind!==A.type.kind&&"value"!==I.type.kind&&"value"!==A.type.kind)return x.error(`Cannot compare types '${Ft(I.type)}' and '${Ft(A.type)}'.`);s&&("value"===I.type.kind&&"value"!==A.type.kind?I=new lo(A.type,[I]):"value"!==I.type.kind&&"value"===A.type.kind&&(A=new lo(I.type,[A])));let L=null;if(4===_.length){if("string"!==I.type.kind&&"string"!==A.type.kind&&"value"!==I.type.kind&&"value"!==A.type.kind)return x.error("Cannot use collator to compare non-string types.");if(L=x.parse(_[3],3,zt),!L)return null}return new U0(I,A,L)}evaluate(_){const x=this.lhs.evaluate(_),T=this.rhs.evaluate(_);if(s&&this.hasUntypedArgument){const I=br(x),A=br(T);if(I.kind!==A.kind||"string"!==I.kind&&"number"!==I.kind)throw new _r(`Expected arguments for "${t}" to be (string, string) or (number, number), but found (${I.kind}, ${A.kind}) instead.`)}if(this.collator&&!s&&this.hasUntypedArgument){const I=br(x),A=br(T);if("string"!==I.kind||"string"!==A.kind)return e(_,x,T)}return this.collator?n(_,x,T,this.collator.evaluate(_)):e(_,x,T)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[t];return this.eachChild(x=>{_.push(x.serialize())}),_}}}const Ci=Vn("==",function(t,e,n){return e===n},Cn),ii=Vn("!=",function(t,e,n){return e!==n},function(t,e,n,s){return!Cn(0,e,n,s)}),Gi=Vn("<",function(t,e,n){return e<n},function(t,e,n,s){return s.compare(e,n)<0}),ir=Vn(">",function(t,e,n){return e>n},function(t,e,n,s){return s.compare(e,n)>0}),sr=Vn("<=",function(t,e,n){return e<=n},function(t,e,n,s){return s.compare(e,n)<=0}),_o=Vn(">=",function(t,e,n){return e>=n},function(t,e,n,s){return s.compare(e,n)>=0});class yo{constructor(e,n,s,h,_,x){this.type=si,this.number=e,this.locale=n,this.currency=s,this.unit=h,this.minFractionDigits=_,this.maxFractionDigits=x}static parse(e,n){if(3!==e.length)return n.error("Expected two arguments.");const s=n.parse(e[1],1,In);if(!s)return null;const h=e[2];if("object"!=typeof h||Array.isArray(h))return n.error("NumberFormat options argument must be an object.");let _=null;if(h.locale&&(_=n.parse(h.locale,1,si),!_))return null;let x=null;if(h.currency&&(x=n.parse(h.currency,1,si),!x))return null;let T=null;if(h.unit&&(T=n.parse(h.unit,1,si),!T))return null;let I=null;if(h["min-fraction-digits"]&&(I=n.parse(h["min-fraction-digits"],1,In),!I))return null;let A=null;return h["max-fraction-digits"]&&(A=n.parse(h["max-fraction-digits"],1,In),!A)?null:new yo(s,_,x,T,I,A)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Os{constructor(e){this.type=In,this.input=e}static parse(e,n){if(2!==e.length)return n.error(`Expected 1 argument, but found ${e.length-1} instead.`);const s=n.parse(e[1],1);return s?"array"!==s.type.kind&&"string"!==s.type.kind&&"value"!==s.type.kind?n.error(`Expected argument of type string or array, but found ${Ft(s.type)} instead.`):new Os(s):null}evaluate(e){const n=this.input.evaluate(e);if("string"==typeof n||Array.isArray(n))return n.length;throw new _r(`Expected value to be of type string or array, but found ${Ft(br(n))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(n=>{e.push(n.serialize())}),e}}const ts={"==":Ci,"!=":ii,">":ir,"<":Gi,">=":_o,"<=":sr,array:lo,at:Qo,boolean:lo,case:S,coalesce:Tl,collator:Is,format:Qr,image:js,in:es,"index-of":Qc,interpolate:ki,"interpolate-hcl":ki,"interpolate-lab":ki,length:Os,let:Wl,literal:Wr,match:M,number:lo,"number-format":yo,object:lo,slice:_e,step:_s,string:lo,"to-boolean":To,"to-color":To,"to-number":To,"to-string":To,var:$o,within:Vo};function ql(t,[e,n,s,h]){e=e.evaluate(t),n=n.evaluate(t),s=s.evaluate(t);const _=h?h.evaluate(t):1,x=Ds(e,n,s,_);if(x)throw new _r(x);return new hr(e/255*_,n/255*_,s/255*_,_)}function El(t,e){return t in e}function Pa(t,e){const n=e[t];return void 0===n?null:n}function vs(t){return{type:t}}mo.register(ts,{error:[{kind:"error"},[si],(t,[e])=>{throw new _r(e.evaluate(t))}],typeof:[si,[ct],(t,[e])=>Ft(br(e.evaluate(t)))],"to-rgba":[gt(In,4),[fe],(t,[e])=>e.evaluate(t).toArray()],rgb:[fe,[In,In,In],ql],rgba:[fe,[In,In,In,In],ql],has:{type:En,overloads:[[[si],(t,[e])=>El(e.evaluate(t),t.properties())],[[si,$e],(t,[e,n])=>El(e.evaluate(t),n.evaluate(t))]]},get:{type:ct,overloads:[[[si],(t,[e])=>Pa(e.evaluate(t),t.properties())],[[si,$e],(t,[e,n])=>Pa(e.evaluate(t),n.evaluate(t))]]},"feature-state":[ct,[si],(t,[e])=>Pa(e.evaluate(t),t.featureState||{})],properties:[$e,[],t=>t.properties()],"geometry-type":[si,[],t=>t.geometryType()],id:[ct,[],t=>t.id()],zoom:[In,[],t=>t.globals.zoom],pitch:[In,[],t=>t.globals.pitch||0],"distance-from-center":[In,[],t=>t.distanceFromCenter()],"heatmap-density":[In,[],t=>t.globals.heatmapDensity||0],"line-progress":[In,[],t=>t.globals.lineProgress||0],"sky-radial-progress":[In,[],t=>t.globals.skyRadialProgress||0],accumulated:[ct,[],t=>void 0===t.globals.accumulated?null:t.globals.accumulated],"+":[In,vs(In),(t,e)=>{let n=0;for(const s of e)n+=s.evaluate(t);return n}],"*":[In,vs(In),(t,e)=>{let n=1;for(const s of e)n*=s.evaluate(t);return n}],"-":{type:In,overloads:[[[In,In],(t,[e,n])=>e.evaluate(t)-n.evaluate(t)],[[In],(t,[e])=>-e.evaluate(t)]]},"/":[In,[In,In],(t,[e,n])=>e.evaluate(t)/n.evaluate(t)],"%":[In,[In,In],(t,[e,n])=>e.evaluate(t)%n.evaluate(t)],ln2:[In,[],()=>Math.LN2],pi:[In,[],()=>Math.PI],e:[In,[],()=>Math.E],"^":[In,[In,In],(t,[e,n])=>Math.pow(e.evaluate(t),n.evaluate(t))],sqrt:[In,[In],(t,[e])=>Math.sqrt(e.evaluate(t))],log10:[In,[In],(t,[e])=>Math.log(e.evaluate(t))/Math.LN10],ln:[In,[In],(t,[e])=>Math.log(e.evaluate(t))],log2:[In,[In],(t,[e])=>Math.log(e.evaluate(t))/Math.LN2],sin:[In,[In],(t,[e])=>Math.sin(e.evaluate(t))],cos:[In,[In],(t,[e])=>Math.cos(e.evaluate(t))],tan:[In,[In],(t,[e])=>Math.tan(e.evaluate(t))],asin:[In,[In],(t,[e])=>Math.asin(e.evaluate(t))],acos:[In,[In],(t,[e])=>Math.acos(e.evaluate(t))],atan:[In,[In],(t,[e])=>Math.atan(e.evaluate(t))],min:[In,vs(In),(t,e)=>Math.min(...e.map(n=>n.evaluate(t)))],max:[In,vs(In),(t,e)=>Math.max(...e.map(n=>n.evaluate(t)))],abs:[In,[In],(t,[e])=>Math.abs(e.evaluate(t))],round:[In,[In],(t,[e])=>{const n=e.evaluate(t);return n<0?-Math.round(-n):Math.round(n)}],floor:[In,[In],(t,[e])=>Math.floor(e.evaluate(t))],ceil:[In,[In],(t,[e])=>Math.ceil(e.evaluate(t))],"filter-==":[En,[si,ct],(t,[e,n])=>t.properties()[e.value]===n.value],"filter-id-==":[En,[ct],(t,[e])=>t.id()===e.value],"filter-type-==":[En,[si],(t,[e])=>t.geometryType()===e.value],"filter-<":[En,[si,ct],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s<h}],"filter-id-<":[En,[ct],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<s}],"filter->":[En,[si,ct],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s>h}],"filter-id->":[En,[ct],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>s}],"filter-<=":[En,[si,ct],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s<=h}],"filter-id-<=":[En,[ct],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n<=s}],"filter->=":[En,[si,ct],(t,[e,n])=>{const s=t.properties()[e.value],h=n.value;return typeof s==typeof h&&s>=h}],"filter-id->=":[En,[ct],(t,[e])=>{const n=t.id(),s=e.value;return typeof n==typeof s&&n>=s}],"filter-has":[En,[ct],(t,[e])=>e.value in t.properties()],"filter-has-id":[En,[],t=>null!==t.id()&&void 0!==t.id()],"filter-type-in":[En,[gt(si)],(t,[e])=>e.value.indexOf(t.geometryType())>=0],"filter-id-in":[En,[gt(ct)],(t,[e])=>e.value.indexOf(t.id())>=0],"filter-in-small":[En,[si,gt(ct)],(t,[e,n])=>n.value.indexOf(t.properties()[e.value])>=0],"filter-in-large":[En,[si,gt(ct)],(t,[e,n])=>function(s,h,_,x){for(;_<=x;){const T=_+x>>1;if(h[T]===s)return!0;h[T]>s?x=T-1:_=T+1}return!1}(t.properties()[e.value],n.value,0,n.value.length-1)],all:{type:En,overloads:[[[En,En],(t,[e,n])=>e.evaluate(t)&&n.evaluate(t)],[vs(En),(t,e)=>{for(const n of e)if(!n.evaluate(t))return!1;return!0}]]},any:{type:En,overloads:[[[En,En],(t,[e,n])=>e.evaluate(t)||n.evaluate(t)],[vs(En),(t,e)=>{for(const n of e)if(n.evaluate(t))return!0;return!1}]]},"!":[En,[En],(t,[e])=>!e.evaluate(t)],"is-supported-script":[En,[si],(t,[e])=>{const n=t.globals&&t.globals.isSupportedScript;return!n||n(e.evaluate(t))}],upcase:[si,[si],(t,[e])=>e.evaluate(t).toUpperCase()],downcase:[si,[si],(t,[e])=>e.evaluate(t).toLowerCase()],concat:[si,vs(ct),(t,e)=>e.map(n=>Ur(n.evaluate(t))).join("")],"resolved-locale":[si,[zt],(t,[e])=>e.evaluate(t).resolvedLocale()]});var Ha=ts;function ga(t){return{result:"success",value:t}}function ao(t){return{result:"error",value:t}}function Rs(t){return"data-driven"===t["property-type"]}function wr(t){return!!t.expression&&t.expression.parameters.indexOf("zoom")>-1}function Yl(t){return!!t.expression&&t.expression.interpolated}function er(t){return t instanceof Number?"number":t instanceof String?"string":t instanceof Boolean?"boolean":Array.isArray(t)?"array":null===t?"null":typeof t}function Jl(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}function eu(t){return t}function U(t,e){const n="color"===e.type,s=t.stops&&"object"==typeof t.stops[0][0],h=s||!(s||void 0!==t.property),_=t.type||(Yl(e)?"exponential":"interval");if(n&&((t=Xr({},t)).stops&&(t.stops=t.stops.map(A=>[A[0],hr.parse(A[1])])),t.default=hr.parse(t.default?t.default:e.default)),t.colorSpace&&"rgb"!==t.colorSpace&&!Za[t.colorSpace])throw new Error(`Unknown color space: ${t.colorSpace}`);let x,T,I;if("exponential"===_)x=ht;else if("interval"===_)x=Se;else if("categorical"===_){x=H,T=Object.create(null);for(const A of t.stops)T[A[0]]=A[1];I=typeof t.stops[0][0]}else{if("identity"!==_)throw new Error(`Unknown function type "${_}"`);x=hn}if(s){const A={},L=[];for(let J=0;J<t.stops.length;J++){const ee=t.stops[J],ue=ee[0].zoom;void 0===A[ue]&&(A[ue]={zoom:ue,type:t.type,property:t.property,default:t.default,stops:[]},L.push(ue)),A[ue].stops.push([ee[0].value,ee[1]])}const N=[];for(const J of L)N.push([A[J].zoom,U(A[J],e)]);const $={name:"linear"};return{kind:"composite",interpolationType:$,interpolationFactor:ki.interpolationFactor.bind(void 0,$),zoomStops:N.map(J=>J[0]),evaluate:({zoom:J},ee)=>ht({stops:N,base:t.base},e,J).evaluate(J,ee)}}if(h){const A="exponential"===_?{name:"exponential",base:void 0!==t.base?t.base:1}:null;return{kind:"camera",interpolationType:A,interpolationFactor:ki.interpolationFactor.bind(void 0,A),zoomStops:t.stops.map(L=>L[0]),evaluate:({zoom:L})=>x(t,e,L,T,I)}}return{kind:"source",evaluate(A,L){const N=L&&L.properties?L.properties[t.property]:void 0;return void 0===N?le(t.default,e.default):x(t,e,N,T,I)}}}function le(t,e,n){return void 0!==t?t:void 0!==e?e:void 0!==n?n:void 0}function H(t,e,n,s,h){return le(typeof n===h?s[n]:void 0,t.default,e.default)}function Se(t,e,n){if("number"!==er(n))return le(t.default,e.default);const s=t.stops.length;if(1===s||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[s-1][0])return t.stops[s-1][1];const h=kr(t.stops.map(_=>_[0]),n);return t.stops[h][1]}function ht(t,e,n){const s=void 0!==t.base?t.base:1;if("number"!==er(n))return le(t.default,e.default);const h=t.stops.length;if(1===h||n<=t.stops[0][0])return t.stops[0][1];if(n>=t.stops[h-1][0])return t.stops[h-1][1];const _=kr(t.stops.map(L=>L[0]),n),x=function(L,N,$,J){const ee=J-$,ue=L-$;return 0===ee?0:1===N?ue/ee:(Math.pow(N,ue)-1)/(Math.pow(N,ee)-1)}(n,s,t.stops[_][0],t.stops[_+1][0]),T=t.stops[_][1],I=t.stops[_+1][1];let A=fa[e.type]||eu;if(t.colorSpace&&"rgb"!==t.colorSpace){const L=Za[t.colorSpace];A=(N,$)=>L.reverse(L.interpolate(L.forward(N),L.forward($),x))}return"function"==typeof T.evaluate?{evaluate(...L){const N=T.evaluate.apply(void 0,L),$=I.evaluate.apply(void 0,L);if(void 0!==N&&void 0!==$)return A(N,$,x)}}:A(T,I,x)}function hn(t,e,n){return"color"===e.type?n=hr.parse(n):"formatted"===e.type?n=io.fromString(n.toString()):"resolvedImage"===e.type?n=ro.fromString(n.toString()):er(n)===e.type||"enum"===e.type&&e.values[n]||(n=void 0),le(n,t.default,e.default)}class Dn{constructor(e,n){var s;this.expression=e,this._warningHistory={},this._evaluator=new zo,this._defaultValue=n?"color"===(s=n).type&&(Jl(s.default)||Array.isArray(s.default))?new hr(0,0,0,0):"color"===s.type?hr.parse(s.default)||null:void 0===s.default?null:s.default:null,this._enumValues=n&&"enum"===n.type?n.values:null}evaluateWithoutErrorHandling(e,n,s,h,_,x,T,I){return this._evaluator.globals=e,this._evaluator.feature=n,this._evaluator.featureState=s,this._evaluator.canonical=h||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=I||null,this.expression.evaluate(this._evaluator)}evaluate(e,n,s,h,_,x,T,I){this._evaluator.globals=e,this._evaluator.feature=n||null,this._evaluator.featureState=s||null,this._evaluator.canonical=h||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=T||null,this._evaluator.featureDistanceData=I||null;try{const A=this.expression.evaluate(this._evaluator);if(null==A||"number"==typeof A&&A!=A)return this._defaultValue;if(this._enumValues&&!(A in this._enumValues))throw new _r(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(A)} instead.`);return A}catch(A){return this._warningHistory[A.message]||(this._warningHistory[A.message]=!0,typeof console<"u"&&console.warn(A.message)),this._defaultValue}}}function ai(t){return Array.isArray(t)&&t.length>0&&"string"==typeof t[0]&&t[0]in Ha}function Hi(t,e){const n=new Zo(Ha,[],e?function(h){const _={color:fe,string:si,number:In,enum:si,boolean:En,formatted:en,resolvedImage:je};return"array"===h.type?gt(_[h.value]||ct,h.length):_[h.type]}(e):void 0),s=n.parse(t,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return s?ga(new Dn(s,e)):ao(n.errors)}class tr{constructor(e,n){this.kind=e,this._styleExpression=n,this.isStateDependent="constant"!==e&&!ms(n.expression)}evaluateWithoutErrorHandling(e,n,s,h,_,x){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,h,_,x)}evaluate(e,n,s,h,_,x){return this._styleExpression.evaluate(e,n,s,h,_,x)}}class or{constructor(e,n,s,h){this.kind=e,this.zoomStops=s,this._styleExpression=n,this.isStateDependent="camera"!==e&&!ms(n.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,n,s,h,_,x){return this._styleExpression.evaluateWithoutErrorHandling(e,n,s,h,_,x)}evaluate(e,n,s,h,_,x){return this._styleExpression.evaluate(e,n,s,h,_,x)}interpolationFactor(e,n,s){return this.interpolationType?ki.interpolationFactor(this.interpolationType,e,n,s):0}}function Yi(t,e){if("error"===(t=Hi(t,e)).result)return t;const n=t.value.expression,s=jo(n);if(!s&&!Rs(e))return ao([new bi("","data expressions not supported")]);const h=Zs(n,["zoom","pitch","distance-from-center"]);if(!h&&!wr(e))return ao([new bi("","zoom expressions not supported")]);const _=Cr(n);return _||h?_ instanceof bi?ao([_]):_ instanceof ki&&!Yl(e)?ao([new bi("",'"interpolate" expressions cannot be used with this property')]):ga(_?new or(s?"camera":"composite",t.value,_.labels,_ instanceof ki?_.interpolation:void 0):new tr(s?"constant":"source",t.value)):ao([new bi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Br{constructor(e,n){this._parameters=e,this._specification=n,Xr(this,U(this._parameters,this._specification))}static deserialize(e){return new Br(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Cr(t){let e=null;if(t instanceof Wl)e=Cr(t.result);else if(t instanceof Tl){for(const n of t.args)if(e=Cr(n),e)break}else(t instanceof _s||t instanceof ki)&&t.input instanceof mo&&"zoom"===t.input.name&&(e=t);return e instanceof bi||t.eachChild(n=>{const s=Cr(n);s instanceof bi?e=s:!e&&s?e=new bi("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&s&&e!==s&&(e=new bi("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class zn{constructor(e,n,s,h){this.message=(e?`${e}: `:"")+s,h&&(this.identifier=h),null!=n&&n.__line__&&(this.line=n.__line__)}}function vo(t){const e=t.key,n=t.value,s=t.valueSpec||{},h=t.objectElementValidators||{},_=t.style,x=t.styleSpec;let T=[];const I=er(n);if("object"!==I)return[new zn(e,n,`object expected, ${I} found`)];for(const A in n){const L=A.split(".")[0];let $;h[L]?$=h[L]:s[L]?$=ko:h["*"]?$=h["*"]:s["*"]&&($=ko),$?T=T.concat($({key:(e&&`${e}.`)+A,value:n[A],valueSpec:s[L]||s["*"],style:_,styleSpec:x,object:n,objectKey:A},n)):T.push(new zn(e,n[A],`unknown property "${A}"`))}for(const A in s)h[A]||s[A].required&&void 0===s[A].default&&void 0===n[A]&&T.push(new zn(e,n,`missing required property "${A}"`));return T}function qs(t){const e=t.value,n=t.valueSpec,s=t.style,h=t.styleSpec,_=t.key,x=t.arrayElementValidator||ko;if("array"!==er(e))return[new zn(_,e,`array expected, ${er(e)} found`)];if(n.length&&e.length!==n.length)return[new zn(_,e,`array length ${n.length} expected, length ${e.length} found`)];if(n["min-length"]&&e.length<n["min-length"])return[new zn(_,e,`array length at least ${n["min-length"]} expected, length ${e.length} found`)];let T={type:n.value,values:n.values,minimum:n.minimum,maximum:n.maximum,function:void 0};h.$version<7&&(T.function=n.function),"object"===er(n.value)&&(T=n.value);let I=[];for(let A=0;A<e.length;A++)I=I.concat(x({array:e,arrayIndex:A,value:e[A],valueSpec:T,style:s,styleSpec:h,key:`${_}[${A}]`}));return I}function _a(t){const e=t.key,n=t.value,s=t.valueSpec;let h=er(n);if("number"===h&&n!=n&&(h="NaN"),"number"!==h)return[new zn(e,n,`number expected, ${h} found`)];if("minimum"in s){let _=s.minimum;if("array"===er(s.minimum)&&(_=s.minimum[t.arrayIndex]),n<_)return[new zn(e,n,`${n} is less than the minimum value ${_}`)]}if("maximum"in s){let _=s.maximum;if("array"===er(s.maximum)&&(_=s.maximum[t.arrayIndex]),n>_)return[new zn(e,n,`${n} is greater than the maximum value ${_}`)]}return[]}function Ho(t){const e=t.valueSpec,n=dr(t.value.type);let s,h,_,x={};const T="categorical"!==n&&void 0===t.value.property,I=!T,A="array"===er(t.value.stops)&&"array"===er(t.value.stops[0])&&"object"===er(t.value.stops[0][0]),L=vo({key:t.key,value:t.value,valueSpec:t.styleSpec.function,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{stops:function(J){if("identity"===n)return[new zn(J.key,J.value,'identity function may not have a "stops" property')];let ee=[];const ue=J.value;return ee=ee.concat(qs({key:J.key,value:ue,valueSpec:J.valueSpec,style:J.style,styleSpec:J.styleSpec,arrayElementValidator:N})),"array"===er(ue)&&0===ue.length&&ee.push(new zn(J.key,ue,"array must have at least one stop")),ee},default:function(J){return ko({key:J.key,value:J.value,valueSpec:e,style:J.style,styleSpec:J.styleSpec})}}});return"identity"===n&&T&&L.push(new zn(t.key,t.value,'missing required property "property"')),"identity"===n||t.value.stops||L.push(new zn(t.key,t.value,'missing required property "stops"')),"exponential"===n&&t.valueSpec.expression&&!Yl(t.valueSpec)&&L.push(new zn(t.key,t.value,"exponential functions not supported")),t.styleSpec.$version>=8&&(I&&!Rs(t.valueSpec)?L.push(new zn(t.key,t.value,"property functions not supported")):T&&!wr(t.valueSpec)&&L.push(new zn(t.key,t.value,"zoom functions not supported"))),"categorical"!==n&&!A||void 0!==t.value.property||L.push(new zn(t.key,t.value,'"property" property is required')),L;function N(J){let ee=[];const ue=J.value,Re=J.key;if("array"!==er(ue))return[new zn(Re,ue,`array expected, ${er(ue)} found`)];if(2!==ue.length)return[new zn(Re,ue,`array length 2 expected, length ${ue.length} found`)];if(A){if("object"!==er(ue[0]))return[new zn(Re,ue,`object expected, ${er(ue[0])} found`)];if(void 0===ue[0].zoom)return[new zn(Re,ue,"object stop key must have zoom")];if(void 0===ue[0].value)return[new zn(Re,ue,"object stop key must have value")];const et=dr(ue[0].zoom);if("number"!=typeof et)return[new zn(Re,ue[0].zoom,"stop zoom values must be numbers")];if(_&&_>et)return[new zn(Re,ue[0].zoom,"stop zoom values must appear in ascending order")];et!==_&&(_=et,h=void 0,x={}),ee=ee.concat(vo({key:`${Re}[0]`,value:ue[0],valueSpec:{zoom:{}},style:J.style,styleSpec:J.styleSpec,objectElementValidators:{zoom:_a,value:$}}))}else ee=ee.concat($({key:`${Re}[0]`,value:ue[0],valueSpec:{},style:J.style,styleSpec:J.styleSpec},ue));return ai(no(ue[1]))?ee.concat([new zn(`${Re}[1]`,ue[1],"expressions are not allowed in function stops.")]):ee.concat(ko({key:`${Re}[1]`,value:ue[1],valueSpec:e,style:J.style,styleSpec:J.styleSpec}))}function $(J,ee){const ue=er(J.value),Re=dr(J.value),et=null!==J.value?J.value:ee;if(s){if(ue!==s)return[new zn(J.key,et,`${ue} stop domain type must match previous stop domain type ${s}`)]}else s=ue;if("number"!==ue&&"string"!==ue&&"boolean"!==ue&&"number"!=typeof Re&&"string"!=typeof Re&&"boolean"!=typeof Re)return[new zn(J.key,et,"stop domain value must be a number, string, or boolean")];if("number"!==ue&&"categorical"!==n){let pt=`number expected, ${ue} found`;return Rs(e)&&void 0===n&&(pt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zn(J.key,et,pt)]}return"categorical"!==n||"number"!==ue||"number"==typeof Re&&isFinite(Re)&&Math.floor(Re)===Re?"categorical"!==n&&"number"===ue&&"number"==typeof Re&&"number"==typeof h&&void 0!==h&&Re<h?[new zn(J.key,et,"stop domain values must appear in ascending order")]:(h=Re,"categorical"===n&&Re in x?[new zn(J.key,et,"stop domain values must be unique")]:(x[Re]=!0,[])):[new zn(J.key,et,`integer expected, found ${String(Re)}`)]}}function Ys(t){const e=("property"===t.expressionContext?Yi:Hi)(no(t.value),t.valueSpec);if("error"===e.result)return e.value.map(s=>new zn(`${t.key}${s.key}`,t.value,s.message));const n=e.value.expression||e.value._styleExpression.expression;if("property"===t.expressionContext&&"text-font"===t.propertyKey&&!n.outputDefined())return[new zn(t.key,t.value,`Invalid data expression for "${t.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===t.expressionContext&&"layout"===t.propertyType&&!ms(n))return[new zn(t.key,t.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===t.expressionContext)return Wa(n,t);if(t.expressionContext&&0===t.expressionContext.indexOf("cluster")){if(!Zs(n,["zoom","feature-state"]))return[new zn(t.key,t.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===t.expressionContext&&!jo(n))return[new zn(t.key,t.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Wa(t,e){const n=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const h of e.valueSpec.expression.parameters)n.delete(h);if(0===n.size)return[];const s=[];return t instanceof mo&&n.has(t.name)?[new zn(e.key,e.value,`["${t.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(t.eachChild(h=>{s.push(...Wa(h,e))}),s)}function Ls(t){const e=t.key,n=t.value,s=t.valueSpec,h=[];return Array.isArray(s.values)?-1===s.values.indexOf(dr(n))&&h.push(new zn(e,n,`expected one of [${s.values.join(", ")}], ${JSON.stringify(n)} found`)):-1===Object.keys(s.values).indexOf(dr(n))&&h.push(new zn(e,n,`expected one of [${Object.keys(s.values).join(", ")}], ${JSON.stringify(n)} found`)),h}function Ec(t){if(!0===t||!1===t)return!0;if(!Array.isArray(t)||0===t.length)return!1;switch(t[0]){case"has":return t.length>=2&&"$id"!==t[1]&&"$type"!==t[1];case"in":return t.length>=3&&("string"!=typeof t[1]||Array.isArray(t[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==t.length||Array.isArray(t[1])||Array.isArray(t[2]);case"any":case"all":for(const e of t.slice(1))if(!Ec(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function Dl(t,e="fill"){if(null==t)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Ec(t)||(t=Il(t));const n=t;let s=!0;try{s=function(A){if(!uo(A))return A;let L=no(A);return al(L),L=Fs(L),L}(n)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(n,null,2)}\n        `)}const h=Jt[`filter_${e}`],_=Hi(s,h);let x=null;if("error"===_.result)throw new Error(_.value.map(A=>`${A.key}: ${A.message}`).join(", "));x=(A,L,N)=>_.value.evaluate(A,L,{},N);let T=null,I=null;if(s!==n){const A=Hi(n,h);if("error"===A.result)throw new Error(A.value.map(L=>`${L.key}: ${L.message}`).join(", "));T=(L,N,$,J,ee)=>A.value.evaluate(L,N,{},$,void 0,void 0,J,ee),I=!jo(A.value.expression)}return{filter:x,dynamicFilter:T||void 0,needGeometry:Dc(s),needFeature:!!I}}function Fs(t){if(!Array.isArray(t))return t;const e=function(n){if(ll.has(n[0]))for(let s=1;s<n.length;s++)if(uo(n[s]))return!0;return n}(t);return!0===e?e:e.map(n=>Fs(n))}function al(t){let e=!1;const n=[];if("case"===t[0]){for(let s=1;s<t.length-1;s+=2)e=e||uo(t[s]),n.push(t[s+1]);n.push(t[t.length-1])}else if("match"===t[0]){e=e||uo(t[1]);for(let s=2;s<t.length-1;s+=2)n.push(t[s+1]);n.push(t[t.length-1])}else if("step"===t[0]){e=e||uo(t[1]);for(let s=1;s<t.length-1;s+=2)n.push(t[s+1])}e&&(t.length=0,t.push("any",...n));for(let s=1;s<t.length;s++)al(t[s])}function uo(t){if(!Array.isArray(t))return!1;if("pitch"===(e=t[0])||"distance-from-center"===e)return!0;var e;for(let n=1;n<t.length;n++)if(uo(t[n]))return!0;return!1}const ll=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function cl(t,e){return t<e?-1:t>e?1:0}function Dc(t){if(!Array.isArray(t))return!1;if("within"===t[0])return!0;for(let e=1;e<t.length;e++)if(Dc(t[e]))return!0;return!1}function Il(t){if(!t)return!0;const e=t[0];return t.length<=1?"any"!==e:"=="===e?Xl(t[1],t[2],"=="):"!="===e?Ml(Xl(t[1],t[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Xl(t[1],t[2],e):"any"===e?(n=t.slice(1),["any"].concat(n.map(Il))):"all"===e?["all"].concat(t.slice(1).map(Il)):"none"===e?["all"].concat(t.slice(1).map(Il).map(Ml)):"in"===e?Ic(t[1],t.slice(2)):"!in"===e?Ml(Ic(t[1],t.slice(2))):"has"===e?Js(t[1]):"!has"===e?Ml(Js(t[1])):"within"!==e||t;var n}function Xl(t,e,n){switch(t){case"$type":return[`filter-type-${n}`,e];case"$id":return[`filter-id-${n}`,e];default:return[`filter-${n}`,t,e]}}function Ic(t,e){if(0===e.length)return!1;switch(t){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(n=>typeof n!=typeof e[0])?["filter-in-large",t,["literal",e.sort(cl)]]:["filter-in-small",t,["literal",e]]}}function Js(t){switch(t){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",t]}}function Ml(t){return["!",t]}function Sl(t){return Ec(no(t.value))?Ys(Xr({},t,{expressionContext:"filter",valueSpec:t.styleSpec[`filter_${t.layerType||"fill"}`]})):Mc(t)}function Mc(t){const e=t.value,n=t.key;if("array"!==er(e))return[new zn(n,e,`array expected, ${er(e)} found`)];const s=t.styleSpec;let h,_=[];if(e.length<1)return[new zn(n,e,"filter array must have at least 1 element")];switch(_=_.concat(Ls({key:`${n}[0]`,value:e[0],valueSpec:s.filter_operator,style:t.style,styleSpec:t.styleSpec})),dr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===dr(e[1])&&_.push(new zn(n,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&_.push(new zn(n,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=er(e[1]),"string"!==h&&_.push(new zn(`${n}[1]`,e[1],`string expected, ${h} found`)));for(let x=2;x<e.length;x++)h=er(e[x]),"$type"===dr(e[1])?_=_.concat(Ls({key:`${n}[${x}]`,value:e[x],valueSpec:s.geometry_type,style:t.style,styleSpec:t.styleSpec})):"string"!==h&&"number"!==h&&"boolean"!==h&&_.push(new zn(`${n}[${x}]`,e[x],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let x=1;x<e.length;x++)_=_.concat(Mc({key:`${n}[${x}]`,value:e[x],style:t.style,styleSpec:t.styleSpec}));break;case"has":case"!has":h=er(e[1]),2!==e.length?_.push(new zn(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==h&&_.push(new zn(`${n}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=er(e[1]),2!==e.length?_.push(new zn(n,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==h&&_.push(new zn(`${n}[1]`,e[1],`object expected, ${h} found`))}return _}function qa(t,e){const n=t.key,s=t.style,h=t.styleSpec,_=t.value,x=t.objectKey,T=h[`${e}_${t.layerType}`];if(!T)return[];const I=x.match(/^(.*)-transition$/);if("paint"===e&&I&&T[I[1]]&&T[I[1]].transition)return ko({key:n,value:_,valueSpec:h.transition,style:s,styleSpec:h});const A=t.valueSpec||T[x];if(!A)return[new zn(n,_,`unknown property "${x}"`)];let L;if("string"===er(_)&&Rs(A)&&!A.tokens&&(L=/^{([^}]+)}$/.exec(_)))return[new zn(n,_,`"${x}" does not support interpolation syntax\nUse an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(L[1])} }\`.`)];const N=[];return"symbol"===t.layerType&&("text-field"===x&&s&&!s.glyphs&&N.push(new zn(n,_,'use of "text-field" requires a style "glyphs" property')),"text-font"===x&&Jl(no(_))&&"identity"===dr(_.type)&&N.push(new zn(n,_,'"text-font" does not support identity functions'))),N.concat(ko({key:t.key,value:_,valueSpec:A,style:s,styleSpec:h,expressionContext:"property",propertyType:e,propertyKey:x}))}function Sc(t){return qa(t,"paint")}function Kl(t){return qa(t,"layout")}function Ql(t){let e=[];const n=t.value,s=t.key,h=t.style,_=t.styleSpec;n.type||n.ref||e.push(new zn(s,n,'either "type" or "ref" is required'));let x=dr(n.type);const T=dr(n.ref);if(n.id){const I=dr(n.id);for(let A=0;A<t.arrayIndex;A++){const L=h.layers[A];dr(L.id)===I&&e.push(new zn(s,n.id,`duplicate layer id "${n.id}", previously used at line ${L.id.__line__}`))}}if("ref"in n){let I;["type","source","source-layer","filter","layout"].forEach(A=>{A in n&&e.push(new zn(s,n[A],`"${A}" is prohibited for ref layers`))}),h.layers.forEach(A=>{dr(A.id)===T&&(I=A)}),I?I.ref?e.push(new zn(s,n.ref,"ref cannot reference another ref layer")):x=dr(I.type):"string"==typeof T&&e.push(new zn(s,n.ref,`ref layer "${T}" not found`))}else if("background"!==x&&"sky"!==x)if(n.source){const I=h.sources&&h.sources[n.source],A=I&&dr(I.type);I?"vector"===A&&"raster"===x?e.push(new zn(s,n.source,`layer "${n.id}" requires a raster source`)):"raster"===A&&"raster"!==x?e.push(new zn(s,n.source,`layer "${n.id}" requires a vector source`)):"vector"!==A||n["source-layer"]?"raster-dem"===A&&"hillshade"!==x?e.push(new zn(s,n.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==x||!n.paint||!n.paint["line-gradient"]&&!n.paint["line-trim-offset"]||"geojson"===A&&I.lineMetrics||e.push(new zn(s,n,`layer "${n.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new zn(s,n,`layer "${n.id}" must specify a "source-layer"`)):e.push(new zn(s,n.source,`source "${n.source}" not found`))}else e.push(new zn(s,n,'missing required property "source"'));return e=e.concat(vo({key:s,value:n,valueSpec:_.layer,style:t.style,styleSpec:t.styleSpec,objectElementValidators:{"*":()=>[],type:()=>ko({key:`${s}.type`,value:n.type,valueSpec:_.layer.type,style:t.style,styleSpec:t.styleSpec,object:n,objectKey:"type"}),filter:I=>Sl(Xr({layerType:x},I)),layout:I=>vo({layer:n,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":A=>Kl(Xr({layerType:x},A))}}),paint:I=>vo({layer:n,key:I.key,value:I.value,valueSpec:{},style:I.style,styleSpec:I.styleSpec,objectElementValidators:{"*":A=>Sc(Xr({layerType:x},A))}})}})),e}function ul(t){const e=t.value,n=t.key,s=er(e);return"string"!==s?[new zn(n,e,`string expected, ${s} found`)]:[]}const ec={promoteId:function({key:t,value:e}){if("string"===er(e))return ul({key:t,value:e});{const n=[];for(const s in e)n.push(...ul({key:`${t}.${s}`,value:e[s]}));return n}}};function Al(t){const e=t.value,n=t.key,s=t.styleSpec,h=t.style;if(!e.type)return[new zn(n,e,'"type" is required')];const _=dr(e.type);let x;switch(_){case"vector":case"raster":case"raster-dem":return x=vo({key:n,value:e,valueSpec:s[`source_${_.replace("-","_")}`],style:t.style,styleSpec:s,objectElementValidators:ec}),x;case"geojson":if(x=vo({key:n,value:e,valueSpec:s.source_geojson,style:h,styleSpec:s,objectElementValidators:ec}),e.cluster)for(const T in e.clusterProperties){const[I,A]=e.clusterProperties[T],L="string"==typeof I?[I,["accumulated"],["get",T]]:I;x.push(...Ys({key:`${n}.${T}.map`,value:A,expressionContext:"cluster-map"})),x.push(...Ys({key:`${n}.${T}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return x;case"video":return vo({key:n,value:e,valueSpec:s.source_video,style:h,styleSpec:s});case"image":return vo({key:n,value:e,valueSpec:s.source_image,style:h,styleSpec:s});case"canvas":return[new zn(n,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Ls({key:`${n}.type`,value:e.type,valueSpec:{values:tu(s)},style:h,styleSpec:s})}}function tu(t){return t.source.reduce((e,n)=>{const s=t[n];return"enum"===s.type.type&&(e=e.concat(Object.keys(s.type.values))),e},[])}function ns(t){const e=t.value,n=t.styleSpec,s=n.light,h=t.style;let _=[];const x=er(e);if(void 0===e)return _;if("object"!==x)return _=_.concat([new zn("light",e,`object expected, ${x} found`)]),_;for(const T in e){const I=T.match(/^(.*)-transition$/);_=_.concat(I&&s[I[1]]&&s[I[1]].transition?ko({key:T,value:e[T],valueSpec:n.transition,style:h,styleSpec:n}):s[T]?ko({key:T,value:e[T],valueSpec:s[T],style:h,styleSpec:n}):[new zn(T,e[T],`unknown property "${T}"`)])}return _}function Pl(t){const e=t.value,n=t.key,s=t.style,h=t.styleSpec,_=h.terrain;let x=[];const T=er(e);if(void 0===e)return x;if("object"!==T)return x=x.concat([new zn("terrain",e,`object expected, ${T} found`)]),x;for(const I in e){const A=I.match(/^(.*)-transition$/);x=x.concat(A&&_[A[1]]&&_[A[1]].transition?ko({key:I,value:e[I],valueSpec:h.transition,style:s,styleSpec:h}):_[I]?ko({key:I,value:e[I],valueSpec:_[I],style:s,styleSpec:h}):[new zn(I,e[I],`unknown property "${I}"`)])}if(e.source){const I=s.sources&&s.sources[e.source],A=I&&dr(I.type);I?"raster-dem"!==A&&x.push(new zn(n,e.source,`terrain cannot be used with a source of type ${String(A)}, it only be used with a "raster-dem" source type`)):x.push(new zn(n,e.source,`source "${e.source}" not found`))}else x.push(new zn(n,e,'terrain is missing required property "source"'));return x}function ta(t){const e=t.value,n=t.style,s=t.styleSpec,h=s.fog;let _=[];const x=er(e);if(void 0===e)return _;if("object"!==x)return _=_.concat([new zn("fog",e,`object expected, ${x} found`)]),_;for(const T in e){const I=T.match(/^(.*)-transition$/);_=_.concat(I&&h[I[1]]&&h[I[1]].transition?ko({key:T,value:e[T],valueSpec:s.transition,style:n,styleSpec:s}):h[T]?ko({key:T,value:e[T],valueSpec:h[T],style:n,styleSpec:s}):[new zn(T,e[T],`unknown property "${T}"`)])}return _}const Ac={"*":()=>[],array:qs,boolean:function(t){const e=t.value,n=t.key,s=er(e);return"boolean"!==s?[new zn(n,e,`boolean expected, ${s} found`)]:[]},number:_a,color:function(t){const e=t.key,n=t.value,s=er(n);return"string"!==s?[new zn(e,n,`color expected, ${s} found`)]:null===Ai(n)?[new zn(e,n,`color expected, "${n}" found`)]:[]},enum:Ls,filter:Sl,function:Ho,layer:Ql,object:vo,source:Al,light:ns,terrain:Pl,fog:ta,string:ul,formatted:function(t){return 0===ul(t).length?[]:Ys(t)},resolvedImage:function(t){return 0===ul(t).length?[]:Ys(t)},projection:function(t){const e=t.value,n=t.styleSpec,s=n.projection,h=t.style;let _=[];const x=er(e);if("object"===x)for(const T in e)_=_.concat(ko({key:T,value:e[T],valueSpec:s[T],style:h,styleSpec:n}));else"string"!==x&&(_=_.concat([new zn("projection",e,`object or string expected, ${x} found`)]));return _}};function ko(t){const e=t.value,n=t.valueSpec,s=t.styleSpec;return n.expression&&Jl(dr(e))?Ho(t):n.expression&&ai(no(e))?Ys(t):n.type&&Ac[n.type]?Ac[n.type](t):vo(Xr({},t,{valueSpec:n.type?s[n.type]:n}))}function nu(t){const e=t.value,n=t.key,s=ul(t);return s.length||(-1===e.indexOf("{fontstack}")&&s.push(new zn(n,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&s.push(new zn(n,e,'"glyphs" url must include a "{range}" token'))),s}function Ol(t,e=Jt){return ks(ko({key:"",value:t,valueSpec:e.$root,styleSpec:e,style:t,objectElementValidators:{glyphs:nu,"*":()=>[]}}))}const oh=t=>ks(Sc(t)),iu=t=>ks(Kl(t));function ks(t){return t.slice().sort((e,n)=>e.line&&n.line?e.line-n.line:0)}function ru(t,e){let n=!1;if(e&&e.length)for(const s of e)t.fire(new Er(new Error(s.message))),n=!0;return n}var Eo=Xs;function Xs(t,e,n){var s=this.cells=[];if(t instanceof ArrayBuffer){this.arrayBuffer=t;var h=new Int32Array(this.arrayBuffer);t=h[0],this.d=(e=h[1])+2*(n=h[2]);for(var _=0;_<this.d*this.d;_++){var x=h[3+_],T=h[3+_+1];s.push(x===T?null:h.subarray(x,T))}var I=h[3+s.length+1];this.keys=h.subarray(h[3+s.length],I),this.bboxes=h.subarray(I),this.insert=this._insertReadonly}else{this.d=e+2*n;for(var A=0;A<this.d*this.d;A++)s.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=t,this.padding=n,this.scale=e/t,this.uid=0;var L=n/e*t;this.min=-L,this.max=t+L}Xs.prototype.insert=function(t,e,n,s,h){this._forEachCell(e,n,s,h,this._insertCell,this.uid++),this.keys.push(t),this.bboxes.push(e),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(h)},Xs.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Xs.prototype._insertCell=function(t,e,n,s,h,_){this.cells[h].push(_)},Xs.prototype.query=function(t,e,n,s,h){var _=this.min,x=this.max;if(t<=_&&e<=_&&x<=n&&x<=s&&!h)return Array.prototype.slice.call(this.keys);var T=[];return this._forEachCell(t,e,n,s,this._queryCell,T,{},h),T},Xs.prototype._queryCell=function(t,e,n,s,h,_,x,T){var I=this.cells[h];if(null!==I)for(var A=this.keys,L=this.bboxes,N=0;N<I.length;N++){var $=I[N];if(void 0===x[$]){var J=4*$;(T?T(L[J+0],L[J+1],L[J+2],L[J+3]):t<=L[J+2]&&e<=L[J+3]&&n>=L[J+0]&&s>=L[J+1])?(x[$]=!0,_.push(A[$])):x[$]=!1}}},Xs.prototype._forEachCell=function(t,e,n,s,h,_,x,T){for(var I=this._convertToCellCoord(t),A=this._convertToCellCoord(e),L=this._convertToCellCoord(n),N=this._convertToCellCoord(s),$=I;$<=L;$++)for(var J=A;J<=N;J++){var ee=this.d*J+$;if((!T||T(this._convertFromCellCoord($),this._convertFromCellCoord(J),this._convertFromCellCoord($+1),this._convertFromCellCoord(J+1)))&&h.call(this,t,e,n,s,ee,_,x,T))return}},Xs.prototype._convertFromCellCoord=function(t){return(t-this.padding)/this.scale},Xs.prototype._convertToCellCoord=function(t){return Math.max(0,Math.min(this.d-1,Math.floor(t*this.scale)+this.padding))},Xs.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var t=this.cells,e=3+this.cells.length+1+1,n=0,s=0;s<this.cells.length;s++)n+=this.cells[s].length;var h=new Int32Array(e+n+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;for(var _=e,x=0;x<t.length;x++){var T=t[x];h[3+x]=_,h.set(T,_),_+=T.length}return h[3+t.length]=_,h.set(this.keys,_),h[3+t.length+1]=_+=this.keys.length,h.set(this.bboxes,_),_+=this.bboxes.length,h.buffer};const xs={};function Kn(t,e,n={}){Object.defineProperty(t,"_classRegistryKey",{value:e,writeable:!1}),xs[e]={klass:t,omit:n.omit||[]}}Kn(Object,"Object"),Eo.serialize=function(t,e){const n=t.toArrayBuffer();return e&&e.push(n),{buffer:n}},Eo.deserialize=function(t){return new Eo(t.buffer)},Object.defineProperty(Eo,"name",{value:"Grid"}),Kn(Eo,"Grid"),Kn(hr,"Color"),Kn(Error,"Error"),Kn(ie,"AJAXError"),Kn(ro,"ResolvedImage"),Kn(Br,"StylePropertyFunction"),Kn(Dn,"StyleExpression",{omit:["_evaluator"]}),Kn(or,"ZoomDependentExpression"),Kn(tr,"ZoomConstantExpression"),Kn(mo,"CompoundExpression",{omit:["_evaluate"]});for(const t in Ha)xs[Ha[t]._classRegistryKey]||Kn(Ha[t],`Expression${t}`);function Ya(t){return t&&typeof ArrayBuffer<"u"&&(t instanceof ArrayBuffer||t.constructor&&"ArrayBuffer"===t.constructor.name)}function Bs(t){return q.ImageBitmap&&t instanceof q.ImageBitmap}function Oa(t,e){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp)return t;if(Ya(t)||Bs(t))return e&&e.push(t),t;if(ArrayBuffer.isView(t)){const n=t;return e&&e.push(n.buffer),n}if(t instanceof q.ImageData)return e&&e.push(t.data.buffer),t;if(Array.isArray(t)){const n=[];for(const s of t)n.push(Oa(s,e));return n}if("object"==typeof t){const n=t.constructor,s=n._classRegistryKey;if(!s)throw new Error(`can't serialize object of unregistered class ${s}`);const h=n.serialize?n.serialize(t,e):{};if(!n.serialize){for(const _ in t)t.hasOwnProperty(_)&&(xs[s].omit.indexOf(_)>=0||(h[_]=Oa(t[_],e)));t instanceof Error&&(h.message=t.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==s&&(h.$name=s),h}throw new Error("can't serialize object of type "+typeof t)}function ya(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||t instanceof Boolean||t instanceof Number||t instanceof String||t instanceof Date||t instanceof RegExp||Ya(t)||Bs(t)||ArrayBuffer.isView(t)||t instanceof q.ImageData)return t;if(Array.isArray(t))return t.map(ya);if("object"==typeof t){const e=t.$name||"Object",{klass:n}=xs[e];if(!n)throw new Error(`can't deserialize unregistered class ${e}`);if(n.deserialize)return n.deserialize(t);const s=Object.create(n.prototype);for(const h of Object.keys(t))"$name"!==h&&(s[h]=ya(t[h]));return s}throw new Error("can't deserialize object of type "+typeof t)}const ou=t=>t>=1536&&t<=1791,ud=t=>t>=1872&&t<=1919,Pr=t=>t>=2208&&t<=2303,Ru=t=>t>=11904&&t<=12031,Pc=t=>t>=12032&&t<=12255,Lu=t=>t>=12272&&t<=12287,Oc=t=>t>=12288&&t<=12351,su=t=>t>=12352&&t<=12447,Rl=t=>t>=12448&&t<=12543,au=t=>t>=12544&&t<=12591,tc=t=>t>=12704&&t<=12735,sh=t=>t>=12736&&t<=12783,dd=t=>t>=12784&&t<=12799,eo=t=>t>=12800&&t<=13055,lu=t=>t>=13056&&t<=13311,dl=t=>t>=13312&&t<=19903,cu=t=>t>=19968&&t<=40959,Ns=t=>t>=40960&&t<=42127,Ja=t=>t>=42128&&t<=42191,uu=t=>t>=44032&&t<=55215,nc=t=>t>=63744&&t<=64255,Xa=t=>t>=64336&&t<=65023,ic=t=>t>=65040&&t<=65055,m=t=>t>=65072&&t<=65103,i=t=>t>=65104&&t<=65135,c=t=>t>=65136&&t<=65279,y=t=>t>=65280&&t<=65519;function u(t){for(const e of t)if(w(e.charCodeAt(0)))return!0;return!1}function p(t){for(const e of t)if(!f(e.charCodeAt(0)))return!1;return!0}function f(t){return!(ou(t)||ud(t)||Pr(t)||Xa(t)||c(t))}function w(t){return!(746!==t&&747!==t&&(t<4352||!(tc(t)||au(t)||m(t)&&!(t>=65097&&t<=65103)||nc(t)||lu(t)||Ru(t)||sh(t)||!(!Oc(t)||t>=12296&&t<=12305||t>=12308&&t<=12319||12336===t)||dl(t)||cu(t)||eo(t)||(e=t,e>=12592&&e<=12687)||(e=>e>=43360&&e<=43391)(t)||(e=>e>=55216&&e<=55295)(t)||(e=>e>=4352&&e<=4607)(t)||uu(t)||su(t)||Lu(t)||(e=>e>=12688&&e<=12703)(t)||Pc(t)||dd(t)||Rl(t)&&12540!==t||!(!y(t)||65288===t||65289===t||65293===t||t>=65306&&t<=65310||65339===t||65341===t||65343===t||t>=65371&&t<=65503||65507===t||t>=65512&&t<=65519)||!(!i(t)||t>=65112&&t<=65118||t>=65123&&t<=65126)||(e=>e>=5120&&e<=5759)(t)||(e=>e>=6320&&e<=6399)(t)||ic(t)||(e=>e>=19904&&e<=19967)(t)||Ns(t)||Ja(t))));var e}function E(t){return!(w(t)||(e=t,(n=e)>=128&&n<=255&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||(n=>n>=8192&&n<=8303)(e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||(n=>n>=8448&&n<=8527)(e)||(n=>n>=8528&&n<=8591)(e)||(n=>n>=8960&&n<=9215)(e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||(n=>n>=9216&&n<=9279)(e)&&9251!==e||(n=>n>=9280&&n<=9311)(e)||(n=>n>=9312&&n<=9471)(e)||(n=>n>=9632&&n<=9727)(e)||(n=>n>=9728&&n<=9983)(e)&&!(e>=9754&&e<=9759)||(n=>n>=11008&&n<=11263)(e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||Oc(e)||Rl(e)||(n=>n>=57344&&n<=63743)(e)||m(e)||i(e)||y(e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e,n}function P(t){return t>=1424&&t<=2303||Xa(t)||c(t)}function O(t,e){return!(!e&&P(t)||t>=2304&&t<=3583||t>=3840&&t<=4255||(n=t,n>=6016&&n<=6143));var n}function V(t){for(const e of t)if(P(e.charCodeAt(0)))return!0;return!1}const Q="deferred",ye="loading",be="loaded";let Oe=null,Ne="unavailable",ve=null;const tt=function(t){t&&"string"==typeof t&&t.indexOf("NetworkError")>-1&&(Ne="error"),Oe&&Oe(t)};function qe(){nt.fire(new Li("pluginStateChange",{pluginStatus:Ne,pluginURL:ve}))}const nt=new Gr,Tt=function(){return Ne},ft=function(){if(Ne!==Q||!ve)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");Ne=ye,qe(),ve&&rn({url:ve},t=>{t?tt(t):(Ne=be,qe())})},At={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>Ne===be||null!=At.applyArabicShaping,isLoading:()=>Ne===ye,setState(t){Ne=t.pluginStatus,ve=t.pluginURL},isParsed:()=>null!=At.applyArabicShaping&&null!=At.processBidirectionalText&&null!=At.processStyledBidirectionalText,getPluginURL:()=>ve};class Zt{constructor(e,n){this.zoom=e,n?(this.now=n.now,this.fadeDuration=n.fadeDuration,this.transition=n.transition,this.pitch=n.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(n,s){for(const h of n)if(!O(h.charCodeAt(0),s))return!1;return!0}(e,At.isLoaded())}}class Kt{constructor(e,n){this.property=e,this.value=n,this.expression=function(s,h){if(Jl(s))return new Br(s,h);if(ai(s)){const _=Yi(s,h);if("error"===_.result)throw new Error(_.value.map(x=>`${x.key}: ${x.message}`).join(", "));return _.value}{let _=s;return"string"==typeof s&&"color"===h.type&&(_=hr.parse(s)),{kind:"constant",evaluate:()=>_}}}(void 0===n?e.specification.default:n,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,n,s){return this.property.possiblyEvaluate(this,e,n,s)}}class nn{constructor(e){this.property=e,this.value=new Kt(e,void 0)}transitioned(e,n){return new qt(this.property,this.value,n,It({},e.transition,this.transition),e.now)}untransitioned(){return new qt(this.property,this.value,null,{},0)}}class Bn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return kt(this._values[e].value.value)}setValue(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new nn(this._values[e].property)),this._values[e].value=new Kt(this._values[e].property,null===n?void 0:kt(n))}getTransition(e){return kt(this._values[e].transition)}setTransition(e,n){this._values.hasOwnProperty(e)||(this._values[e]=new nn(this._values[e].property)),this._values[e].transition=kt(n)||void 0}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);void 0!==s&&(e[n]=s);const h=this.getTransition(n);void 0!==h&&(e[`${n}-transition`]=h)}return e}transitioned(e,n){const s=new xn(this._properties);for(const h of Object.keys(this._values))s._values[h]=this._values[h].transitioned(e,n._values[h]);return s}untransitioned(){const e=new xn(this._properties);for(const n of Object.keys(this._values))e._values[n]=this._values[n].untransitioned();return e}}class qt{constructor(e,n,s,h,_){const x=h.delay||0,T=h.duration||0;_=_||0,this.property=e,this.value=n,this.begin=_+x,this.end=this.begin+T,e.specification.transition&&(h.delay||h.duration)&&(this.prior=s)}possiblyEvaluate(e,n,s){const h=e.now||0,_=this.value.possiblyEvaluate(e,n,s),x=this.prior;if(x){if(h>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(h<this.begin)return x.possiblyEvaluate(e,n,s);{const T=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(e,n,s),_,we(T))}}return _}}class xn{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,n,s){const h=new tn(this._properties);for(const _ of Object.keys(this._values))h._values[_]=this._values[_].possiblyEvaluate(e,n,s);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class cn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return kt(this._values[e].value)}setValue(e,n){this._values[e]=new Kt(this._values[e].property,null===n?void 0:kt(n))}serialize(){const e={};for(const n of Object.keys(this._values)){const s=this.getValue(n);void 0!==s&&(e[n]=s)}return e}possiblyEvaluate(e,n,s){const h=new tn(this._properties);for(const _ of Object.keys(this._values))h._values[_]=this._values[_].possiblyEvaluate(e,n,s);return h}}class An{constructor(e,n,s){this.property=e,this.value=n,this.parameters=s}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,n,s,h){return this.property.evaluate(this.value,this.parameters,e,n,s,h)}}class tn{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class $t{constructor(e){this.specification=e}possiblyEvaluate(e,n){return e.expression.evaluate(n)}interpolate(e,n,s){const h=fa[this.specification.type];return h?h(e,n,s):e}}class on{constructor(e,n){this.specification=e,this.overrides=n}possiblyEvaluate(e,n,s,h){return new An(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(n,null,{},s,h)}:e.expression,n)}interpolate(e,n,s){if("constant"!==e.value.kind||"constant"!==n.value.kind)return e;if(void 0===e.value.value||void 0===n.value.value)return new An(this,{kind:"constant",value:void 0},e.parameters);const h=fa[this.specification.type];return h?new An(this,{kind:"constant",value:h(e.value.value,n.value.value,s)},e.parameters):e}evaluate(e,n,s,h,_,x){return"constant"===e.kind?e.value:e.evaluate(n,s,h,_,x)}}class wn{constructor(e){this.specification=e}possiblyEvaluate(e,n,s,h){return!!e.expression.evaluate(n,null,{},s,h)}interpolate(){return!1}}class On{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const n=new Zt(0,{});for(const s in e){const h=e[s];h.specification.overridable&&this.overridableProperties.push(s);const _=this.defaultPropertyValues[s]=new Kt(h,void 0),x=this.defaultTransitionablePropertyValues[s]=new nn(h);this.defaultTransitioningPropertyValues[s]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=_.possiblyEvaluate(n)}}}function ri(t,e){return 256*(t=me(Math.floor(t),0,255))+me(Math.floor(e),0,255)}Kn(on,"DataDrivenProperty"),Kn($t,"DataConstantProperty"),Kn(wn,"ColorRampProperty");const zi={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class ti{constructor(e,n){this._structArray=e,this._pos1=n*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Xn{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,n){return e._trim(),n&&(e.isTransferred=!0,n.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const n=Object.create(this.prototype);return n.arrayBuffer=e.arrayBuffer,n.length=e.length,n.capacity=e.arrayBuffer.byteLength/n.bytesPerElement,n._refreshViews(),n}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const n=this.uint8;this._refreshViews(),n&&this.uint8.set(n)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function di(t,e=1){let n=0,s=0;return{members:t.map(h=>{const _=zi[h.type].BYTES_PER_ELEMENT,x=n=Ji(n,Math.max(e,_)),T=h.components||1;return s=Math.max(s,_),n+=_*T,{name:h.name,type:h.type,components:T,offset:x}}),size:Ji(n,Math.max(s,e)),alignment:e}}function Ji(t,e){return Math.ceil(t/e)*e}class gi extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const h=2*e;return this.int16[h+0]=n,this.int16[h+1]=s,e}}gi.prototype.bytesPerElement=4,Kn(gi,"StructArrayLayout2i4");class Tr extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s)}emplace(e,n,s,h){const _=3*e;return this.int16[_+0]=n,this.int16[_+1]=s,this.int16[_+2]=h,e}}Tr.prototype.bytesPerElement=6,Kn(Tr,"StructArrayLayout3i6");class Or extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,s,h)}emplace(e,n,s,h,_){const x=4*e;return this.int16[x+0]=n,this.int16[x+1]=s,this.int16[x+2]=h,this.int16[x+3]=_,e}}Or.prototype.bytesPerElement=8,Kn(Or,"StructArrayLayout4i8");class Rr extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x,T){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,s,h,_,x,T)}emplace(e,n,s,h,_,x,T,I){const A=6*e,L=12*e,N=3*e;return this.int16[A+0]=n,this.int16[A+1]=s,this.uint8[L+4]=h,this.uint8[L+5]=_,this.uint8[L+6]=x,this.uint8[L+7]=T,this.float32[N+2]=I,e}}Rr.prototype.bytesPerElement=12,Kn(Rr,"StructArrayLayout2i4ub1f12");class Vr extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,s,h)}emplace(e,n,s,h,_){const x=4*e;return this.float32[x+0]=n,this.float32[x+1]=s,this.float32[x+2]=h,this.float32[x+3]=_,e}}Vr.prototype.bytesPerElement=16,Kn(Vr,"StructArrayLayout4f16");class Ao extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,s,h,_)}emplace(e,n,s,h,_,x){const T=6*e,I=3*e;return this.uint16[T+0]=n,this.uint16[T+1]=s,this.uint16[T+2]=h,this.uint16[T+3]=_,this.float32[I+2]=x,e}}Ao.prototype.bytesPerElement=12,Kn(Ao,"StructArrayLayout4ui1f12");class bs extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,s,h)}emplace(e,n,s,h,_){const x=4*e;return this.uint16[x+0]=n,this.uint16[x+1]=s,this.uint16[x+2]=h,this.uint16[x+3]=_,e}}bs.prototype.bytesPerElement=8,Kn(bs,"StructArrayLayout4ui8");class Ka extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,s,h,_,x)}emplace(e,n,s,h,_,x,T){const I=6*e;return this.int16[I+0]=n,this.int16[I+1]=s,this.int16[I+2]=h,this.int16[I+3]=_,this.int16[I+4]=x,this.int16[I+5]=T,e}}Ka.prototype.bytesPerElement=12,Kn(Ka,"StructArrayLayout6i12");class Ll extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x,T,I,A,L,N,$){const J=this.length;return this.resize(J+1),this.emplace(J,e,n,s,h,_,x,T,I,A,L,N,$)}emplace(e,n,s,h,_,x,T,I,A,L,N,$,J){const ee=12*e;return this.int16[ee+0]=n,this.int16[ee+1]=s,this.int16[ee+2]=h,this.int16[ee+3]=_,this.uint16[ee+4]=x,this.uint16[ee+5]=T,this.uint16[ee+6]=I,this.uint16[ee+7]=A,this.int16[ee+8]=L,this.int16[ee+9]=N,this.int16[ee+10]=$,this.int16[ee+11]=J,e}}Ll.prototype.bytesPerElement=24,Kn(Ll,"StructArrayLayout4i4ui4i24");class to extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x){const T=this.length;return this.resize(T+1),this.emplace(T,e,n,s,h,_,x)}emplace(e,n,s,h,_,x,T){const I=10*e,A=5*e;return this.int16[I+0]=n,this.int16[I+1]=s,this.int16[I+2]=h,this.float32[A+2]=_,this.float32[A+3]=x,this.float32[A+4]=T,e}}to.prototype.bytesPerElement=20,Kn(to,"StructArrayLayout3i3f20");class jr extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint32[1*e+0]=n,e}}jr.prototype.bytesPerElement=4,Kn(jr,"StructArrayLayout1ul4");class yr extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x,T,I,A,L,N,$,J){const ee=this.length;return this.resize(ee+1),this.emplace(ee,e,n,s,h,_,x,T,I,A,L,N,$,J)}emplace(e,n,s,h,_,x,T,I,A,L,N,$,J,ee){const ue=20*e,Re=10*e;return this.int16[ue+0]=n,this.int16[ue+1]=s,this.int16[ue+2]=h,this.int16[ue+3]=_,this.int16[ue+4]=x,this.float32[Re+3]=T,this.float32[Re+4]=I,this.float32[Re+5]=A,this.float32[Re+6]=L,this.int16[ue+14]=N,this.uint32[Re+8]=$,this.uint16[ue+18]=J,this.uint16[ue+19]=ee,e}}yr.prototype.bytesPerElement=40,Kn(yr,"StructArrayLayout5i4f1i1ul2ui40");class ho extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x,T){const I=this.length;return this.resize(I+1),this.emplace(I,e,n,s,h,_,x,T)}emplace(e,n,s,h,_,x,T,I){const A=8*e;return this.int16[A+0]=n,this.int16[A+1]=s,this.int16[A+2]=h,this.int16[A+4]=_,this.int16[A+5]=x,this.int16[A+6]=T,this.int16[A+7]=I,e}}ho.prototype.bytesPerElement=16,Kn(ho,"StructArrayLayout3i2i2i16");class is extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,s,h,_)}emplace(e,n,s,h,_,x){const T=4*e,I=8*e;return this.float32[T+0]=n,this.float32[T+1]=s,this.float32[T+2]=h,this.int16[I+6]=_,this.int16[I+7]=x,e}}is.prototype.bytesPerElement=16,Kn(is,"StructArrayLayout2f1f2i16");class Nr extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,s,h)}emplace(e,n,s,h,_){const x=12*e,T=3*e;return this.uint8[x+0]=n,this.uint8[x+1]=s,this.float32[T+1]=h,this.float32[T+2]=_,e}}Nr.prototype.bytesPerElement=12,Kn(Nr,"StructArrayLayout2ub2f12");class rs extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s)}emplace(e,n,s,h){const _=3*e;return this.float32[_+0]=n,this.float32[_+1]=s,this.float32[_+2]=h,e}}rs.prototype.bytesPerElement=12,Kn(rs,"StructArrayLayout3f12");class os extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s){const h=this.length;return this.resize(h+1),this.emplace(h,e,n,s)}emplace(e,n,s,h){const _=3*e;return this.uint16[_+0]=n,this.uint16[_+1]=s,this.uint16[_+2]=h,e}}os.prototype.bytesPerElement=6,Kn(os,"StructArrayLayout3ui6");class hl extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x,T,I,A,L,N,$,J,ee,ue,Re,et,pt,Ye,st,Ct){const mt=this.length;return this.resize(mt+1),this.emplace(mt,e,n,s,h,_,x,T,I,A,L,N,$,J,ee,ue,Re,et,pt,Ye,st,Ct)}emplace(e,n,s,h,_,x,T,I,A,L,N,$,J,ee,ue,Re,et,pt,Ye,st,Ct,mt){const Qt=30*e,Xt=15*e,mn=60*e;return this.int16[Qt+0]=n,this.int16[Qt+1]=s,this.int16[Qt+2]=h,this.float32[Xt+2]=_,this.float32[Xt+3]=x,this.uint16[Qt+8]=T,this.uint16[Qt+9]=I,this.uint32[Xt+5]=A,this.uint32[Xt+6]=L,this.uint32[Xt+7]=N,this.uint16[Qt+16]=$,this.uint16[Qt+17]=J,this.uint16[Qt+18]=ee,this.float32[Xt+10]=ue,this.float32[Xt+11]=Re,this.uint8[mn+48]=et,this.uint8[mn+49]=pt,this.uint8[mn+50]=Ye,this.uint32[Xt+13]=st,this.int16[Qt+28]=Ct,this.uint8[mn+58]=mt,e}}hl.prototype.bytesPerElement=60,Kn(hl,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class zs extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_,x,T,I,A,L,N,$,J,ee,ue,Re,et,pt,Ye,st,Ct,mt,Qt,Xt,mn,Fn,an,yn,vn,Pn){const kn=this.length;return this.resize(kn+1),this.emplace(kn,e,n,s,h,_,x,T,I,A,L,N,$,J,ee,ue,Re,et,pt,Ye,st,Ct,mt,Qt,Xt,mn,Fn,an,yn,vn,Pn)}emplace(e,n,s,h,_,x,T,I,A,L,N,$,J,ee,ue,Re,et,pt,Ye,st,Ct,mt,Qt,Xt,mn,Fn,an,yn,vn,Pn,kn){const ln=38*e,$n=19*e;return this.int16[ln+0]=n,this.int16[ln+1]=s,this.int16[ln+2]=h,this.float32[$n+2]=_,this.float32[$n+3]=x,this.int16[ln+8]=T,this.int16[ln+9]=I,this.int16[ln+10]=A,this.int16[ln+11]=L,this.int16[ln+12]=N,this.int16[ln+13]=$,this.uint16[ln+14]=J,this.uint16[ln+15]=ee,this.uint16[ln+16]=ue,this.uint16[ln+17]=Re,this.uint16[ln+18]=et,this.uint16[ln+19]=pt,this.uint16[ln+20]=Ye,this.uint16[ln+21]=st,this.uint16[ln+22]=Ct,this.uint16[ln+23]=mt,this.uint16[ln+24]=Qt,this.uint16[ln+25]=Xt,this.uint16[ln+26]=mn,this.uint16[ln+27]=Fn,this.uint16[ln+28]=an,this.uint32[$n+15]=yn,this.float32[$n+16]=vn,this.float32[$n+17]=Pn,this.float32[$n+18]=kn,e}}zs.prototype.bytesPerElement=76,Kn(zs,"StructArrayLayout3i2f6i15ui1ul3f76");class na extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.float32[1*e+0]=n,e}}na.prototype.bytesPerElement=4,Kn(na,"StructArrayLayout1f4");class va extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n,s,h,_){const x=this.length;return this.resize(x+1),this.emplace(x,e,n,s,h,_)}emplace(e,n,s,h,_,x){const T=5*e;return this.float32[T+0]=n,this.float32[T+1]=s,this.float32[T+2]=h,this.float32[T+3]=_,this.float32[T+4]=x,e}}va.prototype.bytesPerElement=20,Kn(va,"StructArrayLayout5f20");class pl extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n,s,h){const _=this.length;return this.resize(_+1),this.emplace(_,e,n,s,h)}emplace(e,n,s,h,_){const x=6*e;return this.uint32[3*e+0]=n,this.uint16[x+2]=s,this.uint16[x+3]=h,this.uint16[x+4]=_,e}}pl.prototype.bytesPerElement=12,Kn(pl,"StructArrayLayout1ul3ui12");class fl extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const h=2*e;return this.uint16[h+0]=n,this.uint16[h+1]=s,e}}fl.prototype.bytesPerElement=4,Kn(fl,"StructArrayLayout2ui4");class Qa extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const n=this.length;return this.resize(n+1),this.emplace(n,e)}emplace(e,n){return this.uint16[1*e+0]=n,e}}Qa.prototype.bytesPerElement=2,Kn(Qa,"StructArrayLayout1ui2");class Rc extends Xn{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,n){const s=this.length;return this.resize(s+1),this.emplace(s,e,n)}emplace(e,n,s){const h=2*e;return this.float32[h+0]=n,this.float32[h+1]=s,e}}Rc.prototype.bytesPerElement=8,Kn(Rc,"StructArrayLayout2f8");class em extends ti{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}em.prototype.size=40;class lp extends yr{get(e){return new em(this,e)}}Kn(lp,"CollisionBoxArray");class cp extends ti{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}cp.prototype.size=60;class tm extends hl{get(e){return new cp(this,e)}}Kn(tm,"PlacedSymbolArray");class nm extends ti{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}nm.prototype.size=76;class ia extends zs{get(e){return new nm(this,e)}}Kn(ia,"SymbolInstanceArray");class ah extends na{getoffsetX(e){return this.float32[1*e+0]}}Kn(ah,"GlyphOffsetArray");class up extends gi{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}Kn(up,"SymbolLineVertexArray");class lh extends ti{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}lh.prototype.size=12;class Us extends pl{get(e){return new lh(this,e)}}Kn(Us,"FeatureIndexArray");class Fu extends fl{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}Kn(Fu,"FillExtrusionCentroidArray");const im=di([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),rm=di([{name:"a_dash",components:4,type:"Uint16"}]);var du={},om={get exports(){return du},set exports(t){du=t}},dp={};({get exports(){return dp},set exports(t){dp=t}}).exports=function(t,e){var n,s,h,_,x,T,I,A;for(s=t.length-(n=3&t.length),h=e,x=3432918353,T=461845907,A=0;A<s;)I=255&t.charCodeAt(A)|(255&t.charCodeAt(++A))<<8|(255&t.charCodeAt(++A))<<16|(255&t.charCodeAt(++A))<<24,++A,h=27492+(65535&(_=5*(65535&(h=(h^=I=(65535&(I=(I=(65535&I)*x+(((I>>>16)*x&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(I=0,n){case 3:I^=(255&t.charCodeAt(A+2))<<16;case 2:I^=(255&t.charCodeAt(A+1))<<8;case 1:h^=I=(65535&(I=(I=(65535&(I^=255&t.charCodeAt(A)))*x+(((I>>>16)*x&65535)<<16)&4294967295)<<15|I>>>17))*T+(((I>>>16)*T&65535)<<16)&4294967295}return h^=t.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var ch={};({get exports(){return ch},set exports(t){ch=t}}).exports=function(t,e){for(var n,s=t.length,h=e^s,_=0;s>=4;)n=1540483477*(65535&(n=255&t.charCodeAt(_)|(255&t.charCodeAt(++_))<<8|(255&t.charCodeAt(++_))<<16|(255&t.charCodeAt(++_))<<24))+((1540483477*(n>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(n=1540483477*(65535&(n^=n>>>24))+((1540483477*(n>>>16)&65535)<<16)),s-=4,++_;switch(s){case 3:h^=(255&t.charCodeAt(_+2))<<16;case 2:h^=(255&t.charCodeAt(_+1))<<8;case 1:h=1540483477*(65535&(h^=255&t.charCodeAt(_)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var sm=dp,am=ch;om.exports=sm,du.murmur3=sm,du.murmur2=am;class uh{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,n,s,h){this.ids.push(lm(e)),this.positions.push(n,s,h)}getPositions(e){const n=lm(e);let s=0,h=this.ids.length-1;for(;s<h;){const x=s+h>>1;this.ids[x]>=n?h=x:s=x+1}const _=[];for(;this.ids[s]===n;)_.push({index:this.positions[3*s],start:this.positions[3*s+1],end:this.positions[3*s+2]}),s++;return _}static serialize(e,n){const s=new Float64Array(e.ids),h=new Uint32Array(e.positions);return hd(s,h,0,s.length-1),n&&n.push(s.buffer,h.buffer),{ids:s,positions:h}}static deserialize(e){const n=new uh;return n.ids=e.ids,n.positions=e.positions,n.indexed=!0,n}}function lm(t){const e=+t;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:du(String(t))}function hd(t,e,n,s){for(;n<s;){const h=t[n+s>>1];let _=n-1,x=s+1;for(;;){do{_++}while(t[_]<h);do{x--}while(t[x]>h);if(_>=x)break;ku(t,_,x),ku(e,3*_,3*x),ku(e,3*_+1,3*x+1),ku(e,3*_+2,3*x+2)}x-n<s-x?(hd(t,e,n,x),n=x+1):(hd(t,e,x+1,s),s=x)}}function ku(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}Kn(uh,"FeaturePositionMap");class rc{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,n){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,n),this.initialized=!0),!!this.location}}class Lc extends rc{constructor(e){super(e),this.current=0}set(e,n,s){this.fetchUniformLocation(e,n)&&this.current!==s&&(this.current=s,this.gl.uniform1f(this.location,s))}}class cm extends rc{constructor(e){super(e),this.current=[0,0,0,0]}set(e,n,s){this.fetchUniformLocation(e,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]&&s[3]===this.current[3]||(this.current=s,this.gl.uniform4f(this.location,s[0],s[1],s[2],s[3])))}}class um extends rc{constructor(e){super(e),this.current=hr.transparent}set(e,n,s){this.fetchUniformLocation(e,n)&&(s.r===this.current.r&&s.g===this.current.g&&s.b===this.current.b&&s.a===this.current.a||(this.current=s,this.gl.uniform4f(this.location,s.r,s.g,s.b,s.a)))}}const hp=new Float32Array(16),pp=new Float32Array(9),dm=new Float32Array(4);function Fc(t){return[ri(255*t.r,255*t.g),ri(255*t.b,255*t.a)]}class hu{constructor(e,n,s){this.value=e,this.uniformNames=n.map(h=>`u_${h}`),this.type=s}setUniform(e,n,s,h,_){n.set(e,_,h.constantOr(this.value))}getBinding(e,n){return"color"===this.type?new um(e):new Lc(e)}}class pu{constructor(e,n){this.uniformNames=n.map(s=>`u_${s}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,n,s,h,_){const x="u_pattern"===_||"u_dash"===_?this.pattern:"u_pixel_ratio"===_?this.pixelRatio:null;x&&n.set(e,_,x)}getBinding(e,n){return"u_pattern"===n||"u_dash"===n?new cm(e):new Lc(e)}}class oc{constructor(e,n,s,h){this.expression=e,this.type=s,this.maxValue=0,this.paintVertexAttributes=n.map(_=>({name:`a_${_}`,type:"Float32",components:"color"===s?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,n,s,h,_,x){const T=this.paintVertexArray.length,I=this.expression.evaluate(new Zt(0),n,{},_,h,x);this.paintVertexArray.resize(e),this._setPaintValue(T,e,I)}updatePaintArray(e,n,s,h,_){const x=this.expression.evaluate({zoom:0},s,h,void 0,_);this._setPaintValue(e,n,x)}_setPaintValue(e,n,s){if("color"===this.type){const h=Fc(s);for(let _=e;_<n;_++)this.paintVertexArray.emplace(_,h[0],h[1])}else{for(let h=e;h<n;h++)this.paintVertexArray.emplace(h,s);this.maxValue=Math.max(this.maxValue,Math.abs(s))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ra{constructor(e,n,s,h,_,x){this.expression=e,this.uniformNames=n.map(T=>`u_${T}_t`),this.type=s,this.useIntegerZoom=h,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=n.map(T=>({name:`a_${T}`,type:"Float32",components:"color"===s?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(e,n,s,h,_,x){const T=this.expression.evaluate(new Zt(this.zoom),n,{},_,h,x),I=this.expression.evaluate(new Zt(this.zoom+1),n,{},_,h,x),A=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(A,e,T,I)}updatePaintArray(e,n,s,h,_){const x=this.expression.evaluate({zoom:this.zoom},s,h,void 0,_),T=this.expression.evaluate({zoom:this.zoom+1},s,h,void 0,_);this._setPaintValue(e,n,x,T)}_setPaintValue(e,n,s,h){if("color"===this.type){const _=Fc(s),x=Fc(h);for(let T=e;T<n;T++)this.paintVertexArray.emplace(T,_[0],_[1],x[0],x[1])}else{for(let _=e;_<n;_++)this.paintVertexArray.emplace(_,s,h);this.maxValue=Math.max(this.maxValue,Math.abs(s),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,n,s,h,_){const x=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,T=me(this.expression.interpolationFactor(x,this.zoom,this.zoom+1),0,1);n.set(e,_,T)}getBinding(e,n){return new Lc(e)}}class kc{constructor(e,n,s,h,_){this.expression=e,this.layerId=_,this.paintVertexAttributes=("array"===s?rm:im).members;for(let x=0;x<n.length;++x);this.paintVertexArray=new h}populatePaintArray(e,n,s){const h=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(h,e,n.patterns&&n.patterns[this.layerId],s)}updatePaintArray(e,n,s,h,_,x){this._setPaintValues(e,n,s.patterns&&s.patterns[this.layerId],x)}_setPaintValues(e,n,s,h){if(!h||!s)return;const _=h[s];if(!_)return;const{tl:x,br:T,pixelRatio:I}=_;for(let A=e;A<n;A++)this.paintVertexArray.emplace(A,x[0],x[1],T[0],T[1],I)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Bc{constructor(e,n,s=(()=>!0)){this.binders={},this._buffers=[];const h=[];for(const _ in e.paint._values){if(!s(_))continue;const x=e.paint.get(_);if(!(x instanceof An&&Rs(x.property.specification)))continue;const T=Ug(_,e.type),I=x.value,A=x.property.specification.type,L=x.property.useIntegerZoom,N="line-dasharray"===_||_.endsWith("pattern"),$="line-dasharray"===_&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==I.kind||$)if("source"===I.kind||$||N){const J=dh(_,A,"source");this.binders[_]=N?new kc(I,T,A,J,e.id):new oc(I,T,A,J),h.push(`/a_${_}`)}else{const J=dh(_,A,"composite");this.binders[_]=new Ra(I,T,A,L,n,J),h.push(`/z_${_}`)}else this.binders[_]=N?new pu(I.value,T):new hu(I.value,T,A),h.push(`/u_${_}`)}this.cacheKey=h.sort().join("")}getMaxValue(e){const n=this.binders[e];return n instanceof oc||n instanceof Ra?n.maxValue:0}populatePaintArrays(e,n,s,h,_,x){for(const T in this.binders){const I=this.binders[T];(I instanceof oc||I instanceof Ra||I instanceof kc)&&I.populatePaintArray(e,n,s,h,_,x)}}setConstantPatternPositions(e){for(const n in this.binders){const s=this.binders[n];s instanceof pu&&s.setConstantPatternPositions(e)}}updatePaintArrays(e,n,s,h,_,x){let T=!1;for(const I in e){const A=n.getPositions(I);for(const L of A){const N=s.feature(L.index);for(const $ in this.binders){const J=this.binders[$];if((J instanceof oc||J instanceof Ra||J instanceof kc)&&!0===J.expression.isStateDependent){const ee=h.paint.get($);J.expression=ee.value,J.updatePaintArray(L.start,L.end,N,e[I],_,x),T=!0}}}}return T}defines(){const e=[];for(const n in this.binders){const s=this.binders[n];(s instanceof hu||s instanceof pu)&&e.push(...s.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof oc||s instanceof Ra||s instanceof kc)for(let h=0;h<s.paintVertexAttributes.length;h++)e.push(s.paintVertexAttributes[h].name)}return e}getBinderUniforms(){const e=[];for(const n in this.binders){const s=this.binders[n];if(s instanceof hu||s instanceof pu||s instanceof Ra)for(const h of s.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const n=[];for(const s in this.binders){const h=this.binders[s];if(h instanceof hu||h instanceof pu||h instanceof Ra)for(const _ of h.uniformNames)n.push({name:_,property:s,binding:h.getBinding(e,_)})}return n}setUniforms(e,n,s,h,_){for(const{name:x,property:T,binding:I}of s)this.binders[T].setUniform(e,I,_,h.get(T),x)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const n=this.binders[e];(n instanceof oc||n instanceof Ra||n instanceof kc)&&n.paintVertexBuffer&&this._buffers.push(n.paintVertexBuffer)}}upload(e){for(const n in this.binders){const s=this.binders[n];(s instanceof oc||s instanceof Ra||s instanceof kc)&&s.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const n=this.binders[e];(n instanceof oc||n instanceof Ra||n instanceof kc)&&n.destroy()}}}class fu{constructor(e,n,s=(()=>!0)){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new Bc(h,n,s);this.needsUpload=!1,this._featureMap=new uh,this._bufferOffset=0}populatePaintArrays(e,n,s,h,_,x,T){for(const I in this.programConfigurations)this.programConfigurations[I].populatePaintArrays(e,n,h,_,x,T);void 0!==n.id&&this._featureMap.add(n.id,s,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,n,s,h,_){for(const x of s)this.needsUpload=this.programConfigurations[x.id].updatePaintArrays(e,this._featureMap,n,x,h,_)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const n in this.programConfigurations)this.programConfigurations[n].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const zg={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function Ug(t,e){return zg[t]||[t.replace(`${e}-`,"").replace(/-/g,"_")]}const Vg={"line-pattern":{source:Ao,composite:Ao},"fill-pattern":{source:Ao,composite:Ao},"fill-extrusion-pattern":{source:Ao,composite:Ao},"line-dasharray":{source:bs,composite:bs}},hm={color:{source:Rc,composite:Vr},number:{source:na,composite:Rc}};function dh(t,e,n){const s=Vg[t];return s&&s[n]||hm[e][n]}Kn(hu,"ConstantBinder"),Kn(pu,"PatternConstantBinder"),Kn(oc,"SourceExpressionBinder"),Kn(kc,"PatternCompositeBinder"),Kn(Ra,"CompositeExpressionBinder"),Kn(Bc,"ProgramConfiguration",{omit:["_buffers"]}),Kn(fu,"ProgramConfigurationSet");const pd="-transition";class La extends Gr{constructor(e,n){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),n.layout&&(this._unevaluatedLayout=new cn(n.layout)),n.paint)){this._transitionablePaint=new Bn(n.paint);for(const s in e.paint)this.setPaintProperty(s,e.paint[s],{validate:!1});for(const s in e.layout)this.setLayoutProperty(s,e.layout[s],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new tn(n.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,n,s={}){null!=n&&this._validate(iu,`layers.${this.id}.layout.${e}`,e,n,s)||("visibility"!==e?this._unevaluatedLayout.setValue(e,n):this.visibility=n)}getPaintProperty(e){return lt(e,pd)?this._transitionablePaint.getTransition(e.slice(0,-pd.length)):this._transitionablePaint.getValue(e)}setPaintProperty(e,n,s={}){if(null!=n&&this._validate(oh,`layers.${this.id}.paint.${e}`,e,n,s))return!1;if(lt(e,pd))return this._transitionablePaint.setTransition(e.slice(0,-pd.length),n||void 0),!1;{const h=this._transitionablePaint._values[e],_=h.value.isDataDriven(),x=h.value;this._transitionablePaint.setValue(e,n),this._handleSpecialPaintPropertyUpdate(e);const T=this._transitionablePaint._values[e].value,I=T.isDataDriven(),A=lt(e,"pattern")||"line-dasharray"===e;return I||_||A||this._handleOverridablePaintPropertyUpdate(e,x,T)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,n,s){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,n){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,n)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,n)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),bt(e,(n,s)=>!(void 0===n||"layout"===s&&!Object.keys(n).length||"paint"===s&&!Object.keys(n).length))}_validate(e,n,s,h,_={}){return(!_||!1!==_.validate)&&ru(this,e.call(Ol,{key:n,layerType:this.type,objectKey:s,value:h,styleSpec:Jt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const n=this.paint.get(e);if(n instanceof An&&Rs(n.property.specification)&&("source"===n.value.kind||"composite"===n.value.kind)&&n.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=Dl(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const jg=di([{name:"a_pos",components:2,type:"Int16"}],4),$g=di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class xo{constructor(e=[]){this.segments=e}prepareSegment(e,n,s,h){let _=this.segments[this.segments.length-1];return e>xo.MAX_VERTEX_ARRAY_LENGTH&&bn(`Max vertices per segment is ${xo.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!_||_.vertexLength+e>xo.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==h)&&(_={vertexOffset:n.length,primitiveOffset:s.length,vertexLength:0,primitiveLength:0},void 0!==h&&(_.sortKey=h),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const e of this.segments)for(const n in e.vaos)e.vaos[n].destroy()}static simpleSegment(e,n,s,h){return new xo([{vertexOffset:e,primitiveOffset:n,vertexLength:s,primitiveLength:h,vaos:{},sortKey:0}])}}xo.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Kn(xo,"SegmentVector");var Ei=8192;class xa{constructor(e,n){e&&(n?this.setSouthWest(e).setNorthEast(n):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof ur?new ur(e.lng,e.lat):ur.convert(e),this}setSouthWest(e){return this._sw=e instanceof ur?new ur(e.lng,e.lat):ur.convert(e),this}extend(e){const n=this._sw,s=this._ne;let h,_;if(e instanceof ur)h=e,_=e;else{if(!(e instanceof xa))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(xa.convert(e)):this.extend(ur.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&e.hasOwnProperty("lon")?this.extend(ur.convert(e)):this;if(h=e._sw,_=e._ne,!h||!_)return this}return n||s?(n.lng=Math.min(h.lng,n.lng),n.lat=Math.min(h.lat,n.lat),s.lng=Math.max(_.lng,s.lng),s.lat=Math.max(_.lat,s.lat)):(this._sw=new ur(h.lng,h.lat),this._ne=new ur(_.lng,_.lat)),this}getCenter(){return new ur((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ur(this.getWest(),this.getNorth())}getSouthEast(){return new ur(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:n,lat:s}=ur.convert(e);let h=this._sw.lng<=n&&n<=this._ne.lng;return this._sw.lng>this._ne.lng&&(h=this._sw.lng>=n&&n>=this._ne.lng),this._sw.lat<=s&&s<=this._ne.lat&&h}static convert(e){return!e||e instanceof xa?e:new xa(e)}}var fd=1e-6,ra=typeof Float32Array<"u"?Float32Array:Array;function pm(){var t=new ra(9);return ra!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Zg(t,e,n){var s=e[0],h=e[1],_=e[2],x=e[3],T=e[4],I=e[5],A=e[6],L=e[7],N=e[8],$=n[0],J=n[1],ee=n[2],ue=n[3],Re=n[4],et=n[5],pt=n[6],Ye=n[7],st=n[8];return t[0]=$*s+J*x+ee*A,t[1]=$*h+J*T+ee*L,t[2]=$*_+J*I+ee*N,t[3]=ue*s+Re*x+et*A,t[4]=ue*h+Re*T+et*L,t[5]=ue*_+Re*I+et*N,t[6]=pt*s+Ye*x+st*A,t[7]=pt*h+Ye*T+st*L,t[8]=pt*_+Ye*I+st*N,t}function ba(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function fp(t,e){var n=e[0],s=e[1],h=e[2],_=e[3],x=e[4],T=e[5],I=e[6],A=e[7],L=e[8],N=e[9],$=e[10],J=e[11],ee=e[12],ue=e[13],Re=e[14],et=e[15],pt=n*T-s*x,Ye=n*I-h*x,st=n*A-_*x,Ct=s*I-h*T,mt=s*A-_*T,Qt=h*A-_*I,Xt=L*ue-N*ee,mn=L*Re-$*ee,Fn=L*et-J*ee,an=N*Re-$*ue,yn=N*et-J*ue,vn=$*et-J*Re,Pn=pt*vn-Ye*yn+st*an+Ct*Fn-mt*mn+Qt*Xt;return Pn?(t[0]=(T*vn-I*yn+A*an)*(Pn=1/Pn),t[1]=(h*yn-s*vn-_*an)*Pn,t[2]=(ue*Qt-Re*mt+et*Ct)*Pn,t[3]=($*mt-N*Qt-J*Ct)*Pn,t[4]=(I*Fn-x*vn-A*mn)*Pn,t[5]=(n*vn-h*Fn+_*mn)*Pn,t[6]=(Re*st-ee*Qt-et*Ye)*Pn,t[7]=(L*Qt-$*st+J*Ye)*Pn,t[8]=(x*yn-T*Fn+A*Xt)*Pn,t[9]=(s*Fn-n*yn-_*Xt)*Pn,t[10]=(ee*mt-ue*st+et*pt)*Pn,t[11]=(N*st-L*mt-J*pt)*Pn,t[12]=(T*mn-x*an-I*Xt)*Pn,t[13]=(n*an-s*mn+h*Xt)*Pn,t[14]=(ue*Ye-ee*Ct-Re*pt)*Pn,t[15]=(L*Ct-N*Ye+$*pt)*Pn,t):null}function Nc(t,e,n){var s=e[0],h=e[1],_=e[2],x=e[3],T=e[4],I=e[5],A=e[6],L=e[7],N=e[8],$=e[9],J=e[10],ee=e[11],ue=e[12],Re=e[13],et=e[14],pt=e[15],Ye=n[0],st=n[1],Ct=n[2],mt=n[3];return t[0]=Ye*s+st*T+Ct*N+mt*ue,t[1]=Ye*h+st*I+Ct*$+mt*Re,t[2]=Ye*_+st*A+Ct*J+mt*et,t[3]=Ye*x+st*L+Ct*ee+mt*pt,t[4]=(Ye=n[4])*s+(st=n[5])*T+(Ct=n[6])*N+(mt=n[7])*ue,t[5]=Ye*h+st*I+Ct*$+mt*Re,t[6]=Ye*_+st*A+Ct*J+mt*et,t[7]=Ye*x+st*L+Ct*ee+mt*pt,t[8]=(Ye=n[8])*s+(st=n[9])*T+(Ct=n[10])*N+(mt=n[11])*ue,t[9]=Ye*h+st*I+Ct*$+mt*Re,t[10]=Ye*_+st*A+Ct*J+mt*et,t[11]=Ye*x+st*L+Ct*ee+mt*pt,t[12]=(Ye=n[12])*s+(st=n[13])*T+(Ct=n[14])*N+(mt=n[15])*ue,t[13]=Ye*h+st*I+Ct*$+mt*Re,t[14]=Ye*_+st*A+Ct*J+mt*et,t[15]=Ye*x+st*L+Ct*ee+mt*pt,t}function Bu(t,e,n){var s,h,_,x,T,I,A,L,N,$,J,ee,ue=n[0],Re=n[1],et=n[2];return e===t?(t[12]=e[0]*ue+e[4]*Re+e[8]*et+e[12],t[13]=e[1]*ue+e[5]*Re+e[9]*et+e[13],t[14]=e[2]*ue+e[6]*Re+e[10]*et+e[14],t[15]=e[3]*ue+e[7]*Re+e[11]*et+e[15]):(h=e[1],_=e[2],x=e[3],T=e[4],I=e[5],A=e[6],L=e[7],N=e[8],$=e[9],J=e[10],ee=e[11],t[0]=s=e[0],t[1]=h,t[2]=_,t[3]=x,t[4]=T,t[5]=I,t[6]=A,t[7]=L,t[8]=N,t[9]=$,t[10]=J,t[11]=ee,t[12]=s*ue+T*Re+N*et+e[12],t[13]=h*ue+I*Re+$*et+e[13],t[14]=_*ue+A*Re+J*et+e[14],t[15]=x*ue+L*Re+ee*et+e[15]),t}function zc(t,e,n){var s=n[0],h=n[1],_=n[2];return t[0]=e[0]*s,t[1]=e[1]*s,t[2]=e[2]*s,t[3]=e[3]*s,t[4]=e[4]*h,t[5]=e[5]*h,t[6]=e[6]*h,t[7]=e[7]*h,t[8]=e[8]*_,t[9]=e[9]*_,t[10]=e[10]*_,t[11]=e[11]*_,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function md(t,e,n){var s=Math.sin(n),h=Math.cos(n),_=e[4],x=e[5],T=e[6],I=e[7],A=e[8],L=e[9],N=e[10],$=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=_*h+A*s,t[5]=x*h+L*s,t[6]=T*h+N*s,t[7]=I*h+$*s,t[8]=A*h-_*s,t[9]=L*h-x*s,t[10]=N*h-T*s,t[11]=$*h-I*s,t}function gd(t,e,n){var s=Math.sin(n),h=Math.cos(n),_=e[0],x=e[1],T=e[2],I=e[3],A=e[8],L=e[9],N=e[10],$=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=_*h-A*s,t[1]=x*h-L*s,t[2]=T*h-N*s,t[3]=I*h-$*s,t[8]=_*s+A*h,t[9]=x*s+L*h,t[10]=T*s+N*h,t[11]=I*s+$*h,t}function _d(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function yd(t,e,n){var s,h,_,x=n[0],T=n[1],I=n[2],A=Math.hypot(x,T,I);return A<fd?null:(x*=A=1/A,T*=A,I*=A,s=Math.sin(e),h=Math.cos(e),t[0]=x*x*(_=1-h)+h,t[1]=T*x*_+I*s,t[2]=I*x*_-T*s,t[3]=0,t[4]=x*T*_-I*s,t[5]=T*T*_+h,t[6]=I*T*_+x*s,t[7]=0,t[8]=x*I*_+T*s,t[9]=T*I*_-x*s,t[10]=I*I*_+h,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var fm=Nc;function vd(){var t=new ra(3);return ra!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function hh(t){var e=new ra(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function mu(t){return Math.hypot(t[0],t[1],t[2])}function Fl(t,e,n){var s=new ra(3);return s[0]=t,s[1]=e,s[2]=n,s}function sc(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function ph(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function mm(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function xd(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function bd(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function wa(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function Nu(t,e,n,s){return t[0]=e[0]+n[0]*s,t[1]=e[1]+n[1]*s,t[2]=e[2]+n[2]*s,t}function ss(t,e){var n=e[0],s=e[1],h=e[2],_=n*n+s*s+h*h;return _>0&&(_=1/Math.sqrt(_)),t[0]=e[0]*_,t[1]=e[1]*_,t[2]=e[2]*_,t}function Ca(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Uc(t,e,n){var s=e[0],h=e[1],_=e[2],x=n[0],T=n[1],I=n[2];return t[0]=h*I-_*T,t[1]=_*x-s*I,t[2]=s*T-h*x,t}function bo(t,e,n){var s=e[0],h=e[1],_=e[2],x=n[3]*s+n[7]*h+n[11]*_+n[15];return t[0]=(n[0]*s+n[4]*h+n[8]*_+n[12])/(x=x||1),t[1]=(n[1]*s+n[5]*h+n[9]*_+n[13])/x,t[2]=(n[2]*s+n[6]*h+n[10]*_+n[14])/x,t}function gm(t,e,n){var s=n[0],h=n[1],_=n[2],x=e[0],T=e[1],I=e[2],A=h*I-_*T,L=_*x-s*I,N=s*T-h*x,$=h*N-_*L,J=_*A-s*N,ee=s*L-h*A,ue=2*n[3];return L*=ue,N*=ue,J*=2,ee*=2,t[0]=x+(A*=ue)+($*=2),t[1]=T+L+J,t[2]=I+N+ee,t}var fh,ml=ph,mp=mm,Gg=mu;function gp(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function wd(t,e){var n=e[0],s=e[1],h=e[2],_=e[3],x=n*n+s*s+h*h+_*_;return x>0&&(x=1/Math.sqrt(x)),t[0]=n*x,t[1]=s*x,t[2]=h*x,t[3]=_*x,t}function ac(t,e,n){var s=e[0],h=e[1],_=e[2],x=e[3];return t[0]=n[0]*s+n[4]*h+n[8]*_+n[12]*x,t[1]=n[1]*s+n[5]*h+n[9]*_+n[13]*x,t[2]=n[2]*s+n[6]*h+n[10]*_+n[14]*x,t[3]=n[3]*s+n[7]*h+n[11]*_+n[15]*x,t}function _p(){var t=new ra(4);return ra!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function yp(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function vp(t,e,n){n*=.5;var s=e[0],h=e[1],_=e[2],x=e[3],T=Math.sin(n),I=Math.cos(n);return t[0]=s*I+x*T,t[1]=h*I+_*T,t[2]=_*I-h*T,t[3]=x*I-s*T,t}function xp(t,e,n){n*=.5;var s=e[0],h=e[1],_=e[2],x=e[3],T=Math.sin(n),I=Math.cos(n);return t[0]=s*I-_*T,t[1]=h*I+x*T,t[2]=_*I+s*T,t[3]=x*I-h*T,t}vd(),fh=new ra(4),ra!=Float32Array&&(fh[0]=0,fh[1]=0,fh[2]=0,fh[3]=0);var Hg=wd;vd(),Fl(1,0,0),Fl(0,1,0),_p(),_p(),pm();const Wg=di([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:_m}=Wg,ym=di([{name:"a_pos_3",components:3,type:"Int16"}]);var Cd=di([{name:"a_pos",type:"Int16",components:2}]);class kl{constructor(e,n){this.pos=e,this.dir=n}intersectsPlane(e,n,s){const h=Ca(n,this.dir);if(Math.abs(h)<1e-6)return!1;const _=((e[0]-this.pos[0])*n[0]+(e[1]-this.pos[1])*n[1]+(e[2]-this.pos[2])*n[2])/h;return s[0]=this.pos[0]+this.dir[0]*_,s[1]=this.pos[1]+this.dir[1]*_,s[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(e,n,s){if(ue=(J=this.pos)[0],Re=J[1],et=J[2],pt=(ee=e)[0],Ye=ee[1],st=ee[2],Math.abs(ue-pt)<=fd*Math.max(1,Math.abs(ue),Math.abs(pt))&&Math.abs(Re-Ye)<=fd*Math.max(1,Math.abs(Re),Math.abs(Ye))&&Math.abs(et-st)<=fd*Math.max(1,Math.abs(et),Math.abs(st))||0===n)return s[0]=s[1]=s[2]=0,!1;var J,ee,ue,Re,et,pt,Ye,st;const[h,_,x]=this.dir,T=this.pos[0]-e[0],I=this.pos[1]-e[1],A=this.pos[2]-e[2],L=h*h+_*_+x*x,N=2*(T*h+I*_+A*x),$=N*N-4*L*(T*T+I*I+A*A-n*n);if($<0){const J=Math.max(-N/2,0),ee=T+h*J,ue=I+_*J,Re=A+x*J,et=Math.hypot(ee,ue,Re);return s[0]=ee*n/et,s[1]=ue*n/et,s[2]=Re*n/et,!1}{const J=(-N-Math.sqrt($))/(2*L);if(J<0){const ee=Math.hypot(T,I,A);return s[0]=T*n/ee,s[1]=I*n/ee,s[2]=A*n/ee,!1}return s[0]=T+h*J,s[1]=I+_*J,s[2]=A+x*J,!0}}}class gu{constructor(e,n,s,h,_){this.TL=e,this.TR=n,this.BR=s,this.BL=h,this.horizon=_}static fromInvProjectionMatrix(e,n,s){const h=[-1,1,1],_=[1,1,1],x=[1,-1,1],T=[-1,-1,1],I=bo(h,h,e),A=bo(_,_,e),L=bo(x,x,e),N=bo(T,T,e);return new gu(I,A,L,N,n/s)}}class bp{constructor(e,n){this.points=e,this.planes=n}static fromInvProjectionMatrix(e,n,s,h){const _=Math.pow(2,s),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(I=>{const A=ac([],I,e),L=1/A[3]/n*_;return(N=A)[0]=($=A)[0]*(J=[L,L,h?1/A[3]:L,L])[0],N[1]=$[1]*J[1],N[2]=$[2]*J[2],N[3]=$[3]*J[3],N;var N,$,J}),T=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(I=>{const A=ss([],Uc([],ml([],x[I[0]],x[I[1]]),ml([],x[I[2]],x[I[1]]))),L=-Ca(A,x[I[1]]);return A.concat(L)});return new bp(x,T)}}class oa{static fromPoints(e){const n=[1/0,1/0,1/0],s=[-1/0,-1/0,-1/0];for(const h of e)xd(n,n,h),bd(s,s,h);return new oa(n,s)}static applyTransform(e,n){const s=e.getCorners();for(let h=0;h<s.length;++h)bo(s[h],s[h],n);return oa.fromPoints(s)}constructor(e,n){this.min=e,this.max=n,this.center=wa([],sc([],this.min,this.max),.5)}quadrant(e){const n=[e%2==0,e<2],s=hh(this.min),h=hh(this.max);for(let _=0;_<n.length;_++)s[_]=n[_]?this.min[_]:this.center[_],h[_]=n[_]?this.center[_]:this.max[_];return h[2]=this.max[2],new oa(s,h)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,n=this.max;return[[e[0],e[1],e[2]],[n[0],e[1],e[2]],[n[0],n[1],e[2]],[e[0],n[1],e[2]],[e[0],e[1],n[2]],[n[0],e[1],n[2]],[n[0],n[1],n[2]],[e[0],n[1],n[2]]]}intersects(e){const n=this.getCorners();let s=!0;for(let h=0;h<e.planes.length;h++){const _=e.planes[h];let x=0;for(let T=0;T<n.length;T++)x+=Ca(_,n[T])+_[3]>=0;if(0===x)return 0;x!==n.length&&(s=!1)}if(s)return 2;for(let h=0;h<3;h++){let _=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let T=0;T<e.points.length;T++){const I=e.points[T][h]-this.min[h];_=Math.min(_,I),x=Math.max(x,I)}if(x<0||_>this.max[h]-this.min[h])return 0}return 1}}const lc=Ei/Math.PI/2,mh=[64,32,16],gl=-lc,Fa=lc,qg=[new oa([gl,gl,gl],[Fa,Fa,Fa]),new oa([gl,gl,gl],[0,0,Fa]),new oa([0,gl,gl],[Fa,0,Fa]),new oa([gl,0,gl],[0,Fa,Fa]),new oa([0,0,gl],[Fa,Fa,Fa])];function gh(t){return t*lc/Id}function vm(t,e,n,s=!0){const h=wa([],t._camera.position,t.worldSize),_=[e,n,1,1];ac(_,_,t.pixelMatrixInverse),gp(_,_,1/_[3]);const x=ss([],ml([],_,h)),T=t.globeMatrix,I=[T[12],T[13],T[14]],A=ml([],I,h),L=mu(A),N=ss([],A),$=t.worldSize/(2*Math.PI),J=Ca(N,x),ee=Math.asin($/L);if(ee<Math.acos(J)){if(!s)return null;const Fn=[],an=[];wa(Fn,x,L/J),ss(an,ml(an,Fn,A)),ss(x,sc(x,A,wa(x,an,Math.tan(ee)*L)))}const ue=[];new kl(h,x).closestPointOnSphere(I,$,ue);const Re=ss([],Un(T,0)),et=ss([],Un(T,1)),pt=ss([],Un(T,2)),Ye=Ca(Re,ue),st=Ca(et,ue),Ct=Ca(pt,ue),mt=ke(Math.asin(-st/$));let Qt=ke(Math.atan2(Ye,Ct));Qt=t.center.lng+function(Fn,an){const yn=(an-Fn+180)%360-180;return yn<-180?yn+360:yn}(t.center.lng,Qt);const Xt=el(Qt),mn=me(yl(mt),0,1);return new Md(Xt,mn)}class Yg{constructor(e,n,s){this.a=ml([],e,s),this.b=ml([],n,s),this.center=s;const h=ss([],this.a),_=ss([],this.b);this.angle=Math.acos(Ca(h,_))}}function Td(t,e){if(0===t.angle)return null;let n;return n=0===t.a[e]?1/t.angle*.5*Math.PI:1/t.angle*Math.atan(t.b[e]/t.a[e]/Math.sin(t.angle)-1/Math.tan(t.angle)),n<0||n>1?null:function(s,h,_,x){const T=Math.sin(_);return s*(Math.sin((1-x)*_)/T)+h*(Math.sin(x*_)/T)}(t.a[e],t.b[e],t.angle,me(n,0,1))+t.center[e]}function ws(t){if(t.z<=1)return qg[t.z+2*t.y+t.x];const e=bm(Tp(t));return oa.fromPoints(e)}function _l(t,e,n){return wa(t,t,1-n),Nu(t,t,e,n)}function wp(t,e){const n=Vu(e.zoom);if(0===n)return ws(t);const s=Tp(t),h=bm(s),_=el(s.getWest())*e.worldSize,x=el(s.getEast())*e.worldSize,T=yl(s.getNorth())*e.worldSize,I=yl(s.getSouth())*e.worldSize,A=[_,T,0],L=[x,T,0],N=[_,I,0],$=[x,I,0],J=fp([],e.globeMatrix);return bo(A,A,J),bo(L,L,J),bo(N,N,J),bo($,$,J),h[0]=_l(h[0],N,n),h[1]=_l(h[1],$,n),h[2]=_l(h[2],L,n),h[3]=_l(h[3],A,n),oa.fromPoints(h)}function Cp(t,e,n){for(const s of t)bo(s,s,e),wa(s,s,n)}function Tp({x:t,y:e,z:n}){const s=1/(1<<n),h=new ur(ka(t*s),Cs((e+1)*s)),_=new ur(ka((t+1)*s),Cs(e*s));return new xa(h,_)}function bm(t){const e=ge(t.getNorth()),n=ge(t.getSouth()),s=Math.cos(e),h=Math.cos(n),_=Math.sin(e),x=Math.sin(n),T=t.getWest(),I=t.getEast();return[Ed(h,x,T),Ed(h,x,I),Ed(s,_,I),Ed(s,_,T)]}function Ed(t,e,n,s=lc){return n=ge(n),[t*Math.sin(n)*s,-e*s,t*Math.cos(n)*s]}function Vc(t,e,n){return Ed(Math.cos(ge(t)),Math.sin(ge(t)),e,n)}function _u(t,e,n,s){const h=1<<n.z,_=(t/Ei+n.x)/h;return Vc(Cs((e/Ei+n.y)/h),ka(_),s)}function Ep({min:t,max:e}){return 16383/Math.max(e[0]-t[0],e[1]-t[1],e[2]-t[2])}const Jg=new Float64Array(16);function Uu(t){const e=Ep(t),n=_d(Jg,[e,e,e]);return Bu(n,n,((s=[])[0]=-(h=t.min)[0],s[1]=-h[1],s[2]=-h[2],s));var s,h}function Dp(t){const e=(s=t.min,(n=Jg)[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=s[0],n[13]=s[1],n[14]=s[2],n[15]=1,n);var n,s;const h=1/Ep(t);return zc(e,e,[h,h,h])}function wm(t,e,n,s,h){const _=function(I){const A=Ei/(2*Math.PI);return I/(2*Math.PI)/A}(n),x=[t,e,-n/(2*Math.PI)],T=ba(new Float64Array(16));return Bu(T,T,x),zc(T,T,[_,_,_]),md(T,T,ge(-h)),gd(T,T,ge(-s)),T}function Vu(t){return de(5,6,t)}function Cm(t,e){const n=Vc(e.lat,e.lng);return x=(h=ph([],function(ee){const ue=Vc(ee._center.lat,ee._center.lng);let Re=Uc([],Fl(0,1,0),ue);const et=yd([],-ee.angle,ue);Re=bo(Re,Re,et),yd(et,-ee._pitch,Re);const pt=ss([],ue);return wa(pt,pt,gh(ee.cameraToCenterDistance/ee.pixelsPerMeter)),bo(pt,pt,et),sc([],ue,pt)}(t),n))[0],T=h[1],I=h[2],A=(_=n)[0],L=_[1],N=_[2],J=($=Math.sqrt(x*x+T*T+I*I)*Math.sqrt(A*A+L*L+N*N))&&Ca(h,_)/$,Math.acos(Math.min(Math.max(J,-1),1));var h,_,x,T,I,A,L,N,$,J}function _h(t,e){return Cm(t,e)>Math.PI/2*1.01}const Dd=ge(85),Xg=Math.cos(Dd),Ip=Math.sin(Dd),Id=6371008.8,Bo=2*Math.PI*Id;class ur{constructor(e,n){if(isNaN(e)||isNaN(n))throw new Error(`Invalid LngLat object: (${e}, ${n})`);if(this.lng=+e,this.lat=+n,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ur(se(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const n=Math.PI/180,s=this.lat*n,h=e.lat*n,_=Math.sin(s)*Math.sin(h)+Math.cos(s)*Math.cos(h)*Math.cos((e.lng-this.lng)*n);return Id*Math.acos(Math.min(_,1))}toBounds(e=0){const n=360*e/40075017,s=n/Math.cos(Math.PI/180*this.lat);return new xa(new ur(this.lng-s,this.lat-n),new ur(this.lng+s,this.lat+n))}toEcef(e){const n=gh(e);return Vc(this.lat,this.lng,lc+n)}static convert(e){if(e instanceof ur)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new ur(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new ur(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}function Mp(t){return Bo*Math.cos(t*Math.PI/180)}function el(t){return(180+t)/360}function yl(t){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360}function vl(t,e){return t/Mp(e)}function ka(t){return 360*t-180}function Cs(t){return 360/Math.PI*Math.atan(Math.exp((180-360*t)*Math.PI/180))-90}function Tm(t,e){return t*Mp(Cs(e))}const as=85.051129;function Kg(t){return 1/Math.cos(t*Math.PI/180)}class Md{constructor(e,n,s=0){this.x=+e,this.y=+n,this.z=+s}static fromLngLat(e,n=0){const s=ur.convert(e);return new Md(el(s.lng),yl(s.lat),vl(n,s.lat))}toLngLat(){return new ur(ka(this.x),Cs(this.y))}toAltitude(){return Tm(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Bo*Kg(Cs(this.y))}}function yu(t,e,n,s,h,_,x,T,I){const A=(e+s)/2,L=(n+h)/2,N=new ne(A,L);T(N),function($,J,ee,ue,Re,et){const pt=ee-Re,Ye=ue-et;return Math.abs((ue-J)*pt-(ee-$)*Ye)/Math.hypot(pt,Ye)}(N.x,N.y,_.x,_.y,x.x,x.y)>=I?(yu(t,e,n,A,L,_,N,T,I),yu(t,A,L,s,h,N,x,T,I)):t.push(x)}function yh(t,e,n){let s=t[0],h=s.x,_=s.y;e(s);const x=[s];for(let T=1;T<t.length;T++){const I=t[T],{x:A,y:L}=I;e(I),yu(x,h,_,A,L,s,I,e,n),h=A,_=L,s=I}return x}function vh(t,e,n,s){if(s(e,n)){const h=e.add(n)._mult(.5);vh(t,e,h,s),vh(t,h,n,s)}else t.push(n)}function Em(t,e){let n=t[0];const s=[n];for(let h=1;h<t.length;h++){const _=t[h];vh(s,n,_,e),n=_}return s}const xh=Math.pow(2,14)-1,Dm=-xh-1;function Qg(t,e){const n=Math.round(t.x*e),s=Math.round(t.y*e);return t.x=me(n,Dm,xh),t.y=me(s,Dm,xh),(n<t.x||n>t.x+1||s<t.y||s>t.y+1)&&bn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),t}function Bl(t,e,n){const s=t.loadGeometry(),h=t.extent,_=Ei/h;if(e&&n&&n.projection.isReprojectedInTileSpace){const x=1<<e.z,{scale:T,x:I,y:A,projection:L}=n,N=$=>{const J=ka((e.x+$.x/h)/x),ee=Cs((e.y+$.y/h)/x),ue=L.project(J,ee);$.x=(ue.x*T-I)*h,$.y=(ue.y*T-A)*h};for(let $=0;$<s.length;$++)if(1!==t.type)s[$]=yh(s[$],N,1);else{const J=[];for(const ee of s[$])ee.x<0||ee.x>=h||ee.y<0||ee.y>=h||(N(ee),J.push(ee));s[$]=J}}for(const x of s)for(const T of x)Qg(T,_);return s}function jc(t,e){return{type:t.type,id:t.id,properties:t.properties,geometry:e?Bl(t):[]}}function ju(t,e,n,s,h){t.emplaceBack(2*e+(s+1)/2,2*n+(h+1)/2)}function Sp(t,e,n){t.emplaceBack(e.x,e.y,e.z,16384*n[0],16384*n[1],16384*n[2])}class Sd{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new gi,this.indexArray=new os,this.segments=new xo,this.programConfigurations=new fu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,h){const _=this.layers[0],x=[];let T=null;"circle"===_.type&&(T=_.layout.get("circle-sort-key"));for(const{feature:A,id:L,index:N,sourceLayerIndex:$}of e){const J=this.layers[0]._featureFilter.needGeometry,ee=jc(A,J);if(!this.layers[0]._featureFilter.filter(new Zt(this.zoom),ee,s))continue;const ue=T?T.evaluate(ee,{},s):void 0,Re={id:L,properties:A.properties,type:A.type,sourceLayerIndex:$,index:N,geometry:J?ee.geometry:Bl(A,s,h),patterns:{},sortKey:ue};x.push(Re)}T&&x.sort((A,L)=>A.sortKey-L.sortKey);let I=null;"globe"===h.projection.name&&(this.globeExtVertexArray=new Ka,I=h.projection);for(const A of x){const{geometry:L,index:N,sourceLayerIndex:$}=A,J=e[N].feature;this.addFeature(A,L,N,n.availableImages,s,I),n.featureIndex.insert(J,L,N,$,this.index)}}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jg.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,$g.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,n,s,h,_,x){for(const T of n)for(const I of T){const A=I.x,L=I.y;if(A<0||A>=Ei||L<0||L>=Ei)continue;if(x){const J=x.projectTilePoint(A,L,_),ee=x.upVector(_,A,L),ue=this.globeExtVertexArray;Sp(ue,J,ee),Sp(ue,J,ee),Sp(ue,J,ee),Sp(ue,J,ee)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),$=N.vertexLength;ju(this.layoutVertexArray,A,L,-1,-1),ju(this.layoutVertexArray,A,L,1,-1),ju(this.layoutVertexArray,A,L,1,1),ju(this.layoutVertexArray,A,L,-1,1),this.indexArray.emplaceBack($,$+1,$+2),this.indexArray.emplaceBack($,$+2,$+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,{},h,_)}}function Im(t,e){for(let n=0;n<t.length;n++)if(uc(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(uc(t,e[n]))return!0;return!!cc(t,e)}function Ap(t,e,n){return!!uc(t,e)||!!Ad(e,t,n)}function Pp(t,e){if(1===t.length)return Sm(e,t[0]);for(let n=0;n<e.length;n++){const s=e[n];for(let h=0;h<s.length;h++)if(uc(t,s[h]))return!0}for(let n=0;n<t.length;n++)if(Sm(e,t[n]))return!0;for(let n=0;n<e.length;n++)if(cc(t,e[n]))return!0;return!1}function Mm(t,e,n){if(t.length>1){if(cc(t,e))return!0;for(let s=0;s<e.length;s++)if(Ad(e[s],t,n))return!0}for(let s=0;s<t.length;s++)if(Ad(t[s],e,n))return!0;return!1}function cc(t,e){if(0===t.length||0===e.length)return!1;for(let n=0;n<t.length-1;n++){const s=t[n],h=t[n+1];for(let _=0;_<e.length-1;_++)if(e_(s,h,e[_],e[_+1]))return!0}return!1}function e_(t,e,n,s){return Nn(t,n,s)!==Nn(e,n,s)&&Nn(t,e,n)!==Nn(t,e,s)}function Ad(t,e,n){const s=n*n;if(1===e.length)return t.distSqr(e[0])<s;for(let h=1;h<e.length;h++)if(Pd(t,e[h-1],e[h])<s)return!0;return!1}function Pd(t,e,n){const s=e.distSqr(n);if(0===s)return t.distSqr(e);const h=((t.x-e.x)*(n.x-e.x)+(t.y-e.y)*(n.y-e.y))/s;return t.distSqr(h<0?e:h>1?n:n.sub(e)._mult(h)._add(e))}function Sm(t,e){let n,s,h,_=!1;for(let x=0;x<t.length;x++){n=t[x];for(let T=0,I=n.length-1;T<n.length;I=T++)s=n[T],h=n[I],s.y>e.y!=h.y>e.y&&e.x<(h.x-s.x)*(e.y-s.y)/(h.y-s.y)+s.x&&(_=!_)}return _}function uc(t,e){let n=!1;for(let s=0,h=t.length-1;s<t.length;h=s++){const _=t[s],x=t[h];_.y>e.y!=x.y>e.y&&e.x<(x.x-_.x)*(e.y-_.y)/(x.y-_.y)+_.x&&(n=!n)}return n}function Od(t,e,n,s,h){for(const x of t)if(e<=x.x&&n<=x.y&&s>=x.x&&h>=x.y)return!0;const _=[new ne(e,n),new ne(e,h),new ne(s,h),new ne(s,n)];if(t.length>2)for(const x of _)if(uc(t,x))return!0;for(let x=0;x<t.length-1;x++)if(vu(t[x],t[x+1],_))return!0;return!1}function vu(t,e,n){const s=n[0],h=n[2];if(t.x<s.x&&e.x<s.x||t.x>h.x&&e.x>h.x||t.y<s.y&&e.y<s.y||t.y>h.y&&e.y>h.y)return!1;const _=Nn(t,e,n[0]);return _!==Nn(t,e,n[1])||_!==Nn(t,e,n[2])||_!==Nn(t,e,n[3])}function xu(t,e,n){const s=e.paint.get(t).value;return"constant"===s.kind?s.value:n.programConfigurations.get(e.id).getMaxValue(t)}function $u(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Am(t,e,n,s,h){if(!e[0]&&!e[1])return t;const _=ne.convert(e)._mult(h);"viewport"===n&&_._rotate(-s);const x=[];for(let T=0;T<t.length;T++)x.push(t[T].sub(_));return x}function Pm(t,e,n,s){const h=ne.convert(t)._mult(s);return"viewport"===e&&h._rotate(-n),h}Kn(Sd,"CircleBucket",{omit:["layers"]});const Om=new On({"circle-sort-key":new on(Jt.layout_circle["circle-sort-key"])});var Zu={paint:new On({"circle-radius":new on(Jt.paint_circle["circle-radius"]),"circle-color":new on(Jt.paint_circle["circle-color"]),"circle-blur":new on(Jt.paint_circle["circle-blur"]),"circle-opacity":new on(Jt.paint_circle["circle-opacity"]),"circle-translate":new $t(Jt.paint_circle["circle-translate"]),"circle-translate-anchor":new $t(Jt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new $t(Jt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new $t(Jt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new on(Jt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new on(Jt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new on(Jt.paint_circle["circle-stroke-opacity"])}),layout:Om};function Rm(t,e,n,s,h,_,x,T,I){if(_&&t.queryGeometry.isAboveHorizon)return!1;_&&(I*=t.pixelToTileUnitsFactor);const A=t.tileID.canonical,L=n.projection.upVectorScale(A,n.center.lat,n.worldSize).metersToTile;for(const N of e)for(const $ of N){const J=$.add(T),ee=h&&n.elevation?n.elevation.exaggeration()*h.getElevationAt(J.x,J.y,!0):0,ue=n.projection.projectTilePoint(J.x,J.y,A);if(ee>0){const Ye=n.projection.upVector(A,J.x,J.y);ue.x+=Ye[0]*L*ee,ue.y+=Ye[1]*L*ee,ue.z+=Ye[2]*L*ee}const Re=_?J:t_(ue.x,ue.y,ue.z,s),et=_?t.tilespaceRays.map(Ye=>n_(Ye,ee)):t.queryGeometry.screenGeometry,pt=ac([],[ue.x,ue.y,ue.z,1],s);if(!x&&_?I*=pt[3]/n.cameraToCenterDistance:x&&!_&&(I*=n.cameraToCenterDistance/pt[3]),_){const Ye=Cs(($.y/Ei+A.y)/(1<<A.z));I/=n.projection.pixelsPerMeter(Ye,1)/vl(1,Ye)}if(Ap(et,Re,I))return!0}return!1}function t_(t,e,n,s){const h=ac([],[t,e,n,1],s);return new ne(h[0]/h[3],h[1]/h[3])}const Lm=Fl(0,0,0),Op=Fl(0,0,1);function n_(t,e){const n=vd();return Lm[2]=e,t.intersectsPlane(Lm,Op,n),new ne(n[0],n[1])}class Rp extends Sd{}function Fm(t,{width:e,height:n},s,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*n*s)throw new RangeError("mismatched image size")}else h=new Uint8Array(e*n*s);return t.width=e,t.height=n,t.data=h,t}function Lp(t,e,n){const{width:s,height:h}=e;s===t.width&&h===t.height||(km(t,e,{x:0,y:0},{x:0,y:0},{width:Math.min(t.width,s),height:Math.min(t.height,h)},n),t.width=s,t.height=h,t.data=e.data)}function km(t,e,n,s,h,_){if(0===h.width||0===h.height)return e;if(h.width>t.width||h.height>t.height||n.x>t.width-h.width||n.y>t.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||s.x>e.width-h.width||s.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const x=t.data,T=e.data;for(let I=0;I<h.height;I++){const A=((n.y+I)*t.width+n.x)*_,L=((s.y+I)*e.width+s.x)*_;for(let N=0;N<h.width*_;N++)T[L+N]=x[A+N]}return e}Kn(Rp,"HeatmapBucket",{omit:["layers"]});class dc{constructor(e,n){Fm(this,e,1,n)}resize(e){Lp(this,new dc(e),1)}clone(){return new dc({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,h,_){km(e,n,s,h,_,1)}}class Ts{constructor(e,n){Fm(this,e,4,n)}resize(e){Lp(this,new Ts(e),4)}replace(e,n){n?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ts({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,n,s,h,_){km(e,n,s,h,_,4)}}Kn(dc,"AlphaImage"),Kn(Ts,"RGBAImage");var i_={paint:new On({"heatmap-radius":new on(Jt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new on(Jt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new $t(Jt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new wn(Jt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new $t(Jt.paint_heatmap["heatmap-opacity"])})};function $c(t){const e={},n=t.resolution||256,s=t.clips?t.clips.length:1,h=t.image||new Ts({width:n,height:s}),_=(x,T,I)=>{e[t.evaluationKey]=I;const A=t.expression.evaluate(e);h.data[x+T+0]=Math.floor(255*A.r/A.a),h.data[x+T+1]=Math.floor(255*A.g/A.a),h.data[x+T+2]=Math.floor(255*A.b/A.a),h.data[x+T+3]=Math.floor(255*A.a)};if(t.clips)for(let x=0,T=0;x<s;++x,T+=4*n)for(let I=0,A=0;I<n;I++,A+=4){const L=I/(n-1),{start:N,end:$}=t.clips[x];_(T,A,N*(1-L)+$*L)}else for(let x=0,T=0;x<n;x++,T+=4)_(0,T,x/(n-1));return h}var Rd={paint:new On({"hillshade-illumination-direction":new $t(Jt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new $t(Jt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new $t(Jt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new $t(Jt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new $t(Jt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new $t(Jt.paint_hillshade["hillshade-accent-color"])})};const r_=di([{name:"a_pos",components:2,type:"Int16"}],4),{members:Bm}=r_;var Gu={};function bh(t,e,n){n=n||2;var s,h,_,x,T,I,A,L=e&&e.length,N=L?e[0]*n:t.length,$=Nm(t,0,N,n,!0),J=[];if(!$||$.next===$.prev)return J;if(L&&($=function(ue,Re,et,pt){var Ye,st,Ct,mt=[];for(Ye=0,st=Re.length;Ye<st;Ye++)(Ct=Nm(ue,Re[Ye]*pt,Ye<st-1?Re[Ye+1]*pt:ue.length,pt,!1))===Ct.next&&(Ct.steiner=!0),mt.push(l_(Ct));for(mt.sort(Fd),Ye=0;Ye<mt.length;Ye++)et=s_(mt[Ye],et);return et}(t,e,$,n)),t.length>80*n){s=_=t[0],h=x=t[1];for(var ee=n;ee<N;ee+=n)(T=t[ee])<s&&(s=T),(I=t[ee+1])<h&&(h=I),T>_&&(_=T),I>x&&(x=I);A=0!==(A=Math.max(_-s,x-h))?32767/A:0}return Ld($,J,n,s,h,A,0),J}function Nm(t,e,n,s,h){var _,x;if(h===Ih(t,e,n,s)>0)for(_=e;_<n;_+=s)x=zp(_,t[_],t[_+1],x);else for(_=n-s;_>=e;_-=s)x=zp(_,t[_],t[_+1],x);return x&&hc(x,x.next)&&(Eh(x),x=x.next),x}function Zc(t,e){if(!t)return t;e||(e=t);var n,s=t;do{if(n=!1,s.steiner||!hc(s,s.next)&&0!==Do(s.prev,s,s.next))s=s.next;else{if(Eh(s),(s=e=s.prev)===s.next)break;n=!0}}while(n||s!==e);return e}function Ld(t,e,n,s,h,_,x){if(t){!x&&_&&function(L,N,$,J){var ee=L;do{0===ee.z&&(ee.z=Np(ee.x,ee.y,N,$,J)),ee.prevZ=ee.prev,ee.nextZ=ee.next,ee=ee.next}while(ee!==L);ee.prevZ.nextZ=null,ee.prevZ=null,function(ue){var Re,et,pt,Ye,st,Ct,mt,Qt,Xt=1;do{for(et=ue,ue=null,st=null,Ct=0;et;){for(Ct++,pt=et,mt=0,Re=0;Re<Xt&&(mt++,pt=pt.nextZ);Re++);for(Qt=Xt;mt>0||Qt>0&&pt;)0!==mt&&(0===Qt||!pt||et.z<=pt.z)?(Ye=et,et=et.nextZ,mt--):(Ye=pt,pt=pt.nextZ,Qt--),st?st.nextZ=Ye:ue=Ye,Ye.prevZ=st,st=Ye;et=pt}st.nextZ=null,Xt*=2}while(Ct>1)}(ee)}(t,s,h,_);for(var T,I,A=t;t.prev!==t.next;)if(T=t.prev,I=t.next,_?kp(t,s,h,_):Fp(t))e.push(T.i/n|0),e.push(t.i/n|0),e.push(I.i/n|0),Eh(t),t=I.next,A=I.next;else if((t=I)===A){x?1===x?Ld(t=o_(Zc(t),e,n),e,n,s,h,_,2):2===x&&Bp(t,e,n,s,h,_):Ld(Zc(t),e,n,s,h,_,1);break}}}function Fp(t){var e=t.prev,n=t,s=t.next;if(Do(e,n,s)>=0)return!1;for(var h=e.x,_=n.x,x=s.x,T=e.y,I=n.y,A=s.y,L=h<_?h<x?h:x:_<x?_:x,N=T<I?T<A?T:A:I<A?I:A,$=h>_?h>x?h:x:_>x?_:x,J=T>I?T>A?T:A:I>A?I:A,ee=s.next;ee!==e;){if(ee.x>=L&&ee.x<=$&&ee.y>=N&&ee.y<=J&&Hu(h,T,_,I,x,A,ee.x,ee.y)&&Do(ee.prev,ee,ee.next)>=0)return!1;ee=ee.next}return!0}function kp(t,e,n,s){var h=t.prev,_=t,x=t.next;if(Do(h,_,x)>=0)return!1;for(var T=h.x,I=_.x,A=x.x,L=h.y,N=_.y,$=x.y,J=T<I?T<A?T:A:I<A?I:A,ee=L<N?L<$?L:$:N<$?N:$,ue=T>I?T>A?T:A:I>A?I:A,Re=L>N?L>$?L:$:N>$?N:$,et=Np(J,ee,e,n,s),pt=Np(ue,Re,e,n,s),Ye=t.prevZ,st=t.nextZ;Ye&&Ye.z>=et&&st&&st.z<=pt;){if(Ye.x>=J&&Ye.x<=ue&&Ye.y>=ee&&Ye.y<=Re&&Ye!==h&&Ye!==x&&Hu(T,L,I,N,A,$,Ye.x,Ye.y)&&Do(Ye.prev,Ye,Ye.next)>=0||(Ye=Ye.prevZ,st.x>=J&&st.x<=ue&&st.y>=ee&&st.y<=Re&&st!==h&&st!==x&&Hu(T,L,I,N,A,$,st.x,st.y)&&Do(st.prev,st,st.next)>=0))return!1;st=st.nextZ}for(;Ye&&Ye.z>=et;){if(Ye.x>=J&&Ye.x<=ue&&Ye.y>=ee&&Ye.y<=Re&&Ye!==h&&Ye!==x&&Hu(T,L,I,N,A,$,Ye.x,Ye.y)&&Do(Ye.prev,Ye,Ye.next)>=0)return!1;Ye=Ye.prevZ}for(;st&&st.z<=pt;){if(st.x>=J&&st.x<=ue&&st.y>=ee&&st.y<=Re&&st!==h&&st!==x&&Hu(T,L,I,N,A,$,st.x,st.y)&&Do(st.prev,st,st.next)>=0)return!1;st=st.nextZ}return!0}function o_(t,e,n){var s=t;do{var h=s.prev,_=s.next.next;!hc(h,_)&&Nl(h,s,s.next,_)&&Th(h,_)&&Th(_,h)&&(e.push(h.i/n|0),e.push(s.i/n|0),e.push(_.i/n|0),Eh(s),Eh(s.next),s=t=_),s=s.next}while(s!==t);return Zc(s)}function Bp(t,e,n,s,h,_){var x=t;do{for(var T=x.next.next;T!==x.prev;){if(x.i!==T.i&&c_(x,T)){var I=u_(x,T);return x=Zc(x,x.next),I=Zc(I,I.next),Ld(x,e,n,s,h,_,0),void Ld(I,e,n,s,h,_,0)}T=T.next}x=x.next}while(x!==t)}function Fd(t,e){return t.x-e.x}function s_(t,e){var n=function(h,_){var x,T=_,I=h.x,A=h.y,L=-1/0;do{if(A<=T.y&&A>=T.next.y&&T.next.y!==T.y){var N=T.x+(A-T.y)*(T.next.x-T.x)/(T.next.y-T.y);if(N<=I&&N>L&&(L=N,x=T.x<T.next.x?T:T.next,N===I))return x}T=T.next}while(T!==_);if(!x)return null;var $,J=x,ee=x.x,ue=x.y,Re=1/0;T=x;do{I>=T.x&&T.x>=ee&&I!==T.x&&Hu(A<ue?I:L,A,ee,ue,A<ue?L:I,A,T.x,T.y)&&($=Math.abs(A-T.y)/(I-T.x),Th(T,h)&&($<Re||$===Re&&(T.x>x.x||T.x===x.x&&a_(x,T)))&&(x=T,Re=$)),T=T.next}while(T!==J);return x}(t,e);if(!n)return e;var s=u_(n,t);return Zc(s,s.next),Zc(n,n.next)}function a_(t,e){return Do(t.prev,t,e.prev)<0&&Do(e.next,t,t.next)<0}function Np(t,e,n,s,h){return(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-n)*h|0)|t<<8))|t<<4))|t<<2))|t<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-s)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function l_(t){var e=t,n=t;do{(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next}while(e!==t);return n}function Hu(t,e,n,s,h,_,x,T){return(h-x)*(e-T)>=(t-x)*(_-T)&&(t-x)*(s-T)>=(n-x)*(e-T)&&(n-x)*(_-T)>=(h-x)*(s-T)}function c_(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!function(n,s){var h=n;do{if(h.i!==n.i&&h.next.i!==n.i&&h.i!==s.i&&h.next.i!==s.i&&Nl(h,h.next,n,s))return!0;h=h.next}while(h!==n);return!1}(t,e)&&(Th(t,e)&&Th(e,t)&&function(n,s){var h=n,_=!1,x=(n.x+s.x)/2,T=(n.y+s.y)/2;do{h.y>T!=h.next.y>T&&h.next.y!==h.y&&x<(h.next.x-h.x)*(T-h.y)/(h.next.y-h.y)+h.x&&(_=!_),h=h.next}while(h!==n);return _}(t,e)&&(Do(t.prev,t,e.prev)||Do(t,e.prev,e))||hc(t,e)&&Do(t.prev,t,t.next)>0&&Do(e.prev,e,e.next)>0)}function Do(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function hc(t,e){return t.x===e.x&&t.y===e.y}function Nl(t,e,n,s){var h=Ch(Do(t,e,n)),_=Ch(Do(t,e,s)),x=Ch(Do(n,s,t)),T=Ch(Do(n,s,e));return h!==_&&x!==T||!(0!==h||!wh(t,n,e))||!(0!==_||!wh(t,s,e))||!(0!==x||!wh(n,t,s))||!(0!==T||!wh(n,e,s))}function wh(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function Ch(t){return t>0?1:t<0?-1:0}function Th(t,e){return Do(t.prev,t,t.next)<0?Do(t,e,t.next)>=0&&Do(t,t.prev,e)>=0:Do(t,e,t.prev)<0||Do(t,t.next,e)<0}function u_(t,e){var n=new Dh(t.i,t.x,t.y),s=new Dh(e.i,e.x,e.y),h=t.next,_=e.prev;return t.next=e,e.prev=t,n.next=h,h.prev=n,s.next=n,n.prev=s,_.next=s,s.prev=_,s}function zp(t,e,n,s){var h=new Dh(t,e,n);return s?(h.next=s.next,h.prev=s,s.next.prev=h,s.next=h):(h.prev=h,h.next=h),h}function Eh(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Dh(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Ih(t,e,n,s){for(var h=0,_=e,x=n-s;_<n;_+=s)h+=(t[x]-t[_])*(t[_+1]+t[x+1]),x=_;return h}function d_(t,e,n,s,h){Up(t,e,n||0,s||t.length-1,h||h_)}function Up(t,e,n,s,h){for(;s>n;){if(s-n>600){var _=s-n+1,x=e-n+1,T=Math.log(_),I=.5*Math.exp(2*T/3),A=.5*Math.sqrt(T*I*(_-I)/_)*(x-_/2<0?-1:1);Up(t,e,Math.max(n,Math.floor(e-x*I/_+A)),Math.min(s,Math.floor(e+(_-x)*I/_+A)),h)}var L=t[e],N=n,$=s;for(kd(t,n,e),h(t[s],L)>0&&kd(t,n,s);N<$;){for(kd(t,N,$),N++,$--;h(t[N],L)<0;)N++;for(;h(t[$],L)>0;)$--}0===h(t[n],L)?kd(t,n,$):kd(t,++$,s),$<=e&&(n=$+1),e<=$&&(s=$-1)}}function kd(t,e,n){var s=t[e];t[e]=t[n],t[n]=s}function h_(t,e){return t<e?-1:t>e?1:0}function Ba(t,e){const n=t.length;if(n<=1)return[t];const s=[];let h,_;for(let x=0;x<n;x++){const T=un(t[x]);0!==T&&(t[x].area=Math.abs(T),void 0===_&&(_=T<0),_===T<0?(h&&s.push(h),h=[t[x]]):h.push(t[x]))}if(h&&s.push(h),e>1)for(let x=0;x<s.length;x++)s[x].length<=e||(d_(s[x],e,1,s[x].length-1,p_),s[x]=s[x].slice(0,e));return s}function p_(t,e){return e.area-t.area}function Mh(t,e,n){const s=n.patternDependencies;let h=!1;for(const _ of e){const x=_.paint.get(`${t}-pattern`);x.isConstant()||(h=!0);const T=x.constantOr(null);T&&(h=!0,s[T]=!0)}return h}function Vp(t,e,n,s,h){const _=h.patternDependencies;for(const x of e){const T=x.paint.get(`${t}-pattern`).value;if("constant"!==T.kind){let I=T.evaluate({zoom:s},n,{},h.availableImages);I=I&&I.name?I.name:I,_[I]=!0,n.patterns[x.id]=I}}return n}({get exports(){return Gu},set exports(t){Gu=t}}).exports=bh,Gu.default=bh,bh.deviation=function(t,e,n,s){var h=e&&e.length,_=Math.abs(Ih(t,0,h?e[0]*n:t.length,n));if(h)for(var x=0,T=e.length;x<T;x++)_-=Math.abs(Ih(t,e[x]*n,x<T-1?e[x+1]*n:t.length,n));var I=0;for(x=0;x<s.length;x+=3){var A=s[x]*n,L=s[x+1]*n,N=s[x+2]*n;I+=Math.abs((t[A]-t[N])*(t[L+1]-t[A+1])-(t[A]-t[L])*(t[N+1]-t[A+1]))}return 0===_&&0===I?0:Math.abs((I-_)/_)},bh.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},s=0,h=0;h<t.length;h++){for(var _=0;_<t[h].length;_++)for(var x=0;x<e;x++)n.vertices.push(t[h][_][x]);h>0&&n.holes.push(s+=t[h-1].length)}return n};class Sh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new gi,this.indexArray=new os,this.indexArray2=new fl,this.programConfigurations=new fu(e.layers,e.zoom),this.segments=new xo,this.segments2=new xo,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.projection=e.projection}populate(e,n,s,h){this.hasPattern=Mh("fill",this.layers,n);const _=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:T,id:I,index:A,sourceLayerIndex:L}of e){const N=this.layers[0]._featureFilter.needGeometry,$=jc(T,N);if(!this.layers[0]._featureFilter.filter(new Zt(this.zoom),$,s))continue;const J=_?_.evaluate($,{},s,n.availableImages):void 0,ee={id:I,properties:T.properties,type:T.type,sourceLayerIndex:L,index:A,geometry:N?$.geometry:Bl(T,s,h),patterns:{},sortKey:J};x.push(ee)}_&&x.sort((T,I)=>T.sortKey-I.sortKey);for(const T of x){const{geometry:I,index:A,sourceLayerIndex:L}=T;if(this.hasPattern){const N=Vp("fill",this.layers,T,this.zoom,n);this.patternFeatures.push(N)}else this.addFeature(T,I,A,s,{},n.availableImages);n.featureIndex.insert(e[A].feature,I,A,L,this.index)}}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}addFeatures(e,n,s,h,_){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,n,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Bm),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,n,s,h,_,x=[]){for(const T of Ba(n,500)){let I=0;for(const ee of T)I+=ee.length;const A=this.segments.prepareSegment(I,this.layoutVertexArray,this.indexArray),L=A.vertexLength,N=[],$=[];for(const ee of T){if(0===ee.length)continue;ee!==T[0]&&$.push(N.length/2);const ue=this.segments2.prepareSegment(ee.length,this.layoutVertexArray,this.indexArray2),Re=ue.vertexLength;this.layoutVertexArray.emplaceBack(ee[0].x,ee[0].y),this.indexArray2.emplaceBack(Re+ee.length-1,Re),N.push(ee[0].x),N.push(ee[0].y);for(let et=1;et<ee.length;et++)this.layoutVertexArray.emplaceBack(ee[et].x,ee[et].y),this.indexArray2.emplaceBack(Re+et-1,Re+et),N.push(ee[et].x),N.push(ee[et].y);ue.vertexLength+=ee.length,ue.primitiveLength+=ee.length}const J=Gu(N,$);for(let ee=0;ee<J.length;ee+=3)this.indexArray.emplaceBack(L+J[ee],L+J[ee+1],L+J[ee+2]);A.vertexLength+=I,A.primitiveLength+=J.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,_,x,h)}}Kn(Sh,"FillBucket",{omit:["layers","patternFeatures"]});const f_=new On({"fill-sort-key":new on(Jt.layout_fill["fill-sort-key"])});var m_={paint:new On({"fill-antialias":new $t(Jt.paint_fill["fill-antialias"]),"fill-opacity":new on(Jt.paint_fill["fill-opacity"]),"fill-color":new on(Jt.paint_fill["fill-color"]),"fill-outline-color":new on(Jt.paint_fill["fill-outline-color"]),"fill-translate":new $t(Jt.paint_fill["fill-translate"]),"fill-translate-anchor":new $t(Jt.paint_fill["fill-translate-anchor"]),"fill-pattern":new on(Jt.paint_fill["fill-pattern"])}),layout:f_};const zm=di([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),g_=di([{name:"a_centroid_pos",components:2,type:"Uint16"}]),__=di([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:y_}=zm;var $i={},Um=ne,jp=bu;function bu(t,e,n,s,h){this.properties={},this.extent=n,this.type=0,this._pbf=t,this._geometry=-1,this._keys=s,this._values=h,t.readFields(v_,this,e)}function v_(t,e,n){1==t?e.id=n.readVarint():2==t?function(s,h){for(var _=s.readVarint()+s.pos;s.pos<_;){var x=h._keys[s.readVarint()],T=h._values[s.readVarint()];h.properties[x]=T}}(n,e):3==t?e.type=n.readVarint():4==t&&(e._geometry=n.pos)}function x_(t){for(var e,n,s=0,h=0,_=t.length,x=_-1;h<_;x=h++)s+=((n=t[x]).x-(e=t[h]).x)*(e.y+n.y);return s}bu.types=["Unknown","Point","LineString","Polygon"],bu.prototype.loadGeometry=function(){var t=this._pbf;t.pos=this._geometry;for(var e,n=t.readVarint()+t.pos,s=1,h=0,_=0,x=0,T=[];t.pos<n;){if(h<=0){var I=t.readVarint();s=7&I,h=I>>3}if(h--,1===s||2===s)_+=t.readSVarint(),x+=t.readSVarint(),1===s&&(e&&T.push(e),e=[]),e.push(new Um(_,x));else{if(7!==s)throw new Error("unknown command "+s);e&&e.push(e[0].clone())}}return e&&T.push(e),T},bu.prototype.bbox=function(){var t=this._pbf;t.pos=this._geometry;for(var e=t.readVarint()+t.pos,n=1,s=0,h=0,_=0,x=1/0,T=-1/0,I=1/0,A=-1/0;t.pos<e;){if(s<=0){var L=t.readVarint();n=7&L,s=L>>3}if(s--,1===n||2===n)(h+=t.readSVarint())<x&&(x=h),h>T&&(T=h),(_+=t.readSVarint())<I&&(I=_),_>A&&(A=_);else if(7!==n)throw new Error("unknown command "+n)}return[x,I,T,A]},bu.prototype.toGeoJSON=function(t,e,n){var s,h,_=this.extent*Math.pow(2,n),x=this.extent*t,T=this.extent*e,I=this.loadGeometry(),A=bu.types[this.type];function L(J){for(var ee=0;ee<J.length;ee++){var ue=J[ee];J[ee]=[360*(ue.x+x)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(ue.y+T)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(s=0;s<I.length;s++)N[s]=I[s][0];L(I=N);break;case 2:for(s=0;s<I.length;s++)L(I[s]);break;case 3:for(I=function(J){var ee=J.length;if(ee<=1)return[J];for(var ue,Re,et=[],pt=0;pt<ee;pt++){var Ye=x_(J[pt]);0!==Ye&&(void 0===Re&&(Re=Ye<0),Re===Ye<0?(ue&&et.push(ue),ue=[J[pt]]):ue.push(J[pt]))}return ue&&et.push(ue),et}(I),s=0;s<I.length;s++)for(h=0;h<I[s].length;h++)L(I[s][h])}1===I.length?I=I[0]:A="Multi"+A;var $={type:"Feature",geometry:{type:A,coordinates:I},properties:this.properties};return"id"in this&&($.id=this.id),$};var Vm=jp,jm=$p;function $p(t,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=t,this._keys=[],this._values=[],this._features=[],t.readFields(b_,this,e),this.length=this._features.length}function b_(t,e,n){15===t?e.version=n.readVarint():1===t?e.name=n.readString():5===t?e.extent=n.readVarint():2===t?e._features.push(n.pos):3===t?e._keys.push(n.readString()):4===t&&e._values.push(function(s){for(var h=null,_=s.readVarint()+s.pos;s.pos<_;){var x=s.readVarint()>>3;h=1===x?s.readString():2===x?s.readFloat():3===x?s.readDouble():4===x?s.readVarint64():5===x?s.readVarint():6===x?s.readSVarint():7===x?s.readBoolean():null}return h}(n))}$p.prototype.feature=function(t){if(t<0||t>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[t];var e=this._pbf.readVarint()+this._pbf.pos;return new Vm(this._pbf,e,this.extent,this._keys,this._values)};var w_=jm;function By(t,e,n){if(3===t){var s=new w_(n,n.readVarint()+n.pos);s.length&&(e[s.name]=s)}}var Ah=$i.VectorTile=function(t,e){this.layers=t.readFields(By,{},e)},Bd=$i.VectorTileFeature=jp;function zl(t,e,n,s){const h=[],_=0===s?(x,T,I,A,L,N)=>{x.push(new ne(N,I+(N-T)/(A-T)*(L-I)))}:(x,T,I,A,L,N)=>{x.push(new ne(T+(N-I)/(L-I)*(A-T),N))};for(const x of t){const T=[];for(const I of x){if(I.length<=2)continue;const A=[];for(let $=0;$<I.length-1;$++){const J=I[$].x,ee=I[$].y,ue=I[$+1].x,Re=I[$+1].y,et=0===s?J:ee,pt=0===s?ue:Re;et<e?pt>e&&_(A,J,ee,ue,Re,e):et>n?pt<n&&_(A,J,ee,ue,Re,n):A.push(I[$]),pt<e&&et>=e&&_(A,J,ee,ue,Re,e),pt>n&&et<=n&&_(A,J,ee,ue,Re,n)}let L=I[I.length-1];const N=0===s?L.x:L.y;N>=e&&N<=n&&A.push(L),A.length&&(L=A[A.length-1],A[0].x===L.x&&A[0].y===L.y||A.push(A[0]),T.push(A))}T.length&&h.push(T)}return h}$i.VectorTileLayer=jm;const C_=Bd.types,Zp=Math.pow(2,13);function wu(t,e,n,s,h,_,x,T){t.emplaceBack((e<<1)+x,(n<<1)+_,(Math.floor(s*Zp)<<1)+h,Math.round(T))}function Nd(t,e,n){t.emplaceBack(e.x,e.y,e.z,16384*n[0],16384*n[1],16384*n[2])}class T_{constructor(){this.acc=new ne(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ne(e.x,e.y),this.max=new ne(e.x,e.y))}append(e,n){this.currentPolyCount.edges++,this.acc._add(e);const s=this.min,h=this.max;e.x<s.x?s.x=e.x:e.x>h.x&&(h.x=e.x),e.y<s.y?s.y=e.y:e.y>h.y&&(h.y=e.y),((0===e.x||e.x===Ei)&&e.x===n.x)!=((0===e.y||e.y===Ei)&&e.y===n.y)&&this.processBorderOverlap(e,n),n.x<0!=e.x<0&&this.addBorderIntersection(0,vi(n.y,e.y,(0-n.x)/(e.x-n.x))),n.x>Ei!=e.x>Ei&&this.addBorderIntersection(1,vi(n.y,e.y,(Ei-n.x)/(e.x-n.x))),n.y<0!=e.y<0&&this.addBorderIntersection(2,vi(n.x,e.x,(0-n.y)/(e.y-n.y))),n.y>Ei!=e.y>Ei&&this.addBorderIntersection(3,vi(n.x,e.x,(Ei-n.y)/(e.y-n.y)))}addBorderIntersection(e,n){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const s=this.borders[e];n<s[0]&&(s[0]=n),n>s[1]&&(s[1]=n)}processBorderOverlap(e,n){if(e.x===n.x){if(e.y===n.y)return;const s=0===e.x?0:1;this.addBorderIntersection(s,n.y),this.addBorderIntersection(s,e.y)}else{const s=0===e.y?2:3;this.addBorderIntersection(s,n.x),this.addBorderIntersection(s,e.x)}}centroid(){const e=this.polyCount.reduce((n,s)=>n+s.edges,0);return 0!==e?this.acc.div(e)._round():new ne(0,0)}span(){return new ne(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,n)=>e+ +(n[0]!==Number.MAX_VALUE),0)}}class Ph{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Or,this.centroidVertexArray=new Fu,this.indexArray=new os,this.programConfigurations=new fu(e.layers,e.zoom),this.segments=new xo,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id),this.enableTerrain=e.enableTerrain}populate(e,n,s,h){this.features=[],this.hasPattern=Mh("fill-extrusion",this.layers,n),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const x=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*x/(x*x+1)/Ei/(1<<_.z)}(s),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:x,index:T,sourceLayerIndex:I}of e){const A=this.layers[0]._featureFilter.needGeometry,L=jc(_,A);if(!this.layers[0]._featureFilter.filter(new Zt(this.zoom),L,s))continue;const N={id:x,sourceLayerIndex:I,index:T,geometry:A?L.geometry:Bl(_,s,h),properties:_.properties,type:_.type,patterns:{}},$=this.layoutVertexArray.length;this.hasPattern?this.features.push(Vp("fill-extrusion",this.layers,N,this.zoom,n)):this.addFeature(N,N.geometry,T,s,{},n.availableImages,h),n.featureIndex.insert(_,N.geometry,T,I,this.index,$)}this.sortBorders()}addFeatures(e,n,s,h,_){for(const x of this.features){const{geometry:T}=x;this.addFeature(x,T,x.index,n,s,h,_)}this.sortBorders()}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,y_),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,__.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,g_.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,n,s,h,_,x,T){const I=[new ne(0,0),new ne(Ei,Ei)],A=T.projection,L="globe"===A.name,N=this.enableTerrain&&!L?new T_:null,$="Polygon"===C_[e.type];L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Ka);const J=Ba(n,500);for(let et=J.length-1;et>=0;et--){const pt=J[et];(0===pt.length||(ee=pt[0]).every(Ye=>Ye.x<=0)||ee.every(Ye=>Ye.x>=Ei)||ee.every(Ye=>Ye.y<=0)||ee.every(Ye=>Ye.y>=Ei))&&J.splice(et,1)}var ee;let ue;if(L)ue=Hp(J,I,h);else{ue=[];for(const et of J)ue.push({polygon:et,bounds:I})}const Re=$?this.edgeRadius:0;for(const{polygon:et,bounds:pt}of ue){let Ye=0,st=0;for(const mt of et)$&&!mt[0].equals(mt[mt.length-1])&&mt.push(mt[0]),st+=$?mt.length-1:mt.length;const Ct=this.segments.prepareSegment(($?5:4)*st,this.layoutVertexArray,this.indexArray);if($){const mt=[],Qt=[];Ye=Ct.vertexLength;for(const mn of et){let Fn,an;mn.length&&mn!==et[0]&&Qt.push(mt.length/2),Fn=mn[1].sub(mn[0])._perp()._unit();for(let yn=1;yn<mn.length;yn++){const vn=mn[yn],Pn=mn[yn===mn.length-1?1:yn+1];let{x:kn,y:ln}=vn;if(Re){an=Pn.sub(vn)._perp()._unit();const $n=Fn.add(an)._unit(),_i=Re*Math.min(4,1/(Fn.x*$n.x+Fn.y*$n.y));kn+=_i*$n.x,ln+=_i*$n.y,Fn=an}wu(this.layoutVertexArray,kn,ln,0,0,1,1,0),Ct.vertexLength++,mt.push(vn.x,vn.y),L&&Nd(this.layoutVertexExtArray,A.projectTilePoint(kn,ln,h),A.upVector(h,kn,ln))}}const Xt=Gu(mt,Qt);for(let mn=0;mn<Xt.length;mn+=3)this.indexArray.emplaceBack(Ye+Xt[mn],Ye+Xt[mn+2],Ye+Xt[mn+1]),Ct.primitiveLength++}for(const mt of et){N&&mt.length&&N.startRing(mt[0]);let Qt,Xt,mn,Fn=mt.length>4&&$m(mt[mt.length-2],mt[0],mt[1]),an=Re?D_(mt[mt.length-2],mt[0],mt[1],Re):0;Xt=mt[1].sub(mt[0])._perp()._unit();let yn=!0;for(let vn=1,Pn=0;vn<mt.length;vn++){let kn=mt[vn-1],ln=mt[vn];const $n=mt[vn===mt.length-1?1:vn+1];if(N&&$&&N.currentPolyCount.top++,I_(ln,kn,pt)){Re&&(Xt=$n.sub(ln)._perp()._unit(),yn=!yn);continue}N&&N.append(ln,kn);const _i=ln.sub(kn)._perp(),Wn=_i.x/(Math.abs(_i.x)+Math.abs(_i.y)),ni=_i.y>0?1:0,Zn=kn.dist(ln);if(Pn+Zn>32768&&(Pn=0),Re){mn=$n.sub(ln)._perp()._unit();let Zi=Gp(kn,ln,$n,E_(Xt,mn),Re);isNaN(Zi)&&(Zi=0);const Ti=ln.sub(kn)._unit();kn=kn.add(Ti.mult(an))._round(),ln=ln.add(Ti.mult(-Zi))._round(),an=Zi,Xt=mn}const wi=Ct.vertexLength,Xi=mt.length>4&&$m(kn,ln,$n);let Wi=Cu(Pn,Fn,yn);if(wu(this.layoutVertexArray,kn.x,kn.y,Wn,ni,0,0,Wi),wu(this.layoutVertexArray,kn.x,kn.y,Wn,ni,0,1,Wi),Pn+=Zn,Wi=Cu(Pn,Xi,!yn),Fn=Xi,wu(this.layoutVertexArray,ln.x,ln.y,Wn,ni,0,0,Wi),wu(this.layoutVertexArray,ln.x,ln.y,Wn,ni,0,1,Wi),Ct.vertexLength+=4,this.indexArray.emplaceBack(wi+0,wi+1,wi+2),this.indexArray.emplaceBack(wi+1,wi+3,wi+2),Ct.primitiveLength+=2,Re){const Zi=Ye+(1===vn?mt.length-2:vn-2),Ti=1===vn?Ye:Zi+1;if(this.indexArray.emplaceBack(wi+1,Zi,wi+3),this.indexArray.emplaceBack(Zi,Ti,wi+3),Ct.primitiveLength+=2,void 0===Qt&&(Qt=wi),!I_($n,mt[vn],pt)){const Sr=vn===mt.length-1?Qt:Ct.vertexLength;this.indexArray.emplaceBack(wi+2,wi+3,Sr),this.indexArray.emplaceBack(wi+3,Sr+1,Sr),this.indexArray.emplaceBack(wi+3,Ti,Sr+1),Ct.primitiveLength+=3}yn=!yn}if(L){const Zi=this.layoutVertexExtArray,Ti=A.projectTilePoint(kn.x,kn.y,h),Sr=A.projectTilePoint(ln.x,ln.y,h),Pi=A.upVector(h,kn.x,kn.y),nr=A.upVector(h,ln.x,ln.y);Nd(Zi,Ti,Pi),Nd(Zi,Ti,Pi),Nd(Zi,Sr,nr),Nd(Zi,Sr,nr)}}$&&(Ye+=mt.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const et=N.borders,pt=this.featuresOnBorder.push(N)-1;for(let Ye=0;Ye<4;Ye++)et[Ye][0]!==Number.MAX_VALUE&&this.borders[Ye].push(pt)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,_,x,h)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((n,s)=>this.featuresOnBorder[n].borders[e][0]-this.featuresOnBorder[s].borders[e][0])}encodeCentroid(e,n,s=!0){let h,_;if(e)if(0!==e.y){const T=n.span()._mult(this.tileToMeter);h=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(T.x/10)),_=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(T.y/10))}else h=Math.ceil(7*(e.x+450)),_=0;else h=0,_=+s;let x=s?this.centroidVertexArray.length:n.vertexArrayOffset;for(const T of n.polyCount){s&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*T.edges+T.top);for(let I=0;I<T.top;I++)this.centroidVertexArray.emplace(x++,h,_);for(let I=0;I<2*T.edges;I++)this.centroidVertexArray.emplace(x++,0,_),this.centroidVertexArray.emplace(x++,h,_)}}}function E_(t,e){const n=t.add(e)._unit();return t.x*n.x+t.y*n.y}function D_(t,e,n,s){const h=e.sub(t)._perp()._unit(),_=n.sub(e)._perp()._unit();return Gp(t,e,n,E_(h,_),s)}function Gp(t,e,n,s,h){const _=Math.sqrt(1-s*s);return Math.min(t.dist(e)/3,e.dist(n)/3,h*_/s)}function I_(t,e,n){return t.x<n[0].x&&e.x<n[0].x||t.x>n[1].x&&e.x>n[1].x||t.y<n[0].y&&e.y<n[0].y||t.y>n[1].y&&e.y>n[1].y}function $m(t,e,n){if(t.x<0||t.x>=Ei||e.x<0||e.x>=Ei||n.x<0||n.x>=Ei)return!1;const s=n.sub(e),h=s.perp(),_=t.sub(e);return(s.x*_.x+s.y*_.y)/Math.sqrt((s.x*s.x+s.y*s.y)*(_.x*_.x+_.y*_.y))>-.866&&h.x*_.x+h.y*_.y<0}function Cu(t,e,n){const s=e?2|t:-3&t;return n?1|s:-2&s}function Zm(){const t=Math.PI/32,e=Math.tan(t),n=Id;return n*Math.sqrt(1+2*e*e)-n}function Hp(t,e,n){const s=1<<n.z,h=ka(n.x/s),_=ka((n.x+1)/s),x=Cs(n.y/s),T=Cs((n.y+1)/s);return function(I,A,L,N,$=0,J){const ee=[];if(!I.length||!L||!N)return ee;const ue=(mt,Qt)=>{for(const Xt of mt)ee.push({polygon:Xt,bounds:Qt})},Re=Math.ceil(Math.log2(L)),et=Math.ceil(Math.log2(N)),pt=Re-et,Ye=[];for(let mt=0;mt<Math.abs(pt);mt++)Ye.push(pt>0?0:1);for(let mt=0;mt<Math.min(Re,et);mt++)Ye.push(0),Ye.push(1);let st=I;if(st=zl(st,A[0].y-$,A[1].y+$,1),st=zl(st,A[0].x-$,A[1].x+$,0),!st.length)return ee;const Ct=[];for(Ye.length?Ct.push({polygons:st,bounds:A,depth:0}):ue(st,A);Ct.length;){const mt=Ct.pop(),Qt=mt.depth,Xt=Ye[Qt],mn=mt.bounds[0],Fn=mt.bounds[1],an=0===Xt?mn.x:mn.y,yn=0===Xt?Fn.x:Fn.y,vn=J?J(Xt,an,yn):.5*(an+yn),Pn=zl(mt.polygons,an-$,vn+$,Xt),kn=zl(mt.polygons,vn-$,yn+$,Xt);if(Pn.length){const ln=[mn,new ne(0===Xt?vn:Fn.x,1===Xt?vn:Fn.y)];Ye.length>Qt+1?Ct.push({polygons:Pn,bounds:ln,depth:Qt+1}):ue(Pn,ln)}if(kn.length){const ln=[new ne(0===Xt?vn:mn.x,1===Xt?vn:mn.y),Fn];Ye.length>Qt+1?Ct.push({polygons:kn,bounds:ln,depth:Qt+1}):ue(kn,ln)}}return ee}(t,e,Math.ceil((_-h)/11.25),Math.ceil((x-T)/11.25),1,(I,A,L)=>{if(0===I)return.5*(A+L);{const N=Cs((n.y+A/Ei)/s);return(yl(.5*(Cs((n.y+L/Ei)/s)+N))*s-n.y)*Ei}})}Kn(Ph,"FillExtrusionBucket",{omit:["layers","features"]}),Kn(T_,"PartMetadata");const Oh=new On({"fill-extrusion-edge-radius":new $t(Jt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var M_={paint:new On({"fill-extrusion-opacity":new $t(Jt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new on(Jt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new $t(Jt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new $t(Jt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new on(Jt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new on(Jt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new on(Jt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new $t(Jt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new $t(Jt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new $t(Jt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"])}),layout:Oh};function Wp(t,e,n){var s=2*Math.PI*6378137/256/Math.pow(2,n);return[t*s-2*Math.PI*6378137/2,e*s-2*Math.PI*6378137/2]}class Rh{constructor(e,n,s){this.z=e,this.x=n,this.y=s,this.key=zd(0,e,e,n,s)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,n){const s=(x=this.y,T=this.z,I=Wp(256*(_=this.x),256*(x=Math.pow(2,T)-x-1),T),A=Wp(256*(_+1),256*(x+1),T),I[0]+","+I[1]+","+A[0]+","+A[1]),h=function(_,x,T){let I,A="";for(let L=_;L>0;L--)I=1<<L-1,A+=(x&I?1:0)+(T&I?2:0);return A}(this.z,this.x,this.y);var _,x,T,I,A;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===n?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",h).replace("{bbox-epsg-3857}",s)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Gm{constructor(e,n){this.wrap=e,this.canonical=n,this.key=zd(e,n.z,n.z,n.x,n.y)}}class Ks{constructor(e,n,s,h,_){this.overscaledZ=e,this.wrap=n,this.canonical=new Rh(s,+h,+_),this.key=0===n&&e===s?this.canonical.key:zd(n,e,s,h,_)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const n=this.canonical.z-e;return e>this.canonical.z?new Ks(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Ks(e,this.wrap,e,this.canonical.x>>n,this.canonical.y>>n)}calculateScaledKey(e,n=!0){if(this.overscaledZ===e&&n)return this.key;if(e>this.canonical.z)return zd(this.wrap*+n,e,this.canonical.z,this.canonical.x,this.canonical.y);{const s=this.canonical.z-e;return zd(this.wrap*+n,e,e,this.canonical.x>>s,this.canonical.y>>s)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const n=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>n&&e.canonical.y===this.canonical.y>>n}children(e){if(this.overscaledZ>=e)return[new Ks(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const n=this.canonical.z+1,s=2*this.canonical.x,h=2*this.canonical.y;return[new Ks(n,this.wrap,n,s,h),new Ks(n,this.wrap,n,s+1,h),new Ks(n,this.wrap,n,s,h+1),new Ks(n,this.wrap,n,s+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Ks(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Ks(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Gm(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function zd(t,e,n,s,h){const _=1<<Math.min(n,22);let x=_*(h%_)+s%_;return t&&n<22&&(x+=_*_*((t<0?-2*t-1:2*t)%(1<<2*(22-n)))),16*(32*x+n)+(e-n)}Kn(Rh,"CanonicalTileID"),Kn(Ks,"OverscaledTileID",{omit:["projMatrix"]});class Wu extends ne{constructor(e,n,s){super(e,n),this.z=s}}function qu(t,e){return t.x*e.x+t.y*e.y}function Hm(t,e){if(1===t.length){let n=0;const s=e[n++];let h;for(;!h||s.equals(h);)if(h=e[n++],!h)return 1/0;for(;n<e.length;n++){const _=e[n],x=t[0],T=h.sub(s),I=_.sub(s),A=x.sub(s),L=qu(T,T),N=qu(T,I),$=qu(I,I),J=qu(A,T),ee=qu(A,I),ue=L*$-N*N,Re=($*J-N*ee)/ue,et=(L*ee-N*J)/ue,pt=s.z*(1-Re-et)+h.z*Re+_.z*et;if(isFinite(pt))return pt}return 1/0}{let n=1/0;for(const s of e)n=Math.min(n,s.z);return n}}function qp(t,e,n,s,h,_,x,T){const I=x*h.getElevationAt(t,e,!0,!0),A=0!==_[0],L=A?0===_[1]?x*(_[0]/7-450):x*function(N,$,J){const ee=Math.floor($[0]/8),ue=Math.floor($[1]/8),Re=10*($[0]-8*ee),et=10*($[1]-8*ue),pt=N.getElevationAt(ee,ue,!0,!0),Ye=N.getMeterToDEM(J),st=Math.floor(.5*(Re*Ye-1)),Ct=Math.floor(.5*(et*Ye-1)),mt=N.tileCoordToPixel(ee,ue),Qt=2*st+1,Xt=2*Ct+1,mn=(_i=Qt,Wn=Xt,[(kn=N).getElevationAtPixel(ln=mt.x-st,$n=mt.y-Ct,!0),kn.getElevationAtPixel(ln+Wn,$n,!0),kn.getElevationAtPixel(ln,$n+Wn,!0),kn.getElevationAtPixel(ln+_i,$n+Wn,!0)]),Fn=Math.abs(mn[0]-mn[1]),an=Math.abs(mn[2]-mn[3]),yn=Math.abs(mn[0]-mn[2])+Math.abs(mn[1]-mn[3]),vn=Math.min(.25,.5*Ye*(Fn+an)/Qt),Pn=Math.min(.25,.5*Ye*yn/Xt);var kn,ln,$n,_i,Wn;return pt+Math.max(vn*Re,Pn*et)}(h,_,T):I;return{base:I+(0===n)?-1:n,top:A?Math.max(L+s,I+n+2):I+s}}const Wm=di([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:Yp}=Wm,Ny=di([{name:"a_packed",components:4,type:"Float32"}]),{members:Jp}=Ny,S_=Bd.types,zy=Math.cos(Math.PI/180*37.5);class pc{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(n=>n.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(n=>{this.gradients[n.id]={}}),this.layoutVertexArray=new Rr,this.layoutVertexArray2=new Vr,this.indexArray=new os,this.programConfigurations=new fu(e.layers,e.zoom),this.segments=new xo,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(n=>n.isStateDependent()).map(n=>n.id)}populate(e,n,s,h){this.hasPattern=Mh("line",this.layers,n);const _=this.layers[0].layout.get("line-sort-key"),x=[];for(const{feature:L,id:N,index:$,sourceLayerIndex:J}of e){const ee=this.layers[0]._featureFilter.needGeometry,ue=jc(L,ee);if(!this.layers[0]._featureFilter.filter(new Zt(this.zoom),ue,s))continue;const Re=_?_.evaluate(ue,{},s):void 0,et={id:N,properties:L.properties,type:L.type,sourceLayerIndex:J,index:$,geometry:ee?ue.geometry:Bl(L,s,h),patterns:{},sortKey:Re};x.push(et)}_&&x.sort((L,N)=>L.sortKey-N.sortKey);const{lineAtlas:T,featureIndex:I}=n,A=this.addConstantDashes(T);for(const L of x){const{geometry:N,index:$,sourceLayerIndex:J}=L;if(A&&this.addFeatureDashes(L,T),this.hasPattern){const ee=Vp("line",this.layers,L,this.zoom,n);this.patternFeatures.push(ee)}else this.addFeature(L,N,$,s,T.positions,n.availableImages);I.insert(e[$].feature,N,$,J,this.index)}}addConstantDashes(e){let n=!1;for(const s of this.layers){const h=s.paint.get("line-dasharray").value,_=s.layout.get("line-cap").value;if("constant"!==h.kind||"constant"!==_.kind)n=!0;else{const x=_.value,T=h.value;if(!T)continue;e.addDash(T,x)}}return n}addFeatureDashes(e,n){const s=this.zoom;for(const h of this.layers){const _=h.paint.get("line-dasharray").value,x=h.layout.get("line-cap").value;if("constant"===_.kind&&"constant"===x.kind)continue;let T,I;if("constant"===_.kind){if(T=_.value,!T)continue}else T=_.evaluate({zoom:s},e);I="constant"===x.kind?x.value:x.evaluate({zoom:s},e),n.addDash(T,I),e.patterns[h.id]=n.getKey(T,I)}}update(e,n,s,h){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,n,this.stateDependentLayers,s,h)}addFeatures(e,n,s,h,_){for(const x of this.patternFeatures)this.addFeature(x,x.geometry,x.index,n,s,h)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Jp)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Yp),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,n,s,h,_,x){const T=this.layers[0].layout,I=T.get("line-join").evaluate(e,{}),A=T.get("line-cap").evaluate(e,{}),L=T.get("line-miter-limit"),N=T.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const $ of n)this.addLine($,e,I,A,L,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,s,_,x,h)}addLine(e,n,s,h,_,x){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let et=0;et<e.length-1;et++)this.totalDistance+=e[et].dist(e[et+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const T="Polygon"===S_[n.type];let I=e.length;for(;I>=2&&e[I-1].equals(e[I-2]);)I--;let A=0;for(;A<I-1&&e[A].equals(e[A+1]);)A++;if(I<(T?3:2))return;"bevel"===s&&(_=1.05);const L=this.overscaling<=16?122880/(512*this.overscaling):0,N=this.segments.prepareSegment(10*I,this.layoutVertexArray,this.indexArray);let $,J,ee,ue,Re;this.e1=this.e2=-1,T&&($=e[I-2],Re=e[A].sub($)._unit()._perp());for(let et=A;et<I;et++){if(ee=et===I-1?T?e[A+1]:void 0:e[et+1],ee&&e[et].equals(ee))continue;Re&&(ue=Re),$&&(J=$),$=e[et],Re=ee?ee.sub($)._unit()._perp():ue,ue=ue||Re;let pt=ue.add(Re);0===pt.x&&0===pt.y||pt._unit();const Ye=ue.x*Re.x+ue.y*Re.y,st=pt.x*Re.x+pt.y*Re.y,Ct=0!==st?1/st:1/0,mt=2*Math.sqrt(2-2*st),Qt=st<zy&&J&&ee,Xt=ue.x*Re.y-ue.y*Re.x>0;if(Qt&&et>A){const an=$.dist(J);if(an>2*L){const yn=$.sub($.sub(J)._mult(L/an)._round());this.updateDistance(J,yn),this.addCurrentVertex(yn,ue,0,0,N),J=yn}}const mn=J&&ee;let Fn=mn?s:T?"butt":h;if(mn&&"round"===Fn&&(Ct<x?Fn="miter":Ct<=2&&(Fn="fakeround")),"miter"===Fn&&Ct>_&&(Fn="bevel"),"bevel"===Fn&&(Ct>2&&(Fn="flipbevel"),Ct<_&&(Fn="miter")),J&&this.updateDistance(J,$),"miter"===Fn)pt._mult(Ct),this.addCurrentVertex($,pt,0,0,N);else if("flipbevel"===Fn){if(Ct>100)pt=Re.mult(-1);else{const an=Ct*ue.add(Re).mag()/ue.sub(Re).mag();pt._perp()._mult(an*(Xt?-1:1))}this.addCurrentVertex($,pt,0,0,N),this.addCurrentVertex($,pt.mult(-1),0,0,N)}else if("bevel"===Fn||"fakeround"===Fn){const an=-Math.sqrt(Ct*Ct-1),yn=Xt?an:0,vn=Xt?0:an;if(J&&this.addCurrentVertex($,ue,yn,vn,N),"fakeround"===Fn){const Pn=Math.round(180*mt/Math.PI/20);for(let kn=1;kn<Pn;kn++){let ln=kn/Pn;if(.5!==ln){const _i=ln-.5;ln+=ln*_i*(ln-1)*((1.0904+Ye*(Ye*(3.55645-1.43519*Ye)-3.2452))*_i*_i+(.848013+Ye*(.215638*Ye-1.06021)))}const $n=Re.sub(ue)._mult(ln)._add(ue)._unit()._mult(Xt?-1:1);this.addHalfVertex($,$n.x,$n.y,!1,Xt,0,N)}}ee&&this.addCurrentVertex($,Re,-yn,-vn,N)}else if("butt"===Fn)this.addCurrentVertex($,pt,0,0,N);else if("square"===Fn){const an=J?1:-1;J||this.addCurrentVertex($,pt,an,an,N),this.addCurrentVertex($,pt,0,0,N),J&&this.addCurrentVertex($,pt,an,an,N)}else"round"===Fn&&(J&&(this.addCurrentVertex($,ue,0,0,N),this.addCurrentVertex($,ue,1,1,N,!0)),ee&&(this.addCurrentVertex($,Re,-1,-1,N,!0),this.addCurrentVertex($,Re,0,0,N)));if(Qt&&et<I-1){const an=$.dist(ee);if(an>2*L){const yn=$.add(ee.sub($)._mult(L/an)._round());this.updateDistance($,yn),this.addCurrentVertex(yn,Re,0,0,N),$=yn}}}}addCurrentVertex(e,n,s,h,_,x=!1){const T=n.y*h-n.x,I=-n.y-n.x*h;this.addHalfVertex(e,n.x+n.y*s,n.y-n.x*s,x,!1,s,_),this.addHalfVertex(e,T,I,x,!0,-h,_)}addHalfVertex({x:e,y:n},s,h,_,x,T,I){this.layoutVertexArray.emplaceBack((e<<1)+(_?1:0),(n<<1)+(x?1:0),Math.round(63*s)+128,Math.round(63*h)+128,1+(0===T?0:T<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const A=I.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,A),I.primitiveLength++),x?this.e2=A:this.e1=A}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,n){this.distance+=e.dist(n),this.updateScaledDistance()}}Kn(pc,"LineBucket",{omit:["layers","patternFeatures"]});const qm=new On({"line-cap":new on(Jt.layout_line["line-cap"]),"line-join":new on(Jt.layout_line["line-join"]),"line-miter-limit":new $t(Jt.layout_line["line-miter-limit"]),"line-round-limit":new $t(Jt.layout_line["line-round-limit"]),"line-sort-key":new on(Jt.layout_line["line-sort-key"])});var Ym={paint:new On({"line-opacity":new on(Jt.paint_line["line-opacity"]),"line-color":new on(Jt.paint_line["line-color"]),"line-translate":new $t(Jt.paint_line["line-translate"]),"line-translate-anchor":new $t(Jt.paint_line["line-translate-anchor"]),"line-width":new on(Jt.paint_line["line-width"]),"line-gap-width":new on(Jt.paint_line["line-gap-width"]),"line-offset":new on(Jt.paint_line["line-offset"]),"line-blur":new on(Jt.paint_line["line-blur"]),"line-dasharray":new on(Jt.paint_line["line-dasharray"]),"line-pattern":new on(Jt.paint_line["line-pattern"]),"line-gradient":new wn(Jt.paint_line["line-gradient"]),"line-trim-offset":new $t(Jt.paint_line["line-trim-offset"])}),layout:qm};const Xp=new class extends on{possiblyEvaluate(t,e){return e=new Zt(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(t,e)}evaluate(t,e,n,s){return e=It({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(t,e,n,s)}}(Ym.paint.properties["line-width"].specification);function Jm(t,e){return e>0?e+2*t:t}Xp.useIntegerZoom=!0;const A_=di([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Lh=di([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Yu=di([{name:"a_projected_pos",components:4,type:"Float32"}],4);di([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Kp=di([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),Ud=di([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const Fh=di([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),kh=di([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);di([{name:"triangle",components:3,type:"Uint16"}]),di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),di([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),di([{type:"Float32",name:"offsetX"}]),di([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var ls=24;const tl=128;function Vd(t,e){const{expression:n}=e;if("constant"===n.kind)return{kind:"constant",layoutSize:n.evaluate(new Zt(t+1))};if("source"===n.kind)return{kind:"source"};{const{zoomStops:s,interpolationType:h}=n;let _=0;for(;_<s.length&&s[_]<=t;)_++;_=Math.max(0,_-1);let x=_;for(;x<s.length&&s[x]<t+1;)x++;x=Math.min(s.length-1,x);const T=s[_],I=s[x];return"composite"===n.kind?{kind:"composite",minZoom:T,maxZoom:I,interpolationType:h}:{kind:"camera",minZoom:T,maxZoom:I,minSize:n.evaluate(new Zt(T)),maxSize:n.evaluate(new Zt(I)),interpolationType:h}}}function Ju(t,{uSize:e,uSizeT:n},{lowerSize:s,upperSize:h}){return"source"===t.kind?s/tl:"composite"===t.kind?vi(s/tl,h/tl,n):e}function Tu(t,e){let n=0,s=0;if("constant"===t.kind)s=t.layoutSize;else if("source"!==t.kind){const{interpolationType:h,minZoom:_,maxZoom:x}=t,T=h?me(ki.interpolationFactor(h,e,_,x),0,1):0;"camera"===t.kind?s=vi(t.minSize,t.maxSize,T):n=T}return{uSizeT:n,uSize:s}}var Qp=Object.freeze({__proto__:null,getSizeData:Vd,evaluateSizeForFeature:Ju,evaluateSizeForZoom:Tu,SIZE_PACK_FACTOR:tl});function P_(t,e,n){return t.sections.forEach(s=>{s.text=function(h,_,x){const T=_.layout.get("text-transform").evaluate(x,{});return"uppercase"===T?h=h.toLocaleUpperCase():"lowercase"===T&&(h=h.toLocaleLowerCase()),At.applyArabicShaping&&(h=At.applyArabicShaping(h)),h}(s.text,e,n)}),t}const jd={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42"};function Xm(t){return"\ufe36"===t||"\ufe48"===t||"\ufe38"===t||"\ufe44"===t||"\ufe42"===t||"\ufe3e"===t||"\ufe3c"===t||"\ufe3a"===t||"\ufe18"===t||"\ufe40"===t||"\ufe10"===t||"\ufe13"===t||"\ufe14"===t||"\uff40"===t||"\uffe3"===t||"\ufe11"===t||"\ufe12"===t}function O_(t){return"\ufe35"===t||"\ufe47"===t||"\ufe37"===t||"\ufe43"===t||"\ufe41"===t||"\ufe3d"===t||"\ufe3b"===t||"\ufe39"===t||"\ufe17"===t||"\ufe3f"===t}var Xu=$r,ef=function(t,e,n,s,h){var _,x,T=8*h-s-1,I=(1<<T)-1,A=I>>1,L=-7,N=n?h-1:0,$=n?-1:1,J=t[e+N];for(N+=$,_=J&(1<<-L)-1,J>>=-L,L+=T;L>0;_=256*_+t[e+N],N+=$,L-=8);for(x=_&(1<<-L)-1,_>>=-L,L+=s;L>0;x=256*x+t[e+N],N+=$,L-=8);if(0===_)_=1-A;else{if(_===I)return x?NaN:1/0*(J?-1:1);x+=Math.pow(2,s),_-=A}return(J?-1:1)*x*Math.pow(2,_-s)},Km=function(t,e,n,s,h,_){var x,T,I,A=8*_-h-1,L=(1<<A)-1,N=L>>1,$=23===h?Math.pow(2,-24)-Math.pow(2,-77):0,J=s?0:_-1,ee=s?1:-1,ue=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(T=isNaN(e)?1:0,x=L):(x=Math.floor(Math.log(e)/Math.LN2),e*(I=Math.pow(2,-x))<1&&(x--,I*=2),(e+=x+N>=1?$/I:$*Math.pow(2,1-N))*I>=2&&(x++,I/=2),x+N>=L?(T=0,x=L):x+N>=1?(T=(e*I-1)*Math.pow(2,h),x+=N):(T=e*Math.pow(2,N-1)*Math.pow(2,h),x=0));h>=8;t[n+J]=255&T,J+=ee,T/=256,h-=8);for(x=x<<h|T,A+=h;A>0;t[n+J]=255&x,J+=ee,x/=256,A-=8);t[n+J-ee]|=128*ue};function $r(t){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(t)?t:new Uint8Array(t||0),this.pos=0,this.type=0,this.length=this.buf.length}$r.Varint=0,$r.Fixed64=1,$r.Bytes=2,$r.Fixed32=5;var sa=4294967296,tf=1/sa,Qm=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Gc(t){return t.type===$r.Bytes?t.readVarint()+t.pos:t.pos+1}function nf(t,e,n){var s=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));n.realloc(s);for(var h=n.pos-1;h>=t;h--)n.buf[h+s]=n.buf[h]}function R_(t,e){for(var n=0;n<t.length;n++)e.writeVarint(t[n])}function L_(t,e){for(var n=0;n<t.length;n++)e.writeSVarint(t[n])}function F_(t,e){for(var n=0;n<t.length;n++)e.writeFloat(t[n])}function eg(t,e){for(var n=0;n<t.length;n++)e.writeDouble(t[n])}function k_(t,e){for(var n=0;n<t.length;n++)e.writeBoolean(t[n])}function B_(t,e){for(var n=0;n<t.length;n++)e.writeFixed32(t[n])}function rf(t,e){for(var n=0;n<t.length;n++)e.writeSFixed32(t[n])}function N_(t,e){for(var n=0;n<t.length;n++)e.writeFixed64(t[n])}function z_(t,e){for(var n=0;n<t.length;n++)e.writeSFixed64(t[n])}function Bh(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+16777216*t[e+3]}function Ku(t,e,n){t[n]=e,t[n+1]=e>>>8,t[n+2]=e>>>16,t[n+3]=e>>>24}function tg(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16)+(t[e+3]<<24)}function Ul(t,e,n){e.glyphs=[],1===t&&n.readMessage(sf,e)}function sf(t,e,n){if(3===t){const{id:s,bitmap:h,width:_,height:x,left:T,top:I,advance:A}=n.readMessage(U_,{});e.glyphs.push({id:s,bitmap:new dc({width:_+6,height:x+6},h),metrics:{width:_,height:x,left:T,top:I,advance:A}})}else 4===t?e.ascender=n.readSVarint():5===t&&(e.descender=n.readSVarint())}function U_(t,e,n){1===t?e.id=n.readVarint():2===t?e.bitmap=n.readBytes():3===t?e.width=n.readVarint():4===t?e.height=n.readVarint():5===t?e.left=n.readSVarint():6===t?e.top=n.readSVarint():7===t&&(e.advance=n.readVarint())}function af(t){let e=0,n=0;for(const x of t)e+=x.w*x.h,n=Math.max(n,x.w);t.sort((x,T)=>T.h-x.h);const s=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),n),h:1/0}];let h=0,_=0;for(const x of t)for(let T=s.length-1;T>=0;T--){const I=s[T];if(!(x.w>I.w||x.h>I.h)){if(x.x=I.x,x.y=I.y,_=Math.max(_,x.y+x.h),h=Math.max(h,x.x+x.w),x.w===I.w&&x.h===I.h){const A=s.pop();T<s.length&&(s[T]=A)}else x.h===I.h?(I.x+=x.w,I.w-=x.w):x.w===I.w?(I.y+=x.h,I.h-=x.h):(s.push({x:I.x+x.w,y:I.y,w:I.w-x.w,h:x.h}),I.y+=x.h,I.h-=x.h);break}}return{w:h,h:_,fill:e/(h*_)||0}}$r.prototype={destroy:function(){this.buf=null},readFields:function(t,e,n){for(n=n||this.length;this.pos<n;){var s=this.readVarint(),h=s>>3,_=this.pos;this.type=7&s,t(h,e,this),this.pos===_&&this.skip(s)}return e},readMessage:function(t,e){return this.readFields(t,e,this.readVarint()+this.pos)},readFixed32:function(){var t=Bh(this.buf,this.pos);return this.pos+=4,t},readSFixed32:function(){var t=tg(this.buf,this.pos);return this.pos+=4,t},readFixed64:function(){var t=Bh(this.buf,this.pos)+Bh(this.buf,this.pos+4)*sa;return this.pos+=8,t},readSFixed64:function(){var t=Bh(this.buf,this.pos)+tg(this.buf,this.pos+4)*sa;return this.pos+=8,t},readFloat:function(){var t=ef(this.buf,this.pos,!0,23,4);return this.pos+=4,t},readDouble:function(){var t=ef(this.buf,this.pos,!0,52,8);return this.pos+=8,t},readVarint:function(t){var e,n,s=this.buf;return e=127&(n=s[this.pos++]),n<128?e:(e|=(127&(n=s[this.pos++]))<<7,n<128?e:(e|=(127&(n=s[this.pos++]))<<14,n<128?e:(e|=(127&(n=s[this.pos++]))<<21,n<128?e:function(h,_,x){var T,I,A=x.buf;if(T=(112&(I=A[x.pos++]))>>4,I<128||(T|=(127&(I=A[x.pos++]))<<3,I<128)||(T|=(127&(I=A[x.pos++]))<<10,I<128)||(T|=(127&(I=A[x.pos++]))<<17,I<128)||(T|=(127&(I=A[x.pos++]))<<24,I<128)||(T|=(1&(I=A[x.pos++]))<<31,I<128))return function Hc(t,e,n){return n?4294967296*e+(t>>>0):4294967296*(e>>>0)+(t>>>0)}(h,T,_);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(n=s[this.pos]))<<28,t,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var t=this.readVarint();return t%2==1?(t+1)/-2:t/2},readBoolean:function(){return Boolean(this.readVarint())},readString:function(){var t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=12&&Qm?Qm.decode(this.buf.subarray(e,t)):function(n,s,h){for(var _="",x=s;x<h;){var T,I,A,L=n[x],N=null,$=L>239?4:L>223?3:L>191?2:1;if(x+$>h)break;1===$?L<128&&(N=L):2===$?128==(192&(T=n[x+1]))&&(N=(31&L)<<6|63&T)<=127&&(N=null):3===$?(I=n[x+2],128==(192&(T=n[x+1]))&&128==(192&I)&&((N=(15&L)<<12|(63&T)<<6|63&I)<=2047||N>=55296&&N<=57343)&&(N=null)):4===$&&(I=n[x+2],A=n[x+3],128==(192&(T=n[x+1]))&&128==(192&I)&&128==(192&A)&&((N=(15&L)<<18|(63&T)<<12|(63&I)<<6|63&A)<=65535||N>=1114112)&&(N=null)),null===N?(N=65533,$=1):N>65535&&(N-=65536,_+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),_+=String.fromCharCode(N),x+=$}return _}(this.buf,e,t)},readBytes:function(){var t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e},readPackedVarint:function(t,e){if(this.type!==$r.Bytes)return t.push(this.readVarint(e));var n=Gc(this);for(t=t||[];this.pos<n;)t.push(this.readVarint(e));return t},readPackedSVarint:function(t){if(this.type!==$r.Bytes)return t.push(this.readSVarint());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readSVarint());return t},readPackedBoolean:function(t){if(this.type!==$r.Bytes)return t.push(this.readBoolean());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readBoolean());return t},readPackedFloat:function(t){if(this.type!==$r.Bytes)return t.push(this.readFloat());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readFloat());return t},readPackedDouble:function(t){if(this.type!==$r.Bytes)return t.push(this.readDouble());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readDouble());return t},readPackedFixed32:function(t){if(this.type!==$r.Bytes)return t.push(this.readFixed32());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed32());return t},readPackedSFixed32:function(t){if(this.type!==$r.Bytes)return t.push(this.readSFixed32());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed32());return t},readPackedFixed64:function(t){if(this.type!==$r.Bytes)return t.push(this.readFixed64());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readFixed64());return t},readPackedSFixed64:function(t){if(this.type!==$r.Bytes)return t.push(this.readSFixed64());var e=Gc(this);for(t=t||[];this.pos<e;)t.push(this.readSFixed64());return t},skip:function(t){var e=7&t;if(e===$r.Varint)for(;this.buf[this.pos++]>127;);else if(e===$r.Bytes)this.pos=this.readVarint()+this.pos;else if(e===$r.Fixed32)this.pos+=4;else{if(e!==$r.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(t,e){this.writeVarint(t<<3|e)},realloc:function(t){for(var e=this.length||16;e<this.pos+t;)e*=2;if(e!==this.length){var n=new Uint8Array(e);n.set(this.buf),this.buf=n,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(t){this.realloc(4),Ku(this.buf,t,this.pos),this.pos+=4},writeSFixed32:function(t){this.realloc(4),Ku(this.buf,t,this.pos),this.pos+=4},writeFixed64:function(t){this.realloc(8),Ku(this.buf,-1&t,this.pos),Ku(this.buf,Math.floor(t*tf),this.pos+4),this.pos+=8},writeSFixed64:function(t){this.realloc(8),Ku(this.buf,-1&t,this.pos),Ku(this.buf,Math.floor(t*tf),this.pos+4),this.pos+=8},writeVarint:function(t){(t=+t||0)>268435455||t<0?function(e,n){var s,h,_,T;if(e>=0?(s=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(s=~(-e%4294967296))?s=s+1|0:(s=0,h=h+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");n.realloc(10),_=s,(T=n).buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,_>>>=7,T.buf[T.pos++]=127&_|128,T.buf[T.pos]=127&(_>>>=7),function(_,x){var T=(7&_)<<4;x.buf[x.pos++]|=T|((_>>>=3)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_|((_>>>=7)?128:0),_&&(x.buf[x.pos++]=127&_)))))}(h,n)}(t,this):(this.realloc(4),this.buf[this.pos++]=127&t|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=127&(t>>>=7)|(t>127?128:0),t<=127||(this.buf[this.pos++]=t>>>7&127))))},writeSVarint:function(t){this.writeVarint(t<0?2*-t-1:2*t)},writeBoolean:function(t){this.writeVarint(Boolean(t))},writeString:function(t){t=String(t),this.realloc(4*t.length),this.pos++;var e=this.pos;this.pos=function(s,h,_){for(var x,T,I=0;I<h.length;I++){if((x=h.charCodeAt(I))>55295&&x<57344){if(!T){x>56319||I+1===h.length?(s[_++]=239,s[_++]=191,s[_++]=189):T=x;continue}if(x<56320){s[_++]=239,s[_++]=191,s[_++]=189,T=x;continue}x=T-55296<<10|x-56320|65536,T=null}else T&&(s[_++]=239,s[_++]=191,s[_++]=189,T=null);x<128?s[_++]=x:(x<2048?s[_++]=x>>6|192:(x<65536?s[_++]=x>>12|224:(s[_++]=x>>18|240,s[_++]=x>>12&63|128),s[_++]=x>>6&63|128),s[_++]=63&x|128)}return _}(this.buf,t,this.pos);var n=this.pos-e;n>=128&&nf(e,n,this),this.pos=e-1,this.writeVarint(n),this.pos+=n},writeFloat:function(t){this.realloc(4),Km(this.buf,t,this.pos,!0,23,4),this.pos+=4},writeDouble:function(t){this.realloc(8),Km(this.buf,t,this.pos,!0,52,8),this.pos+=8},writeBytes:function(t){var e=t.length;this.writeVarint(e),this.realloc(e);for(var n=0;n<e;n++)this.buf[this.pos++]=t[n]},writeRawMessage:function(t,e){this.pos++;var n=this.pos;t(e,this);var s=this.pos-n;s>=128&&nf(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeMessage:function(t,e,n){this.writeTag(t,$r.Bytes),this.writeRawMessage(e,n)},writePackedVarint:function(t,e){e.length&&this.writeMessage(t,R_,e)},writePackedSVarint:function(t,e){e.length&&this.writeMessage(t,L_,e)},writePackedBoolean:function(t,e){e.length&&this.writeMessage(t,k_,e)},writePackedFloat:function(t,e){e.length&&this.writeMessage(t,F_,e)},writePackedDouble:function(t,e){e.length&&this.writeMessage(t,eg,e)},writePackedFixed32:function(t,e){e.length&&this.writeMessage(t,B_,e)},writePackedSFixed32:function(t,e){e.length&&this.writeMessage(t,rf,e)},writePackedFixed64:function(t,e){e.length&&this.writeMessage(t,N_,e)},writePackedSFixed64:function(t,e){e.length&&this.writeMessage(t,z_,e)},writeBytesField:function(t,e){this.writeTag(t,$r.Bytes),this.writeBytes(e)},writeFixed32Field:function(t,e){this.writeTag(t,$r.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(t,e){this.writeTag(t,$r.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(t,e){this.writeTag(t,$r.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(t,e){this.writeTag(t,$r.Fixed64),this.writeSFixed64(e)},writeVarintField:function(t,e){this.writeTag(t,$r.Varint),this.writeVarint(e)},writeSVarintField:function(t,e){this.writeTag(t,$r.Varint),this.writeSVarint(e)},writeStringField:function(t,e){this.writeTag(t,$r.Bytes),this.writeString(e)},writeFloatField:function(t,e){this.writeTag(t,$r.Fixed32),this.writeFloat(e)},writeDoubleField:function(t,e){this.writeTag(t,$r.Fixed64),this.writeDouble(e)},writeBooleanField:function(t,e){this.writeVarintField(t,Boolean(e))}};class Nh{constructor(e,{pixelRatio:n,version:s,stretchX:h,stretchY:_,content:x}){this.paddedRect=e,this.pixelRatio=n,this.stretchX=h,this.stretchY=_,this.content=x,this.version=s}get tl(){return[this.paddedRect.x+1,this.paddedRect.y+1]}get br(){return[this.paddedRect.x+this.paddedRect.w-1,this.paddedRect.y+this.paddedRect.h-1]}get displaySize(){return[(this.paddedRect.w-2)/this.pixelRatio,(this.paddedRect.h-2)/this.pixelRatio]}}class ng{constructor(e,n){const s={},h={};this.haveRenderCallbacks=[];const _=[];this.addImages(e,s,_),this.addImages(n,h,_);const{w:x,h:T}=af(_),I=new Ts({width:x||1,height:T||1});for(const A in e){const L=e[A],N=s[A].paddedRect;Ts.copy(L.data,I,{x:0,y:0},{x:N.x+1,y:N.y+1},L.data)}for(const A in n){const L=n[A],N=h[A].paddedRect,$=N.x+1,J=N.y+1,ee=L.data.width,ue=L.data.height;Ts.copy(L.data,I,{x:0,y:0},{x:$,y:J},L.data),Ts.copy(L.data,I,{x:0,y:ue-1},{x:$,y:J-1},{width:ee,height:1}),Ts.copy(L.data,I,{x:0,y:0},{x:$,y:J+ue},{width:ee,height:1}),Ts.copy(L.data,I,{x:ee-1,y:0},{x:$-1,y:J},{width:1,height:ue}),Ts.copy(L.data,I,{x:0,y:0},{x:$+ee,y:J},{width:1,height:ue})}this.image=I,this.iconPositions=s,this.patternPositions=h}addImages(e,n,s){for(const h in e){const _=e[h],x={x:0,y:0,w:_.data.width+2,h:_.data.height+2};s.push(x),n[h]=new Nh(x,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,n){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(s=>e.hasImage(s)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const s in e.updatedImages)this.patchUpdatedImage(this.iconPositions[s],e.getImage(s),n),this.patchUpdatedImage(this.patternPositions[s],e.getImage(s),n)}patchUpdatedImage(e,n,s){if(!e||!n||e.version===n.version)return;e.version=n.version;const[h,_]=e.tl;s.update(n.data,void 0,{x:h,y:_})}}Kn(Nh,"ImagePosition"),Kn(ng,"ImageAtlas");const Na={horizontal:1,vertical:2,horizontalOnly:3};class $d{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,n){const s=new $d;return s.scale=e||1,s.fontStack=n,s}static forImage(e){const n=new $d;return n.imageName=e,n}}class Wc{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,n){const s=new Wc;for(let h=0;h<e.sections.length;h++){const _=e.sections[h];_.image?s.addImageSection(_):s.addTextSection(_,n)}return s}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(n,s){let h="";for(let _=0;_<n.length;_++){const x=n.charCodeAt(_+1)||null,T=n.charCodeAt(_-1)||null;h+=!s&&(x&&E(x)&&!jd[n[_+1]]||T&&E(T)&&!jd[n[_-1]])||!jd[n[_]]?n[_]:jd[n[_]]}return h}(this.text,e)}trim(){let e=0;for(let s=0;s<this.text.length&&zh[this.text.charCodeAt(s)];s++)e++;let n=this.text.length;for(let s=this.text.length-1;s>=0&&s>=e&&zh[this.text.charCodeAt(s)];s--)n--;this.text=this.text.substring(e,n),this.sectionIndex=this.sectionIndex.slice(e,n)}substring(e,n){const s=new Wc;return s.text=this.text.substring(e,n),s.sectionIndex=this.sectionIndex.slice(e,n),s.sections=this.sections,s}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,n)=>Math.max(e,this.sections[n].scale),0)}addTextSection(e,n){this.text+=e.text,this.sections.push($d.forText(e.scale,e.fontStack||n));const s=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(s)}addImageSection(e){const n=e.image?e.image.name:"";if(0===n.length)return void bn("Can't add FormattedSection with an empty image.");const s=this.getNextImageSectionCharCode();s?(this.text+=String.fromCharCode(s),this.sections.push($d.forImage(n)),this.sectionIndex.push(this.sections.length-1)):bn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function lf(t,e,n,s,h,_,x,T,I,A,L,N,$,J,ee){const ue=Wc.fromFeature(t,h);N===Na.vertical&&ue.verticalizePunctuation($);let Re=[];const et=function(mt,Qt,Xt,mn,Fn,an){if(!mt)return[];const yn=[],vn=function($n,_i,Wn,ni,Zn,wi){let Xi=0;for(let Wi=0;Wi<$n.length();Wi++){const Zi=$n.getSection(Wi);Xi+=Vh($n.getCharCode(Wi),Zi,ni,Zn,_i,wi)}return Xi/Math.max(1,Math.ceil(Xi/Wn))}(mt,Qt,Xt,mn,Fn,an),Pn=mt.text.indexOf("\u200b")>=0;let kn=0;for(let $n=0;$n<mt.length();$n++){const _i=mt.getSection($n),Wn=mt.getCharCode($n);if(zh[Wn]||(kn+=Vh(Wn,_i,mn,Fn,Qt,an)),$n<mt.length()-1){const ni=!((ln=Wn)<11904||!(tc(ln)||au(ln)||m(ln)||nc(ln)||lu(ln)||Ru(ln)||sh(ln)||Oc(ln)||dl(ln)||cu(ln)||eo(ln)||y(ln)||su(ln)||Lu(ln)||Pc(ln)||dd(ln)||Rl(ln)||ic(ln)||Ja(ln)||Ns(ln)));(Uh[Wn]||ni||_i.imageName)&&yn.push(jh($n+1,kn,vn,yn,Uy(Wn,mt.getCharCode($n+1),ni&&Pn),!1))}}var ln;return V_(jh(mt.length(),kn,vn,yn,0,!0))}(ue,A,_,e,s,J),{processBidirectionalText:pt,processStyledBidirectionalText:Ye}=At;if(pt&&1===ue.sections.length){const mt=pt(ue.toString(),et);for(const Qt of mt){const Xt=new Wc;Xt.text=Qt,Xt.sections=ue.sections;for(let mn=0;mn<Qt.length;mn++)Xt.sectionIndex.push(0);Re.push(Xt)}}else if(Ye){const mt=Ye(ue.text,ue.sectionIndex,et);for(const Qt of mt){const Xt=new Wc;Xt.text=Qt[0],Xt.sectionIndex=Qt[1],Xt.sections=ue.sections,Re.push(Xt)}}else Re=function(mt,Qt){const Xt=[],mn=mt.text;let Fn=0;for(const an of Qt)Xt.push(mt.substring(Fn,an)),Fn=an;return Fn<mn.length&&Xt.push(mt.substring(Fn,mn.length)),Xt}(ue,et);const st=[],Ct={positionedLines:st,text:ue.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(mt,Qt,Xt,mn,Fn,an,yn,vn,Pn,kn,ln,$n){let _i=0,Wn=0,ni=0;const Zn="right"===vn?1:"left"===vn?0:.5;let wi=!1;for(const Pi of Fn){const nr=Pi.getSections();for(const Lr of nr){if(Lr.imageName)continue;const qr=Qt[Lr.fontStack];if(qr&&(wi=void 0!==qr.ascender&&void 0!==qr.descender,!wi))break}if(!wi)break}let Xi=0;for(const Pi of Fn){Pi.trim();const nr=Pi.getMaxScale(),Lr=(nr-1)*ls,qr={positionedGlyphs:[],lineOffset:0};mt.positionedLines[Xi]=qr;const Zr=qr.positionedGlyphs;let Yr=0;if(!Pi.length()){Wn+=an,++Xi;continue}let Jr=0,po=0;for(let Ar=0;Ar<Pi.length();Ar++){const Po=Pi.getSection(Ar),Io=Pi.getSectionIndex(Ar),fr=Pi.getCharCode(Ar);let oo=Po.scale,No=null,Fr=null,wo=null,Es=ls,qo=0;const Yo=!(Pn===Na.horizontal||!ln&&!w(fr)||ln&&(zh[fr]||(Wi=fr,ou(Wi)||ud(Wi)||Pr(Wi)||Xa(Wi)||c(Wi))));if(Po.imageName){const Vs=mn[Po.imageName];if(!Vs)continue;wo=Po.imageName,mt.iconsInText=mt.iconsInText||!0,Fr=Vs.paddedRect;const Jo=Vs.displaySize;oo=oo*ls/$n,No={width:Jo[0],height:Jo[1],left:1,top:-3,advance:Yo?Jo[1]:Jo[0],localGlyph:!1},qo=wi?-No.height*oo:nr*ls-17-Jo[1]*oo,Es=No.advance;const Zl=(Yo?Jo[0]:Jo[1])*oo-ls*nr;Zl>0&&Zl>Yr&&(Yr=Zl)}else{const Vs=Xt[Po.fontStack];if(!Vs)continue;Vs[fr]&&(Fr=Vs[fr]);const Jo=Qt[Po.fontStack];if(!Jo)continue;const Zl=Jo.glyphs[fr];if(!Zl)continue;if(No=Zl.metrics,Es=8203!==fr?ls:0,wi){const Pu=void 0!==Jo.ascender?Math.abs(Jo.ascender):0,ad=void 0!==Jo.descender?Math.abs(Jo.descender):0,ld=(Pu+ad)*oo;Jr<ld&&(Jr=ld,po=(Pu-ad)/2*oo),qo=-Pu*oo}else qo=(nr-oo)*ls-17}Yo?(mt.verticalizable=!0,Zr.push({glyph:fr,imageName:wo,x:_i,y:Wn+qo,vertical:Yo,scale:oo,localGlyph:No.localGlyph,fontStack:Po.fontStack,sectionIndex:Io,metrics:No,rect:Fr}),_i+=Es*oo+kn):(Zr.push({glyph:fr,imageName:wo,x:_i,y:Wn+qo,vertical:Yo,scale:oo,localGlyph:No.localGlyph,fontStack:Po.fontStack,sectionIndex:Io,metrics:No,rect:Fr}),_i+=No.advance*oo+kn)}0!==Zr.length&&(ni=Math.max(_i-kn,ni),wi?cf(Zr,Zn,Yr,po,an*nr/2):cf(Zr,Zn,Yr,0,an/2)),_i=0;const us=an*nr+Yr;qr.lineOffset=Math.max(Yr,Lr),Wn+=us,++Xi}var Wi;const Zi=Wn,{horizontalAlign:Ti,verticalAlign:Sr}=$h(yn);(function(Pi,nr,Lr,qr,Zr,Yr){const Jr=(nr-Lr)*Zr,po=-Yr*qr;for(const us of Pi)for(const Ar of us.positionedGlyphs)Ar.x+=Jr,Ar.y+=po})(mt.positionedLines,Zn,Ti,Sr,ni,Zi),mt.top+=-Sr*Zi,mt.bottom=mt.top+Zi,mt.left+=-Ti*ni,mt.right=mt.left+ni,mt.hasBaseline=wi}(Ct,e,n,s,Re,x,T,I,N,A,$,ee),!function(mt){for(const Qt of mt)if(0!==Qt.positionedGlyphs.length)return!1;return!0}(st)&&Ct}const zh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Uh={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Vh(t,e,n,s,h,_){if(e.imageName){const x=s[e.imageName];return x?x.displaySize[0]*e.scale*ls/_+h:0}{const x=n[e.fontStack],T=x&&x.glyphs[t];return T?T.metrics.advance*e.scale+h:0}}function Zd(t,e,n,s){const h=Math.pow(t-e,2);return s?t<e?h/2:2*h:h+Math.abs(n)*n}function Uy(t,e,n){let s=0;return 10===t&&(s-=1e4),n&&(s+=150),40!==t&&65288!==t||(s+=50),41!==e&&65289!==e||(s+=50),s}function jh(t,e,n,s,h,_){let x=null,T=Zd(e,n,h,_);for(const I of s){const A=Zd(e-I.x,n,h,_)+I.badness;A<=T&&(x=I,T=A)}return{index:t,x:e,priorBreak:x,badness:T}}function V_(t){return t?V_(t.priorBreak).concat(t.index):[]}function $h(t){let e=.5,n=.5;switch(t){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(t){case"bottom":case"bottom-right":case"bottom-left":n=1;break;case"top":case"top-right":case"top-left":n=0}return{horizontalAlign:e,verticalAlign:n}}function cf(t,e,n,s,h){if(!(e||n||s||h))return;const _=t.length-1,x=t[_],T=(x.x+x.metrics.advance*x.scale)*e;for(let I=0;I<=_;I++)t[I].x-=T,t[I].y+=n+s+h}function ig(t,e,n){const{horizontalAlign:s,verticalAlign:h}=$h(n),_=e[0]-t.displaySize[0]*s,x=e[1]-t.displaySize[1]*h;return{image:t,top:x,bottom:x+t.displaySize[1],left:_,right:_+t.displaySize[0]}}function uf(t,e,n,s,h,_){const x=t.image;let T;if(x.content){const Re=x.content,et=x.pixelRatio||1;T=[Re[0]/et,Re[1]/et,x.displaySize[0]-Re[2]/et,x.displaySize[1]-Re[3]/et]}const I=e.left*_,A=e.right*_;let L,N,$,J;"width"===n||"both"===n?(J=h[0]+I-s[3],N=h[0]+A+s[1]):(J=h[0]+(I+A-x.displaySize[0])/2,N=J+x.displaySize[0]);const ee=e.top*_,ue=e.bottom*_;return"height"===n||"both"===n?(L=h[1]+ee-s[0],$=h[1]+ue+s[2]):(L=h[1]+(ee+ue-x.displaySize[1])/2,$=L+x.displaySize[1]),{image:x,top:L,right:N,bottom:$,left:J,collisionPadding:T}}class xl extends ne{constructor(e,n,s,h,_){super(e,n),this.angle=h,this.z=s,void 0!==_&&(this.segment=_)}clone(){return new xl(this.x,this.y,this.z,this.angle,this.segment)}}function Vl(t,e,n,s,h){if(void 0===e.segment)return!0;let _=e,x=e.segment+1,T=0;for(;T>-n/2;){if(x--,x<0)return!1;T-=t[x].dist(_),_=t[x]}T+=t[x].dist(t[x+1]),x++;const I=[];let A=0;for(;T<n/2;){const L=t[x],N=t[x+1];if(!N)return!1;let $=t[x-1].angleTo(L)-L.angleTo(N);for($=Math.abs(($+3*Math.PI)%(2*Math.PI)-Math.PI),I.push({distance:T,angleDelta:$}),A+=$;T-I[0].distance>s;)A-=I.shift().angleDelta;if(A>h)return!1;x++,T+=L.dist(N)}return!0}function Gd(t){let e=0;for(let n=0;n<t.length-1;n++)e+=t[n].dist(t[n+1]);return e}function Hd(t,e,n){return t?.6*e*n:0}function Qu(t,e){return Math.max(t?t.right-t.left:0,e?e.right-e.left:0)}function j_(t,e,n,s,h,_){const x=Hd(n,h,_),T=Qu(n,s)*_;let I=0;const A=Gd(t)/2;for(let L=0;L<t.length-1;L++){const N=t[L],$=t[L+1],J=N.dist($);if(I+J>A){const ee=(A-I)/J,ue=vi(N.x,$.x,ee),Re=vi(N.y,$.y,ee),et=new xl(ue,Re,0,$.angleTo(N),L);return!x||Vl(t,et,T,x,e)?et:void 0}I+=J}}function rg(t,e,n,s,h,_,x,T,I){const A=Hd(s,_,x),L=Qu(s,h),N=L*x,$=0===t[0].x||t[0].x===I||0===t[0].y||t[0].y===I;return e-N<e/4&&(e=N+e/4),df(t,$?e/2*T%e:(L/2+2*_)*x*T%e,e,A,n,N,$,!1,I)}function df(t,e,n,s,h,_,x,T,I){const A=_/2,L=Gd(t);let N=0,$=e-n,J=[];for(let ee=0;ee<t.length-1;ee++){const ue=t[ee],Re=t[ee+1],et=ue.dist(Re),pt=Re.angleTo(ue);for(;$+n<N+et;){$+=n;const Ye=($-N)/et,st=vi(ue.x,Re.x,Ye),Ct=vi(ue.y,Re.y,Ye);if(st>=0&&st<I&&Ct>=0&&Ct<I&&$-A>=0&&$+A<=L){const mt=new xl(st,Ct,0,pt,ee);mt._round(),s&&!Vl(t,mt,_,s,h)||J.push(mt)}}N+=et}return T||J.length||x||(J=df(t,N/2,n,s,h,_,x,!0,I)),J}function og(t,e,n,s,h){const _=[];for(let x=0;x<t.length;x++){const T=t[x];let I;for(let A=0;A<T.length-1;A++){let L=T[A],N=T[A+1];L.x<e&&N.x<e||(L.x<e?L=new ne(e,L.y+(e-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x<e&&(N=new ne(e,L.y+(e-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y<n&&N.y<n||(L.y<n?L=new ne(L.x+(n-L.y)/(N.y-L.y)*(N.x-L.x),n)._round():N.y<n&&(N=new ne(L.x+(n-L.y)/(N.y-L.y)*(N.x-L.x),n)._round()),L.x>=s&&N.x>=s||(L.x>=s?L=new ne(s,L.y+(s-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x>=s&&(N=new ne(s,L.y+(s-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y>=h&&N.y>=h||(L.y>=h?L=new ne(L.x+(h-L.y)/(N.y-L.y)*(N.x-L.x),h)._round():N.y>=h&&(N=new ne(L.x+(h-L.y)/(N.y-L.y)*(N.x-L.x),h)._round()),I&&L.equals(I[I.length-1])||(I=[L],_.push(I)),I.push(N)))))}}return _}Kn(xl,"Anchor");const Wd=1e20;function ed(t,e,n,s,h,_,x,T,I){for(let A=e;A<e+s;A++)sg(t,n*_+A,_,h,x,T,I);for(let A=n;A<n+h;A++)sg(t,A*_+e,1,s,x,T,I)}function sg(t,e,n,s,h,_,x){_[0]=0,x[0]=-Wd,x[1]=Wd,h[0]=t[e];for(let T=1,I=0,A=0;T<s;T++){h[T]=t[e+T*n];const L=T*T;do{const N=_[I];A=(h[T]-h[N]+L-N*N)/(T-N)/2}while(A<=x[I]&&--I>-1);I++,_[I]=T,x[I]=A,x[I+1]=Wd}for(let T=0,I=0;T<s;T++){for(;x[I+1]<T;)I++;const A=_[I],L=T-A;t[e+T*n]=h[A]+L*L}}const ag={none:0,ideographs:1,all:2};class td{constructor(e,n,s){this.requestManager=e,this.localGlyphMode=n,this.localFontFamily=s,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,n){const s=[];for(const h in e)for(const _ of e[h])s.push({stack:h,id:_});Ee(s,({stack:h,id:_},x)=>{let T=this.entries[h];T||(T=this.entries[h]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let I=T.glyphs[_];if(void 0!==I)return void x(null,{stack:h,id:_,glyph:I});if(I=this._tinySDF(T,h,_),I)return T.glyphs[_]=I,void x(null,{stack:h,id:_,glyph:I});const A=Math.floor(_/256);if(256*A>65535)return void x(new Error("glyphs > 65535 not supported"));if(T.ranges[A])return void x(null,{stack:h,id:_,glyph:I});let L=T.requests[A];L||(L=T.requests[A]=[],td.loadGlyphRange(h,A,this.url,this.requestManager,(N,$)=>{if($){T.ascender=$.ascender,T.descender=$.descender;for(const J in $.glyphs)this._doesCharSupportLocalGlyph(+J)||(T.glyphs[+J]=$.glyphs[+J]);T.ranges[A]=!0}for(const J of L)J(N,$);delete T.requests[A]})),L.push((N,$)=>{N?x(N):$&&x(null,{stack:h,id:_,glyph:$.glyphs[_]||null})})},(h,_)=>{if(h)n(h);else if(_){const x={};for(const{stack:T,id:I,glyph:A}of _)void 0===x[T]&&(x[T]={}),void 0===x[T].glyphs&&(x[T].glyphs={}),x[T].glyphs[I]=A&&{id:A.id,bitmap:A.bitmap.clone(),metrics:A.metrics},x[T].ascender=this.entries[T].ascender,x[T].descender=this.entries[T].descender;n(null,x)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==ag.none&&(this.localGlyphMode===ag.all?!!this.localFontFamily:!!this.localFontFamily&&(cu(e)||uu(e)||su(e)||Rl(e)||Oc(e)))}_tinySDF(e,n,s){const h=this.localFontFamily;if(!h||!this._doesCharSupportLocalGlyph(s))return;let _=e.tinySDF;if(!_){let ue="400";/bold/i.test(n)?ue="900":/medium/i.test(n)?ue="500":/light/i.test(n)&&(ue="200"),_=e.tinySDF=new td.TinySDF({fontFamily:h,fontWeight:ue,fontSize:48,buffer:6,radius:16}),_.fontWeight=ue}if(this.localGlyphs[_.fontWeight][s])return this.localGlyphs[_.fontWeight][s];const x=String.fromCharCode(s),{data:T,width:I,height:A,glyphWidth:L,glyphHeight:N,glyphLeft:$,glyphTop:J,glyphAdvance:ee}=_.draw(x);return this.localGlyphs[_.fontWeight][s]={id:s,bitmap:new dc({width:I,height:A},T),metrics:{width:L/2,height:N/2,left:$/2,top:J/2-27,advance:ee/2,localGlyph:!0}}}}function lg(t,e,n,s){const h=[],_=t.image,x=_.pixelRatio,T=_.paddedRect.w-2,I=_.paddedRect.h-2,A=t.right-t.left,L=t.bottom-t.top,N=_.stretchX||[[0,T]],$=_.stretchY||[[0,I]],J=(an,yn)=>an+yn[1]-yn[0],ee=N.reduce(J,0),ue=$.reduce(J,0),Re=T-ee,et=I-ue;let pt=0,Ye=ee,st=0,Ct=ue,mt=0,Qt=Re,Xt=0,mn=et;if(_.content&&s){const an=_.content;pt=Zh(N,0,an[0]),st=Zh($,0,an[1]),Ye=Zh(N,an[0],an[2]),Ct=Zh($,an[1],an[3]),mt=an[0]-pt,Xt=an[1]-st,Qt=an[2]-an[0]-Ye,mn=an[3]-an[1]-Ct}const Fn=(an,yn,vn,Pn)=>{const kn=Gh(an.stretch-pt,Ye,A,t.left),ln=Hh(an.fixed-mt,Qt,an.stretch,ee),$n=Gh(yn.stretch-st,Ct,L,t.top),_i=Hh(yn.fixed-Xt,mn,yn.stretch,ue),Wn=Gh(vn.stretch-pt,Ye,A,t.left),ni=Hh(vn.fixed-mt,Qt,vn.stretch,ee),Zn=Gh(Pn.stretch-st,Ct,L,t.top),wi=Hh(Pn.fixed-Xt,mn,Pn.stretch,ue),Xi=new ne(kn,$n),Wi=new ne(Wn,$n),Zi=new ne(Wn,Zn),Ti=new ne(kn,Zn),Sr=new ne(ln/x,_i/x),Pi=new ne(ni/x,wi/x),nr=e*Math.PI/180;if(nr){const Zr=Math.sin(nr),Yr=Math.cos(nr),Jr=[Yr,-Zr,Zr,Yr];Xi._matMult(Jr),Wi._matMult(Jr),Ti._matMult(Jr),Zi._matMult(Jr)}const Lr=an.stretch+an.fixed,qr=yn.stretch+yn.fixed;return{tl:Xi,tr:Wi,bl:Ti,br:Zi,tex:{x:_.paddedRect.x+1+Lr,y:_.paddedRect.y+1+qr,w:vn.stretch+vn.fixed-Lr,h:Pn.stretch+Pn.fixed-qr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Sr,pixelOffsetBR:Pi,minFontScaleX:Qt/x/A,minFontScaleY:mn/x/L,isSDF:n}};if(s&&(_.stretchX||_.stretchY)){const an=cg(N,Re,ee),yn=cg($,et,ue);for(let vn=0;vn<an.length-1;vn++){const Pn=an[vn],kn=an[vn+1];for(let ln=0;ln<yn.length-1;ln++)h.push(Fn(Pn,yn[ln],kn,yn[ln+1]))}}else h.push(Fn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:T+1},{fixed:0,stretch:I+1}));return h}function Zh(t,e,n){let s=0;for(const h of t)s+=Math.max(e,Math.min(n,h[1]))-Math.max(e,Math.min(n,h[0]));return s}function cg(t,e,n){const s=[{fixed:-1,stretch:0}];for(const[h,_]of t){const x=s[s.length-1];s.push({fixed:h-x.stretch,stretch:x.stretch}),s.push({fixed:h-x.stretch,stretch:x.stretch+(_-h)})}return s.push({fixed:e+1,stretch:n}),s}function Gh(t,e,n,s){return t/e*n+s}function Hh(t,e,n,s){return t-e*n/s}function $_(t,e,n,s){const h=e+t.positionedLines[s].lineOffset;return 0===s?n+h/2:n+(h+(e+t.positionedLines[s-1].lineOffset))/2}td.loadGlyphRange=function(t,e,n,s,h){const _=256*e,x=_+255,T=s.transformRequest(s.normalizeGlyphsURL(n).replace("{fontstack}",t).replace("{range}",`${_}-${x}`),Ge.Glyphs);rn(T,(I,A)=>{if(I)h(I);else if(A){const L={},N=new Xu(A).readFields(Ul,{});for(const $ of N.glyphs)L[$.id]=$;h(null,{glyphs:L,ascender:N.ascender,descender:N.descender})}})},td.TinySDF=class{constructor({fontSize:t=24,buffer:e=3,radius:n=8,cutoff:s=.25,fontFamily:h="sans-serif",fontWeight:_="normal",fontStyle:x="normal"}={}){this.buffer=e,this.cutoff=s,this.radius=n;const T=this.size=t+4*e,I=this._createCanvas(T),A=this.ctx=I.getContext("2d",{willReadFrequently:!0});A.font=`${x} ${_} ${t}px ${h}`,A.textBaseline="alphabetic",A.textAlign="left",A.fillStyle="black",this.gridOuter=new Float64Array(T*T),this.gridInner=new Float64Array(T*T),this.f=new Float64Array(T),this.z=new Float64Array(T+1),this.v=new Uint16Array(T)}_createCanvas(t){const e=document.createElement("canvas");return e.width=e.height=t,e}draw(t){const{width:e,actualBoundingBoxAscent:n,actualBoundingBoxDescent:s,actualBoundingBoxLeft:h,actualBoundingBoxRight:_}=this.ctx.measureText(t),x=Math.ceil(n),T=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-h))),I=Math.min(this.size-this.buffer,x+Math.ceil(s)),A=T+2*this.buffer,L=I+2*this.buffer,N=Math.max(A*L,0),$=new Uint8ClampedArray(N),J={data:$,width:A,height:L,glyphWidth:T,glyphHeight:I,glyphTop:x,glyphLeft:0,glyphAdvance:e};if(0===T||0===I)return J;const{ctx:ee,buffer:ue,gridInner:Re,gridOuter:et}=this;ee.clearRect(ue,ue,T,I),ee.fillText(t,ue,ue+x);const pt=ee.getImageData(ue,ue,T,I);et.fill(Wd,0,N),Re.fill(0,0,N);for(let Ye=0;Ye<I;Ye++)for(let st=0;st<T;st++){const Ct=pt.data[4*(Ye*T+st)+3]/255;if(0===Ct)continue;const mt=(Ye+ue)*A+st+ue;if(1===Ct)et[mt]=0,Re[mt]=Wd;else{const Qt=.5-Ct;et[mt]=Qt>0?Qt*Qt:0,Re[mt]=Qt<0?Qt*Qt:0}}ed(et,0,0,A,L,A,this.f,this.v,this.z),ed(Re,ue,ue,T,I,A,this.f,this.v,this.z);for(let Ye=0;Ye<N;Ye++){const st=Math.sqrt(et[Ye])-Math.sqrt(Re[Ye]);$[Ye]=Math.round(255-255*(st/this.radius+this.cutoff))}return J}};class ug{constructor(e=[],n=hf){if(this.data=e,this.length=this.data.length,this.compare=n,this.length>0)for(let s=(this.length>>1)-1;s>=0;s--)this._down(s)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],n=this.data.pop();return this.length--,this.length>0&&(this.data[0]=n,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:n,compare:s}=this,h=n[e];for(;e>0;){const _=e-1>>1,x=n[_];if(s(h,x)>=0)break;n[e]=x,e=_}n[e]=h}_down(e){const{data:n,compare:s}=this,h=this.length>>1,_=n[e];for(;e<h;){let x=1+(e<<1),T=n[x];const I=x+1;if(I<this.length&&s(n[I],T)<0&&(x=I,T=n[I]),s(T,_)>=0)break;n[e]=T,e=x}n[e]=_}}function hf(t,e){return t<e?-1:t>e?1:0}function Z_(t,e=1,n=!1){let s=1/0,h=1/0,_=-1/0,x=-1/0;const T=t[0];for(let J=0;J<T.length;J++){const ee=T[J];(!J||ee.x<s)&&(s=ee.x),(!J||ee.y<h)&&(h=ee.y),(!J||ee.x>_)&&(_=ee.x),(!J||ee.y>x)&&(x=ee.y)}const I=Math.min(_-s,x-h);let A=I/2;const L=new ug([],pf);if(0===I)return new ne(s,h);for(let J=s;J<_;J+=I)for(let ee=h;ee<x;ee+=I)L.push(new nd(J+A,ee+A,A,t));let N=function(J){let ee=0,ue=0,Re=0;const et=J[0];for(let pt=0,Ye=et.length,st=Ye-1;pt<Ye;st=pt++){const Ct=et[pt],mt=et[st],Qt=Ct.x*mt.y-mt.x*Ct.y;ue+=(Ct.x+mt.x)*Qt,Re+=(Ct.y+mt.y)*Qt,ee+=3*Qt}return new nd(ue/ee,Re/ee,0,J)}(t),$=L.length;for(;L.length;){const J=L.pop();(J.d>N.d||!N.d)&&(N=J,n&&console.log("found best %d after %d probes",Math.round(1e4*J.d)/1e4,$)),J.max-N.d<=e||(A=J.h/2,L.push(new nd(J.p.x-A,J.p.y-A,A,t)),L.push(new nd(J.p.x+A,J.p.y-A,A,t)),L.push(new nd(J.p.x-A,J.p.y+A,A,t)),L.push(new nd(J.p.x+A,J.p.y+A,A,t)),$+=4)}return n&&(console.log(`num probes: ${$}`),console.log(`best distance: ${N.d}`)),N.p}function pf(t,e){return e.max-t.max}function nd(t,e,n,s){this.p=new ne(t,e),this.h=n,this.d=function(h,_){let x=!1,T=1/0;for(let I=0;I<_.length;I++){const A=_[I];for(let L=0,N=A.length,$=N-1;L<N;$=L++){const J=A[L],ee=A[$];J.y>h.y!=ee.y>h.y&&h.x<(ee.x-J.x)*(h.y-J.y)/(ee.y-J.y)+J.x&&(x=!x),T=Math.min(T,Pd(h,J,ee))}}return(x?1:-1)*Math.sqrt(T)}(this.p,s),this.max=this.d+this.h*Math.SQRT2}const ff=Number.POSITIVE_INFINITY,G_=Math.sqrt(2);function dg(t,[e,n]){let s=0,h=0;if(n===ff){e<0&&(e=0);const _=e/G_;switch(t){case"top-right":case"top-left":h=_-7;break;case"bottom-right":case"bottom-left":h=7-_;break;case"bottom":h=7-e;break;case"top":h=e-7}switch(t){case"top-right":case"bottom-right":s=-_;break;case"top-left":case"bottom-left":s=_;break;case"left":s=e;break;case"right":s=-e}}else{switch(e=Math.abs(e),n=Math.abs(n),t){case"top-right":case"top-left":case"top":h=n-7;break;case"bottom-right":case"bottom-left":case"bottom":h=7-n}switch(t){case"top-right":case"bottom-right":case"right":s=-e;break;case"top-left":case"bottom-left":case"left":s=e}}return[s,h]}function H_(t,e,n,s,h,_,x,T,I,A){t.createArrays(),t.tilePixelRatio=Ei/(512*t.overscaling),t.compareText={},t.iconsNeedLinear=!1;const L=t.layers[0].layout,N=t.layers[0]._unevaluatedLayout._values,$={};if("composite"===t.textSizeData.kind){const{minZoom:ue,maxZoom:Re}=t.textSizeData;$.compositeTextSizes=[N["text-size"].possiblyEvaluate(new Zt(ue),T),N["text-size"].possiblyEvaluate(new Zt(Re),T)]}if("composite"===t.iconSizeData.kind){const{minZoom:ue,maxZoom:Re}=t.iconSizeData;$.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new Zt(ue),T),N["icon-size"].possiblyEvaluate(new Zt(Re),T)]}$.layoutTextSize=N["text-size"].possiblyEvaluate(new Zt(I+1),T),$.layoutIconSize=N["icon-size"].possiblyEvaluate(new Zt(I+1),T),$.textMaxSize=N["text-size"].possiblyEvaluate(new Zt(18),T);const J="map"===L.get("text-rotation-alignment")&&"point"!==L.get("symbol-placement"),ee=L.get("text-size");for(const ue of t.features){const Re=L.get("text-font").evaluate(ue,{},T).join(","),et=ee.evaluate(ue,{},T),pt=$.layoutTextSize.evaluate(ue,{},T),Ye=($.layoutIconSize.evaluate(ue,{},T),{horizontal:{},vertical:void 0}),st=ue.text;let Ct,mt=[0,0];if(st){const mn=st.toString(),Fn=L.get("text-letter-spacing").evaluate(ue,{},T)*ls,an=L.get("text-line-height").evaluate(ue,{},T)*ls,yn=p(mn)?Fn:0,vn=L.get("text-anchor").evaluate(ue,{},T),Pn=L.get("text-variable-anchor");if(!Pn){const Wn=L.get("text-radial-offset").evaluate(ue,{},T);mt=Wn?dg(vn,[Wn*ls,ff]):L.get("text-offset").evaluate(ue,{},T).map(ni=>ni*ls)}let kn=J?"center":L.get("text-justify").evaluate(ue,{},T);const ln="point"===L.get("symbol-placement"),$n=ln?L.get("text-max-width").evaluate(ue,{},T)*ls:1/0,_i=Wn=>{t.allowVerticalPlacement&&u(mn)&&(Ye.vertical=lf(st,e,n,h,Re,$n,an,vn,Wn,yn,mt,Na.vertical,!0,pt,et))};if(!J&&Pn){const Wn="auto"===kn?Pn.map(Zn=>mf(Zn)):[kn];let ni=!1;for(let Zn=0;Zn<Wn.length;Zn++){const wi=Wn[Zn];if(!Ye.horizontal[wi])if(ni)Ye.horizontal[wi]=Ye.horizontal[0];else{const Xi=lf(st,e,n,h,Re,$n,an,"center",wi,yn,mt,Na.horizontal,!1,pt,et);Xi&&(Ye.horizontal[wi]=Xi,ni=1===Xi.positionedLines.length)}}_i("left")}else{if("auto"===kn&&(kn=mf(vn)),ln||L.get("text-writing-mode").indexOf("horizontal")>=0||!u(mn)){const Wn=lf(st,e,n,h,Re,$n,an,vn,kn,yn,mt,Na.horizontal,!1,pt,et);Wn&&(Ye.horizontal[kn]=Wn)}_i(ln?"left":kn)}}let Qt=!1;if(ue.icon&&ue.icon.name){const mn=s[ue.icon.name];mn&&(Ct=ig(h[ue.icon.name],L.get("icon-offset").evaluate(ue,{},T),L.get("icon-anchor").evaluate(ue,{},T)),Qt=mn.sdf,void 0===t.sdfIcons?t.sdfIcons=mn.sdf:t.sdfIcons!==mn.sdf&&bn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mn.pixelRatio!==t.pixelRatio||0!==L.get("icon-rotate").constantOr(1))&&(t.iconsNeedLinear=!0))}const Xt=hg(Ye.horizontal)||Ye.vertical;t.iconsInText||(t.iconsInText=!!Xt&&Xt.iconsInText),(Xt||Ct)&&W_(t,ue,Ye,Ct,s,$,pt,0,mt,Qt,x,T,A)}_&&t.generateCollisionDebugBuffers(I,t.collisionBoxArray)}function mf(t){switch(t){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function W_(t,e,n,s,h,_,x,T,I,A,L,N,$){let J=_.textMaxSize.evaluate(e,{},N);void 0===J&&(J=x);const ee=t.layers[0].layout,ue=ee.get("icon-offset").evaluate(e,{},N),Re=hg(n.horizontal)||n.vertical,et="globe"===$.name,pt=x/24,Ye=t.tilePixelRatio*J/24,st=(yn=t.overscaling,t.zoom>18&&yn>2&&(yn>>=1),Math.max(Ei/(512*yn),1)*ee.get("symbol-spacing")),Ct=ee.get("text-padding")*t.tilePixelRatio,mt=ee.get("icon-padding")*t.tilePixelRatio,Qt=ge(ee.get("text-max-angle")),Xt="map"===ee.get("text-rotation-alignment")&&"point"!==ee.get("symbol-placement"),mn="map"===ee.get("icon-rotation-alignment")&&"point"!==ee.get("symbol-placement"),Fn=ee.get("symbol-placement"),an=st/2;var yn;const vn=ee.get("icon-text-fit");let Pn;s&&"none"!==vn&&(t.allowVerticalPlacement&&n.vertical&&(Pn=uf(s,n.vertical,vn,ee.get("icon-text-fit-padding"),ue,pt)),Re&&(s=uf(s,Re,vn,ee.get("icon-text-fit-padding"),ue,pt)));const kn=(ln,$n,_i)=>{if($n.x<0||$n.x>=Ei||$n.y<0||$n.y>=Ei)return;let Wn=null;if(et){const{x:ni,y:Zn,z:wi}=$.projectTilePoint($n.x,$n.y,_i);Wn={anchor:new xl(ni,Zn,wi,0,void 0),up:$.upVector(_i,$n.x,$n.y)}}!function(ni,Zn,wi,Xi,Wi,Zi,Ti,Sr,Pi,nr,Lr,qr,Zr,Yr,Jr,po,us,Ar,Po,Io,fr,oo,No,Fr,wo){const Es=ni.addToLineVertexArray(Zn,Xi);let qo,Yo,Vs,Jo,Zl,Pu,ad,ld=0,Vf=0,jf=0,Jc=0,$f=-1,Zf=-1;const aa={};let ty=du("");const wc=wi?wi.anchor:Zn;let Cg=0,rp=0;if(void 0===Pi._unevaluatedLayout.getValue("text-radial-offset")?[Cg,rp]=Pi.layout.get("text-offset").evaluate(fr,{},wo).map(Ea=>Ea*ls):(Cg=Pi.layout.get("text-radial-offset").evaluate(fr,{},wo)*ls,rp=ff),ni.allowVerticalPlacement&&Wi.vertical){const Ea=Wi.vertical;if(Jr)Pu=Wh(Ea),Sr&&(ad=Wh(Sr));else{const Da=Pi.layout.get("text-rotate").evaluate(fr,{},wo)+90;Vs=_f(nr,wc,Zn,Lr,qr,Zr,Ea,Yr,Da,po),Sr&&(Jo=_f(nr,wc,Zn,Lr,qr,Zr,Sr,Ar,Da))}}if(Zi){const Ea=Pi.layout.get("icon-rotate").evaluate(fr,{},wo),Da="none"!==Pi.layout.get("icon-text-fit"),ih=lg(Zi,Ea,No,Da),Xc=Sr?lg(Sr,Ea,No,Da):void 0;Yo=_f(nr,wc,Zn,Lr,qr,Zr,Zi,Ar,Ea),ld=4*ih.length;const Eg=ni.iconSizeData;let Gl=null;"source"===Eg.kind?(Gl=[tl*Pi.layout.get("icon-size").evaluate(fr,{},wo)],Gl[0]>fc&&bn(`${ni.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)):"composite"===Eg.kind&&(Gl=[tl*oo.compositeIconSizes[0].evaluate(fr,{},wo),tl*oo.compositeIconSizes[1].evaluate(fr,{},wo)],(Gl[0]>fc||Gl[1]>fc)&&bn(`${ni.layerIds[0]}: Value for "icon-size" is >= 255. Reduce your "icon-size".`)),ni.addSymbols(ni.icon,ih,Gl,Io,Po,fr,!1,wi,Zn,Es.lineStartIndex,Es.lineLength,-1,Fr,wo),$f=ni.icon.placedSymbolArray.length-1,Xc&&(Vf=4*Xc.length,ni.addSymbols(ni.icon,Xc,Gl,Io,Po,fr,Na.vertical,wi,Zn,Es.lineStartIndex,Es.lineLength,-1,Fr,wo),Zf=ni.icon.placedSymbolArray.length-1)}for(const Ea in Wi.horizontal){const Da=Wi.horizontal[Ea];qo||(ty=du(Da.text),Jr?Zl=Wh(Da):qo=_f(nr,wc,Zn,Lr,qr,Zr,Da,Yr,Pi.layout.get("text-rotate").evaluate(fr,{},wo),po));const ih=1===Da.positionedLines.length;if(jf+=gf(ni,wi,Zn,Da,Ti,Pi,Jr,fr,po,Es,Wi.vertical?Na.horizontal:Na.horizontalOnly,ih?Object.keys(Wi.horizontal):[Ea],aa,$f,oo,Fr,wo),ih)break}Wi.vertical&&(Jc+=gf(ni,wi,Zn,Wi.vertical,Ti,Pi,Jr,fr,po,Es,Na.vertical,["vertical"],aa,Zf,oo,Fr,wo));let Cc=-1;const Tg=(Ea,Da)=>Ea?Math.max(Ea,Da):Da;Cc=Tg(Zl,Cc),Cc=Tg(Pu,Cc),Cc=Tg(ad,Cc);const Ri=Cc>-1?1:0;ni.glyphOffsetArray.length>=qc.MAX_GLYPHS&&bn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==fr.sortKey&&ni.addToSortKeyRanges(ni.symbolInstances.length,fr.sortKey),ni.symbolInstances.emplaceBack(wc.x,wc.y,wc.z,Zn.x,Zn.y,aa.right>=0?aa.right:-1,aa.center>=0?aa.center:-1,aa.left>=0?aa.left:-1,aa.vertical>=0?aa.vertical:-1,$f,Zf,ty,void 0!==qo?qo:ni.collisionBoxArray.length,void 0!==qo?qo+1:ni.collisionBoxArray.length,void 0!==Vs?Vs:ni.collisionBoxArray.length,void 0!==Vs?Vs+1:ni.collisionBoxArray.length,void 0!==Yo?Yo:ni.collisionBoxArray.length,void 0!==Yo?Yo+1:ni.collisionBoxArray.length,Jo||ni.collisionBoxArray.length,Jo?Jo+1:ni.collisionBoxArray.length,Lr,jf,Jc,ld,Vf,Ri,0,Cg,rp,Cc)}(t,$n,Wn,ln,n,s,h,Pn,t.layers[0],t.collisionBoxArray,e.index,e.sourceLayerIndex,t.index,Ct,Xt,I,0,mt,mn,ue,e,_,A,L,N)};if("line"===Fn)for(const ln of og(e.geometry,0,0,Ei,Ei)){const $n=rg(ln,st,Qt,n.vertical||Re,s,24,Ye,t.overscaling,Ei);for(const _i of $n)Re&&Vy(t,Re.text,an,_i)||kn(ln,_i,N)}else if("line-center"===Fn){for(const ln of e.geometry)if(ln.length>1){const $n=j_(ln,Qt,n.vertical||Re,s,24,Ye);$n&&kn(ln,$n,N)}}else if("Polygon"===e.type)for(const ln of Ba(e.geometry,0)){const $n=Z_(ln,16);kn(ln[0],new xl($n.x,$n.y,0,0,void 0),N)}else if("LineString"===e.type)for(const ln of e.geometry)kn(ln,new xl(ln[0].x,ln[0].y,0,0,void 0),N);else if("Point"===e.type)for(const ln of e.geometry)for(const $n of ln)kn([$n],new xl($n.x,$n.y,0,0,void 0),N)}const fc=32640;function gf(t,e,n,s,h,_,x,T,I,A,L,N,$,J,ee,ue,Re){const et=function(st,Ct,mt,Qt,Xt,mn,Fn,an){const yn=[];if(0===Ct.positionedLines.length)return yn;const vn=Qt.layout.get("text-rotate").evaluate(mn,{})*Math.PI/180,Pn=function(Wn){const ni=Wn[0],Zn=Wn[1],wi=ni*Zn;return wi>0?[ni,-Zn]:wi<0?[-ni,Zn]:0===ni?[Zn,ni]:[Zn,-ni]}(mt);let kn=Math.abs(Ct.top-Ct.bottom);for(const Wn of Ct.positionedLines)kn-=Wn.lineOffset;const ln=Ct.positionedLines.length,$n=kn/ln;let _i=Ct.top-mt[1];for(let Wn=0;Wn<ln;++Wn){const ni=Ct.positionedLines[Wn];_i=$_(Ct,$n,_i,Wn);for(const Zn of ni.positionedGlyphs){if(!Zn.rect)continue;const wi=Zn.rect||{};let Xi=4,Wi=!0,Zi=1,Ti=0;if(Zn.imageName){const Fr=Fn[Zn.imageName];if(!Fr)continue;if(Fr.sdf){bn("SDF images are not supported in formatted text and will be ignored.");continue}Wi=!1,Zi=Fr.pixelRatio,Xi=1/Zi}const Sr=(Xt||an)&&Zn.vertical,Pi=Zn.metrics.advance*Zn.scale/2,nr=Zn.metrics,Lr=Zn.rect;if(null===Lr)continue;an&&Ct.verticalizable&&(Ti=Zn.imageName?Pi-Zn.metrics.width*Zn.scale/2:0);const qr=Xt?[Zn.x+Pi,Zn.y]:[0,0];let Zr=[0,0],Yr=[0,0],Jr=!1;Xt||(Sr?(Yr=[Zn.x+Pi+Pn[0],Zn.y+Pn[1]-Ti],Jr=!0):Zr=[Zn.x+Pi+mt[0],Zn.y+mt[1]-Ti]);const po=Lr.w*Zn.scale/(Zi*(Zn.localGlyph?2:1)),us=Lr.h*Zn.scale/(Zi*(Zn.localGlyph?2:1));let Ar,Po,Io,fr;if(Sr){const Fr=Zn.y-_i,wo=new ne(-Pi,Pi-Fr),Es=-Math.PI/2,qo=new ne(...Yr);Ar=new ne(-Pi+Zr[0],Zr[1]),Ar._rotateAround(Es,wo)._add(qo),Ar.x+=-Fr+Pi,Ar.y-=(nr.left-Xi)*Zn.scale;const Yo=Zn.imageName?nr.advance*Zn.scale:ls*Zn.scale,Vs=String.fromCharCode(Zn.glyph);Xm(Vs)?Ar.x+=(1-Xi)*Zn.scale:O_(Vs)?Ar.x+=Yo-nr.height*Zn.scale+(-Xi-1)*Zn.scale:Ar.x+=Zn.imageName||nr.width+2*Xi===Lr.w&&nr.height+2*Xi===Lr.h?(Yo-us)/2:(Yo-(nr.height+2*Xi)*Zn.scale)/2,Po=new ne(Ar.x,Ar.y-po),Io=new ne(Ar.x+us,Ar.y),fr=new ne(Ar.x+us,Ar.y-po)}else{const Fr=(nr.left-Xi)*Zn.scale-Pi+Zr[0],wo=(-nr.top-Xi)*Zn.scale+Zr[1],Es=Fr+po,qo=wo+us;Ar=new ne(Fr,wo),Po=new ne(Es,wo),Io=new ne(Fr,qo),fr=new ne(Es,qo)}if(vn){let Fr;Fr=Xt?new ne(0,0):Jr?new ne(Pn[0],Pn[1]):new ne(mt[0],mt[1]),Ar._rotateAround(vn,Fr),Po._rotateAround(vn,Fr),Io._rotateAround(vn,Fr),fr._rotateAround(vn,Fr)}const oo=new ne(0,0),No=new ne(0,0);yn.push({tl:Ar,tr:Po,bl:Io,br:fr,tex:wi,writingMode:Ct.writingMode,glyphOffset:qr,sectionIndex:Zn.sectionIndex,isSDF:Wi,pixelOffsetTL:oo,pixelOffsetBR:No,minFontScaleX:0,minFontScaleY:0})}}return yn}(0,s,I,_,x,T,h,t.allowVerticalPlacement),pt=t.textSizeData;let Ye=null;"source"===pt.kind?(Ye=[tl*_.layout.get("text-size").evaluate(T,{},Re)],Ye[0]>fc&&bn(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)):"composite"===pt.kind&&(Ye=[tl*ee.compositeTextSizes[0].evaluate(T,{},Re),tl*ee.compositeTextSizes[1].evaluate(T,{},Re)],(Ye[0]>fc||Ye[1]>fc)&&bn(`${t.layerIds[0]}: Value for "text-size" is >= 255. Reduce your "text-size".`)),t.addSymbols(t.text,et,Ye,I,x,T,L,e,n,A.lineStartIndex,A.lineLength,J,ue,Re);for(const st of N)$[st]=t.text.placedSymbolArray.length-1;return 4*et.length}function hg(t){for(const e in t)return t[e];return null}function _f(t,e,n,s,h,_,x,T,I,A){let L=x.top,N=x.bottom,$=x.left,J=x.right;const ee=x.collisionPadding;if(ee&&($-=ee[0],L-=ee[1],J+=ee[2],N+=ee[3]),I){const ue=new ne($,L),Re=new ne(J,L),et=new ne($,N),pt=new ne(J,N),Ye=ge(I);let st=new ne(0,0);A&&(st=new ne(A[0],A[1])),ue._rotateAround(Ye,st),Re._rotateAround(Ye,st),et._rotateAround(Ye,st),pt._rotateAround(Ye,st),$=Math.min(ue.x,Re.x,et.x,pt.x),J=Math.max(ue.x,Re.x,et.x,pt.x),L=Math.min(ue.y,Re.y,et.y,pt.y),N=Math.max(ue.y,Re.y,et.y,pt.y)}return t.emplaceBack(e.x,e.y,e.z,n.x,n.y,$,L,J,N,T,s,h,_),t.length-1}function Wh(t){t.collisionPadding&&(t.top-=t.collisionPadding[1],t.bottom+=t.collisionPadding[3]);const e=t.bottom-t.top;return e>0?Math.max(10,e):null}function Vy(t,e,n,s){const h=t.compareText;if(e in h){const _=h[e];for(let x=_.length-1;x>=0;x--)if(s.dist(_[x])<n)return!0}else h[e]=[];return h[e].push(s),!1}function qd(t,e){const n=t.fovAboveCenter,s=t.elevation?t.elevation.getMinElevationBelowMSL()*e:0,h=(t._camera.position[2]*t.worldSize-s)/Math.cos(t._pitch),_=Math.sin(n)*h/Math.sin(Math.max(Math.PI/2-t._pitch-n,.01)),x=Math.sin(t._pitch)*_+h;return Math.min(1.01*x,h*(1/t._horizonShift))}function Eu(t,e){if(!e.isReprojectedInTileSpace)return{scale:1<<t.z,x:t.x,y:t.y,x2:t.x+1,y2:t.y+1,projection:e};const n=Math.pow(2,-t.z),s=t.x*n,h=(t.x+1)*n,_=t.y*n,x=(t.y+1)*n,T=ka(s),I=ka(h),A=Cs(_),L=Cs(x),N=e.project(T,A),$=e.project(I,A),J=e.project(I,L),ee=e.project(T,L);let ue=Math.min(N.x,$.x,J.x,ee.x),Re=Math.min(N.y,$.y,J.y,ee.y),et=Math.max(N.x,$.x,J.x,ee.x),pt=Math.max(N.y,$.y,J.y,ee.y);const Ye=n/16;function st(mt,Qt,Xt,mn,Fn,an){const yn=(Xt+Fn)/2,vn=(mn+an)/2,Pn=e.project(ka(yn),Cs(vn)),kn=Math.max(0,ue-Pn.x,Re-Pn.y,Pn.x-et,Pn.y-pt);ue=Math.min(ue,Pn.x),et=Math.max(et,Pn.x),Re=Math.min(Re,Pn.y),pt=Math.max(pt,Pn.y),kn>Ye&&(st(mt,Pn,Xt,mn,yn,vn),st(Pn,Qt,yn,vn,Fn,an))}st(N,$,s,_,h,_),st($,J,h,_,h,x),st(J,ee,h,x,s,x),st(ee,N,s,x,s,_),ue-=Ye,Re-=Ye,et+=Ye,pt+=Ye;const Ct=1/Math.max(et-ue,pt-Re);return{scale:Ct,x:ue*Ct,y:Re*Ct,x2:et*Ct,y2:pt*Ct,projection:e}}const q_=ba(new Float32Array(16));class jl{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,n){return{x:0,y:0,z:0}}unproject(e,n){return new ur(0,0)}projectTilePoint(e,n,s){return{x:e,y:n,z:0}}locationPoint(e,n,s=!0){return e._coordinatePoint(e.locationCoordinate(n),s)}pixelsPerMeter(e,n){return vl(1,e)*n}pixelSpaceConversion(e,n,s){return 1}farthestPixelDistance(e){return qd(e,e.pixelsPerMeter)}pointCoordinate(e,n,s,h){const _=e.horizonLineFromTop(!1),x=new ne(n,Math.max(_,s));return e.rayIntersectionCoordinate(e.pointRayIntersection(x,h))}pointCoordinate3D(e,n,s){const h=new ne(n,s);if(e.elevation)return e.elevation.pointCoordinate(h);{const _=this.pointCoordinate(e,h.x,h.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(e,n){if(e.elevation)return!this.pointCoordinate3D(e,n.x,n.y);const s=e.horizonLineFromTop();return n.y<s}createInversionMatrix(e,n){return q_}createTileMatrix(e,n,s){let h,_,x;const T=s.canonical,I=ba(new Float64Array(16));if(this.isReprojectedInTileSpace){const A=Eu(T,this);h=1,_=A.x+s.wrap*A.scale,x=A.y,zc(I,I,[h/A.scale,h/A.scale,e.pixelsPerMeter/n])}else h=n/e.zoomScale(T.z),_=(T.x+Math.pow(2,T.z)*s.wrap)*h,x=T.y*h;return Bu(I,I,[_,x,0]),zc(I,I,[h/Ei,h/Ei,1]),I}upVector(e,n,s){return[0,0,1]}upVectorScale(e,n,s){return{metersToTile:1}}}class Y_ extends jl{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[n,s]=this.parallels=e.parallels||[29.5,45.5],h=Math.sin(ge(n));this.n=(h+Math.sin(ge(s)))/2,this.c=1+h*(2*this.n-h),this.r0=Math.sqrt(this.c)/this.n}project(e,n){const{n:s,c:h,r0:_}=this,x=ge(e-this.center[0]),T=ge(n),I=Math.sqrt(h-2*s*Math.sin(T))/s;return{x:I*Math.sin(x*s),y:I*Math.cos(x*s)-_,z:0}}unproject(e,n){const{n:s,c:h,r0:_}=this,x=_+n;let T=Math.atan2(e,Math.abs(x))*Math.sign(x);x*s<0&&(T-=Math.PI*Math.sign(e)*Math.sign(x));const I=ge(this.center[0])*s;T=se(T,-Math.PI-I,Math.PI-I);const A=me(ke(T/s)+this.center[0],-180,180),L=Math.asin(me((h-(e*e+x*x)*s*s)/(2*s),-1,1)),N=me(ke(L),-as,as);return new ur(A,N)}}const Ta=1.340264,mc=-.081106,Wo=893e-6,bl=.003796,Du=Math.sqrt(3)/2;class nl extends jl{project(e,n){n=n/180*Math.PI,e=e/180*Math.PI;const s=Math.asin(Du*Math.sin(n)),h=s*s,_=h*h*h;return{x:.5*(e*Math.cos(s)/(Du*(Ta+3*mc*h+_*(7*Wo+9*bl*h)))/Math.PI+.5),y:1-.5*(s*(Ta+mc*h+_*(Wo+bl*h))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let s=n=(2*(1-n)-1)*Math.PI,h=s*s,_=h*h*h;for(let L,N,$,J=0;J<12&&(N=s*(Ta+mc*h+_*(Wo+bl*h))-n,$=Ta+3*mc*h+_*(7*Wo+9*bl*h),L=N/$,s=me(s-L,-Math.PI/3,Math.PI/3),h=s*s,_=h*h*h,!(Math.abs(L)<1e-12));++J);const x=Du*e*(Ta+3*mc*h+_*(7*Wo+9*bl*h))/Math.cos(s),T=Math.asin(Math.sin(s)/Du),I=me(180*x/Math.PI,-180,180),A=me(180*T/Math.PI,-as,as);return new ur(I,A)}}class yf extends jl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){return{x:.5+e/360,y:.5-n/360,z:0}}unproject(e,n){const s=360*(e-.5),h=me(360*(.5-n),-as,as);return new ur(s,h)}}const wl=Math.PI/2;function gc(t){return Math.tan((wl+t)/2)}class id extends jl{constructor(e){super(e),this.center=e.center||[0,30];const[n,s]=this.parallels=e.parallels||[30,30];let h=ge(n),_=ge(s);this.southernCenter=h+_<0,this.southernCenter&&(h=-h,_=-_);const x=Math.cos(h),T=gc(h);this.n=h===_?Math.sin(h):Math.log(x/Math.cos(_))/Math.log(gc(_)/T),this.f=x*Math.pow(gc(h),this.n)/this.n}project(e,n){n=ge(n),this.southernCenter&&(n=-n),e=ge(e-this.center[0]);const s=1e-6,{n:h,f:_}=this;_>0?n<-wl+s&&(n=-wl+s):n>wl-s&&(n=wl-s);const x=_/Math.pow(gc(n),h);let T=x*Math.sin(h*e),I=_-x*Math.cos(h*e);return T=.5*(T/Math.PI+.5),I=.5*(I/Math.PI+.5),{x:T,y:this.southernCenter?I:1-I,z:0}}unproject(e,n){e=(2*e-.5)*Math.PI,this.southernCenter&&(n=1-n),n=(2*(1-n)-.5)*Math.PI;const{n:s,f:h}=this,_=h-n,x=Math.sign(_),T=Math.sign(s)*Math.sqrt(e*e+_*_);let I=Math.atan2(e,Math.abs(_))*x;_*s<0&&(I-=Math.PI*Math.sign(e)*x);const A=me(ke(I/s)+this.center[0],-180,180),L=me(ke(2*Math.atan(Math.pow(h/T,1/s))-wl),-as,as);return new ur(A,this.southernCenter?-L:L)}}class Iu extends jl{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,n){return{x:el(e),y:yl(n),z:0}}unproject(e,n){const s=ka(e),h=Cs(n);return new ur(s,h)}}const Mu=ge(as);class rd extends jl{project(e,n){const s=(n=ge(n))*n,h=s*s;return{x:.5*((e=ge(e))*(.8707-.131979*s+h*(h*(.003971*s-.001529*h)-.013791))/Math.PI+.5),y:1-.5*(n*(1.007226+s*(.015085+h*(.028874*s-.044475-.005916*h)))/Math.PI+1),z:0}}unproject(e,n){e=(2*e-.5)*Math.PI;let s=n=(2*(1-n)-1)*Math.PI,h=25,_=0,x=s*s;do{x=s*s;const A=x*x;_=(s*(1.007226+x*(.015085+A*(.028874*x-.044475-.005916*A)))-n)/(1.007226+x*(.045255+A*(.259866*x-.311325-.005916*11*A))),s=me(s-_,-Mu,Mu)}while(Math.abs(_)>1e-6&&--h>0);x=s*s;const T=me(ke(e/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),I=ke(s);return new ur(T,I)}}const Su=ge(as);class od extends jl{project(e,n){n=ge(n),e=ge(e);const s=Math.cos(n),h=2/Math.PI,_=Math.acos(s*Math.cos(e/2)),x=Math.sin(_)/_,T=.5*(e*h+2*s*Math.sin(e/2)/x)||0,I=.5*(n+Math.sin(n)/x)||0;return{x:.5*(T/Math.PI+.5),y:1-.5*(I/Math.PI+1),z:0}}unproject(e,n){let s=e=(2*e-.5)*Math.PI,h=n=(2*(1-n)-1)*Math.PI,_=25;const x=1e-6;let T=0,I=0;do{const A=Math.cos(h),L=Math.sin(h),N=2*L*A,$=L*L,J=A*A,ee=Math.cos(s/2),ue=Math.sin(s/2),Re=2*ee*ue,et=ue*ue,pt=1-J*ee*ee,Ye=pt?1/pt:0,st=pt?Math.acos(A*ee)*Math.sqrt(1/pt):0,Ct=.5*(2*st*A*ue+2*s/Math.PI)-e,mt=.5*(st*L+h)-n,Qt=.5*Ye*(J*et+st*A*ee*$)+1/Math.PI,Xt=Ye*(Re*N/4-st*L*ue),mn=.125*Ye*(N*ue-st*L*J*Re),Fn=.5*Ye*($*ee+st*et*A)+.5,an=Xt*mn-Fn*Qt;T=(mt*Xt-Ct*Fn)/an,I=(Ct*mn-mt*Qt)/an,s=me(s-T,-Math.PI,Math.PI),h=me(h-I,-Su,Su)}while((Math.abs(T)>x||Math.abs(I)>x)&&--_>0);return new ur(ke(s),ke(h))}}class Au extends jl{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(ge(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,n){const{scale:s,cosPhi:h}=this;return{x:ge(e)*h*s+.5,y:-Math.sin(ge(n))/h*s+.5,z:0}}unproject(e,n){const{scale:s,cosPhi:h}=this,_=-(n-.5)/s,x=me(ke((e-.5)/s)/h,-180,180),T=Math.asin(me(_*h,-1,1)),I=me(ke(T),-as,as);return new ur(x,I)}}class pg extends Iu{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,n,s){const h=_u(e,n,s);return bo(h,h,Uu(ws(s))),{x:h[0],y:h[1],z:h[2]}}locationPoint(e,n){const s=Vc(n.lat,n.lng),h=ss([],s),_=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(n),e._centerAltitude):e._centerAltitude;Nu(s,s,h,vl(1,0)*Ei*_);const x=ba(new Float64Array(16));return Nc(x,e.pixelMatrix,e.globeMatrix),bo(s,s,x),new ne(s[0],s[1])}pixelsPerMeter(e,n){return vl(1,0)*n}pixelSpaceConversion(e,n,s){const h=vl(1,e)*n,_=vi(vl(1,45)*n,h,s);return this.pixelsPerMeter(e,n)/_}createTileMatrix(e,n,s){const h=Dp(ws(s.canonical));return Nc(new Float64Array(16),e.globeMatrix,h)}createInversionMatrix(e,n){const{center:s}=e,h=Uu(ws(n));return gd(h,h,ge(s.lng)),md(h,h,ge(s.lat)),zc(h,h,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(h)}pointCoordinate(e,n,s,h){return vm(e,n,s,!0)||new Md(0,0)}pointCoordinate3D(e,n,s){const h=this.pointCoordinate(e,n,s,0);return[h.x,h.y,h.z]}isPointAboveHorizon(e,n){return!vm(e,n.x,n.y,!1)}farthestPixelDistance(e){const n=function(h,_){const x=h.cameraToCenterDistance,T=h._centerAltitude*_,I=h._camera,A=h._camera.forward(),L=sc([],wa([],A,-x),[0,0,T]),N=h.worldSize/(2*Math.PI),$=[0,0,-N],J=h.width/h.height,ee=Math.tan(h.fovAboveCenter),ue=wa([],I.up(),ee),Re=wa([],I.right(),ee*J),et=ss([],sc([],sc([],A,ue),Re)),pt=[];let Ye;if(new kl(L,et).closestPointOnSphere($,N,pt)){const st=sc([],pt,$),Ct=ml([],st,L);Ye=Math.cos(h.fovAboveCenter)*mu(Ct)}else{const st=ml([],L,$),Ct=ml([],$,L);ss(Ct,Ct);const mt=mu(st)-N;Ye=Math.sqrt(mt*(mt+2*N));const Qt=Math.acos(Ye/(N+mt))-Math.acos(Ca(A,Ct));Ye*=Math.cos(Qt)}return 1.01*Ye}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),s=Vu(e.zoom);if(s>0){const h=qd(e,vl(1,e.center.lat)*e.worldSize),_=e.worldSize/(2*Math.PI),x=Math.max(e.width,e.height)/e.worldSize*Math.PI;return vi(n,h+_*(1-Math.cos(x)),Math.pow(s,10))}return n}upVector(e,n,s){return _u(n,s,e,1)}upVectorScale(e){return{metersToTile:gh(Ep(ws(e)))}}}function vf(t){const e=t.parallels,n=!!e&&Math.abs(e[0]+e[1])<.01;switch(t.name){case"mercator":return new Iu(t);case"equirectangular":return new yf(t);case"naturalEarth":return new rd(t);case"equalEarth":return new nl(t);case"winkelTripel":return new od(t);case"albers":return n?new Au(t):new Y_(t);case"lambertConformalConic":return n?new Au(t):new id(t);case"globe":return new pg(t)}throw new Error(`Invalid projection name: ${t.name}`)}const fg=Bd.types,mg=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Yd(t,e,n,s,h,_,x,T,I,A,L,N,$){const J=T?Math.min(fc,Math.round(T[0])):0,ee=T?Math.min(fc,Math.round(T[1])):0;t.emplaceBack(e,n,Math.round(32*s),Math.round(32*h),_,x,(J<<1)+(I?1:0),ee,16*A,16*L,256*N,256*$)}function Jd(t,e,n,s,h,_,x){t.emplaceBack(e,n,s,h,_,x)}function Xd(t,e,n,s,h){t.emplaceBack(e,n,s,h),t.emplaceBack(e,n,s,h),t.emplaceBack(e,n,s,h),t.emplaceBack(e,n,s,h)}function gg(t){for(const e of t.sections)if(V(e.text))return!0;return!1}class qh{constructor(e){this.layoutVertexArray=new Ll,this.indexArray=new os,this.programConfigurations=e,this.segments=new xo,this.dynamicLayoutVertexArray=new Vr,this.opacityVertexArray=new jr,this.placedSymbolArray=new tm,this.globeExtVertexArray=new to}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,n,s,h){this.isEmpty()||(s&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,A_.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,n),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Yu.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,mg,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Lh.members,!0)),this.opacityVertexBuffer.itemSize=1),(s||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Kn(qh,"SymbolBuffers");class xf{constructor(e,n,s){this.layoutVertexArray=new e,this.layoutAttributes=n,this.indexArray=new s,this.segments=new xo,this.collisionVertexArray=new Nr,this.collisionVertexArrayExt=new rs}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Kp.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,Ud.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Kn(xf,"CollisionBuffers");class qc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(x=>x.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ba([]),this.placementViewportMatrix=ba([]);const n=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Vd(this.zoom,n["text-size"]),this.iconSizeData=Vd(this.zoom,n["icon-size"]);const s=this.layers[0].layout,h=s.get("symbol-sort-key"),_=s.get("symbol-z-order");this.canOverlap=s.get("text-allow-overlap")||s.get("icon-allow-overlap")||s.get("text-ignore-placement")||s.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&void 0!==h.constantOr(1),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=s.get("text-writing-mode").map(x=>Na[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new qh(new fu(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new qh(new fu(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ah,this.lineVertexArray=new up,this.symbolInstances=new ia}calculateGlyphDependencies(e,n,s,h,_){for(let x=0;x<e.length;x++)if(n[e.charCodeAt(x)]=!0,h&&_){const T=jd[e.charAt(x)];T&&(n[T.charCodeAt(0)]=!0)}}populate(e,n,s,h){const _=this.layers[0],x=_.layout,T="globe"===this.projection.name,I=x.get("text-font"),A=x.get("text-field"),L=x.get("icon-image"),N=("constant"!==A.value.kind||A.value.value instanceof io&&!A.value.value.isEmpty()||A.value.value.toString().length>0)&&("constant"!==I.value.kind||I.value.value.length>0),$="constant"!==L.value.kind||!!L.value.value||Object.keys(L.parameters).length>0,J=x.get("symbol-sort-key");if(this.features=[],!N&&!$)return;const ee=n.iconDependencies,ue=n.glyphDependencies,Re=n.availableImages,et=new Zt(this.zoom);for(const{feature:pt,id:Ye,index:st,sourceLayerIndex:Ct}of e){const mt=_._featureFilter.needGeometry,Qt=jc(pt,mt);if(!_._featureFilter.filter(et,Qt,s))continue;if(mt||(Qt.geometry=Bl(pt,s,h)),T&&1!==pt.type&&s.z<=5){const an=Qt.geometry,yn=.98078528056,vn=(Pn,kn)=>Ca(_u(Pn.x,Pn.y,s,1),_u(kn.x,kn.y,s,1))<yn;for(let Pn=0;Pn<an.length;Pn++)an[Pn]=Em(an[Pn],vn)}let Xt,mn;if(N){const an=_.getValueAndResolveTokens("text-field",Qt,s,Re),yn=io.factory(an);gg(yn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===Tt()||this.hasRTLText&&At.isParsed())&&(Xt=P_(yn,_,Qt))}if($){const an=_.getValueAndResolveTokens("icon-image",Qt,s,Re);mn=an instanceof ro?an:ro.fromString(an)}if(!Xt&&!mn)continue;const Fn=this.sortFeaturesByKey?J.evaluate(Qt,{},s):void 0;if(this.features.push({id:Ye,text:Xt,icon:mn,index:st,sourceLayerIndex:Ct,geometry:Qt.geometry,properties:pt.properties,type:fg[pt.type],sortKey:Fn}),mn&&(ee[mn.name]=!0),Xt){const an=I.evaluate(Qt,{},s).join(","),yn="map"===x.get("text-rotation-alignment")&&"point"!==x.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Na.vertical)>=0;for(const vn of Xt.sections)if(vn.image)ee[vn.image.name]=!0;else{const Pn=u(Xt.toString()),kn=vn.fontStack||an,ln=ue[kn]=ue[kn]||{};this.calculateGlyphDependencies(vn.text,ln,yn,this.allowVerticalPlacement,Pn)}}}"line"===x.get("symbol-placement")&&(this.features=function(pt){const Ye={},st={},Ct=[];let mt=0;function Qt(an){Ct.push(pt[an]),mt++}function Xt(an,yn,vn){const Pn=st[an];return delete st[an],st[yn]=Pn,Ct[Pn].geometry[0].pop(),Ct[Pn].geometry[0]=Ct[Pn].geometry[0].concat(vn[0]),Pn}function mn(an,yn,vn){const Pn=Ye[yn];return delete Ye[yn],Ye[an]=Pn,Ct[Pn].geometry[0].shift(),Ct[Pn].geometry[0]=vn[0].concat(Ct[Pn].geometry[0]),Pn}function Fn(an,yn,vn){const Pn=vn?yn[0][yn[0].length-1]:yn[0][0];return`${an}:${Pn.x}:${Pn.y}`}for(let an=0;an<pt.length;an++){const yn=pt[an],vn=yn.geometry,Pn=yn.text?yn.text.toString():null;if(!Pn){Qt(an);continue}const kn=Fn(Pn,vn),ln=Fn(Pn,vn,!0);if(kn in st&&ln in Ye&&st[kn]!==Ye[ln]){const $n=mn(kn,ln,vn),_i=Xt(kn,ln,Ct[$n].geometry);delete Ye[kn],delete st[ln],st[Fn(Pn,Ct[_i].geometry,!0)]=_i,Ct[$n].geometry=null}else kn in st?Xt(kn,ln,vn):ln in Ye?mn(kn,ln,vn):(Qt(an),Ye[kn]=mt-1,st[ln]=mt-1)}return Ct.filter(an=>an.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((pt,Ye)=>pt.sortKey-Ye.sortKey)}update(e,n,s,h){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,n,this.layers,s,h),this.icon.programConfigurations.updatePaintArrays(e,n,this.layers,s,h))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=vf(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,n){const s=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:h,y:_}of n)this.lineVertexArray.emplaceBack(h,_);return{lineStartIndex:s,lineLength:this.lineVertexArray.length-s}}addSymbols(e,n,s,h,_,x,T,I,A,L,N,$,J,ee){const ue=e.indexArray,Re=e.layoutVertexArray,et=e.globeExtVertexArray,pt=e.segments.prepareSegment(4*n.length,Re,ue,this.canOverlap?x.sortKey:void 0),Ye=this.glyphOffsetArray.length,st=pt.vertexLength,Ct=this.allowVerticalPlacement&&T===Na.vertical?Math.PI/2:0,mt=x.text&&x.text.sections;for(let Xt=0;Xt<n.length;Xt++){const{tl:mn,tr:Fn,bl:an,br:yn,tex:vn,pixelOffsetTL:Pn,pixelOffsetBR:kn,minFontScaleX:ln,minFontScaleY:$n,glyphOffset:_i,isSDF:Wn,sectionIndex:ni}=n[Xt],Zn=pt.vertexLength,wi=_i[1];if(Yd(Re,A.x,A.y,mn.x,wi+mn.y,vn.x,vn.y,s,Wn,Pn.x,Pn.y,ln,$n),Yd(Re,A.x,A.y,Fn.x,wi+Fn.y,vn.x+vn.w,vn.y,s,Wn,kn.x,Pn.y,ln,$n),Yd(Re,A.x,A.y,an.x,wi+an.y,vn.x,vn.y+vn.h,s,Wn,Pn.x,kn.y,ln,$n),Yd(Re,A.x,A.y,yn.x,wi+yn.y,vn.x+vn.w,vn.y+vn.h,s,Wn,kn.x,kn.y,ln,$n),I){const{x:Xi,y:Wi,z:Zi}=I.anchor,[Ti,Sr,Pi]=I.up;Jd(et,Xi,Wi,Zi,Ti,Sr,Pi),Jd(et,Xi,Wi,Zi,Ti,Sr,Pi),Jd(et,Xi,Wi,Zi,Ti,Sr,Pi),Jd(et,Xi,Wi,Zi,Ti,Sr,Pi),Xd(e.dynamicLayoutVertexArray,Xi,Wi,Zi,Ct)}else Xd(e.dynamicLayoutVertexArray,A.x,A.y,A.z,Ct);ue.emplaceBack(Zn,Zn+1,Zn+2),ue.emplaceBack(Zn+1,Zn+2,Zn+3),pt.vertexLength+=4,pt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(_i[0]),Xt!==n.length-1&&ni===n[Xt+1].sectionIndex||e.programConfigurations.populatePaintArrays(Re.length,x,x.index,{},J,ee,mt&&mt[ni])}const Qt=I?I.anchor:A;e.placedSymbolArray.emplaceBack(Qt.x,Qt.y,Qt.z,A.x,A.y,Ye,this.glyphOffsetArray.length-Ye,st,L,N,A.segment,s?s[0]:0,s?s[1]:0,h[0],h[1],T,0,!1,0,$,0)}_commitLayoutVertex(e,n,s,h,_,x,T){e.emplaceBack(n,s,h,_,x,Math.round(T.x),Math.round(T.y))}_addCollisionDebugVertices(e,n,s,h,_,x,T){const I=s.segments.prepareSegment(4,s.layoutVertexArray,s.indexArray),A=I.vertexLength,L=T.tileAnchorX,N=T.tileAnchorY;for(let J=0;J<4;J++)s.collisionVertexArray.emplaceBack(0,0,0,0);s.collisionVertexArrayExt.emplaceBack(n,-e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,-e.padding),s.collisionVertexArrayExt.emplaceBack(n,e.padding,e.padding),s.collisionVertexArrayExt.emplaceBack(n,-e.padding,e.padding),this._commitLayoutVertex(s.layoutVertexArray,h,_,x,L,N,new ne(e.x1,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,h,_,x,L,N,new ne(e.x2,e.y1)),this._commitLayoutVertex(s.layoutVertexArray,h,_,x,L,N,new ne(e.x2,e.y2)),this._commitLayoutVertex(s.layoutVertexArray,h,_,x,L,N,new ne(e.x1,e.y2)),I.vertexLength+=4;const $=s.indexArray;$.emplaceBack(A,A+1),$.emplaceBack(A+1,A+2),$.emplaceBack(A+2,A+3),$.emplaceBack(A+3,A),I.primitiveLength+=4}_addTextDebugCollisionBoxes(e,n,s,h,_,x){for(let T=h;T<_;T++){const I=s.get(T),A=this.getSymbolInstanceTextSize(e,x,n,T);this._addCollisionDebugVertices(I,A,this.textCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(e,n,s,h,_,x){for(let T=h;T<_;T++){const I=s.get(T),A=this.getSymbolInstanceIconSize(e,n,x.placedIconSymbolIndex);this._addCollisionDebugVertices(I,A,this.iconCollisionBox,I.projectedAnchorX,I.projectedAnchorY,I.projectedAnchorZ,x)}}generateCollisionDebugBuffers(e,n){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new xf(ho,Fh.members,fl),this.iconCollisionBox=new xf(ho,Fh.members,fl);const s=Tu(this.iconSizeData,e),h=Tu(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const x=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(h,e,n,x.textBoxStartIndex,x.textBoxEndIndex,x),this._addTextDebugCollisionBoxes(h,e,n,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._addIconDebugCollisionBoxes(s,e,n,x.iconBoxStartIndex,x.iconBoxEndIndex,x),this._addIconDebugCollisionBoxes(s,e,n,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x)}}getSymbolInstanceTextSize(e,n,s,h){const _=this.text.placedSymbolArray.get(n.rightJustifiedTextSymbolIndex>=0?n.rightJustifiedTextSymbolIndex:n.centerJustifiedTextSymbolIndex>=0?n.centerJustifiedTextSymbolIndex:n.leftJustifiedTextSymbolIndex>=0?n.leftJustifiedTextSymbolIndex:n.verticalPlacedTextSymbolIndex>=0?n.verticalPlacedTextSymbolIndex:h),x=Ju(this.textSizeData,e,_)/ls;return this.tilePixelRatio*x}getSymbolInstanceIconSize(e,n,s){const h=this.icon.placedSymbolArray.get(s),_=Ju(this.iconSizeData,e,h);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(e,n,s){e.emplaceBack(n,-s,-s),e.emplaceBack(n,s,-s),e.emplaceBack(n,s,s),e.emplaceBack(n,-s,s)}_updateTextDebugCollisionBoxes(e,n,s,h,_,x){for(let T=h;T<_;T++){const I=s.get(T),A=this.getSymbolInstanceTextSize(e,x,n,T);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,A,I.padding)}}_updateIconDebugCollisionBoxes(e,n,s,h,_,x){for(let T=h;T<_;T++){const I=s.get(T),A=this.getSymbolInstanceIconSize(e,n,x);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,A,I.padding)}}updateCollisionDebugBuffers(e,n){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const s=Tu(this.iconSizeData,e),h=Tu(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const x=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(h,e,n,x.textBoxStartIndex,x.textBoxEndIndex,x),this._updateTextDebugCollisionBoxes(h,e,n,x.verticalTextBoxStartIndex,x.verticalTextBoxEndIndex,x),this._updateIconDebugCollisionBoxes(s,e,n,x.iconBoxStartIndex,x.iconBoxEndIndex,x.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(s,e,n,x.verticalIconBoxStartIndex,x.verticalIconBoxEndIndex,x.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,n,s,h,_,x,T,I,A){const L={};if(n<s){const{x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st,featureIndex:Ct}=e.get(n);L.textBox={x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st},L.textFeatureIndex=Ct}if(h<_){const{x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st,featureIndex:Ct}=e.get(h);L.verticalTextBox={x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st},L.verticalTextFeatureIndex=Ct}if(x<T){const{x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st,featureIndex:Ct}=e.get(x);L.iconBox={x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st},L.iconFeatureIndex=Ct}if(I<A){const{x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st,featureIndex:Ct}=e.get(I);L.verticalIconBox={x1:N,y1:$,x2:J,y2:ee,padding:ue,projectedAnchorX:Re,projectedAnchorY:et,projectedAnchorZ:pt,tileAnchorX:Ye,tileAnchorY:st},L.verticalIconFeatureIndex=Ct}return L}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let n=0;n<this.symbolInstances.length;n++){const s=this.symbolInstances.get(n);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,s.textBoxStartIndex,s.textBoxEndIndex,s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s.iconBoxStartIndex,s.iconBoxEndIndex,s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,n){const s=e.placedSymbolArray.get(n),h=s.vertexStartIndex+4*s.numGlyphs;for(let _=s.vertexStartIndex;_<h;_+=4)e.indexArray.emplaceBack(_,_+1,_+2),e.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const n=Math.sin(e),s=Math.cos(e),h=[],_=[],x=[];for(let T=0;T<this.symbolInstances.length;++T){x.push(T);const I=this.symbolInstances.get(T);h.push(0|Math.round(n*I.tileAnchorX+s*I.tileAnchorY)),_.push(I.featureIndex)}return x.sort((T,I)=>h[T]-h[I]||_[I]-_[T]),x}addToSortKeyRanges(e,n){const s=this.sortKeyRanges[this.sortKeyRanges.length-1];s&&s.sortKey===n?s.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:n,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const n of this.symbolInstanceIndexes){const s=this.symbolInstances.get(n);this.featureSortOrder.push(s.featureIndex);const{rightJustifiedTextSymbolIndex:h,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:T,placedIconSymbolIndex:I,verticalPlacedIconSymbolIndex:A}=s;h>=0&&this.addIndicesForPlacedSymbol(this.text,h),_>=0&&_!==h&&this.addIndicesForPlacedSymbol(this.text,_),x>=0&&x!==_&&x!==h&&this.addIndicesForPlacedSymbol(this.text,x),T>=0&&this.addIndicesForPlacedSymbol(this.text,T),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Kn(qc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),qc.MAX_GLYPHS=65535,qc.addDynamicAttributes=Xd;const _g=new On({"symbol-placement":new $t(Jt.layout_symbol["symbol-placement"]),"symbol-spacing":new $t(Jt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new $t(Jt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new on(Jt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new $t(Jt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new $t(Jt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new $t(Jt.layout_symbol["icon-ignore-placement"]),"icon-optional":new $t(Jt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new $t(Jt.layout_symbol["icon-rotation-alignment"]),"icon-size":new on(Jt.layout_symbol["icon-size"]),"icon-text-fit":new $t(Jt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new $t(Jt.layout_symbol["icon-text-fit-padding"]),"icon-image":new on(Jt.layout_symbol["icon-image"]),"icon-rotate":new on(Jt.layout_symbol["icon-rotate"]),"icon-padding":new $t(Jt.layout_symbol["icon-padding"]),"icon-keep-upright":new $t(Jt.layout_symbol["icon-keep-upright"]),"icon-offset":new on(Jt.layout_symbol["icon-offset"]),"icon-anchor":new on(Jt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new $t(Jt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new $t(Jt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new $t(Jt.layout_symbol["text-rotation-alignment"]),"text-field":new on(Jt.layout_symbol["text-field"]),"text-font":new on(Jt.layout_symbol["text-font"]),"text-size":new on(Jt.layout_symbol["text-size"]),"text-max-width":new on(Jt.layout_symbol["text-max-width"]),"text-line-height":new on(Jt.layout_symbol["text-line-height"]),"text-letter-spacing":new on(Jt.layout_symbol["text-letter-spacing"]),"text-justify":new on(Jt.layout_symbol["text-justify"]),"text-radial-offset":new on(Jt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new $t(Jt.layout_symbol["text-variable-anchor"]),"text-anchor":new on(Jt.layout_symbol["text-anchor"]),"text-max-angle":new $t(Jt.layout_symbol["text-max-angle"]),"text-writing-mode":new $t(Jt.layout_symbol["text-writing-mode"]),"text-rotate":new on(Jt.layout_symbol["text-rotate"]),"text-padding":new $t(Jt.layout_symbol["text-padding"]),"text-keep-upright":new $t(Jt.layout_symbol["text-keep-upright"]),"text-transform":new on(Jt.layout_symbol["text-transform"]),"text-offset":new on(Jt.layout_symbol["text-offset"]),"text-allow-overlap":new $t(Jt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new $t(Jt.layout_symbol["text-ignore-placement"]),"text-optional":new $t(Jt.layout_symbol["text-optional"])});var bf={paint:new On({"icon-opacity":new on(Jt.paint_symbol["icon-opacity"]),"icon-color":new on(Jt.paint_symbol["icon-color"]),"icon-halo-color":new on(Jt.paint_symbol["icon-halo-color"]),"icon-halo-width":new on(Jt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new on(Jt.paint_symbol["icon-halo-blur"]),"icon-translate":new $t(Jt.paint_symbol["icon-translate"]),"icon-translate-anchor":new $t(Jt.paint_symbol["icon-translate-anchor"]),"text-opacity":new on(Jt.paint_symbol["text-opacity"]),"text-color":new on(Jt.paint_symbol["text-color"],{runtimeType:fe,getOverride:t=>t.textColor,hasOverride:t=>!!t.textColor}),"text-halo-color":new on(Jt.paint_symbol["text-halo-color"]),"text-halo-width":new on(Jt.paint_symbol["text-halo-width"]),"text-halo-blur":new on(Jt.paint_symbol["text-halo-blur"]),"text-translate":new $t(Jt.paint_symbol["text-translate"]),"text-translate-anchor":new $t(Jt.paint_symbol["text-translate-anchor"])}),layout:_g};class wf{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:Kr,this.defaultValue=e}evaluate(e){if(e.formattedSection){const n=this.defaultValue.property.overrides;if(n&&n.hasOverride(e.formattedSection))return n.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Kn(wf,"FormatSectionOverride",{omit:["defaultValue"]});class sd extends La{constructor(e){super(e,bf)}recalculate(e,n){super.recalculate(e,n),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const s=this.layout.get("text-writing-mode");if(s){const h=[];for(const _ of s)h.indexOf(_)<0&&h.push(_);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,n,s,h){const _=this.layout.get(e).evaluate(n,{},s,h),x=this._unevaluatedLayout._values[e];return x.isDataDriven()||ai(x.value)||!_?_:(T=n.properties,_.replace(/{([^{}]+)}/g,(A,L)=>L in T?String(T[L]):""));var T}createBucket(e){return new qc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of bf.paint.overridableProperties){if(!sd.hasPaintOverride(this.layout,e))continue;const n=this.paint.get(e),s=new wf(n),h=new Dn(s,n.property.specification);let _=null;_="constant"===n.value.kind||"source"===n.value.kind?new tr("source",h):new or("composite",h,n.value.zoomStops,n.value._interpolationType),this.paint._values[e]=new An(n.property,_,n.parameters)}}_handleOverridablePaintPropertyUpdate(e,n,s){return!(!this.layout||n.isDataDriven()||s.isDataDriven())&&sd.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,n){const s=e.get("text-field"),h=bf.paint.properties[n];let _=!1;const x=T=>{for(const I of T)if(h.overrides&&h.overrides.hasOverride(I))return void(_=!0)};if("constant"===s.value.kind&&s.value.value instanceof io)x(s.value.value.sections);else if("source"===s.value.kind){const T=A=>{_||(A instanceof Wr&&br(A.value)===en?x(A.value.sections):A instanceof Qr?x(A.sections):A.eachChild(T))},I=s.value;I._styleExpression&&T(I._styleExpression.expression)}return _}getProgramConfiguration(e){return new Bc(this,e)}}var Cf={paint:new On({"background-color":new $t(Jt.paint_background["background-color"]),"background-pattern":new $t(Jt.paint_background["background-pattern"]),"background-opacity":new $t(Jt.paint_background["background-opacity"])})},J_={paint:new On({"raster-opacity":new $t(Jt.paint_raster["raster-opacity"]),"raster-hue-rotate":new $t(Jt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new $t(Jt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new $t(Jt.paint_raster["raster-brightness-max"]),"raster-saturation":new $t(Jt.paint_raster["raster-saturation"]),"raster-contrast":new $t(Jt.paint_raster["raster-contrast"]),"raster-resampling":new $t(Jt.paint_raster["raster-resampling"]),"raster-fade-duration":new $t(Jt.paint_raster["raster-fade-duration"])})};class Yh extends La{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var Jh={paint:new On({"sky-type":new $t(Jt.paint_sky["sky-type"]),"sky-atmosphere-sun":new $t(Jt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new $t(Jt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new $t(Jt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new $t(Jt.paint_sky["sky-gradient-radius"]),"sky-gradient":new wn(Jt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new $t(Jt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new $t(Jt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new $t(Jt.paint_sky["sky-opacity"])})};function Kd(t,e,n){const s=[0,0,1],h=yp([]);return xp(h,h,n?-ge(t)+Math.PI:ge(t)),vp(h,h,-ge(e)),gm(s,s,h),ss(s,s)}const X_={circle:class extends La{constructor(t){super(t,Zu)}createBucket(t){return new Sd(t)}queryRadius(t){const e=t;return xu("circle-radius",this,e)+xu("circle-stroke-width",this,e)+$u(this.paint.get("circle-translate"))}queryIntersectsFeature(t,e,n,s,h,_,x,T){const I=Pm(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,t.pixelToTileUnitsFactor),A=this.paint.get("circle-radius").evaluate(e,n)+this.paint.get("circle-stroke-width").evaluate(e,n);return Rm(t,s,_,x,T,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),I,A)}getProgramIds(){return["circle"]}getProgramConfiguration(t){return new Bc(this,t)}},heatmap:class extends La{createBucket(t){return new Rp(t)}constructor(t){super(t,i_),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"heatmap-color"===t&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=$c({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(t){return xu("heatmap-radius",this,t)}queryIntersectsFeature(t,e,n,s,h,_,x,T){const I=this.paint.get("heatmap-radius").evaluate(e,n);return Rm(t,s,_,x,T,!0,!0,new ne(0,0),I)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(t){return new Bc(this,t)}},hillshade:class extends La{constructor(t){super(t,Rd)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends La{constructor(t){super(t,m_)}getProgramIds(){const t=this.paint.get("fill-pattern"),e=t&&t.constantOr(1),n=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&n.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),n}getProgramConfiguration(t){return new Bc(this,t)}recalculate(t,e){super.recalculate(t,e);const n=this.paint._values["fill-outline-color"];"constant"===n.value.kind&&void 0===n.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(t){return new Sh(t)}queryRadius(){return $u(this.paint.get("fill-translate"))}queryIntersectsFeature(t,e,n,s,h,_){return!t.queryGeometry.isAboveHorizon&&Pp(Am(t.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,t.pixelToTileUnitsFactor),s)}isTileClipped(){return!0}},"fill-extrusion":class extends La{constructor(t){super(t,M_)}createBucket(t){return new Ph(t)}queryRadius(){return $u(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(t){return new Bc(this,t)}queryIntersectsFeature(t,e,n,s,h,_,x,T,I){const A=Pm(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,t.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(e,n),N=this.paint.get("fill-extrusion-base").evaluate(e,n),$=[0,0],J=T&&_.elevation,ee=_.elevation?_.elevation.exaggeration():1,ue=t.tile.getBucket(this);if(J&&ue instanceof Ph){const st=ue.centroidVertexArray,Ct=I+1;Ct<st.length&&($[0]=st.geta_centroid_pos0(Ct),$[1]=st.geta_centroid_pos1(Ct))}if(0===$[0]&&1===$[1])return!1;"globe"===_.projection.name&&(s=Hp([s],[new ne(0,0),new ne(Ei,Ei)],t.tileID.canonical).map(st=>st.polygon).flat());const Re=J?T:null,[et,pt]=(Ct=s,mt=N,Qt=L,Xt=A,mn=x,Fn=Re,an=$,yn=ee,vn=_.center.lat,"globe"===(st=_).projection.name?function(kn,ln,$n,_i,Wn,ni,Zn,wi,Xi,Wi,Zi){const Ti=[],Sr=[],Pi=kn.projection.upVectorScale(Zi,kn.center.lat,kn.worldSize).metersToTile,nr=[0,0,0,1],Lr=[0,0,0,1],qr=(Yr,Jr,po,us)=>{Yr[0]=Jr,Yr[1]=po,Yr[2]=us,Yr[3]=1},Zr=Zm();$n>0&&($n+=Zr),_i+=Zr;for(const Yr of ln){const Jr=[],po=[];for(const us of Yr){const Ar=us.x+Wn.x,Po=us.y+Wn.y,Io=kn.projection.projectTilePoint(Ar,Po,Zi),fr=kn.projection.upVector(Zi,us.x,us.y);let oo=$n,No=_i;if(Zn){const Fr=qp(Ar,Po,$n,_i,Zn,wi,Xi,Wi);oo+=Fr.base,No+=Fr.top}0!==$n?qr(nr,Io.x+fr[0]*Pi*oo,Io.y+fr[1]*Pi*oo,Io.z+fr[2]*Pi*oo):qr(nr,Io.x,Io.y,Io.z),qr(Lr,Io.x+fr[0]*Pi*No,Io.y+fr[1]*Pi*No,Io.z+fr[2]*Pi*No),bo(nr,nr,ni),bo(Lr,Lr,ni),Jr.push(new Wu(nr[0],nr[1],nr[2])),po.push(new Wu(Lr[0],Lr[1],Lr[2]))}Ti.push(Jr),Sr.push(po)}return[Ti,Sr]}(st,Ct,mt,Qt,Xt,mn,Fn,an,yn,vn,t.tileID.canonical):Fn?function(kn,ln,$n,_i,Wn,ni,Zn,wi,Xi){const Wi=[],Zi=[],Ti=[0,0,0,1];for(const Sr of kn){const Pi=[],nr=[];for(const Lr of Sr){const qr=Lr.x+_i.x,Zr=Lr.y+_i.y,Yr=qp(qr,Zr,ln,$n,ni,Zn,wi,Xi);Ti[0]=qr,Ti[1]=Zr,Ti[2]=Yr.base,Ti[3]=1,ac(Ti,Ti,Wn),Ti[3]=Math.max(Ti[3],1e-5);const Jr=new Wu(Ti[0]/Ti[3],Ti[1]/Ti[3],Ti[2]/Ti[3]);Ti[0]=qr,Ti[1]=Zr,Ti[2]=Yr.top,Ti[3]=1,ac(Ti,Ti,Wn),Ti[3]=Math.max(Ti[3],1e-5);const po=new Wu(Ti[0]/Ti[3],Ti[1]/Ti[3],Ti[2]/Ti[3]);Pi.push(Jr),nr.push(po)}Wi.push(Pi),Zi.push(nr)}return[Wi,Zi]}(Ct,mt,Qt,Xt,mn,Fn,an,yn,vn):function(kn,ln,$n,_i,Wn){const ni=[],Zn=[],wi=Wn[8]*ln,Xi=Wn[9]*ln,Wi=Wn[10]*ln,Zi=Wn[11]*ln,Ti=Wn[8]*$n,Sr=Wn[9]*$n,Pi=Wn[10]*$n,nr=Wn[11]*$n;for(const Lr of kn){const qr=[],Zr=[];for(const Yr of Lr){const Jr=Yr.x+_i.x,po=Yr.y+_i.y,us=Wn[0]*Jr+Wn[4]*po+Wn[12],Ar=Wn[1]*Jr+Wn[5]*po+Wn[13],Po=Wn[2]*Jr+Wn[6]*po+Wn[14],Io=Wn[3]*Jr+Wn[7]*po+Wn[15],fr=us+wi,oo=Ar+Xi,No=Po+Wi,Fr=Math.max(Io+Zi,1e-5),wo=us+Ti,Es=Ar+Sr,qo=Po+Pi,Yo=Math.max(Io+nr,1e-5);qr.push(new Wu(fr/Fr,oo/Fr,No/Fr)),Zr.push(new Wu(wo/Yo,Es/Yo,qo/Yo))}ni.push(qr),Zn.push(Zr)}return[ni,Zn]}(Ct,mt,Qt,Xt,mn)),Ye=t.queryGeometry;var st,Ct,mt,Qt,Xt,mn,Fn,an,yn,vn;return function(st,Ct,mt){let Qt=1/0;Pp(mt,Ct)&&(Qt=Hm(mt,Ct[0]));for(let Xt=0;Xt<Ct.length;Xt++){const mn=Ct[Xt],Fn=st[Xt];for(let an=0;an<mn.length-1;an++){const yn=mn[an],vn=[yn,mn[an+1],Fn[an+1],Fn[an],yn];Im(mt,vn)&&(Qt=Math.min(Qt,Hm(mt,vn)))}}return Qt!==1/0&&Qt}(et,pt,Ye.isPointQuery()?Ye.screenBounds:Ye.screenGeometry)}},line:class extends La{constructor(t){super(t,Ym),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(t){if("line-gradient"===t){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof _s,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(t,e){super.recalculate(t,e),this.paint._values["line-floorwidth"]=Xp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,t)}createBucket(t){return new pc(t)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(t){return new Bc(this,t)}queryRadius(t){const e=t,n=Jm(xu("line-width",this,e),xu("line-gap-width",this,e)),s=xu("line-offset",this,e);return n/2+Math.abs(s)+$u(this.paint.get("line-translate"))}queryIntersectsFeature(t,e,n,s,h,_){if(t.queryGeometry.isAboveHorizon)return!1;const x=Am(t.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,t.pixelToTileUnitsFactor),T=t.pixelToTileUnitsFactor/2*Jm(this.paint.get("line-width").evaluate(e,n),this.paint.get("line-gap-width").evaluate(e,n)),I=this.paint.get("line-offset").evaluate(e,n);return I&&(s=function(A,L){const N=[],$=new ne(0,0);for(let J=0;J<A.length;J++){const ee=A[J],ue=[];for(let Re=0;Re<ee.length;Re++){const pt=ee[Re],Ye=ee[Re+1],st=0===Re?$:pt.sub(ee[Re-1])._unit()._perp(),Ct=Re===ee.length-1?$:Ye.sub(pt)._unit()._perp(),mt=st._add(Ct)._unit();mt._mult(1/(mt.x*Ct.x+mt.y*Ct.y)),ue.push(mt._mult(L)._add(pt))}N.push(ue)}return N}(s,I*t.pixelToTileUnitsFactor)),function(A,L,N){for(let $=0;$<L.length;$++){const J=L[$];if(A.length>=3)for(let ee=0;ee<J.length;ee++)if(uc(A,J[ee]))return!0;if(Mm(A,J,N))return!0}return!1}(x,s,T)}isTileClipped(){return!0}},symbol:sd,background:class extends La{constructor(t){super(t,Cf)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends La{constructor(t){super(t,J_)}getProgramIds(){return["raster"]}},sky:class extends La{constructor(t){super(t,Jh),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(t){"sky-gradient"===t?this._updateColorRamp():"sky-atmosphere-sun"!==t&&"sky-atmosphere-halo-color"!==t&&"sky-atmosphere-color"!==t&&"sky-atmosphere-sun-intensity"!==t||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=$c({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(t){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=t.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(t,e){if("atmosphere"===this.paint.get("sky-type")){const s=this.paint.get("sky-atmosphere-sun"),h=!s,_=t.style.light,x=_.properties.get("position");return h&&"viewport"===_.properties.get("anchor")&&bn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),h?Kd(x.azimuthal,90-x.polar,e):Kd(s[0],90-s[1],e)}const n=this.paint.get("sky-gradient-center");return Kd(n[0],90-n[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(t){this._skyboxInvalidated=!1,this._lightPosition=t.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const t=this.paint.get("sky-type");return"atmosphere"===t?["skyboxCapture","skybox"]:"gradient"===t?["skyboxGradient"]:null}}};class Yc{constructor(e,n,s,h){this.context=e,this.format=s,this.texture=e.gl.createTexture(),this.update(n,h)}update(e,n,s){const{width:h,height:_}=e,{context:x}=this,{gl:T}=x,{HTMLImageElement:I,HTMLCanvasElement:A,HTMLVideoElement:L,ImageData:N,ImageBitmap:$}=q;if(T.bindTexture(T.TEXTURE_2D,this.texture),x.pixelStoreUnpackFlipY.set(!1),x.pixelStoreUnpack.set(1),x.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!n||!1!==n.premultiply)),s||this.size&&this.size[0]===h&&this.size[1]===_){const{x:J,y:ee}=s||{x:0,y:0};e instanceof I||e instanceof A||e instanceof L||e instanceof N||$&&e instanceof $?T.texSubImage2D(T.TEXTURE_2D,0,J,ee,T.RGBA,T.UNSIGNED_BYTE,e):T.texSubImage2D(T.TEXTURE_2D,0,J,ee,h,_,T.RGBA,T.UNSIGNED_BYTE,e.data)}else this.size=[h,_],e instanceof I||e instanceof A||e instanceof L||e instanceof N||$&&e instanceof $?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,e):T.texImage2D(T.TEXTURE_2D,0,this.format,h,_,0,this.format,T.UNSIGNED_BYTE,e.data);this.useMipmap=Boolean(n&&n.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&T.generateMipmap(T.TEXTURE_2D)}bind(e,n){const{context:s}=this,{gl:h}=s;h.bindTexture(h.TEXTURE_2D,this.texture),e!==this.filter&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MAG_FILTER,e),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_MIN_FILTER,this.useMipmap?e===h.NEAREST?h.NEAREST_MIPMAP_NEAREST:h.LINEAR_MIPMAP_NEAREST:e),this.filter=e),n!==this.wrap&&(h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_S,n),h.texParameteri(h.TEXTURE_2D,h.TEXTURE_WRAP_T,n),this.wrap=n)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class Xh{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Tf{constructor(){this.tasks={},this.taskQueue=[],rt(["process"],this),this.invoker=new Xh(this.process),this.nextId=0}add(e,n){const s=this.nextId++,h=function({type:_,isSymbolTile:x,zoom:T}){return T=T||0,"message"===_?0:"maybePrepare"!==_||x?"parseTile"!==_||x?"parseTile"===_&&x?300-T:"maybePrepare"===_&&x?400-T:500:200-T:100-T}(n);if(0===h){ot();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[s]={fn:e,metadata:n,priority:h,id:s},this.taskQueue.push(s),this.invoker.trigger(),{cancel:()=>{delete this.tasks[s]}}}process(){ot();try{if(this.taskQueue=this.taskQueue.filter(s=>!!this.tasks[s]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const n=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!n)return;n.fn()}finally{}}pick(){let e=null,n=1/0;for(let h=0;h<this.taskQueue.length;h++){const _=this.tasks[this.taskQueue[h]];_.priority<n&&(n=_.priority,e=h)}if(null===e)return null;const s=this.taskQueue[e];return this.taskQueue.splice(e,1),s}remove(){this.invoker.remove()}}class Ef{constructor(e){this._stringToNumber={},this._numberToString=[];for(let n=0;n<e.length;n++){const s=e[n];this._stringToNumber[s]=n,this._numberToString[n]=s}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const Df=["tile","layer","source","sourceLayer","state"];class If{constructor(e,n,s,h,_){this.type="Feature",this._vectorTileFeature=e,this._z=n,this._x=s,this._y=h,this.properties=e.properties,this.id=_}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const n of Df)void 0!==this[n]&&(e[n]=this[n]);return e}}const za=32,il=33,_c=new Uint16Array(8184);for(let t=0;t<2046;t++){let e=t+2,n=0,s=0,h=0,_=0,x=0,T=0;for(1&e?h=_=x=za:n=s=T=za;(e>>=1)>1;){const A=n+h>>1,L=s+_>>1;1&e?(h=n,_=s,n=x,s=T):(n=h,s=_,h=x,_=T),x=A,T=L}const I=4*t;_c[I+0]=n,_c[I+1]=s,_c[I+2]=h,_c[I+3]=_}const $l=new Uint16Array(2178),yc=new Uint8Array(1089),Qd=new Uint16Array(1089);function Mf(t){return 0===t?-.03125:32===t?.03125:0}var Sf=di([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const yg={type:2,extent:Ei,loadGeometry:()=>[[new ne(0,0),new ne(8193,0),new ne(8193,8193),new ne(0,8193),new ne(0,0)]]};class Kh{constructor(e,n,s,h,_){this.tileID=e,this.uid=Lt(),this.uses=0,this.tileSize=n,this.tileZoom=s,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",h&&h.transform&&(this.projection=h.transform.projection)}registerFadeDuration(e){const n=e+this.timeAdded;n<mi.now()||this.fadeEndTime&&n<this.fadeEndTime||(this.fadeEndTime=n)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=Eu(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,n,s){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(h,_){const x={};if(!_)return x;for(const T of h){const I=T.layerIds.map(A=>_.getLayer(A)).filter(Boolean);if(0!==I.length){T.layers=I,T.stateDependentLayerIds&&(T.stateDependentLayers=T.stateDependentLayerIds.map(A=>I.filter(L=>L.id===A)[0]));for(const A of I)x[A.id]=T}}return x}(e.buckets,n.style),this.hasSymbolBuckets=!1;for(const h in this.buckets){const _=this.buckets[h];if(_ instanceof qc){if(this.hasSymbolBuckets=!0,!s)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const h in this.buckets){const _=this.buckets[h];if(_ instanceof qc&&_.hasRTLText){this.hasRTLText=!0,At.isLoading()||At.isLoaded()||"deferred"!==Tt()||ft();break}}this.queryPadding=0;for(const h in this.buckets){const _=this.buckets[h];this.queryPadding=Math.max(this.queryPadding,n.style.getLayer(h).queryRadius(_))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new lp}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const s in this.buckets){const h=this.buckets[s];h.uploadPending()&&h.upload(e)}const n=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Yc(e,this.imageAtlas.image,n.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Yc(e,this.glyphAtlasImage,n.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Yc(e,this.lineAtlas.image,n.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,n,s,h,_,x,T,I){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:h,pixelPosMatrix:T,transform:x,params:_,tileTransform:this.tileTransform},e,n,s):{}}querySourceFeatures(e,n){const s=this.latestFeatureIndex;if(!s||!s.rawTileData)return;const h=s.loadVTLayers(),_=n?n.sourceLayer:"",x=h._geojsonTileLayer||h[_];if(!x)return;const T=Dl(n&&n.filter),{z:I,x:A,y:L}=this.tileID.canonical,N={z:I,x:A,y:L};for(let $=0;$<x.length;$++){const J=x.feature($);if(T.needGeometry){const Re=jc(J,!0);if(!T.filter(new Zt(this.tileID.overscaledZ),Re,this.tileID.canonical))continue}else if(!T.filter(new Zt(this.tileID.overscaledZ),J))continue;const ee=s.getId(J,_),ue=new If(J,I,A,L,ee);ue.tile=N,e.push(ue)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const n=this.expirationTime;if(e.cacheControl){const s=Bt(e.cacheControl);s["max-age"]&&(this.expirationTime=Date.now()+1e3*s["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const s=Date.now();let h=!1;if(this.expirationTime>s)h=!1;else if(n)if(this.expirationTime<n)h=!0;else{const _=this.expirationTime-n;_?this.expirationTime=s+Math.max(_,3e4):h=!0}else h=!0;h?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,n){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!n)return;const s=this.latestFeatureIndex.loadVTLayers(),h=n.style.listImages();for(const _ in this.buckets){if(!n.style.hasLayer(_))continue;const x=this.buckets[_],T=x.layers[0].sourceLayer||"_geojsonTileLayer",I=s[T],A=e[T];if(!I||!A||0===Object.keys(A).length)continue;if(x.update(A,I,h,this.imageAtlas&&this.imageAtlas.patternPositions||{}),x instanceof pc||x instanceof Sh){const N=n.style._getSourceCache(x.layers[0].source);n._terrain&&n._terrain.enabled&&N&&x.programConfigurations.needsUpload&&n._terrain._clearRenderCacheForTile(N.id,this.tileID)}const L=n&&n.style&&n.style.getLayer(_);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(x)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<mi.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=mi.now()+e}setTexture(e,n){const s=n.context,h=s.gl;this.texture=this.texture||n.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Yc(s,e,h.RGBA,{useMipmap:!0}),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE),s.extTextureFilterAnisotropic&&h.texParameterf(h.TEXTURE_2D,s.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,s.extTextureFilterAnisotropicMax))}setDependencies(e,n){const s={};for(const h of n)s[h]=!0;this.dependencies[e]=s}hasDependency(e,n){for(const s of e){const h=this.dependencies[s];if(h)for(const _ of n)if(h[_])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,n){if(!n||"mercator"===n.name||this._tileDebugBuffer)return;const s=Bl(yg,this.tileID.canonical,this.tileTransform)[0],h=new gi,_=new Qa;for(let x=0;x<s.length;x++){const{x:T,y:I}=s[x];h.emplaceBack(T,I),_.emplaceBack(x)}_.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(_),this._tileDebugBuffer=e.createVertexBuffer(h,Cd.members),this._tileDebugSegments=xo.simpleSegment(0,0,h.length,_.length)}_makeTileBoundsBuffers(e,n){if(this._tileBoundsBuffer||!n||"mercator"===n.name)return;const s=Bl(yg,this.tileID.canonical,this.tileTransform)[0];let h,_;if(this.isRaster){const x=function(T,I){const A=Eu(T,I),L=Math.pow(2,T.z);for(let Re=0;Re<il;Re++)for(let et=0;et<il;et++){const pt=ka((T.x+(et+Mf(et))/za)/L),Ye=Cs((T.y+(Re+Mf(Re))/za)/L),st=I.project(pt,Ye),Ct=Re*il+et;$l[2*Ct+0]=Math.round((st.x*A.scale-A.x)*Ei),$l[2*Ct+1]=Math.round((st.y*A.scale-A.y)*Ei)}yc.fill(0),Qd.fill(0);for(let Re=2045;Re>=0;Re--){const et=4*Re,pt=_c[et+0],Ye=_c[et+1],st=_c[et+2],Ct=_c[et+3],mt=pt+st>>1,Qt=Ye+Ct>>1,Xt=mt+Qt-Ye,mn=Qt+pt-mt,Fn=Ye*il+pt,an=Ct*il+st,yn=Qt*il+mt,vn=Math.hypot(($l[2*Fn+0]+$l[2*an+0])/2-$l[2*yn+0],($l[2*Fn+1]+$l[2*an+1])/2-$l[2*yn+1])>=16;yc[yn]=yc[yn]||(vn?1:0),Re<1022&&(yc[yn]=yc[yn]||yc[(Ye+mn>>1)*il+(pt+Xt>>1)]||yc[(Ct+mn>>1)*il+(st+Xt>>1)])}const N=new Or,$=new os;let J=0;function ee(Re,et){const pt=et*il+Re;return 0===Qd[pt]&&(N.emplaceBack($l[2*pt+0],$l[2*pt+1],Re*Ei/za,et*Ei/za),Qd[pt]=++J),Qd[pt]-1}function ue(Re,et,pt,Ye,st,Ct){const mt=Re+pt>>1,Qt=et+Ye>>1;if(Math.abs(Re-st)+Math.abs(et-Ct)>1&&yc[Qt*il+mt])ue(st,Ct,Re,et,mt,Qt),ue(pt,Ye,st,Ct,mt,Qt);else{const Xt=ee(Re,et),mn=ee(pt,Ye),Fn=ee(st,Ct);$.emplaceBack(Xt,mn,Fn)}}return ue(0,0,za,za,za,0),ue(za,za,0,0,0,za),{vertices:N,indices:$}}(this.tileID.canonical,n);h=x.vertices,_=x.indices}else{h=new Or,_=new os;for(const{x:T,y:I}of s)h.emplaceBack(T,I,0,0);const x=Gu(h.int16,void 0,4);for(let T=0;T<x.length;T+=3)_.emplaceBack(x[T],x[T+1],x[T+2])}this._tileBoundsBuffer=e.createVertexBuffer(h,Sf.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(_),this._tileBoundsSegments=xo.simpleSegment(0,0,h.length,_.length)}_makeGlobeTileDebugBuffers(e,n){const s=n.projection;if(!s||"globe"!==s.name||n.freezeTileCoverage)return;const h=this.tileID.canonical,_=Uu(wp(h,n)),x=Vu(n.zoom);let T;x>0&&(T=fp(new Float64Array(16),n.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,h,n,_,T,x),this._makeGlobeTileDebugTextBuffer(e,h,n,_,T,x)}_globePoint(e,n,s,h,_,x,T){let I=_u(e,n,s);if(x){const A=1<<s.z,L=el(h.center.lng),N=yl(h.center.lat),$=(s.x+.5)/A-L;let J=0;$>.5?J=-1:$<-.5&&(J=1);let ee=(e/Ei+s.x)/A+J,ue=(n/Ei+s.y)/A;ee=(ee-L)*h._pixelsPerMercatorPixel+L,ue=(ue-N)*h._pixelsPerMercatorPixel+N;const Re=[ee*h.worldSize,ue*h.worldSize,0];bo(Re,Re,x),I=_l(I,Re,T)}return bo(I,I,_)}_makeGlobeTileDebugBorderBuffer(e,n,s,h,_,x){const T=new gi,I=new Qa,A=new Tr,L=($,J,ee,ue,Re)=>{const et=(ee-$)/(Re-1),pt=(ue-J)/(Re-1),Ye=T.length;for(let st=0;st<Re;st++){const Ct=$+st*et,mt=J+st*pt;T.emplaceBack(Ct,mt);const Qt=this._globePoint(Ct,mt,n,s,h,_,x);A.emplaceBack(Qt[0],Qt[1],Qt[2]),I.emplaceBack(Ye+st)}},N=Ei;L(0,0,N,0,16),L(N,0,N,N,16),L(N,N,0,N,16),L(0,N,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(I),this._tileDebugBuffer=e.createVertexBuffer(T,Cd.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(A,ym.members),this._tileDebugSegments=xo.simpleSegment(0,0,T.length,I.length)}_makeGlobeTileDebugTextBuffer(e,n,s,h,_,x){const T=new gi,I=new os,A=new Tr,L=25;I.reserve(32),T.reserve(L),A.reserve(L);const N=($,J)=>L*$+J;for(let $=0;$<L;$++){const J=2048*$;for(let ee=0;ee<L;ee++){const ue=2048*ee;T.emplaceBack(ue,J);const Re=this._globePoint(ue,J,n,s,h,_,x);A.emplaceBack(Re[0],Re[1],Re[2])}}for(let $=0;$<4;$++)for(let J=0;J<4;J++){const ee=N($,J),ue=N($,J+1),Re=N($+1,J),et=N($+1,J+1);I.emplaceBack(ee,ue,Re),I.emplaceBack(Re,ue,et)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(I),this._tileDebugTextBuffer=e.createVertexBuffer(T,Cd.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(A,ym.members),this._tileDebugTextSegments=xo.simpleSegment(0,0,L,32)}}class vg{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,n,s){const h=String(n);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][h]=this.stateChanges[e][h]||{},It(this.stateChanges[e][h],s),null===this.deletedStates[e]){this.deletedStates[e]={};for(const _ in this.state[e])_!==h&&(this.deletedStates[e][_]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][h]){this.deletedStates[e][h]={};for(const _ in this.state[e][h])s[_]||(this.deletedStates[e][h][_]=null)}else for(const _ in s)this.deletedStates[e]&&this.deletedStates[e][h]&&null===this.deletedStates[e][h][_]&&delete this.deletedStates[e][h][_]}removeFeatureState(e,n,s){if(null===this.deletedStates[e])return;const h=String(n);if(this.deletedStates[e]=this.deletedStates[e]||{},s&&void 0!==n)null!==this.deletedStates[e][h]&&(this.deletedStates[e][h]=this.deletedStates[e][h]||{},this.deletedStates[e][h][s]=null);else if(void 0!==n)if(this.stateChanges[e]&&this.stateChanges[e][h])for(s in this.deletedStates[e][h]={},this.stateChanges[e][h])this.deletedStates[e][h][s]=null;else this.deletedStates[e][h]=null;else this.deletedStates[e]=null}getState(e,n){const s=String(n),h=It({},(this.state[e]||{})[s],(this.stateChanges[e]||{})[s]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const _=this.deletedStates[e][n];if(null===_)return{};for(const x in _)delete h[x]}return h}initializeTileState(e,n){e.setFeatureState(this.state,n)}coalesceChanges(e,n){const s={};for(const h in this.stateChanges){this.state[h]=this.state[h]||{};const _={};for(const x in this.stateChanges[h])this.state[h][x]||(this.state[h][x]={}),It(this.state[h][x],this.stateChanges[h][x]),_[x]=this.state[h][x];s[h]=_}for(const h in this.deletedStates){this.state[h]=this.state[h]||{};const _={};if(null===this.deletedStates[h])for(const x in this.state[h])_[x]={},this.state[h][x]={};else for(const x in this.deletedStates[h]){if(null===this.deletedStates[h][x])this.state[h][x]={};else if(this.state[h][x])for(const T of Object.keys(this.deletedStates[h][x]))delete this.state[h][x][T];_[x]=this.state[h][x]}s[h]=s[h]||{},It(s[h],_)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(s).length)for(const h in e)e[h].setFeatureState(s,n)}}class Qh{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,n){const s=this.toIdx(e,n);return{min:this.minimums[s],max:this.maximums[s]}}isLeaf(e,n){return this.leaves[this.toIdx(e,n)]}toIdx(e,n){return n*this.size+e}}function ep(t,e,n,s){let h=0,_=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(s[x])<1e-15){if(n[x]<t[x]||n[x]>e[x])return null}else{const T=1/s[x];let I=(t[x]-n[x])*T,A=(e[x]-n[x])*T;if(I>A){const L=I;I=A,A=L}if(I>h&&(h=I),A<_&&(_=A),h>_)return null}return h}function Af(t,e,n,s,h,_,x,T,I,A,L){const N=s-t,$=h-e,J=_-n,ee=x-t,ue=T-e,Re=I-n,et=L[1]*Re-L[2]*ue,pt=L[2]*ee-L[0]*Re,Ye=L[0]*ue-L[1]*ee,st=N*et+$*pt+J*Ye;if(Math.abs(st)<1e-15)return null;const Ct=1/st,mt=A[0]-t,Qt=A[1]-e,Xt=A[2]-n,mn=(mt*et+Qt*pt+Xt*Ye)*Ct;if(mn<0||mn>1)return null;const Fn=Qt*J-Xt*$,an=Xt*N-mt*J,yn=mt*$-Qt*N,vn=(L[0]*Fn+L[1]*an+L[2]*yn)*Ct;return vn<0||mn+vn>1?null:(ee*Fn+ue*an+Re*yn)*Ct}function Pf(t,e,n){return(t-e)/(n-e)}function Of(t,e,n,s,h,_,x,T,I){const A=1<<n,L=_-s,N=x-h,$=(t+1)/A*L+s,J=(e+0)/A*N+h,ee=(e+1)/A*N+h;T[0]=(t+0)/A*L+s,T[1]=J,I[0]=$,I[1]=ee}class Rf{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const n=function(_){const x=Math.ceil(Math.log2(_.dim/8)),T=[];let I=Math.ceil(Math.pow(2,x));const A=1/I,L=(J,ee,ue,Re,et)=>{const pt=Re?1:0,Ye=(J+1)*ue-pt,st=ee*ue,Ct=(ee+1)*ue-pt;et[0]=J*ue,et[1]=st,et[2]=Ye,et[3]=Ct};let N=new Qh(I);const $=[];for(let J=0;J<I*I;J++){L(J%I,Math.floor(J/I),A,!1,$);const ee=vc($[0],$[1],_),ue=vc($[2],$[1],_),Re=vc($[2],$[3],_),et=vc($[0],$[3],_);N.minimums.push(Math.min(ee,ue,Re,et)),N.maximums.push(Math.max(ee,ue,Re,et)),N.leaves.push(1)}for(T.push(N),I/=2;I>=1;I/=2){const J=T[T.length-1];N=new Qh(I);for(let ee=0;ee<I*I;ee++){L(ee%I,Math.floor(ee/I),2,!0,$);const ue=J.getElevation($[0],$[1]),Re=J.getElevation($[2],$[1]),et=J.getElevation($[2],$[3]),pt=J.getElevation($[0],$[3]),Ye=J.isLeaf($[0],$[1]),st=J.isLeaf($[2],$[1]),Ct=J.isLeaf($[2],$[3]),mt=J.isLeaf($[0],$[3]),Qt=Math.min(ue.min,Re.min,et.min,pt.min),Xt=Math.max(ue.max,Re.max,et.max,pt.max),mn=Ye&&st&&Ct&&mt;N.maximums.push(Xt),N.minimums.push(Qt),N.leaves.push(Xt-Qt<=5&&mn?1:0)}T.push(N)}return T}(this.dem),s=n.length-1,h=n[s];this._addNode(h.minimums[0],h.maximums[0],h.leaves[0]),this._construct(n,0,0,s,0)}raycastRoot(e,n,s,h,_,x,T=1){return ep([e,n,-100],[s,h,this.maximums[0]*T],_,x)}raycast(e,n,s,h,_,x,T=1){if(!this.nodeCount)return null;const I=this.raycastRoot(e,n,s,h,_,x,T);if(null==I)return null;const A=[],L=[],N=[],$=[],J=[{idx:0,t:I,nodex:0,nodey:0,depth:0}];for(;J.length>0;){const{idx:ee,t:ue,nodex:Re,nodey:et,depth:pt}=J.pop();if(this.leaves[ee]){Of(Re,et,pt,e,n,s,h,N,$);const st=1<<pt,Ct=(Re+0)/st,mt=(Re+1)/st,Qt=(et+0)/st,Xt=(et+1)/st,mn=vc(Ct,Qt,this.dem)*T,Fn=vc(mt,Qt,this.dem)*T,an=vc(mt,Xt,this.dem)*T,yn=vc(Ct,Xt,this.dem)*T,vn=Af(N[0],N[1],mn,$[0],N[1],Fn,$[0],$[1],an,_,x),Pn=Af($[0],$[1],an,N[0],$[1],yn,N[0],N[1],mn,_,x),kn=Math.min(null!==vn?vn:Number.MAX_VALUE,null!==Pn?Pn:Number.MAX_VALUE);if(kn!==Number.MAX_VALUE)return kn;{const ln=Nu([],_,x,ue);if(Lf(mn,Fn,yn,an,Pf(ln[0],N[0],$[0]),Pf(ln[1],N[1],$[1]))>=ln[2])return ue}continue}let Ye=0;for(let st=0;st<this._siblingOffset.length;st++){Of((Re<<1)+this._siblingOffset[st][0],(et<<1)+this._siblingOffset[st][1],pt+1,e,n,s,h,N,$),N[2]=-100,$[2]=this.maximums[this.childOffsets[ee]+st]*T;const Ct=ep(N,$,_,x);if(null!=Ct){const mt=Ct;A[st]=mt;let Qt=!1;for(let Xt=0;Xt<Ye&&!Qt;Xt++)mt>=A[L[Xt]]&&(L.splice(Xt,0,st),Qt=!0);Qt||(L[Ye]=st),Ye++}}for(let st=0;st<Ye;st++){const Ct=L[st];J.push({idx:this.childOffsets[ee]+Ct,t:A[Ct],nodex:(Re<<1)+this._siblingOffset[Ct][0],nodey:(et<<1)+this._siblingOffset[Ct][1],depth:pt+1})}}return null}_addNode(e,n,s){return this.minimums.push(e),this.maximums.push(n),this.leaves.push(s),this.childOffsets.push(0),this.nodeCount++}_construct(e,n,s,h,_){if(1===e[h].isLeaf(n,s))return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const x=h-1,T=e[x];let I=0,A=0;for(let L=0;L<this._siblingOffset.length;L++){const N=2*n+this._siblingOffset[L][0],$=2*s+this._siblingOffset[L][1],J=T.getElevation(N,$),ee=T.isLeaf(N,$),ue=this._addNode(J.min,J.max,ee);ee&&(I|=1<<L),A||(A=ue)}for(let L=0;L<this._siblingOffset.length;L++)I&1<<L||this._construct(e,2*n+this._siblingOffset[L][0],2*s+this._siblingOffset[L][1],x,A+L)}}function Lf(t,e,n,s,h,_){return vi(vi(t,n,_),vi(e,s,_),h)}function vc(t,e,n){const s=n.dim,h=me(t*s-.5,0,s-1),_=me(e*s-.5,0,s-1),x=Math.floor(h),T=Math.floor(_),I=Math.min(x+1,s-1),A=Math.min(T+1,s-1);return Lf(n.get(x,T),n.get(I,T),n.get(x,A),n.get(I,A),h-x,_-T)}const Ff={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};class eh{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,n,s,h=!1,_=!1){if(this.uid=e,n.height!==n.width)throw new RangeError("DEM tiles must be square");if(s&&"mapbox"!==s&&"terrarium"!==s)return bn(`"${s}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=n.height;const x=this.dim=n.height-2,T=new Uint32Array(n.data.buffer);if(this.pixels=new Uint8Array(n.data.buffer),this.encoding=s||"mapbox",this.borderReady=h,!h){for(let I=0;I<x;I++)T[this._idx(-1,I)]=T[this._idx(0,I)],T[this._idx(x,I)]=T[this._idx(x-1,I)],T[this._idx(I,-1)]=T[this._idx(I,0)],T[this._idx(I,x)]=T[this._idx(I,x-1)];T[this._idx(-1,-1)]=T[this._idx(0,0)],T[this._idx(x,-1)]=T[this._idx(x-1,0)],T[this._idx(-1,x)]=T[this._idx(0,x-1)],T[this._idx(x,x)]=T[this._idx(x-1,x-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Rf(this)}get(e,n,s=!1){s&&(e=me(e,-1,this.dim),n=me(n,-1,this.dim));const h=4*this._idx(e,n);return("terrarium"===this.encoding?this._unpackTerrarium:this._unpackMapbox)(this.pixels[h],this.pixels[h+1],this.pixels[h+2])}static getUnpackVector(e){return Ff[e]}get unpackVector(){return Ff[this.encoding]}_idx(e,n){if(e<-1||e>=this.dim+1||n<-1||n>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(n+1)*this.stride+(e+1)}_unpackMapbox(e,n,s){return(256*e*256+256*n+s)/10-1e4}_unpackTerrarium(e,n,s){return 256*e+n+s/256-32768}static pack(e,n){const s=[0,0,0,0],h=eh.getUnpackVector(n);let _=Math.floor((e+h[3])/h[2]);return s[2]=_%256,_=Math.floor(_/256),s[1]=_%256,_=Math.floor(_/256),s[0]=_,s}getPixels(){return new Ts({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,n,s){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=n*this.dim,_=n*this.dim+this.dim,x=s*this.dim,T=s*this.dim+this.dim;switch(n){case-1:h=_-1;break;case 1:_=h+1}switch(s){case-1:x=T-1;break;case 1:T=x+1}const I=-n*this.dim,A=-s*this.dim;for(let L=x;L<T;L++)for(let N=h;N<_;N++){const $=4*this._idx(N,L),J=4*this._idx(N+I,L+A);this.pixels[$+0]=e.pixels[J+0],this.pixels[$+1]=e.pixels[J+1],this.pixels[$+2]=e.pixels[J+2],this.pixels[$+3]=e.pixels[J+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Kn(eh,"DEMData"),Kn(Rf,"DemMinMaxQuadTree",{omit:["dem"]});class tp{constructor(e,n){this.max=e,this.onRemove=n,this.reset()}reset(){for(const e in this.data)for(const n of this.data[e])n.timeout&&clearTimeout(n.timeout),this.onRemove(n.value);return this.data={},this.order=[],this}add(e,n,s){const h=e.wrapped().key;void 0===this.data[h]&&(this.data[h]=[]);const _={value:n,timeout:void 0};if(void 0!==s&&(_.timeout=setTimeout(()=>{this.remove(e,_)},s)),this.data[h].push(_),this.order.push(h),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const n=this.data[e].shift();return n.timeout&&clearTimeout(n.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),n.value}getByKey(e){const n=this.data[e];return n?n[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,n){if(!this.has(e))return this;const s=e.wrapped().key,h=void 0===n?0:this.data[s].indexOf(n),_=this.data[s][h];return this.data[s].splice(h,1),_.timeout&&clearTimeout(_.timeout),0===this.data[s].length&&delete this.data[s],this.onRemove(_.value),this.order.splice(this.order.indexOf(s),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const n=this._getAndRemoveByKey(this.order[0]);n&&this.onRemove(n)}return this}filter(e){const n=[];for(const s in this.data)for(const h of this.data[s])e(h.value)||n.push(h);for(const s of n)this.remove(s.value.tileID,s)}}class Ua{constructor(e,n,s){this.func=e,this.mask=n,this.range=s}}Ua.ReadOnly=!1,Ua.ReadWrite=!0,Ua.disabled=new Ua(519,Ua.ReadOnly,[0,1]);class Bf{constructor(e,n,s,h,_,x){this.test=e,this.ref=n,this.mask=s,this.fail=h,this.depthFail=_,this.pass=x}}Bf.disabled=new Bf({func:519,mask:0},0,0,7680,7680,7680);class rl{constructor(e,n,s){this.blendFunction=e,this.blendColor=n,this.mask=s}}rl.Replace=[1,0],rl.disabled=new rl(rl.Replace,hr.transparent,[!1,!1,!1,!1]),rl.unblended=new rl(rl.Replace,hr.transparent,[!0,!0,!0,!0]),rl.alphaBlended=new rl([1,771],hr.transparent,[!0,!0,!0,!0]);class Cl{constructor(e,n,s){this.enable=e,this.mode=n,this.frontFace=s}}Cl.disabled=new Cl(!1,1029,2305),Cl.backCCW=new Cl(!0,1029,2305),Cl.backCW=new Cl(!0,1029,2304),Cl.frontCW=new Cl(!0,1028,2304),Cl.frontCCW=new Cl(!0,1028,2305);class bc extends Gr{constructor(e,n,s){super(),this.id=e,this._onlySymbols=s,n.on("data",h=>{"source"===h.dataType&&"metadata"===h.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===h.dataType&&"content"===h.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),n.on("error",()=>{this._sourceErrored=!0}),this._source=n,this._tiles={},this._cache=new tp(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=n.minTileCacheSize,this._maxTileCacheSize=n.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new vg,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const n=this._tiles[e];if("loaded"!==n.state&&"errored"!==n.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,n){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,n)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const n in this._tiles){const s=this._tiles[n];s.upload(e),s.prepare(this.map.style.imageManager)}}getIds(){return _t(this._tiles).map(e=>e.tileID).sort(K_).map(e=>e.key)}getRenderableIds(e){const n=[];for(const s in this._tiles)this._isIdRenderable(+s,e)&&n.push(this._tiles[s]);return e?n.sort((s,h)=>{const _=s.tileID,x=h.tileID,T=new ne(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),I=new ne(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-x.overscaledZ||I.y-T.y||I.x-T.x}).map(s=>s.tileID.key):n.map(s=>s.tileID).sort(K_).map(s=>s.key)}hasRenderableParent(e){const n=this.findLoadedParent(e,0);return!!n&&this._isIdRenderable(n.tileID.key)}_isIdRenderable(e,n){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(n||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,n){const s=this._tiles[e];s&&("loading"!==s.state&&(s.state=n),this._loadTile(s,this._tileLoaded.bind(this,s,e,n)))}_tileLoaded(e,n,s,h){if(h)if(e.state="errored",404!==h.status)this._source.fire(new Er(h,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=mi.now(),"expired"===s&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(n,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Li("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const n=this.getRenderableIds();for(let h=0;h<n.length;h++){const _=n[h];if(e.neighboringTiles&&e.neighboringTiles[_]){const x=this.getTileByID(_);s(e,x),s(x,e)}}function s(h,_){if(!h.dem||h.dem.borderReady)return;h.needsHillshadePrepare=!0,h.needsDEMTextureUpload=!0;let x=_.tileID.canonical.x-h.tileID.canonical.x;const T=_.tileID.canonical.y-h.tileID.canonical.y,I=Math.pow(2,h.tileID.canonical.z),A=_.tileID.key;0===x&&0===T||Math.abs(T)>1||(Math.abs(x)>1&&(1===Math.abs(x+I)?x+=I:1===Math.abs(x-I)&&(x-=I)),_.dem&&h.dem&&(h.dem.backfillBorder(_.dem,x,T),h.neighboringTiles&&h.neighboringTiles[A]&&(h.neighboringTiles[A].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,n,s,h){for(const _ in this._tiles){let x=this._tiles[_];if(h[_]||!x.hasData()||x.tileID.overscaledZ<=n||x.tileID.overscaledZ>s)continue;let T=x.tileID;for(;x&&x.tileID.overscaledZ>n+1;){const A=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[A.key],x&&x.hasData()&&(T=A)}let I=T;for(;I.overscaledZ>n;)if(I=I.scaledTo(I.overscaledZ-1),e[I.key]){h[T.key]=T;break}}}findLoadedParent(e,n){if(e.key in this._loadedParentTiles){const s=this._loadedParentTiles[e.key];return s&&s.tileID.overscaledZ>=n?s:null}for(let s=e.overscaledZ-1;s>=n;s--){const h=e.scaledTo(s),_=this._getLoadedTile(h);if(_)return _}}_getLoadedTile(e){const n=this._tiles[e.key];return n&&n.hasData()?n:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,n){n=n||this._source.tileSize;const s=Math.ceil(e.width/n)+1,h=Math.ceil(e.height/n)+1,_=Math.floor(s*h*5),x="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,_):_,T="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,x):x;this._cache.setMaxSize(T)}handleWrapJump(e){const n=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,n){const s={};for(const h in this._tiles){const _=this._tiles[h];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+n),s[_.tileID.key]=_}this._tiles=s;for(const h in this._timers)clearTimeout(this._timers[h]),delete this._timers[h];for(const h in this._tiles)this._setTileReloadTimer(+h,this._tiles[h])}}update(e,n,s){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!s)return;let h;this.updateCacheSize(e,n),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?h=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(T=>new Ks(T.canonical.z,T.wrap,T.canonical.z,T.canonical.x,T.canonical.y)):(h=e.coveringTiles({tileSize:n||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!s,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(h=h.filter(T=>this._source.hasTile(T)))):h=[];const _=this._updateRetainedTiles(h);if(Q_(this._source.type)&&0!==h.length){const T={},I={},A=Object.keys(_);for(const N of A){const $=_[N],J=this._tiles[N];if(!J||J.fadeEndTime&&J.fadeEndTime<=mi.now())continue;const ee=this.findLoadedParent($,Math.max($.overscaledZ-bc.maxOverzooming,this._source.minzoom));ee&&(this._addTile(ee.tileID),T[ee.tileID.key]=ee.tileID),I[N]=$}const L=h[h.length-1].overscaledZ;for(const N in this._tiles){const $=this._tiles[N];if(_[N]||!$.hasData())continue;let J=$.tileID;for(;J.overscaledZ>L;){J=J.scaledTo(J.overscaledZ-1);const ee=this._tiles[J.key];if(ee&&ee.hasData()&&I[J.key]){_[N]=$.tileID;break}}}for(const N in T)_[N]||(this._coveredTiles[N]=!0,_[N]=T[N])}for(const T in _)this._tiles[T].clearFadeHold();const x=function(T,I){const A=[];for(const L in T)L in I||A.push(L);return A}(this._tiles,_);for(const T of x){const I=this._tiles[T];I.hasSymbolBuckets&&!I.holdingForFade()?I.setHoldDuration(this.map._fadeDuration):I.hasSymbolBuckets&&!I.symbolFadeFinished()||this._removeTile(+T)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const n={};if(0===e.length)return n;const s={},h=e.reduce((A,L)=>Math.min(A,L.overscaledZ),1/0),_=e[0].overscaledZ,x=Math.max(_-bc.maxOverzooming,this._source.minzoom),T=Math.max(_+bc.maxUnderzooming,this._source.minzoom),I={};for(const A of e){const L=this._addTile(A);n[A.key]=A,L.hasData()||h<this._source.maxzoom&&(I[A.key]=A)}this._retainLoadedChildren(I,h,T,n);for(const A of e){let L=this._tiles[A.key];if(L.hasData())continue;if(A.canonical.z>=this._source.maxzoom){const $=A.children(this._source.maxzoom)[0],J=this.getTile($);if(J&&J.hasData()){n[$.key]=$;continue}}else{const $=A.children(this._source.maxzoom);if(n[$[0].key]&&n[$[1].key]&&n[$[2].key]&&n[$[3].key])continue}let N=L.wasRequested();for(let $=A.overscaledZ-1;$>=x;--$){const J=A.scaledTo($);if(s[J.key]||(s[J.key]=!0,L=this.getTile(J),!L&&N&&(L=this._addTile(J)),L&&(n[J.key]=J,N=L.wasRequested(),L.hasData())))break}}return n}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const n=[];let s,h=this._tiles[e].tileID;for(;h.overscaledZ>0;){if(h.key in this._loadedParentTiles){s=this._loadedParentTiles[h.key];break}n.push(h.key);const _=h.scaledTo(h.overscaledZ-1);if(s=this._getLoadedTile(_),s)break;h=_}for(const _ of n)this._loadedParentTiles[_]=s}}_addTile(e){let n=this._tiles[e.key];if(n)return n;n=this._cache.getAndRemove(e),n&&(this._setTileReloadTimer(e.key,n),n.tileID=e,this._state.initializeTileState(n,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,n)));const s=Boolean(n);if(!s){const h=this.map?this.map.painter:null;n=new Kh(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,h,this._isRaster),this._loadTile(n,this._tileLoaded.bind(this,n,e.key,n.state))}return n?(n.uses++,this._tiles[e.key]=n,s||this._source.fire(new Li("dataloading",{tile:n,coord:n.tileID,dataType:"source"})),n):null}_setTileReloadTimer(e,n){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const s=n.getExpiryTimeout();s&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},s))}_removeTile(e){const n=this._tiles[e];n&&(n.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),n.uses>0||(n.hasData()&&"reloading"!==n.state?this._cache.add(n.tileID,n,n.getExpiryTimeout()):(n.aborted=!0,this._abortTile(n),this._unloadTile(n))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,n,s){const h=[],_=this.transform;if(!_)return h;const x="globe"===_.projection.name,T=el(_.center.lng);for(const I in this._tiles){const A=this._tiles[I];if(s&&A.clearQueryDebugViz(),A.holdingForFade())continue;let L;if(x){const N=A.tileID.canonical;if(0===N.z){const $=[Math.abs(me(T,...nh(N,-1))-T),Math.abs(me(T,...nh(N,1))-T)];L=[0,2*$.indexOf(Math.min(...$))-1]}else{const $=[Math.abs(me(T,...nh(N,-1))-T),Math.abs(me(T,...nh(N,0))-T),Math.abs(me(T,...nh(N,1))-T)];L=[$.indexOf(Math.min(...$))-1]}}else L=[0];for(const N of L){const $=e.containsTile(A,_,n,N);$&&h.push($)}}return h}getVisibleCoordinates(e){const n=this.getRenderableIds(e).map(s=>this._tiles[s].tileID);for(const s of n)s.projMatrix=this.transform.calculateProjMatrix(s.toUnwrapped());return n}hasTransition(){if(this._source.hasTransition())return!0;if(Q_(this._source.type))for(const e in this._tiles){const n=this._tiles[e];if(void 0!==n.fadeEndTime&&n.fadeEndTime>=mi.now())return!0}return!1}setFeatureState(e,n,s){this._state.updateState(e=e||"_geojsonTileLayer",n,s)}removeFeatureState(e,n,s){this._state.removeFeatureState(e=e||"_geojsonTileLayer",n,s)}getFeatureState(e,n){return this._state.getState(e=e||"_geojsonTileLayer",n)}setDependencies(e,n,s){const h=this._tiles[e];h&&h.setDependencies(n,s)}reloadTilesForDependencies(e,n){for(const s in this._tiles)this._tiles[s].hasDependency(e,n)&&this._reloadTile(+s,"reloading");this._cache.filter(s=>!s.hasDependency(e,n))}_preloadTiles(e,n){const s=new Map,h=Array.isArray(e)?e:[e],_=this.map.painter.terrain,x=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const T of h){const I=T.coveringTiles({tileSize:x,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const A of I)s.set(A.key,A);this.usedForTerrain&&T.updateElevation(!1)}Ee(Array.from(s.values()),(T,I)=>{const A=new Kh(T,this._source.tileSize*T.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(A,L=>{"raster-dem"===this._source.type&&A.dem&&this._backfillDEM(A),I(L,A)})},n)}}function K_(t,e){const n=Math.abs(2*t.wrap)-+(t.wrap<0),s=Math.abs(2*e.wrap)-+(e.wrap<0);return t.overscaledZ-e.overscaledZ||s-n||e.canonical.y-t.canonical.y||e.canonical.x-t.canonical.x}function Q_(t){return"raster"===t||"image"===t||"video"===t||"custom"===t}function nh(t,e){const n=1<<t.z;return[t.x/n+e,(t.x+1)/n+e]}bc.maxOverzooming=10,bc.maxUnderzooming=3;class np{constructor(e,n,s){this._demTile=e,this._dem=this._demTile.dem,this._scale=n,this._offset=s}static create(e,n,s){const h=s||e.findDEMTileFor(n);if(!h||!h.dem)return;const _=h.dem,x=h.tileID,T=1<<n.canonical.z-x.canonical.z;return new np(h,h.tileSize/Ei/T,[(n.canonical.x/T-x.canonical.x)*_.dim,(n.canonical.y/T-x.canonical.y)*_.dim])}tileCoordToPixel(e,n){const s=n*this._scale+this._offset[1],h=Math.floor(e*this._scale+this._offset[0]),_=Math.floor(s);return new ne(h,_)}getElevationAt(e,n,s,h){const _=e*this._scale+this._offset[0],x=n*this._scale+this._offset[1],T=Math.floor(_),I=Math.floor(x),A=this._dem;return h=!!h,s?vi(vi(A.get(T,I,h),A.get(T,I+1,h),x-I),vi(A.get(T+1,I,h),A.get(T+1,I+1,h),x-I),_-T):A.get(T,I,h)}getElevationAtPixel(e,n,s){return this._dem.get(e,n,!!s)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*vl(1,e)*this._dem.stride}}class Nf{constructor(e,n){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Eo(Ei,16,0),this.featureIndexArray=new Us,this.promoteId=n}insert(e,n,s,h,_,x=0){const T=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(s,h,_,x);const I=this.grid;for(let A=0;A<n.length;A++){const L=n[A],N=[1/0,1/0,-1/0,-1/0];for(let $=0;$<L.length;$++){const J=L[$];N[0]=Math.min(N[0],J.x),N[1]=Math.min(N[1],J.y),N[2]=Math.max(N[2],J.x),N[3]=Math.max(N[3],J.y)}N[0]<Ei&&N[1]<Ei&&N[2]>=0&&N[3]>=0&&I.insert(T,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new Ah(new Xu(this.rawTileData)).layers,this.sourceLayerCoder=new Ef(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,n,s,h){this.loadVTLayers();const _=e.params||{},x=Dl(_.filter),T=e.tileResult,I=e.transform,A=T.bufferedTilespaceBounds,L=this.grid.query(A.min.x,A.min.y,A.max.x,A.max.y,(ee,ue,Re,et)=>Od(T.bufferedTilespaceGeometry,ee,ue,Re,et));L.sort(cs);let N=null;I.elevation&&L.length>0&&(N=np.create(I.elevation,this.tileID));const $={};let J;for(let ee=0;ee<L.length;ee++){const ue=L[ee];if(ue===J)continue;J=ue;const Re=this.featureIndexArray.get(ue);let et=null;this.loadMatchingFeature($,Re,x,_.layers,_.availableImages,n,s,h,(pt,Ye,st,Ct=0)=>(et||(et=Bl(pt,this.tileID.canonical,e.tileTransform)),Ye.queryIntersectsFeature(T,pt,st,et,this.z,e.transform,e.pixelPosMatrix,N,Ct)))}return $}loadMatchingFeature(e,n,s,h,_,x,T,I,A){const{featureIndex:L,bucketIndex:N,sourceLayerIndex:$,layoutVertexArrayOffset:J}=n,ee=this.bucketLayerIDs[N];if(h&&!function(pt,Ye){for(let st=0;st<pt.length;st++)if(Ye.indexOf(pt[st])>=0)return!0;return!1}(h,ee))return;const ue=this.sourceLayerCoder.decode($),Re=this.vtLayers[ue].feature(L);if(s.needGeometry){const pt=jc(Re,!0);if(!s.filter(new Zt(this.tileID.overscaledZ),pt,this.tileID.canonical))return}else if(!s.filter(new Zt(this.tileID.overscaledZ),Re))return;const et=this.getId(Re,ue);for(let pt=0;pt<ee.length;pt++){const Ye=ee[pt];if(h&&h.indexOf(Ye)<0)continue;const st=x[Ye];if(!st)continue;let Ct={};void 0!==et&&I&&(Ct=I.getState(st.sourceLayer||"_geojsonTileLayer",et));const mt=It({},T[Ye]);mt.paint=xg(mt.paint,st.paint,Re,Ct,_),mt.layout=xg(mt.layout,st.layout,Re,Ct,_);const Qt=!A||A(Re,st,Ct,J);if(!Qt)continue;const Xt=new If(Re,this.z,this.x,this.y,et);Xt.layer=mt;let mn=e[Ye];void 0===mn&&(mn=e[Ye]=[]),mn.push({featureIndex:L,feature:Xt,intersectionZ:Qt})}}lookupSymbolFeatures(e,n,s,h,_,x,T,I){const A={};this.loadVTLayers();const L=Dl(_);for(const N of e)this.loadMatchingFeature(A,{bucketIndex:s,sourceLayerIndex:h,featureIndex:N,layoutVertexArrayOffset:0},L,x,T,I,n);return A}loadFeature(e){const{featureIndex:n,sourceLayerIndex:s}=e;this.loadVTLayers();const h=this.sourceLayerCoder.decode(s),_=this.vtFeatures[h];if(_[n])return _[n];const x=this.vtLayers[h].feature(n);return _[n]=x,x}hasLayer(e){for(const n of this.bucketLayerIDs)for(const s of n)if(e===s)return!0;return!1}getId(e,n){let s=e.id;if(this.promoteId){const h="string"==typeof this.promoteId?this.promoteId:this.promoteId[n];null!=h&&(s=e.properties[h]),"boolean"==typeof s&&(s=Number(s))}return s}}function xg(t,e,n,s,h){return Ce(t,(_,x)=>{const T=e instanceof tn?e.get(x):null;return T&&T.evaluate?T.evaluate(n,s,h):T})}function cs(t,e){return e-t}Kn(Nf,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class zf{constructor(e,n){this.width=e,this.height=n,this.nextRow=0,this.image=new dc({width:e,height:n}),this.positions={},this.uploaded=!1}getDash(e,n){const s=this.getKey(e,n);return this.positions[s]}trim(){const e=this.width,n=this.height=St(this.nextRow);this.image.resize({width:e,height:n})}getKey(e,n){return e.join(",")+n}getDashRanges(e,n,s){const h=[];let _=e.length%2==1?-e[e.length-1]*s:0,x=e[0]*s,T=!0;h.push({left:_,right:x,isDash:T,zeroLength:0===e[0]});let I=e[0];for(let A=1;A<e.length;A++){T=!T;const L=e[A];_=I*s,I+=L,x=I*s,h.push({left:_,right:x,isDash:T,zeroLength:0===L})}return h}addRoundDash(e,n,s){const h=n/2;for(let _=-s;_<=s;_++){const x=this.width*(this.nextRow+s+_);let T=0,I=e[T];for(let A=0;A<this.width;A++){A/I.right>1&&(I=e[++T]);const L=Math.abs(A-I.left),N=Math.abs(A-I.right),$=Math.min(L,N);let J;const ee=_/s*(h+1);if(I.isDash){const ue=h-Math.abs(ee);J=Math.sqrt($*$+ue*ue)}else J=h-Math.sqrt($*$+ee*ee);this.image.data[x+A]=Math.max(0,Math.min(255,J+128))}}}addRegularDash(e,n){for(let I=e.length-1;I>=0;--I){const A=e[I],L=e[I+1];A.zeroLength?e.splice(I,1):L&&L.isDash===A.isDash&&(L.left=A.left,e.splice(I,1))}const s=e[0],h=e[e.length-1];s.isDash===h.isDash&&(s.left=h.left-this.width,h.right=s.right+this.width);const _=this.width*this.nextRow;let x=0,T=e[x];for(let I=0;I<this.width;I++){I/T.right>1&&(T=e[++x]);const A=Math.abs(I-T.left),L=Math.abs(I-T.right),N=Math.min(A,L);this.image.data[_+I]=Math.max(0,Math.min(255,(T.isDash?N:-N)+n+128))}}addDash(e,n){const s=this.getKey(e,n);if(this.positions[s])return this.positions[s];const h="round"===n,_=h?7:0,x=2*_+1;if(this.nextRow+x>this.height)return bn("LineAtlas out of space"),null;0===e.length&&e.push(1);let T=0;for(let L=0;L<e.length;L++)e[L]<0&&(bn("Negative value is found in line dasharray, replacing values with 0"),e[L]=0),T+=e[L];if(0!==T){const L=this.width/T,N=this.getDashRanges(e,this.width,L);h?this.addRoundDash(N,L,_):this.addRegularDash(N,"square"===n?.5*L:0)}const I=this.nextRow+_;this.nextRow+=x;const A={tl:[I,_],br:[T,0]};return this.positions[s]=A,A}}Kn(zf,"LineAtlas");class bg{constructor(e){const n={},s=[];for(const T in e){const I=e[T],A=n[T]={};for(const L in I.glyphs){const N=I.glyphs[+L];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const $=N.metrics.localGlyph?2:1,J={x:0,y:0,w:N.bitmap.width+2*$,h:N.bitmap.height+2*$};s.push(J),A[L]=J}}const{w:h,h:_}=af(s),x=new dc({width:h||1,height:_||1});for(const T in e){const I=e[T];for(const A in I.glyphs){const L=I.glyphs[+A];if(!L||0===L.bitmap.width||0===L.bitmap.height)continue;const N=n[T][A],$=L.metrics.localGlyph?2:1;dc.copy(L.bitmap,x,{x:0,y:0},{x:N.x+$,y:N.y+$},L.bitmap)}}this.image=x,this.positions=n}}Kn(bg,"GlyphAtlas");class ey{constructor(e){this.tileID=new Ks(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=Eu(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,n,s,h,_){this.status="parsing",this.data=e,this.collisionBoxArray=new lp;const x=new Ef(Object.keys(e.layers).sort()),T=new Nf(this.tileID,this.promoteId);T.bucketLayerIDs=[];const I={},A=new zf(256,256),L={featureIndex:T,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:A,availableImages:s},N=n.familiesBySource[this.source];for(const Ct in N){const mt=e.layers[Ct];if(!mt)continue;let Qt=!1,Xt=!1;for(const an of N[Ct])"symbol"===an[0].type?Qt=!0:Xt=!0;if(!0===this.isSymbolTile&&!Qt||!1===this.isSymbolTile&&!Xt)continue;1===mt.version&&bn(`Vector tile source "${this.source}" layer "${Ct}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mn=x.encode(Ct),Fn=[];for(let an=0;an<mt.length;an++){const yn=mt.feature(an),vn=T.getId(yn,Ct);Fn.push({feature:yn,id:vn,index:an,sourceLayerIndex:mn})}for(const an of N[Ct]){const yn=an[0];void 0!==this.isSymbolTile&&"symbol"===yn.type!==this.isSymbolTile||yn.minzoom&&this.zoom<Math.floor(yn.minzoom)||yn.maxzoom&&this.zoom>=yn.maxzoom||"none"!==yn.visibility&&(ip(an,this.zoom,s),(I[yn.id]=yn.createBucket({index:T.bucketLayerIDs.length,layers:an,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:s})).populate(Fn,L,this.tileID.canonical,this.tileTransform),T.bucketLayerIDs.push(an.map(vn=>vn.id)))}}let $,J,ee,ue;A.trim();const Re={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},et=Ce(L.glyphDependencies,Ct=>Object.keys(Ct).map(Number));Object.keys(et).length?h.send("getGlyphs",{uid:this.uid,stacks:et},(Ct,mt)=>{$||($=Ct,J=mt,st.call(this))},void 0,!1,Re):J={};const pt=Object.keys(L.iconDependencies);pt.length?h.send("getImages",{icons:pt,source:this.source,tileID:this.tileID,type:"icons"},(Ct,mt)=>{$||($=Ct,ee=mt,st.call(this))},void 0,!1,Re):ee={};const Ye=Object.keys(L.patternDependencies);function st(){if($)return _($);if(J&&ee&&ue){const Ct=new bg(J),mt=new ng(ee,ue);for(const Qt in I){const Xt=I[Qt];Xt instanceof qc?(ip(Xt.layers,this.zoom,s),H_(Xt,J,Ct.positions,ee,mt.iconPositions,this.showCollisionBoxes,s,this.tileID.canonical,this.tileZoom,this.projection)):Xt.hasPattern&&(Xt instanceof pc||Xt instanceof Sh||Xt instanceof Ph)&&(ip(Xt.layers,this.zoom,s),Xt.addFeatures(L,this.tileID.canonical,mt.patternPositions,s,this.tileTransform))}this.status="done",_(null,{buckets:_t(I).filter(Qt=>!Qt.isEmpty()),featureIndex:T,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Ct.image,lineAtlas:A,imageAtlas:mt,glyphMap:this.returnDependencies?J:null,iconMap:this.returnDependencies?ee:null,glyphPositions:this.returnDependencies?Ct.positions:null})}}Ye.length?h.send("getImages",{icons:Ye,source:this.source,tileID:this.tileID,type:"patterns"},(Ct,mt)=>{$||($=Ct,ue=mt,st.call(this))},void 0,!1,Re):ue={},st.call(this)}}function ip(t,e,n){const s=new Zt(e);for(const h of t)h.recalculate(s,n)}class wg{constructor(e){this.entries={},this.scheduler=e}request(e,n,s,h){const _=this.entries[e]=this.entries[e]||{callbacks:[]};if(_.result){const[x,T]=_.result;return this.scheduler?this.scheduler.add(()=>{h(x,T)},n):h(x,T),()=>{}}return _.callbacks.push(h),_.cancel||(_.cancel=s((x,T)=>{_.result=[x,T];for(const I of _.callbacks)this.scheduler?this.scheduler.add(()=>{I(x,T)},n):I(x,T);setTimeout(()=>delete this.entries[e],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(x=>x!==h),_.callbacks.length||(_.cancel(),delete this.entries[e]))}}}function Uf(t,e,n){const s=JSON.stringify(t.request);return t.data&&(this.deduped.entries[s]={result:[null,t.data]}),this.deduped.request(s,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom},h=>{const _=rn(t.request,(x,T,I,A)=>{x?h(x):T&&h(null,{vectorTile:n?void 0:new Ah(new Xu(T)),rawData:T,cacheControl:I,expires:A})});return()=>{_.cancel(),h()}},e)}a.ARRAY_TYPE=ra,a.AUTH_ERR_MSG=Si,a.Aabb=oa,a.Actor=class{constructor(t,e,n){this.target=t,this.parent=e,this.mapId=n,this.callbacks={},this.cancelCallbacks={},rt(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=ot()?t:q,this.scheduler=new Tf}send(t,e,n,s,h=!1,_){const x=Math.round(1e18*Math.random()).toString(36).substring(0,10);n&&(n.metadata=_,this.callbacks[x]=n);const T=Qn(this.globalScope)?void 0:[];return this.target.postMessage({id:x,type:t,hasCallback:!!n,targetMapId:s,mustQueue:h,sourceMapId:this.mapId,data:Oa(e,T)},T),{cancel:()=>{n&&delete this.callbacks[x],this.target.postMessage({id:x,type:"<cancel>",targetMapId:s,sourceMapId:this.mapId})}}}receive(t){const e=t.data,n=e.id;if(n&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const s=this.cancelCallbacks[n];delete this.cancelCallbacks[n],s&&s.cancel()}else if(e.mustQueue||ot()){const s=this.callbacks[n];this.cancelCallbacks[n]=this.scheduler.add(()=>this.processTask(n,e),s&&s.metadata||{type:"message"})}else this.processTask(n,e)}processTask(t,e){if("<response>"===e.type){const n=this.callbacks[t];delete this.callbacks[t],n&&(e.error?n(ya(e.error)):n(null,ya(e.data)))}else{const n=Qn(this.globalScope)?void 0:[],s=e.hasCallback?(_,x)=>{delete this.cancelCallbacks[t],this.target.postMessage({id:t,type:"<response>",sourceMapId:this.mapId,error:_?Oa(_):null,data:Oa(x,n)},n)}:_=>{},h=ya(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,h,s);else if(this.parent.getWorkerSource){const _=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,_[0],h.source)[_[1]](h,s)}else s(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=Rh,a.Color=hr,a.ColorMode=rl,a.CullFaceMode=Cl,a.DEMData=eh,a.DataConstantProperty=$t,a.DedupedRequest=wg,a.DepthMode=Ua,a.EXTENT=Ei,a.Elevation=class{isDataAvailableAtPoint(t){const e=this._source();if(this.isUsingMockSource()||!e||t.y<0||t.y>1)return!1;const n=e.getSource().maxzoom,s=1<<n,h=Math.floor(t.x),_=Math.floor((t.x-h)*s),x=Math.floor(t.y*s),T=this.findDEMTileFor(new Ks(n,h,n,_,x));return!(!T||!T.dem)}getAtPointOrZero(t,e=0){return this.getAtPoint(t,e)||0}getAtPoint(t,e,n=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const s=this._source();if(!s||t.y<0||t.y>1)return e;const h=s.getSource().maxzoom,_=1<<h,x=Math.floor(t.x),T=t.x-x,I=new Ks(h,x,h,Math.floor(T*_),Math.floor(t.y*_)),A=this.findDEMTileFor(I);if(!A||!A.dem)return e;const L=A.dem,N=1<<A.tileID.canonical.z,$=(T*N-A.tileID.canonical.x)*L.dim,J=(t.y*N-A.tileID.canonical.y)*L.dim,ee=Math.floor($),ue=Math.floor(J);return(n?this.exaggeration():1)*vi(vi(L.get(ee,ue),L.get(ee,ue+1),J-ue),vi(L.get(ee+1,ue),L.get(ee+1,ue+1),J-ue),$-ee)}getAtTileOffset(t,e,n){const s=1<<t.canonical.z;return this.getAtPointOrZero(new Md(t.wrap+(t.canonical.x+e/Ei)/s,(t.canonical.y+n/Ei)/s))}getAtTileOffsetFunc(t,e,n,s){return h=>{const _=this.getAtTileOffset(t,h.x,h.y),x=s.upVector(t.canonical,h.x,h.y);return wa(x,x,_*s.upVectorScale(t.canonical,e,n).metersToTile),x}}getForTilePoints(t,e,n,s){if(this.isUsingMockSource())return!1;const h=np.create(this,t,s);return!!h&&(e.forEach(_=>{_[2]=this.exaggeration()*h.getElevationAt(_[0],_[1],n)}),!0)}getMinMaxForTile(t){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(t);if(!e||!e.dem)return null;const n=e.dem.tree,s=e.tileID,h=1<<t.canonical.z-s.canonical.z;let _=t.canonical.x/h-s.canonical.x,x=t.canonical.y/h-s.canonical.y,T=0;for(let I=0;I<t.canonical.z-s.canonical.z&&!n.leaves[T];I++){_*=2,x*=2;const A=2*Math.floor(x)+Math.floor(_);T=n.childOffsets[T]+A,_%=1,x%=1}return{min:this.exaggeration()*n.minimums[T],max:this.exaggeration()*n.maximums[T]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(t,e,n){throw new Error("Pure virtual method called.")}pointCoordinate(t){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(t){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=Er,a.EvaluationParameters=Zt,a.Event=Li,a.Evented=Gr,a.FillExtrusionBucket=Ph,a.Frustum=bp,a.FrustumCorners=gu,a.GLOBE_RADIUS=lc,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=6,a.GLOBE_ZOOM_THRESHOLD_MIN=5,a.GlobeSharedBuffers=class{constructor(t){this._createGrid(t),this._createPoles(t)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const t of this._poleSegments)t.destroy();for(const t of this._gridSegments)t.withSkirts.destroy(),t.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const t of this._wireframeSegments)t.destroy()}}_fillGridMeshWithLods(t,e){const n=new gi,s=new os,h=[],_=t+1+2,x=e[0]+1,T=e[0]+1+(1+e.length),I=(A,L,N)=>{let $=A===_-1?A-2:0===A?A:A-1;return $+=N?24575:0,[$,L]};for(let A=0;A<_;++A)n.emplaceBack(...I(A,0,!0));for(let A=0;A<x;++A)for(let L=0;L<_;++L)n.emplaceBack(...I(L,A,(0===L||L===_-1)&&!0));for(let A=0;A<e.length;++A){const L=e[A];for(let N=0;N<_;++N)n.emplaceBack(...I(N,L,!0))}for(let A=0;A<e.length;++A){const L=s.length,N=e[A]+1+2,$=new os;for(let ue=0;ue<N-1;ue++){const Re=ue===N-2,et=Re?_*(T-e.length+A-ue):_;for(let pt=0;pt<_-1;pt++){const Ye=ue*_+pt;0===ue||Re||0===pt||pt===_-2?($.emplaceBack(Ye+1,Ye,Ye+et),$.emplaceBack(Ye+et,Ye+et+1,Ye+1)):(s.emplaceBack(Ye+1,Ye,Ye+et),s.emplaceBack(Ye+et,Ye+et+1,Ye+1))}}const J=xo.simpleSegment(0,L,n.length,s.length-L);for(let ue=0;ue<$.uint16.length;ue+=3)s.emplaceBack($.uint16[ue],$.uint16[ue+1],$.uint16[ue+2]);const ee=xo.simpleSegment(0,L,n.length,s.length-L);h.push({withoutSkirts:J,withSkirts:ee})}return{vertices:n,indices:s,segments:h}}_createGrid(t){const e=this._fillGridMeshWithLods(64,mh);this._gridSegments=e.segments,this._gridBuffer=t.createVertexBuffer(e.vertices,Cd.members),this._gridIndexBuffer=t.createIndexBuffer(e.indices,!0)}_createPoles(t){const e=new os;for(let h=0;h<=64;h++)e.emplaceBack(0,h+1,h+2);this._poleIndexBuffer=t.createIndexBuffer(e,!0);const n=new va,s=new va;this._poleSegments=[];for(let h=0,_=0;h<5;h++){const x=360/(1<<h);n.emplaceBack(0,-lc,0,.5,0),s.emplaceBack(0,-lc,0,.5,1);for(let T=0;T<=64;T++){const I=T/64,A=vi(0,x,I),[L,N,$]=Ed(Xg,Ip,A,lc);n.emplaceBack(L,N,$,I,0),s.emplaceBack(L,N,$,I,1)}this._poleSegments.push(xo.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=t.createVertexBuffer(n,_m,!1),this._poleSouthVertexBuffer=t.createVertexBuffer(s,_m,!1)}getGridBuffers(t,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[t].withSkirts:this._gridSegments[t].withoutSkirts]}getPoleBuffers(t){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[t]]}getWirefameBuffers(t,e){if(!this._wireframeSegments){const n=new fl,s=64,h=s+1+2,_=1;this._wireframeSegments=[];for(let x=0,T=0;x<mh.length;x++){const I=mh[x];for(let L=_;L<I+_;L++)for(let N=_;N<s+_;N++){const $=L*h+N;n.emplaceBack($,$+1),n.emplaceBack($,$+h),n.emplaceBack($,$+h+1)}const A=I*s*3;this._wireframeSegments.push(xo.simpleSegment(0,T,(I+1)*h,A)),T+=A}this._wireframeIndexBuffer=t.createIndexBuffer(n)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},a.GlyphManager=td,a.ImagePosition=Nh,a.LivePerformanceUtils=Be,a.LngLat=ur,a.LngLatBounds=xa,a.LocalGlyphMode=ag,a.MAX_MERCATOR_LATITUDE=as,a.MercatorCoordinate=Md,a.ONE_EM=ls,a.OverscaledTileID=Ks,a.PerformanceMarkers=Fe,a.Properties=On,a.RGBAImage=Ts,a.Ray=kl,a.RequestManager=class{constructor(t,e,n){this._transformRequestFn=t,this._customAccessToken=e,this._silenceAuthErrors=!!n,this._createSkuToken()}_createSkuToken(){const t=function(){let e="";for(let n=0;n<10;n++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ce,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=t.token,this._skuTokenExpiresAt=t.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(t,e){return this._transformRequestFn&&this._transformRequestFn(t,e)||{url:t}}normalizeStyleURL(t,e){if(!vr(t))return t;const n=Rt(t);return n.path=`/styles/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeGlyphsURL(t,e){if(!vr(t))return t;const n=Rt(t);return n.path=`/fonts/v1${n.path}`,this._makeAPIURL(n,this._customAccessToken||e)}normalizeSourceURL(t,e,n,s){if(!vr(t))return t;const h=Rt(t);return h.path=`/v4/${h.authority}.json`,h.params.push("secure"),n&&h.params.push(`language=${n}`),s&&h.params.push(`worldview=${s}`),this._makeAPIURL(h,this._customAccessToken||e)}normalizeSpriteURL(t,e,n,s){const h=Rt(t);return vr(t)?(h.path=`/styles/v1${h.path}/sprite${e}${n}`,this._makeAPIURL(h,this._customAccessToken||s)):(h.path+=`${e}${n}`,_n(h))}normalizeTileURL(t,e,n){if(this._isSkuTokenExpired()&&this._createSkuToken(),t&&!vr(t))return t;const s=Rt(t);s.path=s.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||n&&"raster"!==s.authority&&512===n?"@2x":""}${Ie.supported?".webp":"$1"}`),"raster"===s.authority?s.path=`/${he.RASTER_URL_PREFIX}${s.path}`:(s.path=s.path.replace(/^.+\/v4\//,"/"),s.path=`/${he.TILE_URL_VERSION}${s.path}`);const h=this._customAccessToken||function(_){for(const x of _){const T=x.match(/^access_token=(.*)$/);if(T)return T[1]}return null}(s.params)||he.ACCESS_TOKEN;return he.REQUIRE_ACCESS_TOKEN&&h&&this._skuToken&&s.params.push(`sku=${this._skuToken}`),this._makeAPIURL(s,h)}canonicalizeTileURL(t,e){const n=Rt(t);if(!n.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!n.path.match(/\.[\w]+$/))return t;let s="mapbox://";n.path.match(/^\/raster\/v1\//)?s+=`raster/${n.path.replace(`/${he.RASTER_URL_PREFIX}/`,"")}`:s+=`tiles/${n.path.replace(`/${he.TILE_URL_VERSION}/`,"")}`;let h=n.params;return e&&(h=h.filter(_=>!_.match(/^access_token=/))),h.length&&(s+=`?${h.join("&")}`),s}canonicalizeTileset(t,e){const n=!!e&&vr(e),s=[];for(const h of t.tiles||[])xr(h)?s.push(this.canonicalizeTileURL(h,n)):s.push(h);return s}_makeAPIURL(t,e){const n="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",s=Rt(he.API_URL);if(t.protocol=s.protocol,t.authority=s.authority,"http"===t.protocol){const h=t.params.indexOf("secure");h>=0&&t.params.splice(h,1)}if("/"!==s.path&&(t.path=`${s.path}${t.path}`),!he.REQUIRE_ACCESS_TOKEN)return _n(t);if(e=e||he.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${n}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${n}`)}return t.params=t.params.filter(h=>-1===h.indexOf("access_token")),t.params.push(`access_token=${e||""}`),_n(t)}},a.ResourceType=Ge,a.SegmentVector=xo,a.SourceCache=bc,a.StencilMode=Bf,a.StructArrayLayout1ui2=Qa,a.StructArrayLayout2f1f2i16=is,a.StructArrayLayout2i4=gi,a.StructArrayLayout2ui4=fl,a.StructArrayLayout3f12=rs,a.StructArrayLayout3ui6=os,a.StructArrayLayout4i8=Or,a.StructArrayLayout5f20=va,a.Texture=Yc,a.Tile=Kh,a.Transitionable=Bn,a.Uniform1f=Lc,a.Uniform1i=class extends rc{constructor(t){super(t),this.current=0}set(t,e,n){this.fetchUniformLocation(t,e)&&this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},a.Uniform2f=class extends rc{constructor(t){super(t),this.current=[0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1])))}},a.Uniform3f=class extends rc{constructor(t){super(t),this.current=[0,0,0]}set(t,e,n){this.fetchUniformLocation(t,e)&&(n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2])))}},a.Uniform4f=cm,a.UniformColor=um,a.UniformMatrix2f=class extends rc{constructor(t){super(t),this.current=dm}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let s=0;s<4;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix2fv(this.location,!1,n);break}}},a.UniformMatrix3f=class extends rc{constructor(t){super(t),this.current=pp}set(t,e,n){if(this.fetchUniformLocation(t,e))for(let s=0;s<9;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix3fv(this.location,!1,n);break}}},a.UniformMatrix4f=class extends rc{constructor(t){super(t),this.current=hp}set(t,e,n){if(this.fetchUniformLocation(t,e)){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let s=1;s<16;s++)if(n[s]!==this.current[s]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}}},a.UnwrappedTileID=Gm,a.ValidationError=zn,a.VectorTileFeature=Bd,a.VectorTileWorkerSource=class extends Gr{constructor(t,e,n,s,h){super(),this.actor=t,this.layerIndex=e,this.availableImages=n,this.loadVectorData=h||Uf,this.loading={},this.loaded={},this.deduped=new wg(t.scheduler),this.isSpriteLoaded=s,this.scheduler=t.scheduler}loadTile(t,e){const n=t.uid,s=t&&t.request,h=s&&s.collectResourceTiming,_=this.loading[n]=new ey(t);_.abort=this.loadVectorData(t,(x,T)=>{const I=!this.loading[n];if(delete this.loading[n],I||x||!T)return _.status="done",I||(this.loaded[n]=_),e(x);const A=T.rawData,L={};T.expires&&(L.expires=T.expires),T.cacheControl&&(L.cacheControl=T.cacheControl),_.vectorTile=T.vectorTile||new Ah(new Xu(A));const N=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,($,J)=>{if($||!J)return e($);const ee={};if(h){const ue=jt(s);ue.length>0&&(ee.resourceTiming=JSON.parse(JSON.stringify(ue)))}e(null,It({rawTileData:A.slice(0)},J,L,ee))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:t.isSymbolTile,zoom:t.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[n]=_})}reloadTile(t,e){const n=this.loaded,s=t.uid,h=this;if(n&&n[s]){const _=n[s];_.showCollisionBoxes=t.showCollisionBoxes,_.enableTerrain=!!t.enableTerrain,_.projection=t.projection,_.tileTransform=Eu(t.tileID.canonical,t.projection);const x=(T,I)=>{const A=_.reloadCallback;A&&(delete _.reloadCallback,_.parse(_.vectorTile,h.layerIndex,this.availableImages,h.actor,A)),e(T,I)};"parsing"===_.status?_.reloadCallback=x:"done"===_.status&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,x):x())}}abortTile(t,e){const n=t.uid,s=this.loading[n];s&&(s.abort&&s.abort(),delete this.loading[n]),e()}removeTile(t,e){const n=this.loaded,s=t.uid;n&&n[s]&&delete n[s],e()}},a.WritingMode=Na,a.ZoomDependentExpression=or,a.add=sc,a.addDynamicAttributes=Xd,a.adjoint=function(t,e){var n=e[0],s=e[1],h=e[2],_=e[3],x=e[4],T=e[5],I=e[6],A=e[7],L=e[8];return t[0]=x*L-T*A,t[1]=h*A-s*L,t[2]=s*T-h*x,t[3]=T*I-_*L,t[4]=n*L-h*I,t[5]=h*_-n*T,t[6]=_*A-x*I,t[7]=s*I-n*A,t[8]=n*x-s*_,t},a.asyncAll=Ee,a.bezier=Xe,a.bindAll=rt,a.boundsAttributes=Sf,a.bufferConvexPolygon=function(t,e){const n=[];for(let s=0;s<t.length;s++){const h=se(s-1,-1,t.length-1),_=se(s+1,-1,t.length-1),x=t[s],T=t[_],I=t[h].sub(x).unit(),A=T.sub(x).unit(),L=A.angleWithSep(I.x,I.y),N=I.add(A).unit().mult(-1*e/Math.sin(L/2));n.push(x.add(N))}return n},a.cacheEntryPossiblyAdded=function(t){Mt++,Mt>Mi&&(t.getActor().send("enforceCacheSizeLimit",Bi),Mt=0)},a.calculateGlobeLabelMatrix=function(t,e){const{x:n,y:s}=t.point,h=wm(n,s,t.worldSize/t._pixelsPerMercatorPixel,0,0);return Nc(h,h,Dp(ws(e)))},a.calculateGlobeMatrix=function(t){const{x:e,y:n}=t.point,{lng:s,lat:h}=t._center;return wm(e,n,t.worldSize,s,h)},a.calculateGlobeMercatorMatrix=function(t){const e=t.pixelsPerMeter,n=e/vl(1,t.center.lat),s=ba(new Float64Array(16));return Bu(s,s,[t.point.x,t.point.y,0]),zc(s,s,[n,n,e]),Float32Array.from(s)},a.circumferenceAtLatitude=Mp,a.clamp=me,a.clearTileCache=function(t){if(!Ni())return;const e=q.caches.delete(hi);t&&e.catch(t).then(()=>t())},a.clipLine=og,a.clone=function(t){var e=new ra(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},a.clone$1=kt,a.collisionCircleLayout=kh,a.config=he,a.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},a.create=function(){var t=new ra(16);return ra!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},a.create$1=pm,a.createExpression=Hi,a.createLayout=di,a.createStyleLayer=function(t){return"custom"===t.type?new Yh(t):new X_[t.type](t)},a.cross=Uc,a.degToRad=ge,a.distance=function(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1],e[2]-t[2])},a.div=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t},a.dot=Ca,a.earthRadius=Id,a.ease=He,a.easeCubicInOut=we,a.ecefToLatLng=function([t,e,n]){const s=Math.hypot(t,e,n),h=Math.atan2(t,n),_=.5*Math.PI-Math.acos(-e/s);return new ur(ke(h),ke(_))},a.emitValidationErrors=ru,a.endsWith=lt,a.enforceCacheSizeLimit=function(t){Ki(),Ii&&Ii.then(e=>{e.keys().then(n=>{for(let s=0;s<n.length-t;s++)e.delete(n[s])})})},a.evaluateSizeForFeature=Ju,a.evaluateSizeForZoom=Tu,a.evaluateVariableOffset=dg,a.evented=nt,a.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},a.exactEquals$1=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},a.exported=mi,a.exported$1=Ie,a.extend=It,a.extend$1=Xr,a.fillExtrusionHeightLift=Zm,a.filterObject=bt,a.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},a.fromQuat=function(t,e){var n=e[0],s=e[1],h=e[2],_=e[3],x=n+n,T=s+s,I=h+h,A=n*x,L=s*x,N=s*T,$=h*x,J=h*T,ee=h*I,ue=_*x,Re=_*T,et=_*I;return t[0]=1-N-ee,t[1]=L+et,t[2]=$-Re,t[3]=0,t[4]=L-et,t[5]=1-A-ee,t[6]=J+ue,t[7]=0,t[8]=$+Re,t[9]=J-ue,t[10]=1-A-N,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},a.fromRotation=function(t,e){var n=Math.sin(e),s=Math.cos(e);return t[0]=s,t[1]=n,t[2]=0,t[3]=-n,t[4]=s,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},a.fromScaling=_d,a.furthestTileCorner=function(t){const e=Math.round((t+45+360)%360/90)%4;return Le[e]},a.getAABBPointSquareDist=function(t,e,n){let s=0;for(let h=0;h<2;++h){const _=n?n[h]:0;t[h]>_&&(s+=(t[h]-_)*(t[h]-_)),e[h]<_&&(s+=(_-e[h])*(_-e[h]))}return s},a.getAnchorAlignment=$h,a.getAnchorJustification=mf,a.getBounds=function(t){let e=1/0,n=1/0,s=-1/0,h=-1/0;for(const _ of t)e=Math.min(e,_.x),n=Math.min(n,_.y),s=Math.max(s,_.x),h=Math.max(h,_.y);return{min:new ne(e,n),max:new ne(s,h)}},a.getColumn=Un,a.getGridMatrix=function(t,e,n,s){const h=e.getNorth(),_=e.getSouth(),x=e.getWest(),T=e.getEast(),I=1<<t.z,A=T-x,L=h-_,N=A/64,$=-L/mh[n],J=[0,N,0,$,0,0,h,x,0];if(t.z>0){const ee=180/s;Zg(J,J,[ee/A+1,0,0,0,ee/L+1,0,-.5*ee/N,.5*ee/$,1])}return J[2]=I,J[5]=t.x,J[8]=t.y,J},a.getImage=mr,a.getJSON=function(t,e){return Wt(It(t,{type:"json"}),e)},a.getLatitudinalLod=function(t){const e=as-5;t=me(t,-e,e)/e*90;const n=Math.pow(Math.abs(Math.sin(ge(t))),3);return Math.round(n*(mh.length-1))},a.getMapSessionAPI=vt,a.getPerformanceMeasurement=jt,a.getProjection=vf,a.getRTLTextPluginStatus=Tt,a.getReferrer=Qe,a.getTilePoint=function(t,{x:e,y:n},s=0){return new ne(((e-s)*t.scale-t.x)*Ei,(n*t.scale-t.y)*Ei)},a.getTileVec3=function(t,e,n=0){return Fl(((e.x-n)*t.scale-t.x)*Ei,(e.y*t.scale-t.y)*Ei,Tm(e.z,e.y))},a.getVideo=function(t,e){const n=q.document.createElement("video");n.muted=!0,n.onloadstart=function(){e(null,n)};for(let s=0;s<t.length;s++){const h=q.document.createElement("source");oi(t[s])||(n.crossOrigin="Anonymous"),h.src=t[s],n.appendChild(h)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(t){const e=[0,0,0],n=ba(new Float64Array(16));return Nc(n,t.pixelMatrix,t.globeMatrix),bo(e,e,n),new ne(e[0],e[1])},a.globeDenormalizeECEF=Dp,a.globeECEFOrigin=function(t,e){const n=[0,0,0];return bo(n,n,Uu(ws(e.canonical))),bo(n,n,t),n},a.globeMetersToEcef=gh,a.globeNormalizeECEF=Uu,a.globePixelsToTileUnits=function(t,e){return Ei/(512*Math.pow(2,t))*Ep(ws(e))},a.globePoleMatrixForTile=function(t,e,n){const s=ba(new Float64Array(16)),h=(e/(1<<t)-.5)*Math.PI*2;return gd(s,n.globeMatrix,h),Float32Array.from(s)},a.globeTileBounds=ws,a.globeTiltAtLngLat=Cm,a.globeToMercatorTransition=Vu,a.globeUseCustomAntiAliasing=function(t,e,n){const s=Vu(n.zoom),h=t.style.map._antialias,_=!!e.extStandardDerivatives,x=e.extStandardDerivativesForceOff||t.terrain&&t.terrain.exaggeration()>0;return 0===s&&!h&&!x&&_},a.identity=ba,a.identity$1=yp,a.invert=fp,a.isFullscreen=function(){return!!q.document.fullscreenElement||!!q.document.webkitFullscreenElement},a.isLngLatBehindGlobe=_h,a.isMapAuthenticated=function(t){return ut.has(t)},a.isMapboxURL=vr,a.isSafariWithAntialiasingBug=function(t){const e=t.navigator?t.navigator.userAgent:null;return!!Qn(t)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=Cs,a.latLngToECEF=Vc,a.len=Gg,a.length=mu,a.length$1=function(t){return Math.hypot(t[0],t[1],t[2],t[3])},a.lngFromMercatorX=ka,a.loadVectorTile=Uf,a.makeRequest=Wt,a.mapValue=function(t,e,n,s,h){return me((t-e)/(n-e)*(h-s)+s,s,h)},a.mercatorScale=Kg,a.mercatorXfromLng=el,a.mercatorYfromLat=yl,a.mercatorZfromAltitude=vl,a.mul=fm,a.mul$1=mp,a.multiply=Nc,a.multiply$1=Zg,a.multiply$2=mm,a.nextPowerOfTwo=St,a.normalize=ss,a.normalize$1=Hg,a.normalize$2=wd,a.number=vi,a.ortho=function(t,e,n,s,h,_,x){var T=1/(e-n),I=1/(s-h),A=1/(_-x);return t[0]=-2*T,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*I,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*A,t[11]=0,t[12]=(e+n)*T,t[13]=(h+s)*I,t[14]=(x+_)*A,t[15]=1,t},a.pbf=Xu,a.perspective=function(t,e,n,s,h){var _,x=1/Math.tan(e/2);return t[0]=x/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=x,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=h&&h!==1/0?(t[10]=(h+s)*(_=1/(s-h)),t[14]=2*h*s*_):(t[10]=-1,t[14]=-2*s),t},a.pick=function(t,e){const n={};for(let s=0;s<e.length;s++){const h=e[s];h in t&&(n[h]=t[h])}return n},a.plugin=At,a.pointGeometry=ne,a.polesInViewport=function(t){const e=ba(new Float64Array(16));Nc(e,t.pixelMatrix,t.globeMatrix);const n=[0,gl,0],s=[0,Fa,0];return bo(n,n,e),bo(s,s,e),[n[0]>0&&n[0]<=t.width&&n[1]>0&&n[1]<=t.height&&!_h(t,new ur(t.center.lat,90)),s[0]>0&&s[0]<=t.width&&s[1]>0&&s[1]<=t.height&&!_h(t,new ur(t.center.lat,-90))]},a.polygonContainsPoint=uc,a.polygonIntersectsBox=Od,a.polygonIntersectsPolygon=Im,a.polygonizeBounds=function(t,e,n=0,s=!0){const h=new ne(n,n),_=t.sub(h),x=e.add(h),T=[_,new ne(x.x,_.y),x,new ne(_.x,x.y)];return s&&T.push(_.clone()),T},a.posAttributes=Cd,a.postMapLoadEvent=De,a.postPerformanceEvent=dt,a.postTurnstileEvent=k,a.potpack=af,a.prevPowerOfTwo=function(t){return t<=1?1:Math.pow(2,Math.floor(Math.log(t)/Math.LN2))},a.radToDeg=ke,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(t){return t({pluginStatus:Ne,pluginURL:ve}),nt.on("pluginStateChange",t),t},a.removeAuthState=function(t){ut.delete(t)},a.renderColorRamp=$c,a.resample=yh,a.rotateX=md,a.rotateX$1=vp,a.rotateY=gd,a.rotateY$1=xp,a.rotateZ=function(t,e,n){var s=Math.sin(n),h=Math.cos(n),_=e[0],x=e[1],T=e[2],I=e[3],A=e[4],L=e[5],N=e[6],$=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=_*h+A*s,t[1]=x*h+L*s,t[2]=T*h+N*s,t[3]=I*h+$*s,t[4]=A*h-_*s,t[5]=L*h-x*s,t[6]=N*h-T*s,t[7]=$*h-I*s,t},a.rotateZ$1=function(t,e,n){n*=.5;var s=e[0],h=e[1],_=e[2],x=e[3],T=Math.sin(n),I=Math.cos(n);return t[0]=s*I+h*T,t[1]=h*I-s*T,t[2]=_*I+x*T,t[3]=x*I-_*T,t},a.scale=zc,a.scale$1=gp,a.scale$2=wa,a.scaleAndAdd=Nu,a.set=function(t,e,n,s){return t[0]=e,t[1]=n,t[2]=s,t},a.setCacheLimits=function(t,e){Bi=t,Mi=e},a.setColumn=function(t,e,n){t[4*e+0]=n[0],t[4*e+1]=n[1],t[4*e+2]=n[2],t[4*e+3]=n[3]},a.setRTLTextPlugin=function(t,e,n=!1){if(Ne===Q||Ne===ye||Ne===be)throw new Error("setRTLTextPlugin cannot be called multiple times.");ve=mi.resolveURL(t),Ne=Q,Oe=e,qe(),n||ft()},a.smoothstep=de,a.spec=Jt,a.squaredLength=function(t){var e=t[0],n=t[1],s=t[2];return e*e+n*n+s*s},a.storeAuthState=function(t,e){e?ut.add(t):ut.delete(t)},a.sub=ml,a.subtract=ph,a.symbolSize=Qp,a.tileAABB=function(t,e,n,s,h,_,x,T,I){if("globe"===I.name)return function xm(t,e,n){const s=e/t.worldSize,h=t.globeMatrix;if(n.z<=1){const Xt=ws(n).getCorners();return Cp(Xt,h,s),oa.fromPoints(Xt)}const _=Tp(n),x=bm(_);Cp(x,h,s);const T=Number.MAX_VALUE,I=[-T,-T,-T],A=[T,T,T];if(_.contains(t.center)){for(const Fn of x)xd(A,A,Fn),bd(I,I,Fn);I[2]=0;const Xt=t.point,mn=[Xt.x*s,Xt.y*s,0];return xd(A,A,mn),bd(I,I,mn),new oa(A,I)}const L=[h[12]*s,h[13]*s,h[14]*s],N=_.getCenter(),$=me(t.center.lat,-as,as),J=me(N.lat,-as,as),ee=el(t.center.lng),ue=yl($);let Re=ee-el(N.lng);const et=ue-yl(J);Re>.5?Re-=1:Re<-.5&&(Re+=1);let pt=0;Math.abs(Re)>Math.abs(et)?pt=Re>=0?1:3:(pt=et>=0?0:2,Nu(L,L,[h[4]*s,h[5]*s,h[6]*s],-Math.sin(ge(et>=0?_.getSouth():_.getNorth()))*lc));const Ye=x[pt],st=x[(pt+1)%4],Ct=new Yg(Ye,st,L),mt=[Td(Ct,0)||Ye[0],Td(Ct,1)||Ye[1],Td(Ct,2)||Ye[2]],Qt=Vu(t.zoom);if(Qt>0){const Xt=function({x:Fn,y:an,z:yn},vn,Pn,kn,ln){const $n=1/(1<<yn);let _i=Fn*$n,Wn=_i+$n,ni=an*$n,Zn=ni+$n,wi=0;const Xi=(_i+Wn)/2-kn;return Xi>.5?wi=-1:Xi<-.5&&(wi=1),_i=((_i+wi)*vn-(kn*=vn))*Pn+kn,Wn=((Wn+wi)*vn-kn)*Pn+kn,ni=(ni*vn-(ln*=vn))*Pn+ln,Zn=(Zn*vn-ln)*Pn+ln,[[_i,Zn,0],[Wn,Zn,0],[Wn,ni,0],[_i,ni,0]]}(n,e,t._pixelsPerMercatorPixel,ee,ue);for(let Fn=0;Fn<x.length;Fn++)_l(x[Fn],Xt[Fn],Qt);const mn=sc([],Xt[pt],Xt[(pt+1)%4]);wa(mn,mn,.5),_l(mt,mn,Qt)}for(const Xt of x)xd(A,A,Xt),bd(I,I,Xt);return A[2]=Math.min(Ye[2],st[2]),xd(A,A,mt),bd(I,I,mt),new oa(A,I)}(t,e,new Rh(n,s,h));const A=Eu({z:n,x:s,y:h},I);return new oa([(_+A.x/A.scale)*e,e*(A.y/A.scale),x],[(_+A.x2/A.scale)*e,e*(A.y2/A.scale),T])},a.tileCornersToBounds=Tp,a.tileTransform=Eu,a.transformMat3=function(t,e,n){var s=e[0],h=e[1],_=e[2];return t[0]=s*n[0]+h*n[3]+_*n[6],t[1]=s*n[1]+h*n[4]+_*n[7],t[2]=s*n[2]+h*n[5]+_*n[8],t},a.transformMat4=bo,a.transformMat4$1=ac,a.transformQuat=gm,a.transitionTileAABBinECEF=wp,a.translate=Bu,a.transpose=function(t,e){if(t===e){var n=e[1],s=e[2],h=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=s,t[7]=h}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},a.triggerPluginCompletionEvent=tt,a.uniqueId=Lt,a.updateGlobeVertexNormal=function(t,e,n,s,h){const _=5*e+2;t.float32[_+0]=n,t.float32[_+1]=s,t.float32[_+2]=h},a.validateCustomStyleLayer=function(t){const e=[],n=t.id;return void 0===n&&e.push({message:`layers.${n}: missing required property "id"`}),void 0===t.render&&e.push({message:`layers.${n}: missing required method "render"`}),t.renderingMode&&"2d"!==t.renderingMode&&"3d"!==t.renderingMode&&e.push({message:`layers.${n}: property "renderingMode" must be either "2d" or "3d"`}),e},a.validateFilter=t=>ks(Sl(t)),a.validateFog=t=>ks(ta(t)),a.validateLayer=t=>ks(Ql(t)),a.validateLight=t=>ks(ns(t)),a.validateSource=t=>ks(Al(t)),a.validateStyle=Ol,a.validateTerrain=t=>ks(Pl(t)),a.values=_t,a.vectorTile=$i,a.version=oe,a.warnOnce=bn,a.window=q,a.wrap=se}),v(0,function(a){function q(z){if("number"==typeof z||"boolean"==typeof z||"string"==typeof z||null==z)return JSON.stringify(z);if(Array.isArray(z)){let X="[";for(const De of z)X+=`${q(De)},`;return`${X}]`}let k="{";for(const X of Object.keys(z).sort())k+=`${X}:${q(z[X])},`;return`${k}}`}function oe(z){let k="";for(const X of a.refProperties)k+=`/${q(z[X])}`;return k}class b{constructor(k){this.keyCache={},k&&this.replace(k)}replace(k){this._layerConfigs={},this._layers={},this.update(k,[])}update(k,X){for(const Ze of k)this._layerConfigs[Ze.id]=Ze,(this._layers[Ze.id]=a.createStyleLayer(Ze)).compileFilter(),this.keyCache[Ze.id]&&delete this.keyCache[Ze.id];for(const Ze of X)delete this.keyCache[Ze],delete this._layerConfigs[Ze],delete this._layers[Ze];this.familiesBySource={};const De=function(Ze,dt){const Ot={};for(let ut=0;ut<Ze.length;ut++){const Fe=dt&&dt[Ze[ut].id]||oe(Ze[ut]);dt&&(dt[Ze[ut].id]=Fe);let Be=Ot[Fe];Be||(Be=Ot[Fe]=[]),Be.push(Ze[ut])}const vt=[];for(const ut in Ot)vt.push(Ot[ut]);return vt}(a.values(this._layerConfigs),this.keyCache);for(const Ze of De){const dt=Ze.map(Me=>this._layers[Me.id]),Ot=dt[0];if("none"===Ot.visibility)continue;const vt=Ot.source||"";let ut=this.familiesBySource[vt];ut||(ut=this.familiesBySource[vt]={});const Fe=Ot.sourceLayer||"_geojsonTileLayer";let Be=ut[Fe];Be||(Be=ut[Fe]=[]),Be.push(dt)}}}class he{loadTile(k,X){const{uid:De,encoding:Ze,rawImageData:dt,padding:Ot,buildQuadTree:vt}=k,ut=a.window.ImageBitmap&&dt instanceof a.window.ImageBitmap?this.getImageData(dt,Ot):dt;X(null,new a.DEMData(De,ut,Ze,Ot<1,vt))}getImageData(k,X){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(k.width,k.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=k.width,this.offscreenCanvas.height=k.height,this.offscreenCanvasContext.drawImage(k,0,0,k.width,k.height);const De=this.offscreenCanvasContext.getImageData(-X,-X,k.width+2*X,k.height+2*X);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),De}}var Ie=function z(k,X){var De,Ze=k&&k.type;if("FeatureCollection"===Ze)for(De=0;De<k.features.length;De++)z(k.features[De],X);else if("GeometryCollection"===Ze)for(De=0;De<k.geometries.length;De++)z(k.geometries[De],X);else if("Feature"===Ze)z(k.geometry,X);else if("Polygon"===Ze)Ve(k.coordinates,X);else if("MultiPolygon"===Ze)for(De=0;De<k.coordinates.length;De++)Ve(k.coordinates[De],X);return k};function Ve(z,k){if(0!==z.length){K(z[0],k);for(var X=1;X<z.length;X++)K(z[X],!k)}}function K(z,k){for(var X=0,De=0,Ze=0,dt=z.length,Ot=dt-1;Ze<dt;Ot=Ze++){var vt=(z[Ze][0]-z[Ot][0])*(z[Ot][1]+z[Ze][1]),ut=X+vt;De+=Math.abs(X)>=Math.abs(vt)?X-ut+vt:vt-ut+X,X=ut}X+De>=0!=!!k&&z.reverse()}const xe=a.VectorTileFeature.prototype.toGeoJSON;class pe{constructor(k){this._feature=k,this.extent=a.EXTENT,this.type=k.type,this.properties=k.tags,"id"in k&&!isNaN(k.id)&&(this.id=parseInt(k.id,10))}loadGeometry(){if(1===this._feature.type){const k=[];for(const X of this._feature.geometry)k.push([new a.pointGeometry(X[0],X[1])]);return k}{const k=[];for(const X of this._feature.geometry){const De=[];for(const Ze of X)De.push(new a.pointGeometry(Ze[0],Ze[1]));k.push(De)}return k}}toGeoJSON(k,X,De){return xe.call(this,k,X,De)}}class ze{constructor(k){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=k.length,this._features=k}feature(k){return new pe(this._features[k])}}var ce={},Ke={get exports(){return ce},set exports(z){ce=z}},Pe=a.pointGeometry,ne=a.vectorTile.VectorTileFeature,Je=Pt;function Pt(z,k){this.options=k||{},this.features=z,this.length=z.length}function at(z,k){this.id="number"==typeof z.id?z.id:void 0,this.type=z.type,this.rawGeometry=1===z.type?[z.geometry]:z.geometry,this.properties=z.tags,this.extent=k||4096}Pt.prototype.feature=function(z){return new at(this.features[z],this.options.extent)},at.prototype.loadGeometry=function(){var z=this.rawGeometry;this.geometry=[];for(var k=0;k<z.length;k++){for(var X=z[k],De=[],Ze=0;Ze<X.length;Ze++)De.push(new Pe(X[Ze][0],X[Ze][1]));this.geometry.push(De)}return this.geometry},at.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var z=this.geometry,k=1/0,X=-1/0,De=1/0,Ze=-1/0,dt=0;dt<z.length;dt++)for(var Ot=z[dt],vt=0;vt<Ot.length;vt++){var ut=Ot[vt];k=Math.min(k,ut.x),X=Math.max(X,ut.x),De=Math.min(De,ut.y),Ze=Math.max(Ze,ut.y)}return[k,De,X,Ze]},at.prototype.toGeoJSON=ne.prototype.toGeoJSON;var ge=a.pbf,ke=Je;function Le(z){var k=new ge;return function(X,De){for(var Ze in X.layers)De.writeMessage(3,we,X.layers[Ze])}(z,k),k.finish()}function we(z,k){var X;k.writeVarintField(15,z.version||1),k.writeStringField(1,z.name||""),k.writeVarintField(5,z.extent||4096);var De={keys:[],values:[],keycache:{},valuecache:{}};for(X=0;X<z.length;X++)De.feature=z.feature(X),k.writeMessage(2,Xe,De);var Ze=De.keys;for(X=0;X<Ze.length;X++)k.writeStringField(3,Ze[X]);var dt=De.values;for(X=0;X<dt.length;X++)k.writeMessage(4,Ee,dt[X])}function Xe(z,k){var X=z.feature;void 0!==X.id&&k.writeVarintField(1,X.id),k.writeMessage(2,He,z),k.writeVarintField(3,X.type),k.writeMessage(4,se,X)}function He(z,k){var X=z.feature,De=z.keys,Ze=z.values,dt=z.keycache,Ot=z.valuecache;for(var vt in X.properties){var ut=X.properties[vt],Fe=dt[vt];if(null!==ut){void 0===Fe&&(De.push(vt),dt[vt]=Fe=De.length-1),k.writeVarint(Fe);var Be=typeof ut;"string"!==Be&&"boolean"!==Be&&"number"!==Be&&(ut=JSON.stringify(ut));var Me=Be+":"+ut,We=Ot[Me];void 0===We&&(Ze.push(ut),Ot[Me]=We=Ze.length-1),k.writeVarint(We)}}}function me(z,k){return(k<<3)+(7&z)}function de(z){return z<<1^z>>31}function se(z,k){for(var X=z.loadGeometry(),De=z.type,Ze=0,dt=0,Ot=X.length,vt=0;vt<Ot;vt++){var ut=X[vt],Fe=1;1===De&&(Fe=ut.length),k.writeVarint(me(1,Fe));for(var Be=3===De?ut.length-1:ut.length,Me=0;Me<Be;Me++){1===Me&&1!==De&&k.writeVarint(me(2,Be-1));var We=ut[Me].x-Ze,jt=ut[Me].y-dt;k.writeVarint(de(We)),k.writeVarint(de(jt)),Ze+=We,dt+=jt}3===De&&k.writeVarint(me(7,1))}}function Ee(z,k){var X=typeof z;"string"===X?k.writeStringField(1,z):"boolean"===X?k.writeBooleanField(7,z):"number"===X&&(z%1!=0?k.writeDoubleField(3,z):z<0?k.writeSVarintField(6,z):k.writeVarintField(5,z))}function _t(z,k,X,De,Ze,dt){if(Ze-De<=X)return;const Ot=De+Ze>>1;It(z,k,Ot,De,Ze,dt%2),_t(z,k,X,De,Ot-1,dt+1),_t(z,k,X,Ot+1,Ze,dt+1)}function It(z,k,X,De,Ze,dt){for(;Ze>De;){if(Ze-De>600){const Fe=Ze-De+1,Be=X-De+1,Me=Math.log(Fe),We=.5*Math.exp(2*Me/3),jt=.5*Math.sqrt(Me*We*(Fe-We)/Fe)*(Be-Fe/2<0?-1:1);It(z,k,X,Math.max(De,Math.floor(X-Be*We/Fe+jt)),Math.min(Ze,Math.floor(X+(Fe-Be)*We/Fe+jt)),dt)}const Ot=k[2*X+dt];let vt=De,ut=Ze;for(Gt(z,k,De,X),k[2*Ze+dt]>Ot&&Gt(z,k,De,Ze);vt<ut;){for(Gt(z,k,vt,ut),vt++,ut--;k[2*vt+dt]<Ot;)vt++;for(;k[2*ut+dt]>Ot;)ut--}k[2*De+dt]===Ot?Gt(z,k,De,ut):(ut++,Gt(z,k,ut,Ze)),ut<=X&&(De=ut+1),X<=ut&&(Ze=ut-1)}}function Gt(z,k,X,De){Lt(z,X,De),Lt(k,2*X,2*De),Lt(k,2*X+1,2*De+1)}function Lt(z,k,X){const De=z[k];z[k]=z[X],z[X]=De}function yt(z,k,X,De){const Ze=z-X,dt=k-De;return Ze*Ze+dt*dt}Ke.exports=Le,ce.fromVectorTileJs=Le,ce.fromGeojsonVt=function(z,k){k=k||{};var X={};for(var De in z)X[De]=new ke(z[De].features,k),X[De].name=De,X[De].version=k.version,X[De].extent=k.extent;return Le({layers:X})},ce.GeoJSONWrapper=ke;const St=z=>z[0],xt=z=>z[1];class rt{constructor(k,X=St,De=xt,Ze=64,dt=Float64Array){this.nodeSize=Ze,this.points=k;const Ot=k.length<65536?Uint16Array:Uint32Array,vt=this.ids=new Ot(k.length),ut=this.coords=new dt(2*k.length);for(let Fe=0;Fe<k.length;Fe++)vt[Fe]=Fe,ut[2*Fe]=X(k[Fe]),ut[2*Fe+1]=De(k[Fe]);_t(vt,ut,Ze,0,vt.length-1,0)}range(k,X,De,Ze){return function(dt,Ot,vt,ut,Fe,Be,Me){const We=[0,dt.length-1,0],jt=[];let dn,Tn;for(;We.length;){const qn=We.pop(),Yn=We.pop(),mi=We.pop();if(Yn-mi<=Me){for(let Li=mi;Li<=Yn;Li++)dn=Ot[2*Li],Tn=Ot[2*Li+1],dn>=vt&&dn<=Fe&&Tn>=ut&&Tn<=Be&&jt.push(dt[Li]);continue}const ei=Math.floor((mi+Yn)/2);dn=Ot[2*ei],Tn=Ot[2*ei+1],dn>=vt&&dn<=Fe&&Tn>=ut&&Tn<=Be&&jt.push(dt[ei]);const Oi=(qn+1)%2;(0===qn?vt<=dn:ut<=Tn)&&(We.push(mi),We.push(ei-1),We.push(Oi)),(0===qn?Fe>=dn:Be>=Tn)&&(We.push(ei+1),We.push(Yn),We.push(Oi))}return jt}(this.ids,this.coords,k,X,De,Ze,this.nodeSize)}within(k,X,De){return function(Ze,dt,Ot,vt,ut,Fe){const Be=[0,Ze.length-1,0],Me=[],We=ut*ut;for(;Be.length;){const jt=Be.pop(),dn=Be.pop(),Tn=Be.pop();if(dn-Tn<=Fe){for(let Oi=Tn;Oi<=dn;Oi++)yt(dt[2*Oi],dt[2*Oi+1],Ot,vt)<=We&&Me.push(Ze[Oi]);continue}const qn=Math.floor((Tn+dn)/2),Yn=dt[2*qn],mi=dt[2*qn+1];yt(Yn,mi,Ot,vt)<=We&&Me.push(Ze[qn]);const ei=(jt+1)%2;(0===jt?Ot-ut<=Yn:vt-ut<=mi)&&(Be.push(Tn),Be.push(qn-1),Be.push(ei)),(0===jt?Ot+ut>=Yn:vt+ut>=mi)&&(Be.push(qn+1),Be.push(dn),Be.push(ei))}return Me}(this.ids,this.coords,k,X,De,this.nodeSize)}}const lt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:z=>z},Ce=Math.fround||(bt=new Float32Array(1),z=>(bt[0]=+z,bt[0]));var bt;class kt{constructor(k){this.options=Qn(Object.create(lt),k),this.trees=new Array(this.options.maxZoom+1)}load(k){const{log:X,minZoom:De,maxZoom:Ze,nodeSize:dt}=this.options;X&&console.time("total time");const Ot=`prepare ${k.length} points`;X&&console.time(Ot),this.points=k;let vt=[];for(let ut=0;ut<k.length;ut++)k[ut].geometry&&vt.push(bn(k[ut],ut));this.trees[Ze+1]=new rt(vt,ci,Un,dt,Float32Array),X&&console.timeEnd(Ot);for(let ut=Ze;ut>=De;ut--){const Fe=+Date.now();vt=this._cluster(vt,ut),this.trees[ut]=new rt(vt,ci,Un,dt,Float32Array),X&&console.log("z%d: %d clusters in %dms",ut,vt.length,+Date.now()-Fe)}return X&&console.timeEnd("total time"),this}getClusters(k,X){let De=((k[0]+180)%360+360)%360-180;const Ze=Math.max(-90,Math.min(90,k[1]));let dt=180===k[2]?180:((k[2]+180)%360+360)%360-180;const Ot=Math.max(-90,Math.min(90,k[3]));if(k[2]-k[0]>=360)De=-180,dt=180;else if(De>dt){const Be=this.getClusters([De,Ze,180,Ot],X),Me=this.getClusters([-180,Ze,dt,Ot],X);return Be.concat(Me)}const vt=this.trees[this._limitZoom(X)],ut=vt.range(ot(De),Bt(Ot),ot(dt),Bt(Ze)),Fe=[];for(const Be of ut){const Me=vt.points[Be];Fe.push(Me.numPoints?Nn(Me):this.points[Me.index])}return Fe}getChildren(k){const X=this._getOriginId(k),De=this._getOriginZoom(k),Ze="No cluster with the specified id.",dt=this.trees[De];if(!dt)throw new Error(Ze);const Ot=dt.points[X];if(!Ot)throw new Error(Ze);const vt=this.options.radius/(this.options.extent*Math.pow(2,De-1)),ut=dt.within(Ot.x,Ot.y,vt),Fe=[];for(const Be of ut){const Me=dt.points[Be];Me.parentId===k&&Fe.push(Me.numPoints?Nn(Me):this.points[Me.index])}if(0===Fe.length)throw new Error(Ze);return Fe}getLeaves(k,X,De){const Ze=[];return this._appendLeaves(Ze,k,X=X||10,De=De||0,0),Ze}getTile(k,X,De){const Ze=this.trees[this._limitZoom(k)],dt=Math.pow(2,k),{extent:Ot,radius:vt}=this.options,ut=vt/Ot,Fe=(De-ut)/dt,Be=(De+1+ut)/dt,Me={features:[]};return this._addTileFeatures(Ze.range((X-ut)/dt,Fe,(X+1+ut)/dt,Be),Ze.points,X,De,dt,Me),0===X&&this._addTileFeatures(Ze.range(1-ut/dt,Fe,1,Be),Ze.points,dt,De,dt,Me),X===dt-1&&this._addTileFeatures(Ze.range(0,Fe,ut/dt,Be),Ze.points,-1,De,dt,Me),Me.features.length?Me:null}getClusterExpansionZoom(k){let X=this._getOriginZoom(k)-1;for(;X<=this.options.maxZoom;){const De=this.getChildren(k);if(X++,1!==De.length)break;k=De[0].properties.cluster_id}return X}_appendLeaves(k,X,De,Ze,dt){const Ot=this.getChildren(X);for(const vt of Ot){const ut=vt.properties;if(ut&&ut.cluster?dt+ut.point_count<=Ze?dt+=ut.point_count:dt=this._appendLeaves(k,ut.cluster_id,De,Ze,dt):dt<Ze?dt++:k.push(vt),k.length===De)break}return dt}_addTileFeatures(k,X,De,Ze,dt,Ot){for(const vt of k){const ut=X[vt],Fe=ut.numPoints;let Be,Me,We;if(Fe)Be=un(ut),Me=ut.x,We=ut.y;else{const Tn=this.points[ut.index];Be=Tn.properties,Me=ot(Tn.geometry.coordinates[0]),We=Bt(Tn.geometry.coordinates[1])}const jt={type:1,geometry:[[Math.round(this.options.extent*(Me*dt-De)),Math.round(this.options.extent*(We*dt-Ze))]],tags:Be};let dn;Fe?dn=ut.id:this.options.generateId?dn=ut.index:this.points[ut.index].id&&(dn=this.points[ut.index].id),void 0!==dn&&(jt.id=dn),Ot.features.push(jt)}}_limitZoom(k){return Math.max(this.options.minZoom,Math.min(Math.floor(+k),this.options.maxZoom+1))}_cluster(k,X){const De=[],{radius:Ze,extent:dt,reduce:Ot,minPoints:vt}=this.options,ut=Ze/(dt*Math.pow(2,X));for(let Fe=0;Fe<k.length;Fe++){const Be=k[Fe];if(Be.zoom<=X)continue;Be.zoom=X;const Me=this.trees[X+1],We=Me.within(Be.x,Be.y,ut),jt=Be.numPoints||1;let dn=jt;for(const Tn of We){const qn=Me.points[Tn];qn.zoom>X&&(dn+=qn.numPoints||1)}if(dn>jt&&dn>=vt){let Tn=Be.x*jt,qn=Be.y*jt,Yn=Ot&&jt>1?this._map(Be,!0):null;const mi=(Fe<<5)+(X+1)+this.points.length;for(const ei of We){const Oi=Me.points[ei];if(Oi.zoom<=X)continue;Oi.zoom=X;const Li=Oi.numPoints||1;Tn+=Oi.x*Li,qn+=Oi.y*Li,Oi.parentId=mi,Ot&&(Yn||(Yn=this._map(Be,!0)),Ot(Yn,this._map(Oi)))}Be.parentId=mi,De.push(Ut(Tn/dn,qn/dn,mi,dn,Yn))}else if(De.push(Be),dn>1)for(const Tn of We){const qn=Me.points[Tn];qn.zoom<=X||(qn.zoom=X,De.push(qn))}}return De}_getOriginId(k){return k-this.points.length>>5}_getOriginZoom(k){return(k-this.points.length)%32}_map(k,X){if(k.numPoints)return X?Qn({},k.properties):k.properties;const De=this.points[k.index].properties,Ze=this.options.map(De);return X&&Ze===De?Qn({},Ze):Ze}}function Ut(z,k,X,De,Ze){return{x:Ce(z),y:Ce(k),zoom:1/0,id:X,parentId:-1,numPoints:De,properties:Ze}}function bn(z,k){const[X,De]=z.geometry.coordinates;return{x:Ce(ot(X)),y:Ce(Bt(De)),zoom:1/0,index:k,parentId:-1}}function Nn(z){return{type:"Feature",id:z.id,properties:un(z),geometry:{type:"Point",coordinates:[(k=z.x,360*(k-.5)),Sn(z.y)]}};var k}function un(z){const k=z.numPoints,X=k>=1e4?`${Math.round(k/1e3)}k`:k>=1e3?Math.round(k/100)/10+"k":k;return Qn(Qn({},z.properties),{cluster:!0,cluster_id:z.id,point_count:k,point_count_abbreviated:X})}function ot(z){return z/360+.5}function Bt(z){const k=Math.sin(z*Math.PI/180),X=.5-.25*Math.log((1+k)/(1-k))/Math.PI;return X<0?0:X>1?1:X}function Sn(z){const k=(180-360*z)*Math.PI/180;return 360*Math.atan(Math.exp(k))/Math.PI-90}function Qn(z,k){for(const X in k)z[X]=k[X];return z}function ci(z){return z.x}function Un(z){return z.y}function hi(z,k,X,De){for(var Ze,dt=De,Ot=X-k>>1,vt=X-k,ut=z[k],Fe=z[k+1],Be=z[X],Me=z[X+1],We=k+3;We<X;We+=3){var jt=Ii(z[We],z[We+1],ut,Fe,Be,Me);if(jt>dt)Ze=We,dt=jt;else if(jt===dt){var dn=Math.abs(We-Ot);dn<vt&&(Ze=We,vt=dn)}}dt>De&&(Ze-k>3&&hi(z,k,Ze,De),z[Ze+2]=dt,X-Ze>3&&hi(z,Ze,X,De))}function Ii(z,k,X,De,Ze,dt){var Ot=Ze-X,vt=dt-De;if(0!==Ot||0!==vt){var ut=((z-X)*Ot+(k-De)*vt)/(Ot*Ot+vt*vt);ut>1?(X=Ze,De=dt):ut>0&&(X+=Ot*ut,De+=vt*ut)}return(Ot=z-X)*Ot+(vt=k-De)*vt}function yi(z,k,X,De){var Ze={id:void 0===z?null:z,type:k,geometry:X,tags:De,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(dt){var Ot=dt.geometry,vt=dt.type;if("Point"===vt||"MultiPoint"===vt||"LineString"===vt)Bi(dt,Ot);else if("Polygon"===vt||"MultiLineString"===vt)for(var ut=0;ut<Ot.length;ut++)Bi(dt,Ot[ut]);else if("MultiPolygon"===vt)for(ut=0;ut<Ot.length;ut++)for(var Fe=0;Fe<Ot[ut].length;Fe++)Bi(dt,Ot[ut][Fe])}(Ze),Ze}function Bi(z,k){for(var X=0;X<k.length;X+=3)z.minX=Math.min(z.minX,k[X]),z.minY=Math.min(z.minY,k[X+1]),z.maxX=Math.max(z.maxX,k[X]),z.maxY=Math.max(z.maxY,k[X+1])}function Mi(z,k,X,De){if(k.geometry){var Ze=k.geometry.coordinates,dt=k.geometry.type,Ot=Math.pow(X.tolerance/((1<<X.maxZoom)*X.extent),2),vt=[],ut=k.id;if(X.promoteId?ut=k.properties[X.promoteId]:X.generateId&&(ut=De||0),"Point"===dt)Ni(Ze,vt);else if("MultiPoint"===dt)for(var Fe=0;Fe<Ze.length;Fe++)Ni(Ze[Fe],vt);else if("LineString"===dt)Ki(Ze,vt,Ot,!1);else if("MultiLineString"===dt){if(X.lineMetrics){for(Fe=0;Fe<Ze.length;Fe++)Ki(Ze[Fe],vt=[],Ot,!1),z.push(yi(ut,"LineString",vt,k.properties));return}Vt(Ze,vt,Ot,!1)}else if("Polygon"===dt)Vt(Ze,vt,Ot,!0);else{if("MultiPolygon"!==dt){if("GeometryCollection"===dt){for(Fe=0;Fe<k.geometry.geometries.length;Fe++)Mi(z,{id:ut,geometry:k.geometry.geometries[Fe],properties:k.properties},X,De);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Fe=0;Fe<Ze.length;Fe++){var Be=[];Vt(Ze[Fe],Be,Ot,!0),vt.push(Be)}}z.push(yi(ut,dt,vt,k.properties))}}function Ni(z,k){k.push(Mt(z[0])),k.push(Ge(z[1])),k.push(0)}function Ki(z,k,X,De){for(var Ze,dt,Ot=0,vt=0;vt<z.length;vt++){var ut=Mt(z[vt][0]),Fe=Ge(z[vt][1]);k.push(ut),k.push(Fe),k.push(0),vt>0&&(Ot+=De?(Ze*Fe-ut*dt)/2:Math.sqrt(Math.pow(ut-Ze,2)+Math.pow(Fe-dt,2))),Ze=ut,dt=Fe}var Be=k.length-3;k[2]=1,hi(k,0,Be,X),k[Be+2]=1,k.size=Math.abs(Ot),k.start=0,k.end=k.size}function Vt(z,k,X,De){for(var Ze=0;Ze<z.length;Ze++){var dt=[];Ki(z[Ze],dt,X,De),k.push(dt)}}function Mt(z){return z/360+.5}function Ge(z){var k=Math.sin(z*Math.PI/180),X=.5-.25*Math.log((1+k)/(1-k))/Math.PI;return X<0?0:X>1?1:X}function ie(z,k,X,De,Ze,dt,Ot,vt){if(De/=k,dt>=(X/=k)&&Ot<De)return z;if(Ot<X||dt>=De)return null;for(var ut=[],Fe=0;Fe<z.length;Fe++){var Be=z[Fe],Me=Be.geometry,We=Be.type,jt=0===Ze?Be.minX:Be.minY,dn=0===Ze?Be.maxX:Be.maxY;if(jt>=X&&dn<De)ut.push(Be);else if(!(dn<X||jt>=De)){var Tn=[];if("Point"===We||"MultiPoint"===We)Qe(Me,Tn,X,De,Ze);else if("LineString"===We)Wt(Me,Tn,X,De,Ze,!1,vt.lineMetrics);else if("MultiLineString"===We)oi(Me,Tn,X,De,Ze,!1);else if("Polygon"===We)oi(Me,Tn,X,De,Ze,!0);else if("MultiPolygon"===We)for(var qn=0;qn<Me.length;qn++){var Yn=[];oi(Me[qn],Yn,X,De,Ze,!0),Yn.length&&Tn.push(Yn)}if(Tn.length){if(vt.lineMetrics&&"LineString"===We){for(qn=0;qn<Tn.length;qn++)ut.push(yi(Be.id,We,Tn[qn],Be.tags));continue}"LineString"!==We&&"MultiLineString"!==We||(1===Tn.length?(We="LineString",Tn=Tn[0]):We="MultiLineString"),"Point"!==We&&"MultiPoint"!==We||(We=3===Tn.length?"Point":"MultiPoint"),ut.push(yi(Be.id,We,Tn,Be.tags))}}}return ut.length?ut:null}function Qe(z,k,X,De,Ze){for(var dt=0;dt<z.length;dt+=3){var Ot=z[dt+Ze];Ot>=X&&Ot<=De&&(k.push(z[dt]),k.push(z[dt+1]),k.push(z[dt+2]))}}function Wt(z,k,X,De,Ze,dt,Ot){for(var vt,ut,Fe=rn(z),Be=0===Ze?ar:pi,Me=z.start,We=0;We<z.length-3;We+=3){var jt=z[We],dn=z[We+1],Tn=z[We+2],qn=z[We+3],Yn=z[We+4],mi=0===Ze?jt:dn,ei=0===Ze?qn:Yn,Oi=!1;Ot&&(vt=Math.sqrt(Math.pow(jt-qn,2)+Math.pow(dn-Yn,2))),mi<X?ei>X&&(ut=Be(Fe,jt,dn,qn,Yn,X),Ot&&(Fe.start=Me+vt*ut)):mi>De?ei<De&&(ut=Be(Fe,jt,dn,qn,Yn,De),Ot&&(Fe.start=Me+vt*ut)):Di(Fe,jt,dn,Tn),ei<X&&mi>=X&&(ut=Be(Fe,jt,dn,qn,Yn,X),Oi=!0),ei>De&&mi<=De&&(ut=Be(Fe,jt,dn,qn,Yn,De),Oi=!0),!dt&&Oi&&(Ot&&(Fe.end=Me+vt*ut),k.push(Fe),Fe=rn(z)),Ot&&(Me+=vt)}var Li=z.length-3;jt=z[Li],dn=z[Li+1],Tn=z[Li+2],(mi=0===Ze?jt:dn)>=X&&mi<=De&&Di(Fe,jt,dn,Tn),Li=Fe.length-3,dt&&Li>=3&&(Fe[Li]!==Fe[0]||Fe[Li+1]!==Fe[1])&&Di(Fe,Fe[0],Fe[1],Fe[2]),Fe.length&&k.push(Fe)}function rn(z){var k=[];return k.size=z.size,k.start=z.start,k.end=z.end,k}function oi(z,k,X,De,Ze,dt){for(var Ot=0;Ot<z.length;Ot++)Wt(z[Ot],k,X,De,Ze,dt,!1)}function Di(z,k,X,De){z.push(k),z.push(X),z.push(De)}function ar(z,k,X,De,Ze,dt){var Ot=(dt-k)/(De-k);return z.push(dt),z.push(X+(Ze-X)*Ot),z.push(1),Ot}function pi(z,k,X,De,Ze,dt){var Ot=(dt-X)/(Ze-X);return z.push(k+(De-k)*Ot),z.push(dt),z.push(1),Ot}function mr(z,k){for(var X=[],De=0;De<z.length;De++){var Ze,dt=z[De],Ot=dt.type;if("Point"===Ot||"MultiPoint"===Ot||"LineString"===Ot)Ze=Si(dt.geometry,k);else if("MultiLineString"===Ot||"Polygon"===Ot){Ze=[];for(var vt=0;vt<dt.geometry.length;vt++)Ze.push(Si(dt.geometry[vt],k))}else if("MultiPolygon"===Ot)for(Ze=[],vt=0;vt<dt.geometry.length;vt++){for(var ut=[],Fe=0;Fe<dt.geometry[vt].length;Fe++)ut.push(Si(dt.geometry[vt][Fe],k));Ze.push(ut)}X.push(yi(dt.id,Ot,Ze,dt.tags))}return X}function Si(z,k){var X=[];X.size=z.size,void 0!==z.start&&(X.start=z.start,X.end=z.end);for(var De=0;De<z.length;De+=3)X.push(z[De]+k,z[De+1],z[De+2]);return X}function vr(z,k){if(z.transformed)return z;var X,De,Ze,dt=1<<z.z,Ot=z.x,vt=z.y;for(X=0;X<z.features.length;X++){var ut=z.features[X],Fe=ut.geometry,Be=ut.type;if(ut.geometry=[],1===Be)for(De=0;De<Fe.length;De+=2)ut.geometry.push(xr(Fe[De],Fe[De+1],k,dt,Ot,vt));else for(De=0;De<Fe.length;De++){var Me=[];for(Ze=0;Ze<Fe[De].length;Ze+=2)Me.push(xr(Fe[De][Ze],Fe[De][Ze+1],k,dt,Ot,vt));ut.geometry.push(Me)}}return z.transformed=!0,z}function xr(z,k,X,De,Ze,dt){return[Math.round(X*(z*De-Ze)),Math.round(X*(k*De-dt))]}function gr(z,k,X,De,Ze){for(var dt=k===Ze.maxZoom?0:Ze.tolerance/((1<<k)*Ze.extent),Ot={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:X,y:De,z:k,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},vt=0;vt<z.length;vt++){Ot.numFeatures++,ui(Ot,z[vt],dt,Ze);var ut=z[vt].minX,Fe=z[vt].minY,Be=z[vt].maxX,Me=z[vt].maxY;ut<Ot.minX&&(Ot.minX=ut),Fe<Ot.minY&&(Ot.minY=Fe),Be>Ot.maxX&&(Ot.maxX=Be),Me>Ot.maxY&&(Ot.maxY=Me)}return Ot}function ui(z,k,X,De){var Ze=k.geometry,dt=k.type,Ot=[];if("Point"===dt||"MultiPoint"===dt)for(var vt=0;vt<Ze.length;vt+=3)Ot.push(Ze[vt]),Ot.push(Ze[vt+1]),z.numPoints++,z.numSimplified++;else if("LineString"===dt)pn(Ot,Ze,z,X,!1,!1);else if("MultiLineString"===dt||"Polygon"===dt)for(vt=0;vt<Ze.length;vt++)pn(Ot,Ze[vt],z,X,"Polygon"===dt,0===vt);else if("MultiPolygon"===dt)for(var ut=0;ut<Ze.length;ut++){var Fe=Ze[ut];for(vt=0;vt<Fe.length;vt++)pn(Ot,Fe[vt],z,X,!0,0===vt)}if(Ot.length){var Be=k.tags||null;if("LineString"===dt&&De.lineMetrics){for(var Me in Be={},k.tags)Be[Me]=k.tags[Me];Be.mapbox_clip_start=Ze.start/Ze.size,Be.mapbox_clip_end=Ze.end/Ze.size}var We={geometry:Ot,type:"Polygon"===dt||"MultiPolygon"===dt?3:"LineString"===dt||"MultiLineString"===dt?2:1,tags:Be};null!==k.id&&(We.id=k.id),z.features.push(We)}}function pn(z,k,X,De,Ze,dt){var Ot=De*De;if(De>0&&k.size<(Ze?Ot:De))X.numPoints+=k.length/3;else{for(var vt=[],ut=0;ut<k.length;ut+=3)(0===De||k[ut+2]>Ot)&&(X.numSimplified++,vt.push(k[ut]),vt.push(k[ut+1])),X.numPoints++;Ze&&function(Fe,Be){for(var Me=0,We=0,jt=Fe.length,dn=jt-2;We<jt;dn=We,We+=2)Me+=(Fe[We]-Fe[dn])*(Fe[We+1]+Fe[dn+1]);if(Me>0===Be)for(We=0,jt=Fe.length;We<jt/2;We+=2){var Tn=Fe[We],qn=Fe[We+1];Fe[We]=Fe[jt-2-We],Fe[We+1]=Fe[jt-1-We],Fe[jt-2-We]=Tn,Fe[jt-1-We]=qn}}(vt,dt),z.push(vt)}}function wt(z,k){var X=(k=this.options=function(Ze,dt){for(var Ot in dt)Ze[Ot]=dt[Ot];return Ze}(Object.create(this.options),k)).debug;if(X&&console.time("preprocess data"),k.maxZoom<0||k.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(k.promoteId&&k.generateId)throw new Error("promoteId and generateId cannot be used together.");var Ze,dt,Ot,vt,ut,Fe,De=function(Ze,dt){var Ot=[];if("FeatureCollection"===Ze.type)for(var vt=0;vt<Ze.features.length;vt++)Mi(Ot,Ze.features[vt],dt,vt);else Mi(Ot,"Feature"===Ze.type?Ze:{geometry:Ze},dt);return Ot}(z,k);this.tiles={},this.tileCoords=[],X&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",k.indexMaxZoom,k.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),vt=Ze=De,ut=ie(Ze,1,-1-(Ot=(dt=k).buffer/dt.extent),Ot,0,-1,2,dt),Fe=ie(Ze,1,1-Ot,2+Ot,0,-1,2,dt),(ut||Fe)&&(vt=ie(Ze,1,-Ot,1+Ot,0,-1,2,dt)||[],ut&&(vt=mr(ut,1).concat(vt)),Fe&&(vt=vt.concat(mr(Fe,-1)))),(De=vt).length&&this.splitTile(De,0,0,0),X&&(De.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function Rt(z,k,X){return 32*((1<<z)*X+k)+z}function _n(z,k){const X=z.tileID.canonical;if(!this._geoJSONIndex)return k(null,null);const De=this._geoJSONIndex.getTile(X.z,X.x,X.y);if(!De)return k(null,null);const Ze=new ze(De.features);let dt=ce(Ze);0===dt.byteOffset&&dt.byteLength===dt.buffer.byteLength||(dt=new Uint8Array(dt)),k(null,{vectorTile:Ze,rawData:dt.buffer})}wt.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},wt.prototype.splitTile=function(z,k,X,De,Ze,dt,Ot){for(var vt=[z,k,X,De],ut=this.options,Fe=ut.debug;vt.length;){De=vt.pop(),X=vt.pop(),k=vt.pop(),z=vt.pop();var Be=1<<k,Me=Rt(k,X,De),We=this.tiles[Me];if(!We&&(Fe>1&&console.time("creation"),We=this.tiles[Me]=gr(z,k,X,De,ut),this.tileCoords.push({z:k,x:X,y:De}),Fe)){Fe>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",k,X,De,We.numFeatures,We.numPoints,We.numSimplified),console.timeEnd("creation"));var jt="z"+k;this.stats[jt]=(this.stats[jt]||0)+1,this.total++}if(We.source=z,Ze){if(k===ut.maxZoom||k===Ze)continue;var dn=1<<Ze-k;if(X!==Math.floor(dt/dn)||De!==Math.floor(Ot/dn))continue}else if(k===ut.indexMaxZoom||We.numPoints<=ut.indexMaxPoints)continue;if(We.source=null,0!==z.length){Fe>1&&console.time("clipping");var Tn,qn,Yn,mi,ei,Oi,Li=.5*ut.buffer/ut.extent,Er=.5-Li,Gr=.5+Li,Jt=1+Li;Tn=qn=Yn=mi=null,ei=ie(z,Be,X-Li,X+Gr,0,We.minX,We.maxX,ut),Oi=ie(z,Be,X+Er,X+Jt,0,We.minX,We.maxX,ut),z=null,ei&&(Tn=ie(ei,Be,De-Li,De+Gr,1,We.minY,We.maxY,ut),qn=ie(ei,Be,De+Er,De+Jt,1,We.minY,We.maxY,ut),ei=null),Oi&&(Yn=ie(Oi,Be,De-Li,De+Gr,1,We.minY,We.maxY,ut),mi=ie(Oi,Be,De+Er,De+Jt,1,We.minY,We.maxY,ut),Oi=null),Fe>1&&console.timeEnd("clipping"),vt.push(Tn||[],k+1,2*X,2*De),vt.push(qn||[],k+1,2*X,2*De+1),vt.push(Yn||[],k+1,2*X+1,2*De),vt.push(mi||[],k+1,2*X+1,2*De+1)}}},wt.prototype.getTile=function(z,k,X){var De=this.options,Ze=De.extent,dt=De.debug;if(z<0||z>24)return null;var Ot=1<<z,vt=Rt(z,k=(k%Ot+Ot)%Ot,X);if(this.tiles[vt])return vr(this.tiles[vt],Ze);dt>1&&console.log("drilling down to z%d-%d-%d",z,k,X);for(var ut,Fe=z,Be=k,Me=X;!ut&&Fe>0;)Fe--,Be=Math.floor(Be/2),Me=Math.floor(Me/2),ut=this.tiles[Rt(Fe,Be,Me)];return ut&&ut.source?(dt>1&&console.log("found parent tile z%d-%d-%d",Fe,Be,Me),dt>1&&console.time("drilling down"),this.splitTile(ut.source,Fe,Be,Me,z,k,X),dt>1&&console.timeEnd("drilling down"),this.tiles[vt]?vr(this.tiles[vt],Ze):null):null};class Ue extends a.VectorTileWorkerSource{constructor(k,X,De,Ze,dt){super(k,X,De,Ze,_n),dt&&(this.loadGeoJSON=dt)}loadData(k,X){const De=k&&k.request,Ze=De&&De.collectResourceTiming;this.loadGeoJSON(k,(dt,Ot)=>{if(dt||!Ot)return X(dt);if("object"!=typeof Ot)return X(new Error(`Input data given to '${k.source}' is not a valid GeoJSON object.`));{Ie(Ot,!0);try{if(k.filter){const ut=a.createExpression(k.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===ut.result)throw new Error(ut.value.map(Be=>`${Be.key}: ${Be.message}`).join(", "));Ot={type:"FeatureCollection",features:Ot.features.filter(Be=>ut.value.evaluate({zoom:0},Be))}}this._geoJSONIndex=k.cluster?new kt(function({superclusterOptions:ut,clusterProperties:Fe}){if(!Fe||!ut)return ut;const Be={},Me={},We={accumulated:null,zoom:0},jt={properties:null},dn=Object.keys(Fe);for(const Tn of dn){const[qn,Yn]=Fe[Tn],mi=a.createExpression(Yn),ei=a.createExpression("string"==typeof qn?[qn,["accumulated"],["get",Tn]]:qn);Be[Tn]=mi.value,Me[Tn]=ei.value}return ut.map=Tn=>{jt.properties=Tn;const qn={};for(const Yn of dn)qn[Yn]=Be[Yn].evaluate(We,jt);return qn},ut.reduce=(Tn,qn)=>{jt.properties=qn;for(const Yn of dn)We.accumulated=Tn[Yn],Tn[Yn]=Me[Yn].evaluate(We,jt)},ut}(k)).load(Ot.features):new wt(ut=Ot,k.geojsonVtOptions)}catch(ut){return X(ut)}this.loaded={};const vt={};if(Ze){const ut=a.getPerformanceMeasurement(De);ut&&(vt.resourceTiming={},vt.resourceTiming[k.source]=JSON.parse(JSON.stringify(ut)))}X(null,vt)}var ut})}reloadTile(k,X){const De=this.loaded;return De&&De[k.uid]?super.reloadTile(k,X):this.loadTile(k,X)}loadGeoJSON(k,X){if(k.request)a.getJSON(k.request,X);else{if("string"!=typeof k.data)return X(new Error(`Input data given to '${k.source}' is not a valid GeoJSON object.`));try{return X(null,JSON.parse(k.data))}catch{return X(new Error(`Input data given to '${k.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(k,X){try{X(null,this._geoJSONIndex.getClusterExpansionZoom(k.clusterId))}catch(De){X(De)}}getClusterChildren(k,X){try{X(null,this._geoJSONIndex.getChildren(k.clusterId))}catch(De){X(De)}}getClusterLeaves(k,X){try{X(null,this._geoJSONIndex.getLeaves(k.clusterId,k.limit,k.offset))}catch(De){X(De)}}}class Ht{constructor(k){this.self=k,this.actor=new a.Actor(k,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:Ue},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(X,De)=>{if(this.workerSourceTypes[X])throw new Error(`Worker source with name "${X}" already registered.`);this.workerSourceTypes[X]=De},this.self.registerRTLTextPlugin=X=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=X.applyArabicShaping,a.plugin.processBidirectionalText=X.processBidirectionalText,a.plugin.processStyledBidirectionalText=X.processStyledBidirectionalText}}clearCaches(k,X,De){delete this.layerIndexes[k],delete this.availableImages[k],delete this.workerSources[k],delete this.demWorkerSources[k],De()}checkIfReady(k,X,De){De()}setReferrer(k,X){this.referrer=X}spriteLoaded(k,X){this.isSpriteLoaded[k]=X;for(const De in this.workerSources[k]){const Ze=this.workerSources[k][De];for(const dt in Ze)Ze[dt]instanceof a.VectorTileWorkerSource&&(Ze[dt].isSpriteLoaded=X,Ze[dt].fire(new a.Event("isSpriteLoaded")))}}setImages(k,X,De){this.availableImages[k]=X;for(const Ze in this.workerSources[k]){const dt=this.workerSources[k][Ze];for(const Ot in dt)dt[Ot].availableImages=X}De()}enableTerrain(k,X,De){this.terrain=X,De()}setProjection(k,X){this.projections[k]=a.getProjection(X)}setLayers(k,X,De){this.getLayerIndex(k).replace(X),De()}updateLayers(k,X,De){this.getLayerIndex(k).update(X.layers,X.removedIds),De()}loadTile(k,X,De){const Ze=this.enableTerrain?a.extend({enableTerrain:this.terrain},X):X;Ze.projection=this.projections[k]||this.defaultProjection,this.getWorkerSource(k,X.type,X.source).loadTile(Ze,De)}loadDEMTile(k,X,De){const Ze=this.enableTerrain?a.extend({buildQuadTree:this.terrain},X):X;this.getDEMWorkerSource(k,X.source).loadTile(Ze,De)}reloadTile(k,X,De){const Ze=this.enableTerrain?a.extend({enableTerrain:this.terrain},X):X;Ze.projection=this.projections[k]||this.defaultProjection,this.getWorkerSource(k,X.type,X.source).reloadTile(Ze,De)}abortTile(k,X,De){this.getWorkerSource(k,X.type,X.source).abortTile(X,De)}removeTile(k,X,De){this.getWorkerSource(k,X.type,X.source).removeTile(X,De)}removeSource(k,X,De){if(!this.workerSources[k]||!this.workerSources[k][X.type]||!this.workerSources[k][X.type][X.source])return;const Ze=this.workerSources[k][X.type][X.source];delete this.workerSources[k][X.type][X.source],void 0!==Ze.removeSource?Ze.removeSource(X,De):De()}loadWorkerSource(k,X,De){try{this.self.importScripts(X.url),De()}catch(Ze){De(Ze.toString())}}syncRTLPluginState(k,X,De){try{a.plugin.setState(X);const Ze=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&null!=Ze){this.self.importScripts(Ze);const dt=a.plugin.isParsed();De(dt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Ze}`),dt)}}catch(Ze){De(Ze.toString())}}getAvailableImages(k){let X=this.availableImages[k];return X||(X=[]),X}getLayerIndex(k){let X=this.layerIndexes[k];return X||(X=this.layerIndexes[k]=new b),X}getWorkerSource(k,X,De){return this.workerSources[k]||(this.workerSources[k]={}),this.workerSources[k][X]||(this.workerSources[k][X]={}),this.workerSources[k][X][De]||(this.workerSources[k][X][De]=new this.workerSourceTypes[X]({send:(dt,Ot,vt,ut,Fe,Be)=>{this.actor.send(dt,Ot,vt,k,Fe,Be)},scheduler:this.actor.scheduler},this.getLayerIndex(k),this.getAvailableImages(k),this.isSpriteLoaded[k])),this.workerSources[k][X][De]}getDEMWorkerSource(k,X){return this.demWorkerSources[k]||(this.demWorkerSources[k]={}),this.demWorkerSources[k][X]||(this.demWorkerSources[k][X]=new he),this.demWorkerSources[k][X]}enforceCacheSizeLimit(k,X){a.enforceCacheSizeLimit(X)}getWorkerPerformanceMetrics(k,X,De){De(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Ht(self)),Ht}),v(0,function(a){function q(m,i){if(Array.isArray(m)){if(!Array.isArray(i)||m.length!==i.length)return!1;for(let c=0;c<m.length;c++)if(!q(m[c],i[c]))return!1;return!0}if("object"==typeof m&&null!==m&&null!==i){if("object"!=typeof i||Object.keys(m).length!==Object.keys(i).length)return!1;for(const c in m)if(!q(m[c],i[c]))return!1;return!0}return m===i}var oe=b;function b(m){return i=m,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var y,u,p=new Blob([""],{type:"text/javascript"}),f=URL.createObjectURL(p);try{u=new Worker(f),y=!0}catch{y=!1}return u&&u.terminate(),URL.revokeObjectURL(f),y}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var y=document.createElement("canvas");y.width=y.height=1;var u=y.getContext("2d");if(!u)return!1;var p=u.getImageData(0,0,1,1);return p&&p.width===y.width}()||(void 0===he[c=i&&i.failIfMajorPerformanceCaveat]&&(he[c]=function(y){var u,f,w,E,p=(f=y,w=document.createElement("canvas"),(E=Object.create(b.webGLContextAttributes)).failIfMajorPerformanceCaveat=f,w.getContext("webgl",E)||w.getContext("experimental-webgl",E));if(!p)return!1;try{u=p.createShader(p.VERTEX_SHADER)}catch{return!1}return!(!u||p.isContextLost())&&(p.shaderSource(u,"void main() {}"),p.compileShader(u),!0===p.getShaderParameter(u,p.COMPILE_STATUS))}(c)),!he[c]||document.documentMode));var i,c}var he={};function Ie(m,i,c){const y=a.window.document.createElement(m);return void 0!==i&&(y.className=i),c&&c.appendChild(y),y}function Ve(m,i,c){const y=a.window.document.createElementNS("http://www.w3.org/2000/svg",m);for(const u of Object.keys(i))y.setAttributeNS(null,u,i[u]);return c&&c.appendChild(y),y}b.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const K=a.window.document&&a.window.document.documentElement.style,xe=K&&void 0!==K.userSelect?"userSelect":"WebkitUserSelect";let pe;function ze(){K&&xe&&(pe=K[xe],K[xe]="none")}function ce(){K&&xe&&(K[xe]=pe)}function Ke(m){m.preventDefault(),m.stopPropagation(),a.window.removeEventListener("click",Ke,!0)}function Pe(){a.window.addEventListener("click",Ke,!0),a.window.setTimeout(()=>{a.window.removeEventListener("click",Ke,!0)},0)}function ne(m,i){const c=m.getBoundingClientRect();return at(m,c,i)}function Je(m,i){const c=m.getBoundingClientRect(),y=[];for(let u=0;u<i.length;u++)y.push(at(m,c,i[u]));return y}function Pt(m){return void 0!==a.window.InstallTrigger&&2===m.button&&m.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:m.button}function at(m,i,c){const y=m.offsetWidth===i.width?1:m.offsetWidth/i.width;return new a.pointGeometry((c.clientX-i.left)*y,(c.clientY-i.top)*y)}function ge(m,i){var c=i[0],y=i[1],u=i[2],p=i[3],f=c*p-u*y;return f?(m[0]=p*(f=1/f),m[1]=-y*f,m[2]=-u*f,m[3]=c*f,m):null}function ke(m){const{userImage:i}=m;return!!(i&&i.render&&i.render())&&(m.data.replace(new Uint8Array(i.data.buffer)),!0)}class Le extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(i){if(this.loaded!==i&&(this.loaded=i,i)){for(const{ids:c,callback:y}of this.requestors)this._notify(c,y);this.requestors=[]}}hasImage(i){return!!this.getImage(i)}getImage(i){return this.images[i]}addImage(i,c){this._validate(i,c)&&(this.images[i]=c)}_validate(i,c){let y=!0;return this._validateStretch(c.stretchX,c.data&&c.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${i}" has invalid "stretchX" value`))),y=!1),this._validateStretch(c.stretchY,c.data&&c.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${i}" has invalid "stretchY" value`))),y=!1),this._validateContent(c.content,c)||(this.fire(new a.ErrorEvent(new Error(`Image "${i}" has invalid "content" value`))),y=!1),y}_validateStretch(i,c){if(!i)return!0;let y=0;for(const u of i){if(u[0]<y||u[1]<u[0]||c<u[1])return!1;y=u[1]}return!0}_validateContent(i,c){return!(i&&(4!==i.length||i[0]<0||c.data.width<i[0]||i[1]<0||c.data.height<i[1]||i[2]<0||c.data.width<i[2]||i[3]<0||c.data.height<i[3]||i[2]<i[0]||i[3]<i[1]))}updateImage(i,c){c.version=this.images[i].version+1,this.images[i]=c,this.updatedImages[i]=!0}removeImage(i){const c=this.images[i];delete this.images[i],delete this.patterns[i],c.userImage&&c.userImage.onRemove&&c.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(i,c){let y=!0;if(!this.isLoaded())for(const u of i)this.images[u]||(y=!1);this.isLoaded()||y?this._notify(i,c):this.requestors.push({ids:i,callback:c})}_notify(i,c){const y={};for(const u of i){this.images[u]||this.fire(new a.Event("styleimagemissing",{id:u}));const p=this.images[u];p?y[u]={data:p.data.clone(),pixelRatio:p.pixelRatio,sdf:p.sdf,version:p.version,stretchX:p.stretchX,stretchY:p.stretchY,content:p.content,hasRenderCallback:Boolean(p.userImage&&p.userImage.render)}:a.warnOnce(`Image "${u}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}c(null,y)}getPixelSize(){const{width:i,height:c}=this.atlasImage;return{width:i,height:c}}getPattern(i){const c=this.patterns[i],y=this.getImage(i);if(!y)return null;if(c&&c.position.version===y.version)return c.position;if(c)c.position.version=y.version;else{const u={w:y.data.width+2,h:y.data.height+2,x:0,y:0},p=new a.ImagePosition(u,y);this.patterns[i]={bin:u,position:p}}return this._updatePatternAtlas(),this.patterns[i].position}bind(i){const c=i.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(i,this.atlasImage,c.RGBA),this.atlasTexture.bind(c.LINEAR,c.CLAMP_TO_EDGE)}_updatePatternAtlas(){const i=[];for(const p in this.patterns)i.push(this.patterns[p].bin);const{w:c,h:y}=a.potpack(i),u=this.atlasImage;u.resize({width:c||1,height:y||1});for(const p in this.patterns){const{bin:f}=this.patterns[p],w=f.x+1,E=f.y+1,P=this.images[p].data,O=P.width,V=P.height;a.RGBAImage.copy(P,u,{x:0,y:0},{x:w,y:E},{width:O,height:V}),a.RGBAImage.copy(P,u,{x:0,y:V-1},{x:w,y:E-1},{width:O,height:1}),a.RGBAImage.copy(P,u,{x:0,y:0},{x:w,y:E+V},{width:O,height:1}),a.RGBAImage.copy(P,u,{x:O-1,y:0},{x:w-1,y:E},{width:1,height:V}),a.RGBAImage.copy(P,u,{x:0,y:0},{x:w+O,y:E},{width:1,height:V})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(i){for(const c of i){if(this.callbackDispatchedThisFrame[c])continue;this.callbackDispatchedThisFrame[c]=!0;const y=this.images[c];ke(y)&&this.updateImage(c,y)}}}const we=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(m,i){return function([c,y,u]){const p=a.degToRad(y+90),f=a.degToRad(u);return{x:c*Math.cos(p)*Math.sin(f),y:c*Math.sin(p)*Math.sin(f),z:c*Math.cos(f),azimuthal:y,polar:u}}(m.expression.evaluate(i))}interpolate(m,i,c){return{x:a.number(m.x,i.x,c),y:a.number(m.y,i.y,c),z:a.number(m.z,i.z,c),azimuthal:a.number(m.azimuthal,i.azimuthal,c),polar:a.number(m.polar,i.polar,c)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)}),Xe="-transition";class He extends a.Evented{constructor(i){super(),this._transitionable=new a.Transitionable(we),this.setLight(i),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(i,c={}){if(!this._validate(a.validateLight,i,c))for(const y in i){const u=i[y];a.endsWith(y,Xe)?this._transitionable.setTransition(y.slice(0,-Xe.length),u):this._transitionable.setValue(y,u)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,y){return(!y||!1!==y.validate)&&a.emitValidationErrors(this,i.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const me=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)}),de="-transition";class se extends a.Evented{constructor(i,c){super(),this._transitionable=new a.Transitionable(me),this.set(i),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=c}get(){return this._transitionable.serialize()}set(i){for(const c in i){const y=i[c];a.endsWith(c,de)?this._transitionable.setTransition(c.slice(0,-de.length),y):this._transitionable.setValue(c,y)}}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}}function Ee(m,i,c,y){const u=a.smoothstep(45,65,c),[p,f]=_t(m,y),w=a.length(i);let E=1-Math.min(1,Math.exp((w-p)/(f-p)*-6));return E*=E*E,E=Math.min(1,1.00747*E),E*u*m.alpha}function _t(m,i){const c=.5/Math.tan(.5*i);return[m.range[0]+c,m.range[1]+c]}const It=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])}),Gt="-transition";class Lt extends a.Evented{constructor(i,c){super(),this._transitionable=new a.Transitionable(It),this.set(i),this._transitioning=this._transitionable.untransitioned(),this._transform=c}get state(){const i=this._transform,c="globe"===i.projection.name,y=a.globeToMercatorTransition(i.zoom),u=this.properties.get("range"),p=[.5,3];return{range:c?[a.number(p[0],u[0],y),a.number(p[1],u[1],y)]:u,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(i,c={}){if(!this._validate(a.validateFog,i,c)){for(const y of Object.keys(a.spec.fog))i&&void 0===i[y]&&(i[y]=a.spec.fog[y].default);for(const y in i){const u=i[y];a.endsWith(y,Gt)?this._transitionable.setTransition(y.slice(0,-Gt.length),u):this._transitionable.setValue(y,u)}}}getOpacity(i){if(!this._transform.projection.supportsFog)return 0;const c=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:a.smoothstep(45,65,i))*c.a}getOpacityAtLatLng(i,c){return this._transform.projection.supportsFog?function(y,u,p){const f=a.MercatorCoordinate.fromLngLat(u),w=p.elevation?p.elevation.getAtPointOrZero(f):0,E=[f.x,f.y,w];return a.transformMat4(E,E,p.mercatorFogMatrix),Ee(y,E,p.pitch,p._fov)}(this.state,i,c):0}getFovAdjustedRange(i){return this._transform.projection.supportsFog?_t(this.state,i):[0,1]}updateTransitions(i){this._transitioning=this._transitionable.transitioned(i,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(i){this.properties=this._transitioning.possiblyEvaluate(i)}_validate(i,c,y){return(!y||!1!==y.validate)&&a.emitValidationErrors(this,i.call(a.validateStyle,a.extend({value:c,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class yt{constructor(i,c){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const y=this.workerPool.acquire(this.id);for(let u=0;u<y.length;u++){const p=new yt.Actor(y[u],c,this.id);p.name=`Worker ${u}`,this.actors.push(p)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,c,y){a.asyncAll(this.actors,(u,p)=>{u.send(i,c,p)},y=y||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}function St(m,i,c){return i*(a.EXTENT/(m.tileSize*Math.pow(2,c-m.tileID.overscaledZ)))}yt.Actor=a.Actor;class xt{constructor(i,c,y,u){this.screenBounds=i,this.cameraPoint=c,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,u)}static createFromScreenPoints(i,c){let y,u;if(i instanceof a.pointGeometry||"number"==typeof i[0]){const p=a.pointGeometry.convert(i);y=[p],u=c.isPointAboveHorizon(p)}else{const p=a.pointGeometry.convert(i[0]),f=a.pointGeometry.convert(i[1]);y=[p,f],u=a.polygonizeBounds(p,f).every(w=>c.isPointAboveHorizon(w))}return new xt(y,c.getCameraPoint(),u,c)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(i){return a.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],i)}bufferedCameraGeometry(i){const c=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],u=a.polygonizeBounds(c,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>c.x&&this.cameraPoint.x<y.x?u.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?u[2]=this.cameraPoint:this.cameraPoint.x<=c.x&&(u[3]=this.cameraPoint)),a.bufferConvexPolygon(u,i)}bufferedCameraGeometryGlobe(i){const c=this.screenBounds[0],y=1===this.screenBounds.length?this.screenBounds[0].add(new a.pointGeometry(1,1)):this.screenBounds[1],u=a.polygonizeBounds(c,y,i),p=this.cameraPoint.clone();switch(3*((p.y>c.y)+(p.y>y.y))+((p.x>c.x)+(p.x>y.x))){case 0:u[0]=p,u[4]=p.clone();break;case 1:u.splice(1,0,p);break;case 2:u[1]=p;break;case 3:u.splice(4,0,p);break;case 5:u.splice(2,0,p);break;case 6:u[3]=p;break;case 7:u.splice(3,0,p);break;case 8:u[2]=p}return u}containsTile(i,c,y,u=0){const p=i.queryPadding/c._pixelsPerMercatorPixel+1,f=y?this._bufferedCameraMercator(p,c):this._bufferedScreenMercator(p,c);let w=i.tileID.wrap+(f.unwrapped?u:0);const E=f.polygon.map(Ne=>a.getTilePoint(i.tileTransform,Ne,w));if(!a.polygonIntersectsBox(E,0,0,a.EXTENT,a.EXTENT))return;w=i.tileID.wrap+(this.screenGeometryMercator.unwrapped?u:0);const P=this.screenGeometryMercator.polygon.map(Ne=>a.getTileVec3(i.tileTransform,Ne,w)),O=P.map(Ne=>new a.pointGeometry(Ne[0],Ne[1])),V=c.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),Q=a.getTileVec3(i.tileTransform,V,w),ye=P.map(Ne=>{const ve=a.sub(Ne,Ne,Q);return a.normalize(ve,ve),new a.Ray(Q,ve)}),be=St(i,1,c.zoom)*c._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:O,tilespaceRays:ye,bufferedTilespaceGeometry:E,bufferedTilespaceBounds:(Oe=a.getBounds(E),Oe.min.x=a.clamp(Oe.min.x,0,a.EXTENT),Oe.min.y=a.clamp(Oe.min.y,0,a.EXTENT),Oe.max.x=a.clamp(Oe.max.x,0,a.EXTENT),Oe.max.y=a.clamp(Oe.max.y,0,a.EXTENT),Oe),tile:i,tileID:i.tileID,pixelToTileUnitsFactor:be};var Oe}_bufferedScreenMercator(i,c){const y=Ce(i);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let u;return u="globe"===c.projection.name?this._projectAndResample(this.bufferedScreenGeometry(i),c):{polygon:this.bufferedScreenGeometry(i).map(p=>c.pointCoordinate3D(p)),unwrapped:!0},this._screenRaycastCache[y]=u,u}}_bufferedCameraMercator(i,c){const y=Ce(i);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let u;return u="globe"===c.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(i),c):{polygon:this.bufferedCameraGeometry(i).map(p=>c.pointCoordinate3D(p)),unwrapped:!0},this._cameraRaycastCache[y]=u,u}}_projectAndResample(i,c){const y=function(p,f){const w=a.multiply([],f.pixelMatrix,f.globeMatrix),E=[0,-a.GLOBE_RADIUS,0,1],P=[0,a.GLOBE_RADIUS,0,1],O=[0,0,0,1];a.transformMat4$1(E,E,w),a.transformMat4$1(P,P,w),a.transformMat4$1(O,O,w);const V=new a.pointGeometry(E[0]/E[3],E[1]/E[3]),Q=new a.pointGeometry(P[0]/P[3],P[1]/P[3]),ye=a.polygonContainsPoint(p,V)&&E[3]<O[3],be=a.polygonContainsPoint(p,Q)&&P[3]<O[3];if(!ye&&!be)return null;const Oe=function(At,Zt,Kt){for(let nn=1;nn<At.length;nn++){const Bn=lt(Zt.pointCoordinate3D(At[nn-1]).x),qt=lt(Zt.pointCoordinate3D(At[nn]).x);if(Kt<0){if(Bn<qt)return{idx:nn,t:-Bn/(qt-1-Bn)}}else if(qt<Bn)return{idx:nn,t:(1-Bn)/(qt+1-Bn)}}return null}(p,f,ye?-1:1);if(!Oe)return null;const{idx:Ne,t:ve}=Oe;let tt=Ne>1?rt(p.slice(0,Ne),f):[],qe=Ne<p.length?rt(p.slice(Ne),f):[];tt=tt.map(At=>new a.pointGeometry(lt(At.x),At.y)),qe=qe.map(At=>new a.pointGeometry(lt(At.x),At.y));const nt=[...tt];0===nt.length&&nt.push(qe[qe.length-1]);const Tt=a.number(nt[nt.length-1].y,(0===qe.length?tt[0]:qe[0]).y,ve);let ft;return ft=ye?[new a.pointGeometry(0,Tt),new a.pointGeometry(0,0),new a.pointGeometry(1,0),new a.pointGeometry(1,Tt)]:[new a.pointGeometry(1,Tt),new a.pointGeometry(1,1),new a.pointGeometry(0,1),new a.pointGeometry(0,Tt)],nt.push(...ft),0===qe.length?nt.push(tt[0]):nt.push(...qe),{polygon:nt.map(At=>new a.MercatorCoordinate(At.x,At.y)),unwrapped:!1}}(i,c);if(y)return y;const u=function(p,f){let w=!1,E=-1/0,P=0;for(let V=0;V<p.length-1;V++)p[V].x>E&&(E=p[V].x,P=V);for(let V=0;V<p.length-1;V++){const Q=(P+V)%(p.length-1),ye=p[Q],be=p[Q+1];Math.abs(ye.x-be.x)>.5&&(ye.x<be.x?(ye.x+=1,0===Q&&(p[p.length-1].x+=1)):(be.x+=1,Q+1===p.length-1&&(p[0].x+=1)),w=!0)}const O=a.mercatorXfromLng(f.center.lng);return w&&O<Math.abs(O-1)&&p.forEach(V=>{V.x-=1}),{polygon:p,unwrapped:w}}(rt(i,c).map(p=>new a.pointGeometry(lt(p.x),p.y)),c);return{polygon:u.polygon.map(p=>new a.MercatorCoordinate(p.x,p.y)),unwrapped:u.unwrapped}}}function rt(m,i){return a.resample(m,c=>{const y=i.pointCoordinate3D(c);c.x=y.x,c.y=y.y},1/256)}function lt(m){return m<0?1+m%1:m%1}function Ce(m){return 100*m|0}function bt(m,i,c,y,u){const p=function(f,w){if(f)return u(f);if(w){m.url&&w.tiles&&m.tiles&&delete m.tiles;const E=a.pick(a.extend(w,m),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);w.vector_layers&&(E.vectorLayers=w.vector_layers,E.vectorLayerIds=E.vectorLayers.map(P=>P.id)),E.tiles=i.canonicalizeTileset(E,m.url),u(null,E)}};return m.url?a.getJSON(i.transformRequest(i.normalizeSourceURL(m.url,null,c,y),a.ResourceType.Source),p):a.exported.frame(()=>p(null,m))}class kt{constructor(i,c,y){this.bounds=a.LngLatBounds.convert(this.validateBounds(i)),this.minzoom=c||0,this.maxzoom=y||24}validateBounds(i){return Array.isArray(i)&&4===i.length?[Math.max(-180,i[0]),Math.max(-90,i[1]),Math.min(180,i[2]),Math.min(90,i[3])]:[-180,-90,180,90]}contains(i){const c=Math.pow(2,i.z),y=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*c),u=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*c),p=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*c),f=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*c);return i.x>=y&&i.x<p&&i.y>=u&&i.y<f}}class Ut{constructor(i,c,y){this.context=i;const u=i.gl;this.buffer=u.createBuffer(),this.dynamicDraw=Boolean(y),this.context.unbindVAO(),i.bindElementBuffer.set(this.buffer),u.bufferData(u.ELEMENT_ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?u.DYNAMIC_DRAW:u.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.context.unbindVAO(),this.bind(),c.bufferSubData(c.ELEMENT_ARRAY_BUFFER,0,i.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const bn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Nn{constructor(i,c,y,u){this.length=c.length,this.attributes=y,this.itemSize=c.bytesPerElement,this.dynamicDraw=u,this.context=i;const p=i.gl;this.buffer=p.createBuffer(),i.bindVertexBuffer.set(this.buffer),p.bufferData(p.ARRAY_BUFFER,c.arrayBuffer,this.dynamicDraw?p.DYNAMIC_DRAW:p.STATIC_DRAW),this.dynamicDraw||c.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(i){const c=this.context.gl;this.bind(),c.bufferSubData(c.ARRAY_BUFFER,0,i.arrayBuffer)}enableAttributes(i,c){for(let y=0;y<this.attributes.length;y++){const u=c.attributes[this.attributes[y].name];void 0!==u&&i.enableVertexAttribArray(u)}}setVertexAttribPointers(i,c,y){for(let u=0;u<this.attributes.length;u++){const p=this.attributes[u],f=c.attributes[p.name];void 0!==f&&i.vertexAttribPointer(f,p.components,i[bn[p.type]],!1,this.itemSize,p.offset+this.itemSize*(y||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class un{constructor(i){this.gl=i.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(i){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class ot extends un{getDefault(){return a.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.clearColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Bt extends un{getDefault(){return 1}set(i){(i!==this.current||this.dirty)&&(this.gl.clearDepth(i),this.current=i,this.dirty=!1)}}class Sn extends un{getDefault(){return 0}set(i){(i!==this.current||this.dirty)&&(this.gl.clearStencil(i),this.current=i,this.dirty=!1)}}class Qn extends un{getDefault(){return[!0,!0,!0,!0]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.colorMask(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class ci extends un{getDefault(){return!0}set(i){(i!==this.current||this.dirty)&&(this.gl.depthMask(i),this.current=i,this.dirty=!1)}}class Un extends un{getDefault(){return 255}set(i){(i!==this.current||this.dirty)&&(this.gl.stencilMask(i),this.current=i,this.dirty=!1)}}class hi extends un{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(i){const c=this.current;(i.func!==c.func||i.ref!==c.ref||i.mask!==c.mask||this.dirty)&&(this.gl.stencilFunc(i.func,i.ref,i.mask),this.current=i,this.dirty=!1)}}class Ii extends un{getDefault(){const i=this.gl;return[i.KEEP,i.KEEP,i.KEEP]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||this.dirty)&&(this.gl.stencilOp(i[0],i[1],i[2]),this.current=i,this.dirty=!1)}}class yi extends un{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.STENCIL_TEST):c.disable(c.STENCIL_TEST),this.current=i,this.dirty=!1}}class Bi extends un{getDefault(){return[0,1]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.depthRange(i[0],i[1]),this.current=i,this.dirty=!1)}}class Mi extends un{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.DEPTH_TEST):c.disable(c.DEPTH_TEST),this.current=i,this.dirty=!1}}class Ni extends un{getDefault(){return this.gl.LESS}set(i){(i!==this.current||this.dirty)&&(this.gl.depthFunc(i),this.current=i,this.dirty=!1)}}class Ki extends un{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.BLEND):c.disable(c.BLEND),this.current=i,this.dirty=!1}}class Vt extends un{getDefault(){const i=this.gl;return[i.ONE,i.ZERO]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||this.dirty)&&(this.gl.blendFunc(i[0],i[1]),this.current=i,this.dirty=!1)}}class Mt extends un{getDefault(){return a.Color.transparent}set(i){const c=this.current;(i.r!==c.r||i.g!==c.g||i.b!==c.b||i.a!==c.a||this.dirty)&&(this.gl.blendColor(i.r,i.g,i.b,i.a),this.current=i,this.dirty=!1)}}class Ge extends un{getDefault(){return this.gl.FUNC_ADD}set(i){(i!==this.current||this.dirty)&&(this.gl.blendEquation(i),this.current=i,this.dirty=!1)}}class ie extends un{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;i?c.enable(c.CULL_FACE):c.disable(c.CULL_FACE),this.current=i,this.dirty=!1}}class Qe extends un{getDefault(){return this.gl.BACK}set(i){(i!==this.current||this.dirty)&&(this.gl.cullFace(i),this.current=i,this.dirty=!1)}}class Wt extends un{getDefault(){return this.gl.CCW}set(i){(i!==this.current||this.dirty)&&(this.gl.frontFace(i),this.current=i,this.dirty=!1)}}class rn extends un{getDefault(){return null}set(i){(i!==this.current||this.dirty)&&(this.gl.useProgram(i),this.current=i,this.dirty=!1)}}class oi extends un{getDefault(){return this.gl.TEXTURE0}set(i){(i!==this.current||this.dirty)&&(this.gl.activeTexture(i),this.current=i,this.dirty=!1)}}class Di extends un{getDefault(){const i=this.gl;return[0,0,i.drawingBufferWidth,i.drawingBufferHeight]}set(i){const c=this.current;(i[0]!==c[0]||i[1]!==c[1]||i[2]!==c[2]||i[3]!==c[3]||this.dirty)&&(this.gl.viewport(i[0],i[1],i[2],i[3]),this.current=i,this.dirty=!1)}}class ar extends un{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindFramebuffer(c.FRAMEBUFFER,i),this.current=i,this.dirty=!1}}class pi extends un{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindRenderbuffer(c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class mr extends un{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindTexture(c.TEXTURE_2D,i),this.current=i,this.dirty=!1}}class Si extends un{getDefault(){return null}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.bindBuffer(c.ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class vr extends un{getDefault(){return null}set(i){const c=this.gl;c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,i),this.current=i,this.dirty=!1}}class xr extends un{constructor(i){super(i),this.vao=i.extVertexArrayObject}getDefault(){return null}set(i){this.vao&&(i!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(i),this.current=i,this.dirty=!1)}}class gr extends un{getDefault(){return 4}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_ALIGNMENT,i),this.current=i,this.dirty=!1}}class ui extends un{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_PREMULTIPLY_ALPHA_WEBGL,i),this.current=i,this.dirty=!1}}class pn extends un{getDefault(){return!1}set(i){if(i===this.current&&!this.dirty)return;const c=this.gl;c.pixelStorei(c.UNPACK_FLIP_Y_WEBGL,i),this.current=i,this.dirty=!1}}class wt extends un{constructor(i,c){super(i),this.context=i,this.parent=c}getDefault(){return null}}class Rt extends wt{setDirty(){this.dirty=!0}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,i,0),this.current=i,this.dirty=!1}}class _n extends wt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(i){if(i===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const c=this.gl;c.framebufferRenderbuffer(c.FRAMEBUFFER,this.attachment(),c.RENDERBUFFER,i),this.current=i,this.dirty=!1}}class Ue extends _n{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ht{constructor(i,c,y,u){this.context=i,this.width=c,this.height=y;const p=this.framebuffer=i.gl.createFramebuffer();this.colorAttachment=new Rt(i,p),u&&(this.depthAttachment=new _n(i,p))}destroy(){const i=this.context.gl,c=this.colorAttachment.get();if(c&&i.deleteTexture(c),this.depthAttachment){const y=this.depthAttachment.get();y&&i.deleteRenderbuffer(y)}i.deleteFramebuffer(this.framebuffer)}}class z{constructor(i,c=!1){if(this.gl=i,this.isWebGL2=c,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),c){const y=i;this.extVertexArrayObject={createVertexArrayOES:y.createVertexArray.bind(i),deleteVertexArrayOES:y.deleteVertexArray.bind(i),bindVertexArrayOES:y.bindVertexArray.bind(i)}}this.clearColor=new ot(this),this.clearDepth=new Bt(this),this.clearStencil=new Sn(this),this.colorMask=new Qn(this),this.depthMask=new ci(this),this.stencilMask=new Un(this),this.stencilFunc=new hi(this),this.stencilOp=new Ii(this),this.stencilTest=new yi(this),this.depthRange=new Bi(this),this.depthTest=new Mi(this),this.depthFunc=new Ni(this),this.blend=new Ki(this),this.blendFunc=new Vt(this),this.blendColor=new Mt(this),this.blendEquation=new Ge(this),this.cullFace=new ie(this),this.cullFaceSide=new Qe(this),this.frontFace=new Wt(this),this.program=new rn(this),this.activeTexture=new oi(this),this.viewport=new Di(this),this.bindFramebuffer=new ar(this),this.bindRenderbuffer=new pi(this),this.bindTexture=new mr(this),this.bindVertexBuffer=new Si(this),this.bindElementBuffer=new vr(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new xr(this),this.pixelStoreUnpack=new gr(this),this.pixelStoreUnpackPremultiplyAlpha=new ui(this),this.pixelStoreUnpackFlipY=new pn(this),this.extTextureFilterAnisotropic=i.getExtension("EXT_texture_filter_anisotropic")||i.getExtension("MOZ_EXT_texture_filter_anisotropic")||i.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=i.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=i.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=i.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=i.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),c||(this.extTextureHalfFloat=i.getExtension("OES_texture_half_float")),(c||this.extTextureHalfFloat&&i.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=i.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=c||i.getExtension("OES_standard_derivatives"),this.extTimerQuery=i.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(i,c){return new Ut(this,i,c)}createVertexBuffer(i,c,y){return new Nn(this,i,c,y)}createRenderbuffer(i,c,y){const u=this.gl,p=u.createRenderbuffer();return this.bindRenderbuffer.set(p),u.renderbufferStorage(u.RENDERBUFFER,i,c,y),this.bindRenderbuffer.set(null),p}createFramebuffer(i,c,y){return new Ht(this,i,c,y)}clear({color:i,depth:c,stencil:y}){const u=this.gl;let p=0;i&&(p|=u.COLOR_BUFFER_BIT,this.clearColor.set(i),this.colorMask.set([!0,!0,!0,!0])),void 0!==c&&(p|=u.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(c),this.depthMask.set(!0)),void 0!==y&&(p|=u.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),u.clear(p)}setCullFace(i){!1===i.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(i.mode),this.frontFace.set(i.frontFace))}setDepthMode(i){i.func!==this.gl.ALWAYS||i.mask?(this.depthTest.set(!0),this.depthFunc.set(i.func),this.depthMask.set(i.mask),this.depthRange.set(i.range)):this.depthTest.set(!1)}setStencilMode(i){i.test.func!==this.gl.ALWAYS||i.mask?(this.stencilTest.set(!0),this.stencilMask.set(i.mask),this.stencilOp.set([i.fail,i.depthFail,i.pass]),this.stencilFunc.set({func:i.test.func,ref:i.ref,mask:i.test.mask})):this.stencilTest.set(!1)}setColorMode(i){q(i.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(i.blendFunction),this.blendColor.set(i.blendColor)),this.colorMask.set(i.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class k extends a.Evented{constructor(i,c,y,u){if(super(),this.id=i,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(c,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},c),this._collectResourceTiming=c.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(u),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(i){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const c=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map._worldview;this._tileJSONRequest=bt(this._options,this.map._requestManager,c,y,(u,p)=>{this._tileJSONRequest=null,this._loaded=!0,u?(c&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${c}`),y&&2!==y.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new a.ErrorEvent(u))):p&&(a.extend(this,p),p.bounds&&(this.tileBounds=new kt(p.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(p.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(u)})}loaded(){return this._loaded}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(i,c){const y=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme)),u={request:this.map._requestManager.transformRequest(y,a.ResourceType.Tile),data:void 0,uid:i.uid,tileID:i.tileID,tileZoom:i.tileZoom,zoom:i.tileID.overscaledZ,tileSize:this.tileSize*i.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:i.isSymbolTile};if(u.request.collectResourceTiming=this._collectResourceTiming,i.actor&&"expired"!==i.state)"loading"===i.state?i.reloadCallback=c:i.request=i.actor.send("reloadTile",u,p.bind(this));else if(i.actor=this._tileWorkers[y]=this._tileWorkers[y]||this.dispatcher.getActor(),this.dispatcher.ready)i.request=i.actor.send("loadTile",u,p.bind(this),void 0,!0);else{const f=a.loadVectorTile.call({deduped:this._deduped},u,(w,E)=>{w||!E?p.call(this,w):(u.data={cacheControl:E.cacheControl,expires:E.expires,rawData:E.rawData.slice(0)},i.actor&&i.actor.send("loadTile",u,p.bind(this),void 0,!0))},!0);i.request={cancel:f}}function p(f,w){return delete i.request,i.aborted?c(null):f&&404!==f.status?c(f):(w&&w.resourceTiming&&(i.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&i.setExpiryData(w),i.loadVectorData(w,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),c(null),void(i.reloadCallback&&(this.loadTile(i,i.reloadCallback),i.reloadCallback=null)))}}abortTile(i){i.request&&(i.request.cancel(),delete i.request),i.actor&&i.actor.send("abortTile",{uid:i.uid,type:this.type,source:this.id})}unloadTile(i){i.unloadVectorData(),i.actor&&i.actor.send("removeTile",{uid:i.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class X extends a.Evented{constructor(i,c,y,u){super(),this.id=i,this.dispatcher=y,this.setEventedParent(u),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},c),a.extend(this,a.pick(c,["url","scheme","tileSize"]))}load(i){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=bt(this._options,this.map._requestManager,null,null,(c,y)=>{this._tileJSONRequest=null,this._loaded=!0,c?this.fire(new a.ErrorEvent(c)):y&&(a.extend(this,y),y.bounds&&(this.tileBounds=new kt(y.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(y.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),i&&i(c)})}loaded(){return this._loaded}onAdd(i){this.map=i,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(i){return this._options.tiles=i,this.reload(),this}setUrl(i){return this.url=i,this._options.url=i,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(i){return!this.tileBounds||this.tileBounds.contains(i.canonical)}loadTile(i,c){const y=a.exported.devicePixelRatio>=2,u=this.map._requestManager.normalizeTileURL(i.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);i.request=a.getImage(this.map._requestManager.transformRequest(u,a.ResourceType.Tile),(p,f,w,E)=>(delete i.request,i.aborted?(i.state="unloaded",c(null)):p?(i.state="errored",c(p)):f?(this.map._refreshExpiredTiles&&i.setExpiryData({cacheControl:w,expires:E}),i.setTexture(f,this.map.painter),i.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void c(null)):c(null)))}static loadTileData(i,c,y){i.setTexture(c,y)}static unloadTileData(i,c){i.texture&&c.saveTileTexture(i.texture)}abortTile(i,c){i.request&&(i.request.cancel(),delete i.request),c()}unloadTile(i,c){i.texture&&this.map.painter.saveTileTexture(i.texture),c()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}let De;function Ze(m,i,c,y,u,p,f,w){const E=[m,c,u,i,y,p,1,1,1],P=[f,w,1],O=a.adjoint([],E),[V,Q,ye]=a.transformMat3(P,P,a.transpose(O,O));return a.multiply$1(E,[V,0,0,0,Q,0,0,0,ye],E)}class dt extends a.Evented{constructor(i,c,y,u){super(),this.id=i,this.dispatcher=y,this.coordinates=c.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(u),this.options=c,this._dirty=!1}load(i,c){this._loaded=c||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),(y,u)=>{if(this._imageRequest=null,this._loaded=!0,y)this.fire(new a.ErrorEvent(y));else if(u){const{HTMLImageElement:p}=a.window;this.image=u instanceof p?a.exported.getImageData(u):u,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading()}})}loaded(){return this._loaded}updateImage(i){return this.image&&i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(i){this.coordinates=i,this._boundsArray=void 0;const c=i.map(a.MercatorCoordinate.fromLngLat);return this.tileID=function(y){let u=1/0,p=1/0,f=-1/0,w=-1/0;for(const V of y)u=Math.min(u,V.x),p=Math.min(p,V.y),f=Math.max(f,V.x),w=Math.max(w,V.y);const E=Math.max(f-u,w-p),P=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),O=Math.pow(2,P);return new a.CanonicalTileID(P,Math.floor((u+f)/2*O),Math.floor((p+w)/2*O))}(c),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(i){for(const E in this.tiles){const P=this.tiles[E];"loaded"!==P.state&&(P.state="loaded",P.texture=this.texture)}if(this._boundsArray)return;const c=a.tileTransform(this.tileID,this.map.transform.projection),[y,u,p,f]=this.coordinates.map(E=>{const P=c.projection.project(E[0],E[1]);return a.getTilePoint(c,P)._round()});this.perspectiveTransform=function(E,P,O,V,Q,ye,be,Oe,Ne,ve){const tt=Ze(0,0,E,0,0,P,E,P),qe=Ze(O,V,Q,ye,be,Oe,Ne,ve);return a.multiply$1(qe,a.adjoint(tt,tt),qe),[qe[6]/qe[8]*E/a.EXTENT,qe[7]/qe[8]*P/a.EXTENT]}(this.width,this.height,y.x,y.y,u.x,u.y,f.x,f.y,p.x,p.y);const w=this._boundsArray=new a.StructArrayLayout4i8;w.emplaceBack(y.x,y.y,0,0),w.emplaceBack(u.x,u.y,a.EXTENT,0),w.emplaceBack(f.x,f.y,0,a.EXTENT),w.emplaceBack(p.x,p.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=i.createVertexBuffer(w,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const i=this.map.painter.context,c=i.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(i,this.image,c.RGBA),this.texture.bind(c.LINEAR,c.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(i)}loadTile(i,c){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},c(null)):(i.state="errored",c(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Ot={vector:k,raster:X,"raster-dem":class extends X{constructor(m,i,c,y){super(m,i,c,y),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},i),this.encoding=i.encoding||"mapbox"}loadTile(m,i){const c=this.map._requestManager.normalizeTileURL(m.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(u,p){u&&(m.state="errored",i(u)),p&&(m.dem=p,m.dem.onDeserialize(),m.needsHillshadePrepare=!0,m.needsDEMTextureUpload=!0,m.state="loaded",i(null))}m.request=a.getImage(this.map._requestManager.transformRequest(c,a.ResourceType.Tile),function(u,p,f,w){if(delete m.request,m.aborted)m.state="unloaded",i(null);else if(u)m.state="errored",i(u);else if(p){this.map._refreshExpiredTiles&&m.setExpiryData({cacheControl:f,expires:w});const E=a.window.ImageBitmap&&p instanceof a.window.ImageBitmap&&(null==De&&(De=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof a.window.createImageBitmap),De),P=1-(p.width-a.prevPowerOfTwo(p.width))/2;P<1||m.neighboringTiles||(m.neighboringTiles=this._getNeighboringTiles(m.tileID));const O=E?p:a.exported.getImageData(p,P),V={uid:m.uid,coord:m.tileID,source:this.id,rawImageData:O,encoding:this.encoding,padding:P};m.actor&&"expired"!==m.state||(m.actor=this.dispatcher.getActor(),m.actor.send("loadDEMTile",V,y.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(m){const i=m.canonical,c=Math.pow(2,i.z),y=(i.x-1+c)%c,u=0===i.x?m.wrap-1:m.wrap,p=(i.x+1+c)%c,f=i.x+1===c?m.wrap+1:m.wrap,w={};return w[new a.OverscaledTileID(m.overscaledZ,u,i.z,y,i.y).key]={backfilled:!1},w[new a.OverscaledTileID(m.overscaledZ,f,i.z,p,i.y).key]={backfilled:!1},i.y>0&&(w[new a.OverscaledTileID(m.overscaledZ,u,i.z,y,i.y-1).key]={backfilled:!1},w[new a.OverscaledTileID(m.overscaledZ,m.wrap,i.z,i.x,i.y-1).key]={backfilled:!1},w[new a.OverscaledTileID(m.overscaledZ,f,i.z,p,i.y-1).key]={backfilled:!1}),i.y+1<c&&(w[new a.OverscaledTileID(m.overscaledZ,u,i.z,y,i.y+1).key]={backfilled:!1},w[new a.OverscaledTileID(m.overscaledZ,m.wrap,i.z,i.x,i.y+1).key]={backfilled:!1},w[new a.OverscaledTileID(m.overscaledZ,f,i.z,p,i.y+1).key]={backfilled:!1}),w}unloadTile(m){m.demTexture&&this.map.painter.saveTileTexture(m.demTexture),m.fbo&&(m.fbo.destroy(),delete m.fbo),m.dem&&delete m.dem,delete m.neighboringTiles,m.state="unloaded"}},geojson:class extends a.Evented{constructor(m,i,c,y){super(),this.id=m,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=c.getActor(),this.setEventedParent(y),this._data=i.data,this._options=a.extend({},i),this._collectResourceTiming=i.collectResourceTiming,void 0!==i.maxzoom&&(this.maxzoom=i.maxzoom),i.type&&(this.type=i.type),i.attribution&&(this.attribution=i.attribution),this.promoteId=i.promoteId;const u=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:i.cluster||!1,geojsonVtOptions:{buffer:(void 0!==i.buffer?i.buffer:128)*u,tolerance:(void 0!==i.tolerance?i.tolerance:.375)*u,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:i.lineMetrics||!1,generateId:i.generateId||!1},superclusterOptions:{maxZoom:void 0!==i.clusterMaxZoom?i.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,i.clusterMinPoints||2),extent:a.EXTENT,radius:(void 0!==i.clusterRadius?i.clusterRadius:50)*u,log:!1,generateId:i.generateId||!1},clusterProperties:i.clusterProperties,filter:i.filter},i.workerOptions)}onAdd(m){this.map=m,this.setData(this._data)}setData(m){return this._data=m,this._updateWorkerData(),this}getClusterExpansionZoom(m,i){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:m,source:this.id},i),this}getClusterChildren(m,i){return this.actor.send("geojson.getClusterChildren",{clusterId:m,source:this.id},i),this}getClusterLeaves(m,i,c,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:m,limit:i,offset:c},y),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const m=a.extend({},this.workerOptions),i=this._data;"string"==typeof i?(m.request=this.map._requestManager.transformRequest(a.exported.resolveURL(i),a.ResourceType.Source),m.request.collectResourceTiming=this._collectResourceTiming):m.data=JSON.stringify(i),this._pendingLoad=this.actor.send(`${this.type}.loadData`,m,(c,y)=>{if(this._loaded=!0,this._pendingLoad=null,c)this.fire(new a.ErrorEvent(c));else{const u={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&y&&y.resourceTiming&&y.resourceTiming[this.id]&&(u.resourceTiming=y.resourceTiming[this.id]),this.fire(new a.Event("data",u)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(m,i){const c=m.actor?"reloadTile":"loadTile";m.actor=this.actor,m.request=this.actor.send(c,{type:this.type,uid:m.uid,tileID:m.tileID,tileZoom:m.tileZoom,zoom:m.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(y,u)=>(delete m.request,m.unloadVectorData(),m.aborted?i(null):y?i(y):(m.loadVectorData(u,this.map.painter,"reloadTile"===c),i(null))),void 0,"loadTile"===c)}abortTile(m){m.request&&(m.request.cancel(),delete m.request),m.aborted=!0}unloadTile(m){m.unloadVectorData(),this.actor.send("removeTile",{uid:m.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends dt{constructor(m,i,c,y){super(m,i,c,y),this.roundZoom=!0,this.type="video",this.options=i}load(){this._loaded=!1;const m=this.options;this.urls=[];for(const i of m.urls)this.urls.push(this.map._requestManager.transformRequest(i,a.ResourceType.Source).url);a.getVideo(this.urls,(i,c)=>{this._loaded=!0,i?this.fire(new a.ErrorEvent(i)):c&&(this.video=c,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(m){if(this.video){const i=this.video.seekable;m<i.start(0)||m>i.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${i.start(0)} and ${i.end(0)}-second mark.`))):this.video.currentTime=m}}getVideo(){return this.video}onAdd(m){this.map||(this.map=m,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const m=this.map.painter.context,i=m.gl;this.texture?this.video.paused||(this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),i.texSubImage2D(i.TEXTURE_2D,0,0,0,i.RGBA,i.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(m,this.video,i.RGBA),this.texture.bind(i.LINEAR,i.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(m)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:dt,canvas:class extends dt{constructor(m,i,c,y){super(m,i,c,y),i.coordinates?Array.isArray(i.coordinates)&&4===i.coordinates.length&&!i.coordinates.some(u=>!Array.isArray(u)||2!==u.length||u.some(p=>"number"!=typeof p))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${m}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${m}`,null,'missing required property "coordinates"'))),i.animate&&"boolean"!=typeof i.animate&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${m}`,null,'optional "animate" property must be a boolean value'))),i.canvas?"string"==typeof i.canvas||i.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${m}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${m}`,null,'missing required property "canvas"'))),this.options=i,this.animate=void 0===i.animate||i.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(m){this.map=m,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let m=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,m=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,m=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const i=this.map.painter.context;this.texture?(m||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(i,this.canvas,i.gl.RGBA,{premultiply:!0}),this._prepareData(i)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const m of[this.canvas.width,this.canvas.height])if(isNaN(m)||m<=0)return!0;return!1}},custom:class extends a.Evented{constructor(m,i,c,y){super(),this.id=m,this.type="custom",this._dataType="raster",this._dispatcher=c,this._implementation=i,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new kt(this._implementation.bounds,this.minzoom,this.maxzoom)),i.update=this._update.bind(this),i.clearTiles=this._clearTiles.bind(this),i.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(i,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(m){this._map=m,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(m),this.load()}onRemove(m){this._implementation.onRemove&&this._implementation.onRemove(m)}hasTile(m){if(this._implementation.hasTile){const{x:i,y:c,z:y}=m.canonical;return this._implementation.hasTile({x:i,y:c,z:y})}return!this.tileBounds||this.tileBounds.contains(m.canonical)}loadTile(m,i){const{x:c,y,z:u}=m.tileID.canonical,p=new a.window.AbortController;m.request=Promise.resolve(this._implementation.loadTile({x:c,y,z:u},{signal:p.signal})).then(function(f){return delete m.request,m.aborted?(m.state="unloaded",i(null)):void 0===f?(m.state="errored",i(null)):null===f?(this.loadTileData(m,{width:this.tileSize,height:this.tileSize,data:null}),m.state="loaded",i(null)):(w=f)instanceof a.window.ImageData||w instanceof a.window.HTMLCanvasElement||w instanceof a.window.ImageBitmap||w instanceof a.window.HTMLImageElement?(this.loadTileData(m,f),m.state="loaded",void i(null)):(m.state="errored",i(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var w}.bind(this)).catch(f=>{20!==f.code&&(m.state="errored",i(f))}),m.request.cancel=()=>p.abort()}loadTileData(m,i){X.loadTileData(m,i,this._map.painter)}unloadTileData(m){X.unloadTileData(m,this._map.painter)}unloadTile(m,i){if(this.unloadTileData(m),this._implementation.unloadTile){const{x:c,y,z:u}=m.tileID.canonical;this._implementation.unloadTile({x:c,y,z:u})}i()}abortTile(m,i){m.request&&m.request.cancel&&(m.request.cancel(),delete m.request),i()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(m=>({x:m.canonical.x,y:m.canonical.y,z:m.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},vt=function(m,i,c,y){const u=new Ot[i.type](m,i,c,y);if(u.id!==m)throw new Error(`Expected Source id to be ${m} instead of ${u.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],u),u};function ut(m,i){const c=a.identity([]);return a.scale(c,c,[.5*m.width,.5*-m.height,1]),a.translate(c,c,[1,-1,0]),a.multiply(c,c,m.calculateProjMatrix(i.toUnwrapped())),Float32Array.from(c)}function Fe(m,i,c,y,u,p,f,w=!1){const E=m.tilesIn(y,f,w);E.sort(Me);const P=[];for(const V of E)P.push({wrappedTileID:V.tile.tileID.wrapped().key,queryResults:V.tile.queryRenderedFeatures(i,c,m._state,V,u,p,ut(m.transform,V.tile.tileID),w)});const O=function(V){const Q={},ye={};for(const be of V){const Oe=be.queryResults,Ne=be.wrappedTileID,ve=ye[Ne]=ye[Ne]||{};for(const tt in Oe){const qe=Oe[tt],nt=ve[tt]=ve[tt]||{},Tt=Q[tt]=Q[tt]||[];for(const ft of qe)nt[ft.featureIndex]||(nt[ft.featureIndex]=!0,Tt.push(ft))}}return Q}(P);for(const V in O)O[V].forEach(Q=>{const ye=Q.feature,be=ye.layer;be&&"background"!==be.type&&"sky"!==be.type&&(ye.source=be.source,be["source-layer"]&&(ye.sourceLayer=be["source-layer"]),ye.state=void 0!==ye.id?m.getFeatureState(be["source-layer"],ye.id):{})});return O}function Be(m,i){const c=m.getRenderableIds().map(p=>m.getTileByID(p)),y=[],u={};for(let p=0;p<c.length;p++){const f=c[p],w=f.tileID.canonical.key;u[w]||(u[w]=!0,f.querySourceFeatures(y,i))}return y}function Me(m,i){const c=m.tileID,y=i.tileID;return c.overscaledZ-y.overscaledZ||c.canonical.y-y.canonical.y||c.wrap-y.wrap||c.canonical.x-y.canonical.x}function We(){return null!=ic.workerClass?new ic.workerClass:new a.window.Worker(ic.workerUrl)}const jt="mapboxgl_preloaded_worker_pool";class dn{constructor(){this.active={}}acquire(i){if(!this.workers)for(this.workers=[];this.workers.length<dn.workerCount;)this.workers.push(new We);return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],0===this.numActive()&&(this.workers.forEach(c=>{c.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[jt]}numActive(){return Object.keys(this.active).length}}let Tn;function qn(){return Tn||(Tn=new dn),Tn}function Yn(m,i){const c={};for(const y in m)"ref"!==y&&(c[y]=m[y]);return a.refProperties.forEach(y=>{y in i&&(c[y]=i[y])}),c}function mi(m){m=m.slice();const i=Object.create(null);for(let c=0;c<m.length;c++)i[m[c].id]=m[c];for(let c=0;c<m.length;c++)"ref"in m[c]&&(m[c]=Yn(m[c],i[m[c].ref]));return m}dn.workerCount=2;const ei={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Oi(m,i,c){c.push({command:ei.addSource,args:[m,i[m]]})}function Li(m,i,c){i.push({command:ei.removeSource,args:[m]}),c[m]=!0}function Er(m,i,c,y){Li(m,c,y),Oi(m,i,c)}function Gr(m,i,c){let y;for(y in m[c])if(m[c].hasOwnProperty(y)&&"data"!==y&&!q(m[c][y],i[c][y]))return!1;for(y in i[c])if(i[c].hasOwnProperty(y)&&"data"!==y&&!q(m[c][y],i[c][y]))return!1;return!0}function Jt(m,i,c,y,u,p){let f;for(f in i=i||{},m=m||{})m.hasOwnProperty(f)&&(q(m[f],i[f])||c.push({command:p,args:[y,f,i[f],u]}));for(f in i)i.hasOwnProperty(f)&&!m.hasOwnProperty(f)&&(q(m[f],i[f])||c.push({command:p,args:[y,f,i[f],u]}))}function Xr(m){return m.id}function dr(m,i){return m[i.id]=i,m}class no{constructor(i,c){this.reset(i,c)}reset(i,c){this.points=i||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(c||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(i){if(1===this.points.length)return this.points[0];i=a.clamp(i,0,1);let c=1,y=this._distances[c];const u=i*this.paddedLength+this.padding;for(;y<u&&c<this._distances.length;)y=this._distances[++c];const p=c-1,f=this._distances[p],w=y-f,E=w>0?(u-f)/w:0;return this.points[p].mult(1-E).add(this.points[c].mult(E))}}class fo{constructor(i,c,y){const u=this.boxCells=[],p=this.circleCells=[];this.xCellCount=Math.ceil(i/y),this.yCellCount=Math.ceil(c/y);for(let f=0;f<this.xCellCount*this.yCellCount;f++)u.push([]),p.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=i,this.height=c,this.xScale=this.xCellCount/i,this.yScale=this.yCellCount/c,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(i,c,y,u,p){this._forEachCell(c,y,u,p,this._insertBoxCell,this.boxUid++),this.boxKeys.push(i),this.bboxes.push(c),this.bboxes.push(y),this.bboxes.push(u),this.bboxes.push(p)}insertCircle(i,c,y,u){this._forEachCell(c-u,y-u,c+u,y+u,this._insertCircleCell,this.circleUid++),this.circleKeys.push(i),this.circles.push(c),this.circles.push(y),this.circles.push(u)}_insertBoxCell(i,c,y,u,p,f){this.boxCells[p].push(f)}_insertCircleCell(i,c,y,u,p,f){this.circleCells[p].push(f)}_query(i,c,y,u,p,f){if(y<0||i>this.width||u<0||c>this.height)return!p&&[];const w=[];if(i<=0&&c<=0&&this.width<=y&&this.height<=u){if(p)return!0;for(let E=0;E<this.boxKeys.length;E++)w.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const P=this.circles[3*E],O=this.circles[3*E+1],V=this.circles[3*E+2];w.push({key:this.circleKeys[E],x1:P-V,y1:O-V,x2:P+V,y2:O+V})}return f?w.filter(f):w}return this._forEachCell(i,c,y,u,this._queryCell,w,{hitTest:p,seenUids:{box:{},circle:{}}},f),p?w.length>0:w}_queryCircle(i,c,y,u,p){const f=i-y,w=i+y,E=c-y,P=c+y;if(w<0||f>this.width||P<0||E>this.height)return!u&&[];const O=[];return this._forEachCell(f,E,w,P,this._queryCellCircle,O,{hitTest:u,circle:{x:i,y:c,radius:y},seenUids:{box:{},circle:{}}},p),u?O.length>0:O}query(i,c,y,u,p){return this._query(i,c,y,u,!1,p)}hitTest(i,c,y,u,p){return this._query(i,c,y,u,!0,p)}hitTestCircle(i,c,y,u){return this._queryCircle(i,c,y,!0,u)}_queryCell(i,c,y,u,p,f,w,E){const P=w.seenUids,O=this.boxCells[p];if(null!==O){const Q=this.bboxes;for(const ye of O)if(!P.box[ye]){P.box[ye]=!0;const be=4*ye;if(i<=Q[be+2]&&c<=Q[be+3]&&y>=Q[be+0]&&u>=Q[be+1]&&(!E||E(this.boxKeys[ye]))){if(w.hitTest)return f.push(!0),!0;f.push({key:this.boxKeys[ye],x1:Q[be],y1:Q[be+1],x2:Q[be+2],y2:Q[be+3]})}}}const V=this.circleCells[p];if(null!==V){const Q=this.circles;for(const ye of V)if(!P.circle[ye]){P.circle[ye]=!0;const be=3*ye;if(this._circleAndRectCollide(Q[be],Q[be+1],Q[be+2],i,c,y,u)&&(!E||E(this.circleKeys[ye]))){if(w.hitTest)return f.push(!0),!0;{const Oe=Q[be],Ne=Q[be+1],ve=Q[be+2];f.push({key:this.circleKeys[ye],x1:Oe-ve,y1:Ne-ve,x2:Oe+ve,y2:Ne+ve})}}}}}_queryCellCircle(i,c,y,u,p,f,w,E){const P=w.circle,O=w.seenUids,V=this.boxCells[p];if(null!==V){const ye=this.bboxes;for(const be of V)if(!O.box[be]){O.box[be]=!0;const Oe=4*be;if(this._circleAndRectCollide(P.x,P.y,P.radius,ye[Oe+0],ye[Oe+1],ye[Oe+2],ye[Oe+3])&&(!E||E(this.boxKeys[be])))return f.push(!0),!0}}const Q=this.circleCells[p];if(null!==Q){const ye=this.circles;for(const be of Q)if(!O.circle[be]){O.circle[be]=!0;const Oe=3*be;if(this._circlesCollide(ye[Oe],ye[Oe+1],ye[Oe+2],P.x,P.y,P.radius)&&(!E||E(this.circleKeys[be])))return f.push(!0),!0}}}_forEachCell(i,c,y,u,p,f,w,E){const P=this._convertToXCellCoord(i),O=this._convertToYCellCoord(c),V=this._convertToXCellCoord(y),Q=this._convertToYCellCoord(u);for(let ye=P;ye<=V;ye++)for(let be=O;be<=Q;be++)if(p.call(this,i,c,y,u,this.xCellCount*be+ye,f,w,E))return}_convertToXCellCoord(i){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(i*this.xScale)))}_convertToYCellCoord(i){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(i*this.yScale)))}_circlesCollide(i,c,y,u,p,f){const w=u-i,E=p-c,P=y+f;return P*P>w*w+E*E}_circleAndRectCollide(i,c,y,u,p,f,w){const E=(f-u)/2,P=Math.abs(i-(u+E));if(P>E+y)return!1;const O=(w-p)/2,V=Math.abs(c-(p+O));if(V>O+y)return!1;if(P<=E||V<=O)return!0;const Q=P-E,ye=V-O;return Q*Q+ye*ye<=y*y}}const bi=Math.tan(85*Math.PI/180);function qi(m,i,c,y,u,p,f){const w=a.create();if(c)if("globe"===p.name){const E=a.calculateGlobeLabelMatrix(u,i);a.multiply(w,w,E)}else{const E=ge([],f);w[0]=E[0],w[1]=E[1],w[4]=E[2],w[5]=E[3],y||a.rotateZ(w,w,u.angle)}else a.multiply(w,u.labelPlaneMatrix,m);return w}function Dr(m,i,c,y,u,p,f){const w=qi(m,i,c,y,u,p,f);return"globe"===p.name&&c||(w[2]=w[6]=w[10]=w[14]=0),w}function Kr(m,i,c,y,u,p,f){if(c){if("globe"===p.name){const w=qi(m,i,c,y,u,p,f);return a.invert(w,w),a.multiply(w,m,w),w}{const w=a.clone(m),E=a.identity([]);return E[0]=f[0],E[1]=f[1],E[4]=f[2],E[5]=f[3],a.multiply(w,w,E),y||a.rotateZ(w,w,-u.angle),w}}return u.glCoordMatrix}function In(m,i,c,y){const u=[m,i,c,1];c?a.transformMat4$1(u,u,y):gn(u,u,y);const p=u[3];return u[0]/=p,u[1]/=p,u[2]/=p,u}function si(m,i){return Math.min(.5+m/i*.5,1.5)}function En(m,i){const c=m[0]/m[3],y=m[1]/m[3];return c>=-i[0]&&c<=i[0]&&y>=-i[1]&&y<=i[1]}function fe(m,i,c,y,u,p,f,w,E,P){const O=c.transform,V=y?m.textSizeData:m.iconSizeData,Q=a.evaluateSizeForZoom(V,c.transform.zoom),ye="globe"===O.projection.name,be=[256/c.width*2+1,256/c.height*2+1],Oe=y?m.text.dynamicLayoutVertexArray:m.icon.dynamicLayoutVertexArray;Oe.clear();let Ne=null;ye&&(Ne=y?m.text.globeExtVertexArray:m.icon.globeExtVertexArray);const ve=m.lineVertexArray,tt=y?m.text.placedSymbolArray:m.icon.placedSymbolArray,qe=c.transform.width/c.transform.height;let nt,Tt=!1;for(let ft=0;ft<tt.length;ft++){const At=tt.get(ft),{numGlyphs:Zt,writingMode:Kt}=At;if(Kt!==a.WritingMode.vertical||Tt||nt===a.WritingMode.horizontal||(Tt=!0),nt=Kt,(At.hidden||Kt===a.WritingMode.vertical)&&!Tt){Ft(Zt,Oe);continue}Tt=!1;const nn=new a.pointGeometry(At.tileAnchorX,At.tileAnchorY);let{x:Bn,y:qt,z:xn}=O.projection.projectTilePoint(nn.x,nn.y,P.canonical);if(E){const[zi,ti,Xn]=E(nn);Bn+=zi,qt+=ti,xn+=Xn}const cn=[Bn,qt,xn,1];if(a.transformMat4$1(cn,cn,i),!En(cn,be)){Ft(Zt,Oe);continue}const An=si(c.transform.cameraToCenterDistance,cn[3]),tn=a.evaluateSizeForFeature(V,Q,At),$t=f?tn/An:tn*An,on=In(Bn,qt,xn,u);if(on[3]<=0){Ft(Zt,Oe);continue}let wn={};const On=f?null:E,ri=zt(At,$t,!1,w,i,u,p,m.glyphOffsetArray,ve,Oe,Ne,on,nn,wn,qe,On,O.projection,P,f);Tt=ri.useVertical,On&&ri.needsFlipping&&(wn={}),(ri.notEnoughRoom||Tt||ri.needsFlipping&&zt(At,$t,!0,w,i,u,p,m.glyphOffsetArray,ve,Oe,Ne,on,nn,wn,qe,On,O.projection,P,f).notEnoughRoom)&&Ft(Zt,Oe)}y?(m.text.dynamicLayoutVertexBuffer.updateData(Oe),Ne&&m.text.globeExtVertexBuffer.updateData(Ne)):(m.icon.dynamicLayoutVertexBuffer.updateData(Oe),Ne&&m.icon.globeExtVertexBuffer.updateData(Ne))}function $e(m,i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe){const{lineStartIndex:Ne,glyphStartIndex:ve,segment:tt}=w,qe=ve+w.numGlyphs,nt=Ne+w.lineLength,Tt=i.getoffsetX(ve),ft=i.getoffsetX(qe-1),At=gt(m*Tt,c,y,u,p,f,tt,Ne,nt,E,P,O,V,Q,!0,ye,be,Oe);if(!At)return null;const Zt=gt(m*ft,c,y,u,p,f,tt,Ne,nt,E,P,O,V,Q,!0,ye,be,Oe);return Zt?{first:At,last:Zt}:null}function ct(m,i,c,y){return m===a.WritingMode.horizontal&&Math.abs(y)>Math.abs(c)?{useVertical:!0}:m===a.WritingMode.vertical?y>0?{needsFlipping:!0}:null:0!==i&&(0===(u=c)||Math.abs(y/u)>bi)?1===i?{needsFlipping:!0}:null:c<0?{needsFlipping:!0}:null;var u}function zt(m,i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe,Ne,ve,tt){const qe=i/24,nt=m.lineOffsetX*qe,Tt=m.lineOffsetY*qe,{lineStartIndex:ft,glyphStartIndex:At,numGlyphs:Zt,segment:Kt,writingMode:nn,flipState:Bn}=m,qt=ft+m.lineLength,xn=cn=>{if(O){const[on,wn,On]=cn.up,ri=P.length;a.updateGlobeVertexNormal(O,ri+0,on,wn,On),a.updateGlobeVertexNormal(O,ri+1,on,wn,On),a.updateGlobeVertexNormal(O,ri+2,on,wn,On),a.updateGlobeVertexNormal(O,ri+3,on,wn,On)}const[An,tn,$t]=cn.point;a.addDynamicAttributes(P,An,tn,$t,cn.angle)};if(Zt>1){const cn=$e(qe,w,nt,Tt,c,V,Q,m,E,p,ye,Oe,!1,Ne,ve,tt);if(!cn)return{notEnoughRoom:!0};if(y&&!c){let[An,tn,$t]=cn.first.point,[on,wn,On]=cn.last.point;[An,tn]=In(An,tn,$t,f),[on,wn]=In(on,wn,On,f);const ri=ct(nn,Bn,(on-An)*be,wn-tn);if(m.flipState=ri&&ri.needsFlipping?1:2,ri)return ri}xn(cn.first);for(let An=At+1;An<At+Zt-1;An++){const tn=gt(qe*w.getoffsetX(An),nt,Tt,c,V,Q,Kt,ft,qt,E,p,ye,Oe,!1,!1,Ne,ve,tt);if(!tn)return P.length-=4*(An-At),{notEnoughRoom:!0};xn(tn)}xn(cn.last)}else{if(y&&!c){const An=In(Q.x,Q.y,0,u),tn=ft+Kt+1,$t=new a.pointGeometry(E.getx(tn),E.gety(tn)),on=In($t.x,$t.y,0,u),wn=on[3]>0?on:je(Q,$t,An,1,u,void 0,Ne,ve.canonical),On=ct(nn,Bn,(wn[0]-An[0])*be,wn[1]-An[1]);if(m.flipState=On&&On.needsFlipping?1:2,On)return On}const cn=gt(qe*w.getoffsetX(At),nt,Tt,c,V,Q,Kt,ft,qt,E,p,ye,Oe,!1,!1,Ne,ve,tt);if(!cn)return{notEnoughRoom:!0};xn(cn)}return{}}function en(m,i,c,y,u){const{x:p,y:f,z:w}=y.projectTilePoint(m.x,m.y,i);if(!u)return In(p,f,w,c);const[E,P,O]=u(m);return In(p+E,f+P,w+O,c)}function je(m,i,c,y,u,p,f,w){const E=en(m.sub(i)._unit()._add(m),w,u,f,p);return a.sub(E,c,E),a.normalize(E,E),a.scaleAndAdd(E,c,E,y)}function gt(m,i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe,Ne,ve){const tt=y?m-i:m+i;let qe=tt>0?1:-1,nt=0;y&&(qe*=-1,nt=Math.PI),qe<0&&(nt+=Math.PI);let Tt=w+f+(qe>0?0:1)|0,ft=u,At=u,Zt=0,Kt=0;const nn=Math.abs(tt),Bn=[],qt=[];let xn=p,cn=xn;const An=()=>je(cn,xn,At,nn-Zt+1,O,Q,Oe,Ne.canonical);for(;Zt+Kt<=nn;){if(Tt+=qe,Tt<w||Tt>=E)return null;if(At=ft,cn=xn,Bn.push(At),ye&&qt.push(cn),xn=new a.pointGeometry(P.getx(Tt),P.gety(Tt)),ft=V[Tt],!ft){const Xn=en(xn,Ne.canonical,O,Oe,Q);ft=Xn[3]>0?V[Tt]=Xn:An()}Zt+=Kt,Kt=a.distance(At,ft)}be&&Q&&(V[Tt]&&(ft=An(),Kt=a.distance(At,ft)),V[Tt]=ft);const tn=(nn-Zt)/Kt,$t=xn.sub(cn)._mult(tn)._add(cn),on=a.sub([],ft,At),wn=a.scaleAndAdd([],At,on,tn);let On=[0,0,1],ri=on[0],zi=on[1];if(ve&&(On=Oe.upVector(Ne.canonical,$t.x,$t.y),0!==On[0]||0!==On[1]||1!==On[2])){const Xn=[On[2],0,-On[0]],di=a.cross([],On,Xn);a.normalize(Xn,Xn),a.normalize(di,di),ri=a.dot(on,Xn),zi=a.dot(on,di)}if(c){const Xn=a.cross([],On,on);a.normalize(Xn,Xn),a.scaleAndAdd(wn,wn,Xn,c*qe)}const ti=nt+Math.atan2(zi,ri);return Bn.push(wn),ye&&qt.push($t),{point:wn,angle:ti,path:Bn,tilePath:qt,up:On}}function Ft(m,i){const c=i.length,y=c+4*m;i.resize(y),i.float32.fill(-1/0,4*c,4*y)}function gn(m,i,c){const y=i[0],u=i[1];return m[0]=c[0]*y+c[4]*u+c[12],m[1]=c[1]*y+c[5]*u+c[13],m[3]=c[3]*y+c[7]*u+c[15],m}const Yt=100;class Gn{constructor(i,c,y=new fo(i.width+200,i.height+200,25),u=new fo(i.width+200,i.height+200,25)){this.transform=i,this.grid=y,this.ignoredGrid=u,this.pitchfactor=Math.cos(i._pitch)*i.cameraToCenterDistance,this.screenRightBoundary=i.width+Yt,this.screenBottomBoundary=i.height+Yt,this.gridRightBoundary=i.width+200,this.gridBottomBoundary=i.height+200,this.fogState=c}placeCollisionBox(i,c,y,u,p,f,w,E){let P=y.projectedAnchorX,O=y.projectedAnchorY,V=y.projectedAnchorZ;const Q=y.elevation,ye=y.tileID,be=i.getProjection();if(Q&&ye){const[ft,At,Zt]=be.upVector(ye.canonical,y.tileAnchorX,y.tileAnchorY),Kt=be.upVectorScale(ye.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;P+=ft*Q*Kt,O+=At*Q*Kt,V+=Zt*Q*Kt}const Oe=this.projectAndGetPerspectiveRatio(w,P,O,V,y.tileID,"globe"===be.name||!!Q||this.transform.pitch>0,be),Ne=f*Oe.perspectiveRatio,ve=(y.x1*c+u.x-y.padding)*Ne+Oe.point.x,tt=(y.y1*c+u.y-y.padding)*Ne+Oe.point.y,qe=(y.x2*c+u.x+y.padding)*Ne+Oe.point.x,nt=(y.y2*c+u.y+y.padding)*Ne+Oe.point.y,Tt=Oe.perspectiveRatio<=.55||Oe.occluded;return!this.isInsideGrid(ve,tt,qe,nt)||!p&&this.grid.hitTest(ve,tt,qe,nt,E)||Tt?{box:[],offscreen:!1,occluded:Oe.occluded}:{box:[ve,tt,qe,nt],offscreen:this.isOffscreen(ve,tt,qe,nt),occluded:!1}}placeCollisionCircles(i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe){const Ne=[],ve=this.transform.elevation,tt=i.getProjection(),qe=ve?ve.getAtTileOffsetFunc(Oe,this.transform.center.lat,this.transform.worldSize,tt):null,nt=new a.pointGeometry(y.tileAnchorX,y.tileAnchorY);let{x:Tt,y:ft,z:At}=tt.projectTilePoint(nt.x,nt.y,Oe.canonical);if(qe){const[$t,on,wn]=qe(nt);Tt+=$t,ft+=on,At+=wn}const Zt="globe"===tt.name,Kt=this.projectAndGetPerspectiveRatio(w,Tt,ft,At,Oe,Zt||!!ve||this.transform.pitch>0,tt),{perspectiveRatio:nn}=Kt,Bn=(V?f/nn:f*nn)/a.ONE_EM,qt=In(Tt,ft,At,E),xn=Kt.signedDistanceFromCamera>0?$e(Bn,p,y.lineOffsetX*Bn,y.lineOffsetY*Bn,!1,qt,nt,y,u,E,{},ve&&!V?qe:null,V&&!!ve,tt,Oe,V):null;let cn=!1,An=!1,tn=!0;if(xn&&!Kt.occluded){const $t=.5*ye*nn+be,on=new a.pointGeometry(-100,-100),wn=new a.pointGeometry(this.screenRightBoundary,this.screenBottomBoundary),On=new no,{first:ri,last:zi}=xn,ti=ri.path.length;let Xn=[];for(let gi=ti-1;gi>=1;gi--)Xn.push(ri.path[gi]);for(let gi=1;gi<zi.path.length;gi++)Xn.push(zi.path[gi]);const di=2.5*$t;P&&(Xn=Xn.map(([gi,Tr,Or],Rr)=>(qe&&!Zt&&(Or=qe(Rr<ti-1?ri.tilePath[ti-1-Rr]:zi.tilePath[Rr-ti+2])[2]),In(gi,Tr,Or,P))),Xn.some(gi=>gi[3]<=0)&&(Xn=[]));let Ji=[];if(Xn.length>0){let gi=1/0,Tr=-1/0,Or=1/0,Rr=-1/0;for(const Vr of Xn)gi=Math.min(gi,Vr[0]),Or=Math.min(Or,Vr[1]),Tr=Math.max(Tr,Vr[0]),Rr=Math.max(Rr,Vr[1]);Tr>=on.x&&gi<=wn.x&&Rr>=on.y&&Or<=wn.y&&(Ji=[Xn.map(Vr=>new a.pointGeometry(Vr[0],Vr[1]))],(gi<on.x||Tr>wn.x||Or<on.y||Rr>wn.y)&&(Ji=a.clipLine(Ji,on.x,on.y,wn.x,wn.y)))}for(const gi of Ji){On.reset(gi,.25*$t);let Tr=0;Tr=On.length<=.5*$t?1:Math.ceil(On.paddedLength/di)+1;for(let Or=0;Or<Tr;Or++){const Rr=Or/Math.max(Tr-1,1),Vr=On.lerp(Rr),Ao=Vr.x+Yt,bs=Vr.y+Yt;Ne.push(Ao,bs,$t,0);const Ka=Ao-$t,Ll=bs-$t,to=Ao+$t,jr=bs+$t;if(tn=tn&&this.isOffscreen(Ka,Ll,to,jr),An=An||this.isInsideGrid(Ka,Ll,to,jr),!c&&this.grid.hitTestCircle(Ao,bs,$t,Q)&&(cn=!0,!O))return{circles:[],offscreen:!1,collisionDetected:cn,occluded:!1}}}}return{circles:!O&&cn||!An?[]:Ne,offscreen:tn,collisionDetected:cn,occluded:Kt.occluded}}queryRenderedSymbols(i){if(0===i.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const c=[];let y=1/0,u=1/0,p=-1/0,f=-1/0;for(const O of i){const V=new a.pointGeometry(O.x+Yt,O.y+Yt);y=Math.min(y,V.x),u=Math.min(u,V.y),p=Math.max(p,V.x),f=Math.max(f,V.y),c.push(V)}const w=this.grid.query(y,u,p,f).concat(this.ignoredGrid.query(y,u,p,f)),E={},P={};for(const O of w){const V=O.key;if(void 0===E[V.bucketInstanceId]&&(E[V.bucketInstanceId]={}),E[V.bucketInstanceId][V.featureIndex])continue;const Q=[new a.pointGeometry(O.x1,O.y1),new a.pointGeometry(O.x2,O.y1),new a.pointGeometry(O.x2,O.y2),new a.pointGeometry(O.x1,O.y2)];a.polygonIntersectsPolygon(c,Q)&&(E[V.bucketInstanceId][V.featureIndex]=!0,void 0===P[V.bucketInstanceId]&&(P[V.bucketInstanceId]=[]),P[V.bucketInstanceId].push(V.featureIndex))}return P}insertCollisionBox(i,c,y,u,p){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:u,collisionGroupID:p},i[0],i[1],i[2],i[3])}insertCollisionCircles(i,c,y,u,p){const f=c?this.ignoredGrid:this.grid,w={bucketInstanceId:y,featureIndex:u,collisionGroupID:p};for(let E=0;E<i.length;E+=4)f.insertCircle(w,i[E],i[E+1],i[E+2])}projectAndGetPerspectiveRatio(i,c,y,u,p,f,w){const E=[c,y,u,1];let P=!1;u||this.transform.pitch>0?(a.transformMat4$1(E,E,i),this.fogState&&p&&"globe"!==w.name&&(P=function(ye,be,Oe,Ne,ve,tt){const qe=tt.calculateFogTileMatrix(ve),nt=[be,Oe,Ne];return a.transformMat4(nt,nt,qe),Ee(ye,nt,tt.pitch,tt._fov)}(this.fogState,c,y,u,p.toUnwrapped(),this.transform)>.9)):gn(E,E,i);const O=E[3];return{point:new a.pointGeometry((E[0]/O+1)/2*this.transform.width+Yt,(-E[1]/O+1)/2*this.transform.height+Yt),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(w)/O*.5,1.5),signedDistanceFromCamera:O,occluded:f&&E[2]>O||P}}isOffscreen(i,c,y,u){return y<Yt||i>=this.screenRightBoundary||u<Yt||c>this.screenBottomBoundary}isInsideGrid(i,c,y,u){return y>=0&&i<this.gridRightBoundary&&u>=0&&c<this.gridBottomBoundary}getViewportMatrix(){const i=a.identity([]);return a.translate(i,i,[-100,-100,0]),i}}function Hn(m,i,c){const y=i.createTileMatrix(m,m.worldSize,c.toUnwrapped());return a.multiply(new Float32Array(16),m.projMatrix,y)}function Ai(m,i,c){if(i.projection.name===c.projection.name)return m.projMatrix;const y=c.clone();return y.setProjection(i.projection),Hn(y,i.getProjection(),m)}function Fi(m,i,c){return i.name===c.projection.name?m.projMatrix:Hn(c,i,m)}class Vi{constructor(i,c,y,u){this.opacity=i?Math.max(0,Math.min(1,i.opacity+(i.placed?c:-c))):u&&y?1:0,this.placed=y}isHidden(){return 0===this.opacity&&!this.placed}}class Ir{constructor(i,c,y,u,p,f=!1){this.text=new Vi(i?i.text:null,c,y,p),this.icon=new Vi(i?i.icon:null,c,u,p),this.clipped=f}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Qi{constructor(i,c,y,u=!1){this.text=i,this.icon=c,this.skipFade=y,this.clipped=u}}class Hr{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class zr{constructor(i,c,y,u,p){this.bucketInstanceId=i,this.featureIndex=c,this.sourceLayerIndex=y,this.bucketIndex=u,this.tileID=p}}class hr{constructor(i){this.crossSourceCollisions=i,this.maxGroupID=0,this.collisionGroups={}}get(i){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[i]){const c=++this.maxGroupID;this.collisionGroups[i]={ID:c,predicate:y=>y.collisionGroupID===c}}return this.collisionGroups[i]}}function lr(m,i,c,y,u){const{horizontalAlign:p,verticalAlign:f}=a.getAnchorAlignment(m),w=-(p-.5)*i,E=-(f-.5)*c,P=a.evaluateVariableOffset(m,y);return new a.pointGeometry(w+P[0]*u,E+P[1]*u)}function la(m,i,c,y,u){const p=new a.pointGeometry(m,i);return c&&p._rotate(y?u:-u),p}class io{constructor(i,c,y,u,p){this.transform=i.clone(),this.projection=i.projection.name,this.collisionIndex=new Gn(this.transform,p),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new hr(y),this.collisionCircleArrays={},this.prevPlacement=u,u&&(u.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(i,c,y,u){const p=y.getBucket(c),f=y.latestFeatureIndex;if(!p||!f||c.id!==p.layerIds[0])return;const w=p.layers[0].layout,E=y.collisionBoxArray,P=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),O=y.tileSize/a.EXTENT,V=y.tileID.toUnwrapped();this.transform.setProjection(p.projection);const Q=(ye=y.tileID,be=p.getProjection(),Oe=this.transform,be.name===this.projection?Oe.calculateProjMatrix(ye.toUnwrapped()):Hn(Oe,be,ye));var ye,be,Oe;const Ne="map"===w.get("text-pitch-alignment"),ve="map"===w.get("text-rotation-alignment");c.compileFilter();const tt=c.dynamicFilter(),qe=c.dynamicFilterNeedsFeature(),nt=this.transform.calculatePixelsToTileUnitsMatrix(y),Tt=Dr(Q,y.tileID.canonical,Ne,ve,this.transform,p.getProjection(),nt);let ft=null;if(Ne){const Kt=Kr(Q,y.tileID.canonical,Ne,ve,this.transform,p.getProjection(),nt);ft=a.multiply([],this.transform.labelPlaneMatrix,Kt)}let At=null;tt&&y.latestFeatureIndex&&(At={unwrappedTileID:V,dynamicFilter:tt,dynamicFilterNeedsFeature:qe,featureIndex:y.latestFeatureIndex}),this.retainedQueryData[p.bucketInstanceId]=new zr(p.bucketInstanceId,f,p.sourceLayerIndex,p.index,y.tileID);const Zt={bucket:p,layout:w,posMatrix:Q,textLabelPlaneMatrix:Tt,labelToScreenMatrix:ft,clippingData:At,scale:P,textPixelRatio:O,holdingForFade:y.holdingForFade(),collisionBoxArray:E,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(p.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(p.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(p.sourceID)};if(u)for(const Kt of p.sortKeyRanges){const{sortKey:nn,symbolInstanceStart:Bn,symbolInstanceEnd:qt}=Kt;i.push({sortKey:nn,symbolInstanceStart:Bn,symbolInstanceEnd:qt,parameters:Zt})}else i.push({symbolInstanceStart:0,symbolInstanceEnd:p.symbolInstances.length,parameters:Zt})}attemptAnchorPlacement(i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe,Ne,ve,tt){const{textOffset0:qe,textOffset1:nt,crossTileID:Tt}=Q,ft=[qe,nt],At=lr(i,y,u,ft,p),Zt=this.collisionIndex.placeCollisionBox(be,p,c,la(At.x,At.y,f,w,this.transform.angle),V,E,P,O.predicate);if(Ne){const Kt=be.getSymbolInstanceIconSize(tt,this.transform.zoom,Q.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(be,Kt,Ne,la(At.x,At.y,f,w,this.transform.angle),V,E,P,O.predicate).box.length)return}if(Zt.box.length>0){let Kt;return this.prevPlacement&&this.prevPlacement.variableOffsets[Tt]&&this.prevPlacement.placements[Tt]&&this.prevPlacement.placements[Tt].text&&(Kt=this.prevPlacement.variableOffsets[Tt].anchor),this.variableOffsets[Tt]={textOffset:ft,width:y,height:u,anchor:i,textScale:p,prevAnchor:Kt},this.markUsedJustification(be,i,Q,Oe),be.allowVerticalPlacement&&(this.markUsedOrientation(be,Oe,Q),this.placedOrientations[Tt]=Oe),{shift:At,placedGlyphBoxes:Zt}}}placeLayerBucketPart(i,c,y,u){const{bucket:p,layout:f,posMatrix:w,textLabelPlaneMatrix:E,labelToScreenMatrix:P,clippingData:O,textPixelRatio:V,holdingForFade:Q,collisionBoxArray:ye,partiallyEvaluatedTextSize:be,partiallyEvaluatedIconSize:Oe,collisionGroup:Ne}=i.parameters,ve=f.get("text-optional"),tt=f.get("icon-optional"),qe=f.get("text-allow-overlap"),nt=f.get("icon-allow-overlap"),Tt="map"===f.get("text-rotation-alignment"),ft="map"===f.get("text-pitch-alignment"),At="none"!==f.get("icon-text-fit"),Zt="viewport-y"===f.get("symbol-z-order");this.transform.setProjection(p.projection);let Kt=qe&&(nt||!p.hasIconData()||tt),nn=nt&&(qe||!p.hasTextData()||ve);!p.collisionArrays&&ye&&p.deserializeCollisionBoxes(ye),y&&u&&p.updateCollisionDebugBuffers(this.transform.zoom,ye);const Bn=(qt,xn,cn)=>{const{crossTileID:An,numVerticalGlyphVertices:tn}=qt;if(O){const to={zoom:this.transform.zoom,pitch:this.transform.pitch};let jr=null;if(O.dynamicFilterNeedsFeature){const yr=this.retainedQueryData[p.bucketInstanceId];jr=O.featureIndex.loadFeature({featureIndex:qt.featureIndex,bucketIndex:yr.bucketIndex,sourceLayerIndex:yr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,O.dynamicFilter)(to,jr,this.retainedQueryData[p.bucketInstanceId].tileID.canonical,new a.pointGeometry(qt.tileAnchorX,qt.tileAnchorY),this.transform.calculateDistanceTileData(O.unwrappedTileID)))return this.placements[An]=new Qi(!1,!1,!1,!0),void(c[An]=!0)}if(c[An])return;if(Q)return void(this.placements[An]=new Qi(!1,!1,!1));let $t=!1,on=!1,wn=!0,On=!1,ri=!1,zi=null,ti={box:null,offscreen:null,occluded:null},Xn={box:null,offscreen:null,occluded:null},di=null,Ji=null,gi=null,Tr=0,Or=0,Rr=0;cn.textFeatureIndex?Tr=cn.textFeatureIndex:qt.useRuntimeCollisionCircles&&(Tr=qt.featureIndex),cn.verticalTextFeatureIndex&&(Or=cn.verticalTextFeatureIndex);const Vr=to=>{to.tileID=this.retainedQueryData[p.bucketInstanceId].tileID;const jr=this.transform.elevation;(jr||to.elevation)&&(to.elevation=jr?jr.getAtTileOffset(to.tileID,to.tileAnchorX,to.tileAnchorY):0)},Ao=cn.textBox;if(Ao){Vr(Ao);const to=yr=>{let ho=a.WritingMode.horizontal;if(p.allowVerticalPlacement&&!yr&&this.prevPlacement){const is=this.prevPlacement.placedOrientations[An];is&&(this.placedOrientations[An]=is,ho=is,this.markUsedOrientation(p,ho,qt))}return ho},jr=(yr,ho)=>{if(p.allowVerticalPlacement&&tn>0&&cn.verticalTextBox){for(const is of p.writingModes)if(is===a.WritingMode.vertical?(ti=ho(),Xn=ti):ti=yr(),ti&&ti.box&&ti.box.length)break}else ti=yr()};if(f.get("text-variable-anchor")){let yr=f.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[An]){const Nr=this.prevPlacement.variableOffsets[An];yr.indexOf(Nr.anchor)>0&&(yr=yr.filter(rs=>rs!==Nr.anchor),yr.unshift(Nr.anchor))}const ho=(Nr,rs,os)=>{const hl=p.getSymbolInstanceTextSize(be,qt,this.transform.zoom,xn),zs=(Nr.x2-Nr.x1)*hl+2*Nr.padding,na=(Nr.y2-Nr.y1)*hl+2*Nr.padding,va=At&&!nt?rs:null;va&&Vr(va);let pl={box:[],offscreen:!1,occluded:!1};const fl=qe?2*yr.length:yr.length;for(let Qa=0;Qa<fl;++Qa){const Rc=this.attemptAnchorPlacement(yr[Qa%yr.length],Nr,zs,na,hl,Tt,ft,V,w,Ne,Qa>=yr.length,qt,xn,p,os,va,be,Oe);if(Rc&&(pl=Rc.placedGlyphBoxes,pl&&pl.box&&pl.box.length)){$t=!0,zi=Rc.shift;break}}return pl};jr(()=>ho(Ao,cn.iconBox,a.WritingMode.horizontal),()=>{const Nr=cn.verticalTextBox;return Nr&&Vr(Nr),p.allowVerticalPlacement&&!(ti&&ti.box&&ti.box.length)&&tn>0&&Nr?ho(Nr,cn.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),ti&&($t=ti.box,wn=ti.offscreen,On=ti.occluded);const is=to(ti&&ti.box);if(!$t&&this.prevPlacement){const Nr=this.prevPlacement.variableOffsets[An];Nr&&(this.variableOffsets[An]=Nr,this.markUsedJustification(p,Nr.anchor,qt,is))}}else{const yr=(ho,is)=>{const Nr=p.getSymbolInstanceTextSize(be,qt,this.transform.zoom,xn),rs=this.collisionIndex.placeCollisionBox(p,Nr,ho,new a.pointGeometry(0,0),qe,V,w,Ne.predicate);return rs&&rs.box&&rs.box.length&&(this.markUsedOrientation(p,is,qt),this.placedOrientations[An]=is),rs};jr(()=>yr(Ao,a.WritingMode.horizontal),()=>{const ho=cn.verticalTextBox;return p.allowVerticalPlacement&&tn>0&&ho?(Vr(ho),yr(ho,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),to(ti&&ti.box&&ti.box.length)}}if(di=ti,$t=di&&di.box&&di.box.length>0,wn=di&&di.offscreen,On=di&&di.occluded,qt.useRuntimeCollisionCircles){const to=p.text.placedSymbolArray.get(qt.centerJustifiedTextSymbolIndex>=0?qt.centerJustifiedTextSymbolIndex:qt.verticalPlacedTextSymbolIndex),jr=a.evaluateSizeForFeature(p.textSizeData,be,to),yr=f.get("text-padding");Ji=this.collisionIndex.placeCollisionCircles(p,qe,to,p.lineVertexArray,p.glyphOffsetArray,jr,w,E,P,y,ft,Ne.predicate,qt.collisionCircleDiameter*jr/a.ONE_EM,yr,this.retainedQueryData[p.bucketInstanceId].tileID),$t=qe||Ji.circles.length>0&&!Ji.collisionDetected,wn=wn&&Ji.offscreen,On=Ji.occluded}if(cn.iconFeatureIndex&&(Rr=cn.iconFeatureIndex),cn.iconBox){const to=jr=>{Vr(jr);const yr=At&&zi?la(zi.x,zi.y,Tt,ft,this.transform.angle):new a.pointGeometry(0,0),ho=p.getSymbolInstanceIconSize(Oe,this.transform.zoom,qt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(p,ho,jr,yr,nt,V,w,Ne.predicate)};Xn&&Xn.box&&Xn.box.length&&cn.verticalIconBox?(gi=to(cn.verticalIconBox),on=gi.box.length>0):(gi=to(cn.iconBox),on=gi.box.length>0),wn=wn&&gi.offscreen,ri=gi.occluded}const bs=ve||0===qt.numHorizontalGlyphVertices&&0===tn,Ka=tt||0===qt.numIconVertices;if(bs||Ka?Ka?bs||(on=on&&$t):$t=on&&$t:on=$t=on&&$t,$t&&di&&di.box&&this.collisionIndex.insertCollisionBox(di.box,f.get("text-ignore-placement"),p.bucketInstanceId,Xn&&Xn.box&&Or?Or:Tr,Ne.ID),on&&gi&&this.collisionIndex.insertCollisionBox(gi.box,f.get("icon-ignore-placement"),p.bucketInstanceId,Rr,Ne.ID),Ji&&($t&&this.collisionIndex.insertCollisionCircles(Ji.circles,f.get("text-ignore-placement"),p.bucketInstanceId,Tr,Ne.ID),y)){const to=p.bucketInstanceId;let jr=this.collisionCircleArrays[to];void 0===jr&&(jr=this.collisionCircleArrays[to]=new Hr);for(let yr=0;yr<Ji.circles.length;yr+=4)jr.circles.push(Ji.circles[yr+0]),jr.circles.push(Ji.circles[yr+1]),jr.circles.push(Ji.circles[yr+2]),jr.circles.push(Ji.collisionDetected?1:0)}const Ll="globe"!==p.projection.name;Kt=Kt&&(Ll||!On),nn=nn&&(Ll||!ri),this.placements[An]=new Qi($t||Kt,on||nn,wn||p.justReloaded),c[An]=!0};if(Zt){const qt=p.getSortedSymbolIndexes(this.transform.angle);for(let xn=qt.length-1;xn>=0;--xn){const cn=qt[xn];Bn(p.symbolInstances.get(cn),cn,p.collisionArrays[cn])}}else for(let qt=i.symbolInstanceStart;qt<i.symbolInstanceEnd;qt++)Bn(p.symbolInstances.get(qt),qt,p.collisionArrays[qt]);if(y&&p.bucketInstanceId in this.collisionCircleArrays){const qt=this.collisionCircleArrays[p.bucketInstanceId];a.invert(qt.invProjMatrix,w),qt.viewportMatrix=this.collisionIndex.getViewportMatrix()}p.justReloaded=!1}markUsedJustification(i,c,y,u){const{leftJustifiedTextSymbolIndex:p,centerJustifiedTextSymbolIndex:f,rightJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:E,crossTileID:P}=y,O=a.getAnchorJustification(c),V=u===a.WritingMode.vertical?E:"left"===O?p:"center"===O?f:"right"===O?w:-1;p>=0&&(i.text.placedSymbolArray.get(p).crossTileID=V>=0&&p!==V?0:P),f>=0&&(i.text.placedSymbolArray.get(f).crossTileID=V>=0&&f!==V?0:P),w>=0&&(i.text.placedSymbolArray.get(w).crossTileID=V>=0&&w!==V?0:P),E>=0&&(i.text.placedSymbolArray.get(E).crossTileID=V>=0&&E!==V?0:P)}markUsedOrientation(i,c,y){const u=c===a.WritingMode.horizontal||c===a.WritingMode.horizontalOnly?c:0,p=c===a.WritingMode.vertical?c:0,{leftJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:w,rightJustifiedTextSymbolIndex:E,verticalPlacedTextSymbolIndex:P}=y,O=i.text.placedSymbolArray;f>=0&&(O.get(f).placedOrientation=u),w>=0&&(O.get(w).placedOrientation=u),E>=0&&(O.get(E).placedOrientation=u),P>=0&&(O.get(P).placedOrientation=p)}commit(i){this.commitTime=i,this.zoomAtLastRecencyCheck=this.transform.zoom;const c=this.prevPlacement;let y=!1;this.prevZoomAdjustment=c?c.zoomAdjustment(this.transform.zoom):0;const u=c?c.symbolFadeChange(i):1,p=c?c.opacities:{},f=c?c.variableOffsets:{},w=c?c.placedOrientations:{};for(const E in this.placements){const P=this.placements[E],O=p[E];O?(this.opacities[E]=new Ir(O,u,P.text,P.icon,null,P.clipped),y=y||P.text!==O.text.placed||P.icon!==O.icon.placed):(this.opacities[E]=new Ir(null,u,P.text,P.icon,P.skipFade,P.clipped),y=y||P.text||P.icon)}for(const E in p){const P=p[E];if(!this.opacities[E]){const O=new Ir(P,u,!1,!1);O.isHidden()||(this.opacities[E]=O,y=y||P.text.placed||P.icon.placed)}}for(const E in f)this.variableOffsets[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.variableOffsets[E]=f[E]);for(const E in w)this.placedOrientations[E]||!this.opacities[E]||this.opacities[E].isHidden()||(this.placedOrientations[E]=w[E]);y?this.lastPlacementChangeTime=i:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=c?c.lastPlacementChangeTime:i)}updateLayerOpacities(i,c){const y={};for(const u of c){const p=u.getBucket(i);p&&u.latestFeatureIndex&&i.id===p.layerIds[0]&&this.updateBucketOpacities(p,y,u.collisionBoxArray)}}updateBucketOpacities(i,c,y){i.hasTextData()&&i.text.opacityVertexArray.clear(),i.hasIconData()&&i.icon.opacityVertexArray.clear(),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexArray.clear(),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexArray.clear();const u=i.layers[0].layout,p=!!i.layers[0].dynamicFilter(),f=new Ir(null,0,!1,!1,!0),w=u.get("text-allow-overlap"),E=u.get("icon-allow-overlap"),P=u.get("text-variable-anchor"),O="map"===u.get("text-rotation-alignment"),V="map"===u.get("text-pitch-alignment"),Q="none"!==u.get("icon-text-fit"),ye=new Ir(null,0,w&&(E||!i.hasIconData()||u.get("icon-optional")),E&&(w||!i.hasTextData()||u.get("text-optional")),!0);!i.collisionArrays&&y&&(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData())&&i.deserializeCollisionBoxes(y);const be=(Ne,ve,tt)=>{for(let qe=0;qe<ve/4;qe++)Ne.opacityVertexArray.emplaceBack(tt)};let Oe=0;for(let Ne=0;Ne<i.symbolInstances.length;Ne++){const ve=i.symbolInstances.get(Ne),{numHorizontalGlyphVertices:tt,numVerticalGlyphVertices:qe,crossTileID:nt,numIconVertices:Tt}=ve;let ft=this.opacities[nt];c[nt]?ft=f:ft||(ft=ye,this.opacities[nt]=ft),c[nt]=!0;const At=tt>0||qe>0,Zt=Tt>0,Kt=this.placedOrientations[nt],nn=Kt===a.WritingMode.vertical,Bn=Kt===a.WritingMode.horizontal||Kt===a.WritingMode.horizontalOnly;if(!At&&!Zt||ft.isHidden()||Oe++,At){const qt=hs(ft.text);be(i.text,tt,nn?Ro:qt),be(i.text,qe,Bn?Ro:qt);const xn=ft.text.isHidden(),{leftJustifiedTextSymbolIndex:cn,centerJustifiedTextSymbolIndex:An,rightJustifiedTextSymbolIndex:tn,verticalPlacedTextSymbolIndex:$t}=ve,on=i.text.placedSymbolArray,wn=xn||nn?1:0;cn>=0&&(on.get(cn).hidden=wn),An>=0&&(on.get(An).hidden=wn),tn>=0&&(on.get(tn).hidden=wn),$t>=0&&(on.get($t).hidden=xn||Bn?1:0);const On=this.variableOffsets[nt];On&&this.markUsedJustification(i,On.anchor,ve,Kt);const ri=this.placedOrientations[nt];ri&&(this.markUsedJustification(i,"left",ve,ri),this.markUsedOrientation(i,ri,ve))}if(Zt){const qt=hs(ft.icon),{placedIconSymbolIndex:xn,verticalPlacedIconSymbolIndex:cn}=ve,An=i.icon.placedSymbolArray,tn=ft.icon.isHidden()?1:0;xn>=0&&(be(i.icon,Tt,nn?Ro:qt),An.get(xn).hidden=tn),cn>=0&&(be(i.icon,ve.numVerticalIconVertices,Bn?Ro:qt),An.get(cn).hidden=tn)}if(i.hasIconCollisionBoxData()||i.hasTextCollisionBoxData()){const qt=i.collisionArrays[Ne];if(qt){let xn=new a.pointGeometry(0,0),cn=!0;if(qt.textBox||qt.verticalTextBox){if(P){const tn=this.variableOffsets[nt];tn?(xn=lr(tn.anchor,tn.width,tn.height,tn.textOffset,tn.textScale),O&&xn._rotate(V?this.transform.angle:-this.transform.angle)):cn=!1}p&&(cn=!ft.clipped),qt.textBox&&ro(i.textCollisionBox.collisionVertexArray,ft.text.placed,!cn||nn,xn.x,xn.y),qt.verticalTextBox&&ro(i.textCollisionBox.collisionVertexArray,ft.text.placed,!cn||Bn,xn.x,xn.y)}const An=cn&&Boolean(!Bn&&qt.verticalIconBox);qt.iconBox&&ro(i.iconCollisionBox.collisionVertexArray,ft.icon.placed,An,Q?xn.x:0,Q?xn.y:0),qt.verticalIconBox&&ro(i.iconCollisionBox.collisionVertexArray,ft.icon.placed,!An,Q?xn.x:0,Q?xn.y:0)}}}if(i.fullyClipped=0===Oe,i.sortFeatures(this.transform.angle),this.retainedQueryData[i.bucketInstanceId]&&(this.retainedQueryData[i.bucketInstanceId].featureSortOrder=i.featureSortOrder),i.hasTextData()&&i.text.opacityVertexBuffer&&i.text.opacityVertexBuffer.updateData(i.text.opacityVertexArray),i.hasIconData()&&i.icon.opacityVertexBuffer&&i.icon.opacityVertexBuffer.updateData(i.icon.opacityVertexArray),i.hasIconCollisionBoxData()&&i.iconCollisionBox.collisionVertexBuffer&&i.iconCollisionBox.collisionVertexBuffer.updateData(i.iconCollisionBox.collisionVertexArray),i.hasTextCollisionBoxData()&&i.textCollisionBox.collisionVertexBuffer&&i.textCollisionBox.collisionVertexBuffer.updateData(i.textCollisionBox.collisionVertexArray),i.bucketInstanceId in this.collisionCircleArrays){const Ne=this.collisionCircleArrays[i.bucketInstanceId];i.placementInvProjMatrix=Ne.invProjMatrix,i.placementViewportMatrix=Ne.viewportMatrix,i.collisionCircleArray=Ne.circles,delete this.collisionCircleArrays[i.bucketInstanceId]}}symbolFadeChange(i){return 0===this.fadeDuration?1:(i-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(i){return Math.max(0,(this.transform.zoom-i)/1.5)}hasTransitions(i){return this.stale||i-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(i,c){const y=this.zoomAtLastRecencyCheck===c?1-this.zoomAdjustment(c):1;return this.zoomAtLastRecencyCheck=c,this.commitTime+this.fadeDuration*y>i}setStale(){this.stale=!0}}function ro(m,i,c,y,u){m.emplaceBack(i?1:0,c?1:0,y||0,u||0),m.emplaceBack(i?1:0,c?1:0,y||0,u||0),m.emplaceBack(i?1:0,c?1:0,y||0,u||0),m.emplaceBack(i?1:0,c?1:0,y||0,u||0)}const Ds=Math.pow(2,25),Ko=Math.pow(2,24),br=Math.pow(2,17),Ur=Math.pow(2,16),ca=Math.pow(2,9),Wr=Math.pow(2,8),_r=Math.pow(2,1);function hs(m){if(0===m.opacity&&!m.placed)return 0;if(1===m.opacity&&m.placed)return 4294967295;const i=m.placed?1:0,c=Math.floor(127*m.opacity);return c*Ds+i*Ko+c*br+i*Ur+c*ca+i*Wr+c*_r+i}const Ro=0;class lo{constructor(i){this._sortAcrossTiles="viewport-y"!==i.layout.get("symbol-z-order")&&void 0!==i.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(i,c,y,u,p){const f=this._bucketParts;for(;this._currentTileIndex<i.length;)if(c.getBucketParts(f,u,i[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,p())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,f.sort((w,E)=>w.sortKey-E.sortKey));this._currentPartIndex<f.length;){const w=f[this._currentPartIndex];if(c.placeLayerBucketPart(w,this._seenCrossTileIDs,y,0===w.symbolInstanceStart),this._currentPartIndex++,p())return!0}return!1}}class Qr{constructor(i,c,y,u,p,f,w,E){this.placement=new io(i,p,f,w,E),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=u,this._done=!1}isDone(){return this._done}continuePlacement(i,c,y){const u=a.exported.now(),p=()=>{const f=a.exported.now()-u;return!this._forceFullPlacement&&f>2};for(;this._currentPlacementIndex>=0;){const f=c[i[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if("symbol"===f.type&&(!f.minzoom||f.minzoom<=w)&&(!f.maxzoom||f.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new lo(f)),this._inProgressLayer.continuePlacement(y[f.source],this.placement,this._showCollisionBoxes,f,p))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(i){return this.placement.commit(i),this.placement}}const js=512/a.EXTENT/2;class ua{constructor(i,c,y){this.tileID=i,this.indexedSymbolInstances={},this.bucketInstanceId=y;for(let u=0;u<c.length;u++){const p=c.get(u),f=p.key;this.indexedSymbolInstances[f]||(this.indexedSymbolInstances[f]=[]),this.indexedSymbolInstances[f].push({crossTileID:p.crossTileID,coord:this.getScaledCoordinates(p,i)})}}getScaledCoordinates(i,c){const y=js/Math.pow(2,c.canonical.z-this.tileID.canonical.z);return{x:Math.floor((c.canonical.x*a.EXTENT+i.tileAnchorX)*y),y:Math.floor((c.canonical.y*a.EXTENT+i.tileAnchorY)*y)}}findMatches(i,c,y){const u=this.tileID.canonical.z<c.canonical.z?1:Math.pow(2,this.tileID.canonical.z-c.canonical.z);for(let p=0;p<i.length;p++){const f=i.get(p);if(f.crossTileID)continue;const w=this.indexedSymbolInstances[f.key];if(!w)continue;const E=this.getScaledCoordinates(f,c);for(const P of w)if(Math.abs(P.coord.x-E.x)<=u&&Math.abs(P.coord.y-E.y)<=u&&!y[P.crossTileID]){y[P.crossTileID]=!0,f.crossTileID=P.crossTileID;break}}}}class Co{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class To{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(i){const c=Math.round((i-this.lng)/360);if(0!==c)for(const y in this.indexes){const u=this.indexes[y],p={};for(const f in u){const w=u[f];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+c),p[w.tileID.key]=w}this.indexes[y]=p}this.lng=i}addBucket(i,c,y){if(this.indexes[i.overscaledZ]&&this.indexes[i.overscaledZ][i.key]){if(this.indexes[i.overscaledZ][i.key].bucketInstanceId===c.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(i.overscaledZ,this.indexes[i.overscaledZ][i.key])}for(let p=0;p<c.symbolInstances.length;p++)c.symbolInstances.get(p).crossTileID=0;this.usedCrossTileIDs[i.overscaledZ]||(this.usedCrossTileIDs[i.overscaledZ]={});const u=this.usedCrossTileIDs[i.overscaledZ];for(const p in this.indexes){const f=this.indexes[p];if(Number(p)>i.overscaledZ)for(const w in f){const E=f[w];E.tileID.isChildOf(i)&&E.findMatches(c.symbolInstances,i,u)}else{const w=f[i.scaledTo(Number(p)).key];w&&w.findMatches(c.symbolInstances,i,u)}}for(let p=0;p<c.symbolInstances.length;p++){const f=c.symbolInstances.get(p);f.crossTileID||(f.crossTileID=y.generate(),u[f.crossTileID]=!0)}return void 0===this.indexes[i.overscaledZ]&&(this.indexes[i.overscaledZ]={}),this.indexes[i.overscaledZ][i.key]=new ua(i,c.symbolInstances,c.bucketInstanceId),!0}removeBucketCrossTileIDs(i,c){for(const y in c.indexedSymbolInstances)for(const u of c.indexedSymbolInstances[y])delete this.usedCrossTileIDs[i][u.crossTileID]}removeStaleBuckets(i){let c=!1;for(const y in this.indexes){const u=this.indexes[y];for(const p in u)i[u[p].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,u[p]),delete u[p],c=!0)}return c}}class Ia{constructor(){this.layerIndexes={},this.crossTileIDs=new Co,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(i,c,y,u){let p=this.layerIndexes[i.id];void 0===p&&(p=this.layerIndexes[i.id]=new To);let f=!1;const w={};"globe"!==u.name&&p.handleWrapJump(y);for(const E of c){const P=E.getBucket(i);P&&i.id===P.layerIds[0]&&(P.bucketInstanceId||(P.bucketInstanceId=++this.maxBucketInstanceId),p.addBucket(E.tileID,P,this.crossTileIDs)&&(f=!0),w[P.bucketInstanceId]=!0)}return p.removeStaleBuckets(w)&&(f=!0),f}pruneUnusedLayers(i){const c={};i.forEach(y=>{c[y]=!0});for(const y in this.layerIndexes)c[y]||delete this.layerIndexes[y]}}const zo=(m,i)=>a.emitValidationErrors(m,i&&i.filter(c=>"source.canvas"!==c.identifier)),ps=a.pick(ei,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),mo=a.pick(ei,["setCenter","setZoom","setBearing","setPitch"]),Is={version:8,layers:[],sources:{}},Ms={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class go extends a.Evented{constructor(i,c={}){super(),this.map=i,this.dispatcher=new yt(qn(),this),this.imageManager=new Le,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(i._requestManager,c.localFontFamily?a.LocalGlyphMode.all:c.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,c.localFontFamily||c.localIdeographFontFamily),this.crossTileSymbolIndex=new Ia,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const y=this;this._rtlTextPluginCallback=go.registerForPluginStateChange(u=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:u.pluginStatus,pluginURL:u.pluginURL},(p,f)=>{if(a.triggerPluginCompletionEvent(p),f&&f.every(w=>w))for(const w in y._sourceCaches){const E=y._sourceCaches[w],P=E.getSource().type;"vector"!==P&&"geojson"!==P||E.reload()}})}),this.on("data",u=>{if("source"!==u.dataType||"metadata"!==u.sourceDataType)return;const p=this.getSource(u.sourceId);if(p&&p.vectorLayerIds)for(const f in this._layers){const w=this._layers[f];w.source===p.id&&this._validateLayer(w)}})}loadURL(i,c={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const y="boolean"==typeof c.validate?c.validate:!a.isMapboxURL(i);i=this.map._requestManager.normalizeStyleURL(i,c.accessToken);const u=this.map._requestManager.transformRequest(i,a.ResourceType.Style);this._request=a.getJSON(u,(p,f)=>{this._request=null,p?this.fire(new a.ErrorEvent(p)):f&&this._load(f,y)})}loadJSON(i,c={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame(()=>{this._request=null,this._load(i,!1!==c.validate)})}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(Is,!1)}_updateLayerCount(i,c){const y=c?1:-1;i.is3D()&&(this._num3DLayers+=y),"circle"===i.type&&(this._numCircleLayers+=y),"symbol"===i.type&&(this._numSymbolLayers+=y)}_load(i,c){if(c&&zo(this,a.validateStyle(i)))return;this._loaded=!0,this.stylesheet=a.clone$1(i),this._updateMapProjection();for(const u in i.sources)this.addSource(u,i.sources[u],{validate:!1});this._changed=!1,i.sprite?this._loadSprite(i.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(i.glyphs);const y=mi(this.stylesheet.layers);this._order=y.map(u=>u.id),this._layers={},this._serializedLayers={};for(let u of y)u=a.createStyleLayer(u),u.setEventedParent(this,{layer:{id:u.id}}),this._layers[u.id]=u,this._serializedLayers[u.id]=u.serialize(),this._updateLayerCount(u,!0);this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new He(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(i){i?this.stylesheet.projection=i:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(i){this._spriteRequest=function(c,y,u){let p,f,w;const E=a.exported.devicePixelRatio>1?"@2x":"";let P=a.getJSON(y.transformRequest(y.normalizeSpriteURL(c,E,".json"),a.ResourceType.SpriteJSON),(Q,ye)=>{P=null,w||(w=Q,p=ye,V())}),O=a.getImage(y.transformRequest(y.normalizeSpriteURL(c,E,".png"),a.ResourceType.SpriteImage),(Q,ye)=>{O=null,w||(w=Q,f=ye,V())});function V(){if(w)u(w);else if(p&&f){const Q=a.exported.getImageData(f),ye={};for(const be in p){const{width:Oe,height:Ne,x:ve,y:tt,sdf:qe,pixelRatio:nt,stretchX:Tt,stretchY:ft,content:At}=p[be],Zt=new a.RGBAImage({width:Oe,height:Ne});a.RGBAImage.copy(Q,Zt,{x:ve,y:tt},{x:0,y:0},{width:Oe,height:Ne}),ye[be]={data:Zt,pixelRatio:nt,sdf:qe,stretchX:Tt,stretchY:ft,content:At}}u(null,ye)}}return{cancel(){P&&(P.cancel(),P=null),O&&(O.cancel(),O=null)}}}(i,this.map._requestManager,(c,y)=>{if(this._spriteRequest=null,c)this.fire(new a.ErrorEvent(c));else if(y)for(const u in y)this.imageManager.addImage(u,y[u]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))})}_validateLayer(i){const c=this.getSource(i.source);if(!c)return;const y=i.sourceLayer;y&&("geojson"===c.type||c.vectorLayerIds&&-1===c.vectorLayerIds.indexOf(y))&&this.fire(new a.ErrorEvent(new Error(`Source layer "${y}" does not exist on source "${c.id}" as specified by style layer "${i.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const i in this._sourceCaches)if(!this._sourceCaches[i].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(i){const c=[];for(const y of i){const u=this._layers[y];"custom"!==u.type&&c.push(u.serialize())}return c}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const i in this._sourceCaches)if(this._sourceCaches[i].hasTransition())return!0;for(const i in this._layers)if(this._layers[i].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(i){return!!this.terrain&&("function"==typeof i.isLayerDraped?i.isLayerDraped():Ms[i.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(i){if(!this._loaded)return;const c=this._changed;if(this._changed){const u=Object.keys(this._updatedLayers),p=Object.keys(this._removedLayers);(u.length||p.length)&&this._updateWorkerLayers(u,p);for(const f in this._updatedSources){const w=this._updatedSources[f];"reload"===w?this._reloadSource(f):"clear"===w&&this._clearSource(f)}this._updateTilesForChangedImages();for(const f in this._updatedPaintProps)this._layers[f].updateTransitions(i);this.light.updateTransitions(i),this.fog&&this.fog.updateTransitions(i),this._resetUpdates()}const y={};for(const u in this._sourceCaches){const p=this._sourceCaches[u];y[u]=p.used,p.used=!1}for(const u of this._order){const p=this._layers[u];if(p.recalculate(i,this._availableImages),!p.isHidden(i.zoom)){const w=this._getLayerSourceCache(p);w&&(w.used=!0)}const f=this.map.painter;if(f){const w=p.getProgramIds();if(!w)continue;const E=p.getProgramConfiguration(i.zoom);for(const P of w)f.useProgram(P,E)}}for(const u in y){const p=this._sourceCaches[u];y[u]!==p.used&&p.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:p.getSource().id}))}this.light.recalculate(i),this.terrain&&this.terrain.recalculate(i),this.fog&&this.fog.recalculate(i),this.z=i.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),c&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const i=Object.keys(this._changedImages);if(i.length){for(const c in this._sourceCaches)this._sourceCaches[c].reloadTilesForDependencies(["icons","patterns"],i);this._changedImages={}}}_updateWorkerLayers(i,c){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(i),removedIds:c})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(i){if(this._checkLoaded(),zo(this,a.validateStyle(i)))return!1;(i=a.clone$1(i)).layers=mi(i.layers);const c=function(u,p){if(!u)return[{command:ei.setStyle,args:[p]}];let f=[];try{if(!q(u.version,p.version))return[{command:ei.setStyle,args:[p]}];q(u.center,p.center)||f.push({command:ei.setCenter,args:[p.center]}),q(u.zoom,p.zoom)||f.push({command:ei.setZoom,args:[p.zoom]}),q(u.bearing,p.bearing)||f.push({command:ei.setBearing,args:[p.bearing]}),q(u.pitch,p.pitch)||f.push({command:ei.setPitch,args:[p.pitch]}),q(u.sprite,p.sprite)||f.push({command:ei.setSprite,args:[p.sprite]}),q(u.glyphs,p.glyphs)||f.push({command:ei.setGlyphs,args:[p.glyphs]}),q(u.transition,p.transition)||f.push({command:ei.setTransition,args:[p.transition]}),q(u.light,p.light)||f.push({command:ei.setLight,args:[p.light]}),q(u.fog,p.fog)||f.push({command:ei.setFog,args:[p.fog]}),q(u.projection,p.projection)||f.push({command:ei.setProjection,args:[p.projection]});const w={},E=[];!function(V,Q,ye,be){let Oe;for(Oe in Q=Q||{},V=V||{})V.hasOwnProperty(Oe)&&(Q.hasOwnProperty(Oe)||Li(Oe,ye,be));for(Oe in Q)Q.hasOwnProperty(Oe)&&(V.hasOwnProperty(Oe)?q(V[Oe],Q[Oe])||("geojson"===V[Oe].type&&"geojson"===Q[Oe].type&&Gr(V,Q,Oe)?ye.push({command:ei.setGeoJSONSourceData,args:[Oe,Q[Oe].data]}):Er(Oe,Q,ye,be)):Oi(Oe,Q,ye))}(u.sources,p.sources,E,w);const P=[];u.layers&&u.layers.forEach(V=>{V.source&&w[V.source]?f.push({command:ei.removeLayer,args:[V.id]}):P.push(V)});let O=u.terrain;O&&w[O.source]&&(f.push({command:ei.setTerrain,args:[void 0]}),O=void 0),f=f.concat(E),q(O,p.terrain)||f.push({command:ei.setTerrain,args:[p.terrain]}),function(V,Q,ye){Q=Q||[];const be=(V=V||[]).map(Xr),Oe=Q.map(Xr),Ne=V.reduce(dr,{}),ve=Q.reduce(dr,{}),tt=be.slice(),qe=Object.create(null);let nt,Tt,ft,At,Zt,Kt,nn;for(nt=0,Tt=0;nt<be.length;nt++)ft=be[nt],ve.hasOwnProperty(ft)?Tt++:(ye.push({command:ei.removeLayer,args:[ft]}),tt.splice(tt.indexOf(ft,Tt),1));for(nt=0,Tt=0;nt<Oe.length;nt++)ft=Oe[Oe.length-1-nt],tt[tt.length-1-nt]!==ft&&(Ne.hasOwnProperty(ft)?(ye.push({command:ei.removeLayer,args:[ft]}),tt.splice(tt.lastIndexOf(ft,tt.length-Tt),1)):Tt++,Kt=tt[tt.length-nt],ye.push({command:ei.addLayer,args:[ve[ft],Kt]}),tt.splice(tt.length-nt,0,ft),qe[ft]=!0);for(nt=0;nt<Oe.length;nt++)if(ft=Oe[nt],At=Ne[ft],Zt=ve[ft],!qe[ft]&&!q(At,Zt))if(q(At.source,Zt.source)&&q(At["source-layer"],Zt["source-layer"])&&q(At.type,Zt.type)){for(nn in Jt(At.layout,Zt.layout,ye,ft,null,ei.setLayoutProperty),Jt(At.paint,Zt.paint,ye,ft,null,ei.setPaintProperty),q(At.filter,Zt.filter)||ye.push({command:ei.setFilter,args:[ft,Zt.filter]}),q(At.minzoom,Zt.minzoom)&&q(At.maxzoom,Zt.maxzoom)||ye.push({command:ei.setLayerZoomRange,args:[ft,Zt.minzoom,Zt.maxzoom]}),At)At.hasOwnProperty(nn)&&"layout"!==nn&&"paint"!==nn&&"filter"!==nn&&"metadata"!==nn&&"minzoom"!==nn&&"maxzoom"!==nn&&(0===nn.indexOf("paint.")?Jt(At[nn],Zt[nn],ye,ft,nn.slice(6),ei.setPaintProperty):q(At[nn],Zt[nn])||ye.push({command:ei.setLayerProperty,args:[ft,nn,Zt[nn]]}));for(nn in Zt)Zt.hasOwnProperty(nn)&&!At.hasOwnProperty(nn)&&"layout"!==nn&&"paint"!==nn&&"filter"!==nn&&"metadata"!==nn&&"minzoom"!==nn&&"maxzoom"!==nn&&(0===nn.indexOf("paint.")?Jt(At[nn],Zt[nn],ye,ft,nn.slice(6),ei.setPaintProperty):q(At[nn],Zt[nn])||ye.push({command:ei.setLayerProperty,args:[ft,nn,Zt[nn]]}))}else ye.push({command:ei.removeLayer,args:[ft]}),Kt=tt[tt.lastIndexOf(ft)+1],ye.push({command:ei.addLayer,args:[Zt,Kt]})}(P,p.layers,f)}catch(w){console.warn("Unable to compute style diff:",w),f=[{command:ei.setStyle,args:[p]}]}return f}(this.serialize(),i).filter(u=>!(u.command in mo));if(0===c.length)return!1;const y=c.filter(u=>!(u.command in ps));if(y.length>0)throw new Error(`Unimplemented: ${y.map(u=>u.command).join(", ")}.`);return c.forEach(u=>{"setTransition"!==u.command&&"setProjection"!==u.command&&this[u.command].apply(this,u.args)}),this.stylesheet=i,this._updateMapProjection(),!0}addImage(i,c){return this.getImage(i)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(i,c),this._afterImageUpdated(i),this)}updateImage(i,c){this.imageManager.updateImage(i,c)}getImage(i){return this.imageManager.getImage(i)}removeImage(i){return this.getImage(i)?(this.imageManager.removeImage(i),this._afterImageUpdated(i),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(i){this._availableImages=this.imageManager.listImages(),this._changedImages[i]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(i,c,y={}){if(this._checkLoaded(),void 0!==this.getSource(i))throw new Error("There is already a source with this ID");if(!c.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(c).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(c.type)>=0&&this._validate(a.validateSource,`sources.${i}`,c,null,y))return;this.map&&this.map._collectResourceTiming&&(c.collectResourceTiming=!0);const u=vt(i,c,this.dispatcher,this);u.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(i),source:u.serialize(),sourceId:i}));const p=f=>{const w=(f?"symbol:":"other:")+i,E=this._sourceCaches[w]=new a.SourceCache(w,u,f);(f?this._symbolSourceCaches:this._otherSourceCaches)[i]=E,E.style=this,E.onAdd(this.map)};p(!1),"vector"!==c.type&&"geojson"!==c.type||p(!0),u.onAdd&&u.onAdd(this.map),this._changed=!0}removeSource(i){this._checkLoaded();const c=this.getSource(i);if(!c)throw new Error("There is no source with this ID");for(const u in this._layers)if(this._layers[u].source===i)return this.fire(new a.ErrorEvent(new Error(`Source "${i}" cannot be removed while layer "${u}" is using it.`)));if(this.terrain&&this.terrain.get().source===i)return this.fire(new a.ErrorEvent(new Error(`Source "${i}" cannot be removed while terrain is using it.`)));const y=this._getSourceCaches(i);for(const u of y)delete this._sourceCaches[u.id],delete this._updatedSources[u.id],u.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:u.getSource().id})),u.setEventedParent(null),u.clearTiles();return delete this._otherSourceCaches[i],delete this._symbolSourceCaches[i],c.setEventedParent(null),c.onRemove&&c.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(i,c){this._checkLoaded(),this.getSource(i).setData(c),this._changed=!0}getSource(i){const c=this._getSourceCache(i);return c&&c.getSource()}_getSources(){const i=[];for(const c in this._otherSourceCaches){const y=this._getSourceCache(c);y&&i.push(y.getSource())}return i}addLayer(i,c,y={}){this._checkLoaded();const u=i.id;if(this.getLayer(u))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${u}" already exists on this map`)));let p;if("custom"===i.type){if(zo(this,a.validateCustomStyleLayer(i)))return;p=a.createStyleLayer(i)}else{if("object"==typeof i.source&&(this.addSource(u,i.source),i=a.clone$1(i),i=a.extend(i,{source:u})),this._validate(a.validateLayer,`layers.${u}`,i,{arrayIndex:-1},y))return;p=a.createStyleLayer(i),this._validateLayer(p),p.setEventedParent(this,{layer:{id:u}}),this._serializedLayers[p.id]=p.serialize(),this._updateLayerCount(p,!0)}const f=c?this._order.indexOf(c):this._order.length;if(c&&-1===f)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`)));this._order.splice(f,0,u),this._layerOrderChanged=!0,this._layers[u]=p;const w=this._getLayerSourceCache(p);if(this._removedLayers[u]&&p.source&&w&&"custom"!==p.type){const E=this._removedLayers[u];delete this._removedLayers[u],E.type!==p.type?this._updatedSources[p.source]="clear":(this._updatedSources[p.source]="reload",w.pause())}this._updateLayer(p),p.onAdd&&p.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(i,c){if(this._checkLoaded(),this._changed=!0,!this._layers[i])return void this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be moved.`)));if(i===c)return;const y=this._order.indexOf(i);this._order.splice(y,1);const u=c?this._order.indexOf(c):this._order.length;c&&-1===u?this.fire(new a.ErrorEvent(new Error(`Layer with id "${c}" does not exist on this map.`))):(this._order.splice(u,0,i),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(i){this._checkLoaded();const c=this._layers[i];if(!c)return void this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be removed.`)));c.setEventedParent(null),this._updateLayerCount(c,!1);const y=this._order.indexOf(i);this._order.splice(y,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[i]=c,delete this._layers[i],delete this._serializedLayers[i],delete this._updatedLayers[i],delete this._updatedPaintProps[i],c.onRemove&&c.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(i){return this._layers[i]}hasLayer(i){return i in this._layers}hasLayerType(i){for(const c in this._layers)if(this._layers[c].type===i)return!0;return!1}setLayerZoomRange(i,c,y){this._checkLoaded();const u=this.getLayer(i);u?u.minzoom===c&&u.maxzoom===y||(null!=c&&(u.minzoom=c),null!=y&&(u.maxzoom=y),this._updateLayer(u)):this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(i,c,y={}){this._checkLoaded();const u=this.getLayer(i);if(u){if(!q(u.filter,c))return null==c?(u.filter=void 0,void this._updateLayer(u)):void(this._validate(a.validateFilter,`layers.${u.id}.filter`,c,{layerType:u.type},y)||(u.filter=a.clone$1(c),this._updateLayer(u)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be filtered.`)))}getFilter(i){const c=this.getLayer(i);return c&&a.clone$1(c.filter)}setLayoutProperty(i,c,y,u={}){this._checkLoaded();const p=this.getLayer(i);p?q(p.getLayoutProperty(c),y)||(p.setLayoutProperty(c,y,u),this._updateLayer(p)):this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(i,c){const y=this.getLayer(i);if(y)return y.getLayoutProperty(c);this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style.`)))}setPaintProperty(i,c,y,u={}){this._checkLoaded();const p=this.getLayer(i);p?q(p.getPaintProperty(c),y)||(p.setPaintProperty(c,y,u)&&this._updateLayer(p),this._changed=!0,this._updatedPaintProps[i]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${i}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(i,c){const y=this.getLayer(i);return y&&y.getPaintProperty(c)}setFeatureState(i,c){this._checkLoaded();const y=i.source,u=i.sourceLayer,p=this.getSource(y);if(!p)return void this.fire(new a.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const f=p.type;if("geojson"===f&&u)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===f&&!u)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===i.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const w=this._getSourceCaches(y);for(const E of w)E.setFeatureState(u,i.id,c)}removeFeatureState(i,c){this._checkLoaded();const y=i.source,u=this.getSource(y);if(!u)return void this.fire(new a.ErrorEvent(new Error(`The source '${y}' does not exist in the map's style.`)));const p=u.type,f="vector"===p?i.sourceLayer:void 0;if("vector"===p&&!f)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(c&&"string"!=typeof i.id&&"number"!=typeof i.id)return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const w=this._getSourceCaches(y);for(const E of w)E.removeFeatureState(f,i.id,c)}getFeatureState(i){this._checkLoaded();const c=i.source,y=i.sourceLayer,u=this.getSource(c);if(u){if("vector"!==u.type||y)return void 0===i.id&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(c)[0].getFeatureState(y,i.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${c}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const i={};for(const c in this._sourceCaches){const y=this._sourceCaches[c].getSource();i[y.id]||(i[y.id]=y.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:i,layers:this._serializeLayers(this._order)},c=>void 0!==c)}_updateLayer(i){this._updatedLayers[i.id]=!0;const c=this._getLayerSourceCache(i);i.source&&!this._updatedSources[i.source]&&c&&"raster"!==c.getSource().type&&(this._updatedSources[i.source]="reload",c.pause()),this._changed=!0,i.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(i){const c=f=>"fill-extrusion"===this._layers[f].type,y={},u=[];for(let f=this._order.length-1;f>=0;f--){const w=this._order[f];if(c(w)){y[w]=f;for(const E of i){const P=E[w];if(P)for(const O of P)u.push(O)}}}u.sort((f,w)=>w.intersectionZ-f.intersectionZ);const p=[];for(let f=this._order.length-1;f>=0;f--){const w=this._order[f];if(c(w))for(let E=u.length-1;E>=0;E--){const P=u[E].feature;if(y[P.layer.id]<f)break;p.push(P),u.pop()}else for(const E of i){const P=E[w];if(P)for(const O of P)p.push(O.feature)}}return p}queryRenderedFeatures(i,c,y){c&&c.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",c.filter,null,c);const u={};if(c&&c.layers){if(!Array.isArray(c.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const E of c.layers){const P=this._layers[E];if(!P)return this.fire(new a.ErrorEvent(new Error(`The layer '${E}' does not exist in the map's style and cannot be queried for features.`))),[];u[P.source]=!0}}const p=[];c.availableImages=this._availableImages;const f=c&&c.layers?c.layers.some(E=>{const P=this.getLayer(E);return P&&P.is3D()}):this.has3DLayers(),w=xt.createFromScreenPoints(i,y);for(const E in this._sourceCaches){const P=this._sourceCaches[E].getSource().id;c.layers&&!u[P]||p.push(Fe(this._sourceCaches[E],this._layers,this._serializedLayers,w,c,y,f,!!this.map._showQueryGeometry))}return this.placement&&p.push(function(E,P,O,V,Q,ye,be){const Oe={},Ne=ye.queryRenderedSymbols(V),ve=[];for(const tt of Object.keys(Ne).map(Number))ve.push(be[tt]);ve.sort(Me);for(const tt of ve){const qe=tt.featureIndex.lookupSymbolFeatures(Ne[tt.bucketInstanceId],P,tt.bucketIndex,tt.sourceLayerIndex,Q.filter,Q.layers,Q.availableImages,E);for(const nt in qe){const Tt=Oe[nt]=Oe[nt]||[],ft=qe[nt];ft.sort((At,Zt)=>{const Kt=tt.featureSortOrder;if(Kt){const nn=Kt.indexOf(At.featureIndex);return Kt.indexOf(Zt.featureIndex)-nn}return Zt.featureIndex-At.featureIndex});for(const At of ft)Tt.push(At)}}for(const tt in Oe)Oe[tt].forEach(qe=>{const nt=qe.feature,Tt=O(E[tt]).getFeatureState(nt.layer["source-layer"],nt.id);nt.source=nt.layer.source,nt.layer["source-layer"]&&(nt.sourceLayer=nt.layer["source-layer"]),nt.state=Tt});return Oe}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),w.screenGeometry,c,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(p)}querySourceFeatures(i,c){c&&c.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",c.filter,null,c);const y=this._getSourceCaches(i);let u=[];for(const p of y)u=u.concat(Be(p,c));return u}addSourceType(i,c,y){return go.getSourceType(i)?y(new Error(`A source type called "${i}" already exists.`)):(go.setSourceType(i,c),c.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:i,url:c.workerSourceURL},y):y(null,null))}getLight(){return this.light.getLight()}setLight(i,c={}){this._checkLoaded();const y=this.light.getLight();let u=!1;for(const f in i)if(!q(i[f],y[f])){u=!0;break}if(!u)return;const p=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(i,c),this.light.updateTransitions(p)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(i,c=1){if(this._checkLoaded(),!i)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);if(1===c){if("object"==typeof i.source){const y="terrain-dem-src";this.addSource(y,i.source),i=a.clone$1(i),i=a.extend(i,{source:y})}if(this._validate(a.validateTerrain,"terrain",i))return}if(!this.terrain||this.terrain&&c!==this.terrain.drapeRenderMode)this._createTerrain(i,c);else{const y=this.terrain,u=y.get();for(const p of Object.keys(a.spec.terrain))!i.hasOwnProperty(p)&&a.spec.terrain[p].default&&(i[p]=a.spec.terrain[p].default);for(const p in i)if(!q(i[p],u[p])){y.set(i),this.stylesheet.terrain=i;const f=this._setTransitionParameters({duration:0});y.updateTransitions(f);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(i){const c=this.fog=new Lt(i,this.map.transform);this.stylesheet.fog=i;const y=this._setTransitionParameters({duration:0});c.updateTransitions(y)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const i of this.map._markers)i._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(i){if(this._checkLoaded(),!i)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const c=this.fog,y=c.get();0===Object.keys(i).length&&c.set(i);for(const u in i)if(!q(i[u],y[u])){c.set(i),this.stylesheet.fog=i;const p=this._setTransitionParameters({duration:0});c.updateTransitions(p);break}}else this._createFog(i);this._markersNeedUpdate=!0}_setTransitionParameters(i){return{now:a.exported.now(),transition:a.extend(i,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const i=this._order.filter(y=>this.isLayerDraped(this._layers[y])),c=this._order.filter(y=>!this.isLayerDraped(this._layers[y]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...i),this._drapedFirstOrder.push(...c)}_createTerrain(i,c){const y=this.terrain=new se(i,c);this.stylesheet.terrain=i,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const u=this._setTransitionParameters({duration:0});y.updateTransitions(u)}_force3DLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"fill-extrusion"===c.type&&this._updateLayer(c)}}_forceSymbolLayerUpdate(){for(const i in this._layers){const c=this._layers[i];"symbol"===c.type&&this._updateLayer(c)}}_validate(i,c,y,u,p={}){return(!p||!1!==p.validate)&&zo(this,i.call(a.validateStyle,a.extend({key:c,style:this.serialize(),value:y,styleSpec:a.spec},u)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const i in this._layers)this._layers[i].setEventedParent(null);for(const i in this._sourceCaches)this._sourceCaches[i].clearTiles(),this._sourceCaches[i].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(i){const c=this._getSourceCaches(i);for(const y of c)y.clearTiles()}_reloadSource(i){const c=this._getSourceCaches(i);for(const y of c)y.resume(),y.reload()}_reloadSources(){for(const i of this._getSources())i.reload&&i.reload()}_updateSources(i){for(const c in this._sourceCaches)this._sourceCaches[c].update(i)}_generateCollisionBoxes(){for(const i in this._sourceCaches){const c=this._sourceCaches[i];c.resume(),c.reload()}}_updatePlacement(i,c,y,u,p=!1){let f=!1,w=!1;const E={};for(const P of this._order){const O=this._layers[P];if("symbol"!==O.type)continue;if(!E[O.source]){const Q=this._getLayerSourceCache(O);if(!Q)continue;E[O.source]=Q.getRenderableIds(!0).map(ye=>Q.getTileByID(ye)).sort((ye,be)=>be.tileID.overscaledZ-ye.tileID.overscaledZ||(ye.tileID.isLessThan(be.tileID)?-1:1))}const V=this.crossTileSymbolIndex.addLayer(O,E[O.source],i.center.lng,i.projection);f=f||V}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),p=p||this._layerOrderChanged||0===y,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(p||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),i.zoom))&&(this.pauseablePlacement=new Qr(i,this._order,p,c,y,u,this.placement,this.fog&&i.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,E),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),w=!0),f&&this.pauseablePlacement.placement.setStale()),w||f)for(const P of this._order){const O=this._layers[P];"symbol"===O.type&&this.placement.updateLayerOpacities(O,E[O.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const i in this._sourceCaches)this._sourceCaches[i].releaseSymbolFadeTiles()}getImages(i,c,y){this.imageManager.getImages(c.icons,y),this._updateTilesForChangedImages();const u=p=>{p&&p.setDependencies(c.tileID.key,c.type,c.icons)};u(this._otherSourceCaches[c.source]),u(this._symbolSourceCaches[c.source])}getGlyphs(i,c,y){this.glyphManager.getGlyphs(c.stacks,y)}getResource(i,c,y){return a.makeRequest(c,y)}_getSourceCache(i){return this._otherSourceCaches[i]}_getLayerSourceCache(i){return"symbol"===i.type?this._symbolSourceCaches[i.source]:this._otherSourceCaches[i.source]}_getSourceCaches(i){const c=[];return this._otherSourceCaches[i]&&c.push(this._otherSourceCaches[i]),this._symbolSourceCaches[i]&&c.push(this._symbolSourceCaches[i]),c}_isSourceCacheLoaded(i){const c=this._getSourceCaches(i);return 0===c.length?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${i}'`))),!1):c.every(y=>y.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}go.getSourceType=function(m){return Ot[m]},go.setSourceType=function(m,i){Ot[m]=i},go.registerForPluginStateChange=a.registerForPluginStateChange;var Ss="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",da="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",ha="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",Qs="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",fs="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Ma={},Uo={};const pa=[];Lo(Ss,pa),Lo(ha,pa),Lo(Qs,pa),Lo(fs,pa),Ma=ji("",ha),Uo=ji(fs,Qs);const Sa=ji("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),As=Ss,Mo="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var $s={background:ji("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:ji("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:ji("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:ji("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:ji("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:ji("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:ji("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:ji("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:ji("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:ji("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:ji("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:ji("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:ji("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:ji("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:ji("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:ji("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:ji("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:ji("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:ji("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:ji("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:ji("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:ji("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:ji("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:ji("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:ji("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:ji("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",da),skyboxGradient:ji("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",da),skyboxCapture:ji("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:ji("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:ji("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function Lo(m,i){const c=m.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let y of c)if(y=y.trim(),"#"===y[0]&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const u=y.split(" ");for(const p of u)i.includes(p)||i.push(p)}}function ji(m,i){const c=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,y=i.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),u={},p=[...pa];return Lo(m,p),Lo(i,p),{fragmentSource:m=m.replace(c,(f,w,E,P,O)=>(u[O]=!0,"define"===w?`\n#ifndef HAS_UNIFORM_u_${O}\nvarying ${E} ${P} ${O};\n#else\nuniform ${E} ${P} u_${O};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${O}\n    ${E} ${P} ${O} = u_${O};\n#endif\n`)),vertexSource:i=i.replace(c,(f,w,E,P,O)=>{const V="float"===P?"vec2":"vec4",Q=O.match(/color/)?"color":V;return u[O]?"define"===w?`\n#ifndef HAS_UNIFORM_u_${O}\nuniform lowp float u_${O}_t;\nattribute ${E} ${V} a_${O};\nvarying ${E} ${P} ${O};\n#else\nuniform ${E} ${P} u_${O};\n#endif\n`:"vec4"===Q?`\n#ifndef HAS_UNIFORM_u_${O}\n    ${O} = a_${O};\n#else\n    ${E} ${P} ${O} = u_${O};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${O}\n    ${O} = unpack_mix_${Q}(a_${O}, u_${O}_t);\n#else\n    ${E} ${P} ${O} = u_${O};\n#endif\n`:"define"===w?`\n#ifndef HAS_UNIFORM_u_${O}\nuniform lowp float u_${O}_t;\nattribute ${E} ${V} a_${O};\n#else\nuniform ${E} ${P} u_${O};\n#endif\n`:"vec4"===Q?`\n#ifndef HAS_UNIFORM_u_${O}\n    ${E} ${P} ${O} = a_${O};\n#else\n    ${E} ${P} ${O} = u_${O};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${O}\n    ${E} ${P} ${O} = unpack_mix_${Q}(a_${O}, u_${O}_t);\n#else\n    ${E} ${P} ${O} = u_${O};\n#endif\n`}),staticAttributes:y,usedDefines:p}}class ea{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(i,c,y,u,p,f,w){this.context=i;let E=this.boundPaintVertexBuffers.length!==u.length;for(let O=0;!E&&O<u.length;O++)this.boundPaintVertexBuffers[O]!==u[O]&&(E=!0);let P=this.boundDynamicVertexBuffers.length!==w.length;for(let O=0;!P&&O<w.length;O++)this.boundDynamicVertexBuffers[O]!==w[O]&&(P=!0);if(!i.extVertexArrayObject||!this.vao||this.boundProgram!==c||this.boundLayoutVertexBuffer!==y||E||P||this.boundIndexBuffer!==p||this.boundVertexOffset!==f)this.freshBind(c,y,u,p,f,w);else{i.bindVertexArrayOES.set(this.vao);for(const O of w)O&&O.bind();p&&p.dynamicDraw&&p.bind()}}freshBind(i,c,y,u,p,f){let w;const E=i.numAttributes,P=this.context,O=P.gl;if(P.extVertexArrayObject)this.vao&&this.destroy(),this.vao=P.extVertexArrayObject.createVertexArrayOES(),P.bindVertexArrayOES.set(this.vao),w=0,this.boundProgram=i,this.boundLayoutVertexBuffer=c,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=u,this.boundVertexOffset=p,this.boundDynamicVertexBuffers=f;else{w=P.currentNumAttributes||0;for(let V=E;V<w;V++)O.disableVertexAttribArray(V)}c.enableAttributes(O,i),c.bind(),c.setVertexAttribPointers(O,i,p);for(const V of y)V.enableAttributes(O,i),V.bind(),V.setVertexAttribPointers(O,i,p);for(const V of f)V&&(V.enableAttributes(O,i),V.bind(),V.setVertexAttribPointers(O,i,p));u&&u.bind(),P.currentNumAttributes=E}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Vo(m,i){const c=Math.pow(2,i.canonical.z),y=i.canonical.y;return[new a.MercatorCoordinate(0,y/c).toLngLat().lat,new a.MercatorCoordinate(0,(y+1)/c).toLngLat().lat]}function jo(m,i,c,y,u,p,f){const w=m.context,E=w.gl,P=c.fbo;if(!P)return;m.prepareDrawTile();const O=m.useProgram("hillshade");w.activeTexture.set(E.TEXTURE0),E.bindTexture(E.TEXTURE_2D,P.colorAttachment.get());const V=((Oe,Ne,ve,tt)=>{const qe=ve.paint.get("hillshade-shadow-color"),nt=ve.paint.get("hillshade-highlight-color"),Tt=ve.paint.get("hillshade-accent-color");let ft=ve.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ve.paint.get("hillshade-illumination-anchor")&&(ft-=Oe.transform.angle);const At=!Oe.options.moving;return{u_matrix:tt||Oe.transform.calculateProjMatrix(Ne.tileID.toUnwrapped(),At),u_image:0,u_latrange:Vo(0,Ne.tileID),u_light:[ve.paint.get("hillshade-exaggeration"),ft],u_shadow:qe,u_highlight:nt,u_accent:Tt}})(m,c,y,m.terrain?i.projMatrix:null);m.prepareDrawProgram(w,O,i.toUnwrapped());const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:ye,tileBoundsSegments:be}=m.getTileBoundsBuffers(c);O.draw(w,E.TRIANGLES,u,p,f,a.CullFaceMode.disabled,V,y.id,Q,ye,be)}function ms(m,i,c){if(!i.needsDEMTextureUpload)return;const y=m.context,u=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),i.demTexture=i.demTexture||m.getTileTexture(c.stride);const p=c.getPixels();i.demTexture?i.demTexture.update(p,{premultiply:!1}):i.demTexture=new a.Texture(y,p,u.RGBA,{premultiply:!1}),i.needsDEMTextureUpload=!1}function Zs(m,i,c,y,u,p){const f=m.context,w=f.gl;if(!i.dem)return;const E=i.dem;if(f.activeTexture.set(w.TEXTURE1),ms(m,i,E),!i.demTexture)return;i.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const P=E.dim;f.activeTexture.set(w.TEXTURE0);let O=i.fbo;if(!O){const be=new a.Texture(f,{width:P,height:P,data:null},w.RGBA);be.bind(w.LINEAR,w.CLAMP_TO_EDGE),O=i.fbo=f.createFramebuffer(P,P,!0),O.colorAttachment.set(be.texture)}f.bindFramebuffer.set(O.framebuffer),f.viewport.set([0,0,P,P]);const{tileBoundsBuffer:V,tileBoundsIndexBuffer:Q,tileBoundsSegments:ye}=m.getMercatorTileBoundsBuffers();m.useProgram("hillshadePrepare").draw(f,w.TRIANGLES,y,u,p,a.CullFaceMode.disabled,((be,Oe)=>{const Ne=Oe.stride,ve=a.create();return a.ortho(ve,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(ve,ve,[0,-a.EXTENT,0]),{u_matrix:ve,u_image:1,u_dimension:[Ne,Ne],u_zoom:be.overscaledZ,u_unpack:Oe.unpackVector}})(i.tileID,E),c.id,V,Q,ye),i.needsHillshadePrepare=!1}const gs=m=>({u_matrix:new a.UniformMatrix4f(m),u_image0:new a.Uniform1i(m),u_skirt_height:new a.Uniform1f(m)}),$o=(m,i)=>({u_matrix:m,u_image0:0,u_skirt_height:i}),co=(m,i,c,y,u,p,f,w,E,P,O,V,Q,ye,be)=>({u_proj_matrix:Float32Array.from(m),u_globe_matrix:i,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:c,u_zoom_transition:u,u_merc_center:p,u_image0:0,u_frustum_tl:f,u_frustum_tr:w,u_frustum_br:E,u_frustum_bl:P,u_globe_pos:O,u_globe_radius:V,u_viewport:Q,u_grid_matrix:be?Float32Array.from(be):new Float32Array(9),u_skirt_height:ye});function Zo(m,i){return null!=m&&null!=i&&!(!m.hasData()||!i.hasData())&&null!=m.demTexture&&null!=i.demTexture&&m.tileID.key!==i.tileID.key}const So=new class{constructor(){this.operations={}}newMorphing(m,i,c,y,u){if(m in this.operations){const p=this.operations[m];p.to.tileID.key!==c.tileID.key&&(p.queued=c)}else this.operations[m]={startTime:y,phase:0,duration:u,from:i,to:c,queued:null}}getMorphValuesForProxy(m){if(!(m in this.operations))return null;const i=this.operations[m];return{from:i.from,to:i.to,phase:i.phase}}update(m){for(const i in this.operations){const c=this.operations[i];for(c.phase=(m-c.startTime)/c.duration;c.phase>=1||!this._validOp(c);)if(!this._nextOp(c,m)){delete this.operations[i];break}}}_nextOp(m,i){return!!m.queued&&(m.from=m.to,m.to=m.queued,m.queued=null,m.phase=0,m.startTime=i,!0)}_validOp(m){return m.from.hasData()&&m.to.hasData()}},kr={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Aa(m){return 6*Math.pow(1.5,22-m)}function _s(m,i){const c=1<<m.z;return!i&&(0===m.x||m.x===c-1)||0===m.y||m.y===c-1}const vi=m=>({u_matrix:m});function fa(m,i,c,y,u){if(u>0){const p=a.exported.now(),f=(p-m.timeAdded)/u,w=i?(p-i.timeAdded)/u:-1,E=c.getSource(),P=y.coveringZoomLevel({tileSize:E.tileSize,roundZoom:E.roundZoom}),O=!i||Math.abs(i.tileID.overscaledZ-P)>Math.abs(m.tileID.overscaledZ-P),V=O&&m.refreshedUponExpiration?1:a.clamp(O?f:1-w,0,1);return m.refreshedUponExpiration&&f>=1&&(m.refreshedUponExpiration=!1),i?{opacity:1,mix:1-V}:{opacity:V,mix:0}}return{opacity:1,mix:0}}class ja extends a.SourceCache{constructor(i){const c={type:"raster-dem",maxzoom:i.transform.maxZoom},y=new yt(qn(),null),u=vt("mock-dem",c,y,i.style);super("mock-dem",u,!1),u.setEventedParent(this),this._sourceLoaded=!0}_loadTile(i,c){i.state="loaded",c(null)}}class ys extends a.SourceCache{constructor(i){const c=vt("proxy",{type:"geojson",maxzoom:i.transform.maxZoom},new yt(qn(),null),i.style);super("proxy",c,!1),c.setEventedParent(this),this.map=this.getSource().map=i,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(i,c,y){if(i.freezeTileCoverage)return;this.transform=i;const u=i.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((p,f)=>{if(p[f.key]="",!this._tiles[f.key]){const w=new a.Tile(f,this._source.tileSize*f.overscaleFactor(),i.tileZoom);w.state="loaded",this._tiles[f.key]=w}return p},{});for(const p in this._tiles)p in u||(this.freeFBO(p),this._tiles[p].unloadVectorData(),delete this._tiles[p])}freeFBO(i){const c=this.proxyCachedFBO[i];if(void 0!==c){const y=Object.values(c);this.renderCachePool.push(...y),delete this.proxyCachedFBO[i]}}deallocRenderCache(){this.renderCache.forEach(i=>i.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class Mr extends a.OverscaledTileID{constructor(i,c,y){super(i.overscaledZ,i.wrap,i.canonical.z,i.canonical.x,i.canonical.y),this.proxyTileKey=c,this.projMatrix=y}}class ma extends a.Elevation{constructor(i,c){super(),this.painter=i,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,u,p]=function(E){const P=new a.StructArrayLayout2i4,O=new a.StructArrayLayout3ui6,V=131;P.reserve(17161),O.reserve(33800);const Q=a.EXTENT/128,ye=a.EXTENT+Q/2,be=ye+Q;for(let Ne=-Q;Ne<be;Ne+=Q)for(let ve=-Q;ve<be;ve+=Q){const tt=ve<0||ve>ye||Ne<0||Ne>ye?24575:0,qe=a.clamp(Math.round(ve),0,a.EXTENT),nt=a.clamp(Math.round(Ne),0,a.EXTENT);P.emplaceBack(qe+tt,nt)}const Oe=(Ne,ve)=>{const tt=ve*V+Ne;O.emplaceBack(tt+1,tt,tt+V),O.emplaceBack(tt+V,tt+V+1,tt+1)};for(let Ne=1;Ne<129;Ne++)for(let ve=1;ve<129;ve++)Oe(ve,Ne);return[0,129].forEach(Ne=>{for(let ve=0;ve<130;ve++)Oe(ve,Ne),Oe(Ne,ve)}),[P,O,32768]}(),f=i.context;this.gridBuffer=f.createVertexBuffer(y,a.posAttributes.members),this.gridIndexBuffer=f.createIndexBuffer(u),this.gridSegments=a.SegmentVector.simpleSegment(0,0,y.length,u.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,y.length,p),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ys(c.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,a.EXTENT,0,a.EXTENT,0,1);const w=f.gl;this._overlapStencilMode=new a.StencilMode({func:w.GEQUAL,mask:255},0,255,w.KEEP,w.KEEP,w.REPLACE),this._previousZoom=i.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=c,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ja(c.map)}set style(i){i.on("data",this._onStyleDataEvent.bind(this)),i.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=i,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(i,c,y){if(i&&i.terrain){this._style!==i&&(this.style=i),this.enabled=!0;const u=i.terrain.properties;this.sourceCache=0===i.terrain.drapeRenderMode?this._mockSourceCache:i._getSourceCache(u.get("source")),this._exaggeration=u.get("exaggeration");const p=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const f=this.getScaledDemTileSize();this.sourceCache.update(c,f,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,p(),this._initializing=!0),p(),c.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(c),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(i){this._findCoveringTileCache[i]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const i=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==i.efficiency&&a.warnOnce(`Terrain render cache efficiency is not optimal (${i.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${i.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(i){i.coord&&"source"===i.dataType?this._clearRenderCacheForTile(i.sourceCacheId,i.coord):"style"===i.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const i in this._style._sourceCaches)this._style._sourceCaches[i].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(i=>i.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const i=2*this.proxySourceCache.getSource().tileSize;return[i,i]}set useVertexMorphing(i){this._useVertexMorphing=i}updateTileBinding(i){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const c=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=0===y._centerAltitude&&-1===this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(y.center),-1),this._emptyDEMTextureDirty=!this._initializing);const u=this.proxyCoords=c.getIds().map(E=>{const P=c.getTileByID(E).tileID;return P.projMatrix=y.calculateProjMatrix(P.toUnwrapped()),P});(function(E,P){const O=P.transform.pointCoordinate(P.transform.getCameraPoint()),V=new a.pointGeometry(O.x,O.y);E.sort((Q,ye)=>{if(ye.overscaledZ-Q.overscaledZ)return ye.overscaledZ-Q.overscaledZ;const be=new a.pointGeometry(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),Oe=new a.pointGeometry(ye.canonical.x+(1<<ye.canonical.z)*ye.wrap,ye.canonical.y),Ne=V.mult(1<<Q.canonical.z);return Ne.x-=.5,Ne.y-=.5,Ne.distSqr(be)-Ne.distSqr(Oe)})})(u,this.painter),this._previousZoom=y.zoom;const p=this.proxyToSource||{};this.proxyToSource={},u.forEach(E=>{this.proxyToSource[E.key]={}}),this.terrainTileForTile={};const f=this._style._sourceCaches;for(const E in f){const P=f[E];if(!P.used||(P!==this.sourceCache&&this.resetTileLookupCache(P.id),this._setupProxiedCoordsForOrtho(P,i[E],p),P.usedForTerrain))continue;const O=i[E];P.getSource().reparseOverscaled&&this._assignTerrainTiles(O)}this.proxiedCoords[c.id]=u.map(E=>new Mr(E,E.key,this.orthoMatrix)),this._assignTerrainTiles(u),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(p),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const w={};this._visibleDemTiles=[];for(const E of this.proxyCoords){const P=this.terrainTileForTile[E.key];if(!P)continue;const O=P.tileID.key;O in w||(this._visibleDemTiles.push(P),w[O]=O)}}_assignTerrainTiles(i){this._initializing||i.forEach(c=>{if(this.terrainTileForTile[c.key])return;const y=this._findTileCoveringTileID(c,this.sourceCache);y&&(this.terrainTileForTile[c.key]=y)})}_prepareDEMTextures(){const i=this.painter.context,c=i.gl;for(const y in this.terrainTileForTile){const u=this.terrainTileForTile[y],p=u.dem;!p||u.demTexture&&!u.needsDEMTextureUpload||(i.activeTexture.set(c.TEXTURE1),ms(this.painter,u,p))}}_prepareDemTileUniforms(i,c,y,u){if(!c||null==c.demTexture)return!1;const p=i.tileID.canonical,f=Math.pow(2,c.tileID.canonical.z-p.z),w=u||"";return y[`u_dem_tl${w}`]=[p.x*f%1,p.y*f%1],y[`u_dem_scale${w}`]=f,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const i=this.painter.context,c=i.gl;if(!this._emptyDepthBufferTexture){const y=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(i,y,c.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let i=0;const c=this._visibleDemTiles.reduce((y,u)=>{if(!u.dem)return y;const p=u.dem.tree.minimums[0];return p>0&&i++,y+p},0);return i?c/i:0}_updateEmptyDEMTexture(){const i=this.painter.context,c=i.gl;i.activeTexture.set(c.TEXTURE2);const y=this._getLoadedAreaMinimum(),u=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(y,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let p=this._emptyDEMTexture;return p?p.update(u,{premultiply:!1}):p=this._emptyDEMTexture=new a.Texture(i,u,c.RGBA,{premultiply:!1}),p}setupElevationDraw(i,c,y){const u=this.painter.context,p=u.gl,f=(w=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(w),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var w;f.u_dem_size=this.sourceCache.getSource().tileSize,f.u_exaggeration=this.exaggeration();let E=null,P=null,O=1;if(y&&y.morphing&&this._useVertexMorphing){const V=y.morphing.srcDemTile,Q=y.morphing.dstDemTile;O=y.morphing.phase,V&&Q&&(this._prepareDemTileUniforms(i,V,f,"_prev")&&(P=V),this._prepareDemTileUniforms(i,Q,f)&&(E=Q))}if(P&&E?(u.activeTexture.set(p.TEXTURE2),E.demTexture.bind(p.NEAREST,p.CLAMP_TO_EDGE,p.NEAREST),u.activeTexture.set(p.TEXTURE4),P.demTexture.bind(p.NEAREST,p.CLAMP_TO_EDGE,p.NEAREST),f.u_dem_lerp=O):(E=this.terrainTileForTile[i.tileID.key],u.activeTexture.set(p.TEXTURE2),(this._prepareDemTileUniforms(i,E,f)?E.demTexture:this.emptyDEMTexture).bind(p.NEAREST,p.CLAMP_TO_EDGE)),u.activeTexture.set(p.TEXTURE3),y&&y.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(p.NEAREST,p.CLAMP_TO_EDGE),this._depthFBO&&(f.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(p.NEAREST,p.CLAMP_TO_EDGE),f.u_depth_size_inv=[1,1]),y&&y.useMeterToDem&&E){const V=(1<<E.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;f.u_meter_to_dem=V}if(y&&y.labelPlaneMatrixInv&&(f.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),c.setTerrainUniformValues(u,f),"globe"===this.painter.transform.projection.name){const V=this.globeUniformValues(this.painter.transform,i.tileID.canonical,y&&y.useDenormalizedUpVectorScale);c.setGlobeUniformValues(u,V)}}globeUniformValues(i,c,y){const u=i.projection;return{u_tile_tl_up:u.upVector(c,0,0),u_tile_tr_up:u.upVector(c,a.EXTENT,0),u_tile_br_up:u.upVector(c,a.EXTENT,a.EXTENT),u_tile_bl_up:u.upVector(c,0,a.EXTENT),u_tile_up_scale:y?a.globeMetersToEcef(1):u.upVectorScale(c,i.center.lat,i.worldSize).metersToTile}}renderToBackBuffer(i){const c=this.painter,y=this.painter.context;0!==i.length&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,c.width,c.height]),c.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(u,p,f,w,E){if("globe"===u.transform.projection.name)!function(P,O,V,Q,ye){const be=P.context,Oe=be.gl;let Ne,ve;const tt=P.options.showTerrainWireframe?2:0,qe=P.transform,nt=a.globeUseCustomAntiAliasing(P,be,qe),Tt=(An,tn)=>{if(ve===An)return;const $t=[kr[An],"PROJECTION_GLOBE_VIEW"];nt&&$t.push("CUSTOM_ANTIALIASING"),tn&&$t.push(kr[tt]),Ne=P.useProgram("globeRaster",null,$t),ve=An},ft=P.colorModeForRenderPass(),At=new a.DepthMode(Oe.LEQUAL,a.DepthMode.ReadWrite,P.depthRangeFor3D);So.update(ye);const Zt=a.calculateGlobeMercatorMatrix(qe),Kt=[a.mercatorXfromLng(qe.center.lng),a.mercatorYfromLat(qe.center.lat)],nn=tt?[!1,!0]:[!1],Bn=P.globeSharedBuffers,qt=[qe.width*a.exported.devicePixelRatio,qe.height*a.exported.devicePixelRatio],xn=Float32Array.from(qe.globeMatrix),cn={useDenormalizedUpVectorScale:!0};if(nn.forEach(An=>{const tn=P.transform,$t=Aa(tn.zoom)*O.exaggeration();ve=-1;const on=An?Oe.LINES:Oe.TRIANGLES;for(const wn of Q){const On=V.getTile(wn),ri=a.StencilMode.disabled,zi=O.prevTerrainTileForTile[wn.key],ti=O.terrainTileForTile[wn.key];Zo(zi,ti)&&So.newMorphing(wn.key,zi,ti,ye,250),be.activeTexture.set(Oe.TEXTURE0),On.texture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE);const Xn=So.getMorphValuesForProxy(wn.key),di=Xn?1:0;Xn&&a.extend$1(cn,{morphing:{srcDemTile:Xn.from,dstDemTile:Xn.to,phase:a.easeCubicInOut(Xn.phase)}});const Ji=a.tileCornersToBounds(wn.canonical),gi=a.getLatitudinalLod(Ji.getCenter().lat),Tr=a.getGridMatrix(wn.canonical,Ji,gi,tn.worldSize/tn._pixelsPerMercatorPixel),Or=a.globeNormalizeECEF(a.globeTileBounds(wn.canonical)),Rr=co(tn.projMatrix,xn,Zt,Or,a.globeToMercatorTransition(tn.zoom),Kt,tn.frustumCorners.TL,tn.frustumCorners.TR,tn.frustumCorners.BR,tn.frustumCorners.BL,tn.globeCenterInViewSpace,tn.globeRadius,qt,$t,Tr);if(Tt(di,An),O.setupElevationDraw(On,Ne,cn),P.prepareDrawProgram(be,Ne,wn.toUnwrapped()),Bn){const[Vr,Ao,bs]=An?Bn.getWirefameBuffers(P.context,gi):Bn.getGridBuffers(gi,0!==$t);Ne.draw(be,on,At,ri,ft,a.CullFaceMode.backCCW,Rr,"globe_raster",Vr,Ao,bs)}}}),Bn){const An=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];nt&&An.push("CUSTOM_ANTIALIASING"),Ne=P.useProgram("globeRaster",null,An);for(const tn of Q){const{x:$t,y:on,z:wn}=tn.canonical,On=0===on,ri=on===(1<<wn)-1,[zi,ti,Xn,di]=Bn.getPoleBuffers(wn);if(di&&(On||ri)){const Ji=V.getTile(tn);be.activeTexture.set(Oe.TEXTURE0),Ji.texture.bind(Oe.LINEAR,Oe.CLAMP_TO_EDGE);let gi=a.globePoleMatrixForTile(wn,$t,qe);const Tr=a.globeNormalizeECEF(a.globeTileBounds(tn.canonical)),Or=(Rr,Vr)=>Rr.draw(be,Oe.TRIANGLES,At,a.StencilMode.disabled,ft,a.CullFaceMode.disabled,co(qe.projMatrix,gi,gi,Tr,0,Kt,qe.frustumCorners.TL,qe.frustumCorners.TR,qe.frustumCorners.BR,qe.frustumCorners.BL,qe.globeCenterInViewSpace,qe.globeRadius,qt,0),"globe_pole_raster",Vr,Xn,di);O.setupElevationDraw(Ji,Ne,cn),P.prepareDrawProgram(be,Ne,tn.toUnwrapped()),On&&Or(Ne,zi),ri&&(gi=a.scale(a.create(),gi,[1,-1,1]),Or(Ne,ti))}}}}(u,p,f,w,E);else{const P=u.context,O=P.gl;let V,Q;const ye=u.options.showTerrainWireframe?2:0,be=(qe,nt)=>{if(Q===qe)return;const Tt=[kr[qe]];nt&&Tt.push(kr[ye]),V=u.useProgram("terrainRaster",null,Tt),Q=qe},Oe=u.colorModeForRenderPass(),Ne=new a.DepthMode(O.LEQUAL,a.DepthMode.ReadWrite,u.depthRangeFor3D);So.update(E);const ve=u.transform,tt=Aa(ve.zoom)*p.exaggeration();(ye?[!1,!0]:[!1]).forEach(qe=>{Q=-1;const nt=qe?O.LINES:O.TRIANGLES,[Tt,ft]=qe?p.getWirefameBuffer():[p.gridIndexBuffer,p.gridSegments];for(const At of w){const Zt=f.getTile(At),Kt=a.StencilMode.disabled,nn=p.prevTerrainTileForTile[At.key],Bn=p.terrainTileForTile[At.key];Zo(nn,Bn)&&So.newMorphing(At.key,nn,Bn,E,250),P.activeTexture.set(O.TEXTURE0),Zt.texture.bind(O.LINEAR,O.CLAMP_TO_EDGE,O.LINEAR_MIPMAP_NEAREST);const qt=So.getMorphValuesForProxy(At.key),xn=qt?1:0;let cn;qt&&(cn={morphing:{srcDemTile:qt.from,dstDemTile:qt.to,phase:a.easeCubicInOut(qt.phase)}});const An=$o(At.projMatrix,_s(At.canonical,ve.renderWorldCopies)?tt/10:tt);be(xn,qe),p.setupElevationDraw(Zt,V,cn),u.prepareDrawProgram(P,V,At.toUnwrapped()),V.draw(P,nt,Ne,Kt,Oe,a.CullFaceMode.backCCW,An,"terrain_raster",p.gridBuffer,Tt,ft)}})}}(c,this,this.proxySourceCache,i,this._updateTimestamp),this.renderingToTexture=!0,c.gpuTimingDeferredRenderEnd(),i.splice(0,i.length))}renderBatch(i){if(0===this._drapedRenderBatches.length)return i+1;this.renderingToTexture=!0;const c=this.painter,y=this.painter.context,u=this.proxySourceCache,p=this.proxiedCoords[u.id],f=this._drapedRenderBatches.shift(),w=[],E=c.style.order;let P=0;for(const O of p){const V=u.getTileByID(O.proxyTileKey),Q=u.proxyCachedFBO[O.key]?u.proxyCachedFBO[O.key][i]:void 0,ye=void 0!==Q?u.renderCache[Q]:this.pool[P++],be=void 0!==Q;if(V.texture=ye.tex,be&&!ye.dirty){w.push(V.tileID);continue}let Oe;y.bindFramebuffer.set(ye.fb.framebuffer),this.renderedToTile=!1,ye.dirty&&(y.clear({color:a.Color.transparent,stencil:0}),ye.dirty=!1);for(let Ne=f.start;Ne<=f.end;++Ne){const ve=c.style._layers[E[Ne]];if(ve.isHidden(c.transform.zoom))continue;const tt=c.style._getLayerSourceCache(ve),qe=tt?this.proxyToSource[O.key][tt.id]:[O];if(!qe)continue;const nt=qe;y.viewport.set([0,0,ye.fb.width,ye.fb.height]),Oe!==(tt?tt.id:null)&&(this._setupStencil(ye,qe,ve,tt),Oe=tt?tt.id:null),c.renderLayer(c,tt,ve,nt)}this.renderedToTile?(ye.dirty=!0,w.push(V.tileID)):be||--P,5===P&&(P=0,this.renderToBackBuffer(w))}return this.renderToBackBuffer(w),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,c.width,c.height]),f.end+1}postRender(){}renderCacheEfficiency(i){const c=i.order.length;if(0===c)return{efficiency:100};let y,u=0,p=0,f=!1;for(let w=0;w<c;++w){const E=i._layers[i.order[w]];this._style.isLayerDraped(E)?(f&&++u,++p):f||(f=!0,y=E.id)}return 0===p?{efficiency:100}:{efficiency:100*(1-u/p),firstUndrapedLayer:y}}getMinElevationBelowMSL(){let i=0;return this._visibleDemTiles.filter(c=>c.dem).forEach(c=>{i=Math.min(i,c.dem.tree.minimums[0])}),0===i?i:(i-30)*this._exaggeration}raycast(i,c,y){if(!this._visibleDemTiles)return null;const u=this._visibleDemTiles.filter(p=>p.dem).map(p=>{const f=p.tileID,w=1<<f.overscaledZ,{x:E,y:P}=f.canonical,O=E/w,V=(E+1)/w,Q=P/w,ye=(P+1)/w;return{minx:O,miny:Q,maxx:V,maxy:ye,t:p.dem.tree.raycastRoot(O,Q,V,ye,i,c,y),tile:p}});u.sort((p,f)=>(null!==p.t?p.t:Number.MAX_VALUE)-(null!==f.t?f.t:Number.MAX_VALUE));for(const p of u){if(null==p.t)return null;const f=p.tile.dem.tree.raycast(p.minx,p.miny,p.maxx,p.maxy,i,c,y);if(null!=f)return f}return null}_createFBO(){const i=this.painter.context,c=i.gl,y=this.drapeBufferSize;i.activeTexture.set(c.TEXTURE0);const u=new a.Texture(i,{width:y[0],height:y[1],data:null},c.RGBA);u.bind(c.LINEAR,c.CLAMP_TO_EDGE);const p=i.createFramebuffer(y[0],y[1],!1);return p.colorAttachment.set(u.texture),p.depthAttachment=new Ue(i,p.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=i.createRenderbuffer(i.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,p.depthAttachment.set(this._sharedDepthStencil),i.clear({stencil:0})):p.depthAttachment.set(this._sharedDepthStencil),i.extTextureFilterAnisotropic&&!i.extTextureFilterAnisotropicForceOff&&c.texParameterf(c.TEXTURE_2D,i.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,i.extTextureFilterAnisotropicMax),{fb:p,tex:u,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const i in this._style._sourceCaches)if(this._style._sourceCaches[i].hasTransition())return!0;return this._style.order.some(i=>{const c=this._style._layers[i],y=c.isHidden(this.painter.transform.zoom);return"custom"===c.type?!y&&c.shouldRedrape():!y&&c.hasTransition()})}_clearLineLayersFromRenderCache(){let i=!1;for(const y of this._style._getSources())if(y instanceof k){i=!0;break}if(!i)return;const c={};for(let y=0;y<this._style.order.length;++y){const u=this._style._layers[this._style.order[y]],p=this._style._getLayerSourceCache(u);if(p&&!c[p.id]&&!u.isHidden(this.painter.transform.zoom)&&"line"===u.type&&u.widthExpression()instanceof a.ZoomDependentExpression){c[p.id]=!0;for(const f of this.proxyCoords){const w=this.proxyToSource[f.key][p.id];if(w)for(const E of w)this._clearRenderCacheForTile(p.id,E)}}}}_clearRasterLayersFromRenderCache(){let i=!1;for(const y in this._style._sourceCaches)if(this._style._sourceCaches[y]._source instanceof X){i=!0;break}if(!i)return;const c={};for(let y=0;y<this._style.order.length;++y){const u=this._style._layers[this._style.order[y]],p=this._style._getLayerSourceCache(u);if(!p||c[p.id]||u.isHidden(this.painter.transform.zoom)||"raster"!==u.type)continue;const f=u.paint.get("raster-fade-duration");for(const w of this.proxyCoords){const E=this.proxyToSource[w.key][p.id];if(E)for(const P of E){const O=fa(p.getTile(P),p.findLoadedParent(P,0),p,this.painter.transform,f);(1!==O.opacity||0!==O.mix)&&this._clearRenderCacheForTile(p.id,P)}}}}_setupDrapedRenderBatches(){const i=this._style.order,c=i.length;if(0===c)return;const y=[];let u,p=0,f=this._style._layers[i[p]];for(;!this._style.isLayerDraped(f)&&f.isHidden(this.painter.transform.zoom)&&++p<c;)f=this._style._layers[i[p]];for(;p<c;++p){const w=this._style._layers[i[p]];w.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(w)?void 0===u&&(u=p):void 0!==u&&(y.push({start:u,end:p-1}),u=void 0))}void 0!==u&&y.push({start:u,end:p-1}),this._drapedRenderBatches=y}_setupRenderCache(i){const c=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,c.renderCache.length>c.renderCachePool.length){const f=Object.values(c.proxyCachedFBO);c.proxyCachedFBO={};for(let w=0;w<f.length;++w){const E=Object.values(f[w]);c.renderCachePool.push(...E)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,u=this._tilesDirty;for(let f=y.length-1;f>=0;f--){const w=y[f];if(c.getTileByID(w.key),void 0!==c.proxyCachedFBO[w.key]){const E=i[w.key],P=this.proxyToSource[w.key];let O=0;for(const V in P){const Q=P[V],ye=E[V];if(!ye||ye.length!==Q.length||Q.some((be,Oe)=>be!==ye[Oe]||u[V]&&u[V].hasOwnProperty(be.key))){O=-1;break}++O}for(const V in c.proxyCachedFBO[w.key])c.renderCache[c.proxyCachedFBO[w.key][V]].dirty=O<0||O!==Object.values(E).length}}const p=[...this._drapedRenderBatches];p.sort((f,w)=>w.end-w.start-(f.end-f.start));for(const f of p)for(const w of y){if(c.proxyCachedFBO[w.key])continue;let E=c.renderCachePool.pop();void 0===E&&c.renderCache.length<50&&(E=c.renderCache.length,c.renderCache.push(this._createFBO())),void 0!==E&&(c.proxyCachedFBO[w.key]={},c.proxyCachedFBO[w.key][f.start]=E,c.renderCache[E].dirty=!0)}this._tilesDirty={}}_setupStencil(i,c,y,u){if(!u||!this._sourceTilesOverlap[u.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const p=this.painter.context,f=p.gl;if(c.length<=1)return void(this._overlapStencilType=!1);let w;if(y.isTileClipped())w=c.length,this._overlapStencilMode.test={func:f.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(c[0].overscaledZ>c[c.length-1].overscaledZ))return void(this._overlapStencilType=!1);w=1,this._overlapStencilMode.test={func:f.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+w>255&&(p.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=w,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(c,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(i){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[i.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(i,c){const y=this.painter,u=this.painter.context,p=u.gl;y._tileClippingMaskIDs={},u.setColorMode(a.ColorMode.disabled),u.setDepthMode(a.DepthMode.disabled);const f=y.useProgram("clippingMask");for(const w of i){const E=y._tileClippingMaskIDs[w.key]=--c;f.draw(u,p.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:p.ALWAYS,mask:0},E,255,p.KEEP,p.KEEP,p.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,vi(w.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(i){const c=this.painter.transform;if(i.x<0||i.x>c.width||i.y<0||i.y>c.height)return null;const y=[i.x,i.y,1,1];a.transformMat4$1(y,y,c.pixelMatrixInverse),a.scale$1(y,y,1/y[3]),y[0]/=c.worldSize,y[1]/=c.worldSize;const u=c._camera.position,p=a.mercatorZfromAltitude(1,c.center.lat),f=[u[0],u[1],u[2]/p,0],w=a.subtract([],y.slice(0,3),f);a.normalize(w,w);const E=this.raycast(f,w,this._exaggeration);return null!==E&&E?(a.scaleAndAdd(f,f,w,E),f[3]=f[2],f[2]*=p,f):null}drawDepth(){const i=this.painter,c=i.context,y=this.proxySourceCache,u=Math.ceil(i.width),p=Math.ceil(i.height);if(!this._depthFBO||this._depthFBO.width===u&&this._depthFBO.height===p||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const f=c.gl,w=c.createFramebuffer(u,p,!0);c.activeTexture.set(f.TEXTURE0);const E=new a.Texture(c,{width:u,height:p,data:null},f.RGBA);E.bind(f.NEAREST,f.CLAMP_TO_EDGE),w.colorAttachment.set(E.texture);const P=c.createRenderbuffer(c.gl.DEPTH_COMPONENT16,u,p);w.depthAttachment.set(P),this._depthFBO=w,this._depthTexture=E}c.bindFramebuffer.set(this._depthFBO.framebuffer),c.viewport.set([0,0,u,p]),function(f,w,E,P){if("globe"===f.transform.projection.name)return;const O=f.context,V=O.gl;O.clear({depth:1});const Q=f.useProgram("terrainDepth"),ye=new a.DepthMode(V.LESS,a.DepthMode.ReadWrite,f.depthRangeFor3D);for(const be of P){const Oe=E.getTile(be),Ne=$o(be.projMatrix,0);w.setupElevationDraw(Oe,Q),Q.draw(O,V.TRIANGLES,ye,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,Ne,"terrain_depth",w.gridBuffer,w.gridIndexBuffer,w.gridNoSkirtSegments)}}(i,this,y,this.proxyCoords)}_setupProxiedCoordsForOrtho(i,c,y){if(i.getSource()instanceof dt)return this._setupProxiedCoordsForImageSource(i,c,y);this._findCoveringTileCache[i.id]=this._findCoveringTileCache[i.id]||{};const u=this.proxiedCoords[i.id]=[],p=this.proxyCoords;for(let w=0;w<p.length;w++){const E=p[w],P=this._findTileCoveringTileID(E,i);if(P){const O=this._createProxiedId(E,P,y[E.key]&&y[E.key][i.id]);u.push(O),this.proxyToSource[E.key][i.id]=[O]}}let f=!1;for(let w=0;w<c.length;w++){const E=i.getTile(c[w]);if(!E||!E.hasData())continue;const P=this._findTileCoveringTileID(E.tileID,this.proxySourceCache);if(P&&P.tileID.canonical.z!==E.tileID.canonical.z){const O=this.proxyToSource[P.tileID.key][i.id],V=this._createProxiedId(P.tileID,E,y[P.tileID.key]&&y[P.tileID.key][i.id]);O?O.splice(O.length-1,0,V):this.proxyToSource[P.tileID.key][i.id]=[V],u.push(V),f=!0}}this._sourceTilesOverlap[i.id]=f}_setupProxiedCoordsForImageSource(i,c,y){if(!i.getSource().loaded())return;const u=this.proxiedCoords[i.id]=[],p=this.proxyCoords,f=i.getSource(),w=new a.pointGeometry(f.tileID.x,f.tileID.y)._div(1<<f.tileID.z),E=f.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((O,V)=>(O.min.x=Math.min(O.min.x,V.x-w.x),O.min.y=Math.min(O.min.y,V.y-w.y),O.max.x=Math.max(O.max.x,V.x-w.x),O.max.y=Math.max(O.max.y,V.y-w.y),O),{min:new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.pointGeometry(-Number.MAX_VALUE,-Number.MAX_VALUE)}),P=(O,V)=>{const Q=O.wrap+O.canonical.x/(1<<O.canonical.z),ye=O.canonical.y/(1<<O.canonical.z),be=a.EXTENT/(1<<O.canonical.z),Oe=V.wrap+V.canonical.x/(1<<V.canonical.z),Ne=V.canonical.y/(1<<V.canonical.z);return Q+be<Oe+E.min.x||Q>Oe+E.max.x||ye+be<Ne+E.min.y||ye>Ne+E.max.y};for(let O=0;O<p.length;O++){const V=p[O];for(let Q=0;Q<c.length;Q++){const ye=i.getTile(c[Q]);if(!ye||!ye.hasData()||P(V,ye.tileID))continue;const be=this._createProxiedId(V,ye,y[V.key]&&y[V.key][i.id]),Oe=this.proxyToSource[V.key][i.id];Oe?Oe.push(be):this.proxyToSource[V.key][i.id]=[be],u.push(be)}}}_createProxiedId(i,c,y){let u=this.orthoMatrix;if(y){const p=y.find(f=>f.key===c.tileID.key);if(p)return p}if(c.tileID.key!==i.key){const p=i.canonical.z-c.tileID.canonical.z;let f,w,E;u=a.create();const P=c.tileID.wrap-i.wrap<<i.overscaledZ;p>0?(f=a.EXTENT>>p,w=f*((c.tileID.canonical.x<<p)-i.canonical.x+P),E=f*((c.tileID.canonical.y<<p)-i.canonical.y)):(f=a.EXTENT<<-p,w=a.EXTENT*(c.tileID.canonical.x-(i.canonical.x+P<<-p)),E=a.EXTENT*(c.tileID.canonical.y-(i.canonical.y<<-p))),a.ortho(u,0,f,0,f,0,1),a.translate(u,u,[w,E,0])}return new Mr(c.tileID,i.key,u)}_findTileCoveringTileID(i,c){let y=c.getTile(i);if(y&&y.hasData())return y;const u=this._findCoveringTileCache[c.id],p=u[i.key];if(y=p?c.getTileByID(p):null,y&&y.hasData()||null===p)return y;let f=y?y.tileID:i,w=f.overscaledZ;const E=c.getSource().minzoom,P=[];if(!p){const V=c.getSource().maxzoom;if(i.canonical.z>=V){const Q=i.canonical.z-V;c.getSource().reparseOverscaled?(w=Math.max(i.canonical.z+2,c.transform.tileZoom),f=new a.OverscaledTileID(w,i.wrap,V,i.canonical.x>>Q,i.canonical.y>>Q)):0!==Q&&(w=V,f=new a.OverscaledTileID(w,i.wrap,V,i.canonical.x>>Q,i.canonical.y>>Q))}f.key!==i.key&&(P.push(f.key),y=c.getTile(f))}const O=V=>{P.forEach(Q=>{u[Q]=V}),P.length=0};for(w-=1;w>=E&&(!y||!y.hasData());w--){y&&O(y.tileID.key);const V=f.calculateScaledKey(w);if(y=c.getTileByID(V),y&&y.hasData())break;const Q=u[V];if(null===Q)break;void 0===Q?P.push(V):y=c.getTileByID(Q)}return O(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(i){return this.enabled?this._findTileCoveringTileID(i,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(i,c){let y=this._tilesDirty[i];y||(y=this._tilesDirty[i]={}),y[c.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const i=function(c){let y=0;const u=new a.StructArrayLayout2ui4,p=131;for(let f=1;f<129;f++){for(let w=1;w<129;w++)y=f*p+w,u.emplaceBack(y,y+1),u.emplaceBack(y,y+p),u.emplaceBack(y+1,y+p),128===f&&u.emplaceBack(y+p,y+p+1);u.emplaceBack(y+1,y+1+p)}return u}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(i),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,i.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Go{static cacheKey(i,c,y,u){let p=`${c}${u?u.cacheKey:""}`;for(const f of y)i.usedDefines.includes(f)&&(p+=`/${f}`);return p}constructor(i,c,y,u,p,f){const w=i.gl;this.program=w.createProgram();const E=function(ve){const tt=[];for(let qe=0;qe<ve.length;qe++){if(null===ve[qe])continue;const nt=ve[qe].split(" ");tt.push(nt.pop())}return tt}(y.staticAttributes),P=u?u.getBinderAttributes():[],O=E.concat(P);let V=u?u.defines():[];V=V.concat(f.map(ve=>`#define ${ve}`));const Q=i.isWebGL2?"#version 300 es\n":"",ye=Q+V.concat(i.extStandardDerivatives&&0===Q.length?"#extension GL_OES_standard_derivatives : enable\n".concat(Mo):Mo,Mo,As,Sa.fragmentSource,Uo.fragmentSource,y.fragmentSource).join("\n"),be=Q+V.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",As,Sa.vertexSource,Uo.vertexSource,Ma.vertexSource,y.vertexSource).join("\n"),Oe=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);w.shaderSource(Oe,ye),w.compileShader(Oe),w.attachShader(this.program,Oe);const Ne=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())this.failedToCreate=!0;else{w.shaderSource(Ne,be),w.compileShader(Ne),w.attachShader(this.program,Ne),this.attributes={},this.numAttributes=O.length;for(let ve=0;ve<this.numAttributes;ve++)O[ve]&&(w.bindAttribLocation(this.program,ve,O[ve]),this.attributes[O[ve]]=ve);w.linkProgram(this.program),w.deleteShader(Ne),w.deleteShader(Oe),this.fixedUniforms=p(i),this.binderUniforms=u?u.getUniforms(i):[],f.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new a.Uniform1i(ve=i),u_dem_prev:new a.Uniform1i(ve),u_dem_unpack:new a.Uniform4f(ve),u_dem_tl:new a.Uniform2f(ve),u_dem_scale:new a.Uniform1f(ve),u_dem_tl_prev:new a.Uniform2f(ve),u_dem_scale_prev:new a.Uniform1f(ve),u_dem_size:new a.Uniform1f(ve),u_dem_lerp:new a.Uniform1f(ve),u_exaggeration:new a.Uniform1f(ve),u_depth:new a.Uniform1i(ve),u_depth_size_inv:new a.Uniform2f(ve),u_meter_to_dem:new a.Uniform1f(ve),u_label_plane_matrix_inv:new a.UniformMatrix4f(ve)}),f.includes("GLOBE")&&(this.globeUniforms=(ve=>({u_tile_tl_up:new a.Uniform3f(ve),u_tile_tr_up:new a.Uniform3f(ve),u_tile_br_up:new a.Uniform3f(ve),u_tile_bl_up:new a.Uniform3f(ve),u_tile_up_scale:new a.Uniform1f(ve)}))(i)),f.includes("FOG")&&(this.fogUniforms=(ve=>({u_fog_matrix:new a.UniformMatrix4f(ve),u_fog_range:new a.Uniform2f(ve),u_fog_color:new a.Uniform4f(ve),u_fog_horizon_blend:new a.Uniform1f(ve),u_fog_temporal_offset:new a.Uniform1f(ve),u_frustum_tl:new a.Uniform3f(ve),u_frustum_tr:new a.Uniform3f(ve),u_frustum_br:new a.Uniform3f(ve),u_frustum_bl:new a.Uniform3f(ve),u_globe_pos:new a.Uniform3f(ve),u_globe_radius:new a.Uniform1f(ve),u_globe_transition:new a.Uniform1f(ve),u_is_globe:new a.Uniform1i(ve),u_viewport:new a.Uniform2f(ve)}))(i))}var ve}setTerrainUniformValues(i,c){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const u in c)y[u]&&y[u].set(this.program,u,c[u])}}setGlobeUniformValues(i,c){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const u in c)y[u]&&y[u].set(this.program,u,c[u])}}setFogUniformValues(i,c){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){i.program.set(this.program);for(const u in c)y[u].set(this.program,u,c[u])}}draw(i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe){const Ne=i.gl;if(this.failedToCreate)return;i.program.set(this.program),i.setDepthMode(y),i.setStencilMode(u),i.setColorMode(p),i.setCullFace(f);for(const tt of Object.keys(this.fixedUniforms))this.fixedUniforms[tt].set(this.program,tt,w[tt]);be&&be.setUniforms(this.program,i,this.binderUniforms,Q,{zoom:ye});const ve={[Ne.LINES]:2,[Ne.TRIANGLES]:3,[Ne.LINE_STRIP]:1}[c];for(const tt of V.get()){const qe=tt.vaos||(tt.vaos={});(qe[E]||(qe[E]=new ea)).bind(i,this,P,be?be.getPaintVertexBuffers():[],O,tt.vertexOffset,Oe||[]),Ne.drawElements(c,tt.primitiveLength*ve,Ne.UNSIGNED_SHORT,tt.primitiveOffset*ve*2)}}}function $a(m,i){const c=Math.pow(2,i.tileID.overscaledZ),y=i.tileSize*Math.pow(2,m.transform.tileZoom)/c,u=y*(i.tileID.canonical.x+i.tileID.wrap*c),p=y*i.tileID.canonical.y;return{u_image:0,u_texsize:i.imageAtlasTexture.size,u_tile_units_to_pixels:1/St(i,1,m.transform.tileZoom),u_pixel_coord_upper:[u>>16,p>>16],u_pixel_coord_lower:[65535&u,65535&p]}}const te=a.create(),Y=(m,i,c,y,u,p,f,w,E,P,O)=>{const V=i.style.light,Q=V.properties.get("position"),ye=[Q.x,Q.y,Q.z],be=a.create$1();"viewport"===V.properties.get("anchor")&&(a.fromRotation(be,-i.transform.angle),a.transformMat3(ye,ye,be));const Oe=V.properties.get("color"),Ne=i.transform,ve={u_matrix:m,u_lightpos:ye,u_lightintensity:V.properties.get("intensity"),u_lightcolor:[Oe.r,Oe.g,Oe.b],u_vertical_gradient:+c,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:te,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:u,u_edge_radius:p};return"globe"===Ne.projection.name&&(ve.u_tile_id=[f.canonical.x,f.canonical.y,1<<f.canonical.z],ve.u_zoom_transition=E,ve.u_inv_rot_matrix=O,ve.u_merc_center=P,ve.u_up_dir=Ne.projection.upVector(new a.CanonicalTileID(0,0,0),P[0]*a.EXTENT,P[1]*a.EXTENT),ve.u_height_lift=w),ve},W=(m,i,c,y,u,p,f,w,E,P,O,V)=>{const Q=Y(m,i,c,y,u,p,f,E,P,O,V),ye={u_height_factor:-Math.pow(2,f.overscaledZ)/w.tileSize/8};return a.extend(Q,$a(i,w),ye)},Te=m=>({u_matrix:m}),fn=(m,i,c)=>a.extend(Te(m),$a(i,c)),fi=(m,i)=>({u_matrix:m,u_world:i}),pr=(m,i,c,y)=>a.extend(fn(m,i,c),{u_world:y}),cr=a.create(),Ps=(m,i,c,y,u,p)=>{const f=m.transform,w="globe"===f.projection.name;let E;if("map"===p.paint.get("circle-pitch-alignment"))if(w){const O=a.globePixelsToTileUnits(f.zoom,i.canonical)*f._pixelsPerMercatorPixel;E=Float32Array.from([O,0,0,O])}else E=f.calculatePixelsToTileUnitsMatrix(c);else E=new Float32Array([f.pixelsToGLUnits[0],0,0,f.pixelsToGLUnits[1]]);const P={u_camera_to_center_distance:f.cameraToCenterDistance,u_matrix:m.translatePosMatrix(i.projMatrix,c,p.paint.get("circle-translate"),p.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:E,u_inv_rot_matrix:cr,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(w){P.u_inv_rot_matrix=y,P.u_merc_center=u,P.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],P.u_zoom_transition=a.globeToMercatorTransition(f.zoom);const O=u[0]*a.EXTENT,V=u[1]*a.EXTENT;P.u_up_dir=f.projection.upVector(new a.CanonicalTileID(0,0,0),O,V)}return P},Fo=m=>{const i=[];return"map"===m.paint.get("circle-pitch-alignment")&&i.push("PITCH_WITH_MAP"),"map"===m.paint.get("circle-pitch-scale")&&i.push("SCALE_WITH_MAP"),i},Za=(m,i,c,y)=>{const u=a.EXTENT/c.tileSize;return{u_matrix:m,u_camera_to_center_distance:i.getCameraToCenterDistance(y),u_extrude_scale:[i.pixelsToGLUnits[0]/u,i.pixelsToGLUnits[1]/u]}},ol=(m,i,c=1)=>({u_matrix:m,u_color:i,u_overlay:0,u_overlay_scale:c}),Rn=a.create(),ki=(m,i,c,y,u,p,f)=>{const w=m.transform,E="globe"===w.projection.name,P=E?a.globePixelsToTileUnits(w.zoom,i.canonical)*w._pixelsPerMercatorPixel:St(c,1,p),O={u_matrix:i.projMatrix,u_extrude_scale:P,u_intensity:f,u_inv_rot_matrix:Rn,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(E){O.u_inv_rot_matrix=y,O.u_merc_center=u,O.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],O.u_zoom_transition=a.globeToMercatorTransition(w.zoom);const V=u[0]*a.EXTENT,Q=u[1]*a.EXTENT;O.u_up_dir=w.projection.upVector(new a.CanonicalTileID(0,0,0),V,Q)}return O},Ga=(m,i,c,y,u,p,f)=>{const w=m.transform,E=w.calculatePixelsToTileUnitsMatrix(i);return{u_matrix:Wl(m,i,c,y),u_pixels_to_tile_units:E,u_device_pixel_ratio:p,u_units_to_pixels:[1/w.pixelsToGLUnits[0],1/w.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:u,u_texsize:Gs(c)?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:so(i,m.transform),u_alpha_discard_threshold:0,u_trim_offset:f}},Tl=(m,i,c,y,u)=>{const p=m.transform;return{u_matrix:Wl(m,i,c,y),u_texsize:i.imageAtlasTexture.size,u_pixels_to_tile_units:p.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:u,u_image:0,u_tile_units_to_pixels:so(i,p),u_units_to_pixels:[1/p.pixelsToGLUnits[0],1/p.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function so(m,i){return 1/St(m,1,i.tileZoom)}function Wl(m,i,c,y){return m.translatePosMatrix(y||i.tileID.projMatrix,i,c.paint.get("line-translate"),c.paint.get("line-translate-anchor"))}function Gs(m){const i=m.paint.get("line-dasharray").value;return i.value||"constant"!==i.kind}const Qo=(m,i,c,y,u,p)=>{return{u_matrix:m,u_tl_parent:i,u_scale_parent:c,u_fade_t:y.mix,u_opacity:y.opacity*u.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:u.paint.get("raster-brightness-min"),u_brightness_high:u.paint.get("raster-brightness-max"),u_saturation_factor:(w=u.paint.get("raster-saturation"),w>0?1-1/(1.001-w):-w),u_contrast_factor:(f=u.paint.get("raster-contrast"),f>0?1/(1-f):1+f),u_spin_weights:Hs(u.paint.get("raster-hue-rotate")),u_perspective_transform:p};var f,w};function Hs(m){m*=Math.PI/180;const i=Math.sin(m),c=Math.cos(m);return[(2*c+1)/3,(-Math.sqrt(3)*i-c+1)/3,(Math.sqrt(3)*i-c+1)/3]}const es=a.create(),Ws=(m,i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe)=>{const Ne=u.transform,ve={u_is_size_zoom_constant:+("constant"===m||"source"===m),u_is_size_feature_constant:+("constant"===m||"camera"===m),u_size_t:i?i.uSizeT:0,u_size:i?i.uSize:0,u_camera_to_center_distance:Ne.cameraToCenterDistance,u_rotate_symbol:+c,u_aspect_ratio:Ne.width/Ne.height,u_fade_change:u.options.fadeDuration?u.symbolFadeChange:1,u_matrix:p,u_label_plane_matrix:f,u_coord_matrix:w,u_is_text:+E,u_pitch_with_map:+y,u_texsize:P,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:es,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:es,u_up_vector:[0,-1,0]};return"globe"===Oe.name&&(ve.u_tile_id=[O.canonical.x,O.canonical.y,1<<O.canonical.z],ve.u_zoom_transition=V,ve.u_inv_rot_matrix=ye,ve.u_merc_center=Q,ve.u_camera_forward=Ne._camera.forward(),ve.u_ecef_origin=a.globeECEFOrigin(Ne.globeMatrix,O.toUnwrapped()),ve.u_tile_matrix=Float32Array.from(Ne.globeMatrix),ve.u_up_vector=be),ve},Qc=(m,i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe,Ne)=>a.extend(Ws(m,i,c,y,u,p,f,w,E,P,V,Q,ye,be,Oe,Ne),{u_gamma_scale:y?u.transform.cameraToCenterDistance*Math.cos(u.terrain?0:u.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:+O}),sl=(m,i,c,y,u,p,f,w,E,P,O,V,Q,ye,be,Oe)=>a.extend(Qc(m,i,c,y,u,p,f,w,!0,E,!0,O,V,Q,ye,be,Oe),{u_texsize_icon:P,u_texture_icon:1}),M=(m,i,c)=>({u_matrix:m,u_opacity:i,u_color:c}),G=(m,i,c,y,u)=>a.extend(function(p,f,w){const E=f.imageManager.getPattern(p.toString()),{width:P,height:O}=f.imageManager.getPixelSize(),V=Math.pow(2,w.tileID.overscaledZ),Q=w.tileSize*Math.pow(2,f.transform.tileZoom)/V,ye=Q*(w.tileID.canonical.x+w.tileID.wrap*V),be=Q*w.tileID.canonical.y;return{u_image:0,u_pattern_tl:E.tl,u_pattern_br:E.br,u_texsize:[P,O],u_pattern_size:E.displaySize,u_tile_units_to_pixels:1/St(w,1,f.transform.tileZoom),u_pixel_coord_upper:[ye>>16,be>>16],u_pixel_coord_lower:[65535&ye,65535&be]}}(y,c,u),{u_matrix:m,u_opacity:i}),S={fillExtrusion:m=>({u_matrix:new a.UniformMatrix4f(m),u_lightpos:new a.Uniform3f(m),u_lightintensity:new a.Uniform1f(m),u_lightcolor:new a.Uniform3f(m),u_vertical_gradient:new a.Uniform1f(m),u_opacity:new a.Uniform1f(m),u_edge_radius:new a.Uniform1f(m),u_ao:new a.Uniform2f(m),u_tile_id:new a.Uniform3f(m),u_zoom_transition:new a.Uniform1f(m),u_inv_rot_matrix:new a.UniformMatrix4f(m),u_merc_center:new a.Uniform2f(m),u_up_dir:new a.Uniform3f(m),u_height_lift:new a.Uniform1f(m)}),fillExtrusionPattern:m=>({u_matrix:new a.UniformMatrix4f(m),u_lightpos:new a.Uniform3f(m),u_lightintensity:new a.Uniform1f(m),u_lightcolor:new a.Uniform3f(m),u_vertical_gradient:new a.Uniform1f(m),u_height_factor:new a.Uniform1f(m),u_edge_radius:new a.Uniform1f(m),u_ao:new a.Uniform2f(m),u_tile_id:new a.Uniform3f(m),u_zoom_transition:new a.Uniform1f(m),u_inv_rot_matrix:new a.UniformMatrix4f(m),u_merc_center:new a.Uniform2f(m),u_up_dir:new a.Uniform3f(m),u_height_lift:new a.Uniform1f(m),u_image:new a.Uniform1i(m),u_texsize:new a.Uniform2f(m),u_pixel_coord_upper:new a.Uniform2f(m),u_pixel_coord_lower:new a.Uniform2f(m),u_tile_units_to_pixels:new a.Uniform1f(m),u_opacity:new a.Uniform1f(m)}),fill:m=>({u_matrix:new a.UniformMatrix4f(m)}),fillPattern:m=>({u_matrix:new a.UniformMatrix4f(m),u_image:new a.Uniform1i(m),u_texsize:new a.Uniform2f(m),u_pixel_coord_upper:new a.Uniform2f(m),u_pixel_coord_lower:new a.Uniform2f(m),u_tile_units_to_pixels:new a.Uniform1f(m)}),fillOutline:m=>({u_matrix:new a.UniformMatrix4f(m),u_world:new a.Uniform2f(m)}),fillOutlinePattern:m=>({u_matrix:new a.UniformMatrix4f(m),u_world:new a.Uniform2f(m),u_image:new a.Uniform1i(m),u_texsize:new a.Uniform2f(m),u_pixel_coord_upper:new a.Uniform2f(m),u_pixel_coord_lower:new a.Uniform2f(m),u_tile_units_to_pixels:new a.Uniform1f(m)}),circle:m=>({u_camera_to_center_distance:new a.Uniform1f(m),u_extrude_scale:new a.UniformMatrix2f(m),u_device_pixel_ratio:new a.Uniform1f(m),u_matrix:new a.UniformMatrix4f(m),u_inv_rot_matrix:new a.UniformMatrix4f(m),u_merc_center:new a.Uniform2f(m),u_tile_id:new a.Uniform3f(m),u_zoom_transition:new a.Uniform1f(m),u_up_dir:new a.Uniform3f(m)}),collisionBox:m=>({u_matrix:new a.UniformMatrix4f(m),u_camera_to_center_distance:new a.Uniform1f(m),u_extrude_scale:new a.Uniform2f(m)}),collisionCircle:m=>({u_matrix:new a.UniformMatrix4f(m),u_inv_matrix:new a.UniformMatrix4f(m),u_camera_to_center_distance:new a.Uniform1f(m),u_viewport_size:new a.Uniform2f(m)}),debug:m=>({u_color:new a.UniformColor(m),u_matrix:new a.UniformMatrix4f(m),u_overlay:new a.Uniform1i(m),u_overlay_scale:new a.Uniform1f(m)}),clippingMask:m=>({u_matrix:new a.UniformMatrix4f(m)}),heatmap:m=>({u_extrude_scale:new a.Uniform1f(m),u_intensity:new a.Uniform1f(m),u_matrix:new a.UniformMatrix4f(m),u_inv_rot_matrix:new a.UniformMatrix4f(m),u_merc_center:new a.Uniform2f(m),u_tile_id:new a.Uniform3f(m),u_zoom_transition:new a.Uniform1f(m),u_up_dir:new a.Uniform3f(m)}),heatmapTexture:m=>({u_image:new a.Uniform1i(m),u_color_ramp:new a.Uniform1i(m),u_opacity:new a.Uniform1f(m)}),hillshade:m=>({u_matrix:new a.UniformMatrix4f(m),u_image:new a.Uniform1i(m),u_latrange:new a.Uniform2f(m),u_light:new a.Uniform2f(m),u_shadow:new a.UniformColor(m),u_highlight:new a.UniformColor(m),u_accent:new a.UniformColor(m)}),hillshadePrepare:m=>({u_matrix:new a.UniformMatrix4f(m),u_image:new a.Uniform1i(m),u_dimension:new a.Uniform2f(m),u_zoom:new a.Uniform1f(m),u_unpack:new a.Uniform4f(m)}),line:m=>({u_matrix:new a.UniformMatrix4f(m),u_pixels_to_tile_units:new a.UniformMatrix2f(m),u_device_pixel_ratio:new a.Uniform1f(m),u_units_to_pixels:new a.Uniform2f(m),u_dash_image:new a.Uniform1i(m),u_gradient_image:new a.Uniform1i(m),u_image_height:new a.Uniform1f(m),u_texsize:new a.Uniform2f(m),u_tile_units_to_pixels:new a.Uniform1f(m),u_alpha_discard_threshold:new a.Uniform1f(m),u_trim_offset:new a.Uniform2f(m)}),linePattern:m=>({u_matrix:new a.UniformMatrix4f(m),u_texsize:new a.Uniform2f(m),u_pixels_to_tile_units:new a.UniformMatrix2f(m),u_device_pixel_ratio:new a.Uniform1f(m),u_image:new a.Uniform1i(m),u_units_to_pixels:new a.Uniform2f(m),u_tile_units_to_pixels:new a.Uniform1f(m),u_alpha_discard_threshold:new a.Uniform1f(m)}),raster:m=>({u_matrix:new a.UniformMatrix4f(m),u_tl_parent:new a.Uniform2f(m),u_scale_parent:new a.Uniform1f(m),u_fade_t:new a.Uniform1f(m),u_opacity:new a.Uniform1f(m),u_image0:new a.Uniform1i(m),u_image1:new a.Uniform1i(m),u_brightness_low:new a.Uniform1f(m),u_brightness_high:new a.Uniform1f(m),u_saturation_factor:new a.Uniform1f(m),u_contrast_factor:new a.Uniform1f(m),u_spin_weights:new a.Uniform3f(m),u_perspective_transform:new a.Uniform2f(m)}),symbolIcon:m=>({u_is_size_zoom_constant:new a.Uniform1i(m),u_is_size_feature_constant:new a.Uniform1i(m),u_size_t:new a.Uniform1f(m),u_size:new a.Uniform1f(m),u_camera_to_center_distance:new a.Uniform1f(m),u_rotate_symbol:new a.Uniform1i(m),u_aspect_ratio:new a.Uniform1f(m),u_fade_change:new a.Uniform1f(m),u_matrix:new a.UniformMatrix4f(m),u_label_plane_matrix:new a.UniformMatrix4f(m),u_coord_matrix:new a.UniformMatrix4f(m),u_is_text:new a.Uniform1i(m),u_pitch_with_map:new a.Uniform1i(m),u_texsize:new a.Uniform2f(m),u_tile_id:new a.Uniform3f(m),u_zoom_transition:new a.Uniform1f(m),u_inv_rot_matrix:new a.UniformMatrix4f(m),u_merc_center:new a.Uniform2f(m),u_camera_forward:new a.Uniform3f(m),u_tile_matrix:new a.UniformMatrix4f(m),u_up_vector:new a.Uniform3f(m),u_ecef_origin:new a.Uniform3f(m),u_texture:new a.Uniform1i(m)}),symbolSDF:m=>({u_is_size_zoom_constant:new a.Uniform1i(m),u_is_size_feature_constant:new a.Uniform1i(m),u_size_t:new a.Uniform1f(m),u_size:new a.Uniform1f(m),u_camera_to_center_distance:new a.Uniform1f(m),u_rotate_symbol:new a.Uniform1i(m),u_aspect_ratio:new a.Uniform1f(m),u_fade_change:new a.Uniform1f(m),u_matrix:new a.UniformMatrix4f(m),u_label_plane_matrix:new a.UniformMatrix4f(m),u_coord_matrix:new a.UniformMatrix4f(m),u_is_text:new a.Uniform1i(m),u_pitch_with_map:new a.Uniform1i(m),u_texsize:new a.Uniform2f(m),u_texture:new a.Uniform1i(m),u_gamma_scale:new a.Uniform1f(m),u_device_pixel_ratio:new a.Uniform1f(m),u_tile_id:new a.Uniform3f(m),u_zoom_transition:new a.Uniform1f(m),u_inv_rot_matrix:new a.UniformMatrix4f(m),u_merc_center:new a.Uniform2f(m),u_camera_forward:new a.Uniform3f(m),u_tile_matrix:new a.UniformMatrix4f(m),u_up_vector:new a.Uniform3f(m),u_ecef_origin:new a.Uniform3f(m),u_is_halo:new a.Uniform1i(m)}),symbolTextAndIcon:m=>({u_is_size_zoom_constant:new a.Uniform1i(m),u_is_size_feature_constant:new a.Uniform1i(m),u_size_t:new a.Uniform1f(m),u_size:new a.Uniform1f(m),u_camera_to_center_distance:new a.Uniform1f(m),u_rotate_symbol:new a.Uniform1i(m),u_aspect_ratio:new a.Uniform1f(m),u_fade_change:new a.Uniform1f(m),u_matrix:new a.UniformMatrix4f(m),u_label_plane_matrix:new a.UniformMatrix4f(m),u_coord_matrix:new a.UniformMatrix4f(m),u_is_text:new a.Uniform1i(m),u_pitch_with_map:new a.Uniform1i(m),u_texsize:new a.Uniform2f(m),u_texsize_icon:new a.Uniform2f(m),u_texture:new a.Uniform1i(m),u_texture_icon:new a.Uniform1i(m),u_gamma_scale:new a.Uniform1f(m),u_device_pixel_ratio:new a.Uniform1f(m),u_is_halo:new a.Uniform1i(m)}),background:m=>({u_matrix:new a.UniformMatrix4f(m),u_opacity:new a.Uniform1f(m),u_color:new a.UniformColor(m)}),backgroundPattern:m=>({u_matrix:new a.UniformMatrix4f(m),u_opacity:new a.Uniform1f(m),u_image:new a.Uniform1i(m),u_pattern_tl:new a.Uniform2f(m),u_pattern_br:new a.Uniform2f(m),u_texsize:new a.Uniform2f(m),u_pattern_size:new a.Uniform2f(m),u_pixel_coord_upper:new a.Uniform2f(m),u_pixel_coord_lower:new a.Uniform2f(m),u_tile_units_to_pixels:new a.Uniform1f(m)}),terrainRaster:gs,terrainDepth:gs,skybox:m=>({u_matrix:new a.UniformMatrix4f(m),u_sun_direction:new a.Uniform3f(m),u_cubemap:new a.Uniform1i(m),u_opacity:new a.Uniform1f(m),u_temporal_offset:new a.Uniform1f(m)}),skyboxGradient:m=>({u_matrix:new a.UniformMatrix4f(m),u_color_ramp:new a.Uniform1i(m),u_center_direction:new a.Uniform3f(m),u_radius:new a.Uniform1f(m),u_opacity:new a.Uniform1f(m),u_temporal_offset:new a.Uniform1f(m)}),skyboxCapture:m=>({u_matrix_3f:new a.UniformMatrix3f(m),u_sun_direction:new a.Uniform3f(m),u_sun_intensity:new a.Uniform1f(m),u_color_tint_r:new a.Uniform4f(m),u_color_tint_m:new a.Uniform4f(m),u_luminance:new a.Uniform1f(m)}),globeRaster:m=>({u_proj_matrix:new a.UniformMatrix4f(m),u_globe_matrix:new a.UniformMatrix4f(m),u_normalize_matrix:new a.UniformMatrix4f(m),u_merc_matrix:new a.UniformMatrix4f(m),u_zoom_transition:new a.Uniform1f(m),u_merc_center:new a.Uniform2f(m),u_image0:new a.Uniform1i(m),u_grid_matrix:new a.UniformMatrix3f(m),u_skirt_height:new a.Uniform1f(m),u_frustum_tl:new a.Uniform3f(m),u_frustum_tr:new a.Uniform3f(m),u_frustum_br:new a.Uniform3f(m),u_frustum_bl:new a.Uniform3f(m),u_globe_pos:new a.Uniform3f(m),u_globe_radius:new a.Uniform1f(m),u_viewport:new a.Uniform2f(m)}),globeAtmosphere:m=>({u_frustum_tl:new a.Uniform3f(m),u_frustum_tr:new a.Uniform3f(m),u_frustum_br:new a.Uniform3f(m),u_frustum_bl:new a.Uniform3f(m),u_horizon:new a.Uniform1f(m),u_transition:new a.Uniform1f(m),u_fadeout_range:new a.Uniform1f(m),u_color:new a.Uniform4f(m),u_high_color:new a.Uniform4f(m),u_space_color:new a.Uniform4f(m),u_star_intensity:new a.Uniform1f(m),u_star_density:new a.Uniform1f(m),u_star_size:new a.Uniform1f(m),u_temporal_offset:new a.Uniform1f(m),u_horizon_angle:new a.Uniform1f(m),u_rotation_matrix:new a.UniformMatrix4f(m)})};let j;function _e(m,i,c,y,u,p,f){const w=m.context,E=w.gl,P=m.transform,O=m.useProgram("collisionBox"),V=[];let Q=0,ye=0;for(let nt=0;nt<y.length;nt++){const Tt=y[nt],ft=i.getTile(Tt),At=ft.getBucket(c);if(!At)continue;const Zt=Ai(Tt,At,P);let Kt=Zt;0===u[0]&&0===u[1]||(Kt=m.translatePosMatrix(Zt,ft,u,p));const nn=f?At.textCollisionBox:At.iconCollisionBox,Bn=At.collisionCircleArray;if(Bn.length>0){const qt=a.create(),xn=Kt;a.mul(qt,At.placementInvProjMatrix,P.glCoordMatrix),a.mul(qt,qt,At.placementViewportMatrix),V.push({circleArray:Bn,circleOffset:ye,transform:xn,invTransform:qt,projection:At.getProjection()}),Q+=Bn.length/4,ye=Q}nn&&(m.terrain&&m.terrain.setupElevationDraw(ft,O),O.draw(w,E.LINES,a.DepthMode.disabled,a.StencilMode.disabled,m.colorModeForRenderPass(),a.CullFaceMode.disabled,Za(Kt,P,ft,At.getProjection()),c.id,nn.layoutVertexBuffer,nn.indexBuffer,nn.segments,null,P.zoom,null,[nn.collisionVertexBuffer,nn.collisionVertexBufferExt]))}if(!f||!V.length)return;const be=m.useProgram("collisionCircle"),Oe=new a.StructArrayLayout2f1f2i16;Oe.resize(4*Q),Oe._trim();let Ne=0;for(const nt of V)for(let Tt=0;Tt<nt.circleArray.length/4;Tt++){const ft=4*Tt,At=nt.circleArray[ft+0],Zt=nt.circleArray[ft+1],Kt=nt.circleArray[ft+2],nn=nt.circleArray[ft+3];Oe.emplace(Ne++,At,Zt,Kt,nn,0),Oe.emplace(Ne++,At,Zt,Kt,nn,1),Oe.emplace(Ne++,At,Zt,Kt,nn,2),Oe.emplace(Ne++,At,Zt,Kt,nn,3)}(!j||j.length<2*Q)&&(j=function(nt){const Tt=2*nt,ft=new a.StructArrayLayout3ui6;ft.resize(Tt),ft._trim();for(let At=0;At<Tt;At++){const Zt=6*At;ft.uint16[Zt+0]=4*At+0,ft.uint16[Zt+1]=4*At+1,ft.uint16[Zt+2]=4*At+2,ft.uint16[Zt+3]=4*At+2,ft.uint16[Zt+4]=4*At+3,ft.uint16[Zt+5]=4*At+0}return ft}(Q));const ve=w.createIndexBuffer(j,!0),tt=w.createVertexBuffer(Oe,a.collisionCircleLayout.members,!0);for(const nt of V){const Tt={u_matrix:nt.transform,u_inv_matrix:nt.invTransform,u_camera_to_center_distance:(qe=P).getCameraToCenterDistance(nt.projection),u_viewport_size:[qe.width,qe.height]};be.draw(w,E.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,m.colorModeForRenderPass(),a.CullFaceMode.disabled,Tt,c.id,tt,ve,a.SegmentVector.simpleSegment(0,2*nt.circleOffset,nt.circleArray.length,nt.circleArray.length/2),null,P.zoom)}var qe;tt.destroy(),ve.destroy()}const Et=a.create();function Cn({width:m,height:i,anchor:c,textOffset:y,textScale:u},p){const{horizontalAlign:f,verticalAlign:w}=a.getAnchorAlignment(c),E=-(f-.5)*m,P=-(w-.5)*i,O=a.evaluateVariableOffset(c,y);return new a.pointGeometry((E/u+O[0])*p,(P/u+O[1])*p)}function Vn(m,i,c,y,u,p,f,w,E,P,O){const V=m.text.placedSymbolArray,Q=m.text.dynamicLayoutVertexArray,ye=m.icon.dynamicLayoutVertexArray,be={},Oe=m.getProjection(),Ne=Fi(w,Oe,p),ve=p.elevation,tt=Oe.upVectorScale(w.canonical,p.center.lat,p.worldSize).metersToTile;Q.clear();for(let qe=0;qe<V.length;qe++){const nt=V.get(qe),{tileAnchorX:Tt,tileAnchorY:ft,numGlyphs:At}=nt,Kt=nt.hidden||!nt.crossTileID||m.allowVerticalPlacement&&!nt.placedOrientation?null:y[nt.crossTileID];if(Kt){let nn=0,Bn=0,qt=0;if(ve){const ri=ve?ve.getAtTileOffset(w,Tt,ft):0,[zi,ti,Xn]=Oe.upVector(w.canonical,Tt,ft);nn=ri*zi*tt,Bn=ri*ti*tt,qt=ri*Xn*tt}let[xn,cn,An,tn]=In(nt.projectedAnchorX+nn,nt.projectedAnchorY+Bn,nt.projectedAnchorZ+qt,c?Ne:f);const $t=si(p.getCameraToCenterDistance(Oe),tn);let on=u.evaluateSizeForFeature(m.textSizeData,P,nt)*$t/a.ONE_EM;c&&(on*=m.tilePixelRatio/E);const wn=Cn(Kt,on);c?(({x:xn,y:cn,z:An}=Oe.projectTilePoint(Tt+wn.x,ft+wn.y,w.canonical)),[xn,cn,An]=In(xn+nn,cn+Bn,An+qt,f)):(i&&wn._rotate(-p.angle),xn+=wn.x,cn+=wn.y,An=0);const On=m.allowVerticalPlacement&&nt.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let ri=0;ri<At;ri++)a.addDynamicAttributes(Q,xn,cn,An,On);O&&nt.associatedIconIndex>=0&&(be[nt.associatedIconIndex]={x:xn,y:cn,z:An,angle:On})}else Ft(At,Q)}if(O){ye.clear();const qe=m.icon.placedSymbolArray;for(let nt=0;nt<qe.length;nt++){const Tt=qe.get(nt),{numGlyphs:ft}=Tt,At=be[nt];if(Tt.hidden||!At)Ft(ft,ye);else{const{x:Zt,y:Kt,z:nn,angle:Bn}=At;for(let qt=0;qt<ft;qt++)a.addDynamicAttributes(ye,Zt,Kt,nn,Bn)}}m.icon.dynamicLayoutVertexBuffer.updateData(ye)}m.text.dynamicLayoutVertexBuffer.updateData(Q)}function Ci(m,i,c){return c.iconsInText&&i?"symbolTextAndIcon":m?"symbolSDF":"symbolIcon"}function ii(m,i,c,y,u,p,f,w,E,P,O,V){const Q=m.context,ye=Q.gl,be=m.transform,Oe="map"===w,Ne="map"===E,ve=Oe&&"point"!==c.layout.get("symbol-placement"),tt=Oe&&!Ne&&!ve,qe=void 0!==c.layout.get("symbol-sort-key").constantOr(1);let nt=!1;const Tt=m.depthModeForSublayer(0,a.DepthMode.ReadOnly),ft=[a.mercatorXfromLng(be.center.lng),a.mercatorYfromLat(be.center.lat)],At=c.layout.get("text-variable-anchor"),Zt="globe"===be.projection.name,Kt=[],nn=[0,-1,0];let Bn=nn;!Zt&&!be.mercatorFromTransition||Oe||(Bn=function(qt){const xn=qt._camera.getWorldToCamera(qt.worldSize,1),cn=a.multiply([],xn,qt.globeMatrix);a.invert(cn,cn);const An=[0,0,0],tn=[0,1,0,0];return a.transformMat4$1(tn,tn,cn),An[0]=tn[0],An[1]=tn[1],An[2]=tn[2],a.normalize(An,An),An}(be));for(const qt of y){const xn=i.getTile(qt),cn=xn.getBucket(c);if(!cn||"mercator"===cn.projection.name&&Zt)continue;const An=u?cn.text:cn.icon;if(!An||cn.fullyClipped||!An.segments.get().length)continue;const tn=An.programConfigurations.get(c.id),$t=u||cn.sdfIcons,on=u?cn.textSizeData:cn.iconSizeData,wn=Ne||0!==be.pitch,On=a.evaluateSizeForZoom(on,be.zoom);let ri,zi,ti,Xn,di=[0,0],Ji=null;if(u)zi=xn.glyphAtlasTexture,ti=ye.LINEAR,ri=xn.glyphAtlasTexture.size,cn.iconsInText&&(di=xn.imageAtlasTexture.size,Ji=xn.imageAtlasTexture,Xn=wn||m.options.rotating||m.options.zooming||"composite"===on.kind||"camera"===on.kind?ye.LINEAR:ye.NEAREST);else{const na=1!==c.layout.get("icon-size").constantOr(0)||cn.iconsNeedLinear;zi=xn.imageAtlasTexture,ti=$t||m.options.rotating||m.options.zooming||na||wn?ye.LINEAR:ye.NEAREST,ri=xn.imageAtlasTexture.size}const gi="globe"===cn.projection.name,Tr=gi?Bn:nn,Or=gi?a.globeToMercatorTransition(be.zoom):0,Rr=Fi(qt,cn.getProjection(),be),Vr=be.calculatePixelsToTileUnitsMatrix(xn),Ao=qi(Rr,xn.tileID.canonical,Ne,Oe,be,cn.getProjection(),Vr),bs=m.terrain&&Ne&&ve?a.invert(a.create(),Ao):Et,Ka=Kr(Rr,xn.tileID.canonical,Ne,Oe,be,cn.getProjection(),Vr),Ll=At&&cn.hasTextData(),to="none"!==c.layout.get("icon-text-fit")&&Ll&&cn.hasIconData();if(ve){const na=be.elevation,va=na?na.getAtTileOffsetFunc(qt,be.center.lat,be.worldSize,cn.getProjection()):null,pl=Dr(Rr,xn.tileID.canonical,Ne,Oe,be,cn.getProjection(),Vr);fe(cn,Rr,m,u,pl,Ka,Ne,P,va,qt)}const jr=ve||u&&At||to,yr=m.translatePosMatrix(Rr,xn,p,f),ho=jr?Et:Ao,is=m.translatePosMatrix(Ka,xn,p,f,!0),Nr=cn.getProjection().createInversionMatrix(be,qt.canonical),rs=[];m.terrainRenderModeElevated()&&Ne&&rs.push("PITCH_WITH_MAP_TERRAIN"),gi&&rs.push("PROJECTION_GLOBE_VIEW"),jr&&rs.push("PROJECTED_POS_ON_VIEWPORT");const os=$t&&0!==c.paint.get(u?"text-halo-width":"icon-halo-width").constantOr(1);let hl;hl=$t?cn.iconsInText?sl(on.kind,On,tt,Ne,m,yr,ho,is,ri,di,qt,Or,ft,Nr,Tr,cn.getProjection()):Qc(on.kind,On,tt,Ne,m,yr,ho,is,u,ri,!0,qt,Or,ft,Nr,Tr,cn.getProjection()):Ws(on.kind,On,tt,Ne,m,yr,ho,is,u,ri,qt,Or,ft,Nr,Tr,cn.getProjection());const zs={program:m.useProgram(Ci($t,u,cn),tn,rs),buffers:An,uniformValues:hl,atlasTexture:zi,atlasTextureIcon:Ji,atlasInterpolation:ti,atlasInterpolationIcon:Xn,isSDF:$t,hasHalo:os,tile:xn,labelPlaneMatrixInv:bs};if(qe&&cn.canOverlap){nt=!0;const na=An.segments.get();for(const va of na)Kt.push({segments:new a.SegmentVector([va]),sortKey:va.sortKey,state:zs})}else Kt.push({segments:An.segments,sortKey:0,state:zs})}nt&&Kt.sort((qt,xn)=>qt.sortKey-xn.sortKey);for(const qt of Kt){const xn=qt.state;if(m.terrain&&m.terrain.setupElevationDraw(xn.tile,xn.program,{useDepthForOcclusion:!Zt,labelPlaneMatrixInv:xn.labelPlaneMatrixInv}),Q.activeTexture.set(ye.TEXTURE0),xn.atlasTexture.bind(xn.atlasInterpolation,ye.CLAMP_TO_EDGE),xn.atlasTextureIcon&&(Q.activeTexture.set(ye.TEXTURE1),xn.atlasTextureIcon&&xn.atlasTextureIcon.bind(xn.atlasInterpolationIcon,ye.CLAMP_TO_EDGE)),xn.isSDF){const cn=xn.uniformValues;xn.hasHalo&&(cn.u_is_halo=1,Gi(xn.buffers,qt.segments,c,m,xn.program,Tt,O,V,cn)),cn.u_is_halo=0}Gi(xn.buffers,qt.segments,c,m,xn.program,Tt,O,V,xn.uniformValues)}}function Gi(m,i,c,y,u,p,f,w,E){const P=y.context,O=[m.dynamicLayoutVertexBuffer,m.opacityVertexBuffer,m.globeExtVertexBuffer];u.draw(P,P.gl.TRIANGLES,p,f,w,a.CullFaceMode.disabled,E,c.id,m.layoutVertexBuffer,m.indexBuffer,i,c.paint,y.transform.zoom,m.programConfigurations.get(c.id),O)}function ir(m,i,c,y,u,p,f){const w=m.context.gl,E=c.paint.get("fill-pattern"),P=E&&E.constantOr(1);let O,V,Q,ye,be;f?(V=P&&!c.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",O=w.LINES):(V=P?"fillPattern":"fill",O=w.TRIANGLES);for(const Oe of y){const Ne=i.getTile(Oe);if(P&&!Ne.patternsLoaded())continue;const ve=Ne.getBucket(c);if(!ve)continue;m.prepareDrawTile();const tt=ve.programConfigurations.get(c.id),qe=m.useProgram(V,tt);P&&(m.context.activeTexture.set(w.TEXTURE0),Ne.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),tt.updatePaintBuffers());const nt=E.constantOr(null);if(nt&&Ne.imageAtlas){const ft=Ne.imageAtlas.patternPositions[nt.toString()];ft&&tt.setConstantPatternPositions(ft)}const Tt=m.translatePosMatrix(Oe.projMatrix,Ne,c.paint.get("fill-translate"),c.paint.get("fill-translate-anchor"));if(f){ye=ve.indexBuffer2,be=ve.segments2;const ft=m.terrain&&m.terrain.renderingToTexture?m.terrain.drapeBufferSize:[w.drawingBufferWidth,w.drawingBufferHeight];Q="fillOutlinePattern"===V&&P?pr(Tt,m,Ne,ft):fi(Tt,ft)}else ye=ve.indexBuffer,be=ve.segments,Q=P?fn(Tt,m,Ne):Te(Tt);m.prepareDrawProgram(m.context,qe,Oe.toUnwrapped()),qe.draw(m.context,O,u,m.stencilModeForClipping(Oe),p,a.CullFaceMode.disabled,Q,c.id,ve.layoutVertexBuffer,ye,be,c.paint,m.transform.zoom,tt)}}function sr(m,i,c,y,u,p,f){const w=m.context,E=w.gl,P=m.transform,O=c.paint.get("fill-extrusion-pattern"),V=O.constantOr(1),Q=c.paint.get("fill-extrusion-opacity"),ye=[c.paint.get("fill-extrusion-ambient-occlusion-intensity"),c.paint.get("fill-extrusion-ambient-occlusion-radius")],be=c.layout.get("fill-extrusion-edge-radius"),Oe="globe"===P.projection.name?a.fillExtrusionHeightLift():0,Ne="globe"===P.projection.name,ve=Ne?a.globeToMercatorTransition(P.zoom):0,tt=[a.mercatorXfromLng(P.center.lng),a.mercatorYfromLat(P.center.lat)],qe=[];Ne&&qe.push("PROJECTION_GLOBE_VIEW"),ye[0]>0&&qe.push("FAUX_AO");for(const nt of y){const Tt=i.getTile(nt),ft=Tt.getBucket(c);if(!ft||ft.projection.name!==P.projection.name)continue;const At=ft.programConfigurations.get(c.id),Zt=m.useProgram(V?"fillExtrusionPattern":"fillExtrusion",At,qe);if(m.terrain){const An=m.terrain;if(m.style.terrainSetForDrapingOnly())An.setupElevationDraw(Tt,Zt,{useMeterToDem:!0});else{if(!ft.enableTerrain)continue;if(An.setupElevationDraw(Tt,Zt,{useMeterToDem:!0}),_o(w,i,nt,ft,c,An),!ft.centroidVertexBuffer){const tn=Zt.attributes.a_centroid_pos;void 0!==tn&&E.vertexAttrib2f(tn,0,0)}}}V&&(m.context.activeTexture.set(E.TEXTURE0),Tt.imageAtlasTexture.bind(E.LINEAR,E.CLAMP_TO_EDGE),At.updatePaintBuffers());const Kt=O.constantOr(null);if(Kt&&Tt.imageAtlas){const An=Tt.imageAtlas.patternPositions[Kt.toString()];An&&At.setConstantPatternPositions(An)}const nn=m.translatePosMatrix(nt.projMatrix,Tt,c.paint.get("fill-extrusion-translate"),c.paint.get("fill-extrusion-translate-anchor")),Bn=P.projection.createInversionMatrix(P,nt.canonical),qt=c.paint.get("fill-extrusion-vertical-gradient"),xn=V?W(nn,m,qt,Q,ye,be,nt,Tt,Oe,ve,tt,Bn):Y(nn,m,qt,Q,ye,be,nt,Oe,ve,tt,Bn);m.prepareDrawProgram(w,Zt,nt.toUnwrapped());const cn=[];m.terrain&&cn.push(ft.centroidVertexBuffer),Ne&&cn.push(ft.layoutVertexExtBuffer),Zt.draw(w,w.gl.TRIANGLES,u,p,f,a.CullFaceMode.backCCW,xn,c.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,c.paint,m.transform.zoom,At,cn)}}function _o(m,i,c,y,u,p){const f=[ve=>{let tt=ve.canonical.x-1,qe=ve.wrap;return tt<0&&(tt=(1<<ve.canonical.z)-1,qe--),new a.OverscaledTileID(ve.overscaledZ,qe,ve.canonical.z,tt,ve.canonical.y)},ve=>{let tt=ve.canonical.x+1,qe=ve.wrap;return tt===1<<ve.canonical.z&&(tt=0,qe++),new a.OverscaledTileID(ve.overscaledZ,qe,ve.canonical.z,tt,ve.canonical.y)},ve=>new a.OverscaledTileID(ve.overscaledZ,ve.wrap,ve.canonical.z,ve.canonical.x,(0===ve.canonical.y?1<<ve.canonical.z:ve.canonical.y)-1),ve=>new a.OverscaledTileID(ve.overscaledZ,ve.wrap,ve.canonical.z,ve.canonical.x,ve.canonical.y===(1<<ve.canonical.z)-1?0:ve.canonical.y+1)],w=ve=>{const tt=i.getSource().minzoom,qe=Tt=>{const ft=i.getTileByID(Tt);if(ft&&ft.hasData())return ft.getBucket(u)},nt=[0,-1,1];for(const Tt of nt){if(ve.overscaledZ+Tt<tt)continue;const ft=qe(ve.calculateScaledKey(ve.overscaledZ+Tt));if(ft)return ft}},E=[0,0,0],P=(ve,tt)=>(E[0]=Math.min(ve.min.y,tt.min.y),E[1]=Math.max(ve.max.y,tt.max.y),E[2]=a.EXTENT-tt.min.x>ve.max.x?tt.min.x-a.EXTENT:ve.max.x,E),O=(ve,tt)=>(E[0]=Math.min(ve.min.x,tt.min.x),E[1]=Math.max(ve.max.x,tt.max.x),E[2]=a.EXTENT-tt.min.y>ve.max.y?tt.min.y-a.EXTENT:ve.max.y,E),V=[(ve,tt)=>P(ve,tt),(ve,tt)=>P(tt,ve),(ve,tt)=>O(ve,tt),(ve,tt)=>O(tt,ve)],Q=new a.pointGeometry(0,0);let ye,be,Oe;const Ne=(ve,tt,qe,nt,Tt)=>{const ft=[[nt?qe:ve,nt?ve:qe,0],[nt?qe:tt,nt?tt:qe,0]],At=Tt<0?a.EXTENT+Tt:Tt,Zt=[nt?At:(ve+tt)/2,nt?(ve+tt)/2:At,0];return 0===qe&&Tt<0||0!==qe&&Tt>0?p.getForTilePoints(Oe,[Zt],!0,be):ft.push(Zt),p.getForTilePoints(c,ft,!0,ye),Math.max(ft[0][2],ft[1][2],Zt[2])/p.exaggeration()};for(let ve=0;ve<4;ve++){const tt=(ve<2?1:5)-ve,qe=y.borders[ve];if(0===qe.length)continue;const nt=Oe=f[ve](c),Tt=w(nt);if(!(Tt&&Tt instanceof a.FillExtrusionBucket&&Tt.enableTerrain)||y.borderDoneWithNeighborZ[ve]===Tt.canonical.z&&Tt.borderDoneWithNeighborZ[tt]===y.canonical.z||(be=p.findDEMTileFor(nt),!be||!be.dem))continue;if(!ye){const Kt=p.findDEMTileFor(c);if(!Kt||!Kt.dem)return;ye=Kt}const ft=Tt.borders[tt];let At=0;const Zt=Tt.borderDoneWithNeighborZ[tt]!==y.canonical.z;if(y.canonical.z===Tt.canonical.z){for(let Kt=0;Kt<qe.length;Kt++){const nn=y.featuresOnBorder[qe[Kt]],Bn=nn.borders[ve];let qt;for(;At<ft.length&&(qt=Tt.featuresOnBorder[ft[At]],!(qt.borders[tt][1]>Bn[0]+3));)Zt&&Tt.encodeCentroid(void 0,qt,!1),At++;if(qt&&At<ft.length){const xn=At;let cn=0;for(;!(qt.borders[tt][0]>Bn[1]-3)&&(cn++,++At!==ft.length);)qt=Tt.featuresOnBorder[ft[At]];if(qt=Tt.featuresOnBorder[ft[xn]],nn.intersectsCount()>1||qt.intersectsCount()>1||1!==cn){1!==cn&&(At=xn),y.encodeCentroid(void 0,nn,!1),Zt&&Tt.encodeCentroid(void 0,qt,!1);continue}const An=V[ve](nn,qt),tn=ve%2?a.EXTENT-1:0;Q.x=Ne(An[0],Math.min(a.EXTENT-1,An[1]),tn,ve<2,An[2]),Q.y=0,y.encodeCentroid(Q,nn,!1),Zt&&Tt.encodeCentroid(Q,qt,!1)}else y.encodeCentroid(void 0,nn,!1)}y.borderDoneWithNeighborZ[ve]=Tt.canonical.z,y.needsCentroidUpdate=!0,Zt&&(Tt.borderDoneWithNeighborZ[tt]=y.canonical.z,Tt.needsCentroidUpdate=!0)}else{for(const Kt of qe)y.encodeCentroid(void 0,y.featuresOnBorder[Kt],!1);if(Zt){for(const Kt of ft)Tt.encodeCentroid(void 0,Tt.featuresOnBorder[Kt],!1);Tt.borderDoneWithNeighborZ[tt]=y.canonical.z,Tt.needsCentroidUpdate=!0}y.borderDoneWithNeighborZ[ve]=Tt.canonical.z,y.needsCentroidUpdate=!0}}(y.needsCentroidUpdate||!y.centroidVertexBuffer&&0!==y.centroidVertexArray.length)&&y.uploadCentroid(m)}const yo=new a.Color(1,0,0,1),Os=new a.Color(0,1,0,1),ts=new a.Color(0,0,1,1),ql=new a.Color(1,0,1,1),El=new a.Color(0,1,1,1);function Pa(m,i,c){const y=m.context,u=m.transform,p=y.gl,f="globe"===u.projection.name,w=f?["PROJECTION_GLOBE_VIEW"]:null;let E=c.projMatrix;if(f&&a.globeToMercatorTransition(u.zoom)>0){const nn=a.transitionTileAABBinECEF(c.canonical,u),Bn=a.globeDenormalizeECEF(nn);E=a.multiply(new Float32Array(16),u.globeMatrix,Bn),a.multiply(E,u.projMatrix,E)}const P=m.useProgram("debug",null,w),O=i.getTileByID(c.key);m.terrain&&m.terrain.setupElevationDraw(O,P);const V=a.DepthMode.disabled,Q=a.StencilMode.disabled,ye=m.colorModeForRenderPass();y.activeTexture.set(p.TEXTURE0),m.emptyTexture.bind(p.LINEAR,p.CLAMP_TO_EDGE),f?O._makeGlobeTileDebugBuffers(m.context,u):O._makeDebugTileBoundsBuffers(m.context,u.projection);const Oe=O._tileDebugBuffer||m.debugBuffer,Ne=O._tileDebugIndexBuffer||m.debugIndexBuffer,ve=O._tileDebugSegments||m.debugSegments;P.draw(y,p.LINE_STRIP,V,Q,ye,a.CullFaceMode.disabled,ol(E,a.Color.red),"$debug",Oe,Ne,ve,null,null,null,[O._globeTileDebugBorderBuffer]);const tt=O.latestRawTileData,qe=Math.floor((tt&&tt.byteLength||0)/1024),nt=i.getTile(c).tileSize,Tt=512/Math.min(nt,512)*(c.overscaledZ/u.zoom)*.5;let ft=c.canonical.toString();c.overscaledZ!==c.canonical.z&&(ft+=` => ${c.overscaledZ}`),ft+=` ${qe}kb`,function(nn,Bn){nn.initDebugOverlayCanvas();const qt=nn.debugOverlayCanvas,xn=nn.context.gl,cn=nn.debugOverlayCanvas.getContext("2d");cn.clearRect(0,0,qt.width,qt.height),cn.shadowColor="white",cn.shadowBlur=2,cn.lineWidth=1.5,cn.strokeStyle="white",cn.textBaseline="top",cn.font="bold 36px Open Sans, sans-serif",cn.fillText(Bn,5,5),cn.strokeText(Bn,5,5),nn.debugOverlayTexture.update(qt),nn.debugOverlayTexture.bind(xn.LINEAR,xn.CLAMP_TO_EDGE)}(m,ft);const At=O._tileDebugTextBuffer||m.debugBuffer,Zt=O._tileDebugTextIndexBuffer||m.quadTriangleIndexBuffer,Kt=O._tileDebugTextSegments||m.debugSegments;P.draw(y,p.TRIANGLES,V,Q,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,ol(E,a.Color.transparent,Tt),"$debug",At,Zt,Kt,null,null,null,[O._globeTileDebugTextBuffer])}function vs(m,i,c,y){ga(m,0,i+c/2,m.transform.width,c,y)}function Ha(m,i,c,y){ga(m,i-c/2,0,c,m.transform.height,y)}function ga(m,i,c,y,u,p){const f=m.context,w=f.gl;w.enable(w.SCISSOR_TEST),w.scissor(i*a.exported.devicePixelRatio,c*a.exported.devicePixelRatio,y*a.exported.devicePixelRatio,u*a.exported.devicePixelRatio),f.clear({color:p}),w.disable(w.SCISSOR_TEST)}const ao=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Rs}=ao;function wr(m,i,c,y){m.emplaceBack(i,c,y)}class Yl{constructor(i){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,wr(this.vertexArray,-1,-1,1),wr(this.vertexArray,1,-1,1),wr(this.vertexArray,-1,1,1),wr(this.vertexArray,1,1,1),wr(this.vertexArray,-1,-1,-1),wr(this.vertexArray,1,-1,-1),wr(this.vertexArray,-1,1,-1),wr(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=i.createVertexBuffer(this.vertexArray,Rs),this.indexBuffer=i.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function er(m,i,c,y,u,p){const f=m.gl,w=i.paint.get("sky-atmosphere-color"),E=i.paint.get("sky-atmosphere-halo-color"),P=i.paint.get("sky-atmosphere-sun-intensity"),O={u_matrix_3f:a.fromMat4(a.create$1(),y),u_sun_direction:u,u_sun_intensity:P,u_color_tint_r:[(be=w).r,be.g,be.b,be.a],u_color_tint_m:[(Oe=E).r,Oe.g,Oe.b,Oe.a],u_luminance:5e-5};var be,Oe;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_CUBE_MAP_POSITIVE_X+p,i.skyboxTexture,0),c.draw(m,f.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,O,"skyboxCapture",i.skyboxGeometry.vertexBuffer,i.skyboxGeometry.indexBuffer,i.skyboxGeometry.segment)}const Jl=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class eu{constructor(i){const c=new a.StructArrayLayout5f20;c.emplaceBack(-1,1,1,0,0),c.emplaceBack(1,1,1,1,0),c.emplaceBack(1,-1,1,1,1),c.emplaceBack(-1,-1,1,0,1);const y=new a.StructArrayLayout3ui6;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=i.createVertexBuffer(c,Jl.members),this.indexBuffer=i.createIndexBuffer(y),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const U={symbol:function(m,i,c,y,u){if("translucent"!==m.renderPass)return;const p=a.StencilMode.disabled,f=m.colorModeForRenderPass();c.layout.get("text-variable-anchor")&&function(w,E,P,O,V,Q,ye){const be=E.transform,Oe="map"===V,Ne="map"===Q;for(const ve of w){const tt=O.getTile(ve),qe=tt.getBucket(P);if(!qe||!qe.text||!qe.text.segments.get().length)continue;const nt=a.evaluateSizeForZoom(qe.textSizeData,be.zoom),Tt=Fi(ve,qe.getProjection(),be),ft=be.calculatePixelsToTileUnitsMatrix(tt),At=qi(Tt,tt.tileID.canonical,Ne,Oe,be,qe.getProjection(),ft),Zt="none"!==P.layout.get("icon-text-fit")&&qe.hasIconData();if(nt){const Kt=Math.pow(2,be.zoom-tt.tileID.overscaledZ);Vn(qe,Oe,Ne,ye,a.symbolSize,be,At,ve,Kt,nt,Zt)}}}(y,m,c,i,c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),u),0!==c.paint.get("icon-opacity").constantOr(1)&&ii(m,i,c,y,!1,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),c.layout.get("icon-rotation-alignment"),c.layout.get("icon-pitch-alignment"),c.layout.get("icon-keep-upright"),p,f),0!==c.paint.get("text-opacity").constantOr(1)&&ii(m,i,c,y,!0,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),c.layout.get("text-rotation-alignment"),c.layout.get("text-pitch-alignment"),c.layout.get("text-keep-upright"),p,f),i.map.showCollisionBoxes&&(_e(m,i,c,y,c.paint.get("text-translate"),c.paint.get("text-translate-anchor"),!0),_e(m,i,c,y,c.paint.get("icon-translate"),c.paint.get("icon-translate-anchor"),!1))},circle:function(m,i,c,y){if("translucent"!==m.renderPass)return;const u=c.paint.get("circle-opacity"),p=c.paint.get("circle-stroke-width"),f=c.paint.get("circle-stroke-opacity"),w=void 0!==c.layout.get("circle-sort-key").constantOr(1);if(0===u.constantOr(1)&&(0===p.constantOr(1)||0===f.constantOr(1)))return;const E=m.context,P=E.gl,O=m.transform,V=m.depthModeForSublayer(0,a.DepthMode.ReadOnly),Q=a.StencilMode.disabled,ye=m.colorModeForRenderPass(),be="globe"===O.projection.name,Oe=[a.mercatorXfromLng(O.center.lng),a.mercatorYfromLat(O.center.lat)],Ne=[];for(let tt=0;tt<y.length;tt++){const qe=y[tt],nt=i.getTile(qe),Tt=nt.getBucket(c);if(!Tt||Tt.projection.name!==O.projection.name)continue;const ft=Tt.programConfigurations.get(c.id),At=Fo(c);be&&At.push("PROJECTION_GLOBE_VIEW");const Zt=m.useProgram("circle",ft,At),Kt=Tt.layoutVertexBuffer,nn=Tt.globeExtVertexBuffer,Bn=Tt.indexBuffer,qt=O.projection.createInversionMatrix(O,qe.canonical),xn={programConfiguration:ft,program:Zt,layoutVertexBuffer:Kt,globeExtVertexBuffer:nn,indexBuffer:Bn,uniformValues:Ps(m,qe,nt,qt,Oe,c),tile:nt};if(w){const cn=Tt.segments.get();for(const An of cn)Ne.push({segments:new a.SegmentVector([An]),sortKey:An.sortKey,state:xn})}else Ne.push({segments:Tt.segments,sortKey:0,state:xn})}w&&Ne.sort((tt,qe)=>tt.sortKey-qe.sortKey);const ve={useDepthForOcclusion:!be};for(const tt of Ne){const{programConfiguration:qe,program:nt,layoutVertexBuffer:Tt,globeExtVertexBuffer:ft,indexBuffer:At,uniformValues:Zt,tile:Kt}=tt.state,nn=tt.segments;m.terrain&&m.terrain.setupElevationDraw(Kt,nt,ve),m.prepareDrawProgram(E,nt,Kt.tileID.toUnwrapped()),nt.draw(E,P.TRIANGLES,V,Q,ye,a.CullFaceMode.disabled,Zt,c.id,Tt,At,nn,c.paint,O.zoom,qe,[ft])}},heatmap:function(m,i,c,y){if(0!==c.paint.get("heatmap-opacity"))if("offscreen"===m.renderPass){const u=m.context,p=u.gl,f=a.StencilMode.disabled,w=new a.ColorMode([p.ONE,p.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(ye,be,Oe,Ne){const ve=ye.gl,tt=be.width*Ne,qe=be.height*Ne;ye.activeTexture.set(ve.TEXTURE1),ye.viewport.set([0,0,tt,qe]);let nt=Oe.heatmapFbo;if(!nt||nt&&(nt.width!==tt||nt.height!==qe)){nt&&nt.destroy();const Tt=ve.createTexture();ve.bindTexture(ve.TEXTURE_2D,Tt),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_S,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_WRAP_T,ve.CLAMP_TO_EDGE),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MIN_FILTER,ve.LINEAR),ve.texParameteri(ve.TEXTURE_2D,ve.TEXTURE_MAG_FILTER,ve.LINEAR),nt=Oe.heatmapFbo=ye.createFramebuffer(tt,qe,!1),function(ft,At,Zt,Kt,nn,Bn){const qt=ft.gl;qt.texImage2D(qt.TEXTURE_2D,0,ft.isWebGL2&&ft.extRenderToTextureHalfFloat?qt.RGBA16F:qt.RGBA,nn,Bn,0,qt.RGBA,ft.extRenderToTextureHalfFloat?ft.isWebGL2?qt.HALF_FLOAT:ft.extTextureHalfFloat.HALF_FLOAT_OES:qt.UNSIGNED_BYTE,null),Kt.colorAttachment.set(Zt)}(ye,0,Tt,nt,tt,qe)}else ve.bindTexture(ve.TEXTURE_2D,nt.colorAttachment.get()),ye.bindFramebuffer.set(nt.framebuffer)})(u,m,c,"globe"===m.transform.projection.name?.5:.25),u.clear({color:a.Color.transparent});const E=m.transform,P="globe"===E.projection.name,O=P?["PROJECTION_GLOBE_VIEW"]:null,V=P?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,Q=[a.mercatorXfromLng(E.center.lng),a.mercatorYfromLat(E.center.lat)];for(let ye=0;ye<y.length;ye++){const be=y[ye];if(i.hasRenderableParent(be))continue;const Oe=i.getTile(be),Ne=Oe.getBucket(c);if(!Ne||Ne.projection.name!==E.projection.name)continue;const ve=Ne.programConfigurations.get(c.id),tt=m.useProgram("heatmap",ve,O),{zoom:qe}=m.transform;m.terrain&&m.terrain.setupElevationDraw(Oe,tt),m.prepareDrawProgram(u,tt,be.toUnwrapped());const nt=E.projection.createInversionMatrix(E,be.canonical);tt.draw(u,p.TRIANGLES,a.DepthMode.disabled,f,w,V,ki(m,be,Oe,nt,Q,qe,c.paint.get("heatmap-intensity")),c.id,Ne.layoutVertexBuffer,Ne.indexBuffer,Ne.segments,c.paint,m.transform.zoom,ve,P?[Ne.globeExtVertexBuffer]:null)}u.viewport.set([0,0,m.width,m.height])}else"translucent"===m.renderPass&&(m.context.setColorMode(m.colorModeForRenderPass()),function(u,p){const f=u.context,w=f.gl,E=p.heatmapFbo;if(!E)return;f.activeTexture.set(w.TEXTURE0),w.bindTexture(w.TEXTURE_2D,E.colorAttachment.get()),f.activeTexture.set(w.TEXTURE1);let P=p.colorRampTexture;P||(P=p.colorRampTexture=new a.Texture(f,p.colorRamp,w.RGBA)),P.bind(w.LINEAR,w.CLAMP_TO_EDGE),u.useProgram("heatmapTexture").draw(f,w.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,u.colorModeForRenderPass(),a.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:p.paint.get("heatmap-opacity")},p.id,u.viewportBuffer,u.quadTriangleIndexBuffer,u.viewportSegments,p.paint,u.transform.zoom)}(m,c))},line:function(m,i,c,y){if("translucent"!==m.renderPass)return;const u=c.paint.get("line-opacity"),p=c.paint.get("line-width");if(0===u.constantOr(1)||0===p.constantOr(1))return;const f=m.depthModeForSublayer(0,a.DepthMode.ReadOnly),w=m.colorModeForRenderPass(),E=m.terrain&&m.terrain.renderingToTexture?1:a.exported.devicePixelRatio,P=c.paint.get("line-dasharray"),O=P.constantOr(1),V=c.layout.get("line-cap"),Q=c.paint.get("line-pattern"),ye=Q.constantOr(1),be=c.paint.get("line-gradient"),Oe=ye?"linePattern":"line",Ne=m.context,ve=Ne.gl,tt=(nt=>{const Tt=[];Gs(nt)&&Tt.push("RENDER_LINE_DASH"),nt.paint.get("line-gradient")&&Tt.push("RENDER_LINE_GRADIENT");const ft=nt.paint.get("line-trim-offset");0===ft[0]&&0===ft[1]||Tt.push("RENDER_LINE_TRIM_OFFSET");const At=nt.paint.get("line-pattern").constantOr(1),Zt=1!==nt.paint.get("line-opacity").constantOr(1);return!At&&Zt&&Tt.push("RENDER_LINE_ALPHA_DISCARD"),Tt})(c);let qe=tt.includes("RENDER_LINE_ALPHA_DISCARD");m.terrain&&m.terrain.clipOrMaskOverlapStencilType()&&(qe=!1);for(const nt of y){const Tt=i.getTile(nt);if(ye&&!Tt.patternsLoaded())continue;const ft=Tt.getBucket(c);if(!ft)continue;m.prepareDrawTile();const At=ft.programConfigurations.get(c.id),Zt=m.useProgram(Oe,At,tt),Kt=Q.constantOr(null);if(Kt&&Tt.imageAtlas){const $t=Tt.imageAtlas.patternPositions[Kt.toString()];$t&&At.setConstantPatternPositions($t)}const nn=P.constantOr(null),Bn=V.constantOr(null);if(!ye&&nn&&Bn&&Tt.lineAtlas){const $t=Tt.lineAtlas.getDash(nn,Bn);$t&&At.setConstantPatternPositions($t)}let[qt,xn]=c.paint.get("line-trim-offset");("round"===Bn||"square"===Bn)&&qt!==xn&&(0===qt&&(qt-=1),1===xn&&(xn+=1));const cn=m.terrain?nt.projMatrix:null,An=ye?Tl(m,Tt,c,cn,E):Ga(m,Tt,c,cn,ft.lineClipsArray.length,E,[qt,xn]);if(be){const $t=ft.gradients[c.id];let on=$t.texture;if(c.gradientVersion!==$t.version){let wn=256;if(c.stepInterpolant){const On=i.getSource().maxzoom,ri=nt.canonical.z===On?Math.ceil(1<<m.transform.maxZoom-nt.canonical.z):1;wn=a.clamp(a.nextPowerOfTwo(ft.maxLineLength/a.EXTENT*1024*ri),256,Ne.maxTextureSize)}$t.gradient=a.renderColorRamp({expression:c.gradientExpression(),evaluationKey:"lineProgress",resolution:wn,image:$t.gradient||void 0,clips:ft.lineClipsArray}),$t.texture?$t.texture.update($t.gradient):$t.texture=new a.Texture(Ne,$t.gradient,ve.RGBA),$t.version=c.gradientVersion,on=$t.texture}Ne.activeTexture.set(ve.TEXTURE1),on.bind(c.stepInterpolant?ve.NEAREST:ve.LINEAR,ve.CLAMP_TO_EDGE)}O&&(Ne.activeTexture.set(ve.TEXTURE0),Tt.lineAtlasTexture.bind(ve.LINEAR,ve.REPEAT),At.updatePaintBuffers()),ye&&(Ne.activeTexture.set(ve.TEXTURE0),Tt.imageAtlasTexture.bind(ve.LINEAR,ve.CLAMP_TO_EDGE),At.updatePaintBuffers()),m.prepareDrawProgram(Ne,Zt,nt.toUnwrapped());const tn=$t=>{Zt.draw(Ne,ve.TRIANGLES,f,$t,w,a.CullFaceMode.disabled,An,c.id,ft.layoutVertexBuffer,ft.indexBuffer,ft.segments,c.paint,m.transform.zoom,At,[ft.layoutVertexBuffer2])};if(qe){const $t=m.stencilModeForClipping(nt).ref;0===$t&&m.terrain&&Ne.clear({stencil:0});const on={func:ve.EQUAL,mask:255};An.u_alpha_discard_threshold=.8,tn(new a.StencilMode(on,$t,255,ve.KEEP,ve.KEEP,ve.INVERT)),An.u_alpha_discard_threshold=0,tn(new a.StencilMode(on,$t,255,ve.KEEP,ve.KEEP,ve.KEEP))}else tn(m.stencilModeForClipping(nt))}qe&&(m.resetStencilClippingMasks(),m.terrain&&Ne.clear({stencil:0}))},fill:function(m,i,c,y){const u=c.paint.get("fill-color"),p=c.paint.get("fill-opacity");if(0===p.constantOr(1))return;const f=m.colorModeForRenderPass(),w=c.paint.get("fill-pattern"),E=m.opaquePassEnabledForLayer()&&!w.constantOr(1)&&1===u.constantOr(a.Color.transparent).a&&1===p.constantOr(0)?"opaque":"translucent";if(m.renderPass===E){const P=m.depthModeForSublayer(1,"opaque"===m.renderPass?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);ir(m,i,c,y,P,f,!1)}if("translucent"===m.renderPass&&c.paint.get("fill-antialias")){const P=m.depthModeForSublayer(c.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);ir(m,i,c,y,P,f,!0)}},"fill-extrusion":function(m,i,c,y){const u=c.paint.get("fill-extrusion-opacity");if(0!==u&&"translucent"===m.renderPass){const p=new a.DepthMode(m.context.gl.LEQUAL,a.DepthMode.ReadWrite,m.depthRangeFor3D);if(1!==u||c.paint.get("fill-extrusion-pattern").constantOr(1))sr(m,i,c,y,p,a.StencilMode.disabled,a.ColorMode.disabled),sr(m,i,c,y,p,m.stencilModeFor3D(),m.colorModeForRenderPass()),m.resetStencilClippingMasks();else{const f=m.colorModeForRenderPass();sr(m,i,c,y,p,a.StencilMode.disabled,f)}}},hillshade:function(m,i,c,y){if("offscreen"!==m.renderPass&&"translucent"!==m.renderPass)return;const u=m.context,p=m.depthModeForSublayer(0,a.DepthMode.ReadOnly),f=m.colorModeForRenderPass(),w=m.terrain&&m.terrain.renderingToTexture,[E,P]="translucent"!==m.renderPass||w?[{},y]:m.stencilConfigForOverlap(y);for(const O of P){const V=i.getTile(O);if(V.needsHillshadePrepare&&"offscreen"===m.renderPass)Zs(m,V,c,p,a.StencilMode.disabled,f);else if("translucent"===m.renderPass){const Q=w&&m.terrain?m.terrain.stencilModeForRTTOverlap(O):E[O.overscaledZ];jo(m,O,V,c,p,Q,f)}}u.viewport.set([0,0,m.width,m.height]),m.resetStencilClippingMasks()},raster:function(m,i,c,y,u,p){if("translucent"!==m.renderPass||0===c.paint.get("raster-opacity")||!y.length)return;const f=m.context,w=f.gl,E=i.getSource(),P=m.useProgram("raster"),O=m.colorModeForRenderPass(),V=m.terrain&&m.terrain.renderingToTexture,[Q,ye]=E instanceof dt||V?[{},y]:m.stencilConfigForOverlap(y),be=ye[ye.length-1].overscaledZ,Oe=!m.options.moving;for(const Ne of ye){const ve=V?a.DepthMode.disabled:m.depthModeForSublayer(Ne.overscaledZ-be,1===c.paint.get("raster-opacity")?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,w.LESS),tt=Ne.toUnwrapped(),qe=i.getTile(Ne);if(V&&(!qe||!qe.hasData()))continue;const nt=V?Ne.projMatrix:m.transform.calculateProjMatrix(tt,Oe),Tt=m.terrain&&V?m.terrain.stencilModeForRTTOverlap(Ne):Q[Ne.overscaledZ],ft=p?0:c.paint.get("raster-fade-duration");qe.registerFadeDuration(ft);const At=i.findLoadedParent(Ne,0),Zt=fa(qe,At,i,m.transform,ft);let Kt,nn;m.terrain&&m.terrain.prepareDrawTile();const Bn="nearest"===c.paint.get("raster-resampling")?w.NEAREST:w.LINEAR;f.activeTexture.set(w.TEXTURE0),qe.texture.bind(Bn,w.CLAMP_TO_EDGE),f.activeTexture.set(w.TEXTURE1),At?(At.texture.bind(Bn,w.CLAMP_TO_EDGE),Kt=Math.pow(2,At.tileID.overscaledZ-qe.tileID.overscaledZ),nn=[qe.tileID.canonical.x*Kt%1,qe.tileID.canonical.y*Kt%1]):qe.texture.bind(Bn,w.CLAMP_TO_EDGE);const qt=Qo(nt,nn||[0,0],Kt||1,Zt,c,E instanceof dt?E.perspectiveTransform:[0,0]);if(m.prepareDrawProgram(f,P,tt),E instanceof dt)E.boundsBuffer&&E.boundsSegments&&P.draw(f,w.TRIANGLES,ve,a.StencilMode.disabled,O,a.CullFaceMode.disabled,qt,c.id,E.boundsBuffer,m.quadTriangleIndexBuffer,E.boundsSegments);else{const{tileBoundsBuffer:xn,tileBoundsIndexBuffer:cn,tileBoundsSegments:An}=m.getTileBoundsBuffers(qe);P.draw(f,w.TRIANGLES,ve,Tt,O,a.CullFaceMode.disabled,qt,c.id,xn,cn,An)}}m.resetStencilClippingMasks()},background:function(m,i,c,y){const u=c.paint.get("background-color"),p=c.paint.get("background-opacity");if(0===p)return;const f=m.context,w=f.gl,E=m.transform,P=E.tileSize,O=c.paint.get("background-pattern");if(m.isPatternMissing(O))return;const V=!O&&1===u.a&&1===p&&m.opaquePassEnabledForLayer()?"opaque":"translucent";if(m.renderPass!==V)return;const Q=a.StencilMode.disabled,ye=m.depthModeForSublayer(0,"opaque"===V?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),be=m.colorModeForRenderPass(),Oe=m.useProgram(O?"backgroundPattern":"background");let Ne,ve=y;ve||(Ne=m.getBackgroundTiles(),ve=Object.values(Ne).map(tt=>tt.tileID)),O&&(f.activeTexture.set(w.TEXTURE0),m.imageManager.bind(m.context));for(const tt of ve){const qe=tt.toUnwrapped(),nt=y?tt.projMatrix:m.transform.calculateProjMatrix(qe);m.prepareDrawTile();const Tt=i?i.getTile(tt):Ne?Ne[tt.key]:new a.Tile(tt,P,E.zoom,m),ft=O?G(nt,p,m,O,{tileID:tt,tileSize:P}):M(nt,p,u);m.prepareDrawProgram(f,Oe,qe);const{tileBoundsBuffer:At,tileBoundsIndexBuffer:Zt,tileBoundsSegments:Kt}=m.getTileBoundsBuffers(Tt);Oe.draw(f,w.TRIANGLES,ye,Q,be,a.CullFaceMode.disabled,ft,c.id,At,Zt,Kt)}},sky:function(m,i,c){const y=m.transform,u="mercator"===y.projection.name||"globe"===y.projection.name?1:a.smoothstep(7,8,y.zoom),p=c.paint.get("sky-opacity")*u;if(0===p)return;const f=m.context,w=c.paint.get("sky-type"),E=new a.DepthMode(f.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),P=m.frameCounter/1e3%1;"atmosphere"===w?"offscreen"===m.renderPass?c.needsSkyboxCapture(m)&&(function(O,V,Q,ye){const be=O.context,Oe=be.gl;let Ne=V.skyboxFbo;if(!Ne){Ne=V.skyboxFbo=be.createFramebuffer(32,32,!1),V.skyboxGeometry=new Yl(be),V.skyboxTexture=be.gl.createTexture(),Oe.bindTexture(Oe.TEXTURE_CUBE_MAP,V.skyboxTexture),Oe.texParameteri(Oe.TEXTURE_CUBE_MAP,Oe.TEXTURE_WRAP_S,Oe.CLAMP_TO_EDGE),Oe.texParameteri(Oe.TEXTURE_CUBE_MAP,Oe.TEXTURE_WRAP_T,Oe.CLAMP_TO_EDGE),Oe.texParameteri(Oe.TEXTURE_CUBE_MAP,Oe.TEXTURE_MIN_FILTER,Oe.LINEAR),Oe.texParameteri(Oe.TEXTURE_CUBE_MAP,Oe.TEXTURE_MAG_FILTER,Oe.LINEAR);for(let nt=0;nt<6;++nt)Oe.texImage2D(Oe.TEXTURE_CUBE_MAP_POSITIVE_X+nt,0,Oe.RGBA,32,32,0,Oe.RGBA,Oe.UNSIGNED_BYTE,null)}be.bindFramebuffer.set(Ne.framebuffer),be.viewport.set([0,0,32,32]);const ve=V.getCenter(O,!0),tt=O.useProgram("skyboxCapture"),qe=new Float64Array(16);a.identity(qe),a.rotateY(qe,qe,.5*-Math.PI),er(be,V,tt,qe,ve,0),a.identity(qe),a.rotateY(qe,qe,.5*Math.PI),er(be,V,tt,qe,ve,1),a.identity(qe),a.rotateX(qe,qe,.5*-Math.PI),er(be,V,tt,qe,ve,2),a.identity(qe),a.rotateX(qe,qe,.5*Math.PI),er(be,V,tt,qe,ve,3),a.identity(qe),er(be,V,tt,qe,ve,4),a.identity(qe),a.rotateY(qe,qe,Math.PI),er(be,V,tt,qe,ve,5),be.viewport.set([0,0,O.width,O.height])}(m,c),c.markSkyboxValid(m)):"sky"===m.renderPass&&function(O,V,Q,ye,be){const Oe=O.context,Ne=Oe.gl,ve=O.transform,tt=O.useProgram("skybox");Oe.activeTexture.set(Ne.TEXTURE0),Ne.bindTexture(Ne.TEXTURE_CUBE_MAP,V.skyboxTexture);const qe={u_matrix:ve.skyboxMatrix,u_sun_direction:V.getCenter(O,!1),u_cubemap:0,u_opacity:ye,u_temporal_offset:be};O.prepareDrawProgram(Oe,tt),tt.draw(Oe,Ne.TRIANGLES,Q,a.StencilMode.disabled,O.colorModeForRenderPass(),a.CullFaceMode.backCW,qe,"skybox",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(m,c,E,p,P):"gradient"===w&&"sky"===m.renderPass&&function(O,V,Q,ye,be){const Oe=O.context,Ne=Oe.gl,ve=O.transform,tt=O.useProgram("skyboxGradient");V.skyboxGeometry||(V.skyboxGeometry=new Yl(Oe)),Oe.activeTexture.set(Ne.TEXTURE0);let qe=V.colorRampTexture;qe||(qe=V.colorRampTexture=new a.Texture(Oe,V.colorRamp,Ne.RGBA)),qe.bind(Ne.LINEAR,Ne.CLAMP_TO_EDGE);const nt=(Tt=ve.skyboxMatrix,ft=V.getCenter(O,!1),At=V.paint.get("sky-gradient-radius"),Zt=ye,Kt=be,{u_matrix:Tt,u_color_ramp:0,u_center_direction:ft,u_radius:a.degToRad(At),u_opacity:Zt,u_temporal_offset:Kt});var Tt,ft,At,Zt,Kt;O.prepareDrawProgram(Oe,tt),tt.draw(Oe,Ne.TRIANGLES,Q,a.StencilMode.disabled,O.colorModeForRenderPass(),a.CullFaceMode.backCW,nt,"skyboxGradient",V.skyboxGeometry.vertexBuffer,V.skyboxGeometry.indexBuffer,V.skyboxGeometry.segment)}(m,c,E,p,P)},debug:function(m,i,c){for(let y=0;y<c.length;y++)Pa(m,i,c[y])},custom:function(m,i,c,y){const u=m.context,p=c.implementation;if(!m.transform.projection.unsupportedLayers||!m.transform.projection.unsupportedLayers.includes("custom")||m.terrain&&(m.terrain.renderingToTexture||"offscreen"===m.renderPass)&&c.isLayerDraped()){if("offscreen"===m.renderPass){const f=p.prerender;if(f){if(m.setCustomLayerDefaults(),u.setColorMode(m.colorModeForRenderPass()),"globe"===m.transform.projection.name){const w=m.transform.pointMerc;f.call(p,u.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(m.transform.zoom),[w.x,w.y],m.transform.pixelsPerMeterRatio)}else f.call(p,u.gl,m.transform.customLayerMatrix());u.setDirty(),m.setBaseState()}}else if("translucent"===m.renderPass){if(m.terrain&&m.terrain.renderingToTexture){const w=p.renderToTile;if(w){const E=y[0].canonical,P=new a.MercatorCoordinate(E.x+y[0].wrap*(1<<E.z),E.y,E.z);u.setDepthMode(a.DepthMode.disabled),u.setStencilMode(a.StencilMode.disabled),u.setColorMode(m.colorModeForRenderPass()),m.setCustomLayerDefaults(),w.call(p,u.gl,P),u.setDirty(),m.setBaseState()}return}m.setCustomLayerDefaults(),u.setColorMode(m.colorModeForRenderPass()),u.setStencilMode(a.StencilMode.disabled);const f="3d"===p.renderingMode?new a.DepthMode(m.context.gl.LEQUAL,a.DepthMode.ReadWrite,m.depthRangeFor3D):m.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(u.setDepthMode(f),"globe"===m.transform.projection.name){const w=m.transform.pointMerc;p.render(u.gl,m.transform.customLayerMatrix(),m.transform.getProjection(),m.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(m.transform.zoom),[w.x,w.y],m.transform.pixelsPerMeterRatio)}else p.render(u.gl,m.transform.customLayerMatrix());u.setDirty(),m.setBaseState(),u.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class le{constructor(i,c,y=!1){this.context=new z(i,y),this.transform=c,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ia,this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(i,c){const y=!!i&&!!i.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ma(this,i));const u=this._terrain;this.transform.elevation=y?u:null,u.update(i,this.transform,c)}_updateFog(i){const c=i.fog;if(!c||"globe"===this.transform.projection.name||c.getOpacity(this.transform.pitch)<1||c.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,u]=c.getFovAdjustedRange(this.transform._fov);if(y>u)return void(this.transform.fogCullDistSq=null);const p=y+.78*(u-y);this.transform.fogCullDistSq=p*p}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(i,c){if(this.width=i*a.exported.devicePixelRatio,this.height=c*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._layers[y].resize()}setup(){const i=this.context,c=new a.StructArrayLayout2i4;c.emplaceBack(0,0),c.emplaceBack(a.EXTENT,0),c.emplaceBack(0,a.EXTENT),c.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=i.createVertexBuffer(c,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const y=new a.StructArrayLayout2i4;y.emplaceBack(0,0),y.emplaceBack(a.EXTENT,0),y.emplaceBack(0,a.EXTENT),y.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=i.createVertexBuffer(y,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const u=new a.StructArrayLayout2i4;u.emplaceBack(-1,-1),u.emplaceBack(1,-1),u.emplaceBack(-1,1),u.emplaceBack(1,1),this.viewportBuffer=i.createVertexBuffer(u,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const p=new a.StructArrayLayout4i8;p.emplaceBack(0,0,0,0),p.emplaceBack(a.EXTENT,0,a.EXTENT,0),p.emplaceBack(0,a.EXTENT,0,a.EXTENT),p.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=i.createVertexBuffer(p,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const f=new a.StructArrayLayout3ui6;f.emplaceBack(0,1,2),f.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=i.createIndexBuffer(f);const w=new a.StructArrayLayout1ui2;for(const P of[0,1,3,2,0])w.emplaceBack(P);this.debugIndexBuffer=i.createIndexBuffer(w),this.emptyTexture=new a.Texture(i,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),i.gl.RGBA),this.identityMat=a.create();const E=this.context.gl;this.stencilClearMode=new a.StencilMode({func:E.ALWAYS,mask:0},0,255,E.ZERO,E.ZERO,E.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new eu(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(i){return i._makeTileBoundsBuffers(this.context,this.transform.projection),i._tileBoundsBuffer?{tileBoundsBuffer:i._tileBoundsBuffer,tileBoundsIndexBuffer:i._tileBoundsIndexBuffer,tileBoundsSegments:i._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const i=this.context,c=i.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(i,c.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,vi(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(i,c,y){if(!c||this.currentStencilSource===c.id||!i.isTileClipped()||!y||0===y.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let w=!1;for(const E of y)if(void 0===this._tileClippingMaskIDs[E.key]){w=!0;break}if(!w)return}this.currentStencilSource=c.id;const u=this.context,p=u.gl;this.nextStencilID+y.length>256&&this.clearStencil(),u.setColorMode(a.ColorMode.disabled),u.setDepthMode(a.DepthMode.disabled);const f=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const w of y){const E=c.getTile(w),P=this._tileClippingMaskIDs[w.key]=this.nextStencilID++,{tileBoundsBuffer:O,tileBoundsIndexBuffer:V,tileBoundsSegments:Q}=this.getTileBoundsBuffers(E);f.draw(u,p.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:p.ALWAYS,mask:0},P,255,p.KEEP,p.KEEP,p.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,vi(w.projMatrix),"$clipping",O,V,Q)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const i=this.nextStencilID++,c=this.context.gl;return new a.StencilMode({func:c.NOTEQUAL,mask:255},i,255,c.KEEP,c.KEEP,c.REPLACE)}stencilModeForClipping(i){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(i);const c=this.context.gl;return new a.StencilMode({func:c.EQUAL,mask:255},this._tileClippingMaskIDs[i.key],0,c.KEEP,c.KEEP,c.REPLACE)}stencilConfigForOverlap(i){const c=this.context.gl,y=i.sort((f,w)=>w.overscaledZ-f.overscaledZ),u=y[y.length-1].overscaledZ,p=y[0].overscaledZ-u+1;if(p>1){this.currentStencilSource=void 0,this.nextStencilID+p>256&&this.clearStencil();const f={};for(let w=0;w<p;w++)f[w+u]=new a.StencilMode({func:c.GEQUAL,mask:255},w+this.nextStencilID,255,c.KEEP,c.KEEP,c.REPLACE);return this.nextStencilID+=p,[f,y]}return[{[u]:a.StencilMode.disabled},y]}colorModeForRenderPass(){const i=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([i.CONSTANT_COLOR,i.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(i,c,y){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const u=1-((1+this.currentLayer)*this.numSublayers+i)*this.depthEpsilon;return new a.DepthMode(y||this.context.gl.LEQUAL,c,[u,u])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(i,c){this.style=i,this.options=c,this.imageManager=i.imageManager,this.glyphManager=i.glyphManager,this.symbolFadeChange=i.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const y=this.style.order,u=this.style._sourceCaches;for(const E in u){const P=u[E];P.used&&P.prepare(this.context)}const p={},f={},w={};for(const E in u){const P=u[E];p[E]=P.getVisibleCoordinates(),f[E]=p[E].slice().reverse(),w[E]=P.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let E=0;E<y.length;E++)if(this.style._layers[y[E]].is3D()){this.opaquePassCutoff=E;break}if(this.terrain&&(this.terrain.updateTileBinding(w),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),a.isMapAuthenticated(this.context.gl)){this.renderPass="offscreen";for(const E of y){const P=this.style._layers[E],O=i._getLayerSourceCache(P);if(!P.hasOffscreenPass()||P.isHidden(this.transform.zoom))continue;const V=O?f[O.id]:void 0;("custom"===P.type||P.isSky()||V&&V.length)&&this.renderLayer(this,O,P,V)}if(this.depthRangeFor3D=[0,1-(i.order.length+2)*this.numSublayers*this.depthEpsilon],this.terrain&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&this.terrain.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:c.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=c.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=y.length-1;this.currentLayer>=0;this.currentLayer--){const E=this.style._layers[y[this.currentLayer]],P=i._getLayerSourceCache(E);if(E.isSky())continue;const O=P?f[P.id]:void 0;this._renderTileClippingMasks(E,P,O),this.renderLayer(this,P,E,O)}if(this.style.fog&&this.transform.projection.supportsFog&&function(E,P){const O=E.context,V=O.gl,Q=E.transform,ye=new a.DepthMode(V.LEQUAL,a.DepthMode.ReadOnly,[0,1]),be=E.useProgram("globeAtmosphere",null,"globe"===Q.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),Oe=a.globeToMercatorTransition(Q.zoom),Ne=P.properties.get("color").toArray01(),ve=P.properties.get("high-color").toArray01(),tt=P.properties.get("space-color").toArray01PremultipliedAlpha(),qe=a.identity$1([]);a.rotateY$1(qe,qe,-a.degToRad(Q._center.lng)),a.rotateX$1(qe,qe,a.degToRad(Q._center.lat)),a.rotateZ$1(qe,qe,Q.angle),a.rotateX$1(qe,qe,-Q._pitch);const nt=a.fromQuat(new Float32Array(16),qe),Tt=a.mapValue(P.properties.get("star-intensity"),0,1,0,.25),At=a.mapValue(P.properties.get("horizon-blend"),0,1,5e-4,.25),Zt=a.globeUseCustomAntiAliasing(E,O,Q)&&5e-4===At?Q.worldSize/(2*Math.PI*1.025)-1:Q.globeRadius,Kt=E.frameCounter/1e3%1,nn=a.length(Q.globeCenterInViewSpace),Bn=Math.sqrt(Math.pow(nn,2)-Math.pow(Zt,2)),qt=Math.acos(Bn/nn),xn={u_frustum_tl:Q.frustumCorners.TL,u_frustum_tr:Q.frustumCorners.TR,u_frustum_br:Q.frustumCorners.BR,u_frustum_bl:Q.frustumCorners.BL,u_horizon:Q.frustumCorners.horizon,u_transition:Oe,u_fadeout_range:At,u_color:Ne,u_high_color:ve,u_space_color:tt,u_star_intensity:Tt,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:Kt,u_horizon_angle:qt,u_rotation_matrix:nt};E.prepareDrawProgram(O,be);const cn=E.atmosphereBuffer;cn&&be.draw(O,V.TRIANGLES,ye,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,xn,"skybox",cn.vertexBuffer,cn.indexBuffer,cn.segments)}(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<y.length;this.currentLayer++){const E=this.style._layers[y[this.currentLayer]],P=i._getLayerSourceCache(E);E.isSky()&&this.renderLayer(this,P,E,P?f[P.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<y.length;){const E=this.style._layers[y[this.currentLayer]],P=i._getLayerSourceCache(E);if(E.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(E)){if(E.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const O=P?("symbol"===E.type?w:f)[P.id]:void 0;this._renderTileClippingMasks(E,P,P?p[P.id]:void 0),this.renderLayer(this,P,E,O),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let E=null;a.values(this.style._layers).forEach(P=>{const O=i._getLayerSourceCache(P);O&&!P.isHidden(this.transform.zoom)&&(!E||E.getSource().maxzoom<O.getSource().maxzoom)&&(E=O)}),E&&this.options.showTileBoundaries&&U.debug(this,E,E.getVisibleCoordinates())}this.options.showPadding&&function(E){const P=E.transform.padding;vs(E,E.transform.height-(P.top||0),3,yo),vs(E,P.bottom||0,3,Os),Ha(E,P.left||0,3,ts),Ha(E,E.transform.width-(P.right||0),3,ql);const O=E.transform.centerPoint;var V,Q,ye,be;ga(V=E,(Q=O.x)-1,(ye=E.transform.height-O.y)-10,2,20,be=El),ga(V,Q-10,ye-1,20,2,be)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}}renderLayer(i,c,y,u){y.isHidden(this.transform.zoom)||("background"===y.type||"sky"===y.type||"custom"===y.type||u&&u.length)&&(this.id=y.id,this.gpuTimingStart(y),(!i.transform.projection.unsupportedLayers||!i.transform.projection.unsupportedLayers.includes(y.type)||i.terrain&&"custom"===y.type)&&U[y.type](i,c,y,u,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(i){if(!this.options.gpuTiming)return;const c=this.context.extTimerQuery;let y=this.gpuTimers[i.id];y||(y=this.gpuTimers[i.id]={calls:0,cpuTime:0,query:c.createQueryEXT()}),y.calls++,c.beginQueryEXT(c.TIME_ELAPSED_EXT,y.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const i=this.context.extTimerQuery,c=i.createQueryEXT();this.deferredRenderGpuTimeQueries.push(c),i.beginQueryEXT(i.TIME_ELAPSED_EXT,c)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const i=this.context.extTimerQuery;i.endQueryEXT(i.TIME_ELAPSED_EXT)}collectGpuTimers(){const i=this.gpuTimers;return this.gpuTimers={},i}collectDeferredRenderGpuQueries(){const i=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],i}queryGpuTimers(i){const c={};for(const y in i){const u=i[y],p=this.context.extTimerQuery,f=p.getQueryObjectEXT(u.query,p.QUERY_RESULT_EXT)/1e6;p.deleteQueryEXT(u.query),c[y]=f}return c}queryGpuTimeDeferredRender(i){if(!this.options.gpuTimingDeferredRender)return 0;const c=this.context.extTimerQuery;let y=0;for(const u of i)y+=c.getQueryObjectEXT(u,c.QUERY_RESULT_EXT)/1e6,c.deleteQueryEXT(u);return y}translatePosMatrix(i,c,y,u,p){if(!y[0]&&!y[1])return i;const f=p?"map"===u?this.transform.angle:0:"viewport"===u?-this.transform.angle:0;if(f){const P=Math.sin(f),O=Math.cos(f);y=[y[0]*O-y[1]*P,y[0]*P+y[1]*O]}const w=[p?y[0]:St(c,y[0],this.transform.zoom),p?y[1]:St(c,y[1],this.transform.zoom),0],E=new Float32Array(16);return a.translate(E,i,w),E}saveTileTexture(i){const c=this._tileTextures[i.size[0]];c?c.push(i):this._tileTextures[i.size[0]]=[i]}getTileTexture(i){const c=this._tileTextures[i];return c&&c.length>0?c.pop():null}isPatternMissing(i){return null===i||void 0!==i&&!this.imageManager.getPattern(i.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const i=this.terrain&&this.terrain.renderingToTexture,c=this.terrain&&0===this.terrain.exaggeration(),y=this.style&&this.style.fog,u=[];return this.terrainRenderModeElevated()&&u.push("TERRAIN"),"globe"===this.transform.projection.name&&u.push("GLOBE"),c&&u.push("ZERO_EXAGGERATION"),y&&!i&&0!==y.getOpacity(this.transform.pitch)&&u.push("FOG"),i&&u.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&u.push("OVERDRAW_INSPECTOR"),u}useProgram(i,c,y){this.cache=this.cache||{};const u=y||[],p=this.currentGlobalDefines().concat(u),f=Go.cacheKey($s[i],i,p,c);return this.cache[f]||(this.cache[f]=new Go(this.context,i,$s[i],c,S[i],p)),this.cache[f]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const i=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(i.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(i,c,y){if(this.terrain&&this.terrain.renderingToTexture)return;const u=this.style.fog;if(u){const p=u.getOpacity(this.transform.pitch),f=((w,E,P,O,V,Q,ye,be,Oe,Ne,ve)=>{const tt=w.transform,qe=E.properties.get("color").toArray01();qe[3]=O;const nt=w.frameCounter/1e3%1;return{u_fog_matrix:P?tt.calculateFogTileMatrix(P):w.identityMat,u_fog_range:E.getFovAdjustedRange(tt._fov),u_fog_color:qe,u_fog_horizon_blend:E.properties.get("horizon-blend"),u_fog_temporal_offset:nt,u_frustum_tl:V,u_frustum_tr:Q,u_frustum_br:ye,u_frustum_bl:be,u_globe_pos:Oe,u_globe_radius:Ne,u_viewport:ve,u_globe_transition:a.globeToMercatorTransition(tt.zoom),u_is_globe:+("globe"===tt.projection.name)}})(this,u,y,p,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);c.setFogUniformValues(i,f)}}setTileLoadedFlag(i){this.tileLoaded=i}saveCanvasCopy(){const i=this.canvasCopy();i&&(this.frameCopies.push(i),this.tileLoaded=!1)}canvasCopy(){const i=this.context.gl,c=i.createTexture();return i.bindTexture(i.TEXTURE_2D,c),i.copyTexImage2D(i.TEXTURE_2D,0,i.RGBA,0,0,i.drawingBufferWidth,i.drawingBufferHeight,0),c}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const i=this.style&&this.style.fog;return!!i&&0!==i.getOpacity(this.transform.pitch)}getBackgroundTiles(){const i=this._backgroundTiles,c=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const u of y)c[u.key]=i[u.key]||new a.Tile(u,512,this.transform.tileZoom,this);return c}clearBackgroundTiles(){this._backgroundTiles={}}}class H{constructor(i=0,c=0,y=0,u=0){if(isNaN(i)||i<0||isNaN(c)||c<0||isNaN(y)||y<0||isNaN(u)||u<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=i,this.bottom=c,this.left=y,this.right=u}interpolate(i,c,y){return null!=c.top&&null!=i.top&&(this.top=a.number(i.top,c.top,y)),null!=c.bottom&&null!=i.bottom&&(this.bottom=a.number(i.bottom,c.bottom,y)),null!=c.left&&null!=i.left&&(this.left=a.number(i.left,c.left,y)),null!=c.right&&null!=i.right&&(this.right=a.number(i.right,c.right,y)),this}getCenter(i,c){const y=a.clamp((this.left+i-this.right)/2,0,i),u=a.clamp((this.top+c-this.bottom)/2,0,c);return new a.pointGeometry(y,u)}equals(i){return this.top===i.top&&this.bottom===i.bottom&&this.left===i.left&&this.right===i.right}clone(){return new H(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function Se(m,i){const c=a.getColumn(m,3);a.fromQuat(m,i),a.setColumn(m,3,c)}function ht(m,i){const c=a.identity$1([]);return a.rotateZ$1(c,c,-i),a.rotateX$1(c,c,-m),c}function hn(m,i){const c=[m[0],m[1],0],y=[i[0],i[1],0];if(a.length(c)>=1e-15){const f=a.normalize([],c);a.scale$2(y,f,a.dot(y,f)),i[0]=y[0],i[1]=y[1]}const u=a.cross([],i,m);if(a.len(u)<1e-15)return null;const p=Math.atan2(-u[1],u[0]);return ht(Math.atan2(Math.sqrt(m[0]*m[0]+m[1]*m[1]),-m[2]),p)}class Dn{constructor(i,c){this.position=i,this.orientation=c}get position(){return this._position}set position(i){if(i){const c=i instanceof a.MercatorCoordinate?i:new a.MercatorCoordinate(i[0],i[1],i[2]);this._renderWorldCopies&&(c.x=a.wrap(c.x,0,1)),this._position=c}else this._position=null}lookAtPoint(i,c){if(this.orientation=null,!this.position)return;const y=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(i)):0,u=this.position,p=a.MercatorCoordinate.fromLngLat(i,y),f=[p.x-u.x,p.y-u.y,p.z-u.z];c||(c=[0,0,1]),c[2]=Math.abs(c[2]),this.orientation=hn(f,c)}setPitchBearing(i,c){this.orientation=ht(a.degToRad(i),a.degToRad(-c))}}class ai{constructor(i,c){this._transform=a.identity([]),this.orientation=c,this.position=i}get mercatorPosition(){const i=this.position;return new a.MercatorCoordinate(i[0],i[1],i[2])}get position(){const i=a.getColumn(this._transform,3);return[i[0],i[1],i[2]]}set position(i){var c;i&&a.setColumn(this._transform,3,[(c=i)[0],c[1],c[2],1])}get orientation(){return this._orientation}set orientation(i){this._orientation=i||a.identity$1([]),i&&Se(this._transform,this._orientation)}getPitchBearing(){const i=this.forward(),c=this.right();return{bearing:Math.atan2(-c[1],c[0]),pitch:Math.atan2(Math.sqrt(i[0]*i[0]+i[1]*i[1]),-i[2])}}setPitchBearing(i,c){this._orientation=ht(i,c),Se(this._transform,this._orientation)}forward(){const i=a.getColumn(this._transform,2);return[-i[0],-i[1],-i[2]]}up(){const i=a.getColumn(this._transform,1);return[-i[0],-i[1],-i[2]]}right(){const i=a.getColumn(this._transform,0);return[i[0],i[1],i[2]]}getCameraToWorld(i,c){const y=new Float64Array(16);return a.invert(y,this.getWorldToCamera(i,c)),y}getWorldToCameraPosition(i,c,y){const u=this.position;a.scale$2(u,u,-i);const p=new Float64Array(16);return a.fromScaling(p,[y,y,y]),a.translate(p,p,u),p[10]*=c,p}getWorldToCamera(i,c){const y=new Float64Array(16),u=new Float64Array(4),p=this.position;return a.conjugate(u,this._orientation),a.scale$2(p,p,-i),a.fromQuat(y,u),a.translate(y,y,p),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=c,y[9]*=c,y[10]*=c,y[11]*=c,y}getCameraToClipPerspective(i,c,y,u){const p=new Float64Array(16);return a.perspective(p,i,c,y,u),p}getDistanceToElevation(i,c=!1){const y=0===i?0:a.mercatorZfromAltitude(i,c?a.latFromMercatorY(this.position[1]):this.position[1]),u=this.forward();return(y-this.position[2])/u[2]}clone(){return new ai([...this.position],[...this.orientation])}}function Hi(m,i){const c=or(m.projection,m.zoom,m.width,m.height),y=function(p,f,w,E,P){const O=new a.LngLat(w.lng-180*Yi,w.lat),V=new a.LngLat(w.lng+180*Yi,w.lat),Q=p.project(O.lng,O.lat),ye=p.project(V.lng,V.lat),be=-Math.atan2(ye.y-Q.y,ye.x-Q.x),Oe=a.MercatorCoordinate.fromLngLat(w);Oe.y=a.clamp(Oe.y,-.999975,.999975);const Ne=Oe.toLngLat(),ve=p.project(Ne.lng,Ne.lat),tt=a.MercatorCoordinate.fromLngLat(Ne);tt.x+=Yi;const qe=tt.toLngLat(),nt=p.project(qe.lng,qe.lat),Tt=Cr(nt.x-ve.x,nt.y-ve.y,be),ft=a.MercatorCoordinate.fromLngLat(Ne);ft.y+=Yi;const At=ft.toLngLat(),Zt=p.project(At.lng,At.lat),Kt=Cr(Zt.x-ve.x,Zt.y-ve.y,be),nn=Math.abs(Tt.x)/Math.abs(Kt.y),Bn=a.identity([]);a.rotateZ(Bn,Bn,-be*(1-(P?0:E)));const qt=a.identity([]);return a.scale(qt,qt,[1,1-(1-nn)*E,1]),qt[4]=-Kt.x/Kt.y*E,a.rotateZ(qt,qt,be),a.multiply(qt,Bn,qt),qt}(m.projection,0,m.center,c,i),u=tr(m);return a.scale(y,y,[u,u,1]),y}function tr(m){const i=m.projection,c=or(m.projection,m.zoom,m.width,m.height),y=Br(i,m.center),u=Br(i,a.LngLat.convert(i.center));return Math.pow(2,y*c+(1-c)*u)}function or(m,i,c,y,u=1/0){const p=m.range;if(!p)return 0;const f=Math.min(u,Math.max(c,y)),w=Math.log(f/1024)/Math.LN2;return a.smoothstep(p[0]+w,p[1]+w,i)}const Yi=1/4e4;function Br(m,i){const c=a.clamp(i.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),y=new a.LngLat(i.lng-180*Yi,c),u=new a.LngLat(i.lng+180*Yi,c),p=m.project(y.lng,c),f=m.project(u.lng,c),w=a.MercatorCoordinate.fromLngLat(y),E=a.MercatorCoordinate.fromLngLat(u),P=f.x-p.x,O=f.y-p.y,V=E.x-w.x,Q=E.y-w.y,ye=Math.sqrt((V*V+Q*Q)/(P*P+O*O));return Math.log(ye)/Math.LN2}function Cr(m,i,c){const y=Math.cos(c),u=Math.sin(c);return{x:m*y-i*u,y:m*u+i*y}}class zn{constructor(i,c,y,u,p,f,w){this.tileSize=512,this._renderWorldCopies=void 0===p||p,this._minZoom=i||0,this._maxZoom=c||22,this._minPitch=y??0,this._maxPitch=u??60,this.setProjection(f),this.setMaxBounds(w),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new H,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new ai,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const i=new zn(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return i._elevation=this._elevation,i._centerAltitude=this._centerAltitude,i._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,i.tileSize=this.tileSize,i.mercatorFromTransition=this.mercatorFromTransition,i.width=this.width,i.height=this.height,i.cameraElevationReference=this.cameraElevationReference,i._center=this._center,i._setZoom(this.zoom),i._seaLevelZoom=this._seaLevelZoom,i.angle=this.angle,i._fov=this._fov,i._pitch=this._pitch,i._nearZ=this._nearZ,i._farZ=this._farZ,i._averageElevation=this._averageElevation,i._unmodified=this._unmodified,i._edgeInsets=this._edgeInsets.clone(),i._camera=this._camera.clone(),i._calcMatrices(),i.freezeTileCoverage=this.freezeTileCoverage,i.frustumCorners=this.frustumCorners,i}get elevation(){return this._elevation}set elevation(i){this._elevation!==i&&(this._elevation=i,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(i,c=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||y)&&this._updateCameraOnTerrain(),(i||y)&&this._constrainCamera(c),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(i){this.projectionOptions=i||{name:"mercator"};const c=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const y=!q(c,this.getProjection());return y&&this._calcMatrices(),this.mercatorFromTransition=!1,y}setMercatorFromTransition(){const i=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const c=i!==this.projection.name;return c&&this._calcMatrices(),c}get minZoom(){return this._minZoom}set minZoom(i){this._minZoom!==i&&(this._minZoom=i,this.zoom=Math.max(this.zoom,i))}get maxZoom(){return this._maxZoom}set maxZoom(i){this._maxZoom!==i&&(this._maxZoom=i,this.zoom=Math.min(this.zoom,i))}get minPitch(){return this._minPitch}set minPitch(i){this._minPitch!==i&&(this._minPitch=i,this.pitch=Math.max(this.pitch,i))}get maxPitch(){return this._maxPitch}set maxPitch(i){this._maxPitch!==i&&(this._maxPitch=i,this.pitch=Math.min(this.pitch,i))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(i){void 0===i?i=!0:null===i&&(i=!1),this._renderWorldCopies=i}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get cameraWorldSize(){const i=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(i))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.pointGeometry(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(i){this.rotation=i}get rotation(){return-this.angle/Math.PI*180}set rotation(i){const c=-i*Math.PI/180;var y,u,p,f,w,E,P,O,V,Q;this.angle!==c&&(this._unmodified=!1,this.angle=c,this._calcMatrices(),this.rotationMatrix=(y=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(y[1]=0,y[2]=0),y[0]=1,y[3]=1,y),u=this.rotationMatrix,f=this.angle,w=(p=this.rotationMatrix)[0],E=p[1],P=p[2],O=p[3],V=Math.sin(f),Q=Math.cos(f),u[0]=w*Q+P*V,u[1]=E*Q+O*V,u[2]=w*-V+P*Q,u[3]=E*-V+O*Q)}get pitch(){return this._pitch/Math.PI*180}set pitch(i){const c=a.clamp(i,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==c&&(this._unmodified=!1,this._pitch=c,this._calcMatrices())}get aspect(){return this.width/this.height}get fovX(){return this._fov}get fovY(){const i=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/i)}set fov(i){i=Math.max(.01,Math.min(60,i)),this._fov!==i&&(this._unmodified=!1,this._fov=a.degToRad(i),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(i){this._averageElevation=i,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(i){const c=Math.min(Math.max(i,this.minZoom),this.maxZoom);this._zoom!==c&&(this._unmodified=!1,this._setZoom(c),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(i){this._zoom=i,this.scale=this.zoomScale(i),this.tileZoom=Math.floor(i),this.zoomFraction=i-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const i=this._elevation;this._centerAltitude=i.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=i.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const i=this._elevation,c=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let u=0,p=0;for(let f=0;f<c.length;f++){const w=new a.pointGeometry(c[f][0]*this.width,y+c[f][1]*(this.height-y)),E=i.pointCoordinate(w);if(!E)continue;const P=1/Math.hypot(E[0]-this._camera.position[0],E[1]-this._camera.position[1]);u+=E[3]*P,p+=P}return 0===p?NaN:u/p}get center(){return this._center}set center(i){i.lat===this._center.lat&&i.lng===this._center.lng||(this._unmodified=!1,this._center=i,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const i=this._seaLevelZoom,c=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*c,u=this._mercatorZfromZoom(i),p=this._mercatorZfromZoom(this._maxZoom),f=Math.max(u-y,p);this._setZoom(this._zoomFromMercatorZ(f))}get padding(){return this._edgeInsets.toJSON()}set padding(i){this._edgeInsets.equals(i)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,i,1),this._calcMatrices())}computeZoomRelativeTo(i){const c=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,i.toAltitude()));let y;y=i.z<this._camera.position[2]?[c.x,c.y,c.z]:[i.x,i.y,i.z];const u=a.length(a.sub([],this._camera.position,y));return a.clamp(this._zoomFromMercatorZ(u),this._minZoom,this._maxZoom)}setFreeCameraOptions(i){if(!this.height||!i.position&&!i.orientation)return;this._updateCameraState();let c=!1;if(i.orientation&&!a.exactEquals(i.orientation,this._camera.orientation)&&(c=this._setCameraOrientation(i.orientation)),i.position){const y=[i.position.x,i.position.y,i.position.z];a.exactEquals$1(y,this._camera.position)||(this._setCameraPosition(y),c=!0)}c&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const i=this._camera.position,c=new Dn;return c.position=new a.MercatorCoordinate(i[0],i[1],i[2]),c.orientation=this._camera.orientation,c._elevation=this.elevation,c._renderWorldCopies=this.renderWorldCopies,c}_setCameraOrientation(i){if(!a.length$1(i))return!1;a.normalize$1(i,i);const c=a.transformQuat([],[0,0,-1],i),y=a.transformQuat([],[0,-1,0],i);if(y[2]<0)return!1;const u=hn(c,y);return!!u&&(this._camera.orientation=u,!0)}_setCameraPosition(i){const c=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,u=this.cameraToCenterDistance;i[2]=a.clamp(i[2],u/y,u/c),this._camera.position=i}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(i){return this._edgeInsets.equals(i)}interpolatePadding(i,c,y){this._unmodified=!1,this._edgeInsets.interpolate(i,c,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(i){const c=(i.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/i.tileSize));return Math.max(0,c)}getVisibleUnwrappedCoordinates(i){const c=[new a.UnwrappedTileID(0,i)];if(this.renderWorldCopies){const y=this.pointCoordinate(new a.pointGeometry(0,0)),u=this.pointCoordinate(new a.pointGeometry(this.width,0)),p=this.pointCoordinate(new a.pointGeometry(this.width,this.height)),f=this.pointCoordinate(new a.pointGeometry(0,this.height)),w=Math.floor(Math.min(y.x,u.x,p.x,f.x)),E=Math.floor(Math.max(y.x,u.x,p.x,f.x)),P=1;for(let O=w-P;O<=E+P;O++)0!==O&&c.push(new a.UnwrappedTileID(O,i))}return c}coveringTiles(i){let c=this.coveringZoomLevel(i);const y=c,u=this.elevation&&!i.isTerrainDEM,p="mercator"===this.projection.name;if(void 0!==i.minzoom&&c<i.minzoom)return[];void 0!==i.maxzoom&&c>i.maxzoom&&(c=i.maxzoom);const f=this.locationCoordinate(this.center),w=this.center.lat,E=1<<c,P=[E*f.x,E*f.y,0],O="globe"===this.projection.name,V=!O,Q=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,c,V),ye=O?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),be=E*a.mercatorZfromAltitude(1,this.center.lat),Oe=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),Ne=[E*ye.x,E*ye.y,Oe*(V?1:be)],ve=this.cameraToCenterDistance/i.tileSize*(i.roundZoom?1:.502),tt=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?c:0,qe=i.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,nt=i.isTerrainDEM?-qe:this._elevation?this._elevation.getMinElevationBelowMSL():0,Tt=this.projection.isReprojectedInTileSpace?tr(this):1,ft=tn=>{const on=new a.MercatorCoordinate(tn.x+25e-6,tn.y,tn.z),wn=new a.MercatorCoordinate(tn.x,tn.y+25e-6,tn.z),On=tn.toLngLat(),ri=on.toLngLat(),zi=wn.toLngLat(),ti=this.locationCoordinate(On),Xn=this.locationCoordinate(ri),di=this.locationCoordinate(zi),Ji=Math.hypot(Xn.x-ti.x,Xn.y-ti.y),gi=Math.hypot(di.x-ti.x,di.y-ti.y);return Math.sqrt(Ji*gi)*Tt/25e-6},At=tn=>{const $t=qe,on=nt;return{aabb:a.tileAABB(this,E,0,0,0,tn,on,$t,this.projection),zoom:0,x:0,y:0,minZ:on,maxZ:$t,wrap:tn,fullyVisible:!1}},Zt=[];let Kt=[];const nn=c,Bn=i.reparseOverscaled?y:c,qt=tn=>tn*tn,xn=qt((Oe-this._centerAltitude)*be),cn=tn=>{if(!this._elevation||!tn.tileID||!p)return;const $t=this._elevation.getMinMaxForTile(tn.tileID),on=tn.aabb;$t?(on.min[2]=$t.min,on.max[2]=$t.max,on.center[2]=(on.min[2]+on.max[2])/2):(tn.shouldSplit=An(tn),tn.shouldSplit||(on.min[2]=on.max[2]=on.center[2]=this._centerAltitude))},An=tn=>{if(tn.zoom<tt)return!0;if(tn.zoom===nn)return!1;if(null!=tn.shouldSplit)return tn.shouldSplit;const $t=tn.aabb.distanceX(Ne),on=tn.aabb.distanceY(Ne);let wn=xn,On=1;if(O){wn=qt(tn.aabb.distanceZ(Ne));const ti=Math.pow(2,tn.zoom),Xn=a.latFromMercatorY((tn.y+1)/ti),di=a.latFromMercatorY(tn.y/ti),Ji=Math.min(Math.max(w,Xn),di),gi=a.circumferenceAtLatitude(Ji)/a.circumferenceAtLatitude(w);if(On=Ji===w?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,gi/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&tn.zoom===nn-1&&gi>=.9)return!0}else if(u&&(wn=qt(tn.aabb.distanceZ(Ne)*be)),this.projection.isReprojectedInTileSpace&&y<=5){const ti=Math.pow(2,tn.zoom),Xn=ft(new a.MercatorCoordinate((tn.x+.5)/ti,(tn.y+.5)/ti));On=Xn>.85?1:Xn}const ri=$t*$t+on*on+wn;return ri<qt((1<<nn-tn.zoom)*ve*On*((ti,Xn)=>{if(Xn*qt(.707)<ti)return 1;const di=Math.sqrt(Xn/ti);return di/(1.4144271570014144+(Math.pow(1.1,di-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(wn,xn),ri))};if(this.renderWorldCopies)for(let tn=1;tn<=3;tn++)Zt.push(At(-tn)),Zt.push(At(tn));for(Zt.push(At(0));Zt.length>0;){const tn=Zt.pop(),$t=tn.x,on=tn.y;let wn=tn.fullyVisible;if(!wn){const On=tn.aabb.intersects(Q);if(0===On)continue;wn=2===On}if(tn.zoom!==nn&&An(tn))for(let On=0;On<4;On++){const ri=($t<<1)+On%2,zi=(on<<1)+(On>>1),ti={aabb:p?tn.aabb.quadrant(On):a.tileAABB(this,E,tn.zoom+1,ri,zi,tn.wrap,tn.minZ,tn.maxZ,this.projection),zoom:tn.zoom+1,x:ri,y:zi,wrap:tn.wrap,fullyVisible:wn,tileID:void 0,shouldSplit:void 0,minZ:tn.minZ,maxZ:tn.maxZ};u&&!O&&(ti.tileID=new a.OverscaledTileID(tn.zoom+1===nn?Bn:tn.zoom+1,tn.wrap,tn.zoom+1,ri,zi),cn(ti)),Zt.push(ti)}else{const On=tn.zoom===nn?Bn:tn.zoom;if(i.minzoom&&i.minzoom>On)continue;const ri=P[0]-(.5+$t+(tn.wrap<<tn.zoom))*(1<<c-tn.zoom),zi=P[1]-.5-on,ti=tn.tileID?tn.tileID:new a.OverscaledTileID(On,tn.wrap,tn.zoom,$t,on);Kt.push({tileID:ti,distanceSq:ri*ri+zi*zi})}}if(this.fogCullDistSq){const tn=this.fogCullDistSq,$t=this.horizonLineFromTop();Kt=Kt.filter(on=>{const wn=[0,0,0,1],On=[a.EXTENT,a.EXTENT,0,1],ri=this.calculateFogTileMatrix(on.tileID.toUnwrapped());a.transformMat4$1(wn,wn,ri),a.transformMat4$1(On,On,ri);const zi=a.getAABBPointSquareDist(wn,On);if(0===zi)return!0;let ti=!1;const Xn=this._elevation;if(Xn&&zi>tn&&0!==$t){const di=this.calculateProjMatrix(on.tileID.toUnwrapped());let Ji;i.isTerrainDEM||(Ji=Xn.getMinMaxForTile(on.tileID)),Ji||(Ji={min:nt,max:qe});const gi=a.furthestTileCorner(this.rotation),Tr=[gi[0]*a.EXTENT,gi[1]*a.EXTENT,Ji.max];a.transformMat4(Tr,Tr,di),ti=(1-Tr[1])*this.height*.5<$t}return zi<tn||ti})}return Kt.sort((tn,$t)=>tn.distanceSq-$t.distanceSq).map(tn=>tn.tileID)}resize(i,c){this.width=i,this.height=c,this.pixelsToGLUnits=[2/i,-2/c],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(i){return Math.pow(2,i)}scaleZoom(i){return Math.log(i)/Math.LN2}project(i){const c=a.clamp(i.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),y=this.projection.project(i.lng,c);return new a.pointGeometry(y.x*this.worldSize,y.y*this.worldSize)}unproject(i){return this.projection.unproject(i.x/this.worldSize,i.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(i,c){let y,u;const p=this.centerPoint;if("globe"===this.projection.name){const w=this.worldSize;y=(c.x-p.x)/w,u=(c.y-p.y)/w}else{const w=this.pointCoordinate(c),E=this.pointCoordinate(p);y=w.x-E.x,u=w.y-E.y}const f=this.locationCoordinate(i);this.setLocation(new a.MercatorCoordinate(f.x-y,f.y-u))}setLocation(i){this.center=this.coordinateLocation(i),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(i){return this.projection.locationPoint(this,i)}locationPoint3D(i){return this.projection.locationPoint(this,i,!0)}pointLocation(i){return this.coordinateLocation(this.pointCoordinate(i))}pointLocation3D(i){return this.coordinateLocation(this.pointCoordinate3D(i))}locationCoordinate(i,c){const y=c?a.mercatorZfromAltitude(c,i.lat):void 0,u=this.projection.project(i.lng,i.lat);return new a.MercatorCoordinate(u.x,u.y,y)}coordinateLocation(i){return this.projection.unproject(i.x,i.y)}pointRayIntersection(i,c){const y=c??this._centerAltitude,u=[i.x,i.y,0,1],p=[i.x,i.y,1,1];a.transformMat4$1(u,u,this.pixelMatrixInverse),a.transformMat4$1(p,p,this.pixelMatrixInverse);const f=p[3];a.scale$1(u,u,1/u[3]),a.scale$1(p,p,1/f);const w=u[2],E=p[2];return{p0:u,p1:p,t:w===E?0:(y-w)/(E-w)}}screenPointToMercatorRay(i){const c=[i.x,i.y,0,1],y=[i.x,i.y,1,1];return a.transformMat4$1(c,c,this.pixelMatrixInverse),a.transformMat4$1(y,y,this.pixelMatrixInverse),a.scale$1(c,c,1/c[3]),a.scale$1(y,y,1/y[3]),c[2]=a.mercatorZfromAltitude(c[2],this._center.lat)*this.worldSize,y[2]=a.mercatorZfromAltitude(y[2],this._center.lat)*this.worldSize,a.scale$1(c,c,1/this.worldSize),a.scale$1(y,y,1/this.worldSize),new a.Ray([c[0],c[1],c[2]],a.normalize([],a.sub([],y,c)))}rayIntersectionCoordinate(i){const{p0:c,p1:y,t:u}=i,p=a.mercatorZfromAltitude(c[2],this._center.lat),f=a.mercatorZfromAltitude(y[2],this._center.lat);return new a.MercatorCoordinate(a.number(c[0],y[0],u)/this.worldSize,a.number(c[1],y[1],u)/this.worldSize,a.number(p,f,u))}pointCoordinate(i,c=this._centerAltitude){return this.projection.pointCoordinate(this,i.x,i.y,c)}pointCoordinate3D(i){if(!this.elevation)return this.pointCoordinate(i);let c=this.projection.pointCoordinate3D(this,i.x,i.y);if(c)return new a.MercatorCoordinate(c[0],c[1],c[2]);let y=0,u=this.horizonLineFromTop();if(i.y>u)return this.pointCoordinate(i);const p=.02*u,f=i.clone();for(let w=0;w<10&&u-y>p;w++){f.y=a.number(y,u,.66);const E=this.projection.pointCoordinate3D(this,f.x,f.y);E?(u=f.y,c=E):y=f.y}return c?new a.MercatorCoordinate(c[0],c[1],c[2]):this.pointCoordinate(i)}isPointAboveHorizon(i){return this.projection.isPointAboveHorizon(this,i)}_coordinatePoint(i,c){const y=c&&this.elevation?this.elevation.getAtPointOrZero(i,this._centerAltitude):this._centerAltitude,u=[i.x*this.worldSize,i.y*this.worldSize,y+i.toAltitude(),1];return a.transformMat4$1(u,u,this.pixelMatrix),u[3]>0?new a.pointGeometry(u[0]/u[3],u[1]/u[3]):new a.pointGeometry(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:i,left:c}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,u=this.width-this._edgeInsets.right,p=this.pointLocation3D(new a.pointGeometry(c,i)),f=this.pointLocation3D(new a.pointGeometry(u,i)),w=this.pointLocation3D(new a.pointGeometry(u,y)),E=this.pointLocation3D(new a.pointGeometry(c,y));let P=Math.min(p.lng,f.lng,w.lng,E.lng),O=Math.max(p.lng,f.lng,w.lng,E.lng),V=Math.min(p.lat,f.lat,w.lat,E.lat),Q=Math.max(p.lat,f.lat,w.lat,E.lat);const ye=Math.pow(2,-this.zoom)/16*270,be="globe"===this.projection.name?1:4,Oe=(Ne,ve,tt,qe,nt)=>{const Tt=(Ne+tt)/2,ft=(ve+qe)/2,At=new a.pointGeometry(Tt,ft),{lng:Zt,lat:Kt}=this.pointLocation3D(At),nn=Math.max(0,P-Zt,V-Kt,Zt-O,Kt-Q);P=Math.min(P,Zt),O=Math.max(O,Zt),V=Math.min(V,Kt),Q=Math.max(Q,Kt),(nt<be||nn>ye)&&(Oe(Ne,ve,Tt,ft,nt+1),Oe(Tt,ft,tt,qe,nt+1))};if(Oe(c,i,u,i,1),Oe(u,i,u,y,1),Oe(u,y,c,y,1),Oe(c,y,c,i,1),"globe"===this.projection.name){const[Ne,ve]=a.polesInViewport(this);Ne?(Q=90,O=180,P=-180):ve&&(V=-90,O=180,P=-180)}return new a.LngLatBounds(new a.LngLat(P,V),new a.LngLat(O,Q))}_getBoundsRectangular(i,c){const{top:y,left:u}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,f=this.width-this._edgeInsets.right,w=new a.pointGeometry(u,y),E=new a.pointGeometry(f,y),P=new a.pointGeometry(f,p),O=new a.pointGeometry(u,p);let V=this.pointCoordinate(w,i),Q=this.pointCoordinate(E,i);const ye=this.pointCoordinate(P,c),be=this.pointCoordinate(O,c),Oe=(Ne,ve)=>(ve.y-Ne.y)/(ve.x-Ne.x);return V.y>1&&Q.y>=0?V=new a.MercatorCoordinate((1-be.y)/Oe(be,V)+be.x,1):V.y<0&&Q.y<=1&&(V=new a.MercatorCoordinate(-be.y/Oe(be,V)+be.x,0)),Q.y>1&&V.y>=0?Q=new a.MercatorCoordinate((1-ye.y)/Oe(ye,Q)+ye.x,1):Q.y<0&&V.y<=1&&(Q=new a.MercatorCoordinate(-ye.y/Oe(ye,Q)+ye.x,0)),(new a.LngLatBounds).extend(this.coordinateLocation(V)).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(be)).extend(this.coordinateLocation(ye))}_getBoundsRectangularTerrain(){const i=this.elevation;if(!i.visibleDemTiles.length||i.isUsingMockSource())return this._getBoundsRectangular(0,0);const c=i.visibleDemTiles.reduce((y,u)=>{if(u.dem){const p=u.dem.tree;y.min=Math.min(y.min,p.minimums[0]),y.max=Math.max(y.max,p.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(c.min*i.exaggeration(),c.max*i.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(i=!0){const c=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,y=this.height/2-c*(1-this._horizonShift);return i?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(i){this.maxBounds=i,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,i&&(this.minLat=i.getSouth(),this.maxLat=i.getNorth(),this.minLng=i.getWest(),this.maxLng=i.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(i,c){return this.projection.createTileMatrix(this,c,i)}calculateDistanceTileData(i){const c=i.key,y=this._distanceTileDataCache;if(y[c])return y[c];const u=i.canonical,p=1/this.height,f=this.cameraWorldSize,w=f/this.zoomScale(u.z),E=(u.x+Math.pow(2,u.z)*i.wrap)*w,P=u.y*w,O=this.point;O.x*=f/this.worldSize,O.y*=f/this.worldSize;const V=this.angle,Q=Math.sin(-V),ye=-Math.cos(-V);return y[c]={bearing:[Q,ye],center:[(O.x-E)*p,(O.y-P)*p],scale:w/a.EXTENT*p},y[c]}calculateFogTileMatrix(i){const c=i.key,y=this._fogTileMatrixCache;if(y[c])return y[c];const u=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,i);return a.multiply(u,this.worldToFogMatrix,u),y[c]=new Float32Array(u),y[c]}calculateProjMatrix(i,c=!1){const y=i.key,u=c?this._alignedProjMatrixCache:this._projMatrixCache;if(u[y])return u[y];const p=this.calculatePosMatrix(i,this.worldSize);return a.multiply(p,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:c?this.alignedProjMatrix:this.projMatrix,p),u[y]=new Float32Array(p),u[y]}calculatePixelsToTileUnitsMatrix(i){const c=i.tileID.key,y=this._pixelsToTileUnitsCache;if(y[c])return y[c];const u=function(p,f){const{scale:w}=p.tileTransform,E=w*a.EXTENT/(p.tileSize*Math.pow(2,f.zoom-p.tileID.overscaledZ+p.tileID.canonical.z));return P=new Float32Array(4),Q=(O=f.inverseAdjustmentMatrix)[1],ye=O[2],be=O[3],Ne=(V=[E,E])[1],P[0]=O[0]*(Oe=V[0]),P[1]=Q*Oe,P[2]=ye*Ne,P[3]=be*Ne,P;var P,O,V,Q,ye,be,Oe,Ne}(i,this);return y[c]=u,y[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const i=1/this.worldSize,c=a.fromScaling([],[i,i,i]);return a.multiply(c,c,this.globeMatrix),c}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const i=this._elevation;this._updateCameraState();const c=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(c),u=this._camera.forward(),p=a.mercatorZfromAltitude(1,this._center.lat);y[2]/=p,u[2]/=p,a.normalize(u,u);const f=i.raycast(y,u,i.exaggeration());if(f){const w=a.scaleAndAdd([],y,u,f),E=new a.MercatorCoordinate(w[0],w[1],a.mercatorZfromAltitude(w[2],a.latFromMercatorY(w[1]))),P=(E.z+a.length([E.x-y[0],E.y-y[1],E.z-y[2]*p]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(P),this._centerAltitude=E.toAltitude(),this._center=this.coordinateLocation(E),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(i=!1){if(!this._elevation)return;const c=this._elevation,y=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,u=this._computeCameraPosition(y),p=c.getAtPointOrZero(new a.MercatorCoordinate(...u)),f=this.pixelsPerMeter/this.worldSize*p,w=this._minimumHeightOverTerrain(),E=u[2]-f;if(E<=w)if(E<0||i){const P=this.locationCoordinate(this._center,this._centerAltitude),O=[u[0],u[1],P.z-u[2]],V=a.length(O);O[2]-=(w-E)/this._pixelsPerMercatorPixel;const Q=a.length(O);if(0===Q)return;a.scale$2(O,O,V/Q*this._pixelsPerMercatorPixel),this._camera.position=[u[0],u[1],P.z*this._pixelsPerMercatorPixel-O[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const i="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||i){const Q=this.center;return Q.lat=a.clamp(Q.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!i)&&(Q.lng=a.clamp(Q.lng,this.minLng,this.maxLng)),this.center=Q,void(this._constraining=!1)}const c=this._unmodified,{x:y,y:u}=this.point;let p=0,f=y,w=u;const E=this.width/2,P=this.height/2,O=this.worldMinY*this.scale,V=this.worldMaxY*this.scale;if(u-P<O&&(w=O+P),u+P>V&&(w=V-P),V-O<this.height&&(p=Math.max(p,this.height/(V-O)),w=(V+O)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Q=this.worldMinX*this.scale,ye=this.worldMaxX*this.scale,be=this.worldSize/2-(Q+ye)/2;f=(y+be+this.worldSize)%this.worldSize-be,f-E<Q&&(f=Q+E),f+E>ye&&(f=ye-E),ye-Q<this.width&&(p=Math.max(p,this.width/(ye-Q)),f=(ye+Q)/2)}f===y&&w===u||(this.center=this.unproject(new a.pointGeometry(f,w))),p&&(this.zoom+=this.scaleZoom(p)),this._constrainCamera(),this._unmodified=c,this._constraining=!1}_minZoomForBounds(){let i=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(i=Math.max(i,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),i}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const i=this.centerOffset,c=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const y=or(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,y),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const u="meters"===this.projection.zAxisUnit?c:1,p=this._camera.getWorldToCamera(this.worldSize,u),f=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);f[8]=2*-i.x/this.width,f[9]=2*i.y/this.height;let w=a.mul([],f,p);if(this.projection.isReprojectedInTileSpace){const ft=this.locationCoordinate(this.center),At=a.identity([]);a.translate(At,At,[ft.x*this.worldSize,ft.y*this.worldSize,0]),a.multiply(At,At,Hi(this)),a.translate(At,At,[-ft.x*this.worldSize,-ft.y*this.worldSize,0]),a.multiply(w,w,At),this.inverseAdjustmentMatrix=function(Zt){const Kt=Hi(Zt,!0);return ge([],[Kt[0],Kt[1],Kt[4],Kt[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],w,[this.worldSize,this.worldSize,this.worldSize/u,1]),this.projMatrix=w,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const E=a.invert([],f);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(E,this.horizonLineFromTop(),this.height);const P=new Float32Array(16);a.identity(P),a.scale(P,P,[1,-1,1]),a.rotateX(P,P,this._pitch),a.rotateZ(P,P,this.angle);const O=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),V=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;O[8]=2*-i.x/this.width,O[9]=2*(i.y+V)/this.height,this.skyboxMatrix=a.multiply(P,O,P);const Q=this.point,ye=Q.x,be=Q.y,Oe=this.width%2/2,Ne=this.height%2/2,ve=Math.cos(this.angle),tt=Math.sin(this.angle),qe=ye-Math.round(ye)+ve*Oe+tt*Ne,nt=be-Math.round(be)+ve*Ne+tt*Oe,Tt=new Float64Array(w);if(a.translate(Tt,Tt,[qe>.5?qe-1:qe,nt>.5?nt-1:nt,0]),this.alignedProjMatrix=Tt,w=a.create(),a.scale(w,w,[this.width/2,-this.height/2,1]),a.translate(w,w,[1,-1,0]),this.labelPlaneMatrix=w,w=a.create(),a.scale(w,w,[1,-1,1]),a.translate(w,w,[-1,-1,0]),a.scale(w,w,[2/this.width,2/this.height,1]),this.glCoordMatrix=w,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},w=a.invert(new Float64Array(16),this.pixelMatrix),!w)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=w,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const ft=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(ft,ft,p),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=w;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const i=this.cameraWorldSizeForFog,c=this.cameraPixelsPerMeter,y=this._camera.position,u=1/this.height/this._pixelsPerMercatorPixel,p=[i,i,c];a.scale$2(p,p,u),a.scale$2(y,y,-1),a.multiply$2(y,y,p);const f=a.create();a.translate(f,f,y),a.scale(f,f,p),this.mercatorFogMatrix=f,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(i,c,u)}_computeCameraPosition(i){const c=(i=i||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),u=this.point,p=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*c-i/this.worldSize*this._centerAltitude;return[u.x/this.worldSize-y[0]*p,u.y/this.worldSize-y[1]*p,i/this.worldSize*this._centerAltitude-y[2]*p]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(i){const c=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],u=i[2];let p=1;this.projection.wrap&&(this.center=this.center.wrap()),u>0&&(p=Math.min((c-y)/u,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,i,p),this._updateStateFromCamera()}_updateStateFromCamera(){const i=this._camera.position,c=this._camera.forward(),{pitch:y,bearing:u}=this._camera.getPitchBearing(),p=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,f=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),w=Math.max((i[2]-p)/Math.cos(y),f),E=this._zoomFromMercatorZ(w);a.scaleAndAdd(i,i,c,w),this._pitch=a.clamp(y,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(u,-Math.PI,Math.PI),this._setZoom(a.clamp(E,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(i[0],i[1],i[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(i){return Math.pow(2,i)*this.tileSize}_mercatorZfromZoom(i){return this.cameraToCenterDistance/this._worldSizeFromZoom(i)}_minimumHeightOverTerrain(){const i=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(i)}_zoomFromMercatorZ(i){return this.scaleZoom(this.cameraToCenterDistance/(i*this.tileSize))}zoomFromMercatorZAdjusted(i){let c=0,y=a.GLOBE_ZOOM_THRESHOLD_MAX,u=0,p=1/0;for(;y-c>1e-6&&y>c;){const f=c+.5*(y-c),w=this.tileSize*Math.pow(2,f),E=this.getCameraToCenterDistance(this.projection,f,w),P=this.scaleZoom(E/(i*this.tileSize)),O=Math.abs(f-P);O<p&&(p=O,u=f),f<P?c=f:y=f}return u}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(i,c){const y=Math.min(i.x,c.x),u=Math.max(i.x,c.x),p=Math.min(i.y,c.y),f=Math.max(i.y,c.y);if(p<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const w=[new a.pointGeometry(y,p),new a.pointGeometry(u,f),new a.pointGeometry(y,f),new a.pointGeometry(u,p)],E=this.renderWorldCopies?-3:0,P=this.renderWorldCopies?4:1;for(const O of w){const V=this.pointRayIntersection(O);if(V.t<0)return!0;const Q=this.rayIntersectionCoordinate(V);if(Q.x<E||Q.y<0||Q.x>P||Q.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.pointGeometry(0,0),new a.pointGeometry(this.width,this.height))}zoomDeltaToMovement(i,c){const y=a.length(a.sub([],this._camera.position,i)),u=this._zoomFromMercatorZ(y)+c;return y-this._mercatorZfromZoom(u)}getCameraPoint(){if("globe"===this.projection.name){const i=function([c,y,u],p){const f=[c,y,u,1];a.transformMat4$1(f,f,p);const w=f[3]=Math.max(f[3],1e-6);return f[0]/=w,f[1]/=w,f[2]/=w,f}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.pointGeometry(i[0],i[1])}{const i=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.pointGeometry(0,i))}}getCameraToCenterDistance(i,c=this.zoom,y=this.worldSize){const u=or(i,c,this.width,this.height,1024),p=i.pixelSpaceConversion(this.center.lat,y,u);return.5/Math.tan(.5*this._fov)*this.height*p}getWorldToCameraMatrix(){const i=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&a.multiply(i,i,this.globeMatrix),i}}function vo(m,i){let c=!1,y=null;const u=()=>{y=null,c&&(m(),y=setTimeout(u,i),c=!1)};return()=>(c=!0,y||u(),y)}class qs{constructor(i){this._hashName=i&&encodeURIComponent(i),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=vo(this._updateHashUnthrottled.bind(this),300)}addTo(i){return this._map=i,a.window.addEventListener("hashchange",this._onHashChange,!1),i.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const i=this._map;if(!i)return"";const c=_a(i);if(this._hashName){const y=this._hashName;let u=!1;const p=a.window.location.hash.slice(1).split("&").map(f=>{const w=f.split("=")[0];return w===y?(u=!0,`${w}=${c}`):f}).filter(f=>f);return u||p.push(`${y}=${c}`),`#${p.join("&")}`}return`#${c}`}_getCurrentHash(){const i=a.window.location.hash.replace("#","");if(this._hashName){let c;return i.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(c=y)}),(c&&c[1]||"").split("/")}return i.split("/")}_onHashChange(){const i=this._map;if(!i)return!1;const c=this._getCurrentHash();if(c.length>=3&&!c.some(y=>isNaN(y))){const y=i.dragRotate.isEnabled()&&i.touchZoomRotate.isEnabled()?+(c[3]||0):i.getBearing();return i.jumpTo({center:[+c[2],+c[1]],zoom:+c[0],bearing:y,pitch:+(c[4]||0)}),!0}return!1}_updateHashUnthrottled(){const i=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,i)}}function _a(m,i){const c=m.getCenter(),y=Math.round(100*m.getZoom())/100,u=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),p=Math.pow(10,u),f=Math.round(c.lng*p)/p,w=Math.round(c.lat*p)/p,E=m.getBearing(),P=m.getPitch();let O=i?`/${f}/${w}/${y}`:`${y}/${w}/${f}`;return(E||P)&&(O+="/"+Math.round(10*E)/10),P&&(O+=`/${Math.round(P)}`),O}const Ho={linearity:.3,easing:a.bezier(0,0,.3,1)},Ys=a.extend({deceleration:2500,maxSpeed:1400},Ho),Wa=a.extend({deceleration:20,maxSpeed:1400},Ho),Ls=a.extend({deceleration:1e3,maxSpeed:360},Ho),Ec=a.extend({deceleration:1e3,maxSpeed:90},Ho);class Dl{constructor(i){this._map=i,this.clear()}clear(){this._inertiaBuffer=[]}record(i){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:i})}_drainInertiaBuffer(){const i=this._inertiaBuffer,c=a.exported.now();for(;i.length>0&&c-i[0].time>160;)i.shift()}_onMoveEnd(i){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const c={zoom:0,bearing:0,pitch:0,pan:new a.pointGeometry(0,0),pinchAround:void 0,around:void 0};for(const{settings:p}of this._inertiaBuffer)c.zoom+=p.zoomDelta||0,c.bearing+=p.bearingDelta||0,c.pitch+=p.pitchDelta||0,p.panDelta&&c.pan._add(p.panDelta),p.around&&(c.around=p.around),p.pinchAround&&(c.pinchAround=p.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,u={};if(c.pan.mag()){const p=al(c.pan.mag(),y,a.extend({},Ys,i||{}));u.offset=c.pan.mult(p.amount/c.pan.mag()),u.center=this._map.transform.center,Fs(u,p)}if(c.zoom){const p=al(c.zoom,y,Wa);u.zoom=this._map.transform.zoom+p.amount,Fs(u,p)}if(c.bearing){const p=al(c.bearing,y,Ls);u.bearing=this._map.transform.bearing+a.clamp(p.amount,-179,179),Fs(u,p)}if(c.pitch){const p=al(c.pitch,y,Ec);u.pitch=this._map.transform.pitch+p.amount,Fs(u,p)}if(u.zoom||u.bearing){const p=void 0===c.pinchAround?c.around:c.pinchAround;u.around=p?this._map.unproject(p):this._map.getCenter()}return this.clear(),u.noMoveStart=!0,u}}function Fs(m,i){(!m.duration||m.duration<i.duration)&&(m.duration=i.duration,m.easing=i.easing)}function al(m,i,c){const{maxSpeed:y,linearity:u,deceleration:p}=c,f=a.clamp(m*u/(i/1e3),-y,y),w=Math.abs(f)/(p*u);return{easing:c.easing,duration:1e3*w,amount:f*(w/2)}}class uo extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,y,u={}){const p=ne(c.getCanvasContainer(),y),f=c.unproject(p);super(i,a.extend({point:p,lngLat:f,originalEvent:y},u)),this._defaultPrevented=!1,this.target=c}}class ll extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,y){const u="touchend"===i?y.changedTouches:y.touches,p=Je(c.getCanvasContainer(),u),f=p.map(E=>c.unproject(E)),w=p.reduce((E,P,O,V)=>E.add(P.div(V.length)),new a.pointGeometry(0,0));super(i,{points:p,point:w,lngLats:f,lngLat:c.unproject(w),originalEvent:y}),this._defaultPrevented=!1}}class cl extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(i,c,y){super(i,{originalEvent:y}),this._defaultPrevented=!1}}class Dc{constructor(i,c){this._map=i,this._clickTolerance=c.clickTolerance}reset(){this._mousedownPos=void 0}wheel(i){return this._firePreventable(new cl(i.type,this._map,i))}mousedown(i,c){return this._mousedownPos=c,this._firePreventable(new uo(i.type,this._map,i))}mouseup(i){this._map.fire(new uo(i.type,this._map,i))}preclick(i){const c=a.extend({},i);c.type="preclick",this._map.fire(new uo(c.type,this._map,c))}click(i,c){this._mousedownPos&&this._mousedownPos.dist(c)>=this._clickTolerance||(this.preclick(i),this._map.fire(new uo(i.type,this._map,i)))}dblclick(i){return this._firePreventable(new uo(i.type,this._map,i))}mouseover(i){this._map.fire(new uo(i.type,this._map,i))}mouseout(i){this._map.fire(new uo(i.type,this._map,i))}touchstart(i){return this._firePreventable(new ll(i.type,this._map,i))}touchmove(i){this._map.fire(new ll(i.type,this._map,i))}touchend(i){this._map.fire(new ll(i.type,this._map,i))}touchcancel(i){this._map.fire(new ll(i.type,this._map,i))}_firePreventable(i){if(this._map.fire(i),i.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Il{constructor(i){this._map=i}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(i){this._map.fire(new uo(i.type,this._map,i))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new uo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(i){this._delayContextMenu?this._contextMenuEvent=i:this._map.fire(new uo(i.type,this._map,i)),this._map.listens("contextmenu")&&i.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Xl{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._container=i.getContainer(),this._clickTolerance=c.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(i,c){this.isEnabled()&&i.shiftKey&&0===i.button&&(ze(),this._startPos=this._lastPos=c,this._active=!0)}mousemoveWindow(i,c){if(!this._active)return;const y=c,u=this._startPos,p=this._lastPos;if(!u||!p||p.equals(y)||!this._box&&y.dist(u)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=Ie("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",i));const f=Math.min(u.x,y.x),w=Math.max(u.x,y.x),E=Math.min(u.y,y.y),P=Math.max(u.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${f}px,${E}px)`,this._box.style.width=w-f+"px",this._box.style.height=P-E+"px")})}mouseupWindow(i,c){if(!this._active)return;const y=this._startPos,u=c;if(y&&0===i.button){if(this.reset(),Pe(),y.x!==u.x||y.y!==u.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:i})),{cameraAnimation:p=>p.fitScreenCoordinates(y,u,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",i)}}keydown(i){this._active&&27===i.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",i))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ce(),delete this._startPos,delete this._lastPos}_fireEvent(i,c){return this._map.fire(new a.Event(i,{originalEvent:c}))}}function Ic(m,i){const c={};for(let y=0;y<m.length;y++)c[m[y].identifier]=i[y];return c}class Js{constructor(i){this.reset(),this.numTouches=i.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(i,c,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=i.timeStamp),y.length===this.numTouches&&(this.centroid=function(u){const p=new a.pointGeometry(0,0);for(const f of u)p._add(f);return p.div(u.length)}(c),this.touches=Ic(y,c)))}touchmove(i,c,y){if(this.aborted||!this.centroid)return;const u=Ic(y,c);for(const p in this.touches){const w=u[p];(!w||w.dist(this.touches[p])>30)&&(this.aborted=!0)}}touchend(i,c,y){if((!this.centroid||i.timeStamp-this.startTime>500)&&(this.aborted=!0),0===y.length){const u=!this.aborted&&this.centroid;if(this.reset(),u)return u}}}class Ml{constructor(i){this.singleTap=new Js(i),this.numTaps=i.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(i,c,y){this.singleTap.touchstart(i,c,y)}touchmove(i,c,y){this.singleTap.touchmove(i,c,y)}touchend(i,c,y){const u=this.singleTap.touchend(i,c,y);if(u){const p=i.timeStamp-this.lastTime<500,f=!this.lastTap||this.lastTap.dist(u)<30;if(p&&f||this.reset(),this.count++,this.lastTime=i.timeStamp,this.lastTap=u,this.count===this.numTaps)return this.reset(),u}}}class Sl{constructor(){this._zoomIn=new Ml({numTouches:1,numTaps:2}),this._zoomOut=new Ml({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(i,c,y){this._zoomIn.touchstart(i,c,y),this._zoomOut.touchstart(i,c,y)}touchmove(i,c,y){this._zoomIn.touchmove(i,c,y),this._zoomOut.touchmove(i,c,y)}touchend(i,c,y){const u=this._zoomIn.touchend(i,c,y),p=this._zoomOut.touchend(i,c,y);return u?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:f=>f.easeTo({duration:300,zoom:f.getZoom()+1,around:f.unproject(u)},{originalEvent:i})}):p?(this._active=!0,i.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:f=>f.easeTo({duration:300,zoom:f.getZoom()-1,around:f.unproject(p)},{originalEvent:i})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Mc={0:1,2:2};class qa{constructor(i){this.reset(),this._clickTolerance=i.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(i,c){return!1}_move(i,c){return{}}mousedown(i,c){if(this._lastPoint)return;const y=Pt(i);this._correctButton(i,y)&&(this._lastPoint=c,this._eventButton=y)}mousemoveWindow(i,c){const y=this._lastPoint;if(y)if(i.preventDefault(),null!=this._eventButton&&function(u,p){const f=Mc[p];return void 0===u.buttons||(u.buttons&f)!==f}(i,this._eventButton))this.reset();else if(this._moved||!(c.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=c,this._move(y,c)}mouseupWindow(i){this._lastPoint&&Pt(i)===this._eventButton&&(this._moved&&Pe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Sc extends qa{mousedown(i,c){super.mousedown(i,c),this._lastPoint&&(this._active=!0)}_correctButton(i,c){return 0===c&&!i.ctrlKey}_move(i,c){return{around:c,panDelta:c.sub(i)}}}class Kl extends qa{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const y=.8*(c.x-i.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(i){i.preventDefault()}}class Ql extends qa{_correctButton(i,c){return 0===c&&i.ctrlKey||2===c}_move(i,c){const y=-.5*(c.y-i.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(i){i.preventDefault()}}class ul{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._minTouches=1,this._clickTolerance=c.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.pointGeometry(0,0)}touchstart(i,c,y){return this._calculateTransform(i,c,y)}touchmove(i,c,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===y.length&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return i.cancelable&&i.preventDefault(),this._calculateTransform(i,c,y)}}touchend(i,c,y){this._calculateTransform(i,c,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(i,c,y){y.length>0&&(this._active=!0);const u=Ic(y,c),p=new a.pointGeometry(0,0),f=new a.pointGeometry(0,0);let w=0;for(const P in u){const O=u[P],V=this._touches[P];V&&(p._add(O),f._add(O.sub(V)),w++,u[P]=O)}if(this._touches=u,w<this._minTouches||!f.mag())return;const E=f.div(w);return this._sum._add(E),this._sum.mag()<this._clickTolerance?void 0:{around:p.div(w),panDelta:E}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ie("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class ec{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(i){}_move(i,c,y){return{}}touchstart(i,c,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([c[0],c[1]]))}touchmove(i,c,y){const u=this._firstTwoTouches;if(!u)return;i.preventDefault();const[p,f]=u,w=Al(y,c,p),E=Al(y,c,f);if(!w||!E)return;const P=this._aroundCenter?null:w.add(E).div(2);return this._move([w,E],P,i)}touchend(i,c,y){if(!this._firstTwoTouches)return;const[u,p]=this._firstTwoTouches,f=Al(y,c,u),w=Al(y,c,p);f&&w||(this._active&&Pe(),this.reset())}touchcancel(){this.reset()}enable(i){this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Al(m,i,c){for(let y=0;y<m.length;y++)if(m[y].identifier===c)return i[y]}function tu(m,i){return Math.log(m/i)/Math.LN2}class ns extends ec{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(i){this._startDistance=this._distance=i[0].dist(i[1])}_move(i,c){const y=this._distance;if(this._distance=i[0].dist(i[1]),this._active||!(Math.abs(tu(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:tu(this._distance,y),pinchAround:c}}}function Pl(m,i){return 180*m.angleWith(i)/Math.PI}class ta extends ec{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(i){this._startVector=this._vector=i[0].sub(i[1]),this._minDiameter=i[0].dist(i[1])}_move(i,c){const y=this._vector;if(this._vector=i[0].sub(i[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Pl(this._vector,y),pinchAround:c}}_isBelowThreshold(i){this._minDiameter=Math.min(this._minDiameter,i.mag());const c=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const u=Pl(i,y);return Math.abs(u)<c}}function Ac(m){return Math.abs(m.y)>Math.abs(m.x)}class ko extends ec{constructor(i){super(),this._map=i}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(i){this._lastPoints=i,Ac(i[0].sub(i[1]))&&(this._valid=!1)}_move(i,c,y){const u=this._lastPoints;if(!u)return;const p=i[0].sub(u[0]),f=i[1].sub(u[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(p,f,y.timeStamp),!this._valid)?void 0:(this._lastPoints=i,this._active=!0,{pitchDelta:(p.y+f.y)/2*-.5})}gestureBeginsVertically(i,c,y){if(void 0!==this._valid)return this._valid;const u=i.mag()>=2,p=c.mag()>=2;if(!u&&!p)return;if(!u||!p)return null==this._firstMove&&(this._firstMove=y),y-this._firstMove<100&&void 0;const f=i.y>0==c.y>0;return Ac(i)&&Ac(c)&&f}}const nu={panStep:100,bearingStep:15,pitchStep:10};class Ol{constructor(){const i=nu;this._panStep=i.panStep,this._bearingStep=i.bearingStep,this._pitchStep=i.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(i){if(i.altKey||i.ctrlKey||i.metaKey)return;let c=0,y=0,u=0,p=0,f=0;switch(i.keyCode){case 61:case 107:case 171:case 187:c=1;break;case 189:case 109:case 173:c=-1;break;case 37:i.shiftKey?y=-1:(i.preventDefault(),p=-1);break;case 39:i.shiftKey?y=1:(i.preventDefault(),p=1);break;case 38:i.shiftKey?u=1:(i.preventDefault(),f=-1);break;case 40:i.shiftKey?u=-1:(i.preventDefault(),f=1);break;default:return}return this._rotationDisabled&&(y=0,u=0),{cameraAnimation:w=>{const E=w.getZoom();w.easeTo({duration:300,easeId:"keyboardHandler",easing:oh,zoom:c?Math.round(E)+c*(i.shiftKey?2:1):E,bearing:w.getBearing()+y*this._bearingStep,pitch:w.getPitch()+u*this._pitchStep,offset:[-p*this._panStep,-f*this._panStep],center:w.getCenter()},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function oh(m){return m*(2-m)}const iu=4.000244140625;class ks{constructor(i,c){this._map=i,this._el=i.getCanvasContainer(),this._handler=c,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(i){this._defaultZoomRate=i}setWheelZoomRate(i){this._wheelZoomRate=i}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(i){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!i&&"center"===i.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(i){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(i.ctrlKey||i.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let c=i.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*i.deltaY:i.deltaY;const y=a.exported.now(),u=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,0!==c&&c%iu==0?this._type="wheel":0!==c&&Math.abs(c)<4?this._type="trackpad":u>400?(this._type=null,this._lastValue=c,this._timeout=setTimeout(this._onTimeout,40,i)):this._type||(this._type=Math.abs(u*c)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,c+=this._lastValue)),i.shiftKey&&c&&(c/=4),this._type&&(this._lastWheelEvent=i,this._delta-=c,this._active||this._start(i)),i.preventDefault()}_onTimeout(i){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(i)}_start(i){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const c=ne(this._el,i);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:c,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const i=this._map.transform;"wheel"===this._type&&i.projection.wrap&&(i._center.lng>=180||i._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const c=()=>i._terrainEnabled()&&this._aroundCoord?i.computeZoomRelativeTo(this._aroundCoord):i.zoom;if(0!==this._delta){const E="wheel"===this._type&&Math.abs(this._delta)>iu?this._wheelZoomRate:this._defaultZoomRate;let P=2/(1+Math.exp(-Math.abs(this._delta*E)));this._delta<0&&0!==P&&(P=1/P);const O=c(),V=Math.pow(2,O),Q="number"==typeof this._targetZoom?i.zoomScale(this._targetZoom):V;this._targetZoom=Math.min(i.maxZoom,Math.max(i.minZoom,i.scaleZoom(Q*P))),"wheel"===this._type&&(this._startZoom=O,this._easing=this._smoothOutEasing(200)),this._delta=0}const y="number"==typeof this._targetZoom?this._targetZoom:c(),u=this._startZoom,p=this._easing;let f,w=!1;if("wheel"===this._type&&u&&p){const E=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),P=p(E);f=a.number(u,y,P),E<1?this._frameId||(this._frameId=!0):w=!0}else f=y,w=!0;return this._active=!0,w&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!w,zoomDelta:f-c(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(i){let c=a.ease;if(this._prevEase){const y=this._prevEase,u=(a.exported.now()-y.start)/y.duration,p=y.easing(u+.01)-y.easing(u),f=.27/Math.sqrt(p*p+1e-4)*.01,w=Math.sqrt(.0729-f*f);c=a.bezier(f,w,.25,1)}return this._prevEase={start:a.exported.now(),duration:i,easing:c},c}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=Ie("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class ru{constructor(i,c){this._clickZoom=i,this._tapZoom=c}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Eo{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(i,c){return i.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(i.shiftKey?-1:1),around:y.unproject(c)},{originalEvent:i})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Xs{constructor(){this._tap=new Ml({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(i,c,y){this._swipePoint||(this._tapTime&&i.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=c[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(i,c,y))}touchmove(i,c,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const u=c[0],p=u.y-this._swipePoint.y;return this._swipePoint=u,i.preventDefault(),this._active=!0,{zoomDelta:p/128}}}else this._tap.touchmove(i,c,y)}touchend(i,c,y){this._tapTime?this._swipePoint&&0===y.length&&this.reset():this._tap.touchend(i,c,y)&&(this._tapTime=i.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class xs{constructor(i,c,y){this._el=i,this._mousePan=c,this._touchPan=y}enable(i){this._inertiaOptions=i||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Kn{constructor(i,c,y){this._pitchWithRotate=i.pitchWithRotate,this._mouseRotate=c,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class Ya{constructor(i,c,y,u){this._el=i,this._touchZoom=c,this._touchRotate=y,this._tapDragZoom=u,this._rotationDisabled=!1,this._enabled=!0}enable(i){this._touchZoom.enable(i),this._rotationDisabled||this._touchRotate.enable(i),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Bs=m=>m.zoom||m.drag||m.pitch||m.rotate;class Oa extends a.Event{}class ya{constructor(){this.constants=[1,1,.01],this.radius=0}setup(i,c){const y=a.sub([],c,i);this.radius=a.length(y[2]<0?a.div([],y,this.constants):[y[0],y[1],0])}projectRay(i){a.div(i,i,this.constants),a.normalize(i,i),a.mul$1(i,i,this.constants);const c=a.scale$2([],i,this.radius);if(c[2]>0){const y=a.scale$2([],[0,0,1],a.dot(c,[0,0,1])),u=a.scale$2([],a.normalize([],[c[0],c[1],0]),this.radius),p=a.add([],c,a.scale$2([],a.sub([],a.add([],u,y),c),2));c[0]=p[0],c[1]=p[1]}return c}}function ou(m){return m.panDelta&&m.panDelta.mag()||m.zoomDelta||m.bearingDelta||m.pitchDelta}class ud{constructor(i,c){this._map=i,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Dl(i),this._bearingSnap=c.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new ya,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(c),a.bindAll(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[u,p,f]of this._listeners)u.addEventListener(p,u===a.window.document?this.handleWindowEvent:this.handleEvent,f)}destroy(){for(const[i,c,y]of this._listeners)i.removeEventListener(c,i===a.window.document?this.handleWindowEvent:this.handleEvent,y)}_addDefaultHandlers(i){const c=this._map,y=c.getCanvasContainer();this._add("mapEvent",new Dc(c,i));const u=c.boxZoom=new Xl(c,i);this._add("boxZoom",u);const p=new Sl,f=new Eo;c.doubleClickZoom=new ru(f,p),this._add("tapZoom",p),this._add("clickZoom",f);const w=new Xs;this._add("tapDragZoom",w);const E=c.touchPitch=new ko(c);this._add("touchPitch",E);const P=new Kl(i),O=new Ql(i);c.dragRotate=new Kn(i,P,O),this._add("mouseRotate",P,["mousePitch"]),this._add("mousePitch",O,["mouseRotate"]);const V=new Sc(i),Q=new ul(c,i);c.dragPan=new xs(y,V,Q),this._add("mousePan",V),this._add("touchPan",Q,["touchZoom","touchRotate"]);const ye=new ta,be=new ns;c.touchZoomRotate=new Ya(y,be,ye,w),this._add("touchRotate",ye,["touchPan","touchZoom"]),this._add("touchZoom",be,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Il(c));const Oe=c.scrollZoom=new ks(c,this);this._add("scrollZoom",Oe,["mousePan"]);const Ne=c.keyboard=new Ol;this._add("keyboard",Ne);for(const ve of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])i.interactive&&i[ve]&&c[ve].enable(i[ve])}_add(i,c,y){this._handlers.push({handlerName:i,handler:c,allowed:y}),this._handlersById[i]=c}stop(i){if(!this._updatingCamera){for(const{handler:c}of this._handlers)c.reset();this._inertia.clear(),this._fireEvents({},{},i),this._changes=[]}}isActive(){for(const{handler:i}of this._handlers)if(i.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Bs(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(i,c,y){for(const u in i)if(u!==y&&(!c||c.indexOf(u)<0))return!0;return!1}handleWindowEvent(i){this.handleEvent(i,`${i.type}Window`)}_getMapTouches(i){const c=[];for(const y of i)this._el.contains(y.target)&&c.push(y);return c}handleEvent(i,c){this._updatingCamera=!0;const y="renderFrame"===i.type,u=y?void 0:i,p={needsRenderFrame:!1},f={},w={},E=i.touches?this._getMapTouches(i.touches):void 0,P=E?Je(this._el,E):y?void 0:ne(this._el,i);for(const{handlerName:Q,handler:ye,allowed:be}of this._handlers){if(!ye.isEnabled())continue;let Oe;this._blockedByActive(w,be,Q)?ye.reset():ye[c||i.type]&&(Oe=ye[c||i.type](i,P,E),this.mergeHandlerResult(p,f,Oe,Q,u),Oe&&Oe.needsRenderFrame&&this._triggerRenderFrame()),(Oe||ye.isActive())&&(w[Q]=ye)}const O={};for(const Q in this._previousActiveHandlers)w[Q]||(O[Q]=u);this._previousActiveHandlers=w,(Object.keys(O).length||ou(p))&&(this._changes.push([p,f,O]),this._triggerRenderFrame()),(Object.keys(w).length||ou(p))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:V}=p;V&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],V(this._map))}mergeHandlerResult(i,c,y,u,p){if(!y)return;a.extend(i,y);const f={handlerName:u,originalEvent:y.originalEvent||p};void 0!==y.zoomDelta&&(c.zoom=f),void 0!==y.panDelta&&(c.drag=f),void 0!==y.pitchDelta&&(c.pitch=f),void 0!==y.bearingDelta&&(c.rotate=f)}_applyChanges(){const i={},c={},y={};for(const[u,p,f]of this._changes)u.panDelta&&(i.panDelta=(i.panDelta||new a.pointGeometry(0,0))._add(u.panDelta)),u.zoomDelta&&(i.zoomDelta=(i.zoomDelta||0)+u.zoomDelta),u.bearingDelta&&(i.bearingDelta=(i.bearingDelta||0)+u.bearingDelta),u.pitchDelta&&(i.pitchDelta=(i.pitchDelta||0)+u.pitchDelta),void 0!==u.around&&(i.around=u.around),void 0!==u.aroundCoord&&(i.aroundCoord=u.aroundCoord),void 0!==u.pinchAround&&(i.pinchAround=u.pinchAround),u.noInertia&&(i.noInertia=u.noInertia),a.extend(c,p),a.extend(y,f);this._updateMapTransform(i,c,y),this._changes=[]}_updateMapTransform(i,c,y){const u=this._map,p=u.transform,f=tt=>[tt.x,tt.y,tt.z];if((tt=>{const qe=this._eventsInProgress.drag;return qe&&!this._handlersById[qe.handlerName].isActive()})()&&!ou(i)){const tt=p.zoom;p.cameraElevationReference="sea",p.recenterOnTerrain(),p.cameraElevationReference="ground",tt!==p.zoom&&this._map._update(!0)}if(p._isCameraConstrained&&u._stop(!0),!ou(i))return void this._fireEvents(c,y,!0);let{panDelta:w,zoomDelta:E,bearingDelta:P,pitchDelta:O,around:V,aroundCoord:Q,pinchAround:ye}=i;p._isCameraConstrained&&(E>0&&(E=0),p._isCameraConstrained=!1),void 0!==ye&&(V=ye),(E||(tt=>c.drag&&!this._eventsInProgress.drag)())&&V&&(this._dragOrigin=f(p.pointCoordinate3D(V)),this._trackingEllipsoid.setup(p._camera.position,this._dragOrigin)),p.cameraElevationReference="sea",u._stop(!0),V=V||u.transform.centerPoint,P&&(p.bearing+=P),O&&(p.pitch+=O),p._updateCameraState();const be=[0,0,0];if(w)if("mercator"===p.projection.name){const tt=this._trackingEllipsoid.projectRay(p.screenPointToMercatorRay(V).dir),qe=this._trackingEllipsoid.projectRay(p.screenPointToMercatorRay(V.sub(w)).dir);be[0]=qe[0]-tt[0],be[1]=qe[1]-tt[1]}else{const tt=p.pointCoordinate(V);if("globe"===p.projection.name){w=w.rotate(-p.angle);const qe=p._pixelsPerMercatorPixel/p.worldSize;be[0]=-w.x*a.mercatorScale(a.latFromMercatorY(tt.y))*qe,be[1]=-w.y*a.mercatorScale(p.center.lat)*qe}else{const qe=p.pointCoordinate(V.sub(w));tt&&qe&&(be[0]=qe.x-tt.x,be[1]=qe.y-tt.y)}}const Oe=p.zoom,Ne=[0,0,0];if(E){const tt=f(Q||p.pointCoordinate3D(V)),qe={dir:a.normalize([],a.sub([],tt,p._camera.position))};if(qe.dir[2]<0){const nt=p.zoomDeltaToMovement(tt,E);a.scale$2(Ne,qe.dir,nt)}}const ve=a.add(be,be,Ne);p._translateCameraConstrained(ve),E&&Math.abs(p.zoom-Oe)>1e-4&&p.recenterOnTerrain(),p.cameraElevationReference="ground",this._map._update(),i.noInertia||this._inertia.record(i),this._fireEvents(c,y,!0)}_fireEvents(i,c,y){const u=Bs(this._eventsInProgress),p=Bs(i),f={};for(const O in i){const{originalEvent:V}=i[O];this._eventsInProgress[O]||(f[`${O}start`]=V),this._eventsInProgress[O]=i[O]}!u&&p&&this._fireEvent("movestart",p.originalEvent);for(const O in f)this._fireEvent(O,f[O]);p&&this._fireEvent("move",p.originalEvent);for(const O in i){const{originalEvent:V}=i[O];this._fireEvent(O,V)}const w={};let E;for(const O in this._eventsInProgress){const{handlerName:V,originalEvent:Q}=this._eventsInProgress[O];this._handlersById[V].isActive()||(delete this._eventsInProgress[O],E=c[V]||Q,w[`${O}end`]=E)}for(const O in w)this._fireEvent(O,w[O]);const P=Bs(this._eventsInProgress);if(y&&(u||p)&&!P){this._updatingCamera=!0;const O=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),V=Q=>0!==Q&&-this._bearingSnap<Q&&Q<this._bearingSnap;O?(V(O.bearing||this._map.getBearing())&&(O.bearing=0),this._map.easeTo(O,{originalEvent:E})):(this._map.fire(new a.Event("moveend",{originalEvent:E})),V(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(i,c){this._map.fire(new a.Event(i,c?{originalEvent:c}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(i=>{this._frameId=void 0,this.handleEvent(new Oa("renderFrame",{timeStamp:i})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Pr="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Ru extends a.Evented{constructor(i,c){super(),this._moving=!1,this._zooming=!1,this.transform=i,this._bearingSnap=c.bearingSnap,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(i,c){return this.jumpTo({center:i},c)}panBy(i,c,y){return i=a.pointGeometry.convert(i).mult(-1),this.panTo(this.transform.center,a.extend({offset:i},c),y)}panTo(i,c,y){return this.easeTo(a.extend({center:i},c),y)}getZoom(){return this.transform.zoom}setZoom(i,c){return this.jumpTo({zoom:i},c),this}zoomTo(i,c,y){return this.easeTo(a.extend({zoom:i},c),y)}zoomIn(i,c){return this.zoomTo(this.getZoom()+1,i,c),this}zoomOut(i,c){return this.zoomTo(this.getZoom()-1,i,c),this}getBearing(){return this.transform.bearing}setBearing(i,c){return this.jumpTo({bearing:i},c),this}getPadding(){return this.transform.padding}setPadding(i,c){return this.jumpTo({padding:i},c),this}rotateTo(i,c,y){return this.easeTo(a.extend({bearing:i},c),y)}resetNorth(i,c){return this.rotateTo(0,a.extend({duration:1e3},i),c),this}resetNorthPitch(i,c){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},i),c),this}snapToNorth(i,c){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(i,c):this}getPitch(){return this.transform.pitch}setPitch(i,c){return this.jumpTo({pitch:i},c),this}cameraForBounds(i,c){i=a.LngLatBounds.convert(i);const y=c&&c.bearing||0,u=c&&c.pitch||0,p=i.getNorthWest(),f=i.getSouthEast();return this._cameraForBounds(this.transform,p,f,y,u,c)}_extendCameraOptions(i){const c={top:0,bottom:0,right:0,left:0};if("number"==typeof(i=a.extend({padding:c,offset:[0,0],maxZoom:this.transform.maxZoom},i)).padding){const y=i.padding;i.padding={top:y,bottom:y,right:y,left:y}}return i.padding=a.extend(c,i.padding),i}_minimumAABBFrustumDistance(i,c){const y=c.max[0]-c.min[0],u=c.max[1]-c.min[1];return y/u>i.aspect?y/(2*Math.tan(.5*i.fovX)*i.aspect):u/(2*Math.tan(.5*i.fovY)*i.aspect)}_cameraForBoundsOnGlobe(i,c,y,u,p,f){const w=i.clone(),E=this._extendCameraOptions(f);w.bearing=u,w.pitch=p;const P=a.LngLat.convert(c),O=a.LngLat.convert(y),V=.5*(P.lat+O.lat),Q=.5*(P.lng+O.lng),ye=a.latLngToECEF(V,Q),be=a.normalize([],ye),Oe=a.normalize([],a.cross([],be,[0,1,0])),Ne=a.cross([],Oe,be),ve=[Oe[0],Oe[1],Oe[2],0,Ne[0],Ne[1],Ne[2],0,be[0],be[1],be[2],0,0,0,0,1],tt=[ye,a.latLngToECEF(P.lat,P.lng),a.latLngToECEF(O.lat,P.lng),a.latLngToECEF(O.lat,O.lng),a.latLngToECEF(P.lat,O.lng),a.latLngToECEF(V,P.lng),a.latLngToECEF(V,O.lng),a.latLngToECEF(P.lat,Q),a.latLngToECEF(O.lat,Q)];let qe=a.Aabb.fromPoints(tt.map(wn=>[a.dot(Oe,wn),a.dot(Ne,wn),a.dot(be,wn)]));const nt=a.transformMat4([],qe.center,ve);0===a.squaredLength(nt)&&a.set(nt,0,0,1),a.normalize(nt,nt),a.scale$2(nt,nt,a.GLOBE_RADIUS),w.center=a.ecefToLatLng(nt);const Tt=w.getWorldToCameraMatrix(),ft=a.invert(new Float64Array(16),Tt);qe=a.Aabb.applyTransform(qe,a.multiply([],Tt,ve)),a.transformMat4(nt,nt,Tt);const At=.5*(qe.max[2]-qe.min[2]),Zt=this._minimumAABBFrustumDistance(w,qe),Kt=a.scale$2([],[0,0,1],At),nn=a.add(Kt,nt,Kt),Bn=Zt+(0===w.pitch?0:a.distance(nt,nn)),qt=w.globeCenterInViewSpace,xn=a.sub([],nt,[qt[0],qt[1],qt[2]]);a.normalize(xn,xn),a.scale$2(xn,xn,Bn);const cn=a.add([],nt,xn);a.transformMat4(cn,cn,ft);const An=a.earthRadius/a.GLOBE_RADIUS,tn=a.length(cn),$t=a.mercatorZfromAltitude(Math.max(tn*An-a.earthRadius,Number.EPSILON),0),on=Math.min(w.zoomFromMercatorZAdjusted($t),E.maxZoom);return on>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(w.setProjection({name:"mercator"}),w.zoom=on,this._cameraForBounds(w,c,y,u,p,f)):{center:w.center,zoom:on,bearing:u,pitch:p}}queryTerrainElevation(i,c){const y=this.transform.elevation;return y?(c=a.extend({},{exaggerated:!0},c),y.getAtPoint(a.MercatorCoordinate.fromLngLat(i),null,c.exaggerated)):null}_cameraForBounds(i,c,y,u,p,f){if("globe"===i.projection.name)return this._cameraForBoundsOnGlobe(i,c,y,u,p,f);const w=i.clone(),E=this._extendCameraOptions(f),P=w.padding;w.bearing=u,w.pitch=p;const O=a.LngLat.convert(c),V=a.LngLat.convert(y),Q=new a.LngLat(O.lng,V.lat),ye=new a.LngLat(V.lng,O.lat),be=w.project(O),Oe=w.project(V),Ne=this.queryTerrainElevation(O),ve=this.queryTerrainElevation(V),tt=this.queryTerrainElevation(Q),qe=this.queryTerrainElevation(ye),nt=[[be.x,be.y,Math.min(Ne||0,ve||0,tt||0,qe||0)],[Oe.x,Oe.y,Math.max(Ne||0,ve||0,tt||0,qe||0)]];let Tt=a.Aabb.fromPoints(nt);const ft=w.getWorldToCameraMatrix(),At=a.invert(new Float64Array(16),ft);Tt=a.Aabb.applyTransform(Tt,ft);const Zt=a.sub([],Tt.max,Tt.min),Kt=P.left||0,nn=P.right||0,Bn=P.bottom||0,qt=P.top||0,{left:xn,right:cn,top:An,bottom:tn}=E.padding,$t=.5*(Kt+nn),on=.5*(qt+Bn),wn=Math.min(w.scaleZoom(w.scale*Math.min((w.width-(Kt+nn+xn+cn))/Zt[0],(w.height-(Bn+qt+tn+An))/Zt[1])),E.maxZoom),On=w.scale/w.zoomScale(wn);Tt=new a.Aabb([Tt.min[0]-(xn+$t)*On,Tt.min[1]-(tn+on)*On,Tt.min[2]],[Tt.max[0]+(cn+$t)*On,Tt.max[1]+(An+on)*On,Tt.max[2]]);const ri=.5*Zt[2],zi=this._minimumAABBFrustumDistance(w,Tt),ti=[0,0,1,0];a.transformMat4$1(ti,ti,ft),a.normalize$2(ti,ti);const Xn=a.scale$2([],ti,zi+ri),di=a.add([],Tt.center,Xn),Ji=("number"==typeof E.offset.x&&"number"==typeof E.offset.y?new a.pointGeometry(E.offset.x,E.offset.y):a.pointGeometry.convert(E.offset)).rotate(-a.degToRad(u));Tt.center[0]-=Ji.x*On,Tt.center[1]+=Ji.y*On,a.transformMat4(Tt.center,Tt.center,At),a.transformMat4(di,di,At);const gi=[Tt.center[0],Tt.center[1],di[2]*w.pixelsPerMeter];a.scale$2(gi,gi,1/w.worldSize);const Tr=a.lngFromMercatorX(gi[0]),Or=a.latFromMercatorY(gi[1]),Rr=Math.min(w._zoomFromMercatorZ(gi[2]),E.maxZoom),Vr=new a.LngLat(Tr,Or);return w.mercatorFromTransition&&Rr<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(w.setProjection({name:"globe"}),w.zoom=Rr,this._cameraForBounds(w,c,y,u,p,f)):{center:Vr,zoom:Rr,bearing:u,pitch:p}}fitBounds(i,c,y){const u=this.cameraForBounds(i,c);return this._fitInternal(u,c,y)}fitScreenCoordinates(i,c,y,u,p){const f=a.pointGeometry.convert(i),w=a.pointGeometry.convert(c),E=new a.pointGeometry(Math.min(f.x,w.x),Math.min(f.y,w.y)),P=new a.pointGeometry(Math.max(f.x,w.x),Math.max(f.y,w.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(f,w))return this;const O=this.transform.pointLocation3D(E),V=this.transform.pointLocation3D(P),Q=this.transform.pointLocation3D(new a.pointGeometry(E.x,P.y)),ye=this.transform.pointLocation3D(new a.pointGeometry(P.x,E.y)),be=[Math.min(O.lng,V.lng,Q.lng,ye.lng),Math.min(O.lat,V.lat,Q.lat,ye.lat)],Oe=[Math.max(O.lng,V.lng,Q.lng,ye.lng),Math.max(O.lat,V.lat,Q.lat,ye.lat)],Ne=u&&u.pitch?u.pitch:this.getPitch(),ve=this._cameraForBounds(this.transform,be,Oe,y,Ne,u);return this._fitInternal(ve,u,p)}_fitInternal(i,c,y){return i?(delete(c=a.extend(i,c)).padding,c.linear?this.easeTo(c,y):this.flyTo(c,y)):this}jumpTo(i,c){this.stop();const y=i.preloadOnly?this.transform.clone():this.transform;let u=!1,p=!1,f=!1;return"zoom"in i&&y.zoom!==+i.zoom&&(u=!0,y.zoom=+i.zoom),void 0!==i.center&&(y.center=a.LngLat.convert(i.center)),"bearing"in i&&y.bearing!==+i.bearing&&(p=!0,y.bearing=+i.bearing),"pitch"in i&&y.pitch!==+i.pitch&&(f=!0,y.pitch=+i.pitch),null==i.padding||y.isPaddingEqual(i.padding)||(y.padding=i.padding),i.preloadOnly?(this._preloadTiles(y),this):(this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),u&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),p&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),f&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Pr),this.transform.getFreeCameraOptions()}setFreeCameraOptions(i,c){const y=this.transform;if(!y.projection.supportsFreeCamera)return a.warnOnce(Pr),this;this.stop();const u=y.zoom,p=y.pitch,f=y.bearing;y.setFreeCameraOptions(i);const w=u!==y.zoom,E=p!==y.pitch,P=f!==y.bearing;return this.fire(new a.Event("movestart",c)).fire(new a.Event("move",c)),w&&this.fire(new a.Event("zoomstart",c)).fire(new a.Event("zoom",c)).fire(new a.Event("zoomend",c)),P&&this.fire(new a.Event("rotatestart",c)).fire(new a.Event("rotate",c)).fire(new a.Event("rotateend",c)),E&&this.fire(new a.Event("pitchstart",c)).fire(new a.Event("pitch",c)).fire(new a.Event("pitchend",c)),this.fire(new a.Event("moveend",c)),this}easeTo(i,c){this._stop(!1,i.easeId),(!1===(i=a.extend({offset:[0,0],duration:500,easing:a.ease},i)).animate||!i.essential&&a.exported.prefersReducedMotion)&&(i.duration=0);const y=this.transform,u=this.getZoom(),p=this.getBearing(),f=this.getPitch(),w=this.getPadding(),E="zoom"in i?+i.zoom:u,P="bearing"in i?this._normalizeBearing(i.bearing,p):p,O="pitch"in i?+i.pitch:f,V="padding"in i?i.padding:y.padding,Q=a.pointGeometry.convert(i.offset);let ye,be,Oe;if("globe"===y.projection.name){const Kt=a.MercatorCoordinate.fromLngLat(y.center),nn=Q.rotate(-y.angle);Kt.x+=nn.x/y.worldSize,Kt.y+=nn.y/y.worldSize;const Bn=Kt.toLngLat(),qt=a.LngLat.convert(i.center||Bn);this._normalizeCenter(qt),ye=y.centerPoint.add(nn),be=new a.pointGeometry(Kt.x,Kt.y).mult(y.worldSize),Oe=new a.pointGeometry(a.mercatorXfromLng(qt.lng),a.mercatorYfromLat(qt.lat)).mult(y.worldSize).sub(be)}else{ye=y.centerPoint.add(Q);const Kt=y.pointLocation(ye),nn=a.LngLat.convert(i.center||Kt);this._normalizeCenter(nn),be=y.project(Kt),Oe=y.project(nn).sub(be)}const Ne=y.zoomScale(E-u);let ve,tt;i.around&&(ve=a.LngLat.convert(i.around),tt=y.locationPoint(ve));const qe=this._zooming||E!==u,nt=this._rotating||p!==P,Tt=this._pitching||O!==f,ft=!y.isPaddingEqual(V),At=Kt=>nn=>{if(qe&&(Kt.zoom=a.number(u,E,nn)),nt&&(Kt.bearing=a.number(p,P,nn)),Tt&&(Kt.pitch=a.number(f,O,nn)),ft&&(Kt.interpolatePadding(w,V,nn),ye=Kt.centerPoint.add(Q)),ve)Kt.setLocationAtPoint(ve,tt);else{const Bn=Kt.zoomScale(Kt.zoom-u),qt=E>u?Math.min(2,Ne):Math.max(.5,Ne),xn=Math.pow(qt,1-nn),cn=Kt.unproject(be.add(Oe.mult(nn*xn)).mult(Bn));Kt.setLocationAtPoint(Kt.renderWorldCopies?cn.wrap():cn,ye)}return i.preloadOnly||this._fireMoveEvents(c),Kt};if(i.preloadOnly){const Kt=this._emulate(At,i.duration,y);return this._preloadTiles(Kt),this}const Zt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=qe,this._rotating=nt,this._pitching=Tt,this._padding=ft,this._easeId=i.easeId,this._prepareEase(c,i.noMoveStart,Zt),this._ease(At(y),Kt=>{y.recenterOnTerrain(),this._afterEase(c,Kt)},i),this}_prepareEase(i,c,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",c||y.moving||this.fire(new a.Event("movestart",i)),this._zooming&&!y.zooming&&this.fire(new a.Event("zoomstart",i)),this._rotating&&!y.rotating&&this.fire(new a.Event("rotatestart",i)),this._pitching&&!y.pitching&&this.fire(new a.Event("pitchstart",i))}_fireMoveEvents(i){this.fire(new a.Event("move",i)),this._zooming&&this.fire(new a.Event("zoom",i)),this._rotating&&this.fire(new a.Event("rotate",i)),this._pitching&&this.fire(new a.Event("pitch",i))}_afterEase(i,c){if(this._easeId&&c&&this._easeId===c)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,u=this._rotating,p=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new a.Event("zoomend",i)),u&&this.fire(new a.Event("rotateend",i)),p&&this.fire(new a.Event("pitchend",i)),this.fire(new a.Event("moveend",i))}flyTo(i,c){if(!i.essential&&a.exported.prefersReducedMotion){const wn=a.pick(i,["center","zoom","bearing","pitch","around"]);return this.jumpTo(wn,c)}this.stop(),i=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},i);const y=this.transform,u=this.getZoom(),p=this.getBearing(),f=this.getPitch(),w=this.getPadding(),E="zoom"in i?a.clamp(+i.zoom,y.minZoom,y.maxZoom):u,P="bearing"in i?this._normalizeBearing(i.bearing,p):p,O="pitch"in i?+i.pitch:f,V="padding"in i?i.padding:y.padding,Q=y.zoomScale(E-u),ye=a.pointGeometry.convert(i.offset);let be=y.centerPoint.add(ye);const Oe=y.pointLocation(be),Ne=a.LngLat.convert(i.center||Oe);this._normalizeCenter(Ne);const ve=y.project(Oe),tt=y.project(Ne).sub(ve);let qe=i.curve;const nt=Math.max(y.width,y.height),Tt=nt/Q,ft=tt.mag();if("minZoom"in i){const wn=a.clamp(Math.min(i.minZoom,u,E),y.minZoom,y.maxZoom),On=nt/y.zoomScale(wn-u);qe=Math.sqrt(On/ft*2)}const At=qe*qe;function Zt(wn){const On=(Tt*Tt-nt*nt+(wn?-1:1)*At*At*ft*ft)/(2*(wn?Tt:nt)*At*ft);return Math.log(Math.sqrt(On*On+1)-On)}function Kt(wn){return(Math.exp(wn)-Math.exp(-wn))/2}function nn(wn){return(Math.exp(wn)+Math.exp(-wn))/2}const Bn=Zt(0);let qt=function(wn){return nn(Bn)/nn(Bn+qe*wn)},xn=function(wn){return nt*((nn(Bn)*(Kt(On=Bn+qe*wn)/nn(On))-Kt(Bn))/At)/ft;var On},cn=(Zt(1)-Bn)/qe;if(Math.abs(ft)<1e-6||!isFinite(cn)){if(Math.abs(nt-Tt)<1e-6)return this.easeTo(i,c);const wn=Tt<nt?-1:1;cn=Math.abs(Math.log(Tt/nt))/qe,xn=function(){return 0},qt=function(On){return Math.exp(wn*qe*On)}}i.duration="duration"in i?+i.duration:1e3*cn/("screenSpeed"in i?+i.screenSpeed/qe:+i.speed),i.maxDuration&&i.duration>i.maxDuration&&(i.duration=0);const An=p!==P,tn=O!==f,$t=!y.isPaddingEqual(V),on=wn=>On=>{const ri=On*cn,zi=1/qt(ri);wn.zoom=1===On?E:u+wn.scaleZoom(zi),An&&(wn.bearing=a.number(p,P,On)),tn&&(wn.pitch=a.number(f,O,On)),$t&&(wn.interpolatePadding(w,V,On),be=wn.centerPoint.add(ye));const ti=1===On?Ne:wn.unproject(ve.add(tt.mult(xn(ri))).mult(zi));return wn.setLocationAtPoint(wn.renderWorldCopies?ti.wrap():ti,be),wn._updateCameraOnTerrain(),i.preloadOnly||this._fireMoveEvents(c),wn};if(i.preloadOnly){const wn=this._emulate(on,i.duration,y);return this._preloadTiles(wn),this}return this._zooming=!0,this._rotating=An,this._pitching=tn,this._padding=$t,this._prepareEase(c,!1),this._ease(on(y),()=>this._afterEase(c),i),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(i,c){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,c)}if(!i){const y=this.handlers;y&&y.stop(!1)}return this}_ease(i,c,y){!1===y.animate||0===y.duration?(i(1),c()):(this._easeStart=a.exported.now(),this._easeOptions=y,this._onEaseFrame=i,this._onEaseEnd=c,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const i=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),c=this._onEaseFrame;c&&c(this._easeOptions.easing(i)),i<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(i,c){i=a.wrap(i,-180,180);const y=Math.abs(i-c);return Math.abs(i-360-c)<y&&(i-=360),Math.abs(i+360-c)<y&&(i+=360),i}_normalizeCenter(i){const c=this.transform;if(!c.renderWorldCopies||c.maxBounds)return;const y=i.lng-c.center.lng;i.lng+=y>180?-360:y<-180?360:0}_emulate(i,c,y){const u=Math.ceil(15*c/1e3),p=[],f=i(y.clone());for(let w=0;w<=u;w++){const E=f(w/u);p.push(E.clone())}return p}}class Pc{constructor(i={}){this.options=i,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(i){const c=this.options&&this.options.compact;return this._map=i,this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=Ie("button","mapboxgl-ctrl-attrib-button",this._container),Ie("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=Ie("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),c&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===c&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(i,c){const y=this._map._getUIString(`AttributionControl.${c}`);i.setAttribute("aria-label",y),i.removeAttribute("title"),i.firstElementChild&&i.firstElementChild.setAttribute("title",y)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let i=this._editLink;i||(i=this._editLink=this._container.querySelector(".mapbox-improve-map"));const c=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(i){const y=c.reduce((u,p,f)=>(p.value&&(u+=`${p.key}=${p.value}${f<c.length-1?"&":""}`),u),"?");i.href=`${a.config.FEEDBACK_URL}/${y}#${_a(this._map,!0)}`,i.rel="noopener nofollow",this._setElementTitle(i,"MapFeedback")}}_updateData(i){!i||"metadata"!==i.sourceDataType&&"visibility"!==i.sourceDataType&&"style"!==i.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let i=[];if(this._map.style.stylesheet){const u=this._map.style.stylesheet;this.styleOwner=u.owner,this.styleId=u.id}const c=this._map.style._sourceCaches;for(const u in c){const p=c[u];if(p.used){const f=p.getSource();f.attribution&&i.indexOf(f.attribution)<0&&i.push(f.attribution)}}i.sort((u,p)=>u.length-p.length),i=i.filter((u,p)=>{for(let f=p+1;f<i.length;f++)if(i[f].indexOf(u)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?i=[...this.options.customAttribution,...i]:i.unshift(this.options.customAttribution));const y=i.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,i.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Lu{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(i){this._map=i,this._container=Ie("div","mapboxgl-ctrl");const c=Ie("a","mapboxgl-ctrl-logo");return c.target="_blank",c.rel="noopener nofollow",c.href="https://www.mapbox.com/",c.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),c.setAttribute("rel","noopener nofollow"),this._container.appendChild(c),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(i){i&&"metadata"!==i.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const i=this._map.style._sourceCaches;if(0===Object.entries(i).length)return!0;for(const c in i){const y=i[c].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const i=this._container.children;if(i.length){const c=i[0];this._map.getCanvasContainer().offsetWidth<250?c.classList.add("mapboxgl-compact"):c.classList.remove("mapboxgl-compact")}}}class Oc{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(i){const c=++this._id;return this._queue.push({callback:i,id:c,cancelled:!1}),c}remove(i){const c=this._currentlyRunning,y=c?this._queue.concat(c):this._queue;for(const u of y)if(u.id===i)return void(u.cancelled=!0)}run(i=0){const c=this._currentlyRunning=this._queue;this._queue=[];for(const y of c)if(!y.cancelled&&(y.callback(i),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function su(m,i,c){if(m=new a.LngLat(m.lng,m.lat),i){const y=new a.LngLat(m.lng-360,m.lat),u=new a.LngLat(m.lng+360,m.lat),p=360*Math.ceil(Math.abs(m.lng-c.center.lng)/360),f=c.locationPoint(m).distSqr(i),w=i.x<0||i.y<0||i.x>c.width||i.y>c.height;c.locationPoint(y).distSqr(i)<f&&(w||Math.abs(y.lng-c.center.lng)<p)?m=y:c.locationPoint(u).distSqr(i)<f&&(w||Math.abs(u.lng-c.center.lng)<p)&&(m=u)}for(;Math.abs(m.lng-c.center.lng)>180;){const y=c.locationPoint(m);if(y.x>=0&&y.y>=0&&y.x<=c.width&&y.y<=c.height)break;m.lng>c.center.lng?m.lng-=360:m.lng+=360}return m}const Rl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class au extends a.Evented{constructor(i,c){if(super(),(i instanceof a.window.HTMLElement||c)&&(i=a.extend({element:i},c)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=i&&i.anchor||"center",this._color=i&&i.color||"#3FB1CE",this._scale=i&&i.scale||1,this._draggable=i&&i.draggable||!1,this._clickTolerance=i&&i.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=i&&i.rotation||0,this._rotationAlignment=i&&i.rotationAlignment||"auto",this._pitchAlignment=i&&i.pitchAlignment&&i.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=i&&i.occludedOpacity||.2,i&&i.element)this._element=i.element,this._offset=a.pointGeometry.convert(i&&i.offset||[0,0]);else{this._defaultMarker=!0,this._element=Ie("div");const u=41,p=27,f=Ve("svg",{display:"block",height:u*this._scale+"px",width:p*this._scale+"px",viewBox:`0 0 ${p} ${u}`},this._element),w=Ve("radialGradient",{id:"shadowGradient"},Ve("defs",{},f));Ve("stop",{offset:"10%","stop-opacity":.4},w),Ve("stop",{offset:"100%","stop-opacity":.05},w),Ve("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},f),Ve("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},f),Ve("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},f),Ve("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},f),this._offset=a.pointGeometry.convert(i&&i.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",u=>{u.preventDefault()}),this._element.addEventListener("mousedown",u=>{u.preventDefault()});const y=this._element.classList;for(const u in Rl)y.remove(`mapboxgl-marker-anchor-${u}`);y.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(i){return i===this._map||(this.remove(),this._map=i,i.getCanvasContainer().appendChild(this._element),i.on("move",this._updateMoving),i.on("moveend",this._update),i.on("remove",this._clearFadeTimer),i._addMarker(this),this.setDraggable(this._draggable),this._update(),i.on("click",this._onMapClick)),this}remove(){const i=this._map;return i&&(i.off("click",this._onMapClick),i.off("move",this._updateMoving),i.off("moveend",this._update),i.off("mousedown",this._addDragHandler),i.off("touchstart",this._addDragHandler),i.off("mouseup",this._onUp),i.off("touchend",this._onUp),i.off("mousemove",this._onMove),i.off("touchmove",this._onMove),i.off("remove",this._clearFadeTimer),i._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(i){return this._lngLat=a.LngLat.convert(i),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(i){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),i){if(!("offset"in i.options)){const u=Math.sqrt(Math.pow(13.5,2)/2);i.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[u,-1*(24.6+u)],"bottom-right":[-u,-1*(24.6+u)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=i,i._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(i){const c=i.code,y=i.charCode||i.keyCode;"Space"!==c&&"Enter"!==c&&32!==y&&13!==y||this.togglePopup()}_onMapClick(i){const c=i.originalEvent.target,y=this._element;this._popup&&(c===y||y.contains(c))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const i=this._popup;return i?(i.isOpen()?(i.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(i.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const i=this._map,c=this._pos;if(!i||!c)return!1;const y=i.unproject(c),u=i.getFreeCameraOptions();if(!u.position)return!1;const p=u.position.toLngLat();return p.distanceTo(y)<.9*p.distanceTo(this._lngLat)}_evaluateOpacity(){const i=this._map;if(!i)return;const c=this._pos;if(!c||c.x<0||c.x>i.transform.width||c.y<0||c.y>i.transform.height)return void this._clearFadeTimer();const y=i.unproject(c);let u;i._showingGlobe()&&a.isLngLatBehindGlobe(i.transform,this._lngLat)?u=0:(u=1-i._queryFogOpacity(y),i.transform._terrainEnabled()&&i.getTerrain()&&this._behindTerrain()&&(u*=this._occludedOpacity)),this._element.style.opacity=`${u}`,this._element.style.pointerEvents=u>0?"auto":"none",this._popup&&this._popup._setOpacity(u),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const i=this._pos;if(!i||!this._map)return;const c=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${i.x}px,${i.y}px)\n            ${Rl[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${c.x}px,${c.y}px)\n        `}_calculateXYTransform(){const i=this._pos,c=this._map,y=this.getPitchAlignment();if(!c||!i||"map"!==y)return"";if(!c._showingGlobe()){const E=c.getPitch();return E?`rotateX(${E}deg)`:""}const u=a.radToDeg(a.globeTiltAtLngLat(c.transform,this._lngLat)),p=i.sub(a.globeCenterToScreenPoint(c.transform)),f=Math.abs(p.x)+Math.abs(p.y);if(0===f)return"";const w=u/f;return`rotateX(${-p.y*w}deg) rotateY(${p.x*w}deg)`}_calculateZTransform(){const i=this._pos,c=this._map;if(!c||!i)return"";let y=0;const u=this.getRotationAlignment();if("map"===u)if(c._showingGlobe()){const p=c.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),f=c.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(p);y=a.radToDeg(Math.atan2(f.y,f.x))-90}else y=-c.getBearing();else if("horizon"===u){const p=a.smoothstep(4,6,c.getZoom()),f=a.globeCenterToScreenPoint(c.transform);f.y+=p*c.transform.height;const w=i.sub(f),E=a.radToDeg(Math.atan2(w.y,w.x));y=(E>90?E-270:E+90)*(1-p)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(i){a.window.cancelAnimationFrame(this._updateFrameId);const c=this._map;c&&(c.transform.renderWorldCopies&&(this._lngLat=su(this._lngLat,this._pos,c.transform)),this._pos=c.project(this._lngLat),!0===i?this._updateFrameId=a.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),c._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(c._showingGlobe()||c.getTerrain()||c.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(i){return this._offset=a.pointGeometry.convert(i),this._update(),this}_onMove(i){const c=this._map;if(!c)return;const y=this._pointerdownPos,u=this._positionDelta;if(y&&u){if(!this._isDragging){const p=this._clickTolerance||c._clickTolerance;if(i.point.dist(y)<p)return;this._isDragging=!0}this._pos=i.point.sub(u),this._lngLat=c.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const i=this._map;i&&(i.off("mousemove",this._onMove),i.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(i){const c=this._map,y=this._pos;c&&y&&this._element.contains(i.originalEvent.target)&&(i.preventDefault(),this._positionDelta=i.point.sub(y),this._pointerdownPos=i.point,this._state="pending",c.on("mousemove",this._onMove),c.on("touchmove",this._onMove),c.once("mouseup",this._onUp),c.once("touchend",this._onUp))}setDraggable(i){this._draggable=!!i;const c=this._map;return c&&(i?(c.on("mousedown",this._addDragHandler),c.on("touchstart",this._addDragHandler)):(c.off("mousedown",this._addDragHandler),c.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(i){return this._rotation=i||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(i){return this._rotationAlignment=i||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(i){return this._pitchAlignment=i||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(i){return this._occludedOpacity=i||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const tc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},sh=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function dd(m=new a.pointGeometry(0,0),i="bottom"){if("number"==typeof m){const c=Math.round(Math.sqrt(.5*Math.pow(m,2)));switch(i){case"top":return new a.pointGeometry(0,m);case"top-left":return new a.pointGeometry(c,c);case"top-right":return new a.pointGeometry(-c,c);case"bottom":return new a.pointGeometry(0,-m);case"bottom-left":return new a.pointGeometry(c,-c);case"bottom-right":return new a.pointGeometry(-c,-c);case"left":return new a.pointGeometry(m,0);case"right":return new a.pointGeometry(-m,0)}return new a.pointGeometry(0,0)}return m instanceof a.pointGeometry||Array.isArray(m)?a.pointGeometry.convert(m):a.pointGeometry.convert(m[i]||[0,0])}class eo{constructor(i){this.jumpTo(i)}getValue(i){if(i<=this._startTime)return this._start;if(i>=this._endTime)return this._end;const c=a.easeCubicInOut((i-this._startTime)/(this._endTime-this._startTime));return this._start*(1-c)+this._end*c}isEasing(i){return i>=this._startTime&&i<=this._endTime}jumpTo(i){this._startTime=-1/0,this._endTime=-1/0,this._start=i,this._end=i}easeTo(i,c,y){this._start=this.getValue(c),this._end=i,this._startTime=c,this._endTime=c+y}}const lu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},dl={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,crossSourceCollisions:!0},cu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Ns{constructor(i,c,y=!1){this._clickTolerance=10,this.element=c,this.mouseRotate=new Kl({clickTolerance:i.dragRotate._mouseRotate._clickTolerance}),this.map=i,y&&(this.mousePitch=new Ql({clickTolerance:i.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),c.addEventListener("mousedown",this.mousedown),c.addEventListener("touchstart",this.touchstart,{passive:!1}),c.addEventListener("touchmove",this.touchmove),c.addEventListener("touchend",this.touchend),c.addEventListener("touchcancel",this.reset)}down(i,c){this.mouseRotate.mousedown(i,c),this.mousePitch&&this.mousePitch.mousedown(i,c),ze()}move(i,c){const y=this.map,u=this.mouseRotate.mousemoveWindow(i,c),p=u&&u.bearingDelta;if(p&&y.setBearing(y.getBearing()+p),this.mousePitch){const f=this.mousePitch.mousemoveWindow(i,c),w=f&&f.pitchDelta;w&&y.setPitch(y.getPitch()+w)}}off(){const i=this.element;i.removeEventListener("mousedown",this.mousedown),i.removeEventListener("touchstart",this.touchstart,{passive:!1}),i.removeEventListener("touchmove",this.touchmove),i.removeEventListener("touchend",this.touchend),i.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ce(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(i){this.down(a.extend({},i,{ctrlKey:!0,preventDefault:()=>i.preventDefault()}),ne(this.element,i)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(i){this.move(i,ne(this.element,i))}mouseup(i){this.mouseRotate.mouseupWindow(i),this.mousePitch&&this.mousePitch.mouseupWindow(i),this.offTemp()}touchstart(i){1!==i.targetTouches.length?this.reset():(this._startPos=this._lastPos=Je(this.element,i.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>i.preventDefault()},this._startPos))}touchmove(i){1!==i.targetTouches.length?this.reset():(this._lastPos=Je(this.element,i.targetTouches)[0],this.move({preventDefault:()=>i.preventDefault()},this._lastPos))}touchend(i){0===i.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Ja={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},uu={maxWidth:100,unit:"metric"};function nc(m,i,c){const y=Xa(i),u=y/i,p={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"}[c];this._map._requestDomTask(()=>{this._container.style.width=m*u+"px",this._container.innerHTML=`${y}&nbsp;${p}`})}function Xa(m){const i=Math.pow(10,`${Math.floor(m)}`.length-1);let c=m/i;return c=c>=10?10:c>=5?5:c>=3?3:c>=2?2:c>=1?1:function(y){const u=Math.pow(10,Math.ceil(-Math.log(y)/Math.LN10));return Math.round(y*u)/u}(c),i*c}const ic={version:a.version,supported:oe,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends Ru{constructor(m){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),null!=(m=a.extend({},dl,m)).minZoom&&null!=m.maxZoom&&m.minZoom>m.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=m.minPitch&&null!=m.maxPitch&&m.minPitch>m.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=m.minPitch&&m.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=m.maxPitch&&m.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(m.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(m.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new zn(m.minZoom,m.maxZoom,m.minPitch,m.maxPitch,m.renderWorldCopies),m),this._interactive=m.interactive,this._minTileCacheSize=m.minTileCacheSize,this._maxTileCacheSize=m.maxTileCacheSize,this._failIfMajorPerformanceCaveat=m.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=m.preserveDrawingBuffer,this._antialias=m.antialias,this._useWebGL2=m.useWebGL2,this._trackResize=m.trackResize,this._bearingSnap=m.bearingSnap,this._refreshExpiredTiles=m.refreshExpiredTiles,this._fadeDuration=m.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=m.crossSourceCollisions,this._collectResourceTiming=m.collectResourceTiming,this._optimizeForTerrain=m.optimizeForTerrain,this._language=this._parseLanguage(m.language),this._worldview=m.worldview,this._renderTaskQueue=new Oc,this._domRenderTaskQueue=new Oc,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},lu,m.locale),this._clickTolerance=m.clickTolerance,this._cooperativeGestures=m.cooperativeGestures,this._performanceMetricsCollection=m.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new eo(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(m.transformRequest,m.accessToken,m.testMode),this._silenceAuthErrors=!!m.testMode,"string"==typeof m.container){if(this._container=a.window.document.getElementById(m.container),!this._container)throw new Error(`Container '${m.container}' not found.`)}else{if(!(m.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=m.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),m.maxBounds&&this.setMaxBounds(m.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==a.window&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new ud(this,m),this._localFontFamily=m.localFontFamily,this._localIdeographFontFamily=m.localIdeographFontFamily,m.style&&this.setStyle(m.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),m.projection&&this.setProjection(m.projection),this._hash=m.hash&&new qs("string"==typeof m.hash&&m.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:m.center,zoom:m.zoom,bearing:m.bearing,pitch:m.pitch}),m.bounds&&(this.resize(),this.fitBounds(m.bounds,a.extend({},m.fitBoundsOptions,{duration:0})))),this.resize(),m.attributionControl&&this.addControl(new Pc({customAttribution:m.customAttribution})),this._logoControl=new Lu,this.addControl(this._logoControl,m.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",i=>{this._update("style"===i.dataType),this.fire(new a.Event(`${i.dataType}data`,i))}),this.on("dataloading",i=>{this.fire(new a.Event(`${i.dataType}dataloading`,i))})}_getMapId(){return this._mapId}addControl(m,i){if(void 0===i&&(i=m.getDefaultPosition?m.getDefaultPosition():"top-right"),!m||!m.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const c=m.onAdd(this);this._controls.push(m);const y=this._controlPositions[i];return-1!==i.indexOf("bottom")?y.insertBefore(c,y.firstChild):y.appendChild(c),this}removeControl(m){if(!m||!m.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const i=this._controls.indexOf(m);return i>-1&&this._controls.splice(i,1),m.onRemove(this),this}hasControl(m){return this._controls.indexOf(m)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(m){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const i=!this._moving;return i&&this.fire(new a.Event("movestart",m)).fire(new a.Event("move",m)),this.fire(new a.Event("resize",m)),i&&this.fire(new a.Event("moveend",m)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(m){return this.transform.setMaxBounds(a.LngLatBounds.convert(m)),this._update()}setMinZoom(m){if((m=m??-2)>=-2&&m<=this.transform.maxZoom)return this.transform.minZoom=m,this._update(),this.getZoom()<m?this.setZoom(m):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(m){if((m=m??22)>=this.transform.minZoom)return this.transform.maxZoom=m,this._update(),this.getZoom()>m?this.setZoom(m):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(m){if((m=m??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(m>=0&&m<=this.transform.maxPitch)return this.transform.minPitch=m,this._update(),this.getPitch()<m?this.setPitch(m):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(m){if((m=m??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(m>=this.transform.minPitch)return this.transform.maxPitch=m,this._update(),this.getPitch()>m?this.setPitch(m):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(m){return this.transform.renderWorldCopies=m,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(m){return"auto"===m?a.window.navigator.language:Array.isArray(m)?0===m.length?void 0:m.map(i=>"auto"===i?a.window.navigator.language:i):m}setLanguage(m){const i=this._parseLanguage(m);if(!this.style||i===this._language)return this;this._language=i,this.style._reloadSources();for(const c of this._controls)c._setLanguage&&c._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(m){return this.style&&m!==this._worldview?(this._worldview=m,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(m){return this._lazyInitEmptyStyle(),m?"string"==typeof m&&(m={name:m}):m=null,this._useExplicitProjection=!!m,this._prioritizeAndUpdateProjection(m,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const m=this.transform,i=m.projection.name;let c;"globe"===i&&m.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(m.setMercatorFromTransition(),c=!0):"mercator"===i&&m.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(m.setProjection({name:"globe"}),c=!0),c&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(m,i){return this._updateProjection(m||i||{name:"mercator"})}_updateProjection(m){let i;if(i="globe"===m.name&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(m),this.style.applyProjectionUpdate(),i){this.painter.clearBackgroundTiles();for(const c in this.style._sourceCaches)this.style._sourceCaches[c].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(m){return this.transform.locationPoint3D(a.LngLat.convert(m))}unproject(m){return this.transform.pointLocation3D(a.pointGeometry.convert(m))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(m,i,c){if("mouseenter"===m||"mouseover"===m){let y=!1;const u=f=>{const w=i.filter(P=>this.getLayer(P)),E=w.length?this.queryRenderedFeatures(f.point,{layers:w}):[];E.length?y||(y=!0,c.call(this,new uo(m,this,f.originalEvent,{features:E}))):y=!1},p=()=>{y=!1};return{layers:new Set(i),listener:c,delegates:{mousemove:u,mouseout:p}}}if("mouseleave"===m||"mouseout"===m){let y=!1;const u=f=>{const w=i.filter(E=>this.getLayer(E));(w.length?this.queryRenderedFeatures(f.point,{layers:w}):[]).length?y=!0:y&&(y=!1,c.call(this,new uo(m,this,f.originalEvent)))},p=f=>{y&&(y=!1,c.call(this,new uo(m,this,f.originalEvent)))};return{layers:new Set(i),listener:c,delegates:{mousemove:u,mouseout:p}}}{const y=u=>{const p=i.filter(w=>this.getLayer(w)),f=p.length?this.queryRenderedFeatures(u.point,{layers:p}):[];f.length&&(u.features=f,c.call(this,u),delete u.features)};return{layers:new Set(i),listener:c,delegates:{[m]:y}}}}on(m,i,c){if(void 0===c)return super.on(m,i);Array.isArray(i)||(i=[i]);const y=this._createDelegatedListener(m,i,c);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[m]=this._delegatedListeners[m]||[],this._delegatedListeners[m].push(y);for(const u in y.delegates)this.on(u,y.delegates[u]);return this}once(m,i,c){if(void 0===c)return super.once(m,i);Array.isArray(i)||(i=[i]);const y=this._createDelegatedListener(m,i,c);for(const u in y.delegates)this.once(u,y.delegates[u]);return this}off(m,i,c){if(void 0===c)return super.off(m,i);i=new Set(Array.isArray(i)?i:[i]);const y=(p,f)=>{if(p.size!==f.size)return!1;for(const w of p)if(!f.has(w))return!1;return!0},u=this._delegatedListeners?this._delegatedListeners[m]:void 0;return u&&(p=>{for(let f=0;f<p.length;f++){const w=p[f];if(w.listener===c&&y(w.layers,i)){for(const E in w.delegates)this.off(E,w.delegates[E]);return p.splice(f,1),this}}})(u),this}queryRenderedFeatures(m,i){return this.style?(void 0!==i||void 0===m||m instanceof a.pointGeometry||Array.isArray(m)||(i=m,m=void 0),this.style.queryRenderedFeatures(m=m||[[0,0],[this.transform.width,this.transform.height]],i=i||{},this.transform)):[]}querySourceFeatures(m,i){return this.style.querySourceFeatures(m,i)}setStyle(m,i){return!1!==(i=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},i)).diff&&i.localIdeographFontFamily===this._localIdeographFontFamily&&i.localFontFamily===this._localFontFamily&&this.style&&m?(this._diffStyle(m,i),this):(this._localIdeographFontFamily=i.localIdeographFontFamily,this._localFontFamily=i.localFontFamily,this._updateStyle(m,i))}_getUIString(m){const i=this._locale[m];if(null==i)throw new Error(`Missing UI string '${m}'`);return i}_updateStyle(m,i){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),m&&(this.style=new go(this,i||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof m?this.style.loadURL(m):this.style.loadJSON(m)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new go(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(m,i){if("string"==typeof m){const c=this._requestManager.normalizeStyleURL(m),y=this._requestManager.transformRequest(c,a.ResourceType.Style);a.getJSON(y,(u,p)=>{u?this.fire(new a.ErrorEvent(u)):p&&this._updateDiff(p,i)})}else"object"==typeof m&&this._updateDiff(m,i)}_updateDiff(m,i){try{this.style.setState(m)&&this._update(!0)}catch(c){a.warnOnce(`Unable to perform style diff: ${c.message||c.error||c}.  Rebuilding the style from scratch.`),this._updateStyle(m,i)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(m,i){return this._lazyInitEmptyStyle(),this.style.addSource(m,i),this._update(!0)}isSourceLoaded(m){return!!this.style&&this.style._isSourceCacheLoaded(m)}areTilesLoaded(){const m=this.style&&this.style._sourceCaches;for(const i in m){const c=m[i]._tiles;for(const y in c){const u=c[y];if("loaded"!==u.state&&"errored"!==u.state)return!1}}return!0}addSourceType(m,i,c){this._lazyInitEmptyStyle(),this.style.addSourceType(m,i,c)}removeSource(m){return this.style.removeSource(m),this._updateTerrain(),this._update(!0)}getSource(m){return this.style.getSource(m)}addImage(m,i,{pixelRatio:c=1,sdf:y=!1,stretchX:u,stretchY:p,content:f}={}){if(this._lazyInitEmptyStyle(),i instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&i instanceof a.window.ImageBitmap){const{width:w,height:E,data:P}=a.exported.getImageData(i);this.style.addImage(m,{data:new a.RGBAImage({width:w,height:E},P),pixelRatio:c,stretchX:u,stretchY:p,content:f,sdf:y,version:0})}else if(void 0===i.width||void 0===i.height)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:w,height:E}=i,P=i;this.style.addImage(m,{data:new a.RGBAImage({width:w,height:E},new Uint8Array(P.data)),pixelRatio:c,stretchX:u,stretchY:p,content:f,sdf:y,version:0,userImage:P}),P.onAdd&&P.onAdd(this,m)}}updateImage(m,i){const c=this.style.getImage(m);if(!c)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const y=i instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&i instanceof a.window.ImageBitmap?a.exported.getImageData(i):i,{width:u,height:p}=y;void 0!==u&&void 0!==p?u===c.data.width&&p===c.data.height?(c.data.replace(y.data,!(i instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&i instanceof a.window.ImageBitmap)),this.style.updateImage(m,c)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${u}, ${p})\n                must be that same as the previous version of the image\n                (${c.data.width}, ${c.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(m){return m?!!this.style.getImage(m):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(m){this.style.removeImage(m)}loadImage(m,i){a.getImage(this._requestManager.transformRequest(m,a.ResourceType.Image),(c,y)=>{i(c,y instanceof a.window.HTMLImageElement?a.exported.getImageData(y):y)})}listImages(){return this.style.listImages()}addLayer(m,i){return this._lazyInitEmptyStyle(),this.style.addLayer(m,i),this._update(!0)}moveLayer(m,i){return this.style.moveLayer(m,i),this._update(!0)}removeLayer(m){return this.style.removeLayer(m),this._update(!0)}getLayer(m){return this.style.getLayer(m)}setLayerZoomRange(m,i,c){return this.style.setLayerZoomRange(m,i,c),this._update(!0)}setFilter(m,i,c={}){return this.style.setFilter(m,i,c),this._update(!0)}getFilter(m){return this.style.getFilter(m)}setPaintProperty(m,i,c,y={}){return this.style.setPaintProperty(m,i,c,y),this._update(!0)}getPaintProperty(m,i){return this.style.getPaintProperty(m,i)}setLayoutProperty(m,i,c,y={}){return this.style.setLayoutProperty(m,i,c,y),this._update(!0)}getLayoutProperty(m,i){return this.style.getLayoutProperty(m,i)}setLight(m,i={}){return this._lazyInitEmptyStyle(),this.style.setLight(m,i),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(m){return this._lazyInitEmptyStyle(),!m&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(m),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(m){return this._lazyInitEmptyStyle(),this.style.setFog(m),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(m){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(m),this.transform):0}setFeatureState(m,i){return this.style.setFeatureState(m,i),this._update()}removeFeatureState(m,i){return this.style.removeFeatureState(m,i),this._update()}getFeatureState(m){return this.style.getFeatureState(m)}_updateContainerDimensions(){if(!this._container)return;const m=this._container.getBoundingClientRect().width||400,i=this._container.getBoundingClientRect().height||300;let c,y,u,p=this._container;for(;p&&(!y||!u);){const f=a.window.getComputedStyle(p).transform;f&&"none"!==f&&(c=f.match(/matrix.*\((.+)\)/)[1].split(", "),c[0]&&"0"!==c[0]&&"1"!==c[0]&&(y=c[0]),c[3]&&"0"!==c[3]&&"1"!==c[3]&&(u=c[3])),p=p.parentElement}this._containerWidth=y?Math.abs(m/y):m,this._containerHeight=u?Math.abs(i/u):i}_detectMissingCSS(){"rgb(250, 128, 114)"!==a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const m=this._container;m.classList.add("mapboxgl-map"),(this._missingCSSCanary=Ie("div","mapboxgl-canary",m)).style.visibility="hidden",this._detectMissingCSS();const i=this._canvasContainer=Ie("div","mapboxgl-canvas-container",m);this._interactive&&i.classList.add("mapboxgl-interactive"),this._canvas=Ie("canvas","mapboxgl-canvas",i),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const c=this._controlContainer=Ie("div","mapboxgl-control-container",m),y=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(u=>{y[u]=Ie("div",`mapboxgl-ctrl-${u}`,c)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(m,i){const c=a.exported.devicePixelRatio||1;this._canvas.width=c*Math.ceil(m),this._canvas.height=c*Math.ceil(i),this._canvas.style.width=`${m}px`,this._canvas.style.height=`${i}px`}_addMarker(m){this._markers.push(m)}_removeMarker(m){const i=this._markers.indexOf(m);-1!==i&&this._markers.splice(i,1)}_addPopup(m){this._popups.push(m)}_removePopup(m){const i=this._popups.indexOf(m);-1!==i&&this._popups.splice(i,1)}_setupPainter(){const m=a.extend({},oe.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),i=this._useWebGL2&&this._canvas.getContext("webgl2",m),c=i||this._canvas.getContext("webgl",m)||this._canvas.getContext("experimental-webgl",m);c?(this._useWebGL2&&!i&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(c,!0),this.painter=new le(c,this.transform,!!i),this.on("data",y=>{"source"===y.dataType&&this.painter.setTileLoadedFlag(!0)}),a.exported$1.testSupport(c)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(m){m.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:m}))}_contextRestored(m){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:m}))}_onMapScroll(m){if(m.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(m){return this.style?(this._styleDirty=this._styleDirty||m,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(m){return this._update(),this._renderTaskQueue.add(m)}_cancelRenderFrame(m){this._renderTaskQueue.remove(m)}_requestDomTask(m){!this.loaded()||this.loaded()&&!this.isMoving()?m():this._domRenderTaskQueue.add(m)}_render(m){let i;const c=this.painter.context.extTimerQuery,y=a.exported.now();if(this.listens("gpu-timing-frame")&&(i=c.createQueryEXT(),c.beginQueryEXT(c.TIME_ELAPSED_EXT,i)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(m),this._domRenderTaskQueue.run(m),this._removed)return;this._updateProjectionTransition();const u=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const w=this.transform.zoom,E=this.transform.pitch,P=a.exported.now(),O=new a.EvaluationParameters(w,{now:P,fadeDuration:u,pitch:E,transition:this.style.getTransition()});this.style.update(O)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let p=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),p=this._updateAverageElevation(y),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):p=this._updateAverageElevation(y),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,u,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:u,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),i){const w=a.exported.now()-y;c.endQueryEXT(c.TIME_ELAPSED_EXT,i),setTimeout(()=>{const E=c.getQueryObjectEXT(i,c.QUERY_RESULT_EXT)/1e6;c.deleteQueryEXT(i),this.fire(new a.Event("gpu-timing-frame",{cpuTime:w,gpuTime:E})),a.window.performance.mark("frame-gpu",{startTime:y,detail:{gpuTime:E}})},50)}if(this.listens("gpu-timing-layer")){const w=this.painter.collectGpuTimers();setTimeout(()=>{const E=this.painter.queryGpuTimers(w);this.fire(new a.Event("gpu-timing-layer",{layerTimes:E}))},50)}if(this.listens("gpu-timing-deferred-render")){const w=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const E=this.painter.queryGpuTimeDeferredRender(w);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:E}))},50)}const f=this._sourcesDirty||this._styleDirty||this._placementDirty||p;if(f||this._repaint)this.triggerRepaint();else{const w=!this.isMoving()&&this.loaded();if(w&&(p=this._updateAverageElevation(y,!0)),p)this.triggerRepaint();else if(this._triggerFrame(!1),w&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const E=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:E})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||f||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(m){for(const i of this._markers)m&&!this.getRenderWorldCopies()&&(i._lngLat=i._lngLat.wrap()),i._update();for(const i of this._popups)!m||this.getRenderWorldCopies()||i._trackPointer||(i._lngLat=i._lngLat.wrap()),i._update()}_updateAverageElevation(m,i=!1){const c=y=>(this.transform.averageElevation=y,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&c(0);if((i||m-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(m)){const y=this.transform.averageElevation;let u=this.transform.sampleAverageElevation(),p=!1;this.transform.elevation&&(p=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(u)?u=0:this._averageElevationLastSampledAt=m;const f=Math.abs(y-u);if(f>1){if(this._isInitialLoad||p)return this._averageElevation.jumpTo(u),c(u);this._averageElevation.easeTo(u,m,300)}else if(f>1e-4)return this._averageElevation.jumpTo(u),c(u)}return!!this._averageElevation.isEasing(m)&&c(this._averageElevation.getValue(m))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,m=>{if(m&&(m.message===a.AUTH_ERR_MSG||401===m.status)){const i=this.painter.context.gl;a.storeAuthState(i,!1),this._logoControl instanceof Lu&&this._logoControl._updateLogo(),i&&i.clear(i.DEPTH_BUFFER_BIT|i.COLOR_BUFFER_BIT|i.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const m=this._isDragging();this.painter.updateTerrain(this.style,m)}_calculateSpeedIndex(){const m=this.painter.canvasCopy(),i=this.painter.getCanvasCopiesAndTimestamps();i.timeStamps.push(performance.now());const c=this.painter.context.gl,y=c.createFramebuffer();function u(p){c.framebufferTexture2D(c.FRAMEBUFFER,c.COLOR_ATTACHMENT0,c.TEXTURE_2D,p,0);const f=new Uint8Array(c.drawingBufferWidth*c.drawingBufferHeight*4);return c.readPixels(0,0,c.drawingBufferWidth,c.drawingBufferHeight,c.RGBA,c.UNSIGNED_BYTE,f),f}return c.bindFramebuffer(c.FRAMEBUFFER,y),this._canvasPixelComparison(u(m),i.canvasCopies.map(u),i.timeStamps)}_canvasPixelComparison(m,i,c){let y=c[1]-c[0];const u=m.length/4;for(let p=0;p<i.length;p++){const f=i[p];let w=0;for(let E=0;E<f.length;E+=4)f[E]===m[E]&&f[E+1]===m[E+1]&&f[E+2]===m[E+2]&&f[E+3]===m[E+3]&&(w+=1);y+=(c[p+2]-c[p+1])*(1-w/u)}return y}remove(){this._hash&&this._hash.remove();for(const i of this._controls)i.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==a.window&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const m=this.painter.context.gl.getExtension("WEBGL_lose_context");m&&m.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(m){this._renderNextFrame=this._renderNextFrame||m,this.style&&!this._frame&&(this._frame=a.exported.frame(i=>{const c=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,c&&this._render(i)}))}_preloadTiles(m){const i=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(i,(c,y)=>c._preloadTiles(m,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(m){this._trackResize&&this.resize({originalEvent:m})._update()}_onVisibilityChange(){"hidden"===a.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(m){this._showTileBoundaries!==m&&(this._showTileBoundaries=m,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(m){this._showTerrainWireframe!==m&&(this._showTerrainWireframe=m,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(m){this._speedIndexTiming!==m&&(this._speedIndexTiming=m,this._update())}get showPadding(){return!!this._showPadding}set showPadding(m){this._showPadding!==m&&(this._showPadding=m,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(m){this._showCollisionBoxes!==m&&(this._showCollisionBoxes=m,m?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(m){this._showOverdrawInspector!==m&&(this._showOverdrawInspector=m,this._update())}get repaint(){return!!this._repaint}set repaint(m){this._repaint!==m&&(this._repaint=m,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(m){this._vertices=m,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(m){this._showTileAABBs!==m&&(this._showTileAABBs=m,m&&this._update())}_setCacheLimits(m,i){a.setCacheLimits(m,i)}get version(){return a.version}},NavigationControl:class{constructor(m){this.options=a.extend({},cu,m),this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",i=>i.preventDefault()),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",i=>{this._map&&this._map.zoomIn({},{originalEvent:i})}),Ie("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",i=>{this._map&&this._map.zoomOut({},{originalEvent:i})}),Ie("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",i=>{const c=this._map;c&&(this.options.visualizePitch?c.resetNorthPitch({},{originalEvent:i}):c.resetNorth({},{originalEvent:i}))}),this._compassIcon=Ie("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const m=this._map;if(!m)return;const i=m.getZoom(),c=i===m.getMaxZoom(),y=i===m.getMinZoom();this._zoomInButton.disabled=c,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",c.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const m=this._map;if(!m)return;const i=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(m.transform.pitch*(Math.PI/180)),.5)}) rotateX(${m.transform.pitch}deg) rotateZ(${m.transform.angle*(180/Math.PI)}deg)`:`rotate(${m.transform.angle*(180/Math.PI)}deg)`;m._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=i)})}onAdd(m){return this._map=m,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),m.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&m.on("pitch",this._rotateCompassArrow),m.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Ns(m,this._compass,this.options.visualizePitch)),this._container}onRemove(){const m=this._map;m&&(this._container.remove(),this.options.showZoom&&m.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&m.off("pitch",this._rotateCompassArrow),m.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(m,i){const c=Ie("button",m,this._container);return c.type="button",c.addEventListener("click",i),c}_setButtonTitle(m,i){if(!this._map)return;const c=this._map._getUIString(`NavigationControl.${i}`);m.setAttribute("aria-label",c),m.firstElementChild&&m.firstElementChild.setAttribute("title",c)}},GeolocateControl:class extends a.Evented{constructor(m){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},Ja,m),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=vo(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(m){return this._map=m,this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(m){const i=(c=!!this.options.geolocation)=>{this._supportsGeolocation=c,m(c)};void 0!==this._supportsGeolocation?m(this._supportsGeolocation):void 0!==a.window.navigator.permissions?a.window.navigator.permissions.query({name:"geolocation"}).then(c=>i("denied"!==c.state)).catch(()=>i()):i()}_isOutOfMapMaxBounds(m){const i=this._map.getMaxBounds(),c=m.coords;return!!i&&(c.longitude<i.getWest()||c.longitude>i.getEast()||c.latitude<i.getSouth()||c.latitude>i.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(m){if(this._map){if(this._isOutOfMapMaxBounds(m))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",m)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=m,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(m),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(m),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",m)),this._finish()}}_updateCamera(m){const i=new a.LngLat(m.coords.longitude,m.coords.latitude),c=m.coords.accuracy,y=this._map.getBearing(),u=a.extend({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(i.toBounds(c),u,{geolocateSource:!0})}_updateMarker(m){if(m){const i=new a.LngLat(m.coords.longitude,m.coords.latitude);this._accuracyCircleMarker.setLngLat(i).addTo(this._map),this._userLocationDotMarker.setLngLat(i).addTo(this._map),this._accuracy=m.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const m=this._map.transform,i=a.mercatorZfromAltitude(1,m._center.lat)*m.worldSize,c=Math.ceil(2*this._accuracy*i);this._circleElement.style.width=`${c}px`,this._circleElement.style.height=`${c}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(m){if(this._map){if(this.options.trackUserLocation)if(1===m.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===m.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",m)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(m){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",i=>i.preventDefault()),this._geolocateButton=Ie("button","mapboxgl-ctrl-geolocate",this._container),Ie("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===m){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const i=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}else{const i=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",i),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",i)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=Ie("div","mapboxgl-user-location"),this._dotElement.appendChild(Ie("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(Ie("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new au({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=Ie("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new au({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",i=>{i.geolocateSource||"ACTIVE_LOCK"!==this._watchState||i.originalEvent&&"resize"===i.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))})}}_onDeviceOrientation(m){this._userLocationDotMarker&&(m.webkitCompassHeading?this._heading=m.webkitCompassHeading:!0===m.absolute&&(this._heading=-1*m.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let m;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(m={maximumAge:6e5,timeout:0},this._noTimeout=!0):(m=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,m),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const m=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==a.window.DeviceMotionEvent&&"function"==typeof a.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(i=>{"granted"===i&&m()}).catch(console.error):m()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Pc,ScaleControl:class{constructor(m){this.options=a.extend({},uu,m),function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"narrow",unit:"meter"}),!0}catch{return!1}}()||(this._setScale=nc.bind(this)),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const m=this.options.maxWidth||100,i=this._map,c=i._containerHeight/2,y=i._containerWidth/2-m/2,u=i.unproject([y,c]),p=i.unproject([y+m,c]),f=u.distanceTo(p);if("imperial"===this.options.unit){const w=3.2808*f;w>5280?this._setScale(m,w/5280,"mile"):this._setScale(m,w,"foot")}else"nautical"===this.options.unit?this._setScale(m,f/1852,"nautical-mile"):f>=1e3?this._setScale(m,f/1e3,"kilometer"):this._setScale(m,f,"meter")}_setScale(m,i,c){const y=Xa(i),u=y/i;this._map._requestDomTask(()=>{this._container.style.width=m*u+"px",this._container.innerHTML="nautical-mile"!==c?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"narrow",unit:c}).format(y):`${y}&nbsp;nm`})}onAdd(m){return this._map=m,this._language=m.getLanguage(),this._container=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-scale",m.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(m){this._language=m,this._update()}setUnit(m){this.options.unit=m,this._update()}},FullscreenControl:class{constructor(m){this._fullscreen=!1,m&&m.container&&(m.container instanceof a.window.HTMLElement?this._container=m.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(m){return this._map=m,this._container||(this._container=this._map.getContainer()),this._controlContainer=Ie("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const m=this._fullscreenButton=Ie("button","mapboxgl-ctrl-fullscreen",this._controlContainer);Ie("span","mapboxgl-ctrl-icon",m).setAttribute("aria-hidden","true"),m.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const m=this._getTitle();this._fullscreenButton.setAttribute("aria-label",m),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",m)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(m){super(),this.options=a.extend(Object.create(tc),m),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(m&&m.className?m.className.trim().split(/\s+/):[])}addTo(m){return this._map&&this.remove(),this._map=m,this.options.closeOnClick&&m.on("preclick",this._onClose),this.options.closeOnMove&&m.on("move",this._onClose),m.on("remove",this.remove),this._update(),m._addPopup(this),this._focusFirstElement(),this._trackPointer?(m.on("mousemove",this._onMouseEvent),m.on("mouseup",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")):m.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const m=this._map;return m&&(m.off("move",this._update),m.off("move",this._onClose),m.off("preclick",this._onClose),m.off("click",this._onClose),m.off("remove",this.remove),m.off("mousemove",this._onMouseEvent),m.off("mouseup",this._onMouseEvent),m.off("drag",this._onMouseEvent),m._canvasContainer&&m._canvasContainer.classList.remove("mapboxgl-track-pointer"),m._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(m){this._lngLat=a.LngLat.convert(m),this._pos=null,this._trackPointer=!1,this._update();const i=this._map;return i&&(i.on("move",this._update),i.off("mousemove",this._onMouseEvent),i._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const m=this._map;return m&&(m.off("move",this._update),m.on("mousemove",this._onMouseEvent),m.on("drag",this._onMouseEvent),m._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(m){return this.setDOMContent(a.window.document.createTextNode(m))}setHTML(m){const i=a.window.document.createDocumentFragment(),c=a.window.document.createElement("body");let y;for(c.innerHTML=m;y=c.firstChild,y;)i.appendChild(y);return this.setDOMContent(i)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(m){return this.options.maxWidth=m,this._update(),this}setDOMContent(m){let i=this._content;if(i)for(;i.hasChildNodes();)i.firstChild&&i.removeChild(i.firstChild);else i=this._content=Ie("div","mapboxgl-popup-content",this._container||void 0);if(i.appendChild(m),this.options.closeButton){const c=this._closeButton=Ie("button","mapboxgl-popup-close-button",i);c.type="button",c.setAttribute("aria-label","Close popup"),c.setAttribute("aria-hidden","true"),c.innerHTML="&#215;",c.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(m){return this._classList.add(m),this._updateClassList(),this}removeClassName(m){return this._classList.delete(m),this._updateClassList(),this}setOffset(m){return this.options.offset=m,this._update(),this}toggleClassName(m){let i;return this._classList.delete(m)?i=!1:(this._classList.add(m),i=!0),this._updateClassList(),i}_onMouseEvent(m){this._update(m.point)}_getAnchor(m){if(this.options.anchor)return this.options.anchor;const i=this._map,c=this._container,y=this._pos;if(!i||!c||!y)return"bottom";const u=c.offsetWidth,p=c.offsetHeight,f=y.x<u/2,w=y.x>i.transform.width-u/2;if(y.y+m<p)return f?"top-left":w?"top-right":"top";if(y.y>i.transform.height-p){if(f)return"bottom-left";if(w)return"bottom-right"}return f?"left":w?"right":"bottom"}_updateClassList(){const m=this._container;if(!m)return;const i=[...this._classList];i.push("mapboxgl-popup"),this._anchor&&i.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&i.push("mapboxgl-popup-track-pointer"),m.className=i.join(" ")}_update(m){const i=this._map,c=this._content;if(!i||!this._lngLat&&!this._trackPointer||!c)return;let y=this._container;if(y||(y=this._container=Ie("div","mapboxgl-popup",i.getContainer()),this._tip=Ie("div","mapboxgl-popup-tip",y),y.appendChild(c)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),i.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=su(this._lngLat,this._pos,i.transform)),!this._trackPointer||m){const u=this._pos=this._trackPointer&&m?m:i.project(this._lngLat),p=dd(this.options.offset),f=this._anchor=this._getAnchor(p.y),w=dd(this.options.offset,f),E=u.add(w).round();i._requestDomTask(()=>{this._container&&f&&(this._container.style.transform=`${Rl[f]} translate(${E.x}px,${E.y}px)`)})}if(!this._marker&&i._showingGlobe()){const u=a.isLngLatBehindGlobe(i.transform,this._lngLat)?0:1;this._setOpacity(u)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const m=this._container.querySelector(sh);m&&m.focus()}_onClose(){this.remove()}_setOpacity(m){this._container&&(this._container.style.opacity=`${m}`),this._content&&(this._content.style.pointerEvents=m?"auto":"none")}},Marker:au,Style:go,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.pointGeometry,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:Dn,Evented:a.Evented,config:a.config,prewarm:function(){qn().acquire(jt)},clearPrewarmedResources:function(){const m=Tn;m&&(m.isPreloaded()&&1===m.numActive()?(m.release(jt),Tn=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(m){a.config.ACCESS_TOKEN=m},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(m){a.config.API_URL=m},get workerCount(){return dn.workerCount},set workerCount(m){dn.workerCount=m},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(m){a.config.MAX_PARALLEL_IMAGE_REQUESTS=m},clearStorage(m){a.clearTileCache(m)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return ic}),d}()},1135:(Ln,Dt,F)=>{"use strict";F.d(Dt,{X:()=>v});var d=F(7579);class v extends d.x{constructor(a){super(),this._value=a}get value(){return this.getValue()}_subscribe(a){const q=super._subscribe(a);return!q.closed&&a.next(this._value),q}getValue(){const{hasError:a,thrownError:q,_value:oe}=this;if(a)throw q;return this._throwIfClosed(),oe}next(a){super.next(this._value=a)}}},9751:(Ln,Dt,F)=>{"use strict";F.d(Dt,{y:()=>he});var d=F(2961),v=F(727),re=F(8822),a=F(9635),q=F(2416),oe=F(576),b=F(2806);let he=(()=>{class xe{constructor(ze){ze&&(this._subscribe=ze)}lift(ze){const ce=new xe;return ce.source=this,ce.operator=ze,ce}subscribe(ze,ce,Ke){const Pe=function K(xe){return xe&&xe instanceof d.Lv||function Ve(xe){return xe&&(0,oe.m)(xe.next)&&(0,oe.m)(xe.error)&&(0,oe.m)(xe.complete)}(xe)&&(0,v.Nn)(xe)}(ze)?ze:new d.Hp(ze,ce,Ke);return(0,b.x)(()=>{const{operator:ne,source:Je}=this;Pe.add(ne?ne.call(Pe,Je):Je?this._subscribe(Pe):this._trySubscribe(Pe))}),Pe}_trySubscribe(ze){try{return this._subscribe(ze)}catch(ce){ze.error(ce)}}forEach(ze,ce){return new(ce=Ie(ce))((Ke,Pe)=>{const ne=new d.Hp({next:Je=>{try{ze(Je)}catch(Pt){Pe(Pt),ne.unsubscribe()}},error:Pe,complete:Ke});this.subscribe(ne)})}_subscribe(ze){var ce;return null===(ce=this.source)||void 0===ce?void 0:ce.subscribe(ze)}[re.L](){return this}pipe(...ze){return(0,a.U)(ze)(this)}toPromise(ze){return new(ze=Ie(ze))((ce,Ke)=>{let Pe;this.subscribe(ne=>Pe=ne,ne=>Ke(ne),()=>ce(Pe))})}}return xe.create=pe=>new xe(pe),xe})();function Ie(xe){var pe;return null!==(pe=xe??q.v.Promise)&&void 0!==pe?pe:Promise}},7579:(Ln,Dt,F)=>{"use strict";F.d(Dt,{x:()=>b});var d=F(9751),v=F(727);const a=(0,F(3888).d)(Ie=>function(){Ie(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var q=F(8737),oe=F(2806);let b=(()=>{class Ie extends d.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(K){const xe=new he(this,this);return xe.operator=K,xe}_throwIfClosed(){if(this.closed)throw new a}next(K){(0,oe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const xe of this.currentObservers)xe.next(K)}})}error(K){(0,oe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=K;const{observers:xe}=this;for(;xe.length;)xe.shift().error(K)}})}complete(){(0,oe.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:K}=this;for(;K.length;)K.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var K;return(null===(K=this.observers)||void 0===K?void 0:K.length)>0}_trySubscribe(K){return this._throwIfClosed(),super._trySubscribe(K)}_subscribe(K){return this._throwIfClosed(),this._checkFinalizedStatuses(K),this._innerSubscribe(K)}_innerSubscribe(K){const{hasError:xe,isStopped:pe,observers:ze}=this;return xe||pe?v.Lc:(this.currentObservers=null,ze.push(K),new v.w0(()=>{this.currentObservers=null,(0,q.P)(ze,K)}))}_checkFinalizedStatuses(K){const{hasError:xe,thrownError:pe,isStopped:ze}=this;xe?K.error(pe):ze&&K.complete()}asObservable(){const K=new d.y;return K.source=this,K}}return Ie.create=(Ve,K)=>new he(Ve,K),Ie})();class he extends b{constructor(Ve,K){super(),this.destination=Ve,this.source=K}next(Ve){var K,xe;null===(xe=null===(K=this.destination)||void 0===K?void 0:K.next)||void 0===xe||xe.call(K,Ve)}error(Ve){var K,xe;null===(xe=null===(K=this.destination)||void 0===K?void 0:K.error)||void 0===xe||xe.call(K,Ve)}complete(){var Ve,K;null===(K=null===(Ve=this.destination)||void 0===Ve?void 0:Ve.complete)||void 0===K||K.call(Ve)}_subscribe(Ve){var K,xe;return null!==(xe=null===(K=this.source)||void 0===K?void 0:K.subscribe(Ve))&&void 0!==xe?xe:v.Lc}}},2961:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Hp:()=>Ke,Lv:()=>xe});var d=F(576),v=F(727),re=F(2416),a=F(7849);function q(){}const oe=Ie("C",void 0,void 0);function Ie(at,ge,ke){return{kind:at,value:ge,error:ke}}var Ve=F(3410),K=F(2806);class xe extends v.w0{constructor(ge){super(),this.isStopped=!1,ge?(this.destination=ge,(0,v.Nn)(ge)&&ge.add(this)):this.destination=Pt}static create(ge,ke,Le){return new Ke(ge,ke,Le)}next(ge){this.isStopped?Je(function he(at){return Ie("N",at,void 0)}(ge),this):this._next(ge)}error(ge){this.isStopped?Je(function b(at){return Ie("E",void 0,at)}(ge),this):(this.isStopped=!0,this._error(ge))}complete(){this.isStopped?Je(oe,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ge){this.destination.next(ge)}_error(ge){try{this.destination.error(ge)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const pe=Function.prototype.bind;function ze(at,ge){return pe.call(at,ge)}class ce{constructor(ge){this.partialObserver=ge}next(ge){const{partialObserver:ke}=this;if(ke.next)try{ke.next(ge)}catch(Le){Pe(Le)}}error(ge){const{partialObserver:ke}=this;if(ke.error)try{ke.error(ge)}catch(Le){Pe(Le)}else Pe(ge)}complete(){const{partialObserver:ge}=this;if(ge.complete)try{ge.complete()}catch(ke){Pe(ke)}}}class Ke extends xe{constructor(ge,ke,Le){let we;if(super(),(0,d.m)(ge)||!ge)we={next:ge??void 0,error:ke??void 0,complete:Le??void 0};else{let Xe;this&&re.v.useDeprecatedNextContext?(Xe=Object.create(ge),Xe.unsubscribe=()=>this.unsubscribe(),we={next:ge.next&&ze(ge.next,Xe),error:ge.error&&ze(ge.error,Xe),complete:ge.complete&&ze(ge.complete,Xe)}):we=ge}this.destination=new ce(we)}}function Pe(at){re.v.useDeprecatedSynchronousErrorHandling?(0,K.O)(at):(0,a.h)(at)}function Je(at,ge){const{onStoppedNotification:ke}=re.v;ke&&Ve.z.setTimeout(()=>ke(at,ge))}const Pt={closed:!0,next:q,error:function ne(at){throw at},complete:q}},727:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Lc:()=>oe,w0:()=>q,Nn:()=>b});var d=F(576);const re=(0,F(3888).d)(Ie=>function(K){Ie(this),this.message=K?`${K.length} errors occurred during unsubscription:\n${K.map((xe,pe)=>`${pe+1}) ${xe.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=K});var a=F(8737);class q{constructor(Ve){this.initialTeardown=Ve,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Ve;if(!this.closed){this.closed=!0;const{_parentage:K}=this;if(K)if(this._parentage=null,Array.isArray(K))for(const ze of K)ze.remove(this);else K.remove(this);const{initialTeardown:xe}=this;if((0,d.m)(xe))try{xe()}catch(ze){Ve=ze instanceof re?ze.errors:[ze]}const{_finalizers:pe}=this;if(pe){this._finalizers=null;for(const ze of pe)try{he(ze)}catch(ce){Ve=Ve??[],ce instanceof re?Ve=[...Ve,...ce.errors]:Ve.push(ce)}}if(Ve)throw new re(Ve)}}add(Ve){var K;if(Ve&&Ve!==this)if(this.closed)he(Ve);else{if(Ve instanceof q){if(Ve.closed||Ve._hasParent(this))return;Ve._addParent(this)}(this._finalizers=null!==(K=this._finalizers)&&void 0!==K?K:[]).push(Ve)}}_hasParent(Ve){const{_parentage:K}=this;return K===Ve||Array.isArray(K)&&K.includes(Ve)}_addParent(Ve){const{_parentage:K}=this;this._parentage=Array.isArray(K)?(K.push(Ve),K):K?[K,Ve]:Ve}_removeParent(Ve){const{_parentage:K}=this;K===Ve?this._parentage=null:Array.isArray(K)&&(0,a.P)(K,Ve)}remove(Ve){const{_finalizers:K}=this;K&&(0,a.P)(K,Ve),Ve instanceof q&&Ve._removeParent(this)}}q.EMPTY=(()=>{const Ie=new q;return Ie.closed=!0,Ie})();const oe=q.EMPTY;function b(Ie){return Ie instanceof q||Ie&&"closed"in Ie&&(0,d.m)(Ie.remove)&&(0,d.m)(Ie.add)&&(0,d.m)(Ie.unsubscribe)}function he(Ie){(0,d.m)(Ie)?Ie():Ie.unsubscribe()}},2416:(Ln,Dt,F)=>{"use strict";F.d(Dt,{v:()=>d});const d={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},7272:(Ln,Dt,F)=>{"use strict";F.d(Dt,{z:()=>q});var d=F(8189),re=F(7669),a=F(2076);function q(...oe){return function v(){return(0,d.J)(1)}()((0,a.D)(oe,(0,re.yG)(oe)))}},9770:(Ln,Dt,F)=>{"use strict";F.d(Dt,{P:()=>re});var d=F(9751),v=F(8421);function re(a){return new d.y(q=>{(0,v.Xf)(a()).subscribe(q)})}},515:(Ln,Dt,F)=>{"use strict";F.d(Dt,{E:()=>v});const v=new(F(9751).y)(q=>q.complete())},4128:(Ln,Dt,F)=>{"use strict";F.d(Dt,{D:()=>he});var d=F(9751),v=F(4742),re=F(8421),a=F(7669),q=F(5403),oe=F(3268),b=F(1810);function he(...Ie){const Ve=(0,a.jO)(Ie),{args:K,keys:xe}=(0,v.D)(Ie),pe=new d.y(ze=>{const{length:ce}=K;if(!ce)return void ze.complete();const Ke=new Array(ce);let Pe=ce,ne=ce;for(let Je=0;Je<ce;Je++){let Pt=!1;(0,re.Xf)(K[Je]).subscribe((0,q.x)(ze,at=>{Pt||(Pt=!0,ne--),Ke[Je]=at},()=>Pe--,void 0,()=>{(!Pe||!Pt)&&(ne||ze.next(xe?(0,b.n)(xe,Ke):Ke),ze.complete())}))}});return Ve?pe.pipe((0,oe.Z)(Ve)):pe}},2076:(Ln,Dt,F)=>{"use strict";F.d(Dt,{D:()=>Le});var d=F(8421),v=F(9672),re=F(4482),a=F(5403);function q(we,Xe=0){return(0,re.e)((He,me)=>{He.subscribe((0,a.x)(me,de=>(0,v.f)(me,we,()=>me.next(de),Xe),()=>(0,v.f)(me,we,()=>me.complete(),Xe),de=>(0,v.f)(me,we,()=>me.error(de),Xe)))})}function oe(we,Xe=0){return(0,re.e)((He,me)=>{me.add(we.schedule(()=>He.subscribe(me),Xe))})}var Ie=F(9751),K=F(2202),xe=F(576);function ze(we,Xe){if(!we)throw new Error("Iterable cannot be null");return new Ie.y(He=>{(0,v.f)(He,Xe,()=>{const me=we[Symbol.asyncIterator]();(0,v.f)(He,Xe,()=>{me.next().then(de=>{de.done?He.complete():He.next(de.value)})},0,!0)})})}var ce=F(3670),Ke=F(8239),Pe=F(1144),ne=F(6495),Je=F(2206),Pt=F(4532),at=F(3260);function Le(we,Xe){return Xe?function ke(we,Xe){if(null!=we){if((0,ce.c)(we))return function b(we,Xe){return(0,d.Xf)(we).pipe(oe(Xe),q(Xe))}(we,Xe);if((0,Pe.z)(we))return function Ve(we,Xe){return new Ie.y(He=>{let me=0;return Xe.schedule(function(){me===we.length?He.complete():(He.next(we[me++]),He.closed||this.schedule())})})}(we,Xe);if((0,Ke.t)(we))return function he(we,Xe){return(0,d.Xf)(we).pipe(oe(Xe),q(Xe))}(we,Xe);if((0,Je.D)(we))return ze(we,Xe);if((0,ne.T)(we))return function pe(we,Xe){return new Ie.y(He=>{let me;return(0,v.f)(He,Xe,()=>{me=we[K.h](),(0,v.f)(He,Xe,()=>{let de,se;try{({value:de,done:se}=me.next())}catch(Ee){return void He.error(Ee)}se?He.complete():He.next(de)},0,!0)}),()=>(0,xe.m)(me?.return)&&me.return()})}(we,Xe);if((0,at.L)(we))return function ge(we,Xe){return ze((0,at.Q)(we),Xe)}(we,Xe)}throw(0,Pt.z)(we)}(we,Xe):(0,d.Xf)(we)}},4968:(Ln,Dt,F)=>{"use strict";F.d(Dt,{R:()=>Ve});var d=F(8421),v=F(9751),re=F(5577),a=F(1144),q=F(576),oe=F(3268);const b=["addListener","removeListener"],he=["addEventListener","removeEventListener"],Ie=["on","off"];function Ve(ce,Ke,Pe,ne){if((0,q.m)(Pe)&&(ne=Pe,Pe=void 0),ne)return Ve(ce,Ke,Pe).pipe((0,oe.Z)(ne));const[Je,Pt]=function ze(ce){return(0,q.m)(ce.addEventListener)&&(0,q.m)(ce.removeEventListener)}(ce)?he.map(at=>ge=>ce[at](Ke,ge,Pe)):function xe(ce){return(0,q.m)(ce.addListener)&&(0,q.m)(ce.removeListener)}(ce)?b.map(K(ce,Ke)):function pe(ce){return(0,q.m)(ce.on)&&(0,q.m)(ce.off)}(ce)?Ie.map(K(ce,Ke)):[];if(!Je&&(0,a.z)(ce))return(0,re.z)(at=>Ve(at,Ke,Pe))((0,d.Xf)(ce));if(!Je)throw new TypeError("Invalid event target");return new v.y(at=>{const ge=(...ke)=>at.next(1<ke.length?ke:ke[0]);return Je(ge),()=>Pt(ge)})}function K(ce,Ke){return Pe=>ne=>ce[Pe](Ke,ne)}},8421:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Xf:()=>pe});var d=F(5987),v=F(1144),re=F(8239),a=F(9751),q=F(3670),oe=F(2206),b=F(4532),he=F(6495),Ie=F(3260),Ve=F(576),K=F(7849),xe=F(8822);function pe(at){if(at instanceof a.y)return at;if(null!=at){if((0,q.c)(at))return function ze(at){return new a.y(ge=>{const ke=at[xe.L]();if((0,Ve.m)(ke.subscribe))return ke.subscribe(ge);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(at);if((0,v.z)(at))return function ce(at){return new a.y(ge=>{for(let ke=0;ke<at.length&&!ge.closed;ke++)ge.next(at[ke]);ge.complete()})}(at);if((0,re.t)(at))return function Ke(at){return new a.y(ge=>{at.then(ke=>{ge.closed||(ge.next(ke),ge.complete())},ke=>ge.error(ke)).then(null,K.h)})}(at);if((0,oe.D)(at))return ne(at);if((0,he.T)(at))return function Pe(at){return new a.y(ge=>{for(const ke of at)if(ge.next(ke),ge.closed)return;ge.complete()})}(at);if((0,Ie.L)(at))return function Je(at){return ne((0,Ie.Q)(at))}(at)}throw(0,b.z)(at)}function ne(at){return new a.y(ge=>{(function Pt(at,ge){var ke,Le,we,Xe;return(0,d.mG)(this,void 0,void 0,function*(){try{for(ke=(0,d.KL)(at);!(Le=yield ke.next()).done;)if(ge.next(Le.value),ge.closed)return}catch(He){we={error:He}}finally{try{Le&&!Le.done&&(Xe=ke.return)&&(yield Xe.call(ke))}finally{if(we)throw we.error}}ge.complete()})})(at,ge).catch(ke=>ge.error(ke))})}},9646:(Ln,Dt,F)=>{"use strict";F.d(Dt,{of:()=>re});var d=F(7669),v=F(2076);function re(...a){const q=(0,d.yG)(a);return(0,v.D)(a,q)}},5403:(Ln,Dt,F)=>{"use strict";F.d(Dt,{x:()=>v});var d=F(2961);function v(a,q,oe,b,he){return new re(a,q,oe,b,he)}class re extends d.Lv{constructor(q,oe,b,he,Ie,Ve){super(q),this.onFinalize=Ie,this.shouldUnsubscribe=Ve,this._next=oe?function(K){try{oe(K)}catch(xe){q.error(xe)}}:super._next,this._error=he?function(K){try{he(K)}catch(xe){q.error(xe)}finally{this.unsubscribe()}}:super._error,this._complete=b?function(){try{b()}catch(K){q.error(K)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var q;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:oe}=this;super.unsubscribe(),!oe&&(null===(q=this.onFinalize)||void 0===q||q.call(this))}}}},4351:(Ln,Dt,F)=>{"use strict";F.d(Dt,{b:()=>re});var d=F(5577),v=F(576);function re(a,q){return(0,v.m)(q)?(0,d.z)(a,q,1):(0,d.z)(a,1)}},9300:(Ln,Dt,F)=>{"use strict";F.d(Dt,{h:()=>re});var d=F(4482),v=F(5403);function re(a,q){return(0,d.e)((oe,b)=>{let he=0;oe.subscribe((0,v.x)(b,Ie=>a.call(q,Ie,he++)&&b.next(Ie)))})}},4004:(Ln,Dt,F)=>{"use strict";F.d(Dt,{U:()=>re});var d=F(4482),v=F(5403);function re(a,q){return(0,d.e)((oe,b)=>{let he=0;oe.subscribe((0,v.x)(b,Ie=>{b.next(a.call(q,Ie,he++))}))})}},8189:(Ln,Dt,F)=>{"use strict";F.d(Dt,{J:()=>re});var d=F(5577),v=F(4671);function re(a=1/0){return(0,d.z)(v.y,a)}},5577:(Ln,Dt,F)=>{"use strict";F.d(Dt,{z:()=>he});var d=F(4004),v=F(8421),re=F(4482),a=F(9672),q=F(5403),b=F(576);function he(Ie,Ve,K=1/0){return(0,b.m)(Ve)?he((xe,pe)=>(0,d.U)((ze,ce)=>Ve(xe,ze,pe,ce))((0,v.Xf)(Ie(xe,pe))),K):("number"==typeof Ve&&(K=Ve),(0,re.e)((xe,pe)=>function oe(Ie,Ve,K,xe,pe,ze,ce,Ke){const Pe=[];let ne=0,Je=0,Pt=!1;const at=()=>{Pt&&!Pe.length&&!ne&&Ve.complete()},ge=Le=>ne<xe?ke(Le):Pe.push(Le),ke=Le=>{ze&&Ve.next(Le),ne++;let we=!1;(0,v.Xf)(K(Le,Je++)).subscribe((0,q.x)(Ve,Xe=>{pe?.(Xe),ze?ge(Xe):Ve.next(Xe)},()=>{we=!0},void 0,()=>{if(we)try{for(ne--;Pe.length&&ne<xe;){const Xe=Pe.shift();ce?(0,a.f)(Ve,ce,()=>ke(Xe)):ke(Xe)}at()}catch(Xe){Ve.error(Xe)}}))};return Ie.subscribe((0,q.x)(Ve,ge,()=>{Pt=!0,at()})),()=>{Ke?.()}}(xe,pe,Ie,K)))}},3099:(Ln,Dt,F)=>{"use strict";F.d(Dt,{B:()=>q});var d=F(8421),v=F(7579),re=F(2961),a=F(4482);function q(b={}){const{connector:he=(()=>new v.x),resetOnError:Ie=!0,resetOnComplete:Ve=!0,resetOnRefCountZero:K=!0}=b;return xe=>{let pe,ze,ce,Ke=0,Pe=!1,ne=!1;const Je=()=>{ze?.unsubscribe(),ze=void 0},Pt=()=>{Je(),pe=ce=void 0,Pe=ne=!1},at=()=>{const ge=pe;Pt(),ge?.unsubscribe()};return(0,a.e)((ge,ke)=>{Ke++,!ne&&!Pe&&Je();const Le=ce=ce??he();ke.add(()=>{Ke--,0===Ke&&!ne&&!Pe&&(ze=oe(at,K))}),Le.subscribe(ke),!pe&&Ke>0&&(pe=new re.Hp({next:we=>Le.next(we),error:we=>{ne=!0,Je(),ze=oe(Pt,Ie,we),Le.error(we)},complete:()=>{Pe=!0,Je(),ze=oe(Pt,Ve),Le.complete()}}),(0,d.Xf)(ge).subscribe(pe))})(xe)}}function oe(b,he,...Ie){if(!0===he)return void b();if(!1===he)return;const Ve=new re.Hp({next:()=>{Ve.unsubscribe(),b()}});return(0,d.Xf)(he(...Ie)).subscribe(Ve)}},3900:(Ln,Dt,F)=>{"use strict";F.d(Dt,{w:()=>a});var d=F(8421),v=F(4482),re=F(5403);function a(q,oe){return(0,v.e)((b,he)=>{let Ie=null,Ve=0,K=!1;const xe=()=>K&&!Ie&&he.complete();b.subscribe((0,re.x)(he,pe=>{Ie?.unsubscribe();let ze=0;const ce=Ve++;(0,d.Xf)(q(pe,ce)).subscribe(Ie=(0,re.x)(he,Ke=>he.next(oe?oe(pe,Ke,ce,ze++):Ke),()=>{Ie=null,xe()}))},()=>{K=!0,xe()}))})}},5698:(Ln,Dt,F)=>{"use strict";F.d(Dt,{q:()=>a});var d=F(515),v=F(4482),re=F(5403);function a(q){return q<=0?()=>d.E:(0,v.e)((oe,b)=>{let he=0;oe.subscribe((0,re.x)(b,Ie=>{++he<=q&&(b.next(Ie),q<=he&&b.complete())}))})}},6063:(Ln,Dt,F)=>{"use strict";F.d(Dt,{l:()=>d});const d={now:()=>(d.delegate||Date).now(),delegate:void 0}},3410:(Ln,Dt,F)=>{"use strict";F.d(Dt,{z:()=>d});const d={setTimeout(v,re,...a){const{delegate:q}=d;return q?.setTimeout?q.setTimeout(v,re,...a):setTimeout(v,re,...a)},clearTimeout(v){const{delegate:re}=d;return(re?.clearTimeout||clearTimeout)(v)},delegate:void 0}},2202:(Ln,Dt,F)=>{"use strict";F.d(Dt,{h:()=>v});const v=function d(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},8822:(Ln,Dt,F)=>{"use strict";F.d(Dt,{L:()=>d});const d="function"==typeof Symbol&&Symbol.observable||"@@observable"},7669:(Ln,Dt,F)=>{"use strict";F.d(Dt,{_6:()=>oe,jO:()=>a,yG:()=>q});var d=F(576);function re(b){return b[b.length-1]}function a(b){return(0,d.m)(re(b))?b.pop():void 0}function q(b){return function v(b){return b&&(0,d.m)(b.schedule)}(re(b))?b.pop():void 0}function oe(b,he){return"number"==typeof re(b)?b.pop():he}},4742:(Ln,Dt,F)=>{"use strict";F.d(Dt,{D:()=>q});const{isArray:d}=Array,{getPrototypeOf:v,prototype:re,keys:a}=Object;function q(b){if(1===b.length){const he=b[0];if(d(he))return{args:he,keys:null};if(function oe(b){return b&&"object"==typeof b&&v(b)===re}(he)){const Ie=a(he);return{args:Ie.map(Ve=>he[Ve]),keys:Ie}}}return{args:b,keys:null}}},8737:(Ln,Dt,F)=>{"use strict";function d(v,re){if(v){const a=v.indexOf(re);0<=a&&v.splice(a,1)}}F.d(Dt,{P:()=>d})},3888:(Ln,Dt,F)=>{"use strict";function d(v){const a=v(q=>{Error.call(q),q.stack=(new Error).stack});return a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a}F.d(Dt,{d:()=>d})},1810:(Ln,Dt,F)=>{"use strict";function d(v,re){return v.reduce((a,q,oe)=>(a[q]=re[oe],a),{})}F.d(Dt,{n:()=>d})},2806:(Ln,Dt,F)=>{"use strict";F.d(Dt,{O:()=>a,x:()=>re});var d=F(2416);let v=null;function re(q){if(d.v.useDeprecatedSynchronousErrorHandling){const oe=!v;if(oe&&(v={errorThrown:!1,error:null}),q(),oe){const{errorThrown:b,error:he}=v;if(v=null,b)throw he}}else q()}function a(q){d.v.useDeprecatedSynchronousErrorHandling&&v&&(v.errorThrown=!0,v.error=q)}},9672:(Ln,Dt,F)=>{"use strict";function d(v,re,a,q=0,oe=!1){const b=re.schedule(function(){a(),oe?v.add(this.schedule(null,q)):this.unsubscribe()},q);if(v.add(b),!oe)return b}F.d(Dt,{f:()=>d})},4671:(Ln,Dt,F)=>{"use strict";function d(v){return v}F.d(Dt,{y:()=>d})},1144:(Ln,Dt,F)=>{"use strict";F.d(Dt,{z:()=>d});const d=v=>v&&"number"==typeof v.length&&"function"!=typeof v},2206:(Ln,Dt,F)=>{"use strict";F.d(Dt,{D:()=>v});var d=F(576);function v(re){return Symbol.asyncIterator&&(0,d.m)(re?.[Symbol.asyncIterator])}},576:(Ln,Dt,F)=>{"use strict";function d(v){return"function"==typeof v}F.d(Dt,{m:()=>d})},3670:(Ln,Dt,F)=>{"use strict";F.d(Dt,{c:()=>re});var d=F(8822),v=F(576);function re(a){return(0,v.m)(a[d.L])}},6495:(Ln,Dt,F)=>{"use strict";F.d(Dt,{T:()=>re});var d=F(2202),v=F(576);function re(a){return(0,v.m)(a?.[d.h])}},8239:(Ln,Dt,F)=>{"use strict";F.d(Dt,{t:()=>v});var d=F(576);function v(re){return(0,d.m)(re?.then)}},3260:(Ln,Dt,F)=>{"use strict";F.d(Dt,{L:()=>a,Q:()=>re});var d=F(5987),v=F(576);function re(q){return(0,d.FC)(this,arguments,function*(){const b=q.getReader();try{for(;;){const{value:he,done:Ie}=yield(0,d.qq)(b.read());if(Ie)return yield(0,d.qq)(void 0);yield yield(0,d.qq)(he)}}finally{b.releaseLock()}})}function a(q){return(0,v.m)(q?.getReader)}},4482:(Ln,Dt,F)=>{"use strict";F.d(Dt,{A:()=>v,e:()=>re});var d=F(576);function v(a){return(0,d.m)(a?.lift)}function re(a){return q=>{if(v(q))return q.lift(function(oe){try{return a(oe,this)}catch(b){this.error(b)}});throw new TypeError("Unable to lift unknown Observable type")}}},3268:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Z:()=>a});var d=F(4004);const{isArray:v}=Array;function a(q){return(0,d.U)(oe=>function re(q,oe){return v(oe)?q(...oe):q(oe)}(q,oe))}},9635:(Ln,Dt,F)=>{"use strict";F.d(Dt,{U:()=>re,z:()=>v});var d=F(4671);function v(...a){return re(a)}function re(a){return 0===a.length?d.y:1===a.length?a[0]:function(oe){return a.reduce((b,he)=>he(b),oe)}}},7849:(Ln,Dt,F)=>{"use strict";F.d(Dt,{h:()=>re});var d=F(2416),v=F(3410);function re(a){v.z.setTimeout(()=>{const{onUnhandledError:q}=d.v;if(!q)throw a;q(a)})}},4532:(Ln,Dt,F)=>{"use strict";function d(v){return new TypeError(`You provided ${null!==v&&"object"==typeof v?"an invalid object":`'${v}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}F.d(Dt,{z:()=>d})},863:(Ln,Dt,F)=>{var d={"./ion-accordion_2.entry.js":[9654,8592,9654],"./ion-action-sheet.entry.js":[3648,8592,3648],"./ion-alert.entry.js":[1118,8592,1118],"./ion-app_8.entry.js":[53,8592,3236],"./ion-avatar_3.entry.js":[4753,4753],"./ion-back-button.entry.js":[2073,8592,2073],"./ion-backdrop.entry.js":[8939,8939],"./ion-breadcrumb_2.entry.js":[7544,8592,7544],"./ion-button_2.entry.js":[5652,5652],"./ion-card_5.entry.js":[5929,388],"./ion-checkbox.entry.js":[9922,9922],"./ion-chip.entry.js":[657,657],"./ion-col_3.entry.js":[9824,9824],"./ion-datetime-button.entry.js":[9230,1435,9230],"./ion-datetime_3.entry.js":[4959,1435,8592,4959],"./ion-fab_3.entry.js":[5836,8592,5836],"./ion-img.entry.js":[1033,1033],"./ion-infinite-scroll_2.entry.js":[8034,8592,5817],"./ion-input.entry.js":[1217,8592,1217],"./ion-item-option_3.entry.js":[2933,8592,4651],"./ion-item_8.entry.js":[4711,8592,4711],"./ion-loading.entry.js":[9434,8592,9434],"./ion-menu_3.entry.js":[8136,8592,8136],"./ion-modal.entry.js":[2349,8592,2349],"./ion-nav_2.entry.js":[5349,8592,5349],"./ion-picker-column-internal.entry.js":[7602,8592,7602],"./ion-picker-internal.entry.js":[9016,9016],"./ion-popover.entry.js":[3804,8592,3804],"./ion-progress-bar.entry.js":[4174,4174],"./ion-radio_2.entry.js":[4432,4432],"./ion-range.entry.js":[1709,8592,1709],"./ion-refresher_2.entry.js":[3326,8592,2175],"./ion-reorder_2.entry.js":[3583,8592,1186],"./ion-ripple-effect.entry.js":[9958,9958],"./ion-route_4.entry.js":[4330,4330],"./ion-searchbar.entry.js":[8628,8592,8628],"./ion-segment_2.entry.js":[9325,8592,9325],"./ion-select_3.entry.js":[2773,2773],"./ion-slide_2.entry.js":[1650,1650],"./ion-spinner.entry.js":[4908,8592,4908],"./ion-split-pane.entry.js":[9536,9536],"./ion-tab-bar_2.entry.js":[438,8592,438],"./ion-tab_2.entry.js":[1536,8592,1536],"./ion-text.entry.js":[4376,4376],"./ion-textarea.entry.js":[6560,6560],"./ion-toast.entry.js":[6120,8592,6120],"./ion-toggle.entry.js":[5168,8592,5168],"./ion-virtual-scroll.entry.js":[2289,2289]};function v(re){if(!F.o(d,re))return Promise.resolve().then(()=>{var oe=new Error("Cannot find module '"+re+"'");throw oe.code="MODULE_NOT_FOUND",oe});var a=d[re],q=a[0];return Promise.all(a.slice(1).map(F.e)).then(()=>F(q))}v.keys=()=>Object.keys(d),v.id=863,Ln.exports=v},5987:(Ln,Dt,F)=>{"use strict";function he(me,de,se,Ee){return new(se||(se=Promise))(function(It,Gt){function Lt(xt){try{St(Ee.next(xt))}catch(rt){Gt(rt)}}function yt(xt){try{St(Ee.throw(xt))}catch(rt){Gt(rt)}}function St(xt){xt.done?It(xt.value):function _t(It){return It instanceof se?It:new se(function(Gt){Gt(It)})}(xt.value).then(Lt,yt)}St((Ee=Ee.apply(me,de||[])).next())})}function Pe(me){return this instanceof Pe?(this.v=me,this):new Pe(me)}function ne(me,de,se){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var _t,Ee=se.apply(me,de||[]),It=[];return _t={},Gt("next"),Gt("throw"),Gt("return"),_t[Symbol.asyncIterator]=function(){return this},_t;function Gt(lt){Ee[lt]&&(_t[lt]=function(Ce){return new Promise(function(bt,kt){It.push([lt,Ce,bt,kt])>1||Lt(lt,Ce)})})}function Lt(lt,Ce){try{!function yt(lt){lt.value instanceof Pe?Promise.resolve(lt.value.v).then(St,xt):rt(It[0][2],lt)}(Ee[lt](Ce))}catch(bt){rt(It[0][3],bt)}}function St(lt){Lt("next",lt)}function xt(lt){Lt("throw",lt)}function rt(lt,Ce){lt(Ce),It.shift(),It.length&&Lt(It[0][0],It[0][1])}}function Pt(me){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var se,de=me[Symbol.asyncIterator];return de?de.call(me):(me=function xe(me){var de="function"==typeof Symbol&&Symbol.iterator,se=de&&me[de],Ee=0;if(se)return se.call(me);if(me&&"number"==typeof me.length)return{next:function(){return me&&Ee>=me.length&&(me=void 0),{value:me&&me[Ee++],done:!me}}};throw new TypeError(de?"Object is not iterable.":"Symbol.iterator is not defined.")}(me),se={},Ee("next"),Ee("throw"),Ee("return"),se[Symbol.asyncIterator]=function(){return this},se);function Ee(It){se[It]=me[It]&&function(Gt){return new Promise(function(Lt,yt){!function _t(It,Gt,Lt,yt){Promise.resolve(yt).then(function(St){It({value:St,done:Lt})},Gt)}(Lt,yt,(Gt=me[It](Gt)).done,Gt.value)})}}}F.d(Dt,{FC:()=>ne,KL:()=>Pt,mG:()=>he,qq:()=>Pe})},6895:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Do:()=>Je,EM:()=>Sa,HT:()=>a,JF:()=>ji,JJ:()=>Co,K0:()=>oe,Mx:()=>fo,O5:()=>zt,S$:()=>Ke,V_:()=>Ie,Ye:()=>Pt,b0:()=>ne,bD:()=>go,ez:()=>Ms,q:()=>re,sg:()=>fe,tP:()=>Vi,uU:()=>Wr,w_:()=>q});var d=F(8274);let v=null;function re(){return v}function a(U){v||(v=U)}class q{}const oe=new d.OlP("DocumentToken");let b=(()=>{class U{historyGo(H){throw new Error("Not implemented")}}return U.\u0275fac=function(H){return new(H||U)},U.\u0275prov=d.Yz7({token:U,factory:function(){return function he(){return(0,d.LFG)(Ve)}()},providedIn:"platform"}),U})();const Ie=new d.OlP("Location Initialized");let Ve=(()=>{class U extends b{constructor(H){super(),this._doc=H,this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return re().getBaseHref(this._doc)}onPopState(H){const Se=re().getGlobalEventTarget(this._doc,"window");return Se.addEventListener("popstate",H,!1),()=>Se.removeEventListener("popstate",H)}onHashChange(H){const Se=re().getGlobalEventTarget(this._doc,"window");return Se.addEventListener("hashchange",H,!1),()=>Se.removeEventListener("hashchange",H)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(H){this._location.pathname=H}pushState(H,Se,ht){K()?this._history.pushState(H,Se,ht):this._location.hash=ht}replaceState(H,Se,ht){K()?this._history.replaceState(H,Se,ht):this._location.hash=ht}forward(){this._history.forward()}back(){this._history.back()}historyGo(H=0){this._history.go(H)}getState(){return this._history.state}}return U.\u0275fac=function(H){return new(H||U)(d.LFG(oe))},U.\u0275prov=d.Yz7({token:U,factory:function(){return function xe(){return new Ve((0,d.LFG)(oe))}()},providedIn:"platform"}),U})();function K(){return!!window.history.pushState}function pe(U,le){if(0==U.length)return le;if(0==le.length)return U;let H=0;return U.endsWith("/")&&H++,le.startsWith("/")&&H++,2==H?U+le.substring(1):1==H?U+le:U+"/"+le}function ze(U){const le=U.match(/#|\?|$/),H=le&&le.index||U.length;return U.slice(0,H-("/"===U[H-1]?1:0))+U.slice(H)}function ce(U){return U&&"?"!==U[0]?"?"+U:U}let Ke=(()=>{class U{historyGo(H){throw new Error("Not implemented")}}return U.\u0275fac=function(H){return new(H||U)},U.\u0275prov=d.Yz7({token:U,factory:function(){return(0,d.f3M)(ne)},providedIn:"root"}),U})();const Pe=new d.OlP("appBaseHref");let ne=(()=>{class U extends Ke{constructor(H,Se){super(),this._platformLocation=H,this._removeListenerFns=[],this._baseHref=Se??this._platformLocation.getBaseHrefFromDOM()??(0,d.f3M)(oe).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(H){this._removeListenerFns.push(this._platformLocation.onPopState(H),this._platformLocation.onHashChange(H))}getBaseHref(){return this._baseHref}prepareExternalUrl(H){return pe(this._baseHref,H)}path(H=!1){const Se=this._platformLocation.pathname+ce(this._platformLocation.search),ht=this._platformLocation.hash;return ht&&H?`${Se}${ht}`:Se}pushState(H,Se,ht,hn){const Dn=this.prepareExternalUrl(ht+ce(hn));this._platformLocation.pushState(H,Se,Dn)}replaceState(H,Se,ht,hn){const Dn=this.prepareExternalUrl(ht+ce(hn));this._platformLocation.replaceState(H,Se,Dn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(H=0){this._platformLocation.historyGo?.(H)}}return U.\u0275fac=function(H){return new(H||U)(d.LFG(b),d.LFG(Pe,8))},U.\u0275prov=d.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"}),U})(),Je=(()=>{class U extends Ke{constructor(H,Se){super(),this._platformLocation=H,this._baseHref="",this._removeListenerFns=[],null!=Se&&(this._baseHref=Se)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(H){this._removeListenerFns.push(this._platformLocation.onPopState(H),this._platformLocation.onHashChange(H))}getBaseHref(){return this._baseHref}path(H=!1){let Se=this._platformLocation.hash;return null==Se&&(Se="#"),Se.length>0?Se.substring(1):Se}prepareExternalUrl(H){const Se=pe(this._baseHref,H);return Se.length>0?"#"+Se:Se}pushState(H,Se,ht,hn){let Dn=this.prepareExternalUrl(ht+ce(hn));0==Dn.length&&(Dn=this._platformLocation.pathname),this._platformLocation.pushState(H,Se,Dn)}replaceState(H,Se,ht,hn){let Dn=this.prepareExternalUrl(ht+ce(hn));0==Dn.length&&(Dn=this._platformLocation.pathname),this._platformLocation.replaceState(H,Se,Dn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(H=0){this._platformLocation.historyGo?.(H)}}return U.\u0275fac=function(H){return new(H||U)(d.LFG(b),d.LFG(Pe,8))},U.\u0275prov=d.Yz7({token:U,factory:U.\u0275fac}),U})(),Pt=(()=>{class U{constructor(H){this._subject=new d.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=H;const Se=this._locationStrategy.getBaseHref();this._basePath=function Le(U){if(new RegExp("^(https?:)?//").test(U)){const[,H]=U.split(/\/\/[^\/]+/);return H}return U}(ze(ke(Se))),this._locationStrategy.onPopState(ht=>{this._subject.emit({url:this.path(!0),pop:!0,state:ht.state,type:ht.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(H=!1){return this.normalize(this._locationStrategy.path(H))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(H,Se=""){return this.path()==this.normalize(H+ce(Se))}normalize(H){return U.stripTrailingSlash(function ge(U,le){if(!U||!le.startsWith(U))return le;const H=le.substring(U.length);return""===H||["/",";","?","#"].includes(H[0])?H:le}(this._basePath,ke(H)))}prepareExternalUrl(H){return H&&"/"!==H[0]&&(H="/"+H),this._locationStrategy.prepareExternalUrl(H)}go(H,Se="",ht=null){this._locationStrategy.pushState(ht,"",H,Se),this._notifyUrlChangeListeners(this.prepareExternalUrl(H+ce(Se)),ht)}replaceState(H,Se="",ht=null){this._locationStrategy.replaceState(ht,"",H,Se),this._notifyUrlChangeListeners(this.prepareExternalUrl(H+ce(Se)),ht)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(H=0){this._locationStrategy.historyGo?.(H)}onUrlChange(H){return this._urlChangeListeners.push(H),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(Se=>{this._notifyUrlChangeListeners(Se.url,Se.state)})),()=>{const Se=this._urlChangeListeners.indexOf(H);this._urlChangeListeners.splice(Se,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(H="",Se){this._urlChangeListeners.forEach(ht=>ht(H,Se))}subscribe(H,Se,ht){return this._subject.subscribe({next:H,error:Se,complete:ht})}}return U.normalizeQueryParams=ce,U.joinWithSlash=pe,U.stripTrailingSlash=ze,U.\u0275fac=function(H){return new(H||U)(d.LFG(Ke))},U.\u0275prov=d.Yz7({token:U,factory:function(){return function at(){return new Pt((0,d.LFG)(Ke))}()},providedIn:"root"}),U})();function ke(U){return U.replace(/\/index.html$/,"")}var Xe=(()=>((Xe=Xe||{})[Xe.Decimal=0]="Decimal",Xe[Xe.Percent=1]="Percent",Xe[Xe.Currency=2]="Currency",Xe[Xe.Scientific=3]="Scientific",Xe))(),me=(()=>((me=me||{})[me.Format=0]="Format",me[me.Standalone=1]="Standalone",me))(),de=(()=>((de=de||{})[de.Narrow=0]="Narrow",de[de.Abbreviated=1]="Abbreviated",de[de.Wide=2]="Wide",de[de.Short=3]="Short",de))(),se=(()=>((se=se||{})[se.Short=0]="Short",se[se.Medium=1]="Medium",se[se.Long=2]="Long",se[se.Full=3]="Full",se))(),Ee=(()=>((Ee=Ee||{})[Ee.Decimal=0]="Decimal",Ee[Ee.Group=1]="Group",Ee[Ee.List=2]="List",Ee[Ee.PercentSign=3]="PercentSign",Ee[Ee.PlusSign=4]="PlusSign",Ee[Ee.MinusSign=5]="MinusSign",Ee[Ee.Exponential=6]="Exponential",Ee[Ee.SuperscriptingExponent=7]="SuperscriptingExponent",Ee[Ee.PerMille=8]="PerMille",Ee[Ee.Infinity=9]="Infinity",Ee[Ee.NaN=10]="NaN",Ee[Ee.TimeSeparator=11]="TimeSeparator",Ee[Ee.CurrencyDecimal=12]="CurrencyDecimal",Ee[Ee.CurrencyGroup=13]="CurrencyGroup",Ee))();function lt(U,le){return hi((0,d.cg1)(U)[d.wAp.DateFormat],le)}function Ce(U,le){return hi((0,d.cg1)(U)[d.wAp.TimeFormat],le)}function bt(U,le){return hi((0,d.cg1)(U)[d.wAp.DateTimeFormat],le)}function kt(U,le){const H=(0,d.cg1)(U),Se=H[d.wAp.NumberSymbols][le];if(typeof Se>"u"){if(le===Ee.CurrencyDecimal)return H[d.wAp.NumberSymbols][Ee.Decimal];if(le===Ee.CurrencyGroup)return H[d.wAp.NumberSymbols][Ee.Group]}return Se}function Sn(U){if(!U[d.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${U[d.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function hi(U,le){for(let H=le;H>-1;H--)if(typeof U[H]<"u")return U[H];throw new Error("Locale data API: locale data undefined")}function Ii(U){const[le,H]=U.split(":");return{hours:+le,minutes:+H}}const Ni=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Ki={},Vt=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var Mt=(()=>((Mt=Mt||{})[Mt.Short=0]="Short",Mt[Mt.ShortGMT=1]="ShortGMT",Mt[Mt.Long=2]="Long",Mt[Mt.Extended=3]="Extended",Mt))(),Ge=(()=>((Ge=Ge||{})[Ge.FullYear=0]="FullYear",Ge[Ge.Month=1]="Month",Ge[Ge.Date=2]="Date",Ge[Ge.Hours=3]="Hours",Ge[Ge.Minutes=4]="Minutes",Ge[Ge.Seconds=5]="Seconds",Ge[Ge.FractionalSeconds=6]="FractionalSeconds",Ge[Ge.Day=7]="Day",Ge))(),ie=(()=>((ie=ie||{})[ie.DayPeriods=0]="DayPeriods",ie[ie.Days=1]="Days",ie[ie.Months=2]="Months",ie[ie.Eras=3]="Eras",ie))();function Qe(U,le,H,Se){let ht=function De(U){if(dt(U))return U;if("number"==typeof U&&!isNaN(U))return new Date(U);if("string"==typeof U){if(U=U.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(U)){const[ht,hn=1,Dn=1]=U.split("-").map(ai=>+ai);return Wt(ht,hn-1,Dn)}const H=parseFloat(U);if(!isNaN(U-H))return new Date(H);let Se;if(Se=U.match(Ni))return function Ze(U){const le=new Date(0);let H=0,Se=0;const ht=U[8]?le.setUTCFullYear:le.setFullYear,hn=U[8]?le.setUTCHours:le.setHours;U[9]&&(H=Number(U[9]+U[10]),Se=Number(U[9]+U[11])),ht.call(le,Number(U[1]),Number(U[2])-1,Number(U[3]));const Dn=Number(U[4]||0)-H,ai=Number(U[5]||0)-Se,Hi=Number(U[6]||0),tr=Math.floor(1e3*parseFloat("0."+(U[7]||0)));return hn.call(le,Dn,ai,Hi,tr),le}(Se)}const le=new Date(U);if(!dt(le))throw new Error(`Unable to convert "${U}" into a date`);return le}(U);le=rn(H,le)||le;let ai,Dn=[];for(;le;){if(ai=Vt.exec(le),!ai){Dn.push(le);break}{Dn=Dn.concat(ai.slice(1));const or=Dn.pop();if(!or)break;le=or}}let Hi=ht.getTimezoneOffset();Se&&(Hi=z(Se,Hi),ht=function X(U,le,H){const Se=H?-1:1,ht=U.getTimezoneOffset();return function k(U,le){return(U=new Date(U.getTime())).setMinutes(U.getMinutes()+le),U}(U,Se*(z(le,ht)-ht))}(ht,Se,!0));let tr="";return Dn.forEach(or=>{const Yi=function Ht(U){if(Ue[U])return Ue[U];let le;switch(U){case"G":case"GG":case"GGG":le=Si(ie.Eras,de.Abbreviated);break;case"GGGG":le=Si(ie.Eras,de.Wide);break;case"GGGGG":le=Si(ie.Eras,de.Narrow);break;case"y":le=pi(Ge.FullYear,1,0,!1,!0);break;case"yy":le=pi(Ge.FullYear,2,0,!0,!0);break;case"yyy":le=pi(Ge.FullYear,3,0,!1,!0);break;case"yyyy":le=pi(Ge.FullYear,4,0,!1,!0);break;case"Y":le=_n(1);break;case"YY":le=_n(2,!0);break;case"YYY":le=_n(3);break;case"YYYY":le=_n(4);break;case"M":case"L":le=pi(Ge.Month,1,1);break;case"MM":case"LL":le=pi(Ge.Month,2,1);break;case"MMM":le=Si(ie.Months,de.Abbreviated);break;case"MMMM":le=Si(ie.Months,de.Wide);break;case"MMMMM":le=Si(ie.Months,de.Narrow);break;case"LLL":le=Si(ie.Months,de.Abbreviated,me.Standalone);break;case"LLLL":le=Si(ie.Months,de.Wide,me.Standalone);break;case"LLLLL":le=Si(ie.Months,de.Narrow,me.Standalone);break;case"w":le=Rt(1);break;case"ww":le=Rt(2);break;case"W":le=Rt(1,!0);break;case"d":le=pi(Ge.Date,1);break;case"dd":le=pi(Ge.Date,2);break;case"c":case"cc":le=pi(Ge.Day,1);break;case"ccc":le=Si(ie.Days,de.Abbreviated,me.Standalone);break;case"cccc":le=Si(ie.Days,de.Wide,me.Standalone);break;case"ccccc":le=Si(ie.Days,de.Narrow,me.Standalone);break;case"cccccc":le=Si(ie.Days,de.Short,me.Standalone);break;case"E":case"EE":case"EEE":le=Si(ie.Days,de.Abbreviated);break;case"EEEE":le=Si(ie.Days,de.Wide);break;case"EEEEE":le=Si(ie.Days,de.Narrow);break;case"EEEEEE":le=Si(ie.Days,de.Short);break;case"a":case"aa":case"aaa":le=Si(ie.DayPeriods,de.Abbreviated);break;case"aaaa":le=Si(ie.DayPeriods,de.Wide);break;case"aaaaa":le=Si(ie.DayPeriods,de.Narrow);break;case"b":case"bb":case"bbb":le=Si(ie.DayPeriods,de.Abbreviated,me.Standalone,!0);break;case"bbbb":le=Si(ie.DayPeriods,de.Wide,me.Standalone,!0);break;case"bbbbb":le=Si(ie.DayPeriods,de.Narrow,me.Standalone,!0);break;case"B":case"BB":case"BBB":le=Si(ie.DayPeriods,de.Abbreviated,me.Format,!0);break;case"BBBB":le=Si(ie.DayPeriods,de.Wide,me.Format,!0);break;case"BBBBB":le=Si(ie.DayPeriods,de.Narrow,me.Format,!0);break;case"h":le=pi(Ge.Hours,1,-12);break;case"hh":le=pi(Ge.Hours,2,-12);break;case"H":le=pi(Ge.Hours,1);break;case"HH":le=pi(Ge.Hours,2);break;case"m":le=pi(Ge.Minutes,1);break;case"mm":le=pi(Ge.Minutes,2);break;case"s":le=pi(Ge.Seconds,1);break;case"ss":le=pi(Ge.Seconds,2);break;case"S":le=pi(Ge.FractionalSeconds,1);break;case"SS":le=pi(Ge.FractionalSeconds,2);break;case"SSS":le=pi(Ge.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":le=xr(Mt.Short);break;case"ZZZZZ":le=xr(Mt.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":le=xr(Mt.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":le=xr(Mt.Long);break;default:return null}return Ue[U]=le,le}(or);tr+=Yi?Yi(ht,H,Hi):"''"===or?"'":or.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),tr}function Wt(U,le,H){const Se=new Date(0);return Se.setFullYear(U,le,H),Se.setHours(0,0,0),Se}function rn(U,le){const H=function It(U){return(0,d.cg1)(U)[d.wAp.LocaleId]}(U);if(Ki[H]=Ki[H]||{},Ki[H][le])return Ki[H][le];let Se="";switch(le){case"shortDate":Se=lt(U,se.Short);break;case"mediumDate":Se=lt(U,se.Medium);break;case"longDate":Se=lt(U,se.Long);break;case"fullDate":Se=lt(U,se.Full);break;case"shortTime":Se=Ce(U,se.Short);break;case"mediumTime":Se=Ce(U,se.Medium);break;case"longTime":Se=Ce(U,se.Long);break;case"fullTime":Se=Ce(U,se.Full);break;case"short":const ht=rn(U,"shortTime"),hn=rn(U,"shortDate");Se=oi(bt(U,se.Short),[ht,hn]);break;case"medium":const Dn=rn(U,"mediumTime"),ai=rn(U,"mediumDate");Se=oi(bt(U,se.Medium),[Dn,ai]);break;case"long":const Hi=rn(U,"longTime"),tr=rn(U,"longDate");Se=oi(bt(U,se.Long),[Hi,tr]);break;case"full":const or=rn(U,"fullTime"),Yi=rn(U,"fullDate");Se=oi(bt(U,se.Full),[or,Yi])}return Se&&(Ki[H][le]=Se),Se}function oi(U,le){return le&&(U=U.replace(/\{([^}]+)}/g,function(H,Se){return null!=le&&Se in le?le[Se]:H})),U}function Di(U,le,H="-",Se,ht){let hn="";(U<0||ht&&U<=0)&&(ht?U=1-U:(U=-U,hn=H));let Dn=String(U);for(;Dn.length<le;)Dn="0"+Dn;return Se&&(Dn=Dn.slice(Dn.length-le)),hn+Dn}function pi(U,le,H=0,Se=!1,ht=!1){return function(hn,Dn){let ai=function mr(U,le){switch(U){case Ge.FullYear:return le.getFullYear();case Ge.Month:return le.getMonth();case Ge.Date:return le.getDate();case Ge.Hours:return le.getHours();case Ge.Minutes:return le.getMinutes();case Ge.Seconds:return le.getSeconds();case Ge.FractionalSeconds:return le.getMilliseconds();case Ge.Day:return le.getDay();default:throw new Error(`Unknown DateType value "${U}".`)}}(U,hn);if((H>0||ai>-H)&&(ai+=H),U===Ge.Hours)0===ai&&-12===H&&(ai=12);else if(U===Ge.FractionalSeconds)return function ar(U,le){return Di(U,3).substring(0,le)}(ai,le);const Hi=kt(Dn,Ee.MinusSign);return Di(ai,le,Hi,Se,ht)}}function Si(U,le,H=me.Format,Se=!1){return function(ht,hn){return function vr(U,le,H,Se,ht,hn){switch(H){case ie.Months:return function yt(U,le,H){const Se=(0,d.cg1)(U),hn=hi([Se[d.wAp.MonthsFormat],Se[d.wAp.MonthsStandalone]],le);return hi(hn,H)}(le,ht,Se)[U.getMonth()];case ie.Days:return function Lt(U,le,H){const Se=(0,d.cg1)(U),hn=hi([Se[d.wAp.DaysFormat],Se[d.wAp.DaysStandalone]],le);return hi(hn,H)}(le,ht,Se)[U.getDay()];case ie.DayPeriods:const Dn=U.getHours(),ai=U.getMinutes();if(hn){const tr=function Qn(U){const le=(0,d.cg1)(U);return Sn(le),(le[d.wAp.ExtraData][2]||[]).map(Se=>"string"==typeof Se?Ii(Se):[Ii(Se[0]),Ii(Se[1])])}(le),or=function ci(U,le,H){const Se=(0,d.cg1)(U);Sn(Se);const hn=hi([Se[d.wAp.ExtraData][0],Se[d.wAp.ExtraData][1]],le)||[];return hi(hn,H)||[]}(le,ht,Se),Yi=tr.findIndex(Br=>{if(Array.isArray(Br)){const[Cr,zn]=Br,vo=Dn>=Cr.hours&&ai>=Cr.minutes,qs=Dn<zn.hours||Dn===zn.hours&&ai<zn.minutes;if(Cr.hours<zn.hours){if(vo&&qs)return!0}else if(vo||qs)return!0}else if(Br.hours===Dn&&Br.minutes===ai)return!0;return!1});if(-1!==Yi)return or[Yi]}return function Gt(U,le,H){const Se=(0,d.cg1)(U),hn=hi([Se[d.wAp.DayPeriodsFormat],Se[d.wAp.DayPeriodsStandalone]],le);return hi(hn,H)}(le,ht,Se)[Dn<12?0:1];case ie.Eras:return function St(U,le){return hi((0,d.cg1)(U)[d.wAp.Eras],le)}(le,Se)[U.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${H}`)}}(ht,hn,U,le,H,Se)}}function xr(U){return function(le,H,Se){const ht=-1*Se,hn=kt(H,Ee.MinusSign),Dn=ht>0?Math.floor(ht/60):Math.ceil(ht/60);switch(U){case Mt.Short:return(ht>=0?"+":"")+Di(Dn,2,hn)+Di(Math.abs(ht%60),2,hn);case Mt.ShortGMT:return"GMT"+(ht>=0?"+":"")+Di(Dn,1,hn);case Mt.Long:return"GMT"+(ht>=0?"+":"")+Di(Dn,2,hn)+":"+Di(Math.abs(ht%60),2,hn);case Mt.Extended:return 0===Se?"Z":(ht>=0?"+":"")+Di(Dn,2,hn)+":"+Di(Math.abs(ht%60),2,hn);default:throw new Error(`Unknown zone width "${U}"`)}}}const gr=0,ui=4;function wt(U){return Wt(U.getFullYear(),U.getMonth(),U.getDate()+(ui-U.getDay()))}function Rt(U,le=!1){return function(H,Se){let ht;if(le){const hn=new Date(H.getFullYear(),H.getMonth(),1).getDay()-1,Dn=H.getDate();ht=1+Math.floor((Dn+hn)/7)}else{const hn=wt(H),Dn=function pn(U){const le=Wt(U,gr,1).getDay();return Wt(U,0,1+(le<=ui?ui:ui+7)-le)}(hn.getFullYear()),ai=hn.getTime()-Dn.getTime();ht=1+Math.round(ai/6048e5)}return Di(ht,U,kt(Se,Ee.MinusSign))}}function _n(U,le=!1){return function(H,Se){return Di(wt(H).getFullYear(),U,kt(Se,Ee.MinusSign),le)}}const Ue={};function z(U,le){U=U.replace(/:/g,"");const H=Date.parse("Jan 01, 1970 00:00:00 "+U)/6e4;return isNaN(H)?le:H}function dt(U){return U instanceof Date&&!isNaN(U.valueOf())}const Ot=/^(\d+)?\.((\d+)(-(\d+))?)?$/,vt=22,ut=".",Fe="0",Be=";",Me=",",We="#";function Gr(U){const le=parseInt(U);if(isNaN(le))throw new Error("Invalid integer literal when parsing "+U);return le}function fo(U,le){le=encodeURIComponent(le);for(const H of U.split(";")){const Se=H.indexOf("="),[ht,hn]=-1==Se?[H,""]:[H.slice(0,Se),H.slice(Se+1)];if(ht.trim()===le)return decodeURIComponent(hn)}return null}class En{constructor(le,H,Se,ht){this.$implicit=le,this.ngForOf=H,this.index=Se,this.count=ht}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let fe=(()=>{class U{set ngForOf(H){this._ngForOf=H,this._ngForOfDirty=!0}set ngForTrackBy(H){this._trackByFn=H}get ngForTrackBy(){return this._trackByFn}constructor(H,Se,ht){this._viewContainer=H,this._template=Se,this._differs=ht,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(H){H&&(this._template=H)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const H=this._ngForOf;!this._differ&&H&&(this._differ=this._differs.find(H).create(this.ngForTrackBy))}if(this._differ){const H=this._differ.diff(this._ngForOf);H&&this._applyChanges(H)}}_applyChanges(H){const Se=this._viewContainer;H.forEachOperation((ht,hn,Dn)=>{if(null==ht.previousIndex)Se.createEmbeddedView(this._template,new En(ht.item,this._ngForOf,-1,-1),null===Dn?void 0:Dn);else if(null==Dn)Se.remove(null===hn?void 0:hn);else if(null!==hn){const ai=Se.get(hn);Se.move(ai,Dn),$e(ai,ht)}});for(let ht=0,hn=Se.length;ht<hn;ht++){const ai=Se.get(ht).context;ai.index=ht,ai.count=hn,ai.ngForOf=this._ngForOf}H.forEachIdentityChange(ht=>{$e(Se.get(ht.currentIndex),ht)})}static ngTemplateContextGuard(H,Se){return!0}}return U.\u0275fac=function(H){return new(H||U)(d.Y36(d.s_b),d.Y36(d.Rgc),d.Y36(d.ZZ4))},U.\u0275dir=d.lG2({type:U,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0}),U})();function $e(U,le){U.context.$implicit=le.item}let zt=(()=>{class U{constructor(H,Se){this._viewContainer=H,this._context=new en,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=Se}set ngIf(H){this._context.$implicit=this._context.ngIf=H,this._updateView()}set ngIfThen(H){je("ngIfThen",H),this._thenTemplateRef=H,this._thenViewRef=null,this._updateView()}set ngIfElse(H){je("ngIfElse",H),this._elseTemplateRef=H,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(H,Se){return!0}}return U.\u0275fac=function(H){return new(H||U)(d.Y36(d.s_b),d.Y36(d.Rgc))},U.\u0275dir=d.lG2({type:U,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0}),U})();class en{constructor(){this.$implicit=null,this.ngIf=null}}function je(U,le){if(le&&!le.createEmbeddedView)throw new Error(`${U} must be a TemplateRef, but received '${(0,d.AaK)(le)}'.`)}let Vi=(()=>{class U{constructor(H){this._viewContainerRef=H,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(H){if(H.ngTemplateOutlet||H.ngTemplateOutletInjector){const Se=this._viewContainerRef;if(this._viewRef&&Se.remove(Se.indexOf(this._viewRef)),this.ngTemplateOutlet){const{ngTemplateOutlet:ht,ngTemplateOutletContext:hn,ngTemplateOutletInjector:Dn}=this;this._viewRef=Se.createEmbeddedView(ht,hn,Dn?{injector:Dn}:void 0)}else this._viewRef=null}else this._viewRef&&H.ngTemplateOutletContext&&this.ngTemplateOutletContext&&(this._viewRef.context=this.ngTemplateOutletContext)}}return U.\u0275fac=function(H){return new(H||U)(d.Y36(d.s_b))},U.\u0275dir=d.lG2({type:U,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[d.TTD]}),U})();function Qi(U,le){return new d.vHH(2100,!1)}const Ur=new d.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),ca=new d.OlP("DATE_PIPE_DEFAULT_OPTIONS");let Wr=(()=>{class U{constructor(H,Se,ht){this.locale=H,this.defaultTimezone=Se,this.defaultOptions=ht}transform(H,Se,ht,hn){if(null==H||""===H||H!=H)return null;try{return Qe(H,Se??this.defaultOptions?.dateFormat??"mediumDate",hn||this.locale,ht??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(Dn){throw Qi()}}}return U.\u0275fac=function(H){return new(H||U)(d.Y36(d.soG,16),d.Y36(Ur,24),d.Y36(ca,24))},U.\u0275pipe=d.Yjl({name:"date",type:U,pure:!0,standalone:!0}),U})(),Co=(()=>{class U{constructor(H){this._locale=H}transform(H,Se,ht){if(!function zo(U){return!(null==U||""===U||U!=U)}(H))return null;ht=ht||this._locale;try{return function mi(U,le,H){return function Tn(U,le,H,Se,ht,hn,Dn=!1){let ai="",Hi=!1;if(isFinite(U)){let tr=function Li(U){let Se,ht,hn,Dn,ai,le=Math.abs(U)+"",H=0;for((ht=le.indexOf(ut))>-1&&(le=le.replace(ut,"")),(hn=le.search(/e/i))>0?(ht<0&&(ht=hn),ht+=+le.slice(hn+1),le=le.substring(0,hn)):ht<0&&(ht=le.length),hn=0;le.charAt(hn)===Fe;hn++);if(hn===(ai=le.length))Se=[0],ht=1;else{for(ai--;le.charAt(ai)===Fe;)ai--;for(ht-=hn,Se=[],Dn=0;hn<=ai;hn++,Dn++)Se[Dn]=Number(le.charAt(hn))}return ht>vt&&(Se=Se.splice(0,vt-1),H=ht-1,ht=1),{digits:Se,exponent:H,integerLen:ht}}(U);Dn&&(tr=function Oi(U){if(0===U.digits[0])return U;const le=U.digits.length-U.integerLen;return U.exponent?U.exponent+=2:(0===le?U.digits.push(0,0):1===le&&U.digits.push(0),U.integerLen+=2),U}(tr));let or=le.minInt,Yi=le.minFrac,Br=le.maxFrac;if(hn){const Ho=hn.match(Ot);if(null===Ho)throw new Error(`${hn} is not a valid digit info`);const Ys=Ho[1],Wa=Ho[3],Ls=Ho[5];null!=Ys&&(or=Gr(Ys)),null!=Wa&&(Yi=Gr(Wa)),null!=Ls?Br=Gr(Ls):null!=Wa&&Yi>Br&&(Br=Yi)}!function Er(U,le,H){if(le>H)throw new Error(`The minimum number of digits after fraction (${le}) is higher than the maximum (${H}).`);let Se=U.digits,ht=Se.length-U.integerLen;const hn=Math.min(Math.max(le,ht),H);let Dn=hn+U.integerLen,ai=Se[Dn];if(Dn>0){Se.splice(Math.max(U.integerLen,Dn));for(let Yi=Dn;Yi<Se.length;Yi++)Se[Yi]=0}else{ht=Math.max(0,ht),U.integerLen=1,Se.length=Math.max(1,Dn=hn+1),Se[0]=0;for(let Yi=1;Yi<Dn;Yi++)Se[Yi]=0}if(ai>=5)if(Dn-1<0){for(let Yi=0;Yi>Dn;Yi--)Se.unshift(0),U.integerLen++;Se.unshift(1),U.integerLen++}else Se[Dn-1]++;for(;ht<Math.max(0,hn);ht++)Se.push(0);let Hi=0!==hn;const tr=le+U.integerLen,or=Se.reduceRight(function(Yi,Br,Cr,zn){return zn[Cr]=(Br+=Yi)<10?Br:Br-10,Hi&&(0===zn[Cr]&&Cr>=tr?zn.pop():Hi=!1),Br>=10?1:0},0);or&&(Se.unshift(or),U.integerLen++)}(tr,Yi,Br);let Cr=tr.digits,zn=tr.integerLen;const vo=tr.exponent;let qs=[];for(Hi=Cr.every(Ho=>!Ho);zn<or;zn++)Cr.unshift(0);for(;zn<0;zn++)Cr.unshift(0);zn>0?qs=Cr.splice(zn,Cr.length):(qs=Cr,Cr=[0]);const _a=[];for(Cr.length>=le.lgSize&&_a.unshift(Cr.splice(-le.lgSize,Cr.length).join(""));Cr.length>le.gSize;)_a.unshift(Cr.splice(-le.gSize,Cr.length).join(""));Cr.length&&_a.unshift(Cr.join("")),ai=_a.join(kt(H,Se)),qs.length&&(ai+=kt(H,ht)+qs.join("")),vo&&(ai+=kt(H,Ee.Exponential)+"+"+vo)}else ai=kt(H,Ee.Infinity);return ai=U<0&&!Hi?le.negPre+ai+le.negSuf:le.posPre+ai+le.posSuf,ai}(U,function ei(U,le="-"){const H={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},Se=U.split(Be),ht=Se[0],hn=Se[1],Dn=-1!==ht.indexOf(ut)?ht.split(ut):[ht.substring(0,ht.lastIndexOf(Fe)+1),ht.substring(ht.lastIndexOf(Fe)+1)],ai=Dn[0],Hi=Dn[1]||"";H.posPre=ai.substring(0,ai.indexOf(We));for(let or=0;or<Hi.length;or++){const Yi=Hi.charAt(or);Yi===Fe?H.minFrac=H.maxFrac=or+1:Yi===We?H.maxFrac=or+1:H.posSuf+=Yi}const tr=ai.split(Me);if(H.gSize=tr[1]?tr[1].length:0,H.lgSize=tr[2]||tr[1]?(tr[2]||tr[1]).length:0,hn){const or=ht.length-H.posPre.length-H.posSuf.length,Yi=hn.indexOf(We);H.negPre=hn.substring(0,Yi).replace(/'/g,""),H.negSuf=hn.slice(Yi+or).replace(/'/g,"")}else H.negPre=le+H.posPre,H.negSuf=H.posSuf;return H}(function Ut(U,le){return(0,d.cg1)(U)[d.wAp.NumberFormats][le]}(le,Xe.Decimal),kt(le,Ee.MinusSign)),le,Ee.Group,Ee.Decimal,H)}(function ps(U){if("string"==typeof U&&!isNaN(Number(U)-parseFloat(U)))return Number(U);if("number"!=typeof U)throw new Error(`${U} is not a number`);return U}(H),ht,Se)}catch(hn){throw Qi()}}}return U.\u0275fac=function(H){return new(H||U)(d.Y36(d.soG,16))},U.\u0275pipe=d.Yjl({name:"number",type:U,pure:!0,standalone:!0}),U})();let Ms=(()=>{class U{}return U.\u0275fac=function(H){return new(H||U)},U.\u0275mod=d.oAB({type:U}),U.\u0275inj=d.cJS({}),U})();const go="browser";let Sa=(()=>{class U{}return U.\u0275prov=(0,d.Yz7)({token:U,providedIn:"root",factory:()=>new As((0,d.LFG)(oe),window)}),U})();class As{constructor(le,H){this.document=le,this.window=H,this.offset=()=>[0,0]}setOffset(le){this.offset=Array.isArray(le)?()=>le:le}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(le){this.supportsScrolling()&&this.window.scrollTo(le[0],le[1])}scrollToAnchor(le){if(!this.supportsScrolling())return;const H=function $s(U,le){const H=U.getElementById(le)||U.getElementsByName(le)[0];if(H)return H;if("function"==typeof U.createTreeWalker&&U.body&&(U.body.createShadowRoot||U.body.attachShadow)){const Se=U.createTreeWalker(U.body,NodeFilter.SHOW_ELEMENT);let ht=Se.currentNode;for(;ht;){const hn=ht.shadowRoot;if(hn){const Dn=hn.getElementById(le)||hn.querySelector(`[name="${le}"]`);if(Dn)return Dn}ht=Se.nextNode()}}return null}(this.document,le);H&&(this.scrollToElement(H),H.focus())}setHistoryScrollRestoration(le){if(this.supportScrollRestoration()){const H=this.window.history;H&&H.scrollRestoration&&(H.scrollRestoration=le)}}scrollToElement(le){const H=le.getBoundingClientRect(),Se=H.left+this.window.pageXOffset,ht=H.top+this.window.pageYOffset,hn=this.offset();this.window.scrollTo(Se-hn[0],ht-hn[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const le=Mo(this.window.history)||Mo(Object.getPrototypeOf(this.window.history));return!(!le||!le.writable&&!le.set)}catch{return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch{return!1}}}function Mo(U){return Object.getOwnPropertyDescriptor(U,"scrollRestoration")}class ji{}},529:(Ln,Dt,F)=>{"use strict";F.d(Dt,{JF:()=>xr,TP:()=>St,WM:()=>Ve,eN:()=>It});var d=F(6895),v=F(8274),re=F(9646),a=F(9751),q=F(4351),oe=F(9300),b=F(4004);class he{}class Ie{}class Ve{constructor(wt){this.normalizedNames=new Map,this.lazyUpdate=null,wt?this.lazyInit="string"==typeof wt?()=>{this.headers=new Map,wt.split("\n").forEach(Rt=>{const _n=Rt.indexOf(":");if(_n>0){const Ue=Rt.slice(0,_n),Ht=Ue.toLowerCase(),z=Rt.slice(_n+1).trim();this.maybeSetNormalizedName(Ue,Ht),this.headers.has(Ht)?this.headers.get(Ht).push(z):this.headers.set(Ht,[z])}})}:()=>{this.headers=new Map,Object.keys(wt).forEach(Rt=>{let _n=wt[Rt];const Ue=Rt.toLowerCase();"string"==typeof _n&&(_n=[_n]),_n.length>0&&(this.headers.set(Ue,_n),this.maybeSetNormalizedName(Rt,Ue))})}:this.headers=new Map}has(wt){return this.init(),this.headers.has(wt.toLowerCase())}get(wt){this.init();const Rt=this.headers.get(wt.toLowerCase());return Rt&&Rt.length>0?Rt[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(wt){return this.init(),this.headers.get(wt.toLowerCase())||null}append(wt,Rt){return this.clone({name:wt,value:Rt,op:"a"})}set(wt,Rt){return this.clone({name:wt,value:Rt,op:"s"})}delete(wt,Rt){return this.clone({name:wt,value:Rt,op:"d"})}maybeSetNormalizedName(wt,Rt){this.normalizedNames.has(Rt)||this.normalizedNames.set(Rt,wt)}init(){this.lazyInit&&(this.lazyInit instanceof Ve?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(wt=>this.applyUpdate(wt)),this.lazyUpdate=null))}copyFrom(wt){wt.init(),Array.from(wt.headers.keys()).forEach(Rt=>{this.headers.set(Rt,wt.headers.get(Rt)),this.normalizedNames.set(Rt,wt.normalizedNames.get(Rt))})}clone(wt){const Rt=new Ve;return Rt.lazyInit=this.lazyInit&&this.lazyInit instanceof Ve?this.lazyInit:this,Rt.lazyUpdate=(this.lazyUpdate||[]).concat([wt]),Rt}applyUpdate(wt){const Rt=wt.name.toLowerCase();switch(wt.op){case"a":case"s":let _n=wt.value;if("string"==typeof _n&&(_n=[_n]),0===_n.length)return;this.maybeSetNormalizedName(wt.name,Rt);const Ue=("a"===wt.op?this.headers.get(Rt):void 0)||[];Ue.push(..._n),this.headers.set(Rt,Ue);break;case"d":const Ht=wt.value;if(Ht){let z=this.headers.get(Rt);if(!z)return;z=z.filter(k=>-1===Ht.indexOf(k)),0===z.length?(this.headers.delete(Rt),this.normalizedNames.delete(Rt)):this.headers.set(Rt,z)}else this.headers.delete(Rt),this.normalizedNames.delete(Rt)}}forEach(wt){this.init(),Array.from(this.normalizedNames.keys()).forEach(Rt=>wt(this.normalizedNames.get(Rt),this.headers.get(Rt)))}}class xe{encodeKey(wt){return Ke(wt)}encodeValue(wt){return Ke(wt)}decodeKey(wt){return decodeURIComponent(wt)}decodeValue(wt){return decodeURIComponent(wt)}}const ze=/%(\d[a-f0-9])/gi,ce={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ke(pn){return encodeURIComponent(pn).replace(ze,(wt,Rt)=>ce[Rt]??wt)}function Pe(pn){return`${pn}`}class ne{constructor(wt={}){if(this.updates=null,this.cloneFrom=null,this.encoder=wt.encoder||new xe,wt.fromString){if(wt.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function pe(pn,wt){const Rt=new Map;return pn.length>0&&pn.replace(/^\?/,"").split("&").forEach(Ue=>{const Ht=Ue.indexOf("="),[z,k]=-1==Ht?[wt.decodeKey(Ue),""]:[wt.decodeKey(Ue.slice(0,Ht)),wt.decodeValue(Ue.slice(Ht+1))],X=Rt.get(z)||[];X.push(k),Rt.set(z,X)}),Rt}(wt.fromString,this.encoder)}else wt.fromObject?(this.map=new Map,Object.keys(wt.fromObject).forEach(Rt=>{const _n=wt.fromObject[Rt],Ue=Array.isArray(_n)?_n.map(Pe):[Pe(_n)];this.map.set(Rt,Ue)})):this.map=null}has(wt){return this.init(),this.map.has(wt)}get(wt){this.init();const Rt=this.map.get(wt);return Rt?Rt[0]:null}getAll(wt){return this.init(),this.map.get(wt)||null}keys(){return this.init(),Array.from(this.map.keys())}append(wt,Rt){return this.clone({param:wt,value:Rt,op:"a"})}appendAll(wt){const Rt=[];return Object.keys(wt).forEach(_n=>{const Ue=wt[_n];Array.isArray(Ue)?Ue.forEach(Ht=>{Rt.push({param:_n,value:Ht,op:"a"})}):Rt.push({param:_n,value:Ue,op:"a"})}),this.clone(Rt)}set(wt,Rt){return this.clone({param:wt,value:Rt,op:"s"})}delete(wt,Rt){return this.clone({param:wt,value:Rt,op:"d"})}toString(){return this.init(),this.keys().map(wt=>{const Rt=this.encoder.encodeKey(wt);return this.map.get(wt).map(_n=>Rt+"="+this.encoder.encodeValue(_n)).join("&")}).filter(wt=>""!==wt).join("&")}clone(wt){const Rt=new ne({encoder:this.encoder});return Rt.cloneFrom=this.cloneFrom||this,Rt.updates=(this.updates||[]).concat(wt),Rt}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(wt=>this.map.set(wt,this.cloneFrom.map.get(wt))),this.updates.forEach(wt=>{switch(wt.op){case"a":case"s":const Rt=("a"===wt.op?this.map.get(wt.param):void 0)||[];Rt.push(Pe(wt.value)),this.map.set(wt.param,Rt);break;case"d":if(void 0===wt.value){this.map.delete(wt.param);break}{let _n=this.map.get(wt.param)||[];const Ue=_n.indexOf(Pe(wt.value));-1!==Ue&&_n.splice(Ue,1),_n.length>0?this.map.set(wt.param,_n):this.map.delete(wt.param)}}}),this.cloneFrom=this.updates=null)}}class Pt{constructor(){this.map=new Map}set(wt,Rt){return this.map.set(wt,Rt),this}get(wt){return this.map.has(wt)||this.map.set(wt,wt.defaultValue()),this.map.get(wt)}delete(wt){return this.map.delete(wt),this}has(wt){return this.map.has(wt)}keys(){return this.map.keys()}}function ge(pn){return typeof ArrayBuffer<"u"&&pn instanceof ArrayBuffer}function ke(pn){return typeof Blob<"u"&&pn instanceof Blob}function Le(pn){return typeof FormData<"u"&&pn instanceof FormData}class Xe{constructor(wt,Rt,_n,Ue){let Ht;if(this.url=Rt,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=wt.toUpperCase(),function at(pn){switch(pn){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||Ue?(this.body=void 0!==_n?_n:null,Ht=Ue):Ht=_n,Ht&&(this.reportProgress=!!Ht.reportProgress,this.withCredentials=!!Ht.withCredentials,Ht.responseType&&(this.responseType=Ht.responseType),Ht.headers&&(this.headers=Ht.headers),Ht.context&&(this.context=Ht.context),Ht.params&&(this.params=Ht.params)),this.headers||(this.headers=new Ve),this.context||(this.context=new Pt),this.params){const z=this.params.toString();if(0===z.length)this.urlWithParams=Rt;else{const k=Rt.indexOf("?");this.urlWithParams=Rt+(-1===k?"?":k<Rt.length-1?"&":"")+z}}else this.params=new ne,this.urlWithParams=Rt}serializeBody(){return null===this.body?null:ge(this.body)||ke(this.body)||Le(this.body)||function we(pn){return typeof URLSearchParams<"u"&&pn instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ne?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Le(this.body)?null:ke(this.body)?this.body.type||null:ge(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ne?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(wt={}){const Rt=wt.method||this.method,_n=wt.url||this.url,Ue=wt.responseType||this.responseType,Ht=void 0!==wt.body?wt.body:this.body,z=void 0!==wt.withCredentials?wt.withCredentials:this.withCredentials,k=void 0!==wt.reportProgress?wt.reportProgress:this.reportProgress;let X=wt.headers||this.headers,De=wt.params||this.params;const Ze=wt.context??this.context;return void 0!==wt.setHeaders&&(X=Object.keys(wt.setHeaders).reduce((dt,Ot)=>dt.set(Ot,wt.setHeaders[Ot]),X)),wt.setParams&&(De=Object.keys(wt.setParams).reduce((dt,Ot)=>dt.set(Ot,wt.setParams[Ot]),De)),new Xe(Rt,_n,Ht,{params:De,headers:X,context:Ze,reportProgress:k,responseType:Ue,withCredentials:z})}}var He=(()=>((He=He||{})[He.Sent=0]="Sent",He[He.UploadProgress=1]="UploadProgress",He[He.ResponseHeader=2]="ResponseHeader",He[He.DownloadProgress=3]="DownloadProgress",He[He.Response=4]="Response",He[He.User=5]="User",He))();class me{constructor(wt,Rt=200,_n="OK"){this.headers=wt.headers||new Ve,this.status=void 0!==wt.status?wt.status:Rt,this.statusText=wt.statusText||_n,this.url=wt.url||null,this.ok=this.status>=200&&this.status<300}}class de extends me{constructor(wt={}){super(wt),this.type=He.ResponseHeader}clone(wt={}){return new de({headers:wt.headers||this.headers,status:void 0!==wt.status?wt.status:this.status,statusText:wt.statusText||this.statusText,url:wt.url||this.url||void 0})}}class se extends me{constructor(wt={}){super(wt),this.type=He.Response,this.body=void 0!==wt.body?wt.body:null}clone(wt={}){return new se({body:void 0!==wt.body?wt.body:this.body,headers:wt.headers||this.headers,status:void 0!==wt.status?wt.status:this.status,statusText:wt.statusText||this.statusText,url:wt.url||this.url||void 0})}}class Ee extends me{constructor(wt){super(wt,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${wt.url||"(unknown url)"}`:`Http failure response for ${wt.url||"(unknown url)"}: ${wt.status} ${wt.statusText}`,this.error=wt.error||null}}function _t(pn,wt){return{body:wt,headers:pn.headers,context:pn.context,observe:pn.observe,params:pn.params,reportProgress:pn.reportProgress,responseType:pn.responseType,withCredentials:pn.withCredentials}}let It=(()=>{class pn{constructor(Rt){this.handler=Rt}request(Rt,_n,Ue={}){let Ht;if(Rt instanceof Xe)Ht=Rt;else{let X,De;X=Ue.headers instanceof Ve?Ue.headers:new Ve(Ue.headers),Ue.params&&(De=Ue.params instanceof ne?Ue.params:new ne({fromObject:Ue.params})),Ht=new Xe(Rt,_n,void 0!==Ue.body?Ue.body:null,{headers:X,context:Ue.context,params:De,reportProgress:Ue.reportProgress,responseType:Ue.responseType||"json",withCredentials:Ue.withCredentials})}const z=(0,re.of)(Ht).pipe((0,q.b)(X=>this.handler.handle(X)));if(Rt instanceof Xe||"events"===Ue.observe)return z;const k=z.pipe((0,oe.h)(X=>X instanceof se));switch(Ue.observe||"body"){case"body":switch(Ht.responseType){case"arraybuffer":return k.pipe((0,b.U)(X=>{if(null!==X.body&&!(X.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return X.body}));case"blob":return k.pipe((0,b.U)(X=>{if(null!==X.body&&!(X.body instanceof Blob))throw new Error("Response is not a Blob.");return X.body}));case"text":return k.pipe((0,b.U)(X=>{if(null!==X.body&&"string"!=typeof X.body)throw new Error("Response is not a string.");return X.body}));default:return k.pipe((0,b.U)(X=>X.body))}case"response":return k;default:throw new Error(`Unreachable: unhandled observe type ${Ue.observe}}`)}}delete(Rt,_n={}){return this.request("DELETE",Rt,_n)}get(Rt,_n={}){return this.request("GET",Rt,_n)}head(Rt,_n={}){return this.request("HEAD",Rt,_n)}jsonp(Rt,_n){return this.request("JSONP",Rt,{params:(new ne).append(_n,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Rt,_n={}){return this.request("OPTIONS",Rt,_n)}patch(Rt,_n,Ue={}){return this.request("PATCH",Rt,_t(Ue,_n))}post(Rt,_n,Ue={}){return this.request("POST",Rt,_t(Ue,_n))}put(Rt,_n,Ue={}){return this.request("PUT",Rt,_t(Ue,_n))}}return pn.\u0275fac=function(Rt){return new(Rt||pn)(v.LFG(he))},pn.\u0275prov=v.Yz7({token:pn,factory:pn.\u0275fac}),pn})();function Gt(pn,wt){return wt(pn)}function Lt(pn,wt){return(Rt,_n)=>wt.intercept(Rt,{handle:Ue=>pn(Ue,_n)})}const St=new v.OlP("HTTP_INTERCEPTORS"),xt=new v.OlP("HTTP_INTERCEPTOR_FNS");function rt(){let pn=null;return(wt,Rt)=>(null===pn&&(pn=((0,v.f3M)(St,{optional:!0})??[]).reduceRight(Lt,Gt)),pn(wt,Rt))}let lt=(()=>{class pn extends he{constructor(Rt,_n){super(),this.backend=Rt,this.injector=_n,this.chain=null}handle(Rt){if(null===this.chain){const _n=Array.from(new Set(this.injector.get(xt)));this.chain=_n.reduceRight((Ue,Ht)=>function yt(pn,wt,Rt){return(_n,Ue)=>Rt.runInContext(()=>wt(_n,Ht=>pn(Ht,Ue)))}(Ue,Ht,this.injector),Gt)}return this.chain(Rt,_n=>this.backend.handle(_n))}}return pn.\u0275fac=function(Rt){return new(Rt||pn)(v.LFG(Ie),v.LFG(v.lqb))},pn.\u0275prov=v.Yz7({token:pn,factory:pn.\u0275fac}),pn})();const ci=/^\)\]\}',?\n/;let hi=(()=>{class pn{constructor(Rt){this.xhrFactory=Rt}handle(Rt){if("JSONP"===Rt.method)throw new Error("Attempted to construct Jsonp request without HttpClientJsonpModule installed.");return new a.y(_n=>{const Ue=this.xhrFactory.build();if(Ue.open(Rt.method,Rt.urlWithParams),Rt.withCredentials&&(Ue.withCredentials=!0),Rt.headers.forEach((vt,ut)=>Ue.setRequestHeader(vt,ut.join(","))),Rt.headers.has("Accept")||Ue.setRequestHeader("Accept","application/json, text/plain, */*"),!Rt.headers.has("Content-Type")){const vt=Rt.detectContentTypeHeader();null!==vt&&Ue.setRequestHeader("Content-Type",vt)}if(Rt.responseType){const vt=Rt.responseType.toLowerCase();Ue.responseType="json"!==vt?vt:"text"}const Ht=Rt.serializeBody();let z=null;const k=()=>{if(null!==z)return z;const vt=Ue.statusText||"OK",ut=new Ve(Ue.getAllResponseHeaders()),Fe=function Un(pn){return"responseURL"in pn&&pn.responseURL?pn.responseURL:/^X-Request-URL:/m.test(pn.getAllResponseHeaders())?pn.getResponseHeader("X-Request-URL"):null}(Ue)||Rt.url;return z=new de({headers:ut,status:Ue.status,statusText:vt,url:Fe}),z},X=()=>{let{headers:vt,status:ut,statusText:Fe,url:Be}=k(),Me=null;204!==ut&&(Me=typeof Ue.response>"u"?Ue.responseText:Ue.response),0===ut&&(ut=Me?200:0);let We=ut>=200&&ut<300;if("json"===Rt.responseType&&"string"==typeof Me){const jt=Me;Me=Me.replace(ci,"");try{Me=""!==Me?JSON.parse(Me):null}catch(dn){Me=jt,We&&(We=!1,Me={error:dn,text:Me})}}We?(_n.next(new se({body:Me,headers:vt,status:ut,statusText:Fe,url:Be||void 0})),_n.complete()):_n.error(new Ee({error:Me,headers:vt,status:ut,statusText:Fe,url:Be||void 0}))},De=vt=>{const{url:ut}=k(),Fe=new Ee({error:vt,status:Ue.status||0,statusText:Ue.statusText||"Unknown Error",url:ut||void 0});_n.error(Fe)};let Ze=!1;const dt=vt=>{Ze||(_n.next(k()),Ze=!0);let ut={type:He.DownloadProgress,loaded:vt.loaded};vt.lengthComputable&&(ut.total=vt.total),"text"===Rt.responseType&&Ue.responseText&&(ut.partialText=Ue.responseText),_n.next(ut)},Ot=vt=>{let ut={type:He.UploadProgress,loaded:vt.loaded};vt.lengthComputable&&(ut.total=vt.total),_n.next(ut)};return Ue.addEventListener("load",X),Ue.addEventListener("error",De),Ue.addEventListener("timeout",De),Ue.addEventListener("abort",De),Rt.reportProgress&&(Ue.addEventListener("progress",dt),null!==Ht&&Ue.upload&&Ue.upload.addEventListener("progress",Ot)),Ue.send(Ht),_n.next({type:He.Sent}),()=>{Ue.removeEventListener("error",De),Ue.removeEventListener("abort",De),Ue.removeEventListener("load",X),Ue.removeEventListener("timeout",De),Rt.reportProgress&&(Ue.removeEventListener("progress",dt),null!==Ht&&Ue.upload&&Ue.upload.removeEventListener("progress",Ot)),Ue.readyState!==Ue.DONE&&Ue.abort()}})}}return pn.\u0275fac=function(Rt){return new(Rt||pn)(v.LFG(d.JF))},pn.\u0275prov=v.Yz7({token:pn,factory:pn.\u0275fac}),pn})();const Ii=new v.OlP("XSRF_ENABLED"),Bi=new v.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),Ni=new v.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class Ki{}let Vt=(()=>{class pn{constructor(Rt,_n,Ue){this.doc=Rt,this.platform=_n,this.cookieName=Ue,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Rt=this.doc.cookie||"";return Rt!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,d.Mx)(Rt,this.cookieName),this.lastCookieString=Rt),this.lastToken}}return pn.\u0275fac=function(Rt){return new(Rt||pn)(v.LFG(d.K0),v.LFG(v.Lbi),v.LFG(Bi))},pn.\u0275prov=v.Yz7({token:pn,factory:pn.\u0275fac}),pn})();function Mt(pn,wt){const Rt=pn.url.toLowerCase();if(!(0,v.f3M)(Ii)||"GET"===pn.method||"HEAD"===pn.method||Rt.startsWith("http://")||Rt.startsWith("https://"))return wt(pn);const _n=(0,v.f3M)(Ki).getToken(),Ue=(0,v.f3M)(Ni);return null!=_n&&!pn.headers.has(Ue)&&(pn=pn.clone({headers:pn.headers.set(Ue,_n)})),wt(pn)}var ie=(()=>((ie=ie||{})[ie.Interceptors=0]="Interceptors",ie[ie.LegacyInterceptors=1]="LegacyInterceptors",ie[ie.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",ie[ie.NoXsrfProtection=3]="NoXsrfProtection",ie[ie.JsonpSupport=4]="JsonpSupport",ie[ie.RequestsMadeViaParent=5]="RequestsMadeViaParent",ie))();function Qe(pn,wt){return{\u0275kind:pn,\u0275providers:wt}}function Wt(...pn){const wt=[It,hi,lt,{provide:he,useExisting:lt},{provide:Ie,useExisting:hi},{provide:xt,useValue:Mt,multi:!0},{provide:Ii,useValue:!0},{provide:Ki,useClass:Vt}];for(const Rt of pn)wt.push(...Rt.\u0275providers);return(0,v.MR2)(wt)}const oi=new v.OlP("LEGACY_INTERCEPTOR_FN");let xr=(()=>{class pn{}return pn.\u0275fac=function(Rt){return new(Rt||pn)},pn.\u0275mod=v.oAB({type:pn}),pn.\u0275inj=v.cJS({providers:[Wt(Qe(ie.LegacyInterceptors,[{provide:oi,useFactory:rt},{provide:xt,useExisting:oi,multi:!0}]))]}),pn})()},8274:(Ln,Dt,F)=>{"use strict";F.d(Dt,{tb:()=>p0,AFp:()=>u0,ip1:()=>c0,CZH:()=>Rg,hGG:()=>Tb,z2F:()=>Fg,sBO:()=>lb,Sil:()=>$1,_Vd:()=>Ts,EJc:()=>V1,Xts:()=>yh,SBq:()=>Rd,lqb:()=>vu,qLn:()=>Fd,vpe:()=>Kc,XFs:()=>Vt,OlP:()=>Pr,zs3:()=>zl,ZZ4:()=>Fy,aQg:()=>ky,soG:()=>Lg,YKP:()=>mv,h0i:()=>op,PXZ:()=>nb,R0b:()=>Hl,FiY:()=>ve,Lbi:()=>N1,g9A:()=>h0,Qsj:()=>Gu,FYo:()=>Bm,JOm:()=>zs,tp0:()=>qe,Rgc:()=>Kf,dDg:()=>K1,eoX:()=>x0,GfV:()=>Zc,s_b:()=>Ag,ifc:()=>Be,MMx:()=>cy,Lck:()=>Fx,eFA:()=>C0,G48:()=>ab,Gpc:()=>Ke,f3M:()=>Ht,$WT:()=>Kr,MR2:()=>Dm,_c5:()=>Cb,c2e:()=>z1,zSh:()=>Ad,wAp:()=>Ri,vHH:()=>ge,lri:()=>y0,rWj:()=>v0,D6c:()=>Eb,cg1:()=>wc,kL8:()=>rp,dqk:()=>rn,Z0I:()=>ci,eJc:()=>vy,CqO:()=>za,QGY:()=>Df,F4k:()=>If,RDi:()=>Gg,AaK:()=>pe,qOj:()=>hf,TTD:()=>Lo,_Bn:()=>fv,jDz:()=>_v,xp6:()=>Um,uIk:()=>yf,ekj:()=>A,Suo:()=>Uv,Xpm:()=>Oi,lG2:()=>no,Yz7:()=>ot,cJS:()=>Sn,oAB:()=>Jt,Yjl:()=>fo,Y36:()=>pc,_UZ:()=>Kd,GkF:()=>Tf,BQk:()=>Xh,ynx:()=>Yc,qZA:()=>Jh,TgZ:()=>Yh,EpF:()=>Ef,n5z:()=>iu,LFG:()=>_n,$8M:()=>Xs,$Z:()=>qm,NdJ:()=>il,CRH:()=>Vv,oxw:()=>Sf,ALo:()=>Av,lcZ:()=>Pv,xi3:()=>Ov,Hsn:()=>vg,F$t:()=>Kh,Q6J:()=>sd,s9C:()=>Qh,DdM:()=>Tv,iGM:()=>Nv,MAs:()=>wf,KtG:()=>Tl,CHM:()=>Ga,LSH:()=>el,P3R:()=>as,Udp:()=>I,YNc:()=>_g,_uU:()=>ln,Oqu:()=>$n,hij:()=>_i,AsE:()=>Wn,lnq:()=>ni,HOy:()=>Zn,Gf:()=>zv});var d=F(7579),v=F(727),re=F(9751),a=F(8189),q=F(8421),oe=F(515),b=F(7669),he=F(2076),Ve=F(3099);function K(r){for(let o in r)if(r[o]===K)return o;throw Error("Could not find renamed property on target object.")}function xe(r,o){for(const l in o)o.hasOwnProperty(l)&&!r.hasOwnProperty(l)&&(r[l]=o[l])}function pe(r){if("string"==typeof r)return r;if(Array.isArray(r))return"["+r.map(pe).join(", ")+"]";if(null==r)return""+r;if(r.overriddenName)return`${r.overriddenName}`;if(r.name)return`${r.name}`;const o=r.toString();if(null==o)return""+o;const l=o.indexOf("\n");return-1===l?o:o.substring(0,l)}function ze(r,o){return null==r||""===r?null===o?"":o:null==o||""===o?r:r+" "+o}const ce=K({__forward_ref__:K});function Ke(r){return r.__forward_ref__=Ke,r.toString=function(){return pe(this())},r}function Pe(r){return ne(r)?r():r}function ne(r){return"function"==typeof r&&r.hasOwnProperty(ce)&&r.__forward_ref__===Ke}function Je(r){return r&&!!r.\u0275providers}const at="https://g.co/ng/security#xss";class ge extends Error{constructor(o,l){super(ke(o,l)),this.code=o}}function ke(r,o){return`NG0${Math.abs(r)}${o?": "+o.trim():""}`}function Le(r){return"string"==typeof r?r:null==r?"":String(r)}function de(r,o){throw new ge(-201,!1)}function kt(r,o){null==r&&function Ut(r,o,l,g){throw new Error(`ASSERTION ERROR: ${r}`+(null==g?"":` [Expected=> ${l} ${g} ${o} <=Actual]`))}(o,r,null,"!=")}function ot(r){return{token:r.token,providedIn:r.providedIn||null,factory:r.factory,value:void 0}}function Sn(r){return{providers:r.providers||[],imports:r.imports||[]}}function Qn(r){return Un(r,Bi)||Un(r,Ni)}function ci(r){return null!==Qn(r)}function Un(r,o){return r.hasOwnProperty(o)?r[o]:null}function yi(r){return r&&(r.hasOwnProperty(Mi)||r.hasOwnProperty(Ki))?r[Mi]:null}const Bi=K({\u0275prov:K}),Mi=K({\u0275inj:K}),Ni=K({ngInjectableDef:K}),Ki=K({ngInjectorDef:K});var Vt=(()=>((Vt=Vt||{})[Vt.Default=0]="Default",Vt[Vt.Host=1]="Host",Vt[Vt.Self=2]="Self",Vt[Vt.SkipSelf=4]="SkipSelf",Vt[Vt.Optional=8]="Optional",Vt))();let Mt;function ie(r){const o=Mt;return Mt=r,o}function Qe(r,o,l){const g=Qn(r);return g&&"root"==g.providedIn?void 0===g.value?g.value=g.factory():g.value:l&Vt.Optional?null:void 0!==o?o:void de(pe(r))}const rn=(()=>typeof globalThis<"u"&&globalThis||typeof global<"u"&&global||typeof window<"u"&&window||typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self)(),pi={},mr="__NG_DI_FLAG__",Si="ngTempTokenPath",vr="ngTokenPath",xr=/\n/gm,gr="\u0275",ui="__source";let pn;function wt(r){const o=pn;return pn=r,o}function Rt(r,o=Vt.Default){if(void 0===pn)throw new ge(-203,!1);return null===pn?Qe(r,void 0,o):pn.get(r,o&Vt.Optional?null:void 0,o)}function _n(r,o=Vt.Default){return(function Ge(){return Mt}()||Rt)(Pe(r),o)}function Ht(r,o=Vt.Default){return _n(r,z(o))}function z(r){return typeof r>"u"||"number"==typeof r?r:0|(r.optional&&8)|(r.host&&1)|(r.self&&2)|(r.skipSelf&&4)}function k(r){const o=[];for(let l=0;l<r.length;l++){const g=Pe(r[l]);if(Array.isArray(g)){if(0===g.length)throw new ge(900,!1);let C,D=Vt.Default;for(let R=0;R<g.length;R++){const B=g[R],Z=De(B);"number"==typeof Z?-1===Z?C=B.token:D|=Z:C=B}o.push(_n(C,D))}else o.push(_n(g))}return o}function X(r,o){return r[mr]=o,r.prototype[mr]=o,r}function De(r){return r[mr]}function Ot(r){return{toString:r}.toString()}var vt=(()=>((vt=vt||{})[vt.OnPush=0]="OnPush",vt[vt.Default=1]="Default",vt))(),Be=(()=>{return(r=Be||(Be={}))[r.Emulated=0]="Emulated",r[r.None=2]="None",r[r.ShadowDom=3]="ShadowDom",Be;var r})();const Me={},We=[],jt=K({\u0275cmp:K}),dn=K({\u0275dir:K}),Tn=K({\u0275pipe:K}),qn=K({\u0275mod:K}),Yn=K({\u0275fac:K}),mi=K({__NG_ELEMENT_ID__:K});let ei=0;function Oi(r){return Ot(()=>{const l=!0===r.standalone,g={},C={type:r.type,providersResolver:null,decls:r.decls,vars:r.vars,factory:null,template:r.template||null,consts:r.consts||null,ngContentSelectors:r.ngContentSelectors,hostBindings:r.hostBindings||null,hostVars:r.hostVars||0,hostAttrs:r.hostAttrs||null,contentQueries:r.contentQueries||null,declaredInputs:g,inputs:null,outputs:null,exportAs:r.exportAs||null,onPush:r.changeDetection===vt.OnPush,directiveDefs:null,pipeDefs:null,standalone:l,dependencies:l&&r.dependencies||null,getStandaloneInjector:null,selectors:r.selectors||We,viewQuery:r.viewQuery||null,features:r.features||null,data:r.data||{},encapsulation:r.encapsulation||Be.Emulated,id:"c"+ei++,styles:r.styles||We,_:null,setInput:null,schemas:r.schemas||null,tView:null,findHostDirectiveDefs:null,hostDirectives:null},D=r.dependencies,R=r.features;return C.inputs=dr(r.inputs,g),C.outputs=dr(r.outputs),R&&R.forEach(B=>B(C)),C.directiveDefs=D?()=>("function"==typeof D?D():D).map(Er).filter(Gr):null,C.pipeDefs=D?()=>("function"==typeof D?D():D).map(Dr).filter(Gr):null,C})}function Er(r){return bi(r)||qi(r)}function Gr(r){return null!==r}function Jt(r){return Ot(()=>({type:r.type,bootstrap:r.bootstrap||We,declarations:r.declarations||We,imports:r.imports||We,exports:r.exports||We,transitiveCompileScopes:null,schemas:r.schemas||null,id:r.id||null}))}function dr(r,o){if(null==r)return Me;const l={};for(const g in r)if(r.hasOwnProperty(g)){let C=r[g],D=C;Array.isArray(C)&&(D=C[1],C=C[0]),l[C]=g,o&&(o[C]=D)}return l}const no=Oi;function fo(r){return{type:r.type,name:r.name,factory:null,pure:!1!==r.pure,standalone:!0===r.standalone,onDestroy:r.type.prototype.ngOnDestroy||null}}function bi(r){return r[jt]||null}function qi(r){return r[dn]||null}function Dr(r){return r[Tn]||null}function Kr(r){const o=bi(r)||qi(r)||Dr(r);return null!==o&&o.standalone}function In(r,o){const l=r[qn]||null;if(!l&&!0===o)throw new Error(`Type ${pe(r)} does not have '\u0275mod' property.`);return l}const si=0,En=1,fe=2,$e=3,ct=4,zt=5,en=6,je=7,gt=8,Ft=9,gn=10,Yt=11,Gn=12,Hn=13,Ai=14,Fi=15,Vi=16,Ir=17,Qi=18,Hr=19,zr=20,hr=21,lr=22,io=1,ro=2,Ds=7,Ko=8,br=9,Ur=10;function Wr(r){return Array.isArray(r)&&"object"==typeof r[io]}function _r(r){return Array.isArray(r)&&!0===r[io]}function hs(r){return 0!=(4&r.flags)}function Ro(r){return r.componentOffset>-1}function lo(r){return 1==(1&r.flags)}function Qr(r){return null!==r.template}function js(r){return 0!=(256&r[fe])}function Mo(r,o){return r.hasOwnProperty(Yn)?r[Yn]:null}class $s{constructor(o,l,g){this.previousValue=o,this.currentValue=l,this.firstChange=g}isFirstChange(){return this.firstChange}}function Lo(){return ji}function ji(r){return r.type.prototype.ngOnChanges&&(r.setInput=Vo),ea}function ea(){const r=ms(this),o=r?.current;if(o){const l=r.previous;if(l===Me)r.previous=o;else for(let g in o)l[g]=o[g];r.current=null,this.ngOnChanges(o)}}function Vo(r,o,l,g){const C=this.declaredInputs[l],D=ms(r)||function Zs(r,o){return r[jo]=o}(r,{previous:Me,current:null}),R=D.current||(D.current={}),B=D.previous,Z=B[C];R[C]=new $s(Z&&Z.currentValue,o,B===Me),r[g]=o}Lo.ngInherit=!0;const jo="__ngSimpleChanges__";function ms(r){return r[jo]||null}const co=function(r,o,l){};function kr(r){for(;Array.isArray(r);)r=r[si];return r}function _s(r,o){return kr(o[r])}function vi(r,o){return kr(o[r.index])}function ja(r,o){return r.data[o]}function ys(r,o){return r[o]}function Mr(r,o){const l=o[r];return Wr(l)?l:l[si]}function Go(r){return 64==(64&r[fe])}function te(r,o){return null==o?null:r[o]}function Y(r){r[Qi]=0}function W(r,o){r[zt]+=o;let l=r,g=r[$e];for(;null!==g&&(1===o&&1===l[zt]||-1===o&&0===l[zt]);)g[zt]+=o,l=g,g=g[$e]}const Te={lFrame:ql(null),bindingsEnabled:!0};function Fo(){return Te.bindingsEnabled}function Rn(){return Te.lFrame.lView}function ki(){return Te.lFrame.tView}function Ga(r){return Te.lFrame.contextLView=r,r[gt]}function Tl(r){return Te.lFrame.contextLView=null,r}function so(){let r=Wl();for(;null!==r&&64===r.type;)r=r.parent;return r}function Wl(){return Te.lFrame.currentTNode}function Qo(r,o){const l=Te.lFrame;l.currentTNode=r,l.isParent=o}function Hs(){return Te.lFrame.isParent}function es(){Te.lFrame.isParent=!1}function M(){const r=Te.lFrame;let o=r.bindingRootIndex;return-1===o&&(o=r.bindingRootIndex=r.tView.bindingStartIndex),o}function G(){return Te.lFrame.bindingIndex}function j(){return Te.lFrame.bindingIndex++}function _e(r){const o=Te.lFrame,l=o.bindingIndex;return o.bindingIndex=o.bindingIndex+r,l}function Vn(r,o){const l=Te.lFrame;l.bindingIndex=l.bindingRootIndex=r,ii(o)}function ii(r){Te.lFrame.currentDirectiveIndex=r}function ir(){return Te.lFrame.currentQueryIndex}function sr(r){Te.lFrame.currentQueryIndex=r}function _o(r){const o=r[En];return 2===o.type?o.declTNode:1===o.type?r[en]:null}function yo(r,o,l){if(l&Vt.SkipSelf){let C=o,D=r;for(;!(C=C.parent,null!==C||l&Vt.Host||(C=_o(D),null===C||(D=D[Fi],10&C.type))););if(null===C)return!1;o=C,r=D}const g=Te.lFrame=ts();return g.currentTNode=o,g.lView=r,!0}function Os(r){const o=ts(),l=r[En];Te.lFrame=o,o.currentTNode=l.firstChild,o.lView=r,o.tView=l,o.contextLView=r,o.bindingIndex=l.bindingStartIndex,o.inI18n=!1}function ts(){const r=Te.lFrame,o=null===r?null:r.child;return null===o?ql(r):o}function ql(r){const o={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:r,child:null,inI18n:!1};return null!==r&&(r.child=o),o}function El(){const r=Te.lFrame;return Te.lFrame=r.parent,r.currentTNode=null,r.lView=null,r}const Pa=El;function vs(){const r=El();r.isParent=!0,r.tView=null,r.selectedIndex=-1,r.contextLView=null,r.elementDepthCount=0,r.currentDirectiveIndex=-1,r.currentNamespace=null,r.bindingRootIndex=-1,r.bindingIndex=-1,r.currentQueryIndex=0}function ao(){return Te.lFrame.selectedIndex}function Rs(r){Te.lFrame.selectedIndex=r}function wr(){const r=Te.lFrame;return ja(r.tView,r.selectedIndex)}function H(r,o){for(let l=o.directiveStart,g=o.directiveEnd;l<g;l++){const D=r.data[l].type.prototype,{ngAfterContentInit:R,ngAfterContentChecked:B,ngAfterViewInit:Z,ngAfterViewChecked:ae,ngOnDestroy:Ae}=D;R&&(r.contentHooks||(r.contentHooks=[])).push(-l,R),B&&((r.contentHooks||(r.contentHooks=[])).push(l,B),(r.contentCheckHooks||(r.contentCheckHooks=[])).push(l,B)),Z&&(r.viewHooks||(r.viewHooks=[])).push(-l,Z),ae&&((r.viewHooks||(r.viewHooks=[])).push(l,ae),(r.viewCheckHooks||(r.viewCheckHooks=[])).push(l,ae)),null!=Ae&&(r.destroyHooks||(r.destroyHooks=[])).push(l,Ae)}}function Se(r,o,l){Dn(r,o,3,l)}function ht(r,o,l,g){(3&r[fe])===l&&Dn(r,o,l,g)}function hn(r,o){let l=r[fe];(3&l)===o&&(l&=2047,l+=1,r[fe]=l)}function Dn(r,o,l,g){const D=g??-1,R=o.length-1;let B=0;for(let Z=void 0!==g?65535&r[Qi]:0;Z<R;Z++)if("number"==typeof o[Z+1]){if(B=o[Z],null!=g&&B>=g)break}else o[Z]<0&&(r[Qi]+=65536),(B<D||-1==D)&&(ai(r,l,o,Z),r[Qi]=(4294901760&r[Qi])+Z+2),Z++}function ai(r,o,l,g){const C=l[g]<0,D=l[g+1],B=r[C?-l[g]:l[g]];if(C){if(r[fe]>>11<r[Qi]>>16&&(3&r[fe])===o){r[fe]+=2048,co(4,B,D);try{D.call(B)}finally{co(5,B,D)}}}else{co(4,B,D);try{D.call(B)}finally{co(5,B,D)}}}const Hi=-1;class tr{constructor(o,l,g){this.factory=o,this.resolving=!1,this.canSeeViewProviders=l,this.injectImpl=g}}function Ho(r,o,l){let g=0;for(;g<l.length;){const C=l[g];if("number"==typeof C){if(0!==C)break;g++;const D=l[g++],R=l[g++],B=l[g++];r.setAttribute(o,R,B,D)}else{const D=C,R=l[++g];Wa(D)?r.setProperty(o,D,R):r.setAttribute(o,D,R),g++}}return g}function Ys(r){return 3===r||4===r||6===r}function Wa(r){return 64===r.charCodeAt(0)}function Ls(r,o){if(null!==o&&0!==o.length)if(null===r||0===r.length)r=o.slice();else{let l=-1;for(let g=0;g<o.length;g++){const C=o[g];"number"==typeof C?l=C:0===l||Ec(r,l,C,null,-1===l||2===l?o[++g]:null)}}return r}function Ec(r,o,l,g,C){let D=0,R=r.length;if(-1===o)R=-1;else for(;D<r.length;){const B=r[D++];if("number"==typeof B){if(B===o){R=-1;break}if(B>o){R=D-1;break}}}for(;D<r.length;){const B=r[D];if("number"==typeof B)break;if(B===l){if(null===g)return void(null!==C&&(r[D+1]=C));if(g===r[D+1])return void(r[D+2]=C)}D++,null!==g&&D++,null!==C&&D++}-1!==R&&(r.splice(R,0,o),D=R+1),r.splice(D++,0,l),null!==g&&r.splice(D++,0,g),null!==C&&r.splice(D++,0,C)}function Dl(r){return r!==Hi}function Fs(r){return 32767&r}function uo(r,o){let l=function al(r){return r>>16}(r),g=o;for(;l>0;)g=g[Fi],l--;return g}let ll=!0;function cl(r){const o=ll;return ll=r,o}const Il=255,Xl=5;let Ic=0;const Js={};function Sl(r,o){const l=qa(r,o);if(-1!==l)return l;const g=o[En];g.firstCreatePass&&(r.injectorIndex=o.length,Mc(g.data,r),Mc(o,null),Mc(g.blueprint,null));const C=Sc(r,o),D=r.injectorIndex;if(Dl(C)){const R=Fs(C),B=uo(C,o),Z=B[En].data;for(let ae=0;ae<8;ae++)o[D+ae]=B[R+ae]|Z[R+ae]}return o[D+8]=C,D}function Mc(r,o){r.push(0,0,0,0,0,0,0,0,o)}function qa(r,o){return-1===r.injectorIndex||r.parent&&r.parent.injectorIndex===r.injectorIndex||null===o[r.injectorIndex+8]?-1:r.injectorIndex}function Sc(r,o){if(r.parent&&-1!==r.parent.injectorIndex)return r.parent.injectorIndex;let l=0,g=null,C=o;for(;null!==C;){if(g=Eo(C),null===g)return Hi;if(l++,C=C[Fi],-1!==g.injectorIndex)return g.injectorIndex|l<<16}return Hi}function Kl(r,o,l){!function Ml(r,o,l){let g;"string"==typeof l?g=l.charCodeAt(0)||0:l.hasOwnProperty(mi)&&(g=l[mi]),null==g&&(g=l[mi]=Ic++);const C=g&Il;o.data[r+(C>>Xl)]|=1<<C}(r,o,l)}function ul(r,o,l){if(l&Vt.Optional||void 0!==r)return r;de()}function ec(r,o,l,g){if(l&Vt.Optional&&void 0===g&&(g=null),!(l&(Vt.Self|Vt.Host))){const C=r[Ft],D=ie(void 0);try{return C?C.get(o,g,l&Vt.Optional):Qe(o,g,l&Vt.Optional)}finally{ie(D)}}return ul(g,0,l)}function Al(r,o,l,g=Vt.Default,C){if(null!==r){if(1024&o[fe]){const R=function ru(r,o,l,g,C){let D=r,R=o;for(;null!==D&&null!==R&&1024&R[fe]&&!(256&R[fe]);){const B=tu(D,R,l,g|Vt.Self,Js);if(B!==Js)return B;let Z=D.parent;if(!Z){const ae=R[hr];if(ae){const Ae=ae.get(l,Js,g);if(Ae!==Js)return Ae}Z=Eo(R),R=R[Fi]}D=Z}return C}(r,o,l,g,Js);if(R!==Js)return R}const D=tu(r,o,l,g,Js);if(D!==Js)return D}return ec(o,l,g,C)}function tu(r,o,l,g,C){const D=function Ac(r){if("string"==typeof r)return r.charCodeAt(0)||0;const o=r.hasOwnProperty(mi)?r[mi]:void 0;return"number"==typeof o?o>=0?o&Il:oh:o}(l);if("function"==typeof D){if(!yo(o,r,g))return g&Vt.Host?ul(C,0,g):ec(o,l,g,C);try{const R=D(g);if(null!=R||g&Vt.Optional)return R;de()}finally{Pa()}}else if("number"==typeof D){let R=null,B=qa(r,o),Z=Hi,ae=g&Vt.Host?o[Vi][en]:null;for((-1===B||g&Vt.SkipSelf)&&(Z=-1===B?Sc(r,o):o[B+8],Z!==Hi&&nu(g,!1)?(R=o[En],B=Fs(Z),o=uo(Z,o)):B=-1);-1!==B;){const Ae=o[En];if(ko(D,B,Ae.data)){const it=ns(B,o,l,R,g,ae);if(it!==Js)return it}Z=o[B+8],Z!==Hi&&nu(g,o[En].data[B+8]===ae)&&ko(D,B,o)?(R=Ae,B=Fs(Z),o=uo(Z,o)):B=-1}}return C}function ns(r,o,l,g,C,D){const R=o[En],B=R.data[r+8],Ae=Pl(B,R,l,null==g?Ro(B)&&ll:g!=R&&0!=(3&B.type),C&Vt.Host&&D===B);return null!==Ae?ta(o,R,Ae,B):Js}function Pl(r,o,l,g,C){const D=r.providerIndexes,R=o.data,B=1048575&D,Z=r.directiveStart,Ae=D>>20,Nt=C?B+Ae:r.directiveEnd;for(let sn=g?B:B+Ae;sn<Nt;sn++){const Mn=R[sn];if(sn<Z&&l===Mn||sn>=Z&&Mn.type===l)return sn}if(C){const sn=R[Z];if(sn&&Qr(sn)&&sn.type===l)return Z}return null}function ta(r,o,l,g){let C=r[l];const D=o.data;if(function or(r){return r instanceof tr}(C)){const R=C;R.resolving&&function Xe(r,o){const l=o?`. Dependency path: ${o.join(" > ")} > ${r}`:"";throw new ge(-200,`Circular dependency in DI detected for ${r}${l}`)}(function we(r){return"function"==typeof r?r.name||r.toString():"object"==typeof r&&null!=r&&"function"==typeof r.type?r.type.name||r.type.toString():Le(r)}(D[l]));const B=cl(R.canSeeViewProviders);R.resolving=!0;const Z=R.injectImpl?ie(R.injectImpl):null;yo(r,g,Vt.Default);try{C=r[l]=R.factory(void 0,D,r,g),o.firstCreatePass&&l>=g.directiveStart&&function le(r,o,l){const{ngOnChanges:g,ngOnInit:C,ngDoCheck:D}=o.type.prototype;if(g){const R=ji(o);(l.preOrderHooks||(l.preOrderHooks=[])).push(r,R),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,R)}C&&(l.preOrderHooks||(l.preOrderHooks=[])).push(0-r,C),D&&((l.preOrderHooks||(l.preOrderHooks=[])).push(r,D),(l.preOrderCheckHooks||(l.preOrderCheckHooks=[])).push(r,D))}(l,D[l],o)}finally{null!==Z&&ie(Z),cl(B),R.resolving=!1,Pa()}}return C}function ko(r,o,l){return!!(l[o+(r>>Xl)]&1<<r)}function nu(r,o){return!(r&Vt.Self||r&Vt.Host&&o)}class Ol{constructor(o,l){this._tNode=o,this._lView=l}get(o,l,g){return Al(this._tNode,this._lView,o,z(g),l)}}function oh(){return new Ol(so(),Rn())}function iu(r){return Ot(()=>{const o=r.prototype.constructor,l=o[Yn]||ks(o),g=Object.prototype;let C=Object.getPrototypeOf(r.prototype).constructor;for(;C&&C!==g;){const D=C[Yn]||ks(C);if(D&&D!==l)return D;C=Object.getPrototypeOf(C)}return D=>new D})}function ks(r){return ne(r)?()=>{const o=ks(Pe(r));return o&&o()}:Mo(r)}function Eo(r){const o=r[En],l=o.type;return 2===l?o.declTNode:1===l?r[en]:null}function Xs(r){return function Ql(r,o){if("class"===o)return r.classes;if("style"===o)return r.styles;const l=r.attrs;if(l){const g=l.length;let C=0;for(;C<g;){const D=l[C];if(Ys(D))break;if(0===D)C+=2;else if("number"==typeof D)for(C++;C<g&&"string"==typeof l[C];)C++;else{if(D===o)return l[C+1];C+=2}}}return null}(so(),r)}const Kn="__parameters__";function ya(r,o,l){return Ot(()=>{const g=function Oa(r){return function(...l){if(r){const g=r(...l);for(const C in g)this[C]=g[C]}}}(o);function C(...D){if(this instanceof C)return g.apply(this,D),this;const R=new C(...D);return B.annotation=R,B;function B(Z,ae,Ae){const it=Z.hasOwnProperty(Kn)?Z[Kn]:Object.defineProperty(Z,Kn,{value:[]})[Kn];for(;it.length<=Ae;)it.push(null);return(it[Ae]=it[Ae]||[]).push(R),Z}}return l&&(C.prototype=Object.create(l.prototype)),C.prototype.ngMetadataName=r,C.annotationCls=C,C})}class Pr{constructor(o,l){this._desc=o,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof l?this.__NG_ELEMENT_ID__=l:void 0!==l&&(this.\u0275prov=ot({token:this,providedIn:l.providedIn||"root",factory:l.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}function Ja(r,o){r.forEach(l=>Array.isArray(l)?Ja(l,o):o(l))}function uu(r,o,l){o>=r.length?r.push(l):r.splice(o,0,l)}function nc(r,o){return o>=r.length-1?r.pop():r.splice(o,1)[0]}function Xa(r,o){const l=[];for(let g=0;g<r;g++)l.push(o);return l}function y(r,o,l){let g=p(r,o);return g>=0?r[1|g]=l:(g=~g,function i(r,o,l,g){let C=r.length;if(C==o)r.push(l,g);else if(1===C)r.push(g,r[0]),r[0]=l;else{for(C--,r.push(r[C-1],r[C]);C>o;)r[C]=r[C-2],C--;r[o]=l,r[o+1]=g}}(r,g,o,l)),g}function u(r,o){const l=p(r,o);if(l>=0)return r[1|l]}function p(r,o){return function w(r,o,l){let g=0,C=r.length>>l;for(;C!==g;){const D=g+(C-g>>1),R=r[D<<l];if(o===R)return D<<l;R>o?C=D:g=D+1}return~(C<<l)}(r,o,1)}const ve=X(ya("Optional"),8),qe=X(ya("SkipSelf"),4);var zs=(()=>((zs=zs||{})[zs.Important=1]="Important",zs[zs.DashCase=2]="DashCase",zs))();const Qa=new Map;let Rc=0;const lh="__ngContext__";function Us(r,o){Wr(o)?(r[lh]=o[zr],function lp(r){Qa.set(r[zr],r)}(o)):r[lh]=o}let hd;function ku(r,o){return hd(r,o)}function Lc(r){const o=r[$e];return _r(o)?o[$e]:o}function hp(r){return dm(r[Hn])}function pp(r){return dm(r[ct])}function dm(r){for(;null!==r&&!_r(r);)r=r[ct];return r}function Fc(r,o,l,g,C){if(null!=g){let D,R=!1;_r(g)?D=g:Wr(g)&&(R=!0,g=g[si]);const B=kr(g);0===r&&null!==l?null==C?fd(o,l,B):xa(o,l,B,C||null,!0):1===r&&null!==l?xa(o,l,B,C||null,!0):2===r?function hh(r,o,l){const g=ba(r,o);g&&function pm(r,o,l,g){r.removeChild(o,l,g)}(r,g,o,l)}(o,B,R):3===r&&o.destroyNode(B),null!=D&&function mm(r,o,l,g,C){const D=l[Ds];D!==kr(l)&&Fc(o,r,g,D,C);for(let B=Ur;B<l.length;B++){const Z=l[B];Fl(Z[En],Z,r,o,g,D)}}(o,r,D,l,C)}}function Ra(r,o,l){return r.createElement(o,l)}function hm(r,o){const l=r[br],g=l.indexOf(o),C=o[$e];512&o[fe]&&(o[fe]&=-513,W(C,-1)),l.splice(g,1)}function dh(r,o){if(r.length<=Ur)return;const l=Ur+o,g=r[l];if(g){const C=g[Ir];null!==C&&C!==r&&hm(C,g),o>0&&(r[l-1][ct]=g[ct]);const D=nc(r,Ur+o);!function kc(r,o){Fl(r,o,o[Yt],2,null,null),o[si]=null,o[en]=null}(g[En],g);const R=D[Hr];null!==R&&R.detachView(D[En]),g[$e]=null,g[ct]=null,g[fe]&=-65}return g}function pd(r,o){if(!(128&o[fe])){const l=o[Yt];l.destroyNode&&Fl(r,o,l,3,null,null),function zg(r){let o=r[Hn];if(!o)return La(r[En],r);for(;o;){let l=null;if(Wr(o))l=o[Hn];else{const g=o[Ur];g&&(l=g)}if(!l){for(;o&&!o[ct]&&o!==r;)Wr(o)&&La(o[En],o),o=o[$e];null===o&&(o=r),Wr(o)&&La(o[En],o),l=o&&o[ct]}o=l}}(o)}}function La(r,o){if(!(128&o[fe])){o[fe]&=-65,o[fe]|=128,function $g(r,o){let l;if(null!=r&&null!=(l=r.destroyHooks))for(let g=0;g<l.length;g+=2){const C=o[l[g]];if(!(C instanceof tr)){const D=l[g+1];if(Array.isArray(D))for(let R=0;R<D.length;R+=2){const B=C[D[R]],Z=D[R+1];co(4,B,Z);try{Z.call(B)}finally{co(5,B,Z)}}else{co(4,C,D);try{D.call(C)}finally{co(5,C,D)}}}}}(r,o),function jg(r,o){const l=r.cleanup,g=o[je];let C=-1;if(null!==l)for(let D=0;D<l.length-1;D+=2)if("string"==typeof l[D]){const R=l[D+3];R>=0?g[C=R]():g[C=-R].unsubscribe(),D+=2}else{const R=g[C=l[D+1]];l[D].call(R)}if(null!==g){for(let D=C+1;D<g.length;D++)(0,g[D])();o[je]=null}}(r,o),1===o[En].type&&o[Yt].destroy();const l=o[Ir];if(null!==l&&_r(o[$e])){l!==o[$e]&&hm(l,o);const g=o[Hr];null!==g&&g.detachView(r)}!function tm(r){Qa.delete(r[zr])}(o)}}function xo(r,o,l){return function Ei(r,o,l){let g=o;for(;null!==g&&40&g.type;)g=(o=g).parent;if(null===g)return l[si];{const{componentOffset:C}=g;if(C>-1){const{encapsulation:D}=r.data[g.directiveStart+C];if(D===Be.None||D===Be.Emulated)return null}return vi(g,l)}}(r,o.parent,l)}function xa(r,o,l,g,C){r.insertBefore(o,l,g,C)}function fd(r,o,l){r.appendChild(o,l)}function ra(r,o,l,g,C){null!==g?xa(r,o,l,g,C):fd(r,o,l)}function ba(r,o){return r.parentNode(o)}function Nc(r,o,l){return zc(r,o,l)}let md,mp,wd,zc=function Bu(r,o,l){return 40&r.type?vi(r,l):null};function _d(r,o,l,g){const C=xo(r,g,o),D=o[Yt],B=Nc(g.parent||o[en],g,o);if(null!=C)if(Array.isArray(l))for(let Z=0;Z<l.length;Z++)ra(D,C,l[Z],B,!1);else ra(D,C,l,B,!1);void 0!==md&&md(D,g,o,l,C)}function yd(r,o){if(null!==o){const l=o.type;if(3&l)return vi(o,r);if(4&l)return vd(-1,r[o.index]);if(8&l){const g=o.child;if(null!==g)return yd(r,g);{const C=r[o.index];return _r(C)?vd(-1,C):kr(C)}}if(32&l)return ku(o,r)()||kr(r[o.index]);{const g=fm(r,o);return null!==g?Array.isArray(g)?g[0]:yd(Lc(r[Vi]),g):yd(r,o.next)}}return null}function fm(r,o){return null!==o?r[Vi][en].projection[o.projection]:null}function vd(r,o){const l=Ur+r+1;if(l<o.length){const g=o[l],C=g[En].firstChild;if(null!==C)return yd(g,C)}return o[Ds]}function mu(r,o,l,g,C,D,R){for(;null!=l;){const B=g[l.index],Z=l.type;if(R&&0===o&&(B&&Us(kr(B),g),l.flags|=2),32!=(32&l.flags))if(8&Z)mu(r,o,l.child,g,C,D,!1),Fc(o,r,C,B,D);else if(32&Z){const ae=ku(l,g);let Ae;for(;Ae=ae();)Fc(o,r,C,Ae,D);Fc(o,r,C,B,D)}else 16&Z?ph(r,o,g,l,C,D):Fc(o,r,C,B,D);l=R?l.projectionNext:l.next}}function Fl(r,o,l,g,C,D){mu(l,g,r.firstChild,o,C,D,!1)}function ph(r,o,l,g,C,D){const R=l[Vi],Z=R[en].projection[g.projection];if(Array.isArray(Z))for(let ae=0;ae<Z.length;ae++)Fc(o,r,C,Z[ae],D);else mu(r,o,Z,R[$e],C,D,!0)}function wa(r,o,l){""===l?r.removeAttribute(o,"class"):r.setAttribute(o,"class",l)}function Nu(r,o,l){const{mergedAttrs:g,classes:C,styles:D}=l;null!==g&&Ho(r,o,g),null!==C&&wa(r,o,C),null!==D&&function bd(r,o,l){r.setAttribute(o,"style",l)}(r,o,D)}function Gg(r){mp=r}function vp(r){return function ac(){if(void 0===wd&&(wd=null,rn.trustedTypes))try{wd=rn.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:r=>r,createScript:r=>r,createScriptURL:r=>r})}catch{}return wd}()?.createScriptURL(r)||r}class xp{constructor(o){this.changingThisBreaksApplicationSecurity=o}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${at})`}}function kl(r){return r instanceof xp?r.changingThisBreaksApplicationSecurity:r}function gu(r,o){const l=function bp(r){return r instanceof xp&&r.getTypeName()||null}(r);if(null!=l&&l!==o){if("ResourceURL"===l&&"URL"===o)return!0;throw new Error(`Required a safe ${o}, got a ${l} (see ${at})`)}return l===o}const Yg=/^(?:(?:https?|mailto|data|ftp|tel|file|sms):|[^&:/?#]*(?:[/?#]|$))/gi;var Bo=(()=>((Bo=Bo||{})[Bo.NONE=0]="NONE",Bo[Bo.HTML=1]="HTML",Bo[Bo.STYLE=2]="STYLE",Bo[Bo.SCRIPT=3]="SCRIPT",Bo[Bo.URL=4]="URL",Bo[Bo.RESOURCE_URL=5]="RESOURCE_URL",Bo))();function el(r){const o=yu();return o?o.sanitize(Bo.URL,r)||"":gu(r,"URL")?kl(r):function Td(r){return(r=String(r)).match(Yg)?r:"unsafe:"+r}(Le(r))}function yl(r){const o=yu();if(o)return vp(o.sanitize(Bo.RESOURCE_URL,r)||"");if(gu(r,"ResourceURL"))return vp(kl(r));throw new ge(904,!1)}function as(r,o,l){return function Tm(r,o){return"src"===o&&("embed"===r||"frame"===r||"iframe"===r||"media"===r||"script"===r)||"href"===o&&("base"===r||"link"===r)?yl:el}(o,l)(r)}function yu(){const r=Rn();return r&&r[Gn]}const yh=new Pr("ENVIRONMENT_INITIALIZER"),vh=new Pr("INJECTOR",-1),Em=new Pr("INJECTOR_DEF_TYPES");class xh{get(o,l=pi){if(l===pi){const g=new Error(`NullInjectorError: No provider for ${pe(o)}!`);throw g.name="NullInjectorError",g}return l}}function Dm(r){return{\u0275providers:r}}function Qg(...r){return{\u0275providers:Bl(0,r),\u0275fromNgModule:!0}}function Bl(r,...o){const l=[],g=new Set;let C;return Ja(o,D=>{const R=D;ju(R,l,[],g)&&(C||(C=[]),C.push(R))}),void 0!==C&&jc(C,l),l}function jc(r,o){for(let l=0;l<r.length;l++){const{providers:C}=r[l];Sd(C,D=>{o.push(D)})}}function ju(r,o,l,g){if(!(r=Pe(r)))return!1;let C=null,D=yi(r);const R=!D&&bi(r);if(D||R){if(R&&!R.standalone)return!1;C=r}else{const Z=r.ngModule;if(D=yi(Z),!D)return!1;C=Z}const B=g.has(C);if(R){if(B)return!1;if(g.add(C),R.dependencies){const Z="function"==typeof R.dependencies?R.dependencies():R.dependencies;for(const ae of Z)ju(ae,o,l,g)}}else{if(!D)return!1;{if(null!=D.imports&&!B){let ae;g.add(C);try{Ja(D.imports,Ae=>{ju(Ae,o,l,g)&&(ae||(ae=[]),ae.push(Ae))})}finally{}void 0!==ae&&jc(ae,o)}if(!B){const ae=Mo(C)||(()=>new C);o.push({provide:C,useFactory:ae,deps:We},{provide:Em,useValue:C,multi:!0},{provide:yh,useValue:()=>_n(C),multi:!0})}const Z=D.providers;null==Z||B||Sd(Z,Ae=>{o.push(Ae)})}}return C!==r&&void 0!==r.providers}function Sd(r,o){for(let l of r)Je(l)&&(l=l.\u0275providers),Array.isArray(l)?Sd(l,o):o(l)}const Im=K({provide:String,useValue:K});function Ap(r){return null!==r&&"object"==typeof r&&Im in r}function cc(r){return"function"==typeof r}const Ad=new Pr("Set Injector scope."),Pd={},Sm={};let uc;function Od(){return void 0===uc&&(uc=new xh),uc}class vu{}class xu extends vu{get destroyed(){return this._destroyed}constructor(o,l,g,C){super(),this.parent=l,this.source=g,this.scopes=C,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Op(o,R=>this.processProvider(R)),this.records.set(vh,Zu(void 0,this)),C.has("environment")&&this.records.set(vu,Zu(void 0,this));const D=this.records.get(Ad);null!=D&&"string"==typeof D.value&&this.scopes.add(D.value),this.injectorDefTypes=new Set(this.get(Em.multi,We,Vt.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const o of this._ngOnDestroyHooks)o.ngOnDestroy();for(const o of this._onDestroyHooks)o()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear(),this._onDestroyHooks.length=0}}onDestroy(o){this._onDestroyHooks.push(o)}runInContext(o){this.assertNotDestroyed();const l=wt(this),g=ie(void 0);try{return o()}finally{wt(l),ie(g)}}get(o,l=pi,g=Vt.Default){this.assertNotDestroyed(),g=z(g);const C=wt(this),D=ie(void 0);try{if(!(g&Vt.SkipSelf)){let B=this.records.get(o);if(void 0===B){const Z=function Lm(r){return"function"==typeof r||"object"==typeof r&&r instanceof Pr}(o)&&Qn(o);B=Z&&this.injectableDefInScope(Z)?Zu($u(o),Pd):null,this.records.set(o,B)}if(null!=B)return this.hydrate(o,B)}return(g&Vt.Self?Od():this.parent).get(o,l=g&Vt.Optional&&l===pi?null:l)}catch(R){if("NullInjectorError"===R.name){if((R[Si]=R[Si]||[]).unshift(pe(o)),C)throw R;return function Ze(r,o,l,g){const C=r[Si];throw o[ui]&&C.unshift(o[ui]),r.message=function dt(r,o,l,g=null){r=r&&"\n"===r.charAt(0)&&r.charAt(1)==gr?r.slice(2):r;let C=pe(o);if(Array.isArray(o))C=o.map(pe).join(" -> ");else if("object"==typeof o){let D=[];for(let R in o)if(o.hasOwnProperty(R)){let B=o[R];D.push(R+":"+("string"==typeof B?JSON.stringify(B):pe(B)))}C=`{${D.join(", ")}}`}return`${l}${g?"("+g+")":""}[${C}]: ${r.replace(xr,"\n  ")}`}("\n"+r.message,C,l,g),r[vr]=C,r[Si]=null,r}(R,o,"R3InjectorError",this.source)}throw R}finally{ie(D),wt(C)}}resolveInjectorInitializers(){const o=wt(this),l=ie(void 0);try{const g=this.get(yh.multi,We,Vt.Self);for(const C of g)C()}finally{wt(o),ie(l)}}toString(){const o=[],l=this.records;for(const g of l.keys())o.push(pe(g));return`R3Injector[${o.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new ge(205,!1)}processProvider(o){let l=cc(o=Pe(o))?o:Pe(o&&o.provide);const g=function Pm(r){return Ap(r)?Zu(void 0,r.useValue):Zu(Om(r),Pd)}(o);if(cc(o)||!0!==o.multi)this.records.get(l);else{let C=this.records.get(l);C||(C=Zu(void 0,Pd,!0),C.factory=()=>k(C.multi),this.records.set(l,C)),l=o,C.multi.push(o)}this.records.set(l,g)}hydrate(o,l){return l.value===Pd&&(l.value=Sm,l.value=l.factory()),"object"==typeof l.value&&l.value&&function t_(r){return null!==r&&"object"==typeof r&&"function"==typeof r.ngOnDestroy}(l.value)&&this._ngOnDestroyHooks.add(l.value),l.value}injectableDefInScope(o){if(!o.providedIn)return!1;const l=Pe(o.providedIn);return"string"==typeof l?"any"===l||this.scopes.has(l):this.injectorDefTypes.has(l)}}function $u(r){const o=Qn(r),l=null!==o?o.factory:Mo(r);if(null!==l)return l;if(r instanceof Pr)throw new ge(204,!1);if(r instanceof Function)return function Am(r){const o=r.length;if(o>0)throw Xa(o,"?"),new ge(204,!1);const l=function hi(r){const o=r&&(r[Bi]||r[Ni]);return o?(function Ii(r){if(r.hasOwnProperty("name"))return r.name;(""+r).match(/^function\s*([^\s(]+)/)}(r),o):null}(r);return null!==l?()=>l.factory(r):()=>new r}(r);throw new ge(204,!1)}function Om(r,o,l){let g;if(cc(r)){const C=Pe(r);return Mo(C)||$u(C)}if(Ap(r))g=()=>Pe(r.useValue);else if(function Mm(r){return!(!r||!r.useFactory)}(r))g=()=>r.useFactory(...k(r.deps||[]));else if(function Pp(r){return!(!r||!r.useExisting)}(r))g=()=>_n(Pe(r.useExisting));else{const C=Pe(r&&(r.useClass||r.provide));if(!function Rm(r){return!!r.deps}(r))return Mo(C)||$u(C);g=()=>new C(...k(r.deps))}return g}function Zu(r,o,l=!1){return{factory:r,value:o,multi:l?[]:void 0}}function Op(r,o){for(const l of r)Array.isArray(l)?Op(l,o):l&&Je(l)?Op(l.\u0275providers,o):o(l)}class n_{}class Rp{}class dc{resolveComponentFactory(o){throw function Fm(r){const o=Error(`No component factory found for ${pe(r)}. Did you add it to @NgModule.entryComponents?`);return o.ngComponent=r,o}(o)}}let Ts=(()=>{class r{}return r.NULL=new dc,r})();function i_(){return $c(so(),Rn())}function $c(r,o){return new Rd(vi(r,o))}let Rd=(()=>{class r{constructor(l){this.nativeElement=l}}return r.__NG_ELEMENT_ID__=i_,r})();function r_(r){return r instanceof Rd?r.nativeElement:r}class Bm{}let Gu=(()=>{class r{}return r.__NG_ELEMENT_ID__=()=>function bh(){const r=Rn(),l=Mr(so().index,r);return(Wr(l)?l:r)[Yt]}(),r})(),Nm=(()=>{class r{}return r.\u0275prov=ot({token:r,providedIn:"root",factory:()=>null}),r})();class Zc{constructor(o){this.full=o,this.major=o.split(".")[0],this.minor=o.split(".")[1],this.patch=o.split(".").slice(2).join(".")}}const Ld=new Zc("15.2.1"),Fp={},kp="ngOriginalError";function Bp(r){return r[kp]}class Fd{constructor(){this._console=console}handleError(o){const l=this._findOriginalError(o);this._console.error("ERROR",o),l&&this._console.error("ORIGINAL ERROR",l)}_findOriginalError(o){let l=o&&Bp(o);for(;l&&Bp(l);)l=Bp(l);return l||null}}function Nl(r){return r instanceof Function?r():r}function Dh(r,o,l){let g=r.length;for(;;){const C=r.indexOf(o,l);if(-1===C)return C;if(0===C||r.charCodeAt(C-1)<=32){const D=o.length;if(C+D===g||r.charCodeAt(C+D)<=32)return C}l=C+1}}const Ih="ng-template";function d_(r,o,l){let g=0;for(;g<r.length;){let C=r[g++];if(l&&"class"===C){if(C=r[g],-1!==Dh(C.toLowerCase(),o,0))return!0}else if(1===C){for(;g<r.length&&"string"==typeof(C=r[g++]);)if(C.toLowerCase()===o)return!0;return!1}}return!1}function Up(r){return 4===r.type&&r.value!==Ih}function kd(r,o,l){return o===(4!==r.type||l?r.value:Ih)}function h_(r,o,l){let g=4;const C=r.attrs||[],D=function Sh(r){for(let o=0;o<r.length;o++)if(Ys(r[o]))return o;return r.length}(C);let R=!1;for(let B=0;B<o.length;B++){const Z=o[B];if("number"!=typeof Z){if(!R)if(4&g){if(g=2|1&g,""!==Z&&!kd(r,Z,l)||""===Z&&1===o.length){if(Ba(g))return!1;R=!0}}else{const ae=8&g?Z:o[++B];if(8&g&&null!==r.attrs){if(!d_(r.attrs,ae,l)){if(Ba(g))return!1;R=!0}continue}const it=p_(8&g?"class":Z,C,Up(r),l);if(-1===it){if(Ba(g))return!1;R=!0;continue}if(""!==ae){let Nt;Nt=it>D?"":C[it+1].toLowerCase();const sn=8&g?Nt:null;if(sn&&-1!==Dh(sn,ae,0)||2&g&&ae!==Nt){if(Ba(g))return!1;R=!0}}}}else{if(!R&&!Ba(g)&&!Ba(Z))return!1;if(R&&Ba(Z))continue;R=!1,g=Z|1&g}}return Ba(g)||R}function Ba(r){return 0==(1&r)}function p_(r,o,l,g){if(null===o)return-1;let C=0;if(g||!l){let D=!1;for(;C<o.length;){const R=o[C];if(R===r)return C;if(3===R||6===R)D=!0;else{if(1===R||2===R){let B=o[++C];for(;"string"==typeof B;)B=o[++C];continue}if(4===R)break;if(0===R){C+=4;continue}}C+=D?1:2}return-1}return function f_(r,o){let l=r.indexOf(4);if(l>-1)for(l++;l<r.length;){const g=r[l];if("number"==typeof g)return-1;if(g===o)return l;l++}return-1}(o,r)}function Mh(r,o,l=!1){for(let g=0;g<o.length;g++)if(h_(r,o[g],l))return!0;return!1}function m_(r,o){e:for(let l=0;l<o.length;l++){const g=o[l];if(r.length===g.length){for(let C=0;C<r.length;C++)if(r[C]!==g[C])continue e;return!0}}return!1}function zm(r,o){return r?":not("+o.trim()+")":o}function g_(r){let o=r[0],l=1,g=2,C="",D=!1;for(;l<r.length;){let R=r[l];if("string"==typeof R)if(2&g){const B=r[++l];C+="["+R+(B.length>0?'="'+B+'"':"")+"]"}else 8&g?C+="."+R:4&g&&(C+=" "+R);else""!==C&&!Ba(R)&&(o+=zm(D,C),C=""),g=R,D=D||!Ba(g);l++}return""!==C&&(o+=zm(D,C)),o}const $i={};function Um(r){jp(ki(),Rn(),ao()+r,!1)}function jp(r,o,l,g){if(!g)if(3==(3&o[fe])){const D=r.preOrderCheckHooks;null!==D&&Se(o,D,l)}else{const D=r.preOrderHooks;null!==D&&ht(o,D,0,l)}Rs(l)}function Ah(r,o=null,l=null,g){const C=Bd(r,o,l,g);return C.resolveInjectorInitializers(),C}function Bd(r,o=null,l=null,g,C=new Set){const D=[l||We,Qg(r)];return g=g||("object"==typeof r?void 0:pe(r)),new xu(D,o||Od(),g||null,C)}let zl=(()=>{class r{static create(l,g){if(Array.isArray(l))return Ah({name:""},g,l,"");{const C=l.name??"";return Ah({name:C},l.parent,l.providers,C)}}}return r.THROW_IF_NOT_FOUND=pi,r.NULL=new xh,r.\u0275prov=ot({token:r,providedIn:"any",factory:()=>_n(vh)}),r.__NG_ELEMENT_ID__=-1,r})();function pc(r,o=Vt.Default){const l=Rn();return null===l?_n(r,o):Al(so(),l,Pe(r),o)}function qm(){throw new Error("invalid")}function Xp(r,o){const l=r.contentQueries;if(null!==l)for(let g=0;g<l.length;g+=2){const D=l[g+1];if(-1!==D){const R=r.data[D];sr(l[g]),R.contentQueries(2,o[D],D)}}}function Lh(r,o,l,g,C,D,R,B,Z,ae,Ae){const it=o.blueprint.slice();return it[si]=C,it[fe]=76|g,(null!==Ae||r&&1024&r[fe])&&(it[fe]|=1024),Y(it),it[$e]=it[Fi]=r,it[gt]=l,it[gn]=R||r&&r[gn],it[Yt]=B||r&&r[Yt],it[Gn]=Z||r&&r[Gn]||null,it[Ft]=ae||r&&r[Ft]||null,it[en]=D,it[zr]=function em(){return Rc++}(),it[hr]=Ae,it[Vi]=2==o.type?r[Vi]:it,it}function Yu(r,o,l,g,C){let D=r.data[o];if(null===D)D=function Kp(r,o,l,g,C){const D=Wl(),R=Hs(),Z=r.data[o]=function O_(r,o,l,g,C,D){return{type:l,index:g,insertBeforeIndex:null,injectorIndex:o?o.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:0,providerIndexes:0,value:C,attrs:D,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,prev:null,projectionNext:null,child:null,parent:o,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,R?D:D&&D.parent,l,o,g,C);return null===r.firstChild&&(r.firstChild=Z),null!==D&&(R?null==D.child&&null!==Z.parent&&(D.child=Z):null===D.next&&(D.next=Z,Z.prev=D)),Z}(r,o,l,g,C),function Et(){return Te.lFrame.inI18n}()&&(D.flags|=32);else if(64&D.type){D.type=l,D.value=g,D.attrs=C;const R=function Gs(){const r=Te.lFrame,o=r.currentTNode;return r.isParent?o:o.parent}();D.injectorIndex=null===R?-1:R.injectorIndex}return Qo(D,!0),D}function Ud(r,o,l,g){if(0===l)return-1;const C=o.length;for(let D=0;D<l;D++)o.push(g),r.blueprint.push(g),r.data.push(null);return C}function Fh(r,o,l){Os(o);try{const g=r.viewQuery;null!==g&&jh(1,g,l);const C=r.template;null!==C&&ls(r,o,C,1,l),r.firstCreatePass&&(r.firstCreatePass=!1),r.staticContentQueries&&Xp(r,o),r.staticViewQueries&&jh(2,r.viewQuery,l);const D=r.components;null!==D&&function A_(r,o){for(let l=0;l<o.length;l++)lf(r,o[l])}(o,D)}catch(g){throw r.firstCreatePass&&(r.incompleteFirstPass=!0,r.firstCreatePass=!1),g}finally{o[fe]&=-5,vs()}}function kh(r,o,l,g){const C=o[fe];if(128!=(128&C)){Os(o);try{Y(o),function S(r){return Te.lFrame.bindingIndex=r}(r.bindingStartIndex),null!==l&&ls(r,o,l,2,g);const R=3==(3&C);if(R){const ae=r.preOrderCheckHooks;null!==ae&&Se(o,ae,null)}else{const ae=r.preOrderHooks;null!==ae&&ht(o,ae,0,null),hn(o,0)}if(function Na(r){for(let o=hp(r);null!==o;o=pp(o)){if(!o[ro])continue;const l=o[br];for(let g=0;g<l.length;g++){const C=l[g];512&C[fe]||W(C[$e],1),C[fe]|=512}}}(o),function ng(r){for(let o=hp(r);null!==o;o=pp(o))for(let l=Ur;l<o.length;l++){const g=o[l],C=g[En];Go(g)&&kh(C,g,C.template,g[gt])}}(o),null!==r.contentQueries&&Xp(r,o),R){const ae=r.contentCheckHooks;null!==ae&&Se(o,ae)}else{const ae=r.contentHooks;null!==ae&&ht(o,ae,1),hn(o,1)}!function Ym(r,o){const l=r.hostBindingOpCodes;if(null!==l)try{for(let g=0;g<l.length;g++){const C=l[g];if(C<0)Rs(~C);else{const D=C,R=l[++g],B=l[++g];Vn(R,D),B(2,o[D])}}}finally{Rs(-1)}}(r,o);const B=r.components;null!==B&&function Jm(r,o){for(let l=0;l<o.length;l++)$d(r,o[l])}(o,B);const Z=r.viewQuery;if(null!==Z&&jh(2,Z,g),R){const ae=r.viewCheckHooks;null!==ae&&Se(o,ae)}else{const ae=r.viewHooks;null!==ae&&ht(o,ae,2),hn(o,2)}!0===r.firstUpdatePass&&(r.firstUpdatePass=!1),o[fe]&=-41,512&o[fe]&&(o[fe]&=-513,W(o[$e],-1))}finally{vs()}}}function ls(r,o,l,g,C){const D=ao(),R=2&g;try{Rs(-1),R&&o.length>lr&&jp(r,o,lr,!1),co(R?2:0,C),l(g,C)}finally{Rs(D),co(R?3:1,C)}}function tl(r,o,l){if(hs(o)){const C=o.directiveEnd;for(let D=o.directiveStart;D<C;D++){const R=r.data[D];R.contentQueries&&R.contentQueries(1,l[D],D)}}}function Vd(r,o,l){Fo()&&(function F_(r,o,l,g){const C=l.directiveStart,D=l.directiveEnd;Ro(l)&&function tg(r,o,l){const g=vi(o,r),C=Tu(l),D=r[gn],R=Uh(r,Lh(r,C,null,l.onPush?32:16,g,o,D,D.createRenderer(g,l),null,null,null));r[o.index]=R}(o,l,r.data[C+l.componentOffset]),r.firstCreatePass||Sl(l,o),Us(g,o);const R=l.initialInputs;for(let B=C;B<D;B++){const Z=r.data[B],ae=ta(o,r,B,l);Us(ae,o),null!==R&&U_(0,B-C,ae,Z,0,R),Qr(Z)&&(Mr(l.index,o)[gt]=ta(o,r,B,l))}}(r,o,l,vi(l,o)),64==(64&l.flags)&&eg(r,o,l))}function Ju(r,o,l=vi){const g=o.localNames;if(null!==g){let C=o.index+1;for(let D=0;D<g.length;D+=2){const R=g[D+1],B=-1===R?l(o,r):r[R];r[C++]=B}}}function Tu(r){const o=r.tView;return null===o||o.incompleteFirstPass?r.tView=Qp(1,null,r.template,r.decls,r.vars,r.directiveDefs,r.pipeDefs,r.viewQuery,r.schemas,r.consts):o}function Qp(r,o,l,g,C,D,R,B,Z,ae){const Ae=lr+g,it=Ae+C,Nt=function P_(r,o){const l=[];for(let g=0;g<o;g++)l.push(g<r?null:$i);return l}(Ae,it),sn="function"==typeof ae?ae():ae;return Nt[En]={type:r,blueprint:Nt,template:l,queries:null,viewQuery:B,declTNode:o,data:Nt.slice().fill(null,Ae),bindingStartIndex:Ae,expandoStartIndex:it,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof D?D():D,pipeRegistry:"function"==typeof R?R():R,firstChild:null,schemas:Z,consts:sn,incompleteFirstPass:!1}}function Xm(r,o,l,g){const C=$h(o);null===l?C.push(g):(C.push(l),r.firstCreatePass&&cf(r).push(g,C.length-1))}function Xu(r,o,l,g){for(let C in r)if(r.hasOwnProperty(C)){l=null===l?{}:l;const D=r[C];null===g?ef(l,o,C,D):g.hasOwnProperty(C)&&ef(l,o,g[C],D)}return l}function ef(r,o,l,g){r.hasOwnProperty(l)?r[l].push(o,g):r[l]=[o,g]}function sa(r,o,l,g,C,D,R,B){const Z=vi(o,l);let Ae,ae=o.inputs;!B&&null!=ae&&(Ae=ae[g])?(xl(r,l,Ae,g,C),Ro(o)&&tf(l,o.index)):3&o.type&&(g=function $r(r){return"class"===r?"className":"for"===r?"htmlFor":"formaction"===r?"formAction":"innerHtml"===r?"innerHTML":"readonly"===r?"readOnly":"tabindex"===r?"tabIndex":r}(g),C=null!=R?R(C,o.value||"",g):C,D.setProperty(Z,g,C))}function tf(r,o){const l=Mr(o,r);16&l[fe]||(l[fe]|=32)}function Hc(r,o,l,g){if(Fo()){const C=null===g?null:{"":-1},D=function B_(r,o){const l=r.directiveRegistry;let g=null,C=null;if(l)for(let D=0;D<l.length;D++){const R=l[D];if(Mh(o,R.selectors,!1))if(g||(g=[]),Qr(R))if(null!==R.findHostDirectiveDefs){const B=[];C=C||new Map,R.findHostDirectiveDefs(R,B,C),g.unshift(...B,R),rf(r,o,B.length)}else g.unshift(R),rf(r,o,0);else C=C||new Map,R.findHostDirectiveDefs?.(R,g,C),g.push(R)}return null===g?null:[g,C]}(r,l);let R,B;null===D?R=B=null:[R,B]=D,null!==R&&nf(r,o,l,R,C,B),C&&function N_(r,o,l){if(o){const g=r.localNames=[];for(let C=0;C<o.length;C+=2){const D=l[o[C+1]];if(null==D)throw new ge(-301,!1);g.push(o[C],D)}}}(l,g,C)}l.mergedAttrs=Ls(l.mergedAttrs,l.attrs)}function nf(r,o,l,g,C,D){for(let ae=0;ae<g.length;ae++)Kl(Sl(l,o),r,g[ae].type);!function Bh(r,o,l){r.flags|=1,r.directiveStart=o,r.directiveEnd=o+l,r.providerIndexes=o}(l,r.data.length,g.length);for(let ae=0;ae<g.length;ae++){const Ae=g[ae];Ae.providersResolver&&Ae.providersResolver(Ae)}let R=!1,B=!1,Z=Ud(r,o,g.length,null);for(let ae=0;ae<g.length;ae++){const Ae=g[ae];l.mergedAttrs=Ls(l.mergedAttrs,Ae.hostAttrs),Ku(r,l,o,Z,Ae),z_(Z,Ae,C),null!==Ae.contentQueries&&(l.flags|=4),(null!==Ae.hostBindings||null!==Ae.hostAttrs||0!==Ae.hostVars)&&(l.flags|=64);const it=Ae.type.prototype;!R&&(it.ngOnChanges||it.ngOnInit||it.ngDoCheck)&&((r.preOrderHooks||(r.preOrderHooks=[])).push(l.index),R=!0),!B&&(it.ngOnChanges||it.ngDoCheck)&&((r.preOrderCheckHooks||(r.preOrderCheckHooks=[])).push(l.index),B=!0),Z++}!function Km(r,o,l){const C=o.directiveEnd,D=r.data,R=o.attrs,B=[];let Z=null,ae=null;for(let Ae=o.directiveStart;Ae<C;Ae++){const it=D[Ae],Nt=l?l.get(it):null,Mn=Nt?Nt.outputs:null;Z=Xu(it.inputs,Ae,Z,Nt?Nt.inputs:null),ae=Xu(it.outputs,Ae,ae,Mn);const Jn=null===Z||null===R||Up(o)?null:af(Z,Ae,R);B.push(Jn)}null!==Z&&(Z.hasOwnProperty("class")&&(o.flags|=8),Z.hasOwnProperty("style")&&(o.flags|=16)),o.initialInputs=B,o.inputs=Z,o.outputs=ae}(r,l,D)}function eg(r,o,l){const g=l.directiveStart,C=l.directiveEnd,D=l.index,R=function Ci(){return Te.lFrame.currentDirectiveIndex}();try{Rs(D);for(let B=g;B<C;B++){const Z=r.data[B],ae=o[B];ii(B),(null!==Z.hostBindings||0!==Z.hostVars||null!==Z.hostAttrs)&&k_(Z,ae)}}finally{Rs(-1),ii(R)}}function k_(r,o){null!==r.hostBindings&&r.hostBindings(1,o)}function rf(r,o,l){o.componentOffset=l,(r.components||(r.components=[])).push(o.index)}function z_(r,o,l){if(l){if(o.exportAs)for(let g=0;g<o.exportAs.length;g++)l[o.exportAs[g]]=r;Qr(o)&&(l[""]=r)}}function Ku(r,o,l,g,C){r.data[g]=C;const D=C.factory||(C.factory=Mo(C.type)),R=new tr(D,Qr(C),pc);r.blueprint[g]=R,l[g]=R,function R_(r,o,l,g,C){const D=C.hostBindings;if(D){let R=r.hostBindingOpCodes;null===R&&(R=r.hostBindingOpCodes=[]);const B=~o.index;(function L_(r){let o=r.length;for(;o>0;){const l=r[--o];if("number"==typeof l&&l<0)return l}return 0})(R)!=B&&R.push(B),R.push(l,g,D)}}(r,o,g,Ud(r,l,C.hostVars,$i),C)}function Ul(r,o,l,g,C,D){const R=vi(r,o);!function sf(r,o,l,g,C,D,R){if(null==D)r.removeAttribute(o,C,l);else{const B=null==R?Le(D):R(D,g||"",C);r.setAttribute(o,C,B,l)}}(o[Yt],R,D,r.value,l,g,C)}function U_(r,o,l,g,C,D){const R=D[o];if(null!==R){const B=g.setInput;for(let Z=0;Z<R.length;){const ae=R[Z++],Ae=R[Z++],it=R[Z++];null!==B?g.setInput(l,it,ae,Ae):l[Ae]=it}}}function af(r,o,l){let g=null,C=0;for(;C<l.length;){const D=l[C];if(0!==D)if(5!==D){if("number"==typeof D)break;if(r.hasOwnProperty(D)){null===g&&(g=[]);const R=r[D];for(let B=0;B<R.length;B+=2)if(R[B]===o){g.push(D,R[B+1],l[C+1]);break}}C+=2}else C+=2;else C+=4}return g}function Nh(r,o,l,g){return[r,!0,!1,o,null,0,g,l,null,null]}function $d(r,o){const l=Mr(o,r);if(Go(l)){const g=l[En];48&l[fe]?kh(g,l,g.template,l[gt]):l[zt]>0&&Wc(l)}}function Wc(r){for(let g=hp(r);null!==g;g=pp(g))for(let C=Ur;C<g.length;C++){const D=g[C];if(Go(D))if(512&D[fe]){const R=D[En];kh(R,D,R.template,D[gt])}else D[zt]>0&&Wc(D)}const l=r[En].components;if(null!==l)for(let g=0;g<l.length;g++){const C=Mr(l[g],r);Go(C)&&C[zt]>0&&Wc(C)}}function lf(r,o){const l=Mr(o,r),g=l[En];(function zh(r,o){for(let l=o.length;l<r.blueprint.length;l++)o.push(r.blueprint[l])})(g,l),Fh(g,l,l[gt])}function Uh(r,o){return r[Hn]?r[Ai][ct]=o:r[Hn]=o,r[Ai]=o,o}function Vh(r){for(;r;){r[fe]|=32;const o=Lc(r);if(js(r)&&!o)return r;r=o}return null}function Zd(r,o,l,g=!0){const C=o[gn];C.begin&&C.begin();try{kh(r,o,r.template,l)}catch(R){throw g&&uf(o,R),R}finally{C.end&&C.end()}}function jh(r,o,l){sr(0),o(r,l)}function $h(r){return r[je]||(r[je]=[])}function cf(r){return r.cleanup||(r.cleanup=[])}function uf(r,o){const l=r[Ft],g=l?l.get(Fd,null):null;g&&g.handleError(o)}function xl(r,o,l,g,C){for(let D=0;D<l.length;){const R=l[D++],B=l[D++],Z=o[R],ae=r.data[R];null!==ae.setInput?ae.setInput(Z,C,g,B):Z[B]=C}}function Vl(r,o,l){const g=_s(o,r);!function pu(r,o,l){r.setValue(o,l)}(r[Yt],g,l)}function Gd(r,o,l){let g=l?r.styles:null,C=l?r.classes:null,D=0;if(null!==o)for(let R=0;R<o.length;R++){const B=o[R];"number"==typeof B?D=B:1==D?C=ze(C,B):2==D&&(g=ze(g,B+": "+o[++R]+";"))}l?r.styles=g:r.stylesWithoutHost=g,l?r.classes=C:r.classesWithoutHost=C}function Hd(r,o,l,g,C=!1){for(;null!==l;){const D=o[l.index];if(null!==D&&g.push(kr(D)),_r(D))for(let B=Ur;B<D.length;B++){const Z=D[B],ae=Z[En].firstChild;null!==ae&&Hd(Z[En],Z,ae,g)}const R=l.type;if(8&R)Hd(r,o,l.child,g);else if(32&R){const B=ku(l,o);let Z;for(;Z=B();)g.push(Z)}else if(16&R){const B=fm(o,l);if(Array.isArray(B))g.push(...B);else{const Z=Lc(o[Vi]);Hd(Z[En],Z,B,g,!0)}}l=C?l.projectionNext:l.next}return g}class Qu{get rootNodes(){const o=this._lView,l=o[En];return Hd(l,o,l.firstChild,[])}constructor(o,l){this._lView=o,this._cdRefInjectingView=l,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[gt]}set context(o){this._lView[gt]=o}get destroyed(){return 128==(128&this._lView[fe])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const o=this._lView[$e];if(_r(o)){const l=o[Ko],g=l?l.indexOf(this):-1;g>-1&&(dh(o,g),nc(l,g))}this._attachedToViewContainer=!1}pd(this._lView[En],this._lView)}onDestroy(o){Xm(this._lView[En],this._lView,null,o)}markForCheck(){Vh(this._cdRefInjectingView||this._lView)}detach(){this._lView[fe]&=-65}reattach(){this._lView[fe]|=64}detectChanges(){Zd(this._lView[En],this._lView,this.context)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new ge(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function fu(r,o){Fl(r,o,o[Yt],2,null,null)}(this._lView[En],this._lView)}attachToAppRef(o){if(this._attachedToViewContainer)throw new ge(902,!1);this._appRef=o}}class j_ extends Qu{constructor(o){super(o),this._view=o}detectChanges(){const o=this._view;Zd(o[En],o,o[gt],!1)}checkNoChanges(){}get context(){return null}}class rg extends Ts{constructor(o){super(),this.ngModule=o}resolveComponentFactory(o){const l=bi(o);return new ed(l,this.ngModule)}}function df(r){const o=[];for(let l in r)r.hasOwnProperty(l)&&o.push({propName:r[l],templateName:l});return o}class Wd{constructor(o,l){this.injector=o,this.parentInjector=l}get(o,l,g){g=z(g);const C=this.injector.get(o,Fp,g);return C!==Fp||l===Fp?C:this.parentInjector.get(o,l,g)}}class ed extends Rp{get inputs(){return df(this.componentDef.inputs)}get outputs(){return df(this.componentDef.outputs)}constructor(o,l){super(),this.componentDef=o,this.ngModule=l,this.componentType=o.type,this.selector=function __(r){return r.map(g_).join(",")}(o.selectors),this.ngContentSelectors=o.ngContentSelectors?o.ngContentSelectors:[],this.isBoundToModule=!!l}create(o,l,g,C){let D=(C=C||this.ngModule)instanceof vu?C:C?.injector;D&&null!==this.componentDef.getStandaloneInjector&&(D=this.componentDef.getStandaloneInjector(D)||D);const R=D?new Wd(o,D):o,B=R.get(Bm,null);if(null===B)throw new ge(407,!1);const Z=R.get(Nm,null),ae=B.createRenderer(null,this.componentDef),Ae=this.componentDef.selectors[0][0]||"div",it=g?function jd(r,o,l){return r.selectRootElement(o,l===Be.ShadowDom)}(ae,g,this.componentDef.encapsulation):Ra(ae,Ae,function og(r){const o=r.toLowerCase();return"svg"===o?"svg":"math"===o?"math":null}(Ae)),Nt=this.componentDef.onPush?288:272,sn=Qp(0,null,null,1,0,null,null,null,null,null),Mn=Lh(null,sn,null,Nt,null,null,B,ae,Z,R,null);let Jn,li;Os(Mn);try{const xi=this.componentDef;let Ui,jn=null;xi.findHostDirectiveDefs?(Ui=[],jn=new Map,xi.findHostDirectiveDefs(xi,Ui,jn),Ui.push(xi)):Ui=[xi];const rr=function td(r,o){const l=r[En],g=lr;return r[g]=o,Yu(l,g,2,"#host",null)}(Mn,it),Oo=function lg(r,o,l,g,C,D,R,B){const Z=C[En];!function Zh(r,o,l,g){for(const C of r)o.mergedAttrs=Ls(o.mergedAttrs,C.hostAttrs);null!==o.mergedAttrs&&(Gd(o,o.mergedAttrs,!0),null!==l&&Nu(g,l,o))}(g,r,o,R);const ae=D.createRenderer(o,l),Ae=Lh(C,Tu(l),null,l.onPush?32:16,C[r.index],r,D,ae,B||null,null,null);return Z.firstCreatePass&&rf(Z,r,g.length-1),Uh(C,Ae),C[r.index]=Ae}(rr,it,xi,Ui,Mn,B,ae);li=ja(sn,lr),it&&function Gh(r,o,l,g){if(g)Ho(r,l,["ng-version",Ld.full]);else{const{attrs:C,classes:D}=function y_(r){const o=[],l=[];let g=1,C=2;for(;g<r.length;){let D=r[g];if("string"==typeof D)2===C?""!==D&&o.push(D,r[++g]):8===C&&l.push(D);else{if(!Ba(C))break;C=D}g++}return{attrs:o,classes:l}}(o.selectors[0]);C&&Ho(r,l,C),D&&D.length>0&&wa(r,l,D.join(" "))}}(ae,xi,it,g),void 0!==l&&function Hh(r,o,l){const g=r.projection=[];for(let C=0;C<o.length;C++){const D=l[C];g.push(null!=D?Array.from(D):null)}}(li,this.ngContentSelectors,l),Jn=function cg(r,o,l,g,C,D){const R=so(),B=C[En],Z=vi(R,C);nf(B,C,R,l,null,g);for(let Ae=0;Ae<l.length;Ae++)Us(ta(C,B,R.directiveStart+Ae,R),C);eg(B,C,R),Z&&Us(Z,C);const ae=ta(C,B,R.directiveStart+R.componentOffset,R);if(r[gt]=C[gt]=ae,null!==D)for(const Ae of D)Ae(ae,o);return tl(B,R,r),ae}(Oo,xi,Ui,jn,Mn,[$_]),Fh(sn,Mn,null)}finally{vs()}return new sg(this.componentType,Jn,$c(li,Mn),Mn,li)}}class sg extends n_{constructor(o,l,g,C,D){super(),this.location=g,this._rootLView=C,this._tNode=D,this.instance=l,this.hostView=this.changeDetectorRef=new j_(C),this.componentType=o}setInput(o,l){const g=this._tNode.inputs;let C;if(null!==g&&(C=g[o])){const D=this._rootLView;xl(D[En],D,C,o,l),tf(D,this._tNode.index)}}get injector(){return new Ol(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(o){this.hostView.onDestroy(o)}}function $_(){const r=so();H(Rn()[En],r)}function hf(r){let o=function ug(r){return Object.getPrototypeOf(r.prototype).constructor}(r.type),l=!0;const g=[r];for(;o;){let C;if(Qr(r))C=o.\u0275cmp||o.\u0275dir;else{if(o.\u0275cmp)throw new ge(903,!1);C=o.\u0275dir}if(C){if(l){g.push(C);const R=r;R.inputs=pf(r.inputs),R.declaredInputs=pf(r.declaredInputs),R.outputs=pf(r.outputs);const B=C.hostBindings;B&&G_(r,B);const Z=C.viewQuery,ae=C.contentQueries;if(Z&&nd(r,Z),ae&&ff(r,ae),xe(r.inputs,C.inputs),xe(r.declaredInputs,C.declaredInputs),xe(r.outputs,C.outputs),Qr(C)&&C.data.animation){const Ae=r.data;Ae.animation=(Ae.animation||[]).concat(C.data.animation)}}const D=C.features;if(D)for(let R=0;R<D.length;R++){const B=D[R];B&&B.ngInherit&&B(r),B===hf&&(l=!1)}}o=Object.getPrototypeOf(o)}!function Z_(r){let o=0,l=null;for(let g=r.length-1;g>=0;g--){const C=r[g];C.hostVars=o+=C.hostVars,C.hostAttrs=Ls(C.hostAttrs,l=Ls(l,C.hostAttrs))}}(g)}function pf(r){return r===Me?{}:r===We?[]:r}function nd(r,o){const l=r.viewQuery;r.viewQuery=l?(g,C)=>{o(g,C),l(g,C)}:o}function ff(r,o){const l=r.contentQueries;r.contentQueries=l?(g,C,D)=>{o(g,C,D),l(g,C,D)}:o}function G_(r,o){const l=r.hostBindings;r.hostBindings=l?(g,C)=>{o(g,C),l(g,C)}:o}function qd(r){return!!jl(r)&&(Array.isArray(r)||!(r instanceof Map)&&Symbol.iterator in r)}function jl(r){return null!==r&&("function"==typeof r||"object"==typeof r)}function Ta(r,o,l){return r[o]=l}function Wo(r,o,l){return!Object.is(r[o],l)&&(r[o]=l,!0)}function bl(r,o,l,g){const C=Wo(r,o,l);return Wo(r,o+1,g)||C}function yf(r,o,l,g){const C=Rn();return Wo(C,j(),o)&&(ki(),Ul(wr(),C,r,o,l,g)),yf}function gc(r,o,l,g){return Wo(r,j(),l)?o+Le(l)+g:$i}function Iu(r,o,l,g,C,D,R,B){const ae=function Du(r,o,l,g,C){const D=bl(r,o,l,g);return Wo(r,o+2,C)||D}(r,G(),l,C,R);return _e(3),ae?o+Le(l)+g+Le(C)+D+Le(R)+B:$i}function Mu(r,o,l,g,C,D,R,B,Z,ae){const it=function nl(r,o,l,g,C,D){const R=bl(r,o,l,g);return bl(r,o+2,C,D)||R}(r,G(),l,C,R,Z);return _e(4),it?o+Le(l)+g+Le(C)+D+Le(R)+B+Le(Z)+ae:$i}function _g(r,o,l,g,C,D,R,B){const Z=Rn(),ae=ki(),Ae=r+lr,it=ae.firstCreatePass?function qc(r,o,l,g,C,D,R,B,Z){const ae=o.consts,Ae=Yu(o,r,4,R||null,te(ae,B));Hc(o,l,Ae,te(ae,Z)),H(o,Ae);const it=Ae.tViews=Qp(2,Ae,g,C,D,o.directiveRegistry,o.pipeRegistry,null,o.schemas,ae);return null!==o.queries&&(o.queries.template(o,Ae),it.queries=o.queries.embeddedTView(Ae)),Ae}(Ae,ae,Z,o,l,g,C,D,R):ae.data[Ae];Qo(it,!1);const Nt=Z[Yt].createComment("");_d(ae,Z,Nt,it),Us(Nt,Z),Uh(Z,Z[Ae]=Nh(Nt,Z,Nt,it)),lo(it)&&Vd(ae,Z,it),null!=R&&Ju(Z,it,B)}function wf(r){return ys(function Ws(){return Te.lFrame.contextLView}(),lr+r)}function sd(r,o,l){const g=Rn();return Wo(g,j(),o)&&sa(ki(),wr(),g,r,o,g[Yt],l,!1),sd}function Cf(r,o,l,g,C){const R=C?"class":"style";xl(r,l,o.inputs[R],R,g)}function Yh(r,o,l,g){const C=Rn(),D=ki(),R=lr+r,B=C[Yt],Z=D.firstCreatePass?function J_(r,o,l,g,C,D){const R=o.consts,Z=Yu(o,r,2,g,te(R,C));return Hc(o,l,Z,te(R,D)),null!==Z.attrs&&Gd(Z,Z.attrs,!1),null!==Z.mergedAttrs&&Gd(Z,Z.mergedAttrs,!0),null!==o.queries&&o.queries.elementStart(o,Z),Z}(R,D,C,o,l,g):D.data[R],ae=C[R]=Ra(B,o,function U(){return Te.lFrame.currentNamespace}()),Ae=lo(Z);return Qo(Z,!0),Nu(B,ae,Z),32!=(32&Z.flags)&&_d(D,C,ae,Z),0===function pr(){return Te.lFrame.elementDepthCount}()&&Us(ae,C),function cr(){Te.lFrame.elementDepthCount++}(),Ae&&(Vd(D,C,Z),tl(D,Z,C)),null!==g&&Ju(C,Z),Yh}function Jh(){let r=so();Hs()?es():(r=r.parent,Qo(r,!1));const o=r;!function Ps(){Te.lFrame.elementDepthCount--}();const l=ki();return l.firstCreatePass&&(H(l,r),hs(r)&&l.queries.elementEnd(r)),null!=o.classesWithoutHost&&function zn(r){return 0!=(8&r.flags)}(o)&&Cf(l,o,Rn(),o.classesWithoutHost,!0),null!=o.stylesWithoutHost&&function vo(r){return 0!=(16&r.flags)}(o)&&Cf(l,o,Rn(),o.stylesWithoutHost,!1),Jh}function Kd(r,o,l,g){return Yh(r,o,l,g),Jh(),Kd}function Yc(r,o,l){const g=Rn(),C=ki(),D=r+lr,R=C.firstCreatePass?function X_(r,o,l,g,C){const D=o.consts,R=te(D,g),B=Yu(o,r,8,"ng-container",R);return null!==R&&Gd(B,R,!0),Hc(o,l,B,te(D,C)),null!==o.queries&&o.queries.elementStart(o,B),B}(D,C,g,o,l):C.data[D];Qo(R,!0);const B=g[D]=g[Yt].createComment("");return _d(C,g,B,R),Us(B,g),lo(R)&&(Vd(C,g,R),tl(C,R,g)),null!=l&&Ju(g,R),Yc}function Xh(){let r=so();const o=ki();return Hs()?es():(r=r.parent,Qo(r,!1)),o.firstCreatePass&&(H(o,r),hs(r)&&o.queries.elementEnd(r)),Xh}function Tf(r,o,l){return Yc(r,o,l),Xh(),Tf}function Ef(){return Rn()}function Df(r){return!!r&&"function"==typeof r.then}function If(r){return!!r&&"function"==typeof r.subscribe}const za=If;function il(r,o,l,g){const C=Rn(),D=ki(),R=so();return function yc(r,o,l,g,C,D,R){const B=lo(g),ae=r.firstCreatePass&&cf(r),Ae=o[gt],it=$h(o);let Nt=!0;if(3&g.type||R){const Jn=vi(g,o),li=R?R(Jn):Jn,xi=it.length,Ui=R?rr=>R(kr(rr[g.index])):g.index;let jn=null;if(!R&&B&&(jn=function $l(r,o,l,g){const C=r.cleanup;if(null!=C)for(let D=0;D<C.length-1;D+=2){const R=C[D];if(R===l&&C[D+1]===g){const B=o[je],Z=C[D+2];return B.length>Z?B[Z]:null}"string"==typeof R&&(D+=2)}return null}(r,o,C,g.index)),null!==jn)(jn.__ngLastListenerFn__||jn).__ngNextListenerFn__=D,jn.__ngLastListenerFn__=D,Nt=!1;else{D=Mf(g,o,Ae,D,!1);const rr=l.listen(li,C,D);it.push(D,rr),ae&&ae.push(C,Ui,xi,xi+1)}}else D=Mf(g,o,Ae,D,!1);const sn=g.outputs;let Mn;if(Nt&&null!==sn&&(Mn=sn[C])){const Jn=Mn.length;if(Jn)for(let li=0;li<Jn;li+=2){const Oo=o[Mn[li]][Mn[li+1]].subscribe(D),ds=it.length;it.push(D,Oo),ae&&ae.push(C,g.index,ds,-(ds+1))}}}(D,C,C[Yt],R,r,o,g),il}function Qd(r,o,l,g){try{return co(6,o,l),!1!==l(g)}catch(C){return uf(r,C),!1}finally{co(7,o,l)}}function Mf(r,o,l,g,C){return function D(R){if(R===Function)return g;Vh(r.componentOffset>-1?Mr(r.index,o):o);let Z=Qd(o,l,g,R),ae=D.__ngNextListenerFn__;for(;ae;)Z=Qd(o,l,ae,R)&&Z,ae=ae.__ngNextListenerFn__;return C&&!1===Z&&(R.preventDefault(),R.returnValue=!1),Z}}function Sf(r=1){return function Ha(r){return(Te.lFrame.contextLView=function ga(r,o){for(;r>0;)o=o[Fi],r--;return o}(r,Te.lFrame.contextLView))[gt]}(r)}function yg(r,o){let l=null;const g=function Vp(r){const o=r.attrs;if(null!=o){const l=o.indexOf(5);if(!(1&l))return o[l+1]}return null}(r);for(let C=0;C<o.length;C++){const D=o[C];if("*"!==D){if(null===g?Mh(r,D,!0):m_(g,D))return C}else l=C}return l}function Kh(r){const o=Rn()[Vi][en];if(!o.projection){const g=o.projection=Xa(r?r.length:1,null),C=g.slice();let D=o.child;for(;null!==D;){const R=r?yg(D,r):0;null!==R&&(C[R]?C[R].projectionNext=D:g[R]=D,C[R]=D),D=D.next}}}function vg(r,o=0,l){const g=Rn(),C=ki(),D=Yu(C,lr+r,16,null,l||null);null===D.projection&&(D.projection=o),es(),32!=(32&D.flags)&&function sc(r,o,l){ph(o[Yt],0,o,l,xo(r,l,o),Nc(l.parent||o[en],l,o))}(C,g,D)}function Qh(r,o,l){return ep(r,"",o,"",l),Qh}function ep(r,o,l,g,C){const D=Rn(),R=gc(D,o,l,g);return R!==$i&&sa(ki(),wr(),D,r,R,D[Yt],C,!1),ep}function tp(r,o){return r<<17|o<<2}function Ua(r){return r>>17&32767}function rl(r){return 2|r}function xc(r){return(131068&r)>>2}function th(r,o){return-131069&r|o<<2}function bc(r){return 1|r}function Nf(r,o,l,g,C){const D=r[l+1],R=null===o;let B=g?Ua(D):xc(D),Z=!1;for(;0!==B&&(!1===Z||R);){const Ae=r[B+1];xg(r[B],o)&&(Z=!0,r[B+1]=g?bc(Ae):rl(Ae)),B=g?Ua(Ae):xc(Ae)}Z&&(r[l+1]=g?rl(D):bc(D))}function xg(r,o){return null===r||null==o||(Array.isArray(r)?r[1]:r)===o||!(!Array.isArray(r)||"string"!=typeof o)&&p(r,o)>=0}function I(r,o,l){return ee(r,o,l,!1),I}function A(r,o){return ee(r,o,null,!0),A}function ee(r,o,l,g){const C=Rn(),D=ki(),R=_e(2);D.firstUpdatePass&&function et(r,o,l,g){const C=r.data;if(null===C[l+1]){const D=C[ao()],R=function Re(r,o){return o>=r.expandoStartIndex}(r,l);(function kn(r,o){return 0!=(r.flags&(o?8:16))})(D,g)&&null===o&&!R&&(o=!1),o=function pt(r,o,l,g){const C=function Gi(r){const o=Te.lFrame.currentDirectiveIndex;return-1===o?null:r[o]}(r);let D=g?o.residualClasses:o.residualStyles;if(null===C)0===(g?o.classBindings:o.styleBindings)&&(l=Qt(l=mt(null,r,o,l,g),o.attrs,g),D=null);else{const R=o.directiveStylingLast;if(-1===R||r[R]!==C)if(l=mt(C,r,o,l,g),null===D){let Z=function Ye(r,o,l){const g=l?o.classBindings:o.styleBindings;if(0!==xc(g))return r[Ua(g)]}(r,o,g);void 0!==Z&&Array.isArray(Z)&&(Z=mt(null,r,o,Z[1],g),Z=Qt(Z,o.attrs,g),function st(r,o,l,g){r[Ua(l?o.classBindings:o.styleBindings)]=g}(r,o,g,Z))}else D=function Ct(r,o,l){let g;const C=o.directiveEnd;for(let D=1+o.directiveStylingLast;D<C;D++)g=Qt(g,r[D].hostAttrs,l);return Qt(g,o.attrs,l)}(r,o,g)}return void 0!==D&&(g?o.residualClasses=D:o.residualStyles=D),l}(C,D,o,g),function nh(r,o,l,g,C,D){let R=D?o.classBindings:o.styleBindings,B=Ua(R),Z=xc(R);r[g]=l;let Ae,ae=!1;if(Array.isArray(l)?(Ae=l[1],(null===Ae||p(l,Ae)>0)&&(ae=!0)):Ae=l,C)if(0!==Z){const Nt=Ua(r[B+1]);r[g+1]=tp(Nt,B),0!==Nt&&(r[Nt+1]=th(r[Nt+1],g)),r[B+1]=function Bf(r,o){return 131071&r|o<<17}(r[B+1],g)}else r[g+1]=tp(B,0),0!==B&&(r[B+1]=th(r[B+1],g)),B=g;else r[g+1]=tp(Z,0),0===B?B=g:r[Z+1]=th(r[Z+1],g),Z=g;ae&&(r[g+1]=rl(r[g+1])),Nf(r,Ae,g,!0),Nf(r,Ae,g,!1),function np(r,o,l,g,C){const D=C?r.residualClasses:r.residualStyles;null!=D&&"string"==typeof o&&p(D,o)>=0&&(l[g+1]=bc(l[g+1]))}(o,Ae,r,g,D),R=tp(B,Z),D?o.classBindings=R:o.styleBindings=R}(C,D,o,l,R,g)}}(D,r,R,g),o!==$i&&Wo(C,R,o)&&function an(r,o,l,g,C,D,R,B){if(!(3&o.type))return;const Z=r.data,ae=Z[B+1],Ae=function Cl(r){return 1==(1&r)}(ae)?yn(Z,o,l,C,xc(ae),R):void 0;vn(Ae)||(vn(D)||function kf(r){return 2==(2&r)}(ae)&&(D=yn(Z,null,l,C,B,R)),function xd(r,o,l,g,C){if(o)C?r.addClass(l,g):r.removeClass(l,g);else{let D=-1===g.indexOf("-")?void 0:zs.DashCase;null==C?r.removeStyle(l,g,D):("string"==typeof C&&C.endsWith("!important")&&(C=C.slice(0,-10),D|=zs.Important),r.setStyle(l,g,C,D))}}(g,R,_s(ao(),l),C,D))}(D,D.data[ao()],C,C[Yt],r,C[R+1]=function Pn(r,o){return null==r||("string"==typeof o?r+=o:"object"==typeof r&&(r=pe(kl(r)))),r}(o,l),g,R)}function mt(r,o,l,g,C){let D=null;const R=l.directiveEnd;let B=l.directiveStylingLast;for(-1===B?B=l.directiveStart:B++;B<R&&(D=o[B],g=Qt(g,D.hostAttrs,C),D!==r);)B++;return null!==r&&(l.directiveStylingLast=B),g}function Qt(r,o,l){const g=l?1:2;let C=-1;if(null!==o)for(let D=0;D<o.length;D++){const R=o[D];"number"==typeof R?C=R:C===g&&(Array.isArray(r)||(r=void 0===r?[]:["",r]),y(r,R,!!l||o[++D]))}return void 0===r?null:r}function yn(r,o,l,g,C,D){const R=null===o;let B;for(;C>0;){const Z=r[C],ae=Array.isArray(Z),Ae=ae?Z[1]:Z,it=null===Ae;let Nt=l[C+1];Nt===$i&&(Nt=it?We:void 0);let sn=it?u(Nt,g):Ae===g?Nt:void 0;if(ae&&!vn(sn)&&(sn=u(Z,g)),vn(sn)&&(B=sn,R))return B;const Mn=r[C+1];C=R?Ua(Mn):xc(Mn)}if(null!==o){let Z=D?o.residualClasses:o.residualStyles;null!=Z&&(B=u(Z,g))}return B}function vn(r){return void 0!==r}function ln(r,o=""){const l=Rn(),g=ki(),C=r+lr,D=g.firstCreatePass?Yu(g,C,1,o,null):g.data[C],R=l[C]=function hu(r,o){return r.createText(o)}(l[Yt],o);_d(g,l,R,D),Qo(D,!1)}function $n(r){return _i("",r,""),$n}function _i(r,o,l){const g=Rn(),C=gc(g,r,o,l);return C!==$i&&Vl(g,ao(),C),_i}function Wn(r,o,l,g,C){const D=Rn(),R=function id(r,o,l,g,C,D){const B=bl(r,G(),l,C);return _e(2),B?o+Le(l)+g+Le(C)+D:$i}(D,r,o,l,g,C);return R!==$i&&Vl(D,ao(),R),Wn}function ni(r,o,l,g,C,D,R){const B=Rn(),Z=Iu(B,r,o,l,g,C,D,R);return Z!==$i&&Vl(B,ao(),Z),ni}function Zn(r,o,l,g,C,D,R,B,Z){const ae=Rn(),Ae=Mu(ae,r,o,l,g,C,D,R,B,Z);return Ae!==$i&&Vl(ae,ao(),Ae),Zn}const Jc=void 0;var Zf=["en",[["a","p"],["AM","PM"],Jc],[["AM","PM"],Jc,Jc],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Jc,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Jc,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Jc,"{1} 'at' {0}",Jc],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function $f(r){const l=Math.floor(Math.abs(r)),g=r.toString().replace(/^[^.]*\.?/,"").length;return 1===l&&0===g?1:5}];let aa={};function wc(r){const o=function Ea(r){return r.toLowerCase().replace(/_/g,"-")}(r);let l=Cc(o);if(l)return l;const g=o.split("-")[0];if(l=Cc(g),l)return l;if("en"===g)return Zf;throw new ge(701,!1)}function rp(r){return wc(r)[Ri.PluralCase]}function Cc(r){return r in aa||(aa[r]=rn.ng&&rn.ng.common&&rn.ng.common.locales&&rn.ng.common.locales[r]),aa[r]}var Ri=(()=>((Ri=Ri||{})[Ri.LocaleId=0]="LocaleId",Ri[Ri.DayPeriodsFormat=1]="DayPeriodsFormat",Ri[Ri.DayPeriodsStandalone=2]="DayPeriodsStandalone",Ri[Ri.DaysFormat=3]="DaysFormat",Ri[Ri.DaysStandalone=4]="DaysStandalone",Ri[Ri.MonthsFormat=5]="MonthsFormat",Ri[Ri.MonthsStandalone=6]="MonthsStandalone",Ri[Ri.Eras=7]="Eras",Ri[Ri.FirstDayOfWeek=8]="FirstDayOfWeek",Ri[Ri.WeekendRange=9]="WeekendRange",Ri[Ri.DateFormat=10]="DateFormat",Ri[Ri.TimeFormat=11]="TimeFormat",Ri[Ri.DateTimeFormat=12]="DateTimeFormat",Ri[Ri.NumberSymbols=13]="NumberSymbols",Ri[Ri.NumberFormats=14]="NumberFormats",Ri[Ri.CurrencyCode=15]="CurrencyCode",Ri[Ri.CurrencySymbol=16]="CurrencySymbol",Ri[Ri.CurrencyName=17]="CurrencyName",Ri[Ri.Currencies=18]="Currencies",Ri[Ri.Directionality=19]="Directionality",Ri[Ri.PluralCase=20]="PluralCase",Ri[Ri.ExtraData=21]="ExtraData",Ri))();const Xc="en-US";let jy=Xc;function ry(r,o,l,g,C){if(r=Pe(r),Array.isArray(r))for(let D=0;D<r.length;D++)ry(r[D],o,l,g,C);else{const D=ki(),R=Rn();let B=cc(r)?r:Pe(r.provide),Z=Om(r);const ae=so(),Ae=1048575&ae.providerIndexes,it=ae.directiveStart,Nt=ae.providerIndexes>>20;if(cc(r)||!r.multi){const sn=new tr(Z,C,pc),Mn=sy(B,o,C?Ae:Ae+Nt,it);-1===Mn?(Kl(Sl(ae,R),D,B),oy(D,r,o.length),o.push(B),ae.directiveStart++,ae.directiveEnd++,C&&(ae.providerIndexes+=1048576),l.push(sn),R.push(sn)):(l[Mn]=sn,R[Mn]=sn)}else{const sn=sy(B,o,Ae+Nt,it),Mn=sy(B,o,Ae,Ae+Nt),li=Mn>=0&&l[Mn];if(C&&!li||!C&&!(sn>=0&&l[sn])){Kl(Sl(ae,R),D,B);const xi=function Lx(r,o,l,g,C){const D=new tr(r,l,pc);return D.multi=[],D.index=o,D.componentProviders=0,pv(D,C,g&&!l),D}(C?Rx:Ox,l.length,C,g,Z);!C&&li&&(l[Mn].providerFactory=xi),oy(D,r,o.length,0),o.push(B),ae.directiveStart++,ae.directiveEnd++,C&&(ae.providerIndexes+=1048576),l.push(xi),R.push(xi)}else oy(D,r,sn>-1?sn:Mn,pv(l[C?Mn:sn],Z,!C&&g));!C&&g&&li&&l[Mn].componentProviders++}}}function oy(r,o,l,g){const C=cc(o),D=function e_(r){return!!r.useClass}(o);if(C||D){const Z=(D?Pe(o.useClass):o).prototype.ngOnDestroy;if(Z){const ae=r.destroyHooks||(r.destroyHooks=[]);if(!C&&o.multi){const Ae=ae.indexOf(l);-1===Ae?ae.push(l,[g,Z]):ae[Ae+1].push(g,Z)}else ae.push(l,Z)}}}function pv(r,o,l){return l&&r.componentProviders++,r.multi.push(o)-1}function sy(r,o,l,g){for(let C=l;C<g;C++)if(o[C]===r)return C;return-1}function Ox(r,o,l,g){return ay(this.multi,[])}function Rx(r,o,l,g){const C=this.multi;let D;if(this.providerFactory){const R=this.providerFactory.componentProviders,B=ta(l,l[En],this.providerFactory.index,g);D=B.slice(0,R),ay(C,D);for(let Z=R;Z<B.length;Z++)D.push(B[Z])}else D=[],ay(C,D);return D}function ay(r,o){for(let l=0;l<r.length;l++)o.push((0,r[l])());return o}function fv(r,o=[]){return l=>{l.providersResolver=(g,C)=>function Px(r,o,l){const g=ki();if(g.firstCreatePass){const C=Qr(r);ry(l,g.data,g.blueprint,C,!0),ry(o,g.data,g.blueprint,C,!1)}}(g,C?C(r):r,o)}}class op{}class mv{}function Fx(r,o){return new gv(r,o??null)}class gv extends op{constructor(o,l){super(),this._parent=l,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new rg(this);const g=In(o);this._bootstrapComponents=Nl(g.bootstrap),this._r3Injector=Bd(o,l,[{provide:op,useValue:this},{provide:Ts,useValue:this.componentFactoryResolver}],pe(o),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(o)}get injector(){return this._r3Injector}destroy(){const o=this._r3Injector;!o.destroyed&&o.destroy(),this.destroyCbs.forEach(l=>l()),this.destroyCbs=null}onDestroy(o){this.destroyCbs.push(o)}}class ly extends mv{constructor(o){super(),this.moduleType=o}create(o){return new gv(this.moduleType,o)}}class kx extends op{constructor(o,l,g){super(),this.componentFactoryResolver=new rg(this),this.instance=null;const C=new xu([...o,{provide:op,useValue:this},{provide:Ts,useValue:this.componentFactoryResolver}],l||Od(),g,new Set(["environment"]));this.injector=C,C.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(o){this.injector.onDestroy(o)}}function cy(r,o,l=null){return new kx(r,o,l).injector}let Bx=(()=>{class r{constructor(l){this._injector=l,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(l){if(!l.standalone)return null;if(!this.cachedInjectors.has(l.id)){const g=Bl(0,l.type),C=g.length>0?cy([g],this._injector,`Standalone[${l.type.name}]`):null;this.cachedInjectors.set(l.id,C)}return this.cachedInjectors.get(l.id)}ngOnDestroy(){try{for(const l of this.cachedInjectors.values())null!==l&&l.destroy()}finally{this.cachedInjectors.clear()}}}return r.\u0275prov=ot({token:r,providedIn:"environment",factory:()=>new r(_n(vu))}),r})();function _v(r){r.getStandaloneInjector=o=>o.get(Bx).getOrCreateStandaloneInjector(r)}function Tv(r,o,l){const g=M()+r,C=Rn();return C[g]===$i?Ta(C,g,l?o.call(l):o()):function mc(r,o){return r[o]}(C,g)}function Jf(r,o){const l=r[o];return l===$i?void 0:l}function Av(r,o){const l=ki();let g;const C=r+lr;l.firstCreatePass?(g=function t1(r,o){if(o)for(let l=o.length-1;l>=0;l--){const g=o[l];if(r===g.name)return g}}(o,l.pipeRegistry),l.data[C]=g,g.onDestroy&&(l.destroyHooks||(l.destroyHooks=[])).push(C,g.onDestroy)):g=l.data[C];const D=g.factory||(g.factory=Mo(g.type)),R=ie(pc);try{const B=cl(!1),Z=D();return cl(B),function bf(r,o,l,g){l>=r.data.length&&(r.data[l]=null,r.blueprint[l]=null),o[l]=g}(l,Rn(),C,Z),Z}finally{ie(R)}}function Pv(r,o,l){const g=r+lr,C=Rn(),D=ys(C,g);return Xf(C,g)?function Ev(r,o,l,g,C,D){const R=o+l;return Wo(r,R,C)?Ta(r,R+1,D?g.call(D,C):g(C)):Jf(r,R+1)}(C,M(),o,D.transform,l,D):D.transform(l)}function Ov(r,o,l,g){const C=r+lr,D=Rn(),R=ys(D,C);return Xf(D,C)?function Dv(r,o,l,g,C,D,R){const B=o+l;return bl(r,B,C,D)?Ta(r,B+2,R?g.call(R,C,D):g(C,D)):Jf(r,B+2)}(D,M(),o,R.transform,l,g,R):R.transform(l,g)}function Xf(r,o){return r[En].data[o].pure}function dy(r){return o=>{setTimeout(r,void 0,o)}}const Kc=class o1 extends d.x{constructor(o=!1){super(),this.__isAsync=o}emit(o){super.next(o)}subscribe(o,l,g){let C=o,D=l||(()=>null),R=g;if(o&&"object"==typeof o){const Z=o;C=Z.next?.bind(Z),D=Z.error?.bind(Z),R=Z.complete?.bind(Z)}this.__isAsync&&(D=dy(D),C&&(C=dy(C)),R&&(R=dy(R)));const B=super.subscribe({next:C,error:D,complete:R});return o instanceof v.w0&&o.add(B),B}};function s1(){return this._results[Symbol.iterator]()}class hy{get changes(){return this._changes||(this._changes=new Kc)}constructor(o=!1){this._emitDistinctChangesOnly=o,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=null,this.length=0,this.first=void 0,this.last=void 0;const l=hy.prototype;l[Symbol.iterator]||(l[Symbol.iterator]=s1)}get(o){return this._results[o]}map(o){return this._results.map(o)}filter(o){return this._results.filter(o)}find(o){return this._results.find(o)}reduce(o,l){return this._results.reduce(o,l)}forEach(o){this._results.forEach(o)}some(o){return this._results.some(o)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(o,l){const g=this;g.dirty=!1;const C=function Ns(r){return r.flat(Number.POSITIVE_INFINITY)}(o);(this._changesDetected=!function cu(r,o,l){if(r.length!==o.length)return!1;for(let g=0;g<r.length;g++){let C=r[g],D=o[g];if(l&&(C=l(C),D=l(D)),D!==C)return!1}return!0}(g._results,C,l))&&(g._results=C,g.length=C.length,g.last=C[this.length-1],g.first=C[0])}notifyOnChanges(){this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){this.changes.complete(),this.changes.unsubscribe()}}let Kf=(()=>{class r{}return r.__NG_ELEMENT_ID__=c1,r})();const a1=Kf,l1=class extends a1{constructor(o,l,g){super(),this._declarationLView=o,this._declarationTContainer=l,this.elementRef=g}createEmbeddedView(o,l){const g=this._declarationTContainer.tViews,C=Lh(this._declarationLView,g,o,16,null,g.declTNode,null,null,null,null,l||null);C[Ir]=this._declarationLView[this._declarationTContainer.index];const R=this._declarationLView[Hr];return null!==R&&(C[Hr]=R.createEmbeddedView(g)),Fh(g,C,o),new Qu(C)}};function c1(){return Sg(so(),Rn())}function Sg(r,o){return 4&r.type?new l1(o,r,$c(r,o)):null}let Ag=(()=>{class r{}return r.__NG_ELEMENT_ID__=u1,r})();function u1(){return Fv(so(),Rn())}const d1=Ag,Rv=class extends d1{constructor(o,l,g){super(),this._lContainer=o,this._hostTNode=l,this._hostLView=g}get element(){return $c(this._hostTNode,this._hostLView)}get injector(){return new Ol(this._hostTNode,this._hostLView)}get parentInjector(){const o=Sc(this._hostTNode,this._hostLView);if(Dl(o)){const l=uo(o,this._hostLView),g=Fs(o);return new Ol(l[En].data[g+8],l)}return new Ol(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(o){const l=Lv(this._lContainer);return null!==l&&l[o]||null}get length(){return this._lContainer.length-Ur}createEmbeddedView(o,l,g){let C,D;"number"==typeof g?C=g:null!=g&&(C=g.index,D=g.injector);const R=o.createEmbeddedView(l||{},D);return this.insert(R,C),R}createComponent(o,l,g,C,D){const R=o&&!function dl(r){return"function"==typeof r}(o);let B;if(R)B=l;else{const it=l||{};B=it.index,g=it.injector,C=it.projectableNodes,D=it.environmentInjector||it.ngModuleRef}const Z=R?o:new ed(bi(o)),ae=g||this.parentInjector;if(!D&&null==Z.ngModule){const Nt=(R?ae:this.parentInjector).get(vu,null);Nt&&(D=Nt)}const Ae=Z.create(ae,C,void 0,D);return this.insert(Ae.hostView,B),Ae}insert(o,l){const g=o._lView,C=g[En];if(function $a(r){return _r(r[$e])}(g)){const Ae=this.indexOf(o);if(-1!==Ae)this.detach(Ae);else{const it=g[$e],Nt=new Rv(it,it[en],it[$e]);Nt.detach(Nt.indexOf(o))}}const D=this._adjustIndex(l),R=this._lContainer;!function Ug(r,o,l,g){const C=Ur+g,D=l.length;g>0&&(l[C-1][ct]=o),g<D-Ur?(o[ct]=l[C],uu(l,Ur+g,o)):(l.push(o),o[ct]=null),o[$e]=l;const R=o[Ir];null!==R&&l!==R&&function Vg(r,o){const l=r[br];o[Vi]!==o[$e][$e][Vi]&&(r[ro]=!0),null===l?r[br]=[o]:l.push(o)}(R,o);const B=o[Hr];null!==B&&B.insertView(r),o[fe]|=64}(C,g,R,D);const B=vd(D,R),Z=g[Yt],ae=ba(Z,R[Ds]);return null!==ae&&function Bc(r,o,l,g,C,D){g[si]=C,g[en]=o,Fl(r,g,l,1,C,D)}(C,R[en],Z,g,ae,B),o.attachToViewContainerRef(),uu(py(R),D,o),o}move(o,l){return this.insert(o,l)}indexOf(o){const l=Lv(this._lContainer);return null!==l?l.indexOf(o):-1}remove(o){const l=this._adjustIndex(o,-1),g=dh(this._lContainer,l);g&&(nc(py(this._lContainer),l),pd(g[En],g))}detach(o){const l=this._adjustIndex(o,-1),g=dh(this._lContainer,l);return g&&null!=nc(py(this._lContainer),l)?new Qu(g):null}_adjustIndex(o,l=0){return o??this.length+l}};function Lv(r){return r[Ko]}function py(r){return r[Ko]||(r[Ko]=[])}function Fv(r,o){let l;const g=o[r.index];if(_r(g))l=g;else{let C;if(8&r.type)C=kr(g);else{const D=o[Yt];C=D.createComment("");const R=vi(r,o);xa(D,ba(D,R),C,function fp(r,o){return r.nextSibling(o)}(D,R),!1)}o[r.index]=l=Nh(g,o,C,r),Uh(o,l)}return new Rv(l,r,o)}class fy{constructor(o){this.queryList=o,this.matches=null}clone(){return new fy(this.queryList)}setDirty(){this.queryList.setDirty()}}class my{constructor(o=[]){this.queries=o}createEmbeddedView(o){const l=o.queries;if(null!==l){const g=null!==o.contentQueries?o.contentQueries[0]:l.length,C=[];for(let D=0;D<g;D++){const R=l.getByIndex(D);C.push(this.queries[R.indexInDeclarationView].clone())}return new my(C)}return null}insertView(o){this.dirtyQueriesWithMatches(o)}detachView(o){this.dirtyQueriesWithMatches(o)}dirtyQueriesWithMatches(o){for(let l=0;l<this.queries.length;l++)null!==Zv(o,l).matches&&this.queries[l].setDirty()}}class kv{constructor(o,l,g=null){this.predicate=o,this.flags=l,this.read=g}}class gy{constructor(o=[]){this.queries=o}elementStart(o,l){for(let g=0;g<this.queries.length;g++)this.queries[g].elementStart(o,l)}elementEnd(o){for(let l=0;l<this.queries.length;l++)this.queries[l].elementEnd(o)}embeddedTView(o){let l=null;for(let g=0;g<this.length;g++){const C=null!==l?l.length:0,D=this.getByIndex(g).embeddedTView(o,C);D&&(D.indexInDeclarationView=g,null!==l?l.push(D):l=[D])}return null!==l?new gy(l):null}template(o,l){for(let g=0;g<this.queries.length;g++)this.queries[g].template(o,l)}getByIndex(o){return this.queries[o]}get length(){return this.queries.length}track(o){this.queries.push(o)}}class _y{constructor(o,l=-1){this.metadata=o,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=l}elementStart(o,l){this.isApplyingToNode(l)&&this.matchTNode(o,l)}elementEnd(o){this._declarationNodeIndex===o.index&&(this._appliesToNextNode=!1)}template(o,l){this.elementStart(o,l)}embeddedTView(o,l){return this.isApplyingToNode(o)?(this.crossesNgTemplate=!0,this.addMatch(-o.index,l),new _y(this.metadata)):null}isApplyingToNode(o){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const l=this._declarationNodeIndex;let g=o.parent;for(;null!==g&&8&g.type&&g.index!==l;)g=g.parent;return l===(null!==g?g.index:-1)}return this._appliesToNextNode}matchTNode(o,l){const g=this.metadata.predicate;if(Array.isArray(g))for(let C=0;C<g.length;C++){const D=g[C];this.matchTNodeWithReadOption(o,l,h1(l,D)),this.matchTNodeWithReadOption(o,l,Pl(l,o,D,!1,!1))}else g===Kf?4&l.type&&this.matchTNodeWithReadOption(o,l,-1):this.matchTNodeWithReadOption(o,l,Pl(l,o,g,!1,!1))}matchTNodeWithReadOption(o,l,g){if(null!==g){const C=this.metadata.read;if(null!==C)if(C===Rd||C===Ag||C===Kf&&4&l.type)this.addMatch(l.index,-2);else{const D=Pl(l,o,C,!1,!1);null!==D&&this.addMatch(l.index,D)}else this.addMatch(l.index,g)}}addMatch(o,l){null===this.matches?this.matches=[o,l]:this.matches.push(o,l)}}function h1(r,o){const l=r.localNames;if(null!==l)for(let g=0;g<l.length;g+=2)if(l[g]===o)return l[g+1];return null}function f1(r,o,l,g){return-1===l?function p1(r,o){return 11&r.type?$c(r,o):4&r.type?Sg(r,o):null}(o,r):-2===l?function m1(r,o,l){return l===Rd?$c(o,r):l===Kf?Sg(o,r):l===Ag?Fv(o,r):void 0}(r,o,g):ta(r,r[En],l,o)}function Bv(r,o,l,g){const C=o[Hr].queries[g];if(null===C.matches){const D=r.data,R=l.matches,B=[];for(let Z=0;Z<R.length;Z+=2){const ae=R[Z];B.push(ae<0?null:f1(o,D[ae],R[Z+1],l.metadata.read))}C.matches=B}return C.matches}function yy(r,o,l,g){const C=r.queries.getByIndex(l),D=C.matches;if(null!==D){const R=Bv(r,o,C,l);for(let B=0;B<D.length;B+=2){const Z=D[B];if(Z>0)g.push(R[B/2]);else{const ae=D[B+1],Ae=o[-Z];for(let it=Ur;it<Ae.length;it++){const Nt=Ae[it];Nt[Ir]===Nt[$e]&&yy(Nt[En],Nt,ae,g)}if(null!==Ae[br]){const it=Ae[br];for(let Nt=0;Nt<it.length;Nt++){const sn=it[Nt];yy(sn[En],sn,ae,g)}}}}}return g}function Nv(r){const o=Rn(),l=ki(),g=ir();sr(g+1);const C=Zv(l,g);if(r.dirty&&function ma(r){return 4==(4&r[fe])}(o)===(2==(2&C.metadata.flags))){if(null===C.matches)r.reset([]);else{const D=C.crossesNgTemplate?yy(l,o,g,[]):Bv(l,o,C,g);r.reset(D,r_),r.notifyOnChanges()}return!0}return!1}function zv(r,o,l){const g=ki();g.firstCreatePass&&($v(g,new kv(r,o,l),-1),2==(2&o)&&(g.staticViewQueries=!0)),jv(g,Rn(),o)}function Uv(r,o,l,g){const C=ki();if(C.firstCreatePass){const D=so();$v(C,new kv(o,l,g),D.index),function _1(r,o){const l=r.contentQueries||(r.contentQueries=[]);o!==(l.length?l[l.length-1]:-1)&&l.push(r.queries.length-1,o)}(C,r),2==(2&l)&&(C.staticContentQueries=!0)}jv(C,Rn(),l)}function Vv(){return function g1(r,o){return r[Hr].queries[o].queryList}(Rn(),ir())}function jv(r,o,l){const g=new hy(4==(4&l));Xm(r,o,g,g.destroy),null===o[Hr]&&(o[Hr]=new my),o[Hr].queries.push(new fy(g))}function $v(r,o,l){null===r.queries&&(r.queries=new gy),r.queries.track(new _y(o,l))}function Zv(r,o){return r.queries.getByIndex(o)}function vy(r){return!!In(r)}function Og(...r){}const c0=new Pr("Application Initializer");let Rg=(()=>{class r{constructor(l){this.appInits=l,this.resolve=Og,this.reject=Og,this.initialized=!1,this.done=!1,this.donePromise=new Promise((g,C)=>{this.resolve=g,this.reject=C})}runInitializers(){if(this.initialized)return;const l=[],g=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let C=0;C<this.appInits.length;C++){const D=this.appInits[C]();if(Df(D))l.push(D);else if(za(D)){const R=new Promise((B,Z)=>{D.subscribe({complete:B,error:Z})});l.push(R)}}Promise.all(l).then(()=>{g()}).catch(C=>{this.reject(C)}),0===l.length&&g(),this.initialized=!0}}return r.\u0275fac=function(l){return new(l||r)(_n(c0,8))},r.\u0275prov=ot({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const u0=new Pr("AppId",{providedIn:"root",factory:function d0(){return`${Ty()}${Ty()}${Ty()}`}});function Ty(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const h0=new Pr("Platform Initializer"),N1=new Pr("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),p0=new Pr("appBootstrapListener");let z1=(()=>{class r{log(l){console.log(l)}warn(l){console.warn(l)}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=ot({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();const Lg=new Pr("LocaleId",{providedIn:"root",factory:()=>Ht(Lg,Vt.Optional|Vt.SkipSelf)||function U1(){return typeof $localize<"u"&&$localize.locale||Xc}()}),V1=new Pr("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"});class j1{constructor(o,l){this.ngModuleFactory=o,this.componentFactories=l}}let $1=(()=>{class r{compileModuleSync(l){return new ly(l)}compileModuleAsync(l){return Promise.resolve(this.compileModuleSync(l))}compileModuleAndAllComponentsSync(l){const g=this.compileModuleSync(l),D=Nl(In(l).declarations).reduce((R,B)=>{const Z=bi(B);return Z&&R.push(new ed(Z)),R},[]);return new j1(g,D)}compileModuleAndAllComponentsAsync(l){return Promise.resolve(this.compileModuleAndAllComponentsSync(l))}clearCache(){}clearCacheFor(l){}getModuleId(l){}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=ot({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();const H1=(()=>Promise.resolve(0))();function Ey(r){typeof Zone>"u"?H1.then(()=>{r&&r.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",r)}class Hl{constructor({enableLongStackTrace:o=!1,shouldCoalesceEventChangeDetection:l=!1,shouldCoalesceRunChangeDetection:g=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Kc(!1),this.onMicrotaskEmpty=new Kc(!1),this.onStable=new Kc(!1),this.onError=new Kc(!1),typeof Zone>"u")throw new ge(908,!1);Zone.assertZonePatched();const C=this;C._nesting=0,C._outer=C._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(C._inner=C._inner.fork(new Zone.TaskTrackingZoneSpec)),o&&Zone.longStackTraceZoneSpec&&(C._inner=C._inner.fork(Zone.longStackTraceZoneSpec)),C.shouldCoalesceEventChangeDetection=!g&&l,C.shouldCoalesceRunChangeDetection=g,C.lastRequestAnimationFrameId=-1,C.nativeRequestAnimationFrame=function W1(){let r=rn.requestAnimationFrame,o=rn.cancelAnimationFrame;if(typeof Zone<"u"&&r&&o){const l=r[Zone.__symbol__("OriginalDelegate")];l&&(r=l);const g=o[Zone.__symbol__("OriginalDelegate")];g&&(o=g)}return{nativeRequestAnimationFrame:r,nativeCancelAnimationFrame:o}}().nativeRequestAnimationFrame,function J1(r){const o=()=>{!function Y1(r){r.isCheckStableRunning||-1!==r.lastRequestAnimationFrameId||(r.lastRequestAnimationFrameId=r.nativeRequestAnimationFrame.call(rn,()=>{r.fakeTopEventTask||(r.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{r.lastRequestAnimationFrameId=-1,Iy(r),r.isCheckStableRunning=!0,Dy(r),r.isCheckStableRunning=!1},void 0,()=>{},()=>{})),r.fakeTopEventTask.invoke()}),Iy(r))}(r)};r._inner=r._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(l,g,C,D,R,B)=>{try{return g0(r),l.invokeTask(C,D,R,B)}finally{(r.shouldCoalesceEventChangeDetection&&"eventTask"===D.type||r.shouldCoalesceRunChangeDetection)&&o(),_0(r)}},onInvoke:(l,g,C,D,R,B,Z)=>{try{return g0(r),l.invoke(C,D,R,B,Z)}finally{r.shouldCoalesceRunChangeDetection&&o(),_0(r)}},onHasTask:(l,g,C,D)=>{l.hasTask(C,D),g===C&&("microTask"==D.change?(r._hasPendingMicrotasks=D.microTask,Iy(r),Dy(r)):"macroTask"==D.change&&(r.hasPendingMacrotasks=D.macroTask))},onHandleError:(l,g,C,D)=>(l.handleError(C,D),r.runOutsideAngular(()=>r.onError.emit(D)),!1)})}(C)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!Hl.isInAngularZone())throw new ge(909,!1)}static assertNotInAngularZone(){if(Hl.isInAngularZone())throw new ge(909,!1)}run(o,l,g){return this._inner.run(o,l,g)}runTask(o,l,g,C){const D=this._inner,R=D.scheduleEventTask("NgZoneEvent: "+C,o,q1,Og,Og);try{return D.runTask(R,l,g)}finally{D.cancelTask(R)}}runGuarded(o,l,g){return this._inner.runGuarded(o,l,g)}runOutsideAngular(o){return this._outer.run(o)}}const q1={};function Dy(r){if(0==r._nesting&&!r.hasPendingMicrotasks&&!r.isStable)try{r._nesting++,r.onMicrotaskEmpty.emit(null)}finally{if(r._nesting--,!r.hasPendingMicrotasks)try{r.runOutsideAngular(()=>r.onStable.emit(null))}finally{r.isStable=!0}}}function Iy(r){r.hasPendingMicrotasks=!!(r._hasPendingMicrotasks||(r.shouldCoalesceEventChangeDetection||r.shouldCoalesceRunChangeDetection)&&-1!==r.lastRequestAnimationFrameId)}function g0(r){r._nesting++,r.isStable&&(r.isStable=!1,r.onUnstable.emit(null))}function _0(r){r._nesting--,Dy(r)}class X1{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Kc,this.onMicrotaskEmpty=new Kc,this.onStable=new Kc,this.onError=new Kc}run(o,l,g){return o.apply(l,g)}runGuarded(o,l,g){return o.apply(l,g)}runOutsideAngular(o){return o()}runTask(o,l,g,C){return o.apply(l,g)}}const y0=new Pr(""),v0=new Pr("");let My,K1=(()=>{class r{constructor(l,g,C){this._ngZone=l,this.registry=g,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,My||(function Q1(r){My=r}(C),C.addToWindow(g)),this._watchAngularEvents(),l.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{Hl.assertNotInAngularZone(),Ey(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())Ey(()=>{for(;0!==this._callbacks.length;){let l=this._callbacks.pop();clearTimeout(l.timeoutId),l.doneCb(this._didWork)}this._didWork=!1});else{let l=this.getPendingTasks();this._callbacks=this._callbacks.filter(g=>!g.updateCb||!g.updateCb(l)||(clearTimeout(g.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(l=>({source:l.source,creationLocation:l.creationLocation,data:l.data})):[]}addCallback(l,g,C){let D=-1;g&&g>0&&(D=setTimeout(()=>{this._callbacks=this._callbacks.filter(R=>R.timeoutId!==D),l(this._didWork,this.getPendingTasks())},g)),this._callbacks.push({doneCb:l,timeoutId:D,updateCb:C})}whenStable(l,g,C){if(C&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(l,g,C),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(l){this.registry.registerApplication(l,this)}unregisterApplication(l){this.registry.unregisterApplication(l)}findProviders(l,g,C){return[]}}return r.\u0275fac=function(l){return new(l||r)(_n(Hl),_n(x0),_n(v0))},r.\u0275prov=ot({token:r,factory:r.\u0275fac}),r})(),x0=(()=>{class r{constructor(){this._applications=new Map}registerApplication(l,g){this._applications.set(l,g)}unregisterApplication(l){this._applications.delete(l)}unregisterAllApplications(){this._applications.clear()}getTestability(l){return this._applications.get(l)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(l,g=!0){return My?.findTestabilityInTree(this,l,g)??null}}return r.\u0275fac=function(l){return new(l||r)},r.\u0275prov=ot({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})(),cd=null;const b0=new Pr("AllowMultipleToken"),Sy=new Pr("PlatformDestroyListeners"),Ou=!1;class nb{constructor(o,l){this.name=o,this.token=l}}function C0(r,o,l=[]){const g=`Platform: ${o}`,C=new Pr(g);return(D=[])=>{let R=Ay();if(!R||R.injector.get(b0,!1)){const B=[...l,...D,{provide:C,useValue:!0}];r?r(B):function ib(r){if(cd&&!cd.get(b0,!1))throw new ge(400,!1);cd=r;const o=r.get(E0);(function w0(r){const o=r.get(h0,null);o&&o.forEach(l=>l())})(r)}(function T0(r=[],o){return zl.create({name:o,providers:[{provide:Ad,useValue:"platform"},{provide:Sy,useValue:new Set([()=>cd=null])},...r]})}(B,g))}return function ob(r){const o=Ay();if(!o)throw new ge(401,!1);return o}()}}function Ay(){return cd?.get(E0)??null}let E0=(()=>{class r{constructor(l){this._injector=l,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(l,g){const C=function I0(r,o){let l;return l="noop"===r?new X1:("zone.js"===r?void 0:r)||new Hl(o),l}(g?.ngZone,function D0(r){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!(!r||!r.ngZoneEventCoalescing)||!1,shouldCoalesceRunChangeDetection:!(!r||!r.ngZoneRunCoalescing)||!1}}(g)),D=[{provide:Hl,useValue:C}];return C.run(()=>{const R=zl.create({providers:D,parent:this.injector,name:l.moduleType.name}),B=l.create(R),Z=B.injector.get(Fd,null);if(!Z)throw new ge(402,!1);return C.runOutsideAngular(()=>{const ae=C.onError.subscribe({next:Ae=>{Z.handleError(Ae)}});B.onDestroy(()=>{kg(this._modules,B),ae.unsubscribe()})}),function M0(r,o,l){try{const g=l();return Df(g)?g.catch(C=>{throw o.runOutsideAngular(()=>r.handleError(C)),C}):g}catch(g){throw o.runOutsideAngular(()=>r.handleError(g)),g}}(Z,C,()=>{const ae=B.injector.get(Rg);return ae.runInitializers(),ae.donePromise.then(()=>(function $y(r){kt(r,"Expected localeId to be defined"),"string"==typeof r&&(jy=r.toLowerCase().replace(/_/g,"-"))}(B.injector.get(Lg,Xc)||Xc),this._moduleDoBootstrap(B),B))})})}bootstrapModule(l,g=[]){const C=S0({},g);return function eb(r,o,l){const g=new ly(l);return Promise.resolve(g)}(0,0,l).then(D=>this.bootstrapModuleFactory(D,C))}_moduleDoBootstrap(l){const g=l.injector.get(Fg);if(l._bootstrapComponents.length>0)l._bootstrapComponents.forEach(C=>g.bootstrap(C));else{if(!l.instance.ngDoBootstrap)throw new ge(-403,!1);l.instance.ngDoBootstrap(g)}this._modules.push(l)}onDestroy(l){this._destroyListeners.push(l)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new ge(404,!1);this._modules.slice().forEach(g=>g.destroy()),this._destroyListeners.forEach(g=>g());const l=this._injector.get(Sy,null);l&&(l.forEach(g=>g()),l.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}}return r.\u0275fac=function(l){return new(l||r)(_n(zl))},r.\u0275prov=ot({token:r,factory:r.\u0275fac,providedIn:"platform"}),r})();function S0(r,o){return Array.isArray(o)?o.reduce(S0,r):{...r,...o}}let Fg=(()=>{class r{get destroyed(){return this._destroyed}get injector(){return this._injector}constructor(l,g,C){this._zone=l,this._injector=g,this._exceptionHandler=C,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this._destroyed=!1,this._destroyListeners=[],this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const D=new re.y(B=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{B.next(this._stable),B.complete()})}),R=new re.y(B=>{let Z;this._zone.runOutsideAngular(()=>{Z=this._zone.onStable.subscribe(()=>{Hl.assertNotInAngularZone(),Ey(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,B.next(!0))})})});const ae=this._zone.onUnstable.subscribe(()=>{Hl.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{B.next(!1)}))});return()=>{Z.unsubscribe(),ae.unsubscribe()}});this.isStable=function Ie(...r){const o=(0,b.yG)(r),l=(0,b._6)(r,1/0),g=r;return g.length?1===g.length?(0,q.Xf)(g[0]):(0,a.J)(l)((0,he.D)(g,o)):oe.E}(D,R.pipe((0,Ve.B)()))}bootstrap(l,g){const C=l instanceof Rp;if(!this._injector.get(Rg).done){!C&&Kr(l);throw new ge(405,Ou)}let R;R=C?l:this._injector.get(Ts).resolveComponentFactory(l),this.componentTypes.push(R.componentType);const B=function tb(r){return r.isBoundToModule}(R)?void 0:this._injector.get(op),ae=R.create(zl.NULL,[],g||R.selector,B),Ae=ae.location.nativeElement,it=ae.injector.get(y0,null);return it?.registerApplication(Ae),ae.onDestroy(()=>{this.detachView(ae.hostView),kg(this.components,ae),it?.unregisterApplication(Ae)}),this._loadComponent(ae),ae}tick(){if(this._runningTick)throw new ge(101,!1);try{this._runningTick=!0;for(let l of this._views)l.detectChanges()}catch(l){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(l))}finally{this._runningTick=!1}}attachView(l){const g=l;this._views.push(g),g.attachToAppRef(this)}detachView(l){const g=l;kg(this._views,g),g.detachFromAppRef()}_loadComponent(l){this.attachView(l.hostView),this.tick(),this.components.push(l);const g=this._injector.get(p0,[]);g.push(...this._bootstrapListeners),g.forEach(C=>C(l))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(l=>l()),this._views.slice().forEach(l=>l.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(l){return this._destroyListeners.push(l),()=>kg(this._destroyListeners,l)}destroy(){if(this._destroyed)throw new ge(406,!1);const l=this._injector;l.destroy&&!l.destroyed&&l.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}}return r.\u0275fac=function(l){return new(l||r)(_n(Hl),_n(vu),_n(Fd))},r.\u0275prov=ot({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();function kg(r,o){const l=r.indexOf(o);l>-1&&r.splice(l,1)}function ab(){}let lb=(()=>{class r{}return r.__NG_ELEMENT_ID__=cb,r})();function cb(r){return function ub(r,o,l){if(Ro(r)&&!l){const g=Mr(r.index,o);return new Qu(g,g)}return 47&r.type?new Qu(o[Vi],o):null}(so(),Rn(),16==(16&r))}class L0{constructor(){}supports(o){return qd(o)}create(o){return new gb(o)}}const mb=(r,o)=>o;class gb{constructor(o){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=o||mb}forEachItem(o){let l;for(l=this._itHead;null!==l;l=l._next)o(l)}forEachOperation(o){let l=this._itHead,g=this._removalsHead,C=0,D=null;for(;l||g;){const R=!g||l&&l.currentIndex<k0(g,C,D)?l:g,B=k0(R,C,D),Z=R.currentIndex;if(R===g)C--,g=g._nextRemoved;else if(l=l._next,null==R.previousIndex)C++;else{D||(D=[]);const ae=B-C,Ae=Z-C;if(ae!=Ae){for(let Nt=0;Nt<ae;Nt++){const sn=Nt<D.length?D[Nt]:D[Nt]=0,Mn=sn+Nt;Ae<=Mn&&Mn<ae&&(D[Nt]=sn+1)}D[R.previousIndex]=Ae-ae}}B!==Z&&o(R,B,Z)}}forEachPreviousItem(o){let l;for(l=this._previousItHead;null!==l;l=l._nextPrevious)o(l)}forEachAddedItem(o){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)o(l)}forEachMovedItem(o){let l;for(l=this._movesHead;null!==l;l=l._nextMoved)o(l)}forEachRemovedItem(o){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)o(l)}forEachIdentityChange(o){let l;for(l=this._identityChangesHead;null!==l;l=l._nextIdentityChange)o(l)}diff(o){if(null==o&&(o=[]),!qd(o))throw new ge(900,!1);return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let C,D,R,l=this._itHead,g=!1;if(Array.isArray(o)){this.length=o.length;for(let B=0;B<this.length;B++)D=o[B],R=this._trackByFn(B,D),null!==l&&Object.is(l.trackById,R)?(g&&(l=this._verifyReinsertion(l,D,R,B)),Object.is(l.item,D)||this._addIdentityChange(l,D)):(l=this._mismatch(l,D,R,B),g=!0),l=l._next}else C=0,function q_(r,o){if(Array.isArray(r))for(let l=0;l<r.length;l++)o(r[l]);else{const l=r[Symbol.iterator]();let g;for(;!(g=l.next()).done;)o(g.value)}}(o,B=>{R=this._trackByFn(C,B),null!==l&&Object.is(l.trackById,R)?(g&&(l=this._verifyReinsertion(l,B,R,C)),Object.is(l.item,B)||this._addIdentityChange(l,B)):(l=this._mismatch(l,B,R,C),g=!0),l=l._next,C++}),this.length=C;return this._truncate(l),this.collection=o,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let o;for(o=this._previousItHead=this._itHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._additionsHead;null!==o;o=o._nextAdded)o.previousIndex=o.currentIndex;for(this._additionsHead=this._additionsTail=null,o=this._movesHead;null!==o;o=o._nextMoved)o.previousIndex=o.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(o,l,g,C){let D;return null===o?D=this._itTail:(D=o._prev,this._remove(o)),null!==(o=null===this._unlinkedRecords?null:this._unlinkedRecords.get(g,null))?(Object.is(o.item,l)||this._addIdentityChange(o,l),this._reinsertAfter(o,D,C)):null!==(o=null===this._linkedRecords?null:this._linkedRecords.get(g,C))?(Object.is(o.item,l)||this._addIdentityChange(o,l),this._moveAfter(o,D,C)):o=this._addAfter(new _b(l,g),D,C),o}_verifyReinsertion(o,l,g,C){let D=null===this._unlinkedRecords?null:this._unlinkedRecords.get(g,null);return null!==D?o=this._reinsertAfter(D,o._prev,C):o.currentIndex!=C&&(o.currentIndex=C,this._addToMoves(o,C)),o}_truncate(o){for(;null!==o;){const l=o._next;this._addToRemovals(this._unlink(o)),o=l}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(o,l,g){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(o);const C=o._prevRemoved,D=o._nextRemoved;return null===C?this._removalsHead=D:C._nextRemoved=D,null===D?this._removalsTail=C:D._prevRemoved=C,this._insertAfter(o,l,g),this._addToMoves(o,g),o}_moveAfter(o,l,g){return this._unlink(o),this._insertAfter(o,l,g),this._addToMoves(o,g),o}_addAfter(o,l,g){return this._insertAfter(o,l,g),this._additionsTail=null===this._additionsTail?this._additionsHead=o:this._additionsTail._nextAdded=o,o}_insertAfter(o,l,g){const C=null===l?this._itHead:l._next;return o._next=C,o._prev=l,null===C?this._itTail=o:C._prev=o,null===l?this._itHead=o:l._next=o,null===this._linkedRecords&&(this._linkedRecords=new F0),this._linkedRecords.put(o),o.currentIndex=g,o}_remove(o){return this._addToRemovals(this._unlink(o))}_unlink(o){null!==this._linkedRecords&&this._linkedRecords.remove(o);const l=o._prev,g=o._next;return null===l?this._itHead=g:l._next=g,null===g?this._itTail=l:g._prev=l,o}_addToMoves(o,l){return o.previousIndex===l||(this._movesTail=null===this._movesTail?this._movesHead=o:this._movesTail._nextMoved=o),o}_addToRemovals(o){return null===this._unlinkedRecords&&(this._unlinkedRecords=new F0),this._unlinkedRecords.put(o),o.currentIndex=null,o._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=o,o._prevRemoved=null):(o._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=o),o}_addIdentityChange(o,l){return o.item=l,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=o:this._identityChangesTail._nextIdentityChange=o,o}}class _b{constructor(o,l){this.item=o,this.trackById=l,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class yb{constructor(){this._head=null,this._tail=null}add(o){null===this._head?(this._head=this._tail=o,o._nextDup=null,o._prevDup=null):(this._tail._nextDup=o,o._prevDup=this._tail,o._nextDup=null,this._tail=o)}get(o,l){let g;for(g=this._head;null!==g;g=g._nextDup)if((null===l||l<=g.currentIndex)&&Object.is(g.trackById,o))return g;return null}remove(o){const l=o._prevDup,g=o._nextDup;return null===l?this._head=g:l._nextDup=g,null===g?this._tail=l:g._prevDup=l,null===this._head}}class F0{constructor(){this.map=new Map}put(o){const l=o.trackById;let g=this.map.get(l);g||(g=new yb,this.map.set(l,g)),g.add(o)}get(o,l){const C=this.map.get(o);return C?C.get(o,l):null}remove(o){const l=o.trackById;return this.map.get(l).remove(o)&&this.map.delete(l),o}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function k0(r,o,l){const g=r.previousIndex;if(null===g)return g;let C=0;return l&&g<l.length&&(C=l[g]),g+o+C}class B0{constructor(){}supports(o){return o instanceof Map||jl(o)}create(){return new vb}}class vb{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(o){let l;for(l=this._mapHead;null!==l;l=l._next)o(l)}forEachPreviousItem(o){let l;for(l=this._previousMapHead;null!==l;l=l._nextPrevious)o(l)}forEachChangedItem(o){let l;for(l=this._changesHead;null!==l;l=l._nextChanged)o(l)}forEachAddedItem(o){let l;for(l=this._additionsHead;null!==l;l=l._nextAdded)o(l)}forEachRemovedItem(o){let l;for(l=this._removalsHead;null!==l;l=l._nextRemoved)o(l)}diff(o){if(o){if(!(o instanceof Map||jl(o)))throw new ge(900,!1)}else o=new Map;return this.check(o)?this:null}onDestroy(){}check(o){this._reset();let l=this._mapHead;if(this._appendAfter=null,this._forEach(o,(g,C)=>{if(l&&l.key===C)this._maybeAddToChanges(l,g),this._appendAfter=l,l=l._next;else{const D=this._getOrCreateRecordForKey(C,g);l=this._insertBeforeOrAppend(l,D)}}),l){l._prev&&(l._prev._next=null),this._removalsHead=l;for(let g=l;null!==g;g=g._nextRemoved)g===this._mapHead&&(this._mapHead=null),this._records.delete(g.key),g._nextRemoved=g._next,g.previousValue=g.currentValue,g.currentValue=null,g._prev=null,g._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(o,l){if(o){const g=o._prev;return l._next=o,l._prev=g,o._prev=l,g&&(g._next=l),o===this._mapHead&&(this._mapHead=l),this._appendAfter=o,o}return this._appendAfter?(this._appendAfter._next=l,l._prev=this._appendAfter):this._mapHead=l,this._appendAfter=l,null}_getOrCreateRecordForKey(o,l){if(this._records.has(o)){const C=this._records.get(o);this._maybeAddToChanges(C,l);const D=C._prev,R=C._next;return D&&(D._next=R),R&&(R._prev=D),C._next=null,C._prev=null,C}const g=new xb(o);return this._records.set(o,g),g.currentValue=l,this._addToAdditions(g),g}_reset(){if(this.isDirty){let o;for(this._previousMapHead=this._mapHead,o=this._previousMapHead;null!==o;o=o._next)o._nextPrevious=o._next;for(o=this._changesHead;null!==o;o=o._nextChanged)o.previousValue=o.currentValue;for(o=this._additionsHead;null!=o;o=o._nextAdded)o.previousValue=o.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(o,l){Object.is(l,o.currentValue)||(o.previousValue=o.currentValue,o.currentValue=l,this._addToChanges(o))}_addToAdditions(o){null===this._additionsHead?this._additionsHead=this._additionsTail=o:(this._additionsTail._nextAdded=o,this._additionsTail=o)}_addToChanges(o){null===this._changesHead?this._changesHead=this._changesTail=o:(this._changesTail._nextChanged=o,this._changesTail=o)}_forEach(o,l){o instanceof Map?o.forEach(l):Object.keys(o).forEach(g=>l(o[g],g))}}class xb{constructor(o){this.key=o,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function N0(){return new Fy([new L0])}let Fy=(()=>{class r{constructor(l){this.factories=l}static create(l,g){if(null!=g){const C=g.factories.slice();l=l.concat(C)}return new r(l)}static extend(l){return{provide:r,useFactory:g=>r.create(l,g||N0()),deps:[[r,new qe,new ve]]}}find(l){const g=this.factories.find(C=>C.supports(l));if(null!=g)return g;throw new ge(901,!1)}}return r.\u0275prov=ot({token:r,providedIn:"root",factory:N0}),r})();function z0(){return new ky([new B0])}let ky=(()=>{class r{constructor(l){this.factories=l}static create(l,g){if(g){const C=g.factories.slice();l=l.concat(C)}return new r(l)}static extend(l){return{provide:r,useFactory:g=>r.create(l,g||z0()),deps:[[r,new qe,new ve]]}}find(l){const g=this.factories.find(C=>C.supports(l));if(g)return g;throw new ge(901,!1)}}return r.\u0275prov=ot({token:r,providedIn:"root",factory:z0}),r})();const Cb=C0(null,"core",[]);let Tb=(()=>{class r{constructor(l){}}return r.\u0275fac=function(l){return new(l||r)(_n(Fg))},r.\u0275mod=Jt({type:r}),r.\u0275inj=Sn({}),r})();function Eb(r){return"boolean"==typeof r?r:null!=r&&"false"!==r}},4006:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Fd:()=>Uo,Fj:()=>ze,JJ:()=>hi,JU:()=>he,On:()=>Vi,a5:()=>Sn,qQ:()=>Sa,u5:()=>Go,wV:()=>Hr});var d=F(8274),v=F(6895),re=F(2076),a=F(4128),q=F(4004);let oe=(()=>{class te{constructor(W,Te){this._renderer=W,this._elementRef=Te,this.onChange=fn=>{},this.onTouched=()=>{}}setProperty(W,Te){this._renderer.setProperty(this._elementRef.nativeElement,W,Te)}registerOnTouched(W){this.onTouched=W}registerOnChange(W){this.onChange=W}setDisabledState(W){this.setProperty("disabled",W)}}return te.\u0275fac=function(W){return new(W||te)(d.Y36(d.Qsj),d.Y36(d.SBq))},te.\u0275dir=d.lG2({type:te}),te})(),b=(()=>{class te extends oe{}return te.\u0275fac=function(){let Y;return function(Te){return(Y||(Y=d.n5z(te)))(Te||te)}}(),te.\u0275dir=d.lG2({type:te,features:[d.qOj]}),te})();const he=new d.OlP("NgValueAccessor"),K={provide:he,useExisting:(0,d.Gpc)(()=>ze),multi:!0},pe=new d.OlP("CompositionEventMode");let ze=(()=>{class te extends oe{constructor(W,Te,fn){super(W,Te),this._compositionMode=fn,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function xe(){const te=(0,v.q)()?(0,v.q)().getUserAgent():"";return/android (\d+)/.test(te.toLowerCase())}())}writeValue(W){this.setProperty("value",W??"")}_handleInput(W){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(W)}_compositionStart(){this._composing=!0}_compositionEnd(W){this._composing=!1,this._compositionMode&&this.onChange(W)}}return te.\u0275fac=function(W){return new(W||te)(d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(pe,8))},te.\u0275dir=d.lG2({type:te,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(W,Te){1&W&&d.NdJ("input",function(fi){return Te._handleInput(fi.target.value)})("blur",function(){return Te.onTouched()})("compositionstart",function(){return Te._compositionStart()})("compositionend",function(fi){return Te._compositionEnd(fi.target.value)})},features:[d._Bn([K]),d.qOj]}),te})();const ce=!1;function Ke(te){return null==te||("string"==typeof te||Array.isArray(te))&&0===te.length}const ne=new d.OlP("NgValidators"),Je=new d.OlP("NgAsyncValidators");function se(te){return null}function Ee(te){return null!=te}function _t(te){const Y=(0,d.QGY)(te)?(0,re.D)(te):te;if(ce&&!(0,d.CqO)(Y)){let W="Expected async validator to return Promise or Observable.";throw"object"==typeof te&&(W+=" Are you using a synchronous validator where an async validator is expected?"),new d.vHH(-1101,W)}return Y}function It(te){let Y={};return te.forEach(W=>{Y=null!=W?{...Y,...W}:Y}),0===Object.keys(Y).length?null:Y}function Gt(te,Y){return Y.map(W=>W(te))}function yt(te){return te.map(Y=>function Lt(te){return!te.validate}(Y)?Y:W=>Y.validate(W))}function xt(te){return null!=te?function St(te){if(!te)return null;const Y=te.filter(Ee);return 0==Y.length?null:function(W){return It(Gt(W,Y))}}(yt(te)):null}function lt(te){return null!=te?function rt(te){if(!te)return null;const Y=te.filter(Ee);return 0==Y.length?null:function(W){const Te=Gt(W,Y).map(_t);return(0,a.D)(Te).pipe((0,q.U)(It))}}(yt(te)):null}function Ce(te,Y){return null===te?[Y]:Array.isArray(te)?[...te,Y]:[te,Y]}function Ut(te){return te?Array.isArray(te)?te:[te]:[]}function bn(te,Y){return Array.isArray(te)?te.includes(Y):te===Y}function Nn(te,Y){const W=Ut(Y);return Ut(te).forEach(fn=>{bn(W,fn)||W.push(fn)}),W}function un(te,Y){return Ut(Y).filter(W=>!bn(te,W))}class ot{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(Y){this._rawValidators=Y||[],this._composedValidatorFn=xt(this._rawValidators)}_setAsyncValidators(Y){this._rawAsyncValidators=Y||[],this._composedAsyncValidatorFn=lt(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(Y){this._onDestroyCallbacks.push(Y)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(Y=>Y()),this._onDestroyCallbacks=[]}reset(Y){this.control&&this.control.reset(Y)}hasError(Y,W){return!!this.control&&this.control.hasError(Y,W)}getError(Y,W){return this.control?this.control.getError(Y,W):null}}class Bt extends ot{get formDirective(){return null}get path(){return null}}class Sn extends ot{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class Qn{constructor(Y){this._cd=Y}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let hi=(()=>{class te extends Qn{constructor(W){super(W)}}return te.\u0275fac=function(W){return new(W||te)(d.Y36(Sn,2))},te.\u0275dir=d.lG2({type:te,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(W,Te){2&W&&d.ekj("ng-untouched",Te.isUntouched)("ng-touched",Te.isTouched)("ng-pristine",Te.isPristine)("ng-dirty",Te.isDirty)("ng-valid",Te.isValid)("ng-invalid",Te.isInvalid)("ng-pending",Te.isPending)},features:[d.qOj]}),te})();const vr="VALID",xr="INVALID",gr="PENDING",ui="DISABLED";function Ue(te){return null!=te&&!Array.isArray(te)&&"object"==typeof te}class k{constructor(Y,W){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(Y),this._assignAsyncValidators(W)}get validator(){return this._composedValidatorFn}set validator(Y){this._rawValidators=this._composedValidatorFn=Y}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(Y){this._rawAsyncValidators=this._composedAsyncValidatorFn=Y}get parent(){return this._parent}get valid(){return this.status===vr}get invalid(){return this.status===xr}get pending(){return this.status==gr}get disabled(){return this.status===ui}get enabled(){return this.status!==ui}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(Y){this._assignValidators(Y)}setAsyncValidators(Y){this._assignAsyncValidators(Y)}addValidators(Y){this.setValidators(Nn(Y,this._rawValidators))}addAsyncValidators(Y){this.setAsyncValidators(Nn(Y,this._rawAsyncValidators))}removeValidators(Y){this.setValidators(un(Y,this._rawValidators))}removeAsyncValidators(Y){this.setAsyncValidators(un(Y,this._rawAsyncValidators))}hasValidator(Y){return bn(this._rawValidators,Y)}hasAsyncValidator(Y){return bn(this._rawAsyncValidators,Y)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(Y={}){this.touched=!0,this._parent&&!Y.onlySelf&&this._parent.markAsTouched(Y)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(Y=>Y.markAllAsTouched())}markAsUntouched(Y={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(W=>{W.markAsUntouched({onlySelf:!0})}),this._parent&&!Y.onlySelf&&this._parent._updateTouched(Y)}markAsDirty(Y={}){this.pristine=!1,this._parent&&!Y.onlySelf&&this._parent.markAsDirty(Y)}markAsPristine(Y={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(W=>{W.markAsPristine({onlySelf:!0})}),this._parent&&!Y.onlySelf&&this._parent._updatePristine(Y)}markAsPending(Y={}){this.status=gr,!1!==Y.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!Y.onlySelf&&this._parent.markAsPending(Y)}disable(Y={}){const W=this._parentMarkedDirty(Y.onlySelf);this.status=ui,this.errors=null,this._forEachChild(Te=>{Te.disable({...Y,onlySelf:!0})}),this._updateValue(),!1!==Y.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...Y,skipPristineCheck:W}),this._onDisabledChange.forEach(Te=>Te(!0))}enable(Y={}){const W=this._parentMarkedDirty(Y.onlySelf);this.status=vr,this._forEachChild(Te=>{Te.enable({...Y,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:Y.emitEvent}),this._updateAncestors({...Y,skipPristineCheck:W}),this._onDisabledChange.forEach(Te=>Te(!1))}_updateAncestors(Y){this._parent&&!Y.onlySelf&&(this._parent.updateValueAndValidity(Y),Y.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(Y){this._parent=Y}getRawValue(){return this.value}updateValueAndValidity(Y={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===vr||this.status===gr)&&this._runAsyncValidator(Y.emitEvent)),!1!==Y.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!Y.onlySelf&&this._parent.updateValueAndValidity(Y)}_updateTreeValidity(Y={emitEvent:!0}){this._forEachChild(W=>W._updateTreeValidity(Y)),this.updateValueAndValidity({onlySelf:!0,emitEvent:Y.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ui:vr}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(Y){if(this.asyncValidator){this.status=gr,this._hasOwnPendingAsyncValidator=!0;const W=_t(this.asyncValidator(this));this._asyncValidationSubscription=W.subscribe(Te=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Te,{emitEvent:Y})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(Y,W={}){this.errors=Y,this._updateControlsErrors(!1!==W.emitEvent)}get(Y){let W=Y;return null==W||(Array.isArray(W)||(W=W.split(".")),0===W.length)?null:W.reduce((Te,fn)=>Te&&Te._find(fn),this)}getError(Y,W){const Te=W?this.get(W):this;return Te&&Te.errors?Te.errors[Y]:null}hasError(Y,W){return!!this.getError(Y,W)}get root(){let Y=this;for(;Y._parent;)Y=Y._parent;return Y}_updateControlsErrors(Y){this.status=this._calculateStatus(),Y&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(Y)}_initObservables(){this.valueChanges=new d.vpe,this.statusChanges=new d.vpe}_calculateStatus(){return this._allControlsDisabled()?ui:this.errors?xr:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(gr)?gr:this._anyControlsHaveStatus(xr)?xr:vr}_anyControlsHaveStatus(Y){return this._anyControls(W=>W.status===Y)}_anyControlsDirty(){return this._anyControls(Y=>Y.dirty)}_anyControlsTouched(){return this._anyControls(Y=>Y.touched)}_updatePristine(Y={}){this.pristine=!this._anyControlsDirty(),this._parent&&!Y.onlySelf&&this._parent._updatePristine(Y)}_updateTouched(Y={}){this.touched=this._anyControlsTouched(),this._parent&&!Y.onlySelf&&this._parent._updateTouched(Y)}_registerOnCollectionChange(Y){this._onCollectionChange=Y}_setUpdateStrategy(Y){Ue(Y)&&null!=Y.updateOn&&(this._updateOn=Y.updateOn)}_parentMarkedDirty(Y){return!Y&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(Y){return null}_assignValidators(Y){this._rawValidators=Array.isArray(Y)?Y.slice():Y,this._composedValidatorFn=function wt(te){return Array.isArray(te)?xt(te):te||null}(this._rawValidators)}_assignAsyncValidators(Y){this._rawAsyncValidators=Array.isArray(Y)?Y.slice():Y,this._composedAsyncValidatorFn=function _n(te){return Array.isArray(te)?lt(te):te||null}(this._rawAsyncValidators)}}const vt=new d.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>ut}),ut="always";function Be(te,Y,W=ut){(function dn(te,Y){const W=function bt(te){return te._rawValidators}(te);null!==Y.validator?te.setValidators(Ce(W,Y.validator)):"function"==typeof W&&te.setValidators([W]);const Te=function kt(te){return te._rawAsyncValidators}(te);null!==Y.asyncValidator?te.setAsyncValidators(Ce(Te,Y.asyncValidator)):"function"==typeof Te&&te.setAsyncValidators([Te]);const fn=()=>te.updateValueAndValidity();We(Y._rawValidators,fn),We(Y._rawAsyncValidators,fn)})(te,Y),Y.valueAccessor.writeValue(te.value),(te.disabled||"always"===W)&&Y.valueAccessor.setDisabledState?.(te.disabled),function qn(te,Y){Y.valueAccessor.registerOnChange(W=>{te._pendingValue=W,te._pendingChange=!0,te._pendingDirty=!0,"change"===te.updateOn&&mi(te,Y)})}(te,Y),function ei(te,Y){const W=(Te,fn)=>{Y.valueAccessor.writeValue(Te),fn&&Y.viewToModelUpdate(Te)};te.registerOnChange(W),Y._registerOnDestroy(()=>{te._unregisterOnChange(W)})}(te,Y),function Yn(te,Y){Y.valueAccessor.registerOnTouched(()=>{te._pendingTouched=!0,"blur"===te.updateOn&&te._pendingChange&&mi(te,Y),"submit"!==te.updateOn&&te.markAsTouched()})}(te,Y),function jt(te,Y){if(Y.valueAccessor.setDisabledState){const W=Te=>{Y.valueAccessor.setDisabledState(Te)};te.registerOnDisabledChange(W),Y._registerOnDestroy(()=>{te._unregisterOnDisabledChange(W)})}}(te,Y)}function We(te,Y){te.forEach(W=>{W.registerOnValidatorChange&&W.registerOnValidatorChange(Y)})}function mi(te,Y){te._pendingDirty&&te.markAsDirty(),te.setValue(te._pendingValue,{emitModelToViewChange:!1}),Y.viewToModelUpdate(te._pendingValue),te._pendingChange=!1}function fe(te,Y){const W=te.indexOf(Y);W>-1&&te.splice(W,1)}function $e(te){return"object"==typeof te&&null!==te&&2===Object.keys(te).length&&"value"in te&&"disabled"in te}const ct=class extends k{constructor(Y=null,W,Te){super(function pn(te){return(Ue(te)?te.validators:te)||null}(W),function Rt(te,Y){return(Ue(Y)?Y.asyncValidators:te)||null}(Te,W)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(Y),this._setUpdateStrategy(W),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),Ue(W)&&(W.nonNullable||W.initialValueIsDefault)&&(this.defaultValue=$e(Y)?Y.value:Y)}setValue(Y,W={}){this.value=this._pendingValue=Y,this._onChange.length&&!1!==W.emitModelToViewChange&&this._onChange.forEach(Te=>Te(this.value,!1!==W.emitViewToModelChange)),this.updateValueAndValidity(W)}patchValue(Y,W={}){this.setValue(Y,W)}reset(Y=this.defaultValue,W={}){this._applyFormState(Y),this.markAsPristine(W),this.markAsUntouched(W),this.setValue(this.value,W),this._pendingChange=!1}_updateValue(){}_anyControls(Y){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(Y){this._onChange.push(Y)}_unregisterOnChange(Y){fe(this._onChange,Y)}registerOnDisabledChange(Y){this._onDisabledChange.push(Y)}_unregisterOnDisabledChange(Y){fe(this._onDisabledChange,Y)}_forEachChild(Y){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(Y){$e(Y)?(this.value=this._pendingValue=Y.value,Y.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=Y}},Ai={provide:Sn,useExisting:(0,d.Gpc)(()=>Vi)},Fi=(()=>Promise.resolve())();let Vi=(()=>{class te extends Sn{constructor(W,Te,fn,fi,pr,cr){super(),this._changeDetectorRef=pr,this.callSetDisabledState=cr,this.control=new ct,this._registered=!1,this.update=new d.vpe,this._parent=W,this._setValidators(Te),this._setAsyncValidators(fn),this.valueAccessor=function qi(te,Y){if(!Y)return null;let W,Te,fn;return Array.isArray(Y),Y.forEach(fi=>{fi.constructor===ze?W=fi:function fo(te){return Object.getPrototypeOf(te.constructor)===b}(fi)?Te=fi:fn=fi}),fn||Te||W||null}(0,fi)}ngOnChanges(W){if(this._checkForErrors(),!this._registered||"name"in W){if(this._registered&&(this._checkName(),this.formDirective)){const Te=W.name.previousValue;this.formDirective.removeControl({name:Te,path:this._getPath(Te)})}this._setUpControl()}"isDisabled"in W&&this._updateDisabled(W),function no(te,Y){if(!te.hasOwnProperty("model"))return!1;const W=te.model;return!!W.isFirstChange()||!Object.is(Y,W.currentValue)}(W,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(W){this.viewModel=W,this.update.emit(W)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Be(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(W){Fi.then(()=>{this.control.setValue(W,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(W){const Te=W.isDisabled.currentValue,fn=0!==Te&&(0,d.D6c)(Te);Fi.then(()=>{fn&&!this.control.disabled?this.control.disable():!fn&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(W){return this._parent?function Fe(te,Y){return[...Y.path,te]}(W,this._parent):[W]}}return te.\u0275fac=function(W){return new(W||te)(d.Y36(Bt,9),d.Y36(ne,10),d.Y36(Je,10),d.Y36(he,10),d.Y36(d.sBO,8),d.Y36(vt,8))},te.\u0275dir=d.lG2({type:te,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:["disabled","isDisabled"],model:["ngModel","model"],options:["ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[d._Bn([Ai]),d.qOj,d.TTD]}),te})();const Qi={provide:he,useExisting:(0,d.Gpc)(()=>Hr),multi:!0};let Hr=(()=>{class te extends b{writeValue(W){this.setProperty("value",W??"")}registerOnChange(W){this.onChange=Te=>{W(""==Te?null:parseFloat(Te))}}}return te.\u0275fac=function(){let Y;return function(Te){return(Y||(Y=d.n5z(te)))(Te||te)}}(),te.\u0275dir=d.lG2({type:te,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(W,Te){1&W&&d.NdJ("input",function(fi){return Te.onChange(fi.target.value)})("blur",function(){return Te.onTouched()})},features:[d._Bn([Qi]),d.qOj]}),te})(),lr=(()=>{class te{}return te.\u0275fac=function(W){return new(W||te)},te.\u0275mod=d.oAB({type:te}),te.\u0275inj=d.cJS({}),te})();function Qs(te){return"number"==typeof te?te:parseFloat(te)}let fs=(()=>{class te{constructor(){this._validator=se}ngOnChanges(W){if(this.inputName in W){const Te=this.normalizeInput(W[this.inputName].currentValue);this._enabled=this.enabled(Te),this._validator=this._enabled?this.createValidator(Te):se,this._onChange&&this._onChange()}}validate(W){return this._validator(W)}registerOnValidatorChange(W){this._onChange=W}enabled(W){return null!=W}}return te.\u0275fac=function(W){return new(W||te)},te.\u0275dir=d.lG2({type:te,features:[d.TTD]}),te})();const Ma={provide:ne,useExisting:(0,d.Gpc)(()=>Uo),multi:!0};let Uo=(()=>{class te extends fs{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=W=>Qs(W),this.createValidator=W=>function ke(te){return Y=>{if(Ke(Y.value)||Ke(te))return null;const W=parseFloat(Y.value);return!isNaN(W)&&W>te?{max:{max:te,actual:Y.value}}:null}}(W)}}return te.\u0275fac=function(){let Y;return function(Te){return(Y||(Y=d.n5z(te)))(Te||te)}}(),te.\u0275dir=d.lG2({type:te,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(W,Te){2&W&&d.uIk("max",Te._enabled?Te.max:null)},inputs:{max:"max"},features:[d._Bn([Ma]),d.qOj]}),te})();const pa={provide:ne,useExisting:(0,d.Gpc)(()=>Sa),multi:!0};let Sa=(()=>{class te extends fs{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=W=>Qs(W),this.createValidator=W=>function ge(te){return Y=>{if(Ke(Y.value)||Ke(te))return null;const W=parseFloat(Y.value);return!isNaN(W)&&W<te?{min:{min:te,actual:Y.value}}:null}}(W)}}return te.\u0275fac=function(){let Y;return function(Te){return(Y||(Y=d.n5z(te)))(Te||te)}}(),te.\u0275dir=d.lG2({type:te,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(W,Te){2&W&&d.uIk("min",Te._enabled?Te.min:null)},inputs:{min:"min"},features:[d._Bn([pa]),d.qOj]}),te})(),kr=(()=>{class te{}return te.\u0275fac=function(W){return new(W||te)},te.\u0275mod=d.oAB({type:te}),te.\u0275inj=d.cJS({imports:[lr]}),te})(),Go=(()=>{class te{static withConfig(W){return{ngModule:te,providers:[{provide:vt,useValue:W.callSetDisabledState??ut}]}}}return te.\u0275fac=function(W){return new(W||te)},te.\u0275mod=d.oAB({type:te}),te.\u0275inj=d.cJS({imports:[kr]}),te})()},1481:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Dx:()=>Mt,b2:()=>Bi,q6:()=>Un});var d=F(6895),v=F(8274);class re extends d.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class a extends re{static makeCurrent(){(0,d.HT)(new a)}onAndCancel(Be,Me,We){return Be.addEventListener(Me,We,!1),()=>{Be.removeEventListener(Me,We,!1)}}dispatchEvent(Be,Me){Be.dispatchEvent(Me)}remove(Be){Be.parentNode&&Be.parentNode.removeChild(Be)}createElement(Be,Me){return(Me=Me||this.getDefaultDocument()).createElement(Be)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(Be){return Be.nodeType===Node.ELEMENT_NODE}isShadowRoot(Be){return Be instanceof DocumentFragment}getGlobalEventTarget(Be,Me){return"window"===Me?window:"document"===Me?Be:"body"===Me?Be.body:null}getBaseHref(Be){const Me=function oe(){return q=q||document.querySelector("base"),q?q.getAttribute("href"):null}();return null==Me?null:function he(Fe){b=b||document.createElement("a"),b.setAttribute("href",Fe);const Be=b.pathname;return"/"===Be.charAt(0)?Be:`/${Be}`}(Me)}resetBaseElement(){q=null}getUserAgent(){return window.navigator.userAgent}getCookie(Be){return(0,d.Mx)(document.cookie,Be)}}let b,q=null;const Ie=new v.OlP("TRANSITION_ID"),K=[{provide:v.ip1,useFactory:function Ve(Fe,Be,Me){return()=>{Me.get(v.CZH).donePromise.then(()=>{const We=(0,d.q)(),jt=Be.querySelectorAll(`style[ng-transition="${Fe}"]`);for(let dn=0;dn<jt.length;dn++)We.remove(jt[dn])})}},deps:[Ie,d.K0,v.zs3],multi:!0}];let pe=(()=>{class Fe{build(){return new XMLHttpRequest}}return Fe.\u0275fac=function(Me){return new(Me||Fe)},Fe.\u0275prov=v.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();const ze=new v.OlP("EventManagerPlugins");let ce=(()=>{class Fe{constructor(Me,We){this._zone=We,this._eventNameToPlugin=new Map,Me.forEach(jt=>jt.manager=this),this._plugins=Me.slice().reverse()}addEventListener(Me,We,jt){return this._findPluginFor(We).addEventListener(Me,We,jt)}addGlobalEventListener(Me,We,jt){return this._findPluginFor(We).addGlobalEventListener(Me,We,jt)}getZone(){return this._zone}_findPluginFor(Me){const We=this._eventNameToPlugin.get(Me);if(We)return We;const jt=this._plugins;for(let dn=0;dn<jt.length;dn++){const Tn=jt[dn];if(Tn.supports(Me))return this._eventNameToPlugin.set(Me,Tn),Tn}throw new Error(`No event manager plugin found for event ${Me}`)}}return Fe.\u0275fac=function(Me){return new(Me||Fe)(v.LFG(ze),v.LFG(v.R0b))},Fe.\u0275prov=v.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();class Ke{constructor(Be){this._doc=Be}addGlobalEventListener(Be,Me,We){const jt=(0,d.q)().getGlobalEventTarget(this._doc,Be);if(!jt)throw new Error(`Unsupported event target ${jt} for event ${Me}`);return this.addEventListener(jt,Me,We)}}let Pe=(()=>{class Fe{constructor(){this.usageCount=new Map}addStyles(Me){for(const We of Me)1===this.changeUsageCount(We,1)&&this.onStyleAdded(We)}removeStyles(Me){for(const We of Me)0===this.changeUsageCount(We,-1)&&this.onStyleRemoved(We)}onStyleRemoved(Me){}onStyleAdded(Me){}getAllStyles(){return this.usageCount.keys()}changeUsageCount(Me,We){const jt=this.usageCount;let dn=jt.get(Me)??0;return dn+=We,dn>0?jt.set(Me,dn):jt.delete(Me),dn}ngOnDestroy(){for(const Me of this.getAllStyles())this.onStyleRemoved(Me);this.usageCount.clear()}}return Fe.\u0275fac=function(Me){return new(Me||Fe)},Fe.\u0275prov=v.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})(),ne=(()=>{class Fe extends Pe{constructor(Me){super(),this.doc=Me,this.styleRef=new Map,this.hostNodes=new Set,this.resetHostNodes()}onStyleAdded(Me){for(const We of this.hostNodes)this.addStyleToHost(We,Me)}onStyleRemoved(Me){const We=this.styleRef;We.get(Me)?.forEach(dn=>dn.remove()),We.delete(Me)}ngOnDestroy(){super.ngOnDestroy(),this.styleRef.clear(),this.resetHostNodes()}addHost(Me){this.hostNodes.add(Me);for(const We of this.getAllStyles())this.addStyleToHost(Me,We)}removeHost(Me){this.hostNodes.delete(Me)}addStyleToHost(Me,We){const jt=this.doc.createElement("style");jt.textContent=We,Me.appendChild(jt);const dn=this.styleRef.get(We);dn?dn.push(jt):this.styleRef.set(We,[jt])}resetHostNodes(){const Me=this.hostNodes;Me.clear(),Me.add(this.doc.head)}}return Fe.\u0275fac=function(Me){return new(Me||Fe)(v.LFG(d.K0))},Fe.\u0275prov=v.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();const Je={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Pt=/%COMP%/g,Xe=new v.OlP("RemoveStylesOnCompDestory",{providedIn:"root",factory:()=>!1});function de(Fe,Be){return Be.flat(100).map(Me=>Me.replace(Pt,Fe))}function se(Fe){return Be=>{if("__ngUnwrap__"===Be)return Fe;!1===Fe(Be)&&(Be.preventDefault(),Be.returnValue=!1)}}let Ee=(()=>{class Fe{constructor(Me,We,jt,dn){this.eventManager=Me,this.sharedStylesHost=We,this.appId=jt,this.removeStylesOnCompDestory=dn,this.rendererByCompId=new Map,this.defaultRenderer=new _t(Me)}createRenderer(Me,We){if(!Me||!We)return this.defaultRenderer;const jt=this.getOrCreateRenderer(Me,We);return jt instanceof xt?jt.applyToHost(Me):jt instanceof St&&jt.applyStyles(),jt}getOrCreateRenderer(Me,We){const jt=this.rendererByCompId;let dn=jt.get(We.id);if(!dn){const Tn=this.eventManager,qn=this.sharedStylesHost,Yn=this.removeStylesOnCompDestory;switch(We.encapsulation){case v.ifc.Emulated:dn=new xt(Tn,qn,We,this.appId,Yn);break;case v.ifc.ShadowDom:return new yt(Tn,qn,Me,We);default:dn=new St(Tn,qn,We,Yn)}dn.onDestroy=()=>jt.delete(We.id),jt.set(We.id,dn)}return dn}ngOnDestroy(){this.rendererByCompId.clear()}begin(){}end(){}}return Fe.\u0275fac=function(Me){return new(Me||Fe)(v.LFG(ce),v.LFG(ne),v.LFG(v.AFp),v.LFG(Xe))},Fe.\u0275prov=v.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();class _t{constructor(Be){this.eventManager=Be,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(Be,Me){return Me?document.createElementNS(Je[Me]||Me,Be):document.createElement(Be)}createComment(Be){return document.createComment(Be)}createText(Be){return document.createTextNode(Be)}appendChild(Be,Me){(Lt(Be)?Be.content:Be).appendChild(Me)}insertBefore(Be,Me,We){Be&&(Lt(Be)?Be.content:Be).insertBefore(Me,We)}removeChild(Be,Me){Be&&Be.removeChild(Me)}selectRootElement(Be,Me){let We="string"==typeof Be?document.querySelector(Be):Be;if(!We)throw new Error(`The selector "${Be}" did not match any elements`);return Me||(We.textContent=""),We}parentNode(Be){return Be.parentNode}nextSibling(Be){return Be.nextSibling}setAttribute(Be,Me,We,jt){if(jt){Me=jt+":"+Me;const dn=Je[jt];dn?Be.setAttributeNS(dn,Me,We):Be.setAttribute(Me,We)}else Be.setAttribute(Me,We)}removeAttribute(Be,Me,We){if(We){const jt=Je[We];jt?Be.removeAttributeNS(jt,Me):Be.removeAttribute(`${We}:${Me}`)}else Be.removeAttribute(Me)}addClass(Be,Me){Be.classList.add(Me)}removeClass(Be,Me){Be.classList.remove(Me)}setStyle(Be,Me,We,jt){jt&(v.JOm.DashCase|v.JOm.Important)?Be.style.setProperty(Me,We,jt&v.JOm.Important?"important":""):Be.style[Me]=We}removeStyle(Be,Me,We){We&v.JOm.DashCase?Be.style.removeProperty(Me):Be.style[Me]=""}setProperty(Be,Me,We){Be[Me]=We}setValue(Be,Me){Be.nodeValue=Me}listen(Be,Me,We){return"string"==typeof Be?this.eventManager.addGlobalEventListener(Be,Me,se(We)):this.eventManager.addEventListener(Be,Me,se(We))}}function Lt(Fe){return"TEMPLATE"===Fe.tagName&&void 0!==Fe.content}class yt extends _t{constructor(Be,Me,We,jt){super(Be),this.sharedStylesHost=Me,this.hostEl=We,this.shadowRoot=We.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const dn=de(jt.id,jt.styles);for(const Tn of dn){const qn=document.createElement("style");qn.textContent=Tn,this.shadowRoot.appendChild(qn)}}nodeOrShadowRoot(Be){return Be===this.hostEl?this.shadowRoot:Be}appendChild(Be,Me){return super.appendChild(this.nodeOrShadowRoot(Be),Me)}insertBefore(Be,Me,We){return super.insertBefore(this.nodeOrShadowRoot(Be),Me,We)}removeChild(Be,Me){return super.removeChild(this.nodeOrShadowRoot(Be),Me)}parentNode(Be){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(Be)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class St extends _t{constructor(Be,Me,We,jt,dn=We.id){super(Be),this.sharedStylesHost=Me,this.removeStylesOnCompDestory=jt,this.rendererUsageCount=0,this.styles=de(dn,We.styles)}applyStyles(){this.sharedStylesHost.addStyles(this.styles),this.rendererUsageCount++}destroy(){this.removeStylesOnCompDestory&&(this.sharedStylesHost.removeStyles(this.styles),this.rendererUsageCount--,0===this.rendererUsageCount&&this.onDestroy?.())}}class xt extends St{constructor(Be,Me,We,jt,dn){const Tn=jt+"-"+We.id;super(Be,Me,We,dn,Tn),this.contentAttr=function He(Fe){return"_ngcontent-%COMP%".replace(Pt,Fe)}(Tn),this.hostAttr=function me(Fe){return"_nghost-%COMP%".replace(Pt,Fe)}(Tn)}applyToHost(Be){this.applyStyles(),this.setAttribute(Be,this.hostAttr,"")}createElement(Be,Me){const We=super.createElement(Be,Me);return super.setAttribute(We,this.contentAttr,""),We}}let rt=(()=>{class Fe extends Ke{constructor(Me){super(Me)}supports(Me){return!0}addEventListener(Me,We,jt){return Me.addEventListener(We,jt,!1),()=>this.removeEventListener(Me,We,jt)}removeEventListener(Me,We,jt){return Me.removeEventListener(We,jt)}}return Fe.\u0275fac=function(Me){return new(Me||Fe)(v.LFG(d.K0))},Fe.\u0275prov=v.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();const lt=["alt","control","meta","shift"],Ce={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},bt={alt:Fe=>Fe.altKey,control:Fe=>Fe.ctrlKey,meta:Fe=>Fe.metaKey,shift:Fe=>Fe.shiftKey};let kt=(()=>{class Fe extends Ke{constructor(Me){super(Me)}supports(Me){return null!=Fe.parseEventName(Me)}addEventListener(Me,We,jt){const dn=Fe.parseEventName(We),Tn=Fe.eventCallback(dn.fullKey,jt,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,d.q)().onAndCancel(Me,dn.domEventName,Tn))}static parseEventName(Me){const We=Me.toLowerCase().split("."),jt=We.shift();if(0===We.length||"keydown"!==jt&&"keyup"!==jt)return null;const dn=Fe._normalizeKey(We.pop());let Tn="",qn=We.indexOf("code");if(qn>-1&&(We.splice(qn,1),Tn="code."),lt.forEach(mi=>{const ei=We.indexOf(mi);ei>-1&&(We.splice(ei,1),Tn+=mi+".")}),Tn+=dn,0!=We.length||0===dn.length)return null;const Yn={};return Yn.domEventName=jt,Yn.fullKey=Tn,Yn}static matchEventFullKeyCode(Me,We){let jt=Ce[Me.key]||Me.key,dn="";return We.indexOf("code.")>-1&&(jt=Me.code,dn="code."),!(null==jt||!jt)&&(jt=jt.toLowerCase()," "===jt?jt="space":"."===jt&&(jt="dot"),lt.forEach(Tn=>{Tn!==jt&&(0,bt[Tn])(Me)&&(dn+=Tn+".")}),dn+=jt,dn===We)}static eventCallback(Me,We,jt){return dn=>{Fe.matchEventFullKeyCode(dn,Me)&&jt.runGuarded(()=>We(dn))}}static _normalizeKey(Me){return"esc"===Me?"escape":Me}}return Fe.\u0275fac=function(Me){return new(Me||Fe)(v.LFG(d.K0))},Fe.\u0275prov=v.Yz7({token:Fe,factory:Fe.\u0275fac}),Fe})();const Un=(0,v.eFA)(v._c5,"browser",[{provide:v.Lbi,useValue:d.bD},{provide:v.g9A,useValue:function Bt(){a.makeCurrent()},multi:!0},{provide:d.K0,useFactory:function Qn(){return(0,v.RDi)(document),document},deps:[]}]),hi=new v.OlP(""),Ii=[{provide:v.rWj,useClass:class xe{addToWindow(Be){v.dqk.getAngularTestability=(We,jt=!0)=>{const dn=Be.findTestabilityInTree(We,jt);if(null==dn)throw new Error("Could not find testability for element.");return dn},v.dqk.getAllAngularTestabilities=()=>Be.getAllTestabilities(),v.dqk.getAllAngularRootElements=()=>Be.getAllRootElements(),v.dqk.frameworkStabilizers||(v.dqk.frameworkStabilizers=[]),v.dqk.frameworkStabilizers.push(We=>{const jt=v.dqk.getAllAngularTestabilities();let dn=jt.length,Tn=!1;const qn=function(Yn){Tn=Tn||Yn,dn--,0==dn&&We(Tn)};jt.forEach(function(Yn){Yn.whenStable(qn)})})}findTestabilityInTree(Be,Me,We){return null==Me?null:Be.getTestability(Me)??(We?(0,d.q)().isShadowRoot(Me)?this.findTestabilityInTree(Be,Me.host,!0):this.findTestabilityInTree(Be,Me.parentElement,!0):null)}},deps:[]},{provide:v.lri,useClass:v.dDg,deps:[v.R0b,v.eoX,v.rWj]},{provide:v.dDg,useClass:v.dDg,deps:[v.R0b,v.eoX,v.rWj]}],yi=[{provide:v.zSh,useValue:"root"},{provide:v.qLn,useFactory:function Sn(){return new v.qLn},deps:[]},{provide:ze,useClass:rt,multi:!0,deps:[d.K0,v.R0b,v.Lbi]},{provide:ze,useClass:kt,multi:!0,deps:[d.K0]},{provide:Ee,useClass:Ee,deps:[ce,ne,v.AFp,Xe]},{provide:v.FYo,useExisting:Ee},{provide:Pe,useExisting:ne},{provide:ne,useClass:ne,deps:[d.K0]},{provide:ce,useClass:ce,deps:[ze,v.R0b]},{provide:d.JF,useClass:pe,deps:[]},[]];let Bi=(()=>{class Fe{constructor(Me){}static withServerTransition(Me){return{ngModule:Fe,providers:[{provide:v.AFp,useValue:Me.appId},{provide:Ie,useExisting:v.AFp},K]}}}return Fe.\u0275fac=function(Me){return new(Me||Fe)(v.LFG(hi,12))},Fe.\u0275mod=v.oAB({type:Fe}),Fe.\u0275inj=v.cJS({providers:[...yi,...Ii],imports:[d.ez,v.hGG]}),Fe})(),Mt=(()=>{class Fe{constructor(Me){this._doc=Me}getTitle(){return this._doc.title}setTitle(Me){this._doc.title=Me||""}}return Fe.\u0275fac=function(Me){return new(Me||Fe)(v.LFG(d.K0))},Fe.\u0275prov=v.Yz7({token:Fe,factory:function(Me){let We=null;return We=Me?new Me:function Vt(){return new Mt((0,v.LFG)(d.K0))}(),We},providedIn:"root"}),Fe})();typeof window<"u"&&window},4228:(Ln,Dt,F)=>{"use strict";F.d(Dt,{gz:()=>mo,y6:()=>Vo,OD:()=>Ai,eC:()=>Un,wN:()=>Js,F0:()=>ns,rH:()=>ta,Bz:()=>Ja,Hx:()=>Ue});var d=F(8274),v=F(2076),re=F(9646),a=F(1135);const oe=(0,F(3888).d)(u=>function(){u(this),this.name="EmptyError",this.message="no elements in sequence"});var b=F(9751),he=F(4742),Ie=F(4671),Ve=F(3268),K=F(7669),xe=F(1810),pe=F(5403),ze=F(9672);function ce(...u){const p=(0,K.yG)(u),f=(0,K.jO)(u),{args:w,keys:E}=(0,he.D)(u);if(0===w.length)return(0,v.D)([],p);const P=new b.y(function Ke(u,p,f=Ie.y){return w=>{Pe(p,()=>{const{length:E}=u,P=new Array(E);let O=E,V=E;for(let Q=0;Q<E;Q++)Pe(p,()=>{const ye=(0,v.D)(u[Q],p);let be=!1;ye.subscribe((0,pe.x)(w,Oe=>{P[Q]=Oe,be||(be=!0,V--),V||w.next(f(P.slice()))},()=>{--O||w.complete()}))},w)},w)}}(w,p,E?O=>(0,xe.n)(E,O):Ie.y));return f?P.pipe((0,Ve.Z)(f)):P}function Pe(u,p,f){u?(0,ze.f)(f,u,p):p()}var ne=F(7272),Je=F(9770),Pt=F(9635),at=F(576);function ge(u,p){const f=(0,at.m)(u)?u:()=>u,w=E=>E.error(f());return new b.y(p?E=>p.schedule(w,0,E):w)}var ke=F(515),Le=F(727),we=F(4482);function Xe(){return(0,we.e)((u,p)=>{let f=null;u._refCount++;const w=(0,pe.x)(p,void 0,void 0,void 0,()=>{if(!u||u._refCount<=0||0<--u._refCount)return void(f=null);const E=u._connection,P=f;f=null,E&&(!P||E===P)&&E.unsubscribe(),p.unsubscribe()});u.subscribe(w),w.closed||(f=u.connect())})}class He extends b.y{constructor(p,f){super(),this.source=p,this.subjectFactory=f,this._subject=null,this._refCount=0,this._connection=null,(0,we.A)(p)&&(this.lift=p.lift)}_subscribe(p){return this.getSubject().subscribe(p)}getSubject(){const p=this._subject;return(!p||p.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:p}=this;this._subject=this._connection=null,p?.unsubscribe()}connect(){let p=this._connection;if(!p){p=this._connection=new Le.w0;const f=this.getSubject();p.add(this.source.subscribe((0,pe.x)(f,void 0,()=>{this._teardown(),f.complete()},w=>{this._teardown(),f.error(w)},()=>this._teardown()))),p.closed&&(this._connection=null,p=Le.w0.EMPTY)}return p}refCount(){return Xe()(this)}}var me=F(7579),de=F(6895),se=F(4004),Ee=F(3900),_t=F(5698),Gt=F(9300),Lt=F(5577);function yt(u){return(0,we.e)((p,f)=>{let w=!1;p.subscribe((0,pe.x)(f,E=>{w=!0,f.next(E)},()=>{w||f.next(u),f.complete()}))})}function St(u=xt){return(0,we.e)((p,f)=>{let w=!1;p.subscribe((0,pe.x)(f,E=>{w=!0,f.next(E)},()=>w?f.complete():f.error(u())))})}function xt(){return new oe}function rt(u,p){const f=arguments.length>=2;return w=>w.pipe(u?(0,Gt.h)((E,P)=>u(E,P,w)):Ie.y,(0,_t.q)(1),f?yt(p):St(()=>new oe))}var lt=F(4351);function Ce(u,p,f){const w=(0,at.m)(u)||p||f?{next:u,error:p,complete:f}:u;return w?(0,we.e)((E,P)=>{var O;null===(O=w.subscribe)||void 0===O||O.call(w);let V=!0;E.subscribe((0,pe.x)(P,Q=>{var ye;null===(ye=w.next)||void 0===ye||ye.call(w,Q),P.next(Q)},()=>{var Q;V=!1,null===(Q=w.complete)||void 0===Q||Q.call(w),P.complete()},Q=>{var ye;V=!1,null===(ye=w.error)||void 0===ye||ye.call(w,Q),P.error(Q)},()=>{var Q,ye;V&&(null===(Q=w.unsubscribe)||void 0===Q||Q.call(w)),null===(ye=w.finalize)||void 0===ye||ye.call(w)}))}):Ie.y}var bt=F(8421);function kt(u){return(0,we.e)((p,f)=>{let P,w=null,E=!1;w=p.subscribe((0,pe.x)(f,void 0,void 0,O=>{P=(0,bt.Xf)(u(O,kt(u)(p))),w?(w.unsubscribe(),w=null,P.subscribe(f)):E=!0})),E&&(w.unsubscribe(),w=null,P.subscribe(f))})}function bn(u,p){return(0,we.e)(function Ut(u,p,f,w,E){return(P,O)=>{let V=f,Q=p,ye=0;P.subscribe((0,pe.x)(O,be=>{const Oe=ye++;Q=V?u(Q,be,Oe):(V=!0,be),w&&O.next(Q)},E&&(()=>{V&&O.next(Q),O.complete()})))}}(u,p,arguments.length>=2,!0))}function Nn(u){return u<=0?()=>ke.E:(0,we.e)((p,f)=>{let w=[];p.subscribe((0,pe.x)(f,E=>{w.push(E),u<w.length&&w.shift()},()=>{for(const E of w)f.next(E);f.complete()},void 0,()=>{w=null}))})}function un(u,p){const f=arguments.length>=2;return w=>w.pipe(u?(0,Gt.h)((E,P)=>u(E,P,w)):Ie.y,Nn(1),f?yt(p):St(()=>new oe))}function Sn(u){return(0,we.e)((p,f)=>{try{p.subscribe(f)}finally{f.add(u)}})}var Qn=F(8189),ci=F(1481);const Un="primary",hi=Symbol("RouteTitle");class Ii{constructor(p){this.params=p||{}}has(p){return Object.prototype.hasOwnProperty.call(this.params,p)}get(p){if(this.has(p)){const f=this.params[p];return Array.isArray(f)?f[0]:f}return null}getAll(p){if(this.has(p)){const f=this.params[p];return Array.isArray(f)?f:[f]}return[]}get keys(){return Object.keys(this.params)}}function yi(u){return new Ii(u)}function Bi(u,p,f){const w=f.path.split("/");if(w.length>u.length||"full"===f.pathMatch&&(p.hasChildren()||w.length<u.length))return null;const E={};for(let P=0;P<w.length;P++){const O=w[P],V=u[P];if(O.startsWith(":"))E[O.substring(1)]=V;else if(O!==V.path)return null}return{consumed:u.slice(0,w.length),posParams:E}}function Ni(u,p){const f=u?Object.keys(u):void 0,w=p?Object.keys(p):void 0;if(!f||!w||f.length!=w.length)return!1;let E;for(let P=0;P<f.length;P++)if(E=f[P],!Ki(u[E],p[E]))return!1;return!0}function Ki(u,p){if(Array.isArray(u)&&Array.isArray(p)){if(u.length!==p.length)return!1;const f=[...u].sort(),w=[...p].sort();return f.every((E,P)=>w[P]===E)}return u===p}function Vt(u){return Array.prototype.concat.apply([],u)}function Mt(u){return u.length>0?u[u.length-1]:null}function ie(u,p){for(const f in u)u.hasOwnProperty(f)&&p(u[f],f)}function Qe(u){return(0,d.CqO)(u)?u:(0,d.QGY)(u)?(0,v.D)(Promise.resolve(u)):(0,re.of)(u)}const Wt=!1,rn={exact:function pi(u,p,f){if(!Rt(u.segments,p.segments)||!xr(u.segments,p.segments,f)||u.numberOfChildren!==p.numberOfChildren)return!1;for(const w in p.children)if(!u.children[w]||!pi(u.children[w],p.children[w],f))return!1;return!0},subset:Si},oi={exact:function ar(u,p){return Ni(u,p)},subset:function mr(u,p){return Object.keys(p).length<=Object.keys(u).length&&Object.keys(p).every(f=>Ki(u[f],p[f]))},ignored:()=>!0};function Di(u,p,f){return rn[f.paths](u.root,p.root,f.matrixParams)&&oi[f.queryParams](u.queryParams,p.queryParams)&&!("exact"===f.fragment&&u.fragment!==p.fragment)}function Si(u,p,f){return vr(u,p,p.segments,f)}function vr(u,p,f,w){if(u.segments.length>f.length){const E=u.segments.slice(0,f.length);return!(!Rt(E,f)||p.hasChildren()||!xr(E,f,w))}if(u.segments.length===f.length){if(!Rt(u.segments,f)||!xr(u.segments,f,w))return!1;for(const E in p.children)if(!u.children[E]||!Si(u.children[E],p.children[E],w))return!1;return!0}{const E=f.slice(0,u.segments.length),P=f.slice(u.segments.length);return!!(Rt(u.segments,E)&&xr(u.segments,E,w)&&u.children[Un])&&vr(u.children[Un],p,P,w)}}function xr(u,p,f){return p.every((w,E)=>oi[f](u[E].parameters,w.parameters))}class gr{constructor(p=new ui([],{}),f={},w=null){this.root=p,this.queryParams=f,this.fragment=w}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=yi(this.queryParams)),this._queryParamMap}toString(){return z.serialize(this)}}class ui{constructor(p,f){this.segments=p,this.children=f,this.parent=null,ie(f,(w,E)=>w.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return k(this)}}class pn{constructor(p,f){this.path=p,this.parameters=f}get parameterMap(){return this._parameterMap||(this._parameterMap=yi(this.parameters)),this._parameterMap}toString(){return Fe(this)}}function Rt(u,p){return u.length===p.length&&u.every((f,w)=>f.path===p[w].path)}let Ue=(()=>{class u{}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:function(){return new Ht},providedIn:"root"}),u})();class Ht{parse(p){const f=new mi(p);return new gr(f.parseRootSegment(),f.parseQueryParams(),f.parseFragment())}serialize(p){const f=`/${X(p.root,!0)}`,w=function Me(u){const p=Object.keys(u).map(f=>{const w=u[f];return Array.isArray(w)?w.map(E=>`${Ze(f)}=${Ze(E)}`).join("&"):`${Ze(f)}=${Ze(w)}`}).filter(f=>!!f);return p.length?`?${p.join("&")}`:""}(p.queryParams);return`${f}${w}${"string"==typeof p.fragment?`#${function dt(u){return encodeURI(u)}(p.fragment)}`:""}`}}const z=new Ht;function k(u){return u.segments.map(p=>Fe(p)).join("/")}function X(u,p){if(!u.hasChildren())return k(u);if(p){const f=u.children[Un]?X(u.children[Un],!1):"",w=[];return ie(u.children,(E,P)=>{P!==Un&&w.push(`${P}:${X(E,!1)}`)}),w.length>0?`${f}(${w.join("//")})`:f}{const f=function _n(u,p){let f=[];return ie(u.children,(w,E)=>{E===Un&&(f=f.concat(p(w,E)))}),ie(u.children,(w,E)=>{E!==Un&&(f=f.concat(p(w,E)))}),f}(u,(w,E)=>E===Un?[X(u.children[Un],!1)]:[`${E}:${X(w,!1)}`]);return 1===Object.keys(u.children).length&&null!=u.children[Un]?`${k(u)}/${f[0]}`:`${k(u)}/(${f.join("//")})`}}function De(u){return encodeURIComponent(u).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Ze(u){return De(u).replace(/%3B/gi,";")}function Ot(u){return De(u).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function vt(u){return decodeURIComponent(u)}function ut(u){return vt(u.replace(/\+/g,"%20"))}function Fe(u){return`${Ot(u.path)}${function Be(u){return Object.keys(u).map(p=>`;${Ot(p)}=${Ot(u[p])}`).join("")}(u.parameters)}`}const We=/^[^\/()?;=#]+/;function jt(u){const p=u.match(We);return p?p[0]:""}const dn=/^[^=?&#]+/,qn=/^[^&#]+/;class mi{constructor(p){this.url=p,this.remaining=p}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new ui([],{}):new ui([],this.parseChildren())}parseQueryParams(){const p={};if(this.consumeOptional("?"))do{this.parseQueryParam(p)}while(this.consumeOptional("&"));return p}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const p=[];for(this.peekStartsWith("(")||p.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),p.push(this.parseSegment());let f={};this.peekStartsWith("/(")&&(this.capture("/"),f=this.parseParens(!0));let w={};return this.peekStartsWith("(")&&(w=this.parseParens(!1)),(p.length>0||Object.keys(f).length>0)&&(w[Un]=new ui(p,f)),w}parseSegment(){const p=jt(this.remaining);if(""===p&&this.peekStartsWith(";"))throw new d.vHH(4009,Wt);return this.capture(p),new pn(vt(p),this.parseMatrixParams())}parseMatrixParams(){const p={};for(;this.consumeOptional(";");)this.parseParam(p);return p}parseParam(p){const f=jt(this.remaining);if(!f)return;this.capture(f);let w="";if(this.consumeOptional("=")){const E=jt(this.remaining);E&&(w=E,this.capture(w))}p[vt(f)]=vt(w)}parseQueryParam(p){const f=function Tn(u){const p=u.match(dn);return p?p[0]:""}(this.remaining);if(!f)return;this.capture(f);let w="";if(this.consumeOptional("=")){const O=function Yn(u){const p=u.match(qn);return p?p[0]:""}(this.remaining);O&&(w=O,this.capture(w))}const E=ut(f),P=ut(w);if(p.hasOwnProperty(E)){let O=p[E];Array.isArray(O)||(O=[O],p[E]=O),O.push(P)}else p[E]=P}parseParens(p){const f={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const w=jt(this.remaining),E=this.remaining[w.length];if("/"!==E&&")"!==E&&";"!==E)throw new d.vHH(4010,Wt);let P;w.indexOf(":")>-1?(P=w.slice(0,w.indexOf(":")),this.capture(P),this.capture(":")):p&&(P=Un);const O=this.parseChildren();f[P]=1===Object.keys(O).length?O[Un]:new ui([],O),this.consumeOptional("//")}return f}peekStartsWith(p){return this.remaining.startsWith(p)}consumeOptional(p){return!!this.peekStartsWith(p)&&(this.remaining=this.remaining.substring(p.length),!0)}capture(p){if(!this.consumeOptional(p))throw new d.vHH(4011,Wt)}}function ei(u){return u.segments.length>0?new ui([],{[Un]:u}):u}function Oi(u){const p={};for(const w of Object.keys(u.children)){const P=Oi(u.children[w]);(P.segments.length>0||P.hasChildren())&&(p[w]=P)}return function Li(u){if(1===u.numberOfChildren&&u.children[Un]){const p=u.children[Un];return new ui(u.segments.concat(p.segments),p.children)}return u}(new ui(u.segments,p))}function Er(u){return u instanceof gr}const Gr=!1;function no(u,p,f,w,E){if(0===f.length)return qi(p.root,p.root,p.root,w,E);const P=function In(u){if("string"==typeof u[0]&&1===u.length&&"/"===u[0])return new Kr(!0,0,u);let p=0,f=!1;const w=u.reduce((E,P,O)=>{if("object"==typeof P&&null!=P){if(P.outlets){const V={};return ie(P.outlets,(Q,ye)=>{V[ye]="string"==typeof Q?Q.split("/"):Q}),[...E,{outlets:V}]}if(P.segmentPath)return[...E,P.segmentPath]}return"string"!=typeof P?[...E,P]:0===O?(P.split("/").forEach((V,Q)=>{0==Q&&"."===V||(0==Q&&""===V?f=!0:".."===V?p++:""!=V&&E.push(V))}),E):[...E,P]},[]);return new Kr(f,p,w)}(f);return P.toRoot()?qi(p.root,p.root,new ui([],{}),w,E):function O(Q){const ye=function fe(u,p,f,w){if(u.isAbsolute)return new si(p.root,!0,0);if(-1===w)return new si(f,f===p.root,0);return function $e(u,p,f){let w=u,E=p,P=f;for(;P>E;){if(P-=E,w=w.parent,!w)throw new d.vHH(4005,Gr&&"Invalid number of '../'");E=w.segments.length}return new si(w,!1,E-P)}(f,w+(fo(u.commands[0])?0:1),u.numberOfDoubleDots)}(P,p,u.snapshot?._urlSegment,Q),be=ye.processChildren?en(ye.segmentGroup,ye.index,P.commands):zt(ye.segmentGroup,ye.index,P.commands);return qi(p.root,ye.segmentGroup,be,w,E)}(u.snapshot?._lastPathIndex)}function fo(u){return"object"==typeof u&&null!=u&&!u.outlets&&!u.segmentPath}function bi(u){return"object"==typeof u&&null!=u&&u.outlets}function qi(u,p,f,w,E){let O,P={};w&&ie(w,(Q,ye)=>{P[ye]=Array.isArray(Q)?Q.map(be=>`${be}`):`${Q}`}),O=u===p?f:Dr(u,p,f);const V=ei(Oi(O));return new gr(V,P,E)}function Dr(u,p,f){const w={};return ie(u.children,(E,P)=>{w[P]=E===p?f:Dr(E,p,f)}),new ui(u.segments,w)}class Kr{constructor(p,f,w){if(this.isAbsolute=p,this.numberOfDoubleDots=f,this.commands=w,p&&w.length>0&&fo(w[0]))throw new d.vHH(4003,Gr&&"Root segment cannot have matrix parameters");const E=w.find(bi);if(E&&E!==Mt(w))throw new d.vHH(4004,Gr&&"{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class si{constructor(p,f,w){this.segmentGroup=p,this.processChildren=f,this.index=w}}function zt(u,p,f){if(u||(u=new ui([],{})),0===u.segments.length&&u.hasChildren())return en(u,p,f);const w=function je(u,p,f){let w=0,E=p;const P={match:!1,pathIndex:0,commandIndex:0};for(;E<u.segments.length;){if(w>=f.length)return P;const O=u.segments[E],V=f[w];if(bi(V))break;const Q=`${V}`,ye=w<f.length-1?f[w+1]:null;if(E>0&&void 0===Q)break;if(Q&&ye&&"object"==typeof ye&&void 0===ye.outlets){if(!Yt(Q,ye,O))return P;w+=2}else{if(!Yt(Q,{},O))return P;w++}E++}return{match:!0,pathIndex:E,commandIndex:w}}(u,p,f),E=f.slice(w.commandIndex);if(w.match&&w.pathIndex<u.segments.length){const P=new ui(u.segments.slice(0,w.pathIndex),{});return P.children[Un]=new ui(u.segments.slice(w.pathIndex),u.children),en(P,0,E)}return w.match&&0===E.length?new ui(u.segments,{}):w.match&&!u.hasChildren()?gt(u,p,f):w.match?en(u,0,E):gt(u,p,f)}function en(u,p,f){if(0===f.length)return new ui(u.segments,{});{const w=function ct(u){return bi(u[0])?u[0].outlets:{[Un]:u}}(f),E={};return!w[Un]&&u.children[Un]&&1===u.numberOfChildren&&0===u.children[Un].segments.length?en(u.children[Un],p,f):(ie(w,(P,O)=>{"string"==typeof P&&(P=[P]),null!==P&&(E[O]=zt(u.children[O],p,P))}),ie(u.children,(P,O)=>{void 0===w[O]&&(E[O]=P)}),new ui(u.segments,E))}}function gt(u,p,f){const w=u.segments.slice(0,p);let E=0;for(;E<f.length;){const P=f[E];if(bi(P)){const Q=Ft(P.outlets);return new ui(w,Q)}if(0===E&&fo(f[0])){w.push(new pn(u.segments[p].path,gn(f[0]))),E++;continue}const O=bi(P)?P.outlets[Un]:`${P}`,V=E<f.length-1?f[E+1]:null;O&&V&&fo(V)?(w.push(new pn(O,gn(V))),E+=2):(w.push(new pn(O,{})),E++)}return new ui(w,{})}function Ft(u){const p={};return ie(u,(f,w)=>{"string"==typeof f&&(f=[f]),null!==f&&(p[w]=gt(new ui([],{}),0,f))}),p}function gn(u){const p={};return ie(u,(f,w)=>p[w]=`${f}`),p}function Yt(u,p,f){return u==f.path&&Ni(p,f.parameters)}const Gn="imperative";class Hn{constructor(p,f){this.id=p,this.url=f}}class Ai extends Hn{constructor(p,f,w="imperative",E=null){super(p,f),this.type=0,this.navigationTrigger=w,this.restoredState=E}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Fi extends Hn{constructor(p,f,w){super(p,f),this.urlAfterRedirects=w,this.type=1}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class Vi extends Hn{constructor(p,f,w,E){super(p,f),this.reason=w,this.code=E,this.type=2}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Ir extends Hn{constructor(p,f,w,E){super(p,f),this.reason=w,this.code=E,this.type=16}}class Qi extends Hn{constructor(p,f,w,E){super(p,f),this.error=w,this.target=E,this.type=3}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Hr extends Hn{constructor(p,f,w,E){super(p,f),this.urlAfterRedirects=w,this.state=E,this.type=4}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class zr extends Hn{constructor(p,f,w,E){super(p,f),this.urlAfterRedirects=w,this.state=E,this.type=7}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class hr extends Hn{constructor(p,f,w,E,P){super(p,f),this.urlAfterRedirects=w,this.state=E,this.shouldActivate=P,this.type=8}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class lr extends Hn{constructor(p,f,w,E){super(p,f),this.urlAfterRedirects=w,this.state=E,this.type=5}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class la extends Hn{constructor(p,f,w,E){super(p,f),this.urlAfterRedirects=w,this.state=E,this.type=6}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class io{constructor(p){this.route=p,this.type=9}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class ro{constructor(p){this.route=p,this.type=10}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class Ds{constructor(p){this.snapshot=p,this.type=11}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ko{constructor(p){this.snapshot=p,this.type=12}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class br{constructor(p){this.snapshot=p,this.type=13}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Ur{constructor(p){this.snapshot=p,this.type=14}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class ca{constructor(p,f,w){this.routerEvent=p,this.position=f,this.anchor=w,this.type=15}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}let hs=(()=>{class u{createUrlTree(f,w,E,P,O,V){return no(f||w.root,E,P,O,V)}}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac}),u})(),lo=(()=>{class u{}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:function(p){return hs.\u0275fac(p)},providedIn:"root"}),u})();class Qr{constructor(p){this._root=p}get root(){return this._root.value}parent(p){const f=this.pathFromRoot(p);return f.length>1?f[f.length-2]:null}children(p){const f=js(p,this._root);return f?f.children.map(w=>w.value):[]}firstChild(p){const f=js(p,this._root);return f&&f.children.length>0?f.children[0].value:null}siblings(p){const f=ua(p,this._root);return f.length<2?[]:f[f.length-2].children.map(E=>E.value).filter(E=>E!==p)}pathFromRoot(p){return ua(p,this._root).map(f=>f.value)}}function js(u,p){if(u===p.value)return p;for(const f of p.children){const w=js(u,f);if(w)return w}return null}function ua(u,p){if(u===p.value)return[p];for(const f of p.children){const w=ua(u,f);if(w.length)return w.unshift(p),w}return[]}class Co{constructor(p,f){this.value=p,this.children=f}toString(){return`TreeNode(${this.value})`}}function To(u){const p={};return u&&u.children.forEach(f=>p[f.value.outlet]=f),p}class Ia extends Qr{constructor(p,f){super(p),this.snapshot=f,da(this,p)}toString(){return this.snapshot.toString()}}function zo(u,p){const f=function ps(u,p){const O=new go([],{},{},"",{},Un,p,null,u.root,-1,{});return new Ss("",new Co(O,[]))}(u,p),w=new a.X([new pn("",{})]),E=new a.X({}),P=new a.X({}),O=new a.X({}),V=new a.X(""),Q=new mo(w,E,O,V,P,Un,p,f.root);return Q.snapshot=f.root,new Ia(new Co(Q,[]),f)}class mo{constructor(p,f,w,E,P,O,V,Q){this.url=p,this.params=f,this.queryParams=w,this.fragment=E,this.data=P,this.outlet=O,this.component=V,this.title=this.data?.pipe((0,se.U)(ye=>ye[hi]))??(0,re.of)(void 0),this._futureSnapshot=Q}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe((0,se.U)(p=>yi(p)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe((0,se.U)(p=>yi(p)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function Is(u,p="emptyOnly"){const f=u.pathFromRoot;let w=0;if("always"!==p)for(w=f.length-1;w>=1;){const E=f[w],P=f[w-1];if(E.routeConfig&&""===E.routeConfig.path)w--;else{if(P.component)break;w--}}return function Ms(u){return u.reduce((p,f)=>({params:{...p.params,...f.params},data:{...p.data,...f.data},resolve:{...f.data,...p.resolve,...f.routeConfig?.data,...f._resolvedData}}),{params:{},data:{},resolve:{}})}(f.slice(w))}class go{get title(){return this.data?.[hi]}constructor(p,f,w,E,P,O,V,Q,ye,be,Oe){this.url=p,this.params=f,this.queryParams=w,this.fragment=E,this.data=P,this.outlet=O,this.component=V,this.routeConfig=Q,this._urlSegment=ye,this._lastPathIndex=be,this._resolve=Oe}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=yi(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=yi(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(w=>w.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class Ss extends Qr{constructor(p,f){super(f),this.url=p,da(this,f)}toString(){return ha(this._root)}}function da(u,p){p.value._routerState=u,p.children.forEach(f=>da(u,f))}function ha(u){const p=u.children.length>0?` { ${u.children.map(ha).join(", ")} } `:"";return`${u.value}${p}`}function Qs(u){if(u.snapshot){const p=u.snapshot,f=u._futureSnapshot;u.snapshot=f,Ni(p.queryParams,f.queryParams)||u.queryParams.next(f.queryParams),p.fragment!==f.fragment&&u.fragment.next(f.fragment),Ni(p.params,f.params)||u.params.next(f.params),function Mi(u,p){if(u.length!==p.length)return!1;for(let f=0;f<u.length;++f)if(!Ni(u[f],p[f]))return!1;return!0}(p.url,f.url)||u.url.next(f.url),Ni(p.data,f.data)||u.data.next(f.data)}else u.snapshot=u._futureSnapshot,u.data.next(u._futureSnapshot.data)}function fs(u,p){const f=Ni(u.params,p.params)&&function wt(u,p){return Rt(u,p)&&u.every((f,w)=>Ni(f.parameters,p[w].parameters))}(u.url,p.url);return f&&!(!u.parent!=!p.parent)&&(!u.parent||fs(u.parent,p.parent))}function Uo(u,p,f){if(f&&u.shouldReuseRoute(p.value,f.value.snapshot)){const w=f.value;w._futureSnapshot=p.value;const E=function pa(u,p,f){return p.children.map(w=>{for(const E of f.children)if(u.shouldReuseRoute(w.value,E.value.snapshot))return Uo(u,w,E);return Uo(u,w)})}(u,p,f);return new Co(w,E)}{if(u.shouldAttach(p.value)){const P=u.retrieve(p.value);if(null!==P){const O=P.route;return O.value._futureSnapshot=p.value,O.children=p.children.map(V=>Uo(u,V)),O}}const w=function Sa(u){return new mo(new a.X(u.url),new a.X(u.params),new a.X(u.queryParams),new a.X(u.fragment),new a.X(u.data),u.outlet,u.component,u)}(p.value),E=p.children.map(P=>Uo(u,P));return new Co(w,E)}}const As="ngNavigationCancelingError";function Mo(u,p){const{redirectTo:f,navigationBehaviorOptions:w}=Er(p)?{redirectTo:p,navigationBehaviorOptions:void 0}:p,E=$s(!1,0,p);return E.url=f,E.navigationBehaviorOptions=w,E}function $s(u,p,f){const w=new Error("NavigationCancelingError: "+(u||""));return w[As]=!0,w.cancellationCode=p,f&&(w.url=f),w}function Lo(u){return ji(u)&&Er(u.url)}function ji(u){return u&&u[As]}class ea{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.injector=null,this.children=new Vo,this.attachRef=null}}let Vo=(()=>{class u{constructor(){this.contexts=new Map}onChildOutletCreated(f,w){const E=this.getOrCreateContext(f);E.outlet=w,this.contexts.set(f,E)}onChildOutletDestroyed(f){const w=this.getContext(f);w&&(w.outlet=null,w.attachRef=null)}onOutletDeactivated(){const f=this.contexts;return this.contexts=new Map,f}onOutletReAttached(f){this.contexts=f}getOrCreateContext(f){let w=this.getContext(f);return w||(w=new ea,this.contexts.set(f,w)),w}getContext(f){return this.contexts.get(f)||null}}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const jo=!1;let ms=(()=>{class u{constructor(){this.activated=null,this._activatedRoute=null,this.name=Un,this.activateEvents=new d.vpe,this.deactivateEvents=new d.vpe,this.attachEvents=new d.vpe,this.detachEvents=new d.vpe,this.parentContexts=(0,d.f3M)(Vo),this.location=(0,d.f3M)(d.s_b),this.changeDetector=(0,d.f3M)(d.sBO),this.environmentInjector=(0,d.f3M)(d.lqb)}ngOnChanges(f){if(f.name){const{firstChange:w,previousValue:E}=f.name;if(w)return;this.isTrackedInParentContexts(E)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(E)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name)}isTrackedInParentContexts(f){return this.parentContexts.getContext(f)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const f=this.parentContexts.getContext(this.name);f?.route&&(f.attachRef?this.attach(f.attachRef,f.route):this.activateWith(f.route,f.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new d.vHH(4012,jo);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new d.vHH(4012,jo);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new d.vHH(4012,jo);this.location.detach();const f=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(f.instance),f}attach(f,w){this.activated=f,this._activatedRoute=w,this.location.insert(f.hostView),this.attachEvents.emit(f.instance)}deactivate(){if(this.activated){const f=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(f)}}activateWith(f,w){if(this.isActivated)throw new d.vHH(4013,jo);this._activatedRoute=f;const E=this.location,O=f.snapshot.component,V=this.parentContexts.getOrCreateContext(this.name).children,Q=new Zs(f,V,E.injector);if(w&&function gs(u){return!!u.resolveComponentFactory}(w)){const ye=w.resolveComponentFactory(O);this.activated=E.createComponent(ye,E.length,Q)}else this.activated=E.createComponent(O,{index:E.length,injector:Q,environmentInjector:w??this.environmentInjector});this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return u.\u0275fac=function(f){return new(f||u)},u.\u0275dir=d.lG2({type:u,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[d.TTD]}),u})();class Zs{constructor(p,f,w){this.route=p,this.childContexts=f,this.parent=w}get(p,f){return p===mo?this.route:p===Vo?this.childContexts:this.parent.get(p,f)}}let $o=(()=>{class u{}return u.\u0275fac=function(f){return new(f||u)},u.\u0275cmp=d.Xpm({type:u,selectors:[["ng-component"]],standalone:!0,features:[d.jDz],decls:1,vars:0,template:function(f,w){1&f&&d._UZ(0,"router-outlet")},dependencies:[ms],encapsulation:2}),u})();function co(u,p){return u.providers&&!u._injector&&(u._injector=(0,d.MMx)(u.providers,p,`Route: ${u.path}`)),u._injector??p}function ys(u){const p=u.children&&u.children.map(ys),f=p?{...u,children:p}:{...u};return!f.component&&!f.loadComponent&&(p||f.loadChildren)&&f.outlet&&f.outlet!==Un&&(f.component=$o),f}function Mr(u){return u.outlet||Un}function ma(u,p){const f=u.filter(w=>Mr(w)===p);return f.push(...u.filter(w=>Mr(w)!==p)),f}function Go(u){if(!u)return null;if(u.routeConfig?._injector)return u.routeConfig._injector;for(let p=u.parent;p;p=p.parent){const f=p.routeConfig;if(f?._loadedInjector)return f._loadedInjector;if(f?._injector)return f._injector}return null}class te{constructor(p,f,w,E){this.routeReuseStrategy=p,this.futureState=f,this.currState=w,this.forwardEvent=E}activate(p){const f=this.futureState._root,w=this.currState?this.currState._root:null;this.deactivateChildRoutes(f,w,p),Qs(this.futureState.root),this.activateChildRoutes(f,w,p)}deactivateChildRoutes(p,f,w){const E=To(f);p.children.forEach(P=>{const O=P.value.outlet;this.deactivateRoutes(P,E[O],w),delete E[O]}),ie(E,(P,O)=>{this.deactivateRouteAndItsChildren(P,w)})}deactivateRoutes(p,f,w){const E=p.value,P=f?f.value:null;if(E===P)if(E.component){const O=w.getContext(E.outlet);O&&this.deactivateChildRoutes(p,f,O.children)}else this.deactivateChildRoutes(p,f,w);else P&&this.deactivateRouteAndItsChildren(f,w)}deactivateRouteAndItsChildren(p,f){p.value.component&&this.routeReuseStrategy.shouldDetach(p.value.snapshot)?this.detachAndStoreRouteSubtree(p,f):this.deactivateRouteAndOutlet(p,f)}detachAndStoreRouteSubtree(p,f){const w=f.getContext(p.value.outlet),E=w&&p.value.component?w.children:f,P=To(p);for(const O of Object.keys(P))this.deactivateRouteAndItsChildren(P[O],E);if(w&&w.outlet){const O=w.outlet.detach(),V=w.children.onOutletDeactivated();this.routeReuseStrategy.store(p.value.snapshot,{componentRef:O,route:p,contexts:V})}}deactivateRouteAndOutlet(p,f){const w=f.getContext(p.value.outlet),E=w&&p.value.component?w.children:f,P=To(p);for(const O of Object.keys(P))this.deactivateRouteAndItsChildren(P[O],E);w&&w.outlet&&(w.outlet.deactivate(),w.children.onOutletDeactivated(),w.attachRef=null,w.resolver=null,w.route=null)}activateChildRoutes(p,f,w){const E=To(f);p.children.forEach(P=>{this.activateRoutes(P,E[P.value.outlet],w),this.forwardEvent(new Ur(P.value.snapshot))}),p.children.length&&this.forwardEvent(new Ko(p.value.snapshot))}activateRoutes(p,f,w){const E=p.value,P=f?f.value:null;if(Qs(E),E===P)if(E.component){const O=w.getOrCreateContext(E.outlet);this.activateChildRoutes(p,f,O.children)}else this.activateChildRoutes(p,f,w);else if(E.component){const O=w.getOrCreateContext(E.outlet);if(this.routeReuseStrategy.shouldAttach(E.snapshot)){const V=this.routeReuseStrategy.retrieve(E.snapshot);this.routeReuseStrategy.store(E.snapshot,null),O.children.onOutletReAttached(V.contexts),O.attachRef=V.componentRef,O.route=V.route.value,O.outlet&&O.outlet.attach(V.componentRef,V.route.value),Qs(V.route.value),this.activateChildRoutes(p,null,O.children)}else{const V=Go(E.snapshot),Q=V?.get(d._Vd)??null;O.attachRef=null,O.route=E,O.resolver=Q,O.injector=V,O.outlet&&O.outlet.activateWith(E,O.injector),this.activateChildRoutes(p,null,O.children)}}else this.activateChildRoutes(p,null,w)}}class Y{constructor(p){this.path=p,this.route=this.path[this.path.length-1]}}class W{constructor(p,f){this.component=p,this.route=f}}function Te(u,p,f){const w=u._root;return pr(w,p?p._root:null,f,[w.value])}function fi(u,p){const f=Symbol(),w=p.get(u,f);return w===f?"function"!=typeof u||(0,d.Z0I)(u)?p.get(u):u:w}function pr(u,p,f,w,E={canDeactivateChecks:[],canActivateChecks:[]}){const P=To(p);return u.children.forEach(O=>{(function cr(u,p,f,w,E={canDeactivateChecks:[],canActivateChecks:[]}){const P=u.value,O=p?p.value:null,V=f?f.getContext(u.value.outlet):null;if(O&&P.routeConfig===O.routeConfig){const Q=function Ps(u,p,f){if("function"==typeof f)return f(u,p);switch(f){case"pathParamsChange":return!Rt(u.url,p.url);case"pathParamsOrQueryParamsChange":return!Rt(u.url,p.url)||!Ni(u.queryParams,p.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!fs(u,p)||!Ni(u.queryParams,p.queryParams);default:return!fs(u,p)}}(O,P,P.routeConfig.runGuardsAndResolvers);Q?E.canActivateChecks.push(new Y(w)):(P.data=O.data,P._resolvedData=O._resolvedData),pr(u,p,P.component?V?V.children:null:f,w,E),Q&&V&&V.outlet&&V.outlet.isActivated&&E.canDeactivateChecks.push(new W(V.outlet.component,O))}else O&&Fo(p,V,E),E.canActivateChecks.push(new Y(w)),pr(u,null,P.component?V?V.children:null:f,w,E)})(O,P[O.value.outlet],f,w.concat([O.value]),E),delete P[O.value.outlet]}),ie(P,(O,V)=>Fo(O,f.getContext(V),E)),E}function Fo(u,p,f){const w=To(u),E=u.value;ie(w,(P,O)=>{Fo(P,E.component?p?p.children.getContext(O):null:p,f)}),f.canDeactivateChecks.push(new W(E.component&&p&&p.outlet&&p.outlet.isActivated?p.outlet.component:null,E))}function Za(u){return"function"==typeof u}function Qo(u){return u instanceof oe||"EmptyError"===u?.name}const Hs=Symbol("INITIAL_VALUE");function es(){return(0,Ee.w)(u=>ce(u.map(p=>p.pipe((0,_t.q)(1),function It(...u){const p=(0,K.yG)(u);return(0,we.e)((f,w)=>{(p?(0,ne.z)(u,f,p):(0,ne.z)(u,f)).subscribe(w)})}(Hs)))).pipe((0,se.U)(p=>{for(const f of p)if(!0!==f){if(f===Hs)return Hs;if(!1===f||f instanceof gr)return f}return!0}),(0,Gt.h)(p=>p!==Hs),(0,_t.q)(1)))}function Cn(u){return(0,Pt.z)(Ce(p=>{if(Er(p))throw Mo(0,p)}),(0,se.U)(p=>!0===p))}const Ci={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function ii(u,p,f,w,E){const P=Gi(u,p,f);return P.matched?function Vn(u,p,f,w){const E=p.canMatch;if(!E||0===E.length)return(0,re.of)(!0);const P=E.map(O=>{const V=fi(O,u);return Qe(function so(u){return u&&Za(u.canMatch)}(V)?V.canMatch(p,f):u.runInContext(()=>V(p,f)))});return(0,re.of)(P).pipe(es(),Cn())}(w=co(p,w),p,f).pipe((0,se.U)(O=>!0===O?P:{...Ci})):(0,re.of)(P)}function Gi(u,p,f){if(""===p.path)return"full"===p.pathMatch&&(u.hasChildren()||f.length>0)?{...Ci}:{matched:!0,consumedSegments:[],remainingSegments:f,parameters:{},positionalParamSegments:{}};const E=(p.matcher||Bi)(f,u,p);if(!E)return{...Ci};const P={};ie(E.posParams,(V,Q)=>{P[Q]=V.path});const O=E.consumed.length>0?{...P,...E.consumed[E.consumed.length-1].parameters}:P;return{matched:!0,consumedSegments:E.consumed,remainingSegments:f.slice(E.consumed.length),parameters:O,positionalParamSegments:E.posParams??{}}}function ir(u,p,f,w){if(f.length>0&&function yo(u,p,f){return f.some(w=>ts(u,p,w)&&Mr(w)!==Un)}(u,f,w)){const P=new ui(p,function _o(u,p,f,w){const E={};E[Un]=w,w._sourceSegment=u,w._segmentIndexShift=p.length;for(const P of f)if(""===P.path&&Mr(P)!==Un){const O=new ui([],{});O._sourceSegment=u,O._segmentIndexShift=p.length,E[Mr(P)]=O}return E}(u,p,w,new ui(f,u.children)));return P._sourceSegment=u,P._segmentIndexShift=p.length,{segmentGroup:P,slicedSegments:[]}}if(0===f.length&&function Os(u,p,f){return f.some(w=>ts(u,p,w))}(u,f,w)){const P=new ui(u.segments,function sr(u,p,f,w,E){const P={};for(const O of w)if(ts(u,f,O)&&!E[Mr(O)]){const V=new ui([],{});V._sourceSegment=u,V._segmentIndexShift=p.length,P[Mr(O)]=V}return{...E,...P}}(u,p,f,w,u.children));return P._sourceSegment=u,P._segmentIndexShift=p.length,{segmentGroup:P,slicedSegments:f}}const E=new ui(u.segments,u.children);return E._sourceSegment=u,E._segmentIndexShift=p.length,{segmentGroup:E,slicedSegments:f}}function ts(u,p,f){return(!(u.hasChildren()||p.length>0)||"full"!==f.pathMatch)&&""===f.path}function ql(u,p,f,w){return!!(Mr(u)===w||w!==Un&&ts(p,f,u))&&("**"===u.path||Gi(p,u,f).matched)}function El(u,p,f){return 0===p.length&&!u.children[f]}const Pa=!1;class vs{constructor(p){this.segmentGroup=p||null}}class Ha{constructor(p){this.urlTree=p}}function ga(u){return ge(new vs(u))}function ao(u){return ge(new Ha(u))}class er{constructor(p,f,w,E,P){this.injector=p,this.configLoader=f,this.urlSerializer=w,this.urlTree=E,this.config=P,this.allowRedirects=!0}apply(){const p=ir(this.urlTree.root,[],[],this.config).segmentGroup,f=new ui(p.segments,p.children);return this.expandSegmentGroup(this.injector,this.config,f,Un).pipe((0,se.U)(P=>this.createUrlTree(Oi(P),this.urlTree.queryParams,this.urlTree.fragment))).pipe(kt(P=>{if(P instanceof Ha)return this.allowRedirects=!1,this.match(P.urlTree);throw P instanceof vs?this.noMatchError(P):P}))}match(p){return this.expandSegmentGroup(this.injector,this.config,p.root,Un).pipe((0,se.U)(E=>this.createUrlTree(Oi(E),p.queryParams,p.fragment))).pipe(kt(E=>{throw E instanceof vs?this.noMatchError(E):E}))}noMatchError(p){return new d.vHH(4002,Pa)}createUrlTree(p,f,w){const E=ei(p);return new gr(E,f,w)}expandSegmentGroup(p,f,w,E){return 0===w.segments.length&&w.hasChildren()?this.expandChildren(p,f,w).pipe((0,se.U)(P=>new ui([],P))):this.expandSegment(p,w,f,w.segments,E,!0)}expandChildren(p,f,w){const E=[];for(const P of Object.keys(w.children))"primary"===P?E.unshift(P):E.push(P);return(0,v.D)(E).pipe((0,lt.b)(P=>{const O=w.children[P],V=ma(f,P);return this.expandSegmentGroup(p,V,O,P).pipe((0,se.U)(Q=>({segment:Q,outlet:P})))}),bn((P,O)=>(P[O.outlet]=O.segment,P),{}),un())}expandSegment(p,f,w,E,P,O){return(0,v.D)(w).pipe((0,lt.b)(V=>this.expandSegmentAgainstRoute(p,f,w,V,E,P,O).pipe(kt(ye=>{if(ye instanceof vs)return(0,re.of)(null);throw ye}))),rt(V=>!!V),kt((V,Q)=>{if(Qo(V))return El(f,E,P)?(0,re.of)(new ui([],{})):ga(f);throw V}))}expandSegmentAgainstRoute(p,f,w,E,P,O,V){return ql(E,f,P,O)?void 0===E.redirectTo?this.matchSegmentAgainstRoute(p,f,E,P,O):V&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(p,f,w,E,P,O):ga(f):ga(f)}expandSegmentAgainstRouteUsingRedirect(p,f,w,E,P,O){return"**"===E.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(p,w,E,O):this.expandRegularSegmentAgainstRouteUsingRedirect(p,f,w,E,P,O)}expandWildCardWithParamsAgainstRouteUsingRedirect(p,f,w,E){const P=this.applyRedirectCommands([],w.redirectTo,{});return w.redirectTo.startsWith("/")?ao(P):this.lineralizeSegments(w,P).pipe((0,Lt.z)(O=>{const V=new ui(O,{});return this.expandSegment(p,V,f,O,E,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(p,f,w,E,P,O){const{matched:V,consumedSegments:Q,remainingSegments:ye,positionalParamSegments:be}=Gi(f,E,P);if(!V)return ga(f);const Oe=this.applyRedirectCommands(Q,E.redirectTo,be);return E.redirectTo.startsWith("/")?ao(Oe):this.lineralizeSegments(E,Oe).pipe((0,Lt.z)(Ne=>this.expandSegment(p,f,w,Ne.concat(ye),O,!1)))}matchSegmentAgainstRoute(p,f,w,E,P){return"**"===w.path?(p=co(w,p),w.loadChildren?(w._loadedRoutes?(0,re.of)({routes:w._loadedRoutes,injector:w._loadedInjector}):this.configLoader.loadChildren(p,w)).pipe((0,se.U)(V=>(w._loadedRoutes=V.routes,w._loadedInjector=V.injector,new ui(E,{})))):(0,re.of)(new ui(E,{}))):ii(f,w,E,p).pipe((0,Ee.w)(({matched:O,consumedSegments:V,remainingSegments:Q})=>O?this.getChildConfig(p=w._injector??p,w,E).pipe((0,Lt.z)(be=>{const Oe=be.injector??p,Ne=be.routes,{segmentGroup:ve,slicedSegments:tt}=ir(f,V,Q,Ne),qe=new ui(ve.segments,ve.children);if(0===tt.length&&qe.hasChildren())return this.expandChildren(Oe,Ne,qe).pipe((0,se.U)(At=>new ui(V,At)));if(0===Ne.length&&0===tt.length)return(0,re.of)(new ui(V,{}));const nt=Mr(w)===P;return this.expandSegment(Oe,qe,Ne,tt,nt?Un:P,!0).pipe((0,se.U)(ft=>new ui(V.concat(ft.segments),ft.children)))})):ga(f)))}getChildConfig(p,f,w){return f.children?(0,re.of)({routes:f.children,injector:p}):f.loadChildren?void 0!==f._loadedRoutes?(0,re.of)({routes:f._loadedRoutes,injector:f._loadedInjector}):function Et(u,p,f,w){const E=p.canLoad;if(void 0===E||0===E.length)return(0,re.of)(!0);const P=E.map(O=>{const V=fi(O,u);return Qe(function Rn(u){return u&&Za(u.canLoad)}(V)?V.canLoad(p,f):u.runInContext(()=>V(p,f)))});return(0,re.of)(P).pipe(es(),Cn())}(p,f,w).pipe((0,Lt.z)(E=>E?this.configLoader.loadChildren(p,f).pipe(Ce(P=>{f._loadedRoutes=P.routes,f._loadedInjector=P.injector})):function wr(u){return ge($s(Pa,3))}())):(0,re.of)({routes:[],injector:p})}lineralizeSegments(p,f){let w=[],E=f.root;for(;;){if(w=w.concat(E.segments),0===E.numberOfChildren)return(0,re.of)(w);if(E.numberOfChildren>1||!E.children[Un])return p.redirectTo,ge(new d.vHH(4e3,Pa));E=E.children[Un]}}applyRedirectCommands(p,f,w){return this.applyRedirectCreateUrlTree(f,this.urlSerializer.parse(f),p,w)}applyRedirectCreateUrlTree(p,f,w,E){const P=this.createSegmentGroup(p,f.root,w,E);return new gr(P,this.createQueryParams(f.queryParams,this.urlTree.queryParams),f.fragment)}createQueryParams(p,f){const w={};return ie(p,(E,P)=>{if("string"==typeof E&&E.startsWith(":")){const V=E.substring(1);w[P]=f[V]}else w[P]=E}),w}createSegmentGroup(p,f,w,E){const P=this.createSegments(p,f.segments,w,E);let O={};return ie(f.children,(V,Q)=>{O[Q]=this.createSegmentGroup(p,V,w,E)}),new ui(P,O)}createSegments(p,f,w,E){return f.map(P=>P.path.startsWith(":")?this.findPosParam(p,P,E):this.findOrReturn(P,w))}findPosParam(p,f,w){const E=w[f.path.substring(1)];if(!E)throw new d.vHH(4001,Pa);return E}findOrReturn(p,f){let w=0;for(const E of f){if(E.path===p.path)return f.splice(w),E;w++}return p}}class U{}class Se{constructor(p,f,w,E,P,O,V){this.injector=p,this.rootComponentType=f,this.config=w,this.urlTree=E,this.url=P,this.paramsInheritanceStrategy=O,this.urlSerializer=V}recognize(){const p=ir(this.urlTree.root,[],[],this.config.filter(f=>void 0===f.redirectTo)).segmentGroup;return this.processSegmentGroup(this.injector,this.config,p,Un).pipe((0,se.U)(f=>{if(null===f)return null;const w=new go([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},Un,this.rootComponentType,null,this.urlTree.root,-1,{}),E=new Co(w,f),P=new Ss(this.url,E);return this.inheritParamsAndData(P._root),P}))}inheritParamsAndData(p){const f=p.value,w=Is(f,this.paramsInheritanceStrategy);f.params=Object.freeze(w.params),f.data=Object.freeze(w.data),p.children.forEach(E=>this.inheritParamsAndData(E))}processSegmentGroup(p,f,w,E){return 0===w.segments.length&&w.hasChildren()?this.processChildren(p,f,w):this.processSegment(p,f,w,w.segments,E)}processChildren(p,f,w){return(0,v.D)(Object.keys(w.children)).pipe((0,lt.b)(E=>{const P=w.children[E],O=ma(f,E);return this.processSegmentGroup(p,O,P,E)}),bn((E,P)=>E&&P?(E.push(...P),E):null),function ot(u,p=!1){return(0,we.e)((f,w)=>{let E=0;f.subscribe((0,pe.x)(w,P=>{const O=u(P,E++);(O||p)&&w.next(P),!O&&w.complete()}))})}(E=>null!==E),yt(null),un(),(0,se.U)(E=>{if(null===E)return null;const P=ai(E);return function ht(u){u.sort((p,f)=>p.value.outlet===Un?-1:f.value.outlet===Un?1:p.value.outlet.localeCompare(f.value.outlet))}(P),P}))}processSegment(p,f,w,E,P){return(0,v.D)(f).pipe((0,lt.b)(O=>this.processSegmentAgainstRoute(O._injector??p,O,w,E,P)),rt(O=>!!O),kt(O=>{if(Qo(O))return El(w,E,P)?(0,re.of)([]):(0,re.of)(null);throw O}))}processSegmentAgainstRoute(p,f,w,E,P){if(f.redirectTo||!ql(f,w,E,P))return(0,re.of)(null);let O;if("**"===f.path){const V=E.length>0?Mt(E).parameters:{},Q=or(w)+E.length,ye=new go(E,V,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Br(f),Mr(f),f.component??f._loadedComponent??null,f,tr(w),Q,Cr(f));O=(0,re.of)({snapshot:ye,consumedSegments:[],remainingSegments:[]})}else O=ii(w,f,E,p).pipe((0,se.U)(({matched:V,consumedSegments:Q,remainingSegments:ye,parameters:be})=>{if(!V)return null;const Oe=or(w)+Q.length;return{snapshot:new go(Q,be,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,Br(f),Mr(f),f.component??f._loadedComponent??null,f,tr(w),Oe,Cr(f)),consumedSegments:Q,remainingSegments:ye}}));return O.pipe((0,Ee.w)(V=>{if(null===V)return(0,re.of)(null);const{snapshot:Q,consumedSegments:ye,remainingSegments:be}=V;p=f._injector??p;const Oe=f._loadedInjector??p,Ne=function hn(u){return u.children?u.children:u.loadChildren?u._loadedRoutes:[]}(f),{segmentGroup:ve,slicedSegments:tt}=ir(w,ye,be,Ne.filter(nt=>void 0===nt.redirectTo));if(0===tt.length&&ve.hasChildren())return this.processChildren(Oe,Ne,ve).pipe((0,se.U)(nt=>null===nt?null:[new Co(Q,nt)]));if(0===Ne.length&&0===tt.length)return(0,re.of)([new Co(Q,[])]);const qe=Mr(f)===P;return this.processSegment(Oe,Ne,ve,tt,qe?Un:P).pipe((0,se.U)(nt=>null===nt?null:[new Co(Q,nt)]))}))}}function Dn(u){const p=u.value.routeConfig;return p&&""===p.path&&void 0===p.redirectTo}function ai(u){const p=[],f=new Set;for(const w of u){if(!Dn(w)){p.push(w);continue}const E=p.find(P=>w.value.routeConfig===P.value.routeConfig);void 0!==E?(E.children.push(...w.children),f.add(E)):p.push(w)}for(const w of f){const E=ai(w.children);p.push(new Co(w.value,E))}return p.filter(w=>!f.has(w))}function tr(u){let p=u;for(;p._sourceSegment;)p=p._sourceSegment;return p}function or(u){let p=u,f=p._segmentIndexShift??0;for(;p._sourceSegment;)p=p._sourceSegment,f+=p._segmentIndexShift??0;return f-1}function Br(u){return u.data||{}}function Cr(u){return u.resolve||{}}function Wa(u){return"string"==typeof u.title||null===u.title}function Ls(u){return(0,Ee.w)(p=>{const f=u(p);return f?(0,v.D)(f).pipe((0,se.U)(()=>p)):(0,re.of)(p)})}const Fs=new d.OlP("ROUTES");let al=(()=>{class u{constructor(f,w){this.injector=f,this.compiler=w,this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap}loadComponent(f){if(this.componentLoaders.get(f))return this.componentLoaders.get(f);if(f._loadedComponent)return(0,re.of)(f._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(f);const w=Qe(f.loadComponent()).pipe((0,se.U)(ll),Ce(P=>{this.onLoadEndListener&&this.onLoadEndListener(f),f._loadedComponent=P}),Sn(()=>{this.componentLoaders.delete(f)})),E=new He(w,()=>new me.x).pipe(Xe());return this.componentLoaders.set(f,E),E}loadChildren(f,w){if(this.childrenLoaders.get(w))return this.childrenLoaders.get(w);if(w._loadedRoutes)return(0,re.of)({routes:w._loadedRoutes,injector:w._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(w);const P=this.loadModuleFactoryOrRoutes(w.loadChildren).pipe((0,se.U)(V=>{this.onLoadEndListener&&this.onLoadEndListener(w);let Q,ye,be=!1;Array.isArray(V)?ye=V:(Q=V.create(f).injector,ye=Vt(Q.get(Fs,[],d.XFs.Self|d.XFs.Optional)));return{routes:ye.map(ys),injector:Q}}),Sn(()=>{this.childrenLoaders.delete(w)})),O=new He(P,()=>new me.x).pipe(Xe());return this.childrenLoaders.set(w,O),O}loadModuleFactoryOrRoutes(f){return Qe(f()).pipe((0,se.U)(ll),(0,Lt.z)(E=>E instanceof d.YKP||Array.isArray(E)?(0,re.of)(E):(0,v.D)(this.compiler.compileModuleAsync(E))))}}return u.\u0275fac=function(f){return new(f||u)(d.LFG(d.zs3),d.LFG(d.Sil))},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();function ll(u){return function uo(u){return u&&"object"==typeof u&&"default"in u}(u)?u.default:u}let Dc=(()=>{class u{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.lastSuccessfulNavigation=null,this.events=new me.x,this.configLoader=(0,d.f3M)(al),this.environmentInjector=(0,d.f3M)(d.lqb),this.urlSerializer=(0,d.f3M)(Ue),this.rootContexts=(0,d.f3M)(Vo),this.navigationId=0,this.afterPreactivation=()=>(0,re.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=E=>this.events.next(new ro(E)),this.configLoader.onLoadStartListener=E=>this.events.next(new io(E))}complete(){this.transitions?.complete()}handleNavigationRequest(f){const w=++this.navigationId;this.transitions?.next({...this.transitions.value,...f,id:w})}setupNavigations(f){return this.transitions=new a.X({id:0,targetPageId:0,currentUrlTree:f.currentUrlTree,currentRawUrl:f.currentUrlTree,extractedUrl:f.urlHandlingStrategy.extract(f.currentUrlTree),urlAfterRedirects:f.urlHandlingStrategy.extract(f.currentUrlTree),rawUrl:f.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Gn,restoredState:null,currentSnapshot:f.routerState.snapshot,targetSnapshot:null,currentRouterState:f.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,Gt.h)(w=>0!==w.id),(0,se.U)(w=>({...w,extractedUrl:f.urlHandlingStrategy.extract(w.rawUrl)})),(0,Ee.w)(w=>{let E=!1,P=!1;return(0,re.of)(w).pipe(Ce(O=>{this.currentNavigation={id:O.id,initialUrl:O.rawUrl,extractedUrl:O.extractedUrl,trigger:O.source,extras:O.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,Ee.w)(O=>{const V=f.browserUrlTree.toString(),Q=!f.navigated||O.extractedUrl.toString()!==V||V!==f.currentUrlTree.toString();if(!Q&&"reload"!==(O.extras.onSameUrlNavigation??f.onSameUrlNavigation)){const be="";return this.events.next(new Ir(O.id,f.serializeUrl(w.rawUrl),be,0)),f.rawUrlTree=O.rawUrl,O.resolve(null),ke.E}if(f.urlHandlingStrategy.shouldProcessUrl(O.rawUrl))return Il(O.source)&&(f.browserUrlTree=O.extractedUrl),(0,re.of)(O).pipe((0,Ee.w)(be=>{const Oe=this.transitions?.getValue();return this.events.next(new Ai(be.id,this.urlSerializer.serialize(be.extractedUrl),be.source,be.restoredState)),Oe!==this.transitions?.getValue()?ke.E:Promise.resolve(be)}),function Jl(u,p,f,w){return(0,Ee.w)(E=>function Yl(u,p,f,w,E){return new er(u,p,f,w,E).apply()}(u,p,f,E.extractedUrl,w).pipe((0,se.U)(P=>({...E,urlAfterRedirects:P}))))}(this.environmentInjector,this.configLoader,this.urlSerializer,f.config),Ce(be=>{this.currentNavigation={...this.currentNavigation,finalUrl:be.urlAfterRedirects},w.urlAfterRedirects=be.urlAfterRedirects}),function zn(u,p,f,w,E){return(0,Lt.z)(P=>function H(u,p,f,w,E,P,O="emptyOnly"){return new Se(u,p,f,w,E,O,P).recognize().pipe((0,Ee.w)(V=>null===V?function le(u){return new b.y(p=>p.error(u))}(new U):(0,re.of)(V)))}(u,p,f,P.urlAfterRedirects,w.serialize(P.urlAfterRedirects),w,E).pipe((0,se.U)(O=>({...P,targetSnapshot:O}))))}(this.environmentInjector,this.rootComponentType,f.config,this.urlSerializer,f.paramsInheritanceStrategy),Ce(be=>{if(w.targetSnapshot=be.targetSnapshot,"eager"===f.urlUpdateStrategy){if(!be.extras.skipLocationChange){const Ne=f.urlHandlingStrategy.merge(be.urlAfterRedirects,be.rawUrl);f.setBrowserUrl(Ne,be)}f.browserUrlTree=be.urlAfterRedirects}const Oe=new Hr(be.id,this.urlSerializer.serialize(be.extractedUrl),this.urlSerializer.serialize(be.urlAfterRedirects),be.targetSnapshot);this.events.next(Oe)}));if(Q&&f.urlHandlingStrategy.shouldProcessUrl(f.rawUrlTree)){const{id:be,extractedUrl:Oe,source:Ne,restoredState:ve,extras:tt}=O,qe=new Ai(be,this.urlSerializer.serialize(Oe),Ne,ve);this.events.next(qe);const nt=zo(Oe,this.rootComponentType).snapshot;return w={...O,targetSnapshot:nt,urlAfterRedirects:Oe,extras:{...tt,skipLocationChange:!1,replaceUrl:!1}},(0,re.of)(w)}{const be="";return this.events.next(new Ir(O.id,f.serializeUrl(w.extractedUrl),be,1)),f.rawUrlTree=O.rawUrl,O.resolve(null),ke.E}}),Ce(O=>{const V=new zr(O.id,this.urlSerializer.serialize(O.extractedUrl),this.urlSerializer.serialize(O.urlAfterRedirects),O.targetSnapshot);this.events.next(V)}),(0,se.U)(O=>w={...O,guards:Te(O.targetSnapshot,O.currentSnapshot,this.rootContexts)}),function Ws(u,p){return(0,Lt.z)(f=>{const{targetSnapshot:w,currentSnapshot:E,guards:{canActivateChecks:P,canDeactivateChecks:O}}=f;return 0===O.length&&0===P.length?(0,re.of)({...f,guardsResult:!0}):function Qc(u,p,f,w){return(0,v.D)(u).pipe((0,Lt.z)(E=>function _e(u,p,f,w,E){const P=p&&p.routeConfig?p.routeConfig.canDeactivate:null;if(!P||0===P.length)return(0,re.of)(!0);const O=P.map(V=>{const Q=Go(p)??E,ye=fi(V,Q);return Qe(function Tl(u){return u&&Za(u.canDeactivate)}(ye)?ye.canDeactivate(u,p,f,w):Q.runInContext(()=>ye(u,p,f,w))).pipe(rt())});return(0,re.of)(O).pipe(es())}(E.component,E.route,f,p,w)),rt(E=>!0!==E,!0))}(O,w,E,u).pipe((0,Lt.z)(V=>V&&function ol(u){return"boolean"==typeof u}(V)?function sl(u,p,f,w){return(0,v.D)(p).pipe((0,lt.b)(E=>(0,ne.z)(function G(u,p){return null!==u&&p&&p(new Ds(u)),(0,re.of)(!0)}(E.route.parent,w),function M(u,p){return null!==u&&p&&p(new br(u)),(0,re.of)(!0)}(E.route,w),function j(u,p,f){const w=p[p.length-1],P=p.slice(0,p.length-1).reverse().map(O=>function fn(u){const p=u.routeConfig?u.routeConfig.canActivateChild:null;return p&&0!==p.length?{node:u,guards:p}:null}(O)).filter(O=>null!==O).map(O=>(0,Je.P)(()=>{const V=O.guards.map(Q=>{const ye=Go(O.node)??f,be=fi(Q,ye);return Qe(function Ga(u){return u&&Za(u.canActivateChild)}(be)?be.canActivateChild(w,u):ye.runInContext(()=>be(w,u))).pipe(rt())});return(0,re.of)(V).pipe(es())}));return(0,re.of)(P).pipe(es())}(u,E.path,f),function S(u,p,f){const w=p.routeConfig?p.routeConfig.canActivate:null;if(!w||0===w.length)return(0,re.of)(!0);const E=w.map(P=>(0,Je.P)(()=>{const O=Go(p)??f,V=fi(P,O);return Qe(function ki(u){return u&&Za(u.canActivate)}(V)?V.canActivate(p,u):O.runInContext(()=>V(p,u))).pipe(rt())}));return(0,re.of)(E).pipe(es())}(u,E.route,f))),rt(E=>!0!==E,!0))}(w,P,u,p):(0,re.of)(V)),(0,se.U)(V=>({...f,guardsResult:V})))})}(this.environmentInjector,O=>this.events.next(O)),Ce(O=>{if(w.guardsResult=O.guardsResult,Er(O.guardsResult))throw Mo(0,O.guardsResult);const V=new hr(O.id,this.urlSerializer.serialize(O.extractedUrl),this.urlSerializer.serialize(O.urlAfterRedirects),O.targetSnapshot,!!O.guardsResult);this.events.next(V)}),(0,Gt.h)(O=>!!O.guardsResult||(f.restoreHistory(O),this.cancelNavigationTransition(O,"",3),!1)),Ls(O=>{if(O.guards.canActivateChecks.length)return(0,re.of)(O).pipe(Ce(V=>{const Q=new lr(V.id,this.urlSerializer.serialize(V.extractedUrl),this.urlSerializer.serialize(V.urlAfterRedirects),V.targetSnapshot);this.events.next(Q)}),(0,Ee.w)(V=>{let Q=!1;return(0,re.of)(V).pipe(function vo(u,p){return(0,Lt.z)(f=>{const{targetSnapshot:w,guards:{canActivateChecks:E}}=f;if(!E.length)return(0,re.of)(f);let P=0;return(0,v.D)(E).pipe((0,lt.b)(O=>function qs(u,p,f,w){const E=u.routeConfig,P=u._resolve;return void 0!==E?.title&&!Wa(E)&&(P[hi]=E.title),function _a(u,p,f,w){const E=function Ho(u){return[...Object.keys(u),...Object.getOwnPropertySymbols(u)]}(u);if(0===E.length)return(0,re.of)({});const P={};return(0,v.D)(E).pipe((0,Lt.z)(O=>function Ys(u,p,f,w){const E=Go(p)??w,P=fi(u,E);return Qe(P.resolve?P.resolve(p,f):E.runInContext(()=>P(p,f)))}(u[O],p,f,w).pipe(rt(),Ce(V=>{P[O]=V}))),Nn(1),function Bt(u){return(0,se.U)(()=>u)}(P),kt(O=>Qo(O)?ke.E:ge(O)))}(P,u,p,w).pipe((0,se.U)(O=>(u._resolvedData=O,u.data=Is(u,f).resolve,E&&Wa(E)&&(u.data[hi]=E.title),null)))}(O.route,w,u,p)),Ce(()=>P++),Nn(1),(0,Lt.z)(O=>P===E.length?(0,re.of)(f):ke.E))})}(f.paramsInheritanceStrategy,this.environmentInjector),Ce({next:()=>Q=!0,complete:()=>{Q||(f.restoreHistory(V),this.cancelNavigationTransition(V,"",2))}}))}),Ce(V=>{const Q=new la(V.id,this.urlSerializer.serialize(V.extractedUrl),this.urlSerializer.serialize(V.urlAfterRedirects),V.targetSnapshot);this.events.next(Q)}))}),Ls(O=>{const V=Q=>{const ye=[];Q.routeConfig?.loadComponent&&!Q.routeConfig._loadedComponent&&ye.push(this.configLoader.loadComponent(Q.routeConfig).pipe(Ce(be=>{Q.component=be}),(0,se.U)(()=>{})));for(const be of Q.children)ye.push(...V(be));return ye};return ce(V(O.targetSnapshot.root)).pipe(yt(),(0,_t.q)(1))}),Ls(()=>this.afterPreactivation()),(0,se.U)(O=>{const V=function Ma(u,p,f){const w=Uo(u,p._root,f?f._root:void 0);return new Ia(w,p)}(f.routeReuseStrategy,O.targetSnapshot,O.currentRouterState);return w={...O,targetRouterState:V}}),Ce(O=>{f.currentUrlTree=O.urlAfterRedirects,f.rawUrlTree=f.urlHandlingStrategy.merge(O.urlAfterRedirects,O.rawUrl),f.routerState=O.targetRouterState,"deferred"===f.urlUpdateStrategy&&(O.extras.skipLocationChange||f.setBrowserUrl(f.rawUrlTree,O),f.browserUrlTree=O.urlAfterRedirects)}),((u,p,f)=>(0,se.U)(w=>(new te(p,w.targetRouterState,w.currentRouterState,f).activate(u),w)))(this.rootContexts,f.routeReuseStrategy,O=>this.events.next(O)),Ce({next:O=>{E=!0,this.lastSuccessfulNavigation=this.currentNavigation,f.navigated=!0,this.events.next(new Fi(O.id,this.urlSerializer.serialize(O.extractedUrl),this.urlSerializer.serialize(f.currentUrlTree))),f.titleStrategy?.updateTitle(O.targetRouterState.snapshot),O.resolve(!0)},complete:()=>{E=!0}}),Sn(()=>{E||P||this.cancelNavigationTransition(w,"",1),this.currentNavigation?.id===w.id&&(this.currentNavigation=null)}),kt(O=>{if(P=!0,ji(O)){Lo(O)||(f.navigated=!0,f.restoreHistory(w,!0));const V=new Vi(w.id,this.urlSerializer.serialize(w.extractedUrl),O.message,O.cancellationCode);if(this.events.next(V),Lo(O)){const Q=f.urlHandlingStrategy.merge(O.url,f.rawUrlTree),ye={skipLocationChange:w.extras.skipLocationChange,replaceUrl:"eager"===f.urlUpdateStrategy||Il(w.source)};f.scheduleNavigation(Q,Gn,null,ye,{resolve:w.resolve,reject:w.reject,promise:w.promise})}else w.resolve(!1)}else{f.restoreHistory(w,!0);const V=new Qi(w.id,this.urlSerializer.serialize(w.extractedUrl),O,w.targetSnapshot??void 0);this.events.next(V);try{w.resolve(f.errorHandler(O))}catch(Q){w.reject(Q)}}return ke.E}))}))}cancelNavigationTransition(f,w,E){const P=new Vi(f.id,this.urlSerializer.serialize(f.extractedUrl),w,E);this.events.next(P),f.resolve(!1)}}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();function Il(u){return u!==Gn}let Xl=(()=>{class u{buildTitle(f){let w,E=f.root;for(;void 0!==E;)w=this.getResolvedTitleForRoute(E)??w,E=E.children.find(P=>P.outlet===Un);return w}getResolvedTitleForRoute(f){return f.data[hi]}}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:function(){return(0,d.f3M)(Ic)},providedIn:"root"}),u})(),Ic=(()=>{class u extends Xl{constructor(f){super(),this.title=f}updateTitle(f){const w=this.buildTitle(f);void 0!==w&&this.title.setTitle(w)}}return u.\u0275fac=function(f){return new(f||u)(d.LFG(ci.Dx))},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})(),Js=(()=>{class u{}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:function(){return(0,d.f3M)(Sl)},providedIn:"root"}),u})();class Ml{shouldDetach(p){return!1}store(p,f){}shouldAttach(p){return!1}retrieve(p){return null}shouldReuseRoute(p,f){return p.routeConfig===f.routeConfig}}let Sl=(()=>{class u extends Ml{}return u.\u0275fac=function(){let p;return function(w){return(p||(p=d.n5z(u)))(w||u)}}(),u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const qa=new d.OlP("",{providedIn:"root",factory:()=>({})});let Sc=(()=>{class u{}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:function(){return(0,d.f3M)(Kl)},providedIn:"root"}),u})(),Kl=(()=>{class u{shouldProcessUrl(f){return!0}extract(f){return f}merge(f,w){return f}}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();function ul(u){throw u}function ec(u,p,f){return p.parse("/")}const Al={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},tu={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let ns=(()=>{class u{get navigationId(){return this.navigationTransitions.navigationId}get browserPageId(){return this.location.getState()?.\u0275routerPageId}get events(){return this.navigationTransitions.events}constructor(){this.disposed=!1,this.currentPageId=0,this.console=(0,d.f3M)(d.c2e),this.isNgZoneEnabled=!1,this.options=(0,d.f3M)(qa,{optional:!0})||{},this.errorHandler=this.options.errorHandler||ul,this.malformedUriErrorHandler=this.options.malformedUriErrorHandler||ec,this.navigated=!1,this.lastSuccessfulId=-1,this.urlHandlingStrategy=(0,d.f3M)(Sc),this.routeReuseStrategy=(0,d.f3M)(Js),this.urlCreationStrategy=(0,d.f3M)(lo),this.titleStrategy=(0,d.f3M)(Xl),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.config=Vt((0,d.f3M)(Fs,{optional:!0})??[]),this.navigationTransitions=(0,d.f3M)(Dc),this.urlSerializer=(0,d.f3M)(Ue),this.location=(0,d.f3M)(de.Ye),this.isNgZoneEnabled=(0,d.f3M)(d.R0b)instanceof d.R0b&&d.R0b.isInAngularZone(),this.resetConfig(this.config),this.currentUrlTree=new gr,this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.routerState=zo(this.currentUrlTree,null),this.navigationTransitions.setupNavigations(this).subscribe(f=>{this.lastSuccessfulId=f.id,this.currentPageId=f.targetPageId},f=>{this.console.warn(`Unhandled Navigation Error: ${f}`)})}resetRootComponentType(f){this.routerState.root.component=f,this.navigationTransitions.rootComponentType=f}initialNavigation(){if(this.setUpLocationChangeListener(),!this.navigationTransitions.hasRequestedNavigation){const f=this.location.getState();this.navigateToSyncWithBrowser(this.location.path(!0),Gn,f)}}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(f=>{const w="popstate"===f.type?"popstate":"hashchange";"popstate"===w&&setTimeout(()=>{this.navigateToSyncWithBrowser(f.url,w,f.state)},0)}))}navigateToSyncWithBrowser(f,w,E){const P={replaceUrl:!0},O=E?.navigationId?E:null;if(E){const Q={...E};delete Q.navigationId,delete Q.\u0275routerPageId,0!==Object.keys(Q).length&&(P.state=Q)}const V=this.parseUrl(f);this.scheduleNavigation(V,w,O,P)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}resetConfig(f){this.config=f.map(ys),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(f,w={}){const{relativeTo:E,queryParams:P,fragment:O,queryParamsHandling:V,preserveFragment:Q}=w,ye=Q?this.currentUrlTree.fragment:O;let be=null;switch(V){case"merge":be={...this.currentUrlTree.queryParams,...P};break;case"preserve":be=this.currentUrlTree.queryParams;break;default:be=P||null}return null!==be&&(be=this.removeEmptyProps(be)),this.urlCreationStrategy.createUrlTree(E,this.routerState,this.currentUrlTree,f,be,ye??null)}navigateByUrl(f,w={skipLocationChange:!1}){const E=Er(f)?f:this.parseUrl(f),P=this.urlHandlingStrategy.merge(E,this.rawUrlTree);return this.scheduleNavigation(P,Gn,null,w)}navigate(f,w={skipLocationChange:!1}){return function Pl(u){for(let p=0;p<u.length;p++){const f=u[p];if(null==f)throw new d.vHH(4008,false)}}(f),this.navigateByUrl(this.createUrlTree(f,w),w)}serializeUrl(f){return this.urlSerializer.serialize(f)}parseUrl(f){let w;try{w=this.urlSerializer.parse(f)}catch(E){w=this.malformedUriErrorHandler(E,this.urlSerializer,f)}return w}isActive(f,w){let E;if(E=!0===w?{...Al}:!1===w?{...tu}:w,Er(f))return Di(this.currentUrlTree,f,E);const P=this.parseUrl(f);return Di(this.currentUrlTree,P,E)}removeEmptyProps(f){return Object.keys(f).reduce((w,E)=>{const P=f[E];return null!=P&&(w[E]=P),w},{})}scheduleNavigation(f,w,E,P,O){if(this.disposed)return Promise.resolve(!1);let V,Q,ye,be;return O?(V=O.resolve,Q=O.reject,ye=O.promise):ye=new Promise((Oe,Ne)=>{V=Oe,Q=Ne}),be="computed"===this.canceledNavigationResolution?E&&E.\u0275routerPageId?E.\u0275routerPageId:P.replaceUrl||P.skipLocationChange?this.browserPageId??0:(this.browserPageId??0)+1:0,this.navigationTransitions.handleNavigationRequest({targetPageId:be,source:w,restoredState:E,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:f,extras:P,resolve:V,reject:Q,promise:ye,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),ye.catch(Oe=>Promise.reject(Oe))}setBrowserUrl(f,w){const E=this.urlSerializer.serialize(f),P={...w.extras.state,...this.generateNgRouterState(w.id,w.targetPageId)};this.location.isCurrentPathEqualTo(E)||w.extras.replaceUrl?this.location.replaceState(E,"",P):this.location.go(E,"",P)}restoreHistory(f,w=!1){if("computed"===this.canceledNavigationResolution){const E=this.currentPageId-f.targetPageId;"popstate"!==f.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==this.getCurrentNavigation()?.finalUrl||0===E?this.currentUrlTree===this.getCurrentNavigation()?.finalUrl&&0===E&&(this.resetState(f),this.browserUrlTree=f.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(E)}else"replace"===this.canceledNavigationResolution&&(w&&this.resetState(f),this.resetUrlToCurrentUrlTree())}resetState(f){this.routerState=f.currentRouterState,this.currentUrlTree=f.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,f.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(f,w){return"computed"===this.canceledNavigationResolution?{navigationId:f,\u0275routerPageId:w}:{navigationId:f}}}return u.\u0275fac=function(f){return new(f||u)},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})(),ta=(()=>{class u{constructor(f,w,E,P,O,V){this.router=f,this.route=w,this.tabIndexAttribute=E,this.renderer=P,this.el=O,this.locationStrategy=V,this._preserveFragment=!1,this._skipLocationChange=!1,this._replaceUrl=!1,this.href=null,this.commands=null,this.onChanges=new me.x;const Q=O.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===Q||"area"===Q,this.isAnchorElement?this.subscription=f.events.subscribe(ye=>{ye instanceof Fi&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}set preserveFragment(f){this._preserveFragment=(0,d.D6c)(f)}get preserveFragment(){return this._preserveFragment}set skipLocationChange(f){this._skipLocationChange=(0,d.D6c)(f)}get skipLocationChange(){return this._skipLocationChange}set replaceUrl(f){this._replaceUrl=(0,d.D6c)(f)}get replaceUrl(){return this._replaceUrl}setTabIndexIfNotOnNativeEl(f){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",f)}ngOnChanges(f){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(f){null!=f?(this.commands=Array.isArray(f)?f:[f],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(f,w,E,P,O){return!!(null===this.urlTree||this.isAnchorElement&&(0!==f||w||E||P||O||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const f=null===this.href?null:(0,d.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",f)}applyAttributeValue(f,w){const E=this.renderer,P=this.el.nativeElement;null!==w?E.setAttribute(P,f,w):E.removeAttribute(P,f)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}}return u.\u0275fac=function(f){return new(f||u)(d.Y36(ns),d.Y36(mo),d.$8M("tabindex"),d.Y36(d.Qsj),d.Y36(d.SBq),d.Y36(de.S$))},u.\u0275dir=d.lG2({type:u,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(f,w){1&f&&d.NdJ("click",function(P){return w.onClick(P.button,P.ctrlKey,P.shiftKey,P.altKey,P.metaKey)}),2&f&&d.uIk("target",w.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",relativeTo:"relativeTo",preserveFragment:"preserveFragment",skipLocationChange:"skipLocationChange",replaceUrl:"replaceUrl",routerLink:"routerLink"},standalone:!0,features:[d.TTD]}),u})();class nu{}let iu=(()=>{class u{constructor(f,w,E,P,O){this.router=f,this.injector=E,this.preloadingStrategy=P,this.loader=O}setUpPreloading(){this.subscription=this.router.events.pipe((0,Gt.h)(f=>f instanceof Fi),(0,lt.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(f,w){const E=[];for(const P of w){P.providers&&!P._injector&&(P._injector=(0,d.MMx)(P.providers,f,`Route: ${P.path}`));const O=P._injector??f,V=P._loadedInjector??O;P.loadChildren&&!P._loadedRoutes&&void 0===P.canLoad||P.loadComponent&&!P._loadedComponent?E.push(this.preloadConfig(O,P)):(P.children||P._loadedRoutes)&&E.push(this.processRoutes(V,P.children??P._loadedRoutes))}return(0,v.D)(E).pipe((0,Qn.J)())}preloadConfig(f,w){return this.preloadingStrategy.preload(w,()=>{let E;E=w.loadChildren&&void 0===w.canLoad?this.loader.loadChildren(f,w):(0,re.of)(null);const P=E.pipe((0,Lt.z)(O=>null===O?(0,re.of)(void 0):(w._loadedRoutes=O.routes,w._loadedInjector=O.injector,this.processRoutes(O.injector??f,O.routes))));if(w.loadComponent&&!w._loadedComponent){const O=this.loader.loadComponent(w);return(0,v.D)([P,O]).pipe((0,Qn.J)())}return P})}}return u.\u0275fac=function(f){return new(f||u)(d.LFG(ns),d.LFG(d.Sil),d.LFG(d.lqb),d.LFG(nu),d.LFG(al))},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})();const ks=new d.OlP("");let ru=(()=>{class u{constructor(f,w,E,P,O={}){this.urlSerializer=f,this.transitions=w,this.viewportScroller=E,this.zone=P,this.options=O,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},O.scrollPositionRestoration=O.scrollPositionRestoration||"disabled",O.anchorScrolling=O.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(f=>{f instanceof Ai?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=f.navigationTrigger,this.restoredId=f.restoredState?f.restoredState.navigationId:0):f instanceof Fi&&(this.lastId=f.id,this.scheduleScrollEvent(f,this.urlSerializer.parse(f.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(f=>{f instanceof ca&&(f.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(f.position):f.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(f.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(f,w){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new ca(f,"popstate"===this.lastSource?this.store[this.restoredId]:null,w))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}}return u.\u0275fac=function(f){d.$Z()},u.\u0275prov=d.Yz7({token:u,factory:u.\u0275fac}),u})();var Eo=(()=>((Eo=Eo||{})[Eo.COMPLETE=0]="COMPLETE",Eo[Eo.FAILED=1]="FAILED",Eo[Eo.REDIRECTING=2]="REDIRECTING",Eo))();const xs=!1;function Bs(u,p){return{\u0275kind:u,\u0275providers:p}}const Oa=new d.OlP("",{providedIn:"root",factory:()=>!1});function Pr(){const u=(0,d.f3M)(d.zs3);return p=>{const f=u.get(d.z2F);if(p!==f.components[0])return;const w=u.get(ns),E=u.get(Ru);1===u.get(Pc)&&w.initialNavigation(),u.get(Rl,null,d.XFs.Optional)?.setUpPreloading(),u.get(ks,null,d.XFs.Optional)?.init(),w.resetRootComponentType(f.componentTypes[0]),E.closed||(E.next(),E.unsubscribe())}}const Ru=new d.OlP(xs?"bootstrap done indicator":"",{factory:()=>new me.x}),Pc=new d.OlP(xs?"initial navigation":"",{providedIn:"root",factory:()=>1});function su(){let u=[];return u=xs?[{provide:d.Xts,multi:!0,useFactory:()=>{const p=(0,d.f3M)(ns);return()=>p.events.subscribe(f=>{console.group?.(`Router Event: ${f.constructor.name}`),console.log(function Wr(u){if(!("type"in u))return`Unknown Router Event: ${u.constructor.name}`;switch(u.type){case 14:return`ActivationEnd(path: '${u.snapshot.routeConfig?.path||""}')`;case 13:return`ActivationStart(path: '${u.snapshot.routeConfig?.path||""}')`;case 12:return`ChildActivationEnd(path: '${u.snapshot.routeConfig?.path||""}')`;case 11:return`ChildActivationStart(path: '${u.snapshot.routeConfig?.path||""}')`;case 8:return`GuardsCheckEnd(id: ${u.id}, url: '${u.url}', urlAfterRedirects: '${u.urlAfterRedirects}', state: ${u.state}, shouldActivate: ${u.shouldActivate})`;case 7:return`GuardsCheckStart(id: ${u.id}, url: '${u.url}', urlAfterRedirects: '${u.urlAfterRedirects}', state: ${u.state})`;case 2:return`NavigationCancel(id: ${u.id}, url: '${u.url}')`;case 16:return`NavigationSkipped(id: ${u.id}, url: '${u.url}')`;case 1:return`NavigationEnd(id: ${u.id}, url: '${u.url}', urlAfterRedirects: '${u.urlAfterRedirects}')`;case 3:return`NavigationError(id: ${u.id}, url: '${u.url}', error: ${u.error})`;case 0:return`NavigationStart(id: ${u.id}, url: '${u.url}')`;case 6:return`ResolveEnd(id: ${u.id}, url: '${u.url}', urlAfterRedirects: '${u.urlAfterRedirects}', state: ${u.state})`;case 5:return`ResolveStart(id: ${u.id}, url: '${u.url}', urlAfterRedirects: '${u.urlAfterRedirects}', state: ${u.state})`;case 10:return`RouteConfigLoadEnd(path: ${u.route.path})`;case 9:return`RouteConfigLoadStart(path: ${u.route.path})`;case 4:return`RoutesRecognized(id: ${u.id}, url: '${u.url}', urlAfterRedirects: '${u.urlAfterRedirects}', state: ${u.state})`;case 15:return`Scroll(anchor: '${u.anchor}', position: '${u.position?`${u.position[0]}, ${u.position[1]}`:null}')`}}(f)),console.log(f),console.groupEnd?.()})}}]:[],Bs(1,u)}const Rl=new d.OlP(xs?"router preloader":"");function au(u){return Bs(0,[{provide:Rl,useExisting:iu},{provide:nu,useExisting:u}])}const eo=!1,dl=new d.OlP(eo?"router duplicate forRoot guard":"ROUTER_FORROOT_GUARD"),cu=[de.Ye,{provide:Ue,useClass:Ht},ns,Vo,{provide:mo,useFactory:function Ya(u){return u.routerState.root},deps:[ns]},al,eo?{provide:Oa,useValue:!0}:[]];function Ns(){return new d.PXZ("Router",ns)}let Ja=(()=>{class u{constructor(f){}static forRoot(f,w){return{ngModule:u,providers:[cu,eo&&w?.enableTracing?su().\u0275providers:[],{provide:Fs,multi:!0,useValue:f},{provide:dl,useFactory:ic,deps:[[ns,new d.FiY,new d.tp0]]},{provide:qa,useValue:w||{}},w?.useHash?{provide:de.S$,useClass:de.Do}:{provide:de.S$,useClass:de.b0},{provide:ks,useFactory:()=>{const u=(0,d.f3M)(de.EM),p=(0,d.f3M)(d.R0b),f=(0,d.f3M)(qa),w=(0,d.f3M)(Dc),E=(0,d.f3M)(Ue);return f.scrollOffset&&u.setOffset(f.scrollOffset),new ru(E,w,u,p,f)}},w?.preloadingStrategy?au(w.preloadingStrategy).\u0275providers:[],{provide:d.PXZ,multi:!0,useFactory:Ns},w?.initialNavigation?m(w):[],[{provide:i,useFactory:Pr},{provide:d.tb,multi:!0,useExisting:i}]]}}static forChild(f){return{ngModule:u,providers:[{provide:Fs,multi:!0,useValue:f}]}}}return u.\u0275fac=function(f){return new(f||u)(d.LFG(dl,8))},u.\u0275mod=d.oAB({type:u}),u.\u0275inj=d.cJS({imports:[$o]}),u})();function ic(u){if(eo&&u)throw new d.vHH(4007,"The Router was provided more than once. This can happen if 'forRoot' is used outside of the root injector. Lazy loaded modules should use RouterModule.forChild() instead.");return"guarded"}function m(u){return["disabled"===u.initialNavigation?Bs(3,[{provide:d.ip1,multi:!0,useFactory:()=>{const p=(0,d.f3M)(ns);return()=>{p.setUpLocationChangeListener()}}},{provide:Pc,useValue:2}]).\u0275providers:[],"enabledBlocking"===u.initialNavigation?Bs(2,[{provide:Pc,useValue:0},{provide:d.ip1,multi:!0,deps:[d.zs3],useFactory:p=>{const f=p.get(de.V_,Promise.resolve());return()=>f.then(()=>new Promise(w=>{const E=p.get(ns),P=p.get(Ru);(function Xs(u,p){u.events.pipe((0,Gt.h)(f=>f instanceof Fi||f instanceof Vi||f instanceof Qi||f instanceof Ir),(0,se.U)(f=>f instanceof Fi||f instanceof Ir?Eo.COMPLETE:f instanceof Vi&&(0===f.code||1===f.code)?Eo.REDIRECTING:Eo.FAILED),(0,Gt.h)(f=>f!==Eo.REDIRECTING),(0,_t.q)(1)).subscribe(()=>{p()})})(E,()=>{w(!0)}),p.get(Dc).afterPreactivation=()=>(w(!0),P.closed?(0,re.of)(void 0):P),E.initialNavigation()}))}}]).\u0275providers:[]]}const i=new d.OlP(eo?"Router Initializer":"")},4463:(Ln,Dt,F)=>{"use strict";F.d(Dt,{Zw:()=>ne,aw:()=>xt,X$:()=>St,sK:()=>Lt});var d=F(8274),v=F(9646),re=F(9751),a=F(576);function q(rt){return!!rt&&(rt instanceof re.y||(0,a.m)(rt.lift)&&(0,a.m)(rt.subscribe))}var oe=F(4128),b=F(7272),he=F(9770),Ie=F(5698),Ve=F(7579),K=F(6063);class xe extends Ve.x{constructor(lt=1/0,Ce=1/0,bt=K.l){super(),this._bufferSize=lt,this._windowTime=Ce,this._timestampProvider=bt,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=Ce===1/0,this._bufferSize=Math.max(1,lt),this._windowTime=Math.max(1,Ce)}next(lt){const{isStopped:Ce,_buffer:bt,_infiniteTimeWindow:kt,_timestampProvider:Ut,_windowTime:bn}=this;Ce||(bt.push(lt),!kt&&bt.push(Ut.now()+bn)),this._trimBuffer(),super.next(lt)}_subscribe(lt){this._throwIfClosed(),this._trimBuffer();const Ce=this._innerSubscribe(lt),{_infiniteTimeWindow:bt,_buffer:kt}=this,Ut=kt.slice();for(let bn=0;bn<Ut.length&&!lt.closed;bn+=bt?1:2)lt.next(Ut[bn]);return this._checkFinalizedStatuses(lt),Ce}_trimBuffer(){const{_bufferSize:lt,_timestampProvider:Ce,_buffer:bt,_infiniteTimeWindow:kt}=this,Ut=(kt?1:2)*lt;if(lt<1/0&&Ut<bt.length&&bt.splice(0,bt.length-Ut),!kt){const bn=Ce.now();let Nn=0;for(let un=1;un<bt.length&&bt[un]<=bn;un+=2)Nn=un;Nn&&bt.splice(0,Nn+1)}}}var pe=F(3099);function ze(rt,lt,Ce){let bt,kt=!1;return rt&&"object"==typeof rt?({bufferSize:bt=1/0,windowTime:lt=1/0,refCount:kt=!1,scheduler:Ce}=rt):bt=rt??1/0,(0,pe.B)({connector:()=>new xe(bt,lt,Ce),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:kt})}var ce=F(4004),Ke=F(4351),Pe=F(3900);class ne{}let Je=(()=>{class rt extends ne{getTranslation(Ce){return(0,v.of)({})}}return rt.\u0275fac=function(){let lt;return function(bt){return(lt||(lt=d.n5z(rt)))(bt||rt)}}(),rt.\u0275prov=d.Yz7({token:rt,factory:rt.\u0275fac}),rt})();class Pt{}let at=(()=>{class rt{handle(Ce){return Ce.key}}return rt.\u0275fac=function(Ce){return new(Ce||rt)},rt.\u0275prov=d.Yz7({token:rt,factory:rt.\u0275fac}),rt})();function ge(rt,lt){if(rt===lt)return!0;if(null===rt||null===lt)return!1;if(rt!=rt&&lt!=lt)return!0;let kt,Ut,bn,Ce=typeof rt;if(Ce==typeof lt&&"object"==Ce){if(!Array.isArray(rt)){if(Array.isArray(lt))return!1;for(Ut in bn=Object.create(null),rt){if(!ge(rt[Ut],lt[Ut]))return!1;bn[Ut]=!0}for(Ut in lt)if(!(Ut in bn)&&typeof lt[Ut]<"u")return!1;return!0}if(!Array.isArray(lt))return!1;if((kt=rt.length)==lt.length){for(Ut=0;Ut<kt;Ut++)if(!ge(rt[Ut],lt[Ut]))return!1;return!0}}return!1}function ke(rt){return typeof rt<"u"&&null!==rt}function Le(rt){return rt&&"object"==typeof rt&&!Array.isArray(rt)}function we(rt,lt){let Ce=Object.assign({},rt);return Le(rt)&&Le(lt)&&Object.keys(lt).forEach(bt=>{Le(lt[bt])?bt in rt?Ce[bt]=we(rt[bt],lt[bt]):Object.assign(Ce,{[bt]:lt[bt]}):Object.assign(Ce,{[bt]:lt[bt]})}),Ce}class Xe{}let He=(()=>{class rt extends Xe{constructor(){super(...arguments),this.templateMatcher=/{{\s?([^{}\s]*)\s?}}/g}interpolate(Ce,bt){let kt;return kt="string"==typeof Ce?this.interpolateString(Ce,bt):"function"==typeof Ce?this.interpolateFunction(Ce,bt):Ce,kt}getValue(Ce,bt){let kt="string"==typeof bt?bt.split("."):[bt];bt="";do{bt+=kt.shift(),!ke(Ce)||!ke(Ce[bt])||"object"!=typeof Ce[bt]&&kt.length?kt.length?bt+=".":Ce=void 0:(Ce=Ce[bt],bt="")}while(kt.length);return Ce}interpolateFunction(Ce,bt){return Ce(bt)}interpolateString(Ce,bt){return bt?Ce.replace(this.templateMatcher,(kt,Ut)=>{let bn=this.getValue(bt,Ut);return ke(bn)?bn:kt}):Ce}}return rt.\u0275fac=function(){let lt;return function(bt){return(lt||(lt=d.n5z(rt)))(bt||rt)}}(),rt.\u0275prov=d.Yz7({token:rt,factory:rt.\u0275fac}),rt})();class me{}let de=(()=>{class rt extends me{compile(Ce,bt){return Ce}compileTranslations(Ce,bt){return Ce}}return rt.\u0275fac=function(){let lt;return function(bt){return(lt||(lt=d.n5z(rt)))(bt||rt)}}(),rt.\u0275prov=d.Yz7({token:rt,factory:rt.\u0275fac}),rt})();class se{constructor(){this.currentLang=this.defaultLang,this.translations={},this.langs=[],this.onTranslationChange=new d.vpe,this.onLangChange=new d.vpe,this.onDefaultLangChange=new d.vpe}}const Ee=new d.OlP("USE_STORE"),_t=new d.OlP("USE_DEFAULT_LANG"),It=new d.OlP("DEFAULT_LANGUAGE"),Gt=new d.OlP("USE_EXTEND");let Lt=(()=>{class rt{constructor(Ce,bt,kt,Ut,bn,Nn=!0,un=!1,ot=!1,Bt){this.store=Ce,this.currentLoader=bt,this.compiler=kt,this.parser=Ut,this.missingTranslationHandler=bn,this.useDefaultLang=Nn,this.isolate=un,this.extend=ot,this.pending=!1,this._onTranslationChange=new d.vpe,this._onLangChange=new d.vpe,this._onDefaultLangChange=new d.vpe,this._langs=[],this._translations={},this._translationRequests={},Bt&&this.setDefaultLang(Bt)}get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(Ce){this.isolate?this._defaultLang=Ce:this.store.defaultLang=Ce}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(Ce){this.isolate?this._currentLang=Ce:this.store.currentLang=Ce}get langs(){return this.isolate?this._langs:this.store.langs}set langs(Ce){this.isolate?this._langs=Ce:this.store.langs=Ce}get translations(){return this.isolate?this._translations:this.store.translations}set translations(Ce){this.isolate?this._translations=Ce:this.store.translations=Ce}setDefaultLang(Ce){if(Ce===this.defaultLang)return;let bt=this.retrieveTranslations(Ce);typeof bt<"u"?(null==this.defaultLang&&(this.defaultLang=Ce),bt.pipe((0,Ie.q)(1)).subscribe(kt=>{this.changeDefaultLang(Ce)})):this.changeDefaultLang(Ce)}getDefaultLang(){return this.defaultLang}use(Ce){if(Ce===this.currentLang)return(0,v.of)(this.translations[Ce]);let bt=this.retrieveTranslations(Ce);return typeof bt<"u"?(this.currentLang||(this.currentLang=Ce),bt.pipe((0,Ie.q)(1)).subscribe(kt=>{this.changeLang(Ce)}),bt):(this.changeLang(Ce),(0,v.of)(this.translations[Ce]))}retrieveTranslations(Ce){let bt;return(typeof this.translations[Ce]>"u"||this.extend)&&(this._translationRequests[Ce]=this._translationRequests[Ce]||this.getTranslation(Ce),bt=this._translationRequests[Ce]),bt}getTranslation(Ce){this.pending=!0;const bt=this.currentLoader.getTranslation(Ce).pipe(ze(1),(0,Ie.q)(1));return this.loadingTranslations=bt.pipe((0,ce.U)(kt=>this.compiler.compileTranslations(kt,Ce)),ze(1),(0,Ie.q)(1)),this.loadingTranslations.subscribe({next:kt=>{this.translations[Ce]=this.extend&&this.translations[Ce]?{...kt,...this.translations[Ce]}:kt,this.updateLangs(),this.pending=!1},error:kt=>{this.pending=!1}}),bt}setTranslation(Ce,bt,kt=!1){bt=this.compiler.compileTranslations(bt,Ce),this.translations[Ce]=(kt||this.extend)&&this.translations[Ce]?we(this.translations[Ce],bt):bt,this.updateLangs(),this.onTranslationChange.emit({lang:Ce,translations:this.translations[Ce]})}getLangs(){return this.langs}addLangs(Ce){Ce.forEach(bt=>{-1===this.langs.indexOf(bt)&&this.langs.push(bt)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(Ce,bt,kt){let Ut;if(bt instanceof Array){let bn={},Nn=!1;for(let un of bt)bn[un]=this.getParsedResult(Ce,un,kt),q(bn[un])&&(Nn=!0);if(Nn){const un=bt.map(ot=>q(bn[ot])?bn[ot]:(0,v.of)(bn[ot]));return(0,oe.D)(un).pipe((0,ce.U)(ot=>{let Bt={};return ot.forEach((Sn,Qn)=>{Bt[bt[Qn]]=Sn}),Bt}))}return bn}if(Ce&&(Ut=this.parser.interpolate(this.parser.getValue(Ce,bt),kt)),typeof Ut>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(Ut=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],bt),kt)),typeof Ut>"u"){let bn={key:bt,translateService:this};typeof kt<"u"&&(bn.interpolateParams=kt),Ut=this.missingTranslationHandler.handle(bn)}return typeof Ut<"u"?Ut:bt}get(Ce,bt){if(!ke(Ce)||!Ce.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe((0,Ke.b)(kt=>q(kt=this.getParsedResult(kt,Ce,bt))?kt:(0,v.of)(kt)));{let kt=this.getParsedResult(this.translations[this.currentLang],Ce,bt);return q(kt)?kt:(0,v.of)(kt)}}getStreamOnTranslationChange(Ce,bt){if(!ke(Ce)||!Ce.length)throw new Error('Parameter "key" required');return(0,b.z)((0,he.P)(()=>this.get(Ce,bt)),this.onTranslationChange.pipe((0,Pe.w)(kt=>{const Ut=this.getParsedResult(kt.translations,Ce,bt);return"function"==typeof Ut.subscribe?Ut:(0,v.of)(Ut)})))}stream(Ce,bt){if(!ke(Ce)||!Ce.length)throw new Error('Parameter "key" required');return(0,b.z)((0,he.P)(()=>this.get(Ce,bt)),this.onLangChange.pipe((0,Pe.w)(kt=>{const Ut=this.getParsedResult(kt.translations,Ce,bt);return q(Ut)?Ut:(0,v.of)(Ut)})))}instant(Ce,bt){if(!ke(Ce)||!Ce.length)throw new Error('Parameter "key" required');let kt=this.getParsedResult(this.translations[this.currentLang],Ce,bt);if(q(kt)){if(Ce instanceof Array){let Ut={};return Ce.forEach((bn,Nn)=>{Ut[Ce[Nn]]=Ce[Nn]}),Ut}return Ce}return kt}set(Ce,bt,kt=this.currentLang){this.translations[kt][Ce]=this.compiler.compile(bt,kt),this.updateLangs(),this.onTranslationChange.emit({lang:kt,translations:this.translations[kt]})}changeLang(Ce){this.currentLang=Ce,this.onLangChange.emit({lang:Ce,translations:this.translations[Ce]}),null==this.defaultLang&&this.changeDefaultLang(Ce)}changeDefaultLang(Ce){this.defaultLang=Ce,this.onDefaultLangChange.emit({lang:Ce,translations:this.translations[Ce]})}reloadLang(Ce){return this.resetLang(Ce),this.getTranslation(Ce)}resetLang(Ce){this._translationRequests[Ce]=void 0,this.translations[Ce]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Ce=window.navigator.languages?window.navigator.languages[0]:null;return Ce=Ce||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof Ce>"u"?void 0:(-1!==Ce.indexOf("-")&&(Ce=Ce.split("-")[0]),-1!==Ce.indexOf("_")&&(Ce=Ce.split("_")[0]),Ce)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let Ce=window.navigator.languages?window.navigator.languages[0]:null;return Ce=Ce||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,Ce}}return rt.\u0275fac=function(Ce){return new(Ce||rt)(d.LFG(se),d.LFG(ne),d.LFG(me),d.LFG(Xe),d.LFG(Pt),d.LFG(_t),d.LFG(Ee),d.LFG(Gt),d.LFG(It))},rt.\u0275prov=d.Yz7({token:rt,factory:rt.\u0275fac}),rt})(),St=(()=>{class rt{constructor(Ce,bt){this.translate=Ce,this._ref=bt,this.value="",this.lastKey=null,this.lastParams=[]}updateValue(Ce,bt,kt){let Ut=bn=>{this.value=void 0!==bn?bn:Ce,this.lastKey=Ce,this._ref.markForCheck()};if(kt){let bn=this.translate.getParsedResult(kt,Ce,bt);q(bn.subscribe)?bn.subscribe(Ut):Ut(bn)}this.translate.get(Ce,bt).subscribe(Ut)}transform(Ce,...bt){if(!Ce||!Ce.length)return Ce;if(ge(Ce,this.lastKey)&&ge(bt,this.lastParams))return this.value;let kt;if(ke(bt[0])&&bt.length)if("string"==typeof bt[0]&&bt[0].length){let Ut=bt[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{kt=JSON.parse(Ut)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${bt[0]}`)}}else"object"==typeof bt[0]&&!Array.isArray(bt[0])&&(kt=bt[0]);return this.lastKey=Ce,this.lastParams=bt,this.updateValue(Ce,kt),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(Ut=>{this.lastKey&&Ut.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(Ce,kt,Ut.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(Ut=>{this.lastKey&&(this.lastKey=null,this.updateValue(Ce,kt,Ut.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(Ce,kt))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}}return rt.\u0275fac=function(Ce){return new(Ce||rt)(d.Y36(Lt,16),d.Y36(d.sBO,16))},rt.\u0275pipe=d.Yjl({name:"translate",type:rt,pure:!1}),rt.\u0275prov=d.Yz7({token:rt,factory:rt.\u0275fac}),rt})(),xt=(()=>{class rt{static forRoot(Ce={}){return{ngModule:rt,providers:[Ce.loader||{provide:ne,useClass:Je},Ce.compiler||{provide:me,useClass:de},Ce.parser||{provide:Xe,useClass:He},Ce.missingTranslationHandler||{provide:Pt,useClass:at},se,{provide:Ee,useValue:Ce.isolate},{provide:_t,useValue:Ce.useDefaultLang},{provide:Gt,useValue:Ce.extend},{provide:It,useValue:Ce.defaultLanguage},Lt]}}static forChild(Ce={}){return{ngModule:rt,providers:[Ce.loader||{provide:ne,useClass:Je},Ce.compiler||{provide:me,useClass:de},Ce.parser||{provide:Xe,useClass:He},Ce.missingTranslationHandler||{provide:Pt,useClass:at},{provide:Ee,useValue:Ce.isolate},{provide:_t,useValue:Ce.useDefaultLang},{provide:Gt,useValue:Ce.extend},{provide:It,useValue:Ce.defaultLanguage},Lt]}}}return rt.\u0275fac=function(Ce){return new(Ce||rt)},rt.\u0275mod=d.oAB({type:rt}),rt.\u0275inj=d.cJS({}),rt})()},5861:(Ln,Dt,F)=>{"use strict";function d(re,a,q,oe,b,he,Ie){try{var Ve=re[he](Ie),K=Ve.value}catch(xe){return void q(xe)}Ve.done?a(K):Promise.resolve(K).then(oe,b)}function v(re){return function(){var a=this,q=arguments;return new Promise(function(oe,b){var he=re.apply(a,q);function Ie(K){d(he,oe,b,Ie,Ve,"next",K)}function Ve(K){d(he,oe,b,Ie,Ve,"throw",K)}Ie(void 0)})}}F.d(Dt,{Z:()=>v})}},Ln=>{Ln(Ln.s=659)}]);