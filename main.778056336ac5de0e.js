(self.webpackChunkapp=self.webpackChunkapp||[]).push([[179],{2726:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Uw:()=>Ce,fo:()=>Me});var h=P(5861);typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"&&global;var ie=function(De){return De.Unimplemented="UNIMPLEMENTED",De.Unavailable="UNAVAILABLE",De}(ie||{});class fe extends Error{constructor(ze,Ke,Ht){super(ze),this.message=ze,this.code=Ke,this.data=Ht}}const K=De=>{var ze,Ke,Ht,dn,_n;const Ut=De.CapacitorCustomPlatform||null,We=De.Capacitor||{},Ne=We.Plugins=We.Plugins||{},ke=De.CapacitorPlatforms,Qt=(null===(ze=ke?.currentPlatform)||void 0===ze?void 0:ze.getPlatform)||(()=>null!==Ut?Ut.name:(De=>{var ze,Ke;return De?.androidBridge?"android":null!==(Ke=null===(ze=De?.webkit)||void 0===ze?void 0:ze.messageHandlers)&&void 0!==Ke&&Ke.bridge?"ios":"web"})(De)),an=(null===(Ke=ke?.currentPlatform)||void 0===Ke?void 0:Ke.isNativePlatform)||(()=>"web"!==Qt()),pt=(null===(Ht=ke?.currentPlatform)||void 0===Ht?void 0:Ht.isPluginAvailable)||(hn=>{const Yt=pe.get(hn);return!(!Yt?.platforms.has(Qt())&&!bn(hn))}),bn=(null===(dn=ke?.currentPlatform)||void 0===dn?void 0:dn.getPluginHeader)||(hn=>{var Yt;return null===(Yt=We.PluginHeaders)||void 0===Yt?void 0:Yt.find(Ft=>Ft.name===hn)}),pe=new Map,Zt=(null===(_n=ke?.currentPlatform)||void 0===_n?void 0:_n.registerPlugin)||((hn,Yt={})=>{const Ft=pe.get(hn);if(Ft)return console.warn(`Capacitor plugin "${hn}" already registered. Cannot register plugins twice.`),Ft.proxy;const Un=Qt(),Ve=bn(hn);let Pt;const Kt=function(){var Ei=(0,h.Z)(function*(){return!Pt&&Un in Yt?Pt=Pt="function"==typeof Yt[Un]?yield Yt[Un]():Yt[Un]:null!==Ut&&!Pt&&"web"in Yt&&(Pt=Pt="function"==typeof Yt.web?yield Yt.web():Yt.web),Pt});return function(){return Ei.apply(this,arguments)}}(),ei=Ei=>{let fn;const Li=(...gn)=>{const Fn=Kt().then(Jt=>{const Bi=((Ei,fn)=>{var Li,gn;if(!Ve){if(Ei)return null===(gn=Ei[fn])||void 0===gn?void 0:gn.bind(Ei);throw new fe(`"${hn}" plugin is not implemented on ${Un}`,ie.Unimplemented)}{const Fn=Ve?.methods.find(Jt=>fn===Jt.name);if(Fn)return"promise"===Fn.rtype?Jt=>We.nativePromise(hn,fn.toString(),Jt):(Jt,Bi)=>We.nativeCallback(hn,fn.toString(),Jt,Bi);if(Ei)return null===(Li=Ei[fn])||void 0===Li?void 0:Li.bind(Ei)}})(Jt,Ei);if(Bi){const ut=Bi(...gn);return fn=ut?.remove,ut}throw new fe(`"${hn}.${Ei}()" is not implemented on ${Un}`,ie.Unimplemented)});return"addListener"===Ei&&(Fn.remove=(0,h.Z)(function*(){return fn()})),Fn};return Li.toString=()=>`${Ei.toString()}() { [capacitor code] }`,Object.defineProperty(Li,"name",{value:Ei,writable:!1,configurable:!1}),Li},di=ei("addListener"),Lr=ei("removeListener"),Mi=(Ei,fn)=>{const Li=di({eventName:Ei},fn),gn=function(){var Jt=(0,h.Z)(function*(){const Bi=yield Li;Lr({eventName:Ei,callbackId:Bi},fn)});return function(){return Jt.apply(this,arguments)}}(),Fn=new Promise(Jt=>Li.then(()=>Jt({remove:gn})));return Fn.remove=(0,h.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield gn()}),Fn},dr=new Proxy({},{get(Ei,fn){switch(fn){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Ve?Mi:di;case"removeListener":return Lr;default:return ei(fn)}}});return Ne[hn]=dr,pe.set(hn,{name:hn,proxy:dr,platforms:new Set([...Object.keys(Yt),...Ve?[Un]:[]])}),dr});return We.convertFileSrc||(We.convertFileSrc=hn=>hn),We.getPlatform=Qt,We.handleError=hn=>De.console.error(hn),We.isNativePlatform=an,We.isPluginAvailable=pt,We.pluginMethodNoop=(hn,Yt,Ft)=>Promise.reject(`${Ft} does not have an implementation of "${Yt}".`),We.registerPlugin=Zt,We.Exception=fe,We.DEBUG=!!We.DEBUG,We.isLoggingEnabled=!!We.isLoggingEnabled,We.platform=We.getPlatform(),We.isNative=We.isNativePlatform(),We},Te=(De=>De.Capacitor=K(De))(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Me=Te.registerPlugin;class Ce{constructor(ze){this.listeners={},this.windowListeners={},ze&&(console.warn(`Capacitor WebPlugin "${ze.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=ze)}addListener(ze,Ke){var Ht=this;this.listeners[ze]||(this.listeners[ze]=[]),this.listeners[ze].push(Ke);const _n=this.windowListeners[ze];_n&&!_n.registered&&this.addWindowListener(_n);const Ut=function(){var Ne=(0,h.Z)(function*(){return Ht.removeListener(ze,Ke)});return function(){return Ne.apply(this,arguments)}}(),We=Promise.resolve({remove:Ut});return Object.defineProperty(We,"remove",{value:(Ne=(0,h.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield Ut()}),function(){return Ne.apply(this,arguments)})}),We;var Ne}removeAllListeners(){var ze=this;return(0,h.Z)(function*(){ze.listeners={};for(const Ke in ze.windowListeners)ze.removeWindowListener(ze.windowListeners[Ke]);ze.windowListeners={}})()}notifyListeners(ze,Ke){const Ht=this.listeners[ze];Ht&&Ht.forEach(dn=>dn(Ke))}hasListeners(ze){return!!this.listeners[ze].length}registerWindowListener(ze,Ke){this.windowListeners[Ke]={registered:!1,windowEventName:ze,pluginEventName:Ke,handler:Ht=>{this.notifyListeners(Ke,Ht)}}}unimplemented(ze="not implemented"){return new Te.Exception(ze,ie.Unimplemented)}unavailable(ze="not available"){return new Te.Exception(ze,ie.Unavailable)}removeListener(ze,Ke){var Ht=this;return(0,h.Z)(function*(){const dn=Ht.listeners[ze];if(!dn)return;const _n=dn.indexOf(Ke);Ht.listeners[ze].splice(_n,1),Ht.listeners[ze].length||Ht.removeWindowListener(Ht.windowListeners[ze])})()}addWindowListener(ze){window.addEventListener(ze.windowEventName,ze.handler),ze.registered=!0}removeWindowListener(ze){ze&&(window.removeEventListener(ze.windowEventName,ze.handler),ze.registered=!1)}}const xe=De=>encodeURIComponent(De).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Ie=De=>De.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Ae extends Ce{getCookies(){return(0,h.Z)(function*(){const ze=document.cookie,Ke={};return ze.split(";").forEach(Ht=>{if(Ht.length<=0)return;let[dn,_n]=Ht.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");dn=Ie(dn).trim(),_n=Ie(_n).trim(),Ke[dn]=_n}),Ke})()}setCookie(ze){return(0,h.Z)(function*(){try{const Ke=xe(ze.key),Ht=xe(ze.value),dn=`; expires=${(ze.expires||"").replace("expires=","")}`,_n=(ze.path||"/").replace("path=",""),Ut=null!=ze.url&&ze.url.length>0?`domain=${ze.url}`:"";document.cookie=`${Ke}=${Ht||""}${dn}; path=${_n}; ${Ut};`}catch(Ke){return Promise.reject(Ke)}})()}deleteCookie(ze){return(0,h.Z)(function*(){try{document.cookie=`${ze.key}=; Max-Age=0`}catch(Ke){return Promise.reject(Ke)}})()}clearCookies(){return(0,h.Z)(function*(){try{const ze=document.cookie.split(";")||[];for(const Ke of ze)document.cookie=Ke.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(ze){return Promise.reject(ze)}})()}clearAllCookies(){var ze=this;return(0,h.Z)(function*(){try{yield ze.clearCookies()}catch(Ke){return Promise.reject(Ke)}})()}}Me("CapacitorCookies",{web:()=>new Ae});const Ue=function(){var De=(0,h.Z)(function*(ze){return new Promise((Ke,Ht)=>{const dn=new FileReader;dn.onload=()=>{const _n=dn.result;Ke(_n.indexOf(",")>=0?_n.split(",")[1]:_n)},dn.onerror=_n=>Ht(_n),dn.readAsDataURL(ze)})});return function(Ke){return De.apply(this,arguments)}}();class me extends Ce{request(ze){return(0,h.Z)(function*(){const Ke=((De,ze={})=>{const Ke=Object.assign({method:De.method||"GET",headers:De.headers},ze),dn=((De={})=>{const ze=Object.keys(De);return Object.keys(De).map(dn=>dn.toLocaleLowerCase()).reduce((dn,_n,Ut)=>(dn[_n]=De[ze[Ut]],dn),{})})(De.headers)["content-type"]||"";if("string"==typeof De.data)Ke.body=De.data;else if(dn.includes("application/x-www-form-urlencoded")){const _n=new URLSearchParams;for(const[Ut,We]of Object.entries(De.data||{}))_n.set(Ut,We);Ke.body=_n.toString()}else if(dn.includes("multipart/form-data")){const _n=new FormData;if(De.data instanceof FormData)De.data.forEach((We,Ne)=>{_n.append(Ne,We)});else for(const We of Object.keys(De.data))_n.append(We,De.data[We]);Ke.body=_n;const Ut=new Headers(Ke.headers);Ut.delete("content-type"),Ke.headers=Ut}else(dn.includes("application/json")||"object"==typeof De.data)&&(Ke.body=JSON.stringify(De.data));return Ke})(ze,ze.webFetchExtra),Ht=((De,ze=!0)=>De?Object.entries(De).reduce((Ht,dn)=>{const[_n,Ut]=dn;let We,Ne;return Array.isArray(Ut)?(Ne="",Ut.forEach(ke=>{We=ze?encodeURIComponent(ke):ke,Ne+=`${_n}=${We}&`}),Ne.slice(0,-1)):(We=ze?encodeURIComponent(Ut):Ut,Ne=`${_n}=${We}`),`${Ht}&${Ne}`},"").substr(1):null)(ze.params,ze.shouldEncodeUrlParams),dn=Ht?`${ze.url}?${Ht}`:ze.url,_n=yield fetch(dn,Ke),Ut=_n.headers.get("content-type")||"";let Ne,ke,{responseType:We="text"}=_n.ok?ze:{};switch(Ut.includes("application/json")&&(We="json"),We){case"arraybuffer":case"blob":ke=yield _n.blob(),Ne=yield Ue(ke);break;case"json":Ne=yield _n.json();break;default:Ne=yield _n.text()}const it={};return _n.headers.forEach((Qt,mt)=>{it[mt]=Qt}),{data:Ne,headers:it,status:_n.status,url:_n.url}})()}get(ze){var Ke=this;return(0,h.Z)(function*(){return Ke.request(Object.assign(Object.assign({},ze),{method:"GET"}))})()}post(ze){var Ke=this;return(0,h.Z)(function*(){return Ke.request(Object.assign(Object.assign({},ze),{method:"POST"}))})()}put(ze){var Ke=this;return(0,h.Z)(function*(){return Ke.request(Object.assign(Object.assign({},ze),{method:"PUT"}))})()}patch(ze){var Ke=this;return(0,h.Z)(function*(){return Ke.request(Object.assign(Object.assign({},ze),{method:"PATCH"}))})()}delete(ze){var Ke=this;return(0,h.Z)(function*(){return Ke.request(Object.assign(Object.assign({},ze),{method:"DELETE"}))})()}}Me("CapacitorHttp",{web:()=>new me})},3630:(Bn,Ct,P)=>{"use strict";P.d(Ct,{c:()=>te,r:()=>K});const te=(X,ve)=>{X.componentOnReady?X.componentOnReady().then(me=>ve(me)):K(()=>ve(X))},K=X=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(X):"function"==typeof requestAnimationFrame?requestAnimationFrame(X):setTimeout(X)},191:(Bn,Ct,P)=>{"use strict";P.d(Ct,{L:()=>h,a:()=>m,b:()=>te,c:()=>l,d:()=>B,g:()=>X});const h="ionViewWillEnter",m="ionViewDidEnter",te="ionViewWillLeave",l="ionViewDidLeave",B="ionViewWillUnload",X=ve=>ve.classList.contains("ion-page")?ve:ve.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||ve},4913:(Bn,Ct,P)=>{"use strict";P.d(Ct,{c:()=>nt});var h=P(1848),m=P(512);let te;const B=Ce=>Ce.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Y=Ce=>(void 0===te&&(te=void 0===Ce.style.animationName&&void 0!==Ce.style.webkitAnimationName?"-webkit-":""),te),C=(Ce,oe,xe)=>{const Ie=oe.startsWith("animation")?Y(Ce):"";Ce.style.setProperty(Ie+oe,xe)},ie=(Ce,oe)=>{const xe=oe.startsWith("animation")?Y(Ce):"";Ce.style.removeProperty(xe+oe)},K=[],de=(Ce=[],oe)=>{if(void 0!==oe){const xe=Array.isArray(oe)?oe:[oe];return[...Ce,...xe]}return Ce},nt=Ce=>{let oe,xe,Ie,Ae,ye,Ue,Fe,We,Ne,ke,it,tt,pt,ct=[],X=[],ve=[],me=!1,De={},ze=[],Ke=[],Ht={},dn=0,_n=!1,Ut=!1,Qt=!0,mt=!1,an=!0,Xt=!1;const bn=Ce,Cn=[],It=[],pe=[],lt=[],Zt=[],hn=[],Yt=[],Ft=[],Un=[],Ve=[],Pt=[],Kt="function"==typeof AnimationEffect||void 0!==h.w&&"function"==typeof h.w.AnimationEffect,wn="function"==typeof Element&&"function"==typeof Element.prototype.animate&&Kt,di=()=>Pt,fn=(V,ue)=>{const Xe=ue.findIndex(_t=>_t.c===V);Xe>-1&&ue.splice(Xe,1)},gn=(V,ue)=>((ue?.oneTimeCallback?It:Cn).push({c:V,o:ue}),pt),Jt=()=>{if(wn)Pt.forEach(V=>{V.cancel()}),Pt.length=0;else{const V=lt.slice();(0,m.r)(()=>{V.forEach(ue=>{ie(ue,"animation-name"),ie(ue,"animation-duration"),ie(ue,"animation-timing-function"),ie(ue,"animation-iteration-count"),ie(ue,"animation-delay"),ie(ue,"animation-play-state"),ie(ue,"animation-fill-mode"),ie(ue,"animation-direction")})})}},Bi=()=>{hn.forEach(V=>{V?.parentNode&&V.parentNode.removeChild(V)}),hn.length=0},ae=()=>void 0!==ye?ye:Fe?Fe.getFill():"both",ft=()=>void 0!==Ne?Ne:void 0!==Ue?Ue:Fe?Fe.getDirection():"normal",Z=()=>_n?"linear":void 0!==Ie?Ie:Fe?Fe.getEasing():"linear",Re=()=>Ut?0:void 0!==ke?ke:void 0!==xe?xe:Fe?Fe.getDuration():0,st=()=>void 0!==Ae?Ae:Fe?Fe.getIterations():1,on=()=>void 0!==it?it:void 0!==oe?oe:Fe?Fe.getDelay():0,vr=()=>{0!==dn&&(dn--,0===dn&&((()=>{rr(),Un.forEach(Wt=>Wt()),Ve.forEach(Wt=>Wt());const V=Qt?1:0,ue=ze,Xe=Ke,_t=Ht;lt.forEach(Wt=>{const tn=Wt.classList;ue.forEach(vn=>tn.add(vn)),Xe.forEach(vn=>tn.remove(vn));for(const vn in _t)_t.hasOwnProperty(vn)&&C(Wt,vn,_t[vn])}),ke=void 0,Ne=void 0,it=void 0,Cn.forEach(Wt=>Wt.c(V,pt)),It.forEach(Wt=>Wt.c(V,pt)),It.length=0,an=!0,Qt&&(mt=!0),Qt=!0})(),Fe&&Fe.animationFinish()))},Vr=(V=!0)=>{Bi();const ue=(Ce=>(Ce.forEach(oe=>{for(const xe in oe)if(oe.hasOwnProperty(xe)){const Ie=oe[xe];if("easing"===xe)oe["animation-timing-function"]=Ie,delete oe[xe];else{const Ae=B(xe);Ae!==xe&&(oe[Ae]=Ie,delete oe[xe])}}}),Ce))(ct);lt.forEach(Xe=>{if(ue.length>0){const _t=((Ce=[])=>Ce.map(oe=>{const xe=oe.offset,Ie=[];for(const Ae in oe)oe.hasOwnProperty(Ae)&&"offset"!==Ae&&Ie.push(`${Ae}: ${oe[Ae]};`);return`${100*xe}% { ${Ie.join(" ")} }`}).join(" "))(ue);tt=void 0!==Ce?Ce:(Ce=>{let oe=K.indexOf(Ce);return oe<0&&(oe=K.push(Ce)-1),`ion-animation-${oe}`})(_t);const Wt=((Ce,oe,xe)=>{var Ie;const Ae=(Ce=>{const oe=void 0!==Ce.getRootNode?Ce.getRootNode():Ce;return oe.head||oe})(xe),ye=Y(xe),Ue=Ae.querySelector("#"+Ce);if(Ue)return Ue;const ct=(null!==(Ie=xe.ownerDocument)&&void 0!==Ie?Ie:document).createElement("style");return ct.id=Ce,ct.textContent=`@${ye}keyframes ${Ce} { ${oe} } @${ye}keyframes ${Ce}-alt { ${oe} }`,Ae.appendChild(ct),ct})(tt,_t,Xe);hn.push(Wt),C(Xe,"animation-duration",`${Re()}ms`),C(Xe,"animation-timing-function",Z()),C(Xe,"animation-delay",`${on()}ms`),C(Xe,"animation-fill-mode",ae()),C(Xe,"animation-direction",ft());const tn=st()===1/0?"infinite":st().toString();C(Xe,"animation-iteration-count",tn),C(Xe,"animation-play-state","paused"),V&&C(Xe,"animation-name",`${Wt.id}-alt`),(0,m.r)(()=>{C(Xe,"animation-name",Wt.id||null)})}})},qi=(V=!0)=>{(()=>{Yt.forEach(_t=>_t()),Ft.forEach(_t=>_t());const V=X,ue=ve,Xe=De;lt.forEach(_t=>{const Wt=_t.classList;V.forEach(tn=>Wt.add(tn)),ue.forEach(tn=>Wt.remove(tn));for(const tn in Xe)Xe.hasOwnProperty(tn)&&C(_t,tn,Xe[tn])})})(),ct.length>0&&(wn?(lt.forEach(V=>{const ue=V.animate(ct,{id:bn,delay:on(),duration:Re(),easing:Z(),iterations:st(),fill:ae(),direction:ft()});ue.pause(),Pt.push(ue)}),Pt.length>0&&(Pt[0].onfinish=()=>{vr()})):Vr(V)),me=!0},Qe=V=>{if(V=Math.min(Math.max(V,0),.9999),wn)Pt.forEach(ue=>{ue.currentTime=ue.effect.getComputedTiming().delay+Re()*V,ue.pause()});else{const ue=`-${Re()*V}ms`;lt.forEach(Xe=>{ct.length>0&&(C(Xe,"animation-delay",ue),C(Xe,"animation-play-state","paused"))})}},Tt=V=>{Pt.forEach(ue=>{ue.effect.updateTiming({delay:on(),duration:Re(),easing:Z(),iterations:st(),fill:ae(),direction:ft()})}),void 0!==V&&Qe(V)},Et=(V=!0,ue)=>{(0,m.r)(()=>{lt.forEach(Xe=>{C(Xe,"animation-name",tt||null),C(Xe,"animation-duration",`${Re()}ms`),C(Xe,"animation-timing-function",Z()),C(Xe,"animation-delay",void 0!==ue?`-${ue*Re()}ms`:`${on()}ms`),C(Xe,"animation-fill-mode",ae()||null),C(Xe,"animation-direction",ft()||null);const _t=st()===1/0?"infinite":st().toString();C(Xe,"animation-iteration-count",_t),V&&C(Xe,"animation-name",`${tt}-alt`),(0,m.r)(()=>{C(Xe,"animation-name",tt||null)})})})},ln=(V=!1,ue=!0,Xe)=>(V&&Zt.forEach(_t=>{_t.update(V,ue,Xe)}),wn?Tt(Xe):Et(ue,Xe),pt),Kn=()=>{me&&(wn?Pt.forEach(V=>{V.pause()}):lt.forEach(V=>{C(V,"animation-play-state","paused")}),Xt=!0)},ki=()=>{We=void 0,vr()},rr=()=>{We&&clearTimeout(We)},ee=V=>new Promise(ue=>{V?.sync&&(Ut=!0,gn(()=>Ut=!1,{oneTimeCallback:!0})),me||qi(),mt&&(wn?(Qe(0),Tt()):Et(),mt=!1),an&&(dn=Zt.length+1,an=!1);const Xe=()=>{fn(_t,It),ue()},_t=()=>{fn(Xe,pe),ue()};gn(_t,{oneTimeCallback:!0}),((V,ue)=>{pe.push({c:V,o:{oneTimeCallback:!0}})})(Xe),Zt.forEach(Wt=>{Wt.play()}),wn?(Pt.forEach(V=>{V.play()}),(0===ct.length||0===lt.length)&&vr()):(()=>{if(rr(),(0,m.r)(()=>{lt.forEach(V=>{ct.length>0&&C(V,"animation-play-state","running")})}),0===ct.length||0===lt.length)vr();else{const V=on()||0,ue=Re()||0,Xe=st()||1;isFinite(Xe)&&(We=setTimeout(ki,V+ue*Xe+100)),((Ce,oe)=>{let xe;const Ie={passive:!0},ye=Ue=>{Ce===Ue.target&&(xe&&xe(),rr(),(0,m.r)(()=>{lt.forEach(V=>{ie(V,"animation-duration"),ie(V,"animation-delay"),ie(V,"animation-play-state")}),(0,m.r)(vr)}))};Ce&&(Ce.addEventListener("webkitAnimationEnd",ye,Ie),Ce.addEventListener("animationend",ye,Ie),xe=()=>{Ce.removeEventListener("webkitAnimationEnd",ye,Ie),Ce.removeEventListener("animationend",ye,Ie)})})(lt[0])}})(),Xt=!1}),St=(V,ue)=>{const Xe=ct[0];return void 0===Xe||void 0!==Xe.offset&&0!==Xe.offset?ct=[{offset:0,[V]:ue},...ct]:Xe[V]=ue,pt};return pt={parentAnimation:Fe,elements:lt,childAnimations:Zt,id:bn,animationFinish:vr,from:St,to:(V,ue)=>{const Xe=ct[ct.length-1];return void 0===Xe||void 0!==Xe.offset&&1!==Xe.offset?ct=[...ct,{offset:1,[V]:ue}]:Xe[V]=ue,pt},fromTo:(V,ue,Xe)=>St(V,ue).to(V,Xe),parent:V=>(Fe=V,pt),play:ee,pause:()=>(Zt.forEach(V=>{V.pause()}),Kn(),pt),stop:()=>{Zt.forEach(V=>{V.stop()}),me&&(Jt(),me=!1),_n=!1,Ut=!1,an=!0,Ne=void 0,ke=void 0,it=void 0,dn=0,mt=!1,Qt=!0,Xt=!1,pe.forEach(V=>V.c(0,pt)),pe.length=0},destroy:V=>(Zt.forEach(ue=>{ue.destroy(V)}),(V=>{Jt(),V&&Bi()})(V),lt.length=0,Zt.length=0,ct.length=0,Cn.length=0,It.length=0,me=!1,an=!0,pt),keyframes:V=>{const ue=ct!==V;return ct=V,ue&&(V=>{wn?di().forEach(ue=>{const Xe=ue.effect;if(Xe.setKeyframes)Xe.setKeyframes(V);else{const _t=new KeyframeEffect(Xe.target,V,Xe.getTiming());ue.effect=_t}}):Vr()})(ct),pt},addAnimation:V=>{if(null!=V)if(Array.isArray(V))for(const ue of V)ue.parent(pt),Zt.push(ue);else V.parent(pt),Zt.push(V);return pt},addElement:V=>{if(null!=V)if(1===V.nodeType)lt.push(V);else if(V.length>=0)for(let ue=0;ue<V.length;ue++)lt.push(V[ue]);else console.error("Invalid addElement value");return pt},update:ln,fill:V=>(ye=V,ln(!0),pt),direction:V=>(Ue=V,ln(!0),pt),iterations:V=>(Ae=V,ln(!0),pt),duration:V=>(!wn&&0===V&&(V=1),xe=V,ln(!0),pt),easing:V=>(Ie=V,ln(!0),pt),delay:V=>(oe=V,ln(!0),pt),getWebAnimations:di,getKeyframes:()=>ct,getFill:ae,getDirection:ft,getDelay:on,getIterations:st,getEasing:Z,getDuration:Re,afterAddRead:V=>(Un.push(V),pt),afterAddWrite:V=>(Ve.push(V),pt),afterClearStyles:(V=[])=>{for(const ue of V)Ht[ue]="";return pt},afterStyles:(V={})=>(Ht=V,pt),afterRemoveClass:V=>(Ke=de(Ke,V),pt),afterAddClass:V=>(ze=de(ze,V),pt),beforeAddRead:V=>(Yt.push(V),pt),beforeAddWrite:V=>(Ft.push(V),pt),beforeClearStyles:(V=[])=>{for(const ue of V)De[ue]="";return pt},beforeStyles:(V={})=>(De=V,pt),beforeRemoveClass:V=>(ve=de(ve,V),pt),beforeAddClass:V=>(X=de(X,V),pt),onFinish:gn,isRunning:()=>0!==dn&&!Xt,progressStart:(V=!1,ue)=>(Zt.forEach(Xe=>{Xe.progressStart(V,ue)}),Kn(),_n=V,me||qi(),ln(!1,!0,ue),pt),progressStep:V=>(Zt.forEach(ue=>{ue.progressStep(V)}),Qe(V),pt),progressEnd:(V,ue,Xe)=>(_n=!1,Zt.forEach(_t=>{_t.progressEnd(V,ue,Xe)}),void 0!==Xe&&(ke=Xe),mt=!1,Qt=!0,0===V?(Ne="reverse"===ft()?"normal":"reverse","reverse"===Ne&&(Qt=!1),wn?(ln(),Qe(1-ue)):(it=(1-ue)*Re()*-1,ln(!1,!1))):1===V&&(wn?(ln(),Qe(ue)):(it=ue*Re()*-1,ln(!1,!1))),void 0!==V&&!Fe&&ee(),pt)}}},8958:(Bn,Ct,P)=>{"use strict";P.d(Ct,{E:()=>Pe,a:()=>h,s:()=>ie});const h=K=>{try{if(K instanceof C)return K.value;if(!l()||"string"!=typeof K||""===K)return K;if(K.includes("onload="))return"";const be=document.createDocumentFragment(),Te=document.createElement("div");be.appendChild(Te),Te.innerHTML=K,Y.forEach(Ce=>{const oe=be.querySelectorAll(Ce);for(let xe=oe.length-1;xe>=0;xe--){const Ie=oe[xe];Ie.parentNode?Ie.parentNode.removeChild(Ie):be.removeChild(Ie);const Ae=te(Ie);for(let ye=0;ye<Ae.length;ye++)m(Ae[ye])}});const Me=te(be);for(let Ce=0;Ce<Me.length;Ce++)m(Me[Ce]);const de=document.createElement("div");de.appendChild(be);const nt=de.querySelector("div");return null!==nt?nt.innerHTML:de.innerHTML}catch(be){return console.error(be),""}},m=K=>{if(K.nodeType&&1!==K.nodeType)return;if(typeof NamedNodeMap<"u"&&!(K.attributes instanceof NamedNodeMap))return void K.remove();for(let Te=K.attributes.length-1;Te>=0;Te--){const Me=K.attributes.item(Te),de=Me.name;if(!B.includes(de.toLowerCase())){K.removeAttribute(de);continue}const nt=Me.value,Ce=K[de];(null!=nt&&nt.toLowerCase().includes("javascript:")||null!=Ce&&Ce.toLowerCase().includes("javascript:"))&&K.removeAttribute(de)}const be=te(K);for(let Te=0;Te<be.length;Te++)m(be[Te])},te=K=>null!=K.children?K.children:K.childNodes,l=()=>{var K;const be=window,Te=null===(K=be?.Ionic)||void 0===K?void 0:K.config;return!Te||(Te.get?Te.get("sanitizerEnabled",!0):!0===Te.sanitizerEnabled||void 0===Te.sanitizerEnabled)},B=["class","id","href","src","name","slot"],Y=["script","style","iframe","meta","link","object","embed"];class C{constructor(be){this.value=be}}const ie=K=>{const be=window,Te=be.Ionic;if(!Te||!Te.config||"Object"===Te.config.constructor.name)return be.Ionic=be.Ionic||{},be.Ionic.config=Object.assign(Object.assign({},be.Ionic.config),K),be.Ionic.config},Pe=!1},3254:(Bn,Ct,P)=>{"use strict";P.d(Ct,{C:()=>B,a:()=>te,d:()=>l});var h=P(5861),m=P(512);const te=function(){var Y=(0,h.Z)(function*(C,ie,fe,Pe,K,be){var Te;if(C)return C.attachViewToDom(ie,fe,K,Pe);if(!(be||"string"==typeof fe||fe instanceof HTMLElement))throw new Error("framework delegate is missing");const Me="string"==typeof fe?null===(Te=ie.ownerDocument)||void 0===Te?void 0:Te.createElement(fe):fe;return Pe&&Pe.forEach(de=>Me.classList.add(de)),K&&Object.assign(Me,K),ie.appendChild(Me),yield new Promise(de=>(0,m.c)(Me,de)),Me});return function(ie,fe,Pe,K,be,Te){return Y.apply(this,arguments)}}(),l=(Y,C)=>{if(C){if(Y)return Y.removeViewFromDom(C.parentElement,C);C.remove()}return Promise.resolve()},B=()=>{let Y,C;return{attachViewToDom:function(){var Pe=(0,h.Z)(function*(K,be,Te={},Me=[]){var de,nt;let Ce;if(Y=K,be){const xe="string"==typeof be?null===(de=Y.ownerDocument)||void 0===de?void 0:de.createElement(be):be;Me.forEach(Ie=>xe.classList.add(Ie)),Object.assign(xe,Te),Y.appendChild(xe),Ce=xe,yield new Promise(Ie=>(0,m.c)(xe,Ie))}else if(Y.children.length>0&&("ION-MODAL"===Y.tagName||"ION-POPOVER"===Y.tagName)&&!(Ce=Y.children[0]).classList.contains("ion-delegate-host")){const Ie=null===(nt=Y.ownerDocument)||void 0===nt?void 0:nt.createElement("div");Ie.classList.add("ion-delegate-host"),Me.forEach(Ae=>Ie.classList.add(Ae)),Ie.append(...Y.children),Y.appendChild(Ie),Ce=Ie}const oe=document.querySelector("ion-app")||document.body;return C=document.createComment("ionic teleport"),Y.parentNode.insertBefore(C,Y),oe.appendChild(Y),Ce??Y});return function(be,Te){return Pe.apply(this,arguments)}}(),removeViewFromDom:()=>(Y&&C&&(C.parentNode.insertBefore(Y,C),C.remove()),Promise.resolve())}}},2019:(Bn,Ct,P)=>{"use strict";P.d(Ct,{G:()=>B});class m{constructor(C,ie,fe,Pe,K){this.id=ie,this.name=fe,this.disableScroll=K,this.priority=1e6*Pe+ie,this.ctrl=C}canStart(){return!!this.ctrl&&this.ctrl.canStart(this.name)}start(){return!!this.ctrl&&this.ctrl.start(this.name,this.id,this.priority)}capture(){if(!this.ctrl)return!1;const C=this.ctrl.capture(this.name,this.id,this.priority);return C&&this.disableScroll&&this.ctrl.disableScroll(this.id),C}release(){this.ctrl&&(this.ctrl.release(this.id),this.disableScroll&&this.ctrl.enableScroll(this.id))}destroy(){this.release(),this.ctrl=void 0}}class te{constructor(C,ie,fe,Pe){this.id=ie,this.disable=fe,this.disableScroll=Pe,this.ctrl=C}block(){if(this.ctrl){if(this.disable)for(const C of this.disable)this.ctrl.disableGesture(C,this.id);this.disableScroll&&this.ctrl.disableScroll(this.id)}}unblock(){if(this.ctrl){if(this.disable)for(const C of this.disable)this.ctrl.enableGesture(C,this.id);this.disableScroll&&this.ctrl.enableScroll(this.id)}}destroy(){this.unblock(),this.ctrl=void 0}}const l="backdrop-no-scroll",B=new class h{constructor(){this.gestureId=0,this.requestedStart=new Map,this.disabledGestures=new Map,this.disabledScroll=new Set}createGesture(C){var ie;return new m(this,this.newID(),C.name,null!==(ie=C.priority)&&void 0!==ie?ie:0,!!C.disableScroll)}createBlocker(C={}){return new te(this,this.newID(),C.disable,!!C.disableScroll)}start(C,ie,fe){return this.canStart(C)?(this.requestedStart.set(ie,fe),!0):(this.requestedStart.delete(ie),!1)}capture(C,ie,fe){if(!this.start(C,ie,fe))return!1;const Pe=this.requestedStart;let K=-1e4;if(Pe.forEach(be=>{K=Math.max(K,be)}),K===fe){this.capturedId=ie,Pe.clear();const be=new CustomEvent("ionGestureCaptured",{detail:{gestureName:C}});return document.dispatchEvent(be),!0}return Pe.delete(ie),!1}release(C){this.requestedStart.delete(C),this.capturedId===C&&(this.capturedId=void 0)}disableGesture(C,ie){let fe=this.disabledGestures.get(C);void 0===fe&&(fe=new Set,this.disabledGestures.set(C,fe)),fe.add(ie)}enableGesture(C,ie){const fe=this.disabledGestures.get(C);void 0!==fe&&fe.delete(ie)}disableScroll(C){this.disabledScroll.add(C),1===this.disabledScroll.size&&document.body.classList.add(l)}enableScroll(C){this.disabledScroll.delete(C),0===this.disabledScroll.size&&document.body.classList.remove(l)}canStart(C){return!(void 0!==this.capturedId||this.isDisabled(C))}isCaptured(){return void 0!==this.capturedId}isScrollDisabled(){return this.disabledScroll.size>0}isDisabled(C){const ie=this.disabledGestures.get(C);return!!(ie&&ie.size>0)}newID(){return this.gestureId++,this.gestureId}}},4393:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{MENU_BACK_BUTTON_PRIORITY:()=>B,OVERLAY_BACK_BUTTON_PRIORITY:()=>l,blockHardwareBackButton:()=>m,startHardwareBackButton:()=>te});var h=P(5861);const m=()=>{document.addEventListener("backbutton",()=>{})},te=()=>{const Y=document;let C=!1;Y.addEventListener("backbutton",()=>{if(C)return;let ie=0,fe=[];const Pe=new CustomEvent("ionBackButton",{bubbles:!1,detail:{register(Te,Me){fe.push({priority:Te,handler:Me,id:ie++})}}});Y.dispatchEvent(Pe);const K=function(){var Te=(0,h.Z)(function*(Me){try{if(Me?.handler){const de=Me.handler(be);null!=de&&(yield de)}}catch(de){console.error(de)}});return function(de){return Te.apply(this,arguments)}}(),be=()=>{if(fe.length>0){let Te={priority:Number.MIN_SAFE_INTEGER,handler:()=>{},id:-1};fe.forEach(Me=>{Me.priority>=Te.priority&&(Te=Me)}),C=!0,fe=fe.filter(Me=>Me.id!==Te.id),K(Te).then(()=>C=!1)}};be()})},l=100,B=99},512:(Bn,Ct,P)=>{"use strict";P.d(Ct,{a:()=>ie,b:()=>fe,c:()=>te,d:()=>nt,e:()=>de,f:()=>Me,g:()=>Pe,h:()=>Te,i:()=>C,j:()=>ye,k:()=>B,l:()=>Ce,m:()=>l,n:()=>be,o:()=>oe,p:()=>Ae,q:()=>Ue,r:()=>K,s:()=>ct,t:()=>h,u:()=>xe,v:()=>Ie});const h=(X,ve=0)=>new Promise(me=>{m(X,ve,me)}),m=(X,ve=0,me)=>{let Fe,De;const ze={passive:!0},Ht=()=>{Fe&&Fe()},dn=_n=>{(void 0===_n||X===_n.target)&&(Ht(),me(_n))};return X&&(X.addEventListener("webkitTransitionEnd",dn,ze),X.addEventListener("transitionend",dn,ze),De=setTimeout(dn,ve+500),Fe=()=>{De&&(clearTimeout(De),De=void 0),X.removeEventListener("webkitTransitionEnd",dn,ze),X.removeEventListener("transitionend",dn,ze)}),Ht},te=(X,ve)=>{X.componentOnReady?X.componentOnReady().then(me=>ve(me)):K(()=>ve(X))},l=X=>void 0!==X.componentOnReady,B=(X,ve=[])=>{const me={};return ve.forEach(Fe=>{X.hasAttribute(Fe)&&(null!==X.getAttribute(Fe)&&(me[Fe]=X.getAttribute(Fe)),X.removeAttribute(Fe))}),me},Y=["role","aria-activedescendant","aria-atomic","aria-autocomplete","aria-braillelabel","aria-brailleroledescription","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colindextext","aria-colspan","aria-controls","aria-current","aria-describedby","aria-description","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowindextext","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext"],C=(X,ve)=>{let me=Y;return ve&&ve.length>0&&(me=me.filter(Fe=>!ve.includes(Fe))),B(X,me)},ie=(X,ve,me,Fe)=>{var De;if(typeof window<"u"){const ze=window,Ke=null===(De=ze?.Ionic)||void 0===De?void 0:De.config;if(Ke){const Ht=Ke.get("_ael");if(Ht)return Ht(X,ve,me,Fe);if(Ke._ael)return Ke._ael(X,ve,me,Fe)}}return X.addEventListener(ve,me,Fe)},fe=(X,ve,me,Fe)=>{var De;if(typeof window<"u"){const ze=window,Ke=null===(De=ze?.Ionic)||void 0===De?void 0:De.config;if(Ke){const Ht=Ke.get("_rel");if(Ht)return Ht(X,ve,me,Fe);if(Ke._rel)return Ke._rel(X,ve,me,Fe)}}return X.removeEventListener(ve,me,Fe)},Pe=(X,ve=X)=>X.shadowRoot||ve,K=X=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(X):"function"==typeof requestAnimationFrame?requestAnimationFrame(X):setTimeout(X),be=X=>!!X.shadowRoot&&!!X.attachShadow,Te=X=>{const ve=X.closest("ion-item");return ve?ve.querySelector("ion-label"):null},Me=X=>{if(X.focus(),X.classList.contains("ion-focusable")){const ve=X.closest("ion-app");ve&&ve.setFocus([X])}},de=(X,ve)=>{let me;const Fe=X.getAttribute("aria-labelledby"),De=X.id;let ze=null!==Fe&&""!==Fe.trim()?Fe:ve+"-lbl",Ke=null!==Fe&&""!==Fe.trim()?document.getElementById(Fe):Te(X);return Ke?(null===Fe&&(Ke.id=ze),me=Ke.textContent,Ke.setAttribute("aria-hidden","true")):""!==De.trim()&&(Ke=document.querySelector(`label[for="${De}"]`),Ke&&(""!==Ke.id?ze=Ke.id:Ke.id=ze=`${De}-lbl`,me=Ke.textContent)),{label:Ke,labelId:ze,labelText:me}},nt=(X,ve,me,Fe,De)=>{if(X||be(ve)){let ze=ve.querySelector("input.aux-input");ze||(ze=ve.ownerDocument.createElement("input"),ze.type="hidden",ze.classList.add("aux-input"),ve.appendChild(ze)),ze.disabled=De,ze.name=me,ze.value=Fe||""}},Ce=(X,ve,me)=>Math.max(X,Math.min(ve,me)),oe=(X,ve)=>{if(!X){const me="ASSERT: "+ve;throw console.error(me),new Error(me)}},xe=X=>X.timeStamp||Date.now(),Ie=X=>{if(X){const ve=X.changedTouches;if(ve&&ve.length>0){const me=ve[0];return{x:me.clientX,y:me.clientY}}if(void 0!==X.pageX)return{x:X.pageX,y:X.pageY}}return{x:0,y:0}},Ae=X=>{const ve="rtl"===document.dir;switch(X){case"start":return ve;case"end":return!ve;default:throw new Error(`"${X}" is not a valid value for [side]. Use "start" or "end" instead.`)}},ye=(X,ve)=>{const me=X._original||X;return{_original:X,emit:Ue(me.emit.bind(me),ve)}},Ue=(X,ve=0)=>{let me;return(...Fe)=>{clearTimeout(me),me=setTimeout(X,ve,...Fe)}},ct=(X,ve)=>{if(X??(X={}),ve??(ve={}),X===ve)return!0;const me=Object.keys(X);if(me.length!==Object.keys(ve).length)return!1;for(const Fe of me)if(!(Fe in ve)||X[Fe]!==ve[Fe])return!1;return!0}},2413:(Bn,Ct,P)=>{"use strict";P.d(Ct,{m:()=>Te});var h=P(5861),m=P(1848),te=P(4393),l=P(2400),B=P(512),Y=P(5551),C=P(4913);const ie=Me=>(0,C.c)().duration(Me?400:300),fe=Me=>{let de,nt;const Ce=Me.width+8,oe=(0,C.c)(),xe=(0,C.c)();Me.isEndSide?(de=Ce+"px",nt="0px"):(de=-Ce+"px",nt="0px"),oe.addElement(Me.menuInnerEl).fromTo("transform",`translateX(${de})`,`translateX(${nt})`);const Ae="ios"===(0,Y.b)(Me),ye=Ae?.2:.25;return xe.addElement(Me.backdropEl).fromTo("opacity",.01,ye),ie(Ae).addAnimation([oe,xe])},Pe=Me=>{let de,nt;const Ce=(0,Y.b)(Me),oe=Me.width;Me.isEndSide?(de=-oe+"px",nt=oe+"px"):(de=oe+"px",nt=-oe+"px");const xe=(0,C.c)().addElement(Me.menuInnerEl).fromTo("transform",`translateX(${nt})`,"translateX(0px)"),Ie=(0,C.c)().addElement(Me.contentEl).fromTo("transform","translateX(0px)",`translateX(${de})`),Ae=(0,C.c)().addElement(Me.backdropEl).fromTo("opacity",.01,.32);return ie("ios"===Ce).addAnimation([xe,Ie,Ae])},K=Me=>{const de=(0,Y.b)(Me),nt=Me.width*(Me.isEndSide?-1:1)+"px",Ce=(0,C.c)().addElement(Me.contentEl).fromTo("transform","translateX(0px)",`translateX(${nt})`);return ie("ios"===de).addAnimation(Ce)},Te=(()=>{const Me=new Map,de=[],nt=function(){var Ne=(0,h.Z)(function*(ke){const it=yield Ue(ke,!0);return!!it&&it.open()});return function(it){return Ne.apply(this,arguments)}}(),Ce=function(){var Ne=(0,h.Z)(function*(ke){const it=yield void 0!==ke?Ue(ke,!0):ct();return void 0!==it&&it.close()});return function(it){return Ne.apply(this,arguments)}}(),oe=function(){var Ne=(0,h.Z)(function*(ke){const it=yield Ue(ke,!0);return!!it&&it.toggle()});return function(it){return Ne.apply(this,arguments)}}(),xe=function(){var Ne=(0,h.Z)(function*(ke,it){const Qt=yield Ue(it);return Qt&&(Qt.disabled=!ke),Qt});return function(it,Qt){return Ne.apply(this,arguments)}}(),Ie=function(){var Ne=(0,h.Z)(function*(ke,it){const Qt=yield Ue(it);return Qt&&(Qt.swipeGesture=ke),Qt});return function(it,Qt){return Ne.apply(this,arguments)}}(),Ae=function(){var Ne=(0,h.Z)(function*(ke){if(null!=ke){const it=yield Ue(ke);return void 0!==it&&it.isOpen()}return void 0!==(yield ct())});return function(it){return Ne.apply(this,arguments)}}(),ye=function(){var Ne=(0,h.Z)(function*(ke){const it=yield Ue(ke);return!!it&&!it.disabled});return function(it){return Ne.apply(this,arguments)}}(),Ue=function(){var Ne=(0,h.Z)(function*(ke,it=!1){if(yield We(),"start"===ke||"end"===ke){const mt=de.filter(tt=>tt.side===ke&&!tt.disabled);if(mt.length>=1)return mt.length>1&&it&&(0,l.p)(`menuController queried for a menu on the "${ke}" side, but ${mt.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,mt.map(tt=>tt.el)),mt[0].el;const an=de.filter(tt=>tt.side===ke);if(an.length>=1)return an.length>1&&it&&(0,l.p)(`menuController queried for a menu on the "${ke}" side, but ${an.length} menus were found. The first menu reference will be used. If this is not the behavior you want then pass the ID of the menu instead of its side.`,an.map(tt=>tt.el)),an[0].el}else if(null!=ke)return Ut(mt=>mt.menuId===ke);return Ut(mt=>!mt.disabled)||(de.length>0?de[0].el:void 0)});return function(it){return Ne.apply(this,arguments)}}(),ct=function(){var Ne=(0,h.Z)(function*(){return yield We(),Ht()});return function(){return Ne.apply(this,arguments)}}(),X=function(){var Ne=(0,h.Z)(function*(){return yield We(),dn()});return function(){return Ne.apply(this,arguments)}}(),ve=function(){var Ne=(0,h.Z)(function*(){return yield We(),_n()});return function(){return Ne.apply(this,arguments)}}(),me=(Ne,ke)=>{Me.set(Ne,ke)},ze=function(){var Ne=(0,h.Z)(function*(ke,it,Qt){if(_n())return!1;if(it){const mt=yield ct();mt&&ke.el!==mt&&(yield mt.setOpen(!1,!1))}return ke._setOpen(it,Qt)});return function(it,Qt,mt){return Ne.apply(this,arguments)}}(),Ht=()=>Ut(Ne=>Ne._isOpen),dn=()=>de.map(Ne=>Ne.el),_n=()=>de.some(Ne=>Ne.isAnimating),Ut=Ne=>{const ke=de.find(Ne);if(void 0!==ke)return ke.el},We=()=>Promise.all(Array.from(document.querySelectorAll("ion-menu")).map(Ne=>new Promise(ke=>(0,B.c)(Ne,ke))));return me("reveal",K),me("push",Pe),me("overlay",fe),null==m.d||m.d.addEventListener("ionBackButton",Ne=>{const ke=Ht();ke&&Ne.detail.register(te.MENU_BACK_BUTTON_PRIORITY,()=>ke.close())}),{registerAnimation:me,get:Ue,getMenus:X,getOpen:ct,isEnabled:ye,swipeGesture:Ie,isAnimating:ve,isOpen:Ae,enable:xe,toggle:oe,close:Ce,open:nt,_getOpenSync:Ht,_createAnimation:(Ne,ke)=>{const it=Me.get(Ne);if(!it)throw new Error("animation not registered");return it(ke)},_register:Ne=>{de.indexOf(Ne)<0&&de.push(Ne)},_unregister:Ne=>{const ke=de.indexOf(Ne);ke>-1&&de.splice(ke,1)},_setOpen:ze}})()},9942:(Bn,Ct,P)=>{"use strict";P.d(Ct,{B:()=>be,H:()=>_n,a:()=>pi,b:()=>uo,c:()=>tt,d:()=>Cn,e:()=>en,f:()=>bn,g:()=>pt,h:()=>Ht,i:()=>ae,j:()=>Te,r:()=>Vr,w:()=>jn});var h=P(5861);let l,B,Y,C=!1,ie=!1,fe=!1,Pe=!1,K=!1;const be={isDev:!1,isBrowser:!0,isServer:!1,isTesting:!1},Te=V=>{const ue=new URL(V,Kn.$resourcesUrl$);return ue.origin!==Hn.location.origin?ue.href:ue.pathname},Ie="s-id",Ae="sty-id",ct="slot-fb{display:contents}slot-fb[hidden]{display:none}",X="http://www.w3.org/1999/xlink",ve={},ze=V=>"object"==(V=typeof V)||"function"===V;function Ke(V){var ue,Xe,_t;return null!==(_t=null===(Xe=null===(ue=V.head)||void 0===ue?void 0:ue.querySelector('meta[name="csp-nonce"]'))||void 0===Xe?void 0:Xe.getAttribute("content"))&&void 0!==_t?_t:void 0}const Ht=(V,ue,...Xe)=>{let _t=null,Wt=null,tn=null,vn=!1,Vn=!1;const $n=[],Xn=fi=>{for(let yi=0;yi<fi.length;yi++)_t=fi[yi],Array.isArray(_t)?Xn(_t):null!=_t&&"boolean"!=typeof _t&&((vn="function"!=typeof V&&!ze(_t))&&(_t=String(_t)),vn&&Vn?$n[$n.length-1].$text$+=_t:$n.push(vn?dn(null,_t):_t),Vn=vn)};if(Xn(Xe),ue){ue.key&&(Wt=ue.key),ue.name&&(tn=ue.name);{const fi=ue.className||ue.class;fi&&(ue.class="object"!=typeof fi?fi:Object.keys(fi).filter(yi=>fi[yi]).join(" "))}}if("function"==typeof V)return V(null===ue?{}:ue,$n,We);const si=dn(V,null);return si.$attrs$=ue,$n.length>0&&(si.$children$=$n),si.$key$=Wt,si.$name$=tn,si},dn=(V,ue)=>({$flags$:0,$tag$:V,$text$:ue,$elm$:null,$children$:null,$attrs$:null,$key$:null,$name$:null}),_n={},We={forEach:(V,ue)=>V.map(Ne).forEach(ue),map:(V,ue)=>V.map(Ne).map(ue).map(ke)},Ne=V=>({vattrs:V.$attrs$,vchildren:V.$children$,vkey:V.$key$,vname:V.$name$,vtag:V.$tag$,vtext:V.$text$}),ke=V=>{if("function"==typeof V.vtag){const Xe=Object.assign({},V.vattrs);return V.vkey&&(Xe.key=V.vkey),V.vname&&(Xe.name=V.vname),Ht(V.vtag,Xe,...V.vchildren||[])}const ue=dn(V.vtag,V.vtext);return ue.$attrs$=V.vattrs,ue.$children$=V.vchildren,ue.$key$=V.vkey,ue.$name$=V.vname,ue},Qt=(V,ue,Xe,_t,Wt,tn,vn)=>{let Vn,$n,Xn,si;if(1===tn.nodeType){for(Vn=tn.getAttribute("c-id"),Vn&&($n=Vn.split("."),($n[0]===vn||"0"===$n[0])&&(Xn={$flags$:0,$hostId$:$n[0],$nodeId$:$n[1],$depth$:$n[2],$index$:$n[3],$tag$:tn.tagName.toLowerCase(),$elm$:tn,$attrs$:null,$children$:null,$key$:null,$name$:null,$text$:null},ue.push(Xn),tn.removeAttribute("c-id"),V.$children$||(V.$children$=[]),V.$children$[Xn.$index$]=Xn,V=Xn,_t&&"0"===Xn.$depth$&&(_t[Xn.$index$]=Xn.$elm$))),si=tn.childNodes.length-1;si>=0;si--)Qt(V,ue,Xe,_t,Wt,tn.childNodes[si],vn);if(tn.shadowRoot)for(si=tn.shadowRoot.childNodes.length-1;si>=0;si--)Qt(V,ue,Xe,_t,Wt,tn.shadowRoot.childNodes[si],vn)}else if(8===tn.nodeType)$n=tn.nodeValue.split("."),($n[1]===vn||"0"===$n[1])&&(Vn=$n[0],Xn={$flags$:0,$hostId$:$n[1],$nodeId$:$n[2],$depth$:$n[3],$index$:$n[4],$elm$:tn,$attrs$:null,$children$:null,$key$:null,$name$:null,$tag$:null,$text$:null},"t"===Vn?(Xn.$elm$=tn.nextSibling,Xn.$elm$&&3===Xn.$elm$.nodeType&&(Xn.$text$=Xn.$elm$.textContent,ue.push(Xn),tn.remove(),V.$children$||(V.$children$=[]),V.$children$[Xn.$index$]=Xn,_t&&"0"===Xn.$depth$&&(_t[Xn.$index$]=Xn.$elm$))):Xn.$hostId$===vn&&("s"===Vn?(Xn.$tag$="slot",tn["s-sn"]=$n[5]?Xn.$name$=$n[5]:"",tn["s-sr"]=!0,_t&&(Xn.$elm$=On.createElement(Xn.$tag$),Xn.$name$&&Xn.$elm$.setAttribute("name",Xn.$name$),tn.parentNode.insertBefore(Xn.$elm$,tn),tn.remove(),"0"===Xn.$depth$&&(_t[Xn.$index$]=Xn.$elm$)),Xe.push(Xn),V.$children$||(V.$children$=[]),V.$children$[Xn.$index$]=Xn):"r"===Vn&&(_t?tn.remove():(Wt["s-cr"]=tn,tn["s-cn"]=!0))));else if(V&&"style"===V.$tag$){const fi=dn(null,tn.textContent);fi.$elm$=tn,fi.$index$="0",V.$children$=[fi]}},mt=(V,ue)=>{if(1===V.nodeType){let Xe=0;for(;Xe<V.childNodes.length;Xe++)mt(V.childNodes[Xe],ue);if(V.shadowRoot)for(Xe=0;Xe<V.shadowRoot.childNodes.length;Xe++)mt(V.shadowRoot.childNodes[Xe],ue)}else if(8===V.nodeType){const Xe=V.nodeValue.split(".");"o"===Xe[0]&&(ue.set(Xe[1]+"."+Xe[2],V),V.nodeValue="",V["s-en"]=Xe[3])}},tt=V=>vt.push(V),pt=V=>vr(V).$modeName$,bn=V=>vr(V).$hostElement$,Cn=(V,ue,Xe)=>{const _t=bn(V);return{emit:Wt=>It(_t,ue,{bubbles:!!(4&Xe),composed:!!(2&Xe),cancelable:!!(1&Xe),detail:Wt})}},It=(V,ue,Xe)=>{const _t=Kn.ce(ue,Xe);return V.dispatchEvent(_t),_t},pe=new WeakMap,lt=(V,ue,Xe)=>{let _t=ln.get(V);_i&&Xe?(_t=_t||new CSSStyleSheet,"string"==typeof _t?_t=ue:_t.replaceSync(ue)):_t=ue,ln.set(V,_t)},Zt=(V,ue,Xe)=>{var _t;const Wt=Yt(ue,Xe),tn=ln.get(Wt);if(V=11===V.nodeType?V:On,tn)if("string"==typeof tn){let Vn,vn=pe.get(V=V.head||V);if(vn||pe.set(V,vn=new Set),!vn.has(Wt)){if(V.host&&(Vn=V.querySelector(`[${Ae}="${Wt}"]`)))Vn.innerHTML=tn;else{Vn=On.createElement("style"),Vn.innerHTML=tn;const $n=null!==(_t=Kn.$nonce$)&&void 0!==_t?_t:Ke(On);null!=$n&&Vn.setAttribute("nonce",$n),V.insertBefore(Vn,V.querySelector("link"))}4&ue.$flags$&&(Vn.innerHTML+=ct),vn&&vn.add(Wt)}}else V.adoptedStyleSheets.includes(tn)||(V.adoptedStyleSheets=[...V.adoptedStyleSheets,tn]);return Wt},Yt=(V,ue)=>"sc-"+(ue&&32&V.$flags$?V.$tagName$+"-"+ue:V.$tagName$),Ft=V=>V.replace(/\/\*!@([^\/]+)\*\/[^\{]+\{/g,"$1{"),Un=(V,ue,Xe,_t,Wt,tn)=>{if(Xe!==_t){let vn=qi(V,ue),Vn=ue.toLowerCase();if("class"===ue){const $n=V.classList,Xn=Pt(Xe),si=Pt(_t);$n.remove(...Xn.filter(fi=>fi&&!si.includes(fi))),$n.add(...si.filter(fi=>fi&&!Xn.includes(fi)))}else if("style"===ue){for(const $n in Xe)(!_t||null==_t[$n])&&($n.includes("-")?V.style.removeProperty($n):V.style[$n]="");for(const $n in _t)(!Xe||_t[$n]!==Xe[$n])&&($n.includes("-")?V.style.setProperty($n,_t[$n]):V.style[$n]=_t[$n])}else if("key"!==ue)if("ref"===ue)_t&&_t(V);else if(vn||"o"!==ue[0]||"n"!==ue[1]){const $n=ze(_t);if((vn||$n&&null!==_t)&&!Wt)try{if(V.tagName.includes("-"))V[ue]=_t;else{const si=_t??"";"list"===ue?vn=!1:(null==Xe||V[ue]!=si)&&(V[ue]=si)}}catch{}let Xn=!1;Vn!==(Vn=Vn.replace(/^xlink\:?/,""))&&(ue=Vn,Xn=!0),null==_t||!1===_t?(!1!==_t||""===V.getAttribute(ue))&&(Xn?V.removeAttributeNS(X,ue):V.removeAttribute(ue)):(!vn||4&tn||Wt)&&!$n&&(_t=!0===_t?"":_t,Xn?V.setAttributeNS(X,ue,_t):V.setAttribute(ue,_t))}else if(ue="-"===ue[2]?ue.slice(3):qi(Hn,Vn)?Vn.slice(2):Vn[2]+ue.slice(3),Xe||_t){const $n=ue.endsWith(Kt);ue=ue.replace(wn,""),Xe&&Kn.rel(V,ue,Xe,$n),_t&&Kn.ael(V,ue,_t,$n)}}},Ve=/\s/,Pt=V=>V?V.split(Ve):[],Kt="Capture",wn=new RegExp(Kt+"$"),ei=(V,ue,Xe,_t)=>{const Wt=11===ue.$elm$.nodeType&&ue.$elm$.host?ue.$elm$.host:ue.$elm$,tn=V&&V.$attrs$||ve,vn=ue.$attrs$||ve;for(_t in tn)_t in vn||Un(Wt,_t,tn[_t],void 0,Xe,ue.$flags$);for(_t in vn)Un(Wt,_t,tn[_t],vn[_t],Xe,ue.$flags$)},di=(V,ue,Xe,_t)=>{const Wt=ue.$children$[Xe];let vn,Vn,$n,tn=0;if(C||(fe=!0,"slot"===Wt.$tag$&&(l&&_t.classList.add(l+"-s"),Wt.$flags$|=Wt.$children$?2:1)),null!==Wt.$text$)vn=Wt.$elm$=On.createTextNode(Wt.$text$);else if(1&Wt.$flags$)vn=Wt.$elm$=On.createTextNode("");else{if(Pe||(Pe="svg"===Wt.$tag$),vn=Wt.$elm$=On.createElementNS(Pe?"http://www.w3.org/2000/svg":"http://www.w3.org/1999/xhtml",2&Wt.$flags$?"slot-fb":Wt.$tag$),Pe&&"foreignObject"===Wt.$tag$&&(Pe=!1),ei(null,Wt,Pe),(V=>null!=V)(l)&&vn["s-si"]!==l&&vn.classList.add(vn["s-si"]=l),Wt.$children$)for(tn=0;tn<Wt.$children$.length;++tn)Vn=di(V,Wt,tn,vn),Vn&&vn.appendChild(Vn);"svg"===Wt.$tag$?Pe=!1:"foreignObject"===vn.tagName&&(Pe=!0)}return vn["s-hn"]=Y,3&Wt.$flags$&&(vn["s-sr"]=!0,vn["s-cr"]=B,vn["s-sn"]=Wt.$name$||"",$n=V&&V.$children$&&V.$children$[Xe],$n&&$n.$tag$===Wt.$tag$&&V.$elm$&&Lr(V.$elm$,!1)),vn},Lr=(V,ue)=>{Kn.$flags$|=1;const Xe=V.childNodes;for(let _t=Xe.length-1;_t>=0;_t--){const Wt=Xe[_t];Wt["s-hn"]!==Y&&Wt["s-ol"]&&(gn(Wt).insertBefore(Wt,Li(Wt)),Wt["s-ol"].remove(),Wt["s-ol"]=void 0,Wt["s-sh"]=void 0,fe=!0),ue&&Lr(Wt,ue)}Kn.$flags$&=-2},Mi=(V,ue,Xe,_t,Wt,tn)=>{let Vn,vn=V["s-cr"]&&V["s-cr"].parentNode||V;for(vn.shadowRoot&&vn.tagName===Y&&(vn=vn.shadowRoot);Wt<=tn;++Wt)_t[Wt]&&(Vn=di(null,Xe,Wt,V),Vn&&(_t[Wt].$elm$=Vn,vn.insertBefore(Vn,Li(ue))))},dr=(V,ue,Xe)=>{for(let _t=ue;_t<=Xe;++_t){const Wt=V[_t];if(Wt){const tn=Wt.$elm$;_e(Wt),tn&&(ie=!0,tn["s-ol"]?tn["s-ol"].remove():Lr(tn,!0),tn.remove())}}},fn=(V,ue,Xe=!1)=>V.$tag$===ue.$tag$&&("slot"===V.$tag$?V.$name$===ue.$name$:!!Xe||V.$key$===ue.$key$),Li=V=>V&&V["s-ol"]||V,gn=V=>(V["s-ol"]?V["s-ol"]:V).parentNode,Fn=(V,ue,Xe=!1)=>{const _t=ue.$elm$=V.$elm$,Wt=V.$children$,tn=ue.$children$,vn=ue.$tag$,Vn=ue.$text$;let $n;null===Vn?(Pe="svg"===vn||"foreignObject"!==vn&&Pe,"slot"===vn||ei(V,ue,Pe),null!==Wt&&null!==tn?((V,ue,Xe,_t,Wt=!1)=>{let O,Oe,tn=0,vn=0,Vn=0,$n=0,Xn=ue.length-1,si=ue[0],fi=ue[Xn],yi=_t.length-1,Vi=_t[0],Yi=_t[yi];for(;tn<=Xn&&vn<=yi;)if(null==si)si=ue[++tn];else if(null==fi)fi=ue[--Xn];else if(null==Vi)Vi=_t[++vn];else if(null==Yi)Yi=_t[--yi];else if(fn(si,Vi,Wt))Fn(si,Vi,Wt),si=ue[++tn],Vi=_t[++vn];else if(fn(fi,Yi,Wt))Fn(fi,Yi,Wt),fi=ue[--Xn],Yi=_t[--yi];else if(fn(si,Yi,Wt))("slot"===si.$tag$||"slot"===Yi.$tag$)&&Lr(si.$elm$.parentNode,!1),Fn(si,Yi,Wt),V.insertBefore(si.$elm$,fi.$elm$.nextSibling),si=ue[++tn],Yi=_t[--yi];else if(fn(fi,Vi,Wt))("slot"===si.$tag$||"slot"===Yi.$tag$)&&Lr(fi.$elm$.parentNode,!1),Fn(fi,Vi,Wt),V.insertBefore(fi.$elm$,si.$elm$),fi=ue[--Xn],Vi=_t[++vn];else{for(Vn=-1,$n=tn;$n<=Xn;++$n)if(ue[$n]&&null!==ue[$n].$key$&&ue[$n].$key$===Vi.$key$){Vn=$n;break}Vn>=0?(Oe=ue[Vn],Oe.$tag$!==Vi.$tag$?O=di(ue&&ue[vn],Xe,Vn,V):(Fn(Oe,Vi,Wt),ue[Vn]=void 0,O=Oe.$elm$),Vi=_t[++vn]):(O=di(ue&&ue[vn],Xe,vn,V),Vi=_t[++vn]),O&&gn(si.$elm$).insertBefore(O,Li(si.$elm$))}tn>Xn?Mi(V,null==_t[yi+1]?null:_t[yi+1].$elm$,Xe,_t,vn,yi):vn>yi&&dr(ue,tn,Xn)})(_t,Wt,ue,tn,Xe):null!==tn?(null!==V.$text$&&(_t.textContent=""),Mi(_t,null,ue,tn,0,tn.length-1)):null!==Wt&&dr(Wt,0,Wt.length-1),Pe&&"svg"===vn&&(Pe=!1)):($n=_t["s-cr"])?$n.parentNode.textContent=Vn:V.$text$!==Vn&&(_t.data=Vn)},Jt=V=>{const ue=V.childNodes;for(const Xe of ue)if(1===Xe.nodeType){if(Xe["s-sr"]){const _t=Xe["s-sn"];Xe.hidden=!1;for(const Wt of ue)if(Wt!==Xe)if(Wt["s-hn"]!==Xe["s-hn"]||""!==_t){if(1===Wt.nodeType&&(_t===Wt.getAttribute("slot")||_t===Wt["s-sn"])){Xe.hidden=!0;break}}else if(1===Wt.nodeType||3===Wt.nodeType&&""!==Wt.textContent.trim()){Xe.hidden=!0;break}}Jt(Xe)}},Bi=[],ut=V=>{let ue,Xe,_t;for(const Wt of V.childNodes){if(Wt["s-sr"]&&(ue=Wt["s-cr"])&&ue.parentNode){Xe=ue.parentNode.childNodes;const tn=Wt["s-sn"];for(_t=Xe.length-1;_t>=0;_t--)if(ue=Xe[_t],!ue["s-cn"]&&!ue["s-nr"]&&ue["s-hn"]!==Wt["s-hn"])if(he(ue,tn)){let vn=Bi.find(Vn=>Vn.$nodeToRelocate$===ue);ie=!0,ue["s-sn"]=ue["s-sn"]||tn,vn?(vn.$nodeToRelocate$["s-sh"]=Wt["s-hn"],vn.$slotRefNode$=Wt):(ue["s-sh"]=Wt["s-hn"],Bi.push({$slotRefNode$:Wt,$nodeToRelocate$:ue})),ue["s-sr"]&&Bi.map(Vn=>{he(Vn.$nodeToRelocate$,ue["s-sn"])&&(vn=Bi.find($n=>$n.$nodeToRelocate$===ue),vn&&!Vn.$slotRefNode$&&(Vn.$slotRefNode$=vn.$slotRefNode$))})}else Bi.some(vn=>vn.$nodeToRelocate$===ue)||Bi.push({$nodeToRelocate$:ue})}1===Wt.nodeType&&ut(Wt)}},he=(V,ue)=>1===V.nodeType?null===V.getAttribute("slot")&&""===ue||V.getAttribute("slot")===ue:V["s-sn"]===ue||""===ue,_e=V=>{V.$attrs$&&V.$attrs$.ref&&V.$attrs$.ref(null),V.$children$&&V.$children$.map(_e)},yt=(V,ue)=>{ue&&!V.$onRenderResolve$&&ue["s-p"]&&ue["s-p"].push(new Promise(Xe=>V.$onRenderResolve$=Xe))},Dt=(V,ue)=>{if(V.$flags$|=16,!(4&V.$flags$))return yt(V,V.$ancestorComponent$),jn(()=>jt(V,ue));V.$flags$|=512},jt=(V,ue)=>{const _t=V.$lazyInstance$;let Wt;return ue&&(V.$flags$|=256,V.$queuedListeners$&&(V.$queuedListeners$.map(([tn,vn])=>Z(_t,tn,vn)),V.$queuedListeners$=void 0),Wt=Z(_t,"componentWillLoad")),Wt=Vt(Wt,()=>Z(_t,"componentWillRender")),Vt(Wt,()=>Bt(V,_t,ue))},Vt=(V,ue)=>dt(V)?V.then(ue):ue(),dt=V=>V instanceof Promise||V&&V.then&&"function"==typeof V.then,Bt=function(){var V=(0,h.Z)(function*(ue,Xe,_t){var Wt;const tn=ue.$hostElement$,Vn=tn["s-rc"];_t&&(V=>{const ue=V.$cmpMeta$,Xe=V.$hostElement$,_t=ue.$flags$,tn=Zt(Xe.shadowRoot?Xe.shadowRoot:Xe.getRootNode(),ue,V.$modeName$);10&_t&&(Xe["s-sc"]=tn,Xe.classList.add(tn+"-h"),2&_t&&Xe.classList.add(tn+"-s"))})(ue);Nn(ue,Xe,tn,_t),Vn&&(Vn.map(Xn=>Xn()),tn["s-rc"]=void 0);{const Xn=null!==(Wt=tn["s-p"])&&void 0!==Wt?Wt:[],si=()=>Gn(ue);0===Xn.length?si():(Promise.all(Xn).then(si),ue.$flags$|=4,Xn.length=0)}});return function(Xe,_t,Wt){return V.apply(this,arguments)}}(),Nn=(V,ue,Xe,_t)=>{try{ue=ue.render&&ue.render(),V.$flags$&=-17,V.$flags$|=2,((V,ue,Xe=!1)=>{var _t,Wt,tn,vn;const Vn=V.$hostElement$,$n=V.$cmpMeta$,Xn=V.$vnode$||dn(null,null),si=(V=>V&&V.$tag$===_n)(ue)?ue:Ht(null,null,ue);if(Y=Vn.tagName,$n.$attrsToReflect$&&(si.$attrs$=si.$attrs$||{},$n.$attrsToReflect$.map(([fi,yi])=>si.$attrs$[yi]=Vn[fi])),Xe&&si.$attrs$)for(const fi of Object.keys(si.$attrs$))Vn.hasAttribute(fi)&&!["key","ref","style","class"].includes(fi)&&(si.$attrs$[fi]=Vn[fi]);if(si.$tag$=null,si.$flags$|=4,V.$vnode$=si,si.$elm$=Xn.$elm$=Vn.shadowRoot||Vn,l=Vn["s-sc"],B=Vn["s-cr"],C=0!=(1&$n.$flags$),ie=!1,Fn(Xn,si,Xe),Kn.$flags$|=1,fe){ut(si.$elm$);for(const fi of Bi){const yi=fi.$nodeToRelocate$;if(!yi["s-ol"]){const Vi=On.createTextNode("");Vi["s-nr"]=yi,yi.parentNode.insertBefore(yi["s-ol"]=Vi,yi)}}for(const fi of Bi){const yi=fi.$nodeToRelocate$,Vi=fi.$slotRefNode$;if(Vi){const Yi=Vi.parentNode;let O=Vi.nextSibling;{let Oe=null===(_t=yi["s-ol"])||void 0===_t?void 0:_t.previousSibling;for(;Oe;){let $=null!==(Wt=Oe["s-nr"])&&void 0!==Wt?Wt:null;if($&&$["s-sn"]===yi["s-sn"]&&Yi===$.parentNode&&($=$.nextSibling,!$||!$["s-nr"])){O=$;break}Oe=Oe.previousSibling}}(!O&&Yi!==yi.parentNode||yi.nextSibling!==O)&&yi!==O&&(!yi["s-hn"]&&yi["s-ol"]&&(yi["s-hn"]=yi["s-ol"].parentNode.nodeName),Yi.insertBefore(yi,O),1===yi.nodeType&&(yi.hidden=null!==(tn=yi["s-ih"])&&void 0!==tn&&tn))}else 1===yi.nodeType&&(Xe&&(yi["s-ih"]=null!==(vn=yi.hidden)&&void 0!==vn&&vn),yi.hidden=!0)}}ie&&Jt(si.$elm$),Kn.$flags$&=-2,Bi.length=0})(V,ue,_t)}catch(Wt){Qe(Wt,V.$hostElement$)}return null},Gn=V=>{const Xe=V.$hostElement$,Wt=V.$lazyInstance$,tn=V.$ancestorComponent$;Z(Wt,"componentDidRender"),64&V.$flags$?Z(Wt,"componentDidUpdate"):(V.$flags$|=64,Re(Xe),Z(Wt,"componentDidLoad"),V.$onReadyResolve$(Xe),tn||ft()),V.$onInstanceResolve$(Xe),V.$onRenderResolve$&&(V.$onRenderResolve$(),V.$onRenderResolve$=void 0),512&V.$flags$&&St(()=>Dt(V,!1)),V.$flags$&=-517},ae=V=>{{const ue=vr(V),Xe=ue.$hostElement$.isConnected;return Xe&&2==(18&ue.$flags$)&&Dt(ue,!1),Xe}},ft=V=>{Re(On.documentElement),St(()=>It(Hn,"appload",{detail:{namespace:"ionic"}}))},Z=(V,ue,Xe)=>{if(V&&V[ue])try{return V[ue](Xe)}catch(_t){Qe(_t)}},Re=V=>V.classList.add("hydrated"),In=(V,ue,Xe)=>{var _t;const Wt=V.prototype;if(ue.$members$){V.watchers&&(ue.$watchers$=V.watchers);const tn=Object.entries(ue.$members$);if(tn.map(([vn,[Vn]])=>{31&Vn||2&Xe&&32&Vn?Object.defineProperty(Wt,vn,{get(){return((V,ue)=>vr(this).$instanceValues$.get(ue))(0,vn)},set($n){((V,ue,Xe,_t)=>{const Wt=vr(V),tn=Wt.$hostElement$,vn=Wt.$instanceValues$.get(ue),Vn=Wt.$flags$,$n=Wt.$lazyInstance$;Xe=((V,ue)=>null==V||ze(V)?V:4&ue?"false"!==V&&(""===V||!!V):2&ue?parseFloat(V):1&ue?String(V):V)(Xe,_t.$members$[ue][0]);const Xn=Number.isNaN(vn)&&Number.isNaN(Xe);if((!(8&Vn)||void 0===vn)&&Xe!==vn&&!Xn&&(Wt.$instanceValues$.set(ue,Xe),$n)){if(_t.$watchers$&&128&Vn){const fi=_t.$watchers$[ue];fi&&fi.map(yi=>{try{$n[yi](Xe,vn,ue)}catch(Vi){Qe(Vi,tn)}})}2==(18&Vn)&&Dt(Wt,!1)}})(this,vn,$n,ue)},configurable:!0,enumerable:!0}):1&Xe&&64&Vn&&Object.defineProperty(Wt,vn,{value(...$n){var Xn;const si=vr(this);return null===(Xn=si?.$onInstancePromise$)||void 0===Xn?void 0:Xn.then(()=>{var fi;return null===(fi=si.$lazyInstance$)||void 0===fi?void 0:fi[vn](...$n)})}})}),1&Xe){const vn=new Map;Wt.attributeChangedCallback=function(Vn,$n,Xn){Kn.jmp(()=>{var si;const fi=vn.get(Vn);if(this.hasOwnProperty(fi))Xn=this[fi],delete this[fi];else{if(Wt.hasOwnProperty(fi)&&"number"==typeof this[fi]&&this[fi]==Xn)return;if(null==fi){const yi=vr(this),Vi=yi?.$flags$;if(Vi&&!(8&Vi)&&128&Vi&&Xn!==$n){const Yi=yi.$lazyInstance$,O=null===(si=ue.$watchers$)||void 0===si?void 0:si[Vn];O?.forEach(Oe=>{null!=Yi[Oe]&&Yi[Oe].call(Yi,Xn,$n,Vn)})}return}}this[fi]=(null!==Xn||"boolean"!=typeof this[fi])&&Xn})},V.observedAttributes=Array.from(new Set([...Object.keys(null!==(_t=ue.$watchers$)&&void 0!==_t?_t:{}),...tn.filter(([Vn,$n])=>15&$n[0]).map(([Vn,$n])=>{var Xn;const si=$n[1]||Vn;return vn.set(si,Vn),512&$n[0]&&(null===(Xn=ue.$attrsToReflect$)||void 0===Xn||Xn.push([Vn,si])),si})]))}}return V},bi=function(){var V=(0,h.Z)(function*(ue,Xe,_t,Wt){let tn;if(!(32&Xe.$flags$)){Xe.$flags$|=32;{if(tn=Et(_t),tn.then){const Xn=()=>{};tn=yield tn,Xn()}tn.isProxied||(_t.$watchers$=tn.watchers,In(tn,_t,2),tn.isProxied=!0);const $n=()=>{};Xe.$flags$|=8;try{new tn(Xe)}catch(Xn){Qe(Xn)}Xe.$flags$&=-9,Xe.$flags$|=128,$n(),wi(Xe.$lazyInstance$)}if(tn.style){let $n=tn.style;"string"!=typeof $n&&($n=$n[Xe.$modeName$=(V=>vt.map(ue=>ue(V)).find(ue=>!!ue))(ue)]);const Xn=Yt(_t,Xe.$modeName$);if(!ln.has(Xn)){const si=()=>{};lt(Xn,$n,!!(1&_t.$flags$)),si()}}}const vn=Xe.$ancestorComponent$,Vn=()=>Dt(Xe,!0);vn&&vn["s-rc"]?vn["s-rc"].push(Vn):Vn()});return function(Xe,_t,Wt,tn){return V.apply(this,arguments)}}(),wi=V=>{Z(V,"connectedCallback")},mr=V=>{const ue=V["s-cr"]=On.createComment("");ue["s-cn"]=!0,V.insertBefore(ue,V.firstChild)},Xi=V=>{Z(V,"disconnectedCallback")},Ar=function(){var V=(0,h.Z)(function*(ue){if(!(1&Kn.$flags$)){const Xe=vr(ue);Xe.$rmListeners$&&(Xe.$rmListeners$.map(_t=>_t()),Xe.$rmListeners$=void 0),Xe?.$lazyInstance$?Xi(Xe.$lazyInstance$):Xe?.$onReadyPromise$&&Xe.$onReadyPromise$.then(()=>Xi(Xe.$lazyInstance$))}});return function(Xe){return V.apply(this,arguments)}}(),uo=(V,ue={})=>{var Xe;const Wt=[],tn=ue.exclude||[],vn=Hn.customElements,Vn=On.head,$n=Vn.querySelector("meta[charset]"),Xn=On.createElement("style"),si=[],fi=On.querySelectorAll(`[${Ae}]`);let yi,Vi=!0,Yi=0;for(Object.assign(Kn,ue),Kn.$resourcesUrl$=new URL(ue.resourcesUrl||"./",On.baseURI).href,Kn.$flags$|=2;Yi<fi.length;Yi++)lt(fi[Yi].getAttribute(Ae),Ft(fi[Yi].innerHTML),!0);let O=!1;if(V.map(Oe=>{Oe[1].map($=>{var Ze;const Nt={$flags$:$[0],$tagName$:$[1],$members$:$[2],$listeners$:$[3]};4&Nt.$flags$&&(O=!0),Nt.$members$=$[2],Nt.$listeners$=$[3],Nt.$attrsToReflect$=[],Nt.$watchers$=null!==(Ze=$[4])&&void 0!==Ze?Ze:{};const Fi=Nt.$tagName$,Sr=class extends HTMLElement{constructor(Qi){super(Qi),Yr(Qi=this,Nt),1&Nt.$flags$&&Qi.attachShadow({mode:"open",delegatesFocus:!!(16&Nt.$flags$)})}connectedCallback(){yi&&(clearTimeout(yi),yi=null),Vi?si.push(this):Kn.jmp(()=>(V=>{if(!(1&Kn.$flags$)){const ue=vr(V),Xe=ue.$cmpMeta$,_t=()=>{};if(1&ue.$flags$)_o(V,ue,Xe.$listeners$),ue?.$lazyInstance$?wi(ue.$lazyInstance$):ue?.$onReadyPromise$&&ue.$onReadyPromise$.then(()=>wi(ue.$lazyInstance$));else{let Wt;if(ue.$flags$|=1,Wt=V.getAttribute(Ie),Wt){if(1&Xe.$flags$){const tn=Zt(V.shadowRoot,Xe,V.getAttribute("s-mode"));V.classList.remove(tn+"-h",tn+"-s")}((V,ue,Xe,_t)=>{const tn=V.shadowRoot,vn=[],$n=tn?[]:null,Xn=_t.$vnode$=dn(ue,null);Kn.$orgLocNodes$||mt(On.body,Kn.$orgLocNodes$=new Map),V[Ie]=Xe,V.removeAttribute(Ie),Qt(Xn,vn,[],$n,V,V,Xe),vn.map(si=>{const fi=si.$hostId$+"."+si.$nodeId$,yi=Kn.$orgLocNodes$.get(fi),Vi=si.$elm$;yi&&ki&&""===yi["s-en"]&&yi.parentNode.insertBefore(Vi,yi.nextSibling),tn||(Vi["s-hn"]=ue,yi&&(Vi["s-ol"]=yi,Vi["s-ol"]["s-nr"]=Vi)),Kn.$orgLocNodes$.delete(fi)}),tn&&$n.map(si=>{si&&tn.appendChild(si)})})(V,Xe.$tagName$,Wt,ue)}Wt||12&Xe.$flags$&&mr(V);{let tn=V;for(;tn=tn.parentNode||tn.host;)if(1===tn.nodeType&&tn.hasAttribute("s-id")&&tn["s-p"]||tn["s-p"]){yt(ue,ue.$ancestorComponent$=tn);break}}Xe.$members$&&Object.entries(Xe.$members$).map(([tn,[vn]])=>{if(31&vn&&V.hasOwnProperty(tn)){const Vn=V[tn];delete V[tn],V[tn]=Vn}}),bi(V,ue,Xe)}_t()}})(this))}disconnectedCallback(){Kn.jmp(()=>Ar(this))}componentOnReady(){return vr(this).$onReadyPromise$}};Nt.$lazyBundleId$=Oe[0],!tn.includes(Fi)&&!vn.get(Fi)&&(Wt.push(Fi),vn.define(Fi,In(Sr,Nt,1)))})}),O&&(Xn.innerHTML+=ct),Xn.innerHTML+=Wt+"{visibility:hidden}.hydrated{visibility:inherit}",Xn.innerHTML.length){Xn.setAttribute("data-styles","");const Oe=null!==(Xe=Kn.$nonce$)&&void 0!==Xe?Xe:Ke(On);null!=Oe&&Xn.setAttribute("nonce",Oe),Vn.insertBefore(Xn,$n?$n.nextSibling:Vn.firstChild)}Vi=!1,si.length?si.map(Oe=>Oe.connectedCallback()):Kn.jmp(()=>yi=setTimeout(ft,30))},_o=(V,ue,Xe,_t)=>{Xe&&Xe.map(([Wt,tn,vn])=>{const Vn=zi(V,Wt),$n=Eo(ue,vn),Xn=hr(Wt);Kn.ael(Vn,tn,$n,Xn),(ue.$rmListeners$=ue.$rmListeners$||[]).push(()=>Kn.rel(Vn,tn,$n,Xn))})},Eo=(V,ue)=>Xe=>{try{256&V.$flags$?V.$lazyInstance$[ue](Xe):(V.$queuedListeners$=V.$queuedListeners$||[]).push([ue,Xe])}catch(_t){Qe(_t)}},zi=(V,ue)=>4&ue?On:8&ue?Hn:16&ue?On.body:V,hr=V=>0!=(2&V),yo=new WeakMap,vr=V=>yo.get(V),Vr=(V,ue)=>yo.set(ue.$lazyInstance$=V,ue),Yr=(V,ue)=>{const Xe={$flags$:0,$hostElement$:V,$cmpMeta$:ue,$instanceValues$:new Map};return Xe.$onInstancePromise$=new Promise(_t=>Xe.$onInstanceResolve$=_t),Xe.$onReadyPromise$=new Promise(_t=>Xe.$onReadyResolve$=_t),V["s-p"]=[],V["s-rc"]=[],_o(V,Xe,ue.$listeners$),yo.set(V,Xe)},qi=(V,ue)=>ue in V,Qe=(V,ue)=>(0,console.error)(V,ue),Tt=new Map,Et=(V,ue,Xe)=>{const _t=V.$tagName$.replace(/-/g,"_"),Wt=V.$lazyBundleId$,tn=Tt.get(Wt);return tn?tn[_t]:P(863)(`./${Wt}.entry.js`).then(vn=>(Tt.set(Wt,vn),vn[_t]),Qe)},ln=new Map,vt=[],Hn=typeof window<"u"?window:{},On=Hn.document||{head:{}},Kn={$flags$:0,$resourcesUrl$:"",jmp:V=>V(),raf:V=>requestAnimationFrame(V),ael:(V,ue,Xe,_t)=>V.addEventListener(ue,Xe,_t),rel:(V,ue,Xe,_t)=>V.removeEventListener(ue,Xe,_t),ce:(V,ue)=>new CustomEvent(V,ue)},pi=V=>{Object.assign(Kn,V)},ki=!0,_i=(()=>{try{return new CSSStyleSheet,"function"==typeof(new CSSStyleSheet).replaceSync}catch{}return!1})(),or=[],Ee=[],Be=(V,ue)=>Xe=>{V.push(Xe),K||(K=!0,ue&&4&Kn.$flags$?St(qe):Kn.raf(qe))},ee=V=>{for(let ue=0;ue<V.length;ue++)try{V[ue](performance.now())}catch(Xe){Qe(Xe)}V.length=0},qe=()=>{ee(or),ee(Ee),(K=or.length>0)&&Kn.raf(qe)},St=V=>Promise.resolve(void 0).then(V),en=Be(or,!1),jn=Be(Ee,!0)},6535:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{GESTURE_CONTROLLER:()=>h.G,createGesture:()=>fe});var h=P(2019);const m=(Te,Me,de,nt)=>{const Ce=te(Te)?{capture:!!nt.capture,passive:!!nt.passive}:!!nt.capture;let oe,xe;return Te.__zone_symbol__addEventListener?(oe="__zone_symbol__addEventListener",xe="__zone_symbol__removeEventListener"):(oe="addEventListener",xe="removeEventListener"),Te[oe](Me,de,Ce),()=>{Te[xe](Me,de,Ce)}},te=Te=>{if(void 0===l)try{const Me=Object.defineProperty({},"passive",{get:()=>{l=!0}});Te.addEventListener("optsTest",()=>{},Me)}catch{l=!1}return!!l};let l;const C=Te=>Te instanceof Document?Te:Te.ownerDocument,fe=Te=>{let Me=!1,de=!1,nt=!0,Ce=!1;const oe=Object.assign({disableScroll:!1,direction:"x",gesturePriority:0,passive:!0,maxAngle:40,threshold:10},Te),xe=oe.canStart,Ie=oe.onWillStart,Ae=oe.onStart,ye=oe.onEnd,Ue=oe.notCaptured,ct=oe.onMove,X=oe.threshold,ve=oe.passive,me=oe.blurOnStart,Fe={type:"pan",startX:0,startY:0,startTime:0,currentX:0,currentY:0,velocityX:0,velocityY:0,deltaX:0,deltaY:0,currentTime:0,event:void 0,data:void 0},De=((Te,Me,de)=>{const nt=de*(Math.PI/180),Ce="x"===Te,oe=Math.cos(nt),xe=Me*Me;let Ie=0,Ae=0,ye=!1,Ue=0;return{start(ct,X){Ie=ct,Ae=X,Ue=0,ye=!0},detect(ct,X){if(!ye)return!1;const ve=ct-Ie,me=X-Ae,Fe=ve*ve+me*me;if(Fe<xe)return!1;const De=Math.sqrt(Fe),ze=(Ce?ve:me)/De;return Ue=ze>oe?1:ze<-oe?-1:0,ye=!1,!0},isGesture:()=>0!==Ue,getDirection:()=>Ue}})(oe.direction,oe.threshold,oe.maxAngle),ze=h.G.createGesture({name:Te.gestureName,priority:Te.gesturePriority,disableScroll:Te.disableScroll}),dn=()=>{Me&&(Ce=!1,ct&&ct(Fe))},_n=()=>!!ze.capture()&&(Me=!0,nt=!1,Fe.startX=Fe.currentX,Fe.startY=Fe.currentY,Fe.startTime=Fe.currentTime,Ie?Ie(Fe).then(We):We(),!0),We=()=>{me&&(()=>{if(typeof document<"u"){const mt=document.activeElement;mt?.blur&&mt.blur()}})(),Ae&&Ae(Fe),nt=!0},Ne=()=>{Me=!1,de=!1,Ce=!1,nt=!0,ze.release()},ke=mt=>{const an=Me,tt=nt;if(Ne(),tt){if(Pe(Fe,mt),an)return void(ye&&ye(Fe));Ue&&Ue(Fe)}},it=((Te,Me,de,nt,Ce)=>{let oe,xe,Ie,Ae,ye,Ue,ct,X=0;const ve=Ut=>{X=Date.now()+2e3,Me(Ut)&&(!xe&&de&&(xe=m(Te,"touchmove",de,Ce)),Ie||(Ie=m(Ut.target,"touchend",Fe,Ce)),Ae||(Ae=m(Ut.target,"touchcancel",Fe,Ce)))},me=Ut=>{X>Date.now()||Me(Ut)&&(!Ue&&de&&(Ue=m(C(Te),"mousemove",de,Ce)),ct||(ct=m(C(Te),"mouseup",De,Ce)))},Fe=Ut=>{ze(),nt&&nt(Ut)},De=Ut=>{Ke(),nt&&nt(Ut)},ze=()=>{xe&&xe(),Ie&&Ie(),Ae&&Ae(),xe=Ie=Ae=void 0},Ke=()=>{Ue&&Ue(),ct&&ct(),Ue=ct=void 0},Ht=()=>{ze(),Ke()},dn=(Ut=!0)=>{Ut?(oe||(oe=m(Te,"touchstart",ve,Ce)),ye||(ye=m(Te,"mousedown",me,Ce))):(oe&&oe(),ye&&ye(),oe=ye=void 0,Ht())};return{enable:dn,stop:Ht,destroy:()=>{dn(!1),nt=de=Me=void 0}}})(oe.el,mt=>{const an=be(mt);return!(de||!nt||(K(mt,Fe),Fe.startX=Fe.currentX,Fe.startY=Fe.currentY,Fe.startTime=Fe.currentTime=an,Fe.velocityX=Fe.velocityY=Fe.deltaX=Fe.deltaY=0,Fe.event=mt,xe&&!1===xe(Fe))||(ze.release(),!ze.start()))&&(de=!0,0===X?_n():(De.start(Fe.startX,Fe.startY),!0))},mt=>{Me?!Ce&&nt&&(Ce=!0,Pe(Fe,mt),requestAnimationFrame(dn)):(Pe(Fe,mt),De.detect(Fe.currentX,Fe.currentY)&&(!De.isGesture()||!_n())&&Qt())},ke,{capture:!1,passive:ve}),Qt=()=>{Ne(),it.stop(),Ue&&Ue(Fe)};return{enable(mt=!0){mt||(Me&&ke(void 0),Ne()),it.enable(mt)},destroy(){ze.destroy(),it.destroy()}}},Pe=(Te,Me)=>{if(!Me)return;const de=Te.currentX,nt=Te.currentY,Ce=Te.currentTime;K(Me,Te);const oe=Te.currentX,xe=Te.currentY,Ae=(Te.currentTime=be(Me))-Ce;if(Ae>0&&Ae<100){const Ue=(xe-nt)/Ae;Te.velocityX=(oe-de)/Ae*.7+.3*Te.velocityX,Te.velocityY=.7*Ue+.3*Te.velocityY}Te.deltaX=oe-Te.startX,Te.deltaY=xe-Te.startY,Te.event=Me},K=(Te,Me)=>{let de=0,nt=0;if(Te){const Ce=Te.changedTouches;if(Ce&&Ce.length>0){const oe=Ce[0];de=oe.clientX,nt=oe.clientY}else void 0!==Te.pageX&&(de=Te.pageX,nt=Te.pageY)}Me.currentX=de,Me.currentY=nt},be=Te=>Te.timeStamp||Date.now()},2400:(Bn,Ct,P)=>{"use strict";P.d(Ct,{a:()=>m,b:()=>te,p:()=>h});const h=(l,...B)=>console.warn(`[Ionic Warning]: ${l}`,...B),m=(l,...B)=>console.error(`[Ionic Error]: ${l}`,...B),te=(l,...B)=>console.error(`<${l.tagName.toLowerCase()}> must be used inside ${B.join(" or ")}.`)},1848:(Bn,Ct,P)=>{"use strict";P.d(Ct,{d:()=>m,w:()=>h});const h=typeof window<"u"?window:void 0,m=typeof document<"u"?document:void 0},4232:(Bn,Ct,P)=>{"use strict";P.d(Ct,{b:()=>Y,c:()=>C,d:()=>ie,e:()=>X,g:()=>Fe,l:()=>Ue,s:()=>ve,t:()=>K,w:()=>ct});var h=P(5861),m=P(9942),te=P(512);const Y="ionViewWillLeave",C="ionViewDidLeave",ie="ionViewWillUnload",K=De=>new Promise((ze,Ke)=>{(0,m.w)(()=>{be(De),Te(De).then(Ht=>{Ht.animation&&Ht.animation.destroy(),Me(De),ze(Ht)},Ht=>{Me(De),Ke(Ht)})})}),be=De=>{const ze=De.enteringEl,Ke=De.leavingEl;me(ze,Ke,De.direction),De.showGoBack?ze.classList.add("can-go-back"):ze.classList.remove("can-go-back"),ve(ze,!1),ze.style.setProperty("pointer-events","none"),Ke&&(ve(Ke,!1),Ke.style.setProperty("pointer-events","none"))},Te=function(){var De=(0,h.Z)(function*(ze){const Ke=yield de(ze);return Ke&&m.B.isBrowser?nt(Ke,ze):Ce(ze)});return function(Ke){return De.apply(this,arguments)}}(),Me=De=>{const ze=De.enteringEl,Ke=De.leavingEl;ze.classList.remove("ion-page-invisible"),ze.style.removeProperty("pointer-events"),void 0!==Ke&&(Ke.classList.remove("ion-page-invisible"),Ke.style.removeProperty("pointer-events"))},de=function(){var De=(0,h.Z)(function*(ze){return ze.leavingEl&&ze.animated&&0!==ze.duration?ze.animationBuilder?ze.animationBuilder:"ios"===ze.mode?(yield Promise.resolve().then(P.bind(P,4810))).iosTransitionAnimation:(yield Promise.resolve().then(P.bind(P,2655))).mdTransitionAnimation:void 0});return function(Ke){return De.apply(this,arguments)}}(),nt=function(){var De=(0,h.Z)(function*(ze,Ke){yield oe(Ke,!0);const Ht=ze(Ke.baseEl,Ke);Ae(Ke.enteringEl,Ke.leavingEl);const dn=yield Ie(Ht,Ke);return Ke.progressCallback&&Ke.progressCallback(void 0),dn&&ye(Ke.enteringEl,Ke.leavingEl),{hasCompleted:dn,animation:Ht}});return function(Ke,Ht){return De.apply(this,arguments)}}(),Ce=function(){var De=(0,h.Z)(function*(ze){const Ke=ze.enteringEl,Ht=ze.leavingEl;return yield oe(ze,!1),Ae(Ke,Ht),ye(Ke,Ht),{hasCompleted:!0}});return function(Ke){return De.apply(this,arguments)}}(),oe=function(){var De=(0,h.Z)(function*(ze,Ke){(void 0!==ze.deepWait?ze.deepWait:Ke)&&(yield Promise.all([X(ze.enteringEl),X(ze.leavingEl)])),yield xe(ze.viewIsReady,ze.enteringEl)});return function(Ke,Ht){return De.apply(this,arguments)}}(),xe=function(){var De=(0,h.Z)(function*(ze,Ke){ze&&(yield ze(Ke))});return function(Ke,Ht){return De.apply(this,arguments)}}(),Ie=(De,ze)=>{const Ke=ze.progressCallback,Ht=new Promise(dn=>{De.onFinish(_n=>dn(1===_n))});return Ke?(De.progressStart(!0),Ke(De)):De.play(),Ht},Ae=(De,ze)=>{Ue(ze,Y),Ue(De,"ionViewWillEnter")},ye=(De,ze)=>{Ue(De,"ionViewDidEnter"),Ue(ze,C)},Ue=(De,ze)=>{if(De){const Ke=new CustomEvent(ze,{bubbles:!1,cancelable:!1});De.dispatchEvent(Ke)}},ct=()=>new Promise(De=>(0,te.r)(()=>(0,te.r)(()=>De()))),X=function(){var De=(0,h.Z)(function*(ze){const Ke=ze;if(Ke){if(null!=Ke.componentOnReady){if(null!=(yield Ke.componentOnReady()))return}else if(null!=Ke.__registerHost)return void(yield new Promise(dn=>(0,te.r)(dn)));yield Promise.all(Array.from(Ke.children).map(X))}});return function(Ke){return De.apply(this,arguments)}}(),ve=(De,ze)=>{ze?(De.setAttribute("aria-hidden","true"),De.classList.add("ion-page-hidden")):(De.hidden=!1,De.removeAttribute("aria-hidden"),De.classList.remove("ion-page-hidden"))},me=(De,ze,Ke)=>{void 0!==De&&(De.style.zIndex="back"===Ke?"99":"101"),void 0!==ze&&(ze.style.zIndex="100")},Fe=De=>De.classList.contains("ion-page")?De:De.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")||De},5551:(Bn,Ct,P)=>{"use strict";P.d(Ct,{a:()=>K,b:()=>dn,c:()=>te,i:()=>_n});var h=P(9942);class m{constructor(){this.m=new Map}reset(We){this.m=new Map(Object.entries(We))}get(We,Ne){const ke=this.m.get(We);return void 0!==ke?ke:Ne}getBoolean(We,Ne=!1){const ke=this.m.get(We);return void 0===ke?Ne:"string"==typeof ke?"true"===ke:!!ke}getNumber(We,Ne){const ke=parseFloat(this.m.get(We));return isNaN(ke)?void 0!==Ne?Ne:NaN:ke}set(We,Ne){this.m.set(We,Ne)}}const te=new m,fe="ionic-persist-config",K=(Ut,We)=>("string"==typeof Ut&&(We=Ut,Ut=void 0),(Ut=>be(Ut))(Ut).includes(We)),be=(Ut=window)=>{if(typeof Ut>"u")return[];Ut.Ionic=Ut.Ionic||{};let We=Ut.Ionic.platforms;return null==We&&(We=Ut.Ionic.platforms=Te(Ut),We.forEach(Ne=>Ut.document.documentElement.classList.add(`plt-${Ne}`))),We},Te=Ut=>{const We=te.get("platform");return Object.keys(Ke).filter(Ne=>{const ke=We?.[Ne];return"function"==typeof ke?ke(Ut):Ke[Ne](Ut)})},de=Ut=>!!(De(Ut,/iPad/i)||De(Ut,/Macintosh/i)&&ye(Ut)),oe=Ut=>De(Ut,/android|sink/i),ye=Ut=>ze(Ut,"(any-pointer:coarse)"),ct=Ut=>X(Ut)||ve(Ut),X=Ut=>!!(Ut.cordova||Ut.phonegap||Ut.PhoneGap),ve=Ut=>{const We=Ut.Capacitor;return!!We?.isNative},De=(Ut,We)=>We.test(Ut.navigator.userAgent),ze=(Ut,We)=>{var Ne;return null===(Ne=Ut.matchMedia)||void 0===Ne?void 0:Ne.call(Ut,We).matches},Ke={ipad:de,iphone:Ut=>De(Ut,/iPhone/i),ios:Ut=>De(Ut,/iPhone|iPod/i)||de(Ut),android:oe,phablet:Ut=>{const We=Ut.innerWidth,Ne=Ut.innerHeight,ke=Math.min(We,Ne),it=Math.max(We,Ne);return ke>390&&ke<520&&it>620&&it<800},tablet:Ut=>{const We=Ut.innerWidth,Ne=Ut.innerHeight,ke=Math.min(We,Ne),it=Math.max(We,Ne);return de(Ut)||(Ut=>oe(Ut)&&!De(Ut,/mobile/i))(Ut)||ke>460&&ke<820&&it>780&&it<1400},cordova:X,capacitor:ve,electron:Ut=>De(Ut,/electron/i),pwa:Ut=>{var We;return!!(null!==(We=Ut.matchMedia)&&void 0!==We&&We.call(Ut,"(display-mode: standalone)").matches||Ut.navigator.standalone)},mobile:ye,mobileweb:Ut=>ye(Ut)&&!ct(Ut),desktop:Ut=>!ye(Ut),hybrid:ct};let Ht;const dn=Ut=>Ut&&(0,h.g)(Ut)||Ht,_n=(Ut={})=>{if(typeof window>"u")return;const We=window.document,Ne=window,ke=Ne.Ionic=Ne.Ionic||{},it={};Ut._ael&&(it.ael=Ut._ael),Ut._rel&&(it.rel=Ut._rel),Ut._ce&&(it.ce=Ut._ce),(0,h.a)(it);const Qt=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},(Ut=>{try{const We=Ut.sessionStorage.getItem(fe);return null!==We?JSON.parse(We):{}}catch{return{}}})(Ne)),{persistConfig:!1}),ke.config),(Ut=>{const We={};return Ut.location.search.slice(1).split("&").map(Ne=>Ne.split("=")).map(([Ne,ke])=>[decodeURIComponent(Ne),decodeURIComponent(ke)]).filter(([Ne])=>((Ut,We)=>Ut.substr(0,We.length)===We)(Ne,"ionic:")).map(([Ne,ke])=>[Ne.slice(6),ke]).forEach(([Ne,ke])=>{We[Ne]=ke}),We})(Ne)),Ut);te.reset(Qt),te.getBoolean("persistConfig")&&((Ut,We)=>{try{Ut.sessionStorage.setItem(fe,JSON.stringify(We))}catch{return}})(Ne,Qt),be(Ne),ke.config=te,ke.mode=Ht=te.get("mode",We.documentElement.getAttribute("mode")||(K(Ne,"ios")?"ios":"md")),te.set("mode",Ht),We.documentElement.setAttribute("mode",Ht),We.documentElement.classList.add(Ht),te.getBoolean("_testing")&&te.set("animated",!1);const mt=tt=>{var pt;return null===(pt=tt.tagName)||void 0===pt?void 0:pt.startsWith("ION-")},an=tt=>["ios","md"].includes(tt);(0,h.c)(tt=>{for(;tt;){const pt=tt.mode||tt.getAttribute("mode");if(pt){if(an(pt))return pt;mt(tt)&&console.warn('Invalid ionic mode: "'+pt+'", expected: "ios" or "md"')}tt=tt.parentElement}return Ht})}},4810:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{iosTransitionAnimation:()=>Te,shadow:()=>C});var h=P(4913),m=P(4232);P(1848),P(9942);const Y=de=>document.querySelector(`${de}.ion-cloned-element`),C=de=>de.shadowRoot||de,ie=de=>{const nt="ION-TABS"===de.tagName?de:de.querySelector("ion-tabs"),Ce="ion-content ion-header:not(.header-collapse-condense-inactive) ion-title.title-large";if(null!=nt){const oe=nt.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");return null!=oe?oe.querySelector(Ce):null}return de.querySelector(Ce)},fe=(de,nt)=>{const Ce="ION-TABS"===de.tagName?de:de.querySelector("ion-tabs");let oe=[];if(null!=Ce){const xe=Ce.querySelector("ion-tab:not(.tab-hidden), .ion-page:not(.ion-page-hidden)");null!=xe&&(oe=xe.querySelectorAll("ion-buttons"))}else oe=de.querySelectorAll("ion-buttons");for(const xe of oe){const Ie=xe.closest("ion-header"),Ae=Ie&&!Ie.classList.contains("header-collapse-condense-inactive"),ye=xe.querySelector("ion-back-button"),Ue=xe.classList.contains("buttons-collapse");if(null!==ye&&("start"===xe.slot||""===xe.slot)&&(Ue&&Ae&&nt||!Ue))return ye}return null},K=(de,nt,Ce,oe,xe,Ie,Ae,ye,Ue)=>{var ct,X;const ve=nt?`calc(100% - ${xe.right+4}px)`:xe.left-4+"px",me=nt?"right":"left",Fe=nt?"left":"right",De=nt?"right":"left",ze=(null===(ct=Ie.textContent)||void 0===ct?void 0:ct.trim())===(null===(X=ye.textContent)||void 0===X?void 0:X.trim()),Ht=(Ue.height-Me)/Ae.height,dn=ze?`scale(${Ue.width/Ae.width}, ${Ht})`:`scale(${Ht})`,_n="scale(1)",We=C(oe).querySelector("ion-icon").getBoundingClientRect(),Ne=nt?We.width/2-(We.right-xe.right)+"px":xe.left-We.width/2+"px",ke=nt?`-${window.innerWidth-xe.right}px`:`${xe.left}px`,it=`${Ue.top}px`,Qt=`${xe.top}px`,tt=Ce?[{offset:0,transform:`translate3d(${ke}, ${Qt}, 0)`},{offset:1,transform:`translate3d(${Ne}, ${it}, 0)`}]:[{offset:0,transform:`translate3d(${Ne}, ${it}, 0)`},{offset:1,transform:`translate3d(${ke}, ${Qt}, 0)`}],bn=Ce?[{offset:0,opacity:1,transform:_n},{offset:1,opacity:0,transform:dn}]:[{offset:0,opacity:0,transform:dn},{offset:1,opacity:1,transform:_n}],pe=Ce?[{offset:0,opacity:1,transform:"scale(1)"},{offset:.2,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:0,transform:"scale(0.6)"}]:[{offset:0,opacity:0,transform:"scale(0.6)"},{offset:.6,opacity:0,transform:"scale(0.6)"},{offset:1,opacity:1,transform:"scale(1)"}],lt=(0,h.c)(),Zt=(0,h.c)(),hn=(0,h.c)(),Yt=Y("ion-back-button"),Ft=C(Yt).querySelector(".button-text"),Un=C(Yt).querySelector("ion-icon");Yt.text=oe.text,Yt.mode=oe.mode,Yt.icon=oe.icon,Yt.color=oe.color,Yt.disabled=oe.disabled,Yt.style.setProperty("display","block"),Yt.style.setProperty("position","fixed"),Zt.addElement(Un),lt.addElement(Ft),hn.addElement(Yt),hn.beforeStyles({position:"absolute",top:"0px",[De]:"0px"}).keyframes(tt),lt.beforeStyles({"transform-origin":`${me} top`}).beforeAddWrite(()=>{oe.style.setProperty("display","none"),Yt.style.setProperty(me,ve)}).afterAddWrite(()=>{oe.style.setProperty("display",""),Yt.style.setProperty("display","none"),Yt.style.removeProperty(me)}).keyframes(bn),Zt.beforeStyles({"transform-origin":`${Fe} center`}).keyframes(pe),de.addAnimation([lt,Zt,hn])},be=(de,nt,Ce,oe,xe,Ie,Ae,ye)=>{var Ue,ct;const X=nt?"right":"left",ve=nt?`calc(100% - ${xe.right}px)`:`${xe.left}px`,Fe=`${xe.top}px`,ze=nt?`-${window.innerWidth-ye.right-8}px`:ye.x-8+"px",Ht=ye.y-2+"px",dn=(null===(Ue=Ae.textContent)||void 0===Ue?void 0:Ue.trim())===(null===(ct=oe.textContent)||void 0===ct?void 0:ct.trim()),Ut=ye.height/(Ie.height-Me),We="scale(1)",Ne=dn?`scale(${ye.width/Ie.width}, ${Ut})`:`scale(${Ut})`,Qt=Ce?[{offset:0,opacity:0,transform:`translate3d(${ze}, ${Ht}, 0) ${Ne}`},{offset:.1,opacity:0},{offset:1,opacity:1,transform:`translate3d(0px, ${Fe}, 0) ${We}`}]:[{offset:0,opacity:.99,transform:`translate3d(0px, ${Fe}, 0) ${We}`},{offset:.6,opacity:0},{offset:1,opacity:0,transform:`translate3d(${ze}, ${Ht}, 0) ${Ne}`}],mt=Y("ion-title"),an=(0,h.c)();mt.innerText=oe.innerText,mt.size=oe.size,mt.color=oe.color,an.addElement(mt),an.beforeStyles({"transform-origin":`${X} top`,height:`${xe.height}px`,display:"",position:"relative",[X]:ve}).beforeAddWrite(()=>{oe.style.setProperty("opacity","0")}).afterAddWrite(()=>{oe.style.setProperty("opacity",""),mt.style.setProperty("display","none")}).keyframes(Qt),de.addAnimation(an)},Te=(de,nt)=>{var Ce;try{const oe="cubic-bezier(0.32,0.72,0,1)",xe="opacity",Ie="transform",Ae="0%",Ue="rtl"===de.ownerDocument.dir,ct=Ue?"-99.5%":"99.5%",X=Ue?"33%":"-33%",ve=nt.enteringEl,me=nt.leavingEl,Fe="back"===nt.direction,De=ve.querySelector(":scope > ion-content"),ze=ve.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *"),Ke=ve.querySelectorAll(":scope > ion-header > ion-toolbar"),Ht=(0,h.c)(),dn=(0,h.c)();if(Ht.addElement(ve).duration((null!==(Ce=nt.duration)&&void 0!==Ce?Ce:0)||540).easing(nt.easing||oe).fill("both").beforeRemoveClass("ion-page-invisible"),me&&null!=de){const Ne=(0,h.c)();Ne.addElement(de),Ht.addAnimation(Ne)}if(De||0!==Ke.length||0!==ze.length?(dn.addElement(De),dn.addElement(ze)):dn.addElement(ve.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ht.addAnimation(dn),Fe?dn.beforeClearStyles([xe]).fromTo("transform",`translateX(${X})`,`translateX(${Ae})`).fromTo(xe,.8,1):dn.beforeClearStyles([xe]).fromTo("transform",`translateX(${ct})`,`translateX(${Ae})`),De){const Ne=C(De).querySelector(".transition-effect");if(Ne){const ke=Ne.querySelector(".transition-cover"),it=Ne.querySelector(".transition-shadow"),Qt=(0,h.c)(),mt=(0,h.c)(),an=(0,h.c)();Qt.addElement(Ne).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),mt.addElement(ke).beforeClearStyles([xe]).fromTo(xe,0,.1),an.addElement(it).beforeClearStyles([xe]).fromTo(xe,.03,.7),Qt.addAnimation([mt,an]),dn.addAnimation([Qt])}}const _n=ve.querySelector("ion-header.header-collapse-condense"),{forward:Ut,backward:We}=((de,nt,Ce,oe,xe)=>{const Ie=fe(oe,Ce),Ae=ie(xe),ye=ie(oe),Ue=fe(xe,Ce),ct=null!==Ie&&null!==Ae&&!Ce,X=null!==ye&&null!==Ue&&Ce;if(ct){const ve=Ae.getBoundingClientRect(),me=Ie.getBoundingClientRect(),Fe=C(Ie).querySelector(".button-text"),De=Fe.getBoundingClientRect(),Ke=C(Ae).querySelector(".toolbar-title").getBoundingClientRect();be(de,nt,Ce,Ae,ve,Ke,Fe,De),K(de,nt,Ce,Ie,me,Fe,De,Ae,Ke)}else if(X){const ve=ye.getBoundingClientRect(),me=Ue.getBoundingClientRect(),Fe=C(Ue).querySelector(".button-text"),De=Fe.getBoundingClientRect(),Ke=C(ye).querySelector(".toolbar-title").getBoundingClientRect();be(de,nt,Ce,ye,ve,Ke,Fe,De),K(de,nt,Ce,Ue,me,Fe,De,ye,Ke)}return{forward:ct,backward:X}})(Ht,Ue,Fe,ve,me);if(Ke.forEach(Ne=>{const ke=(0,h.c)();ke.addElement(Ne),Ht.addAnimation(ke);const it=(0,h.c)();it.addElement(Ne.querySelector("ion-title"));const Qt=(0,h.c)(),mt=Array.from(Ne.querySelectorAll("ion-buttons,[menuToggle]")),an=Ne.closest("ion-header"),tt=an?.classList.contains("header-collapse-condense-inactive");let pt;pt=mt.filter(Fe?pe=>{const lt=pe.classList.contains("buttons-collapse");return lt&&!tt||!lt}:pe=>!pe.classList.contains("buttons-collapse")),Qt.addElement(pt);const Xt=(0,h.c)();Xt.addElement(Ne.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])"));const bn=(0,h.c)();bn.addElement(C(Ne).querySelector(".toolbar-background"));const Cn=(0,h.c)(),It=Ne.querySelector("ion-back-button");if(It&&Cn.addElement(It),ke.addAnimation([it,Qt,Xt,bn,Cn]),Qt.fromTo(xe,.01,1),Xt.fromTo(xe,.01,1),Fe)tt||it.fromTo("transform",`translateX(${X})`,`translateX(${Ae})`).fromTo(xe,.01,1),Xt.fromTo("transform",`translateX(${X})`,`translateX(${Ae})`),Cn.fromTo(xe,.01,1);else if(_n||it.fromTo("transform",`translateX(${ct})`,`translateX(${Ae})`).fromTo(xe,.01,1),Xt.fromTo("transform",`translateX(${ct})`,`translateX(${Ae})`),bn.beforeClearStyles([xe,"transform"]),an?.translucent?bn.fromTo("transform",Ue?"translateX(-100%)":"translateX(100%)","translateX(0px)"):bn.fromTo(xe,.01,"var(--opacity)"),Ut||Cn.fromTo(xe,.01,1),It&&!Ut){const lt=(0,h.c)();lt.addElement(C(It).querySelector(".button-text")).fromTo("transform",Ue?"translateX(-100px)":"translateX(100px)","translateX(0px)"),ke.addAnimation(lt)}}),me){const Ne=(0,h.c)(),ke=me.querySelector(":scope > ion-content"),it=me.querySelectorAll(":scope > ion-header > ion-toolbar"),Qt=me.querySelectorAll(":scope > ion-header > *:not(ion-toolbar), :scope > ion-footer > *");if(ke||0!==it.length||0!==Qt.length?(Ne.addElement(ke),Ne.addElement(Qt)):Ne.addElement(me.querySelector(":scope > .ion-page, :scope > ion-nav, :scope > ion-tabs")),Ht.addAnimation(Ne),Fe){Ne.beforeClearStyles([xe]).fromTo("transform",`translateX(${Ae})`,Ue?"translateX(-100%)":"translateX(100%)");const mt=(0,m.g)(me);Ht.afterAddWrite(()=>{"normal"===Ht.getDirection()&&mt.style.setProperty("display","none")})}else Ne.fromTo("transform",`translateX(${Ae})`,`translateX(${X})`).fromTo(xe,1,.8);if(ke){const mt=C(ke).querySelector(".transition-effect");if(mt){const an=mt.querySelector(".transition-cover"),tt=mt.querySelector(".transition-shadow"),pt=(0,h.c)(),Xt=(0,h.c)(),bn=(0,h.c)();pt.addElement(mt).beforeStyles({opacity:"1",display:"block"}).afterStyles({opacity:"",display:""}),Xt.addElement(an).beforeClearStyles([xe]).fromTo(xe,.1,0),bn.addElement(tt).beforeClearStyles([xe]).fromTo(xe,.7,.03),pt.addAnimation([Xt,bn]),Ne.addAnimation([pt])}}it.forEach(mt=>{const an=(0,h.c)();an.addElement(mt);const tt=(0,h.c)();tt.addElement(mt.querySelector("ion-title"));const pt=(0,h.c)(),Xt=mt.querySelectorAll("ion-buttons,[menuToggle]"),bn=mt.closest("ion-header"),Cn=bn?.classList.contains("header-collapse-condense-inactive"),It=Array.from(Xt).filter(Ft=>{const Un=Ft.classList.contains("buttons-collapse");return Un&&!Cn||!Un});pt.addElement(It);const pe=(0,h.c)(),lt=mt.querySelectorAll(":scope > *:not(ion-title):not(ion-buttons):not([menuToggle])");lt.length>0&&pe.addElement(lt);const Zt=(0,h.c)();Zt.addElement(C(mt).querySelector(".toolbar-background"));const hn=(0,h.c)(),Yt=mt.querySelector("ion-back-button");if(Yt&&hn.addElement(Yt),an.addAnimation([tt,pt,pe,hn,Zt]),Ht.addAnimation(an),hn.fromTo(xe,.99,0),pt.fromTo(xe,.99,0),pe.fromTo(xe,.99,0),Fe){if(Cn||tt.fromTo("transform",`translateX(${Ae})`,Ue?"translateX(-100%)":"translateX(100%)").fromTo(xe,.99,0),pe.fromTo("transform",`translateX(${Ae})`,Ue?"translateX(-100%)":"translateX(100%)"),Zt.beforeClearStyles([xe,"transform"]),bn?.translucent?Zt.fromTo("transform","translateX(0px)",Ue?"translateX(-100%)":"translateX(100%)"):Zt.fromTo(xe,"var(--opacity)",0),Yt&&!We){const Un=(0,h.c)();Un.addElement(C(Yt).querySelector(".button-text")).fromTo("transform",`translateX(${Ae})`,`translateX(${(Ue?-124:124)+"px"})`),an.addAnimation(Un)}}else Cn||tt.fromTo("transform",`translateX(${Ae})`,`translateX(${X})`).fromTo(xe,.99,0).afterClearStyles([Ie,xe]),pe.fromTo("transform",`translateX(${Ae})`,`translateX(${X})`).afterClearStyles([Ie,xe]),hn.afterClearStyles([xe]),tt.afterClearStyles([xe]),pt.afterClearStyles([xe])})}return Ht}catch(oe){throw oe}},Me=10},2655:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{mdTransitionAnimation:()=>B});var h=P(4913),m=P(4232);P(1848),P(9942);const B=(Y,C)=>{var ie,fe,Pe;const K="40px",Te="back"===C.direction,de=C.leavingEl,nt=(0,m.g)(C.enteringEl),Ce=nt.querySelector("ion-toolbar"),oe=(0,h.c)();if(oe.addElement(nt).fill("both").beforeRemoveClass("ion-page-invisible"),Te?oe.duration((null!==(ie=C.duration)&&void 0!==ie?ie:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)"):oe.duration((null!==(fe=C.duration)&&void 0!==fe?fe:0)||280).easing("cubic-bezier(0.36,0.66,0.04,1)").fromTo("transform",`translateY(${K})`,"translateY(0px)").fromTo("opacity",.01,1),Ce){const xe=(0,h.c)();xe.addElement(Ce),oe.addAnimation(xe)}if(de&&Te){oe.duration((null!==(Pe=C.duration)&&void 0!==Pe?Pe:0)||200).easing("cubic-bezier(0.47,0,0.745,0.715)");const xe=(0,h.c)();xe.addElement((0,m.g)(de)).onFinish(Ie=>{1===Ie&&xe.elements.length>0&&xe.elements[0].style.setProperty("display","none")}).fromTo("transform","translateY(0px)",`translateY(${K})`).fromTo("opacity",1,0),oe.addAnimation(xe)}return oe}},2936:(Bn,Ct,P)=>{"use strict";P.d(Ct,{B:()=>tt,G:()=>pt,O:()=>Xt,a:()=>be,b:()=>Te,c:()=>Ce,d:()=>bn,e:()=>Cn,f:()=>dn,g:()=>Ut,h:()=>ke,i:()=>Qt,j:()=>xe,k:()=>Ie,l:()=>Me,m:()=>de,n:()=>Pe,o:()=>Ue,q:()=>Ke,s:()=>an,t:()=>oe});var h=P(5861),m=P(1848),te=P(5551),l=P(3254),B=P(4393),Y=P(512),C=P(2400);let ie=0,fe=0;const Pe=new WeakMap,K=It=>({create:pe=>Ae(It,pe),dismiss:(pe,lt,Zt)=>Fe(document,pe,lt,It,Zt),getTop:()=>(0,h.Z)(function*(){return Ke(document,It)})()}),be=K("ion-alert"),Te=K("ion-action-sheet"),Me=K("ion-loading"),de=K("ion-modal"),Ce=K("ion-popover"),oe=K("ion-toast"),xe=It=>{typeof document<"u"&&me(document);const pe=ie++;It.overlayIndex=pe},Ie=It=>(It.hasAttribute("id")||(It.id="ion-overlay-"+ ++fe),It.id),Ae=(It,pe)=>typeof window<"u"&&typeof window.customElements<"u"?window.customElements.whenDefined(It).then(()=>{const lt=document.createElement(It);return lt.classList.add("overlay-hidden"),Object.assign(lt,Object.assign(Object.assign({},pe),{hasController:!0})),We(document).appendChild(lt),new Promise(Zt=>(0,Y.c)(lt,Zt))}):Promise.resolve(),ye='[tabindex]:not([tabindex^="-"]):not([hidden]):not([disabled]), input:not([type=hidden]):not([tabindex^="-"]):not([hidden]):not([disabled]), textarea:not([tabindex^="-"]):not([hidden]):not([disabled]), button:not([tabindex^="-"]):not([hidden]):not([disabled]), select:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable:not([tabindex^="-"]):not([hidden]):not([disabled]), .ion-focusable[disabled="false"]:not([tabindex^="-"]):not([hidden])',Ue=(It,pe)=>{let lt=It.querySelector(ye);const Zt=lt?.shadowRoot;Zt&&(lt=Zt.querySelector(ye)||lt),lt?(0,Y.f)(lt):pe.focus()},X=(It,pe)=>{const lt=Array.from(It.querySelectorAll(ye));let Zt=lt.length>0?lt[lt.length-1]:null;const hn=Zt?.shadowRoot;hn&&(Zt=hn.querySelector(ye)||Zt),Zt?Zt.focus():pe.focus()},me=It=>{0===ie&&(ie=1,It.addEventListener("focus",pe=>{((It,pe)=>{const lt=Ke(pe,"ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover"),Zt=It.target;lt&&Zt&&!lt.classList.contains("ion-disable-focus-trap")&&(lt.shadowRoot?(()=>{if(lt.contains(Zt))lt.lastFocus=Zt;else{const Ft=lt.lastFocus;Ue(lt,lt),Ft===pe.activeElement&&X(lt,lt),lt.lastFocus=pe.activeElement}})():(()=>{if(lt===Zt)lt.lastFocus=void 0;else{const Ft=(0,Y.g)(lt);if(!Ft.contains(Zt))return;const Un=Ft.querySelector(".ion-overlay-wrapper");if(!Un)return;if(Un.contains(Zt)||Zt===Ft.querySelector("ion-backdrop"))lt.lastFocus=Zt;else{const Ve=lt.lastFocus;Ue(Un,lt),Ve===pe.activeElement&&X(Un,lt),lt.lastFocus=pe.activeElement}}})())})(pe,It)},!0),It.addEventListener("ionBackButton",pe=>{const lt=Ke(It);lt?.backdropDismiss&&pe.detail.register(B.OVERLAY_BACK_BUTTON_PRIORITY,()=>lt.dismiss(void 0,tt))}),It.addEventListener("keydown",pe=>{if("Escape"===pe.key){const lt=Ke(It);lt?.backdropDismiss&&lt.dismiss(void 0,tt)}}))},Fe=(It,pe,lt,Zt,hn)=>{const Yt=Ke(It,Zt,hn);return Yt?Yt.dismiss(pe,lt):Promise.reject("overlay does not exist")},ze=(It,pe)=>((It,pe)=>(void 0===pe&&(pe="ion-alert,ion-action-sheet,ion-loading,ion-modal,ion-picker,ion-popover,ion-toast"),Array.from(It.querySelectorAll(pe)).filter(lt=>lt.overlayIndex>0)))(It,pe).filter(lt=>!(It=>It.classList.contains("overlay-hidden"))(lt)),Ke=(It,pe,lt)=>{const Zt=ze(It,pe);return void 0===lt?Zt[Zt.length-1]:Zt.find(hn=>hn.id===lt)},Ht=(It=!1)=>{const lt=We(document).querySelector("ion-router-outlet, ion-nav, #ion-view-container-root");lt&&(It?lt.setAttribute("aria-hidden","true"):lt.removeAttribute("aria-hidden"))},dn=function(){var It=(0,h.Z)(function*(pe,lt,Zt,hn,Yt){var Ft,Un;if(pe.presented)return;Ht(!0),pe.presented=!0,pe.willPresent.emit(),null===(Ft=pe.willPresentShorthand)||void 0===Ft||Ft.emit();const Ve=(0,te.b)(pe),Pt=pe.enterAnimation?pe.enterAnimation:te.c.get(lt,"ios"===Ve?Zt:hn);(yield Ne(pe,Pt,pe.el,Yt))&&(pe.didPresent.emit(),null===(Un=pe.didPresentShorthand)||void 0===Un||Un.emit()),"ION-TOAST"!==pe.el.tagName&&_n(pe.el),pe.keyboardClose&&(null===document.activeElement||!pe.el.contains(document.activeElement))&&pe.el.focus()});return function(lt,Zt,hn,Yt,Ft){return It.apply(this,arguments)}}(),_n=function(){var It=(0,h.Z)(function*(pe){let lt=document.activeElement;if(!lt)return;const Zt=lt?.shadowRoot;Zt&&(lt=Zt.querySelector(ye)||lt),yield pe.onDidDismiss(),lt.focus()});return function(lt){return It.apply(this,arguments)}}(),Ut=function(){var It=(0,h.Z)(function*(pe,lt,Zt,hn,Yt,Ft,Un){var Ve,Pt;if(!pe.presented)return!1;void 0!==m.d&&1===ze(m.d).length&&Ht(!1),pe.presented=!1;try{pe.el.style.setProperty("pointer-events","none"),pe.willDismiss.emit({data:lt,role:Zt}),null===(Ve=pe.willDismissShorthand)||void 0===Ve||Ve.emit({data:lt,role:Zt});const Kt=(0,te.b)(pe),wn=pe.leaveAnimation?pe.leaveAnimation:te.c.get(hn,"ios"===Kt?Yt:Ft);Zt!==pt&&(yield Ne(pe,wn,pe.el,Un)),pe.didDismiss.emit({data:lt,role:Zt}),null===(Pt=pe.didDismissShorthand)||void 0===Pt||Pt.emit({data:lt,role:Zt}),Pe.delete(pe),pe.el.classList.add("overlay-hidden"),pe.el.style.removeProperty("pointer-events"),void 0!==pe.el.lastFocus&&(pe.el.lastFocus=void 0)}catch(Kt){console.error(Kt)}return pe.el.remove(),!0});return function(lt,Zt,hn,Yt,Ft,Un,Ve){return It.apply(this,arguments)}}(),We=It=>It.querySelector("ion-app")||It.body,Ne=function(){var It=(0,h.Z)(function*(pe,lt,Zt,hn){Zt.classList.remove("overlay-hidden");const Ft=lt(pe.el,hn);(!pe.animated||!te.c.getBoolean("animated",!0))&&Ft.duration(0),pe.keyboardClose&&Ft.beforeAddWrite(()=>{const Ve=Zt.ownerDocument.activeElement;Ve?.matches("input,ion-input, ion-textarea")&&Ve.blur()});const Un=Pe.get(pe)||[];return Pe.set(pe,[...Un,Ft]),yield Ft.play(),!0});return function(lt,Zt,hn,Yt){return It.apply(this,arguments)}}(),ke=(It,pe)=>{let lt;const Zt=new Promise(hn=>lt=hn);return it(It,pe,hn=>{lt(hn.detail)}),Zt},it=(It,pe,lt)=>{const Zt=hn=>{(0,Y.b)(It,pe,Zt),lt(hn)};(0,Y.a)(It,pe,Zt)},Qt=It=>"cancel"===It||It===tt,mt=It=>It(),an=(It,pe)=>{if("function"==typeof It)return te.c.get("_zoneGate",mt)(()=>{try{return It(pe)}catch(Zt){throw Zt}})},tt="backdrop",pt="gesture",Xt=39,bn=It=>{let lt,pe=!1;const Zt=(0,l.C)(),hn=(Un=!1)=>{if(lt&&!Un)return{delegate:lt,inline:pe};const{el:Ve,hasController:Pt,delegate:Kt}=It;return pe=null!==Ve.parentNode&&!Pt,lt=pe?Kt||Zt:Kt,{inline:pe,delegate:lt}};return{attachViewToDom:function(){var Un=(0,h.Z)(function*(Ve){const{delegate:Pt}=hn(!0);if(Pt)return yield Pt.attachViewToDom(It.el,Ve);const{hasController:Kt}=It;if(Kt&&void 0!==Ve)throw new Error("framework delegate is missing");return null});return function(Pt){return Un.apply(this,arguments)}}(),removeViewFromDom:()=>{const{delegate:Un}=hn();Un&&void 0!==It.el&&Un.removeViewFromDom(It.el.parentElement,It.el)}}},Cn=()=>{let It;const pe=()=>{It&&(It(),It=void 0)};return{addClickListener:(Zt,hn)=>{pe();const Yt=void 0!==hn?document.getElementById(hn):null;Yt?It=((Un,Ve)=>{const Pt=()=>{Ve.present()};return Un.addEventListener("click",Pt),()=>{Un.removeEventListener("click",Pt)}})(Yt,Zt):(0,C.p)(`A trigger element with the ID "${hn}" was not found in the DOM. The trigger element must be in the DOM when the "trigger" property is set on an overlay component.`,Zt)},removeClickListener:pe}}},1163:(Bn,Ct,P)=>{"use strict";P.d(Ct,{B:()=>be});var h=P(9212),m=P(866),te=P(6814),l=P(451);function B(Te,Me){if(1&Te&&(h.TgZ(0,"ion-badge",7),h._uU(1),h.qZA()),2&Te){const de=h.oxw().$implicit;h.xp6(),h.hij("",de.Quantity," x")}}function Y(Te,Me){if(1&Te&&(h.TgZ(0,"strong"),h._uU(1),h.qZA()),2&Te){const de=h.oxw().$implicit;h.xp6(),h.hij("",de.PowerKW," kW ")}}function C(Te,Me){if(1&Te&&(h.TgZ(0,"div"),h._uU(1),h.qZA()),2&Te){const de=h.oxw().$implicit;h.xp6(),h.hij("",null==de.CurrentType?null:de.CurrentType.Title," ")}}function ie(Te,Me){if(1&Te&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&Te){const de=h.oxw().$implicit;h.xp6(),h.hij("",de.Amps,"A ")}}function fe(Te,Me){if(1&Te&&(h.TgZ(0,"span"),h._uU(1),h.qZA()),2&Te){const de=h.oxw().$implicit;h.xp6(),h.hij("",de.Voltage,"V ")}}function Pe(Te,Me){if(1&Te){const de=h.EpF();h.TgZ(0,"ion-col")(1,"ion-button",8),h.NdJ("click",function(){h.CHM(de);const Ce=h.oxw().$implicit,oe=h.oxw();return h.KtG(oe.editConnection(Ce))}),h._UZ(2,"ion-icon",9),h.qZA(),h._UZ(3,"br"),h.TgZ(4,"ion-button",10),h.NdJ("click",function(){h.CHM(de);const Ce=h.oxw().$implicit,oe=h.oxw();return h.KtG(oe.deleteConnection(Ce))}),h._UZ(5,"ion-icon",11),h.qZA()()}}function K(Te,Me){if(1&Te&&(h.TgZ(0,"ion-row")(1,"ion-col")(2,"ion-row")(3,"ion-col",1),h._UZ(4,"img",2),h.YNc(5,B,2,1,"ion-badge",3),h.TgZ(6,"div",4),h._uU(7),h.qZA()(),h.TgZ(8,"ion-col")(9,"ion-row")(10,"ion-col")(11,"ion-note")(12,"div")(13,"strong",5),h._uU(14),h.qZA()(),h.YNc(15,Y,2,1,"strong",6)(16,C,2,1,"div",6),h.qZA(),h.TgZ(17,"ion-note"),h.YNc(18,ie,2,1,"span",6)(19,fe,2,1,"span",6),h.qZA()()(),h.TgZ(20,"ion-row")(21,"ion-col",4),h._uU(22),h.qZA(),h.TgZ(23,"ion-col",4),h._uU(24),h.qZA()()(),h.YNc(25,Pe,6,0,"ion-col",6),h.qZA()()()),2&Te){const de=Me.$implicit,nt=h.oxw();h.xp6(4),h.Q6J("src",nt.getConnectorTypeIcon(de.ConnectionTypeID),h.LSH),h.xp6(),h.Q6J("ngIf",de.Quantity),h.xp6(2),h.Oqu(null==de.StatusType?null:de.StatusType.Title),h.xp6(6),h.s9C("title",null==de.ConnectionType?null:de.ConnectionType.FormalName),h.xp6(),h.hij("",null==de.ConnectionType?null:de.ConnectionType.Title," "),h.xp6(),h.Q6J("ngIf",de.PowerKW),h.xp6(),h.Q6J("ngIf",de.CurrentTypeID),h.xp6(2),h.Q6J("ngIf",de.Amps),h.xp6(),h.Q6J("ngIf",de.Voltage),h.xp6(3),h.Oqu(de.Reference),h.xp6(2),h.Oqu(de.Comments),h.xp6(),h.Q6J("ngIf",nt.enableEdit)}}let be=(()=>{class Te{item;enableEdit=!1;onEdit=new h.vpe;onDelete=new h.vpe;constructor(){}ngOnInit(){}editConnection(de){this.onEdit.emit(de)}deleteConnection(de){this.onDelete.emit(de)}getConnectorTypeIcon(de){return m.c.getIconForConnector(de)}static \u0275fac=function(nt){return new(nt||Te)};static \u0275cmp=h.Xpm({type:Te,selectors:[["app-equipment-details"]],inputs:{item:"item",enableEdit:"enableEdit"},outputs:{onEdit:"onEdit",onDelete:"onDelete"},decls:2,vars:1,consts:[[4,"ngFor","ngForOf"],["size","3"],[2,"max-width","64px",3,"src"],["color","primary",4,"ngIf"],[1,"info"],[3,"title"],[4,"ngIf"],["color","primary"],["size","small","color","secondary",3,"click"],["name","create","slot","icon-only"],["size","small","color","danger",3,"click"],["name","trash","slot","icon-only"]],template:function(nt,Ce){1&nt&&(h.TgZ(0,"ion-grid"),h.YNc(1,K,26,12,"ion-row",0),h.qZA()),2&nt&&(h.xp6(),h.Q6J("ngForOf",Ce.item.Connections))},dependencies:[te.sg,te.O5,l.yp,l.YG,l.wI,l.jY,l.gu,l.uN,l.Nd]})}return Te})()},6086:(Bn,Ct,P)=>{"use strict";P.d(Ct,{z:()=>nt});var h=P(5861),m=P(9212),te=P(9159),l=P(6814),B=P(451),Y=P(6223);function C(Ce,oe){if(1&Ce&&(m.TgZ(0,"ion-select-option",5),m._uU(1),m.qZA()),2&Ce){const xe=oe.$implicit;m.Q6J("value",xe.ID),m.xp6(),m.Oqu(xe.Title)}}function ie(Ce,oe){1&Ce&&(m.TgZ(0,"ion-select-option",6),m._uU(1,"Other..."),m.qZA())}function fe(Ce,oe){if(1&Ce){const xe=m.EpF();m.TgZ(0,"ion-item")(1,"ion-label",1),m._uU(2,"Network Operator"),m.qZA(),m.TgZ(3,"ion-select",2),m.NdJ("ngModelChange",function(Ae){m.CHM(xe);const ye=m.oxw();return m.KtG(ye.operatorId=Ae)})("ionChange",function(){m.CHM(xe);const Ae=m.oxw();return m.KtG(Ae.onOperatorChange())}),m.YNc(4,C,2,2,"ion-select-option",3)(5,ie,2,0,"ion-select-option",4),m.qZA()()}if(2&Ce){const xe=m.oxw();m.xp6(3),m.Q6J("ngModel",xe.operatorId),m.xp6(),m.Q6J("ngForOf",xe.operators),m.xp6(),m.Q6J("ngIf",xe.useFilteredOperators)}}function Pe(Ce,oe){if(1&Ce){const xe=m.EpF();m.TgZ(0,"ion-item")(1,"ion-searchbar",7),m.NdJ("ionCancel",function(){m.CHM(xe);const Ae=m.oxw();return m.KtG(Ae.cancelOperatorLookup())})("ngModelChange",function(Ae){m.CHM(xe);const ye=m.oxw();return m.KtG(ye.operatorSearchKeyword=Ae)})("ionInput",function(Ae){m.CHM(xe);const ye=m.oxw();return m.KtG(ye.searchOperators(Ae))}),m.qZA()()}if(2&Ce){const xe=m.oxw();m.xp6(),m.Q6J("ngModel",xe.operatorSearchKeyword)}}function K(Ce,oe){if(1&Ce){const xe=m.EpF();m.TgZ(0,"ion-item",9),m.NdJ("click",function(){const ye=m.CHM(xe).$implicit,Ue=m.oxw(2);return m.KtG(Ue.onOperatorChange(ye))}),m.TgZ(1,"ion-avatar",10),m._UZ(2,"ion-icon",11),m.qZA(),m.TgZ(3,"ion-label")(4,"p"),m._uU(5),m.qZA(),m.TgZ(6,"p"),m._uU(7),m.qZA()()()}if(2&Ce){const xe=oe.$implicit;m.xp6(5),m.Oqu(xe.Title),m.xp6(2),m.Oqu(xe.WebsiteURL)}}function be(Ce,oe){if(1&Ce&&(m.ynx(0),m.TgZ(1,"ion-list"),m.YNc(2,K,8,2,"ion-item",8),m.qZA(),m.BQk()),2&Ce){const xe=m.oxw();m.xp6(2),m.Q6J("ngForOf",xe.operatorSearchResults)}}function Te(Ce,oe){if(1&Ce){const xe=m.EpF();m.ynx(0),m.TgZ(1,"ion-item")(2,"ion-avatar",10),m._UZ(3,"ion-icon",12),m.qZA(),m.TgZ(4,"ion-label")(5,"p"),m._uU(6),m.qZA(),m.TgZ(7,"p"),m._uU(8),m.qZA(),m.TgZ(9,"ion-button",9),m.NdJ("click",function(){m.CHM(xe);const Ae=m.oxw();return m.KtG(Ae.selectedOperator=null)}),m._uU(10,"Change"),m.qZA()()(),m.BQk()}if(2&Ce){const xe=m.oxw();m.xp6(6),m.Oqu(xe.selectedOperator.Title),m.xp6(2),m.Oqu(xe.selectedOperator.WebsiteURL)}}function Me(Ce,oe){if(1&Ce){const xe=m.EpF();m.TgZ(0,"ion-chip")(1,"ion-label"),m._uU(2),m.qZA(),m.TgZ(3,"ion-icon",14),m.NdJ("click",function(){const ye=m.CHM(xe).$implicit,Ue=m.oxw(2);return m.KtG(Ue.removeOperator(ye))}),m.qZA()()}if(2&Ce){const xe=oe.$implicit,Ie=m.oxw(2);m.xp6(2),m.Oqu(Ie.getOperatorInfo(xe).Title)}}function de(Ce,oe){if(1&Ce&&(m.ynx(0),m.YNc(1,Me,4,1,"ion-chip",13),m.BQk()),2&Ce){const xe=m.oxw();m.xp6(),m.Q6J("ngForOf",xe.operatorList)}}let nt=(()=>{class Ce{referenceDataManager;changeDetector;operatorId=null;operatorList=null;mode="single";useFilteredOperators=null;operatorChanged=new m.vpe;operatorRemoved=new m.vpe;operatorCache=[];operatorSearchResults=[];operatorSearchKeyword="";selectedOperator=null;get operators(){return this.referenceDataManager.getNetworkOperators(this.useFilteredOperators)}constructor(xe,Ie){this.referenceDataManager=xe,this.changeDetector=Ie}ngOnInit(){this.operatorCache=this.referenceDataManager.getNetworkOperators(!1),null!=this.operatorId&&(this.selectedOperator=this.operatorCache.find(xe=>xe.ID==this.operatorId))}searchOperators(){this.operatorSearchResults=[],0!=this.operatorSearchKeyword.length&&(this.operatorSearchResults=this.operatorCache?this.operatorCache.filter(xe=>xe.Title.toLowerCase().startsWith(this.operatorSearchKeyword.toLowerCase())||xe.Title.toLowerCase().startsWith("("+this.operatorSearchKeyword.toLowerCase())).slice(0,10):[])}getOperatorInfo(xe){if(this.operatorCache)return this.operatorCache.find(Ie=>Ie.ID==xe)}onOperatorChange(xe=null){var Ie=this;return(0,h.Z)(function*(){null==xe&&Ie.operatorId&&(xe=Ie.operatorCache.find(Ae=>Ae.ID==Ie.operatorId)),null!=xe&&(Ie.operatorSearchResults=[],Ie.selectedOperator=xe,Ie.operatorId=xe.ID),Ie.operatorId?(Ie.operatorChanged.emit(Ie.selectedOperator),"single"!=Ie.mode&&(Ie.selectedOperator=null,Ie.operatorSearchKeyword="")):Ie.useFilteredOperators=!1})()}removeOperator(xe){var Ie=this;return(0,h.Z)(function*(){Ie.operatorId=null,Ie.operatorRemoved.emit(xe)})()}cancelOperatorLookup(){this.selectedOperator=null}static \u0275fac=function(Ie){return new(Ie||Ce)(m.Y36(te.W),m.Y36(m.sBO))};static \u0275cmp=m.Xpm({type:Ce,selectors:[["app-operator-lookup"]],inputs:{operatorId:"operatorId",operatorList:"operatorList",mode:"mode",useFilteredOperators:"useFilteredOperators"},outputs:{operatorChanged:"operatorChanged",operatorRemoved:"operatorRemoved"},decls:5,vars:5,consts:[[4,"ngIf"],["position","floating"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["value","",4,"ngIf"],[3,"value"],["value",""],["placeholder","Search network operators","showCancelButton","focus","autocomplete","on",3,"ngModel","ionCancel","ngModelChange","ionInput"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["item-left",""],["name","card"],["name","locate"],[4,"ngFor","ngForOf"],["name","close-circle",3,"click"]],template:function(Ie,Ae){1&Ie&&m.YNc(0,fe,6,3,"ion-item",0)(1,Pe,2,1,"ion-item",0)(2,be,3,1,"ng-container",0)(3,Te,11,2,"ng-container",0)(4,de,2,1,"ng-container",0),2&Ie&&(m.Q6J("ngIf",Ae.useFilteredOperators&&!Ae.selectedOperator),m.xp6(),m.Q6J("ngIf",!Ae.useFilteredOperators&&!Ae.selectedOperator),m.xp6(),m.Q6J("ngIf",Ae.operatorSearchResults.length>0),m.xp6(),m.Q6J("ngIf",null!=Ae.selectedOperator),m.xp6(),m.Q6J("ngIf",(null==Ae.operatorList?null:Ae.operatorList.length)>0))},dependencies:[l.sg,l.O5,B.BJ,B.YG,B.hM,B.gu,B.Ie,B.Q$,B.q_,B.VI,B.t9,B.n0,B.QI,B.j9,Y.JJ,Y.On]})}return Ce})()},5460:(Bn,Ct,P)=>{"use strict";P.d(Ct,{v:()=>de});var h=P(5861),m=P(9127),te=P(2117),l=P(9212),B=P(9903),Y=P(3052),C=P(7346),ie=P(451),fe=P(9862),Pe=P(5957),K=P(6814);function be(nt,Ce){1&nt&&(l.TgZ(0,"div"),l._UZ(1,"ion-spinner"),l.qZA())}function Te(nt,Ce){if(1&nt){const oe=l.EpF();l.TgZ(0,"ion-item",5),l.NdJ("click",function(){const Ae=l.CHM(oe).$implicit,ye=l.oxw(2);return l.KtG(ye.placeSelected(Ae))}),l.TgZ(1,"ion-avatar",6),l._UZ(2,"ion-icon",7),l.qZA(),l.TgZ(3,"ion-label")(4,"p"),l._uU(5),l.qZA()()()}if(2&nt){const oe=Ce.$implicit;l.xp6(5),l.Oqu(oe.Address)}}function Me(nt,Ce){if(1&nt&&(l.TgZ(0,"div",1),l.YNc(1,be,2,0,"div",2),l.TgZ(2,"ion-list"),l.YNc(3,Te,6,1,"ion-item",3),l.TgZ(4,"ion-item")(5,"p",4),l._uU(6),l.qZA()()()()),2&nt){const oe=l.oxw();l.xp6(),l.Q6J("ngIf",oe.searchInProgress),l.xp6(2),l.Q6J("ngForOf",oe.placeList),l.xp6(3),l.hij(" ",oe.placeAttribution," ")}}let de=(()=>{class nt{logging;changeDetector;platform;http;events;placeSearchType;placeList;searchInProgress=!1;searchKeyword;placeSearchFocused;placeSearchActive=!1;placeAttribution="";selectedPlace;placeChanged=new l.vpe;mapService;constructor(oe,xe,Ie,Ae,ye){this.logging=oe,this.changeDetector=xe,this.platform=Ie,this.http=Ae,this.events=ye,this.searchKeyword="",this.searchInProgress=!1,this.mapService=new B.k(ye,oe,Ae)}ngOnInit(){var oe=this;return(0,h.Z)(function*(){yield oe.platform.ready(),oe.mapService.initAPI()})()}onSearchFocus(){this.placeSearchFocused=!0}onSearchBlur(){this.placeSearchFocused=!1}onSearchCancel(){}getPlacesAutoComplete(oe,xe){var Ie=this;return(0,h.Z)(function*(){Ie.placeSearchType=xe;let Ae=oe.target.value;if(Ae&&Ae.length>3){Ie.logging.log("Starting place lookup for:"+Ae),Ie.placeSearchActive=!0,Ie.searchInProgress=!0,Ie.searchInProgress=!1,Ie.placeSearchActive=!0;try{Ie.placeList=yield Ie.mapService.placeSearch(Ae),Ie.placeList&&Ie.placeList.length>0&&(Ie.placeAttribution=Ie.placeList[0].Attribution);let ye=yield Ie.detectAlternativeSearchResultType(Ae);ye&&Ie.placeList.unshift(ye)}catch{}Ie.searchInProgress=!1,Ie.placeSearchActive=!0}else Ie.searchInProgress=!1,Ie.placeSearchActive=!1})()}ConvertDMSToDD(oe,xe,Ie,Ae){var ye=Number(oe)+Number(xe)/60+Number(Ie)/3600;return("S"==Ae||"W"==Ae)&&(ye*=-1),ye}ParseDMS(oe){try{var xe=oe.split(/[^\d\w\.]+/),Ie=this.ConvertDMSToDD(xe[0],xe[1],xe[2],xe[3]),Ae=this.ConvertDMSToDD(xe[4],xe[5],xe[6],xe[7]);return new Y.wC(Ie,Ae)}catch{return null}}detectAlternativeSearchResultType(oe){var xe=this;return(0,h.Z)(function*(){if((oe=oe.trim()).startsWith("OCM-")&&(oe=oe.replace("OCM-","")),Number.isInteger(Number(oe))){let ye=new te.n;return ye.Title="Go to OCM ID",ye.Address="OCM-"+oe,ye.ReferenceID="OCM-"+oe,ye}let Ie=oe.match(/^\s*((lat|latitude)(:)?)?\s*((\-)?[0-9]+\.[0-9]+)\s*(,?)\s*((lng|lon|longitude)(:)?)?\s*((\-)?[0-9]+\.[0-9]+)\s*$/gi);if(Ie&&Ie.length>0){const Ue=(""+oe.match(/((\-)?[0-9]+\.[0-9]+)+/g)).split(",");let ct=new te.n;return ct.Title="Go to Lat/Lng",ct.Address="Lat:"+Ue[0]+", Lng:"+Ue[1],ct.Location=new Y.wC(parseFloat(Ue[0]),parseFloat(Ue[1])),ct}var Ae=xe.ParseDMS(oe);if(!Ae||isNaN(Ae.latitude)||isNaN(Ae.longitude))return null;{let ye=new te.n;return ye.Title="Go to Lat/Lng",ye.Address="Lat:"+Ae.latitude+", Lng:"+Ae.longitude,ye.Location=Ae,ye}})()}placeSelected(oe){this.logging.log("Looking up place details:"+oe.Title+"::"+oe.ReferenceID),this.selectedPlace=oe,this.placeChanged.emit(oe),this.placeSearchActive=!1}static \u0275fac=function(xe){return new(xe||nt)(l.Y36(m.z),l.Y36(l.sBO),l.Y36(C.t4),l.Y36(fe.eN),l.Y36(Pe.z))};static \u0275cmp=l.Xpm({type:nt,selectors:[["place-search"]],inputs:{searchKeyword:"searchKeyword"},outputs:{selectedPlace:"selectedPlace",placeChanged:"placeChanged"},decls:1,vars:1,consts:[["class","place-search",4,"ngIf"],[1,"place-search"],[4,"ngIf"],[3,"click",4,"ngFor","ngForOf"],[1,"place-attribution"],[3,"click"],["item-left",""],["name","locate"]],template:function(xe,Ie){1&xe&&l.YNc(0,Me,7,3,"div",0),2&xe&&l.Q6J("ngIf",Ie.placeSearchActive)},dependencies:[K.sg,K.O5,ie.BJ,ie.gu,ie.Ie,ie.Q$,ie.q_,ie.PQ],styles:[".place-search[_ngcontent-%COMP%]{position:absolute;z-index:1000}.place-attribution[_ngcontent-%COMP%]{font-size:9px;color:#dcdcdc;max-width:100%}"]})}return nt})()},8696:(Bn,Ct,P)=>{"use strict";P.d(Ct,{o:()=>ie});var h=P(9212),m=P(866),te=P(6814),l=P(451);function B(fe,Pe){if(1&fe){const K=h.EpF();h.TgZ(0,"ion-button",5),h.NdJ("click",function(){h.CHM(K);const Te=h.oxw().$implicit,Me=h.oxw();return h.KtG(Me.onCopyCommand(Te))}),h._uU(1,"Copy"),h.qZA()}}function Y(fe,Pe){if(1&fe){const K=h.EpF();h.TgZ(0,"ion-button",5),h.NdJ("click",function(){h.CHM(K);const Te=h.oxw().$implicit,Me=h.oxw();return h.KtG(Me.onEditCommand(Te))}),h._uU(1,"Edit"),h.qZA()}}function C(fe,Pe){if(1&fe&&(h.TgZ(0,"ion-item",1)(1,"ion-grid")(2,"ion-row")(3,"ion-col"),h._uU(4),h.qZA()(),h.TgZ(5,"ion-row")(6,"ion-col",2)(7,"p"),h._UZ(8,"img",3),h.qZA(),h.TgZ(9,"ion-note"),h._uU(10),h.qZA(),h.YNc(11,B,2,0,"ion-button",4)(12,Y,2,0,"ion-button",4),h.qZA(),h.TgZ(13,"ion-col")(14,"ion-row")(15,"ion-col")(16,"p"),h._uU(17),h.qZA(),h.TgZ(18,"ion-note"),h._uU(19),h.qZA()()(),h.TgZ(20,"ion-row")(21,"ion-col"),h._uU(22),h.qZA(),h.TgZ(23,"ion-col"),h._uU(24),h.qZA()()()()()()),2&fe){const K=Pe.$implicit,be=h.oxw();h.xp6(4),h.hij(" ",K.AddressInfo.Title," "),h.xp6(4),h.Q6J("src",be.getIconForPOI(K),h.LSH),h.xp6(2),h.hij(" ",be.getFormattedDistance(K)," "),h.xp6(),h.Q6J("ngIf",be.enableCopyOption),h.xp6(),h.Q6J("ngIf",be.enableEditOption),h.xp6(5),h.hij(" ",be.getFormattedAddress(K)," "),h.xp6(2),h.hij(" ",be.getFormattedConnectorList(K)," "),h.xp6(3),h.hij(" ",null==K.UsageType?null:K.UsageType.Title," "),h.xp6(2),h.hij(" ",null==K.OperatorInfo?null:K.OperatorInfo.Title," ")}}let ie=(()=>{class fe{enableCopyOption=!1;enableEditOption=!1;poiList=[];onCopy=new h.vpe;onEdit=new h.vpe;constructor(){}ngOnInit(){}onCopyCommand(K){this.onCopy.emit(K)}onEditCommand(K){this.onEdit.emit(K)}getFormattedAddress(K){let be="";return be+=K.AddressInfo.Title!=K.AddressInfo.AddressLine1?K.AddressInfo.Title:K.AddressInfo.Town,be}getFormattedConnectorList(K){if(!K.Connections)return;let be=[];for(let Te of K.Connections)null!=Te.ConnectionType&&(be.find(Me=>Me==Te.ConnectionType.Title)||be.push(Te.ConnectionType.Title));return be.join(", ")}getIconForPOI(K){return m.c.getIconForPOI(K)}getFormattedDistance(K){return m.c.getFormattedDistance(K)}static \u0275fac=function(be){return new(be||fe)};static \u0275cmp=h.Xpm({type:fe,selectors:[["app-poi-list"]],inputs:{enableCopyOption:"enableCopyOption",enableEditOption:"enableEditOption",poiList:"poiList"},outputs:{onCopy:"onCopy",onEdit:"onEdit"},decls:2,vars:1,consts:[["style","max-width:400px;",4,"ngFor","ngForOf"],[2,"max-width","400px"],["size","3"],[2,"width","24px",3,"src"],["size","small",3,"click",4,"ngIf"],["size","small",3,"click"]],template:function(be,Te){1&be&&(h.TgZ(0,"ion-list"),h.YNc(1,C,25,9,"ion-item",0),h.qZA()),2&be&&(h.xp6(),h.Q6J("ngForOf",Te.poiList))},dependencies:[te.sg,te.O5,l.YG,l.wI,l.jY,l.Ie,l.q_,l.uN,l.Nd]})}return fe})()},5086:(Bn,Ct,P)=>{"use strict";P.d(Ct,{e:()=>Y});var h=P(6814),m=P(451),te=P(6223),l=P(2618),B=P(9212);let Y=(()=>{class C{static \u0275fac=function(Pe){return new(Pe||C)};static \u0275mod=B.oAB({type:C});static \u0275inj=B.cJS({providers:[h.JJ],imports:[h.ez,m.Pc,te.u5,l.aw]})}return C})()},7777:(Bn,Ct,P)=>{"use strict";P.d(Ct,{X:()=>m});var h=P(553);class m{baseURL;loginProviderRedirectBaseURL;loginProviderRedirectURL;enableLiveMapQuerying;googleMapsAPIKey;enableStaticMaps;constructor(){this.baseURL="https://map.openchargemap.io",this.loginProviderRedirectBaseURL="https://openchargemap.org/site/loginprovider/?_mode=silent&_forceLogin=true&_redirectURL=",this.loginProviderRedirectURL=this.loginProviderRedirectBaseURL+this.baseURL,this.enableLiveMapQuerying=!0,this.googleMapsAPIKey=h.N.googleMapsKey,this.enableStaticMaps=h.N.enableStaticMaps}}},866:(Bn,Ct,P)=>{"use strict";P.d(Ct,{c:()=>m});var h=P(553);let m=(()=>{class te{static isFeatureEnabled(B){return!!h.N.enabledFeatures.find(Y=>Y===B)}static getClientHeight(){const B=document.body,Y=document.documentElement;return Math.max(B.scrollHeight,B.offsetHeight,Y.clientHeight,Y.scrollHeight,Y.offsetHeight)}static getClientWidth(){const B=document.body,Y=document.documentElement;return Math.max(B.scrollWidth,B.offsetWidth,Y.clientWidth,Y.scrollWidth,Y.offsetWidth)}static getMaxLevelOfPOI(B){let Y=0;if(150==B.StatusTypeID)return 0;if(null!=B.Connections)for(let C=0;C<B.Connections.length;C++)null!=B.Connections[C].Level&&B.Connections[C].Level.ID>Y&&(Y=B.Connections[C].Level.ID);return 4===Y&&(Y=2),Y>4&&(Y=3),Y}static getIconForPOI(B){let C="assets/images/icons/map/level"+te.getMaxLevelOfPOI(B);return null!=B.UsageType&&B.UsageType.Title.indexOf("Private")>-1?C+="_private":C+=null!=B.StatusType&&!0!==B.StatusType.IsOperational?"_nonoperational":"_operational",C+="_icon.png",C}static getColorForPOI(B){const Y=te.getMaxLevelOfPOI(B);let C="#c0c0c0";return null!=B.UsageType&&B.UsageType.Title.indexOf("Private")>-1?C="#FF0000":null!=B.StatusType&&!0!==B.StatusType.IsOperational?C="#a0a0a0":2==Y?C="#72EB0D":3==Y&&(C="#EB800D"),C}static getIconForConnector(B){let Y="assets/images/icons/connectors/";return Y+=1===B?"Type1_J1772.svg":2===B?"Chademo_type4.svg":25===B?"Type2_socket.svg":32===B?"Type1_CCS.svg":33===B?"Type2_CCS.svg":1036===B?"Type2_tethered.svg":26===B?"Type3c.svg":28===B?"schuko.svg":"Unknown.svg",Y}static getFormattedDistance(B){return B&&B.AddressInfo&&B.AddressInfo.Distance?B.AddressInfo.Distance.toFixed(1)+" "+(1===B.AddressInfo.DistanceUnit?"km":"miles"):""}static fixJSONDate(B){if(null==B)return null;if(0==B.indexOf("/")){let C=/Date\(([^)]+)\)/.exec(B);B=new Date(parseFloat(C[1]))}else B=new Date(B);return B}static formatMapLinkFromPosition(B,Y,C,ie,fe){return'<a href="https://maps.google.com/maps?saddr='+Y+","+C+"&daddr="+B.AddressInfo.Latitude+","+B.AddressInfo.Longitude+'">Map ('+Math.ceil(ie)+" "+fe+")</a>"}static formatSystemWebLink(B,Y){return"<a href='#' onclick=\"window.open('"+B+"', '_system');return false;\">"+Y+"</a>"}static formatMapLink(B,Y,C){return C?device&&"WinCE"==device.platform?this.formatSystemWebLink("maps:"+B.AddressInfo.Latitude+","+B.AddressInfo.Longitude,Y):device&&"iOS"===device.platform?this.formatSystemWebLink("https://maps.apple.com/?q="+B.AddressInfo.Latitude+","+B.AddressInfo.Longitude,Y):this.formatSystemWebLink("https://maps.google.com/maps?q="+B.AddressInfo.Latitude+","+B.AddressInfo.Longitude,Y):'<a target="_blank"  href="https://maps.google.com/maps?q='+B.AddressInfo.Latitude+","+B.AddressInfo.Longitude+'">'+Y+"</a>"}static formatURL(B,Y=null){return null==B||""==B?"":(-1==B.indexOf("http")&&(B="https://"+B),'<a target="_blank" href="'+B+'">'+(Y??B)+"</a>")}static formatPOIAddress=function(B,Y=!0){let C="";return C=Y?""+this.formatTextField(B.AddressInfo.AddressLine1)+this.formatTextField(B.AddressInfo.AddressLine2)+this.formatTextField(B.AddressInfo.Town)+this.formatTextField(B.AddressInfo.StateOrProvince)+this.formatTextField(B.AddressInfo.Postcode)+(null!=B.AddressInfo.Country?this.formatTextField(B.AddressInfo.Country.Title):""):this.formatStringArray([B.AddressInfo.AddressLine1,B.AddressInfo.AddressLine2,B.AddressInfo.Town,B.AddressInfo.StateOrProvince,B.AddressInfo.Postcode,null!=B.AddressInfo.Country?B.AddressInfo.Country.Title:""]),C};static formatStringArray=function(B,Y=", "){if(null==B)return"";let C="";for(let ie=0;ie<B.length;ie++)null!=B[ie]&&""!=B[ie].trim()&&(C+=ie==B.length-1?B[ie]:B[ie]+Y);return C};static formatString(B){return null==B?"":B.toString()}static formatTextField(B,Y=null,C=!1,ie=!1,fe=null){if(null==B||""==B||null==B)return"";let Pe=(null!=Y?"<strong class='ocm-label' "+(null!=fe?"data-localize='"+fe+"' ":"")+">"+Y+"</strong>: ":"")+(C?"<br/>":"")+B.toString().replace("\n","<br/>")+"<br/>";return 1==ie&&(Pe="<p>"+Pe+"</p>"),Pe}static formatEmailAddress(B){return null!=B&&null!=B&&""!=B?"<i class='fa fa-envelope fa-fw'></i> <a href=\"mailto:"+B+'">'+B+"</a><br/>":""}static formatPhone(B,Y=null){return null!=B&&null!=B&&""!=B?(null==Y?Y="<i class='fa fa-phone fa-fw '></i> ":Y+=": ",Y+'<a href="tel:'+B+'">'+B+"</a><br/>"):""}static formatPOIDetails(B,Y){let ie=new Date;null==Y&&(Y=!1);let fe=this.formatPOIAddress(B,!1),Pe="";Pe+=this.formatPhone(B.AddressInfo.ContactTelephone1),Pe+=this.formatPhone(B.AddressInfo.ContactTelephone2),Pe+=this.formatEmailAddress(B.AddressInfo.ContactEmail);let K="";if(null!=B.AddressInfo.Distance){let Ce="https://maps.google.com/maps?saddr=&daddr="+B.AddressInfo.Latitude+","+B.AddressInfo.Longitude;K+="<strong id='addr_distance'><span data-localize='details.approxDistance'>Distance</span>: "+B.AddressInfo.Distance.toFixed(1)+" "+(2==B.AddressInfo.DistanceUnit?"Miles":"KM")+"</strong>",K+="<p>"+this.formatSystemWebLink(Ce,"Get Directions")+"</p>"}if(null!=B.AddressInfo.RelatedURL&&""!=B.AddressInfo.RelatedURL){let Ce=B.AddressInfo.RelatedURL;Ce=Ce.replace(/.*?:\/\//g,""),Ce.length>40&&(Ce=Ce.substr(0,40)+".."),Pe+="<i class='fa fa-fw fa-external-link'></i>  "+this.formatSystemWebLink(B.AddressInfo.RelatedURL,"<span data-localize='details.addressRelatedURL'>"+Ce+"</span>")}Pe+="</p>";const be=this.formatTextField(B.GeneralComments,null,!1,!0)+this.formatTextField(B.AddressInfo.AccessComments,"Access",!0,!0,"details.accessComments");let Te="";null!=B.NumberOfPoints&&(Te+=this.formatTextField(B.NumberOfPoints,"Bays",!1,!0,"details.numberOfPoints")),null!=B.UsageType&&(Te+=this.formatTextField(B.UsageType.Title,"Usage",!1,!0,"details.usageType")),null!=B.UsageCost&&(Te+=this.formatTextField(B.UsageCost,"Usage Cost",!1,!0,"details.usageCost")),null!=B.OperatorInfo&&1!=B.OperatorInfo.ID&&(Te+=this.formatTextField(B.OperatorInfo.Title,"Operator",!1,!0,"details.operatorTitle"),null!=B.OperatorInfo.WebsiteURL&&(Te+=this.formatTextField(this.formatURL(B.OperatorInfo.WebsiteURL),"Operator Website",!0,!0,"details.operatorWebsite")));let Me="";if(null!=B.StatusType&&(Me+=this.formatTextField(B.StatusType.Title,"Status",!1,!0,"details.operationalStatus"),null!=B.DateLastStatusUpdate&&(Me+=this.formatTextField(Math.round((ie-this.fixJSONDate(B.DateLastStatusUpdate))/864e5)+" days ago","Last Updated",!1,!0,"details.lastUpdated"))),null!=B.Connections&&B.Connections.length>0){Me+="<table class='table table-striped'>",Me+="<tr><th data-localize='details.equipment.connectionType'>Connection</th><th data-localize='details.equipment.powerLevel'>Power Level</th><th data-localize='details.operationalStatus'>Status</th></tr>";for(let Ce=0;Ce<B.Connections.length;Ce++){let oe=B.Connections[Ce];""==oe.Amps&&(oe.Amps=null),""==oe.Voltage&&(oe.Voltage=null),""==oe.Quantity&&(oe.Quantity=null),""==oe.PowerKW&&(oe.PowerKW=null),Me+="<tr><td>"+(null!=oe.ConnectionType?oe.ConnectionType.Title:"")+"</td><td>"+(null!=oe.Level?"<strong>"+oe.Level.Title+"</strong><br/>":"")+(null!=oe.Amps?this.formatString(oe.Amps)+"A/ ":"")+(null!=oe.Voltage?this.formatString(oe.Voltage)+"V/ ":"")+(null!=oe.PowerKW?this.formatString(oe.PowerKW)+"kW <br/>":"")+(null!=oe.CurrentType?oe.CurrentType.Title:"")+"<br/>"+(null!=oe.Quantity?this.formatString(oe.Quantity):"1")+" Present</td><td>"+(null!=oe.StatusType?oe.StatusType.Title:"-")+"</td></tr>"}Me+="</table>"}let de="";return de+=this.formatTextField("<a target='_blank' href='https://openchargemap.org/site/poi/details/"+B.ID+"'>OCM-"+B.ID+"</a>","OpenChargeMap Ref",!1,!0,"details.refNumber"),null!=B.DataProvider&&(de+=this.formatTextField(B.DataProvider.Title,"Data Provider",!1,!0,"details.dataProviderTitle"),null!=B.DataProvider.WebsiteURL&&(de+=this.formatTextField(this.formatURL(B.DataProvider.WebsiteURL),"Website",!1,!0,"details.dataProviderWebsite")),de+=this.formatTextField(B.AddressInfo.Latitude,"Latitude",!1,!0,null),de+=this.formatTextField(B.AddressInfo.Longitude,"Longitude",!1,!0,null)),{address:fe,drivingInfo:K,contactInfo:Pe,additionalInfo:be+Te+Me,advancedInfo:de}}static debounce(B,Y,C){let ie;return function(){let fe=this,Pe=arguments,be=C&&!ie;clearTimeout(ie),ie=setTimeout(function(){ie=null,C||B.apply(fe,Pe)},Y),be&&B.apply(fe,Pe)}}static getRandomInt(B){return Math.floor(Math.random()*Math.floor(B))}}return te})()},8371:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Qp:()=>te.Qp,wC:()=>B.wC,jR:()=>B.jR,fw:()=>te.fw,vw:()=>te.vw,be:()=>C.b,nS:()=>l.n,Nm:()=>Y.N,aX:()=>h,qO:()=>m,kA:()=>te.kA});class h{ID;SubmissionType;Data;Attempts;DateQueued;IsSubmitted;IsInProgress;IsCancelled;IsFailure;FailureReason;constructor(fe,Pe){this.SubmissionType=fe,this.Data=Pe,this.DateQueued=new Date,this.IsSubmitted=!1,this.IsInProgress=!1,this.IsCancelled=!1,this.IsFailure=!1,this.Attempts=0,this.ID=new Date+"_"+100*Math.random()}}var m=function(ie){return ie[ie.POI=0]="POI",ie[ie.Comment=1]="Comment",ie[ie.Media=2]="Media",ie}(m||{}),te=P(7430),l=P(2117),B=P(3052),Y=P(4783),C=P(4677)},3052:(Bn,Ct,P)=>{"use strict";P.d(Ct,{LL:()=>te,jR:()=>m,wC:()=>h});class h{altitudeAccuracy;longitude;latitude;speed;heading;altitude;accuracy;constructor(B=null,Y=null){this.latitude=B,this.longitude=Y}}class m{coords;timestamp;attribution;constructor(B=null,Y=null){this.coords=new h,this.coords.latitude=B,this.coords.longitude=Y}static fromPosition(B){return new m(B.coords.latitude,B.coords.longitude)}}class te{northEast;southWest;constructor(B,Y){this.northEast=B,this.southWest=Y}}},7430:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Qp:()=>te,fw:()=>Y,JJ:()=>ie,eN:()=>C,vw:()=>B,kA:()=>l});class h{itemType;itemId;version;schemaVersion;syncTimeStamp;constructor(Pe,K){this.itemType=Pe,this.itemId=h.getNewItemId(),this.version=1,this.schemaVersion=K,this.syncTimeStamp=h.getNewSyncTimeStamp()}static getNewSyncTimeStamp(){return Date.now().toString()}static getNewItemId(){return"_syncitem_"+Date.now().toString()}}class m{Title;Notes;_sync;constructor(Pe,K){this._sync=new h(Pe,K)}}class te extends m{PoiID;Type;Poi;Photos}class l extends m{Stage;Position;PoiIDs;PoiList;constructor(){super("waypoint",1)}}class B extends m{WayPoints;constructor(){super("journey_stage",1),this.WayPoints=[]}}class Y extends m{ID;Stages;constructor(){super("journey",1),this.ID=""+Date.now(),this.Stages=[]}}class C{Title;DistanceKM;DurationMinutes;StartElevation;EndElevation;EnergyConsumptionkWh}class ie{Title;JourneyRouteLegs;TotalDistanceKM;TotalDurationMinutes;TotalEnergykWh}},4677:(Bn,Ct,P)=>{"use strict";P.d(Ct,{b:()=>h});class h{poiIdList=null;countryCode=null;latitude=null;longitude=null;locationTitle=null;distance=null;distanceUnit=null;connectionTypeIdList=null;operatorIdList=null;levelIdList=null;countryIdList=null;usageTypeIdList=null;statusTypeIdList=null;minPowerKW=null;maxPowerKW=null;submissionStatusTypeIdList=null;maxResults=500;additionalParams=null;includeComments=!1;compact=!0;enableCaching=!0;levelOfDetail=1;polyline=null;boundingbox=null}},2117:(Bn,Ct,P)=>{"use strict";P.d(Ct,{n:()=>h});class h{Location;Title;Address;Type;ReferenceID;Attribution;AddressInfo}},4783:(Bn,Ct,P)=>{"use strict";P.d(Ct,{N:()=>m,U:()=>h});const h=1e3;class m{OperatorList;ConnectionTypeList;CountryList;UsageTypeList;StatusTypeList;MinPowerKW;MaxPowerKW;UseDistanceInKM;HasActiveFilters;LastSearchPosition;StartSearchPosition;StartViewPoiId;Language;FilterOptionsByCountryId;MapType;EnableAdvancedEditorFeatures;EnablePOIPendingApproval;MaxResults;constructor(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MaxPowerKW=null,this.MinPowerKW=null,this.HasActiveFilters=!1,this.FilterOptionsByCountryId=null,this.UseDistanceInKM=!0,this.MapType="ROADMAP",this.EnableAdvancedEditorFeatures=!1,this.EnablePOIPendingApproval=!1,this.MaxResults=500}LoadSettings(){}SaveSettings(){}ClearActiveFilters(){this.OperatorList=[],this.ConnectionTypeList=[],this.CountryList=[],this.UsageTypeList=[],this.StatusTypeList=[],this.MinPowerKW=null,this.MaxPowerKW=null}CheckForActiveFilters(){return this.HasActiveFilters=this.OperatorList.length>0||this.ConnectionTypeList.length>0||this.CountryList.length>0||this.UsageTypeList.length>0||this.StatusTypeList.length>0||this.MinPowerKW>0||this.MaxPowerKW>0||null!=this.MaxPowerKW&&this.MaxPowerKW<h,this.HasActiveFilters}}},7425:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{AboutPageModule:()=>Pe});var h=P(6814),m=P(6223),te=P(451),l=P(6800),B=P(9236),Y=P(9212);const C=[{path:"",component:B.t}];let ie=(()=>{class K{static \u0275fac=function(Me){return new(Me||K)};static \u0275mod=Y.oAB({type:K});static \u0275inj=Y.cJS({imports:[l.Bz.forChild(C),l.Bz]})}return K})();var fe=P(2618);let Pe=(()=>{class K{static \u0275fac=function(Me){return new(Me||K)};static \u0275mod=Y.oAB({type:K});static \u0275inj=Y.cJS({imports:[h.ez,m.u5,te.Pc,fe.aw,ie]})}return K})()},9236:(Bn,Ct,P)=>{"use strict";P.d(Ct,{t:()=>B});var h=P(553),m=P(9212),te=P(451),l=P(2618);let B=(()=>{class Y{modalController;constructor(ie){this.modalController=ie}get appVersion(){return h.N.version}get apiUrl(){return h.N.apiBase}ngOnInit(){}close(){this.modalController.dismiss()}static \u0275fac=function(fe){return new(fe||Y)(m.Y36(te.IN))};static \u0275cmp=m.Xpm({type:Y,selectors:[["app-about"]],decls:46,vars:5,consts:[[1,"ion-padding"],["size","2"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["href","https://openchargemap.org","target","_blank"],["href","https://community.openchargemap.org","target","_blank"],["href","https://webprofusion.com","target","_blank"],["href","https://openchargemap.org/site/about/datasharing","target","_blank"],["slot","end"],[3,"click"],["name","close","slot","start"]],template:function(fe,Pe){1&fe&&(m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),m._uU(3),m.ALo(4,"translate"),m.qZA()()(),m.TgZ(5,"ion-content",0)(6,"ion-grid")(7,"ion-row")(8,"ion-col",1),m._UZ(9,"img",2),m.qZA(),m.TgZ(10,"ion-col")(11,"h1"),m._uU(12,"Open Charge Map"),m.qZA()()()(),m.TgZ(13,"p")(14,"strong"),m._uU(15,"Open Charge Map is the worlds largest Open Data registry of electric vehicle charging locations."),m.qZA(),m._uU(16," By adding and editing the information within Open Charge Map you are improving the data for an unlimited amount of other apps and services which can use the data for free. "),m.qZA(),m.TgZ(17,"p")(18,"a",3),m._uU(19,"openchargemap.org"),m.qZA()(),m.TgZ(20,"p"),m._uU(21,"Join our community discussions: "),m.TgZ(22,"a",4),m._uU(23,"community.openchargemap.org"),m.qZA()(),m.TgZ(24,"p"),m._uU(25,"Software development and service hosting by "),m.TgZ(26,"a",5),m._uU(27,"webprofusion.com"),m.qZA()(),m.TgZ(28,"p"),m._uU(29,"Our service is run by volunteers, our data is largely crowdsourced by you. Some data is imported from public Open Data sources."),m.qZA(),m.TgZ(30,"p"),m._uU(31,"Network operators can "),m.TgZ(32,"a",6),m._uU(33,"provide us with an OCPI data feed"),m.qZA(),m._uU(34," to freely promote their network and ensure information accuracy. "),m.qZA(),m.TgZ(35,"ion-note")(36,"p"),m._uU(37),m.qZA(),m.TgZ(38,"p"),m._uU(39),m.qZA()()(),m.TgZ(40,"ion-footer")(41,"ion-toolbar")(42,"ion-buttons",7)(43,"ion-button",8),m.NdJ("click",function(){return Pe.close()}),m._UZ(44,"ion-icon",9),m._uU(45," Close "),m.qZA()()()()),2&fe&&(m.xp6(3),m.hij("",m.lcZ(4,3,"ocm.general.about")," Open Charge Map"),m.xp6(34),m.hij("App Version: ",Pe.appVersion,""),m.xp6(2),m.hij("API: ",Pe.apiUrl,""))},dependencies:[te.YG,te.Sm,te.wI,te.W2,te.fr,te.jY,te.Gu,te.gu,te.uN,te.Nd,te.wd,te.sr,l.X$]})}return Y})()},9192:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{JourneysModule:()=>fe});var h=P(4292),m=P(5086),te=P(2618),l=P(6814),B=P(6223),Y=P(451),C=P(6800),ie=P(9212);let fe=(()=>{class Pe{static \u0275fac=function(Te){return new(Te||Pe)};static \u0275mod=ie.oAB({type:Pe});static \u0275inj=ie.cJS({imports:[l.ez,B.u5,Y.Pc,te.aw,m.e,C.Bz.forChild([{path:"",component:h.g}])]})}return Pe})()},4292:(Bn,Ct,P)=>{"use strict";P.d(Ct,{g:()=>Ie});var h=P(989),m=P(439),te=P(6470),l=P(8371),B=P(9723),Y=P(9212),C=P(451),ie=P(6814);function fe(Ae,ye){1&Ae&&(Y.TgZ(0,"p"),Y._uU(1," You have no journeys yet. Start by browsing to a charging location, then add it as Favourite to start a new Journey. "),Y.qZA())}function Pe(Ae,ye){if(1&Ae&&(Y.TgZ(0,"p"),Y._uU(1),Y.qZA()),2&Ae){const Ue=Y.oxw(2).$implicit;Y.xp6(),Y.hij(" ",Ue.Poi.AddressInfo.AddressLine1,"")}}function K(Ae,ye){if(1&Ae&&(Y.TgZ(0,"p"),Y._uU(1),Y.qZA()),2&Ae){const Ue=Y.oxw(2).$implicit;Y.xp6(),Y.hij(" ",Ue.Poi.AddressInfo.AddressLine2,"")}}function be(Ae,ye){if(1&Ae&&(Y.TgZ(0,"p"),Y._uU(1),Y.qZA()),2&Ae){const Ue=Y.oxw(2).$implicit;Y.xp6(),Y.hij(" ",Ue.Poi.AddressInfo.Town,"")}}function Te(Ae,ye){if(1&Ae&&(Y.TgZ(0,"p"),Y._uU(1),Y.qZA()),2&Ae){const Ue=Y.oxw(2).$implicit;Y.xp6(),Y.hij(" ",Ue.Poi.AddressInfo.StateOrProvince,"")}}function Me(Ae,ye){if(1&Ae&&(Y.TgZ(0,"p"),Y._uU(1),Y.qZA()),2&Ae){const Ue=Y.oxw(2).$implicit;Y.xp6(),Y.hij(" ",Ue.Poi.AddressInfo.Postcode,"")}}function de(Ae,ye){if(1&Ae){const Ue=Y.EpF();Y.TgZ(0,"div")(1,"div",18),Y.NdJ("click",function(){Y.CHM(Ue);const X=Y.oxw().$implicit,ve=Y.oxw(4);return Y.KtG(ve.viewPOIDetails(X.Poi))}),Y.YNc(2,Pe,2,1,"p",4)(3,K,2,1,"p",4)(4,be,2,1,"p",4)(5,Te,2,1,"p",4)(6,Me,2,1,"p",4),Y.qZA(),Y.TgZ(7,"ion-button",19),Y.NdJ("click",function(){Y.CHM(Ue);const X=Y.oxw().$implicit,ve=Y.oxw(4);return Y.KtG(ve.launchNavigation(X.Poi))}),Y._UZ(8,"ion-icon",20),Y._uU(9," Navigate "),Y.qZA()()}if(2&Ae){const Ue=Y.oxw().$implicit;Y.xp6(2),Y.Q6J("ngIf",Ue.Poi.AddressInfo.AddressLine1),Y.xp6(),Y.Q6J("ngIf",Ue.Poi.AddressInfo.AddressLine2),Y.xp6(),Y.Q6J("ngIf",Ue.Poi.AddressInfo.Town),Y.xp6(),Y.Q6J("ngIf",Ue.Poi.AddressInfo.StateOrProvince),Y.xp6(),Y.Q6J("ngIf",Ue.Poi.AddressInfo.Postcode)}}function nt(Ae,ye){if(1&Ae&&(Y.TgZ(0,"div",17),Y.YNc(1,de,10,5,"div",4),Y.qZA()),2&Ae){const Ue=ye.$implicit;Y.xp6(),Y.Q6J("ngIf",Ue.Poi)}}function Ce(Ae,ye){if(1&Ae&&(Y.TgZ(0,"ion-item")(1,"h2"),Y._uU(2),Y.qZA(),Y.TgZ(3,"ion-thumbnail",0),Y._UZ(4,"ion-icon",15),Y.qZA(),Y.TgZ(5,"p"),Y._uU(6),Y.qZA(),Y.YNc(7,nt,2,1,"div",16),Y.qZA()),2&Ae){const Ue=ye.$implicit;Y.xp6(2),Y.Oqu(Ue.Title),Y.xp6(4),Y.Oqu(Ue.Notes),Y.xp6(),Y.Q6J("ngForOf",Ue.PoiList)}}function oe(Ae,ye){if(1&Ae&&(Y.TgZ(0,"ion-list")(1,"ion-list-header",11),Y._uU(2),Y._UZ(3,"ion-icon",12),Y._uU(4," -- "),Y._UZ(5,"ion-icon",13),Y._uU(6," -- "),Y._UZ(7,"ion-icon",14),Y._uU(8," -- "),Y.qZA(),Y.YNc(9,Ce,8,3,"ion-item",5),Y.qZA()),2&Ae){const Ue=ye.$implicit;Y.xp6(2),Y.hij(" ",Ue.Title," "),Y.xp6(7),Y.Q6J("ngForOf",Ue.WayPoints)}}function xe(Ae,ye){if(1&Ae){const Ue=Y.EpF();Y.TgZ(0,"ion-card")(1,"ion-card-content")(2,"ion-toolbar",8)(3,"ion-title"),Y._uU(4),Y.qZA(),Y.TgZ(5,"ion-buttons",9)(6,"ion-button",1),Y.NdJ("click",function(){const ve=Y.CHM(Ue).$implicit,me=Y.oxw();return Y.KtG(me.deleteJourney(ve.ID))}),Y._UZ(7,"ion-icon",10),Y.qZA()()(),Y.TgZ(8,"p"),Y._uU(9),Y.qZA(),Y.YNc(10,oe,10,2,"ion-list",5),Y.qZA()()}if(2&Ae){const Ue=ye.$implicit;Y.xp6(4),Y.hij(" ",Ue.Title,""),Y.xp6(5),Y.Oqu(Ue.Notes),Y.xp6(),Y.Q6J("ngForOf",Ue.Stages)}}let Ie=(()=>{class Ae{appManager;journeyManager;api;modalController;alertController;constructor(Ue,ct,X,ve,me){this.appManager=Ue,this.journeyManager=ct,this.api=X,this.modalController=ve,this.alertController=me}dismiss(){this.modalController.dismiss()}discoverImages(){this.journeyManager.journeys.forEach(Ue=>{Ue.Stages.forEach(ct=>{ct.WayPoints.forEach(X=>{null!=X.PoiList&&X.PoiList.forEach(ve=>{ve.Poi&&this.api.getPanoramioLocationPhotos(new l.wC(ve.Poi.AddressInfo.Latitude,ve.Poi.AddressInfo.Longitude)).then(me=>{ve.Photos=me})})})})})}getJson(Ue){return JSON.stringify(Ue,null,4)}viewPOIDetails(Ue){this.modalController.create({component:B.H,componentProps:{item:Ue}}).then(ct=>ct.present())}get staticMapSize(){return"60x60"}getStaticMapURL(Ue){return"https://maps.googleapis.com/maps/api/staticmap?center="+Ue.AddressInfo.Latitude+","+Ue.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+Ue.AddressInfo.Latitude+","+Ue.AddressInfo.Longitude}deleteJourney(Ue){this.alertController.create({header:"Delete this Journey?",message:"Are you sure you want to delete this Journey?",buttons:[{text:"No",handler:()=>{}},{text:"Delete",handler:()=>{this.journeyManager.deleteJourney(Ue)}}]}).then(ct=>ct.present())}launchNavigation(Ue){let ct="https://maps.google.com/?q="+Ue.AddressInfo.Latitude+","+Ue.AddressInfo.Longitude;this.appManager.platform.is("ios")&&(ct="https://maps.apple.com?q="+Ue.AddressInfo.Latitude+","+Ue.AddressInfo.Longitude),window.open(ct,"_system")}static \u0275fac=function(ct){return new(ct||Ae)(Y.Y36(te.c),Y.Y36(h.i),Y.Y36(m.l),Y.Y36(C.IN),Y.Y36(C.Br))};static \u0275cmp=Y.Xpm({type:Ae,selectors:[["ng-component"]],decls:18,vars:2,consts:[["slot","start"],[3,"click"],[1,"journeys-page"],[1,"ion-padding"],[4,"ngIf"],[4,"ngFor","ngForOf"],["slot","end"],["name","close","slot","start"],["primary",""],["slot","primary"],["name","close","slot","icon-only"],[2,"font-size","1.5rem"],["name","car"],["name","time"],["name","flash"],["name","caret-down",2,"font-size","4rem"],["style","text-align:right;width:100%;",4,"ngFor","ngForOf"],[2,"text-align","right","width","100%"],["tappable","",3,"click"],["clear","","item-right","",3,"click"],["name","navigate","slot","start"]],template:function(ct,X){1&ct&&(Y.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-back-button",1),Y.NdJ("click",function(){return X.dismiss()}),Y.qZA()(),Y.TgZ(4,"ion-title"),Y._uU(5," Journeys "),Y.qZA()()(),Y.TgZ(6,"ion-content",2)(7,"div",3)(8,"p"),Y._uU(9," You can create and plan journeys to group your favourite charging routes together. "),Y.qZA(),Y.YNc(10,fe,2,0,"p",4),Y.qZA(),Y.YNc(11,xe,11,3,"ion-card",5),Y.qZA(),Y.TgZ(12,"ion-footer")(13,"ion-toolbar")(14,"ion-buttons",6)(15,"ion-button",1),Y.NdJ("click",function(){return X.dismiss()}),Y._UZ(16,"ion-icon",7),Y._uU(17," Close "),Y.qZA()()()()),2&ct&&(Y.xp6(10),Y.Q6J("ngIf",null==X.journeyManager.journeys||0==X.journeyManager.journeys.length),Y.xp6(),Y.Q6J("ngForOf",X.journeyManager.journeys))},dependencies:[ie.sg,ie.O5,C.YG,C.Sm,C.PM,C.FN,C.W2,C.fr,C.Gu,C.gu,C.Ie,C.q_,C.yh,C.Bs,C.wd,C.sr,C.oU],encapsulation:2})}return Ae})()},2309:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{LayerEditorPageModule:()=>Pe});var h=P(6814),m=P(6223),te=P(451),l=P(6800),B=P(8062),Y=P(9212);const C=[{path:"",component:B.A}];let ie=(()=>{class K{static \u0275fac=function(Me){return new(Me||K)};static \u0275mod=Y.oAB({type:K});static \u0275inj=Y.cJS({imports:[l.Bz.forChild(C),l.Bz]})}return K})();var fe=P(5086);let Pe=(()=>{class K{static \u0275fac=function(Me){return new(Me||K)};static \u0275mod=Y.oAB({type:K});static \u0275inj=Y.cJS({imports:[h.ez,m.u5,te.Pc,ie,fe.e]})}return K})()},8062:(Bn,Ct,P)=>{"use strict";P.d(Ct,{A:()=>ie});var h=P(5861),m=P(9159),te=P(9212),l=P(451),B=P(6814),Y=P(8696);function C(fe,Pe){if(1&fe&&(te.TgZ(0,"div"),te._uU(1),te._UZ(2,"app-poi-list",10),te.qZA()),2&fe){const K=te.oxw();te.xp6(),te.hij(" Items Parsed: ",K.fileData.length," "),te.xp6(),te.Q6J("poiList",K.fileData)}}let ie=(()=>{class fe{modalController;refData;fileData;constructor(K,be){this.modalController=K,this.refData=be}ngOnInit(){}previewFile(){var K=this;return(0,h.Z)(function*(){yield K.loadFile(!1)})()}cancel(){var K=this;return(0,h.Z)(function*(){yield K.modalController.dismiss(K.fileData)})()}loadFile(K=!0){var be=this;return(0,h.Z)(function*(){const Te=new FileReader;Te.onload=()=>{let de=JSON.parse(Te.result),nt=5e6;for(let Ce of de)(null==Ce.ID||""==Ce.ID)&&(Ce.ID=nt.toString()),Ce.ID="imp_"+Ce.ID,nt++;be.fileData=be.refData.hydrateCompactPOIList(de),K&&be.modalController.dismiss(be.fileData)},Te.onerror=()=>{},Te.readAsText(document.getElementById("file-upload").files[0])})()}add(){var K=this;return(0,h.Z)(function*(){K.modalController.dismiss(K.fileData)})()}static \u0275fac=function(be){return new(be||fe)(te.Y36(l.IN),te.Y36(m.W))};static \u0275cmp=te.Xpm({type:fe,selectors:[["app-layer-editor"]],decls:27,vars:1,consts:[[1,"ion-padding"],[1,"upload"],["name","file","aria-label","file","slot","start"],["type","file","required","","id","file-upload",3,"change"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","checkmark-circle-outline","slot","end"],[3,"poiList"]],template:function(be,Te){1&be&&(te.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),te._uU(3," Edit Layer "),te.qZA()()(),te.TgZ(4,"ion-content",0)(5,"p"),te._uU(6,"POI layers are used to preview data from other Open Data sources. "),te.qZA(),te.TgZ(7,"p"),te._uU(8,"Select a POI layer JSON file: "),te.qZA(),te.TgZ(9,"div")(10,"label",1)(11,"ion-button"),te._UZ(12,"ion-icon",2),te.TgZ(13,"ion-label"),te._uU(14,"Choose File.."),te.qZA()(),te.TgZ(15,"input",3),te.NdJ("change",function(){return Te.previewFile()}),te.qZA()()(),te.YNc(16,C,3,2,"div",4),te.qZA(),te.TgZ(17,"ion-footer")(18,"ion-toolbar")(19,"ion-buttons",5)(20,"ion-button",6),te.NdJ("click",function(){return Te.cancel()}),te._UZ(21,"ion-icon",7),te._uU(22," Cancel "),te.qZA()(),te.TgZ(23,"ion-buttons",8)(24,"ion-button",6),te.NdJ("click",function(){return Te.add()}),te._uU(25," Add "),te._UZ(26,"ion-icon",9),te.qZA()()()()),2&be&&(te.xp6(16),te.Q6J("ngIf",Te.fileData&&Te.fileData.length>0))},dependencies:[B.O5,l.YG,l.Sm,l.W2,l.fr,l.Gu,l.gu,l.Q$,l.wd,l.sr,Y.o],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]})}return fe})()},9723:(Bn,Ct,P)=>{"use strict";P.d(Ct,{H:()=>Gn});var h=P(6470),m=P(9212),te=P(451),l=P(7346),B=P(5861),Y=P(989),C=P(7430),ie=P(6814),fe=P(6223);function Pe(ae,ft){if(1&ae&&(m.TgZ(0,"ion-select-option",13),m._uU(1),m.qZA()),2&ae){const Z=ft.$implicit;m.Q6J("value",Z.ID),m.xp6(),m.Oqu(Z.Title)}}function K(ae,ft){if(1&ae&&(m.TgZ(0,"ion-select-option",16),m._uU(1),m.qZA()),2&ae){const Z=ft.$implicit;m.Q6J("value",ft.index),m.xp6(),m.Oqu(Z.Title)}}function be(ae,ft){if(1&ae){const Z=m.EpF();m.TgZ(0,"ion-item")(1,"ion-label",2),m._uU(2,"Journey Stage"),m.qZA(),m.TgZ(3,"ion-select",3),m.NdJ("ngModelChange",function(st){m.CHM(Z);const on=m.oxw();return m.KtG(on.selectedStageIndex=st)}),m.TgZ(4,"ion-select-option",14),m._uU(5,"Create a Journey Stage"),m.qZA(),m.YNc(6,K,2,2,"ion-select-option",15),m.qZA()()}if(2&ae){const Z=m.oxw();m.xp6(3),m.Q6J("ngModel",Z.selectedStageIndex),m.xp6(3),m.Q6J("ngForOf",Z.journeyManager.getJourneyStages(Z.selectedJourneyID))}}function Te(ae,ft){if(1&ae){const Z=m.EpF();m.TgZ(0,"ion-item")(1,"ion-label",2),m._uU(2,"New Journey Name"),m.qZA(),m.TgZ(3,"ion-input",7),m.NdJ("ngModelChange",function(st){m.CHM(Z);const on=m.oxw();return m.KtG(on.newJourneyName=st)}),m.qZA()()}if(2&ae){const Z=m.oxw();m.xp6(3),m.Q6J("ngModel",Z.newJourneyName)}}let Me=(()=>{class ae{appManager;navParams;journeyManager;modalController;selectedJourneyID;selectedStageIndex;newJourneyName;waypoint;poi;constructor(Z,Re,st,on){this.appManager=Z,this.navParams=Re,this.journeyManager=st,this.modalController=on,this.poi=this.navParams.get("poi"),this.waypoint=new C.kA,this.waypoint.Title=this.poi.AddressInfo.Title,this.waypoint.PoiIDs=[this.poi.ID],this.waypoint.PoiList=[];const In=new C.Qp("charging",1);In.Poi=this.poi,In.PoiID=this.poi.ID,this.waypoint.PoiList.push(In),this.newJourneyName="Trip to "+this.poi.AddressInfo.Title}cancel(){this.modalController.dismiss()}add(){if(null!=this.selectedJourneyID&&""!==this.selectedJourneyID)this.journeyManager.addJourneyWaypoint(this.selectedJourneyID,this.selectedStageIndex,this.waypoint);else{const Z=new C.fw;Z.ID=Date.now().toString(),""===this.newJourneyName&&(this.newJourneyName="New Journey"),Z.Title=this.newJourneyName,this.journeyManager.addJourney(Z,this.waypoint)}this.journeyManager.saveJourneys(),this.modalController.dismiss()}static \u0275fac=function(Re){return new(Re||ae)(m.Y36(h.c),m.Y36(l.X1),m.Y36(Y.i),m.Y36(te.IN))};static \u0275cmp=m.Xpm({type:ae,selectors:[["ng-component"]],decls:39,vars:8,consts:[[1,"journeys-page","ion-padding"],[1,"banner"],["position","stacked"],[3,"ngModel","ngModelChange"],["value","","checked",""],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text",3,"ngModel","ngModelChange"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","add","slot","end"],[3,"value"],["value",""],["checked","",3,"value",4,"ngFor","ngForOf"],["checked","",3,"value"]],template:function(Re,st){1&Re&&(m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),m._uU(3," Edit Favourite "),m.qZA()()(),m.TgZ(4,"ion-content",0)(5,"div",1)(6,"h1"),m._uU(7),m.qZA(),m.TgZ(8,"p"),m._uU(9),m.qZA()(),m.TgZ(10,"p"),m._uU(11," Add Charging Location as a Journey Waypoint "),m.qZA(),m.TgZ(12,"ion-item")(13,"ion-label",2),m._uU(14,"Add to a Journey"),m.qZA(),m.TgZ(15,"ion-select",3),m.NdJ("ngModelChange",function(In){return st.selectedJourneyID=In}),m.TgZ(16,"ion-select-option",4),m._uU(17,"Create a New Journey"),m.qZA(),m.YNc(18,Pe,2,2,"ion-select-option",5),m.qZA()(),m.YNc(19,be,7,2,"ion-item",6)(20,Te,4,1,"ion-item",6),m.TgZ(21,"ion-item")(22,"ion-label",2),m._uU(23,"Name for this step of your journey"),m.qZA(),m.TgZ(24,"ion-input",7),m.NdJ("ngModelChange",function(In){return st.waypoint.Title=In}),m.qZA()(),m.TgZ(25,"ion-item")(26,"ion-label",2),m._uU(27,"Other Notes"),m.qZA(),m.TgZ(28,"ion-textarea",3),m.NdJ("ngModelChange",function(In){return st.waypoint.Notes=In}),m.qZA()()(),m.TgZ(29,"ion-footer")(30,"ion-toolbar")(31,"ion-buttons",8)(32,"ion-button",9),m.NdJ("click",function(){return st.cancel()}),m._UZ(33,"ion-icon",10),m._uU(34," Cancel "),m.qZA()(),m.TgZ(35,"ion-buttons",11)(36,"ion-button",9),m.NdJ("click",function(){return st.add()}),m._uU(37," Add "),m._UZ(38,"ion-icon",12),m.qZA()()()()),2&Re&&(m.xp6(7),m.Oqu(st.poi.AddressInfo.Title),m.xp6(2),m.Oqu(st.poi.AddressInfo.AddressLine1),m.xp6(6),m.Q6J("ngModel",st.selectedJourneyID),m.xp6(3),m.Q6J("ngForOf",st.journeyManager.journeys),m.xp6(),m.Q6J("ngIf",st.selectedJourneyID),m.xp6(),m.Q6J("ngIf",!st.selectedJourneyID),m.xp6(4),m.Q6J("ngModel",st.waypoint.Title),m.xp6(4),m.Q6J("ngModel",st.waypoint.Notes))},dependencies:[ie.sg,ie.O5,fe.JJ,fe.On,te.YG,te.Sm,te.W2,te.fr,te.Gu,te.gu,te.pK,te.Ie,te.Q$,te.t9,te.n0,te.g2,te.wd,te.sr,te.QI,te.j9],encapsulation:2})}return ae})();var de=P(9127);function nt(ae,ft){if(1&ae){const Z=m.EpF();m.TgZ(0,"ion-card")(1,"ion-toolbar")(2,"ion-title",14),m._uU(3,"Preview"),m.qZA(),m.TgZ(4,"ion-buttons",15)(5,"ion-button",4),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw();return m.KtG(st.rotateImage())}),m._UZ(6,"ion-icon",16),m.TgZ(7,"ion-label"),m._uU(8,"Rotate"),m.qZA()()()(),m.TgZ(9,"ion-card-content")(10,"ion-list")(11,"ion-item")(12,"ion-label",17),m._uU(13,"Comment"),m.qZA(),m.TgZ(14,"ion-input",18),m.NdJ("ngModelChange",function(st){m.CHM(Z);const on=m.oxw();return m.KtG(on.comment=st)}),m.qZA()()(),m._UZ(15,"img",19),m.qZA()()}if(2&ae){const Z=m.oxw();m.xp6(14),m.Q6J("ngModel",Z.comment)}}let Ce=(()=>{class ae{navParams;appManager;nav;modalController;logging;mode;processingQuality;imgData;targetWidth;targetHeight;comment;chargePointId;poi;constructor(Z,Re,st,on,In){this.navParams=Z,this.appManager=Re,this.nav=st,this.modalController=on,this.logging=In,this.processingQuality=.8,this.targetWidth=1024,this.targetHeight=800,this.mode=Re.platformMode,this.chargePointId=this.navParams.get("id"),this.poi=this.navParams.get("poi"),this.comment=""}processNativeImageSource(Z){let Re=Z;const st=document.getElementById("img-upload-canvas"),on=st.getContext("2d"),In=new Image;In.onload=()=>{this.logging.log("img load:"+In.width),st.width=In.width,st.height=In.height,on.fillStyle="rgb(0,0,0)",on.fillRect(0,0,st.width,st.height),on.drawImage(In,0,0,st.width,st.height),this.imgData=st.toDataURL("image/png"),this.processImage()},In.src=Re}loadCameraOrLibraryImage(Z=!1){this.logging.log("PWA mode: fetching image");const Re=new FileReader;Re.onload=()=>{this.imgData=Re.result,this.processImage()},Re.onerror=()=>{},Re.readAsDataURL(document.getElementById("img-upload-media").files[0])}isBrowserMode(){return this.appManager.isPlatform("desktop")||this.appManager.isPlatform("hybrid")}processImage(){if(null!=this.imgData){const Re=document.getElementById("img-upload-canvas"),st=Re.getContext("2d"),on=new Image;on.onload=()=>{Re.width=on.width,Re.height=on.height,st.fillStyle="rgb(0,0,0)",st.fillRect(0,0,Re.width,Re.height),st.drawImage(on,0,0,Re.width,Re.height),this.refreshImageFromCanvas()},on.src=this.imgData}else this.logging.log("processImage: nothing to process.")}refreshImageFromCanvas(){const Z=document.getElementById("img-upload-canvas");this.imgData=Z.toDataURL("image/jpeg",.8),document.getElementById("preview").src=this.imgData}rotateImage(){const Z=document.getElementById("img-upload-canvas");let Re=new Image;Re.src=Z.toDataURL(),Re.onload=()=>{let st=Z.height,on=Z.width;Z.width=st,Z.height=on,st=Z.height,on=Z.width;const In=Z.getContext("2d");In.save(),In.translate(on,st/on),In.rotate(Math.PI/2),In.drawImage(Re,0,0),In.restore(),Re=null,this.refreshImageFromCanvas()}}performUpload(){var Z=this;return(0,B.Z)(function*(){if(!Z.imgData)return void(yield Z.appManager.showToastNotification("Select an image to upload."));const Re={chargePointID:Z.chargePointId,comment:Z.comment,imageDataBase64:Z.imgData};yield Z.appManager.showLoadingProgress("Uploading photo..");try{yield Z.appManager.submitMediaItem(Re),Z.appManager.dismissLoadingProgress().then(()=>{Z.appManager.showToastNotification("Upload completed"),Z.modalController.dismiss()}),Z.appManager.analytics.appEvent("MediaUpload","Completed")}catch{yield Z.appManager.dismissLoadingProgress(),yield Z.appManager.showToastNotification("Upload failed, please try again."),Z.appManager.analytics.appEvent("MediaUpload","Failed")}})()}cancel(){var Z=this;return(0,B.Z)(function*(){yield Z.modalController.dismiss()})()}static \u0275fac=function(Re){return new(Re||ae)(m.Y36(l.X1),m.Y36(h.c),m.Y36(l.SH),m.Y36(te.IN),m.Y36(de.z))};static \u0275cmp=m.Xpm({type:ae,selectors:[["ng-component"]],decls:32,vars:3,consts:[[1,"media-upload"],[1,"ion-padding"],[1,"banner"],[1,"upload"],[3,"click"],["name","camera","aria-label","camera","slot","start"],["type","file","required","","id","img-upload-media",3,"change"],["inputFile",""],["id","img-upload-canvas",2,"display","none","width","500","height","500","border","1px solid red"],[4,"ngIf"],["slot","secondary"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],["slot","start"],["slot","end"],["name","refresh","slot","start"],["position","floating"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["id","preview",2,"max-width","500px"]],template:function(Re,st){if(1&Re){const on=m.EpF();m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),m._uU(3," Share Photo "),m.qZA()()(),m.TgZ(4,"ion-content",0)(5,"div",1)(6,"div",2)(7,"h1"),m._uU(8),m.qZA(),m.TgZ(9,"p"),m._uU(10),m.qZA()(),m.TgZ(11,"p"),m._uU(12,"You can upload a photo from your device or take a new photo: "),m.qZA(),m.TgZ(13,"div",3)(14,"ion-button",4),m.NdJ("click",function(){m.CHM(on);const bi=m.MAs(19);return m.KtG(bi.click())}),m._UZ(15,"ion-icon",5),m.TgZ(16,"ion-label"),m._uU(17,"Choose Photo.."),m.qZA()(),m.TgZ(18,"input",6,7),m.NdJ("change",function(){return st.loadCameraOrLibraryImage()}),m.qZA()(),m._UZ(20,"canvas",8),m.YNc(21,nt,16,1,"ion-card",9),m.qZA()(),m.TgZ(22,"ion-footer")(23,"ion-toolbar")(24,"ion-buttons",10)(25,"ion-button",4),m.NdJ("click",function(){return st.cancel()}),m._UZ(26,"ion-icon",11),m._uU(27," Cancel "),m.qZA()(),m.TgZ(28,"ion-buttons",12)(29,"ion-button",4),m.NdJ("click",function(){return st.performUpload()}),m._uU(30," Upload "),m._UZ(31,"ion-icon",13),m.qZA()()()()}2&Re&&(m.xp6(8),m.Oqu(st.poi.AddressInfo.Title),m.xp6(2),m.Oqu(st.poi.AddressInfo.AddressLine1),m.xp6(11),m.Q6J("ngIf",null!=st.imgData))},dependencies:[ie.O5,fe.JJ,fe.On,te.YG,te.Sm,te.PM,te.FN,te.W2,te.fr,te.Gu,te.gu,te.pK,te.Ie,te.Q$,te.q_,te.wd,te.sr,te.j9],styles:[".upload[_ngcontent-%COMP%]   input[type=file][_ngcontent-%COMP%]{position:fixed;top:-1000px}"]})}return ae})();var oe=P(6800);function xe(ae,ft){if(1&ae&&(m.TgZ(0,"ion-select-option",19),m._uU(1),m.qZA()),2&ae){const Z=ft.$implicit;m.Q6J("value",Z.ID),m.xp6(),m.Oqu(Z.Title)}}function Ie(ae,ft){if(1&ae&&(m.TgZ(0,"ion-select-option",19),m._uU(1),m.qZA()),2&ae){const Z=ft.$implicit;m.Q6J("value",Z.ID),m.xp6(),m.Oqu(Z.Title)}}let Ae=(()=>{class ae{navParams;appManager;nav;zone;loadingController;modalController;logging;router;commentModel;poi;commentTypes;checkinTypes;constructor(Z,Re,st,on,In,bi,wi,Ri){this.navParams=Z,this.appManager=Re,this.nav=st,this.zone=on,this.loadingController=In,this.modalController=bi,this.logging=wi,this.router=Ri,this.commentModel={ChargePointID:this.navParams.get("id"),Comment:"",CheckinStatusTypeID:10,CommentTypeID:10,Rating:null},this.poi=this.navParams.get("poi"),this.commentTypes=Re.referenceDataManager.getCommentTypes(!0,!0),this.checkinTypes=Re.referenceDataManager.getCheckinStatusTypes(!0,!0)}onPageWillEnter(){}cancel(){this.modalController.dismiss()}add(){var Z=this;return(0,B.Z)(function*(){const Re=yield Z.loadingController.create({message:"Sending .."});yield Re.present(),(yield Z.appManager.submitComment(Z.commentModel).catch(on=>{Z.appManager.showToastNotification("There was a problem submitting your comment."),Z.loadingController.dismiss(),Z.appManager.analytics.appEvent("Comment","Failed")}))&&(Z.logging.log("Comment submitted"),yield Re.dismiss(),yield Z.modalController.dismiss(),Z.appManager.analytics.appEvent("Comment","Submitted"))})()}static \u0275fac=function(Re){return new(Re||ae)(m.Y36(l.X1),m.Y36(h.c),m.Y36(l.SH),m.Y36(m.R0b),m.Y36(te.HT),m.Y36(te.IN),m.Y36(de.z),m.Y36(oe.F0))};static \u0275cmp=m.Xpm({type:ae,selectors:[["ng-component"]],decls:53,vars:8,consts:[["color","primary"],[1,"comment-page","ion-padding"],[1,"banner"],[1,"ion-padding"],["position","stacked"],[3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["type","text","placeholder","(optional comment)",3,"ngModel","ngModelChange"],["value","5"],["value","4"],["value","3"],["value","2"],["value","1"],["value",""],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["name","send","slot","end"],[3,"value"]],template:function(Re,st){1&Re&&(m.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),m._uU(3," Add Comment "),m.qZA()()(),m.TgZ(4,"ion-content",1)(5,"div",2)(6,"h1"),m._uU(7),m.qZA(),m.TgZ(8,"p"),m._uU(9),m.qZA()(),m.TgZ(10,"p",3),m._uU(11,"Recent Check-ins are a big help to other drivers when planning their journey. Tell everyone what you thought about this charging location. "),m.qZA(),m.TgZ(12,"ion-list")(13,"ion-item")(14,"ion-label",4),m._uU(15,"Comment Type"),m.qZA(),m.TgZ(16,"ion-select",5),m.NdJ("ngModelChange",function(In){return st.commentModel.CommentTypeID=In}),m.YNc(17,xe,2,2,"ion-select-option",6),m.qZA()(),m.TgZ(18,"ion-item")(19,"ion-label",4),m._uU(20,"What Did You Think?"),m.qZA(),m.TgZ(21,"ion-input",7),m.NdJ("ngModelChange",function(In){return st.commentModel.Comment=In}),m.qZA()(),m.TgZ(22,"ion-item")(23,"ion-label",4),m._uU(24,"Did You Successfully Charge?"),m.qZA(),m.TgZ(25,"ion-select",5),m.NdJ("ngModelChange",function(In){return st.commentModel.CheckinStatusTypeID=In}),m.YNc(26,Ie,2,2,"ion-select-option",6),m.qZA()(),m.TgZ(27,"ion-item")(28,"ion-label",4),m._uU(29,"Your Rating"),m.qZA(),m.TgZ(30,"ion-select",5),m.NdJ("ngModelChange",function(In){return st.commentModel.Rating=In}),m.TgZ(31,"ion-select-option",8),m._uU(32,"5 - Excellent"),m.qZA(),m.TgZ(33,"ion-select-option",9),m._uU(34,"4 - Good"),m.qZA(),m.TgZ(35,"ion-select-option",10),m._uU(36,"3 - Average"),m.qZA(),m.TgZ(37,"ion-select-option",11),m._uU(38,"2 - Not Good"),m.qZA(),m.TgZ(39,"ion-select-option",12),m._uU(40,"1 - Bad"),m.qZA(),m.TgZ(41,"ion-select-option",13),m._uU(42,"Not Rated"),m.qZA()()()()(),m.TgZ(43,"ion-footer")(44,"ion-toolbar")(45,"ion-buttons",14)(46,"ion-button",15),m.NdJ("click",function(){return st.cancel()}),m._UZ(47,"ion-icon",16),m._uU(48," Cancel "),m.qZA()(),m.TgZ(49,"ion-buttons",17)(50,"ion-button",15),m.NdJ("click",function(){return st.add()}),m._uU(51," Submit "),m._UZ(52,"ion-icon",18),m.qZA()()()()),2&Re&&(m.xp6(7),m.Oqu(st.poi.AddressInfo.Title),m.xp6(2),m.Oqu(st.poi.AddressInfo.AddressLine1),m.xp6(7),m.Q6J("ngModel",st.commentModel.CommentTypeID),m.xp6(),m.Q6J("ngForOf",st.commentTypes),m.xp6(4),m.Q6J("ngModel",st.commentModel.Comment),m.xp6(4),m.Q6J("ngModel",st.commentModel.CheckinStatusTypeID),m.xp6(),m.Q6J("ngForOf",st.checkinTypes),m.xp6(4),m.Q6J("ngModel",st.commentModel.Rating))},dependencies:[ie.sg,fe.JJ,fe.On,te.YG,te.Sm,te.W2,te.fr,te.Gu,te.gu,te.pK,te.Ie,te.Q$,te.q_,te.t9,te.n0,te.wd,te.sr,te.QI,te.j9],encapsulation:2})}return ae})();var ye=P(7777),Ue=P(4669),ct=P(8767),X=P(6662),ve=P(866),me=P(2618),Fe=P(1163);function De(ae,ft){if(1&ae&&(m.TgZ(0,"div")(1,"small"),m._uU(2),m.qZA()()),2&ae){const Z=m.oxw(2);m.xp6(2),m.Oqu(Z.connectionSummary)}}function ze(ae,ft){if(1&ae&&(m.TgZ(0,"div")(1,"small"),m._uU(2),m.qZA()()),2&ae){const Z=m.oxw(2);m.xp6(2),m.Oqu(Z.poi.OperatorInfo.Title)}}function Ke(ae,ft){1&ae&&(m.TgZ(0,"div")(1,"small"),m._uU(2,"[Submission Awaiting Review]"),m.qZA()())}function Ht(ae,ft){if(1&ae){const Z=m.EpF();m.ynx(0),m.TgZ(1,"ion-button",26),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw(2);return m.KtG(st.addFavourite())}),m._UZ(2,"ion-icon",27),m.TgZ(3,"ion-label"),m._uU(4,"Favourite"),m.qZA()(),m.TgZ(5,"ion-button",28),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw(2);return m.KtG(st.edit())}),m._UZ(6,"ion-icon",29),m.TgZ(7,"ion-label"),m._uU(8,"Edit"),m.qZA()(),m.BQk()}}function dn(ae,ft){if(1&ae){const Z=m.EpF();m.ynx(0),m.TgZ(1,"ion-button",30),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw(2);return m.KtG(st.launchNavigation())}),m._UZ(2,"ion-icon",31),m.TgZ(3,"ion-label"),m._uU(4,"Navigate"),m.qZA()(),m.BQk()}}function _n(ae,ft){if(1&ae){const Z=m.EpF();m.ynx(0),m.TgZ(1,"ion-button",32),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw(2);return m.KtG(st.addComment())}),m._UZ(2,"ion-icon",33),m.TgZ(3,"ion-label"),m._uU(4,"Add Comment"),m.qZA()(),m.BQk()}}function Ut(ae,ft){if(1&ae){const Z=m.EpF();m.ynx(0),m.TgZ(1,"ion-button",34),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw(2);return m.KtG(st.addMedia())}),m._UZ(2,"ion-icon",35),m.TgZ(3,"ion-label"),m._uU(4," Add Photo"),m.qZA()(),m.BQk()}}function We(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(),m.hij(" ",Z.poi.AddressInfo.AddressLine1,"")}}function Ne(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(),m.hij(" ",Z.poi.AddressInfo.AddressLine2,"")}}function ke(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(),m.hij(" ",Z.poi.AddressInfo.Town,"")}}function it(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(),m.hij(" ",Z.poi.AddressInfo.StateOrProvince,"")}}function Qt(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(),m.hij(" ",Z.poi.AddressInfo.Postcode,"")}}function mt(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(),m.hij(" ",Z.poi.AddressInfo.Country.Title,"")}}function an(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(),m.hij(" ",Z.poi.AddressInfo.AccessComments," ")}}function tt(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"ion-icon",40),m.TgZ(2,"span",38),m._uU(3),m.qZA()()),2&ae){const Z=m.oxw(4);m.xp6(3),m.Oqu(Z.poi.AddressInfo.ContactTelephone1)}}function pt(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"ion-icon",40),m.TgZ(2,"span",38),m._uU(3),m.qZA()()),2&ae){const Z=m.oxw(4);m.xp6(3),m.Oqu(Z.poi.AddressInfo.ContactTelephone2)}}function Xt(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"ion-icon",41),m.TgZ(2,"span",38),m._uU(3),m.qZA()()),2&ae){const Z=m.oxw(4);m.xp6(3),m.Oqu(Z.poi.AddressInfo.ContactEmail)}}function bn(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"ion-icon",42),m.TgZ(2,"span",38)(3,"a",43),m._uU(4),m.qZA()()()),2&ae){const Z=m.oxw(4);m.xp6(3),m.s9C("href",Z.poi.AddressInfo.RelatedURL,m.LSH),m.xp6(),m.Oqu(Z.poi.AddressInfo.RelatedURL)}}function Cn(ae,ft){if(1&ae&&(m.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-subtitle"),m._uU(3),m.ALo(4,"translate"),m.qZA()(),m.TgZ(5,"ion-card-content")(6,"ion-grid")(7,"ion-row")(8,"ion-col")(9,"ion-label"),m._uU(10),m.ALo(11,"translate"),m.qZA(),m.TgZ(12,"div",38),m.YNc(13,We,2,1,"div",0)(14,Ne,2,1,"div",0)(15,ke,2,1,"div",0)(16,it,2,1,"div",0)(17,Qt,2,1,"div",0)(18,mt,2,1,"div",0),m.qZA()(),m.TgZ(19,"ion-col"),m.YNc(20,an,2,1,"p",0)(21,tt,4,1,"p",0)(22,pt,4,1,"p",0)(23,Xt,4,1,"p",0)(24,bn,5,2,"p",0),m.qZA()(),m.TgZ(25,"ion-row")(26,"ion-col")(27,"ion-label",39),m._uU(28),m.ALo(29,"number"),m.ALo(30,"number"),m.qZA()()()()()()),2&ae){const Z=m.oxw(3);m.xp6(3),m.hij(" ",m.lcZ(4,15,"ocm.details.location.sectionTitle")," "),m.xp6(7),m.hij(" ",m.lcZ(11,17,"ocm.details.location.address"),""),m.xp6(3),m.Q6J("ngIf",Z.poi.AddressInfo.AddressLine1),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.AddressLine2),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.Town),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.StateOrProvince),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.Postcode),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.Country),m.xp6(2),m.Q6J("ngIf",Z.poi.AddressInfo.AccessComments),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.ContactTelephone1),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.ContactTelephone2),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.ContactEmail),m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo.RelatedURL),m.xp6(4),m.AsE(" Lat/Long: ",m.xi3(29,19,Z.poi.AddressInfo.Latitude,"1.1-6")," , ",m.xi3(30,22,Z.poi.AddressInfo.Longitude,"1.1-6")," ")}}function It(ae,ft){if(1&ae&&(m.TgZ(0,"p")(1,"span",44),m._uU(2),m.ALo(3,"translate"),m.qZA(),m.TgZ(4,"span",38),m._uU(5),m.qZA()()),2&ae){const Z=m.oxw(3);m.xp6(2),m.hij("",m.lcZ(3,2,"ocm.details.numberOfPoints"),":"),m.xp6(3),m.Oqu(Z.poi.NumberOfPoints)}}function pe(ae,ft){if(1&ae&&(m.TgZ(0,"p")(1,"span",44),m._uU(2),m.ALo(3,"translate"),m.qZA(),m.TgZ(4,"span",38),m._uU(5),m.qZA()()),2&ae){const Z=m.oxw(3);m.xp6(2),m.hij("",m.lcZ(3,2,"ocm.details.operationalStatus"),":"),m.xp6(3),m.hij(" ",Z.poi.StatusType.Title," ")}}function lt(ae,ft){if(1&ae&&(m.TgZ(0,"p")(1,"span",44),m._uU(2),m.ALo(3,"translate"),m.qZA(),m.TgZ(4,"span",38),m._uU(5),m.qZA()()),2&ae){const Z=m.oxw(3);m.xp6(2),m.hij("",m.lcZ(3,2,"ocm.details.usageType"),":"),m.xp6(3),m.Oqu(Z.poi.UsageType.Title)}}function Zt(ae,ft){if(1&ae&&(m.TgZ(0,"p")(1,"span",44),m._uU(2),m.ALo(3,"translate"),m.qZA(),m.TgZ(4,"span",38),m._uU(5),m.qZA()()),2&ae){const Z=m.oxw(3);m.xp6(2),m.hij("",m.lcZ(3,2,"ocm.details.usageCost"),":"),m.xp6(3),m.hij(" ",Z.poi.UsageCost,"")}}function hn(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"br"),m._uU(2),m.ALo(3,"translate"),m._UZ(4,"br"),m.TgZ(5,"span",38),m._uU(6),m.qZA()()),2&ae){const Z=m.oxw(3);m.xp6(2),m.hij("",m.lcZ(3,2,"ocm.details.generalComments"),": "),m.xp6(4),m.Oqu(Z.poi.GeneralComments)}}function Yt(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"ion-icon",46),m._uU(2),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(2),m.hij(" ",Z.poi.OperatorInfo.WebsiteURL," ")}}function Ft(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"ion-icon",41),m._uU(2),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(2),m.hij(" ",Z.poi.OperatorInfo.ContactEmail," ")}}function Un(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m._UZ(1,"ion-icon",41),m._uU(2),m.qZA()),2&ae){const Z=m.oxw(4);m.xp6(2),m.hij(" ",Z.poi.OperatorInfo.FaultReportEmail," ")}}function Ve(ae,ft){if(1&ae&&(m.TgZ(0,"ion-card")(1,"ion-card-header")(2,"ion-card-subtitle"),m._uU(3),m.ALo(4,"translate"),m.qZA()(),m.TgZ(5,"ion-card-content")(6,"div",38)(7,"p",45),m._uU(8),m.qZA(),m.YNc(9,Yt,3,1,"p",0)(10,Ft,3,1,"p",0)(11,Un,3,1,"p",0),m.qZA()()()),2&ae){const Z=m.oxw(3);m.xp6(3),m.hij(" ",m.lcZ(4,5,"ocm.details.operator.sectionTitle")," "),m.xp6(5),m.hij(" ",Z.poi.OperatorInfo.Title," "),m.xp6(),m.Q6J("ngIf",Z.poi.OperatorInfo.WebsiteURL),m.xp6(),m.Q6J("ngIf",null!=Z.poi.OperatorInfo.ContactEmail),m.xp6(),m.Q6J("ngIf",null!=Z.poi.OperatorInfo.FaultReportEmail&&Z.poi.OperatorInfo.FaultReportEmail!=Z.poi.OperatorInfo.ContactEmail)}}function Pt(ae,ft){if(1&ae){const Z=m.EpF();m.TgZ(0,"a",48),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw(4);return m.KtG(st.launchURL(st.poi.DataProvider.WebsiteURL))}),m._uU(1),m.qZA()}if(2&ae){const Z=m.oxw(4);m.xp6(),m.Oqu(Z.poi.DataProvider.WebsiteURL)}}function Kt(ae,ft){if(1&ae&&(m.TgZ(0,"div",38)(1,"h3"),m._uU(2),m.ALo(3,"translate"),m.qZA(),m.TgZ(4,"p"),m._uU(5),m.qZA(),m.YNc(6,Pt,2,1,"a",47),m.TgZ(7,"p"),m._uU(8),m.qZA()()),2&ae){const Z=m.oxw(3);m.xp6(2),m.hij(" ",m.lcZ(3,4,"ocm.details.dataProvider.sectionTitle")," "),m.xp6(3),m.Oqu(null==Z.poi.DataProvider?null:Z.poi.DataProvider.Title),m.xp6(),m.Q6J("ngIf",Z.poi.DataProvider.WebsiteURL),m.xp6(2),m.Oqu(null==Z.poi.DataProvider?null:Z.poi.DataProvider.License)}}function wn(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m.YNc(1,Cn,31,25,"ion-card",0),m.TgZ(2,"ion-card")(3,"ion-card-header")(4,"ion-card-subtitle"),m._uU(5),m.ALo(6,"translate"),m.qZA()(),m.TgZ(7,"ion-card-content"),m.YNc(8,It,6,4,"p",0),m._UZ(9,"app-equipment-details",36),m.qZA()(),m.TgZ(10,"ion-card")(11,"ion-card-header")(12,"ion-card-subtitle"),m._uU(13,"Usage Restrictions"),m.qZA()(),m.TgZ(14,"ion-card-content"),m.YNc(15,pe,6,4,"p",0)(16,lt,6,4,"p",0)(17,Zt,6,4,"p",0)(18,hn,7,4,"p",0),m.qZA()(),m.YNc(19,Ve,12,7,"ion-card",0),m.TgZ(20,"ion-card")(21,"ion-card-header"),m._uU(22),m.ALo(23,"translate"),m.qZA(),m.TgZ(24,"ion-card-content"),m.YNc(25,Kt,9,6,"div",37),m.qZA()()()),2&ae){const Z=m.oxw(2);m.xp6(),m.Q6J("ngIf",Z.poi.AddressInfo),m.xp6(4),m.hij(" ",m.lcZ(6,11,"ocm.details.equipment.sectionTitle")," "),m.xp6(3),m.Q6J("ngIf",null!=Z.poi.NumberOfPoints),m.xp6(),m.Q6J("item",Z.poi),m.xp6(6),m.Q6J("ngIf",null!=Z.poi.StatusType),m.xp6(),m.Q6J("ngIf",null!=Z.poi.UsageType),m.xp6(),m.Q6J("ngIf",null!=Z.poi.UsageCost),m.xp6(),m.Q6J("ngIf",null!=Z.poi.GeneralComments),m.xp6(),m.Q6J("ngIf",Z.poi.OperatorInfo),m.xp6(3),m.hij(" ",m.lcZ(23,13,"ocm.details.advancedDetails")," "),m.xp6(3),m.Q6J("ngIf",Z.poi.DataProvider)}}function ei(ae,ft){if(1&ae&&m._UZ(0,"img",51),2&ae){const Z=m.oxw().$implicit;m.s9C("src",null==Z.User?null:Z.User.ProfileImageURL,m.LSH)}}function di(ae,ft){if(1&ae&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw().$implicit;m.xp6(),m.Oqu(Z.User.Username)}}function Lr(ae,ft){if(1&ae&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw().$implicit;m.xp6(),m.Oqu(Z.Username)}}function Mi(ae,ft){if(1&ae&&(m.TgZ(0,"p",38),m._uU(1),m.qZA()),2&ae){const Z=m.oxw().$implicit;m.xp6(),m.hij(" ",null==Z.CommentType?null:Z.CommentType.Title," ")}}function dr(ae,ft){if(1&ae&&(m.TgZ(0,"p")(1,"span",44),m._uU(2,"Rating:"),m.qZA(),m.TgZ(3,"span",38),m._uU(4),m.qZA()()),2&ae){const Z=m.oxw().$implicit;m.xp6(4),m.hij("",Z.Rating," out of 5")}}function Ei(ae,ft){1&ae&&(m.ynx(0),m._UZ(1,"ion-icon",52),m.BQk())}function fn(ae,ft){1&ae&&(m.ynx(0),m._UZ(1,"ion-icon",53),m.BQk())}function Li(ae,ft){if(1&ae&&(m.TgZ(0,"p"),m.YNc(1,Ei,2,0,"ng-container",0)(2,fn,2,0,"ng-container",0),m._uU(3),m.qZA()),2&ae){const Z=m.oxw().$implicit;m.xp6(),m.Q6J("ngIf",!0===Z.CheckinStatusType.IsPositive),m.xp6(),m.Q6J("ngIf",!1===Z.CheckinStatusType.IsPositive),m.xp6(),m.hij(" ",Z.CheckinStatusType.Title," ")}}function gn(ae,ft){if(1&ae&&(m.TgZ(0,"ion-card")(1,"ion-item")(2,"ion-avatar",19),m.YNc(3,ei,1,1,"img",50),m.qZA(),m.TgZ(4,"ion-label"),m.YNc(5,di,2,1,"span",0)(6,Lr,2,1,"span",0),m.qZA(),m.TgZ(7,"ion-label",20),m._uU(8),m.ALo(9,"date"),m.qZA()(),m.TgZ(10,"ion-card-content")(11,"p"),m._uU(12),m.qZA(),m.YNc(13,Mi,2,1,"p",37)(14,dr,5,1,"p",0)(15,Li,4,3,"p",0),m.qZA()()),2&ae){const Z=ft.$implicit;m.xp6(3),m.Q6J("ngIf",Z.User&&Z.User.ProfileImageURL),m.xp6(2),m.Q6J("ngIf",Z.User),m.xp6(),m.Q6J("ngIf",!Z.User),m.xp6(2),m.hij(" ",m.lcZ(9,8,Z.DateCreated)," "),m.xp6(4),m.Oqu(Z.Comment),m.xp6(),m.Q6J("ngIf",10!=Z.CommentTypeID),m.xp6(),m.Q6J("ngIf",Z.Rating),m.xp6(),m.Q6J("ngIf",Z.CheckinStatusType)}}function Fn(ae,ft){if(1&ae&&(m.ynx(0),m.YNc(1,gn,16,10,"ion-card",49),m.BQk()),2&ae){const Z=m.oxw(3);m.xp6(),m.Q6J("ngForOf",Z.poi.UserComments)}}function Jt(ae,ft){1&ae&&(m.ynx(0),m.TgZ(1,"ion-card")(2,"ion-card-content")(3,"p"),m._uU(4),m.ALo(5,"translate"),m.qZA()()(),m.BQk()),2&ae&&(m.xp6(4),m.hij(" ",m.lcZ(5,1,"ocm.details.commentsAndRatings.addPrompt")," "))}function Bi(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m.YNc(1,Fn,2,1,"ng-container",0)(2,Jt,6,3,"ng-container",0),m.qZA()),2&ae){const Z=m.oxw(2);m.xp6(),m.Q6J("ngIf",1==Z.poi._hasComments),m.xp6(),m.Q6J("ngIf",0==Z.poi._hasComments)}}function ut(ae,ft){if(1&ae&&m._UZ(0,"img",51),2&ae){const Z=m.oxw().$implicit;m.s9C("src",null==Z.User?null:Z.User.ProfileImageURL,m.LSH)}}function he(ae,ft){if(1&ae&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw().$implicit;m.xp6(),m.Oqu(Z.User.Username)}}function _e(ae,ft){if(1&ae&&(m.TgZ(0,"span"),m._uU(1),m.qZA()),2&ae){const Z=m.oxw().$implicit;m.xp6(),m.Oqu(Z.Username)}}function ot(ae,ft){if(1&ae&&(m.TgZ(0,"ion-card"),m._UZ(1,"img",51),m.TgZ(2,"ion-item")(3,"ion-avatar",19),m.YNc(4,ut,1,1,"img",50),m.qZA(),m.TgZ(5,"ion-label"),m.YNc(6,he,2,1,"span",0)(7,_e,2,1,"span",0),m.qZA(),m.TgZ(8,"ion-label",20),m._uU(9),m.ALo(10,"date"),m.qZA()(),m.TgZ(11,"ion-card-content")(12,"p"),m._uU(13),m.qZA()()()),2&ae){const Z=ft.$implicit;m.xp6(),m.s9C("src",Z.ItemMediumURL,m.LSH),m.xp6(3),m.Q6J("ngIf",Z.User&&Z.User.ProfileImageURL),m.xp6(2),m.Q6J("ngIf",Z.User),m.xp6(),m.Q6J("ngIf",!Z.User),m.xp6(2),m.hij(" ",m.lcZ(10,6,Z.DateCreated)," "),m.xp6(4),m.Oqu(Z.Comment)}}function yt(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m.YNc(1,ot,14,8,"ion-card",49),m.qZA()),2&ae){const Z=m.oxw(3);m.xp6(),m.Q6J("ngForOf",Z.poi.MediaItems)}}function Dt(ae,ft){1&ae&&(m.ynx(0),m.TgZ(1,"ion-card")(2,"ion-card-content")(3,"p"),m._uU(4),m.ALo(5,"translate"),m.qZA()()(),m.BQk()),2&ae&&(m.xp6(4),m.hij(" ",m.lcZ(5,1,"ocm.details.mediaItems.addPrompt")," "))}function jt(ae,ft){if(1&ae&&(m.TgZ(0,"div"),m.YNc(1,yt,2,1,"div",0)(2,Dt,6,3,"ng-container",0),m.qZA()),2&ae){const Z=m.oxw(2);m.xp6(),m.Q6J("ngIf",Z.poi._hasPhotos),m.xp6(),m.Q6J("ngIf",0==Z.poi._hasPhotos)}}function Vt(ae,ft){if(1&ae&&(m.TgZ(0,"p",54),m._uU(1),m.qZA()),2&ae){const Z=m.oxw(2);m.xp6(),m.hij(" ",Z.json,"")}}function dt(ae,ft){if(1&ae){const Z=m.EpF();m.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"h2"),m._uU(4),m.qZA(),m.TgZ(5,"div")(6,"small"),m._uU(7),m.qZA()(),m.YNc(8,De,3,1,"div",0)(9,ze,3,1,"div",0)(10,Ke,3,0,"div",0),m.TgZ(11,"ion-badge",3),m._uU(12),m.ALo(13,"number"),m.qZA()(),m.TgZ(14,"ion-fab",4)(15,"ion-fab-button"),m._UZ(16,"ion-icon",5),m.qZA(),m.TgZ(17,"ion-fab-list",6)(18,"ion-fab-button",7),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw();return m.KtG(st.addComment())}),m._UZ(19,"ion-icon",8),m.qZA(),m.TgZ(20,"ion-fab-button",9),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw();return m.KtG(st.addMedia())}),m._UZ(21,"ion-icon",10),m.qZA(),m.TgZ(22,"ion-fab-button",11),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw();return m.KtG(st.addFavourite())}),m._UZ(23,"ion-icon",12),m.qZA(),m.TgZ(24,"ion-fab-button",13),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw();return m.KtG(st.edit())}),m._UZ(25,"ion-icon",14),m.qZA(),m.TgZ(26,"ion-fab-button",15),m.NdJ("click",function(){m.CHM(Z);const st=m.oxw();return m.KtG(st.refresh())}),m._UZ(27,"ion-icon",16),m.qZA()()()(),m.TgZ(28,"ion-refresher",17),m.NdJ("ionRefresh",function(st){m.CHM(Z);const on=m.oxw();return m.KtG(on.refresh(st))}),m._UZ(29,"ion-refresher-content",18),m.qZA(),m.TgZ(30,"ion-toolbar")(31,"ion-buttons",19),m.YNc(32,Ht,9,0,"ng-container",0),m.qZA(),m.TgZ(33,"ion-buttons",20),m.YNc(34,dn,5,0,"ng-container",0)(35,_n,5,0,"ng-container",0)(36,Ut,5,0,"ng-container",0),m.qZA()(),m.TgZ(37,"ion-segment",21),m.NdJ("ngModelChange",function(st){m.CHM(Z);const on=m.oxw();return m.KtG(on.selectedTab=st)}),m.TgZ(38,"ion-segment-button",22)(39,"ion-label"),m._uU(40," Details "),m.qZA()(),m.TgZ(41,"ion-segment-button",23)(42,"ion-label"),m._uU(43),m.qZA()(),m.TgZ(44,"ion-segment-button",24)(45,"ion-label"),m._uU(46),m.qZA()()(),m.YNc(47,wn,26,15,"div",0)(48,Bi,3,2,"div",0)(49,jt,3,2,"div",0)(50,Vt,2,1,"p",25),m.qZA()}if(2&ae){const Z=m.oxw();m.xp6(),m.Udp("background-image",Z.backdropImage?"url("+Z.backdropImage+")":""),m.xp6(3),m.hij(" ",Z.poi.AddressInfo.Title," "),m.xp6(3),m.hij("OCM-",Z.poi.ID,""),m.xp6(),m.Q6J("ngIf",Z.connectionSummary),m.xp6(),m.Q6J("ngIf",Z.poi.OperatorInfo),m.xp6(),m.Q6J("ngIf",1==Z.poi.SubmissionStatusTypeID),m.xp6(2),m.Oqu(m.xi3(13,19,Z.avgRating,"1.1-1")),m.xp6(20),m.Q6J("ngIf","location"==Z.selectedTab),m.xp6(2),m.Q6J("ngIf","location"==Z.selectedTab),m.xp6(),m.Q6J("ngIf","comments"==Z.selectedTab),m.xp6(),m.Q6J("ngIf","media"==Z.selectedTab),m.xp6(),m.Q6J("ngModel",Z.selectedTab),m.xp6(6),m.hij("Comments (",Z.poi.UserComments?Z.poi.UserComments.length:0,")"),m.xp6(3),m.hij(" Photos (",Z.poi.MediaItems?Z.poi.MediaItems.length:0,")"),m.xp6(),m.Q6J("ngIf","location"==Z.selectedTab),m.xp6(),m.Q6J("ngIf","comments"==Z.selectedTab),m.xp6(),m.Q6J("ngIf","media"==Z.selectedTab),m.xp6(),m.Q6J("ngIf",1==Z.appManager.isDebugMode)}}function Bt(ae,ft){1&ae&&(m.TgZ(0,"div")(1,"h2"),m._uU(2,"POI Not Found"),m.qZA(),m.TgZ(3,"p"),m._uU(4,"The POI details could not be loaded."),m.qZA()())}let Nn=(()=>{class ae{appManager;nav;translate;logging;modalController;actionSheetController;poiManager;router;poi;selectedTab;json;hasNavBar=!1;backdropImage;avgRating;connectionSummary;constructor(Z,Re,st,on,In,bi,wi,Ri){this.appManager=Z,this.nav=Re,this.translate=st,this.logging=on,this.modalController=In,this.actionSheetController=bi,this.poiManager=wi,this.router=Ri}ngOnChanges(Z){if(this.logging.log("In ngOnChanges of POI Details"),null!=this.poi&&null!=this.poi.AddressInfo){if(this.selectedTab="location",null!=this.poi.MediaItems&&this.poi.MediaItems.length>0){this.poi._hasPhotos=!0;for(let Re of this.poi.MediaItems)Re.ItemMediumURL=Re.ItemThumbnailURL.replace(".thmb.",".medi.");this.backdropImage=this.poi.MediaItems[this.poi.MediaItems.length-1].ItemThumbnailURL.replace(".thmb.",".medi.")}else this.poi._hasPhotos=!1,this.backdropImage=null;if(null!=this.poi.UserComments&&this.poi.UserComments.length>0){this.poi._hasComments=!0;try{let Re=this.poi.UserComments.filter(st=>st.Rating>0);if(Re.length>0){let st=0;for(let on of Re)st+=on.Rating;this.avgRating=st/Re.length}else this.avgRating=null}catch{}}else this.poi._hasComments=!1;if(this.poi.Connections&&this.poi.Connections.length>0){let Re="";for(let st of this.poi.Connections)-1==Re.indexOf(st.ConnectionType.Title)&&(Re+=(""!=Re?", ":"")+st.ConnectionType.Title);this.connectionSummary=Re}}}ngOnInit(){this.logging.log("In ngInit of POI Details")}get staticMapURL(){return"https://maps.googleapis.com/maps/api/staticmap?key="+(new ye.X).googleMapsAPIKey+"&center="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude+"&zoom=13&scale=2&size="+this.staticMapSize+"&maptype=roadmap&format=jpg&visual_refresh=true&markers=size:small%7Ccolor:0xff0000%7Clabel:%7C"+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude}get staticMapSize(){return 0===this.appManager.clientWidth?"240x100":this.appManager.clientWidth>=800?"640x100":this.appManager.clientWidth>=400?"400x100":"240x100"}continueAddComment(){var Z=this;return(0,B.Z)(function*(){const Re=yield Z.modalController.create({component:Ae,componentProps:{id:Z.poi.ID,poi:Z.poi}});setTimeout(()=>{Z.refresh()},1e3),yield Re.present()})()}addComment(){var Z=this;return(0,B.Z)(function*(){if(Z.appManager.isUserAuthenticated(!0))yield Z.continueAddComment();else{const Re=yield Z.modalController.create({component:ct.F});Re.onDidDismiss().then((0,B.Z)(function*(){Z.appManager.isUserAuthenticated(!0)&&(yield Z.continueAddComment())})),yield Re.present()}})()}continueAddMedia(){var Z=this;return(0,B.Z)(function*(){const Re=yield Z.modalController.create({component:Ce,componentProps:{id:Z.poi.ID,poi:Z.poi}});Re.onDidDismiss().then(()=>{setTimeout(()=>{Z.refresh()},1e3)}),yield Re.present()})()}addMedia(){var Z=this;return(0,B.Z)(function*(){if(Z.appManager.isUserAuthenticated(!0))yield Z.continueAddMedia();else{const Re=yield Z.modalController.create({component:ct.F});Re.onDidDismiss().then((0,B.Z)(function*(){Z.appManager.isUserAuthenticated(!0)&&(yield Z.continueAddMedia())})),yield Re.present()}})()}addFavourite(){var Z=this;return(0,B.Z)(function*(){yield(yield Z.actionSheetController.create({header:"Add Favourite",buttons:[{text:"Add to Journey",handler:()=>{Z.modalController.create({component:Me,componentProps:{poi:Z.poi}}).then(st=>st.present())}},{text:"Cancel",role:"cancel",handler:()=>{}}]})).present()})()}launchNavigation(){this.appManager.isPlatform("ios")?this.appManager.launchWebPage("https://maps.apple.com/?ll="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude):this.appManager.launchWebPage("https://maps.google.com/?q="+this.poi.AddressInfo.Latitude+","+this.poi.AddressInfo.Longitude)}launchURL(Z){this.appManager.launchWebPage(Z)}continueEdit(){var Z=this;return(0,B.Z)(function*(){const Re=yield Z.modalController.create({component:X.Y,componentProps:{id:Z.poi.ID}});return Re.onDidDismiss().then(st=>{Z.refresh()}),yield Re.present()})()}edit(){var Z=this;return(0,B.Z)(function*(){if(ve.c.isFeatureEnabled("EDIT_POI"))if(Z.appManager.isUserAuthenticated(!0))yield Z.continueEdit();else{const Re=yield Z.modalController.create({component:ct.F});Re.onDidDismiss().then((0,B.Z)(function*(){Z.appManager.isUserAuthenticated(!0)&&(yield Z.continueEdit())})),yield Re.present()}else Z.appManager.launchOCMWebPage("/poi/edit/"+Z.poi.ID)})()}refresh(Z=null){this.poi&&this.poiManager.getPOIById(this.poi.ID,!0,!0).then(Re=>{Re&&(this.poi=Re,this.ngOnChanges(null)),Z&&Z.target.complete()})}static \u0275fac=function(Re){return new(Re||ae)(m.Y36(h.c),m.Y36(l.SH),m.Y36(me.sK),m.Y36(de.z),m.Y36(te.IN),m.Y36(te.BX),m.Y36(Ue.R),m.Y36(oe.F0))};static \u0275cmp=m.Xpm({type:ae,selectors:[["poi-details"]],inputs:{poi:"poi"},features:[m.TTD],decls:2,vars:2,consts:[[4,"ngIf"],[1,"banner"],[1,"banner-content"],["color","primary","title","Average User Rating"],["vertical","top","horizontal","end","slot","fixed"],["name","add"],["side","bottom"],["title","Add a comment or charging check-in",3,"click"],["name","chatbubbles"],["title","Add a Photo",3,"click"],["name","camera"],["title","Add to Favourites",3,"click"],["name","star"],["title","Submit an Edit",3,"click"],["name","create"],["title","Refresh",3,"click"],["name","refresh"],["slot","fixed",3,"ionRefresh"],["pullingIcon","caret-down","pullingText","Pull to refresh","refreshingSpinner","circles","refreshingText","Refreshing..."],["slot","start"],["slot","end"],[3,"ngModel","ngModelChange"],["value","location","selected",""],["value","comments"],["value","media"],["style","white-space: pre-wrap;",4,"ngIf"],["size","small","title","Add to Favourites",3,"click"],["name","star","slot","start"],["size","small","title","Submit an Edit",3,"click"],["name","create","slot","start"],["size","small","title","Navigate to this location",3,"click"],["name","navigate","slot","start"],["size","small","title","Add a comment or charging check-in",3,"click"],["name","chatbubbles","slot","start"],["size","small","title","Add a Photo",3,"click"],["name","camera","slot","start"],[3,"item"],["class","details",4,"ngIf"],[1,"details"],[1,"details-minor"],["name","call"],["name","mail"],["name","globe"],["target","_system",3,"href"],[1,"label"],[1,"ion-padding-left"],["name","link"],["href","javascript:void(0)",3,"click",4,"ngIf"],["href","javascript:void(0)",3,"click"],[4,"ngFor","ngForOf"],[3,"src",4,"ngIf"],[3,"src"],["name","checkmark-circle","color","success",2,"font-size","2em"],["name","close-circle","color","danger"],[2,"white-space","pre-wrap"]],template:function(Re,st){1&Re&&m.YNc(0,dt,51,22,"div",0)(1,Bt,5,0,"div",0),2&Re&&(m.Q6J("ngIf",null!=st.poi&&null!=st.poi.AddressInfo),m.xp6(),m.Q6J("ngIf",null==st.poi||null==st.poi.AddressInfo))},dependencies:[ie.sg,ie.O5,te.BJ,te.yp,te.YG,te.Sm,te.PM,te.FN,te.Zi,te.tO,te.wI,te.IJ,te.W4,te.zq,te.jY,te.gu,te.Ie,te.Q$,te.nJ,te.Wo,te.Nd,te.cJ,te.GO,te.sr,te.QI,fe.JJ,fe.On,Fe.B,ie.JJ,ie.uU,me.X$],styles:[".banner[_ngcontent-%COMP%]{background-color:#4f712f;color:#ffffffec;padding:1em;text-shadow:#000 1px 1px 1px;min-height:180px;background-size:cover}.banner[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0}.banner-content[_ngcontent-%COMP%]{padding-right:48px}h3[_ngcontent-%COMP%]{font-weight:700}.label[_ngcontent-%COMP%]{color:#000;font-weight:700;font-size:12px}.details[_ngcontent-%COMP%]{color:#707d61;margin-left:1em;font-size:12px}.details-minor[_ngcontent-%COMP%]{color:#707d61;font-size:12px}p[_ngcontent-%COMP%]{display:block;padding:4px}"]})}return ae})(),Gn=(()=>{class ae{modalController;navParams;appManager;poi;hasNavbar=!1;constructor(Z,Re,st){this.modalController=Z,this.navParams=Re,this.appManager=st,this.poi=this.navParams.get("item"),this.appManager.analytics.viewEvent("POIDetails")}close(){this.modalController.dismiss()}static \u0275fac=function(Re){return new(Re||ae)(m.Y36(te.IN),m.Y36(l.X1),m.Y36(h.c))};static \u0275cmp=m.Xpm({type:ae,selectors:[["ng-component"]],decls:11,vars:3,consts:[["color","primary"],["slot","start"],[3,"click"],["name","close","slot","icon-only"],[1,"poi-details"],[3,"poi"]],template:function(Re,st){1&Re&&(m.TgZ(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),m._uU(3),m.TgZ(4,"small"),m._uU(5),m.qZA()(),m.TgZ(6,"ion-buttons",1)(7,"ion-button",2),m.NdJ("click",function(){return st.close()}),m._UZ(8,"ion-icon",3),m.qZA()()()(),m.TgZ(9,"ion-content",4),m._UZ(10,"poi-details",5),m.qZA()),2&Re&&(m.xp6(3),m.hij(" ",st.poi.AddressInfo.Title," "),m.xp6(2),m.hij("OCM-",st.poi.ID,""),m.xp6(5),m.Q6J("poi",st.poi))},dependencies:[te.YG,te.Sm,te.W2,te.Gu,te.gu,te.wd,te.sr,Nn],styles:['.left-col[_ngcontent-%COMP%]{float:left;width:50%;overflow:auto}.right-col[_ngcontent-%COMP%]{float:right;width:50%;overflow:auto}.row[_ngcontent-%COMP%]:after{content:"";display:table;clear:both;overflow:auto}.row[_ngcontent-%COMP%]{margin-bottom:1em}.subtle[_ngcontent-%COMP%]{color:silver}@media screen and (max-width: 768px){.left-col[_ngcontent-%COMP%]{float:none;width:100%}.right-col[_ngcontent-%COMP%]{margin-top:1em;float:none;width:100%}}.address-details[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-height:200px;width:auto}ion-label[_ngcontent-%COMP%]{overflow:inherit}ion-title[_ngcontent-%COMP%] > small[_ngcontent-%COMP%]{color:#ffffffbf}']})}return ae})()},5722:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{PoiEditorPageModule:()=>Pe});var h=P(6814),m=P(6223),te=P(6800),l=P(451),B=P(6662),Y=P(2618),C=P(5086),ie=P(9212);const fe=[{path:"",component:B.Y}];let Pe=(()=>{class K{static \u0275fac=function(Me){return new(Me||K)};static \u0275mod=ie.oAB({type:K});static \u0275inj=ie.cJS({imports:[h.ez,m.u5,l.Pc,Y.aw,C.e,te.Bz.forChild(fe)]})}return K})()},6662:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Y:()=>Yt});var h=P(5861),m=P(6470),te=P(8371),l=P(866),B=P(4669),Y=P(1847),C=P(9212),ie=P(3955),fe=P(9903),Pe=P(9127),K=P(5957),be=P(9862),Te=P(6814),Me=P(451);function de(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.TgZ(1,"ion-note")(2,"p"),C._uU(3," The closest address to this position is: "),C.qZA(),C.TgZ(4,"p")(5,"strong"),C._uU(6),C.qZA(),C._UZ(7,"br"),C._uU(8),C._UZ(9,"br"),C.TgZ(10,"ion-button",3),C.NdJ("click",function(){C.CHM(Ve);const Kt=C.oxw();return C.KtG(Kt.useAddressSelection())}),C._uU(11,"Use this address below "),C._UZ(12,"ion-icon",4),C.qZA()()(),C.BQk()}if(2&Ft){const Ve=C.oxw();C.xp6(6),C.Oqu(Ve.suggestedAddress.AddressLine1),C.xp6(2),C.HOy(" ",Ve.suggestedAddress.AddressLine2," ",Ve.suggestedAddress.Town," ",Ve.suggestedAddress.StateOrProvince," ",Ve.suggestedAddress.Postcode," ")}}let nt=(()=>{class Ft{mapping;events;logging;http;appManager;latitude;latitudeChange=new C.vpe;longitude;longitudeChange=new C.vpe;suggestedAddress=null;suggestedAddressChange=new C.vpe;onUseSuggestedAddress=new C.vpe;suggestedAddressAttribution=null;suggestedAddressAttributionChange=new C.vpe;originalMarkerPos;mapService;mapOptions;debouncedGecode;isMapInitialised=!1;constructor(Ve,Pt,Kt,wn,ei){this.mapping=Ve,this.events=Pt,this.logging=Kt,this.http=wn,this.appManager=ei}ngOnInit(){this.mapService=new fe.k(this.events,this.logging,this.http),this.mapService.initAPI(),this.mapOptions=new ie._,this.mapOptions.mapType=this.appManager.searchSettings.MapType,this.mapOptions.onMapMoveCompleted=()=>{let Ve;Ve=this.mapService.getMapCenter(),Ve.subscribe(Pt=>{Pt&&(this.latitude=Pt.coords.latitude,this.longitude=Pt.coords.longitude,this.latitudeChange.emit(this.latitude),this.longitudeChange.emit(this.longitude),this.getAddressForCurrentLatLng())})}}ngAfterContentInit(){this.focusMap()}ngOnDestroy(){this.mapService.disposeMap()}focusMap(){0==this.isMapInitialised&&this.mapService&&0!=this.latitude&&0!=this.longitude&&(this.isMapInitialised=!0,this.mapService.initMap("editor-map",this.mapOptions,null),this.mapService.setMapCenter(new te.jR(this.latitude,this.longitude)),this.originalMarkerPos=new te.wC(this.latitude,this.longitude))}ngOnChanges(Ve){this.focusMap()}getAddressForCurrentLatLng(){var Ve=this;return(0,h.Z)(function*(){Ve.latitude&&Ve.longitude&&Ve.appManager.api.fetchReverseGeocodeResult(Ve.latitude,Ve.longitude).then(Pt=>{Pt.AddressInfo&&(Ve.suggestedAddress=Pt.AddressInfo)})})()}useAddressSelection(){this.onUseSuggestedAddress.emit({suggestedAddress:this.suggestedAddress,attribution:this.suggestedAddressAttribution}),this.suggestedAddress=null,this.suggestedAddressAttribution=null}static \u0275fac=function(Pt){return new(Pt||Ft)(C.Y36(Y.v),C.Y36(K.z),C.Y36(Pe.z),C.Y36(be.eN),C.Y36(m.c))};static \u0275cmp=C.Xpm({type:Ft,selectors:[["app-poi-location-editor"]],inputs:{latitude:"latitude",longitude:"longitude"},outputs:{latitudeChange:"latitudeChange",longitudeChange:"longitudeChange",suggestedAddressChange:"suggestedAddressChange",onUseSuggestedAddress:"onUseSuggestedAddress",suggestedAddressAttributionChange:"suggestedAddressAttributionChange"},features:[C.TTD],decls:4,vars:1,consts:[[1,"instruction"],["id","editor-map"],[4,"ngIf"],["size","small",3,"click"],["slot","end","name","copy"]],template:function(Pt,Kt){1&Pt&&(C.TgZ(0,"p",0),C._uU(1,"Drag the map to center the marker on the charging location:"),C.qZA(),C._UZ(2,"div",1),C.YNc(3,de,13,5,"ng-container",2)),2&Pt&&(C.xp6(3),C.Q6J("ngIf",Kt.suggestedAddress))},dependencies:[Te.O5,Me.YG,Me.gu,Me.uN],styles:["#editor-map[_ngcontent-%COMP%]{border:1px solid gainsboro;background-color:gray;width:100%;height:128px}"]})}return Ft})();var Ce=P(9159),oe=P(6223);function xe(Ft,Un){if(1&Ft&&(C.TgZ(0,"ion-select-option",14),C._uU(1),C.qZA()),2&Ft){const Ve=Un.$implicit;C.Q6J("value",Ve.ID),C.xp6(),C.Oqu(Ve.Title)}}function Ie(Ft,Un){if(1&Ft&&(C.TgZ(0,"ion-select-option",14),C._uU(1),C.qZA()),2&Ft){const Ve=Un.$implicit;C.Q6J("value",Ve.ID),C.xp6(),C.Oqu(Ve.Title)}}function Ae(Ft,Un){if(1&Ft&&(C.TgZ(0,"ion-select-option",14),C._uU(1),C.qZA()),2&Ft){const Ve=Un.$implicit;C.Q6J("value",Ve.ID),C.xp6(),C.Oqu(Ve.Title)}}let ye=(()=>{class Ft{modalController;referenceDataManager;conn;useFilteredConnectionTypes=!0;useFilteredOperators=!0;constructor(Ve,Pt){this.modalController=Ve,this.referenceDataManager=Pt}get isAddMode(){return!(null!=this.conn&&this.conn.ID>0)}get connectionTypes(){return this.referenceDataManager.getConnectionTypes(this.useFilteredConnectionTypes)}get currentTypes(){return this.referenceDataManager.getOutputCurrentTypes()}get statusTypes(){return this.referenceDataManager.getStatusTypes().filter(Ve=>1==Ve.IsUserSelectable)}ngOnInit(){}save(){var Ve=!0;null!=this.conn.Quantity&&(this.conn.Quantity<0||this.conn.Quantity>100||!Number.isInteger(this.conn.Quantity))&&(alert("Quantity must be a whole number, or leave it blank."),Ve=!1),Ve&&this.modalController.dismiss({item:this.conn})}cancel(){this.modalController.dismiss()}static \u0275fac=function(Pt){return new(Pt||Ft)(C.Y36(Me.IN),C.Y36(Ce.W))};static \u0275cmp=C.Xpm({type:Ft,selectors:[["app-poi-equipment-editor"]],decls:60,vars:13,consts:[[1,"ion-padding"],["position","floating"],[3,"ngModel","ngModelChange"],["value","0"],[3,"value",4,"ngFor","ngForOf"],["type","number",3,"ngModel","ngModelChange"],["type","text","placeholder","(optional) other comments",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["slot","start"],[3,"click"],["name","close","slot","start"],["slot","end"],["color","success",3,"click"],["name","send","slot","end"],[3,"value"]],template:function(Pt,Kt){1&Pt&&(C.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),C._uU(3),C.qZA()()(),C.TgZ(4,"ion-content",0)(5,"p"),C._uU(6,"Please provide as much information as you can about the equipment. If you don't know then leave the field blank. At a minimum you should include the Connection Type and approximate Power kW (max)."),C.qZA(),C.TgZ(7,"ion-item")(8,"ion-label",1),C._uU(9,"Connection Type"),C.qZA(),C.TgZ(10,"ion-select",2),C.NdJ("ngModelChange",function(ei){return Kt.conn.ConnectionTypeID=ei}),C.TgZ(11,"ion-select-option",3),C._uU(12,"Unknown"),C.qZA(),C.YNc(13,xe,2,2,"ion-select-option",4),C.qZA()(),C.TgZ(14,"ion-item")(15,"ion-label",1),C._uU(16,"Supply Type"),C.qZA(),C.TgZ(17,"ion-select",2),C.NdJ("ngModelChange",function(ei){return Kt.conn.CurrentTypeID=ei}),C.TgZ(18,"ion-select-option",3),C._uU(19,"Unknown"),C.qZA(),C.YNc(20,Ie,2,2,"ion-select-option",4),C.qZA()(),C.TgZ(21,"ion-item")(22,"ion-label",1),C._uU(23,"Power (kW)"),C.qZA(),C.TgZ(24,"ion-input",5),C.NdJ("ngModelChange",function(ei){return Kt.conn.PowerKW=ei}),C.qZA()(),C.TgZ(25,"ion-item")(26,"ion-label",1),C._uU(27,"Amps"),C.qZA(),C.TgZ(28,"ion-input",5),C.NdJ("ngModelChange",function(ei){return Kt.conn.Amps=ei}),C.qZA()(),C.TgZ(29,"ion-item")(30,"ion-label",1),C._uU(31,"Voltage"),C.qZA(),C.TgZ(32,"ion-input",5),C.NdJ("ngModelChange",function(ei){return Kt.conn.Voltage=ei}),C.qZA()(),C.TgZ(33,"ion-item")(34,"ion-label",1),C._uU(35,"Status"),C.qZA(),C.TgZ(36,"ion-select",2),C.NdJ("ngModelChange",function(ei){return Kt.conn.StatusTypeID=ei}),C.YNc(37,Ae,2,2,"ion-select-option",4),C.qZA()(),C.TgZ(38,"ion-item")(39,"ion-label",1),C._uU(40,"Quantity Available"),C.qZA(),C.TgZ(41,"ion-input",5),C.NdJ("ngModelChange",function(ei){return Kt.conn.Quantity=ei}),C.qZA()(),C.TgZ(42,"ion-item")(43,"ion-label",1),C._uU(44,"Comment"),C.qZA(),C.TgZ(45,"ion-input",6),C.NdJ("ngModelChange",function(ei){return Kt.conn.Comments=ei}),C.qZA()(),C.TgZ(46,"ion-item")(47,"ion-label",1),C._uU(48,"Operators Reference"),C.qZA(),C.TgZ(49,"ion-input",7),C.NdJ("ngModelChange",function(ei){return Kt.conn.Reference=ei}),C.qZA()()(),C.TgZ(50,"ion-footer")(51,"ion-toolbar")(52,"ion-buttons",8)(53,"ion-button",9),C.NdJ("click",function(){return Kt.cancel()}),C._UZ(54,"ion-icon",10),C._uU(55," Cancel "),C.qZA()(),C.TgZ(56,"ion-buttons",11)(57,"ion-button",12),C.NdJ("click",function(){return Kt.save()}),C._uU(58," OK "),C._UZ(59,"ion-icon",13),C.qZA()()()()),2&Pt&&(C.xp6(3),C.Oqu(Kt.isAddMode?"Add Equipment":"Edit Equipment"),C.xp6(7),C.Q6J("ngModel",Kt.conn.ConnectionTypeID),C.xp6(3),C.Q6J("ngForOf",Kt.connectionTypes),C.xp6(4),C.Q6J("ngModel",Kt.conn.CurrentTypeID),C.xp6(3),C.Q6J("ngForOf",Kt.currentTypes),C.xp6(4),C.Q6J("ngModel",Kt.conn.PowerKW),C.xp6(4),C.Q6J("ngModel",Kt.conn.Amps),C.xp6(4),C.Q6J("ngModel",Kt.conn.Voltage),C.xp6(4),C.Q6J("ngModel",Kt.conn.StatusTypeID),C.xp6(),C.Q6J("ngForOf",Kt.statusTypes),C.xp6(4),C.Q6J("ngModel",Kt.conn.Quantity),C.xp6(4),C.Q6J("ngModel",Kt.conn.Comments),C.xp6(4),C.Q6J("ngModel",Kt.conn.Reference))},dependencies:[Te.sg,Me.YG,Me.Sm,Me.W2,Me.fr,Me.Gu,Me.gu,Me.pK,Me.Ie,Me.Q$,Me.t9,Me.n0,Me.wd,Me.sr,Me.as,Me.QI,Me.j9,oe.JJ,oe.On]})}return Ft})();var Ue=function(Ft){return Ft[Ft.Unknown=0]="Unknown",Ft[Ft.CurrentlyAvailable=10]="CurrentlyAvailable",Ft[Ft.CurrentlyInUse=20]="CurrentlyInUse",Ft[Ft.TemporarilyUnavailable=30]="TemporarilyUnavailable",Ft[Ft.Operational=50]="Operational",Ft[Ft.PartlyOperational=75]="PartlyOperational",Ft[Ft.NotOperational=100]="NotOperational",Ft[Ft.PlannedForFutureDate=150]="PlannedForFutureDate",Ft[Ft.RemovedDecomissioned=200]="RemovedDecomissioned",Ft}(Ue||{}),ct=function(Ft){return Ft[Ft.UnknownOperator=1]="UnknownOperator",Ft[Ft.SiteOwner=45]="SiteOwner",Ft}(ct||{}),me=P(8696),Fe=P(1163),De=P(6086);function ze(Ft,Un){1&Ft&&C._UZ(0,"ion-icon",13)}function Ke(Ft,Un){1&Ft&&C._UZ(0,"ion-icon",13)}function Ht(Ft,Un){1&Ft&&C._UZ(0,"ion-icon",13)}function dn(Ft,Un){if(1&Ft&&(C.TgZ(0,"ion-select-option",27),C._uU(1),C.qZA()),2&Ft){const Ve=Un.$implicit;C.Q6J("value",Ve.ID),C.xp6(),C.Oqu(Ve.Title)}}function _n(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.TgZ(1,"app-poi-location-editor",14,15),C.NdJ("latitudeChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.Latitude=Kt)})("longitudeChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.Longitude=Kt)})("onUseSuggestedAddress",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.useSuggestedAddress(Kt))}),C.qZA(),C.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-label",16),C._uU(6,"Location Name"),C.qZA(),C.TgZ(7,"ion-input",17),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.Title=Kt)}),C.qZA()(),C.TgZ(8,"ion-item")(9,"ion-label",16),C._uU(10,"Address Line 1"),C.qZA(),C.TgZ(11,"ion-input",18),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.AddressLine1=Kt)}),C.qZA()(),C.TgZ(12,"ion-item")(13,"ion-label",16),C._uU(14,"Address Line 2"),C.qZA(),C.TgZ(15,"ion-input",19),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.AddressLine2=Kt)}),C.qZA()(),C.TgZ(16,"ion-item")(17,"ion-label",16),C._uU(18,"Town"),C.qZA(),C.TgZ(19,"ion-input",20),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.Town=Kt)}),C.qZA()(),C.TgZ(20,"ion-item")(21,"ion-label",16),C._uU(22,"State or Province"),C.qZA(),C.TgZ(23,"ion-input",21),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.StateOrProvince=Kt)}),C.qZA()(),C.TgZ(24,"ion-item")(25,"ion-label",16),C._uU(26,"Postal Code"),C.qZA(),C.TgZ(27,"ion-input",22),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.Postcode=Kt)}),C.qZA()(),C.TgZ(28,"ion-item")(29,"ion-label",16),C._uU(30,"Country"),C.qZA(),C.TgZ(31,"ion-select",23),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.CountryID=Kt)})("ionChange",function(){C.CHM(Ve);const Kt=C.oxw(2);return C.KtG(Kt.onCountryChange())}),C.YNc(32,dn,2,2,"ion-select-option",24),C.qZA()(),C.TgZ(33,"ion-item")(34,"ion-input",25),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.Latitude=Kt)}),C.qZA()(),C.TgZ(35,"ion-item")(36,"ion-input",26),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.AddressInfo.Longitude=Kt)}),C.qZA()()(),C.BQk()}if(2&Ft){const Ve=C.oxw(2);C.xp6(),C.Q6J("latitude",Ve.item.AddressInfo.Latitude)("longitude",Ve.item.AddressInfo.Longitude),C.xp6(6),C.Q6J("ngModel",Ve.item.AddressInfo.Title),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.AddressLine1),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.AddressLine2),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.Town),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.StateOrProvince),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.Postcode),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.CountryID),C.xp6(),C.Q6J("ngForOf",Ve.countries),C.xp6(2),C.Q6J("ngModel",Ve.item.AddressInfo.Latitude),C.xp6(2),C.Q6J("ngModel",Ve.item.AddressInfo.Longitude)}}function Ut(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.TgZ(1,"h3"),C._uU(2,"Locations Nearby"),C.qZA(),C.TgZ(3,"p")(4,"strong"),C._uU(5,"The following locations already exist nearby."),C.qZA()(),C.TgZ(6,"div",28)(7,"p"),C._uU(8,"Ensure you are not adding a duplicate site unless it is for different equipment from another network operator."),C.qZA(),C.TgZ(9,"p"),C._uU(10,"You can edit any of these listings if required instead:"),C.qZA()(),C.TgZ(11,"app-poi-list",29),C.NdJ("onEdit",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.editPOI(Kt))}),C.qZA(),C.BQk()}if(2&Ft){const Ve=C.oxw(2);C.xp6(11),C.Q6J("poiList",Ve.nearbySites)("enableEditOption",!0)}}function We(Ft,Un){if(1&Ft&&(C.ynx(0),C.YNc(1,_n,37,12,"ng-container",9)(2,Ut,12,2,"ng-container",9),C.BQk()),2&Ft){const Ve=C.oxw();C.xp6(),C.Q6J("ngIf","location"==Ve.step),C.xp6(),C.Q6J("ngIf","poi-nearby"==Ve.step)}}function Ne(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.TgZ(1,"p"),C._uU(2,"Copied the equipment configuration from:"),C.qZA(),C.TgZ(3,"ion-item")(4,"ion-label"),C._uU(5),C._UZ(6,"br"),C._uU(7),C._UZ(8,"br"),C._uU(9),C._UZ(10,"br"),C._uU(11),C._UZ(12,"br"),C._uU(13),C.qZA(),C.TgZ(14,"ion-button",31),C.NdJ("click",function(){C.CHM(Ve);const Kt=C.oxw(5);return C.KtG(Kt.changeTemplatePOI())}),C._uU(15,"Change.."),C.qZA()(),C.BQk()}if(2&Ft){const Ve=C.oxw(5);C.xp6(5),C.hij(" ",Ve.selectedTemplatePOI.AddressInfo.Title," "),C.xp6(2),C.hij(" ",Ve.selectedTemplatePOI.AddressInfo.AddressLine1," "),C.xp6(2),C.hij(" ",null==Ve.selectedTemplatePOI.Connections[0].ConnectionType?null:Ve.selectedTemplatePOI.Connections[0].ConnectionType.Title," "),C.xp6(2),C.hij(" ",Ve.selectedTemplatePOI.Connections[0].PowerKW," "),C.xp6(2),C.hij(" ",Ve.selectedTemplatePOI.DateCreated," ")}}function ke(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.TgZ(1,"h4"),C._uU(2,"Similar Sites"),C.qZA(),C.TgZ(3,"app-poi-list",32),C.NdJ("onCopy",function(Kt){C.CHM(Ve);const wn=C.oxw(6);return C.KtG(wn.useTemplatePOI(Kt))}),C.qZA(),C.BQk()}if(2&Ft){const Ve=C.oxw(6);C.xp6(3),C.Q6J("enableCopyOption",!0)("poiList",Ve.templateSites)}}function it(Ft,Un){1&Ft&&(C.ynx(0),C.TgZ(1,"p"),C._uU(2," There are no suggested sites to copy for this network operator. "),C.qZA(),C.BQk())}function Qt(Ft,Un){if(1&Ft&&(C.ynx(0),C.YNc(1,ke,4,2,"ng-container",9)(2,it,3,0,"ng-container",9),C.BQk()),2&Ft){const Ve=C.oxw(5);C.xp6(),C.Q6J("ngIf",Ve.templateSites.length>0),C.xp6(),C.Q6J("ngIf",0==Ve.templateSites.length)}}function mt(Ft,Un){if(1&Ft&&(C.ynx(0),C.YNc(1,Ne,16,5,"ng-container",9)(2,Qt,3,2,"ng-container",9),C.BQk()),2&Ft){const Ve=C.oxw(4);C.xp6(),C.Q6J("ngIf",Ve.selectedTemplatePOI),C.xp6(),C.Q6J("ngIf",!Ve.selectedTemplatePOI)}}function an(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.TgZ(1,"p",28),C._uU(2,"You can copy the equipment settings from other sites operated by the same network operator or choose 'Next' to skip this step: "),C.qZA(),C.TgZ(3,"app-operator-lookup",30),C.NdJ("operatorChanged",function(Kt){C.CHM(Ve);const wn=C.oxw(3);return C.KtG(wn.onOperatorChange(Kt))}),C.qZA(),C.YNc(4,mt,3,2,"ng-container",9),C.BQk()}if(2&Ft){const Ve=C.oxw(3);C.xp6(3),C.Q6J("operatorId",Ve.item.OperatorID),C.xp6(),C.Q6J("ngIf",Ve.item.AddressInfo.CountryID&&Ve.item.OperatorID)}}function tt(Ft,Un){if(1&Ft&&(C.ynx(0),C.YNc(1,an,5,2,"ng-container",9),C.BQk()),2&Ft){const Ve=C.oxw(2);C.xp6(),C.Q6J("ngIf",!Ve.skipPOICopy)}}function pt(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.TgZ(1,"app-operator-lookup",33),C.NdJ("operatorChanged",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.onOperatorChange(Kt))}),C.qZA(),C.TgZ(2,"ion-item")(3,"ion-input",34),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.item.NumberOfPoints=Kt)}),C.qZA()(),C.TgZ(4,"h4"),C._uU(5,"Equipment"),C.qZA(),C.TgZ(6,"ion-button",35),C.NdJ("click",function(){C.CHM(Ve);const Kt=C.oxw(2);return C.KtG(Kt.addConnection())}),C._UZ(7,"ion-icon",36),C.qZA(),C.TgZ(8,"app-equipment-details",37),C.NdJ("onEdit",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.editConnection(Kt))})("onDelete",function(Kt){C.CHM(Ve);const wn=C.oxw(2);return C.KtG(wn.deleteConnection(Kt))}),C.qZA(),C.BQk()}if(2&Ft){const Ve=C.oxw(2);C.xp6(),C.Q6J("operatorId",Ve.item.OperatorID)("useFilteredOperators",!1),C.xp6(2),C.Q6J("ngModel",Ve.item.NumberOfPoints),C.xp6(5),C.Q6J("item",Ve.item)("enableEdit",!0)}}function Xt(Ft,Un){if(1&Ft&&(C.ynx(0),C.YNc(1,tt,2,1,"ng-container",9)(2,pt,9,5,"ng-container",9),C.BQk()),2&Ft){const Ve=C.oxw();C.xp6(),C.Q6J("ngIf","copy-equipment"==Ve.step),C.xp6(),C.Q6J("ngIf","edit-equipment"==Ve.step)}}function bn(Ft,Un){if(1&Ft&&(C.TgZ(0,"p",44)(1,"strong"),C._uU(2,"Your changes cannot be saved until the following issues are resolved:"),C.qZA(),C.TgZ(3,"ion-label",45),C._uU(4),C.qZA()()),2&Ft){const Ve=C.oxw(2);C.xp6(4),C.hij(" ",Ve.validationMsg,"")}}function Cn(Ft,Un){if(1&Ft&&(C.TgZ(0,"ion-select-option",27),C._uU(1),C.qZA()),2&Ft){const Ve=Un.$implicit;C.Q6J("value",Ve.ID),C.xp6(),C.Oqu(Ve.Title)}}function It(Ft,Un){if(1&Ft&&(C.TgZ(0,"ion-select-option",27),C._uU(1),C.qZA()),2&Ft){const Ve=Un.$implicit;C.Q6J("value",Ve.ID),C.xp6(),C.Oqu(Ve.Title)}}function pe(Ft,Un){if(1&Ft){const Ve=C.EpF();C.ynx(0),C.YNc(1,bn,5,1,"p",38),C.TgZ(2,"p"),C._uU(3,"Please provide any other facts related to this site. Additional comments (your charging experiences etc) can be added as check-in comments once the site is listed."),C.qZA(),C.TgZ(4,"ion-item")(5,"ion-label",16),C._uU(6,"Operational Status (All Equipment))"),C.qZA(),C.TgZ(7,"ion-select",39),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.StatusTypeID=Kt)}),C.YNc(8,Cn,2,2,"ion-select-option",24),C.qZA()(),C.TgZ(9,"ion-item")(10,"ion-label",16),C._uU(11,"Usage Type"),C.qZA(),C.TgZ(12,"ion-select",39),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.UsageTypeID=Kt)}),C.YNc(13,It,2,2,"ion-select-option",24),C.qZA()(),C.TgZ(14,"ion-item")(15,"ion-label",16),C._uU(16,"Usage Cost"),C.qZA(),C.TgZ(17,"ion-input",21),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.UsageCost=Kt)}),C.qZA()(),C.TgZ(18,"ion-item")(19,"ion-label",16),C._uU(20,"General Comments"),C.qZA(),C.TgZ(21,"ion-input",40),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.GeneralComments=Kt)}),C.qZA()(),C.TgZ(22,"ion-item")(23,"ion-label",16),C._uU(24,"Main Telephone Number "),C.qZA(),C.TgZ(25,"ion-input",41),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.AddressInfo.ContactTelephone1=Kt)}),C.qZA()(),C.TgZ(26,"ion-item")(27,"ion-label",16),C._uU(28,"Other Telephone Number "),C.qZA(),C.TgZ(29,"ion-input",41),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.AddressInfo.ContactTelephone2=Kt)}),C.qZA()(),C.TgZ(30,"ion-item")(31,"ion-label",16),C._uU(32,"Access Comments"),C.qZA(),C.TgZ(33,"ion-input",42),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.AddressInfo.AccessComments=Kt)}),C.qZA()(),C.TgZ(34,"ion-item")(35,"ion-label",16),C._uU(36,"Related Website"),C.qZA(),C.TgZ(37,"ion-input",43),C.NdJ("ngModelChange",function(Kt){C.CHM(Ve);const wn=C.oxw();return C.KtG(wn.item.AddressInfo.RelatedURL=Kt)}),C.qZA()(),C.BQk()}if(2&Ft){const Ve=C.oxw();C.xp6(),C.Q6J("ngIf",Ve.validationMsg),C.xp6(6),C.Q6J("ngModel",Ve.item.StatusTypeID),C.xp6(),C.Q6J("ngForOf",Ve.statusTypes),C.xp6(4),C.Q6J("ngModel",Ve.item.UsageTypeID),C.xp6(),C.Q6J("ngForOf",Ve.usageTypes),C.xp6(4),C.Q6J("ngModel",Ve.item.UsageCost),C.xp6(4),C.Q6J("ngModel",Ve.item.GeneralComments),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.ContactTelephone1),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.ContactTelephone2),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.AccessComments),C.xp6(4),C.Q6J("ngModel",Ve.item.AddressInfo.RelatedURL)}}function lt(Ft,Un){if(1&Ft){const Ve=C.EpF();C.TgZ(0,"ion-button",1),C.NdJ("click",function(){C.CHM(Ve);const Kt=C.oxw();return C.KtG(Kt.previous())}),C._uU(1," Previous "),C._UZ(2,"ion-icon",46),C.qZA()}}function Zt(Ft,Un){if(1&Ft){const Ve=C.EpF();C.TgZ(0,"ion-button",1),C.NdJ("click",function(){C.CHM(Ve);const Kt=C.oxw();return C.KtG(Kt.next())}),C._uU(1," Next "),C._UZ(2,"ion-icon",47),C.qZA()}}function hn(Ft,Un){if(1&Ft){const Ve=C.EpF();C.TgZ(0,"ion-button",48),C.NdJ("click",function(){C.CHM(Ve);const Kt=C.oxw();return C.KtG(Kt.save())}),C._uU(1," Submit "),C._UZ(2,"ion-icon",49),C.qZA()}}let Yt=(()=>{class Ft{appManager;modalController;poiManager;mapping;loadingController;alertController;id;item;step;selectedTab;startPos;useFilteredConnectionTypes=!0;templateSites=[];nearbySites=[];selectedTemplatePOI=null;suggestedAddress=null;suggestedAddressAttribution=null;isNonDuplicateConfirmed=!1;skipPOICopy=!1;validationMsg=null;loading;editorMap;get countries(){return this.appManager.referenceDataManager.getCountries()}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes()}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes().filter(Ve=>1==Ve.IsUserSelectable)}get isAddMode(){return this.item.ID<=0}constructor(Ve,Pt,Kt,wn,ei,di){this.appManager=Ve,this.modalController=Pt,this.poiManager=Kt,this.mapping=wn,this.loadingController=ei,this.alertController=di,this.initNewItem()}initNewItem(){this.item={ID:-1,DataProviderID:1,DataProvidersReference:null,OperatorsReference:null,OperatorID:1,UsageCost:null,UsageTypeID:4,NumberOfPoints:1,GeneralComments:null,DatePlanned:null,StatusTypeID:50,SubmissionStatusTypeID:null,Connections:[],MetadataValues:[],AddressInfo:{ID:-1,CountryID:18,Title:"",AddressLine1:"",Latitude:0,Longitude:0}},this.step="location",this.selectedTab="location"}get isReadyToSubmit(){return this.validate().isValid&&"info"==this.step}ngOnInit(){}presentLoadingUI(){var Ve=this;return(0,h.Z)(function*(){Ve.loading=yield Ve.loadingController.create({message:"Please Wait.."}),yield Ve.loading.present()})()}dismissLoadingUI(){var Ve=this;return(0,h.Z)(function*(){Ve.loading&&(yield Ve.loading.dismiss())})()}ionViewDidEnter(){if(null!=this.id)this.editExistingPOI(this.id);else{let Ve=localStorage.getItem("_editor-operatorid");Ve&&(this.item.OperatorID=parseInt(Ve,10)),this.startPos?(this.item.AddressInfo.Latitude=this.startPos.latitude,this.item.AddressInfo.Longitude=this.startPos.longitude):this.mapping&&this.mapping.getMapCenter().subscribe(Pt=>{Pt&&(this.item.AddressInfo.Latitude=Pt.coords.latitude,this.item.AddressInfo.Longitude=Pt.coords.longitude)})}this.refreshFilteredReferenceData()}previous(){var Ve=this;return(0,h.Z)(function*(){switch(Ve.step){case"info":Ve.step="edit-equipment";break;case"edit-equipment":Ve.step=Ve.isAddMode?"copy-equipment":"location";break;case"copy-equipment":case"poi-nearby":Ve.step="location"}yield Ve.initCurrentStep(!1)})()}next(){var Ve=this;return(0,h.Z)(function*(){if("poi-nearby"==Ve.step&&Ve.nearbySites.length>0&&!Ve.isNonDuplicateConfirmed)return void(yield Ve.alertController.create({header:"Confirm",message:"Please confirm you are not adding a duplicate site.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:wn=>{}},{text:"Confirm",handler:()=>{Ve.isNonDuplicateConfirmed=!0,Ve.next()}}]})).present();const Pt=Ve.validate(Ve.step);if(Pt.isValid){switch(Ve.step){case"location":Ve.step=Ve.isAddMode?"poi-nearby":"edit-equipment";break;case"poi-nearby":Ve.step=Ve.isAddMode?"copy-equipment":"edit-equipment";break;case"copy-equipment":Ve.step="edit-equipment";break;case"edit-equipment":Ve.step="info"}yield Ve.initCurrentStep(!0)}else(yield Ve.alertController.create({message:Pt.msg})).present()})()}initCurrentStep(Ve){var Pt=this;return(0,h.Z)(function*(){"poi-nearby"==Pt.step?(Pt.selectedTab="location",0==(yield Pt.refreshNearbySites())&&(Ve?yield Pt.next():yield Pt.previous())):"location"==Pt.step?Pt.selectedTab="location":"copy-equipment"==Pt.step?(Pt.selectedTab="equipment",yield Pt.refreshTemplateSites()):"edit-equipment"==Pt.step?Pt.selectedTab="equipment":"info"==Pt.step&&(Pt.selectedTab="info")})()}onCountryChange(){var Ve=this;return(0,h.Z)(function*(){Ve.refreshFilteredReferenceData()})()}onOperatorChange(Ve=null){var Pt=this;return(0,h.Z)(function*(){null!=Ve&&Pt.item.OperatorID!=Ve.ID&&(Pt.item.OperatorID=Ve.ID,localStorage.setItem("_editor-operatorid",Pt.item.OperatorID.toString()),yield Pt.refreshTemplateSites())})()}useSuggestedAddress(Ve=null){Ve&&(this.suggestedAddress=Ve.suggestedAddress,this.suggestedAddressAttribution=Ve.suggestedAddressAttribution),Object.assign(this.item.AddressInfo,this.suggestedAddress),this.suggestedAddressAttribution&&(this.item.MetadataValues.find(Pt=>4==Pt.MetadataFieldID)||this.item.MetadataValues.push({ID:-1,MetadataFieldID:4,ItemValue:this.suggestedAddressAttribution,MetadataFieldOptionID:null,MetadataFieldOption:null}))}editConnection(Ve){var Pt=this;return(0,h.Z)(function*(){const Kt=Pt.item.Connections.find(di=>di.ID==Ve.ID),wn=Object.assign({},Kt),ei=yield Pt.modalController.create({component:ye,componentProps:{conn:wn}});return ei.onWillDismiss().then(di=>{di&&di.data&&di.data.item&&Pt.updateConnection(di.data.item)}),yield ei.present()})()}deleteConnection(Ve){var Pt=this;return(0,h.Z)(function*(){const Kt=Pt.item.Connections.find(ei=>ei.ID==Ve.ID);(yield Pt.alertController.create({header:"Confirm Delete",message:"Are you sure you want to delete this connection information?",buttons:[{text:"No",role:"cancel",cssClass:"secondary",handler:()=>{}},{text:"Yes",handler:()=>{Pt.item.Connections=Pt.item.Connections.filter(ei=>ei.ID!=Kt.ID),Pt.appManager.referenceDataManager.hydrateCompactPOI(Pt.item,!0)}}]})).present()})()}addConnection(){var Ve=this;return(0,h.Z)(function*(){const Pt={ID:-l.c.getRandomInt(1e4),ConnectionTypeID:null,StatusTypeID:50,PowerKW:null,Quantity:1},Kt=yield Ve.modalController.create({component:ye,componentProps:{conn:Pt}});return Kt.onWillDismiss().then(wn=>{wn&&wn.data&&wn.data.item&&Ve.updateConnection(wn.data.item)}),yield Kt.present()})()}refreshFilteredReferenceData(){this.appManager.referenceDataManager.refreshFilteredReferenceData(this.appManager.api,{CountryIds:[this.item.AddressInfo.CountryID]})}updateConnection(Ve){if(Ve){let Pt=this.item.Connections.find(Kt=>Kt.ID==Ve.ID);Pt?Object.assign(Pt,Ve):this.item.Connections.push(Ve)}this.appManager.referenceDataManager.hydrateCompactPOI(this.item,!0)}validate(Ve="all"){let Pt=null;return("all"==Ve||"location"==Ve)&&((!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(Pt="Location is required"),""==this.item.AddressInfo.Title&&(Pt="A location title is required"),!this.item.AddressInfo.AddressLine1&&!this.item.AddressInfo.AddressLine2&&(Pt="An approximate address is required."),this.item.AddressInfo.CountryID||(Pt="A country selection is required"),(!this.item.AddressInfo.Latitude||!this.item.AddressInfo.Longitude)&&(Pt="A location latitude and longitude is required")),("all"==Ve||"poi-nearby"==Ve)&&this.nearbySites.length>0&&!this.isNonDuplicateConfirmed&&(Pt="Please confirm that the site is not a duplicate"),("all"==Ve||"equipment"==Ve)&&(this.item.OperatorID||(Pt="Please confirm the charging network or equipment operator."),0==this.item.Connections.length&&(Pt="Equipment information is required")),Pt?(this.validationMsg=Pt,{isValid:!1,msg:Pt}):(this.validationMsg=null,{isValid:!0,msg:null})}save(){var Ve=this;return(0,h.Z)(function*(){let Pt=Ve.validate();if(Pt.isValid){yield Ve.presentLoadingUI();try{yield Ve.appManager.submitPOI(Ve.item),yield Ve.dismissLoadingUI(),Ve.appManager.showToastNotification("You submission will be reviewed (if required) and published shortly."),Ve.modalController.dismiss()}catch(Kt){yield Ve.dismissLoadingUI(),Kt.error&&alert("Sorry, your submission could not be completed at this time. Please try again later.")}}else alert(Pt.msg)})()}cancel(){var Ve=this;return(0,h.Z)(function*(){Ve.modalController.dismiss()})()}refreshTemplateSites(){var Ve=this;return(0,h.Z)(function*(){if(Ve.item.AddressInfo.CountryID&&Ve.item.OperatorID){yield Ve.presentLoadingUI(),Ve.templateSites=[];let Pt=new te.be;Pt.countryIdList=[Ve.item.AddressInfo.CountryID],Pt.minPowerKW=1,Pt.operatorIdList=[Ve.item.OperatorID],Pt.maxResults=10;let Kt=yield Ve.poiManager.fetchPOIList(Pt);Kt.sort((wn,ei)=>new Date(wn.DateCreated).getTime()-new Date(ei.DateCreated).getTime()),Ve.templateSites=Kt,Ve.dismissLoadingUI()}})()}refreshNearbySites(){var Ve=this;return(0,h.Z)(function*(){if(Ve.item.AddressInfo.Latitude&&Ve.item.AddressInfo.Longitude){yield Ve.presentLoadingUI(),Ve.nearbySites=[];let Pt=new te.be;Pt.latitude=Ve.item.AddressInfo.Latitude,Pt.longitude=Ve.item.AddressInfo.Longitude,Pt.distance=5,Pt.distanceUnit="km",Pt.maxResults=10;let Kt=yield Ve.poiManager.fetchPOIList(Pt);return Kt.sort((wn,ei)=>wn.Distance-ei.Distance),Ve.nearbySites=Kt,Ve.dismissLoadingUI(),Kt.length}return 0})()}confirmNonDuplicate(){this.isNonDuplicateConfirmed=!0,this.next()}changeTemplatePOI(){this.selectedTemplatePOI=null}editPOI(Ve){this.editExistingPOI(Ve.ID)}editExistingPOI(Ve){var Pt=this;return(0,h.Z)(function*(){Pt.skipPOICopy=!0,Pt.isNonDuplicateConfirmed=!0,yield Pt.presentLoadingUI(),Pt.poiManager.getPOIById(Ve,!0,!0).then(Kt=>{Pt.item=Object.assign({},Kt),null==Pt.item.OperatorID&&(Pt.item.OperatorID=ct.UnknownOperator),Pt.refreshFilteredReferenceData(),Pt.dismissLoadingUI()})})()}useTemplatePOI(Ve){this.selectedTemplatePOI=Ve,Object.assign(this.item.Connections,Ve.Connections);for(let Pt of this.item.Connections)Pt.ID=-l.c.getRandomInt(1e4),Pt.Reference=null,Pt.Comments=null,Pt.StatusTypeID=Ue.Operational;this.item.UsageCost=Ve.UsageCost,this.item.UsageTypeID=Ve.UsageTypeID,this.appManager.referenceDataManager.hydrateCompactPOI(this.item)}skipCopyingPOI(){this.skipPOICopy=!0}static \u0275fac=function(Pt){return new(Pt||Ft)(C.Y36(m.c),C.Y36(Me.IN),C.Y36(B.R),C.Y36(Y.v),C.Y36(Me.HT),C.Y36(Me.Br))};static \u0275cmp=C.Xpm({type:Ft,selectors:[["app-poi-editor"]],viewQuery:function(Pt,Kt){if(1&Pt&&C.Gf(nt,5),2&Pt){let wn;C.iGM(wn=C.CRH())&&(Kt.editorMap=wn.first)}},decls:33,vars:14,consts:[["slot","end"],[3,"click"],["name","close","slot","start"],[1,"ion-padding"],[3,"ngModel"],["value","location","layout","icon-start",3,"disabled"],["name","caret-forward",4,"ngIf"],["value","equipment","layout","icon-start",3,"disabled"],["value","info","layout","icon-start",3,"disabled"],[4,"ngIf"],["slot","start"],[3,"click",4,"ngIf"],["color","success",3,"click",4,"ngIf"],["name","caret-forward"],[3,"latitude","longitude","latitudeChange","longitudeChange","onUseSuggestedAddress"],["editorMap",""],["position","floating"],["type","text","autocapitalize","words","placeholder","A title for this location",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","The nearest street address",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Town or City",3,"ngModel","ngModelChange"],["type","text",3,"ngModel","ngModelChange"],["type","text","autocapitalize","words","placeholder","Optional Postal Code",3,"ngModel","ngModelChange"],[3,"ngModel","ngModelChange","ionChange"],[3,"value",4,"ngFor","ngForOf"],["label","Latitude","labelPlacement","floating","type","number","placeholder","Latitude (if entering manually)",3,"ngModel","ngModelChange"],["label","Longitude","labelPlacement","floating","type","number","placeholder","Longitude (if entering manually)",3,"ngModel","ngModelChange"],[3,"value"],[1,"instruction"],[3,"poiList","enableEditOption","onEdit"],[3,"operatorId","operatorChanged"],["slot","start","size","small",3,"click"],[3,"enableCopyOption","poiList","onCopy"],[3,"operatorId","useFilteredOperators","operatorChanged"],["label","Number of Stations or Parking Bays","labelPlacement","floating","min","1","type","number",3,"ngModel","ngModelChange"],["size","small",3,"click"],["name","add","slot","icon-only"],[3,"item","enableEdit","onEdit","onDelete"],["color","warning",4,"ngIf"],[3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences",3,"ngModel","ngModelChange"],["type","tel","placeholder","",3,"ngModel","ngModelChange"],["type","text","autocapitalize","sentences","placeholder","Instructions for access or tips for finding charging location",3,"ngModel","ngModelChange"],["type","url","placeholder","Website related to this site",3,"ngModel","ngModelChange"],["color","warning"],["color","danger"],["name","caret-back","slot","start"],["name","caret-forward","slot","end"],["color","success",3,"click"],["name","send","slot","end"]],template:function(Pt,Kt){1&Pt&&(C.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),C._uU(3),C.qZA(),C.TgZ(4,"ion-buttons",0)(5,"ion-button",1),C.NdJ("click",function(){return Kt.cancel()}),C._UZ(6,"ion-icon",2),C._uU(7," Cancel "),C.qZA()()()(),C.TgZ(8,"ion-content",3),C.ynx(9),C.TgZ(10,"ion-segment",4)(11,"ion-segment-button",5),C.YNc(12,ze,1,0,"ion-icon",6),C.TgZ(13,"ion-label"),C._uU(14,"Location"),C.qZA()(),C.TgZ(15,"ion-segment-button",7),C.YNc(16,Ke,1,0,"ion-icon",6),C.TgZ(17,"ion-label"),C._uU(18,"Equipment"),C.qZA()(),C.TgZ(19,"ion-segment-button",8),C.YNc(20,Ht,1,0,"ion-icon",6),C.TgZ(21,"ion-label"),C._uU(22,"Info"),C.qZA()()(),C.YNc(23,We,3,2,"ng-container",9)(24,Xt,3,2,"ng-container",9)(25,pe,38,11,"ng-container",9),C.BQk(),C.qZA(),C.TgZ(26,"ion-footer")(27,"ion-toolbar")(28,"ion-buttons",10),C.YNc(29,lt,3,0,"ion-button",11),C.qZA(),C.TgZ(30,"ion-buttons",0),C.YNc(31,Zt,3,0,"ion-button",11)(32,hn,3,0,"ion-button",12),C.qZA()()()),2&Pt&&(C.xp6(3),C.Oqu(Kt.isAddMode?"Add Location":"Edit Location"),C.xp6(7),C.Q6J("ngModel",Kt.selectedTab),C.xp6(),C.Q6J("disabled",!0),C.xp6(),C.Q6J("ngIf","location"==Kt.selectedTab),C.xp6(3),C.Q6J("disabled",!0),C.xp6(),C.Q6J("ngIf","equipment"==Kt.selectedTab),C.xp6(3),C.Q6J("disabled",!0),C.xp6(),C.Q6J("ngIf","info"==Kt.selectedTab),C.xp6(3),C.Q6J("ngIf","location"==Kt.selectedTab),C.xp6(),C.Q6J("ngIf","equipment"==Kt.selectedTab),C.xp6(),C.Q6J("ngIf","info"==Kt.selectedTab),C.xp6(4),C.Q6J("ngIf","location"!=Kt.step),C.xp6(2),C.Q6J("ngIf",!Kt.isReadyToSubmit&&"info"!=Kt.step),C.xp6(),C.Q6J("ngIf",Kt.isReadyToSubmit))},dependencies:[Te.sg,Te.O5,oe.JJ,oe.On,Me.YG,Me.Sm,Me.W2,Me.fr,Me.Gu,Me.gu,Me.pK,Me.Ie,Me.Q$,Me.q_,Me.cJ,Me.GO,Me.t9,Me.n0,Me.wd,Me.sr,Me.as,Me.QI,Me.j9,Me.yf,me.o,Fe.B,nt,De.z],styles:['ul.breadcrumb[_ngcontent-%COMP%]{display:inline-flex;margin:0;padding:0}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{display:inline-flex;margin-right:6px;color:var(--ion-color-light-shade);font-size:10px}ul.breadcrumb[_ngcontent-%COMP%]   li.active[_ngcontent-%COMP%]{color:var(--ion-color-dark-shade)}ul.breadcrumb[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]:before{content:">";padding-right:4px}']})}return Ft})()},3247:(Bn,Ct,P)=>{"use strict";P.d(Ct,{u:()=>ct});var h=P(9212),m=P(451),te=P(3052),l=P(989),B=P(9127),Y=P(7430),C=P(9862);let ie=(()=>{class X{http;journeyManager;constructor(me,Fe){this.http=me,this.journeyManager=Fe}getDirections(me,Fe){return new Promise((De,ze)=>{(new google.maps.DirectionsService).route({origin:me,destination:Fe,travelMode:google.maps.TravelMode.DRIVING},(Ht,dn)=>{dn===google.maps.DirectionsStatus.OK?De(Ht):ze(dn)})})}analyseRoutes(me,Fe){const De=new Array;return me.routes.forEach(ze=>{const Ke=new Y.JJ;Ke.Title=""+De.length+1,Ke.JourneyRouteLegs=new Array,Ke.TotalDistanceKM=0,Ke.TotalDurationMinutes=0,Ke.TotalEnergykWh=0,ze.legs.forEach(Ht=>{const dn=Ht.duration.value,_n=Ht.distance.value/1e3,Ut=this.journeyManager.calculateEnergyConsumptionkWh(_n,0,null,Fe),We=new Y.eN;We.DistanceKM=_n,We.DurationMinutes=dn/60,We.EnergyConsumptionkWh=Ut,Ke.JourneyRouteLegs.push(We),Ke.TotalDistanceKM+=We.DistanceKM,Ke.TotalDurationMinutes+=We.DurationMinutes,Ke.TotalEnergykWh=We.EnergyConsumptionkWh}),De.push(Ke)}),De}static \u0275fac=function(Fe){return new(Fe||X)(h.LFG(C.eN),h.LFG(l.i))};static \u0275prov=h.Yz7({token:X,factory:X.\u0275fac,providedIn:"root"})}return X})();var fe=P(1847),Pe=P(6814),K=P(6223),be=P(5460);function Te(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",12),h.TgZ(2,"ion-searchbar",13),h.NdJ("ngModelChange",function(De){h.CHM(me);const ze=h.oxw();return h.KtG(ze.routeStart=De)})("ionInput",function(De){h.CHM(me),h.oxw();const ze=h.MAs(18);return h.KtG(ze.getPlacesAutoComplete(De,"routeStart"))})("ionCancel",function(De){h.CHM(me);const ze=h.oxw();return h.KtG(ze.onPlaceSearchCancel(De))}),h.qZA()()}if(2&X){const me=h.oxw();h.xp6(2),h.Q6J("ngModel",me.routeStart)("debounce",500)}}function Me(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"ion-item",14),h.NdJ("click",function(){h.CHM(me);const De=h.oxw();return h.KtG(De.clearRouteStart())}),h._UZ(1,"ion-icon",12),h.TgZ(2,"h2"),h._uU(3),h.qZA()()}if(2&X){h.oxw();const me=h.MAs(18);h.xp6(3),h.Oqu(null==me.selectedPlace?null:me.selectedPlace.name)}}function de(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"ion-item"),h._UZ(1,"ion-icon",15),h.TgZ(2,"ion-searchbar",16),h.NdJ("ngModelChange",function(De){h.CHM(me);const ze=h.oxw();return h.KtG(ze.routeDestination=De)})("ionInput",function(De){h.CHM(me),h.oxw();const ze=h.MAs(20);return h.KtG(ze.getPlacesAutoComplete(De,"routeDestination"))})("ionCancel",function(De){h.CHM(me);const ze=h.oxw();return h.KtG(ze.onPlaceSearchCancel(De))}),h.qZA()()}if(2&X){const me=h.oxw();h.xp6(2),h.Q6J("ngModel",me.routeDestination)("debounce",500)}}function nt(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"ion-item",14),h.NdJ("click",function(){h.CHM(me);const De=h.oxw();return h.KtG(De.clearRouteDestination())}),h._UZ(1,"ion-icon",15),h.TgZ(2,"h2"),h._uU(3),h.qZA()()}if(2&X){h.oxw();const me=h.MAs(20);h.xp6(3),h.Oqu(null==me.selectedPlace?null:me.selectedPlace.name)}}function Ce(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"ion-button",14),h.NdJ("click",function(){h.CHM(me);const De=h.oxw();return h.KtG(De.clearRoute())}),h._UZ(1,"ion-icon",17),h._uU(2," Clear Route "),h.qZA()}}function oe(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"ion-button",14),h.NdJ("click",function(){h.CHM(me);const De=h.oxw();return h.KtG(De.showSettings())}),h._uU(1," Show Settings "),h._UZ(2,"ion-icon",18),h.qZA()}}function xe(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"ion-button",14),h.NdJ("click",function(){h.CHM(me);const De=h.oxw();return h.KtG(De.hideSettings())}),h._uU(1," Hide Settings "),h._UZ(2,"ion-icon",18),h.qZA()}}function Ie(X,ve){1&X&&(h.TgZ(0,"p",19),h._UZ(1,"ion-spinner",19),h._uU(2," Calculating Route.. "),h.qZA())}function Ae(X,ve){if(1&X&&(h.TgZ(0,"ion-list")(1,"ion-list-header"),h._uU(2),h.ALo(3,"number"),h.ALo(4,"number"),h.qZA()()),2&X){const me=h.oxw();h.xp6(2),h.lnq(" Total Distance ",h.xi3(3,3,me.selectedJourneyRoute.TotalDistanceKM,"1.0-2")," km, ",me.formatDuration(me.selectedJourneyRoute.TotalDurationMinutes),", ",h.xi3(4,6,me.selectedJourneyRoute.TotalEnergykWh,"1.0-2")," kWh ")}}function ye(X,ve){if(1&X){const me=h.EpF();h.TgZ(0,"div")(1,"ion-list")(2,"ion-list-header"),h._UZ(3,"ion-icon",20),h._uU(4," Route Settings "),h.qZA(),h.TgZ(5,"ion-item")(6,"ion-label",21),h._uU(7),h.qZA(),h.TgZ(8,"ion-range",22),h.NdJ("ngModelChange",function(De){h.CHM(me);const ze=h.oxw();return h.KtG(ze.routeSearchDistance=De)}),h._UZ(9,"ion-icon",23)(10,"ion-icon",24),h.qZA()(),h.TgZ(11,"ion-item")(12,"ion-label",21),h._uU(13,"Energy Efficiency (kWh Per km)"),h.qZA(),h.TgZ(14,"ion-input",25),h.NdJ("ngModelChange",function(De){h.CHM(me);const ze=h.oxw();return h.KtG(ze.kWhPerKM=De)}),h.qZA()()()()}if(2&X){const me=h.oxw();h.xp6(7),h.hij("Search Distance (",me.routeSearchDistance,")"),h.xp6(),h.Q6J("ngModel",me.routeSearchDistance),h.xp6(6),h.Q6J("ngModel",me.kWhPerKM)}}let Ue=(()=>{class X{mapping;logging;directions;journeyManager;changeDetector;numberPipe;routeSearchDistance=5;journeyRoutes;selectedJourneyRoute;routePolyline;kWhPerKM;routeStartPlace;routeDestinationPlace;routeCalcInProgress=!1;advancedSettingsMode=!1;routeStart="";routeDestination="";constructor(me,Fe,De,ze,Ke,Ht){this.mapping=me,this.logging=Fe,this.directions=De,this.journeyManager=ze,this.changeDetector=Ke,this.numberPipe=Ht,this.kWhPerKM=.212}get isRouteSet(){return null!=this.routeStartPlace&&null!=this.routeDestinationPlace}showSettings(){this.advancedSettingsMode=!0}hideSettings(){this.advancedSettingsMode=!1}routeStartSelected(me){this.routeStartPlace=me,this.calculateRoute(),this.changeDetector.detectChanges()}routeDestinationSelected(me){this.routeDestinationPlace=me,this.calculateRoute(),this.changeDetector.detectChanges()}clearRouteStart(){this.routeStartPlace=null,this.changeDetector.detectChanges()}clearRouteDestination(){this.routeDestinationPlace=null,this.changeDetector.detectChanges()}clearRoute(){this.routeStartPlace=null,this.routeDestinationPlace=null,this.journeyManager.setRoutePolyline(null),this.mapping.clearPolyline()}formatDuration(me){if(me<=60)return this.numberPipe.transform(me,"1.0-2")+" mins";{const Fe=Math.round(me/60),De=Math.floor(me-60*Fe);return Fe+" hours "+(De>0?De+" mins":"")}}calculateRoute(){null!=this.routeStartPlace&&null!=this.routeDestinationPlace&&(this.logging.log("Fetching route directions.."),this.routeCalcInProgress=!0,this.directions.getDirections(this.routeStartPlace.Location.latitude+","+this.routeStartPlace.Location.longitude,this.routeDestinationPlace.Location.latitude+","+this.routeDestinationPlace.Location.longitude).then(me=>{if(null!=me.routes&&me.routes.length>0){this.logging.log("Got route directions, analysing.."),this.routePolyline=me.routes[0].overview_polyline;const Fe=me.routes[0].bounds.getSouthWest(),De=me.routes[0].bounds.getNorthEast(),ze=new te.wC(De.lat(),De.lng()),Ke=new te.wC(Fe.lat(),Fe.lng()),Ht=new te.LL(ze,Ke);this.journeyRoutes=this.directions.analyseRoutes(me,this.kWhPerKM),this.journeyRoutes.length>0&&(this.selectedJourneyRoute=this.journeyRoutes[0]),this.journeyManager.setRoutePolyline(this.routePolyline),this.mapping.renderPolyline(this.routePolyline),this.mapping.moveToMapBounds(Ht)}else this.logging.log("No route returned..");this.routeCalcInProgress=!1}))}static \u0275fac=function(Fe){return new(Fe||X)(h.Y36(fe.v),h.Y36(B.z),h.Y36(ie),h.Y36(l.i),h.Y36(h.sBO),h.Y36(Pe.JJ))};static \u0275cmp=h.Xpm({type:X,selectors:[["route-planner"]],decls:24,vars:10,consts:[[1,"route"],[1,"route-places"],["name","map","slot","start"],[4,"ngIf"],[3,"click",4,"ngIf"],["primary",""],["slot","secondary"],["slot","primary"],[3,"placeChanged"],["placeSearchRouteStart",""],["placeSearchRouteDestination",""],["class","ion-padding",4,"ngIf"],["name","ionic","item-left",""],["placeholder","Starting Point",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],[3,"click"],["name","pin","item-left",""],["placeholder","Destination",3,"ngModel","debounce","ngModelChange","ionInput","ionCancel"],["name","close","slot","start"],["name","cog","slot","end"],[1,"ion-padding"],["name","cog"],["position","stacked"],["min","1","max","200","step","5","snaps","true","pin","true","light","",3,"ngModel","ngModelChange"],["slot","start","small","","name","map"],["slot","end","large","","name","map"],["type","number","min","0.1","max","1",3,"ngModel","ngModelChange"]],template:function(Fe,De){1&Fe&&(h.TgZ(0,"div",0)(1,"div",1)(2,"ion-list")(3,"ion-list-header"),h._UZ(4,"ion-icon",2),h.TgZ(5,"ion-label"),h._uU(6,"Plan Your Journey"),h.qZA()(),h.YNc(7,Te,3,2,"ion-item",3)(8,Me,4,1,"ion-item",4)(9,de,3,2,"ion-item",3)(10,nt,4,1,"ion-item",4),h.qZA(),h.TgZ(11,"ion-toolbar",5)(12,"ion-buttons",6),h.YNc(13,Ce,3,0,"ion-button",4),h.qZA(),h.TgZ(14,"ion-buttons",7),h.YNc(15,oe,3,0,"ion-button",4)(16,xe,3,0,"ion-button",4),h.qZA()()(),h.TgZ(17,"place-search",8,9),h.NdJ("placeChanged",function(Ke){return De.routeStartSelected(Ke)}),h.qZA(),h.TgZ(19,"place-search",8,10),h.NdJ("placeChanged",function(Ke){return De.routeDestinationSelected(Ke)}),h.qZA(),h.YNc(21,Ie,3,0,"p",11)(22,Ae,5,9,"ion-list",3)(23,ye,15,3,"div",3),h.qZA()),2&Fe&&(h.xp6(7),h.Q6J("ngIf",null==De.routeStartPlace),h.xp6(),h.Q6J("ngIf",null!=De.routeStartPlace),h.xp6(),h.Q6J("ngIf",null==De.routeDestinationPlace),h.xp6(),h.Q6J("ngIf",null!=De.routeDestinationPlace),h.xp6(3),h.Q6J("ngIf",De.isRouteSet),h.xp6(2),h.Q6J("ngIf",!De.advancedSettingsMode),h.xp6(),h.Q6J("ngIf",De.advancedSettingsMode),h.xp6(5),h.Q6J("ngIf",De.routeCalcInProgress),h.xp6(),h.Q6J("ngIf",null!=De.selectedJourneyRoute),h.xp6(),h.Q6J("ngIf",De.advancedSettingsMode))},dependencies:[Pe.O5,m.YG,m.Sm,m.gu,m.pK,m.Ie,m.Q$,m.q_,m.yh,m.I_,m.VI,m.PQ,m.sr,m.as,m.j9,m.yf,m.Uj,K.JJ,K.On,be.v,Pe.JJ],encapsulation:2})}return X})(),ct=(()=>{class X{modalController;hasNavbar=!1;constructor(me){this.modalController=me}close(){this.modalController.dismiss()}static \u0275fac=function(Fe){return new(Fe||X)(h.Y36(m.IN))};static \u0275cmp=h.Xpm({type:X,selectors:[["ng-component"]],decls:10,vars:0,consts:[["slot","end"],[3,"click"],["name","close","slot","end"],[1,"route-planner","ion-padding"]],template:function(Fe,De){1&Fe&&(h.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),h._uU(3," Route Planner "),h.qZA(),h.TgZ(4,"ion-buttons",0)(5,"ion-button",1),h.NdJ("click",function(){return De.close()}),h._UZ(6,"ion-icon",2),h._uU(7," Close "),h.qZA()()()(),h.TgZ(8,"ion-content",3),h._UZ(9,"route-planner"),h.qZA())},dependencies:[m.YG,m.Sm,m.W2,m.Gu,m.gu,m.wd,m.sr,Ue],encapsulation:2})}return X})()},4606:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{SearchPageModule:()=>bn});var h=P(5086),m=P(2618),te=P(6814),l=P(6223),B=P(451),Y=P(6800),C=P(5861),ie=P(553),fe=P(7777),Pe=P(4119),K=P(3247),be=P(9723),Te=P(3052),Me=P(4677),de=P(866),nt=P(9127),Ce=P(989),oe=P(1847),xe=P(4669),Ie=P(6470),Ae=P(5460),ye=P(2438),Ue=P(7394);class ct extends Ue.w0{constructor(It,pe){super()}schedule(It,pe=0){return this}}const X={setInterval(Cn,It,...pe){const{delegate:lt}=X;return lt?.setInterval?lt.setInterval(Cn,It,...pe):setInterval(Cn,It,...pe)},clearInterval(Cn){const{delegate:It}=X;return(It?.clearInterval||clearInterval)(Cn)},delegate:void 0};var ve=P(9039),Fe=P(4552);class De{constructor(It,pe=De.now){this.schedulerActionCtor=It,this.now=pe}schedule(It,pe=0,lt){return new this.schedulerActionCtor(this,It).schedule(lt,pe)}}De.now=Fe.l.now;const Ke=new class ze extends De{constructor(It,pe=De.now){super(It,pe),this.actions=[],this._active=!1}flush(It){const{actions:pe}=this;if(this._active)return void pe.push(It);let lt;this._active=!0;do{if(lt=It.execute(It.state,It.delay))break}while(It=pe.shift());if(this._active=!1,lt){for(;It=pe.shift();)It.unsubscribe();throw lt}}}(class me extends ct{constructor(It,pe){super(It,pe),this.scheduler=It,this.work=pe,this.pending=!1}schedule(It,pe=0){var lt;if(this.closed)return this;this.state=It;const Zt=this.id,hn=this.scheduler;return null!=Zt&&(this.id=this.recycleAsyncId(hn,Zt,pe)),this.pending=!0,this.delay=pe,this.id=null!==(lt=this.id)&&void 0!==lt?lt:this.requestAsyncId(hn,this.id,pe),this}requestAsyncId(It,pe,lt=0){return X.setInterval(It.flush.bind(It,this),lt)}recycleAsyncId(It,pe,lt=0){if(null!=lt&&this.delay===lt&&!1===this.pending)return pe;null!=pe&&X.clearInterval(pe)}execute(It,pe){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const lt=this._execute(It,pe);if(lt)return lt;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(It,pe){let Zt,lt=!1;try{this.work(It)}catch(hn){lt=!0,Zt=hn||new Error("Scheduled action threw falsy error")}if(lt)return this.unsubscribe(),Zt}unsubscribe(){if(!this.closed){const{id:It,scheduler:pe}=this,{actions:lt}=pe;this.work=this.state=this.scheduler=null,this.pending=!1,(0,ve.P)(lt,this),null!=It&&(this.id=this.recycleAsyncId(pe,It,null)),this.delay=null,super.unsubscribe()}}});var dn=P(9360),_n=P(8251);const Ne=(0,P(2726).fo)("Geolocation",{web:()=>P.e(579).then(P.bind(P,579)).then(Cn=>new Cn.GeolocationWeb)});var ke=P(9212),it=P(7346),Qt=P(5957);function mt(Cn,It){1&Cn&&ke._UZ(0,"ion-icon",13)}function an(Cn,It){1&Cn&&ke._UZ(0,"ion-spinner")}function tt(Cn,It){if(1&Cn){const pe=ke.EpF();ke.TgZ(0,"ion-button",3),ke.NdJ("click",function(){ke.CHM(pe);const Zt=ke.oxw();return ke.KtG(Zt.openSideView())}),ke._UZ(1,"ion-icon",14),ke.qZA()}}function pt(Cn,It){1&Cn&&(ke.ynx(0),ke.TgZ(1,"div",15)(2,"p"),ke._uU(3,"There was a problem communicating with Open Charge Map. Please check your data connection."),ke.qZA()(),ke.BQk())}let Xt=(()=>{class Cn{appManager;nav;events;translate;platform;poiManager;mapping;journeyManager;zone;modalController;alertController;logging;mapDisplayed=!1;debouncedRefreshMapResults;mapCanvasID;initialResultsShown=!1;searchOnDemand=!1;poiViewMode="modal";sideViewAvailable=!1;searchPolyline;routePlanningMode=!0;searchKeyword="";selectedPOI;appConfig=new fe.X;defaultMapZoom=15;defaultStartPos=new Te.wC(37.415328,-122.076575);placeSearchMapPOI;constructor(pe,lt,Zt,hn,Yt,Ft,Un,Ve,Pt,Kt,wn,ei){this.appManager=pe,this.nav=lt,this.events=Zt,this.translate=hn,this.platform=Yt,this.poiManager=Ft,this.mapping=Un,this.journeyManager=Ve,this.zone=Pt,this.modalController=Kt,this.alertController=wn,this.logging=ei,this.mapCanvasID="map-canvas",this.mapping.setMapType(pe.searchSettings.MapType),this.mapping.setMapAPI(ie.N.defaultMapProvider),(0,ye.R)(window,"resize").pipe(function Ut(Cn,It=Ke){return(0,dn.e)((pe,lt)=>{let Zt=null,hn=null,Yt=null;const Ft=()=>{if(Zt){Zt.unsubscribe(),Zt=null;const Ve=hn;hn=null,lt.next(Ve)}};function Un(){const Ve=Yt+Cn,Pt=It.now();if(Pt<Ve)return Zt=this.schedule(void 0,Ve-Pt),void lt.add(Zt);Ft()}pe.subscribe((0,_n.x)(lt,Ve=>{hn=Ve,Yt=It.now(),Zt||(Zt=It.schedule(Un,Cn),lt.add(Zt))},()=>{Ft(),lt.complete()},void 0,()=>{hn=Zt=null}))})}(500)).subscribe(Lr=>{let Mi={width:de.c.getClientHeight(),height:de.c.getClientWidth()};this.events.publish("ocm:window:resized",[Mi])})}ionViewDidEnter(){this.logging.log("Entered search page.",nt.i.VERBOSE),this.mapping.focusMap(),this.mapping.updateMapSize()}ionViewWillLeave(){this.logging.log("Leaving search page.",nt.i.VERBOSE),this.mapping.unfocusMap()}getPreferredMapHeight(pe){return null==pe&&(pe=de.c.getClientHeight()),pe-56}enforceMapHeight(pe){this.logging.log("Would resize map:"+pe.width+" "+pe.height,nt.i.VERBOSE);const lt=this.getPreferredMapHeight(pe[0]);document.getElementById(this.mapCanvasID).offsetHeight!==lt&&(document.getElementById(this.mapCanvasID).style.height=lt+"px"),this.mapping&&(this.logging.log("Map height:"+lt,nt.i.VERBOSE),this.mapping.updateMapSize())}initialiseMapping(){var pe=this;return(0,C.Z)(function*(){yield pe.platform.ready(),pe.debouncedRefreshMapResults=de.c.debounce(pe.refreshMapResults,1e3,!1),pe.events.subscribe("ocm:mapping:ready",(0,C.Z)(function*(){if(pe.logging.log("init map: mapping ready"),pe.mapping&&pe.mapping.updateMapSize(),!pe.initialResultsShown)if(pe.appManager.searchSettings.StartSearchPosition&&!pe.appManager.searchSettings.StartViewPoiId)pe.searchOnDemand=!0,pe.mapping.updateMapCentrePos(pe.appManager.searchSettings.StartSearchPosition.latitude,pe.appManager.searchSettings.StartSearchPosition.longitude,!0,pe.defaultMapZoom);else{let lt=localStorage.getItem("_locationEnabled");1==pe.appManager.isEmbeddedMode&&"true"!=lt?yield(yield pe.alertController.create({header:"Search using your location?",message:"Select OK to continue.",buttons:[{text:"Cancel",role:"cancel",cssClass:"secondary",handler:(hn=(0,C.Z)(function*(){yield pe.useFallbackPosition()}),function(){return hn.apply(this,arguments)})},{text:"OK",handler:function(){var hn=(0,C.Z)(function*(){yield pe.locateUser()});return function(){return hn.apply(this,arguments)}}()}]})).present():(yield pe.locateUser(),pe.mapping&&pe.mapping.updateMapSize())}var hn})),pe.events.subscribe("ocm:mapping:zoom",()=>{pe.debouncedRefreshMapResults()}),pe.events.subscribe("ocm:mapping:dragend",()=>{pe.debouncedRefreshMapResults()}),pe.events.subscribe("ocm:poiList:updated",lt=>{pe.showPOIListOnMap(lt)}),pe.events.subscribe("ocm:poiList:cleared",()=>{pe.mapping.clearMarkers(),setTimeout(()=>{pe.debouncedRefreshMapResults()},500)}),pe.events.subscribe("ocm:window:resized",lt=>{null!=lt&&lt.length>0&&pe.enforceMapHeight(lt[0])}),pe.events.subscribe("ocm:poi:selected",lt=>{lt.poi?pe.viewPOIDetails(lt,lt.poi):pe.viewPOIDetails(lt,null,!0)}),pe.mapping.initMap(pe.mapCanvasID)})()}ngAfterViewInit(){var pe=this;return(0,C.Z)(function*(){yield pe.initialiseMapping()})()}ngOnInit(){var pe=this;return(0,C.Z)(function*(){pe.logging.log("Refreshing reference data ..",nt.i.VERBOSE),(yield pe.appManager.referenceDataManager.refreshReferenceData(pe.appManager.api))||(pe.appManager.isOffline=!0)})()}showPOIListOnMap(pe){const lt=this.getPreferredMapHeight(null);this.mapping.refreshMapView(lt,this.poiManager.poiList,null),this.mapDisplayed||(this.mapDisplayed=!0)}getIconForPOI(pe){return de.c.getIconForPOI(pe)}getPOIByID(pe){const lt=this.poiManager.poiList;for(let Zt=0;Zt<lt.length;Zt++)if(lt[Zt].ID===pe)return lt[Zt];return null}refreshMapResults(){var pe=this;return(0,C.Z)(function*(){if(!pe.searchOnDemand)return void pe.logging.log("Skipping refresh, search on demand disabled..",nt.i.VERBOSE);pe.logging.log("Refreshing Results..",nt.i.VERBOSE);const lt=new Me.b;let Zt=null;if(pe.appManager.searchSettings.StartViewPoiId){let Yt=pe.appManager.searchSettings.StartViewPoiId;pe.appManager.searchSettings.StartViewPoiId=null;let Ft=yield pe.poiManager.getPOIById(Yt,!0);Ft&&(pe.events.publish("ocm:poi:selected",{poiId:Ft.ID,poi:Ft}),pe.mapping.updateMapCentrePos(Ft.AddressInfo.Latitude,Ft.AddressInfo.Longitude,!0,pe.defaultMapZoom))}if(pe.appManager.searchSettings.StartSearchPosition&&(Zt=new Te.jR(pe.appManager.searchSettings.StartSearchPosition.latitude,pe.appManager.searchSettings.StartSearchPosition.longitude),pe.appManager.searchSettings.StartSearchPosition=null),Zt&&0==Zt.coords.latitude&&0==Zt.coords.longitude)return void pe.logging.log("Map center is zero. No query will be performed",nt.i.WARNING);if(null!=Zt)lt.latitude=Zt.coords.latitude,lt.longitude=Zt.coords.longitude,lt.distance=25,lt.boundingbox=null,pe.appManager.searchSettings.LastSearchPosition=new Te.wC(Zt.coords.latitude,Zt.coords.longitude);else{lt.latitude=null,lt.longitude=null;let Yt=yield pe.mapping.getMapBounds().toPromise();lt.boundingbox="("+Yt[0].latitude+","+Yt[0].longitude+"),("+Yt[1].latitude+","+Yt[1].longitude+")",pe.logging.log(JSON.stringify(Yt),nt.i.VERBOSE)}lt.includeComments=!0,lt.enableCaching=!0,null!=pe.appManager.searchSettings&&(null!=pe.appManager.searchSettings.ConnectionTypeList&&(lt.connectionTypeIdList=pe.appManager.searchSettings.ConnectionTypeList),null!=pe.appManager.searchSettings.UsageTypeList&&(lt.usageTypeIdList=pe.appManager.searchSettings.UsageTypeList),null!=pe.appManager.searchSettings.StatusTypeList&&(lt.statusTypeIdList=pe.appManager.searchSettings.StatusTypeList),null!=pe.appManager.searchSettings.OperatorList&&(lt.operatorIdList=pe.appManager.searchSettings.OperatorList),null!=pe.appManager.searchSettings.MinPowerKW&&pe.appManager.searchSettings.MinPowerKW>0&&(lt.minPowerKW=pe.appManager.searchSettings.MinPowerKW),null!=pe.appManager.searchSettings.MaxPowerKW&&pe.appManager.searchSettings.MaxPowerKW>0&&(lt.maxPowerKW=pe.appManager.searchSettings.MaxPowerKW),null!=pe.appManager.searchSettings.MaxResults&&pe.appManager.searchSettings.MaxResults>0&&pe.appManager.searchSettings.MaxResults<=1e4&&(lt.maxResults=pe.appManager.searchSettings.MaxResults),null!=pe.journeyManager.getRoutePolyline()&&(lt.polyline=pe.journeyManager.getRoutePolyline(),lt.boundingbox=null,lt.levelOfDetail=null,lt.latitude=null,lt.longitude=null)),pe.appManager.searchSettings.EnablePOIPendingApproval&&(lt.submissionStatusTypeIdList=[1,100,200]),pe.appManager.isRequestInProgress=!0;let hn=yield pe.poiManager.refreshPOIList(lt);pe.appManager.isRequestInProgress=!1,pe.initialResultsShown=!0,hn>=lt.maxResults&&pe.appManager.showToastNotification("A maximum of "+hn+" results are returned per search. Zoom in for details.")})()}viewPOIDetails(pe,lt,Zt=!1){this.logging.log("Viewing/fetching ["+this.poiViewMode+"] POI Details "+pe.poiId),null!=lt?(this.mapping.unfocusMap(),this.modalController.create({component:be.H,componentProps:{item:lt}}).then(hn=>{hn.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),hn.present()}),Zt&&this.mapping.updateMapCentrePos(lt.AddressInfo.Latitude,lt.AddressInfo.Longitude,!0,this.defaultMapZoom)):this.poiManager.getPOIById(pe.poiId,!0).then(hn=>{this.logging.log("Got POI Details "+hn.ID),"modal"===this.poiViewMode&&(this.searchOnDemand=!1,this.modalController.create({component:be.H,componentProps:{item:hn}}).then(Yt=>{Yt.onDidDismiss().then(()=>{this.logging.log("Dismissing POI Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),Yt.present()}),this.mapping.unfocusMap(),Zt&&this.mapping.updateMapCentrePos(hn.AddressInfo.Latitude,hn.AddressInfo.Longitude,!0,this.defaultMapZoom)),"side"===this.poiViewMode&&(this.selectedPOI=hn)},hn=>{this.appManager.showToastNotification("POI Details not available")})}closePOIDetails(){this.selectedPOI=null}openRoutePlannerModal(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:K.u}).then(pe=>{pe.onDidDismiss().then(lt=>{this.logging.log("Dismissing Route Planner Details."),this.mapping.focusMap(),this.searchOnDemand=!0}),pe.present()})}openSearchOptions(){this.searchOnDemand=!1,this.mapping.unfocusMap(),this.modalController.create({component:Pe.N}).then(pe=>{pe.onDidDismiss().then(lt=>{this.mapping.focusMap(),this.searchOnDemand=!0}),pe.present()})}openSideView(){this.poiViewMode="side",this.mapping.updateMapSize()}closeSideView(){this.poiViewMode="modal",this.mapping.updateMapSize()}planRoute(){this.routePlanningMode=!0}search(pe){this.placeSearchMapPOI.getPlacesAutoComplete(pe,"poiSearch")}useFallbackPosition(){let pe=this.defaultStartPos;null!=this.appManager.searchSettings.LastSearchPosition&&(pe=this.appManager.searchSettings.LastSearchPosition),this.appManager.searchSettings.StartSearchPosition=pe,this.appManager.searchSettings.LastSearchPosition=null,this.searchOnDemand=!0,this.mapping.updateMapCentrePos(pe.latitude,pe.longitude,!0,this.defaultMapZoom)}_watchId=null;getPosition(pe={}){var lt=this;return(0,C.Z)(function*(){return new Promise((Zt,hn)=>{lt._watchId=Ne.watchPosition(pe,(Yt,Ft)=>{lt._watchId&&Ne.clearWatch({id:lt._watchId}),Ft?hn(Ft):Zt(Yt)})})})()}locateUser(){var pe=this;return(0,C.Z)(function*(){pe.useFallbackPosition();try{pe.logging.log("Attempting to locate user..");const lt=yield pe.getPosition({timeout:1e4});if(!lt)throw"Failed to get user location.";return pe.logging.log("Got user location."),pe.appManager.searchSettings.StartSearchPosition=new Te.wC(lt.coords.latitude,lt.coords.longitude),pe.searchOnDemand=!0,pe.mapping.updateMapCentrePos(lt.coords.latitude,lt.coords.longitude,!0,pe.defaultMapZoom),localStorage.setItem("_locationEnabled","true"),!0}catch(lt){return pe.logging.log("Failed to get user location. Searching using default or last position."+lt),pe.appManager.showToastNotification("Your location could not be determined."),pe.useFallbackPosition(),!1}})()}placeSelected(pe){if(this.searchKeyword=pe.Address,this.logging.log("Got place details:"+pe.Address),this.mapping.focusMap(),null!=pe.Location)this.mapping.updateMapCentrePos(pe.Location.latitude,pe.Location.longitude,!0);else if(null!=pe.ReferenceID&&pe.ReferenceID.startsWith("OCM-")){let lt=pe.ReferenceID.replace("OCM-","");this.events.publish("ocm:poi:selected",{poiId:lt,poi:null})}this.debouncedRefreshMapResults()}static \u0275fac=function(lt){return new(lt||Cn)(ke.Y36(Ie.c),ke.Y36(it.SH),ke.Y36(Qt.z),ke.Y36(m.sK),ke.Y36(it.t4),ke.Y36(xe.R),ke.Y36(oe.v),ke.Y36(Ce.i),ke.Y36(ke.R0b),ke.Y36(B.IN),ke.Y36(B.Br),ke.Y36(nt.z))};static \u0275cmp=ke.Xpm({type:Cn,selectors:[["ng-component"]],viewQuery:function(lt,Zt){if(1&lt&&ke.Gf(Ae.v,7),2&lt){let hn;ke.iGM(hn=ke.CRH())&&(Zt.placeSearchMapPOI=hn.first)}},decls:18,vars:10,consts:[["slot","start"],["autocapitalize","on","autocomplete","on",3,"ngModel","placeholder","debounce","ngModelChange","ionInput"],["slot","end"],[3,"click"],["name","locate","slot","start",4,"ngIf"],[4,"ngIf"],[3,"color","click"],["name","options","slot","end"],[3,"click",4,"ngIf"],[1,"search-page"],[3,"placeChanged"],["placeSearchMapPOI",""],["id","map-canvas",2,"height","100%","width","100%","min-height","300px"],["name","locate","slot","start"],["name","car","title","Route","slot","end"],[2,"position","absolute"]],template:function(lt,Zt){1&lt&&(ke.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),ke._UZ(3,"ion-menu-button"),ke.qZA(),ke.TgZ(4,"ion-searchbar",1),ke.NdJ("ngModelChange",function(Yt){return Zt.searchKeyword=Yt})("ionInput",function(Yt){return Zt.search(Yt)}),ke.ALo(5,"translate"),ke.qZA(),ke.TgZ(6,"ion-buttons",2)(7,"ion-button",3),ke.NdJ("click",function(){return Zt.locateUser()}),ke.YNc(8,mt,1,0,"ion-icon",4)(9,an,1,0,"ion-spinner",5),ke.qZA(),ke.TgZ(10,"ion-button",6),ke.NdJ("click",function(){return Zt.openSearchOptions()}),ke._UZ(11,"ion-icon",7),ke.qZA(),ke.YNc(12,tt,2,0,"ion-button",8),ke.qZA()()(),ke.TgZ(13,"ion-content",9)(14,"place-search",10,11),ke.NdJ("placeChanged",function(Yt){return Zt.placeSelected(Yt)}),ke.qZA(),ke.YNc(16,pt,4,0,"ng-container",5),ke._UZ(17,"div",12),ke.qZA()),2&lt&&(ke.xp6(4),ke.Q6J("ngModel",Zt.searchKeyword)("placeholder",ke.lcZ(5,8,"ocm.search.performSearch"))("debounce",500),ke.xp6(4),ke.Q6J("ngIf",!Zt.appManager.isRequestInProgress),ke.xp6(),ke.Q6J("ngIf",Zt.appManager.isRequestInProgress),ke.xp6(),ke.Q6J("color",Zt.appManager.searchSettings.HasActiveFilters?"danger":"default"),ke.xp6(2),ke.Q6J("ngIf",1==Zt.sideViewAvailable&&"modal"==Zt.poiViewMode),ke.xp6(4),ke.Q6J("ngIf",Zt.appManager.isOffline))},dependencies:[te.O5,l.JJ,l.On,B.YG,B.Sm,B.W2,B.Gu,B.gu,B.fG,B.VI,B.PQ,B.sr,B.j9,Ae.v,m.X$],styles:[".search-page[_ngcontent-%COMP%]   #map-canvas[_ngcontent-%COMP%]{width:100%;height:98%}.search-page[_ngcontent-%COMP%]   #place-search[_ngcontent-%COMP%]{min-height:300px;background-color:#f0f0f0;position:absolute;z-index:100;width:100%}.search-page[_ngcontent-%COMP%]   scroll-content[_ngcontent-%COMP%]{overflow-y:hidden}.search-page[_ngcontent-%COMP%]   .banner[_ngcontent-%COMP%]{padding-left:2em}.search-page[_ngcontent-%COMP%]   .sideview[_ngcontent-%COMP%]{background:#eee;background:linear-gradient(to bottom,#eee,#fff)}"]})}return Cn})(),bn=(()=>{class Cn{static \u0275fac=function(lt){return new(lt||Cn)};static \u0275mod=ke.oAB({type:Cn});static \u0275inj=ke.cJS({imports:[te.ez,l.u5,B.Pc,m.aw,h.e,Y.Bz.forChild([{path:"",component:Xt}])]})}return Cn})()},4119:(Bn,Ct,P)=>{"use strict";P.d(Ct,{N:()=>ye});var h=P(5861),m=P(4669),te=P(6470),l=P(4783),B=P(866),Y=P(1847),C=P(9212),ie=P(451),fe=P(5957),Pe=P(6814),K=P(6223),be=P(6086),Te=P(2618);let Me=(()=>{class Ue extends Te.X${constructor(X,ve){super(X,ve)}transform(X,...ve){let me=super.transform(X,...ve);return me==X?null!=ve&&ve[0].default?ve[0].default:ve[0].Title?ve[0].Title:me:me}static \u0275fac=function(ve){return new(ve||Ue)(C.Y36(Te.sK,16),C.Y36(C.sBO,16))};static \u0275pipe=C.Yjl({name:"nullableTranslate",type:Ue,pure:!0});static \u0275prov=C.Yz7({token:Ue,factory:Ue.\u0275fac})}return Ue})();function de(Ue,ct){if(1&Ue){const X=C.EpF();C.TgZ(0,"p",23),C._UZ(1,"ion-icon",24),C._uU(2," One or more filters are currently being applied. "),C.TgZ(3,"ion-button",25),C.NdJ("click",function(){C.CHM(X);const me=C.oxw();return C.KtG(me.clearFilters())}),C._UZ(4,"ion-icon",26),C.TgZ(5,"ion-label"),C._uU(6,"Clear"),C.qZA()()()}}function nt(Ue,ct){if(1&Ue&&(C.TgZ(0,"ion-select-option",28),C._uU(1),C.qZA()),2&Ue){const X=ct.$implicit;C.Q6J("value",X.ID),C.xp6(),C.Oqu(X.Title)}}function Ce(Ue,ct){if(1&Ue){const X=C.EpF();C.TgZ(0,"ion-item")(1,"ion-select",15),C.NdJ("ngModelChange",function(me){C.CHM(X);const Fe=C.oxw();return C.KtG(Fe.searchSettings.FilterOptionsByCountryId=me)})("ionChange",function(){C.CHM(X);const me=C.oxw();return C.KtG(me.onCountryChange())}),C.ALo(2,"translate"),C.TgZ(3,"ion-select",27),C._uU(4,"(All Countries)"),C.qZA(),C.YNc(5,nt,2,2,"ion-select-option",5),C.qZA()()}if(2&Ue){const X=C.oxw();C.xp6(),C.Q6J("label",C.lcZ(2,3,"ocm.search.countries"))("ngModel",X.searchSettings.FilterOptionsByCountryId),C.xp6(4),C.Q6J("ngForOf",X.countries)}}function oe(Ue,ct){if(1&Ue&&(C.TgZ(0,"ion-select-option",28),C._uU(1),C.ALo(2,"nullableTranslate"),C.qZA()),2&Ue){const X=ct.$implicit;C.Q6J("value",X.ID),C.xp6(),C.Oqu(C.xi3(2,2,"ocm.reference.usageType.value_"+X.ID,X))}}function xe(Ue,ct){if(1&Ue&&(C.TgZ(0,"ion-select-option",28),C._uU(1),C.ALo(2,"nullableTranslate"),C.qZA()),2&Ue){const X=ct.$implicit;C.Q6J("value",X.ID),C.xp6(),C.Oqu(C.xi3(2,2,"ocm.reference.statusType.value_"+X.ID,X))}}function Ie(Ue,ct){if(1&Ue&&(C.TgZ(0,"ion-select-option",28),C._uU(1),C.ALo(2,"nullableTranslate"),C.qZA()),2&Ue){const X=ct.$implicit;C.Q6J("value",X.ID),C.xp6(),C.Oqu(C.xi3(2,2,"ocm.reference.connectionType.value_"+X.ID,X))}}function Ae(Ue,ct){if(1&Ue&&(C.TgZ(0,"ion-select-option",28),C._uU(1),C.qZA()),2&Ue){const X=ct.$implicit;C.Q6J("value",X.code),C.xp6(),C.Oqu(X.title)}}let ye=(()=>{class Ue{appManager;poiManager;mapping;modalController;events;searchSettings;maxPower=l.U;powerRange={lower:0,upper:this.maxPower};constructor(X,ve,me,Fe,De){this.appManager=X,this.poiManager=ve,this.mapping=me,this.modalController=Fe,this.events=De,this.searchSettings=X.searchSettings}ngOnInit(){var X=this;return(0,h.Z)(function*(){null!=X.searchSettings.MinPowerKW&&(X.powerRange.lower=X.searchSettings.MinPowerKW),null!=X.searchSettings.MaxPowerKW&&(X.powerRange.upper=X.searchSettings.MaxPowerKW),0==X.powerRange.upper&&(X.powerRange.upper=X.maxPower),X.appManager.analytics.viewEvent("Settings"),X.useFilteredOptions&&(yield X.onCountryChange())})()}get useFilteredOptions(){return this.searchSettings.FilterOptionsByCountryId>0}clearFilters(){this.searchSettings.ClearActiveFilters(),this.powerRange={lower:0,upper:this.maxPower},this.searchSettings.CheckForActiveFilters()}get operators(){return this.appManager.referenceDataManager.getNetworkOperators(this.useFilteredOptions)}get connectionTypes(){return this.appManager.referenceDataManager.getConnectionTypes(this.useFilteredOptions)}get usageTypes(){return this.appManager.referenceDataManager.getUsageTypes(this.useFilteredOptions)}get statusTypes(){return this.appManager.referenceDataManager.getStatusTypes(this.useFilteredOptions)}get countries(){return this.appManager.referenceDataManager.getCountries(this.useFilteredOptions)}get isCountryFilterFeatureEnabled(){return B.c.isFeatureEnabled("FILTER_OPTIONS_BY_COUNTRY")}_languages=[];get languages(){return this._languages.length>0||(this._languages=this.appManager.getLanguages()),this._languages}ionViewWillLeave(){null!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language),this.searchSettings.MinPowerKW=this.powerRange.lower,this.searchSettings.MaxPowerKW=this.powerRange.upper,1==this.searchSettings.MinPowerKW&&(this.searchSettings.MinPowerKW=null),this.searchSettings.MaxPowerKW==this.maxPower&&(this.searchSettings.MaxPowerKW=null),this.appManager.searchSettings=this.searchSettings,this.appManager.saveSearchSettings(),this.events.publish("ocm:poiList:cleared")}onLanguageChange(){null!=this.searchSettings.Language&&""!=this.searchSettings.Language&&this.appManager.setLanguage(this.searchSettings.Language)}onCountryChange(){var X=this;return(0,h.Z)(function*(){X.appManager.referenceDataManager.refreshFilteredReferenceData(X.appManager.api,{CountryIds:[X.searchSettings.FilterOptionsByCountryId]})})()}onMapTypeChange(){var X=this;return(0,h.Z)(function*(){X.mapping.setMapType(X.searchSettings.MapType)})()}onOperatorSelected(X=null){var ve=this;return(0,h.Z)(function*(){null!=X&&(ve.searchSettings.OperatorList.find(me=>me==X.ID)||ve.searchSettings.OperatorList.push(X.ID))})()}onOperatorRemoved(X){var ve=this;return(0,h.Z)(function*(){ve.searchSettings.OperatorList=ve.searchSettings.OperatorList.filter(me=>me!=X)})()}close(){this.modalController.dismiss()}static \u0275fac=function(ve){return new(ve||Ue)(C.Y36(te.c),C.Y36(m.R),C.Y36(Y.v),C.Y36(ie.IN),C.Y36(fe.z))};static \u0275cmp=C.Xpm({type:Ue,selectors:[["ng-component"]],decls:66,vars:41,consts:[[1,"settings-page","ion-padding"],["danger","",4,"ngIf"],[4,"ngIf"],["mode","multi",3,"operatorList","useFilteredOperators","operatorRemoved","operatorChanged"],["multiple","true","cancelText","Cancel","okText","OK",3,"label","ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["lines","none"],["dualKnobs","true","min","0","max","650","pin","true",3,"ngModel","ticks","snaps","min","max","ngModelChange"],["slot","start","size","small","name","flash"],["slot","end","name","flash"],["slot","start",2,"padding-top","0"],["type","number","min","0",2,"width","3em","border","none",3,"ngModel","max","ngModelChange"],["slot","end",2,"padding-top","0"],["type","number",2,"width","3em","border","none",3,"ngModel","max","min","ngModelChange"],["label","Language","multiple","false",3,"ngModel","ngModelChange","ionChange"],["multiple","false","cancelText","Cancel","okText","OK",3,"label","ngModel","ngModelChange","ionChange"],["value","ROADMAP"],["value","SATELLITE"],[3,"ngModel","ngModelChange"],["label","Max Results","type","number","placeholder","500","min","100","max","10000",3,"ngModel","ngModelChange"],["slot","end"],[3,"click"],["name","close","slot","start"],["danger",""],["name","alert"],["size","small","color","light",3,"click"],["slot","start","name","close"],["value",""],[3,"value"]],template:function(ve,me){1&ve&&(C.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),C._uU(3),C.ALo(4,"translate"),C.qZA()()(),C.TgZ(5,"ion-content",0)(6,"h2"),C._uU(7,"Search Filters"),C.qZA(),C.TgZ(8,"p"),C._uU(9,"Note: Filters will remove usable charging locations from your search results if we do not have complete data (i.e Operator or Power Levels)."),C.qZA(),C.YNc(10,de,7,0,"p",1),C.TgZ(11,"ion-list"),C.YNc(12,Ce,6,5,"ion-item",2),C.TgZ(13,"app-operator-lookup",3),C.NdJ("operatorRemoved",function(De){return me.onOperatorRemoved(De)})("operatorChanged",function(De){return me.onOperatorSelected(De)}),C.qZA(),C.TgZ(14,"ion-item")(15,"ion-select",4),C.NdJ("ngModelChange",function(De){return me.searchSettings.UsageTypeList=De}),C.ALo(16,"translate"),C.YNc(17,oe,3,5,"ion-select-option",5),C.qZA()(),C.TgZ(18,"ion-item")(19,"ion-select",4),C.NdJ("ngModelChange",function(De){return me.searchSettings.StatusTypeList=De}),C.ALo(20,"translate"),C.YNc(21,xe,3,5,"ion-select-option",5),C.qZA()(),C.TgZ(22,"ion-item")(23,"ion-select",4),C.NdJ("ngModelChange",function(De){return me.searchSettings.ConnectionTypeList=De}),C.ALo(24,"translate"),C.YNc(25,Ie,3,5,"ion-select-option",5),C.qZA()(),C.TgZ(26,"ion-item",6)(27,"ion-range",7),C.NdJ("ngModelChange",function(De){return me.powerRange=De}),C.TgZ(28,"ion-icon",8),C._uU(29,"0"),C.qZA(),C._UZ(30,"ion-icon",9),C.qZA()(),C.TgZ(31,"ion-item",6)(32,"ion-note",10),C._uU(33,"Min. Power (kW)"),C._UZ(34,"br"),C.TgZ(35,"input",11),C.NdJ("ngModelChange",function(De){return me.powerRange.lower=De}),C.qZA()(),C.TgZ(36,"ion-note",12),C._uU(37,"Max. Power (kW)"),C._UZ(38,"br"),C.TgZ(39,"input",13),C.NdJ("ngModelChange",function(De){return me.powerRange.upper=De}),C.qZA()()()(),C.TgZ(40,"h2"),C._uU(41," General Settings "),C.qZA(),C.TgZ(42,"ion-item")(43,"ion-select",14),C.NdJ("ngModelChange",function(De){return me.searchSettings.Language=De})("ionChange",function(){return me.onLanguageChange()}),C.YNc(44,Ae,2,2,"ion-select-option",5),C.qZA()(),C.TgZ(45,"ion-item")(46,"ion-select",15),C.NdJ("ngModelChange",function(De){return me.searchSettings.MapType=De})("ionChange",function(){return me.onMapTypeChange()}),C.ALo(47,"translate"),C.TgZ(48,"ion-select-option",16),C._uU(49,"Road Map"),C.qZA(),C.TgZ(50,"ion-select-option",17),C._uU(51,"Satellite"),C.qZA()()(),C.TgZ(52,"ion-item")(53,"ion-toggle",18),C.NdJ("ngModelChange",function(De){return me.searchSettings.EnableAdvancedEditorFeatures=De}),C._uU(54,"Enable Advanced Editor Options"),C.qZA()(),C.TgZ(55,"ion-item")(56,"ion-toggle",18),C.NdJ("ngModelChange",function(De){return me.searchSettings.EnablePOIPendingApproval=De}),C._uU(57,"Show POIs Pending Approval"),C.qZA()(),C.TgZ(58,"ion-item")(59,"ion-input",19),C.NdJ("ngModelChange",function(De){return me.searchSettings.MaxResults=De}),C.qZA()()(),C.TgZ(60,"ion-footer")(61,"ion-toolbar")(62,"ion-buttons",20)(63,"ion-button",21),C.NdJ("click",function(){return me.close()}),C._UZ(64,"ion-icon",22),C._uU(65," Close "),C.qZA()()()()),2&ve&&(C.xp6(3),C.hij(" ",C.lcZ(4,31,"ocm.general.settings")," "),C.xp6(7),C.Q6J("ngIf",1==me.searchSettings.HasActiveFilters),C.xp6(2),C.Q6J("ngIf",me.isCountryFilterFeatureEnabled),C.xp6(),C.Q6J("operatorList",me.searchSettings.OperatorList)("useFilteredOperators",!1),C.xp6(2),C.Q6J("label",C.lcZ(16,33,"ocm.search.usageTypes"))("ngModel",me.searchSettings.UsageTypeList),C.xp6(2),C.Q6J("ngForOf",me.usageTypes),C.xp6(2),C.Q6J("label",C.lcZ(20,35,"ocm.search.operationalStatusTypes"))("ngModel",me.searchSettings.StatusTypeList),C.xp6(2),C.Q6J("ngForOf",me.statusTypes),C.xp6(2),C.Q6J("label",C.lcZ(24,37,"ocm.search.connectionTypes"))("ngModel",me.searchSettings.ConnectionTypeList),C.xp6(2),C.Q6J("ngForOf",me.connectionTypes),C.xp6(2),C.Q6J("ngModel",me.powerRange)("ticks",!0)("snaps",!0)("min",me.powerRange.lower)("max",me.powerRange.upper),C.xp6(8),C.Q6J("ngModel",me.powerRange.lower)("max",me.powerRange.upper),C.xp6(4),C.Q6J("ngModel",me.powerRange.upper)("max",me.maxPower)("min",me.powerRange.lower),C.xp6(4),C.Q6J("ngModel",me.searchSettings.Language),C.xp6(),C.Q6J("ngForOf",me.languages),C.xp6(2),C.Q6J("label",C.lcZ(47,39,"ocm.details.location.map"))("ngModel",me.searchSettings.MapType),C.xp6(7),C.Q6J("ngModel",me.searchSettings.EnableAdvancedEditorFeatures),C.xp6(3),C.Q6J("ngModel",me.searchSettings.EnablePOIPendingApproval),C.xp6(3),C.Q6J("ngModel",me.searchSettings.MaxResults))},dependencies:[Pe.sg,Pe.O5,K.Fj,K.wV,K.JJ,K.qQ,K.Fd,K.On,ie.YG,ie.Sm,ie.W2,ie.fr,ie.Gu,ie.gu,ie.pK,ie.Ie,ie.Q$,ie.q_,ie.uN,ie.I_,ie.t9,ie.n0,ie.wd,ie.ho,ie.sr,ie.w,ie.as,ie.QI,ie.j9,ie.yf,ie.Uj,be.z,Te.X$,Me],encapsulation:2})}return Ue})()},9472:(Bn,Ct,P)=>{"use strict";P.r(Ct),P.d(Ct,{SignInModule:()=>fe});var h=P(8767),m=P(5086),te=P(2618),l=P(6814),B=P(6223),Y=P(451),C=P(6800),ie=P(9212);let fe=(()=>{class Pe{static \u0275fac=function(Te){return new(Te||Pe)};static \u0275mod=ie.oAB({type:Pe});static \u0275inj=ie.cJS({imports:[l.ez,B.u5,Y.Pc,te.aw,m.e,C.Bz.forChild([{path:"",component:h.F}])]})}return Pe})()},8767:(Bn,Ct,P)=>{"use strict";P.d(Ct,{F:()=>be});var h=P(5861),m=P(9127),te=P(6470),l=P(9212),B=P(451),Y=P(2618),C=P(6800),ie=P(6814),fe=P(6223);function Pe(Te,Me){if(1&Te){const de=l.EpF();l.ynx(0),l.TgZ(1,"p",13),l._uU(2," Sign in using your Open Charge Map account. "),l.qZA(),l.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-label",14),l._uU(6,"Email"),l.qZA(),l.TgZ(7,"ion-input",15),l.NdJ("ngModelChange",function(Ce){l.CHM(de);const oe=l.oxw();return l.KtG(oe.email=Ce)}),l.qZA()(),l.TgZ(8,"ion-item")(9,"ion-label",14),l._uU(10,"Password"),l.qZA(),l.TgZ(11,"ion-input",16),l.NdJ("ngModelChange",function(Ce){l.CHM(de);const oe=l.oxw();return l.KtG(oe.password=Ce)}),l.qZA()()(),l.TgZ(12,"p")(13,"a",8),l.NdJ("click",function(){l.CHM(de);const Ce=l.oxw();return l.KtG(Ce.appManager.launchWebPage("https://openchargemap.org/site/loginprovider/passwordreset"))}),l._uU(14,"Reset your password"),l.qZA()(),l.BQk()}if(2&Te){const de=l.oxw();l.xp6(7),l.Q6J("ngModel",de.email),l.xp6(4),l.Q6J("ngModel",de.password)}}function K(Te,Me){if(1&Te){const de=l.EpF();l.ynx(0),l.TgZ(1,"p",13),l._uU(2," Create a new Open Charge Map account. "),l.qZA(),l.TgZ(3,"ion-list")(4,"ion-item")(5,"ion-label",14),l._uU(6,"Email"),l.qZA(),l.TgZ(7,"ion-input",15),l.NdJ("ngModelChange",function(Ce){l.CHM(de);const oe=l.oxw();return l.KtG(oe.email=Ce)}),l.qZA()(),l.TgZ(8,"ion-item")(9,"ion-label",14),l._uU(10,"Display Name or Nickname"),l.qZA(),l.TgZ(11,"ion-input",15),l.NdJ("ngModelChange",function(Ce){l.CHM(de);const oe=l.oxw();return l.KtG(oe.username=Ce)}),l.qZA()(),l.TgZ(12,"ion-item")(13,"ion-label",14),l._uU(14,"Password"),l.qZA(),l.TgZ(15,"ion-input",16),l.NdJ("ngModelChange",function(Ce){l.CHM(de);const oe=l.oxw();return l.KtG(oe.password=Ce)}),l.qZA()(),l.TgZ(16,"ion-item")(17,"ion-label",14),l._uU(18,"Confirm Password"),l.qZA(),l.TgZ(19,"ion-input",16),l.NdJ("ngModelChange",function(Ce){l.CHM(de);const oe=l.oxw();return l.KtG(oe.confirmpassword=Ce)}),l.qZA()()(),l.BQk()}if(2&Te){const de=l.oxw();l.xp6(7),l.Q6J("ngModel",de.email),l.xp6(4),l.Q6J("ngModel",de.username),l.xp6(4),l.Q6J("ngModel",de.password),l.xp6(4),l.Q6J("ngModel",de.confirmpassword)}}let be=(()=>{class Te{appManager;modalController;translate;alertController;loadingController;logging;router;location;email;password;username;confirmpassword;mode="signin";constructor(de,nt,Ce,oe,xe,Ie,Ae,ye){this.appManager=de,this.modalController=nt,this.translate=Ce,this.alertController=oe,this.loadingController=xe,this.logging=Ie,this.router=Ae,this.location=ye,this.email=""}cancelSignIn(){this.modalController.dismiss()}performRegister(){var de=this;return(0,h.Z)(function*(){if(de.password!=de.confirmpassword)return void alert("Your password and the confirmed password do not match, please try again.");if(de.password.length<6)return void alert("Your password should be at least 6 characters.");const nt=yield de.loadingController.create({message:"Registering .."});yield nt.present();let Ce=!1;try{yield de.appManager.api.performRegister(de.username,de.email,de.password),nt.dismiss(),localStorage.setItem("authResponse",JSON.stringify(de.appManager.api.authResponse)),de.appManager.isUserAuthenticated(!0),de.modalController.dismiss(),de.appManager.analytics.appEvent("Profile","SignedIn")}catch(oe){Ce=!0,nt.dismiss(),yield(yield de.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),de.logging.log("Error logging in:"+oe)}})()}performSignIn(){var de=this;return(0,h.Z)(function*(){if("register"==de.mode)return de.performRegister();const nt=yield de.loadingController.create({message:"Signing In.."});yield nt.present();let Ce=!1;try{yield de.appManager.api.performSignIn(de.email,de.password),nt.dismiss(),localStorage.setItem("authResponse",JSON.stringify(de.appManager.api.authResponse)),de.appManager.isUserAuthenticated(!0),de.modalController.dismiss(),de.appManager.analytics.appEvent("Profile","SignedIn")}catch(oe){Ce=!0,nt.dismiss(),yield(yield de.alertController.create({header:"Open Charge Map",subHeader:"Email or Password not recognised",buttons:["Ok"]})).present(),de.logging.log("Error logging in:"+oe)}})()}static \u0275fac=function(nt){return new(nt||Te)(l.Y36(te.c),l.Y36(B.IN),l.Y36(Y.sK),l.Y36(B.Br),l.Y36(B.HT),l.Y36(m.z),l.Y36(C.F0),l.Y36(ie.Ye))};static \u0275cmp=l.Xpm({type:Te,selectors:[["ng-component"]],decls:28,vars:9,consts:[[1,"signin-page","ion-padding"],["item-left",""],["src","assets/images/icons/branding/AppIcon_128x128.png"],[3,"ngModel","ngModelChange"],["value","signin"],["value","register"],[4,"ngIf"],["slot","secondary"],[3,"click"],["name","close","slot","start"],["slot","primary"],["type","submit","color","primary",3,"click"],["name","log-in","slot","start"],[1,"ion-padding"],["position","floating"],["type","text",3,"ngModel","ngModelChange"],["type","password",3,"ngModel","ngModelChange"]],template:function(nt,Ce){1&nt&&(l.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),l._uU(3),l.ALo(4,"translate"),l.qZA()()(),l.TgZ(5,"ion-content",0)(6,"ion-avatar",1),l._UZ(7,"img",2),l.qZA(),l.TgZ(8,"ion-segment",3),l.NdJ("ngModelChange",function(xe){return Ce.mode=xe}),l.TgZ(9,"ion-segment-button",4)(10,"ion-label"),l._uU(11,"Sign In"),l.qZA()(),l.TgZ(12,"ion-segment-button",5)(13,"ion-label"),l._uU(14,"Create Account"),l.qZA()()(),l.YNc(15,Pe,15,2,"ng-container",6)(16,K,20,4,"ng-container",6),l.qZA(),l.TgZ(17,"ion-footer")(18,"ion-toolbar")(19,"ion-buttons",7)(20,"ion-button",8),l.NdJ("click",function(){return Ce.cancelSignIn()}),l._UZ(21,"ion-icon",9),l._uU(22," Cancel"),l.qZA()(),l.TgZ(23,"ion-buttons",10)(24,"ion-button",11),l.NdJ("click",function(){return Ce.performSignIn()}),l._UZ(25,"ion-icon",12),l._uU(26),l.ALo(27,"translate"),l.qZA()()()()),2&nt&&(l.xp6(3),l.hij(" ",l.lcZ(4,5,"ocm.general.signIn")," "),l.xp6(5),l.Q6J("ngModel",Ce.mode),l.xp6(7),l.Q6J("ngIf","signin"==Ce.mode),l.xp6(),l.Q6J("ngIf","register"==Ce.mode),l.xp6(10),l.hij(" ",l.lcZ(27,7,"ocm.general.signIn"),""))},dependencies:[ie.O5,fe.JJ,fe.On,B.BJ,B.YG,B.Sm,B.W2,B.fr,B.Gu,B.gu,B.pK,B.Ie,B.Q$,B.q_,B.cJ,B.GO,B.wd,B.sr,B.QI,B.j9,Y.X$],encapsulation:2})}return Te})()},439:(Bn,Ct,P)=>{"use strict";P.d(Ct,{l:()=>ie});var h=P(5861),m=P(9127),te=P(9159),l=P(8371),B=P(9862),Y=P(553),C=P(9212);let ie=(()=>{class fe{http;refData;logging;serviceBase="https://api.openchargemap.io";serviceBaseURL=this.serviceBase+"/v4";hasAuthorizationError=!1;ATTRIBUTION_METADATAFIELDID=4;authResponse;clientName="ocm.api.default";authorizationErrorCallback;generalErrorCallback;allowMirror=!1;lastPOIApiCallURL="";constructor(K,be,Te){this.http=K,this.refData=be,this.logging=Te,this.serviceBaseURL=Y.N.apiBase+"/v3"}getNumberListString(K){let be="";for(let Te=0;Te<K.length;Te++)be+=K[Te],Te<K.length&&(be+=",");return be}fetchPOIListByParam(K){var be=this;return(0,h.Z)(function*(){const Te=be.serviceBaseURL+"/poi/?client="+be.clientName+(be.allowMirror?" &allowmirror=true":"")+"&verbose=false&output=json";K.compact=!0;let Me="";null!=K.countryCode&&(Me+="&countrycode="+K.countryCode),null!=K.latitude&&(Me+="&latitude="+K.latitude),null!=K.longitude&&(Me+="&longitude="+K.longitude),null!=K.distance&&(Me+="&distance="+K.distance),null!=K.distanceUnit&&(Me+="&distanceunit="+K.distanceUnit),null!=K.includeComments&&(Me+="&includecomments="+K.includeComments),null!=K.maxResults&&(Me+="&maxresults="+K.maxResults),null!=K.countryIdList&&(Me+="&countryid="+be.getNumberListString(K.countryIdList)),null!=K.levelIdList&&(Me+="&levelid="+be.getNumberListString(K.levelIdList)),null!=K.connectionTypeIdList&&K.connectionTypeIdList.length>0&&(Me+="&connectiontypeid="+be.getNumberListString(K.connectionTypeIdList)),null!=K.operatorIdList&&K.operatorIdList.length>0&&(Me+="&operatorid="+be.getNumberListString(K.operatorIdList)),null!=K.usageTypeIdList&&K.usageTypeIdList.length>0&&(Me+="&usagetypeid="+be.getNumberListString(K.usageTypeIdList)),null!=K.statusTypeIdList&&K.statusTypeIdList.length>0&&(Me+="&statustypeid="+be.getNumberListString(K.statusTypeIdList)),null!=K.locationTitle&&(Me+="&locationtitle="+K.locationTitle),null!=K.minPowerKW&&K.minPowerKW>0&&(Me+="&minpowerkw="+K.minPowerKW),null!=K.maxPowerKW&&K.maxPowerKW>0&&(Me+="&maxpowerkw="+K.maxPowerKW),null!=K.submissionStatusTypeIdList&&(Me+="&submissionstatustypeid="+be.getNumberListString(K.submissionStatusTypeIdList)),null!=K.poiIdList&&K.poiIdList.length>0&&(Me+="&chargepointid="+be.getNumberListString(K.poiIdList)),0==K.enableCaching&&(Me+="&enablecaching=false"),null!=K.compact&&(Me+="&compact="+K.compact),K.levelOfDetail>1&&(Me+="&levelofdetail="+K.levelOfDetail),null!=K.polyline&&(Me+="&polyline="+K.polyline),null!=K.boundingbox&&(Me+="&boundingbox="+K.boundingbox),null!=K.additionalParams&&(Me+="&"+K.additionalParams);const de=Te+Me;if(be.lastPOIApiCallURL===de&&0!=K.enableCaching)return be.logging.log("Skipped API call due to same query being repeated."),[];be.lastPOIApiCallURL=de,be.logging.log("API Call:"+de,m.i.VERBOSE);try{let nt=yield be.http.get(de,be.getHttpRequestOptions()).toPromise();return be.refData.hydrateCompactPOIList(nt)}catch(nt){const Ce=nt.message||"Could not fetch POI list from server.";throw be.logging.log("API Client: "+JSON.stringify(nt),m.i.ERROR),Ce}})()}getHttpRequestOptions(K=!0){let be=new B.WM;return K&&(be=be.append("Content-Type","application/json")),this.authResponse&&this.authResponse.Data&&this.authResponse.Data.access_token&&(be=be.append("Authorization","Bearer "+this.authResponse.Data.access_token)),be=be.append("X-API-Key",Y.N.apiKey),{headers:be}}fetchCoreReferenceData(K){let be=this.serviceBaseURL+"/referencedata/?client="+this.clientName+"&output=json"+(this.allowMirror?"&allowmirror=true":"")+"&verbose=false&compact=true";return null!=K&&null!=K.CountryIds&&(be+="&countryid="+this.getNumberListString(K.CountryIds)),this.logging.log("API Call:"+be,m.i.VERBOSE),this.http.get(be,this.getHttpRequestOptions())}performSignIn(K,be){return this.http.post(this.serviceBaseURL+"/profile/authenticate/",JSON.stringify({emailaddress:K,password:be}),this.getHttpRequestOptions()).toPromise().then(de=>(this.authResponse=de,this.authResponse))}performRegister(K,be,Te){return this.http.post(this.serviceBaseURL+"/profile/register/",JSON.stringify({username:K,emailaddress:be,password:Te}),this.getHttpRequestOptions()).toPromise().then(nt=>(this.authResponse=nt,this.authResponse))}performSubmission(K,be){return K===l.qO.POI?this.submitPOI(be):K===l.qO.Comment?this.submitUserComment(be):K===l.qO.Media?this.submitMediaItem(be):void 0}submitUserComment(K){const be=JSON.stringify(K);return this.logging.log("[api] Submitting user comment"),this.http.post(this.serviceBaseURL+"/comment/",be,this.getHttpRequestOptions()).toPromise()}submitMediaItem(K){const be=JSON.stringify(K);return this.http.post(this.serviceBaseURL+"/mediaitem/",be,this.getHttpRequestOptions()).toPromise()}submitPOI(K){const be=JSON.stringify(K);return this.http.post(this.serviceBaseURL+"/poi/",be,this.getHttpRequestOptions()).toPromise()}getPanoramioLocationPhotos(K){return new Promise(be=>{const Me="https://www.panoramio.com/map/get_panoramas.php?set=public&from=0&to=2&minx="+(K.longitude-.001)+"&miny="+(K.latitude-.001)+"&maxx="+(K.longitude+.001)+"maxy="+(K.latitude+.001)+"&size=medium&mapfilter=true&callback=?";return console.log(Me),this.http.get(Me).toPromise()})}fetchReverseGeocodeResult(K,be){return this.http.get(this.serviceBaseURL+"/geocode/?client="+this.clientName+"&output=json&camelcase=false&latitude="+K+"&longitude="+be,this.getHttpRequestOptions()).toPromise()}isLocalStorageAvailable(){return typeof window.localStorage<"u"}setCachedDataObject(K,be){this.isLocalStorageAvailable()&&(typeof be>"u"&&(be=null),null===be?localStorage.removeItem(K):localStorage.setItem(K,JSON.stringify(be)))}getCachedDataObject(K){if(this.isLocalStorageAvailable()){const be=localStorage.getItem(K);if(null!=be&&be.length>0)return JSON.parse(be)}return null}static \u0275fac=function(be){return new(be||fe)(C.LFG(B.eN),C.LFG(te.W),C.LFG(m.z))};static \u0275prov=C.Yz7({token:fe,factory:fe.\u0275fac,providedIn:"root"})}return fe})()},3294:(Bn,Ct,P)=>{"use strict";P.d(Ct,{c:()=>B});var h=P(5861),m=P(9127),te=P(9212),l=P(7346);let B=(()=>{class Y{logger;platform;isCordova=!1;ga=null;constructor(ie,fe){this.logger=ie,this.platform=fe,this.isCordova=!(!fe.is("cordova")&&!fe.is("capacitor"))}init(ie){var fe=this;return(0,h.Z)(function*(){fe.isCordova&&fe.ga?yield fe.ga.startTrackerWithId(ie):fe.logger.log("Could not initialise analytics")})()}setAppVersion(ie){var fe=this;return(0,h.Z)(function*(){if(fe.isCordova&&fe.ga)return fe.ga.setAppVersion(ie);fe.logger.log(ie)})()}appEvent(ie,fe){var Pe=this;return(0,h.Z)(function*(){if(Pe.isCordova&&Pe.ga)return Pe.ga.trackEvent(ie,fe);Pe.logger.log(fe)})()}viewEvent(ie){var fe=this;return(0,h.Z)(function*(){if(fe.isCordova&&fe.ga)return fe.ga.trackView(ie);fe.logger.log(ie)})()}static \u0275fac=function(fe){return new(fe||Y)(te.LFG(m.z),te.LFG(l.t4))};static \u0275prov=te.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"})}return Y})()},6470:(Bn,Ct,P)=>{"use strict";P.d(Ct,{c:()=>Ce});var h=P(5861),m=P(9127),te=P(439),l=P(8371),B=P(9212),Y=P(5957);let C=(()=>{class oe{events;isQueueProcessing;appManager;constructor(Ie){this.events=Ie,this.isQueueProcessing=!1}setAppManager(Ie){this.appManager=Ie}add(Ie,Ae){let ye=this.getQueueItems();ye.push(new l.aX(Ie,Ae)),this.saveQueueItems(ye)}update(Ie){let Ae=this.getQueueItems(),ye=new Array;return Ae.forEach(Ue=>{ye.push(Ue.ID==Ie.ID?Ie:Ue)}),ye}processNextQueueItem(){let Ie=this.getNextQueueItem();null!=Ie&&null!=this.appManager&&this.appManager.api.performSubmission(Ie.SubmissionType,Ie.Data).then(()=>{Ie.IsSubmitted=!0,Ie.Attempts++,this.update(Ie),this.clear()})}getNextQueueItem(){let Ie=this.getQueueItems(),Ae=null;return Ie.forEach(ye=>{null==Ae&&!ye.IsCancelled&&!ye.IsInProgress&&!ye.IsSubmitted&&(Ae=ye)}),Ae}hasPendingItems(){let Ie=!1;return this.getQueueItems().forEach(ye=>{!ye.IsFailure&&!ye.IsCancelled&&!ye.IsSubmitted&&(Ie=!0)}),Ie}isCompleted(){let Ie=this.getQueueItems(),Ae=!0;return Ie.forEach(ye=>{(ye.IsInProgress||ye.IsFailure)&&(Ae=!1)}),Ae}clear(Ie=!1){let Ae=this.getQueueItems(),ye=new Array;Ie||Ae.forEach(Ue=>{(Ue.IsInProgress||Ue.IsFailure)&&ye.push(Ue)}),this.saveQueueItems(ye)}saveQueueItems(Ie){localStorage.setItem("submissionQueue",JSON.stringify(Ie))}getQueueItems(){let Ie=localStorage.getItem("submissionQueue");return null!=Ie?JSON.parse(Ie):new Array}static \u0275fac=function(Ae){return new(Ae||oe)(B.LFG(Y.z))};static \u0275prov=B.Yz7({token:oe,factory:oe.\u0275fac,providedIn:"root"})}return oe})();var ie=P(9159),fe=P(989),Pe=P(3294),K=P(553),be=P(9862),Te=P(7346),Me=P(451),de=P(2618),nt=P(703);let Ce=(()=>{class oe{http;events;api;submissionQueue;platform;referenceDataManager;journeyManager;translateService;toastController;loadingController;jwtHelper;logging;analytics;enableSubmissionQueue;searchSettings;platformMode;journeys;isDebugMode;clientWidth;clientHeight;isRequestInProgress=!1;title="Open Charge Map";_isUserAuthenticated=null;isEmbeddedMode=!1;isOffline=!1;constructor(Ie,Ae,ye,Ue,ct,X,ve,me,Fe,De,ze,Ke,Ht){this.http=Ie,this.events=Ae,this.api=ye,this.submissionQueue=Ue,this.platform=ct,this.referenceDataManager=X,this.journeyManager=ve,this.translateService=me,this.toastController=Fe,this.loadingController=De,this.jwtHelper=ze,this.logging=Ke,this.analytics=Ht,this.api.clientName="ocm.app.ionic."+K.N.version,this.isDebugMode=!1,this.enableSubmissionQueue=!1,this.submissionQueue.setAppManager(this),this.platformMode=ct.is("cordova")?"cordova":"web",this.initAppManager(),this.searchSettings=new l.Nm,this.loadSearchSettings(),this.applyURLQueryStringOptions(),this.searchSettings.CheckForActiveFilters(),this.journeyManager.loadJourneys()}loadSearchSettings(){if(null!=localStorage.getItem("searchSettings")){this.searchSettings=new l.Nm;try{let Ie=JSON.parse(localStorage.getItem("searchSettings"));Object.assign(this.searchSettings,Ie)}catch{}}}savePushRegistration(Ie){localStorage.setItem("_pushToken",Ie.toString())}getPushRegistration(){localStorage.getItem("_pushToken")}getQueryVariable(Ie){let ye=window.location.search.substring(1).split("&");for(let Ue=0;Ue<ye.length;Ue++){let ct=ye[Ue].split("=");if(decodeURIComponent(ct[0])==Ie)return ct[1].split(",").map(me=>decodeURIComponent(me))}return null}applyURLQueryStringOptions(){if(this.getQueryVariable("mode")&&"embedded"==this.getQueryVariable("mode")[0]&&(this.isEmbeddedMode=!0),this.getQueryVariable("operatorid")){let Ie=this.getQueryVariable("operatorid");for(let Ae of Ie)this.searchSettings.OperatorList.unshift(parseInt(Ae,10))}if(this.getQueryVariable("latitude")&&this.getQueryVariable("longitude")){let Ie=this.getQueryVariable("latitude")[0],Ae=this.getQueryVariable("longitude")[0];this.searchSettings.StartSearchPosition=new l.wC(parseFloat(Ie),parseFloat(Ae))}this.getQueryVariable("title")&&(this.title=this.getQueryVariable("title")[0]),this.getQueryVariable("languagecode")&&this.setLanguage(this.getQueryVariable("languagecode")[0]),this.getQueryVariable("id")&&(this.searchSettings.StartViewPoiId=this.getQueryVariable("id")[0])}saveSearchSettings(){this.searchSettings.CheckForActiveFilters(),localStorage.setItem("searchSettings",JSON.stringify(this.searchSettings))}getLanguages(){return[{code:"ar",title:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629 / Arabic"},{code:"bg",title:"Bulgarian / \u0411\u044a\u043b\u0433\u0430\u0440\u0441\u043a\u0438"},{code:"cs",title:"Czech / \u010ce\u0161tina"},{code:"de",title:"German / Deutsch"},{code:"el",title:"Greek / \u0395\u03bb\u03bb\u03b7\u03bd\u03b9\u03ba\u03ae"},{code:"en",title:"English"},{code:"es",title:"Spanish / Espa\xf1ol"},{code:"et",title:"Estonian / Eesti"},{code:"fi",title:"Finnish / Suomi"},{code:"fr",title:"French / Fran\xe7ais"},{code:"fy",title:"West Frisian / Frysk"},{code:"hu",title:"Hungarian / Magyar"},{code:"it",title:"Italian / Italiano"},{code:"ja",title:"Japanese / \u65e5\u672c\u8a9e"},{code:"lt",title:"Lithuanian / Lietuvi\u0173"},{code:"nl",title:"Dutch / Nederlands"},{code:"pt",title:"Portuguese / portugu\xeas"},{code:"ro",title:"Romanian / Rom\xe2n\u0103"},{code:"ru",title:"Russian / P\u0443\u0441\u0441\u043a\u0438\u0439"},{code:"sk",title:"Slovak / Sloven\u010dina"},{code:"tr",title:"Turkish / T\xfcrk\xe7e"},{code:"zh",title:"Chinese / \u4e2d\u56fd\u7684"}]}setLanguage(Ie){(null==Ie||""==Ie)&&(Ie="en"),this.logging.log("Changing language: "+Ie),this.translateService.use(Ie)}initAppManager(){this.initAuthFromStorage(),this.isUserAuthenticated(!0)&&this.enableSubmissionQueue&&null!=this.submissionQueue&&this.submissionQueue.hasPendingItems()&&this.submissionQueue.processNextQueueItem()}initAuthFromStorage(){let Ie=localStorage.getItem("authResponse");if(null!=Ie){let Ae=JSON.parse(Ie);null!=Ae?.Data&&null!=Ae?.Data?.access_token?(this.jwtHelper.decodeToken(Ae.Data.access_token),this.jwtHelper.isTokenExpired(Ae.Data.access_token)?localStorage.removeItem("authResponse"):(this.api.authResponse=Ae,this.logging.log("User has valid auth token in local storage",m.i.VERBOSE))):(this.logging.log("User has invalid auth token in local storage",m.i.VERBOSE),localStorage.removeItem("authResponse"))}}isUserAuthenticated(Ie=!1){return!1===Ie&&null!=this._isUserAuthenticated||(this._isUserAuthenticated=!1,null!=this.api.authResponse&&(this.jwtHelper.isTokenExpired(this.api.authResponse.Data.access_token)||(this._isUserAuthenticated=!0))),this._isUserAuthenticated}getCurrentAuthToken(){return null!=this.api.authResponse?this.api.authResponse.Data.access_token:null}getUserProfile(){return null!=this.api.authResponse?this.api.authResponse.Data.UserProfile:null}signOutCurrentUser(){localStorage.removeItem("authResponse"),this.api.authResponse=null,this._isUserAuthenticated=!1}submitComment(Ie){if(!this.enableSubmissionQueue)return this.api.performSubmission(l.qO.Comment,Ie);this.submissionQueue.add(l.qO.Comment,Ie),this.submissionQueue.processNextQueueItem()}submitMediaItem(Ie){if(!this.enableSubmissionQueue)return this.api.performSubmission(l.qO.Media,Ie);this.submissionQueue.add(l.qO.Media,Ie),this.submissionQueue.processNextQueueItem()}submitPOI(Ie){if(!this.enableSubmissionQueue)return this.api.performSubmission(l.qO.POI,Ie);this.submissionQueue.add(l.qO.POI,Ie),this.submissionQueue.processNextQueueItem()}showToastNotification(Ie){var Ae=this;return(0,h.Z)(function*(){yield(yield Ae.toastController.create({message:Ie,duration:3e3})).present()})()}showLoadingProgress(Ie){var Ae=this;return(0,h.Z)(function*(){yield(yield Ae.loadingController.create({message:Ie})).present()})()}dismissLoadingProgress(){var Ie=this;return(0,h.Z)(function*(){return Ie.loadingController.dismiss()})()}launchOCMWebPage(Ie){this.isUserAuthenticated(!0)&&(-1===Ie.indexOf("?")&&(Ie+="?"),Ie+="&auth="+this.getCurrentAuthToken()),Ie="https://openchargemap.org/site"+Ie,window.open(Ie,"_system")}launchWebPage(Ie){window.open(Ie,"_system")}isPlatform(Ie){return this.platform.is(Ie)}static \u0275fac=function(Ae){return new(Ae||oe)(B.LFG(be.eN),B.LFG(Y.z),B.LFG(te.l),B.LFG(C),B.LFG(Te.t4),B.LFG(ie.W),B.LFG(fe.i),B.LFG(de.sK),B.LFG(Me.yF),B.LFG(Me.HT),B.LFG(nt.N0),B.LFG(m.z),B.LFG(Pe.c))};static \u0275prov=B.Yz7({token:oe,factory:oe.\u0275fac,providedIn:"root"})}return oe})()},5957:(Bn,Ct,P)=>{"use strict";P.d(Ct,{z:()=>m});var h=P(9212);let m=(()=>{class te{c=new Map;constructor(){}subscribe(B,...Y){let C=this.c.get(B);C||this.c.set(B,C=[]),C.push(...Y)}unsubscribe(B,Y){if(!Y)return this.c.delete(B);const C=this.c.get(B);if(!C)return!1;const ie=C.indexOf(Y);return!(ie<0||(C.splice(ie,1),0===C.length&&this.c.delete(B),0))}publish(B,...Y){const C=this.c.get(B);return C?C.map(ie=>{try{return ie(...Y)}catch(fe){return console.error(fe),null}}):null}static \u0275fac=function(Y){return new(Y||te)};static \u0275prov=h.Yz7({token:te,factory:te.\u0275fac,providedIn:"root"})}return te})()},989:(Bn,Ct,P)=>{"use strict";P.d(Ct,{i:()=>Y});var h=P(9127),m=P(439),te=P(4669),l=P(8371),B=P(9212);let Y=(()=>{class C{api;poiManager;logging;journeys;favourites;routePolyline;constructor(fe,Pe,K){this.api=fe,this.poiManager=Pe,this.logging=K,this.journeys=[],this.favourites=[]}loadJourneys(){let fe=localStorage.getItem("journeys");if(null!=fe&&(this.journeys=JSON.parse(fe)),null!=this.journeys)for(let Pe of this.journeys)this.fetchAllJourneyPOIDetails(Pe)}fetchAllJourneyPOIDetails(fe){this.logging.log("Journeys - fetching poi details for Journey "+fe.Title);let Pe=new l.be;Pe.poiIdList=[];for(let K of fe.Stages)for(let be of K.WayPoints)for(let Te of be.PoiIDs)Pe.poiIdList.push(Te);this.api.fetchPOIListByParam(Pe).then(K=>{for(let be of K)this.updateStoredPOI(be)})}updateStoredPOI(fe){if(this.journeys.forEach(Pe=>{Pe.Stages.forEach(K=>{K.WayPoints.forEach(be=>{be.PoiIDs.forEach(Te=>{if(Te==fe.ID)if(null==be.PoiList){be.PoiList=[];let Me=new l.Qp("charging",1);Me.Poi=fe,Me.PoiID=fe.ID,be.PoiList.push(Me)}else for(let Me of be.PoiList)Me.PoiID==fe.ID&&(Me.Poi=fe)})})})}),null!=this.favourites)for(let Pe of this.favourites)"charging"==Pe.Type&&Pe.PoiID==fe.ID&&(Pe.Poi=fe)}saveJourneys(){let fe=JSON.parse(JSON.stringify(this.journeys));for(let K of fe)for(const be of K.Stages)for(let Te of be.WayPoints)for(let Me of Te.PoiList)Me.Poi=null,Me.Photos=null;const Pe=JSON.stringify(fe);localStorage.setItem("journeys",Pe)}addJourney(fe,Pe){let K=new l.vw;K.Title="Stage 1",null!=Pe&&K.WayPoints.push(Pe),fe.Stages.push(K),this.journeys.push(fe)}deleteJourney(fe){this.journeys=this.journeys.filter(Pe=>Pe.ID!=fe),this.saveJourneys()}getJourney(fe){let Pe=this.journeys.filter(K=>K.ID==fe);return Pe.length>0?Pe[0]:null}getJourneyStages(fe){return this.getJourney(fe).Stages}addJourneyWaypoint(fe,Pe,K){let be=this.getJourney(fe);if(null==Pe){let Te=new l.vw;Te.Title="Stage "+(be.Stages.length+1),Te.WayPoints.push(K),be.Stages.push(Te)}else{let Te=be.Stages[Pe];null==Te.WayPoints&&(Te.WayPoints=[]),Te.WayPoints.push(K)}}addJourneyStage(fe,Pe){return this.getJourney(fe).Stages.push(Pe)-1}setupTestJourneys(){this.journeys=[];let fe=new l.fw;fe.Title="New York to Brooklyn",fe.Notes="A little jaunt to Brooklyn",fe.Stages=[];let Pe=new l.vw,K=new l.kA;K.Notes="Starting point",K.Position=new l.wC(40,1.2),K.Title="Start",Pe.WayPoints.push(K);let be=new l.kA;be.Notes="Middle point",be.Position=new l.wC(40,1.33),be.Title="Middle",Pe.WayPoints.push(be);let Te=new l.kA;Te.Notes="End point",Te.Position=new l.wC(40,1.33),Te.Title="End",Pe.WayPoints.push(Te),fe.Stages.push(Pe),this.journeys.push(fe);let Me=new l.fw;Me.Title="Aberdeen to London",Me.Notes="Roadtrip",Me.Stages=[],this.journeys.push(Me)}calculateEnergyConsumptionkWh(fe,Pe,K=0,be){return fe*be}setRoutePolyline(fe){this.routePolyline=fe}getRoutePolyline(){return this.routePolyline}static \u0275fac=function(Pe){return new(Pe||C)(B.LFG(m.l),B.LFG(te.R),B.LFG(h.z))};static \u0275prov=B.Yz7({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},9127:(Bn,Ct,P)=>{"use strict";P.d(Ct,{i:()=>te,z:()=>l});var h=P(553),m=P(9212),te=function(B){return B[B.VERBOSE=0]="VERBOSE",B[B.INFO=1]="INFO",B[B.WARNING=2]="WARNING",B[B.ERROR=3]="ERROR",B}(te||{});let l=(()=>{class B{logLevel;constructor(){this.logLevel=te.VERBOSE,h.N.production&&(this.logLevel=te.INFO)}log(C,ie=te.VERBOSE){console&&console.log&&ie>=this.logLevel&&console.log("["+te[ie]+"] {"+(new Date).toLocaleTimeString()+"} "+C)}static \u0275fac=function(ie){return new(ie||B)};static \u0275prov=m.Yz7({token:B,factory:B.\u0275fac,providedIn:"root"})}return B})()},4669:(Bn,Ct,P)=>{"use strict";P.d(Ct,{R:()=>C});var h=P(5861),m=P(9127),te=P(439),l=P(3294),B=P(9212),Y=P(5957);let C=(()=>{class ie{api;events;logging;analytics;poiList;isRequestInProgress=!1;constructor(Pe,K,be,Te){this.api=Pe,this.events=K,this.logging=be,this.analytics=Te}refreshPOIList(Pe){var K=this;return(0,h.Z)(function*(){try{return K.poiList=yield K.fetchPOIList(Pe),K.events.publish("ocm:poiList:updated"),K.analytics.appEvent("Search","Fetched Results"),K.poiList.length}catch{return 0}})()}fetchPOIList(Pe){var K=this;return(0,h.Z)(function*(){K.isRequestInProgress=!0;try{let be=yield K.api.fetchPOIListByParam(Pe);return K.isRequestInProgress=!1,be&&be.length&&K.logging.log("fetched POI list ["+be.length+"]"),be}catch{return K.isRequestInProgress=!1,[]}})()}clearResults(){this.poiList=[],this.events.publish("ocm:poiList:cleared"),this.logging.log("clearing results after settings change",m.i.VERBOSE)}getPOIById(Pe,K=!1,be=!1){var Te=this;return(0,h.Z)(function*(){if(!be&&null!=Te.poiList){const nt=Te.poiList.find(Ce=>Ce.ID==Pe);if(nt)return nt}const Me={poiIdList:[Pe],enableCaching:!be,includeComments:!0},de=yield Te.api.fetchPOIListByParam(Me);return de&&de.length>0?(Te.poiList&&de[0].ID==Pe&&(Te.poiList=Te.poiList.filter(nt=>nt.ID!=Pe),Te.poiList.push(de[0]),Te.logging.log("POI refreshed in cache "+Pe)),de[0]):null})()}static \u0275fac=function(K){return new(K||ie)(B.LFG(te.l),B.LFG(Y.z),B.LFG(m.z),B.LFG(l.c))};static \u0275prov=B.Yz7({token:ie,factory:ie.\u0275fac,providedIn:"root"})}return ie})()},9159:(Bn,Ct,P)=>{"use strict";P.d(Ct,{W:()=>B});var h=P(5861),m=P(9127),te=P(9212),l=P(9862);let B=(()=>{class Y{http;logging;referenceData;filteredReferenceData;constructor(ie,fe){this.http=ie,this.logging=fe,this.loadCachedRefData()}refreshReferenceData(ie){var fe=this;return(0,h.Z)(function*(){try{const Pe=yield ie.fetchCoreReferenceData(null).toPromise();return fe.setCoreReferenceData(Pe),fe.setFilteredReferenceData(Pe),fe.logging.log("Got refreshed core ref data.",m.i.VERBOSE),fe.sortCoreReferenceData(),fe.cacheCurrentRefData(),!0}catch(Pe){return fe.logging.log("Error fetching core ref data:"+Pe),!1}})()}refreshFilteredReferenceData(ie,fe){ie.fetchCoreReferenceData(fe).subscribe(Pe=>{this.setFilteredReferenceData(Pe),this.sortCoreReferenceData(),this.logging.log("Got refreshed filtered reference data.",m.i.VERBOSE)},Pe=>{this.logging.log("Error fetching filtered reference data:"+Pe)})}setCoreReferenceData(ie){this.referenceData=ie}setFilteredReferenceData(ie){this.filteredReferenceData=ie}referenceDataLoaded(){return null!=this.referenceData}getCountries(ie=!1){return 1==ie?this.filteredReferenceData.Countries:this.referenceData.Countries}getCountryByID(ie){return this.getRefDataByID(this.referenceData.Countries,ie)}getConnectionTypes(ie=!1){return 1==ie?this.filteredReferenceData.ConnectionTypes:this.referenceData.ConnectionTypes}getConnectionTypeByID(ie){return this.getRefDataByID(this.referenceData.ConnectionTypes,ie)}getUsageTypes(ie=!1){return 1==ie?this.filteredReferenceData.UsageTypes:this.referenceData.UsageTypes.filter(fe=>fe.ID>0)}getUsageTypeByID(ie){return this.getRefDataByID(this.referenceData.UsageTypes,ie)}getStatusTypes(ie=!1){return 1==ie?this.filteredReferenceData.StatusTypes:this.referenceData.StatusTypes.filter(fe=>fe.ID>0)}getStatusTypeByID(ie){return this.getRefDataByID(this.referenceData.StatusTypes,ie)}getNetworkOperators(ie=!1){return 1==ie?this.filteredReferenceData.Operators:this.referenceData.Operators}getNetworkOperatorByID(ie){return this.getRefDataByID(this.referenceData.Operators,ie)}getDataProviders(ie=!1){return 1==ie?this.filteredReferenceData.DataProviders:this.referenceData.DataProviders}getDataProviderByID(ie){return this.getRefDataByID(this.referenceData.DataProviders,ie)}getCheckinStatusTypes(ie=!1,fe=!0){let Pe=null;return Pe=1==ie?this.filteredReferenceData.CheckinStatusTypes:this.referenceData.CheckinStatusTypes,fe&&(Pe=Pe.filter(K=>!1===K.IsAutomatedCheckin)),Pe}getCheckinStatusTypeByID(ie){return this.getRefDataByID(this.referenceData.CheckinStatusTypes,ie)}getCommentTypes(ie=!1,fe=!0){let Pe;return Pe=1==ie?this.filteredReferenceData.UserCommentTypes:this.referenceData.UserCommentTypes,fe&&(Pe=Pe.filter(K=>100!==K.ID&&110!==K.ID)),Pe}getCommentTypeByID(ie){return this.getRefDataByID(this.referenceData.UserCommentTypes,ie)}getSubmissionStatusTypes(ie=!1){return 1==ie?this.filteredReferenceData.SubmissionStatusTypes:this.referenceData.SubmissionStatusTypes}getSubmissionStatusTypesByID(ie){return this.getRefDataByID(this.referenceData.SubmissionStatusTypes,ie)}getChargingLevelTypes(ie=!1){return 1==ie?this.filteredReferenceData.ChargerTypes:this.referenceData.ChargerTypes}getChargingLevelTypeByID(ie){return this.getRefDataByID(this.referenceData.ChargerTypes,ie)}getOutputCurrentTypes(ie=!1){return ie?this.referenceData.CurrentTypes:this.filteredReferenceData.CurrentTypes}getOutputCurrentTypeByID(ie){return this.getRefDataByID(this.referenceData.CurrentTypes,ie)}loadCachedRefData(){const ie=localStorage.getItem("referenceData");if(null==ie)this.http.get("./assets/data/CoreReferenceData.json").subscribe(fe=>{this.logging.log("Using bundled reference data as cached ref data."),this.setCoreReferenceData(fe),this.setFilteredReferenceData(fe)});else{let fe=JSON.parse(ie);this.setCoreReferenceData(fe)}this.setFilteredReferenceData(this.referenceData)}cacheCurrentRefData(){null!=this.referenceData&&(this.referenceData.CacheDate=new Date,localStorage.setItem("referenceData",JSON.stringify(this.referenceData)))}getRefDataByID(ie,fe){if(""!==fe&&(fe=parseInt(fe,10)),null!=ie)for(let Pe=0;Pe<ie.length;Pe++)if(ie[Pe].ID===fe)return ie[Pe];return null}sortCoreReferenceData(){this.sortReferenceData(this.referenceData.ConnectionTypes),this.sortReferenceData(this.referenceData.Countries),this.sortReferenceData(this.referenceData.Operators),this.sortReferenceData(this.referenceData.DataProviders),this.sortReferenceData(this.referenceData.UsageTypes),this.sortReferenceData(this.referenceData.StatusTypes),this.sortReferenceData(this.referenceData.CheckinStatusTypes),this.sortReferenceData(this.referenceData.SubmissionStatusTypes),this.filteredReferenceData&&(this.sortReferenceData(this.filteredReferenceData.ConnectionTypes),this.sortReferenceData(this.filteredReferenceData.Operators))}sortReferenceData(ie){ie.sort(this.sortListByTitle)}sortListByTitle(ie,fe){return ie.Title<fe.Title?-1:ie.Title>fe.Title?1:0}getMetadataValueByMetadataFieldID(ie,fe){if(""!==fe&&(fe=parseInt(fe,10)),null!=ie)for(let Pe=0;Pe<ie.length;Pe++)if(ie[Pe].ID===fe)return ie[Pe];return null}hydrateCompactPOI(ie,fe=!1){const Pe=this;if(null!=ie.DataProviderID&&(fe||null==ie.DataProvider)&&(ie.DataProvider=Pe.getDataProviderByID(ie.DataProviderID)),null!=ie.OperatorID&&(fe||null==ie.OperatorInfo)&&(ie.OperatorInfo=Pe.getNetworkOperatorByID(ie.OperatorID)),null!=ie.UsageTypeID&&(fe||null==ie.UsageType)&&(ie.UsageType=Pe.getUsageTypeByID(ie.UsageTypeID)),null!=ie.AddressInfo.CountryID&&(fe||null==ie.AddressInfo.Country)&&(ie.AddressInfo.Country=Pe.getCountryByID(ie.AddressInfo.CountryID)),null!=ie.StatusTypeID&&(fe||null==ie.StatusType)&&(ie.StatusType=Pe.getStatusTypeByID(ie.StatusTypeID)),null!=ie.SubmissionStatusTypeID&&(fe||null==ie.SubmissionStatusType)&&(ie.SubmissionStatusType=Pe.getSubmissionStatusTypesByID(ie.SubmissionStatusTypeID)),null!=ie.Connections)for(let K=0;K<ie.Connections.length;K++){const be=ie.Connections[K];null!=be.ConnectionTypeID&&(fe||null==be.ConnectionType)&&(be.ConnectionType=Pe.getConnectionTypeByID(be.ConnectionTypeID)),null!=be.LevelID&&(fe||null==be.Level)&&(be.Level=Pe.getChargingLevelTypeByID(be.LevelID)),null!=be.CurrentTypeID&&(fe||null==be.CurrentType)&&(be.CurrentType=Pe.getOutputCurrentTypeByID(be.CurrentTypeID)),null!=be.StatusTypeID&&(fe||null==be.StatusType)&&(be.StatusType=Pe.getStatusTypeByID(be.StatusTypeID)),ie.Connections[K]=be}if(null!=ie.UserComments)for(let K=0;K<ie.UserComments.length;K++){const be=ie.UserComments[K];null!=be.CommentTypeID&&(fe||null==be.CommentType)&&(be.CommentType=Pe.getCommentTypeByID(be.CommentTypeID)),null!=be.CheckinStatusTypeID&&(fe||null==be.CheckinStatusType)&&(be.CheckinStatusType=Pe.getCheckinStatusTypeByID(be.CheckinStatusTypeID)),ie.UserComments[K]=be}return ie}hydrateCompactPOIList(ie){for(let fe=0;fe<ie.length;fe++)ie[fe]=this.hydrateCompactPOI(ie[fe]);return ie}static \u0275fac=function(fe){return new(fe||Y)(te.LFG(l.eN),te.LFG(m.z))};static \u0275prov=te.Yz7({token:Y,factory:Y.\u0275fac,providedIn:"root"})}return Y})()},1847:(Bn,Ct,P)=>{"use strict";P.d(Ct,{v:()=>nt});var h=P(9903),m=P(3955),te=P(866),l=P(9127),B=P(5861),Y=P(5592),C=P(3052),ie=P(553),fe=P(8371);class Pe{events;logging;mapAPIType;mapReady;providerError;mapCanvasID;map;markerList;polylinePath;mapkitUtils;constructor(oe,xe){this.events=oe,this.logging=xe,this.events=oe,this.mapAPIType=m.b.MAPKIT_JS,this.mapReady=!1,this.markerList=new Map,this.mapkitUtils=new K}initAPI(){mapkit&&mapkit.init({authorizationCallback:function(oe){oe(ie.N.mapKitToken)}})}disposeMap(){}initMap(oe,xe,Ie){this.mapCanvasID=oe;let Ae=!0;if(Ae=!(typeof mapkit>"u"),!Ae)return this.logging.log("Call to initMap before API is ready:"+m.b[this.mapAPIType],l.i.ERROR),this.mapReady=!1,!1;this.initAPI(),null==this.map&&(document.getElementById(oe),this.map=new mapkit.Map(oe),this.map.annotationForCluster=function(Ue){"poi"===Ue.clusteringIdentifier&&(Ue.title="Charging Location",Ue.subtitle=Ue.memberAnnotations.reduce((ct,X)=>ct+X.population,0))},this.mapReady=!0,mapkit.addEventListener("configuration-change",Ue=>{this.events.publish("ocm:mapping:ready")}),this.map.addEventListener("scroll-end",Ue=>{this.events.publish("ocm:mapping:dragend")}),this.map.addEventListener("zoom-end",Ue=>{this.events.publish("ocm:mapping:zoom")}))}clearMarkers(){null!=this.markerList&&this.markerList.forEach((oe,xe)=>{try{this.map.removeAnnotation(xe)}catch{}}),this.markerList=new Map}showPOIListOnMap(oe,xe){let Ue=0,X=0==this.markerList.size;if(null!=oe){let me=[];for(let Fe=0;Fe<oe.length;Fe++)if(null!=oe[Fe].AddressInfo&&null!=oe[Fe].AddressInfo.Latitude&&null!=oe[Fe].AddressInfo.Longitude){let De=oe[Fe],ze=!0;if(null!=this.markerList&&this.markerList.has(De.ID)&&(ze=!1),ze){let Ke=null;Ke=te.c.getIconForPOI(De);let Ut="OCM-"+De.ID+": "+De.AddressInfo.Title+":";null!=De.UsageType&&(Ut+=" "+De.UsageType.Title),null!=De.StatusType&&(Ut+=" "+De.StatusType.Title);const We=new mapkit.Coordinate(De.AddressInfo.Latitude,De.AddressInfo.Longitude);let Ne=new mapkit.ImageAnnotation(We,{title:Ut,size:{width:34,height:50},url:{1:Ke},clusteringIdentifier:"poi"});Ne.poi=De,Ne.addEventListener("select",ke=>{const it=ke.target.poi;this.events.publish("ocm:poi:selected",{poi:it,poiId:it.ID})}),this.markerList.set(De.ID,Ne),me.push(Ne),Ue++}}me.length>0&&(this.map.addAnnotations(me),X&&this.map.showItems(me,{animate:!0,padding:new mapkit.Padding(60,25,60,25)})),this.logging.log(Ue+" new map markers added out of a total "+this.markerList.size)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapKit: refreshMapLayout",l.i.VERBOSE)},200)}setMapCenter(oe,xe){this.map&&(this.map.setCenterAnimated(new mapkit.Coordinate(oe.coords.latitude,oe.coords.longitude),!1),xe&&this.setMapZoom(xe))}getMapCenter(){return new Y.y(xe=>{if(null!=this.map){let Ie=this.map.center;null!=Ie&&(xe.next(new C.jR(Ie.latitude,Ie.longitude)),xe.complete())}})}setMapZoom(oe){const xe=Math.min(oe,28),Ie=this.mapkitUtils.deltaFromZoomLevel(this.map,this.map.center,Math.round(xe)),Ae=new mapkit.CoordinateSpan(111*Ie.latitudeDelta,111*Ie.longitudeDelta),ye=new mapkit.CoordinateRegion(this.map.center,Ae);this.map.setRegionAnimated(ye)}getMapZoom(){return new Y.y(xe=>{this.logging.log("MapKit: getMapZoom not supported",l.i.VERBOSE),xe.next(this.map._impl.zoomLevel),xe.complete()})}setMapType(oe){this.logging.log("MapKit: skipped setting Map Type :"+oe)}getMapBounds(){return new Y.y(xe=>{let Ie=new Array,Ae=this.map.region.toBoundingRegion();Ie.push(new C.wC(Ae.southLatitude,Ae.westLongitude)),Ie.push(new C.wC(Ae.northLatitude,Ae.eastLongitude)),xe.next(Ie),xe.complete()})}moveToMapBounds(oe){this.logging.log("MapKit: map bounds not implemented")}renderMap(oe,xe,Ie){return document.getElementById(this.mapCanvasID).style.height=xe+"px",this.mapReady&&this.showPOIListOnMap(oe,Ie),!0}renderPolyline(oe){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(oe){return(0,B.Z)(function*(){let xe=new mapkit.Search({getsUserLocation:!0});return new Promise(function(){var Ie=(0,B.Z)(function*(Ae,ye){let Ue=[];xe.search(oe,function(){var ct=(0,B.Z)(function*(X,ve){X&&ye(X),Ue=[],ve.places.map(me=>{let Fe=new fe.nS;Fe.Title=me.name,Fe.Address=me.formattedAddress,Fe.Type="place",Fe.Location=new C.wC(me.coordinate.latitude,me.coordinate.longitude),Ue.push(Fe)}),Ae(Ue)});return function(X,ve){return ct.apply(this,arguments)}}())});return function(Ae,ye){return Ie.apply(this,arguments)}}())})()}addPOILayer(oe){this.logging.log("Add POI Layer not implemented in this provider.")}}class K{mercatorRadius=85445659.44705395;mercatorOffset=268435456;longitudeToPixelSpaceX(oe){return Math.round(this.mercatorOffset+this.mercatorRadius*oe*Math.PI/180)}latitudeToPixelSpaceY(oe){return Math.round(this.mercatorOffset-this.mercatorRadius*Math.log((1+Math.sin(oe*Math.PI/180))/(1-Math.sin(oe*Math.PI/180)))/2)}pixelSpaceXToLongitude(oe){return(Math.round(oe)-this.mercatorOffset)/this.mercatorRadius*180/Math.PI}pixelSpaceYToLatitude(oe){return 180*(Math.PI/2-2*Math.atan(Math.exp((Math.round(oe)-this.mercatorOffset)/this.mercatorRadius)))/Math.PI}deltaFromZoomLevel(oe,xe,Ie){let Ae=this.longitudeToPixelSpaceX(xe.longitude),ye=this.latitudeToPixelSpaceY(xe.latitude),ct=Math.pow(2,20-Ie),X=oe.visibleMapRect.size,ve=X.width*ct,me=X.height*ct,Fe=Ae-ve/2,De=ye-me/2,ze=this.pixelSpaceXToLongitude(Fe),Ht=this.pixelSpaceXToLongitude(Fe+ve)-ze,dn=this.pixelSpaceYToLatitude(De);return{latitudeDelta:-1*(this.pixelSpaceYToLatitude(De+me)-dn),longitudeDelta:Ht}}}var be=P(9212),Te=P(5957),Me=P(9862);let de=(()=>{class Ce extends h.k{constructor(xe,Ie,Ae){super(xe,Ie,Ae),this.mapAPIType=m.b.MAPTILER,this.mapTileSet="https://maps.tilehosting.com/styles/streets/style.json?key=Gs9z7krALe3CGI60d5cL"}initAPI(){}static \u0275fac=function(Ie){return new(Ie||Ce)(be.LFG(Te.z),be.LFG(l.z),be.LFG(Me.eN))};static \u0275prov=be.Yz7({token:Ce,factory:Ce.\u0275fac})}return Ce})(),nt=(()=>{class Ce{logging;http;map;mapCentreMarker;mapsInitialised;mapAPIReady;mapOptions;searchMarker;errorMessage;parentAppContext;mapProvider;debouncedMapPositionUpdate;events;isFocused=!1;constructor(xe,Ie,Ae){this.logging=Ie,this.http=Ae,this.events=xe,this.mapOptions=new m._,this.mapAPIReady=!1,this.mapsInitialised=!1,this.setMapAPI(this.mapOptions.mapAPI);let ye=this;this.debouncedMapPositionUpdate=te.c.debounce(()=>{this.logging.log("signaling map position change:"),ye.mapProvider.mapReady&&ye.getMapCenter().subscribe(Ue=>{null!=Ue?(this.logging.log("Map centre/zoom changed, updating search position:"+Ue),this.updateMapCentrePos(Ue.coords.latitude,Ue.coords.longitude,!1)):this.logging.log("Map centre/zoom changed - map not ready to change centre pos:")})},300,!1)}setParentAppContext(xe){this.parentAppContext=xe}setMapAPI(xe){this.mapOptions.mapAPI=xe,this.mapOptions.mapAPI==m.b.MAPBOX&&(this.mapProvider=new h.k(this.events,this.logging,this.http)),this.mapOptions.mapAPI==m.b.MAPKIT_JS&&(this.mapProvider=new Pe(this.events,this.logging)),this.mapOptions.mapAPI==m.b.MAPTILER&&(this.mapProvider=new de(this.events,this.logging,this.http))}isMapReady(){return null!=this.mapProvider&&this.mapProvider.mapReady}externalAPILoaded(xe){this.mapAPIReady=!0,this.logging.log("Mapping API Loaded: "+m.b[xe])}initMap(xe){if(!this.isMapReady())if(null!=this.mapProvider)this.mapsInitialised&&this.logging.log("initMap: Map provider already initialised"),this.logging.log("Mapping Manager: Init "+m.b[this.mapProvider.mapAPIType]),this.mapProvider.initMap(xe,this.mapOptions,this);else{if(this.mapsInitialised)return void this.logging.log("initMap: map already initialised");this.logging.log("initMap: "+this.mapOptions.mapAPI)}}mapManipulationPerformed(xe){this.logging.log("map manipulated:"+xe),("drag"==xe||"zoom"==xe)&&this.debouncedMapPositionUpdate()}updateMapSize(){this.mapProvider&&this.mapProvider.refreshMapLayout()}updateMapCentrePos(xe,Ie,Ae,ye){Ae&&null!=this.mapProvider&&this.mapProvider.setMapCenter(new C.jR(xe,Ie),ye),this.mapOptions.mapCentre=new C.jR(xe,Ie)}moveToMapBounds(xe){this.mapProvider.moveToMapBounds(xe)}refreshMapView(xe,Ie,Ae){return null!=this.mapProvider?(this.logging.log("Mapping Manager: renderMap "+m.b[this.mapProvider.mapAPIType]),this.isMapReady()?this.mapProvider.renderMap(Ie,xe,this.parentAppContext):this.logging.log("refreshMapView: map provider not initialised..")):this.logging.log("Unsupported Map API: refreshMapView",l.i.ERROR),!0}setMapType(xe){this.mapOptions.mapType!=xe&&(this.mapOptions.mapType=xe,this.isMapReady()&&null!=this.mapProvider?(this.logging.log("Changing map type:"+xe),this.mapProvider.setMapType(xe)):this.logging.log("Map type set, maps not initialised yet."))}unfocusMap(){this.logging.log("[mapping] Unfocus Map."),this.isFocused=!1,this.mapProvider.unfocusMap()}focusMap(){this.logging.log("[mapping] Focus Map."),this.isFocused=!0,this.mapProvider.focusMap()}getMapBounds(){return this.mapProvider.getMapBounds()}getMapZoom(){return this.mapProvider.getMapZoom()}setMapZoom(xe){this.mapProvider.setMapZoom(xe)}getMapCenter(){return this.mapProvider.getMapCenter()}showPOIOnStaticMap(xe,Ie,Ae=!1,ye=!1,Ue=200,ct=200){let X=document.getElementById(xe);if(null!=X){let me=Ie.AddressInfo.Latitude,Fe=Ie.AddressInfo.Longitude;Ue>640&&(Ue=640),ct>640&&(ct=640);let De=Ue,ze=ct,Ke="https://maps.googleapis.com/maps/api/staticmap?center="+me+","+Fe+"&zoom=14&size="+De+"x"+ze+"&maptype=roadmap&markers=color:blue%7Clabel:A%7C"+me+","+Fe+"&sensor=false",Ht="";Ht+=1==Ae?"<div>"+te.c.formatMapLink(Ie,'<div><img width="'+De+'" height="'+ze+'" src="'+Ke+'" /></div>',ye)+"</div>":'<div><img width="'+De+'" height="'+ze+'" src="'+Ke+'" /></div>',X.innerHTML=Ht}}renderPolyline(xe){this.mapProvider.renderPolyline(xe)}clearPolyline(){this.mapProvider.clearPolyline()}clearMarkers(){this.logging.log("mapping: clearing markers"),this.mapProvider.clearMarkers()}addPOILayer(xe){this.mapProvider.addPOILayer(xe)}static \u0275fac=function(Ie){return new(Ie||Ce)(be.LFG(Te.z),be.LFG(l.z),be.LFG(Me.eN))};static \u0275prov=be.Yz7({token:Ce,factory:Ce.\u0275fac,providedIn:"root"})}return Ce})()},3955:(Bn,Ct,P)=>{"use strict";P.d(Ct,{_:()=>te,b:()=>m});var h=P(553),m=function(l){return l[l.GOOGLE_WEB=1]="GOOGLE_WEB",l[l.GOOGLE_NATIVE=2]="GOOGLE_NATIVE",l[l.LEAFLET=3]="LEAFLET",l[l.MAPBOX=4]="MAPBOX",l[l.MAPKIT_JS=5]="MAPKIT_JS",l[l.MAPTILER=6]="MAPTILER",l}(m||{});class te{enableClustering;resultBatchID;useMarkerIcons;useMarkerAnimation;enableTrackingMapCentre;enableSearchByWatchingLocation;mapCentre;searchDistanceKM;iconSet;mapAPI;mapMoveQueryRefreshMS;requestSearchUpdate;enableSearchRadiusIndicator;mapType;minZoomLevel;onMapMoveCompleted;constructor(){this.enableClustering=!1,this.resultBatchID=-1,this.useMarkerIcons=!0,this.useMarkerAnimation=!0,this.enableTrackingMapCentre=!1,this.enableSearchByWatchingLocation=!1,this.mapCentre=null,this.mapAPI=h.N.defaultMapProvider,this.mapType="ROADMAP",this.searchDistanceKM=1e5,this.mapMoveQueryRefreshMS=300,this.enableSearchRadiusIndicator=!1,this.minZoomLevel=2}}},9903:(Bn,Ct,P)=>{"use strict";P.d(Ct,{k:()=>de});var h=P(5861),m=P(866),te=P(3955),l=P(5592),B=P(3052),Y=P(9127),C=P(2574),fe=P(553),Pe=P(8371),K=P(9212),be=P(5957),Te=P(9862);let de=(()=>{class nt{events;logging;http;mapAPIType;mapReady;providerError;mapCanvasID;map;markerList;polylinePath;_isMapAnimating=!1;searchMarker;mapTileSet;constructor(oe,xe,Ie){this.events=oe,this.logging=xe,this.http=Ie,this.events=oe,this.mapAPIType=te.b.MAPBOX,this.mapReady=!1,this.markerList=new Map}initAPI(){C&&Object.getOwnPropertyDescriptor(C,"accessToken").set(fe.N.mapBoxToken)}disposeMap(){this.map&&(this.logging.log("Disposing map",Y.i.INFO),this.map.remove())}getCurrentMapTileSet(oe){return"SATELLITE"==oe?"mapbox://styles/mapbox/satellite-streets-v12?optimize=true":"mapbox://styles/mapbox/streets-v12?optimize=true"}flyAroundPoint(oe){if(this._isMapAnimating){this.map.rotateTo(oe/100%360,{duration:0});const xe=this;requestAnimationFrame(function(Ie){xe.flyAroundPoint(Ie)})}}initMap(oe,xe,Ie){this.mapCanvasID=oe;let Ae=!0;if(Ae=!(typeof C>"u"),!Ae)return this.logging.log("Call to initMap before API is ready:"+te.b[this.mapAPIType],Y.i.ERROR),this.mapReady=!1,!1;if(null==this.map){let X=function(me){return me*(2-me)};document.getElementById(oe),this.initAPI(),this.map=new C.Map({container:oe,style:this.getCurrentMapTileSet(xe.mapType),zoom:15,attributionControl:!1}),this.map.addControl(new C.AttributionControl({compact:!0,customAttribution:["Open Charge Map Contributors"]})),this.map.addControl(new C.NavigationControl),this.mapReady=!0,this.map.getCanvas().focus();let Ue=100,ct=25;this.map.getCanvas().addEventListener("keydown",me=>{me.preventDefault(),38===me.which?this.map.panBy([0,-Ue],{easing:X}):40===me.which?this.map.panBy([0,Ue],{easing:X}):37===me.which?this.map.easeTo({bearing:this.map.getBearing()-ct,easing:X}):39===me.which?this.map.easeTo({bearing:this.map.getBearing()+ct,easing:X}):32===me.which&&(this._isMapAnimating?this._isMapAnimating=!1:(this._isMapAnimating=!0,this.flyAroundPoint(0)))},!0),this.map.on("load",()=>{this.events.publish("ocm:mapping:ready")});let ve=m.c.debounce(()=>{this.getMapCenter().subscribe(me=>{this.searchMarker.setLngLat(new C.LngLat(me.coords.longitude,me.coords.latitude))})},500,!1);this.map.on("move",()=>{this.searchMarker&&ve()}),this.map.on("moveend",()=>{this.events.publish("ocm:mapping:dragend"),xe.onMapMoveCompleted&&xe.onMapMoveCompleted()}),this.map.on("zoomend",()=>{this.events.publish("ocm:mapping:zoom")})}}clearMarkers(){null!=this.markerList&&this.markerList.forEach((oe,xe)=>{oe.remove()}),this.markerList=new Map}showPOIListOnMap(oe,xe,Ie=!0){let ye=this.map,Ue=new C.LngLatBounds,ct=0;if(ye.getZoom(),null!=oe){for(let De=0;De<oe.length;De++)if(null!=oe[De].AddressInfo&&null!=oe[De].AddressInfo.Latitude&&null!=oe[De].AddressInfo.Longitude){let ze=oe[De],Ke=!0;if(null!=this.markerList&&this.markerList.has(ze.ID)){Ke=!1;let Ht=this.markerList.get(ze.ID);Ht&&Ht.poi&&Ht.poi.DateLastStatusUpdate!=ze.DateLastStatusUpdate&&(Ht.remove(),Ke=!0)}if(Ke){let Ht=null,dn=null;Ie?(Ht=document.createElement("img"),Ht.src=m.c.getIconForPOI(ze),Ht.width=34,Ht.height=50):(Ht=null,dn=m.c.getColorForPOI(ze));let Ut=(Ie?"OCM-":"EXT-")+ze.ID+": "+ze.AddressInfo.Title+":";null!=ze.UsageType&&(Ut+=" "+ze.UsageType.Title),null!=ze.StatusType&&(Ut+=" "+ze.StatusType.Title);let We=new C.Marker({element:Ht,color:dn,anchor:"bottom"}).setLngLat([ze.AddressInfo.Longitude,ze.AddressInfo.Latitude]).addTo(ye);We.poi=ze;let Ne=We.getElement();Ne.poi=ze,Ne.addEventListener("click",ke=>{const it=ke.currentTarget.poi;this.events.publish("ocm:poi:selected",{poiId:it.ID,poi:it})}),Ue.extend(We.getLngLat()),this.markerList.set(ze.ID,We),ct++}}this.logging.log(ct+" new map markers added out of a total "+this.markerList.size)}if(null!=oe&&oe.length>0)if(null==xe||xe.appConfig.enableLiveMapQuerying)null==ye.getCenter()&&ye.setCenter(Ue.getCenter());else{this.logging.log("Fitting to marker bounds:"+Ue),ye.setCenter(Ue.getCenter()),this.logging.log("zoom before fit bounds:"+ye.getZoom()),ye.fitBounds(Ue);let Fe=ye.getZoom();ye.setZoom(Fe<6?6:Fe)}}refreshMapLayout(){null!=this.map&&setTimeout(()=>{this.logging.log("MapBoxGL: refreshMapLayout",Y.i.VERBOSE),this.map.resize()},200)}setMapCenter(oe){this.mapReady&&(this.map.setCenter(new C.LngLat(oe.coords.longitude,oe.coords.latitude)),this.searchMarker||(this.searchMarker=new C.Marker({color:"#99ccff",anchor:"bottom"}).setLngLat(new C.LngLat(oe.coords.longitude,oe.coords.latitude)).addTo(this.map),this.searchMarker.getElement().addEventListener("click",()=>{let xe=this.searchMarker.getLngLat();this.events.publish("ocm:mapping:addpoi",new B.wC(xe.lat,xe.lng))})))}getMapCenter(){return new l.y(xe=>{if(null!=this.map){let Ie=this.map.getCenter();null!=Ie&&(xe.next(new B.jR(Ie.lat,Ie.lng)),xe.complete())}})}setMapZoom(oe){this.map.setZoom(oe)}getMapZoom(){return new l.y(xe=>{let Ie=this.map.getZoom();xe.next(Ie),xe.complete()})}setMapType(oe){this.map.setStyle(this.getCurrentMapTileSet(oe))}getMapBounds(){return new l.y(xe=>{let Ie=new Array,Ae=this.map.getBounds();Ie.push(new B.wC(Ae.getSouthWest().lat,Ae.getSouthWest().lng)),Ie.push(new B.wC(Ae.getNorthEast().lat,Ae.getNorthEast().lng)),xe.next(Ie),xe.complete()})}moveToMapBounds(oe){this.map.fitBounds(new C.LngLatBounds(new C.LngLat(oe.southWest.longitude,oe.southWest.latitude),new C.LngLat(oe.northEast.longitude,oe.northEast.latitude)))}renderMap(oe,xe,Ie){return document.getElementById(this.mapCanvasID).style.height=xe+"px",this.mapReady&&this.showPOIListOnMap(oe,Ie),!0}renderPolyline(oe){this.clearPolyline()}clearPolyline(){null!=this.polylinePath&&this.polylinePath.setMap(null)}focusMap(){}unfocusMap(){}placeSearch(oe,xe,Ie){var Ae=this;return(0,h.Z)(function*(){let ye=`https://api.mapbox.com/geocoding/v5/mapbox.places/${oe||Ie+","+xe}.json?access_token=${fe.N.mapBoxToken}`;return new Promise(function(){var Ue=(0,h.Z)(function*(ct,X){Ae.http.get(ye).toPromise().then(ve=>{let me=[];me=[],ve.features&&ve.features.map(Fe=>{let De=new Pe.nS;De.Title=Fe.place_name,De.Address=Fe.place_name,De.Type="place",De.Location=new B.wC(Fe.center[1],Fe.center[0]),De.Attribution=ve.attribution,me.push(De)}),ct(me)})});return function(ct,X){return Ue.apply(this,arguments)}}())})()}addPOILayer(oe){this.logging.log("Add POI Layer not implemented in this provider."),this.showPOIListOnMap(oe,null,!1)}static \u0275fac=function(xe){return new(xe||nt)(K.LFG(be.z),K.LFG(Y.z),K.LFG(Te.eN))};static \u0275prov=K.Yz7({token:nt,factory:nt.\u0275fac})}return nt})()},553:(Bn,Ct,P)=>{"use strict";P.d(Ct,{N:()=>h});const h={name:"prod",version:"8.6.0",production:!0,analyticsId:"",googleMapsKey:"",mapBoxToken:"pk.eyJ1Ijoid2VicHJvZnVzaW9uIiwiYSI6ImNrdHZlc2N5dTI5Zjcydm8zYWFwc2JnbTMifQ.M7b5SOzbPcg_8XAHCOeP0w",mapKitToken:"",enableStaticMaps:!1,defaultMapProvider:4,apiBase:"https://api.openchargemap.io",apiKey:"9bb03e5b-0fb2-4916-9b2b-26c6bd27a56a",enabledFeatures:["MAP","ADD_COMMENT","ADD_PHOTO","FAVOURITES","FILTER_OPTIONS_BY_COUNTRY","ADD_POI","EDIT_POI","LAYERS"]}},3108:(Bn,Ct,P)=>{"use strict";var h=P(6593),m=P(9212),te=P(5086),l=P(2618),B=P(6814),Y=P(6223),C=P(451);let ie=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn});static \u0275inj=m.cJS({imports:[B.ez,Y.u5,C.Pc,l.aw,te.e]})}return fn})(),fe=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn});static \u0275inj=m.cJS({imports:[B.ez,Y.u5,C.Pc,l.aw,te.e]})}return fn})(),Pe=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn});static \u0275inj=m.cJS({imports:[B.ez,Y.u5,C.Pc,l.aw,te.e]})}return fn})();var K=P(4606),be=P(9862),Te=P(6800),Me=P(703),de=P(7346);class nt{http;prefix;suffix;constructor(Li,gn="/assets/i18n/",Fn=".json"){this.http=Li,this.prefix=gn,this.suffix=Fn}getTranslation(Li){return this.http.get(`${this.prefix}${Li}${this.suffix}`)}}var Ce=P(5861),oe=P(1847),xe=P(3247),Ie=P(8767),Ae=P(4292),ye=P(6470);function Ue(fn,Li){if(1&fn){const gn=m.EpF();m.TgZ(0,"div"),m._uU(1," You are not signed in. "),m.TgZ(2,"button",5),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.showSignInModal())}),m._uU(3),m.ALo(4,"translate"),m.qZA()()}2&fn&&(m.xp6(3),m.Oqu(m.lcZ(4,1,"ocm.general.signIn")))}function ct(fn,Li){if(1&fn&&(m.TgZ(0,"div")(1,"ion-card")(2,"ion-item")(3,"ion-avatar",6),m._UZ(4,"img",7),m.qZA(),m.TgZ(5,"h2"),m._uU(6),m.qZA()(),m.TgZ(7,"ion-card-content")(8,"p"),m._uU(9),m.qZA(),m.TgZ(10,"p"),m._uU(11),m.qZA()(),m.TgZ(12,"ion-item")(13,"ion-note",8),m._UZ(14,"ion-icon",9),m._uU(15),m.qZA()()()()),2&fn){const gn=m.oxw();m.xp6(4),m.s9C("src",gn.userProfile.ProfileImageURL,m.LSH),m.xp6(2),m.Oqu(gn.userProfile.Username),m.xp6(3),m.hij(" ",gn.userProfile.Profile,""),m.xp6(2),m.hij(" Date Joined: ",gn.userProfile.DateCreated," "),m.xp6(4),m.hij(" ",gn.userProfile.ReputationPoints," Contributor Points ")}}let X=(()=>{class fn{appManager;nav;translate;modalController;userProfile;constructor(gn,Fn,Jt,Bi){this.appManager=gn,this.nav=Fn,this.translate=Jt,this.modalController=Bi}ionViewDidEnter(){this.userProfile=this.appManager.getUserProfile(),null!=this.userProfile&&this.appManager.isUserAuthenticated(!0)?this.refreshProfileView():this.showSignInModal(),this.appManager.analytics.viewEvent("Profile")}refreshProfileView(){this.userProfile=this.appManager.getUserProfile()}showSignInModal(){this.modalController.create({component:Ie.F,componentProps:{Profile:this.userProfile}}).then(gn=>{gn.onDidDismiss().then(()=>{this.refreshProfileView()}),gn.present()})}close(){this.modalController.dismiss()}static \u0275fac=function(Fn){return new(Fn||fn)(m.Y36(ye.c),m.Y36(de.SH),m.Y36(l.sK),m.Y36(C.IN))};static \u0275cmp=m.Xpm({type:fn,selectors:[["ng-component"]],decls:14,vars:5,consts:[[1,"profile-page","ion-padding"],[4,"ngIf"],["slot","end"],[3,"click"],["name","close","slot","start"],["ion-button","",3,"click"],["slot","start"],[3,"src"],["item-left",""],["name","star"]],template:function(Fn,Jt){1&Fn&&(m.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),m._uU(3),m.ALo(4,"translate"),m.qZA()()(),m.TgZ(5,"ion-content",0),m.YNc(6,Ue,5,3,"div",1)(7,ct,16,5,"div",1),m.qZA(),m.TgZ(8,"ion-footer")(9,"ion-toolbar")(10,"ion-buttons",2)(11,"ion-button",3),m.NdJ("click",function(){return Jt.close()}),m._UZ(12,"ion-icon",4),m._uU(13," Close "),m.qZA()()()()),2&Fn&&(m.xp6(3),m.hij(" ",m.lcZ(4,3,"ocm.navigation.profile.sectionTitle")," "),m.xp6(3),m.Q6J("ngIf",null==Jt.userProfile),m.xp6(),m.Q6J("ngIf",null!=Jt.userProfile))},dependencies:[B.O5,C.BJ,C.YG,C.Sm,C.PM,C.FN,C.W2,C.fr,C.Gu,C.gu,C.Ie,C.uN,C.wd,C.sr,l.X$],encapsulation:2})}return fn})();var ve=P(9127),me=P(553),Fe=P(6662),De=P(3294),ze=P(866),Ke=P(9236),Ht=P(8062),dn=P(2726);const _n=(0,dn.fo)("PushNotifications",{}),it=(0,dn.fo)("StatusBar"),Qt=(0,dn.fo)("SplashScreen",{web:()=>P.e(4485).then(P.bind(P,4485)).then(fn=>new fn.SplashScreenWeb)}),mt=(0,dn.fo)("App",{web:()=>P.e(2912).then(P.bind(P,2912)).then(fn=>new fn.AppWeb)});var an=P(5957);function tt(fn,Li){if(1&fn){const gn=m.EpF();m.TgZ(0,"ion-item",9),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.openRoutePlannerModal())}),m._UZ(1,"ion-icon",12),m.TgZ(2,"ion-label"),m._uU(3," Route Planner "),m.qZA()()}}function pt(fn,Li){if(1&fn){const gn=m.EpF();m.TgZ(0,"ion-item",9),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.add())}),m._UZ(1,"ion-icon",13),m.TgZ(2,"ion-label"),m._uU(3),m.ALo(4,"translate"),m.qZA()()}2&fn&&(m.xp6(3),m.hij(" ",m.lcZ(4,1,"ocm.general.addLocation")," "))}function Xt(fn,Li){if(1&fn){const gn=m.EpF();m.TgZ(0,"ion-item",9),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.journeys())}),m._UZ(1,"ion-icon",12),m.TgZ(2,"ion-label"),m._uU(3," Journeys "),m.qZA()()}}function bn(fn,Li){if(1&fn){const gn=m.EpF();m.TgZ(0,"ion-item",9),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.addLayer())}),m._UZ(1,"ion-icon",14),m.TgZ(2,"ion-label"),m._uU(3," Add Layer "),m.qZA()()}}function Cn(fn,Li){if(1&fn){const gn=m.EpF();m.ynx(0),m.TgZ(1,"ion-item",9),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.signIn())}),m._UZ(2,"ion-icon",15),m.TgZ(3,"ion-label"),m._uU(4),m.ALo(5,"translate"),m.qZA()(),m.BQk()}2&fn&&(m.xp6(4),m.hij(" ",m.lcZ(5,1,"ocm.general.signIn")," "))}function It(fn,Li){if(1&fn){const gn=m.EpF();m.ynx(0),m.TgZ(1,"ion-item",9),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.profile())}),m._UZ(2,"ion-icon",15),m.TgZ(3,"ion-label"),m._uU(4),m.ALo(5,"translate"),m.qZA()(),m.TgZ(6,"ion-item",9),m.NdJ("click",function(){m.CHM(gn);const Jt=m.oxw();return m.KtG(Jt.signOut())}),m._UZ(7,"ion-icon",16),m.TgZ(8,"ion-label"),m._uU(9),m.ALo(10,"translate"),m._UZ(11,"br"),m.TgZ(12,"small",17),m._uU(13),m.qZA()()(),m.BQk()}if(2&fn){const gn=m.oxw();m.xp6(4),m.hij(" ",m.lcZ(5,3,"ocm.navigation.profile.sectionTitle")," "),m.xp6(5),m.hij(" ",m.lcZ(10,5,"ocm.general.signOut")," "),m.xp6(4),m.hij(" ",gn.getUserName(),"")}}const pe=()=>["/search"];let lt=(()=>{class fn{platform;translate;mapping;modalController;appManager;logger;analytics;events;enabledFeatures;constructor(gn,Fn,Jt,Bi,ut,he,_e,ot){this.platform=gn,this.translate=Fn,this.mapping=Jt,this.modalController=Bi,this.appManager=ut,this.logger=he,this.analytics=_e,this.events=ot,this.logger.log("Environment: "+me.N.name),this.initializeApp(),this.enabledFeatures=me.N.enabledFeatures,1!=ut.searchSettings.EnableAdvancedEditorFeatures&&(this.enabledFeatures=this.enabledFeatures.filter(yt=>"LAYERS"!=yt))}configurePushNotifications(){_n.register(),_n.addListener("registration",gn=>{this.logger.log("Push registration success, token: "+gn.value),this.appManager.savePushRegistration(gn.value)}),_n.addListener("registrationError",gn=>{this.logger.log("Error on registration: "+JSON.stringify(gn))}),_n.addListener("pushNotificationReceived",gn=>{this.logger.log("Push received: "+JSON.stringify(gn),ve.i.INFO)}),_n.addListener("pushNotificationActionPerformed",gn=>{this.logger.log("Push action performed: "+JSON.stringify(gn))})}isUserAuthenticated(){return this.appManager.isUserAuthenticated()}getUserName(){let gn=this.appManager.getUserProfile();return gn?gn.EmailAddress?gn.EmailAddress:gn.Username:"Not Signed In"}initializeApp(){var gn=this;this.platform.ready().then(()=>{this.platform.is("capacitor")&&(it.show(),Qt.hide()),this.translate.addLangs(this.appManager.getLanguages().map(Fn=>Fn.code)),this.translate.setDefaultLang("en"),null!=this.appManager.searchSettings.Language?this.translate.use(this.appManager.searchSettings.Language):this.translate.currentLang||this.translate.use("en"),this.translate.get("ocm.search.performSearch").toPromise().then(Fn=>{}),this.analytics.init(me.N.analyticsId).then(()=>{this.analytics.setAppVersion(me.N.version),this.analytics.appEvent("Startup","App Loaded")}).catch(Fn=>this.logger.log("Error starting analytics")),this.events.subscribe("ocm:mapping:addpoi",function(){var Fn=(0,Ce.Z)(function*(Jt){ze.c.isFeatureEnabled("ADD_POI")&&gn.add(Jt)});return function(Jt){return Fn.apply(this,arguments)}}()),(this.platform.is("ios")||this.platform.is("android"))&&(this.configurePushNotifications(),this.checkForAppOpenUrl())})}checkForAppOpenUrl(){return(0,Ce.Z)(function*(){mt.addListener("appUrlOpen",Fn=>{alert("App (re)opened with URL: "+Fn.url)});let gn=yield mt.getLaunchUrl();gn&&gn.url&&alert("App opened with URL: "+gn.url)})()}openRoutePlannerModal(){var gn=this;return(0,Ce.Z)(function*(){gn.mapping.unfocusMap();const Fn=yield gn.modalController.create({component:xe.u});Fn.onDidDismiss().then(Jt=>{gn.mapping.focusMap()}),yield Fn.present()})()}continueAdd(gn){var Fn=this;return(0,Ce.Z)(function*(){const Jt=yield Fn.modalController.create({component:Fe.Y,componentProps:{startPos:gn}});Jt.onDidDismiss().then(Bi=>{Fn.mapping.focusMap()}),yield Jt.present()})()}add(gn){var Fn=this;return(0,Ce.Z)(function*(){if(Fn.mapping.unfocusMap(),!Fn.appManager.isUserAuthenticated(!0)){const Jt=yield Fn.modalController.create({component:Ie.F});return Jt.onDidDismiss().then(function(){var Bi=(0,Ce.Z)(function*(ut){Fn.mapping.focusMap(),Fn.appManager.isUserAuthenticated(!0)&&(yield Fn.continueAdd(gn))});return function(ut){return Bi.apply(this,arguments)}}()),yield Jt.present()}yield Fn.continueAdd(gn)})()}signIn(){var gn=this;return(0,Ce.Z)(function*(){gn.mapping.unfocusMap();const Fn=yield gn.modalController.create({component:Ie.F});return Fn.onDidDismiss().then(Jt=>{gn.mapping.focusMap(),gn.appManager.isUserAuthenticated(!0)}),yield Fn.present()})()}signOut(){var gn=this;return(0,Ce.Z)(function*(){gn.appManager.signOutCurrentUser()})()}profile(){var gn=this;return(0,Ce.Z)(function*(){gn.mapping.unfocusMap();const Fn=yield gn.modalController.create({component:X});Fn.onDidDismiss().then(Jt=>{gn.mapping.focusMap()}),yield Fn.present()})()}journeys(){var gn=this;return(0,Ce.Z)(function*(){gn.mapping.unfocusMap();const Fn=yield gn.modalController.create({component:Ae.g});Fn.onDidDismiss().then(Jt=>{gn.mapping.focusMap()}),yield Fn.present()})()}addLayer(){var gn=this;return(0,Ce.Z)(function*(){const Fn=yield gn.modalController.create({component:Ht.A});yield Fn.present();const{data:Jt}=yield Fn.onWillDismiss();Jt&&gn.mapping.addPOILayer(Jt)})()}about(){var gn=this;return(0,Ce.Z)(function*(){gn.mapping.unfocusMap();const Fn=yield gn.modalController.create({component:Ke.t});Fn.onDidDismiss().then(Jt=>{gn.mapping.focusMap()}),yield Fn.present()})()}static \u0275fac=function(Fn){return new(Fn||fn)(m.Y36(de.t4),m.Y36(l.sK),m.Y36(oe.v),m.Y36(C.IN),m.Y36(ye.c),m.Y36(ve.z),m.Y36(De.c),m.Y36(an.z))};static \u0275cmp=m.Xpm({type:fn,selectors:[["app-root"]],decls:29,vars:17,consts:[["contentId","main-content",3,"disabled"],["contentId","main-content","swipeGesture","false"],["slot","start"],["src","assets/images/icons/branding/AppIcon_128x128.png"],["auto-hide","false"],[3,"routerDirection","routerLink"],["slot","start","name","home"],[3,"click",4,"ngIf"],[4,"ngIf"],[3,"click"],["slot","start","name","information-circle-outline"],["id","main-content"],["slot","start","name","map"],["slot","start","name","add-circle-outline"],["slot","start","name","albums"],["slot","start","name","person"],["slot","start","name","log-out"],[2,"color","#c0c0c0"]],template:function(Fn,Jt){1&Fn&&(m.TgZ(0,"ion-app")(1,"ion-split-pane",0)(2,"ion-menu",1)(3,"ion-header")(4,"ion-toolbar")(5,"ion-thumbnail",2),m._UZ(6,"img",3),m.qZA(),m.TgZ(7,"ion-title"),m._uU(8),m.qZA()()(),m.TgZ(9,"ion-content")(10,"ion-list")(11,"ion-menu-toggle",4)(12,"ion-item",5),m._UZ(13,"ion-icon",6),m.TgZ(14,"ion-label"),m._uU(15),m.ALo(16,"translate"),m.qZA()(),m.YNc(17,tt,4,0,"ion-item",7)(18,pt,5,3,"ion-item",7)(19,Xt,4,0,"ion-item",7)(20,bn,4,0,"ion-item",7)(21,Cn,6,3,"ng-container",8)(22,It,14,7,"ng-container",8),m.TgZ(23,"ion-item",9),m.NdJ("click",function(){return Jt.about()}),m._UZ(24,"ion-icon",10),m.TgZ(25,"ion-label"),m._uU(26),m.ALo(27,"translate"),m.qZA()()()()()(),m._UZ(28,"ion-router-outlet",11),m.qZA()()),2&Fn&&(m.xp6(),m.Q6J("disabled",!0),m.xp6(7),m.Oqu(Jt.appManager.title),m.xp6(4),m.Q6J("routerDirection","root")("routerLink",m.DdM(16,pe)),m.xp6(3),m.hij(" ",m.lcZ(16,12,"ocm.search.sectionTitle")," "),m.xp6(2),m.Q6J("ngIf",Jt.enabledFeatures.includes("ROUTE_PLANNER")),m.xp6(),m.Q6J("ngIf",Jt.enabledFeatures.includes("ADD_POI")),m.xp6(),m.Q6J("ngIf",Jt.enabledFeatures.includes("FAVOURITES")),m.xp6(),m.Q6J("ngIf",Jt.enabledFeatures.includes("LAYERS")),m.xp6(),m.Q6J("ngIf",!Jt.isUserAuthenticated()),m.xp6(),m.Q6J("ngIf",Jt.isUserAuthenticated()),m.xp6(4),m.hij(" ",m.lcZ(27,14,"ocm.general.about")," "))},dependencies:[B.O5,C.dr,C.W2,C.Gu,C.gu,C.Ie,C.Q$,C.q_,C.z0,C.zc,C.jI,C.Bs,C.wd,C.sr,C.jP,C.YI,Te.rH,l.X$],encapsulation:2})}return fn})();const Zt=[{path:"",redirectTo:"search",pathMatch:"full"},{path:"search",loadChildren:()=>Promise.resolve().then(P.bind(P,4606)).then(fn=>fn.SearchPageModule)},{path:"journeys",loadChildren:()=>Promise.resolve().then(P.bind(P,9192)).then(fn=>fn.JourneysModule)},{path:"signin",loadChildren:()=>Promise.resolve().then(P.bind(P,9472)).then(fn=>fn.SignInModule)},{path:"poi-editor/:id",loadChildren:()=>Promise.resolve().then(P.bind(P,5722)).then(fn=>fn.PoiEditorPageModule)},{path:"about",loadChildren:()=>Promise.resolve().then(P.bind(P,7425)).then(fn=>fn.AboutPageModule)},{path:"layer-editor",loadChildren:()=>Promise.resolve().then(P.bind(P,2309)).then(fn=>fn.LayerEditorPageModule)}];let hn=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn});static \u0275inj=m.cJS({imports:[Te.Bz.forRoot(Zt,{useHash:!0}),Te.Bz]})}return fn})(),Yt=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn});static \u0275inj=m.cJS({imports:[B.ez,Y.u5,C.Pc,l.aw,te.e]})}return fn})();var Ft=P(9472);let Un=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn});static \u0275inj=m.cJS({imports:[B.ez,Y.u5,C.Pc,l.aw,te.e,Te.Bz.forChild([{path:"",component:X}])]})}return fn})();var Ve=P(4119);let Pt=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn});static \u0275inj=m.cJS({imports:[B.ez,Y.u5,C.Pc,l.aw,te.e,Te.Bz.forChild([{path:"",component:Ve.N}])]})}return fn})();var Kt=P(9192),wn=P(5722),ei=P(7425),di=P(2309);function Lr(){return localStorage.getItem("access_token")}function Mi(fn){return new nt(fn,"/assets/i18n/",".json")}let Ei=(()=>{class fn{static \u0275fac=function(Fn){return new(Fn||fn)};static \u0275mod=m.oAB({type:fn,bootstrap:[lt]});static \u0275inj=m.cJS({providers:[{provide:Te.wN,useClass:de.r4}],imports:[h.b2,be.JF,l.aw.forRoot({loader:{provide:l.Zw,useFactory:Mi,deps:[be.eN]}}),C.Pc.forRoot(),hn,Me.Ar.forRoot({config:{tokenGetter:Lr}}),K.SearchPageModule,Yt,Kt.JourneysModule,Ft.SignInModule,Pe,ie,fe,wn.PoiEditorPageModule,Un,Pt,ei.AboutPageModule,di.LayerEditorPageModule]})}return fn})();me.N.production&&(0,m.G48)(),h.q6().bootstrapModule(Ei).catch(fn=>console.log(fn))},2574:function(Bn){Bn.exports=function(){"use strict";var Ct,P,h;function m(l,B){if(Ct)if(P){var Y="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+Ct+")(sharedChunk); ("+P+")(sharedChunk); self.onerror = null;",C={};Ct(C),h=B(C),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(h.workerUrl=window.URL.createObjectURL(new Blob([Y],{type:"text/javascript"})))}else P=B;else Ct=B}return m(0,function(l){var B=typeof self<"u"?self:{},Y="2.15.0";let C;const ie={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(null==C){const r=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{C=null!=process.env.API_URL_REGEX?new RegExp(process.env.API_URL_REGEX):r}catch{C=r}}return C},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!ie.API_URL)return null;try{const r=new URL(ie.API_URL);return"api.mapbox.cn"===r.hostname?"https://events.mapbox.cn/events/v2":"api.mapbox.com"===r.hostname?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},fe={supported:!1,testSupport:function(r){!be&&K&&(Te?Me(r):Pe=r)}};let Pe,K,be=!1,Te=!1;function Me(r){const e=r.createTexture();r.bindTexture(r.TEXTURE_2D,e);try{if(r.texImage2D(r.TEXTURE_2D,0,r.RGBA,r.RGBA,r.UNSIGNED_BYTE,K),r.isContextLost())return;fe.supported=!0}catch{}r.deleteTexture(e),be=!0}B.document&&(K=B.document.createElement("img"),K.onload=function(){Pe&&Me(Pe),Pe=null,Te=!0},K.onerror=function(){be=!0,Pe=null},K.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const de="01";function nt(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Ce=oe;function oe(r,e,o,c){this.cx=3*r,this.bx=3*(o-r)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(c-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=r,this.p1y=e,this.p2x=o,this.p2y=c}oe.prototype={sampleCurveX:function(r){return((this.ax*r+this.bx)*r+this.cx)*r},sampleCurveY:function(r){return((this.ay*r+this.by)*r+this.cy)*r},sampleCurveDerivativeX:function(r){return(3*this.ax*r+2*this.bx)*r+this.cx},solveCurveX:function(r,e){if(void 0===e&&(e=1e-6),r<0)return 0;if(r>1)return 1;for(var o=r,c=0;c<8;c++){var f=this.sampleCurveX(o)-r;if(Math.abs(f)<e)return o;var _=this.sampleCurveDerivativeX(o);if(Math.abs(_)<1e-6)break;o-=f/_}var v=0,w=1;for(o=r,c=0;c<20&&(f=this.sampleCurveX(o),!(Math.abs(f-r)<e));c++)r>f?v=o:w=o,o=.5*(w-v)+v;return o},solve:function(r,e){return this.sampleCurveY(this.solveCurveX(r,e))}};var xe=nt(Ce),Ie=Ae;function Ae(r,e){this.x=r,this.y=e}Ae.prototype={clone:function(){return new Ae(this.x,this.y)},add:function(r){return this.clone()._add(r)},sub:function(r){return this.clone()._sub(r)},multByPoint:function(r){return this.clone()._multByPoint(r)},divByPoint:function(r){return this.clone()._divByPoint(r)},mult:function(r){return this.clone()._mult(r)},div:function(r){return this.clone()._div(r)},rotate:function(r){return this.clone()._rotate(r)},rotateAround:function(r,e){return this.clone()._rotateAround(r,e)},matMult:function(r){return this.clone()._matMult(r)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(r){return this.x===r.x&&this.y===r.y},dist:function(r){return Math.sqrt(this.distSqr(r))},distSqr:function(r){var e=r.x-this.x,o=r.y-this.y;return e*e+o*o},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(r){return Math.atan2(this.y-r.y,this.x-r.x)},angleWith:function(r){return this.angleWithSep(r.x,r.y)},angleWithSep:function(r,e){return Math.atan2(this.x*e-this.y*r,this.x*r+this.y*e)},_matMult:function(r){var e=r[2]*this.x+r[3]*this.y;return this.x=r[0]*this.x+r[1]*this.y,this.y=e,this},_add:function(r){return this.x+=r.x,this.y+=r.y,this},_sub:function(r){return this.x-=r.x,this.y-=r.y,this},_mult:function(r){return this.x*=r,this.y*=r,this},_div:function(r){return this.x/=r,this.y/=r,this},_multByPoint:function(r){return this.x*=r.x,this.y*=r.y,this},_divByPoint:function(r){return this.x/=r.x,this.y/=r.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var r=this.y;return this.y=this.x,this.x=-r,this},_rotate:function(r){var e=Math.cos(r),o=Math.sin(r),c=o*this.x+e*this.y;return this.x=e*this.x-o*this.y,this.y=c,this},_rotateAround:function(r,e){var o=Math.cos(r),c=Math.sin(r),f=e.y+c*(this.x-e.x)+o*(this.y-e.y);return this.x=e.x+o*(this.x-e.x)-c*(this.y-e.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},Ae.convert=function(r){return r instanceof Ae?r:Array.isArray(r)?new Ae(r[0],r[1]):r};var ye=nt(Ie);const Ue=Math.PI/180,ct=180/Math.PI;function X(r){return r*Ue}function ve(r){return r*ct}const me=[[0,0],[1,0],[1,1],[0,1]];function Fe(r){if(r<=0)return 0;if(r>=1)return 1;const e=r*r,o=e*r;return 4*(r<.5?o:3*(r-e)+o-.75)}function De(r,e,o,c){const f=new xe(r,e,o,c);return function(_){return f.solve(_)}}const ze=De(.25,.1,.25,1);function Ke(r,e,o){return Math.min(o,Math.max(e,r))}function Ht(r,e,o){return(o=Ke((o-r)/(e-r),0,1))*o*(3-2*o)}function dn(r,e,o){const c=o-e,f=((r-e)%c+c)%c+e;return f===e?o:f}function _n(r,e,o){if(!r.length)return o(null,[]);let c=r.length;const f=new Array(r.length);let _=null;r.forEach((v,w)=>{e(v,(E,M)=>{E&&(_=E),f[w]=M,0==--c&&o(_,f)})})}function Ut(r){const e=[];for(const o in r)e.push(r[o]);return e}function We(r,...e){for(const o of e)for(const c in o)r[c]=o[c];return r}let Ne=1;function ke(){return Ne++}function it(){return function r(e){return e?(e^Math.random()*(16>>e/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,r)}()}function Qt(r){return r<=1?1:Math.pow(2,Math.ceil(Math.log(r)/Math.LN2))}function mt(r){return!!r&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(r)}function an(r,e){r.forEach(o=>{e[o]&&(e[o]=e[o].bind(e))})}function tt(r,e){return-1!==r.indexOf(e,r.length-e.length)}function pt(r,e,o){const c={};for(const f in r)c[f]=e.call(o||this,r[f],f,r);return c}function Xt(r,e,o){const c={};for(const f in r)e.call(o||this,r[f],f,r)&&(c[f]=r[f]);return c}function bn(r){return Array.isArray(r)?r.map(bn):"object"==typeof r&&r?pt(r,bn):r}const Cn={};function It(r){Cn[r]||(typeof console<"u"&&console.warn(r),Cn[r]=!0)}function pe(r,e,o){return(o.y-r.y)*(e.x-r.x)>(e.y-r.y)*(o.x-r.x)}function lt(r){let e=0;for(let o,c,f=0,_=r.length,v=_-1;f<_;v=f++)o=r[f],c=r[v],e+=(c.x-o.x)*(o.y+c.y);return e}function Zt(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function hn(r){const e={};if(r.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(o,c,f,_)=>{const v=f||_;return e[c]=!v||v.toLowerCase(),""}),e["max-age"]){const o=parseInt(e["max-age"],10);isNaN(o)?delete e["max-age"]:e["max-age"]=o}return e}let Yt=null;function Ft(r){if(null==Yt){const e=r.navigator?r.navigator.userAgent:null;Yt=!!r.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return Yt}function Un(r){try{const e=B[r];return e.setItem("_mapbox_test_",1),e.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ve(r,e){return[r[4*e],r[4*e+1],r[4*e+2],r[4*e+3]]}const Pt="mapbox-tiles";let ei,di,Kt=500,wn=50;function Lr(){try{return B.caches}catch{}}function Mi(){Lr()&&!ei&&(ei=B.caches.open(Pt))}function dr(r){const e=r.indexOf("?");if(e<0)return r;const c=function(f){const _=f.indexOf("?");return _>0?f.slice(_+1).split("&"):[]}(r).filter(f=>{const _=f.split("=");return"language"===_[0]||"worldview"===_[0]});return c.length?`${r.slice(0,e)}?${c.join("&")}`:r.slice(0,e)}let Ei=1/0;const fn={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};"function"==typeof Object.freeze&&Object.freeze(fn);class Li extends Error{constructor(e,o,c){401===o&&jt(c)&&(e+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(e),this.status=o,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const gn=Zt()?()=>self.worker&&self.worker.referrer:()=>("blob:"===B.location.protocol?B.parent:B).location.href,Fn=function(r,e){if(!(/^file:/.test(o=r.url)||/^file:/.test(gn())&&!/^\w+:/.test(o))){if(B.fetch&&B.Request&&B.AbortController&&B.Request.prototype.hasOwnProperty("signal"))return function(c,f){const _=new B.AbortController,v=new B.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:gn(),referrerPolicy:c.referrerPolicy,signal:_.signal});let w=!1,E=!1;const M=(L=v.url).indexOf("sku=")>0&&jt(L);var L;"json"===c.type&&v.headers.set("Accept","application/json");const N=(W,J,se)=>{if(E)return;if(W&&"SecurityError"!==W.message&&It(W.toString()),J&&se)return j(J);const Le=Date.now();B.fetch(v).then(rt=>{if(rt.ok){const bt=M?rt.clone():null;return j(rt,bt,Le)}return f(new Li(rt.statusText,rt.status,c.url))}).catch(rt=>{"AbortError"!==rt.name&&f(new Error(`${rt.message} ${c.url}`))})},j=(W,J,se)=>{("arrayBuffer"===c.type?W.arrayBuffer():"json"===c.type?W.json():W.text()).then(Le=>{E||(J&&se&&function(rt,bt,at){if(Mi(),!ei)return;const xt={status:bt.status,statusText:bt.statusText,headers:new B.Headers};bt.headers.forEach((un,rn)=>xt.headers.set(rn,un));const At=hn(bt.headers.get("Cache-Control")||"");if(At["no-store"])return;At["max-age"]&&xt.headers.set("Expires",new Date(at+1e3*At["max-age"]).toUTCString());const Mt=xt.headers.get("Expires");Mt&&(new Date(Mt).getTime()-at<42e4||function(un,rn){if(void 0===di)try{new Response(new ReadableStream),di=!0}catch{di=!1}di?rn(un.body):un.blob().then(rn)}(bt,un=>{const rn=new B.Response(un,xt);Mi(),ei&&ei.then(Dn=>Dn.put(dr(rt.url),rn)).catch(Dn=>It(Dn.message))}))}(v,J,se),w=!0,f(null,Le,W.headers.get("Cache-Control"),W.headers.get("Expires")))}).catch(Le=>{E||f(new Error(Le.message))})};return M?function(W,J){if(Mi(),!ei)return J(null);const se=dr(W.url);ei.then(Le=>{Le.match(se).then(rt=>{const bt=function(at){if(!at)return!1;const xt=new Date(at.headers.get("Expires")||0),At=hn(at.headers.get("Cache-Control")||"");return xt>Date.now()&&!At["no-cache"]}(rt);Le.delete(se),bt&&Le.put(se,rt.clone()),J(null,rt,bt)}).catch(J)}).catch(J)}(v,N):N(null,null),{cancel:()=>{E=!0,w||_.abort()}}}(r,e);if(Zt()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",r,e,void 0,!0)}var o;return function(c,f){const _=new B.XMLHttpRequest;_.open(c.method||"GET",c.url,!0),"arrayBuffer"===c.type&&(_.responseType="arraybuffer");for(const v in c.headers)_.setRequestHeader(v,c.headers[v]);return"json"===c.type&&(_.responseType="text",_.setRequestHeader("Accept","application/json")),_.withCredentials="include"===c.credentials,_.onerror=()=>{f(new Error(_.statusText))},_.onload=()=>{if((_.status>=200&&_.status<300||0===_.status)&&null!==_.response){let v=_.response;if("json"===c.type)try{v=JSON.parse(_.response)}catch(w){return f(w)}f(null,v,_.getResponseHeader("Cache-Control"),_.getResponseHeader("Expires"))}else f(new Li(_.statusText,_.status,c.url))},_.send(c.body),{cancel:()=>_.abort()}}(r,e)},Jt=function(r,e){return Fn(We(r,{type:"arrayBuffer"}),e)};function Bi(r){const e=B.document.createElement("a");return e.href=r,e.protocol===B.document.location.protocol&&e.host===B.document.location.host}const ut="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let he,_e;he=[],_e=0;const ot=function(r,e){if(fe.supported&&(r.headers||(r.headers={}),r.headers.accept="image/webp,*/*"),_e>=ie.MAX_PARALLEL_IMAGE_REQUESTS){const _={requestParameters:r,callback:e,cancelled:!1,cancel(){this.cancelled=!0}};return he.push(_),_}_e++;let o=!1;const c=()=>{if(!o)for(o=!0,_e--;he.length&&_e<ie.MAX_PARALLEL_IMAGE_REQUESTS;){const _=he.shift(),{requestParameters:v,callback:w,cancelled:E}=_;E||(_.cancel=ot(v,w).cancel)}},f=Jt(r,(_,v,w,E)=>{c(),_?e(_):v&&(B.createImageBitmap?function(M,L){const N=new B.Blob([new Uint8Array(M)],{type:"image/png"});B.createImageBitmap(N).then(j=>{L(null,j)}).catch(j=>{L(new Error(`Could not load image because of ${j.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(v,(M,L)=>e(M,L,w,E)):function(M,L){const N=new B.Image,j=B.URL;N.onload=()=>{L(null,N),j.revokeObjectURL(N.src),N.onload=null,B.requestAnimationFrame(()=>{N.src=ut})},N.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const W=new B.Blob([new Uint8Array(M)],{type:"image/png"});N.src=M.byteLength?j.createObjectURL(W):ut}(v,(M,L)=>e(M,L,w,E)))});return{cancel:()=>{f.cancel(),c()}}},yt="NO_ACCESS_TOKEN";function Dt(r){return 0===r.indexOf("mapbox:")}function jt(r){return ie.API_URL_REGEX.test(r)}function Vt(r){return ie.API_CDN_URL_REGEX.test(r)}function dt(r){return ie.API_STYLE_REGEX.test(r)&&!Bt(r)}function Bt(r){return ie.API_SPRITE_REGEX.test(r)}const Nn=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Gn(r){const e=r.match(Nn);if(!e)throw new Error("Unable to parse URL object");return{protocol:e[1],authority:e[2],path:e[3]||"/",params:e[4]?e[4].split("&"):[]}}function ae(r){const e=r.params.length?`?${r.params.join("&")}`:"";return`${r.protocol}://${r.authority}${r.path}${e}`}const ft="mapbox.eventData";function Z(r){if(!r)return null;const e=r.split(".");if(!e||3!==e.length)return null;try{return JSON.parse(decodeURIComponent(B.atob(e[1]).split("").map(o=>"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)).join("")))}catch{return null}}class Re{constructor(e){this.type=e,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(e){const o=Z(ie.ACCESS_TOKEN);let c="";return c=o&&o.u?B.btoa(encodeURIComponent(o.u).replace(/%([0-9A-F]{2})/g,(f,_)=>String.fromCharCode(+("0x"+_)))):ie.ACCESS_TOKEN||"",e?`${ft}.${e}:${c}`:`${ft}:${c}`}fetchEventData(){const e=Un("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{const f=B.localStorage.getItem(o);f&&(this.eventData=JSON.parse(f));const _=B.localStorage.getItem(c);_&&(this.anonId=_)}catch{It("Unable to read from LocalStorage")}}saveEventData(){const e=Un("localStorage"),o=this.getStorageKey(),c=this.getStorageKey("uuid");if(e)try{B.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&B.localStorage.setItem(o,JSON.stringify(this.eventData))}catch{It("Unable to write to LocalStorage")}}processRequests(e){}postEvent(e,o,c,f){if(!ie.EVENTS_URL)return;const _=Gn(ie.EVENTS_URL);_.params.push(`access_token=${f||ie.ACCESS_TOKEN||""}`);const v={event:this.type,created:new Date(e).toISOString()},w=o?We(v,o):v,E={url:ae(_),headers:{"Content-Type":"text/plain"},body:JSON.stringify([w])};var L;this.pendingRequest=(L=M=>{this.pendingRequest=null,c(M),this.saveEventData(),this.processRequests(f)},Fn(We(E,{method:"POST"}),L))}queueRequest(e,o){this.queue.push(e),this.processRequests(o)}}const st=new class extends Re{constructor(r){super("appUserTurnstile"),this._customAccessToken=r}postTurnstileEvent(r,e){ie.EVENTS_URL&&ie.ACCESS_TOKEN&&Array.isArray(r)&&r.some(o=>Dt(o)||jt(o))&&this.queueRequest(Date.now(),e)}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const e=Z(ie.ACCESS_TOKEN),o=e?e.u:ie.ACCESS_TOKEN;let c=o!==this.eventData.tokenU;mt(this.anonId)||(this.anonId=it(),c=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const _=new Date(this.eventData.lastSuccess),v=new Date(f),w=(f-this.eventData.lastSuccess)/864e5;c=c||w>=1||w<-1||_.getDate()!==v.getDate()}else c=!0;c?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Y,skuId:de,"enabled.telemetry":!1,userId:this.anonId},_=>{_||(this.eventData.lastSuccess=f,this.eventData.tokenU=o)},r):this.processRequests()}},on=st.postTurnstileEvent.bind(st),In=new class extends Re{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(r,e,o,c){this.skuToken=e,this.errorCb=c,ie.EVENTS_URL&&(o||ie.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},o):this.errorCb(new Error(yt)))}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||(this.anonId||this.fetchEventData(),mt(this.anonId)||(this.anonId=it()),this.postEvent(o,{sdkIdentifier:"mapbox-gl-js",sdkVersion:Y,skuId:de,skuToken:this.skuToken,userId:this.anonId},c=>{c?this.errorCb(c):e&&(this.success[e]=!0)},r))}},bi=In.postMapLoadEvent.bind(In),wi=new class extends Re{constructor(){super("gljs.performance")}postPerformanceEvent(r,e){ie.EVENTS_URL&&(r||ie.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:e},r)}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{timestamp:e,performanceData:o}=this.queue.shift(),c=function(f){const _=B.performance.getEntriesByType("resource"),v=B.performance.getEntriesByType("mark"),w=function(j){const W={};if(j)for(const J in j)if("other"!==J)for(const se of j[J]){const Le=`${J}ResolveRangeMin`,rt=`${J}ResolveRangeMax`,bt=`${J}RequestCount`,at=`${J}RequestCachedCount`;W[Le]=Math.min(W[Le]||1/0,se.startTime),W[rt]=Math.max(W[rt]||-1/0,se.responseEnd);const xt=At=>{void 0===W[At]&&(W[At]=0),++W[At]};void 0!==se.transferSize&&0===se.transferSize&&xt(at),xt(bt)}return W}(function(j,W){const J={};if(j)for(const se of j){const Le=W(se);void 0===J[Le]&&(J[Le]=[]),J[Le].push(se)}return J}(_,Eo)),E=B.devicePixelRatio,M=B.navigator.connection||B.navigator.mozConnection||B.navigator.webkitConnection,L={counters:[],metadata:[],attributes:[]},N=(j,W,J)=>{null!=J&&j.push({name:W,value:J.toString()})};for(const j in w)N(L.counters,j,w[j]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&(N(L.counters,"interactionRangeMin",f.interactionRange[0]),N(L.counters,"interactionRangeMax",f.interactionRange[1])),v)for(const j of Object.keys(uo)){const W=uo[j],J=v.find(se=>se.name===W);J&&N(L.counters,W,J.startTime)}return N(L.counters,"visibilityHidden",f.visibilityHidden),N(L.attributes,"style",function(j){if(j)for(const W of j){const J=W.name.split("?")[0];if(dt(J)){const se=J.split("/").slice(-2);if(2===se.length)return`mapbox://styles/${se[0]}/${se[1]}`}}}(_)),N(L.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),N(L.attributes,"fogEnabled",f.fogEnabled?"true":"false"),N(L.attributes,"projection",f.projection),N(L.attributes,"zoom",f.zoom),N(L.metadata,"devicePixelRatio",E),N(L.metadata,"connectionEffectiveType",M?M.effectiveType:void 0),N(L.metadata,"navigatorUserAgent",B.navigator.userAgent),N(L.metadata,"screenWidth",B.screen.width),N(L.metadata,"screenHeight",B.screen.height),N(L.metadata,"windowWidth",B.innerWidth),N(L.metadata,"windowHeight",B.innerHeight),N(L.metadata,"mapWidth",f.width/E),N(L.metadata,"mapHeight",f.height/E),N(L.metadata,"webglRenderer",f.renderer),N(L.metadata,"webglVendor",f.vendor),N(L.metadata,"sdkVersion",Y),N(L.metadata,"sdkIdentifier","mapbox-gl-js"),L}(o);for(const f of c.metadata);for(const f of c.counters);for(const f of c.attributes);this.postEvent(e,c,()=>{},r)}},Ri=wi.postPerformanceEvent.bind(wi),mr=new class extends Re{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(r,e,o,c){if(!ie.API_URL||!ie.SESSION_PATH)return;const f=Gn(ie.API_URL+ie.SESSION_PATH);f.params.push(`sku=${e||""}`),f.params.push(`access_token=${c||ie.ACCESS_TOKEN||""}`);const _={url:ae(f),headers:{"Content-Type":"text/plain"}};var w;this.pendingRequest=(w=v=>{this.pendingRequest=null,o(v),this.saveEventData(),this.processRequests(c)},Fn(We(_,{method:"GET"}),w))}getSessionAPI(r,e,o,c){this.skuToken=e,this.errorCb=c,ie.SESSION_PATH&&ie.API_URL&&(o||ie.ACCESS_TOKEN?this.queueRequest({id:r,timestamp:Date.now()},o):this.errorCb(new Error(yt)))}processRequests(r){if(this.pendingRequest||0===this.queue.length)return;const{id:e,timestamp:o}=this.queue.shift();e&&this.success[e]||this.getSession(o,this.skuToken,c=>{c?this.errorCb(c):e&&(this.success[e]=!0)},r)}},Xi=mr.getSessionAPI.bind(mr),Ar=new Set,uo={create:"create",load:"load",fullLoad:"fullLoad"},_o={mark(r){B.performance.mark(r)},measure(r,e,o){B.performance.measure(r,e,o)}};function Eo(r){const e=r.name.split("?")[0];return Vt(e)&&e.includes("mapbox-gl.js")?"javascript":Vt(e)&&e.includes("mapbox-gl.css")?"css":ie.API_FONTS_REGEX.test(e)?"fontRange":Bt(e)?"sprite":dt(e)?"style":ie.API_TILEJSON_REGEX.test(e)?"tilejson":"other"}const zi=B.performance;function hr(r){const e=r?r.url.toString():void 0;return zi.getEntriesByName(e)}let Ti,yo,vr,Vr;const Yr={now:()=>void 0!==vr?vr:B.performance.now(),setNow(r){vr=r},restoreNow(){vr=void 0},frame(r){const e=B.requestAnimationFrame(r);return{cancel:()=>B.cancelAnimationFrame(e)}},getImageData(r,e=0){const{width:o,height:c}=r;Vr||(Vr=B.document.createElement("canvas"));const f=Vr.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(o>Vr.width||c>Vr.height)&&(Vr.width=o,Vr.height=c),f.clearRect(-e,-e,o+2*e,c+2*e),f.drawImage(r,0,0,o,c),f.getImageData(-e,-e,o+2*e,c+2*e)},resolveURL:r=>(Ti||(Ti=B.document.createElement("a")),Ti.href=r,Ti.href),get devicePixelRatio(){return B.devicePixelRatio},get prefersReducedMotion(){return!!B.matchMedia&&(null==yo&&(yo=B.matchMedia("(prefers-reduced-motion: reduce)")),yo.matches)}};function qi(r,e,o){o[r]&&-1!==o[r].indexOf(e)||(o[r]=o[r]||[],o[r].push(e))}function Qe(r,e,o){if(o&&o[r]){const c=o[r].indexOf(e);-1!==c&&o[r].splice(c,1)}}class Tt{constructor(e,o={}){We(this,o),this.type=e}}class Et extends Tt{constructor(e,o={}){super("error",We({error:e},o))}}class ln{on(e,o){return this._listeners=this._listeners||{},qi(e,o,this._listeners),this}off(e,o){return Qe(e,o,this._listeners),Qe(e,o,this._oneTimeListeners),this}once(e,o){return o?(this._oneTimeListeners=this._oneTimeListeners||{},qi(e,o,this._oneTimeListeners),this):new Promise(c=>this.once(e,c))}fire(e,o){"string"==typeof e&&(e=new Tt(e,o||{}));const c=e.type;if(this.listens(c)){e.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const w of f)w.call(this,e);const _=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const w of _)Qe(c,w,this._oneTimeListeners),w.call(this,e);const v=this._eventedParent;v&&(We(e,"function"==typeof this._eventedParentData?this._eventedParentData():this._eventedParentData),v.fire(e))}else e instanceof Et&&console.error(e.error);return this}listens(e){return!!(this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e))}setEventedParent(e,o){return this._eventedParent=e,this._eventedParentData=o,this}}var vt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function Hn(r,...e){for(const o of e)for(const c in o)r[c]=o[c];return r}function On(r){return r instanceof Number||r instanceof String||r instanceof Boolean?r.valueOf():r}function Kn(r){if(Array.isArray(r))return r.map(Kn);if(r instanceof Object&&!(r instanceof Number||r instanceof String||r instanceof Boolean)){const e={};for(const o in r)e[o]=Kn(r[o]);return e}return On(r)}class pi extends Error{constructor(e,o){super(o),this.message=o,this.key=e}}var ki=pi;class rr{constructor(e,o=[]){this.parent=e,this.bindings={};for(const[c,f]of o)this.bindings[c]=f}concat(e){return new rr(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}var _i=rr;const or={kind:"null"},Ee={kind:"number"},Be={kind:"string"},ee={kind:"boolean"},qe={kind:"color"},St={kind:"object"},en={kind:"value"},jn={kind:"collator"},V={kind:"formatted"},ue={kind:"resolvedImage"};function Xe(r,e){return{kind:"array",itemType:r,N:e}}function _t(r){if("array"===r.kind){const e=_t(r.itemType);return"number"==typeof r.N?`array<${e}, ${r.N}>`:"value"===r.itemType.kind?"array":`array<${e}>`}return r.kind}const Wt=[or,Ee,Be,ee,qe,V,St,Xe(en),ue];function tn(r,e){if("error"===e.kind)return null;if("array"===r.kind){if("array"===e.kind&&(0===e.N&&"value"===e.itemType.kind||!tn(r.itemType,e.itemType))&&("number"!=typeof r.N||r.N===e.N))return null}else{if(r.kind===e.kind)return null;if("value"===r.kind)for(const o of Wt)if(!tn(o,e))return null}return`Expected ${_t(r)} but found ${_t(e)} instead.`}function vn(r,e){return e.some(o=>o.kind===r.kind)}function Vn(r,e){return e.some(o=>"null"===o?null===r:"array"===o?Array.isArray(r):"object"===o?r&&!Array.isArray(r)&&"object"==typeof r:o===typeof r)}var $n,Xn={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function si(r){return(r=Math.round(r))<0?0:r>255?255:r}function fi(r){return si("%"===r[r.length-1]?parseFloat(r)/100*255:parseInt(r))}function yi(r){return(e="%"===r[r.length-1]?parseFloat(r)/100:parseFloat(r))<0?0:e>1?1:e;var e}function Vi(r,e,o){return o<0?o+=1:o>1&&(o-=1),6*o<1?r+(e-r)*o*6:2*o<1?e:3*o<2?r+(e-r)*(2/3-o)*6:r}try{$n={}.parseCSSColor=function(r){var e,o=r.replace(/ /g,"").toLowerCase();if(o in Xn)return Xn[o].slice();if("#"===o[0])return 4===o.length?(e=parseInt(o.substr(1),16))>=0&&e<=4095?[(3840&e)>>4|(3840&e)>>8,240&e|(240&e)>>4,15&e|(15&e)<<4,1]:null:7===o.length&&(e=parseInt(o.substr(1),16))>=0&&e<=16777215?[(16711680&e)>>16,(65280&e)>>8,255&e,1]:null;var c=o.indexOf("("),f=o.indexOf(")");if(-1!==c&&f+1===o.length){var _=o.substr(0,c),v=o.substr(c+1,f-(c+1)).split(","),w=1;switch(_){case"rgba":if(4!==v.length)return null;w=yi(v.pop());case"rgb":return 3!==v.length?null:[fi(v[0]),fi(v[1]),fi(v[2]),w];case"hsla":if(4!==v.length)return null;w=yi(v.pop());case"hsl":if(3!==v.length)return null;var E=(parseFloat(v[0])%360+360)%360/360,M=yi(v[1]),L=yi(v[2]),N=L<=.5?L*(M+1):L+M-L*M,j=2*L-N;return[si(255*Vi(j,N,E+1/3)),si(255*Vi(j,N,E)),si(255*Vi(j,N,E-1/3)),w];default:return null}}return null}}catch{}class Yi{constructor(e,o,c,f=1){this.r=e,this.g=o,this.b=c,this.a=f}static parse(e){if(!e)return;if(e instanceof Yi)return e;if("string"!=typeof e)return;const o=$n(e);return o?new Yi(o[0]/255*o[3],o[1]/255*o[3],o[2]/255*o[3],o[3]):void 0}toString(){const[e,o,c,f]=this.toArray();return`rgba(${Math.round(e)},${Math.round(o)},${Math.round(c)},${f})`}toArray(){const{r:e,g:o,b:c,a:f}=this;return 0===f?[0,0,0,0]:[255*e/f,255*o/f,255*c/f,f]}toArray01(){const{r:e,g:o,b:c,a:f}=this;return 0===f?[0,0,0,0]:[e/f,o/f,c/f,f]}toArray01PremultipliedAlpha(){const{r:e,g:o,b:c,a:f}=this;return[e,o,c,f]}}Yi.black=new Yi(0,0,0,1),Yi.white=new Yi(1,1,1,1),Yi.transparent=new Yi(0,0,0,0),Yi.red=new Yi(1,0,0,1),Yi.blue=new Yi(0,0,1,1);var O=Yi;class Oe{constructor(e,o,c){this.sensitivity=e?o?"variant":"case":o?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,o){return this.collator.compare(e,o)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class ${constructor(e,o,c,f,_){this.text=e.normalize?e.normalize():e,this.image=o,this.scale=c,this.fontStack=f,this.textColor=_}}class Ze{constructor(e){this.sections=e}static fromString(e){return new Ze([new $(e,null,null,null,null)])}isEmpty(){return 0===this.sections.length||!this.sections.some(e=>0!==e.text.length||e.image&&0!==e.image.name.length)}static factory(e){return e instanceof Ze?e:Ze.fromString(e)}toString(){return 0===this.sections.length?"":this.sections.map(e=>e.text).join("")}serialize(){const e=["format"];for(const o of this.sections){if(o.image){e.push(["image",o.image.name]);continue}e.push(o.text);const c={};o.fontStack&&(c["text-font"]=["literal",o.fontStack.split(",")]),o.scale&&(c["font-scale"]=o.scale),o.textColor&&(c["text-color"]=["rgba"].concat(o.textColor.toArray())),e.push(c)}return e}}class Nt{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Nt({name:e,available:!1}):null}serialize(){return["image",this.name]}}function Fi(r,e,o,c){return"number"==typeof r&&r>=0&&r<=255&&"number"==typeof e&&e>=0&&e<=255&&"number"==typeof o&&o>=0&&o<=255?void 0===c||"number"==typeof c&&c>=0&&c<=1?null:`Invalid rgba value [${[r,e,o,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${("number"==typeof c?[r,e,o,c]:[r,e,o]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Sr(r){if(null===r||"string"==typeof r||"boolean"==typeof r||"number"==typeof r||r instanceof O||r instanceof Oe||r instanceof Ze||r instanceof Nt)return!0;if(Array.isArray(r)){for(const e of r)if(!Sr(e))return!1;return!0}if("object"==typeof r){for(const e in r)if(!Sr(r[e]))return!1;return!0}return!1}function Qi(r){if(null===r)return or;if("string"==typeof r)return Be;if("boolean"==typeof r)return ee;if("number"==typeof r)return Ee;if(r instanceof O)return qe;if(r instanceof Oe)return jn;if(r instanceof Ze)return V;if(r instanceof Nt)return ue;if(Array.isArray(r)){const e=r.length;let o;for(const c of r){const f=Qi(c);if(o){if(o===f)continue;o=en;break}o=f}return Xe(o||en,e)}return St}function Dr(r){const e=typeof r;return null===r?"":"string"===e||"number"===e||"boolean"===e?String(r):r instanceof O||r instanceof Ze||r instanceof Nt?r.toString():JSON.stringify(r)}class ho{constructor(e,o){this.type=e,this.value=o}static parse(e,o){if(2!==e.length)return o.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!Sr(e[1]))return o.error("invalid value");const c=e[1];let f=Qi(c);const _=o.expectedType;return"array"!==f.kind||0!==f.N||!_||"array"!==_.kind||"number"==typeof _.N&&0!==_.N||(f=_),new ho(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return"array"===this.type.kind||"object"===this.type.kind?["literal",this.value]:this.value instanceof O?["rgba"].concat(this.value.toArray()):this.value instanceof Ze?this.value.serialize():this.value}}var ji=ho,eo=class{constructor(r){this.name="ExpressionEvaluationError",this.message=r}toJSON(){return this.message}};const Bs={string:Be,number:Ee,boolean:ee,object:St};class Xs{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");let c,f=1;const _=e[0];if("array"===_){let w,E;if(e.length>2){const M=e[1];if("string"!=typeof M||!(M in Bs)||"object"===M)return o.error('The item type argument of "array" must be one of string, number, boolean',1);w=Bs[M],f++}else w=en;if(e.length>3){if(null!==e[2]&&("number"!=typeof e[2]||e[2]<0||e[2]!==Math.floor(e[2])))return o.error('The length argument to "array" must be a positive integer literal',2);E=e[2],f++}c=Xe(w,E)}else c=Bs[_];const v=[];for(;f<e.length;f++){const w=o.parse(e[f],f,en);if(!w)return null;v.push(w)}return new Xs(c,v)}evaluate(e){for(let o=0;o<this.args.length;o++){const c=this.args[o].evaluate(e);if(!tn(this.type,Qi(c)))return c;if(o===this.args.length-1)throw new eo(`Expected value to be of type ${_t(this.type)}, but found ${_t(Qi(c))} instead.`)}return null}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=this.type,o=[e.kind];if("array"===e.kind){const c=e.itemType;if("string"===c.kind||"number"===c.kind||"boolean"===c.kind){o.push(c.kind);const f=e.N;("number"==typeof f||this.args.length>1)&&o.push(f)}}return o.concat(this.args.map(c=>c.serialize()))}}var To=Xs;class $o{constructor(e){this.type=V,this.sections=e}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const c=e[1];if(!Array.isArray(c)&&"object"==typeof c)return o.error("First argument must be an image or text section.");const f=[];let _=!1;for(let v=1;v<=e.length-1;++v){const w=e[v];if(_&&"object"==typeof w&&!Array.isArray(w)){_=!1;let E=null;if(w["font-scale"]&&(E=o.parse(w["font-scale"],1,Ee),!E))return null;let M=null;if(w["text-font"]&&(M=o.parse(w["text-font"],1,Xe(Be)),!M))return null;let L=null;if(w["text-color"]&&(L=o.parse(w["text-color"],1,qe),!L))return null;const N=f[f.length-1];N.scale=E,N.font=M,N.textColor=L}else{const E=o.parse(e[v],1,en);if(!E)return null;const M=E.type.kind;if("string"!==M&&"value"!==M&&"null"!==M&&"resolvedImage"!==M)return o.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");_=!0,f.push({content:E,scale:null,font:null,textColor:null})}}return new $o(f)}evaluate(e){return new Ze(this.sections.map(o=>{const c=o.content.evaluate(e);return Qi(c)===ue?new $("",c,null,null,null):new $(Dr(c),null,o.scale?o.scale.evaluate(e):null,o.font?o.font.evaluate(e).join(","):null,o.textColor?o.textColor.evaluate(e):null)}))}eachChild(e){for(const o of this.sections)e(o.content),o.scale&&e(o.scale),o.font&&e(o.font),o.textColor&&e(o.textColor)}outputDefined(){return!1}serialize(){const e=["format"];for(const o of this.sections){e.push(o.content.serialize());const c={};o.scale&&(c["font-scale"]=o.scale.serialize()),o.font&&(c["text-font"]=o.font.serialize()),o.textColor&&(c["text-color"]=o.textColor.serialize()),e.push(c)}return e}}class ds{constructor(e){this.type=ue,this.input=e}static parse(e,o){if(2!==e.length)return o.error("Expected two arguments.");const c=o.parse(e[1],1,Be);return c?new ds(c):o.error("No image name provided.")}evaluate(e){const o=this.input.evaluate(e),c=Nt.fromString(o);return c&&e.availableImages&&(c.available=e.availableImages.indexOf(o)>-1),c}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const ys={"to-boolean":ee,"to-color":qe,"to-number":Ee,"to-string":Be};class Qs{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expected at least one argument.");const c=e[0];if(("to-boolean"===c||"to-string"===c)&&2!==e.length)return o.error("Expected one argument.");const f=ys[c],_=[];for(let v=1;v<e.length;v++){const w=o.parse(e[v],v,en);if(!w)return null;_.push(w)}return new Qs(f,_)}evaluate(e){if("boolean"===this.type.kind)return!!this.args[0].evaluate(e);if("color"===this.type.kind){let o,c;for(const f of this.args){if(o=f.evaluate(e),c=null,o instanceof O)return o;if("string"==typeof o){const _=e.parseColor(o);if(_)return _}else if(Array.isArray(o)&&(c=o.length<3||o.length>4?`Invalid rbga value ${JSON.stringify(o)}: expected an array containing either three or four numeric values.`:Fi(o[0],o[1],o[2],o[3]),!c))return new O(o[0]/255,o[1]/255,o[2]/255,o[3])}throw new eo(c||`Could not parse color from value '${"string"==typeof o?o:String(JSON.stringify(o))}'`)}if("number"===this.type.kind){let o=null;for(const c of this.args){if(o=c.evaluate(e),null===o)return 0;const f=Number(o);if(!isNaN(f))return f}throw new eo(`Could not convert ${JSON.stringify(o)} to number.`)}return"formatted"===this.type.kind?Ze.fromString(Dr(this.args[0].evaluate(e))):"resolvedImage"===this.type.kind?Nt.fromString(Dr(this.args[0].evaluate(e))):Dr(this.args[0].evaluate(e))}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){if("formatted"===this.type.kind)return new $o([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if("resolvedImage"===this.type.kind)return new ds(this.args[0]).serialize();const e=[`to-${this.type.kind}`];return this.eachChild(o=>{e.push(o.serialize())}),e}}var Mo=Qs;const to=["Unknown","Point","LineString","Polygon"];var fr=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&void 0!==this.feature.id?this.feature.id:null}geometryType(){return this.feature?"number"==typeof this.feature.type?to[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const r=this.featureDistanceData.center,e=this.featureDistanceData.scale,{x:o,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(o*e-r[0])+this.featureDistanceData.bearing[1]*(c*e-r[1])}return 0}parseColor(r){let e=this._parseColorCache[r];return e||(e=this._parseColorCache[r]=O.parse(r)),e}};class vo{constructor(e,o,c,f){this.name=e,this.type=o,this._evaluate=c,this.args=f}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(e=>e.serialize()))}static parse(e,o){const c=e[0],f=vo.definitions[c];if(!f)return o.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const _=Array.isArray(f)?f[0]:f.type,v=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,w=v.filter(([M])=>!Array.isArray(M)||M.length===e.length-1);let E=null;for(const[M,L]of w){E=new ea(o.registry,o.path,null,o.scope);const N=[];let j=!1;for(let W=1;W<e.length;W++){const J=e[W],se=Array.isArray(M)?M[W-1]:M.type,Le=E.parse(J,1+N.length,se);if(!Le){j=!0;break}N.push(Le)}if(!j)if(Array.isArray(M)&&M.length!==N.length)E.error(`Expected ${M.length} arguments, but found ${N.length} instead.`);else{for(let W=0;W<N.length;W++){const J=Array.isArray(M)?M[W]:M.type,se=N[W];E.concat(W+1).checkSubtype(J,se.type)}if(0===E.errors.length)return new vo(c,_,L,N)}}if(1===w.length)o.errors.push(...E.errors);else{const M=(w.length?w:v).map(([N])=>{return j=N,Array.isArray(j)?`(${j.map(_t).join(", ")})`:`(${_t(j.type)}...)`;var j}).join(" | "),L=[];for(let N=1;N<e.length;N++){const j=o.parse(e[N],1+L.length);if(!j)return null;L.push(_t(j.type))}o.error(`Expected arguments of type ${M}, but found (${L.join(", ")}) instead.`)}return null}static register(e,o){vo.definitions=o;for(const c in o)e[c]=vo}}var Yo=vo;class zs{constructor(e,o,c){this.type=jn,this.locale=c,this.caseSensitive=e,this.diacriticSensitive=o}static parse(e,o){if(2!==e.length)return o.error("Expected one argument.");const c=e[1];if("object"!=typeof c||Array.isArray(c))return o.error("Collator options argument must be an object.");const f=o.parse(void 0!==c["case-sensitive"]&&c["case-sensitive"],1,ee);if(!f)return null;const _=o.parse(void 0!==c["diacritic-sensitive"]&&c["diacritic-sensitive"],1,ee);if(!_)return null;let v=null;return c.locale&&(v=o.parse(c.locale,1,Be),!v)?null:new zs(f,_,v)}evaluate(e){return new Oe(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}serialize(){const e={};return e["case-sensitive"]=this.caseSensitive.serialize(),e["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(e.locale=this.locale.serialize()),["collator",e]}}const Po=8192;function Jo(r,e){r[0]=Math.min(r[0],e[0]),r[1]=Math.min(r[1],e[1]),r[2]=Math.max(r[2],e[0]),r[3]=Math.max(r[3],e[1])}function vs(r,e){return!(r[0]<=e[0]||r[2]>=e[2]||r[1]<=e[1]||r[3]>=e[3])}function Ko(r,e){const o=(180+r[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r[1]*Math.PI/360)))/360,f=Math.pow(2,e.z);return[Math.round(o*f*Po),Math.round(c*f*Po)]}function rl(r,e,o){const c=r[0]-e[0],f=r[1]-e[1],_=r[0]-o[0],v=r[1]-o[1];return c*v-_*f==0&&c*_<=0&&f*v<=0}function la(r,e){let o=!1;for(let v=0,w=e.length;v<w;v++){const E=e[v];for(let M=0,L=E.length;M<L-1;M++){if(rl(r,E[M],E[M+1]))return!1;(f=E[M])[1]>(c=r)[1]!=(_=E[M+1])[1]>c[1]&&c[0]<(_[0]-f[0])*(c[1]-f[1])/(_[1]-f[1])+f[0]&&(o=!o)}}var c,f,_;return o}function ca(r,e){for(let o=0;o<e.length;o++)if(la(r,e[o]))return!0;return!1}function Ba(r,e,o,c){const f=c[0]-o[0],_=c[1]-o[1],v=(r[0]-o[0])*_-f*(r[1]-o[1]),w=(e[0]-o[0])*_-f*(e[1]-o[1]);return v>0&&w<0||v<0&&w>0}function xs(r,e,o){for(const M of o)for(let L=0;L<M.length-1;++L)if((w=[(v=M[L+1])[0]-(_=M[L])[0],v[1]-_[1]])[0]*(E=[(f=e)[0]-(c=r)[0],f[1]-c[1]])[1]-w[1]*E[0]!=0&&Ba(c,f,_,v)&&Ba(_,v,c,f))return!0;var c,f,_,v,w,E;return!1}function Wi(r,e){for(let o=0;o<r.length;++o)if(!la(r[o],e))return!1;for(let o=0;o<r.length-1;++o)if(xs(r[o],r[o+1],e))return!1;return!0}function za(r,e){for(let o=0;o<e.length;o++)if(Wi(r,e[o]))return!0;return!1}function Ca(r,e,o){const c=[];for(let f=0;f<r.length;f++){const _=[];for(let v=0;v<r[f].length;v++){const w=Ko(r[f][v],o);Jo(e,w),_.push(w)}c.push(_)}return c}function bl(r,e,o){const c=[];for(let f=0;f<r.length;f++){const _=Ca(r[f],e,o);c.push(_)}return c}function ol(r,e,o,c){if(r[0]<o[0]||r[0]>o[2]){const f=.5*c;let _=r[0]-o[0]>f?-c:o[0]-r[0]>f?c:0;0===_&&(_=r[0]-o[2]>f?-c:o[2]-r[0]>f?c:0),r[0]+=_}Jo(e,r)}function Zl(r,e,o,c){const f=Math.pow(2,c.z)*Po,_=[c.x*Po,c.y*Po],v=[];if(!r)return v;for(const w of r)for(const E of w){const M=[E.x+_[0],E.y+_[1]];ol(M,e,o,f),v.push(M)}return v}function ua(r,e,o,c){const f=Math.pow(2,c.z)*Po,_=[c.x*Po,c.y*Po],v=[];if(!r)return v;for(const E of r){const M=[];for(const L of E){const N=[L.x+_[0],L.y+_[1]];Jo(e,N),M.push(N)}v.push(M)}if(e[2]-e[0]<=f/2){(w=e)[0]=w[1]=1/0,w[2]=w[3]=-1/0;for(const E of v)for(const M of E)ol(M,e,o,f)}var w;return v}class da{constructor(e,o){this.type=ee,this.geojson=e,this.geometries=o}static parse(e,o){if(2!==e.length)return o.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(Sr(e[1])){const c=e[1];if("FeatureCollection"===c.type)for(let f=0;f<c.features.length;++f){const _=c.features[f].geometry.type;if("Polygon"===_||"MultiPolygon"===_)return new da(c,c.features[f].geometry)}else if("Feature"===c.type){const f=c.geometry.type;if("Polygon"===f||"MultiPolygon"===f)return new da(c,c.geometry)}else if("Polygon"===c.type||"MultiPolygon"===c.type)return new da(c,c)}return o.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(null!=e.geometry()&&null!=e.canonicalID()){if("Point"===e.geometryType())return function(o,c){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if("Polygon"===c.type){const w=Ca(c.coordinates,_,v),E=Zl(o.geometry(),f,_,v);if(!vs(f,_))return!1;for(const M of E)if(!la(M,w))return!1}if("MultiPolygon"===c.type){const w=bl(c.coordinates,_,v),E=Zl(o.geometry(),f,_,v);if(!vs(f,_))return!1;for(const M of E)if(!ca(M,w))return!1}return!0}(e,this.geometries);if("LineString"===e.geometryType())return function(o,c){const f=[1/0,1/0,-1/0,-1/0],_=[1/0,1/0,-1/0,-1/0],v=o.canonicalID();if(!v)return!1;if("Polygon"===c.type){const w=Ca(c.coordinates,_,v),E=ua(o.geometry(),f,_,v);if(!vs(f,_))return!1;for(const M of E)if(!Wi(M,w))return!1}if("MultiPolygon"===c.type){const w=bl(c.coordinates,_,v),E=ua(o.geometry(),f,_,v);if(!vs(f,_))return!1;for(const M of E)if(!za(M,w))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var Ua=da;function ja(r){if(r instanceof Yo&&("get"===r.name&&1===r.args.length||"feature-state"===r.name||"has"===r.name&&1===r.args.length||"properties"===r.name||"geometry-type"===r.name||"id"===r.name||/^filter-/.test(r.name))||r instanceof Ua)return!1;let e=!0;return r.eachChild(o=>{e&&!ja(o)&&(e=!1)}),e}function Us(r){if(r instanceof Yo&&"feature-state"===r.name)return!1;let e=!0;return r.eachChild(o=>{e&&!Us(o)&&(e=!1)}),e}function ha(r,e){if(r instanceof Yo&&e.indexOf(r.name)>=0)return!1;let o=!0;return r.eachChild(c=>{o&&!ha(c,e)&&(o=!1)}),o}class Ea{constructor(e,o){this.type=o.type,this.name=e,this.boundExpression=o}static parse(e,o){if(2!==e.length||"string"!=typeof e[1])return o.error("'var' expression requires exactly one string literal argument.");const c=e[1];return o.scope.has(c)?new Ea(c,o.scope.get(c)):o.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var Xo=Ea;class fa{constructor(e,o=[],c,f=new _i,_=[]){this.registry=e,this.path=o,this.key=o.map(v=>`[${v}]`).join(""),this.scope=f,this.errors=_,this.expectedType=c}parse(e,o,c,f,_={}){return o?this.concat(o,c,f)._parse(e,_):this._parse(e,_)}_parse(e,o){function c(f,_,v){return"assert"===v?new To(_,[f]):"coerce"===v?new Mo(_,[f]):f}if(null!==e&&"string"!=typeof e&&"boolean"!=typeof e&&"number"!=typeof e||(e=["literal",e]),Array.isArray(e)){if(0===e.length)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=e[0];if("string"!=typeof f)return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const _=this.registry[f];if(_){let v=_.parse(e,this);if(!v)return null;if(this.expectedType){const w=this.expectedType,E=v.type;if("string"!==w.kind&&"number"!==w.kind&&"boolean"!==w.kind&&"object"!==w.kind&&"array"!==w.kind||"value"!==E.kind)if("color"!==w.kind&&"formatted"!==w.kind&&"resolvedImage"!==w.kind||"value"!==E.kind&&"string"!==E.kind){if(this.checkSubtype(w,E))return null}else v=c(v,w,o.typeAnnotation||"coerce");else v=c(v,w,o.typeAnnotation||"assert")}if(!(v instanceof ji)&&"resolvedImage"!==v.type.kind&&Gl(v)){const w=new fr;try{v=new ji(v.type,v.evaluate(w))}catch(E){return this.error(E.message),null}}return v}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(void 0===e?"'undefined' value invalid. Use null instead.":"object"==typeof e?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,o,c){const f="number"==typeof e?this.path.concat(e):this.path,_=c?this.scope.concat(c):this.scope;return new fa(this.registry,f,o||null,_,this.errors)}error(e,...o){const c=`${this.key}${o.map(f=>`[${f}]`).join("")}`;this.errors.push(new ki(c,e))}checkSubtype(e,o){const c=tn(e,o);return c&&this.error(c),c}}var ea=fa;function Gl(r){if(r instanceof Xo)return Gl(r.boundExpression);if(r instanceof Yo&&"error"===r.name||r instanceof zs||r instanceof Ua)return!1;const e=r instanceof Mo||r instanceof To;let o=!0;return r.eachChild(c=>{o=e?o&&Gl(c):o&&c instanceof ji}),!!o&&ja(r)&&ha(r,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function sl(r,e){const o=r.length-1;let c,f,_=0,v=o,w=0;for(;_<=v;)if(w=Math.floor((_+v)/2),c=r[w],f=r[w+1],c<=e){if(w===o||e<f)return w;_=w+1}else{if(!(c>e))throw new eo("Input is not a number.");v=w-1}return 0}class nr{constructor(e,o,c){this.type=e,this.input=o,this.labels=[],this.outputs=[];for(const[f,_]of c)this.labels.push(f),this.outputs.push(_)}static parse(e,o){if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");const c=o.parse(e[1],1,Ee);if(!c)return null;const f=[];let _=null;o.expectedType&&"value"!==o.expectedType.kind&&(_=o.expectedType);for(let v=1;v<e.length;v+=2){const w=1===v?-1/0:e[v],E=e[v+1],M=v,L=v+1;if("number"!=typeof w)return o.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',M);if(f.length&&f[f.length-1][0]>=w)return o.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',M);const N=o.parse(E,L,_);if(!N)return null;_=_||N.type,f.push([w,N])}return new nr(_,c,f)}evaluate(e){const o=this.labels,c=this.outputs;if(1===o.length)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return c[0].evaluate(e);const _=o.length;return f>=o[_-1]?c[_-1].evaluate(e):c[sl(o,f)].evaluate(e)}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){const e=["step",this.input.serialize()];for(let o=0;o<this.labels.length;o++)o>0&&e.push(this.labels[o]),e.push(this.outputs[o].serialize());return e}}var ro=nr;function Pi(r,e,o){return r*(1-o)+e*o}var Qo=Object.freeze({__proto__:null,array:function(r,e,o){return r.map((c,f)=>Pi(c,e[f],o))},color:function(r,e,o){return new O(Pi(r.r,e.r,o),Pi(r.g,e.g,o),Pi(r.b,e.b,o),Pi(r.a,e.a,o))},number:Pi});const ce=4/29,G=6/29,Ge=3*G*G,zt=G*G*G,ni=Math.PI/180,Ln=180/Math.PI;function Di(r){return r>zt?Math.pow(r,1/3):r/Ge+ce}function zr(r){return r>G?r*r*r:Ge*(r-ce)}function Oo(r){return 255*(r<=.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055)}function Do(r){return(r/=255)<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4)}function bs(r){const e=Do(r.r),o=Do(r.g),c=Do(r.b),f=Di((.4124564*e+.3575761*o+.1804375*c)/.95047),_=Di((.2126729*e+.7151522*o+.072175*c)/1);return{l:116*_-16,a:500*(f-_),b:200*(_-Di((.0193339*e+.119192*o+.9503041*c)/1.08883)),alpha:r.a}}function al(r){let e=(r.l+16)/116,o=isNaN(r.a)?e:e+r.a/500,c=isNaN(r.b)?e:e-r.b/200;return e=1*zr(e),o=.95047*zr(o),c=1.08883*zr(c),new O(Oo(3.2404542*o-1.5371385*e-.4985314*c),Oo(-.969266*o+1.8760108*e+.041556*c),Oo(.0556434*o-.2040259*e+1.0572252*c),r.alpha)}function $r(r,e,o){const c=e-r;return r+o*(c>180||c<-180?c-360*Math.round(c/360):c)}const xo={forward:bs,reverse:al,interpolate:function(r,e,o){return{l:Pi(r.l,e.l,o),a:Pi(r.a,e.a,o),b:Pi(r.b,e.b,o),alpha:Pi(r.alpha,e.alpha,o)}}},Ro={forward:function(r){const{l:e,a:o,b:c}=bs(r),f=Math.atan2(c,o)*Ln;return{h:f<0?f+360:f,c:Math.sqrt(o*o+c*c),l:e,alpha:r.a}},reverse:function(r){const e=r.h*ni,o=r.c;return al({l:r.l,a:Math.cos(e)*o,b:Math.sin(e)*o,alpha:r.alpha})},interpolate:function(r,e,o){return{h:$r(r.h,e.h,o),c:Pi(r.c,e.c,o),l:Pi(r.l,e.l,o),alpha:Pi(r.alpha,e.alpha,o)}}};var Ui=Object.freeze({__proto__:null,hcl:Ro,lab:xo});class js{constructor(e,o,c,f,_){this.type=e,this.operator=o,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[v,w]of _)this.labels.push(v),this.outputs.push(w)}static interpolationFactor(e,o,c,f){let _=0;if("exponential"===e.name)_=wl(o,e.base,c,f);else if("linear"===e.name)_=wl(o,1,c,f);else if("cubic-bezier"===e.name){const v=e.controlPoints;_=new xe(v[0],v[1],v[2],v[3]).solve(wl(o,1,c,f))}return _}static parse(e,o){let[c,f,_,...v]=e;if(!Array.isArray(f)||0===f.length)return o.error("Expected an interpolation type expression.",1);if("linear"===f[0])f={name:"linear"};else if("exponential"===f[0]){const M=f[1];if("number"!=typeof M)return o.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:M}}else{if("cubic-bezier"!==f[0])return o.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const M=f.slice(1);if(4!==M.length||M.some(L=>"number"!=typeof L||L<0||L>1))return o.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:M}}}if(e.length-1<4)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return o.error("Expected an even number of arguments.");if(_=o.parse(_,2,Ee),!_)return null;const w=[];let E=null;"interpolate-hcl"===c||"interpolate-lab"===c?E=qe:o.expectedType&&"value"!==o.expectedType.kind&&(E=o.expectedType);for(let M=0;M<v.length;M+=2){const L=v[M],N=v[M+1],j=M+3,W=M+4;if("number"!=typeof L)return o.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',j);if(w.length&&w[w.length-1][0]>=L)return o.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',j);const J=o.parse(N,W,E);if(!J)return null;E=E||J.type,w.push([L,J])}return"number"===E.kind||"color"===E.kind||"array"===E.kind&&"number"===E.itemType.kind&&"number"==typeof E.N?new js(E,c,f,_,w):o.error(`Type ${_t(E)} is not interpolatable.`)}evaluate(e){const o=this.labels,c=this.outputs;if(1===o.length)return c[0].evaluate(e);const f=this.input.evaluate(e);if(f<=o[0])return c[0].evaluate(e);const _=o.length;if(f>=o[_-1])return c[_-1].evaluate(e);const v=sl(o,f),w=js.interpolationFactor(this.interpolation,f,o[v],o[v+1]),E=c[v].evaluate(e),M=c[v+1].evaluate(e);return"interpolate"===this.operator?Qo[this.type.kind.toLowerCase()](E,M,w):"interpolate-hcl"===this.operator?Ro.reverse(Ro.interpolate(Ro.forward(E),Ro.forward(M),w)):xo.reverse(xo.interpolate(xo.forward(E),xo.forward(M),w))}eachChild(e){e(this.input);for(const o of this.outputs)e(o)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}serialize(){let e;e="linear"===this.interpolation.name?["linear"]:"exponential"===this.interpolation.name?1===this.interpolation.base?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const o=[this.operator,e,this.input.serialize()];for(let c=0;c<this.labels.length;c++)o.push(this.labels[c],this.outputs[c].serialize());return o}}function wl(r,e,o,c){const f=c-o,_=r-o;return 0===f?0:1===e?_/f:(Math.pow(e,_)-1)/(Math.pow(e,f)-1)}var No=js;class kr{constructor(e,o){this.type=e,this.args=o}static parse(e,o){if(e.length<2)return o.error("Expectected at least one argument.");let c=null;const f=o.expectedType;f&&"value"!==f.kind&&(c=f);const _=[];for(const w of e.slice(1)){const E=o.parse(w,1+_.length,c,void 0,{typeAnnotation:"omit"});if(!E)return null;c=c||E.type,_.push(E)}const v=f&&_.some(w=>tn(f,w.type));return new kr(v?en:c,_)}evaluate(e){let o,c=null,f=0;for(const _ of this.args){if(f++,c=_.evaluate(e),c&&c instanceof Nt&&!c.available&&(o||(o=c),c=null,f===this.args.length))return o;if(null!==c)break}return c}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}serialize(){const e=["coalesce"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var ws=kr;class pa{constructor(e,o){this.type=o.type,this.bindings=[].concat(e),this.result=o}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const o of this.bindings)e(o[1]);e(this.result)}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const c=[];for(let _=1;_<e.length-1;_+=2){const v=e[_];if("string"!=typeof v)return o.error(`Expected string, but found ${typeof v} instead.`,_);if(/[^a-zA-Z0-9_]/.test(v))return o.error("Variable names must contain only alphanumeric characters or '_'.",_);const w=o.parse(e[_+1],_+1);if(!w)return null;c.push([v,w])}const f=o.parse(e[e.length-1],e.length-1,o.expectedType,c);return f?new pa(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const e=["let"];for(const[o,c]of this.bindings)e.push(o,c.serialize());return e.push(this.result.serialize()),e}}var Vs=pa;class ma{constructor(e,o,c){this.type=e,this.index=o,this.input=c}static parse(e,o){if(3!==e.length)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,Ee),f=o.parse(e[2],2,Xe(o.expectedType||en));return c&&f?new ma(f.type.itemType,c,f):null}evaluate(e){const o=this.index.evaluate(e),c=this.input.evaluate(e);if(o<0)throw new eo(`Array index out of bounds: ${o} < 0.`);if(o>=c.length)throw new eo(`Array index out of bounds: ${o} > ${c.length-1}.`);if(o!==Math.floor(o))throw new eo(`Array index must be an integer, but found ${o} instead.`);return c[o]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Hl=ma;class $s{constructor(e,o){this.type=ee,this.needle=e,this.haystack=o}static parse(e,o){if(3!==e.length)return o.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,en),f=o.parse(e[2],2,en);return c&&f?vn(c.type,[ee,Be,Ee,or,en])?new $s(c,f):o.error(`Expected first argument to be of type boolean, string, number or null, but found ${_t(c.type)} instead`):null}evaluate(e){const o=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(null==c)return!1;if(!Vn(o,["boolean","string","number","null"]))throw new eo(`Expected first argument to be of type boolean, string, number or null, but found ${_t(Qi(o))} instead.`);if(!Vn(c,["string","array"]))throw new eo(`Expected second argument to be of type array or string, but found ${_t(Qi(c))} instead.`);return c.indexOf(o)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var Va=$s;class es{constructor(e,o,c){this.type=Ee,this.needle=e,this.haystack=o,this.fromIndex=c}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,en),f=o.parse(e[2],2,en);if(!c||!f)return null;if(!vn(c.type,[ee,Be,Ee,or,en]))return o.error(`Expected first argument to be of type boolean, string, number or null, but found ${_t(c.type)} instead`);if(4===e.length){const _=o.parse(e[3],3,Ee);return _?new es(c,f,_):null}return new es(c,f)}evaluate(e){const o=this.needle.evaluate(e),c=this.haystack.evaluate(e);if(!Vn(o,["boolean","string","number","null"]))throw new eo(`Expected first argument to be of type boolean, string, number or null, but found ${_t(Qi(o))} instead.`);if(!Vn(c,["string","array"]))throw new eo(`Expected second argument to be of type array or string, but found ${_t(Qi(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(e);return c.indexOf(o,f)}return c.indexOf(o)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}serialize(){if(null!=this.fromIndex&&void 0!==this.fromIndex){const e=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),e]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Gi=es;class ta{constructor(e,o,c,f,_,v){this.inputType=e,this.type=o,this.input=c,this.cases=f,this.outputs=_,this.otherwise=v}static parse(e,o){if(e.length<5)return o.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return o.error("Expected an even number of arguments.");let c,f;o.expectedType&&"value"!==o.expectedType.kind&&(f=o.expectedType);const _={},v=[];for(let M=2;M<e.length-1;M+=2){let L=e[M];const N=e[M+1];Array.isArray(L)||(L=[L]);const j=o.concat(M);if(0===L.length)return j.error("Expected at least one branch label.");for(const J of L){if("number"!=typeof J&&"string"!=typeof J)return j.error("Branch labels must be numbers or strings.");if("number"==typeof J&&Math.abs(J)>Number.MAX_SAFE_INTEGER)return j.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if("number"==typeof J&&Math.floor(J)!==J)return j.error("Numeric branch labels must be integer values.");if(c){if(j.checkSubtype(c,Qi(J)))return null}else c=Qi(J);if(void 0!==_[String(J)])return j.error("Branch labels must be unique.");_[String(J)]=v.length}const W=o.parse(N,M,f);if(!W)return null;f=f||W.type,v.push(W)}const w=o.parse(e[1],1,en);if(!w)return null;const E=o.parse(e[e.length-1],e.length-1,f);return E?"value"!==w.type.kind&&o.concat(1).checkSubtype(c,w.type)?null:new ta(c,f,w,_,v,E):null}evaluate(e){const o=this.input.evaluate(e);return(Qi(o)===this.inputType&&this.outputs[this.cases[o]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["match",this.input.serialize()],o=Object.keys(this.cases).sort(),c=[],f={};for(const v of o){const w=f[this.cases[v]];void 0===w?(f[this.cases[v]]=c.length,c.push([this.cases[v],[v]])):c[w][1].push(v)}const _=v=>"number"===this.inputType.kind?Number(v):v;for(const[v,w]of c)e.push(1===w.length?_(w[0]):w.map(_)),e.push(this.outputs[v].serialize());return e.push(this.otherwise.serialize()),e}}var Wl=ta;class Cs{constructor(e,o,c){this.type=e,this.branches=o,this.otherwise=c}static parse(e,o){if(e.length<4)return o.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return o.error("Expected an odd number of arguments.");let c;o.expectedType&&"value"!==o.expectedType.kind&&(c=o.expectedType);const f=[];for(let v=1;v<e.length-1;v+=2){const w=o.parse(e[v],v,ee);if(!w)return null;const E=o.parse(e[v+1],v+1,c);if(!E)return null;f.push([w,E]),c=c||E.type}const _=o.parse(e[e.length-1],e.length-1,c);return _?new Cs(c,f,_):null}evaluate(e){for(const[o,c]of this.branches)if(o.evaluate(e))return c.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[o,c]of this.branches)e(o),e(c);e(this.otherwise)}outputDefined(){return this.branches.every(([e,o])=>o.outputDefined())&&this.otherwise.outputDefined()}serialize(){const e=["case"];return this.eachChild(o=>{e.push(o.serialize())}),e}}var Cl=Cs;class na{constructor(e,o,c,f){this.type=e,this.input=o,this.beginIndex=c,this.endIndex=f}static parse(e,o){if(e.length<=2||e.length>=5)return o.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const c=o.parse(e[1],1,en),f=o.parse(e[2],2,Ee);if(!c||!f)return null;if(!vn(c.type,[Xe(en),Be,en]))return o.error(`Expected first argument to be of type array or string, but found ${_t(c.type)} instead`);if(4===e.length){const _=o.parse(e[3],3,Ee);return _?new na(c.type,c,f,_):null}return new na(c.type,c,f)}evaluate(e){const o=this.input.evaluate(e),c=this.beginIndex.evaluate(e);if(!Vn(o,["string","array"]))throw new eo(`Expected first argument to be of type array or string, but found ${_t(Qi(o))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(e);return o.slice(c,f)}return o.slice(c)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}serialize(){if(null!=this.endIndex&&void 0!==this.endIndex){const e=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),e]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var oo=na;function $a(r,e){return"=="===r||"!="===r?"boolean"===e.kind||"string"===e.kind||"number"===e.kind||"null"===e.kind||"value"===e.kind:"string"===e.kind||"number"===e.kind||"value"===e.kind}function Io(r,e,o,c){return 0===c.compare(e,o)}function fo(r,e,o){const c="=="!==r&&"!="!==r;return class dC{constructor(_,v,w){this.type=ee,this.lhs=_,this.rhs=v,this.collator=w,this.hasUntypedArgument="value"===_.type.kind||"value"===v.type.kind}static parse(_,v){if(3!==_.length&&4!==_.length)return v.error("Expected two or three arguments.");const w=_[0];let E=v.parse(_[1],1,en);if(!E)return null;if(!$a(w,E.type))return v.concat(1).error(`"${w}" comparisons are not supported for type '${_t(E.type)}'.`);let M=v.parse(_[2],2,en);if(!M)return null;if(!$a(w,M.type))return v.concat(2).error(`"${w}" comparisons are not supported for type '${_t(M.type)}'.`);if(E.type.kind!==M.type.kind&&"value"!==E.type.kind&&"value"!==M.type.kind)return v.error(`Cannot compare types '${_t(E.type)}' and '${_t(M.type)}'.`);c&&("value"===E.type.kind&&"value"!==M.type.kind?E=new To(M.type,[E]):"value"!==E.type.kind&&"value"===M.type.kind&&(M=new To(E.type,[M])));let L=null;if(4===_.length){if("string"!==E.type.kind&&"string"!==M.type.kind&&"value"!==E.type.kind&&"value"!==M.type.kind)return v.error("Cannot use collator to compare non-string types.");if(L=v.parse(_[3],3,jn),!L)return null}return new dC(E,M,L)}evaluate(_){const v=this.lhs.evaluate(_),w=this.rhs.evaluate(_);if(c&&this.hasUntypedArgument){const E=Qi(v),M=Qi(w);if(E.kind!==M.kind||"string"!==E.kind&&"number"!==E.kind)throw new eo(`Expected arguments for "${r}" to be (string, string) or (number, number), but found (${E.kind}, ${M.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const E=Qi(v),M=Qi(w);if("string"!==E.kind||"string"!==M.kind)return e(_,v,w)}return this.collator?o(_,v,w,this.collator.evaluate(_)):e(_,v,w)}eachChild(_){_(this.lhs),_(this.rhs),this.collator&&_(this.collator)}outputDefined(){return!0}serialize(){const _=[r];return this.eachChild(v=>{_.push(v.serialize())}),_}}}const El=fo("==",function(r,e,o){return e===o},Io),Za=fo("!=",function(r,e,o){return e!==o},function(r,e,o,c){return!Io(0,e,o,c)}),ql=fo("<",function(r,e,o){return e<o},function(r,e,o,c){return c.compare(e,o)<0}),Zs=fo(">",function(r,e,o){return e>o},function(r,e,o,c){return c.compare(e,o)>0}),gc=fo("<=",function(r,e,o){return e<=o},function(r,e,o,c){return c.compare(e,o)<=0}),Tl=fo(">=",function(r,e,o){return e>=o},function(r,e,o,c){return c.compare(e,o)>=0});class Yl{constructor(e,o,c,f,_,v){this.type=Be,this.number=e,this.locale=o,this.currency=c,this.unit=f,this.minFractionDigits=_,this.maxFractionDigits=v}static parse(e,o){if(3!==e.length)return o.error("Expected two arguments.");const c=o.parse(e[1],1,Ee);if(!c)return null;const f=e[2];if("object"!=typeof f||Array.isArray(f))return o.error("NumberFormat options argument must be an object.");let _=null;if(f.locale&&(_=o.parse(f.locale,1,Be),!_))return null;let v=null;if(f.currency&&(v=o.parse(f.currency,1,Be),!v))return null;let w=null;if(f.unit&&(w=o.parse(f.unit,1,Be),!w))return null;let E=null;if(f["min-fraction-digits"]&&(E=o.parse(f["min-fraction-digits"],1,Ee),!E))return null;let M=null;return f["max-fraction-digits"]&&(M=o.parse(f["max-fraction-digits"],1,Ee),!M)?null:new Yl(c,_,v,w,E,M)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(e):void 0,unit:this.unit?this.unit.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.unit&&e(this.unit),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const e={};return this.locale&&(e.locale=this.locale.serialize()),this.currency&&(e.currency=this.currency.serialize()),this.unit&&(e.unit=this.unit.serialize()),this.minFractionDigits&&(e["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(e["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),e]}}class Ta{constructor(e){this.type=Ee,this.input=e}static parse(e,o){if(2!==e.length)return o.error(`Expected 1 argument, but found ${e.length-1} instead.`);const c=o.parse(e[1],1);return c?"array"!==c.type.kind&&"string"!==c.type.kind&&"value"!==c.type.kind?o.error(`Expected argument of type string or array, but found ${_t(c.type)} instead.`):new Ta(c):null}evaluate(e){const o=this.input.evaluate(e);if("string"==typeof o||Array.isArray(o))return o.length;throw new eo(`Expected value to be of type string or array, but found ${_t(Qi(o))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}serialize(){const e=["length"];return this.eachChild(o=>{e.push(o.serialize())}),e}}const _c={"==":El,"!=":Za,">":Zs,"<":ql,">=":Tl,"<=":gc,array:To,at:Hl,boolean:To,case:Cl,coalesce:ws,collator:zs,format:$o,image:ds,in:Va,"index-of":Gi,interpolate:No,"interpolate-hcl":No,"interpolate-lab":No,length:Ta,let:Vs,literal:ji,match:Wl,number:To,"number-format":Yl,object:To,slice:oo,step:ro,string:To,"to-boolean":Mo,"to-color":Mo,"to-number":Mo,"to-string":Mo,var:Xo,within:Ua};function Zc(r,[e,o,c,f]){e=e.evaluate(r),o=o.evaluate(r),c=c.evaluate(r);const _=f?f.evaluate(r):1,v=Fi(e,o,c,_);if(v)throw new eo(v);return new O(e/255*_,o/255*_,c/255*_,_)}function Gs(r,e){return r in e}function Ga(r,e){const o=e[r];return void 0===o?null:o}function Hs(r){return{type:r}}Yo.register(_c,{error:[{kind:"error"},[Be],(r,[e])=>{throw new eo(e.evaluate(r))}],typeof:[Be,[en],(r,[e])=>_t(Qi(e.evaluate(r)))],"to-rgba":[Xe(Ee,4),[qe],(r,[e])=>e.evaluate(r).toArray()],rgb:[qe,[Ee,Ee,Ee],Zc],rgba:[qe,[Ee,Ee,Ee,Ee],Zc],has:{type:ee,overloads:[[[Be],(r,[e])=>Gs(e.evaluate(r),r.properties())],[[Be,St],(r,[e,o])=>Gs(e.evaluate(r),o.evaluate(r))]]},get:{type:en,overloads:[[[Be],(r,[e])=>Ga(e.evaluate(r),r.properties())],[[Be,St],(r,[e,o])=>Ga(e.evaluate(r),o.evaluate(r))]]},"feature-state":[en,[Be],(r,[e])=>Ga(e.evaluate(r),r.featureState||{})],properties:[St,[],r=>r.properties()],"geometry-type":[Be,[],r=>r.geometryType()],id:[en,[],r=>r.id()],zoom:[Ee,[],r=>r.globals.zoom],pitch:[Ee,[],r=>r.globals.pitch||0],"distance-from-center":[Ee,[],r=>r.distanceFromCenter()],"heatmap-density":[Ee,[],r=>r.globals.heatmapDensity||0],"line-progress":[Ee,[],r=>r.globals.lineProgress||0],"sky-radial-progress":[Ee,[],r=>r.globals.skyRadialProgress||0],accumulated:[en,[],r=>void 0===r.globals.accumulated?null:r.globals.accumulated],"+":[Ee,Hs(Ee),(r,e)=>{let o=0;for(const c of e)o+=c.evaluate(r);return o}],"*":[Ee,Hs(Ee),(r,e)=>{let o=1;for(const c of e)o*=c.evaluate(r);return o}],"-":{type:Ee,overloads:[[[Ee,Ee],(r,[e,o])=>e.evaluate(r)-o.evaluate(r)],[[Ee],(r,[e])=>-e.evaluate(r)]]},"/":[Ee,[Ee,Ee],(r,[e,o])=>e.evaluate(r)/o.evaluate(r)],"%":[Ee,[Ee,Ee],(r,[e,o])=>e.evaluate(r)%o.evaluate(r)],ln2:[Ee,[],()=>Math.LN2],pi:[Ee,[],()=>Math.PI],e:[Ee,[],()=>Math.E],"^":[Ee,[Ee,Ee],(r,[e,o])=>Math.pow(e.evaluate(r),o.evaluate(r))],sqrt:[Ee,[Ee],(r,[e])=>Math.sqrt(e.evaluate(r))],log10:[Ee,[Ee],(r,[e])=>Math.log(e.evaluate(r))/Math.LN10],ln:[Ee,[Ee],(r,[e])=>Math.log(e.evaluate(r))],log2:[Ee,[Ee],(r,[e])=>Math.log(e.evaluate(r))/Math.LN2],sin:[Ee,[Ee],(r,[e])=>Math.sin(e.evaluate(r))],cos:[Ee,[Ee],(r,[e])=>Math.cos(e.evaluate(r))],tan:[Ee,[Ee],(r,[e])=>Math.tan(e.evaluate(r))],asin:[Ee,[Ee],(r,[e])=>Math.asin(e.evaluate(r))],acos:[Ee,[Ee],(r,[e])=>Math.acos(e.evaluate(r))],atan:[Ee,[Ee],(r,[e])=>Math.atan(e.evaluate(r))],min:[Ee,Hs(Ee),(r,e)=>Math.min(...e.map(o=>o.evaluate(r)))],max:[Ee,Hs(Ee),(r,e)=>Math.max(...e.map(o=>o.evaluate(r)))],abs:[Ee,[Ee],(r,[e])=>Math.abs(e.evaluate(r))],round:[Ee,[Ee],(r,[e])=>{const o=e.evaluate(r);return o<0?-Math.round(-o):Math.round(o)}],floor:[Ee,[Ee],(r,[e])=>Math.floor(e.evaluate(r))],ceil:[Ee,[Ee],(r,[e])=>Math.ceil(e.evaluate(r))],"filter-==":[ee,[Be,en],(r,[e,o])=>r.properties()[e.value]===o.value],"filter-id-==":[ee,[en],(r,[e])=>r.id()===e.value],"filter-type-==":[ee,[Be],(r,[e])=>r.geometryType()===e.value],"filter-<":[ee,[Be,en],(r,[e,o])=>{const c=r.properties()[e.value],f=o.value;return typeof c==typeof f&&c<f}],"filter-id-<":[ee,[en],(r,[e])=>{const o=r.id(),c=e.value;return typeof o==typeof c&&o<c}],"filter->":[ee,[Be,en],(r,[e,o])=>{const c=r.properties()[e.value],f=o.value;return typeof c==typeof f&&c>f}],"filter-id->":[ee,[en],(r,[e])=>{const o=r.id(),c=e.value;return typeof o==typeof c&&o>c}],"filter-<=":[ee,[Be,en],(r,[e,o])=>{const c=r.properties()[e.value],f=o.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[ee,[en],(r,[e])=>{const o=r.id(),c=e.value;return typeof o==typeof c&&o<=c}],"filter->=":[ee,[Be,en],(r,[e,o])=>{const c=r.properties()[e.value],f=o.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[ee,[en],(r,[e])=>{const o=r.id(),c=e.value;return typeof o==typeof c&&o>=c}],"filter-has":[ee,[en],(r,[e])=>e.value in r.properties()],"filter-has-id":[ee,[],r=>null!==r.id()&&void 0!==r.id()],"filter-type-in":[ee,[Xe(Be)],(r,[e])=>e.value.indexOf(r.geometryType())>=0],"filter-id-in":[ee,[Xe(en)],(r,[e])=>e.value.indexOf(r.id())>=0],"filter-in-small":[ee,[Be,Xe(en)],(r,[e,o])=>o.value.indexOf(r.properties()[e.value])>=0],"filter-in-large":[ee,[Be,Xe(en)],(r,[e,o])=>function(c,f,_,v){for(;_<=v;){const w=_+v>>1;if(f[w]===c)return!0;f[w]>c?v=w-1:_=w+1}return!1}(r.properties()[e.value],o.value,0,o.value.length-1)],all:{type:ee,overloads:[[[ee,ee],(r,[e,o])=>e.evaluate(r)&&o.evaluate(r)],[Hs(ee),(r,e)=>{for(const o of e)if(!o.evaluate(r))return!1;return!0}]]},any:{type:ee,overloads:[[[ee,ee],(r,[e,o])=>e.evaluate(r)||o.evaluate(r)],[Hs(ee),(r,e)=>{for(const o of e)if(o.evaluate(r))return!0;return!1}]]},"!":[ee,[ee],(r,[e])=>!e.evaluate(r)],"is-supported-script":[ee,[Be],(r,[e])=>{const o=r.globals&&r.globals.isSupportedScript;return!o||o(e.evaluate(r))}],upcase:[Be,[Be],(r,[e])=>e.evaluate(r).toUpperCase()],downcase:[Be,[Be],(r,[e])=>e.evaluate(r).toLowerCase()],concat:[Be,Hs(en),(r,e)=>e.map(o=>Dr(o.evaluate(r))).join("")],"resolved-locale":[Be,[jn],(r,[e])=>e.evaluate(r).resolvedLocale()]});var F=_c;function we(r){return{result:"success",value:r}}function H(r){return{result:"error",value:r}}function le(r){return"data-driven"===r["property-type"]}function wt(r){return!!r.expression&&r.expression.parameters.indexOf("zoom")>-1}function yn(r){return!!r.expression&&r.expression.interpolated}function xn(r){return r instanceof Number?"number":r instanceof String?"string":r instanceof Boolean?"boolean":Array.isArray(r)?"array":null===r?"null":typeof r}function xi(r){return"object"==typeof r&&null!==r&&!Array.isArray(r)}function Jr(r){return r}function Pr(r,e){const o="color"===e.type,c=r.stops&&"object"==typeof r.stops[0][0],f=c||!(c||void 0!==r.property),_=r.type||(yn(e)?"exponential":"interval");if(o&&((r=Hn({},r)).stops&&(r.stops=r.stops.map(M=>[M[0],O.parse(M[1])])),r.default=O.parse(r.default?r.default:e.default)),r.colorSpace&&"rgb"!==r.colorSpace&&!Ui[r.colorSpace])throw new Error(`Unknown color space: ${r.colorSpace}`);let v,w,E;if("exponential"===_)v=_r;else if("interval"===_)v=Kr;else if("categorical"===_){v=ir,w=Object.create(null);for(const M of r.stops)w[M[0]]=M[1];E=typeof r.stops[0][0]}else{if("identity"!==_)throw new Error(`Unknown function type "${_}"`);v=so}if(c){const M={},L=[];for(let W=0;W<r.stops.length;W++){const J=r.stops[W],se=J[0].zoom;void 0===M[se]&&(M[se]={zoom:se,type:r.type,property:r.property,default:r.default,stops:[]},L.push(se)),M[se].stops.push([J[0].value,J[1]])}const N=[];for(const W of L)N.push([M[W].zoom,Pr(M[W],e)]);const j={name:"linear"};return{kind:"composite",interpolationType:j,interpolationFactor:No.interpolationFactor.bind(void 0,j),zoomStops:N.map(W=>W[0]),evaluate:({zoom:W},J)=>_r({stops:N,base:r.base},e,W).evaluate(W,J)}}if(f){const M="exponential"===_?{name:"exponential",base:void 0!==r.base?r.base:1}:null;return{kind:"camera",interpolationType:M,interpolationFactor:No.interpolationFactor.bind(void 0,M),zoomStops:r.stops.map(L=>L[0]),evaluate:({zoom:L})=>v(r,e,L,w,E)}}return{kind:"source",evaluate(M,L){const N=L&&L.properties?L.properties[r.property]:void 0;return void 0===N?xr(r.default,e.default):v(r,e,N,w,E)}}}function xr(r,e,o){return void 0!==r?r:void 0!==e?e:void 0!==o?o:void 0}function ir(r,e,o,c,f){return xr(typeof o===f?c[o]:void 0,r.default,e.default)}function Kr(r,e,o){if("number"!==xn(o))return xr(r.default,e.default);const c=r.stops.length;if(1===c||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[c-1][0])return r.stops[c-1][1];const f=sl(r.stops.map(_=>_[0]),o);return r.stops[f][1]}function _r(r,e,o){const c=void 0!==r.base?r.base:1;if("number"!==xn(o))return xr(r.default,e.default);const f=r.stops.length;if(1===f||o<=r.stops[0][0])return r.stops[0][1];if(o>=r.stops[f-1][0])return r.stops[f-1][1];const _=sl(r.stops.map(L=>L[0]),o),v=function(L,N,j,W){const J=W-j,se=L-j;return 0===J?0:1===N?se/J:(Math.pow(N,se)-1)/(Math.pow(N,J)-1)}(o,c,r.stops[_][0],r.stops[_+1][0]),w=r.stops[_][1],E=r.stops[_+1][1];let M=Qo[e.type]||Jr;if(r.colorSpace&&"rgb"!==r.colorSpace){const L=Ui[r.colorSpace];M=(N,j)=>L.reverse(L.interpolate(L.forward(N),L.forward(j),v))}return"function"==typeof w.evaluate?{evaluate(...L){const N=w.evaluate.apply(void 0,L),j=E.evaluate.apply(void 0,L);if(void 0!==N&&void 0!==j)return M(N,j,v)}}:M(w,E,v)}function so(r,e,o){return"color"===e.type?o=O.parse(o):"formatted"===e.type?o=Ze.fromString(o.toString()):"resolvedImage"===e.type?o=Nt.fromString(o.toString()):xn(o)===e.type||"enum"===e.type&&e.values[o]||(o=void 0),xr(o,r.default,e.default)}class Bo{constructor(e,o){var c;this.expression=e,this._warningHistory={},this._evaluator=new fr,this._defaultValue=o?"color"===(c=o).type&&(xi(c.default)||Array.isArray(c.default))?new O(0,0,0,0):"color"===c.type?O.parse(c.default)||null:void 0===c.default?null:c.default:null,this._enumValues=o&&"enum"===o.type?o.values:null}evaluateWithoutErrorHandling(e,o,c,f,_,v,w,E){return this._evaluator.globals=e,this._evaluator.feature=o,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=E||null,this.expression.evaluate(this._evaluator)}evaluate(e,o,c,f,_,v,w,E){this._evaluator.globals=e,this._evaluator.feature=o||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=_||null,this._evaluator.formattedSection=v||null,this._evaluator.featureTileCoord=w||null,this._evaluator.featureDistanceData=E||null;try{const M=this.expression.evaluate(this._evaluator);if(null==M||"number"==typeof M&&M!=M)return this._defaultValue;if(this._enumValues&&!(M in this._enumValues))throw new eo(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(M)} instead.`);return M}catch(M){return this._warningHistory[M.message]||(this._warningHistory[M.message]=!0,typeof console<"u"&&console.warn(M.message)),this._defaultValue}}}function ao(r){return Array.isArray(r)&&r.length>0&&"string"==typeof r[0]&&r[0]in F}function Es(r,e){const o=new ea(F,[],e?function(f){const _={color:qe,string:Be,number:Ee,enum:Be,boolean:ee,formatted:V,resolvedImage:ue};return"array"===f.type?Xe(_[f.value]||en,f.length):_[f.type]}(e):void 0),c=o.parse(r,void 0,void 0,void 0,e&&"string"===e.type?{typeAnnotation:"coerce"}:void 0);return c?we(new Bo(c,e)):H(o.errors)}class Ts{constructor(e,o){this.kind=e,this._styleExpression=o,this.isStateDependent="constant"!==e&&!Us(o.expression)}evaluateWithoutErrorHandling(e,o,c,f,_,v){return this._styleExpression.evaluateWithoutErrorHandling(e,o,c,f,_,v)}evaluate(e,o,c,f,_,v){return this._styleExpression.evaluate(e,o,c,f,_,v)}}class Zo{constructor(e,o,c,f){this.kind=e,this.zoomStops=c,this._styleExpression=o,this.isStateDependent="camera"!==e&&!Us(o.expression),this.interpolationType=f}evaluateWithoutErrorHandling(e,o,c,f,_,v){return this._styleExpression.evaluateWithoutErrorHandling(e,o,c,f,_,v)}evaluate(e,o,c,f,_,v){return this._styleExpression.evaluate(e,o,c,f,_,v)}interpolationFactor(e,o,c){return this.interpolationType?No.interpolationFactor(this.interpolationType,e,o,c):0}}function zo(r,e){if("error"===(r=Es(r,e)).result)return r;const o=r.value.expression,c=ja(o);if(!c&&!le(e))return H([new ki("","data expressions not supported")]);const f=ha(o,["zoom","pitch","distance-from-center"]);if(!f&&!wt(e))return H([new ki("","zoom expressions not supported")]);const _=Da(o);return _||f?_ instanceof ki?H([_]):_ instanceof No&&!yn(e)?H([new ki("",'"interpolate" expressions cannot be used with this property')]):we(_?new Zo(c?"camera":"composite",r.value,_.labels,_ instanceof No?_.interpolation:void 0):new Ts(c?"constant":"source",r.value)):H([new ki("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class ia{constructor(e,o){this._parameters=e,this._specification=o,Hn(this,Pr(this._parameters,this._specification))}static deserialize(e){return new ia(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function Da(r){let e=null;if(r instanceof Vs)e=Da(r.result);else if(r instanceof ws){for(const o of r.args)if(e=Da(o),e)break}else(r instanceof ro||r instanceof No)&&r.input instanceof Yo&&"zoom"===r.input.name&&(e=r);return e instanceof ki||r.eachChild(o=>{const c=Da(o);c instanceof ki?e=c:!e&&c?e=new ki("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&c&&e!==c&&(e=new ki("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}class li{constructor(e,o,c,f){this.message=(e?`${e}: `:"")+c,f&&(this.identifier=f),null!=o&&o.__line__&&(this.line=o.__line__)}}function Ws(r){const e=r.key,o=r.value,c=r.valueSpec||{},f=r.objectElementValidators||{},_=r.style,v=r.styleSpec;let w=[];const E=xn(o);if("object"!==E)return[new li(e,o,`object expected, ${E} found`)];for(const M in o){const L=M.split(".")[0];let N;f[L]?N=f[L]:c[L]?N=Uo:f["*"]?N=f["*"]:c["*"]&&(N=Uo),N?w=w.concat(N({key:(e&&`${e}.`)+M,value:o[M],valueSpec:c[L]||c["*"],style:_,styleSpec:v,object:o,objectKey:M},o)):w.push(new li(e,o[M],`unknown property "${M}"`))}for(const M in c)f[M]||c[M].required&&void 0===c[M].default&&void 0===o[M]&&w.push(new li(e,o,`missing required property "${M}"`));return w}function Du(r){const e=r.value,o=r.valueSpec,c=r.style,f=r.styleSpec,_=r.key,v=r.arrayElementValidator||Uo;if("array"!==xn(e))return[new li(_,e,`array expected, ${xn(e)} found`)];if(o.length&&e.length!==o.length)return[new li(_,e,`array length ${o.length} expected, length ${e.length} found`)];if(o["min-length"]&&e.length<o["min-length"])return[new li(_,e,`array length at least ${o["min-length"]} expected, length ${e.length} found`)];let w={type:o.value,values:o.values,minimum:o.minimum,maximum:o.maximum,function:void 0};f.$version<7&&(w.function=o.function),"object"===xn(o.value)&&(w=o.value);let E=[];for(let M=0;M<e.length;M++)E=E.concat(v({array:e,arrayIndex:M,value:e[M],valueSpec:w,style:c,styleSpec:f,key:`${_}[${M}]`}));return E}function ga(r){const e=r.key,o=r.value,c=r.valueSpec;let f=xn(o);if("number"===f&&o!=o&&(f="NaN"),"number"!==f)return[new li(e,o,`number expected, ${f} found`)];if("minimum"in c){let _=c.minimum;if("array"===xn(c.minimum)&&(_=c.minimum[r.arrayIndex]),o<_)return[new li(e,o,`${o} is less than the minimum value ${_}`)]}if("maximum"in c){let _=c.maximum;if("array"===xn(c.maximum)&&(_=c.maximum[r.arrayIndex]),o>_)return[new li(e,o,`${o} is greater than the maximum value ${_}`)]}return[]}function Jl(r){const e=r.valueSpec,o=On(r.value.type);let c,f,_,v={};const w="categorical"!==o&&void 0===r.value.property,E=!w,M="array"===xn(r.value.stops)&&"array"===xn(r.value.stops[0])&&"object"===xn(r.value.stops[0][0]),L=Ws({key:r.key,value:r.value,valueSpec:r.styleSpec.function,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{stops:function(W){if("identity"===o)return[new li(W.key,W.value,'identity function may not have a "stops" property')];let J=[];const se=W.value;return J=J.concat(Du({key:W.key,value:se,valueSpec:W.valueSpec,style:W.style,styleSpec:W.styleSpec,arrayElementValidator:N})),"array"===xn(se)&&0===se.length&&J.push(new li(W.key,se,"array must have at least one stop")),J},default:function(W){return Uo({key:W.key,value:W.value,valueSpec:e,style:W.style,styleSpec:W.styleSpec})}}});return"identity"===o&&w&&L.push(new li(r.key,r.value,'missing required property "property"')),"identity"===o||r.value.stops||L.push(new li(r.key,r.value,'missing required property "stops"')),"exponential"===o&&r.valueSpec.expression&&!yn(r.valueSpec)&&L.push(new li(r.key,r.value,"exponential functions not supported")),r.styleSpec.$version>=8&&(E&&!le(r.valueSpec)?L.push(new li(r.key,r.value,"property functions not supported")):w&&!wt(r.valueSpec)&&L.push(new li(r.key,r.value,"zoom functions not supported"))),"categorical"!==o&&!M||void 0!==r.value.property||L.push(new li(r.key,r.value,'"property" property is required')),L;function N(W){let J=[];const se=W.value,Le=W.key;if("array"!==xn(se))return[new li(Le,se,`array expected, ${xn(se)} found`)];if(2!==se.length)return[new li(Le,se,`array length 2 expected, length ${se.length} found`)];if(M){if("object"!==xn(se[0]))return[new li(Le,se,`object expected, ${xn(se[0])} found`)];if(void 0===se[0].zoom)return[new li(Le,se,"object stop key must have zoom")];if(void 0===se[0].value)return[new li(Le,se,"object stop key must have value")];const rt=On(se[0].zoom);if("number"!=typeof rt)return[new li(Le,se[0].zoom,"stop zoom values must be numbers")];if(_&&_>rt)return[new li(Le,se[0].zoom,"stop zoom values must appear in ascending order")];rt!==_&&(_=rt,f=void 0,v={}),J=J.concat(Ws({key:`${Le}[0]`,value:se[0],valueSpec:{zoom:{}},style:W.style,styleSpec:W.styleSpec,objectElementValidators:{zoom:ga,value:j}}))}else J=J.concat(j({key:`${Le}[0]`,value:se[0],valueSpec:{},style:W.style,styleSpec:W.styleSpec},se));return ao(Kn(se[1]))?J.concat([new li(`${Le}[1]`,se[1],"expressions are not allowed in function stops.")]):J.concat(Uo({key:`${Le}[1]`,value:se[1],valueSpec:e,style:W.style,styleSpec:W.styleSpec}))}function j(W,J){const se=xn(W.value),Le=On(W.value),rt=null!==W.value?W.value:J;if(c){if(se!==c)return[new li(W.key,rt,`${se} stop domain type must match previous stop domain type ${c}`)]}else c=se;if("number"!==se&&"string"!==se&&"boolean"!==se&&"number"!=typeof Le&&"string"!=typeof Le&&"boolean"!=typeof Le)return[new li(W.key,rt,"stop domain value must be a number, string, or boolean")];if("number"!==se&&"categorical"!==o){let bt=`number expected, ${se} found`;return le(e)&&void 0===o&&(bt+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new li(W.key,rt,bt)]}return"categorical"!==o||"number"!==se||"number"==typeof Le&&isFinite(Le)&&Math.floor(Le)===Le?"categorical"!==o&&"number"===se&&"number"==typeof Le&&"number"==typeof f&&void 0!==f&&Le<f?[new li(W.key,rt,"stop domain values must appear in ascending order")]:(f=Le,"categorical"===o&&Le in v?[new li(W.key,rt,"stop domain values must be unique")]:(v[Le]=!0,[])):[new li(W.key,rt,`integer expected, found ${String(Le)}`)]}}function Zr(r){const e=("property"===r.expressionContext?zo:Es)(Kn(r.value),r.valueSpec);if("error"===e.result)return e.value.map(c=>new li(`${r.key}${c.key}`,r.value,c.message));const o=e.value.expression||e.value._styleExpression.expression;if("property"===r.expressionContext&&"text-font"===r.propertyKey&&!o.outputDefined())return[new li(r.key,r.value,`Invalid data expression for "${r.propertyKey}". Output values must be contained as literals within the expression.`)];if("property"===r.expressionContext&&"layout"===r.propertyType&&!Us(o))return[new li(r.key,r.value,'"feature-state" data expressions are not supported with layout properties.')];if("filter"===r.expressionContext)return Dl(o,r);if(r.expressionContext&&0===r.expressionContext.indexOf("cluster")){if(!ha(o,["zoom","feature-state"]))return[new li(r.key,r.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if("cluster-initial"===r.expressionContext&&!ja(o))return[new li(r.key,r.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function Dl(r,e){const o=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(e.valueSpec&&e.valueSpec.expression)for(const f of e.valueSpec.expression.parameters)o.delete(f);if(0===o.size)return[];const c=[];return r instanceof Yo&&o.has(r.name)?[new li(e.key,e.value,`["${r.name}"] expression is not supported in a filter for a ${e.object.type} layer with id: ${e.object.id}`)]:(r.eachChild(f=>{c.push(...Dl(f,e))}),c)}function Kl(r){const e=r.key,o=r.value,c=r.valueSpec,f=[];return Array.isArray(c.values)?-1===c.values.indexOf(On(o))&&f.push(new li(e,o,`expected one of [${c.values.join(", ")}], ${JSON.stringify(o)} found`)):-1===Object.keys(c.values).indexOf(On(o))&&f.push(new li(e,o,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(o)} found`)),f}function Xl(r){if(!0===r||!1===r)return!0;if(!Array.isArray(r)||0===r.length)return!1;switch(r[0]){case"has":return r.length>=2&&"$id"!==r[1]&&"$type"!==r[1];case"in":return r.length>=3&&("string"!=typeof r[1]||Array.isArray(r[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return 3!==r.length||Array.isArray(r[1])||Array.isArray(r[2]);case"any":case"all":for(const e of r.slice(1))if(!Xl(e)&&"boolean"!=typeof e)return!1;return!0;default:return!0}}function yc(r,e="fill"){if(null==r)return{filter:()=>!0,needGeometry:!1,needFeature:!1};Xl(r)||(r=_a(r));const o=r;let c=!0;try{c=function(M){if(!Ha(M))return M;let L=Kn(M);return Fr(L),L=Ql(L),L}(o)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.\nThis is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md\nand paste the contents of this message in the report.\nThank you!\nFilter Expression:\n${JSON.stringify(o,null,2)}\n        `)}const f=vt[`filter_${e}`],_=Es(c,f);let v=null;if("error"===_.result)throw new Error(_.value.map(M=>`${M.key}: ${M.message}`).join(", "));v=(M,L,N)=>_.value.evaluate(M,L,{},N);let w=null,E=null;if(c!==o){const M=Es(o,f);if("error"===M.result)throw new Error(M.value.map(L=>`${L.key}: ${L.message}`).join(", "));w=(L,N,j,W,J)=>M.value.evaluate(L,N,{},j,void 0,void 0,W,J),E=!ja(M.value.expression)}return{filter:v,dynamicFilter:w||void 0,needGeometry:Ds(c),needFeature:!!E}}function Ql(r){if(!Array.isArray(r))return r;const e=function(o){if(ll.has(o[0]))for(let c=1;c<o.length;c++)if(Ha(o[c]))return!0;return o}(r);return!0===e?e:e.map(o=>Ql(o))}function Fr(r){let e=!1;const o=[];if("case"===r[0]){for(let c=1;c<r.length-1;c+=2)e=e||Ha(r[c]),o.push(r[c+1]);o.push(r[r.length-1])}else if("match"===r[0]){e=e||Ha(r[1]);for(let c=2;c<r.length-1;c+=2)o.push(r[c+1]);o.push(r[r.length-1])}else if("step"===r[0]){e=e||Ha(r[1]);for(let c=1;c<r.length-1;c+=2)o.push(r[c+1])}e&&(r.length=0,r.push("any",...o));for(let c=1;c<r.length;c++)Fr(r[c])}function Ha(r){if(!Array.isArray(r))return!1;if("pitch"===(e=r[0])||"distance-from-center"===e)return!0;var e;for(let o=1;o<r.length;o++)if(Ha(r[o]))return!0;return!1}const ll=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function ts(r,e){return r<e?-1:r>e?1:0}function Ds(r){if(!Array.isArray(r))return!1;if("within"===r[0])return!0;for(let e=1;e<r.length;e++)if(Ds(r[e]))return!0;return!1}function _a(r){if(!r)return!0;const e=r[0];return r.length<=1?"any"!==e:"=="===e?Wa(r[1],r[2],"=="):"!="===e?Il(Wa(r[1],r[2],"==")):"<"===e||">"===e||"<="===e||">="===e?Wa(r[1],r[2],e):"any"===e?(o=r.slice(1),["any"].concat(o.map(_a))):"all"===e?["all"].concat(r.slice(1).map(_a)):"none"===e?["all"].concat(r.slice(1).map(_a).map(Il)):"in"===e?Lo(r[1],r.slice(2)):"!in"===e?Il(Lo(r[1],r.slice(2))):"has"===e?Gc(r[1]):"!has"===e?Il(Gc(r[1])):"within"!==e||r;var o}function Wa(r,e,o){switch(r){case"$type":return[`filter-type-${o}`,e];case"$id":return[`filter-id-${o}`,e];default:return[`filter-${o}`,r,e]}}function Lo(r,e){if(0===e.length)return!1;switch(r){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(o=>typeof o!=typeof e[0])?["filter-in-large",r,["literal",e.sort(ts)]]:["filter-in-small",r,["literal",e]]}}function Gc(r){switch(r){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",r]}}function Il(r){return["!",r]}function Ml(r){return Xl(Kn(r.value))?Zr(Hn({},r,{expressionContext:"filter",valueSpec:r.styleSpec[`filter_${r.layerType||"fill"}`]})):Is(r)}function Is(r){const e=r.value,o=r.key;if("array"!==xn(e))return[new li(o,e,`array expected, ${xn(e)} found`)];const c=r.styleSpec;let f,_=[];if(e.length<1)return[new li(o,e,"filter array must have at least 1 element")];switch(_=_.concat(Kl({key:`${o}[0]`,value:e[0],valueSpec:c.filter_operator,style:r.style,styleSpec:r.styleSpec})),On(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&"$type"===On(e[1])&&_.push(new li(o,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":3!==e.length&&_.push(new li(o,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(f=xn(e[1]),"string"!==f&&_.push(new li(`${o}[1]`,e[1],`string expected, ${f} found`)));for(let v=2;v<e.length;v++)f=xn(e[v]),"$type"===On(e[1])?_=_.concat(Kl({key:`${o}[${v}]`,value:e[v],valueSpec:c.geometry_type,style:r.style,styleSpec:r.styleSpec})):"string"!==f&&"number"!==f&&"boolean"!==f&&_.push(new li(`${o}[${v}]`,e[v],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let v=1;v<e.length;v++)_=_.concat(Is({key:`${o}[${v}]`,value:e[v],style:r.style,styleSpec:r.styleSpec}));break;case"has":case"!has":f=xn(e[1]),2!==e.length?_.push(new li(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):"string"!==f&&_.push(new li(`${o}[1]`,e[1],`string expected, ${f} found`));break;case"within":f=xn(e[1]),2!==e.length?_.push(new li(o,e,`filter array for "${e[0]}" operator must have 2 elements`)):"object"!==f&&_.push(new li(`${o}[1]`,e[1],`object expected, ${f} found`))}return _}function Hc(r,e){const o=r.key,c=r.style,f=r.styleSpec,_=r.value,v=r.objectKey,w=f[`${e}_${r.layerType}`];if(!w)return[];const E=v.match(/^(.*)-transition$/);if("paint"===e&&E&&w[E[1]]&&w[E[1]].transition)return Uo({key:o,value:_,valueSpec:f.transition,style:c,styleSpec:f});const M=r.valueSpec||w[v];if(!M)return[new li(o,_,`unknown property "${v}"`)];let L;if("string"===xn(_)&&le(M)&&!M.tokens&&(L=/^{([^}]+)}$/.exec(_))){const j=`\`{ "type": "identity", "property": ${L?JSON.stringify(L[1]):'"_"'} }\``;return[new li(o,_,`"${v}" does not support interpolation syntax\nUse an identity property function instead: ${j}.`)]}const N=[];return"symbol"===r.layerType&&("text-field"===v&&c&&!c.glyphs&&N.push(new li(o,_,'use of "text-field" requires a style "glyphs" property')),"text-font"===v&&xi(Kn(_))&&"identity"===On(_.type)&&N.push(new li(o,_,'"text-font" does not support identity functions'))),N.concat(Uo({key:r.key,value:_,valueSpec:M,style:c,styleSpec:f,expressionContext:"property",propertyType:e,propertyKey:v}))}function Iu(r){return Hc(r,"paint")}function Al(r){return Hc(r,"layout")}function vc(r){let e=[];const o=r.value,c=r.key,f=r.style,_=r.styleSpec;o.type||o.ref||e.push(new li(c,o,'either "type" or "ref" is required'));let v=On(o.type);const w=On(o.ref);if(o.id){const E=On(o.id);for(let M=0;M<r.arrayIndex;M++){const L=f.layers[M];On(L.id)===E&&e.push(new li(c,o.id,`duplicate layer id "${o.id}", previously used at line ${L.id.__line__}`))}}if("ref"in o){let E;["type","source","source-layer","filter","layout"].forEach(M=>{M in o&&e.push(new li(c,o[M],`"${M}" is prohibited for ref layers`))}),f.layers.forEach(M=>{On(M.id)===w&&(E=M)}),E?E.ref?e.push(new li(c,o.ref,"ref cannot reference another ref layer")):v=On(E.type):"string"==typeof w&&e.push(new li(c,o.ref,`ref layer "${w}" not found`))}else if("background"!==v&&"sky"!==v)if(o.source){const E=f.sources&&f.sources[o.source],M=E&&On(E.type);E?"vector"===M&&"raster"===v?e.push(new li(c,o.source,`layer "${o.id}" requires a raster source`)):"raster"===M&&"raster"!==v?e.push(new li(c,o.source,`layer "${o.id}" requires a vector source`)):"vector"!==M||o["source-layer"]?"raster-dem"===M&&"hillshade"!==v?e.push(new li(c,o.source,"raster-dem source can only be used with layer type 'hillshade'.")):"line"!==v||!o.paint||!o.paint["line-gradient"]&&!o.paint["line-trim-offset"]||"geojson"===M&&E.lineMetrics||e.push(new li(c,o,`layer "${o.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new li(c,o,`layer "${o.id}" must specify a "source-layer"`)):e.push(new li(c,o.source,`source "${o.source}" not found`))}else e.push(new li(c,o,'missing required property "source"'));return e=e.concat(Ws({key:c,value:o,valueSpec:_.layer,style:r.style,styleSpec:r.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Uo({key:`${c}.type`,value:o.type,valueSpec:_.layer.type,style:r.style,styleSpec:r.styleSpec,object:o,objectKey:"type"}),filter:E=>Ml(Hn({layerType:v},E)),layout:E=>Ws({layer:o,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":M=>Al(Hn({layerType:v},M))}}),paint:E=>Ws({layer:o,key:E.key,value:E.value,valueSpec:{},style:E.style,styleSpec:E.styleSpec,objectElementValidators:{"*":M=>Iu(Hn({layerType:v},M))}})}})),e}function Ia(r){const e=r.value,o=r.key,c=xn(e);return"string"!==c?[new li(o,e,`string expected, ${c} found`)]:[]}const cl={promoteId:function({key:r,value:e}){if("string"===xn(e))return Ia({key:r,value:e});{const o=[];for(const c in e)o.push(...Ia({key:`${r}.${c}`,value:e[c]}));return o}}};function hs(r){const e=r.value,o=r.key,c=r.styleSpec,f=r.style;if(!e.type)return[new li(o,e,'"type" is required')];const _=On(e.type);let v;switch(_){case"vector":case"raster":case"raster-dem":return v=Ws({key:o,value:e,valueSpec:c[`source_${_.replace("-","_")}`],style:r.style,styleSpec:c,objectElementValidators:cl}),v;case"geojson":if(v=Ws({key:o,value:e,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:cl}),e.cluster)for(const w in e.clusterProperties){const[E,M]=e.clusterProperties[w],L="string"==typeof E?[E,["accumulated"],["get",w]]:E;v.push(...Zr({key:`${o}.${w}.map`,value:M,expressionContext:"cluster-map"})),v.push(...Zr({key:`${o}.${w}.reduce`,value:L,expressionContext:"cluster-reduce"}))}return v;case"video":return Ws({key:o,value:e,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return Ws({key:o,value:e,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new li(o,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return Kl({key:`${o}.type`,value:e.type,valueSpec:{values:Wc(c)},style:f,styleSpec:c})}}function Wc(r){return r.source.reduce((e,o)=>{const c=r[o];return"enum"===c.type.type&&(e=e.concat(Object.keys(c.type.values))),e},[])}function ul(r){const e=r.value,o=r.styleSpec,c=o.light,f=r.style;let _=[];const v=xn(e);if(void 0===e)return _;if("object"!==v)return _=_.concat([new li("light",e,`object expected, ${v} found`)]),_;for(const w in e){const E=w.match(/^(.*)-transition$/);_=_.concat(E&&c[E[1]]&&c[E[1]].transition?Uo({key:w,value:e[w],valueSpec:o.transition,style:f,styleSpec:o}):c[w]?Uo({key:w,value:e[w],valueSpec:c[w],style:f,styleSpec:o}):[new li(w,e[w],`unknown property "${w}"`)])}return _}function Hi(r){const e=r.value,o=r.key,c=r.style,f=r.styleSpec,_=f.terrain;let v=[];const w=xn(e);if(void 0===e)return v;if("object"!==w)return v=v.concat([new li("terrain",e,`object expected, ${w} found`)]),v;for(const E in e){const M=E.match(/^(.*)-transition$/);v=v.concat(M&&_[M[1]]&&_[M[1]].transition?Uo({key:E,value:e[E],valueSpec:f.transition,style:c,styleSpec:f}):_[E]?Uo({key:E,value:e[E],valueSpec:_[E],style:c,styleSpec:f}):[new li(E,e[E],`unknown property "${E}"`)])}if(e.source){const E=c.sources&&c.sources[e.source],M=E&&On(E.type);E?"raster-dem"!==M&&v.push(new li(o,e.source,`terrain cannot be used with a source of type ${String(M)}, it only be used with a "raster-dem" source type`)):v.push(new li(o,e.source,`source "${e.source}" not found`))}else v.push(new li(o,e,'terrain is missing required property "source"'));return v}function Mu(r){const e=r.value,o=r.style,c=r.styleSpec,f=c.fog;let _=[];const v=xn(e);if(void 0===e)return _;if("object"!==v)return _=_.concat([new li("fog",e,`object expected, ${v} found`)]),_;for(const w in e){const E=w.match(/^(.*)-transition$/);_=_.concat(E&&f[E[1]]&&f[E[1]].transition?Uo({key:w,value:e[w],valueSpec:c.transition,style:o,styleSpec:c}):f[w]?Uo({key:w,value:e[w],valueSpec:f[w],style:o,styleSpec:c}):[new li(w,e[w],`unknown property "${w}"`)])}return _}const Au={"*":()=>[],array:Du,boolean:function(r){const e=r.value,o=r.key,c=xn(e);return"boolean"!==c?[new li(o,e,`boolean expected, ${c} found`)]:[]},number:ga,color:function(r){const e=r.key,o=r.value,c=xn(o);return"string"!==c?[new li(e,o,`color expected, ${c} found`)]:null===$n(o)?[new li(e,o,`color expected, "${o}" found`)]:[]},enum:Kl,filter:Ml,function:Jl,layer:vc,object:Ws,source:hs,light:ul,terrain:Hi,fog:Mu,string:Ia,formatted:function(r){return 0===Ia(r).length?[]:Zr(r)},resolvedImage:function(r){return 0===Ia(r).length?[]:Zr(r)},projection:function(r){const e=r.value,o=r.styleSpec,c=o.projection,f=r.style;let _=[];const v=xn(e);if("object"===v)for(const w in e)_=_.concat(Uo({key:w,value:e[w],valueSpec:c[w],style:f,styleSpec:o}));else"string"!==v&&(_=_.concat([new li("projection",e,`object or string expected, ${v} found`)]));return _}};function Uo(r){const e=r.value,o=r.valueSpec,c=r.styleSpec;return o.expression&&xi(On(e))?Jl(r):o.expression&&ao(Kn(e))?Zr(r):o.type&&Au[o.type]?Au[o.type](r):Ws(Hn({},r,{valueSpec:o.type?c[o.type]:o}))}function qc(r){const e=r.value,o=r.key,c=Ia(r);return c.length||(-1===e.indexOf("{fontstack}")&&c.push(new li(o,e,'"glyphs" url must include a "{fontstack}" token')),-1===e.indexOf("{range}")&&c.push(new li(o,e,'"glyphs" url must include a "{range}" token'))),c}function Su(r,e=vt){return Ms(Uo({key:"",value:r,valueSpec:e.$root,styleSpec:e,style:r,objectElementValidators:{glyphs:qc,"*":()=>[]}}))}const Pu=r=>Ms(Iu(r)),ec=r=>Ms(Al(r));function Ms(r){return r.slice().sort((e,o)=>e.line&&o.line?e.line-o.line:0)}function Ou(r,e){let o=!1;if(e&&e.length)for(const c of e)r.fire(new Et(new Error(c.message))),o=!0;return o}var Lh=Ma,ya=3;function Ma(r,e,o){var c=this.cells=[];if(r instanceof ArrayBuffer){this.arrayBuffer=r;var f=new Int32Array(this.arrayBuffer);r=f[0],this.d=(e=f[1])+2*(o=f[2]);for(var _=0;_<this.d*this.d;_++){var v=f[ya+_],w=f[ya+_+1];c.push(v===w?null:f.subarray(v,w))}var E=f[ya+c.length+1];this.keys=f.subarray(f[ya+c.length],E),this.bboxes=f.subarray(E),this.insert=this._insertReadonly}else{this.d=e+2*o;for(var M=0;M<this.d*this.d;M++)c.push([]);this.keys=[],this.bboxes=[]}this.n=e,this.extent=r,this.padding=o,this.scale=e/r,this.uid=0;var L=o/e*r;this.min=-L,this.max=r+L}Ma.prototype.insert=function(r,e,o,c,f){this._forEachCell(e,o,c,f,this._insertCell,this.uid++),this.keys.push(r),this.bboxes.push(e),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(f)},Ma.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Ma.prototype._insertCell=function(r,e,o,c,f,_){this.cells[f].push(_)},Ma.prototype.query=function(r,e,o,c,f){var _=this.min,v=this.max;if(r<=_&&e<=_&&v<=o&&v<=c&&!f)return Array.prototype.slice.call(this.keys);var w=[];return this._forEachCell(r,e,o,c,this._queryCell,w,{},f),w},Ma.prototype._queryCell=function(r,e,o,c,f,_,v,w){var E=this.cells[f];if(null!==E)for(var M=this.keys,L=this.bboxes,N=0;N<E.length;N++){var j=E[N];if(void 0===v[j]){var W=4*j;(w?w(L[W+0],L[W+1],L[W+2],L[W+3]):r<=L[W+2]&&e<=L[W+3]&&o>=L[W+0]&&c>=L[W+1])?(v[j]=!0,_.push(M[j])):v[j]=!1}}},Ma.prototype._forEachCell=function(r,e,o,c,f,_,v,w){for(var E=this._convertToCellCoord(r),M=this._convertToCellCoord(e),L=this._convertToCellCoord(o),N=this._convertToCellCoord(c),j=E;j<=L;j++)for(var W=M;W<=N;W++){var J=this.d*W+j;if((!w||w(this._convertFromCellCoord(j),this._convertFromCellCoord(W),this._convertFromCellCoord(j+1),this._convertFromCellCoord(W+1)))&&f.call(this,r,e,o,c,J,_,v,w))return}},Ma.prototype._convertFromCellCoord=function(r){return(r-this.padding)/this.scale},Ma.prototype._convertToCellCoord=function(r){return Math.max(0,Math.min(this.d-1,Math.floor(r*this.scale)+this.padding))},Ma.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var r=this.cells,e=ya+this.cells.length+1+1,o=0,c=0;c<this.cells.length;c++)o+=this.cells[c].length;var f=new Int32Array(e+o+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var _=e,v=0;v<r.length;v++){var w=r[v];f[ya+v]=_,f.set(w,_),_+=w.length}return f[ya+r.length]=_,f.set(this.keys,_),f[ya+r.length+1]=_+=this.keys.length,f.set(this.bboxes,_),_+=this.bboxes.length,f.buffer};var Sn=nt(Lh);const gr={};function hi(r,e,o={}){Object.defineProperty(r,"_classRegistryKey",{value:e,writeable:!1}),gr[e]={klass:r,omit:o.omit||[]}}hi(Object,"Object"),Sn.serialize=function(r,e){const o=r.toArrayBuffer();return e&&e.push(o),{buffer:o}},Sn.deserialize=function(r){return new Sn(r.buffer)},Object.defineProperty(Sn,"name",{value:"Grid"}),hi(Sn,"Grid"),hi(O,"Color"),hi(Error,"Error"),hi(Li,"AJAXError"),hi(Nt,"ResolvedImage"),hi(ia,"StylePropertyFunction"),hi(Bo,"StyleExpression",{omit:["_evaluator"]}),hi(Zo,"ZoomDependentExpression"),hi(Ts,"ZoomConstantExpression"),hi(Yo,"CompoundExpression",{omit:["_evaluate"]});for(const r in F)gr[F[r]._classRegistryKey]||hi(F[r],`Expression${r}`);function tc(r){return r&&typeof ArrayBuffer<"u"&&(r instanceof ArrayBuffer||r.constructor&&"ArrayBuffer"===r.constructor.name)}function Nr(r){return B.ImageBitmap&&r instanceof B.ImageBitmap}function dl(r,e){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp)return r;if(tc(r)||Nr(r))return e&&e.push(r),r;if(ArrayBuffer.isView(r)){const o=r;return e&&e.push(o.buffer),o}if(r instanceof B.ImageData)return e&&e.push(r.data.buffer),r;if(Array.isArray(r)){const o=[];for(const c of r)o.push(dl(c,e));return o}if("object"==typeof r){const o=r.constructor,c=o._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const f=o.serialize?o.serialize(r,e):{};if(!o.serialize){for(const _ in r)r.hasOwnProperty(_)&&(gr[c].omit.indexOf(_)>=0||(f[_]=dl(r[_],e)));r instanceof Error&&(f.message=r.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return"Object"!==c&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof r)}function ra(r){if(null==r||"boolean"==typeof r||"number"==typeof r||"string"==typeof r||r instanceof Boolean||r instanceof Number||r instanceof String||r instanceof Date||r instanceof RegExp||tc(r)||Nr(r)||ArrayBuffer.isView(r)||r instanceof B.ImageData)return r;if(Array.isArray(r))return r.map(ra);if("object"==typeof r){const e=r.$name||"Object",{klass:o}=gr[e];if(!o)throw new Error(`can't deserialize unregistered class ${e}`);if(o.deserialize)return o.deserialize(r);const c=Object.create(o.prototype);for(const f of Object.keys(r))"$name"!==f&&(c[f]=ra(r[f]));return c}throw new Error("can't deserialize object of type "+typeof r)}const oi={"Latin-1 Supplement":r=>r>=128&&r<=255,Arabic:r=>r>=1536&&r<=1791,"Arabic Supplement":r=>r>=1872&&r<=1919,"Arabic Extended-A":r=>r>=2208&&r<=2303,"Hangul Jamo":r=>r>=4352&&r<=4607,"Unified Canadian Aboriginal Syllabics":r=>r>=5120&&r<=5759,Khmer:r=>r>=6016&&r<=6143,"Unified Canadian Aboriginal Syllabics Extended":r=>r>=6320&&r<=6399,"General Punctuation":r=>r>=8192&&r<=8303,"Letterlike Symbols":r=>r>=8448&&r<=8527,"Number Forms":r=>r>=8528&&r<=8591,"Miscellaneous Technical":r=>r>=8960&&r<=9215,"Control Pictures":r=>r>=9216&&r<=9279,"Optical Character Recognition":r=>r>=9280&&r<=9311,"Enclosed Alphanumerics":r=>r>=9312&&r<=9471,"Geometric Shapes":r=>r>=9632&&r<=9727,"Miscellaneous Symbols":r=>r>=9728&&r<=9983,"Miscellaneous Symbols and Arrows":r=>r>=11008&&r<=11263,"CJK Radicals Supplement":r=>r>=11904&&r<=12031,"Kangxi Radicals":r=>r>=12032&&r<=12255,"Ideographic Description Characters":r=>r>=12272&&r<=12287,"CJK Symbols and Punctuation":r=>r>=12288&&r<=12351,Hiragana:r=>r>=12352&&r<=12447,Katakana:r=>r>=12448&&r<=12543,Bopomofo:r=>r>=12544&&r<=12591,"Hangul Compatibility Jamo":r=>r>=12592&&r<=12687,Kanbun:r=>r>=12688&&r<=12703,"Bopomofo Extended":r=>r>=12704&&r<=12735,"CJK Strokes":r=>r>=12736&&r<=12783,"Katakana Phonetic Extensions":r=>r>=12784&&r<=12799,"Enclosed CJK Letters and Months":r=>r>=12800&&r<=13055,"CJK Compatibility":r=>r>=13056&&r<=13311,"CJK Unified Ideographs Extension A":r=>r>=13312&&r<=19903,"Yijing Hexagram Symbols":r=>r>=19904&&r<=19967,"CJK Unified Ideographs":r=>r>=19968&&r<=40959,"Yi Syllables":r=>r>=40960&&r<=42127,"Yi Radicals":r=>r>=42128&&r<=42191,"Hangul Jamo Extended-A":r=>r>=43360&&r<=43391,"Hangul Syllables":r=>r>=44032&&r<=55215,"Hangul Jamo Extended-B":r=>r>=55216&&r<=55295,"Private Use Area":r=>r>=57344&&r<=63743,"CJK Compatibility Ideographs":r=>r>=63744&&r<=64255,"Arabic Presentation Forms-A":r=>r>=64336&&r<=65023,"Vertical Forms":r=>r>=65040&&r<=65055,"CJK Compatibility Forms":r=>r>=65072&&r<=65103,"Small Form Variants":r=>r>=65104&&r<=65135,"Arabic Presentation Forms-B":r=>r>=65136&&r<=65279,"Halfwidth and Fullwidth Forms":r=>r>=65280&&r<=65519};function nc(r){for(const e of r)if(Jc(e.charCodeAt(0)))return!0;return!1}function Yc(r){for(const e of r)if(!Ru(e.charCodeAt(0)))return!1;return!0}function Ru(r){return!(oi.Arabic(r)||oi["Arabic Supplement"](r)||oi["Arabic Extended-A"](r)||oi["Arabic Presentation Forms-A"](r)||oi["Arabic Presentation Forms-B"](r))}function Jc(r){return!(746!==r&&747!==r&&(r<4352||!(oi["Bopomofo Extended"](r)||oi.Bopomofo(r)||oi["CJK Compatibility Forms"](r)&&!(r>=65097&&r<=65103)||oi["CJK Compatibility Ideographs"](r)||oi["CJK Compatibility"](r)||oi["CJK Radicals Supplement"](r)||oi["CJK Strokes"](r)||!(!oi["CJK Symbols and Punctuation"](r)||r>=12296&&r<=12305||r>=12308&&r<=12319||12336===r)||oi["CJK Unified Ideographs Extension A"](r)||oi["CJK Unified Ideographs"](r)||oi["Enclosed CJK Letters and Months"](r)||oi["Hangul Compatibility Jamo"](r)||oi["Hangul Jamo Extended-A"](r)||oi["Hangul Jamo Extended-B"](r)||oi["Hangul Jamo"](r)||oi["Hangul Syllables"](r)||oi.Hiragana(r)||oi["Ideographic Description Characters"](r)||oi.Kanbun(r)||oi["Kangxi Radicals"](r)||oi["Katakana Phonetic Extensions"](r)||oi.Katakana(r)&&12540!==r||!(!oi["Halfwidth and Fullwidth Forms"](r)||65288===r||65289===r||65293===r||r>=65306&&r<=65310||65339===r||65341===r||65343===r||r>=65371&&r<=65503||65507===r||r>=65512&&r<=65519)||!(!oi["Small Form Variants"](r)||r>=65112&&r<=65118||r>=65123&&r<=65126)||oi["Unified Canadian Aboriginal Syllabics"](r)||oi["Unified Canadian Aboriginal Syllabics Extended"](r)||oi["Vertical Forms"](r)||oi["Yijing Hexagram Symbols"](r)||oi["Yi Syllables"](r)||oi["Yi Radicals"](r))))}function Kc(r){return!(Jc(r)||(e=r,oi["Latin-1 Supplement"](e)&&(167===e||169===e||174===e||177===e||188===e||189===e||190===e||215===e||247===e)||oi["General Punctuation"](e)&&(8214===e||8224===e||8225===e||8240===e||8241===e||8251===e||8252===e||8258===e||8263===e||8264===e||8265===e||8273===e)||oi["Letterlike Symbols"](e)||oi["Number Forms"](e)||oi["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||9003===e||e>=9085&&e<=9114||e>=9150&&e<=9165||9167===e||e>=9169&&e<=9179||e>=9186&&e<=9215)||oi["Control Pictures"](e)&&9251!==e||oi["Optical Character Recognition"](e)||oi["Enclosed Alphanumerics"](e)||oi["Geometric Shapes"](e)||oi["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||oi["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||oi["CJK Symbols and Punctuation"](e)||oi.Katakana(e)||oi["Private Use Area"](e)||oi["CJK Compatibility Forms"](e)||oi["Small Form Variants"](e)||oi["Halfwidth and Fullwidth Forms"](e)||8734===e||8756===e||8757===e||e>=9984&&e<=10087||e>=10102&&e<=10131||65532===e||65533===e));var e}function ns(r){return r>=1424&&r<=2303||oi["Arabic Presentation Forms-A"](r)||oi["Arabic Presentation Forms-B"](r)}function qa(r,e){return!(!e&&ns(r)||r>=2304&&r<=3583||r>=3840&&r<=4255||oi.Khmer(r))}function Dd(r){for(const e of r)if(ns(e.charCodeAt(0)))return!0;return!1}const oa="deferred",va="loading",Lu="loaded";let S=null,u="unavailable",n=null;const a=function(r){r&&"string"==typeof r&&r.indexOf("NetworkError")>-1&&(u="error"),S&&S(r)};function p(){y.fire(new Tt("pluginStateChange",{pluginStatus:u,pluginURL:n}))}const y=new ln,x=function(){return u},D=function(){if(u!==oa||!n)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");u=va,p(),n&&Jt({url:n},r=>{r?a(r):(u=Lu,p())})},I={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>u===Lu||null!=I.applyArabicShaping,isLoading:()=>u===va,setState(r){u=r.pluginStatus,n=r.pluginURL},isParsed:()=>null!=I.applyArabicShaping&&null!=I.processBidirectionalText&&null!=I.processStyledBidirectionalText,getPluginURL:()=>n};class R{constructor(e,o){this.zoom=e,o?(this.now=o.now,this.fadeDuration=o.fadeDuration,this.transition=o.transition,this.pitch=o.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(e){return function(o,c){for(const f of o)if(!qa(f.charCodeAt(0),c))return!1;return!0}(e,I.isLoaded())}}class U{constructor(e,o){this.property=e,this.value=o,this.expression=function(c,f){if(xi(c))return new ia(c,f);if(ao(c)){const _=zo(c,f);if("error"===_.result)throw new Error(_.value.map(v=>`${v.key}: ${v.message}`).join(", "));return _.value}{let _=c;return"string"==typeof c&&"color"===f.type&&(_=O.parse(c)),{kind:"constant",evaluate:()=>_}}}(void 0===o?e.specification.default:o,e.specification)}isDataDriven(){return"source"===this.expression.kind||"composite"===this.expression.kind}possiblyEvaluate(e,o,c){return this.property.possiblyEvaluate(this,e,o,c)}}class z{constructor(e){this.property=e,this.value=new U(e,void 0)}transitioned(e,o){return new Se(this.property,this.value,o,We({},e.transition,this.transition),e.now)}untransitioned(){return new Se(this.property,this.value,null,{},0)}}class Q{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return bn(this._values[e].value.value)}setValue(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new z(this._values[e].property)),this._values[e].value=new U(this._values[e].property,null===o?void 0:bn(o))}getTransition(e){return bn(this._values[e].transition)}setTransition(e,o){this._values.hasOwnProperty(e)||(this._values[e]=new z(this._values[e].property)),this._values[e].transition=bn(o)||void 0}serialize(){const e={};for(const o of Object.keys(this._values)){const c=this.getValue(o);void 0!==c&&(e[o]=c);const f=this.getTransition(o);void 0!==f&&(e[`${o}-transition`]=f)}return e}transitioned(e,o){const c=new je(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(e,o._values[f]);return c}untransitioned(){const e=new je(this._properties);for(const o of Object.keys(this._values))e._values[o]=this._values[o].untransitioned();return e}}class Se{constructor(e,o,c,f,_){const v=f.delay||0,w=f.duration||0;_=_||0,this.property=e,this.value=o,this.begin=_+v,this.end=this.begin+w,e.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(e,o,c){const f=e.now||0,_=this.value.possiblyEvaluate(e,o,c),v=this.prior;if(v){if(f>this.end)return this.prior=null,_;if(this.value.isDataDriven())return this.prior=null,_;if(f<this.begin)return v.possiblyEvaluate(e,o,c);{const w=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(v.possiblyEvaluate(e,o,c),_,Fe(w))}}return _}}class je{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,o,c){const f=new et(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(e,o,c);return f}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Ye{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}getValue(e){return bn(this._values[e].value)}setValue(e,o){this._values[e]=new U(this._values[e].property,null===o?void 0:bn(o))}serialize(){const e={};for(const o of Object.keys(this._values)){const c=this.getValue(o);void 0!==c&&(e[o]=c)}return e}possiblyEvaluate(e,o,c){const f=new et(this._properties);for(const _ of Object.keys(this._values))f._values[_]=this._values[_].possiblyEvaluate(e,o,c);return f}}class $e{constructor(e,o,c){this.property=e,this.value=o,this.parameters=c}isConstant(){return"constant"===this.value.kind}constantOr(e){return"constant"===this.value.kind?this.value.value:e}evaluate(e,o,c,f){return this.property.evaluate(this.value,this.parameters,e,o,c,f)}}class et{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class ne{constructor(e){this.specification=e}possiblyEvaluate(e,o){return e.expression.evaluate(o)}interpolate(e,o,c){const f=Qo[this.specification.type];return f?f(e,o,c):e}}class He{constructor(e,o){this.specification=e,this.overrides=o}possiblyEvaluate(e,o,c,f){return new $e(this,"constant"===e.expression.kind||"camera"===e.expression.kind?{kind:"constant",value:e.expression.evaluate(o,null,{},c,f)}:e.expression,o)}interpolate(e,o,c){if("constant"!==e.value.kind||"constant"!==o.value.kind)return e;if(void 0===e.value.value||void 0===o.value.value)return new $e(this,{kind:"constant",value:void 0},e.parameters);const f=Qo[this.specification.type];return f?new $e(this,{kind:"constant",value:f(e.value.value,o.value.value,c)},e.parameters):e}evaluate(e,o,c,f,_,v){return"constant"===e.kind?e.value:e.evaluate(o,c,f,_,v)}}class ht{constructor(e){this.specification=e}possiblyEvaluate(e,o,c,f){return!!e.expression.evaluate(o,null,{},c,f)}interpolate(){return!1}}class gt{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const o=new R(0,{});for(const c in e){const f=e[c];f.specification.overridable&&this.overridableProperties.push(c);const _=this.defaultPropertyValues[c]=new U(f,void 0),v=this.defaultTransitionablePropertyValues[c]=new z(f);this.defaultTransitioningPropertyValues[c]=v.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=_.possiblyEvaluate(o)}}}function Ot(r,e){return 256*(r=Ke(Math.floor(r),0,255))+Ke(Math.floor(e),0,255)}hi(He,"DataDrivenProperty"),hi(ne,"DataConstantProperty"),hi(ht,"ColorRampProperty");const kt={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Lt{constructor(e,o){this._structArray=e,this._pos1=o*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class qt{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,o){return e._trim(),o&&(e.isTransferred=!0,o.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const o=Object.create(this.prototype);return o.arrayBuffer=e.arrayBuffer,o.length=e.length,o.capacity=e.arrayBuffer.byteLength/o.bytesPerElement,o._refreshViews(),o}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const o=this.uint8;this._refreshViews(),o&&this.uint8.set(o)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function $t(r,e=1){let o=0,c=0;return{members:r.map(f=>{const _=kt[f.type].BYTES_PER_ELEMENT,v=o=cn(o,Math.max(e,_)),w=f.components||1;return c=Math.max(c,_),o+=_*w,{name:f.name,type:f.type,components:w,offset:v}}),size:cn(o,Math.max(c,e)),alignment:e}}function cn(r,e){return Math.ceil(r/e)*e}class Wn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.int16[f+0]=o,this.int16[f+1]=c,e}}Wn.prototype.bytesPerElement=4,hi(Wn,"StructArrayLayout2i4");class nn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const _=3*e;return this.int16[_+0]=o,this.int16[_+1]=c,this.int16[_+2]=f,e}}nn.prototype.bytesPerElement=6,hi(nn,"StructArrayLayout3i6");class Mn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=4*e;return this.int16[v+0]=o,this.int16[v+1]=c,this.int16[v+2]=f,this.int16[v+3]=_,e}}Mn.prototype.bytesPerElement=8,hi(Mn,"StructArrayLayout4i8");class pn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,o,c,f,_,v,w)}emplace(e,o,c,f,_,v,w,E){const M=6*e,L=12*e,N=3*e;return this.int16[M+0]=o,this.int16[M+1]=c,this.uint8[L+4]=f,this.uint8[L+5]=_,this.uint8[L+6]=v,this.uint8[L+7]=w,this.float32[N+2]=E,e}}pn.prototype.bytesPerElement=12,hi(pn,"StructArrayLayout2i4ub1f12");class qn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=4*e;return this.float32[v+0]=o,this.float32[v+1]=c,this.float32[v+2]=f,this.float32[v+3]=_,e}}qn.prototype.bytesPerElement=16,hi(qn,"StructArrayLayout4f16");class sn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,o,c,f,_)}emplace(e,o,c,f,_,v){const w=6*e,E=3*e;return this.uint16[w+0]=o,this.uint16[w+1]=c,this.uint16[w+2]=f,this.uint16[w+3]=_,this.float32[E+2]=v,e}}sn.prototype.bytesPerElement=12,hi(sn,"StructArrayLayout4ui1f12");class An extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=4*e;return this.uint16[v+0]=o,this.uint16[v+1]=c,this.uint16[v+2]=f,this.uint16[v+3]=_,e}}An.prototype.bytesPerElement=8,hi(An,"StructArrayLayout4ui8");class Zn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,c,f,_,v)}emplace(e,o,c,f,_,v,w){const E=6*e;return this.int16[E+0]=o,this.int16[E+1]=c,this.int16[E+2]=f,this.int16[E+3]=_,this.int16[E+4]=v,this.int16[E+5]=w,e}}Zn.prototype.bytesPerElement=12,hi(Zn,"StructArrayLayout6i12");class kn extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,w,E,M,L,N,j){const W=this.length;return this.resize(W+1),this.emplace(W,e,o,c,f,_,v,w,E,M,L,N,j)}emplace(e,o,c,f,_,v,w,E,M,L,N,j,W){const J=12*e;return this.int16[J+0]=o,this.int16[J+1]=c,this.int16[J+2]=f,this.int16[J+3]=_,this.uint16[J+4]=v,this.uint16[J+5]=w,this.uint16[J+6]=E,this.uint16[J+7]=M,this.int16[J+8]=L,this.int16[J+9]=N,this.int16[J+10]=j,this.int16[J+11]=W,e}}kn.prototype.bytesPerElement=24,hi(kn,"StructArrayLayout4i4ui4i24");class ti extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v){const w=this.length;return this.resize(w+1),this.emplace(w,e,o,c,f,_,v)}emplace(e,o,c,f,_,v,w){const E=10*e,M=5*e;return this.int16[E+0]=o,this.int16[E+1]=c,this.int16[E+2]=f,this.float32[M+2]=_,this.float32[M+3]=v,this.float32[M+4]=w,e}}ti.prototype.bytesPerElement=20,hi(ti,"StructArrayLayout3i3f20");class Ii extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint32[1*e+0]=o,e}}Ii.prototype.bytesPerElement=4,hi(Ii,"StructArrayLayout1ul4");class $i extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,w,E,M,L,N,j,W){const J=this.length;return this.resize(J+1),this.emplace(J,e,o,c,f,_,v,w,E,M,L,N,j,W)}emplace(e,o,c,f,_,v,w,E,M,L,N,j,W,J){const se=20*e,Le=10*e;return this.int16[se+0]=o,this.int16[se+1]=c,this.int16[se+2]=f,this.int16[se+3]=_,this.int16[se+4]=v,this.float32[Le+3]=w,this.float32[Le+4]=E,this.float32[Le+5]=M,this.float32[Le+6]=L,this.int16[se+14]=N,this.uint32[Le+8]=j,this.uint16[se+18]=W,this.uint16[se+19]=J,e}}$i.prototype.bytesPerElement=40,hi($i,"StructArrayLayout5i4f1i1ul2ui40");class mi extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,w){const E=this.length;return this.resize(E+1),this.emplace(E,e,o,c,f,_,v,w)}emplace(e,o,c,f,_,v,w,E){const M=8*e;return this.int16[M+0]=o,this.int16[M+1]=c,this.int16[M+2]=f,this.int16[M+4]=_,this.int16[M+5]=v,this.int16[M+6]=w,this.int16[M+7]=E,e}}mi.prototype.bytesPerElement=16,hi(mi,"StructArrayLayout3i2i2i16");class Oi extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,o,c,f,_)}emplace(e,o,c,f,_,v){const w=4*e,E=8*e;return this.float32[w+0]=o,this.float32[w+1]=c,this.float32[w+2]=f,this.int16[E+6]=_,this.int16[E+7]=v,e}}Oi.prototype.bytesPerElement=16,hi(Oi,"StructArrayLayout2f1f2i16");class cr extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=12*e,w=3*e;return this.uint8[v+0]=o,this.uint8[v+1]=c,this.float32[w+1]=f,this.float32[w+2]=_,e}}cr.prototype.bytesPerElement=12,hi(cr,"StructArrayLayout2ub2f12");class lr extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const _=3*e;return this.float32[_+0]=o,this.float32[_+1]=c,this.float32[_+2]=f,e}}lr.prototype.bytesPerElement=12,hi(lr,"StructArrayLayout3f12");class Ci extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c){const f=this.length;return this.resize(f+1),this.emplace(f,e,o,c)}emplace(e,o,c,f){const _=3*e;return this.uint16[_+0]=o,this.uint16[_+1]=c,this.uint16[_+2]=f,e}}Ci.prototype.bytesPerElement=6,hi(Ci,"StructArrayLayout3ui6");class br extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,w,E,M,L,N,j,W,J,se,Le,rt,bt,at,xt,At){const Mt=this.length;return this.resize(Mt+1),this.emplace(Mt,e,o,c,f,_,v,w,E,M,L,N,j,W,J,se,Le,rt,bt,at,xt,At)}emplace(e,o,c,f,_,v,w,E,M,L,N,j,W,J,se,Le,rt,bt,at,xt,At,Mt){const un=30*e,rn=15*e,Dn=60*e;return this.int16[un+0]=o,this.int16[un+1]=c,this.int16[un+2]=f,this.float32[rn+2]=_,this.float32[rn+3]=v,this.uint16[un+8]=w,this.uint16[un+9]=E,this.uint32[rn+5]=M,this.uint32[rn+6]=L,this.uint32[rn+7]=N,this.uint16[un+16]=j,this.uint16[un+17]=W,this.uint16[un+18]=J,this.float32[rn+10]=se,this.float32[rn+11]=Le,this.uint8[Dn+48]=rt,this.uint8[Dn+49]=bt,this.uint8[Dn+50]=at,this.uint32[rn+13]=xt,this.int16[un+28]=At,this.uint8[Dn+58]=Mt,e}}br.prototype.bytesPerElement=60,hi(br,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class Gr extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_,v,w,E,M,L,N,j,W,J,se,Le,rt,bt,at,xt,At,Mt,un,rn,Dn,Yn,mn,Pn,Rn,zn){const Qn=this.length;return this.resize(Qn+1),this.emplace(Qn,e,o,c,f,_,v,w,E,M,L,N,j,W,J,se,Le,rt,bt,at,xt,At,Mt,un,rn,Dn,Yn,mn,Pn,Rn,zn)}emplace(e,o,c,f,_,v,w,E,M,L,N,j,W,J,se,Le,rt,bt,at,xt,At,Mt,un,rn,Dn,Yn,mn,Pn,Rn,zn,Qn){const En=38*e,ai=19*e;return this.int16[En+0]=o,this.int16[En+1]=c,this.int16[En+2]=f,this.float32[ai+2]=_,this.float32[ai+3]=v,this.int16[En+8]=w,this.int16[En+9]=E,this.int16[En+10]=M,this.int16[En+11]=L,this.int16[En+12]=N,this.int16[En+13]=j,this.uint16[En+14]=W,this.uint16[En+15]=J,this.uint16[En+16]=se,this.uint16[En+17]=Le,this.uint16[En+18]=rt,this.uint16[En+19]=bt,this.uint16[En+20]=at,this.uint16[En+21]=xt,this.uint16[En+22]=At,this.uint16[En+23]=Mt,this.uint16[En+24]=un,this.uint16[En+25]=rn,this.uint16[En+26]=Dn,this.uint16[En+27]=Yn,this.uint16[En+28]=mn,this.uint32[ai+15]=Pn,this.float32[ai+16]=Rn,this.float32[ai+17]=zn,this.float32[ai+18]=Qn,e}}Gr.prototype.bytesPerElement=76,hi(Gr,"StructArrayLayout3i2f6i15ui1ul3f76");class Ir extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.float32[1*e+0]=o,e}}Ir.prototype.bytesPerElement=4,hi(Ir,"StructArrayLayout1f4");class Br extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o,c,f,_){const v=this.length;return this.resize(v+1),this.emplace(v,e,o,c,f,_)}emplace(e,o,c,f,_,v){const w=5*e;return this.float32[w+0]=o,this.float32[w+1]=c,this.float32[w+2]=f,this.float32[w+3]=_,this.float32[w+4]=v,e}}Br.prototype.bytesPerElement=20,hi(Br,"StructArrayLayout5f20");class jo extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o,c,f){const _=this.length;return this.resize(_+1),this.emplace(_,e,o,c,f)}emplace(e,o,c,f,_){const v=6*e;return this.uint32[3*e+0]=o,this.uint16[v+2]=c,this.uint16[v+3]=f,this.uint16[v+4]=_,e}}jo.prototype.bytesPerElement=12,hi(jo,"StructArrayLayout1ul3ui12");class is extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.uint16[f+0]=o,this.uint16[f+1]=c,e}}is.prototype.bytesPerElement=4,hi(is,"StructArrayLayout2ui4");class sa extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const o=this.length;return this.resize(o+1),this.emplace(o,e)}emplace(e,o){return this.uint16[1*e+0]=o,e}}sa.prototype.bytesPerElement=2,hi(sa,"StructArrayLayout1ui2");class Aa extends qt{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,o){const c=this.length;return this.resize(c+1),this.emplace(c,e,o)}emplace(e,o,c){const f=2*e;return this.float32[f+0]=o,this.float32[f+1]=c,e}}Aa.prototype.bytesPerElement=8,hi(Aa,"StructArrayLayout2f8");class co extends Lt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}co.prototype.size=40;class yr extends $i{get(e){return new co(this,e)}}hi(yr,"CollisionBoxArray");class Er extends Lt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(e){this._structArray.uint8[this._pos1+49]=e}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(e){this._structArray.uint8[this._pos1+50]=e}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(e){this._structArray.uint32[this._pos4+13]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(e){this._structArray.uint8[this._pos1+58]=e}}Er.prototype.size=60;class go extends br{get(e){return new Er(this,e)}}hi(go,"PlacedSymbolArray");class rs extends Lt{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(e){this._structArray.uint32[this._pos4+15]=e}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}rs.prototype.size=76;class no extends Gr{get(e){return new rs(this,e)}}hi(no,"SymbolInstanceArray");class os extends Ir{getoffsetX(e){return this.float32[1*e+0]}}hi(os,"GlyphOffsetArray");class xc extends Wn{getx(e){return this.int16[2*e+0]}gety(e){return this.int16[2*e+1]}}hi(xc,"SymbolLineVertexArray");class ic extends Lt{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}ic.prototype.size=12;class bc extends jo{get(e){return new ic(this,e)}}hi(bc,"FeatureIndexArray");class Ya extends is{geta_centroid_pos0(e){return this.uint16[2*e+0]}geta_centroid_pos1(e){return this.uint16[2*e+1]}}hi(Ya,"FillExtrusionCentroidArray");const hl=$t([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Sl=$t([{name:"a_dash",components:4,type:"Uint16"}]);var ku={exports:{}},up=function(r,e){var o,c,f,_,v,w,E,M;for(c=r.length-(o=3&r.length),f=e,v=3432918353,w=461845907,M=0;M<c;)E=255&r.charCodeAt(M)|(255&r.charCodeAt(++M))<<8|(255&r.charCodeAt(++M))<<16|(255&r.charCodeAt(++M))<<24,++M,f=27492+(65535&(_=5*(65535&(f=(f^=E=(65535&(E=(E=(65535&E)*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*w+(((E>>>16)*w&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(_>>>16)&65535)<<16);switch(E=0,o){case 3:E^=(255&r.charCodeAt(M+2))<<16;case 2:E^=(255&r.charCodeAt(M+1))<<8;case 1:f^=E=(65535&(E=(E=(65535&(E^=255&r.charCodeAt(M)))*v+(((E>>>16)*v&65535)<<16)&4294967295)<<15|E>>>17))*w+(((E>>>16)*w&65535)<<16)&4294967295}return f^=r.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0},rg=function(r,e){for(var o,c=r.length,f=e^c,_=0;c>=4;)o=1540483477*(65535&(o=255&r.charCodeAt(_)|(255&r.charCodeAt(++_))<<8|(255&r.charCodeAt(++_))<<16|(255&r.charCodeAt(++_))<<24))+((1540483477*(o>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(o=1540483477*(65535&(o^=o>>>24))+((1540483477*(o>>>16)&65535)<<16)),c-=4,++_;switch(c){case 3:f^=(255&r.charCodeAt(_+2))<<16;case 2:f^=(255&r.charCodeAt(_+1))<<8;case 1:f=1540483477*(65535&(f^=255&r.charCodeAt(_)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};ku.exports=up,ku.exports.murmur3=up,ku.exports.murmur2=rg;var wc=nt(ku.exports);class rc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,o,c,f){this.ids.push(Go(e)),this.positions.push(o,c,f)}getPositions(e){const o=Go(e);let c=0,f=this.ids.length-1;for(;c<f;){const v=c+f>>1;this.ids[v]>=o?f=v:c=v+1}const _=[];for(;this.ids[c]===o;)_.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return _}static serialize(e,o){const c=new Float64Array(e.ids),f=new Uint32Array(e.positions);return dp(c,f,0,c.length-1),o&&o.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(e){const o=new rc;return o.ids=e.ids,o.positions=e.positions,o.indexed=!0,o}}function Go(r){const e=+r;return!isNaN(e)&&Number.MIN_SAFE_INTEGER<=e&&e<=Number.MAX_SAFE_INTEGER?e:wc(String(r))}function dp(r,e,o,c){for(;o<c;){const f=r[o+c>>1];let _=o-1,v=c+1;for(;;){do{_++}while(r[_]<f);do{v--}while(r[v]>f);if(_>=v)break;Id(r,_,v),Id(e,3*_,3*v),Id(e,3*_+1,3*v+1),Id(e,3*_+2,3*v+2)}v-o<c-v?(dp(r,e,o,v),o=v+1):(dp(r,e,v+1,c),c=v)}}function Id(r,e,o){const c=r[e];r[e]=r[o],r[o]=c}hi(rc,"FeaturePositionMap");class pl{constructor(e){this.gl=e.gl,this.initialized=!1}fetchUniformLocation(e,o){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(e,o),this.initialized=!0),!!this.location}}class kh extends pl{constructor(e){super(e),this.current=0}set(e,o,c){this.fetchUniformLocation(e,o)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class hp extends pl{constructor(e){super(e),this.current=[0,0,0,0]}set(e,o,c){this.fetchUniformLocation(e,o)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class Fh extends pl{constructor(e){super(e),this.current=O.transparent}set(e,o,c){this.fetchUniformLocation(e,o)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const Fu=new Float32Array(16),Nu=new Float32Array(9),Bu=new Float32Array(4);function Nh(r){return[Ot(255*r.r,255*r.g),Ot(255*r.b,255*r.a)]}class Xc{constructor(e,o,c){this.value=e,this.uniformNames=o.map(f=>`u_${f}`),this.type=c}setUniform(e,o,c,f,_){o.set(e,_,f.constantOr(this.value))}getBinding(e,o){return"color"===this.type?new Fh(e):new kh(e)}}class ml{constructor(e,o){this.uniformNames=o.map(c=>`u_${c}`),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(e){this.pixelRatio=e.pixelRatio||1,this.pattern=e.tl.concat(e.br)}setUniform(e,o,c,f,_){const v="u_pattern"===_||"u_dash"===_?this.pattern:"u_pixel_ratio"===_?this.pixelRatio:null;v&&o.set(e,_,v)}getBinding(e,o){return"u_pattern"===o||"u_dash"===o?new hp(e):new kh(e)}}class Cc{constructor(e,o,c,f){this.expression=e,this.type=c,this.maxValue=0,this.paintVertexAttributes=o.map(_=>({name:`a_${_}`,type:"Float32",components:"color"===c?2:1,offset:0})),this.paintVertexArray=new f}populatePaintArray(e,o,c,f,_,v){const w=this.paintVertexArray.length,E=this.expression.evaluate(new R(0),o,{},_,f,v);this.paintVertexArray.resize(e),this._setPaintValue(w,e,E)}updatePaintArray(e,o,c,f,_){const v=this.expression.evaluate({zoom:0},c,f,void 0,_);this._setPaintValue(e,o,v)}_setPaintValue(e,o,c){if("color"===this.type){const f=Nh(c);for(let _=e;_<o;_++)this.paintVertexArray.emplace(_,f[0],f[1])}else{for(let f=e;f<o;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class gl{constructor(e,o,c,f,_,v){this.expression=e,this.uniformNames=o.map(w=>`u_${w}_t`),this.type=c,this.useIntegerZoom=f,this.zoom=_,this.maxValue=0,this.paintVertexAttributes=o.map(w=>({name:`a_${w}`,type:"Float32",components:"color"===c?4:2,offset:0})),this.paintVertexArray=new v}populatePaintArray(e,o,c,f,_,v){const w=this.expression.evaluate(new R(this.zoom),o,{},_,f,v),E=this.expression.evaluate(new R(this.zoom+1),o,{},_,f,v),M=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(M,e,w,E)}updatePaintArray(e,o,c,f,_){const v=this.expression.evaluate({zoom:this.zoom},c,f,void 0,_),w=this.expression.evaluate({zoom:this.zoom+1},c,f,void 0,_);this._setPaintValue(e,o,v,w)}_setPaintValue(e,o,c,f){if("color"===this.type){const _=Nh(c),v=Nh(f);for(let w=e;w<o;w++)this.paintVertexArray.emplace(w,_[0],_[1],v[0],v[1])}else{for(let _=e;_<o;_++)this.paintVertexArray.emplace(_,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,o,c,f,_){const v=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,w=Ke(this.expression.interpolationFactor(v,this.zoom,this.zoom+1),0,1);o.set(e,_,w)}getBinding(e,o){return new kh(e)}}class Qc{constructor(e,o,c,f,_){this.expression=e,this.layerId=_,this.paintVertexAttributes=("array"===c?Sl:hl).members;for(let v=0;v<o.length;++v);this.paintVertexArray=new f}populatePaintArray(e,o,c){const f=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValues(f,e,o.patterns&&o.patterns[this.layerId],c)}updatePaintArray(e,o,c,f,_,v){this._setPaintValues(e,o,c.patterns&&c.patterns[this.layerId],v)}_setPaintValues(e,o,c,f){if(!f||!c)return;const _=f[c];if(!_)return;const{tl:v,br:w,pixelRatio:E}=_;for(let M=e;M<o;M++)this.paintVertexArray.emplace(M,v[0],v[1],w[0],w[1],E)}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class eu{constructor(e,o,c=(()=>!0)){this.binders={},this._buffers=[];const f=[];for(const _ in e.paint._values){if(!c(_))continue;const v=e.paint.get(_);if(!(v instanceof $e&&le(v.property.specification)))continue;const w=$0(_,e.type),E=v.value,M=v.property.specification.type,L=!!v.property.useIntegerZoom,N="line-dasharray"===_||_.endsWith("pattern"),j="line-dasharray"===_&&"constant"!==e.layout.get("line-cap").value.kind;if("constant"!==E.kind||j)if("source"===E.kind||j||N){const W=og(_,M,"source");this.binders[_]=N?new Qc(E,w,M,W,e.id):new Cc(E,w,M,W),f.push(`/a_${_}`)}else{const W=og(_,M,"composite");this.binders[_]=new gl(E,w,M,L,o,W),f.push(`/z_${_}`)}else this.binders[_]=N?new ml(E.value,w):new Xc(E.value,w,M),f.push(`/u_${_}`)}this.cacheKey=f.sort().join("")}getMaxValue(e){const o=this.binders[e];return o instanceof Cc||o instanceof gl?o.maxValue:0}populatePaintArrays(e,o,c,f,_,v){for(const w in this.binders){const E=this.binders[w];(E instanceof Cc||E instanceof gl||E instanceof Qc)&&E.populatePaintArray(e,o,c,f,_,v)}}setConstantPatternPositions(e){for(const o in this.binders){const c=this.binders[o];c instanceof ml&&c.setConstantPatternPositions(e)}}updatePaintArrays(e,o,c,f,_,v){let w=!1;for(const E in e){const M=o.getPositions(E);for(const L of M){const N=c.feature(L.index);for(const j in this.binders){const W=this.binders[j];if((W instanceof Cc||W instanceof gl||W instanceof Qc)&&!0===W.expression.isStateDependent){const J=f.paint.get(j);W.expression=J.value,W.updatePaintArray(L.start,L.end,N,e[E],_,v),w=!0}}}}return w}defines(){const e=[];for(const o in this.binders){const c=this.binders[o];(c instanceof Xc||c instanceof ml)&&e.push(...c.uniformNames.map(f=>`#define HAS_UNIFORM_${f}`))}return e}getBinderAttributes(){const e=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof Cc||c instanceof gl||c instanceof Qc)for(let f=0;f<c.paintVertexAttributes.length;f++)e.push(c.paintVertexAttributes[f].name)}return e}getBinderUniforms(){const e=[];for(const o in this.binders){const c=this.binders[o];if(c instanceof Xc||c instanceof ml||c instanceof gl)for(const f of c.uniformNames)e.push(f)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e){const o=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof Xc||f instanceof ml||f instanceof gl)for(const _ of f.uniformNames)o.push({name:_,property:c,binding:f.getBinding(e,_)})}return o}setUniforms(e,o,c,f,_){for(const{name:v,property:w,binding:E}of c)this.binders[w].setUniform(e,E,_,f.get(w),v)}updatePaintBuffers(){this._buffers=[];for(const e in this.binders){const o=this.binders[e];(o instanceof Cc||o instanceof gl||o instanceof Qc)&&o.paintVertexBuffer&&this._buffers.push(o.paintVertexBuffer)}}upload(e){for(const o in this.binders){const c=this.binders[o];(c instanceof Cc||c instanceof gl||c instanceof Qc)&&c.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const o=this.binders[e];(o instanceof Cc||o instanceof gl||o instanceof Qc)&&o.destroy()}}}class zu{constructor(e,o,c=(()=>!0)){this.programConfigurations={};for(const f of e)this.programConfigurations[f.id]=new eu(f,o,c);this.needsUpload=!1,this._featureMap=new rc,this._bufferOffset=0}populatePaintArrays(e,o,c,f,_,v,w){for(const E in this.programConfigurations)this.programConfigurations[E].populatePaintArrays(e,o,f,_,v,w);void 0!==o.id&&this._featureMap.add(o.id,c,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,o,c,f,_){for(const v of c)this.needsUpload=this.programConfigurations[v.id].updatePaintArrays(e,this._featureMap,o,v,f,_)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const o in this.programConfigurations)this.programConfigurations[o].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}const V0={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function $0(r,e){return V0[r]||[r.replace(`${e}-`,"").replace(/-/g,"_")]}const Z0={"line-pattern":{source:sn,composite:sn},"fill-pattern":{source:sn,composite:sn},"fill-extrusion-pattern":{source:sn,composite:sn},"line-dasharray":{source:An,composite:An}},Uu={color:{source:Aa,composite:qn},number:{source:Ir,composite:Aa}};function og(r,e,o){const c=Z0[r];return c&&c[o]||Uu[e][o]}hi(Xc,"ConstantBinder"),hi(ml,"PatternConstantBinder"),hi(Cc,"SourceExpressionBinder"),hi(Qc,"PatternCompositeBinder"),hi(gl,"CompositeExpressionBinder"),hi(eu,"ProgramConfiguration",{omit:["_buffers"]}),hi(zu,"ProgramConfigurationSet");const sg="-transition";class lo extends ln{constructor(e,o){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,"custom"!==e.type&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,"background"!==e.type&&"sky"!==e.type&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),o.layout&&(this._unevaluatedLayout=new Ye(o.layout)),o.paint)){this._transitionablePaint=new Q(o.paint);for(const c in e.paint)this.setPaintProperty(c,e.paint[c],{validate:!1});for(const c in e.layout)this.setLayoutProperty(c,e.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new et(o.paint)}}getLayoutProperty(e){return"visibility"===e?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,o,c={}){null!=o&&this._validate(ec,`layers.${this.id}.layout.${e}`,e,o,c)||("visibility"!==e?this._unevaluatedLayout.setValue(e,o):this.visibility=o)}getPaintProperty(e){return tt(e,sg)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,o,c={}){if(null!=o&&this._validate(Pu,`layers.${this.id}.paint.${e}`,e,o,c))return!1;if(tt(e,sg))return this._transitionablePaint.setTransition(e.slice(0,-11),o||void 0),!1;{const f=this._transitionablePaint._values[e],_=f.value.isDataDriven(),v=f.value;this._transitionablePaint.setValue(e,o),this._handleSpecialPaintPropertyUpdate(e);const w=this._transitionablePaint._values[e].value,E=w.isDataDriven(),M=tt(e,"pattern")||"line-dasharray"===e;return E||_||M||this._handleOverridablePaintPropertyUpdate(e,v,w)}}_handleSpecialPaintPropertyUpdate(e){}getProgramIds(){return null}getProgramConfiguration(e){return null}_handleOverridablePaintPropertyUpdate(e,o,c){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||"none"===this.visibility}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,o){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,o)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,o)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Xt(e,(o,c)=>!(void 0===o||"layout"===c&&!Object.keys(o).length||"paint"===c&&!Object.keys(o).length))}_validate(e,o,c,f,_={}){return(!_||!1!==_.validate)&&Ou(this,e.call(Su,{key:o,layerType:this.type,objectKey:c,value:f,styleSpec:vt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const o=this.paint.get(e);if(o instanceof $e&&le(o.property.specification)&&("source"===o.value.kind||"composite"===o.value.kind)&&o.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=yc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const hy=$t([{name:"a_pos",components:2,type:"Int16"}],4),Md=$t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class So{constructor(e=[]){this.segments=e}prepareSegment(e,o,c,f){let _=this.segments[this.segments.length-1];return e>So.MAX_VERTEX_ARRAY_LENGTH&&It(`Max vertices per segment is ${So.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!_||_.vertexLength+e>So.MAX_VERTEX_ARRAY_LENGTH||_.sortKey!==f)&&(_={vertexOffset:o.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},void 0!==f&&(_.sortKey=f),this.segments.push(_)),_}get(){return this.segments}destroy(){for(const e of this.segments)for(const o in e.vaos)e.vaos[o].destroy()}static simpleSegment(e,o,c,f){return new So([{vertexOffset:e,primitiveOffset:o,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}So.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,hi(So,"SegmentVector");var vi=8192;class Sa{constructor(e,o){e&&(o?this.setSouthWest(e).setNorthEast(o):4===e.length?this.setSouthWest([e[0],e[1]]).setNorthEast([e[2],e[3]]):this.setSouthWest(e[0]).setNorthEast(e[1]))}setNorthEast(e){return this._ne=e instanceof pr?new pr(e.lng,e.lat):pr.convert(e),this}setSouthWest(e){return this._sw=e instanceof pr?new pr(e.lng,e.lat):pr.convert(e),this}extend(e){const o=this._sw,c=this._ne;let f,_;if(e instanceof pr)f=e,_=e;else{if(!(e instanceof Sa))return Array.isArray(e)?4===e.length||e.every(Array.isArray)?this.extend(Sa.convert(e)):this.extend(pr.convert(e)):"object"==typeof e&&null!==e&&e.hasOwnProperty("lat")&&(e.hasOwnProperty("lon")||e.hasOwnProperty("lng"))?this.extend(pr.convert(e)):this;if(f=e._sw,_=e._ne,!f||!_)return this}return o||c?(o.lng=Math.min(f.lng,o.lng),o.lat=Math.min(f.lat,o.lat),c.lng=Math.max(_.lng,c.lng),c.lat=Math.max(_.lat,c.lat)):(this._sw=new pr(f.lng,f.lat),this._ne=new pr(_.lng,_.lat)),this}getCenter(){return new pr((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new pr(this.getWest(),this.getNorth())}getSouthEast(){return new pr(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(e){const{lng:o,lat:c}=pr.convert(e);let f=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(e){return!e||e instanceof Sa?e:new Sa(e)}}var Ad=1e-6,As=typeof Float32Array<"u"?Float32Array:Array;function Sd(){var r=new As(9);return As!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[5]=0,r[6]=0,r[7]=0),r[0]=1,r[4]=1,r[8]=1,r}function Bh(r,e,o){var c=e[0],f=e[1],_=e[2],v=e[3],w=e[4],E=e[5],M=e[6],L=e[7],N=e[8],j=o[0],W=o[1],J=o[2],se=o[3],Le=o[4],rt=o[5],bt=o[6],at=o[7],xt=o[8];return r[0]=j*c+W*v+J*M,r[1]=j*f+W*w+J*L,r[2]=j*_+W*E+J*N,r[3]=se*c+Le*v+rt*M,r[4]=se*f+Le*w+rt*L,r[5]=se*_+Le*E+rt*N,r[6]=bt*c+at*v+xt*M,r[7]=bt*f+at*w+xt*L,r[8]=bt*_+at*E+xt*N,r}function Ol(r){return r[0]=1,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=1,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=1,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function zh(r,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=e[4],w=e[5],E=e[6],M=e[7],L=e[8],N=e[9],j=e[10],W=e[11],J=e[12],se=e[13],Le=e[14],rt=e[15],bt=o*w-c*v,at=o*E-f*v,xt=o*M-_*v,At=c*E-f*w,Mt=c*M-_*w,un=f*M-_*E,rn=L*se-N*J,Dn=L*Le-j*J,Yn=L*rt-W*J,mn=N*Le-j*se,Pn=N*rt-W*se,Rn=j*rt-W*Le,zn=bt*Rn-at*Pn+xt*mn+At*Yn-Mt*Dn+un*rn;return zn?(r[0]=(w*Rn-E*Pn+M*mn)*(zn=1/zn),r[1]=(f*Pn-c*Rn-_*mn)*zn,r[2]=(se*un-Le*Mt+rt*At)*zn,r[3]=(j*Mt-N*un-W*At)*zn,r[4]=(E*Yn-v*Rn-M*Dn)*zn,r[5]=(o*Rn-f*Yn+_*Dn)*zn,r[6]=(Le*xt-J*un-rt*at)*zn,r[7]=(L*un-j*xt+W*at)*zn,r[8]=(v*Pn-w*Yn+M*rn)*zn,r[9]=(c*Yn-o*Pn-_*rn)*zn,r[10]=(J*Mt-se*xt+rt*bt)*zn,r[11]=(N*xt-L*Mt-W*bt)*zn,r[12]=(w*Dn-v*mn-E*rn)*zn,r[13]=(o*mn-c*Dn+f*rn)*zn,r[14]=(se*at-J*At-Le*bt)*zn,r[15]=(L*At-N*at+j*bt)*zn,r):null}function ju(r,e,o){var c=e[0],f=e[1],_=e[2],v=e[3],w=e[4],E=e[5],M=e[6],L=e[7],N=e[8],j=e[9],W=e[10],J=e[11],se=e[12],Le=e[13],rt=e[14],bt=e[15],at=o[0],xt=o[1],At=o[2],Mt=o[3];return r[0]=at*c+xt*w+At*N+Mt*se,r[1]=at*f+xt*E+At*j+Mt*Le,r[2]=at*_+xt*M+At*W+Mt*rt,r[3]=at*v+xt*L+At*J+Mt*bt,r[4]=(at=o[4])*c+(xt=o[5])*w+(At=o[6])*N+(Mt=o[7])*se,r[5]=at*f+xt*E+At*j+Mt*Le,r[6]=at*_+xt*M+At*W+Mt*rt,r[7]=at*v+xt*L+At*J+Mt*bt,r[8]=(at=o[8])*c+(xt=o[9])*w+(At=o[10])*N+(Mt=o[11])*se,r[9]=at*f+xt*E+At*j+Mt*Le,r[10]=at*_+xt*M+At*W+Mt*rt,r[11]=at*v+xt*L+At*J+Mt*bt,r[12]=(at=o[12])*c+(xt=o[13])*w+(At=o[14])*N+(Mt=o[15])*se,r[13]=at*f+xt*E+At*j+Mt*Le,r[14]=at*_+xt*M+At*W+Mt*rt,r[15]=at*v+xt*L+At*J+Mt*bt,r}function Ss(r,e,o){var c,f,_,v,w,E,M,L,N,j,W,J,se=o[0],Le=o[1],rt=o[2];return e===r?(r[12]=e[0]*se+e[4]*Le+e[8]*rt+e[12],r[13]=e[1]*se+e[5]*Le+e[9]*rt+e[13],r[14]=e[2]*se+e[6]*Le+e[10]*rt+e[14],r[15]=e[3]*se+e[7]*Le+e[11]*rt+e[15]):(f=e[1],_=e[2],v=e[3],w=e[4],E=e[5],M=e[6],L=e[7],N=e[8],j=e[9],W=e[10],J=e[11],r[0]=c=e[0],r[1]=f,r[2]=_,r[3]=v,r[4]=w,r[5]=E,r[6]=M,r[7]=L,r[8]=N,r[9]=j,r[10]=W,r[11]=J,r[12]=c*se+w*Le+N*rt+e[12],r[13]=f*se+E*Le+j*rt+e[13],r[14]=_*se+M*Le+W*rt+e[14],r[15]=v*se+L*Le+J*rt+e[15]),r}function oc(r,e,o){var c=o[0],f=o[1],_=o[2];return r[0]=e[0]*c,r[1]=e[1]*c,r[2]=e[2]*c,r[3]=e[3]*c,r[4]=e[4]*f,r[5]=e[5]*f,r[6]=e[6]*f,r[7]=e[7]*f,r[8]=e[8]*_,r[9]=e[9]*_,r[10]=e[10]*_,r[11]=e[11]*_,r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15],r}function Ec(r,e,o){var c=Math.sin(o),f=Math.cos(o),_=e[4],v=e[5],w=e[6],E=e[7],M=e[8],L=e[9],N=e[10],j=e[11];return e!==r&&(r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[3],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[4]=_*f+M*c,r[5]=v*f+L*c,r[6]=w*f+N*c,r[7]=E*f+j*c,r[8]=M*f-_*c,r[9]=L*f-v*c,r[10]=N*f-w*c,r[11]=j*f-E*c,r}function fp(r,e,o){var c=Math.sin(o),f=Math.cos(o),_=e[0],v=e[1],w=e[2],E=e[3],M=e[8],L=e[9],N=e[10],j=e[11];return e!==r&&(r[4]=e[4],r[5]=e[5],r[6]=e[6],r[7]=e[7],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=_*f-M*c,r[1]=v*f-L*c,r[2]=w*f-N*c,r[3]=E*f-j*c,r[8]=_*c+M*f,r[9]=v*c+L*f,r[10]=w*c+N*f,r[11]=E*c+j*f,r}function pp(r,e){return r[0]=e[0],r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=e[1],r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=e[2],r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r}function ag(r,e,o){var c,f,_,v=o[0],w=o[1],E=o[2],M=Math.hypot(v,w,E);return M<Ad?null:(v*=M=1/M,w*=M,E*=M,c=Math.sin(e),f=Math.cos(e),r[0]=v*v*(_=1-f)+f,r[1]=w*v*_+E*c,r[2]=E*v*_-w*c,r[3]=0,r[4]=v*w*_-E*c,r[5]=w*w*_+f,r[6]=E*w*_+v*c,r[7]=0,r[8]=v*E*_+w*c,r[9]=w*E*_-v*c,r[10]=E*E*_+f,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r)}Math.hypot||(Math.hypot=function(){for(var r=0,e=arguments.length;e--;)r+=arguments[e]*arguments[e];return Math.sqrt(r)});var fy=ju;function mp(){var r=new As(3);return As!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r}function lg(r){var e=new As(3);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e}function Pd(r){return Math.hypot(r[0],r[1],r[2])}function Vu(r,e,o){var c=new As(3);return c[0]=r,c[1]=e,c[2]=o,c}function _l(r,e,o){return r[0]=e[0]+o[0],r[1]=e[1]+o[1],r[2]=e[2]+o[2],r}function $u(r,e,o){return r[0]=e[0]-o[0],r[1]=e[1]-o[1],r[2]=e[2]-o[2],r}function cg(r,e,o){return r[0]=e[0]*o[0],r[1]=e[1]*o[1],r[2]=e[2]*o[2],r}function Tc(r,e,o){return r[0]=Math.min(e[0],o[0]),r[1]=Math.min(e[1],o[1]),r[2]=Math.min(e[2],o[2]),r}function Od(r,e,o){return r[0]=Math.max(e[0],o[0]),r[1]=Math.max(e[1],o[1]),r[2]=Math.max(e[2],o[2]),r}function qs(r,e,o){return r[0]=e[0]*o,r[1]=e[1]*o,r[2]=e[2]*o,r}function Rd(r,e,o,c){return r[0]=e[0]+o[0]*c,r[1]=e[1]+o[1]*c,r[2]=e[2]+o[2]*c,r}function Ps(r,e){var o=e[0],c=e[1],f=e[2],_=o*o+c*c+f*f;return _>0&&(_=1/Math.sqrt(_)),r[0]=e[0]*_,r[1]=e[1]*_,r[2]=e[2]*_,r}function xa(r,e){return r[0]*e[0]+r[1]*e[1]+r[2]*e[2]}function Zu(r,e,o){var c=e[0],f=e[1],_=e[2],v=o[0],w=o[1],E=o[2];return r[0]=f*E-_*w,r[1]=_*v-c*E,r[2]=c*w-f*v,r}function bo(r,e,o){var c=e[0],f=e[1],_=e[2],v=o[3]*c+o[7]*f+o[11]*_+o[15];return r[0]=(o[0]*c+o[4]*f+o[8]*_+o[12])/(v=v||1),r[1]=(o[1]*c+o[5]*f+o[9]*_+o[13])/v,r[2]=(o[2]*c+o[6]*f+o[10]*_+o[14])/v,r}function ug(r,e,o){var c=o[0],f=o[1],_=o[2],v=e[0],w=e[1],E=e[2],M=f*E-_*w,L=_*v-c*E,N=c*w-f*v,j=f*N-_*L,W=_*M-c*N,J=c*L-f*M,se=2*o[3];return L*=se,N*=se,W*=2,J*=2,r[0]=v+(M*=se)+(j*=2),r[1]=w+L+W,r[2]=E+N+J,r}var Ld,Ys=$u,kd=cg,py=Pd;function my(r,e,o){return r[0]=e[0]*o,r[1]=e[1]*o,r[2]=e[2]*o,r[3]=e[3]*o,r}function gp(r,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=o*o+c*c+f*f+_*_;return v>0&&(v=1/Math.sqrt(v)),r[0]=o*v,r[1]=c*v,r[2]=f*v,r[3]=_*v,r}function tu(r,e,o){var c=e[0],f=e[1],_=e[2],v=e[3];return r[0]=o[0]*c+o[4]*f+o[8]*_+o[12]*v,r[1]=o[1]*c+o[5]*f+o[9]*_+o[13]*v,r[2]=o[2]*c+o[6]*f+o[10]*_+o[14]*v,r[3]=o[3]*c+o[7]*f+o[11]*_+o[15]*v,r}function gy(){var r=new As(4);return As!=Float32Array&&(r[0]=0,r[1]=0,r[2]=0),r[3]=1,r}function dg(r){return r[0]=0,r[1]=0,r[2]=0,r[3]=1,r}function hg(r,e,o){o*=.5;var c=e[0],f=e[1],_=e[2],v=e[3],w=Math.sin(o),E=Math.cos(o);return r[0]=c*E+v*w,r[1]=f*E+_*w,r[2]=_*E-f*w,r[3]=v*E-c*w,r}function fg(r,e,o){o*=.5;var c=e[0],f=e[1],_=e[2],v=e[3],w=Math.sin(o),E=Math.cos(o);return r[0]=c*E-_*w,r[1]=f*E+v*w,r[2]=_*E+c*w,r[3]=v*E-f*w,r}mp(),Ld=new As(4),As!=Float32Array&&(Ld[0]=0,Ld[1]=0,Ld[2]=0,Ld[3]=0);var nu=gp;mp(),Vu(1,0,0),Vu(0,1,0),gy(),gy(),Sd();const pg=$t([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:Uh}=pg,Fd=$t([{name:"a_pos_3",components:3,type:"Int16"}]);var Dc=$t([{name:"a_pos",type:"Int16",components:2}]);class _p{constructor(e,o){this.pos=e,this.dir=o}intersectsPlane(e,o,c){const f=xa(o,this.dir);if(Math.abs(f)<1e-6)return!1;const _=((e[0]-this.pos[0])*o[0]+(e[1]-this.pos[1])*o[1]+(e[2]-this.pos[2])*o[2])/f;return c[0]=this.pos[0]+this.dir[0]*_,c[1]=this.pos[1]+this.dir[1]*_,c[2]=this.pos[2]+this.dir[2]*_,!0}closestPointOnSphere(e,o,c){if(se=(W=this.pos)[0],Le=W[1],rt=W[2],bt=(J=e)[0],at=J[1],xt=J[2],Math.abs(se-bt)<=Ad*Math.max(1,Math.abs(se),Math.abs(bt))&&Math.abs(Le-at)<=Ad*Math.max(1,Math.abs(Le),Math.abs(at))&&Math.abs(rt-xt)<=Ad*Math.max(1,Math.abs(rt),Math.abs(xt))||0===o)return c[0]=c[1]=c[2]=0,!1;var W,J,se,Le,rt,bt,at,xt;const[f,_,v]=this.dir,w=this.pos[0]-e[0],E=this.pos[1]-e[1],M=this.pos[2]-e[2],L=f*f+_*_+v*v,N=2*(w*f+E*_+M*v),j=N*N-4*L*(w*w+E*E+M*M-o*o);if(j<0){const W=Math.max(-N/2,0),J=w+f*W,se=E+_*W,Le=M+v*W,rt=Math.hypot(J,se,Le);return c[0]=J*o/rt,c[1]=se*o/rt,c[2]=Le*o/rt,!1}{const W=(-N-Math.sqrt(j))/(2*L);if(W<0){const J=Math.hypot(w,E,M);return c[0]=w*o/J,c[1]=E*o/J,c[2]=M*o/J,!1}return c[0]=w+f*W,c[1]=E+_*W,c[2]=M+v*W,!0}}}class jh{constructor(e,o,c,f,_){this.TL=e,this.TR=o,this.BR=c,this.BL=f,this.horizon=_}static fromInvProjectionMatrix(e,o,c){const f=[-1,1,1],_=[1,1,1],v=[1,-1,1],w=[-1,-1,1],E=bo(f,f,e),M=bo(_,_,e),L=bo(v,v,e),N=bo(w,w,e);return new jh(E,M,L,N,o/c)}}class Vh{constructor(e,o){this.points=e,this.planes=o}static fromInvProjectionMatrix(e,o,c,f){const _=Math.pow(2,c),v=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(E=>{const M=tu([],E,e),L=1/M[3]/o*_;return(N=M)[0]=(j=M)[0]*(W=[L,L,f?1/M[3]:L,L])[0],N[1]=j[1]*W[1],N[2]=j[2]*W[2],N[3]=j[3]*W[3],N;var N,j,W}),w=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(E=>{const M=Ps([],Zu([],Ys([],v[E[0]],v[E[1]]),Ys([],v[E[2]],v[E[1]]))),L=-xa(M,v[E[1]]);return M.concat(L)});return new Vh(v,w)}}class ss{static fromPoints(e){const o=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of e)Tc(o,o,f),Od(c,c,f);return new ss(o,c)}static applyTransform(e,o){const c=e.getCorners();for(let f=0;f<c.length;++f)bo(c[f],c[f],o);return ss.fromPoints(c)}constructor(e,o){this.min=e,this.max=o,this.center=qs([],_l([],this.min,this.max),.5)}quadrant(e){const o=[e%2==0,e<2],c=lg(this.min),f=lg(this.max);for(let _=0;_<o.length;_++)c[_]=o[_]?this.min[_]:this.center[_],f[_]=o[_]?this.center[_]:this.max[_];return f[2]=this.max[2],new ss(c,f)}distanceX(e){return Math.max(Math.min(this.max[0],e[0]),this.min[0])-e[0]}distanceY(e){return Math.max(Math.min(this.max[1],e[1]),this.min[1])-e[1]}distanceZ(e){return Math.max(Math.min(this.max[2],e[2]),this.min[2])-e[2]}getCorners(){const e=this.min,o=this.max;return[[e[0],e[1],e[2]],[o[0],e[1],e[2]],[o[0],o[1],e[2]],[e[0],o[1],e[2]],[e[0],e[1],o[2]],[o[0],e[1],o[2]],[o[0],o[1],o[2]],[e[0],o[1],o[2]]]}intersects(e){const o=this.getCorners();let c=!0;for(let f=0;f<e.planes.length;f++){const _=e.planes[f];let v=0;for(let w=0;w<o.length;w++)v+=xa(_,o[w])+_[3]>=0;if(0===v)return 0;v!==o.length&&(c=!1)}if(c)return 2;for(let f=0;f<3;f++){let _=Number.MAX_VALUE,v=-Number.MAX_VALUE;for(let w=0;w<e.points.length;w++){const E=e.points[w][f]-this.min[f];_=Math.min(_,E),v=Math.max(v,E)}if(v<0||_>this.max[f]-this.min[f])return 0}return 1}}const mg=5,$h=6,Rl=vi/Math.PI/2,yp=16383,Gu=[64,32,16],fs=-Rl,Ja=Rl,vp=[new ss([fs,fs,fs],[Ja,Ja,Ja]),new ss([fs,fs,fs],[0,0,Ja]),new ss([0,fs,fs],[Ja,0,Ja]),new ss([fs,0,fs],[0,Ja,Ja]),new ss([0,0,fs],[Ja,Ja,Ja])];function iu(r){return r*Rl/Hh}function gg(r,e,o,c=!0){const f=qs([],r._camera.position,r.worldSize),_=[e,o,1,1];tu(_,_,r.pixelMatrixInverse),my(_,_,1/_[3]);const v=Ps([],Ys([],_,f)),w=r.globeMatrix,E=[w[12],w[13],w[14]],M=Ys([],E,f),L=Pd(M),N=Ps([],M),j=r.worldSize/(2*Math.PI),W=xa(N,v),J=Math.asin(j/L);if(J<Math.acos(W)){if(!c)return null;const Yn=[],mn=[];qs(Yn,v,L/W),Ps(mn,Ys(mn,Yn,M)),Ps(v,_l(v,M,qs(v,mn,Math.tan(J)*L)))}const se=[];new _p(f,v).closestPointOnSphere(E,j,se);const Le=Ps([],Ve(w,0)),rt=Ps([],Ve(w,1)),bt=Ps([],Ve(w,2)),at=xa(Le,se),xt=xa(rt,se),At=xa(bt,se),Mt=ve(Math.asin(-xt/j));let un=ve(Math.atan2(at,At));un=r.center.lng+function(Yn,mn){const Pn=(mn-Yn+180)%360-180;return Pn<-180?Pn+360:Pn}(r.center.lng,un);const rn=Os(un),Dn=Ke(Pa(Mt),0,1);return new Oa(rn,Dn)}class xp{constructor(e,o,c){this.a=Ys([],e,c),this.b=Ys([],o,c),this.center=c;const f=Ps([],this.a),_=Ps([],this.b);this.angle=Math.acos(xa(f,_))}}function Hu(r,e){if(0===r.angle)return null;let o;return o=0===r.a[e]?1/r.angle*.5*Math.PI:1/r.angle*Math.atan(r.b[e]/r.a[e]/Math.sin(r.angle)-1/Math.tan(r.angle)),o<0||o>1?null:function(c,f,_,v){const w=Math.sin(_);return c*(Math.sin((1-v)*_)/w)+f*(Math.sin(v*_)/w)}(r.a[e],r.b[e],r.angle,Ke(o,0,1))+r.center[e]}function as(r){if(r.z<=1)return vp[r.z+2*r.y+r.x];const e=Mc(Nd(r));return ss.fromPoints(e)}function Ka(r,e,o){return qs(r,r,1-o),Rd(r,r,e,o)}function Zh(r,e){const o=Ju(e.zoom);if(0===o)return as(r);const c=Nd(r),f=Mc(c),_=Os(c.getWest())*e.worldSize,v=Os(c.getEast())*e.worldSize,w=Pa(c.getNorth())*e.worldSize,E=Pa(c.getSouth())*e.worldSize,M=[_,w,0],L=[v,w,0],N=[_,E,0],j=[v,E,0],W=zh([],e.globeMatrix);return bo(M,M,W),bo(L,L,W),bo(N,N,W),bo(j,j,W),f[0]=Ka(f[0],N,o),f[1]=Ka(f[1],j,o),f[2]=Ka(f[2],L,o),f[3]=Ka(f[3],M,o),ss.fromPoints(f)}function _g(r,e,o){for(const c of r)bo(c,c,e),qs(c,c,o)}function Nd({x:r,y:e,z:o}){const c=1/(1<<o),f=new pr(Rs(r*c),ps((e+1)*c)),_=new pr(Rs((r+1)*c),ps(e*c));return new Sa(f,_)}function Mc(r){const e=X(r.getNorth()),o=X(r.getSouth()),c=Math.cos(e),f=Math.cos(o),_=Math.sin(e),v=Math.sin(o),w=r.getWest(),E=r.getEast();return[Wu(f,v,w),Wu(f,v,E),Wu(c,_,E),Wu(c,_,w)]}function Wu(r,e,o,c=Rl){return o=X(o),[r*Math.sin(o)*c,-e*c,r*Math.cos(o)*c]}function qu(r,e,o){return Wu(Math.cos(X(r)),Math.sin(X(r)),e,o)}function Bd(r,e,o,c){const f=1<<o.z,_=(r/vi+o.x)/f;return qu(ps((e/vi+o.y)/f),Rs(_),c)}function Yu({min:r,max:e}){return yp/Math.max(e[0]-r[0],e[1]-r[1],e[2]-r[2])}const yg=new Float64Array(16);function ru(r){const e=Yu(r),o=pp(yg,[e,e,e]);return Ss(o,o,((c=[])[0]=-(f=r.min)[0],c[1]=-f[1],c[2]=-f[2],c));var c,f}function Gh(r){const e=(c=r.min,(o=yg)[0]=1,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=1,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=1,o[11]=0,o[12]=c[0],o[13]=c[1],o[14]=c[2],o[15]=1,o);var o,c;const f=1/Yu(r);return oc(e,e,[f,f,f])}function vg(r,e,o,c,f){const _=function(E){const M=vi/(2*Math.PI);return E/(2*Math.PI)/M}(o),v=[r,e,-o/(2*Math.PI)],w=Ol(new Float64Array(16));return Ss(w,w,v),oc(w,w,[_,_,_]),Ec(w,w,X(-f)),fp(w,w,X(-c)),w}function Ju(r){return Ht(mg,$h,r)}function bp(r,e){const o=qu(e.lat,e.lng);return v=(f=$u([],function(J){const se=qu(J._center.lat,J._center.lng);let Le=Zu([],Vu(0,1,0),se);const rt=ag([],-J.angle,se);Le=bo(Le,Le,rt),ag(rt,-J._pitch,Le);const bt=Ps([],se);return qs(bt,bt,iu(J.cameraToCenterDistance/J.pixelsPerMeter)),bo(bt,bt,rt),_l([],se,bt)}(r),o))[0],w=f[1],E=f[2],M=(_=o)[0],L=_[1],N=_[2],W=(j=Math.sqrt(v*v+w*w+E*E)*Math.sqrt(M*M+L*L+N*N))&&xa(f,_)/j,Math.acos(Math.min(Math.max(W,-1),1));var f,_,v,w,E,M,L,N,j,W}function wp(r,e){return bp(r,e)>Math.PI/2*1.01}const Cp=X(85),yy=Math.cos(Cp),vy=Math.sin(Cp),Hh=6371008.8,Ep=2*Math.PI*Hh;class sc{constructor(e,o){if(isNaN(e)||isNaN(o))throw new Error(`Invalid LngLat object: (${e}, ${o})`);if(this.lng=+e,this.lat=+o,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new sc(dn(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const o=Math.PI/180,c=this.lat*o,f=e.lat*o,_=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((e.lng-this.lng)*o);return Hh*Math.acos(Math.min(_,1))}toBounds(e=0){const o=360*e/40075017,c=o/Math.cos(Math.PI/180*this.lat);return new Sa(new sc(this.lng-c,this.lat-o),new sc(this.lng+c,this.lat+o))}toEcef(e){const o=iu(e);return qu(this.lat,this.lng,Rl+o)}static convert(e){if(e instanceof sc)return e;if(Array.isArray(e)&&(2===e.length||3===e.length))return new sc(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&"object"==typeof e&&null!==e)return new sc(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var pr=sc;function zd(r){return Ep*Math.cos(r*Math.PI/180)}function Os(r){return(180+r)/360}function Pa(r){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+r*Math.PI/360)))/360}function Xa(r,e){return r/zd(e)}function Rs(r){return 360*r-180}function ps(r){return 360/Math.PI*Math.atan(Math.exp((180-360*r)*Math.PI/180))-90}function xg(r,e){return r*zd(ps(e))}const Ho=85.051129;function bg(r){return 1/Math.cos(r*Math.PI/180)}class Oa{constructor(e,o,c=0){this.x=+e,this.y=+o,this.z=+c}static fromLngLat(e,o=0){const c=pr.convert(e);return new Oa(Os(c.lng),Pa(c.lat),Xa(o,c.lat))}toLngLat(){return new pr(Rs(this.x),ps(this.y))}toAltitude(){return xg(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Ep*bg(ps(this.y))}}function Wh(r,e,o,c,f,_,v,w,E){const M=(e+c)/2,L=(o+f)/2,N=new ye(M,L);w(N),function(j,W,J,se,Le,rt){const bt=J-Le,at=se-rt;return Math.abs((se-W)*bt-(J-j)*at)/Math.hypot(bt,at)}(N.x,N.y,_.x,_.y,v.x,v.y)>=E?(Wh(r,e,o,M,L,_,N,w,E),Wh(r,M,L,c,f,N,v,w,E)):r.push(v)}function wg(r,e,o){let c=r[0],f=c.x,_=c.y;e(c);const v=[c];for(let w=1;w<r.length;w++){const E=r[w],{x:M,y:L}=E;e(E),Wh(v,f,_,M,L,c,E,e,o),f=M,_=L,c=E}return v}function qh(r,e,o,c){if(c(e,o)){const f=e.add(o)._mult(.5);qh(r,e,f,c),qh(r,f,o,c)}else r.push(o)}function Tp(r,e){let o=r[0];const c=[o];for(let f=1;f<r.length;f++){const _=r[f];qh(c,o,_,e),o=_}return c}const Cg=Math.pow(2,14)-1,xy=-Cg-1;function by(r,e){const o=Math.round(r.x*e),c=Math.round(r.y*e);return r.x=Ke(o,xy,Cg),r.y=Ke(c,xy,Cg),(o<r.x||o>r.x+1||c<r.y||c>r.y+1)&&It("Geometry exceeds allowed extent, reduce your vector tile buffer size"),r}function ac(r,e,o){const c=r.loadGeometry(),f=r.extent,_=vi/f;if(e&&o&&o.projection.isReprojectedInTileSpace){const v=1<<e.z,{scale:w,x:E,y:M,projection:L}=o,N=j=>{const W=Rs((e.x+j.x/f)/v),J=ps((e.y+j.y/f)/v),se=L.project(W,J);j.x=(se.x*w-E)*f,j.y=(se.y*w-M)*f};for(let j=0;j<c.length;j++)if(1!==r.type)c[j]=wg(c[j],N,1);else{const W=[];for(const J of c[j])J.x<0||J.x>=f||J.y<0||J.y>=f||(N(J),W.push(J));c[j]=W}}for(const v of c)for(const w of v)by(w,_);return c}function ou(r,e){return{type:r.type,id:r.id,properties:r.properties,geometry:e?ac(r):[]}}function Yh(r,e,o,c,f){r.emplaceBack(2*e+(c+1)/2,2*o+(f+1)/2)}function Jh(r,e,o){r.emplaceBack(e.x,e.y,e.z,16384*o[0],16384*o[1],16384*o[2])}class Kh{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.projection=e.projection,this.layoutVertexArray=new Wn,this.indexArray=new Ci,this.segments=new So,this.programConfigurations=new zu(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,c,f){const _=this.layers[0],v=[];let w=null;"circle"===_.type&&(w=_.layout.get("circle-sort-key"));for(const{feature:M,id:L,index:N,sourceLayerIndex:j}of e){const W=this.layers[0]._featureFilter.needGeometry,J=ou(M,W);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),J,c))continue;const se=w?w.evaluate(J,{},c):void 0,Le={id:L,properties:M.properties,type:M.type,sourceLayerIndex:j,index:N,geometry:W?J.geometry:ac(M,c,f),patterns:{},sortKey:se};v.push(Le)}w&&v.sort((M,L)=>M.sortKey-L.sortKey);let E=null;"globe"===f.projection.name&&(this.globeExtVertexArray=new Zn,E=f.projection);for(const M of v){const{geometry:L,index:N,sourceLayerIndex:j}=M,W=e[N].feature;this.addFeature(M,L,N,o.availableImages,c,E),o.featureIndex.insert(W,L,N,j,this.index)}}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,hy.members),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Md.members))),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(e,o,c,f,_,v){for(const w of o)for(const E of w){const M=E.x,L=E.y;if(M<0||M>=vi||L<0||L>=vi)continue;if(v){const W=v.projectTilePoint(M,L,_),J=v.upVector(_,M,L),se=this.globeExtVertexArray;Jh(se,W,J),Jh(se,W,J),Jh(se,W,J),Jh(se,W,J)}const N=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),j=N.vertexLength;Yh(this.layoutVertexArray,M,L,-1,-1),Yh(this.layoutVertexArray,M,L,1,-1),Yh(this.layoutVertexArray,M,L,1,1),Yh(this.layoutVertexArray,M,L,-1,1),this.indexArray.emplaceBack(j,j+1,j+2),this.indexArray.emplaceBack(j,j+2,j+3),N.vertexLength+=4,N.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,{},f,_)}}function su(r,e){for(let o=0;o<r.length;o++)if(Sc(e,r[o]))return!0;for(let o=0;o<e.length;o++)if(Sc(r,e[o]))return!0;return!!Xh(r,e)}function Ra(r,e,o){return!!Sc(r,e)||!!au(e,r,o)}function lc(r,e){if(1===r.length)return Ud(e,r[0]);for(let o=0;o<e.length;o++){const c=e[o];for(let f=0;f<c.length;f++)if(Sc(r,c[f]))return!0}for(let o=0;o<r.length;o++)if(Ud(e,r[o]))return!0;for(let o=0;o<e.length;o++)if(Xh(r,e[o]))return!0;return!1}function Dp(r,e,o){if(r.length>1){if(Xh(r,e))return!0;for(let c=0;c<e.length;c++)if(au(e[c],r,o))return!0}for(let c=0;c<r.length;c++)if(au(r[c],e,o))return!0;return!1}function Xh(r,e){if(0===r.length||0===e.length)return!1;for(let o=0;o<r.length-1;o++){const c=r[o],f=r[o+1];for(let _=0;_<e.length-1;_++)if(Ac(c,f,e[_],e[_+1]))return!0}return!1}function Ac(r,e,o,c){return pe(r,o,c)!==pe(e,o,c)&&pe(r,e,o)!==pe(r,e,c)}function au(r,e,o){const c=o*o;if(1===e.length)return r.distSqr(e[0])<c;for(let f=1;f<e.length;f++)if(wy(r,e[f-1],e[f])<c)return!0;return!1}function wy(r,e,o){const c=e.distSqr(o);if(0===c)return r.distSqr(e);const f=((r.x-e.x)*(o.x-e.x)+(r.y-e.y)*(o.y-e.y))/c;return r.distSqr(f<0?e:f>1?o:o.sub(e)._mult(f)._add(e))}function Ud(r,e){let o,c,f,_=!1;for(let v=0;v<r.length;v++){o=r[v];for(let w=0,E=o.length-1;w<o.length;E=w++)c=o[w],f=o[E],c.y>e.y!=f.y>e.y&&e.x<(f.x-c.x)*(e.y-c.y)/(f.y-c.y)+c.x&&(_=!_)}return _}function Sc(r,e){let o=!1;for(let c=0,f=r.length-1;c<r.length;f=c++){const _=r[c],v=r[f];_.y>e.y!=v.y>e.y&&e.x<(v.x-_.x)*(e.y-_.y)/(v.y-_.y)+_.x&&(o=!o)}return o}function Eg(r,e,o,c,f){for(const v of r)if(e<=v.x&&o<=v.y&&c>=v.x&&f>=v.y)return!0;const _=[new ye(e,o),new ye(e,f),new ye(c,f),new ye(c,o)];if(r.length>2)for(const v of _)if(Sc(r,v))return!0;for(let v=0;v<r.length-1;v++)if(Tg(r[v],r[v+1],_))return!0;return!1}function Tg(r,e,o){const c=o[0],f=o[2];if(r.x<c.x&&e.x<c.x||r.x>f.x&&e.x>f.x||r.y<c.y&&e.y<c.y||r.y>f.y&&e.y>f.y)return!1;const _=pe(r,e,o[0]);return _!==pe(r,e,o[1])||_!==pe(r,e,o[2])||_!==pe(r,e,o[3])}function jd(r,e,o){const c=e.paint.get(r).value;return"constant"===c.kind?c.value:o.programConfigurations.get(e.id).getMaxValue(r)}function Vd(r){return Math.sqrt(r[0]*r[0]+r[1]*r[1])}function Cy(r,e,o,c,f){if(!e[0]&&!e[1])return r;const _=ye.convert(e)._mult(f);"viewport"===o&&_._rotate(-c);const v=[];for(let w=0;w<r.length;w++)v.push(r[w].sub(_));return v}function Dg(r,e,o,c){const f=ye.convert(r)._mult(c);return"viewport"===e&&f._rotate(-o),f}hi(Kh,"CircleBucket",{omit:["layers"]});const Ey=new gt({"circle-sort-key":new He(vt.layout_circle["circle-sort-key"])});var Ip={paint:new gt({"circle-radius":new He(vt.paint_circle["circle-radius"]),"circle-color":new He(vt.paint_circle["circle-color"]),"circle-blur":new He(vt.paint_circle["circle-blur"]),"circle-opacity":new He(vt.paint_circle["circle-opacity"]),"circle-translate":new ne(vt.paint_circle["circle-translate"]),"circle-translate-anchor":new ne(vt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new ne(vt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new ne(vt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new He(vt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new He(vt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new He(vt.paint_circle["circle-stroke-opacity"])}),layout:Ey};function Ty(r,e,o,c,f,_,v,w,E){if(_&&r.queryGeometry.isAboveHorizon)return!1;_&&(E*=r.pixelToTileUnitsFactor);const M=r.tileID.canonical,L=o.projection.upVectorScale(M,o.center.lat,o.worldSize).metersToTile;for(const N of e)for(const j of N){const W=j.add(w),J=f&&o.elevation?o.elevation.exaggeration()*f.getElevationAt(W.x,W.y,!0):0,se=o.projection.projectTilePoint(W.x,W.y,M);if(J>0){const at=o.projection.upVector(M,W.x,W.y);se.x+=at[0]*L*J,se.y+=at[1]*L*J,se.z+=at[2]*L*J}const Le=_?W:G0(se.x,se.y,se.z,c),rt=_?r.tilespaceRays.map(at=>W0(at,J)):r.queryGeometry.screenGeometry,bt=tu([],[se.x,se.y,se.z,1],c);if(!v&&_?E*=bt[3]/o.cameraToCenterDistance:v&&!_&&(E*=o.cameraToCenterDistance/bt[3]),_){const at=ps((j.y/vi+M.y)/(1<<M.z));E/=o.projection.pixelsPerMeter(at,1)/Xa(1,at)}if(Ra(rt,Le,E))return!0}return!1}function G0(r,e,o,c){const f=tu([],[r,e,o,1],c);return new ye(f[0]/f[3],f[1]/f[3])}const Qh=Vu(0,0,0),H0=Vu(0,0,1);function W0(r,e){const o=mp();return Qh[2]=e,r.intersectsPlane(Qh,H0,o),new ye(o[0],o[1])}class Dy extends Kh{}function Iy(r,{width:e,height:o},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==e*o*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(e*o*c);return r.width=e,r.height=o,r.data=f,r}function My(r,e,o){const{width:c,height:f}=e;c===r.width&&f===r.height||(Mp(r,e,{x:0,y:0},{x:0,y:0},{width:Math.min(r.width,c),height:Math.min(r.height,f)},o),r.width=c,r.height=f,r.data=e.data)}function Mp(r,e,o,c,f,_){if(0===f.width||0===f.height)return e;if(f.width>r.width||f.height>r.height||o.x>r.width-f.width||o.y>r.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>e.width||f.height>e.height||c.x>e.width-f.width||c.y>e.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const v=r.data,w=e.data;for(let E=0;E<f.height;E++){const M=((o.y+E)*r.width+o.x)*_,L=((c.y+E)*e.width+c.x)*_;for(let N=0;N<f.width*_;N++)w[L+N]=v[M+N]}return e}hi(Dy,"HeatmapBucket",{omit:["layers"]});class Qa{constructor(e,o){Iy(this,e,1,o)}resize(e){My(this,new Qa(e),1)}clone(){return new Qa({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,c,f,_){Mp(e,o,c,f,_,1)}}class Ls{constructor(e,o){Iy(this,e,4,o)}resize(e){My(this,new Ls(e),4)}replace(e,o){o?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new Ls({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,o,c,f,_){Mp(e,o,c,f,_,4)}}hi(Qa,"AlphaImage"),hi(Ls,"RGBAImage");var Ap={paint:new gt({"heatmap-radius":new He(vt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new He(vt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new ne(vt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new ht(vt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new ne(vt.paint_heatmap["heatmap-opacity"])})};function ef(r){const e={},o=r.resolution||256,c=r.clips?r.clips.length:1,f=r.image||new Ls({width:o,height:c}),_=(v,w,E)=>{e[r.evaluationKey]=E;const M=r.expression.evaluate(e);f.data[v+w+0]=Math.floor(255*M.r/M.a),f.data[v+w+1]=Math.floor(255*M.g/M.a),f.data[v+w+2]=Math.floor(255*M.b/M.a),f.data[v+w+3]=Math.floor(255*M.a)};if(r.clips)for(let v=0,w=0;v<c;++v,w+=4*o)for(let E=0,M=0;E<o;E++,M+=4){const L=E/(o-1),{start:N,end:j}=r.clips[v];_(w,M,N*(1-L)+j*L)}else for(let v=0,w=0;v<o;v++,w+=4)_(0,w,v/(o-1));return f}var Ig={paint:new gt({"hillshade-illumination-direction":new ne(vt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new ne(vt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new ne(vt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new ne(vt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new ne(vt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new ne(vt.paint_hillshade["hillshade-accent-color"])})};const $d=$t([{name:"a_pos",components:2,type:"Int16"}],4),{members:Ay}=$d;var tf={exports:{}};function Zd(r,e,o){o=o||2;var c,f,_,v,w,E,M,L=e&&e.length,N=L?e[0]*o:r.length,j=Gd(r,0,N,o,!0),W=[];if(!j||j.next===j.prev)return W;if(L&&(j=function(se,Le,rt,bt){var at,xt,At,Mt=[];for(at=0,xt=Le.length;at<xt;at++)(At=Gd(se,Le[at]*bt,at<xt-1?Le[at+1]*bt:se.length,bt,!1))===At.next&&(At.steiner=!0),Mt.push(Ag(At));for(Mt.sort(Sp),at=0;at<Mt.length;at++)rt=Ry(Mt[at],rt);return rt}(r,e,j,o)),r.length>80*o){c=_=r[0],f=v=r[1];for(var J=o;J<N;J+=o)(w=r[J])<c&&(c=w),(E=r[J+1])<f&&(f=E),w>_&&(_=w),E>v&&(v=E);M=0!==(M=Math.max(_-c,v-f))?32767/M:0}return Pc(j,W,o,c,f,M,0),W}function Gd(r,e,o,c,f){var _,v;if(f===kp(r,e,o,c)>0)for(_=e;_<o;_+=c)v=Lp(_,r[_],r[_+1],v);else for(_=o-c;_>=e;_-=c)v=Lp(_,r[_],r[_+1],v);return v&&Xu(v,v.next)&&(Hd(v),v=v.next),v}function Ll(r,e){if(!r)return r;e||(e=r);var o,c=r;do{if(o=!1,c.steiner||!Xu(c,c.next)&&0!==Mr(c.prev,c,c.next))c=c.next;else{if(Hd(c),(c=e=c.prev)===c.next)break;o=!0}}while(o||c!==e);return e}function Pc(r,e,o,c,f,_,v){if(r){!v&&_&&function(L,N,j,W){var J=L;do{0===J.z&&(J.z=Pp(J.x,J.y,N,j,W)),J.prevZ=J.prev,J.nextZ=J.next,J=J.next}while(J!==L);J.prevZ.nextZ=null,J.prevZ=null,function(se){var Le,rt,bt,at,xt,At,Mt,un,rn=1;do{for(rt=se,se=null,xt=null,At=0;rt;){for(At++,bt=rt,Mt=0,Le=0;Le<rn&&(Mt++,bt=bt.nextZ);Le++);for(un=rn;Mt>0||un>0&&bt;)0!==Mt&&(0===un||!bt||rt.z<=bt.z)?(at=rt,rt=rt.nextZ,Mt--):(at=bt,bt=bt.nextZ,un--),xt?xt.nextZ=at:se=at,at.prevZ=xt,xt=at;rt=bt}xt.nextZ=null,rn*=2}while(At>1)}(J)}(r,c,f,_);for(var w,E,M=r;r.prev!==r.next;)if(w=r.prev,E=r.next,_?Py(r,c,f,_):Sy(r))e.push(w.i/o|0),e.push(r.i/o|0),e.push(E.i/o|0),Hd(r),r=E.next,M=E.next;else if((r=E)===M){v?1===v?Pc(r=Oy(Ll(r),e,o),e,o,c,f,_,2):2===v&&Mg(r,e,o,c,f,_):Pc(Ll(r),e,o,c,f,_,1);break}}}function Sy(r){var e=r.prev,o=r,c=r.next;if(Mr(e,o,c)>=0)return!1;for(var f=e.x,_=o.x,v=c.x,w=e.y,E=o.y,M=c.y,L=f<_?f<v?f:v:_<v?_:v,N=w<E?w<M?w:M:E<M?E:M,j=f>_?f>v?f:v:_>v?_:v,W=w>E?w>M?w:M:E>M?E:M,J=c.next;J!==e;){if(J.x>=L&&J.x<=j&&J.y>=N&&J.y<=W&&Ku(f,w,_,E,v,M,J.x,J.y)&&Mr(J.prev,J,J.next)>=0)return!1;J=J.next}return!0}function Py(r,e,o,c){var f=r.prev,_=r,v=r.next;if(Mr(f,_,v)>=0)return!1;for(var w=f.x,E=_.x,M=v.x,L=f.y,N=_.y,j=v.y,W=w<E?w<M?w:M:E<M?E:M,J=L<N?L<j?L:j:N<j?N:j,se=w>E?w>M?w:M:E>M?E:M,Le=L>N?L>j?L:j:N>j?N:j,rt=Pp(W,J,e,o,c),bt=Pp(se,Le,e,o,c),at=r.prevZ,xt=r.nextZ;at&&at.z>=rt&&xt&&xt.z<=bt;){if(at.x>=W&&at.x<=se&&at.y>=J&&at.y<=Le&&at!==f&&at!==v&&Ku(w,L,E,N,M,j,at.x,at.y)&&Mr(at.prev,at,at.next)>=0||(at=at.prevZ,xt.x>=W&&xt.x<=se&&xt.y>=J&&xt.y<=Le&&xt!==f&&xt!==v&&Ku(w,L,E,N,M,j,xt.x,xt.y)&&Mr(xt.prev,xt,xt.next)>=0))return!1;xt=xt.nextZ}for(;at&&at.z>=rt;){if(at.x>=W&&at.x<=se&&at.y>=J&&at.y<=Le&&at!==f&&at!==v&&Ku(w,L,E,N,M,j,at.x,at.y)&&Mr(at.prev,at,at.next)>=0)return!1;at=at.prevZ}for(;xt&&xt.z<=bt;){if(xt.x>=W&&xt.x<=se&&xt.y>=J&&xt.y<=Le&&xt!==f&&xt!==v&&Ku(w,L,E,N,M,j,xt.x,xt.y)&&Mr(xt.prev,xt,xt.next)>=0)return!1;xt=xt.nextZ}return!0}function Oy(r,e,o){var c=r;do{var f=c.prev,_=c.next.next;!Xu(f,_)&&Op(f,c,c.next,_)&&cc(f,_)&&cc(_,f)&&(e.push(f.i/o|0),e.push(c.i/o|0),e.push(_.i/o|0),Hd(c),Hd(c.next),c=r=_),c=c.next}while(c!==r);return Ll(c)}function Mg(r,e,o,c,f,_){var v=r;do{for(var w=v.next.next;w!==v.prev;){if(v.i!==w.i&&ky(v,w)){var E=Rp(v,w);return v=Ll(v,v.next),E=Ll(E,E.next),Pc(v,e,o,c,f,_,0),void Pc(E,e,o,c,f,_,0)}w=w.next}v=v.next}while(v!==r)}function Sp(r,e){return r.x-e.x}function Ry(r,e){var o=function(f,_){var v,w=_,E=f.x,M=f.y,L=-1/0;do{if(M<=w.y&&M>=w.next.y&&w.next.y!==w.y){var N=w.x+(M-w.y)*(w.next.x-w.x)/(w.next.y-w.y);if(N<=E&&N>L&&(L=N,v=w.x<w.next.x?w:w.next,N===E))return v}w=w.next}while(w!==_);if(!v)return null;var j,W=v,J=v.x,se=v.y,Le=1/0;w=v;do{E>=w.x&&w.x>=J&&E!==w.x&&Ku(M<se?E:L,M,J,se,M<se?L:E,M,w.x,w.y)&&(j=Math.abs(M-w.y)/(E-w.x),cc(w,f)&&(j<Le||j===Le&&(w.x>v.x||w.x===v.x&&Ly(v,w)))&&(v=w,Le=j)),w=w.next}while(w!==W);return v}(r,e);if(!o)return e;var c=Rp(o,r);return Ll(c,c.next),Ll(o,o.next)}function Ly(r,e){return Mr(r.prev,r,e.prev)<0&&Mr(e.next,r,r.next)<0}function Pp(r,e,o,c,f){return(r=1431655765&((r=858993459&((r=252645135&((r=16711935&((r=(r-o)*f|0)|r<<8))|r<<4))|r<<2))|r<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-c)*f|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function Ag(r){var e=r,o=r;do{(e.x<o.x||e.x===o.x&&e.y<o.y)&&(o=e),e=e.next}while(e!==r);return o}function Ku(r,e,o,c,f,_,v,w){return(f-v)*(e-w)>=(r-v)*(_-w)&&(r-v)*(c-w)>=(o-v)*(e-w)&&(o-v)*(_-w)>=(f-v)*(c-w)}function ky(r,e){return r.next.i!==e.i&&r.prev.i!==e.i&&!function(o,c){var f=o;do{if(f.i!==o.i&&f.next.i!==o.i&&f.i!==c.i&&f.next.i!==c.i&&Op(f,f.next,o,c))return!0;f=f.next}while(f!==o);return!1}(r,e)&&(cc(r,e)&&cc(e,r)&&function(o,c){var f=o,_=!1,v=(o.x+c.x)/2,w=(o.y+c.y)/2;do{f.y>w!=f.next.y>w&&f.next.y!==f.y&&v<(f.next.x-f.x)*(w-f.y)/(f.next.y-f.y)+f.x&&(_=!_),f=f.next}while(f!==o);return _}(r,e)&&(Mr(r.prev,r,e.prev)||Mr(r,e.prev,e))||Xu(r,e)&&Mr(r.prev,r,r.next)>0&&Mr(e.prev,e,e.next)>0)}function Mr(r,e,o){return(e.y-r.y)*(o.x-e.x)-(e.x-r.x)*(o.y-e.y)}function Xu(r,e){return r.x===e.x&&r.y===e.y}function Op(r,e,o,c){var f=ls(Mr(r,e,o)),_=ls(Mr(r,e,c)),v=ls(Mr(o,c,r)),w=ls(Mr(o,c,e));return f!==_&&v!==w||!(0!==f||!Qu(r,o,e))||!(0!==_||!Qu(r,c,e))||!(0!==v||!Qu(o,r,c))||!(0!==w||!Qu(o,e,c))}function Qu(r,e,o){return e.x<=Math.max(r.x,o.x)&&e.x>=Math.min(r.x,o.x)&&e.y<=Math.max(r.y,o.y)&&e.y>=Math.min(r.y,o.y)}function ls(r){return r>0?1:r<0?-1:0}function cc(r,e){return Mr(r.prev,r,r.next)<0?Mr(r,e,r.next)>=0&&Mr(r,r.prev,e)>=0:Mr(r,e,r.prev)<0||Mr(r,r.next,e)<0}function Rp(r,e){var o=new nf(r.i,r.x,r.y),c=new nf(e.i,e.x,e.y),f=r.next,_=e.prev;return r.next=e,e.prev=r,o.next=f,f.prev=o,c.next=o,o.prev=c,_.next=c,c.prev=_,c}function Lp(r,e,o,c){var f=new nf(r,e,o);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Hd(r){r.next.prev=r.prev,r.prev.next=r.next,r.prevZ&&(r.prevZ.nextZ=r.nextZ),r.nextZ&&(r.nextZ.prevZ=r.prevZ)}function nf(r,e,o){this.i=r,this.x=e,this.y=o,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function kp(r,e,o,c){for(var f=0,_=e,v=o-c;_<o;_+=c)f+=(r[v]-r[_])*(r[_+1]+r[v+1]),v=_;return f}tf.exports=Zd,tf.exports.default=Zd,Zd.deviation=function(r,e,o,c){var f=e&&e.length,_=Math.abs(kp(r,0,f?e[0]*o:r.length,o));if(f)for(var v=0,w=e.length;v<w;v++)_-=Math.abs(kp(r,e[v]*o,v<w-1?e[v+1]*o:r.length,o));var E=0;for(v=0;v<c.length;v+=3){var M=c[v]*o,L=c[v+1]*o,N=c[v+2]*o;E+=Math.abs((r[M]-r[N])*(r[L+1]-r[M+1])-(r[M]-r[L])*(r[N+1]-r[M+1]))}return 0===_&&0===E?0:Math.abs((E-_)/_)},Zd.flatten=function(r){for(var e=r[0][0].length,o={vertices:[],holes:[],dimensions:e},c=0,f=0;f<r.length;f++){for(var _=0;_<r[f].length;_++)for(var v=0;v<e;v++)o.vertices.push(r[f][_][v]);f>0&&o.holes.push(c+=r[f-1].length)}return o};var rf=nt(tf.exports);function Fy(r,e,o,c,f){Fp(r,e,o||0,c||r.length-1,f||Ny)}function Fp(r,e,o,c,f){for(;c>o;){if(c-o>600){var _=c-o+1,v=e-o+1,w=Math.log(_),E=.5*Math.exp(2*w/3),M=.5*Math.sqrt(w*E*(_-E)/_)*(v-_/2<0?-1:1);Fp(r,e,Math.max(o,Math.floor(e-v*E/_+M)),Math.min(c,Math.floor(e+(_-v)*E/_+M)),f)}var L=r[e],N=o,j=c;for(Wd(r,o,e),f(r[c],L)>0&&Wd(r,o,c);N<j;){for(Wd(r,N,j),N++,j--;f(r[N],L)<0;)N++;for(;f(r[j],L)>0;)j--}0===f(r[o],L)?Wd(r,o,j):Wd(r,++j,c),j<=e&&(o=j+1),e<=j&&(c=j-1)}}function Wd(r,e,o){var c=r[e];r[e]=r[o],r[o]=c}function Ny(r,e){return r<e?-1:r>e?1:0}function qd(r,e){const o=r.length;if(o<=1)return[r];const c=[];let f,_;for(let v=0;v<o;v++){const w=lt(r[v]);0!==w&&(r[v].area=Math.abs(w),void 0===_&&(_=w<0),_===w<0?(f&&c.push(f),f=[r[v]]):f.push(r[v]))}if(f&&c.push(f),e>1)for(let v=0;v<c.length;v++)c[v].length<=e||(Fy(c[v],e,1,c[v].length-1,Np),c[v]=c[v].slice(0,e));return c}function Np(r,e){return e.area-r.area}function Bp(r,e,o){const c=o.patternDependencies;let f=!1;for(const _ of e){const v=_.paint.get(`${r}-pattern`);v.isConstant()||(f=!0);const w=v.constantOr(null);w&&(f=!0,c[w]=!0)}return f}function Oc(r,e,o,c,f){const _=f.patternDependencies;for(const v of e){const w=v.paint.get(`${r}-pattern`).value;if("constant"!==w.kind){let E=w.evaluate({zoom:c},o,{},f.availableImages);E=E&&E.name?E.name:E,_[E]=!0,o.patterns[v.id]=E}}return o}class lu{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new Wn,this.indexArray=new Ci,this.indexArray2=new is,this.programConfigurations=new zu(e.layers,e.zoom),this.segments=new So,this.segments2=new So,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.projection=e.projection}populate(e,o,c,f){this.hasPattern=Bp("fill",this.layers,o);const _=this.layers[0].layout.get("fill-sort-key"),v=[];for(const{feature:w,id:E,index:M,sourceLayerIndex:L}of e){const N=this.layers[0]._featureFilter.needGeometry,j=ou(w,N);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),j,c))continue;const W=_?_.evaluate(j,{},c,o.availableImages):void 0,J={id:E,properties:w.properties,type:w.type,sourceLayerIndex:L,index:M,geometry:N?j.geometry:ac(w,c,f),patterns:{},sortKey:W};v.push(J)}_&&v.sort((w,E)=>w.sortKey-E.sortKey);for(const w of v){const{geometry:E,index:M,sourceLayerIndex:L}=w;if(this.hasPattern){const N=Oc("fill",this.layers,w,this.zoom,o);this.patternFeatures.push(N)}else this.addFeature(w,E,M,c,{},o.availableImages);o.featureIndex.insert(e[M].feature,E,M,L,this.index)}}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}addFeatures(e,o,c,f,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ay),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,o,c,f,_,v=[]){for(const w of qd(o,500)){let E=0;for(const J of w)E+=J.length;const M=this.segments.prepareSegment(E,this.layoutVertexArray,this.indexArray),L=M.vertexLength,N=[],j=[];for(const J of w){if(0===J.length)continue;J!==w[0]&&j.push(N.length/2);const se=this.segments2.prepareSegment(J.length,this.layoutVertexArray,this.indexArray2),Le=se.vertexLength;this.layoutVertexArray.emplaceBack(J[0].x,J[0].y),this.indexArray2.emplaceBack(Le+J.length-1,Le),N.push(J[0].x),N.push(J[0].y);for(let rt=1;rt<J.length;rt++)this.layoutVertexArray.emplaceBack(J[rt].x,J[rt].y),this.indexArray2.emplaceBack(Le+rt-1,Le+rt),N.push(J[rt].x),N.push(J[rt].y);se.vertexLength+=J.length,se.primitiveLength+=J.length}const W=rf(N,j);for(let J=0;J<W.length;J+=3)this.indexArray.emplaceBack(L+W[J],L+W[J+1],L+W[J+2]);M.vertexLength+=E,M.primitiveLength+=W.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,v,f)}}hi(lu,"FillBucket",{omit:["layers","patternFeatures"]});const Sg=new gt({"fill-sort-key":new He(vt.layout_fill["fill-sort-key"])});var zp={paint:new gt({"fill-antialias":new ne(vt.paint_fill["fill-antialias"]),"fill-opacity":new He(vt.paint_fill["fill-opacity"]),"fill-color":new He(vt.paint_fill["fill-color"]),"fill-outline-color":new He(vt.paint_fill["fill-outline-color"]),"fill-translate":new ne(vt.paint_fill["fill-translate"]),"fill-translate-anchor":new ne(vt.paint_fill["fill-translate-anchor"]),"fill-pattern":new He(vt.paint_fill["fill-pattern"])}),layout:Sg};const sf=$t([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),By=$t([{name:"a_centroid_pos",components:2,type:"Uint16"}]),zy=$t([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Pg}=sf;var af={},Uy=Ie,Og=cu;function cu(r,e,o,c,f){this.properties={},this.extent=o,this.type=0,this._pbf=r,this._geometry=-1,this._keys=c,this._values=f,r.readFields(Yd,this,e)}function Yd(r,e,o){1==r?e.id=o.readVarint():2==r?function(c,f){for(var _=c.readVarint()+c.pos;c.pos<_;){var v=f._keys[c.readVarint()],w=f._values[c.readVarint()];f.properties[v]=w}}(o,e):3==r?e.type=o.readVarint():4==r&&(e._geometry=o.pos)}function lf(r){for(var e,o,c=0,f=0,_=r.length,v=_-1;f<_;v=f++)c+=((o=r[v]).x-(e=r[f]).x)*(e.y+o.y);return c}cu.types=["Unknown","Point","LineString","Polygon"],cu.prototype.loadGeometry=function(){var r=this._pbf;r.pos=this._geometry;for(var e,o=r.readVarint()+r.pos,c=1,f=0,_=0,v=0,w=[];r.pos<o;){if(f<=0){var E=r.readVarint();c=7&E,f=E>>3}if(f--,1===c||2===c)_+=r.readSVarint(),v+=r.readSVarint(),1===c&&(e&&w.push(e),e=[]),e.push(new Uy(_,v));else{if(7!==c)throw new Error("unknown command "+c);e&&e.push(e[0].clone())}}return e&&w.push(e),w},cu.prototype.bbox=function(){var r=this._pbf;r.pos=this._geometry;for(var e=r.readVarint()+r.pos,o=1,c=0,f=0,_=0,v=1/0,w=-1/0,E=1/0,M=-1/0;r.pos<e;){if(c<=0){var L=r.readVarint();o=7&L,c=L>>3}if(c--,1===o||2===o)(f+=r.readSVarint())<v&&(v=f),f>w&&(w=f),(_+=r.readSVarint())<E&&(E=_),_>M&&(M=_);else if(7!==o)throw new Error("unknown command "+o)}return[v,E,w,M]},cu.prototype.toGeoJSON=function(r,e,o){var c,f,_=this.extent*Math.pow(2,o),v=this.extent*r,w=this.extent*e,E=this.loadGeometry(),M=cu.types[this.type];function L(W){for(var J=0;J<W.length;J++){var se=W[J];W[J]=[360*(se.x+v)/_-180,360/Math.PI*Math.atan(Math.exp((180-360*(se.y+w)/_)*Math.PI/180))-90]}}switch(this.type){case 1:var N=[];for(c=0;c<E.length;c++)N[c]=E[c][0];L(E=N);break;case 2:for(c=0;c<E.length;c++)L(E[c]);break;case 3:for(E=function(W){var J=W.length;if(J<=1)return[W];for(var se,Le,rt=[],bt=0;bt<J;bt++){var at=lf(W[bt]);0!==at&&(void 0===Le&&(Le=at<0),Le===at<0?(se&&rt.push(se),se=[W[bt]]):se.push(W[bt]))}return se&&rt.push(se),rt}(E),c=0;c<E.length;c++)for(f=0;f<E[c].length;f++)L(E[c][f])}1===E.length?E=E[0]:M="Multi"+M;var j={type:"Feature",geometry:{type:M,coordinates:E},properties:this.properties};return"id"in this&&(j.id=this.id),j};var Up=Og,Rg=Lg;function Lg(r,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=r,this._keys=[],this._values=[],this._features=[],r.readFields(jp,this,e),this.length=this._features.length}function jp(r,e,o){15===r?e.version=o.readVarint():1===r?e.name=o.readString():5===r?e.extent=o.readVarint():2===r?e._features.push(o.pos):3===r?e._keys.push(o.readString()):4===r&&e._values.push(function(c){for(var f=null,_=c.readVarint()+c.pos;c.pos<_;){var v=c.readVarint()>>3;f=1===v?c.readString():2===v?c.readFloat():3===v?c.readDouble():4===v?c.readVarint64():5===v?c.readVarint():6===v?c.readSVarint():7===v?c.readBoolean():null}return f}(o))}Lg.prototype.feature=function(r){if(r<0||r>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[r];var e=this._pbf.readVarint()+this._pbf.pos;return new Up(this._pbf,e,this.extent,this._keys,this._values)};var kg=Rg;function uu(r,e,o){if(3===r){var c=new kg(o,o.readVarint()+o.pos);c.length&&(e[c.name]=c)}}var cf=af.VectorTile=function(r,e){this.layers=r.readFields(uu,{},e)},Jd=af.VectorTileFeature=Og;function uf(r,e,o,c){const f=[],_=0===c?(v,w,E,M,L,N)=>{v.push(new ye(N,E+(N-w)/(M-w)*(L-E)))}:(v,w,E,M,L,N)=>{v.push(new ye(w+(N-E)/(L-E)*(M-w),N))};for(const v of r){const w=[];for(const E of v){if(E.length<=2)continue;const M=[];for(let j=0;j<E.length-1;j++){const W=E[j].x,J=E[j].y,se=E[j+1].x,Le=E[j+1].y,rt=0===c?W:J,bt=0===c?se:Le;rt<e?bt>e&&_(M,W,J,se,Le,e):rt>o?bt<o&&_(M,W,J,se,Le,o):M.push(E[j]),bt<e&&rt>=e&&_(M,W,J,se,Le,e),bt>o&&rt<=o&&_(M,W,J,se,Le,o)}let L=E[E.length-1];const N=0===c?L.x:L.y;N>=e&&N<=o&&M.push(L),M.length&&(L=M[M.length-1],M[0].x===L.x&&M[0].y===L.y||M.push(M[0]),w.push(M))}w.length&&f.push(w)}return f}af.VectorTileLayer=Rg;const q0=Jd.types,df=Math.pow(2,13);function Kd(r,e,o,c,f,_,v,w){r.emplaceBack((e<<1)+v,(o<<1)+_,(Math.floor(c*df)<<1)+f,Math.round(w))}function ed(r,e,o){r.emplaceBack(e.x,e.y,e.z,16384*o[0],16384*o[1],16384*o[2])}class Vp{constructor(){this.acc=new ye(0,0),this.polyCount=[]}startRing(e){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new ye(e.x,e.y),this.max=new ye(e.x,e.y))}append(e,o){this.currentPolyCount.edges++,this.acc._add(e);const c=this.min,f=this.max;e.x<c.x?c.x=e.x:e.x>f.x&&(f.x=e.x),e.y<c.y?c.y=e.y:e.y>f.y&&(f.y=e.y),((0===e.x||e.x===vi)&&e.x===o.x)!=((0===e.y||e.y===vi)&&e.y===o.y)&&this.processBorderOverlap(e,o),o.x<0!=e.x<0&&this.addBorderIntersection(0,Pi(o.y,e.y,(0-o.x)/(e.x-o.x))),o.x>vi!=e.x>vi&&this.addBorderIntersection(1,Pi(o.y,e.y,(vi-o.x)/(e.x-o.x))),o.y<0!=e.y<0&&this.addBorderIntersection(2,Pi(o.x,e.x,(0-o.y)/(e.y-o.y))),o.y>vi!=e.y>vi&&this.addBorderIntersection(3,Pi(o.x,e.x,(vi-o.y)/(e.y-o.y)))}addBorderIntersection(e,o){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[e];o<c[0]&&(c[0]=o),o>c[1]&&(c[1]=o)}processBorderOverlap(e,o){if(e.x===o.x){if(e.y===o.y)return;const c=0===e.x?0:1;this.addBorderIntersection(c,o.y),this.addBorderIntersection(c,e.y)}else{const c=0===e.y?2:3;this.addBorderIntersection(c,o.x),this.addBorderIntersection(c,e.x)}}centroid(){const e=this.polyCount.reduce((o,c)=>o+c.edges,0);return 0!==e?this.acc.div(e)._round():new ye(0,0)}span(){return new ye(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce((e,o)=>e+ +(o[0]!==Number.MAX_VALUE),0)}}class td{constructor(e){this.zoom=e.zoom,this.canonical=e.canonical,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=e.projection,this.layoutVertexArray=new Mn,this.centroidVertexArray=new Ya,this.indexArray=new Ci,this.programConfigurations=new zu(e.layers,e.zoom),this.segments=new So,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id),this.enableTerrain=e.enableTerrain}populate(e,o,c,f){this.features=[],this.hasPattern=Bp("fill-extrusion",this.layers,o),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=function(_){const v=Math.exp(Math.PI*(1-_.y/(1<<_.z)*2));return 80150034*v/(v*v+1)/vi/(1<<_.z)}(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:_,id:v,index:w,sourceLayerIndex:E}of e){const M=this.layers[0]._featureFilter.needGeometry,L=ou(_,M);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),L,c))continue;const N={id:v,sourceLayerIndex:E,index:w,geometry:M?L.geometry:ac(_,c,f),properties:_.properties,type:_.type,patterns:{}},j=this.layoutVertexArray.length;this.hasPattern?this.features.push(Oc("fill-extrusion",this.layers,N,this.zoom,o)):this.addFeature(N,N.geometry,w,c,{},o.availableImages,f),o.featureIndex.insert(_,N.geometry,w,E,this.index,j)}this.sortBorders()}addFeatures(e,o,c,f,_){for(const v of this.features){const{geometry:w}=v;this.addFeature(v,w,v.index,o,c,f,_)}this.sortBorders()}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Pg),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=e.createVertexBuffer(this.layoutVertexExtArray,zy.members,!0))),this.programConfigurations.upload(e),this.uploaded=!0}uploadCentroid(e){0!==this.centroidVertexArray.length&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,By.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,o,c,f,_,v,w){const E=[new ye(0,0),new ye(vi,vi)],M=w.projection,L="globe"===M.name,N=this.enableTerrain&&!L?new Vp:null,j="Polygon"===q0[e.type];L&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Zn);const W=qd(o,500);for(let rt=W.length-1;rt>=0;rt--){const bt=W[rt];(0===bt.length||(J=bt[0]).every(at=>at.x<=0)||J.every(at=>at.x>=vi)||J.every(at=>at.y<=0)||J.every(at=>at.y>=vi))&&W.splice(rt,1)}var J;let se;if(L)se=Zp(W,E,f);else{se=[];for(const rt of W)se.push({polygon:rt,bounds:E})}const Le=j?this.edgeRadius:0;for(const{polygon:rt,bounds:bt}of se){let at=0,xt=0;for(const Mt of rt)j&&!Mt[0].equals(Mt[Mt.length-1])&&Mt.push(Mt[0]),xt+=j?Mt.length-1:Mt.length;const At=this.segments.prepareSegment((j?5:4)*xt,this.layoutVertexArray,this.indexArray);if(j){const Mt=[],un=[];at=At.vertexLength;for(const Dn of rt){let Yn,mn;Dn.length&&Dn!==rt[0]&&un.push(Mt.length/2),Yn=Dn[1].sub(Dn[0])._perp()._unit();for(let Pn=1;Pn<Dn.length;Pn++){const Rn=Dn[Pn],zn=Dn[Pn===Dn.length-1?1:Pn+1];let{x:Qn,y:En}=Rn;if(Le){mn=zn.sub(Rn)._perp()._unit();const ai=Yn.add(mn)._unit(),gi=Le*Math.min(4,1/(Yn.x*ai.x+Yn.y*ai.y));Qn+=gi*ai.x,En+=gi*ai.y,Yn=mn}Kd(this.layoutVertexArray,Qn,En,0,0,1,1,0),At.vertexLength++,Mt.push(Rn.x,Rn.y),L&&ed(this.layoutVertexExtArray,M.projectTilePoint(Qn,En,f),M.upVector(f,Qn,En))}}const rn=rf(Mt,un);for(let Dn=0;Dn<rn.length;Dn+=3)this.indexArray.emplaceBack(at+rn[Dn],at+rn[Dn+2],at+rn[Dn+1]),At.primitiveLength++}for(const Mt of rt){N&&Mt.length&&N.startRing(Mt[0]);let un,rn,Dn,Yn=Mt.length>4&&$p(Mt[Mt.length-2],Mt[0],Mt[1]),mn=Le?Fg(Mt[Mt.length-2],Mt[0],Mt[1],Le):0;rn=Mt[1].sub(Mt[0])._perp()._unit();let Pn=!0;for(let Rn=1,zn=0;Rn<Mt.length;Rn++){let Qn=Mt[Rn-1],En=Mt[Rn];const ai=Mt[Rn===Mt.length-1?1:Rn+1];if(N&&j&&N.currentPolyCount.top++,nd(En,Qn,bt)){Le&&(rn=ai.sub(En)._perp()._unit(),Pn=!Pn);continue}N&&N.append(En,Qn);const gi=En.sub(Qn)._perp(),ci=gi.x/(Math.abs(gi.x)+Math.abs(gi.y)),Ji=gi.y>0?1:0,ri=Qn.dist(En);if(zn+ri>32768&&(zn=0),Le){Dn=ai.sub(En)._perp()._unit();let Ki=Xd(Qn,En,ai,hf(rn,Dn),Le);isNaN(Ki)&&(Ki=0);const Ni=En.sub(Qn)._unit();Qn=Qn.add(Ni.mult(mn))._round(),En=En.add(Ni.mult(-Ki))._round(),mn=Ki,rn=Dn}const Ai=At.vertexLength,Zi=Mt.length>4&&$p(Qn,En,ai);let wr=ff(zn,Yn,Pn);if(Kd(this.layoutVertexArray,Qn.x,Qn.y,ci,Ji,0,0,wr),Kd(this.layoutVertexArray,Qn.x,Qn.y,ci,Ji,0,1,wr),zn+=ri,wr=ff(zn,Zi,!Pn),Yn=Zi,Kd(this.layoutVertexArray,En.x,En.y,ci,Ji,0,0,wr),Kd(this.layoutVertexArray,En.x,En.y,ci,Ji,0,1,wr),At.vertexLength+=4,this.indexArray.emplaceBack(Ai+0,Ai+1,Ai+2),this.indexArray.emplaceBack(Ai+1,Ai+3,Ai+2),At.primitiveLength+=2,Le){const Ki=at+(1===Rn?Mt.length-2:Rn-2),Ni=1===Rn?at:Ki+1;if(this.indexArray.emplaceBack(Ai+1,Ki,Ai+3),this.indexArray.emplaceBack(Ki,Ni,Ai+3),At.primitiveLength+=2,void 0===un&&(un=Ai),!nd(ai,Mt[Rn],bt)){const io=Rn===Mt.length-1?un:At.vertexLength;this.indexArray.emplaceBack(Ai+2,Ai+3,io),this.indexArray.emplaceBack(Ai+3,io+1,io),this.indexArray.emplaceBack(Ai+3,Ni,io+1),At.primitiveLength+=3}Pn=!Pn}if(L){const Ki=this.layoutVertexExtArray,Ni=M.projectTilePoint(Qn.x,Qn.y,f),io=M.projectTilePoint(En.x,En.y,f),er=M.upVector(f,Qn.x,Qn.y),tr=M.upVector(f,En.x,En.y);ed(Ki,Ni,er),ed(Ki,Ni,er),ed(Ki,io,tr),ed(Ki,io,tr)}}j&&(at+=Mt.length-1)}}if(N&&N.polyCount.length>0){if(N.borders){N.vertexArrayOffset=this.centroidVertexArray.length;const rt=N.borders,bt=this.featuresOnBorder.push(N)-1;for(let at=0;at<4;at++)rt[at][0]!==Number.MAX_VALUE&&this.borders[at].push(bt)}this.encodeCentroid(N.borders?void 0:N.centroid(),N)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,v,f)}sortBorders(){for(let e=0;e<4;e++)this.borders[e].sort((o,c)=>this.featuresOnBorder[o].borders[e][0]-this.featuresOnBorder[c].borders[e][0])}encodeCentroid(e,o,c=!0){let f,_;if(e)if(0!==e.y){const w=o.span()._mult(this.tileToMeter);f=(Math.max(e.x,1)<<3)+Math.min(7,Math.round(w.x/10)),_=(Math.max(e.y,1)<<3)+Math.min(7,Math.round(w.y/10))}else f=Math.ceil(7*(e.x+450)),_=0;else f=0,_=+c;let v=c?this.centroidVertexArray.length:o.vertexArrayOffset;for(const w of o.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*w.edges+w.top);for(let E=0;E<w.top;E++)this.centroidVertexArray.emplace(v++,f,_);for(let E=0;E<2*w.edges;E++)this.centroidVertexArray.emplace(v++,0,_),this.centroidVertexArray.emplace(v++,f,_)}}}function hf(r,e){const o=r.add(e)._unit();return r.x*o.x+r.y*o.y}function Fg(r,e,o,c){const f=e.sub(r)._perp()._unit(),_=o.sub(e)._perp()._unit();return Xd(r,e,o,hf(f,_),c)}function Xd(r,e,o,c,f){const _=Math.sqrt(1-c*c);return Math.min(r.dist(e)/3,e.dist(o)/3,f*_/c)}function nd(r,e,o){return r.x<o[0].x&&e.x<o[0].x||r.x>o[1].x&&e.x>o[1].x||r.y<o[0].y&&e.y<o[0].y||r.y>o[1].y&&e.y>o[1].y}function $p(r,e,o){if(r.x<0||r.x>=vi||e.x<0||e.x>=vi||o.x<0||o.x>=vi)return!1;const c=o.sub(e),f=c.perp(),_=r.sub(e);return(c.x*_.x+c.y*_.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(_.x*_.x+_.y*_.y))>-.866&&f.x*_.x+f.y*_.y<0}function ff(r,e,o){const c=e?2|r:-3&r;return o?1|c:-2&c}function Qd(){const r=Math.PI/32,e=Math.tan(r),o=Hh;return o*Math.sqrt(1+2*e*e)-o}function Zp(r,e,o){const c=1<<o.z,f=Rs(o.x/c),_=Rs((o.x+1)/c),v=ps(o.y/c),w=ps((o.y+1)/c);return function(E,M,L,N,j=0,W){const J=[];if(!E.length||!L||!N)return J;const se=(Mt,un)=>{for(const rn of Mt)J.push({polygon:rn,bounds:un})},Le=Math.ceil(Math.log2(L)),rt=Math.ceil(Math.log2(N)),bt=Le-rt,at=[];for(let Mt=0;Mt<Math.abs(bt);Mt++)at.push(bt>0?0:1);for(let Mt=0;Mt<Math.min(Le,rt);Mt++)at.push(0),at.push(1);let xt=E;if(xt=uf(xt,M[0].y-j,M[1].y+j,1),xt=uf(xt,M[0].x-j,M[1].x+j,0),!xt.length)return J;const At=[];for(at.length?At.push({polygons:xt,bounds:M,depth:0}):se(xt,M);At.length;){const Mt=At.pop(),un=Mt.depth,rn=at[un],Dn=Mt.bounds[0],Yn=Mt.bounds[1],mn=0===rn?Dn.x:Dn.y,Pn=0===rn?Yn.x:Yn.y,Rn=W?W(rn,mn,Pn):.5*(mn+Pn),zn=uf(Mt.polygons,mn-j,Rn+j,rn),Qn=uf(Mt.polygons,Rn-j,Pn+j,rn);if(zn.length){const En=[Dn,new ye(0===rn?Rn:Yn.x,1===rn?Rn:Yn.y)];at.length>un+1?At.push({polygons:zn,bounds:En,depth:un+1}):se(zn,En)}if(Qn.length){const En=[new ye(0===rn?Rn:Dn.x,1===rn?Rn:Dn.y),Yn];at.length>un+1?At.push({polygons:Qn,bounds:En,depth:un+1}):se(Qn,En)}}return J}(r,e,Math.ceil((_-f)/11.25),Math.ceil((v-w)/11.25),1,(E,M,L)=>{if(0===E)return.5*(M+L);{const N=ps((o.y+M/vi)/c);return(Pa(.5*(ps((o.y+L/vi)/c)+N))*c-o.y)*vi}})}hi(td,"FillExtrusionBucket",{omit:["layers","features"]}),hi(Vp,"PartMetadata");const Gp=new gt({"fill-extrusion-edge-radius":new ne(vt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var pf={paint:new gt({"fill-extrusion-opacity":new ne(vt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new He(vt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new ne(vt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new ne(vt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new He(vt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new He(vt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new He(vt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new ne(vt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new ne(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new ne(vt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new ne(vt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:Gp};function Ng(r,e,o){var c=2*Math.PI*6378137/256/Math.pow(2,o);return[r*c-2*Math.PI*6378137/2,e*c-2*Math.PI*6378137/2]}class eh{constructor(e,o,c){this.z=e,this.x=o,this.y=c,this.key=th(0,e,e,o,c)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,o){const c=(v=this.y,w=this.z,E=Ng(256*(_=this.x),256*(v=Math.pow(2,w)-v-1),w),M=Ng(256*(_+1),256*(v+1),w),E[0]+","+E[1]+","+M[0]+","+M[1]),f=function(_,v,w){let E,M="";for(let L=_;L>0;L--)E=1<<L-1,M+=(v&E?1:0)+(w&E?2:0);return M}(this.z,this.x,this.y);var _,v,w,E,M;return e[(this.x+this.y)%e.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String("tms"===o?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Bg{constructor(e,o){this.wrap=e,this.canonical=o,this.key=th(e,o.z,o.z,o.x,o.y)}}class Js{constructor(e,o,c,f,_){this.overscaledZ=e,this.wrap=o,this.canonical=new eh(c,+f,+_),this.key=0===o&&e===c?this.canonical.key:th(o,e,c,f,_)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){const o=this.canonical.z-e;return e>this.canonical.z?new Js(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Js(e,this.wrap,e,this.canonical.x>>o,this.canonical.y>>o)}calculateScaledKey(e,o=!0){if(this.overscaledZ===e&&o)return this.key;if(e>this.canonical.z)return th(this.wrap*+o,e,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-e;return th(this.wrap*+o,e,e,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(e){if(e.wrap!==this.wrap)return!1;const o=this.canonical.z-e.canonical.z;return 0===e.overscaledZ||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>o&&e.canonical.y===this.canonical.y>>o}children(e){if(this.overscaledZ>=e)return[new Js(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const o=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new Js(o,this.wrap,o,c,f),new Js(o,this.wrap,o,c+1,f),new Js(o,this.wrap,o,c,f+1),new Js(o,this.wrap,o,c+1,f+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new Js(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new Js(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Bg(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function th(r,e,o,c,f){const _=1<<Math.min(o,22);let v=_*(f%_)+c%_;return r&&o<22&&(v+=_*_*((r<0?-2*r-1:2*r)%(1<<2*(22-o)))),16*(32*v+o)+(e-o)}hi(eh,"CanonicalTileID"),hi(Js,"OverscaledTileID",{omit:["projMatrix"]});class du extends ye{constructor(e,o,c){super(e,o),this.z=c}}function id(r,e){return r.x*e.x+r.y*e.y}function nh(r,e){if(1===r.length){let o=0;const c=e[o++];let f;for(;!f||c.equals(f);)if(f=e[o++],!f)return 1/0;for(;o<e.length;o++){const _=e[o],v=r[0],w=f.sub(c),E=_.sub(c),M=v.sub(c),L=id(w,w),N=id(w,E),j=id(E,E),W=id(M,w),J=id(M,E),se=L*j-N*N,Le=(j*W-N*J)/se,rt=(L*J-N*W)/se,bt=c.z*(1-Le-rt)+f.z*Le+_.z*rt;if(isFinite(bt))return bt}return 1/0}{let o=1/0;for(const c of e)o=Math.min(o,c.z);return o}}function mf(r,e,o,c,f,_,v,w){const E=v*f.getElevationAt(r,e,!0,!0),M=0!==_[0],L=M?0===_[1]?v*(_[0]/7-450):v*function(N,j,W){const J=Math.floor(j[0]/8),se=Math.floor(j[1]/8),Le=10*(j[0]-8*J),rt=10*(j[1]-8*se),bt=N.getElevationAt(J,se,!0,!0),at=N.getMeterToDEM(W),xt=Math.floor(.5*(Le*at-1)),At=Math.floor(.5*(rt*at-1)),Mt=N.tileCoordToPixel(J,se),un=2*xt+1,rn=2*At+1,Dn=(gi=un,ci=rn,[(Qn=N).getElevationAtPixel(En=Mt.x-xt,ai=Mt.y-At,!0),Qn.getElevationAtPixel(En+ci,ai,!0),Qn.getElevationAtPixel(En,ai+ci,!0),Qn.getElevationAtPixel(En+gi,ai+ci,!0)]),Yn=Math.abs(Dn[0]-Dn[1]),mn=Math.abs(Dn[2]-Dn[3]),Pn=Math.abs(Dn[0]-Dn[2])+Math.abs(Dn[1]-Dn[3]),Rn=Math.min(.25,.5*at*(Yn+mn)/un),zn=Math.min(.25,.5*at*Pn/rn);var Qn,En,ai,gi,ci;return bt+Math.max(Rn*Le,zn*rt)}(f,_,w):E;return{base:E+(0===o)?-1:o,top:M?Math.max(L+c,E+o+2):E+c}}const rd=$t([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:jy}=rd,Vy=$t([{name:"a_packed",components:4,type:"Float32"}]),{members:Y0}=Vy,$y=Jd.types,gf=Math.cos(Math.PI/180*37.5);class od{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(o=>o.id),this.index=e.index,this.projection=e.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(o=>{this.gradients[o.id]={}}),this.layoutVertexArray=new pn,this.layoutVertexArray2=new qn,this.indexArray=new Ci,this.programConfigurations=new zu(e.layers,e.zoom),this.segments=new So,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(o=>o.isStateDependent()).map(o=>o.id)}populate(e,o,c,f){this.hasPattern=Bp("line",this.layers,o);const _=this.layers[0].layout.get("line-sort-key"),v=[];for(const{feature:L,id:N,index:j,sourceLayerIndex:W}of e){const J=this.layers[0]._featureFilter.needGeometry,se=ou(L,J);if(!this.layers[0]._featureFilter.filter(new R(this.zoom),se,c))continue;const Le=_?_.evaluate(se,{},c):void 0,rt={id:N,properties:L.properties,type:L.type,sourceLayerIndex:W,index:j,geometry:J?se.geometry:ac(L,c,f),patterns:{},sortKey:Le};v.push(rt)}_&&v.sort((L,N)=>L.sortKey-N.sortKey);const{lineAtlas:w,featureIndex:E}=o,M=this.addConstantDashes(w);for(const L of v){const{geometry:N,index:j,sourceLayerIndex:W}=L;if(M&&this.addFeatureDashes(L,w),this.hasPattern){const J=Oc("line",this.layers,L,this.zoom,o);this.patternFeatures.push(J)}else this.addFeature(L,N,j,c,w.positions,o.availableImages);E.insert(e[j].feature,N,j,W,this.index)}}addConstantDashes(e){let o=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,_=c.layout.get("line-cap").value;if("constant"!==f.kind||"constant"!==_.kind)o=!0;else{const v=_.value,w=f.value;if(!w)continue;e.addDash(w,v)}}return o}addFeatureDashes(e,o){const c=this.zoom;for(const f of this.layers){const _=f.paint.get("line-dasharray").value,v=f.layout.get("line-cap").value;if("constant"===_.kind&&"constant"===v.kind)continue;let w,E;if("constant"===_.kind){if(w=_.value,!w)continue}else w=_.evaluate({zoom:c},e);E="constant"===v.kind?v.value:v.evaluate({zoom:c},e),o.addDash(w,E),e.patterns[f.id]=o.getKey(w,E)}}update(e,o,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,o,this.stateDependentLayers,c,f)}addFeatures(e,o,c,f,_){for(const v of this.patternFeatures)this.addFeature(v,v.geometry,v.index,o,c,f)}isEmpty(){return 0===this.layoutVertexArray.length}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(0!==this.layoutVertexArray2.length&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Y0)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,jy),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&e.properties.hasOwnProperty("mapbox_clip_start")&&e.properties.hasOwnProperty("mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,o,c,f,_,v){const w=this.layers[0].layout,E=w.get("line-join").evaluate(e,{}),M=w.get("line-cap").evaluate(e,{}),L=w.get("line-miter-limit"),N=w.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const j of o)this.addLine(j,e,E,M,L,N);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,c,_,v,f)}addLine(e,o,c,f,_,v){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let rt=0;rt<e.length-1;rt++)this.totalDistance+=e[rt].dist(e[rt+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const w="Polygon"===$y[o.type];let E=e.length;for(;E>=2&&e[E-1].equals(e[E-2]);)E--;let M=0;for(;M<E-1&&e[M].equals(e[M+1]);)M++;if(E<(w?3:2))return;"bevel"===c&&(_=1.05);const L=this.overscaling<=16?15*vi/(512*this.overscaling):0,N=this.segments.prepareSegment(10*E,this.layoutVertexArray,this.indexArray);let j,W,J,se,Le;this.e1=this.e2=-1,w&&(j=e[E-2],Le=e[M].sub(j)._unit()._perp());for(let rt=M;rt<E;rt++){if(J=rt===E-1?w?e[M+1]:void 0:e[rt+1],J&&e[rt].equals(J))continue;Le&&(se=Le),j&&(W=j),j=e[rt],Le=J?J.sub(j)._unit()._perp():se,se=se||Le;let bt=se.add(Le);0===bt.x&&0===bt.y||bt._unit();const at=se.x*Le.x+se.y*Le.y,xt=bt.x*Le.x+bt.y*Le.y,At=0!==xt?1/xt:1/0,Mt=2*Math.sqrt(2-2*xt),un=xt<gf&&W&&J,rn=se.x*Le.y-se.y*Le.x>0;if(un&&rt>M){const mn=j.dist(W);if(mn>2*L){const Pn=j.sub(j.sub(W)._mult(L/mn)._round());this.updateDistance(W,Pn),this.addCurrentVertex(Pn,se,0,0,N),W=Pn}}const Dn=W&&J;let Yn=Dn?c:w?"butt":f;if(Dn&&"round"===Yn&&(At<v?Yn="miter":At<=2&&(Yn="fakeround")),"miter"===Yn&&At>_&&(Yn="bevel"),"bevel"===Yn&&(At>2&&(Yn="flipbevel"),At<_&&(Yn="miter")),W&&this.updateDistance(W,j),"miter"===Yn)bt._mult(At),this.addCurrentVertex(j,bt,0,0,N);else if("flipbevel"===Yn){if(At>100)bt=Le.mult(-1);else{const mn=At*se.add(Le).mag()/se.sub(Le).mag();bt._perp()._mult(mn*(rn?-1:1))}this.addCurrentVertex(j,bt,0,0,N),this.addCurrentVertex(j,bt.mult(-1),0,0,N)}else if("bevel"===Yn||"fakeround"===Yn){const mn=-Math.sqrt(At*At-1),Pn=rn?mn:0,Rn=rn?0:mn;if(W&&this.addCurrentVertex(j,se,Pn,Rn,N),"fakeround"===Yn){const zn=Math.round(180*Mt/Math.PI/20);for(let Qn=1;Qn<zn;Qn++){let En=Qn/zn;if(.5!==En){const gi=En-.5;En+=En*gi*(En-1)*((1.0904+at*(at*(3.55645-1.43519*at)-3.2452))*gi*gi+(.848013+at*(.215638*at-1.06021)))}const ai=Le.sub(se)._mult(En)._add(se)._unit()._mult(rn?-1:1);this.addHalfVertex(j,ai.x,ai.y,!1,rn,0,N)}}J&&this.addCurrentVertex(j,Le,-Pn,-Rn,N)}else if("butt"===Yn)this.addCurrentVertex(j,bt,0,0,N);else if("square"===Yn){const mn=W?1:-1;W||this.addCurrentVertex(j,bt,mn,mn,N),this.addCurrentVertex(j,bt,0,0,N),W&&this.addCurrentVertex(j,bt,mn,mn,N)}else"round"===Yn&&(W&&(this.addCurrentVertex(j,se,0,0,N),this.addCurrentVertex(j,se,1,1,N,!0)),J&&(this.addCurrentVertex(j,Le,-1,-1,N,!0),this.addCurrentVertex(j,Le,0,0,N)));if(un&&rt<E-1){const mn=j.dist(J);if(mn>2*L){const Pn=j.add(J.sub(j)._mult(L/mn)._round());this.updateDistance(j,Pn),this.addCurrentVertex(Pn,Le,0,0,N),j=Pn}}}}addCurrentVertex(e,o,c,f,_,v=!1){const w=o.y*f-o.x,E=-o.y-o.x*f;this.addHalfVertex(e,o.x+o.y*c,o.y-o.x*c,v,!1,c,_),this.addHalfVertex(e,w,E,v,!0,-f,_)}addHalfVertex({x:e,y:o},c,f,_,v,w,E){this.layoutVertexArray.emplaceBack((e<<1)+(_?1:0),(o<<1)+(v?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(0===w?0:w<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const M=E.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,M),E.primitiveLength++),v?this.e2=M:this.e1=M}updateScaledDistance(){if(this.lineClips){const e=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=e*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(e,o){this.distance+=e.dist(o),this.updateScaledDistance()}}hi(od,"LineBucket",{omit:["layers","patternFeatures"]});const zg=new gt({"line-cap":new He(vt.layout_line["line-cap"]),"line-join":new He(vt.layout_line["line-join"]),"line-miter-limit":new ne(vt.layout_line["line-miter-limit"]),"line-round-limit":new ne(vt.layout_line["line-round-limit"]),"line-sort-key":new He(vt.layout_line["line-sort-key"])});var Hp={paint:new gt({"line-opacity":new He(vt.paint_line["line-opacity"]),"line-color":new He(vt.paint_line["line-color"]),"line-translate":new ne(vt.paint_line["line-translate"]),"line-translate-anchor":new ne(vt.paint_line["line-translate-anchor"]),"line-width":new He(vt.paint_line["line-width"]),"line-gap-width":new He(vt.paint_line["line-gap-width"]),"line-offset":new He(vt.paint_line["line-offset"]),"line-blur":new He(vt.paint_line["line-blur"]),"line-dasharray":new He(vt.paint_line["line-dasharray"]),"line-pattern":new He(vt.paint_line["line-pattern"]),"line-gradient":new ht(vt.paint_line["line-gradient"]),"line-trim-offset":new ne(vt.paint_line["line-trim-offset"])}),layout:zg};const Wp=new class extends He{possiblyEvaluate(r,e){return e=new R(Math.floor(e.zoom),{now:e.now,fadeDuration:e.fadeDuration,transition:e.transition}),super.possiblyEvaluate(r,e)}evaluate(r,e,o,c){return e=We({},e,{zoom:Math.floor(e.zoom)}),super.evaluate(r,e,o,c)}}(Hp.paint.properties["line-width"].specification);function qp(r,e){return e>0?e+2*r:r}Wp.useIntegerZoom=!0;const Zy=$t([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Gy=$t([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),Hy=$t([{name:"a_projected_pos",components:4,type:"Float32"}],4);$t([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Wy=$t([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),qy=$t([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const uc=$t([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),ih=$t([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);$t([{name:"triangle",components:3,type:"Uint16"}]),$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),$t([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),$t([{type:"Float32",name:"offsetX"}]),$t([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var cs=24;const kl=128;function Ug(r,e){const{expression:o}=e;if("constant"===o.kind)return{kind:"constant",layoutSize:o.evaluate(new R(r+1))};if("source"===o.kind)return{kind:"source"};{const{zoomStops:c,interpolationType:f}=o;let _=0;for(;_<c.length&&c[_]<=r;)_++;_=Math.max(0,_-1);let v=_;for(;v<c.length&&c[v]<r+1;)v++;v=Math.min(c.length-1,v);const w=c[_],E=c[v];return"composite"===o.kind?{kind:"composite",minZoom:w,maxZoom:E,interpolationType:f}:{kind:"camera",minZoom:w,maxZoom:E,minSize:o.evaluate(new R(w)),maxSize:o.evaluate(new R(E)),interpolationType:f}}}function Yp(r,{uSize:e,uSizeT:o},{lowerSize:c,upperSize:f}){return"source"===r.kind?c/kl:"composite"===r.kind?Pi(c/kl,f/kl,o):e}function rh(r,e){let o=0,c=0;if("constant"===r.kind)c=r.layoutSize;else if("source"!==r.kind){const{interpolationType:f,minZoom:_,maxZoom:v}=r,w=f?Ke(No.interpolationFactor(f,e,_,v),0,1):0;"camera"===r.kind?c=Pi(r.minSize,r.maxSize,w):o=w}return{uSizeT:o,uSize:c}}var J0=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:kl,evaluateSizeForFeature:Yp,evaluateSizeForZoom:rh,getSizeData:Ug});function jg(r,e,o){return r.sections.forEach(c=>{c.text=function(f,_,v){const w=_.layout.get("text-transform").evaluate(v,{});return"uppercase"===w?f=f.toLocaleUpperCase():"lowercase"===w&&(f=f.toLocaleLowerCase()),I.applyArabicShaping&&(f=I.applyArabicShaping(f)),f}(c.text,e,o)}),r}const oh={"!":"\ufe15","#":"\uff03",$:"\uff04","%":"\uff05","&":"\uff06","(":"\ufe35",")":"\ufe36","*":"\uff0a","+":"\uff0b",",":"\ufe10","-":"\ufe32",".":"\u30fb","/":"\uff0f",":":"\ufe13",";":"\ufe14","<":"\ufe3f","=":"\uff1d",">":"\ufe40","?":"\ufe16","@":"\uff20","[":"\ufe47","\\":"\uff3c","]":"\ufe48","^":"\uff3e",_:"\ufe33","`":"\uff40","{":"\ufe37","|":"\u2015","}":"\ufe38","~":"\uff5e","\xa2":"\uffe0","\xa3":"\uffe1","\xa5":"\uffe5","\xa6":"\uffe4","\xac":"\uffe2","\xaf":"\uffe3","\u2013":"\ufe32","\u2014":"\ufe31","\u2018":"\ufe43","\u2019":"\ufe44","\u201c":"\ufe41","\u201d":"\ufe42","\u2026":"\ufe19","\u2027":"\u30fb","\u20a9":"\uffe6","\u3001":"\ufe11","\u3002":"\ufe12","\u3008":"\ufe3f","\u3009":"\ufe40","\u300a":"\ufe3d","\u300b":"\ufe3e","\u300c":"\ufe41","\u300d":"\ufe42","\u300e":"\ufe43","\u300f":"\ufe44","\u3010":"\ufe3b","\u3011":"\ufe3c","\u3014":"\ufe39","\u3015":"\ufe3a","\u3016":"\ufe17","\u3017":"\ufe18","\uff01":"\ufe15","\uff08":"\ufe35","\uff09":"\ufe36","\uff0c":"\ufe10","\uff0d":"\ufe32","\uff0e":"\u30fb","\uff1a":"\ufe13","\uff1b":"\ufe14","\uff1c":"\ufe3f","\uff1e":"\ufe40","\uff1f":"\ufe16","\uff3b":"\ufe47","\uff3d":"\ufe48","\uff3f":"\ufe33","\uff5b":"\ufe37","\uff5c":"\u2015","\uff5d":"\ufe38","\uff5f":"\ufe35","\uff60":"\ufe36","\uff61":"\ufe12","\uff62":"\ufe41","\uff63":"\ufe42","\u2190":"\u2191","\u2192":"\u2193"};function Yy(r){return"\ufe36"===r||"\ufe48"===r||"\ufe38"===r||"\ufe44"===r||"\ufe42"===r||"\ufe3e"===r||"\ufe3c"===r||"\ufe3a"===r||"\ufe18"===r||"\ufe40"===r||"\ufe10"===r||"\ufe13"===r||"\ufe14"===r||"\uff40"===r||"\uffe3"===r||"\ufe11"===r||"\ufe12"===r}function Jy(r){return"\ufe35"===r||"\ufe47"===r||"\ufe37"===r||"\ufe43"===r||"\ufe41"===r||"\ufe3d"===r||"\ufe3b"===r||"\ufe39"===r||"\ufe17"===r||"\ufe3f"===r}var Vg=Or,_f=function(r,e,o,c,f){var _,v,w=8*f-c-1,E=(1<<w)-1,M=E>>1,L=-7,N=o?f-1:0,j=o?-1:1,W=r[e+N];for(N+=j,_=W&(1<<-L)-1,W>>=-L,L+=w;L>0;_=256*_+r[e+N],N+=j,L-=8);for(v=_&(1<<-L)-1,_>>=-L,L+=c;L>0;v=256*v+r[e+N],N+=j,L-=8);if(0===_)_=1-M;else{if(_===E)return v?NaN:1/0*(W?-1:1);v+=Math.pow(2,c),_-=M}return(W?-1:1)*v*Math.pow(2,_-c)},Fl=function(r,e,o,c,f,_){var v,w,E,M=8*_-f-1,L=(1<<M)-1,N=L>>1,j=23===f?Math.pow(2,-24)-Math.pow(2,-77):0,W=c?0:_-1,J=c?1:-1,se=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(w=isNaN(e)?1:0,v=L):(v=Math.floor(Math.log(e)/Math.LN2),e*(E=Math.pow(2,-v))<1&&(v--,E*=2),(e+=v+N>=1?j/E:j*Math.pow(2,1-N))*E>=2&&(v++,E/=2),v+N>=L?(w=0,v=L):v+N>=1?(w=(e*E-1)*Math.pow(2,f),v+=N):(w=e*Math.pow(2,N-1)*Math.pow(2,f),v=0));f>=8;r[o+W]=255&w,W+=J,w/=256,f-=8);for(v=v<<f|w,M+=f;M>0;r[o+W]=255&v,W+=J,v/=256,M-=8);r[o+W-J]|=128*se};function Or(r){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(r)?r:new Uint8Array(r||0),this.pos=0,this.type=0,this.length=this.buf.length}Or.Varint=0,Or.Fixed64=1,Or.Bytes=2,Or.Fixed32=5;var yf=4294967296,Jp=1/yf,Kp=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Rc(r){return r.type===Or.Bytes?r.readVarint()+r.pos:r.pos+1}function Ky(r,e,o){var c=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));o.realloc(c);for(var f=o.pos-1;f>=r;f--)o.buf[f+c]=o.buf[f]}function Xp(r,e){for(var o=0;o<r.length;o++)e.writeVarint(r[o])}function Qp(r,e){for(var o=0;o<r.length;o++)e.writeSVarint(r[o])}function K0(r,e){for(var o=0;o<r.length;o++)e.writeFloat(r[o])}function X0(r,e){for(var o=0;o<r.length;o++)e.writeDouble(r[o])}function $g(r,e){for(var o=0;o<r.length;o++)e.writeBoolean(r[o])}function Xy(r,e){for(var o=0;o<r.length;o++)e.writeFixed32(r[o])}function Qy(r,e){for(var o=0;o<r.length;o++)e.writeSFixed32(r[o])}function ev(r,e){for(var o=0;o<r.length;o++)e.writeFixed64(r[o])}function tv(r,e){for(var o=0;o<r.length;o++)e.writeSFixed64(r[o])}function ah(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+16777216*r[e+3]}function dc(r,e,o){r[o]=e,r[o+1]=e>>>8,r[o+2]=e>>>16,r[o+3]=e>>>24}function Zg(r,e){return(r[e]|r[e+1]<<8|r[e+2]<<16)+(r[e+3]<<24)}Or.prototype={destroy:function(){this.buf=null},readFields:function(r,e,o){for(o=o||this.length;this.pos<o;){var c=this.readVarint(),f=c>>3,_=this.pos;this.type=7&c,r(f,e,this),this.pos===_&&this.skip(c)}return e},readMessage:function(r,e){return this.readFields(r,e,this.readVarint()+this.pos)},readFixed32:function(){var r=ah(this.buf,this.pos);return this.pos+=4,r},readSFixed32:function(){var r=Zg(this.buf,this.pos);return this.pos+=4,r},readFixed64:function(){var r=ah(this.buf,this.pos)+ah(this.buf,this.pos+4)*yf;return this.pos+=8,r},readSFixed64:function(){var r=ah(this.buf,this.pos)+Zg(this.buf,this.pos+4)*yf;return this.pos+=8,r},readFloat:function(){var r=_f(this.buf,this.pos,!0,23,4);return this.pos+=4,r},readDouble:function(){var r=_f(this.buf,this.pos,!0,52,8);return this.pos+=8,r},readVarint:function(r){var e,o,c=this.buf;return e=127&(o=c[this.pos++]),o<128?e:(e|=(127&(o=c[this.pos++]))<<7,o<128?e:(e|=(127&(o=c[this.pos++]))<<14,o<128?e:(e|=(127&(o=c[this.pos++]))<<21,o<128?e:function(f,_,v){var w,E,M=v.buf;if(w=(112&(E=M[v.pos++]))>>4,E<128||(w|=(127&(E=M[v.pos++]))<<3,E<128)||(w|=(127&(E=M[v.pos++]))<<10,E<128)||(w|=(127&(E=M[v.pos++]))<<17,E<128)||(w|=(127&(E=M[v.pos++]))<<24,E<128)||(w|=(1&(E=M[v.pos++]))<<31,E<128))return function sh(r,e,o){return o?4294967296*e+(r>>>0):4294967296*(e>>>0)+(r>>>0)}(f,w,_);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(o=c[this.pos]))<<28,r,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var r=this.readVarint();return r%2==1?(r+1)/-2:r/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var r=this.readVarint()+this.pos,e=this.pos;return this.pos=r,r-e>=12&&Kp?Kp.decode(this.buf.subarray(e,r)):function(o,c,f){for(var _="",v=c;v<f;){var w,E,M,L=o[v],N=null,j=L>239?4:L>223?3:L>191?2:1;if(v+j>f)break;1===j?L<128&&(N=L):2===j?128==(192&(w=o[v+1]))&&(N=(31&L)<<6|63&w)<=127&&(N=null):3===j?(E=o[v+2],128==(192&(w=o[v+1]))&&128==(192&E)&&((N=(15&L)<<12|(63&w)<<6|63&E)<=2047||N>=55296&&N<=57343)&&(N=null)):4===j&&(E=o[v+2],M=o[v+3],128==(192&(w=o[v+1]))&&128==(192&E)&&128==(192&M)&&((N=(15&L)<<18|(63&w)<<12|(63&E)<<6|63&M)<=65535||N>=1114112)&&(N=null)),null===N?(N=65533,j=1):N>65535&&(N-=65536,_+=String.fromCharCode(N>>>10&1023|55296),N=56320|1023&N),_+=String.fromCharCode(N),v+=j}return _}(this.buf,e,r)},readBytes:function(){var r=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,r);return this.pos=r,e},readPackedVarint:function(r,e){if(this.type!==Or.Bytes)return r.push(this.readVarint(e));var o=Rc(this);for(r=r||[];this.pos<o;)r.push(this.readVarint(e));return r},readPackedSVarint:function(r){if(this.type!==Or.Bytes)return r.push(this.readSVarint());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readSVarint());return r},readPackedBoolean:function(r){if(this.type!==Or.Bytes)return r.push(this.readBoolean());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readBoolean());return r},readPackedFloat:function(r){if(this.type!==Or.Bytes)return r.push(this.readFloat());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readFloat());return r},readPackedDouble:function(r){if(this.type!==Or.Bytes)return r.push(this.readDouble());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readDouble());return r},readPackedFixed32:function(r){if(this.type!==Or.Bytes)return r.push(this.readFixed32());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readFixed32());return r},readPackedSFixed32:function(r){if(this.type!==Or.Bytes)return r.push(this.readSFixed32());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed32());return r},readPackedFixed64:function(r){if(this.type!==Or.Bytes)return r.push(this.readFixed64());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readFixed64());return r},readPackedSFixed64:function(r){if(this.type!==Or.Bytes)return r.push(this.readSFixed64());var e=Rc(this);for(r=r||[];this.pos<e;)r.push(this.readSFixed64());return r},skip:function(r){var e=7&r;if(e===Or.Varint)for(;this.buf[this.pos++]>127;);else if(e===Or.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Or.Fixed32)this.pos+=4;else{if(e!==Or.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(r,e){this.writeVarint(r<<3|e)},realloc:function(r){for(var e=this.length||16;e<this.pos+r;)e*=2;if(e!==this.length){var o=new Uint8Array(e);o.set(this.buf),this.buf=o,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(r){this.realloc(4),dc(this.buf,r,this.pos),this.pos+=4},writeSFixed32:function(r){this.realloc(4),dc(this.buf,r,this.pos),this.pos+=4},writeFixed64:function(r){this.realloc(8),dc(this.buf,-1&r,this.pos),dc(this.buf,Math.floor(r*Jp),this.pos+4),this.pos+=8},writeSFixed64:function(r){this.realloc(8),dc(this.buf,-1&r,this.pos),dc(this.buf,Math.floor(r*Jp),this.pos+4),this.pos+=8},writeVarint:function(r){(r=+r||0)>268435455||r<0?function(e,o){var c,f,_,w;if(e>=0?(c=e%4294967296|0,f=e/4294967296|0):(f=~(-e/4294967296),4294967295^(c=~(-e%4294967296))?c=c+1|0:(c=0,f=f+1|0)),e>=0x10000000000000000||e<-0x10000000000000000)throw new Error("Given varint doesn't fit into 10 bytes");o.realloc(10),_=c,(w=o).buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,_>>>=7,w.buf[w.pos++]=127&_|128,w.buf[w.pos]=127&(_>>>=7),function(_,v){var w=(7&_)<<4;v.buf[v.pos++]|=w|((_>>>=3)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_|((_>>>=7)?128:0),_&&(v.buf[v.pos++]=127&_)))))}(f,o)}(r,this):(this.realloc(4),this.buf[this.pos++]=127&r|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=127&(r>>>=7)|(r>127?128:0),r<=127||(this.buf[this.pos++]=r>>>7&127))))},writeSVarint:function(r){this.writeVarint(r<0?2*-r-1:2*r)},writeBoolean:function(r){this.writeVarint(!!r)},writeString:function(r){r=String(r),this.realloc(4*r.length),this.pos++;var e=this.pos;this.pos=function(c,f,_){for(var v,w,E=0;E<f.length;E++){if((v=f.charCodeAt(E))>55295&&v<57344){if(!w){v>56319||E+1===f.length?(c[_++]=239,c[_++]=191,c[_++]=189):w=v;continue}if(v<56320){c[_++]=239,c[_++]=191,c[_++]=189,w=v;continue}v=w-55296<<10|v-56320|65536,w=null}else w&&(c[_++]=239,c[_++]=191,c[_++]=189,w=null);v<128?c[_++]=v:(v<2048?c[_++]=v>>6|192:(v<65536?c[_++]=v>>12|224:(c[_++]=v>>18|240,c[_++]=v>>12&63|128),c[_++]=v>>6&63|128),c[_++]=63&v|128)}return _}(this.buf,r,this.pos);var o=this.pos-e;o>=128&&Ky(e,o,this),this.pos=e-1,this.writeVarint(o),this.pos+=o},writeFloat:function(r){this.realloc(4),Fl(this.buf,r,this.pos,!0,23,4),this.pos+=4},writeDouble:function(r){this.realloc(8),Fl(this.buf,r,this.pos,!0,52,8),this.pos+=8},writeBytes:function(r){var e=r.length;this.writeVarint(e),this.realloc(e);for(var o=0;o<e;o++)this.buf[this.pos++]=r[o]},writeRawMessage:function(r,e){this.pos++;var o=this.pos;r(e,this);var c=this.pos-o;c>=128&&Ky(o,c,this),this.pos=o-1,this.writeVarint(c),this.pos+=c},writeMessage:function(r,e,o){this.writeTag(r,Or.Bytes),this.writeRawMessage(e,o)},writePackedVarint:function(r,e){e.length&&this.writeMessage(r,Xp,e)},writePackedSVarint:function(r,e){e.length&&this.writeMessage(r,Qp,e)},writePackedBoolean:function(r,e){e.length&&this.writeMessage(r,$g,e)},writePackedFloat:function(r,e){e.length&&this.writeMessage(r,K0,e)},writePackedDouble:function(r,e){e.length&&this.writeMessage(r,X0,e)},writePackedFixed32:function(r,e){e.length&&this.writeMessage(r,Xy,e)},writePackedSFixed32:function(r,e){e.length&&this.writeMessage(r,Qy,e)},writePackedFixed64:function(r,e){e.length&&this.writeMessage(r,ev,e)},writePackedSFixed64:function(r,e){e.length&&this.writeMessage(r,tv,e)},writeBytesField:function(r,e){this.writeTag(r,Or.Bytes),this.writeBytes(e)},writeFixed32Field:function(r,e){this.writeTag(r,Or.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(r,e){this.writeTag(r,Or.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(r,e){this.writeTag(r,Or.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(r,e){this.writeTag(r,Or.Fixed64),this.writeSFixed64(e)},writeVarintField:function(r,e){this.writeTag(r,Or.Varint),this.writeVarint(e)},writeSVarintField:function(r,e){this.writeTag(r,Or.Varint),this.writeSVarint(e)},writeStringField:function(r,e){this.writeTag(r,Or.Bytes),this.writeString(e)},writeFloatField:function(r,e){this.writeTag(r,Or.Fixed32),this.writeFloat(e)},writeDoubleField:function(r,e){this.writeTag(r,Or.Fixed64),this.writeDouble(e)},writeBooleanField:function(r,e){this.writeVarintField(r,!!e)}};var sd=nt(Vg);const em=3;function ad(r,e,o){e.glyphs=[],1===r&&o.readMessage(nv,e)}function nv(r,e,o){if(3===r){const{id:c,bitmap:f,width:_,height:v,left:w,top:E,advance:M}=o.readMessage(iv,{});e.glyphs.push({id:c,bitmap:new Qa({width:_+2*em,height:v+2*em},f),metrics:{width:_,height:v,left:w,top:E,advance:M}})}else 4===r?e.ascender=o.readSVarint():5===r&&(e.descender=o.readSVarint())}function iv(r,e,o){1===r?e.id=o.readVarint():2===r?e.bitmap=o.readBytes():3===r?e.width=o.readVarint():4===r?e.height=o.readVarint():5===r?e.left=o.readSVarint():6===r?e.top=o.readSVarint():7===r&&(e.advance=o.readVarint())}const vf=em;function xf(r){let e=0,o=0;for(const v of r)e+=v.w*v.h,o=Math.max(o,v.w);r.sort((v,w)=>w.h-v.h);const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),o),h:1/0}];let f=0,_=0;for(const v of r)for(let w=c.length-1;w>=0;w--){const E=c[w];if(!(v.w>E.w||v.h>E.h)){if(v.x=E.x,v.y=E.y,_=Math.max(_,v.y+v.h),f=Math.max(f,v.x+v.w),v.w===E.w&&v.h===E.h){const M=c.pop();w<c.length&&(c[w]=M)}else v.h===E.h?(E.x+=v.w,E.w-=v.w):v.w===E.w?(E.y+=v.h,E.h-=v.h):(c.push({x:E.x+v.w,y:E.y,w:E.w-v.w,h:v.h}),E.y+=v.h,E.h-=v.h);break}}return{w:f,h:_,fill:e/(f*_)||0}}const aa=1;class tm{constructor(e,{pixelRatio:o,version:c,stretchX:f,stretchY:_,content:v}){this.paddedRect=e,this.pixelRatio=o,this.stretchX=f,this.stretchY=_,this.content=v,this.version=c}get tl(){return[this.paddedRect.x+aa,this.paddedRect.y+aa]}get br(){return[this.paddedRect.x+this.paddedRect.w-aa,this.paddedRect.y+this.paddedRect.h-aa]}get displaySize(){return[(this.paddedRect.w-2*aa)/this.pixelRatio,(this.paddedRect.h-2*aa)/this.pixelRatio]}}class Gg{constructor(e,o){const c={},f={};this.haveRenderCallbacks=[];const _=[];this.addImages(e,c,_),this.addImages(o,f,_);const{w:v,h:w}=xf(_),E=new Ls({width:v||1,height:w||1});for(const M in e){const L=e[M],N=c[M].paddedRect;Ls.copy(L.data,E,{x:0,y:0},{x:N.x+aa,y:N.y+aa},L.data)}for(const M in o){const L=o[M],N=f[M].paddedRect,j=N.x+aa,W=N.y+aa,J=L.data.width,se=L.data.height;Ls.copy(L.data,E,{x:0,y:0},{x:j,y:W},L.data),Ls.copy(L.data,E,{x:0,y:se-1},{x:j,y:W-1},{width:J,height:1}),Ls.copy(L.data,E,{x:0,y:0},{x:j,y:W+se},{width:J,height:1}),Ls.copy(L.data,E,{x:J-1,y:0},{x:j-1,y:W},{width:1,height:se}),Ls.copy(L.data,E,{x:0,y:0},{x:j+J,y:W},{width:1,height:se})}this.image=E,this.iconPositions=c,this.patternPositions=f}addImages(e,o,c){for(const f in e){const _=e[f],v={x:0,y:0,w:_.data.width+2*aa,h:_.data.height+2*aa};c.push(v),o[f]=new tm(v,_),_.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(e,o){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(c=>e.hasImage(c)),e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in e.updatedImages)this.patchUpdatedImage(this.iconPositions[c],e.getImage(c),o),this.patchUpdatedImage(this.patternPositions[c],e.getImage(c),o)}patchUpdatedImage(e,o,c){if(!e||!o||e.version===o.version)return;e.version=o.version;const[f,_]=e.tl;c.update(o.data,void 0,{x:f,y:_})}}hi(tm,"ImagePosition"),hi(Gg,"ImageAtlas");const La={horizontal:1,vertical:2,horizontalOnly:3},nm=-17;class bf{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,o){const c=new bf;return c.scale=e||1,c.fontStack=o,c}static forImage(e){const o=new bf;return o.imageName=e,o}}class lh{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,o){const c=new lh;for(let f=0;f<e.sections.length;f++){const _=e.sections[f];_.image?c.addImageSection(_):c.addTextSection(_,o)}return c}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSections(){return this.sections}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(e){this.text=function(o,c){let f="";for(let _=0;_<o.length;_++){const v=o.charCodeAt(_+1)||null,w=o.charCodeAt(_-1)||null;f+=!c&&(v&&Kc(v)&&!oh[o[_+1]]||w&&Kc(w)&&!oh[o[_-1]])||!oh[o[_]]?o[_]:oh[o[_]]}return f}(this.text,e)}trim(){let e=0;for(let c=0;c<this.text.length&&ch[this.text.charCodeAt(c)];c++)e++;let o=this.text.length;for(let c=this.text.length-1;c>=0&&c>=e&&ch[this.text.charCodeAt(c)];c--)o--;this.text=this.text.substring(e,o),this.sectionIndex=this.sectionIndex.slice(e,o)}substring(e,o){const c=new lh;return c.text=this.text.substring(e,o),c.sectionIndex=this.sectionIndex.slice(e,o),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,o)=>Math.max(e,this.sections[o].scale),0)}addTextSection(e,o){this.text+=e.text,this.sections.push(bf.forText(e.scale,e.fontStack||o));const c=this.sections.length-1;for(let f=0;f<e.text.length;++f)this.sectionIndex.push(c)}addImageSection(e){const o=e.image?e.image.name:"";if(0===o.length)return void It("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(bf.forImage(o)),this.sectionIndex.push(this.sections.length-1)):It("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function hu(r,e,o,c,f,_,v,w,E,M,L,N,j,W,J){const se=lh.fromFeature(r,f);N===La.vertical&&se.verticalizePunctuation(j);let Le=[];const rt=function(Mt,un,rn,Dn,Yn,mn){if(!Mt)return[];const Pn=[],Rn=function(ai,gi,ci,Ji,ri,Ai){let Zi=0;for(let wr=0;wr<ai.length();wr++){const Ki=ai.getSection(wr);Zi+=rv(ai.getCharCode(wr),Ki,Ji,ri,gi,Ai)}return Zi/Math.max(1,Math.ceil(Zi/ci))}(Mt,un,rn,Dn,Yn,mn),zn=Mt.text.indexOf("\u200b")>=0;let Qn=0;for(let ai=0;ai<Mt.length();ai++){const gi=Mt.getSection(ai),ci=Mt.getCharCode(ai);if(ch[ci]||(Qn+=rv(ci,gi,Dn,Yn,un,mn)),ai<Mt.length()-1){const Ji=!((En=ci)<11904||!(oi["Bopomofo Extended"](En)||oi.Bopomofo(En)||oi["CJK Compatibility Forms"](En)||oi["CJK Compatibility Ideographs"](En)||oi["CJK Compatibility"](En)||oi["CJK Radicals Supplement"](En)||oi["CJK Strokes"](En)||oi["CJK Symbols and Punctuation"](En)||oi["CJK Unified Ideographs Extension A"](En)||oi["CJK Unified Ideographs"](En)||oi["Enclosed CJK Letters and Months"](En)||oi["Halfwidth and Fullwidth Forms"](En)||oi.Hiragana(En)||oi["Ideographic Description Characters"](En)||oi["Kangxi Radicals"](En)||oi["Katakana Phonetic Extensions"](En)||oi.Katakana(En)||oi["Vertical Forms"](En)||oi["Yi Radicals"](En)||oi["Yi Syllables"](En)));(Q0[ci]||Ji||gi.imageName)&&Pn.push(wf(ai+1,Qn,Rn,Pn,ov(ci,Mt.getCharCode(ai+1),Ji&&zn),!1))}}var En;return Cf(wf(Mt.length(),Qn,Rn,Pn,0,!0))}(se,M,_,e,c,W),{processBidirectionalText:bt,processStyledBidirectionalText:at}=I;if(bt&&1===se.sections.length){const Mt=bt(se.toString(),rt);for(const un of Mt){const rn=new lh;rn.text=un,rn.sections=se.sections;for(let Dn=0;Dn<un.length;Dn++)rn.sectionIndex.push(0);Le.push(rn)}}else if(at){const Mt=at(se.text,se.sectionIndex,rt);for(const un of Mt){const rn=new lh;rn.text=un[0],rn.sectionIndex=un[1],rn.sections=se.sections,Le.push(rn)}}else Le=function(Mt,un){const rn=[],Dn=Mt.text;let Yn=0;for(const mn of un)rn.push(Mt.substring(Yn,mn)),Yn=mn;return Yn<Dn.length&&rn.push(Mt.substring(Yn,Dn.length)),rn}(se,rt);const xt=[],At={positionedLines:xt,text:se.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:N,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return function(Mt,un,rn,Dn,Yn,mn,Pn,Rn,zn,Qn,En,ai){let gi=0,ci=0,Ji=0;const ri="right"===Rn?1:"left"===Rn?0:.5;let Ai=!1;for(const er of Yn){const tr=er.getSections();for(const Hr of tr){if(Hr.imageName)continue;const Xr=un[Hr.fontStack];if(Xr&&(Ai=void 0!==Xr.ascender&&void 0!==Xr.descender,!Ai))break}if(!Ai)break}let Zi=0;for(const er of Yn){er.trim();const tr=er.getMaxScale(),Hr=(tr-1)*cs,Xr={positionedGlyphs:[],lineOffset:0};Mt.positionedLines[Zi]=Xr;const Wr=Xr.positionedGlyphs;let Cr=0;if(!er.length()){ci+=mn,++Zi;continue}let po=0,mo=0;for(let Ur=0;Ur<er.length();Ur++){const ko=er.getSection(Ur),Fo=er.getSectionIndex(Ur),ar=er.getCharCode(Ur);let Tr=ko.scale,wo=null,Qr=null,Ks=null,Co=cs,Wo=0;const Vo=!(zn===La.horizontal||!En&&!Jc(ar)||En&&(ch[ar]||(wr=ar,oi.Arabic(wr)||oi["Arabic Supplement"](wr)||oi["Arabic Extended-A"](wr)||oi["Arabic Presentation Forms-A"](wr)||oi["Arabic Presentation Forms-B"](wr))));if(ko.imageName){const ks=Dn[ko.imageName];if(!ks)continue;Ks=ko.imageName,Mt.iconsInText=Mt.iconsInText||!0,Qr=ks.paddedRect;const qo=ks.displaySize;Tr=Tr*cs/ai,wo={width:qo[0],height:qo[1],left:aa,top:-vf,advance:Vo?qo[1]:qo[0],localGlyph:!1},Wo=Ai?-wo.height*Tr:nm+tr*cs-qo[1]*Tr,Co=wo.advance;const xl=(Vo?qo[0]:qo[1])*Tr-cs*tr;xl>0&&xl>Cr&&(Cr=xl)}else{const ks=rn[ko.fontStack];if(!ks)continue;ks[ar]&&(Qr=ks[ar]);const qo=un[ko.fontStack];if(!qo)continue;const xl=qo.glyphs[ar];if(!xl)continue;if(wo=xl.metrics,Co=8203!==ar?cs:0,Ai){const nl=void 0!==qo.ascender?Math.abs(qo.ascender):0,xd=void 0!==qo.descender?Math.abs(qo.descender):0,bd=(nl+xd)*Tr;po<bd&&(po=bd,mo=(nl-xd)/2*Tr),Wo=-nl*Tr}else Wo=nm+(tr-Tr)*cs}Vo?(Mt.verticalizable=!0,Wr.push({glyph:ar,imageName:Ks,x:gi,y:ci+Wo,vertical:Vo,scale:Tr,localGlyph:wo.localGlyph,fontStack:ko.fontStack,sectionIndex:Fo,metrics:wo,rect:Qr}),gi+=Co*Tr+Qn):(Wr.push({glyph:ar,imageName:Ks,x:gi,y:ci+Wo,vertical:Vo,scale:Tr,localGlyph:wo.localGlyph,fontStack:ko.fontStack,sectionIndex:Fo,metrics:wo,rect:Qr}),gi+=wo.advance*Tr+Qn)}0!==Wr.length&&(Ji=Math.max(gi-Qn,Ji),Ai?Ef(Wr,ri,Cr,mo,mn*tr/2):Ef(Wr,ri,Cr,0,mn/2)),gi=0;const qr=mn*tr+Cr;Xr.lineOffset=Math.max(Cr,Hr),ci+=qr,++Zi}var wr;const Ki=ci,{horizontalAlign:Ni,verticalAlign:io}=Lc(Pn);(function(er,tr,Hr,Xr,Wr,Cr){const po=(tr-Hr)*Wr,mo=-Cr*Xr;for(const qr of er)for(const Ur of qr.positionedGlyphs)Ur.x+=po,Ur.y+=mo})(Mt.positionedLines,ri,Ni,io,Ji,Ki),Mt.top+=-io*Ki,Mt.bottom=Mt.top+Ki,Mt.left+=-Ni*Ji,Mt.right=Mt.left+Ji,Mt.hasBaseline=Ai}(At,e,o,c,Le,v,w,E,N,M,j,J),!function(Mt){for(const un of Mt)if(0!==un.positionedGlyphs.length)return!1;return!0}(xt)&&At}const ch={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Q0={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function rv(r,e,o,c,f,_){if(e.imageName){const v=c[e.imageName];return v?v.displaySize[0]*e.scale*cs/_+f:0}{const v=o[e.fontStack],w=v&&v.glyphs[r];return w?w.metrics.advance*e.scale+f:0}}function uh(r,e,o,c){const f=Math.pow(r-e,2);return c?r<e?f/2:2*f:f+Math.abs(o)*o}function ov(r,e,o){let c=0;return 10===r&&(c-=1e4),o&&(c+=150),40!==r&&65288!==r||(c+=50),41!==e&&65289!==e||(c+=50),c}function wf(r,e,o,c,f,_){let v=null,w=uh(e,o,f,_);for(const E of c){const M=uh(e-E.x,o,f,_)+E.badness;M<=w&&(v=E,w=M)}return{index:r,x:e,priorBreak:v,badness:w}}function Cf(r){return r?Cf(r.priorBreak).concat(r.index):[]}function Lc(r){let e=.5,o=.5;switch(r){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(r){case"bottom":case"bottom-right":case"bottom-left":o=1;break;case"top":case"top-right":case"top-left":o=0}return{horizontalAlign:e,verticalAlign:o}}function Ef(r,e,o,c,f){if(!(e||o||c||f))return;const _=r.length-1,v=r[_],w=(v.x+v.metrics.advance*v.scale)*e;for(let E=0;E<=_;E++)r[E].x-=w,r[E].y+=o+c+f}function im(r,e,o){const{horizontalAlign:c,verticalAlign:f}=Lc(o),_=e[0]-r.displaySize[0]*c,v=e[1]-r.displaySize[1]*f;return{image:r,top:v,bottom:v+r.displaySize[1],left:_,right:_+r.displaySize[0]}}function ld(r,e,o,c,f,_){const v=r.image;let w;if(v.content){const Le=v.content,rt=v.pixelRatio||1;w=[Le[0]/rt,Le[1]/rt,v.displaySize[0]-Le[2]/rt,v.displaySize[1]-Le[3]/rt]}const E=e.left*_,M=e.right*_;let L,N,j,W;"width"===o||"both"===o?(W=f[0]+E-c[3],N=f[0]+M+c[1]):(W=f[0]+(E+M-v.displaySize[0])/2,N=W+v.displaySize[0]);const J=e.top*_,se=e.bottom*_;return"height"===o||"both"===o?(L=f[1]+J-c[0],j=f[1]+se+c[2]):(L=f[1]+(J+se-v.displaySize[1])/2,j=L+v.displaySize[1]),{image:v,top:L,right:N,bottom:j,left:W,collisionPadding:w}}class el extends ye{constructor(e,o,c,f,_){super(e,o),this.angle=f,this.z=c,void 0!==_&&(this.segment=_)}clone(){return new el(this.x,this.y,this.z,this.angle,this.segment)}}function fu(r,e,o,c,f){if(void 0===e.segment)return!0;let _=e,v=e.segment+1,w=0;for(;w>-o/2;){if(v--,v<0)return!1;w-=r[v].dist(_),_=r[v]}w+=r[v].dist(r[v+1]),v++;const E=[];let M=0;for(;w<o/2;){const L=r[v],N=r[v+1];if(!N)return!1;let j=r[v-1].angleTo(L)-L.angleTo(N);for(j=Math.abs((j+3*Math.PI)%(2*Math.PI)-Math.PI),E.push({distance:w,angleDelta:j}),M+=j;w-E[0].distance>c;)M-=E.shift().angleDelta;if(M>f)return!1;v++,w+=L.dist(N)}return!0}function Tf(r){let e=0;for(let o=0;o<r.length-1;o++)e+=r[o].dist(r[o+1]);return e}function Df(r,e,o){return r?.6*e*o:0}function dh(r,e){return Math.max(r?r.right-r.left:0,e?e.right-e.left:0)}function ex(r,e,o,c,f,_){const v=Df(o,f,_),w=dh(o,c)*_;let E=0;const M=Tf(r)/2;for(let L=0;L<r.length-1;L++){const N=r[L],j=r[L+1],W=N.dist(j);if(E+W>M){const J=(M-E)/W,se=Pi(N.x,j.x,J),Le=Pi(N.y,j.y,J),rt=new el(se,Le,0,j.angleTo(N),L);return!v||fu(r,rt,w,v,e)?rt:void 0}E+=W}}function rm(r,e,o,c,f,_,v,w,E){const M=Df(c,_,v),L=dh(c,f),N=L*v,j=0===r[0].x||r[0].x===E||0===r[0].y||r[0].y===E;return e-N<e/4&&(e=N+e/4),cd(r,j?e/2*w%e:(L/2+2*_)*v*w%e,e,M,o,N,j,!1,E)}function cd(r,e,o,c,f,_,v,w,E){const M=_/2,L=Tf(r);let N=0,j=e-o,W=[];for(let J=0;J<r.length-1;J++){const se=r[J],Le=r[J+1],rt=se.dist(Le),bt=Le.angleTo(se);for(;j+o<N+rt;){j+=o;const at=(j-N)/rt,xt=Pi(se.x,Le.x,at),At=Pi(se.y,Le.y,at);if(xt>=0&&xt<E&&At>=0&&At<E&&j-M>=0&&j+M<=L){const Mt=new el(xt,At,0,bt,J);Mt._round(),c&&!fu(r,Mt,_,c,f)||W.push(Mt)}}N+=rt}return w||W.length||v||(W=cd(r,N/2,o,c,f,_,v,!0,E)),W}function Hg(r,e,o,c,f){const _=[];for(let v=0;v<r.length;v++){const w=r[v];let E;for(let M=0;M<w.length-1;M++){let L=w[M],N=w[M+1];L.x<e&&N.x<e||(L.x<e?L=new ye(e,L.y+(e-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x<e&&(N=new ye(e,L.y+(e-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y<o&&N.y<o||(L.y<o?L=new ye(L.x+(o-L.y)/(N.y-L.y)*(N.x-L.x),o)._round():N.y<o&&(N=new ye(L.x+(o-L.y)/(N.y-L.y)*(N.x-L.x),o)._round()),L.x>=c&&N.x>=c||(L.x>=c?L=new ye(c,L.y+(c-L.x)/(N.x-L.x)*(N.y-L.y))._round():N.x>=c&&(N=new ye(c,L.y+(c-L.x)/(N.x-L.x)*(N.y-L.y))._round()),L.y>=f&&N.y>=f||(L.y>=f?L=new ye(L.x+(f-L.y)/(N.y-L.y)*(N.x-L.x),f)._round():N.y>=f&&(N=new ye(L.x+(f-L.y)/(N.y-L.y)*(N.x-L.x),f)._round()),E&&L.equals(E[E.length-1])||(E=[L],_.push(E)),E.push(N)))))}}return _}hi(el,"Anchor");const ud=1e20;function Wg(r,e,o,c,f,_,v,w,E){for(let M=e;M<e+c;M++)qg(r,o*_+M,_,f,v,w,E);for(let M=o;M<o+f;M++)qg(r,M*_+e,1,c,v,w,E)}function qg(r,e,o,c,f,_,v){_[0]=0,v[0]=-ud,v[1]=ud,f[0]=r[e];for(let w=1,E=0,M=0;w<c;w++){f[w]=r[e+w*o];const L=w*w;do{const N=_[E];M=(f[w]-f[N]+L-N*N)/(w-N)/2}while(M<=v[E]&&--E>-1);E++,_[E]=w,v[E]=M,v[E+1]=ud}for(let w=0,E=0;w<c;w++){for(;v[E+1]<w;)E++;const M=_[E],L=w-M;r[e+w*o]=f[M]+L*L}}const ka=2,If={none:0,ideographs:1,all:2};class dd{constructor(e,o,c){this.requestManager=e,this.localGlyphMode=o,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(e){this.url=e}getGlyphs(e,o){const c=[];for(const f in e)for(const _ of e[f])c.push({stack:f,id:_});_n(c,({stack:f,id:_},v)=>{let w=this.entries[f];w||(w=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let E=w.glyphs[_];if(void 0!==E)return void v(null,{stack:f,id:_,glyph:E});if(E=this._tinySDF(w,f,_),E)return w.glyphs[_]=E,void v(null,{stack:f,id:_,glyph:E});const M=Math.floor(_/256);if(256*M>65535)return void v(new Error("glyphs > 65535 not supported"));if(w.ranges[M])return void v(null,{stack:f,id:_,glyph:E});let L=w.requests[M];L||(L=w.requests[M]=[],dd.loadGlyphRange(f,M,this.url,this.requestManager,(N,j)=>{if(j){w.ascender=j.ascender,w.descender=j.descender;for(const W in j.glyphs)this._doesCharSupportLocalGlyph(+W)||(w.glyphs[+W]=j.glyphs[+W]);w.ranges[M]=!0}for(const W of L)W(N,j);delete w.requests[M]})),L.push((N,j)=>{N?v(N):j&&v(null,{stack:f,id:_,glyph:j.glyphs[_]||null})})},(f,_)=>{if(f)o(f);else if(_){const v={};for(const{stack:w,id:E,glyph:M}of _)void 0===v[w]&&(v[w]={}),void 0===v[w].glyphs&&(v[w].glyphs={}),v[w].glyphs[E]=M&&{id:M.id,bitmap:M.bitmap.clone(),metrics:M.metrics},v[w].ascender=this.entries[w].ascender,v[w].descender=this.entries[w].descender;o(null,v)}})}_doesCharSupportLocalGlyph(e){return this.localGlyphMode!==If.none&&(this.localGlyphMode===If.all?!!this.localFontFamily:!!this.localFontFamily&&(oi["CJK Unified Ideographs"](e)||oi["Hangul Syllables"](e)||oi.Hiragana(e)||oi.Katakana(e)||oi["CJK Symbols and Punctuation"](e)))}_tinySDF(e,o,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let _=e.tinySDF;if(!_){let se="400";/bold/i.test(o)?se="900":/medium/i.test(o)?se="500":/light/i.test(o)&&(se="200"),_=e.tinySDF=new dd.TinySDF({fontFamily:f,fontWeight:se,fontSize:24*ka,buffer:3*ka,radius:8*ka}),_.fontWeight=se}if(this.localGlyphs[_.fontWeight][c])return this.localGlyphs[_.fontWeight][c];const v=String.fromCharCode(c),{data:w,width:E,height:M,glyphWidth:L,glyphHeight:N,glyphLeft:j,glyphTop:W,glyphAdvance:J}=_.draw(v);return this.localGlyphs[_.fontWeight][c]={id:c,bitmap:new Qa({width:E,height:M},w),metrics:{width:L/ka,height:N/ka,left:j/ka,top:W/ka-27,advance:J/ka,localGlyph:!0}}}}dd.loadGlyphRange=function(r,e,o,c,f){const _=256*e,v=_+255,w=c.transformRequest(c.normalizeGlyphsURL(o).replace("{fontstack}",r).replace("{range}",`${_}-${v}`),fn.Glyphs);Jt(w,(E,M)=>{if(E)f(E);else if(M){const L={},N=new sd(M).readFields(ad,{});for(const j of N.glyphs)L[j.id]=j;f(null,{glyphs:L,ascender:N.ascender,descender:N.descender})}})},dd.TinySDF=class{constructor({fontSize:r=24,buffer:e=3,radius:o=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:_="normal",fontStyle:v="normal"}={}){this.buffer=e,this.cutoff=c,this.radius=o;const w=this.size=r+4*e,E=this._createCanvas(w),M=this.ctx=E.getContext("2d",{willReadFrequently:!0});M.font=`${v} ${_} ${r}px ${f}`,M.textBaseline="alphabetic",M.textAlign="left",M.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(r){const e=document.createElement("canvas");return e.width=e.height=r,e}draw(r){const{width:e,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:_}=this.ctx.measureText(r),v=Math.ceil(o),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(_-f))),E=Math.min(this.size-this.buffer,v+Math.ceil(c)),M=w+2*this.buffer,L=E+2*this.buffer,N=Math.max(M*L,0),j=new Uint8ClampedArray(N),W={data:j,width:M,height:L,glyphWidth:w,glyphHeight:E,glyphTop:v,glyphLeft:0,glyphAdvance:e};if(0===w||0===E)return W;const{ctx:J,buffer:se,gridInner:Le,gridOuter:rt}=this;J.clearRect(se,se,w,E),J.fillText(r,se,se+v);const bt=J.getImageData(se,se,w,E);rt.fill(ud,0,N),Le.fill(0,0,N);for(let at=0;at<E;at++)for(let xt=0;xt<w;xt++){const At=bt.data[4*(at*w+xt)+3]/255;if(0===At)continue;const Mt=(at+se)*M+xt+se;if(1===At)rt[Mt]=0,Le[Mt]=ud;else{const un=.5-At;rt[Mt]=un>0?un*un:0,Le[Mt]=un<0?un*un:0}}Wg(rt,0,0,M,L,M,this.f,this.v,this.z),Wg(Le,se,se,w,E,M,this.f,this.v,this.z);for(let at=0;at<N;at++){const xt=Math.sqrt(rt[at])-Math.sqrt(Le[at]);j[at]=Math.round(255-255*(xt/this.radius+this.cutoff))}return W}};const hd=aa;function sv(r,e,o,c){const f=[],_=r.image,v=_.pixelRatio,w=_.paddedRect.w-2*hd,E=_.paddedRect.h-2*hd,M=r.right-r.left,L=r.bottom-r.top,N=_.stretchX||[[0,w]],j=_.stretchY||[[0,E]],W=(mn,Pn)=>mn+Pn[1]-Pn[0],J=N.reduce(W,0),se=j.reduce(W,0),Le=w-J,rt=E-se;let bt=0,at=J,xt=0,At=se,Mt=0,un=Le,rn=0,Dn=rt;if(_.content&&c){const mn=_.content;bt=Mf(N,0,mn[0]),xt=Mf(j,0,mn[1]),at=Mf(N,mn[0],mn[2]),At=Mf(j,mn[1],mn[3]),Mt=mn[0]-bt,rn=mn[1]-xt,un=mn[2]-mn[0]-at,Dn=mn[3]-mn[1]-At}const Yn=(mn,Pn,Rn,zn)=>{const Qn=fd(mn.stretch-bt,at,M,r.left),En=Af(mn.fixed-Mt,un,mn.stretch,J),ai=fd(Pn.stretch-xt,At,L,r.top),gi=Af(Pn.fixed-rn,Dn,Pn.stretch,se),ci=fd(Rn.stretch-bt,at,M,r.left),Ji=Af(Rn.fixed-Mt,un,Rn.stretch,J),ri=fd(zn.stretch-xt,At,L,r.top),Ai=Af(zn.fixed-rn,Dn,zn.stretch,se),Zi=new ye(Qn,ai),wr=new ye(ci,ai),Ki=new ye(ci,ri),Ni=new ye(Qn,ri),io=new ye(En/v,gi/v),er=new ye(Ji/v,Ai/v),tr=e*Math.PI/180;if(tr){const Wr=Math.sin(tr),Cr=Math.cos(tr),po=[Cr,-Wr,Wr,Cr];Zi._matMult(po),wr._matMult(po),Ni._matMult(po),Ki._matMult(po)}const Hr=mn.stretch+mn.fixed,Xr=Pn.stretch+Pn.fixed;return{tl:Zi,tr:wr,bl:Ni,br:Ki,tex:{x:_.paddedRect.x+hd+Hr,y:_.paddedRect.y+hd+Xr,w:Rn.stretch+Rn.fixed-Hr,h:zn.stretch+zn.fixed-Xr},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:io,pixelOffsetBR:er,minFontScaleX:un/v/M,minFontScaleY:Dn/v/L,isSDF:o}};if(c&&(_.stretchX||_.stretchY)){const mn=hh(N,Le,J),Pn=hh(j,rt,se);for(let Rn=0;Rn<mn.length-1;Rn++){const zn=mn[Rn],Qn=mn[Rn+1];for(let En=0;En<Pn.length-1;En++)f.push(Yn(zn,Pn[En],Qn,Pn[En+1]))}}else f.push(Yn({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:w+1},{fixed:0,stretch:E+1}));return f}function Mf(r,e,o){let c=0;for(const f of r)c+=Math.max(e,Math.min(o,f[1]))-Math.max(e,Math.min(o,f[0]));return c}function hh(r,e,o){const c=[{fixed:-hd,stretch:0}];for(const[f,_]of r){const v=c[c.length-1];c.push({fixed:f-v.stretch,stretch:v.stretch}),c.push({fixed:f-v.stretch,stretch:v.stretch+(_-f)})}return c.push({fixed:e+hd,stretch:o}),c}function fd(r,e,o,c){return r/e*o+c}function Af(r,e,o,c){return r-e*o/c}function Yg(r,e,o,c){const f=e+r.positionedLines[c].lineOffset;return 0===c?o+f/2:o+(f+(e+r.positionedLines[c-1].lineOffset))/2}class om{constructor(e=[],o=Sf){if(this.data=e,this.length=this.data.length,this.compare=o,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(0===this.length)return;const e=this.data[0],o=this.data.pop();return this.length--,this.length>0&&(this.data[0]=o,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:o,compare:c}=this,f=o[e];for(;e>0;){const _=e-1>>1,v=o[_];if(c(f,v)>=0)break;o[e]=v,e=_}o[e]=f}_down(e){const{data:o,compare:c}=this,f=this.length>>1,_=o[e];for(;e<f;){let v=1+(e<<1),w=o[v];const E=v+1;if(E<this.length&&c(o[E],w)<0&&(v=E,w=o[E]),c(w,_)>=0)break;o[e]=w,e=v}o[e]=_}}function Sf(r,e){return r<e?-1:r>e?1:0}function av(r,e=1,o=!1){let c=1/0,f=1/0,_=-1/0,v=-1/0;const w=r[0];for(let W=0;W<w.length;W++){const J=w[W];(!W||J.x<c)&&(c=J.x),(!W||J.y<f)&&(f=J.y),(!W||J.x>_)&&(_=J.x),(!W||J.y>v)&&(v=J.y)}const E=Math.min(_-c,v-f);let M=E/2;const L=new om([],Jg);if(0===E)return new ye(c,f);for(let W=c;W<_;W+=E)for(let J=f;J<v;J+=E)L.push(new pd(W+M,J+M,M,r));let N=function(W){let J=0,se=0,Le=0;const rt=W[0];for(let bt=0,at=rt.length,xt=at-1;bt<at;xt=bt++){const At=rt[bt],Mt=rt[xt],un=At.x*Mt.y-Mt.x*At.y;se+=(At.x+Mt.x)*un,Le+=(At.y+Mt.y)*un,J+=3*un}return new pd(se/J,Le/J,0,W)}(r),j=L.length;for(;L.length;){const W=L.pop();(W.d>N.d||!N.d)&&(N=W,o&&console.log("found best %d after %d probes",Math.round(1e4*W.d)/1e4,j)),W.max-N.d<=e||(M=W.h/2,L.push(new pd(W.p.x-M,W.p.y-M,M,r)),L.push(new pd(W.p.x+M,W.p.y-M,M,r)),L.push(new pd(W.p.x-M,W.p.y+M,M,r)),L.push(new pd(W.p.x+M,W.p.y+M,M,r)),j+=4)}return o&&(console.log(`num probes: ${j}`),console.log(`best distance: ${N.d}`)),N.p}function Jg(r,e){return e.max-r.max}class pd{constructor(e,o,c,f){this.p=new ye(e,o),this.h=c,this.d=function(_,v){let w=!1,E=1/0;for(let M=0;M<v.length;M++){const L=v[M];for(let N=0,j=L.length,W=j-1;N<j;W=N++){const J=L[N],se=L[W];J.y>_.y!=se.y>_.y&&_.x<(se.x-J.x)*(_.y-J.y)/(se.y-J.y)+J.x&&(w=!w),E=Math.min(E,wy(_,J,se))}}return(w?1:-1)*Math.sqrt(E)}(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const pu=7,Kg=Number.POSITIVE_INFINITY,lv=Math.sqrt(2);function fh(r,[e,o]){let c=0,f=0;if(o===Kg){e<0&&(e=0);const _=e/lv;switch(r){case"top-right":case"top-left":f=_-pu;break;case"bottom-right":case"bottom-left":f=-_+pu;break;case"bottom":f=-e+pu;break;case"top":f=e-pu}switch(r){case"top-right":case"bottom-right":c=-_;break;case"top-left":case"bottom-left":c=_;break;case"left":c=e;break;case"right":c=-e}}else{switch(e=Math.abs(e),o=Math.abs(o),r){case"top-right":case"top-left":case"top":f=o-pu;break;case"bottom-right":case"bottom-left":case"bottom":f=-o+pu}switch(r){case"top-right":case"bottom-right":case"right":c=-e;break;case"top-left":case"bottom-left":case"left":c=e}}return[c,f]}function cv(r,e,o,c,f,_,v,w,E,M){r.createArrays(),r.tilePixelRatio=vi/(512*r.overscaling),r.compareText={},r.iconsNeedLinear=!1;const L=r.layers[0].layout,N=r.layers[0]._unevaluatedLayout._values,j={};if("composite"===r.textSizeData.kind){const{minZoom:se,maxZoom:Le}=r.textSizeData;j.compositeTextSizes=[N["text-size"].possiblyEvaluate(new R(se),w),N["text-size"].possiblyEvaluate(new R(Le),w)]}if("composite"===r.iconSizeData.kind){const{minZoom:se,maxZoom:Le}=r.iconSizeData;j.compositeIconSizes=[N["icon-size"].possiblyEvaluate(new R(se),w),N["icon-size"].possiblyEvaluate(new R(Le),w)]}j.layoutTextSize=N["text-size"].possiblyEvaluate(new R(E+1),w),j.layoutIconSize=N["icon-size"].possiblyEvaluate(new R(E+1),w),j.textMaxSize=N["text-size"].possiblyEvaluate(new R(18),w);const W="map"===L.get("text-rotation-alignment")&&"point"!==L.get("symbol-placement"),J=L.get("text-size");for(const se of r.features){const Le=L.get("text-font").evaluate(se,{},w).join(","),rt=J.evaluate(se,{},w),bt=j.layoutTextSize.evaluate(se,{},w),at=(j.layoutIconSize.evaluate(se,{},w),{horizontal:{},vertical:void 0}),xt=se.text;let At,Mt=[0,0];if(xt){const Dn=xt.toString(),Yn=L.get("text-letter-spacing").evaluate(se,{},w)*cs,mn=L.get("text-line-height").evaluate(se,{},w)*cs,Pn=Yc(Dn)?Yn:0,Rn=L.get("text-anchor").evaluate(se,{},w),zn=L.get("text-variable-anchor");if(!zn){const ci=L.get("text-radial-offset").evaluate(se,{},w);Mt=ci?fh(Rn,[ci*cs,Kg]):L.get("text-offset").evaluate(se,{},w).map(Ji=>Ji*cs)}let Qn=W?"center":L.get("text-justify").evaluate(se,{},w);const En="point"===L.get("symbol-placement"),ai=En?L.get("text-max-width").evaluate(se,{},w)*cs:1/0,gi=ci=>{r.allowVerticalPlacement&&nc(Dn)&&(at.vertical=hu(xt,e,o,f,Le,ai,mn,Rn,ci,Pn,Mt,La.vertical,!0,bt,rt))};if(!W&&zn){const ci="auto"===Qn?zn.map(ri=>kc(ri)):[Qn];let Ji=!1;for(let ri=0;ri<ci.length;ri++){const Ai=ci[ri];if(!at.horizontal[Ai])if(Ji)at.horizontal[Ai]=at.horizontal[0];else{const Zi=hu(xt,e,o,f,Le,ai,mn,"center",Ai,Pn,Mt,La.horizontal,!1,bt,rt);Zi&&(at.horizontal[Ai]=Zi,Ji=1===Zi.positionedLines.length)}}gi("left")}else{if("auto"===Qn&&(Qn=kc(Rn)),En||L.get("text-writing-mode").indexOf("horizontal")>=0||!nc(Dn)){const ci=hu(xt,e,o,f,Le,ai,mn,Rn,Qn,Pn,Mt,La.horizontal,!1,bt,rt);ci&&(at.horizontal[Qn]=ci)}gi(En?"left":Qn)}}let un=!1;if(se.icon&&se.icon.name){const Dn=c[se.icon.name];Dn&&(At=im(f[se.icon.name],L.get("icon-offset").evaluate(se,{},w),L.get("icon-anchor").evaluate(se,{},w)),un=Dn.sdf,void 0===r.sdfIcons?r.sdfIcons=Dn.sdf:r.sdfIcons!==Dn.sdf&&It("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(Dn.pixelRatio!==r.pixelRatio||0!==L.get("icon-rotate").constantOr(1))&&(r.iconsNeedLinear=!0))}const rn=Qg(at.horizontal)||at.vertical;r.iconsInText||(r.iconsInText=!!rn&&rn.iconsInText),(rn||At)&&ph(r,se,at,At,c,j,bt,0,Mt,un,v,w,M)}_&&r.generateCollisionDebugBuffers(E,r.collisionBoxArray)}function kc(r){switch(r){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function ph(r,e,o,c,f,_,v,w,E,M,L,N,j){let W=_.textMaxSize.evaluate(e,{},N);void 0===W&&(W=v);const J=r.layers[0].layout,se=J.get("icon-offset").evaluate(e,{},N),Le=Qg(o.horizontal)||o.vertical,rt="globe"===j.name,bt=cs,at=v/bt,xt=r.tilePixelRatio*W/bt,At=(Rn=r.overscaling,r.zoom>18&&Rn>2&&(Rn>>=1),Math.max(vi/(512*Rn),1)*J.get("symbol-spacing")),Mt=J.get("text-padding")*r.tilePixelRatio,un=J.get("icon-padding")*r.tilePixelRatio,rn=X(J.get("text-max-angle")),Dn="map"===J.get("text-rotation-alignment")&&"point"!==J.get("symbol-placement"),Yn="map"===J.get("icon-rotation-alignment")&&"point"!==J.get("symbol-placement"),mn=J.get("symbol-placement"),Pn=At/2;var Rn;const zn=J.get("icon-text-fit");let Qn;c&&"none"!==zn&&(r.allowVerticalPlacement&&o.vertical&&(Qn=ld(c,o.vertical,zn,J.get("icon-text-fit-padding"),se,at)),Le&&(c=ld(c,Le,zn,J.get("icon-text-fit-padding"),se,at)));const En=(ai,gi,ci)=>{if(gi.x<0||gi.x>=vi||gi.y<0||gi.y>=vi)return;let Ji=null;if(rt){const{x:ri,y:Ai,z:Zi}=j.projectTilePoint(gi.x,gi.y,ci);Ji={anchor:new el(ri,Ai,Zi,0,void 0),up:j.upVector(ci,gi.x,gi.y)}}!function(ri,Ai,Zi,wr,Ki,Ni,io,er,tr,Hr,Xr,Wr,Cr,po,mo,qr,Ur,ko,Fo,ar,Tr,wo,Qr,Ks,Co){const Wo=ri.addToLineVertexArray(Ai,wr);let Vo,ks,qo,xl,nl,xd,bd,E_=0,Mm=0,Am=0,Sm=0,Cu=-1,Pm=-1;const jl={};let Nf=wc("");const Eu=Zi?Zi.anchor:Ai;let wd=0,Bf=0;if(void 0===tr._unevaluatedLayout.getValue("text-radial-offset")?[wd,Bf]=tr.layout.get("text-offset").evaluate(Tr,{},Co).map(ms=>ms*cs):(wd=tr.layout.get("text-radial-offset").evaluate(Tr,{},Co)*cs,Bf=Kg),ri.allowVerticalPlacement&&Ki.vertical){const ms=Ki.vertical;if(mo)xd=gh(ms),er&&(bd=gh(er));else{const ba=tr.layout.get("text-rotate").evaluate(Tr,{},Co)+90;qo=Pf(Hr,Eu,Ai,Xr,Wr,Cr,ms,po,ba,qr),er&&(xl=Pf(Hr,Eu,Ai,Xr,Wr,Cr,er,ko,ba))}}if(Ni){const ms=tr.layout.get("icon-rotate").evaluate(Tr,{},Co),ba="none"!==tr.layout.get("icon-text-fit"),Dh=sv(Ni,ms,Qr,ba),Rm=er?sv(er,ms,Qr,ba):void 0;ks=Pf(Hr,Eu,Ai,Xr,Wr,Cr,Ni,ko,ms),E_=4*Dh.length;const T_=ri.iconSizeData;let Tu=null;"source"===T_.kind?(Tu=[kl*tr.layout.get("icon-size").evaluate(Tr,{},Co)],Tu[0]>hc&&It(`${ri.layerIds[0]}: Value for "icon-size" is >= ${mh}. Reduce your "icon-size".`)):"composite"===T_.kind&&(Tu=[kl*wo.compositeIconSizes[0].evaluate(Tr,{},Co),kl*wo.compositeIconSizes[1].evaluate(Tr,{},Co)],(Tu[0]>hc||Tu[1]>hc)&&It(`${ri.layerIds[0]}: Value for "icon-size" is >= ${mh}. Reduce your "icon-size".`)),ri.addSymbols(ri.icon,Dh,Tu,ar,Fo,Tr,!1,Zi,Ai,Wo.lineStartIndex,Wo.lineLength,-1,Ks,Co),Cu=ri.icon.placedSymbolArray.length-1,Rm&&(Mm=4*Rm.length,ri.addSymbols(ri.icon,Rm,Tu,ar,Fo,Tr,La.vertical,Zi,Ai,Wo.lineStartIndex,Wo.lineLength,-1,Ks,Co),Pm=ri.icon.placedSymbolArray.length-1)}for(const ms in Ki.horizontal){const ba=Ki.horizontal[ms];Vo||(Nf=wc(ba.text),mo?nl=gh(ba):Vo=Pf(Hr,Eu,Ai,Xr,Wr,Cr,ba,po,tr.layout.get("text-rotate").evaluate(Tr,{},Co),qr));const Dh=1===ba.positionedLines.length;if(Am+=Xg(ri,Zi,Ai,ba,io,tr,mo,Tr,qr,Wo,Ki.vertical?La.horizontal:La.horizontalOnly,Dh?Object.keys(Ki.horizontal):[ms],jl,Cu,wo,Ks,Co),Dh)break}Ki.vertical&&(Sm+=Xg(ri,Zi,Ai,Ki.vertical,io,tr,mo,Tr,qr,Wo,La.vertical,["vertical"],jl,Pm,wo,Ks,Co));let fc=-1;const Om=(ms,ba)=>ms?Math.max(ms,ba):ba;fc=Om(nl,fc),fc=Om(xd,fc),fc=Om(bd,fc);const wv=fc>-1?1:0;ri.glyphOffsetArray.length>=zc.MAX_GLYPHS&&It("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),void 0!==Tr.sortKey&&ri.addToSortKeyRanges(ri.symbolInstances.length,Tr.sortKey),ri.symbolInstances.emplaceBack(Eu.x,Eu.y,Eu.z,Ai.x,Ai.y,jl.right>=0?jl.right:-1,jl.center>=0?jl.center:-1,jl.left>=0?jl.left:-1,jl.vertical>=0?jl.vertical:-1,Cu,Pm,Nf,void 0!==Vo?Vo:ri.collisionBoxArray.length,void 0!==Vo?Vo+1:ri.collisionBoxArray.length,void 0!==qo?qo:ri.collisionBoxArray.length,void 0!==qo?qo+1:ri.collisionBoxArray.length,void 0!==ks?ks:ri.collisionBoxArray.length,void 0!==ks?ks+1:ri.collisionBoxArray.length,xl||ri.collisionBoxArray.length,xl?xl+1:ri.collisionBoxArray.length,Xr,Am,Sm,E_,Mm,wv,0,wd,Bf,fc)}(r,gi,Ji,ai,o,c,f,Qn,r.layers[0],r.collisionBoxArray,e.index,e.sourceLayerIndex,r.index,Mt,Dn,E,0,un,Yn,se,e,_,M,L,N)};if("line"===mn)for(const ai of Hg(e.geometry,0,0,vi,vi)){const gi=rm(ai,At,rn,o.vertical||Le,c,bt,xt,r.overscaling,vi);for(const ci of gi)Le&&uv(r,Le.text,Pn,ci)||En(ai,ci,N)}else if("line-center"===mn){for(const ai of e.geometry)if(ai.length>1){const gi=ex(ai,rn,o.vertical||Le,c,bt,xt);gi&&En(ai,gi,N)}}else if("Polygon"===e.type)for(const ai of qd(e.geometry,0)){const gi=av(ai,16);En(ai[0],new el(gi.x,gi.y,0,0,void 0),N)}else if("LineString"===e.type)for(const ai of e.geometry)En(ai,new el(ai[0].x,ai[0].y,0,0,void 0),N);else if("Point"===e.type)for(const ai of e.geometry)for(const gi of ai)En([gi],new el(gi.x,gi.y,0,0,void 0),N)}const mh=255,hc=mh*kl;function Xg(r,e,o,c,f,_,v,w,E,M,L,N,j,W,J,se,Le){const rt=function(xt,At,Mt,un,rn,Dn,Yn,mn){const Pn=[];if(0===At.positionedLines.length)return Pn;const Rn=un.layout.get("text-rotate").evaluate(Dn,{})*Math.PI/180,zn=function(ci){const Ji=ci[0],ri=ci[1],Ai=Ji*ri;return Ai>0?[Ji,-ri]:Ai<0?[-Ji,ri]:0===Ji?[ri,Ji]:[ri,-Ji]}(Mt);let Qn=Math.abs(At.top-At.bottom);for(const ci of At.positionedLines)Qn-=ci.lineOffset;const En=At.positionedLines.length,ai=Qn/En;let gi=At.top-Mt[1];for(let ci=0;ci<En;++ci){const Ji=At.positionedLines[ci];gi=Yg(At,ai,gi,ci);for(const ri of Ji.positionedGlyphs){if(!ri.rect)continue;const Ai=ri.rect||{};let Zi=vf+1,wr=!0,Ki=1,Ni=0;if(ri.imageName){const Qr=Yn[ri.imageName];if(!Qr)continue;if(Qr.sdf){It("SDF images are not supported in formatted text and will be ignored.");continue}wr=!1,Ki=Qr.pixelRatio,Zi=aa/Ki}const io=(rn||mn)&&ri.vertical,er=ri.metrics.advance*ri.scale/2,tr=ri.metrics,Hr=ri.rect;if(null===Hr)continue;mn&&At.verticalizable&&(Ni=ri.imageName?er-ri.metrics.width*ri.scale/2:0);const Xr=rn?[ri.x+er,ri.y]:[0,0];let Wr=[0,0],Cr=[0,0],po=!1;rn||(io?(Cr=[ri.x+er+zn[0],ri.y+zn[1]-Ni],po=!0):Wr=[ri.x+er+Mt[0],ri.y+Mt[1]-Ni]);const mo=Hr.w*ri.scale/(Ki*(ri.localGlyph?ka:1)),qr=Hr.h*ri.scale/(Ki*(ri.localGlyph?ka:1));let Ur,ko,Fo,ar;if(io){const Qr=ri.y-gi,Ks=new ye(-er,er-Qr),Co=-Math.PI/2,Wo=new ye(...Cr);Ur=new ye(-er+Wr[0],Wr[1]),Ur._rotateAround(Co,Ks)._add(Wo),Ur.x+=-Qr+er,Ur.y-=(tr.left-Zi)*ri.scale;const Vo=ri.imageName?tr.advance*ri.scale:cs*ri.scale,ks=String.fromCharCode(ri.glyph);Yy(ks)?Ur.x+=(1-Zi)*ri.scale:Jy(ks)?Ur.x+=Vo-tr.height*ri.scale+(-Zi-1)*ri.scale:Ur.x+=ri.imageName||tr.width+2*Zi===Hr.w&&tr.height+2*Zi===Hr.h?(Vo-qr)/2:(Vo-(tr.height+2*Zi)*ri.scale)/2,ko=new ye(Ur.x,Ur.y-mo),Fo=new ye(Ur.x+qr,Ur.y),ar=new ye(Ur.x+qr,Ur.y-mo)}else{const Qr=(tr.left-Zi)*ri.scale-er+Wr[0],Ks=(-tr.top-Zi)*ri.scale+Wr[1],Co=Qr+mo,Wo=Ks+qr;Ur=new ye(Qr,Ks),ko=new ye(Co,Ks),Fo=new ye(Qr,Wo),ar=new ye(Co,Wo)}if(Rn){let Qr;Qr=rn?new ye(0,0):po?new ye(zn[0],zn[1]):new ye(Mt[0],Mt[1]),Ur._rotateAround(Rn,Qr),ko._rotateAround(Rn,Qr),Fo._rotateAround(Rn,Qr),ar._rotateAround(Rn,Qr)}const Tr=new ye(0,0),wo=new ye(0,0);Pn.push({tl:Ur,tr:ko,bl:Fo,br:ar,tex:Ai,writingMode:At.writingMode,glyphOffset:Xr,sectionIndex:ri.sectionIndex,isSDF:wr,pixelOffsetTL:Tr,pixelOffsetBR:wo,minFontScaleX:0,minFontScaleY:0})}}return Pn}(0,c,E,_,v,w,f,r.allowVerticalPlacement),bt=r.textSizeData;let at=null;"source"===bt.kind?(at=[kl*_.layout.get("text-size").evaluate(w,{},Le)],at[0]>hc&&It(`${r.layerIds[0]}: Value for "text-size" is >= ${mh}. Reduce your "text-size".`)):"composite"===bt.kind&&(at=[kl*J.compositeTextSizes[0].evaluate(w,{},Le),kl*J.compositeTextSizes[1].evaluate(w,{},Le)],(at[0]>hc||at[1]>hc)&&It(`${r.layerIds[0]}: Value for "text-size" is >= ${mh}. Reduce your "text-size".`)),r.addSymbols(r.text,rt,at,E,v,w,L,e,o,M.lineStartIndex,M.lineLength,W,se,Le);for(const xt of N)j[xt]=r.text.placedSymbolArray.length-1;return 4*rt.length}function Qg(r){for(const e in r)return r[e];return null}function Pf(r,e,o,c,f,_,v,w,E,M){let L=v.top,N=v.bottom,j=v.left,W=v.right;const J=v.collisionPadding;if(J&&(j-=J[0],L-=J[1],W+=J[2],N+=J[3]),E){const se=new ye(j,L),Le=new ye(W,L),rt=new ye(j,N),bt=new ye(W,N),at=X(E);let xt=new ye(0,0);M&&(xt=new ye(M[0],M[1])),se._rotateAround(at,xt),Le._rotateAround(at,xt),rt._rotateAround(at,xt),bt._rotateAround(at,xt),j=Math.min(se.x,Le.x,rt.x,bt.x),W=Math.max(se.x,Le.x,rt.x,bt.x),L=Math.min(se.y,Le.y,rt.y,bt.y),N=Math.max(se.y,Le.y,rt.y,bt.y)}return r.emplaceBack(e.x,e.y,e.z,o.x,o.y,j,L,W,N,w,c,f,_),r.length-1}function gh(r){r.collisionPadding&&(r.top-=r.collisionPadding[1],r.bottom+=r.collisionPadding[3]);const e=r.bottom-r.top;return e>0?Math.max(10,e):null}function uv(r,e,o,c){const f=r.compareText;if(e in f){const _=f[e];for(let v=_.length-1;v>=0;v--)if(c.dist(_[v])<o)return!0}else f[e]=[];return f[e].push(c),!1}function dv(r,e){const o=r.fovAboveCenter,c=r.elevation?r.elevation.getMinElevationBelowMSL()*e:0,f=(r._camera.position[2]*r.worldSize-c)/Math.cos(r._pitch),_=Math.sin(o)*f/Math.sin(Math.max(Math.PI/2-r._pitch-o,.01)),v=Math.sin(r._pitch)*_+f;return Math.min(1.01*v,f*(1/r._horizonShift))}function md(r,e){if(!e.isReprojectedInTileSpace)return{scale:1<<r.z,x:r.x,y:r.y,x2:r.x+1,y2:r.y+1,projection:e};const o=Math.pow(2,-r.z),c=r.x*o,f=(r.x+1)*o,_=r.y*o,v=(r.y+1)*o,w=Rs(c),E=Rs(f),M=ps(_),L=ps(v),N=e.project(w,M),j=e.project(E,M),W=e.project(E,L),J=e.project(w,L);let se=Math.min(N.x,j.x,W.x,J.x),Le=Math.min(N.y,j.y,W.y,J.y),rt=Math.max(N.x,j.x,W.x,J.x),bt=Math.max(N.y,j.y,W.y,J.y);const at=o/16;function xt(Mt,un,rn,Dn,Yn,mn){const Pn=(rn+Yn)/2,Rn=(Dn+mn)/2,zn=e.project(Rs(Pn),ps(Rn)),Qn=Math.max(0,se-zn.x,Le-zn.y,zn.x-rt,zn.y-bt);se=Math.min(se,zn.x),rt=Math.max(rt,zn.x),Le=Math.min(Le,zn.y),bt=Math.max(bt,zn.y),Qn>at&&(xt(Mt,zn,rn,Dn,Pn,Rn),xt(zn,un,Pn,Rn,Yn,mn))}xt(N,j,c,_,f,_),xt(j,W,f,_,f,v),xt(W,J,f,v,c,v),xt(J,N,c,v,c,_),se-=at,Le-=at,rt+=at,bt+=at;const At=1/Math.max(rt-se,bt-Le);return{scale:At,x:se*At,y:Le*At,x2:rt*At,y2:bt*At,projection:e}}const hv=Ol(new Float32Array(16));class Fc{constructor(e){this.spec=e,this.name=e.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(e,o){return{x:0,y:0,z:0}}unproject(e,o){return new pr(0,0)}projectTilePoint(e,o,c){return{x:e,y:o,z:0}}locationPoint(e,o,c=!0){return e._coordinatePoint(e.locationCoordinate(o),c)}pixelsPerMeter(e,o){return Xa(1,e)*o}pixelSpaceConversion(e,o,c){return 1}farthestPixelDistance(e){return dv(e,e.pixelsPerMeter)}pointCoordinate(e,o,c,f){const _=e.horizonLineFromTop(!1),v=new ye(o,Math.max(_,c));return e.rayIntersectionCoordinate(e.pointRayIntersection(v,f))}pointCoordinate3D(e,o,c){const f=new ye(o,c);if(e.elevation)return e.elevation.pointCoordinate(f);{const _=this.pointCoordinate(e,f.x,f.y,0);return[_.x,_.y,_.z]}}isPointAboveHorizon(e,o){if(e.elevation)return!this.pointCoordinate3D(e,o.x,o.y);const c=e.horizonLineFromTop();return o.y<c}createInversionMatrix(e,o){return hv}createTileMatrix(e,o,c){let f,_,v;const w=c.canonical,E=Ol(new Float64Array(16));if(this.isReprojectedInTileSpace){const M=md(w,this);f=1,_=M.x+c.wrap*M.scale,v=M.y,oc(E,E,[f/M.scale,f/M.scale,e.pixelsPerMeter/o])}else f=o/e.zoomScale(w.z),_=(w.x+Math.pow(2,w.z)*c.wrap)*f,v=w.y*f;return Ss(E,E,[_,v,0]),oc(E,E,[f/vi,f/vi,1]),E}upVector(e,o,c){return[0,0,1]}upVectorScale(e,o,c){return{metersToTile:1}}}class tx extends Fc{constructor(e){super(e),this.range=[4,7],this.center=e.center||[-96,37.5];const[o,c]=this.parallels=e.parallels||[29.5,45.5],f=Math.sin(X(o));this.n=(f+Math.sin(X(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(e,o){const{n:c,c:f,r0:_}=this,v=X(e-this.center[0]),w=X(o),E=Math.sqrt(f-2*c*Math.sin(w))/c;return{x:E*Math.sin(v*c),y:E*Math.cos(v*c)-_,z:0}}unproject(e,o){const{n:c,c:f,r0:_}=this,v=_+o;let w=Math.atan2(e,Math.abs(v))*Math.sign(v);v*c<0&&(w-=Math.PI*Math.sign(e)*Math.sign(v));const E=X(this.center[0])*c;w=dn(w,-Math.PI-E,Math.PI-E);const M=Ke(ve(w/c)+this.center[0],-180,180),L=Math.asin(Ke((f-(e*e+v*v)*c*c)/(2*c),-1,1)),N=Ke(ve(L),-Ho,Ho);return new pr(M,N)}}const Nc=1.340264,_h=-.081106,yh=893e-6,mu=.003796,vh=Math.sqrt(3)/2;class fv extends Fc{project(e,o){o=o/180*Math.PI,e=e/180*Math.PI;const c=Math.asin(vh*Math.sin(o)),f=c*c,_=f*f*f;return{x:.5*(e*Math.cos(c)/(vh*(Nc+3*_h*f+_*(7*yh+9*mu*f)))/Math.PI+.5),y:1-.5*(c*(Nc+_h*f+_*(yh+mu*f))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=c*c,_=f*f*f;for(let L,N,j,W=0;W<12&&(N=c*(Nc+_h*f+_*(yh+mu*f))-o,j=Nc+3*_h*f+_*(7*yh+9*mu*f),L=N/j,c=Ke(c-L,-Math.PI/3,Math.PI/3),f=c*c,_=f*f*f,!(Math.abs(L)<1e-12));++W);const v=vh*e*(Nc+3*_h*f+_*(7*yh+9*mu*f))/Math.cos(c),w=Math.asin(Math.sin(c)/vh),E=Ke(180*v/Math.PI,-180,180),M=Ke(180*w/Math.PI,-Ho,Ho);return new pr(E,M)}}class pv extends Fc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){return{x:.5+e/360,y:.5-o/360,z:0}}unproject(e,o){const c=360*(e-.5),f=Ke(360*(.5-o),-Ho,Ho);return new pr(c,f)}}const gd=Math.PI/2;function Of(r){return Math.tan((gd+r)/2)}class e_ extends Fc{constructor(e){super(e),this.center=e.center||[0,30];const[o,c]=this.parallels=e.parallels||[30,30];let f=X(o),_=X(c);this.southernCenter=f+_<0,this.southernCenter&&(f=-f,_=-_);const v=Math.cos(f),w=Of(f);this.n=f===_?Math.sin(f):Math.log(v/Math.cos(_))/Math.log(Of(_)/w),this.f=v*Math.pow(Of(f),this.n)/this.n}project(e,o){o=X(o),this.southernCenter&&(o=-o),e=X(e-this.center[0]);const c=1e-6,{n:f,f:_}=this;_>0?o<-gd+c&&(o=-gd+c):o>gd-c&&(o=gd-c);const v=_/Math.pow(Of(o),f);let w=v*Math.sin(f*e),E=_-v*Math.cos(f*e);return w=.5*(w/Math.PI+.5),E=.5*(E/Math.PI+.5),{x:w,y:this.southernCenter?E:1-E,z:0}}unproject(e,o){e=(2*e-.5)*Math.PI,this.southernCenter&&(o=1-o),o=(2*(1-o)-.5)*Math.PI;const{n:c,f}=this,_=f-o,v=Math.sign(_),w=Math.sign(c)*Math.sqrt(e*e+_*_);let E=Math.atan2(e,Math.abs(_))*v;_*c<0&&(E-=Math.PI*Math.sign(e)*v);const M=Ke(ve(E/c)+this.center[0],-180,180),L=Ke(ve(2*Math.atan(Math.pow(f/w,1/c))-gd),-Ho,Ho);return new pr(M,this.southernCenter?-L:L)}}class sm extends Fc{constructor(e){super(e),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(e,o){return{x:Os(e),y:Pa(o),z:0}}unproject(e,o){const c=Rs(e),f=ps(o);return new pr(c,f)}}const am=X(Ho);class mv extends Fc{project(e,o){const c=(o=X(o))*o,f=c*c;return{x:.5*((e=X(e))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(o*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(e,o){e=(2*e-.5)*Math.PI;let c=o=(2*(1-o)-1)*Math.PI,f=25,_=0,v=c*c;do{v=c*c;const M=v*v;_=(c*(1.007226+v*(.015085+M*(.028874*v-.044475-.005916*M)))-o)/(1.007226+v*(.045255+M*(.259866*v-.311325-.005916*11*M))),c=Ke(c-_,-am,am)}while(Math.abs(_)>1e-6&&--f>0);v=c*c;const w=Ke(ve(e/(.8707+v*(v*(v*v*v*(.003971-.001529*v)-.013791)-.131979))),-180,180),E=ve(c);return new pr(w,E)}}const t_=X(Ho);class n_ extends Fc{project(e,o){o=X(o),e=X(e);const c=Math.cos(o),f=2/Math.PI,_=Math.acos(c*Math.cos(e/2)),v=Math.sin(_)/_,w=.5*(e*f+2*c*Math.sin(e/2)/v)||0,E=.5*(o+Math.sin(o)/v)||0;return{x:.5*(w/Math.PI+.5),y:1-.5*(E/Math.PI+1),z:0}}unproject(e,o){let c=e=(2*e-.5)*Math.PI,f=o=(2*(1-o)-1)*Math.PI,_=25;const v=1e-6;let w=0,E=0;do{const M=Math.cos(f),L=Math.sin(f),N=2*L*M,j=L*L,W=M*M,J=Math.cos(c/2),se=Math.sin(c/2),Le=2*J*se,rt=se*se,bt=1-W*J*J,at=bt?1/bt:0,xt=bt?Math.acos(M*J)*Math.sqrt(1/bt):0,At=.5*(2*xt*M*se+2*c/Math.PI)-e,Mt=.5*(xt*L+f)-o,un=.5*at*(W*rt+xt*M*J*j)+1/Math.PI,rn=at*(Le*N/4-xt*L*se),Dn=.125*at*(N*se-xt*L*W*Le),Yn=.5*at*(j*J+xt*rt*M)+.5,mn=rn*Dn-Yn*un;w=(Mt*rn-At*Yn)/mn,E=(At*Dn-Mt*un)/mn,c=Ke(c-w,-Math.PI,Math.PI),f=Ke(f-E,-t_,t_)}while((Math.abs(w)>v||Math.abs(E)>v)&&--_>0);return new pr(ve(c),ve(f))}}class Rf extends Fc{constructor(e){super(e),this.center=e.center||[0,0],this.parallels=e.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(X(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(e,o){const{scale:c,cosPhi:f}=this;return{x:X(e)*f*c+.5,y:-Math.sin(X(o))/f*c+.5,z:0}}unproject(e,o){const{scale:c,cosPhi:f}=this,_=-(o-.5)/c,v=Ke(ve((e-.5)/c)/f,-180,180),w=Math.asin(Ke(_*f,-1,1)),E=Ke(ve(w),-Ho,Ho);return new pr(v,E)}}class nx extends sm{constructor(e){super(e),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(e,o,c){const f=Bd(e,o,c);return bo(f,f,ru(as(c))),{x:f[0],y:f[1],z:f[2]}}locationPoint(e,o){const c=qu(o.lat,o.lng),f=Ps([],c),_=e.elevation?e.elevation.getAtPointOrZero(e.locationCoordinate(o),e._centerAltitude):e._centerAltitude;Rd(c,c,f,Xa(1,0)*vi*_);const v=Ol(new Float64Array(16));return ju(v,e.pixelMatrix,e.globeMatrix),bo(c,c,v),new ye(c[0],c[1])}pixelsPerMeter(e,o){return Xa(1,0)*o}pixelSpaceConversion(e,o,c){const f=Xa(1,e)*o,_=Pi(Xa(1,45)*o,f,c);return this.pixelsPerMeter(e,o)/_}createTileMatrix(e,o,c){const f=Gh(as(c.canonical));return ju(new Float64Array(16),e.globeMatrix,f)}createInversionMatrix(e,o){const{center:c}=e,f=ru(as(o));return fp(f,f,X(c.lng)),Ec(f,f,X(c.lat)),oc(f,f,[e._pixelsPerMercatorPixel,e._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(e,o,c,f){return gg(e,o,c,!0)||new Oa(0,0)}pointCoordinate3D(e,o,c){const f=this.pointCoordinate(e,o,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(e,o){return!gg(e,o.x,o.y,!1)}farthestPixelDistance(e){const o=function(f,_){const v=f.cameraToCenterDistance,w=f._centerAltitude*_,E=f._camera,M=f._camera.forward(),L=_l([],qs([],M,-v),[0,0,w]),N=f.worldSize/(2*Math.PI),j=[0,0,-N],W=f.width/f.height,J=Math.tan(f.fovAboveCenter),se=qs([],E.up(),J),Le=qs([],E.right(),J*W),rt=Ps([],_l([],_l([],M,se),Le)),bt=[];let at;if(new _p(L,rt).closestPointOnSphere(j,N,bt)){const xt=_l([],bt,j),At=Ys([],xt,L);at=Math.cos(f.fovAboveCenter)*Pd(At)}else{const xt=Ys([],L,j),At=Ys([],j,L);Ps(At,At);const Mt=Pd(xt)-N;at=Math.sqrt(Mt*(Mt+2*N));const un=Math.acos(at/(N+Mt))-Math.acos(xa(M,At));at*=Math.cos(un)}return 1.01*at}(e,this.pixelsPerMeter(e.center.lat,e.worldSize)),c=Ju(e.zoom);if(c>0){const f=dv(e,Xa(1,e.center.lat)*e.worldSize),_=e.worldSize/(2*Math.PI),v=Math.max(e.width,e.height)/e.worldSize*Math.PI;return Pi(o,f+_*(1-Math.cos(v)),Math.pow(c,10))}return o}upVector(e,o,c){return Bd(o,c,e,1)}upVectorScale(e){return{metersToTile:iu(Yu(as(e)))}}}function lm(r){const e=r.parallels,o=!!e&&Math.abs(e[0]+e[1])<.01;switch(r.name){case"mercator":return new sm(r);case"equirectangular":return new pv(r);case"naturalEarth":return new mv(r);case"equalEarth":return new fv(r);case"winkelTripel":return new n_(r);case"albers":return o?new Rf(r):new tx(r);case"lambertConformalConic":return o?new Rf(r):new e_(r);case"globe":return new nx(r)}throw new Error(`Invalid projection name: ${r.name}`)}const cm=Jd.types,gv=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Bc(r,e,o,c,f,_,v,w,E,M,L,N,j){const W=w?Math.min(hc,Math.round(w[0])):0,J=w?Math.min(hc,Math.round(w[1])):0;r.emplaceBack(e,o,Math.round(32*c),Math.round(32*f),_,v,(W<<1)+(E?1:0),J,16*M,16*L,256*N,256*j)}function xh(r,e,o,c,f,_,v){r.emplaceBack(e,o,c,f,_,v)}function bh(r,e,o,c,f){r.emplaceBack(e,o,c,f),r.emplaceBack(e,o,c,f),r.emplaceBack(e,o,c,f),r.emplaceBack(e,o,c,f)}function _v(r){for(const e of r.sections)if(Dd(e.text))return!0;return!1}class um{constructor(e){this.layoutVertexArray=new kn,this.indexArray=new Ci,this.programConfigurations=e,this.segments=new So,this.dynamicLayoutVertexArray=new qn,this.opacityVertexArray=new Ii,this.placedSymbolArray=new go,this.globeExtVertexArray=new ti}isEmpty(){return 0===this.layoutVertexArray.length&&0===this.indexArray.length&&0===this.dynamicLayoutVertexArray.length&&0===this.opacityVertexArray.length}upload(e,o,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zy.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,o),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Hy.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,gv,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=e.createVertexBuffer(this.globeExtVertexArray,Gy.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}hi(um,"SymbolBuffers");class dm{constructor(e,o,c){this.layoutVertexArray=new e,this.layoutAttributes=o,this.indexArray=new c,this.segments=new So,this.collisionVertexArray=new cr,this.collisionVertexArrayExt=new lr}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Wy.members,!0),this.collisionVertexBufferExt=e.createVertexBuffer(this.collisionVertexArrayExt,qy.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}hi(dm,"CollisionBuffers");class zc{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(v=>v.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=Ol([]),this.placementViewportMatrix=Ol([]);const o=this.layers[0]._unevaluatedLayout._values;this.textSizeData=Ug(this.zoom,o["text-size"]),this.iconSizeData=Ug(this.zoom,o["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),_=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey="viewport-y"!==_&&void 0!==f.constantOr(1),this.sortFeaturesByY=("viewport-y"===_||"auto"===_&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map(v=>La[v]),this.stateDependentLayerIds=this.layers.filter(v=>v.isStateDependent()).map(v=>v.id),this.sourceID=e.sourceID,this.projection=e.projection}createArrays(){this.text=new um(new zu(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new um(new zu(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new os,this.lineVertexArray=new xc,this.symbolInstances=new no}calculateGlyphDependencies(e,o,c,f,_){for(let v=0;v<e.length;v++)if(o[e.charCodeAt(v)]=!0,f&&_){const w=oh[e.charAt(v)];w&&(o[w.charCodeAt(0)]=!0)}}populate(e,o,c,f){const _=this.layers[0],v=_.layout,w="globe"===this.projection.name,E=v.get("text-font"),M=v.get("text-field"),L=v.get("icon-image"),N=("constant"!==M.value.kind||M.value.value instanceof Ze&&!M.value.value.isEmpty()||M.value.value.toString().length>0)&&("constant"!==E.value.kind||E.value.value.length>0),j="constant"!==L.value.kind||!!L.value.value||Object.keys(L.parameters).length>0,W=v.get("symbol-sort-key");if(this.features=[],!N&&!j)return;const J=o.iconDependencies,se=o.glyphDependencies,Le=o.availableImages,rt=new R(this.zoom);for(const{feature:bt,id:at,index:xt,sourceLayerIndex:At}of e){const Mt=_._featureFilter.needGeometry,un=ou(bt,Mt);if(!_._featureFilter.filter(rt,un,c))continue;if(Mt||(un.geometry=ac(bt,c,f)),w&&1!==bt.type&&c.z<=5){const mn=un.geometry,Pn=.98078528056,Rn=(zn,Qn)=>xa(Bd(zn.x,zn.y,c,1),Bd(Qn.x,Qn.y,c,1))<Pn;for(let zn=0;zn<mn.length;zn++)mn[zn]=Tp(mn[zn],Rn)}let rn,Dn;if(N){const mn=_.getValueAndResolveTokens("text-field",un,c,Le),Pn=Ze.factory(mn);_v(Pn)&&(this.hasRTLText=!0),(!this.hasRTLText||"unavailable"===x()||this.hasRTLText&&I.isParsed())&&(rn=jg(Pn,_,un))}if(j){const mn=_.getValueAndResolveTokens("icon-image",un,c,Le);Dn=mn instanceof Nt?mn:Nt.fromString(mn)}if(!rn&&!Dn)continue;const Yn=this.sortFeaturesByKey?W.evaluate(un,{},c):void 0;if(this.features.push({id:at,text:rn,icon:Dn,index:xt,sourceLayerIndex:At,geometry:un.geometry,properties:bt.properties,type:cm[bt.type],sortKey:Yn}),Dn&&(J[Dn.name]=!0),rn){const mn=E.evaluate(un,{},c).join(","),Pn="map"===v.get("text-rotation-alignment")&&"point"!==v.get("symbol-placement");this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(La.vertical)>=0;for(const Rn of rn.sections)if(Rn.image)J[Rn.image.name]=!0;else{const zn=nc(rn.toString()),Qn=Rn.fontStack||mn,En=se[Qn]=se[Qn]||{};this.calculateGlyphDependencies(Rn.text,En,Pn,this.allowVerticalPlacement,zn)}}}"line"===v.get("symbol-placement")&&(this.features=function(bt){const at={},xt={},At=[];let Mt=0;function un(mn){At.push(bt[mn]),Mt++}function rn(mn,Pn,Rn){const zn=xt[mn];return delete xt[mn],xt[Pn]=zn,At[zn].geometry[0].pop(),At[zn].geometry[0]=At[zn].geometry[0].concat(Rn[0]),zn}function Dn(mn,Pn,Rn){const zn=at[Pn];return delete at[Pn],at[mn]=zn,At[zn].geometry[0].shift(),At[zn].geometry[0]=Rn[0].concat(At[zn].geometry[0]),zn}function Yn(mn,Pn,Rn){const zn=Rn?Pn[0][Pn[0].length-1]:Pn[0][0];return`${mn}:${zn.x}:${zn.y}`}for(let mn=0;mn<bt.length;mn++){const Pn=bt[mn],Rn=Pn.geometry,zn=Pn.text?Pn.text.toString():null;if(!zn){un(mn);continue}const Qn=Yn(zn,Rn),En=Yn(zn,Rn,!0);if(Qn in xt&&En in at&&xt[Qn]!==at[En]){const ai=Dn(Qn,En,Rn),gi=rn(Qn,En,At[ai].geometry);delete at[Qn],delete xt[En],xt[Yn(zn,At[gi].geometry,!0)]=gi,At[ai].geometry=null}else Qn in xt?rn(Qn,En,Rn):En in at?Dn(Qn,En,Rn):(un(mn),at[Qn]=Mt-1,xt[En]=Mt-1)}return At.filter(mn=>mn.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((bt,at)=>bt.sortKey-at.sortKey)}update(e,o,c,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,o,this.layers,c,f),this.icon.programConfigurations.updatePaintArrays(e,o,this.layers,c,f))}isEmpty(){return 0===this.symbolInstances.length&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=lm(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,o){const c=this.lineVertexArray.length;if(void 0!==e.segment)for(const{x:f,y:_}of o)this.lineVertexArray.emplaceBack(f,_);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(e,o,c,f,_,v,w,E,M,L,N,j,W,J){const se=e.indexArray,Le=e.layoutVertexArray,rt=e.globeExtVertexArray,bt=e.segments.prepareSegment(4*o.length,Le,se,this.canOverlap?v.sortKey:void 0),at=this.glyphOffsetArray.length,xt=bt.vertexLength,At=this.allowVerticalPlacement&&w===La.vertical?Math.PI/2:0,Mt=v.text&&v.text.sections;for(let rn=0;rn<o.length;rn++){const{tl:Dn,tr:Yn,bl:mn,br:Pn,tex:Rn,pixelOffsetTL:zn,pixelOffsetBR:Qn,minFontScaleX:En,minFontScaleY:ai,glyphOffset:gi,isSDF:ci,sectionIndex:Ji}=o[rn],ri=bt.vertexLength,Ai=gi[1];if(Bc(Le,M.x,M.y,Dn.x,Ai+Dn.y,Rn.x,Rn.y,c,ci,zn.x,zn.y,En,ai),Bc(Le,M.x,M.y,Yn.x,Ai+Yn.y,Rn.x+Rn.w,Rn.y,c,ci,Qn.x,zn.y,En,ai),Bc(Le,M.x,M.y,mn.x,Ai+mn.y,Rn.x,Rn.y+Rn.h,c,ci,zn.x,Qn.y,En,ai),Bc(Le,M.x,M.y,Pn.x,Ai+Pn.y,Rn.x+Rn.w,Rn.y+Rn.h,c,ci,Qn.x,Qn.y,En,ai),E){const{x:Zi,y:wr,z:Ki}=E.anchor,[Ni,io,er]=E.up;xh(rt,Zi,wr,Ki,Ni,io,er),xh(rt,Zi,wr,Ki,Ni,io,er),xh(rt,Zi,wr,Ki,Ni,io,er),xh(rt,Zi,wr,Ki,Ni,io,er),bh(e.dynamicLayoutVertexArray,Zi,wr,Ki,At)}else bh(e.dynamicLayoutVertexArray,M.x,M.y,M.z,At);se.emplaceBack(ri,ri+1,ri+2),se.emplaceBack(ri+1,ri+2,ri+3),bt.vertexLength+=4,bt.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(gi[0]),rn!==o.length-1&&Ji===o[rn+1].sectionIndex||e.programConfigurations.populatePaintArrays(Le.length,v,v.index,{},W,J,Mt&&Mt[Ji])}const un=E?E.anchor:M;e.placedSymbolArray.emplaceBack(un.x,un.y,un.z,M.x,M.y,at,this.glyphOffsetArray.length-at,xt,L,N,M.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],w,0,!1,0,j,0)}_commitLayoutVertex(e,o,c,f,_,v,w){e.emplaceBack(o,c,f,_,v,Math.round(w.x),Math.round(w.y))}_addCollisionDebugVertices(e,o,c,f,_,v,w){const E=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),M=E.vertexLength,L=w.tileAnchorX,N=w.tileAnchorY;for(let W=0;W<4;W++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(o,-e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(o,e.padding,-e.padding),c.collisionVertexArrayExt.emplaceBack(o,e.padding,e.padding),c.collisionVertexArrayExt.emplaceBack(o,-e.padding,e.padding),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,N,new ye(e.x1,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,N,new ye(e.x2,e.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,N,new ye(e.x2,e.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,_,v,L,N,new ye(e.x1,e.y2)),E.vertexLength+=4;const j=c.indexArray;j.emplaceBack(M,M+1),j.emplaceBack(M+1,M+2),j.emplaceBack(M+2,M+3),j.emplaceBack(M+3,M),E.primitiveLength+=4}_addTextDebugCollisionBoxes(e,o,c,f,_,v){for(let w=f;w<_;w++){const E=c.get(w),M=this.getSymbolInstanceTextSize(e,v,o,w);this._addCollisionDebugVertices(E,M,this.textCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,v)}}_addIconDebugCollisionBoxes(e,o,c,f,_,v){for(let w=f;w<_;w++){const E=c.get(w),M=this.getSymbolInstanceIconSize(e,o,v.placedIconSymbolIndex);this._addCollisionDebugVertices(E,M,this.iconCollisionBox,E.projectedAnchorX,E.projectedAnchorY,E.projectedAnchorZ,v)}}generateCollisionDebugBuffers(e,o){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new dm(mi,uc.members,is),this.iconCollisionBox=new dm(mi,uc.members,is);const c=rh(this.iconSizeData,e),f=rh(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._addTextDebugCollisionBoxes(f,e,o,v.textBoxStartIndex,v.textBoxEndIndex,v),this._addTextDebugCollisionBoxes(f,e,o,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,e,o,v.iconBoxStartIndex,v.iconBoxEndIndex,v),this._addIconDebugCollisionBoxes(c,e,o,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v)}}getSymbolInstanceTextSize(e,o,c,f){const _=this.text.placedSymbolArray.get(o.rightJustifiedTextSymbolIndex>=0?o.rightJustifiedTextSymbolIndex:o.centerJustifiedTextSymbolIndex>=0?o.centerJustifiedTextSymbolIndex:o.leftJustifiedTextSymbolIndex>=0?o.leftJustifiedTextSymbolIndex:o.verticalPlacedTextSymbolIndex>=0?o.verticalPlacedTextSymbolIndex:f),v=Yp(this.textSizeData,e,_)/cs;return this.tilePixelRatio*v}getSymbolInstanceIconSize(e,o,c){const f=this.icon.placedSymbolArray.get(c),_=Yp(this.iconSizeData,e,f);return this.tilePixelRatio*_}_commitDebugCollisionVertexUpdate(e,o,c){e.emplaceBack(o,-c,-c),e.emplaceBack(o,c,-c),e.emplaceBack(o,c,c),e.emplaceBack(o,-c,c)}_updateTextDebugCollisionBoxes(e,o,c,f,_,v){for(let w=f;w<_;w++){const E=c.get(w),M=this.getSymbolInstanceTextSize(e,v,o,w);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,M,E.padding)}}_updateIconDebugCollisionBoxes(e,o,c,f,_,v){for(let w=f;w<_;w++){const E=c.get(w),M=this.getSymbolInstanceIconSize(e,o,v);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,M,E.padding)}}updateCollisionDebugBuffers(e,o){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=rh(this.iconSizeData,e),f=rh(this.textSizeData,e);for(let _=0;_<this.symbolInstances.length;_++){const v=this.symbolInstances.get(_);this._updateTextDebugCollisionBoxes(f,e,o,v.textBoxStartIndex,v.textBoxEndIndex,v),this._updateTextDebugCollisionBoxes(f,e,o,v.verticalTextBoxStartIndex,v.verticalTextBoxEndIndex,v),this._updateIconDebugCollisionBoxes(c,e,o,v.iconBoxStartIndex,v.iconBoxEndIndex,v.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,e,o,v.verticalIconBoxStartIndex,v.verticalIconBoxEndIndex,v.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(e,o,c,f,_,v,w,E,M){const L={};if(o<c){const{x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt,featureIndex:At}=e.get(o);L.textBox={x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt},L.textFeatureIndex=At}if(f<_){const{x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt,featureIndex:At}=e.get(f);L.verticalTextBox={x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt},L.verticalTextFeatureIndex=At}if(v<w){const{x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt,featureIndex:At}=e.get(v);L.iconBox={x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt},L.iconFeatureIndex=At}if(E<M){const{x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt,featureIndex:At}=e.get(E);L.verticalIconBox={x1:N,y1:j,x2:W,y2:J,padding:se,projectedAnchorX:Le,projectedAnchorY:rt,projectedAnchorZ:bt,tileAnchorX:at,tileAnchorY:xt},L.verticalIconFeatureIndex=At}return L}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let o=0;o<this.symbolInstances.length;o++){const c=this.symbolInstances.get(o);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,o){const c=e.placedSymbolArray.get(o),f=c.vertexStartIndex+4*c.numGlyphs;for(let _=c.vertexStartIndex;_<f;_+=4)e.indexArray.emplaceBack(_,_+1,_+2),e.indexArray.emplaceBack(_+1,_+2,_+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&void 0!==this.symbolInstanceIndexes)return this.symbolInstanceIndexes;const o=Math.sin(e),c=Math.cos(e),f=[],_=[],v=[];for(let w=0;w<this.symbolInstances.length;++w){v.push(w);const E=this.symbolInstances.get(w);f.push(0|Math.round(o*E.tileAnchorX+c*E.tileAnchorY)),_.push(E.featureIndex)}return v.sort((w,E)=>f[w]-f[E]||_[E]-_[w]),v}addToSortKeyRanges(e,o){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===o?c.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:o,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const o of this.symbolInstanceIndexes){const c=this.symbolInstances.get(o);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:_,leftJustifiedTextSymbolIndex:v,verticalPlacedTextSymbolIndex:w,placedIconSymbolIndex:E,verticalPlacedIconSymbolIndex:M}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),_>=0&&_!==f&&this.addIndicesForPlacedSymbol(this.text,_),v>=0&&v!==_&&v!==f&&this.addIndicesForPlacedSymbol(this.text,v),w>=0&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&this.addIndicesForPlacedSymbol(this.icon,E),M>=0&&this.addIndicesForPlacedSymbol(this.icon,M)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}hi(zc,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),zc.MAX_GLYPHS=65535,zc.addDynamicAttributes=bh;const yv=new gt({"symbol-placement":new ne(vt.layout_symbol["symbol-placement"]),"symbol-spacing":new ne(vt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new ne(vt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new He(vt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new ne(vt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new ne(vt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new ne(vt.layout_symbol["icon-ignore-placement"]),"icon-optional":new ne(vt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new ne(vt.layout_symbol["icon-rotation-alignment"]),"icon-size":new He(vt.layout_symbol["icon-size"]),"icon-text-fit":new ne(vt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new ne(vt.layout_symbol["icon-text-fit-padding"]),"icon-image":new He(vt.layout_symbol["icon-image"]),"icon-rotate":new He(vt.layout_symbol["icon-rotate"]),"icon-padding":new ne(vt.layout_symbol["icon-padding"]),"icon-keep-upright":new ne(vt.layout_symbol["icon-keep-upright"]),"icon-offset":new He(vt.layout_symbol["icon-offset"]),"icon-anchor":new He(vt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new ne(vt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new ne(vt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new ne(vt.layout_symbol["text-rotation-alignment"]),"text-field":new He(vt.layout_symbol["text-field"]),"text-font":new He(vt.layout_symbol["text-font"]),"text-size":new He(vt.layout_symbol["text-size"]),"text-max-width":new He(vt.layout_symbol["text-max-width"]),"text-line-height":new He(vt.layout_symbol["text-line-height"]),"text-letter-spacing":new He(vt.layout_symbol["text-letter-spacing"]),"text-justify":new He(vt.layout_symbol["text-justify"]),"text-radial-offset":new He(vt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new ne(vt.layout_symbol["text-variable-anchor"]),"text-anchor":new He(vt.layout_symbol["text-anchor"]),"text-max-angle":new ne(vt.layout_symbol["text-max-angle"]),"text-writing-mode":new ne(vt.layout_symbol["text-writing-mode"]),"text-rotate":new He(vt.layout_symbol["text-rotate"]),"text-padding":new ne(vt.layout_symbol["text-padding"]),"text-keep-upright":new ne(vt.layout_symbol["text-keep-upright"]),"text-transform":new He(vt.layout_symbol["text-transform"]),"text-offset":new He(vt.layout_symbol["text-offset"]),"text-allow-overlap":new ne(vt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new ne(vt.layout_symbol["text-ignore-placement"]),"text-optional":new ne(vt.layout_symbol["text-optional"])});var hm={paint:new gt({"icon-opacity":new He(vt.paint_symbol["icon-opacity"]),"icon-color":new He(vt.paint_symbol["icon-color"]),"icon-halo-color":new He(vt.paint_symbol["icon-halo-color"]),"icon-halo-width":new He(vt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new He(vt.paint_symbol["icon-halo-blur"]),"icon-translate":new ne(vt.paint_symbol["icon-translate"]),"icon-translate-anchor":new ne(vt.paint_symbol["icon-translate-anchor"]),"text-opacity":new He(vt.paint_symbol["text-opacity"]),"text-color":new He(vt.paint_symbol["text-color"],{runtimeType:qe,getOverride:r=>r.textColor,hasOverride:r=>!!r.textColor}),"text-halo-color":new He(vt.paint_symbol["text-halo-color"]),"text-halo-width":new He(vt.paint_symbol["text-halo-width"]),"text-halo-blur":new He(vt.paint_symbol["text-halo-blur"]),"text-translate":new ne(vt.paint_symbol["text-translate"]),"text-translate-anchor":new ne(vt.paint_symbol["text-translate-anchor"])}),layout:yv};class fm{constructor(e){this.type=e.property.overrides?e.property.overrides.runtimeType:or,this.defaultValue=e}evaluate(e){if(e.formattedSection){const o=this.defaultValue.property.overrides;if(o&&o.hasOverride(e.formattedSection))return o.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}hi(fm,"FormatSectionOverride",{omit:["defaultValue"]});class wh extends lo{constructor(e){super(e,hm)}recalculate(e,o){super.recalculate(e,o),"auto"===this.layout.get("icon-rotation-alignment")&&(this.layout._values["icon-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-rotation-alignment")&&(this.layout._values["text-rotation-alignment"]="point"!==this.layout.get("symbol-placement")?"map":"viewport"),"auto"===this.layout.get("text-pitch-alignment")&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),"auto"===this.layout.get("icon-pitch-alignment")&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const _ of c)f.indexOf(_)<0&&f.push(_);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]="point"===this.layout.get("symbol-placement")?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(e,o,c,f){const _=this.layout.get(e).evaluate(o,{},c,f),v=this._unevaluatedLayout._values[e];return v.isDataDriven()||ao(v.value)||!_?_:(w=o.properties,_.replace(/{([^{}]+)}/g,(M,L)=>L in w?String(w[L]):""));var w}createBucket(e){return new zc(e)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const e of hm.paint.overridableProperties){if(!wh.hasPaintOverride(this.layout,e))continue;const o=this.paint.get(e),c=new fm(o),f=new Bo(c,o.property.specification);let _=null;_="constant"===o.value.kind||"source"===o.value.kind?new Ts("source",f):new Zo("composite",f,o.value.zoomStops,o.value._interpolationType),this.paint._values[e]=new $e(o.property,_,o.parameters)}}_handleOverridablePaintPropertyUpdate(e,o,c){return!(!this.layout||o.isDataDriven()||c.isDataDriven())&&wh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,o){const c=e.get("text-field"),f=hm.paint.properties[o];let _=!1;const v=w=>{for(const E of w)if(f.overrides&&f.overrides.hasOverride(E))return void(_=!0)};if("constant"===c.value.kind&&c.value.value instanceof Ze)v(c.value.value.sections);else if("source"===c.value.kind){const w=M=>{_||(M instanceof ji&&Qi(M.value)===V?v(M.value.sections):M instanceof $o?v(M.sections):M.eachChild(w))},E=c.value;E._styleExpression&&w(E._styleExpression.expression)}return _}getProgramConfiguration(e){return new eu(this,e)}}var i_={paint:new gt({"background-color":new ne(vt.paint_background["background-color"]),"background-pattern":new ne(vt.paint_background["background-pattern"]),"background-opacity":new ne(vt.paint_background["background-opacity"])})},r_={paint:new gt({"raster-opacity":new ne(vt.paint_raster["raster-opacity"]),"raster-hue-rotate":new ne(vt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new ne(vt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new ne(vt.paint_raster["raster-brightness-max"]),"raster-saturation":new ne(vt.paint_raster["raster-saturation"]),"raster-contrast":new ne(vt.paint_raster["raster-contrast"]),"raster-resampling":new ne(vt.paint_raster["raster-resampling"]),"raster-fade-duration":new ne(vt.paint_raster["raster-fade-duration"])})};class ix extends lo{constructor(e){super(e,{}),this.implementation=e}is3D(){return"3d"===this.implementation.renderingMode}hasOffscreenPass(){return void 0!==this.implementation.prerender}isLayerDraped(){return void 0!==this.implementation.renderToTile}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(e){this.implementation.onAdd&&this.implementation.onAdd(e,e.painter.context.gl)}onRemove(e){this.implementation.onRemove&&this.implementation.onRemove(e,e.painter.context.gl)}}var pm={paint:new gt({"sky-type":new ne(vt.paint_sky["sky-type"]),"sky-atmosphere-sun":new ne(vt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new ne(vt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new ne(vt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new ne(vt.paint_sky["sky-gradient-radius"]),"sky-gradient":new ht(vt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new ne(vt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new ne(vt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new ne(vt.paint_sky["sky-opacity"])})};function Nl(r,e,o){const c=[0,0,1],f=dg([]);return fg(f,f,o?-X(r)+Math.PI:X(r)),hg(f,f,-X(e)),ug(c,c,f),Ps(c,c)}const o_={circle:class extends lo{constructor(r){super(r,Ip)}createBucket(r){return new Kh(r)}queryRadius(r){const e=r;return jd("circle-radius",this,e)+jd("circle-stroke-width",this,e)+Vd(this.paint.get("circle-translate"))}queryIntersectsFeature(r,e,o,c,f,_,v,w){const E=Dg(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),_.angle,r.pixelToTileUnitsFactor),M=this.paint.get("circle-radius").evaluate(e,o)+this.paint.get("circle-stroke-width").evaluate(e,o);return Ty(r,c,_,v,w,"map"===this.paint.get("circle-pitch-alignment"),"map"===this.paint.get("circle-pitch-scale"),E,M)}getProgramIds(){return["circle"]}getProgramConfiguration(r){return new eu(this,r)}},heatmap:class extends lo{createBucket(r){return new Dy(r)}constructor(r){super(r,Ap),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){"heatmap-color"===r&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=ef({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(r){return jd("heatmap-radius",this,r)}queryIntersectsFeature(r,e,o,c,f,_,v,w){const E=this.paint.get("heatmap-radius").evaluate(e,o);return Ty(r,c,_,v,w,!0,!0,new ye(0,0),E)}hasOffscreenPass(){return 0!==this.paint.get("heatmap-opacity")&&"none"!==this.visibility}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(r){return new eu(this,r)}},hillshade:class extends lo{constructor(r){super(r,Ig)}hasOffscreenPass(){return 0!==this.paint.get("hillshade-exaggeration")&&"none"!==this.visibility}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends lo{constructor(r){super(r,zp)}getProgramIds(){const r=this.paint.get("fill-pattern"),e=r&&r.constantOr(1),o=[e?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&o.push(e&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),o}getProgramConfiguration(r){return new eu(this,r)}recalculate(r,e){super.recalculate(r,e);const o=this.paint._values["fill-outline-color"];"constant"===o.value.kind&&void 0===o.value.value&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(r){return new lu(r)}queryRadius(){return Vd(this.paint.get("fill-translate"))}queryIntersectsFeature(r,e,o,c,f,_){return!r.queryGeometry.isAboveHorizon&&lc(Cy(r.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),_.angle,r.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends lo{constructor(r){super(r,pf)}createBucket(r){return new td(r)}queryRadius(){return Vd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(r){return new eu(this,r)}queryIntersectsFeature(r,e,o,c,f,_,v,w,E){const M=Dg(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),_.angle,r.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(e,o),N=this.paint.get("fill-extrusion-base").evaluate(e,o),j=[0,0],W=w&&_.elevation,J=_.elevation?_.elevation.exaggeration():1,se=r.tile.getBucket(this);if(W&&se instanceof td){const xt=se.centroidVertexArray,At=E+1;At<xt.length&&(j[0]=xt.geta_centroid_pos0(At),j[1]=xt.geta_centroid_pos1(At))}if(0===j[0]&&1===j[1])return!1;"globe"===_.projection.name&&(c=Zp([c],[new ye(0,0),new ye(vi,vi)],r.tileID.canonical).map(xt=>xt.polygon).flat());const Le=W?w:null,[rt,bt]=(At=c,Mt=N,un=L,rn=M,Dn=v,Yn=Le,mn=j,Pn=J,Rn=_.center.lat,"globe"===(xt=_).projection.name?function(Qn,En,ai,gi,ci,Ji,ri,Ai,Zi,wr,Ki){const Ni=[],io=[],er=Qn.projection.upVectorScale(Ki,Qn.center.lat,Qn.worldSize).metersToTile,tr=[0,0,0,1],Hr=[0,0,0,1],Xr=(Cr,po,mo,qr)=>{Cr[0]=po,Cr[1]=mo,Cr[2]=qr,Cr[3]=1},Wr=Qd();ai>0&&(ai+=Wr),gi+=Wr;for(const Cr of En){const po=[],mo=[];for(const qr of Cr){const Ur=qr.x+ci.x,ko=qr.y+ci.y,Fo=Qn.projection.projectTilePoint(Ur,ko,Ki),ar=Qn.projection.upVector(Ki,qr.x,qr.y);let Tr=ai,wo=gi;if(ri){const Qr=mf(Ur,ko,ai,gi,ri,Ai,Zi,wr);Tr+=Qr.base,wo+=Qr.top}0!==ai?Xr(tr,Fo.x+ar[0]*er*Tr,Fo.y+ar[1]*er*Tr,Fo.z+ar[2]*er*Tr):Xr(tr,Fo.x,Fo.y,Fo.z),Xr(Hr,Fo.x+ar[0]*er*wo,Fo.y+ar[1]*er*wo,Fo.z+ar[2]*er*wo),bo(tr,tr,Ji),bo(Hr,Hr,Ji),po.push(new du(tr[0],tr[1],tr[2])),mo.push(new du(Hr[0],Hr[1],Hr[2]))}Ni.push(po),io.push(mo)}return[Ni,io]}(xt,At,Mt,un,rn,Dn,Yn,mn,Pn,Rn,r.tileID.canonical):Yn?function(Qn,En,ai,gi,ci,Ji,ri,Ai,Zi){const wr=[],Ki=[],Ni=[0,0,0,1];for(const io of Qn){const er=[],tr=[];for(const Hr of io){const Xr=Hr.x+gi.x,Wr=Hr.y+gi.y,Cr=mf(Xr,Wr,En,ai,Ji,ri,Ai,Zi);Ni[0]=Xr,Ni[1]=Wr,Ni[2]=Cr.base,Ni[3]=1,tu(Ni,Ni,ci),Ni[3]=Math.max(Ni[3],1e-5);const po=new du(Ni[0]/Ni[3],Ni[1]/Ni[3],Ni[2]/Ni[3]);Ni[0]=Xr,Ni[1]=Wr,Ni[2]=Cr.top,Ni[3]=1,tu(Ni,Ni,ci),Ni[3]=Math.max(Ni[3],1e-5);const mo=new du(Ni[0]/Ni[3],Ni[1]/Ni[3],Ni[2]/Ni[3]);er.push(po),tr.push(mo)}wr.push(er),Ki.push(tr)}return[wr,Ki]}(At,Mt,un,rn,Dn,Yn,mn,Pn,Rn):function(Qn,En,ai,gi,ci){const Ji=[],ri=[],Ai=ci[8]*En,Zi=ci[9]*En,wr=ci[10]*En,Ki=ci[11]*En,Ni=ci[8]*ai,io=ci[9]*ai,er=ci[10]*ai,tr=ci[11]*ai;for(const Hr of Qn){const Xr=[],Wr=[];for(const Cr of Hr){const po=Cr.x+gi.x,mo=Cr.y+gi.y,qr=ci[0]*po+ci[4]*mo+ci[12],Ur=ci[1]*po+ci[5]*mo+ci[13],ko=ci[2]*po+ci[6]*mo+ci[14],Fo=ci[3]*po+ci[7]*mo+ci[15],ar=qr+Ai,Tr=Ur+Zi,wo=ko+wr,Qr=Math.max(Fo+Ki,1e-5),Ks=qr+Ni,Co=Ur+io,Wo=ko+er,Vo=Math.max(Fo+tr,1e-5);Xr.push(new du(ar/Qr,Tr/Qr,wo/Qr)),Wr.push(new du(Ks/Vo,Co/Vo,Wo/Vo))}Ji.push(Xr),ri.push(Wr)}return[Ji,ri]}(At,Mt,un,rn,Dn)),at=r.queryGeometry;var xt,At,Mt,un,rn,Dn,Yn,mn,Pn,Rn;return function(xt,At,Mt){let un=1/0;lc(Mt,At)&&(un=nh(Mt,At[0]));for(let rn=0;rn<At.length;rn++){const Dn=At[rn],Yn=xt[rn];for(let mn=0;mn<Dn.length-1;mn++){const Pn=Dn[mn],Rn=[Pn,Dn[mn+1],Yn[mn+1],Yn[mn],Pn];su(Mt,Rn)&&(un=Math.min(un,nh(Mt,Rn)))}}return un!==1/0&&un}(rt,bt,at.isPointQuery()?at.screenBounds:at.screenGeometry)}},line:class extends lo{constructor(r){super(r,Hp),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(r){if("line-gradient"===r){const e=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=e._styleExpression&&e._styleExpression.expression instanceof ro,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(r,e){super.recalculate(r,e),this.paint._values["line-floorwidth"]=Wp.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,r)}createBucket(r){return new od(r)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(r){return new eu(this,r)}queryRadius(r){const e=r,o=qp(jd("line-width",this,e),jd("line-gap-width",this,e)),c=jd("line-offset",this,e);return o/2+Math.abs(c)+Vd(this.paint.get("line-translate"))}queryIntersectsFeature(r,e,o,c,f,_){if(r.queryGeometry.isAboveHorizon)return!1;const v=Cy(r.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),_.angle,r.pixelToTileUnitsFactor),w=r.pixelToTileUnitsFactor/2*qp(this.paint.get("line-width").evaluate(e,o),this.paint.get("line-gap-width").evaluate(e,o)),E=this.paint.get("line-offset").evaluate(e,o);return E&&(c=function(M,L){const N=[],j=new ye(0,0);for(let W=0;W<M.length;W++){const J=M[W],se=[];for(let Le=0;Le<J.length;Le++){const rt=J[Le],bt=J[Le+1],at=0===Le?j:rt.sub(J[Le-1])._unit()._perp(),xt=Le===J.length-1?j:bt.sub(rt)._unit()._perp(),At=at._add(xt)._unit();At._mult(1/(At.x*xt.x+At.y*xt.y)),se.push(At._mult(L)._add(rt))}N.push(se)}return N}(c,E*r.pixelToTileUnitsFactor)),function(M,L,N){for(let j=0;j<L.length;j++){const W=L[j];if(M.length>=3)for(let J=0;J<W.length;J++)if(Sc(M,W[J]))return!0;if(Dp(M,W,N))return!0}return!1}(v,c,w)}isTileClipped(){return!0}},symbol:wh,background:class extends lo{constructor(r){super(r,i_)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends lo{constructor(r){super(r,r_)}getProgramIds(){return["raster"]}},sky:class extends lo{constructor(r){super(r,pm),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(r){"sky-gradient"===r?this._updateColorRamp():"sky-atmosphere-sun"!==r&&"sky-atmosphere-halo-color"!==r&&"sky-atmosphere-color"!==r&&"sky-atmosphere-sun-intensity"!==r||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=ef({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(r){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const e=r.style.light.properties.get("position");return this._lightPosition.azimuthal!==e.azimuthal||this._lightPosition.polar!==e.polar}return!1}getCenter(r,e){if("atmosphere"===this.paint.get("sky-type")){const c=this.paint.get("sky-atmosphere-sun"),f=!c,_=r.style.light,v=_.properties.get("position");return f&&"viewport"===_.properties.get("anchor")&&It("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?Nl(v.azimuthal,90-v.polar,e):Nl(c[0],90-c[1],e)}const o=this.paint.get("sky-gradient-center");return Nl(o[0],90-o[1],e)}is3D(){return!1}isSky(){return!0}markSkyboxValid(r){this._skyboxInvalidated=!1,this._lightPosition=r.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const r=this.paint.get("sky-type");return"atmosphere"===r?["skyboxCapture","skybox"]:"gradient"===r?["skyboxGradient"]:null}}};class Uc{constructor(e,o,c,f){this.context=e,this.format=c,this.texture=e.gl.createTexture(),this.update(o,f)}update(e,o,c){const{width:f,height:_}=e,{context:v}=this,{gl:w}=v,{HTMLImageElement:E,HTMLCanvasElement:M,HTMLVideoElement:L,ImageData:N,ImageBitmap:j}=B;if(w.bindTexture(w.TEXTURE_2D,this.texture),v.pixelStoreUnpackFlipY.set(!1),v.pixelStoreUnpack.set(1),v.pixelStoreUnpackPremultiplyAlpha.set(this.format===w.RGBA&&(!o||!1!==o.premultiply)),c||this.size&&this.size[0]===f&&this.size[1]===_){const{x:W,y:J}=c||{x:0,y:0};e instanceof E||e instanceof M||e instanceof L||e instanceof N||j&&e instanceof j?w.texSubImage2D(w.TEXTURE_2D,0,W,J,w.RGBA,w.UNSIGNED_BYTE,e):w.texSubImage2D(w.TEXTURE_2D,0,W,J,f,_,w.RGBA,w.UNSIGNED_BYTE,e.data)}else this.size=[f,_],e instanceof E||e instanceof M||e instanceof L||e instanceof N||j&&e instanceof j?w.texImage2D(w.TEXTURE_2D,0,this.format,this.format,w.UNSIGNED_BYTE,e):w.texImage2D(w.TEXTURE_2D,0,this.format,f,_,0,this.format,w.UNSIGNED_BYTE,e.data);this.useMipmap=!!(o&&o.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&w.generateMipmap(w.TEXTURE_2D)}bind(e,o){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),e!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,e),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?e===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:e),this.filter=e),o!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,o),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:e}=this.context;e.deleteTexture(this.texture),this.texture=null}}class s_{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class a_{constructor(){this.tasks={},this.taskQueue=[],an(["process"],this),this.invoker=new s_(this.process),this.nextId=0}add(e,o){const c=this.nextId++,f=function({type:_,isSymbolTile:v,zoom:w}){return w=w||0,"message"===_?0:"maybePrepare"!==_||v?"parseTile"!==_||v?"parseTile"===_&&v?300-w:"maybePrepare"===_&&v?400-w:500:200-w:100-w}(o);if(0===f){Zt();try{e()}finally{}return{cancel:()=>{}}}return this.tasks[c]={fn:e,metadata:o,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}}}process(){Zt();try{if(this.taskQueue=this.taskQueue.filter(c=>!!this.tasks[c]),!this.taskQueue.length)return;const e=this.pick();if(null===e)return;const o=this.tasks[e];if(delete this.tasks[e],this.taskQueue.length&&this.invoker.trigger(),!o)return;o.fn()}finally{}}pick(){let e=null,o=1/0;for(let f=0;f<this.taskQueue.length;f++){const _=this.tasks[this.taskQueue[f]];_.priority<o&&(o=_.priority,e=f)}if(null===e)return null;const c=this.taskQueue[e];return this.taskQueue.splice(e,1),c}remove(){this.invoker.remove()}}class l_{constructor(e){this._stringToNumber={},this._numberToString=[];for(let o=0;o<e.length;o++){const c=e[o];this._stringToNumber[c]=o,this._numberToString[o]=c}}encode(e){return this._stringToNumber[e]}decode(e){return this._numberToString[e]}}const vv=["tile","layer","source","sourceLayer","state"];class c_{constructor(e,o,c,f,_){this.type="Feature",this._vectorTileFeature=e,this._z=o,this._x=c,this._y=f,this.properties=e.properties,this.id=_}get geometry(){return void 0===this._geometry&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};void 0!==this.id&&(e.id=this.id);for(const o of vv)void 0!==this[o]&&(e[o]=this[o]);return e}}const gu=new Uint16Array(8184);for(let r=0;r<2046;r++){let e=r+2,o=0,c=0,f=0,_=0,v=0,w=0;for(1&e?f=_=v=32:o=c=w=32;(e>>=1)>1;){const M=o+f>>1,L=c+_>>1;1&e?(f=o,_=c,o=v,c=w):(o=f,c=_,f=v,_=w),v=M,w=L}const E=4*r;gu[E+0]=o,gu[E+1]=c,gu[E+2]=f,gu[E+3]=_}const Bl=new Uint16Array(2178),_u=new Uint8Array(1089),mm=new Uint16Array(1089);function gm(r){return 0===r?-.03125:32===r?.03125:0}var _m=$t([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const xv={type:2,extent:vi,loadGeometry:()=>[[new ye(0,0),new ye(vi+1,0),new ye(vi+1,vi+1),new ye(0,vi+1),new ye(0,0)]]};class sr{constructor(e,o,c,f,_){this.tileID=e,this.uid=ke(),this.uses=0,this.tileSize=o,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=_,this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(e){const o=e+this.timeAdded;o<Yr.now()||this.fadeEndTime&&o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return"errored"===this.state||"loaded"===this.state||"reloading"===this.state}get tileTransform(){return this._tileTransform||(this._tileTransform=md(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(e,o,c){if(this.unloadVectorData(),this.state="loaded",e){e.featureIndex&&(this.latestFeatureIndex=e.featureIndex,e.rawTileData?(this.latestRawTileData=e.rawTileData,this.latestFeatureIndex.rawTileData=e.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=e.collisionBoxArray,this.buckets=function(f,_){const v={};if(!_)return v;for(const w of f){const E=w.layerIds.map(M=>_.getLayer(M)).filter(Boolean);if(0!==E.length){w.layers=E,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(M=>E.filter(L=>L.id===M)[0]));for(const M of E)v[M.id]=w}}return v}(e.buckets,o.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof zc){if(this.hasSymbolBuckets=!0,!c)break;_.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const _=this.buckets[f];if(_ instanceof zc&&_.hasRTLText){this.hasRTLText=!0,I.isLoading()||I.isLoaded()||"deferred"!==x()||D();break}}this.queryPadding=0;for(const f in this.buckets){const _=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(f).queryRadius(_))}e.imageAtlas&&(this.imageAtlas=e.imageAtlas),e.glyphAtlasImage&&(this.glyphAtlasImage=e.glyphAtlasImage),e.lineAtlas&&(this.lineAtlas=e.lineAtlas)}else this.collisionBoxArray=new yr}unloadVectorData(){if(this.hasData()){for(const e in this.buckets)this.buckets[e].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(e){return this.buckets[e.id]}upload(e){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(e)}const o=e.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Uc(e,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Uc(e,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Uc(e,this.lineAtlas.image,o.ALPHA),this.lineAtlas.uploaded=!0)}prepare(e){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(e,this.imageAtlasTexture)}queryRenderedFeatures(e,o,c,f,_,v,w,E){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:w,transform:v,params:_,tileTransform:this.tileTransform},e,o,c):{}}querySourceFeatures(e,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),_=o?o.sourceLayer:"",v=f._geojsonTileLayer||f[_];if(!v)return;const w=yc(o&&o.filter),{z:E,x:M,y:L}=this.tileID.canonical,N={z:E,x:M,y:L};for(let j=0;j<v.length;j++){const W=v.feature(j);if(w.needGeometry){const Le=ou(W,!0);if(!w.filter(new R(this.tileID.overscaledZ),Le,this.tileID.canonical))continue}else if(!w.filter(new R(this.tileID.overscaledZ),W))continue;const J=c.getId(W,_),se=new c_(W,E,M,L,J);se.tile=N,e.push(se)}}hasData(){return"loaded"===this.state||"reloading"===this.state||"expired"===this.state}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(e){const o=this.expirationTime;if(e.cacheControl){const c=hn(e.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else e.expires&&(this.expirationTime=new Date(e.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(o)if(this.expirationTime<o)f=!0;else{const _=this.expirationTime-o;_?this.expirationTime=c+Math.max(_,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-(new Date).getTime(),Math.pow(2,31)-1)}setFeatureState(e,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||0===Object.keys(e).length||!o)return;const c=this.latestFeatureIndex.loadVTLayers(),f=o.style.listImages();for(const _ in this.buckets){if(!o.style.hasLayer(_))continue;const v=this.buckets[_],w=v.layers[0].sourceLayer||"_geojsonTileLayer",E=c[w],M=e[w];if(!E||!M||0===Object.keys(M).length)continue;if(v.update(M,E,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),v instanceof od||v instanceof lu){const N=o.style._getSourceCache(v.layers[0].source);o._terrain&&o._terrain.enabled&&N&&v.programConfigurations.needsUpload&&o._terrain._clearRenderCacheForTile(N.id,this.tileID)}const L=o&&o.style&&o.style.getLayer(_);L&&(this.queryPadding=Math.max(this.queryPadding,L.queryRadius(v)))}}holdingForFade(){return void 0!==this.symbolFadeHoldUntil}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Yr.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(e){this.symbolFadeHoldUntil=Yr.now()+e}setTexture(e,o){const c=o.context,f=c.gl;this.texture=this.texture||o.getTileTexture(e.width),this.texture?this.texture.update(e,{useMipmap:!0}):(this.texture=new Uc(c,e,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE))}setDependencies(e,o){const c={};for(const f of o)c[f]=!0;this.dependencies[e]=c}hasDependency(e,o){for(const c of e){const f=this.dependencies[c];if(f)for(const _ of o)if(f[_])return!0}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(e,o){if(!o||"mercator"===o.name||this._tileDebugBuffer)return;const c=ac(xv,this.tileID.canonical,this.tileTransform)[0],f=new Wn,_=new sa;for(let v=0;v<c.length;v++){const{x:w,y:E}=c[v];f.emplaceBack(w,E),_.emplaceBack(v)}_.emplaceBack(0),this._tileDebugIndexBuffer=e.createIndexBuffer(_),this._tileDebugBuffer=e.createVertexBuffer(f,Dc.members),this._tileDebugSegments=So.simpleSegment(0,0,f.length,_.length)}_makeTileBoundsBuffers(e,o){if(this._tileBoundsBuffer||!o||"mercator"===o.name)return;const c=ac(xv,this.tileID.canonical,this.tileTransform)[0];let f,_;if(this.isRaster){const v=function(w,E){const M=md(w,E),L=Math.pow(2,w.z);for(let Le=0;Le<33;Le++)for(let rt=0;rt<33;rt++){const bt=Rs((w.x+(rt+gm(rt))/32)/L),at=ps((w.y+(Le+gm(Le))/32)/L),xt=E.project(bt,at),At=33*Le+rt;Bl[2*At+0]=Math.round((xt.x*M.scale-M.x)*vi),Bl[2*At+1]=Math.round((xt.y*M.scale-M.y)*vi)}_u.fill(0),mm.fill(0);for(let Le=2045;Le>=0;Le--){const rt=4*Le,bt=gu[rt+0],at=gu[rt+1],xt=gu[rt+2],At=gu[rt+3],Mt=bt+xt>>1,un=at+At>>1,rn=Mt+un-at,Dn=un+bt-Mt,Yn=33*at+bt,mn=33*At+xt,Pn=33*un+Mt,Rn=Math.hypot((Bl[2*Yn+0]+Bl[2*mn+0])/2-Bl[2*Pn+0],(Bl[2*Yn+1]+Bl[2*mn+1])/2-Bl[2*Pn+1])>=16;_u[Pn]=_u[Pn]||(Rn?1:0),Le<1022&&(_u[Pn]=_u[Pn]||_u[33*(at+Dn>>1)+(bt+rn>>1)]||_u[33*(At+Dn>>1)+(xt+rn>>1)])}const N=new Mn,j=new Ci;let W=0;function J(Le,rt){const bt=33*rt+Le;return 0===mm[bt]&&(N.emplaceBack(Bl[2*bt+0],Bl[2*bt+1],Le*vi/32,rt*vi/32),mm[bt]=++W),mm[bt]-1}function se(Le,rt,bt,at,xt,At){const Mt=Le+bt>>1,un=rt+at>>1;if(Math.abs(Le-xt)+Math.abs(rt-At)>1&&_u[33*un+Mt])se(xt,At,Le,rt,Mt,un),se(bt,at,xt,At,Mt,un);else{const rn=J(Le,rt),Dn=J(bt,at),Yn=J(xt,At);j.emplaceBack(rn,Dn,Yn)}}return se(0,0,32,32,32,0),se(32,32,0,0,0,32),{vertices:N,indices:j}}(this.tileID.canonical,o);f=v.vertices,_=v.indices}else{f=new Mn,_=new Ci;for(const{x:w,y:E}of c)f.emplaceBack(w,E,0,0);const v=rf(f.int16,void 0,4);for(let w=0;w<v.length;w+=3)_.emplaceBack(v[w],v[w+1],v[w+2])}this._tileBoundsBuffer=e.createVertexBuffer(f,_m.members),this._tileBoundsIndexBuffer=e.createIndexBuffer(_),this._tileBoundsSegments=So.simpleSegment(0,0,f.length,_.length)}_makeGlobeTileDebugBuffers(e,o){const c=o.projection;if(!c||"globe"!==c.name||o.freezeTileCoverage)return;const f=this.tileID.canonical,_=ru(Zh(f,o)),v=Ju(o.zoom);let w;v>0&&(w=zh(new Float64Array(16),o.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(e,f,o,_,w,v),this._makeGlobeTileDebugTextBuffer(e,f,o,_,w,v)}_globePoint(e,o,c,f,_,v,w){let E=Bd(e,o,c);if(v){const M=1<<c.z,L=Os(f.center.lng),N=Pa(f.center.lat),j=(c.x+.5)/M-L;let W=0;j>.5?W=-1:j<-.5&&(W=1);let J=(e/vi+c.x)/M+W,se=(o/vi+c.y)/M;J=(J-L)*f._pixelsPerMercatorPixel+L,se=(se-N)*f._pixelsPerMercatorPixel+N;const Le=[J*f.worldSize,se*f.worldSize,0];bo(Le,Le,v),E=Ka(E,Le,w)}return bo(E,E,_)}_makeGlobeTileDebugBorderBuffer(e,o,c,f,_,v){const w=new Wn,E=new sa,M=new nn,L=(j,W,J,se,Le)=>{const rt=(J-j)/(Le-1),bt=(se-W)/(Le-1),at=w.length;for(let xt=0;xt<Le;xt++){const At=j+xt*rt,Mt=W+xt*bt;w.emplaceBack(At,Mt);const un=this._globePoint(At,Mt,o,c,f,_,v);M.emplaceBack(un[0],un[1],un[2]),E.emplaceBack(at+xt)}},N=vi;L(0,0,N,0,16),L(N,0,N,N,16),L(N,N,0,N,16),L(0,N,0,0,16),this._tileDebugIndexBuffer=e.createIndexBuffer(E),this._tileDebugBuffer=e.createVertexBuffer(w,Dc.members),this._globeTileDebugBorderBuffer=e.createVertexBuffer(M,Fd.members),this._tileDebugSegments=So.simpleSegment(0,0,w.length,E.length)}_makeGlobeTileDebugTextBuffer(e,o,c,f,_,v){const w=vi/4,E=new Wn,M=new Ci,L=new nn,N=25;M.reserve(32),E.reserve(N),L.reserve(N);const j=(W,J)=>N*W+J;for(let W=0;W<N;W++){const J=W*w;for(let se=0;se<N;se++){const Le=se*w;E.emplaceBack(Le,J);const rt=this._globePoint(Le,J,o,c,f,_,v);L.emplaceBack(rt[0],rt[1],rt[2])}}for(let W=0;W<4;W++)for(let J=0;J<4;J++){const se=j(W,J),Le=j(W,J+1),rt=j(W+1,J),bt=j(W+1,J+1);M.emplaceBack(se,Le,rt),M.emplaceBack(rt,Le,bt)}this._tileDebugTextIndexBuffer=e.createIndexBuffer(M),this._tileDebugTextBuffer=e.createVertexBuffer(E,Dc.members),this._globeTileDebugTextBuffer=e.createVertexBuffer(L,Fd.members),this._tileDebugTextSegments=So.simpleSegment(0,0,N,32)}}class u_{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(e,o,c){const f=String(o);if(this.stateChanges[e]=this.stateChanges[e]||{},this.stateChanges[e][f]=this.stateChanges[e][f]||{},We(this.stateChanges[e][f],c),null===this.deletedStates[e]){this.deletedStates[e]={};for(const _ in this.state[e])_!==f&&(this.deletedStates[e][_]=null)}else if(this.deletedStates[e]&&null===this.deletedStates[e][f]){this.deletedStates[e][f]={};for(const _ in this.state[e][f])c[_]||(this.deletedStates[e][f][_]=null)}else for(const _ in c)this.deletedStates[e]&&this.deletedStates[e][f]&&null===this.deletedStates[e][f][_]&&delete this.deletedStates[e][f][_]}removeFeatureState(e,o,c){if(null===this.deletedStates[e])return;const f=String(o);if(this.deletedStates[e]=this.deletedStates[e]||{},c&&void 0!==o)null!==this.deletedStates[e][f]&&(this.deletedStates[e][f]=this.deletedStates[e][f]||{},this.deletedStates[e][f][c]=null);else if(void 0!==o)if(this.stateChanges[e]&&this.stateChanges[e][f])for(c in this.deletedStates[e][f]={},this.stateChanges[e][f])this.deletedStates[e][f][c]=null;else this.deletedStates[e][f]=null;else this.deletedStates[e]=null}getState(e,o){const c=String(o),f=We({},(this.state[e]||{})[c],(this.stateChanges[e]||{})[c]);if(null===this.deletedStates[e])return{};if(this.deletedStates[e]){const _=this.deletedStates[e][o];if(null===_)return{};for(const v in _)delete f[v]}return f}initializeTileState(e,o){e.setFeatureState(this.state,o)}coalesceChanges(e,o){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const _={};for(const v in this.stateChanges[f])this.state[f][v]||(this.state[f][v]={}),We(this.state[f][v],this.stateChanges[f][v]),_[v]=this.state[f][v];c[f]=_}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const _={};if(null===this.deletedStates[f])for(const v in this.state[f])_[v]={},this.state[f][v]={};else for(const v in this.deletedStates[f]){if(null===this.deletedStates[f][v])this.state[f][v]={};else if(this.state[f][v])for(const w of Object.keys(this.deletedStates[f][v]))delete this.state[f][v][w];_[v]=this.state[f][v]}c[f]=c[f]||{},We(c[f],_)}if(this.stateChanges={},this.deletedStates={},0!==Object.keys(c).length)for(const f in e)e[f].setFeatureState(c,o)}}class ym{constructor(e){this.size=e,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(e,o){const c=this.toIdx(e,o);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(e,o){return this.leaves[this.toIdx(e,o)]}toIdx(e,o){return o*this.size+e}}function yu(r,e,o,c){let f=0,_=Number.MAX_VALUE;for(let v=0;v<3;v++)if(Math.abs(c[v])<1e-15){if(o[v]<r[v]||o[v]>e[v])return null}else{const w=1/c[v];let E=(r[v]-o[v])*w,M=(e[v]-o[v])*w;if(E>M){const L=E;E=M,M=L}if(E>f&&(f=E),M<_&&(_=M),f>_)return null}return f}function vm(r,e,o,c,f,_,v,w,E,M,L){const N=c-r,j=f-e,W=_-o,J=v-r,se=w-e,Le=E-o,rt=L[1]*Le-L[2]*se,bt=L[2]*J-L[0]*Le,at=L[0]*se-L[1]*J,xt=N*rt+j*bt+W*at;if(Math.abs(xt)<1e-15)return null;const At=1/xt,Mt=M[0]-r,un=M[1]-e,rn=M[2]-o,Dn=(Mt*rt+un*bt+rn*at)*At;if(Dn<0||Dn>1)return null;const Yn=un*W-rn*j,mn=rn*N-Mt*W,Pn=Mt*j-un*N,Rn=(L[0]*Yn+L[1]*mn+L[2]*Pn)*At;return Rn<0||Dn+Rn>1?null:(J*Yn+se*mn+Le*Pn)*At}function xm(r,e,o){return(r-e)/(o-e)}function d_(r,e,o,c,f,_,v,w,E){const M=1<<o,L=_-c,N=v-f,j=(r+1)/M*L+c,W=(e+0)/M*N+f,J=(e+1)/M*N+f;w[0]=(r+0)/M*L+c,w[1]=W,E[0]=j,E[1]=J}class Ch{constructor(e){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=e,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const o=function(_){const v=Math.ceil(Math.log2(_.dim/8)),w=[];let E=Math.ceil(Math.pow(2,v));const M=1/E,L=(W,J,se,Le,rt)=>{const bt=Le?1:0,at=(W+1)*se-bt,xt=J*se,At=(J+1)*se-bt;rt[0]=W*se,rt[1]=xt,rt[2]=at,rt[3]=At};let N=new ym(E);const j=[];for(let W=0;W<E*E;W++){L(W%E,Math.floor(W/E),M,!1,j);const J=zl(j[0],j[1],_),se=zl(j[2],j[1],_),Le=zl(j[2],j[3],_),rt=zl(j[0],j[3],_);N.minimums.push(Math.min(J,se,Le,rt)),N.maximums.push(Math.max(J,se,Le,rt)),N.leaves.push(1)}for(w.push(N),E/=2;E>=1;E/=2){const W=w[w.length-1];N=new ym(E);for(let J=0;J<E*E;J++){L(J%E,Math.floor(J/E),2,!0,j);const se=W.getElevation(j[0],j[1]),Le=W.getElevation(j[2],j[1]),rt=W.getElevation(j[2],j[3]),bt=W.getElevation(j[0],j[3]),at=W.isLeaf(j[0],j[1]),xt=W.isLeaf(j[2],j[1]),At=W.isLeaf(j[2],j[3]),Mt=W.isLeaf(j[0],j[3]),un=Math.min(se.min,Le.min,rt.min,bt.min),rn=Math.max(se.max,Le.max,rt.max,bt.max),Dn=at&&xt&&At&&Mt;N.maximums.push(rn),N.minimums.push(un),N.leaves.push(rn-un<=5&&Dn?1:0)}w.push(N)}return w}(this.dem),c=o.length-1,f=o[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(o,0,0,c,0)}raycastRoot(e,o,c,f,_,v,w=1){return yu([e,o,-100],[c,f,this.maximums[0]*w],_,v)}raycast(e,o,c,f,_,v,w=1){if(!this.nodeCount)return null;const E=this.raycastRoot(e,o,c,f,_,v,w);if(null==E)return null;const M=[],L=[],N=[],j=[],W=[{idx:0,t:E,nodex:0,nodey:0,depth:0}];for(;W.length>0;){const{idx:J,t:se,nodex:Le,nodey:rt,depth:bt}=W.pop();if(this.leaves[J]){d_(Le,rt,bt,e,o,c,f,N,j);const xt=1<<bt,At=(Le+0)/xt,Mt=(Le+1)/xt,un=(rt+0)/xt,rn=(rt+1)/xt,Dn=zl(At,un,this.dem)*w,Yn=zl(Mt,un,this.dem)*w,mn=zl(Mt,rn,this.dem)*w,Pn=zl(At,rn,this.dem)*w,Rn=vm(N[0],N[1],Dn,j[0],N[1],Yn,j[0],j[1],mn,_,v),zn=vm(j[0],j[1],mn,N[0],j[1],Pn,N[0],N[1],Dn,_,v),Qn=Math.min(null!==Rn?Rn:Number.MAX_VALUE,null!==zn?zn:Number.MAX_VALUE);if(Qn!==Number.MAX_VALUE)return Qn;{const En=Rd([],_,v,se);if(vu(Dn,Yn,Pn,mn,xm(En[0],N[0],j[0]),xm(En[1],N[1],j[1]))>=En[2])return se}continue}let at=0;for(let xt=0;xt<this._siblingOffset.length;xt++){d_((Le<<1)+this._siblingOffset[xt][0],(rt<<1)+this._siblingOffset[xt][1],bt+1,e,o,c,f,N,j),N[2]=-100,j[2]=this.maximums[this.childOffsets[J]+xt]*w;const At=yu(N,j,_,v);if(null!=At){const Mt=At;M[xt]=Mt;let un=!1;for(let rn=0;rn<at&&!un;rn++)Mt>=M[L[rn]]&&(L.splice(rn,0,xt),un=!0);un||(L[at]=xt),at++}}for(let xt=0;xt<at;xt++){const At=L[xt];W.push({idx:this.childOffsets[J]+At,t:M[At],nodex:(Le<<1)+this._siblingOffset[At][0],nodey:(rt<<1)+this._siblingOffset[At][1],depth:bt+1})}}return null}_addNode(e,o,c){return this.minimums.push(e),this.maximums.push(o),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(e,o,c,f,_){if(1===e[f].isLeaf(o,c))return;this.childOffsets[_]||(this.childOffsets[_]=this.nodeCount);const v=f-1,w=e[v];let E=0,M=0;for(let L=0;L<this._siblingOffset.length;L++){const N=2*o+this._siblingOffset[L][0],j=2*c+this._siblingOffset[L][1],W=w.getElevation(N,j),J=w.isLeaf(N,j),se=this._addNode(W.min,W.max,J);J&&(E|=1<<L),M||(M=se)}for(let L=0;L<this._siblingOffset.length;L++)E&1<<L||this._construct(e,2*o+this._siblingOffset[L][0],2*c+this._siblingOffset[L][1],v,M+L)}}function vu(r,e,o,c,f,_){return Pi(Pi(r,o,_),Pi(e,c,_),f)}function zl(r,e,o){const c=o.dim,f=Ke(r*c-.5,0,c-1),_=Ke(e*c-.5,0,c-1),v=Math.floor(f),w=Math.floor(_),E=Math.min(v+1,c-1),M=Math.min(w+1,c-1);return vu(o.get(v,w),o.get(E,w),o.get(v,M),o.get(E,M),f-v,_-w)}const _d={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function h_(r,e,o){return(256*r*256+256*e+o)/10-1e4}function bm(r,e,o){return 256*r+e+o/256-32768}class yd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(e,o,c,f=!1,_=!1){if(this.uid=e,o.height!==o.width)throw new RangeError("DEM tiles must be square");if(c&&"mapbox"!==c&&"terrarium"!==c)return It(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=o.height;const v=this.dim=o.height-2,w=new Uint32Array(o.data.buffer);if(this.pixels=new Uint8Array(o.data.buffer),this.encoding=c||"mapbox",this.borderReady=f,!f){for(let E=0;E<v;E++)w[this._idx(-1,E)]=w[this._idx(0,E)],w[this._idx(v,E)]=w[this._idx(v-1,E)],w[this._idx(E,-1)]=w[this._idx(E,0)],w[this._idx(E,v)]=w[this._idx(E,v-1)];w[this._idx(-1,-1)]=w[this._idx(0,0)],w[this._idx(v,-1)]=w[this._idx(v-1,0)],w[this._idx(-1,v)]=w[this._idx(0,v-1)],w[this._idx(v,v)]=w[this._idx(v-1,v-1)],_&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new Ch(this)}get(e,o,c=!1){c&&(e=Ke(e,-1,this.dim),o=Ke(o,-1,this.dim));const f=4*this._idx(e,o);return("terrarium"===this.encoding?bm:h_)(this.pixels[f],this.pixels[f+1],this.pixels[f+2])}static getUnpackVector(e){return _d[e]}get unpackVector(){return _d[this.encoding]}_idx(e,o){if(e<-1||e>=this.dim+1||o<-1||o>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(o+1)*this.stride+(e+1)}static pack(e,o){const c=[0,0,0,0],f=yd.getUnpackVector(o);let _=Math.floor((e+f[3])/f[2]);return c[2]=_%256,_=Math.floor(_/256),c[1]=_%256,_=Math.floor(_/256),c[0]=_,c}getPixels(){return new Ls({width:this.stride,height:this.stride},this.pixels)}backfillBorder(e,o,c){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let f=o*this.dim,_=o*this.dim+this.dim,v=c*this.dim,w=c*this.dim+this.dim;switch(o){case-1:f=_-1;break;case 1:_=f+1}switch(c){case-1:v=w-1;break;case 1:w=v+1}const E=-o*this.dim,M=-c*this.dim;for(let L=v;L<w;L++)for(let N=f;N<_;N++){const j=4*this._idx(N,L),W=4*this._idx(N+E,L+M);this.pixels[j+0]=e.pixels[W+0],this.pixels[j+1]=e.pixels[W+1],this.pixels[j+2]=e.pixels[W+2],this.pixels[j+3]=e.pixels[W+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}hi(yd,"DEMData"),hi(Ch,"DemMinMaxQuadTree",{omit:["dem"]});class wm{constructor(e,o){this.max=e,this.onRemove=o,this.reset()}reset(){for(const e in this.data)for(const o of this.data[e])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(e,o,c){const f=e.wrapped().key;void 0===this.data[f]&&(this.data[f]=[]);const _={value:o,timeout:void 0};if(void 0!==c&&(_.timeout=setTimeout(()=>{this.remove(e,_)},c)),this.data[f].push(_),this.order.push(f),this.order.length>this.max){const v=this._getAndRemoveByKey(this.order[0]);v&&this.onRemove(v)}return this}has(e){return e.wrapped().key in this.data}getAndRemove(e){return this.has(e)?this._getAndRemoveByKey(e.wrapped().key):null}_getAndRemoveByKey(e){const o=this.data[e].shift();return o.timeout&&clearTimeout(o.timeout),0===this.data[e].length&&delete this.data[e],this.order.splice(this.order.indexOf(e),1),o.value}getByKey(e){const o=this.data[e];return o?o[0].value:null}get(e){return this.has(e)?this.data[e.wrapped().key][0].value:null}remove(e,o){if(!this.has(e))return this;const c=e.wrapped().key,f=void 0===o?0:this.data[c].indexOf(o),_=this.data[c][f];return this.data[c].splice(f,1),_.timeout&&clearTimeout(_.timeout),0===this.data[c].length&&delete this.data[c],this.onRemove(_.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(e){for(this.max=e;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(e){const o=[];for(const c in this.data)for(const f of this.data[c])e(f.value)||o.push(f);for(const c of o)this.remove(c.value.tileID,c)}}class xu{constructor(e,o,c){this.func=e,this.mask=o,this.range=c}}xu.ReadOnly=!1,xu.ReadWrite=!0,xu.disabled=new xu(519,xu.ReadOnly,[0,1]);class Cm{constructor(e,o,c,f,_,v){this.test=e,this.ref=o,this.mask=c,this.fail=f,this.depthFail=_,this.pass=v}}Cm.disabled=new Cm({func:519,mask:0},0,0,7680,7680,7680);class Ul{constructor(e,o,c){this.blendFunction=e,this.blendColor=o,this.mask=c}}Ul.Replace=[1,0],Ul.disabled=new Ul(Ul.Replace,O.transparent,[!1,!1,!1,!1]),Ul.unblended=new Ul(Ul.Replace,O.transparent,[!0,!0,!0,!0]),Ul.alphaBlended=new Ul([1,771],O.transparent,[!0,!0,!0,!0]);class vl{constructor(e,o,c){this.enable=e,this.mode=o,this.frontFace=c}}vl.disabled=new vl(!1,1029,2305),vl.backCCW=new vl(!0,1029,2305),vl.backCW=new vl(!0,1029,2304),vl.frontCW=new vl(!0,1028,2304),vl.frontCCW=new vl(!0,1028,2305);class bu extends ln{constructor(e,o,c){super(),this.id=e,this._onlySymbols=c,o.on("data",f=>{"source"===f.dataType&&"metadata"===f.sourceDataType&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&"source"===f.dataType&&"content"===f.sourceDataType&&(this.reload(),this.transform&&this.update(this.transform))}),o.on("error",()=>{this._sourceErrored=!0}),this._source=o,this._tiles={},this._cache=new wm(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=o.minTileCacheSize,this._maxTileCacheSize=o.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new u_,this._isRaster="raster"===this._source.type||"raster-dem"===this._source.type||"custom"===this._source.type&&"raster"===this._source._dataType}onAdd(e){this.map=e,this._minTileCacheSize=void 0===this._minTileCacheSize&&e?e._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=void 0===this._maxTileCacheSize&&e?e._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const e in this._tiles){const o=this._tiles[e];if("loaded"!==o.state&&"errored"!==o.state)return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const e=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,e&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(e,o){return e.isSymbolTile=this._onlySymbols,this._source.loadTile(e,o)}_unloadTile(e){if(this._source.unloadTile)return this._source.unloadTile(e,()=>{})}_abortTile(e){if(this._source.abortTile)return this._source.abortTile(e,()=>{})}serialize(){return this._source.serialize()}prepare(e){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(e),c.prepare(this.map.style.imageManager)}}getIds(){return Ut(this._tiles).map(e=>e.tileID).sort(f_).map(e=>e.key)}getRenderableIds(e){const o=[];for(const c in this._tiles)this._isIdRenderable(+c,e)&&o.push(this._tiles[c]);return e?o.sort((c,f)=>{const _=c.tileID,v=f.tileID,w=new ye(_.canonical.x,_.canonical.y)._rotate(this.transform.angle),E=new ye(v.canonical.x,v.canonical.y)._rotate(this.transform.angle);return _.overscaledZ-v.overscaledZ||E.y-w.y||E.x-w.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(f_).map(c=>c.key)}hasRenderableParent(e){const o=this.findLoadedParent(e,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(e,o){return this._tiles[e]&&this._tiles[e].hasData()&&!this._coveredTiles[e]&&(o||!this._tiles[e].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const e in this._tiles)"errored"!==this._tiles[e].state&&this._reloadTile(+e,"reloading")}}_reloadTile(e,o){const c=this._tiles[e];c&&("loading"!==c.state&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,e,o)))}_tileLoaded(e,o,c,f){if(f)if(e.state="errored",404!==f.status)this._source.fire(new Et(f,{tile:e}));else if("raster-dem"===this._source.type&&this.usedForTerrain&&this.map.painter.terrain){const _=this.map.painter.terrain;this.update(this.transform,_.getScaledDemTileSize(),!0),_.resetTileLookupCache(this.id)}else this.update(this.transform);else e.timeAdded=Yr.now(),"expired"===c&&(e.refreshedUponExpiration=!0),this._setTileReloadTimer(o,e),"raster-dem"===this._source.type&&e.dem&&this._backfillDEM(e),this._state.initializeTileState(e,this.map?this.map.painter:null),this._source.fire(new Tt("data",{dataType:"source",tile:e,coord:e.tileID,sourceCacheId:this.id}))}_backfillDEM(e){const o=this.getRenderableIds();for(let f=0;f<o.length;f++){const _=o[f];if(e.neighboringTiles&&e.neighboringTiles[_]){const v=this.getTileByID(_);c(e,v),c(v,e)}}function c(f,_){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let v=_.tileID.canonical.x-f.tileID.canonical.x;const w=_.tileID.canonical.y-f.tileID.canonical.y,E=Math.pow(2,f.tileID.canonical.z),M=_.tileID.key;0===v&&0===w||Math.abs(w)>1||(Math.abs(v)>1&&(1===Math.abs(v+E)?v+=E:1===Math.abs(v-E)&&(v-=E)),_.dem&&f.dem&&(f.dem.backfillBorder(_.dem,v,w),f.neighboringTiles&&f.neighboringTiles[M]&&(f.neighboringTiles[M].backfilled=!0)))}}getTile(e){return this.getTileByID(e.key)}getTileByID(e){return this._tiles[e]}_retainLoadedChildren(e,o,c,f){for(const _ in this._tiles){let v=this._tiles[_];if(f[_]||!v.hasData()||v.tileID.overscaledZ<=o||v.tileID.overscaledZ>c)continue;let w=v.tileID;for(;v&&v.tileID.overscaledZ>o+1;){const M=v.tileID.scaledTo(v.tileID.overscaledZ-1);v=this._tiles[M.key],v&&v.hasData()&&(w=M)}let E=w;for(;E.overscaledZ>o;)if(E=E.scaledTo(E.overscaledZ-1),e[E.key]){f[w.key]=w;break}}}findLoadedParent(e,o){if(e.key in this._loadedParentTiles){const c=this._loadedParentTiles[e.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=e.overscaledZ-1;c>=o;c--){const f=e.scaledTo(c),_=this._getLoadedTile(f);if(_)return _}}_getLoadedTile(e){const o=this._tiles[e.key];return o&&o.hasData()?o:this._cache.getByKey(this._source.reparseOverscaled?e.wrapped().key:e.canonical.key)}updateCacheSize(e,o){o=o||this._source.tileSize;const c=Math.ceil(e.width/o)+1,f=Math.ceil(e.height/o)+1,_=Math.floor(c*f*5),v="number"==typeof this._minTileCacheSize?Math.max(this._minTileCacheSize,_):_,w="number"==typeof this._maxTileCacheSize?Math.min(this._maxTileCacheSize,v):v;this._cache.setMaxSize(w)}handleWrapJump(e){const o=Math.round((e-(void 0===this._prevLng?e:this._prevLng))/360);if(this._prevLng=e,o){const c={};for(const f in this._tiles){const _=this._tiles[f];_.tileID=_.tileID.unwrapTo(_.tileID.wrap+o),c[_.tileID.key]=_}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(e,o,c){if(this.transform=e,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let f;this.updateCacheSize(e,o),"globe"!==this.transform.projection.name&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=e.getVisibleUnwrappedCoordinates(this._source.tileID).map(w=>new Js(w.canonical.z,w.wrap,w.canonical.z,w.canonical.x,w.canonical.y)):(f=e.coveringTiles({tileSize:o||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter(w=>this._source.hasTile(w)))):f=[];const _=this._updateRetainedTiles(f);if(p_(this._source.type)&&0!==f.length){const w={},E={},M=Object.keys(_);for(const N of M){const j=_[N],W=this._tiles[N];if(!W||W.fadeEndTime&&W.fadeEndTime<=Yr.now())continue;const J=this.findLoadedParent(j,Math.max(j.overscaledZ-bu.maxOverzooming,this._source.minzoom));J&&(this._addTile(J.tileID),w[J.tileID.key]=J.tileID),E[N]=j}const L=f[f.length-1].overscaledZ;for(const N in this._tiles){const j=this._tiles[N];if(_[N]||!j.hasData())continue;let W=j.tileID;for(;W.overscaledZ>L;){W=W.scaledTo(W.overscaledZ-1);const J=this._tiles[W.key];if(J&&J.hasData()&&E[W.key]){_[N]=j.tileID;break}}}for(const N in w)_[N]||(this._coveredTiles[N]=!0,_[N]=w[N])}for(const w in _)this._tiles[w].clearFadeHold();const v=function(w,E){const M=[];for(const L in w)L in E||M.push(L);return M}(this._tiles,_);for(const w of v){const E=this._tiles[w];E.hasSymbolBuckets&&!E.holdingForFade()?E.setHoldDuration(this.map._fadeDuration):E.hasSymbolBuckets&&!E.symbolFadeFinished()||this._removeTile(+w)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const e in this._tiles)this._tiles[e].holdingForFade()&&this._removeTile(+e)}_updateRetainedTiles(e){const o={};if(0===e.length)return o;const c={},f=e.reduce((M,L)=>Math.min(M,L.overscaledZ),1/0),_=e[0].overscaledZ,v=Math.max(_-bu.maxOverzooming,this._source.minzoom),w=Math.max(_+bu.maxUnderzooming,this._source.minzoom),E={};for(const M of e){const L=this._addTile(M);o[M.key]=M,L.hasData()||f<this._source.maxzoom&&(E[M.key]=M)}this._retainLoadedChildren(E,f,w,o);for(const M of e){let L=this._tiles[M.key];if(L.hasData())continue;if(M.canonical.z>=this._source.maxzoom){const j=M.children(this._source.maxzoom)[0],W=this.getTile(j);if(W&&W.hasData()){o[j.key]=j;continue}}else{const j=M.children(this._source.maxzoom);if(o[j[0].key]&&o[j[1].key]&&o[j[2].key]&&o[j[3].key])continue}let N=L.wasRequested();for(let j=M.overscaledZ-1;j>=v;--j){const W=M.scaledTo(j);if(c[W.key]||(c[W.key]=!0,L=this.getTile(W),!L&&N&&(L=this._addTile(W)),L&&(o[W.key]=W,N=L.wasRequested(),L.hasData())))break}}return o}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const e in this._tiles){const o=[];let c,f=this._tiles[e].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}o.push(f.key);const _=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(_),c)break;f=_}for(const _ of o)this._loadedParentTiles[_]=c}}_addTile(e){let o=this._tiles[e.key];if(o)return o;o=this._cache.getAndRemove(e),o&&(this._setTileReloadTimer(e.key,o),o.tileID=e,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[e.key]&&(clearTimeout(this._cacheTimers[e.key]),delete this._cacheTimers[e.key],this._setTileReloadTimer(e.key,o)));const c=!!o;if(!c){const f=this.map?this.map.painter:null;o=new sr(e,this._source.tileSize*e.overscaleFactor(),this.transform.tileZoom,f,this._isRaster),this._loadTile(o,this._tileLoaded.bind(this,o,e.key,o.state))}return o?(o.uses++,this._tiles[e.key]=o,c||this._source.fire(new Tt("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o):null}_setTileReloadTimer(e,o){e in this._timers&&(clearTimeout(this._timers[e]),delete this._timers[e]);const c=o.getExpiryTimeout();c&&(this._timers[e]=setTimeout(()=>{this._reloadTile(e,"expired"),delete this._timers[e]},c))}_removeTile(e){const o=this._tiles[e];o&&(o.uses--,delete this._tiles[e],this._timers[e]&&(clearTimeout(this._timers[e]),delete this._timers[e]),o.uses>0||(o.hasData()&&"reloading"!==o.state?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const e in this._tiles)this._removeTile(+e);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(e,o,c){const f=[],_=this.transform;if(!_)return f;const v="globe"===_.projection.name,w=Os(_.center.lng);for(const E in this._tiles){const M=this._tiles[E];if(c&&M.clearQueryDebugViz(),M.holdingForFade())continue;let L;if(v){const N=M.tileID.canonical;if(0===N.z){const j=[Math.abs(Ke(w,...vd(N,-1))-w),Math.abs(Ke(w,...vd(N,1))-w)];L=[0,2*j.indexOf(Math.min(...j))-1]}else{const j=[Math.abs(Ke(w,...vd(N,-1))-w),Math.abs(Ke(w,...vd(N,0))-w),Math.abs(Ke(w,...vd(N,1))-w)];L=[j.indexOf(Math.min(...j))-1]}}else L=[0];for(const N of L){const j=e.containsTile(M,_,o,N);j&&f.push(j)}}return f}getVisibleCoordinates(e){const o=this.getRenderableIds(e).map(c=>this._tiles[c].tileID);for(const c of o)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(p_(this._source.type))for(const e in this._tiles){const o=this._tiles[e];if(void 0!==o.fadeEndTime&&o.fadeEndTime>=Yr.now())return!0}return!1}setFeatureState(e,o,c){this._state.updateState(e=e||"_geojsonTileLayer",o,c)}removeFeatureState(e,o,c){this._state.removeFeatureState(e=e||"_geojsonTileLayer",o,c)}getFeatureState(e,o){return this._state.getState(e=e||"_geojsonTileLayer",o)}setDependencies(e,o,c){const f=this._tiles[e];f&&f.setDependencies(o,c)}reloadTilesForDependencies(e,o){for(const c in this._tiles)this._tiles[c].hasDependency(e,o)&&this._reloadTile(+c,"reloading");this._cache.filter(c=>!c.hasDependency(e,o))}_preloadTiles(e,o){if(!this._sourceLoaded){const w=()=>{this._sourceLoaded&&(this._source.off("data",w),this._preloadTiles(e,o))};return void this._source.on("data",w)}const c=new Map,f=Array.isArray(e)?e:[e],_=this.map.painter.terrain,v=this.usedForTerrain&&_?_.getScaledDemTileSize():this._source.tileSize;for(const w of f){const E=w.coveringTiles({tileSize:v,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const M of E)c.set(M.key,M);this.usedForTerrain&&w.updateElevation(!1)}_n(Array.from(c.values()),(w,E)=>{const M=new sr(w,this._source.tileSize*w.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(M,L=>{"raster-dem"===this._source.type&&M.dem&&this._backfillDEM(M),E(L,M)})},o)}}function f_(r,e){const o=Math.abs(2*r.wrap)-+(r.wrap<0),c=Math.abs(2*e.wrap)-+(e.wrap<0);return r.overscaledZ-e.overscaledZ||c-o||e.canonical.y-r.canonical.y||e.canonical.x-r.canonical.x}function p_(r){return"raster"===r||"image"===r||"video"===r||"custom"===r}function vd(r,e){const o=1<<r.z;return[r.x/o+e,(r.x+1)/o+e]}bu.maxOverzooming=10,bu.maxUnderzooming=3;class Th{constructor(e,o,c){this._demTile=e,this._dem=this._demTile.dem,this._scale=o,this._offset=c}static create(e,o,c){const f=c||e.findDEMTileFor(o);if(!f||!f.dem)return;const _=f.dem,v=f.tileID,w=1<<o.canonical.z-v.canonical.z;return new Th(f,f.tileSize/vi/w,[(o.canonical.x/w-v.canonical.x)*_.dim,(o.canonical.y/w-v.canonical.y)*_.dim])}tileCoordToPixel(e,o){const c=o*this._scale+this._offset[1],f=Math.floor(e*this._scale+this._offset[0]),_=Math.floor(c);return new ye(f,_)}getElevationAt(e,o,c,f){const _=e*this._scale+this._offset[0],v=o*this._scale+this._offset[1],w=Math.floor(_),E=Math.floor(v),M=this._dem;return f=!!f,c?Pi(Pi(M.get(w,E,f),M.get(w,E+1,f),v-E),Pi(M.get(w+1,E,f),M.get(w+1,E+1,f),v-E),_-w):M.get(w,E,f)}getElevationAtPixel(e,o,c){return this._dem.get(e,o,!!c)}getMeterToDEM(e){return(1<<this._demTile.tileID.canonical.z)*Xa(1,e)*this._dem.stride}}class m_{constructor(e,o){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new Sn(vi,16,0),this.featureIndexArray=new bc,this.promoteId=o}insert(e,o,c,f,_,v=0){const w=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,_,v);const E=this.grid;for(let M=0;M<o.length;M++){const L=o[M],N=[1/0,1/0,-1/0,-1/0];for(let j=0;j<L.length;j++){const W=L[j];N[0]=Math.min(N[0],W.x),N[1]=Math.min(N[1],W.y),N[2]=Math.max(N[2],W.x),N[3]=Math.max(N[3],W.y)}N[0]<vi&&N[1]<vi&&N[2]>=0&&N[3]>=0&&E.insert(w,N[0],N[1],N[2],N[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new cf(new sd(this.rawTileData)).layers,this.sourceLayerCoder=new l_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const e in this.vtLayers)this.vtFeatures[e]=[]}return this.vtLayers}query(e,o,c,f){this.loadVTLayers();const _=e.params||{},v=yc(_.filter),w=e.tileResult,E=e.transform,M=w.bufferedTilespaceBounds,L=this.grid.query(M.min.x,M.min.y,M.max.x,M.max.y,(J,se,Le,rt)=>Eg(w.bufferedTilespaceGeometry,J,se,Le,rt));L.sort(Fa);let N=null;E.elevation&&L.length>0&&(N=Th.create(E.elevation,this.tileID));const j={};let W;for(let J=0;J<L.length;J++){const se=L[J];if(se===W)continue;W=se;const Le=this.featureIndexArray.get(se);let rt=null;this.loadMatchingFeature(j,Le,v,_.layers,_.availableImages,o,c,f,(bt,at,xt,At=0)=>(rt||(rt=ac(bt,this.tileID.canonical,e.tileTransform)),at.queryIntersectsFeature(w,bt,xt,rt,this.z,e.transform,e.pixelPosMatrix,N,At)))}return j}loadMatchingFeature(e,o,c,f,_,v,w,E,M){const{featureIndex:L,bucketIndex:N,sourceLayerIndex:j,layoutVertexArrayOffset:W}=o,J=this.bucketLayerIDs[N];if(f&&!function(bt,at){for(let xt=0;xt<bt.length;xt++)if(at.indexOf(bt[xt])>=0)return!0;return!1}(f,J))return;const se=this.sourceLayerCoder.decode(j),Le=this.vtLayers[se].feature(L);if(c.needGeometry){const bt=ou(Le,!0);if(!c.filter(new R(this.tileID.overscaledZ),bt,this.tileID.canonical))return}else if(!c.filter(new R(this.tileID.overscaledZ),Le))return;const rt=this.getId(Le,se);for(let bt=0;bt<J.length;bt++){const at=J[bt];if(f&&f.indexOf(at)<0)continue;const xt=v[at];if(!xt)continue;let At={};void 0!==rt&&E&&(At=E.getState(xt.sourceLayer||"_geojsonTileLayer",rt));const Mt=We({},w[at]);Mt.paint=g_(Mt.paint,xt.paint,Le,At,_),Mt.layout=g_(Mt.layout,xt.layout,Le,At,_);const un=!M||M(Le,xt,At,W);if(!un)continue;const rn=new c_(Le,this.z,this.x,this.y,rt);rn.layer=Mt;let Dn=e[at];void 0===Dn&&(Dn=e[at]=[]),Dn.push({featureIndex:L,feature:rn,intersectionZ:un})}}lookupSymbolFeatures(e,o,c,f,_,v,w,E){const M={};this.loadVTLayers();const L=yc(_);for(const N of e)this.loadMatchingFeature(M,{bucketIndex:c,sourceLayerIndex:f,featureIndex:N,layoutVertexArrayOffset:0},L,v,w,E,o);return M}loadFeature(e){const{featureIndex:o,sourceLayerIndex:c}=e;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),_=this.vtFeatures[f];if(_[o])return _[o];const v=this.vtLayers[f].feature(o);return _[o]=v,v}hasLayer(e){for(const o of this.bucketLayerIDs)for(const c of o)if(e===c)return!0;return!1}getId(e,o){let c=e.id;if(this.promoteId){const f="string"==typeof this.promoteId?this.promoteId:this.promoteId[o];null!=f&&(c=e.properties[f]),"boolean"==typeof c&&(c=Number(c))}return c}}function g_(r,e,o,c,f){return pt(r,(_,v)=>{const w=e instanceof et?e.get(v):null;return w&&w.evaluate?w.evaluate(o,c,f):w})}function Fa(r,e){return e-r}hi(m_,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class __{constructor(e,o){this.width=e,this.height=o,this.nextRow=0,this.image=new Qa({width:e,height:o}),this.positions={},this.uploaded=!1}getDash(e,o){const c=this.getKey(e,o);return this.positions[c]}trim(){const e=this.width,o=this.height=Qt(this.nextRow);this.image.resize({width:e,height:o})}getKey(e,o){return e.join(",")+o}getDashRanges(e,o,c){const f=[];let _=e.length%2==1?-e[e.length-1]*c:0,v=e[0]*c,w=!0;f.push({left:_,right:v,isDash:w,zeroLength:0===e[0]});let E=e[0];for(let M=1;M<e.length;M++){w=!w;const L=e[M];_=E*c,E+=L,v=E*c,f.push({left:_,right:v,isDash:w,zeroLength:0===L})}return f}addRoundDash(e,o,c){const f=o/2;for(let _=-c;_<=c;_++){const v=this.width*(this.nextRow+c+_);let w=0,E=e[w];for(let M=0;M<this.width;M++){M/E.right>1&&(E=e[++w]);const L=Math.abs(M-E.left),N=Math.abs(M-E.right),j=Math.min(L,N);let W;const J=_/c*(f+1);if(E.isDash){const se=f-Math.abs(J);W=Math.sqrt(j*j+se*se)}else W=f-Math.sqrt(j*j+J*J);this.image.data[v+M]=Math.max(0,Math.min(255,W+128))}}}addRegularDash(e,o){for(let E=e.length-1;E>=0;--E){const M=e[E],L=e[E+1];M.zeroLength?e.splice(E,1):L&&L.isDash===M.isDash&&(L.left=M.left,e.splice(E,1))}const c=e[0],f=e[e.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const _=this.width*this.nextRow;let v=0,w=e[v];for(let E=0;E<this.width;E++){E/w.right>1&&(w=e[++v]);const M=Math.abs(E-w.left),L=Math.abs(E-w.right),N=Math.min(M,L);this.image.data[_+E]=Math.max(0,Math.min(255,(w.isDash?N:-N)+o+128))}}addDash(e,o){const c=this.getKey(e,o);if(this.positions[c])return this.positions[c];const f="round"===o,_=f?7:0,v=2*_+1;if(this.nextRow+v>this.height)return It("LineAtlas out of space"),null;0===e.length&&e.push(1);let w=0;for(let L=0;L<e.length;L++)e[L]<0&&(It("Negative value is found in line dasharray, replacing values with 0"),e[L]=0),w+=e[L];if(0!==w){const L=this.width/w,N=this.getDashRanges(e,this.width,L);f?this.addRoundDash(N,L,_):this.addRegularDash(N,"square"===o?.5*L:0)}const E=this.nextRow+_;this.nextRow+=v;const M={tl:[E,_],br:[w,0]};return this.positions[c]=M,M}}hi(__,"LineAtlas");const y_=1*ka;class bv{constructor(e){const o={},c=[];for(const w in e){const E=e[w],M=o[w]={};for(const L in E.glyphs){const N=E.glyphs[+L];if(!N||0===N.bitmap.width||0===N.bitmap.height)continue;const j=N.metrics.localGlyph?y_:1,W={x:0,y:0,w:N.bitmap.width+2*j,h:N.bitmap.height+2*j};c.push(W),M[L]=W}}const{w:f,h:_}=xf(c),v=new Qa({width:f||1,height:_||1});for(const w in e){const E=e[w];for(const M in E.glyphs){const L=E.glyphs[+M];if(!L||0===L.bitmap.width||0===L.bitmap.height)continue;const N=o[w][M],j=L.metrics.localGlyph?y_:1;Qa.copy(L.bitmap,v,{x:0,y:0},{x:N.x+j,y:N.y+j},L.bitmap)}}this.image=v,this.positions=o}}hi(bv,"GlyphAtlas");class Tm{constructor(e){this.tileID=new Js(e.tileID.overscaledZ,e.tileID.wrap,e.tileID.canonical.z,e.tileID.canonical.x,e.tileID.canonical.y),this.tileZoom=e.tileZoom,this.uid=e.uid,this.zoom=e.zoom,this.canonical=e.tileID.canonical,this.pixelRatio=e.pixelRatio,this.tileSize=e.tileSize,this.source=e.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=e.showCollisionBoxes,this.collectResourceTiming=!!e.collectResourceTiming,this.returnDependencies=!!e.returnDependencies,this.promoteId=e.promoteId,this.enableTerrain=!!e.enableTerrain,this.isSymbolTile=e.isSymbolTile,this.tileTransform=md(e.tileID.canonical,e.projection),this.projection=e.projection}parse(e,o,c,f,_){this.status="parsing",this.data=e,this.collisionBoxArray=new yr;const v=new l_(Object.keys(e.layers).sort()),w=new m_(this.tileID,this.promoteId);w.bucketLayerIDs=[];const E={},M=new __(256,256),L={featureIndex:w,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:M,availableImages:c},N=o.familiesBySource[this.source];for(const At in N){const Mt=e.layers[At];if(!Mt)continue;let un=!1,rn=!1;for(const mn of N[At])"symbol"===mn[0].type?un=!0:rn=!0;if(!0===this.isSymbolTile&&!un||!1===this.isSymbolTile&&!rn)continue;1===Mt.version&&It(`Vector tile source "${this.source}" layer "${At}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Dn=v.encode(At),Yn=[];for(let mn=0;mn<Mt.length;mn++){const Pn=Mt.feature(mn),Rn=w.getId(Pn,At);Yn.push({feature:Pn,id:Rn,index:mn,sourceLayerIndex:Dn})}for(const mn of N[At]){const Pn=mn[0];void 0!==this.isSymbolTile&&"symbol"===Pn.type!==this.isSymbolTile||Pn.minzoom&&this.zoom<Math.floor(Pn.minzoom)||Pn.maxzoom&&this.zoom>=Pn.maxzoom||"none"!==Pn.visibility&&(kf(mn,this.zoom,c),(E[Pn.id]=Pn.createBucket({index:w.bucketLayerIDs.length,layers:mn,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Dn,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(Yn,L,this.tileID.canonical,this.tileTransform),w.bucketLayerIDs.push(mn.map(Rn=>Rn.id)))}}let j,W,J,se;M.trim();const Le={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},rt=()=>{if(j)return _(j);if(W&&J&&se){const At=new bv(W),Mt=new Gg(J,se);for(const un in E){const rn=E[un];rn instanceof zc?(kf(rn.layers,this.zoom,c),cv(rn,W,At.positions,J,Mt.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):rn.hasPattern&&(rn instanceof od||rn instanceof lu||rn instanceof td)&&(kf(rn.layers,this.zoom,c),rn.addFeatures(L,this.tileID.canonical,Mt.patternPositions,c,this.tileTransform))}this.status="done",_(null,{buckets:Ut(E).filter(un=>!un.isEmpty()),featureIndex:w,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:At.image,lineAtlas:M,imageAtlas:Mt,glyphMap:this.returnDependencies?W:null,iconMap:this.returnDependencies?J:null,glyphPositions:this.returnDependencies?At.positions:null})}},bt=pt(L.glyphDependencies,At=>Object.keys(At).map(Number));Object.keys(bt).length?f.send("getGlyphs",{uid:this.uid,stacks:bt},(At,Mt)=>{j||(j=At,W=Mt,rt())},void 0,!1,Le):W={};const at=Object.keys(L.iconDependencies);at.length?f.send("getImages",{icons:at,source:this.source,tileID:this.tileID,type:"icons"},(At,Mt)=>{j||(j=At,J=Mt,rt())},void 0,!1,Le):J={};const xt=Object.keys(L.patternDependencies);xt.length?f.send("getImages",{icons:xt,source:this.source,tileID:this.tileID,type:"patterns"},(At,Mt)=>{j||(j=At,se=Mt,rt())},void 0,!1,Le):se={},rt()}}function kf(r,e,o){const c=new R(e);for(const f of r)f.recalculate(c,o)}class v_{constructor(e){this.entries={},this.scheduler=e}request(e,o,c,f){const _=this.entries[e]=this.entries[e]||{callbacks:[]};if(_.result){const[v,w]=_.result;return this.scheduler?this.scheduler.add(()=>{f(v,w)},o):f(v,w),()=>{}}return _.callbacks.push(f),_.cancel||(_.cancel=c((v,w)=>{_.result=[v,w];for(const E of _.callbacks)this.scheduler?this.scheduler.add(()=>{E(v,w)},o):E(v,w);setTimeout(()=>delete this.entries[e],3e3)})),()=>{_.result||(_.callbacks=_.callbacks.filter(v=>v!==f),_.callbacks.length||(_.cancel(),delete this.entries[e]))}}}function x_(r,e,o){const c=JSON.stringify(r.request);return r.data&&(this.deduped.entries[c]={result:[null,r.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom},f=>{const _=Jt(r.request,(v,w,E,M)=>{v?f(v):w&&f(null,{vectorTile:o?void 0:new cf(new sd(w)),rawData:w,cacheControl:E,expires:M})});return()=>{_.cancel(),f()}},e)}const b_=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Ff{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[o,c]=new Uint8Array(e,0,2);if(219!==o)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(1!==f)throw new Error(`Got v${f} data when expected v1.`);const _=b_[15&c];if(!_)throw new Error("Unrecognized array type.");const[v]=new Uint16Array(e,2,1),[w]=new Uint32Array(e,4,1);return new Ff(w,v,_,e)}constructor(e,o=64,c=Float64Array,f){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+o,2),65535),this.ArrayType=c,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const _=b_.indexOf(this.ArrayType),v=2*e*this.ArrayType.BYTES_PER_ELEMENT,w=e*this.IndexArrayType.BYTES_PER_ELEMENT,E=(8-w%8)%8;if(_<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+E,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+v+w+E),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+w+E,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+_]),new Uint16Array(this.data,2,1)[0]=o,new Uint32Array(this.data,4,1)[0]=e)}add(e,o){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=e,this.coords[this._pos++]=o,c}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Dm(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,o,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:_,coords:v,nodeSize:w}=this,E=[0,_.length-1,0],M=[];for(;E.length;){const L=E.pop()||0,N=E.pop()||0,j=E.pop()||0;if(N-j<=w){for(let Le=j;Le<=N;Le++){const rt=v[2*Le],bt=v[2*Le+1];rt>=e&&rt<=c&&bt>=o&&bt<=f&&M.push(_[Le])}continue}const W=j+N>>1,J=v[2*W],se=v[2*W+1];J>=e&&J<=c&&se>=o&&se<=f&&M.push(_[W]),(0===L?e<=J:o<=se)&&(E.push(j),E.push(W-1),E.push(1-L)),(0===L?c>=J:f>=se)&&(E.push(W+1),E.push(N),E.push(1-L))}return M}within(e,o,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:_,nodeSize:v}=this,w=[0,f.length-1,0],E=[],M=c*c;for(;w.length;){const L=w.pop()||0,N=w.pop()||0,j=w.pop()||0;if(N-j<=v){for(let Le=j;Le<=N;Le++)C_(_[2*Le],_[2*Le+1],e,o)<=M&&E.push(f[Le]);continue}const W=j+N>>1,J=_[2*W],se=_[2*W+1];C_(J,se,e,o)<=M&&E.push(f[W]),(0===L?e-c<=J:o-c<=se)&&(w.push(j),w.push(W-1),w.push(1-L)),(0===L?e+c>=J:o+c>=se)&&(w.push(W+1),w.push(N),w.push(1-L))}return E}}function Dm(r,e,o,c,f,_){if(f-c<=o)return;const v=c+f>>1;w_(r,e,v,c,f,_),Dm(r,e,o,c,v-1,1-_),Dm(r,e,o,v+1,f,1-_)}function w_(r,e,o,c,f,_){for(;f>c;){if(f-c>600){const M=f-c+1,L=o-c+1,N=Math.log(M),j=.5*Math.exp(2*N/3),W=.5*Math.sqrt(N*j*(M-j)/M)*(L-M/2<0?-1:1);w_(r,e,o,Math.max(c,Math.floor(o-L*j/M+W)),Math.min(f,Math.floor(o+(M-L)*j/M+W)),_)}const v=e[2*o+_];let w=c,E=f;for(wu(r,e,c,o),e[2*f+_]>v&&wu(r,e,c,f);w<E;){for(wu(r,e,w,E),w++,E--;e[2*w+_]<v;)w++;for(;e[2*E+_]>v;)E--}e[2*c+_]===v?wu(r,e,c,E):(E++,wu(r,e,E,f)),E<=o&&(c=E+1),o<=E&&(f=E-1)}}function wu(r,e,o,c){Im(r,o,c),Im(e,2*o,2*c),Im(e,2*o+1,2*c+1)}function Im(r,e,o){const c=r[e];r[e]=r[o],r[o]=c}function C_(r,e,o,c){const f=r-o,_=e-c;return f*f+_*_}l.ARRAY_TYPE=As,l.AUTH_ERR_MSG=yt,l.Aabb=ss,l.Actor=class{constructor(r,e,o){this.target=r,this.parent=e,this.mapId=o,this.callbacks={},this.cancelCallbacks={},an(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=Zt()?r:B,this.scheduler=new a_}send(r,e,o,c,f=!1,_){const v=Math.round(1e18*Math.random()).toString(36).substring(0,10);o&&(o.metadata=_,this.callbacks[v]=o);const w=Ft(this.globalScope)?void 0:[];return this.target.postMessage({id:v,type:r,hasCallback:!!o,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:dl(e,w)},w),{cancel:()=>{o&&delete this.callbacks[v],this.target.postMessage({id:v,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(r){const e=r.data,o=e.id;if(o&&(!e.targetMapId||this.mapId===e.targetMapId))if("<cancel>"===e.type){const c=this.cancelCallbacks[o];delete this.cancelCallbacks[o],c&&c.cancel()}else if(e.mustQueue||Zt()){const c=this.callbacks[o];this.cancelCallbacks[o]=this.scheduler.add(()=>this.processTask(o,e),c&&c.metadata||{type:"message"})}else this.processTask(o,e)}processTask(r,e){if("<response>"===e.type){const o=this.callbacks[r];delete this.callbacks[r],o&&(e.error?o(ra(e.error)):o(null,ra(e.data)))}else{const o=Ft(this.globalScope)?void 0:[],c=e.hasCallback?(_,v)=>{delete this.cancelCallbacks[r],this.target.postMessage({id:r,type:"<response>",sourceMapId:this.mapId,error:_?dl(_):null,data:dl(v,o)},o)}:_=>{},f=ra(e.data);if(this.parent[e.type])this.parent[e.type](e.sourceMapId,f,c);else if(this.parent.getWorkerSource){const _=e.type.split(".");this.parent.getWorkerSource(e.sourceMapId,_[0],f.source)[_[1]](f,c)}else c(new Error(`Could not find function ${e.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},l.CanonicalTileID=eh,l.Color=O,l.ColorMode=Ul,l.CullFaceMode=vl,l.DEMData=yd,l.DataConstantProperty=ne,l.DedupedRequest=v_,l.DepthMode=xu,l.EXTENT=vi,l.Elevation=class{isDataAvailableAtPoint(r){const e=this._source();if(this.isUsingMockSource()||!e||r.y<0||r.y>1)return!1;const o=e.getSource().maxzoom,c=1<<o,f=Math.floor(r.x),_=Math.floor((r.x-f)*c),v=Math.floor(r.y*c),w=this.findDEMTileFor(new Js(o,f,o,_,v));return!(!w||!w.dem)}getAtPointOrZero(r,e=0){return this.getAtPoint(r,e)||0}getAtPoint(r,e,o=!0){if(this.isUsingMockSource())return null;null==e&&(e=null);const c=this._source();if(!c||r.y<0||r.y>1)return e;const f=c.getSource().maxzoom,_=1<<f,v=Math.floor(r.x),w=r.x-v,E=new Js(f,v,f,Math.floor(w*_),Math.floor(r.y*_)),M=this.findDEMTileFor(E);if(!M||!M.dem)return e;const L=M.dem,N=1<<M.tileID.canonical.z,j=(w*N-M.tileID.canonical.x)*L.dim,W=(r.y*N-M.tileID.canonical.y)*L.dim,J=Math.floor(j),se=Math.floor(W);return(o?this.exaggeration():1)*Pi(Pi(L.get(J,se),L.get(J,se+1),W-se),Pi(L.get(J+1,se),L.get(J+1,se+1),W-se),j-J)}getAtTileOffset(r,e,o){const c=1<<r.canonical.z;return this.getAtPointOrZero(new Oa(r.wrap+(r.canonical.x+e/vi)/c,(r.canonical.y+o/vi)/c))}getAtTileOffsetFunc(r,e,o,c){return f=>{const _=this.getAtTileOffset(r,f.x,f.y),v=c.upVector(r.canonical,f.x,f.y);return qs(v,v,_*c.upVectorScale(r.canonical,e,o).metersToTile),v}}getForTilePoints(r,e,o,c){if(this.isUsingMockSource())return!1;const f=Th.create(this,r,c);return!!f&&(e.forEach(_=>{_[2]=this.exaggeration()*f.getElevationAt(_[0],_[1],o)}),!0)}getMinMaxForTile(r){if(this.isUsingMockSource())return null;const e=this.findDEMTileFor(r);if(!e||!e.dem)return null;const o=e.dem.tree,c=e.tileID,f=1<<r.canonical.z-c.canonical.z;let _=r.canonical.x/f-c.canonical.x,v=r.canonical.y/f-c.canonical.y,w=0;for(let E=0;E<r.canonical.z-c.canonical.z&&!o.leaves[w];E++){_*=2,v*=2;const M=2*Math.floor(v)+Math.floor(_);w=o.childOffsets[w]+M,_%=1,v%=1}return{min:this.exaggeration()*o.minimums[w],max:this.exaggeration()*o.maximums[w]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(r,e,o){throw new Error("Pure virtual method called.")}pointCoordinate(r){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(r){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},l.ErrorEvent=Et,l.EvaluationParameters=R,l.Event=Tt,l.Evented=ln,l.FillExtrusionBucket=td,l.Frustum=Vh,l.FrustumCorners=jh,l.GLOBE_RADIUS=Rl,l.GLOBE_SCALE_MATCH_LATITUDE=45,l.GLOBE_ZOOM_THRESHOLD_MAX=$h,l.GLOBE_ZOOM_THRESHOLD_MIN=mg,l.GlobeSharedBuffers=class{constructor(r){this._createGrid(r),this._createPoles(r)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const r of this._poleSegments)r.destroy();for(const r of this._gridSegments)r.withSkirts.destroy(),r.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const r of this._wireframeSegments)r.destroy()}}_fillGridMeshWithLods(r,e){const o=new Wn,c=new Ci,f=[],_=r+1+2,v=e[0]+1,w=e[0]+1+(1+e.length),E=(M,L,N)=>{let j=M===_-1?M-2:0===M?M:M-1;return j+=N?24575:0,[j,L]};for(let M=0;M<_;++M)o.emplaceBack(...E(M,0,!0));for(let M=0;M<v;++M)for(let L=0;L<_;++L)o.emplaceBack(...E(L,M,(0===L||L===_-1)&&!0));for(let M=0;M<e.length;++M){const L=e[M];for(let N=0;N<_;++N)o.emplaceBack(...E(N,L,!0))}for(let M=0;M<e.length;++M){const L=c.length,N=e[M]+1+2,j=new Ci;for(let se=0;se<N-1;se++){const Le=se===N-2,rt=Le?_*(w-e.length+M-se):_;for(let bt=0;bt<_-1;bt++){const at=se*_+bt;0===se||Le||0===bt||bt===_-2?(j.emplaceBack(at+1,at,at+rt),j.emplaceBack(at+rt,at+rt+1,at+1)):(c.emplaceBack(at+1,at,at+rt),c.emplaceBack(at+rt,at+rt+1,at+1))}}const W=So.simpleSegment(0,L,o.length,c.length-L);for(let se=0;se<j.uint16.length;se+=3)c.emplaceBack(j.uint16[se],j.uint16[se+1],j.uint16[se+2]);const J=So.simpleSegment(0,L,o.length,c.length-L);f.push({withoutSkirts:W,withSkirts:J})}return{vertices:o,indices:c,segments:f}}_createGrid(r){const e=this._fillGridMeshWithLods(64,Gu);this._gridSegments=e.segments,this._gridBuffer=r.createVertexBuffer(e.vertices,Dc.members),this._gridIndexBuffer=r.createIndexBuffer(e.indices,!0)}_createPoles(r){const e=new Ci;for(let f=0;f<=64;f++)e.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=r.createIndexBuffer(e,!0);const o=new Br,c=new Br;this._poleSegments=[];for(let f=0,_=0;f<mg;f++){const v=360/(1<<f);o.emplaceBack(0,-Rl,0,.5,0),c.emplaceBack(0,-Rl,0,.5,1);for(let w=0;w<=64;w++){const E=w/64,M=Pi(0,v,E),[L,N,j]=Wu(yy,vy,M,Rl);o.emplaceBack(L,N,j,E,0),c.emplaceBack(L,N,j,E,1)}this._poleSegments.push(So.simpleSegment(_,0,66,64)),_+=66}this._poleNorthVertexBuffer=r.createVertexBuffer(o,Uh,!1),this._poleSouthVertexBuffer=r.createVertexBuffer(c,Uh,!1)}getGridBuffers(r,e){return[this._gridBuffer,this._gridIndexBuffer,e?this._gridSegments[r].withSkirts:this._gridSegments[r].withoutSkirts]}getPoleBuffers(r){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[r]]}getWirefameBuffers(r,e){if(!this._wireframeSegments){const o=new is,c=64,f=c+1+2,_=1;this._wireframeSegments=[];for(let v=0,w=0;v<Gu.length;v++){const E=Gu[v];for(let L=_;L<E+_;L++)for(let N=_;N<c+_;N++){const j=L*f+N;o.emplaceBack(j,j+1),o.emplaceBack(j,j+f),o.emplaceBack(j,j+f+1)}const M=E*c*3;this._wireframeSegments.push(So.simpleSegment(0,w,(E+1)*f,M)),w+=M}this._wireframeIndexBuffer=r.createIndexBuffer(o)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[e]]}},l.GlyphManager=dd,l.ImagePosition=tm,l.KDBush=Ff,l.LivePerformanceUtils=_o,l.LngLat=pr,l.LngLatBounds=Sa,l.LocalGlyphMode=If,l.MAX_MERCATOR_LATITUDE=Ho,l.MercatorCoordinate=Oa,l.ONE_EM=cs,l.OverscaledTileID=Js,l.PerformanceMarkers=uo,l.Point=ye,l.Properties=gt,l.RGBAImage=Ls,l.Ray=_p,l.RequestManager=class{constructor(r,e,o){this._transformRequestFn=r,this._customAccessToken=e,this._silenceAuthErrors=!!o,this._createSkuToken()}_createSkuToken(){const r=function(){let e="";for(let o=0;o<10;o++)e+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",de,e].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=r.token,this._skuTokenExpiresAt=r.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(r,e){return this._transformRequestFn&&this._transformRequestFn(r,e)||{url:r}}normalizeStyleURL(r,e){if(!Dt(r))return r;const o=Gn(r);return o.path=`/styles/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeGlyphsURL(r,e){if(!Dt(r))return r;const o=Gn(r);return o.path=`/fonts/v1${o.path}`,this._makeAPIURL(o,this._customAccessToken||e)}normalizeSourceURL(r,e,o,c){if(!Dt(r))return r;const f=Gn(r);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),o&&f.params.push(`language=${o}`),c&&f.params.push(`worldview=${c}`),this._makeAPIURL(f,this._customAccessToken||e)}normalizeSpriteURL(r,e,o,c){const f=Gn(r);return Dt(r)?(f.path=`/styles/v1${f.path}/sprite${e}${o}`,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=`${e}${o}`,ae(f))}normalizeTileURL(r,e,o){if(this._isSkuTokenExpired()&&this._createSkuToken(),r&&!Dt(r))return r;const c=Gn(r);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${e||o&&"raster"!==c.authority&&512===o?"@2x":""}${fe.supported?".webp":"$1"}`),"raster"===c.authority?c.path=`/${ie.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${ie.TILE_URL_VERSION}${c.path}`);const f=this._customAccessToken||function(_){for(const v of _){const w=v.match(/^access_token=(.*)$/);if(w)return w[1]}return null}(c.params)||ie.ACCESS_TOKEN;return ie.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,f)}canonicalizeTileURL(r,e){const o=Gn(r);if(!o.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!o.path.match(/\.[\w]+$/))return r;let c="mapbox://";o.path.match(/^\/raster\/v1\//)?c+=`raster/${o.path.replace(`/${ie.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${o.path.replace(`/${ie.TILE_URL_VERSION}/`,"")}`;let f=o.params;return e&&(f=f.filter(_=>!_.match(/^access_token=/))),f.length&&(c+=`?${f.join("&")}`),c}canonicalizeTileset(r,e){const o=!!e&&Dt(e),c=[];for(const f of r.tiles||[])jt(f)?c.push(this.canonicalizeTileURL(f,o)):c.push(f);return c}_makeAPIURL(r,e){const o="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Gn(ie.API_URL);if(r.protocol=c.protocol,r.authority=c.authority,"http"===r.protocol){const f=r.params.indexOf("secure");f>=0&&r.params.splice(f,1)}if("/"!==c.path&&(r.path=`${c.path}${r.path}`),!ie.REQUIRE_ACCESS_TOKEN)return ae(r);if(e=e||ie.ACCESS_TOKEN,!this._silenceAuthErrors){if(!e)throw new Error(`An API access token is required to use Mapbox GL. ${o}`);if("s"===e[0])throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${o}`)}return r.params=r.params.filter(f=>-1===f.indexOf("access_token")),r.params.push(`access_token=${e||""}`),ae(r)}},l.ResourceType=fn,l.SegmentVector=So,l.SourceCache=bu,l.StencilMode=Cm,l.StructArrayLayout1ui2=sa,l.StructArrayLayout2f1f2i16=Oi,l.StructArrayLayout2i4=Wn,l.StructArrayLayout2ui4=is,l.StructArrayLayout3f12=lr,l.StructArrayLayout3ui6=Ci,l.StructArrayLayout4i8=Mn,l.StructArrayLayout5f20=Br,l.Texture=Uc,l.Tile=sr,l.Transitionable=Q,l.Uniform1f=kh,l.Uniform1i=class extends pl{constructor(r){super(r),this.current=0}set(r,e,o){this.fetchUniformLocation(r,e)&&this.current!==o&&(this.current=o,this.gl.uniform1i(this.location,o))}},l.Uniform2f=class extends pl{constructor(r){super(r),this.current=[0,0]}set(r,e,o){this.fetchUniformLocation(r,e)&&(o[0]===this.current[0]&&o[1]===this.current[1]||(this.current=o,this.gl.uniform2f(this.location,o[0],o[1])))}},l.Uniform3f=class extends pl{constructor(r){super(r),this.current=[0,0,0]}set(r,e,o){this.fetchUniformLocation(r,e)&&(o[0]===this.current[0]&&o[1]===this.current[1]&&o[2]===this.current[2]||(this.current=o,this.gl.uniform3f(this.location,o[0],o[1],o[2])))}},l.Uniform4f=hp,l.UniformColor=Fh,l.UniformMatrix2f=class extends pl{constructor(r){super(r),this.current=Bu}set(r,e,o){if(this.fetchUniformLocation(r,e))for(let c=0;c<4;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix2fv(this.location,!1,o);break}}},l.UniformMatrix3f=class extends pl{constructor(r){super(r),this.current=Nu}set(r,e,o){if(this.fetchUniformLocation(r,e))for(let c=0;c<9;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix3fv(this.location,!1,o);break}}},l.UniformMatrix4f=class extends pl{constructor(r){super(r),this.current=Fu}set(r,e,o){if(this.fetchUniformLocation(r,e)){if(o[12]!==this.current[12]||o[0]!==this.current[0])return this.current=o,void this.gl.uniformMatrix4fv(this.location,!1,o);for(let c=1;c<16;c++)if(o[c]!==this.current[c]){this.current=o,this.gl.uniformMatrix4fv(this.location,!1,o);break}}}},l.UnwrappedTileID=Bg,l.ValidationError=li,l.VectorTileFeature=Jd,l.VectorTileWorkerSource=class extends ln{constructor(r,e,o,c,f){super(),this.actor=r,this.layerIndex=e,this.availableImages=o,this.loadVectorData=f||x_,this.loading={},this.loaded={},this.deduped=new v_(r.scheduler),this.isSpriteLoaded=c,this.scheduler=r.scheduler}loadTile(r,e){const o=r.uid,c=r&&r.request,f=c&&c.collectResourceTiming,_=this.loading[o]=new Tm(r);_.abort=this.loadVectorData(r,(v,w)=>{const E=!this.loading[o];if(delete this.loading[o],E||v||!w)return _.status="done",E||(this.loaded[o]=_),e(v);const M=w.rawData,L={};w.expires&&(L.expires=w.expires),w.cacheControl&&(L.cacheControl=w.cacheControl),_.vectorTile=w.vectorTile||new cf(new sd(M));const N=()=>{_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,(j,W)=>{if(j||!W)return e(j);const J={};if(f){const se=hr(c);se.length>0&&(J.resourceTiming=JSON.parse(JSON.stringify(se)))}e(null,We({rawTileData:M.slice(0)},W,L,J))})};this.isSpriteLoaded?N():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(N,{type:"parseTile",isSymbolTile:r.isSymbolTile,zoom:r.tileZoom}):N()}),this.loaded=this.loaded||{},this.loaded[o]=_})}reloadTile(r,e){const o=this.loaded,c=r.uid,f=this;if(o&&o[c]){const _=o[c];_.showCollisionBoxes=r.showCollisionBoxes,_.enableTerrain=!!r.enableTerrain,_.projection=r.projection,_.tileTransform=md(r.tileID.canonical,r.projection);const v=(w,E)=>{const M=_.reloadCallback;M&&(delete _.reloadCallback,_.parse(_.vectorTile,f.layerIndex,this.availableImages,f.actor,M)),e(w,E)};"parsing"===_.status?_.reloadCallback=v:"done"===_.status&&(_.vectorTile?_.parse(_.vectorTile,this.layerIndex,this.availableImages,this.actor,v):v())}}abortTile(r,e){const o=r.uid,c=this.loading[o];c&&(c.abort&&c.abort(),delete this.loading[o]),e()}removeTile(r,e){const o=this.loaded,c=r.uid;o&&o[c]&&delete o[c],e()}},l.WritingMode=La,l.ZoomDependentExpression=Zo,l.add=_l,l.addDynamicAttributes=bh,l.adjoint=function(r,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=e[4],w=e[5],E=e[6],M=e[7],L=e[8];return r[0]=v*L-w*M,r[1]=f*M-c*L,r[2]=c*w-f*v,r[3]=w*E-_*L,r[4]=o*L-f*E,r[5]=f*_-o*w,r[6]=_*M-v*E,r[7]=c*E-o*M,r[8]=o*v-c*_,r},l.asyncAll=_n,l.bezier=De,l.bindAll=an,l.boundsAttributes=_m,l.bufferConvexPolygon=function(r,e){const o=[];for(let c=0;c<r.length;c++){const f=dn(c-1,-1,r.length-1),_=dn(c+1,-1,r.length-1),v=r[c],w=r[_],E=r[f].sub(v).unit(),M=w.sub(v).unit(),L=M.angleWithSep(E.x,E.y),N=E.add(M).unit().mult(-1*e/Math.sin(L/2));o.push(v.add(N))}return o},l.cacheEntryPossiblyAdded=function(r){Ei++,Ei>wn&&(r.getActor().send("enforceCacheSizeLimit",Kt),Ei=0)},l.calculateGlobeLabelMatrix=function(r,e){const{x:o,y:c}=r.point,f=vg(o,c,r.worldSize/r._pixelsPerMercatorPixel,0,0);return ju(f,f,Gh(as(e)))},l.calculateGlobeMatrix=function(r){const{x:e,y:o}=r.point,{lng:c,lat:f}=r._center;return vg(e,o,r.worldSize,c,f)},l.calculateGlobeMercatorMatrix=function(r){const e=r.pixelsPerMeter,o=e/Xa(1,r.center.lat),c=Ol(new Float64Array(16));return Ss(c,c,[r.point.x,r.point.y,0]),oc(c,c,[o,o,e]),Float32Array.from(c)},l.circumferenceAtLatitude=zd,l.clamp=Ke,l.clearTileCache=function(r){if(!Lr())return;const e=B.caches.delete(Pt);r&&e.catch(r).then(()=>r())},l.clipLine=Hg,l.clone=function(r){var e=new As(16);return e[0]=r[0],e[1]=r[1],e[2]=r[2],e[3]=r[3],e[4]=r[4],e[5]=r[5],e[6]=r[6],e[7]=r[7],e[8]=r[8],e[9]=r[9],e[10]=r[10],e[11]=r[11],e[12]=r[12],e[13]=r[13],e[14]=r[14],e[15]=r[15],e},l.clone$1=bn,l.collisionCircleLayout=ih,l.config=ie,l.conjugate=function(r,e){return r[0]=-e[0],r[1]=-e[1],r[2]=-e[2],r[3]=e[3],r},l.create=function(){var r=new As(16);return As!=Float32Array&&(r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0),r[0]=1,r[5]=1,r[10]=1,r[15]=1,r},l.create$1=Sd,l.createExpression=Es,l.createLayout=$t,l.createStyleLayer=function(r){return"custom"===r.type?new ix(r):new o_[r.type](r)},l.cross=Zu,l.degToRad=X,l.distance=function(r,e){return Math.hypot(e[0]-r[0],e[1]-r[1],e[2]-r[2])},l.div=function(r,e,o){return r[0]=e[0]/o[0],r[1]=e[1]/o[1],r[2]=e[2]/o[2],r},l.dot=xa,l.earthRadius=Hh,l.ease=ze,l.easeCubicInOut=Fe,l.ecefToLatLng=function([r,e,o]){const c=Math.hypot(r,e,o),f=Math.atan2(r,o),_=.5*Math.PI-Math.acos(-e/c);return new pr(ve(f),ve(_))},l.emitValidationErrors=Ou,l.endsWith=tt,l.enforceCacheSizeLimit=function(r){Mi(),ei&&ei.then(e=>{e.keys().then(o=>{for(let c=0;c<o.length-r;c++)e.delete(o[c])})})},l.evaluateSizeForFeature=Yp,l.evaluateSizeForZoom=rh,l.evaluateVariableOffset=fh,l.evented=y,l.exactEquals=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]&&r[3]===e[3]},l.exactEquals$1=function(r,e){return r[0]===e[0]&&r[1]===e[1]&&r[2]===e[2]},l.exported=Yr,l.exported$1=fe,l.extend=We,l.extend$1=Hn,l.fillExtrusionHeightLift=Qd,l.filterObject=Xt,l.fromMat4=function(r,e){return r[0]=e[0],r[1]=e[1],r[2]=e[2],r[3]=e[4],r[4]=e[5],r[5]=e[6],r[6]=e[8],r[7]=e[9],r[8]=e[10],r},l.fromQuat=function(r,e){var o=e[0],c=e[1],f=e[2],_=e[3],v=o+o,w=c+c,E=f+f,M=o*v,L=c*v,N=c*w,j=f*v,W=f*w,J=f*E,se=_*v,Le=_*w,rt=_*E;return r[0]=1-N-J,r[1]=L+rt,r[2]=j-Le,r[3]=0,r[4]=L-rt,r[5]=1-M-J,r[6]=W+se,r[7]=0,r[8]=j+Le,r[9]=W-se,r[10]=1-M-N,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},l.fromRotation=function(r,e){var o=Math.sin(e),c=Math.cos(e);return r[0]=c,r[1]=o,r[2]=0,r[3]=-o,r[4]=c,r[5]=0,r[6]=0,r[7]=0,r[8]=1,r},l.fromScaling=pp,l.furthestTileCorner=function(r){const e=Math.round((r+45+360)%360/90)%4;return me[e]},l.getAABBPointSquareDist=function(r,e,o){let c=0;for(let f=0;f<2;++f){const _=o?o[f]:0;r[f]>_&&(c+=(r[f]-_)*(r[f]-_)),e[f]<_&&(c+=(_-e[f])*(_-e[f]))}return c},l.getAnchorAlignment=Lc,l.getAnchorJustification=kc,l.getBounds=function(r){let e=1/0,o=1/0,c=-1/0,f=-1/0;for(const _ of r)e=Math.min(e,_.x),o=Math.min(o,_.y),c=Math.max(c,_.x),f=Math.max(f,_.y);return{min:new ye(e,o),max:new ye(c,f)}},l.getColumn=Ve,l.getDefaultExportFromCjs=nt,l.getGridMatrix=function(r,e,o,c){const f=e.getNorth(),_=e.getSouth(),v=e.getWest(),w=e.getEast(),E=1<<r.z,M=w-v,L=f-_,N=M/64,j=-L/Gu[o],W=[0,N,0,j,0,0,f,v,0];if(r.z>0){const J=180/c;Bh(W,W,[J/M+1,0,0,0,J/L+1,0,-.5*J/N,.5*J/j,1])}return W[2]=E,W[5]=r.x,W[8]=r.y,W},l.getImage=ot,l.getJSON=function(r,e){return Fn(We(r,{type:"json"}),e)},l.getLatitudinalLod=function(r){const e=Ho-5;r=Ke(r,-e,e)/e*90;const o=Math.pow(Math.abs(Math.sin(X(r))),3);return Math.round(o*(Gu.length-1))},l.getMapSessionAPI=Xi,l.getPerformanceMeasurement=hr,l.getProjection=lm,l.getRTLTextPluginStatus=x,l.getReferrer=gn,l.getTilePoint=function(r,{x:e,y:o},c=0){return new ye(((e-c)*r.scale-r.x)*vi,(o*r.scale-r.y)*vi)},l.getTileVec3=function(r,e,o=0){return Vu(((e.x-o)*r.scale-r.x)*vi,(e.y*r.scale-r.y)*vi,xg(e.z,e.y))},l.getVideo=function(r,e){const o=B.document.createElement("video");o.muted=!0,o.onloadstart=function(){e(null,o)};for(let c=0;c<r.length;c++){const f=B.document.createElement("source");Bi(r[c])||(o.crossOrigin="Anonymous"),f.src=r[c],o.appendChild(f)}return{cancel:()=>{}}},l.globeCenterToScreenPoint=function(r){const e=[0,0,0],o=Ol(new Float64Array(16));return ju(o,r.pixelMatrix,r.globeMatrix),bo(e,e,o),new ye(e[0],e[1])},l.globeDenormalizeECEF=Gh,l.globeECEFOrigin=function(r,e){const o=[0,0,0];return bo(o,o,ru(as(e.canonical))),bo(o,o,r),o},l.globeMetersToEcef=iu,l.globeNormalizeECEF=ru,l.globePixelsToTileUnits=function(r,e){return vi/(512*Math.pow(2,r))*Yu(as(e))},l.globePoleMatrixForTile=function(r,e,o){const c=Ol(new Float64Array(16)),f=(e/(1<<r)-.5)*Math.PI*2;return fp(c,o.globeMatrix,f),Float32Array.from(c)},l.globeTileBounds=as,l.globeTiltAtLngLat=bp,l.globeToMercatorTransition=Ju,l.globeUseCustomAntiAliasing=function(r,e,o){const c=Ju(o.zoom),f=r.style.map._antialias,_=!!e.extStandardDerivatives,v=e.extStandardDerivativesForceOff||r.terrain&&r.terrain.exaggeration()>0;return 0===c&&!f&&!v&&_},l.identity=Ol,l.identity$1=dg,l.invert=zh,l.isFullscreen=function(){return!!B.document.fullscreenElement||!!B.document.webkitFullscreenElement},l.isLngLatBehindGlobe=wp,l.isMapAuthenticated=function(r){return Ar.has(r)},l.isMapboxURL=Dt,l.isSafariWithAntialiasingBug=function(r){const e=r.navigator?r.navigator.userAgent:null;return!!Ft(r)&&e&&(e.match("Version/15.4")||e.match("Version/15.5")||e.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},l.latFromMercatorY=ps,l.latLngToECEF=qu,l.len=py,l.length=Pd,l.length$1=function(r){return Math.hypot(r[0],r[1],r[2],r[3])},l.lngFromMercatorX=Rs,l.loadVectorTile=x_,l.makeRequest=Fn,l.mapValue=function(r,e,o,c,f){return Ke((r-e)/(o-e)*(f-c)+c,c,f)},l.mercatorScale=bg,l.mercatorXfromLng=Os,l.mercatorYfromLat=Pa,l.mercatorZfromAltitude=Xa,l.mul=fy,l.mul$1=kd,l.multiply=ju,l.multiply$1=Bh,l.multiply$2=cg,l.nextPowerOfTwo=Qt,l.normalize=Ps,l.normalize$1=nu,l.normalize$2=gp,l.number=Pi,l.ortho=function(r,e,o,c,f,_,v){var w=1/(e-o),E=1/(c-f),M=1/(_-v);return r[0]=-2*w,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=-2*E,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[10]=2*M,r[11]=0,r[12]=(e+o)*w,r[13]=(f+c)*E,r[14]=(v+_)*M,r[15]=1,r},l.pbf=Vg,l.perspective=function(r,e,o,c,f){var _,v=1/Math.tan(e/2);return r[0]=v/o,r[1]=0,r[2]=0,r[3]=0,r[4]=0,r[5]=v,r[6]=0,r[7]=0,r[8]=0,r[9]=0,r[11]=-1,r[12]=0,r[13]=0,r[15]=0,null!=f&&f!==1/0?(r[10]=(f+c)*(_=1/(c-f)),r[14]=2*f*c*_):(r[10]=-1,r[14]=-2*c),r},l.pick=function(r,e){const o={};for(let c=0;c<e.length;c++){const f=e[c];f in r&&(o[f]=r[f])}return o},l.plugin=I,l.pointGeometry=Ie,l.polesInViewport=function(r){const e=Ol(new Float64Array(16));ju(e,r.pixelMatrix,r.globeMatrix);const o=[0,fs,0],c=[0,Ja,0];return bo(o,o,e),bo(c,c,e),[o[0]>0&&o[0]<=r.width&&o[1]>0&&o[1]<=r.height&&!wp(r,new pr(r.center.lat,90)),c[0]>0&&c[0]<=r.width&&c[1]>0&&c[1]<=r.height&&!wp(r,new pr(r.center.lat,-90))]},l.polygonContainsPoint=Sc,l.polygonIntersectsBox=Eg,l.polygonIntersectsPolygon=su,l.polygonizeBounds=function(r,e,o=0,c=!0){const f=new ye(o,o),_=r.sub(f),v=e.add(f),w=[_,new ye(v.x,_.y),v,new ye(_.x,v.y)];return c&&w.push(_.clone()),w},l.posAttributes=Dc,l.postMapLoadEvent=bi,l.postPerformanceEvent=Ri,l.postTurnstileEvent=on,l.potpack=xf,l.prevPowerOfTwo=function(r){return r<=1?1:Math.pow(2,Math.floor(Math.log(r)/Math.LN2))},l.radToDeg=ve,l.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],l.registerForPluginStateChange=function(r){return r({pluginStatus:u,pluginURL:n}),y.on("pluginStateChange",r),r},l.removeAuthState=function(r){Ar.delete(r)},l.renderColorRamp=ef,l.resample=wg,l.rotateX=Ec,l.rotateX$1=hg,l.rotateY=fp,l.rotateY$1=fg,l.rotateZ=function(r,e,o){var c=Math.sin(o),f=Math.cos(o),_=e[0],v=e[1],w=e[2],E=e[3],M=e[4],L=e[5],N=e[6],j=e[7];return e!==r&&(r[8]=e[8],r[9]=e[9],r[10]=e[10],r[11]=e[11],r[12]=e[12],r[13]=e[13],r[14]=e[14],r[15]=e[15]),r[0]=_*f+M*c,r[1]=v*f+L*c,r[2]=w*f+N*c,r[3]=E*f+j*c,r[4]=M*f-_*c,r[5]=L*f-v*c,r[6]=N*f-w*c,r[7]=j*f-E*c,r},l.rotateZ$1=function(r,e,o){o*=.5;var c=e[0],f=e[1],_=e[2],v=e[3],w=Math.sin(o),E=Math.cos(o);return r[0]=c*E+f*w,r[1]=f*E-c*w,r[2]=_*E+v*w,r[3]=v*E-_*w,r},l.scale=oc,l.scale$1=my,l.scale$2=qs,l.scaleAndAdd=Rd,l.set=function(r,e,o,c){return r[0]=e,r[1]=o,r[2]=c,r},l.setCacheLimits=function(r,e){Kt=r,wn=e},l.setColumn=function(r,e,o){r[4*e+0]=o[0],r[4*e+1]=o[1],r[4*e+2]=o[2],r[4*e+3]=o[3]},l.setRTLTextPlugin=function(r,e,o=!1){if(u===oa||u===va||u===Lu)throw new Error("setRTLTextPlugin cannot be called multiple times.");n=Yr.resolveURL(r),u=oa,S=e,p(),o||D()},l.smoothstep=Ht,l.spec=vt,l.squaredLength=function(r){var e=r[0],o=r[1],c=r[2];return e*e+o*o+c*c},l.storeAuthState=function(r,e){e?Ar.add(r):Ar.delete(r)},l.sub=Ys,l.subtract=$u,l.symbolSize=J0,l.tileAABB=function(r,e,o,c,f,_,v,w,E){if("globe"===E.name)return function _y(r,e,o){const c=e/r.worldSize,f=r.globeMatrix;if(o.z<=1){const rn=as(o).getCorners();return _g(rn,f,c),ss.fromPoints(rn)}const _=Nd(o),v=Mc(_);_g(v,f,c);const w=Number.MAX_VALUE,E=[-w,-w,-w],M=[w,w,w];if(_.contains(r.center)){for(const Yn of v)Tc(M,M,Yn),Od(E,E,Yn);E[2]=0;const rn=r.point,Dn=[rn.x*c,rn.y*c,0];return Tc(M,M,Dn),Od(E,E,Dn),new ss(M,E)}const L=[f[12]*c,f[13]*c,f[14]*c],N=_.getCenter(),j=Ke(r.center.lat,-Ho,Ho),W=Ke(N.lat,-Ho,Ho),J=Os(r.center.lng),se=Pa(j);let Le=J-Os(N.lng);const rt=se-Pa(W);Le>.5?Le-=1:Le<-.5&&(Le+=1);let bt=0;Math.abs(Le)>Math.abs(rt)?bt=Le>=0?1:3:(bt=rt>=0?0:2,Rd(L,L,[f[4]*c,f[5]*c,f[6]*c],-Math.sin(X(rt>=0?_.getSouth():_.getNorth()))*Rl));const at=v[bt],xt=v[(bt+1)%4],At=new xp(at,xt,L),Mt=[Hu(At,0)||at[0],Hu(At,1)||at[1],Hu(At,2)||at[2]],un=Ju(r.zoom);if(un>0){const rn=function({x:Yn,y:mn,z:Pn},Rn,zn,Qn,En){const ai=1/(1<<Pn);let gi=Yn*ai,ci=gi+ai,Ji=mn*ai,ri=Ji+ai,Ai=0;const Zi=(gi+ci)/2-Qn;return Zi>.5?Ai=-1:Zi<-.5&&(Ai=1),gi=((gi+Ai)*Rn-(Qn*=Rn))*zn+Qn,ci=((ci+Ai)*Rn-Qn)*zn+Qn,Ji=(Ji*Rn-(En*=Rn))*zn+En,ri=(ri*Rn-En)*zn+En,[[gi,ri,0],[ci,ri,0],[ci,Ji,0],[gi,Ji,0]]}(o,e,r._pixelsPerMercatorPixel,J,se);for(let Yn=0;Yn<v.length;Yn++)Ka(v[Yn],rn[Yn],un);const Dn=_l([],rn[bt],rn[(bt+1)%4]);qs(Dn,Dn,.5),Ka(Mt,Dn,un)}for(const rn of v)Tc(M,M,rn),Od(E,E,rn);return M[2]=Math.min(at[2],xt[2]),Tc(M,M,Mt),Od(E,E,Mt),new ss(M,E)}(r,e,new eh(o,c,f));const M=md({z:o,x:c,y:f},E);return new ss([(_+M.x/M.scale)*e,e*(M.y/M.scale),v],[(_+M.x2/M.scale)*e,e*(M.y2/M.scale),w])},l.tileCornersToBounds=Nd,l.tileTransform=md,l.transformMat3=function(r,e,o){var c=e[0],f=e[1],_=e[2];return r[0]=c*o[0]+f*o[3]+_*o[6],r[1]=c*o[1]+f*o[4]+_*o[7],r[2]=c*o[2]+f*o[5]+_*o[8],r},l.transformMat4=bo,l.transformMat4$1=tu,l.transformQuat=ug,l.transitionTileAABBinECEF=Zh,l.translate=Ss,l.transpose=function(r,e){if(r===e){var o=e[1],c=e[2],f=e[5];r[1]=e[3],r[2]=e[6],r[3]=o,r[5]=e[7],r[6]=c,r[7]=f}else r[0]=e[0],r[1]=e[3],r[2]=e[6],r[3]=e[1],r[4]=e[4],r[5]=e[7],r[6]=e[2],r[7]=e[5],r[8]=e[8];return r},l.triggerPluginCompletionEvent=a,l.uniqueId=ke,l.updateGlobeVertexNormal=function(r,e,o,c,f){const _=5*e+2;r.float32[_+0]=o,r.float32[_+1]=c,r.float32[_+2]=f},l.validateCustomStyleLayer=function(r){const e=[],o=r.id;return void 0===o&&e.push({message:`layers.${o}: missing required property "id"`}),void 0===r.render&&e.push({message:`layers.${o}: missing required method "render"`}),r.renderingMode&&"2d"!==r.renderingMode&&"3d"!==r.renderingMode&&e.push({message:`layers.${o}: property "renderingMode" must be either "2d" or "3d"`}),e},l.validateFilter=r=>Ms(Ml(r)),l.validateFog=r=>Ms(Mu(r)),l.validateLayer=r=>Ms(vc(r)),l.validateLight=r=>Ms(ul(r)),l.validateSource=r=>Ms(hs(r)),l.validateStyle=Su,l.validateTerrain=r=>Ms(Hi(r)),l.values=Ut,l.vectorTile=af,l.version=Y,l.warnOnce=It,l.window=B,l.wrap=dn}),m(0,function(l){function B(ut){if("number"==typeof ut||"boolean"==typeof ut||"string"==typeof ut||null==ut)return JSON.stringify(ut);if(Array.isArray(ut)){let _e="[";for(const ot of ut)_e+=`${B(ot)},`;return`${_e}]`}let he="{";for(const _e of Object.keys(ut).sort())he+=`${_e}:${B(ut[_e])},`;return`${he}}`}function Y(ut){let he="";for(const _e of l.refProperties)he+=`/${B(ut[_e])}`;return he}class C{constructor(he){this.keyCache={},he&&this.replace(he)}replace(he){this._layerConfigs={},this._layers={},this.update(he,[])}update(he,_e){for(const yt of he)this._layerConfigs[yt.id]=yt,(this._layers[yt.id]=l.createStyleLayer(yt)).compileFilter(),this.keyCache[yt.id]&&delete this.keyCache[yt.id];for(const yt of _e)delete this.keyCache[yt],delete this._layerConfigs[yt],delete this._layers[yt];this.familiesBySource={};const ot=function(yt,Dt){const jt={};for(let dt=0;dt<yt.length;dt++){const Bt=Dt&&Dt[yt[dt].id]||Y(yt[dt]);Dt&&(Dt[yt[dt].id]=Bt);let Nn=jt[Bt];Nn||(Nn=jt[Bt]=[]),Nn.push(yt[dt])}const Vt=[];for(const dt in jt)Vt.push(jt[dt]);return Vt}(l.values(this._layerConfigs),this.keyCache);for(const yt of ot){const Dt=yt.map(Gn=>this._layers[Gn.id]),jt=Dt[0];if("none"===jt.visibility)continue;const Vt=jt.source||"";let dt=this.familiesBySource[Vt];dt||(dt=this.familiesBySource[Vt]={});const Bt=jt.sourceLayer||"_geojsonTileLayer";let Nn=dt[Bt];Nn||(Nn=dt[Bt]=[]),Nn.push(Dt)}}}class ie{loadTile(he,_e){const{uid:ot,encoding:yt,rawImageData:Dt,padding:jt,buildQuadTree:Vt}=he,dt=l.window.ImageBitmap&&Dt instanceof l.window.ImageBitmap?this.getImageData(Dt,jt):Dt;_e(null,new l.DEMData(ot,dt,yt,jt<1,Vt))}getImageData(he,_e){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(he.width,he.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=he.width,this.offscreenCanvas.height=he.height,this.offscreenCanvasContext.drawImage(he,0,0,he.width,he.height);const ot=this.offscreenCanvasContext.getImageData(-_e,-_e,he.width+2*_e,he.height+2*_e);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ot}}function fe(ut,he){if(0!==ut.length){Pe(ut[0],he);for(var _e=1;_e<ut.length;_e++)Pe(ut[_e],!he)}}function Pe(ut,he){for(var _e=0,ot=0,yt=0,Dt=ut.length,jt=Dt-1;yt<Dt;jt=yt++){var Vt=(ut[yt][0]-ut[jt][0])*(ut[jt][1]+ut[yt][1]),dt=_e+Vt;ot+=Math.abs(_e)>=Math.abs(Vt)?_e-dt+Vt:Vt-dt+_e,_e=dt}_e+ot>=0!=!!he&&ut.reverse()}var K=l.getDefaultExportFromCjs(function ut(he,_e){var ot,yt=he&&he.type;if("FeatureCollection"===yt)for(ot=0;ot<he.features.length;ot++)ut(he.features[ot],_e);else if("GeometryCollection"===yt)for(ot=0;ot<he.geometries.length;ot++)ut(he.geometries[ot],_e);else if("Feature"===yt)ut(he.geometry,_e);else if("Polygon"===yt)fe(he.coordinates,_e);else if("MultiPolygon"===yt)for(ot=0;ot<he.coordinates.length;ot++)fe(he.coordinates[ot],_e);return he});const be=l.VectorTileFeature.prototype.toGeoJSON;var Te={exports:{}},Me=l.pointGeometry,de=l.vectorTile.VectorTileFeature,nt=Ce;function Ce(ut,he){this.options=he||{},this.features=ut,this.length=ut.length}function oe(ut,he){this.id="number"==typeof ut.id?ut.id:void 0,this.type=ut.type,this.rawGeometry=1===ut.type?[ut.geometry]:ut.geometry,this.properties=ut.tags,this.extent=he||4096}Ce.prototype.feature=function(ut){return new oe(this.features[ut],this.options.extent)},oe.prototype.loadGeometry=function(){var ut=this.rawGeometry;this.geometry=[];for(var he=0;he<ut.length;he++){for(var _e=ut[he],ot=[],yt=0;yt<_e.length;yt++)ot.push(new Me(_e[yt][0],_e[yt][1]));this.geometry.push(ot)}return this.geometry},oe.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var ut=this.geometry,he=1/0,_e=-1/0,ot=1/0,yt=-1/0,Dt=0;Dt<ut.length;Dt++)for(var jt=ut[Dt],Vt=0;Vt<jt.length;Vt++){var dt=jt[Vt];he=Math.min(he,dt.x),_e=Math.max(_e,dt.x),ot=Math.min(ot,dt.y),yt=Math.max(yt,dt.y)}return[he,ot,_e,yt]},oe.prototype.toGeoJSON=de.prototype.toGeoJSON;var xe=l.pbf,Ie=nt;function Ae(ut){var he=new xe;return function(_e,ot){for(var yt in _e.layers)ot.writeMessage(3,ye,_e.layers[yt])}(ut,he),he.finish()}function ye(ut,he){var _e;he.writeVarintField(15,ut.version||1),he.writeStringField(1,ut.name||""),he.writeVarintField(5,ut.extent||4096);var ot={keys:[],values:[],keycache:{},valuecache:{}};for(_e=0;_e<ut.length;_e++)ot.feature=ut.feature(_e),he.writeMessage(2,Ue,ot);var yt=ot.keys;for(_e=0;_e<yt.length;_e++)he.writeStringField(3,yt[_e]);var Dt=ot.values;for(_e=0;_e<Dt.length;_e++)he.writeMessage(4,Fe,Dt[_e])}function Ue(ut,he){var _e=ut.feature;void 0!==_e.id&&he.writeVarintField(1,_e.id),he.writeMessage(2,ct,ut),he.writeVarintField(3,_e.type),he.writeMessage(4,me,_e)}function ct(ut,he){var _e=ut.feature,ot=ut.keys,yt=ut.values,Dt=ut.keycache,jt=ut.valuecache;for(var Vt in _e.properties){var dt=_e.properties[Vt],Bt=Dt[Vt];if(null!==dt){void 0===Bt&&(ot.push(Vt),Dt[Vt]=Bt=ot.length-1),he.writeVarint(Bt);var Nn=typeof dt;"string"!==Nn&&"boolean"!==Nn&&"number"!==Nn&&(dt=JSON.stringify(dt));var Gn=Nn+":"+dt,ae=jt[Gn];void 0===ae&&(yt.push(dt),jt[Gn]=ae=yt.length-1),he.writeVarint(ae)}}}function X(ut,he){return(he<<3)+(7&ut)}function ve(ut){return ut<<1^ut>>31}function me(ut,he){for(var _e=ut.loadGeometry(),ot=ut.type,yt=0,Dt=0,jt=_e.length,Vt=0;Vt<jt;Vt++){var dt=_e[Vt],Bt=1;1===ot&&(Bt=dt.length),he.writeVarint(X(1,Bt));for(var Nn=3===ot?dt.length-1:dt.length,Gn=0;Gn<Nn;Gn++){1===Gn&&1!==ot&&he.writeVarint(X(2,Nn-1));var ae=dt[Gn].x-yt,ft=dt[Gn].y-Dt;he.writeVarint(ve(ae)),he.writeVarint(ve(ft)),yt+=ae,Dt+=ft}3===ot&&he.writeVarint(X(7,1))}}function Fe(ut,he){var _e=typeof ut;"string"===_e?he.writeStringField(1,ut):"boolean"===_e?he.writeBooleanField(7,ut):"number"===_e&&(ut%1!=0?he.writeDoubleField(3,ut):ut<0?he.writeSVarintField(6,ut):he.writeVarintField(5,ut))}Te.exports=Ae,Te.exports.fromVectorTileJs=Ae,Te.exports.fromGeojsonVt=function(ut,he){he=he||{};var _e={};for(var ot in ut)_e[ot]=new Ie(ut[ot].features,he),_e[ot].name=ot,_e[ot].version=he.version,_e[ot].extent=he.extent;return Ae({layers:_e})},Te.exports.GeoJSONWrapper=Ie;var De=l.getDefaultExportFromCjs(Te.exports);const ze={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:ut=>ut},Ke=Math.fround||(Ht=new Float32Array(1),ut=>(Ht[0]=+ut,Ht[0]));var Ht;const dn=3,_n=5,Ut=6;class We{constructor(he){this.options=Object.assign(Object.create(ze),he),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(he){const{log:_e,minZoom:ot,maxZoom:yt}=this.options;_e&&console.time("total time");const Dt=`prepare ${he.length} points`;_e&&console.time(Dt),this.points=he;const jt=[];for(let dt=0;dt<he.length;dt++){const Bt=he[dt];if(!Bt.geometry)continue;const[Nn,Gn]=Bt.geometry.coordinates,ae=Ke(it(Nn)),ft=Ke(Qt(Gn));jt.push(ae,ft,1/0,dt,-1,1),this.options.reduce&&jt.push(0)}let Vt=this.trees[yt+1]=this._createTree(jt);_e&&console.timeEnd(Dt);for(let dt=yt;dt>=ot;dt--){const Bt=+Date.now();Vt=this.trees[dt]=this._createTree(this._cluster(Vt,dt)),_e&&console.log("z%d: %d clusters in %dms",dt,Vt.numItems,+Date.now()-Bt)}return _e&&console.timeEnd("total time"),this}getClusters(he,_e){let ot=((he[0]+180)%360+360)%360-180;const yt=Math.max(-90,Math.min(90,he[1]));let Dt=180===he[2]?180:((he[2]+180)%360+360)%360-180;const jt=Math.max(-90,Math.min(90,he[3]));if(he[2]-he[0]>=360)ot=-180,Dt=180;else if(ot>Dt){const Gn=this.getClusters([ot,yt,180,jt],_e),ae=this.getClusters([-180,yt,Dt,jt],_e);return Gn.concat(ae)}const Vt=this.trees[this._limitZoom(_e)],dt=Vt.range(it(ot),Qt(jt),it(Dt),Qt(yt)),Bt=Vt.data,Nn=[];for(const Gn of dt){const ae=this.stride*Gn;Nn.push(Bt[ae+_n]>1?Ne(Bt,ae,this.clusterProps):this.points[Bt[ae+dn]])}return Nn}getChildren(he){const _e=this._getOriginId(he),ot=this._getOriginZoom(he),yt="No cluster with the specified id.",Dt=this.trees[ot];if(!Dt)throw new Error(yt);const jt=Dt.data;if(_e*this.stride>=jt.length)throw new Error(yt);const Vt=this.options.radius/(this.options.extent*Math.pow(2,ot-1)),dt=Dt.within(jt[_e*this.stride],jt[_e*this.stride+1],Vt),Bt=[];for(const Nn of dt){const Gn=Nn*this.stride;jt[Gn+4]===he&&Bt.push(jt[Gn+_n]>1?Ne(jt,Gn,this.clusterProps):this.points[jt[Gn+dn]])}if(0===Bt.length)throw new Error(yt);return Bt}getLeaves(he,_e,ot){const yt=[];return this._appendLeaves(yt,he,_e=_e||10,ot=ot||0,0),yt}getTile(he,_e,ot){const yt=this.trees[this._limitZoom(he)],Dt=Math.pow(2,he),{extent:jt,radius:Vt}=this.options,dt=Vt/jt,Bt=(ot-dt)/Dt,Nn=(ot+1+dt)/Dt,Gn={features:[]};return this._addTileFeatures(yt.range((_e-dt)/Dt,Bt,(_e+1+dt)/Dt,Nn),yt.data,_e,ot,Dt,Gn),0===_e&&this._addTileFeatures(yt.range(1-dt/Dt,Bt,1,Nn),yt.data,Dt,ot,Dt,Gn),_e===Dt-1&&this._addTileFeatures(yt.range(0,Bt,dt/Dt,Nn),yt.data,-1,ot,Dt,Gn),Gn.features.length?Gn:null}getClusterExpansionZoom(he){let _e=this._getOriginZoom(he)-1;for(;_e<=this.options.maxZoom;){const ot=this.getChildren(he);if(_e++,1!==ot.length)break;he=ot[0].properties.cluster_id}return _e}_appendLeaves(he,_e,ot,yt,Dt){const jt=this.getChildren(_e);for(const Vt of jt){const dt=Vt.properties;if(dt&&dt.cluster?Dt+dt.point_count<=yt?Dt+=dt.point_count:Dt=this._appendLeaves(he,dt.cluster_id,ot,yt,Dt):Dt<yt?Dt++:he.push(Vt),he.length===ot)break}return Dt}_createTree(he){const _e=new l.KDBush(he.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ot=0;ot<he.length;ot+=this.stride)_e.add(he[ot],he[ot+1]);return _e.finish(),_e.data=he,_e}_addTileFeatures(he,_e,ot,yt,Dt,jt){for(const Vt of he){const dt=Vt*this.stride,Bt=_e[dt+_n]>1;let Nn,Gn,ae;if(Bt)Nn=ke(_e,dt,this.clusterProps),Gn=_e[dt],ae=_e[dt+1];else{const Re=this.points[_e[dt+dn]];Nn=Re.properties;const[st,on]=Re.geometry.coordinates;Gn=it(st),ae=Qt(on)}const ft={type:1,geometry:[[Math.round(this.options.extent*(Gn*Dt-ot)),Math.round(this.options.extent*(ae*Dt-yt))]],tags:Nn};let Z;Z=Bt||this.options.generateId?_e[dt+dn]:this.points[_e[dt+dn]].id,void 0!==Z&&(ft.id=Z),jt.features.push(ft)}}_limitZoom(he){return Math.max(this.options.minZoom,Math.min(Math.floor(+he),this.options.maxZoom+1))}_cluster(he,_e){const{radius:ot,extent:yt,reduce:Dt,minPoints:jt}=this.options,Vt=ot/(yt*Math.pow(2,_e)),dt=he.data,Bt=[],Nn=this.stride;for(let Gn=0;Gn<dt.length;Gn+=Nn){if(dt[Gn+2]<=_e)continue;dt[Gn+2]=_e;const ae=dt[Gn],ft=dt[Gn+1],Z=he.within(dt[Gn],dt[Gn+1],Vt),Re=dt[Gn+_n];let st=Re;for(const on of Z){const In=on*Nn;dt[In+2]>_e&&(st+=dt[In+_n])}if(st>Re&&st>=jt){let on,In=ae*Re,bi=ft*Re,wi=-1;const Ri=((Gn/Nn|0)<<5)+(_e+1)+this.points.length;for(const mr of Z){const Xi=mr*Nn;if(dt[Xi+2]<=_e)continue;dt[Xi+2]=_e;const Ar=dt[Xi+_n];In+=dt[Xi]*Ar,bi+=dt[Xi+1]*Ar,dt[Xi+4]=Ri,Dt&&(on||(on=this._map(dt,Gn,!0),wi=this.clusterProps.length,this.clusterProps.push(on)),Dt(on,this._map(dt,Xi)))}dt[Gn+4]=Ri,Bt.push(In/st,bi/st,1/0,Ri,-1,st),Dt&&Bt.push(wi)}else{for(let on=0;on<Nn;on++)Bt.push(dt[Gn+on]);if(st>1)for(const on of Z){const In=on*Nn;if(!(dt[In+2]<=_e)){dt[In+2]=_e;for(let bi=0;bi<Nn;bi++)Bt.push(dt[In+bi])}}}}return Bt}_getOriginId(he){return he-this.points.length>>5}_getOriginZoom(he){return(he-this.points.length)%32}_map(he,_e,ot){if(he[_e+_n]>1){const jt=this.clusterProps[he[_e+Ut]];return ot?Object.assign({},jt):jt}const yt=this.points[he[_e+dn]].properties,Dt=this.options.map(yt);return ot&&Dt===yt?Object.assign({},Dt):Dt}}function Ne(ut,he,_e){return{type:"Feature",id:ut[he+dn],properties:ke(ut,he,_e),geometry:{type:"Point",coordinates:[(ot=ut[he],360*(ot-.5)),mt(ut[he+1])]}};var ot}function ke(ut,he,_e){const ot=ut[he+_n],yt=ot>=1e4?`${Math.round(ot/1e3)}k`:ot>=1e3?Math.round(ot/100)/10+"k":ot,Dt=ut[he+Ut],jt=-1===Dt?{}:Object.assign({},_e[Dt]);return Object.assign(jt,{cluster:!0,cluster_id:ut[he+dn],point_count:ot,point_count_abbreviated:yt})}function it(ut){return ut/360+.5}function Qt(ut){const he=Math.sin(ut*Math.PI/180),_e=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return _e<0?0:_e>1?1:_e}function mt(ut){const he=(180-360*ut)*Math.PI/180;return 360*Math.atan(Math.exp(he))/Math.PI-90}function an(ut,he,_e,ot){for(var yt,Dt=ot,jt=_e-he>>1,Vt=_e-he,dt=ut[he],Bt=ut[he+1],Nn=ut[_e],Gn=ut[_e+1],ae=he+3;ae<_e;ae+=3){var ft=tt(ut[ae],ut[ae+1],dt,Bt,Nn,Gn);if(ft>Dt)yt=ae,Dt=ft;else if(ft===Dt){var Z=Math.abs(ae-jt);Z<Vt&&(yt=ae,Vt=Z)}}Dt>ot&&(yt-he>3&&an(ut,he,yt,ot),ut[yt+2]=Dt,_e-yt>3&&an(ut,yt,_e,ot))}function tt(ut,he,_e,ot,yt,Dt){var jt=yt-_e,Vt=Dt-ot;if(0!==jt||0!==Vt){var dt=((ut-_e)*jt+(he-ot)*Vt)/(jt*jt+Vt*Vt);dt>1?(_e=yt,ot=Dt):dt>0&&(_e+=jt*dt,ot+=Vt*dt)}return(jt=ut-_e)*jt+(Vt=he-ot)*Vt}function pt(ut,he,_e,ot){var yt={id:void 0===ut?null:ut,type:he,geometry:_e,tags:ot,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(Dt){var jt=Dt.geometry,Vt=Dt.type;if("Point"===Vt||"MultiPoint"===Vt||"LineString"===Vt)Xt(Dt,jt);else if("Polygon"===Vt||"MultiLineString"===Vt)for(var dt=0;dt<jt.length;dt++)Xt(Dt,jt[dt]);else if("MultiPolygon"===Vt)for(dt=0;dt<jt.length;dt++)for(var Bt=0;Bt<jt[dt].length;Bt++)Xt(Dt,jt[dt][Bt])}(yt),yt}function Xt(ut,he){for(var _e=0;_e<he.length;_e+=3)ut.minX=Math.min(ut.minX,he[_e]),ut.minY=Math.min(ut.minY,he[_e+1]),ut.maxX=Math.max(ut.maxX,he[_e]),ut.maxY=Math.max(ut.maxY,he[_e+1])}function bn(ut,he,_e,ot){if(he.geometry){var yt=he.geometry.coordinates,Dt=he.geometry.type,jt=Math.pow(_e.tolerance/((1<<_e.maxZoom)*_e.extent),2),Vt=[],dt=he.id;if(_e.promoteId?dt=he.properties[_e.promoteId]:_e.generateId&&(dt=ot||0),"Point"===Dt)Cn(yt,Vt);else if("MultiPoint"===Dt)for(var Bt=0;Bt<yt.length;Bt++)Cn(yt[Bt],Vt);else if("LineString"===Dt)It(yt,Vt,jt,!1);else if("MultiLineString"===Dt){if(_e.lineMetrics){for(Bt=0;Bt<yt.length;Bt++)It(yt[Bt],Vt=[],jt,!1),ut.push(pt(dt,"LineString",Vt,he.properties));return}pe(yt,Vt,jt,!1)}else if("Polygon"===Dt)pe(yt,Vt,jt,!0);else{if("MultiPolygon"!==Dt){if("GeometryCollection"===Dt){for(Bt=0;Bt<he.geometry.geometries.length;Bt++)bn(ut,{id:dt,geometry:he.geometry.geometries[Bt],properties:he.properties},_e,ot);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Bt=0;Bt<yt.length;Bt++){var Nn=[];pe(yt[Bt],Nn,jt,!0),Vt.push(Nn)}}ut.push(pt(dt,Dt,Vt,he.properties))}}function Cn(ut,he){he.push(lt(ut[0])),he.push(Zt(ut[1])),he.push(0)}function It(ut,he,_e,ot){for(var yt,Dt,jt=0,Vt=0;Vt<ut.length;Vt++){var dt=lt(ut[Vt][0]),Bt=Zt(ut[Vt][1]);he.push(dt),he.push(Bt),he.push(0),Vt>0&&(jt+=ot?(yt*Bt-dt*Dt)/2:Math.sqrt(Math.pow(dt-yt,2)+Math.pow(Bt-Dt,2))),yt=dt,Dt=Bt}var Nn=he.length-3;he[2]=1,an(he,0,Nn,_e),he[Nn+2]=1,he.size=Math.abs(jt),he.start=0,he.end=he.size}function pe(ut,he,_e,ot){for(var yt=0;yt<ut.length;yt++){var Dt=[];It(ut[yt],Dt,_e,ot),he.push(Dt)}}function lt(ut){return ut/360+.5}function Zt(ut){var he=Math.sin(ut*Math.PI/180),_e=.5-.25*Math.log((1+he)/(1-he))/Math.PI;return _e<0?0:_e>1?1:_e}function hn(ut,he,_e,ot,yt,Dt,jt,Vt){if(ot/=he,Dt>=(_e/=he)&&jt<ot)return ut;if(jt<_e||Dt>=ot)return null;for(var dt=[],Bt=0;Bt<ut.length;Bt++){var Nn=ut[Bt],Gn=Nn.geometry,ae=Nn.type,ft=0===yt?Nn.minX:Nn.minY,Z=0===yt?Nn.maxX:Nn.maxY;if(ft>=_e&&Z<ot)dt.push(Nn);else if(!(Z<_e||ft>=ot)){var Re=[];if("Point"===ae||"MultiPoint"===ae)Yt(Gn,Re,_e,ot,yt);else if("LineString"===ae)Ft(Gn,Re,_e,ot,yt,!1,Vt.lineMetrics);else if("MultiLineString"===ae)Ve(Gn,Re,_e,ot,yt,!1);else if("Polygon"===ae)Ve(Gn,Re,_e,ot,yt,!0);else if("MultiPolygon"===ae)for(var st=0;st<Gn.length;st++){var on=[];Ve(Gn[st],on,_e,ot,yt,!0),on.length&&Re.push(on)}if(Re.length){if(Vt.lineMetrics&&"LineString"===ae){for(st=0;st<Re.length;st++)dt.push(pt(Nn.id,ae,Re[st],Nn.tags));continue}"LineString"!==ae&&"MultiLineString"!==ae||(1===Re.length?(ae="LineString",Re=Re[0]):ae="MultiLineString"),"Point"!==ae&&"MultiPoint"!==ae||(ae=3===Re.length?"Point":"MultiPoint"),dt.push(pt(Nn.id,ae,Re,Nn.tags))}}}return dt.length?dt:null}function Yt(ut,he,_e,ot,yt){for(var Dt=0;Dt<ut.length;Dt+=3){var jt=ut[Dt+yt];jt>=_e&&jt<=ot&&(he.push(ut[Dt]),he.push(ut[Dt+1]),he.push(ut[Dt+2]))}}function Ft(ut,he,_e,ot,yt,Dt,jt){for(var Vt,dt,Bt=Un(ut),Nn=0===yt?Kt:wn,Gn=ut.start,ae=0;ae<ut.length-3;ae+=3){var ft=ut[ae],Z=ut[ae+1],Re=ut[ae+2],st=ut[ae+3],on=ut[ae+4],In=0===yt?ft:Z,bi=0===yt?st:on,wi=!1;jt&&(Vt=Math.sqrt(Math.pow(ft-st,2)+Math.pow(Z-on,2))),In<_e?bi>_e&&(dt=Nn(Bt,ft,Z,st,on,_e),jt&&(Bt.start=Gn+Vt*dt)):In>ot?bi<ot&&(dt=Nn(Bt,ft,Z,st,on,ot),jt&&(Bt.start=Gn+Vt*dt)):Pt(Bt,ft,Z,Re),bi<_e&&In>=_e&&(dt=Nn(Bt,ft,Z,st,on,_e),wi=!0),bi>ot&&In<=ot&&(dt=Nn(Bt,ft,Z,st,on,ot),wi=!0),!Dt&&wi&&(jt&&(Bt.end=Gn+Vt*dt),he.push(Bt),Bt=Un(ut)),jt&&(Gn+=Vt)}var Ri=ut.length-3;ft=ut[Ri],Z=ut[Ri+1],Re=ut[Ri+2],(In=0===yt?ft:Z)>=_e&&In<=ot&&Pt(Bt,ft,Z,Re),Ri=Bt.length-3,Dt&&Ri>=3&&(Bt[Ri]!==Bt[0]||Bt[Ri+1]!==Bt[1])&&Pt(Bt,Bt[0],Bt[1],Bt[2]),Bt.length&&he.push(Bt)}function Un(ut){var he=[];return he.size=ut.size,he.start=ut.start,he.end=ut.end,he}function Ve(ut,he,_e,ot,yt,Dt){for(var jt=0;jt<ut.length;jt++)Ft(ut[jt],he,_e,ot,yt,Dt,!1)}function Pt(ut,he,_e,ot){ut.push(he),ut.push(_e),ut.push(ot)}function Kt(ut,he,_e,ot,yt,Dt){var jt=(Dt-he)/(ot-he);return ut.push(Dt),ut.push(_e+(yt-_e)*jt),ut.push(1),jt}function wn(ut,he,_e,ot,yt,Dt){var jt=(Dt-_e)/(yt-_e);return ut.push(he+(ot-he)*jt),ut.push(Dt),ut.push(1),jt}function ei(ut,he){for(var _e=[],ot=0;ot<ut.length;ot++){var yt,Dt=ut[ot],jt=Dt.type;if("Point"===jt||"MultiPoint"===jt||"LineString"===jt)yt=di(Dt.geometry,he);else if("MultiLineString"===jt||"Polygon"===jt){yt=[];for(var Vt=0;Vt<Dt.geometry.length;Vt++)yt.push(di(Dt.geometry[Vt],he))}else if("MultiPolygon"===jt)for(yt=[],Vt=0;Vt<Dt.geometry.length;Vt++){for(var dt=[],Bt=0;Bt<Dt.geometry[Vt].length;Bt++)dt.push(di(Dt.geometry[Vt][Bt],he));yt.push(dt)}_e.push(pt(Dt.id,jt,yt,Dt.tags))}return _e}function di(ut,he){var _e=[];_e.size=ut.size,void 0!==ut.start&&(_e.start=ut.start,_e.end=ut.end);for(var ot=0;ot<ut.length;ot+=3)_e.push(ut[ot]+he,ut[ot+1],ut[ot+2]);return _e}function Lr(ut,he){if(ut.transformed)return ut;var _e,ot,yt,Dt=1<<ut.z,jt=ut.x,Vt=ut.y;for(_e=0;_e<ut.features.length;_e++){var dt=ut.features[_e],Bt=dt.geometry,Nn=dt.type;if(dt.geometry=[],1===Nn)for(ot=0;ot<Bt.length;ot+=2)dt.geometry.push(Mi(Bt[ot],Bt[ot+1],he,Dt,jt,Vt));else for(ot=0;ot<Bt.length;ot++){var Gn=[];for(yt=0;yt<Bt[ot].length;yt+=2)Gn.push(Mi(Bt[ot][yt],Bt[ot][yt+1],he,Dt,jt,Vt));dt.geometry.push(Gn)}}return ut.transformed=!0,ut}function Mi(ut,he,_e,ot,yt,Dt){return[Math.round(_e*(ut*ot-yt)),Math.round(_e*(he*ot-Dt))]}function dr(ut,he,_e,ot,yt){for(var Dt=he===yt.maxZoom?0:yt.tolerance/((1<<he)*yt.extent),jt={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:_e,y:ot,z:he,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Vt=0;Vt<ut.length;Vt++){jt.numFeatures++,Ei(jt,ut[Vt],Dt,yt);var dt=ut[Vt].minX,Bt=ut[Vt].minY,Nn=ut[Vt].maxX,Gn=ut[Vt].maxY;dt<jt.minX&&(jt.minX=dt),Bt<jt.minY&&(jt.minY=Bt),Nn>jt.maxX&&(jt.maxX=Nn),Gn>jt.maxY&&(jt.maxY=Gn)}return jt}function Ei(ut,he,_e,ot){var yt=he.geometry,Dt=he.type,jt=[];if("Point"===Dt||"MultiPoint"===Dt)for(var Vt=0;Vt<yt.length;Vt+=3)jt.push(yt[Vt]),jt.push(yt[Vt+1]),ut.numPoints++,ut.numSimplified++;else if("LineString"===Dt)fn(jt,yt,ut,_e,!1,!1);else if("MultiLineString"===Dt||"Polygon"===Dt)for(Vt=0;Vt<yt.length;Vt++)fn(jt,yt[Vt],ut,_e,"Polygon"===Dt,0===Vt);else if("MultiPolygon"===Dt)for(var dt=0;dt<yt.length;dt++){var Bt=yt[dt];for(Vt=0;Vt<Bt.length;Vt++)fn(jt,Bt[Vt],ut,_e,!0,0===Vt)}if(jt.length){var Nn=he.tags||null;if("LineString"===Dt&&ot.lineMetrics){for(var Gn in Nn={},he.tags)Nn[Gn]=he.tags[Gn];Nn.mapbox_clip_start=yt.start/yt.size,Nn.mapbox_clip_end=yt.end/yt.size}var ae={geometry:jt,type:"Polygon"===Dt||"MultiPolygon"===Dt?3:"LineString"===Dt||"MultiLineString"===Dt?2:1,tags:Nn};null!==he.id&&(ae.id=he.id),ut.features.push(ae)}}function fn(ut,he,_e,ot,yt,Dt){var jt=ot*ot;if(ot>0&&he.size<(yt?jt:ot))_e.numPoints+=he.length/3;else{for(var Vt=[],dt=0;dt<he.length;dt+=3)(0===ot||he[dt+2]>jt)&&(_e.numSimplified++,Vt.push(he[dt]),Vt.push(he[dt+1])),_e.numPoints++;yt&&function(Bt,Nn){for(var Gn=0,ae=0,ft=Bt.length,Z=ft-2;ae<ft;Z=ae,ae+=2)Gn+=(Bt[ae]-Bt[Z])*(Bt[ae+1]+Bt[Z+1]);if(Gn>0===Nn)for(ae=0,ft=Bt.length;ae<ft/2;ae+=2){var Re=Bt[ae],st=Bt[ae+1];Bt[ae]=Bt[ft-2-ae],Bt[ae+1]=Bt[ft-1-ae],Bt[ft-2-ae]=Re,Bt[ft-1-ae]=st}}(Vt,Dt),ut.push(Vt)}}function Li(ut,he){var _e=(he=this.options=function(yt,Dt){for(var jt in Dt)yt[jt]=Dt[jt];return yt}(Object.create(this.options),he)).debug;if(_e&&console.time("preprocess data"),he.maxZoom<0||he.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(he.promoteId&&he.generateId)throw new Error("promoteId and generateId cannot be used together.");var yt,Dt,jt,Vt,dt,Bt,ot=function(yt,Dt){var jt=[];if("FeatureCollection"===yt.type)for(var Vt=0;Vt<yt.features.length;Vt++)bn(jt,yt.features[Vt],Dt,Vt);else bn(jt,"Feature"===yt.type?yt:{geometry:yt},Dt);return jt}(ut,he);this.tiles={},this.tileCoords=[],_e&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",he.indexMaxZoom,he.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),Vt=yt=ot,dt=hn(yt,1,-1-(jt=(Dt=he).buffer/Dt.extent),jt,0,-1,2,Dt),Bt=hn(yt,1,1-jt,2+jt,0,-1,2,Dt),(dt||Bt)&&(Vt=hn(yt,1,-jt,1+jt,0,-1,2,Dt)||[],dt&&(Vt=ei(dt,1).concat(Vt)),Bt&&(Vt=Vt.concat(ei(Bt,-1)))),(ot=Vt).length&&this.splitTile(ot,0,0,0),_e&&(ot.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function gn(ut,he,_e){return 32*((1<<ut)*_e+he)+ut}function Fn(ut,he){const _e=ut.tileID.canonical;if(!this._geoJSONIndex)return he(null,null);const ot=this._geoJSONIndex.getTile(_e.z,_e.x,_e.y);if(!ot)return he(null,null);const yt=new class{constructor(jt){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=l.EXTENT,this.length=jt.length,this._features=jt}feature(jt){return new class{constructor(Vt){this._feature=Vt,this.extent=l.EXTENT,this.type=Vt.type,this.properties=Vt.tags,"id"in Vt&&!isNaN(Vt.id)&&(this.id=parseInt(Vt.id,10))}loadGeometry(){if(1===this._feature.type){const Vt=[];for(const dt of this._feature.geometry)Vt.push([new l.Point(dt[0],dt[1])]);return Vt}{const Vt=[];for(const dt of this._feature.geometry){const Bt=[];for(const Nn of dt)Bt.push(new l.Point(Nn[0],Nn[1]));Vt.push(Bt)}return Vt}}toGeoJSON(Vt,dt,Bt){return be.call(this,Vt,dt,Bt)}}(this._features[jt])}}(ot.features);let Dt=De(yt);0===Dt.byteOffset&&Dt.byteLength===Dt.buffer.byteLength||(Dt=new Uint8Array(Dt)),he(null,{vectorTile:yt,rawData:Dt.buffer})}Li.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Li.prototype.splitTile=function(ut,he,_e,ot,yt,Dt,jt){for(var Vt=[ut,he,_e,ot],dt=this.options,Bt=dt.debug;Vt.length;){ot=Vt.pop(),_e=Vt.pop(),he=Vt.pop(),ut=Vt.pop();var Nn=1<<he,Gn=gn(he,_e,ot),ae=this.tiles[Gn];if(!ae&&(Bt>1&&console.time("creation"),ae=this.tiles[Gn]=dr(ut,he,_e,ot,dt),this.tileCoords.push({z:he,x:_e,y:ot}),Bt)){Bt>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",he,_e,ot,ae.numFeatures,ae.numPoints,ae.numSimplified),console.timeEnd("creation"));var ft="z"+he;this.stats[ft]=(this.stats[ft]||0)+1,this.total++}if(ae.source=ut,yt){if(he===dt.maxZoom||he===yt)continue;var Z=1<<yt-he;if(_e!==Math.floor(Dt/Z)||ot!==Math.floor(jt/Z))continue}else if(he===dt.indexMaxZoom||ae.numPoints<=dt.indexMaxPoints)continue;if(ae.source=null,0!==ut.length){Bt>1&&console.time("clipping");var Re,st,on,In,bi,wi,Ri=.5*dt.buffer/dt.extent,mr=.5-Ri,Xi=.5+Ri,Ar=1+Ri;Re=st=on=In=null,bi=hn(ut,Nn,_e-Ri,_e+Xi,0,ae.minX,ae.maxX,dt),wi=hn(ut,Nn,_e+mr,_e+Ar,0,ae.minX,ae.maxX,dt),ut=null,bi&&(Re=hn(bi,Nn,ot-Ri,ot+Xi,1,ae.minY,ae.maxY,dt),st=hn(bi,Nn,ot+mr,ot+Ar,1,ae.minY,ae.maxY,dt),bi=null),wi&&(on=hn(wi,Nn,ot-Ri,ot+Xi,1,ae.minY,ae.maxY,dt),In=hn(wi,Nn,ot+mr,ot+Ar,1,ae.minY,ae.maxY,dt),wi=null),Bt>1&&console.timeEnd("clipping"),Vt.push(Re||[],he+1,2*_e,2*ot),Vt.push(st||[],he+1,2*_e,2*ot+1),Vt.push(on||[],he+1,2*_e+1,2*ot),Vt.push(In||[],he+1,2*_e+1,2*ot+1)}}},Li.prototype.getTile=function(ut,he,_e){var ot=this.options,yt=ot.extent,Dt=ot.debug;if(ut<0||ut>24)return null;var jt=1<<ut,Vt=gn(ut,he=(he%jt+jt)%jt,_e);if(this.tiles[Vt])return Lr(this.tiles[Vt],yt);Dt>1&&console.log("drilling down to z%d-%d-%d",ut,he,_e);for(var dt,Bt=ut,Nn=he,Gn=_e;!dt&&Bt>0;)Bt--,Nn=Math.floor(Nn/2),Gn=Math.floor(Gn/2),dt=this.tiles[gn(Bt,Nn,Gn)];return dt&&dt.source?(Dt>1&&console.log("found parent tile z%d-%d-%d",Bt,Nn,Gn),Dt>1&&console.time("drilling down"),this.splitTile(dt.source,Bt,Nn,Gn,ut,he,_e),Dt>1&&console.timeEnd("drilling down"),this.tiles[Vt]?Lr(this.tiles[Vt],yt):null):null};class Jt extends l.VectorTileWorkerSource{constructor(he,_e,ot,yt,Dt){super(he,_e,ot,yt,Fn),Dt&&(this.loadGeoJSON=Dt)}loadData(he,_e){const ot=he&&he.request,yt=ot&&ot.collectResourceTiming;this.loadGeoJSON(he,(Dt,jt)=>{if(Dt||!jt)return _e(Dt);if("object"!=typeof jt)return _e(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`));{K(jt,!0);try{if(he.filter){const dt=l.createExpression(he.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if("error"===dt.result)throw new Error(dt.value.map(Nn=>`${Nn.key}: ${Nn.message}`).join(", "));jt={type:"FeatureCollection",features:jt.features.filter(Nn=>dt.value.evaluate({zoom:0},Nn))}}this._geoJSONIndex=he.cluster?new We(function({superclusterOptions:dt,clusterProperties:Bt}){if(!Bt||!dt)return dt;const Nn={},Gn={},ae={accumulated:null,zoom:0},ft={properties:null},Z=Object.keys(Bt);for(const Re of Z){const[st,on]=Bt[Re],In=l.createExpression(on),bi=l.createExpression("string"==typeof st?[st,["accumulated"],["get",Re]]:st);Nn[Re]=In.value,Gn[Re]=bi.value}return dt.map=Re=>{ft.properties=Re;const st={};for(const on of Z)st[on]=Nn[on].evaluate(ae,ft);return st},dt.reduce=(Re,st)=>{ft.properties=st;for(const on of Z)ae.accumulated=Re[on],Re[on]=Gn[on].evaluate(ae,ft)},dt}(he)).load(jt.features):new Li(dt=jt,he.geojsonVtOptions)}catch(dt){return _e(dt)}this.loaded={};const Vt={};if(yt){const dt=l.getPerformanceMeasurement(ot);dt&&(Vt.resourceTiming={},Vt.resourceTiming[he.source]=JSON.parse(JSON.stringify(dt)))}_e(null,Vt)}var dt})}reloadTile(he,_e){const ot=this.loaded;return ot&&ot[he.uid]?super.reloadTile(he,_e):this.loadTile(he,_e)}loadGeoJSON(he,_e){if(he.request)l.getJSON(he.request,_e);else{if("string"!=typeof he.data)return _e(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`));try{return _e(null,JSON.parse(he.data))}catch{return _e(new Error(`Input data given to '${he.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(he,_e){try{_e(null,this._geoJSONIndex.getClusterExpansionZoom(he.clusterId))}catch(ot){_e(ot)}}getClusterChildren(he,_e){try{_e(null,this._geoJSONIndex.getChildren(he.clusterId))}catch(ot){_e(ot)}}getClusterLeaves(he,_e){try{_e(null,this._geoJSONIndex.getLeaves(he.clusterId,he.limit,he.offset))}catch(ot){_e(ot)}}}class Bi{constructor(he){this.self=he,this.actor=new l.Actor(he,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=l.getProjection({name:"mercator"}),this.workerSourceTypes={vector:l.VectorTileWorkerSource,geojson:Jt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(_e,ot)=>{if(this.workerSourceTypes[_e])throw new Error(`Worker source with name "${_e}" already registered.`);this.workerSourceTypes[_e]=ot},this.self.registerRTLTextPlugin=_e=>{if(l.plugin.isParsed())throw new Error("RTL text plugin already registered.");l.plugin.applyArabicShaping=_e.applyArabicShaping,l.plugin.processBidirectionalText=_e.processBidirectionalText,l.plugin.processStyledBidirectionalText=_e.processStyledBidirectionalText}}clearCaches(he,_e,ot){delete this.layerIndexes[he],delete this.availableImages[he],delete this.workerSources[he],delete this.demWorkerSources[he],ot()}checkIfReady(he,_e,ot){ot()}setReferrer(he,_e){this.referrer=_e}spriteLoaded(he,_e){this.isSpriteLoaded[he]=_e;for(const ot in this.workerSources[he]){const yt=this.workerSources[he][ot];for(const Dt in yt)yt[Dt]instanceof l.VectorTileWorkerSource&&(yt[Dt].isSpriteLoaded=_e,yt[Dt].fire(new l.Event("isSpriteLoaded")))}}setImages(he,_e,ot){this.availableImages[he]=_e;for(const yt in this.workerSources[he]){const Dt=this.workerSources[he][yt];for(const jt in Dt)Dt[jt].availableImages=_e}ot()}enableTerrain(he,_e,ot){this.terrain=_e,ot()}setProjection(he,_e){this.projections[he]=l.getProjection(_e)}setLayers(he,_e,ot){this.getLayerIndex(he).replace(_e),ot()}updateLayers(he,_e,ot){this.getLayerIndex(he).update(_e.layers,_e.removedIds),ot()}loadTile(he,_e,ot){const yt=this.enableTerrain?l.extend({enableTerrain:this.terrain},_e):_e;yt.projection=this.projections[he]||this.defaultProjection,this.getWorkerSource(he,_e.type,_e.source).loadTile(yt,ot)}loadDEMTile(he,_e,ot){const yt=this.enableTerrain?l.extend({buildQuadTree:this.terrain},_e):_e;this.getDEMWorkerSource(he,_e.source).loadTile(yt,ot)}reloadTile(he,_e,ot){const yt=this.enableTerrain?l.extend({enableTerrain:this.terrain},_e):_e;yt.projection=this.projections[he]||this.defaultProjection,this.getWorkerSource(he,_e.type,_e.source).reloadTile(yt,ot)}abortTile(he,_e,ot){this.getWorkerSource(he,_e.type,_e.source).abortTile(_e,ot)}removeTile(he,_e,ot){this.getWorkerSource(he,_e.type,_e.source).removeTile(_e,ot)}removeSource(he,_e,ot){if(!this.workerSources[he]||!this.workerSources[he][_e.type]||!this.workerSources[he][_e.type][_e.source])return;const yt=this.workerSources[he][_e.type][_e.source];delete this.workerSources[he][_e.type][_e.source],void 0!==yt.removeSource?yt.removeSource(_e,ot):ot()}loadWorkerSource(he,_e,ot){try{this.self.importScripts(_e.url),ot()}catch(yt){ot(yt.toString())}}syncRTLPluginState(he,_e,ot){try{l.plugin.setState(_e);const yt=l.plugin.getPluginURL();if(l.plugin.isLoaded()&&!l.plugin.isParsed()&&null!=yt){this.self.importScripts(yt);const Dt=l.plugin.isParsed();ot(Dt?void 0:new Error(`RTL Text Plugin failed to import scripts from ${yt}`),Dt)}}catch(yt){ot(yt.toString())}}getAvailableImages(he){let _e=this.availableImages[he];return _e||(_e=[]),_e}getLayerIndex(he){let _e=this.layerIndexes[he];return _e||(_e=this.layerIndexes[he]=new C),_e}getWorkerSource(he,_e,ot){return this.workerSources[he]||(this.workerSources[he]={}),this.workerSources[he][_e]||(this.workerSources[he][_e]={}),this.workerSources[he][_e][ot]||(this.workerSources[he][_e][ot]=new this.workerSourceTypes[_e]({send:(Dt,jt,Vt,dt,Bt,Nn)=>{this.actor.send(Dt,jt,Vt,he,Bt,Nn)},scheduler:this.actor.scheduler},this.getLayerIndex(he),this.getAvailableImages(he),this.isSpriteLoaded[he])),this.workerSources[he][_e][ot]}getDEMWorkerSource(he,_e){return this.demWorkerSources[he]||(this.demWorkerSources[he]={}),this.demWorkerSources[he][_e]||(this.demWorkerSources[he][_e]=new ie),this.demWorkerSources[he][_e]}enforceCacheSizeLimit(he,_e){l.enforceCacheSizeLimit(_e)}getWorkerPerformanceMetrics(he,_e,ot){ot(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new Bi(self)),Bi}),m(0,function(l){function B(u,n){if(Array.isArray(u)){if(!Array.isArray(n)||u.length!==n.length)return!1;for(let a=0;a<u.length;a++)if(!B(u[a],n[a]))return!1;return!0}if("object"==typeof u&&null!==u&&null!==n){if("object"!=typeof n||Object.keys(u).length!==Object.keys(n).length)return!1;for(const a in u)if(!B(u[a],n[a]))return!1;return!0}return u===n}var Y=C;function C(u){return n=u,!(typeof window>"u"||typeof document>"u"||!(Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray)||!Function.prototype||!Function.prototype.bind||!(Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions)||!("JSON"in window&&"parse"in JSON&&"stringify"in JSON)||!function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var p,y,x=new Blob([""],{type:"text/javascript"}),D=URL.createObjectURL(x);try{y=new Worker(D),p=!0}catch{p=!1}return y&&y.terminate(),URL.revokeObjectURL(D),p}()||!("Uint8ClampedArray"in window)||!ArrayBuffer.isView||!function(){var p=document.createElement("canvas");p.width=p.height=1;var y=p.getContext("2d");if(!y)return!1;var x=y.getImageData(0,0,1,1);return x&&x.width===p.width}()||(void 0===ie[a=n&&n.failIfMajorPerformanceCaveat]&&(ie[a]=function(p){var y,D,I,R,x=(D=p,I=document.createElement("canvas"),(R=Object.create(C.webGLContextAttributes)).failIfMajorPerformanceCaveat=D,I.getContext("webgl",R)||I.getContext("experimental-webgl",R));if(!x)return!1;try{y=x.createShader(x.VERTEX_SHADER)}catch{return!1}return!(!y||x.isContextLost())&&(x.shaderSource(y,"void main() {}"),x.compileShader(y),!0===x.getShaderParameter(y,x.COMPILE_STATUS))}(a)),!ie[a]||document.documentMode));var n,a}var ie={};function fe(u,n,a){const p=l.window.document.createElement(u);return void 0!==n&&(p.className=n),a&&a.appendChild(p),p}function Pe(u,n,a){const p=l.window.document.createElementNS("http://www.w3.org/2000/svg",u);for(const y of Object.keys(n))p.setAttributeNS(null,y,n[y]);return a&&a.appendChild(p),p}C.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const K=l.window.document&&l.window.document.documentElement.style,be=K&&void 0!==K.userSelect?"userSelect":"WebkitUserSelect";let Te;function Me(){K&&be&&(Te=K[be],K[be]="none")}function de(){K&&be&&(K[be]=Te)}function nt(u){u.preventDefault(),u.stopPropagation(),l.window.removeEventListener("click",nt,!0)}function Ce(){l.window.addEventListener("click",nt,!0),l.window.setTimeout(()=>{l.window.removeEventListener("click",nt,!0)},0)}function oe(u,n){const a=u.getBoundingClientRect();return Ae(u,a,n)}function xe(u,n){const a=u.getBoundingClientRect(),p=[];for(let y=0;y<n.length;y++)p.push(Ae(u,a,n[y]));return p}function Ie(u){return void 0!==l.window.InstallTrigger&&2===u.button&&u.ctrlKey&&l.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:u.button}function Ae(u,n,a){const p=u.offsetWidth===n.width?1:u.offsetWidth/n.width;return new l.Point((a.clientX-n.left)*p,(a.clientY-n.top)*p)}function ye(u,n){var a=n[0],p=n[1],y=n[2],x=n[3],D=a*x-y*p;return D?(u[0]=x*(D=1/D),u[1]=-p*D,u[2]=-y*D,u[3]=a*D,u):null}function Ue(u){const{userImage:n}=u;return!!(n&&n.render&&n.render())&&(u.data.replace(new Uint8Array(n.data.buffer)),!0)}class ct extends l.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new l.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(n){if(this.loaded!==n&&(this.loaded=n,n)){for(const{ids:a,callback:p}of this.requestors)this._notify(a,p);this.requestors=[]}}hasImage(n){return!!this.getImage(n)}getImage(n){return this.images[n]}addImage(n,a){this._validate(n,a)&&(this.images[n]=a)}_validate(n,a){let p=!0;return this._validateStretch(a.stretchX,a.data&&a.data.width)||(this.fire(new l.ErrorEvent(new Error(`Image "${n}" has invalid "stretchX" value`))),p=!1),this._validateStretch(a.stretchY,a.data&&a.data.height)||(this.fire(new l.ErrorEvent(new Error(`Image "${n}" has invalid "stretchY" value`))),p=!1),this._validateContent(a.content,a)||(this.fire(new l.ErrorEvent(new Error(`Image "${n}" has invalid "content" value`))),p=!1),p}_validateStretch(n,a){if(!n)return!0;let p=0;for(const y of n){if(y[0]<p||y[1]<y[0]||a<y[1])return!1;p=y[1]}return!0}_validateContent(n,a){return!(n&&(4!==n.length||n[0]<0||a.data.width<n[0]||n[1]<0||a.data.height<n[1]||n[2]<0||a.data.width<n[2]||n[3]<0||a.data.height<n[3]||n[2]<n[0]||n[3]<n[1]))}updateImage(n,a){a.version=this.images[n].version+1,this.images[n]=a,this.updatedImages[n]=!0}removeImage(n){const a=this.images[n];delete this.images[n],delete this.patterns[n],a.userImage&&a.userImage.onRemove&&a.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(n,a){let p=!0;if(!this.isLoaded())for(const y of n)this.images[y]||(p=!1);this.isLoaded()||p?this._notify(n,a):this.requestors.push({ids:n,callback:a})}_notify(n,a){const p={};for(const y of n){this.images[y]||this.fire(new l.Event("styleimagemissing",{id:y}));const x=this.images[y];x?p[y]={data:x.data.clone(),pixelRatio:x.pixelRatio,sdf:x.sdf,version:x.version,stretchX:x.stretchX,stretchY:x.stretchY,content:x.content,hasRenderCallback:!(!x.userImage||!x.userImage.render)}:l.warnOnce(`Image "${y}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}a(null,p)}getPixelSize(){const{width:n,height:a}=this.atlasImage;return{width:n,height:a}}getPattern(n){const a=this.patterns[n],p=this.getImage(n);if(!p)return null;if(a&&a.position.version===p.version)return a.position;if(a)a.position.version=p.version;else{const y={w:p.data.width+2,h:p.data.height+2,x:0,y:0},x=new l.ImagePosition(y,p);this.patterns[n]={bin:y,position:x}}return this._updatePatternAtlas(),this.patterns[n].position}bind(n){const a=n.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new l.Texture(n,this.atlasImage,a.RGBA),this.atlasTexture&&this.atlasTexture.bind(a.LINEAR,a.CLAMP_TO_EDGE)}_updatePatternAtlas(){const n=[];for(const x in this.patterns)n.push(this.patterns[x].bin);const{w:a,h:p}=l.potpack(n),y=this.atlasImage;y.resize({width:a||1,height:p||1});for(const x in this.patterns){const{bin:D}=this.patterns[x],I=D.x+1,R=D.y+1,U=this.images[x].data,z=U.width,Q=U.height;l.RGBAImage.copy(U,y,{x:0,y:0},{x:I,y:R},{width:z,height:Q}),l.RGBAImage.copy(U,y,{x:0,y:Q-1},{x:I,y:R-1},{width:z,height:1}),l.RGBAImage.copy(U,y,{x:0,y:0},{x:I,y:R+Q},{width:z,height:1}),l.RGBAImage.copy(U,y,{x:z-1,y:0},{x:I-1,y:R},{width:1,height:Q}),l.RGBAImage.copy(U,y,{x:0,y:0},{x:I+z,y:R},{width:1,height:Q})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(n){for(const a of n){if(this.callbackDispatchedThisFrame[a])continue;this.callbackDispatchedThisFrame[a]=!0;const p=this.images[a];Ue(p)&&this.updateImage(a,p)}}}const X=new l.Properties({anchor:new l.DataConstantProperty(l.spec.light.anchor),position:new class{constructor(){this.specification=l.spec.light.position}possiblyEvaluate(u,n){return function([a,p,y]){const x=l.degToRad(p+90),D=l.degToRad(y);return{x:a*Math.cos(x)*Math.sin(D),y:a*Math.sin(x)*Math.sin(D),z:a*Math.cos(D),azimuthal:p,polar:y}}(u.expression.evaluate(n))}interpolate(u,n,a){return{x:l.number(u.x,n.x,a),y:l.number(u.y,n.y,a),z:l.number(u.z,n.z,a),azimuthal:l.number(u.azimuthal,n.azimuthal,a),polar:l.number(u.polar,n.polar,a)}}},color:new l.DataConstantProperty(l.spec.light.color),intensity:new l.DataConstantProperty(l.spec.light.intensity)});class ve extends l.Evented{constructor(n){super(),this._transitionable=new l.Transitionable(X),this.setLight(n),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(n,a={}){if(!this._validate(l.validateLight,n,a))for(const p in n){const y=n[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,n.call(l.validateStyle,l.extend({value:a,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}const me=new l.Properties({source:new l.DataConstantProperty(l.spec.terrain.source),exaggeration:new l.DataConstantProperty(l.spec.terrain.exaggeration)});let Fe=class extends l.Evented{constructor(u,n){super(),this._transitionable=new l.Transitionable(me),this.set(u),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=n}get(){return this._transitionable.serialize()}set(u){for(const n in u){const a=u[n];l.endsWith(n,"-transition")?this._transitionable.setTransition(n.slice(0,-11),a):this._transitionable.setValue(n,a)}}updateTransitions(u){this._transitioning=this._transitionable.transitioned(u,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(u){this.properties=this._transitioning.possiblyEvaluate(u)}};function De(u,n,a,p){const y=l.smoothstep(45,65,a),[x,D]=ze(u,p),I=l.length(n);let R=1-Math.min(1,Math.exp((I-x)/(D-x)*-6));return R*=R*R,R=Math.min(1,1.00747*R),R*y*u.alpha}function ze(u,n){const a=.5/Math.tan(.5*n);return[u.range[0]+a,u.range[1]+a]}const Ke=new l.Properties({range:new l.DataConstantProperty(l.spec.fog.range),color:new l.DataConstantProperty(l.spec.fog.color),"high-color":new l.DataConstantProperty(l.spec.fog["high-color"]),"space-color":new l.DataConstantProperty(l.spec.fog["space-color"]),"horizon-blend":new l.DataConstantProperty(l.spec.fog["horizon-blend"]),"star-intensity":new l.DataConstantProperty(l.spec.fog["star-intensity"])});class Ht extends l.Evented{constructor(n,a){super(),this._transitionable=new l.Transitionable(Ke),this.set(n),this._transitioning=this._transitionable.untransitioned(),this._transform=a}get state(){const n=this._transform,a="globe"===n.projection.name,p=l.globeToMercatorTransition(n.zoom),y=this.properties.get("range"),x=[.5,3];return{range:a?[l.number(x[0],y[0],p),l.number(x[1],y[1],p)]:y,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(n,a={}){if(!this._validate(l.validateFog,n,a)){for(const p of Object.keys(l.spec.fog))n&&void 0===n[p]&&(n[p]=l.spec.fog[p].default);for(const p in n){const y=n[p];l.endsWith(p,"-transition")?this._transitionable.setTransition(p.slice(0,-11),y):this._transitionable.setValue(p,y)}}}getOpacity(n){if(!this._transform.projection.supportsFog)return 0;const a=this.properties&&this.properties.get("color")||1;return("globe"===this._transform.projection.name?1:l.smoothstep(45,65,n))*a.a}getOpacityAtLatLng(n,a){return this._transform.projection.supportsFog?function(p,y,x){const D=l.MercatorCoordinate.fromLngLat(y),I=x.elevation?x.elevation.getAtPointOrZero(D):0,R=[D.x,D.y,I];return l.transformMat4(R,R,x.mercatorFogMatrix),De(p,R,x.pitch,x._fov)}(this.state,n,a):0}getFovAdjustedRange(n){return this._transform.projection.supportsFog?ze(this.state,n):[0,1]}updateTransitions(n){this._transitioning=this._transitionable.transitioned(n,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(n){this.properties=this._transitioning.possiblyEvaluate(n)}_validate(n,a,p){return(!p||!1!==p.validate)&&l.emitValidationErrors(this,n.call(l.validateStyle,l.extend({value:a,style:{glyphs:!0,sprite:!0},styleSpec:l.spec})))}}class dn{constructor(n,a){this.workerPool=n,this.actors=[],this.currentActor=0,this.id=l.uniqueId();const p=this.workerPool.acquire(this.id);for(let y=0;y<p.length;y++){const x=new dn.Actor(p[y],a,this.id);x.name=`Worker ${y}`,this.actors.push(x)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(n,a,p){l.asyncAll(this.actors,(y,x)=>{y.send(n,a,x)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(n=>{n.remove()}),this.actors=[],this.workerPool.release(this.id)}}function _n(u,n,a){return n*(l.EXTENT/(u.tileSize*Math.pow(2,a-u.tileID.overscaledZ)))}dn.Actor=l.Actor;class Ut{constructor(n,a,p,y){this.screenBounds=n,this.cameraPoint=a,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=p,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,y)}static createFromScreenPoints(n,a){let p,y;if(n instanceof l.Point||"number"==typeof n[0]){const x=l.Point.convert(n);p=[x],y=a.isPointAboveHorizon(x)}else{const x=l.Point.convert(n[0]),D=l.Point.convert(n[1]);p=[x,D],y=l.polygonizeBounds(x,D).every(I=>a.isPointAboveHorizon(I))}return new Ut(p,a.getCameraPoint(),y,a)}isPointQuery(){return 1===this.screenBounds.length}bufferedScreenGeometry(n){return l.polygonizeBounds(this.screenBounds[0],1===this.screenBounds.length?this.screenBounds[0]:this.screenBounds[1],n)}bufferedCameraGeometry(n){const a=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],y=l.polygonizeBounds(a,p,0,!1);return this.cameraPoint.y>p.y&&(this.cameraPoint.x>a.x&&this.cameraPoint.x<p.x?y.splice(3,0,this.cameraPoint):this.cameraPoint.x>=p.x?y[2]=this.cameraPoint:this.cameraPoint.x<=a.x&&(y[3]=this.cameraPoint)),l.bufferConvexPolygon(y,n)}bufferedCameraGeometryGlobe(n){const a=this.screenBounds[0],p=1===this.screenBounds.length?this.screenBounds[0].add(new l.Point(1,1)):this.screenBounds[1],y=l.polygonizeBounds(a,p,n),x=this.cameraPoint.clone();switch(3*((x.y>a.y)+(x.y>p.y))+((x.x>a.x)+(x.x>p.x))){case 0:y[0]=x,y[4]=x.clone();break;case 1:y.splice(1,0,x);break;case 2:y[1]=x;break;case 3:y.splice(4,0,x);break;case 5:y.splice(2,0,x);break;case 6:y[3]=x;break;case 7:y.splice(3,0,x);break;case 8:y[2]=x}return y}containsTile(n,a,p,y=0){const x=n.queryPadding/a._pixelsPerMercatorPixel+1,D=p?this._bufferedCameraMercator(x,a):this._bufferedScreenMercator(x,a);let I=n.tileID.wrap+(D.unwrapped?y:0);const R=D.polygon.map(et=>l.getTilePoint(n.tileTransform,et,I));if(!l.polygonIntersectsBox(R,0,0,l.EXTENT,l.EXTENT))return;I=n.tileID.wrap+(this.screenGeometryMercator.unwrapped?y:0);const U=this.screenGeometryMercator.polygon.map(et=>l.getTileVec3(n.tileTransform,et,I)),z=U.map(et=>new l.Point(et[0],et[1])),Q=a.getFreeCameraOptions().position||new l.MercatorCoordinate(0,0,0),Se=l.getTileVec3(n.tileTransform,Q,I),je=U.map(et=>{const ne=l.sub(et,et,Se);return l.normalize(ne,ne),new l.Ray(Se,ne)}),Ye=_n(n,1,a.zoom)*a._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:z,tilespaceRays:je,bufferedTilespaceGeometry:R,bufferedTilespaceBounds:($e=l.getBounds(R),$e.min.x=l.clamp($e.min.x,0,l.EXTENT),$e.min.y=l.clamp($e.min.y,0,l.EXTENT),$e.max.x=l.clamp($e.max.x,0,l.EXTENT),$e.max.y=l.clamp($e.max.y,0,l.EXTENT),$e),tile:n,tileID:n.tileID,pixelToTileUnitsFactor:Ye};var $e}_bufferedScreenMercator(n,a){const p=ke(n);if(this._screenRaycastCache[p])return this._screenRaycastCache[p];{let y;return y="globe"===a.projection.name?this._projectAndResample(this.bufferedScreenGeometry(n),a):{polygon:this.bufferedScreenGeometry(n).map(x=>a.pointCoordinate3D(x)),unwrapped:!0},this._screenRaycastCache[p]=y,y}}_bufferedCameraMercator(n,a){const p=ke(n);if(this._cameraRaycastCache[p])return this._cameraRaycastCache[p];{let y;return y="globe"===a.projection.name?this._projectAndResample(this.bufferedCameraGeometryGlobe(n),a):{polygon:this.bufferedCameraGeometry(n).map(x=>a.pointCoordinate3D(x)),unwrapped:!0},this._cameraRaycastCache[p]=y,y}}_projectAndResample(n,a){const p=function(x,D){const I=l.multiply([],D.pixelMatrix,D.globeMatrix),R=[0,-l.GLOBE_RADIUS,0,1],U=[0,l.GLOBE_RADIUS,0,1],z=[0,0,0,1];l.transformMat4$1(R,R,I),l.transformMat4$1(U,U,I),l.transformMat4$1(z,z,I);const Q=new l.Point(R[0]/R[3],R[1]/R[3]),Se=new l.Point(U[0]/U[3],U[1]/U[3]),je=l.polygonContainsPoint(x,Q)&&R[3]<z[3],Ye=l.polygonContainsPoint(x,Se)&&U[3]<z[3];if(!je&&!Ye)return null;const $e=function(Lt,qt,$t){for(let cn=1;cn<Lt.length;cn++){const Wn=Ne(qt.pointCoordinate3D(Lt[cn-1]).x),nn=Ne(qt.pointCoordinate3D(Lt[cn]).x);if($t<0){if(Wn<nn)return{idx:cn,t:-Wn/(nn-1-Wn)}}else if(nn<Wn)return{idx:cn,t:(1-Wn)/(nn+1-Wn)}}return null}(x,D,je?-1:1);if(!$e)return null;const{idx:et,t:ne}=$e;let He=et>1?We(x.slice(0,et),D):[],ht=et<x.length?We(x.slice(et),D):[];He=He.map(Lt=>new l.Point(Ne(Lt.x),Lt.y)),ht=ht.map(Lt=>new l.Point(Ne(Lt.x),Lt.y));const gt=[...He];0===gt.length&&gt.push(ht[ht.length-1]);const Ot=l.number(gt[gt.length-1].y,(0===ht.length?He[0]:ht[0]).y,ne);let kt;return kt=je?[new l.Point(0,Ot),new l.Point(0,0),new l.Point(1,0),new l.Point(1,Ot)]:[new l.Point(1,Ot),new l.Point(1,1),new l.Point(0,1),new l.Point(0,Ot)],gt.push(...kt),0===ht.length?gt.push(He[0]):gt.push(...ht),{polygon:gt.map(Lt=>new l.MercatorCoordinate(Lt.x,Lt.y)),unwrapped:!1}}(n,a);if(p)return p;const y=function(x,D){let I=!1,R=-1/0,U=0;for(let Q=0;Q<x.length-1;Q++)x[Q].x>R&&(R=x[Q].x,U=Q);for(let Q=0;Q<x.length-1;Q++){const Se=(U+Q)%(x.length-1),je=x[Se],Ye=x[Se+1];Math.abs(je.x-Ye.x)>.5&&(je.x<Ye.x?(je.x+=1,0===Se&&(x[x.length-1].x+=1)):(Ye.x+=1,Se+1===x.length-1&&(x[0].x+=1)),I=!0)}const z=l.mercatorXfromLng(D.center.lng);return I&&z<Math.abs(z-1)&&x.forEach(Q=>{Q.x-=1}),{polygon:x,unwrapped:I}}(We(n,a).map(x=>new l.Point(Ne(x.x),x.y)),a);return{polygon:y.polygon.map(x=>new l.MercatorCoordinate(x.x,x.y)),unwrapped:y.unwrapped}}}function We(u,n){return l.resample(u,a=>{const p=n.pointCoordinate3D(a);a.x=p.x,a.y=p.y},1/256)}function Ne(u){return u<0?1+u%1:u%1}function ke(u){return 100*u|0}function it(u,n,a,p,y){const x=function(D,I){if(D)return y(D);if(I){u.url&&I.tiles&&u.tiles&&delete u.tiles;const R=l.pick(l.extend(I,u),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);I.vector_layers&&(R.vectorLayers=I.vector_layers,R.vectorLayerIds=R.vectorLayers.map(U=>U.id)),R.tiles=n.canonicalizeTileset(R,u.url),y(null,R)}};return u.url?l.getJSON(n.transformRequest(n.normalizeSourceURL(u.url,null,a,p),l.ResourceType.Source),x):l.exported.frame(()=>x(null,u))}class Qt{constructor(n,a,p){this.bounds=l.LngLatBounds.convert(this.validateBounds(n)),this.minzoom=a||0,this.maxzoom=p||24}validateBounds(n){return Array.isArray(n)&&4===n.length?[Math.max(-180,n[0]),Math.max(-90,n[1]),Math.min(180,n[2]),Math.min(90,n[3])]:[-180,-90,180,90]}contains(n){const a=Math.pow(2,n.z),p=Math.floor(l.mercatorXfromLng(this.bounds.getWest())*a),y=Math.floor(l.mercatorYfromLat(this.bounds.getNorth())*a),x=Math.ceil(l.mercatorXfromLng(this.bounds.getEast())*a),D=Math.ceil(l.mercatorYfromLat(this.bounds.getSouth())*a);return n.x>=p&&n.x<x&&n.y>=y&&n.y<D}}class mt{constructor(n,a,p){this.context=n;const y=n.gl;this.buffer=y.createBuffer(),this.dynamicDraw=!!p,this.context.unbindVAO(),n.bindElementBuffer.set(this.buffer),y.bufferData(y.ELEMENT_ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?y.DYNAMIC_DRAW:y.STATIC_DRAW),this.dynamicDraw||a.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(n){const a=this.context.gl;this.context.unbindVAO(),this.bind(),a.bufferSubData(a.ELEMENT_ARRAY_BUFFER,0,n.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const an={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class tt{constructor(n,a,p,y){this.length=a.length,this.attributes=p,this.itemSize=a.bytesPerElement,this.dynamicDraw=y,this.context=n;const x=n.gl;this.buffer=x.createBuffer(),n.bindVertexBuffer.set(this.buffer),x.bufferData(x.ARRAY_BUFFER,a.arrayBuffer,this.dynamicDraw?x.DYNAMIC_DRAW:x.STATIC_DRAW),this.dynamicDraw||a.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(n){const a=this.context.gl;this.bind(),a.bufferSubData(a.ARRAY_BUFFER,0,n.arrayBuffer)}enableAttributes(n,a){for(let p=0;p<this.attributes.length;p++){const y=a.attributes[this.attributes[p].name];void 0!==y&&n.enableVertexAttribArray(y)}}setVertexAttribPointers(n,a,p){for(let y=0;y<this.attributes.length;y++){const x=this.attributes[y],D=a.attributes[x.name];void 0!==D&&n.vertexAttribPointer(D,x.components,n[an[x.type]],!1,this.itemSize,x.offset+this.itemSize*(p||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class pt{constructor(n){this.gl=n.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(n){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Xt extends pt{getDefault(){return l.Color.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.clearColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class bn extends pt{getDefault(){return 1}set(n){(n!==this.current||this.dirty)&&(this.gl.clearDepth(n),this.current=n,this.dirty=!1)}}class Cn extends pt{getDefault(){return 0}set(n){(n!==this.current||this.dirty)&&(this.gl.clearStencil(n),this.current=n,this.dirty=!1)}}class It extends pt{getDefault(){return[!0,!0,!0,!0]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.colorMask(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class pe extends pt{getDefault(){return!0}set(n){(n!==this.current||this.dirty)&&(this.gl.depthMask(n),this.current=n,this.dirty=!1)}}class lt extends pt{getDefault(){return 255}set(n){(n!==this.current||this.dirty)&&(this.gl.stencilMask(n),this.current=n,this.dirty=!1)}}class Zt extends pt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(n){const a=this.current;(n.func!==a.func||n.ref!==a.ref||n.mask!==a.mask||this.dirty)&&(this.gl.stencilFunc(n.func,n.ref,n.mask),this.current=n,this.dirty=!1)}}class hn extends pt{getDefault(){const n=this.gl;return[n.KEEP,n.KEEP,n.KEEP]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||this.dirty)&&(this.gl.stencilOp(n[0],n[1],n[2]),this.current=n,this.dirty=!1)}}class Yt extends pt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.STENCIL_TEST):a.disable(a.STENCIL_TEST),this.current=n,this.dirty=!1}}class Ft extends pt{getDefault(){return[0,1]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.depthRange(n[0],n[1]),this.current=n,this.dirty=!1)}}class Un extends pt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.DEPTH_TEST):a.disable(a.DEPTH_TEST),this.current=n,this.dirty=!1}}class Ve extends pt{getDefault(){return this.gl.LESS}set(n){(n!==this.current||this.dirty)&&(this.gl.depthFunc(n),this.current=n,this.dirty=!1)}}class Pt extends pt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.BLEND):a.disable(a.BLEND),this.current=n,this.dirty=!1}}class Kt extends pt{getDefault(){const n=this.gl;return[n.ONE,n.ZERO]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||this.dirty)&&(this.gl.blendFunc(n[0],n[1]),this.current=n,this.dirty=!1)}}class wn extends pt{getDefault(){return l.Color.transparent}set(n){const a=this.current;(n.r!==a.r||n.g!==a.g||n.b!==a.b||n.a!==a.a||this.dirty)&&(this.gl.blendColor(n.r,n.g,n.b,n.a),this.current=n,this.dirty=!1)}}class ei extends pt{getDefault(){return this.gl.FUNC_ADD}set(n){(n!==this.current||this.dirty)&&(this.gl.blendEquation(n),this.current=n,this.dirty=!1)}}class di extends pt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;n?a.enable(a.CULL_FACE):a.disable(a.CULL_FACE),this.current=n,this.dirty=!1}}class Lr extends pt{getDefault(){return this.gl.BACK}set(n){(n!==this.current||this.dirty)&&(this.gl.cullFace(n),this.current=n,this.dirty=!1)}}class Mi extends pt{getDefault(){return this.gl.CCW}set(n){(n!==this.current||this.dirty)&&(this.gl.frontFace(n),this.current=n,this.dirty=!1)}}let dr,Ei=class extends pt{getDefault(){return null}set(u){(u!==this.current||this.dirty)&&(this.gl.useProgram(u),this.current=u,this.dirty=!1)}};class fn extends pt{getDefault(){return this.gl.TEXTURE0}set(n){(n!==this.current||this.dirty)&&(this.gl.activeTexture(n),this.current=n,this.dirty=!1)}}class Li extends pt{getDefault(){const n=this.gl;return[0,0,n.drawingBufferWidth,n.drawingBufferHeight]}set(n){const a=this.current;(n[0]!==a[0]||n[1]!==a[1]||n[2]!==a[2]||n[3]!==a[3]||this.dirty)&&(this.gl.viewport(n[0],n[1],n[2],n[3]),this.current=n,this.dirty=!1)}}class gn extends pt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,n),this.current=n,this.dirty=!1}}class Fn extends pt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindRenderbuffer(a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class Jt extends pt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindTexture(a.TEXTURE_2D,n),this.current=n,this.dirty=!1}}class Bi extends pt{getDefault(){return null}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.bindBuffer(a.ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class ut extends pt{getDefault(){return null}set(n){const a=this.gl;a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,n),this.current=n,this.dirty=!1}}class he extends pt{constructor(n){super(n),this.vao=n.extVertexArrayObject}getDefault(){return null}set(n){this.vao&&(n!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(n),this.current=n,this.dirty=!1)}}class _e extends pt{getDefault(){return 4}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_ALIGNMENT,n),this.current=n,this.dirty=!1}}class ot extends pt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,n),this.current=n,this.dirty=!1}}class yt extends pt{getDefault(){return!1}set(n){if(n===this.current&&!this.dirty)return;const a=this.gl;a.pixelStorei(a.UNPACK_FLIP_Y_WEBGL,n),this.current=n,this.dirty=!1}}class Dt extends pt{constructor(n,a){super(n),this.context=n,this.parent=a}getDefault(){return null}}class jt extends Dt{setDirty(){this.dirty=!0}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,n,0),this.current=n,this.dirty=!1}}class Vt extends Dt{attachment(){return this.gl.DEPTH_ATTACHMENT}set(n){if(n===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const a=this.gl;a.framebufferRenderbuffer(a.FRAMEBUFFER,this.attachment(),a.RENDERBUFFER,n),this.current=n,this.dirty=!1}}class dt extends Vt{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Bt{constructor(n,a,p,y){this.context=n,this.width=a,this.height=p;const x=this.framebuffer=n.gl.createFramebuffer();this.colorAttachment=new jt(n,x),y&&(this.depthAttachment=new Vt(n,x))}destroy(){const n=this.context.gl,a=this.colorAttachment.get();if(a&&n.deleteTexture(a),this.depthAttachment){const p=this.depthAttachment.get();p&&n.deleteRenderbuffer(p)}n.deleteFramebuffer(this.framebuffer)}}class Nn{constructor(n,a=!1){if(this.gl=n,this.isWebGL2=a,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),a){const p=n;this.extVertexArrayObject={createVertexArrayOES:p.createVertexArray.bind(n),deleteVertexArrayOES:p.deleteVertexArray.bind(n),bindVertexArrayOES:p.bindVertexArray.bind(n)}}this.clearColor=new Xt(this),this.clearDepth=new bn(this),this.clearStencil=new Cn(this),this.colorMask=new It(this),this.depthMask=new pe(this),this.stencilMask=new lt(this),this.stencilFunc=new Zt(this),this.stencilOp=new hn(this),this.stencilTest=new Yt(this),this.depthRange=new Ft(this),this.depthTest=new Un(this),this.depthFunc=new Ve(this),this.blend=new Pt(this),this.blendFunc=new Kt(this),this.blendColor=new wn(this),this.blendEquation=new ei(this),this.cullFace=new di(this),this.cullFaceSide=new Lr(this),this.frontFace=new Mi(this),this.program=new Ei(this),this.activeTexture=new fn(this),this.viewport=new Li(this),this.bindFramebuffer=new gn(this),this.bindRenderbuffer=new Fn(this),this.bindTexture=new Jt(this),this.bindVertexBuffer=new Bi(this),this.bindElementBuffer=new ut(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new he(this),this.pixelStoreUnpack=new _e(this),this.pixelStoreUnpackPremultiplyAlpha=new ot(this),this.pixelStoreUnpackFlipY=new yt(this),this.extTextureFilterAnisotropic=n.getExtension("EXT_texture_filter_anisotropic")||n.getExtension("MOZ_EXT_texture_filter_anisotropic")||n.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=n.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=n.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=n.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=n.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),a||(this.extTextureHalfFloat=n.getExtension("OES_texture_half_float")),(a||this.extTextureHalfFloat&&n.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=n.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=a||n.getExtension("OES_standard_derivatives"),this.extTimerQuery=n.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(n,a){return new mt(this,n,a)}createVertexBuffer(n,a,p){return new tt(this,n,a,p)}createRenderbuffer(n,a,p){const y=this.gl,x=y.createRenderbuffer();return this.bindRenderbuffer.set(x),y.renderbufferStorage(y.RENDERBUFFER,n,a,p),this.bindRenderbuffer.set(null),x}createFramebuffer(n,a,p){return new Bt(this,n,a,p)}clear({color:n,depth:a,stencil:p}){const y=this.gl;let x=0;n&&(x|=y.COLOR_BUFFER_BIT,this.clearColor.set(n),this.colorMask.set([!0,!0,!0,!0])),void 0!==a&&(x|=y.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(a),this.depthMask.set(!0)),void 0!==p&&(x|=y.STENCIL_BUFFER_BIT,this.clearStencil.set(p),this.stencilMask.set(255)),y.clear(x)}setCullFace(n){!1===n.enable?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(n.mode),this.frontFace.set(n.frontFace))}setDepthMode(n){n.func!==this.gl.ALWAYS||n.mask?(this.depthTest.set(!0),this.depthFunc.set(n.func),this.depthMask.set(n.mask),this.depthRange.set(n.range)):this.depthTest.set(!1)}setStencilMode(n){n.test.func!==this.gl.ALWAYS||n.mask?(this.stencilTest.set(!0),this.stencilMask.set(n.mask),this.stencilOp.set([n.fail,n.depthFail,n.pass]),this.stencilFunc.set({func:n.test.func,ref:n.ref,mask:n.test.mask})):this.stencilTest.set(!1)}setColorMode(n){B(n.blendFunction,l.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(n.blendFunction),this.blendColor.set(n.blendColor)),this.colorMask.set(n.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Gn extends l.Evented{constructor(n,a,p,y){if(super(),this.id=n,this.dispatcher=p,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,l.extend(this,l.pick(a,["url","scheme","tileSize","promoteId"])),this._options=l.extend({type:"vector"},a),this._collectResourceTiming=a.collectResourceTiming,512!==this.tileSize)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(y),this._tileWorkers={},this._deduped=new l.DedupedRequest}load(n){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"}));const a=Array.isArray(this.map._language)?this.map._language.join():this.map._language,p=this.map._worldview;this._tileJSONRequest=it(this._options,this.map._requestManager,a,p,(y,x)=>{this._tileJSONRequest=null,this._loaded=!0,y?(a&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${a}`),p&&2!==p.length&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${p}`),this.fire(new l.ErrorEvent(y))):x&&(l.extend(this,x),x.bounds&&(this.tileBounds=new Qt(x.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(x.tiles,this.map._requestManager._customAccessToken),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),n&&n(y)})}loaded(){return this._loaded}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}loadTile(n,a){const p=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(p,l.ResourceType.Tile),data:void 0,uid:n.uid,tileID:n.tileID,tileZoom:n.tileZoom,zoom:n.tileID.overscaledZ,tileSize:this.tileSize*n.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:n.isSymbolTile};if(y.request.collectResourceTiming=this._collectResourceTiming,n.actor&&"expired"!==n.state)"loading"===n.state?n.reloadCallback=a:n.request=n.actor.send("reloadTile",y,x.bind(this));else if(n.actor=this._tileWorkers[p]=this._tileWorkers[p]||this.dispatcher.getActor(),this.dispatcher.ready)n.request=n.actor.send("loadTile",y,x.bind(this),void 0,!0);else{const D=l.loadVectorTile.call({deduped:this._deduped},y,(I,R)=>{I||!R?x.call(this,I):(y.data={cacheControl:R.cacheControl,expires:R.expires,rawData:R.rawData.slice(0)},n.actor&&n.actor.send("loadTile",y,x.bind(this),void 0,!0))},!0);n.request={cancel:D}}function x(D,I){return delete n.request,n.aborted?a(null):D&&404!==D.status?a(D):(I&&I.resourceTiming&&(n.resourceTiming=I.resourceTiming),this.map._refreshExpiredTiles&&I&&n.setExpiryData(I),n.loadVectorData(I,this.map.painter),l.cacheEntryPossiblyAdded(this.dispatcher),a(null),void(n.reloadCallback&&(this.loadTile(n,n.reloadCallback),n.reloadCallback=null)))}}abortTile(n){n.request&&(n.request.cancel(),delete n.request),n.actor&&n.actor.send("abortTile",{uid:n.uid,type:this.type,source:this.id})}unloadTile(n){n.unloadVectorData(),n.actor&&n.actor.send("removeTile",{uid:n.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ae extends l.Evented{constructor(n,a,p,y){super(),this.id=n,this.dispatcher=p,this.setEventedParent(y),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=l.extend({type:"raster"},a),l.extend(this,l.pick(a,["url","scheme","tileSize"]))}load(n){this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=it(this._options,this.map._requestManager,null,null,(a,p)=>{this._tileJSONRequest=null,this._loaded=!0,a?this.fire(new l.ErrorEvent(a)):p&&(l.extend(this,p),p.bounds&&(this.tileBounds=new Qt(p.bounds,this.minzoom,this.maxzoom)),l.postTurnstileEvent(p.tiles),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))),n&&n(a)})}loaded(){return this._loaded}onAdd(n){this.map=n,this.load()}reload(){this.cancelTileJSONRequest(),this.load(()=>this.map.style._clearSource(this.id))}setTiles(n){return this._options.tiles=n,this.reload(),this}setUrl(n){return this.url=n,this._options.url=n,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return l.extend({},this._options)}hasTile(n){return!this.tileBounds||this.tileBounds.contains(n.canonical)}loadTile(n,a){const p=l.exported.devicePixelRatio>=2,y=this.map._requestManager.normalizeTileURL(n.tileID.canonical.url(this.tiles,this.scheme),p,this.tileSize);n.request=l.getImage(this.map._requestManager.transformRequest(y,l.ResourceType.Tile),(x,D,I,R)=>(delete n.request,n.aborted?(n.state="unloaded",a(null)):x?(n.state="errored",a(x)):D?(this.map._refreshExpiredTiles&&n.setExpiryData({cacheControl:I,expires:R}),n.setTexture(D,this.map.painter),n.state="loaded",l.cacheEntryPossiblyAdded(this.dispatcher),void a(null)):a(null)))}static loadTileData(n,a,p){n.setTexture(a,p)}static unloadTileData(n,a){n.texture&&a.saveTileTexture(n.texture)}abortTile(n,a){n.request&&(n.request.cancel(),delete n.request),a()}unloadTile(n,a){n.texture&&this.map.painter.saveTileTexture(n.texture),a()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function ft(u,n,a,p,y,x,D,I){const R=[u,a,y,n,p,x,1,1,1],U=[D,I,1],z=l.adjoint([],R),[Q,Se,je]=l.transformMat3(U,U,l.transpose(z,z));return l.multiply$1(R,[Q,0,0,0,Se,0,0,0,je],R)}class Z extends l.Evented{constructor(n,a,p,y){super(),this.id=n,this.dispatcher=p,this.coordinates=a.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(y),this.options=a,this._dirty=!1}load(n,a){this._loaded=a||!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=l.getImage(this.map._requestManager.transformRequest(this.url,l.ResourceType.Image),(p,y)=>{if(this._imageRequest=null,this._loaded=!0,p)this.fire(new l.ErrorEvent(p));else if(y){const{HTMLImageElement:x}=l.window;this.image=y instanceof x?l.exported.getImageData(y):y,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,n&&(this.coordinates=n),this._finishLoading()}})}loaded(){return this._loaded}updateImage(n){return this.image&&n.url?(this._imageRequest&&n.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=n.url,this.load(n.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(n){this.map=n,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(n){this.coordinates=n,this._boundsArray=void 0;const a=n.map(l.MercatorCoordinate.fromLngLat);return this.tileID=function(p){let y=1/0,x=1/0,D=-1/0,I=-1/0;for(const Q of p)y=Math.min(y,Q.x),x=Math.min(x,Q.y),D=Math.max(D,Q.x),I=Math.max(I,Q.y);const R=Math.max(D-y,I-x),U=Math.max(0,Math.floor(-Math.log(R)/Math.LN2)),z=Math.pow(2,U);return new l.CanonicalTileID(U,Math.floor((y+D)/2*z),Math.floor((x+I)/2*z))}(a),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(n){for(const R in this.tiles){const U=this.tiles[R];"loaded"!==U.state&&(U.state="loaded",U.texture=this.texture)}if(this._boundsArray)return;const a=l.tileTransform(this.tileID,this.map.transform.projection),[p,y,x,D]=this.coordinates.map(R=>{const U=a.projection.project(R[0],R[1]);return l.getTilePoint(a,U)._round()});this.perspectiveTransform=function(R,U,z,Q,Se,je,Ye,$e,et,ne){const He=ft(0,0,R,0,0,U,R,U),ht=ft(z,Q,Se,je,Ye,$e,et,ne);return l.multiply$1(ht,l.adjoint(He,He),ht),[ht[6]/ht[8]*R/l.EXTENT,ht[7]/ht[8]*U/l.EXTENT]}(this.width,this.height,p.x,p.y,y.x,y.y,D.x,D.y,x.x,x.y);const I=this._boundsArray=new l.StructArrayLayout4i8;I.emplaceBack(p.x,p.y,0,0),I.emplaceBack(y.x,y.y,l.EXTENT,0),I.emplaceBack(D.x,D.y,0,l.EXTENT),I.emplaceBack(x.x,x.y,l.EXTENT,l.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=n.createVertexBuffer(I,l.boundsAttributes.members),this.boundsSegments=l.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(0===Object.keys(this.tiles).length||!this.image)return;const n=this.map.painter.context,a=n.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new l.Texture(n,this.image,a.RGBA),this.texture.bind(a.LINEAR,a.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(n)}loadTile(n,a){this.tileID&&this.tileID.equals(n.tileID.canonical)?(this.tiles[String(n.tileID.wrap)]=n,n.buckets={},a(null)):(n.state="errored",a(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const Re={vector:Gn,raster:ae,"raster-dem":class extends ae{constructor(u,n,a,p){super(u,n,a,p),this.type="raster-dem",this.maxzoom=22,this._options=l.extend({type:"raster-dem"},n),this.encoding=n.encoding||"mapbox"}loadTile(u,n){const a=this.map._requestManager.normalizeTileURL(u.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function p(y,x){y&&(u.state="errored",n(y)),x&&(u.dem=x,u.dem.onDeserialize(),u.needsHillshadePrepare=!0,u.needsDEMTextureUpload=!0,u.state="loaded",n(null))}u.request=l.getImage(this.map._requestManager.transformRequest(a,l.ResourceType.Tile),function(y,x,D,I){if(delete u.request,u.aborted)u.state="unloaded",n(null);else if(y)u.state="errored",n(y);else if(x){this.map._refreshExpiredTiles&&u.setExpiryData({cacheControl:D,expires:I});const R=l.window.ImageBitmap&&x instanceof l.window.ImageBitmap&&(null==dr&&(dr=l.window.OffscreenCanvas&&new l.window.OffscreenCanvas(1,1).getContext("2d")&&"function"==typeof l.window.createImageBitmap),dr),U=1-(x.width-l.prevPowerOfTwo(x.width))/2;U<1||u.neighboringTiles||(u.neighboringTiles=this._getNeighboringTiles(u.tileID));const z=R?x:l.exported.getImageData(x,U),Q={uid:u.uid,coord:u.tileID,source:this.id,rawImageData:z,encoding:this.encoding,padding:U};u.actor&&"expired"!==u.state||(u.actor=this.dispatcher.getActor(),u.actor.send("loadDEMTile",Q,p.bind(this),void 0,!0))}}.bind(this))}_getNeighboringTiles(u){const n=u.canonical,a=Math.pow(2,n.z),p=(n.x-1+a)%a,y=0===n.x?u.wrap-1:u.wrap,x=(n.x+1+a)%a,D=n.x+1===a?u.wrap+1:u.wrap,I={};return I[new l.OverscaledTileID(u.overscaledZ,y,n.z,p,n.y).key]={backfilled:!1},I[new l.OverscaledTileID(u.overscaledZ,D,n.z,x,n.y).key]={backfilled:!1},n.y>0&&(I[new l.OverscaledTileID(u.overscaledZ,y,n.z,p,n.y-1).key]={backfilled:!1},I[new l.OverscaledTileID(u.overscaledZ,u.wrap,n.z,n.x,n.y-1).key]={backfilled:!1},I[new l.OverscaledTileID(u.overscaledZ,D,n.z,x,n.y-1).key]={backfilled:!1}),n.y+1<a&&(I[new l.OverscaledTileID(u.overscaledZ,y,n.z,p,n.y+1).key]={backfilled:!1},I[new l.OverscaledTileID(u.overscaledZ,u.wrap,n.z,n.x,n.y+1).key]={backfilled:!1},I[new l.OverscaledTileID(u.overscaledZ,D,n.z,x,n.y+1).key]={backfilled:!1}),I}unloadTile(u){u.demTexture&&this.map.painter.saveTileTexture(u.demTexture),u.fbo&&(u.fbo.destroy(),delete u.fbo),u.dem&&delete u.dem,delete u.neighboringTiles,u.state="unloaded"}},geojson:class extends l.Evented{constructor(u,n,a,p){super(),this.id=u,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=a.getActor(),this.setEventedParent(p),this._data=n.data,this._options=l.extend({},n),this._collectResourceTiming=n.collectResourceTiming,void 0!==n.maxzoom&&(this.maxzoom=n.maxzoom),n.type&&(this.type=n.type),n.attribution&&(this.attribution=n.attribution),this.promoteId=n.promoteId;const y=l.EXTENT/this.tileSize;this.workerOptions=l.extend({source:this.id,cluster:n.cluster||!1,geojsonVtOptions:{buffer:(void 0!==n.buffer?n.buffer:128)*y,tolerance:(void 0!==n.tolerance?n.tolerance:.375)*y,extent:l.EXTENT,maxZoom:this.maxzoom,lineMetrics:n.lineMetrics||!1,generateId:n.generateId||!1},superclusterOptions:{maxZoom:void 0!==n.clusterMaxZoom?n.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,n.clusterMinPoints||2),extent:l.EXTENT,radius:(void 0!==n.clusterRadius?n.clusterRadius:50)*y,log:!1,generateId:n.generateId||!1},clusterProperties:n.clusterProperties,filter:n.filter},n.workerOptions)}onAdd(u){this.map=u,this.setData(this._data)}setData(u){return this._data=u,this._updateWorkerData(),this}getClusterExpansionZoom(u,n){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:u,source:this.id},n),this}getClusterChildren(u,n){return this.actor.send("geojson.getClusterChildren",{clusterId:u,source:this.id},n),this}getClusterLeaves(u,n,a,p){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:u,limit:n,offset:a},p),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new l.Event("dataloading",{dataType:"source"})),this._loaded=!1;const u=l.extend({},this.workerOptions),n=this._data;"string"==typeof n?(u.request=this.map._requestManager.transformRequest(l.exported.resolveURL(n),l.ResourceType.Source),u.request.collectResourceTiming=this._collectResourceTiming):u.data=JSON.stringify(n),this._pendingLoad=this.actor.send(`${this.type}.loadData`,u,(a,p)=>{if(this._loaded=!0,this._pendingLoad=null,a)this.fire(new l.ErrorEvent(a));else{const y={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&p&&p.resourceTiming&&p.resourceTiming[this.id]&&(y.resourceTiming=p.resourceTiming[this.id]),this.fire(new l.Event("data",y)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)})}loaded(){return this._loaded}loadTile(u,n){const a=u.actor?"reloadTile":"loadTile";u.actor=this.actor,u.request=this.actor.send(a,{type:this.type,uid:u.uid,tileID:u.tileID,tileZoom:u.tileZoom,zoom:u.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:l.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},(p,y)=>(delete u.request,u.unloadVectorData(),u.aborted?n(null):p?n(p):(u.loadVectorData(y,this.map.painter,"reloadTile"===a),n(null))),void 0,"loadTile"===a)}abortTile(u){u.request&&(u.request.cancel(),delete u.request),u.aborted=!0}unloadTile(u){u.unloadVectorData(),this.actor.send("removeTile",{uid:u.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return l.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends Z{constructor(u,n,a,p){super(u,n,a,p),this.roundZoom=!0,this.type="video",this.options=n}load(){this._loaded=!1;const u=this.options;this.urls=[];for(const n of u.urls)this.urls.push(this.map._requestManager.transformRequest(n,l.ResourceType.Source).url);l.getVideo(this.urls,(n,a)=>{this._loaded=!0,n?this.fire(new l.ErrorEvent(n)):a&&(this.video=a,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(u){if(this.video){const n=this.video.seekable;u<n.start(0)||u>n.end(0)?this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${n.start(0)} and ${n.end(0)}-second mark.`))):this.video.currentTime=u}}getVideo(){return this.video}onAdd(u){this.map||(this.map=u,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(0===Object.keys(this.tiles).length||this.video.readyState<2)return;const u=this.map.painter.context,n=u.gl;this.texture?this.video.paused||(this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,this.video)):(this.texture=new l.Texture(u,this.video,n.RGBA),this.texture.bind(n.LINEAR,n.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(u)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:Z,canvas:class extends Z{constructor(u,n,a,p){super(u,n,a,p),n.coordinates?Array.isArray(n.coordinates)&&4===n.coordinates.length&&!n.coordinates.some(y=>!Array.isArray(y)||2!==y.length||y.some(x=>"number"!=typeof x))||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${u}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${u}`,null,'missing required property "coordinates"'))),n.animate&&"boolean"!=typeof n.animate&&this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${u}`,null,'optional "animate" property must be a boolean value'))),n.canvas?"string"==typeof n.canvas||n.canvas instanceof l.window.HTMLCanvasElement||this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${u}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new l.ErrorEvent(new l.ValidationError(`sources.${u}`,null,'missing required property "canvas"'))),this.options=n,this.animate=void 0===n.animate||n.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof l.window.HTMLCanvasElement?this.options.canvas:l.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new l.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(u){this.map=u,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let u=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,u=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,u=!0),this._hasInvalidDimensions()||0===Object.keys(this.tiles).length)return;const n=this.map.painter.context;this.texture?(u||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new l.Texture(n,this.canvas,n.gl.RGBA,{premultiply:!0}),this._prepareData(n)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const u of[this.canvas.width,this.canvas.height])if(isNaN(u)||u<=0)return!0;return!1}},custom:class extends l.Evented{constructor(u,n,a,p){super(),this.id=u,this.type="custom",this._dataType="raster",this._dispatcher=a,this._implementation=n,this.setEventedParent(p),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new l.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new l.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Qt(this._implementation.bounds,this.minzoom,this.maxzoom)),n.update=this._update.bind(this),n.clearTiles=this._clearTiles.bind(this),n.coveringTiles=this._coveringTiles.bind(this),l.extend(this,l.pick(n,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return l.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new l.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(u){this._map=u,this._loaded=!1,this.fire(new l.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(u),this.load()}onRemove(u){this._implementation.onRemove&&this._implementation.onRemove(u)}hasTile(u){if(this._implementation.hasTile){const{x:n,y:a,z:p}=u.canonical;return this._implementation.hasTile({x:n,y:a,z:p})}return!this.tileBounds||this.tileBounds.contains(u.canonical)}loadTile(u,n){const{x:a,y:p,z:y}=u.tileID.canonical,x=new l.window.AbortController;u.request=Promise.resolve(this._implementation.loadTile({x:a,y:p,z:y},{signal:x.signal})).then(function(D){return delete u.request,u.aborted?(u.state="unloaded",n(null)):void 0===D?(u.state="errored",n(null)):null===D?(this.loadTileData(u,{width:this.tileSize,height:this.tileSize,data:null}),u.state="loaded",n(null)):(I=D)instanceof l.window.ImageData||I instanceof l.window.HTMLCanvasElement||I instanceof l.window.ImageBitmap||I instanceof l.window.HTMLImageElement?(this.loadTileData(u,D),u.state="loaded",void n(null)):(u.state="errored",n(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)));var I}.bind(this)).catch(D=>{20!==D.code&&(u.state="errored",n(D))}),u.request.cancel=()=>x.abort()}loadTileData(u,n){ae.loadTileData(u,n,this._map.painter)}unloadTileData(u){ae.unloadTileData(u,this._map.painter)}unloadTile(u,n){if(this.unloadTileData(u),this._implementation.unloadTile){const{x:a,y:p,z:y}=u.tileID.canonical;this._implementation.unloadTile({x:a,y:p,z:y})}n()}abortTile(u,n){u.request&&u.request.cancel&&(u.request.cancel(),delete u.request),n()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(u=>({x:u.canonical.x,y:u.canonical.y,z:u.canonical.z}))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new l.Event("data",{dataType:"source",sourceDataType:"content"}))}}},st=function(u,n,a,p){const y=new Re[n.type](u,n,a,p);if(y.id!==u)throw new Error(`Expected Source id to be ${u} instead of ${y.id}`);return l.bindAll(["load","abort","unload","serialize","prepare"],y),y};function on(u,n){const a=l.identity([]);return l.scale(a,a,[.5*u.width,.5*-u.height,1]),l.translate(a,a,[1,-1,0]),l.multiply(a,a,u.calculateProjMatrix(n.toUnwrapped())),Float32Array.from(a)}function In(u,n,a,p,y,x,D,I=!1){const R=u.tilesIn(p,D,I);R.sort(wi);const U=[];for(const Q of R)U.push({wrappedTileID:Q.tile.tileID.wrapped().key,queryResults:Q.tile.queryRenderedFeatures(n,a,u._state,Q,y,x,on(u.transform,Q.tile.tileID),I)});const z=function(Q){const Se={},je={};for(const Ye of Q){const $e=Ye.queryResults,et=Ye.wrappedTileID,ne=je[et]=je[et]||{};for(const He in $e){const ht=$e[He],gt=ne[He]=ne[He]||{},Ot=Se[He]=Se[He]||[];for(const kt of ht)gt[kt.featureIndex]||(gt[kt.featureIndex]=!0,Ot.push(kt))}}return Se}(U);for(const Q in z)z[Q].forEach(Se=>{const je=Se.feature,Ye=je.layer;Ye&&"background"!==Ye.type&&"sky"!==Ye.type&&(je.source=Ye.source,Ye["source-layer"]&&(je.sourceLayer=Ye["source-layer"]),je.state=void 0!==je.id?u.getFeatureState(Ye["source-layer"],je.id):{})});return z}function bi(u,n){const a=u.getRenderableIds().map(x=>u.getTileByID(x)),p=[],y={};for(let x=0;x<a.length;x++){const D=a[x],I=D.tileID.canonical.key;y[I]||(y[I]=!0,D.querySourceFeatures(p,n))}return p}function wi(u,n){const a=u.tileID,p=n.tileID;return a.overscaledZ-p.overscaledZ||a.canonical.y-p.canonical.y||a.wrap-p.wrap||a.canonical.x-p.canonical.x}function Ri(){return null!=S.workerClass?new S.workerClass:new l.window.Worker(S.workerUrl)}const mr="mapboxgl_preloaded_worker_pool";class Xi{constructor(){this.active={}}acquire(n){if(!this.workers)for(this.workers=[];this.workers.length<Xi.workerCount;)this.workers.push(new Ri);return this.active[n]=!0,this.workers.slice()}release(n){delete this.active[n],0===this.numActive()&&(this.workers.forEach(a=>{a.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[mr]}numActive(){return Object.keys(this.active).length}}let Ar;function uo(){return Ar||(Ar=new Xi),Ar}function _o(u,n){const a={};for(const p in u)"ref"!==p&&(a[p]=u[p]);return l.refProperties.forEach(p=>{p in n&&(a[p]=n[p])}),a}function Eo(u){u=u.slice();const n=Object.create(null);for(let a=0;a<u.length;a++)n[u[a].id]=u[a];for(let a=0;a<u.length;a++)"ref"in u[a]&&(u[a]=_o(u[a],n[u[a].ref]));return u}Xi.workerCount=2;const zi={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function hr(u,n,a){a.push({command:zi.addSource,args:[u,n[u]]})}function Ti(u,n,a){n.push({command:zi.removeSource,args:[u]}),a[u]=!0}function yo(u,n,a,p){Ti(u,a,p),hr(u,n,a)}function vr(u,n,a){let p;for(p in u[a])if(u[a].hasOwnProperty(p)&&"data"!==p&&!B(u[a][p],n[a][p]))return!1;for(p in n[a])if(n[a].hasOwnProperty(p)&&"data"!==p&&!B(u[a][p],n[a][p]))return!1;return!0}function Vr(u,n,a,p,y,x){let D;for(D in n=n||{},u=u||{})u.hasOwnProperty(D)&&(B(u[D],n[D])||a.push({command:x,args:[p,D,n[D],y]}));for(D in n)n.hasOwnProperty(D)&&!u.hasOwnProperty(D)&&(B(u[D],n[D])||a.push({command:x,args:[p,D,n[D],y]}))}function Yr(u){return u.id}function qi(u,n){return u[n.id]=n,u}class Qe{constructor(n,a){this.reset(n,a)}reset(n,a){this.points=n||[],this._distances=[0];for(let p=1;p<this.points.length;p++)this._distances[p]=this._distances[p-1]+this.points[p].dist(this.points[p-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(a||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(n){if(1===this.points.length)return this.points[0];n=l.clamp(n,0,1);let a=1,p=this._distances[a];const y=n*this.paddedLength+this.padding;for(;p<y&&a<this._distances.length;)p=this._distances[++a];const x=a-1,D=this._distances[x],I=p-D,R=I>0?(y-D)/I:0;return this.points[x].mult(1-R).add(this.points[a].mult(R))}}class Tt{constructor(n,a,p){const y=this.boxCells=[],x=this.circleCells=[];this.xCellCount=Math.ceil(n/p),this.yCellCount=Math.ceil(a/p);for(let D=0;D<this.xCellCount*this.yCellCount;D++)y.push([]),x.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=n,this.height=a,this.xScale=this.xCellCount/n,this.yScale=this.yCellCount/a,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(n,a,p,y,x){this._forEachCell(a,p,y,x,this._insertBoxCell,this.boxUid++),this.boxKeys.push(n),this.bboxes.push(a),this.bboxes.push(p),this.bboxes.push(y),this.bboxes.push(x)}insertCircle(n,a,p,y){this._forEachCell(a-y,p-y,a+y,p+y,this._insertCircleCell,this.circleUid++),this.circleKeys.push(n),this.circles.push(a),this.circles.push(p),this.circles.push(y)}_insertBoxCell(n,a,p,y,x,D){this.boxCells[x].push(D)}_insertCircleCell(n,a,p,y,x,D){this.circleCells[x].push(D)}_query(n,a,p,y,x,D){if(p<0||n>this.width||y<0||a>this.height)return!x&&[];const I=[];if(n<=0&&a<=0&&this.width<=p&&this.height<=y){if(x)return!0;for(let R=0;R<this.boxKeys.length;R++)I.push({key:this.boxKeys[R],x1:this.bboxes[4*R],y1:this.bboxes[4*R+1],x2:this.bboxes[4*R+2],y2:this.bboxes[4*R+3]});for(let R=0;R<this.circleKeys.length;R++){const U=this.circles[3*R],z=this.circles[3*R+1],Q=this.circles[3*R+2];I.push({key:this.circleKeys[R],x1:U-Q,y1:z-Q,x2:U+Q,y2:z+Q})}return D?I.filter(D):I}return this._forEachCell(n,a,p,y,this._queryCell,I,{hitTest:x,seenUids:{box:{},circle:{}}},D),x?I.length>0:I}_queryCircle(n,a,p,y,x){const D=n-p,I=n+p,R=a-p,U=a+p;if(I<0||D>this.width||U<0||R>this.height)return!y&&[];const z=[];return this._forEachCell(D,R,I,U,this._queryCellCircle,z,{hitTest:y,circle:{x:n,y:a,radius:p},seenUids:{box:{},circle:{}}},x),y?z.length>0:z}query(n,a,p,y,x){return this._query(n,a,p,y,!1,x)}hitTest(n,a,p,y,x){return this._query(n,a,p,y,!0,x)}hitTestCircle(n,a,p,y){return this._queryCircle(n,a,p,!0,y)}_queryCell(n,a,p,y,x,D,I,R){const U=I.seenUids,z=this.boxCells[x];if(null!==z){const Se=this.bboxes;for(const je of z)if(!U.box[je]){U.box[je]=!0;const Ye=4*je;if(n<=Se[Ye+2]&&a<=Se[Ye+3]&&p>=Se[Ye+0]&&y>=Se[Ye+1]&&(!R||R(this.boxKeys[je]))){if(I.hitTest)return D.push(!0),!0;D.push({key:this.boxKeys[je],x1:Se[Ye],y1:Se[Ye+1],x2:Se[Ye+2],y2:Se[Ye+3]})}}}const Q=this.circleCells[x];if(null!==Q){const Se=this.circles;for(const je of Q)if(!U.circle[je]){U.circle[je]=!0;const Ye=3*je;if(this._circleAndRectCollide(Se[Ye],Se[Ye+1],Se[Ye+2],n,a,p,y)&&(!R||R(this.circleKeys[je]))){if(I.hitTest)return D.push(!0),!0;{const $e=Se[Ye],et=Se[Ye+1],ne=Se[Ye+2];D.push({key:this.circleKeys[je],x1:$e-ne,y1:et-ne,x2:$e+ne,y2:et+ne})}}}}}_queryCellCircle(n,a,p,y,x,D,I,R){const U=I.circle,z=I.seenUids,Q=this.boxCells[x];if(null!==Q){const je=this.bboxes;for(const Ye of Q)if(!z.box[Ye]){z.box[Ye]=!0;const $e=4*Ye;if(this._circleAndRectCollide(U.x,U.y,U.radius,je[$e+0],je[$e+1],je[$e+2],je[$e+3])&&(!R||R(this.boxKeys[Ye])))return D.push(!0),!0}}const Se=this.circleCells[x];if(null!==Se){const je=this.circles;for(const Ye of Se)if(!z.circle[Ye]){z.circle[Ye]=!0;const $e=3*Ye;if(this._circlesCollide(je[$e],je[$e+1],je[$e+2],U.x,U.y,U.radius)&&(!R||R(this.circleKeys[Ye])))return D.push(!0),!0}}}_forEachCell(n,a,p,y,x,D,I,R){const U=this._convertToXCellCoord(n),z=this._convertToYCellCoord(a),Q=this._convertToXCellCoord(p),Se=this._convertToYCellCoord(y);for(let je=U;je<=Q;je++)for(let Ye=z;Ye<=Se;Ye++)if(x.call(this,n,a,p,y,this.xCellCount*Ye+je,D,I,R))return}_convertToXCellCoord(n){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(n*this.xScale)))}_convertToYCellCoord(n){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(n*this.yScale)))}_circlesCollide(n,a,p,y,x,D){const I=y-n,R=x-a,U=p+D;return U*U>I*I+R*R}_circleAndRectCollide(n,a,p,y,x,D,I){const R=(D-y)/2,U=Math.abs(n-(y+R));if(U>R+p)return!1;const z=(I-x)/2,Q=Math.abs(a-(x+z));if(Q>z+p)return!1;if(U<=R||Q<=z)return!0;const Se=U-R,je=Q-z;return Se*Se+je*je<=p*p}}const Et={unknown:0,flipRequired:1,flipNotRequired:2},ln=Math.tan(85*Math.PI/180);function vt(u,n,a,p,y,x,D){const I=l.create();if(a)if("globe"===x.name){const R=l.calculateGlobeLabelMatrix(y,n);l.multiply(I,I,R)}else{const R=ye([],D);I[0]=R[0],I[1]=R[1],I[4]=R[2],I[5]=R[3],p||l.rotateZ(I,I,y.angle)}else l.multiply(I,y.labelPlaneMatrix,u);return I}function Hn(u,n,a,p,y,x,D){const I=vt(u,n,a,p,y,x,D);return"globe"===x.name&&a||(I[2]=I[6]=I[10]=I[14]=0),I}function On(u,n,a,p,y,x,D){if(a){if("globe"===x.name){const I=vt(u,n,a,p,y,x,D);return l.invert(I,I),l.multiply(I,u,I),I}{const I=l.clone(u),R=l.identity([]);return R[0]=D[0],R[1]=D[1],R[4]=D[2],R[5]=D[3],l.multiply(I,I,R),p||l.rotateZ(I,I,-y.angle),I}}return y.glCoordMatrix}function Kn(u,n,a,p){const y=[u,n,a,1];a?l.transformMat4$1(y,y,p):en(y,y,p);const x=y[3];return y[0]/=x,y[1]/=x,y[2]/=x,y}function pi(u,n){return Math.min(.5+u/n*.5,1.5)}function ki(u,n){const a=u[0]/u[3],p=u[1]/u[3];return a>=-n[0]&&a<=n[0]&&p>=-n[1]&&p<=n[1]}function rr(u,n,a,p,y,x,D,I,R,U){const z=a.transform,Q=p?u.textSizeData:u.iconSizeData,Se=l.evaluateSizeForZoom(Q,a.transform.zoom),je="globe"===z.projection.name,Ye=[256/a.width*2+1,256/a.height*2+1],$e=p?u.text.dynamicLayoutVertexArray:u.icon.dynamicLayoutVertexArray;$e.clear();let et=null;je&&(et=p?u.text.globeExtVertexArray:u.icon.globeExtVertexArray);const ne=u.lineVertexArray,He=p?u.text.placedSymbolArray:u.icon.placedSymbolArray,ht=a.transform.width/a.transform.height;let gt,Ot=!1;for(let kt=0;kt<He.length;kt++){const Lt=He.get(kt),{numGlyphs:qt,writingMode:$t}=Lt;if($t!==l.WritingMode.vertical||Ot||gt===l.WritingMode.horizontal||(Ot=!0),gt=$t,(Lt.hidden||$t===l.WritingMode.vertical)&&!Ot){St(qt,$e);continue}Ot=!1;const cn=new l.Point(Lt.tileAnchorX,Lt.tileAnchorY);let{x:Wn,y:nn,z:Mn}=z.projection.projectTilePoint(cn.x,cn.y,U.canonical);if(R){const[$i,mi,Oi]=R(cn);Wn+=$i,nn+=mi,Mn+=Oi}const pn=[Wn,nn,Mn,1];if(l.transformMat4$1(pn,pn,n),!ki(pn,Ye)){St(qt,$e);continue}const qn=pi(a.transform.cameraToCenterDistance,pn[3]),sn=l.evaluateSizeForFeature(Q,Se,Lt),An=D?sn/qn:sn*qn,Zn=Kn(Wn,nn,Mn,y);if(Zn[3]<=0){St(qt,$e);continue}let kn={};const ti=D?null:R,Ii=Ee(Lt,An,!1,I,n,y,x,u.glyphOffsetArray,ne,$e,et,Zn,cn,kn,ht,ti,z.projection,U,D);Ot=Ii.useVertical,ti&&Ii.needsFlipping&&(kn={}),(Ii.notEnoughRoom||Ot||Ii.needsFlipping&&Ee(Lt,An,!0,I,n,y,x,u.glyphOffsetArray,ne,$e,et,Zn,cn,kn,ht,ti,z.projection,U,D).notEnoughRoom)&&St(qt,$e)}p?(u.text.dynamicLayoutVertexBuffer.updateData($e),et&&u.text.globeExtVertexBuffer.updateData(et)):(u.icon.dynamicLayoutVertexBuffer.updateData($e),et&&u.icon.globeExtVertexBuffer.updateData(et))}function _i(u,n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e){const{lineStartIndex:et,glyphStartIndex:ne,segment:He}=I,ht=ne+I.numGlyphs,gt=et+I.lineLength,Ot=n.getoffsetX(ne),kt=n.getoffsetX(ht-1),Lt=qe(u*Ot,a,p,y,x,D,He,et,gt,R,U,z,Q,Se,!0,je,Ye,$e);if(!Lt)return null;const qt=qe(u*kt,a,p,y,x,D,He,et,gt,R,U,z,Q,Se,!0,je,Ye,$e);return qt?{first:Lt,last:qt}:null}function or(u,n,a,p){return u===l.WritingMode.horizontal&&Math.abs(p)>Math.abs(a)?{useVertical:!0}:u===l.WritingMode.vertical?p>0?{needsFlipping:!0}:null:n!==Et.unknown&&(0===(y=a)||Math.abs(p/y)>ln)?n===Et.flipRequired?{needsFlipping:!0}:null:a<0?{needsFlipping:!0}:null;var y}function Ee(u,n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e,et,ne,He){const ht=n/24,gt=u.lineOffsetX*ht,Ot=u.lineOffsetY*ht,{lineStartIndex:kt,glyphStartIndex:Lt,numGlyphs:qt,segment:$t,writingMode:cn,flipState:Wn}=u,nn=kt+u.lineLength,Mn=pn=>{if(z){const[Zn,kn,ti]=pn.up,Ii=U.length;l.updateGlobeVertexNormal(z,Ii+0,Zn,kn,ti),l.updateGlobeVertexNormal(z,Ii+1,Zn,kn,ti),l.updateGlobeVertexNormal(z,Ii+2,Zn,kn,ti),l.updateGlobeVertexNormal(z,Ii+3,Zn,kn,ti)}const[qn,sn,An]=pn.point;l.addDynamicAttributes(U,qn,sn,An,pn.angle)};if(qt>1){const pn=_i(ht,I,gt,Ot,a,Q,Se,u,R,x,je,$e,!1,et,ne,He);if(!pn)return{notEnoughRoom:!0};if(p&&!a){let[qn,sn,An]=pn.first.point,[Zn,kn,ti]=pn.last.point;[qn,sn]=Kn(qn,sn,An,D),[Zn,kn]=Kn(Zn,kn,ti,D);const Ii=or(cn,Wn,(Zn-qn)*Ye,kn-sn);if(u.flipState=Ii&&Ii.needsFlipping?Et.flipRequired:Et.flipNotRequired,Ii)return Ii}Mn(pn.first);for(let qn=Lt+1;qn<Lt+qt-1;qn++){const sn=qe(ht*I.getoffsetX(qn),gt,Ot,a,Q,Se,$t,kt,nn,R,x,je,$e,!1,!1,et,ne,He);if(!sn)return U.length-=4*(qn-Lt),{notEnoughRoom:!0};Mn(sn)}Mn(pn.last)}else{if(p&&!a){const qn=Kn(Se.x,Se.y,0,y),sn=kt+$t+1,An=new l.Point(R.getx(sn),R.gety(sn)),Zn=Kn(An.x,An.y,0,y),kn=Zn[3]>0?Zn:ee(Se,An,qn,1,y,void 0,et,ne.canonical),ti=or(cn,Wn,(kn[0]-qn[0])*Ye,kn[1]-qn[1]);if(u.flipState=ti&&ti.needsFlipping?Et.flipRequired:Et.flipNotRequired,ti)return ti}const pn=qe(ht*I.getoffsetX(Lt),gt,Ot,a,Q,Se,$t,kt,nn,R,x,je,$e,!1,!1,et,ne,He);if(!pn)return{notEnoughRoom:!0};Mn(pn)}return{}}function Be(u,n,a,p,y){const{x,y:D,z:I}=p.projectTilePoint(u.x,u.y,n);if(!y)return Kn(x,D,I,a);const[R,U,z]=y(u);return Kn(x+R,D+U,I+z,a)}function ee(u,n,a,p,y,x,D,I){const R=Be(u.sub(n)._unit()._add(u),I,y,D,x);return l.sub(R,a,R),l.normalize(R,R),l.scaleAndAdd(R,a,R,p)}function qe(u,n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e,et,ne){const He=p?u-n:u+n;let ht=He>0?1:-1,gt=0;p&&(ht*=-1,gt=Math.PI),ht<0&&(gt+=Math.PI);let Ot=I+D+(ht>0?0:1)|0,kt=y,Lt=y,qt=0,$t=0;const cn=Math.abs(He),Wn=[],nn=[];let Mn=x,pn=Mn;const qn=()=>ee(pn,Mn,Lt,cn-qt+1,z,Se,$e,et.canonical);for(;qt+$t<=cn;){if(Ot+=ht,Ot<I||Ot>=R)return null;if(Lt=kt,pn=Mn,Wn.push(Lt),je&&nn.push(pn),Mn=new l.Point(U.getx(Ot),U.gety(Ot)),kt=Q[Ot],!kt){const Oi=Be(Mn,et.canonical,z,$e,Se);kt=Oi[3]>0?Q[Ot]=Oi:qn()}qt+=$t,$t=l.distance(Lt,kt)}Ye&&Se&&(Q[Ot]&&(kt=qn(),$t=l.distance(Lt,kt)),Q[Ot]=kt);const sn=(cn-qt)/$t,An=Mn.sub(pn)._mult(sn)._add(pn),Zn=l.sub([],kt,Lt),kn=l.scaleAndAdd([],Lt,Zn,sn);let ti=[0,0,1],Ii=Zn[0],$i=Zn[1];if(ne&&(ti=$e.upVector(et.canonical,An.x,An.y),0!==ti[0]||0!==ti[1]||1!==ti[2])){const Oi=[ti[2],0,-ti[0]],cr=l.cross([],ti,Oi);l.normalize(Oi,Oi),l.normalize(cr,cr),Ii=l.dot(Zn,Oi),$i=l.dot(Zn,cr)}if(a){const Oi=l.cross([],ti,Zn);l.normalize(Oi,Oi),l.scaleAndAdd(kn,kn,Oi,a*ht)}const mi=gt+Math.atan2($i,Ii);return Wn.push(kn),je&&nn.push(An),{point:kn,angle:mi,path:Wn,tilePath:nn,up:ti}}function St(u,n){const a=n.length,p=a+4*u;n.resize(p),n.float32.fill(-1/0,4*a,4*p)}function en(u,n,a){const p=n[0],y=n[1];return u[0]=a[0]*p+a[4]*y+a[12],u[1]=a[1]*p+a[5]*y+a[13],u[3]=a[3]*p+a[7]*y+a[15],u}const jn=100;class V{constructor(n,a,p=new Tt(n.width+200,n.height+200,25),y=new Tt(n.width+200,n.height+200,25)){this.transform=n,this.grid=p,this.ignoredGrid=y,this.pitchfactor=Math.cos(n._pitch)*n.cameraToCenterDistance,this.screenRightBoundary=n.width+jn,this.screenBottomBoundary=n.height+jn,this.gridRightBoundary=n.width+200,this.gridBottomBoundary=n.height+200,this.fogState=a}placeCollisionBox(n,a,p,y,x,D,I,R){let U=p.projectedAnchorX,z=p.projectedAnchorY,Q=p.projectedAnchorZ;const Se=p.elevation,je=p.tileID,Ye=n.getProjection();if(Se&&je){const[kt,Lt,qt]=Ye.upVector(je.canonical,p.tileAnchorX,p.tileAnchorY),$t=Ye.upVectorScale(je.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;U+=kt*Se*$t,z+=Lt*Se*$t,Q+=qt*Se*$t}const $e=this.projectAndGetPerspectiveRatio(I,U,z,Q,p.tileID,"globe"===Ye.name||!!Se||this.transform.pitch>0,Ye),et=D*$e.perspectiveRatio,ne=(p.x1*a+y.x-p.padding)*et+$e.point.x,He=(p.y1*a+y.y-p.padding)*et+$e.point.y,ht=(p.x2*a+y.x+p.padding)*et+$e.point.x,gt=(p.y2*a+y.y+p.padding)*et+$e.point.y,Ot=$e.perspectiveRatio<=.55||$e.occluded;return!this.isInsideGrid(ne,He,ht,gt)||!x&&this.grid.hitTest(ne,He,ht,gt,R)||Ot?{box:[],offscreen:!1,occluded:$e.occluded}:{box:[ne,He,ht,gt],offscreen:this.isOffscreen(ne,He,ht,gt),occluded:!1}}placeCollisionCircles(n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e){const et=[],ne=this.transform.elevation,He=n.getProjection(),ht=ne?ne.getAtTileOffsetFunc($e,this.transform.center.lat,this.transform.worldSize,He):null,gt=new l.Point(p.tileAnchorX,p.tileAnchorY);let{x:Ot,y:kt,z:Lt}=He.projectTilePoint(gt.x,gt.y,$e.canonical);if(ht){const[An,Zn,kn]=ht(gt);Ot+=An,kt+=Zn,Lt+=kn}const qt="globe"===He.name,$t=this.projectAndGetPerspectiveRatio(I,Ot,kt,Lt,$e,qt||!!ne||this.transform.pitch>0,He),{perspectiveRatio:cn}=$t,Wn=(Q?D/cn:D*cn)/l.ONE_EM,nn=Kn(Ot,kt,Lt,R),Mn=$t.signedDistanceFromCamera>0?_i(Wn,x,p.lineOffsetX*Wn,p.lineOffsetY*Wn,!1,nn,gt,p,y,R,{},ne&&!Q?ht:null,Q&&!!ne,He,$e,Q):null;let pn=!1,qn=!1,sn=!0;if(Mn&&!$t.occluded){const An=.5*je*cn+Ye,Zn=new l.Point(-100,-100),kn=new l.Point(this.screenRightBoundary,this.screenBottomBoundary),ti=new Qe,{first:Ii,last:$i}=Mn,mi=Ii.path.length;let Oi=[];for(let Ci=mi-1;Ci>=1;Ci--)Oi.push(Ii.path[Ci]);for(let Ci=1;Ci<$i.path.length;Ci++)Oi.push($i.path[Ci]);const cr=2.5*An;U&&(Oi=Oi.map(([Ci,br,Gr],Ir)=>(ht&&!qt&&(Gr=ht(Ir<mi-1?Ii.tilePath[mi-1-Ir]:$i.tilePath[Ir-mi+2])[2]),Kn(Ci,br,Gr,U))),Oi.some(Ci=>Ci[3]<=0)&&(Oi=[]));let lr=[];if(Oi.length>0){let Ci=1/0,br=-1/0,Gr=1/0,Ir=-1/0;for(const Br of Oi)Ci=Math.min(Ci,Br[0]),Gr=Math.min(Gr,Br[1]),br=Math.max(br,Br[0]),Ir=Math.max(Ir,Br[1]);br>=Zn.x&&Ci<=kn.x&&Ir>=Zn.y&&Gr<=kn.y&&(lr=[Oi.map(Br=>new l.Point(Br[0],Br[1]))],(Ci<Zn.x||br>kn.x||Gr<Zn.y||Ir>kn.y)&&(lr=l.clipLine(lr,Zn.x,Zn.y,kn.x,kn.y)))}for(const Ci of lr){ti.reset(Ci,.25*An);let br=0;br=ti.length<=.5*An?1:Math.ceil(ti.paddedLength/cr)+1;for(let Gr=0;Gr<br;Gr++){const Ir=Gr/Math.max(br-1,1),Br=ti.lerp(Ir),jo=Br.x+jn,is=Br.y+jn;et.push(jo,is,An,0);const sa=jo-An,Aa=is-An,co=jo+An,yr=is+An;if(sn=sn&&this.isOffscreen(sa,Aa,co,yr),qn=qn||this.isInsideGrid(sa,Aa,co,yr),!a&&this.grid.hitTestCircle(jo,is,An,Se)&&(pn=!0,!z))return{circles:[],offscreen:!1,collisionDetected:pn,occluded:!1}}}}return{circles:!z&&pn||!qn?[]:et,offscreen:sn,collisionDetected:pn,occluded:$t.occluded}}queryRenderedSymbols(n){if(0===n.length||0===this.grid.keysLength()&&0===this.ignoredGrid.keysLength())return{};const a=[];let p=1/0,y=1/0,x=-1/0,D=-1/0;for(const z of n){const Q=new l.Point(z.x+jn,z.y+jn);p=Math.min(p,Q.x),y=Math.min(y,Q.y),x=Math.max(x,Q.x),D=Math.max(D,Q.y),a.push(Q)}const I=this.grid.query(p,y,x,D).concat(this.ignoredGrid.query(p,y,x,D)),R={},U={};for(const z of I){const Q=z.key;if(void 0===R[Q.bucketInstanceId]&&(R[Q.bucketInstanceId]={}),R[Q.bucketInstanceId][Q.featureIndex])continue;const Se=[new l.Point(z.x1,z.y1),new l.Point(z.x2,z.y1),new l.Point(z.x2,z.y2),new l.Point(z.x1,z.y2)];l.polygonIntersectsPolygon(a,Se)&&(R[Q.bucketInstanceId][Q.featureIndex]=!0,void 0===U[Q.bucketInstanceId]&&(U[Q.bucketInstanceId]=[]),U[Q.bucketInstanceId].push(Q.featureIndex))}return U}insertCollisionBox(n,a,p,y,x){(a?this.ignoredGrid:this.grid).insert({bucketInstanceId:p,featureIndex:y,collisionGroupID:x},n[0],n[1],n[2],n[3])}insertCollisionCircles(n,a,p,y,x){const D=a?this.ignoredGrid:this.grid,I={bucketInstanceId:p,featureIndex:y,collisionGroupID:x};for(let R=0;R<n.length;R+=4)D.insertCircle(I,n[R],n[R+1],n[R+2])}projectAndGetPerspectiveRatio(n,a,p,y,x,D,I){const R=[a,p,y,1];let U=!1;y||this.transform.pitch>0?(l.transformMat4$1(R,R,n),this.fogState&&x&&"globe"!==I.name&&(U=function(Se,je,Ye,$e,et,ne){const He=ne.calculateFogTileMatrix(et),ht=[je,Ye,$e];return l.transformMat4(ht,ht,He),De(Se,ht,ne.pitch,ne._fov)}(this.fogState,a,p,y,x.toUnwrapped(),this.transform)>.9)):en(R,R,n);const z=R[3];return{point:new l.Point((R[0]/z+1)/2*this.transform.width+jn,(-R[1]/z+1)/2*this.transform.height+jn),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(I)/z*.5,1.5),signedDistanceFromCamera:z,occluded:D&&R[2]>z||U}}isOffscreen(n,a,p,y){return p<jn||n>=this.screenRightBoundary||y<jn||a>this.screenBottomBoundary}isInsideGrid(n,a,p,y){return p>=0&&n<this.gridRightBoundary&&y>=0&&a<this.gridBottomBoundary}getViewportMatrix(){const n=l.identity([]);return l.translate(n,n,[-100,-100,0]),n}}function ue(u,n,a){const p=n.createTileMatrix(u,u.worldSize,a.toUnwrapped());return l.multiply(new Float32Array(16),u.projMatrix,p)}function Xe(u,n,a){if(n.projection.name===a.projection.name)return u.projMatrix;const p=a.clone();return p.setProjection(n.projection),ue(p,n.getProjection(),u)}function _t(u,n,a){return n.name===a.projection.name?u.projMatrix:ue(a,n,u)}class Wt{constructor(n,a,p,y){this.opacity=n?Math.max(0,Math.min(1,n.opacity+(n.placed?a:-a))):y&&p?1:0,this.placed=p}isHidden(){return 0===this.opacity&&!this.placed}}class tn{constructor(n,a,p,y,x,D=!1){this.text=new Wt(n?n.text:null,a,p,x),this.icon=new Wt(n?n.icon:null,a,y,x),this.clipped=D}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class vn{constructor(n,a,p,y=!1){this.text=n,this.icon=a,this.skipFade=p,this.clipped=y}}class Vn{constructor(){this.invProjMatrix=l.create(),this.viewportMatrix=l.create(),this.circles=[]}}class $n{constructor(n,a,p,y,x){this.bucketInstanceId=n,this.featureIndex=a,this.sourceLayerIndex=p,this.bucketIndex=y,this.tileID=x}}class Xn{constructor(n){this.crossSourceCollisions=n,this.maxGroupID=0,this.collisionGroups={}}get(n){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[n]){const a=++this.maxGroupID;this.collisionGroups[n]={ID:a,predicate:p=>p.collisionGroupID===a}}return this.collisionGroups[n]}}function si(u,n,a,p,y){const{horizontalAlign:x,verticalAlign:D}=l.getAnchorAlignment(u),I=-(x-.5)*n,R=-(D-.5)*a,U=l.evaluateVariableOffset(u,p);return new l.Point(I+U[0]*y,R+U[1]*y)}function fi(u,n,a,p,y){const x=new l.Point(u,n);return a&&x._rotate(p?y:-y),x}class yi{constructor(n,a,p,y,x){this.transform=n.clone(),this.projection=n.projection.name,this.collisionIndex=new V(this.transform,x),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=a,this.retainedQueryData={},this.collisionGroups=new Xn(p),this.collisionCircleArrays={},this.prevPlacement=y,y&&(y.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(n,a,p,y){const x=p.getBucket(a),D=p.latestFeatureIndex;if(!x||!D||a.id!==x.layerIds[0])return;const I=x.layers[0].layout,R=p.collisionBoxArray,U=Math.pow(2,this.transform.zoom-p.tileID.overscaledZ),z=p.tileSize/l.EXTENT,Q=p.tileID.toUnwrapped();this.transform.setProjection(x.projection);const Se=(je=p.tileID,Ye=x.getProjection(),$e=this.transform,Ye.name===this.projection?$e.calculateProjMatrix(je.toUnwrapped()):ue($e,Ye,je));var je,Ye,$e;const et="map"===I.get("text-pitch-alignment"),ne="map"===I.get("text-rotation-alignment");a.compileFilter();const He=a.dynamicFilter(),ht=a.dynamicFilterNeedsFeature(),gt=this.transform.calculatePixelsToTileUnitsMatrix(p),Ot=Hn(Se,p.tileID.canonical,et,ne,this.transform,x.getProjection(),gt);let kt=null;if(et){const $t=On(Se,p.tileID.canonical,et,ne,this.transform,x.getProjection(),gt);kt=l.multiply([],this.transform.labelPlaneMatrix,$t)}let Lt=null;He&&p.latestFeatureIndex&&(Lt={unwrappedTileID:Q,dynamicFilter:He,dynamicFilterNeedsFeature:ht,featureIndex:p.latestFeatureIndex}),this.retainedQueryData[x.bucketInstanceId]=new $n(x.bucketInstanceId,D,x.sourceLayerIndex,x.index,p.tileID);const qt={bucket:x,layout:I,posMatrix:Se,textLabelPlaneMatrix:Ot,labelToScreenMatrix:kt,clippingData:Lt,scale:U,textPixelRatio:z,holdingForFade:p.holdingForFade(),collisionBoxArray:R,partiallyEvaluatedTextSize:l.evaluateSizeForZoom(x.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:l.evaluateSizeForZoom(x.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(x.sourceID)};if(y)for(const $t of x.sortKeyRanges){const{sortKey:cn,symbolInstanceStart:Wn,symbolInstanceEnd:nn}=$t;n.push({sortKey:cn,symbolInstanceStart:Wn,symbolInstanceEnd:nn,parameters:qt})}else n.push({symbolInstanceStart:0,symbolInstanceEnd:x.symbolInstances.length,parameters:qt})}attemptAnchorPlacement(n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e,et,ne,He){const{textOffset0:ht,textOffset1:gt,crossTileID:Ot}=Se,kt=[ht,gt],Lt=si(n,p,y,kt,x),qt=this.collisionIndex.placeCollisionBox(Ye,x,a,fi(Lt.x,Lt.y,D,I,this.transform.angle),Q,R,U,z.predicate);if(et){const $t=Ye.getSymbolInstanceIconSize(He,this.transform.zoom,Se.placedIconSymbolIndex);if(0===this.collisionIndex.placeCollisionBox(Ye,$t,et,fi(Lt.x,Lt.y,D,I,this.transform.angle),Q,R,U,z.predicate).box.length)return}if(qt.box.length>0){let $t;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ot]&&this.prevPlacement.placements[Ot]&&this.prevPlacement.placements[Ot].text&&($t=this.prevPlacement.variableOffsets[Ot].anchor),this.variableOffsets[Ot]={textOffset:kt,width:p,height:y,anchor:n,textScale:x,prevAnchor:$t},this.markUsedJustification(Ye,n,Se,$e),Ye.allowVerticalPlacement&&(this.markUsedOrientation(Ye,$e,Se),this.placedOrientations[Ot]=$e),{shift:Lt,placedGlyphBoxes:qt}}}placeLayerBucketPart(n,a,p,y){const{bucket:x,layout:D,posMatrix:I,textLabelPlaneMatrix:R,labelToScreenMatrix:U,clippingData:z,textPixelRatio:Q,holdingForFade:Se,collisionBoxArray:je,partiallyEvaluatedTextSize:Ye,partiallyEvaluatedIconSize:$e,collisionGroup:et}=n.parameters,ne=D.get("text-optional"),He=D.get("icon-optional"),ht=D.get("text-allow-overlap"),gt=D.get("icon-allow-overlap"),Ot="map"===D.get("text-rotation-alignment"),kt="map"===D.get("text-pitch-alignment"),Lt="none"!==D.get("icon-text-fit"),qt="viewport-y"===D.get("symbol-z-order");this.transform.setProjection(x.projection);let $t=ht&&(gt||!x.hasIconData()||He),cn=gt&&(ht||!x.hasTextData()||ne);!x.collisionArrays&&je&&x.deserializeCollisionBoxes(je),p&&y&&x.updateCollisionDebugBuffers(this.transform.zoom,je);const Wn=(nn,Mn,pn)=>{const{crossTileID:qn,numVerticalGlyphVertices:sn}=nn;if(z){const co={zoom:this.transform.zoom,pitch:this.transform.pitch};let yr=null;if(z.dynamicFilterNeedsFeature){const Er=this.retainedQueryData[x.bucketInstanceId];yr=z.featureIndex.loadFeature({featureIndex:nn.featureIndex,bucketIndex:Er.bucketIndex,sourceLayerIndex:Er.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,z.dynamicFilter)(co,yr,this.retainedQueryData[x.bucketInstanceId].tileID.canonical,new l.Point(nn.tileAnchorX,nn.tileAnchorY),this.transform.calculateDistanceTileData(z.unwrappedTileID)))return this.placements[qn]=new vn(!1,!1,!1,!0),void a.add(qn)}if(a.has(qn))return;if(Se)return void(this.placements[qn]=new vn(!1,!1,!1));let An=!1,Zn=!1,kn=!0,ti=!1,Ii=!1,$i=null,mi={box:null,offscreen:null,occluded:null},Oi={box:null,offscreen:null,occluded:null},cr=null,lr=null,Ci=null,br=0,Gr=0,Ir=0;pn.textFeatureIndex?br=pn.textFeatureIndex:nn.useRuntimeCollisionCircles&&(br=nn.featureIndex),pn.verticalTextFeatureIndex&&(Gr=pn.verticalTextFeatureIndex);const Br=co=>{co.tileID=this.retainedQueryData[x.bucketInstanceId].tileID;const yr=this.transform.elevation;(yr||co.elevation)&&(co.elevation=yr?yr.getAtTileOffset(co.tileID,co.tileAnchorX,co.tileAnchorY):0)},jo=pn.textBox;if(jo){Br(jo);const co=Er=>{let go=l.WritingMode.horizontal;if(x.allowVerticalPlacement&&!Er&&this.prevPlacement){const rs=this.prevPlacement.placedOrientations[qn];rs&&(this.placedOrientations[qn]=rs,go=rs,this.markUsedOrientation(x,go,nn))}return go},yr=(Er,go)=>{if(x.allowVerticalPlacement&&sn>0&&pn.verticalTextBox){for(const rs of x.writingModes)if(rs===l.WritingMode.vertical?(mi=go(),Oi=mi):mi=Er(),mi&&mi.box&&mi.box.length)break}else mi=Er()};if(D.get("text-variable-anchor")){let Er=D.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[qn]){const no=this.prevPlacement.variableOffsets[qn];Er.indexOf(no.anchor)>0&&(Er=Er.filter(os=>os!==no.anchor),Er.unshift(no.anchor))}const go=(no,os,xc)=>{const ic=x.getSymbolInstanceTextSize(Ye,nn,this.transform.zoom,Mn),bc=(no.x2-no.x1)*ic+2*no.padding,Ya=(no.y2-no.y1)*ic+2*no.padding,hl=Lt&&!gt?os:null;hl&&Br(hl);let Sl={box:[],offscreen:!1,occluded:!1};const ku=ht?2*Er.length:Er.length;for(let Pl=0;Pl<ku;++Pl){const fl=this.attemptAnchorPlacement(Er[Pl%Er.length],no,bc,Ya,ic,Ot,kt,Q,I,et,Pl>=Er.length,nn,Mn,x,xc,hl,Ye,$e);if(fl&&(Sl=fl.placedGlyphBoxes,Sl&&Sl.box&&Sl.box.length)){An=!0,$i=fl.shift;break}}return Sl};yr(()=>go(jo,pn.iconBox,l.WritingMode.horizontal),()=>{const no=pn.verticalTextBox;return no&&Br(no),x.allowVerticalPlacement&&!(mi&&mi.box&&mi.box.length)&&sn>0&&no?go(no,pn.verticalIconBox,l.WritingMode.vertical):{box:null,offscreen:null,occluded:null}}),mi&&(An=mi.box,kn=mi.offscreen,ti=mi.occluded);const rs=co(!(!mi||!mi.box));if(!An&&this.prevPlacement){const no=this.prevPlacement.variableOffsets[qn];no&&(this.variableOffsets[qn]=no,this.markUsedJustification(x,no.anchor,nn,rs))}}else{const Er=(go,rs)=>{const no=x.getSymbolInstanceTextSize(Ye,nn,this.transform.zoom,Mn),os=this.collisionIndex.placeCollisionBox(x,no,go,new l.Point(0,0),ht,Q,I,et.predicate);return os&&os.box&&os.box.length&&(this.markUsedOrientation(x,rs,nn),this.placedOrientations[qn]=rs),os};yr(()=>Er(jo,l.WritingMode.horizontal),()=>{const go=pn.verticalTextBox;return x.allowVerticalPlacement&&sn>0&&go?(Br(go),Er(go,l.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}}),co(!!(mi&&mi.box&&mi.box.length))}}if(cr=mi,An=cr&&cr.box&&cr.box.length>0,kn=cr&&cr.offscreen,ti=cr&&cr.occluded,nn.useRuntimeCollisionCircles){const co=x.text.placedSymbolArray.get(nn.centerJustifiedTextSymbolIndex>=0?nn.centerJustifiedTextSymbolIndex:nn.verticalPlacedTextSymbolIndex),yr=l.evaluateSizeForFeature(x.textSizeData,Ye,co),Er=D.get("text-padding");lr=this.collisionIndex.placeCollisionCircles(x,ht,co,x.lineVertexArray,x.glyphOffsetArray,yr,I,R,U,p,kt,et.predicate,nn.collisionCircleDiameter*yr/l.ONE_EM,Er,this.retainedQueryData[x.bucketInstanceId].tileID),An=ht||lr.circles.length>0&&!lr.collisionDetected,kn=kn&&lr.offscreen,ti=lr.occluded}if(pn.iconFeatureIndex&&(Ir=pn.iconFeatureIndex),pn.iconBox){const co=yr=>{Br(yr);const Er=Lt&&$i?fi($i.x,$i.y,Ot,kt,this.transform.angle):new l.Point(0,0),go=x.getSymbolInstanceIconSize($e,this.transform.zoom,nn.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(x,go,yr,Er,gt,Q,I,et.predicate)};Oi&&Oi.box&&Oi.box.length&&pn.verticalIconBox?(Ci=co(pn.verticalIconBox),Zn=Ci.box.length>0):(Ci=co(pn.iconBox),Zn=Ci.box.length>0),kn=kn&&Ci.offscreen,Ii=Ci.occluded}const is=ne||0===nn.numHorizontalGlyphVertices&&0===sn,sa=He||0===nn.numIconVertices;if(is||sa?sa?is||(Zn=Zn&&An):An=Zn&&An:Zn=An=Zn&&An,An&&cr&&cr.box&&this.collisionIndex.insertCollisionBox(cr.box,D.get("text-ignore-placement"),x.bucketInstanceId,Oi&&Oi.box&&Gr?Gr:br,et.ID),Zn&&Ci&&this.collisionIndex.insertCollisionBox(Ci.box,D.get("icon-ignore-placement"),x.bucketInstanceId,Ir,et.ID),lr&&(An&&this.collisionIndex.insertCollisionCircles(lr.circles,D.get("text-ignore-placement"),x.bucketInstanceId,br,et.ID),p)){const co=x.bucketInstanceId;let yr=this.collisionCircleArrays[co];void 0===yr&&(yr=this.collisionCircleArrays[co]=new Vn);for(let Er=0;Er<lr.circles.length;Er+=4)yr.circles.push(lr.circles[Er+0]),yr.circles.push(lr.circles[Er+1]),yr.circles.push(lr.circles[Er+2]),yr.circles.push(lr.collisionDetected?1:0)}const Aa="globe"!==x.projection.name;$t=$t&&(Aa||!ti),cn=cn&&(Aa||!Ii),this.placements[qn]=new vn(An||$t,Zn||cn,kn||x.justReloaded),a.add(qn)};if(qt){const nn=x.getSortedSymbolIndexes(this.transform.angle);for(let Mn=nn.length-1;Mn>=0;--Mn){const pn=nn[Mn];Wn(x.symbolInstances.get(pn),pn,x.collisionArrays[pn])}}else for(let nn=n.symbolInstanceStart;nn<n.symbolInstanceEnd;nn++)Wn(x.symbolInstances.get(nn),nn,x.collisionArrays[nn]);if(p&&x.bucketInstanceId in this.collisionCircleArrays){const nn=this.collisionCircleArrays[x.bucketInstanceId];l.invert(nn.invProjMatrix,I),nn.viewportMatrix=this.collisionIndex.getViewportMatrix()}x.justReloaded=!1}markUsedJustification(n,a,p,y){const{leftJustifiedTextSymbolIndex:x,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:I,verticalPlacedTextSymbolIndex:R,crossTileID:U}=p,z=l.getAnchorJustification(a),Q=y===l.WritingMode.vertical?R:"left"===z?x:"center"===z?D:"right"===z?I:-1;x>=0&&(n.text.placedSymbolArray.get(x).crossTileID=Q>=0&&x!==Q?0:U),D>=0&&(n.text.placedSymbolArray.get(D).crossTileID=Q>=0&&D!==Q?0:U),I>=0&&(n.text.placedSymbolArray.get(I).crossTileID=Q>=0&&I!==Q?0:U),R>=0&&(n.text.placedSymbolArray.get(R).crossTileID=Q>=0&&R!==Q?0:U)}markUsedOrientation(n,a,p){const y=a===l.WritingMode.horizontal||a===l.WritingMode.horizontalOnly?a:0,x=a===l.WritingMode.vertical?a:0,{leftJustifiedTextSymbolIndex:D,centerJustifiedTextSymbolIndex:I,rightJustifiedTextSymbolIndex:R,verticalPlacedTextSymbolIndex:U}=p,z=n.text.placedSymbolArray;D>=0&&(z.get(D).placedOrientation=y),I>=0&&(z.get(I).placedOrientation=y),R>=0&&(z.get(R).placedOrientation=y),U>=0&&(z.get(U).placedOrientation=x)}commit(n){this.commitTime=n,this.zoomAtLastRecencyCheck=this.transform.zoom;const a=this.prevPlacement;let p=!1;this.prevZoomAdjustment=a?a.zoomAdjustment(this.transform.zoom):0;const y=a?a.symbolFadeChange(n):1,x=a?a.opacities:{},D=a?a.variableOffsets:{},I=a?a.placedOrientations:{};for(const R in this.placements){const U=this.placements[R],z=x[R];z?(this.opacities[R]=new tn(z,y,U.text,U.icon,null,U.clipped),p=p||U.text!==z.text.placed||U.icon!==z.icon.placed):(this.opacities[R]=new tn(null,y,U.text,U.icon,U.skipFade,U.clipped),p=p||U.text||U.icon)}for(const R in x){const U=x[R];if(!this.opacities[R]){const z=new tn(U,y,!1,!1);z.isHidden()||(this.opacities[R]=z,p=p||U.text.placed||U.icon.placed)}}for(const R in D)this.variableOffsets[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.variableOffsets[R]=D[R]);for(const R in I)this.placedOrientations[R]||!this.opacities[R]||this.opacities[R].isHidden()||(this.placedOrientations[R]=I[R]);p?this.lastPlacementChangeTime=n:"number"!=typeof this.lastPlacementChangeTime&&(this.lastPlacementChangeTime=a?a.lastPlacementChangeTime:n)}updateLayerOpacities(n,a){const p=new Set;for(const y of a){const x=y.getBucket(n);x&&y.latestFeatureIndex&&n.id===x.layerIds[0]&&this.updateBucketOpacities(x,p,y.collisionBoxArray)}}updateBucketOpacities(n,a,p){n.hasTextData()&&n.text.opacityVertexArray.clear(),n.hasIconData()&&n.icon.opacityVertexArray.clear(),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexArray.clear(),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexArray.clear();const y=n.layers[0].layout,x=!!n.layers[0].dynamicFilter(),D=new tn(null,0,!1,!1,!0),I=y.get("text-allow-overlap"),R=y.get("icon-allow-overlap"),U=y.get("text-variable-anchor"),z="map"===y.get("text-rotation-alignment"),Q="map"===y.get("text-pitch-alignment"),Se="none"!==y.get("icon-text-fit"),je=new tn(null,0,I&&(R||!n.hasIconData()||y.get("icon-optional")),R&&(I||!n.hasTextData()||y.get("text-optional")),!0);!n.collisionArrays&&p&&(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData())&&n.deserializeCollisionBoxes(p);const Ye=(et,ne,He)=>{for(let ht=0;ht<ne/4;ht++)et.opacityVertexArray.emplaceBack(He)};let $e=0;for(let et=0;et<n.symbolInstances.length;et++){const ne=n.symbolInstances.get(et),{numHorizontalGlyphVertices:He,numVerticalGlyphVertices:ht,crossTileID:gt,numIconVertices:Ot}=ne,kt=a.has(gt);let Lt=this.opacities[gt];kt?Lt=D:Lt||(Lt=je,this.opacities[gt]=Lt),a.add(gt);const qt=He>0||ht>0,$t=Ot>0,cn=this.placedOrientations[gt],Wn=cn===l.WritingMode.vertical,nn=cn===l.WritingMode.horizontal||cn===l.WritingMode.horizontalOnly;if(!qt&&!$t||Lt.isHidden()||$e++,qt){const Mn=Sr(Lt.text);Ye(n.text,He,Wn?Qi:Mn),Ye(n.text,ht,nn?Qi:Mn);const pn=Lt.text.isHidden(),{leftJustifiedTextSymbolIndex:qn,centerJustifiedTextSymbolIndex:sn,rightJustifiedTextSymbolIndex:An,verticalPlacedTextSymbolIndex:Zn}=ne,kn=n.text.placedSymbolArray,ti=pn||Wn?1:0;qn>=0&&(kn.get(qn).hidden=ti),sn>=0&&(kn.get(sn).hidden=ti),An>=0&&(kn.get(An).hidden=ti),Zn>=0&&(kn.get(Zn).hidden=pn||nn?1:0);const Ii=this.variableOffsets[gt];Ii&&this.markUsedJustification(n,Ii.anchor,ne,cn);const $i=this.placedOrientations[gt];$i&&(this.markUsedJustification(n,"left",ne,$i),this.markUsedOrientation(n,$i,ne))}if($t){const Mn=Sr(Lt.icon),{placedIconSymbolIndex:pn,verticalPlacedIconSymbolIndex:qn}=ne,sn=n.icon.placedSymbolArray,An=Lt.icon.isHidden()?1:0;pn>=0&&(Ye(n.icon,Ot,Wn?Qi:Mn),sn.get(pn).hidden=An),qn>=0&&(Ye(n.icon,ne.numVerticalIconVertices,nn?Qi:Mn),sn.get(qn).hidden=An)}if(n.hasIconCollisionBoxData()||n.hasTextCollisionBoxData()){const Mn=n.collisionArrays[et];if(Mn){let pn=new l.Point(0,0),qn=!0;if(Mn.textBox||Mn.verticalTextBox){if(U){const An=this.variableOffsets[gt];An?(pn=si(An.anchor,An.width,An.height,An.textOffset,An.textScale),z&&pn._rotate(Q?this.transform.angle:-this.transform.angle)):qn=!1}x&&(qn=!Lt.clipped),Mn.textBox&&Vi(n.textCollisionBox.collisionVertexArray,Lt.text.placed,!qn||Wn,pn.x,pn.y),Mn.verticalTextBox&&Vi(n.textCollisionBox.collisionVertexArray,Lt.text.placed,!qn||nn,pn.x,pn.y)}const sn=qn&&!(nn||!Mn.verticalIconBox);Mn.iconBox&&Vi(n.iconCollisionBox.collisionVertexArray,Lt.icon.placed,sn,Se?pn.x:0,Se?pn.y:0),Mn.verticalIconBox&&Vi(n.iconCollisionBox.collisionVertexArray,Lt.icon.placed,!sn,Se?pn.x:0,Se?pn.y:0)}}}if(n.fullyClipped=0===$e,n.sortFeatures(this.transform.angle),this.retainedQueryData[n.bucketInstanceId]&&(this.retainedQueryData[n.bucketInstanceId].featureSortOrder=n.featureSortOrder),n.hasTextData()&&n.text.opacityVertexBuffer&&n.text.opacityVertexBuffer.updateData(n.text.opacityVertexArray),n.hasIconData()&&n.icon.opacityVertexBuffer&&n.icon.opacityVertexBuffer.updateData(n.icon.opacityVertexArray),n.hasIconCollisionBoxData()&&n.iconCollisionBox.collisionVertexBuffer&&n.iconCollisionBox.collisionVertexBuffer.updateData(n.iconCollisionBox.collisionVertexArray),n.hasTextCollisionBoxData()&&n.textCollisionBox.collisionVertexBuffer&&n.textCollisionBox.collisionVertexBuffer.updateData(n.textCollisionBox.collisionVertexArray),n.bucketInstanceId in this.collisionCircleArrays){const et=this.collisionCircleArrays[n.bucketInstanceId];n.placementInvProjMatrix=et.invProjMatrix,n.placementViewportMatrix=et.viewportMatrix,n.collisionCircleArray=et.circles,delete this.collisionCircleArrays[n.bucketInstanceId]}}symbolFadeChange(n){return 0===this.fadeDuration?1:(n-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(n){return Math.max(0,(this.transform.zoom-n)/1.5)}hasTransitions(n){return this.stale||n-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(n,a){const p=this.zoomAtLastRecencyCheck===a?1-this.zoomAdjustment(a):1;return this.zoomAtLastRecencyCheck=a,this.commitTime+this.fadeDuration*p>n}setStale(){this.stale=!0}}function Vi(u,n,a,p,y){u.emplaceBack(n?1:0,a?1:0,p||0,y||0),u.emplaceBack(n?1:0,a?1:0,p||0,y||0),u.emplaceBack(n?1:0,a?1:0,p||0,y||0),u.emplaceBack(n?1:0,a?1:0,p||0,y||0)}const Yi=Math.pow(2,25),O=Math.pow(2,24),Oe=Math.pow(2,17),$=Math.pow(2,16),Ze=Math.pow(2,9),Nt=Math.pow(2,8),Fi=Math.pow(2,1);function Sr(u){if(0===u.opacity&&!u.placed)return 0;if(1===u.opacity&&u.placed)return 4294967295;const n=u.placed?1:0,a=Math.floor(127*u.opacity);return a*Yi+n*O+a*Oe+n*$+a*Ze+n*Nt+a*Fi+n}const Qi=0;class Dr{constructor(n){this._sortAcrossTiles="viewport-y"!==n.layout.get("symbol-z-order")&&void 0!==n.layout.get("symbol-sort-key").constantOr(1),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(n,a,p,y,x){const D=this._bucketParts;for(;this._currentTileIndex<n.length;)if(a.getBucketParts(D,y,n[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,x())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,D.sort((I,R)=>I.sortKey-R.sortKey));this._currentPartIndex<D.length;){const I=D[this._currentPartIndex];if(a.placeLayerBucketPart(I,this._seenCrossTileIDs,p,0===I.symbolInstanceStart),this._currentPartIndex++,x())return!0}return!1}}class ho{constructor(n,a,p,y,x,D,I,R){this.placement=new yi(n,x,D,I,R),this._currentPlacementIndex=a.length-1,this._forceFullPlacement=p,this._showCollisionBoxes=y,this._done=!1}isDone(){return this._done}continuePlacement(n,a,p){const y=l.exported.now(),x=()=>{const D=l.exported.now()-y;return!this._forceFullPlacement&&D>2};for(;this._currentPlacementIndex>=0;){const D=a[n[this._currentPlacementIndex]],I=this.placement.collisionIndex.transform.zoom;if("symbol"===D.type&&(!D.minzoom||D.minzoom<=I)&&(!D.maxzoom||D.maxzoom>I)){if(this._inProgressLayer||(this._inProgressLayer=new Dr(D)),this._inProgressLayer.continuePlacement(p[D.source],this.placement,this._showCollisionBoxes,D,x))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(n){return this.placement.commit(n),this.placement}}const ji=512/l.EXTENT/2;class eo{constructor(n,a,p){this.tileID=n,this.bucketInstanceId=p,this.index=new l.KDBush(a.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const y=n.canonical.x*l.EXTENT,x=n.canonical.y*l.EXTENT;for(let D=0;D<a.length;D++){const{key:I,crossTileID:R,tileAnchorX:U,tileAnchorY:z}=a.get(D),Q=Math.floor((y+U)*ji),Se=Math.floor((x+z)*ji);this.index.add(Q,Se),this.keys.push(I),this.crossTileIDs.push(R)}this.index.finish()}findMatches(n,a,p){const y=this.tileID.canonical.z<a.canonical.z?1:Math.pow(2,this.tileID.canonical.z-a.canonical.z),x=ji/Math.pow(2,a.canonical.z-this.tileID.canonical.z),D=a.canonical.x*l.EXTENT,I=a.canonical.y*l.EXTENT;for(let R=0;R<n.length;R++){const U=n.get(R);if(U.crossTileID)continue;const{key:z,tileAnchorX:Q,tileAnchorY:Se}=U,je=Math.floor((D+Q)*x),Ye=Math.floor((I+Se)*x),$e=this.index.range(je-y,Ye-y,je+y,Ye+y);for(const et of $e){const ne=this.crossTileIDs[et];if(this.keys[et]===z&&!p.has(ne)){p.add(ne),U.crossTileID=ne;break}}}}}class Bs{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Xs{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(n){const a=Math.round((n-this.lng)/360);if(0!==a)for(const p in this.indexes){const y=this.indexes[p],x={};for(const D in y){const I=y[D];I.tileID=I.tileID.unwrapTo(I.tileID.wrap+a),x[I.tileID.key]=I}this.indexes[p]=x}this.lng=n}addBucket(n,a,p){if(this.indexes[n.overscaledZ]&&this.indexes[n.overscaledZ][n.key]){if(this.indexes[n.overscaledZ][n.key].bucketInstanceId===a.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(n.overscaledZ,this.indexes[n.overscaledZ][n.key])}for(let x=0;x<a.symbolInstances.length;x++)a.symbolInstances.get(x).crossTileID=0;this.usedCrossTileIDs[n.overscaledZ]||(this.usedCrossTileIDs[n.overscaledZ]=new Set);const y=this.usedCrossTileIDs[n.overscaledZ];for(const x in this.indexes){const D=this.indexes[x];if(Number(x)>n.overscaledZ)for(const I in D){const R=D[I];R.tileID.isChildOf(n)&&R.findMatches(a.symbolInstances,n,y)}else{const I=D[n.scaledTo(Number(x)).key];I&&I.findMatches(a.symbolInstances,n,y)}}for(let x=0;x<a.symbolInstances.length;x++){const D=a.symbolInstances.get(x);D.crossTileID||(D.crossTileID=p.generate(),y.add(D.crossTileID))}return void 0===this.indexes[n.overscaledZ]&&(this.indexes[n.overscaledZ]={}),this.indexes[n.overscaledZ][n.key]=new eo(n,a.symbolInstances,a.bucketInstanceId),!0}removeBucketCrossTileIDs(n,a){for(const p of a.crossTileIDs)this.usedCrossTileIDs[n].delete(p)}removeStaleBuckets(n){let a=!1;for(const p in this.indexes){const y=this.indexes[p];for(const x in y)n[y[x].bucketInstanceId]||(this.removeBucketCrossTileIDs(p,y[x]),delete y[x],a=!0)}return a}}class To{constructor(){this.layerIndexes={},this.crossTileIDs=new Bs,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(n,a,p,y){let x=this.layerIndexes[n.id];void 0===x&&(x=this.layerIndexes[n.id]=new Xs);let D=!1;const I={};"globe"!==y.name&&x.handleWrapJump(p);for(const R of a){const U=R.getBucket(n);U&&n.id===U.layerIds[0]&&(U.bucketInstanceId||(U.bucketInstanceId=++this.maxBucketInstanceId),x.addBucket(R.tileID,U,this.crossTileIDs)&&(D=!0),I[U.bucketInstanceId]=!0)}return x.removeStaleBuckets(I)&&(D=!0),D}pruneUnusedLayers(n){const a={};n.forEach(p=>{a[p]=!0});for(const p in this.layerIndexes)a[p]||delete this.layerIndexes[p]}}const $o=(u,n)=>l.emitValidationErrors(u,n&&n.filter(a=>"source.canvas"!==a.identifier)),ds=l.pick(zi,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),ys=l.pick(zi,["setCenter","setZoom","setBearing","setPitch"]),Qs={version:8,layers:[],sources:{}},Mo={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class to extends l.Evented{constructor(n,a={}){super(),this.map=n,this.dispatcher=new dn(uo(),this),this.imageManager=new ct,this.imageManager.setEventedParent(this),this.glyphManager=new l.GlyphManager(n._requestManager,a.localFontFamily?l.LocalGlyphMode.all:a.localIdeographFontFamily?l.LocalGlyphMode.ideographs:l.LocalGlyphMode.none,a.localFontFamily||a.localIdeographFontFamily),this.crossTileSymbolIndex=new To,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",l.getReferrer());const p=this;this._rtlTextPluginCallback=to.registerForPluginStateChange(y=>{p.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:y.pluginStatus,pluginURL:y.pluginURL},(x,D)=>{if(l.triggerPluginCompletionEvent(x),D&&D.every(I=>I))for(const I in p._sourceCaches){const R=p._sourceCaches[I],U=R.getSource().type;"vector"!==U&&"geojson"!==U||R.reload()}})}),this.on("data",y=>{if("source"!==y.dataType||"metadata"!==y.sourceDataType)return;const x=this.getSource(y.sourceId);if(x&&x.vectorLayerIds)for(const D in this._layers){const I=this._layers[D];I.source===x.id&&this._validateLayer(I)}})}loadURL(n,a={}){this.fire(new l.Event("dataloading",{dataType:"style"}));const p="boolean"==typeof a.validate?a.validate:!l.isMapboxURL(n);n=this.map._requestManager.normalizeStyleURL(n,a.accessToken);const y=this.map._requestManager.transformRequest(n,l.ResourceType.Style);this._request=l.getJSON(y,(x,D)=>{this._request=null,x?this.fire(new l.ErrorEvent(x)):D&&this._load(D,p)})}loadJSON(n,a={}){this.fire(new l.Event("dataloading",{dataType:"style"})),this._request=l.exported.frame(()=>{this._request=null,this._load(n,!1!==a.validate)})}loadEmpty(){this.fire(new l.Event("dataloading",{dataType:"style"})),this._load(Qs,!1)}_updateLayerCount(n,a){const p=a?1:-1;n.is3D()&&(this._num3DLayers+=p),"circle"===n.type&&(this._numCircleLayers+=p),"symbol"===n.type&&(this._numSymbolLayers+=p)}_load(n,a){if(a&&$o(this,l.validateStyle(n)))return;this._loaded=!0,this.stylesheet=l.clone$1(n),this._updateMapProjection();for(const y in n.sources)this.addSource(y,n.sources[y],{validate:!1});this._changed=!1,n.sprite?this._loadSprite(n.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(n.glyphs);const p=Eo(this.stylesheet.layers);this._order=p.map(y=>y.id),this._layers={},this._serializedLayers={};for(const y of p){const x=l.createStyleLayer(y);x.setEventedParent(this,{layer:{id:x.id}}),this._layers[x.id]=x,this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ve(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new l.Event("data",{dataType:"style"})),this.fire(new l.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&0===this.terrain.drapeRenderMode}setProjection(n){n?this.stylesheet.projection=n:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(n){this._spriteRequest=function(a,p,y){let x,D,I;const R=l.exported.devicePixelRatio>1?"@2x":"";let U=l.getJSON(p.transformRequest(p.normalizeSpriteURL(a,R,".json"),l.ResourceType.SpriteJSON),(Se,je)=>{U=null,I||(I=Se,x=je,Q())}),z=l.getImage(p.transformRequest(p.normalizeSpriteURL(a,R,".png"),l.ResourceType.SpriteImage),(Se,je)=>{z=null,I||(I=Se,D=je,Q())});function Q(){if(I)y(I);else if(x&&D){const Se=l.exported.getImageData(D),je={};for(const Ye in x){const{width:$e,height:et,x:ne,y:He,sdf:ht,pixelRatio:gt,stretchX:Ot,stretchY:kt,content:Lt}=x[Ye],qt=new l.RGBAImage({width:$e,height:et});l.RGBAImage.copy(Se,qt,{x:ne,y:He},{x:0,y:0},{width:$e,height:et}),je[Ye]={data:qt,pixelRatio:gt,sdf:ht,stretchX:Ot,stretchY:kt,content:Lt}}y(null,je)}}return{cancel(){U&&(U.cancel(),U=null),z&&(z.cancel(),z=null)}}}(n,this.map._requestManager,(a,p)=>{if(this._spriteRequest=null,a)this.fire(new l.ErrorEvent(a));else if(p)for(const y in p)this.imageManager.addImage(y,p[y]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new l.Event("data",{dataType:"style"}))})}_validateLayer(n){const a=this.getSource(n.source);if(!a)return;const p=n.sourceLayer;p&&("geojson"===a.type||a.vectorLayerIds&&-1===a.vectorLayerIds.indexOf(p))&&this.fire(new l.ErrorEvent(new Error(`Source layer "${p}" does not exist on source "${a.id}" as specified by style layer "${n.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const n in this._sourceCaches)if(!this._sourceCaches[n].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(n){const a=[];for(const p of n){const y=this._layers[p];"custom"!==y.type&&a.push(y.serialize())}return a}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const n in this._sourceCaches)if(this._sourceCaches[n].hasTransition())return!0;for(const n in this._layers)if(this._layers[n].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(n){return!!this.terrain&&("function"==typeof n.isLayerDraped?n.isLayerDraped():Mo[n.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(n){if(!this._loaded)return;const a=this._changed;if(this._changed){const y=Object.keys(this._updatedLayers),x=Object.keys(this._removedLayers);(y.length||x.length)&&this._updateWorkerLayers(y,x);for(const D in this._updatedSources){const I=this._updatedSources[D];"reload"===I?this._reloadSource(D):"clear"===I&&this._clearSource(D)}this._updateTilesForChangedImages();for(const D in this._updatedPaintProps)this._layers[D].updateTransitions(n);this.light.updateTransitions(n),this.fog&&this.fog.updateTransitions(n),this._resetUpdates()}const p={};for(const y in this._sourceCaches){const x=this._sourceCaches[y];p[y]=x.used,x.used=!1}for(const y of this._order){const x=this._layers[y];if(x.recalculate(n,this._availableImages),!x.isHidden(n.zoom)){const I=this._getLayerSourceCache(x);I&&(I.used=!0)}const D=this.map.painter;if(D){const I=x.getProgramIds();if(!I)continue;const R=x.getProgramConfiguration(n.zoom);for(const U of I)D.useProgram(U,R)}}for(const y in p){const x=this._sourceCaches[y];p[y]!==x.used&&x.getSource().fire(new l.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:x.getSource().id}))}this.light.recalculate(n),this.terrain&&this.terrain.recalculate(n),this.fog&&this.fog.recalculate(n),this.z=n.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),a&&this.fire(new l.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const n=Object.keys(this._changedImages);if(n.length){for(const a in this._sourceCaches)this._sourceCaches[a].reloadTilesForDependencies(["icons","patterns"],n);this._changedImages={}}}_updateWorkerLayers(n,a){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(n),removedIds:a})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(n){if(this._checkLoaded(),$o(this,l.validateStyle(n)))return!1;(n=l.clone$1(n)).layers=Eo(n.layers);const a=function(y,x){if(!y)return[{command:zi.setStyle,args:[x]}];let D=[];try{if(!B(y.version,x.version))return[{command:zi.setStyle,args:[x]}];B(y.center,x.center)||D.push({command:zi.setCenter,args:[x.center]}),B(y.zoom,x.zoom)||D.push({command:zi.setZoom,args:[x.zoom]}),B(y.bearing,x.bearing)||D.push({command:zi.setBearing,args:[x.bearing]}),B(y.pitch,x.pitch)||D.push({command:zi.setPitch,args:[x.pitch]}),B(y.sprite,x.sprite)||D.push({command:zi.setSprite,args:[x.sprite]}),B(y.glyphs,x.glyphs)||D.push({command:zi.setGlyphs,args:[x.glyphs]}),B(y.transition,x.transition)||D.push({command:zi.setTransition,args:[x.transition]}),B(y.light,x.light)||D.push({command:zi.setLight,args:[x.light]}),B(y.fog,x.fog)||D.push({command:zi.setFog,args:[x.fog]}),B(y.projection,x.projection)||D.push({command:zi.setProjection,args:[x.projection]});const I={},R=[];!function(Q,Se,je,Ye){let $e;for($e in Se=Se||{},Q=Q||{})Q.hasOwnProperty($e)&&(Se.hasOwnProperty($e)||Ti($e,je,Ye));for($e in Se){if(!Se.hasOwnProperty($e))continue;const et=Se[$e];Q.hasOwnProperty($e)?B(Q[$e],et)||("geojson"===Q[$e].type&&"geojson"===et.type&&vr(Q,Se,$e)?je.push({command:zi.setGeoJSONSourceData,args:[$e,et.data]}):yo($e,Se,je,Ye)):hr($e,Se,je)}}(y.sources,x.sources,R,I);const U=[];y.layers&&y.layers.forEach(Q=>{Q.source&&I[Q.source]?D.push({command:zi.removeLayer,args:[Q.id]}):U.push(Q)});let z=y.terrain;z&&I[z.source]&&(D.push({command:zi.setTerrain,args:[void 0]}),z=void 0),D=D.concat(R),B(z,x.terrain)||D.push({command:zi.setTerrain,args:[x.terrain]}),function(Q,Se,je){Se=Se||[];const Ye=(Q=Q||[]).map(Yr),$e=Se.map(Yr),et=Q.reduce(qi,{}),ne=Se.reduce(qi,{}),He=Ye.slice(),ht=Object.create(null);let gt,Ot,kt,Lt,qt,$t,cn;for(gt=0,Ot=0;gt<Ye.length;gt++)kt=Ye[gt],ne.hasOwnProperty(kt)?Ot++:(je.push({command:zi.removeLayer,args:[kt]}),He.splice(He.indexOf(kt,Ot),1));for(gt=0,Ot=0;gt<$e.length;gt++)kt=$e[$e.length-1-gt],He[He.length-1-gt]!==kt&&(et.hasOwnProperty(kt)?(je.push({command:zi.removeLayer,args:[kt]}),He.splice(He.lastIndexOf(kt,He.length-Ot),1)):Ot++,$t=He[He.length-gt],je.push({command:zi.addLayer,args:[ne[kt],$t]}),He.splice(He.length-gt,0,kt),ht[kt]=!0);for(gt=0;gt<$e.length;gt++)if(kt=$e[gt],Lt=et[kt],qt=ne[kt],!ht[kt]&&!B(Lt,qt))if(B(Lt.source,qt.source)&&B(Lt["source-layer"],qt["source-layer"])&&B(Lt.type,qt.type)){for(cn in Vr(Lt.layout,qt.layout,je,kt,null,zi.setLayoutProperty),Vr(Lt.paint,qt.paint,je,kt,null,zi.setPaintProperty),B(Lt.filter,qt.filter)||je.push({command:zi.setFilter,args:[kt,qt.filter]}),B(Lt.minzoom,qt.minzoom)&&B(Lt.maxzoom,qt.maxzoom)||je.push({command:zi.setLayerZoomRange,args:[kt,qt.minzoom,qt.maxzoom]}),Lt)Lt.hasOwnProperty(cn)&&"layout"!==cn&&"paint"!==cn&&"filter"!==cn&&"metadata"!==cn&&"minzoom"!==cn&&"maxzoom"!==cn&&(0===cn.indexOf("paint.")?Vr(Lt[cn],qt[cn],je,kt,cn.slice(6),zi.setPaintProperty):B(Lt[cn],qt[cn])||je.push({command:zi.setLayerProperty,args:[kt,cn,qt[cn]]}));for(cn in qt)qt.hasOwnProperty(cn)&&!Lt.hasOwnProperty(cn)&&"layout"!==cn&&"paint"!==cn&&"filter"!==cn&&"metadata"!==cn&&"minzoom"!==cn&&"maxzoom"!==cn&&(0===cn.indexOf("paint.")?Vr(Lt[cn],qt[cn],je,kt,cn.slice(6),zi.setPaintProperty):B(Lt[cn],qt[cn])||je.push({command:zi.setLayerProperty,args:[kt,cn,qt[cn]]}))}else je.push({command:zi.removeLayer,args:[kt]}),$t=He[He.lastIndexOf(kt)+1],je.push({command:zi.addLayer,args:[qt,$t]})}(U,x.layers,D)}catch(I){console.warn("Unable to compute style diff:",I),D=[{command:zi.setStyle,args:[x]}]}return D}(this.serialize(),n).filter(y=>!(y.command in ys));if(0===a.length)return!1;const p=a.filter(y=>!(y.command in ds));if(p.length>0)throw new Error(`Unimplemented: ${p.map(y=>y.command).join(", ")}.`);return a.forEach(y=>{"setTransition"!==y.command&&"setProjection"!==y.command&&this[y.command].apply(this,y.args)}),this.stylesheet=n,this._updateMapProjection(),!0}addImage(n,a){return this.getImage(n)?this.fire(new l.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(n,a),this._afterImageUpdated(n),this)}updateImage(n,a){this.imageManager.updateImage(n,a)}getImage(n){return this.imageManager.getImage(n)}removeImage(n){return this.getImage(n)?(this.imageManager.removeImage(n),this._afterImageUpdated(n),this):this.fire(new l.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(n){this._availableImages=this.imageManager.listImages(),this._changedImages[n]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new l.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(n,a,p={}){if(this._checkLoaded(),void 0!==this.getSource(n))throw new Error("There is already a source with this ID");if(!a.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(a).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(a.type)>=0&&this._validate(l.validateSource,`sources.${n}`,a,null,p))return;this.map&&this.map._collectResourceTiming&&(a.collectResourceTiming=!0);const y=st(n,a,this.dispatcher,this);y.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(n),source:y.serialize(),sourceId:n}));const x=D=>{const I=(D?"symbol:":"other:")+n,R=this._sourceCaches[I]=new l.SourceCache(I,y,D);(D?this._symbolSourceCaches:this._otherSourceCaches)[n]=R,R.style=this,R.onAdd(this.map)};x(!1),"vector"!==a.type&&"geojson"!==a.type||x(!0),y.onAdd&&y.onAdd(this.map),this._changed=!0}removeSource(n){this._checkLoaded();const a=this.getSource(n);if(!a)throw new Error("There is no source with this ID");for(const y in this._layers)if(this._layers[y].source===n)return this.fire(new l.ErrorEvent(new Error(`Source "${n}" cannot be removed while layer "${y}" is using it.`)));if(this.terrain&&this.terrain.get().source===n)return this.fire(new l.ErrorEvent(new Error(`Source "${n}" cannot be removed while terrain is using it.`)));const p=this._getSourceCaches(n);for(const y of p)delete this._sourceCaches[y.id],delete this._updatedSources[y.id],y.fire(new l.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:y.getSource().id})),y.setEventedParent(null),y.clearTiles();return delete this._otherSourceCaches[n],delete this._symbolSourceCaches[n],a.setEventedParent(null),a.onRemove&&a.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(n,a){this._checkLoaded(),this.getSource(n).setData(a),this._changed=!0}getSource(n){const a=this._getSourceCache(n);return a&&a.getSource()}_getSources(){const n=[];for(const a in this._otherSourceCaches){const p=this._getSourceCache(a);p&&n.push(p.getSource())}return n}addLayer(n,a,p={}){this._checkLoaded();const y=n.id;if(this.getLayer(y))return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${y}" already exists on this map`)));let x;if("custom"===n.type){if($o(this,l.validateCustomStyleLayer(n)))return;x=l.createStyleLayer(n)}else{if("object"==typeof n.source&&(this.addSource(y,n.source),n=l.clone$1(n),n=l.extend(n,{source:y})),this._validate(l.validateLayer,`layers.${y}`,n,{arrayIndex:-1},p))return;x=l.createStyleLayer(n),this._validateLayer(x),x.setEventedParent(this,{layer:{id:y}}),this._serializedLayers[x.id]=x.serialize(),this._updateLayerCount(x,!0)}const D=a?this._order.indexOf(a):this._order.length;if(a&&-1===D)return void this.fire(new l.ErrorEvent(new Error(`Layer with id "${a}" does not exist on this map.`)));this._order.splice(D,0,y),this._layerOrderChanged=!0,this._layers[y]=x;const I=this._getLayerSourceCache(x);if(this._removedLayers[y]&&x.source&&I&&"custom"!==x.type){const R=this._removedLayers[y];delete this._removedLayers[y],R.type!==x.type?this._updatedSources[x.source]="clear":(this._updatedSources[x.source]="reload",I.pause())}this._updateLayer(x),x.onAdd&&x.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(n,a){if(this._checkLoaded(),this._changed=!0,!this._layers[n])return void this.fire(new l.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be moved.`)));if(n===a)return;const p=this._order.indexOf(n);this._order.splice(p,1);const y=a?this._order.indexOf(a):this._order.length;a&&-1===y?this.fire(new l.ErrorEvent(new Error(`Layer with id "${a}" does not exist on this map.`))):(this._order.splice(y,0,n),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(n){this._checkLoaded();const a=this._layers[n];if(!a)return void this.fire(new l.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be removed.`)));a.setEventedParent(null),this._updateLayerCount(a,!1);const p=this._order.indexOf(n);this._order.splice(p,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[n]=a,delete this._layers[n],delete this._serializedLayers[n],delete this._updatedLayers[n],delete this._updatedPaintProps[n],a.onRemove&&a.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(n){return this._layers[n]}hasLayer(n){return n in this._layers}hasLayerType(n){for(const a in this._layers)if(this._layers[a].type===n)return!0;return!1}setLayerZoomRange(n,a,p){this._checkLoaded();const y=this.getLayer(n);y?y.minzoom===a&&y.maxzoom===p||(null!=a&&(y.minzoom=a),null!=p&&(y.maxzoom=p),this._updateLayer(y)):this.fire(new l.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(n,a,p={}){this._checkLoaded();const y=this.getLayer(n);if(y){if(!B(y.filter,a))return null==a?(y.filter=void 0,void this._updateLayer(y)):void(this._validate(l.validateFilter,`layers.${y.id}.filter`,a,{layerType:y.type},p)||(y.filter=l.clone$1(a),this._updateLayer(y)))}else this.fire(new l.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be filtered.`)))}getFilter(n){const a=this.getLayer(n);return a&&l.clone$1(a.filter)}setLayoutProperty(n,a,p,y={}){this._checkLoaded();const x=this.getLayer(n);x?B(x.getLayoutProperty(a),p)||(x.setLayoutProperty(a,p,y),this._updateLayer(x)):this.fire(new l.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(n,a){const p=this.getLayer(n);if(p)return p.getLayoutProperty(a);this.fire(new l.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style.`)))}setPaintProperty(n,a,p,y={}){this._checkLoaded();const x=this.getLayer(n);x?B(x.getPaintProperty(a),p)||(x.setPaintProperty(a,p,y)&&this._updateLayer(x),this._changed=!0,this._updatedPaintProps[n]=!0):this.fire(new l.ErrorEvent(new Error(`The layer '${n}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(n,a){const p=this.getLayer(n);return p&&p.getPaintProperty(a)}setFeatureState(n,a){this._checkLoaded();const p=n.source,y=n.sourceLayer,x=this.getSource(p);if(!x)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const D=x.type;if("geojson"===D&&y)return void this.fire(new l.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if("vector"===D&&!y)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));void 0===n.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided.")));const I=this._getSourceCaches(p);for(const R of I)R.setFeatureState(y,n.id,a)}removeFeatureState(n,a){this._checkLoaded();const p=n.source,y=this.getSource(p);if(!y)return void this.fire(new l.ErrorEvent(new Error(`The source '${p}' does not exist in the map's style.`)));const x=y.type,D="vector"===x?n.sourceLayer:void 0;if("vector"===x&&!D)return void this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(a&&"string"!=typeof n.id&&"number"!=typeof n.id)return void this.fire(new l.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const I=this._getSourceCaches(p);for(const R of I)R.removeFeatureState(D,n.id,a)}getFeatureState(n){this._checkLoaded();const a=n.source,p=n.sourceLayer,y=this.getSource(a);if(y){if("vector"!==y.type||p)return void 0===n.id&&this.fire(new l.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(a)[0].getFeatureState(p,n.id);this.fire(new l.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new l.ErrorEvent(new Error(`The source '${a}' does not exist in the map's style.`)))}getTransition(){return l.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const n={};for(const a in this._sourceCaches){const p=this._sourceCaches[a].getSource();n[p.id]||(n[p.id]=p.serialize())}return l.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:n,layers:this._serializeLayers(this._order)},a=>void 0!==a)}_updateLayer(n){this._updatedLayers[n.id]=!0;const a=this._getLayerSourceCache(n);n.source&&!this._updatedSources[n.source]&&a&&"raster"!==a.getSource().type&&(this._updatedSources[n.source]="reload",a.pause()),this._changed=!0,n.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(n){const a=D=>"fill-extrusion"===this._layers[D].type,p={},y=[];for(let D=this._order.length-1;D>=0;D--){const I=this._order[D];if(a(I)){p[I]=D;for(const R of n){const U=R[I];if(U)for(const z of U)y.push(z)}}}y.sort((D,I)=>I.intersectionZ-D.intersectionZ);const x=[];for(let D=this._order.length-1;D>=0;D--){const I=this._order[D];if(a(I))for(let R=y.length-1;R>=0;R--){const U=y[R].feature;if(p[U.layer.id]<D)break;x.push(U),y.pop()}else for(const R of n){const U=R[I];if(U)for(const z of U)x.push(z.feature)}}return x}queryRenderedFeatures(n,a,p){a&&a.filter&&this._validate(l.validateFilter,"queryRenderedFeatures.filter",a.filter,null,a);const y={};if(a&&a.layers){if(!Array.isArray(a.layers))return this.fire(new l.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const R of a.layers){const U=this._layers[R];if(!U)return this.fire(new l.ErrorEvent(new Error(`The layer '${R}' does not exist in the map's style and cannot be queried for features.`))),[];y[U.source]=!0}}const x=[];a.availableImages=this._availableImages;const D=a&&a.layers?a.layers.some(R=>{const U=this.getLayer(R);return U&&U.is3D()}):this.has3DLayers(),I=Ut.createFromScreenPoints(n,p);for(const R in this._sourceCaches){const U=this._sourceCaches[R].getSource().id;a.layers&&!y[U]||x.push(In(this._sourceCaches[R],this._layers,this._serializedLayers,I,a,p,D,!!this.map._showQueryGeometry))}return this.placement&&x.push(function(R,U,z,Q,Se,je,Ye){const $e={},et=je.queryRenderedSymbols(Q),ne=[];for(const He of Object.keys(et).map(Number))ne.push(Ye[He]);ne.sort(wi);for(const He of ne){const ht=He.featureIndex.lookupSymbolFeatures(et[He.bucketInstanceId],U,He.bucketIndex,He.sourceLayerIndex,Se.filter,Se.layers,Se.availableImages,R);for(const gt in ht){const Ot=$e[gt]=$e[gt]||[],kt=ht[gt];kt.sort((Lt,qt)=>{const $t=He.featureSortOrder;if($t){const cn=$t.indexOf(Lt.featureIndex);return $t.indexOf(qt.featureIndex)-cn}return qt.featureIndex-Lt.featureIndex});for(const Lt of kt)Ot.push(Lt)}}for(const He in $e)$e[He].forEach(ht=>{const gt=ht.feature,Ot=z(R[He]);if(!Ot)return;const kt=Ot.getFeatureState(gt.layer["source-layer"],gt.id);gt.source=gt.layer.source,gt.layer["source-layer"]&&(gt.sourceLayer=gt.layer["source-layer"]),gt.state=kt});return $e}(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),I.screenGeometry,a,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(x)}querySourceFeatures(n,a){a&&a.filter&&this._validate(l.validateFilter,"querySourceFeatures.filter",a.filter,null,a);const p=this._getSourceCaches(n);let y=[];for(const x of p)y=y.concat(bi(x,a));return y}addSourceType(n,a,p){return to.getSourceType(n)?p(new Error(`A source type called "${n}" already exists.`)):(to.setSourceType(n,a),a.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:n,url:a.workerSourceURL},p):p(null,null))}getLight(){return this.light.getLight()}setLight(n,a={}){this._checkLoaded();const p=this.light.getLight();let y=!1;for(const D in n)if(!B(n[D],p[D])){y=!0;break}if(!y)return;const x=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(n,a),this.light.updateTransitions(x)}getTerrain(){return this.terrain&&1===this.terrain.drapeRenderMode?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(n,a=1){if(this._checkLoaded(),!n)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let p=n;if(1===a){if("object"==typeof p.source){const y="terrain-dem-src";this.addSource(y,p.source),p=l.clone$1(p),p=l.extend(p,{source:y})}if(this._validate(l.validateTerrain,"terrain",p))return}if(!this.terrain||this.terrain&&a!==this.terrain.drapeRenderMode){if(!p)return;this._createTerrain(p,a)}else{const y=this.terrain,x=y.get();for(const D of Object.keys(l.spec.terrain))!p.hasOwnProperty(D)&&l.spec.terrain[D].default&&(p[D]=l.spec.terrain[D].default);for(const D in p)if(!B(p[D],x[D])){y.set(p),this.stylesheet.terrain=p;const I=this._setTransitionParameters({duration:0});y.updateTransitions(I);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(n){const a=this.fog=new Ht(n,this.map.transform);this.stylesheet.fog=n;const p=this._setTransitionParameters({duration:0});a.updateTransitions(p)}_updateMarkersOpacity(){0!==this.map._markers.length&&this.map._requestDomTask(()=>{for(const n of this.map._markers)n._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(n){if(this._checkLoaded(),!n)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const a=this.fog,p=a.get();0===Object.keys(n).length&&a.set(n);for(const y in n)if(!B(n[y],p[y])){a.set(n),this.stylesheet.fog=n;const x=this._setTransitionParameters({duration:0});a.updateTransitions(x);break}}else this._createFog(n);this._markersNeedUpdate=!0}_setTransitionParameters(n){return{now:l.exported.now(),transition:l.extend(n,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const n=this._order.filter(p=>this.isLayerDraped(this._layers[p])),a=this._order.filter(p=>!this.isLayerDraped(this._layers[p]));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...n),this._drapedFirstOrder.push(...a)}_createTerrain(n,a){const p=this.terrain=new Fe(n,a);this.stylesheet.terrain=n,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const y=this._setTransitionParameters({duration:0});p.updateTransitions(y)}_force3DLayerUpdate(){for(const n in this._layers){const a=this._layers[n];"fill-extrusion"===a.type&&this._updateLayer(a)}}_forceSymbolLayerUpdate(){for(const n in this._layers){const a=this._layers[n];"symbol"===a.type&&this._updateLayer(a)}}_validate(n,a,p,y,x={}){return(!x||!1!==x.validate)&&$o(this,n.call(l.validateStyle,l.extend({key:a,style:this.serialize(),value:p,styleSpec:l.spec},y)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),l.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const n in this._layers)this._layers[n].setEventedParent(null);for(const n in this._sourceCaches)this._sourceCaches[n].clearTiles(),this._sourceCaches[n].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(n){const a=this._getSourceCaches(n);for(const p of a)p.clearTiles()}_reloadSource(n){const a=this._getSourceCaches(n);for(const p of a)p.resume(),p.reload()}_reloadSources(){for(const n of this._getSources())n.reload&&n.reload()}_updateSources(n){for(const a in this._sourceCaches)this._sourceCaches[a].update(n)}_generateCollisionBoxes(){for(const n in this._sourceCaches){const a=this._sourceCaches[n];a.resume(),a.reload()}}_updatePlacement(n,a,p,y,x=!1){let D=!1,I=!1;const R={};for(const U of this._order){const z=this._layers[U];if("symbol"!==z.type)continue;if(!R[z.source]){const Se=this._getLayerSourceCache(z);if(!Se)continue;R[z.source]=Se.getRenderableIds(!0).map(je=>Se.getTileByID(je)).sort((je,Ye)=>Ye.tileID.overscaledZ-je.tileID.overscaledZ||(je.tileID.isLessThan(Ye.tileID)?-1:1))}const Q=this.crossTileSymbolIndex.addLayer(z,R[z.source],n.center.lng,n.projection);D=D||Q}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),x=x||this._layerOrderChanged||0===p,this._layerOrderChanged&&this.fire(new l.Event("neworder")),(x||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(l.exported.now(),n.zoom))&&(this.pauseablePlacement=new ho(n,this._order,x,a,p,y,this.placement,this.fog&&n.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,R),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(l.exported.now()),I=!0),D&&this.pauseablePlacement.placement.setStale()),I||D)for(const U of this._order){const z=this._layers[U];"symbol"===z.type&&this.placement.updateLayerOpacities(z,R[z.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(l.exported.now())}_releaseSymbolFadeTiles(){for(const n in this._sourceCaches)this._sourceCaches[n].releaseSymbolFadeTiles()}getImages(n,a,p){this.imageManager.getImages(a.icons,p),this._updateTilesForChangedImages();const y=x=>{x&&x.setDependencies(a.tileID.key,a.type,a.icons)};y(this._otherSourceCaches[a.source]),y(this._symbolSourceCaches[a.source])}getGlyphs(n,a,p){this.glyphManager.getGlyphs(a.stacks,p)}getResource(n,a,p){return l.makeRequest(a,p)}_getSourceCache(n){return this._otherSourceCaches[n]}_getLayerSourceCache(n){return"symbol"===n.type?this._symbolSourceCaches[n.source]:this._otherSourceCaches[n.source]}_getSourceCaches(n){const a=[];return this._otherSourceCaches[n]&&a.push(this._otherSourceCaches[n]),this._symbolSourceCaches[n]&&a.push(this._symbolSourceCaches[n]),a}_isSourceCacheLoaded(n){const a=this._getSourceCaches(n);return 0===a.length?(this.fire(new l.ErrorEvent(new Error(`There is no source with ID '${n}'`))),!1):a.every(p=>p.loaded())}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}to.getSourceType=function(u){return Re[u]},to.setSourceType=function(u,n){Re[u]=n},to.registerForPluginStateChange=l.registerForPluginStateChange;var fr="\n#define EPSILON 0.0000001\n#define PI 3.141592653589793\n#define EXTENT 8192.0\n#define HALF_PI PI/2.0\n#define QUARTER_PI PI/4.0\n#define RAD_TO_DEG 180.0/PI\n#define DEG_TO_RAD PI/180.0\n#define GLOBE_RADIUS EXTENT/PI/2.0",vo="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",Yo="\n#define ELEVATION_SCALE 7.0\n#define ELEVATION_OFFSET 450.0\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(\nmix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}\n#else\nvec3 elevationVector(vec2 pos) { return vec3(0,0,1); }\n#endif\nconst float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)\n{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}\n#ifdef TERRAIN\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nuniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;\n#else\nuniform sampler2D u_dem;uniform sampler2D u_dem_prev;\n#endif\nuniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));\n#ifdef TERRAIN_DEM_NEAREST_FILTER\nreturn u_exaggeration*tl;\n#endif\nfloat tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}float prevElevation(vec2 apos) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nvec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;\n#else\nfloat dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);\n#endif\n}\n#ifdef TERRAIN_VERTEX_MORPHING\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nfloat nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}\n#else\nfloat elevation(vec2 apos) {\n#ifdef ZERO_EXAGGERATION\nreturn 0.0;\n#endif\nreturn currentElevation(apos);}\n#endif\nhighp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(\nunpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))\n);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nfloat tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;\n#else\nvec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);\n#endif\nreturn vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}\n#else\nfloat elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }\n#endif",zs="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}\n#endif",Po="#ifdef FOG\nuniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}\n#endif";let Jo={},vs={};const Ko=[];xs(fr,Ko),xs(Yo,Ko),xs(zs,Ko),xs(Po,Ko),Jo=Wi("",Yo),vs=Wi(Po,zs);const rl=Wi("\n#if __VERSION__ >=300\n#define varying in\n#define gl_FragColor glFragColor\n#define texture2D texture\n#define textureCube texture\nout vec4 glFragColor;\n#endif\nhighp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)\n{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}","\n#if __VERSION__ >=300\n#define attribute in\n#define varying out\n#define texture2D texture\n#endif\nfloat wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {\n#ifndef PROJECTED_POS_ON_VIEWPORT\nfloat tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;\n#else\nreturn vec3(0.0);\n#endif\n}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}\n#endif\nvec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(\nunpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0\n);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered."),la=fr,ca="\n#ifdef GL_ES\nprecision mediump float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif";var Ba={background:Wi("uniform vec4 u_color;uniform float u_opacity;\n#ifdef LIGHTING_3D_MODE\nvarying vec4 v_color;\n#endif\nvoid main() {vec4 out_color;\n#ifdef LIGHTING_3D_MODE\nout_color=v_color;\n#else\nout_color=u_color;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#ifdef LIGHTING_3D_MODE\nuniform vec4 u_color;varying vec4 v_color;\n#endif\nvoid main() {gl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(u_color);\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),backgroundPattern:Wi("uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),circle:Wi("varying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(\nantialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)\n);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_apply_premultiplied(out_color,v_fog_pos);\n#endif\ngl_FragColor=out_color*(v_visibility*opacity_t);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","#define NUM_VISIBILITY_RINGS 2\n#define INV_SQRT2 0.70710678\n#define ELEVATION_BIAS 0.0001\n#define NUM_SAMPLES_PER_RING 16\nuniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec3 v_data;varying float v_visibility;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define mediump float radius\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define highp vec4 stroke_color\n#pragma mapbox: define mediump float stroke_width\n#pragma mapbox: define lowp float stroke_opacity\nvec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {\n#if defined(TERRAIN)\nreturn elevation(pos)+ELEVATION_BIAS;\n#else\nreturn 0.0;\n#endif\n}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);\n#ifdef PITCH_WITH_MAP\n#ifdef PROJECTION_GLOBE_VIEW\nreturn u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );\n#else\nreturn u_matrix*( world_center+vec4(sample_offset,0,0) );\n#endif\n#else\nreturn projected_center+vec4(sample_offset,0,0);\n#endif\n}float get_sample_step() {\n#ifdef PITCH_WITH_MAP\nreturn 2.0*PI/float(NUM_SAMPLES_PER_RING);\n#else\nreturn PI/float(NUM_SAMPLES_PER_RING);\n#endif\n}void main(void) {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize mediump float radius\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize highp vec4 stroke_color\n#pragma mapbox: initialize mediump float stroke_width\n#pragma mapbox: initialize lowp float stroke_opacity\nvec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);\n#else \nsurface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);\n#endif\nvec4 projected_center=u_matrix*world_center;float view_scale=0.0;\n#ifdef PITCH_WITH_MAP\n#ifdef SCALE_WITH_MAP\nview_scale=1.0;\n#else\nview_scale=projected_center.w/u_camera_to_center_distance;\n#endif\n#else\n#ifdef SCALE_WITH_MAP\nview_scale=u_camera_to_center_distance;\n#else\nview_scale=projected_center.w;\n#endif\n#endif\ngl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;\n#ifdef TERRAIN\nfloat step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;\n#ifdef PITCH_WITH_MAP\nfloat cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;\n#else\nocclusion_world_center=world_center;occlusion_projected_center=projected_center;\n#endif\nfor(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);\n#else\nvisibility=1.0;\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nvisibility=1.0;\n#endif\nv_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);\n#ifdef FOG\nv_fog_pos=fog_position(world_center.xyz);\n#endif\n}"),clippingMask:Wi("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Wi("uniform highp float u_intensity;varying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#define GAUSS_COEF 0.3989422804014327\nvoid main() {\n#pragma mapbox: initialize highp float weight\nfloat d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);\n#ifdef FOG\nif (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;\n#endif\nvarying vec2 v_extrude;\n#pragma mapbox: define highp float weight\n#pragma mapbox: define mediump float radius\nconst highp float ZERO=1.0/255.0/16.0;\n#define GAUSS_COEF 0.3989422804014327\nvoid main(void) {\n#pragma mapbox: initialize highp float weight\n#pragma mapbox: initialize mediump float radius\nvec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#else\npos=vec3(tilePos+extrude,elevation(tilePos));\n#endif\ngl_Position=u_matrix*vec4(pos,1);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),heatmapTexture:Wi("uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(0.0);\n#endif\n}","attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Wi("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}","attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Wi("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(\nmix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(\n0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Wi("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;\n#endif\nvarying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;\n#ifdef PROJECTION_GLOBE_VIEW\ngl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);\n#else\ngl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);\n#endif\n}"),fill:Wi("#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\nvec4 out_color=color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutline:Wi("varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;\n#pragma mapbox: define highp vec4 outline_color\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize highp vec4 outline_color\n#pragma mapbox: initialize lowp float opacity\ngl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillOutlinePattern:Wi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillPattern:Wi("uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color*opacity;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),fillExtrusion:Wi("varying vec4 v_color;\n#ifdef RENDER_SHADOWS\nvarying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\nvoid main() {\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvec3 normal=v_normal;\n#endif\nfloat z;vec4 color;\n#ifdef ZERO_ROOF_RADIUS\nz=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);\n#else\ncolor=v_color;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;\n#ifdef ZERO_ROOF_RADIUS\nconcave*=(1.0-z);\n#endif\nfloat x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;\n#endif\n#ifdef RENDER_SHADOWS\n#ifdef ZERO_ROOF_RADIUS\nnormal=mix(normal,vec3(0.0,0.0,1.0),z);\n#endif\ncolor.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec4 v_color;\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;\n#endif\n#ifdef ZERO_ROOF_RADIUS\nvarying vec4 v_roof_color;\n#endif\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nvarying highp vec3 v_normal;\n#endif\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#pragma mapbox: define highp float base\n#pragma mapbox: define highp float height\n#pragma mapbox: define highp vec4 color\nvoid main() {\n#pragma mapbox: initialize highp float base\n#pragma mapbox: initialize highp float height\n#pragma mapbox: initialize highp vec4 color\nvec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));\n#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)\nv_normal=normal;\n#endif\nbase=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=0.0;float c_ele;vec3 pos;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);\n#else\nh=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);\n#ifdef RENDER_SHADOWS\nv_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;\n#endif\nfloat NdotL=0.0;float colorvalue=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\ncolorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_color=apply_lighting(color,NdotL);\n#else\nv_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_color*=u_opacity;\n#ifdef ZERO_ROOF_RADIUS\nv_roof_color=vec4(0.0,0.0,0.0,1.0);\n#ifdef LIGHTING_3D_MODE\nv_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));\n#else\nfloat roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));\n#endif\nv_roof_color*=u_opacity;\n#endif\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),fillExtrusionPattern:Wi("uniform vec2 u_texsize;uniform sampler2D u_image;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color,v_NdotL)*u_opacity;\n#else\nout_color=out_color*v_lighting;\n#endif\n#ifdef FAUX_AO\nfloat intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\ngl_FragColor=out_color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;\n#endif\nvarying vec2 v_pos;varying vec4 v_lighting;\n#ifdef FAUX_AO\nuniform lowp vec2 u_ao;varying vec3 v_ao;\n#endif\n#ifdef LIGHTING_3D_MODE\nvarying float v_NdotL;\n#endif\n#pragma mapbox: define lowp float base\n#pragma mapbox: define lowp float height\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float base\n#pragma mapbox: initialize lowp float height\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);\n#if defined(HAS_CENTROID) || defined(TERRAIN)\ncentroid_pos=a_centroid_pos;\n#endif\nfloat ele=0.0;float h=z;vec3 p;float c_ele;\n#ifdef TERRAIN\nbool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);\n#else\np=vec3(pos_nx.xy,z);\n#endif\n#ifdef PROJECTION_GLOBE_VIEW\nfloat lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);\n#endif\nfloat hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0\n? pos_nx.xy\n: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;\n#ifdef LIGHTING_3D_MODE\nNdotL=calculate_NdotL(normal);\n#else\nNdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);\n#endif\nif (normal.y !=0.0) {float r=0.84;\n#ifndef LIGHTING_3D_MODE\nr=mix(0.7,0.98,1.0-u_lightintensity);\n#endif\nNdotL*=(\n(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}\n#ifdef FAUX_AO\nfloat concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;\n#ifdef TERRAIN\ntop_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);\n#endif\nv_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);\n#ifdef PROJECTION_GLOBE_VIEW\ntop_height+=u_height_lift;\n#endif\ngl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;\n#endif\n#ifdef LIGHTING_3D_MODE\nv_NdotL=NdotL;\n#else\nv_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;\n#endif \n#ifdef FOG\nv_fog_pos=fog_position(p);\n#endif\n}"),hillshadePrepare:Wi("#ifdef GL_ES\nprecision highp float;\n#endif\nuniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {\n#ifdef TERRAIN_DEM_FLOAT_FORMAT\nreturn texture2D(u_image,coord).a/4.0;\n#else\nvec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;\n#endif\n}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(\n(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)\n)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(\nderiv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Wi("uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;\n#ifdef LIGHTING_3D_MODE\ngl_FragColor=apply_lighting(gl_FragColor);\n#endif\n#ifdef FOG\ngl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),line:Wi("uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform sampler2D u_dash_image;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform sampler2D u_gradient_image;\n#endif\nuniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nfloat linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nfloat dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);\n#ifdef RENDER_LINE_DASH\nfloat sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);\n#endif\nhighp vec4 out_color;\n#ifdef RENDER_LINE_GRADIENT\nout_color=texture2D(u_gradient_image,v_uv.xy);\n#else\nout_color=color;\n#endif\nfloat trimmed=1.0;\n#ifdef RENDER_LINE_TRIM_OFFSET\nhighp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}\n#endif\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));\n#endif\n#ifdef RENDER_LINE_ALPHA_DISCARD\nif (alpha < u_alpha_discard_threshold) {discard;}\n#endif\n#ifdef RENDER_LINE_BORDER\nfloat edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);\n#ifdef RENDER_LINE_BORDER_AUTO\nfloat Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}\n#else\nout_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);\n#endif\n}\n#endif\ngl_FragColor=out_color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define EXTRUDE_SCALE 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nattribute highp vec4 a_packed;\n#endif\n#ifdef RENDER_LINE_DASH\nattribute float a_linesofar;\n#endif\nuniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;\n#ifdef RENDER_LINE_DASH\nuniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;\n#endif\n#ifdef RENDER_LINE_GRADIENT\nuniform float u_image_height;\n#endif\n#pragma mapbox: define highp vec4 color\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 dash\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float width\nvoid main() {\n#pragma mapbox: initialize highp vec4 color\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize lowp vec4 dash\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float width\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\n#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)\nfloat a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];\n#ifdef RENDER_LINE_GRADIENT\nhighp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);\n#else\nv_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);\n#endif\n#endif\n#ifdef RENDER_LINE_DASH\nfloat scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);\n#endif\nv_width2=vec2(outset,inset);\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),linePattern:Wi("uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\nvec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);\n#ifdef LIGHTING_3D_MODE\ncolor=apply_lighting(color);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color*(alpha*opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","\n#define scale 0.015873016\nattribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;\n#pragma mapbox: define lowp float blur\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float offset\n#pragma mapbox: define mediump float gapwidth\n#pragma mapbox: define mediump float width\n#pragma mapbox: define lowp float floorwidth\n#pragma mapbox: define lowp vec4 pattern\n#pragma mapbox: define lowp float pixel_ratio\nvoid main() {\n#pragma mapbox: initialize lowp float blur\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float offset\n#pragma mapbox: initialize mediump float gapwidth\n#pragma mapbox: initialize mediump float width\n#pragma mapbox: initialize lowp float floorwidth\n#pragma mapbox: initialize mediump vec4 pattern\n#pragma mapbox: initialize lowp float pixel_ratio\nfloat ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;\n#ifndef RENDER_TO_TEXTURE\nfloat extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;\n#else\nv_gamma_scale=1.0;\n#endif\nv_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;\n#ifdef FOG\nv_fog_pos=fog_position(pos);\n#endif\n}"),raster:Wi("uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(\ndot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);\n#ifdef LIGHTING_3D_MODE\nout_color=apply_lighting(out_color);\n#endif\n#ifdef FOG\nout_color=fog_dither(fog_apply(out_color,v_fog_pos));\n#endif\ngl_FragColor=vec4(out_color*color.a,color.a);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;\n#ifdef FOG\nv_fog_pos=fog_position(a_pos);\n#endif\n}"),symbolIcon:Wi("uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nlowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_tex;varying float v_fade_opacity;\n#pragma mapbox: define lowp float opacity\nvoid main() {\n#pragma mapbox: initialize lowp float opacity\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}"),symbolSDF:Wi("#define SDF_PX 8.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec2 v_data0;varying vec3 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);\n#else\noffsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);\n#endif\nvec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nvec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}"),symbolTextAndIcon:Wi("#define SDF_PX 8.0\n#define SDF 1.0\n#define ICON 0.0\nuniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nfloat fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\nreturn;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;\n#ifdef PROJECTION_GLOBE_VIEW\nattribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;\n#endif\nuniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;\n#ifdef PROJECTION_GLOBE_VIEW\nuniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;\n#endif\nvarying vec4 v_data0;varying vec4 v_data1;\n#pragma mapbox: define highp vec4 fill_color\n#pragma mapbox: define highp vec4 halo_color\n#pragma mapbox: define lowp float opacity\n#pragma mapbox: define lowp float halo_width\n#pragma mapbox: define lowp float halo_blur\nvoid main() {\n#pragma mapbox: initialize highp vec4 fill_color\n#pragma mapbox: initialize highp vec4 halo_color\n#pragma mapbox: initialize lowp float opacity\n#pragma mapbox: initialize lowp float halo_width\n#pragma mapbox: initialize lowp float halo_blur\nvec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nmercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;\n#else\nworld_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;\n#endif\nvec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?\ncamera_to_anchor_distance/u_camera_to_center_distance :\nu_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(\n0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);\n#else\nprojected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);\n#endif\nhighp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);\n#ifdef TERRAIN\n#ifdef PITCH_WITH_MAP_TERRAIN\nvec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);\n#endif\n#endif\nfloat occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;\n#ifdef PROJECTION_GLOBE_VIEW\nvec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#else\ngl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));\n#endif\nfloat gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;\n#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)\nprojection_transition_fade=1.0-step(EPSILON,u_zoom_transition);\n#endif\nv_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}"),terrainRaster:Wi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nvarying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nvoid main() {vec4 color=texture2D(u_image0,v_pos0);\n#ifdef RENDER_SHADOWS\ncolor.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);\n#endif\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#else\ncolor=fog_dither(fog_apply_from_vert(color,v_fog_opacity));\n#endif\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;\n#ifdef FOG\nvarying float v_fog_opacity;\n#endif\n#ifdef RENDER_SHADOWS\nuniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;\n#endif\nconst float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;\n#ifdef TERRAIN_WIREFRAME\nelevation+=wireframeOffset;\n#endif\nv_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);\n#ifdef FOG\n#ifdef ZERO_EXAGGERATION\nv_fog_pos=fog_position(decodedPos);\n#else\nv_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));\n#endif\n#endif\n#ifdef RENDER_SHADOWS\nvec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;\n#endif\n}"),terrainDepth:Wi("#ifdef GL_ES\nprecision highp float;\n#endif\nvarying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}","uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Wi("\nvarying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(\ncos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;\n#ifdef FOG\nsky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);\n#endif\nsky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",vo),skyboxGradient:Wi("varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));\n#ifdef FOG\ncolor.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;\n#endif\ncolor*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}",vo),skyboxCapture:Wi("\nvarying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;\n#ifdef GL_ES\nprecision highp float;\n#endif\n#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)\n#define BETA_M                  vec3(21e-6,21e-6,21e-6)\n#define MIE_G                   0.76\n#define DENSITY_HEIGHT_SCALE_R  8000.0\n#define DENSITY_HEIGHT_SCALE_M  1200.0\n#define PLANET_RADIUS           6360e3\n#define ATMOSPHERE_RADIUS       6420e3\n#define SAMPLE_STEPS            10\n#define DENSITY_STEPS           4\nfloat ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}","attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Wi("uniform sampler2D u_image0;varying vec2 v_pos0;\n#ifndef FOG\nuniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;\n#endif\nvoid main() {vec4 color;\n#ifdef CUSTOM_ANTIALIASING\nvec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);\n#else\ncolor=texture2D(u_image0,v_pos0);\n#endif\n#ifdef FOG\ncolor=fog_dither(fog_apply_premultiplied(color,v_fog_pos));\n#endif\ngl_FragColor=color;\n#ifdef TERRAIN_WIREFRAME\ngl_FragColor=vec4(1.0,0.0,0.0,0.8);\n#endif\n#ifdef OVERDRAW_INSPECTOR\ngl_FragColor=vec4(1.0);\n#endif\n}","uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;\n#ifdef GLOBE_POLES\nattribute vec3 a_globe_pos;attribute vec2 a_uv;\n#else\nattribute vec2 a_pos;\n#endif\nvarying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {\n#ifdef GLOBE_POLES\nvec3 globe_pos=a_globe_pos;vec2 uv=a_uv;\n#else\nfloat tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);\n#endif\nv_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;\n#ifdef GLOBE_POLES\nvec3 up_vector=globe_derived_up_vector;\n#else\nvec3 up_vector=elevationVector(tile_pos);\n#endif\nfloat height=elevation(tile_pos);\n#ifdef TERRAIN_WIREFRAME\nheight+=wireframeOffset;\n#endif\nglobe_pos+=up_vector*height;\n#ifndef GLOBE_POLES\nglobe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;\n#endif\n#ifdef GLOBE_POLES\nvec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);\n#else\nvec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);\n#endif\ngl_Position=u_proj_matrix*interpolated_pos;\n#ifdef FOG\nv_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);\n#endif\n}"),globeAtmosphere:Wi("uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;\n#ifdef PROJECTION_GLOBE_VIEW\nglobe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}\n#endif\nhighp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?\n0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;\n#ifdef PROJECTION_GLOBE_VIEW\nhighp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?\nPI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);\n#else\nhorizon_angle=horizon_angle_mercator;\n#endif\nhorizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:\n(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:\nuv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}","attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(\nmix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(\nmix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}")};function xs(u,n){const a=u.replace(/\s*\/\/[^\n]*\n/g,"\n").split("\n");for(let p of a)if(p=p.trim(),"#"===p[0]&&p.includes("if")&&!p.includes("endif")){p=p.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const y=p.split(" ");for(const x of y)n.includes(x)||n.push(x)}}function Wi(u,n){const a=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,p=n.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),y={},x=[...Ko];return xs(u,x),xs(n,x),{fragmentSource:u=u.replace(a,(D,I,R,U,z)=>(y[z]=!0,"define"===I?`\n#ifndef HAS_UNIFORM_u_${z}\nvarying ${R} ${U} ${z};\n#else\nuniform ${R} ${U} u_${z};\n#endif\n`:`\n#ifdef HAS_UNIFORM_u_${z}\n    ${R} ${U} ${z} = u_${z};\n#endif\n`)),vertexSource:n=n.replace(a,(D,I,R,U,z)=>{const Q="float"===U?"vec2":"vec4",Se=z.match(/color/)?"color":Q;return y[z]?"define"===I?`\n#ifndef HAS_UNIFORM_u_${z}\nuniform lowp float u_${z}_t;\nattribute ${R} ${Q} a_${z};\nvarying ${R} ${U} ${z};\n#else\nuniform ${R} ${U} u_${z};\n#endif\n`:"vec4"===Se?`\n#ifndef HAS_UNIFORM_u_${z}\n    ${z} = a_${z};\n#else\n    ${R} ${U} ${z} = u_${z};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${z}\n    ${z} = unpack_mix_${Se}(a_${z}, u_${z}_t);\n#else\n    ${R} ${U} ${z} = u_${z};\n#endif\n`:"define"===I?`\n#ifndef HAS_UNIFORM_u_${z}\nuniform lowp float u_${z}_t;\nattribute ${R} ${Q} a_${z};\n#else\nuniform ${R} ${U} u_${z};\n#endif\n`:"vec4"===Se?`\n#ifndef HAS_UNIFORM_u_${z}\n    ${R} ${U} ${z} = a_${z};\n#else\n    ${R} ${U} ${z} = u_${z};\n#endif\n`:`\n#ifndef HAS_UNIFORM_u_${z}\n    ${R} ${U} ${z} = unpack_mix_${Se}(a_${z}, u_${z}_t);\n#else\n    ${R} ${U} ${z} = u_${z};\n#endif\n`}),staticAttributes:p,usedDefines:x}}class za{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(n,a,p,y,x,D,I){this.context=n;let R=this.boundPaintVertexBuffers.length!==y.length;for(let z=0;!R&&z<y.length;z++)this.boundPaintVertexBuffers[z]!==y[z]&&(R=!0);let U=this.boundDynamicVertexBuffers.length!==I.length;for(let z=0;!U&&z<I.length;z++)this.boundDynamicVertexBuffers[z]!==I[z]&&(U=!0);if(!n.extVertexArrayObject||!this.vao||this.boundProgram!==a||this.boundLayoutVertexBuffer!==p||R||U||this.boundIndexBuffer!==x||this.boundVertexOffset!==D)this.freshBind(a,p,y,x,D,I);else{n.bindVertexArrayOES.set(this.vao);for(const z of I)z&&z.bind();x&&x.dynamicDraw&&x.bind()}}freshBind(n,a,p,y,x,D){let I;const R=n.numAttributes,U=this.context,z=U.gl;if(U.extVertexArrayObject)this.vao&&this.destroy(),this.vao=U.extVertexArrayObject.createVertexArrayOES(),U.bindVertexArrayOES.set(this.vao),I=0,this.boundProgram=n,this.boundLayoutVertexBuffer=a,this.boundPaintVertexBuffers=p,this.boundIndexBuffer=y,this.boundVertexOffset=x,this.boundDynamicVertexBuffers=D;else{I=U.currentNumAttributes||0;for(let Q=R;Q<I;Q++)z.disableVertexAttribArray(Q)}a.enableAttributes(z,n),a.bind(),a.setVertexAttribPointers(z,n,x);for(const Q of p)Q.enableAttributes(z,n),Q.bind(),Q.setVertexAttribPointers(z,n,x);for(const Q of D)Q&&(Q.enableAttributes(z,n),Q.bind(),Q.setVertexAttribPointers(z,n,x));y&&y.bind(),U.currentNumAttributes=R}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Ca(u,n){const a=Math.pow(2,n.canonical.z),p=n.canonical.y;return[new l.MercatorCoordinate(0,p/a).toLngLat().lat,new l.MercatorCoordinate(0,(p+1)/a).toLngLat().lat]}function bl(u,n,a,p,y,x,D){const I=u.context,R=I.gl,U=a.fbo;if(!U)return;u.prepareDrawTile();const z=u.useProgram("hillshade");I.activeTexture.set(R.TEXTURE0),R.bindTexture(R.TEXTURE_2D,U.colorAttachment.get());const Q=(($e,et,ne,He)=>{const ht=ne.paint.get("hillshade-shadow-color"),gt=ne.paint.get("hillshade-highlight-color"),Ot=ne.paint.get("hillshade-accent-color");let kt=ne.paint.get("hillshade-illumination-direction")*(Math.PI/180);"viewport"===ne.paint.get("hillshade-illumination-anchor")&&(kt-=$e.transform.angle);const Lt=!$e.options.moving;return{u_matrix:He||$e.transform.calculateProjMatrix(et.tileID.toUnwrapped(),Lt),u_image:0,u_latrange:Ca(0,et.tileID),u_light:[ne.paint.get("hillshade-exaggeration"),kt],u_shadow:ht,u_highlight:gt,u_accent:Ot}})(u,a,p,u.terrain?n.projMatrix:null);u.prepareDrawProgram(I,z,n.toUnwrapped());const{tileBoundsBuffer:Se,tileBoundsIndexBuffer:je,tileBoundsSegments:Ye}=u.getTileBoundsBuffers(a);z.draw(I,R.TRIANGLES,y,x,D,l.CullFaceMode.disabled,Q,p.id,Se,je,Ye)}function ol(u,n,a){if(!n.needsDEMTextureUpload)return;const p=u.context,y=p.gl;p.pixelStoreUnpackPremultiplyAlpha.set(!1),n.demTexture=n.demTexture||u.getTileTexture(a.stride);const x=a.getPixels();n.demTexture?n.demTexture.update(x,{premultiply:!1}):n.demTexture=new l.Texture(p,x,y.RGBA,{premultiply:!1}),n.needsDEMTextureUpload=!1}function Zl(u,n,a,p,y,x){const D=u.context,I=D.gl;if(!n.dem)return;const R=n.dem;if(D.activeTexture.set(I.TEXTURE1),ol(u,n,R),!n.demTexture)return;n.demTexture.bind(I.NEAREST,I.CLAMP_TO_EDGE);const U=R.dim;D.activeTexture.set(I.TEXTURE0);let z=n.fbo;if(!z){const Ye=new l.Texture(D,{width:U,height:U,data:null},I.RGBA);Ye.bind(I.LINEAR,I.CLAMP_TO_EDGE),z=n.fbo=D.createFramebuffer(U,U,!0),z.colorAttachment.set(Ye.texture)}D.bindFramebuffer.set(z.framebuffer),D.viewport.set([0,0,U,U]);const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:Se,tileBoundsSegments:je}=u.getMercatorTileBoundsBuffers();u.useProgram("hillshadePrepare").draw(D,I.TRIANGLES,p,y,x,l.CullFaceMode.disabled,((Ye,$e)=>{const et=$e.stride,ne=l.create();return l.ortho(ne,0,l.EXTENT,-l.EXTENT,0,0,1),l.translate(ne,ne,[0,-l.EXTENT,0]),{u_matrix:ne,u_image:1,u_dimension:[et,et],u_zoom:Ye.overscaledZ,u_unpack:$e.unpackVector}})(n.tileID,R),a.id,Q,Se,je),n.needsHillshadePrepare=!1}const ua=u=>({u_matrix:new l.UniformMatrix4f(u),u_image0:new l.Uniform1i(u),u_skirt_height:new l.Uniform1f(u)}),da=(u,n)=>({u_matrix:u,u_image0:0,u_skirt_height:n}),Ua=(u,n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye)=>({u_proj_matrix:Float32Array.from(u),u_globe_matrix:n,u_normalize_matrix:Float32Array.from(p),u_merc_matrix:a,u_zoom_transition:y,u_merc_center:x,u_image0:0,u_frustum_tl:D,u_frustum_tr:I,u_frustum_br:R,u_frustum_bl:U,u_globe_pos:z,u_globe_radius:Q,u_viewport:Se,u_grid_matrix:Ye?Float32Array.from(Ye):new Float32Array(9),u_skirt_height:je});function ja(u,n){return null!=u&&null!=n&&!(!u.hasData()||!n.hasData())&&null!=u.demTexture&&null!=n.demTexture&&u.tileID.key!==n.tileID.key}const Us=new class{constructor(){this.operations={}}newMorphing(u,n,a,p,y){if(u in this.operations){const x=this.operations[u];x.to.tileID.key!==a.tileID.key&&(x.queued=a)}else this.operations[u]={startTime:p,phase:0,duration:y,from:n,to:a,queued:null}}getMorphValuesForProxy(u){if(!(u in this.operations))return null;const n=this.operations[u];return{from:n.from,to:n.to,phase:n.phase}}update(u){for(const n in this.operations){const a=this.operations[n];for(a.phase=(u-a.startTime)/a.duration;a.phase>=1||!this._validOp(a);)if(!this._nextOp(a,u)){delete this.operations[n];break}}}_nextOp(u,n){return!!u.queued&&(u.from=u.to,u.to=u.queued,u.queued=null,u.phase=0,u.startTime=n,!0)}_validOp(u){return u.from.hasData()&&u.to.hasData()}},ha={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function Ea(u){return 6*Math.pow(1.5,22-u)}function Xo(u,n){const a=1<<u.z;return!n&&(0===u.x||u.x===a-1)||0===u.y||u.y===a-1}const fa=u=>({u_matrix:u});function ea(u,n,a,p,y){if(y>0){const x=l.exported.now(),D=(x-u.timeAdded)/y,I=n?(x-n.timeAdded)/y:-1,R=a.getSource(),U=p.coveringZoomLevel({tileSize:R.tileSize,roundZoom:R.roundZoom}),z=!n||Math.abs(n.tileID.overscaledZ-U)>Math.abs(u.tileID.overscaledZ-U),Q=z&&u.refreshedUponExpiration?1:l.clamp(z?D:1-I,0,1);return u.refreshedUponExpiration&&D>=1&&(u.refreshedUponExpiration=!1),n?{opacity:1,mix:1-Q}:{opacity:Q,mix:0}}return{opacity:1,mix:0}}class Gl extends l.SourceCache{constructor(n){const a={type:"raster-dem",maxzoom:n.transform.maxZoom},p=new dn(uo(),null),y=st("mock-dem",a,p,n.style);super("mock-dem",y,!1),y.setEventedParent(this),this._sourceLoaded=!0}_loadTile(n,a){n.state="loaded",a(null)}}class sl extends l.SourceCache{constructor(n){const a=st("proxy",{type:"geojson",maxzoom:n.transform.maxZoom},new dn(uo(),null),n.style);super("proxy",a,!1),a.setEventedParent(this),this.map=this.getSource().map=n,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(n,a,p){if(n.freezeTileCoverage)return;this.transform=n;const y=n.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((x,D)=>{if(x[D.key]="",!this._tiles[D.key]){const I=new l.Tile(D,this._source.tileSize*D.overscaleFactor(),n.tileZoom);I.state="loaded",this._tiles[D.key]=I}return x},{});for(const x in this._tiles)x in y||(this.freeFBO(x),this._tiles[x].unloadVectorData(),delete this._tiles[x])}freeFBO(n){const a=this.proxyCachedFBO[n];if(void 0!==a){const p=Object.values(a);this.renderCachePool.push(...p),delete this.proxyCachedFBO[n]}}deallocRenderCache(){this.renderCache.forEach(n=>n.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class nr extends l.OverscaledTileID{constructor(n,a,p){super(n.overscaledZ,n.wrap,n.canonical.z,n.canonical.x,n.canonical.y),this.proxyTileKey=a,this.projMatrix=p}}class ro extends l.Elevation{constructor(n,a){super(),this.painter=n,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[p,y,x]=function(R){const U=new l.StructArrayLayout2i4,z=new l.StructArrayLayout3ui6,Q=131;U.reserve(17161),z.reserve(33800);const Se=l.EXTENT/128,je=l.EXTENT+Se/2,Ye=je+Se;for(let et=-Se;et<Ye;et+=Se)for(let ne=-Se;ne<Ye;ne+=Se){const He=ne<0||ne>je||et<0||et>je?24575:0,ht=l.clamp(Math.round(ne),0,l.EXTENT),gt=l.clamp(Math.round(et),0,l.EXTENT);U.emplaceBack(ht+He,gt)}const $e=(et,ne)=>{const He=ne*Q+et;z.emplaceBack(He+1,He,He+Q),z.emplaceBack(He+Q,He+Q+1,He+1)};for(let et=1;et<129;et++)for(let ne=1;ne<129;ne++)$e(ne,et);return[0,129].forEach(et=>{for(let ne=0;ne<130;ne++)$e(ne,et),$e(et,ne)}),[U,z,32768]}(),D=n.context;this.gridBuffer=D.createVertexBuffer(p,l.posAttributes.members),this.gridIndexBuffer=D.createIndexBuffer(y),this.gridSegments=l.SegmentVector.simpleSegment(0,0,p.length,y.length),this.gridNoSkirtSegments=l.SegmentVector.simpleSegment(0,0,p.length,x),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new sl(a.map),this.orthoMatrix=l.create(),l.ortho(this.orthoMatrix,"globe"===this.painter.transform.projection.name?.015:0,l.EXTENT,0,l.EXTENT,0,1);const I=D.gl;this._overlapStencilMode=new l.StencilMode({func:I.GEQUAL,mask:255},0,255,I.KEEP,I.KEEP,I.REPLACE),this._previousZoom=n.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=a,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new Gl(a.map)}set style(n){n.on("data",this._onStyleDataEvent.bind(this)),n.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=n,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(n,a,p){if(n&&n.terrain){this._style!==n&&(this.style=n),this.enabled=!0;const y=n.terrain.properties;this.sourceCache=0===n.terrain.drapeRenderMode?this._mockSourceCache:n._getSourceCache(y.get("source")),this._exaggeration=y.get("exaggeration");const x=()=>{this.sourceCache.used&&l.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.\nThis leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const D=this.getScaledDemTileSize();this.sourceCache.update(a,D,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,x(),this._initializing=!0),x(),a.updateElevation(!0,p),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(a),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(n){this._findCoveringTileCache[n]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const n=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||100!==n.efficiency&&l.warnOnce(`Terrain render cache efficiency is not optimal (${n.efficiency}%) and performance\n                may be affected negatively, consider placing all background, fill and line layers before layer\n                with id '${n.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(n){n.coord&&"source"===n.dataType?this._clearRenderCacheForTile(n.sourceCacheId,n.coord):"style"===n.dataType&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const n in this._style._sourceCaches)this._style._sourceCaches[n].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach(n=>n.fb.destroy()),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const n=2*this.proxySourceCache.getSource().tileSize;return[n,n]}set useVertexMorphing(n){this._useVertexMorphing=n}updateTileBinding(n){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const a=this.proxySourceCache,p=this.painter.transform;this._initializing&&(this._initializing=0===p._centerAltitude&&-1===this.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(p.center),-1),this._emptyDEMTextureDirty=!this._initializing);const y=this.proxyCoords=a.getIds().map(R=>{const U=a.getTileByID(R).tileID;return U.projMatrix=p.calculateProjMatrix(U.toUnwrapped()),U});(function(R,U){const z=U.transform.pointCoordinate(U.transform.getCameraPoint()),Q=new l.Point(z.x,z.y);R.sort((Se,je)=>{if(je.overscaledZ-Se.overscaledZ)return je.overscaledZ-Se.overscaledZ;const Ye=new l.Point(Se.canonical.x+(1<<Se.canonical.z)*Se.wrap,Se.canonical.y),$e=new l.Point(je.canonical.x+(1<<je.canonical.z)*je.wrap,je.canonical.y),et=Q.mult(1<<Se.canonical.z);return et.x-=.5,et.y-=.5,et.distSqr(Ye)-et.distSqr($e)})})(y,this.painter),this._previousZoom=p.zoom;const x=this.proxyToSource||{};this.proxyToSource={},y.forEach(R=>{this.proxyToSource[R.key]={}}),this.terrainTileForTile={};const D=this._style._sourceCaches;for(const R in D){const U=D[R];if(!U.used||(U!==this.sourceCache&&this.resetTileLookupCache(U.id),this._setupProxiedCoordsForOrtho(U,n[R],x),U.usedForTerrain))continue;const z=n[R];U.getSource().reparseOverscaled&&this._assignTerrainTiles(z)}this.proxiedCoords[a.id]=y.map(R=>new nr(R,R.key,this.orthoMatrix)),this._assignTerrainTiles(y),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(x),this.renderingToTexture=!1,this._updateTimestamp=l.exported.now();const I={};this._visibleDemTiles=[];for(const R of this.proxyCoords){const U=this.terrainTileForTile[R.key];if(!U)continue;const z=U.tileID.key;z in I||(this._visibleDemTiles.push(U),I[z]=z)}}_assignTerrainTiles(n){this._initializing||n.forEach(a=>{if(this.terrainTileForTile[a.key])return;const p=this._findTileCoveringTileID(a,this.sourceCache);p&&(this.terrainTileForTile[a.key]=p)})}_prepareDEMTextures(){const n=this.painter.context,a=n.gl;for(const p in this.terrainTileForTile){const y=this.terrainTileForTile[p],x=y.dem;!x||y.demTexture&&!y.needsDEMTextureUpload||(n.activeTexture.set(a.TEXTURE1),ol(this.painter,y,x))}}_prepareDemTileUniforms(n,a,p,y){if(!a||null==a.demTexture)return!1;const x=n.tileID.canonical,D=Math.pow(2,a.tileID.canonical.z-x.z),I=y||"";return p[`u_dem_tl${I}`]=[x.x*D%1,x.y*D%1],p[`u_dem_scale${I}`]=D,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const n=this.painter.context,a=n.gl;if(!this._emptyDepthBufferTexture){const p=new l.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new l.Texture(n,p,a.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let n=0;const a=this._visibleDemTiles.reduce((p,y)=>{if(!y.dem)return p;const x=y.dem.tree.minimums[0];return x>0&&n++,p+x},0);return n?a/n:0}_updateEmptyDEMTexture(){const n=this.painter.context,a=n.gl;n.activeTexture.set(a.TEXTURE2);const p=this._getLoadedAreaMinimum(),y=new l.RGBAImage({width:1,height:1},new Uint8Array(l.DEMData.pack(p,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let x=this._emptyDEMTexture;return x?x.update(y,{premultiply:!1}):x=this._emptyDEMTexture=new l.Texture(n,y,a.RGBA,{premultiply:!1}),x}setupElevationDraw(n,a,p){const y=this.painter.context,x=y.gl,D=(I=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:l.DEMData.getUnpackVector(I),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var I;D.u_dem_size=this.sourceCache.getSource().tileSize,D.u_exaggeration=this.exaggeration();let R=null,U=null,z=1;if(p&&p.morphing&&this._useVertexMorphing){const Q=p.morphing.srcDemTile,Se=p.morphing.dstDemTile;z=p.morphing.phase,Q&&Se&&(this._prepareDemTileUniforms(n,Q,D,"_prev")&&(U=Q),this._prepareDemTileUniforms(n,Se,D)&&(R=Se))}if(U&&R?(y.activeTexture.set(x.TEXTURE2),R.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),y.activeTexture.set(x.TEXTURE4),U.demTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE,x.NEAREST),D.u_dem_lerp=z):(R=this.terrainTileForTile[n.tileID.key],y.activeTexture.set(x.TEXTURE2),(this._prepareDemTileUniforms(n,R,D)?R.demTexture:this.emptyDEMTexture).bind(x.NEAREST,x.CLAMP_TO_EDGE)),y.activeTexture.set(x.TEXTURE3),p&&p.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),this._depthFBO&&(D.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(x.NEAREST,x.CLAMP_TO_EDGE),D.u_depth_size_inv=[1,1]),p&&p.useMeterToDem&&R){const Q=(1<<R.tileID.canonical.z)*l.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;D.u_meter_to_dem=Q}if(p&&p.labelPlaneMatrixInv&&(D.u_label_plane_matrix_inv=p.labelPlaneMatrixInv),a.setTerrainUniformValues(y,D),"globe"===this.painter.transform.projection.name){const Q=this.globeUniformValues(this.painter.transform,n.tileID.canonical,p&&p.useDenormalizedUpVectorScale);a.setGlobeUniformValues(y,Q)}}globeUniformValues(n,a,p){const y=n.projection;return{u_tile_tl_up:y.upVector(a,0,0),u_tile_tr_up:y.upVector(a,l.EXTENT,0),u_tile_br_up:y.upVector(a,l.EXTENT,l.EXTENT),u_tile_bl_up:y.upVector(a,0,l.EXTENT),u_tile_up_scale:p?l.globeMetersToEcef(1):y.upVectorScale(a,n.center.lat,n.worldSize).metersToTile}}renderToBackBuffer(n){const a=this.painter,p=this.painter.context;0!==n.length&&(p.bindFramebuffer.set(null),p.viewport.set([0,0,a.width,a.height]),a.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(y,x,D,I,R){if("globe"===y.transform.projection.name)!function(U,z,Q,Se,je){const Ye=U.context,$e=Ye.gl;let et,ne;const He=U.options.showTerrainWireframe?2:0,ht=U.transform,gt=l.globeUseCustomAntiAliasing(U,Ye,ht),Ot=(qn,sn)=>{if(ne===qn)return;const An=[ha[qn],"PROJECTION_GLOBE_VIEW"];gt&&An.push("CUSTOM_ANTIALIASING"),sn&&An.push(ha[He]),et=U.useProgram("globeRaster",null,An),ne=qn},kt=U.colorModeForRenderPass(),Lt=new l.DepthMode($e.LEQUAL,l.DepthMode.ReadWrite,U.depthRangeFor3D);Us.update(je);const qt=l.calculateGlobeMercatorMatrix(ht),$t=[l.mercatorXfromLng(ht.center.lng),l.mercatorYfromLat(ht.center.lat)],cn=He?[!1,!0]:[!1],Wn=U.globeSharedBuffers,nn=[ht.width*l.exported.devicePixelRatio,ht.height*l.exported.devicePixelRatio],Mn=Float32Array.from(ht.globeMatrix),pn={useDenormalizedUpVectorScale:!0};if(cn.forEach(qn=>{const sn=U.transform,An=Ea(sn.zoom)*z.exaggeration();ne=-1;const Zn=qn?$e.LINES:$e.TRIANGLES;for(const kn of Se){const ti=Q.getTile(kn),Ii=l.StencilMode.disabled,$i=z.prevTerrainTileForTile[kn.key],mi=z.terrainTileForTile[kn.key];ja($i,mi)&&Us.newMorphing(kn.key,$i,mi,je,250),Ye.activeTexture.set($e.TEXTURE0),ti.texture.bind($e.LINEAR,$e.CLAMP_TO_EDGE);const Oi=Us.getMorphValuesForProxy(kn.key),cr=Oi?1:0;Oi&&l.extend$1(pn,{morphing:{srcDemTile:Oi.from,dstDemTile:Oi.to,phase:l.easeCubicInOut(Oi.phase)}});const lr=l.tileCornersToBounds(kn.canonical),Ci=l.getLatitudinalLod(lr.getCenter().lat),br=l.getGridMatrix(kn.canonical,lr,Ci,sn.worldSize/sn._pixelsPerMercatorPixel),Gr=l.globeNormalizeECEF(l.globeTileBounds(kn.canonical)),Ir=Ua(sn.projMatrix,Mn,qt,Gr,l.globeToMercatorTransition(sn.zoom),$t,sn.frustumCorners.TL,sn.frustumCorners.TR,sn.frustumCorners.BR,sn.frustumCorners.BL,sn.globeCenterInViewSpace,sn.globeRadius,nn,An,br);if(Ot(cr,qn),z.setupElevationDraw(ti,et,pn),U.prepareDrawProgram(Ye,et,kn.toUnwrapped()),Wn){const[Br,jo,is]=qn?Wn.getWirefameBuffers(U.context,Ci):Wn.getGridBuffers(Ci,0!==An);et.draw(Ye,Zn,Lt,Ii,kt,l.CullFaceMode.backCCW,Ir,"globe_raster",Br,jo,is)}}}),Wn){const qn=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];gt&&qn.push("CUSTOM_ANTIALIASING"),et=U.useProgram("globeRaster",null,qn);for(const sn of Se){const{x:An,y:Zn,z:kn}=sn.canonical,ti=0===Zn,Ii=Zn===(1<<kn)-1,[$i,mi,Oi,cr]=Wn.getPoleBuffers(kn);if(cr&&(ti||Ii)){const lr=Q.getTile(sn);Ye.activeTexture.set($e.TEXTURE0),lr.texture.bind($e.LINEAR,$e.CLAMP_TO_EDGE);let Ci=l.globePoleMatrixForTile(kn,An,ht);const br=l.globeNormalizeECEF(l.globeTileBounds(sn.canonical)),Gr=(Ir,Br)=>Ir.draw(Ye,$e.TRIANGLES,Lt,l.StencilMode.disabled,kt,l.CullFaceMode.disabled,Ua(ht.projMatrix,Ci,Ci,br,0,$t,ht.frustumCorners.TL,ht.frustumCorners.TR,ht.frustumCorners.BR,ht.frustumCorners.BL,ht.globeCenterInViewSpace,ht.globeRadius,nn,0),"globe_pole_raster",Br,Oi,cr);z.setupElevationDraw(lr,et,pn),U.prepareDrawProgram(Ye,et,sn.toUnwrapped()),ti&&Gr(et,$i),Ii&&(Ci=l.scale(l.create(),Ci,[1,-1,1]),Gr(et,mi))}}}}(y,x,D,I,R);else{const U=y.context,z=U.gl;let Q,Se;const je=y.options.showTerrainWireframe?2:0,Ye=(ht,gt)=>{if(Se===ht)return;const Ot=[ha[ht]];gt&&Ot.push(ha[je]),Q=y.useProgram("terrainRaster",null,Ot),Se=ht},$e=y.colorModeForRenderPass(),et=new l.DepthMode(z.LEQUAL,l.DepthMode.ReadWrite,y.depthRangeFor3D);Us.update(R);const ne=y.transform,He=Ea(ne.zoom)*x.exaggeration();(je?[!1,!0]:[!1]).forEach(ht=>{Se=-1;const gt=ht?z.LINES:z.TRIANGLES,[Ot,kt]=ht?x.getWirefameBuffer():[x.gridIndexBuffer,x.gridSegments];for(const Lt of I){const qt=D.getTile(Lt),$t=l.StencilMode.disabled,cn=x.prevTerrainTileForTile[Lt.key],Wn=x.terrainTileForTile[Lt.key];ja(cn,Wn)&&Us.newMorphing(Lt.key,cn,Wn,R,250),U.activeTexture.set(z.TEXTURE0),qt.texture.bind(z.LINEAR,z.CLAMP_TO_EDGE,z.LINEAR_MIPMAP_NEAREST);const nn=Us.getMorphValuesForProxy(Lt.key),Mn=nn?1:0;let pn;nn&&(pn={morphing:{srcDemTile:nn.from,dstDemTile:nn.to,phase:l.easeCubicInOut(nn.phase)}});const qn=da(Lt.projMatrix,Xo(Lt.canonical,ne.renderWorldCopies)?He/10:He);Ye(Mn,ht),x.setupElevationDraw(qt,Q,pn),y.prepareDrawProgram(U,Q,Lt.toUnwrapped()),Q.draw(U,gt,et,$t,$e,l.CullFaceMode.backCCW,qn,"terrain_raster",x.gridBuffer,Ot,kt)}})}}(a,this,this.proxySourceCache,n,this._updateTimestamp),this.renderingToTexture=!0,a.gpuTimingDeferredRenderEnd(),n.splice(0,n.length))}renderBatch(n){if(0===this._drapedRenderBatches.length)return n+1;this.renderingToTexture=!0;const a=this.painter,p=this.painter.context,y=this.proxySourceCache,x=this.proxiedCoords[y.id],D=this._drapedRenderBatches.shift(),I=[],R=a.style.order;let U=0;for(const z of x){const Q=y.getTileByID(z.proxyTileKey),Se=y.proxyCachedFBO[z.key]?y.proxyCachedFBO[z.key][n]:void 0,je=void 0!==Se?y.renderCache[Se]:this.pool[U++],Ye=void 0!==Se;if(Q.texture=je.tex,Ye&&!je.dirty){I.push(Q.tileID);continue}let $e;p.bindFramebuffer.set(je.fb.framebuffer),this.renderedToTile=!1,je.dirty&&(p.clear({color:l.Color.transparent,stencil:0}),je.dirty=!1);for(let et=D.start;et<=D.end;++et){const ne=a.style._layers[R[et]];if(ne.isHidden(a.transform.zoom))continue;const He=a.style._getLayerSourceCache(ne),ht=He?this.proxyToSource[z.key][He.id]:[z];if(!ht)continue;const gt=ht;p.viewport.set([0,0,je.fb.width,je.fb.height]),$e!==(He?He.id:null)&&(this._setupStencil(je,ht,ne,He),$e=He?He.id:null),a.renderLayer(a,He,ne,gt)}this.renderedToTile?(je.dirty=!0,I.push(Q.tileID)):Ye||--U,5===U&&(U=0,this.renderToBackBuffer(I))}return this.renderToBackBuffer(I),this.renderingToTexture=!1,p.bindFramebuffer.set(null),p.viewport.set([0,0,a.width,a.height]),D.end+1}postRender(){}renderCacheEfficiency(n){const a=n.order.length;if(0===a)return{efficiency:100};let p,y=0,x=0,D=!1;for(let I=0;I<a;++I){const R=n._layers[n.order[I]];this._style.isLayerDraped(R)?(D&&++y,++x):D||(D=!0,p=R.id)}return 0===x?{efficiency:100}:{efficiency:100*(1-y/x),firstUndrapedLayer:p}}getMinElevationBelowMSL(){let n=0;return this._visibleDemTiles.filter(a=>a.dem).forEach(a=>{n=Math.min(n,a.dem.tree.minimums[0])}),0===n?n:(n-30)*this._exaggeration}raycast(n,a,p){if(!this._visibleDemTiles)return null;const y=this._visibleDemTiles.filter(x=>x.dem).map(x=>{const D=x.tileID,I=1<<D.overscaledZ,{x:R,y:U}=D.canonical,z=R/I,Q=(R+1)/I,Se=U/I,je=(U+1)/I;return{minx:z,miny:Se,maxx:Q,maxy:je,t:x.dem.tree.raycastRoot(z,Se,Q,je,n,a,p),tile:x}});y.sort((x,D)=>(null!==x.t?x.t:Number.MAX_VALUE)-(null!==D.t?D.t:Number.MAX_VALUE));for(const x of y){if(null==x.t)return null;const D=x.tile.dem.tree.raycast(x.minx,x.miny,x.maxx,x.maxy,n,a,p);if(null!=D)return D}return null}_createFBO(){const n=this.painter.context,a=n.gl,p=this.drapeBufferSize;n.activeTexture.set(a.TEXTURE0);const y=new l.Texture(n,{width:p[0],height:p[1],data:null},a.RGBA);y.bind(a.LINEAR,a.CLAMP_TO_EDGE);const x=n.createFramebuffer(p[0],p[1],!1);return x.colorAttachment.set(y.texture),x.depthAttachment=new dt(n,x.framebuffer),void 0===this._sharedDepthStencil?(this._sharedDepthStencil=n.createRenderbuffer(n.gl.DEPTH_STENCIL,p[0],p[1]),this._stencilRef=0,x.depthAttachment.set(this._sharedDepthStencil),n.clear({stencil:0})):x.depthAttachment.set(this._sharedDepthStencil),n.extTextureFilterAnisotropic&&!n.extTextureFilterAnisotropicForceOff&&a.texParameterf(a.TEXTURE_2D,n.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,n.extTextureFilterAnisotropicMax),{fb:x,tex:y,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const n in this._style._sourceCaches)if(this._style._sourceCaches[n].hasTransition())return!0;return this._style.order.some(n=>{const a=this._style._layers[n],p=a.isHidden(this.painter.transform.zoom);return"custom"===a.type?!p&&a.shouldRedrape():!p&&a.hasTransition()})}_clearLineLayersFromRenderCache(){let n=!1;for(const p of this._style._getSources())if(p instanceof Gn){n=!0;break}if(!n)return;const a={};for(let p=0;p<this._style.order.length;++p){const y=this._style._layers[this._style.order[p]],x=this._style._getLayerSourceCache(y);if(x&&!a[x.id]&&!y.isHidden(this.painter.transform.zoom)&&"line"===y.type&&y.widthExpression()instanceof l.ZoomDependentExpression){a[x.id]=!0;for(const D of this.proxyCoords){const I=this.proxyToSource[D.key][x.id];if(I)for(const R of I)this._clearRenderCacheForTile(x.id,R)}}}}_clearRasterLayersFromRenderCache(){let n=!1;for(const p in this._style._sourceCaches)if(this._style._sourceCaches[p]._source instanceof ae){n=!0;break}if(!n)return;const a={};for(let p=0;p<this._style.order.length;++p){const y=this._style._layers[this._style.order[p]],x=this._style._getLayerSourceCache(y);if(!x||a[x.id]||y.isHidden(this.painter.transform.zoom)||"raster"!==y.type)continue;const D=y.paint.get("raster-fade-duration");for(const I of this.proxyCoords){const R=this.proxyToSource[I.key][x.id];if(R)for(const U of R){const z=ea(x.getTile(U),x.findLoadedParent(U,0),x,this.painter.transform,D);(1!==z.opacity||0!==z.mix)&&this._clearRenderCacheForTile(x.id,U)}}}}_setupDrapedRenderBatches(){const n=this._style.order,a=n.length;if(0===a)return;const p=[];let y,x=0,D=this._style._layers[n[x]];for(;!this._style.isLayerDraped(D)&&D.isHidden(this.painter.transform.zoom)&&++x<a;)D=this._style._layers[n[x]];for(;x<a;++x){const I=this._style._layers[n[x]];I.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(I)?void 0===y&&(y=x):void 0!==y&&(p.push({start:y,end:x-1}),y=void 0))}void 0!==y&&p.push({start:y,end:x-1}),this._drapedRenderBatches=p}_setupRenderCache(n){const a=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,a.renderCache.length>a.renderCachePool.length){const D=Object.values(a.proxyCachedFBO);a.proxyCachedFBO={};for(let I=0;I<D.length;++I){const R=Object.values(D[I]);a.renderCachePool.push(...R)}}return}this._clearRasterLayersFromRenderCache();const p=this.proxyCoords,y=this._tilesDirty;for(let D=p.length-1;D>=0;D--){const I=p[D];if(a.getTileByID(I.key),void 0!==a.proxyCachedFBO[I.key]){const R=n[I.key],U=this.proxyToSource[I.key];let z=0;for(const Q in U){const Se=U[Q],je=R[Q];if(!je||je.length!==Se.length||Se.some((Ye,$e)=>Ye!==je[$e]||y[Q]&&y[Q].hasOwnProperty(Ye.key))){z=-1;break}++z}for(const Q in a.proxyCachedFBO[I.key])a.renderCache[a.proxyCachedFBO[I.key][Q]].dirty=z<0||z!==Object.values(R).length}}const x=[...this._drapedRenderBatches];x.sort((D,I)=>I.end-I.start-(D.end-D.start));for(const D of x)for(const I of p){if(a.proxyCachedFBO[I.key])continue;let R=a.renderCachePool.pop();void 0===R&&a.renderCache.length<50&&(R=a.renderCache.length,a.renderCache.push(this._createFBO())),void 0!==R&&(a.proxyCachedFBO[I.key]={},a.proxyCachedFBO[I.key][D.start]=R,a.renderCache[R].dirty=!0)}this._tilesDirty={}}_setupStencil(n,a,p,y){if(!y||!this._sourceTilesOverlap[y.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const x=this.painter.context,D=x.gl;if(a.length<=1)return void(this._overlapStencilType=!1);let I;if(p.isTileClipped())I=a.length,this._overlapStencilMode.test={func:D.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(a[0].overscaledZ>a[a.length-1].overscaledZ))return void(this._overlapStencilType=!1);I=1,this._overlapStencilMode.test={func:D.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+I>255&&(x.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=I,this._overlapStencilMode.ref=this._stencilRef,p.isTileClipped()&&this._renderTileClippingMasks(a,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return"Clip"===this._overlapStencilType||"Mask"===this._overlapStencilType}stencilModeForRTTOverlap(n){return this.renderingToTexture&&this._overlapStencilType?("Clip"===this._overlapStencilType&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[n.key]),this._overlapStencilMode):l.StencilMode.disabled}_renderTileClippingMasks(n,a){const p=this.painter,y=this.painter.context,x=y.gl;p._tileClippingMaskIDs={},y.setColorMode(l.ColorMode.disabled),y.setDepthMode(l.DepthMode.disabled);const D=p.useProgram("clippingMask");for(const I of n){const R=p._tileClippingMaskIDs[I.key]=--a;D.draw(y,x.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:x.ALWAYS,mask:0},R,255,x.KEEP,x.KEEP,x.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,fa(I.projMatrix),"$clipping",p.tileExtentBuffer,p.quadTriangleIndexBuffer,p.tileExtentSegments)}}pointCoordinate(n){const a=this.painter.transform;if(n.x<0||n.x>a.width||n.y<0||n.y>a.height)return null;const p=[n.x,n.y,1,1];l.transformMat4$1(p,p,a.pixelMatrixInverse),l.scale$1(p,p,1/p[3]),p[0]/=a.worldSize,p[1]/=a.worldSize;const y=a._camera.position,x=l.mercatorZfromAltitude(1,a.center.lat),D=[y[0],y[1],y[2]/x,0],I=l.subtract([],p.slice(0,3),D);l.normalize(I,I);const R=this.raycast(D,I,this._exaggeration);return null!==R&&R?(l.scaleAndAdd(D,D,I,R),D[3]=D[2],D[2]*=x,D):null}drawDepth(){const n=this.painter,a=n.context,p=this.proxySourceCache,y=Math.ceil(n.width),x=Math.ceil(n.height);if(!this._depthFBO||this._depthFBO.width===y&&this._depthFBO.height===x||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const D=a.gl,I=a.createFramebuffer(y,x,!0);a.activeTexture.set(D.TEXTURE0);const R=new l.Texture(a,{width:y,height:x,data:null},D.RGBA);R.bind(D.NEAREST,D.CLAMP_TO_EDGE),I.colorAttachment.set(R.texture);const U=a.createRenderbuffer(a.gl.DEPTH_COMPONENT16,y,x);I.depthAttachment.set(U),this._depthFBO=I,this._depthTexture=R}a.bindFramebuffer.set(this._depthFBO.framebuffer),a.viewport.set([0,0,y,x]),function(D,I,R,U){if("globe"===D.transform.projection.name)return;const z=D.context,Q=z.gl;z.clear({depth:1});const Se=D.useProgram("terrainDepth"),je=new l.DepthMode(Q.LESS,l.DepthMode.ReadWrite,D.depthRangeFor3D);for(const Ye of U){const $e=R.getTile(Ye),et=da(Ye.projMatrix,0);I.setupElevationDraw($e,Se),Se.draw(z,Q.TRIANGLES,je,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.backCCW,et,"terrain_depth",I.gridBuffer,I.gridIndexBuffer,I.gridNoSkirtSegments)}}(n,this,p,this.proxyCoords)}_setupProxiedCoordsForOrtho(n,a,p){if(n.getSource()instanceof Z)return this._setupProxiedCoordsForImageSource(n,a,p);this._findCoveringTileCache[n.id]=this._findCoveringTileCache[n.id]||{};const y=this.proxiedCoords[n.id]=[],x=this.proxyCoords;for(let I=0;I<x.length;I++){const R=x[I],U=this._findTileCoveringTileID(R,n);if(U){const z=this._createProxiedId(R,U,p[R.key]&&p[R.key][n.id]);y.push(z),this.proxyToSource[R.key][n.id]=[z]}}let D=!1;for(let I=0;I<a.length;I++){const R=n.getTile(a[I]);if(!R||!R.hasData())continue;const U=this._findTileCoveringTileID(R.tileID,this.proxySourceCache);if(U&&U.tileID.canonical.z!==R.tileID.canonical.z){const z=this.proxyToSource[U.tileID.key][n.id],Q=this._createProxiedId(U.tileID,R,p[U.tileID.key]&&p[U.tileID.key][n.id]);z?z.splice(z.length-1,0,Q):this.proxyToSource[U.tileID.key][n.id]=[Q],y.push(Q),D=!0}}this._sourceTilesOverlap[n.id]=D}_setupProxiedCoordsForImageSource(n,a,p){if(!n.getSource().loaded())return;const y=this.proxiedCoords[n.id]=[],x=this.proxyCoords,D=n.getSource(),I=new l.Point(D.tileID.x,D.tileID.y)._div(1<<D.tileID.z),R=D.coordinates.map(l.MercatorCoordinate.fromLngLat).reduce((z,Q)=>(z.min.x=Math.min(z.min.x,Q.x-I.x),z.min.y=Math.min(z.min.y,Q.y-I.y),z.max.x=Math.max(z.max.x,Q.x-I.x),z.max.y=Math.max(z.max.y,Q.y-I.y),z),{min:new l.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new l.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),U=(z,Q)=>{const Se=z.wrap+z.canonical.x/(1<<z.canonical.z),je=z.canonical.y/(1<<z.canonical.z),Ye=l.EXTENT/(1<<z.canonical.z),$e=Q.wrap+Q.canonical.x/(1<<Q.canonical.z),et=Q.canonical.y/(1<<Q.canonical.z);return Se+Ye<$e+R.min.x||Se>$e+R.max.x||je+Ye<et+R.min.y||je>et+R.max.y};for(let z=0;z<x.length;z++){const Q=x[z];for(let Se=0;Se<a.length;Se++){const je=n.getTile(a[Se]);if(!je||!je.hasData()||U(Q,je.tileID))continue;const Ye=this._createProxiedId(Q,je,p[Q.key]&&p[Q.key][n.id]),$e=this.proxyToSource[Q.key][n.id];$e?$e.push(Ye):this.proxyToSource[Q.key][n.id]=[Ye],y.push(Ye)}}}_createProxiedId(n,a,p){let y=this.orthoMatrix;if(p){const x=p.find(D=>D.key===a.tileID.key);if(x)return x}if(a.tileID.key!==n.key){const x=n.canonical.z-a.tileID.canonical.z;let D,I,R;y=l.create();const U=a.tileID.wrap-n.wrap<<n.overscaledZ;x>0?(D=l.EXTENT>>x,I=D*((a.tileID.canonical.x<<x)-n.canonical.x+U),R=D*((a.tileID.canonical.y<<x)-n.canonical.y)):(D=l.EXTENT<<-x,I=l.EXTENT*(a.tileID.canonical.x-(n.canonical.x+U<<-x)),R=l.EXTENT*(a.tileID.canonical.y-(n.canonical.y<<-x))),l.ortho(y,0,D,0,D,0,1),l.translate(y,y,[I,R,0])}return new nr(a.tileID,n.key,y)}_findTileCoveringTileID(n,a){let p=a.getTile(n);if(p&&p.hasData())return p;const y=this._findCoveringTileCache[a.id],x=y[n.key];if(p=x?a.getTileByID(x):null,p&&p.hasData()||null===x)return p;let D=p?p.tileID:n,I=D.overscaledZ;const R=a.getSource().minzoom,U=[];if(!x){const Q=a.getSource().maxzoom;if(n.canonical.z>=Q){const Se=n.canonical.z-Q;a.getSource().reparseOverscaled?(I=Math.max(n.canonical.z+2,a.transform.tileZoom),D=new l.OverscaledTileID(I,n.wrap,Q,n.canonical.x>>Se,n.canonical.y>>Se)):0!==Se&&(I=Q,D=new l.OverscaledTileID(I,n.wrap,Q,n.canonical.x>>Se,n.canonical.y>>Se))}D.key!==n.key&&(U.push(D.key),p=a.getTile(D))}const z=Q=>{U.forEach(Se=>{y[Se]=Q}),U.length=0};for(I-=1;I>=R&&(!p||!p.hasData());I--){p&&z(p.tileID.key);const Q=D.calculateScaledKey(I);if(p=a.getTileByID(Q),p&&p.hasData())break;const Se=y[Q];if(null===Se)break;void 0===Se?U.push(Q):p=a.getTileByID(Se)}return z(p?p.tileID.key:null),p&&p.hasData()?p:null}findDEMTileFor(n){return this.enabled?this._findTileCoveringTileID(n,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(n,a){let p=this._tilesDirty[n];p||(p=this._tilesDirty[n]={}),p[a.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const n=function(a){let p=0;const y=new l.StructArrayLayout2ui4,x=131;for(let D=1;D<129;D++){for(let I=1;I<129;I++)p=D*x+I,y.emplaceBack(p,p+1),y.emplaceBack(p,p+x),y.emplaceBack(p+1,p+x),128===D&&y.emplaceBack(p+x,p+x+1);y.emplaceBack(p+1,p+1+x)}return y}();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(n),this.wireframeSegments=l.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,n.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Pi{static cacheKey(n,a,p,y){let x=`${a}${y?y.cacheKey:""}`;for(const D of p)n.usedDefines.includes(D)&&(x+=`/${D}`);return x}constructor(n,a,p,y,x,D){const I=n.gl;this.program=I.createProgram();const R=function(ne){const He=[];for(let ht=0;ht<ne.length;ht++){if(null===ne[ht])continue;const gt=ne[ht].split(" ");He.push(gt.pop())}return He}(p.staticAttributes),U=y?y.getBinderAttributes():[],z=R.concat(U);let Q=y?y.defines():[];Q=Q.concat(D.map(ne=>`#define ${ne}`));const Se=n.isWebGL2?"#version 300 es\n":"",je=Se+Q.concat(n.extStandardDerivatives&&0===Se.length?"#extension GL_OES_standard_derivatives : enable\n".concat(ca):ca,ca,la,rl.fragmentSource,vs.fragmentSource,p.fragmentSource).join("\n"),Ye=Se+Q.concat("\n#ifdef GL_ES\nprecision highp float;\n#else\n\n#if !defined(lowp)\n#define lowp\n#endif\n\n#if !defined(mediump)\n#define mediump\n#endif\n\n#if !defined(highp)\n#define highp\n#endif\n\n#endif",la,rl.vertexSource,vs.vertexSource,Jo.vertexSource,p.vertexSource).join("\n"),$e=I.createShader(I.FRAGMENT_SHADER);if(I.isContextLost())return void(this.failedToCreate=!0);I.shaderSource($e,je),I.compileShader($e),I.attachShader(this.program,$e);const et=I.createShader(I.VERTEX_SHADER);if(I.isContextLost())this.failedToCreate=!0;else{I.shaderSource(et,Ye),I.compileShader(et),I.attachShader(this.program,et),this.attributes={},this.numAttributes=z.length;for(let ne=0;ne<this.numAttributes;ne++)z[ne]&&(I.bindAttribLocation(this.program,ne,z[ne]),this.attributes[z[ne]]=ne);I.linkProgram(this.program),I.deleteShader(et),I.deleteShader($e),this.fixedUniforms=x(n),this.binderUniforms=y?y.getUniforms(n):[],D.includes("TERRAIN")&&(this.terrainUniforms={u_dem:new l.Uniform1i(ne=n),u_dem_prev:new l.Uniform1i(ne),u_dem_unpack:new l.Uniform4f(ne),u_dem_tl:new l.Uniform2f(ne),u_dem_scale:new l.Uniform1f(ne),u_dem_tl_prev:new l.Uniform2f(ne),u_dem_scale_prev:new l.Uniform1f(ne),u_dem_size:new l.Uniform1f(ne),u_dem_lerp:new l.Uniform1f(ne),u_exaggeration:new l.Uniform1f(ne),u_depth:new l.Uniform1i(ne),u_depth_size_inv:new l.Uniform2f(ne),u_meter_to_dem:new l.Uniform1f(ne),u_label_plane_matrix_inv:new l.UniformMatrix4f(ne)}),D.includes("GLOBE")&&(this.globeUniforms=(ne=>({u_tile_tl_up:new l.Uniform3f(ne),u_tile_tr_up:new l.Uniform3f(ne),u_tile_br_up:new l.Uniform3f(ne),u_tile_bl_up:new l.Uniform3f(ne),u_tile_up_scale:new l.Uniform1f(ne)}))(n)),D.includes("FOG")&&(this.fogUniforms=(ne=>({u_fog_matrix:new l.UniformMatrix4f(ne),u_fog_range:new l.Uniform2f(ne),u_fog_color:new l.Uniform4f(ne),u_fog_horizon_blend:new l.Uniform1f(ne),u_fog_temporal_offset:new l.Uniform1f(ne),u_frustum_tl:new l.Uniform3f(ne),u_frustum_tr:new l.Uniform3f(ne),u_frustum_br:new l.Uniform3f(ne),u_frustum_bl:new l.Uniform3f(ne),u_globe_pos:new l.Uniform3f(ne),u_globe_radius:new l.Uniform1f(ne),u_globe_transition:new l.Uniform1f(ne),u_is_globe:new l.Uniform1i(ne),u_viewport:new l.Uniform2f(ne)}))(n))}var ne}setTerrainUniformValues(n,a){if(!this.terrainUniforms)return;const p=this.terrainUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in a)p[y]&&p[y].set(this.program,y,a[y])}}setGlobeUniformValues(n,a){if(!this.globeUniforms)return;const p=this.globeUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in a)p[y]&&p[y].set(this.program,y,a[y])}}setFogUniformValues(n,a){if(!this.fogUniforms)return;const p=this.fogUniforms;if(!this.failedToCreate){n.program.set(this.program);for(const y in a)p[y].set(this.program,y,a[y])}}draw(n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e){const et=n.gl;if(this.failedToCreate)return;n.program.set(this.program),n.setDepthMode(p),n.setStencilMode(y),n.setColorMode(x),n.setCullFace(D);for(const He of Object.keys(this.fixedUniforms))this.fixedUniforms[He].set(this.program,He,I[He]);Ye&&Ye.setUniforms(this.program,n,this.binderUniforms,Se,{zoom:je});const ne={[et.LINES]:2,[et.TRIANGLES]:3,[et.LINE_STRIP]:1}[a];for(const He of Q.get()){const ht=He.vaos||(He.vaos={});(ht[R]||(ht[R]=new za)).bind(n,this,U,Ye?Ye.getPaintVertexBuffers():[],z,He.vertexOffset,$e||[]),et.drawElements(a,He.primitiveLength*ne,et.UNSIGNED_SHORT,He.primitiveOffset*ne*2)}}}function Qo(u,n){const a=Math.pow(2,n.tileID.overscaledZ),p=n.tileSize*Math.pow(2,u.transform.tileZoom)/a,y=p*(n.tileID.canonical.x+n.tileID.wrap*a),x=p*n.tileID.canonical.y;return{u_image:0,u_texsize:n.imageAtlasTexture.size,u_tile_units_to_pixels:1/_n(n,1,u.transform.tileZoom),u_pixel_coord_upper:[y>>16,x>>16],u_pixel_coord_lower:[65535&y,65535&x]}}const Ao=l.create(),re=(u,n,a,p,y,x,D,I,R,U,z)=>{const Q=n.style.light,Se=Q.properties.get("position"),je=[Se.x,Se.y,Se.z],Ye=l.create$1();"viewport"===Q.properties.get("anchor")&&(l.fromRotation(Ye,-n.transform.angle),l.transformMat3(je,je,Ye));const $e=Q.properties.get("color"),et=n.transform,ne={u_matrix:u,u_lightpos:je,u_lightintensity:Q.properties.get("intensity"),u_lightcolor:[$e.r,$e.g,$e.b],u_vertical_gradient:+a,u_opacity:p,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ao,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:y,u_edge_radius:x};return"globe"===et.projection.name&&(ne.u_tile_id=[D.canonical.x,D.canonical.y,1<<D.canonical.z],ne.u_zoom_transition=R,ne.u_inv_rot_matrix=z,ne.u_merc_center=U,ne.u_up_dir=et.projection.upVector(new l.CanonicalTileID(0,0,0),U[0]*l.EXTENT,U[1]*l.EXTENT),ne.u_height_lift=I),ne},ce=(u,n,a,p,y,x,D,I,R,U,z,Q)=>{const Se=re(u,n,a,p,y,x,D,R,U,z,Q),je={u_height_factor:-Math.pow(2,D.overscaledZ)/I.tileSize/8};return l.extend(Se,Qo(n,I),je)},G=u=>({u_matrix:u}),Ge=(u,n,a)=>l.extend(G(u),Qo(n,a)),zt=(u,n)=>({u_matrix:u,u_world:n}),ni=(u,n,a,p)=>l.extend(Ge(u,n,a),{u_world:p}),Ln=l.create(),Di=(u,n,a,p,y,x)=>{const D=u.transform,I="globe"===D.projection.name;let R;if("map"===x.paint.get("circle-pitch-alignment"))if(I){const z=l.globePixelsToTileUnits(D.zoom,n.canonical)*D._pixelsPerMercatorPixel;R=Float32Array.from([z,0,0,z])}else R=D.calculatePixelsToTileUnitsMatrix(a);else R=new Float32Array([D.pixelsToGLUnits[0],0,0,D.pixelsToGLUnits[1]]);const U={u_camera_to_center_distance:D.cameraToCenterDistance,u_matrix:u.translatePosMatrix(n.projMatrix,a,x.paint.get("circle-translate"),x.paint.get("circle-translate-anchor")),u_device_pixel_ratio:l.exported.devicePixelRatio,u_extrude_scale:R,u_inv_rot_matrix:Ln,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(I){U.u_inv_rot_matrix=p,U.u_merc_center=y,U.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],U.u_zoom_transition=l.globeToMercatorTransition(D.zoom);const z=y[0]*l.EXTENT,Q=y[1]*l.EXTENT;U.u_up_dir=D.projection.upVector(new l.CanonicalTileID(0,0,0),z,Q)}return U},zr=u=>{const n=[];return"map"===u.paint.get("circle-pitch-alignment")&&n.push("PITCH_WITH_MAP"),"map"===u.paint.get("circle-pitch-scale")&&n.push("SCALE_WITH_MAP"),n},Oo=(u,n,a,p)=>{const y=l.EXTENT/a.tileSize;return{u_matrix:u,u_camera_to_center_distance:n.getCameraToCenterDistance(p),u_extrude_scale:[n.pixelsToGLUnits[0]/y,n.pixelsToGLUnits[1]/y]}},Do=(u,n,a=1)=>({u_matrix:u,u_color:n,u_overlay:0,u_overlay_scale:a}),bs=l.create(),al=(u,n,a,p,y,x,D)=>{const I=u.transform,R="globe"===I.projection.name,U=R?l.globePixelsToTileUnits(I.zoom,n.canonical)*I._pixelsPerMercatorPixel:_n(a,1,x),z={u_matrix:n.projMatrix,u_extrude_scale:U,u_intensity:D,u_inv_rot_matrix:bs,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(R){z.u_inv_rot_matrix=p,z.u_merc_center=y,z.u_tile_id=[n.canonical.x,n.canonical.y,1<<n.canonical.z],z.u_zoom_transition=l.globeToMercatorTransition(I.zoom);const Q=y[0]*l.EXTENT,Se=y[1]*l.EXTENT;z.u_up_dir=I.projection.upVector(new l.CanonicalTileID(0,0,0),Q,Se)}return z},$r=(u,n,a,p,y,x,D)=>{const I=u.transform,R=I.calculatePixelsToTileUnitsMatrix(n);return{u_matrix:Ui(u,n,a,p),u_pixels_to_tile_units:R,u_device_pixel_ratio:x,u_units_to_pixels:[1/I.pixelsToGLUnits[0],1/I.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:y,u_texsize:js(a)?n.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:Ro(n,u.transform),u_alpha_discard_threshold:0,u_trim_offset:D}},xo=(u,n,a,p,y)=>{const x=u.transform;return{u_matrix:Ui(u,n,a,p),u_texsize:n.imageAtlasTexture.size,u_pixels_to_tile_units:x.calculatePixelsToTileUnitsMatrix(n),u_device_pixel_ratio:y,u_image:0,u_tile_units_to_pixels:Ro(n,x),u_units_to_pixels:[1/x.pixelsToGLUnits[0],1/x.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function Ro(u,n){return 1/_n(u,1,n.tileZoom)}function Ui(u,n,a,p){return u.translatePosMatrix(p||n.tileID.projMatrix,n,a.paint.get("line-translate"),a.paint.get("line-translate-anchor"))}function js(u){const n=u.paint.get("line-dasharray").value;return n.value||"constant"!==n.kind}const wl=(u,n,a,p,y,x)=>{return{u_matrix:u,u_tl_parent:n,u_scale_parent:a,u_fade_t:p.mix,u_opacity:p.opacity*y.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:y.paint.get("raster-brightness-min"),u_brightness_high:y.paint.get("raster-brightness-max"),u_saturation_factor:(I=y.paint.get("raster-saturation"),I>0?1-1/(1.001-I):-I),u_contrast_factor:(D=y.paint.get("raster-contrast"),D>0?1/(1-D):1+D),u_spin_weights:No(y.paint.get("raster-hue-rotate")),u_perspective_transform:x};var D,I};function No(u){u*=Math.PI/180;const n=Math.sin(u),a=Math.cos(u);return[(2*a+1)/3,(-Math.sqrt(3)*n-a+1)/3,(Math.sqrt(3)*n-a+1)/3]}const kr=l.create(),ws=(u,n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e)=>{const et=y.transform,ne={u_is_size_zoom_constant:+("constant"===u||"source"===u),u_is_size_feature_constant:+("constant"===u||"camera"===u),u_size_t:n?n.uSizeT:0,u_size:n?n.uSize:0,u_camera_to_center_distance:et.cameraToCenterDistance,u_rotate_symbol:+a,u_aspect_ratio:et.width/et.height,u_fade_change:y.options.fadeDuration?y.symbolFadeChange:1,u_matrix:x,u_label_plane_matrix:D,u_coord_matrix:I,u_is_text:+R,u_pitch_with_map:+p,u_texsize:U,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:kr,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:kr,u_up_vector:[0,-1,0]};return"globe"===$e.name&&(ne.u_tile_id=[z.canonical.x,z.canonical.y,1<<z.canonical.z],ne.u_zoom_transition=Q,ne.u_inv_rot_matrix=je,ne.u_merc_center=Se,ne.u_camera_forward=et._camera.forward(),ne.u_ecef_origin=l.globeECEFOrigin(et.globeMatrix,z.toUnwrapped()),ne.u_tile_matrix=Float32Array.from(et.globeMatrix),ne.u_up_vector=Ye),ne},pa=(u,n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e,et)=>l.extend(ws(u,n,a,p,y,x,D,I,R,U,Q,Se,je,Ye,$e,et),{u_gamma_scale:p?y.transform.cameraToCenterDistance*Math.cos(y.terrain?0:y.transform._pitch):1,u_device_pixel_ratio:l.exported.devicePixelRatio,u_is_halo:+z}),Vs=(u,n,a,p,y,x,D,I,R,U,z,Q,Se,je,Ye,$e)=>l.extend(pa(u,n,a,p,y,x,D,I,!0,R,!0,z,Q,Se,je,Ye,$e),{u_texsize_icon:U,u_texture_icon:1}),ma=(u,n,a)=>({u_matrix:u,u_opacity:n,u_color:a}),Hl=(u,n,a,p,y)=>l.extend(function(x,D,I){const R=D.imageManager.getPattern(x.toString()),{width:U,height:z}=D.imageManager.getPixelSize(),Q=Math.pow(2,I.tileID.overscaledZ),Se=I.tileSize*Math.pow(2,D.transform.tileZoom)/Q,je=Se*(I.tileID.canonical.x+I.tileID.wrap*Q),Ye=Se*I.tileID.canonical.y;return{u_image:0,u_pattern_tl:R.tl,u_pattern_br:R.br,u_texsize:[U,z],u_pattern_size:R.displaySize,u_tile_units_to_pixels:1/_n(I,1,D.transform.tileZoom),u_pixel_coord_upper:[je>>16,Ye>>16],u_pixel_coord_lower:[65535&je,65535&Ye]}}(p,a,y),{u_matrix:u,u_opacity:n}),$s={fillExtrusion:u=>({u_matrix:new l.UniformMatrix4f(u),u_lightpos:new l.Uniform3f(u),u_lightintensity:new l.Uniform1f(u),u_lightcolor:new l.Uniform3f(u),u_vertical_gradient:new l.Uniform1f(u),u_opacity:new l.Uniform1f(u),u_edge_radius:new l.Uniform1f(u),u_ao:new l.Uniform2f(u),u_tile_id:new l.Uniform3f(u),u_zoom_transition:new l.Uniform1f(u),u_inv_rot_matrix:new l.UniformMatrix4f(u),u_merc_center:new l.Uniform2f(u),u_up_dir:new l.Uniform3f(u),u_height_lift:new l.Uniform1f(u)}),fillExtrusionPattern:u=>({u_matrix:new l.UniformMatrix4f(u),u_lightpos:new l.Uniform3f(u),u_lightintensity:new l.Uniform1f(u),u_lightcolor:new l.Uniform3f(u),u_vertical_gradient:new l.Uniform1f(u),u_height_factor:new l.Uniform1f(u),u_edge_radius:new l.Uniform1f(u),u_ao:new l.Uniform2f(u),u_tile_id:new l.Uniform3f(u),u_zoom_transition:new l.Uniform1f(u),u_inv_rot_matrix:new l.UniformMatrix4f(u),u_merc_center:new l.Uniform2f(u),u_up_dir:new l.Uniform3f(u),u_height_lift:new l.Uniform1f(u),u_image:new l.Uniform1i(u),u_texsize:new l.Uniform2f(u),u_pixel_coord_upper:new l.Uniform2f(u),u_pixel_coord_lower:new l.Uniform2f(u),u_tile_units_to_pixels:new l.Uniform1f(u),u_opacity:new l.Uniform1f(u)}),fill:u=>({u_matrix:new l.UniformMatrix4f(u)}),fillPattern:u=>({u_matrix:new l.UniformMatrix4f(u),u_image:new l.Uniform1i(u),u_texsize:new l.Uniform2f(u),u_pixel_coord_upper:new l.Uniform2f(u),u_pixel_coord_lower:new l.Uniform2f(u),u_tile_units_to_pixels:new l.Uniform1f(u)}),fillOutline:u=>({u_matrix:new l.UniformMatrix4f(u),u_world:new l.Uniform2f(u)}),fillOutlinePattern:u=>({u_matrix:new l.UniformMatrix4f(u),u_world:new l.Uniform2f(u),u_image:new l.Uniform1i(u),u_texsize:new l.Uniform2f(u),u_pixel_coord_upper:new l.Uniform2f(u),u_pixel_coord_lower:new l.Uniform2f(u),u_tile_units_to_pixels:new l.Uniform1f(u)}),circle:u=>({u_camera_to_center_distance:new l.Uniform1f(u),u_extrude_scale:new l.UniformMatrix2f(u),u_device_pixel_ratio:new l.Uniform1f(u),u_matrix:new l.UniformMatrix4f(u),u_inv_rot_matrix:new l.UniformMatrix4f(u),u_merc_center:new l.Uniform2f(u),u_tile_id:new l.Uniform3f(u),u_zoom_transition:new l.Uniform1f(u),u_up_dir:new l.Uniform3f(u)}),collisionBox:u=>({u_matrix:new l.UniformMatrix4f(u),u_camera_to_center_distance:new l.Uniform1f(u),u_extrude_scale:new l.Uniform2f(u)}),collisionCircle:u=>({u_matrix:new l.UniformMatrix4f(u),u_inv_matrix:new l.UniformMatrix4f(u),u_camera_to_center_distance:new l.Uniform1f(u),u_viewport_size:new l.Uniform2f(u)}),debug:u=>({u_color:new l.UniformColor(u),u_matrix:new l.UniformMatrix4f(u),u_overlay:new l.Uniform1i(u),u_overlay_scale:new l.Uniform1f(u)}),clippingMask:u=>({u_matrix:new l.UniformMatrix4f(u)}),heatmap:u=>({u_extrude_scale:new l.Uniform1f(u),u_intensity:new l.Uniform1f(u),u_matrix:new l.UniformMatrix4f(u),u_inv_rot_matrix:new l.UniformMatrix4f(u),u_merc_center:new l.Uniform2f(u),u_tile_id:new l.Uniform3f(u),u_zoom_transition:new l.Uniform1f(u),u_up_dir:new l.Uniform3f(u)}),heatmapTexture:u=>({u_image:new l.Uniform1i(u),u_color_ramp:new l.Uniform1i(u),u_opacity:new l.Uniform1f(u)}),hillshade:u=>({u_matrix:new l.UniformMatrix4f(u),u_image:new l.Uniform1i(u),u_latrange:new l.Uniform2f(u),u_light:new l.Uniform2f(u),u_shadow:new l.UniformColor(u),u_highlight:new l.UniformColor(u),u_accent:new l.UniformColor(u)}),hillshadePrepare:u=>({u_matrix:new l.UniformMatrix4f(u),u_image:new l.Uniform1i(u),u_dimension:new l.Uniform2f(u),u_zoom:new l.Uniform1f(u),u_unpack:new l.Uniform4f(u)}),line:u=>({u_matrix:new l.UniformMatrix4f(u),u_pixels_to_tile_units:new l.UniformMatrix2f(u),u_device_pixel_ratio:new l.Uniform1f(u),u_units_to_pixels:new l.Uniform2f(u),u_dash_image:new l.Uniform1i(u),u_gradient_image:new l.Uniform1i(u),u_image_height:new l.Uniform1f(u),u_texsize:new l.Uniform2f(u),u_tile_units_to_pixels:new l.Uniform1f(u),u_alpha_discard_threshold:new l.Uniform1f(u),u_trim_offset:new l.Uniform2f(u)}),linePattern:u=>({u_matrix:new l.UniformMatrix4f(u),u_texsize:new l.Uniform2f(u),u_pixels_to_tile_units:new l.UniformMatrix2f(u),u_device_pixel_ratio:new l.Uniform1f(u),u_image:new l.Uniform1i(u),u_units_to_pixels:new l.Uniform2f(u),u_tile_units_to_pixels:new l.Uniform1f(u),u_alpha_discard_threshold:new l.Uniform1f(u)}),raster:u=>({u_matrix:new l.UniformMatrix4f(u),u_tl_parent:new l.Uniform2f(u),u_scale_parent:new l.Uniform1f(u),u_fade_t:new l.Uniform1f(u),u_opacity:new l.Uniform1f(u),u_image0:new l.Uniform1i(u),u_image1:new l.Uniform1i(u),u_brightness_low:new l.Uniform1f(u),u_brightness_high:new l.Uniform1f(u),u_saturation_factor:new l.Uniform1f(u),u_contrast_factor:new l.Uniform1f(u),u_spin_weights:new l.Uniform3f(u),u_perspective_transform:new l.Uniform2f(u)}),symbolIcon:u=>({u_is_size_zoom_constant:new l.Uniform1i(u),u_is_size_feature_constant:new l.Uniform1i(u),u_size_t:new l.Uniform1f(u),u_size:new l.Uniform1f(u),u_camera_to_center_distance:new l.Uniform1f(u),u_rotate_symbol:new l.Uniform1i(u),u_aspect_ratio:new l.Uniform1f(u),u_fade_change:new l.Uniform1f(u),u_matrix:new l.UniformMatrix4f(u),u_label_plane_matrix:new l.UniformMatrix4f(u),u_coord_matrix:new l.UniformMatrix4f(u),u_is_text:new l.Uniform1i(u),u_pitch_with_map:new l.Uniform1i(u),u_texsize:new l.Uniform2f(u),u_tile_id:new l.Uniform3f(u),u_zoom_transition:new l.Uniform1f(u),u_inv_rot_matrix:new l.UniformMatrix4f(u),u_merc_center:new l.Uniform2f(u),u_camera_forward:new l.Uniform3f(u),u_tile_matrix:new l.UniformMatrix4f(u),u_up_vector:new l.Uniform3f(u),u_ecef_origin:new l.Uniform3f(u),u_texture:new l.Uniform1i(u)}),symbolSDF:u=>({u_is_size_zoom_constant:new l.Uniform1i(u),u_is_size_feature_constant:new l.Uniform1i(u),u_size_t:new l.Uniform1f(u),u_size:new l.Uniform1f(u),u_camera_to_center_distance:new l.Uniform1f(u),u_rotate_symbol:new l.Uniform1i(u),u_aspect_ratio:new l.Uniform1f(u),u_fade_change:new l.Uniform1f(u),u_matrix:new l.UniformMatrix4f(u),u_label_plane_matrix:new l.UniformMatrix4f(u),u_coord_matrix:new l.UniformMatrix4f(u),u_is_text:new l.Uniform1i(u),u_pitch_with_map:new l.Uniform1i(u),u_texsize:new l.Uniform2f(u),u_texture:new l.Uniform1i(u),u_gamma_scale:new l.Uniform1f(u),u_device_pixel_ratio:new l.Uniform1f(u),u_tile_id:new l.Uniform3f(u),u_zoom_transition:new l.Uniform1f(u),u_inv_rot_matrix:new l.UniformMatrix4f(u),u_merc_center:new l.Uniform2f(u),u_camera_forward:new l.Uniform3f(u),u_tile_matrix:new l.UniformMatrix4f(u),u_up_vector:new l.Uniform3f(u),u_ecef_origin:new l.Uniform3f(u),u_is_halo:new l.Uniform1i(u)}),symbolTextAndIcon:u=>({u_is_size_zoom_constant:new l.Uniform1i(u),u_is_size_feature_constant:new l.Uniform1i(u),u_size_t:new l.Uniform1f(u),u_size:new l.Uniform1f(u),u_camera_to_center_distance:new l.Uniform1f(u),u_rotate_symbol:new l.Uniform1i(u),u_aspect_ratio:new l.Uniform1f(u),u_fade_change:new l.Uniform1f(u),u_matrix:new l.UniformMatrix4f(u),u_label_plane_matrix:new l.UniformMatrix4f(u),u_coord_matrix:new l.UniformMatrix4f(u),u_is_text:new l.Uniform1i(u),u_pitch_with_map:new l.Uniform1i(u),u_texsize:new l.Uniform2f(u),u_texsize_icon:new l.Uniform2f(u),u_texture:new l.Uniform1i(u),u_texture_icon:new l.Uniform1i(u),u_gamma_scale:new l.Uniform1f(u),u_device_pixel_ratio:new l.Uniform1f(u),u_is_halo:new l.Uniform1i(u)}),background:u=>({u_matrix:new l.UniformMatrix4f(u),u_opacity:new l.Uniform1f(u),u_color:new l.UniformColor(u)}),backgroundPattern:u=>({u_matrix:new l.UniformMatrix4f(u),u_opacity:new l.Uniform1f(u),u_image:new l.Uniform1i(u),u_pattern_tl:new l.Uniform2f(u),u_pattern_br:new l.Uniform2f(u),u_texsize:new l.Uniform2f(u),u_pattern_size:new l.Uniform2f(u),u_pixel_coord_upper:new l.Uniform2f(u),u_pixel_coord_lower:new l.Uniform2f(u),u_tile_units_to_pixels:new l.Uniform1f(u)}),terrainRaster:ua,terrainDepth:ua,skybox:u=>({u_matrix:new l.UniformMatrix4f(u),u_sun_direction:new l.Uniform3f(u),u_cubemap:new l.Uniform1i(u),u_opacity:new l.Uniform1f(u),u_temporal_offset:new l.Uniform1f(u)}),skyboxGradient:u=>({u_matrix:new l.UniformMatrix4f(u),u_color_ramp:new l.Uniform1i(u),u_center_direction:new l.Uniform3f(u),u_radius:new l.Uniform1f(u),u_opacity:new l.Uniform1f(u),u_temporal_offset:new l.Uniform1f(u)}),skyboxCapture:u=>({u_matrix_3f:new l.UniformMatrix3f(u),u_sun_direction:new l.Uniform3f(u),u_sun_intensity:new l.Uniform1f(u),u_color_tint_r:new l.Uniform4f(u),u_color_tint_m:new l.Uniform4f(u),u_luminance:new l.Uniform1f(u)}),globeRaster:u=>({u_proj_matrix:new l.UniformMatrix4f(u),u_globe_matrix:new l.UniformMatrix4f(u),u_normalize_matrix:new l.UniformMatrix4f(u),u_merc_matrix:new l.UniformMatrix4f(u),u_zoom_transition:new l.Uniform1f(u),u_merc_center:new l.Uniform2f(u),u_image0:new l.Uniform1i(u),u_grid_matrix:new l.UniformMatrix3f(u),u_skirt_height:new l.Uniform1f(u),u_frustum_tl:new l.Uniform3f(u),u_frustum_tr:new l.Uniform3f(u),u_frustum_br:new l.Uniform3f(u),u_frustum_bl:new l.Uniform3f(u),u_globe_pos:new l.Uniform3f(u),u_globe_radius:new l.Uniform1f(u),u_viewport:new l.Uniform2f(u)}),globeAtmosphere:u=>({u_frustum_tl:new l.Uniform3f(u),u_frustum_tr:new l.Uniform3f(u),u_frustum_br:new l.Uniform3f(u),u_frustum_bl:new l.Uniform3f(u),u_horizon:new l.Uniform1f(u),u_transition:new l.Uniform1f(u),u_fadeout_range:new l.Uniform1f(u),u_color:new l.Uniform4f(u),u_high_color:new l.Uniform4f(u),u_space_color:new l.Uniform4f(u),u_star_intensity:new l.Uniform1f(u),u_star_density:new l.Uniform1f(u),u_star_size:new l.Uniform1f(u),u_temporal_offset:new l.Uniform1f(u),u_horizon_angle:new l.Uniform1f(u),u_rotation_matrix:new l.UniformMatrix4f(u)})};let Va;function es(u,n,a,p,y,x,D){const I=u.context,R=I.gl,U=u.transform,z=u.useProgram("collisionBox"),Q=[];let Se=0,je=0;for(let gt=0;gt<p.length;gt++){const Ot=p[gt],kt=n.getTile(Ot),Lt=kt.getBucket(a);if(!Lt)continue;const qt=Xe(Ot,Lt,U);let $t=qt;0===y[0]&&0===y[1]||($t=u.translatePosMatrix(qt,kt,y,x));const cn=D?Lt.textCollisionBox:Lt.iconCollisionBox,Wn=Lt.collisionCircleArray;if(Wn.length>0){const nn=l.create(),Mn=$t;l.mul(nn,Lt.placementInvProjMatrix,U.glCoordMatrix),l.mul(nn,nn,Lt.placementViewportMatrix),Q.push({circleArray:Wn,circleOffset:je,transform:Mn,invTransform:nn,projection:Lt.getProjection()}),Se+=Wn.length/4,je=Se}cn&&(u.terrain&&u.terrain.setupElevationDraw(kt,z),z.draw(I,R.LINES,l.DepthMode.disabled,l.StencilMode.disabled,u.colorModeForRenderPass(),l.CullFaceMode.disabled,Oo($t,U,kt,Lt.getProjection()),a.id,cn.layoutVertexBuffer,cn.indexBuffer,cn.segments,null,U.zoom,null,[cn.collisionVertexBuffer,cn.collisionVertexBufferExt]))}if(!D||!Q.length)return;const Ye=u.useProgram("collisionCircle"),$e=new l.StructArrayLayout2f1f2i16;$e.resize(4*Se),$e._trim();let et=0;for(const gt of Q)for(let Ot=0;Ot<gt.circleArray.length/4;Ot++){const kt=4*Ot,Lt=gt.circleArray[kt+0],qt=gt.circleArray[kt+1],$t=gt.circleArray[kt+2],cn=gt.circleArray[kt+3];$e.emplace(et++,Lt,qt,$t,cn,0),$e.emplace(et++,Lt,qt,$t,cn,1),$e.emplace(et++,Lt,qt,$t,cn,2),$e.emplace(et++,Lt,qt,$t,cn,3)}(!Va||Va.length<2*Se)&&(Va=function(gt){const Ot=2*gt,kt=new l.StructArrayLayout3ui6;kt.resize(Ot),kt._trim();for(let Lt=0;Lt<Ot;Lt++){const qt=6*Lt;kt.uint16[qt+0]=4*Lt+0,kt.uint16[qt+1]=4*Lt+1,kt.uint16[qt+2]=4*Lt+2,kt.uint16[qt+3]=4*Lt+2,kt.uint16[qt+4]=4*Lt+3,kt.uint16[qt+5]=4*Lt+0}return kt}(Se));const ne=I.createIndexBuffer(Va,!0),He=I.createVertexBuffer($e,l.collisionCircleLayout.members,!0);for(const gt of Q){const Ot={u_matrix:gt.transform,u_inv_matrix:gt.invTransform,u_camera_to_center_distance:(ht=U).getCameraToCenterDistance(gt.projection),u_viewport_size:[ht.width,ht.height]};Ye.draw(I,R.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,u.colorModeForRenderPass(),l.CullFaceMode.disabled,Ot,a.id,He,ne,l.SegmentVector.simpleSegment(0,2*gt.circleOffset,gt.circleArray.length,gt.circleArray.length/2),null,U.zoom)}var ht;He.destroy(),ne.destroy()}const Gi=l.create();function ta({width:u,height:n,anchor:a,textOffset:p,textScale:y},x){const{horizontalAlign:D,verticalAlign:I}=l.getAnchorAlignment(a),R=-(D-.5)*u,U=-(I-.5)*n,z=l.evaluateVariableOffset(a,p);return new l.Point((R/y+z[0])*x,(U/y+z[1])*x)}function Wl(u,n,a,p,y,x,D,I,R,U,z){const Q=u.text.placedSymbolArray,Se=u.text.dynamicLayoutVertexArray,je=u.icon.dynamicLayoutVertexArray,Ye={},$e=u.getProjection(),et=_t(I,$e,x),ne=x.elevation,He=$e.upVectorScale(I.canonical,x.center.lat,x.worldSize).metersToTile;Se.clear();for(let ht=0;ht<Q.length;ht++){const gt=Q.get(ht),{tileAnchorX:Ot,tileAnchorY:kt,numGlyphs:Lt}=gt,qt=gt.hidden||!gt.crossTileID||u.allowVerticalPlacement&&!gt.placedOrientation?null:p[gt.crossTileID];if(qt){let $t=0,cn=0,Wn=0;if(ne){const ti=ne?ne.getAtTileOffset(I,Ot,kt):0,[Ii,$i,mi]=$e.upVector(I.canonical,Ot,kt);$t=ti*Ii*He,cn=ti*$i*He,Wn=ti*mi*He}let[nn,Mn,pn,qn]=Kn(gt.projectedAnchorX+$t,gt.projectedAnchorY+cn,gt.projectedAnchorZ+Wn,a?et:D);const sn=pi(x.getCameraToCenterDistance($e),qn);let An=y.evaluateSizeForFeature(u.textSizeData,U,gt)*sn/l.ONE_EM;a&&(An*=u.tilePixelRatio/R);const Zn=ta(qt,An);a?(({x:nn,y:Mn,z:pn}=$e.projectTilePoint(Ot+Zn.x,kt+Zn.y,I.canonical)),[nn,Mn,pn]=Kn(nn+$t,Mn+cn,pn+Wn,D)):(n&&Zn._rotate(-x.angle),nn+=Zn.x,Mn+=Zn.y,pn=0);const kn=u.allowVerticalPlacement&&gt.placedOrientation===l.WritingMode.vertical?Math.PI/2:0;for(let ti=0;ti<Lt;ti++)l.addDynamicAttributes(Se,nn,Mn,pn,kn);z&&gt.associatedIconIndex>=0&&(Ye[gt.associatedIconIndex]={x:nn,y:Mn,z:pn,angle:kn})}else St(Lt,Se)}if(z){je.clear();const ht=u.icon.placedSymbolArray;for(let gt=0;gt<ht.length;gt++){const Ot=ht.get(gt),{numGlyphs:kt}=Ot,Lt=Ye[gt];if(Ot.hidden||!Lt)St(kt,je);else{const{x:qt,y:$t,z:cn,angle:Wn}=Lt;for(let nn=0;nn<kt;nn++)l.addDynamicAttributes(je,qt,$t,cn,Wn)}}u.icon.dynamicLayoutVertexBuffer.updateData(je)}u.text.dynamicLayoutVertexBuffer.updateData(Se)}function Cs(u,n,a){return a.iconsInText&&n?"symbolTextAndIcon":u?"symbolSDF":"symbolIcon"}function Cl(u,n,a,p,y,x,D,I,R,U,z,Q){const Se=u.context,je=Se.gl,Ye=u.transform,$e="map"===I,et="map"===R,ne=$e&&"point"!==a.layout.get("symbol-placement"),He=$e&&!et&&!ne,ht=void 0!==a.layout.get("symbol-sort-key").constantOr(1);let gt=!1;const Ot=u.depthModeForSublayer(0,l.DepthMode.ReadOnly),kt=[l.mercatorXfromLng(Ye.center.lng),l.mercatorYfromLat(Ye.center.lat)],Lt=a.layout.get("text-variable-anchor"),qt="globe"===Ye.projection.name,$t=[],cn=[0,-1,0];let Wn=cn;!qt&&!Ye.mercatorFromTransition||$e||(Wn=function(nn){const Mn=nn._camera.getWorldToCamera(nn.worldSize,1),pn=l.multiply([],Mn,nn.globeMatrix);l.invert(pn,pn);const qn=[0,0,0],sn=[0,1,0,0];return l.transformMat4$1(sn,sn,pn),qn[0]=sn[0],qn[1]=sn[1],qn[2]=sn[2],l.normalize(qn,qn),qn}(Ye));for(const nn of p){const Mn=n.getTile(nn),pn=Mn.getBucket(a);if(!pn||"mercator"===pn.projection.name&&qt)continue;const qn=y?pn.text:pn.icon;if(!qn||pn.fullyClipped||!qn.segments.get().length)continue;const sn=qn.programConfigurations.get(a.id),An=y||pn.sdfIcons,Zn=y?pn.textSizeData:pn.iconSizeData,kn=et||0!==Ye.pitch,ti=l.evaluateSizeForZoom(Zn,Ye.zoom);let Ii,$i,mi,Oi,cr=[0,0],lr=null;if(y)$i=Mn.glyphAtlasTexture,mi=je.LINEAR,Ii=Mn.glyphAtlasTexture.size,pn.iconsInText&&(cr=Mn.imageAtlasTexture.size,lr=Mn.imageAtlasTexture,Oi=kn||u.options.rotating||u.options.zooming||"composite"===Zn.kind||"camera"===Zn.kind?je.LINEAR:je.NEAREST);else{const Ya=1!==a.layout.get("icon-size").constantOr(0)||pn.iconsNeedLinear;$i=Mn.imageAtlasTexture,mi=An||u.options.rotating||u.options.zooming||Ya||kn?je.LINEAR:je.NEAREST,Ii=Mn.imageAtlasTexture.size}const Ci="globe"===pn.projection.name,br=Ci?Wn:cn,Gr=Ci?l.globeToMercatorTransition(Ye.zoom):0,Ir=_t(nn,pn.getProjection(),Ye),Br=Ye.calculatePixelsToTileUnitsMatrix(Mn),jo=vt(Ir,Mn.tileID.canonical,et,$e,Ye,pn.getProjection(),Br),is=u.terrain&&et&&ne?l.invert(l.create(),jo):Gi,sa=On(Ir,Mn.tileID.canonical,et,$e,Ye,pn.getProjection(),Br),Aa=Lt&&pn.hasTextData(),co="none"!==a.layout.get("icon-text-fit")&&Aa&&pn.hasIconData();if(ne){const Ya=Ye.elevation,hl=Ya?Ya.getAtTileOffsetFunc(nn,Ye.center.lat,Ye.worldSize,pn.getProjection()):null,Sl=Hn(Ir,Mn.tileID.canonical,et,$e,Ye,pn.getProjection(),Br);rr(pn,Ir,u,y,Sl,sa,et,U,hl,nn)}const yr=ne||y&&Lt||co,Er=u.translatePosMatrix(Ir,Mn,x,D),go=yr?Gi:jo,rs=u.translatePosMatrix(sa,Mn,x,D,!0),no=pn.getProjection().createInversionMatrix(Ye,nn.canonical),os=[];u.terrainRenderModeElevated()&&et&&os.push("PITCH_WITH_MAP_TERRAIN"),Ci&&os.push("PROJECTION_GLOBE_VIEW"),yr&&os.push("PROJECTED_POS_ON_VIEWPORT");const xc=An&&0!==a.paint.get(y?"text-halo-width":"icon-halo-width").constantOr(1);let ic;ic=An?pn.iconsInText?Vs(Zn.kind,ti,He,et,u,Er,go,rs,Ii,cr,nn,Gr,kt,no,br,pn.getProjection()):pa(Zn.kind,ti,He,et,u,Er,go,rs,y,Ii,!0,nn,Gr,kt,no,br,pn.getProjection()):ws(Zn.kind,ti,He,et,u,Er,go,rs,y,Ii,nn,Gr,kt,no,br,pn.getProjection());const bc={program:u.useProgram(Cs(An,y,pn),sn,os),buffers:qn,uniformValues:ic,atlasTexture:$i,atlasTextureIcon:lr,atlasInterpolation:mi,atlasInterpolationIcon:Oi,isSDF:An,hasHalo:xc,tile:Mn,labelPlaneMatrixInv:is};if(ht&&pn.canOverlap){gt=!0;const Ya=qn.segments.get();for(const hl of Ya)$t.push({segments:new l.SegmentVector([hl]),sortKey:hl.sortKey,state:bc})}else $t.push({segments:qn.segments,sortKey:0,state:bc})}gt&&$t.sort((nn,Mn)=>nn.sortKey-Mn.sortKey);for(const nn of $t){const Mn=nn.state;if(u.terrain&&u.terrain.setupElevationDraw(Mn.tile,Mn.program,{useDepthForOcclusion:!qt,labelPlaneMatrixInv:Mn.labelPlaneMatrixInv}),Se.activeTexture.set(je.TEXTURE0),Mn.atlasTexture.bind(Mn.atlasInterpolation,je.CLAMP_TO_EDGE),Mn.atlasTextureIcon&&(Se.activeTexture.set(je.TEXTURE1),Mn.atlasTextureIcon&&Mn.atlasTextureIcon.bind(Mn.atlasInterpolationIcon,je.CLAMP_TO_EDGE)),Mn.isSDF){const pn=Mn.uniformValues;Mn.hasHalo&&(pn.u_is_halo=1,na(Mn.buffers,nn.segments,a,u,Mn.program,Ot,z,Q,pn)),pn.u_is_halo=0}na(Mn.buffers,nn.segments,a,u,Mn.program,Ot,z,Q,Mn.uniformValues)}}function na(u,n,a,p,y,x,D,I,R){const U=p.context,z=[u.dynamicLayoutVertexBuffer,u.opacityVertexBuffer,u.globeExtVertexBuffer];y.draw(U,U.gl.TRIANGLES,x,D,I,l.CullFaceMode.disabled,R,a.id,u.layoutVertexBuffer,u.indexBuffer,n,a.paint,p.transform.zoom,u.programConfigurations.get(a.id),z)}function oo(u,n,a,p,y,x,D){const I=u.context.gl,R=a.paint.get("fill-pattern"),U=R&&R.constantOr(1);let z,Q,Se,je,Ye;D?(Q=U&&!a.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",z=I.LINES):(Q=U?"fillPattern":"fill",z=I.TRIANGLES);for(const $e of p){const et=n.getTile($e);if(U&&!et.patternsLoaded())continue;const ne=et.getBucket(a);if(!ne)continue;u.prepareDrawTile();const He=ne.programConfigurations.get(a.id),ht=u.useProgram(Q,He);U&&(u.context.activeTexture.set(I.TEXTURE0),et.imageAtlasTexture.bind(I.LINEAR,I.CLAMP_TO_EDGE),He.updatePaintBuffers());const gt=R.constantOr(null);if(gt&&et.imageAtlas){const kt=et.imageAtlas.patternPositions[gt.toString()];kt&&He.setConstantPatternPositions(kt)}const Ot=u.translatePosMatrix($e.projMatrix,et,a.paint.get("fill-translate"),a.paint.get("fill-translate-anchor"));if(D){je=ne.indexBuffer2,Ye=ne.segments2;const kt=u.terrain&&u.terrain.renderingToTexture?u.terrain.drapeBufferSize:[I.drawingBufferWidth,I.drawingBufferHeight];Se="fillOutlinePattern"===Q&&U?ni(Ot,u,et,kt):zt(Ot,kt)}else je=ne.indexBuffer,Ye=ne.segments,Se=U?Ge(Ot,u,et):G(Ot);u.prepareDrawProgram(u.context,ht,$e.toUnwrapped()),ht.draw(u.context,z,y,u.stencilModeForClipping($e),x,l.CullFaceMode.disabled,Se,a.id,ne.layoutVertexBuffer,je,Ye,a.paint,u.transform.zoom,He)}}function $a(u,n,a,p,y,x,D){const I=u.context,R=I.gl,U=u.transform,z=a.paint.get("fill-extrusion-pattern"),Q=z.constantOr(1),Se=a.paint.get("fill-extrusion-opacity"),je=[a.paint.get("fill-extrusion-ambient-occlusion-intensity"),a.paint.get("fill-extrusion-ambient-occlusion-radius")],Ye=a.layout.get("fill-extrusion-edge-radius"),$e=Ye>0&&!a.paint.get("fill-extrusion-rounded-roof"),et=$e?0:Ye,ne="globe"===U.projection.name?l.fillExtrusionHeightLift():0,He="globe"===U.projection.name,ht=He?l.globeToMercatorTransition(U.zoom):0,gt=[l.mercatorXfromLng(U.center.lng),l.mercatorYfromLat(U.center.lat)],Ot=[];He&&Ot.push("PROJECTION_GLOBE_VIEW"),je[0]>0&&Ot.push("FAUX_AO"),$e&&Ot.push("ZERO_ROOF_RADIUS");for(const kt of p){const Lt=n.getTile(kt),qt=Lt.getBucket(a);if(!qt||qt.projection.name!==U.projection.name)continue;const $t=qt.programConfigurations.get(a.id),cn=u.useProgram(Q?"fillExtrusionPattern":"fillExtrusion",$t,Ot);if(u.terrain){const An=u.terrain;if(u.style.terrainSetForDrapingOnly())An.setupElevationDraw(Lt,cn,{useMeterToDem:!0});else{if(!qt.enableTerrain)continue;if(An.setupElevationDraw(Lt,cn,{useMeterToDem:!0}),Io(I,n,kt,qt,a,An),!qt.centroidVertexBuffer){const Zn=cn.attributes.a_centroid_pos;void 0!==Zn&&R.vertexAttrib2f(Zn,0,0)}}}Q&&(u.context.activeTexture.set(R.TEXTURE0),Lt.imageAtlasTexture.bind(R.LINEAR,R.CLAMP_TO_EDGE),$t.updatePaintBuffers());const Wn=z.constantOr(null);if(Wn&&Lt.imageAtlas){const An=Lt.imageAtlas.patternPositions[Wn.toString()];An&&$t.setConstantPatternPositions(An)}const nn=u.translatePosMatrix(kt.projMatrix,Lt,a.paint.get("fill-extrusion-translate"),a.paint.get("fill-extrusion-translate-anchor")),Mn=U.projection.createInversionMatrix(U,kt.canonical),pn=a.paint.get("fill-extrusion-vertical-gradient"),qn=Q?ce(nn,u,pn,Se,je,et,kt,Lt,ne,ht,gt,Mn):re(nn,u,pn,Se,je,et,kt,ne,ht,gt,Mn);u.prepareDrawProgram(I,cn,kt.toUnwrapped());const sn=[];u.terrain&&sn.push(qt.centroidVertexBuffer),He&&sn.push(qt.layoutVertexExtBuffer),cn.draw(I,I.gl.TRIANGLES,y,x,D,l.CullFaceMode.backCCW,qn,a.id,qt.layoutVertexBuffer,qt.indexBuffer,qt.segments,a.paint,u.transform.zoom,$t,sn)}}function Io(u,n,a,p,y,x){const D=[ne=>{let He=ne.canonical.x-1,ht=ne.wrap;return He<0&&(He=(1<<ne.canonical.z)-1,ht--),new l.OverscaledTileID(ne.overscaledZ,ht,ne.canonical.z,He,ne.canonical.y)},ne=>{let He=ne.canonical.x+1,ht=ne.wrap;return He===1<<ne.canonical.z&&(He=0,ht++),new l.OverscaledTileID(ne.overscaledZ,ht,ne.canonical.z,He,ne.canonical.y)},ne=>new l.OverscaledTileID(ne.overscaledZ,ne.wrap,ne.canonical.z,ne.canonical.x,(0===ne.canonical.y?1<<ne.canonical.z:ne.canonical.y)-1),ne=>new l.OverscaledTileID(ne.overscaledZ,ne.wrap,ne.canonical.z,ne.canonical.x,ne.canonical.y===(1<<ne.canonical.z)-1?0:ne.canonical.y+1)],I=ne=>{const He=n.getSource().minzoom,ht=Ot=>{const kt=n.getTileByID(Ot);if(kt&&kt.hasData())return kt.getBucket(y)},gt=[0,-1,1];for(const Ot of gt){if(ne.overscaledZ+Ot<He)continue;const kt=ht(ne.calculateScaledKey(ne.overscaledZ+Ot));if(kt)return kt}},R=[0,0,0],U=(ne,He)=>(R[0]=Math.min(ne.min.y,He.min.y),R[1]=Math.max(ne.max.y,He.max.y),R[2]=l.EXTENT-He.min.x>ne.max.x?He.min.x-l.EXTENT:ne.max.x,R),z=(ne,He)=>(R[0]=Math.min(ne.min.x,He.min.x),R[1]=Math.max(ne.max.x,He.max.x),R[2]=l.EXTENT-He.min.y>ne.max.y?He.min.y-l.EXTENT:ne.max.y,R),Q=[(ne,He)=>U(ne,He),(ne,He)=>U(He,ne),(ne,He)=>z(ne,He),(ne,He)=>z(He,ne)],Se=new l.Point(0,0);let je,Ye,$e;const et=(ne,He,ht,gt,Ot)=>{const kt=[[gt?ht:ne,gt?ne:ht,0],[gt?ht:He,gt?He:ht,0]],Lt=Ot<0?l.EXTENT+Ot:Ot,qt=[gt?Lt:(ne+He)/2,gt?(ne+He)/2:Lt,0];return 0===ht&&Ot<0||0!==ht&&Ot>0?x.getForTilePoints($e,[qt],!0,Ye):kt.push(qt),x.getForTilePoints(a,kt,!0,je),Math.max(kt[0][2],kt[1][2],qt[2])/x.exaggeration()};for(let ne=0;ne<4;ne++){const He=(ne<2?1:5)-ne,ht=p.borders[ne];if(0===ht.length)continue;const gt=$e=D[ne](a),Ot=I(gt);if(!(Ot&&Ot instanceof l.FillExtrusionBucket&&Ot.enableTerrain)||p.borderDoneWithNeighborZ[ne]===Ot.canonical.z&&Ot.borderDoneWithNeighborZ[He]===p.canonical.z||(Ye=x.findDEMTileFor(gt),!Ye||!Ye.dem))continue;if(!je){const $t=x.findDEMTileFor(a);if(!$t||!$t.dem)return;je=$t}const kt=Ot.borders[He];let Lt=0;const qt=Ot.borderDoneWithNeighborZ[He]!==p.canonical.z;if(p.canonical.z===Ot.canonical.z){for(let $t=0;$t<ht.length;$t++){const cn=p.featuresOnBorder[ht[$t]],Wn=cn.borders[ne];let nn;for(;Lt<kt.length&&(nn=Ot.featuresOnBorder[kt[Lt]],!(nn.borders[He][1]>Wn[0]+3));)qt&&Ot.encodeCentroid(void 0,nn,!1),Lt++;if(nn&&Lt<kt.length){const Mn=Lt;let pn=0;for(;!(nn.borders[He][0]>Wn[1]-3)&&(pn++,++Lt!==kt.length);)nn=Ot.featuresOnBorder[kt[Lt]];if(nn=Ot.featuresOnBorder[kt[Mn]],cn.intersectsCount()>1||nn.intersectsCount()>1||1!==pn){1!==pn&&(Lt=Mn),p.encodeCentroid(void 0,cn,!1),qt&&Ot.encodeCentroid(void 0,nn,!1);continue}const qn=Q[ne](cn,nn),sn=ne%2?l.EXTENT-1:0;Se.x=et(qn[0],Math.min(l.EXTENT-1,qn[1]),sn,ne<2,qn[2]),Se.y=0,p.encodeCentroid(Se,cn,!1),qt&&Ot.encodeCentroid(Se,nn,!1)}else p.encodeCentroid(void 0,cn,!1)}p.borderDoneWithNeighborZ[ne]=Ot.canonical.z,p.needsCentroidUpdate=!0,qt&&(Ot.borderDoneWithNeighborZ[He]=p.canonical.z,Ot.needsCentroidUpdate=!0)}else{for(const $t of ht)p.encodeCentroid(void 0,p.featuresOnBorder[$t],!1);if(qt){for(const $t of kt)Ot.encodeCentroid(void 0,Ot.featuresOnBorder[$t],!1);Ot.borderDoneWithNeighborZ[He]=p.canonical.z,Ot.needsCentroidUpdate=!0}p.borderDoneWithNeighborZ[ne]=Ot.canonical.z,p.needsCentroidUpdate=!0}}(p.needsCentroidUpdate||!p.centroidVertexBuffer&&0!==p.centroidVertexArray.length)&&p.uploadCentroid(u)}const fo=new l.Color(1,0,0,1),El=new l.Color(0,1,0,1),Za=new l.Color(0,0,1,1),ql=new l.Color(1,0,1,1),Zs=new l.Color(0,1,1,1);function gc(u,n,a){const p=u.context,y=u.transform,x=p.gl,D="globe"===y.projection.name,I=D?["PROJECTION_GLOBE_VIEW"]:null;let R=a.projMatrix;if(D&&l.globeToMercatorTransition(y.zoom)>0){const cn=l.transitionTileAABBinECEF(a.canonical,y),Wn=l.globeDenormalizeECEF(cn);R=l.multiply(new Float32Array(16),y.globeMatrix,Wn),l.multiply(R,y.projMatrix,R)}const U=u.useProgram("debug",null,I),z=n.getTileByID(a.key);u.terrain&&u.terrain.setupElevationDraw(z,U);const Q=l.DepthMode.disabled,Se=l.StencilMode.disabled,je=u.colorModeForRenderPass();p.activeTexture.set(x.TEXTURE0),u.emptyTexture.bind(x.LINEAR,x.CLAMP_TO_EDGE),D?z._makeGlobeTileDebugBuffers(u.context,y):z._makeDebugTileBoundsBuffers(u.context,y.projection);const $e=z._tileDebugBuffer||u.debugBuffer,et=z._tileDebugIndexBuffer||u.debugIndexBuffer,ne=z._tileDebugSegments||u.debugSegments;U.draw(p,x.LINE_STRIP,Q,Se,je,l.CullFaceMode.disabled,Do(R,l.Color.red),"$debug",$e,et,ne,null,null,null,[z._globeTileDebugBorderBuffer]);const He=z.latestRawTileData,ht=Math.floor((He&&He.byteLength||0)/1024),gt=n.getTile(a).tileSize,Ot=512/Math.min(gt,512)*(a.overscaledZ/y.zoom)*.5;let kt=a.canonical.toString();a.overscaledZ!==a.canonical.z&&(kt+=` => ${a.overscaledZ}`),kt+=` ${ht}kb`,function(cn,Wn){cn.initDebugOverlayCanvas();const nn=cn.debugOverlayCanvas,Mn=cn.context.gl,pn=cn.debugOverlayCanvas.getContext("2d");pn.clearRect(0,0,nn.width,nn.height),pn.shadowColor="white",pn.shadowBlur=2,pn.lineWidth=1.5,pn.strokeStyle="white",pn.textBaseline="top",pn.font="bold 36px Open Sans, sans-serif",pn.fillText(Wn,5,5),pn.strokeText(Wn,5,5),cn.debugOverlayTexture.update(nn),cn.debugOverlayTexture.bind(Mn.LINEAR,Mn.CLAMP_TO_EDGE)}(u,kt);const Lt=z._tileDebugTextBuffer||u.debugBuffer,qt=z._tileDebugTextIndexBuffer||u.quadTriangleIndexBuffer,$t=z._tileDebugTextSegments||u.debugSegments;U.draw(p,x.TRIANGLES,Q,Se,l.ColorMode.alphaBlended,l.CullFaceMode.disabled,Do(R,l.Color.transparent,Ot),"$debug",Lt,qt,$t,null,null,null,[z._globeTileDebugTextBuffer])}function Tl(u,n,a,p){Ta(u,0,n+a/2,u.transform.width,a,p)}function Yl(u,n,a,p){Ta(u,n-a/2,0,a,u.transform.height,p)}function Ta(u,n,a,p,y,x){const D=u.context,I=D.gl;I.enable(I.SCISSOR_TEST),I.scissor(n*l.exported.devicePixelRatio,a*l.exported.devicePixelRatio,p*l.exported.devicePixelRatio,y*l.exported.devicePixelRatio),D.clear({color:x}),I.disable(I.SCISSOR_TEST)}const _c=l.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Zc}=_c;function Gs(u,n,a,p){u.emplaceBack(n,a,p)}class Ga{constructor(n){this.vertexArray=new l.StructArrayLayout3f12,this.indices=new l.StructArrayLayout3ui6,Gs(this.vertexArray,-1,-1,1),Gs(this.vertexArray,1,-1,1),Gs(this.vertexArray,-1,1,1),Gs(this.vertexArray,1,1,1),Gs(this.vertexArray,-1,-1,-1),Gs(this.vertexArray,1,-1,-1),Gs(this.vertexArray,-1,1,-1),Gs(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=n.createVertexBuffer(this.vertexArray,Zc),this.indexBuffer=n.createIndexBuffer(this.indices),this.segment=l.SegmentVector.simpleSegment(0,0,36,12)}}function Hs(u,n,a,p,y,x){const D=u.gl,I=n.paint.get("sky-atmosphere-color"),R=n.paint.get("sky-atmosphere-halo-color"),U=n.paint.get("sky-atmosphere-sun-intensity"),z={u_matrix_3f:l.fromMat4(l.create$1(),p),u_sun_direction:y,u_sun_intensity:U,u_color_tint_r:[(Ye=I).r,Ye.g,Ye.b,Ye.a],u_color_tint_m:[($e=R).r,$e.g,$e.b,$e.a],u_luminance:5e-5};var Ye,$e;D.framebufferTexture2D(D.FRAMEBUFFER,D.COLOR_ATTACHMENT0,D.TEXTURE_CUBE_MAP_POSITIVE_X+x,n.skyboxTexture,0),a.draw(u,D.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,l.ColorMode.unblended,l.CullFaceMode.frontCW,z,"skyboxCapture",n.skyboxGeometry.vertexBuffer,n.skyboxGeometry.indexBuffer,n.skyboxGeometry.segment)}const F=l.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class we{constructor(n){const a=new l.StructArrayLayout5f20;a.emplaceBack(-1,1,1,0,0),a.emplaceBack(1,1,1,1,0),a.emplaceBack(1,-1,1,1,1),a.emplaceBack(-1,-1,1,0,1);const p=new l.StructArrayLayout3ui6;p.emplaceBack(0,1,2),p.emplaceBack(2,3,0),this.vertexBuffer=n.createVertexBuffer(a,F.members),this.indexBuffer=n.createIndexBuffer(p),this.segments=l.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const H={symbol:function(u,n,a,p,y){if("translucent"!==u.renderPass)return;const x=l.StencilMode.disabled,D=u.colorModeForRenderPass();a.layout.get("text-variable-anchor")&&function(I,R,U,z,Q,Se,je){const Ye=R.transform,$e="map"===Q,et="map"===Se;for(const ne of I){const He=z.getTile(ne),ht=He.getBucket(U);if(!ht||!ht.text||!ht.text.segments.get().length)continue;const gt=l.evaluateSizeForZoom(ht.textSizeData,Ye.zoom),Ot=_t(ne,ht.getProjection(),Ye),kt=Ye.calculatePixelsToTileUnitsMatrix(He),Lt=vt(Ot,He.tileID.canonical,et,$e,Ye,ht.getProjection(),kt),qt="none"!==U.layout.get("icon-text-fit")&&ht.hasIconData();if(gt){const $t=Math.pow(2,Ye.zoom-He.tileID.overscaledZ);Wl(ht,$e,et,je,l.symbolSize,Ye,Lt,ne,$t,gt,qt)}}}(p,u,a,n,a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),y),0!==a.paint.get("icon-opacity").constantOr(1)&&Cl(u,n,a,p,!1,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),a.layout.get("icon-rotation-alignment"),a.layout.get("icon-pitch-alignment"),a.layout.get("icon-keep-upright"),x,D),0!==a.paint.get("text-opacity").constantOr(1)&&Cl(u,n,a,p,!0,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),a.layout.get("text-rotation-alignment"),a.layout.get("text-pitch-alignment"),a.layout.get("text-keep-upright"),x,D),n.map.showCollisionBoxes&&(es(u,n,a,p,a.paint.get("text-translate"),a.paint.get("text-translate-anchor"),!0),es(u,n,a,p,a.paint.get("icon-translate"),a.paint.get("icon-translate-anchor"),!1))},circle:function(u,n,a,p){if("translucent"!==u.renderPass)return;const y=a.paint.get("circle-opacity"),x=a.paint.get("circle-stroke-width"),D=a.paint.get("circle-stroke-opacity"),I=void 0!==a.layout.get("circle-sort-key").constantOr(1);if(0===y.constantOr(1)&&(0===x.constantOr(1)||0===D.constantOr(1)))return;const R=u.context,U=R.gl,z=u.transform,Q=u.depthModeForSublayer(0,l.DepthMode.ReadOnly),Se=l.StencilMode.disabled,je=u.colorModeForRenderPass(),Ye="globe"===z.projection.name,$e=[l.mercatorXfromLng(z.center.lng),l.mercatorYfromLat(z.center.lat)],et=[];for(let He=0;He<p.length;He++){const ht=p[He],gt=n.getTile(ht),Ot=gt.getBucket(a);if(!Ot||Ot.projection.name!==z.projection.name)continue;const kt=Ot.programConfigurations.get(a.id),Lt=zr(a);Ye&&Lt.push("PROJECTION_GLOBE_VIEW");const qt=u.useProgram("circle",kt,Lt),$t=Ot.layoutVertexBuffer,cn=Ot.globeExtVertexBuffer,Wn=Ot.indexBuffer,nn=z.projection.createInversionMatrix(z,ht.canonical),Mn={programConfiguration:kt,program:qt,layoutVertexBuffer:$t,globeExtVertexBuffer:cn,indexBuffer:Wn,uniformValues:Di(u,ht,gt,nn,$e,a),tile:gt};if(I){const pn=Ot.segments.get();for(const qn of pn)et.push({segments:new l.SegmentVector([qn]),sortKey:qn.sortKey,state:Mn})}else et.push({segments:Ot.segments,sortKey:0,state:Mn})}I&&et.sort((He,ht)=>He.sortKey-ht.sortKey);const ne={useDepthForOcclusion:!Ye};for(const He of et){const{programConfiguration:ht,program:gt,layoutVertexBuffer:Ot,globeExtVertexBuffer:kt,indexBuffer:Lt,uniformValues:qt,tile:$t}=He.state,cn=He.segments;u.terrain&&u.terrain.setupElevationDraw($t,gt,ne),u.prepareDrawProgram(R,gt,$t.tileID.toUnwrapped()),gt.draw(R,U.TRIANGLES,Q,Se,je,l.CullFaceMode.disabled,qt,a.id,Ot,Lt,cn,a.paint,z.zoom,ht,[kt])}},heatmap:function(u,n,a,p){if(0!==a.paint.get("heatmap-opacity"))if("offscreen"===u.renderPass){const y=u.context,x=y.gl,D=l.StencilMode.disabled,I=new l.ColorMode([x.ONE,x.ONE],l.Color.transparent,[!0,!0,!0,!0]);(function(je,Ye,$e,et){const ne=je.gl,He=Ye.width*et,ht=Ye.height*et;je.activeTexture.set(ne.TEXTURE1),je.viewport.set([0,0,He,ht]);let gt=$e.heatmapFbo;if(!gt||gt&&(gt.width!==He||gt.height!==ht)){gt&&gt.destroy();const Ot=ne.createTexture();ne.bindTexture(ne.TEXTURE_2D,Ot),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_S,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_WRAP_T,ne.CLAMP_TO_EDGE),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MIN_FILTER,ne.LINEAR),ne.texParameteri(ne.TEXTURE_2D,ne.TEXTURE_MAG_FILTER,ne.LINEAR),gt=$e.heatmapFbo=je.createFramebuffer(He,ht,!1),function(kt,Lt,qt,$t,cn,Wn){const nn=kt.gl;nn.texImage2D(nn.TEXTURE_2D,0,kt.isWebGL2&&kt.extRenderToTextureHalfFloat?nn.RGBA16F:nn.RGBA,cn,Wn,0,nn.RGBA,kt.extRenderToTextureHalfFloat?kt.isWebGL2?nn.HALF_FLOAT:kt.extTextureHalfFloat.HALF_FLOAT_OES:nn.UNSIGNED_BYTE,null),$t.colorAttachment.set(qt)}(je,0,Ot,gt,He,ht)}else ne.bindTexture(ne.TEXTURE_2D,gt.colorAttachment.get()),je.bindFramebuffer.set(gt.framebuffer)})(y,u,a,"globe"===u.transform.projection.name?.5:.25),y.clear({color:l.Color.transparent});const R=u.transform,U="globe"===R.projection.name,z=U?["PROJECTION_GLOBE_VIEW"]:null,Q=U?l.CullFaceMode.frontCCW:l.CullFaceMode.disabled,Se=[l.mercatorXfromLng(R.center.lng),l.mercatorYfromLat(R.center.lat)];for(let je=0;je<p.length;je++){const Ye=p[je];if(n.hasRenderableParent(Ye))continue;const $e=n.getTile(Ye),et=$e.getBucket(a);if(!et||et.projection.name!==R.projection.name)continue;const ne=et.programConfigurations.get(a.id),He=u.useProgram("heatmap",ne,z),{zoom:ht}=u.transform;u.terrain&&u.terrain.setupElevationDraw($e,He),u.prepareDrawProgram(y,He,Ye.toUnwrapped());const gt=R.projection.createInversionMatrix(R,Ye.canonical);He.draw(y,x.TRIANGLES,l.DepthMode.disabled,D,I,Q,al(u,Ye,$e,gt,Se,ht,a.paint.get("heatmap-intensity")),a.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,a.paint,u.transform.zoom,ne,U?[et.globeExtVertexBuffer]:null)}y.viewport.set([0,0,u.width,u.height])}else"translucent"===u.renderPass&&(u.context.setColorMode(u.colorModeForRenderPass()),function(y,x){const D=y.context,I=D.gl,R=x.heatmapFbo;if(!R)return;D.activeTexture.set(I.TEXTURE0),I.bindTexture(I.TEXTURE_2D,R.colorAttachment.get()),D.activeTexture.set(I.TEXTURE1);let U=x.colorRampTexture;U||(U=x.colorRampTexture=new l.Texture(D,x.colorRamp,I.RGBA)),U.bind(I.LINEAR,I.CLAMP_TO_EDGE),y.useProgram("heatmapTexture").draw(D,I.TRIANGLES,l.DepthMode.disabled,l.StencilMode.disabled,y.colorModeForRenderPass(),l.CullFaceMode.disabled,{u_image:0,u_color_ramp:1,u_opacity:x.paint.get("heatmap-opacity")},x.id,y.viewportBuffer,y.quadTriangleIndexBuffer,y.viewportSegments,x.paint,y.transform.zoom)}(u,a))},line:function(u,n,a,p){if("translucent"!==u.renderPass)return;const y=a.paint.get("line-opacity"),x=a.paint.get("line-width");if(0===y.constantOr(1)||0===x.constantOr(1))return;const D=u.depthModeForSublayer(0,l.DepthMode.ReadOnly),I=u.colorModeForRenderPass(),R=u.terrain&&u.terrain.renderingToTexture?1:l.exported.devicePixelRatio,U=a.paint.get("line-dasharray"),z=U.constantOr(1),Q=a.layout.get("line-cap"),Se=a.paint.get("line-pattern"),je=Se.constantOr(1),Ye=a.paint.get("line-gradient"),$e=je?"linePattern":"line",et=u.context,ne=et.gl,He=(gt=>{const Ot=[];js(gt)&&Ot.push("RENDER_LINE_DASH"),gt.paint.get("line-gradient")&&Ot.push("RENDER_LINE_GRADIENT");const kt=gt.paint.get("line-trim-offset");0===kt[0]&&0===kt[1]||Ot.push("RENDER_LINE_TRIM_OFFSET");const Lt=gt.paint.get("line-pattern").constantOr(1),qt=1!==gt.paint.get("line-opacity").constantOr(1);return!Lt&&qt&&Ot.push("RENDER_LINE_ALPHA_DISCARD"),Ot})(a);let ht=He.includes("RENDER_LINE_ALPHA_DISCARD");u.terrain&&u.terrain.clipOrMaskOverlapStencilType()&&(ht=!1);for(const gt of p){const Ot=n.getTile(gt);if(je&&!Ot.patternsLoaded())continue;const kt=Ot.getBucket(a);if(!kt)continue;u.prepareDrawTile();const Lt=kt.programConfigurations.get(a.id),qt=u.useProgram($e,Lt,He),$t=Se.constantOr(null);if($t&&Ot.imageAtlas){const An=Ot.imageAtlas.patternPositions[$t.toString()];An&&Lt.setConstantPatternPositions(An)}const cn=U.constantOr(null),Wn=Q.constantOr(null);if(!je&&cn&&Wn&&Ot.lineAtlas){const An=Ot.lineAtlas.getDash(cn,Wn);An&&Lt.setConstantPatternPositions(An)}let[nn,Mn]=a.paint.get("line-trim-offset");("round"===Wn||"square"===Wn)&&nn!==Mn&&(0===nn&&(nn-=1),1===Mn&&(Mn+=1));const pn=u.terrain?gt.projMatrix:null,qn=je?xo(u,Ot,a,pn,R):$r(u,Ot,a,pn,kt.lineClipsArray.length,R,[nn,Mn]);if(Ye){const An=kt.gradients[a.id];let Zn=An.texture;if(a.gradientVersion!==An.version){let kn=256;if(a.stepInterpolant){const ti=n.getSource().maxzoom,Ii=gt.canonical.z===ti?Math.ceil(1<<u.transform.maxZoom-gt.canonical.z):1;kn=l.clamp(l.nextPowerOfTwo(kt.maxLineLength/l.EXTENT*1024*Ii),256,et.maxTextureSize)}An.gradient=l.renderColorRamp({expression:a.gradientExpression(),evaluationKey:"lineProgress",resolution:kn,image:An.gradient||void 0,clips:kt.lineClipsArray}),An.texture?An.texture.update(An.gradient):An.texture=new l.Texture(et,An.gradient,ne.RGBA),An.version=a.gradientVersion,Zn=An.texture}et.activeTexture.set(ne.TEXTURE1),Zn.bind(a.stepInterpolant?ne.NEAREST:ne.LINEAR,ne.CLAMP_TO_EDGE)}z&&(et.activeTexture.set(ne.TEXTURE0),Ot.lineAtlasTexture.bind(ne.LINEAR,ne.REPEAT),Lt.updatePaintBuffers()),je&&(et.activeTexture.set(ne.TEXTURE0),Ot.imageAtlasTexture.bind(ne.LINEAR,ne.CLAMP_TO_EDGE),Lt.updatePaintBuffers()),u.prepareDrawProgram(et,qt,gt.toUnwrapped());const sn=An=>{qt.draw(et,ne.TRIANGLES,D,An,I,l.CullFaceMode.disabled,qn,a.id,kt.layoutVertexBuffer,kt.indexBuffer,kt.segments,a.paint,u.transform.zoom,Lt,[kt.layoutVertexBuffer2])};if(ht){const An=u.stencilModeForClipping(gt).ref;0===An&&u.terrain&&et.clear({stencil:0});const Zn={func:ne.EQUAL,mask:255};qn.u_alpha_discard_threshold=.8,sn(new l.StencilMode(Zn,An,255,ne.KEEP,ne.KEEP,ne.INVERT)),qn.u_alpha_discard_threshold=0,sn(new l.StencilMode(Zn,An,255,ne.KEEP,ne.KEEP,ne.KEEP))}else sn(u.stencilModeForClipping(gt))}ht&&(u.resetStencilClippingMasks(),u.terrain&&et.clear({stencil:0}))},fill:function(u,n,a,p){const y=a.paint.get("fill-color"),x=a.paint.get("fill-opacity");if(0===x.constantOr(1))return;const D=u.colorModeForRenderPass(),I=a.paint.get("fill-pattern"),R=u.opaquePassEnabledForLayer()&&!I.constantOr(1)&&1===y.constantOr(l.Color.transparent).a&&1===x.constantOr(0)?"opaque":"translucent";if(u.renderPass===R){const U=u.depthModeForSublayer(1,"opaque"===u.renderPass?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly);oo(u,n,a,p,U,D,!1)}if("translucent"===u.renderPass&&a.paint.get("fill-antialias")){const U=u.depthModeForSublayer(a.getPaintProperty("fill-outline-color")?2:0,l.DepthMode.ReadOnly);oo(u,n,a,p,U,D,!0)}},"fill-extrusion":function(u,n,a,p){const y=a.paint.get("fill-extrusion-opacity");if(0!==y&&"translucent"===u.renderPass){const x=new l.DepthMode(u.context.gl.LEQUAL,l.DepthMode.ReadWrite,u.depthRangeFor3D);if(1!==y||a.paint.get("fill-extrusion-pattern").constantOr(1))$a(u,n,a,p,x,l.StencilMode.disabled,l.ColorMode.disabled),$a(u,n,a,p,x,u.stencilModeFor3D(),u.colorModeForRenderPass()),u.resetStencilClippingMasks();else{const D=u.colorModeForRenderPass();$a(u,n,a,p,x,l.StencilMode.disabled,D)}}},hillshade:function(u,n,a,p){if("offscreen"!==u.renderPass&&"translucent"!==u.renderPass)return;const y=u.context,x=u.depthModeForSublayer(0,l.DepthMode.ReadOnly),D=u.colorModeForRenderPass(),I=u.terrain&&u.terrain.renderingToTexture,[R,U]="translucent"!==u.renderPass||I?[{},p]:u.stencilConfigForOverlap(p);for(const z of U){const Q=n.getTile(z);if(Q.needsHillshadePrepare&&"offscreen"===u.renderPass)Zl(u,Q,a,x,l.StencilMode.disabled,D);else if("translucent"===u.renderPass){const Se=I&&u.terrain?u.terrain.stencilModeForRTTOverlap(z):R[z.overscaledZ];bl(u,z,Q,a,x,Se,D)}}y.viewport.set([0,0,u.width,u.height]),u.resetStencilClippingMasks()},raster:function(u,n,a,p,y,x){if("translucent"!==u.renderPass||0===a.paint.get("raster-opacity")||!p.length)return;const D=u.context,I=D.gl,R=n.getSource(),U=u.useProgram("raster"),z=u.colorModeForRenderPass(),Q=u.terrain&&u.terrain.renderingToTexture,[Se,je]=R instanceof Z||Q?[{},p]:u.stencilConfigForOverlap(p),Ye=je[je.length-1].overscaledZ,$e=!u.options.moving;for(const et of je){const ne=Q?l.DepthMode.disabled:u.depthModeForSublayer(et.overscaledZ-Ye,1===a.paint.get("raster-opacity")?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly,I.LESS),He=et.toUnwrapped(),ht=n.getTile(et);if(Q&&(!ht||!ht.hasData()))continue;const gt=Q?et.projMatrix:u.transform.calculateProjMatrix(He,$e),Ot=u.terrain&&Q?u.terrain.stencilModeForRTTOverlap(et):Se[et.overscaledZ],kt=x?0:a.paint.get("raster-fade-duration");ht.registerFadeDuration(kt);const Lt=n.findLoadedParent(et,0),qt=ea(ht,Lt,n,u.transform,kt);let $t,cn;u.terrain&&u.terrain.prepareDrawTile();const Wn="nearest"===a.paint.get("raster-resampling")?I.NEAREST:I.LINEAR;D.activeTexture.set(I.TEXTURE0),ht.texture.bind(Wn,I.CLAMP_TO_EDGE),D.activeTexture.set(I.TEXTURE1),Lt?(Lt.texture.bind(Wn,I.CLAMP_TO_EDGE),$t=Math.pow(2,Lt.tileID.overscaledZ-ht.tileID.overscaledZ),cn=[ht.tileID.canonical.x*$t%1,ht.tileID.canonical.y*$t%1]):ht.texture.bind(Wn,I.CLAMP_TO_EDGE),ht.texture.useMipmap&&D.extTextureFilterAnisotropic&&u.transform.pitch>20&&I.texParameterf(I.TEXTURE_2D,D.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,D.extTextureFilterAnisotropicMax);const nn=wl(gt,cn||[0,0],$t||1,qt,a,R instanceof Z?R.perspectiveTransform:[0,0]);if(u.prepareDrawProgram(D,U,He),R instanceof Z)R.boundsBuffer&&R.boundsSegments&&U.draw(D,I.TRIANGLES,ne,l.StencilMode.disabled,z,l.CullFaceMode.disabled,nn,a.id,R.boundsBuffer,u.quadTriangleIndexBuffer,R.boundsSegments);else{const{tileBoundsBuffer:Mn,tileBoundsIndexBuffer:pn,tileBoundsSegments:qn}=u.getTileBoundsBuffers(ht);U.draw(D,I.TRIANGLES,ne,Ot,z,l.CullFaceMode.disabled,nn,a.id,Mn,pn,qn)}}u.resetStencilClippingMasks()},background:function(u,n,a,p){const y=a.paint.get("background-color"),x=a.paint.get("background-opacity");if(0===x)return;const D=u.context,I=D.gl,R=u.transform,U=R.tileSize,z=a.paint.get("background-pattern");if(u.isPatternMissing(z))return;const Q=!z&&1===y.a&&1===x&&u.opaquePassEnabledForLayer()?"opaque":"translucent";if(u.renderPass!==Q)return;const Se=l.StencilMode.disabled,je=u.depthModeForSublayer(0,"opaque"===Q?l.DepthMode.ReadWrite:l.DepthMode.ReadOnly),Ye=u.colorModeForRenderPass(),$e=u.useProgram(z?"backgroundPattern":"background");let et,ne=p;ne||(et=u.getBackgroundTiles(),ne=Object.values(et).map(He=>He.tileID)),z&&(D.activeTexture.set(I.TEXTURE0),u.imageManager.bind(u.context));for(const He of ne){const ht=He.toUnwrapped(),gt=p?He.projMatrix:u.transform.calculateProjMatrix(ht);u.prepareDrawTile();const Ot=n?n.getTile(He):et?et[He.key]:new l.Tile(He,U,R.zoom,u),kt=z?Hl(gt,x,u,z,{tileID:He,tileSize:U}):ma(gt,x,y);u.prepareDrawProgram(D,$e,ht);const{tileBoundsBuffer:Lt,tileBoundsIndexBuffer:qt,tileBoundsSegments:$t}=u.getTileBoundsBuffers(Ot);$e.draw(D,I.TRIANGLES,je,Se,Ye,l.CullFaceMode.disabled,kt,a.id,Lt,qt,$t)}},sky:function(u,n,a){const p=u.transform,y="mercator"===p.projection.name||"globe"===p.projection.name?1:l.smoothstep(7,8,p.zoom),x=a.paint.get("sky-opacity")*y;if(0===x)return;const D=u.context,I=a.paint.get("sky-type"),R=new l.DepthMode(D.gl.LEQUAL,l.DepthMode.ReadOnly,[0,1]),U=u.frameCounter/1e3%1;"atmosphere"===I?"offscreen"===u.renderPass?a.needsSkyboxCapture(u)&&(function(z,Q,Se,je){const Ye=z.context,$e=Ye.gl;let et=Q.skyboxFbo;if(!et){et=Q.skyboxFbo=Ye.createFramebuffer(32,32,!1),Q.skyboxGeometry=new Ga(Ye),Q.skyboxTexture=Ye.gl.createTexture(),$e.bindTexture($e.TEXTURE_CUBE_MAP,Q.skyboxTexture),$e.texParameteri($e.TEXTURE_CUBE_MAP,$e.TEXTURE_WRAP_S,$e.CLAMP_TO_EDGE),$e.texParameteri($e.TEXTURE_CUBE_MAP,$e.TEXTURE_WRAP_T,$e.CLAMP_TO_EDGE),$e.texParameteri($e.TEXTURE_CUBE_MAP,$e.TEXTURE_MIN_FILTER,$e.LINEAR),$e.texParameteri($e.TEXTURE_CUBE_MAP,$e.TEXTURE_MAG_FILTER,$e.LINEAR);for(let gt=0;gt<6;++gt)$e.texImage2D($e.TEXTURE_CUBE_MAP_POSITIVE_X+gt,0,$e.RGBA,32,32,0,$e.RGBA,$e.UNSIGNED_BYTE,null)}Ye.bindFramebuffer.set(et.framebuffer),Ye.viewport.set([0,0,32,32]);const ne=Q.getCenter(z,!0),He=z.useProgram("skyboxCapture"),ht=new Float64Array(16);l.identity(ht),l.rotateY(ht,ht,.5*-Math.PI),Hs(Ye,Q,He,ht,ne,0),l.identity(ht),l.rotateY(ht,ht,.5*Math.PI),Hs(Ye,Q,He,ht,ne,1),l.identity(ht),l.rotateX(ht,ht,.5*-Math.PI),Hs(Ye,Q,He,ht,ne,2),l.identity(ht),l.rotateX(ht,ht,.5*Math.PI),Hs(Ye,Q,He,ht,ne,3),l.identity(ht),Hs(Ye,Q,He,ht,ne,4),l.identity(ht),l.rotateY(ht,ht,Math.PI),Hs(Ye,Q,He,ht,ne,5),Ye.viewport.set([0,0,z.width,z.height])}(u,a),a.markSkyboxValid(u)):"sky"===u.renderPass&&function(z,Q,Se,je,Ye){const $e=z.context,et=$e.gl,ne=z.transform,He=z.useProgram("skybox");$e.activeTexture.set(et.TEXTURE0),et.bindTexture(et.TEXTURE_CUBE_MAP,Q.skyboxTexture);const ht=((gt,Ot,kt,Lt,qt)=>({u_matrix:gt,u_sun_direction:Ot,u_cubemap:0,u_opacity:Lt,u_temporal_offset:qt}))(ne.skyboxMatrix,Q.getCenter(z,!1),0,je,Ye);z.prepareDrawProgram($e,He),He.draw($e,et.TRIANGLES,Se,l.StencilMode.disabled,z.colorModeForRenderPass(),l.CullFaceMode.backCW,ht,"skybox",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(u,a,R,x,U):"gradient"===I&&"sky"===u.renderPass&&function(z,Q,Se,je,Ye){const $e=z.context,et=$e.gl,ne=z.transform,He=z.useProgram("skyboxGradient");Q.skyboxGeometry||(Q.skyboxGeometry=new Ga($e)),$e.activeTexture.set(et.TEXTURE0);let ht=Q.colorRampTexture;ht||(ht=Q.colorRampTexture=new l.Texture($e,Q.colorRamp,et.RGBA)),ht.bind(et.LINEAR,et.CLAMP_TO_EDGE);const gt=(Ot=ne.skyboxMatrix,kt=Q.getCenter(z,!1),Lt=Q.paint.get("sky-gradient-radius"),qt=je,$t=Ye,{u_matrix:Ot,u_color_ramp:0,u_center_direction:kt,u_radius:l.degToRad(Lt),u_opacity:qt,u_temporal_offset:$t});var Ot,kt,Lt,qt,$t;z.prepareDrawProgram($e,He),He.draw($e,et.TRIANGLES,Se,l.StencilMode.disabled,z.colorModeForRenderPass(),l.CullFaceMode.backCW,gt,"skyboxGradient",Q.skyboxGeometry.vertexBuffer,Q.skyboxGeometry.indexBuffer,Q.skyboxGeometry.segment)}(u,a,R,x,U)},debug:function(u,n,a){for(let p=0;p<a.length;p++)gc(u,n,a[p])},custom:function(u,n,a,p){const y=u.context,x=a.implementation;if(!u.transform.projection.unsupportedLayers||!u.transform.projection.unsupportedLayers.includes("custom")||u.terrain&&(u.terrain.renderingToTexture||"offscreen"===u.renderPass)&&a.isLayerDraped()){if("offscreen"===u.renderPass){const D=x.prerender;if(D){if(u.setCustomLayerDefaults(),y.setColorMode(u.colorModeForRenderPass()),"globe"===u.transform.projection.name){const I=u.transform.pointMerc;D.call(x,y.gl,u.transform.customLayerMatrix(),u.transform.getProjection(),u.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(u.transform.zoom),[I.x,I.y],u.transform.pixelsPerMeterRatio)}else D.call(x,y.gl,u.transform.customLayerMatrix());y.setDirty(),u.setBaseState()}}else if("translucent"===u.renderPass){if(u.terrain&&u.terrain.renderingToTexture){const I=x.renderToTile;if(I){const R=p[0].canonical,U=new l.MercatorCoordinate(R.x+p[0].wrap*(1<<R.z),R.y,R.z);y.setDepthMode(l.DepthMode.disabled),y.setStencilMode(l.StencilMode.disabled),y.setColorMode(u.colorModeForRenderPass()),u.setCustomLayerDefaults(),I.call(x,y.gl,U),y.setDirty(),u.setBaseState()}return}u.setCustomLayerDefaults(),y.setColorMode(u.colorModeForRenderPass()),y.setStencilMode(l.StencilMode.disabled);const D="3d"===x.renderingMode?new l.DepthMode(u.context.gl.LEQUAL,l.DepthMode.ReadWrite,u.depthRangeFor3D):u.depthModeForSublayer(0,l.DepthMode.ReadOnly);if(y.setDepthMode(D),"globe"===u.transform.projection.name){const I=u.transform.pointMerc;x.render(y.gl,u.transform.customLayerMatrix(),u.transform.getProjection(),u.transform.globeToMercatorMatrix(),l.globeToMercatorTransition(u.transform.zoom),[I.x,I.y],u.transform.pixelsPerMeterRatio)}else x.render(y.gl,u.transform.customLayerMatrix());y.setDirty(),u.setBaseState(),y.bindFramebuffer.set(null)}}else l.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class le{constructor(n,a,p=!1){this.context=new Nn(n,p),this.transform=a,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=l.SourceCache.maxUnderzooming+l.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(n,a){const p=!!n&&!!n.terrain&&this.transform.projection.supportsTerrain;if(!(p||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new ro(this,n));const y=this._terrain;this.transform.elevation=p?y:null,y.update(n,this.transform,a)}_updateFog(n){const a=n.fog;if(!a||"globe"===this.transform.projection.name||a.getOpacity(this.transform.pitch)<1||a.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[p,y]=a.getFovAdjustedRange(this.transform._fov);if(p>y)return void(this.transform.fogCullDistSq=null);const x=p+.78*(y-p);this.transform.fogCullDistSq=x*x}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(n,a){if(this.width=n*l.exported.devicePixelRatio,this.height=a*l.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const p of this.style.order)this.style._layers[p].resize()}setup(){const n=this.context,a=new l.StructArrayLayout2i4;a.emplaceBack(0,0),a.emplaceBack(l.EXTENT,0),a.emplaceBack(0,l.EXTENT),a.emplaceBack(l.EXTENT,l.EXTENT),this.tileExtentBuffer=n.createVertexBuffer(a,l.posAttributes.members),this.tileExtentSegments=l.SegmentVector.simpleSegment(0,0,4,2);const p=new l.StructArrayLayout2i4;p.emplaceBack(0,0),p.emplaceBack(l.EXTENT,0),p.emplaceBack(0,l.EXTENT),p.emplaceBack(l.EXTENT,l.EXTENT),this.debugBuffer=n.createVertexBuffer(p,l.posAttributes.members),this.debugSegments=l.SegmentVector.simpleSegment(0,0,4,5);const y=new l.StructArrayLayout2i4;y.emplaceBack(-1,-1),y.emplaceBack(1,-1),y.emplaceBack(-1,1),y.emplaceBack(1,1),this.viewportBuffer=n.createVertexBuffer(y,l.posAttributes.members),this.viewportSegments=l.SegmentVector.simpleSegment(0,0,4,2);const x=new l.StructArrayLayout4i8;x.emplaceBack(0,0,0,0),x.emplaceBack(l.EXTENT,0,l.EXTENT,0),x.emplaceBack(0,l.EXTENT,0,l.EXTENT),x.emplaceBack(l.EXTENT,l.EXTENT,l.EXTENT,l.EXTENT),this.mercatorBoundsBuffer=n.createVertexBuffer(x,l.boundsAttributes.members),this.mercatorBoundsSegments=l.SegmentVector.simpleSegment(0,0,4,2);const D=new l.StructArrayLayout3ui6;D.emplaceBack(0,1,2),D.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=n.createIndexBuffer(D);const I=new l.StructArrayLayout1ui2;for(const U of[0,1,3,2,0])I.emplaceBack(U);this.debugIndexBuffer=n.createIndexBuffer(I),this.emptyTexture=new l.Texture(n,new l.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),n.gl.RGBA),this.identityMat=l.create();const R=this.context.gl;this.stencilClearMode=new l.StencilMode({func:R.ALWAYS,mask:0},0,255,R.ZERO,R.ZERO,R.ZERO),this.loadTimeStamps.push(l.window.performance.now()),this.atmosphereBuffer=new we(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(n){return n._makeTileBoundsBuffers(this.context,this.transform.projection),n._tileBoundsBuffer?{tileBoundsBuffer:n._tileBoundsBuffer,tileBoundsIndexBuffer:n._tileBoundsIndexBuffer,tileBoundsSegments:n._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const n=this.context,a=n.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(n,a.TRIANGLES,l.DepthMode.disabled,this.stencilClearMode,l.ColorMode.disabled,l.CullFaceMode.disabled,fa(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(n,a,p){if(!a||this.currentStencilSource===a.id||!n.isTileClipped()||!p||0===p.length)return;if(this._tileClippingMaskIDs&&!this.terrain){let I=!1;for(const R of p)if(void 0===this._tileClippingMaskIDs[R.key]){I=!0;break}if(!I)return}this.currentStencilSource=a.id;const y=this.context,x=y.gl;this.nextStencilID+p.length>256&&this.clearStencil(),y.setColorMode(l.ColorMode.disabled),y.setDepthMode(l.DepthMode.disabled);const D=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const I of p){const R=a.getTile(I),U=this._tileClippingMaskIDs[I.key]=this.nextStencilID++,{tileBoundsBuffer:z,tileBoundsIndexBuffer:Q,tileBoundsSegments:Se}=this.getTileBoundsBuffers(R);D.draw(y,x.TRIANGLES,l.DepthMode.disabled,new l.StencilMode({func:x.ALWAYS,mask:0},U,255,x.KEEP,x.KEEP,x.REPLACE),l.ColorMode.disabled,l.CullFaceMode.disabled,fa(I.projMatrix),"$clipping",z,Q,Se)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const n=this.nextStencilID++,a=this.context.gl;return new l.StencilMode({func:a.NOTEQUAL,mask:255},n,255,a.KEEP,a.KEEP,a.REPLACE)}stencilModeForClipping(n){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(n);const a=this.context.gl;return new l.StencilMode({func:a.EQUAL,mask:255},this._tileClippingMaskIDs[n.key],0,a.KEEP,a.KEEP,a.REPLACE)}stencilConfigForOverlap(n){const a=this.context.gl,p=n.sort((D,I)=>I.overscaledZ-D.overscaledZ),y=p[p.length-1].overscaledZ,x=p[0].overscaledZ-y+1;if(x>1){this.currentStencilSource=void 0,this.nextStencilID+x>256&&this.clearStencil();const D={};for(let I=0;I<x;I++)D[I+y]=new l.StencilMode({func:a.GEQUAL,mask:255},I+this.nextStencilID,255,a.KEEP,a.KEEP,a.REPLACE);return this.nextStencilID+=x,[D,p]}return[{[y]:l.StencilMode.disabled},p]}colorModeForRenderPass(){const n=this.context.gl;return this._showOverdrawInspector?new l.ColorMode([n.CONSTANT_COLOR,n.ONE],new l.Color(.125,.125,.125,0),[!0,!0,!0,!0]):"opaque"===this.renderPass?l.ColorMode.unblended:l.ColorMode.alphaBlended}depthModeForSublayer(n,a,p){if(!this.opaquePassEnabledForLayer())return l.DepthMode.disabled;const y=1-((1+this.currentLayer)*this.numSublayers+n)*this.depthEpsilon;return new l.DepthMode(p||this.context.gl.LEQUAL,a,[y,y])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(n,a){this.style=n,this.options=a,this.imageManager=n.imageManager,this.glyphManager=n.glyphManager,this.symbolFadeChange=n.placement.symbolFadeChange(l.exported.now()),this.imageManager.beginFrame();const p=this.style.order,y=this.style._sourceCaches;for(const U in y){const z=y[U];z.used&&z.prepare(this.context)}const x={},D={},I={};for(const U in y){const z=y[U];x[U]=z.getVisibleCoordinates(),D[U]=x[U].slice().reverse(),I[U]=z.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let U=0;U<p.length;U++)if(this.style._layers[p[U]].is3D()){this.opaquePassCutoff=U;break}if(this.terrain&&(this.terrain.updateTileBinding(I),this.opaquePassCutoff=0),"globe"!==this.transform.projection.name||this.globeSharedBuffers||(this.globeSharedBuffers=new l.GlobeSharedBuffers(this.context)),!l.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const U of p){const z=this.style._layers[U],Q=n._getLayerSourceCache(z);if(!z.hasOffscreenPass()||z.isHidden(this.transform.zoom))continue;const Se=Q?D[Q.id]:void 0;("custom"===z.type||z.isSky()||Se&&Se.length)&&this.renderLayer(this,Q,z,Se)}this.depthRangeFor3D=[0,1-(n.order.length+2)*this.numSublayers*this.depthEpsilon];const R=this.terrain;if(R&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&R.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:a.showOverdrawInspector?l.Color.black:l.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=a.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=p.length-1;this.currentLayer>=0;this.currentLayer--){const U=this.style._layers[p[this.currentLayer]],z=n._getLayerSourceCache(U);if(U.isSky())continue;const Q=z?D[z.id]:void 0;this._renderTileClippingMasks(U,z,Q),this.renderLayer(this,z,U,Q)}if(this.style.fog&&this.transform.projection.supportsFog&&function(U,z){const Q=U.context,Se=Q.gl,je=U.transform,Ye=new l.DepthMode(Se.LEQUAL,l.DepthMode.ReadOnly,[0,1]),$e=U.useProgram("globeAtmosphere",null,"globe"===je.projection.name?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),et=l.globeToMercatorTransition(je.zoom),ne=z.properties.get("color").toArray01(),He=z.properties.get("high-color").toArray01(),ht=z.properties.get("space-color").toArray01PremultipliedAlpha(),gt=l.identity$1([]);l.rotateY$1(gt,gt,-l.degToRad(je._center.lng)),l.rotateX$1(gt,gt,l.degToRad(je._center.lat)),l.rotateZ$1(gt,gt,je.angle),l.rotateX$1(gt,gt,-je._pitch);const Ot=l.fromQuat(new Float32Array(16),gt),kt=l.mapValue(z.properties.get("star-intensity"),0,1,0,.25),qt=l.mapValue(z.properties.get("horizon-blend"),0,1,5e-4,.25),$t=l.globeUseCustomAntiAliasing(U,Q,je)&&5e-4===qt?je.worldSize/(2*Math.PI*1.025)-1:je.globeRadius,cn=U.frameCounter/1e3%1,Wn=l.length(je.globeCenterInViewSpace),nn=Math.sqrt(Math.pow(Wn,2)-Math.pow($t,2)),Mn=Math.acos(nn/Wn),pn={u_frustum_tl:je.frustumCorners.TL,u_frustum_tr:je.frustumCorners.TR,u_frustum_br:je.frustumCorners.BR,u_frustum_bl:je.frustumCorners.BL,u_horizon:je.frustumCorners.horizon,u_transition:et,u_fadeout_range:qt,u_color:ne,u_high_color:He,u_space_color:ht,u_star_intensity:kt,u_star_size:5*l.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:cn,u_horizon_angle:Mn,u_rotation_matrix:Ot};U.prepareDrawProgram(Q,$e);const qn=U.atmosphereBuffer;qn&&$e.draw(Q,Se.TRIANGLES,Ye,l.StencilMode.disabled,l.ColorMode.alphaBlended,l.CullFaceMode.backCW,pn,"skybox",qn.vertexBuffer,qn.indexBuffer,qn.segments)}(this,this.style.fog),this.renderPass="sky",(l.globeToMercatorTransition(this.transform.zoom)>0||"globe"!==this.transform.projection.name)&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<p.length;this.currentLayer++){const U=this.style._layers[p[this.currentLayer]],z=n._getLayerSourceCache(U);U.isSky()&&this.renderLayer(this,z,U,z?D[z.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<p.length;){const U=this.style._layers[p[this.currentLayer]],z=n._getLayerSourceCache(U);if(U.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(U)){if(U.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const Q=z?("symbol"===U.type?I:D)[z.id]:void 0;this._renderTileClippingMasks(U,z,z?x[z.id]:void 0),this.renderLayer(this,z,U,Q),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let U=null;l.values(this.style._layers).forEach(z=>{const Q=n._getLayerSourceCache(z);Q&&!z.isHidden(this.transform.zoom)&&(!U||U.getSource().maxzoom<Q.getSource().maxzoom)&&(U=Q)}),U&&this.options.showTileBoundaries&&H.debug(this,U,U.getVisibleCoordinates())}this.options.showPadding&&function(U){const z=U.transform.padding;Tl(U,U.transform.height-(z.top||0),3,fo),Tl(U,z.bottom||0,3,El),Yl(U,z.left||0,3,Za),Yl(U,U.transform.width-(z.right||0),3,ql);const Q=U.transform.centerPoint;var Se,je,Ye,$e;Ta(Se=U,(je=Q.x)-1,(Ye=U.transform.height-Q.y)-10,2,20,$e=Zs),Ta(Se,je-10,Ye-1,20,2,$e)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(l.window.performance.now()),this.saveCanvasCopy())}renderLayer(n,a,p,y){p.isHidden(this.transform.zoom)||("background"===p.type||"sky"===p.type||"custom"===p.type||y&&y.length)&&(this.id=p.id,this.gpuTimingStart(p),(!n.transform.projection.unsupportedLayers||!n.transform.projection.unsupportedLayers.includes(p.type)||n.terrain&&"custom"===p.type)&&H[p.type](n,a,p,y,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(n){if(!this.options.gpuTiming)return;const a=this.context.extTimerQuery;let p=this.gpuTimers[n.id];p||(p=this.gpuTimers[n.id]={calls:0,cpuTime:0,query:a.createQueryEXT()}),p.calls++,a.beginQueryEXT(a.TIME_ELAPSED_EXT,p.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const n=this.context.extTimerQuery,a=n.createQueryEXT();this.deferredRenderGpuTimeQueries.push(a),n.beginQueryEXT(n.TIME_ELAPSED_EXT,a)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const n=this.context.extTimerQuery;n.endQueryEXT(n.TIME_ELAPSED_EXT)}collectGpuTimers(){const n=this.gpuTimers;return this.gpuTimers={},n}collectDeferredRenderGpuQueries(){const n=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],n}queryGpuTimers(n){const a={};for(const p in n){const y=n[p],x=this.context.extTimerQuery,D=x.getQueryObjectEXT(y.query,x.QUERY_RESULT_EXT)/1e6;x.deleteQueryEXT(y.query),a[p]=D}return a}queryGpuTimeDeferredRender(n){if(!this.options.gpuTimingDeferredRender)return 0;const a=this.context.extTimerQuery;let p=0;for(const y of n)p+=a.getQueryObjectEXT(y,a.QUERY_RESULT_EXT)/1e6,a.deleteQueryEXT(y);return p}translatePosMatrix(n,a,p,y,x){if(!p[0]&&!p[1])return n;const D=x?"map"===y?this.transform.angle:0:"viewport"===y?-this.transform.angle:0;if(D){const U=Math.sin(D),z=Math.cos(D);p=[p[0]*z-p[1]*U,p[0]*U+p[1]*z]}const I=[x?p[0]:_n(a,p[0],this.transform.zoom),x?p[1]:_n(a,p[1],this.transform.zoom),0],R=new Float32Array(16);return l.translate(R,n,I),R}saveTileTexture(n){const a=this._tileTextures[n.size[0]];a?a.push(n):this._tileTextures[n.size[0]]=[n]}getTileTexture(n){const a=this._tileTextures[n];return a&&a.length>0?a.pop():null}isPatternMissing(n){return null===n||void 0!==n&&!this.imageManager.getPattern(n.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const n=this.terrain&&this.terrain.renderingToTexture,a=this.terrain&&0===this.terrain.exaggeration(),p=this.style&&this.style.fog,y=[];return this.terrainRenderModeElevated()&&y.push("TERRAIN"),"globe"===this.transform.projection.name&&y.push("GLOBE"),a&&y.push("ZERO_EXAGGERATION"),p&&!n&&0!==p.getOpacity(this.transform.pitch)&&y.push("FOG"),n&&y.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&y.push("OVERDRAW_INSPECTOR"),y}useProgram(n,a,p){this.cache=this.cache||{};const y=p||[],x=this.currentGlobalDefines().concat(y),D=Pi.cacheKey(Ba[n],n,x,a);return this.cache[D]||(this.cache[D]=new Pi(this.context,n,Ba[n],a,$s[n],x)),this.cache[D]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const n=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(n.FUNC_ADD)}initDebugOverlayCanvas(){null==this.debugOverlayCanvas&&(this.debugOverlayCanvas=l.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new l.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(n,a,p){if(this.terrain&&this.terrain.renderingToTexture)return;const y=this.style.fog;if(y){const x=y.getOpacity(this.transform.pitch),D=((I,R,U,z,Q,Se,je,Ye,$e,et,ne)=>{const He=I.transform,ht=R.properties.get("color").toArray01();ht[3]=z;const gt=I.frameCounter/1e3%1;return{u_fog_matrix:U?He.calculateFogTileMatrix(U):I.identityMat,u_fog_range:R.getFovAdjustedRange(He._fov),u_fog_color:ht,u_fog_horizon_blend:R.properties.get("horizon-blend"),u_fog_temporal_offset:gt,u_frustum_tl:Q,u_frustum_tr:Se,u_frustum_br:je,u_frustum_bl:Ye,u_globe_pos:$e,u_globe_radius:et,u_viewport:ne,u_globe_transition:l.globeToMercatorTransition(He.zoom),u_is_globe:+("globe"===He.projection.name)}})(this,y,p,x,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*l.exported.devicePixelRatio,this.transform.height*l.exported.devicePixelRatio]);a.setFogUniformValues(n,D)}}setTileLoadedFlag(n){this.tileLoaded=n}saveCanvasCopy(){const n=this.canvasCopy();n&&(this.frameCopies.push(n),this.tileLoaded=!1)}canvasCopy(){const n=this.context.gl,a=n.createTexture();return n.bindTexture(n.TEXTURE_2D,a),n.copyTexImage2D(n.TEXTURE_2D,0,n.RGBA,0,0,n.drawingBufferWidth,n.drawingBufferHeight,0),a}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const n=this.style&&this.style.fog;return!!n&&0!==n.getOpacity(this.transform.pitch)}getBackgroundTiles(){const n=this._backgroundTiles,a=this._backgroundTiles={},p=this.transform.coveringTiles({tileSize:512});for(const y of p)a[y.key]=n[y.key]||new l.Tile(y,512,this.transform.tileZoom,this);return a}clearBackgroundTiles(){this._backgroundTiles={}}}class wt{constructor(n=0,a=0,p=0,y=0){if(isNaN(n)||n<0||isNaN(a)||a<0||isNaN(p)||p<0||isNaN(y)||y<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=n,this.bottom=a,this.left=p,this.right=y}interpolate(n,a,p){return null!=a.top&&null!=n.top&&(this.top=l.number(n.top,a.top,p)),null!=a.bottom&&null!=n.bottom&&(this.bottom=l.number(n.bottom,a.bottom,p)),null!=a.left&&null!=n.left&&(this.left=l.number(n.left,a.left,p)),null!=a.right&&null!=n.right&&(this.right=l.number(n.right,a.right,p)),this}getCenter(n,a){const p=l.clamp((this.left+n-this.right)/2,0,n),y=l.clamp((this.top+a-this.bottom)/2,0,a);return new l.Point(p,y)}equals(n){return this.top===n.top&&this.bottom===n.bottom&&this.left===n.left&&this.right===n.right}clone(){return new wt(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function yn(u,n){const a=l.getColumn(u,3);l.fromQuat(u,n),l.setColumn(u,3,a)}function xn(u,n){const a=l.identity$1([]);return l.rotateZ$1(a,a,-n),l.rotateX$1(a,a,-u),a}function xi(u,n){const a=[u[0],u[1],0],p=[n[0],n[1],0];if(l.length(a)>=1e-15){const D=l.normalize([],a);l.scale$2(p,D,l.dot(p,D)),n[0]=p[0],n[1]=p[1]}const y=l.cross([],n,u);if(l.len(y)<1e-15)return null;const x=Math.atan2(-y[1],y[0]);return xn(Math.atan2(Math.sqrt(u[0]*u[0]+u[1]*u[1]),-u[2]),x)}class Jr{constructor(n,a){this.position=n,this.orientation=a}get position(){return this._position}set position(n){if(n){const a=n instanceof l.MercatorCoordinate?n:new l.MercatorCoordinate(n[0],n[1],n[2]);this._renderWorldCopies&&(a.x=l.wrap(a.x,0,1)),this._position=a}else this._position=null}lookAtPoint(n,a){if(this.orientation=null,!this.position)return;const p=this.position,y=this._elevation?this._elevation.getAtPointOrZero(l.MercatorCoordinate.fromLngLat(n)):0,x=l.MercatorCoordinate.fromLngLat(n,y),D=[x.x-p.x,x.y-p.y,x.z-p.z];a||(a=[0,0,1]),a[2]=Math.abs(a[2]),this.orientation=xi(D,a)}setPitchBearing(n,a){this.orientation=xn(l.degToRad(n),l.degToRad(-a))}}class Pr{constructor(n,a){this._transform=l.identity([]),this.orientation=a,this.position=n}get mercatorPosition(){const n=this.position;return new l.MercatorCoordinate(n[0],n[1],n[2])}get position(){const n=l.getColumn(this._transform,3);return[n[0],n[1],n[2]]}set position(n){var a;n&&l.setColumn(this._transform,3,[(a=n)[0],a[1],a[2],1])}get orientation(){return this._orientation}set orientation(n){this._orientation=n||l.identity$1([]),n&&yn(this._transform,this._orientation)}getPitchBearing(){const n=this.forward(),a=this.right();return{bearing:Math.atan2(-a[1],a[0]),pitch:Math.atan2(Math.sqrt(n[0]*n[0]+n[1]*n[1]),-n[2])}}setPitchBearing(n,a){this._orientation=xn(n,a),yn(this._transform,this._orientation)}forward(){const n=l.getColumn(this._transform,2);return[-n[0],-n[1],-n[2]]}up(){const n=l.getColumn(this._transform,1);return[-n[0],-n[1],-n[2]]}right(){const n=l.getColumn(this._transform,0);return[n[0],n[1],n[2]]}getCameraToWorld(n,a){const p=new Float64Array(16);return l.invert(p,this.getWorldToCamera(n,a)),p}getWorldToCameraPosition(n,a,p){const y=this.position;l.scale$2(y,y,-n);const x=new Float64Array(16);return l.fromScaling(x,[p,p,p]),l.translate(x,x,y),x[10]*=a,x}getWorldToCamera(n,a){const p=new Float64Array(16),y=new Float64Array(4),x=this.position;return l.conjugate(y,this._orientation),l.scale$2(x,x,-n),l.fromQuat(p,y),l.translate(p,p,x),p[1]*=-1,p[5]*=-1,p[9]*=-1,p[13]*=-1,p[8]*=a,p[9]*=a,p[10]*=a,p[11]*=a,p}getCameraToClipPerspective(n,a,p,y){const x=new Float64Array(16);return l.perspective(x,n,a,p,y),x}getDistanceToElevation(n,a=!1){const p=0===n?0:l.mercatorZfromAltitude(n,a?l.latFromMercatorY(this.position[1]):this.position[1]),y=this.forward();return(p-this.position[2])/y[2]}clone(){return new Pr([...this.position],[...this.orientation])}}function xr(u,n){const a=Kr(u.projection,u.zoom,u.width,u.height),p=function(x,D,I,R,U){const z=new l.LngLat(I.lng-180*_r,I.lat),Q=new l.LngLat(I.lng+180*_r,I.lat),Se=x.project(z.lng,z.lat),je=x.project(Q.lng,Q.lat),Ye=-Math.atan2(je.y-Se.y,je.x-Se.x),$e=l.MercatorCoordinate.fromLngLat(I);$e.y=l.clamp($e.y,-1+_r,1-_r);const et=$e.toLngLat(),ne=x.project(et.lng,et.lat),He=l.MercatorCoordinate.fromLngLat(et);He.x+=_r;const ht=He.toLngLat(),gt=x.project(ht.lng,ht.lat),Ot=Bo(gt.x-ne.x,gt.y-ne.y,Ye),kt=l.MercatorCoordinate.fromLngLat(et);kt.y+=_r;const Lt=kt.toLngLat(),qt=x.project(Lt.lng,Lt.lat),$t=Bo(qt.x-ne.x,qt.y-ne.y,Ye),cn=Math.abs(Ot.x)/Math.abs($t.y),Wn=l.identity([]);l.rotateZ(Wn,Wn,-Ye*(1-(U?0:R)));const nn=l.identity([]);return l.scale(nn,nn,[1,1-(1-cn)*R,1]),nn[4]=-$t.x/$t.y*R,l.rotateZ(nn,nn,Ye),l.multiply(nn,Wn,nn),nn}(u.projection,0,u.center,a,n),y=ir(u);return l.scale(p,p,[y,y,1]),p}function ir(u){const n=u.projection,a=Kr(u.projection,u.zoom,u.width,u.height),p=so(n,u.center),y=so(n,l.LngLat.convert(n.center));return Math.pow(2,p*a+(1-a)*y)}function Kr(u,n,a,p,y=1/0){const x=u.range;if(!x)return 0;const D=Math.min(y,Math.max(a,p)),I=Math.log(D/1024)/Math.LN2;return l.smoothstep(x[0]+I,x[1]+I,n)}const _r=1/4e4;function so(u,n){const a=l.clamp(n.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=new l.LngLat(n.lng-180*_r,a),y=new l.LngLat(n.lng+180*_r,a),x=u.project(p.lng,a),D=u.project(y.lng,a),I=l.MercatorCoordinate.fromLngLat(p),R=l.MercatorCoordinate.fromLngLat(y),U=D.x-x.x,z=D.y-x.y,Q=R.x-I.x,Se=R.y-I.y,je=Math.sqrt((Q*Q+Se*Se)/(U*U+z*z));return Math.log(je)/Math.LN2}function Bo(u,n,a){const p=Math.cos(a),y=Math.sin(a);return{x:u*p-n*y,y:u*y+n*p}}class ao{constructor(n,a,p,y,x,D,I){this.tileSize=512,this._renderWorldCopies=void 0===x||x,this._minZoom=n||0,this._maxZoom=a||22,this._minPitch=p??0,this._maxPitch=y??60,this.setProjection(D),this.setMaxBounds(I),this.width=0,this.height=0,this._center=new l.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new wt,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new Pr,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const n=new ao(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return n._elevation=this._elevation,n._centerAltitude=this._centerAltitude,n._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,n.tileSize=this.tileSize,n.mercatorFromTransition=this.mercatorFromTransition,n.width=this.width,n.height=this.height,n.cameraElevationReference=this.cameraElevationReference,n._center=this._center,n._setZoom(this.zoom),n._seaLevelZoom=this._seaLevelZoom,n.angle=this.angle,n._fov=this._fov,n._pitch=this._pitch,n._nearZ=this._nearZ,n._farZ=this._farZ,n._averageElevation=this._averageElevation,n._unmodified=this._unmodified,n._edgeInsets=this._edgeInsets.clone(),n._camera=this._camera.clone(),n._calcMatrices(),n.freezeTileCoverage=this.freezeTileCoverage,n.frustumCorners=this.frustumCorners,n}get elevation(){return this._elevation}set elevation(n){this._elevation!==n&&(this._elevation=n,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(n,a=!1){const p=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(null==this._seaLevelZoom||p)&&this._updateCameraOnTerrain(),(n||p)&&this._constrainCamera(a),this._calcMatrices()}getProjection(){return l.pick(this.projection,["name","center","parallels"])}setProjection(n){this.projectionOptions=n||{name:"mercator"};const a=this.projection?this.getProjection():void 0;this.projection=l.getProjection(this.projectionOptions);const p=!B(a,this.getProjection());return p&&this._calcMatrices(),this.mercatorFromTransition=!1,p}setMercatorFromTransition(){const n=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=l.getProjection({name:"mercator"});const a=n!==this.projection.name;return a&&this._calcMatrices(),a}get minZoom(){return this._minZoom}set minZoom(n){this._minZoom!==n&&(this._minZoom=n,this.zoom=Math.max(this.zoom,n))}get maxZoom(){return this._maxZoom}set maxZoom(n){this._maxZoom!==n&&(this._maxZoom=n,this.zoom=Math.min(this.zoom,n))}get minPitch(){return this._minPitch}set minPitch(n){this._minPitch!==n&&(this._minPitch=n,this.pitch=Math.max(this.pitch,n))}get maxPitch(){return this._maxPitch}set maxPitch(n){this._maxPitch!==n&&(this._maxPitch=n,this.pitch=Math.min(this.pitch,n))}get renderWorldCopies(){return this._renderWorldCopies&&!0===this.projection.supportsWorldCopies}set renderWorldCopies(n){void 0===n?n=!0:null===n&&(n=!1),this._renderWorldCopies=n}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get cameraWorldSize(){const n=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(n))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return l.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new l.Point(this.width,this.height)}get bearing(){return l.wrap(this.rotation,-180,180)}set bearing(n){this.rotation=n}get rotation(){return-this.angle/Math.PI*180}set rotation(n){const a=-n*Math.PI/180;var p,y,x,D,I,R,U,z,Q,Se;this.angle!==a&&(this._unmodified=!1,this.angle=a,this._calcMatrices(),this.rotationMatrix=(p=new l.ARRAY_TYPE(4),l.ARRAY_TYPE!=Float32Array&&(p[1]=0,p[2]=0),p[0]=1,p[3]=1,p),y=this.rotationMatrix,D=this.angle,I=(x=this.rotationMatrix)[0],R=x[1],U=x[2],z=x[3],Q=Math.sin(D),Se=Math.cos(D),y[0]=I*Se+U*Q,y[1]=R*Se+z*Q,y[2]=I*-Q+U*Se,y[3]=R*-Q+z*Se)}get pitch(){return this._pitch/Math.PI*180}set pitch(n){const a=l.clamp(n,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==a&&(this._unmodified=!1,this._pitch=a,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const n=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/n)}set fov(n){n=Math.max(.01,Math.min(60,n)),this._fov!==n&&(this._unmodified=!1,this._fov=l.degToRad(n),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(n){this._averageElevation=n,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(n){const a=Math.min(Math.max(n,this.minZoom),this.maxZoom);this._zoom!==a&&(this._unmodified=!1,this._setZoom(a),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(n){this._zoom=n,this.scale=this.zoomScale(n),this.tileZoom=Math.floor(n),this.zoomFraction=n-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const n=this._elevation;this._centerAltitude=n.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=n.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){void 0!==this._centerAltitudeValidForExaggeration&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const n=this._elevation,a=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],p=this.horizonLineFromTop();let y=0,x=0;for(let D=0;D<a.length;D++){const I=new l.Point(a[D][0]*this.width,p+a[D][1]*(this.height-p)),R=n.pointCoordinate(I);if(!R)continue;const U=1/Math.hypot(R[0]-this._camera.position[0],R[1]-this._camera.position[1]);y+=R[3]*U,x+=U}return 0===x?NaN:y/x}get center(){return this._center}set center(n){n.lat===this._center.lat&&n.lng===this._center.lng||(this._unmodified=!1,this._center=n,this._terrainEnabled()&&("ground"===this.cameraElevationReference?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(null==this._seaLevelZoom||!this._elevation)return;const n=this._seaLevelZoom,a=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),p=this.pixelsPerMeter/this.worldSize*a,y=this._mercatorZfromZoom(n),x=this._mercatorZfromZoom(this._maxZoom),D=Math.max(y-p,x);this._setZoom(this._zoomFromMercatorZ(D))}get padding(){return this._edgeInsets.toJSON()}set padding(n){this._edgeInsets.equals(n)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,n,1),this._calcMatrices())}computeZoomRelativeTo(n){const a=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,n.toAltitude()));let p;p=n.z<this._camera.position[2]?[a.x,a.y,a.z]:[n.x,n.y,n.z];const y=l.length(l.sub([],this._camera.position,p));return l.clamp(this._zoomFromMercatorZ(y),this._minZoom,this._maxZoom)}setFreeCameraOptions(n){if(!this.height||!n.position&&!n.orientation)return;this._updateCameraState();let a=!1;if(n.orientation&&!l.exactEquals(n.orientation,this._camera.orientation)&&(a=this._setCameraOrientation(n.orientation)),n.position){const p=[n.position.x,n.position.y,n.position.z];l.exactEquals$1(p,this._camera.position)||(this._setCameraPosition(p),a=!0)}a&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const n=this._camera.position,a=new Jr;return a.position=new l.MercatorCoordinate(n[0],n[1],n[2]),a.orientation=this._camera.orientation,a._elevation=this.elevation,a._renderWorldCopies=this.renderWorldCopies,a}_setCameraOrientation(n){if(!l.length$1(n))return!1;l.normalize$1(n,n);const a=l.transformQuat([],[0,0,-1],n),p=l.transformQuat([],[0,-1,0],n);if(p[2]<0)return!1;const y=xi(a,p);return!!y&&(this._camera.orientation=y,!0)}_setCameraPosition(n){const a=this.zoomScale(this.minZoom)*this.tileSize,p=this.zoomScale(this.maxZoom)*this.tileSize,y=this.cameraToCenterDistance;n[2]=l.clamp(n[2],y/p,y/a),this._camera.position=n}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(n){return this._edgeInsets.equals(n)}interpolatePadding(n,a,p){this._unmodified=!1,this._edgeInsets.interpolate(n,a,p),this._constrain(),this._calcMatrices()}coveringZoomLevel(n){const a=(n.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/n.tileSize));return Math.max(0,a)}getVisibleUnwrappedCoordinates(n){const a=[new l.UnwrappedTileID(0,n)];if(this.renderWorldCopies){const p=this.pointCoordinate(new l.Point(0,0)),y=this.pointCoordinate(new l.Point(this.width,0)),x=this.pointCoordinate(new l.Point(this.width,this.height)),D=this.pointCoordinate(new l.Point(0,this.height)),I=Math.floor(Math.min(p.x,y.x,x.x,D.x)),R=Math.floor(Math.max(p.x,y.x,x.x,D.x)),U=1;for(let z=I-U;z<=R+U;z++)0!==z&&a.push(new l.UnwrappedTileID(z,n))}return a}coveringTiles(n){let a=this.coveringZoomLevel(n);const p=a,y=this.elevation&&!n.isTerrainDEM,x="mercator"===this.projection.name;if(void 0!==n.minzoom&&a<n.minzoom)return[];void 0!==n.maxzoom&&a>n.maxzoom&&(a=n.maxzoom);const D=this.locationCoordinate(this.center),I=this.center.lat,R=1<<a,U=[R*D.x,R*D.y,0],z="globe"===this.projection.name,Q=!z,Se=l.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,a,Q),je=z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),Ye=R*l.mercatorZfromAltitude(1,this.center.lat),$e=this._camera.position[2]/l.mercatorZfromAltitude(1,this.center.lat),et=[R*je.x,R*je.y,$e*(Q?1:Ye)],ne=this.cameraToCenterDistance/n.tileSize*(n.roundZoom?1:.502),He=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?a:0,ht=n.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,gt=n.isTerrainDEM?-ht:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ot=this.projection.isReprojectedInTileSpace?ir(this):1,kt=sn=>{const Zn=new l.MercatorCoordinate(sn.x+25e-6,sn.y,sn.z),kn=new l.MercatorCoordinate(sn.x,sn.y+25e-6,sn.z),ti=sn.toLngLat(),Ii=Zn.toLngLat(),$i=kn.toLngLat(),mi=this.locationCoordinate(ti),Oi=this.locationCoordinate(Ii),cr=this.locationCoordinate($i),lr=Math.hypot(Oi.x-mi.x,Oi.y-mi.y),Ci=Math.hypot(cr.x-mi.x,cr.y-mi.y);return Math.sqrt(lr*Ci)*Ot/25e-6},Lt=sn=>{const An=ht,Zn=gt;return{aabb:l.tileAABB(this,R,0,0,0,sn,Zn,An,this.projection),zoom:0,x:0,y:0,minZ:Zn,maxZ:An,wrap:sn,fullyVisible:!1}},qt=[];let $t=[];const cn=a,Wn=n.reparseOverscaled?p:a,nn=sn=>sn*sn,Mn=nn(($e-this._centerAltitude)*Ye),pn=sn=>{if(!this._elevation||!sn.tileID||!x)return;const An=this._elevation.getMinMaxForTile(sn.tileID),Zn=sn.aabb;An?(Zn.min[2]=An.min,Zn.max[2]=An.max,Zn.center[2]=(Zn.min[2]+Zn.max[2])/2):(sn.shouldSplit=qn(sn),sn.shouldSplit||(Zn.min[2]=Zn.max[2]=Zn.center[2]=this._centerAltitude))},qn=sn=>{if(sn.zoom<He)return!0;if(sn.zoom===cn)return!1;if(null!=sn.shouldSplit)return sn.shouldSplit;const An=sn.aabb.distanceX(et),Zn=sn.aabb.distanceY(et);let kn=Mn,ti=1;if(z){kn=nn(sn.aabb.distanceZ(et));const mi=Math.pow(2,sn.zoom),Oi=l.latFromMercatorY((sn.y+1)/mi),cr=l.latFromMercatorY(sn.y/mi),lr=Math.min(Math.max(I,Oi),cr),Ci=l.circumferenceAtLatitude(lr)/l.circumferenceAtLatitude(I);if(ti=lr===I?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Ci/this._mercatorScaleRatio),this.zoom<=l.GLOBE_ZOOM_THRESHOLD_MIN&&sn.zoom===cn-1&&Ci>=.9)return!0}else if(y&&(kn=nn(sn.aabb.distanceZ(et)*Ye)),this.projection.isReprojectedInTileSpace&&p<=5){const mi=Math.pow(2,sn.zoom),Oi=kt(new l.MercatorCoordinate((sn.x+.5)/mi,(sn.y+.5)/mi));ti=Oi>.85?1:Oi}const Ii=An*An+Zn*Zn+kn;return Ii<nn((1<<cn-sn.zoom)*ne*ti*((mi,Oi)=>{if(Oi*nn(.707)<mi)return 1;const cr=Math.sqrt(Oi/mi);return cr/(1.4144271570014144+(Math.pow(1.1,cr-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(kn,Mn),Ii))};if(this.renderWorldCopies)for(let sn=1;sn<=3;sn++)qt.push(Lt(-sn)),qt.push(Lt(sn));for(qt.push(Lt(0));qt.length>0;){const sn=qt.pop(),An=sn.x,Zn=sn.y;let kn=sn.fullyVisible;if(!kn){const ti=sn.aabb.intersects(Se);if(0===ti)continue;kn=2===ti}if(sn.zoom!==cn&&qn(sn))for(let ti=0;ti<4;ti++){const Ii=(An<<1)+ti%2,$i=(Zn<<1)+(ti>>1),mi={aabb:x?sn.aabb.quadrant(ti):l.tileAABB(this,R,sn.zoom+1,Ii,$i,sn.wrap,sn.minZ,sn.maxZ,this.projection),zoom:sn.zoom+1,x:Ii,y:$i,wrap:sn.wrap,fullyVisible:kn,tileID:void 0,shouldSplit:void 0,minZ:sn.minZ,maxZ:sn.maxZ};y&&!z&&(mi.tileID=new l.OverscaledTileID(sn.zoom+1===cn?Wn:sn.zoom+1,sn.wrap,sn.zoom+1,Ii,$i),pn(mi)),qt.push(mi)}else{const ti=sn.zoom===cn?Wn:sn.zoom;if(n.minzoom&&n.minzoom>ti)continue;const Ii=U[0]-(.5+An+(sn.wrap<<sn.zoom))*(1<<a-sn.zoom),$i=U[1]-.5-Zn,mi=sn.tileID?sn.tileID:new l.OverscaledTileID(ti,sn.wrap,sn.zoom,An,Zn);$t.push({tileID:mi,distanceSq:Ii*Ii+$i*$i})}}if(this.fogCullDistSq){const sn=this.fogCullDistSq,An=this.horizonLineFromTop();$t=$t.filter(Zn=>{const kn=[0,0,0,1],ti=[l.EXTENT,l.EXTENT,0,1],Ii=this.calculateFogTileMatrix(Zn.tileID.toUnwrapped());l.transformMat4$1(kn,kn,Ii),l.transformMat4$1(ti,ti,Ii);const $i=l.getAABBPointSquareDist(kn,ti);if(0===$i)return!0;let mi=!1;const Oi=this._elevation;if(Oi&&$i>sn&&0!==An){const cr=this.calculateProjMatrix(Zn.tileID.toUnwrapped());let lr;n.isTerrainDEM||(lr=Oi.getMinMaxForTile(Zn.tileID)),lr||(lr={min:gt,max:ht});const Ci=l.furthestTileCorner(this.rotation),br=[Ci[0]*l.EXTENT,Ci[1]*l.EXTENT,lr.max];l.transformMat4(br,br,cr),mi=(1-br[1])*this.height*.5<An}return $i<sn||mi})}return $t.sort((sn,An)=>sn.distanceSq-An.distanceSq).map(sn=>sn.tileID)}resize(n,a){this.width=n,this.height=a,this.pixelsToGLUnits=[2/n,-2/a],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(n){return Math.pow(2,n)}scaleZoom(n){return Math.log(n)/Math.LN2}project(n){const a=l.clamp(n.lat,-l.MAX_MERCATOR_LATITUDE,l.MAX_MERCATOR_LATITUDE),p=this.projection.project(n.lng,a);return new l.Point(p.x*this.worldSize,p.y*this.worldSize)}unproject(n){return this.projection.unproject(n.x/this.worldSize,n.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/l.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(n,a){let p,y;const x=this.centerPoint;if("globe"===this.projection.name){const I=this.worldSize;p=(a.x-x.x)/I,y=(a.y-x.y)/I}else{const I=this.pointCoordinate(a),R=this.pointCoordinate(x);p=I.x-R.x,y=I.y-R.y}const D=this.locationCoordinate(n);this.setLocation(new l.MercatorCoordinate(D.x-p,D.y-y))}setLocation(n){this.center=this.coordinateLocation(n),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(n){return this.projection.locationPoint(this,n)}locationPoint3D(n){return this.projection.locationPoint(this,n,!0)}pointLocation(n){return this.coordinateLocation(this.pointCoordinate(n))}pointLocation3D(n){return this.coordinateLocation(this.pointCoordinate3D(n))}locationCoordinate(n,a){const p=a?l.mercatorZfromAltitude(a,n.lat):void 0,y=this.projection.project(n.lng,n.lat);return new l.MercatorCoordinate(y.x,y.y,p)}coordinateLocation(n){return this.projection.unproject(n.x,n.y)}pointRayIntersection(n,a){const p=a??this._centerAltitude,y=[n.x,n.y,0,1],x=[n.x,n.y,1,1];l.transformMat4$1(y,y,this.pixelMatrixInverse),l.transformMat4$1(x,x,this.pixelMatrixInverse);const D=x[3];l.scale$1(y,y,1/y[3]),l.scale$1(x,x,1/D);const I=y[2],R=x[2];return{p0:y,p1:x,t:I===R?0:(p-I)/(R-I)}}screenPointToMercatorRay(n){const a=[n.x,n.y,0,1],p=[n.x,n.y,1,1];return l.transformMat4$1(a,a,this.pixelMatrixInverse),l.transformMat4$1(p,p,this.pixelMatrixInverse),l.scale$1(a,a,1/a[3]),l.scale$1(p,p,1/p[3]),a[2]=l.mercatorZfromAltitude(a[2],this._center.lat)*this.worldSize,p[2]=l.mercatorZfromAltitude(p[2],this._center.lat)*this.worldSize,l.scale$1(a,a,1/this.worldSize),l.scale$1(p,p,1/this.worldSize),new l.Ray([a[0],a[1],a[2]],l.normalize([],l.sub([],p,a)))}rayIntersectionCoordinate(n){const{p0:a,p1:p,t:y}=n,x=l.mercatorZfromAltitude(a[2],this._center.lat),D=l.mercatorZfromAltitude(p[2],this._center.lat);return new l.MercatorCoordinate(l.number(a[0],p[0],y)/this.worldSize,l.number(a[1],p[1],y)/this.worldSize,l.number(x,D,y))}pointCoordinate(n,a=this._centerAltitude){return this.projection.pointCoordinate(this,n.x,n.y,a)}pointCoordinate3D(n){if(!this.elevation)return this.pointCoordinate(n);let a=this.projection.pointCoordinate3D(this,n.x,n.y);if(a)return new l.MercatorCoordinate(a[0],a[1],a[2]);let p=0,y=this.horizonLineFromTop();if(n.y>y)return this.pointCoordinate(n);const x=.02*y,D=n.clone();for(let I=0;I<10&&y-p>x;I++){D.y=l.number(p,y,.66);const R=this.projection.pointCoordinate3D(this,D.x,D.y);R?(y=D.y,a=R):p=D.y}return a?new l.MercatorCoordinate(a[0],a[1],a[2]):this.pointCoordinate(n)}isPointAboveHorizon(n){return this.projection.isPointAboveHorizon(this,n)}isPointOnSurface(n){if(n.y<0||n.y>this.height||n.x<0||n.x>this.width)return!1;if(this.elevation||this.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(n);const a=this.pointCoordinate(n);return a.y>=0&&a.y<=1}_coordinatePoint(n,a){const p=a&&this.elevation?this.elevation.getAtPointOrZero(n,this._centerAltitude):this._centerAltitude,y=[n.x*this.worldSize,n.y*this.worldSize,p+n.toAltitude(),1];return l.transformMat4$1(y,y,this.pixelMatrix),y[3]>0?new l.Point(y[0]/y[3],y[1]/y[3]):new l.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:n,left:a}=this._edgeInsets,p=this.height-this._edgeInsets.bottom,y=this.width-this._edgeInsets.right,x=this.pointLocation3D(new l.Point(a,n)),D=this.pointLocation3D(new l.Point(y,n)),I=this.pointLocation3D(new l.Point(y,p)),R=this.pointLocation3D(new l.Point(a,p));let U=Math.min(x.lng,D.lng,I.lng,R.lng),z=Math.max(x.lng,D.lng,I.lng,R.lng),Q=Math.min(x.lat,D.lat,I.lat,R.lat),Se=Math.max(x.lat,D.lat,I.lat,R.lat);const je=Math.pow(2,-this.zoom)/16*270,Ye="globe"===this.projection.name?1:4,$e=(et,ne,He,ht,gt)=>{const Ot=(et+He)/2,kt=(ne+ht)/2,Lt=new l.Point(Ot,kt),{lng:qt,lat:$t}=this.pointLocation3D(Lt),cn=Math.max(0,U-qt,Q-$t,qt-z,$t-Se);U=Math.min(U,qt),z=Math.max(z,qt),Q=Math.min(Q,$t),Se=Math.max(Se,$t),(gt<Ye||cn>je)&&($e(et,ne,Ot,kt,gt+1),$e(Ot,kt,He,ht,gt+1))};if($e(a,n,y,n,1),$e(y,n,y,p,1),$e(y,p,a,p,1),$e(a,p,a,n,1),"globe"===this.projection.name){const[et,ne]=l.polesInViewport(this);et?(Se=90,z=180,U=-180):ne&&(Q=-90,z=180,U=-180)}return new l.LngLatBounds(new l.LngLat(U,Q),new l.LngLat(z,Se))}_getBoundsRectangular(n,a){const{top:p,left:y}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,D=this.width-this._edgeInsets.right,I=new l.Point(y,p),R=new l.Point(D,p),U=new l.Point(D,x),z=new l.Point(y,x);let Q=this.pointCoordinate(I,n),Se=this.pointCoordinate(R,n);const je=this.pointCoordinate(U,a),Ye=this.pointCoordinate(z,a),$e=(et,ne)=>(ne.y-et.y)/(ne.x-et.x);return Q.y>1&&Se.y>=0?Q=new l.MercatorCoordinate((1-Ye.y)/$e(Ye,Q)+Ye.x,1):Q.y<0&&Se.y<=1&&(Q=new l.MercatorCoordinate(-Ye.y/$e(Ye,Q)+Ye.x,0)),Se.y>1&&Q.y>=0?Se=new l.MercatorCoordinate((1-je.y)/$e(je,Se)+je.x,1):Se.y<0&&Q.y<=1&&(Se=new l.MercatorCoordinate(-je.y/$e(je,Se)+je.x,0)),(new l.LngLatBounds).extend(this.coordinateLocation(Q)).extend(this.coordinateLocation(Se)).extend(this.coordinateLocation(Ye)).extend(this.coordinateLocation(je))}_getBoundsRectangularTerrain(){const n=this.elevation;if(!n.visibleDemTiles.length||n.isUsingMockSource())return this._getBoundsRectangular(0,0);const a=n.visibleDemTiles.reduce((p,y)=>{if(y.dem){const x=y.dem.tree;p.min=Math.min(p.min,x.minimums[0]),p.max=Math.max(p.max,x.maximums[0])}return p},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(a.min*n.exaggeration(),a.max*n.exaggeration())}getBounds(){return"mercator"===this.projection.name||"equirectangular"===this.projection.name?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(n=!0){const a=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,p=this.height/2-a*(1-this._horizonShift);return n?Math.max(0,p):p}getMaxBounds(){return this.maxBounds}setMaxBounds(n){this.maxBounds=n,this.minLat=-l.MAX_MERCATOR_LATITUDE,this.maxLat=l.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,n&&(this.minLat=n.getSouth(),this.maxLat=n.getNorth(),this.minLng=n.getWest(),this.maxLng=n.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=l.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=l.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=l.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=l.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(n,a){return this.projection.createTileMatrix(this,a,n)}calculateDistanceTileData(n){const a=n.key,p=this._distanceTileDataCache;if(p[a])return p[a];const y=n.canonical,x=1/this.height,D=this.cameraWorldSize,I=D/this.zoomScale(y.z),R=(y.x+Math.pow(2,y.z)*n.wrap)*I,U=y.y*I,z=this.point;z.x*=D/this.worldSize,z.y*=D/this.worldSize;const Q=this.angle,Se=Math.sin(-Q),je=-Math.cos(-Q);return p[a]={bearing:[Se,je],center:[(z.x-R)*x,(z.y-U)*x],scale:I/l.EXTENT*x},p[a]}calculateFogTileMatrix(n){const a=n.key,p=this._fogTileMatrixCache;if(p[a])return p[a];const y=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,n);return l.multiply(y,this.worldToFogMatrix,y),p[a]=new Float32Array(y),p[a]}calculateProjMatrix(n,a=!1){const p=n.key,y=a?this._alignedProjMatrixCache:this._projMatrixCache;if(y[p])return y[p];const x=this.calculatePosMatrix(n,this.worldSize);return l.multiply(x,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:a?this.alignedProjMatrix:this.projMatrix,x),y[p]=new Float32Array(x),y[p]}calculatePixelsToTileUnitsMatrix(n){const a=n.tileID.key,p=this._pixelsToTileUnitsCache;if(p[a])return p[a];const y=function(x,D){const{scale:I}=x.tileTransform,R=I*l.EXTENT/(x.tileSize*Math.pow(2,D.zoom-x.tileID.overscaledZ+x.tileID.canonical.z));return U=new Float32Array(4),Se=(z=D.inverseAdjustmentMatrix)[1],je=z[2],Ye=z[3],et=(Q=[R,R])[1],U[0]=z[0]*($e=Q[0]),U[1]=Se*$e,U[2]=je*et,U[3]=Ye*et,U;var U,z,Q,Se,je,Ye,$e,et}(n,this);return p[a]=y,p[a]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if("globe"===this.projection.name){const n=1/this.worldSize,a=l.fromScaling([],[n,n,n]);return l.multiply(a,a,this.globeMatrix),a}}recenterOnTerrain(){if(!this._elevation||"globe"===this.projection.name)return;const n=this._elevation;this._updateCameraState();const a=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,p=this._computeCameraPosition(a),y=this._camera.forward(),x=l.mercatorZfromAltitude(1,this._center.lat);p[2]/=x,y[2]/=x,l.normalize(y,y);const D=n.raycast(p,y,n.exaggeration());if(D){const I=l.scaleAndAdd([],p,y,D),R=new l.MercatorCoordinate(I[0],I[1],l.mercatorZfromAltitude(I[2],l.latFromMercatorY(I[1]))),U=(R.z+l.length([R.x-p[0],R.y-p[1],R.z-p[2]*x]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(U),this._centerAltitude=R.toAltitude(),this._center=this.coordinateLocation(R),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(n=!1){if(!this._elevation)return;const a=this._elevation,p=l.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(p),x=a.getAtPointOrZero(new l.MercatorCoordinate(...y)),D=this.pixelsPerMeter/this.worldSize*x,I=this._minimumHeightOverTerrain(),R=y[2]-D;if(R<=I)if(R<0||n){const U=this.locationCoordinate(this._center,this._centerAltitude),z=[y[0],y[1],U.z-y[2]],Q=l.length(z);z[2]-=(I-R)/this._pixelsPerMercatorPixel;const Se=l.length(z);if(0===Se)return;l.scale$2(z,z,Q/Se*this._pixelsPerMercatorPixel),this._camera.position=[y[0],y[1],U.z*this._pixelsPerMercatorPixel-z[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const n="globe"===this.projection.name||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||n){const Se=this.center;return Se.lat=l.clamp(Se.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!n)&&(Se.lng=l.clamp(Se.lng,this.minLng,this.maxLng)),this.center=Se,void(this._constraining=!1)}const a=this._unmodified,{x:p,y}=this.point;let x=0,D=p,I=y;const R=this.width/2,U=this.height/2,z=this.worldMinY*this.scale,Q=this.worldMaxY*this.scale;if(y-U<z&&(I=z+U),y+U>Q&&(I=Q-U),Q-z<this.height&&(x=Math.max(x,this.height/(Q-z)),I=(Q+z)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const Se=this.worldMinX*this.scale,je=this.worldMaxX*this.scale,Ye=this.worldSize/2-(Se+je)/2;D=(p+Ye+this.worldSize)%this.worldSize-Ye,D-R<Se&&(D=Se+R),D+R>je&&(D=je-R),je-Se<this.width&&(x=Math.max(x,this.width/(je-Se)),D=(je+Se)/2)}D===p&&I===y||(this.center=this.unproject(new l.Point(D,I))),x&&(this.zoom+=this.scaleZoom(x)),this._constrainCamera(),this._unmodified=a,this._constraining=!1}_minZoomForBounds(){let n=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(n=Math.max(n,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),n}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const n=this.centerOffset,a=this.pixelsPerMeter;"globe"===this.projection.name&&(this._mercatorScaleRatio=l.mercatorZfromAltitude(1,this.center.lat)/l.mercatorZfromAltitude(1,l.GLOBE_SCALE_MATCH_LATITUDE));const p=Kr(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,p),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const y="meters"===this.projection.zAxisUnit?a:1,x=this._camera.getWorldToCamera(this.worldSize,y),D=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);D[8]=2*-n.x/this.width,D[9]=2*n.y/this.height;let I=l.mul([],D,x);if(this.projection.isReprojectedInTileSpace){const kt=this.locationCoordinate(this.center),Lt=l.identity([]);l.translate(Lt,Lt,[kt.x*this.worldSize,kt.y*this.worldSize,0]),l.multiply(Lt,Lt,xr(this)),l.translate(Lt,Lt,[-kt.x*this.worldSize,-kt.y*this.worldSize,0]),l.multiply(I,I,Lt),this.inverseAdjustmentMatrix=function(qt){const $t=xr(qt,!0);return ye([],[$t[0],$t[1],$t[4],$t[5]])}(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=l.scale([],I,[this.worldSize,this.worldSize,this.worldSize/y,1]),this.projMatrix=I,this.invProjMatrix=l.invert(new Float64Array(16),this.projMatrix);const R=l.invert([],D);this.frustumCorners=l.FrustumCorners.fromInvProjectionMatrix(R,this.horizonLineFromTop(),this.height);const U=new Float32Array(16);l.identity(U),l.scale(U,U,[1,-1,1]),l.rotateX(U,U,this._pitch),l.rotateZ(U,U,this.angle);const z=l.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),Q=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;z[8]=2*-n.x/this.width,z[9]=2*(n.y+Q)/this.height,this.skyboxMatrix=l.multiply(U,z,U);const Se=this.point,je=Se.x,Ye=Se.y,$e=this.width%2/2,et=this.height%2/2,ne=Math.cos(this.angle),He=Math.sin(this.angle),ht=je-Math.round(je)+ne*$e+He*et,gt=Ye-Math.round(Ye)+ne*et+He*$e,Ot=new Float64Array(I);if(l.translate(Ot,Ot,[ht>.5?ht-1:ht,gt>.5?gt-1:gt,0]),this.alignedProjMatrix=Ot,I=l.create(),l.scale(I,I,[this.width/2,-this.height/2,1]),l.translate(I,I,[1,-1,0]),this.labelPlaneMatrix=I,I=l.create(),l.scale(I,I,[1,-1,1]),l.translate(I,I,[-1,-1,0]),l.scale(I,I,[2/this.width,2/this.height,1]),this.glCoordMatrix=I,this.pixelMatrix=l.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},I=l.invert(new Float64Array(16),this.pixelMatrix),!I)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=I,"globe"===this.projection.name||this.mercatorFromTransition){this.globeMatrix=l.calculateGlobeMatrix(this);const kt=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=l.transformMat4(kt,kt,x),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=I;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const n=this.cameraWorldSizeForFog,a=this.cameraPixelsPerMeter,p=this._camera.position,y=1/this.height/this._pixelsPerMercatorPixel,x=[n,n,a];l.scale$2(x,x,y),l.scale$2(p,p,-1),l.multiply$2(p,p,x);const D=l.create();l.translate(D,D,p),l.scale(D,D,x),this.mercatorFogMatrix=D,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(n,a,y)}_computeCameraPosition(n){const a=(n=n||this.pixelsPerMeter)/this.pixelsPerMeter,p=this._camera.forward(),y=this.point,x=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*a-n/this.worldSize*this._centerAltitude;return[y.x/this.worldSize-p[0]*x,y.y/this.worldSize-p[1]*x,n/this.worldSize*this._centerAltitude-p[2]*x]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(n){const a=this._maxCameraBoundsDistance()*Math.cos(this._pitch),p=this._camera.position[2],y=n[2];let x=1;this.projection.wrap&&(this.center=this.center.wrap()),y>0&&(x=Math.min((a-p)/y,1)),this._camera.position=l.scaleAndAdd([],this._camera.position,n,x),this._updateStateFromCamera()}_updateStateFromCamera(){const n=this._camera.position,a=this._camera.forward(),{pitch:p,bearing:y}=this._camera.getPitchBearing(),x=l.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,D=this._mercatorZfromZoom(this._maxZoom)*Math.cos(l.degToRad(this._maxPitch)),I=Math.max((n[2]-x)/Math.cos(p),D),R=this._zoomFromMercatorZ(I);l.scaleAndAdd(n,n,a,I),this._pitch=l.clamp(p,l.degToRad(this.minPitch),l.degToRad(this.maxPitch)),this.angle=l.wrap(y,-Math.PI,Math.PI),this._setZoom(l.clamp(R,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new l.MercatorCoordinate(n[0],n[1],n[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(n){return Math.pow(2,n)*this.tileSize}_mercatorZfromZoom(n){return this.cameraToCenterDistance/this._worldSizeFromZoom(n)}_minimumHeightOverTerrain(){const n=Math.min((null!=this._seaLevelZoom?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(n)}_zoomFromMercatorZ(n){return this.scaleZoom(this.cameraToCenterDistance/(n*this.tileSize))}zoomFromMercatorZAdjusted(n){let a=0,p=l.GLOBE_ZOOM_THRESHOLD_MAX,y=0,x=1/0;for(;p-a>1e-6&&p>a;){const D=a+.5*(p-a),I=this.tileSize*Math.pow(2,D),R=this.getCameraToCenterDistance(this.projection,D,I),U=this.scaleZoom(R/(n*this.tileSize)),z=Math.abs(D-U);z<x&&(x=z,y=D),D<U?a=D:p=D}return y}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(l.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(n,a){const p=Math.min(n.x,a.x),y=Math.max(n.x,a.x),x=Math.min(n.y,a.y),D=Math.max(n.y,a.y);if(x<this.horizonLineFromTop(!1))return!0;if("mercator"!==this.projection.name)return!1;const I=[new l.Point(p,x),new l.Point(y,D),new l.Point(p,D),new l.Point(y,x)],R=this.renderWorldCopies?-3:0,U=this.renderWorldCopies?4:1;for(const z of I){const Q=this.pointRayIntersection(z);if(Q.t<0)return!0;const Se=this.rayIntersectionCoordinate(Q);if(Se.x<R||Se.y<0||Se.x>U||Se.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+l.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new l.Point(0,0),new l.Point(this.width,this.height))}zoomDeltaToMovement(n,a){const p=l.length(l.sub([],this._camera.position,n)),y=this._zoomFromMercatorZ(p)+a;return p-this._mercatorZfromZoom(y)}getCameraPoint(){if("globe"===this.projection.name){const n=function([a,p,y],x){const D=[a,p,y,1];l.transformMat4$1(D,D,x);const I=D[3]=Math.max(D[3],1e-6);return D[0]/=I,D[1]/=I,D[2]/=I,D}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new l.Point(n[0],n[1])}{const n=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new l.Point(0,n))}}getCameraToCenterDistance(n,a=this.zoom,p=this.worldSize){const y=Kr(n,a,this.width,this.height,1024),x=n.pixelSpaceConversion(this.center.lat,p,y);return.5/Math.tan(.5*this._fov)*this.height*x}getWorldToCameraMatrix(){const n=this._camera.getWorldToCamera(this.worldSize,"meters"===this.projection.zAxisUnit?this.pixelsPerMeter:1);return"globe"===this.projection.name&&l.multiply(n,n,this.globeMatrix),n}}function Es(u,n){let a=!1,p=null;const y=()=>{p=null,a&&(u(),p=setTimeout(y,n),a=!1)};return()=>(a=!0,p||y(),p)}class Ts{constructor(n){this._hashName=n&&encodeURIComponent(n),l.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=Es(this._updateHashUnthrottled.bind(this),300)}addTo(n){return this._map=n,l.window.addEventListener("hashchange",this._onHashChange,!1),n.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),l.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const n=this._map;if(!n)return"";const a=Zo(n);if(this._hashName){const p=this._hashName;let y=!1;const x=l.window.location.hash.slice(1).split("&").map(D=>{const I=D.split("=")[0];return I===p?(y=!0,`${I}=${a}`):D}).filter(D=>D);return y||x.push(`${p}=${a}`),`#${x.join("&")}`}return`#${a}`}_getCurrentHash(){const n=l.window.location.hash.replace("#","");if(this._hashName){let a;return n.split("&").map(p=>p.split("=")).forEach(p=>{p[0]===this._hashName&&(a=p)}),(a&&a[1]||"").split("/")}return n.split("/")}_onHashChange(){const n=this._map;if(!n)return!1;const a=this._getCurrentHash();if(a.length>=3&&!a.some(p=>isNaN(p))){const p=n.dragRotate.isEnabled()&&n.touchZoomRotate.isEnabled()?+(a[3]||0):n.getBearing();return n.jumpTo({center:[+a[2],+a[1]],zoom:+a[0],bearing:p,pitch:+(a[4]||0)}),!0}return!1}_updateHashUnthrottled(){const n=l.window.location.href.replace(/(#.+)?$/,this.getHashString());l.window.history.replaceState(l.window.history.state,null,n)}}function Zo(u,n){const a=u.getCenter(),p=Math.round(100*u.getZoom())/100,y=Math.ceil((p*Math.LN2+Math.log(512/360/.5))/Math.LN10),x=Math.pow(10,y),D=Math.round(a.lng*x)/x,I=Math.round(a.lat*x)/x,R=u.getBearing(),U=u.getPitch();let z=n?`/${D}/${I}/${p}`:`${p}/${I}/${D}`;return(R||U)&&(z+="/"+Math.round(10*R)/10),U&&(z+=`/${Math.round(U)}`),z}const zo={linearity:.3,easing:l.bezier(0,0,.3,1)},ia=l.extend({deceleration:2500,maxSpeed:1400},zo),Da=l.extend({deceleration:20,maxSpeed:1400},zo),li=l.extend({deceleration:1e3,maxSpeed:360},zo),Ws=l.extend({deceleration:1e3,maxSpeed:90},zo);class Du{constructor(n){this._map=n,this.clear()}clear(){this._inertiaBuffer=[]}record(n){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:l.exported.now(),settings:n})}_drainInertiaBuffer(){const n=this._inertiaBuffer,a=l.exported.now();for(;n.length>0&&a-n[0].time>160;)n.shift()}_onMoveEnd(n){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const a={zoom:0,bearing:0,pitch:0,pan:new l.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:x}of this._inertiaBuffer)a.zoom+=x.zoomDelta||0,a.bearing+=x.bearingDelta||0,a.pitch+=x.pitchDelta||0,x.panDelta&&a.pan._add(x.panDelta),x.around&&(a.around=x.around),x.pinchAround&&(a.pinchAround=x.pinchAround);const p=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,y={};if(a.pan.mag()){const x=Jl(a.pan.mag(),p,l.extend({},ia,n||{}));y.offset=a.pan.mult(x.amount/a.pan.mag()),y.center=this._map.transform.center,ga(y,x)}if(a.zoom){const x=Jl(a.zoom,p,Da);y.zoom=this._map.transform.zoom+x.amount,ga(y,x)}if(a.bearing){const x=Jl(a.bearing,p,li);y.bearing=this._map.transform.bearing+l.clamp(x.amount,-179,179),ga(y,x)}if(a.pitch){const x=Jl(a.pitch,p,Ws);y.pitch=this._map.transform.pitch+x.amount,ga(y,x)}if(y.zoom||y.bearing){const x=void 0===a.pinchAround?a.around:a.pinchAround;y.around=x?this._map.unproject(x):this._map.getCenter()}return this.clear(),y.noMoveStart=!0,y}}function ga(u,n){(!u.duration||u.duration<n.duration)&&(u.duration=n.duration,u.easing=n.easing)}function Jl(u,n,a){const{maxSpeed:p,linearity:y,deceleration:x}=a,D=l.clamp(u*y/(n/1e3),-p,p),I=Math.abs(D)/(x*y);return{easing:a.easing,duration:1e3*I,amount:D*(I/2)}}class Zr extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,p,y={}){const x=oe(a.getCanvasContainer(),p),D=a.unproject(x);super(n,l.extend({point:x,lngLat:D,originalEvent:p},y)),this._defaultPrevented=!1,this.target=a}}class Dl extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,p){const y="touchend"===n?p.changedTouches:p.touches,x=xe(a.getCanvasContainer(),y),D=x.map(R=>a.unproject(R)),I=x.reduce((R,U,z,Q)=>R.add(U.div(Q.length)),new l.Point(0,0));super(n,{points:x,point:I,lngLats:D,lngLat:a.unproject(I),originalEvent:p}),this._defaultPrevented=!1}}class Kl extends l.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(n,a,p){super(n,{originalEvent:p}),this._defaultPrevented=!1}}class Xl{constructor(n,a){this._map=n,this._clickTolerance=a.clickTolerance}reset(){this._mousedownPos=void 0}wheel(n){return this._firePreventable(new Kl(n.type,this._map,n))}mousedown(n,a){return this._mousedownPos=a,this._firePreventable(new Zr(n.type,this._map,n))}mouseup(n){this._map.fire(new Zr(n.type,this._map,n))}preclick(n){const a=l.extend({},n);a.type="preclick",this._map.fire(new Zr(a.type,this._map,a))}click(n,a){this._mousedownPos&&this._mousedownPos.dist(a)>=this._clickTolerance||(this.preclick(n),this._map.fire(new Zr(n.type,this._map,n)))}dblclick(n){return this._firePreventable(new Zr(n.type,this._map,n))}mouseover(n){this._map.fire(new Zr(n.type,this._map,n))}mouseout(n){this._map.fire(new Zr(n.type,this._map,n))}touchstart(n){return this._firePreventable(new Dl(n.type,this._map,n))}touchmove(n){this._map.fire(new Dl(n.type,this._map,n))}touchend(n){this._map.fire(new Dl(n.type,this._map,n))}touchcancel(n){this._map.fire(new Dl(n.type,this._map,n))}_firePreventable(n){if(this._map.fire(n),n.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class yc{constructor(n){this._map=n}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(n){this._map.fire(new Zr(n.type,this._map,n))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Zr("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(n){this._delayContextMenu?this._contextMenuEvent=n:this._map.fire(new Zr(n.type,this._map,n)),this._map.listens("contextmenu")&&n.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ql{constructor(n,a){this._map=n,this._el=n.getCanvasContainer(),this._container=n.getContainer(),this._clickTolerance=a.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(n,a){this.isEnabled()&&n.shiftKey&&0===n.button&&(Me(),this._startPos=this._lastPos=a,this._active=!0)}mousemoveWindow(n,a){if(!this._active)return;const p=a,y=this._startPos,x=this._lastPos;if(!y||!x||x.equals(p)||!this._box&&p.dist(y)<this._clickTolerance)return;this._lastPos=p,this._box||(this._box=fe("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",n));const D=Math.min(y.x,p.x),I=Math.max(y.x,p.x),R=Math.min(y.y,p.y),U=Math.max(y.y,p.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${D}px,${R}px)`,this._box.style.width=I-D+"px",this._box.style.height=U-R+"px")})}mouseupWindow(n,a){if(!this._active)return;const p=this._startPos,y=a;if(p&&0===n.button){if(this.reset(),Ce(),p.x!==y.x||p.y!==y.y)return this._map.fire(new l.Event("boxzoomend",{originalEvent:n})),{cameraAnimation:x=>x.fitScreenCoordinates(p,y,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",n)}}keydown(n){this._active&&27===n.keyCode&&(this.reset(),this._fireEvent("boxzoomcancel",n))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),de(),delete this._startPos,delete this._lastPos}_fireEvent(n,a){return this._map.fire(new l.Event(n,{originalEvent:a}))}}function Fr(u,n){const a={};for(let p=0;p<u.length;p++)a[u[p].identifier]=n[p];return a}class Ha{constructor(n){this.reset(),this.numTouches=n.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(n,a,p){(this.centroid||p.length>this.numTouches)&&(this.aborted=!0),this.aborted||(0===this.startTime&&(this.startTime=n.timeStamp),p.length===this.numTouches&&(this.centroid=function(y){const x=new l.Point(0,0);for(const D of y)x._add(D);return x.div(y.length)}(a),this.touches=Fr(p,a)))}touchmove(n,a,p){if(this.aborted||!this.centroid)return;const y=Fr(p,a);for(const x in this.touches){const D=y[x];(!D||D.dist(this.touches[x])>30)&&(this.aborted=!0)}}touchend(n,a,p){if((!this.centroid||n.timeStamp-this.startTime>500)&&(this.aborted=!0),0===p.length){const y=!this.aborted&&this.centroid;if(this.reset(),y)return y}}}class ll{constructor(n){this.singleTap=new Ha(n),this.numTaps=n.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(n,a,p){this.singleTap.touchstart(n,a,p)}touchmove(n,a,p){this.singleTap.touchmove(n,a,p)}touchend(n,a,p){const y=this.singleTap.touchend(n,a,p);if(y){const x=n.timeStamp-this.lastTime<500,D=!this.lastTap||this.lastTap.dist(y)<30;if(x&&D||this.reset(),this.count++,this.lastTime=n.timeStamp,this.lastTap=y,this.count===this.numTaps)return this.reset(),y}}}class ts{constructor(){this._zoomIn=new ll({numTouches:1,numTaps:2}),this._zoomOut=new ll({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(n,a,p){this._zoomIn.touchstart(n,a,p),this._zoomOut.touchstart(n,a,p)}touchmove(n,a,p){this._zoomIn.touchmove(n,a,p),this._zoomOut.touchmove(n,a,p)}touchend(n,a,p){const y=this._zoomIn.touchend(n,a,p),x=this._zoomOut.touchend(n,a,p);return y?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()+1,around:D.unproject(y)},{originalEvent:n})}):x?(this._active=!0,n.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:D=>D.easeTo({duration:300,zoom:D.getZoom()-1,around:D.unproject(x)},{originalEvent:n})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ds={0:1,2:2};class _a{constructor(n){this.reset(),this._clickTolerance=n.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(n,a){return!1}_move(n,a){return{}}mousedown(n,a){if(this._lastPoint)return;const p=Ie(n);this._correctButton(n,p)&&(this._lastPoint=a,this._eventButton=p)}mousemoveWindow(n,a){const p=this._lastPoint;if(p)if(n.preventDefault(),null!=this._eventButton&&function(y,x){const D=Ds[x];return void 0===y.buttons||(y.buttons&D)!==D}(n,this._eventButton))this.reset();else if(this._moved||!(a.dist(p)<this._clickTolerance))return this._moved=!0,this._lastPoint=a,this._move(p,a)}mouseupWindow(n){this._lastPoint&&Ie(n)===this._eventButton&&(this._moved&&Ce(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Wa extends _a{mousedown(n,a){super.mousedown(n,a),this._lastPoint&&(this._active=!0)}_correctButton(n,a){return 0===a&&!n.ctrlKey}_move(n,a){return{around:a,panDelta:a.sub(n)}}}class Lo extends _a{_correctButton(n,a){return 0===a&&n.ctrlKey||2===a}_move(n,a){const p=.8*(a.x-n.x);if(p)return this._active=!0,{bearingDelta:p}}contextmenu(n){n.preventDefault()}}class Gc extends _a{_correctButton(n,a){return 0===a&&n.ctrlKey||2===a}_move(n,a){const p=-.5*(a.y-n.y);if(p)return this._active=!0,{pitchDelta:p}}contextmenu(n){n.preventDefault()}}class Il{constructor(n,a){this._map=n,this._el=n.getCanvasContainer(),this._minTouches=1,this._clickTolerance=a.clickTolerance||1,this.reset(),l.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new l.Point(0,0)}touchstart(n,a,p){return this._calculateTransform(n,a,p)}touchmove(n,a,p){if(this._active&&!(p.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(1===p.length&&!l.isFullscreen())return void this._showTouchPanBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return n.cancelable&&n.preventDefault(),this._calculateTransform(n,a,p)}}touchend(n,a,p){this._calculateTransform(n,a,p),this._active&&p.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(n,a,p){p.length>0&&(this._active=!0);const y=Fr(p,a),x=new l.Point(0,0),D=new l.Point(0,0);let I=0;for(const U in y){const z=y[U],Q=this._touches[U];Q&&(x._add(z),D._add(z.sub(Q)),I++,y[U]=z)}if(this._touches=y,I<this._minTouches||!D.mag())return;const R=D.div(I);return this._sum._add(R),this._sum.mag()<this._clickTolerance?void 0:{around:x.div(I),panDelta:R}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")},500)}}class Ml{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(n){}_move(n,a,p){return{}}touchstart(n,a,p){this._firstTwoTouches||p.length<2||(this._firstTwoTouches=[p[0].identifier,p[1].identifier],this._start([a[0],a[1]]))}touchmove(n,a,p){const y=this._firstTwoTouches;if(!y)return;n.preventDefault();const[x,D]=y,I=Is(p,a,x),R=Is(p,a,D);if(!I||!R)return;const U=this._aroundCenter?null:I.add(R).div(2);return this._move([I,R],U,n)}touchend(n,a,p){if(!this._firstTwoTouches)return;const[y,x]=this._firstTwoTouches,D=Is(p,a,y),I=Is(p,a,x);D&&I||(this._active&&Ce(),this.reset())}touchcancel(){this.reset()}enable(n){this._enabled=!0,this._aroundCenter=!!n&&"center"===n.around}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Is(u,n,a){for(let p=0;p<u.length;p++)if(u[p].identifier===a)return n[p]}function Hc(u,n){return Math.log(u/n)/Math.LN2}class Iu extends Ml{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(n){this._startDistance=this._distance=n[0].dist(n[1])}_move(n,a){const p=this._distance;if(this._distance=n[0].dist(n[1]),this._active||!(Math.abs(Hc(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Hc(this._distance,p),pinchAround:a}}}function Al(u,n){return 180*u.angleWith(n)/Math.PI}class vc extends Ml{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(n){this._startVector=this._vector=n[0].sub(n[1]),this._minDiameter=n[0].dist(n[1])}_move(n,a){const p=this._vector;if(this._vector=n[0].sub(n[1]),p&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:Al(this._vector,p),pinchAround:a}}_isBelowThreshold(n){this._minDiameter=Math.min(this._minDiameter,n.mag());const a=25/(Math.PI*this._minDiameter)*360,p=this._startVector;if(!p)return!1;const y=Al(n,p);return Math.abs(y)<a}}function Ia(u){return Math.abs(u.y)>Math.abs(u.x)}class cl extends Ml{constructor(n){super(),this._map=n}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(n){this._lastPoints=n,Ia(n[0].sub(n[1]))&&(this._valid=!1)}_move(n,a,p){const y=this._lastPoints;if(!y)return;const x=n[0].sub(y[0]),D=n[1].sub(y[1]);return this._map._cooperativeGestures&&!l.isFullscreen()&&p.touches.length<3||(this._valid=this.gestureBeginsVertically(x,D,p.timeStamp),!this._valid)?void 0:(this._lastPoints=n,this._active=!0,{pitchDelta:(x.y+D.y)/2*-.5})}gestureBeginsVertically(n,a,p){if(void 0!==this._valid)return this._valid;const y=n.mag()>=2,x=a.mag()>=2;if(!y&&!x)return;if(!y||!x)return null==this._firstMove&&(this._firstMove=p),p-this._firstMove<100&&void 0;const D=n.y>0==a.y>0;return Ia(n)&&Ia(a)&&D}}const hs={panStep:100,bearingStep:15,pitchStep:10};class Wc{constructor(){const n=hs;this._panStep=n.panStep,this._bearingStep=n.bearingStep,this._pitchStep=n.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(n){if(n.altKey||n.ctrlKey||n.metaKey)return;let a=0,p=0,y=0,x=0,D=0;switch(n.keyCode){case 61:case 107:case 171:case 187:a=1;break;case 189:case 109:case 173:a=-1;break;case 37:n.shiftKey?p=-1:(n.preventDefault(),x=-1);break;case 39:n.shiftKey?p=1:(n.preventDefault(),x=1);break;case 38:n.shiftKey?y=1:(n.preventDefault(),D=-1);break;case 40:n.shiftKey?y=-1:(n.preventDefault(),D=1);break;default:return}return this._rotationDisabled&&(p=0,y=0),{cameraAnimation:I=>{const R=I.getZoom();I.easeTo({duration:300,easeId:"keyboardHandler",easing:ul,zoom:a?Math.round(R)+a*(n.shiftKey?2:1):R,bearing:I.getBearing()+p*this._bearingStep,pitch:I.getPitch()+y*this._pitchStep,offset:[-x*this._panStep,-D*this._panStep],center:I.getCenter()},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function ul(u){return u*(2-u)}const Hi=4.000244140625;class Mu{constructor(n,a){this._map=n,this._el=n.getCanvasContainer(),this._handler=a,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,l.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(n){this._defaultZoomRate=n}setWheelZoomRate(n){this._wheelZoomRate=n}isEnabled(){return!!this._enabled}isActive(){return this._active||void 0!==this._finishTimeout}isZooming(){return!!this._zooming}enable(n){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!n&&"center"===n.around,this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(n){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(n.ctrlKey||n.metaKey||this.isZooming()||l.isFullscreen()))return void this._showBlockerAlert();"hidden"!==this._alertContainer.style.visibility&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let a=n.deltaMode===l.window.WheelEvent.DOM_DELTA_LINE?40*n.deltaY:n.deltaY;const p=l.exported.now(),y=p-(this._lastWheelEventTime||0);this._lastWheelEventTime=p,0!==a&&a%Hi==0?this._type="wheel":0!==a&&Math.abs(a)<4?this._type="trackpad":y>400?(this._type=null,this._lastValue=a,this._timeout=setTimeout(this._onTimeout,40,n)):this._type||(this._type=Math.abs(y*a)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,a+=this._lastValue)),n.shiftKey&&a&&(a/=4),this._type&&(this._lastWheelEvent=n,this._delta-=a,this._active||this._start(n)),n.preventDefault()}_onTimeout(n){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(n)}_start(n){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const a=oe(this._el,n);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:a,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const n=this._map.transform;"wheel"===this._type&&n.projection.wrap&&(n._center.lng>=180||n._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const a=()=>n._terrainEnabled()&&this._aroundCoord?n.computeZoomRelativeTo(this._aroundCoord):n.zoom;if(0!==this._delta){const R="wheel"===this._type&&Math.abs(this._delta)>Hi?this._wheelZoomRate:this._defaultZoomRate;let U=2/(1+Math.exp(-Math.abs(this._delta*R)));this._delta<0&&0!==U&&(U=1/U);const z=a(),Q=Math.pow(2,z),Se="number"==typeof this._targetZoom?n.zoomScale(this._targetZoom):Q;this._targetZoom=Math.min(n.maxZoom,Math.max(n.minZoom,n.scaleZoom(Se*U))),"wheel"===this._type&&(this._startZoom=z,this._easing=this._smoothOutEasing(200)),this._delta=0}const p="number"==typeof this._targetZoom?this._targetZoom:a(),y=this._startZoom,x=this._easing;let D,I=!1;if("wheel"===this._type&&y&&x){const R=Math.min((l.exported.now()-this._lastWheelEventTime)/200,1),U=x(R);D=l.number(y,p,U),R<1?this._frameId||(this._frameId=!0):I=!0}else D=p,I=!0;return this._active=!0,I&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!I,zoomDelta:D-a(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(n){let a=l.ease;if(this._prevEase){const p=this._prevEase,y=(l.exported.now()-p.start)/p.duration,x=p.easing(y+.01)-p.easing(y),D=.27/Math.sqrt(x*x+1e-4)*.01,I=Math.sqrt(.0729-D*D);a=l.bezier(D,I,.25,1)}return this._prevEase={start:l.exported.now(),duration:n,easing:a},a}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=fe("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(l.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")},200)}}class Au{constructor(n,a){this._clickZoom=n,this._tapZoom=a}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Uo{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(n,a){return n.preventDefault(),{cameraAnimation:p=>{p.easeTo({duration:300,zoom:p.getZoom()+(n.shiftKey?-1:1),around:p.unproject(a)},{originalEvent:n})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class qc{constructor(){this._tap=new ll({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(n,a,p){this._swipePoint||(this._tapTime&&n.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?p.length>0&&(this._swipePoint=a[0],this._swipeTouch=p[0].identifier):this._tap.touchstart(n,a,p))}touchmove(n,a,p){if(this._tapTime){if(this._swipePoint){if(p[0].identifier!==this._swipeTouch)return;const y=a[0],x=y.y-this._swipePoint.y;return this._swipePoint=y,n.preventDefault(),this._active=!0,{zoomDelta:x/128}}}else this._tap.touchmove(n,a,p)}touchend(n,a,p){this._tapTime?this._swipePoint&&0===p.length&&this.reset():this._tap.touchend(n,a,p)&&(this._tapTime=n.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Su{constructor(n,a,p){this._el=n,this._mousePan=a,this._touchPan=p}enable(n){this._inertiaOptions=n||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Pu{constructor(n,a,p){this._pitchWithRotate=n.pitchWithRotate,this._mouseRotate=a,this._mousePitch=p}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class ec{constructor(n,a,p,y){this._el=n,this._touchZoom=a,this._touchRotate=p,this._tapDragZoom=y,this._rotationDisabled=!1,this._enabled=!0}enable(n){this._touchZoom.enable(n),this._rotationDisabled||this._touchRotate.enable(n),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Ms=u=>u.zoom||u.drag||u.pitch||u.rotate;class Ou extends l.Event{}class Lh{constructor(){this.constants=[1,1,.01],this.radius=0}setup(n,a){const p=l.sub([],a,n);this.radius=l.length(p[2]<0?l.div([],p,this.constants):[p[0],p[1],0])}projectRay(n){l.div(n,n,this.constants),l.normalize(n,n),l.mul$1(n,n,this.constants);const a=l.scale$2([],n,this.radius);if(a[2]>0){const p=l.scale$2([],[0,0,1],l.dot(a,[0,0,1])),y=l.scale$2([],l.normalize([],[a[0],a[1],0]),this.radius),x=l.add([],a,l.scale$2([],l.sub([],l.add([],y,p),a),2));a[0]=x[0],a[1]=x[1]}return a}}function ya(u){return u.panDelta&&u.panDelta.mag()||u.zoomDelta||u.bearingDelta||u.pitchDelta}class Ma{constructor(n,a){this._map=n,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Du(n),this._bearingSnap=a.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Lh,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(a),l.bindAll(["handleEvent","handleWindowEvent"],this);const p=this._el;this._listeners=[[p,"touchstart",{passive:!0}],[p,"touchmove",{passive:!1}],[p,"touchend",void 0],[p,"touchcancel",void 0],[p,"mousedown",void 0],[p,"mousemove",void 0],[p,"mouseup",void 0],[l.window.document,"mousemove",{capture:!0}],[l.window.document,"mouseup",void 0],[p,"mouseover",void 0],[p,"mouseout",void 0],[p,"dblclick",void 0],[p,"click",void 0],[p,"keydown",{capture:!1}],[p,"keyup",void 0],[p,"wheel",{passive:!1}],[p,"contextmenu",void 0],[l.window,"blur",void 0]];for(const[y,x,D]of this._listeners)y.addEventListener(x,y===l.window.document?this.handleWindowEvent:this.handleEvent,D)}destroy(){for(const[n,a,p]of this._listeners)n.removeEventListener(a,n===l.window.document?this.handleWindowEvent:this.handleEvent,p)}_addDefaultHandlers(n){const a=this._map,p=a.getCanvasContainer();this._add("mapEvent",new Xl(a,n));const y=a.boxZoom=new Ql(a,n);this._add("boxZoom",y);const x=new ts,D=new Uo;a.doubleClickZoom=new Au(D,x),this._add("tapZoom",x),this._add("clickZoom",D);const I=new qc;this._add("tapDragZoom",I);const R=a.touchPitch=new cl(a);this._add("touchPitch",R);const U=new Lo(n),z=new Gc(n);a.dragRotate=new Pu(n,U,z),this._add("mouseRotate",U,["mousePitch"]),this._add("mousePitch",z,["mouseRotate"]);const Q=new Wa(n),Se=new Il(a,n);a.dragPan=new Su(p,Q,Se),this._add("mousePan",Q),this._add("touchPan",Se,["touchZoom","touchRotate"]);const je=new vc,Ye=new Iu;a.touchZoomRotate=new ec(p,Ye,je,I),this._add("touchRotate",je,["touchPan","touchZoom"]),this._add("touchZoom",Ye,["touchPan","touchRotate"]),this._add("blockableMapEvent",new yc(a));const $e=a.scrollZoom=new Mu(a,this);this._add("scrollZoom",$e,["mousePan"]);const et=a.keyboard=new Wc;this._add("keyboard",et);for(const ne of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])n.interactive&&n[ne]&&a[ne].enable(n[ne])}_add(n,a,p){this._handlers.push({handlerName:n,handler:a,allowed:p}),this._handlersById[n]=a}stop(n){if(!this._updatingCamera){for(const{handler:a}of this._handlers)a.reset();this._inertia.clear(),this._fireEvents({},{},n),this._changes=[]}}isActive(){for(const{handler:n}of this._handlers)if(n.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Ms(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(n,a,p){for(const y in n)if(y!==p&&(!a||a.indexOf(y)<0))return!0;return!1}handleWindowEvent(n){this.handleEvent(n,`${n.type}Window`)}_getMapTouches(n){const a=[];for(const p of n)this._el.contains(p.target)&&a.push(p);return a}handleEvent(n,a){this._updatingCamera=!0;const p="renderFrame"===n.type,y=p?void 0:n,x={needsRenderFrame:!1},D={},I={},R=n.touches?this._getMapTouches(n.touches):void 0,U=R?xe(this._el,R):p?void 0:oe(this._el,n);for(const{handlerName:Se,handler:je,allowed:Ye}of this._handlers){if(!je.isEnabled())continue;let $e;this._blockedByActive(I,Ye,Se)?je.reset():je[a||n.type]&&($e=je[a||n.type](n,U,R),this.mergeHandlerResult(x,D,$e,Se,y),$e&&$e.needsRenderFrame&&this._triggerRenderFrame()),($e||je.isActive())&&(I[Se]=je)}const z={};for(const Se in this._previousActiveHandlers)I[Se]||(z[Se]=y);this._previousActiveHandlers=I,(Object.keys(z).length||ya(x))&&(this._changes.push([x,D,z]),this._triggerRenderFrame()),(Object.keys(I).length||ya(x))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Q}=x;Q&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Q(this._map))}mergeHandlerResult(n,a,p,y,x){if(!p)return;l.extend(n,p);const D={handlerName:y,originalEvent:p.originalEvent||x};void 0!==p.zoomDelta&&(a.zoom=D),void 0!==p.panDelta&&(a.drag=D),void 0!==p.pitchDelta&&(a.pitch=D),void 0!==p.bearingDelta&&(a.rotate=D)}_applyChanges(){const n={},a={},p={};for(const[y,x,D]of this._changes)y.panDelta&&(n.panDelta=(n.panDelta||new l.Point(0,0))._add(y.panDelta)),y.zoomDelta&&(n.zoomDelta=(n.zoomDelta||0)+y.zoomDelta),y.bearingDelta&&(n.bearingDelta=(n.bearingDelta||0)+y.bearingDelta),y.pitchDelta&&(n.pitchDelta=(n.pitchDelta||0)+y.pitchDelta),void 0!==y.around&&(n.around=y.around),void 0!==y.aroundCoord&&(n.aroundCoord=y.aroundCoord),void 0!==y.pinchAround&&(n.pinchAround=y.pinchAround),y.noInertia&&(n.noInertia=y.noInertia),l.extend(a,x),l.extend(p,D);this._updateMapTransform(n,a,p),this._changes=[]}_updateMapTransform(n,a,p){const y=this._map,x=y.transform,D=He=>[He.x,He.y,He.z];if((He=>{const ht=this._eventsInProgress.drag;return ht&&!this._handlersById[ht.handlerName].isActive()})()&&!ya(n)){const He=x.zoom;x.cameraElevationReference="sea",x.recenterOnTerrain(),x.cameraElevationReference="ground",He!==x.zoom&&this._map._update(!0)}if(x._isCameraConstrained&&y._stop(!0),!ya(n))return void this._fireEvents(a,p,!0);let{panDelta:I,zoomDelta:R,bearingDelta:U,pitchDelta:z,around:Q,aroundCoord:Se,pinchAround:je}=n;x._isCameraConstrained&&(R>0&&(R=0),x._isCameraConstrained=!1),void 0!==je&&(Q=je),(R||(He=>a.drag&&!this._eventsInProgress.drag)())&&Q&&(this._dragOrigin=D(x.pointCoordinate3D(Q)),this._trackingEllipsoid.setup(x._camera.position,this._dragOrigin)),x.cameraElevationReference="sea",y._stop(!0),Q=Q||y.transform.centerPoint,U&&(x.bearing+=U),z&&(x.pitch+=z),x._updateCameraState();const Ye=[0,0,0];if(I)if("mercator"===x.projection.name){const He=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(Q).dir),ht=this._trackingEllipsoid.projectRay(x.screenPointToMercatorRay(Q.sub(I)).dir);Ye[0]=ht[0]-He[0],Ye[1]=ht[1]-He[1]}else{const He=x.pointCoordinate(Q);if("globe"===x.projection.name){I=I.rotate(-x.angle);const ht=x._pixelsPerMercatorPixel/x.worldSize;Ye[0]=-I.x*l.mercatorScale(l.latFromMercatorY(He.y))*ht,Ye[1]=-I.y*l.mercatorScale(x.center.lat)*ht}else{const ht=x.pointCoordinate(Q.sub(I));He&&ht&&(Ye[0]=ht.x-He.x,Ye[1]=ht.y-He.y)}}const $e=x.zoom,et=[0,0,0];if(R){const He=D(Se||x.pointCoordinate3D(Q)),ht={dir:l.normalize([],l.sub([],He,x._camera.position))};if(ht.dir[2]<0){const gt=x.zoomDeltaToMovement(He,R);l.scale$2(et,ht.dir,gt)}}const ne=l.add(Ye,Ye,et);x._translateCameraConstrained(ne),R&&Math.abs(x.zoom-$e)>1e-4&&x.recenterOnTerrain(),x.cameraElevationReference="ground",this._map._update(),n.noInertia||this._inertia.record(n),this._fireEvents(a,p,!0)}_fireEvents(n,a,p){const y=Ms(this._eventsInProgress),x=Ms(n),D={};for(const z in n){const{originalEvent:Q}=n[z];this._eventsInProgress[z]||(D[`${z}start`]=Q),this._eventsInProgress[z]=n[z]}!y&&x&&this._fireEvent("movestart",x.originalEvent);for(const z in D)this._fireEvent(z,D[z]);x&&this._fireEvent("move",x.originalEvent);for(const z in n){const{originalEvent:Q}=n[z];this._fireEvent(z,Q)}const I={};let R;for(const z in this._eventsInProgress){const{handlerName:Q,originalEvent:Se}=this._eventsInProgress[z];this._handlersById[Q].isActive()||(delete this._eventsInProgress[z],R=a[Q]||Se,I[`${z}end`]=R)}for(const z in I)this._fireEvent(z,I[z]);const U=Ms(this._eventsInProgress);if(p&&(y||x)&&!U){this._updatingCamera=!0;const z=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Q=Se=>0!==Se&&-this._bearingSnap<Se&&Se<this._bearingSnap;z?(Q(z.bearing||this._map.getBearing())&&(z.bearing=0),this._map.easeTo(z,{originalEvent:R})):(this._map.fire(new l.Event("moveend",{originalEvent:R})),Q(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(n,a){this._map.fire(new l.Event(n,a?{originalEvent:a}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(n=>{this._frameId=void 0,this.handleEvent(new Ou("renderFrame",{timeStamp:n})),this._applyChanges()})}_triggerRenderFrame(){void 0===this._frameId&&(this._frameId=this._requestFrame())}}const Sn="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class gr extends l.Evented{constructor(n,a){super(),this._moving=!1,this._zooming=!1,this.transform=n,this._bearingSnap=a.bearingSnap,this._respectPrefersReducedMotion=!1!==a.respectPrefersReducedMotion,l.bindAll(["_renderFrameCallback"],this)}getCenter(){return new l.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(n,a){return this.jumpTo({center:n},a)}panBy(n,a,p){return n=l.Point.convert(n).mult(-1),this.panTo(this.transform.center,l.extend({offset:n},a),p)}panTo(n,a,p){return this.easeTo(l.extend({center:n},a),p)}getZoom(){return this.transform.zoom}setZoom(n,a){return this.jumpTo({zoom:n},a),this}zoomTo(n,a,p){return this.easeTo(l.extend({zoom:n},a),p)}zoomIn(n,a){return this.zoomTo(this.getZoom()+1,n,a),this}zoomOut(n,a){return this.zoomTo(this.getZoom()-1,n,a),this}getBearing(){return this.transform.bearing}setBearing(n,a){return this.jumpTo({bearing:n},a),this}getPadding(){return this.transform.padding}setPadding(n,a){return this.jumpTo({padding:n},a),this}rotateTo(n,a,p){return this.easeTo(l.extend({bearing:n},a),p)}resetNorth(n,a){return this.rotateTo(0,l.extend({duration:1e3},n),a),this}resetNorthPitch(n,a){return this.easeTo(l.extend({bearing:0,pitch:0,duration:1e3},n),a),this}snapToNorth(n,a){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(n,a):this}getPitch(){return this.transform.pitch}setPitch(n,a){return this.jumpTo({pitch:n},a),this}cameraForBounds(n,a){n=l.LngLatBounds.convert(n);const p=a&&a.bearing||0,y=a&&a.pitch||0,x=n.getNorthWest(),D=n.getSouthEast();return this._cameraForBounds(this.transform,x,D,p,y,a)}_extendCameraOptions(n){const a={top:0,bottom:0,right:0,left:0};if("number"==typeof(n=l.extend({padding:a,offset:[0,0],maxZoom:this.transform.maxZoom},n)).padding){const p=n.padding;n.padding={top:p,bottom:p,right:p,left:p}}return n.padding=l.extend(a,n.padding),n}_minimumAABBFrustumDistance(n,a){const p=a.max[0]-a.min[0],y=a.max[1]-a.min[1];return p/y>n.aspect?p/(2*Math.tan(.5*n.fovX)*n.aspect):y/(2*Math.tan(.5*n.fovY)*n.aspect)}_cameraForBoundsOnGlobe(n,a,p,y,x,D){const I=n.clone(),R=this._extendCameraOptions(D);I.bearing=y,I.pitch=x;const U=l.LngLat.convert(a),z=l.LngLat.convert(p),Q=.5*(U.lat+z.lat),Se=.5*(U.lng+z.lng),je=l.latLngToECEF(Q,Se),Ye=l.normalize([],je),$e=l.normalize([],l.cross([],Ye,[0,1,0])),et=l.cross([],$e,Ye),ne=[$e[0],$e[1],$e[2],0,et[0],et[1],et[2],0,Ye[0],Ye[1],Ye[2],0,0,0,0,1],He=[je,l.latLngToECEF(U.lat,U.lng),l.latLngToECEF(z.lat,U.lng),l.latLngToECEF(z.lat,z.lng),l.latLngToECEF(U.lat,z.lng),l.latLngToECEF(Q,U.lng),l.latLngToECEF(Q,z.lng),l.latLngToECEF(U.lat,Se),l.latLngToECEF(z.lat,Se)];let ht=l.Aabb.fromPoints(He.map(kn=>[l.dot($e,kn),l.dot(et,kn),l.dot(Ye,kn)]));const gt=l.transformMat4([],ht.center,ne);0===l.squaredLength(gt)&&l.set(gt,0,0,1),l.normalize(gt,gt),l.scale$2(gt,gt,l.GLOBE_RADIUS),I.center=l.ecefToLatLng(gt);const Ot=I.getWorldToCameraMatrix(),kt=l.invert(new Float64Array(16),Ot);ht=l.Aabb.applyTransform(ht,l.multiply([],Ot,ne)),l.transformMat4(gt,gt,Ot);const Lt=.5*(ht.max[2]-ht.min[2]),qt=this._minimumAABBFrustumDistance(I,ht),$t=l.scale$2([],[0,0,1],Lt),cn=l.add($t,gt,$t),Wn=qt+(0===I.pitch?0:l.distance(gt,cn)),nn=I.globeCenterInViewSpace,Mn=l.sub([],gt,[nn[0],nn[1],nn[2]]);l.normalize(Mn,Mn),l.scale$2(Mn,Mn,Wn);const pn=l.add([],gt,Mn);l.transformMat4(pn,pn,kt);const qn=l.earthRadius/l.GLOBE_RADIUS,sn=l.length(pn),An=l.mercatorZfromAltitude(Math.max(sn*qn-l.earthRadius,Number.EPSILON),0),Zn=Math.min(I.zoomFromMercatorZAdjusted(An),R.maxZoom);return Zn>.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"mercator"}),I.zoom=Zn,this._cameraForBounds(I,a,p,y,x,D)):{center:I.center,zoom:Zn,bearing:y,pitch:x}}queryTerrainElevation(n,a){const p=this.transform.elevation;return p?(a=l.extend({},{exaggerated:!0},a),p.getAtPoint(l.MercatorCoordinate.fromLngLat(n),null,a.exaggerated)):null}_cameraForBounds(n,a,p,y,x,D){if("globe"===n.projection.name)return this._cameraForBoundsOnGlobe(n,a,p,y,x,D);const I=n.clone(),R=this._extendCameraOptions(D),U=I.padding;I.bearing=y,I.pitch=x;const z=l.LngLat.convert(a),Q=l.LngLat.convert(p),Se=new l.LngLat(z.lng,Q.lat),je=new l.LngLat(Q.lng,z.lat),Ye=I.project(z),$e=I.project(Q),et=this.queryTerrainElevation(z),ne=this.queryTerrainElevation(Q),He=this.queryTerrainElevation(Se),ht=this.queryTerrainElevation(je),gt=[[Ye.x,Ye.y,Math.min(et||0,ne||0,He||0,ht||0)],[$e.x,$e.y,Math.max(et||0,ne||0,He||0,ht||0)]];let Ot=l.Aabb.fromPoints(gt);const kt=I.getWorldToCameraMatrix(),Lt=l.invert(new Float64Array(16),kt);Ot=l.Aabb.applyTransform(Ot,kt);const qt=l.sub([],Ot.max,Ot.min),$t=U.left||0,cn=U.right||0,Wn=U.bottom||0,nn=U.top||0,{left:Mn,right:pn,top:qn,bottom:sn}=R.padding,An=.5*($t+cn),Zn=.5*(nn+Wn),kn=Math.min(I.scaleZoom(I.scale*Math.min((I.width-($t+cn+Mn+pn))/qt[0],(I.height-(Wn+nn+sn+qn))/qt[1])),R.maxZoom),ti=I.scale/I.zoomScale(kn);Ot=new l.Aabb([Ot.min[0]-(Mn+An)*ti,Ot.min[1]-(sn+Zn)*ti,Ot.min[2]],[Ot.max[0]+(pn+An)*ti,Ot.max[1]+(qn+Zn)*ti,Ot.max[2]]);const Ii=.5*qt[2],$i=this._minimumAABBFrustumDistance(I,Ot),mi=[0,0,1,0];l.transformMat4$1(mi,mi,kt),l.normalize$2(mi,mi);const Oi=l.scale$2([],mi,$i+Ii),cr=l.add([],Ot.center,Oi),lr=("number"==typeof R.offset.x&&"number"==typeof R.offset.y?new l.Point(R.offset.x,R.offset.y):l.Point.convert(R.offset)).rotate(-l.degToRad(y));Ot.center[0]-=lr.x*ti,Ot.center[1]+=lr.y*ti,l.transformMat4(Ot.center,Ot.center,Lt),l.transformMat4(cr,cr,Lt);const Ci=[Ot.center[0],Ot.center[1],cr[2]*I.pixelsPerMeter];l.scale$2(Ci,Ci,1/I.worldSize);const br=l.lngFromMercatorX(Ci[0]),Gr=l.latFromMercatorY(Ci[1]),Ir=Math.min(I._zoomFromMercatorZ(Ci[2]),R.maxZoom),Br=new l.LngLat(br,Gr);return I.mercatorFromTransition&&Ir<.5*(l.GLOBE_ZOOM_THRESHOLD_MIN+l.GLOBE_ZOOM_THRESHOLD_MAX)?(I.setProjection({name:"globe"}),I.zoom=Ir,this._cameraForBounds(I,a,p,y,x,D)):{center:Br,zoom:Ir,bearing:y,pitch:x}}fitBounds(n,a,p){const y=this.cameraForBounds(n,a);return this._fitInternal(y,a,p)}fitScreenCoordinates(n,a,p,y,x){const D=l.Point.convert(n),I=l.Point.convert(a),R=new l.Point(Math.min(D.x,I.x),Math.min(D.y,I.y)),U=new l.Point(Math.max(D.x,I.x),Math.max(D.y,I.y));if("mercator"===this.transform.projection.name&&this.transform.anyCornerOffEdge(D,I))return this;const z=this.transform.pointLocation3D(R),Q=this.transform.pointLocation3D(U),Se=this.transform.pointLocation3D(new l.Point(R.x,U.y)),je=this.transform.pointLocation3D(new l.Point(U.x,R.y)),Ye=[Math.min(z.lng,Q.lng,Se.lng,je.lng),Math.min(z.lat,Q.lat,Se.lat,je.lat)],$e=[Math.max(z.lng,Q.lng,Se.lng,je.lng),Math.max(z.lat,Q.lat,Se.lat,je.lat)],et=y&&y.pitch?y.pitch:this.getPitch(),ne=this._cameraForBounds(this.transform,Ye,$e,p,et,y);return this._fitInternal(ne,y,x)}_fitInternal(n,a,p){return n?(delete(a=l.extend(n,a)).padding,a.linear?this.easeTo(a,p):this.flyTo(a,p)):this}jumpTo(n,a){this.stop();const p=n.preloadOnly?this.transform.clone():this.transform;let y=!1,x=!1,D=!1;return"zoom"in n&&p.zoom!==+n.zoom&&(y=!0,p.zoom=+n.zoom),void 0!==n.center&&(p.center=l.LngLat.convert(n.center)),"bearing"in n&&p.bearing!==+n.bearing&&(x=!0,p.bearing=+n.bearing),"pitch"in n&&p.pitch!==+n.pitch&&(D=!0,p.pitch=+n.pitch),null==n.padding||p.isPaddingEqual(n.padding)||(p.padding=n.padding),n.preloadOnly?(this._preloadTiles(p),this):(this.fire(new l.Event("movestart",a)).fire(new l.Event("move",a)),y&&this.fire(new l.Event("zoomstart",a)).fire(new l.Event("zoom",a)).fire(new l.Event("zoomend",a)),x&&this.fire(new l.Event("rotatestart",a)).fire(new l.Event("rotate",a)).fire(new l.Event("rotateend",a)),D&&this.fire(new l.Event("pitchstart",a)).fire(new l.Event("pitch",a)).fire(new l.Event("pitchend",a)),this.fire(new l.Event("moveend",a)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||l.warnOnce(Sn),this.transform.getFreeCameraOptions()}setFreeCameraOptions(n,a){const p=this.transform;if(!p.projection.supportsFreeCamera)return l.warnOnce(Sn),this;this.stop();const y=p.zoom,x=p.pitch,D=p.bearing;p.setFreeCameraOptions(n);const I=y!==p.zoom,R=x!==p.pitch,U=D!==p.bearing;return this.fire(new l.Event("movestart",a)).fire(new l.Event("move",a)),I&&this.fire(new l.Event("zoomstart",a)).fire(new l.Event("zoom",a)).fire(new l.Event("zoomend",a)),U&&this.fire(new l.Event("rotatestart",a)).fire(new l.Event("rotate",a)).fire(new l.Event("rotateend",a)),R&&this.fire(new l.Event("pitchstart",a)).fire(new l.Event("pitch",a)).fire(new l.Event("pitchend",a)),this.fire(new l.Event("moveend",a)),this}easeTo(n,a){this._stop(!1,n.easeId),(!1===(n=l.extend({offset:[0,0],duration:500,easing:l.ease},n)).animate||this._prefersReducedMotion(n))&&(n.duration=0);const p=this.transform,y=this.getZoom(),x=this.getBearing(),D=this.getPitch(),I=this.getPadding(),R="zoom"in n?+n.zoom:y,U="bearing"in n?this._normalizeBearing(n.bearing,x):x,z="pitch"in n?+n.pitch:D,Q="padding"in n?n.padding:p.padding,Se=l.Point.convert(n.offset);let je,Ye,$e;if("globe"===p.projection.name){const $t=l.MercatorCoordinate.fromLngLat(p.center),cn=Se.rotate(-p.angle);$t.x+=cn.x/p.worldSize,$t.y+=cn.y/p.worldSize;const Wn=$t.toLngLat(),nn=l.LngLat.convert(n.center||Wn);this._normalizeCenter(nn),je=p.centerPoint.add(cn),Ye=new l.Point($t.x,$t.y).mult(p.worldSize),$e=new l.Point(l.mercatorXfromLng(nn.lng),l.mercatorYfromLat(nn.lat)).mult(p.worldSize).sub(Ye)}else{je=p.centerPoint.add(Se);const $t=p.pointLocation(je),cn=l.LngLat.convert(n.center||$t);this._normalizeCenter(cn),Ye=p.project($t),$e=p.project(cn).sub(Ye)}const et=p.zoomScale(R-y);let ne,He;n.around&&(ne=l.LngLat.convert(n.around),He=p.locationPoint(ne));const ht=this._zooming||R!==y,gt=this._rotating||x!==U,Ot=this._pitching||z!==D,kt=!p.isPaddingEqual(Q),Lt=$t=>cn=>{if(ht&&($t.zoom=l.number(y,R,cn)),gt&&($t.bearing=l.number(x,U,cn)),Ot&&($t.pitch=l.number(D,z,cn)),kt&&($t.interpolatePadding(I,Q,cn),je=$t.centerPoint.add(Se)),ne)$t.setLocationAtPoint(ne,He);else{const Wn=$t.zoomScale($t.zoom-y),nn=R>y?Math.min(2,et):Math.max(.5,et),Mn=Math.pow(nn,1-cn),pn=$t.unproject(Ye.add($e.mult(cn*Mn)).mult(Wn));$t.setLocationAtPoint($t.renderWorldCopies?pn.wrap():pn,je)}return n.preloadOnly||this._fireMoveEvents(a),$t};if(n.preloadOnly){const $t=this._emulate(Lt,n.duration,p);return this._preloadTiles($t),this}const qt={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=ht,this._rotating=gt,this._pitching=Ot,this._padding=kt,this._easeId=n.easeId,this._prepareEase(a,n.noMoveStart,qt),this._ease(Lt(p),$t=>{p.recenterOnTerrain(),this._afterEase(a,$t)},n),this}_prepareEase(n,a,p={}){this._moving=!0,this.transform.cameraElevationReference="sea",a||p.moving||this.fire(new l.Event("movestart",n)),this._zooming&&!p.zooming&&this.fire(new l.Event("zoomstart",n)),this._rotating&&!p.rotating&&this.fire(new l.Event("rotatestart",n)),this._pitching&&!p.pitching&&this.fire(new l.Event("pitchstart",n))}_fireMoveEvents(n){this.fire(new l.Event("move",n)),this._zooming&&this.fire(new l.Event("zoom",n)),this._rotating&&this.fire(new l.Event("rotate",n)),this._pitching&&this.fire(new l.Event("pitch",n))}_afterEase(n,a){if(this._easeId&&a&&this._easeId===a)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const p=this._zooming,y=this._rotating,x=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,p&&this.fire(new l.Event("zoomend",n)),y&&this.fire(new l.Event("rotateend",n)),x&&this.fire(new l.Event("pitchend",n)),this.fire(new l.Event("moveend",n))}flyTo(n,a){if(this._prefersReducedMotion(n)){const kn=l.pick(n,["center","zoom","bearing","pitch","around"]);return this.jumpTo(kn,a)}this.stop(),n=l.extend({offset:[0,0],speed:1.2,curve:1.42,easing:l.ease},n);const p=this.transform,y=this.getZoom(),x=this.getBearing(),D=this.getPitch(),I=this.getPadding(),R="zoom"in n?l.clamp(+n.zoom,p.minZoom,p.maxZoom):y,U="bearing"in n?this._normalizeBearing(n.bearing,x):x,z="pitch"in n?+n.pitch:D,Q="padding"in n?n.padding:p.padding,Se=p.zoomScale(R-y),je=l.Point.convert(n.offset);let Ye=p.centerPoint.add(je);const $e=p.pointLocation(Ye),et=l.LngLat.convert(n.center||$e);this._normalizeCenter(et);const ne=p.project($e),He=p.project(et).sub(ne);let ht=n.curve;const gt=Math.max(p.width,p.height),Ot=gt/Se,kt=He.mag();if("minZoom"in n){const kn=l.clamp(Math.min(n.minZoom,y,R),p.minZoom,p.maxZoom),ti=gt/p.zoomScale(kn-y);ht=Math.sqrt(ti/kt*2)}const Lt=ht*ht;function qt(kn){const ti=(Ot*Ot-gt*gt+(kn?-1:1)*Lt*Lt*kt*kt)/(2*(kn?Ot:gt)*Lt*kt);return Math.log(Math.sqrt(ti*ti+1)-ti)}function $t(kn){return(Math.exp(kn)-Math.exp(-kn))/2}function cn(kn){return(Math.exp(kn)+Math.exp(-kn))/2}const Wn=qt(0);let nn=function(kn){return cn(Wn)/cn(Wn+ht*kn)},Mn=function(kn){return gt*((cn(Wn)*($t(ti=Wn+ht*kn)/cn(ti))-$t(Wn))/Lt)/kt;var ti},pn=(qt(1)-Wn)/ht;if(Math.abs(kt)<1e-6||!isFinite(pn)){if(Math.abs(gt-Ot)<1e-6)return this.easeTo(n,a);const kn=Ot<gt?-1:1;pn=Math.abs(Math.log(Ot/gt))/ht,Mn=function(){return 0},nn=function(ti){return Math.exp(kn*ht*ti)}}n.duration="duration"in n?+n.duration:1e3*pn/("screenSpeed"in n?+n.screenSpeed/ht:+n.speed),n.maxDuration&&n.duration>n.maxDuration&&(n.duration=0);const qn=x!==U,sn=z!==D,An=!p.isPaddingEqual(Q),Zn=kn=>ti=>{const Ii=ti*pn,$i=1/nn(Ii);kn.zoom=1===ti?R:y+kn.scaleZoom($i),qn&&(kn.bearing=l.number(x,U,ti)),sn&&(kn.pitch=l.number(D,z,ti)),An&&(kn.interpolatePadding(I,Q,ti),Ye=kn.centerPoint.add(je));const mi=1===ti?et:kn.unproject(ne.add(He.mult(Mn(Ii))).mult($i));return kn.setLocationAtPoint(kn.renderWorldCopies?mi.wrap():mi,Ye),kn._updateCameraOnTerrain(),n.preloadOnly||this._fireMoveEvents(a),kn};if(n.preloadOnly){const kn=this._emulate(Zn,n.duration,p);return this._preloadTiles(kn),this}return this._zooming=!0,this._rotating=qn,this._pitching=sn,this._padding=An,this._prepareEase(a,!1),this._ease(Zn(p),()=>this._afterEase(a),n),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(n,a){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const p=this._onEaseEnd;this._onEaseEnd=void 0,p.call(this,a)}if(!n){const p=this.handlers;p&&p.stop(!1)}return this}_ease(n,a,p){!1===p.animate||0===p.duration?(n(1),a()):(this._easeStart=l.exported.now(),this._easeOptions=p,this._onEaseFrame=n,this._onEaseEnd=a,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const n=Math.min((l.exported.now()-this._easeStart)/this._easeOptions.duration,1),a=this._onEaseFrame;a&&a(this._easeOptions.easing(n)),n<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(n,a){n=l.wrap(n,-180,180);const p=Math.abs(n-a);return Math.abs(n-360-a)<p&&(n-=360),Math.abs(n+360-a)<p&&(n+=360),n}_normalizeCenter(n){const a=this.transform;if(!a.renderWorldCopies||a.maxBounds)return;const p=n.lng-a.center.lng;n.lng+=p>180?-360:p<-180?360:0}_prefersReducedMotion(n){return this._respectPrefersReducedMotion&&l.exported.prefersReducedMotion&&!(n&&n.essential)}_emulate(n,a,p){const y=Math.ceil(15*a/1e3),x=[],D=n(p.clone());for(let I=0;I<=y;I++){const R=D(I/y);x.push(R.clone())}return x}}class hi{constructor(n={}){this.options=n,l.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(n){const a=this.options&&this.options.compact;return this._map=n,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=fe("button","mapboxgl-ctrl-attrib-button",this._container),fe("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=fe("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),a&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),void 0===a&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(n,a){const p=this._map._getUIString(`AttributionControl.${a}`);n.setAttribute("aria-label",p),n.removeAttribute("title"),n.firstElementChild&&n.firstElementChild.setAttribute("title",p)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let n=this._editLink;n||(n=this._editLink=this._container.querySelector(".mapbox-improve-map"));const a=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||l.config.ACCESS_TOKEN}];if(n){const p=a.reduce((y,x,D)=>(x.value&&(y+=`${x.key}=${x.value}${D<a.length-1?"&":""}`),y),"?");n.href=`${l.config.FEEDBACK_URL}/${p}#${Zo(this._map,!0)}`,n.rel="noopener nofollow",this._setElementTitle(n,"MapFeedback")}}_updateData(n){!n||"metadata"!==n.sourceDataType&&"visibility"!==n.sourceDataType&&"style"!==n.dataType||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let n=[];if(this._map.style.stylesheet){const y=this._map.style.stylesheet;this.styleOwner=y.owner,this.styleId=y.id}const a=this._map.style._sourceCaches;for(const y in a){const x=a[y];if(x.used){const D=x.getSource();D.attribution&&n.indexOf(D.attribution)<0&&n.push(D.attribution)}}n.sort((y,x)=>y.length-x.length),n=n.filter((y,x)=>{for(let D=x+1;D<n.length;D++)if(n[D].indexOf(y)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?n=[...this.options.customAttribution,...n]:n.unshift(this.options.customAttribution));const p=n.join(" | ");p!==this._attribHTML&&(this._attribHTML=p,n.length?(this._innerContainer.innerHTML=p,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class tc{constructor(){l.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(n){this._map=n,this._container=fe("div","mapboxgl-ctrl");const a=fe("a","mapboxgl-ctrl-logo");return a.target="_blank",a.rel="noopener nofollow",a.href="https://www.mapbox.com/",a.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),a.setAttribute("rel","noopener nofollow"),this._container.appendChild(a),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(n){n&&"metadata"!==n.sourceDataType||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const n=this._map.style._sourceCaches;if(0===Object.entries(n).length)return!0;for(const a in n){const p=n[a].getSource();if(p.hasOwnProperty("mapbox_logo")&&!p.mapbox_logo)return!1}return!0}_updateCompact(){const n=this._container.children;if(n.length){const a=n[0];this._map.getCanvasContainer().offsetWidth<250?a.classList.add("mapboxgl-compact"):a.classList.remove("mapboxgl-compact")}}}class Nr{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(n){const a=++this._id;return this._queue.push({callback:n,id:a,cancelled:!1}),a}remove(n){const a=this._currentlyRunning,p=a?this._queue.concat(a):this._queue;for(const y of p)if(y.id===n)return void(y.cancelled=!0)}run(n=0){const a=this._currentlyRunning=this._queue;this._queue=[];for(const p of a)if(!p.cancelled&&(p.callback(n),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function dl(u,n,a){if(u=new l.LngLat(u.lng,u.lat),n){const p=new l.LngLat(u.lng-360,u.lat),y=new l.LngLat(u.lng+360,u.lat),x=360*Math.ceil(Math.abs(u.lng-a.center.lng)/360),D=a.locationPoint(u).distSqr(n),I=n.x<0||n.y<0||n.x>a.width||n.y>a.height;a.locationPoint(p).distSqr(n)<D&&(I||Math.abs(p.lng-a.center.lng)<x)?u=p:a.locationPoint(y).distSqr(n)<D&&(I||Math.abs(y.lng-a.center.lng)<x)&&(u=y)}for(;Math.abs(u.lng-a.center.lng)>180;){const p=a.locationPoint(u);if(p.x>=0&&p.y>=0&&p.x<=a.width&&p.y<=a.height)break;u.lng>a.center.lng?u.lng-=360:u.lng+=360}return u}const ra={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class oi extends l.Evented{constructor(n,a){if(super(),(n instanceof l.window.HTMLElement||a)&&(n=l.extend({element:n},a)),l.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=n&&n.anchor||"center",this._color=n&&n.color||"#3FB1CE",this._scale=n&&n.scale||1,this._draggable=n&&n.draggable||!1,this._clickTolerance=n&&n.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=n&&n.rotation||0,this._rotationAlignment=n&&n.rotationAlignment||"auto",this._pitchAlignment=n&&n.pitchAlignment&&n.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=n&&n.occludedOpacity||.2,n&&n.element)this._element=n.element,this._offset=l.Point.convert(n&&n.offset||[0,0]);else{this._defaultMarker=!0,this._element=fe("div");const y=41,x=27,D=Pe("svg",{display:"block",height:y*this._scale+"px",width:x*this._scale+"px",viewBox:`0 0 ${x} ${y}`},this._element),I=Pe("radialGradient",{id:"shadowGradient"},Pe("defs",{},D));Pe("stop",{offset:"10%","stop-opacity":.4},I),Pe("stop",{offset:"100%","stop-opacity":.05},I),Pe("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},D),Pe("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},D),Pe("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},D),Pe("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},D),this._offset=l.Point.convert(n&&n.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",y=>{y.preventDefault()}),this._element.addEventListener("mousedown",y=>{y.preventDefault()});const p=this._element.classList;for(const y in ra)p.remove(`mapboxgl-marker-anchor-${y}`);p.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(n){return n===this._map||(this.remove(),this._map=n,n.getCanvasContainer().appendChild(this._element),n.on("move",this._updateMoving),n.on("moveend",this._update),n.on("remove",this._clearFadeTimer),n._addMarker(this),this.setDraggable(this._draggable),this._update(),n.on("click",this._onMapClick)),this}remove(){const n=this._map;return n&&(n.off("click",this._onMapClick),n.off("move",this._updateMoving),n.off("moveend",this._update),n.off("mousedown",this._addDragHandler),n.off("touchstart",this._addDragHandler),n.off("mouseup",this._onUp),n.off("touchend",this._onUp),n.off("mousemove",this._onMove),n.off("touchmove",this._onMove),n.off("remove",this._clearFadeTimer),n._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(n){return this._lngLat=l.LngLat.convert(n),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(n){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),n){if(!("offset"in n.options)){const y=Math.sqrt(Math.pow(13.5,2)/2);n.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[y,-1*(24.6+y)],"bottom-right":[-y,-1*(24.6+y)],left:[13.5,-24.6],right:[-13.5,-24.6]}:this._offset}this._popup=n,n._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(n){const a=n.code,p=n.charCode||n.keyCode;"Space"!==a&&"Enter"!==a&&32!==p&&13!==p||this.togglePopup()}_onMapClick(n){const a=n.originalEvent.target,p=this._element;this._popup&&(a===p||p.contains(a))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const n=this._popup;return n?(n.isOpen()?(n.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(n.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const n=this._map,a=this._pos;if(!n||!a)return!1;const p=n.unproject(a),y=n.getFreeCameraOptions();if(!y.position)return!1;const x=y.position.toLngLat();return x.distanceTo(p)<.9*x.distanceTo(this._lngLat)}_evaluateOpacity(){const n=this._map;if(!n)return;const a=this._pos;if(!a||a.x<0||a.x>n.transform.width||a.y<0||a.y>n.transform.height)return void this._clearFadeTimer();const p=n.unproject(a);let y;n._showingGlobe()&&l.isLngLatBehindGlobe(n.transform,this._lngLat)?y=0:(y=1-n._queryFogOpacity(p),n.transform._terrainEnabled()&&n.getTerrain()&&this._behindTerrain()&&(y*=this._occludedOpacity)),this._element.style.opacity=`${y}`,this._element.style.pointerEvents=y>0?"auto":"none",this._popup&&this._popup._setOpacity(y),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const n=this._pos;if(!n||!this._map)return;const a=this._offset.mult(this._scale);this._element.style.transform=`\n            translate(${n.x}px,${n.y}px)\n            ${ra[this._anchor]}\n            ${this._calculateXYTransform()} ${this._calculateZTransform()}\n            translate(${a.x}px,${a.y}px)\n        `}_calculateXYTransform(){const n=this._pos,a=this._map,p=this.getPitchAlignment();if(!a||!n||"map"!==p)return"";if(!a._showingGlobe()){const R=a.getPitch();return R?`rotateX(${R}deg)`:""}const y=l.radToDeg(l.globeTiltAtLngLat(a.transform,this._lngLat)),x=n.sub(l.globeCenterToScreenPoint(a.transform)),D=Math.abs(x.x)+Math.abs(x.y);if(0===D)return"";const I=y/D;return`rotateX(${-x.y*I}deg) rotateY(${x.x*I}deg)`}_calculateZTransform(){const n=this._pos,a=this._map;if(!a||!n)return"";let p=0;const y=this.getRotationAlignment();if("map"===y)if(a._showingGlobe()){const x=a.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),D=a.project(new l.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(x);p=l.radToDeg(Math.atan2(D.y,D.x))-90}else p=-a.getBearing();else if("horizon"===y){const x=l.smoothstep(4,6,a.getZoom()),D=l.globeCenterToScreenPoint(a.transform);D.y+=x*a.transform.height;const I=n.sub(D),R=l.radToDeg(Math.atan2(I.y,I.x));p=(R>90?R-270:R+90)*(1-x)}return p+=this._rotation,p?`rotateZ(${p}deg)`:""}_update(n){l.window.cancelAnimationFrame(this._updateFrameId);const a=this._map;a&&(a.transform.renderWorldCopies&&(this._lngLat=dl(this._lngLat,this._pos,a.transform)),this._pos=a.project(this._lngLat),!0===n?this._updateFrameId=l.window.requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),a._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(a._showingGlobe()||a.getTerrain()||a.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(n){return this._offset=l.Point.convert(n),this._update(),this}_onMove(n){const a=this._map;if(!a)return;const p=this._pointerdownPos,y=this._positionDelta;if(p&&y){if(!this._isDragging){const x=this._clickTolerance||a._clickTolerance;if(n.point.dist(p)<x)return;this._isDragging=!0}this._pos=n.point.sub(y),this._lngLat=a.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none","pending"===this._state&&(this._state="active",this.fire(new l.Event("dragstart"))),this.fire(new l.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const n=this._map;n&&(n.off("mousemove",this._onMove),n.off("touchmove",this._onMove)),"active"===this._state&&this.fire(new l.Event("dragend")),this._state="inactive"}_addDragHandler(n){const a=this._map,p=this._pos;a&&p&&this._element.contains(n.originalEvent.target)&&(n.preventDefault(),this._positionDelta=n.point.sub(p),this._pointerdownPos=n.point,this._state="pending",a.on("mousemove",this._onMove),a.on("touchmove",this._onMove),a.once("mouseup",this._onUp),a.once("touchend",this._onUp))}setDraggable(n){this._draggable=!!n;const a=this._map;return a&&(n?(a.on("mousedown",this._addDragHandler),a.on("touchstart",this._addDragHandler)):(a.off("mousedown",this._addDragHandler),a.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(n){return this._rotation=n||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(n){return this._rotationAlignment=n||"auto",this._update(),this}getRotationAlignment(){return"auto"===this._rotationAlignment||"horizon"===this._rotationAlignment&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(n){return this._pitchAlignment=n||"auto",this._update(),this}getPitchAlignment(){return"auto"===this._pitchAlignment?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(n){return this._occludedOpacity=n||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const nc={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Yc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Ru(u=new l.Point(0,0),n="bottom"){if("number"==typeof u){const a=Math.round(Math.sqrt(.5*Math.pow(u,2)));switch(n){case"top":return new l.Point(0,u);case"top-left":return new l.Point(a,a);case"top-right":return new l.Point(-a,a);case"bottom":return new l.Point(0,-u);case"bottom-left":return new l.Point(a,-a);case"bottom-right":return new l.Point(-a,-a);case"left":return new l.Point(u,0);case"right":return new l.Point(-u,0)}return new l.Point(0,0)}return u instanceof l.Point||Array.isArray(u)?l.Point.convert(u):l.Point.convert(u[n]||[0,0])}class Jc{constructor(n){this.jumpTo(n)}getValue(n){if(n<=this._startTime)return this._start;if(n>=this._endTime)return this._end;const a=l.easeCubicInOut((n-this._startTime)/(this._endTime-this._startTime));return this._start*(1-a)+this._end*a}isEasing(n){return n>=this._startTime&&n<=this._endTime}jumpTo(n){this._startTime=-1/0,this._endTime=-1/0,this._start=n,this._end=n}easeTo(n,a,p){this._start=this.getValue(a),this._end=n,this._startTime=a,this._endTime=a+p}}const Kc={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use \u2318 + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},ns={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},qa={showCompass:!0,showZoom:!0,visualizePitch:!1};class Dd{constructor(n,a,p=!1){this._clickTolerance=10,this.element=a,this.mouseRotate=new Lo({clickTolerance:n.dragRotate._mouseRotate._clickTolerance}),this.map=n,p&&(this.mousePitch=new Gc({clickTolerance:n.dragRotate._mousePitch._clickTolerance})),l.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),a.addEventListener("mousedown",this.mousedown),a.addEventListener("touchstart",this.touchstart,{passive:!1}),a.addEventListener("touchmove",this.touchmove),a.addEventListener("touchend",this.touchend),a.addEventListener("touchcancel",this.reset)}down(n,a){this.mouseRotate.mousedown(n,a),this.mousePitch&&this.mousePitch.mousedown(n,a),Me()}move(n,a){const p=this.map,y=this.mouseRotate.mousemoveWindow(n,a),x=y&&y.bearingDelta;if(x&&p.setBearing(p.getBearing()+x),this.mousePitch){const D=this.mousePitch.mousemoveWindow(n,a),I=D&&D.pitchDelta;I&&p.setPitch(p.getPitch()+I)}}off(){const n=this.element;n.removeEventListener("mousedown",this.mousedown),n.removeEventListener("touchstart",this.touchstart,{passive:!1}),n.removeEventListener("touchmove",this.touchmove),n.removeEventListener("touchend",this.touchend),n.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){de(),l.window.removeEventListener("mousemove",this.mousemove),l.window.removeEventListener("mouseup",this.mouseup)}mousedown(n){this.down(l.extend({},n,{ctrlKey:!0,preventDefault:()=>n.preventDefault()}),oe(this.element,n)),l.window.addEventListener("mousemove",this.mousemove),l.window.addEventListener("mouseup",this.mouseup)}mousemove(n){this.move(n,oe(this.element,n))}mouseup(n){this.mouseRotate.mouseupWindow(n),this.mousePitch&&this.mousePitch.mouseupWindow(n),this.offTemp()}touchstart(n){1!==n.targetTouches.length?this.reset():(this._startPos=this._lastPos=xe(this.element,n.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>n.preventDefault()},this._startPos))}touchmove(n){1!==n.targetTouches.length?this.reset():(this._lastPos=xe(this.element,n.targetTouches)[0],this.move({preventDefault:()=>n.preventDefault()},this._lastPos))}touchend(n){0===n.targetTouches.length&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const oa={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},va={maxWidth:100,unit:"metric"},Lu={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},S={version:l.version,supported:Y,setRTLTextPlugin:l.setRTLTextPlugin,getRTLTextPluginStatus:l.getRTLTextPluginStatus,Map:class extends gr{constructor(u){if(l.LivePerformanceUtils.mark(l.PerformanceMarkers.create),null!=(u=l.extend({},ns,u)).minZoom&&null!=u.maxZoom&&u.minZoom>u.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(null!=u.minPitch&&null!=u.maxPitch&&u.minPitch>u.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(null!=u.minPitch&&u.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(null!=u.maxPitch&&u.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(u.antialias&&l.isSafariWithAntialiasingBug(l.window)&&(u.antialias=!1,l.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new ao(u.minZoom,u.maxZoom,u.minPitch,u.maxPitch,u.renderWorldCopies),u),this._interactive=u.interactive,this._minTileCacheSize=u.minTileCacheSize,this._maxTileCacheSize=u.maxTileCacheSize,this._failIfMajorPerformanceCaveat=u.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=u.preserveDrawingBuffer,this._antialias=u.antialias,this._useWebGL2=u.useWebGL2,this._trackResize=u.trackResize,this._bearingSnap=u.bearingSnap,this._refreshExpiredTiles=u.refreshExpiredTiles,this._fadeDuration=u.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=u.crossSourceCollisions,this._collectResourceTiming=u.collectResourceTiming,this._optimizeForTerrain=u.optimizeForTerrain,this._language=this._parseLanguage(u.language),this._worldview=u.worldview,this._renderTaskQueue=new Nr,this._domRenderTaskQueue=new Nr,this._controls=[],this._markers=[],this._popups=[],this._mapId=l.uniqueId(),this._locale=l.extend({},Kc,u.locale),this._clickTolerance=u.clickTolerance,this._cooperativeGestures=u.cooperativeGestures,this._performanceMetricsCollection=u.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new Jc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new l.RequestManager(u.transformRequest,u.accessToken,u.testMode),this._silenceAuthErrors=!!u.testMode,"string"==typeof u.container){if(this._container=l.window.document.getElementById(u.container),!this._container)throw new Error(`Container '${u.container}' not found.`)}else{if(!(u.container instanceof l.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=u.container}if(this._container.childNodes.length>0&&l.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),u.maxBounds&&this.setMaxBounds(u.maxBounds),l.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),void 0===this.painter)throw new Error("Failed to initialize WebGL.");this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),void 0!==l.window&&(l.window.addEventListener("online",this._onWindowOnline,!1),l.window.addEventListener("resize",this._onWindowResize,!1),l.window.addEventListener("orientationchange",this._onWindowResize,!1),l.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Ma(this,u),this._localFontFamily=u.localFontFamily,this._localIdeographFontFamily=u.localIdeographFontFamily,u.style&&this.setStyle(u.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),u.projection&&this.setProjection(u.projection),this._hash=u.hash&&new Ts("string"==typeof u.hash&&u.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:u.center,zoom:u.zoom,bearing:u.bearing,pitch:u.pitch}),u.bounds&&(this.resize(),this.fitBounds(u.bounds,l.extend({},u.fitBoundsOptions,{duration:0})))),this.resize(),u.attributionControl&&this.addControl(new hi({customAttribution:u.customAttribution})),this._logoControl=new tc,this.addControl(this._logoControl,u.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",n=>{this._update("style"===n.dataType),this.fire(new l.Event(`${n.dataType}data`,n))}),this.on("dataloading",n=>{this.fire(new l.Event(`${n.dataType}dataloading`,n))})}_getMapId(){return this._mapId}addControl(u,n){if(void 0===n&&(n=u.getDefaultPosition?u.getDefaultPosition():"top-right"),!u||!u.onAdd)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const a=u.onAdd(this);this._controls.push(u);const p=this._controlPositions[n];return-1!==n.indexOf("bottom")?p.insertBefore(a,p.firstChild):p.appendChild(a),this}removeControl(u){if(!u||!u.onRemove)return this.fire(new l.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const n=this._controls.indexOf(u);return n>-1&&this._controls.splice(n,1),u.onRemove(this),this}hasControl(u){return this._controls.indexOf(u)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(u){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const n=!this._moving;return n&&this.fire(new l.Event("movestart",u)).fire(new l.Event("move",u)),this.fire(new l.Event("resize",u)),n&&this.fire(new l.Event("moveend",u)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(u){return this.transform.setMaxBounds(l.LngLatBounds.convert(u)),this._update()}setMinZoom(u){if((u=u??-2)>=-2&&u<=this.transform.maxZoom)return this.transform.minZoom=u,this._update(),this.getZoom()<u?this.setZoom(u):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(u){if((u=u??22)>=this.transform.minZoom)return this.transform.maxZoom=u,this._update(),this.getZoom()>u?this.setZoom(u):this.fire(new l.Event("zoomstart")).fire(new l.Event("zoom")).fire(new l.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(u){if((u=u??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(u>=0&&u<=this.transform.maxPitch)return this.transform.minPitch=u,this._update(),this.getPitch()<u?this.setPitch(u):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(u){if((u=u??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(u>=this.transform.minPitch)return this.transform.maxPitch=u,this._update(),this.getPitch()>u?this.setPitch(u):this.fire(new l.Event("pitchstart")).fire(new l.Event("pitch")).fire(new l.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(u){return this.transform.renderWorldCopies=u,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(u){return"auto"===u?l.window.navigator.language:Array.isArray(u)?0===u.length?void 0:u.map(n=>"auto"===n?l.window.navigator.language:n):u}setLanguage(u){const n=this._parseLanguage(u);if(!this.style||n===this._language)return this;this._language=n,this.style._reloadSources();for(const a of this._controls)a._setLanguage&&a._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(u){return this.style&&u!==this._worldview?(this._worldview=u,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return"globe"===this.transform.projection.name}setProjection(u){return this._lazyInitEmptyStyle(),u?"string"==typeof u&&(u={name:u}):u=null,this._useExplicitProjection=!!u,this._prioritizeAndUpdateProjection(u,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if("globe"!==this.getProjection().name)return;const u=this.transform,n=u.projection.name;let a;"globe"===n&&u.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?(u.setMercatorFromTransition(),a=!0):"mercator"===n&&u.zoom<l.GLOBE_ZOOM_THRESHOLD_MAX&&(u.setProjection({name:"globe"}),a=!0),a&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(u,n){return this._updateProjection(u||n||{name:"mercator"})}_updateProjection(u){let n;if(n="globe"===u.name&&this.transform.zoom>=l.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(u),this.style.applyProjectionUpdate(),n){this.painter.clearBackgroundTiles();for(const a in this.style._sourceCaches)this.style._sourceCaches[a].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(u){return this.transform.locationPoint3D(l.LngLat.convert(u))}unproject(u){return this.transform.pointLocation3D(l.Point.convert(u))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(u,n,a){if("mouseenter"===u||"mouseover"===u){let p=!1;const y=D=>{const I=n.filter(U=>this.getLayer(U)),R=I.length?this.queryRenderedFeatures(D.point,{layers:I}):[];R.length?p||(p=!0,a.call(this,new Zr(u,this,D.originalEvent,{features:R}))):p=!1},x=()=>{p=!1};return{layers:new Set(n),listener:a,delegates:{mousemove:y,mouseout:x}}}if("mouseleave"===u||"mouseout"===u){let p=!1;const y=D=>{const I=n.filter(R=>this.getLayer(R));(I.length?this.queryRenderedFeatures(D.point,{layers:I}):[]).length?p=!0:p&&(p=!1,a.call(this,new Zr(u,this,D.originalEvent)))},x=D=>{p&&(p=!1,a.call(this,new Zr(u,this,D.originalEvent)))};return{layers:new Set(n),listener:a,delegates:{mousemove:y,mouseout:x}}}{const p=y=>{const x=n.filter(I=>this.getLayer(I)),D=x.length?this.queryRenderedFeatures(y.point,{layers:x}):[];D.length&&(y.features=D,a.call(this,y),delete y.features)};return{layers:new Set(n),listener:a,delegates:{[u]:p}}}}on(u,n,a){if(void 0===a)return super.on(u,n);Array.isArray(n)||(n=[n]);const p=this._createDelegatedListener(u,n,a);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[u]=this._delegatedListeners[u]||[],this._delegatedListeners[u].push(p);for(const y in p.delegates)this.on(y,p.delegates[y]);return this}once(u,n,a){if(void 0===a)return super.once(u,n);Array.isArray(n)||(n=[n]);const p=this._createDelegatedListener(u,n,a);for(const y in p.delegates)this.once(y,p.delegates[y]);return this}off(u,n,a){if(void 0===a)return super.off(u,n);n=new Set(Array.isArray(n)?n:[n]);const p=(x,D)=>{if(x.size!==D.size)return!1;for(const I of x)if(!D.has(I))return!1;return!0},y=this._delegatedListeners?this._delegatedListeners[u]:void 0;return y&&(x=>{for(let D=0;D<x.length;D++){const I=x[D];if(I.listener===a&&p(I.layers,n)){for(const R in I.delegates)this.off(R,I.delegates[R]);return x.splice(D,1),this}}})(y),this}queryRenderedFeatures(u,n){return this.style?(void 0!==n||void 0===u||u instanceof l.Point||Array.isArray(u)||(n=u,u=void 0),this.style.queryRenderedFeatures(u=u||[[0,0],[this.transform.width,this.transform.height]],n=n||{},this.transform)):[]}querySourceFeatures(u,n){return this.style.querySourceFeatures(u,n)}isPointOnSurface(u){const{name:n}=this.transform.projection;return"globe"!==n&&"mercator"!==n&&l.warnOnce(`${n} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(l.Point.convert(u))}setStyle(u,n){return!1!==(n=l.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},n)).diff&&n.localIdeographFontFamily===this._localIdeographFontFamily&&n.localFontFamily===this._localFontFamily&&this.style&&u?(this._diffStyle(u,n),this):(this._localIdeographFontFamily=n.localIdeographFontFamily,this._localFontFamily=n.localFontFamily,this._updateStyle(u,n))}_getUIString(u){const n=this._locale[u];if(null==n)throw new Error(`Missing UI string '${u}'`);return n}_updateStyle(u,n){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),u&&(this.style=new to(this,n||{}),this.style.setEventedParent(this,{style:this.style}),"string"==typeof u?this.style.loadURL(u):this.style.loadJSON(u)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new to(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(u,n){if("string"==typeof u){const a=this._requestManager.normalizeStyleURL(u),p=this._requestManager.transformRequest(a,l.ResourceType.Style);l.getJSON(p,(y,x)=>{y?this.fire(new l.ErrorEvent(y)):x&&this._updateDiff(x,n)})}else"object"==typeof u&&this._updateDiff(u,n)}_updateDiff(u,n){try{this.style.setState(u)&&this._update(!0)}catch(a){l.warnOnce(`Unable to perform style diff: ${a.message||a.error||a}.  Rebuilding the style from scratch.`),this._updateStyle(u,n)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(l.warnOnce("There is no style added to the map."),!1)}addSource(u,n){return this._lazyInitEmptyStyle(),this.style.addSource(u,n),this._update(!0)}isSourceLoaded(u){return!!this.style&&this.style._isSourceCacheLoaded(u)}areTilesLoaded(){const u=this.style&&this.style._sourceCaches;for(const n in u){const a=u[n]._tiles;for(const p in a){const y=a[p];if("loaded"!==y.state&&"errored"!==y.state)return!1}}return!0}addSourceType(u,n,a){this._lazyInitEmptyStyle(),this.style.addSourceType(u,n,a)}removeSource(u){return this.style.removeSource(u),this._updateTerrain(),this._update(!0)}getSource(u){return this.style.getSource(u)}addImage(u,n,{pixelRatio:a=1,sdf:p=!1,stretchX:y,stretchY:x,content:D}={}){if(this._lazyInitEmptyStyle(),n instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&n instanceof l.window.ImageBitmap){const{width:I,height:R,data:U}=l.exported.getImageData(n);this.style.addImage(u,{data:new l.RGBAImage({width:I,height:R},U),pixelRatio:a,stretchX:y,stretchY:x,content:D,sdf:p,version:0})}else if(void 0===n.width||void 0===n.height)this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:I,height:R}=n,U=n;this.style.addImage(u,{data:new l.RGBAImage({width:I,height:R},new Uint8Array(U.data)),pixelRatio:a,stretchX:y,stretchY:x,content:D,sdf:p,version:0,userImage:U}),U.onAdd&&U.onAdd(this,u)}}updateImage(u,n){const a=this.style.getImage(u);if(!a)return void this.fire(new l.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const p=n instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&n instanceof l.window.ImageBitmap?l.exported.getImageData(n):n,{width:y,height:x}=p;void 0!==y&&void 0!==x?y===a.data.width&&x===a.data.height?(a.data.replace(p.data,!(n instanceof l.window.HTMLImageElement||l.window.ImageBitmap&&n instanceof l.window.ImageBitmap)),this.style.updateImage(u,a)):this.fire(new l.ErrorEvent(new Error(`The width and height of the updated image (${y}, ${x})\n                must be that same as the previous version of the image\n                (${a.data.width}, ${a.data.height})`))):this.fire(new l.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(u){return u?!!this.style.getImage(u):(this.fire(new l.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(u){this.style.removeImage(u)}loadImage(u,n){l.getImage(this._requestManager.transformRequest(u,l.ResourceType.Image),(a,p)=>{n(a,p instanceof l.window.HTMLImageElement?l.exported.getImageData(p):p)})}listImages(){return this.style.listImages()}addLayer(u,n){return this._lazyInitEmptyStyle(),this.style.addLayer(u,n),this._update(!0)}moveLayer(u,n){return this.style.moveLayer(u,n),this._update(!0)}removeLayer(u){return this.style.removeLayer(u),this._update(!0)}getLayer(u){return this.style.getLayer(u)}setLayerZoomRange(u,n,a){return this.style.setLayerZoomRange(u,n,a),this._update(!0)}setFilter(u,n,a={}){return this.style.setFilter(u,n,a),this._update(!0)}getFilter(u){return this.style.getFilter(u)}setPaintProperty(u,n,a,p={}){return this.style.setPaintProperty(u,n,a,p),this._update(!0)}getPaintProperty(u,n){return this.style.getPaintProperty(u,n)}setLayoutProperty(u,n,a,p={}){return this.style.setLayoutProperty(u,n,a,p),this._update(!0)}getLayoutProperty(u,n){return this.style.getLayoutProperty(u,n)}setLight(u,n={}){return this._lazyInitEmptyStyle(),this.style.setLight(u,n),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(u){return this._lazyInitEmptyStyle(),!u&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(u),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(u){return this._lazyInitEmptyStyle(),this.style.setFog(u),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(u){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(l.LngLat.convert(u),this.transform):0}setFeatureState(u,n){return this.style.setFeatureState(u,n),this._update()}removeFeatureState(u,n){return this.style.removeFeatureState(u,n),this._update()}getFeatureState(u){return this.style.getFeatureState(u)}_updateContainerDimensions(){if(!this._container)return;const u=this._container.getBoundingClientRect().width||400,n=this._container.getBoundingClientRect().height||300;let a,p,y,x=this._container;for(;x&&(!p||!y);){const D=l.window.getComputedStyle(x).transform;D&&"none"!==D&&(a=D.match(/matrix.*\((.+)\)/)[1].split(", "),a[0]&&"0"!==a[0]&&"1"!==a[0]&&(p=a[0]),a[3]&&"0"!==a[3]&&"1"!==a[3]&&(y=a[3])),x=x.parentElement}this._containerWidth=p?Math.abs(u/p):u,this._containerHeight=y?Math.abs(n/y):n}_detectMissingCSS(){"rgb(250, 128, 114)"!==l.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")&&l.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const u=this._container;u.classList.add("mapboxgl-map"),(this._missingCSSCanary=fe("div","mapboxgl-canary",u)).style.visibility="hidden",this._detectMissingCSS();const n=this._canvasContainer=fe("div","mapboxgl-canvas-container",u);this._interactive&&n.classList.add("mapboxgl-interactive"),this._canvas=fe("canvas","mapboxgl-canvas",n),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const a=this._controlContainer=fe("div","mapboxgl-control-container",u),p=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(y=>{p[y]=fe("div",`mapboxgl-ctrl-${y}`,a)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(u,n){const a=l.exported.devicePixelRatio||1;this._canvas.width=a*Math.ceil(u),this._canvas.height=a*Math.ceil(n),this._canvas.style.width=`${u}px`,this._canvas.style.height=`${n}px`}_addMarker(u){this._markers.push(u)}_removeMarker(u){const n=this._markers.indexOf(u);-1!==n&&this._markers.splice(n,1)}_addPopup(u){this._popups.push(u)}_removePopup(u){const n=this._popups.indexOf(u);-1!==n&&this._popups.splice(n,1)}_setupPainter(){const u=l.extend({},Y.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),n=this._useWebGL2&&this._canvas.getContext("webgl2",u),a=n||this._canvas.getContext("webgl",u)||this._canvas.getContext("experimental-webgl",u);a?(this._useWebGL2&&!n&&l.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),l.storeAuthState(a,!0),this.painter=new le(a,this.transform,!!n),this.on("data",p=>{"source"===p.dataType&&this.painter.setTileLoadedFlag(!0)}),l.exported$1.testSupport(a)):this.fire(new l.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(u){u.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new l.Event("webglcontextlost",{originalEvent:u}))}_contextRestored(u){this._setupPainter(),this.resize(),this._update(),this.fire(new l.Event("webglcontextrestored",{originalEvent:u}))}_onMapScroll(u){if(u.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(u){return this.style?(this._styleDirty=this._styleDirty||u,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(u){return this._update(),this._renderTaskQueue.add(u)}_cancelRenderFrame(u){this._renderTaskQueue.remove(u)}_requestDomTask(u){!this.loaded()||this.loaded()&&!this.isMoving()?u():this._domRenderTaskQueue.add(u)}_render(u){let n;const a=this.painter.context.extTimerQuery,p=l.exported.now();if(this.listens("gpu-timing-frame")&&(n=a.createQueryEXT(),a.beginQueryEXT(a.TIME_ELAPSED_EXT,n)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],l.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],l.window.performance.now())),this._renderTaskQueue.run(u),this._domRenderTaskQueue.run(u),this._removed)return;this._updateProjectionTransition();const y=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const I=this.transform.zoom,R=this.transform.pitch,U=l.exported.now(),z=new l.EvaluationParameters(I,{now:U,fadeDuration:y,pitch:R,transition:this.style.getTransition()});this.style.update(z)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let x=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),x=this._updateAverageElevation(p),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):x=this._updateAverageElevation(p),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,y,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:y,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new l.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new l.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),n){const I=l.exported.now()-p;a.endQueryEXT(a.TIME_ELAPSED_EXT,n),setTimeout(()=>{const R=a.getQueryObjectEXT(n,a.QUERY_RESULT_EXT)/1e6;a.deleteQueryEXT(n),this.fire(new l.Event("gpu-timing-frame",{cpuTime:I,gpuTime:R})),l.window.performance.mark("frame-gpu",{startTime:p,detail:{gpuTime:R}})},50)}if(this.listens("gpu-timing-layer")){const I=this.painter.collectGpuTimers();setTimeout(()=>{const R=this.painter.queryGpuTimers(I);this.fire(new l.Event("gpu-timing-layer",{layerTimes:R}))},50)}if(this.listens("gpu-timing-deferred-render")){const I=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const R=this.painter.queryGpuTimeDeferredRender(I);this.fire(new l.Event("gpu-timing-deferred-render",{gpuTime:R}))},50)}const D=this._sourcesDirty||this._styleDirty||this._placementDirty||x;if(D||this._repaint)this.triggerRepaint();else{const I=!this.isMoving()&&this.loaded();if(I&&(x=this._updateAverageElevation(p,!0)),x)this.triggerRepaint();else if(this._triggerFrame(!1),I&&(this.fire(new l.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const R=this._calculateSpeedIndex();this.fire(new l.Event("speedindexcompleted",{speedIndex:R})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||D||(this._fullyLoaded=!0,l.LivePerformanceUtils.mark(l.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&l.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(u){for(const n of this._markers)u&&!this.getRenderWorldCopies()&&(n._lngLat=n._lngLat.wrap()),n._update();for(const n of this._popups)!u||this.getRenderWorldCopies()||n._trackPointer||(n._lngLat=n._lngLat.wrap()),n._update()}_updateAverageElevation(u,n=!1){const a=p=>(this.transform.averageElevation=p,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return 0!==this.transform.averageElevation&&a(0);if((n||u-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(u)){const p=this.transform.averageElevation;let y=this.transform.sampleAverageElevation(),x=!1;this.transform.elevation&&(x=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(y)?y=0:this._averageElevationLastSampledAt=u;const D=Math.abs(p-y);if(D>1){if(this._isInitialLoad||x)return this._averageElevation.jumpTo(y),a(y);this._averageElevation.easeTo(y,u,300)}else if(D>1e-4)return this._averageElevation.jumpTo(y),a(y)}return!!this._averageElevation.isEasing(u)&&a(this._averageElevation.getValue(u))}_authenticate(){l.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,u=>{if(u&&(u.message===l.AUTH_ERR_MSG||401===u.status)){const n=this.painter.context.gl;l.storeAuthState(n,!1),this._logoControl instanceof tc&&this._logoControl._updateLogo(),n&&n.clear(n.DEPTH_BUFFER_BIT|n.COLOR_BUFFER_BIT|n.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new l.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),l.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_updateTerrain(){const u=this._isDragging();this.painter.updateTerrain(this.style,u)}_calculateSpeedIndex(){const u=this.painter.canvasCopy(),n=this.painter.getCanvasCopiesAndTimestamps();n.timeStamps.push(performance.now());const a=this.painter.context.gl,p=a.createFramebuffer();function y(x){a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,x,0);const D=new Uint8Array(a.drawingBufferWidth*a.drawingBufferHeight*4);return a.readPixels(0,0,a.drawingBufferWidth,a.drawingBufferHeight,a.RGBA,a.UNSIGNED_BYTE,D),D}return a.bindFramebuffer(a.FRAMEBUFFER,p),this._canvasPixelComparison(y(u),n.canvasCopies.map(y),n.timeStamps)}_canvasPixelComparison(u,n,a){let p=a[1]-a[0];const y=u.length/4;for(let x=0;x<n.length;x++){const D=n[x];let I=0;for(let R=0;R<D.length;R+=4)D[R]===u[R]&&D[R+1]===u[R+1]&&D[R+2]===u[R+2]&&D[R+3]===u[R+3]&&(I+=1);p+=(a[x+2]-a[x+1])*(1-I/y)}return p}remove(){this._hash&&this._hash.remove();for(const n of this._controls)n.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),void 0!==l.window&&(l.window.removeEventListener("resize",this._onWindowResize,!1),l.window.removeEventListener("orientationchange",this._onWindowResize,!1),l.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),l.window.removeEventListener("online",this._onWindowOnline,!1),l.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const u=this.painter.context.gl.getExtension("WEBGL_lose_context");u&&u.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),l.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new l.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(u){this._renderNextFrame=this._renderNextFrame||u,this.style&&!this._frame&&(this._frame=l.exported.frame(n=>{const a=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,a&&this._render(n)}))}_preloadTiles(u){const n=this.style?Object.values(this.style._sourceCaches):[];return l.asyncAll(n,(a,p)=>a._preloadTiles(u,p),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(u){this._trackResize&&this.resize({originalEvent:u})._update()}_onVisibilityChange(){"hidden"===l.window.document.visibilityState&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(u){this._showTileBoundaries!==u&&(this._showTileBoundaries=u,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(u){this._showTerrainWireframe!==u&&(this._showTerrainWireframe=u,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(u){this._speedIndexTiming!==u&&(this._speedIndexTiming=u,this._update())}get showPadding(){return!!this._showPadding}set showPadding(u){this._showPadding!==u&&(this._showPadding=u,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(u){this._showCollisionBoxes!==u&&(this._showCollisionBoxes=u,u?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(u){this._showOverdrawInspector!==u&&(this._showOverdrawInspector=u,this._update())}get repaint(){return!!this._repaint}set repaint(u){this._repaint!==u&&(this._repaint=u,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(u){this._vertices=u,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(u){this._showTileAABBs!==u&&(this._showTileAABBs=u,u&&this._update())}_setCacheLimits(u,n){l.setCacheLimits(u,n)}get version(){return l.version}},NavigationControl:class{constructor(u){this.options=l.extend({},qa,u),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",n=>n.preventDefault()),this.options.showZoom&&(l.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",n=>{this._map&&this._map.zoomIn({},{originalEvent:n})}),fe("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",n=>{this._map&&this._map.zoomOut({},{originalEvent:n})}),fe("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(l.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",n=>{const a=this._map;a&&(this.options.visualizePitch?a.resetNorthPitch({},{originalEvent:n}):a.resetNorth({},{originalEvent:n}))}),this._compassIcon=fe("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const u=this._map;if(!u)return;const n=u.getZoom(),a=n===u.getMaxZoom(),p=n===u.getMinZoom();this._zoomInButton.disabled=a,this._zoomOutButton.disabled=p,this._zoomInButton.setAttribute("aria-disabled",a.toString()),this._zoomOutButton.setAttribute("aria-disabled",p.toString())}_rotateCompassArrow(){const u=this._map;if(!u)return;const n=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(u.transform.pitch*(Math.PI/180)),.5)}) rotateX(${u.transform.pitch}deg) rotateZ(${u.transform.angle*(180/Math.PI)}deg)`:`rotate(${u.transform.angle*(180/Math.PI)}deg)`;u._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=n)})}onAdd(u){return this._map=u,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),u.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&u.on("pitch",this._rotateCompassArrow),u.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Dd(u,this._compass,this.options.visualizePitch)),this._container}onRemove(){const u=this._map;u&&(this._container.remove(),this.options.showZoom&&u.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&u.off("pitch",this._rotateCompassArrow),u.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(u,n){const a=fe("button",u,this._container);return a.type="button",a.addEventListener("click",n),a}_setButtonTitle(u,n){if(!this._map)return;const a=this._map._getUIString(`NavigationControl.${n}`);u.setAttribute("aria-label",a),u.firstElementChild&&u.firstElementChild.setAttribute("title",a)}},GeolocateControl:class extends l.Evented{constructor(u){super(),this.options=l.extend({geolocation:l.window.navigator.geolocation},oa,u),l.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=Es(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(u){return this._map=u,this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){void 0!==this._geolocationWatchID&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(u){const n=(a=!!this.options.geolocation)=>{this._supportsGeolocation=a,u(a)};void 0!==this._supportsGeolocation?u(this._supportsGeolocation):void 0!==l.window.navigator.permissions?l.window.navigator.permissions.query({name:"geolocation"}).then(a=>n("denied"!==a.state)).catch(()=>n()):n()}_isOutOfMapMaxBounds(u){const n=this._map.getMaxBounds(),a=u.coords;return!!n&&(a.longitude<n.getWest()||a.longitude>n.getEast()||a.latitude<n.getSouth()||a.latitude>n.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(u){if(this._map){if(this._isOutOfMapMaxBounds(u))return this._setErrorState(),this.fire(new l.Event("outofmaxbounds",u)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=u,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&"OFF"!==this._watchState&&this._updateMarker(u),this.options.trackUserLocation&&"ACTIVE_LOCK"!==this._watchState||this._updateCamera(u),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("geolocate",u)),this._finish()}}_updateCamera(u){const n=new l.LngLat(u.coords.longitude,u.coords.latitude),a=u.coords.accuracy,p=this._map.getBearing(),y=l.extend({bearing:p},this.options.fitBoundsOptions);this._map.fitBounds(n.toBounds(a),y,{geolocateSource:!0})}_updateMarker(u){if(u){const n=new l.LngLat(u.coords.longitude,u.coords.latitude);this._accuracyCircleMarker.setLngLat(n).addTo(this._map),this._userLocationDotMarker.setLngLat(n).addTo(this._map),this._accuracy=u.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const u=this._map.transform,n=l.mercatorZfromAltitude(1,u._center.lat)*u.worldSize,a=Math.ceil(2*this._accuracy*n);this._circleElement.style.width=`${a}px`,this._circleElement.style.height=`${a}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&"number"==typeof this._heading?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(u){if(this._map){if(this.options.trackUserLocation)if(1===u.code){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n),void 0!==this._geolocationWatchID&&this._clearWatch()}else{if(3===u.code&&this._noTimeout)return;this._setErrorState()}"OFF"!==this._watchState&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new l.Event("error",u)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(u){if(void 0!==this._map){if(this._container.addEventListener("contextmenu",n=>n.preventDefault()),this._geolocateButton=fe("button","mapboxgl-ctrl-geolocate",this._container),fe("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",!1===u){l.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const n=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}else{const n=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",n),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",n)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=fe("div","mapboxgl-user-location"),this._dotElement.appendChild(fe("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(fe("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new oi({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=fe("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new oi({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",n=>{n.geolocateSource||"ACTIVE_LOCK"!==this._watchState||n.originalEvent&&"resize"===n.originalEvent.type||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new l.Event("trackuserlocationend")))})}}_onDeviceOrientation(u){this._userLocationDotMarker&&(u.webkitCompassHeading?this._heading=u.webkitCompassHeading:!0===u.absolute&&(this._heading=-1*u.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return l.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new l.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new l.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new l.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if("OFF"===this._watchState&&void 0!==this._geolocationWatchID)this._clearWatch();else if(void 0===this._geolocationWatchID){let u;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(u={maximumAge:6e5,timeout:0},this._noTimeout=!0):(u=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,u),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const u=()=>{l.window.addEventListener("ondeviceorientationabsolute"in l.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};void 0!==l.window.DeviceMotionEvent&&"function"==typeof l.window.DeviceMotionEvent.requestPermission?DeviceOrientationEvent.requestPermission().then(n=>{"granted"===n&&u()}).catch(console.error):u()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),l.window.removeEventListener("deviceorientation",this._onDeviceOrientation),l.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:hi,ScaleControl:class{constructor(u){this.options=l.extend({},va,u),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),l.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const u=this.options.maxWidth||100,n=this._map,a=n._containerHeight/2,p=n._containerWidth/2-u/2,y=n.unproject([p,a]),x=n.unproject([p+u,a]),D=y.distanceTo(x);if("imperial"===this.options.unit){const I=3.2808*D;I>5280?this._setScale(u,I/5280,"mile"):this._setScale(u,I,"foot")}else"nautical"===this.options.unit?this._setScale(u,D/1852,"nautical-mile"):D>=1e3?this._setScale(u,D/1e3,"kilometer"):this._setScale(u,D,"meter")}_setScale(u,n,a){this._map._requestDomTask(()=>{const p=function(x){const D=Math.pow(10,`${Math.floor(x)}`.length-1);let I=x/D;return I=I>=10?10:I>=5?5:I>=3?3:I>=2?2:I>=1?1:function(R){const U=Math.pow(10,Math.ceil(-Math.log(R)/Math.LN10));return Math.round(R*U)/U}(I),D*I}(n),y=p/n;this._container.innerHTML=this._isNumberFormatSupported&&"nautical-mile"!==a?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:a}).format(p):`${p}&nbsp;${Lu[a]}`,this._container.style.width=u*y+"px"})}onAdd(u){return this._map=u,this._language=u.getLanguage(),this._container=fe("div","mapboxgl-ctrl mapboxgl-ctrl-scale",u.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(u){this._language=u,this._update()}setUnit(u){this.options.unit=u,this._update()}},FullscreenControl:class{constructor(u){this._fullscreen=!1,u&&u.container&&(u.container instanceof l.window.HTMLElement?this._container=u.container:l.warnOnce("Full screen control 'container' must be a DOM element.")),l.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in l.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in l.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(u){return this._map=u,this._container||(this._container=this._map.getContainer()),this._controlContainer=fe("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",l.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,l.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!l.window.document.fullscreenEnabled&&!l.window.document.webkitFullscreenEnabled)}_setupUI(){const u=this._fullscreenButton=fe("button","mapboxgl-ctrl-fullscreen",this._controlContainer);fe("span","mapboxgl-ctrl-icon",u).setAttribute("aria-hidden","true"),u.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),l.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const u=this._getTitle();this._fullscreenButton.setAttribute("aria-label",u),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",u)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(l.window.document.fullscreenElement||l.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?l.window.document.exitFullscreen?l.window.document.exitFullscreen():l.window.document.webkitCancelFullScreen&&l.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends l.Evented{constructor(u){super(),this.options=l.extend(Object.create(nc),u),l.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(u&&u.className?u.className.trim().split(/\s+/):[])}addTo(u){return this._map&&this.remove(),this._map=u,this.options.closeOnClick&&u.on("preclick",this._onClose),this.options.closeOnMove&&u.on("move",this._onClose),u.on("remove",this.remove),this._update(),u._addPopup(this),this._focusFirstElement(),this._trackPointer?(u.on("mousemove",this._onMouseEvent),u.on("mouseup",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")):u.on("move",this._update),this.fire(new l.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const u=this._map;return u&&(u.off("move",this._update),u.off("move",this._onClose),u.off("preclick",this._onClose),u.off("click",this._onClose),u.off("remove",this.remove),u.off("mousemove",this._onMouseEvent),u.off("mouseup",this._onMouseEvent),u.off("drag",this._onMouseEvent),u._canvasContainer&&u._canvasContainer.classList.remove("mapboxgl-track-pointer"),u._removePopup(this),this._map=void 0),this.fire(new l.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(u){this._lngLat=l.LngLat.convert(u),this._pos=null,this._trackPointer=!1,this._update();const n=this._map;return n&&(n.on("move",this._update),n.off("mousemove",this._onMouseEvent),n._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const u=this._map;return u&&(u.off("move",this._update),u.on("mousemove",this._onMouseEvent),u.on("drag",this._onMouseEvent),u._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(u){return this.setDOMContent(l.window.document.createTextNode(u))}setHTML(u){const n=l.window.document.createDocumentFragment(),a=l.window.document.createElement("body");let p;for(a.innerHTML=u;p=a.firstChild,p;)n.appendChild(p);return this.setDOMContent(n)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(u){return this.options.maxWidth=u,this._update(),this}setDOMContent(u){let n=this._content;if(n)for(;n.hasChildNodes();)n.firstChild&&n.removeChild(n.firstChild);else n=this._content=fe("div","mapboxgl-popup-content",this._container||void 0);if(n.appendChild(u),this.options.closeButton){const a=this._closeButton=fe("button","mapboxgl-popup-close-button",n);a.type="button",a.setAttribute("aria-label","Close popup"),a.setAttribute("aria-hidden","true"),a.innerHTML="&#215;",a.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(u){return this._classList.add(u),this._updateClassList(),this}removeClassName(u){return this._classList.delete(u),this._updateClassList(),this}setOffset(u){return this.options.offset=u,this._update(),this}toggleClassName(u){let n;return this._classList.delete(u)?n=!1:(this._classList.add(u),n=!0),this._updateClassList(),n}_onMouseEvent(u){this._update(u.point)}_getAnchor(u){if(this.options.anchor)return this.options.anchor;const n=this._map,a=this._container,p=this._pos;if(!n||!a||!p)return"bottom";const y=a.offsetWidth,x=a.offsetHeight,D=p.x<y/2,I=p.x>n.transform.width-y/2;if(p.y+u<x)return D?"top-left":I?"top-right":"top";if(p.y>n.transform.height-x){if(D)return"bottom-left";if(I)return"bottom-right"}return D?"left":I?"right":"bottom"}_updateClassList(){const u=this._container;if(!u)return;const n=[...this._classList];n.push("mapboxgl-popup"),this._anchor&&n.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&n.push("mapboxgl-popup-track-pointer"),u.className=n.join(" ")}_update(u){const n=this._map,a=this._content;if(!n||!this._lngLat&&!this._trackPointer||!a)return;let p=this._container;if(p||(p=this._container=fe("div","mapboxgl-popup",n.getContainer()),this._tip=fe("div","mapboxgl-popup-tip",p),p.appendChild(a)),this.options.maxWidth&&p.style.maxWidth!==this.options.maxWidth&&(p.style.maxWidth=this.options.maxWidth),n.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=dl(this._lngLat,this._pos,n.transform)),!this._trackPointer||u){const y=this._pos=this._trackPointer&&u?u:n.project(this._lngLat),x=Ru(this.options.offset),D=this._anchor=this._getAnchor(x.y),I=Ru(this.options.offset,D),R=y.add(I).round();n._requestDomTask(()=>{this._container&&D&&(this._container.style.transform=`${ra[D]} translate(${R.x}px,${R.y}px)`)})}if(!this._marker&&n._showingGlobe()){const y=l.isLngLatBehindGlobe(n.transform,this._lngLat)?0:1;this._setOpacity(y)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const u=this._container.querySelector(Yc);u&&u.focus()}_onClose(){this.remove()}_setOpacity(u){this._container&&(this._container.style.opacity=`${u}`),this._content&&(this._content.style.pointerEvents=u?"auto":"none")}},Marker:oi,Style:to,LngLat:l.LngLat,LngLatBounds:l.LngLatBounds,Point:l.Point,MercatorCoordinate:l.MercatorCoordinate,FreeCameraOptions:Jr,Evented:l.Evented,config:l.config,prewarm:function(){uo().acquire(mr)},clearPrewarmedResources:function(){const u=Ar;u&&(u.isPreloaded()&&1===u.numActive()?(u.release(mr),Ar=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return l.config.ACCESS_TOKEN},set accessToken(u){l.config.ACCESS_TOKEN=u},get baseApiUrl(){return l.config.API_URL},set baseApiUrl(u){l.config.API_URL=u},get workerCount(){return Xi.workerCount},set workerCount(u){Xi.workerCount=u},get maxParallelImageRequests(){return l.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(u){l.config.MAX_PARALLEL_IMAGE_REQUESTS=u},clearStorage(u){l.clearTileCache(u)},workerUrl:"",workerClass:null,setNow:l.exported.setNow,restoreNow:l.exported.restoreNow};return S}),h}()},5619:(Bn,Ct,P)=>{"use strict";P.d(Ct,{X:()=>m});var h=P(8645);class m extends h.x{constructor(l){super(),this._value=l}get value(){return this.getValue()}_subscribe(l){const B=super._subscribe(l);return!B.closed&&l.next(this._value),B}getValue(){const{hasError:l,thrownError:B,_value:Y}=this;if(l)throw B;return this._throwIfClosed(),Y}next(l){super.next(this._value=l)}}},5592:(Bn,Ct,P)=>{"use strict";P.d(Ct,{y:()=>ie});var h=P(305),m=P(7394),te=P(4850),l=P(8407),B=P(2653),Y=P(4674),C=P(1441);let ie=(()=>{class be{constructor(Me){Me&&(this._subscribe=Me)}lift(Me){const de=new be;return de.source=this,de.operator=Me,de}subscribe(Me,de,nt){const Ce=function K(be){return be&&be instanceof h.Lv||function Pe(be){return be&&(0,Y.m)(be.next)&&(0,Y.m)(be.error)&&(0,Y.m)(be.complete)}(be)&&(0,m.Nn)(be)}(Me)?Me:new h.Hp(Me,de,nt);return(0,C.x)(()=>{const{operator:oe,source:xe}=this;Ce.add(oe?oe.call(Ce,xe):xe?this._subscribe(Ce):this._trySubscribe(Ce))}),Ce}_trySubscribe(Me){try{return this._subscribe(Me)}catch(de){Me.error(de)}}forEach(Me,de){return new(de=fe(de))((nt,Ce)=>{const oe=new h.Hp({next:xe=>{try{Me(xe)}catch(Ie){Ce(Ie),oe.unsubscribe()}},error:Ce,complete:nt});this.subscribe(oe)})}_subscribe(Me){var de;return null===(de=this.source)||void 0===de?void 0:de.subscribe(Me)}[te.L](){return this}pipe(...Me){return(0,l.U)(Me)(this)}toPromise(Me){return new(Me=fe(Me))((de,nt)=>{let Ce;this.subscribe(oe=>Ce=oe,oe=>nt(oe),()=>de(Ce))})}}return be.create=Te=>new be(Te),be})();function fe(be){var Te;return null!==(Te=be??B.config.Promise)&&void 0!==Te?Te:Promise}},8645:(Bn,Ct,P)=>{"use strict";P.d(Ct,{x:()=>C});var h=P(5592),m=P(7394);const l=(0,P(2306).d)(fe=>function(){fe(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});var B=P(9039),Y=P(1441);let C=(()=>{class fe extends h.y{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(K){const be=new ie(this,this);return be.operator=K,be}_throwIfClosed(){if(this.closed)throw new l}next(K){(0,Y.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const be of this.currentObservers)be.next(K)}})}error(K){(0,Y.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=K;const{observers:be}=this;for(;be.length;)be.shift().error(K)}})}complete(){(0,Y.x)(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:K}=this;for(;K.length;)K.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var K;return(null===(K=this.observers)||void 0===K?void 0:K.length)>0}_trySubscribe(K){return this._throwIfClosed(),super._trySubscribe(K)}_subscribe(K){return this._throwIfClosed(),this._checkFinalizedStatuses(K),this._innerSubscribe(K)}_innerSubscribe(K){const{hasError:be,isStopped:Te,observers:Me}=this;return be||Te?m.Lc:(this.currentObservers=null,Me.push(K),new m.w0(()=>{this.currentObservers=null,(0,B.P)(Me,K)}))}_checkFinalizedStatuses(K){const{hasError:be,thrownError:Te,isStopped:Me}=this;be?K.error(Te):Me&&K.complete()}asObservable(){const K=new h.y;return K.source=this,K}}return fe.create=(Pe,K)=>new ie(Pe,K),fe})();class ie extends C{constructor(Pe,K){super(),this.destination=Pe,this.source=K}next(Pe){var K,be;null===(be=null===(K=this.destination)||void 0===K?void 0:K.next)||void 0===be||be.call(K,Pe)}error(Pe){var K,be;null===(be=null===(K=this.destination)||void 0===K?void 0:K.error)||void 0===be||be.call(K,Pe)}complete(){var Pe,K;null===(K=null===(Pe=this.destination)||void 0===Pe?void 0:Pe.complete)||void 0===K||K.call(Pe)}_subscribe(Pe){var K,be;return null!==(be=null===(K=this.source)||void 0===K?void 0:K.subscribe(Pe))&&void 0!==be?be:m.Lc}}},305:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Hp:()=>nt,Lv:()=>be});var h=P(4674),m=P(7394),te=P(2653),l=P(3894),B=P(2420);const Y=fe("C",void 0,void 0);function fe(Ae,ye,Ue){return{kind:Ae,value:ye,error:Ue}}var Pe=P(7599),K=P(1441);class be extends m.w0{constructor(ye){super(),this.isStopped=!1,ye?(this.destination=ye,(0,m.Nn)(ye)&&ye.add(this)):this.destination=Ie}static create(ye,Ue,ct){return new nt(ye,Ue,ct)}next(ye){this.isStopped?xe(function ie(Ae){return fe("N",Ae,void 0)}(ye),this):this._next(ye)}error(ye){this.isStopped?xe(function C(Ae){return fe("E",void 0,Ae)}(ye),this):(this.isStopped=!0,this._error(ye))}complete(){this.isStopped?xe(Y,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(ye){this.destination.next(ye)}_error(ye){try{this.destination.error(ye)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Te=Function.prototype.bind;function Me(Ae,ye){return Te.call(Ae,ye)}class de{constructor(ye){this.partialObserver=ye}next(ye){const{partialObserver:Ue}=this;if(Ue.next)try{Ue.next(ye)}catch(ct){Ce(ct)}}error(ye){const{partialObserver:Ue}=this;if(Ue.error)try{Ue.error(ye)}catch(ct){Ce(ct)}else Ce(ye)}complete(){const{partialObserver:ye}=this;if(ye.complete)try{ye.complete()}catch(Ue){Ce(Ue)}}}class nt extends be{constructor(ye,Ue,ct){let X;if(super(),(0,h.m)(ye)||!ye)X={next:ye??void 0,error:Ue??void 0,complete:ct??void 0};else{let ve;this&&te.config.useDeprecatedNextContext?(ve=Object.create(ye),ve.unsubscribe=()=>this.unsubscribe(),X={next:ye.next&&Me(ye.next,ve),error:ye.error&&Me(ye.error,ve),complete:ye.complete&&Me(ye.complete,ve)}):X=ye}this.destination=new de(X)}}function Ce(Ae){te.config.useDeprecatedSynchronousErrorHandling?(0,K.O)(Ae):(0,l.h)(Ae)}function xe(Ae,ye){const{onStoppedNotification:Ue}=te.config;Ue&&Pe.z.setTimeout(()=>Ue(Ae,ye))}const Ie={closed:!0,next:B.Z,error:function oe(Ae){throw Ae},complete:B.Z}},7394:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Lc:()=>Y,w0:()=>B,Nn:()=>C});var h=P(4674);const te=(0,P(2306).d)(fe=>function(K){fe(this),this.message=K?`${K.length} errors occurred during unsubscription:\n${K.map((be,Te)=>`${Te+1}) ${be.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=K});var l=P(9039);class B{constructor(Pe){this.initialTeardown=Pe,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let Pe;if(!this.closed){this.closed=!0;const{_parentage:K}=this;if(K)if(this._parentage=null,Array.isArray(K))for(const Me of K)Me.remove(this);else K.remove(this);const{initialTeardown:be}=this;if((0,h.m)(be))try{be()}catch(Me){Pe=Me instanceof te?Me.errors:[Me]}const{_finalizers:Te}=this;if(Te){this._finalizers=null;for(const Me of Te)try{ie(Me)}catch(de){Pe=Pe??[],de instanceof te?Pe=[...Pe,...de.errors]:Pe.push(de)}}if(Pe)throw new te(Pe)}}add(Pe){var K;if(Pe&&Pe!==this)if(this.closed)ie(Pe);else{if(Pe instanceof B){if(Pe.closed||Pe._hasParent(this))return;Pe._addParent(this)}(this._finalizers=null!==(K=this._finalizers)&&void 0!==K?K:[]).push(Pe)}}_hasParent(Pe){const{_parentage:K}=this;return K===Pe||Array.isArray(K)&&K.includes(Pe)}_addParent(Pe){const{_parentage:K}=this;this._parentage=Array.isArray(K)?(K.push(Pe),K):K?[K,Pe]:Pe}_removeParent(Pe){const{_parentage:K}=this;K===Pe?this._parentage=null:Array.isArray(K)&&(0,l.P)(K,Pe)}remove(Pe){const{_finalizers:K}=this;K&&(0,l.P)(K,Pe),Pe instanceof B&&Pe._removeParent(this)}}B.EMPTY=(()=>{const fe=new B;return fe.closed=!0,fe})();const Y=B.EMPTY;function C(fe){return fe instanceof B||fe&&"closed"in fe&&(0,h.m)(fe.remove)&&(0,h.m)(fe.add)&&(0,h.m)(fe.unsubscribe)}function ie(fe){(0,h.m)(fe)?fe():fe.unsubscribe()}},2653:(Bn,Ct,P)=>{"use strict";P.d(Ct,{config:()=>h});const h={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1}},2572:(Bn,Ct,P)=>{"use strict";P.d(Ct,{a:()=>Pe});var h=P(5592),m=P(7453),te=P(7715),l=P(2737),B=P(7400),Y=P(4564),C=P(2714),ie=P(8251),fe=P(7103);function Pe(...Te){const Me=(0,Y.yG)(Te),de=(0,Y.jO)(Te),{args:nt,keys:Ce}=(0,m.D)(Te);if(0===nt.length)return(0,te.D)([],Me);const oe=new h.y(function K(Te,Me,de=l.y){return nt=>{be(Me,()=>{const{length:Ce}=Te,oe=new Array(Ce);let xe=Ce,Ie=Ce;for(let Ae=0;Ae<Ce;Ae++)be(Me,()=>{const ye=(0,te.D)(Te[Ae],Me);let Ue=!1;ye.subscribe((0,ie.x)(nt,ct=>{oe[Ae]=ct,Ue||(Ue=!0,Ie--),Ie||nt.next(de(oe.slice()))},()=>{--xe||nt.complete()}))},nt)},nt)}}(nt,Me,Ce?xe=>(0,C.n)(Ce,xe):l.y));return de?oe.pipe((0,B.Z)(de)):oe}function be(Te,Me,de){Te?(0,fe.f)(de,Te,Me):Me()}},5211:(Bn,Ct,P)=>{"use strict";P.d(Ct,{z:()=>B});var h=P(7537),te=P(4564),l=P(7715);function B(...Y){return function m(){return(0,h.J)(1)}()((0,l.D)(Y,(0,te.yG)(Y)))}},4911:(Bn,Ct,P)=>{"use strict";P.d(Ct,{P:()=>te});var h=P(5592),m=P(4829);function te(l){return new h.y(B=>{(0,m.Xf)(l()).subscribe(B)})}},6232:(Bn,Ct,P)=>{"use strict";P.d(Ct,{E:()=>m});const m=new(P(5592).y)(B=>B.complete())},9315:(Bn,Ct,P)=>{"use strict";P.d(Ct,{D:()=>ie});var h=P(5592),m=P(7453),te=P(4829),l=P(4564),B=P(8251),Y=P(7400),C=P(2714);function ie(...fe){const Pe=(0,l.jO)(fe),{args:K,keys:be}=(0,m.D)(fe),Te=new h.y(Me=>{const{length:de}=K;if(!de)return void Me.complete();const nt=new Array(de);let Ce=de,oe=de;for(let xe=0;xe<de;xe++){let Ie=!1;(0,te.Xf)(K[xe]).subscribe((0,B.x)(Me,Ae=>{Ie||(Ie=!0,oe--),nt[xe]=Ae},()=>Ce--,void 0,()=>{(!Ce||!Ie)&&(oe||Me.next(be?(0,C.n)(be,nt):nt),Me.complete())}))}});return Pe?Te.pipe((0,Y.Z)(Pe)):Te}},7715:(Bn,Ct,P)=>{"use strict";P.d(Ct,{D:()=>ct});var h=P(4829),m=P(7103),te=P(9360),l=P(8251);function B(X,ve=0){return(0,te.e)((me,Fe)=>{me.subscribe((0,l.x)(Fe,De=>(0,m.f)(Fe,X,()=>Fe.next(De),ve),()=>(0,m.f)(Fe,X,()=>Fe.complete(),ve),De=>(0,m.f)(Fe,X,()=>Fe.error(De),ve)))})}function Y(X,ve=0){return(0,te.e)((me,Fe)=>{Fe.add(X.schedule(()=>me.subscribe(Fe),ve))})}var fe=P(5592),K=P(4971),be=P(4674);function Me(X,ve){if(!X)throw new Error("Iterable cannot be null");return new fe.y(me=>{(0,m.f)(me,ve,()=>{const Fe=X[Symbol.asyncIterator]();(0,m.f)(me,ve,()=>{Fe.next().then(De=>{De.done?me.complete():me.next(De.value)})},0,!0)})})}var de=P(8382),nt=P(4026),Ce=P(4266),oe=P(3664),xe=P(5726),Ie=P(9853),Ae=P(541);function ct(X,ve){return ve?function Ue(X,ve){if(null!=X){if((0,de.c)(X))return function C(X,ve){return(0,h.Xf)(X).pipe(Y(ve),B(ve))}(X,ve);if((0,Ce.z)(X))return function Pe(X,ve){return new fe.y(me=>{let Fe=0;return ve.schedule(function(){Fe===X.length?me.complete():(me.next(X[Fe++]),me.closed||this.schedule())})})}(X,ve);if((0,nt.t)(X))return function ie(X,ve){return(0,h.Xf)(X).pipe(Y(ve),B(ve))}(X,ve);if((0,xe.D)(X))return Me(X,ve);if((0,oe.T)(X))return function Te(X,ve){return new fe.y(me=>{let Fe;return(0,m.f)(me,ve,()=>{Fe=X[K.h](),(0,m.f)(me,ve,()=>{let De,ze;try{({value:De,done:ze}=Fe.next())}catch(Ke){return void me.error(Ke)}ze?me.complete():me.next(De)},0,!0)}),()=>(0,be.m)(Fe?.return)&&Fe.return()})}(X,ve);if((0,Ae.L)(X))return function ye(X,ve){return Me((0,Ae.Q)(X),ve)}(X,ve)}throw(0,Ie.z)(X)}(X,ve):(0,h.Xf)(X)}},2438:(Bn,Ct,P)=>{"use strict";P.d(Ct,{R:()=>Pe});var h=P(4829),m=P(5592),te=P(1631),l=P(4266),B=P(4674),Y=P(7400);const C=["addListener","removeListener"],ie=["addEventListener","removeEventListener"],fe=["on","off"];function Pe(de,nt,Ce,oe){if((0,B.m)(Ce)&&(oe=Ce,Ce=void 0),oe)return Pe(de,nt,Ce).pipe((0,Y.Z)(oe));const[xe,Ie]=function Me(de){return(0,B.m)(de.addEventListener)&&(0,B.m)(de.removeEventListener)}(de)?ie.map(Ae=>ye=>de[Ae](nt,ye,Ce)):function be(de){return(0,B.m)(de.addListener)&&(0,B.m)(de.removeListener)}(de)?C.map(K(de,nt)):function Te(de){return(0,B.m)(de.on)&&(0,B.m)(de.off)}(de)?fe.map(K(de,nt)):[];if(!xe&&(0,l.z)(de))return(0,te.z)(Ae=>Pe(Ae,nt,Ce))((0,h.Xf)(de));if(!xe)throw new TypeError("Invalid event target");return new m.y(Ae=>{const ye=(...Ue)=>Ae.next(1<Ue.length?Ue:Ue[0]);return xe(ye),()=>Ie(ye)})}function K(de,nt){return Ce=>oe=>de[Ce](nt,oe)}},4829:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Xf:()=>Te});var h=P(7582),m=P(4266),te=P(4026),l=P(5592),B=P(8382),Y=P(5726),C=P(9853),ie=P(3664),fe=P(541),Pe=P(4674),K=P(3894),be=P(4850);function Te(Ae){if(Ae instanceof l.y)return Ae;if(null!=Ae){if((0,B.c)(Ae))return function Me(Ae){return new l.y(ye=>{const Ue=Ae[be.L]();if((0,Pe.m)(Ue.subscribe))return Ue.subscribe(ye);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(Ae);if((0,m.z)(Ae))return function de(Ae){return new l.y(ye=>{for(let Ue=0;Ue<Ae.length&&!ye.closed;Ue++)ye.next(Ae[Ue]);ye.complete()})}(Ae);if((0,te.t)(Ae))return function nt(Ae){return new l.y(ye=>{Ae.then(Ue=>{ye.closed||(ye.next(Ue),ye.complete())},Ue=>ye.error(Ue)).then(null,K.h)})}(Ae);if((0,Y.D)(Ae))return oe(Ae);if((0,ie.T)(Ae))return function Ce(Ae){return new l.y(ye=>{for(const Ue of Ae)if(ye.next(Ue),ye.closed)return;ye.complete()})}(Ae);if((0,fe.L)(Ae))return function xe(Ae){return oe((0,fe.Q)(Ae))}(Ae)}throw(0,C.z)(Ae)}function oe(Ae){return new l.y(ye=>{(function Ie(Ae,ye){var Ue,ct,X,ve;return(0,h.mG)(this,void 0,void 0,function*(){try{for(Ue=(0,h.KL)(Ae);!(ct=yield Ue.next()).done;)if(ye.next(ct.value),ye.closed)return}catch(me){X={error:me}}finally{try{ct&&!ct.done&&(ve=Ue.return)&&(yield ve.call(Ue))}finally{if(X)throw X.error}}ye.complete()})})(Ae,ye).catch(Ue=>ye.error(Ue))})}},2096:(Bn,Ct,P)=>{"use strict";P.d(Ct,{of:()=>te});var h=P(4564),m=P(7715);function te(...l){const B=(0,h.yG)(l);return(0,m.D)(l,B)}},8251:(Bn,Ct,P)=>{"use strict";P.d(Ct,{x:()=>m});var h=P(305);function m(l,B,Y,C,ie){return new te(l,B,Y,C,ie)}class te extends h.Lv{constructor(B,Y,C,ie,fe,Pe){super(B),this.onFinalize=fe,this.shouldUnsubscribe=Pe,this._next=Y?function(K){try{Y(K)}catch(be){B.error(be)}}:super._next,this._error=ie?function(K){try{ie(K)}catch(be){B.error(be)}finally{this.unsubscribe()}}:super._error,this._complete=C?function(){try{C()}catch(K){B.error(K)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var B;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:Y}=this;super.unsubscribe(),!Y&&(null===(B=this.onFinalize)||void 0===B||B.call(this))}}}},6328:(Bn,Ct,P)=>{"use strict";P.d(Ct,{b:()=>te});var h=P(1631),m=P(4674);function te(l,B){return(0,m.m)(B)?(0,h.z)(l,B,1):(0,h.z)(l,1)}},2181:(Bn,Ct,P)=>{"use strict";P.d(Ct,{h:()=>te});var h=P(9360),m=P(8251);function te(l,B){return(0,h.e)((Y,C)=>{let ie=0;Y.subscribe((0,m.x)(C,fe=>l.call(B,fe,ie++)&&C.next(fe)))})}},4716:(Bn,Ct,P)=>{"use strict";P.d(Ct,{x:()=>m});var h=P(9360);function m(te){return(0,h.e)((l,B)=>{try{l.subscribe(B)}finally{B.add(te)}})}},7398:(Bn,Ct,P)=>{"use strict";P.d(Ct,{U:()=>te});var h=P(9360),m=P(8251);function te(l,B){return(0,h.e)((Y,C)=>{let ie=0;Y.subscribe((0,m.x)(C,fe=>{C.next(l.call(B,fe,ie++))}))})}},7537:(Bn,Ct,P)=>{"use strict";P.d(Ct,{J:()=>te});var h=P(1631),m=P(2737);function te(l=1/0){return(0,h.z)(m.y,l)}},1631:(Bn,Ct,P)=>{"use strict";P.d(Ct,{z:()=>ie});var h=P(7398),m=P(4829),te=P(9360),l=P(7103),B=P(8251),C=P(4674);function ie(fe,Pe,K=1/0){return(0,C.m)(Pe)?ie((be,Te)=>(0,h.U)((Me,de)=>Pe(be,Me,Te,de))((0,m.Xf)(fe(be,Te))),K):("number"==typeof Pe&&(K=Pe),(0,te.e)((be,Te)=>function Y(fe,Pe,K,be,Te,Me,de,nt){const Ce=[];let oe=0,xe=0,Ie=!1;const Ae=()=>{Ie&&!Ce.length&&!oe&&Pe.complete()},ye=ct=>oe<be?Ue(ct):Ce.push(ct),Ue=ct=>{Me&&Pe.next(ct),oe++;let X=!1;(0,m.Xf)(K(ct,xe++)).subscribe((0,B.x)(Pe,ve=>{Te?.(ve),Me?ye(ve):Pe.next(ve)},()=>{X=!0},void 0,()=>{if(X)try{for(oe--;Ce.length&&oe<be;){const ve=Ce.shift();de?(0,l.f)(Pe,de,()=>Ue(ve)):Ue(ve)}Ae()}catch(ve){Pe.error(ve)}}))};return fe.subscribe((0,B.x)(Pe,ye,()=>{Ie=!0,Ae()})),()=>{nt?.()}}(be,Te,fe,K)))}},4664:(Bn,Ct,P)=>{"use strict";P.d(Ct,{w:()=>l});var h=P(4829),m=P(9360),te=P(8251);function l(B,Y){return(0,m.e)((C,ie)=>{let fe=null,Pe=0,K=!1;const be=()=>K&&!fe&&ie.complete();C.subscribe((0,te.x)(ie,Te=>{fe?.unsubscribe();let Me=0;const de=Pe++;(0,h.Xf)(B(Te,de)).subscribe(fe=(0,te.x)(ie,nt=>ie.next(Y?Y(Te,nt,de,Me++):nt),()=>{fe=null,be()}))},()=>{K=!0,be()}))})}},8180:(Bn,Ct,P)=>{"use strict";P.d(Ct,{q:()=>l});var h=P(6232),m=P(9360),te=P(8251);function l(B){return B<=0?()=>h.E:(0,m.e)((Y,C)=>{let ie=0;Y.subscribe((0,te.x)(C,fe=>{++ie<=B&&(C.next(fe),B<=ie&&C.complete())}))})}},4552:(Bn,Ct,P)=>{"use strict";P.d(Ct,{l:()=>h});const h={now:()=>(h.delegate||Date).now(),delegate:void 0}},7599:(Bn,Ct,P)=>{"use strict";P.d(Ct,{z:()=>h});const h={setTimeout(m,te,...l){const{delegate:B}=h;return B?.setTimeout?B.setTimeout(m,te,...l):setTimeout(m,te,...l)},clearTimeout(m){const{delegate:te}=h;return(te?.clearTimeout||clearTimeout)(m)},delegate:void 0}},4971:(Bn,Ct,P)=>{"use strict";P.d(Ct,{h:()=>m});const m=function h(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}()},4850:(Bn,Ct,P)=>{"use strict";P.d(Ct,{L:()=>h});const h="function"==typeof Symbol&&Symbol.observable||"@@observable"},4564:(Bn,Ct,P)=>{"use strict";P.d(Ct,{jO:()=>l,yG:()=>B});var h=P(4674);function te(C){return C[C.length-1]}function l(C){return(0,h.m)(te(C))?C.pop():void 0}function B(C){return function m(C){return C&&(0,h.m)(C.schedule)}(te(C))?C.pop():void 0}},7453:(Bn,Ct,P)=>{"use strict";P.d(Ct,{D:()=>B});const{isArray:h}=Array,{getPrototypeOf:m,prototype:te,keys:l}=Object;function B(C){if(1===C.length){const ie=C[0];if(h(ie))return{args:ie,keys:null};if(function Y(C){return C&&"object"==typeof C&&m(C)===te}(ie)){const fe=l(ie);return{args:fe.map(Pe=>ie[Pe]),keys:fe}}}return{args:C,keys:null}}},9039:(Bn,Ct,P)=>{"use strict";function h(m,te){if(m){const l=m.indexOf(te);0<=l&&m.splice(l,1)}}P.d(Ct,{P:()=>h})},2306:(Bn,Ct,P)=>{"use strict";function h(m){const l=m(B=>{Error.call(B),B.stack=(new Error).stack});return l.prototype=Object.create(Error.prototype),l.prototype.constructor=l,l}P.d(Ct,{d:()=>h})},2714:(Bn,Ct,P)=>{"use strict";function h(m,te){return m.reduce((l,B,Y)=>(l[B]=te[Y],l),{})}P.d(Ct,{n:()=>h})},1441:(Bn,Ct,P)=>{"use strict";P.d(Ct,{O:()=>l,x:()=>te});var h=P(2653);let m=null;function te(B){if(h.config.useDeprecatedSynchronousErrorHandling){const Y=!m;if(Y&&(m={errorThrown:!1,error:null}),B(),Y){const{errorThrown:C,error:ie}=m;if(m=null,C)throw ie}}else B()}function l(B){h.config.useDeprecatedSynchronousErrorHandling&&m&&(m.errorThrown=!0,m.error=B)}},7103:(Bn,Ct,P)=>{"use strict";function h(m,te,l,B=0,Y=!1){const C=te.schedule(function(){l(),Y?m.add(this.schedule(null,B)):this.unsubscribe()},B);if(m.add(C),!Y)return C}P.d(Ct,{f:()=>h})},2737:(Bn,Ct,P)=>{"use strict";function h(m){return m}P.d(Ct,{y:()=>h})},4266:(Bn,Ct,P)=>{"use strict";P.d(Ct,{z:()=>h});const h=m=>m&&"number"==typeof m.length&&"function"!=typeof m},5726:(Bn,Ct,P)=>{"use strict";P.d(Ct,{D:()=>m});var h=P(4674);function m(te){return Symbol.asyncIterator&&(0,h.m)(te?.[Symbol.asyncIterator])}},4674:(Bn,Ct,P)=>{"use strict";function h(m){return"function"==typeof m}P.d(Ct,{m:()=>h})},8382:(Bn,Ct,P)=>{"use strict";P.d(Ct,{c:()=>te});var h=P(4850),m=P(4674);function te(l){return(0,m.m)(l[h.L])}},3664:(Bn,Ct,P)=>{"use strict";P.d(Ct,{T:()=>te});var h=P(4971),m=P(4674);function te(l){return(0,m.m)(l?.[h.h])}},2664:(Bn,Ct,P)=>{"use strict";P.d(Ct,{b:()=>te});var h=P(5592),m=P(4674);function te(l){return!!l&&(l instanceof h.y||(0,m.m)(l.lift)&&(0,m.m)(l.subscribe))}},4026:(Bn,Ct,P)=>{"use strict";P.d(Ct,{t:()=>m});var h=P(4674);function m(te){return(0,h.m)(te?.then)}},541:(Bn,Ct,P)=>{"use strict";P.d(Ct,{L:()=>l,Q:()=>te});var h=P(7582),m=P(4674);function te(B){return(0,h.FC)(this,arguments,function*(){const C=B.getReader();try{for(;;){const{value:ie,done:fe}=yield(0,h.qq)(C.read());if(fe)return yield(0,h.qq)(void 0);yield yield(0,h.qq)(ie)}}finally{C.releaseLock()}})}function l(B){return(0,m.m)(B?.getReader)}},9360:(Bn,Ct,P)=>{"use strict";P.d(Ct,{A:()=>m,e:()=>te});var h=P(4674);function m(l){return(0,h.m)(l?.lift)}function te(l){return B=>{if(m(B))return B.lift(function(Y){try{return l(Y,this)}catch(C){this.error(C)}});throw new TypeError("Unable to lift unknown Observable type")}}},7400:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Z:()=>l});var h=P(7398);const{isArray:m}=Array;function l(B){return(0,h.U)(Y=>function te(B,Y){return m(Y)?B(...Y):B(Y)}(B,Y))}},2420:(Bn,Ct,P)=>{"use strict";function h(){}P.d(Ct,{Z:()=>h})},8407:(Bn,Ct,P)=>{"use strict";P.d(Ct,{U:()=>te,z:()=>m});var h=P(2737);function m(...l){return te(l)}function te(l){return 0===l.length?h.y:1===l.length?l[0]:function(Y){return l.reduce((C,ie)=>ie(C),Y)}}},3894:(Bn,Ct,P)=>{"use strict";P.d(Ct,{h:()=>te});var h=P(2653),m=P(7599);function te(l){m.z.setTimeout(()=>{const{onUnhandledError:B}=h.config;if(!B)throw l;B(l)})}},9853:(Bn,Ct,P)=>{"use strict";function h(m){return new TypeError(`You provided ${null!==m&&"object"==typeof m?"an invalid object":`'${m}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}P.d(Ct,{z:()=>h})},863:(Bn,Ct,P)=>{var h={"./ion-accordion_2.entry.js":[8484,8592,8484],"./ion-action-sheet.entry.js":[9882,8592,9882],"./ion-alert.entry.js":[6304,8592,6304],"./ion-app_8.entry.js":[5860,8592,5860],"./ion-avatar_3.entry.js":[3544,3544],"./ion-back-button.entry.js":[505,8592,505],"./ion-backdrop.entry.js":[469,469],"./ion-breadcrumb_2.entry.js":[9857,8592,9857],"./ion-button_2.entry.js":[1372,1372],"./ion-card_5.entry.js":[3150,3150],"./ion-checkbox.entry.js":[7635,8592,7635],"./ion-chip.entry.js":[6673,6673],"./ion-col_3.entry.js":[1315,1315],"./ion-datetime-button.entry.js":[433,5248,433],"./ion-datetime_3.entry.js":[7059,5248,8592,7059],"./ion-fab_3.entry.js":[4087,8592,4087],"./ion-img.entry.js":[1745,1745],"./ion-infinite-scroll_2.entry.js":[9352,8592,9352],"./ion-input.entry.js":[4530,8592,4530],"./ion-item-option_3.entry.js":[8633,8592,8633],"./ion-item_8.entry.js":[5962,8592,5962],"./ion-loading.entry.js":[3483,8592,3483],"./ion-menu_3.entry.js":[2939,8592,8382],"./ion-modal.entry.js":[8577,8592,8577],"./ion-nav_2.entry.js":[5675,8592,5675],"./ion-picker-column-internal.entry.js":[9992,8592,9992],"./ion-picker-internal.entry.js":[9820,9820],"./ion-popover.entry.js":[185,8592,185],"./ion-progress-bar.entry.js":[5454,5454],"./ion-radio_2.entry.js":[4458,8592,4458],"./ion-range.entry.js":[7666,8592,7666],"./ion-refresher_2.entry.js":[7219,8592,7219],"./ion-reorder_2.entry.js":[2975,8592,2975],"./ion-ripple-effect.entry.js":[7465,7465],"./ion-route_4.entry.js":[4764,4764],"./ion-searchbar.entry.js":[3998,8592,3998],"./ion-segment_2.entry.js":[3672,8592,3672],"./ion-select_3.entry.js":[6754,8592,6754],"./ion-spinner.entry.js":[9588,8592,9588],"./ion-split-pane.entry.js":[9793,9793],"./ion-tab-bar_2.entry.js":[4090,8592,4090],"./ion-tab_2.entry.js":[2841,2841],"./ion-text.entry.js":[8811,8811],"./ion-textarea.entry.js":[3734,8592,3734],"./ion-toast.entry.js":[6642,8592,6642],"./ion-toggle.entry.js":[8866,8592,8866]};function m(te){if(!P.o(h,te))return Promise.resolve().then(()=>{var Y=new Error("Cannot find module '"+te+"'");throw Y.code="MODULE_NOT_FOUND",Y});var l=h[te],B=l[0];return Promise.all(l.slice(1).map(P.e)).then(()=>P(B))}m.keys=()=>Object.keys(h),m.id=863,Bn.exports=m},6814:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Do:()=>nt,EM:()=>rl,HT:()=>l,JF:()=>xs,JJ:()=>Bs,K0:()=>Y,Mx:()=>Tt,O5:()=>_i,PM:()=>Po,S$:()=>Te,V_:()=>ie,Ye:()=>Ce,b0:()=>de,bD:()=>to,ez:()=>Mo,q:()=>te,sg:()=>pi,tP:()=>Wt,uU:()=>Nt,w_:()=>B});var h=P(9212);let m=null;function te(){return m}function l(F){m||(m=F)}class B{}const Y=new h.OlP("DocumentToken");let C=(()=>{class F{historyGo(H){throw new Error("Not implemented")}static#e=this.\u0275fac=function(le){return new(le||F)};static#t=this.\u0275prov=h.Yz7({token:F,factory:()=>(0,h.f3M)(fe),providedIn:"platform"})}return F})();const ie=new h.OlP("Location Initialized");let fe=(()=>{class F extends C{constructor(){super(),this._doc=(0,h.f3M)(Y),this._location=window.location,this._history=window.history}getBaseHrefFromDOM(){return te().getBaseHref(this._doc)}onPopState(H){const le=te().getGlobalEventTarget(this._doc,"window");return le.addEventListener("popstate",H,!1),()=>le.removeEventListener("popstate",H)}onHashChange(H){const le=te().getGlobalEventTarget(this._doc,"window");return le.addEventListener("hashchange",H,!1),()=>le.removeEventListener("hashchange",H)}get href(){return this._location.href}get protocol(){return this._location.protocol}get hostname(){return this._location.hostname}get port(){return this._location.port}get pathname(){return this._location.pathname}get search(){return this._location.search}get hash(){return this._location.hash}set pathname(H){this._location.pathname=H}pushState(H,le,wt){this._history.pushState(H,le,wt)}replaceState(H,le,wt){this._history.replaceState(H,le,wt)}forward(){this._history.forward()}back(){this._history.back()}historyGo(H=0){this._history.go(H)}getState(){return this._history.state}static#e=this.\u0275fac=function(le){return new(le||F)};static#t=this.\u0275prov=h.Yz7({token:F,factory:()=>new F,providedIn:"platform"})}return F})();function Pe(F,we){if(0==F.length)return we;if(0==we.length)return F;let H=0;return F.endsWith("/")&&H++,we.startsWith("/")&&H++,2==H?F+we.substring(1):1==H?F+we:F+"/"+we}function K(F){const we=F.match(/#|\?|$/),H=we&&we.index||F.length;return F.slice(0,H-("/"===F[H-1]?1:0))+F.slice(H)}function be(F){return F&&"?"!==F[0]?"?"+F:F}let Te=(()=>{class F{historyGo(H){throw new Error("Not implemented")}static#e=this.\u0275fac=function(le){return new(le||F)};static#t=this.\u0275prov=h.Yz7({token:F,factory:()=>(0,h.f3M)(de),providedIn:"root"})}return F})();const Me=new h.OlP("appBaseHref");let de=(()=>{class F extends Te{constructor(H,le){super(),this._platformLocation=H,this._removeListenerFns=[],this._baseHref=le??this._platformLocation.getBaseHrefFromDOM()??(0,h.f3M)(Y).location?.origin??""}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(H){this._removeListenerFns.push(this._platformLocation.onPopState(H),this._platformLocation.onHashChange(H))}getBaseHref(){return this._baseHref}prepareExternalUrl(H){return Pe(this._baseHref,H)}path(H=!1){const le=this._platformLocation.pathname+be(this._platformLocation.search),wt=this._platformLocation.hash;return wt&&H?`${le}${wt}`:le}pushState(H,le,wt,yn){const xn=this.prepareExternalUrl(wt+be(yn));this._platformLocation.pushState(H,le,xn)}replaceState(H,le,wt,yn){const xn=this.prepareExternalUrl(wt+be(yn));this._platformLocation.replaceState(H,le,xn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(H=0){this._platformLocation.historyGo?.(H)}static#e=this.\u0275fac=function(le){return new(le||F)(h.LFG(C),h.LFG(Me,8))};static#t=this.\u0275prov=h.Yz7({token:F,factory:F.\u0275fac,providedIn:"root"})}return F})(),nt=(()=>{class F extends Te{constructor(H,le){super(),this._platformLocation=H,this._baseHref="",this._removeListenerFns=[],null!=le&&(this._baseHref=le)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(H){this._removeListenerFns.push(this._platformLocation.onPopState(H),this._platformLocation.onHashChange(H))}getBaseHref(){return this._baseHref}path(H=!1){let le=this._platformLocation.hash;return null==le&&(le="#"),le.length>0?le.substring(1):le}prepareExternalUrl(H){const le=Pe(this._baseHref,H);return le.length>0?"#"+le:le}pushState(H,le,wt,yn){let xn=this.prepareExternalUrl(wt+be(yn));0==xn.length&&(xn=this._platformLocation.pathname),this._platformLocation.pushState(H,le,xn)}replaceState(H,le,wt,yn){let xn=this.prepareExternalUrl(wt+be(yn));0==xn.length&&(xn=this._platformLocation.pathname),this._platformLocation.replaceState(H,le,xn)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}getState(){return this._platformLocation.getState()}historyGo(H=0){this._platformLocation.historyGo?.(H)}static#e=this.\u0275fac=function(le){return new(le||F)(h.LFG(C),h.LFG(Me,8))};static#t=this.\u0275prov=h.Yz7({token:F,factory:F.\u0275fac})}return F})(),Ce=(()=>{class F{constructor(H){this._subject=new h.vpe,this._urlChangeListeners=[],this._urlChangeSubscription=null,this._locationStrategy=H;const le=this._locationStrategy.getBaseHref();this._basePath=function Ae(F){if(new RegExp("^(https?:)?//").test(F)){const[,H]=F.split(/\/\/[^\/]+/);return H}return F}(K(Ie(le))),this._locationStrategy.onPopState(wt=>{this._subject.emit({url:this.path(!0),pop:!0,state:wt.state,type:wt.type})})}ngOnDestroy(){this._urlChangeSubscription?.unsubscribe(),this._urlChangeListeners=[]}path(H=!1){return this.normalize(this._locationStrategy.path(H))}getState(){return this._locationStrategy.getState()}isCurrentPathEqualTo(H,le=""){return this.path()==this.normalize(H+be(le))}normalize(H){return F.stripTrailingSlash(function xe(F,we){if(!F||!we.startsWith(F))return we;const H=we.substring(F.length);return""===H||["/",";","?","#"].includes(H[0])?H:we}(this._basePath,Ie(H)))}prepareExternalUrl(H){return H&&"/"!==H[0]&&(H="/"+H),this._locationStrategy.prepareExternalUrl(H)}go(H,le="",wt=null){this._locationStrategy.pushState(wt,"",H,le),this._notifyUrlChangeListeners(this.prepareExternalUrl(H+be(le)),wt)}replaceState(H,le="",wt=null){this._locationStrategy.replaceState(wt,"",H,le),this._notifyUrlChangeListeners(this.prepareExternalUrl(H+be(le)),wt)}forward(){this._locationStrategy.forward()}back(){this._locationStrategy.back()}historyGo(H=0){this._locationStrategy.historyGo?.(H)}onUrlChange(H){return this._urlChangeListeners.push(H),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(le=>{this._notifyUrlChangeListeners(le.url,le.state)})),()=>{const le=this._urlChangeListeners.indexOf(H);this._urlChangeListeners.splice(le,1),0===this._urlChangeListeners.length&&(this._urlChangeSubscription?.unsubscribe(),this._urlChangeSubscription=null)}}_notifyUrlChangeListeners(H="",le){this._urlChangeListeners.forEach(wt=>wt(H,le))}subscribe(H,le,wt){return this._subject.subscribe({next:H,error:le,complete:wt})}static#e=this.normalizeQueryParams=be;static#t=this.joinWithSlash=Pe;static#n=this.stripTrailingSlash=K;static#i=this.\u0275fac=function(le){return new(le||F)(h.LFG(Te))};static#r=this.\u0275prov=h.Yz7({token:F,factory:()=>function oe(){return new Ce((0,h.LFG)(Te))}(),providedIn:"root"})}return F})();function Ie(F){return F.replace(/\/index.html$/,"")}var Ue=function(F){return F[F.Decimal=0]="Decimal",F[F.Percent=1]="Percent",F[F.Currency=2]="Currency",F[F.Scientific=3]="Scientific",F}(Ue||{}),X=function(F){return F[F.Format=0]="Format",F[F.Standalone=1]="Standalone",F}(X||{}),ve=function(F){return F[F.Narrow=0]="Narrow",F[F.Abbreviated=1]="Abbreviated",F[F.Wide=2]="Wide",F[F.Short=3]="Short",F}(ve||{}),me=function(F){return F[F.Short=0]="Short",F[F.Medium=1]="Medium",F[F.Long=2]="Long",F[F.Full=3]="Full",F}(me||{}),Fe=function(F){return F[F.Decimal=0]="Decimal",F[F.Group=1]="Group",F[F.List=2]="List",F[F.PercentSign=3]="PercentSign",F[F.PlusSign=4]="PlusSign",F[F.MinusSign=5]="MinusSign",F[F.Exponential=6]="Exponential",F[F.SuperscriptingExponent=7]="SuperscriptingExponent",F[F.PerMille=8]="PerMille",F[F.Infinity=9]="Infinity",F[F.NaN=10]="NaN",F[F.TimeSeparator=11]="TimeSeparator",F[F.CurrencyDecimal=12]="CurrencyDecimal",F[F.CurrencyGroup=13]="CurrencyGroup",F}(Fe||{});function Ne(F,we){return Zt((0,h.cg1)(F)[h.wAp.DateFormat],we)}function ke(F,we){return Zt((0,h.cg1)(F)[h.wAp.TimeFormat],we)}function it(F,we){return Zt((0,h.cg1)(F)[h.wAp.DateTimeFormat],we)}function Qt(F,we){const H=(0,h.cg1)(F),le=H[h.wAp.NumberSymbols][we];if(typeof le>"u"){if(we===Fe.CurrencyDecimal)return H[h.wAp.NumberSymbols][Fe.Decimal];if(we===Fe.CurrencyGroup)return H[h.wAp.NumberSymbols][Fe.Group]}return le}function Cn(F){if(!F[h.wAp.ExtraData])throw new Error(`Missing extra locale data for the locale "${F[h.wAp.LocaleId]}". Use "registerLocaleData" to load new data. See the "I18n guide" on angular.io to know more.`)}function Zt(F,we){for(let H=we;H>-1;H--)if(typeof F[H]<"u")return F[H];throw new Error("Locale data API: locale data undefined")}function hn(F){const[we,H]=F.split(":");return{hours:+we,minutes:+H}}const Ve=/^(\d{4,})-?(\d\d)-?(\d\d)(?:T(\d\d)(?::?(\d\d)(?::?(\d\d)(?:\.(\d+))?)?)?(Z|([+-])(\d\d):?(\d\d))?)?$/,Pt={},Kt=/((?:[^BEGHLMOSWYZabcdhmswyz']+)|(?:'(?:[^']|'')*')|(?:G{1,5}|y{1,4}|Y{1,4}|M{1,5}|L{1,5}|w{1,2}|W{1}|d{1,2}|E{1,6}|c{1,6}|a{1,5}|b{1,5}|B{1,5}|h{1,2}|H{1,2}|m{1,2}|s{1,2}|S{1,3}|z{1,4}|Z{1,5}|O{1,4}))([\s\S]*)/;var wn=function(F){return F[F.Short=0]="Short",F[F.ShortGMT=1]="ShortGMT",F[F.Long=2]="Long",F[F.Extended=3]="Extended",F}(wn||{}),ei=function(F){return F[F.FullYear=0]="FullYear",F[F.Month=1]="Month",F[F.Date=2]="Date",F[F.Hours=3]="Hours",F[F.Minutes=4]="Minutes",F[F.Seconds=5]="Seconds",F[F.FractionalSeconds=6]="FractionalSeconds",F[F.Day=7]="Day",F}(ei||{}),di=function(F){return F[F.DayPeriods=0]="DayPeriods",F[F.Days=1]="Days",F[F.Months=2]="Months",F[F.Eras=3]="Eras",F}(di||{});function Lr(F,we,H,le){let wt=function ae(F){if(Z(F))return F;if("number"==typeof F&&!isNaN(F))return new Date(F);if("string"==typeof F){if(F=F.trim(),/^(\d{4}(-\d{1,2}(-\d{1,2})?)?)$/.test(F)){const[wt,yn=1,xn=1]=F.split("-").map(xi=>+xi);return Mi(wt,yn-1,xn)}const H=parseFloat(F);if(!isNaN(F-H))return new Date(H);let le;if(le=F.match(Ve))return function ft(F){const we=new Date(0);let H=0,le=0;const wt=F[8]?we.setUTCFullYear:we.setFullYear,yn=F[8]?we.setUTCHours:we.setHours;F[9]&&(H=Number(F[9]+F[10]),le=Number(F[9]+F[11])),wt.call(we,Number(F[1]),Number(F[2])-1,Number(F[3]));const xn=Number(F[4]||0)-H,xi=Number(F[5]||0)-le,Jr=Number(F[6]||0),Pr=Math.floor(1e3*parseFloat("0."+(F[7]||0)));return yn.call(we,xn,xi,Jr,Pr),we}(le)}const we=new Date(F);if(!Z(we))throw new Error(`Unable to convert "${F}" into a date`);return we}(F);we=dr(H,we)||we;let xi,xn=[];for(;we;){if(xi=Kt.exec(we),!xi){xn.push(we);break}{xn=xn.concat(xi.slice(1));const xr=xn.pop();if(!xr)break;we=xr}}let Jr=wt.getTimezoneOffset();le&&(Jr=Bt(le,Jr),wt=function Gn(F,we,H){const le=H?-1:1,wt=F.getTimezoneOffset();return function Nn(F,we){return(F=new Date(F.getTime())).setMinutes(F.getMinutes()+we),F}(F,le*(Bt(we,wt)-wt))}(wt,le,!0));let Pr="";return xn.forEach(xr=>{const ir=function dt(F){if(Vt[F])return Vt[F];let we;switch(F){case"G":case"GG":case"GGG":we=Jt(di.Eras,ve.Abbreviated);break;case"GGGG":we=Jt(di.Eras,ve.Wide);break;case"GGGGG":we=Jt(di.Eras,ve.Narrow);break;case"y":we=gn(ei.FullYear,1,0,!1,!0);break;case"yy":we=gn(ei.FullYear,2,0,!0,!0);break;case"yyy":we=gn(ei.FullYear,3,0,!1,!0);break;case"yyyy":we=gn(ei.FullYear,4,0,!1,!0);break;case"Y":we=jt(1);break;case"YY":we=jt(2,!0);break;case"YYY":we=jt(3);break;case"YYYY":we=jt(4);break;case"M":case"L":we=gn(ei.Month,1,1);break;case"MM":case"LL":we=gn(ei.Month,2,1);break;case"MMM":we=Jt(di.Months,ve.Abbreviated);break;case"MMMM":we=Jt(di.Months,ve.Wide);break;case"MMMMM":we=Jt(di.Months,ve.Narrow);break;case"LLL":we=Jt(di.Months,ve.Abbreviated,X.Standalone);break;case"LLLL":we=Jt(di.Months,ve.Wide,X.Standalone);break;case"LLLLL":we=Jt(di.Months,ve.Narrow,X.Standalone);break;case"w":we=Dt(1);break;case"ww":we=Dt(2);break;case"W":we=Dt(1,!0);break;case"d":we=gn(ei.Date,1);break;case"dd":we=gn(ei.Date,2);break;case"c":case"cc":we=gn(ei.Day,1);break;case"ccc":we=Jt(di.Days,ve.Abbreviated,X.Standalone);break;case"cccc":we=Jt(di.Days,ve.Wide,X.Standalone);break;case"ccccc":we=Jt(di.Days,ve.Narrow,X.Standalone);break;case"cccccc":we=Jt(di.Days,ve.Short,X.Standalone);break;case"E":case"EE":case"EEE":we=Jt(di.Days,ve.Abbreviated);break;case"EEEE":we=Jt(di.Days,ve.Wide);break;case"EEEEE":we=Jt(di.Days,ve.Narrow);break;case"EEEEEE":we=Jt(di.Days,ve.Short);break;case"a":case"aa":case"aaa":we=Jt(di.DayPeriods,ve.Abbreviated);break;case"aaaa":we=Jt(di.DayPeriods,ve.Wide);break;case"aaaaa":we=Jt(di.DayPeriods,ve.Narrow);break;case"b":case"bb":case"bbb":we=Jt(di.DayPeriods,ve.Abbreviated,X.Standalone,!0);break;case"bbbb":we=Jt(di.DayPeriods,ve.Wide,X.Standalone,!0);break;case"bbbbb":we=Jt(di.DayPeriods,ve.Narrow,X.Standalone,!0);break;case"B":case"BB":case"BBB":we=Jt(di.DayPeriods,ve.Abbreviated,X.Format,!0);break;case"BBBB":we=Jt(di.DayPeriods,ve.Wide,X.Format,!0);break;case"BBBBB":we=Jt(di.DayPeriods,ve.Narrow,X.Format,!0);break;case"h":we=gn(ei.Hours,1,-12);break;case"hh":we=gn(ei.Hours,2,-12);break;case"H":we=gn(ei.Hours,1);break;case"HH":we=gn(ei.Hours,2);break;case"m":we=gn(ei.Minutes,1);break;case"mm":we=gn(ei.Minutes,2);break;case"s":we=gn(ei.Seconds,1);break;case"ss":we=gn(ei.Seconds,2);break;case"S":we=gn(ei.FractionalSeconds,1);break;case"SS":we=gn(ei.FractionalSeconds,2);break;case"SSS":we=gn(ei.FractionalSeconds,3);break;case"Z":case"ZZ":case"ZZZ":we=ut(wn.Short);break;case"ZZZZZ":we=ut(wn.Extended);break;case"O":case"OO":case"OOO":case"z":case"zz":case"zzz":we=ut(wn.ShortGMT);break;case"OOOO":case"ZZZZ":case"zzzz":we=ut(wn.Long);break;default:return null}return Vt[F]=we,we}(xr);Pr+=ir?ir(wt,H,Jr):"''"===xr?"'":xr.replace(/(^'|'$)/g,"").replace(/''/g,"'")}),Pr}function Mi(F,we,H){const le=new Date(0);return le.setFullYear(F,we,H),le.setHours(0,0,0),le}function dr(F,we){const H=function ze(F){return(0,h.cg1)(F)[h.wAp.LocaleId]}(F);if(Pt[H]=Pt[H]||{},Pt[H][we])return Pt[H][we];let le="";switch(we){case"shortDate":le=Ne(F,me.Short);break;case"mediumDate":le=Ne(F,me.Medium);break;case"longDate":le=Ne(F,me.Long);break;case"fullDate":le=Ne(F,me.Full);break;case"shortTime":le=ke(F,me.Short);break;case"mediumTime":le=ke(F,me.Medium);break;case"longTime":le=ke(F,me.Long);break;case"fullTime":le=ke(F,me.Full);break;case"short":const wt=dr(F,"shortTime"),yn=dr(F,"shortDate");le=Ei(it(F,me.Short),[wt,yn]);break;case"medium":const xn=dr(F,"mediumTime"),xi=dr(F,"mediumDate");le=Ei(it(F,me.Medium),[xn,xi]);break;case"long":const Jr=dr(F,"longTime"),Pr=dr(F,"longDate");le=Ei(it(F,me.Long),[Jr,Pr]);break;case"full":const xr=dr(F,"fullTime"),ir=dr(F,"fullDate");le=Ei(it(F,me.Full),[xr,ir])}return le&&(Pt[H][we]=le),le}function Ei(F,we){return we&&(F=F.replace(/\{([^}]+)}/g,function(H,le){return null!=we&&le in we?we[le]:H})),F}function fn(F,we,H="-",le,wt){let yn="";(F<0||wt&&F<=0)&&(wt?F=1-F:(F=-F,yn=H));let xn=String(F);for(;xn.length<we;)xn="0"+xn;return le&&(xn=xn.slice(xn.length-we)),yn+xn}function gn(F,we,H=0,le=!1,wt=!1){return function(yn,xn){let xi=function Fn(F,we){switch(F){case ei.FullYear:return we.getFullYear();case ei.Month:return we.getMonth();case ei.Date:return we.getDate();case ei.Hours:return we.getHours();case ei.Minutes:return we.getMinutes();case ei.Seconds:return we.getSeconds();case ei.FractionalSeconds:return we.getMilliseconds();case ei.Day:return we.getDay();default:throw new Error(`Unknown DateType value "${F}".`)}}(F,yn);if((H>0||xi>-H)&&(xi+=H),F===ei.Hours)0===xi&&-12===H&&(xi=12);else if(F===ei.FractionalSeconds)return function Li(F,we){return fn(F,3).substring(0,we)}(xi,we);const Jr=Qt(xn,Fe.MinusSign);return fn(xi,we,Jr,le,wt)}}function Jt(F,we,H=X.Format,le=!1){return function(wt,yn){return function Bi(F,we,H,le,wt,yn){switch(H){case di.Months:return function dn(F,we,H){const le=(0,h.cg1)(F),yn=Zt([le[h.wAp.MonthsFormat],le[h.wAp.MonthsStandalone]],we);return Zt(yn,H)}(we,wt,le)[F.getMonth()];case di.Days:return function Ht(F,we,H){const le=(0,h.cg1)(F),yn=Zt([le[h.wAp.DaysFormat],le[h.wAp.DaysStandalone]],we);return Zt(yn,H)}(we,wt,le)[F.getDay()];case di.DayPeriods:const xn=F.getHours(),xi=F.getMinutes();if(yn){const Pr=function It(F){const we=(0,h.cg1)(F);return Cn(we),(we[h.wAp.ExtraData][2]||[]).map(le=>"string"==typeof le?hn(le):[hn(le[0]),hn(le[1])])}(we),xr=function pe(F,we,H){const le=(0,h.cg1)(F);Cn(le);const yn=Zt([le[h.wAp.ExtraData][0],le[h.wAp.ExtraData][1]],we)||[];return Zt(yn,H)||[]}(we,wt,le),ir=Pr.findIndex(Kr=>{if(Array.isArray(Kr)){const[_r,so]=Kr,Bo=xn>=_r.hours&&xi>=_r.minutes,ao=xn<so.hours||xn===so.hours&&xi<so.minutes;if(_r.hours<so.hours){if(Bo&&ao)return!0}else if(Bo||ao)return!0}else if(Kr.hours===xn&&Kr.minutes===xi)return!0;return!1});if(-1!==ir)return xr[ir]}return function Ke(F,we,H){const le=(0,h.cg1)(F),yn=Zt([le[h.wAp.DayPeriodsFormat],le[h.wAp.DayPeriodsStandalone]],we);return Zt(yn,H)}(we,wt,le)[xn<12?0:1];case di.Eras:return function _n(F,we){return Zt((0,h.cg1)(F)[h.wAp.Eras],we)}(we,le)[F.getFullYear()<=0?0:1];default:throw new Error(`unexpected translation type ${H}`)}}(wt,yn,F,we,H,le)}}function ut(F){return function(we,H,le){const wt=-1*le,yn=Qt(H,Fe.MinusSign),xn=wt>0?Math.floor(wt/60):Math.ceil(wt/60);switch(F){case wn.Short:return(wt>=0?"+":"")+fn(xn,2,yn)+fn(Math.abs(wt%60),2,yn);case wn.ShortGMT:return"GMT"+(wt>=0?"+":"")+fn(xn,1,yn);case wn.Long:return"GMT"+(wt>=0?"+":"")+fn(xn,2,yn)+":"+fn(Math.abs(wt%60),2,yn);case wn.Extended:return 0===le?"Z":(wt>=0?"+":"")+fn(xn,2,yn)+":"+fn(Math.abs(wt%60),2,yn);default:throw new Error(`Unknown zone width "${F}"`)}}}const he=0,_e=4;function yt(F){return Mi(F.getFullYear(),F.getMonth(),F.getDate()+(_e-F.getDay()))}function Dt(F,we=!1){return function(H,le){let wt;if(we){const yn=new Date(H.getFullYear(),H.getMonth(),1).getDay()-1,xn=H.getDate();wt=1+Math.floor((xn+yn)/7)}else{const yn=yt(H),xn=function ot(F){const we=Mi(F,he,1).getDay();return Mi(F,0,1+(we<=_e?_e:_e+7)-we)}(yn.getFullYear()),xi=yn.getTime()-xn.getTime();wt=1+Math.round(xi/6048e5)}return fn(wt,F,Qt(le,Fe.MinusSign))}}function jt(F,we=!1){return function(H,le){return fn(yt(H).getFullYear(),F,Qt(le,Fe.MinusSign),we)}}const Vt={};function Bt(F,we){F=F.replace(/:/g,"");const H=Date.parse("Jan 01, 1970 00:00:00 "+F)/6e4;return isNaN(H)?we:H}function Z(F){return F instanceof Date&&!isNaN(F.valueOf())}const Re=/^(\d+)?\.((\d+)(-(\d+))?)?$/;function vr(F){const we=parseInt(F);if(isNaN(we))throw new Error("Invalid integer literal when parsing "+F);return we}function Tt(F,we){we=encodeURIComponent(we);for(const H of F.split(";")){const le=H.indexOf("="),[wt,yn]=-1==le?[H,""]:[H.slice(0,le),H.slice(le+1)];if(wt.trim()===we)return decodeURIComponent(yn)}return null}class Kn{constructor(we,H,le,wt){this.$implicit=we,this.ngForOf=H,this.index=le,this.count=wt}get first(){return 0===this.index}get last(){return this.index===this.count-1}get even(){return this.index%2==0}get odd(){return!this.even}}let pi=(()=>{class F{set ngForOf(H){this._ngForOf=H,this._ngForOfDirty=!0}set ngForTrackBy(H){this._trackByFn=H}get ngForTrackBy(){return this._trackByFn}constructor(H,le,wt){this._viewContainer=H,this._template=le,this._differs=wt,this._ngForOf=null,this._ngForOfDirty=!0,this._differ=null}set ngForTemplate(H){H&&(this._template=H)}ngDoCheck(){if(this._ngForOfDirty){this._ngForOfDirty=!1;const H=this._ngForOf;!this._differ&&H&&(this._differ=this._differs.find(H).create(this.ngForTrackBy))}if(this._differ){const H=this._differ.diff(this._ngForOf);H&&this._applyChanges(H)}}_applyChanges(H){const le=this._viewContainer;H.forEachOperation((wt,yn,xn)=>{if(null==wt.previousIndex)le.createEmbeddedView(this._template,new Kn(wt.item,this._ngForOf,-1,-1),null===xn?void 0:xn);else if(null==xn)le.remove(null===yn?void 0:yn);else if(null!==yn){const xi=le.get(yn);le.move(xi,xn),ki(xi,wt)}});for(let wt=0,yn=le.length;wt<yn;wt++){const xi=le.get(wt).context;xi.index=wt,xi.count=yn,xi.ngForOf=this._ngForOf}H.forEachIdentityChange(wt=>{ki(le.get(wt.currentIndex),wt)})}static ngTemplateContextGuard(H,le){return!0}static#e=this.\u0275fac=function(le){return new(le||F)(h.Y36(h.s_b),h.Y36(h.Rgc),h.Y36(h.ZZ4))};static#t=this.\u0275dir=h.lG2({type:F,selectors:[["","ngFor","","ngForOf",""]],inputs:{ngForOf:"ngForOf",ngForTrackBy:"ngForTrackBy",ngForTemplate:"ngForTemplate"},standalone:!0})}return F})();function ki(F,we){F.context.$implicit=we.item}let _i=(()=>{class F{constructor(H,le){this._viewContainer=H,this._context=new or,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=le}set ngIf(H){this._context.$implicit=this._context.ngIf=H,this._updateView()}set ngIfThen(H){Ee("ngIfThen",H),this._thenTemplateRef=H,this._thenViewRef=null,this._updateView()}set ngIfElse(H){Ee("ngIfElse",H),this._elseTemplateRef=H,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(H,le){return!0}static#e=this.\u0275fac=function(le){return new(le||F)(h.Y36(h.s_b),h.Y36(h.Rgc))};static#t=this.\u0275dir=h.lG2({type:F,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"},standalone:!0})}return F})();class or{constructor(){this.$implicit=null,this.ngIf=null}}function Ee(F,we){if(we&&!we.createEmbeddedView)throw new Error(`${F} must be a TemplateRef, but received '${(0,h.AaK)(we)}'.`)}let Wt=(()=>{class F{constructor(H){this._viewContainerRef=H,this._viewRef=null,this.ngTemplateOutletContext=null,this.ngTemplateOutlet=null,this.ngTemplateOutletInjector=null}ngOnChanges(H){if(this._shouldRecreateView(H)){const le=this._viewContainerRef;if(this._viewRef&&le.remove(le.indexOf(this._viewRef)),!this.ngTemplateOutlet)return void(this._viewRef=null);const wt=this._createContextForwardProxy();this._viewRef=le.createEmbeddedView(this.ngTemplateOutlet,wt,{injector:this.ngTemplateOutletInjector??void 0})}}_shouldRecreateView(H){return!!H.ngTemplateOutlet||!!H.ngTemplateOutletInjector}_createContextForwardProxy(){return new Proxy({},{set:(H,le,wt)=>!!this.ngTemplateOutletContext&&Reflect.set(this.ngTemplateOutletContext,le,wt),get:(H,le,wt)=>{if(this.ngTemplateOutletContext)return Reflect.get(this.ngTemplateOutletContext,le,wt)}})}static#e=this.\u0275fac=function(le){return new(le||F)(h.Y36(h.s_b))};static#t=this.\u0275dir=h.lG2({type:F,selectors:[["","ngTemplateOutlet",""]],inputs:{ngTemplateOutletContext:"ngTemplateOutletContext",ngTemplateOutlet:"ngTemplateOutlet",ngTemplateOutletInjector:"ngTemplateOutletInjector"},standalone:!0,features:[h.TTD]})}return F})();function vn(F,we){return new h.vHH(2100,!1)}const $=new h.OlP("DATE_PIPE_DEFAULT_TIMEZONE"),Ze=new h.OlP("DATE_PIPE_DEFAULT_OPTIONS");let Nt=(()=>{class F{constructor(H,le,wt){this.locale=H,this.defaultTimezone=le,this.defaultOptions=wt}transform(H,le,wt,yn){if(null==H||""===H||H!=H)return null;try{return Lr(H,le??this.defaultOptions?.dateFormat??"mediumDate",yn||this.locale,wt??this.defaultOptions?.timezone??this.defaultTimezone??void 0)}catch(xn){throw vn()}}static#e=this.\u0275fac=function(le){return new(le||F)(h.Y36(h.soG,16),h.Y36($,24),h.Y36(Ze,24))};static#t=this.\u0275pipe=h.Yjl({name:"date",type:F,pure:!0,standalone:!0})}return F})(),Bs=(()=>{class F{constructor(H){this._locale=H}transform(H,le,wt){if(!function $o(F){return!(null==F||""===F||F!=F)}(H))return null;wt=wt||this._locale;try{return function Eo(F,we,H){return function Ar(F,we,H,le,wt,yn,xn=!1){let xi="",Jr=!1;if(isFinite(F)){let Pr=function Ti(F){let le,wt,yn,xn,xi,we=Math.abs(F)+"",H=0;for((wt=we.indexOf("."))>-1&&(we=we.replace(".","")),(yn=we.search(/e/i))>0?(wt<0&&(wt=yn),wt+=+we.slice(yn+1),we=we.substring(0,yn)):wt<0&&(wt=we.length),yn=0;"0"===we.charAt(yn);yn++);if(yn===(xi=we.length))le=[0],wt=1;else{for(xi--;"0"===we.charAt(xi);)xi--;for(wt-=yn,le=[],xn=0;yn<=xi;yn++,xn++)le[xn]=Number(we.charAt(yn))}return wt>22&&(le=le.splice(0,21),H=wt-1,wt=1),{digits:le,exponent:H,integerLen:wt}}(F);xn&&(Pr=function hr(F){if(0===F.digits[0])return F;const we=F.digits.length-F.integerLen;return F.exponent?F.exponent+=2:(0===we?F.digits.push(0,0):1===we&&F.digits.push(0),F.integerLen+=2),F}(Pr));let xr=we.minInt,ir=we.minFrac,Kr=we.maxFrac;if(yn){const Ts=yn.match(Re);if(null===Ts)throw new Error(`${yn} is not a valid digit info`);const Zo=Ts[1],zo=Ts[3],ia=Ts[5];null!=Zo&&(xr=vr(Zo)),null!=zo&&(ir=vr(zo)),null!=ia?Kr=vr(ia):null!=zo&&ir>Kr&&(Kr=ir)}!function yo(F,we,H){if(we>H)throw new Error(`The minimum number of digits after fraction (${we}) is higher than the maximum (${H}).`);let le=F.digits,wt=le.length-F.integerLen;const yn=Math.min(Math.max(we,wt),H);let xn=yn+F.integerLen,xi=le[xn];if(xn>0){le.splice(Math.max(F.integerLen,xn));for(let ir=xn;ir<le.length;ir++)le[ir]=0}else{wt=Math.max(0,wt),F.integerLen=1,le.length=Math.max(1,xn=yn+1),le[0]=0;for(let ir=1;ir<xn;ir++)le[ir]=0}if(xi>=5)if(xn-1<0){for(let ir=0;ir>xn;ir--)le.unshift(0),F.integerLen++;le.unshift(1),F.integerLen++}else le[xn-1]++;for(;wt<Math.max(0,yn);wt++)le.push(0);let Jr=0!==yn;const Pr=we+F.integerLen,xr=le.reduceRight(function(ir,Kr,_r,so){return so[_r]=(Kr+=ir)<10?Kr:Kr-10,Jr&&(0===so[_r]&&_r>=Pr?so.pop():Jr=!1),Kr>=10?1:0},0);xr&&(le.unshift(xr),F.integerLen++)}(Pr,ir,Kr);let _r=Pr.digits,so=Pr.integerLen;const Bo=Pr.exponent;let ao=[];for(Jr=_r.every(Ts=>!Ts);so<xr;so++)_r.unshift(0);for(;so<0;so++)_r.unshift(0);so>0?ao=_r.splice(so,_r.length):(ao=_r,_r=[0]);const Es=[];for(_r.length>=we.lgSize&&Es.unshift(_r.splice(-we.lgSize,_r.length).join(""));_r.length>we.gSize;)Es.unshift(_r.splice(-we.gSize,_r.length).join(""));_r.length&&Es.unshift(_r.join("")),xi=Es.join(Qt(H,le)),ao.length&&(xi+=Qt(H,wt)+ao.join("")),Bo&&(xi+=Qt(H,Fe.Exponential)+"+"+Bo)}else xi=Qt(H,Fe.Infinity);return xi=F<0&&!Jr?we.negPre+xi+we.negSuf:we.posPre+xi+we.posSuf,xi}(F,function zi(F,we="-"){const H={minInt:1,minFrac:0,maxFrac:0,posPre:"",posSuf:"",negPre:"",negSuf:"",gSize:0,lgSize:0},le=F.split(";"),wt=le[0],yn=le[1],xn=-1!==wt.indexOf(".")?wt.split("."):[wt.substring(0,wt.lastIndexOf("0")+1),wt.substring(wt.lastIndexOf("0")+1)],xi=xn[0],Jr=xn[1]||"";H.posPre=xi.substring(0,xi.indexOf("#"));for(let xr=0;xr<Jr.length;xr++){const ir=Jr.charAt(xr);"0"===ir?H.minFrac=H.maxFrac=xr+1:"#"===ir?H.maxFrac=xr+1:H.posSuf+=ir}const Pr=xi.split(",");if(H.gSize=Pr[1]?Pr[1].length:0,H.lgSize=Pr[2]||Pr[1]?(Pr[2]||Pr[1]).length:0,yn){const xr=wt.length-H.posPre.length-H.posSuf.length,ir=yn.indexOf("#");H.negPre=yn.substring(0,ir).replace(/'/g,""),H.negSuf=yn.slice(ir+xr).replace(/'/g,"")}else H.negPre=we+H.posPre,H.negSuf=H.posSuf;return H}(function mt(F,we){return(0,h.cg1)(F)[h.wAp.NumberFormats][we]}(we,Ue.Decimal),Qt(we,Fe.MinusSign)),we,Fe.Group,Fe.Decimal,H)}(function ds(F){if("string"==typeof F&&!isNaN(Number(F)-parseFloat(F)))return Number(F);if("number"!=typeof F)throw new Error(`${F} is not a number`);return F}(H),wt,le)}catch(yn){throw vn()}}static#e=this.\u0275fac=function(le){return new(le||F)(h.Y36(h.soG,16))};static#t=this.\u0275pipe=h.Yjl({name:"number",type:F,pure:!0,standalone:!0})}return F})();let Mo=(()=>{class F{static#e=this.\u0275fac=function(le){return new(le||F)};static#t=this.\u0275mod=h.oAB({type:F});static#n=this.\u0275inj=h.cJS({})}return F})();const to="browser",fr="server";function Po(F){return F===fr}let rl=(()=>{class F{static#e=this.\u0275prov=(0,h.Yz7)({token:F,providedIn:"root",factory:()=>function zs(F){return F===to}((0,h.f3M)(h.Lbi))?new la((0,h.f3M)(Y),window):new Ba})}return F})();class la{constructor(we,H){this.document=we,this.window=H,this.offset=()=>[0,0]}setOffset(we){this.offset=Array.isArray(we)?()=>we:we}getScrollPosition(){return[this.window.scrollX,this.window.scrollY]}scrollToPosition(we){this.window.scrollTo(we[0],we[1])}scrollToAnchor(we){const H=function ca(F,we){const H=F.getElementById(we)||F.getElementsByName(we)[0];if(H)return H;if("function"==typeof F.createTreeWalker&&F.body&&"function"==typeof F.body.attachShadow){const le=F.createTreeWalker(F.body,NodeFilter.SHOW_ELEMENT);let wt=le.currentNode;for(;wt;){const yn=wt.shadowRoot;if(yn){const xn=yn.getElementById(we)||yn.querySelector(`[name="${we}"]`);if(xn)return xn}wt=le.nextNode()}}return null}(this.document,we);H&&(this.scrollToElement(H),H.focus())}setHistoryScrollRestoration(we){this.window.history.scrollRestoration=we}scrollToElement(we){const H=we.getBoundingClientRect(),le=H.left+this.window.pageXOffset,wt=H.top+this.window.pageYOffset,yn=this.offset();this.window.scrollTo(le-yn[0],wt-yn[1])}}class Ba{setOffset(we){}getScrollPosition(){return[0,0]}scrollToPosition(we){}scrollToAnchor(we){}setHistoryScrollRestoration(we){}}class xs{}},9862:(Bn,Ct,P)=>{"use strict";P.d(Ct,{JF:()=>wi,TP:()=>pe,WM:()=>Me,eN:()=>ke}),P(5861);var m=P(9212),te=P(2096),l=P(5592),B=P(7715),Y=P(6328),C=P(2181),ie=P(7398),fe=P(4716),Pe=P(4664),K=P(6814);class be{}class Te{}class Me{constructor(Tt){this.normalizedNames=new Map,this.lazyUpdate=null,Tt?"string"==typeof Tt?this.lazyInit=()=>{this.headers=new Map,Tt.split("\n").forEach(Et=>{const ln=Et.indexOf(":");if(ln>0){const vt=Et.slice(0,ln),Hn=vt.toLowerCase(),On=Et.slice(ln+1).trim();this.maybeSetNormalizedName(vt,Hn),this.headers.has(Hn)?this.headers.get(Hn).push(On):this.headers.set(Hn,[On])}})}:typeof Headers<"u"&&Tt instanceof Headers?(this.headers=new Map,Tt.forEach((Et,ln)=>{this.setHeaderEntries(ln,Et)})):this.lazyInit=()=>{this.headers=new Map,Object.entries(Tt).forEach(([Et,ln])=>{this.setHeaderEntries(Et,ln)})}:this.headers=new Map}has(Tt){return this.init(),this.headers.has(Tt.toLowerCase())}get(Tt){this.init();const Et=this.headers.get(Tt.toLowerCase());return Et&&Et.length>0?Et[0]:null}keys(){return this.init(),Array.from(this.normalizedNames.values())}getAll(Tt){return this.init(),this.headers.get(Tt.toLowerCase())||null}append(Tt,Et){return this.clone({name:Tt,value:Et,op:"a"})}set(Tt,Et){return this.clone({name:Tt,value:Et,op:"s"})}delete(Tt,Et){return this.clone({name:Tt,value:Et,op:"d"})}maybeSetNormalizedName(Tt,Et){this.normalizedNames.has(Et)||this.normalizedNames.set(Et,Tt)}init(){this.lazyInit&&(this.lazyInit instanceof Me?this.copyFrom(this.lazyInit):this.lazyInit(),this.lazyInit=null,this.lazyUpdate&&(this.lazyUpdate.forEach(Tt=>this.applyUpdate(Tt)),this.lazyUpdate=null))}copyFrom(Tt){Tt.init(),Array.from(Tt.headers.keys()).forEach(Et=>{this.headers.set(Et,Tt.headers.get(Et)),this.normalizedNames.set(Et,Tt.normalizedNames.get(Et))})}clone(Tt){const Et=new Me;return Et.lazyInit=this.lazyInit&&this.lazyInit instanceof Me?this.lazyInit:this,Et.lazyUpdate=(this.lazyUpdate||[]).concat([Tt]),Et}applyUpdate(Tt){const Et=Tt.name.toLowerCase();switch(Tt.op){case"a":case"s":let ln=Tt.value;if("string"==typeof ln&&(ln=[ln]),0===ln.length)return;this.maybeSetNormalizedName(Tt.name,Et);const vt=("a"===Tt.op?this.headers.get(Et):void 0)||[];vt.push(...ln),this.headers.set(Et,vt);break;case"d":const Hn=Tt.value;if(Hn){let On=this.headers.get(Et);if(!On)return;On=On.filter(Kn=>-1===Hn.indexOf(Kn)),0===On.length?(this.headers.delete(Et),this.normalizedNames.delete(Et)):this.headers.set(Et,On)}else this.headers.delete(Et),this.normalizedNames.delete(Et)}}setHeaderEntries(Tt,Et){const ln=(Array.isArray(Et)?Et:[Et]).map(Hn=>Hn.toString()),vt=Tt.toLowerCase();this.headers.set(vt,ln),this.maybeSetNormalizedName(Tt,vt)}forEach(Tt){this.init(),Array.from(this.normalizedNames.keys()).forEach(Et=>Tt(this.normalizedNames.get(Et),this.headers.get(Et)))}}class nt{encodeKey(Tt){return Ie(Tt)}encodeValue(Tt){return Ie(Tt)}decodeKey(Tt){return decodeURIComponent(Tt)}decodeValue(Tt){return decodeURIComponent(Tt)}}const oe=/%(\d[a-f0-9])/gi,xe={40:"@","3A":":",24:"$","2C":",","3B":";","3D":"=","3F":"?","2F":"/"};function Ie(Qe){return encodeURIComponent(Qe).replace(oe,(Tt,Et)=>xe[Et]??Tt)}function Ae(Qe){return`${Qe}`}class ye{constructor(Tt={}){if(this.updates=null,this.cloneFrom=null,this.encoder=Tt.encoder||new nt,Tt.fromString){if(Tt.fromObject)throw new Error("Cannot specify both fromString and fromObject.");this.map=function Ce(Qe,Tt){const Et=new Map;return Qe.length>0&&Qe.replace(/^\?/,"").split("&").forEach(vt=>{const Hn=vt.indexOf("="),[On,Kn]=-1==Hn?[Tt.decodeKey(vt),""]:[Tt.decodeKey(vt.slice(0,Hn)),Tt.decodeValue(vt.slice(Hn+1))],pi=Et.get(On)||[];pi.push(Kn),Et.set(On,pi)}),Et}(Tt.fromString,this.encoder)}else Tt.fromObject?(this.map=new Map,Object.keys(Tt.fromObject).forEach(Et=>{const ln=Tt.fromObject[Et],vt=Array.isArray(ln)?ln.map(Ae):[Ae(ln)];this.map.set(Et,vt)})):this.map=null}has(Tt){return this.init(),this.map.has(Tt)}get(Tt){this.init();const Et=this.map.get(Tt);return Et?Et[0]:null}getAll(Tt){return this.init(),this.map.get(Tt)||null}keys(){return this.init(),Array.from(this.map.keys())}append(Tt,Et){return this.clone({param:Tt,value:Et,op:"a"})}appendAll(Tt){const Et=[];return Object.keys(Tt).forEach(ln=>{const vt=Tt[ln];Array.isArray(vt)?vt.forEach(Hn=>{Et.push({param:ln,value:Hn,op:"a"})}):Et.push({param:ln,value:vt,op:"a"})}),this.clone(Et)}set(Tt,Et){return this.clone({param:Tt,value:Et,op:"s"})}delete(Tt,Et){return this.clone({param:Tt,value:Et,op:"d"})}toString(){return this.init(),this.keys().map(Tt=>{const Et=this.encoder.encodeKey(Tt);return this.map.get(Tt).map(ln=>Et+"="+this.encoder.encodeValue(ln)).join("&")}).filter(Tt=>""!==Tt).join("&")}clone(Tt){const Et=new ye({encoder:this.encoder});return Et.cloneFrom=this.cloneFrom||this,Et.updates=(this.updates||[]).concat(Tt),Et}init(){null===this.map&&(this.map=new Map),null!==this.cloneFrom&&(this.cloneFrom.init(),this.cloneFrom.keys().forEach(Tt=>this.map.set(Tt,this.cloneFrom.map.get(Tt))),this.updates.forEach(Tt=>{switch(Tt.op){case"a":case"s":const Et=("a"===Tt.op?this.map.get(Tt.param):void 0)||[];Et.push(Ae(Tt.value)),this.map.set(Tt.param,Et);break;case"d":if(void 0===Tt.value){this.map.delete(Tt.param);break}{let ln=this.map.get(Tt.param)||[];const vt=ln.indexOf(Ae(Tt.value));-1!==vt&&ln.splice(vt,1),ln.length>0?this.map.set(Tt.param,ln):this.map.delete(Tt.param)}}}),this.cloneFrom=this.updates=null)}}class ct{constructor(){this.map=new Map}set(Tt,Et){return this.map.set(Tt,Et),this}get(Tt){return this.map.has(Tt)||this.map.set(Tt,Tt.defaultValue()),this.map.get(Tt)}delete(Tt){return this.map.delete(Tt),this}has(Tt){return this.map.has(Tt)}keys(){return this.map.keys()}}function ve(Qe){return typeof ArrayBuffer<"u"&&Qe instanceof ArrayBuffer}function me(Qe){return typeof Blob<"u"&&Qe instanceof Blob}function Fe(Qe){return typeof FormData<"u"&&Qe instanceof FormData}class ze{constructor(Tt,Et,ln,vt){let Hn;if(this.url=Et,this.body=null,this.reportProgress=!1,this.withCredentials=!1,this.responseType="json",this.method=Tt.toUpperCase(),function X(Qe){switch(Qe){case"DELETE":case"GET":case"HEAD":case"OPTIONS":case"JSONP":return!1;default:return!0}}(this.method)||vt?(this.body=void 0!==ln?ln:null,Hn=vt):Hn=ln,Hn&&(this.reportProgress=!!Hn.reportProgress,this.withCredentials=!!Hn.withCredentials,Hn.responseType&&(this.responseType=Hn.responseType),Hn.headers&&(this.headers=Hn.headers),Hn.context&&(this.context=Hn.context),Hn.params&&(this.params=Hn.params),this.transferCache=Hn.transferCache),this.headers||(this.headers=new Me),this.context||(this.context=new ct),this.params){const On=this.params.toString();if(0===On.length)this.urlWithParams=Et;else{const Kn=Et.indexOf("?");this.urlWithParams=Et+(-1===Kn?"?":Kn<Et.length-1?"&":"")+On}}else this.params=new ye,this.urlWithParams=Et}serializeBody(){return null===this.body?null:ve(this.body)||me(this.body)||Fe(this.body)||function De(Qe){return typeof URLSearchParams<"u"&&Qe instanceof URLSearchParams}(this.body)||"string"==typeof this.body?this.body:this.body instanceof ye?this.body.toString():"object"==typeof this.body||"boolean"==typeof this.body||Array.isArray(this.body)?JSON.stringify(this.body):this.body.toString()}detectContentTypeHeader(){return null===this.body||Fe(this.body)?null:me(this.body)?this.body.type||null:ve(this.body)?null:"string"==typeof this.body?"text/plain":this.body instanceof ye?"application/x-www-form-urlencoded;charset=UTF-8":"object"==typeof this.body||"number"==typeof this.body||"boolean"==typeof this.body?"application/json":null}clone(Tt={}){const Et=Tt.method||this.method,ln=Tt.url||this.url,vt=Tt.responseType||this.responseType,Hn=void 0!==Tt.body?Tt.body:this.body,On=void 0!==Tt.withCredentials?Tt.withCredentials:this.withCredentials,Kn=void 0!==Tt.reportProgress?Tt.reportProgress:this.reportProgress;let pi=Tt.headers||this.headers,ki=Tt.params||this.params;const rr=Tt.context??this.context;return void 0!==Tt.setHeaders&&(pi=Object.keys(Tt.setHeaders).reduce((_i,or)=>_i.set(or,Tt.setHeaders[or]),pi)),Tt.setParams&&(ki=Object.keys(Tt.setParams).reduce((_i,or)=>_i.set(or,Tt.setParams[or]),ki)),new ze(Et,ln,Hn,{params:ki,headers:pi,context:rr,reportProgress:Kn,responseType:vt,withCredentials:On})}}var Ke=function(Qe){return Qe[Qe.Sent=0]="Sent",Qe[Qe.UploadProgress=1]="UploadProgress",Qe[Qe.ResponseHeader=2]="ResponseHeader",Qe[Qe.DownloadProgress=3]="DownloadProgress",Qe[Qe.Response=4]="Response",Qe[Qe.User=5]="User",Qe}(Ke||{});class Ht{constructor(Tt,Et=We.Ok,ln="OK"){this.headers=Tt.headers||new Me,this.status=void 0!==Tt.status?Tt.status:Et,this.statusText=Tt.statusText||ln,this.url=Tt.url||null,this.ok=this.status>=200&&this.status<300}}class dn extends Ht{constructor(Tt={}){super(Tt),this.type=Ke.ResponseHeader}clone(Tt={}){return new dn({headers:Tt.headers||this.headers,status:void 0!==Tt.status?Tt.status:this.status,statusText:Tt.statusText||this.statusText,url:Tt.url||this.url||void 0})}}class _n extends Ht{constructor(Tt={}){super(Tt),this.type=Ke.Response,this.body=void 0!==Tt.body?Tt.body:null}clone(Tt={}){return new _n({body:void 0!==Tt.body?Tt.body:this.body,headers:Tt.headers||this.headers,status:void 0!==Tt.status?Tt.status:this.status,statusText:Tt.statusText||this.statusText,url:Tt.url||this.url||void 0})}}class Ut extends Ht{constructor(Tt){super(Tt,0,"Unknown Error"),this.name="HttpErrorResponse",this.ok=!1,this.message=this.status>=200&&this.status<300?`Http failure during parsing for ${Tt.url||"(unknown url)"}`:`Http failure response for ${Tt.url||"(unknown url)"}: ${Tt.status} ${Tt.statusText}`,this.error=Tt.error||null}}var We=function(Qe){return Qe[Qe.Continue=100]="Continue",Qe[Qe.SwitchingProtocols=101]="SwitchingProtocols",Qe[Qe.Processing=102]="Processing",Qe[Qe.EarlyHints=103]="EarlyHints",Qe[Qe.Ok=200]="Ok",Qe[Qe.Created=201]="Created",Qe[Qe.Accepted=202]="Accepted",Qe[Qe.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",Qe[Qe.NoContent=204]="NoContent",Qe[Qe.ResetContent=205]="ResetContent",Qe[Qe.PartialContent=206]="PartialContent",Qe[Qe.MultiStatus=207]="MultiStatus",Qe[Qe.AlreadyReported=208]="AlreadyReported",Qe[Qe.ImUsed=226]="ImUsed",Qe[Qe.MultipleChoices=300]="MultipleChoices",Qe[Qe.MovedPermanently=301]="MovedPermanently",Qe[Qe.Found=302]="Found",Qe[Qe.SeeOther=303]="SeeOther",Qe[Qe.NotModified=304]="NotModified",Qe[Qe.UseProxy=305]="UseProxy",Qe[Qe.Unused=306]="Unused",Qe[Qe.TemporaryRedirect=307]="TemporaryRedirect",Qe[Qe.PermanentRedirect=308]="PermanentRedirect",Qe[Qe.BadRequest=400]="BadRequest",Qe[Qe.Unauthorized=401]="Unauthorized",Qe[Qe.PaymentRequired=402]="PaymentRequired",Qe[Qe.Forbidden=403]="Forbidden",Qe[Qe.NotFound=404]="NotFound",Qe[Qe.MethodNotAllowed=405]="MethodNotAllowed",Qe[Qe.NotAcceptable=406]="NotAcceptable",Qe[Qe.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",Qe[Qe.RequestTimeout=408]="RequestTimeout",Qe[Qe.Conflict=409]="Conflict",Qe[Qe.Gone=410]="Gone",Qe[Qe.LengthRequired=411]="LengthRequired",Qe[Qe.PreconditionFailed=412]="PreconditionFailed",Qe[Qe.PayloadTooLarge=413]="PayloadTooLarge",Qe[Qe.UriTooLong=414]="UriTooLong",Qe[Qe.UnsupportedMediaType=415]="UnsupportedMediaType",Qe[Qe.RangeNotSatisfiable=416]="RangeNotSatisfiable",Qe[Qe.ExpectationFailed=417]="ExpectationFailed",Qe[Qe.ImATeapot=418]="ImATeapot",Qe[Qe.MisdirectedRequest=421]="MisdirectedRequest",Qe[Qe.UnprocessableEntity=422]="UnprocessableEntity",Qe[Qe.Locked=423]="Locked",Qe[Qe.FailedDependency=424]="FailedDependency",Qe[Qe.TooEarly=425]="TooEarly",Qe[Qe.UpgradeRequired=426]="UpgradeRequired",Qe[Qe.PreconditionRequired=428]="PreconditionRequired",Qe[Qe.TooManyRequests=429]="TooManyRequests",Qe[Qe.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",Qe[Qe.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",Qe[Qe.InternalServerError=500]="InternalServerError",Qe[Qe.NotImplemented=501]="NotImplemented",Qe[Qe.BadGateway=502]="BadGateway",Qe[Qe.ServiceUnavailable=503]="ServiceUnavailable",Qe[Qe.GatewayTimeout=504]="GatewayTimeout",Qe[Qe.HttpVersionNotSupported=505]="HttpVersionNotSupported",Qe[Qe.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",Qe[Qe.InsufficientStorage=507]="InsufficientStorage",Qe[Qe.LoopDetected=508]="LoopDetected",Qe[Qe.NotExtended=510]="NotExtended",Qe[Qe.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired",Qe}(We||{});function Ne(Qe,Tt){return{body:Tt,headers:Qe.headers,context:Qe.context,observe:Qe.observe,params:Qe.params,reportProgress:Qe.reportProgress,responseType:Qe.responseType,withCredentials:Qe.withCredentials,transferCache:Qe.transferCache}}let ke=(()=>{class Qe{constructor(Et){this.handler=Et}request(Et,ln,vt={}){let Hn;if(Et instanceof ze)Hn=Et;else{let pi,ki;pi=vt.headers instanceof Me?vt.headers:new Me(vt.headers),vt.params&&(ki=vt.params instanceof ye?vt.params:new ye({fromObject:vt.params})),Hn=new ze(Et,ln,void 0!==vt.body?vt.body:null,{headers:pi,context:vt.context,params:ki,reportProgress:vt.reportProgress,responseType:vt.responseType||"json",withCredentials:vt.withCredentials,transferCache:vt.transferCache})}const On=(0,te.of)(Hn).pipe((0,Y.b)(pi=>this.handler.handle(pi)));if(Et instanceof ze||"events"===vt.observe)return On;const Kn=On.pipe((0,C.h)(pi=>pi instanceof _n));switch(vt.observe||"body"){case"body":switch(Hn.responseType){case"arraybuffer":return Kn.pipe((0,ie.U)(pi=>{if(null!==pi.body&&!(pi.body instanceof ArrayBuffer))throw new Error("Response is not an ArrayBuffer.");return pi.body}));case"blob":return Kn.pipe((0,ie.U)(pi=>{if(null!==pi.body&&!(pi.body instanceof Blob))throw new Error("Response is not a Blob.");return pi.body}));case"text":return Kn.pipe((0,ie.U)(pi=>{if(null!==pi.body&&"string"!=typeof pi.body)throw new Error("Response is not a string.");return pi.body}));default:return Kn.pipe((0,ie.U)(pi=>pi.body))}case"response":return Kn;default:throw new Error(`Unreachable: unhandled observe type ${vt.observe}}`)}}delete(Et,ln={}){return this.request("DELETE",Et,ln)}get(Et,ln={}){return this.request("GET",Et,ln)}head(Et,ln={}){return this.request("HEAD",Et,ln)}jsonp(Et,ln){return this.request("JSONP",Et,{params:(new ye).append(ln,"JSONP_CALLBACK"),observe:"body",responseType:"json"})}options(Et,ln={}){return this.request("OPTIONS",Et,ln)}patch(Et,ln,vt={}){return this.request("PATCH",Et,Ne(vt,ln))}post(Et,ln,vt={}){return this.request("POST",Et,Ne(vt,ln))}put(Et,ln,vt={}){return this.request("PUT",Et,Ne(vt,ln))}static#e=this.\u0275fac=function(ln){return new(ln||Qe)(m.LFG(be))};static#t=this.\u0275prov=m.Yz7({token:Qe,factory:Qe.\u0275fac})}return Qe})();function bn(Qe,Tt){return Tt(Qe)}function Cn(Qe,Tt){return(Et,ln)=>Tt.intercept(Et,{handle:vt=>Qe(vt,ln)})}const pe=new m.OlP(""),lt=new m.OlP(""),Zt=new m.OlP(""),hn=new m.OlP("");function Yt(){let Qe=null;return(Tt,Et)=>{null===Qe&&(Qe=((0,m.f3M)(pe,{optional:!0})??[]).reduceRight(Cn,bn));const ln=(0,m.f3M)(m.I6F),vt=ln.add();return Qe(Tt,Et).pipe((0,fe.x)(()=>ln.remove(vt)))}}let Ve=(()=>{class Qe extends be{constructor(Et,ln){super(),this.backend=Et,this.injector=ln,this.chain=null,this.pendingTasks=(0,m.f3M)(m.I6F);const vt=(0,m.f3M)(hn,{optional:!0});this.backend=vt??Et}handle(Et){if(null===this.chain){const vt=Array.from(new Set([...this.injector.get(lt),...this.injector.get(Zt,[])]));this.chain=vt.reduceRight((Hn,On)=>function It(Qe,Tt,Et){return(ln,vt)=>(0,m.r_H)(Et,()=>Tt(ln,Hn=>Qe(Hn,vt)))}(Hn,On,this.injector),bn)}const ln=this.pendingTasks.add();return this.chain(Et,vt=>this.backend.handle(vt)).pipe((0,fe.x)(()=>this.pendingTasks.remove(ln)))}static#e=this.\u0275fac=function(ln){return new(ln||Qe)(m.LFG(Te),m.LFG(m.lqb))};static#t=this.\u0275prov=m.Yz7({token:Qe,factory:Qe.\u0275fac})}return Qe})();const gn=/^\)\]\}',?\n/;let Jt=(()=>{class Qe{constructor(Et){this.xhrFactory=Et}handle(Et){if("JSONP"===Et.method)throw new m.vHH(-2800,!1);const ln=this.xhrFactory;return(ln.\u0275loadImpl?(0,B.D)(ln.\u0275loadImpl()):(0,te.of)(null)).pipe((0,Pe.w)(()=>new l.y(Hn=>{const On=ln.build();if(On.open(Et.method,Et.urlWithParams),Et.withCredentials&&(On.withCredentials=!0),Et.headers.forEach((ee,qe)=>On.setRequestHeader(ee,qe.join(","))),Et.headers.has("Accept")||On.setRequestHeader("Accept","application/json, text/plain, */*"),!Et.headers.has("Content-Type")){const ee=Et.detectContentTypeHeader();null!==ee&&On.setRequestHeader("Content-Type",ee)}if(Et.responseType){const ee=Et.responseType.toLowerCase();On.responseType="json"!==ee?ee:"text"}const Kn=Et.serializeBody();let pi=null;const ki=()=>{if(null!==pi)return pi;const ee=On.statusText||"OK",qe=new Me(On.getAllResponseHeaders()),St=function Fn(Qe){return"responseURL"in Qe&&Qe.responseURL?Qe.responseURL:/^X-Request-URL:/m.test(Qe.getAllResponseHeaders())?Qe.getResponseHeader("X-Request-URL"):null}(On)||Et.url;return pi=new dn({headers:qe,status:On.status,statusText:ee,url:St}),pi},rr=()=>{let{headers:ee,status:qe,statusText:St,url:en}=ki(),jn=null;qe!==We.NoContent&&(jn=typeof On.response>"u"?On.responseText:On.response),0===qe&&(qe=jn?We.Ok:0);let V=qe>=200&&qe<300;if("json"===Et.responseType&&"string"==typeof jn){const ue=jn;jn=jn.replace(gn,"");try{jn=""!==jn?JSON.parse(jn):null}catch(Xe){jn=ue,V&&(V=!1,jn={error:Xe,text:jn})}}V?(Hn.next(new _n({body:jn,headers:ee,status:qe,statusText:St,url:en||void 0})),Hn.complete()):Hn.error(new Ut({error:jn,headers:ee,status:qe,statusText:St,url:en||void 0}))},_i=ee=>{const{url:qe}=ki(),St=new Ut({error:ee,status:On.status||0,statusText:On.statusText||"Unknown Error",url:qe||void 0});Hn.error(St)};let or=!1;const Ee=ee=>{or||(Hn.next(ki()),or=!0);let qe={type:Ke.DownloadProgress,loaded:ee.loaded};ee.lengthComputable&&(qe.total=ee.total),"text"===Et.responseType&&On.responseText&&(qe.partialText=On.responseText),Hn.next(qe)},Be=ee=>{let qe={type:Ke.UploadProgress,loaded:ee.loaded};ee.lengthComputable&&(qe.total=ee.total),Hn.next(qe)};return On.addEventListener("load",rr),On.addEventListener("error",_i),On.addEventListener("timeout",_i),On.addEventListener("abort",_i),Et.reportProgress&&(On.addEventListener("progress",Ee),null!==Kn&&On.upload&&On.upload.addEventListener("progress",Be)),On.send(Kn),Hn.next({type:Ke.Sent}),()=>{On.removeEventListener("error",_i),On.removeEventListener("abort",_i),On.removeEventListener("load",rr),On.removeEventListener("timeout",_i),Et.reportProgress&&(On.removeEventListener("progress",Ee),null!==Kn&&On.upload&&On.upload.removeEventListener("progress",Be)),On.readyState!==On.DONE&&On.abort()}})))}static#e=this.\u0275fac=function(ln){return new(ln||Qe)(m.LFG(K.JF))};static#t=this.\u0275prov=m.Yz7({token:Qe,factory:Qe.\u0275fac})}return Qe})();const Bi=new m.OlP("XSRF_ENABLED"),he=new m.OlP("XSRF_COOKIE_NAME",{providedIn:"root",factory:()=>"XSRF-TOKEN"}),ot=new m.OlP("XSRF_HEADER_NAME",{providedIn:"root",factory:()=>"X-XSRF-TOKEN"});class yt{}let Dt=(()=>{class Qe{constructor(Et,ln,vt){this.doc=Et,this.platform=ln,this.cookieName=vt,this.lastCookieString="",this.lastToken=null,this.parseCount=0}getToken(){if("server"===this.platform)return null;const Et=this.doc.cookie||"";return Et!==this.lastCookieString&&(this.parseCount++,this.lastToken=(0,K.Mx)(Et,this.cookieName),this.lastCookieString=Et),this.lastToken}static#e=this.\u0275fac=function(ln){return new(ln||Qe)(m.LFG(K.K0),m.LFG(m.Lbi),m.LFG(he))};static#t=this.\u0275prov=m.Yz7({token:Qe,factory:Qe.\u0275fac})}return Qe})();function jt(Qe,Tt){const Et=Qe.url.toLowerCase();if(!(0,m.f3M)(Bi)||"GET"===Qe.method||"HEAD"===Qe.method||Et.startsWith("http://")||Et.startsWith("https://"))return Tt(Qe);const ln=(0,m.f3M)(yt).getToken(),vt=(0,m.f3M)(ot);return null!=ln&&!Qe.headers.has(vt)&&(Qe=Qe.clone({headers:Qe.headers.set(vt,ln)})),Tt(Qe)}var dt=function(Qe){return Qe[Qe.Interceptors=0]="Interceptors",Qe[Qe.LegacyInterceptors=1]="LegacyInterceptors",Qe[Qe.CustomXsrfConfiguration=2]="CustomXsrfConfiguration",Qe[Qe.NoXsrfProtection=3]="NoXsrfProtection",Qe[Qe.JsonpSupport=4]="JsonpSupport",Qe[Qe.RequestsMadeViaParent=5]="RequestsMadeViaParent",Qe[Qe.Fetch=6]="Fetch",Qe}(dt||{});function Nn(...Qe){const Tt=[ke,Jt,Ve,{provide:be,useExisting:Ve},{provide:Te,useExisting:Jt},{provide:lt,useValue:jt,multi:!0},{provide:Bi,useValue:!0},{provide:yt,useClass:Dt}];for(const Et of Qe)Tt.push(...Et.\u0275providers);return(0,m.MR2)(Tt)}const ae=new m.OlP("LEGACY_INTERCEPTOR_FN");function ft(){return function Bt(Qe,Tt){return{\u0275kind:Qe,\u0275providers:Tt}}(dt.LegacyInterceptors,[{provide:ae,useFactory:Yt},{provide:lt,useExisting:ae,multi:!0}])}let wi=(()=>{class Qe{static#e=this.\u0275fac=function(ln){return new(ln||Qe)};static#t=this.\u0275mod=m.oAB({type:Qe});static#n=this.\u0275inj=m.cJS({providers:[Nn(ft())]})}return Qe})()},9212:(Bn,Ct,P)=>{"use strict";P.d(Ct,{tb:()=>R0,AFp:()=>Wh,ip1:()=>Sw,hGG:()=>UM,z2F:()=>Oh,Ojb:()=>by,sBO:()=>En,Sil:()=>HI,EJc:()=>AM,Xts:()=>nu,SBq:()=>ph,lqb:()=>as,qLn:()=>Nl,vpe:()=>qr,XFs:()=>_i,OlP:()=>V,zs3:()=>pr,ZZ4:()=>Rf,aQg:()=>cm,soG:()=>iy,YKP:()=>zb,h0i:()=>Ph,R0b:()=>ar,FiY:()=>Tc,Lbi:()=>Tp,g9A:()=>qh,Qsj:()=>Xg,FYo:()=>hc,JOm:()=>Pc,tp0:()=>qs,Rgc:()=>Jm,dDg:()=>vM,eoX:()=>Aw,GfV:()=>bw,s_b:()=>P_,ifc:()=>Mo,T8G:()=>Mm,VuI:()=>fA,LMc:()=>mA,MMx:()=>jb,Lck:()=>KD,eFA:()=>zw,G48:()=>LM,Gpc:()=>Fn,f3M:()=>ji,$WT:()=>Qo,MR2:()=>Dc,_c5:()=>zM,qFp:()=>gA,r_H:()=>yg,rg0:()=>Fc,c2e:()=>ww,zSh:()=>vp,wAp:()=>op,I6F:()=>Q_,vHH:()=>Yt,lri:()=>Iw,rWj:()=>Mw,cg1:()=>t0,kuF:()=>Ft,kL8:()=>w1,dqk:()=>St,Z0I:()=>ln,eJc:()=>Os,QGY:()=>o0,F4k:()=>Y1,RDi:()=>bg,AaK:()=>Ei,qOj:()=>Cv,lbL:()=>vo,Xq5:()=>lx,TTD:()=>Zo,_Bn:()=>Bb,jDz:()=>Vb,xp6:()=>u_,uIk:()=>Uv,ekj:()=>Wv,Suo:()=>gb,Xpm:()=>ha,lG2:()=>Gl,Yz7:()=>qi,cJS:()=>Tt,oAB:()=>fa,Yjl:()=>sl,Y36:()=>yu,_UZ:()=>Qv,GkF:()=>e0,BQk:()=>$_,ynx:()=>V_,qZA:()=>j_,TgZ:()=>U_,EpF:()=>v1,n5z:()=>Id,LFG:()=>Dr,$8M:()=>Fh,$Z:()=>vm,NdJ:()=>s0,CRH:()=>vb,oxw:()=>eb,ALo:()=>iw,lcZ:()=>rw,xi3:()=>ow,Hsn:()=>nb,F$t:()=>tb,Q6J:()=>Zv,s9C:()=>a0,DdM:()=>Kb,iGM:()=>yb,MAs:()=>xb,KtG:()=>tc,CHM:()=>hi,LSH:()=>vf,P3R:()=>nm,Udp:()=>Hv,YNc:()=>jf,_uU:()=>Sb,Oqu:()=>m0,hij:()=>Y_,AsE:()=>g0,lnq:()=>_0,HOy:()=>y0,Gf:()=>_b});let m=null,l=1;const B=Symbol("SIGNAL");function Y(t){const i=m;return m=t,i}function Te(t){if((!Ue(t)||t.dirty)&&(t.dirty||t.lastCleanEpoch!==l)){if(!t.producerMustRecompute(t)&&!xe(t))return t.dirty=!1,void(t.lastCleanEpoch=l);t.producerRecomputeValue(t),t.dirty=!1,t.lastCleanEpoch=l}}function xe(t){ct(t);for(let i=0;i<t.producerNode.length;i++){const s=t.producerNode[i],d=t.producerLastReadVersion[i];if(d!==s.version||(Te(s),d!==s.version))return!0}return!1}function ye(t,i){if(function X(t){t.liveConsumerNode??=[],t.liveConsumerIndexOfThis??=[]}(t),ct(t),1===t.liveConsumerNode.length)for(let d=0;d<t.producerNode.length;d++)ye(t.producerNode[d],t.producerIndexOfThis[d]);const s=t.liveConsumerNode.length-1;if(t.liveConsumerNode[i]=t.liveConsumerNode[s],t.liveConsumerIndexOfThis[i]=t.liveConsumerIndexOfThis[s],t.liveConsumerNode.length--,t.liveConsumerIndexOfThis.length--,i<t.liveConsumerNode.length){const d=t.liveConsumerIndexOfThis[i],g=t.liveConsumerNode[i];ct(g),g.producerIndexOfThis[d]=i}}function Ue(t){return t.consumerIsAlwaysLive||(t?.liveConsumerNode?.length??0)>0}function ct(t){t.producerNode??=[],t.producerIndexOfThis??=[],t.producerLastReadVersion??=[]}let Ht=null;var Cn=P(8645),It=P(7394),pe=P(5619),lt=P(7398);const hn="https://g.co/ng/security#xss";class Yt extends Error{constructor(i,s){super(Ft(i,s)),this.code=i}}function Ft(t,i){return`NG0${Math.abs(t)}${i?": "+i:""}`}function Mi(t){for(let i in t)if(t[i]===Mi)return i;throw Error("Could not find renamed property on target object.")}function dr(t,i){for(const s in i)i.hasOwnProperty(s)&&!t.hasOwnProperty(s)&&(t[s]=i[s])}function Ei(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Ei).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const i=t.toString();if(null==i)return""+i;const s=i.indexOf("\n");return-1===s?i:i.substring(0,s)}function fn(t,i){return null==t||""===t?null===i?"":i:null==i||""===i?t:t+" "+i}const gn=Mi({__forward_ref__:Mi});function Fn(t){return t.__forward_ref__=Fn,t.toString=function(){return Ei(this())},t}function Jt(t){return Bi(t)?t():t}function Bi(t){return"function"==typeof t&&t.hasOwnProperty(gn)&&t.__forward_ref__===Fn}function ut(t){return t&&!!t.\u0275providers}const he=Mi({\u0275cmp:Mi}),_e=Mi({\u0275dir:Mi}),ot=Mi({\u0275pipe:Mi}),yt=Mi({\u0275mod:Mi}),Dt=Mi({\u0275fac:Mi}),jt=Mi({__NG_ELEMENT_ID__:Mi}),Vt=Mi({__NG_ENV_ID__:Mi});function dt(t){return"string"==typeof t?t:null==t?"":String(t)}function Re(t,i){throw new Yt(-201,!1)}function hr(t,i){null==t&&function Ti(t,i,s,d){throw new Error(`ASSERTION ERROR: ${t}`+(null==d?"":` [Expected=> ${s} ${d} ${i} <=Actual]`))}(i,t,null,"!=")}function qi(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Tt(t){return{providers:t.providers||[],imports:t.imports||[]}}function Et(t){return vt(t,Kn)||vt(t,ki)}function ln(t){return null!==Et(t)}function vt(t,i){return t.hasOwnProperty(i)?t[i]:null}function On(t){return t&&(t.hasOwnProperty(pi)||t.hasOwnProperty(rr))?t[pi]:null}const Kn=Mi({\u0275prov:Mi}),pi=Mi({\u0275inj:Mi}),ki=Mi({ngInjectableDef:Mi}),rr=Mi({ngInjectorDef:Mi});var _i=function(t){return t[t.Default=0]="Default",t[t.Host=1]="Host",t[t.Self=2]="Self",t[t.SkipSelf=4]="SkipSelf",t[t.Optional=8]="Optional",t}(_i||{});let or;function Ee(){return or}function Be(t){const i=or;return or=t,i}function ee(t,i,s){const d=Et(t);return d&&"root"==d.providedIn?void 0===d.value?d.value=d.factory():d.value:s&_i.Optional?null:void 0!==i?i:void Re()}const St=globalThis;class V{constructor(i,s){this._desc=i,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof s?this.__NG_ELEMENT_ID__=s:void 0!==s&&(this.\u0275prov=qi({token:this,providedIn:s.providedIn||"root",factory:s.factory}))}get multi(){return this}toString(){return`InjectionToken ${this._desc}`}}const yi={},Vi="__NG_DI_FLAG__",Yi="ngTempTokenPath",Oe=/\n/gm,Ze="__source";let Nt;function Sr(t){const i=Nt;return Nt=t,i}function Qi(t,i=_i.Default){if(void 0===Nt)throw new Yt(-203,!1);return null===Nt?ee(t,void 0,i):Nt.get(t,i&_i.Optional?null:void 0,i)}function Dr(t,i=_i.Default){return(Ee()||Qi)(Jt(t),i)}function ji(t,i=_i.Default){return Dr(t,eo(i))}function eo(t){return typeof t>"u"||"number"==typeof t?t:0|(t.optional&&8)|(t.host&&1)|(t.self&&2)|(t.skipSelf&&4)}function Bs(t){const i=[];for(let s=0;s<t.length;s++){const d=Jt(t[s]);if(Array.isArray(d)){if(0===d.length)throw new Yt(900,!1);let g,b=_i.Default;for(let T=0;T<d.length;T++){const A=d[T],k=To(A);"number"==typeof k?-1===k?g=A.token:b|=k:g=A}i.push(Dr(g,b))}else i.push(Dr(d))}return i}function Xs(t,i){return t[Vi]=i,t.prototype[Vi]=i,t}function To(t){return t[Vi]}function ys(t){return{toString:t}.toString()}var Qs=function(t){return t[t.OnPush=0]="OnPush",t[t.Default=1]="Default",t}(Qs||{}),Mo=function(t){return t[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",t}(Mo||{});const to={},fr=[];var vo=function(t){return t[t.None=0]="None",t[t.SignalBased=1]="SignalBased",t[t.HasDecoratorInputTransform=2]="HasDecoratorInputTransform",t}(vo||{});function Yo(t,i,s){let d=t.length;for(;;){const g=t.indexOf(i,s);if(-1===g)return g;if(0===g||t.charCodeAt(g-1)<=32){const b=i.length;if(g+b===d||t.charCodeAt(g+b)<=32)return g}s=g+1}}function zs(t,i,s){let d=0;for(;d<s.length;){const g=s[d];if("number"==typeof g){if(0!==g)break;d++;const b=s[d++],T=s[d++],A=s[d++];t.setAttribute(i,T,A,b)}else{const b=g,T=s[++d];Jo(b)?t.setProperty(i,b,T):t.setAttribute(i,b,T),d++}}return d}function Po(t){return 3===t||4===t||6===t}function Jo(t){return 64===t.charCodeAt(0)}function vs(t,i){if(null!==i&&0!==i.length)if(null===t||0===t.length)t=i.slice();else{let s=-1;for(let d=0;d<i.length;d++){const g=i[d];"number"==typeof g?s=g:0===s||Ko(t,s,g,null,-1===s||2===s?i[++d]:null)}}return t}function Ko(t,i,s,d,g){let b=0,T=t.length;if(-1===i)T=-1;else for(;b<t.length;){const A=t[b++];if("number"==typeof A){if(A===i){T=-1;break}if(A>i){T=b-1;break}}}for(;b<t.length;){const A=t[b];if("number"==typeof A)break;if(A===s){if(null===d)return void(null!==g&&(t[b+1]=g));if(d===t[b+1])return void(t[b+2]=g)}b++,null!==d&&b++,null!==g&&b++}-1!==T&&(t.splice(T,0,i),b=T+1),t.splice(b++,0,s),null!==d&&t.splice(b++,0,d),null!==g&&t.splice(b++,0,g)}const rl="ng-template";function la(t,i,s){let d=0,g=!0;for(;d<t.length;){let b=t[d++];if("string"==typeof b&&g){const T=t[d++];if(s&&"class"===b&&-1!==Yo(T.toLowerCase(),i,0))return!0}else{if(1===b){for(;d<t.length&&"string"==typeof(b=t[d++]);)if(b.toLowerCase()===i)return!0;return!1}"number"==typeof b&&(g=!1)}}return!1}function ca(t){return 4===t.type&&t.value!==rl}function Ba(t,i,s){return i===(4!==t.type||s?t.value:rl)}function xs(t,i,s){let d=4;const g=t.attrs||[],b=function ol(t){for(let i=0;i<t.length;i++)if(Po(t[i]))return i;return t.length}(g);let T=!1;for(let A=0;A<i.length;A++){const k=i[A];if("number"!=typeof k){if(!T)if(4&d){if(d=2|1&d,""!==k&&!Ba(t,k,s)||""===k&&1===i.length){if(Wi(d))return!1;T=!0}}else{const q=8&d?k:i[++A];if(8&d&&null!==t.attrs){if(!la(t.attrs,q,s)){if(Wi(d))return!1;T=!0}continue}const Je=za(8&d?"class":k,g,ca(t),s);if(-1===Je){if(Wi(d))return!1;T=!0;continue}if(""!==q){let Rt;Rt=Je>b?"":g[Je+1].toLowerCase();const Gt=8&d?Rt:null;if(Gt&&-1!==Yo(Gt,q,0)||2&d&&q!==Rt){if(Wi(d))return!1;T=!0}}}}else{if(!T&&!Wi(d)&&!Wi(k))return!1;if(T&&Wi(k))continue;T=!1,d=k|1&d}}return Wi(d)||T}function Wi(t){return 0==(1&t)}function za(t,i,s,d){if(null===i)return-1;let g=0;if(d||!s){let b=!1;for(;g<i.length;){const T=i[g];if(T===t)return g;if(3===T||6===T)b=!0;else{if(1===T||2===T){let A=i[++g];for(;"string"==typeof A;)A=i[++g];continue}if(4===T)break;if(0===T){g+=4;continue}}g+=b?1:2}return-1}return function Zl(t,i){let s=t.indexOf(4);if(s>-1)for(s++;s<t.length;){const d=t[s];if("number"==typeof d)return-1;if(d===i)return s;s++}return-1}(i,t)}function Ca(t,i,s=!1){for(let d=0;d<i.length;d++)if(xs(t,i[d],s))return!0;return!1}function ua(t,i){e:for(let s=0;s<i.length;s++){const d=i[s];if(t.length===d.length){for(let g=0;g<t.length;g++)if(t[g]!==d[g])continue e;return!0}}return!1}function da(t,i){return t?":not("+i.trim()+")":i}function Ua(t){let i=t[0],s=1,d=2,g="",b=!1;for(;s<t.length;){let T=t[s];if("string"==typeof T)if(2&d){const A=t[++s];g+="["+T+(A.length>0?'="'+A+'"':"")+"]"}else 8&d?g+="."+T:4&d&&(g+=" "+T);else""!==g&&!Wi(T)&&(i+=da(b,g),g=""),d=T,b=b||!Wi(d);s++}return""!==g&&(i+=da(b,g)),i}function ha(t){return ys(()=>{const i=re(t),s={...i,decls:t.decls,vars:t.vars,template:t.template,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,onPush:t.changeDetection===Qs.OnPush,directiveDefs:null,pipeDefs:null,dependencies:i.standalone&&t.dependencies||null,getStandaloneInjector:null,signals:t.signals??!1,data:t.data||{},encapsulation:t.encapsulation||Mo.Emulated,styles:t.styles||fr,_:null,schemas:t.schemas||null,tView:null,id:""};ce(s);const d=t.dependencies;return s.directiveDefs=G(d,!1),s.pipeDefs=G(d,!0),s.id=function zt(t){let i=0;const s=[t.selectors,t.ngContentSelectors,t.hostVars,t.hostAttrs,t.consts,t.vars,t.decls,t.encapsulation,t.standalone,t.signals,t.exportAs,JSON.stringify(t.inputs),JSON.stringify(t.outputs),Object.getOwnPropertyNames(t.type.prototype),!!t.contentQueries,!!t.viewQuery].join("|");for(const g of s)i=Math.imul(31,i)+g.charCodeAt(0)<<0;return i+=2147483648,"c"+i}(s),s})}function Ea(t){return nr(t)||ro(t)}function Xo(t){return null!==t}function fa(t){return ys(()=>({type:t.type,bootstrap:t.bootstrap||fr,declarations:t.declarations||fr,imports:t.imports||fr,exports:t.exports||fr,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null}))}function ea(t,i){if(null==t)return to;const s={};for(const d in t)if(t.hasOwnProperty(d)){const g=t[d];let b,T,A=vo.None;Array.isArray(g)?(A=g[0],b=g[1],T=g[2]??b):(b=g,T=g),i?(s[b]=A!==vo.None?[d,A]:d,i[b]=T):s[b]=d}return s}function Gl(t){return ys(()=>{const i=re(t);return ce(i),i})}function sl(t){return{type:t.type,name:t.name,factory:null,pure:!1!==t.pure,standalone:!0===t.standalone,onDestroy:t.type.prototype.ngOnDestroy||null}}function nr(t){return t[he]||null}function ro(t){return t[_e]||null}function Pi(t){return t[ot]||null}function Qo(t){const i=nr(t)||ro(t)||Pi(t);return null!==i&&i.standalone}function Ao(t,i){const s=t[yt]||null;if(!s&&!0===i)throw new Error(`Type ${Ei(t)} does not have '\u0275mod' property.`);return s}function re(t){const i={};return{type:t.type,providersResolver:null,factory:null,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:i,inputTransforms:null,inputConfig:t.inputs||to,exportAs:t.exportAs||null,standalone:!0===t.standalone,signals:!0===t.signals,selectors:t.selectors||fr,viewQuery:t.viewQuery||null,features:t.features||null,setInput:null,findHostDirectiveDefs:null,hostDirectives:null,inputs:ea(t.inputs,i),outputs:ea(t.outputs),debugInfo:null}}function ce(t){t.features?.forEach(i=>i(t))}function G(t,i){if(!t)return null;const s=i?Pi:Ea;return()=>("function"==typeof t?t():t).map(d=>s(d)).filter(Xo)}const ni=0,Ln=1,Di=2,zr=3,Oo=4,Do=5,bs=6,al=7,$r=8,xo=9,Ro=10,Ui=11,js=12,wl=13,No=14,kr=15,ws=16,pa=17,Vs=18,ma=19,Hl=20,$s=21,Va=22,es=23,Gi=25,ta=1,Cs=7,na=9,oo=10;var $a=function(t){return t[t.None=0]="None",t[t.HasTransplantedViews=2]="HasTransplantedViews",t}($a||{});function Io(t){return Array.isArray(t)&&"object"==typeof t[ta]}function fo(t){return Array.isArray(t)&&!0===t[ta]}function El(t){return 0!=(4&t.flags)}function Za(t){return t.componentOffset>-1}function ql(t){return 1==(1&t.flags)}function Zs(t){return!!t.template}function gc(t){return 0!=(512&t[Di])}function ao(t,i){return t.hasOwnProperty(Dt)?t[Dt]:null}class Es{constructor(i,s,d){this.previousValue=i,this.currentValue=s,this.firstChange=d}isFirstChange(){return this.firstChange}}function Ts(t,i,s,d){null!==i?i.applyValueToInputSignal(i,d):t[s]=d}function Zo(){return zo}function zo(t){return t.type.prototype.ngOnChanges&&(t.setInput=Da),ia}function ia(){const t=Ws(this),i=t?.current;if(i){const s=t.previous;if(s===to)t.previous=i;else for(let d in i)s[d]=i[d];t.current=null,this.ngOnChanges(i)}}function Da(t,i,s,d,g){const b=this.declaredInputs[d],T=Ws(t)||function Du(t,i){return t[li]=i}(t,{previous:to,current:null}),A=T.current||(T.current={}),k=T.previous,q=k[b];A[b]=new Es(q&&q.currentValue,s,k===to),Ts(t,i,g,s)}Zo.ngInherit=!0;const li="__ngSimpleChanges__";function Ws(t){return t[li]||null}const Zr=function(t,i,s){};let Xl=!1;function Fr(t){for(;Array.isArray(t);)t=t[ni];return t}function ll(t,i){return Fr(i[t])}function ts(t,i){return Fr(i[t.index])}function _a(t,i){return t.data[i]}function Wa(t,i){return t[i]}function Lo(t,i){const s=i[t];return Io(s)?s:s[ni]}function Il(t){return 128==(128&t[Di])}function Is(t,i){return null==i?null:t[i]}function Hc(t){t[pa]=0}function Iu(t){1024&t[Di]||(t[Di]|=1024,Il(t)&&cl(t))}function vc(t){return 9216&t[Di]||t[es]?.dirty}function Ia(t){vc(t)?cl(t):64&t[Di]&&(function yc(){return Xl}()?(t[Di]|=1024,cl(t)):t[Ro].changeDetectionScheduler?.notify())}function cl(t){t[Ro].changeDetectionScheduler?.notify();let i=ul(t);for(;null!==i&&!(8192&i[Di])&&(i[Di]|=8192,Il(i));)i=ul(i)}function hs(t,i){if(256==(256&t[Di]))throw new Yt(911,!1);null===t[$s]&&(t[$s]=[]),t[$s].push(i)}function ul(t){const i=t[zr];return fo(i)?i[zr]:i}const Hi={lFrame:z(null),bindingsEnabled:!0,skipHydrationRootTNode:null};function Pu(){return Hi.bindingsEnabled}function ec(){return null!==Hi.skipHydrationRootTNode}function Sn(){return Hi.lFrame.lView}function gr(){return Hi.lFrame.tView}function hi(t){return Hi.lFrame.contextLView=t,t[$r]}function tc(t){return Hi.lFrame.contextLView=null,t}function Nr(){let t=dl();for(;null!==t&&64===t.type;)t=t.parent;return t}function dl(){return Hi.lFrame.currentTNode}function oi(t,i){const s=Hi.lFrame;s.currentTNode=t,s.isParent=i}function nc(){return Hi.lFrame.isParent}function Yc(){Hi.lFrame.isParent=!1}function ns(){const t=Hi.lFrame;let i=t.bindingRootIndex;return-1===i&&(i=t.bindingRootIndex=t.tView.bindingStartIndex),i}function qa(){return Hi.lFrame.bindingIndex}function oa(){return Hi.lFrame.bindingIndex++}function va(t){const i=Hi.lFrame,s=i.bindingIndex;return i.bindingIndex=i.bindingIndex+t,s}function u(t,i){const s=Hi.lFrame;s.bindingIndex=s.bindingRootIndex=t,a(i)}function a(t){Hi.lFrame.currentDirectiveIndex=t}function y(){return Hi.lFrame.currentQueryIndex}function x(t){Hi.lFrame.currentQueryIndex=t}function D(t){const i=t[Ln];return 2===i.type?i.declTNode:1===i.type?t[Do]:null}function I(t,i,s){if(s&_i.SkipSelf){let g=i,b=t;for(;!(g=g.parent,null!==g||s&_i.Host||(g=D(b),null===g||(b=b[No],10&g.type))););if(null===g)return!1;i=g,t=b}const d=Hi.lFrame=U();return d.currentTNode=i,d.lView=t,!0}function R(t){const i=U(),s=t[Ln];Hi.lFrame=i,i.currentTNode=s.firstChild,i.lView=t,i.tView=s,i.contextLView=t,i.bindingIndex=s.bindingStartIndex,i.inI18n=!1}function U(){const t=Hi.lFrame,i=null===t?null:t.child;return null===i?z(t):i}function z(t){const i={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=i),i}function Q(){const t=Hi.lFrame;return Hi.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Se=Q;function je(){const t=Q();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function $e(){return Hi.lFrame.selectedIndex}function et(t){Hi.lFrame.selectedIndex=t}function ne(){const t=Hi.lFrame;return _a(t.tView,t.selectedIndex)}let Lt=!0;function qt(){return Lt}function $t(t){Lt=t}function Wn(t,i){for(let s=i.directiveStart,d=i.directiveEnd;s<d;s++){const b=t.data[s].type.prototype,{ngAfterContentInit:T,ngAfterContentChecked:A,ngAfterViewInit:k,ngAfterViewChecked:q,ngOnDestroy:ge}=b;T&&(t.contentHooks??=[]).push(-s,T),A&&((t.contentHooks??=[]).push(s,A),(t.contentCheckHooks??=[]).push(s,A)),k&&(t.viewHooks??=[]).push(-s,k),q&&((t.viewHooks??=[]).push(s,q),(t.viewCheckHooks??=[]).push(s,q)),null!=ge&&(t.destroyHooks??=[]).push(s,ge)}}function nn(t,i,s){qn(t,i,3,s)}function Mn(t,i,s,d){(3&t[Di])===s&&qn(t,i,s,d)}function pn(t,i){let s=t[Di];(3&s)===i&&(s&=16383,s+=1,t[Di]=s)}function qn(t,i,s,d){const b=d??-1,T=i.length-1;let A=0;for(let k=void 0!==d?65535&t[pa]:0;k<T;k++)if("number"==typeof i[k+1]){if(A=i[k],null!=d&&A>=d)break}else i[k]<0&&(t[pa]+=65536),(A<b||-1==b)&&(An(t,s,i,k),t[pa]=(4294901760&t[pa])+k+2),k++}function sn(t,i){Zr(4,t,i);const s=Y(null);try{i.call(t)}finally{Y(s),Zr(5,t,i)}}function An(t,i,s,d){const g=s[d]<0,b=s[d+1],A=t[g?-s[d]:s[d]];g?t[Di]>>14<t[pa]>>16&&(3&t[Di])===i&&(t[Di]+=16384,sn(A,b)):sn(A,b)}const Zn=-1;class kn{constructor(i,s,d){this.factory=i,this.resolving=!1,this.canSeeViewProviders=s,this.injectImpl=d}}function Ci(t){return t!==Zn}function br(t){return 32767&t}function Ir(t,i){let s=function Gr(t){return t>>16}(t),d=i;for(;s>0;)d=d[No],s--;return d}let Br=!0;function jo(t){const i=Br;return Br=t,i}const sa=255,Aa=5;let co=0;const yr={};function go(t,i){const s=no(t,i);if(-1!==s)return s;const d=i[Ln];d.firstCreatePass&&(t.injectorIndex=i.length,rs(d.data,t),rs(i,null),rs(d.blueprint,null));const g=os(t,i),b=t.injectorIndex;if(Ci(g)){const T=br(g),A=Ir(g,i),k=A[Ln].data;for(let q=0;q<8;q++)i[b+q]=A[T+q]|k[T+q]}return i[b+8]=g,b}function rs(t,i){t.push(0,0,0,0,0,0,0,0,i)}function no(t,i){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===i[t.injectorIndex+8]?-1:t.injectorIndex}function os(t,i){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let s=0,d=null,g=i;for(;null!==g;){if(d=hp(g),null===d)return Zn;if(s++,g=g[No],-1!==d.injectorIndex)return d.injectorIndex|s<<16}return Zn}function xc(t,i,s){!function Er(t,i,s){let d;"string"==typeof s?d=s.charCodeAt(0)||0:s.hasOwnProperty(jt)&&(d=s[jt]),null==d&&(d=s[jt]=co++);const g=d&sa;i.data[t+(g>>Aa)]|=1<<g}(t,i,s)}function bc(t,i,s){if(s&_i.Optional||void 0!==t)return t;Re()}function Ya(t,i,s,d){if(s&_i.Optional&&void 0===d&&(d=null),!(s&(_i.Self|_i.Host))){const g=t[xo],b=Be(void 0);try{return g?g.get(i,d,s&_i.Optional):ee(i,d,s&_i.Optional)}finally{Be(b)}}return bc(d,0,s)}function hl(t,i,s,d=_i.Default,g){if(null!==t){if(2048&i[Di]&&!(d&_i.Self)){const T=function kh(t,i,s,d,g){let b=t,T=i;for(;null!==b&&null!==T&&2048&T[Di]&&!(512&T[Di]);){const A=Sl(b,T,s,d|_i.Self,yr);if(A!==yr)return A;let k=b.parent;if(!k){const q=T[Hl];if(q){const ge=q.get(s,yr,d);if(ge!==yr)return ge}k=hp(T),T=T[No]}b=k}return g}(t,i,s,d,yr);if(T!==yr)return T}const b=Sl(t,i,s,d,yr);if(b!==yr)return b}return Ya(i,s,d,g)}function Sl(t,i,s,d,g){const b=function ig(t){if("string"==typeof t)return t.charCodeAt(0)||0;const i=t.hasOwnProperty(jt)?t[jt]:void 0;return"number"==typeof i?i>=0?i&sa:dp:i}(s);if("function"==typeof b){if(!I(i,t,d))return d&_i.Host?bc(g,0,d):Ya(i,s,d,g);try{let T;if(T=b(d),null!=T||d&_i.Optional)return T;Re()}finally{Se()}}else if("number"==typeof b){let T=null,A=no(t,i),k=Zn,q=d&_i.Host?i[kr][Do]:null;for((-1===A||d&_i.SkipSelf)&&(k=-1===A?os(t,i):i[A+8],k!==Zn&&rg(d,!1)?(T=i[Ln],A=br(k),i=Ir(k,i)):A=-1);-1!==A;){const ge=i[Ln];if(up(b,A,ge.data)){const Je=ku(A,i,s,T,d,q);if(Je!==yr)return Je}k=i[A+8],k!==Zn&&rg(d,i[Ln].data[A+8]===q)&&up(b,A,i)?(T=ge,A=br(k),i=Ir(k,i)):A=-1}}return g}function ku(t,i,s,d,g,b){const T=i[Ln],A=T.data[t+8],ge=Pl(A,T,s,null==d?Za(A)&&Br:d!=T&&0!=(3&A.type),g&_i.Host&&b===A);return null!==ge?fl(i,T,ge,A):yr}function Pl(t,i,s,d,g){const b=t.providerIndexes,T=i.data,A=1048575&b,k=t.directiveStart,ge=b>>20,Rt=g?A+ge:t.directiveEnd;for(let Gt=d?A:A+ge;Gt<Rt;Gt++){const Tn=T[Gt];if(Gt<k&&s===Tn||Gt>=k&&Tn.type===s)return Gt}if(g){const Gt=T[k];if(Gt&&Zs(Gt)&&Gt.type===s)return k}return null}function fl(t,i,s,d){let g=t[s];const b=i.data;if(function ti(t){return t instanceof kn}(g)){const T=g;T.resolving&&function ae(t,i){const s=i?`. Dependency path: ${i.join(" > ")} > ${t}`:"";throw new Yt(-200,`Circular dependency in DI detected for ${t}${s}`)}(function Bt(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():dt(t)}(b[s]));const A=jo(T.canSeeViewProviders);T.resolving=!0;const q=T.injectImpl?Be(T.injectImpl):null;I(t,d,_i.Default);try{g=t[s]=T.factory(void 0,b,t,d),i.firstCreatePass&&s>=d.directiveStart&&function cn(t,i,s){const{ngOnChanges:d,ngOnInit:g,ngDoCheck:b}=i.type.prototype;if(d){const T=zo(i);(s.preOrderHooks??=[]).push(t,T),(s.preOrderCheckHooks??=[]).push(t,T)}g&&(s.preOrderHooks??=[]).push(0-t,g),b&&((s.preOrderHooks??=[]).push(t,b),(s.preOrderCheckHooks??=[]).push(t,b))}(s,b[s],i)}finally{null!==q&&Be(q),jo(A),T.resolving=!1,Se()}}return g}function up(t,i,s){return!!(s[i+(t>>Aa)]&1<<t)}function rg(t,i){return!(t&_i.Self||t&_i.Host&&i)}class Go{constructor(i,s){this._tNode=i,this._lView=s}get(i,s,d){return hl(this._tNode,this._lView,i,eo(d),s)}}function dp(){return new Go(Nr(),Sn())}function Id(t){return ys(()=>{const i=t.prototype.constructor,s=i[Dt]||pl(i),d=Object.prototype;let g=Object.getPrototypeOf(t.prototype).constructor;for(;g&&g!==d;){const b=g[Dt]||pl(g);if(b&&b!==s)return b;g=Object.getPrototypeOf(g)}return b=>new b})}function pl(t){return Bi(t)?()=>{const i=pl(Jt(t));return i&&i()}:ao(t)}function hp(t){const i=t[Ln],s=i.type;return 2===s?i.declTNode:1===s?t[Do]:null}function Fh(t){return function ic(t,i){if("class"===i)return t.classes;if("style"===i)return t.styles;const s=t.attrs;if(s){const d=s.length;let g=0;for(;g<d;){const b=s[g];if(Po(b))break;if(0===b)g+=2;else if("number"==typeof b)for(g++;g<d&&"string"==typeof s[g];)g++;else{if(b===i)return s[g+1];g+=2}}}return null}(Nr(),t)}const Nu="__parameters__";function ml(t,i,s){return ys(()=>{const d=function Xc(t){return function(...s){if(t){const d=t(...s);for(const g in d)this[g]=d[g]}}}(i);function g(...b){if(this instanceof g)return d.apply(this,b),this;const T=new g(...b);return A.annotation=T,A;function A(k,q,ge){const Je=k.hasOwnProperty(Nu)?k[Nu]:Object.defineProperty(k,Nu,{value:[]})[Nu];for(;Je.length<=ge;)Je.push(null);return(Je[ge]=Je[ge]||[]).push(T),k}}return s&&(g.prototype=Object.create(s.prototype)),g.prototype.ngMetadataName=t,g.annotationCls=g,g})}function Sa(t,i){t.forEach(s=>Array.isArray(s)?Sa(s,i):i(s))}function Ad(t,i,s){i>=t.length?t.push(s):t.splice(i,0,s)}function As(t,i){return i>=t.length-1?t.pop():t.splice(i,1)[0]}function Ss(t,i,s){let d=Ec(t,i);return d>=0?t[1|d]=s:(d=~d,function zh(t,i,s,d){let g=t.length;if(g==i)t.push(s,d);else if(1===g)t.push(d,t[0]),t[0]=s;else{for(g--,t.push(t[g-1],t[g]);g>i;)t[g]=t[g-2],g--;t[i]=s,t[i+1]=d}}(t,d,i,s)),d}function oc(t,i){const s=Ec(t,i);if(s>=0)return t[1|s]}function Ec(t,i){return function pp(t,i,s){let d=0,g=t.length>>s;for(;g!==d;){const b=d+(g-d>>1),T=t[b<<s];if(i===T)return b<<s;T>i?g=b:d=b+1}return~(g<<s)}(t,i,1)}const Tc=Xs(ml("Optional"),8),qs=Xs(ml("SkipSelf"),4),nu=new V("ENVIRONMENT_INITIALIZER"),pg=new V("INJECTOR",-1),Uh=new V("INJECTOR_DEF_TYPES");class Fd{get(i,s=yi){if(s===yi){const d=new Error(`NullInjectorError: No provider for ${Ei(i)}!`);throw d.name="NullInjectorError",d}return s}}function Dc(t){return{\u0275providers:t}}function _p(...t){return{\u0275providers:jh(0,t),\u0275fromNgModule:!0}}function jh(t,...i){const s=[],d=new Set;let g;const b=T=>{s.push(T)};return Sa(i,T=>{const A=T;ss(A,b,[],d)&&(g||=[],g.push(A))}),void 0!==g&&Vh(g,b),s}function Vh(t,i){for(let s=0;s<t.length;s++){const{ngModule:d,providers:g}=t[s];$h(g,b=>{i(b,d)})}}function ss(t,i,s,d){if(!(t=Jt(t)))return!1;let g=null,b=On(t);const T=!b&&nr(t);if(b||T){if(T&&!T.standalone)return!1;g=t}else{const k=t.ngModule;if(b=On(k),!b)return!1;g=k}const A=d.has(g);if(T){if(A)return!1;if(d.add(g),T.dependencies){const k="function"==typeof T.dependencies?T.dependencies():T.dependencies;for(const q of k)ss(q,i,s,d)}}else{if(!b)return!1;{if(null!=b.imports&&!A){let q;d.add(g);try{Sa(b.imports,ge=>{ss(ge,i,s,d)&&(q||=[],q.push(ge))})}finally{}void 0!==q&&Vh(q,i)}if(!A){const q=ao(g)||(()=>new g);i({provide:g,useFactory:q,deps:fr},g),i({provide:Uh,useValue:g,multi:!0},g),i({provide:nu,useValue:()=>Dr(g),multi:!0},g)}const k=b.providers;if(null!=k&&!A){const q=t;$h(k,ge=>{i(ge,q)})}}}return g!==t&&void 0!==t.providers}function $h(t,i){for(let s of t)ut(s)&&(s=s.\u0275providers),Array.isArray(s)?$h(s,i):i(s)}const Rl=Mi({provide:String,useValue:Mi});function yp(t){return null!==t&&"object"==typeof t&&Rl in t}function fs(t){return"function"==typeof t}const vp=new V("Set Injector scope."),iu={},gg={};let xp;function Hu(){return void 0===xp&&(xp=new Fd),xp}class as{}class Ka extends as{get destroyed(){return this._destroyed}constructor(i,s,d,g){super(),this.parent=s,this.source=d,this.scopes=g,this.records=new Map,this._ngOnDestroyHooks=new Set,this._onDestroyHooks=[],this._destroyed=!1,Yu(i,T=>this.processProvider(T)),this.records.set(pg,Mc(void 0,this)),g.has("environment")&&this.records.set(as,Mc(void 0,this));const b=this.records.get(vp);null!=b&&"string"==typeof b.value&&this.scopes.add(b.value),this.injectorDefTypes=new Set(this.get(Uh,fr,_i.Self))}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{for(const s of this._ngOnDestroyHooks)s.ngOnDestroy();const i=this._onDestroyHooks;this._onDestroyHooks=[];for(const s of i)s()}finally{this.records.clear(),this._ngOnDestroyHooks.clear(),this.injectorDefTypes.clear()}}onDestroy(i){return this.assertNotDestroyed(),this._onDestroyHooks.push(i),()=>this.removeOnDestroy(i)}runInContext(i){this.assertNotDestroyed();const s=Sr(this),d=Be(void 0);try{return i()}finally{Sr(s),Be(d)}}get(i,s=yi,d=_i.Default){if(this.assertNotDestroyed(),i.hasOwnProperty(Vt))return i[Vt](this);d=eo(d);const b=Sr(this),T=Be(void 0);try{if(!(d&_i.SkipSelf)){let k=this.records.get(i);if(void 0===k){const q=function Bd(t){return"function"==typeof t||"object"==typeof t&&t instanceof V}(i)&&Et(i);k=q&&this.injectableDefInScope(q)?Mc(Zh(i),iu):null,this.records.set(i,k)}if(null!=k)return this.hydrate(i,k)}return(d&_i.Self?Hu():this.parent).get(i,s=d&_i.Optional&&s===yi?null:s)}catch(A){if("NullInjectorError"===A.name){if((A[Yi]=A[Yi]||[]).unshift(Ei(i)),b)throw A;return function $o(t,i,s,d){const g=t[Yi];throw i[Ze]&&g.unshift(i[Ze]),t.message=function ds(t,i,s,d=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.slice(2):t;let g=Ei(i);if(Array.isArray(i))g=i.map(Ei).join(" -> ");else if("object"==typeof i){let b=[];for(let T in i)if(i.hasOwnProperty(T)){let A=i[T];b.push(T+":"+("string"==typeof A?JSON.stringify(A):Ei(A)))}g=`{${b.join(", ")}}`}return`${s}${d?"("+d+")":""}[${g}]: ${t.replace(Oe,"\n  ")}`}("\n"+t.message,g,s,d),t.ngTokenPath=g,t[Yi]=null,t}(A,i,"R3InjectorError",this.source)}throw A}finally{Be(T),Sr(b)}}resolveInjectorInitializers(){const i=Sr(this),s=Be(void 0);try{const g=this.get(nu,fr,_i.Self);for(const b of g)b()}finally{Sr(i),Be(s)}}toString(){const i=[],s=this.records;for(const d of s.keys())i.push(Ei(d));return`R3Injector[${i.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Yt(205,!1)}processProvider(i){let s=fs(i=Jt(i))?i:Jt(i&&i.provide);const d=function _y(t){return yp(t)?Mc(void 0,t.useValue):Mc(Nd(t),iu)}(i);if(!fs(i)&&!0===i.multi){let g=this.records.get(s);g||(g=Mc(void 0,iu,!0),g.factory=()=>Bs(g.multi),this.records.set(s,g)),s=i,g.multi.push(i)}this.records.set(s,d)}hydrate(i,s){return s.value===iu&&(s.value=gg,s.value=s.factory()),"object"==typeof s.value&&s.value&&function qu(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(s.value)&&this._ngOnDestroyHooks.add(s.value),s.value}injectableDefInScope(i){if(!i.providedIn)return!1;const s=Jt(i.providedIn);return"string"==typeof s?"any"===s||this.scopes.has(s):this.injectorDefTypes.has(s)}removeOnDestroy(i){const s=this._onDestroyHooks.indexOf(i);-1!==s&&this._onDestroyHooks.splice(s,1)}}function Zh(t){const i=Et(t),s=null!==i?i.factory:ao(t);if(null!==s)return s;if(t instanceof V)throw new Yt(204,!1);if(t instanceof Function)return function _g(t){if(t.length>0)throw new Yt(204,!1);const s=function Hn(t){return t&&(t[Kn]||t[ki])||null}(t);return null!==s?()=>s.factory(t):()=>new t}(t);throw new Yt(204,!1)}function Nd(t,i,s){let d;if(fs(t)){const g=Jt(t);return ao(g)||Zh(g)}if(yp(t))d=()=>Jt(t.useValue);else if(function Gu(t){return!(!t||!t.useFactory)}(t))d=()=>t.useFactory(...Bs(t.deps||[]));else if(function Ic(t){return!(!t||!t.useExisting)}(t))d=()=>Dr(Jt(t.useExisting));else{const g=Jt(t&&(t.useClass||t.provide));if(!function Wu(t){return!!t.deps}(t))return ao(g)||Zh(g);d=()=>new g(...Bs(t.deps))}return d}function Mc(t,i,s=!1){return{factory:t,value:i,multi:s?[]:void 0}}function Yu(t,i){for(const s of t)Array.isArray(s)?Yu(s,i):s&&ut(s)?Yu(s.\u0275providers,i):i(s)}function yg(t,i){t instanceof Ka&&t.assertNotDestroyed();const d=Sr(t),g=Be(void 0);try{return i()}finally{Sr(d),Be(g)}}function Ep(t,i=null,s=null,d){const g=sc(t,i,s,d);return g.resolveInjectorInitializers(),g}function sc(t,i=null,s=null,d,g=new Set){const b=[s||fr,_p(t)];return d=d||("object"==typeof t?void 0:Ei(t)),new Ka(b,i||Hu(),d||null,g)}let Ho,pr=(()=>{class t{static#e=this.THROW_IF_NOT_FOUND=yi;static#t=this.NULL=new Fd;static create(s,d){if(Array.isArray(s))return Ep({name:""},d,s,"");{const g=s.name??"";return Ep({name:g},s.parent,s.providers,g)}}static#n=this.\u0275prov=qi({token:t,providedIn:"any",factory:()=>Dr(pg)});static#i=this.__NG_ELEMENT_ID__=-1}return t})();function Os(t){return!!Ao(t)}function bg(t){Ho=t}const Wh=new V("AppId",{providedIn:"root",factory:()=>wg}),wg="ng",qh=new V("Platform Initializer"),Tp=new V("Platform ID",{providedIn:"platform",factory:()=>"unknown"}),by=new V("CSP nonce",{providedIn:"root",factory:()=>function Oa(){if(void 0!==Ho)return Ho;if(typeof document<"u")return document;throw new Yt(210,!1)}().body?.querySelector("[ngCspNonce]")?.getAttribute("ngCspNonce")||null});function Ra(t){return t instanceof Function?t():t}function Gd(t){return 128==(128&t.flags)}var Pc=function(t){return t[t.Important=1]="Important",t[t.DashCase=2]="DashCase",t}(Pc||{});const Sy=/^>|^->|<!--|-->|--!>|<!-$/g,Py=/(<|>)/g,Oy="\u200b$1\u200b";const Sp=new Map;let Ry=0;const Qu="__ngContext__";function ls(t,i){Io(i)?(t[Qu]=i[ma],function Pp(t){Sp.set(t[ma],t)}(i)):t[Qu]=i}let qd;function Np(t,i){return qd(t,i)}function Oc(t,i,s,d,g){if(null!=d){let b,T=!1;fo(d)?b=d:Io(d)&&(T=!0,d=d[ni]);const A=Fr(d);0===t&&null!==s?null==g?cf(i,s,A):uu(i,s,A,g||null,!0):1===t&&null!==s?uu(i,s,A,g||null,!0):2===t?function Qd(t,i,s){const d=df(t,i);d&&function uf(t,i,s,d){t.removeChild(i,s,d)}(t,d,i,s)}(i,A,T):3===t&&i.destroyNode(A),null!=b&&function Bg(t,i,s,d,g){const b=s[Cs];b!==Fr(s)&&Oc(i,t,d,b,g);for(let A=oo;A<s.length;A++){const k=s[A];pf(k[Ln],k,t,i,d,b)}}(i,t,b,s,g)}}function zp(t,i){return t.createComment(function Mg(t){return t.replace(Sy,i=>i.replace(Py,Oy))}(i))}function sf(t,i,s){return t.createElement(i,s)}function Pg(t,i){pf(t,i,i[Ui],2,null,null)}function cu(t,i){const s=t[na],d=s.indexOf(i);s.splice(d,1)}function Yd(t,i){if(t.length<=oo)return;const s=oo+i,d=t[s];if(d){const g=d[ws];null!==g&&g!==t&&cu(g,d),i>0&&(t[s-1][Oo]=d[Oo]);const b=As(t,oo+i);!function By(t,i){Pg(t,i),i[ni]=null,i[Do]=null}(d[Ln],d);const T=b[Vs];null!==T&&T.detachView(b[Ln]),d[zr]=null,d[Oo]=null,d[Di]&=-129}return d}function lf(t,i){if(!(256&i[Di])){const s=i[Ui];s.destroyNode&&pf(t,i,s,3,null,null),function af(t){let i=t[js];if(!i)return Up(t[Ln],t);for(;i;){let s=null;if(Io(i))s=i[js];else{const d=i[oo];d&&(s=d)}if(!s){for(;i&&!i[Oo]&&i!==t;)Io(i)&&Up(i[Ln],i),i=i[zr];null===i&&(i=t),Io(i)&&Up(i[Ln],i),s=i&&i[Oo]}i=s}}(i)}}function Up(t,i){if(!(256&i[Di])){i[Di]&=-129,i[Di]|=256,i[es]&&function Ie(t){if(ct(t),Ue(t))for(let i=0;i<t.producerNode.length;i++)ye(t.producerNode[i],t.producerIndexOfThis[i]);t.producerNode.length=t.producerLastReadVersion.length=t.producerIndexOfThis.length=0,t.liveConsumerNode&&(t.liveConsumerNode.length=t.liveConsumerIndexOfThis.length=0)}(i[es]),function Lg(t,i){let s;if(null!=t&&null!=(s=t.destroyHooks))for(let d=0;d<s.length;d+=2){const g=i[s[d]];if(!(g instanceof kn)){const b=s[d+1];if(Array.isArray(b))for(let T=0;T<b.length;T+=2){const A=g[b[T]],k=b[T+1];Zr(4,A,k);try{k.call(A)}finally{Zr(5,A,k)}}else{Zr(4,g,b);try{b.call(g)}finally{Zr(5,g,b)}}}}}(t,i),function Rg(t,i){const s=t.cleanup,d=i[al];if(null!==s)for(let b=0;b<s.length-1;b+=2)if("string"==typeof s[b]){const T=s[b+3];T>=0?d[T]():d[-T].unsubscribe(),b+=2}else s[b].call(d[s[b+1]]);null!==d&&(i[al]=null);const g=i[$s];if(null!==g){i[$s]=null;for(let b=0;b<g.length;b++)(0,g[b])()}}(t,i),1===i[Ln].type&&i[Ui].destroy();const s=i[ws];if(null!==s&&fo(i[zr])){s!==i[zr]&&cu(s,i);const d=i[Vs];null!==d&&d.detachView(t)}!function Ku(t){Sp.delete(t[ma])}(i)}}function jp(t,i,s){return function kg(t,i,s){let d=i;for(;null!==d&&40&d.type;)d=(i=d).parent;if(null===d)return s[ni];{const{componentOffset:g}=d;if(g>-1){const{encapsulation:b}=t.data[d.directiveStart+g];if(b===Mo.None||b===Mo.Emulated)return null}return ts(d,s)}}(t,i.parent,s)}function uu(t,i,s,d,g){t.insertBefore(i,s,d,g)}function cf(t,i,s){t.appendChild(i,s)}function Jd(t,i,s,d,g){null!==d?uu(t,i,s,d,g):cf(t,i,s)}function df(t,i){return t.parentNode(i)}function ed(t,i,s){return td(t,i,s)}let hf,gf,td=function Vp(t,i,s){return 40&t.type?ts(t,s):null};function Xd(t,i,s,d){const g=jp(t,d,i),b=i[Ui],A=ed(d.parent||i[Do],d,i);if(null!=g)if(Array.isArray(s))for(let k=0;k<s.length;k++)Jd(b,g,s[k],A,!1);else Jd(b,g,s,A,!1);void 0!==hf&&hf(b,d,i,s,g)}function nd(t,i){if(null!==i){const s=i.type;if(3&s)return ts(i,t);if(4&s)return ff(-1,t[i.index]);if(8&s){const d=i.child;if(null!==d)return nd(t,d);{const g=t[i.index];return fo(g)?ff(-1,g):Fr(g)}}if(32&s)return Np(i,t)()||Fr(t[i.index]);{const d=$p(t,i);return null!==d?Array.isArray(d)?d[0]:nd(ul(t[kr]),d):nd(t,i.next)}}return null}function $p(t,i){return null!==i?t[kr][Do].projection[i.projection]:null}function ff(t,i){const s=oo+t+1;if(s<i.length){const d=i[s],g=d[Ln].firstChild;if(null!==g)return nd(d,g)}return i[Cs]}function Gp(t,i,s,d,g,b,T){for(;null!=s;){const A=d[s.index],k=s.type;if(T&&0===i&&(A&&ls(Fr(A),d),s.flags|=2),32!=(32&s.flags))if(8&k)Gp(t,i,s.child,d,g,b,!1),Oc(i,t,g,A,b);else if(32&k){const q=Np(s,d);let ge;for(;ge=q();)Oc(i,t,g,ge,b);Oc(i,t,g,A,b)}else 16&k?eh(t,i,d,s,g,b):Oc(i,t,g,A,b);s=T?s.projectionNext:s.next}}function pf(t,i,s,d,g,b){Gp(s,d,t.firstChild,i,g,b,!1)}function eh(t,i,s,d,g,b){const T=s[kr],k=T[Do].projection[d.projection];if(Array.isArray(k))for(let q=0;q<k.length;q++)Oc(i,t,g,k[q],b);else{let q=k;const ge=T[zr];Gd(d)&&(q.flags|=128),Gp(t,i,q,ge,g,b,!0)}}function du(t,i,s){""===s?t.removeAttribute(i,"class"):t.setAttribute(i,"class",s)}function id(t,i,s){const{mergedAttrs:d,classes:g,styles:b}=s;null!==d&&zs(t,i,d),null!==g&&du(t,i,g),null!==b&&function th(t,i,s){t.setAttribute(i,"style",s)}(t,i,b)}function Wp(t){return function od(){if(void 0===gf&&(gf=null,St.trustedTypes))try{gf=St.trustedTypes.createPolicy("angular#unsafe-bypass",{createHTML:t=>t,createScript:t=>t,createScriptURL:t=>t})}catch{}return gf}()?.createScriptURL(t)||t}class qp{constructor(i){this.changingThisBreaksApplicationSecurity=i}toString(){return`SafeValue must use [property]=binding: ${this.changingThisBreaksApplicationSecurity} (see ${hn})`}}function uc(t){return t instanceof qp?t.changingThisBreaksApplicationSecurity:t}function ih(t,i){const s=function cs(t){return t instanceof qp&&t.getTypeName()||null}(t);if(null!=s&&s!==i){if("ResourceURL"===s&&"URL"===i)return!0;throw new Error(`Required a safe ${i}, got a ${s} (see ${hn})`)}return s===i}const Vg=/^(?!javascript:)(?:[a-z0-9+.-]+:|[^&:\/?#]*(?:[\/?#]|$))/i;var ad=function(t){return t[t.NONE=0]="NONE",t[t.HTML=1]="HTML",t[t.STYLE=2]="STYLE",t[t.SCRIPT=3]="SCRIPT",t[t.URL=4]="URL",t[t.RESOURCE_URL=5]="RESOURCE_URL",t}(ad||{});function vf(t){const i=hu();return i?i.sanitize(ad.URL,t)||"":ih(t,"URL")?uc(t):function _f(t){return(t=String(t)).match(Vg)?t:"unsafe:"+t}(dt(t))}function xf(t){const i=hu();if(i)return Wp(i.sanitize(ad.RESOURCE_URL,t)||"");if(ih(t,"ResourceURL"))return Wp(uc(t));throw new Yt(904,!1)}function nm(t,i,s){return function La(t,i){return"src"===i&&("embed"===t||"frame"===t||"iframe"===t||"media"===t||"script"===t)||"href"===i&&("base"===t||"link"===t)?xf:vf}(i,s)(t)}function hu(){const t=Sn();return t&&t[Ro].sanitizer}class ch{}let ud=()=>null;function ka(t,i,s=!1){return ud(t,i,s)}class av{}class Jg{}class lv{resolveComponentFactory(i){throw function pd(t){const i=Error(`No component factory found for ${Ei(t)}.`);return i.ngComponent=t,i}(i)}}let fh=(()=>{class t{static#e=this.NULL=new lv}return t})();function cv(){return kc(Nr(),Sn())}function kc(t,i){return new ph(ts(t,i))}let ph=(()=>{class t{constructor(s){this.nativeElement=s}static#e=this.__NG_ELEMENT_ID__=cv}return t})();function mh(t){return t instanceof ph?t.nativeElement:t}class hc{}let Xg=(()=>{class t{constructor(){this.destroyNode=null}static#e=this.__NG_ELEMENT_ID__=()=>function Qg(){const t=Sn(),s=Lo(Nr().index,t);return(Io(s)?s:t)[Ui]}()}return t})(),Pf=(()=>{class t{static#e=this.\u0275prov=qi({token:t,providedIn:"root",factory:()=>null})}return t})();const gh={};function Fc(t){const i=Y(null);try{return t()}finally{Y(i)}}function Nc(t){return!!mu(t)&&(Array.isArray(t)||!(t instanceof Map)&&Symbol.iterator in t)}function mu(t){return null!==t&&("function"==typeof t||"object"==typeof t)}class vh{constructor(){}supports(i){return Nc(i)}create(i){return new pv(i)}}const fv=(t,i)=>i;class pv{constructor(i){this.length=0,this._linkedRecords=null,this._unlinkedRecords=null,this._previousItHead=null,this._itHead=null,this._itTail=null,this._additionsHead=null,this._additionsTail=null,this._movesHead=null,this._movesTail=null,this._removalsHead=null,this._removalsTail=null,this._identityChangesHead=null,this._identityChangesTail=null,this._trackByFn=i||fv}forEachItem(i){let s;for(s=this._itHead;null!==s;s=s._next)i(s)}forEachOperation(i){let s=this._itHead,d=this._removalsHead,g=0,b=null;for(;s||d;){const T=!d||s&&s.currentIndex<sm(d,g,b)?s:d,A=sm(T,g,b),k=T.currentIndex;if(T===d)g--,d=d._nextRemoved;else if(s=s._next,null==T.previousIndex)g++;else{b||(b=[]);const q=A-g,ge=k-g;if(q!=ge){for(let Rt=0;Rt<q;Rt++){const Gt=Rt<b.length?b[Rt]:b[Rt]=0,Tn=Gt+Rt;ge<=Tn&&Tn<q&&(b[Rt]=Gt+1)}b[T.previousIndex]=ge-q}}A!==k&&i(T,A,k)}}forEachPreviousItem(i){let s;for(s=this._previousItHead;null!==s;s=s._nextPrevious)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachMovedItem(i){let s;for(s=this._movesHead;null!==s;s=s._nextMoved)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}forEachIdentityChange(i){let s;for(s=this._identityChangesHead;null!==s;s=s._nextIdentityChange)i(s)}diff(i){if(null==i&&(i=[]),!Nc(i))throw new Yt(900,!1);return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let g,b,T,s=this._itHead,d=!1;if(Array.isArray(i)){this.length=i.length;for(let A=0;A<this.length;A++)b=i[A],T=this._trackByFn(A,b),null!==s&&Object.is(s.trackById,T)?(d&&(s=this._verifyReinsertion(s,b,T,A)),Object.is(s.item,b)||this._addIdentityChange(s,b)):(s=this._mismatch(s,b,T,A),d=!0),s=s._next}else g=0,function yh(t,i){if(Array.isArray(t))for(let s=0;s<t.length;s++)i(t[s]);else{const s=t[Symbol.iterator]();let d;for(;!(d=s.next()).done;)i(d.value)}}(i,A=>{T=this._trackByFn(g,A),null!==s&&Object.is(s.trackById,T)?(d&&(s=this._verifyReinsertion(s,A,T,g)),Object.is(s.item,A)||this._addIdentityChange(s,A)):(s=this._mismatch(s,A,T,g),d=!0),s=s._next,g++}),this.length=g;return this._truncate(s),this.collection=i,this.isDirty}get isDirty(){return null!==this._additionsHead||null!==this._movesHead||null!==this._removalsHead||null!==this._identityChangesHead}_reset(){if(this.isDirty){let i;for(i=this._previousItHead=this._itHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._additionsHead;null!==i;i=i._nextAdded)i.previousIndex=i.currentIndex;for(this._additionsHead=this._additionsTail=null,i=this._movesHead;null!==i;i=i._nextMoved)i.previousIndex=i.currentIndex;this._movesHead=this._movesTail=null,this._removalsHead=this._removalsTail=null,this._identityChangesHead=this._identityChangesTail=null}}_mismatch(i,s,d,g){let b;return null===i?b=this._itTail:(b=i._prev,this._remove(i)),null!==(i=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._reinsertAfter(i,b,g)):null!==(i=null===this._linkedRecords?null:this._linkedRecords.get(d,g))?(Object.is(i.item,s)||this._addIdentityChange(i,s),this._moveAfter(i,b,g)):i=this._addAfter(new gd(s,d),b,g),i}_verifyReinsertion(i,s,d,g){let b=null===this._unlinkedRecords?null:this._unlinkedRecords.get(d,null);return null!==b?i=this._reinsertAfter(b,i._prev,g):i.currentIndex!=g&&(i.currentIndex=g,this._addToMoves(i,g)),i}_truncate(i){for(;null!==i;){const s=i._next;this._addToRemovals(this._unlink(i)),i=s}null!==this._unlinkedRecords&&this._unlinkedRecords.clear(),null!==this._additionsTail&&(this._additionsTail._nextAdded=null),null!==this._movesTail&&(this._movesTail._nextMoved=null),null!==this._itTail&&(this._itTail._next=null),null!==this._removalsTail&&(this._removalsTail._nextRemoved=null),null!==this._identityChangesTail&&(this._identityChangesTail._nextIdentityChange=null)}_reinsertAfter(i,s,d){null!==this._unlinkedRecords&&this._unlinkedRecords.remove(i);const g=i._prevRemoved,b=i._nextRemoved;return null===g?this._removalsHead=b:g._nextRemoved=b,null===b?this._removalsTail=g:b._prevRemoved=g,this._insertAfter(i,s,d),this._addToMoves(i,d),i}_moveAfter(i,s,d){return this._unlink(i),this._insertAfter(i,s,d),this._addToMoves(i,d),i}_addAfter(i,s,d){return this._insertAfter(i,s,d),this._additionsTail=null===this._additionsTail?this._additionsHead=i:this._additionsTail._nextAdded=i,i}_insertAfter(i,s,d){const g=null===s?this._itHead:s._next;return i._next=g,i._prev=s,null===g?this._itTail=i:g._prev=i,null===s?this._itHead=i:s._next=i,null===this._linkedRecords&&(this._linkedRecords=new e_),this._linkedRecords.put(i),i.currentIndex=d,i}_remove(i){return this._addToRemovals(this._unlink(i))}_unlink(i){null!==this._linkedRecords&&this._linkedRecords.remove(i);const s=i._prev,d=i._next;return null===s?this._itHead=d:s._next=d,null===d?this._itTail=s:d._prev=s,i}_addToMoves(i,s){return i.previousIndex===s||(this._movesTail=null===this._movesTail?this._movesHead=i:this._movesTail._nextMoved=i),i}_addToRemovals(i){return null===this._unlinkedRecords&&(this._unlinkedRecords=new e_),this._unlinkedRecords.put(i),i.currentIndex=null,i._nextRemoved=null,null===this._removalsTail?(this._removalsTail=this._removalsHead=i,i._prevRemoved=null):(i._prevRemoved=this._removalsTail,this._removalsTail=this._removalsTail._nextRemoved=i),i}_addIdentityChange(i,s){return i.item=s,this._identityChangesTail=null===this._identityChangesTail?this._identityChangesHead=i:this._identityChangesTail._nextIdentityChange=i,i}}class gd{constructor(i,s){this.item=i,this.trackById=s,this.currentIndex=null,this.previousIndex=null,this._nextPrevious=null,this._prev=null,this._next=null,this._prevDup=null,this._nextDup=null,this._prevRemoved=null,this._nextRemoved=null,this._nextAdded=null,this._nextMoved=null,this._nextIdentityChange=null}}class Of{constructor(){this._head=null,this._tail=null}add(i){null===this._head?(this._head=this._tail=i,i._nextDup=null,i._prevDup=null):(this._tail._nextDup=i,i._prevDup=this._tail,i._nextDup=null,this._tail=i)}get(i,s){let d;for(d=this._head;null!==d;d=d._nextDup)if((null===s||s<=d.currentIndex)&&Object.is(d.trackById,i))return d;return null}remove(i){const s=i._prevDup,d=i._nextDup;return null===s?this._head=d:s._nextDup=d,null===d?this._tail=s:d._prevDup=s,null===this._head}}class e_{constructor(){this.map=new Map}put(i){const s=i.trackById;let d=this.map.get(s);d||(d=new Of,this.map.set(s,d)),d.add(i)}get(i,s){const g=this.map.get(i);return g?g.get(i,s):null}remove(i){const s=i.trackById;return this.map.get(s).remove(i)&&this.map.delete(s),i}get isEmpty(){return 0===this.map.size}clear(){this.map.clear()}}function sm(t,i,s){const d=t.previousIndex;if(null===d)return d;let g=0;return s&&d<s.length&&(g=s[d]),d+i+g}class am{constructor(){}supports(i){return i instanceof Map||mu(i)}create(){return new mv}}class mv{constructor(){this._records=new Map,this._mapHead=null,this._appendAfter=null,this._previousMapHead=null,this._changesHead=null,this._changesTail=null,this._additionsHead=null,this._additionsTail=null,this._removalsHead=null,this._removalsTail=null}get isDirty(){return null!==this._additionsHead||null!==this._changesHead||null!==this._removalsHead}forEachItem(i){let s;for(s=this._mapHead;null!==s;s=s._next)i(s)}forEachPreviousItem(i){let s;for(s=this._previousMapHead;null!==s;s=s._nextPrevious)i(s)}forEachChangedItem(i){let s;for(s=this._changesHead;null!==s;s=s._nextChanged)i(s)}forEachAddedItem(i){let s;for(s=this._additionsHead;null!==s;s=s._nextAdded)i(s)}forEachRemovedItem(i){let s;for(s=this._removalsHead;null!==s;s=s._nextRemoved)i(s)}diff(i){if(i){if(!(i instanceof Map||mu(i)))throw new Yt(900,!1)}else i=new Map;return this.check(i)?this:null}onDestroy(){}check(i){this._reset();let s=this._mapHead;if(this._appendAfter=null,this._forEach(i,(d,g)=>{if(s&&s.key===g)this._maybeAddToChanges(s,d),this._appendAfter=s,s=s._next;else{const b=this._getOrCreateRecordForKey(g,d);s=this._insertBeforeOrAppend(s,b)}}),s){s._prev&&(s._prev._next=null),this._removalsHead=s;for(let d=s;null!==d;d=d._nextRemoved)d===this._mapHead&&(this._mapHead=null),this._records.delete(d.key),d._nextRemoved=d._next,d.previousValue=d.currentValue,d.currentValue=null,d._prev=null,d._next=null}return this._changesTail&&(this._changesTail._nextChanged=null),this._additionsTail&&(this._additionsTail._nextAdded=null),this.isDirty}_insertBeforeOrAppend(i,s){if(i){const d=i._prev;return s._next=i,s._prev=d,i._prev=s,d&&(d._next=s),i===this._mapHead&&(this._mapHead=s),this._appendAfter=i,i}return this._appendAfter?(this._appendAfter._next=s,s._prev=this._appendAfter):this._mapHead=s,this._appendAfter=s,null}_getOrCreateRecordForKey(i,s){if(this._records.has(i)){const g=this._records.get(i);this._maybeAddToChanges(g,s);const b=g._prev,T=g._next;return b&&(b._next=T),T&&(T._prev=b),g._next=null,g._prev=null,g}const d=new t_(i);return this._records.set(i,d),d.currentValue=s,this._addToAdditions(d),d}_reset(){if(this.isDirty){let i;for(this._previousMapHead=this._mapHead,i=this._previousMapHead;null!==i;i=i._next)i._nextPrevious=i._next;for(i=this._changesHead;null!==i;i=i._nextChanged)i.previousValue=i.currentValue;for(i=this._additionsHead;null!=i;i=i._nextAdded)i.previousValue=i.currentValue;this._changesHead=this._changesTail=null,this._additionsHead=this._additionsTail=null,this._removalsHead=null}}_maybeAddToChanges(i,s){Object.is(s,i.currentValue)||(i.previousValue=i.currentValue,i.currentValue=s,this._addToChanges(i))}_addToAdditions(i){null===this._additionsHead?this._additionsHead=this._additionsTail=i:(this._additionsTail._nextAdded=i,this._additionsTail=i)}_addToChanges(i){null===this._changesHead?this._changesHead=this._changesTail=i:(this._changesTail._nextChanged=i,this._changesTail=i)}_forEach(i,s){i instanceof Map?i.forEach(s):Object.keys(i).forEach(d=>s(i[d],d))}}class t_{constructor(i){this.key=i,this.previousValue=null,this.currentValue=null,this._nextPrevious=null,this._next=null,this._prev=null,this._nextAdded=null,this._nextRemoved=null,this._nextChanged=null}}function n_(){return new Rf([new vh])}let Rf=(()=>{class t{static#e=this.\u0275prov=qi({token:t,providedIn:"root",factory:n_});constructor(s){this.factories=s}static create(s,d){if(null!=d){const g=d.factories.slice();s=s.concat(g)}return new t(s)}static extend(s){return{provide:t,useFactory:d=>t.create(s,d||n_()),deps:[[t,new qs,new Tc]]}}find(s){const d=this.factories.find(g=>g.supports(s));if(null!=d)return d;throw new Yt(901,!1)}}return t})();function lm(){return new cm([new am])}let cm=(()=>{class t{static#e=this.\u0275prov=qi({token:t,providedIn:"root",factory:lm});constructor(s){this.factories=s}static create(s,d){if(d){const g=d.factories.slice();s=s.concat(g)}return new t(s)}static extend(s){return{provide:t,useFactory:d=>t.create(s,d||lm()),deps:[[t,new qs,new Tc]]}}find(s){const d=this.factories.find(g=>g.supports(s));if(d)return d;throw new Yt(901,!1)}}return t})();function Bc(t,i,s,d,g=!1){for(;null!==s;){const b=i[s.index];null!==b&&d.push(Fr(b)),fo(b)&&xh(b,d);const T=s.type;if(8&T)Bc(t,i,s.child,d);else if(32&T){const A=Np(s,i);let k;for(;k=A();)d.push(k)}else if(16&T){const A=$p(i,s);if(Array.isArray(A))d.push(...A);else{const k=ul(i[kr]);Bc(k[Ln],k,A,d,!0)}}s=g?s.projectionNext:s.next}return d}function xh(t,i){for(let s=oo;s<t.length;s++){const d=t[s],g=d[Ln].firstChild;null!==g&&Bc(d[Ln],d,g,i)}t[Cs]!==t[ni]&&i.push(t[Cs])}let bh=[];const zc={version:0,lastCleanEpoch:0,dirty:!1,producerNode:void 0,producerLastReadVersion:void 0,producerIndexOfThis:void 0,nextProducerIndex:0,liveConsumerNode:void 0,liveConsumerIndexOfThis:void 0,consumerAllowSignalWrites:!1,consumerIsAlwaysLive:!1,producerMustRecompute:()=>!1,producerRecomputeValue:()=>{},consumerMarkedDirty:()=>{},consumerOnSignalRead:()=>{},consumerIsAlwaysLive:!0,consumerMarkedDirty:t=>{cl(t.lView)},consumerOnSignalRead(){this.lView[es]=this}};function fm(t){return i_(t[js])}function wh(t){return i_(t[Oo])}function i_(t){for(;null!==t&&!fo(t);)t=t[Oo];return t}function pm(t){return t.ngOriginalError}class Nl{constructor(){this._console=console}handleError(i){const s=this._findOriginalError(i);this._console.error("ERROR",i),s&&this._console.error("ORIGINAL ERROR",s)}_findOriginalError(i){let s=i&&pm(i);for(;s&&pm(s);)s=pm(s);return s||null}}const o_=new V("",{providedIn:"root",factory:()=>ji(Nl).handleError.bind(void 0)}),a_=new V("",{providedIn:"root",factory:()=>!1}),sr={};function u_(t=1){ym(gr(),Sn(),$e()+t,!1)}function ym(t,i,s,d){if(!d)if(3==(3&i[Di])){const b=t.preOrderCheckHooks;null!==b&&nn(i,b,s)}else{const b=t.preOrderHooks;null!==b&&Mn(i,b,0,s)}et(s)}function yu(t,i=_i.Default){const s=Sn();return null===s?Dr(t,i):hl(Nr(),s,Jt(t),i)}function vm(){throw new Error("invalid")}function xm(t,i,s,d,g,b){const T=Y(null);try{let A=null;g&vo.SignalBased&&(A=i[d][B]),null!==A&&void 0!==A.transformFn&&(b=A.transformFn(b)),g&vo.HasDecoratorInputTransform&&(b=t.inputTransforms[d].call(i,b)),null!==t.setInput?t.setInput(i,A,b,s,d):Ts(i,A,d,b)}finally{Y(T)}}function Ch(t,i,s,d,g,b,T,A,k,q,ge){const Je=i.blueprint.slice();return Je[ni]=g,Je[Di]=204|d,(null!==q||t&&2048&t[Di])&&(Je[Di]|=2048),Hc(Je),Je[zr]=Je[No]=t,Je[$r]=s,Je[Ro]=T||t&&t[Ro],Je[Ui]=A||t&&t[Ui],Je[xo]=k||t&&t[xo]||null,Je[Do]=b,Je[ma]=function Ly(){return Ry++}(),Je[bs]=ge,Je[Hl]=q,Je[kr]=2==i.type?t[kr]:Je,Je}function vu(t,i,s,d,g){let b=t.data[i];if(null===b)b=function zl(t,i,s,d,g){const b=dl(),T=nc(),k=t.data[i]=function p_(t,i,s,d,g,b){let T=i?i.injectorIndex:-1,A=0;return ec()&&(A|=128),{type:s,index:d,insertBeforeIndex:null,injectorIndex:T,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,componentOffset:-1,propertyBindings:null,flags:A,providerIndexes:0,value:g,attrs:b,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tView:null,next:null,prev:null,projectionNext:null,child:null,parent:i,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,T?b:b&&b.parent,s,i,d,g);return null===t.firstChild&&(t.firstChild=k),null!==b&&(T?null==b.child&&null!==k.parent&&(b.child=k):null===b.next&&(b.next=k,k.prev=b)),k}(t,i,s,d,g),function Lu(){return Hi.lFrame.inI18n}()&&(b.flags|=32);else if(64&b.type){b.type=s,b.value=d,b.attrs=g;const T=function ra(){const t=Hi.lFrame,i=t.currentTNode;return t.isParent?i:i.parent}();b.injectorIndex=null===T?-1:T.injectorIndex}return oi(b,!0),b}function _d(t,i,s,d){if(0===s)return-1;const g=i.length;for(let b=0;b<s;b++)i.push(d),t.blueprint.push(d),t.data.push(null);return g}function h_(t,i,s,d,g){const b=$e(),T=2&d;try{et(-1),T&&i.length>Gi&&ym(t,i,Gi,!1),Zr(T?2:0,g),s(d,g)}finally{et(b),Zr(T?3:1,g)}}function bm(t,i,s){if(El(i)){const d=Y(null);try{const b=i.directiveEnd;for(let T=i.directiveStart;T<b;T++){const A=t.data[T];A.contentQueries&&A.contentQueries(1,s[T],T)}}finally{Y(d)}}}function yd(t,i,s){Pu()&&(function b_(t,i,s,d){const g=s.directiveStart,b=s.directiveEnd;Za(s)&&function o(t,i,s){const d=ts(i,t),g=xu(s);let T=16;s.signals?T=4096:s.onPush&&(T=64);const A=M(t,Ch(t,g,null,T,d,i,null,t[Ro].rendererFactory.createRenderer(d,s),null,null,null));t[i.index]=A}(i,s,t.data[g+s.componentOffset]),t.firstCreatePass||go(s,i),ls(d,i);const T=s.initialInputs;for(let A=g;A<b;A++){const k=t.data[A],q=fl(i,t,A,s);ls(q,i),null!==T&&_(0,A-g,q,k,0,T),Zs(k)&&(Lo(s.index,i)[$r]=fl(i,t,A,s))}}(t,i,s,ts(s,i)),64==(64&s.flags)&&Ff(t,i,s))}function wm(t,i,s=ts){const d=i.localNames;if(null!==d){let g=i.index+1;for(let b=0;b<d.length;b+=2){const T=d[b+1],A=-1===T?s(i,t):t[T];t[g++]=A}}}function xu(t){const i=t.tView;return null===i||i.incompleteFirstPass?t.tView=Eh(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts,t.id):i}function Eh(t,i,s,d,g,b,T,A,k,q,ge){const Je=Gi+d,Rt=Je+g,Gt=function Cm(t,i){const s=[];for(let d=0;d<i;d++)s.push(d<t?null:sr);return s}(Je,Rt),Tn="function"==typeof q?q():q;return Gt[Ln]={type:t,blueprint:Gt,template:s,queries:null,viewQuery:A,declTNode:i,data:Gt.slice().fill(null,Je),bindingStartIndex:Je,expandoStartIndex:Rt,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof b?b():b,pipeRegistry:"function"==typeof T?T():T,firstChild:null,schemas:k,consts:Tn,incompleteFirstPass:!1,ssrId:ge}}let Lf=()=>null;function vd(t,i,s,d,g){for(let b in i){if(!i.hasOwnProperty(b))continue;const T=i[b];if(void 0===T)continue;d??={};let A,k=vo.None;Array.isArray(T)?(A=T[0],k=T[1]):A=T;let q=b;if(null!==g){if(!g.hasOwnProperty(b))continue;q=g[b]}0===t?Th(d,s,q,A,k):Th(d,s,q,A)}return d}function Th(t,i,s,d,g){let b;t.hasOwnProperty(s)?(b=t[s]).push(i,d):b=t[s]=[i,d],void 0!==g&&b.push(g)}function Fa(t,i,s,d,g,b,T,A){const k=ts(i,s);let ge,q=i.inputs;!A&&null!=q&&(ge=q[d])?(Le(t,s,ge,d,g),Za(i)&&function __(t,i){const s=Lo(i,t);16&s[Di]||(s[Di]|=64)}(s,i.index)):3&i.type&&(d=function g_(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(d),g=null!=T?T(g,i.value||"",d):g,b.setProperty(k,d,g))}function Tm(t,i,s,d){if(Pu()){const g=null===d?null:{"":-1},b=function w_(t,i){const s=t.directiveRegistry;let d=null,g=null;if(s)for(let b=0;b<s.length;b++){const T=s[b];if(Ca(i,T.selectors,!1))if(d||(d=[]),Zs(T))if(null!==T.findHostDirectiveDefs){const A=[];g=g||new Map,T.findHostDirectiveDefs(T,A,g),d.unshift(...A,T),wu(t,i,A.length)}else d.unshift(T),wu(t,i,0);else g=g||new Map,T.findHostDirectiveDefs?.(T,d,g),d.push(T)}return null===d?null:[d,g]}(t,s);let T,A;null===b?T=A=null:[T,A]=b,null!==T&&kf(t,i,s,T,g,A),g&&function Im(t,i,s){if(i){const d=t.localNames=[];for(let g=0;g<i.length;g+=2){const b=s[i[g+1]];if(null==b)throw new Yt(-301,!1);d.push(i[g],b)}}}(s,d,g)}s.mergedAttrs=vs(s.mergedAttrs,s.attrs)}function kf(t,i,s,d,g,b){for(let q=0;q<d.length;q++)xc(go(s,i),t,d[q].type);!function r(t,i,s){t.flags|=1,t.directiveStart=i,t.directiveEnd=i+s,t.providerIndexes=i}(s,t.data.length,d.length);for(let q=0;q<d.length;q++){const ge=d[q];ge.providersResolver&&ge.providersResolver(ge)}let T=!1,A=!1,k=_d(t,i,d.length,null);for(let q=0;q<d.length;q++){const ge=d[q];s.mergedAttrs=vs(s.mergedAttrs,ge.hostAttrs),e(t,s,i,k,ge),C_(k,ge,g),null!==ge.contentQueries&&(s.flags|=4),(null!==ge.hostBindings||null!==ge.hostAttrs||0!==ge.hostVars)&&(s.flags|=64);const Je=ge.type.prototype;!T&&(Je.ngOnChanges||Je.ngOnInit||Je.ngDoCheck)&&((t.preOrderHooks??=[]).push(s.index),T=!0),!A&&(Je.ngOnChanges||Je.ngDoCheck)&&((t.preOrderCheckHooks??=[]).push(s.index),A=!0),k++}!function m_(t,i,s){const g=i.directiveEnd,b=t.data,T=i.attrs,A=[];let k=null,q=null;for(let ge=i.directiveStart;ge<g;ge++){const Je=b[ge],Rt=s?s.get(Je):null,Tn=Rt?Rt.outputs:null;k=vd(0,Je.inputs,ge,k,Rt?Rt.inputs:null),q=vd(1,Je.outputs,ge,q,Tn);const ii=null===k||null===T||ca(i)?null:v(k,ge,T);A.push(ii)}null!==k&&(k.hasOwnProperty("class")&&(i.flags|=8),k.hasOwnProperty("style")&&(i.flags|=16)),i.initialInputs=A,i.inputs=k,i.outputs=q}(t,s,b)}function Ff(t,i,s){const d=s.directiveStart,g=s.directiveEnd,b=s.index,T=function n(){return Hi.lFrame.currentDirectiveIndex}();try{et(b);for(let A=d;A<g;A++){const k=t.data[A],q=i[A];a(A),(null!==k.hostBindings||0!==k.hostVars||null!==k.hostAttrs)&&Dm(k,q)}}finally{et(-1),a(T)}}function Dm(t,i){null!==t.hostBindings&&t.hostBindings(1,i)}function wu(t,i,s){i.componentOffset=s,(t.components??=[]).push(i.index)}function C_(t,i,s){if(s){if(i.exportAs)for(let d=0;d<i.exportAs.length;d++)s[i.exportAs[d]]=t;Zs(i)&&(s[""]=t)}}function e(t,i,s,d,g){t.data[d]=g;const b=g.factory||(g.factory=ao(g.type)),T=new kn(b,Zs(g),yu);t.blueprint[d]=T,s[d]=T,function v_(t,i,s,d,g){const b=g.hostBindings;if(b){let T=t.hostBindingOpCodes;null===T&&(T=t.hostBindingOpCodes=[]);const A=~i.index;(function x_(t){let i=t.length;for(;i>0;){const s=t[--i];if("number"==typeof s&&s<0)return s}return 0})(T)!=A&&T.push(A),T.push(s,d,b)}}(t,i,d,_d(t,s,g.hostVars,sr),g)}function c(t,i,s,d,g,b){const T=ts(t,i);!function f(t,i,s,d,g,b,T){if(null==b)t.removeAttribute(i,g,s);else{const A=null==T?dt(b):T(b,d||"",g);t.setAttribute(i,g,A,s)}}(i[Ui],T,b,t.value,s,d,g)}function _(t,i,s,d,g,b){const T=b[i];if(null!==T)for(let A=0;A<T.length;)xm(d,s,T[A++],T[A++],T[A++],T[A++])}function v(t,i,s){let d=null,g=0;for(;g<s.length;){const b=s[g];if(0!==b)if(5!==b){if("number"==typeof b)break;if(t.hasOwnProperty(b)){null===d&&(d=[]);const T=t[b];for(let A=0;A<T.length;A+=3)if(T[A]===i){d.push(b,T[A+1],T[A+2],s[g+1]);break}}g+=2}else g+=2;else g+=4}return d}function w(t,i,s,d){return[t,!0,0,i,null,d,null,s,null,null]}function E(t,i){const s=t.contentQueries;if(null!==s){const d=Y(null);try{for(let g=0;g<s.length;g+=2){const T=s[g+1];if(-1!==T){const A=t.data[T];x(s[g]),A.contentQueries(2,i[T],T)}}}finally{Y(d)}}}function M(t,i){return t[js]?t[wl][Oo]=i:t[js]=i,t[wl]=i,i}function L(t,i,s){x(0);const d=Y(null);try{i(t,s)}finally{Y(d)}}function j(t){return t[al]||(t[al]=[])}function W(t){return t.cleanup||(t.cleanup=[])}function se(t,i){const s=t[xo],d=s?s.get(Nl,null):null;d&&d.handleError(i)}function Le(t,i,s,d,g){for(let b=0;b<s.length;){const T=s[b++],A=s[b++],k=s[b++];xm(t.data[T],i[T],d,A,k,g)}}function rt(t,i,s){const d=ll(i,t);!function Sg(t,i,s){t.setValue(i,s)}(t[Ui],d,s)}function Mt(t,i,s,d){const g=i[Di];if(256==(256&g))return;i[Ro].inlineEffectRunner?.flush(),R(i);let T=null,A=null;(function un(t){return 2!==t.type})(t)&&(A=function _v(t){return t[es]??function um(t){const i=bh.pop()??Object.create(zc);return i.lView=t,i}(t)}(i),T=function Ce(t){return t&&(t.nextProducerIndex=0),Y(t)}(A));try{Hc(i),function Dd(t){return Hi.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==s&&h_(t,i,s,2,d);const k=3==(3&g);if(k){const Je=t.preOrderCheckHooks;null!==Je&&nn(i,Je,null)}else{const Je=t.preOrderHooks;null!==Je&&Mn(i,Je,0,null),pn(i,0)}if(function Dn(t){for(let i=fm(t);null!==i;i=wh(i)){if(!(i[Di]&$a.HasTransplantedViews))continue;const s=i[na];for(let d=0;d<s.length;d++){Iu(s[d])}}}(i),rn(i,0),null!==t.contentQueries&&E(t,i),k){const Je=t.contentCheckHooks;null!==Je&&nn(i,Je)}else{const Je=t.contentHooks;null!==Je&&Mn(i,Je,1),pn(i,1)}!function d_(t,i){const s=t.hostBindingOpCodes;if(null!==s)try{for(let d=0;d<s.length;d++){const g=s[d];if(g<0)et(~g);else{const b=g,T=s[++d],A=s[++d];u(T,b),A(2,i[b])}}}finally{et(-1)}}(t,i);const q=t.components;null!==q&&Rn(i,q,0);const ge=t.viewQuery;if(null!==ge&&L(2,ge,d),k){const Je=t.viewCheckHooks;null!==Je&&nn(i,Je)}else{const Je=t.viewHooks;null!==Je&&Mn(i,Je,2),pn(i,2)}if(!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),i[Va]){for(const Je of i[Va])Je();i[Va]=null}i[Di]&=-73}catch(k){throw cl(i),k}finally{null!==A&&(function oe(t,i){if(Y(i),t&&void 0!==t.producerNode&&void 0!==t.producerIndexOfThis&&void 0!==t.producerLastReadVersion){if(Ue(t))for(let s=t.nextProducerIndex;s<t.producerNode.length;s++)ye(t.producerNode[s],t.producerIndexOfThis[s]);for(;t.producerNode.length>t.nextProducerIndex;)t.producerNode.pop(),t.producerLastReadVersion.pop(),t.producerIndexOfThis.pop()}}(A,T),function dm(t){t.lView[es]!==t&&(t.lView=null,bh.push(t))}(A)),je()}}function rn(t,i){for(let s=fm(t);null!==s;s=wh(s))for(let d=oo;d<s.length;d++)mn(s[d],i)}function Yn(t,i,s){mn(Lo(i,t),s)}function mn(t,i){Il(t)&&Pn(t,i)}function Pn(t,i){const d=t[Ln],g=t[Di],b=t[es];let T=!!(0===i&&16&g);if(T||=!!(64&g&&0===i),T||=!!(1024&g),T||=!(!b?.dirty||!xe(b)),b&&(b.dirty=!1),t[Di]&=-9217,T)Mt(d,t,d.template,t[$r]);else if(8192&g){rn(t,1);const A=d.components;null!==A&&Rn(t,A,1)}}function Rn(t,i,s){for(let d=0;d<i.length;d++)Yn(t,i[d],s)}function zn(t){for(t[Ro].changeDetectionScheduler?.notify();t;){t[Di]|=64;const i=ul(t);if(gc(t)&&!i)return t;t=i}return null}class Qn{get rootNodes(){const i=this._lView,s=i[Ln];return Bc(s,i,s.firstChild,[])}constructor(i,s,d=!0){this._lView=i,this._cdRefInjectingView=s,this.notifyErrorHandler=d,this._appRef=null,this._attachedToViewContainer=!1}get context(){return this._lView[$r]}set context(i){this._lView[$r]=i}get destroyed(){return 256==(256&this._lView[Di])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const i=this._lView[zr];if(fo(i)){const s=i[8],d=s?s.indexOf(this):-1;d>-1&&(Yd(i,d),As(s,d))}this._attachedToViewContainer=!1}lf(this._lView[Ln],this._lView)}onDestroy(i){hs(this._lView,i)}markForCheck(){zn(this._cdRefInjectingView||this._lView)}detach(){this._lView[Di]&=-129}reattach(){Ia(this._lView),this._lView[Di]|=128}detectChanges(){this._lView[Di]|=1024,function at(t,i=!0){const s=t[Ro],d=s.rendererFactory;d.begin?.();try{!function xt(t){Pn(t,0);let i=0;for(;vc(t);){if(100===i)throw new Yt(103,!1);i++,Pn(t,1)}}(t)}catch(b){throw i&&se(t,b),b}finally{d.end?.(),s.inlineEffectRunner?.flush()}}(this._lView,this.notifyErrorHandler)}checkNoChanges(){}attachToViewContainerRef(){if(this._appRef)throw new Yt(902,!1);this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,Pg(this._lView[Ln],this._lView)}attachToAppRef(i){if(this._attachedToViewContainer)throw new Yt(902,!1);this._appRef=i,Ia(this._lView)}}let En=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=ai}return t})();function ai(t){return function gi(t,i,s){if(Za(t)&&!s){const d=Lo(t.index,i);return new Qn(d,d)}return 47&t.type?new Qn(i[kr],i):null}(Nr(),Sn(),16==(16&t))}let Zi=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=Ki;static#t=this.__NG_ENV_ID__=s=>s}return t})();class wr extends Zi{constructor(i){super(),this._lView=i}onDestroy(i){return hs(this._lView,i),()=>function Wc(t,i){if(null===t[$s])return;const s=t[$s].indexOf(i);-1!==s&&t[$s].splice(s,1)}(this._lView,i)}}function Ki(){return new wr(Sn())}const Wr=new Set;function Cr(t){Wr.has(t)||(Wr.add(t),performance?.mark?.("mark_feature_usage",{detail:{feature:t}}))}function mo(t){return i=>{setTimeout(t,void 0,i)}}const qr=class po extends Cn.x{constructor(i=!1){super(),this.__isAsync=i}emit(i){super.next(i)}subscribe(i,s,d){let g=i,b=s||(()=>null),T=d;if(i&&"object"==typeof i){const k=i;g=k.next?.bind(k),b=k.error?.bind(k),T=k.complete?.bind(k)}this.__isAsync&&(b=mo(b),g&&(g=mo(g)),T&&(T=mo(T)));const A=super.subscribe({next:g,error:b,complete:T});return i instanceof It.w0&&i.add(A),A}};function Ur(...t){}class ar{constructor({enableLongStackTrace:i=!1,shouldCoalesceEventChangeDetection:s=!1,shouldCoalesceRunChangeDetection:d=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new qr(!1),this.onMicrotaskEmpty=new qr(!1),this.onStable=new qr(!1),this.onError=new qr(!1),typeof Zone>"u")throw new Yt(908,!1);Zone.assertZonePatched();const g=this;g._nesting=0,g._outer=g._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(g._inner=g._inner.fork(new Zone.TaskTrackingZoneSpec)),i&&Zone.longStackTraceZoneSpec&&(g._inner=g._inner.fork(Zone.longStackTraceZoneSpec)),g.shouldCoalesceEventChangeDetection=!d&&s,g.shouldCoalesceRunChangeDetection=d,g.lastRequestAnimationFrameId=-1,g.nativeRequestAnimationFrame=function ko(){const t="function"==typeof St.requestAnimationFrame;let i=St[t?"requestAnimationFrame":"setTimeout"],s=St[t?"cancelAnimationFrame":"clearTimeout"];if(typeof Zone<"u"&&i&&s){const d=i[Zone.__symbol__("OriginalDelegate")];d&&(i=d);const g=s[Zone.__symbol__("OriginalDelegate")];g&&(s=g)}return{nativeRequestAnimationFrame:i,nativeCancelAnimationFrame:s}}().nativeRequestAnimationFrame,function Ks(t){const i=()=>{!function Qr(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(St,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,Co(t),t.isCheckStableRunning=!0,wo(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),Co(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(s,d,g,b,T,A)=>{if(function qo(t){return!(!Array.isArray(t)||1!==t.length)&&!0===t[0].data?.__ignore_ng_zone__}(A))return s.invokeTask(g,b,T,A);try{return Wo(t),s.invokeTask(g,b,T,A)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===b.type||t.shouldCoalesceRunChangeDetection)&&i(),Vo(t)}},onInvoke:(s,d,g,b,T,A,k)=>{try{return Wo(t),s.invoke(g,b,T,A,k)}finally{t.shouldCoalesceRunChangeDetection&&i(),Vo(t)}},onHasTask:(s,d,g,b)=>{s.hasTask(g,b),d===g&&("microTask"==b.change?(t._hasPendingMicrotasks=b.microTask,Co(t),wo(t)):"macroTask"==b.change&&(t.hasPendingMacrotasks=b.macroTask))},onHandleError:(s,d,g,b)=>(s.handleError(g,b),t.runOutsideAngular(()=>t.onError.emit(b)),!1)})}(g)}static isInAngularZone(){return typeof Zone<"u"&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!ar.isInAngularZone())throw new Yt(909,!1)}static assertNotInAngularZone(){if(ar.isInAngularZone())throw new Yt(909,!1)}run(i,s,d){return this._inner.run(i,s,d)}runTask(i,s,d,g){const b=this._inner,T=b.scheduleEventTask("NgZoneEvent: "+g,i,Tr,Ur,Ur);try{return b.runTask(T,s,d)}finally{b.cancelTask(T)}}runGuarded(i,s,d){return this._inner.runGuarded(i,s,d)}runOutsideAngular(i){return this._outer.run(i)}}const Tr={};function wo(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function Co(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function Wo(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function Vo(t){t._nesting--,wo(t)}class ks{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new qr,this.onMicrotaskEmpty=new qr,this.onStable=new qr,this.onError=new qr}run(i,s,d){return i.apply(s,d)}runGuarded(i,s,d){return i.apply(s,d)}runOutsideAngular(i){return i()}runTask(i,s,d,g){return i.apply(s,d)}}var nl=function(t){return t[t.EarlyRead=0]="EarlyRead",t[t.Write=1]="Write",t[t.MixedReadWrite=2]="MixedReadWrite",t[t.Read=3]="Read",t}(nl||{});const xd={destroy(){}};function Mm(t,i){!i&&function ru(t){if(!Ee()&&!function Fi(){return Nt}())throw new Yt(-203,!1)}();const s=i?.injector??ji(pr);if(!function lc(t){return"browser"===(t??ji(pr)).get(Tp)}(s))return xd;Cr("NgAfterNextRender");const d=s.get(Cu),g=d.handler??=new Sm,b=i?.phase??nl.MixedReadWrite,T=()=>{g.unregister(k),A()},A=s.get(Zi).onDestroy(T),k=new Am(s,b,()=>{T(),t()});return g.register(k),{destroy:T}}class Am{constructor(i,s,d){this.phase=s,this.callbackFn=d,this.zone=i.get(ar),this.errorHandler=i.get(Nl,null,{optional:!0})}invoke(){try{this.zone.runOutsideAngular(this.callbackFn)}catch(i){this.errorHandler?.handleError(i)}}}class Sm{constructor(){this.executingCallbacks=!1,this.buckets={[nl.EarlyRead]:new Set,[nl.Write]:new Set,[nl.MixedReadWrite]:new Set,[nl.Read]:new Set},this.deferredCallbacks=new Set}register(i){(this.executingCallbacks?this.deferredCallbacks:this.buckets[i.phase]).add(i)}unregister(i){this.buckets[i.phase].delete(i),this.deferredCallbacks.delete(i)}execute(){let i=!1;this.executingCallbacks=!0;for(const s of Object.values(this.buckets))for(const d of s)i=!0,d.invoke();this.executingCallbacks=!1;for(const s of this.deferredCallbacks)this.buckets[s.phase].add(s);return this.deferredCallbacks.clear(),i}destroy(){for(const i of Object.values(this.buckets))i.clear();this.deferredCallbacks.clear()}}let Cu=(()=>{class t{constructor(){this.handler=null,this.internalCallbacks=[]}execute(){const s=[...this.internalCallbacks];this.internalCallbacks.length=0;for(const g of s)g();return!!this.handler?.execute()||s.length>0}ngOnDestroy(){this.handler?.destroy(),this.handler=null,this.internalCallbacks.length=0}static#e=this.\u0275prov=qi({token:t,providedIn:"root",factory:()=>new t})}return t})();function Pm(t,i){const s=Lo(i,t),d=s[Ln];!function jl(t,i){for(let s=i.length;s<t.blueprint.length;s++)i.push(t.blueprint[s])}(d,s);const g=s[ni];null!==g&&null===s[bs]&&(s[bs]=ka(g,s[xo])),Nf(d,s,s[$r])}function Nf(t,i,s){R(i);try{const d=t.viewQuery;null!==d&&L(1,d,s);const g=t.template;null!==g&&h_(t,i,g,1,s),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&E(t,i),t.staticViewQueries&&L(2,t.viewQuery,s);const b=t.components;null!==b&&function Eu(t,i){for(let s=0;s<i.length;s++)Pm(t,i[s])}(i,b)}catch(d){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),d}finally{i[Di]&=-5,je()}}function wd(t,i,s){let d=s?t.styles:null,g=s?t.classes:null,b=0;if(null!==i)for(let T=0;T<i.length;T++){const A=i[T];"number"==typeof A?b=A:1==b?g=fn(g,A):2==b&&(d=fn(d,A+": "+i[++T]+";"))}s?t.styles=d:t.stylesWithoutHost=d,s?t.classes=g:t.classesWithoutHost=g}class Bf extends fh{constructor(i){super(),this.ngModule=i}resolveComponentFactory(i){const s=nr(i);return new ms(s,this.ngModule)}}function fc(t){const i=[];for(const s in t){if(!t.hasOwnProperty(s))continue;const d=t[s];void 0!==d&&i.push({propName:Array.isArray(d)?d[0]:d,templateName:s})}return i}class wv{constructor(i,s){this.injector=i,this.parentInjector=s}get(i,s,d){d=eo(d);const g=this.injector.get(i,gh,d);return g!==gh||s===gh?g:this.parentInjector.get(i,s,d)}}class ms extends Jg{get inputs(){const i=this.componentDef,s=i.inputTransforms,d=fc(i.inputs);if(null!==s)for(const g of d)s.hasOwnProperty(g.propName)&&(g.transform=s[g.propName]);return d}get outputs(){return fc(this.componentDef.outputs)}constructor(i,s){super(),this.componentDef=i,this.ngModule=s,this.componentType=i.type,this.selector=function ja(t){return t.map(Ua).join(",")}(i.selectors),this.ngContentSelectors=i.ngContentSelectors?i.ngContentSelectors:[],this.isBoundToModule=!!s}create(i,s,d,g){let b=(g=g||this.ngModule)instanceof as?g:g?.injector;b&&null!==this.componentDef.getStandaloneInjector&&(b=this.componentDef.getStandaloneInjector(b)||b);const T=b?new wv(i,b):i,A=T.get(hc,null);if(null===A)throw new Yt(407,!1);const Je={rendererFactory:A,sanitizer:T.get(Pf,null),inlineEffectRunner:null,afterRenderEventManager:T.get(Cu,null),changeDetectionScheduler:T.get(ch,null)},Rt=A.createRenderer(null,this.componentDef),Gt=this.componentDef.selectors[0][0]||"div",Tn=d?function Ul(t,i,s,d){const b=d.get(a_,!1)||s===Mo.ShadowDom,T=t.selectRootElement(i,b);return function Em(t){Lf(t)}(T),T}(Rt,d,this.componentDef.encapsulation,T):sf(Rt,Gt,function Om(t){const i=t.toLowerCase();return"svg"===i?"svg":"math"===i?"math":null}(Gt));let ii=512;this.componentDef.signals?ii|=4096:this.componentDef.onPush||(ii|=16);let ui=null;null!==Tn&&(ui=ka(Tn,T,!0));const Si=Eh(0,null,null,1,0,null,null,null,null,null,null),Jn=Ch(null,Si,null,ii,null,null,Je,Rt,T,null,ui);let ur,Rr;R(Jn);try{const jr=this.componentDef;let wa,dy=null;jr.findHostDirectiveDefs?(wa=[],dy=new Map,jr.findHostDirectiveDefs(jr,wa,dy),wa.push(jr)):wa=[jr];const _A=function Dh(t,i){const s=t[Ln],d=Gi;return t[d]=i,vu(s,d,2,"#host",null)}(Jn,Tn),yA=function Rm(t,i,s,d,g,b,T){const A=g[Ln];!function T_(t,i,s,d){for(const g of t)i.mergedAttrs=vs(i.mergedAttrs,g.hostAttrs);null!==i.mergedAttrs&&(wd(i,i.mergedAttrs,!0),null!==s&&id(d,s,i))}(d,t,i,T);let k=null;null!==i&&(k=ka(i,g[xo]));const q=b.rendererFactory.createRenderer(i,s);let ge=16;s.signals?ge=4096:s.onPush&&(ge=64);const Je=Ch(g,xu(s),null,ge,g[t.index],t,b,q,null,null,k);return A.firstCreatePass&&wu(A,t,d.length-1),M(g,Je),g[t.index]=Je}(_A,Tn,jr,wa,Jn,Je,Rt);Rr=_a(Si,Gi),Tn&&function hC(t,i,s,d){if(d)zs(t,s,["ng-version","17.1.1"]);else{const{attrs:g,classes:b}=function Us(t){const i=[],s=[];let d=1,g=2;for(;d<t.length;){let b=t[d];if("string"==typeof b)2===g?""!==b&&i.push(b,t[++d]):8===g&&s.push(b);else{if(!Wi(g))break;g=b}d++}return{attrs:i,classes:s}}(i.selectors[0]);g&&zs(t,s,g),b&&b.length>0&&du(t,s,b.join(" "))}}(Rt,jr,Tn,d),void 0!==s&&function fC(t,i,s){const d=t.projection=[];for(let g=0;g<i.length;g++){const b=s[g];d.push(null!=b?Array.from(b):null)}}(Rr,this.ngContentSelectors,s),ur=function Tu(t,i,s,d,g,b){const T=Nr(),A=g[Ln],k=ts(T,g);kf(A,g,T,s,null,d);for(let ge=0;ge<s.length;ge++)ls(fl(g,A,T.directiveStart+ge,T),g);Ff(A,g,T),k&&ls(k,g);const q=fl(g,A,T.directiveStart+T.componentOffset,T);if(t[$r]=g[$r]=q,null!==b)for(const ge of b)ge(q,i);return bm(A,T,t),q}(yA,jr,wa,dy,Jn,[pC]),Nf(Si,Jn,null)}finally{je()}return new ba(this.componentType,ur,kc(Rr,Jn),Jn,Rr)}}class ba extends av{constructor(i,s,d,g,b){super(),this.location=d,this._rootLView=g,this._tNode=b,this.previousInputValues=null,this.instance=s,this.hostView=this.changeDetectorRef=new Qn(g,void 0,!1),this.componentType=i}setInput(i,s){const d=this._tNode.inputs;let g;if(null!==d&&(g=d[i])){if(this.previousInputValues??=new Map,this.previousInputValues.has(i)&&Object.is(this.previousInputValues.get(i),s))return;const b=this._rootLView;Le(b[Ln],b,g,i,s),this.previousInputValues.set(i,s),zn(Lo(this._tNode.index,b))}}get injector(){return new Go(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(i){this.hostView.onDestroy(i)}}function pC(){const t=Nr();Wn(Sn()[Ln],t)}function Cv(t){let i=function rx(t){return Object.getPrototypeOf(t.prototype).constructor}(t.type),s=!0;const d=[t];for(;i;){let g;if(Zs(t))g=i.\u0275cmp||i.\u0275dir;else{if(i.\u0275cmp)throw new Yt(903,!1);g=i.\u0275dir}if(g){if(s){d.push(g);const T=t;T.inputs=D_(t.inputs),T.inputTransforms=D_(t.inputTransforms),T.declaredInputs=D_(t.declaredInputs),T.outputs=D_(t.outputs);const A=g.hostBindings;A&&vC(t,A);const k=g.viewQuery,q=g.contentQueries;if(k&&_C(t,k),q&&yC(t,q),mC(t,g),dr(t.outputs,g.outputs),Zs(g)&&g.data.animation){const ge=t.data;ge.animation=(ge.animation||[]).concat(g.data.animation)}}const b=g.features;if(b)for(let T=0;T<b.length;T++){const A=b[T];A&&A.ngInherit&&A(t),A===Cv&&(s=!1)}}i=Object.getPrototypeOf(i)}!function gC(t){let i=0,s=null;for(let d=t.length-1;d>=0;d--){const g=t[d];g.hostVars=i+=g.hostVars,g.hostAttrs=vs(g.hostAttrs,s=vs(s,g.hostAttrs))}}(d)}function mC(t,i){for(const s in i.inputs){if(!i.inputs.hasOwnProperty(s)||t.inputs.hasOwnProperty(s))continue;const d=i.inputs[s];if(void 0!==d&&(t.inputs[s]=d,t.declaredInputs[s]=i.declaredInputs[s],null!==i.inputTransforms)){const g=Array.isArray(d)?d[0]:d;if(!i.inputTransforms.hasOwnProperty(g))continue;t.inputTransforms??={},t.inputTransforms[g]=i.inputTransforms[g]}}}function D_(t){return t===to?{}:t===fr?[]:t}function _C(t,i){const s=t.viewQuery;t.viewQuery=s?(d,g)=>{i(d,g),s(d,g)}:i}function yC(t,i){const s=t.contentQueries;t.contentQueries=s?(d,g,b)=>{i(d,g,b),s(d,g,b)}:i}function vC(t,i){const s=t.hostBindings;t.hostBindings=s?(d,g)=>{i(d,g),s(d,g)}:i}function lx(t){const i=t.inputConfig,s={};for(const d in i)if(i.hasOwnProperty(d)){const g=i[d];Array.isArray(g)&&g[3]&&(s[d]=g[3])}t.inputTransforms=s}function Uf(t,i){return!i||null===i.firstChild||Gd(t)}function zm(t,i,s,d=!0){const g=i[Ln];if(function Uy(t,i,s,d){const g=oo+d,b=s.length;d>0&&(s[g-1][Oo]=i),d<b-oo?(i[Oo]=s[g],Ad(s,oo+d,i)):(s.push(i),i[Oo]=null),i[zr]=s;const T=i[ws];null!==T&&s!==T&&function Og(t,i){const s=t[na];i[kr]!==i[zr][zr][kr]&&(t[Di]|=$a.HasTransplantedViews),null===s?t[na]=[i]:s.push(i)}(T,i);const A=i[Vs];null!==A&&A.insertView(t),Ia(i),i[Di]|=128}(g,i,t,s),d){const T=ff(s,t),A=i[Ui],k=df(A,t[Cs]);null!==k&&function zy(t,i,s,d,g,b){d[ni]=g,d[Do]=i,pf(t,d,s,1,g,b)}(g,t[Do],A,i,k,T)}const b=i[bs];null!==b&&null!==b.firstChild&&(b.firstChild=null)}let P_=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=HC}return t})();function HC(){return yx(Nr(),Sn())}const WC=P_,gx=class extends WC{constructor(i,s,d){super(),this._lContainer=i,this._hostTNode=s,this._hostLView=d}get element(){return kc(this._hostTNode,this._hostLView)}get injector(){return new Go(this._hostTNode,this._hostLView)}get parentInjector(){const i=os(this._hostTNode,this._hostLView);if(Ci(i)){const s=Ir(i,this._hostLView),d=br(i);return new Go(s[Ln].data[d+8],s)}return new Go(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(i){const s=_x(this._lContainer);return null!==s&&s[i]||null}get length(){return this._lContainer.length-oo}createEmbeddedView(i,s,d){let g,b;"number"==typeof d?g=d:null!=d&&(g=d.index,b=d.injector);const A=i.createEmbeddedViewImpl(s||{},b,null);return this.insertImpl(A,g,Uf(this._hostTNode,null)),A}createComponent(i,s,d,g,b){const T=i&&!function Md(t){return"function"==typeof t}(i);let A;if(T)A=s;else{const Tn=s||{};A=Tn.index,d=Tn.injector,g=Tn.projectableNodes,b=Tn.environmentInjector||Tn.ngModuleRef}const k=T?i:new ms(nr(i)),q=d||this.parentInjector;if(!b&&null==k.ngModule){const ii=(T?q:this.parentInjector).get(as,null);ii&&(b=ii)}nr(k.componentType??{});const Gt=k.create(q,g,null,b);return this.insertImpl(Gt.hostView,A,Uf(this._hostTNode,null)),Gt}insert(i,s){return this.insertImpl(i,s,!0)}insertImpl(i,s,d){const g=i._lView;if(function Ml(t){return fo(t[zr])}(g)){const A=this.indexOf(i);if(-1!==A)this.detach(A);else{const k=g[zr],q=new gx(k,k[Do],k[zr]);q.detach(q.indexOf(i))}}const b=this._adjustIndex(s),T=this._lContainer;return zm(T,g,b,d),i.attachToViewContainerRef(),Ad(Sv(T),b,i),i}move(i,s){return this.insert(i,s)}indexOf(i){const s=_x(this._lContainer);return null!==s?s.indexOf(i):-1}remove(i){const s=this._adjustIndex(i,-1),d=Yd(this._lContainer,s);d&&(As(Sv(this._lContainer),s),lf(d[Ln],d))}detach(i){const s=this._adjustIndex(i,-1),d=Yd(this._lContainer,s);return d&&null!=As(Sv(this._lContainer),s)?new Qn(d):null}_adjustIndex(i,s=0){return i??this.length+s}};function _x(t){return t[8]}function Sv(t){return t[8]||(t[8]=[])}function yx(t,i){let s;const d=i[t.index];return fo(d)?s=d:(s=w(d,i,null,t),i[t.index]=s,M(i,s)),vx(s,i,t,d),new gx(s,t,i)}let vx=function bx(t,i,s,d){if(t[Cs])return;let g;g=8&s.type?Fr(d):function qC(t,i){const s=t[Ui],d=s.createComment(""),g=ts(i,t);return uu(s,df(s,g),d,function Kd(t,i){return t.nextSibling(i)}(s,g),!1),d}(i,s),t[Cs]=g},Pv=()=>!1;function jc(t,i,s){return t[i]=s}function gs(t,i,s){return!Object.is(t[i],s)&&(t[i]=s,!0)}function Ih(t,i,s,d){const g=gs(t,i,s);return gs(t,i+1,d)||g}function jf(t,i,s,d,g,b,T,A){const k=Sn(),q=gr(),ge=t+Gi,Je=q.firstCreatePass?function XC(t,i,s,d,g,b,T,A,k){const q=i.consts,ge=vu(i,t,4,T||null,Is(q,A));Tm(i,s,ge,Is(q,k)),Wn(i,ge);const Je=ge.tView=Eh(2,ge,d,g,b,i.directiveRegistry,i.pipeRegistry,null,i.schemas,q,null);return null!==i.queries&&(i.queries.template(i,ge),Je.queries=i.queries.embeddedTView(ge)),ge}(ge,q,k,i,s,d,g,b,T):q.data[ge];oi(Je,!1);const Rt=wx(q,k,Je,t);qt()&&Xd(q,k,Rt,Je),ls(Rt,k);const Gt=w(Rt,k,Rt,Je);return k[ge]=Gt,M(k,Gt),function xx(t,i,s){return Pv(t,i,s)}(Gt,Je,k),ql(Je)&&yd(q,k,Je),null!=T&&wm(k,Je,A),jf}let wx=function Cx(t,i,s,d){return $t(!0),i[Ui].createComment("")};function Uv(t,i,s,d){const g=Sn();return gs(g,oa(),i)&&(gr(),c(ne(),g,t,i,s,d)),Uv}function Yf(t,i,s,d){return gs(t,oa(),s)?i+dt(s)+d:sr}function Kf(t,i,s,d,g,b,T,A){const q=function O_(t,i,s,d,g){const b=Ih(t,i,s,d);return gs(t,i+2,g)||b}(t,qa(),s,g,T);return va(3),q?i+dt(s)+d+dt(g)+b+dt(T)+A:sr}function Xf(t,i,s,d,g,b,T,A,k,q){const Je=function Vl(t,i,s,d,g,b){const T=Ih(t,i,s,d);return Ih(t,i+2,g,b)||T}(t,qa(),s,g,T,k);return va(4),Je?i+dt(s)+d+dt(g)+b+dt(T)+A+dt(k)+q:sr}function B_(t,i){return t<<17|i<<2}function Ed(t){return t>>17&32767}function jv(t){return 2|t}function Ah(t){return(131068&t)>>2}function Vv(t,i){return-131069&t|i<<2}function $v(t){return 1|t}function t1(t,i,s,d){const g=t[s+1],b=null===i;let T=d?Ed(g):Ah(g),A=!1;for(;0!==T&&(!1===A||b);){const q=t[T+1];FE(t[T],i)&&(A=!0,t[T+1]=d?$v(q):jv(q)),T=d?Ed(q):Ah(q)}A&&(t[s+1]=d?jv(g):$v(g))}function FE(t,i){return null===t||null==i||(Array.isArray(t)?t[1]:t)===i||!(!Array.isArray(t)||"string"!=typeof i)&&Ec(t,i)>=0}function Zv(t,i,s){const d=Sn();return gs(d,oa(),i)&&Fa(gr(),ne(),d,t,i,d[Ui],s,!1),Zv}function Gv(t,i,s,d,g){const T=g?"class":"style";Le(t,s,i.inputs[T],T,d)}function Hv(t,i,s){return pc(t,i,s,!1),Hv}function Wv(t,i){return pc(t,i,null,!0),Wv}function pc(t,i,s,d){const g=Sn(),b=gr(),T=va(2);b.firstUpdatePass&&function c1(t,i,s,d){const g=t.data;if(null===g[s+1]){const b=g[$e()],T=function l1(t,i){return i>=t.expandoStartIndex}(t,s);(function f1(t,i){return 0!=(t.flags&(i?8:16))})(b,d)&&null===i&&!T&&(i=!1),i=function GE(t,i,s,d){const g=function p(t){const i=Hi.lFrame.currentDirectiveIndex;return-1===i?null:t[i]}(t);let b=d?i.residualClasses:i.residualStyles;if(null===g)0===(d?i.classBindings:i.styleBindings)&&(s=Zm(s=qv(null,t,i,s,d),i.attrs,d),b=null);else{const T=i.directiveStylingLast;if(-1===T||t[T]!==g)if(s=qv(g,t,i,s,d),null===b){let k=function HE(t,i,s){const d=s?i.classBindings:i.styleBindings;if(0!==Ah(d))return t[Ed(d)]}(t,i,d);void 0!==k&&Array.isArray(k)&&(k=qv(null,t,i,k[1],d),k=Zm(k,i.attrs,d),function WE(t,i,s,d){t[Ed(s?i.classBindings:i.styleBindings)]=d}(t,i,d,k))}else b=function qE(t,i,s){let d;const g=i.directiveEnd;for(let b=1+i.directiveStylingLast;b<g;b++)d=Zm(d,t[b].hostAttrs,s);return Zm(d,i.attrs,s)}(t,i,d)}return void 0!==b&&(d?i.residualClasses=b:i.residualStyles=b),s}(g,b,i,d),function LE(t,i,s,d,g,b){let T=b?i.classBindings:i.styleBindings,A=Ed(T),k=Ah(T);t[d]=s;let ge,q=!1;if(Array.isArray(s)?(ge=s[1],(null===ge||Ec(s,ge)>0)&&(q=!0)):ge=s,g)if(0!==k){const Rt=Ed(t[A+1]);t[d+1]=B_(Rt,A),0!==Rt&&(t[Rt+1]=Vv(t[Rt+1],d)),t[A+1]=function OE(t,i){return 131071&t|i<<17}(t[A+1],d)}else t[d+1]=B_(A,0),0!==A&&(t[A+1]=Vv(t[A+1],d)),A=d;else t[d+1]=B_(k,0),0===A?A=d:t[k+1]=Vv(t[k+1],d),k=d;q&&(t[d+1]=jv(t[d+1])),t1(t,ge,d,!0),t1(t,ge,d,!1),function kE(t,i,s,d,g){const b=g?t.residualClasses:t.residualStyles;null!=b&&"string"==typeof i&&Ec(b,i)>=0&&(s[d+1]=$v(s[d+1]))}(i,ge,t,d,b),T=B_(A,k),b?i.classBindings=T:i.styleBindings=T}(g,b,i,s,T,d)}}(b,t,T,d),i!==sr&&gs(g,T,i)&&function d1(t,i,s,d,g,b,T,A){if(!(3&i.type))return;const k=t.data,q=k[A+1],ge=function RE(t){return 1==(1&t)}(q)?h1(k,i,s,g,Ah(q),T):void 0;z_(ge)||(z_(b)||function PE(t){return 2==(2&t)}(q)&&(b=h1(k,null,s,g,A,T)),function Js(t,i,s,d,g){if(i)g?t.addClass(s,d):t.removeClass(s,d);else{let b=-1===d.indexOf("-")?void 0:Pc.DashCase;null==g?t.removeStyle(s,d,b):("string"==typeof g&&g.endsWith("!important")&&(g=g.slice(0,-10),b|=Pc.Important),t.setStyle(s,d,g,b))}}(d,T,ll($e(),s),g,b))}(b,b.data[$e()],g,g[Ui],t,g[T+1]=function XE(t,i){return null==t||""===t||("string"==typeof i?t+=i:"object"==typeof t&&(t=Ei(uc(t)))),t}(i,s),d,T)}function qv(t,i,s,d,g){let b=null;const T=s.directiveEnd;let A=s.directiveStylingLast;for(-1===A?A=s.directiveStart:A++;A<T&&(b=i[A],d=Zm(d,b.hostAttrs,g),b!==t);)A++;return null!==t&&(s.directiveStylingLast=A),d}function Zm(t,i,s){const d=s?1:2;let g=-1;if(null!==i)for(let b=0;b<i.length;b++){const T=i[b];"number"==typeof T?g=T:g===d&&(Array.isArray(t)||(t=void 0===t?[]:["",t]),Ss(t,T,!!s||i[++b]))}return void 0===t?null:t}function h1(t,i,s,d,g,b){const T=null===i;let A;for(;g>0;){const k=t[g],q=Array.isArray(k),ge=q?k[1]:k,Je=null===ge;let Rt=s[g+1];Rt===sr&&(Rt=Je?fr:void 0);let Gt=Je?oc(Rt,d):ge===d?Rt:void 0;if(q&&!z_(Gt)&&(Gt=oc(k,d)),z_(Gt)&&(A=Gt,T))return A;const Tn=t[g+1];g=T?Ed(Tn):Ah(Tn)}if(null!==i){let k=b?i.residualClasses:i.residualStyles;null!=k&&(A=oc(k,d))}return A}function z_(t){return void 0!==t}function U_(t,i,s,d){const g=Sn(),b=gr(),T=Gi+t,A=g[Ui],k=b.firstCreatePass?function bT(t,i,s,d,g,b){const T=i.consts,k=vu(i,t,2,d,Is(T,g));return Tm(i,s,k,Is(T,b)),null!==k.attrs&&wd(k,k.attrs,!1),null!==k.mergedAttrs&&wd(k,k.mergedAttrs,!0),null!==i.queries&&i.queries.elementStart(i,k),k}(T,b,g,i,s,d):b.data[T],q=_1(b,g,k,A,i,t);g[T]=q;const ge=ql(k);return oi(k,!0),id(A,q,k),32!=(32&k.flags)&&qt()&&Xd(b,g,q,k),0===function Uo(){return Hi.lFrame.elementDepthCount}()&&ls(q,g),function qc(){Hi.lFrame.elementDepthCount++}(),ge&&(yd(b,g,k),bm(b,k,g)),null!==d&&wm(g,k),U_}function j_(){let t=Nr();nc()?Yc():(t=t.parent,oi(t,!1));const i=t;(function Ms(t){return Hi.skipHydrationRootTNode===t})(i)&&function Ma(){Hi.skipHydrationRootTNode=null}(),function Su(){Hi.lFrame.elementDepthCount--}();const s=gr();return s.firstCreatePass&&(Wn(s,t),El(t)&&s.queries.elementEnd(t)),null!=i.classesWithoutHost&&function mi(t){return 0!=(8&t.flags)}(i)&&Gv(s,i,Sn(),i.classesWithoutHost,!0),null!=i.stylesWithoutHost&&function Oi(t){return 0!=(16&t.flags)}(i)&&Gv(s,i,Sn(),i.stylesWithoutHost,!1),j_}function Qv(t,i,s,d){return U_(t,i,s,d),j_(),Qv}let _1=(t,i,s,d,g,b)=>($t(!0),sf(d,g,function kt(){return Hi.lFrame.currentNamespace}()));function V_(t,i,s){const d=Sn(),g=gr(),b=t+Gi,T=g.firstCreatePass?function ET(t,i,s,d,g){const b=i.consts,T=Is(b,d),A=vu(i,t,8,"ng-container",T);return null!==T&&wd(A,T,!0),Tm(i,s,A,Is(b,g)),null!==i.queries&&i.queries.elementStart(i,A),A}(b,g,d,i,s):g.data[b];oi(T,!0);const A=y1(g,d,T,t);return d[b]=A,qt()&&Xd(g,d,A,T),ls(A,d),ql(T)&&(yd(g,d,T),bm(g,T,d)),null!=s&&wm(d,T),V_}function $_(){let t=Nr();const i=gr();return nc()?Yc():(t=t.parent,oi(t,!1)),i.firstCreatePass&&(Wn(i,t),El(t)&&i.queries.elementEnd(t)),$_}function e0(t,i,s){return V_(t,i,s),$_(),e0}let y1=(t,i,s,d)=>($t(!0),zp(i[Ui],""));function v1(){return Sn()}const Sh=void 0;var MT=["en",[["a","p"],["AM","PM"],Sh],[["AM","PM"],Sh,Sh],[["S","M","T","W","T","F","S"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Su","Mo","Tu","We","Th","Fr","Sa"]],Sh,[["J","F","M","A","M","J","J","A","S","O","N","D"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"]],Sh,[["B","A"],["BC","AD"],["Before Christ","Anno Domini"]],0,[6,0],["M/d/yy","MMM d, y","MMMM d, y","EEEE, MMMM d, y"],["h:mm a","h:mm:ss a","h:mm:ss a z","h:mm:ss a zzzz"],["{1}, {0}",Sh,"{1} 'at' {0}",Sh],[".",",",";","%","+","-","E","\xd7","\u2030","\u221e","NaN",":"],["#,##0.###","#,##0%","\xa4#,##0.00","#E0"],"USD","$","US Dollar",{},"ltr",function IT(t){const s=Math.floor(Math.abs(t)),d=t.toString().replace(/^[^.]*\.?/,"").length;return 1===s&&0===d?1:5}];let rp={};function t0(t){const i=function AT(t){return t.toLowerCase().replace(/_/g,"-")}(t);let s=C1(i);if(s)return s;const d=i.split("-")[0];if(s=C1(d),s)return s;if("en"===d)return MT;throw new Yt(701,!1)}function w1(t){return t0(t)[op.PluralCase]}function C1(t){return t in rp||(rp[t]=St.ng&&St.ng.common&&St.ng.common.locales&&St.ng.common.locales[t]),rp[t]}var op=function(t){return t[t.LocaleId=0]="LocaleId",t[t.DayPeriodsFormat=1]="DayPeriodsFormat",t[t.DayPeriodsStandalone=2]="DayPeriodsStandalone",t[t.DaysFormat=3]="DaysFormat",t[t.DaysStandalone=4]="DaysStandalone",t[t.MonthsFormat=5]="MonthsFormat",t[t.MonthsStandalone=6]="MonthsStandalone",t[t.Eras=7]="Eras",t[t.FirstDayOfWeek=8]="FirstDayOfWeek",t[t.WeekendRange=9]="WeekendRange",t[t.DateFormat=10]="DateFormat",t[t.TimeFormat=11]="TimeFormat",t[t.DateTimeFormat=12]="DateTimeFormat",t[t.NumberSymbols=13]="NumberSymbols",t[t.NumberFormats=14]="NumberFormats",t[t.CurrencyCode=15]="CurrencyCode",t[t.CurrencySymbol=16]="CurrencySymbol",t[t.CurrencyName=17]="CurrencyName",t[t.Currencies=18]="Currencies",t[t.Directionality=19]="Directionality",t[t.PluralCase=20]="PluralCase",t[t.ExtraData=21]="ExtraData",t}(op||{});const sp="en-US";let E1=sp;function o0(t){return!!t&&"function"==typeof t.then}function Y1(t){return!!t&&"function"==typeof t.subscribe}function s0(t,i,s,d){const g=Sn(),b=gr(),T=Nr();return function K1(t,i,s,d,g,b,T){const A=ql(d),q=t.firstCreatePass&&W(t),ge=i[$r],Je=j(i);let Rt=!0;if(3&d.type||T){const ii=ts(d,i),ui=T?T(ii):ii,Si=Je.length,Jn=T?Rr=>T(Fr(Rr[d.index])):d.index;let ur=null;if(!T&&A&&(ur=function CD(t,i,s,d){const g=t.cleanup;if(null!=g)for(let b=0;b<g.length-1;b+=2){const T=g[b];if(T===s&&g[b+1]===d){const A=i[al],k=g[b+2];return A.length>k?A[k]:null}"string"==typeof T&&(b+=2)}return null}(t,i,g,d.index)),null!==ur)(ur.__ngLastListenerFn__||ur).__ngNextListenerFn__=b,ur.__ngLastListenerFn__=b,Rt=!1;else{b=Q1(d,i,ge,b,!1);const Rr=s.listen(ui,g,b);Je.push(b,Rr),q&&q.push(g,Jn,Si,Si+1)}}else b=Q1(d,i,ge,b,!1);const Gt=d.outputs;let Tn;if(Rt&&null!==Gt&&(Tn=Gt[g])){const ii=Tn.length;if(ii)for(let ui=0;ui<ii;ui+=2){const jr=i[Tn[ui]][Tn[ui+1]].subscribe(b),wa=Je.length;Je.push(b,jr),q&&q.push(g,d.index,wa,-(wa+1))}}}(b,g,g[Ui],T,t,i,d),s0}function X1(t,i,s,d){try{return Zr(6,i,s),!1!==s(d)}catch(g){return se(t,g),!1}finally{Zr(7,i,s)}}function Q1(t,i,s,d,g){return function b(T){if(T===Function)return d;zn(t.componentOffset>-1?Lo(t.index,i):i);let k=X1(i,s,d,T),q=b.__ngNextListenerFn__;for(;q;)k=X1(i,s,q,T)&&k,q=q.__ngNextListenerFn__;return g&&!1===k&&T.preventDefault(),k}}function eb(t=1){return function Ye(t){return(Hi.lFrame.contextLView=function Al(t,i){for(;t>0;)i=i[No],t--;return i}(t,Hi.lFrame.contextLView))[$r]}(t)}function ED(t,i){let s=null;const d=function bl(t){const i=t.attrs;if(null!=i){const s=i.indexOf(5);if(!(1&s))return i[s+1]}return null}(t);for(let g=0;g<i.length;g++){const b=i[g];if("*"!==b){if(null===d?Ca(t,b,!0):ua(d,b))return g}else s=g}return s}function tb(t){const i=Sn()[kr][Do];if(!i.projection){const d=i.projection=function Sd(t,i){const s=[];for(let d=0;d<t;d++)s.push(i);return s}(t?t.length:1,null),g=d.slice();let b=i.child;for(;null!==b;){const T=t?ED(b,t):0;null!==T&&(g[T]?g[T].projectionNext=b:d[T]=b,g[T]=b),b=b.next}}}function nb(t,i=0,s){const d=Sn(),g=gr(),b=vu(g,Gi+t,16,null,s||null);null===b.projection&&(b.projection=i),Yc(),(!d[bs]||ec())&&32!=(32&b.flags)&&function Ng(t,i,s){eh(i[Ui],0,i,s,jp(t,s,i),ed(s.parent||i[Do],s,i))}(g,d,b)}function a0(t,i,s){return l0(t,"",i,"",s),a0}function l0(t,i,s,d,g){const b=Sn(),T=Yf(b,i,s,d);return T!==sr&&Fa(gr(),ne(),b,t,T,b[Ui],g,!1),l0}function TD(){return this._results[Symbol.iterator]()}class c0{static#e=Symbol.iterator;get changes(){return this._changes??=new qr}constructor(i=!1){this._emitDistinctChangesOnly=i,this.dirty=!0,this._results=[],this._changesDetected=!1,this._changes=void 0,this.length=0,this.first=void 0,this.last=void 0;const s=c0.prototype;s[Symbol.iterator]||(s[Symbol.iterator]=TD)}get(i){return this._results[i]}map(i){return this._results.map(i)}filter(i){return this._results.filter(i)}find(i){return this._results.find(i)}reduce(i,s){return this._results.reduce(i,s)}forEach(i){this._results.forEach(i)}some(i){return this._results.some(i)}toArray(){return this._results.slice()}toString(){return this._results.toString()}reset(i,s){this.dirty=!1;const d=function vi(t){return t.flat(Number.POSITIVE_INFINITY)}(i);(this._changesDetected=!function So(t,i,s){if(t.length!==i.length)return!1;for(let d=0;d<t.length;d++){let g=t[d],b=i[d];if(s&&(g=s(g),b=s(b)),b!==g)return!1}return!0}(this._results,d,s))&&(this._results=d,this.length=d.length,this.last=d[this.length-1],this.first=d[0])}notifyOnChanges(){void 0!==this._changes&&(this._changesDetected||!this._emitDistinctChangesOnly)&&this._changes.emit(this)}setDirty(){this.dirty=!0}destroy(){void 0!==this._changes&&(this._changes.complete(),this._changes.unsubscribe())}}let Jm=(()=>{class t{static#e=this.__NG_ELEMENT_ID__=MD}return t})();const DD=Jm,ID=class extends DD{constructor(i,s,d){super(),this._declarationLView=i,this._declarationTContainer=s,this.elementRef=d}get ssrId(){return this._declarationTContainer.tView?.ssrId||null}createEmbeddedView(i,s){return this.createEmbeddedViewImpl(i,s)}createEmbeddedViewImpl(i,s,d){const g=function Bm(t,i,s,d){const g=i.tView,A=Ch(t,g,s,4096&t[Di]?4096:16,null,i,null,null,null,d?.injector??null,d?.dehydratedView??null);A[ws]=t[i.index];const q=t[Vs];return null!==q&&(A[Vs]=q.createEmbeddedView(g)),Nf(g,A,s),A}(this._declarationLView,this._declarationTContainer,i,{injector:s,dehydratedView:d});return new Qn(g)}};function MD(){return q_(Nr(),Sn())}function q_(t,i){return 4&t.type?new ID(i,t,kc(t,i)):null}class u0{constructor(i){this.queryList=i,this.matches=null}clone(){return new u0(this.queryList)}setDirty(){this.queryList.setDirty()}}class d0{constructor(i=[]){this.queries=i}createEmbeddedView(i){const s=i.queries;if(null!==s){const d=null!==i.contentQueries?i.contentQueries[0]:s.length,g=[];for(let b=0;b<d;b++){const T=s.getByIndex(b);g.push(this.queries[T.indexInDeclarationView].clone())}return new d0(g)}return null}insertView(i){this.dirtyQueriesWithMatches(i)}detachView(i){this.dirtyQueriesWithMatches(i)}dirtyQueriesWithMatches(i){for(let s=0;s<this.queries.length;s++)null!==mb(i,s).matches&&this.queries[s].setDirty()}}class db{constructor(i,s,d=null){this.predicate=i,this.flags=s,this.read=d}}class h0{constructor(i=[]){this.queries=i}elementStart(i,s){for(let d=0;d<this.queries.length;d++)this.queries[d].elementStart(i,s)}elementEnd(i){for(let s=0;s<this.queries.length;s++)this.queries[s].elementEnd(i)}embeddedTView(i){let s=null;for(let d=0;d<this.length;d++){const g=null!==s?s.length:0,b=this.getByIndex(d).embeddedTView(i,g);b&&(b.indexInDeclarationView=d,null!==s?s.push(b):s=[b])}return null!==s?new h0(s):null}template(i,s){for(let d=0;d<this.queries.length;d++)this.queries[d].template(i,s)}getByIndex(i){return this.queries[i]}get length(){return this.queries.length}track(i){this.queries.push(i)}}class f0{constructor(i,s=-1){this.metadata=i,this.matches=null,this.indexInDeclarationView=-1,this.crossesNgTemplate=!1,this._appliesToNextNode=!0,this._declarationNodeIndex=s}elementStart(i,s){this.isApplyingToNode(s)&&this.matchTNode(i,s)}elementEnd(i){this._declarationNodeIndex===i.index&&(this._appliesToNextNode=!1)}template(i,s){this.elementStart(i,s)}embeddedTView(i,s){return this.isApplyingToNode(i)?(this.crossesNgTemplate=!0,this.addMatch(-i.index,s),new f0(this.metadata)):null}isApplyingToNode(i){if(this._appliesToNextNode&&1!=(1&this.metadata.flags)){const s=this._declarationNodeIndex;let d=i.parent;for(;null!==d&&8&d.type&&d.index!==s;)d=d.parent;return s===(null!==d?d.index:-1)}return this._appliesToNextNode}matchTNode(i,s){const d=this.metadata.predicate;if(Array.isArray(d))for(let g=0;g<d.length;g++){const b=d[g];this.matchTNodeWithReadOption(i,s,AD(s,b)),this.matchTNodeWithReadOption(i,s,Pl(s,i,b,!1,!1))}else d===Jm?4&s.type&&this.matchTNodeWithReadOption(i,s,-1):this.matchTNodeWithReadOption(i,s,Pl(s,i,d,!1,!1))}matchTNodeWithReadOption(i,s,d){if(null!==d){const g=this.metadata.read;if(null!==g)if(g===ph||g===P_||g===Jm&&4&s.type)this.addMatch(s.index,-2);else{const b=Pl(s,i,g,!1,!1);null!==b&&this.addMatch(s.index,b)}else this.addMatch(s.index,d)}}addMatch(i,s){null===this.matches?this.matches=[i,s]:this.matches.push(i,s)}}function AD(t,i){const s=t.localNames;if(null!==s)for(let d=0;d<s.length;d+=2)if(s[d]===i)return s[d+1];return null}function PD(t,i,s,d){return-1===s?function SD(t,i){return 11&t.type?kc(t,i):4&t.type?q_(t,i):null}(i,t):-2===s?function OD(t,i,s){return s===ph?kc(i,t):s===Jm?q_(i,t):s===P_?yx(i,t):void 0}(t,i,d):fl(t,t[Ln],s,i)}function hb(t,i,s,d){const g=i[Vs].queries[d];if(null===g.matches){const b=t.data,T=s.matches,A=[];for(let k=0;k<T.length;k+=2){const q=T[k];A.push(q<0?null:PD(i,b[q],T[k+1],s.metadata.read))}g.matches=A}return g.matches}function p0(t,i,s,d){const g=t.queries.getByIndex(s),b=g.matches;if(null!==b){const T=hb(t,i,g,s);for(let A=0;A<b.length;A+=2){const k=b[A];if(k>0)d.push(T[A/2]);else{const q=b[A+1],ge=i[-k];for(let Je=oo;Je<ge.length;Je++){const Rt=ge[Je];Rt[ws]===Rt[zr]&&p0(Rt[Ln],Rt,q,d)}if(null!==ge[na]){const Je=ge[na];for(let Rt=0;Rt<Je.length;Rt++){const Gt=Je[Rt];p0(Gt[Ln],Gt,q,d)}}}}}return d}function fb(t,i,s){const d=new c0(4==(4&s));(function f_(t,i,s,d){const g=j(i);g.push(s),t.firstCreatePass&&W(t).push(d,g.length-1)})(t,i,d,d.destroy),null===i[Vs]&&(i[Vs]=new d0),i[Vs].queries.push(new u0(d))}function pb(t,i,s){null===t.queries&&(t.queries=new h0),t.queries.track(new f0(i,s))}function mb(t,i){return t.queries.getByIndex(i)}function gb(t,i,s,d){const g=gr();if(g.firstCreatePass){const b=Nr();pb(g,new db(i,s,d),b.index),function LD(t,i){const s=t.contentQueries||(t.contentQueries=[]);i!==(s.length?s[s.length-1]:-1)&&s.push(t.queries.length-1,i)}(g,t),2==(2&s)&&(g.staticContentQueries=!0)}fb(g,Sn(),s)}function _b(t,i,s){const d=gr();d.firstCreatePass&&(pb(d,new db(t,i,s),-1),2==(2&i)&&(d.staticViewQueries=!0)),fb(d,Sn(),i)}function yb(t){const i=Sn(),s=gr(),d=y();x(d+1);const g=mb(s,d);if(t.dirty&&function Gc(t){return 4==(4&t[Di])}(i)===(2==(2&g.metadata.flags))){if(null===g.matches)t.reset([]);else{const b=g.crossesNgTemplate?p0(s,i,d,[]):hb(s,i,g,d);t.reset(b,mh),t.notifyOnChanges()}return!0}return!1}function vb(){return function RD(t,i){return t[Vs].queries[i].queryList}(Sn(),y())}function xb(t){return Wa(function Ru(){return Hi.lFrame.contextLView}(),Gi+t)}function Sb(t,i=""){const s=Sn(),d=gr(),g=t+Gi,b=d.firstCreatePass?vu(d,g,1,i,null):d.data[g],T=Pb(d,s,b,i,t);s[g]=T,qt()&&Xd(d,s,T,b),oi(b,!1)}let Pb=(t,i,s,d,g)=>($t(!0),function lu(t,i){return t.createText(i)}(i[Ui],d));function m0(t){return Y_("",t,""),m0}function Y_(t,i,s){const d=Sn(),g=Yf(d,t,i,s);return g!==sr&&rt(d,$e(),g),Y_}function g0(t,i,s,d,g){const b=Sn(),T=function Jf(t,i,s,d,g,b){const A=Ih(t,qa(),s,g);return va(2),A?i+dt(s)+d+dt(g)+b:sr}(b,t,i,s,d,g);return T!==sr&&rt(b,$e(),T),g0}function _0(t,i,s,d,g,b,T){const A=Sn(),k=Kf(A,t,i,s,d,g,b,T);return k!==sr&&rt(A,$e(),k),_0}function y0(t,i,s,d,g,b,T,A,k){const q=Sn(),ge=Xf(q,t,i,s,d,g,b,T,A,k);return ge!==sr&&rt(q,$e(),ge),y0}function v0(t,i,s,d,g){if(t=Jt(t),Array.isArray(t))for(let b=0;b<t.length;b++)v0(t[b],i,s,d,g);else{const b=gr(),T=Sn(),A=Nr();let k=fs(t)?t:Jt(t.provide);const q=Nd(t),ge=1048575&A.providerIndexes,Je=A.directiveStart,Rt=A.providerIndexes>>20;if(fs(t)||!t.multi){const Gt=new kn(q,g,yu),Tn=b0(k,i,g?ge:ge+Rt,Je);-1===Tn?(xc(go(A,T),b,k),x0(b,t,i.length),i.push(k),A.directiveStart++,A.directiveEnd++,g&&(A.providerIndexes+=1048576),s.push(Gt),T.push(Gt)):(s[Tn]=Gt,T[Tn]=Gt)}else{const Gt=b0(k,i,ge+Rt,Je),Tn=b0(k,i,ge,ge+Rt),ui=Tn>=0&&s[Tn];if(g&&!ui||!g&&!(Gt>=0&&s[Gt])){xc(go(A,T),b,k);const Si=function JD(t,i,s,d,g){const b=new kn(t,s,yu);return b.multi=[],b.index=i,b.componentProviders=0,Nb(b,g,d&&!s),b}(g?YD:qD,s.length,g,d,q);!g&&ui&&(s[Tn].providerFactory=Si),x0(b,t,i.length,0),i.push(k),A.directiveStart++,A.directiveEnd++,g&&(A.providerIndexes+=1048576),s.push(Si),T.push(Si)}else x0(b,t,Gt>-1?Gt:Tn,Nb(s[g?Tn:Gt],q,!g&&d));!g&&d&&ui&&s[Tn].componentProviders++}}}function x0(t,i,s,d){const g=fs(i),b=function Ja(t){return!!t.useClass}(i);if(g||b){const k=(b?Jt(i.useClass):i).prototype.ngOnDestroy;if(k){const q=t.destroyHooks||(t.destroyHooks=[]);if(!g&&i.multi){const ge=q.indexOf(s);-1===ge?q.push(s,[d,k]):q[ge+1].push(d,k)}else q.push(s,k)}}}function Nb(t,i,s){return s&&t.componentProviders++,t.multi.push(i)-1}function b0(t,i,s,d){for(let g=s;g<d;g++)if(i[g]===t)return g;return-1}function qD(t,i,s,d){return w0(this.multi,[])}function YD(t,i,s,d){const g=this.multi;let b;if(this.providerFactory){const T=this.providerFactory.componentProviders,A=fl(s,s[Ln],this.providerFactory.index,d);b=A.slice(0,T),w0(g,b);for(let k=T;k<A.length;k++)b.push(A[k])}else b=[],w0(g,b);return b}function w0(t,i){for(let s=0;s<t.length;s++)i.push((0,t[s])());return i}function Bb(t,i=[]){return s=>{s.providersResolver=(d,g)=>function WD(t,i,s){const d=gr();if(d.firstCreatePass){const g=Zs(t);v0(s,d.data,d.blueprint,g,!0),v0(i,d.data,d.blueprint,g,!1)}}(d,g?g(t):t,i)}}class Ph{}class zb{}function KD(t,i){return new C0(t,i??null,[])}class C0 extends Ph{constructor(i,s,d){super(),this._parent=s,this._bootstrapComponents=[],this.destroyCbs=[],this.componentFactoryResolver=new Bf(this);const g=Ao(i);this._bootstrapComponents=Ra(g.bootstrap),this._r3Injector=sc(i,s,[{provide:Ph,useValue:this},{provide:fh,useValue:this.componentFactoryResolver},...d],Ei(i),new Set(["environment"])),this._r3Injector.resolveInjectorInitializers(),this.instance=this._r3Injector.get(i)}get injector(){return this._r3Injector}destroy(){const i=this._r3Injector;!i.destroyed&&i.destroy(),this.destroyCbs.forEach(s=>s()),this.destroyCbs=null}onDestroy(i){this.destroyCbs.push(i)}}class E0 extends zb{constructor(i){super(),this.moduleType=i}create(i){return new C0(this.moduleType,i,[])}}class Ub extends Ph{constructor(i){super(),this.componentFactoryResolver=new Bf(this),this.instance=null;const s=new Ka([...i.providers,{provide:Ph,useValue:this},{provide:fh,useValue:this.componentFactoryResolver}],i.parent||Hu(),i.debugName,new Set(["environment"]));this.injector=s,i.runEnvironmentInitializers&&s.resolveInjectorInitializers()}destroy(){this.injector.destroy()}onDestroy(i){this.injector.onDestroy(i)}}function jb(t,i,s=null){return new Ub({providers:t,parent:i,debugName:s,runEnvironmentInitializers:!0}).injector}let QD=(()=>{class t{constructor(s){this._injector=s,this.cachedInjectors=new Map}getOrCreateStandaloneInjector(s){if(!s.standalone)return null;if(!this.cachedInjectors.has(s)){const d=jh(0,s.type),g=d.length>0?jb([d],this._injector,`Standalone[${s.type.name}]`):null;this.cachedInjectors.set(s,g)}return this.cachedInjectors.get(s)}ngOnDestroy(){try{for(const s of this.cachedInjectors.values())null!==s&&s.destroy()}finally{this.cachedInjectors.clear()}}static#e=this.\u0275prov=qi({token:t,providedIn:"environment",factory:()=>new t(Dr(as))})}return t})();function Vb(t){Cr("NgStandalone"),t.getStandaloneInjector=i=>i.get(QD).getOrCreateStandaloneInjector(t)}function Kb(t,i,s){const d=ns()+t,g=Sn();return g[d]===sr?jc(g,d,s?i.call(s):i()):function Um(t,i){return t[i]}(g,d)}function Km(t,i){const s=t[i];return s===sr?void 0:s}function iw(t,i){const s=gr();let d;const g=t+Gi;s.firstCreatePass?(d=function vI(t,i){if(i)for(let s=i.length-1;s>=0;s--){const d=i[s];if(t===d.name)return d}}(i,s.pipeRegistry),s.data[g]=d,d.onDestroy&&(s.destroyHooks??=[]).push(g,d.onDestroy)):d=s.data[g];const b=d.factory||(d.factory=ao(d.type)),A=Be(yu);try{const k=jo(!1),q=b();return jo(k),function kD(t,i,s,d){s>=t.data.length&&(t.data[s]=null,t.blueprint[s]=null),i[s]=d}(s,Sn(),g,q),q}finally{Be(A)}}function rw(t,i,s){const d=t+Gi,g=Sn(),b=Wa(g,d);return Xm(g,d)?function Xb(t,i,s,d,g,b){const T=i+s;return gs(t,T,g)?jc(t,T+1,b?d.call(b,g):d(g)):Km(t,T+1)}(g,ns(),i,b.transform,s,b):b.transform(s)}function ow(t,i,s,d){const g=t+Gi,b=Sn(),T=Wa(b,g);return Xm(b,g)?function Qb(t,i,s,d,g,b,T){const A=i+s;return Ih(t,A,g,b)?jc(t,A+2,T?d.call(T,g,b):d(g,b)):Km(t,A+2)}(b,ns(),i,T.transform,s,d,T):T.transform(s,d)}function Xm(t,i){return t[Ln].data[i].pure}class bw{constructor(i){this.full=i;const s=i.split(".");this.major=s[0],this.minor=s[1],this.patch=s.slice(2).join(".")}}let ww=(()=>{class t{log(s){console.log(s)}warn(s){console.warn(s)}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();class GI{constructor(i,s){this.ngModuleFactory=i,this.componentFactories=s}}let HI=(()=>{class t{compileModuleSync(s){return new E0(s)}compileModuleAsync(s){return Promise.resolve(this.compileModuleSync(s))}compileModuleAndAllComponentsSync(s){const d=this.compileModuleSync(s),b=Ra(Ao(s).declarations).reduce((T,A)=>{const k=nr(A);return k&&T.push(new ms(k)),T},[]);return new GI(d,b)}compileModuleAndAllComponentsAsync(s){return Promise.resolve(this.compileModuleAndAllComponentsSync(s))}clearCache(){}clearCacheFor(s){}getModuleId(s){}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),Q_=(()=>{class t{constructor(){this.taskId=0,this.pendingTasks=new Set,this.hasPendingTasks=new pe.X(!1)}get _hasPendingTasks(){return this.hasPendingTasks.value}add(){this._hasPendingTasks||this.hasPendingTasks.next(!0);const s=this.taskId++;return this.pendingTasks.add(s),s}remove(s){this.pendingTasks.delete(s),0===this.pendingTasks.size&&this._hasPendingTasks&&this.hasPendingTasks.next(!1)}ngOnDestroy(){this.pendingTasks.clear(),this._hasPendingTasks&&this.hasPendingTasks.next(!1)}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const Iw=new V(""),Mw=new V("");let P0,vM=(()=>{class t{constructor(s,d,g){this._ngZone=s,this.registry=d,this._pendingCount=0,this._isZoneStable=!0,this._callbacks=[],this.taskTrackingZone=null,P0||(function xM(t){P0=t}(g),g.addToWindow(d)),this._watchAngularEvents(),s.run(()=>{this.taskTrackingZone=typeof Zone>"u"?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{ar.assertNotInAngularZone(),queueMicrotask(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())queueMicrotask(()=>{for(;0!==this._callbacks.length;){let s=this._callbacks.pop();clearTimeout(s.timeoutId),s.doneCb()}});else{let s=this.getPendingTasks();this._callbacks=this._callbacks.filter(d=>!d.updateCb||!d.updateCb(s)||(clearTimeout(d.timeoutId),!1))}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(s=>({source:s.source,creationLocation:s.creationLocation,data:s.data})):[]}addCallback(s,d,g){let b=-1;d&&d>0&&(b=setTimeout(()=>{this._callbacks=this._callbacks.filter(T=>T.timeoutId!==b),s()},d)),this._callbacks.push({doneCb:s,timeoutId:b,updateCb:g})}whenStable(s,d,g){if(g&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(s,d,g),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}registerApplication(s){this.registry.registerApplication(s,this)}unregisterApplication(s){this.registry.unregisterApplication(s)}findProviders(s,d,g){return[]}static#e=this.\u0275fac=function(d){return new(d||t)(Dr(ar),Dr(Aw),Dr(Mw))};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac})}return t})(),Aw=(()=>{class t{constructor(){this._applications=new Map}registerApplication(s,d){this._applications.set(s,d)}unregisterApplication(s){this._applications.delete(s)}unregisterAllApplications(){this._applications.clear()}getTestability(s){return this._applications.get(s)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(s,d=!0){return P0?.findTestabilityInTree(this,s,d)??null}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})();const Sw=new V("Application Initializer");let O0=(()=>{class t{constructor(){this.initialized=!1,this.done=!1,this.donePromise=new Promise((s,d)=>{this.resolve=s,this.reject=d}),this.appInits=ji(Sw,{optional:!0})??[]}runInitializers(){if(this.initialized)return;const s=[];for(const g of this.appInits){const b=g();if(o0(b))s.push(b);else if(Y1(b)){const T=new Promise((A,k)=>{b.subscribe({complete:A,error:k})});s.push(T)}}const d=()=>{this.done=!0,this.resolve()};Promise.all(s).then(()=>{d()}).catch(g=>{this.reject(g)}),0===s.length&&d(),this.initialized=!0}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const R0=new V("appBootstrapListener");function Rw(t,i){return Array.isArray(i)?i.reduce(Rw,t):{...t,...i}}let Oh=(()=>{class t{constructor(){this._bootstrapListeners=[],this._runningTick=!1,this._destroyed=!1,this._destroyListeners=[],this._views=[],this.internalErrorHandler=ji(o_),this.afterRenderEffectManager=ji(Cu),this.componentTypes=[],this.components=[],this.isStable=ji(Q_).hasPendingTasks.pipe((0,lt.U)(s=>!s)),this._injector=ji(as)}get destroyed(){return this._destroyed}get injector(){return this._injector}bootstrap(s,d){const g=s instanceof Jg;if(!this._injector.get(O0).done)throw!g&&Qo(s),new Yt(405,!1);let T;T=g?s:this._injector.get(fh).resolveComponentFactory(s),this.componentTypes.push(T.componentType);const A=function wM(t){return t.isBoundToModule}(T)?void 0:this._injector.get(Ph),q=T.create(pr.NULL,[],d||T.selector,A),ge=q.location.nativeElement,Je=q.injector.get(Iw,null);return Je?.registerApplication(ge),q.onDestroy(()=>{this.detachView(q.hostView),ty(this.components,q),Je?.unregisterApplication(ge)}),this._loadComponent(q),q}tick(){if(this._runningTick)throw new Yt(101,!1);try{this._runningTick=!0;for(let s of this._views)s.detectChanges()}catch(s){this.internalErrorHandler(s)}finally{try{this.afterRenderEffectManager.execute()}catch(s){this.internalErrorHandler(s)}this._runningTick=!1}}attachView(s){const d=s;this._views.push(d),d.attachToAppRef(this)}detachView(s){const d=s;ty(this._views,d),d.detachFromAppRef()}_loadComponent(s){this.attachView(s.hostView),this.tick(),this.components.push(s);const d=this._injector.get(R0,[]);[...this._bootstrapListeners,...d].forEach(g=>g(s))}ngOnDestroy(){if(!this._destroyed)try{this._destroyListeners.forEach(s=>s()),this._views.slice().forEach(s=>s.destroy())}finally{this._destroyed=!0,this._views=[],this._bootstrapListeners=[],this._destroyListeners=[]}}onDestroy(s){return this._destroyListeners.push(s),()=>ty(this._destroyListeners,s)}destroy(){if(this._destroyed)throw new Yt(406,!1);const s=this._injector;s.destroy&&!s.destroyed&&s.destroy()}get viewCount(){return this._views.length}warnIfDestroyed(){}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function ty(t,i){const s=t.indexOf(i);s>-1&&t.splice(s,1)}let EM=(()=>{class t{constructor(){this.zone=ji(ar),this.applicationRef=ji(Oh)}initialize(){this._onMicrotaskEmptySubscription||(this._onMicrotaskEmptySubscription=this.zone.onMicrotaskEmpty.subscribe({next:()=>{this.zone.run(()=>{this.applicationRef.tick()})}}))}ngOnDestroy(){this._onMicrotaskEmptySubscription?.unsubscribe()}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function TM(){const t=ji(ar),i=ji(Nl);return s=>t.runOutsideAngular(()=>i.handleError(s))}let IM=(()=>{class t{constructor(){this.subscription=new It.w0,this.initialized=!1,this.zone=ji(ar),this.pendingTasks=ji(Q_)}initialize(){if(this.initialized)return;this.initialized=!0;let s=null;!this.zone.isStable&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(s=this.pendingTasks.add()),this.zone.runOutsideAngular(()=>{this.subscription.add(this.zone.onStable.subscribe(()=>{ar.assertNotInAngularZone(),queueMicrotask(()=>{null!==s&&!this.zone.hasPendingMacrotasks&&!this.zone.hasPendingMicrotasks&&(this.pendingTasks.remove(s),s=null)})}))}),this.subscription.add(this.zone.onUnstable.subscribe(()=>{ar.assertInAngularZone(),s??=this.pendingTasks.add()}))}ngOnDestroy(){this.subscription.unsubscribe()}static#e=this.\u0275fac=function(d){return new(d||t)};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();const iy=new V("LocaleId",{providedIn:"root",factory:()=>ji(iy,_i.Optional|_i.SkipSelf)||function MM(){return typeof $localize<"u"&&$localize.locale||sp}()}),AM=new V("DefaultCurrencyCode",{providedIn:"root",factory:()=>"USD"}),L0=new V("PlatformDestroyListeners");let Nw=(()=>{class t{constructor(s){this._injector=s,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(s,d){const g=function xl(t="zone.js",i){return"noop"===t?new ks:"zone.js"===t?new ar(i):t}(d?.ngZone,function Fw(t){return{enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:t?.eventCoalescing??!1,shouldCoalesceRunChangeDetection:t?.runCoalescing??!1}}({eventCoalescing:d?.ngZoneEventCoalescing,runCoalescing:d?.ngZoneRunCoalescing}));return g.run(()=>{const b=function XD(t,i,s){return new C0(t,i,s)}(s.moduleType,this.injector,function kw(t){return[{provide:ar,useFactory:t},{provide:nu,multi:!0,useFactory:()=>{const i=ji(EM,{optional:!0});return()=>i.initialize()}},{provide:nu,multi:!0,useFactory:()=>{const i=ji(IM);return()=>{i.initialize()}}},{provide:o_,useFactory:TM}]}(()=>g)),T=b.injector.get(Nl,null);return g.runOutsideAngular(()=>{const A=g.onError.subscribe({next:k=>{T.handleError(k)}});b.onDestroy(()=>{ty(this._modules,b),A.unsubscribe()})}),function Ow(t,i,s){try{const d=s();return o0(d)?d.catch(g=>{throw i.runOutsideAngular(()=>t.handleError(g)),g}):d}catch(d){throw i.runOutsideAngular(()=>t.handleError(d)),d}}(T,g,()=>{const A=b.injector.get(O0);return A.runInitializers(),A.donePromise.then(()=>(function T1(t){hr(t,"Expected localeId to be defined"),"string"==typeof t&&(E1=t.toLowerCase().replace(/_/g,"-"))}(b.injector.get(iy,sp)||sp),this._moduleDoBootstrap(b),b))})})}bootstrapModule(s,d=[]){const g=Rw({},d);return function bM(t,i,s){const d=new E0(s);return Promise.resolve(d)}(0,0,s).then(b=>this.bootstrapModuleFactory(b,g))}_moduleDoBootstrap(s){const d=s.injector.get(Oh);if(s._bootstrapComponents.length>0)s._bootstrapComponents.forEach(g=>d.bootstrap(g));else{if(!s.instance.ngDoBootstrap)throw new Yt(-403,!1);s.instance.ngDoBootstrap(d)}this._modules.push(s)}onDestroy(s){this._destroyListeners.push(s)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Yt(404,!1);this._modules.slice().forEach(d=>d.destroy()),this._destroyListeners.forEach(d=>d());const s=this._injector.get(L0,null);s&&(s.forEach(d=>d()),s.clear()),this._destroyed=!0}get destroyed(){return this._destroyed}static#e=this.\u0275fac=function(d){return new(d||t)(Dr(pr))};static#t=this.\u0275prov=qi({token:t,factory:t.\u0275fac,providedIn:"platform"})}return t})(),Td=null;const Bw=new V("AllowMultipleToken");function zw(t,i,s=[]){const d=`Platform: ${i}`,g=new V(d);return(b=[])=>{let T=k0();if(!T||T.injector.get(Bw,!1)){const A=[...s,...b,{provide:g,useValue:!0}];t?t(A):function PM(t){if(Td&&!Td.get(Bw,!1))throw new Yt(400,!1);(function Pw(){!function _n(t){Ht=t}(()=>{throw new Yt(600,!1)})})(),Td=t;const i=t.get(Nw);(function jw(t){t.get(qh,null)?.forEach(s=>s())})(t)}(function Uw(t=[],i){return pr.create({name:i,providers:[{provide:vp,useValue:"platform"},{provide:L0,useValue:new Set([()=>Td=null])},...t]})}(A,d))}return function OM(t){const i=k0();if(!i)throw new Yt(401,!1);return i}()}}function k0(){return Td?.get(Nw)??null}function LM(){}const zM=zw(null,"core",[]);let UM=(()=>{class t{constructor(s){}static#e=this.\u0275fac=function(d){return new(d||t)(Dr(Oh))};static#t=this.\u0275mod=fa({type:t});static#n=this.\u0275inj=Tt({})}return t})();function fA(t){return"boolean"==typeof t?t:null!=t&&"false"!==t}function mA(t,i){const s=nr(t),d=i.elementInjector||Hu();return new ms(s).create(d,i.projectableNodes,i.hostElement,i.environmentInjector)}function gA(t){const i=nr(t);if(!i)return null;const s=new ms(i);return{get selector(){return s.selector},get type(){return s.componentType},get inputs(){return s.inputs},get outputs(){return s.outputs},get ngContentSelectors(){return s.ngContentSelectors},get isStandalone(){return i.standalone},get isSignal(){return i.signals}}}},6223:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Cf:()=>Ce,Fd:()=>Ko,Fj:()=>Me,JJ:()=>Yt,JU:()=>ie,On:()=>tn,a5:()=>pe,qQ:()=>la,u5:()=>Qo,wV:()=>$n});var h=P(9212),m=P(6814),te=P(7715),l=P(9315),B=P(7398);let Y=(()=>{class re{constructor(G,Ge){this._renderer=G,this._elementRef=Ge,this.onChange=zt=>{},this.onTouched=()=>{}}setProperty(G,Ge){this._renderer.setProperty(this._elementRef.nativeElement,G,Ge)}registerOnTouched(G){this.onTouched=G}registerOnChange(G){this.onChange=G}setDisabledState(G){this.setProperty("disabled",G)}static#e=this.\u0275fac=function(Ge){return new(Ge||re)(h.Y36(h.Qsj),h.Y36(h.SBq))};static#t=this.\u0275dir=h.lG2({type:re})}return re})(),C=(()=>{class re extends Y{static#e=this.\u0275fac=(()=>{let G;return function(zt){return(G||(G=h.n5z(re)))(zt||re)}})();static#t=this.\u0275dir=h.lG2({type:re,features:[h.qOj]})}return re})();const ie=new h.OlP("NgValueAccessor"),K={provide:ie,useExisting:(0,h.Gpc)(()=>Me),multi:!0},Te=new h.OlP("CompositionEventMode");let Me=(()=>{class re extends Y{constructor(G,Ge,zt){super(G,Ge),this._compositionMode=zt,this._composing=!1,null==this._compositionMode&&(this._compositionMode=!function be(){const re=(0,m.q)()?(0,m.q)().getUserAgent():"";return/android (\d+)/.test(re.toLowerCase())}())}writeValue(G){this.setProperty("value",G??"")}_handleInput(G){(!this._compositionMode||this._compositionMode&&!this._composing)&&this.onChange(G)}_compositionStart(){this._composing=!0}_compositionEnd(G){this._composing=!1,this._compositionMode&&this.onChange(G)}static#e=this.\u0275fac=function(Ge){return new(Ge||re)(h.Y36(h.Qsj),h.Y36(h.SBq),h.Y36(Te,8))};static#t=this.\u0275dir=h.lG2({type:re,selectors:[["input","formControlName","",3,"type","checkbox"],["textarea","formControlName",""],["input","formControl","",3,"type","checkbox"],["textarea","formControl",""],["input","ngModel","",3,"type","checkbox"],["textarea","ngModel",""],["","ngDefaultControl",""]],hostBindings:function(Ge,zt){1&Ge&&h.NdJ("input",function(Ln){return zt._handleInput(Ln.target.value)})("blur",function(){return zt.onTouched()})("compositionstart",function(){return zt._compositionStart()})("compositionend",function(Ln){return zt._compositionEnd(Ln.target.value)})},features:[h._Bn([K]),h.qOj]})}return re})();function de(re){return null==re||("string"==typeof re||Array.isArray(re))&&0===re.length}const Ce=new h.OlP("NgValidators"),oe=new h.OlP("NgAsyncValidators");function De(re){return null}function ze(re){return null!=re}function Ke(re){return(0,h.QGY)(re)?(0,te.D)(re):re}function Ht(re){let ce={};return re.forEach(G=>{ce=null!=G?{...ce,...G}:ce}),0===Object.keys(ce).length?null:ce}function dn(re,ce){return ce.map(G=>G(re))}function Ut(re){return re.map(ce=>function _n(re){return!re.validate}(ce)?ce:G=>ce.validate(G))}function Ne(re){return null!=re?function We(re){if(!re)return null;const ce=re.filter(ze);return 0==ce.length?null:function(G){return Ht(dn(G,ce))}}(Ut(re)):null}function it(re){return null!=re?function ke(re){if(!re)return null;const ce=re.filter(ze);return 0==ce.length?null:function(G){const Ge=dn(G,ce).map(Ke);return(0,l.D)(Ge).pipe((0,B.U)(Ht))}}(Ut(re)):null}function Qt(re,ce){return null===re?[ce]:Array.isArray(re)?[...re,ce]:[re,ce]}function tt(re){return re?Array.isArray(re)?re:[re]:[]}function pt(re,ce){return Array.isArray(re)?re.includes(ce):re===ce}function Xt(re,ce){const G=tt(ce);return tt(re).forEach(zt=>{pt(G,zt)||G.push(zt)}),G}function bn(re,ce){return tt(ce).filter(G=>!pt(re,G))}class Cn{constructor(){this._rawValidators=[],this._rawAsyncValidators=[],this._onDestroyCallbacks=[]}get value(){return this.control?this.control.value:null}get valid(){return this.control?this.control.valid:null}get invalid(){return this.control?this.control.invalid:null}get pending(){return this.control?this.control.pending:null}get disabled(){return this.control?this.control.disabled:null}get enabled(){return this.control?this.control.enabled:null}get errors(){return this.control?this.control.errors:null}get pristine(){return this.control?this.control.pristine:null}get dirty(){return this.control?this.control.dirty:null}get touched(){return this.control?this.control.touched:null}get status(){return this.control?this.control.status:null}get untouched(){return this.control?this.control.untouched:null}get statusChanges(){return this.control?this.control.statusChanges:null}get valueChanges(){return this.control?this.control.valueChanges:null}get path(){return null}_setValidators(ce){this._rawValidators=ce||[],this._composedValidatorFn=Ne(this._rawValidators)}_setAsyncValidators(ce){this._rawAsyncValidators=ce||[],this._composedAsyncValidatorFn=it(this._rawAsyncValidators)}get validator(){return this._composedValidatorFn||null}get asyncValidator(){return this._composedAsyncValidatorFn||null}_registerOnDestroy(ce){this._onDestroyCallbacks.push(ce)}_invokeOnDestroyCallbacks(){this._onDestroyCallbacks.forEach(ce=>ce()),this._onDestroyCallbacks=[]}reset(ce=void 0){this.control&&this.control.reset(ce)}hasError(ce,G){return!!this.control&&this.control.hasError(ce,G)}getError(ce,G){return this.control?this.control.getError(ce,G):null}}class It extends Cn{get formDirective(){return null}get path(){return null}}class pe extends Cn{constructor(){super(...arguments),this._parent=null,this.name=null,this.valueAccessor=null}}class lt{constructor(ce){this._cd=ce}get isTouched(){return!!this._cd?.control?.touched}get isUntouched(){return!!this._cd?.control?.untouched}get isPristine(){return!!this._cd?.control?.pristine}get isDirty(){return!!this._cd?.control?.dirty}get isValid(){return!!this._cd?.control?.valid}get isInvalid(){return!!this._cd?.control?.invalid}get isPending(){return!!this._cd?.control?.pending}get isSubmitted(){return!!this._cd?.submitted}}let Yt=(()=>{class re extends lt{constructor(G){super(G)}static#e=this.\u0275fac=function(Ge){return new(Ge||re)(h.Y36(pe,2))};static#t=this.\u0275dir=h.lG2({type:re,selectors:[["","formControlName",""],["","ngModel",""],["","formControl",""]],hostVars:14,hostBindings:function(Ge,zt){2&Ge&&h.ekj("ng-untouched",zt.isUntouched)("ng-touched",zt.isTouched)("ng-pristine",zt.isPristine)("ng-dirty",zt.isDirty)("ng-valid",zt.isValid)("ng-invalid",zt.isInvalid)("ng-pending",zt.isPending)},features:[h.qOj]})}return re})();const ut="VALID",he="INVALID",_e="PENDING",ot="DISABLED";function dt(re){return null!=re&&!Array.isArray(re)&&"object"==typeof re}class Gn{constructor(ce,G){this._pendingDirty=!1,this._hasOwnPendingAsyncValidator=!1,this._pendingTouched=!1,this._onCollectionChange=()=>{},this._parent=null,this.pristine=!0,this.touched=!1,this._onDisabledChange=[],this._assignValidators(ce),this._assignAsyncValidators(G)}get validator(){return this._composedValidatorFn}set validator(ce){this._rawValidators=this._composedValidatorFn=ce}get asyncValidator(){return this._composedAsyncValidatorFn}set asyncValidator(ce){this._rawAsyncValidators=this._composedAsyncValidatorFn=ce}get parent(){return this._parent}get valid(){return this.status===ut}get invalid(){return this.status===he}get pending(){return this.status==_e}get disabled(){return this.status===ot}get enabled(){return this.status!==ot}get dirty(){return!this.pristine}get untouched(){return!this.touched}get updateOn(){return this._updateOn?this._updateOn:this.parent?this.parent.updateOn:"change"}setValidators(ce){this._assignValidators(ce)}setAsyncValidators(ce){this._assignAsyncValidators(ce)}addValidators(ce){this.setValidators(Xt(ce,this._rawValidators))}addAsyncValidators(ce){this.setAsyncValidators(Xt(ce,this._rawAsyncValidators))}removeValidators(ce){this.setValidators(bn(ce,this._rawValidators))}removeAsyncValidators(ce){this.setAsyncValidators(bn(ce,this._rawAsyncValidators))}hasValidator(ce){return pt(this._rawValidators,ce)}hasAsyncValidator(ce){return pt(this._rawAsyncValidators,ce)}clearValidators(){this.validator=null}clearAsyncValidators(){this.asyncValidator=null}markAsTouched(ce={}){this.touched=!0,this._parent&&!ce.onlySelf&&this._parent.markAsTouched(ce)}markAllAsTouched(){this.markAsTouched({onlySelf:!0}),this._forEachChild(ce=>ce.markAllAsTouched())}markAsUntouched(ce={}){this.touched=!1,this._pendingTouched=!1,this._forEachChild(G=>{G.markAsUntouched({onlySelf:!0})}),this._parent&&!ce.onlySelf&&this._parent._updateTouched(ce)}markAsDirty(ce={}){this.pristine=!1,this._parent&&!ce.onlySelf&&this._parent.markAsDirty(ce)}markAsPristine(ce={}){this.pristine=!0,this._pendingDirty=!1,this._forEachChild(G=>{G.markAsPristine({onlySelf:!0})}),this._parent&&!ce.onlySelf&&this._parent._updatePristine(ce)}markAsPending(ce={}){this.status=_e,!1!==ce.emitEvent&&this.statusChanges.emit(this.status),this._parent&&!ce.onlySelf&&this._parent.markAsPending(ce)}disable(ce={}){const G=this._parentMarkedDirty(ce.onlySelf);this.status=ot,this.errors=null,this._forEachChild(Ge=>{Ge.disable({...ce,onlySelf:!0})}),this._updateValue(),!1!==ce.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._updateAncestors({...ce,skipPristineCheck:G}),this._onDisabledChange.forEach(Ge=>Ge(!0))}enable(ce={}){const G=this._parentMarkedDirty(ce.onlySelf);this.status=ut,this._forEachChild(Ge=>{Ge.enable({...ce,onlySelf:!0})}),this.updateValueAndValidity({onlySelf:!0,emitEvent:ce.emitEvent}),this._updateAncestors({...ce,skipPristineCheck:G}),this._onDisabledChange.forEach(Ge=>Ge(!1))}_updateAncestors(ce){this._parent&&!ce.onlySelf&&(this._parent.updateValueAndValidity(ce),ce.skipPristineCheck||this._parent._updatePristine(),this._parent._updateTouched())}setParent(ce){this._parent=ce}getRawValue(){return this.value}updateValueAndValidity(ce={}){this._setInitialStatus(),this._updateValue(),this.enabled&&(this._cancelExistingSubscription(),this.errors=this._runValidator(),this.status=this._calculateStatus(),(this.status===ut||this.status===_e)&&this._runAsyncValidator(ce.emitEvent)),!1!==ce.emitEvent&&(this.valueChanges.emit(this.value),this.statusChanges.emit(this.status)),this._parent&&!ce.onlySelf&&this._parent.updateValueAndValidity(ce)}_updateTreeValidity(ce={emitEvent:!0}){this._forEachChild(G=>G._updateTreeValidity(ce)),this.updateValueAndValidity({onlySelf:!0,emitEvent:ce.emitEvent})}_setInitialStatus(){this.status=this._allControlsDisabled()?ot:ut}_runValidator(){return this.validator?this.validator(this):null}_runAsyncValidator(ce){if(this.asyncValidator){this.status=_e,this._hasOwnPendingAsyncValidator=!0;const G=Ke(this.asyncValidator(this));this._asyncValidationSubscription=G.subscribe(Ge=>{this._hasOwnPendingAsyncValidator=!1,this.setErrors(Ge,{emitEvent:ce})})}}_cancelExistingSubscription(){this._asyncValidationSubscription&&(this._asyncValidationSubscription.unsubscribe(),this._hasOwnPendingAsyncValidator=!1)}setErrors(ce,G={}){this.errors=ce,this._updateControlsErrors(!1!==G.emitEvent)}get(ce){let G=ce;return null==G||(Array.isArray(G)||(G=G.split(".")),0===G.length)?null:G.reduce((Ge,zt)=>Ge&&Ge._find(zt),this)}getError(ce,G){const Ge=G?this.get(G):this;return Ge&&Ge.errors?Ge.errors[ce]:null}hasError(ce,G){return!!this.getError(ce,G)}get root(){let ce=this;for(;ce._parent;)ce=ce._parent;return ce}_updateControlsErrors(ce){this.status=this._calculateStatus(),ce&&this.statusChanges.emit(this.status),this._parent&&this._parent._updateControlsErrors(ce)}_initObservables(){this.valueChanges=new h.vpe,this.statusChanges=new h.vpe}_calculateStatus(){return this._allControlsDisabled()?ot:this.errors?he:this._hasOwnPendingAsyncValidator||this._anyControlsHaveStatus(_e)?_e:this._anyControlsHaveStatus(he)?he:ut}_anyControlsHaveStatus(ce){return this._anyControls(G=>G.status===ce)}_anyControlsDirty(){return this._anyControls(ce=>ce.dirty)}_anyControlsTouched(){return this._anyControls(ce=>ce.touched)}_updatePristine(ce={}){this.pristine=!this._anyControlsDirty(),this._parent&&!ce.onlySelf&&this._parent._updatePristine(ce)}_updateTouched(ce={}){this.touched=this._anyControlsTouched(),this._parent&&!ce.onlySelf&&this._parent._updateTouched(ce)}_registerOnCollectionChange(ce){this._onCollectionChange=ce}_setUpdateStrategy(ce){dt(ce)&&null!=ce.updateOn&&(this._updateOn=ce.updateOn)}_parentMarkedDirty(ce){return!ce&&!(!this._parent||!this._parent.dirty)&&!this._parent._anyControlsDirty()}_find(ce){return null}_assignValidators(ce){this._rawValidators=Array.isArray(ce)?ce.slice():ce,this._composedValidatorFn=function Dt(re){return Array.isArray(re)?Ne(re):re||null}(this._rawValidators)}_assignAsyncValidators(ce){this._rawAsyncValidators=Array.isArray(ce)?ce.slice():ce,this._composedAsyncValidatorFn=function Vt(re){return Array.isArray(re)?it(re):re||null}(this._rawAsyncValidators)}}const In=new h.OlP("CallSetDisabledState",{providedIn:"root",factory:()=>bi}),bi="always";function Ri(re,ce,G=bi){(function uo(re,ce){const G=function mt(re){return re._rawValidators}(re);null!==ce.validator?re.setValidators(Qt(G,ce.validator)):"function"==typeof G&&re.setValidators([G]);const Ge=function an(re){return re._rawAsyncValidators}(re);null!==ce.asyncValidator?re.setAsyncValidators(Qt(Ge,ce.asyncValidator)):"function"==typeof Ge&&re.setAsyncValidators([Ge]);const zt=()=>re.updateValueAndValidity();Xi(ce._rawValidators,zt),Xi(ce._rawAsyncValidators,zt)})(re,ce),ce.valueAccessor.writeValue(re.value),(re.disabled||"always"===G)&&ce.valueAccessor.setDisabledState?.(re.disabled),function Eo(re,ce){ce.valueAccessor.registerOnChange(G=>{re._pendingValue=G,re._pendingChange=!0,re._pendingDirty=!0,"change"===re.updateOn&&hr(re,ce)})}(re,ce),function Ti(re,ce){const G=(Ge,zt)=>{ce.valueAccessor.writeValue(Ge),zt&&ce.viewToModelUpdate(Ge)};re.registerOnChange(G),ce._registerOnDestroy(()=>{re._unregisterOnChange(G)})}(re,ce),function zi(re,ce){ce.valueAccessor.registerOnTouched(()=>{re._pendingTouched=!0,"blur"===re.updateOn&&re._pendingChange&&hr(re,ce),"submit"!==re.updateOn&&re.markAsTouched()})}(re,ce),function Ar(re,ce){if(ce.valueAccessor.setDisabledState){const G=Ge=>{ce.valueAccessor.setDisabledState(Ge)};re.registerOnDisabledChange(G),ce._registerOnDestroy(()=>{re._unregisterOnDisabledChange(G)})}}(re,ce)}function Xi(re,ce){re.forEach(G=>{G.registerOnValidatorChange&&G.registerOnValidatorChange(ce)})}function hr(re,ce){re._pendingDirty&&re.markAsDirty(),re.setValue(re._pendingValue,{emitModelToViewChange:!1}),ce.viewToModelUpdate(re._pendingValue),re._pendingChange=!1}function _i(re,ce){const G=re.indexOf(ce);G>-1&&re.splice(G,1)}function or(re){return"object"==typeof re&&null!==re&&2===Object.keys(re).length&&"value"in re&&"disabled"in re}Promise.resolve();const Ee=class extends Gn{constructor(ce=null,G,Ge){super(function yt(re){return(dt(re)?re.validators:re)||null}(G),function jt(re,ce){return(dt(ce)?ce.asyncValidators:re)||null}(Ge,G)),this.defaultValue=null,this._onChange=[],this._pendingChange=!1,this._applyFormState(ce),this._setUpdateStrategy(G),this._initObservables(),this.updateValueAndValidity({onlySelf:!0,emitEvent:!!this.asyncValidator}),dt(G)&&(G.nonNullable||G.initialValueIsDefault)&&(this.defaultValue=or(ce)?ce.value:ce)}setValue(ce,G={}){this.value=this._pendingValue=ce,this._onChange.length&&!1!==G.emitModelToViewChange&&this._onChange.forEach(Ge=>Ge(this.value,!1!==G.emitViewToModelChange)),this.updateValueAndValidity(G)}patchValue(ce,G={}){this.setValue(ce,G)}reset(ce=this.defaultValue,G={}){this._applyFormState(ce),this.markAsPristine(G),this.markAsUntouched(G),this.setValue(this.value,G),this._pendingChange=!1}_updateValue(){}_anyControls(ce){return!1}_allControlsDisabled(){return this.disabled}registerOnChange(ce){this._onChange.push(ce)}_unregisterOnChange(ce){_i(this._onChange,ce)}registerOnDisabledChange(ce){this._onDisabledChange.push(ce)}_unregisterOnDisabledChange(ce){_i(this._onDisabledChange,ce)}_forEachChild(ce){}_syncPendingControls(){return!("submit"!==this.updateOn||(this._pendingDirty&&this.markAsDirty(),this._pendingTouched&&this.markAsTouched(),!this._pendingChange)||(this.setValue(this._pendingValue,{onlySelf:!0,emitModelToViewChange:!1}),0))}_applyFormState(ce){or(ce)?(this.value=this._pendingValue=ce.value,ce.disabled?this.disable({onlySelf:!0,emitEvent:!1}):this.enable({onlySelf:!0,emitEvent:!1})):this.value=this._pendingValue=ce}},_t={provide:pe,useExisting:(0,h.Gpc)(()=>tn)},Wt=Promise.resolve();let tn=(()=>{class re extends pe{constructor(G,Ge,zt,ni,Ln,Di){super(),this._changeDetectorRef=Ln,this.callSetDisabledState=Di,this.control=new Ee,this._registered=!1,this.name="",this.update=new h.vpe,this._parent=G,this._setValidators(Ge),this._setAsyncValidators(zt),this.valueAccessor=function Hn(re,ce){if(!ce)return null;let G,Ge,zt;return Array.isArray(ce),ce.forEach(ni=>{ni.constructor===Me?G=ni:function ln(re){return Object.getPrototypeOf(re.constructor)===C}(ni)?Ge=ni:zt=ni}),zt||Ge||G||null}(0,ni)}ngOnChanges(G){if(this._checkForErrors(),!this._registered||"name"in G){if(this._registered&&(this._checkName(),this.formDirective)){const Ge=G.name.previousValue;this.formDirective.removeControl({name:Ge,path:this._getPath(Ge)})}this._setUpControl()}"isDisabled"in G&&this._updateDisabled(G),function Et(re,ce){if(!re.hasOwnProperty("model"))return!1;const G=re.model;return!!G.isFirstChange()||!Object.is(ce,G.currentValue)}(G,this.viewModel)&&(this._updateValue(this.model),this.viewModel=this.model)}ngOnDestroy(){this.formDirective&&this.formDirective.removeControl(this)}get path(){return this._getPath(this.name)}get formDirective(){return this._parent?this._parent.formDirective:null}viewToModelUpdate(G){this.viewModel=G,this.update.emit(G)}_setUpControl(){this._setUpdateStrategy(),this._isStandalone()?this._setUpStandalone():this.formDirective.addControl(this),this._registered=!0}_setUpdateStrategy(){this.options&&null!=this.options.updateOn&&(this.control._updateOn=this.options.updateOn)}_isStandalone(){return!this._parent||!(!this.options||!this.options.standalone)}_setUpStandalone(){Ri(this.control,this,this.callSetDisabledState),this.control.updateValueAndValidity({emitEvent:!1})}_checkForErrors(){this._isStandalone()||this._checkParentType(),this._checkName()}_checkParentType(){}_checkName(){this.options&&this.options.name&&(this.name=this.options.name),this._isStandalone()}_updateValue(G){Wt.then(()=>{this.control.setValue(G,{emitViewToModelChange:!1}),this._changeDetectorRef?.markForCheck()})}_updateDisabled(G){const Ge=G.isDisabled.currentValue,zt=0!==Ge&&(0,h.VuI)(Ge);Wt.then(()=>{zt&&!this.control.disabled?this.control.disable():!zt&&this.control.disabled&&this.control.enable(),this._changeDetectorRef?.markForCheck()})}_getPath(G){return this._parent?function wi(re,ce){return[...ce.path,re]}(G,this._parent):[G]}static#e=this.\u0275fac=function(Ge){return new(Ge||re)(h.Y36(It,9),h.Y36(Ce,10),h.Y36(oe,10),h.Y36(ie,10),h.Y36(h.sBO,8),h.Y36(In,8))};static#t=this.\u0275dir=h.lG2({type:re,selectors:[["","ngModel","",3,"formControlName","",3,"formControl",""]],inputs:{name:"name",isDisabled:[h.lbL.None,"disabled","isDisabled"],model:[h.lbL.None,"ngModel","model"],options:[h.lbL.None,"ngModelOptions","options"]},outputs:{update:"ngModelChange"},exportAs:["ngModel"],features:[h._Bn([_t]),h.qOj,h.TTD]})}return re})();const Vn={provide:ie,useExisting:(0,h.Gpc)(()=>$n),multi:!0};let $n=(()=>{class re extends C{writeValue(G){this.setProperty("value",G??"")}registerOnChange(G){this.onChange=Ge=>{G(""==Ge?null:parseFloat(Ge))}}static#e=this.\u0275fac=(()=>{let G;return function(zt){return(G||(G=h.n5z(re)))(zt||re)}})();static#t=this.\u0275dir=h.lG2({type:re,selectors:[["input","type","number","formControlName",""],["input","type","number","formControl",""],["input","type","number","ngModel",""]],hostBindings:function(Ge,zt){1&Ge&&h.NdJ("input",function(Ln){return zt.onChange(Ln.target.value)})("blur",function(){return zt.onTouched()})},features:[h._Bn([Vn]),h.qOj]})}return re})(),fi=(()=>{class re{static#e=this.\u0275fac=function(Ge){return new(Ge||re)};static#t=this.\u0275mod=h.oAB({type:re});static#n=this.\u0275inj=h.cJS({})}return re})();function Po(re){return"number"==typeof re?re:parseFloat(re)}let Jo=(()=>{class re{constructor(){this._validator=De}ngOnChanges(G){if(this.inputName in G){const Ge=this.normalizeInput(G[this.inputName].currentValue);this._enabled=this.enabled(Ge),this._validator=this._enabled?this.createValidator(Ge):De,this._onChange&&this._onChange()}}validate(G){return this._validator(G)}registerOnValidatorChange(G){this._onChange=G}enabled(G){return null!=G}static#e=this.\u0275fac=function(Ge){return new(Ge||re)};static#t=this.\u0275dir=h.lG2({type:re,features:[h.TTD]})}return re})();const vs={provide:Ce,useExisting:(0,h.Gpc)(()=>Ko),multi:!0};let Ko=(()=>{class re extends Jo{constructor(){super(...arguments),this.inputName="max",this.normalizeInput=G=>Po(G),this.createValidator=G=>function ye(re){return ce=>{if(de(ce.value)||de(re))return null;const G=parseFloat(ce.value);return!isNaN(G)&&G>re?{max:{max:re,actual:ce.value}}:null}}(G)}static#e=this.\u0275fac=(()=>{let G;return function(zt){return(G||(G=h.n5z(re)))(zt||re)}})();static#t=this.\u0275dir=h.lG2({type:re,selectors:[["input","type","number","max","","formControlName",""],["input","type","number","max","","formControl",""],["input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function(Ge,zt){2&Ge&&h.uIk("max",zt._enabled?zt.max:null)},inputs:{max:"max"},features:[h._Bn([vs]),h.qOj]})}return re})();const rl={provide:Ce,useExisting:(0,h.Gpc)(()=>la),multi:!0};let la=(()=>{class re extends Jo{constructor(){super(...arguments),this.inputName="min",this.normalizeInput=G=>Po(G),this.createValidator=G=>function Ae(re){return ce=>{if(de(ce.value)||de(re))return null;const G=parseFloat(ce.value);return!isNaN(G)&&G<re?{min:{min:re,actual:ce.value}}:null}}(G)}static#e=this.\u0275fac=(()=>{let G;return function(zt){return(G||(G=h.n5z(re)))(zt||re)}})();static#t=this.\u0275dir=h.lG2({type:re,selectors:[["input","type","number","min","","formControlName",""],["input","type","number","min","","formControl",""],["input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function(Ge,zt){2&Ge&&h.uIk("min",zt._enabled?zt.min:null)},inputs:{min:"min"},features:[h._Bn([rl]),h.qOj]})}return re})(),Ea=(()=>{class re{static#e=this.\u0275fac=function(Ge){return new(Ge||re)};static#t=this.\u0275mod=h.oAB({type:re});static#n=this.\u0275inj=h.cJS({imports:[fi]})}return re})(),Qo=(()=>{class re{static withConfig(G){return{ngModule:re,providers:[{provide:In,useValue:G.callSetDisabledState??bi}]}}static#e=this.\u0275fac=function(Ge){return new(Ge||re)};static#t=this.\u0275mod=h.oAB({type:re});static#n=this.\u0275inj=h.cJS({imports:[Ea]})}return re})()},6593:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Dx:()=>Un,b2:()=>lt,q6:()=>bn});var h=P(9212),m=P(6814);class te extends m.w_{constructor(){super(...arguments),this.supportsDOMEvents=!0}}class l extends te{static makeCurrent(){(0,m.HT)(new l)}onAndCancel(ft,Z,Re){return ft.addEventListener(Z,Re),()=>{ft.removeEventListener(Z,Re)}}dispatchEvent(ft,Z){ft.dispatchEvent(Z)}remove(ft){ft.parentNode&&ft.parentNode.removeChild(ft)}createElement(ft,Z){return(Z=Z||this.getDefaultDocument()).createElement(ft)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(ft){return ft.nodeType===Node.ELEMENT_NODE}isShadowRoot(ft){return ft instanceof DocumentFragment}getGlobalEventTarget(ft,Z){return"window"===Z?window:"document"===Z?ft:"body"===Z?ft.body:null}getBaseHref(ft){const Z=function Y(){return B=B||document.querySelector("base"),B?B.getAttribute("href"):null}();return null==Z?null:function C(ae){return new URL(ae,document.baseURI).pathname}(Z)}resetBaseElement(){B=null}getUserAgent(){return window.navigator.userAgent}getCookie(ft){return(0,m.Mx)(document.cookie,ft)}}let B=null,fe=(()=>{class ae{build(){return new XMLHttpRequest}static#e=this.\u0275fac=function(Re){return new(Re||ae)};static#t=this.\u0275prov=h.Yz7({token:ae,factory:ae.\u0275fac})}return ae})();const Pe=new h.OlP("EventManagerPlugins");let K=(()=>{class ae{constructor(Z,Re){this._zone=Re,this._eventNameToPlugin=new Map,Z.forEach(st=>{st.manager=this}),this._plugins=Z.slice().reverse()}addEventListener(Z,Re,st){return this._findPluginFor(Re).addEventListener(Z,Re,st)}getZone(){return this._zone}_findPluginFor(Z){let Re=this._eventNameToPlugin.get(Z);if(Re)return Re;if(Re=this._plugins.find(on=>on.supports(Z)),!Re)throw new h.vHH(5101,!1);return this._eventNameToPlugin.set(Z,Re),Re}static#e=this.\u0275fac=function(Re){return new(Re||ae)(h.LFG(Pe),h.LFG(h.R0b))};static#t=this.\u0275prov=h.Yz7({token:ae,factory:ae.\u0275fac})}return ae})();class be{constructor(ft){this._doc=ft}}const Te="ng-app-id";let Me=(()=>{class ae{constructor(Z,Re,st,on={}){this.doc=Z,this.appId=Re,this.nonce=st,this.platformId=on,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=(0,m.PM)(on),this.resetHostNodes()}addStyles(Z){for(const Re of Z)1===this.changeUsageCount(Re,1)&&this.onStyleAdded(Re)}removeStyles(Z){for(const Re of Z)this.changeUsageCount(Re,-1)<=0&&this.onStyleRemoved(Re)}ngOnDestroy(){const Z=this.styleNodesInDOM;Z&&(Z.forEach(Re=>Re.remove()),Z.clear());for(const Re of this.getAllStyles())this.onStyleRemoved(Re);this.resetHostNodes()}addHost(Z){this.hostNodes.add(Z);for(const Re of this.getAllStyles())this.addStyleToHost(Z,Re)}removeHost(Z){this.hostNodes.delete(Z)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(Z){for(const Re of this.hostNodes)this.addStyleToHost(Re,Z)}onStyleRemoved(Z){const Re=this.styleRef;Re.get(Z)?.elements?.forEach(st=>st.remove()),Re.delete(Z)}collectServerRenderedStyles(){const Z=this.doc.head?.querySelectorAll(`style[${Te}="${this.appId}"]`);if(Z?.length){const Re=new Map;return Z.forEach(st=>{null!=st.textContent&&Re.set(st.textContent,st)}),Re}return null}changeUsageCount(Z,Re){const st=this.styleRef;if(st.has(Z)){const on=st.get(Z);return on.usage+=Re,on.usage}return st.set(Z,{usage:Re,elements:[]}),Re}getStyleElement(Z,Re){const st=this.styleNodesInDOM,on=st?.get(Re);if(on?.parentNode===Z)return st.delete(Re),on.removeAttribute(Te),on;{const In=this.doc.createElement("style");return this.nonce&&In.setAttribute("nonce",this.nonce),In.textContent=Re,this.platformIsServer&&In.setAttribute(Te,this.appId),Z.appendChild(In),In}}addStyleToHost(Z,Re){const st=this.getStyleElement(Z,Re),on=this.styleRef,In=on.get(Re)?.elements;In?In.push(st):on.set(Re,{elements:[st],usage:1})}resetHostNodes(){const Z=this.hostNodes;Z.clear(),Z.add(this.doc.head)}static#e=this.\u0275fac=function(Re){return new(Re||ae)(h.LFG(m.K0),h.LFG(h.AFp),h.LFG(h.Ojb,8),h.LFG(h.Lbi))};static#t=this.\u0275prov=h.Yz7({token:ae,factory:ae.\u0275fac})}return ae})();const de={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},nt=/%COMP%/g,Ae=new h.OlP("RemoveStylesOnCompDestroy",{providedIn:"root",factory:()=>!0});function ct(ae,ft){return ft.map(Z=>Z.replace(nt,ae))}let X=(()=>{class ae{constructor(Z,Re,st,on,In,bi,wi,Ri=null){this.eventManager=Z,this.sharedStylesHost=Re,this.appId=st,this.removeStylesOnCompDestroy=on,this.doc=In,this.platformId=bi,this.ngZone=wi,this.nonce=Ri,this.rendererByCompId=new Map,this.platformIsServer=(0,m.PM)(bi),this.defaultRenderer=new ve(Z,In,wi,this.platformIsServer)}createRenderer(Z,Re){if(!Z||!Re)return this.defaultRenderer;this.platformIsServer&&Re.encapsulation===h.ifc.ShadowDom&&(Re={...Re,encapsulation:h.ifc.Emulated});const st=this.getOrCreateRenderer(Z,Re);return st instanceof Ht?st.applyToHost(Z):st instanceof Ke&&st.applyStyles(),st}getOrCreateRenderer(Z,Re){const st=this.rendererByCompId;let on=st.get(Re.id);if(!on){const In=this.doc,bi=this.ngZone,wi=this.eventManager,Ri=this.sharedStylesHost,mr=this.removeStylesOnCompDestroy,Xi=this.platformIsServer;switch(Re.encapsulation){case h.ifc.Emulated:on=new Ht(wi,Ri,Re,this.appId,mr,In,bi,Xi);break;case h.ifc.ShadowDom:return new ze(wi,Ri,Z,Re,In,bi,this.nonce,Xi);default:on=new Ke(wi,Ri,Re,mr,In,bi,Xi)}st.set(Re.id,on)}return on}ngOnDestroy(){this.rendererByCompId.clear()}static#e=this.\u0275fac=function(Re){return new(Re||ae)(h.LFG(K),h.LFG(Me),h.LFG(h.AFp),h.LFG(Ae),h.LFG(m.K0),h.LFG(h.Lbi),h.LFG(h.R0b),h.LFG(h.Ojb))};static#t=this.\u0275prov=h.Yz7({token:ae,factory:ae.\u0275fac})}return ae})();class ve{constructor(ft,Z,Re,st){this.eventManager=ft,this.doc=Z,this.ngZone=Re,this.platformIsServer=st,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(ft,Z){return Z?this.doc.createElementNS(de[Z]||Z,ft):this.doc.createElement(ft)}createComment(ft){return this.doc.createComment(ft)}createText(ft){return this.doc.createTextNode(ft)}appendChild(ft,Z){(De(ft)?ft.content:ft).appendChild(Z)}insertBefore(ft,Z,Re){ft&&(De(ft)?ft.content:ft).insertBefore(Z,Re)}removeChild(ft,Z){ft&&ft.removeChild(Z)}selectRootElement(ft,Z){let Re="string"==typeof ft?this.doc.querySelector(ft):ft;if(!Re)throw new h.vHH(-5104,!1);return Z||(Re.textContent=""),Re}parentNode(ft){return ft.parentNode}nextSibling(ft){return ft.nextSibling}setAttribute(ft,Z,Re,st){if(st){Z=st+":"+Z;const on=de[st];on?ft.setAttributeNS(on,Z,Re):ft.setAttribute(Z,Re)}else ft.setAttribute(Z,Re)}removeAttribute(ft,Z,Re){if(Re){const st=de[Re];st?ft.removeAttributeNS(st,Z):ft.removeAttribute(`${Re}:${Z}`)}else ft.removeAttribute(Z)}addClass(ft,Z){ft.classList.add(Z)}removeClass(ft,Z){ft.classList.remove(Z)}setStyle(ft,Z,Re,st){st&(h.JOm.DashCase|h.JOm.Important)?ft.style.setProperty(Z,Re,st&h.JOm.Important?"important":""):ft.style[Z]=Re}removeStyle(ft,Z,Re){Re&h.JOm.DashCase?ft.style.removeProperty(Z):ft.style[Z]=""}setProperty(ft,Z,Re){null!=ft&&(ft[Z]=Re)}setValue(ft,Z){ft.nodeValue=Z}listen(ft,Z,Re){if("string"==typeof ft&&!(ft=(0,m.q)().getGlobalEventTarget(this.doc,ft)))throw new Error(`Unsupported event target ${ft} for event ${Z}`);return this.eventManager.addEventListener(ft,Z,this.decoratePreventDefault(Re))}decoratePreventDefault(ft){return Z=>{if("__ngUnwrap__"===Z)return ft;!1===(this.platformIsServer?this.ngZone.runGuarded(()=>ft(Z)):ft(Z))&&Z.preventDefault()}}}function De(ae){return"TEMPLATE"===ae.tagName&&void 0!==ae.content}class ze extends ve{constructor(ft,Z,Re,st,on,In,bi,wi){super(ft,on,In,wi),this.sharedStylesHost=Z,this.hostEl=Re,this.shadowRoot=Re.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const Ri=ct(st.id,st.styles);for(const mr of Ri){const Xi=document.createElement("style");bi&&Xi.setAttribute("nonce",bi),Xi.textContent=mr,this.shadowRoot.appendChild(Xi)}}nodeOrShadowRoot(ft){return ft===this.hostEl?this.shadowRoot:ft}appendChild(ft,Z){return super.appendChild(this.nodeOrShadowRoot(ft),Z)}insertBefore(ft,Z,Re){return super.insertBefore(this.nodeOrShadowRoot(ft),Z,Re)}removeChild(ft,Z){return super.removeChild(this.nodeOrShadowRoot(ft),Z)}parentNode(ft){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(ft)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}}class Ke extends ve{constructor(ft,Z,Re,st,on,In,bi,wi){super(ft,on,In,bi),this.sharedStylesHost=Z,this.removeStylesOnCompDestroy=st,this.styles=wi?ct(wi,Re.styles):Re.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}}class Ht extends Ke{constructor(ft,Z,Re,st,on,In,bi,wi){const Ri=st+"-"+Re.id;super(ft,Z,Re,on,In,bi,wi,Ri),this.contentAttr=function ye(ae){return"_ngcontent-%COMP%".replace(nt,ae)}(Ri),this.hostAttr=function Ue(ae){return"_nghost-%COMP%".replace(nt,ae)}(Ri)}applyToHost(ft){this.applyStyles(),this.setAttribute(ft,this.hostAttr,"")}createElement(ft,Z){const Re=super.createElement(ft,Z);return super.setAttribute(Re,this.contentAttr,""),Re}}let dn=(()=>{class ae extends be{constructor(Z){super(Z)}supports(Z){return!0}addEventListener(Z,Re,st){return Z.addEventListener(Re,st,!1),()=>this.removeEventListener(Z,Re,st)}removeEventListener(Z,Re,st){return Z.removeEventListener(Re,st)}static#e=this.\u0275fac=function(Re){return new(Re||ae)(h.LFG(m.K0))};static#t=this.\u0275prov=h.Yz7({token:ae,factory:ae.\u0275fac})}return ae})();const _n=["alt","control","meta","shift"],Ut={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},We={alt:ae=>ae.altKey,control:ae=>ae.ctrlKey,meta:ae=>ae.metaKey,shift:ae=>ae.shiftKey};let Ne=(()=>{class ae extends be{constructor(Z){super(Z)}supports(Z){return null!=ae.parseEventName(Z)}addEventListener(Z,Re,st){const on=ae.parseEventName(Re),In=ae.eventCallback(on.fullKey,st,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>(0,m.q)().onAndCancel(Z,on.domEventName,In))}static parseEventName(Z){const Re=Z.toLowerCase().split("."),st=Re.shift();if(0===Re.length||"keydown"!==st&&"keyup"!==st)return null;const on=ae._normalizeKey(Re.pop());let In="",bi=Re.indexOf("code");if(bi>-1&&(Re.splice(bi,1),In="code."),_n.forEach(Ri=>{const mr=Re.indexOf(Ri);mr>-1&&(Re.splice(mr,1),In+=Ri+".")}),In+=on,0!=Re.length||0===on.length)return null;const wi={};return wi.domEventName=st,wi.fullKey=In,wi}static matchEventFullKeyCode(Z,Re){let st=Ut[Z.key]||Z.key,on="";return Re.indexOf("code.")>-1&&(st=Z.code,on="code."),!(null==st||!st)&&(st=st.toLowerCase()," "===st?st="space":"."===st&&(st="dot"),_n.forEach(In=>{In!==st&&(0,We[In])(Z)&&(on+=In+".")}),on+=st,on===Re)}static eventCallback(Z,Re,st){return on=>{ae.matchEventFullKeyCode(on,Z)&&st.runGuarded(()=>Re(on))}}static _normalizeKey(Z){return"esc"===Z?"escape":Z}static#e=this.\u0275fac=function(Re){return new(Re||ae)(h.LFG(m.K0))};static#t=this.\u0275prov=h.Yz7({token:ae,factory:ae.\u0275fac})}return ae})();const bn=(0,h.eFA)(h._c5,"browser",[{provide:h.Lbi,useValue:m.bD},{provide:h.g9A,useValue:function an(){l.makeCurrent()},multi:!0},{provide:m.K0,useFactory:function pt(){return(0,h.RDi)(document),document},deps:[]}]),Cn=new h.OlP(""),It=[{provide:h.rWj,useClass:class ie{addToWindow(ft){h.dqk.getAngularTestability=(Re,st=!0)=>{const on=ft.findTestabilityInTree(Re,st);if(null==on)throw new h.vHH(5103,!1);return on},h.dqk.getAllAngularTestabilities=()=>ft.getAllTestabilities(),h.dqk.getAllAngularRootElements=()=>ft.getAllRootElements(),h.dqk.frameworkStabilizers||(h.dqk.frameworkStabilizers=[]),h.dqk.frameworkStabilizers.push(Re=>{const st=h.dqk.getAllAngularTestabilities();let on=st.length;const In=function(){on--,0==on&&Re()};st.forEach(bi=>{bi.whenStable(In)})})}findTestabilityInTree(ft,Z,Re){return null==Z?null:ft.getTestability(Z)??(Re?(0,m.q)().isShadowRoot(Z)?this.findTestabilityInTree(ft,Z.host,!0):this.findTestabilityInTree(ft,Z.parentElement,!0):null)}},deps:[]},{provide:h.lri,useClass:h.dDg,deps:[h.R0b,h.eoX,h.rWj]},{provide:h.dDg,useClass:h.dDg,deps:[h.R0b,h.eoX,h.rWj]}],pe=[{provide:h.zSh,useValue:"root"},{provide:h.qLn,useFactory:function tt(){return new h.qLn},deps:[]},{provide:Pe,useClass:dn,multi:!0,deps:[m.K0,h.R0b,h.Lbi]},{provide:Pe,useClass:Ne,multi:!0,deps:[m.K0]},X,Me,K,{provide:h.FYo,useExisting:X},{provide:m.JF,useClass:fe,deps:[]},[]];let lt=(()=>{class ae{constructor(Z){}static withServerTransition(Z){return{ngModule:ae,providers:[{provide:h.AFp,useValue:Z.appId}]}}static#e=this.\u0275fac=function(Re){return new(Re||ae)(h.LFG(Cn,12))};static#t=this.\u0275mod=h.oAB({type:ae});static#n=this.\u0275inj=h.cJS({providers:[...pe,...It],imports:[m.ez,h.hGG]})}return ae})(),Un=(()=>{class ae{constructor(Z){this._doc=Z}getTitle(){return this._doc.title}setTitle(Z){this._doc.title=Z||""}static#e=this.\u0275fac=function(Re){return new(Re||ae)(h.LFG(m.K0))};static#t=this.\u0275prov=h.Yz7({token:ae,factory:function(Re){let st=null;return st=Re?new Re:function Ft(){return new Un((0,h.LFG)(m.K0))}(),st},providedIn:"root"})}return ae})();typeof window<"u"&&window},6800:(Bn,Ct,P)=>{"use strict";P.d(Ct,{gz:()=>To,y6:()=>Fi,OD:()=>St,eC:()=>pe,wN:()=>Zr,F0:()=>Ds,rH:()=>Lo,Bz:()=>dl,Hx:()=>ot});var h=P(9212),m=P(2664),te=P(7715),l=P(2096),B=P(5619),Y=P(2572);const ie=(0,P(2306).d)(S=>function(){S(this),this.name="EmptyError",this.message="no elements in sequence"});var fe=P(5211),Pe=P(4911),K=P(8407),be=P(5592),Te=P(4674);function Me(S,u){const n=(0,Te.m)(S)?S:()=>S,a=p=>p.error(n());return new be.y(u?p=>u.schedule(a,0,p):a)}var de=P(6232),nt=P(7394),Ce=P(9360),oe=P(8251);function xe(){return(0,Ce.e)((S,u)=>{let n=null;S._refCount++;const a=(0,oe.x)(u,void 0,void 0,void 0,()=>{if(!S||S._refCount<=0||0<--S._refCount)return void(n=null);const p=S._connection,y=n;n=null,p&&(!y||p===y)&&p.unsubscribe(),u.unsubscribe()});S.subscribe(a),a.closed||(n=S.connect())})}class Ie extends be.y{constructor(u,n){super(),this.source=u,this.subjectFactory=n,this._subject=null,this._refCount=0,this._connection=null,(0,Ce.A)(u)&&(this.lift=u.lift)}_subscribe(u){return this.getSubject().subscribe(u)}getSubject(){const u=this._subject;return(!u||u.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:u}=this;this._subject=this._connection=null,u?.unsubscribe()}connect(){let u=this._connection;if(!u){u=this._connection=new nt.w0;const n=this.getSubject();u.add(this.source.subscribe((0,oe.x)(n,void 0,()=>{this._teardown(),n.complete()},a=>{this._teardown(),n.error(a)},()=>this._teardown()))),u.closed&&(this._connection=null,u=nt.w0.EMPTY)}return u}refCount(){return xe()(this)}}var Ae=P(8645),ye=P(6814),Ue=P(7398),ct=P(4664),X=P(8180),ve=P(4564),Fe=P(2181),De=P(1631);function ze(S){return(0,Ce.e)((u,n)=>{let a=!1;u.subscribe((0,oe.x)(n,p=>{a=!0,n.next(p)},()=>{a||n.next(S),n.complete()}))})}function Ke(S=Ht){return(0,Ce.e)((u,n)=>{let a=!1;u.subscribe((0,oe.x)(n,p=>{a=!0,n.next(p)},()=>a?n.complete():n.error(S())))})}function Ht(){return new ie}var dn=P(2737);function _n(S,u){const n=arguments.length>=2;return a=>a.pipe(S?(0,Fe.h)((p,y)=>S(p,y,a)):dn.y,(0,X.q)(1),n?ze(u):Ke(()=>new ie))}var Ut=P(6328);function We(S,u,n){const a=(0,Te.m)(S)||u||n?{next:S,error:u,complete:n}:S;return a?(0,Ce.e)((p,y)=>{var x;null===(x=a.subscribe)||void 0===x||x.call(a);let D=!0;p.subscribe((0,oe.x)(y,I=>{var R;null===(R=a.next)||void 0===R||R.call(a,I),y.next(I)},()=>{var I;D=!1,null===(I=a.complete)||void 0===I||I.call(a),y.complete()},I=>{var R;D=!1,null===(R=a.error)||void 0===R||R.call(a,I),y.error(I)},()=>{var I,R;D&&(null===(I=a.unsubscribe)||void 0===I||I.call(a)),null===(R=a.finalize)||void 0===R||R.call(a)}))}):dn.y}var Ne=P(4829);function ke(S){return(0,Ce.e)((u,n)=>{let y,a=null,p=!1;a=u.subscribe((0,oe.x)(n,void 0,void 0,x=>{y=(0,Ne.Xf)(S(x,ke(S)(u))),a?(a.unsubscribe(),a=null,y.subscribe(n)):p=!0})),p&&(a.unsubscribe(),a=null,y.subscribe(n))})}function mt(S){return S<=0?()=>de.E:(0,Ce.e)((u,n)=>{let a=[];u.subscribe((0,oe.x)(n,p=>{a.push(p),S<a.length&&a.shift()},()=>{for(const p of a)n.next(p);n.complete()},void 0,()=>{a=null}))})}var pt=P(4716),Xt=P(2420),Cn=P(7537),It=P(6593);const pe="primary",lt=Symbol("RouteTitle");class Zt{constructor(u){this.params=u||{}}has(u){return Object.prototype.hasOwnProperty.call(this.params,u)}get(u){if(this.has(u)){const n=this.params[u];return Array.isArray(n)?n[0]:n}return null}getAll(u){if(this.has(u)){const n=this.params[u];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}}function hn(S){return new Zt(S)}function Yt(S,u,n){const a=n.path.split("/");if(a.length>S.length||"full"===n.pathMatch&&(u.hasChildren()||a.length<S.length))return null;const p={};for(let y=0;y<a.length;y++){const x=a[y],D=S[y];if(x.startsWith(":"))p[x.substring(1)]=D;else if(x!==D.path)return null}return{consumed:S.slice(0,a.length),posParams:p}}function Un(S,u){const n=S?Ve(S):void 0,a=u?Ve(u):void 0;if(!n||!a||n.length!=a.length)return!1;let p;for(let y=0;y<n.length;y++)if(p=n[y],!Pt(S[p],u[p]))return!1;return!0}function Ve(S){return[...Object.keys(S),...Object.getOwnPropertySymbols(S)]}function Pt(S,u){if(Array.isArray(S)&&Array.isArray(u)){if(S.length!==u.length)return!1;const n=[...S].sort(),a=[...u].sort();return n.every((p,y)=>a[y]===p)}return S===u}function Kt(S){return S.length>0?S[S.length-1]:null}function wn(S){return(0,m.b)(S)?S:(0,h.QGY)(S)?(0,te.D)(Promise.resolve(S)):(0,l.of)(S)}const ei={exact:function dr(S,u,n){if(!he(S.segments,u.segments)||!gn(S.segments,u.segments,n)||S.numberOfChildren!==u.numberOfChildren)return!1;for(const a in u.children)if(!S.children[a]||!dr(S.children[a],u.children[a],n))return!1;return!0},subset:fn},di={exact:function Mi(S,u){return Un(S,u)},subset:function Ei(S,u){return Object.keys(u).length<=Object.keys(S).length&&Object.keys(u).every(n=>Pt(S[n],u[n]))},ignored:()=>!0};function Lr(S,u,n){return ei[n.paths](S.root,u.root,n.matrixParams)&&di[n.queryParams](S.queryParams,u.queryParams)&&!("exact"===n.fragment&&S.fragment!==u.fragment)}function fn(S,u,n){return Li(S,u,u.segments,n)}function Li(S,u,n,a){if(S.segments.length>n.length){const p=S.segments.slice(0,n.length);return!(!he(p,n)||u.hasChildren()||!gn(p,n,a))}if(S.segments.length===n.length){if(!he(S.segments,n)||!gn(S.segments,n,a))return!1;for(const p in u.children)if(!S.children[p]||!fn(S.children[p],u.children[p],a))return!1;return!0}{const p=n.slice(0,S.segments.length),y=n.slice(S.segments.length);return!!(he(S.segments,p)&&gn(S.segments,p,a)&&S.children[pe])&&Li(S.children[pe],u,y,a)}}function gn(S,u,n){return u.every((a,p)=>di[n](S[p].parameters,a.parameters))}class Fn{constructor(u=new Jt([],{}),n={},a=null){this.root=u,this.queryParams=n,this.fragment=a}get queryParamMap(){return this._queryParamMap??=hn(this.queryParams),this._queryParamMap}toString(){return Dt.serialize(this)}}class Jt{constructor(u,n){this.segments=u,this.children=n,this.parent=null,Object.values(n).forEach(a=>a.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return jt(this)}}class Bi{constructor(u,n){this.path=u,this.parameters=n}get parameterMap(){return this._parameterMap??=hn(this.parameters),this._parameterMap}toString(){return Z(this)}}function he(S,u){return S.length===u.length&&S.every((n,a)=>n.path===u[a].path)}let ot=(()=>{class S{static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:()=>new yt,providedIn:"root"})}return S})();class yt{parse(u){const n=new uo(u);return new Fn(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(u){const n=`/${Vt(u.root,!0)}`,a=function st(S){const u=Object.entries(S).map(([n,a])=>Array.isArray(a)?a.map(p=>`${Bt(n)}=${Bt(p)}`).join("&"):`${Bt(n)}=${Bt(a)}`).filter(n=>n);return u.length?`?${u.join("&")}`:""}(u.queryParams);return`${n}${a}${"string"==typeof u.fragment?`#${function Nn(S){return encodeURI(S)}(u.fragment)}`:""}`}}const Dt=new yt;function jt(S){return S.segments.map(u=>Z(u)).join("/")}function Vt(S,u){if(!S.hasChildren())return jt(S);if(u){const n=S.children[pe]?Vt(S.children[pe],!1):"",a=[];return Object.entries(S.children).forEach(([p,y])=>{p!==pe&&a.push(`${p}:${Vt(y,!1)}`)}),a.length>0?`${n}(${a.join("//")})`:n}{const n=function _e(S,u){let n=[];return Object.entries(S.children).forEach(([a,p])=>{a===pe&&(n=n.concat(u(p,a)))}),Object.entries(S.children).forEach(([a,p])=>{a!==pe&&(n=n.concat(u(p,a)))}),n}(S,(a,p)=>p===pe?[Vt(S.children[pe],!1)]:[`${p}:${Vt(a,!1)}`]);return 1===Object.keys(S.children).length&&null!=S.children[pe]?`${jt(S)}/${n[0]}`:`${jt(S)}/(${n.join("//")})`}}function dt(S){return encodeURIComponent(S).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function Bt(S){return dt(S).replace(/%3B/gi,";")}function Gn(S){return dt(S).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function ae(S){return decodeURIComponent(S)}function ft(S){return ae(S.replace(/\+/g,"%20"))}function Z(S){return`${Gn(S.path)}${function Re(S){return Object.entries(S).map(([u,n])=>`;${Gn(u)}=${Gn(n)}`).join("")}(S.parameters)}`}const on=/^[^\/()?;#]+/;function In(S){const u=S.match(on);return u?u[0]:""}const bi=/^[^\/()?;=#]+/,Ri=/^[^=?&#]+/,Xi=/^[^&#]+/;class uo{constructor(u){this.url=u,this.remaining=u}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new Jt([],{}):new Jt([],this.parseChildren())}parseQueryParams(){const u={};if(this.consumeOptional("?"))do{this.parseQueryParam(u)}while(this.consumeOptional("&"));return u}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const u=[];for(this.peekStartsWith("(")||u.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),u.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let a={};return this.peekStartsWith("(")&&(a=this.parseParens(!1)),(u.length>0||Object.keys(n).length>0)&&(a[pe]=new Jt(u,n)),a}parseSegment(){const u=In(this.remaining);if(""===u&&this.peekStartsWith(";"))throw new h.vHH(4009,!1);return this.capture(u),new Bi(ae(u),this.parseMatrixParams())}parseMatrixParams(){const u={};for(;this.consumeOptional(";");)this.parseParam(u);return u}parseParam(u){const n=function wi(S){const u=S.match(bi);return u?u[0]:""}(this.remaining);if(!n)return;this.capture(n);let a="";if(this.consumeOptional("=")){const p=In(this.remaining);p&&(a=p,this.capture(a))}u[ae(n)]=ae(a)}parseQueryParam(u){const n=function mr(S){const u=S.match(Ri);return u?u[0]:""}(this.remaining);if(!n)return;this.capture(n);let a="";if(this.consumeOptional("=")){const x=function Ar(S){const u=S.match(Xi);return u?u[0]:""}(this.remaining);x&&(a=x,this.capture(a))}const p=ft(n),y=ft(a);if(u.hasOwnProperty(p)){let x=u[p];Array.isArray(x)||(x=[x],u[p]=x),x.push(y)}else u[p]=y}parseParens(u){const n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const a=In(this.remaining),p=this.remaining[a.length];if("/"!==p&&")"!==p&&";"!==p)throw new h.vHH(4010,!1);let y;a.indexOf(":")>-1?(y=a.slice(0,a.indexOf(":")),this.capture(y),this.capture(":")):u&&(y=pe);const x=this.parseChildren();n[y]=1===Object.keys(x).length?x[pe]:new Jt([],x),this.consumeOptional("//")}return n}peekStartsWith(u){return this.remaining.startsWith(u)}consumeOptional(u){return!!this.peekStartsWith(u)&&(this.remaining=this.remaining.substring(u.length),!0)}capture(u){if(!this.consumeOptional(u))throw new h.vHH(4011,!1)}}function _o(S){return S.segments.length>0?new Jt([],{[pe]:S}):S}function Eo(S){const u={};for(const[a,p]of Object.entries(S.children)){const y=Eo(p);if(a===pe&&0===y.segments.length&&y.hasChildren())for(const[x,D]of Object.entries(y.children))u[x]=D;else(y.segments.length>0||y.hasChildren())&&(u[a]=y)}return function zi(S){if(1===S.numberOfChildren&&S.children[pe]){const u=S.children[pe];return new Jt(S.segments.concat(u.segments),u.children)}return S}(new Jt(S.segments,u))}function hr(S){return S instanceof Fn}function yo(S){let u;const p=_o(function n(y){const x={};for(const I of y.children){const R=n(I);x[I.outlet]=R}const D=new Jt(y.url,x);return y===S&&(u=D),D}(S.root));return u??p}function vr(S,u,n,a){let p=S;for(;p.parent;)p=p.parent;if(0===u.length)return qi(p,p,p,n,a);const y=function Et(S){if("string"==typeof S[0]&&1===S.length&&"/"===S[0])return new Tt(!0,0,S);let u=0,n=!1;const a=S.reduce((p,y,x)=>{if("object"==typeof y&&null!=y){if(y.outlets){const D={};return Object.entries(y.outlets).forEach(([I,R])=>{D[I]="string"==typeof R?R.split("/"):R}),[...p,{outlets:D}]}if(y.segmentPath)return[...p,y.segmentPath]}return"string"!=typeof y?[...p,y]:0===x?(y.split("/").forEach((D,I)=>{0==I&&"."===D||(0==I&&""===D?n=!0:".."===D?u++:""!=D&&p.push(D))}),p):[...p,y]},[]);return new Tt(n,u,a)}(u);if(y.toRoot())return qi(p,p,new Jt([],{}),n,a);const x=function vt(S,u,n){if(S.isAbsolute)return new ln(u,!0,0);if(!n)return new ln(u,!1,NaN);if(null===n.parent)return new ln(n,!0,0);const a=Vr(S.commands[0])?0:1;return function Hn(S,u,n){let a=S,p=u,y=n;for(;y>p;){if(y-=p,a=a.parent,!a)throw new h.vHH(4005,!1);p=a.segments.length}return new ln(a,!1,p-y)}(n,n.segments.length-1+a,S.numberOfDoubleDots)}(y,p,S),D=x.processChildren?pi(x.segmentGroup,x.index,y.commands):Kn(x.segmentGroup,x.index,y.commands);return qi(p,x.segmentGroup,D,n,a)}function Vr(S){return"object"==typeof S&&null!=S&&!S.outlets&&!S.segmentPath}function Yr(S){return"object"==typeof S&&null!=S&&S.outlets}function qi(S,u,n,a,p){let x,y={};a&&Object.entries(a).forEach(([I,R])=>{y[I]=Array.isArray(R)?R.map(U=>`${U}`):`${R}`}),x=S===u?n:Qe(S,u,n);const D=_o(Eo(x));return new Fn(D,y,p)}function Qe(S,u,n){const a={};return Object.entries(S.children).forEach(([p,y])=>{a[p]=y===u?n:Qe(y,u,n)}),new Jt(S.segments,a)}class Tt{constructor(u,n,a){if(this.isAbsolute=u,this.numberOfDoubleDots=n,this.commands=a,u&&a.length>0&&Vr(a[0]))throw new h.vHH(4003,!1);const p=a.find(Yr);if(p&&p!==Kt(a))throw new h.vHH(4004,!1)}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class ln{constructor(u,n,a){this.segmentGroup=u,this.processChildren=n,this.index=a}}function Kn(S,u,n){if(S??=new Jt([],{}),0===S.segments.length&&S.hasChildren())return pi(S,u,n);const a=function ki(S,u,n){let a=0,p=u;const y={match:!1,pathIndex:0,commandIndex:0};for(;p<S.segments.length;){if(a>=n.length)return y;const x=S.segments[p],D=n[a];if(Yr(D))break;const I=`${D}`,R=a<n.length-1?n[a+1]:null;if(p>0&&void 0===I)break;if(I&&R&&"object"==typeof R&&void 0===R.outlets){if(!Ee(I,R,x))return y;a+=2}else{if(!Ee(I,{},x))return y;a++}p++}return{match:!0,pathIndex:p,commandIndex:a}}(S,u,n),p=n.slice(a.commandIndex);if(a.match&&a.pathIndex<S.segments.length){const y=new Jt(S.segments.slice(0,a.pathIndex),{});return y.children[pe]=new Jt(S.segments.slice(a.pathIndex),S.children),pi(y,0,p)}return a.match&&0===p.length?new Jt(S.segments,{}):a.match&&!S.hasChildren()?rr(S,u,n):a.match?pi(S,0,p):rr(S,u,n)}function pi(S,u,n){if(0===n.length)return new Jt(S.segments,{});{const a=function On(S){return Yr(S[0])?S[0].outlets:{[pe]:S}}(n),p={};if(Object.keys(a).some(y=>y!==pe)&&S.children[pe]&&1===S.numberOfChildren&&0===S.children[pe].segments.length){const y=pi(S.children[pe],u,n);return new Jt(S.segments,y.children)}return Object.entries(a).forEach(([y,x])=>{"string"==typeof x&&(x=[x]),null!==x&&(p[y]=Kn(S.children[y],u,x))}),Object.entries(S.children).forEach(([y,x])=>{void 0===a[y]&&(p[y]=x)}),new Jt(S.segments,p)}}function rr(S,u,n){const a=S.segments.slice(0,u);let p=0;for(;p<n.length;){const y=n[p];if(Yr(y)){const I=_i(y.outlets);return new Jt(a,I)}if(0===p&&Vr(n[0])){a.push(new Bi(S.segments[u].path,or(n[0]))),p++;continue}const x=Yr(y)?y.outlets[pe]:`${y}`,D=p<n.length-1?n[p+1]:null;x&&D&&Vr(D)?(a.push(new Bi(x,or(D))),p+=2):(a.push(new Bi(x,{})),p++)}return new Jt(a,{})}function _i(S){const u={};return Object.entries(S).forEach(([n,a])=>{"string"==typeof a&&(a=[a]),null!==a&&(u[n]=rr(new Jt([],{}),0,a))}),u}function or(S){const u={};return Object.entries(S).forEach(([n,a])=>u[n]=`${a}`),u}function Ee(S,u,n){return S==n.path&&Un(u,n.parameters)}const Be="imperative";var ee=function(S){return S[S.NavigationStart=0]="NavigationStart",S[S.NavigationEnd=1]="NavigationEnd",S[S.NavigationCancel=2]="NavigationCancel",S[S.NavigationError=3]="NavigationError",S[S.RoutesRecognized=4]="RoutesRecognized",S[S.ResolveStart=5]="ResolveStart",S[S.ResolveEnd=6]="ResolveEnd",S[S.GuardsCheckStart=7]="GuardsCheckStart",S[S.GuardsCheckEnd=8]="GuardsCheckEnd",S[S.RouteConfigLoadStart=9]="RouteConfigLoadStart",S[S.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",S[S.ChildActivationStart=11]="ChildActivationStart",S[S.ChildActivationEnd=12]="ChildActivationEnd",S[S.ActivationStart=13]="ActivationStart",S[S.ActivationEnd=14]="ActivationEnd",S[S.Scroll=15]="Scroll",S[S.NavigationSkipped=16]="NavigationSkipped",S}(ee||{});class qe{constructor(u,n){this.id=u,this.url=n}}class St extends qe{constructor(u,n,a="imperative",p=null){super(u,n),this.type=ee.NavigationStart,this.navigationTrigger=a,this.restoredState=p}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class en extends qe{constructor(u,n,a){super(u,n),this.urlAfterRedirects=a,this.type=ee.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}var jn=function(S){return S[S.Redirect=0]="Redirect",S[S.SupersededByNewNavigation=1]="SupersededByNewNavigation",S[S.NoDataFromResolver=2]="NoDataFromResolver",S[S.GuardRejected=3]="GuardRejected",S}(jn||{}),V=function(S){return S[S.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",S[S.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",S}(V||{});class ue extends qe{constructor(u,n,a,p){super(u,n),this.reason=a,this.code=p,this.type=ee.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class Xe extends qe{constructor(u,n,a,p){super(u,n),this.reason=a,this.code=p,this.type=ee.NavigationSkipped}}class _t extends qe{constructor(u,n,a,p){super(u,n),this.error=a,this.target=p,this.type=ee.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class Wt extends qe{constructor(u,n,a,p){super(u,n),this.urlAfterRedirects=a,this.state=p,this.type=ee.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class tn extends qe{constructor(u,n,a,p){super(u,n),this.urlAfterRedirects=a,this.state=p,this.type=ee.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class vn extends qe{constructor(u,n,a,p,y){super(u,n),this.urlAfterRedirects=a,this.state=p,this.shouldActivate=y,this.type=ee.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class Vn extends qe{constructor(u,n,a,p){super(u,n),this.urlAfterRedirects=a,this.state=p,this.type=ee.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $n extends qe{constructor(u,n,a,p){super(u,n),this.urlAfterRedirects=a,this.state=p,this.type=ee.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class Xn{constructor(u){this.route=u,this.type=ee.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class si{constructor(u){this.route=u,this.type=ee.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class fi{constructor(u){this.snapshot=u,this.type=ee.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class yi{constructor(u){this.snapshot=u,this.type=ee.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Vi{constructor(u){this.snapshot=u,this.type=ee.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class Yi{constructor(u){this.snapshot=u,this.type=ee.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class O{constructor(u,n,a){this.routerEvent=u,this.position=n,this.anchor=a,this.type=ee.Scroll}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}class Oe{}class ${constructor(u){this.url=u}}class Nt{constructor(){this.outlet=null,this.route=null,this.injector=null,this.children=new Fi,this.attachRef=null}}let Fi=(()=>{class S{constructor(){this.contexts=new Map}onChildOutletCreated(n,a){const p=this.getOrCreateContext(n);p.outlet=a,this.contexts.set(n,p)}onChildOutletDestroyed(n){const a=this.getContext(n);a&&(a.outlet=null,a.attachRef=null)}onOutletDeactivated(){const n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let a=this.getContext(n);return a||(a=new Nt,this.contexts.set(n,a)),a}getContext(n){return this.contexts.get(n)||null}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})();class Sr{constructor(u){this._root=u}get root(){return this._root.value}parent(u){const n=this.pathFromRoot(u);return n.length>1?n[n.length-2]:null}children(u){const n=Qi(u,this._root);return n?n.children.map(a=>a.value):[]}firstChild(u){const n=Qi(u,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(u){const n=Dr(u,this._root);return n.length<2?[]:n[n.length-2].children.map(p=>p.value).filter(p=>p!==u)}pathFromRoot(u){return Dr(u,this._root).map(n=>n.value)}}function Qi(S,u){if(S===u.value)return u;for(const n of u.children){const a=Qi(S,n);if(a)return a}return null}function Dr(S,u){if(S===u.value)return[u];for(const n of u.children){const a=Dr(S,n);if(a.length)return a.unshift(u),a}return[]}class ho{constructor(u,n){this.value=u,this.children=n}toString(){return`TreeNode(${this.value})`}}function ji(S){const u={};return S&&S.children.forEach(n=>u[n.value.outlet]=n),u}class eo extends Sr{constructor(u,n){super(u),this.snapshot=n,Qs(this,u)}toString(){return this.snapshot.toString()}}function Bs(S){const u=function Xs(S){const y=new ds([],{},{},"",{},pe,S,null,{});return new ys("",new ho(y,[]))}(S),n=new B.X([new Bi("",{})]),a=new B.X({}),p=new B.X({}),y=new B.X({}),x=new B.X(""),D=new To(n,a,y,x,p,pe,S,u.root);return D.snapshot=u.root,new eo(new ho(D,[]),u)}class To{constructor(u,n,a,p,y,x,D,I){this.urlSubject=u,this.paramsSubject=n,this.queryParamsSubject=a,this.fragmentSubject=p,this.dataSubject=y,this.outlet=x,this.component=D,this._futureSnapshot=I,this.title=this.dataSubject?.pipe((0,Ue.U)(R=>R[lt]))??(0,l.of)(void 0),this.url=u,this.params=n,this.queryParams=a,this.fragment=p,this.data=y}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe((0,Ue.U)(u=>hn(u))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe((0,Ue.U)(u=>hn(u))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function $o(S,u,n="emptyOnly"){let a;const{routeConfig:p}=S;return a=null===u||"always"!==n&&""!==p?.path&&(u.component||u.routeConfig?.loadComponent)?{params:{...S.params},data:{...S.data},resolve:{...S.data,...S._resolvedData??{}}}:{params:{...u.params,...S.params},data:{...u.data,...S.data},resolve:{...S.data,...u.data,...p?.data,...S._resolvedData}},p&&vo(p)&&(a.resolve[lt]=p.title),a}class ds{get title(){return this.data?.[lt]}constructor(u,n,a,p,y,x,D,I,R){this.url=u,this.params=n,this.queryParams=a,this.fragment=p,this.data=y,this.outlet=x,this.component=D,this.routeConfig=I,this._resolve=R}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=hn(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=hn(this.queryParams),this._queryParamMap}toString(){return`Route(url:'${this.url.map(a=>a.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class ys extends Sr{constructor(u,n){super(n),this.url=u,Qs(this,n)}toString(){return Mo(this._root)}}function Qs(S,u){u.value._routerState=S,u.children.forEach(n=>Qs(S,n))}function Mo(S){const u=S.children.length>0?` { ${S.children.map(Mo).join(", ")} } `:"";return`${S.value}${u}`}function to(S){if(S.snapshot){const u=S.snapshot,n=S._futureSnapshot;S.snapshot=n,Un(u.queryParams,n.queryParams)||S.queryParamsSubject.next(n.queryParams),u.fragment!==n.fragment&&S.fragmentSubject.next(n.fragment),Un(u.params,n.params)||S.paramsSubject.next(n.params),function Ft(S,u){if(S.length!==u.length)return!1;for(let n=0;n<S.length;++n)if(!Un(S[n],u[n]))return!1;return!0}(u.url,n.url)||S.urlSubject.next(n.url),Un(u.data,n.data)||S.dataSubject.next(n.data)}else S.snapshot=S._futureSnapshot,S.dataSubject.next(S._futureSnapshot.data)}function fr(S,u){const n=Un(S.params,u.params)&&function ut(S,u){return he(S,u)&&S.every((n,a)=>Un(n.parameters,u[a].parameters))}(S.url,u.url);return n&&!(!S.parent!=!u.parent)&&(!S.parent||fr(S.parent,u.parent))}function vo(S){return"string"==typeof S.title||null===S.title}let Yo=(()=>{class S{constructor(){this.activated=null,this._activatedRoute=null,this.name=pe,this.activateEvents=new h.vpe,this.deactivateEvents=new h.vpe,this.attachEvents=new h.vpe,this.detachEvents=new h.vpe,this.parentContexts=(0,h.f3M)(Fi),this.location=(0,h.f3M)(h.s_b),this.changeDetector=(0,h.f3M)(h.sBO),this.environmentInjector=(0,h.f3M)(h.lqb),this.inputBinder=(0,h.f3M)(Po,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){const{firstChange:a,previousValue:p}=n.name;if(a)return;this.isTrackedInParentContexts(p)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(p)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;const n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new h.vHH(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new h.vHH(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new h.vHH(4012,!1);this.location.detach();const n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,a){this.activated=n,this._activatedRoute=a,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){const n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,a){if(this.isActivated)throw new h.vHH(4013,!1);this._activatedRoute=n;const p=this.location,x=n.snapshot.component,D=this.parentContexts.getOrCreateContext(this.name).children,I=new zs(n,D,p.injector);this.activated=p.createComponent(x,{index:p.length,injector:I,environmentInjector:a??this.environmentInjector}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275dir=h.lG2({type:S,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[h.TTD]})}return S})();class zs{constructor(u,n,a){this.route=u,this.childContexts=n,this.parent=a}get(u,n){return u===To?this.route:u===Fi?this.childContexts:this.parent.get(u,n)}}const Po=new h.OlP("");let Jo=(()=>{class S{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){const{activatedRoute:a}=n,p=(0,Y.a)([a.queryParams,a.params,a.data]).pipe((0,ct.w)(([y,x,D],I)=>(D={...y,...x,...D},0===I?(0,l.of)(D):Promise.resolve(D)))).subscribe(y=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==a||null===a.component)return void this.unsubscribeFromRouteData(n);const x=(0,h.qFp)(a.component);if(x)for(const{templateName:D}of x.inputs)n.activatedComponentRef.setInput(D,y[D]);else this.unsubscribeFromRouteData(n)});this.outletDataSubscriptions.set(n,p)}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac})}return S})();function Ko(S,u,n){if(n&&S.shouldReuseRoute(u.value,n.value.snapshot)){const a=n.value;a._futureSnapshot=u.value;const p=function rl(S,u,n){return u.children.map(a=>{for(const p of n.children)if(S.shouldReuseRoute(a.value,p.value.snapshot))return Ko(S,a,p);return Ko(S,a)})}(S,u,n);return new ho(a,p)}{if(S.shouldAttach(u.value)){const y=S.retrieve(u.value);if(null!==y){const x=y.route;return x.value._futureSnapshot=u.value,x.children=u.children.map(D=>Ko(S,D)),x}}const a=function la(S){return new To(new B.X(S.url),new B.X(S.params),new B.X(S.queryParams),new B.X(S.fragment),new B.X(S.data),S.outlet,S.component,S)}(u.value),p=u.children.map(y=>Ko(S,y));return new ho(a,p)}}const ca="ngNavigationCancelingError";function Ba(S,u){const{redirectTo:n,navigationBehaviorOptions:a}=hr(u)?{redirectTo:u,navigationBehaviorOptions:void 0}:u,p=xs(!1,jn.Redirect,u);return p.url=n,p.navigationBehaviorOptions=a,p}function xs(S,u,n){const a=new Error("NavigationCancelingError: "+(S||""));return a[ca]=!0,a.cancellationCode=u,n&&(a.url=n),a}function za(S){return S&&S[ca]}let Ca=(()=>{class S{static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275cmp=h.Xpm({type:S,selectors:[["ng-component"]],standalone:!0,features:[h.jDz],decls:1,vars:0,template:function(a,p){1&a&&h._UZ(0,"router-outlet")},dependencies:[Yo],encapsulation:2})}return S})();function Ea(S){const u=S.children&&S.children.map(Ea),n=u?{...S,children:u}:{...S};return!n.component&&!n.loadComponent&&(u||n.loadChildren)&&n.outlet&&n.outlet!==pe&&(n.component=Ca),n}function Xo(S){return S.outlet||pe}function ea(S){if(!S)return null;if(S.routeConfig?._injector)return S.routeConfig._injector;for(let u=S.parent;u;u=u.parent){const n=u.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}class nr{constructor(u,n,a,p,y){this.routeReuseStrategy=u,this.futureState=n,this.currState=a,this.forwardEvent=p,this.inputBindingEnabled=y}activate(u){const n=this.futureState._root,a=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,a,u),to(this.futureState.root),this.activateChildRoutes(n,a,u)}deactivateChildRoutes(u,n,a){const p=ji(n);u.children.forEach(y=>{const x=y.value.outlet;this.deactivateRoutes(y,p[x],a),delete p[x]}),Object.values(p).forEach(y=>{this.deactivateRouteAndItsChildren(y,a)})}deactivateRoutes(u,n,a){const p=u.value,y=n?n.value:null;if(p===y)if(p.component){const x=a.getContext(p.outlet);x&&this.deactivateChildRoutes(u,n,x.children)}else this.deactivateChildRoutes(u,n,a);else y&&this.deactivateRouteAndItsChildren(n,a)}deactivateRouteAndItsChildren(u,n){u.value.component&&this.routeReuseStrategy.shouldDetach(u.value.snapshot)?this.detachAndStoreRouteSubtree(u,n):this.deactivateRouteAndOutlet(u,n)}detachAndStoreRouteSubtree(u,n){const a=n.getContext(u.value.outlet),p=a&&u.value.component?a.children:n,y=ji(u);for(const x of Object.values(y))this.deactivateRouteAndItsChildren(x,p);if(a&&a.outlet){const x=a.outlet.detach(),D=a.children.onOutletDeactivated();this.routeReuseStrategy.store(u.value.snapshot,{componentRef:x,route:u,contexts:D})}}deactivateRouteAndOutlet(u,n){const a=n.getContext(u.value.outlet),p=a&&u.value.component?a.children:n,y=ji(u);for(const x of Object.values(y))this.deactivateRouteAndItsChildren(x,p);a&&(a.outlet&&(a.outlet.deactivate(),a.children.onOutletDeactivated()),a.attachRef=null,a.route=null)}activateChildRoutes(u,n,a){const p=ji(n);u.children.forEach(y=>{this.activateRoutes(y,p[y.value.outlet],a),this.forwardEvent(new Yi(y.value.snapshot))}),u.children.length&&this.forwardEvent(new yi(u.value.snapshot))}activateRoutes(u,n,a){const p=u.value,y=n?n.value:null;if(to(p),p===y)if(p.component){const x=a.getOrCreateContext(p.outlet);this.activateChildRoutes(u,n,x.children)}else this.activateChildRoutes(u,n,a);else if(p.component){const x=a.getOrCreateContext(p.outlet);if(this.routeReuseStrategy.shouldAttach(p.snapshot)){const D=this.routeReuseStrategy.retrieve(p.snapshot);this.routeReuseStrategy.store(p.snapshot,null),x.children.onOutletReAttached(D.contexts),x.attachRef=D.componentRef,x.route=D.route.value,x.outlet&&x.outlet.attach(D.componentRef,D.route.value),to(D.route.value),this.activateChildRoutes(u,null,x.children)}else{const D=ea(p.snapshot);x.attachRef=null,x.route=p,x.injector=D,x.outlet&&x.outlet.activateWith(p,x.injector),this.activateChildRoutes(u,null,x.children)}}else this.activateChildRoutes(u,null,a)}}class ro{constructor(u){this.path=u,this.route=this.path[this.path.length-1]}}class Pi{constructor(u,n){this.component=u,this.route=n}}function Qo(S,u,n){const a=S._root;return ce(a,u?u._root:null,n,[a.value])}function re(S,u){const n=Symbol(),a=u.get(S,n);return a===n?"function"!=typeof S||(0,h.Z0I)(S)?u.get(S):S:a}function ce(S,u,n,a,p={canDeactivateChecks:[],canActivateChecks:[]}){const y=ji(u);return S.children.forEach(x=>{(function G(S,u,n,a,p={canDeactivateChecks:[],canActivateChecks:[]}){const y=S.value,x=u?u.value:null,D=n?n.getContext(S.value.outlet):null;if(x&&y.routeConfig===x.routeConfig){const I=function Ge(S,u,n){if("function"==typeof n)return n(S,u);switch(n){case"pathParamsChange":return!he(S.url,u.url);case"pathParamsOrQueryParamsChange":return!he(S.url,u.url)||!Un(S.queryParams,u.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!fr(S,u)||!Un(S.queryParams,u.queryParams);default:return!fr(S,u)}}(x,y,y.routeConfig.runGuardsAndResolvers);I?p.canActivateChecks.push(new ro(a)):(y.data=x.data,y._resolvedData=x._resolvedData),ce(S,u,y.component?D?D.children:null:n,a,p),I&&D&&D.outlet&&D.outlet.isActivated&&p.canDeactivateChecks.push(new Pi(D.outlet.component,x))}else x&&zt(u,D,p),p.canActivateChecks.push(new ro(a)),ce(S,null,y.component?D?D.children:null:n,a,p)})(x,y[x.value.outlet],n,a.concat([x.value]),p),delete y[x.value.outlet]}),Object.entries(y).forEach(([x,D])=>zt(D,n.getContext(x),p)),p}function zt(S,u,n){const a=ji(S),p=S.value;Object.entries(a).forEach(([y,x])=>{zt(x,p.component?u?u.children.getContext(y):null:u,n)}),n.canDeactivateChecks.push(new Pi(p.component&&u&&u.outlet&&u.outlet.isActivated?u.outlet.component:null,p))}function ni(S){return"function"==typeof S}function xo(S){return S instanceof ie||"EmptyError"===S?.name}const Ro=Symbol("INITIAL_VALUE");function Ui(){return(0,ct.w)(S=>(0,Y.a)(S.map(u=>u.pipe((0,X.q)(1),function me(...S){const u=(0,ve.yG)(S);return(0,Ce.e)((n,a)=>{(u?(0,fe.z)(S,n,u):(0,fe.z)(S,n)).subscribe(a)})}(Ro)))).pipe((0,Ue.U)(u=>{for(const n of u)if(!0!==n){if(n===Ro)return Ro;if(!1===n||n instanceof Fn)return n}return!0}),(0,Fe.h)(u=>u!==Ro),(0,X.q)(1)))}function $s(S){return(0,K.z)(We(u=>{if(hr(u))throw Ba(0,u)}),(0,Ue.U)(u=>!0===u))}class es{constructor(u){this.segmentGroup=u||null}}class Gi extends Error{constructor(u){super(),this.urlTree=u}}function ta(S){return Me(new es(S))}class na{constructor(u,n){this.urlSerializer=u,this.urlTree=n}lineralizeSegments(u,n){let a=[],p=n.root;for(;;){if(a=a.concat(p.segments),0===p.numberOfChildren)return(0,l.of)(a);if(p.numberOfChildren>1||!p.children[pe])return Me(new h.vHH(4e3,!1));p=p.children[pe]}}applyRedirectCommands(u,n,a){const p=this.applyRedirectCreateUrlTree(n,this.urlSerializer.parse(n),u,a);if(n.startsWith("/"))throw new Gi(p);return p}applyRedirectCreateUrlTree(u,n,a,p){const y=this.createSegmentGroup(u,n.root,a,p);return new Fn(y,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(u,n){const a={};return Object.entries(u).forEach(([p,y])=>{if("string"==typeof y&&y.startsWith(":")){const D=y.substring(1);a[p]=n[D]}else a[p]=y}),a}createSegmentGroup(u,n,a,p){const y=this.createSegments(u,n.segments,a,p);let x={};return Object.entries(n.children).forEach(([D,I])=>{x[D]=this.createSegmentGroup(u,I,a,p)}),new Jt(y,x)}createSegments(u,n,a,p){return n.map(y=>y.path.startsWith(":")?this.findPosParam(u,y,p):this.findOrReturn(y,a))}findPosParam(u,n,a){const p=a[n.path.substring(1)];if(!p)throw new h.vHH(4001,!1);return p}findOrReturn(u,n){let a=0;for(const p of n){if(p.path===u.path)return n.splice(a),p;a++}return u}}const oo={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function $a(S,u,n,a,p){const y=Io(S,u,n);return y.matched?(a=function bl(S,u){return S.providers&&!S._injector&&(S._injector=(0,h.MMx)(S.providers,u,`Route: ${S.path}`)),S._injector??u}(u,a),function Va(S,u,n,a){const p=u.canMatch;if(!p||0===p.length)return(0,l.of)(!0);const y=p.map(x=>{const D=re(x,S);return wn(function bs(S){return S&&ni(S.canMatch)}(D)?D.canMatch(u,n):(0,h.r_H)(S,()=>D(u,n)))});return(0,l.of)(y).pipe(Ui(),$s())}(a,u,n).pipe((0,Ue.U)(x=>!0===x?y:{...oo}))):(0,l.of)(y)}function Io(S,u,n){if("**"===u.path)return function fo(S){return{matched:!0,parameters:S.length>0?Kt(S).parameters:{},consumedSegments:S,remainingSegments:[],positionalParamSegments:{}}}(n);if(""===u.path)return"full"===u.pathMatch&&(S.hasChildren()||n.length>0)?{...oo}:{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};const p=(u.matcher||Yt)(n,S,u);if(!p)return{...oo};const y={};Object.entries(p.posParams??{}).forEach(([D,I])=>{y[D]=I.path});const x=p.consumed.length>0?{...y,...p.consumed[p.consumed.length-1].parameters}:y;return{matched:!0,consumedSegments:p.consumed,remainingSegments:n.slice(p.consumed.length),parameters:x,positionalParamSegments:p.posParams??{}}}function El(S,u,n,a){return n.length>0&&function Zs(S,u,n){return n.some(a=>Tl(S,u,a)&&Xo(a)!==pe)}(S,n,a)?{segmentGroup:new Jt(u,ql(a,new Jt(n,S.children))),slicedSegments:[]}:0===n.length&&function gc(S,u,n){return n.some(a=>Tl(S,u,a))}(S,n,a)?{segmentGroup:new Jt(S.segments,Za(S,n,a,S.children)),slicedSegments:n}:{segmentGroup:new Jt(S.segments,S.children),slicedSegments:n}}function Za(S,u,n,a){const p={};for(const y of n)if(Tl(S,u,y)&&!a[Xo(y)]){const x=new Jt([],{});p[Xo(y)]=x}return{...a,...p}}function ql(S,u){const n={};n[pe]=u;for(const a of S)if(""===a.path&&Xo(a)!==pe){const p=new Jt([],{});n[Xo(a)]=p}return n}function Tl(S,u,n){return(!(S.hasChildren()||u.length>0)||"full"!==n.pathMatch)&&""===n.path}class _c{}class Ga{constructor(u,n,a,p,y,x,D){this.injector=u,this.configLoader=n,this.rootComponentType=a,this.config=p,this.urlTree=y,this.paramsInheritanceStrategy=x,this.urlSerializer=D,this.applyRedirects=new na(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(u){return new h.vHH(4002,`'${u.segmentGroup}'`)}recognize(){const u=El(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(u).pipe((0,Ue.U)(n=>{const a=new ds([],Object.freeze({}),Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,{},pe,this.rootComponentType,null,{}),p=new ho(a,n),y=new ys("",p),x=function Ti(S,u,n=null,a=null){return vr(yo(S),u,n,a)}(a,[],this.urlTree.queryParams,this.urlTree.fragment);return x.queryParams=this.urlTree.queryParams,y.url=this.urlSerializer.serialize(x),this.inheritParamsAndData(y._root,null),{state:y,tree:x}}))}match(u){return this.processSegmentGroup(this.injector,this.config,u,pe).pipe(ke(a=>{if(a instanceof Gi)return this.urlTree=a.urlTree,this.match(a.urlTree.root);throw a instanceof es?this.noMatchError(a):a}))}inheritParamsAndData(u,n){const a=u.value,p=$o(a,n,this.paramsInheritanceStrategy);a.params=Object.freeze(p.params),a.data=Object.freeze(p.data),u.children.forEach(y=>this.inheritParamsAndData(y,a))}processSegmentGroup(u,n,a,p){return 0===a.segments.length&&a.hasChildren()?this.processChildren(u,n,a):this.processSegment(u,n,a,a.segments,p,!0).pipe((0,Ue.U)(y=>y instanceof ho?[y]:[]))}processChildren(u,n,a){const p=[];for(const y of Object.keys(a.children))"primary"===y?p.unshift(y):p.push(y);return(0,te.D)(p).pipe((0,Ut.b)(y=>{const x=a.children[y],D=function fa(S,u){const n=S.filter(a=>Xo(a)===u);return n.push(...S.filter(a=>Xo(a)!==u)),n}(n,y);return this.processSegmentGroup(u,D,x,y)}),function Qt(S,u){return(0,Ce.e)(function it(S,u,n,a,p){return(y,x)=>{let D=n,I=u,R=0;y.subscribe((0,oe.x)(x,U=>{const z=R++;I=D?S(I,U,z):(D=!0,U),a&&x.next(I)},p&&(()=>{D&&x.next(I),x.complete()})))}}(S,u,arguments.length>=2,!0))}((y,x)=>(y.push(...x),y)),ze(null),function an(S,u){const n=arguments.length>=2;return a=>a.pipe(S?(0,Fe.h)((p,y)=>S(p,y,a)):dn.y,mt(1),n?ze(u):Ke(()=>new ie))}(),(0,De.z)(y=>{if(null===y)return ta(a);const x=we(y);return function Hs(S){S.sort((u,n)=>u.value.outlet===pe?-1:n.value.outlet===pe?1:u.value.outlet.localeCompare(n.value.outlet))}(x),(0,l.of)(x)}))}processSegment(u,n,a,p,y,x){return(0,te.D)(n).pipe((0,Ut.b)(D=>this.processSegmentAgainstRoute(D._injector??u,n,D,a,p,y,x).pipe(ke(I=>{if(I instanceof es)return(0,l.of)(null);throw I}))),_n(D=>!!D),ke(D=>{if(xo(D))return function Ta(S,u,n){return 0===u.length&&!S.children[n]}(a,p,y)?(0,l.of)(new _c):ta(a);throw D}))}processSegmentAgainstRoute(u,n,a,p,y,x,D){return function Yl(S,u,n,a){return!!(Xo(S)===a||a!==pe&&Tl(u,n,S))&&Io(u,S,n).matched}(a,p,y,x)?void 0===a.redirectTo?this.matchSegmentAgainstRoute(u,p,a,y,x):this.allowRedirects&&D?this.expandSegmentAgainstRouteUsingRedirect(u,p,n,a,y,x):ta(p):ta(p)}expandSegmentAgainstRouteUsingRedirect(u,n,a,p,y,x){const{matched:D,consumedSegments:I,positionalParamSegments:R,remainingSegments:U}=Io(n,p,y);if(!D)return ta(n);p.redirectTo.startsWith("/")&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>31&&(this.allowRedirects=!1));const z=this.applyRedirects.applyRedirectCommands(I,p.redirectTo,R);return this.applyRedirects.lineralizeSegments(p,z).pipe((0,De.z)(Q=>this.processSegment(u,a,n,Q.concat(U),x,!1)))}matchSegmentAgainstRoute(u,n,a,p,y){const x=$a(n,a,p,u);return"**"===a.path&&(n.children={}),x.pipe((0,ct.w)(D=>D.matched?this.getChildConfig(u=a._injector??u,a,p).pipe((0,ct.w)(({routes:I})=>{const R=a._loadedInjector??u,{consumedSegments:U,remainingSegments:z,parameters:Q}=D,Se=new ds(U,Q,Object.freeze({...this.urlTree.queryParams}),this.urlTree.fragment,function le(S){return S.data||{}}(a),Xo(a),a.component??a._loadedComponent??null,a,function wt(S){return S.resolve||{}}(a)),{segmentGroup:je,slicedSegments:Ye}=El(n,U,z,I);if(0===Ye.length&&je.hasChildren())return this.processChildren(R,I,je).pipe((0,Ue.U)(et=>null===et?null:new ho(Se,et)));if(0===I.length&&0===Ye.length)return(0,l.of)(new ho(Se,[]));const $e=Xo(a)===y;return this.processSegment(R,I,je,Ye,$e?pe:y,!0).pipe((0,Ue.U)(et=>new ho(Se,et instanceof ho?[et]:[])))})):ta(n)))}getChildConfig(u,n,a){return n.children?(0,l.of)({routes:n.children,injector:u}):n.loadChildren?void 0!==n._loadedRoutes?(0,l.of)({routes:n._loadedRoutes,injector:n._loadedInjector}):function Hl(S,u,n,a){const p=u.canLoad;if(void 0===p||0===p.length)return(0,l.of)(!0);const y=p.map(x=>{const D=re(x,S);return wn(function Di(S){return S&&ni(S.canLoad)}(D)?D.canLoad(u,n):(0,h.r_H)(S,()=>D(u,n)))});return(0,l.of)(y).pipe(Ui(),$s())}(u,n,a).pipe((0,De.z)(p=>p?this.configLoader.loadChildren(u,n).pipe(We(y=>{n._loadedRoutes=y.routes,n._loadedInjector=y.injector})):function Cl(S){return Me(xs(!1,jn.GuardRejected))}())):(0,l.of)({routes:[],injector:u})}}function F(S){const u=S.value.routeConfig;return u&&""===u.path}function we(S){const u=[],n=new Set;for(const a of S){if(!F(a)){u.push(a);continue}const p=u.find(y=>a.value.routeConfig===y.value.routeConfig);void 0!==p?(p.children.push(...a.children),n.add(p)):u.push(a)}for(const a of n){const p=we(a.children);u.push(new ho(a.value,p))}return u.filter(a=>!n.has(a))}function xi(S){const u=S.children.map(n=>xi(n)).flat();return[S,...u]}function ir(S){return(0,ct.w)(u=>{const n=S(u);return n?(0,te.D)(n).pipe((0,Ue.U)(()=>u)):(0,l.of)(u)})}let Kr=(()=>{class S{buildTitle(n){let a,p=n.root;for(;void 0!==p;)a=this.getResolvedTitleForRoute(p)??a,p=p.children.find(y=>y.outlet===pe);return a}getResolvedTitleForRoute(n){return n.data[lt]}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:()=>(0,h.f3M)(_r),providedIn:"root"})}return S})(),_r=(()=>{class S extends Kr{constructor(n){super(),this.title=n}updateTitle(n){const a=this.buildTitle(n);void 0!==a&&this.title.setTitle(a)}static#e=this.\u0275fac=function(a){return new(a||S)(h.LFG(It.Dx))};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})();const so=new h.OlP("",{providedIn:"root",factory:()=>({})}),Bo=new h.OlP("ROUTES");let ao=(()=>{class S{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=(0,h.f3M)(h.Sil)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return(0,l.of)(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);const a=wn(n.loadComponent()).pipe((0,Ue.U)(Zo),We(y=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=y}),(0,pt.x)(()=>{this.componentLoaders.delete(n)})),p=new Ie(a,()=>new Ae.x).pipe(xe());return this.componentLoaders.set(n,p),p}loadChildren(n,a){if(this.childrenLoaders.get(a))return this.childrenLoaders.get(a);if(a._loadedRoutes)return(0,l.of)({routes:a._loadedRoutes,injector:a._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(a);const y=function Es(S,u,n,a){return wn(S.loadChildren()).pipe((0,Ue.U)(Zo),(0,De.z)(p=>p instanceof h.YKP||Array.isArray(p)?(0,l.of)(p):(0,te.D)(u.compileModuleAsync(p))),(0,Ue.U)(p=>{a&&a(S);let y,x,D=!1;return Array.isArray(p)?(x=p,!0):(y=p.create(n).injector,x=y.get(Bo,[],{optional:!0,self:!0}).flat()),{routes:x.map(Ea),injector:y}}))}(a,this.compiler,n,this.onLoadEndListener).pipe((0,pt.x)(()=>{this.childrenLoaders.delete(a)})),x=new Ie(y,()=>new Ae.x).pipe(xe());return this.childrenLoaders.set(a,x),x}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})();function Zo(S){return function Ts(S){return S&&"object"==typeof S&&"default"in S}(S)?S.default:S}let zo=(()=>{class S{static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:()=>(0,h.f3M)(ia),providedIn:"root"})}return S})(),ia=(()=>{class S{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,a){return n}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})();const Da=new h.OlP(""),li=new h.OlP("");function Ws(S,u,n){const a=S.get(li),p=S.get(ye.K0);return S.get(h.R0b).runOutsideAngular(()=>{if(!p.startViewTransition||a.skipNextTransition)return a.skipNextTransition=!1,Promise.resolve();let y;const x=new Promise(R=>{y=R}),D=p.startViewTransition(()=>(y(),function Du(S){return new Promise(u=>{(0,h.T8G)(u,{injector:S})})}(S))),{onViewTransitionCreated:I}=a;return I&&(0,h.r_H)(S,()=>I({transition:D,from:u,to:n})),x})}let ga=(()=>{class S{get hasRequestedNavigation(){return 0!==this.navigationId}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new Ae.x,this.transitionAbortSubject=new Ae.x,this.configLoader=(0,h.f3M)(ao),this.environmentInjector=(0,h.f3M)(h.lqb),this.urlSerializer=(0,h.f3M)(ot),this.rootContexts=(0,h.f3M)(Fi),this.location=(0,h.f3M)(ye.Ye),this.inputBindingEnabled=null!==(0,h.f3M)(Po,{optional:!0}),this.titleStrategy=(0,h.f3M)(Kr),this.options=(0,h.f3M)(so,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=(0,h.f3M)(zo),this.createViewTransition=(0,h.f3M)(Da,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>(0,l.of)(void 0),this.rootComponentType=null,this.configLoader.onLoadEndListener=p=>this.events.next(new si(p)),this.configLoader.onLoadStartListener=p=>this.events.next(new Xn(p))}complete(){this.transitions?.complete()}handleNavigationRequest(n){const a=++this.navigationId;this.transitions?.next({...this.transitions.value,...n,id:a})}setupNavigations(n,a,p){return this.transitions=new B.X({id:0,currentUrlTree:a,currentRawUrl:a,extractedUrl:this.urlHandlingStrategy.extract(a),urlAfterRedirects:this.urlHandlingStrategy.extract(a),rawUrl:a,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:Be,restoredState:null,currentSnapshot:p.snapshot,targetSnapshot:null,currentRouterState:p,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe((0,Fe.h)(y=>0!==y.id),(0,Ue.U)(y=>({...y,extractedUrl:this.urlHandlingStrategy.extract(y.rawUrl)})),(0,ct.w)(y=>{this.currentTransition=y;let x=!1,D=!1;return(0,l.of)(y).pipe(We(I=>{this.currentNavigation={id:I.id,initialUrl:I.rawUrl,extractedUrl:I.extractedUrl,trigger:I.source,extras:I.extras,previousNavigation:this.lastSuccessfulNavigation?{...this.lastSuccessfulNavigation,previousNavigation:null}:null}}),(0,ct.w)(I=>{const R=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl();if(!R&&"reload"!==(I.extras.onSameUrlNavigation??n.onSameUrlNavigation)){const z="";return this.events.next(new Xe(I.id,this.urlSerializer.serialize(I.rawUrl),z,V.IgnoredSameUrlNavigation)),I.resolve(null),de.E}if(this.urlHandlingStrategy.shouldProcessUrl(I.rawUrl))return(0,l.of)(I).pipe((0,ct.w)(z=>{const Q=this.transitions?.getValue();return this.events.next(new St(z.id,this.urlSerializer.serialize(z.extractedUrl),z.source,z.restoredState)),Q!==this.transitions?.getValue()?de.E:Promise.resolve(z)}),function yn(S,u,n,a,p,y){return(0,De.z)(x=>function Zc(S,u,n,a,p,y,x="emptyOnly"){return new Ga(S,u,n,a,p,x,y).recognize()}(S,u,n,a,x.extractedUrl,p,y).pipe((0,Ue.U)(({state:D,tree:I})=>({...x,targetSnapshot:D,urlAfterRedirects:I}))))}(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),We(z=>{y.targetSnapshot=z.targetSnapshot,y.urlAfterRedirects=z.urlAfterRedirects,this.currentNavigation={...this.currentNavigation,finalUrl:z.urlAfterRedirects};const Q=new Wt(z.id,this.urlSerializer.serialize(z.extractedUrl),this.urlSerializer.serialize(z.urlAfterRedirects),z.targetSnapshot);this.events.next(Q)}));if(R&&this.urlHandlingStrategy.shouldProcessUrl(I.currentRawUrl)){const{id:z,extractedUrl:Q,source:Se,restoredState:je,extras:Ye}=I,$e=new St(z,this.urlSerializer.serialize(Q),Se,je);this.events.next($e);const et=Bs(this.rootComponentType).snapshot;return this.currentTransition=y={...I,targetSnapshot:et,urlAfterRedirects:Q,extras:{...Ye,skipLocationChange:!1,replaceUrl:!1}},this.currentNavigation.finalUrl=Q,(0,l.of)(y)}{const z="";return this.events.next(new Xe(I.id,this.urlSerializer.serialize(I.extractedUrl),z,V.IgnoredByUrlHandlingStrategy)),I.resolve(null),de.E}}),We(I=>{const R=new tn(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot);this.events.next(R)}),(0,Ue.U)(I=>(this.currentTransition=y={...I,guards:Qo(I.targetSnapshot,I.currentSnapshot,this.rootContexts)},y)),function js(S,u){return(0,De.z)(n=>{const{targetSnapshot:a,currentSnapshot:p,guards:{canActivateChecks:y,canDeactivateChecks:x}}=n;return 0===x.length&&0===y.length?(0,l.of)({...n,guardsResult:!0}):function wl(S,u,n,a){return(0,te.D)(S).pipe((0,De.z)(p=>function ma(S,u,n,a,p){const y=u&&u.routeConfig?u.routeConfig.canDeactivate:null;if(!y||0===y.length)return(0,l.of)(!0);const x=y.map(D=>{const I=ea(u)??p,R=re(D,I);return wn(function Do(S){return S&&ni(S.canDeactivate)}(R)?R.canDeactivate(S,u,n,a):(0,h.r_H)(I,()=>R(S,u,n,a))).pipe(_n())});return(0,l.of)(x).pipe(Ui())}(p.component,p.route,n,u,a)),_n(p=>!0!==p,!0))}(x,a,p,S).pipe((0,De.z)(D=>D&&function Ln(S){return"boolean"==typeof S}(D)?function No(S,u,n,a){return(0,te.D)(u).pipe((0,Ut.b)(p=>(0,fe.z)(function ws(S,u){return null!==S&&u&&u(new fi(S)),(0,l.of)(!0)}(p.route.parent,a),function kr(S,u){return null!==S&&u&&u(new Vi(S)),(0,l.of)(!0)}(p.route,a),function Vs(S,u,n){const a=u[u.length-1],y=u.slice(0,u.length-1).reverse().map(x=>function Ao(S){const u=S.routeConfig?S.routeConfig.canActivateChild:null;return u&&0!==u.length?{node:S,guards:u}:null}(x)).filter(x=>null!==x).map(x=>(0,Pe.P)(()=>{const D=x.guards.map(I=>{const R=ea(x.node)??n,U=re(I,R);return wn(function Oo(S){return S&&ni(S.canActivateChild)}(U)?U.canActivateChild(a,S):(0,h.r_H)(R,()=>U(a,S))).pipe(_n())});return(0,l.of)(D).pipe(Ui())}));return(0,l.of)(y).pipe(Ui())}(S,p.path,n),function pa(S,u,n){const a=u.routeConfig?u.routeConfig.canActivate:null;if(!a||0===a.length)return(0,l.of)(!0);const p=a.map(y=>(0,Pe.P)(()=>{const x=ea(u)??n,D=re(y,x);return wn(function zr(S){return S&&ni(S.canActivate)}(D)?D.canActivate(u,S):(0,h.r_H)(x,()=>D(u,S))).pipe(_n())}));return(0,l.of)(p).pipe(Ui())}(S,p.route,n))),_n(p=>!0!==p,!0))}(a,y,S,u):(0,l.of)(D)),(0,Ue.U)(D=>({...n,guardsResult:D})))})}(this.environmentInjector,I=>this.events.next(I)),We(I=>{if(y.guardsResult=I.guardsResult,hr(I.guardsResult))throw Ba(0,I.guardsResult);const R=new vn(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects),I.targetSnapshot,!!I.guardsResult);this.events.next(R)}),(0,Fe.h)(I=>!!I.guardsResult||(this.cancelNavigationTransition(I,"",jn.GuardRejected),!1)),ir(I=>{if(I.guards.canActivateChecks.length)return(0,l.of)(I).pipe(We(R=>{const U=new Vn(R.id,this.urlSerializer.serialize(R.extractedUrl),this.urlSerializer.serialize(R.urlAfterRedirects),R.targetSnapshot);this.events.next(U)}),(0,ct.w)(R=>{let U=!1;return(0,l.of)(R).pipe(function xn(S,u){return(0,De.z)(n=>{const{targetSnapshot:a,guards:{canActivateChecks:p}}=n;if(!p.length)return(0,l.of)(n);const y=new Set(p.map(I=>I.route)),x=new Set;for(const I of y)if(!x.has(I))for(const R of xi(I))x.add(R);let D=0;return(0,te.D)(x).pipe((0,Ut.b)(I=>y.has(I)?function Jr(S,u,n,a){const p=S.routeConfig,y=S._resolve;return void 0!==p?.title&&!vo(p)&&(y[lt]=p.title),function Pr(S,u,n,a){const p=Ve(S);if(0===p.length)return(0,l.of)({});const y={};return(0,te.D)(p).pipe((0,De.z)(x=>function xr(S,u,n,a){const p=ea(u)??a,y=re(S,p);return wn(y.resolve?y.resolve(u,n):(0,h.r_H)(p,()=>y(u,n)))}(S[x],u,n,a).pipe(_n(),We(D=>{y[x]=D}))),mt(1),function tt(S){return(0,Ue.U)(()=>S)}(y),ke(x=>xo(x)?de.E:Me(x)))}(y,S,u,a).pipe((0,Ue.U)(x=>(S._resolvedData=x,S.data=$o(S,S.parent,n).resolve,null)))}(I,a,S,u):(I.data=$o(I,I.parent,S).resolve,(0,l.of)(void 0))),We(()=>D++),mt(1),(0,De.z)(I=>D===x.size?(0,l.of)(n):de.E))})}(this.paramsInheritanceStrategy,this.environmentInjector),We({next:()=>U=!0,complete:()=>{U||this.cancelNavigationTransition(R,"",jn.NoDataFromResolver)}}))}),We(R=>{const U=new $n(R.id,this.urlSerializer.serialize(R.extractedUrl),this.urlSerializer.serialize(R.urlAfterRedirects),R.targetSnapshot);this.events.next(U)}))}),ir(I=>{const R=U=>{const z=[];U.routeConfig?.loadComponent&&!U.routeConfig._loadedComponent&&z.push(this.configLoader.loadComponent(U.routeConfig).pipe(We(Q=>{U.component=Q}),(0,Ue.U)(()=>{})));for(const Q of U.children)z.push(...R(Q));return z};return(0,Y.a)(R(I.targetSnapshot.root)).pipe(ze(null),(0,X.q)(1))}),ir(()=>this.afterPreactivation()),(0,ct.w)(()=>{const{currentSnapshot:I,targetSnapshot:R}=y,U=this.createViewTransition?.(this.environmentInjector,I.root,R.root);return U?(0,te.D)(U).pipe((0,Ue.U)(()=>y)):(0,l.of)(y)}),(0,Ue.U)(I=>{const R=function vs(S,u,n){const a=Ko(S,u._root,n?n._root:void 0);return new eo(a,u)}(n.routeReuseStrategy,I.targetSnapshot,I.currentRouterState);return this.currentTransition=y={...I,targetRouterState:R},this.currentNavigation.targetRouterState=R,y}),We(()=>{this.events.next(new Oe)}),((S,u,n,a)=>(0,Ue.U)(p=>(new nr(u,p.targetRouterState,p.currentRouterState,n,a).activate(S),p)))(this.rootContexts,n.routeReuseStrategy,I=>this.events.next(I),this.inputBindingEnabled),(0,X.q)(1),We({next:I=>{x=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new en(I.id,this.urlSerializer.serialize(I.extractedUrl),this.urlSerializer.serialize(I.urlAfterRedirects))),this.titleStrategy?.updateTitle(I.targetRouterState.snapshot),I.resolve(!0)},complete:()=>{x=!0}}),function bn(S){return(0,Ce.e)((u,n)=>{(0,Ne.Xf)(S).subscribe((0,oe.x)(n,()=>n.complete(),Xt.Z)),!n.closed&&u.subscribe(n)})}(this.transitionAbortSubject.pipe(We(I=>{throw I}))),(0,pt.x)(()=>{!x&&!D&&this.cancelNavigationTransition(y,"",jn.SupersededByNewNavigation),this.currentNavigation?.id===y.id&&(this.currentNavigation=null)}),ke(I=>{if(D=!0,za(I))this.events.next(new ue(y.id,this.urlSerializer.serialize(y.extractedUrl),I.message,I.cancellationCode)),function Wi(S){return za(S)&&hr(S.url)}(I)?this.events.next(new $(I.url)):y.resolve(!1);else{this.events.next(new _t(y.id,this.urlSerializer.serialize(y.extractedUrl),I,y.targetSnapshot??void 0));try{y.resolve(n.errorHandler(I))}catch(R){this.options.resolveNavigationPromiseOnError?y.resolve(!1):y.reject(R)}}return de.E}))}))}cancelNavigationTransition(n,a,p){const y=new ue(n.id,this.urlSerializer.serialize(n.extractedUrl),a,p);this.events.next(y),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){return this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))).toString()!==this.currentTransition?.extractedUrl.toString()&&!this.currentTransition?.extras.skipLocationChange}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})();function Jl(S){return S!==Be}let Zr=(()=>{class S{static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:()=>(0,h.f3M)(Kl),providedIn:"root"})}return S})();class Dl{shouldDetach(u){return!1}store(u,n){}shouldAttach(u){return!1}retrieve(u){return null}shouldReuseRoute(u,n){return u.routeConfig===n.routeConfig}}let Kl=(()=>{class S extends Dl{static#e=this.\u0275fac=(()=>{let n;return function(p){return(n||(n=h.n5z(S)))(p||S)}})();static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})(),Xl=(()=>{class S{static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:()=>(0,h.f3M)(yc),providedIn:"root"})}return S})(),yc=(()=>{class S extends Xl{constructor(){super(...arguments),this.location=(0,h.f3M)(ye.Ye),this.urlSerializer=(0,h.f3M)(ot),this.options=(0,h.f3M)(so,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=(0,h.f3M)(zo),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Fn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Bs(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return"computed"!==this.canceledNavigationResolution?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(a=>{"popstate"===a.type&&n(a.url,a.state)})}handleRouterEvent(n,a){if(n instanceof St)this.stateMemento=this.createStateMemento();else if(n instanceof Xe)this.rawUrlTree=a.initialUrl;else if(n instanceof Wt){if("eager"===this.urlUpdateStrategy&&!a.extras.skipLocationChange){const p=this.urlHandlingStrategy.merge(a.finalUrl,a.initialUrl);this.setBrowserUrl(p,a)}}else n instanceof Oe?(this.currentUrlTree=a.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(a.finalUrl,a.initialUrl),this.routerState=a.targetRouterState,"deferred"===this.urlUpdateStrategy&&(a.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,a))):n instanceof ue&&(n.code===jn.GuardRejected||n.code===jn.NoDataFromResolver)?this.restoreHistory(a):n instanceof _t?this.restoreHistory(a,!0):n instanceof en&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,a){const p=this.urlSerializer.serialize(n);if(this.location.isCurrentPathEqualTo(p)||a.extras.replaceUrl){const x={...a.extras.state,...this.generateNgRouterState(a.id,this.browserPageId)};this.location.replaceState(p,"",x)}else{const y={...a.extras.state,...this.generateNgRouterState(a.id,this.browserPageId+1)};this.location.go(p,"",y)}}restoreHistory(n,a=!1){if("computed"===this.canceledNavigationResolution){const y=this.currentPageId-this.browserPageId;0!==y?this.location.historyGo(y):this.currentUrlTree===n.finalUrl&&0===y&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else"replace"===this.canceledNavigationResolution&&(a&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,a){return"computed"===this.canceledNavigationResolution?{navigationId:n,\u0275routerPageId:a}:{navigationId:n}}static#e=this.\u0275fac=(()=>{let n;return function(p){return(n||(n=h.n5z(S)))(p||S)}})();static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})();var Ql=function(S){return S[S.COMPLETE=0]="COMPLETE",S[S.FAILED=1]="FAILED",S[S.REDIRECTING=2]="REDIRECTING",S}(Ql||{});function Fr(S,u){S.events.pipe((0,Fe.h)(n=>n instanceof en||n instanceof ue||n instanceof _t||n instanceof Xe),(0,Ue.U)(n=>n instanceof en||n instanceof Xe?Ql.COMPLETE:n instanceof ue&&(n.code===jn.Redirect||n.code===jn.SupersededByNewNavigation)?Ql.REDIRECTING:Ql.FAILED),(0,Fe.h)(n=>n!==Ql.REDIRECTING),(0,X.q)(1)).subscribe(()=>{u()})}function Ha(S){throw S}const ll={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},ts={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Ds=(()=>{class S{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.isNgZoneEnabled=!1,this.console=(0,h.f3M)(h.c2e),this.stateManager=(0,h.f3M)(Xl),this.options=(0,h.f3M)(so,{optional:!0})||{},this.pendingTasks=(0,h.f3M)(h.I6F),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=(0,h.f3M)(ga),this.urlSerializer=(0,h.f3M)(ot),this.location=(0,h.f3M)(ye.Ye),this.urlHandlingStrategy=(0,h.f3M)(zo),this._events=new Ae.x,this.errorHandler=this.options.errorHandler||Ha,this.navigated=!1,this.routeReuseStrategy=(0,h.f3M)(Zr),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=(0,h.f3M)(Bo,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!(0,h.f3M)(Po,{optional:!0}),this.eventsSubscription=new nt.w0,this.isNgZoneEnabled=(0,h.f3M)(h.R0b)instanceof h.R0b&&h.R0b.isInAngularZone(),this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){const n=this.navigationTransitions.events.subscribe(a=>{try{const p=this.navigationTransitions.currentTransition,y=this.navigationTransitions.currentNavigation;if(null!==p&&null!==y)if(this.stateManager.handleRouterEvent(a,y),a instanceof ue&&a.code!==jn.Redirect&&a.code!==jn.SupersededByNewNavigation)this.navigated=!0;else if(a instanceof en)this.navigated=!0;else if(a instanceof $){const x=this.urlHandlingStrategy.merge(a.url,p.currentRawUrl),D={info:p.extras.info,skipLocationChange:p.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||Jl(p.source)};this.scheduleNavigation(x,Be,null,D,{resolve:p.resolve,reject:p.reject,promise:p.promise})}(function Wa(S){return!(S instanceof Oe||S instanceof $)})(a)&&this._events.next(a)}catch(p){this.navigationTransitions.transitionAbortSubject.next(p)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),Be,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,a)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",a)},0)})}navigateToSyncWithBrowser(n,a,p){const y={replaceUrl:!0},x=p?.navigationId?p:null;if(p){const I={...p};delete I.navigationId,delete I.\u0275routerPageId,0!==Object.keys(I).length&&(y.state=I)}const D=this.parseUrl(n);this.scheduleNavigation(D,a,x,y)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Ea),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,a={}){const{relativeTo:p,queryParams:y,fragment:x,queryParamsHandling:D,preserveFragment:I}=a,R=I?this.currentUrlTree.fragment:x;let z,U=null;switch(D){case"merge":U={...this.currentUrlTree.queryParams,...y};break;case"preserve":U=this.currentUrlTree.queryParams;break;default:U=y||null}null!==U&&(U=this.removeEmptyProps(U));try{z=yo(p?p.snapshot:this.routerState.snapshot.root)}catch{("string"!=typeof n[0]||!n[0].startsWith("/"))&&(n=[]),z=this.currentUrlTree.root}return vr(z,n,U,R??null)}navigateByUrl(n,a={skipLocationChange:!1}){const p=hr(n)?n:this.parseUrl(n),y=this.urlHandlingStrategy.merge(p,this.rawUrlTree);return this.scheduleNavigation(y,Be,null,a)}navigate(n,a={skipLocationChange:!1}){return function _a(S){for(let u=0;u<S.length;u++)if(null==S[u])throw new h.vHH(4008,!1)}(n),this.navigateByUrl(this.createUrlTree(n,a),a)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,a){let p;if(p=!0===a?{...ll}:!1===a?{...ts}:a,hr(n))return Lr(this.currentUrlTree,n,p);const y=this.parseUrl(n);return Lr(this.currentUrlTree,y,p)}removeEmptyProps(n){return Object.entries(n).reduce((a,[p,y])=>(null!=y&&(a[p]=y),a),{})}scheduleNavigation(n,a,p,y,x){if(this.disposed)return Promise.resolve(!1);let D,I,R;x?(D=x.resolve,I=x.reject,R=x.promise):R=new Promise((z,Q)=>{D=z,I=Q});const U=this.pendingTasks.add();return Fr(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(U))}),this.navigationTransitions.handleNavigationRequest({source:a,restoredState:p,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:y,resolve:D,reject:I,promise:R,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),R.catch(z=>Promise.reject(z))}static#e=this.\u0275fac=function(a){return new(a||S)};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})(),Lo=(()=>{class S{constructor(n,a,p,y,x,D){this.router=n,this.route=a,this.tabIndexAttribute=p,this.renderer=y,this.el=x,this.locationStrategy=D,this.href=null,this.commands=null,this.onChanges=new Ae.x,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1;const I=x.nativeElement.tagName?.toLowerCase();this.isAnchorElement="a"===I||"area"===I,this.isAnchorElement?this.subscription=n.events.subscribe(R=>{R instanceof en&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){null!=this.tabIndexAttribute||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){null!=n?(this.commands=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0")):(this.commands=null,this.setTabIndexIfNotOnNativeEl(null))}onClick(n,a,p,y,x){return!!(null===this.urlTree||this.isAnchorElement&&(0!==n||a||p||y||x||"string"==typeof this.target&&"_self"!=this.target))||(this.router.navigateByUrl(this.urlTree,{skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info}),!this.isAnchorElement)}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){this.href=null!==this.urlTree&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(this.urlTree)):null;const n=null===this.href?null:(0,h.P3R)(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",n)}applyAttributeValue(n,a){const p=this.renderer,y=this.el.nativeElement;null!==a?p.setAttribute(y,n,a):p.removeAttribute(y,n)}get urlTree(){return null===this.commands?null:this.router.createUrlTree(this.commands,{relativeTo:void 0!==this.relativeTo?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static#e=this.\u0275fac=function(a){return new(a||S)(h.Y36(Ds),h.Y36(To),h.$8M("tabindex"),h.Y36(h.Qsj),h.Y36(h.SBq),h.Y36(ye.S$))};static#t=this.\u0275dir=h.lG2({type:S,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(a,p){1&a&&h.NdJ("click",function(x){return p.onClick(x.button,x.ctrlKey,x.shiftKey,x.altKey,x.metaKey)}),2&a&&h.uIk("target",p.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[h.lbL.HasDecoratorInputTransform,"preserveFragment","preserveFragment",h.VuI],skipLocationChange:[h.lbL.HasDecoratorInputTransform,"skipLocationChange","skipLocationChange",h.VuI],replaceUrl:[h.lbL.HasDecoratorInputTransform,"replaceUrl","replaceUrl",h.VuI],routerLink:"routerLink"},standalone:!0,features:[h.Xq5,h.TTD]})}return S})();class Ml{}let Iu=(()=>{class S{constructor(n,a,p,y,x){this.router=n,this.injector=p,this.preloadingStrategy=y,this.loader=x}setUpPreloading(){this.subscription=this.router.events.pipe((0,Fe.h)(n=>n instanceof en),(0,Ut.b)(()=>this.preload())).subscribe(()=>{})}preload(){return this.processRoutes(this.injector,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(n,a){const p=[];for(const y of a){y.providers&&!y._injector&&(y._injector=(0,h.MMx)(y.providers,n,`Route: ${y.path}`));const x=y._injector??n,D=y._loadedInjector??x;(y.loadChildren&&!y._loadedRoutes&&void 0===y.canLoad||y.loadComponent&&!y._loadedComponent)&&p.push(this.preloadConfig(x,y)),(y.children||y._loadedRoutes)&&p.push(this.processRoutes(D,y.children??y._loadedRoutes))}return(0,te.D)(p).pipe((0,Cn.J)())}preloadConfig(n,a){return this.preloadingStrategy.preload(a,()=>{let p;p=a.loadChildren&&void 0===a.canLoad?this.loader.loadChildren(n,a):(0,l.of)(null);const y=p.pipe((0,De.z)(x=>null===x?(0,l.of)(void 0):(a._loadedRoutes=x.routes,a._loadedInjector=x.injector,this.processRoutes(x.injector??n,x.routes))));if(a.loadComponent&&!a._loadedComponent){const x=this.loader.loadComponent(a);return(0,te.D)([y,x]).pipe((0,Cn.J)())}return y})}static#e=this.\u0275fac=function(a){return new(a||S)(h.LFG(Ds),h.LFG(h.Sil),h.LFG(h.lqb),h.LFG(Ml),h.LFG(ao))};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac,providedIn:"root"})}return S})();const Al=new h.OlP("");let vc=(()=>{class S{constructor(n,a,p,y,x={}){this.urlSerializer=n,this.transitions=a,this.viewportScroller=p,this.zone=y,this.options=x,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},x.scrollPositionRestoration||="disabled",x.anchorScrolling||="disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof St?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=n.navigationTrigger,this.restoredId=n.restoredState?n.restoredState.navigationId:0):n instanceof en?(this.lastId=n.id,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.urlAfterRedirects).fragment)):n instanceof Xe&&n.code===V.IgnoredSameUrlNavigation&&(this.lastSource=void 0,this.restoredId=0,this.scheduleScrollEvent(n,this.urlSerializer.parse(n.url).fragment))})}consumeScrollEvents(){return this.transitions.events.subscribe(n=>{n instanceof O&&(n.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(n.position):n.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(n.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(n,a){this.zone.runOutsideAngular(()=>{setTimeout(()=>{this.zone.run(()=>{this.transitions.events.next(new O(n,"popstate"===this.lastSource?this.store[this.restoredId]:null,a))})},0)})}ngOnDestroy(){this.routerEventsSubscription?.unsubscribe(),this.scrollEventsSubscription?.unsubscribe()}static#e=this.\u0275fac=function(a){h.$Z()};static#t=this.\u0275prov=h.Yz7({token:S,factory:S.\u0275fac})}return S})();function hs(S,u){return{\u0275kind:S,\u0275providers:u}}function Au(){const S=(0,h.f3M)(h.zs3);return u=>{const n=S.get(h.z2F);if(u!==n.components[0])return;const a=S.get(Ds),p=S.get(Uo);1===S.get(qc)&&a.initialNavigation(),S.get(Ms,null,h.XFs.Optional)?.setUpPreloading(),S.get(Al,null,h.XFs.Optional)?.init(),a.resetRootComponentType(n.componentTypes[0]),p.closed||(p.next(),p.complete(),p.unsubscribe())}}const Uo=new h.OlP("",{factory:()=>new Ae.x}),qc=new h.OlP("",{providedIn:"root",factory:()=>1}),Ms=new h.OlP("");function Ou(S){return hs(0,[{provide:Ms,useExisting:Iu},{provide:Ml,useExisting:S}])}function gr(S){return hs(9,[{provide:Da,useValue:Ws},{provide:li,useValue:{skipNextTransition:!!S?.skipInitialTransition,...S}}])}const tc=new h.OlP("ROUTER_FORROOT_GUARD"),Nr=[ye.Ye,{provide:ot,useClass:yt},Ds,Fi,{provide:To,useFactory:function cl(S){return S.routerState.root},deps:[Ds]},ao,[]];let dl=(()=>{class S{constructor(n){}static forRoot(n,a){return{ngModule:S,providers:[Nr,[],{provide:Bo,multi:!0,useValue:n},{provide:tc,useFactory:Yc,deps:[[Ds,new h.FiY,new h.tp0]]},{provide:so,useValue:a||{}},a?.useHash?{provide:ye.S$,useClass:ye.Do}:{provide:ye.S$,useClass:ye.b0},{provide:Al,useFactory:()=>{const S=(0,h.f3M)(ye.EM),u=(0,h.f3M)(h.R0b),n=(0,h.f3M)(so),a=(0,h.f3M)(ga),p=(0,h.f3M)(ot);return n.scrollOffset&&S.setOffset(n.scrollOffset),new vc(p,a,S,u,n)}},a?.preloadingStrategy?Ou(a.preloadingStrategy).\u0275providers:[],a?.initialNavigation?Ru(a):[],a?.bindToComponentInputs?hs(8,[Jo,{provide:Po,useExisting:Jo}]).\u0275providers:[],a?.enableViewTransitions?gr().\u0275providers:[],[{provide:Jc,useFactory:Au},{provide:h.tb,multi:!0,useExisting:Jc}]]}}static forChild(n){return{ngModule:S,providers:[{provide:Bo,multi:!0,useValue:n}]}}static#e=this.\u0275fac=function(a){return new(a||S)(h.LFG(tc,8))};static#t=this.\u0275mod=h.oAB({type:S});static#n=this.\u0275inj=h.cJS({})}return S})();function Yc(S){return"guarded"}function Ru(S){return["disabled"===S.initialNavigation?hs(3,[{provide:h.ip1,multi:!0,useFactory:()=>{const u=(0,h.f3M)(Ds);return()=>{u.setUpLocationChangeListener()}}},{provide:qc,useValue:2}]).\u0275providers:[],"enabledBlocking"===S.initialNavigation?hs(2,[{provide:qc,useValue:0},{provide:h.ip1,multi:!0,deps:[h.zs3],useFactory:u=>{const n=u.get(ye.V_,Promise.resolve());return()=>n.then(()=>new Promise(a=>{const p=u.get(Ds),y=u.get(Uo);Fr(p,()=>{a(!0)}),u.get(ga).afterPreactivation=()=>(a(!0),y.closed?(0,l.of)(void 0):y),p.initialNavigation()}))}}]).\u0275providers:[]]}const Jc=new h.OlP("")},703:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Ar:()=>be,N0:()=>fe});var h=P(9212),m=P(6814),te=P(7398),l=P(1631),B=P(4911),Y=P(2096),C=P(9862);const ie=new h.OlP("JWT_OPTIONS");let fe=(()=>{class Te{constructor(de=null){this.tokenGetter=de&&de.tokenGetter||function(){}}urlBase64Decode(de){let nt=de.replace(/-/g,"+").replace(/_/g,"/");switch(nt.length%4){case 0:break;case 2:nt+="==";break;case 3:nt+="=";break;default:throw new Error("Illegal base64url string!")}return this.b64DecodeUnicode(nt)}b64decode(de){let Ce="";if((de=String(de).replace(/=+$/,"")).length%4==1)throw new Error("'atob' failed: The string to be decoded is not correctly encoded.");for(let xe,Ie,oe=0,Ae=0;Ie=de.charAt(Ae++);~Ie&&(xe=oe%4?64*xe+Ie:Ie,oe++%4)?Ce+=String.fromCharCode(255&xe>>(-2*oe&6)):0)Ie="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(Ie);return Ce}b64DecodeUnicode(de){return decodeURIComponent(Array.prototype.map.call(this.b64decode(de),nt=>"%"+("00"+nt.charCodeAt(0).toString(16)).slice(-2)).join(""))}decodeToken(de=this.tokenGetter()){return de instanceof Promise?de.then(nt=>this._decodeToken(nt)):this._decodeToken(de)}_decodeToken(de){if(!de||""===de)return null;const nt=de.split(".");if(3!==nt.length)throw new Error("The inspected token doesn't appear to be a JWT. Check to make sure it has three parts and see https://jwt.io for more.");const Ce=this.urlBase64Decode(nt[1]);if(!Ce)throw new Error("Cannot decode the token.");return JSON.parse(Ce)}getTokenExpirationDate(de=this.tokenGetter()){return de instanceof Promise?de.then(nt=>this._getTokenExpirationDate(nt)):this._getTokenExpirationDate(de)}_getTokenExpirationDate(de){let nt;if(nt=this.decodeToken(de),!nt||!nt.hasOwnProperty("exp"))return null;const Ce=new Date(0);return Ce.setUTCSeconds(nt.exp),Ce}isTokenExpired(de=this.tokenGetter(),nt){return de instanceof Promise?de.then(Ce=>this._isTokenExpired(Ce,nt)):this._isTokenExpired(de,nt)}_isTokenExpired(de,nt){if(!de||""===de)return!0;const Ce=this.getTokenExpirationDate(de);return nt=nt||0,null!==Ce&&!(Ce.valueOf()>(new Date).valueOf()+1e3*nt)}getAuthScheme(de,nt){return"function"==typeof de?de(nt):de}}return Te.\u0275fac=function(de){return new(de||Te)(h.LFG(ie))},Te.\u0275prov=h.Yz7({token:Te,factory:Te.\u0275fac}),Te})();const Pe=Te=>Te instanceof Promise?(0,B.P)(()=>Te):(0,Y.of)(Te);let K=(()=>{class Te{constructor(de,nt,Ce){this.jwtHelper=nt,this.document=Ce,this.standardPorts=["80","443"],this.tokenGetter=de.tokenGetter,this.headerName=de.headerName||"Authorization",this.authScheme=de.authScheme||""===de.authScheme?de.authScheme:"Bearer ",this.allowedDomains=de.allowedDomains||[],this.disallowedRoutes=de.disallowedRoutes||[],this.throwNoTokenError=de.throwNoTokenError||!1,this.skipWhenExpired=de.skipWhenExpired}isAllowedDomain(de){const nt=new URL(de.url,this.document.location.origin);if(nt.host===this.document.location.host)return!0;const Ce=`${nt.hostname}${nt.port&&!this.standardPorts.includes(nt.port)?":"+nt.port:""}`;return this.allowedDomains.findIndex(oe=>"string"==typeof oe?oe===Ce:oe instanceof RegExp&&oe.test(Ce))>-1}isDisallowedRoute(de){const nt=new URL(de.url,this.document.location.origin);return this.disallowedRoutes.findIndex(Ce=>{if("string"==typeof Ce){const oe=new URL(Ce,this.document.location.origin);return oe.hostname===nt.hostname&&oe.pathname===nt.pathname}return Ce instanceof RegExp&&Ce.test(de.url)})>-1}handleInterception(de,nt,Ce){const oe=this.jwtHelper.getAuthScheme(this.authScheme,nt);if(!de&&this.throwNoTokenError)throw new Error("Could not get token from tokenGetter function.");let xe=(0,Y.of)(!1);return this.skipWhenExpired&&(xe=de?Pe(this.jwtHelper.isTokenExpired(de)):(0,Y.of)(!0)),de?xe.pipe((0,te.U)(Ie=>Ie&&this.skipWhenExpired?nt.clone():nt.clone({setHeaders:{[this.headerName]:`${oe}${de}`}})),(0,l.z)(Ie=>Ce.handle(Ie))):Ce.handle(nt)}intercept(de,nt){if(!this.isAllowedDomain(de)||this.isDisallowedRoute(de))return nt.handle(de);const Ce=this.tokenGetter(de);return Pe(Ce).pipe((0,l.z)(oe=>this.handleInterception(oe,de,nt)))}}return Te.\u0275fac=function(de){return new(de||Te)(h.LFG(ie),h.LFG(fe),h.LFG(m.K0))},Te.\u0275prov=h.Yz7({token:Te,factory:Te.\u0275fac}),Te})(),be=(()=>{class Te{constructor(de){if(de)throw new Error("JwtModule is already loaded. It should only be imported in your application's main module.")}static forRoot(de){return{ngModule:Te,providers:[{provide:C.TP,useClass:K,multi:!0},de.jwtOptionsProvider||{provide:ie,useValue:de.config},fe]}}}return Te.\u0275fac=function(de){return new(de||Te)(h.LFG(Te,12))},Te.\u0275mod=h.oAB({type:Te}),Te.\u0275inj=h.cJS({}),Te})()},7346:(Bn,Ct,P)=>{"use strict";P.d(Ct,{y4:()=>Fn,De:()=>Ei,dy:()=>fn,oU:()=>Yr,ki:()=>Z,O1:()=>ln,d8:()=>Gn,jP:()=>Eo,UN:()=>vt,r4:()=>_i,SH:()=>di,X1:()=>gn,xs:()=>or,t4:()=>Kt,j:()=>qi,H:()=>Qe,bk:()=>On,DN:()=>yo,Wn:()=>Hn,vk:()=>Kn});var h=P(5861),m=P(9212),te=P(6800),l=P(6814);class B{constructor(){this.m=new Map}reset(Be){this.m=new Map(Object.entries(Be))}get(Be,ee){const qe=this.m.get(Be);return void 0!==qe?qe:ee}getBoolean(Be,ee=!1){const qe=this.m.get(Be);return void 0===qe?ee:"string"==typeof qe?"true"===qe:!!qe}getNumber(Be,ee){const qe=parseFloat(this.m.get(Be));return isNaN(qe)?void 0!==ee?ee:NaN:qe}set(Be,ee){this.m.set(Be,ee)}}const Y=new B,Te=Ee=>de(Ee),de=(Ee=window)=>{if(typeof Ee>"u")return[];Ee.Ionic=Ee.Ionic||{};let Be=Ee.Ionic.platforms;return null==Be&&(Be=Ee.Ionic.platforms=nt(Ee),Be.forEach(ee=>Ee.document.documentElement.classList.add(`plt-${ee}`))),Be},nt=Ee=>{const Be=Y.get("platform");return Object.keys(_n).filter(ee=>{const qe=Be?.[ee];return"function"==typeof qe?qe(Ee):_n[ee](Ee)})},oe=Ee=>!!(Ht(Ee,/iPad/i)||Ht(Ee,/Macintosh/i)&&X(Ee)),Ae=Ee=>Ht(Ee,/android|sink/i),X=Ee=>dn(Ee,"(any-pointer:coarse)"),me=Ee=>Fe(Ee)||De(Ee),Fe=Ee=>!!(Ee.cordova||Ee.phonegap||Ee.PhoneGap),De=Ee=>{const Be=Ee.Capacitor;return!!Be?.isNative},Ht=(Ee,Be)=>Be.test(Ee.navigator.userAgent),dn=(Ee,Be)=>{var ee;return null===(ee=Ee.matchMedia)||void 0===ee?void 0:ee.call(Ee,Be).matches},_n={ipad:oe,iphone:Ee=>Ht(Ee,/iPhone/i),ios:Ee=>Ht(Ee,/iPhone|iPod/i)||oe(Ee),android:Ae,phablet:Ee=>{const Be=Ee.innerWidth,ee=Ee.innerHeight,qe=Math.min(Be,ee),St=Math.max(Be,ee);return qe>390&&qe<520&&St>620&&St<800},tablet:Ee=>{const Be=Ee.innerWidth,ee=Ee.innerHeight,qe=Math.min(Be,ee),St=Math.max(Be,ee);return oe(Ee)||(Ee=>Ae(Ee)&&!Ht(Ee,/mobile/i))(Ee)||qe>460&&qe<820&&St>780&&St<1400},cordova:Fe,capacitor:De,electron:Ee=>Ht(Ee,/electron/i),pwa:Ee=>{var Be;return!!(null!==(Be=Ee.matchMedia)&&void 0!==Be&&Be.call(Ee,"(display-mode: standalone)").matches||Ee.navigator.standalone)},mobile:X,mobileweb:Ee=>X(Ee)&&!me(Ee),desktop:Ee=>!X(Ee),hybrid:me};var ke=P(191),it=P(3630),Qt=P(8645),mt=P(2438),an=P(5619),tt=P(2572),pt=P(2096),Xt=P(7582),bn=P(2181),Cn=P(4664),It=P(2737),pe=P(9360),lt=P(8251);function hn(Ee,Be){return Ee===Be}var Yt=P(6223);const Ft=["tabsInner"];let Kt=(()=>{class Ee{constructor(ee,qe){this.doc=ee,this.backButton=new Qt.x,this.keyboardDidShow=new Qt.x,this.keyboardDidHide=new Qt.x,this.pause=new Qt.x,this.resume=new Qt.x,this.resize=new Qt.x,qe.run(()=>{let St;this.win=ee.defaultView,this.backButton.subscribeWithPriority=function(en,jn){return this.subscribe(V=>V.register(en,ue=>qe.run(()=>jn(ue))))},ei(this.pause,ee,"pause",qe),ei(this.resume,ee,"resume",qe),ei(this.backButton,ee,"ionBackButton",qe),ei(this.resize,this.win,"resize",qe),ei(this.keyboardDidShow,this.win,"ionKeyboardDidShow",qe),ei(this.keyboardDidHide,this.win,"ionKeyboardDidHide",qe),this._readyPromise=new Promise(en=>{St=en}),this.win?.cordova?ee.addEventListener("deviceready",()=>{St("cordova")},{once:!0}):St("dom")})}is(ee){return((Ee,Be)=>("string"==typeof Ee&&(Be=Ee,Ee=void 0),Te(Ee).includes(Be)))(this.win,ee)}platforms(){return Te(this.win)}ready(){return this._readyPromise}get isRTL(){return"rtl"===this.doc.dir}getQueryParam(ee){return wn(this.win.location.href,ee)}isLandscape(){return!this.isPortrait()}isPortrait(){return this.win.matchMedia?.("(orientation: portrait)").matches}testUserAgent(ee){const qe=this.win.navigator;return!!(qe?.userAgent&&qe.userAgent.indexOf(ee)>=0)}url(){return this.win.location.href}width(){return this.win.innerWidth}height(){return this.win.innerHeight}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.LFG(l.K0),m.LFG(m.R0b))},Ee.\u0275prov=m.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})();const wn=(Ee,Be)=>{Be=Be.replace(/[[\]\\]/g,"\\$&");const qe=new RegExp("[\\?&]"+Be+"=([^&#]*)").exec(Ee);return qe?decodeURIComponent(qe[1].replace(/\+/g," ")):null},ei=(Ee,Be,ee,qe)=>{Be&&Be.addEventListener(ee,St=>{qe.run(()=>{const en=St?.detail;Ee.next(en)})})};let di=(()=>{class Ee{constructor(ee,qe,St,en){this.location=qe,this.serializer=St,this.router=en,this.direction=Mi,this.animated=dr,this.guessDirection="forward",this.lastNavId=-1,en&&en.events.subscribe(jn=>{if(jn instanceof te.OD){const V=jn.restoredState?jn.restoredState.navigationId:jn.id;this.guessDirection=V<this.lastNavId?"back":"forward",this.guessAnimation=jn.restoredState?void 0:this.guessDirection,this.lastNavId="forward"===this.guessDirection?jn.id:V}}),ee.backButton.subscribeWithPriority(0,jn=>{this.pop(),jn()})}navigateForward(ee,qe={}){return this.setDirection("forward",qe.animated,qe.animationDirection,qe.animation),this.navigate(ee,qe)}navigateBack(ee,qe={}){return this.setDirection("back",qe.animated,qe.animationDirection,qe.animation),this.navigate(ee,qe)}navigateRoot(ee,qe={}){return this.setDirection("root",qe.animated,qe.animationDirection,qe.animation),this.navigate(ee,qe)}back(ee={animated:!0,animationDirection:"back"}){return this.setDirection("back",ee.animated,ee.animationDirection,ee.animation),this.location.back()}pop(){var ee=this;return(0,h.Z)(function*(){let qe=ee.topOutlet;for(;qe;){if(yield qe.pop())return!0;qe=qe.parentOutlet}return!1})()}setDirection(ee,qe,St,en){this.direction=ee,this.animated=Lr(ee,qe,St),this.animationBuilder=en}setTopOutlet(ee){this.topOutlet=ee}consumeTransition(){let qe,ee="root";const St=this.animationBuilder;return"auto"===this.direction?(ee=this.guessDirection,qe=this.guessAnimation):(qe=this.animated,ee=this.direction),this.direction=Mi,this.animated=dr,this.animationBuilder=void 0,{direction:ee,animation:qe,animationBuilder:St}}navigate(ee,qe){if(Array.isArray(ee))return this.router.navigate(ee,qe);{const St=this.serializer.parse(ee.toString());return void 0!==qe.queryParams&&(St.queryParams={...qe.queryParams}),void 0!==qe.fragment&&(St.fragment=qe.fragment),this.router.navigateByUrl(St,qe)}}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.LFG(Kt),m.LFG(l.Ye),m.LFG(te.Hx),m.LFG(te.F0,8))},Ee.\u0275prov=m.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})();const Lr=(Ee,Be,ee)=>{if(!1!==Be){if(void 0!==ee)return ee;if("forward"===Ee||"back"===Ee)return Ee;if("root"===Ee&&!0===Be)return"forward"}},Mi="auto",dr=void 0;let Ei=(()=>{class Ee{get(ee,qe){const St=Li();return St?St.get(ee,qe):null}getBoolean(ee,qe){const St=Li();return!!St&&St.getBoolean(ee,qe)}getNumber(ee,qe){const St=Li();return St?St.getNumber(ee,qe):0}}return Ee.\u0275fac=function(ee){return new(ee||Ee)},Ee.\u0275prov=m.Yz7({token:Ee,factory:Ee.\u0275fac,providedIn:"root"}),Ee})();const fn=new m.OlP("USERCONFIG"),Li=()=>{if(typeof window<"u"){const Ee=window.Ionic;if(Ee?.config)return Ee.config}return null};class gn{constructor(Be={}){this.data=Be}get(Be){return this.data[Be]}}let Fn=(()=>{class Ee{constructor(){this.zone=(0,m.f3M)(m.R0b),this.applicationRef=(0,m.f3M)(m.z2F)}create(ee,qe,St){return new Jt(ee,qe,this.applicationRef,this.zone,St)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)},Ee.\u0275prov=m.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();class Jt{constructor(Be,ee,qe,St,en){this.environmentInjector=Be,this.injector=ee,this.applicationRef=qe,this.zone=St,this.elementReferenceKey=en,this.elRefMap=new WeakMap,this.elEventsMap=new WeakMap}attachViewToDom(Be,ee,qe,St){return this.zone.run(()=>new Promise(en=>{const jn={...qe};void 0!==this.elementReferenceKey&&(jn[this.elementReferenceKey]=Be),en(Bi(this.zone,this.environmentInjector,this.injector,this.applicationRef,this.elRefMap,this.elEventsMap,Be,ee,jn,St,this.elementReferenceKey))}))}removeViewFromDom(Be,ee){return this.zone.run(()=>new Promise(qe=>{const St=this.elRefMap.get(ee);if(St){St.destroy(),this.elRefMap.delete(ee);const en=this.elEventsMap.get(ee);en&&(en(),this.elEventsMap.delete(ee))}qe()}))}}const Bi=(Ee,Be,ee,qe,St,en,jn,V,ue,Xe,_t)=>{const Wt=m.zs3.create({providers:ot(ue),parent:ee}),tn=(0,m.LMc)(V,{environmentInjector:Be,elementInjector:Wt}),vn=tn.instance,Vn=tn.location.nativeElement;if(ue&&(_t&&void 0!==vn[_t]&&console.error(`[Ionic Error]: ${_t} is a reserved property when using ${jn.tagName.toLowerCase()}. Rename or remove the "${_t}" property from ${V.name}.`),Object.assign(vn,ue)),Xe)for(const Xn of Xe)Vn.classList.add(Xn);const $n=he(Ee,vn,Vn);return jn.appendChild(Vn),qe.attachView(tn.hostView),St.set(Vn,tn),en.set(Vn,$n),Vn},ut=[ke.L,ke.a,ke.b,ke.c,ke.d],he=(Ee,Be,ee)=>Ee.run(()=>{const qe=ut.filter(St=>"function"==typeof Be[St]).map(St=>{const en=jn=>Be[St](jn.detail);return ee.addEventListener(St,en),()=>ee.removeEventListener(St,en)});return()=>qe.forEach(St=>St())}),_e=new m.OlP("NavParamsToken"),ot=Ee=>[{provide:_e,useValue:Ee},{provide:gn,useFactory:yt,deps:[_e]}],yt=Ee=>new gn(Ee),Dt=(Ee,Be)=>{const ee=Ee.prototype;Be.forEach(qe=>{Object.defineProperty(ee,qe,{get(){return this.el[qe]},set(St){this.z.runOutsideAngular(()=>this.el[qe]=St)}})})},jt=(Ee,Be)=>{const ee=Ee.prototype;Be.forEach(qe=>{ee[qe]=function(){const St=arguments;return this.z.runOutsideAngular(()=>this.el[qe].apply(this.el,St))}})},Vt=(Ee,Be,ee)=>{ee.forEach(qe=>Ee[qe]=(0,mt.R)(Be,qe))};function dt(Ee){return function(ee){const{defineCustomElementFn:qe,inputs:St,methods:en}=Ee;return void 0!==qe&&qe(),St&&Dt(ee,St),en&&jt(ee,en),ee}}const Bt=["alignment","animated","arrow","keepContentsMounted","backdropDismiss","cssClass","dismissOnSelect","enterAnimation","event","isOpen","keyboardClose","leaveAnimation","mode","showBackdrop","translucent","trigger","triggerAction","reference","size","side"],Nn=["present","dismiss","onDidDismiss","onWillDismiss"];let Gn=(()=>{let Ee=class{constructor(ee,qe,St){this.z=St,this.isCmpOpen=!1,this.el=qe.nativeElement,this.el.addEventListener("ionMount",()=>{this.isCmpOpen=!0,ee.detectChanges()}),this.el.addEventListener("didDismiss",()=>{this.isCmpOpen=!1,ee.detectChanges()}),Vt(this,this.el,["ionPopoverDidPresent","ionPopoverWillPresent","ionPopoverWillDismiss","ionPopoverDidDismiss","didPresent","willPresent","willDismiss","didDismiss"])}};return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(m.sBO),m.Y36(m.SBq),m.Y36(m.R0b))},Ee.\u0275dir=m.lG2({type:Ee,selectors:[["ion-popover"]],contentQueries:function(ee,qe,St){if(1&ee&&m.Suo(St,m.Rgc,5),2&ee){let en;m.iGM(en=m.CRH())&&(qe.template=en.first)}},inputs:{alignment:"alignment",animated:"animated",arrow:"arrow",keepContentsMounted:"keepContentsMounted",backdropDismiss:"backdropDismiss",cssClass:"cssClass",dismissOnSelect:"dismissOnSelect",enterAnimation:"enterAnimation",event:"event",isOpen:"isOpen",keyboardClose:"keyboardClose",leaveAnimation:"leaveAnimation",mode:"mode",showBackdrop:"showBackdrop",translucent:"translucent",trigger:"trigger",triggerAction:"triggerAction",reference:"reference",size:"size",side:"side"}}),Ee=(0,Xt.gn)([dt({inputs:Bt,methods:Nn})],Ee),Ee})();const ae=["animated","keepContentsMounted","backdropBreakpoint","backdropDismiss","breakpoints","canDismiss","cssClass","enterAnimation","event","handle","handleBehavior","initialBreakpoint","isOpen","keyboardClose","leaveAnimation","mode","presentingElement","showBackdrop","translucent","trigger"],ft=["present","dismiss","onDidDismiss","onWillDismiss","setCurrentBreakpoint","getCurrentBreakpoint"];let Z=(()=>{let Ee=class{constructor(ee,qe,St){this.z=St,this.isCmpOpen=!1,this.el=qe.nativeElement,this.el.addEventListener("ionMount",()=>{this.isCmpOpen=!0,ee.detectChanges()}),this.el.addEventListener("didDismiss",()=>{this.isCmpOpen=!1,ee.detectChanges()}),Vt(this,this.el,["ionModalDidPresent","ionModalWillPresent","ionModalWillDismiss","ionModalDidDismiss","ionBreakpointDidChange","didPresent","willPresent","willDismiss","didDismiss"])}};return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(m.sBO),m.Y36(m.SBq),m.Y36(m.R0b))},Ee.\u0275dir=m.lG2({type:Ee,selectors:[["ion-modal"]],contentQueries:function(ee,qe,St){if(1&ee&&m.Suo(St,m.Rgc,5),2&ee){let en;m.iGM(en=m.CRH())&&(qe.template=en.first)}},inputs:{animated:"animated",keepContentsMounted:"keepContentsMounted",backdropBreakpoint:"backdropBreakpoint",backdropDismiss:"backdropDismiss",breakpoints:"breakpoints",canDismiss:"canDismiss",cssClass:"cssClass",enterAnimation:"enterAnimation",event:"event",handle:"handle",handleBehavior:"handleBehavior",initialBreakpoint:"initialBreakpoint",isOpen:"isOpen",keyboardClose:"keyboardClose",leaveAnimation:"leaveAnimation",mode:"mode",presentingElement:"presentingElement",showBackdrop:"showBackdrop",translucent:"translucent",trigger:"trigger"}}),Ee=(0,Xt.gn)([dt({inputs:ae,methods:ft})],Ee),Ee})();const st=(Ee,Be)=>((Ee=Ee.filter(ee=>ee.stackId!==Be.stackId)).push(Be),Ee),bi=(Ee,Be)=>{const ee=Ee.createUrlTree(["."],{relativeTo:Be});return Ee.serializeUrl(ee)},wi=(Ee,Be)=>!Be||Ee.stackId!==Be.stackId,Ri=(Ee,Be)=>{if(!Ee)return;const ee=mr(Be);for(let qe=0;qe<ee.length;qe++){if(qe>=Ee.length)return ee[qe];if(ee[qe]!==Ee[qe])return}},mr=Ee=>Ee.split("/").map(Be=>Be.trim()).filter(Be=>""!==Be),Xi=Ee=>{Ee&&(Ee.ref.destroy(),Ee.unlistenEvents())};class Ar{constructor(Be,ee,qe,St,en,jn){this.containerEl=ee,this.router=qe,this.navCtrl=St,this.zone=en,this.location=jn,this.views=[],this.skipTransition=!1,this.nextId=0,this.tabsPrefix=void 0!==Be?mr(Be):void 0}createView(Be,ee){const qe=bi(this.router,ee),St=Be?.location?.nativeElement,en=he(this.zone,Be.instance,St);return{id:this.nextId++,stackId:Ri(this.tabsPrefix,qe),unlistenEvents:en,element:St,ref:Be,url:qe}}getExistingView(Be){const ee=bi(this.router,Be),qe=this.views.find(St=>St.url===ee);return qe&&qe.ref.changeDetectorRef.reattach(),qe}setActive(Be){const ee=this.navCtrl.consumeTransition();let{direction:qe,animation:St,animationBuilder:en}=ee;const jn=this.activeView,V=wi(Be,jn);V&&(qe="back",St=void 0);const ue=this.views.slice();let Xe;const _t=this.router;_t.getCurrentNavigation?Xe=_t.getCurrentNavigation():_t.navigations?.value&&(Xe=_t.navigations.value),Xe?.extras?.replaceUrl&&this.views.length>0&&this.views.splice(-1,1);const Wt=this.views.includes(Be),tn=this.insertView(Be,qe);Wt||Be.ref.changeDetectorRef.detectChanges();const vn=Be.animationBuilder;return void 0===en&&"back"===qe&&!V&&void 0!==vn&&(en=vn),jn&&(jn.animationBuilder=en),this.zone.runOutsideAngular(()=>this.wait(()=>(jn&&jn.ref.changeDetectorRef.detach(),Be.ref.changeDetectorRef.reattach(),this.transition(Be,jn,St,this.canGoBack(1),!1,en).then(()=>uo(Be,tn,ue,this.location,this.zone)).then(()=>({enteringView:Be,direction:qe,animation:St,tabSwitch:V})))))}canGoBack(Be,ee=this.getActiveStackId()){return this.getStack(ee).length>Be}pop(Be,ee=this.getActiveStackId()){return this.zone.run(()=>{const qe=this.getStack(ee);if(qe.length<=Be)return Promise.resolve(!1);const St=qe[qe.length-Be-1];let en=St.url;const jn=St.savedData;if(jn){const ue=jn.get("primary");ue?.route?._routerState?.snapshot.url&&(en=ue.route._routerState.snapshot.url)}const{animationBuilder:V}=this.navCtrl.consumeTransition();return this.navCtrl.navigateBack(en,{...St.savedExtras,animation:V}).then(()=>!0)})}startBackTransition(){const Be=this.activeView;if(Be){const ee=this.getStack(Be.stackId),qe=ee[ee.length-2],St=qe.animationBuilder;return this.wait(()=>this.transition(qe,Be,"back",this.canGoBack(2),!0,St))}return Promise.resolve()}endBackTransition(Be){Be?(this.skipTransition=!0,this.pop(1)):this.activeView&&_o(this.activeView,this.views,this.views,this.location,this.zone)}getLastUrl(Be){const ee=this.getStack(Be);return ee.length>0?ee[ee.length-1]:void 0}getRootUrl(Be){const ee=this.getStack(Be);return ee.length>0?ee[0]:void 0}getActiveStackId(){return this.activeView?this.activeView.stackId:void 0}getActiveView(){return this.activeView}hasRunningTask(){return void 0!==this.runningTask}destroy(){this.containerEl=void 0,this.views.forEach(Xi),this.activeView=void 0,this.views=[]}getStack(Be){return this.views.filter(ee=>ee.stackId===Be)}insertView(Be,ee){return this.activeView=Be,this.views=((Ee,Be,ee)=>"root"===ee?st(Ee,Be):"forward"===ee?((Ee,Be)=>(Ee.indexOf(Be)>=0?Ee=Ee.filter(qe=>qe.stackId!==Be.stackId||qe.id<=Be.id):Ee.push(Be),Ee))(Ee,Be):((Ee,Be)=>Ee.indexOf(Be)>=0?Ee.filter(qe=>qe.stackId!==Be.stackId||qe.id<=Be.id):st(Ee,Be))(Ee,Be))(this.views,Be,ee),this.views.slice()}transition(Be,ee,qe,St,en,jn){if(this.skipTransition)return this.skipTransition=!1,Promise.resolve(!1);if(ee===Be)return Promise.resolve(!1);const V=Be?Be.element:void 0,ue=ee?ee.element:void 0,Xe=this.containerEl;return V&&V!==ue&&(V.classList.add("ion-page"),V.classList.add("ion-page-invisible"),V.parentElement!==Xe&&Xe.appendChild(V),Xe.commit)?Xe.commit(V,ue,{duration:void 0===qe?0:void 0,direction:qe,showGoBack:St,progressAnimation:en,animationBuilder:jn}):Promise.resolve(!1)}wait(Be){var ee=this;return(0,h.Z)(function*(){void 0!==ee.runningTask&&(yield ee.runningTask,ee.runningTask=void 0);const qe=ee.runningTask=Be();return qe.finally(()=>ee.runningTask=void 0),qe})()}}const uo=(Ee,Be,ee,qe,St)=>"function"==typeof requestAnimationFrame?new Promise(en=>{requestAnimationFrame(()=>{_o(Ee,Be,ee,qe,St),en()})}):Promise.resolve(),_o=(Ee,Be,ee,qe,St)=>{St.run(()=>ee.filter(en=>!Be.includes(en)).forEach(Xi)),Be.forEach(en=>{const V=qe.path().split("?")[0].split("#")[0];if(en!==Ee&&en.url!==V){const ue=en.element;ue.setAttribute("aria-hidden","true"),ue.classList.add("ion-page-hidden"),en.ref.changeDetectorRef.detach()}})};let Eo=(()=>{class Ee{constructor(ee,qe,St,en,jn,V,ue,Xe){this.parentOutlet=Xe,this.activatedView=null,this.proxyMap=new WeakMap,this.currentActivatedRoute$=new an.X(null),this.activated=null,this._activatedRoute=null,this.name=te.eC,this.stackWillChange=new m.vpe,this.stackDidChange=new m.vpe,this.activateEvents=new m.vpe,this.deactivateEvents=new m.vpe,this.parentContexts=(0,m.f3M)(te.y6),this.location=(0,m.f3M)(m.s_b),this.environmentInjector=(0,m.f3M)(m.lqb),this.inputBinder=(0,m.f3M)(hr,{optional:!0}),this.supportsBindingToComponentInputs=!0,this.config=(0,m.f3M)(Ei),this.navCtrl=(0,m.f3M)(di),this.nativeEl=en.nativeElement,this.name=ee||te.eC,this.tabsPrefix="true"===qe?bi(jn,ue):void 0,this.stackCtrl=new Ar(this.tabsPrefix,this.nativeEl,jn,this.navCtrl,V,St),this.parentContexts.onChildOutletCreated(this.name,this)}get activatedComponentRef(){return this.activated}set animation(ee){this.nativeEl.animation=ee}set animated(ee){this.nativeEl.animated=ee}set swipeGesture(ee){this._swipeGesture=ee,this.nativeEl.swipeHandler=ee?{canStart:()=>this.stackCtrl.canGoBack(1)&&!this.stackCtrl.hasRunningTask(),onStart:()=>this.stackCtrl.startBackTransition(),onEnd:qe=>this.stackCtrl.endBackTransition(qe)}:void 0}ngOnDestroy(){this.stackCtrl.destroy(),this.inputBinder?.unsubscribeFromRouteData(this)}getContext(){return this.parentContexts.getContext(this.name)}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(!this.activated){const ee=this.getContext();ee?.route&&this.activateWith(ee.route,ee.injector)}new Promise(ee=>(0,it.c)(this.nativeEl,ee)).then(()=>{void 0===this._swipeGesture&&(this.swipeGesture=this.config.getBoolean("swipeBackEnabled","ios"===this.nativeEl.mode))})}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){throw new Error("incompatible reuse strategy")}attach(ee,qe){throw new Error("incompatible reuse strategy")}deactivate(){if(this.activated){if(this.activatedView){const qe=this.getContext();this.activatedView.savedData=new Map(qe.children.contexts);const St=this.activatedView.savedData.get("primary");if(St&&qe.route&&(St.route={...qe.route}),this.activatedView.savedExtras={},qe.route){const en=qe.route.snapshot;this.activatedView.savedExtras.queryParams=en.queryParams,this.activatedView.savedExtras.fragment=en.fragment}}const ee=this.component;this.activatedView=null,this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(ee)}}activateWith(ee,qe){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=ee;let St,en=this.stackCtrl.getExistingView(ee);if(en){St=this.activated=en.ref;const V=en.savedData;V&&(this.getContext().children.contexts=V),this.updateActivatedRouteProxy(St.instance,ee)}else{const V=ee._futureSnapshot,ue=this.parentContexts.getOrCreateContext(this.name).children,Xe=new an.X(null),_t=this.createActivatedRouteProxy(Xe,ee),Wt=new zi(_t,ue,this.location.injector);St=this.activated=this.location.createComponent(V.routeConfig.component??V.component,{index:this.location.length,injector:Wt,environmentInjector:qe??this.environmentInjector}),Xe.next(St.instance),en=this.stackCtrl.createView(this.activated,ee),this.proxyMap.set(St.instance,_t),this.currentActivatedRoute$.next({component:St.instance,activatedRoute:ee})}this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activatedView=en,this.navCtrl.setTopOutlet(this);const jn=this.stackCtrl.getActiveView();this.stackWillChange.emit({enteringView:en,tabSwitch:wi(en,jn)}),this.stackCtrl.setActive(en).then(V=>{this.activateEvents.emit(St.instance),this.stackDidChange.emit(V)})}canGoBack(ee=1,qe){return this.stackCtrl.canGoBack(ee,qe)}pop(ee=1,qe){return this.stackCtrl.pop(ee,qe)}getLastUrl(ee){const qe=this.stackCtrl.getLastUrl(ee);return qe?qe.url:void 0}getLastRouteView(ee){return this.stackCtrl.getLastUrl(ee)}getRootView(ee){return this.stackCtrl.getRootUrl(ee)}getActiveStackId(){return this.stackCtrl.getActiveStackId()}createActivatedRouteProxy(ee,qe){const St=new te.gz;return St._futureSnapshot=qe._futureSnapshot,St._routerState=qe._routerState,St.snapshot=qe.snapshot,St.outlet=qe.outlet,St.component=qe.component,St._paramMap=this.proxyObservable(ee,"paramMap"),St._queryParamMap=this.proxyObservable(ee,"queryParamMap"),St.url=this.proxyObservable(ee,"url"),St.params=this.proxyObservable(ee,"params"),St.queryParams=this.proxyObservable(ee,"queryParams"),St.fragment=this.proxyObservable(ee,"fragment"),St.data=this.proxyObservable(ee,"data"),St}proxyObservable(ee,qe){return ee.pipe((0,bn.h)(St=>!!St),(0,Cn.w)(St=>this.currentActivatedRoute$.pipe((0,bn.h)(en=>null!==en&&en.component===St),(0,Cn.w)(en=>en&&en.activatedRoute[qe]),function Zt(Ee,Be=It.y){return Ee=Ee??hn,(0,pe.e)((ee,qe)=>{let St,en=!0;ee.subscribe((0,lt.x)(qe,jn=>{const V=Be(jn);(en||!Ee(St,V))&&(en=!1,St=V,qe.next(jn))}))})}())))}updateActivatedRouteProxy(ee,qe){const St=this.proxyMap.get(ee);if(!St)throw new Error("Could not find activated route proxy for view");St._futureSnapshot=qe._futureSnapshot,St._routerState=qe._routerState,St.snapshot=qe.snapshot,St.outlet=qe.outlet,St.component=qe.component,this.currentActivatedRoute$.next({component:ee,activatedRoute:qe})}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.$8M("name"),m.$8M("tabs"),m.Y36(l.Ye),m.Y36(m.SBq),m.Y36(te.F0),m.Y36(m.R0b),m.Y36(te.gz),m.Y36(Ee,12))},Ee.\u0275dir=m.lG2({type:Ee,selectors:[["ion-router-outlet"]],inputs:{animated:"animated",animation:"animation",mode:"mode",swipeGesture:"swipeGesture",name:"name"},outputs:{stackWillChange:"stackWillChange",stackDidChange:"stackDidChange",activateEvents:"activate",deactivateEvents:"deactivate"},exportAs:["outlet"]}),Ee})();class zi{constructor(Be,ee,qe){this.route=Be,this.childContexts=ee,this.parent=qe}get(Be,ee){return Be===te.gz?this.route:Be===te.y6?this.childContexts:this.parent.get(Be,ee)}}const hr=new m.OlP("");let Ti=(()=>{class Ee{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(ee){this.unsubscribeFromRouteData(ee),this.subscribeToRouteData(ee)}unsubscribeFromRouteData(ee){this.outletDataSubscriptions.get(ee)?.unsubscribe(),this.outletDataSubscriptions.delete(ee)}subscribeToRouteData(ee){const{activatedRoute:qe}=ee,St=(0,tt.a)([qe.queryParams,qe.params,qe.data]).pipe((0,Cn.w)(([en,jn,V],ue)=>(V={...en,...jn,...V},0===ue?(0,pt.of)(V):Promise.resolve(V)))).subscribe(en=>{if(!ee.isActivated||!ee.activatedComponentRef||ee.activatedRoute!==qe||null===qe.component)return void this.unsubscribeFromRouteData(ee);const jn=(0,m.qFp)(qe.component);if(jn)for(const{templateName:V}of jn.inputs)ee.activatedComponentRef.setInput(V,en[V]);else this.unsubscribeFromRouteData(ee)});this.outletDataSubscriptions.set(ee,St)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)},Ee.\u0275prov=m.Yz7({token:Ee,factory:Ee.\u0275fac}),Ee})();const yo=()=>({provide:hr,useFactory:vr,deps:[te.F0]});function vr(Ee){return Ee?.componentInputBindingEnabled?new Ti:null}const Vr=["color","defaultHref","disabled","icon","mode","routerAnimation","text","type"];let Yr=(()=>{let Ee=class{constructor(ee,qe,St,en,jn,V){this.routerOutlet=ee,this.navCtrl=qe,this.config=St,this.r=en,this.z=jn,V.detach(),this.el=this.r.nativeElement}onClick(ee){const qe=this.defaultHref||this.config.get("backButtonDefaultHref");this.routerOutlet?.canGoBack()?(this.navCtrl.setDirection("back",void 0,void 0,this.routerAnimation),this.routerOutlet.pop(),ee.preventDefault()):null!=qe&&(this.navCtrl.navigateBack(qe,{animation:this.routerAnimation}),ee.preventDefault())}};return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(Eo,8),m.Y36(di),m.Y36(Ei),m.Y36(m.SBq),m.Y36(m.R0b),m.Y36(m.sBO))},Ee.\u0275dir=m.lG2({type:Ee,hostBindings:function(ee,qe){1&ee&&m.NdJ("click",function(en){return qe.onClick(en)})},inputs:{color:"color",defaultHref:"defaultHref",disabled:"disabled",icon:"icon",mode:"mode",routerAnimation:"routerAnimation",text:"text",type:"type"}}),Ee=(0,Xt.gn)([dt({inputs:Vr})],Ee),Ee})(),qi=(()=>{class Ee{constructor(ee,qe,St,en,jn){this.locationStrategy=ee,this.navCtrl=qe,this.elementRef=St,this.router=en,this.routerLink=jn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){if(this.routerLink?.urlTree){const ee=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=ee}}onClick(ee){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation),ee.preventDefault()}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(l.S$),m.Y36(di),m.Y36(m.SBq),m.Y36(te.F0),m.Y36(te.rH,8))},Ee.\u0275dir=m.lG2({type:Ee,selectors:[["","routerLink","",5,"a",5,"area"]],hostBindings:function(ee,qe){1&ee&&m.NdJ("click",function(en){return qe.onClick(en)})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[m.TTD]}),Ee})(),Qe=(()=>{class Ee{constructor(ee,qe,St,en,jn){this.locationStrategy=ee,this.navCtrl=qe,this.elementRef=St,this.router=en,this.routerLink=jn,this.routerDirection="forward"}ngOnInit(){this.updateTargetUrlAndHref()}ngOnChanges(){this.updateTargetUrlAndHref()}updateTargetUrlAndHref(){if(this.routerLink?.urlTree){const ee=this.locationStrategy.prepareExternalUrl(this.router.serializeUrl(this.routerLink.urlTree));this.elementRef.nativeElement.href=ee}}onClick(){this.navCtrl.setDirection(this.routerDirection,void 0,void 0,this.routerAnimation)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(l.S$),m.Y36(di),m.Y36(m.SBq),m.Y36(te.F0),m.Y36(te.rH,8))},Ee.\u0275dir=m.lG2({type:Ee,selectors:[["a","routerLink",""],["area","routerLink",""]],hostBindings:function(ee,qe){1&ee&&m.NdJ("click",function(){return qe.onClick()})},inputs:{routerDirection:"routerDirection",routerAnimation:"routerAnimation"},features:[m.TTD]}),Ee})();const Tt=["animated","animation","root","rootParams","swipeGesture"],Et=["push","insert","insertPages","pop","popTo","popToRoot","removeIndex","setRoot","setPages","getActive","getByIndex","canGoBack","getPrevious"];let ln=(()=>{let Ee=class{constructor(ee,qe,St,en,jn,V){this.z=jn,V.detach(),this.el=ee.nativeElement,ee.nativeElement.delegate=en.create(qe,St),Vt(this,this.el,["ionNavDidChange","ionNavWillChange"])}};return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(m.SBq),m.Y36(m.lqb),m.Y36(m.zs3),m.Y36(Fn),m.Y36(m.R0b),m.Y36(m.sBO))},Ee.\u0275dir=m.lG2({type:Ee,inputs:{animated:"animated",animation:"animation",root:"root",rootParams:"rootParams",swipeGesture:"swipeGesture"}}),Ee=(0,Xt.gn)([dt({inputs:Tt,methods:Et})],Ee),Ee})(),vt=(()=>{class Ee{constructor(ee){this.navCtrl=ee,this.ionTabsWillChange=new m.vpe,this.ionTabsDidChange=new m.vpe,this.tabBarSlot="bottom"}ngAfterContentInit(){this.detectSlotChanges()}ngAfterContentChecked(){this.detectSlotChanges()}onStackWillChange({enteringView:ee,tabSwitch:qe}){const St=ee.stackId;qe&&void 0!==St&&this.ionTabsWillChange.emit({tab:St})}onStackDidChange({enteringView:ee,tabSwitch:qe}){const St=ee.stackId;qe&&void 0!==St&&(this.tabBar&&(this.tabBar.selectedTab=St),this.ionTabsDidChange.emit({tab:St}))}select(ee){const qe="string"==typeof ee,St=qe?ee:ee.detail.tab,en=this.outlet.getActiveStackId()===St,jn=`${this.outlet.tabsPrefix}/${St}`;if(qe||ee.stopPropagation(),en){const V=this.outlet.getActiveStackId();if(this.outlet.getLastRouteView(V)?.url===jn)return;const Xe=this.outlet.getRootView(St);return this.navCtrl.navigateRoot(jn,{...Xe&&jn===Xe.url&&Xe.savedExtras,animated:!0,animationDirection:"back"})}{const V=this.outlet.getLastRouteView(St),ue=V?.url||jn,Xe=V?.savedExtras;return this.navCtrl.navigateRoot(ue,{...Xe,animated:!0,animationDirection:"back"})}}getSelected(){return this.outlet.getActiveStackId()}detectSlotChanges(){this.tabBars.forEach(ee=>{const qe=ee.el.getAttribute("slot");qe!==this.tabBarSlot&&(this.tabBarSlot=qe,this.relocateTabBar())})}relocateTabBar(){const ee=this.tabBar.el;"top"===this.tabBarSlot?this.tabsInner.nativeElement.before(ee):this.tabsInner.nativeElement.after(ee)}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(di))},Ee.\u0275dir=m.lG2({type:Ee,selectors:[["ion-tabs"]],viewQuery:function(ee,qe){if(1&ee&&m.Gf(Ft,7,m.SBq),2&ee){let St;m.iGM(St=m.CRH())&&(qe.tabsInner=St.first)}},hostBindings:function(ee,qe){1&ee&&m.NdJ("ionTabButtonClick",function(en){return qe.select(en)})},outputs:{ionTabsWillChange:"ionTabsWillChange",ionTabsDidChange:"ionTabsDidChange"}}),Ee})();const Hn=Ee=>"function"==typeof __zone_symbol__requestAnimationFrame?__zone_symbol__requestAnimationFrame(Ee):"function"==typeof requestAnimationFrame?requestAnimationFrame(Ee):setTimeout(Ee);let On=(()=>{class Ee{constructor(ee,qe){this.injector=ee,this.elementRef=qe,this.onChange=()=>{},this.onTouched=()=>{}}writeValue(ee){this.elementRef.nativeElement.value=this.lastValue=ee,Kn(this.elementRef)}handleValueChange(ee,qe){ee===this.elementRef.nativeElement&&(qe!==this.lastValue&&(this.lastValue=qe,this.onChange(qe)),Kn(this.elementRef))}_handleBlurEvent(ee){ee===this.elementRef.nativeElement&&(this.onTouched(),Kn(this.elementRef))}registerOnChange(ee){this.onChange=ee}registerOnTouched(ee){this.onTouched=ee}setDisabledState(ee){this.elementRef.nativeElement.disabled=ee}ngOnDestroy(){this.statusChanges&&this.statusChanges.unsubscribe()}ngAfterViewInit(){let ee;try{ee=this.injector.get(Yt.a5)}catch{}if(!ee)return;ee.statusChanges&&(this.statusChanges=ee.statusChanges.subscribe(()=>Kn(this.elementRef)));const qe=ee.control;qe&&["markAsTouched","markAllAsTouched","markAsUntouched","markAsDirty","markAsPristine"].forEach(en=>{if(typeof qe[en]<"u"){const jn=qe[en].bind(qe);qe[en]=(...V)=>{jn(...V),Kn(this.elementRef)}}})}}return Ee.\u0275fac=function(ee){return new(ee||Ee)(m.Y36(m.zs3),m.Y36(m.SBq))},Ee.\u0275dir=m.lG2({type:Ee,hostBindings:function(ee,qe){1&ee&&m.NdJ("ionBlur",function(en){return qe._handleBlurEvent(en.target)})}}),Ee})();const Kn=Ee=>{Hn(()=>{const Be=Ee.nativeElement,ee=null!=Be.value&&Be.value.toString().length>0,qe=pi(Be);ki(Be,qe);const St=Be.closest("ion-item");St&&ki(St,ee?[...qe,"item-has-value"]:qe)})},pi=Ee=>{const Be=Ee.classList,ee=[];for(let qe=0;qe<Be.length;qe++){const St=Be.item(qe);null!==St&&rr(St,"ng-")&&ee.push(`ion-${St.substring(3)}`)}return ee},ki=(Ee,Be)=>{const ee=Ee.classList;ee.remove("ion-valid","ion-invalid","ion-touched","ion-untouched","ion-dirty","ion-pristine"),ee.add(...Be)},rr=(Ee,Be)=>Ee.substring(0,Be.length)===Be;class _i{shouldDetach(Be){return!1}shouldAttach(Be){return!1}store(Be,ee){}retrieve(Be){return null}shouldReuseRoute(Be,ee){if(Be.routeConfig!==ee.routeConfig)return!1;const qe=Be.params,St=ee.params,en=Object.keys(qe),jn=Object.keys(St);if(en.length!==jn.length)return!1;for(const V of en)if(St[V]!==qe[V])return!1;return!0}}class or{constructor(Be){this.ctrl=Be}create(Be){return this.ctrl.create(Be||{})}dismiss(Be,ee,qe){return this.ctrl.dismiss(Be,ee,qe)}getTop(){return this.ctrl.getTop()}}},451:(Bn,Ct,P)=>{"use strict";P.d(Ct,{BX:()=>_t,Br:()=>ue,w:()=>ze,dr:()=>pt,BJ:()=>Xt,oU:()=>_i,yp:()=>Cn,YG:()=>lt,Sm:()=>Zt,PM:()=>hn,FN:()=>Yt,Zi:()=>Ft,tO:()=>Un,hM:()=>Kt,wI:()=>wn,W2:()=>ei,IJ:()=>Mi,W4:()=>dr,zq:()=>Ei,fr:()=>fn,jY:()=>Li,Gu:()=>gn,gu:()=>Fn,pK:()=>he,Ie:()=>_e,Q$:()=>dt,q_:()=>Bt,yh:()=>Nn,Uj:()=>en,z0:()=>ae,fG:()=>ft,zc:()=>Z,yf:()=>V,uN:()=>st,I_:()=>Ri,nJ:()=>mr,Wo:()=>Xi,jP:()=>ki,Nd:()=>Eo,VI:()=>zi,cJ:()=>hr,GO:()=>Ti,t9:()=>yo,n0:()=>vr,PQ:()=>Yr,jI:()=>qi,g2:()=>ln,Bs:()=>vt,wd:()=>Hn,ho:()=>Kn,sr:()=>pi,Pc:()=>Yi,HT:()=>tn,IN:()=>Vn,as:()=>Ke,YI:()=>Ee,QI:()=>dn,j9:()=>_n,yF:()=>si});var h=P(9212),m=P(6223),te=P(7346),l=P(7582),B=P(2438),Y=P(6814),C=P(6800),Te=(P(4913),P(4232),P(4810),P(2655),P(6535),P(5551)),Me=P(8958),nt=(P(2413),P(2936)),oe=(P(1848),P(9942));P(2019);const ye=Te.i,ct=["*"];let ze=(()=>{class O extends te.bk{constructor($,Ze){super($,Ze)}writeValue($){this.elementRef.nativeElement.checked=this.lastValue=$,(0,te.vk)(this.elementRef)}_handleIonChange($){this.handleValueChange($,$.checked)}}return O.\u0275fac=function($){return new($||O)(h.Y36(h.zs3),h.Y36(h.SBq))},O.\u0275dir=h.lG2({type:O,selectors:[["ion-checkbox"],["ion-toggle"]],hostBindings:function($,Ze){1&$&&h.NdJ("ionChange",function(Fi){return Ze._handleIonChange(Fi.target)})},features:[h._Bn([{provide:m.JU,useExisting:O,multi:!0}]),h.qOj]}),O})(),Ke=(()=>{class O extends te.bk{constructor($,Ze){super($,Ze)}handleInputEvent($){this.handleValueChange($,$.value)}registerOnChange($){super.registerOnChange(Ze=>{$(""===Ze?null:parseFloat(Ze))})}}return O.\u0275fac=function($){return new($||O)(h.Y36(h.zs3),h.Y36(h.SBq))},O.\u0275dir=h.lG2({type:O,selectors:[["ion-input","type","number"]],hostBindings:function($,Ze){1&$&&h.NdJ("ionInput",function(Fi){return Ze.handleInputEvent(Fi.target)})},features:[h._Bn([{provide:m.JU,useExisting:O,multi:!0}]),h.qOj]}),O})(),dn=(()=>{class O extends te.bk{constructor($,Ze){super($,Ze)}_handleChangeEvent($){this.handleValueChange($,$.value)}}return O.\u0275fac=function($){return new($||O)(h.Y36(h.zs3),h.Y36(h.SBq))},O.\u0275dir=h.lG2({type:O,selectors:[["ion-select"],["ion-radio-group"],["ion-segment"],["ion-datetime"]],hostBindings:function($,Ze){1&$&&h.NdJ("ionChange",function(Fi){return Ze._handleChangeEvent(Fi.target)})},features:[h._Bn([{provide:m.JU,useExisting:O,multi:!0}]),h.qOj]}),O})(),_n=(()=>{class O extends te.bk{constructor($,Ze){super($,Ze)}_handleInputEvent($){this.handleValueChange($,$.value)}}return O.\u0275fac=function($){return new($||O)(h.Y36(h.zs3),h.Y36(h.SBq))},O.\u0275dir=h.lG2({type:O,selectors:[["ion-input",3,"type","number"],["ion-textarea"],["ion-searchbar"],["ion-range"]],hostBindings:function($,Ze){1&$&&h.NdJ("ionInput",function(Fi){return Ze._handleInputEvent(Fi.target)})},features:[h._Bn([{provide:m.JU,useExisting:O,multi:!0}]),h.qOj]}),O})();const Ut=(O,Oe)=>{const $=O.prototype;Oe.forEach(Ze=>{Object.defineProperty($,Ze,{get(){return this.el[Ze]},set(Nt){this.z.runOutsideAngular(()=>this.el[Ze]=Nt)},configurable:!0})})},We=(O,Oe)=>{const $=O.prototype;Oe.forEach(Ze=>{$[Ze]=function(){const Nt=arguments;return this.z.runOutsideAngular(()=>this.el[Ze].apply(this.el,Nt))}})},Ne=(O,Oe,$)=>{$.forEach(Ze=>O[Ze]=(0,B.R)(Oe,Ze))};function it(O){return function($){const{defineCustomElementFn:Ze,inputs:Nt,methods:Fi}=O;return void 0!==Ze&&Ze(),Nt&&Ut($,Nt),Fi&&We($,Fi),$}}let pt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-app"]],ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({})],O),O})(),Xt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-avatar"]],ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({})],O),O})(),Cn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-badge"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","mode"]})],O),O})(),lt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionFocus","ionBlur"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-button"]],inputs:{buttonType:"buttonType",color:"color",disabled:"disabled",download:"download",expand:"expand",fill:"fill",form:"form",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",size:"size",strong:"strong",target:"target",type:"type"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["buttonType","color","disabled","download","expand","fill","form","href","mode","rel","routerAnimation","routerDirection","shape","size","strong","target","type"]})],O),O})(),Zt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-buttons"]],inputs:{collapse:"collapse"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["collapse"]})],O),O})(),hn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-card"]],inputs:{button:"button",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",target:"target",type:"type"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["button","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","target","type"]})],O),O})(),Yt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-card-content"]],inputs:{mode:"mode"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["mode"]})],O),O})(),Ft=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-card-header"]],inputs:{color:"color",mode:"mode",translucent:"translucent"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","mode","translucent"]})],O),O})(),Un=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-card-subtitle"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","mode"]})],O),O})(),Kt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-chip"]],inputs:{color:"color",disabled:"disabled",mode:"mode",outline:"outline"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","disabled","mode","outline"]})],O),O})(),wn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-col"]],inputs:{offset:"offset",offsetLg:"offsetLg",offsetMd:"offsetMd",offsetSm:"offsetSm",offsetXl:"offsetXl",offsetXs:"offsetXs",pull:"pull",pullLg:"pullLg",pullMd:"pullMd",pullSm:"pullSm",pullXl:"pullXl",pullXs:"pullXs",push:"push",pushLg:"pushLg",pushMd:"pushMd",pushSm:"pushSm",pushXl:"pushXl",pushXs:"pushXs",size:"size",sizeLg:"sizeLg",sizeMd:"sizeMd",sizeSm:"sizeSm",sizeXl:"sizeXl",sizeXs:"sizeXs"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["offset","offsetLg","offsetMd","offsetSm","offsetXl","offsetXs","pull","pullLg","pullMd","pullSm","pullXl","pullXs","push","pushLg","pushMd","pushSm","pushXl","pushXs","size","sizeLg","sizeMd","sizeSm","sizeXl","sizeXs"]})],O),O})(),ei=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionScrollStart","ionScroll","ionScrollEnd"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-content"]],inputs:{color:"color",forceOverscroll:"forceOverscroll",fullscreen:"fullscreen",scrollEvents:"scrollEvents",scrollX:"scrollX",scrollY:"scrollY"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","forceOverscroll","fullscreen","scrollEvents","scrollX","scrollY"],methods:["getScrollElement","scrollToTop","scrollToBottom","scrollByPoint","scrollToPoint"]})],O),O})(),Mi=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-fab"]],inputs:{activated:"activated",edge:"edge",horizontal:"horizontal",vertical:"vertical"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["activated","edge","horizontal","vertical"],methods:["close"]})],O),O})(),dr=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionFocus","ionBlur"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-fab-button"]],inputs:{activated:"activated",closeIcon:"closeIcon",color:"color",disabled:"disabled",download:"download",href:"href",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",show:"show",size:"size",target:"target",translucent:"translucent",type:"type"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["activated","closeIcon","color","disabled","download","href","mode","rel","routerAnimation","routerDirection","show","size","target","translucent","type"]})],O),O})(),Ei=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-fab-list"]],inputs:{activated:"activated",side:"side"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["activated","side"]})],O),O})(),fn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-footer"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["collapse","mode","translucent"]})],O),O})(),Li=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-grid"]],inputs:{fixed:"fixed"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["fixed"]})],O),O})(),gn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-header"]],inputs:{collapse:"collapse",mode:"mode",translucent:"translucent"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["collapse","mode","translucent"]})],O),O})(),Fn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-icon"]],inputs:{color:"color",flipRtl:"flipRtl",icon:"icon",ios:"ios",lazy:"lazy",md:"md",mode:"mode",name:"name",sanitize:"sanitize",size:"size",src:"src"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","flipRtl","icon","ios","lazy","md","mode","name","sanitize","size","src"]})],O),O})(),he=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionInput","ionChange","ionBlur","ionFocus"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-input"]],inputs:{accept:"accept",autocapitalize:"autocapitalize",autocomplete:"autocomplete",autocorrect:"autocorrect",autofocus:"autofocus",clearInput:"clearInput",clearOnEdit:"clearOnEdit",color:"color",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",maxlength:"maxlength",min:"min",minlength:"minlength",mode:"mode",multiple:"multiple",name:"name",pattern:"pattern",placeholder:"placeholder",readonly:"readonly",required:"required",shape:"shape",size:"size",spellcheck:"spellcheck",step:"step",type:"type",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["accept","autocapitalize","autocomplete","autocorrect","autofocus","clearInput","clearOnEdit","color","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","max","maxlength","min","minlength","mode","multiple","name","pattern","placeholder","readonly","required","shape","size","spellcheck","step","type","value"],methods:["setFocus","getInputElement"]})],O),O})(),_e=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-item"]],inputs:{button:"button",color:"color",counter:"counter",counterFormatter:"counterFormatter",detail:"detail",detailIcon:"detailIcon",disabled:"disabled",download:"download",fill:"fill",href:"href",lines:"lines",mode:"mode",rel:"rel",routerAnimation:"routerAnimation",routerDirection:"routerDirection",shape:"shape",target:"target",type:"type"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["button","color","counter","counterFormatter","detail","detailIcon","disabled","download","fill","href","lines","mode","rel","routerAnimation","routerDirection","shape","target","type"]})],O),O})(),dt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-label"]],inputs:{color:"color",mode:"mode",position:"position"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","mode","position"]})],O),O})(),Bt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-list"]],inputs:{inset:"inset",lines:"lines",mode:"mode"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["inset","lines","mode"],methods:["closeSlidingItems"]})],O),O})(),Nn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-list-header"]],inputs:{color:"color",lines:"lines",mode:"mode"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","lines","mode"]})],O),O})(),ae=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionWillOpen","ionWillClose","ionDidOpen","ionDidClose"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-menu"]],inputs:{contentId:"contentId",disabled:"disabled",maxEdgeStart:"maxEdgeStart",menuId:"menuId",side:"side",swipeGesture:"swipeGesture",type:"type"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["contentId","disabled","maxEdgeStart","menuId","side","swipeGesture","type"],methods:["isOpen","isActive","open","close","toggle","setOpen"]})],O),O})(),ft=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-menu-button"]],inputs:{autoHide:"autoHide",color:"color",disabled:"disabled",menu:"menu",mode:"mode",type:"type"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["autoHide","color","disabled","menu","mode","type"]})],O),O})(),Z=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-menu-toggle"]],inputs:{autoHide:"autoHide",menu:"menu"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["autoHide","menu"]})],O),O})(),st=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-note"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","mode"]})],O),O})(),Ri=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionChange","ionInput","ionFocus","ionBlur","ionKnobMoveStart","ionKnobMoveEnd"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-range"]],inputs:{activeBarStart:"activeBarStart",color:"color",debounce:"debounce",disabled:"disabled",dualKnobs:"dualKnobs",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",max:"max",min:"min",mode:"mode",name:"name",pin:"pin",pinFormatter:"pinFormatter",snaps:"snaps",step:"step",ticks:"ticks",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["activeBarStart","color","debounce","disabled","dualKnobs","label","labelPlacement","legacy","max","min","mode","name","pin","pinFormatter","snaps","step","ticks","value"]})],O),O})(),mr=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionRefresh","ionPull","ionStart"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-refresher"]],inputs:{closeDuration:"closeDuration",disabled:"disabled",mode:"mode",pullFactor:"pullFactor",pullMax:"pullMax",pullMin:"pullMin",snapbackDuration:"snapbackDuration"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["closeDuration","disabled","mode","pullFactor","pullMax","pullMin","snapbackDuration"],methods:["complete","cancel","getProgress"]})],O),O})(),Xi=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-refresher-content"]],inputs:{pullingIcon:"pullingIcon",pullingText:"pullingText",refreshingSpinner:"refreshingSpinner",refreshingText:"refreshingText"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["pullingIcon","pullingText","refreshingSpinner","refreshingText"]})],O),O})(),Eo=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-row"]],ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({})],O),O})(),zi=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionInput","ionChange","ionCancel","ionClear","ionBlur","ionFocus"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-searchbar"]],inputs:{animated:"animated",autocomplete:"autocomplete",autocorrect:"autocorrect",cancelButtonIcon:"cancelButtonIcon",cancelButtonText:"cancelButtonText",clearIcon:"clearIcon",color:"color",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",inputmode:"inputmode",mode:"mode",name:"name",placeholder:"placeholder",searchIcon:"searchIcon",showCancelButton:"showCancelButton",showClearButton:"showClearButton",spellcheck:"spellcheck",type:"type",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["animated","autocomplete","autocorrect","cancelButtonIcon","cancelButtonText","clearIcon","color","debounce","disabled","enterkeyhint","inputmode","mode","name","placeholder","searchIcon","showCancelButton","showClearButton","spellcheck","type","value"],methods:["setFocus","getInputElement"]})],O),O})(),hr=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionChange"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-segment"]],inputs:{color:"color",disabled:"disabled",mode:"mode",scrollable:"scrollable",selectOnFocus:"selectOnFocus",swipeGesture:"swipeGesture",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","disabled","mode","scrollable","selectOnFocus","swipeGesture","value"]})],O),O})(),Ti=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-segment-button"]],inputs:{disabled:"disabled",layout:"layout",mode:"mode",type:"type",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["disabled","layout","mode","type","value"]})],O),O})(),yo=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionChange","ionCancel","ionDismiss","ionFocus","ionBlur"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-select"]],inputs:{cancelText:"cancelText",color:"color",compareWith:"compareWith",disabled:"disabled",expandedIcon:"expandedIcon",fill:"fill",interface:"interface",interfaceOptions:"interfaceOptions",justify:"justify",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",multiple:"multiple",name:"name",okText:"okText",placeholder:"placeholder",selectedText:"selectedText",shape:"shape",toggleIcon:"toggleIcon",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["cancelText","color","compareWith","disabled","expandedIcon","fill","interface","interfaceOptions","justify","label","labelPlacement","legacy","mode","multiple","name","okText","placeholder","selectedText","shape","toggleIcon","value"],methods:["open"]})],O),O})(),vr=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-select-option"]],inputs:{disabled:"disabled",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["disabled","value"]})],O),O})(),Yr=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-spinner"]],inputs:{color:"color",duration:"duration",name:"name",paused:"paused"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","duration","name","paused"]})],O),O})(),qi=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionSplitPaneVisible"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-split-pane"]],inputs:{contentId:"contentId",disabled:"disabled",when:"when"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["contentId","disabled","when"]})],O),O})(),ln=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionChange","ionInput","ionBlur","ionFocus"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-textarea"]],inputs:{autoGrow:"autoGrow",autocapitalize:"autocapitalize",autofocus:"autofocus",clearOnEdit:"clearOnEdit",color:"color",cols:"cols",counter:"counter",counterFormatter:"counterFormatter",debounce:"debounce",disabled:"disabled",enterkeyhint:"enterkeyhint",errorText:"errorText",fill:"fill",helperText:"helperText",inputmode:"inputmode",label:"label",labelPlacement:"labelPlacement",legacy:"legacy",maxlength:"maxlength",minlength:"minlength",mode:"mode",name:"name",placeholder:"placeholder",readonly:"readonly",required:"required",rows:"rows",shape:"shape",spellcheck:"spellcheck",value:"value",wrap:"wrap"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["autoGrow","autocapitalize","autofocus","clearOnEdit","color","cols","counter","counterFormatter","debounce","disabled","enterkeyhint","errorText","fill","helperText","inputmode","label","labelPlacement","legacy","maxlength","minlength","mode","name","placeholder","readonly","required","rows","shape","spellcheck","value","wrap"],methods:["setFocus","getInputElement"]})],O),O})(),vt=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-thumbnail"]],ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({})],O),O})(),Hn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-title"]],inputs:{color:"color",size:"size"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","size"]})],O),O})(),Kn=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement,Ne(this,this.el,["ionChange","ionFocus","ionBlur"])}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-toggle"]],inputs:{alignment:"alignment",checked:"checked",color:"color",disabled:"disabled",enableOnOffLabels:"enableOnOffLabels",justify:"justify",labelPlacement:"labelPlacement",legacy:"legacy",mode:"mode",name:"name",value:"value"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["alignment","checked","color","disabled","enableOnOffLabels","justify","labelPlacement","legacy","mode","name","value"]})],O),O})(),pi=(()=>{let O=class{constructor($,Ze,Nt){this.z=Nt,$.detach(),this.el=Ze.nativeElement}};return O.\u0275fac=function($){return new($||O)(h.Y36(h.sBO),h.Y36(h.SBq),h.Y36(h.R0b))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-toolbar"]],inputs:{color:"color",mode:"mode"},ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O=(0,l.gn)([it({inputs:["color","mode"]})],O),O})(),ki=(()=>{class O extends te.jP{constructor($,Ze,Nt,Fi,Sr,Qi,Dr,ho){super($,Ze,Nt,Fi,Sr,Qi,Dr,ho),this.parentOutlet=ho}}return O.\u0275fac=function($){return new($||O)(h.$8M("name"),h.$8M("tabs"),h.Y36(Y.Ye),h.Y36(h.SBq),h.Y36(C.F0),h.Y36(h.R0b),h.Y36(C.gz),h.Y36(O,12))},O.\u0275dir=h.lG2({type:O,selectors:[["ion-router-outlet"]],features:[h.qOj]}),O})(),_i=(()=>{class O extends te.oU{constructor($,Ze,Nt,Fi,Sr,Qi){super($,Ze,Nt,Fi,Sr,Qi)}}return O.\u0275fac=function($){return new($||O)(h.Y36(ki,8),h.Y36(te.SH),h.Y36(te.De),h.Y36(h.SBq),h.Y36(h.R0b),h.Y36(h.sBO))},O.\u0275cmp=h.Xpm({type:O,selectors:[["ion-back-button"]],features:[h.qOj],ngContentSelectors:ct,decls:1,vars:0,template:function($,Ze){1&$&&(h.F$t(),h.Hsn(0))},encapsulation:2,changeDetection:0}),O})(),Ee=(()=>{class O extends te.j{}return O.\u0275fac=(()=>{let Oe;return function(Ze){return(Oe||(Oe=h.n5z(O)))(Ze||O)}})(),O.\u0275dir=h.lG2({type:O,selectors:[["","routerLink","",5,"a",5,"area"]],features:[h.qOj]}),O})();const St={provide:m.Cf,useExisting:(0,h.Gpc)(()=>en),multi:!0};let en=(()=>{class O extends m.Fd{}return O.\u0275fac=(()=>{let Oe;return function(Ze){return(Oe||(Oe=h.n5z(O)))(Ze||O)}})(),O.\u0275dir=h.lG2({type:O,selectors:[["ion-input","type","number","max","","formControlName",""],["ion-input","type","number","max","","formControl",""],["ion-input","type","number","max","","ngModel",""]],hostVars:1,hostBindings:function($,Ze){2&$&&h.uIk("max",Ze._enabled?Ze.max:null)},features:[h._Bn([St]),h.qOj]}),O})();const jn={provide:m.Cf,useExisting:(0,h.Gpc)(()=>V),multi:!0};let V=(()=>{class O extends m.qQ{}return O.\u0275fac=(()=>{let Oe;return function(Ze){return(Oe||(Oe=h.n5z(O)))(Ze||O)}})(),O.\u0275dir=h.lG2({type:O,selectors:[["ion-input","type","number","min","","formControlName",""],["ion-input","type","number","min","","formControl",""],["ion-input","type","number","min","","ngModel",""]],hostVars:1,hostBindings:function($,Ze){2&$&&h.uIk("min",Ze._enabled?Ze.min:null)},features:[h._Bn([jn]),h.qOj]}),O})(),ue=(()=>{class O extends te.xs{constructor(){super(nt.a)}}return O.\u0275fac=function($){return new($||O)},O.\u0275prov=h.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})(),_t=(()=>{class O extends te.xs{constructor(){super(nt.b)}}return O.\u0275fac=function($){return new($||O)},O.\u0275prov=h.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})(),tn=(()=>{class O extends te.xs{constructor(){super(nt.l)}}return O.\u0275fac=function($){return new($||O)},O.\u0275prov=h.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})(),Vn=(()=>{class O extends te.xs{constructor(){super(nt.m),this.angularDelegate=(0,h.f3M)(te.y4),this.injector=(0,h.f3M)(h.zs3),this.environmentInjector=(0,h.f3M)(h.lqb)}create($){return super.create({...$,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"modal")})}}return O.\u0275fac=function($){return new($||O)},O.\u0275prov=h.Yz7({token:O,factory:O.\u0275fac}),O})();class Xn extends te.xs{constructor(){super(nt.c),this.angularDelegate=(0,h.f3M)(te.y4),this.injector=(0,h.f3M)(h.zs3),this.environmentInjector=(0,h.f3M)(h.lqb)}create(Oe){return super.create({...Oe,delegate:this.angularDelegate.create(this.environmentInjector,this.injector,"popover")})}}let si=(()=>{class O extends te.xs{constructor(){super(nt.t)}}return O.\u0275fac=function($){return new($||O)},O.\u0275prov=h.Yz7({token:O,factory:O.\u0275fac,providedIn:"root"}),O})();const fi=(O,Oe,$)=>()=>{if(Oe.defaultView&&typeof window<"u"){(0,Me.s)({...O,_zoneGate:Fi=>$.run(Fi)});const Nt="__zone_symbol__addEventListener"in Oe.body?"__zone_symbol__addEventListener":"addEventListener";return function Ae(){var O=[];if(typeof window<"u"){var Oe=window;(!Oe.customElements||Oe.Element&&(!Oe.Element.prototype.closest||!Oe.Element.prototype.matches||!Oe.Element.prototype.remove||!Oe.Element.prototype.getRootNode))&&O.push(P.e(6748).then(P.t.bind(P,3342,23))),("function"!=typeof Object.assign||!Object.entries||!Array.prototype.find||!Array.prototype.includes||!String.prototype.startsWith||!String.prototype.endsWith||Oe.NodeList&&!Oe.NodeList.prototype.forEach||!Oe.fetch||!function(){try{var Ze=new URL("b","http://a");return Ze.pathname="c%20d","http://a/c%20d"===Ze.href&&Ze.searchParams}catch{return!1}}()||typeof WeakMap>"u")&&O.push(P.e(2214).then(P.t.bind(P,2668,23)))}return Promise.all(O)}().then(()=>((O,Oe)=>{if(!(typeof window>"u"))return ye(),(0,oe.b)(JSON.parse('[["ion-menu_3",[[33,"ion-menu-button",{"color":[513],"disabled":[4],"menu":[1],"autoHide":[4,"auto-hide"],"type":[1],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]],[33,"ion-menu",{"contentId":[513,"content-id"],"menuId":[513,"menu-id"],"type":[1025],"disabled":[1028],"side":[513],"swipeGesture":[4,"swipe-gesture"],"maxEdgeStart":[2,"max-edge-start"],"isPaneVisible":[32],"isEndSide":[32],"isOpen":[64],"isActive":[64],"open":[64],"close":[64],"toggle":[64],"setOpen":[64]},[[16,"ionSplitPaneVisible","onSplitPaneChanged"],[2,"click","onBackdropClick"],[0,"keydown","onKeydown"]],{"type":["typeChanged"],"disabled":["disabledChanged"],"side":["sideChanged"],"swipeGesture":["swipeGestureChanged"]}],[1,"ion-menu-toggle",{"menu":[1],"autoHide":[4,"auto-hide"],"visible":[32]},[[16,"ionMenuChange","visibilityChanged"],[16,"ionSplitPaneVisible","visibilityChanged"]]]]],["ion-fab_3",[[33,"ion-fab-button",{"color":[513],"activated":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1],"show":[4],"translucent":[4],"type":[1],"size":[1],"closeIcon":[1,"close-icon"]}],[1,"ion-fab",{"horizontal":[1],"vertical":[1],"edge":[4],"activated":[1028],"close":[64],"toggle":[64]},null,{"activated":["activatedChanged"]}],[1,"ion-fab-list",{"activated":[4],"side":[1]},null,{"activated":["activatedChanged"]}]]],["ion-refresher_2",[[0,"ion-refresher-content",{"pullingIcon":[1025,"pulling-icon"],"pullingText":[1,"pulling-text"],"refreshingSpinner":[1025,"refreshing-spinner"],"refreshingText":[1,"refreshing-text"]}],[32,"ion-refresher",{"pullMin":[2,"pull-min"],"pullMax":[2,"pull-max"],"closeDuration":[1,"close-duration"],"snapbackDuration":[1,"snapback-duration"],"pullFactor":[2,"pull-factor"],"disabled":[4],"nativeRefresher":[32],"state":[32],"complete":[64],"cancel":[64],"getProgress":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-back-button",[[33,"ion-back-button",{"color":[513],"defaultHref":[1025,"default-href"],"disabled":[516],"icon":[1],"text":[1],"type":[1],"routerAnimation":[16]}]]],["ion-toast",[[33,"ion-toast",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"color":[513],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"duration":[2],"header":[1],"layout":[1],"message":[1],"keyboardClose":[4,"keyboard-close"],"position":[1],"positionAnchor":[1,"position-anchor"],"buttons":[16],"translucent":[4],"animated":[4],"icon":[1],"htmlAttributes":[16],"swipeGesture":[1,"swipe-gesture"],"isOpen":[4,"is-open"],"trigger":[1],"revealContentToScreenReader":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"swipeGesture":["swipeGestureChanged"],"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-card_5",[[33,"ion-card",{"color":[513],"button":[4],"type":[1],"disabled":[4],"download":[1],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}],[32,"ion-card-content"],[33,"ion-card-header",{"color":[513],"translucent":[4]}],[33,"ion-card-subtitle",{"color":[513]}],[33,"ion-card-title",{"color":[513]}]]],["ion-item-option_3",[[33,"ion-item-option",{"color":[513],"disabled":[4],"download":[1],"expandable":[4],"href":[1],"rel":[1],"target":[1],"type":[1]}],[32,"ion-item-options",{"side":[1],"fireSwipeEvent":[64]}],[0,"ion-item-sliding",{"disabled":[4],"state":[32],"getOpenAmount":[64],"getSlidingRatio":[64],"open":[64],"close":[64],"closeOpened":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-accordion_2",[[49,"ion-accordion",{"value":[1],"disabled":[4],"readonly":[4],"toggleIcon":[1,"toggle-icon"],"toggleIconSlot":[1,"toggle-icon-slot"],"state":[32],"isNext":[32],"isPrevious":[32]},null,{"value":["valueChanged"]}],[33,"ion-accordion-group",{"animated":[4],"multiple":[4],"value":[1025],"disabled":[4],"readonly":[4],"expand":[1],"requestAccordionToggle":[64],"getAccordions":[64]},[[0,"keydown","onKeydown"]],{"value":["valueChanged"],"disabled":["disabledChanged"],"readonly":["readonlyChanged"]}]]],["ion-infinite-scroll_2",[[32,"ion-infinite-scroll-content",{"loadingSpinner":[1025,"loading-spinner"],"loadingText":[1,"loading-text"]}],[0,"ion-infinite-scroll",{"threshold":[1],"disabled":[4],"position":[1],"isLoading":[32],"complete":[64]},null,{"threshold":["thresholdChanged"],"disabled":["disabledChanged"]}]]],["ion-reorder_2",[[33,"ion-reorder",null,[[2,"click","onClick"]]],[0,"ion-reorder-group",{"disabled":[4],"state":[32],"complete":[64]},null,{"disabled":["disabledChanged"]}]]],["ion-segment_2",[[33,"ion-segment-button",{"disabled":[1028],"layout":[1],"type":[1],"value":[8],"checked":[32],"setFocus":[64]},null,{"value":["valueChanged"]}],[33,"ion-segment",{"color":[513],"disabled":[4],"scrollable":[4],"swipeGesture":[4,"swipe-gesture"],"value":[1032],"selectOnFocus":[4,"select-on-focus"],"activated":[32]},[[0,"keydown","onKeyDown"]],{"color":["colorChanged"],"swipeGesture":["swipeGestureChanged"],"value":["valueChanged"],"disabled":["disabledChanged"]}]]],["ion-tab-bar_2",[[33,"ion-tab-button",{"disabled":[4],"download":[1],"href":[1],"rel":[1],"layout":[1025],"selected":[1028],"tab":[1],"target":[1]},[[8,"ionTabBarChanged","onTabBarChanged"]]],[33,"ion-tab-bar",{"color":[513],"selectedTab":[1,"selected-tab"],"translucent":[4],"keyboardVisible":[32]},null,{"selectedTab":["selectedTabChanged"]}]]],["ion-chip",[[33,"ion-chip",{"color":[513],"outline":[4],"disabled":[4]}]]],["ion-datetime-button",[[33,"ion-datetime-button",{"color":[513],"disabled":[516],"datetime":[1],"datetimePresentation":[32],"dateText":[32],"timeText":[32],"datetimeActive":[32],"selectedButton":[32]}]]],["ion-input",[[38,"ion-input",{"color":[513],"accept":[1],"autocapitalize":[1],"autocomplete":[1],"autocorrect":[1],"autofocus":[4],"clearInput":[4,"clear-input"],"clearOnEdit":[4,"clear-on-edit"],"counter":[4],"counterFormatter":[16],"debounce":[2],"disabled":[4],"enterkeyhint":[1],"errorText":[1,"error-text"],"fill":[1],"inputmode":[1],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"max":[8],"maxlength":[2],"min":[8],"minlength":[2],"multiple":[4],"name":[1],"pattern":[1],"placeholder":[1],"readonly":[4],"required":[4],"shape":[1],"spellcheck":[4],"step":[1],"size":[2],"type":[1],"value":[1032],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"disabled":["disabledChanged"],"placeholder":["placeholderChanged"],"value":["valueChanged"]}]]],["ion-searchbar",[[34,"ion-searchbar",{"color":[513],"animated":[4],"autocomplete":[1],"autocorrect":[1],"cancelButtonIcon":[1,"cancel-button-icon"],"cancelButtonText":[1,"cancel-button-text"],"clearIcon":[1,"clear-icon"],"debounce":[2],"disabled":[4],"inputmode":[1],"enterkeyhint":[1],"name":[1],"placeholder":[1],"searchIcon":[1,"search-icon"],"showCancelButton":[1,"show-cancel-button"],"showClearButton":[1,"show-clear-button"],"spellcheck":[4],"type":[1],"value":[1025],"focused":[32],"noAnimate":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"value":["valueChanged"],"showCancelButton":["showCancelButtonChanged"]}]]],["ion-toggle",[[33,"ion-toggle",{"color":[513],"name":[1],"checked":[1028],"disabled":[4],"value":[1],"enableOnOffLabels":[4,"enable-on-off-labels"],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"alignment":[1],"activated":[32]},null,{"disabled":["disabledChanged"]}]]],["ion-nav_2",[[1,"ion-nav",{"delegate":[16],"swipeGesture":[1028,"swipe-gesture"],"animated":[4],"animation":[16],"rootParams":[16],"root":[1],"push":[64],"insert":[64],"insertPages":[64],"pop":[64],"popTo":[64],"popToRoot":[64],"removeIndex":[64],"setRoot":[64],"setPages":[64],"setRouteId":[64],"getRouteId":[64],"getActive":[64],"getByIndex":[64],"canGoBack":[64],"getPrevious":[64]},null,{"swipeGesture":["swipeGestureChanged"],"root":["rootChanged"]}],[0,"ion-nav-link",{"component":[1],"componentProps":[16],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}]]],["ion-textarea",[[38,"ion-textarea",{"color":[513],"autocapitalize":[1],"autofocus":[4],"clearOnEdit":[4,"clear-on-edit"],"debounce":[2],"disabled":[4],"fill":[1],"inputmode":[1],"enterkeyhint":[1],"maxlength":[2],"minlength":[2],"name":[1],"placeholder":[1],"readonly":[4],"required":[4],"spellcheck":[4],"cols":[514],"rows":[2],"wrap":[1],"autoGrow":[516,"auto-grow"],"value":[1025],"counter":[4],"counterFormatter":[16],"errorText":[1,"error-text"],"helperText":[1,"helper-text"],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"shape":[1],"hasFocus":[32],"setFocus":[64],"getInputElement":[64]},null,{"debounce":["debounceChanged"],"disabled":["disabledChanged"],"value":["valueChanged"]}]]],["ion-backdrop",[[33,"ion-backdrop",{"visible":[4],"tappable":[4],"stopPropagation":[4,"stop-propagation"]},[[2,"click","onMouseDown"]]]]],["ion-loading",[[34,"ion-loading",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"message":[1],"cssClass":[1,"css-class"],"duration":[2],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"spinner":[1025],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-breadcrumb_2",[[33,"ion-breadcrumb",{"collapsed":[4],"last":[4],"showCollapsedIndicator":[4,"show-collapsed-indicator"],"color":[1],"active":[4],"disabled":[4],"download":[1],"href":[1],"rel":[1],"separator":[4],"target":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16]}],[33,"ion-breadcrumbs",{"color":[513],"maxItems":[2,"max-items"],"itemsBeforeCollapse":[2,"items-before-collapse"],"itemsAfterCollapse":[2,"items-after-collapse"],"collapsed":[32],"activeChanged":[32]},[[0,"collapsedClick","onCollapsedClick"]],{"maxItems":["maxItemsChanged"],"itemsBeforeCollapse":["maxItemsChanged"],"itemsAfterCollapse":["maxItemsChanged"]}]]],["ion-modal",[[33,"ion-modal",{"hasController":[4,"has-controller"],"overlayIndex":[2,"overlay-index"],"delegate":[16],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"breakpoints":[16],"initialBreakpoint":[2,"initial-breakpoint"],"backdropBreakpoint":[2,"backdrop-breakpoint"],"handle":[4],"handleBehavior":[1,"handle-behavior"],"component":[1],"componentProps":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"showBackdrop":[4,"show-backdrop"],"animated":[4],"presentingElement":[16],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"keepContentsMounted":[4,"keep-contents-mounted"],"canDismiss":[4,"can-dismiss"],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"setCurrentBreakpoint":[64],"getCurrentBreakpoint":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-route_4",[[0,"ion-route",{"url":[1],"component":[1],"componentProps":[16],"beforeLeave":[16],"beforeEnter":[16]},null,{"url":["onUpdate"],"component":["onUpdate"],"componentProps":["onComponentProps"]}],[0,"ion-route-redirect",{"from":[1],"to":[1]},null,{"from":["propDidChange"],"to":["propDidChange"]}],[0,"ion-router",{"root":[1],"useHash":[4,"use-hash"],"canTransition":[64],"push":[64],"back":[64],"printDebug":[64],"navChanged":[64]},[[8,"popstate","onPopState"],[4,"ionBackButton","onBackButton"]]],[1,"ion-router-link",{"color":[513],"href":[1],"rel":[1],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"target":[1]}]]],["ion-avatar_3",[[33,"ion-avatar"],[33,"ion-badge",{"color":[513]}],[1,"ion-thumbnail"]]],["ion-col_3",[[1,"ion-col",{"offset":[1],"offsetXs":[1,"offset-xs"],"offsetSm":[1,"offset-sm"],"offsetMd":[1,"offset-md"],"offsetLg":[1,"offset-lg"],"offsetXl":[1,"offset-xl"],"pull":[1],"pullXs":[1,"pull-xs"],"pullSm":[1,"pull-sm"],"pullMd":[1,"pull-md"],"pullLg":[1,"pull-lg"],"pullXl":[1,"pull-xl"],"push":[1],"pushXs":[1,"push-xs"],"pushSm":[1,"push-sm"],"pushMd":[1,"push-md"],"pushLg":[1,"push-lg"],"pushXl":[1,"push-xl"],"size":[1],"sizeXs":[1,"size-xs"],"sizeSm":[1,"size-sm"],"sizeMd":[1,"size-md"],"sizeLg":[1,"size-lg"],"sizeXl":[1,"size-xl"]},[[9,"resize","onResize"]]],[1,"ion-grid",{"fixed":[4]}],[1,"ion-row"]]],["ion-tab_2",[[1,"ion-tab",{"active":[1028],"delegate":[16],"tab":[1],"component":[1],"setActive":[64]},null,{"active":["changeActive"]}],[1,"ion-tabs",{"useRouter":[1028,"use-router"],"selectedTab":[32],"select":[64],"getTab":[64],"getSelected":[64],"setRouteId":[64],"getRouteId":[64]}]]],["ion-img",[[1,"ion-img",{"alt":[1],"src":[1],"loadSrc":[32],"loadError":[32]},null,{"src":["srcChanged"]}]]],["ion-progress-bar",[[33,"ion-progress-bar",{"type":[1],"reversed":[4],"value":[2],"buffer":[2],"color":[513]}]]],["ion-range",[[33,"ion-range",{"color":[513],"debounce":[2],"name":[1],"label":[1],"dualKnobs":[4,"dual-knobs"],"min":[2],"max":[2],"pin":[4],"pinFormatter":[16],"snaps":[4],"step":[2],"ticks":[4],"activeBarStart":[1026,"active-bar-start"],"disabled":[4],"value":[1026],"labelPlacement":[1,"label-placement"],"legacy":[4],"ratioA":[32],"ratioB":[32],"pressedKnob":[32]},null,{"debounce":["debounceChanged"],"min":["minChanged"],"max":["maxChanged"],"activeBarStart":["activeBarStartChanged"],"disabled":["disabledChanged"],"value":["valueChanged"]}]]],["ion-split-pane",[[33,"ion-split-pane",{"contentId":[513,"content-id"],"disabled":[4],"when":[8],"visible":[32]},null,{"visible":["visibleChanged"],"disabled":["updateState"],"when":["updateState"]}]]],["ion-text",[[1,"ion-text",{"color":[513]}]]],["ion-item_8",[[33,"ion-item-divider",{"color":[513],"sticky":[4]}],[32,"ion-item-group"],[1,"ion-skeleton-text",{"animated":[4]}],[32,"ion-list",{"lines":[1],"inset":[4],"closeSlidingItems":[64]}],[33,"ion-list-header",{"color":[513],"lines":[1]}],[49,"ion-item",{"color":[513],"button":[4],"detail":[4],"detailIcon":[1,"detail-icon"],"disabled":[4],"download":[1],"fill":[1],"shape":[1],"href":[1],"rel":[1],"lines":[1],"counter":[4],"routerAnimation":[16],"routerDirection":[1,"router-direction"],"target":[1],"type":[1],"counterFormatter":[16],"multipleInputs":[32],"focusable":[32],"counterString":[32]},[[0,"ionInput","handleIonInput"],[0,"ionColor","labelColorChanged"],[0,"ionStyle","itemStyle"]],{"counterFormatter":["counterFormatterChanged"]}],[34,"ion-label",{"color":[513],"position":[1],"noAnimate":[32]},null,{"color":["colorChanged"],"position":["positionChanged"]}],[33,"ion-note",{"color":[513]}]]],["ion-select_3",[[33,"ion-select",{"cancelText":[1,"cancel-text"],"color":[513],"compareWith":[1,"compare-with"],"disabled":[4],"fill":[1],"interface":[1],"interfaceOptions":[8,"interface-options"],"justify":[1],"label":[1],"labelPlacement":[1,"label-placement"],"legacy":[4],"multiple":[4],"name":[1],"okText":[1,"ok-text"],"placeholder":[1],"selectedText":[1,"selected-text"],"toggleIcon":[1,"toggle-icon"],"expandedIcon":[1,"expanded-icon"],"shape":[1],"value":[1032],"isExpanded":[32],"open":[64]},null,{"disabled":["styleChanged"],"isExpanded":["styleChanged"],"placeholder":["styleChanged"],"value":["styleChanged"]}],[1,"ion-select-option",{"disabled":[4],"value":[8]}],[34,"ion-select-popover",{"header":[1],"subHeader":[1,"sub-header"],"message":[1],"multiple":[4],"options":[16]}]]],["ion-picker-internal",[[33,"ion-picker-internal",{"exitInputMode":[64]},[[1,"touchstart","preventTouchStartPropagation"]]]]],["ion-datetime_3",[[33,"ion-datetime",{"color":[1],"name":[1],"disabled":[4],"readonly":[4],"isDateEnabled":[16],"min":[1025],"max":[1025],"presentation":[1],"cancelText":[1,"cancel-text"],"doneText":[1,"done-text"],"clearText":[1,"clear-text"],"yearValues":[8,"year-values"],"monthValues":[8,"month-values"],"dayValues":[8,"day-values"],"hourValues":[8,"hour-values"],"minuteValues":[8,"minute-values"],"locale":[1],"firstDayOfWeek":[2,"first-day-of-week"],"titleSelectedDatesFormatter":[16],"multiple":[4],"highlightedDates":[16],"value":[1025],"showDefaultTitle":[4,"show-default-title"],"showDefaultButtons":[4,"show-default-buttons"],"showClearButton":[4,"show-clear-button"],"showDefaultTimeLabel":[4,"show-default-time-label"],"hourCycle":[1,"hour-cycle"],"size":[1],"preferWheel":[4,"prefer-wheel"],"showMonthAndYear":[32],"activeParts":[32],"workingParts":[32],"isTimePopoverOpen":[32],"forceRenderDate":[32],"confirm":[64],"reset":[64],"cancel":[64]},null,{"disabled":["disabledChanged"],"min":["minChanged"],"max":["maxChanged"],"yearValues":["yearValuesChanged"],"monthValues":["monthValuesChanged"],"dayValues":["dayValuesChanged"],"hourValues":["hourValuesChanged"],"minuteValues":["minuteValuesChanged"],"value":["valueChanged"]}],[34,"ion-picker",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"columns":[16],"cssClass":[1,"css-class"],"duration":[2],"showBackdrop":[4,"show-backdrop"],"backdropDismiss":[4,"backdrop-dismiss"],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"presented":[32],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64],"getColumn":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}],[32,"ion-picker-column",{"col":[16]},null,{"col":["colChanged"]}]]],["ion-radio_2",[[33,"ion-radio",{"color":[513],"name":[1],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"legacy":[4],"justify":[1],"alignment":[1],"checked":[32],"buttonTabindex":[32],"setFocus":[64],"setButtonTabindex":[64]},null,{"value":["valueChanged"],"checked":["styleChanged"],"color":["styleChanged"],"disabled":["styleChanged"]}],[0,"ion-radio-group",{"allowEmptySelection":[4,"allow-empty-selection"],"compareWith":[1,"compare-with"],"name":[1],"value":[1032]},[[4,"keydown","onKeydown"]],{"value":["valueChanged"]}]]],["ion-ripple-effect",[[1,"ion-ripple-effect",{"type":[1],"addRipple":[64]}]]],["ion-button_2",[[33,"ion-button",{"color":[513],"buttonType":[1025,"button-type"],"disabled":[516],"expand":[513],"fill":[1537],"routerDirection":[1,"router-direction"],"routerAnimation":[16],"download":[1],"href":[1],"rel":[1],"shape":[513],"size":[513],"strong":[4],"target":[1],"type":[1],"form":[1]},null,{"disabled":["disabledChanged"]}],[1,"ion-icon",{"mode":[1025],"color":[1],"ios":[1],"md":[1],"flipRtl":[4,"flip-rtl"],"name":[513],"src":[1],"icon":[8],"size":[1],"lazy":[4],"sanitize":[4],"svgContent":[32],"isVisible":[32]},null,{"name":["loadIcon"],"src":["loadIcon"],"icon":["loadIcon"],"ios":["loadIcon"],"md":["loadIcon"]}]]],["ion-action-sheet",[[34,"ion-action-sheet",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"buttons":[16],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"header":[1],"subHeader":[1,"sub-header"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"]}]]],["ion-alert",[[34,"ion-alert",{"overlayIndex":[2,"overlay-index"],"delegate":[16],"hasController":[4,"has-controller"],"keyboardClose":[4,"keyboard-close"],"enterAnimation":[16],"leaveAnimation":[16],"cssClass":[1,"css-class"],"header":[1],"subHeader":[1,"sub-header"],"message":[1],"buttons":[16],"inputs":[1040],"backdropDismiss":[4,"backdrop-dismiss"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"isOpen":[4,"is-open"],"trigger":[1],"present":[64],"dismiss":[64],"onDidDismiss":[64],"onWillDismiss":[64]},[[4,"keydown","onKeydown"]],{"isOpen":["onIsOpenChange"],"trigger":["triggerChanged"],"buttons":["buttonsChanged"],"inputs":["inputsChanged"]}]]],["ion-app_8",[[0,"ion-app",{"setFocus":[64]}],[1,"ion-content",{"color":[513],"fullscreen":[4],"forceOverscroll":[1028,"force-overscroll"],"scrollX":[4,"scroll-x"],"scrollY":[4,"scroll-y"],"scrollEvents":[4,"scroll-events"],"getScrollElement":[64],"getBackgroundElement":[64],"scrollToTop":[64],"scrollToBottom":[64],"scrollByPoint":[64],"scrollToPoint":[64]},[[9,"resize","onResize"]]],[36,"ion-footer",{"collapse":[1],"translucent":[4],"keyboardVisible":[32]}],[36,"ion-header",{"collapse":[1],"translucent":[4]}],[1,"ion-router-outlet",{"mode":[1025],"delegate":[16],"animated":[4],"animation":[16],"swipeHandler":[16],"commit":[64],"setRouteId":[64],"getRouteId":[64]},null,{"swipeHandler":["swipeHandlerChanged"]}],[33,"ion-title",{"color":[513],"size":[1]},null,{"size":["sizeChanged"]}],[33,"ion-toolbar",{"color":[513]},[[0,"ionStyle","childrenStyle"]]],[34,"ion-buttons",{"collapse":[4]}]]],["ion-picker-column-internal",[[33,"ion-picker-column-internal",{"disabled":[4],"items":[16],"value":[1032],"color":[513],"numericInput":[4,"numeric-input"],"isActive":[32],"scrollActiveItemIntoView":[64],"setValue":[64]},null,{"value":["valueChange"]}]]],["ion-popover",[[33,"ion-popover",{"hasController":[4,"has-controller"],"delegate":[16],"overlayIndex":[2,"overlay-index"],"enterAnimation":[16],"leaveAnimation":[16],"component":[1],"componentProps":[16],"keyboardClose":[4,"keyboard-close"],"cssClass":[1,"css-class"],"backdropDismiss":[4,"backdrop-dismiss"],"event":[8],"showBackdrop":[4,"show-backdrop"],"translucent":[4],"animated":[4],"htmlAttributes":[16],"triggerAction":[1,"trigger-action"],"trigger":[1],"size":[1],"dismissOnSelect":[4,"dismiss-on-select"],"reference":[1],"side":[1],"alignment":[1025],"arrow":[4],"isOpen":[4,"is-open"],"keyboardEvents":[4,"keyboard-events"],"keepContentsMounted":[4,"keep-contents-mounted"],"presented":[32],"presentFromTrigger":[64],"present":[64],"dismiss":[64],"getParentPopover":[64],"onDidDismiss":[64],"onWillDismiss":[64]},null,{"trigger":["onTriggerChange"],"triggerAction":["onTriggerChange"],"isOpen":["onIsOpenChange"]}]]],["ion-checkbox",[[33,"ion-checkbox",{"color":[513],"name":[1],"checked":[1028],"indeterminate":[1028],"disabled":[4],"value":[8],"labelPlacement":[1,"label-placement"],"justify":[1],"alignment":[1],"legacy":[4]},null,{"checked":["styleChanged"],"disabled":["styleChanged"]}]]],["ion-spinner",[[1,"ion-spinner",{"color":[513],"duration":[2],"name":[1],"paused":[4]}]]]]'),Oe)})(0,{exclude:["ion-tabs","ion-tab"],syncQueue:!0,raf:te.Wn,jmp:Fi=>$.runOutsideAngular(Fi),ael(Fi,Sr,Qi,Dr){Fi[Nt](Sr,Qi,Dr)},rel(Fi,Sr,Qi,Dr){Fi.removeEventListener(Sr,Qi,Dr)}}))}};let Yi=(()=>{class O{static forRoot($){return{ngModule:O,providers:[{provide:te.dy,useValue:$},{provide:h.ip1,useFactory:fi,multi:!0,deps:[te.dy,Y.K0,h.R0b]},(0,te.DN)()]}}}return O.\u0275fac=function($){return new($||O)},O.\u0275mod=h.oAB({type:O}),O.\u0275inj=h.cJS({providers:[te.y4,Vn,Xn],imports:[Y.ez]}),O})()},2618:(Bn,Ct,P)=>{"use strict";P.d(Ct,{Zw:()=>Ie,aw:()=>Qt,X$:()=>it,sK:()=>Ne});var h=P(9212),m=P(2096),te=P(2664),l=P(9315),B=P(5211),Y=P(4911),C=P(8180),ie=P(8645),fe=P(4552);class Pe extends ie.x{constructor(an=1/0,tt=1/0,pt=fe.l){super(),this._bufferSize=an,this._windowTime=tt,this._timestampProvider=pt,this._buffer=[],this._infiniteTimeWindow=!0,this._infiniteTimeWindow=tt===1/0,this._bufferSize=Math.max(1,an),this._windowTime=Math.max(1,tt)}next(an){const{isStopped:tt,_buffer:pt,_infiniteTimeWindow:Xt,_timestampProvider:bn,_windowTime:Cn}=this;tt||(pt.push(an),!Xt&&pt.push(bn.now()+Cn)),this._trimBuffer(),super.next(an)}_subscribe(an){this._throwIfClosed(),this._trimBuffer();const tt=this._innerSubscribe(an),{_infiniteTimeWindow:pt,_buffer:Xt}=this,bn=Xt.slice();for(let Cn=0;Cn<bn.length&&!an.closed;Cn+=pt?1:2)an.next(bn[Cn]);return this._checkFinalizedStatuses(an),tt}_trimBuffer(){const{_bufferSize:an,_timestampProvider:tt,_buffer:pt,_infiniteTimeWindow:Xt}=this,bn=(Xt?1:2)*an;if(an<1/0&&bn<pt.length&&pt.splice(0,pt.length-bn),!Xt){const Cn=tt.now();let It=0;for(let pe=1;pe<pt.length&&pt[pe]<=Cn;pe+=2)It=pe;It&&pt.splice(0,It+1)}}}var K=P(4829),be=P(305),Te=P(9360);function de(mt,an,...tt){if(!0===an)return void mt();if(!1===an)return;const pt=new be.Hp({next:()=>{pt.unsubscribe(),mt()}});return(0,K.Xf)(an(...tt)).subscribe(pt)}function nt(mt,an,tt){let pt,Xt=!1;return mt&&"object"==typeof mt?({bufferSize:pt=1/0,windowTime:an=1/0,refCount:Xt=!1,scheduler:tt}=mt):pt=mt??1/0,function Me(mt={}){const{connector:an=(()=>new ie.x),resetOnError:tt=!0,resetOnComplete:pt=!0,resetOnRefCountZero:Xt=!0}=mt;return bn=>{let Cn,It,pe,lt=0,Zt=!1,hn=!1;const Yt=()=>{It?.unsubscribe(),It=void 0},Ft=()=>{Yt(),Cn=pe=void 0,Zt=hn=!1},Un=()=>{const Ve=Cn;Ft(),Ve?.unsubscribe()};return(0,Te.e)((Ve,Pt)=>{lt++,!hn&&!Zt&&Yt();const Kt=pe=pe??an();Pt.add(()=>{lt--,0===lt&&!hn&&!Zt&&(It=de(Un,Xt))}),Kt.subscribe(Pt),!Cn&&lt>0&&(Cn=new be.Hp({next:wn=>Kt.next(wn),error:wn=>{hn=!0,Yt(),It=de(Ft,tt,wn),Kt.error(wn)},complete:()=>{Zt=!0,Yt(),It=de(Ft,pt),Kt.complete()}}),(0,K.Xf)(Ve).subscribe(Cn))})(bn)}}({connector:()=>new Pe(pt,an,tt),resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:Xt})}var Ce=P(7398),oe=P(6328),xe=P(4664);class Ie{}let Ae=(()=>{class mt extends Ie{getTranslation(tt){return(0,m.of)({})}static \u0275fac=(()=>{let tt;return function(Xt){return(tt||(tt=h.n5z(mt)))(Xt||mt)}})();static \u0275prov=h.Yz7({token:mt,factory:mt.\u0275fac})}return mt})();class ye{}let Ue=(()=>{class mt{handle(tt){return tt.key}static \u0275fac=function(pt){return new(pt||mt)};static \u0275prov=h.Yz7({token:mt,factory:mt.\u0275fac})}return mt})();function ct(mt,an){if(mt===an)return!0;if(null===mt||null===an)return!1;if(mt!=mt&&an!=an)return!0;let Xt,bn,Cn,tt=typeof mt;if(tt==typeof an&&"object"==tt){if(!Array.isArray(mt)){if(Array.isArray(an))return!1;for(bn in Cn=Object.create(null),mt){if(!ct(mt[bn],an[bn]))return!1;Cn[bn]=!0}for(bn in an)if(!(bn in Cn)&&typeof an[bn]<"u")return!1;return!0}if(!Array.isArray(an))return!1;if((Xt=mt.length)==an.length){for(bn=0;bn<Xt;bn++)if(!ct(mt[bn],an[bn]))return!1;return!0}}return!1}function X(mt){return typeof mt<"u"&&null!==mt}function ve(mt){return mt&&"object"==typeof mt&&!Array.isArray(mt)}function me(mt,an){let tt=Object.assign({},mt);return ve(mt)&&ve(an)&&Object.keys(an).forEach(pt=>{ve(an[pt])?pt in mt?tt[pt]=me(mt[pt],an[pt]):Object.assign(tt,{[pt]:an[pt]}):Object.assign(tt,{[pt]:an[pt]})}),tt}class Fe{}let De=(()=>{class mt extends Fe{templateMatcher=/{{\s?([^{}\s]*)\s?}}/g;interpolate(tt,pt){let Xt;return Xt="string"==typeof tt?this.interpolateString(tt,pt):"function"==typeof tt?this.interpolateFunction(tt,pt):tt,Xt}getValue(tt,pt){let Xt="string"==typeof pt?pt.split("."):[pt];pt="";do{pt+=Xt.shift(),!X(tt)||!X(tt[pt])||"object"!=typeof tt[pt]&&Xt.length?Xt.length?pt+=".":tt=void 0:(tt=tt[pt],pt="")}while(Xt.length);return tt}interpolateFunction(tt,pt){return tt(pt)}interpolateString(tt,pt){return pt?tt.replace(this.templateMatcher,(Xt,bn)=>{let Cn=this.getValue(pt,bn);return X(Cn)?Cn:Xt}):tt}static \u0275fac=(()=>{let tt;return function(Xt){return(tt||(tt=h.n5z(mt)))(Xt||mt)}})();static \u0275prov=h.Yz7({token:mt,factory:mt.\u0275fac})}return mt})();class ze{}let Ke=(()=>{class mt extends ze{compile(tt,pt){return tt}compileTranslations(tt,pt){return tt}static \u0275fac=(()=>{let tt;return function(Xt){return(tt||(tt=h.n5z(mt)))(Xt||mt)}})();static \u0275prov=h.Yz7({token:mt,factory:mt.\u0275fac})}return mt})();class Ht{defaultLang;currentLang=this.defaultLang;translations={};langs=[];onTranslationChange=new h.vpe;onLangChange=new h.vpe;onDefaultLangChange=new h.vpe}const dn=new h.OlP("USE_STORE"),_n=new h.OlP("USE_DEFAULT_LANG"),Ut=new h.OlP("DEFAULT_LANGUAGE"),We=new h.OlP("USE_EXTEND");let Ne=(()=>{class mt{store;currentLoader;compiler;parser;missingTranslationHandler;useDefaultLang;isolate;extend;loadingTranslations;pending=!1;_onTranslationChange=new h.vpe;_onLangChange=new h.vpe;_onDefaultLangChange=new h.vpe;_defaultLang;_currentLang;_langs=[];_translations={};_translationRequests={};get onTranslationChange(){return this.isolate?this._onTranslationChange:this.store.onTranslationChange}get onLangChange(){return this.isolate?this._onLangChange:this.store.onLangChange}get onDefaultLangChange(){return this.isolate?this._onDefaultLangChange:this.store.onDefaultLangChange}get defaultLang(){return this.isolate?this._defaultLang:this.store.defaultLang}set defaultLang(tt){this.isolate?this._defaultLang=tt:this.store.defaultLang=tt}get currentLang(){return this.isolate?this._currentLang:this.store.currentLang}set currentLang(tt){this.isolate?this._currentLang=tt:this.store.currentLang=tt}get langs(){return this.isolate?this._langs:this.store.langs}set langs(tt){this.isolate?this._langs=tt:this.store.langs=tt}get translations(){return this.isolate?this._translations:this.store.translations}set translations(tt){this.isolate?this._translations=tt:this.store.translations=tt}constructor(tt,pt,Xt,bn,Cn,It=!0,pe=!1,lt=!1,Zt){this.store=tt,this.currentLoader=pt,this.compiler=Xt,this.parser=bn,this.missingTranslationHandler=Cn,this.useDefaultLang=It,this.isolate=pe,this.extend=lt,Zt&&this.setDefaultLang(Zt)}setDefaultLang(tt){if(tt===this.defaultLang)return;let pt=this.retrieveTranslations(tt);typeof pt<"u"?(null==this.defaultLang&&(this.defaultLang=tt),pt.pipe((0,C.q)(1)).subscribe(Xt=>{this.changeDefaultLang(tt)})):this.changeDefaultLang(tt)}getDefaultLang(){return this.defaultLang}use(tt){if(tt===this.currentLang)return(0,m.of)(this.translations[tt]);let pt=this.retrieveTranslations(tt);return typeof pt<"u"?(this.currentLang||(this.currentLang=tt),pt.pipe((0,C.q)(1)).subscribe(Xt=>{this.changeLang(tt)}),pt):(this.changeLang(tt),(0,m.of)(this.translations[tt]))}retrieveTranslations(tt){let pt;return(typeof this.translations[tt]>"u"||this.extend)&&(this._translationRequests[tt]=this._translationRequests[tt]||this.getTranslation(tt),pt=this._translationRequests[tt]),pt}getTranslation(tt){this.pending=!0;const pt=this.currentLoader.getTranslation(tt).pipe(nt(1),(0,C.q)(1));return this.loadingTranslations=pt.pipe((0,Ce.U)(Xt=>this.compiler.compileTranslations(Xt,tt)),nt(1),(0,C.q)(1)),this.loadingTranslations.subscribe({next:Xt=>{this.translations[tt]=this.extend&&this.translations[tt]?{...Xt,...this.translations[tt]}:Xt,this.updateLangs(),this.pending=!1},error:Xt=>{this.pending=!1}}),pt}setTranslation(tt,pt,Xt=!1){pt=this.compiler.compileTranslations(pt,tt),this.translations[tt]=(Xt||this.extend)&&this.translations[tt]?me(this.translations[tt],pt):pt,this.updateLangs(),this.onTranslationChange.emit({lang:tt,translations:this.translations[tt]})}getLangs(){return this.langs}addLangs(tt){tt.forEach(pt=>{-1===this.langs.indexOf(pt)&&this.langs.push(pt)})}updateLangs(){this.addLangs(Object.keys(this.translations))}getParsedResult(tt,pt,Xt){let bn;if(pt instanceof Array){let Cn={},It=!1;for(let pe of pt)Cn[pe]=this.getParsedResult(tt,pe,Xt),(0,te.b)(Cn[pe])&&(It=!0);if(It){const pe=pt.map(lt=>(0,te.b)(Cn[lt])?Cn[lt]:(0,m.of)(Cn[lt]));return(0,l.D)(pe).pipe((0,Ce.U)(lt=>{let Zt={};return lt.forEach((hn,Yt)=>{Zt[pt[Yt]]=hn}),Zt}))}return Cn}if(tt&&(bn=this.parser.interpolate(this.parser.getValue(tt,pt),Xt)),typeof bn>"u"&&null!=this.defaultLang&&this.defaultLang!==this.currentLang&&this.useDefaultLang&&(bn=this.parser.interpolate(this.parser.getValue(this.translations[this.defaultLang],pt),Xt)),typeof bn>"u"){let Cn={key:pt,translateService:this};typeof Xt<"u"&&(Cn.interpolateParams=Xt),bn=this.missingTranslationHandler.handle(Cn)}return typeof bn<"u"?bn:pt}get(tt,pt){if(!X(tt)||!tt.length)throw new Error('Parameter "key" required');if(this.pending)return this.loadingTranslations.pipe((0,oe.b)(Xt=>(Xt=this.getParsedResult(Xt,tt,pt),(0,te.b)(Xt)?Xt:(0,m.of)(Xt))));{let Xt=this.getParsedResult(this.translations[this.currentLang],tt,pt);return(0,te.b)(Xt)?Xt:(0,m.of)(Xt)}}getStreamOnTranslationChange(tt,pt){if(!X(tt)||!tt.length)throw new Error('Parameter "key" required');return(0,B.z)((0,Y.P)(()=>this.get(tt,pt)),this.onTranslationChange.pipe((0,xe.w)(Xt=>{const bn=this.getParsedResult(Xt.translations,tt,pt);return"function"==typeof bn.subscribe?bn:(0,m.of)(bn)})))}stream(tt,pt){if(!X(tt)||!tt.length)throw new Error('Parameter "key" required');return(0,B.z)((0,Y.P)(()=>this.get(tt,pt)),this.onLangChange.pipe((0,xe.w)(Xt=>{const bn=this.getParsedResult(Xt.translations,tt,pt);return(0,te.b)(bn)?bn:(0,m.of)(bn)})))}instant(tt,pt){if(!X(tt)||!tt.length)throw new Error('Parameter "key" required');let Xt=this.getParsedResult(this.translations[this.currentLang],tt,pt);if((0,te.b)(Xt)){if(tt instanceof Array){let bn={};return tt.forEach((Cn,It)=>{bn[tt[It]]=tt[It]}),bn}return tt}return Xt}set(tt,pt,Xt=this.currentLang){this.translations[Xt][tt]=this.compiler.compile(pt,Xt),this.updateLangs(),this.onTranslationChange.emit({lang:Xt,translations:this.translations[Xt]})}changeLang(tt){this.currentLang=tt,this.onLangChange.emit({lang:tt,translations:this.translations[tt]}),null==this.defaultLang&&this.changeDefaultLang(tt)}changeDefaultLang(tt){this.defaultLang=tt,this.onDefaultLangChange.emit({lang:tt,translations:this.translations[tt]})}reloadLang(tt){return this.resetLang(tt),this.getTranslation(tt)}resetLang(tt){this._translationRequests[tt]=void 0,this.translations[tt]=void 0}getBrowserLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let tt=window.navigator.languages?window.navigator.languages[0]:null;return tt=tt||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,typeof tt>"u"?void 0:(-1!==tt.indexOf("-")&&(tt=tt.split("-")[0]),-1!==tt.indexOf("_")&&(tt=tt.split("_")[0]),tt)}getBrowserCultureLang(){if(typeof window>"u"||typeof window.navigator>"u")return;let tt=window.navigator.languages?window.navigator.languages[0]:null;return tt=tt||window.navigator.language||window.navigator.browserLanguage||window.navigator.userLanguage,tt}static \u0275fac=function(pt){return new(pt||mt)(h.LFG(Ht),h.LFG(Ie),h.LFG(ze),h.LFG(Fe),h.LFG(ye),h.LFG(_n),h.LFG(dn),h.LFG(We),h.LFG(Ut))};static \u0275prov=h.Yz7({token:mt,factory:mt.\u0275fac})}return mt})(),it=(()=>{class mt{translate;_ref;value="";lastKey=null;lastParams=[];onTranslationChange;onLangChange;onDefaultLangChange;constructor(tt,pt){this.translate=tt,this._ref=pt}updateValue(tt,pt,Xt){let bn=Cn=>{this.value=void 0!==Cn?Cn:tt,this.lastKey=tt,this._ref.markForCheck()};if(Xt){let Cn=this.translate.getParsedResult(Xt,tt,pt);(0,te.b)(Cn.subscribe)?Cn.subscribe(bn):bn(Cn)}this.translate.get(tt,pt).subscribe(bn)}transform(tt,...pt){if(!tt||!tt.length)return tt;if(ct(tt,this.lastKey)&&ct(pt,this.lastParams))return this.value;let Xt;if(X(pt[0])&&pt.length)if("string"==typeof pt[0]&&pt[0].length){let bn=pt[0].replace(/(\')?([a-zA-Z0-9_]+)(\')?(\s)?:/g,'"$2":').replace(/:(\s)?(\')(.*?)(\')/g,':"$3"');try{Xt=JSON.parse(bn)}catch{throw new SyntaxError(`Wrong parameter in TranslatePipe. Expected a valid Object, received: ${pt[0]}`)}}else"object"==typeof pt[0]&&!Array.isArray(pt[0])&&(Xt=pt[0]);return this.lastKey=tt,this.lastParams=pt,this.updateValue(tt,Xt),this._dispose(),this.onTranslationChange||(this.onTranslationChange=this.translate.onTranslationChange.subscribe(bn=>{this.lastKey&&bn.lang===this.translate.currentLang&&(this.lastKey=null,this.updateValue(tt,Xt,bn.translations))})),this.onLangChange||(this.onLangChange=this.translate.onLangChange.subscribe(bn=>{this.lastKey&&(this.lastKey=null,this.updateValue(tt,Xt,bn.translations))})),this.onDefaultLangChange||(this.onDefaultLangChange=this.translate.onDefaultLangChange.subscribe(()=>{this.lastKey&&(this.lastKey=null,this.updateValue(tt,Xt))})),this.value}_dispose(){typeof this.onTranslationChange<"u"&&(this.onTranslationChange.unsubscribe(),this.onTranslationChange=void 0),typeof this.onLangChange<"u"&&(this.onLangChange.unsubscribe(),this.onLangChange=void 0),typeof this.onDefaultLangChange<"u"&&(this.onDefaultLangChange.unsubscribe(),this.onDefaultLangChange=void 0)}ngOnDestroy(){this._dispose()}static \u0275fac=function(pt){return new(pt||mt)(h.Y36(Ne,16),h.Y36(h.sBO,16))};static \u0275pipe=h.Yjl({name:"translate",type:mt,pure:!1});static \u0275prov=h.Yz7({token:mt,factory:mt.\u0275fac})}return mt})(),Qt=(()=>{class mt{static forRoot(tt={}){return{ngModule:mt,providers:[tt.loader||{provide:Ie,useClass:Ae},tt.compiler||{provide:ze,useClass:Ke},tt.parser||{provide:Fe,useClass:De},tt.missingTranslationHandler||{provide:ye,useClass:Ue},Ht,{provide:dn,useValue:tt.isolate},{provide:_n,useValue:tt.useDefaultLang},{provide:We,useValue:tt.extend},{provide:Ut,useValue:tt.defaultLanguage},Ne]}}static forChild(tt={}){return{ngModule:mt,providers:[tt.loader||{provide:Ie,useClass:Ae},tt.compiler||{provide:ze,useClass:Ke},tt.parser||{provide:Fe,useClass:De},tt.missingTranslationHandler||{provide:ye,useClass:Ue},{provide:dn,useValue:tt.isolate},{provide:_n,useValue:tt.useDefaultLang},{provide:We,useValue:tt.extend},{provide:Ut,useValue:tt.defaultLanguage},Ne]}}static \u0275fac=function(pt){return new(pt||mt)};static \u0275mod=h.oAB({type:mt});static \u0275inj=h.cJS({})}return mt})()},5861:(Bn,Ct,P)=>{"use strict";function h(te,l,B,Y,C,ie,fe){try{var Pe=te[ie](fe),K=Pe.value}catch(be){return void B(be)}Pe.done?l(K):Promise.resolve(K).then(Y,C)}function m(te){return function(){var l=this,B=arguments;return new Promise(function(Y,C){var ie=te.apply(l,B);function fe(K){h(ie,Y,C,fe,Pe,"next",K)}function Pe(K){h(ie,Y,C,fe,Pe,"throw",K)}fe(void 0)})}}P.d(Ct,{Z:()=>m})},7582:(Bn,Ct,P)=>{"use strict";function B(We,Ne,ke,it){var an,Qt=arguments.length,mt=Qt<3?Ne:null===it?it=Object.getOwnPropertyDescriptor(Ne,ke):it;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)mt=Reflect.decorate(We,Ne,ke,it);else for(var tt=We.length-1;tt>=0;tt--)(an=We[tt])&&(mt=(Qt<3?an(mt):Qt>3?an(Ne,ke,mt):an(Ne,ke))||mt);return Qt>3&&mt&&Object.defineProperty(Ne,ke,mt),mt}function be(We,Ne,ke,it){return new(ke||(ke=Promise))(function(mt,an){function tt(bn){try{Xt(it.next(bn))}catch(Cn){an(Cn)}}function pt(bn){try{Xt(it.throw(bn))}catch(Cn){an(Cn)}}function Xt(bn){bn.done?mt(bn.value):function Qt(mt){return mt instanceof ke?mt:new ke(function(an){an(mt)})}(bn.value).then(tt,pt)}Xt((it=it.apply(We,Ne||[])).next())})}function Ae(We){return this instanceof Ae?(this.v=We,this):new Ae(We)}function ye(We,Ne,ke){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var Qt,it=ke.apply(We,Ne||[]),mt=[];return Qt={},an("next"),an("throw"),an("return"),Qt[Symbol.asyncIterator]=function(){return this},Qt;function an(It){it[It]&&(Qt[It]=function(pe){return new Promise(function(lt,Zt){mt.push([It,pe,lt,Zt])>1||tt(It,pe)})})}function tt(It,pe){try{!function pt(It){It.value instanceof Ae?Promise.resolve(It.value.v).then(Xt,bn):Cn(mt[0][2],It)}(it[It](pe))}catch(lt){Cn(mt[0][3],lt)}}function Xt(It){tt("next",It)}function bn(It){tt("throw",It)}function Cn(It,pe){It(pe),mt.shift(),mt.length&&tt(mt[0][0],mt[0][1])}}function ct(We){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var ke,Ne=We[Symbol.asyncIterator];return Ne?Ne.call(We):(We=function nt(We){var Ne="function"==typeof Symbol&&Symbol.iterator,ke=Ne&&We[Ne],it=0;if(ke)return ke.call(We);if(We&&"number"==typeof We.length)return{next:function(){return We&&it>=We.length&&(We=void 0),{value:We&&We[it++],done:!We}}};throw new TypeError(Ne?"Object is not iterable.":"Symbol.iterator is not defined.")}(We),ke={},it("next"),it("throw"),it("return"),ke[Symbol.asyncIterator]=function(){return this},ke);function it(mt){ke[mt]=We[mt]&&function(an){return new Promise(function(tt,pt){!function Qt(mt,an,tt,pt){Promise.resolve(pt).then(function(Xt){mt({value:Xt,done:tt})},an)}(tt,pt,(an=We[mt](an)).done,an.value)})}}}P.d(Ct,{FC:()=>ye,KL:()=>ct,gn:()=>B,mG:()=>be,qq:()=>Ae}),"function"==typeof SuppressedError&&SuppressedError}},Bn=>{Bn(Bn.s=3108)}]);